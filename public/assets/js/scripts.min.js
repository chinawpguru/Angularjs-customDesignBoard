var colorsForPicker = ['#D24D57', '#F22613', '#D91E18', '#96281B', '#EF4836', '#D64541', '#C0392B', '#CF000F', '#E74C3C', '#DB0A5B', '#F64747', '#F1A9A0', '#D2527F', '#E08283', '#F62459', '#E26A6A', '#DCC6E0', '#663399', '#674172', '#AEA8D3', '#913D88', '#9A12B3', '#BF55EC', '#BE90D4', '#8E44AD', '#9B59B6', '#446CB3', '#E4F1FE', '#4183D7', '#59ABE3', '#81CFE0', '#52B3D9', '#C5EFF7', '#22A7F0', '#3498DB', '#2C3E50', '#19B5FE', '#336E7B', '#22313F', '#6BB9F0', '#1E8BC3', '#3A539B', '#34495E', '#67809F', '#2574A9', '#1F3A93', '#89C4F4', '#4B77BE', '#5C97BF', '#4ECDC4', '#A2DED0', '#87D37C', '#90C695', '#26A65B', '#03C9A9', '#68C3A3', '#65C6BB', '#1BBC9B', '#1BA39C', '#66CC99', '#36D7B7', '#C8F7C5', '#86E2D5', '#2ECC71', '#16a085', '#3FC380', '#019875', '#03A678', '#4DAF7C', '#2ABB9B', '#00B16A', '#1E824C', '#049372', '#26C281', '#FDE3A7', '#F89406', '#EB9532', '#E87E04', '#F4B350', '#F2784B', '#EB974E', '#F5AB35', '#D35400', '#F39C12', '#F9690E', '#F9BF3B', '#F27935', '#E67E22', '#ececec', '#6C7A89', '#D2D7D3', '#EEEEEE', '#BDC3C7', '#ECF0F1', '#95A5A6', '#DADFE1', '#ABB7B7', '#F2F1EF', '#BFBFBF', '#E6E2AF', '#A7A37E', '#EFECCA', '#046380', '#002F2F', '#468966', '#FFF0A5', '#FFB03B', '#B64926', '#8E2800', '#1E1E20'];
var edGradients = {
    1: {
        type: 'linear',
        x1: -80,
        y1: 0,
        x2: 80,
        y2: 0,
        colorStops: {
            0: '#ffe47b',
            1: 'rgb(111,154,211)'
        }
    },

    2:  {
        type: 'linear',
        x1: 0,
        y1: -120,
        x2: 0,
        y2: 120,
        colorStops: {
            0: '#ff4040',
            1: '#e6399b'
        }
    },

    3: {
        type: 'linear',
        x1: -90,
        y1: -90,
        x2: 90,
        y2: 90,
        colorStops: {
            0: 'rgb(166,111,213)',
            0.5: 'rgba(106, 72, 215, 0.5)',
            1: '#200772'
        }
    },

    4: {
        type: 'radial',
        r1: 100,
        r2: 10,
        x1: 0,
        y1: 0,
        x2: 0,
        y2: 0,
        colorStops: {
            0: '#FF4F4F',
            1: 'rgb(255, 239, 64)'
        }
    },

    5: {
        type: 'radial',
        r1: 100,
        r2: 10,
        x1: 0,
        y1: 0,
        x2: 20,
        y2: 20,
        colorStops: {
            0: '#ffe47b',
            0.5: 'rgb(111,154,211)',
            1: 'rgb(166,111,213)'
        }
    },

    6: {
        type: 'radial',
        r1: 50,
        r2: 80,
        x1: 45,
        y1: 45,
        x2: 52,
        y2: 50,
        colorStops: {
            0: 'rgb(155, 237, 0)',
            1: 'rgba(0, 164, 128,0.4)'
        }
    },

    7: {
        type: 'linear',
        x1: -90,
        y1: -90,
        x2: 90,
        y2: 90,
        colorStops: {
            0: '#9ecb2d',
            0.5: '#72aa00',
            1: '#bfd255'
        }
    },

    8: {
        type: 'radial',
        r1: 100,
        r2: 50,
        x1: 30,
        y1: 0,
        x2: 0,
        y2: 0,
        colorStops: {
            0: '#aebcbf',
            1: '#0a0809'
        }
    },

    9: {
        type: 'linear',
        x1: -80,
        y1: 0,
        x2: 80,
        y2: 0,
        colorStops: {
            0: '#ffffff',
            1: '#f6f6f6'
        }
    },
    10:  {
        type: 'linear',
        x1: 0,
        y1: -120,
        x2: 0,
        y2: 120,
        colorStops: {
            0: '#fefcea',
            1: '#f1da36'
        }
    },
    11: {
        type: 'linear',
        x1: -90,
        y1: -90,
        x2: 90,
        y2: 90,
        colorStops: {
            0: 'rgb(166,111,213)',
            0.5: 'rgba(106, 72, 215, 0.5)',
            1: '#ff1a00'
        }
    },
    12:  {
        type: 'linear',
        x1: 0,
        y1: -120,
        x2: 0,
        y2: 120,
        colorStops: {
            0: '#b7deed',
            1: '#21b4e2'
        }
    },
    13: {
        type: 'linear',
        x1: -80,
        y1: 100,
        x2: 80,
        y2: -100,
        colorStops: {
            0: '#ffe47b',
            1: 'rgb(111,154,211)'
        }
    },
};
/*! jQuery v2.1.3 | (c) 2005, 2014 jQuery Foundation, Inc. | jquery.org/license */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k={},l=a.document,m="2.1.3",n=function(a,b){return new n.fn.init(a,b)},o=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,p=/^-ms-/,q=/-([\da-z])/gi,r=function(a,b){return b.toUpperCase()};n.fn=n.prototype={jquery:m,constructor:n,selector:"",length:0,toArray:function(){return d.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:d.call(this)},pushStack:function(a){var b=n.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return n.each(this,a,b)},map:function(a){return this.pushStack(n.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:c.sort,splice:c.splice},n.extend=n.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||n.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(n.isPlainObject(d)||(e=n.isArray(d)))?(e?(e=!1,f=c&&n.isArray(c)?c:[]):f=c&&n.isPlainObject(c)?c:{},g[b]=n.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},n.extend({expando:"jQuery"+(m+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===n.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return!n.isArray(a)&&a-parseFloat(a)+1>=0},isPlainObject:function(a){return"object"!==n.type(a)||a.nodeType||n.isWindow(a)?!1:a.constructor&&!j.call(a.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?h[i.call(a)]||"object":typeof a},globalEval:function(a){var b,c=eval;a=n.trim(a),a&&(1===a.indexOf("use strict")?(b=l.createElement("script"),b.text=a,l.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(a){return a.replace(p,"ms-").replace(q,r)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var d,e=0,f=a.length,g=s(a);if(c){if(g){for(;f>e;e++)if(d=b.apply(a[e],c),d===!1)break}else for(e in a)if(d=b.apply(a[e],c),d===!1)break}else if(g){for(;f>e;e++)if(d=b.call(a[e],e,a[e]),d===!1)break}else for(e in a)if(d=b.call(a[e],e,a[e]),d===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(o,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(s(Object(a))?n.merge(c,"string"==typeof a?[a]:a):f.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:g.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,f=0,g=a.length,h=s(a),i=[];if(h)for(;g>f;f++)d=b(a[f],f,c),null!=d&&i.push(d);else for(f in a)d=b(a[f],f,c),null!=d&&i.push(d);return e.apply([],i)},guid:1,proxy:function(a,b){var c,e,f;return"string"==typeof b&&(c=a[b],b=a,a=c),n.isFunction(a)?(e=d.call(arguments,2),f=function(){return a.apply(b||this,e.concat(d.call(arguments)))},f.guid=a.guid=a.guid||n.guid++,f):void 0},now:Date.now,support:k}),n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){h["[object "+b+"]"]=b.toLowerCase()});function s(a){var b=a.length,c=n.type(a);return"function"===c||n.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}var t=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+1*new Date,v=a.document,w=0,x=0,y=hb(),z=hb(),A=hb(),B=function(a,b){return a===b&&(l=!0),0},C=1<<31,D={}.hasOwnProperty,E=[],F=E.pop,G=E.push,H=E.push,I=E.slice,J=function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1},K="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",N=M.replace("w","w#"),O="\\["+L+"*("+M+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+N+"))|)"+L+"*\\]",P=":("+M+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+O+")*)|.*)\\)|)",Q=new RegExp(L+"+","g"),R=new RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),S=new RegExp("^"+L+"*,"+L+"*"),T=new RegExp("^"+L+"*([>+~]|"+L+")"+L+"*"),U=new RegExp("="+L+"*([^\\]'\"]*?)"+L+"*\\]","g"),V=new RegExp(P),W=new RegExp("^"+N+"$"),X={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+O),PSEUDO:new RegExp("^"+P),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),bool:new RegExp("^(?:"+K+")$","i"),needsContext:new RegExp("^"+L+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+L+"*((?:-\\d)?\\d*)"+L+"*\\)|)(?=[^-]|$)","i")},Y=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,_=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ab=/[+~]/,bb=/'|\\/g,cb=new RegExp("\\\\([\\da-f]{1,6}"+L+"?|("+L+")|.)","ig"),db=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},eb=function(){m()};try{H.apply(E=I.call(v.childNodes),v.childNodes),E[v.childNodes.length].nodeType}catch(fb){H={apply:E.length?function(a,b){G.apply(a,I.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function gb(a,b,d,e){var f,h,j,k,l,o,r,s,w,x;if((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,d=d||[],k=b.nodeType,"string"!=typeof a||!a||1!==k&&9!==k&&11!==k)return d;if(!e&&p){if(11!==k&&(f=_.exec(a)))if(j=f[1]){if(9===k){if(h=b.getElementById(j),!h||!h.parentNode)return d;if(h.id===j)return d.push(h),d}else if(b.ownerDocument&&(h=b.ownerDocument.getElementById(j))&&t(b,h)&&h.id===j)return d.push(h),d}else{if(f[2])return H.apply(d,b.getElementsByTagName(a)),d;if((j=f[3])&&c.getElementsByClassName)return H.apply(d,b.getElementsByClassName(j)),d}if(c.qsa&&(!q||!q.test(a))){if(s=r=u,w=b,x=1!==k&&a,1===k&&"object"!==b.nodeName.toLowerCase()){o=g(a),(r=b.getAttribute("id"))?s=r.replace(bb,"\\$&"):b.setAttribute("id",s),s="[id='"+s+"'] ",l=o.length;while(l--)o[l]=s+rb(o[l]);w=ab.test(a)&&pb(b.parentNode)||b,x=o.join(",")}if(x)try{return H.apply(d,w.querySelectorAll(x)),d}catch(y){}finally{r||b.removeAttribute("id")}}}return i(a.replace(R,"$1"),b,d,e)}function hb(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}return b}function ib(a){return a[u]=!0,a}function jb(a){var b=n.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function kb(a,b){var c=a.split("|"),e=a.length;while(e--)d.attrHandle[c[e]]=b}function lb(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||C)-(~a.sourceIndex||C);if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function mb(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function nb(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function ob(a){return ib(function(b){return b=+b,ib(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function pb(a){return a&&"undefined"!=typeof a.getElementsByTagName&&a}c=gb.support={},f=gb.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},m=gb.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement?(n=g,o=g.documentElement,e=g.defaultView,e&&e!==e.top&&(e.addEventListener?e.addEventListener("unload",eb,!1):e.attachEvent&&e.attachEvent("onunload",eb)),p=!f(g),c.attributes=jb(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=jb(function(a){return a.appendChild(g.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=$.test(g.getElementsByClassName),c.getById=jb(function(a){return o.appendChild(a).id=u,!g.getElementsByName||!g.getElementsByName(u).length}),c.getById?(d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},d.filter.ID=function(a){var b=a.replace(cb,db);return function(a){return a.getAttribute("id")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(cb,db);return function(a){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){return p?b.getElementsByClassName(a):void 0},r=[],q=[],(c.qsa=$.test(g.querySelectorAll))&&(jb(function(a){o.appendChild(a).innerHTML="<a id='"+u+"'></a><select id='"+u+"-\f]' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+L+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+L+"*(?:value|"+K+")"),a.querySelectorAll("[id~="+u+"-]").length||q.push("~="),a.querySelectorAll(":checked").length||q.push(":checked"),a.querySelectorAll("a#"+u+"+*").length||q.push(".#.+[+~]")}),jb(function(a){var b=g.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+L+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=$.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&jb(function(a){c.disconnectedMatch=s.call(a,"div"),s.call(a,"[s!='']:x"),r.push("!=",P)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=$.test(o.compareDocumentPosition),t=b||$.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===g||a.ownerDocument===v&&t(v,a)?-1:b===g||b.ownerDocument===v&&t(v,b)?1:k?J(k,a)-J(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,h=[a],i=[b];if(!e||!f)return a===g?-1:b===g?1:e?-1:f?1:k?J(k,a)-J(k,b):0;if(e===f)return lb(a,b);c=a;while(c=c.parentNode)h.unshift(c);c=b;while(c=c.parentNode)i.unshift(c);while(h[d]===i[d])d++;return d?lb(h[d],i[d]):h[d]===v?-1:i[d]===v?1:0},g):n},gb.matches=function(a,b){return gb(a,null,null,b)},gb.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(U,"='$1']"),!(!c.matchesSelector||!p||r&&r.test(b)||q&&q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return gb(b,n,null,[a]).length>0},gb.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},gb.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&D.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},gb.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},gb.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return k=null,a},e=gb.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=gb.selectors={cacheLength:50,createPseudo:ib,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(cb,db),a[3]=(a[3]||a[4]||a[5]||"").replace(cb,db),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||gb.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&gb.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return X.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&V.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(cb,db).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+L+")"+a+"("+L+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=gb.attr(d,a);return null==e?"!="===b:b?(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e.replace(Q," ")+" ").indexOf(c)>-1:"|="===b?e===c||e.slice(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){while(p){l=b;while(l=l[p])if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){k=q[u]||(q[u]={}),j=k[a]||[],n=j[0]===w&&j[1],m=j[0]===w&&j[2],l=n&&q.childNodes[n];while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if(1===l.nodeType&&++m&&l===b){k[a]=[w,n,m];break}}else if(s&&(j=(b[u]||(b[u]={}))[a])&&j[0]===w)m=j[1];else while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if((h?l.nodeName.toLowerCase()===r:1===l.nodeType)&&++m&&(s&&((l[u]||(l[u]={}))[a]=[w,m]),l===b))break;return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||gb.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ib(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=J(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:ib(function(a){var b=[],c=[],d=h(a.replace(R,"$1"));return d[u]?ib(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop()}}),has:ib(function(a){return function(b){return gb(a,b).length>0}}),contains:ib(function(a){return a=a.replace(cb,db),function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:ib(function(a){return W.test(a||"")||gb.error("unsupported lang: "+a),a=a.replace(cb,db).toLowerCase(),function(b){var c;do if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return Z.test(a.nodeName)},input:function(a){return Y.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:ob(function(){return[0]}),last:ob(function(a,b){return[b-1]}),eq:ob(function(a,b,c){return[0>c?c+b:c]}),even:ob(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:ob(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:ob(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:ob(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=mb(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=nb(b);function qb(){}qb.prototype=d.filters=d.pseudos,d.setFilters=new qb,g=gb.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){(!c||(e=S.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=T.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(R," ")}),h=h.slice(c.length));for(g in d.filter)!(e=X[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?gb.error(a):z(a,i).slice(0)};function rb(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function sb(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=x++;return b.first?function(b,c,f){while(b=b[d])if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[w,f];if(g){while(b=b[d])if((1===b.nodeType||e)&&a(b,c,g))return!0}else while(b=b[d])if(1===b.nodeType||e){if(i=b[u]||(b[u]={}),(h=i[d])&&h[0]===w&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function tb(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function ub(a,b,c){for(var d=0,e=b.length;e>d;d++)gb(a,b[d],c);return c}function vb(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function wb(a,b,c,d,e,f){return d&&!d[u]&&(d=wb(d)),e&&!e[u]&&(e=wb(e,f)),ib(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||ub(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:vb(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=vb(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?J(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=vb(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):H.apply(g,r)})}function xb(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=sb(function(a){return a===b},h,!0),l=sb(function(a){return J(b,a)>-1},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e}];f>i;i++)if(c=d.relative[a[i].type])m=[sb(tb(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;f>e;e++)if(d.relative[a[e].type])break;return wb(i>1&&tb(m),i>1&&rb(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(R,"$1"),c,e>i&&xb(a.slice(i,e)),f>e&&xb(a=a.slice(e)),f>e&&rb(a))}m.push(c)}return tb(m)}function yb(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,m,o,p=0,q="0",r=f&&[],s=[],t=j,u=f||e&&d.find.TAG("*",k),v=w+=null==t?1:Math.random()||.1,x=u.length;for(k&&(j=g!==n&&g);q!==x&&null!=(l=u[q]);q++){if(e&&l){m=0;while(o=a[m++])if(o(l,g,h)){i.push(l);break}k&&(w=v)}c&&((l=!o&&l)&&p--,f&&r.push(l))}if(p+=q,c&&q!==p){m=0;while(o=b[m++])o(r,s,g,h);if(f){if(p>0)while(q--)r[q]||s[q]||(s[q]=F.call(i));s=vb(s)}H.apply(i,s),k&&!f&&s.length>0&&p+b.length>1&&gb.uniqueSort(i)}return k&&(w=v,j=t),r};return c?ib(f):f}return h=gb.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){b||(b=g(a)),c=b.length;while(c--)f=xb(b[c]),f[u]?d.push(f):e.push(f);f=A(a,yb(e,d)),f.selector=a}return f},i=gb.select=function(a,b,e,f){var i,j,k,l,m,n="function"==typeof a&&a,o=!f&&g(a=n.selector||a);if(e=e||[],1===o.length){if(j=o[0]=o[0].slice(0),j.length>2&&"ID"===(k=j[0]).type&&c.getById&&9===b.nodeType&&p&&d.relative[j[1].type]){if(b=(d.find.ID(k.matches[0].replace(cb,db),b)||[])[0],!b)return e;n&&(b=b.parentNode),a=a.slice(j.shift().value.length)}i=X.needsContext.test(a)?0:j.length;while(i--){if(k=j[i],d.relative[l=k.type])break;if((m=d.find[l])&&(f=m(k.matches[0].replace(cb,db),ab.test(j[0].type)&&pb(b.parentNode)||b))){if(j.splice(i,1),a=f.length&&rb(j),!a)return H.apply(e,f),e;break}}}return(n||h(a,o))(f,b,!p,e,ab.test(a)&&pb(b.parentNode)||b),e},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=jb(function(a){return 1&a.compareDocumentPosition(n.createElement("div"))}),jb(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||kb("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&jb(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||kb("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),jb(function(a){return null==a.getAttribute("disabled")})||kb(K,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),gb}(a);n.find=t,n.expr=t.selectors,n.expr[":"]=n.expr.pseudos,n.unique=t.uniqueSort,n.text=t.getText,n.isXMLDoc=t.isXML,n.contains=t.contains;var u=n.expr.match.needsContext,v=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/^.[^:#\[\.,]*$/;function x(a,b,c){if(n.isFunction(b))return n.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return n.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(w.test(b))return n.filter(b,a,c);b=n.filter(b,a)}return n.grep(a,function(a){return g.call(b,a)>=0!==c})}n.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?n.find.matchesSelector(d,a)?[d]:[]:n.find.matches(a,n.grep(b,function(a){return 1===a.nodeType}))},n.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(n(a).filter(function(){for(b=0;c>b;b++)if(n.contains(e[b],this))return!0}));for(b=0;c>b;b++)n.find(a,e[b],d);return d=this.pushStack(c>1?n.unique(d):d),d.selector=this.selector?this.selector+" "+a:a,d},filter:function(a){return this.pushStack(x(this,a||[],!1))},not:function(a){return this.pushStack(x(this,a||[],!0))},is:function(a){return!!x(this,"string"==typeof a&&u.test(a)?n(a):a||[],!1).length}});var y,z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,A=n.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:z.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||y).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof n?b[0]:b,n.merge(this,n.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:l,!0)),v.test(c[1])&&n.isPlainObject(b))for(c in b)n.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}return d=l.getElementById(c[2]),d&&d.parentNode&&(this.length=1,this[0]=d),this.context=l,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):n.isFunction(a)?"undefined"!=typeof y.ready?y.ready(a):a(n):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),n.makeArray(a,this))};A.prototype=n.fn,y=n(l);var B=/^(?:parents|prev(?:Until|All))/,C={children:!0,contents:!0,next:!0,prev:!0};n.extend({dir:function(a,b,c){var d=[],e=void 0!==c;while((a=a[b])&&9!==a.nodeType)if(1===a.nodeType){if(e&&n(a).is(c))break;d.push(a)}return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),n.fn.extend({has:function(a){var b=n(a,this),c=b.length;return this.filter(function(){for(var a=0;c>a;a++)if(n.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=u.test(a)||"string"!=typeof a?n(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&n.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?n.unique(f):f)},index:function(a){return a?"string"==typeof a?g.call(n(a),this[0]):g.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(n.unique(n.merge(this.get(),n(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function D(a,b){while((a=a[b])&&1!==a.nodeType);return a}n.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return n.dir(a,"parentNode")},parentsUntil:function(a,b,c){return n.dir(a,"parentNode",c)},next:function(a){return D(a,"nextSibling")},prev:function(a){return D(a,"previousSibling")},nextAll:function(a){return n.dir(a,"nextSibling")},prevAll:function(a){return n.dir(a,"previousSibling")},nextUntil:function(a,b,c){return n.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return n.dir(a,"previousSibling",c)},siblings:function(a){return n.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return n.sibling(a.firstChild)},contents:function(a){return a.contentDocument||n.merge([],a.childNodes)}},function(a,b){n.fn[a]=function(c,d){var e=n.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=n.filter(d,e)),this.length>1&&(C[a]||n.unique(e),B.test(a)&&e.reverse()),this.pushStack(e)}});var E=/\S+/g,F={};function G(a){var b=F[a]={};return n.each(a.match(E)||[],function(a,c){b[c]=!0}),b}n.Callbacks=function(a){a="string"==typeof a?F[a]||G(a):n.extend({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function(l){for(b=a.memory&&l,c=!0,g=e||0,e=0,f=h.length,d=!0;h&&f>g;g++)if(h[g].apply(l[0],l[1])===!1&&a.stopOnFalse){b=!1;break}d=!1,h&&(i?i.length&&j(i.shift()):b?h=[]:k.disable())},k={add:function(){if(h){var c=h.length;!function g(b){n.each(b,function(b,c){var d=n.type(c);"function"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&"string"!==d&&g(c)})}(arguments),d?f=h.length:b&&(e=c,j(b))}return this},remove:function(){return h&&n.each(arguments,function(a,b){var c;while((c=n.inArray(b,h,c))>-1)h.splice(c,1),d&&(f>=c&&f--,g>=c&&g--)}),this},has:function(a){return a?n.inArray(a,h)>-1:!(!h||!h.length)},empty:function(){return h=[],f=0,this},disable:function(){return h=i=b=void 0,this},disabled:function(){return!h},lock:function(){return i=void 0,b||k.disable(),this},locked:function(){return!i},fireWith:function(a,b){return!h||c&&!i||(b=b||[],b=[a,b.slice?b.slice():b],d?i.push(b):j(b)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!c}};return k},n.extend({Deferred:function(a){var b=[["resolve","done",n.Callbacks("once memory"),"resolved"],["reject","fail",n.Callbacks("once memory"),"rejected"],["notify","progress",n.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return n.Deferred(function(c){n.each(b,function(b,f){var g=n.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&n.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?n.extend(a,d):d}},e={};return d.pipe=d.then,n.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&n.isFunction(a.promise)?e:0,g=1===f?a:n.Deferred(),h=function(a,b,c){return function(e){b[a]=this,c[a]=arguments.length>1?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}},i,j,k;if(e>1)for(i=new Array(e),j=new Array(e),k=new Array(e);e>b;b++)c[b]&&n.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;return f||g.resolveWith(k,c),g.promise()}});var H;n.fn.ready=function(a){return n.ready.promise().done(a),this},n.extend({isReady:!1,readyWait:1,holdReady:function(a){a?n.readyWait++:n.ready(!0)},ready:function(a){(a===!0?--n.readyWait:n.isReady)||(n.isReady=!0,a!==!0&&--n.readyWait>0||(H.resolveWith(l,[n]),n.fn.triggerHandler&&(n(l).triggerHandler("ready"),n(l).off("ready"))))}});function I(){l.removeEventListener("DOMContentLoaded",I,!1),a.removeEventListener("load",I,!1),n.ready()}n.ready.promise=function(b){return H||(H=n.Deferred(),"complete"===l.readyState?setTimeout(n.ready):(l.addEventListener("DOMContentLoaded",I,!1),a.addEventListener("load",I,!1))),H.promise(b)},n.ready.promise();var J=n.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===n.type(c)){e=!0;for(h in c)n.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,n.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(n(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f};n.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};function K(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=n.expando+K.uid++}K.uid=1,K.accepts=n.acceptData,K.prototype={key:function(a){if(!K.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=K.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,b)}catch(d){b[this.expando]=c,n.extend(a,b)}}return this.cache[c]||(this.cache[c]={}),c},set:function(a,b,c){var d,e=this.key(a),f=this.cache[e];if("string"==typeof b)f[b]=c;else if(n.isEmptyObject(f))n.extend(this.cache[e],b);else for(d in b)f[d]=b[d];return f},get:function(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b]},access:function(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?(d=this.get(a,b),void 0!==d?d:this.get(a,n.camelCase(b))):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d,e,f=this.key(a),g=this.cache[f];if(void 0===b)this.cache[f]={};else{n.isArray(b)?d=b.concat(b.map(n.camelCase)):(e=n.camelCase(b),b in g?d=[b,e]:(d=e,d=d in g?[d]:d.match(E)||[])),c=d.length;while(c--)delete g[d[c]]}},hasData:function(a){return!n.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}};var L=new K,M=new K,N=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,O=/([A-Z])/g;function P(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(O,"-$1").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:N.test(c)?n.parseJSON(c):c}catch(e){}M.set(a,b,c)}else c=void 0;return c}n.extend({hasData:function(a){return M.hasData(a)||L.hasData(a)},data:function(a,b,c){return M.access(a,b,c)
},removeData:function(a,b){M.remove(a,b)},_data:function(a,b,c){return L.access(a,b,c)},_removeData:function(a,b){L.remove(a,b)}}),n.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=M.get(f),1===f.nodeType&&!L.get(f,"hasDataAttrs"))){c=g.length;while(c--)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=n.camelCase(d.slice(5)),P(f,d,e[d])));L.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){M.set(this,a)}):J(this,function(b){var c,d=n.camelCase(a);if(f&&void 0===b){if(c=M.get(f,a),void 0!==c)return c;if(c=M.get(f,d),void 0!==c)return c;if(c=P(f,d,void 0),void 0!==c)return c}else this.each(function(){var c=M.get(this,d);M.set(this,d,b),-1!==a.indexOf("-")&&void 0!==c&&M.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){M.remove(this,a)})}}),n.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=L.get(a,b),c&&(!d||n.isArray(c)?d=L.access(a,b,n.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=n.queue(a,b),d=c.length,e=c.shift(),f=n._queueHooks(a,b),g=function(){n.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return L.get(a,c)||L.access(a,c,{empty:n.Callbacks("once memory").add(function(){L.remove(a,[b+"queue",c])})})}}),n.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?n.queue(this[0],a):void 0===b?this:this.each(function(){var c=n.queue(this,a,b);n._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&n.dequeue(this,a)})},dequeue:function(a){return this.each(function(){n.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=n.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--)c=L.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var Q=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,R=["Top","Right","Bottom","Left"],S=function(a,b){return a=b||a,"none"===n.css(a,"display")||!n.contains(a.ownerDocument,a)},T=/^(?:checkbox|radio)$/i;!function(){var a=l.createDocumentFragment(),b=a.appendChild(l.createElement("div")),c=l.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),k.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",k.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var U="undefined";k.focusinBubbles="onfocusin"in a;var V=/^key/,W=/^(?:mouse|pointer|contextmenu)|click/,X=/^(?:focusinfocus|focusoutblur)$/,Y=/^([^.]*)(?:\.(.+)|)$/;function Z(){return!0}function $(){return!1}function _(){try{return l.activeElement}catch(a){}}n.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=L.get(a);if(r){c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=n.guid++),(i=r.events)||(i=r.events={}),(g=r.handle)||(g=r.handle=function(b){return typeof n!==U&&n.event.triggered!==b.type?n.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(E)||[""],j=b.length;while(j--)h=Y.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o&&(l=n.event.special[o]||{},o=(e?l.delegateType:l.bindType)||o,l=n.event.special[o]||{},k=n.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&n.expr.match.needsContext.test(e),namespace:p.join(".")},f),(m=i[o])||(m=i[o]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,p,g)!==!1||a.addEventListener&&a.addEventListener(o,g,!1)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),n.event.global[o]=!0)}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=L.hasData(a)&&L.get(a);if(r&&(i=r.events)){b=(b||"").match(E)||[""],j=b.length;while(j--)if(h=Y.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o){l=n.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,m=i[o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;while(f--)k=m[f],!e&&q!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,p,r.handle)!==!1||n.removeEvent(a,o,r.handle),delete i[o])}else for(o in i)n.event.remove(a,o+b[j],c,d,!0);n.isEmptyObject(i)&&(delete r.handle,L.remove(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,k,m,o,p=[d||l],q=j.call(b,"type")?b.type:b,r=j.call(b,"namespace")?b.namespace.split("."):[];if(g=h=d=d||l,3!==d.nodeType&&8!==d.nodeType&&!X.test(q+n.event.triggered)&&(q.indexOf(".")>=0&&(r=q.split("."),q=r.shift(),r.sort()),k=q.indexOf(":")<0&&"on"+q,b=b[n.expando]?b:new n.Event(q,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=r.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+r.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:n.makeArray(c,[b]),o=n.event.special[q]||{},e||!o.trigger||o.trigger.apply(d,c)!==!1)){if(!e&&!o.noBubble&&!n.isWindow(d)){for(i=o.delegateType||q,X.test(i+q)||(g=g.parentNode);g;g=g.parentNode)p.push(g),h=g;h===(d.ownerDocument||l)&&p.push(h.defaultView||h.parentWindow||a)}f=0;while((g=p[f++])&&!b.isPropagationStopped())b.type=f>1?i:o.bindType||q,m=(L.get(g,"events")||{})[b.type]&&L.get(g,"handle"),m&&m.apply(g,c),m=k&&g[k],m&&m.apply&&n.acceptData(g)&&(b.result=m.apply(g,c),b.result===!1&&b.preventDefault());return b.type=q,e||b.isDefaultPrevented()||o._default&&o._default.apply(p.pop(),c)!==!1||!n.acceptData(d)||k&&n.isFunction(d[q])&&!n.isWindow(d)&&(h=d[k],h&&(d[k]=null),n.event.triggered=q,d[q](),n.event.triggered=void 0,h&&(d[k]=h)),b.result}},dispatch:function(a){a=n.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(L.get(this,"events")||{})[a.type]||[],k=n.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){h=n.event.handlers.call(this,a,j),b=0;while((f=h[b++])&&!a.isPropagationStopped()){a.currentTarget=f.elem,c=0;while((g=f.handlers[c++])&&!a.isImmediatePropagationStopped())(!a.namespace_re||a.namespace_re.test(g.namespace))&&(a.handleObj=g,a.data=g.data,e=((n.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,i),void 0!==e&&(a.result=e)===!1&&(a.preventDefault(),a.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!==this;i=i.parentNode||this)if(i.disabled!==!0||"click"!==a.type){for(d=[],c=0;h>c;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?n(e,this).index(i)>=0:n.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||l,d=c.documentElement,e=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},fix:function(a){if(a[n.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];g||(this.fixHooks[e]=g=W.test(e)?this.mouseHooks:V.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new n.Event(f),b=d.length;while(b--)c=d[b],a[c]=f[c];return a.target||(a.target=l),3===a.target.nodeType&&(a.target=a.target.parentNode),g.filter?g.filter(a,f):a},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==_()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===_()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&n.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(a){return n.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=n.extend(new n.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?n.event.trigger(e,null,b):n.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},n.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)},n.Event=function(a,b){return this instanceof n.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?Z:$):this.type=a,b&&n.extend(this,b),this.timeStamp=a&&a.timeStamp||n.now(),void(this[n.expando]=!0)):new n.Event(a,b)},n.Event.prototype={isDefaultPrevented:$,isPropagationStopped:$,isImmediatePropagationStopped:$,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=Z,a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=Z,a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=Z,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},n.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){n.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!n.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),k.focusinBubbles||n.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){n.event.simulate(b,a.target,n.event.fix(a),!0)};n.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=L.access(d,b);e||d.addEventListener(a,c,!0),L.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=L.access(d,b)-1;e?L.access(d,b,e):(d.removeEventListener(a,c,!0),L.remove(d,b))}}}),n.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(g in a)this.on(g,b,c,a[g],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=$;else if(!d)return this;return 1===e&&(f=d,d=function(a){return n().off(a),f.apply(this,arguments)},d.guid=f.guid||(f.guid=n.guid++)),this.each(function(){n.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,n(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=$),this.each(function(){n.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){n.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?n.event.trigger(a,b,c,!0):void 0}});var ab=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bb=/<([\w:]+)/,cb=/<|&#?\w+;/,db=/<(?:script|style|link)/i,eb=/checked\s*(?:[^=]|=\s*.checked.)/i,fb=/^$|\/(?:java|ecma)script/i,gb=/^true\/(.*)/,hb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ib={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ib.optgroup=ib.option,ib.tbody=ib.tfoot=ib.colgroup=ib.caption=ib.thead,ib.th=ib.td;function jb(a,b){return n.nodeName(a,"table")&&n.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function kb(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function lb(a){var b=gb.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function mb(a,b){for(var c=0,d=a.length;d>c;c++)L.set(a[c],"globalEval",!b||L.get(b[c],"globalEval"))}function nb(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(L.hasData(a)&&(f=L.access(a),g=L.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;d>c;c++)n.event.add(b,e,j[e][c])}M.hasData(a)&&(h=M.access(a),i=n.extend({},h),M.set(b,i))}}function ob(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&n.nodeName(a,b)?n.merge([a],c):c}function pb(a,b){var c=b.nodeName.toLowerCase();"input"===c&&T.test(a.type)?b.checked=a.checked:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}n.extend({clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=n.contains(a.ownerDocument,a);if(!(k.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||n.isXMLDoc(a)))for(g=ob(h),f=ob(a),d=0,e=f.length;e>d;d++)pb(f[d],g[d]);if(b)if(c)for(f=f||ob(a),g=g||ob(h),d=0,e=f.length;e>d;d++)nb(f[d],g[d]);else nb(a,h);return g=ob(h,"script"),g.length>0&&mb(g,!i&&ob(a,"script")),h},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k=b.createDocumentFragment(),l=[],m=0,o=a.length;o>m;m++)if(e=a[m],e||0===e)if("object"===n.type(e))n.merge(l,e.nodeType?[e]:e);else if(cb.test(e)){f=f||k.appendChild(b.createElement("div")),g=(bb.exec(e)||["",""])[1].toLowerCase(),h=ib[g]||ib._default,f.innerHTML=h[1]+e.replace(ab,"<$1></$2>")+h[2],j=h[0];while(j--)f=f.lastChild;n.merge(l,f.childNodes),f=k.firstChild,f.textContent=""}else l.push(b.createTextNode(e));k.textContent="",m=0;while(e=l[m++])if((!d||-1===n.inArray(e,d))&&(i=n.contains(e.ownerDocument,e),f=ob(k.appendChild(e),"script"),i&&mb(f),c)){j=0;while(e=f[j++])fb.test(e.type||"")&&c.push(e)}return k},cleanData:function(a){for(var b,c,d,e,f=n.event.special,g=0;void 0!==(c=a[g]);g++){if(n.acceptData(c)&&(e=c[L.expando],e&&(b=L.cache[e]))){if(b.events)for(d in b.events)f[d]?n.event.remove(c,d):n.removeEvent(c,d,b.handle);L.cache[e]&&delete L.cache[e]}delete M.cache[c[M.expando]]}}}),n.fn.extend({text:function(a){return J(this,function(a){return void 0===a?n.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=a)})},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=jb(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=jb(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?n.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||n.cleanData(ob(c)),c.parentNode&&(b&&n.contains(c.ownerDocument,c)&&mb(ob(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(n.cleanData(ob(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return n.clone(this,a,b)})},html:function(a){return J(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!db.test(a)&&!ib[(bb.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(ab,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(n.cleanData(ob(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,n.cleanData(ob(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,l=this.length,m=this,o=l-1,p=a[0],q=n.isFunction(p);if(q||l>1&&"string"==typeof p&&!k.checkClone&&eb.test(p))return this.each(function(c){var d=m.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b)});if(l&&(c=n.buildFragment(a,this[0].ownerDocument,!1,this),d=c.firstChild,1===c.childNodes.length&&(c=d),d)){for(f=n.map(ob(c,"script"),kb),g=f.length;l>j;j++)h=c,j!==o&&(h=n.clone(h,!0,!0),g&&n.merge(f,ob(h,"script"))),b.call(this[j],h,j);if(g)for(i=f[f.length-1].ownerDocument,n.map(f,lb),j=0;g>j;j++)h=f[j],fb.test(h.type||"")&&!L.access(h,"globalEval")&&n.contains(i,h)&&(h.src?n._evalUrl&&n._evalUrl(h.src):n.globalEval(h.textContent.replace(hb,"")))}return this}}),n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){n.fn[a]=function(a){for(var c,d=[],e=n(a),g=e.length-1,h=0;g>=h;h++)c=h===g?this:this.clone(!0),n(e[h])[b](c),f.apply(d,c.get());return this.pushStack(d)}});var qb,rb={};function sb(b,c){var d,e=n(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:n.css(e[0],"display");return e.detach(),f}function tb(a){var b=l,c=rb[a];return c||(c=sb(a,b),"none"!==c&&c||(qb=(qb||n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=qb[0].contentDocument,b.write(),b.close(),c=sb(a,b),qb.detach()),rb[a]=c),c}var ub=/^margin/,vb=new RegExp("^("+Q+")(?!px)[a-z%]+$","i"),wb=function(b){return b.ownerDocument.defaultView.opener?b.ownerDocument.defaultView.getComputedStyle(b,null):a.getComputedStyle(b,null)};function xb(a,b,c){var d,e,f,g,h=a.style;return c=c||wb(a),c&&(g=c.getPropertyValue(b)||c[b]),c&&(""!==g||n.contains(a.ownerDocument,a)||(g=n.style(a,b)),vb.test(g)&&ub.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function yb(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}!function(){var b,c,d=l.documentElement,e=l.createElement("div"),f=l.createElement("div");if(f.style){f.style.backgroundClip="content-box",f.cloneNode(!0).style.backgroundClip="",k.clearCloneStyle="content-box"===f.style.backgroundClip,e.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",e.appendChild(f);function g(){f.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",f.innerHTML="",d.appendChild(e);var g=a.getComputedStyle(f,null);b="1%"!==g.top,c="4px"===g.width,d.removeChild(e)}a.getComputedStyle&&n.extend(k,{pixelPosition:function(){return g(),b},boxSizingReliable:function(){return null==c&&g(),c},reliableMarginRight:function(){var b,c=f.appendChild(l.createElement("div"));return c.style.cssText=f.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",c.style.marginRight=c.style.width="0",f.style.width="1px",d.appendChild(e),b=!parseFloat(a.getComputedStyle(c,null).marginRight),d.removeChild(e),f.removeChild(c),b}})}}(),n.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var zb=/^(none|table(?!-c[ea]).+)/,Ab=new RegExp("^("+Q+")(.*)$","i"),Bb=new RegExp("^([+-])=("+Q+")","i"),Cb={position:"absolute",visibility:"hidden",display:"block"},Db={letterSpacing:"0",fontWeight:"400"},Eb=["Webkit","O","Moz","ms"];function Fb(a,b){if(b in a)return b;var c=b[0].toUpperCase()+b.slice(1),d=b,e=Eb.length;while(e--)if(b=Eb[e]+c,b in a)return b;return d}function Gb(a,b,c){var d=Ab.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function Hb(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=n.css(a,c+R[f],!0,e)),d?("content"===c&&(g-=n.css(a,"padding"+R[f],!0,e)),"margin"!==c&&(g-=n.css(a,"border"+R[f]+"Width",!0,e))):(g+=n.css(a,"padding"+R[f],!0,e),"padding"!==c&&(g+=n.css(a,"border"+R[f]+"Width",!0,e)));return g}function Ib(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=wb(a),g="border-box"===n.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=xb(a,b,f),(0>e||null==e)&&(e=a.style[b]),vb.test(e))return e;d=g&&(k.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Hb(a,b,c||(g?"border":"content"),d,f)+"px"}function Jb(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=L.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&S(d)&&(f[g]=L.access(d,"olddisplay",tb(d.nodeName)))):(e=S(d),"none"===c&&e||L.set(d,"olddisplay",e?c:n.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}n.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=xb(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=n.camelCase(b),i=a.style;return b=n.cssProps[h]||(n.cssProps[h]=Fb(i,h)),g=n.cssHooks[b]||n.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c,"string"===f&&(e=Bb.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(n.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||n.cssNumber[h]||(c+="px"),k.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c)),void 0)}},css:function(a,b,c,d){var e,f,g,h=n.camelCase(b);return b=n.cssProps[h]||(n.cssProps[h]=Fb(a.style,h)),g=n.cssHooks[b]||n.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=xb(a,b,d)),"normal"===e&&b in Db&&(e=Db[b]),""===c||c?(f=parseFloat(e),c===!0||n.isNumeric(f)?f||0:e):e}}),n.each(["height","width"],function(a,b){n.cssHooks[b]={get:function(a,c,d){return c?zb.test(n.css(a,"display"))&&0===a.offsetWidth?n.swap(a,Cb,function(){return Ib(a,b,d)}):Ib(a,b,d):void 0},set:function(a,c,d){var e=d&&wb(a);return Gb(a,c,d?Hb(a,b,d,"border-box"===n.css(a,"boxSizing",!1,e),e):0)}}}),n.cssHooks.marginRight=yb(k.reliableMarginRight,function(a,b){return b?n.swap(a,{display:"inline-block"},xb,[a,"marginRight"]):void 0}),n.each({margin:"",padding:"",border:"Width"},function(a,b){n.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+R[d]+b]=f[d]||f[d-2]||f[0];return e}},ub.test(a)||(n.cssHooks[a+b].set=Gb)}),n.fn.extend({css:function(a,b){return J(this,function(a,b,c){var d,e,f={},g=0;if(n.isArray(b)){for(d=wb(a),e=b.length;e>g;g++)f[b[g]]=n.css(a,b[g],!1,d);return f}return void 0!==c?n.style(a,b,c):n.css(a,b)},a,b,arguments.length>1)},show:function(){return Jb(this,!0)},hide:function(){return Jb(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){S(this)?n(this).show():n(this).hide()})}});function Kb(a,b,c,d,e){return new Kb.prototype.init(a,b,c,d,e)}n.Tween=Kb,Kb.prototype={constructor:Kb,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(n.cssNumber[c]?"":"px")},cur:function(){var a=Kb.propHooks[this.prop];return a&&a.get?a.get(this):Kb.propHooks._default.get(this)},run:function(a){var b,c=Kb.propHooks[this.prop];return this.pos=b=this.options.duration?n.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Kb.propHooks._default.set(this),this}},Kb.prototype.init.prototype=Kb.prototype,Kb.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=n.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){n.fx.step[a.prop]?n.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[n.cssProps[a.prop]]||n.cssHooks[a.prop])?n.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},Kb.propHooks.scrollTop=Kb.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},n.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},n.fx=Kb.prototype.init,n.fx.step={};var Lb,Mb,Nb=/^(?:toggle|show|hide)$/,Ob=new RegExp("^(?:([+-])=|)("+Q+")([a-z%]*)$","i"),Pb=/queueHooks$/,Qb=[Vb],Rb={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=Ob.exec(b),f=e&&e[3]||(n.cssNumber[a]?"":"px"),g=(n.cssNumber[a]||"px"!==f&&+d)&&Ob.exec(n.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,n.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};function Sb(){return setTimeout(function(){Lb=void 0}),Lb=n.now()}function Tb(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b)c=R[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function Ub(a,b,c){for(var d,e=(Rb[b]||[]).concat(Rb["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function Vb(a,b,c){var d,e,f,g,h,i,j,k,l=this,m={},o=a.style,p=a.nodeType&&S(a),q=L.get(a,"fxshow");c.queue||(h=n._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,l.always(function(){l.always(function(){h.unqueued--,n.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[o.overflow,o.overflowX,o.overflowY],j=n.css(a,"display"),k="none"===j?L.get(a,"olddisplay")||tb(a.nodeName):j,"inline"===k&&"none"===n.css(a,"float")&&(o.display="inline-block")),c.overflow&&(o.overflow="hidden",l.always(function(){o.overflow=c.overflow[0],o.overflowX=c.overflow[1],o.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],Nb.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(p?"hide":"show")){if("show"!==e||!q||void 0===q[d])continue;p=!0}m[d]=q&&q[d]||n.style(a,d)}else j=void 0;if(n.isEmptyObject(m))"inline"===("none"===j?tb(a.nodeName):j)&&(o.display=j);else{q?"hidden"in q&&(p=q.hidden):q=L.access(a,"fxshow",{}),f&&(q.hidden=!p),p?n(a).show():l.done(function(){n(a).hide()}),l.done(function(){var b;L.remove(a,"fxshow");for(b in m)n.style(a,b,m[b])});for(d in m)g=Ub(p?q[d]:0,d,l),d in q||(q[d]=g.start,p&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function Wb(a,b){var c,d,e,f,g;for(c in a)if(d=n.camelCase(c),e=b[d],f=a[c],n.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=n.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function Xb(a,b,c){var d,e,f=0,g=Qb.length,h=n.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Lb||Sb(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:n.extend({},b),opts:n.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Lb||Sb(),duration:c.duration,tweens:[],createTween:function(b,c){var d=n.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(Wb(k,j.opts.specialEasing);g>f;f++)if(d=Qb[f].call(j,a,k,j.opts))return d;return n.map(k,Ub,j),n.isFunction(j.opts.start)&&j.opts.start.call(a,j),n.fx.timer(n.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}n.Animation=n.extend(Xb,{tweener:function(a,b){n.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],Rb[c]=Rb[c]||[],Rb[c].unshift(b)},prefilter:function(a,b){b?Qb.unshift(a):Qb.push(a)}}),n.speed=function(a,b,c){var d=a&&"object"==typeof a?n.extend({},a):{complete:c||!c&&b||n.isFunction(a)&&a,duration:a,easing:c&&b||b&&!n.isFunction(b)&&b};return d.duration=n.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in n.fx.speeds?n.fx.speeds[d.duration]:n.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){n.isFunction(d.old)&&d.old.call(this),d.queue&&n.dequeue(this,d.queue)},d},n.fn.extend({fadeTo:function(a,b,c,d){return this.filter(S).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=n.isEmptyObject(a),f=n.speed(b,c,d),g=function(){var b=Xb(this,n.extend({},a),f);(e||L.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=n.timers,g=L.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&Pb.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&n.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=L.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=n.timers,g=d?d.length:0;for(c.finish=!0,n.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),n.each(["toggle","show","hide"],function(a,b){var c=n.fn[b];n.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(Tb(b,!0),a,d,e)}}),n.each({slideDown:Tb("show"),slideUp:Tb("hide"),slideToggle:Tb("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){n.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),n.timers=[],n.fx.tick=function(){var a,b=0,c=n.timers;for(Lb=n.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||n.fx.stop(),Lb=void 0},n.fx.timer=function(a){n.timers.push(a),a()?n.fx.start():n.timers.pop()},n.fx.interval=13,n.fx.start=function(){Mb||(Mb=setInterval(n.fx.tick,n.fx.interval))},n.fx.stop=function(){clearInterval(Mb),Mb=null},n.fx.speeds={slow:600,fast:200,_default:400},n.fn.delay=function(a,b){return a=n.fx?n.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a=l.createElement("input"),b=l.createElement("select"),c=b.appendChild(l.createElement("option"));a.type="checkbox",k.checkOn=""!==a.value,k.optSelected=c.selected,b.disabled=!0,k.optDisabled=!c.disabled,a=l.createElement("input"),a.value="t",a.type="radio",k.radioValue="t"===a.value}();var Yb,Zb,$b=n.expr.attrHandle;n.fn.extend({attr:function(a,b){return J(this,n.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){n.removeAttr(this,a)})}}),n.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===U?n.prop(a,b,c):(1===f&&n.isXMLDoc(a)||(b=b.toLowerCase(),d=n.attrHooks[b]||(n.expr.match.bool.test(b)?Zb:Yb)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=n.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void n.removeAttr(a,b))
},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(E);if(f&&1===a.nodeType)while(c=f[e++])d=n.propFix[c]||c,n.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)},attrHooks:{type:{set:function(a,b){if(!k.radioValue&&"radio"===b&&n.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),Zb={set:function(a,b,c){return b===!1?n.removeAttr(a,c):a.setAttribute(c,c),c}},n.each(n.expr.match.bool.source.match(/\w+/g),function(a,b){var c=$b[b]||n.find.attr;$b[b]=function(a,b,d){var e,f;return d||(f=$b[b],$b[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,$b[b]=f),e}});var _b=/^(?:input|select|textarea|button)$/i;n.fn.extend({prop:function(a,b){return J(this,n.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[n.propFix[a]||a]})}}),n.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!n.isXMLDoc(a),f&&(b=n.propFix[b]||b,e=n.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||_b.test(a.nodeName)||a.href?a.tabIndex:-1}}}}),k.optSelected||(n.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null}}),n.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){n.propFix[this.toLowerCase()]=this});var ac=/[\t\r\n\f]/g;n.fn.extend({addClass:function(a){var b,c,d,e,f,g,h="string"==typeof a&&a,i=0,j=this.length;if(n.isFunction(a))return this.each(function(b){n(this).addClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(E)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ac," "):" ")){f=0;while(e=b[f++])d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=n.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0===arguments.length||"string"==typeof a&&a,i=0,j=this.length;if(n.isFunction(a))return this.each(function(b){n(this).removeClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(E)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ac," "):"")){f=0;while(e=b[f++])while(d.indexOf(" "+e+" ")>=0)d=d.replace(" "+e+" "," ");g=a?n.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(n.isFunction(a)?function(c){n(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c){var b,d=0,e=n(this),f=a.match(E)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else(c===U||"boolean"===c)&&(this.className&&L.set(this,"__className__",this.className),this.className=this.className||a===!1?"":L.get(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(ac," ").indexOf(b)>=0)return!0;return!1}});var bc=/\r/g;n.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=n.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,n(this).val()):a,null==e?e="":"number"==typeof e?e+="":n.isArray(e)&&(e=n.map(e,function(a){return null==a?"":a+""})),b=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=n.valHooks[e.type]||n.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(bc,""):null==c?"":c)}}}),n.extend({valHooks:{option:{get:function(a){var b=n.find.attr(a,"value");return null!=b?b:n.trim(n.text(a))}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(k.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&n.nodeName(c.parentNode,"optgroup"))){if(b=n(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c,d,e=a.options,f=n.makeArray(b),g=e.length;while(g--)d=e[g],(d.selected=n.inArray(d.value,f)>=0)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),n.each(["radio","checkbox"],function(){n.valHooks[this]={set:function(a,b){return n.isArray(b)?a.checked=n.inArray(n(a).val(),b)>=0:void 0}},k.checkOn||(n.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})}),n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){n.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),n.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var cc=n.now(),dc=/\?/;n.parseJSON=function(a){return JSON.parse(a+"")},n.parseXML=function(a){var b,c;if(!a||"string"!=typeof a)return null;try{c=new DOMParser,b=c.parseFromString(a,"text/xml")}catch(d){b=void 0}return(!b||b.getElementsByTagName("parsererror").length)&&n.error("Invalid XML: "+a),b};var ec=/#.*$/,fc=/([?&])_=[^&]*/,gc=/^(.*?):[ \t]*([^\r\n]*)$/gm,hc=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,ic=/^(?:GET|HEAD)$/,jc=/^\/\//,kc=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,lc={},mc={},nc="*/".concat("*"),oc=a.location.href,pc=kc.exec(oc.toLowerCase())||[];function qc(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(E)||[];if(n.isFunction(c))while(d=f[e++])"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function rc(a,b,c,d){var e={},f=a===mc;function g(h){var i;return e[h]=!0,n.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function sc(a,b){var c,d,e=n.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&n.extend(!0,a,d),a}function tc(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0])i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function uc(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:oc,type:"GET",isLocal:hc.test(pc[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":nc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":n.parseJSON,"text xml":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?sc(sc(a,n.ajaxSettings),b):sc(n.ajaxSettings,a)},ajaxPrefilter:qc(lc),ajaxTransport:qc(mc),ajax:function(a,b){"object"==typeof a&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=n.ajaxSetup({},b),l=k.context||k,m=k.context&&(l.nodeType||l.jquery)?n(l):n.event,o=n.Deferred(),p=n.Callbacks("once memory"),q=k.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!f){f={};while(b=gc.exec(e))f[b[1].toLowerCase()]=b[2]}b=f[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?e:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(k.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return c&&c.abort(b),x(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||oc)+"").replace(ec,"").replace(jc,pc[1]+"//"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=n.trim(k.dataType||"*").toLowerCase().match(E)||[""],null==k.crossDomain&&(h=kc.exec(k.url.toLowerCase()),k.crossDomain=!(!h||h[1]===pc[1]&&h[2]===pc[2]&&(h[3]||("http:"===h[1]?"80":"443"))===(pc[3]||("http:"===pc[1]?"80":"443")))),k.data&&k.processData&&"string"!=typeof k.data&&(k.data=n.param(k.data,k.traditional)),rc(lc,k,b,v),2===t)return v;i=n.event&&k.global,i&&0===n.active++&&n.event.trigger("ajaxStart"),k.type=k.type.toUpperCase(),k.hasContent=!ic.test(k.type),d=k.url,k.hasContent||(k.data&&(d=k.url+=(dc.test(d)?"&":"?")+k.data,delete k.data),k.cache===!1&&(k.url=fc.test(d)?d.replace(fc,"$1_="+cc++):d+(dc.test(d)?"&":"?")+"_="+cc++)),k.ifModified&&(n.lastModified[d]&&v.setRequestHeader("If-Modified-Since",n.lastModified[d]),n.etag[d]&&v.setRequestHeader("If-None-Match",n.etag[d])),(k.data&&k.hasContent&&k.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",k.contentType),v.setRequestHeader("Accept",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+("*"!==k.dataTypes[0]?", "+nc+"; q=0.01":""):k.accepts["*"]);for(j in k.headers)v.setRequestHeader(j,k.headers[j]);if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t))return v.abort();u="abort";for(j in{success:1,error:1,complete:1})v[j](k[j]);if(c=rc(mc,k,b,v)){v.readyState=1,i&&m.trigger("ajaxSend",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){v.abort("timeout")},k.timeout));try{t=1,c.send(r,x)}catch(w){if(!(2>t))throw w;x(-1,w)}}else x(-1,"No Transport");function x(a,b,f,h){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),c=void 0,e=h||"",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,f&&(u=tc(k,v,f)),u=uc(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader("Last-Modified"),w&&(n.lastModified[d]=w),w=v.getResponseHeader("etag"),w&&(n.etag[d]=w)),204===a||"HEAD"===k.type?x="nocontent":304===a?x="notmodified":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+"",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,i&&m.trigger(j?"ajaxSuccess":"ajaxError",[v,k,j?r:s]),p.fireWith(l,[v,x]),i&&(m.trigger("ajaxComplete",[v,k]),--n.active||n.event.trigger("ajaxStop")))}return v},getJSON:function(a,b,c){return n.get(a,b,c,"json")},getScript:function(a,b){return n.get(a,void 0,b,"script")}}),n.each(["get","post"],function(a,b){n[b]=function(a,c,d,e){return n.isFunction(c)&&(e=e||d,d=c,c=void 0),n.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),n._evalUrl=function(a){return n.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},n.fn.extend({wrapAll:function(a){var b;return n.isFunction(a)?this.each(function(b){n(this).wrapAll(a.call(this,b))}):(this[0]&&(b=n(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstElementChild)a=a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return this.each(n.isFunction(a)?function(b){n(this).wrapInner(a.call(this,b))}:function(){var b=n(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=n.isFunction(a);return this.each(function(c){n(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){n.nodeName(this,"body")||n(this).replaceWith(this.childNodes)}).end()}}),n.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0},n.expr.filters.visible=function(a){return!n.expr.filters.hidden(a)};var vc=/%20/g,wc=/\[\]$/,xc=/\r?\n/g,yc=/^(?:submit|button|image|reset|file)$/i,zc=/^(?:input|select|textarea|keygen)/i;function Ac(a,b,c,d){var e;if(n.isArray(b))n.each(b,function(b,e){c||wc.test(a)?d(a,e):Ac(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==n.type(b))d(a,b);else for(e in b)Ac(a+"["+e+"]",b[e],c,d)}n.param=function(a,b){var c,d=[],e=function(a,b){b=n.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(a)||a.jquery&&!n.isPlainObject(a))n.each(a,function(){e(this.name,this.value)});else for(c in a)Ac(c,a[c],b,e);return d.join("&").replace(vc,"+")},n.fn.extend({serialize:function(){return n.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=n.prop(this,"elements");return a?n.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!n(this).is(":disabled")&&zc.test(this.nodeName)&&!yc.test(a)&&(this.checked||!T.test(a))}).map(function(a,b){var c=n(this).val();return null==c?null:n.isArray(c)?n.map(c,function(a){return{name:b.name,value:a.replace(xc,"\r\n")}}):{name:b.name,value:c.replace(xc,"\r\n")}}).get()}}),n.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};var Bc=0,Cc={},Dc={0:200,1223:204},Ec=n.ajaxSettings.xhr();a.attachEvent&&a.attachEvent("onunload",function(){for(var a in Cc)Cc[a]()}),k.cors=!!Ec&&"withCredentials"in Ec,k.ajax=Ec=!!Ec,n.ajaxTransport(function(a){var b;return k.cors||Ec&&!a.crossDomain?{send:function(c,d){var e,f=a.xhr(),g=++Bc;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)f.setRequestHeader(e,c[e]);b=function(a){return function(){b&&(delete Cc[g],b=f.onload=f.onerror=null,"abort"===a?f.abort():"error"===a?d(f.status,f.statusText):d(Dc[f.status]||f.status,f.statusText,"string"==typeof f.responseText?{text:f.responseText}:void 0,f.getAllResponseHeaders()))}},f.onload=b(),f.onerror=b("error"),b=Cc[g]=b("abort");try{f.send(a.hasContent&&a.data||null)}catch(h){if(b)throw h}},abort:function(){b&&b()}}:void 0}),n.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return n.globalEval(a),a}}}),n.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),n.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=n("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&e("error"===a.type?404:200,a.type)}),l.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Fc=[],Gc=/(=)\?(?=&|$)|\?\?/;n.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Fc.pop()||n.expando+"_"+cc++;return this[a]=!0,a}}),n.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Gc.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Gc.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=n.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Gc,"$1"+e):b.jsonp!==!1&&(b.url+=(dc.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||n.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Fc.push(e)),g&&n.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),n.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||l;var d=v.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=n.buildFragment([a],b,e),e&&e.length&&n(e).remove(),n.merge([],d.childNodes))};var Hc=n.fn.load;n.fn.load=function(a,b,c){if("string"!=typeof a&&Hc)return Hc.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=n.trim(a.slice(h)),a=a.slice(0,h)),n.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&n.ajax({url:a,type:e,dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?n("<div>").append(n.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,f||[a.responseText,b,a])}),this},n.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){n.fn[b]=function(a){return this.on(b,a)}}),n.expr.filters.animated=function(a){return n.grep(n.timers,function(b){return a===b.elem}).length};var Ic=a.document.documentElement;function Jc(a){return n.isWindow(a)?a:9===a.nodeType&&a.defaultView}n.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=n.css(a,"position"),l=n(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=n.css(a,"top"),i=n.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),n.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},n.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){n.offset.setOffset(this,a,b)});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;if(f)return b=f.documentElement,n.contains(b,d)?(typeof d.getBoundingClientRect!==U&&(e=d.getBoundingClientRect()),c=Jc(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===n.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),n.nodeName(a[0],"html")||(d=a.offset()),d.top+=n.css(a[0],"borderTopWidth",!0),d.left+=n.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-n.css(c,"marginTop",!0),left:b.left-d.left-n.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||Ic;while(a&&!n.nodeName(a,"html")&&"static"===n.css(a,"position"))a=a.offsetParent;return a||Ic})}}),n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var d="pageYOffset"===c;n.fn[b]=function(e){return J(this,function(b,e,f){var g=Jc(b);return void 0===f?g?g[c]:b[e]:void(g?g.scrollTo(d?a.pageXOffset:f,d?f:a.pageYOffset):b[e]=f)},b,e,arguments.length,null)}}),n.each(["top","left"],function(a,b){n.cssHooks[b]=yb(k.pixelPosition,function(a,c){return c?(c=xb(a,b),vb.test(c)?n(a).position()[b]+"px":c):void 0})}),n.each({Height:"height",Width:"width"},function(a,b){n.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){n.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return J(this,function(b,c,d){var e;return n.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?n.css(b,c,g):n.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),n.fn.size=function(){return this.length},n.fn.andSelf=n.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return n});var Kc=a.jQuery,Lc=a.$;return n.noConflict=function(b){return a.$===n&&(a.$=Lc),b&&a.jQuery===n&&(a.jQuery=Kc),n},typeof b===U&&(a.jQuery=a.$=n),n});

/*! jQuery UI - v1.11.4 - 2015-03-19
* http://jqueryui.com
* Includes: core.js, widget.js, mouse.js, draggable.js, sortable.js
* Copyright 2015 jQuery Foundation and other contributors; Licensed MIT */

(function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define([ "jquery" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}(function( $ ) {
/*!
 * jQuery UI Core 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */


// $.ui might exist from components with no dependencies, e.g., $.ui.position
$.ui = $.ui || {};

$.extend( $.ui, {
	version: "1.11.4",

	keyCode: {
		BACKSPACE: 8,
		COMMA: 188,
		DELETE: 46,
		DOWN: 40,
		END: 35,
		ENTER: 13,
		ESCAPE: 27,
		HOME: 36,
		LEFT: 37,
		PAGE_DOWN: 34,
		PAGE_UP: 33,
		PERIOD: 190,
		RIGHT: 39,
		SPACE: 32,
		TAB: 9,
		UP: 38
	}
});

// plugins
$.fn.extend({
	scrollParent: function( includeHidden ) {
		var position = this.css( "position" ),
			excludeStaticParent = position === "absolute",
			overflowRegex = includeHidden ? /(auto|scroll|hidden)/ : /(auto|scroll)/,
			scrollParent = this.parents().filter( function() {
				var parent = $( this );
				if ( excludeStaticParent && parent.css( "position" ) === "static" ) {
					return false;
				}
				return overflowRegex.test( parent.css( "overflow" ) + parent.css( "overflow-y" ) + parent.css( "overflow-x" ) );
			}).eq( 0 );

		return position === "fixed" || !scrollParent.length ? $( this[ 0 ].ownerDocument || document ) : scrollParent;
	},

	uniqueId: (function() {
		var uuid = 0;

		return function() {
			return this.each(function() {
				if ( !this.id ) {
					this.id = "ui-id-" + ( ++uuid );
				}
			});
		};
	})(),

	removeUniqueId: function() {
		return this.each(function() {
			if ( /^ui-id-\d+$/.test( this.id ) ) {
				$( this ).removeAttr( "id" );
			}
		});
	}
});

// selectors
function focusable( element, isTabIndexNotNaN ) {
	var map, mapName, img,
		nodeName = element.nodeName.toLowerCase();
	if ( "area" === nodeName ) {
		map = element.parentNode;
		mapName = map.name;
		if ( !element.href || !mapName || map.nodeName.toLowerCase() !== "map" ) {
			return false;
		}
		img = $( "img[usemap='#" + mapName + "']" )[ 0 ];
		return !!img && visible( img );
	}
	return ( /^(input|select|textarea|button|object)$/.test( nodeName ) ?
		!element.disabled :
		"a" === nodeName ?
			element.href || isTabIndexNotNaN :
			isTabIndexNotNaN) &&
		// the element and all of its ancestors must be visible
		visible( element );
}

function visible( element ) {
	return $.expr.filters.visible( element ) &&
		!$( element ).parents().addBack().filter(function() {
			return $.css( this, "visibility" ) === "hidden";
		}).length;
}

$.extend( $.expr[ ":" ], {
	data: $.expr.createPseudo ?
		$.expr.createPseudo(function( dataName ) {
			return function( elem ) {
				return !!$.data( elem, dataName );
			};
		}) :
		// support: jQuery <1.8
		function( elem, i, match ) {
			return !!$.data( elem, match[ 3 ] );
		},

	focusable: function( element ) {
		return focusable( element, !isNaN( $.attr( element, "tabindex" ) ) );
	},

	tabbable: function( element ) {
		var tabIndex = $.attr( element, "tabindex" ),
			isTabIndexNaN = isNaN( tabIndex );
		return ( isTabIndexNaN || tabIndex >= 0 ) && focusable( element, !isTabIndexNaN );
	}
});

// support: jQuery <1.8
if ( !$( "<a>" ).outerWidth( 1 ).jquery ) {
	$.each( [ "Width", "Height" ], function( i, name ) {
		var side = name === "Width" ? [ "Left", "Right" ] : [ "Top", "Bottom" ],
			type = name.toLowerCase(),
			orig = {
				innerWidth: $.fn.innerWidth,
				innerHeight: $.fn.innerHeight,
				outerWidth: $.fn.outerWidth,
				outerHeight: $.fn.outerHeight
			};

		function reduce( elem, size, border, margin ) {
			$.each( side, function() {
				size -= parseFloat( $.css( elem, "padding" + this ) ) || 0;
				if ( border ) {
					size -= parseFloat( $.css( elem, "border" + this + "Width" ) ) || 0;
				}
				if ( margin ) {
					size -= parseFloat( $.css( elem, "margin" + this ) ) || 0;
				}
			});
			return size;
		}

		$.fn[ "inner" + name ] = function( size ) {
			if ( size === undefined ) {
				return orig[ "inner" + name ].call( this );
			}

			return this.each(function() {
				$( this ).css( type, reduce( this, size ) + "px" );
			});
		};

		$.fn[ "outer" + name] = function( size, margin ) {
			if ( typeof size !== "number" ) {
				return orig[ "outer" + name ].call( this, size );
			}

			return this.each(function() {
				$( this).css( type, reduce( this, size, true, margin ) + "px" );
			});
		};
	});
}

// support: jQuery <1.8
if ( !$.fn.addBack ) {
	$.fn.addBack = function( selector ) {
		return this.add( selector == null ?
			this.prevObject : this.prevObject.filter( selector )
		);
	};
}

// support: jQuery 1.6.1, 1.6.2 (http://bugs.jquery.com/ticket/9413)
if ( $( "<a>" ).data( "a-b", "a" ).removeData( "a-b" ).data( "a-b" ) ) {
	$.fn.removeData = (function( removeData ) {
		return function( key ) {
			if ( arguments.length ) {
				return removeData.call( this, $.camelCase( key ) );
			} else {
				return removeData.call( this );
			}
		};
	})( $.fn.removeData );
}

// deprecated
$.ui.ie = !!/msie [\w.]+/.exec( navigator.userAgent.toLowerCase() );

$.fn.extend({
	focus: (function( orig ) {
		return function( delay, fn ) {
			return typeof delay === "number" ?
				this.each(function() {
					var elem = this;
					setTimeout(function() {
						$( elem ).focus();
						if ( fn ) {
							fn.call( elem );
						}
					}, delay );
				}) :
				orig.apply( this, arguments );
		};
	})( $.fn.focus ),

	disableSelection: (function() {
		var eventType = "onselectstart" in document.createElement( "div" ) ?
			"selectstart" :
			"mousedown";

		return function() {
			return this.bind( eventType + ".ui-disableSelection", function( event ) {
				event.preventDefault();
			});
		};
	})(),

	enableSelection: function() {
		return this.unbind( ".ui-disableSelection" );
	},

	zIndex: function( zIndex ) {
		if ( zIndex !== undefined ) {
			return this.css( "zIndex", zIndex );
		}

		if ( this.length ) {
			var elem = $( this[ 0 ] ), position, value;
			while ( elem.length && elem[ 0 ] !== document ) {
				// Ignore z-index if position is set to a value where z-index is ignored by the browser
				// This makes behavior of this function consistent across browsers
				// WebKit always returns auto if the element is positioned
				position = elem.css( "position" );
				if ( position === "absolute" || position === "relative" || position === "fixed" ) {
					// IE returns 0 when zIndex is not specified
					// other browsers return a string
					// we ignore the case of nested elements with an explicit value of 0
					// <div style="z-index: -10;"><div style="z-index: 0;"></div></div>
					value = parseInt( elem.css( "zIndex" ), 10 );
					if ( !isNaN( value ) && value !== 0 ) {
						return value;
					}
				}
				elem = elem.parent();
			}
		}

		return 0;
	}
});

// $.ui.plugin is deprecated. Use $.widget() extensions instead.
$.ui.plugin = {
	add: function( module, option, set ) {
		var i,
			proto = $.ui[ module ].prototype;
		for ( i in set ) {
			proto.plugins[ i ] = proto.plugins[ i ] || [];
			proto.plugins[ i ].push( [ option, set[ i ] ] );
		}
	},
	call: function( instance, name, args, allowDisconnected ) {
		var i,
			set = instance.plugins[ name ];

		if ( !set ) {
			return;
		}

		if ( !allowDisconnected && ( !instance.element[ 0 ].parentNode || instance.element[ 0 ].parentNode.nodeType === 11 ) ) {
			return;
		}

		for ( i = 0; i < set.length; i++ ) {
			if ( instance.options[ set[ i ][ 0 ] ] ) {
				set[ i ][ 1 ].apply( instance.element, args );
			}
		}
	}
};


/*!
 * jQuery UI Widget 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */


var widget_uuid = 0,
	widget_slice = Array.prototype.slice;

$.cleanData = (function( orig ) {
	return function( elems ) {
		var events, elem, i;
		for ( i = 0; (elem = elems[i]) != null; i++ ) {
			try {

				// Only trigger remove when necessary to save time
				events = $._data( elem, "events" );
				if ( events && events.remove ) {
					$( elem ).triggerHandler( "remove" );
				}

			// http://bugs.jquery.com/ticket/8235
			} catch ( e ) {}
		}
		orig( elems );
	};
})( $.cleanData );

$.widget = function( name, base, prototype ) {
	var fullName, existingConstructor, constructor, basePrototype,
		// proxiedPrototype allows the provided prototype to remain unmodified
		// so that it can be used as a mixin for multiple widgets (#8876)
		proxiedPrototype = {},
		namespace = name.split( "." )[ 0 ];

	name = name.split( "." )[ 1 ];
	fullName = namespace + "-" + name;

	if ( !prototype ) {
		prototype = base;
		base = $.Widget;
	}

	// create selector for plugin
	$.expr[ ":" ][ fullName.toLowerCase() ] = function( elem ) {
		return !!$.data( elem, fullName );
	};

	$[ namespace ] = $[ namespace ] || {};
	existingConstructor = $[ namespace ][ name ];
	constructor = $[ namespace ][ name ] = function( options, element ) {
		// allow instantiation without "new" keyword
		if ( !this._createWidget ) {
			return new constructor( options, element );
		}

		// allow instantiation without initializing for simple inheritance
		// must use "new" keyword (the code above always passes args)
		if ( arguments.length ) {
			this._createWidget( options, element );
		}
	};
	// extend with the existing constructor to carry over any static properties
	$.extend( constructor, existingConstructor, {
		version: prototype.version,
		// copy the object used to create the prototype in case we need to
		// redefine the widget later
		_proto: $.extend( {}, prototype ),
		// track widgets that inherit from this widget in case this widget is
		// redefined after a widget inherits from it
		_childConstructors: []
	});

	basePrototype = new base();
	// we need to make the options hash a property directly on the new instance
	// otherwise we'll modify the options hash on the prototype that we're
	// inheriting from
	basePrototype.options = $.widget.extend( {}, basePrototype.options );
	$.each( prototype, function( prop, value ) {
		if ( !$.isFunction( value ) ) {
			proxiedPrototype[ prop ] = value;
			return;
		}
		proxiedPrototype[ prop ] = (function() {
			var _super = function() {
					return base.prototype[ prop ].apply( this, arguments );
				},
				_superApply = function( args ) {
					return base.prototype[ prop ].apply( this, args );
				};
			return function() {
				var __super = this._super,
					__superApply = this._superApply,
					returnValue;

				this._super = _super;
				this._superApply = _superApply;

				returnValue = value.apply( this, arguments );

				this._super = __super;
				this._superApply = __superApply;

				return returnValue;
			};
		})();
	});
	constructor.prototype = $.widget.extend( basePrototype, {
		// TODO: remove support for widgetEventPrefix
		// always use the name + a colon as the prefix, e.g., draggable:start
		// don't prefix for widgets that aren't DOM-based
		widgetEventPrefix: existingConstructor ? (basePrototype.widgetEventPrefix || name) : name
	}, proxiedPrototype, {
		constructor: constructor,
		namespace: namespace,
		widgetName: name,
		widgetFullName: fullName
	});

	// If this widget is being redefined then we need to find all widgets that
	// are inheriting from it and redefine all of them so that they inherit from
	// the new version of this widget. We're essentially trying to replace one
	// level in the prototype chain.
	if ( existingConstructor ) {
		$.each( existingConstructor._childConstructors, function( i, child ) {
			var childPrototype = child.prototype;

			// redefine the child widget using the same prototype that was
			// originally used, but inherit from the new version of the base
			$.widget( childPrototype.namespace + "." + childPrototype.widgetName, constructor, child._proto );
		});
		// remove the list of existing child constructors from the old constructor
		// so the old child constructors can be garbage collected
		delete existingConstructor._childConstructors;
	} else {
		base._childConstructors.push( constructor );
	}

	$.widget.bridge( name, constructor );

	return constructor;
};

$.widget.extend = function( target ) {
	var input = widget_slice.call( arguments, 1 ),
		inputIndex = 0,
		inputLength = input.length,
		key,
		value;
	for ( ; inputIndex < inputLength; inputIndex++ ) {
		for ( key in input[ inputIndex ] ) {
			value = input[ inputIndex ][ key ];
			if ( input[ inputIndex ].hasOwnProperty( key ) && value !== undefined ) {
				// Clone objects
				if ( $.isPlainObject( value ) ) {
					target[ key ] = $.isPlainObject( target[ key ] ) ?
						$.widget.extend( {}, target[ key ], value ) :
						// Don't extend strings, arrays, etc. with objects
						$.widget.extend( {}, value );
				// Copy everything else by reference
				} else {
					target[ key ] = value;
				}
			}
		}
	}
	return target;
};

$.widget.bridge = function( name, object ) {
	var fullName = object.prototype.widgetFullName || name;
	$.fn[ name ] = function( options ) {
		var isMethodCall = typeof options === "string",
			args = widget_slice.call( arguments, 1 ),
			returnValue = this;

		if ( isMethodCall ) {
			this.each(function() {
				var methodValue,
					instance = $.data( this, fullName );
				if ( options === "instance" ) {
					returnValue = instance;
					return false;
				}
				if ( !instance ) {
					return $.error( "cannot call methods on " + name + " prior to initialization; " +
						"attempted to call method '" + options + "'" );
				}
				if ( !$.isFunction( instance[options] ) || options.charAt( 0 ) === "_" ) {
					return $.error( "no such method '" + options + "' for " + name + " widget instance" );
				}
				methodValue = instance[ options ].apply( instance, args );
				if ( methodValue !== instance && methodValue !== undefined ) {
					returnValue = methodValue && methodValue.jquery ?
						returnValue.pushStack( methodValue.get() ) :
						methodValue;
					return false;
				}
			});
		} else {

			// Allow multiple hashes to be passed on init
			if ( args.length ) {
				options = $.widget.extend.apply( null, [ options ].concat(args) );
			}

			this.each(function() {
				var instance = $.data( this, fullName );
				if ( instance ) {
					instance.option( options || {} );
					if ( instance._init ) {
						instance._init();
					}
				} else {
					$.data( this, fullName, new object( options, this ) );
				}
			});
		}

		return returnValue;
	};
};

$.Widget = function( /* options, element */ ) {};
$.Widget._childConstructors = [];

$.Widget.prototype = {
	widgetName: "widget",
	widgetEventPrefix: "",
	defaultElement: "<div>",
	options: {
		disabled: false,

		// callbacks
		create: null
	},
	_createWidget: function( options, element ) {
		element = $( element || this.defaultElement || this )[ 0 ];
		this.element = $( element );
		this.uuid = widget_uuid++;
		this.eventNamespace = "." + this.widgetName + this.uuid;

		this.bindings = $();
		this.hoverable = $();
		this.focusable = $();

		if ( element !== this ) {
			$.data( element, this.widgetFullName, this );
			this._on( true, this.element, {
				remove: function( event ) {
					if ( event.target === element ) {
						this.destroy();
					}
				}
			});
			this.document = $( element.style ?
				// element within the document
				element.ownerDocument :
				// element is window or document
				element.document || element );
			this.window = $( this.document[0].defaultView || this.document[0].parentWindow );
		}

		this.options = $.widget.extend( {},
			this.options,
			this._getCreateOptions(),
			options );

		this._create();
		this._trigger( "create", null, this._getCreateEventData() );
		this._init();
	},
	_getCreateOptions: $.noop,
	_getCreateEventData: $.noop,
	_create: $.noop,
	_init: $.noop,

	destroy: function() {
		this._destroy();
		// we can probably remove the unbind calls in 2.0
		// all event bindings should go through this._on()
		this.element
			.unbind( this.eventNamespace )
			.removeData( this.widgetFullName )
			// support: jquery <1.6.3
			// http://bugs.jquery.com/ticket/9413
			.removeData( $.camelCase( this.widgetFullName ) );
		this.widget()
			.unbind( this.eventNamespace )
			.removeAttr( "aria-disabled" )
			.removeClass(
				this.widgetFullName + "-disabled " +
				"ui-state-disabled" );

		// clean up events and states
		this.bindings.unbind( this.eventNamespace );
		this.hoverable.removeClass( "ui-state-hover" );
		this.focusable.removeClass( "ui-state-focus" );
	},
	_destroy: $.noop,

	widget: function() {
		return this.element;
	},

	option: function( key, value ) {
		var options = key,
			parts,
			curOption,
			i;

		if ( arguments.length === 0 ) {
			// don't return a reference to the internal hash
			return $.widget.extend( {}, this.options );
		}

		if ( typeof key === "string" ) {
			// handle nested keys, e.g., "foo.bar" => { foo: { bar: ___ } }
			options = {};
			parts = key.split( "." );
			key = parts.shift();
			if ( parts.length ) {
				curOption = options[ key ] = $.widget.extend( {}, this.options[ key ] );
				for ( i = 0; i < parts.length - 1; i++ ) {
					curOption[ parts[ i ] ] = curOption[ parts[ i ] ] || {};
					curOption = curOption[ parts[ i ] ];
				}
				key = parts.pop();
				if ( arguments.length === 1 ) {
					return curOption[ key ] === undefined ? null : curOption[ key ];
				}
				curOption[ key ] = value;
			} else {
				if ( arguments.length === 1 ) {
					return this.options[ key ] === undefined ? null : this.options[ key ];
				}
				options[ key ] = value;
			}
		}

		this._setOptions( options );

		return this;
	},
	_setOptions: function( options ) {
		var key;

		for ( key in options ) {
			this._setOption( key, options[ key ] );
		}

		return this;
	},
	_setOption: function( key, value ) {
		this.options[ key ] = value;

		if ( key === "disabled" ) {
			this.widget()
				.toggleClass( this.widgetFullName + "-disabled", !!value );

			// If the widget is becoming disabled, then nothing is interactive
			if ( value ) {
				this.hoverable.removeClass( "ui-state-hover" );
				this.focusable.removeClass( "ui-state-focus" );
			}
		}

		return this;
	},

	enable: function() {
		return this._setOptions({ disabled: false });
	},
	disable: function() {
		return this._setOptions({ disabled: true });
	},

	_on: function( suppressDisabledCheck, element, handlers ) {
		var delegateElement,
			instance = this;

		// no suppressDisabledCheck flag, shuffle arguments
		if ( typeof suppressDisabledCheck !== "boolean" ) {
			handlers = element;
			element = suppressDisabledCheck;
			suppressDisabledCheck = false;
		}

		// no element argument, shuffle and use this.element
		if ( !handlers ) {
			handlers = element;
			element = this.element;
			delegateElement = this.widget();
		} else {
			element = delegateElement = $( element );
			this.bindings = this.bindings.add( element );
		}

		$.each( handlers, function( event, handler ) {
			function handlerProxy() {
				// allow widgets to customize the disabled handling
				// - disabled as an array instead of boolean
				// - disabled class as method for disabling individual parts
				if ( !suppressDisabledCheck &&
						( instance.options.disabled === true ||
							$( this ).hasClass( "ui-state-disabled" ) ) ) {
					return;
				}
				return ( typeof handler === "string" ? instance[ handler ] : handler )
					.apply( instance, arguments );
			}

			// copy the guid so direct unbinding works
			if ( typeof handler !== "string" ) {
				handlerProxy.guid = handler.guid =
					handler.guid || handlerProxy.guid || $.guid++;
			}

			var match = event.match( /^([\w:-]*)\s*(.*)$/ ),
				eventName = match[1] + instance.eventNamespace,
				selector = match[2];
			if ( selector ) {
				delegateElement.delegate( selector, eventName, handlerProxy );
			} else {
				element.bind( eventName, handlerProxy );
			}
		});
	},

	_off: function( element, eventName ) {
		eventName = (eventName || "").split( " " ).join( this.eventNamespace + " " ) +
			this.eventNamespace;
		element.unbind( eventName ).undelegate( eventName );

		// Clear the stack to avoid memory leaks (#10056)
		this.bindings = $( this.bindings.not( element ).get() );
		this.focusable = $( this.focusable.not( element ).get() );
		this.hoverable = $( this.hoverable.not( element ).get() );
	},

	_delay: function( handler, delay ) {
		function handlerProxy() {
			return ( typeof handler === "string" ? instance[ handler ] : handler )
				.apply( instance, arguments );
		}
		var instance = this;
		return setTimeout( handlerProxy, delay || 0 );
	},

	_hoverable: function( element ) {
		this.hoverable = this.hoverable.add( element );
		this._on( element, {
			mouseenter: function( event ) {
				$( event.currentTarget ).addClass( "ui-state-hover" );
			},
			mouseleave: function( event ) {
				$( event.currentTarget ).removeClass( "ui-state-hover" );
			}
		});
	},

	_focusable: function( element ) {
		this.focusable = this.focusable.add( element );
		this._on( element, {
			focusin: function( event ) {
				$( event.currentTarget ).addClass( "ui-state-focus" );
			},
			focusout: function( event ) {
				$( event.currentTarget ).removeClass( "ui-state-focus" );
			}
		});
	},

	_trigger: function( type, event, data ) {
		var prop, orig,
			callback = this.options[ type ];

		data = data || {};
		event = $.Event( event );
		event.type = ( type === this.widgetEventPrefix ?
			type :
			this.widgetEventPrefix + type ).toLowerCase();
		// the original event may come from any element
		// so we need to reset the target on the new event
		event.target = this.element[ 0 ];

		// copy original event properties over to the new event
		orig = event.originalEvent;
		if ( orig ) {
			for ( prop in orig ) {
				if ( !( prop in event ) ) {
					event[ prop ] = orig[ prop ];
				}
			}
		}

		this.element.trigger( event, data );
		return !( $.isFunction( callback ) &&
			callback.apply( this.element[0], [ event ].concat( data ) ) === false ||
			event.isDefaultPrevented() );
	}
};

$.each( { show: "fadeIn", hide: "fadeOut" }, function( method, defaultEffect ) {
	$.Widget.prototype[ "_" + method ] = function( element, options, callback ) {
		if ( typeof options === "string" ) {
			options = { effect: options };
		}
		var hasOptions,
			effectName = !options ?
				method :
				options === true || typeof options === "number" ?
					defaultEffect :
					options.effect || defaultEffect;
		options = options || {};
		if ( typeof options === "number" ) {
			options = { duration: options };
		}
		hasOptions = !$.isEmptyObject( options );
		options.complete = callback;
		if ( options.delay ) {
			element.delay( options.delay );
		}
		if ( hasOptions && $.effects && $.effects.effect[ effectName ] ) {
			element[ method ]( options );
		} else if ( effectName !== method && element[ effectName ] ) {
			element[ effectName ]( options.duration, options.easing, callback );
		} else {
			element.queue(function( next ) {
				$( this )[ method ]();
				if ( callback ) {
					callback.call( element[ 0 ] );
				}
				next();
			});
		}
	};
});

var widget = $.widget;


/*!
 * jQuery UI Mouse 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/mouse/
 */


var mouseHandled = false;
$( document ).mouseup( function() {
	mouseHandled = false;
});

var mouse = $.widget("ui.mouse", {
	version: "1.11.4",
	options: {
		cancel: "input,textarea,button,select,option",
		distance: 1,
		delay: 0
	},
	_mouseInit: function() {
		var that = this;

		this.element
			.bind("mousedown." + this.widgetName, function(event) {
				return that._mouseDown(event);
			})
			.bind("click." + this.widgetName, function(event) {
				if (true === $.data(event.target, that.widgetName + ".preventClickEvent")) {
					$.removeData(event.target, that.widgetName + ".preventClickEvent");
					event.stopImmediatePropagation();
					return false;
				}
			});

		this.started = false;
	},

	// TODO: make sure destroying one instance of mouse doesn't mess with
	// other instances of mouse
	_mouseDestroy: function() {
		this.element.unbind("." + this.widgetName);
		if ( this._mouseMoveDelegate ) {
			this.document
				.unbind("mousemove." + this.widgetName, this._mouseMoveDelegate)
				.unbind("mouseup." + this.widgetName, this._mouseUpDelegate);
		}
	},

	_mouseDown: function(event) {
		// don't let more than one widget handle mouseStart
		if ( mouseHandled ) {
			return;
		}

		this._mouseMoved = false;

		// we may have missed mouseup (out of window)
		(this._mouseStarted && this._mouseUp(event));

		this._mouseDownEvent = event;

		var that = this,
			btnIsLeft = (event.which === 1),
			// event.target.nodeName works around a bug in IE 8 with
			// disabled inputs (#7620)
			elIsCancel = (typeof this.options.cancel === "string" && event.target.nodeName ? $(event.target).closest(this.options.cancel).length : false);
		if (!btnIsLeft || elIsCancel || !this._mouseCapture(event)) {
			return true;
		}

		this.mouseDelayMet = !this.options.delay;
		if (!this.mouseDelayMet) {
			this._mouseDelayTimer = setTimeout(function() {
				that.mouseDelayMet = true;
			}, this.options.delay);
		}

		if (this._mouseDistanceMet(event) && this._mouseDelayMet(event)) {
			this._mouseStarted = (this._mouseStart(event) !== false);
			if (!this._mouseStarted) {
				event.preventDefault();
				return true;
			}
		}

		// Click event may never have fired (Gecko & Opera)
		if (true === $.data(event.target, this.widgetName + ".preventClickEvent")) {
			$.removeData(event.target, this.widgetName + ".preventClickEvent");
		}

		// these delegates are required to keep context
		this._mouseMoveDelegate = function(event) {
			return that._mouseMove(event);
		};
		this._mouseUpDelegate = function(event) {
			return that._mouseUp(event);
		};

		this.document
			.bind( "mousemove." + this.widgetName, this._mouseMoveDelegate )
			.bind( "mouseup." + this.widgetName, this._mouseUpDelegate );

		event.preventDefault();

		mouseHandled = true;
		return true;
	},

	_mouseMove: function(event) {
		// Only check for mouseups outside the document if you've moved inside the document
		// at least once. This prevents the firing of mouseup in the case of IE<9, which will
		// fire a mousemove event if content is placed under the cursor. See #7778
		// Support: IE <9
		if ( this._mouseMoved ) {
			// IE mouseup check - mouseup happened when mouse was out of window
			if ($.ui.ie && ( !document.documentMode || document.documentMode < 9 ) && !event.button) {
				return this._mouseUp(event);

			// Iframe mouseup check - mouseup occurred in another document
			} else if ( !event.which ) {
				return this._mouseUp( event );
			}
		}

		if ( event.which || event.button ) {
			this._mouseMoved = true;
		}

		if (this._mouseStarted) {
			this._mouseDrag(event);
			return event.preventDefault();
		}

		if (this._mouseDistanceMet(event) && this._mouseDelayMet(event)) {
			this._mouseStarted =
				(this._mouseStart(this._mouseDownEvent, event) !== false);
			(this._mouseStarted ? this._mouseDrag(event) : this._mouseUp(event));
		}

		return !this._mouseStarted;
	},

	_mouseUp: function(event) {
		this.document
			.unbind( "mousemove." + this.widgetName, this._mouseMoveDelegate )
			.unbind( "mouseup." + this.widgetName, this._mouseUpDelegate );

		if (this._mouseStarted) {
			this._mouseStarted = false;

			if (event.target === this._mouseDownEvent.target) {
				$.data(event.target, this.widgetName + ".preventClickEvent", true);
			}

			this._mouseStop(event);
		}

		mouseHandled = false;
		return false;
	},

	_mouseDistanceMet: function(event) {
		return (Math.max(
				Math.abs(this._mouseDownEvent.pageX - event.pageX),
				Math.abs(this._mouseDownEvent.pageY - event.pageY)
			) >= this.options.distance
		);
	},

	_mouseDelayMet: function(/* event */) {
		return this.mouseDelayMet;
	},

	// These are placeholder methods, to be overriden by extending plugin
	_mouseStart: function(/* event */) {},
	_mouseDrag: function(/* event */) {},
	_mouseStop: function(/* event */) {},
	_mouseCapture: function(/* event */) { return true; }
});


/*!
 * jQuery UI Draggable 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/draggable/
 */


$.widget("ui.draggable", $.ui.mouse, {
	version: "1.11.4",
	widgetEventPrefix: "drag",
	options: {
		addClasses: true,
		appendTo: "parent",
		axis: false,
		connectToSortable: false,
		containment: false,
		cursor: "auto",
		cursorAt: false,
		grid: false,
		handle: false,
		helper: "original",
		iframeFix: false,
		opacity: false,
		refreshPositions: false,
		revert: false,
		revertDuration: 500,
		scope: "default",
		scroll: true,
		scrollSensitivity: 20,
		scrollSpeed: 20,
		snap: false,
		snapMode: "both",
		snapTolerance: 20,
		stack: false,
		zIndex: false,

		// callbacks
		drag: null,
		start: null,
		stop: null
	},
	_create: function() {

		if ( this.options.helper === "original" ) {
			this._setPositionRelative();
		}
		if (this.options.addClasses){
			this.element.addClass("ui-draggable");
		}
		if (this.options.disabled){
			this.element.addClass("ui-draggable-disabled");
		}
		this._setHandleClassName();

		this._mouseInit();
	},

	_setOption: function( key, value ) {
		this._super( key, value );
		if ( key === "handle" ) {
			this._removeHandleClassName();
			this._setHandleClassName();
		}
	},

	_destroy: function() {
		if ( ( this.helper || this.element ).is( ".ui-draggable-dragging" ) ) {
			this.destroyOnClear = true;
			return;
		}
		this.element.removeClass( "ui-draggable ui-draggable-dragging ui-draggable-disabled" );
		this._removeHandleClassName();
		this._mouseDestroy();
	},

	_mouseCapture: function(event) {
		var o = this.options;

		this._blurActiveElement( event );

		// among others, prevent a drag on a resizable-handle
		if (this.helper || o.disabled || $(event.target).closest(".ui-resizable-handle").length > 0) {
			return false;
		}

		//Quit if we're not on a valid handle
		this.handle = this._getHandle(event);
		if (!this.handle) {
			return false;
		}

		this._blockFrames( o.iframeFix === true ? "iframe" : o.iframeFix );

		return true;

	},

	_blockFrames: function( selector ) {
		this.iframeBlocks = this.document.find( selector ).map(function() {
			var iframe = $( this );

			return $( "<div>" )
				.css( "position", "absolute" )
				.appendTo( iframe.parent() )
				.outerWidth( iframe.outerWidth() )
				.outerHeight( iframe.outerHeight() )
				.offset( iframe.offset() )[ 0 ];
		});
	},

	_unblockFrames: function() {
		if ( this.iframeBlocks ) {
			this.iframeBlocks.remove();
			delete this.iframeBlocks;
		}
	},

	_blurActiveElement: function( event ) {
		var document = this.document[ 0 ];

		// Only need to blur if the event occurred on the draggable itself, see #10527
		if ( !this.handleElement.is( event.target ) ) {
			return;
		}

		// support: IE9
		// IE9 throws an "Unspecified error" accessing document.activeElement from an <iframe>
		try {

			// Support: IE9, IE10
			// If the <body> is blurred, IE will switch windows, see #9520
			if ( document.activeElement && document.activeElement.nodeName.toLowerCase() !== "body" ) {

				// Blur any element that currently has focus, see #4261
				$( document.activeElement ).blur();
			}
		} catch ( error ) {}
	},

	_mouseStart: function(event) {

		var o = this.options;

		//Create and append the visible helper
		this.helper = this._createHelper(event);

		this.helper.addClass("ui-draggable-dragging");

		//Cache the helper size
		this._cacheHelperProportions();

		//If ddmanager is used for droppables, set the global draggable
		if ($.ui.ddmanager) {
			$.ui.ddmanager.current = this;
		}

		/*
		 * - Position generation -
		 * This block generates everything position related - it's the core of draggables.
		 */

		//Cache the margins of the original element
		this._cacheMargins();

		//Store the helper's css position
		this.cssPosition = this.helper.css( "position" );
		this.scrollParent = this.helper.scrollParent( true );
		this.offsetParent = this.helper.offsetParent();
		this.hasFixedAncestor = this.helper.parents().filter(function() {
				return $( this ).css( "position" ) === "fixed";
			}).length > 0;

		//The element's absolute position on the page minus margins
		this.positionAbs = this.element.offset();
		this._refreshOffsets( event );

		//Generate the original position
		this.originalPosition = this.position = this._generatePosition( event, false );
		this.originalPageX = event.pageX;
		this.originalPageY = event.pageY;

		//Adjust the mouse offset relative to the helper if "cursorAt" is supplied
		(o.cursorAt && this._adjustOffsetFromHelper(o.cursorAt));

		//Set a containment if given in the options
		this._setContainment();

		//Trigger event + callbacks
		if (this._trigger("start", event) === false) {
			this._clear();
			return false;
		}

		//Recache the helper size
		this._cacheHelperProportions();

		//Prepare the droppable offsets
		if ($.ui.ddmanager && !o.dropBehaviour) {
			$.ui.ddmanager.prepareOffsets(this, event);
		}

		// Reset helper's right/bottom css if they're set and set explicit width/height instead
		// as this prevents resizing of elements with right/bottom set (see #7772)
		this._normalizeRightBottom();

		this._mouseDrag(event, true); //Execute the drag once - this causes the helper not to be visible before getting its correct position

		//If the ddmanager is used for droppables, inform the manager that dragging has started (see #5003)
		if ( $.ui.ddmanager ) {
			$.ui.ddmanager.dragStart(this, event);
		}

		return true;
	},

	_refreshOffsets: function( event ) {
		this.offset = {
			top: this.positionAbs.top - this.margins.top,
			left: this.positionAbs.left - this.margins.left,
			scroll: false,
			parent: this._getParentOffset(),
			relative: this._getRelativeOffset()
		};

		this.offset.click = {
			left: event.pageX - this.offset.left,
			top: event.pageY - this.offset.top
		};
	},

	_mouseDrag: function(event, noPropagation) {
		// reset any necessary cached properties (see #5009)
		if ( this.hasFixedAncestor ) {
			this.offset.parent = this._getParentOffset();
		}

		//Compute the helpers position
		this.position = this._generatePosition( event, true );
		this.positionAbs = this._convertPositionTo("absolute");

		//Call plugins and callbacks and use the resulting position if something is returned
		if (!noPropagation) {
			var ui = this._uiHash();
			if (this._trigger("drag", event, ui) === false) {
				this._mouseUp({});
				return false;
			}
			this.position = ui.position;
		}

		this.helper[ 0 ].style.left = this.position.left + "px";
		this.helper[ 0 ].style.top = this.position.top + "px";

		if ($.ui.ddmanager) {
			$.ui.ddmanager.drag(this, event);
		}

		return false;
	},

	_mouseStop: function(event) {

		//If we are using droppables, inform the manager about the drop
		var that = this,
			dropped = false;
		if ($.ui.ddmanager && !this.options.dropBehaviour) {
			dropped = $.ui.ddmanager.drop(this, event);
		}

		//if a drop comes from outside (a sortable)
		if (this.dropped) {
			dropped = this.dropped;
			this.dropped = false;
		}

		if ((this.options.revert === "invalid" && !dropped) || (this.options.revert === "valid" && dropped) || this.options.revert === true || ($.isFunction(this.options.revert) && this.options.revert.call(this.element, dropped))) {
			$(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function() {
				if (that._trigger("stop", event) !== false) {
					that._clear();
				}
			});
		} else {
			if (this._trigger("stop", event) !== false) {
				this._clear();
			}
		}

		return false;
	},

	_mouseUp: function( event ) {
		this._unblockFrames();

		//If the ddmanager is used for droppables, inform the manager that dragging has stopped (see #5003)
		if ( $.ui.ddmanager ) {
			$.ui.ddmanager.dragStop(this, event);
		}

		// Only need to focus if the event occurred on the draggable itself, see #10527
		if ( this.handleElement.is( event.target ) ) {
			// The interaction is over; whether or not the click resulted in a drag, focus the element
			this.element.focus();
		}

		return $.ui.mouse.prototype._mouseUp.call(this, event);
	},

	cancel: function() {

		if (this.helper.is(".ui-draggable-dragging")) {
			this._mouseUp({});
		} else {
			this._clear();
		}

		return this;

	},

	_getHandle: function(event) {
		return this.options.handle ?
			!!$( event.target ).closest( this.element.find( this.options.handle ) ).length :
			true;
	},

	_setHandleClassName: function() {
		this.handleElement = this.options.handle ?
			this.element.find( this.options.handle ) : this.element;
		this.handleElement.addClass( "ui-draggable-handle" );
	},

	_removeHandleClassName: function() {
		this.handleElement.removeClass( "ui-draggable-handle" );
	},

	_createHelper: function(event) {

		var o = this.options,
			helperIsFunction = $.isFunction( o.helper ),
			helper = helperIsFunction ?
				$( o.helper.apply( this.element[ 0 ], [ event ] ) ) :
				( o.helper === "clone" ?
					this.element.clone().removeAttr( "id" ) :
					this.element );

		if (!helper.parents("body").length) {
			helper.appendTo((o.appendTo === "parent" ? this.element[0].parentNode : o.appendTo));
		}

		// http://bugs.jqueryui.com/ticket/9446
		// a helper function can return the original element
		// which wouldn't have been set to relative in _create
		if ( helperIsFunction && helper[ 0 ] === this.element[ 0 ] ) {
			this._setPositionRelative();
		}

		if (helper[0] !== this.element[0] && !(/(fixed|absolute)/).test(helper.css("position"))) {
			helper.css("position", "absolute");
		}

		return helper;

	},

	_setPositionRelative: function() {
		if ( !( /^(?:r|a|f)/ ).test( this.element.css( "position" ) ) ) {
			this.element[ 0 ].style.position = "relative";
		}
	},

	_adjustOffsetFromHelper: function(obj) {
		if (typeof obj === "string") {
			obj = obj.split(" ");
		}
		if ($.isArray(obj)) {
			obj = { left: +obj[0], top: +obj[1] || 0 };
		}
		if ("left" in obj) {
			this.offset.click.left = obj.left + this.margins.left;
		}
		if ("right" in obj) {
			this.offset.click.left = this.helperProportions.width - obj.right + this.margins.left;
		}
		if ("top" in obj) {
			this.offset.click.top = obj.top + this.margins.top;
		}
		if ("bottom" in obj) {
			this.offset.click.top = this.helperProportions.height - obj.bottom + this.margins.top;
		}
	},

	_isRootNode: function( element ) {
		return ( /(html|body)/i ).test( element.tagName ) || element === this.document[ 0 ];
	},

	_getParentOffset: function() {

		//Get the offsetParent and cache its position
		var po = this.offsetParent.offset(),
			document = this.document[ 0 ];

		// This is a special case where we need to modify a offset calculated on start, since the following happened:
		// 1. The position of the helper is absolute, so it's position is calculated based on the next positioned parent
		// 2. The actual offset parent is a child of the scroll parent, and the scroll parent isn't the document, which means that
		//    the scroll is included in the initial calculation of the offset of the parent, and never recalculated upon drag
		if (this.cssPosition === "absolute" && this.scrollParent[0] !== document && $.contains(this.scrollParent[0], this.offsetParent[0])) {
			po.left += this.scrollParent.scrollLeft();
			po.top += this.scrollParent.scrollTop();
		}

		if ( this._isRootNode( this.offsetParent[ 0 ] ) ) {
			po = { top: 0, left: 0 };
		}

		return {
			top: po.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),
			left: po.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)
		};

	},

	_getRelativeOffset: function() {
		if ( this.cssPosition !== "relative" ) {
			return { top: 0, left: 0 };
		}

		var p = this.element.position(),
			scrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] );

		return {
			top: p.top - ( parseInt(this.helper.css( "top" ), 10) || 0 ) + ( !scrollIsRootNode ? this.scrollParent.scrollTop() : 0 ),
			left: p.left - ( parseInt(this.helper.css( "left" ), 10) || 0 ) + ( !scrollIsRootNode ? this.scrollParent.scrollLeft() : 0 )
		};

	},

	_cacheMargins: function() {
		this.margins = {
			left: (parseInt(this.element.css("marginLeft"), 10) || 0),
			top: (parseInt(this.element.css("marginTop"), 10) || 0),
			right: (parseInt(this.element.css("marginRight"), 10) || 0),
			bottom: (parseInt(this.element.css("marginBottom"), 10) || 0)
		};
	},

	_cacheHelperProportions: function() {
		this.helperProportions = {
			width: this.helper.outerWidth(),
			height: this.helper.outerHeight()
		};
	},

	_setContainment: function() {

		var isUserScrollable, c, ce,
			o = this.options,
			document = this.document[ 0 ];

		this.relativeContainer = null;

		if ( !o.containment ) {
			this.containment = null;
			return;
		}

		if ( o.containment === "window" ) {
			this.containment = [
				$( window ).scrollLeft() - this.offset.relative.left - this.offset.parent.left,
				$( window ).scrollTop() - this.offset.relative.top - this.offset.parent.top,
				$( window ).scrollLeft() + $( window ).width() - this.helperProportions.width - this.margins.left,
				$( window ).scrollTop() + ( $( window ).height() || document.body.parentNode.scrollHeight ) - this.helperProportions.height - this.margins.top
			];
			return;
		}

		if ( o.containment === "document") {
			this.containment = [
				0,
				0,
				$( document ).width() - this.helperProportions.width - this.margins.left,
				( $( document ).height() || document.body.parentNode.scrollHeight ) - this.helperProportions.height - this.margins.top
			];
			return;
		}

		if ( o.containment.constructor === Array ) {
			this.containment = o.containment;
			return;
		}

		if ( o.containment === "parent" ) {
			o.containment = this.helper[ 0 ].parentNode;
		}

		c = $( o.containment );
		ce = c[ 0 ];

		if ( !ce ) {
			return;
		}

		isUserScrollable = /(scroll|auto)/.test( c.css( "overflow" ) );

		this.containment = [
			( parseInt( c.css( "borderLeftWidth" ), 10 ) || 0 ) + ( parseInt( c.css( "paddingLeft" ), 10 ) || 0 ),
			( parseInt( c.css( "borderTopWidth" ), 10 ) || 0 ) + ( parseInt( c.css( "paddingTop" ), 10 ) || 0 ),
			( isUserScrollable ? Math.max( ce.scrollWidth, ce.offsetWidth ) : ce.offsetWidth ) -
				( parseInt( c.css( "borderRightWidth" ), 10 ) || 0 ) -
				( parseInt( c.css( "paddingRight" ), 10 ) || 0 ) -
				this.helperProportions.width -
				this.margins.left -
				this.margins.right,
			( isUserScrollable ? Math.max( ce.scrollHeight, ce.offsetHeight ) : ce.offsetHeight ) -
				( parseInt( c.css( "borderBottomWidth" ), 10 ) || 0 ) -
				( parseInt( c.css( "paddingBottom" ), 10 ) || 0 ) -
				this.helperProportions.height -
				this.margins.top -
				this.margins.bottom
		];
		this.relativeContainer = c;
	},

	_convertPositionTo: function(d, pos) {

		if (!pos) {
			pos = this.position;
		}

		var mod = d === "absolute" ? 1 : -1,
			scrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] );

		return {
			top: (
				pos.top	+																// The absolute mouse position
				this.offset.relative.top * mod +										// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.top * mod -										// The offsetParent's offset without borders (offset + border)
				( ( this.cssPosition === "fixed" ? -this.offset.scroll.top : ( scrollIsRootNode ? 0 : this.offset.scroll.top ) ) * mod)
			),
			left: (
				pos.left +																// The absolute mouse position
				this.offset.relative.left * mod +										// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.left * mod	-										// The offsetParent's offset without borders (offset + border)
				( ( this.cssPosition === "fixed" ? -this.offset.scroll.left : ( scrollIsRootNode ? 0 : this.offset.scroll.left ) ) * mod)
			)
		};

	},

	_generatePosition: function( event, constrainPosition ) {

		var containment, co, top, left,
			o = this.options,
			scrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] ),
			pageX = event.pageX,
			pageY = event.pageY;

		// Cache the scroll
		if ( !scrollIsRootNode || !this.offset.scroll ) {
			this.offset.scroll = {
				top: this.scrollParent.scrollTop(),
				left: this.scrollParent.scrollLeft()
			};
		}

		/*
		 * - Position constraining -
		 * Constrain the position to a mix of grid, containment.
		 */

		// If we are not dragging yet, we won't check for options
		if ( constrainPosition ) {
			if ( this.containment ) {
				if ( this.relativeContainer ){
					co = this.relativeContainer.offset();
					containment = [
						this.containment[ 0 ] + co.left,
						this.containment[ 1 ] + co.top,
						this.containment[ 2 ] + co.left,
						this.containment[ 3 ] + co.top
					];
				} else {
					containment = this.containment;
				}

				if (event.pageX - this.offset.click.left < containment[0]) {
					pageX = containment[0] + this.offset.click.left;
				}
				if (event.pageY - this.offset.click.top < containment[1]) {
					pageY = containment[1] + this.offset.click.top;
				}
				if (event.pageX - this.offset.click.left > containment[2]) {
					pageX = containment[2] + this.offset.click.left;
				}
				if (event.pageY - this.offset.click.top > containment[3]) {
					pageY = containment[3] + this.offset.click.top;
				}
			}

			if (o.grid) {
				//Check for grid elements set to 0 to prevent divide by 0 error causing invalid argument errors in IE (see ticket #6950)
				top = o.grid[1] ? this.originalPageY + Math.round((pageY - this.originalPageY) / o.grid[1]) * o.grid[1] : this.originalPageY;
				pageY = containment ? ((top - this.offset.click.top >= containment[1] || top - this.offset.click.top > containment[3]) ? top : ((top - this.offset.click.top >= containment[1]) ? top - o.grid[1] : top + o.grid[1])) : top;

				left = o.grid[0] ? this.originalPageX + Math.round((pageX - this.originalPageX) / o.grid[0]) * o.grid[0] : this.originalPageX;
				pageX = containment ? ((left - this.offset.click.left >= containment[0] || left - this.offset.click.left > containment[2]) ? left : ((left - this.offset.click.left >= containment[0]) ? left - o.grid[0] : left + o.grid[0])) : left;
			}

			if ( o.axis === "y" ) {
				pageX = this.originalPageX;
			}

			if ( o.axis === "x" ) {
				pageY = this.originalPageY;
			}
		}

		return {
			top: (
				pageY -																	// The absolute mouse position
				this.offset.click.top	-												// Click offset (relative to the element)
				this.offset.relative.top -												// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.top +												// The offsetParent's offset without borders (offset + border)
				( this.cssPosition === "fixed" ? -this.offset.scroll.top : ( scrollIsRootNode ? 0 : this.offset.scroll.top ) )
			),
			left: (
				pageX -																	// The absolute mouse position
				this.offset.click.left -												// Click offset (relative to the element)
				this.offset.relative.left -												// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.left +												// The offsetParent's offset without borders (offset + border)
				( this.cssPosition === "fixed" ? -this.offset.scroll.left : ( scrollIsRootNode ? 0 : this.offset.scroll.left ) )
			)
		};

	},

	_clear: function() {
		this.helper.removeClass("ui-draggable-dragging");
		if (this.helper[0] !== this.element[0] && !this.cancelHelperRemoval) {
			this.helper.remove();
		}
		this.helper = null;
		this.cancelHelperRemoval = false;
		if ( this.destroyOnClear ) {
			this.destroy();
		}
	},

	_normalizeRightBottom: function() {
		if ( this.options.axis !== "y" && this.helper.css( "right" ) !== "auto" ) {
			this.helper.width( this.helper.width() );
			this.helper.css( "right", "auto" );
		}
		if ( this.options.axis !== "x" && this.helper.css( "bottom" ) !== "auto" ) {
			this.helper.height( this.helper.height() );
			this.helper.css( "bottom", "auto" );
		}
	},

	// From now on bulk stuff - mainly helpers

	_trigger: function( type, event, ui ) {
		ui = ui || this._uiHash();
		$.ui.plugin.call( this, type, [ event, ui, this ], true );

		// Absolute position and offset (see #6884 ) have to be recalculated after plugins
		if ( /^(drag|start|stop)/.test( type ) ) {
			this.positionAbs = this._convertPositionTo( "absolute" );
			ui.offset = this.positionAbs;
		}
		return $.Widget.prototype._trigger.call( this, type, event, ui );
	},

	plugins: {},

	_uiHash: function() {
		return {
			helper: this.helper,
			position: this.position,
			originalPosition: this.originalPosition,
			offset: this.positionAbs
		};
	}

});

$.ui.plugin.add( "draggable", "connectToSortable", {
	start: function( event, ui, draggable ) {
		var uiSortable = $.extend( {}, ui, {
			item: draggable.element
		});

		draggable.sortables = [];
		$( draggable.options.connectToSortable ).each(function() {
			var sortable = $( this ).sortable( "instance" );

			if ( sortable && !sortable.options.disabled ) {
				draggable.sortables.push( sortable );

				// refreshPositions is called at drag start to refresh the containerCache
				// which is used in drag. This ensures it's initialized and synchronized
				// with any changes that might have happened on the page since initialization.
				sortable.refreshPositions();
				sortable._trigger("activate", event, uiSortable);
			}
		});
	},
	stop: function( event, ui, draggable ) {
		var uiSortable = $.extend( {}, ui, {
			item: draggable.element
		});

		draggable.cancelHelperRemoval = false;

		$.each( draggable.sortables, function() {
			var sortable = this;

			if ( sortable.isOver ) {
				sortable.isOver = 0;

				// Allow this sortable to handle removing the helper
				draggable.cancelHelperRemoval = true;
				sortable.cancelHelperRemoval = false;

				// Use _storedCSS To restore properties in the sortable,
				// as this also handles revert (#9675) since the draggable
				// may have modified them in unexpected ways (#8809)
				sortable._storedCSS = {
					position: sortable.placeholder.css( "position" ),
					top: sortable.placeholder.css( "top" ),
					left: sortable.placeholder.css( "left" )
				};

				sortable._mouseStop(event);

				// Once drag has ended, the sortable should return to using
				// its original helper, not the shared helper from draggable
				sortable.options.helper = sortable.options._helper;
			} else {
				// Prevent this Sortable from removing the helper.
				// However, don't set the draggable to remove the helper
				// either as another connected Sortable may yet handle the removal.
				sortable.cancelHelperRemoval = true;

				sortable._trigger( "deactivate", event, uiSortable );
			}
		});
	},
	drag: function( event, ui, draggable ) {
		$.each( draggable.sortables, function() {
			var innermostIntersecting = false,
				sortable = this;

			// Copy over variables that sortable's _intersectsWith uses
			sortable.positionAbs = draggable.positionAbs;
			sortable.helperProportions = draggable.helperProportions;
			sortable.offset.click = draggable.offset.click;

			if ( sortable._intersectsWith( sortable.containerCache ) ) {
				innermostIntersecting = true;

				$.each( draggable.sortables, function() {
					// Copy over variables that sortable's _intersectsWith uses
					this.positionAbs = draggable.positionAbs;
					this.helperProportions = draggable.helperProportions;
					this.offset.click = draggable.offset.click;

					if ( this !== sortable &&
							this._intersectsWith( this.containerCache ) &&
							$.contains( sortable.element[ 0 ], this.element[ 0 ] ) ) {
						innermostIntersecting = false;
					}

					return innermostIntersecting;
				});
			}

			if ( innermostIntersecting ) {
				// If it intersects, we use a little isOver variable and set it once,
				// so that the move-in stuff gets fired only once.
				if ( !sortable.isOver ) {
					sortable.isOver = 1;

					// Store draggable's parent in case we need to reappend to it later.
					draggable._parent = ui.helper.parent();

					sortable.currentItem = ui.helper
						.appendTo( sortable.element )
						.data( "ui-sortable-item", true );

					// Store helper option to later restore it
					sortable.options._helper = sortable.options.helper;

					sortable.options.helper = function() {
						return ui.helper[ 0 ];
					};

					// Fire the start events of the sortable with our passed browser event,
					// and our own helper (so it doesn't create a new one)
					event.target = sortable.currentItem[ 0 ];
					sortable._mouseCapture( event, true );
					sortable._mouseStart( event, true, true );

					// Because the browser event is way off the new appended portlet,
					// modify necessary variables to reflect the changes
					sortable.offset.click.top = draggable.offset.click.top;
					sortable.offset.click.left = draggable.offset.click.left;
					sortable.offset.parent.left -= draggable.offset.parent.left -
						sortable.offset.parent.left;
					sortable.offset.parent.top -= draggable.offset.parent.top -
						sortable.offset.parent.top;

					draggable._trigger( "toSortable", event );

					// Inform draggable that the helper is in a valid drop zone,
					// used solely in the revert option to handle "valid/invalid".
					draggable.dropped = sortable.element;

					// Need to refreshPositions of all sortables in the case that
					// adding to one sortable changes the location of the other sortables (#9675)
					$.each( draggable.sortables, function() {
						this.refreshPositions();
					});

					// hack so receive/update callbacks work (mostly)
					draggable.currentItem = draggable.element;
					sortable.fromOutside = draggable;
				}

				if ( sortable.currentItem ) {
					sortable._mouseDrag( event );
					// Copy the sortable's position because the draggable's can potentially reflect
					// a relative position, while sortable is always absolute, which the dragged
					// element has now become. (#8809)
					ui.position = sortable.position;
				}
			} else {
				// If it doesn't intersect with the sortable, and it intersected before,
				// we fake the drag stop of the sortable, but make sure it doesn't remove
				// the helper by using cancelHelperRemoval.
				if ( sortable.isOver ) {

					sortable.isOver = 0;
					sortable.cancelHelperRemoval = true;

					// Calling sortable's mouseStop would trigger a revert,
					// so revert must be temporarily false until after mouseStop is called.
					sortable.options._revert = sortable.options.revert;
					sortable.options.revert = false;

					sortable._trigger( "out", event, sortable._uiHash( sortable ) );
					sortable._mouseStop( event, true );

					// restore sortable behaviors that were modfied
					// when the draggable entered the sortable area (#9481)
					sortable.options.revert = sortable.options._revert;
					sortable.options.helper = sortable.options._helper;

					if ( sortable.placeholder ) {
						sortable.placeholder.remove();
					}

					// Restore and recalculate the draggable's offset considering the sortable
					// may have modified them in unexpected ways. (#8809, #10669)
					ui.helper.appendTo( draggable._parent );
					draggable._refreshOffsets( event );
					ui.position = draggable._generatePosition( event, true );

					draggable._trigger( "fromSortable", event );

					// Inform draggable that the helper is no longer in a valid drop zone
					draggable.dropped = false;

					// Need to refreshPositions of all sortables just in case removing
					// from one sortable changes the location of other sortables (#9675)
					$.each( draggable.sortables, function() {
						this.refreshPositions();
					});
				}
			}
		});
	}
});

$.ui.plugin.add("draggable", "cursor", {
	start: function( event, ui, instance ) {
		var t = $( "body" ),
			o = instance.options;

		if (t.css("cursor")) {
			o._cursor = t.css("cursor");
		}
		t.css("cursor", o.cursor);
	},
	stop: function( event, ui, instance ) {
		var o = instance.options;
		if (o._cursor) {
			$("body").css("cursor", o._cursor);
		}
	}
});

$.ui.plugin.add("draggable", "opacity", {
	start: function( event, ui, instance ) {
		var t = $( ui.helper ),
			o = instance.options;
		if (t.css("opacity")) {
			o._opacity = t.css("opacity");
		}
		t.css("opacity", o.opacity);
	},
	stop: function( event, ui, instance ) {
		var o = instance.options;
		if (o._opacity) {
			$(ui.helper).css("opacity", o._opacity);
		}
	}
});

$.ui.plugin.add("draggable", "scroll", {
	start: function( event, ui, i ) {
		if ( !i.scrollParentNotHidden ) {
			i.scrollParentNotHidden = i.helper.scrollParent( false );
		}

		if ( i.scrollParentNotHidden[ 0 ] !== i.document[ 0 ] && i.scrollParentNotHidden[ 0 ].tagName !== "HTML" ) {
			i.overflowOffset = i.scrollParentNotHidden.offset();
		}
	},
	drag: function( event, ui, i  ) {

		var o = i.options,
			scrolled = false,
			scrollParent = i.scrollParentNotHidden[ 0 ],
			document = i.document[ 0 ];

		if ( scrollParent !== document && scrollParent.tagName !== "HTML" ) {
			if ( !o.axis || o.axis !== "x" ) {
				if ( ( i.overflowOffset.top + scrollParent.offsetHeight ) - event.pageY < o.scrollSensitivity ) {
					scrollParent.scrollTop = scrolled = scrollParent.scrollTop + o.scrollSpeed;
				} else if ( event.pageY - i.overflowOffset.top < o.scrollSensitivity ) {
					scrollParent.scrollTop = scrolled = scrollParent.scrollTop - o.scrollSpeed;
				}
			}

			if ( !o.axis || o.axis !== "y" ) {
				if ( ( i.overflowOffset.left + scrollParent.offsetWidth ) - event.pageX < o.scrollSensitivity ) {
					scrollParent.scrollLeft = scrolled = scrollParent.scrollLeft + o.scrollSpeed;
				} else if ( event.pageX - i.overflowOffset.left < o.scrollSensitivity ) {
					scrollParent.scrollLeft = scrolled = scrollParent.scrollLeft - o.scrollSpeed;
				}
			}

		} else {

			if (!o.axis || o.axis !== "x") {
				if (event.pageY - $(document).scrollTop() < o.scrollSensitivity) {
					scrolled = $(document).scrollTop($(document).scrollTop() - o.scrollSpeed);
				} else if ($(window).height() - (event.pageY - $(document).scrollTop()) < o.scrollSensitivity) {
					scrolled = $(document).scrollTop($(document).scrollTop() + o.scrollSpeed);
				}
			}

			if (!o.axis || o.axis !== "y") {
				if (event.pageX - $(document).scrollLeft() < o.scrollSensitivity) {
					scrolled = $(document).scrollLeft($(document).scrollLeft() - o.scrollSpeed);
				} else if ($(window).width() - (event.pageX - $(document).scrollLeft()) < o.scrollSensitivity) {
					scrolled = $(document).scrollLeft($(document).scrollLeft() + o.scrollSpeed);
				}
			}

		}

		if (scrolled !== false && $.ui.ddmanager && !o.dropBehaviour) {
			$.ui.ddmanager.prepareOffsets(i, event);
		}

	}
});

$.ui.plugin.add("draggable", "snap", {
	start: function( event, ui, i ) {

		var o = i.options;

		i.snapElements = [];

		$(o.snap.constructor !== String ? ( o.snap.items || ":data(ui-draggable)" ) : o.snap).each(function() {
			var $t = $(this),
				$o = $t.offset();
			if (this !== i.element[0]) {
				i.snapElements.push({
					item: this,
					width: $t.outerWidth(), height: $t.outerHeight(),
					top: $o.top, left: $o.left
				});
			}
		});

	},
	drag: function( event, ui, inst ) {

		var ts, bs, ls, rs, l, r, t, b, i, first,
			o = inst.options,
			d = o.snapTolerance,
			x1 = ui.offset.left, x2 = x1 + inst.helperProportions.width,
			y1 = ui.offset.top, y2 = y1 + inst.helperProportions.height;

		for (i = inst.snapElements.length - 1; i >= 0; i--){

			l = inst.snapElements[i].left - inst.margins.left;
			r = l + inst.snapElements[i].width;
			t = inst.snapElements[i].top - inst.margins.top;
			b = t + inst.snapElements[i].height;

			if ( x2 < l - d || x1 > r + d || y2 < t - d || y1 > b + d || !$.contains( inst.snapElements[ i ].item.ownerDocument, inst.snapElements[ i ].item ) ) {
				if (inst.snapElements[i].snapping) {
					(inst.options.snap.release && inst.options.snap.release.call(inst.element, event, $.extend(inst._uiHash(), { snapItem: inst.snapElements[i].item })));
				}
				inst.snapElements[i].snapping = false;
				continue;
			}

			if (o.snapMode !== "inner") {
				ts = Math.abs(t - y2) <= d;
				bs = Math.abs(b - y1) <= d;
				ls = Math.abs(l - x2) <= d;
				rs = Math.abs(r - x1) <= d;
				if (ts) {
					ui.position.top = inst._convertPositionTo("relative", { top: t - inst.helperProportions.height, left: 0 }).top;
				}
				if (bs) {
					ui.position.top = inst._convertPositionTo("relative", { top: b, left: 0 }).top;
				}
				if (ls) {
					ui.position.left = inst._convertPositionTo("relative", { top: 0, left: l - inst.helperProportions.width }).left;
				}
				if (rs) {
					ui.position.left = inst._convertPositionTo("relative", { top: 0, left: r }).left;
				}
			}

			first = (ts || bs || ls || rs);

			if (o.snapMode !== "outer") {
				ts = Math.abs(t - y1) <= d;
				bs = Math.abs(b - y2) <= d;
				ls = Math.abs(l - x1) <= d;
				rs = Math.abs(r - x2) <= d;
				if (ts) {
					ui.position.top = inst._convertPositionTo("relative", { top: t, left: 0 }).top;
				}
				if (bs) {
					ui.position.top = inst._convertPositionTo("relative", { top: b - inst.helperProportions.height, left: 0 }).top;
				}
				if (ls) {
					ui.position.left = inst._convertPositionTo("relative", { top: 0, left: l }).left;
				}
				if (rs) {
					ui.position.left = inst._convertPositionTo("relative", { top: 0, left: r - inst.helperProportions.width }).left;
				}
			}

			if (!inst.snapElements[i].snapping && (ts || bs || ls || rs || first)) {
				(inst.options.snap.snap && inst.options.snap.snap.call(inst.element, event, $.extend(inst._uiHash(), { snapItem: inst.snapElements[i].item })));
			}
			inst.snapElements[i].snapping = (ts || bs || ls || rs || first);

		}

	}
});

$.ui.plugin.add("draggable", "stack", {
	start: function( event, ui, instance ) {
		var min,
			o = instance.options,
			group = $.makeArray($(o.stack)).sort(function(a, b) {
				return (parseInt($(a).css("zIndex"), 10) || 0) - (parseInt($(b).css("zIndex"), 10) || 0);
			});

		if (!group.length) { return; }

		min = parseInt($(group[0]).css("zIndex"), 10) || 0;
		$(group).each(function(i) {
			$(this).css("zIndex", min + i);
		});
		this.css("zIndex", (min + group.length));
	}
});

$.ui.plugin.add("draggable", "zIndex", {
	start: function( event, ui, instance ) {
		var t = $( ui.helper ),
			o = instance.options;

		if (t.css("zIndex")) {
			o._zIndex = t.css("zIndex");
		}
		t.css("zIndex", o.zIndex);
	},
	stop: function( event, ui, instance ) {
		var o = instance.options;

		if (o._zIndex) {
			$(ui.helper).css("zIndex", o._zIndex);
		}
	}
});

var draggable = $.ui.draggable;


/*!
 * jQuery UI Sortable 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/sortable/
 */


var sortable = $.widget("ui.sortable", $.ui.mouse, {
	version: "1.11.4",
	widgetEventPrefix: "sort",
	ready: false,
	options: {
		appendTo: "parent",
		axis: false,
		connectWith: false,
		containment: false,
		cursor: "auto",
		cursorAt: false,
		dropOnEmpty: true,
		forcePlaceholderSize: false,
		forceHelperSize: false,
		grid: false,
		handle: false,
		helper: "original",
		items: "> *",
		opacity: false,
		placeholder: false,
		revert: false,
		scroll: true,
		scrollSensitivity: 20,
		scrollSpeed: 20,
		scope: "default",
		tolerance: "intersect",
		zIndex: 1000,

		// callbacks
		activate: null,
		beforeStop: null,
		change: null,
		deactivate: null,
		out: null,
		over: null,
		receive: null,
		remove: null,
		sort: null,
		start: null,
		stop: null,
		update: null
	},

	_isOverAxis: function( x, reference, size ) {
		return ( x >= reference ) && ( x < ( reference + size ) );
	},

	_isFloating: function( item ) {
		return (/left|right/).test(item.css("float")) || (/inline|table-cell/).test(item.css("display"));
	},

	_create: function() {
		this.containerCache = {};
		this.element.addClass("ui-sortable");

		//Get the items
		this.refresh();

		//Let's determine the parent's offset
		this.offset = this.element.offset();

		//Initialize mouse events for interaction
		this._mouseInit();

		this._setHandleClassName();

		//We're ready to go
		this.ready = true;

	},

	_setOption: function( key, value ) {
		this._super( key, value );

		if ( key === "handle" ) {
			this._setHandleClassName();
		}
	},

	_setHandleClassName: function() {
		this.element.find( ".ui-sortable-handle" ).removeClass( "ui-sortable-handle" );
		$.each( this.items, function() {
			( this.instance.options.handle ?
				this.item.find( this.instance.options.handle ) : this.item )
				.addClass( "ui-sortable-handle" );
		});
	},

	_destroy: function() {
		this.element
			.removeClass( "ui-sortable ui-sortable-disabled" )
			.find( ".ui-sortable-handle" )
				.removeClass( "ui-sortable-handle" );
		this._mouseDestroy();

		for ( var i = this.items.length - 1; i >= 0; i-- ) {
			this.items[i].item.removeData(this.widgetName + "-item");
		}

		return this;
	},

	_mouseCapture: function(event, overrideHandle) {
		var currentItem = null,
			validHandle = false,
			that = this;

		if (this.reverting) {
			return false;
		}

		if(this.options.disabled || this.options.type === "static") {
			return false;
		}

		//We have to refresh the items data once first
		this._refreshItems(event);

		//Find out if the clicked node (or one of its parents) is a actual item in this.items
		$(event.target).parents().each(function() {
			if($.data(this, that.widgetName + "-item") === that) {
				currentItem = $(this);
				return false;
			}
		});
		if($.data(event.target, that.widgetName + "-item") === that) {
			currentItem = $(event.target);
		}

		if(!currentItem) {
			return false;
		}
		if(this.options.handle && !overrideHandle) {
			$(this.options.handle, currentItem).find("*").addBack().each(function() {
				if(this === event.target) {
					validHandle = true;
				}
			});
			if(!validHandle) {
				return false;
			}
		}

		this.currentItem = currentItem;
		this._removeCurrentsFromItems();
		return true;

	},

	_mouseStart: function(event, overrideHandle, noActivation) {

		var i, body,
			o = this.options;

		this.currentContainer = this;

		//We only need to call refreshPositions, because the refreshItems call has been moved to mouseCapture
		this.refreshPositions();

		//Create and append the visible helper
		this.helper = this._createHelper(event);

		//Cache the helper size
		this._cacheHelperProportions();

		/*
		 * - Position generation -
		 * This block generates everything position related - it's the core of draggables.
		 */

		//Cache the margins of the original element
		this._cacheMargins();

		//Get the next scrolling parent
		this.scrollParent = this.helper.scrollParent();

		//The element's absolute position on the page minus margins
		this.offset = this.currentItem.offset();
		this.offset = {
			top: this.offset.top - this.margins.top,
			left: this.offset.left - this.margins.left
		};

		$.extend(this.offset, {
			click: { //Where the click happened, relative to the element
				left: event.pageX - this.offset.left,
				top: event.pageY - this.offset.top
			},
			parent: this._getParentOffset(),
			relative: this._getRelativeOffset() //This is a relative to absolute position minus the actual position calculation - only used for relative positioned helper
		});

		// Only after we got the offset, we can change the helper's position to absolute
		// TODO: Still need to figure out a way to make relative sorting possible
		this.helper.css("position", "absolute");
		this.cssPosition = this.helper.css("position");

		//Generate the original position
		this.originalPosition = this._generatePosition(event);
		this.originalPageX = event.pageX;
		this.originalPageY = event.pageY;

		//Adjust the mouse offset relative to the helper if "cursorAt" is supplied
		(o.cursorAt && this._adjustOffsetFromHelper(o.cursorAt));

		//Cache the former DOM position
		this.domPosition = { prev: this.currentItem.prev()[0], parent: this.currentItem.parent()[0] };

		//If the helper is not the original, hide the original so it's not playing any role during the drag, won't cause anything bad this way
		if(this.helper[0] !== this.currentItem[0]) {
			this.currentItem.hide();
		}

		//Create the placeholder
		this._createPlaceholder();

		//Set a containment if given in the options
		if(o.containment) {
			this._setContainment();
		}

		if( o.cursor && o.cursor !== "auto" ) { // cursor option
			body = this.document.find( "body" );

			// support: IE
			this.storedCursor = body.css( "cursor" );
			body.css( "cursor", o.cursor );

			this.storedStylesheet = $( "<style>*{ cursor: "+o.cursor+" !important; }</style>" ).appendTo( body );
		}

		if(o.opacity) { // opacity option
			if (this.helper.css("opacity")) {
				this._storedOpacity = this.helper.css("opacity");
			}
			this.helper.css("opacity", o.opacity);
		}

		if(o.zIndex) { // zIndex option
			if (this.helper.css("zIndex")) {
				this._storedZIndex = this.helper.css("zIndex");
			}
			this.helper.css("zIndex", o.zIndex);
		}

		//Prepare scrolling
		if(this.scrollParent[0] !== this.document[0] && this.scrollParent[0].tagName !== "HTML") {
			this.overflowOffset = this.scrollParent.offset();
		}

		//Call callbacks
		this._trigger("start", event, this._uiHash());

		//Recache the helper size
		if(!this._preserveHelperProportions) {
			this._cacheHelperProportions();
		}


		//Post "activate" events to possible containers
		if( !noActivation ) {
			for ( i = this.containers.length - 1; i >= 0; i-- ) {
				this.containers[ i ]._trigger( "activate", event, this._uiHash( this ) );
			}
		}

		//Prepare possible droppables
		if($.ui.ddmanager) {
			$.ui.ddmanager.current = this;
		}

		if ($.ui.ddmanager && !o.dropBehaviour) {
			$.ui.ddmanager.prepareOffsets(this, event);
		}

		this.dragging = true;

		this.helper.addClass("ui-sortable-helper");
		this._mouseDrag(event); //Execute the drag once - this causes the helper not to be visible before getting its correct position
		return true;

	},

	_mouseDrag: function(event) {
		var i, item, itemElement, intersection,
			o = this.options,
			scrolled = false;

		//Compute the helpers position
		this.position = this._generatePosition(event);
		this.positionAbs = this._convertPositionTo("absolute");

		if (!this.lastPositionAbs) {
			this.lastPositionAbs = this.positionAbs;
		}

		//Do scrolling
		if(this.options.scroll) {
			if(this.scrollParent[0] !== this.document[0] && this.scrollParent[0].tagName !== "HTML") {

				if((this.overflowOffset.top + this.scrollParent[0].offsetHeight) - event.pageY < o.scrollSensitivity) {
					this.scrollParent[0].scrollTop = scrolled = this.scrollParent[0].scrollTop + o.scrollSpeed;
				} else if(event.pageY - this.overflowOffset.top < o.scrollSensitivity) {
					this.scrollParent[0].scrollTop = scrolled = this.scrollParent[0].scrollTop - o.scrollSpeed;
				}

				if((this.overflowOffset.left + this.scrollParent[0].offsetWidth) - event.pageX < o.scrollSensitivity) {
					this.scrollParent[0].scrollLeft = scrolled = this.scrollParent[0].scrollLeft + o.scrollSpeed;
				} else if(event.pageX - this.overflowOffset.left < o.scrollSensitivity) {
					this.scrollParent[0].scrollLeft = scrolled = this.scrollParent[0].scrollLeft - o.scrollSpeed;
				}

			} else {

				if(event.pageY - this.document.scrollTop() < o.scrollSensitivity) {
					scrolled = this.document.scrollTop(this.document.scrollTop() - o.scrollSpeed);
				} else if(this.window.height() - (event.pageY - this.document.scrollTop()) < o.scrollSensitivity) {
					scrolled = this.document.scrollTop(this.document.scrollTop() + o.scrollSpeed);
				}

				if(event.pageX - this.document.scrollLeft() < o.scrollSensitivity) {
					scrolled = this.document.scrollLeft(this.document.scrollLeft() - o.scrollSpeed);
				} else if(this.window.width() - (event.pageX - this.document.scrollLeft()) < o.scrollSensitivity) {
					scrolled = this.document.scrollLeft(this.document.scrollLeft() + o.scrollSpeed);
				}

			}

			if(scrolled !== false && $.ui.ddmanager && !o.dropBehaviour) {
				$.ui.ddmanager.prepareOffsets(this, event);
			}
		}

		//Regenerate the absolute position used for position checks
		this.positionAbs = this._convertPositionTo("absolute");

		//Set the helper position
		if(!this.options.axis || this.options.axis !== "y") {
			this.helper[0].style.left = this.position.left+"px";
		}
		if(!this.options.axis || this.options.axis !== "x") {
			this.helper[0].style.top = this.position.top+"px";
		}

		//Rearrange
		for (i = this.items.length - 1; i >= 0; i--) {

			//Cache variables and intersection, continue if no intersection
			item = this.items[i];
			itemElement = item.item[0];
			intersection = this._intersectsWithPointer(item);
			if (!intersection) {
				continue;
			}

			// Only put the placeholder inside the current Container, skip all
			// items from other containers. This works because when moving
			// an item from one container to another the
			// currentContainer is switched before the placeholder is moved.
			//
			// Without this, moving items in "sub-sortables" can cause
			// the placeholder to jitter between the outer and inner container.
			if (item.instance !== this.currentContainer) {
				continue;
			}

			// cannot intersect with itself
			// no useless actions that have been done before
			// no action if the item moved is the parent of the item checked
			if (itemElement !== this.currentItem[0] &&
				this.placeholder[intersection === 1 ? "next" : "prev"]()[0] !== itemElement &&
				!$.contains(this.placeholder[0], itemElement) &&
				(this.options.type === "semi-dynamic" ? !$.contains(this.element[0], itemElement) : true)
			) {

				this.direction = intersection === 1 ? "down" : "up";

				if (this.options.tolerance === "pointer" || this._intersectsWithSides(item)) {
					this._rearrange(event, item);
				} else {
					break;
				}

				this._trigger("change", event, this._uiHash());
				break;
			}
		}

		//Post events to containers
		this._contactContainers(event);

		//Interconnect with droppables
		if($.ui.ddmanager) {
			$.ui.ddmanager.drag(this, event);
		}

		//Call callbacks
		this._trigger("sort", event, this._uiHash());

		this.lastPositionAbs = this.positionAbs;
		return false;

	},

	_mouseStop: function(event, noPropagation) {

		if(!event) {
			return;
		}

		//If we are using droppables, inform the manager about the drop
		if ($.ui.ddmanager && !this.options.dropBehaviour) {
			$.ui.ddmanager.drop(this, event);
		}

		if(this.options.revert) {
			var that = this,
				cur = this.placeholder.offset(),
				axis = this.options.axis,
				animation = {};

			if ( !axis || axis === "x" ) {
				animation.left = cur.left - this.offset.parent.left - this.margins.left + (this.offsetParent[0] === this.document[0].body ? 0 : this.offsetParent[0].scrollLeft);
			}
			if ( !axis || axis === "y" ) {
				animation.top = cur.top - this.offset.parent.top - this.margins.top + (this.offsetParent[0] === this.document[0].body ? 0 : this.offsetParent[0].scrollTop);
			}
			this.reverting = true;
			$(this.helper).animate( animation, parseInt(this.options.revert, 10) || 500, function() {
				that._clear(event);
			});
		} else {
			this._clear(event, noPropagation);
		}

		return false;

	},

	cancel: function() {

		if(this.dragging) {

			this._mouseUp({ target: null });

			if(this.options.helper === "original") {
				this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");
			} else {
				this.currentItem.show();
			}

			//Post deactivating events to containers
			for (var i = this.containers.length - 1; i >= 0; i--){
				this.containers[i]._trigger("deactivate", null, this._uiHash(this));
				if(this.containers[i].containerCache.over) {
					this.containers[i]._trigger("out", null, this._uiHash(this));
					this.containers[i].containerCache.over = 0;
				}
			}

		}

		if (this.placeholder) {
			//$(this.placeholder[0]).remove(); would have been the jQuery way - unfortunately, it unbinds ALL events from the original node!
			if(this.placeholder[0].parentNode) {
				this.placeholder[0].parentNode.removeChild(this.placeholder[0]);
			}
			if(this.options.helper !== "original" && this.helper && this.helper[0].parentNode) {
				this.helper.remove();
			}

			$.extend(this, {
				helper: null,
				dragging: false,
				reverting: false,
				_noFinalSort: null
			});

			if(this.domPosition.prev) {
				$(this.domPosition.prev).after(this.currentItem);
			} else {
				$(this.domPosition.parent).prepend(this.currentItem);
			}
		}

		return this;

	},

	serialize: function(o) {

		var items = this._getItemsAsjQuery(o && o.connected),
			str = [];
		o = o || {};

		$(items).each(function() {
			var res = ($(o.item || this).attr(o.attribute || "id") || "").match(o.expression || (/(.+)[\-=_](.+)/));
			if (res) {
				str.push((o.key || res[1]+"[]")+"="+(o.key && o.expression ? res[1] : res[2]));
			}
		});

		if(!str.length && o.key) {
			str.push(o.key + "=");
		}

		return str.join("&");

	},

	toArray: function(o) {

		var items = this._getItemsAsjQuery(o && o.connected),
			ret = [];

		o = o || {};

		items.each(function() { ret.push($(o.item || this).attr(o.attribute || "id") || ""); });
		return ret;

	},

	/* Be careful with the following core functions */
	_intersectsWith: function(item) {

		var x1 = this.positionAbs.left,
			x2 = x1 + this.helperProportions.width,
			y1 = this.positionAbs.top,
			y2 = y1 + this.helperProportions.height,
			l = item.left,
			r = l + item.width,
			t = item.top,
			b = t + item.height,
			dyClick = this.offset.click.top,
			dxClick = this.offset.click.left,
			isOverElementHeight = ( this.options.axis === "x" ) || ( ( y1 + dyClick ) > t && ( y1 + dyClick ) < b ),
			isOverElementWidth = ( this.options.axis === "y" ) || ( ( x1 + dxClick ) > l && ( x1 + dxClick ) < r ),
			isOverElement = isOverElementHeight && isOverElementWidth;

		if ( this.options.tolerance === "pointer" ||
			this.options.forcePointerForContainers ||
			(this.options.tolerance !== "pointer" && this.helperProportions[this.floating ? "width" : "height"] > item[this.floating ? "width" : "height"])
		) {
			return isOverElement;
		} else {

			return (l < x1 + (this.helperProportions.width / 2) && // Right Half
				x2 - (this.helperProportions.width / 2) < r && // Left Half
				t < y1 + (this.helperProportions.height / 2) && // Bottom Half
				y2 - (this.helperProportions.height / 2) < b ); // Top Half

		}
	},

	_intersectsWithPointer: function(item) {

		var isOverElementHeight = (this.options.axis === "x") || this._isOverAxis(this.positionAbs.top + this.offset.click.top, item.top, item.height),
			isOverElementWidth = (this.options.axis === "y") || this._isOverAxis(this.positionAbs.left + this.offset.click.left, item.left, item.width),
			isOverElement = isOverElementHeight && isOverElementWidth,
			verticalDirection = this._getDragVerticalDirection(),
			horizontalDirection = this._getDragHorizontalDirection();

		if (!isOverElement) {
			return false;
		}

		return this.floating ?
			( ((horizontalDirection && horizontalDirection === "right") || verticalDirection === "down") ? 2 : 1 )
			: ( verticalDirection && (verticalDirection === "down" ? 2 : 1) );

	},

	_intersectsWithSides: function(item) {

		var isOverBottomHalf = this._isOverAxis(this.positionAbs.top + this.offset.click.top, item.top + (item.height/2), item.height),
			isOverRightHalf = this._isOverAxis(this.positionAbs.left + this.offset.click.left, item.left + (item.width/2), item.width),
			verticalDirection = this._getDragVerticalDirection(),
			horizontalDirection = this._getDragHorizontalDirection();

		if (this.floating && horizontalDirection) {
			return ((horizontalDirection === "right" && isOverRightHalf) || (horizontalDirection === "left" && !isOverRightHalf));
		} else {
			return verticalDirection && ((verticalDirection === "down" && isOverBottomHalf) || (verticalDirection === "up" && !isOverBottomHalf));
		}

	},

	_getDragVerticalDirection: function() {
		var delta = this.positionAbs.top - this.lastPositionAbs.top;
		return delta !== 0 && (delta > 0 ? "down" : "up");
	},

	_getDragHorizontalDirection: function() {
		var delta = this.positionAbs.left - this.lastPositionAbs.left;
		return delta !== 0 && (delta > 0 ? "right" : "left");
	},

	refresh: function(event) {
		this._refreshItems(event);
		this._setHandleClassName();
		this.refreshPositions();
		return this;
	},

	_connectWith: function() {
		var options = this.options;
		return options.connectWith.constructor === String ? [options.connectWith] : options.connectWith;
	},

	_getItemsAsjQuery: function(connected) {

		var i, j, cur, inst,
			items = [],
			queries = [],
			connectWith = this._connectWith();

		if(connectWith && connected) {
			for (i = connectWith.length - 1; i >= 0; i--){
				cur = $(connectWith[i], this.document[0]);
				for ( j = cur.length - 1; j >= 0; j--){
					inst = $.data(cur[j], this.widgetFullName);
					if(inst && inst !== this && !inst.options.disabled) {
						queries.push([$.isFunction(inst.options.items) ? inst.options.items.call(inst.element) : $(inst.options.items, inst.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), inst]);
					}
				}
			}
		}

		queries.push([$.isFunction(this.options.items) ? this.options.items.call(this.element, null, { options: this.options, item: this.currentItem }) : $(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this]);

		function addItems() {
			items.push( this );
		}
		for (i = queries.length - 1; i >= 0; i--){
			queries[i][0].each( addItems );
		}

		return $(items);

	},

	_removeCurrentsFromItems: function() {

		var list = this.currentItem.find(":data(" + this.widgetName + "-item)");

		this.items = $.grep(this.items, function (item) {
			for (var j=0; j < list.length; j++) {
				if(list[j] === item.item[0]) {
					return false;
				}
			}
			return true;
		});

	},

	_refreshItems: function(event) {

		this.items = [];
		this.containers = [this];

		var i, j, cur, inst, targetData, _queries, item, queriesLength,
			items = this.items,
			queries = [[$.isFunction(this.options.items) ? this.options.items.call(this.element[0], event, { item: this.currentItem }) : $(this.options.items, this.element), this]],
			connectWith = this._connectWith();

		if(connectWith && this.ready) { //Shouldn't be run the first time through due to massive slow-down
			for (i = connectWith.length - 1; i >= 0; i--){
				cur = $(connectWith[i], this.document[0]);
				for (j = cur.length - 1; j >= 0; j--){
					inst = $.data(cur[j], this.widgetFullName);
					if(inst && inst !== this && !inst.options.disabled) {
						queries.push([$.isFunction(inst.options.items) ? inst.options.items.call(inst.element[0], event, { item: this.currentItem }) : $(inst.options.items, inst.element), inst]);
						this.containers.push(inst);
					}
				}
			}
		}

		for (i = queries.length - 1; i >= 0; i--) {
			targetData = queries[i][1];
			_queries = queries[i][0];

			for (j=0, queriesLength = _queries.length; j < queriesLength; j++) {
				item = $(_queries[j]);

				item.data(this.widgetName + "-item", targetData); // Data for target checking (mouse manager)

				items.push({
					item: item,
					instance: targetData,
					width: 0, height: 0,
					left: 0, top: 0
				});
			}
		}

	},

	refreshPositions: function(fast) {

		// Determine whether items are being displayed horizontally
		this.floating = this.items.length ?
			this.options.axis === "x" || this._isFloating( this.items[ 0 ].item ) :
			false;

		//This has to be redone because due to the item being moved out/into the offsetParent, the offsetParent's position will change
		if(this.offsetParent && this.helper) {
			this.offset.parent = this._getParentOffset();
		}

		var i, item, t, p;

		for (i = this.items.length - 1; i >= 0; i--){
			item = this.items[i];

			//We ignore calculating positions of all connected containers when we're not over them
			if(item.instance !== this.currentContainer && this.currentContainer && item.item[0] !== this.currentItem[0]) {
				continue;
			}

			t = this.options.toleranceElement ? $(this.options.toleranceElement, item.item) : item.item;

			if (!fast) {
				item.width = t.outerWidth();
				item.height = t.outerHeight();
			}

			p = t.offset();
			item.left = p.left;
			item.top = p.top;
		}

		if(this.options.custom && this.options.custom.refreshContainers) {
			this.options.custom.refreshContainers.call(this);
		} else {
			for (i = this.containers.length - 1; i >= 0; i--){
				p = this.containers[i].element.offset();
				this.containers[i].containerCache.left = p.left;
				this.containers[i].containerCache.top = p.top;
				this.containers[i].containerCache.width = this.containers[i].element.outerWidth();
				this.containers[i].containerCache.height = this.containers[i].element.outerHeight();
			}
		}

		return this;
	},

	_createPlaceholder: function(that) {
		that = that || this;
		var className,
			o = that.options;

		if(!o.placeholder || o.placeholder.constructor === String) {
			className = o.placeholder;
			o.placeholder = {
				element: function() {

					var nodeName = that.currentItem[0].nodeName.toLowerCase(),
						element = $( "<" + nodeName + ">", that.document[0] )
							.addClass(className || that.currentItem[0].className+" ui-sortable-placeholder")
							.removeClass("ui-sortable-helper");

					if ( nodeName === "tbody" ) {
						that._createTrPlaceholder(
							that.currentItem.find( "tr" ).eq( 0 ),
							$( "<tr>", that.document[ 0 ] ).appendTo( element )
						);
					} else if ( nodeName === "tr" ) {
						that._createTrPlaceholder( that.currentItem, element );
					} else if ( nodeName === "img" ) {
						element.attr( "src", that.currentItem.attr( "src" ) );
					}

					if ( !className ) {
						element.css( "visibility", "hidden" );
					}

					return element;
				},
				update: function(container, p) {

					// 1. If a className is set as 'placeholder option, we don't force sizes - the class is responsible for that
					// 2. The option 'forcePlaceholderSize can be enabled to force it even if a class name is specified
					if(className && !o.forcePlaceholderSize) {
						return;
					}

					//If the element doesn't have a actual height by itself (without styles coming from a stylesheet), it receives the inline height from the dragged item
					if(!p.height()) { p.height(that.currentItem.innerHeight() - parseInt(that.currentItem.css("paddingTop")||0, 10) - parseInt(that.currentItem.css("paddingBottom")||0, 10)); }
					if(!p.width()) { p.width(that.currentItem.innerWidth() - parseInt(that.currentItem.css("paddingLeft")||0, 10) - parseInt(that.currentItem.css("paddingRight")||0, 10)); }
				}
			};
		}

		//Create the placeholder
		that.placeholder = $(o.placeholder.element.call(that.element, that.currentItem));

		//Append it after the actual current item
		that.currentItem.after(that.placeholder);

		//Update the size of the placeholder (TODO: Logic to fuzzy, see line 316/317)
		o.placeholder.update(that, that.placeholder);

	},

	_createTrPlaceholder: function( sourceTr, targetTr ) {
		var that = this;

		sourceTr.children().each(function() {
			$( "<td>&#160;</td>", that.document[ 0 ] )
				.attr( "colspan", $( this ).attr( "colspan" ) || 1 )
				.appendTo( targetTr );
		});
	},

	_contactContainers: function(event) {
		var i, j, dist, itemWithLeastDistance, posProperty, sizeProperty, cur, nearBottom, floating, axis,
			innermostContainer = null,
			innermostIndex = null;

		// get innermost container that intersects with item
		for (i = this.containers.length - 1; i >= 0; i--) {

			// never consider a container that's located within the item itself
			if($.contains(this.currentItem[0], this.containers[i].element[0])) {
				continue;
			}

			if(this._intersectsWith(this.containers[i].containerCache)) {

				// if we've already found a container and it's more "inner" than this, then continue
				if(innermostContainer && $.contains(this.containers[i].element[0], innermostContainer.element[0])) {
					continue;
				}

				innermostContainer = this.containers[i];
				innermostIndex = i;

			} else {
				// container doesn't intersect. trigger "out" event if necessary
				if(this.containers[i].containerCache.over) {
					this.containers[i]._trigger("out", event, this._uiHash(this));
					this.containers[i].containerCache.over = 0;
				}
			}

		}

		// if no intersecting containers found, return
		if(!innermostContainer) {
			return;
		}

		// move the item into the container if it's not there already
		if(this.containers.length === 1) {
			if (!this.containers[innermostIndex].containerCache.over) {
				this.containers[innermostIndex]._trigger("over", event, this._uiHash(this));
				this.containers[innermostIndex].containerCache.over = 1;
			}
		} else {

			//When entering a new container, we will find the item with the least distance and append our item near it
			dist = 10000;
			itemWithLeastDistance = null;
			floating = innermostContainer.floating || this._isFloating(this.currentItem);
			posProperty = floating ? "left" : "top";
			sizeProperty = floating ? "width" : "height";
			axis = floating ? "clientX" : "clientY";

			for (j = this.items.length - 1; j >= 0; j--) {
				if(!$.contains(this.containers[innermostIndex].element[0], this.items[j].item[0])) {
					continue;
				}
				if(this.items[j].item[0] === this.currentItem[0]) {
					continue;
				}

				cur = this.items[j].item.offset()[posProperty];
				nearBottom = false;
				if ( event[ axis ] - cur > this.items[ j ][ sizeProperty ] / 2 ) {
					nearBottom = true;
				}

				if ( Math.abs( event[ axis ] - cur ) < dist ) {
					dist = Math.abs( event[ axis ] - cur );
					itemWithLeastDistance = this.items[ j ];
					this.direction = nearBottom ? "up": "down";
				}
			}

			//Check if dropOnEmpty is enabled
			if(!itemWithLeastDistance && !this.options.dropOnEmpty) {
				return;
			}

			if(this.currentContainer === this.containers[innermostIndex]) {
				if ( !this.currentContainer.containerCache.over ) {
					this.containers[ innermostIndex ]._trigger( "over", event, this._uiHash() );
					this.currentContainer.containerCache.over = 1;
				}
				return;
			}

			itemWithLeastDistance ? this._rearrange(event, itemWithLeastDistance, null, true) : this._rearrange(event, null, this.containers[innermostIndex].element, true);
			this._trigger("change", event, this._uiHash());
			this.containers[innermostIndex]._trigger("change", event, this._uiHash(this));
			this.currentContainer = this.containers[innermostIndex];

			//Update the placeholder
			this.options.placeholder.update(this.currentContainer, this.placeholder);

			this.containers[innermostIndex]._trigger("over", event, this._uiHash(this));
			this.containers[innermostIndex].containerCache.over = 1;
		}


	},

	_createHelper: function(event) {

		var o = this.options,
			helper = $.isFunction(o.helper) ? $(o.helper.apply(this.element[0], [event, this.currentItem])) : (o.helper === "clone" ? this.currentItem.clone() : this.currentItem);

		//Add the helper to the DOM if that didn't happen already
		if(!helper.parents("body").length) {
			$(o.appendTo !== "parent" ? o.appendTo : this.currentItem[0].parentNode)[0].appendChild(helper[0]);
		}

		if(helper[0] === this.currentItem[0]) {
			this._storedCSS = { width: this.currentItem[0].style.width, height: this.currentItem[0].style.height, position: this.currentItem.css("position"), top: this.currentItem.css("top"), left: this.currentItem.css("left") };
		}

		if(!helper[0].style.width || o.forceHelperSize) {
			helper.width(this.currentItem.width());
		}
		if(!helper[0].style.height || o.forceHelperSize) {
			helper.height(this.currentItem.height());
		}

		return helper;

	},

	_adjustOffsetFromHelper: function(obj) {
		if (typeof obj === "string") {
			obj = obj.split(" ");
		}
		if ($.isArray(obj)) {
			obj = {left: +obj[0], top: +obj[1] || 0};
		}
		if ("left" in obj) {
			this.offset.click.left = obj.left + this.margins.left;
		}
		if ("right" in obj) {
			this.offset.click.left = this.helperProportions.width - obj.right + this.margins.left;
		}
		if ("top" in obj) {
			this.offset.click.top = obj.top + this.margins.top;
		}
		if ("bottom" in obj) {
			this.offset.click.top = this.helperProportions.height - obj.bottom + this.margins.top;
		}
	},

	_getParentOffset: function() {


		//Get the offsetParent and cache its position
		this.offsetParent = this.helper.offsetParent();
		var po = this.offsetParent.offset();

		// This is a special case where we need to modify a offset calculated on start, since the following happened:
		// 1. The position of the helper is absolute, so it's position is calculated based on the next positioned parent
		// 2. The actual offset parent is a child of the scroll parent, and the scroll parent isn't the document, which means that
		//    the scroll is included in the initial calculation of the offset of the parent, and never recalculated upon drag
		if(this.cssPosition === "absolute" && this.scrollParent[0] !== this.document[0] && $.contains(this.scrollParent[0], this.offsetParent[0])) {
			po.left += this.scrollParent.scrollLeft();
			po.top += this.scrollParent.scrollTop();
		}

		// This needs to be actually done for all browsers, since pageX/pageY includes this information
		// with an ugly IE fix
		if( this.offsetParent[0] === this.document[0].body || (this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() === "html" && $.ui.ie)) {
			po = { top: 0, left: 0 };
		}

		return {
			top: po.top + (parseInt(this.offsetParent.css("borderTopWidth"),10) || 0),
			left: po.left + (parseInt(this.offsetParent.css("borderLeftWidth"),10) || 0)
		};

	},

	_getRelativeOffset: function() {

		if(this.cssPosition === "relative") {
			var p = this.currentItem.position();
			return {
				top: p.top - (parseInt(this.helper.css("top"),10) || 0) + this.scrollParent.scrollTop(),
				left: p.left - (parseInt(this.helper.css("left"),10) || 0) + this.scrollParent.scrollLeft()
			};
		} else {
			return { top: 0, left: 0 };
		}

	},

	_cacheMargins: function() {
		this.margins = {
			left: (parseInt(this.currentItem.css("marginLeft"),10) || 0),
			top: (parseInt(this.currentItem.css("marginTop"),10) || 0)
		};
	},

	_cacheHelperProportions: function() {
		this.helperProportions = {
			width: this.helper.outerWidth(),
			height: this.helper.outerHeight()
		};
	},

	_setContainment: function() {

		var ce, co, over,
			o = this.options;
		if(o.containment === "parent") {
			o.containment = this.helper[0].parentNode;
		}
		if(o.containment === "document" || o.containment === "window") {
			this.containment = [
				0 - this.offset.relative.left - this.offset.parent.left,
				0 - this.offset.relative.top - this.offset.parent.top,
				o.containment === "document" ? this.document.width() : this.window.width() - this.helperProportions.width - this.margins.left,
				(o.containment === "document" ? this.document.width() : this.window.height() || this.document[0].body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top
			];
		}

		if(!(/^(document|window|parent)$/).test(o.containment)) {
			ce = $(o.containment)[0];
			co = $(o.containment).offset();
			over = ($(ce).css("overflow") !== "hidden");

			this.containment = [
				co.left + (parseInt($(ce).css("borderLeftWidth"),10) || 0) + (parseInt($(ce).css("paddingLeft"),10) || 0) - this.margins.left,
				co.top + (parseInt($(ce).css("borderTopWidth"),10) || 0) + (parseInt($(ce).css("paddingTop"),10) || 0) - this.margins.top,
				co.left+(over ? Math.max(ce.scrollWidth,ce.offsetWidth) : ce.offsetWidth) - (parseInt($(ce).css("borderLeftWidth"),10) || 0) - (parseInt($(ce).css("paddingRight"),10) || 0) - this.helperProportions.width - this.margins.left,
				co.top+(over ? Math.max(ce.scrollHeight,ce.offsetHeight) : ce.offsetHeight) - (parseInt($(ce).css("borderTopWidth"),10) || 0) - (parseInt($(ce).css("paddingBottom"),10) || 0) - this.helperProportions.height - this.margins.top
			];
		}

	},

	_convertPositionTo: function(d, pos) {

		if(!pos) {
			pos = this.position;
		}
		var mod = d === "absolute" ? 1 : -1,
			scroll = this.cssPosition === "absolute" && !(this.scrollParent[0] !== this.document[0] && $.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent,
			scrollIsRootNode = (/(html|body)/i).test(scroll[0].tagName);

		return {
			top: (
				pos.top	+																// The absolute mouse position
				this.offset.relative.top * mod +										// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.top * mod -											// The offsetParent's offset without borders (offset + border)
				( ( this.cssPosition === "fixed" ? -this.scrollParent.scrollTop() : ( scrollIsRootNode ? 0 : scroll.scrollTop() ) ) * mod)
			),
			left: (
				pos.left +																// The absolute mouse position
				this.offset.relative.left * mod +										// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.left * mod	-										// The offsetParent's offset without borders (offset + border)
				( ( this.cssPosition === "fixed" ? -this.scrollParent.scrollLeft() : scrollIsRootNode ? 0 : scroll.scrollLeft() ) * mod)
			)
		};

	},

	_generatePosition: function(event) {

		var top, left,
			o = this.options,
			pageX = event.pageX,
			pageY = event.pageY,
			scroll = this.cssPosition === "absolute" && !(this.scrollParent[0] !== this.document[0] && $.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent, scrollIsRootNode = (/(html|body)/i).test(scroll[0].tagName);

		// This is another very weird special case that only happens for relative elements:
		// 1. If the css position is relative
		// 2. and the scroll parent is the document or similar to the offset parent
		// we have to refresh the relative offset during the scroll so there are no jumps
		if(this.cssPosition === "relative" && !(this.scrollParent[0] !== this.document[0] && this.scrollParent[0] !== this.offsetParent[0])) {
			this.offset.relative = this._getRelativeOffset();
		}

		/*
		 * - Position constraining -
		 * Constrain the position to a mix of grid, containment.
		 */

		if(this.originalPosition) { //If we are not dragging yet, we won't check for options

			if(this.containment) {
				if(event.pageX - this.offset.click.left < this.containment[0]) {
					pageX = this.containment[0] + this.offset.click.left;
				}
				if(event.pageY - this.offset.click.top < this.containment[1]) {
					pageY = this.containment[1] + this.offset.click.top;
				}
				if(event.pageX - this.offset.click.left > this.containment[2]) {
					pageX = this.containment[2] + this.offset.click.left;
				}
				if(event.pageY - this.offset.click.top > this.containment[3]) {
					pageY = this.containment[3] + this.offset.click.top;
				}
			}

			if(o.grid) {
				top = this.originalPageY + Math.round((pageY - this.originalPageY) / o.grid[1]) * o.grid[1];
				pageY = this.containment ? ( (top - this.offset.click.top >= this.containment[1] && top - this.offset.click.top <= this.containment[3]) ? top : ((top - this.offset.click.top >= this.containment[1]) ? top - o.grid[1] : top + o.grid[1])) : top;

				left = this.originalPageX + Math.round((pageX - this.originalPageX) / o.grid[0]) * o.grid[0];
				pageX = this.containment ? ( (left - this.offset.click.left >= this.containment[0] && left - this.offset.click.left <= this.containment[2]) ? left : ((left - this.offset.click.left >= this.containment[0]) ? left - o.grid[0] : left + o.grid[0])) : left;
			}

		}

		return {
			top: (
				pageY -																// The absolute mouse position
				this.offset.click.top -													// Click offset (relative to the element)
				this.offset.relative.top	-											// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.top +												// The offsetParent's offset without borders (offset + border)
				( ( this.cssPosition === "fixed" ? -this.scrollParent.scrollTop() : ( scrollIsRootNode ? 0 : scroll.scrollTop() ) ))
			),
			left: (
				pageX -																// The absolute mouse position
				this.offset.click.left -												// Click offset (relative to the element)
				this.offset.relative.left	-											// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.left +												// The offsetParent's offset without borders (offset + border)
				( ( this.cssPosition === "fixed" ? -this.scrollParent.scrollLeft() : scrollIsRootNode ? 0 : scroll.scrollLeft() ))
			)
		};

	},

	_rearrange: function(event, i, a, hardRefresh) {

		a ? a[0].appendChild(this.placeholder[0]) : i.item[0].parentNode.insertBefore(this.placeholder[0], (this.direction === "down" ? i.item[0] : i.item[0].nextSibling));

		//Various things done here to improve the performance:
		// 1. we create a setTimeout, that calls refreshPositions
		// 2. on the instance, we have a counter variable, that get's higher after every append
		// 3. on the local scope, we copy the counter variable, and check in the timeout, if it's still the same
		// 4. this lets only the last addition to the timeout stack through
		this.counter = this.counter ? ++this.counter : 1;
		var counter = this.counter;

		this._delay(function() {
			if(counter === this.counter) {
				this.refreshPositions(!hardRefresh); //Precompute after each DOM insertion, NOT on mousemove
			}
		});

	},

	_clear: function(event, noPropagation) {

		this.reverting = false;
		// We delay all events that have to be triggered to after the point where the placeholder has been removed and
		// everything else normalized again
		var i,
			delayedTriggers = [];

		// We first have to update the dom position of the actual currentItem
		// Note: don't do it if the current item is already removed (by a user), or it gets reappended (see #4088)
		if(!this._noFinalSort && this.currentItem.parent().length) {
			this.placeholder.before(this.currentItem);
		}
		this._noFinalSort = null;

		if(this.helper[0] === this.currentItem[0]) {
			for(i in this._storedCSS) {
				if(this._storedCSS[i] === "auto" || this._storedCSS[i] === "static") {
					this._storedCSS[i] = "";
				}
			}
			this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");
		} else {
			this.currentItem.show();
		}

		if(this.fromOutside && !noPropagation) {
			delayedTriggers.push(function(event) { this._trigger("receive", event, this._uiHash(this.fromOutside)); });
		}
		if((this.fromOutside || this.domPosition.prev !== this.currentItem.prev().not(".ui-sortable-helper")[0] || this.domPosition.parent !== this.currentItem.parent()[0]) && !noPropagation) {
			delayedTriggers.push(function(event) { this._trigger("update", event, this._uiHash()); }); //Trigger update callback if the DOM position has changed
		}

		// Check if the items Container has Changed and trigger appropriate
		// events.
		if (this !== this.currentContainer) {
			if(!noPropagation) {
				delayedTriggers.push(function(event) { this._trigger("remove", event, this._uiHash()); });
				delayedTriggers.push((function(c) { return function(event) { c._trigger("receive", event, this._uiHash(this)); };  }).call(this, this.currentContainer));
				delayedTriggers.push((function(c) { return function(event) { c._trigger("update", event, this._uiHash(this));  }; }).call(this, this.currentContainer));
			}
		}


		//Post events to containers
		function delayEvent( type, instance, container ) {
			return function( event ) {
				container._trigger( type, event, instance._uiHash( instance ) );
			};
		}
		for (i = this.containers.length - 1; i >= 0; i--){
			if (!noPropagation) {
				delayedTriggers.push( delayEvent( "deactivate", this, this.containers[ i ] ) );
			}
			if(this.containers[i].containerCache.over) {
				delayedTriggers.push( delayEvent( "out", this, this.containers[ i ] ) );
				this.containers[i].containerCache.over = 0;
			}
		}

		//Do what was originally in plugins
		if ( this.storedCursor ) {
			this.document.find( "body" ).css( "cursor", this.storedCursor );
			this.storedStylesheet.remove();
		}
		if(this._storedOpacity) {
			this.helper.css("opacity", this._storedOpacity);
		}
		if(this._storedZIndex) {
			this.helper.css("zIndex", this._storedZIndex === "auto" ? "" : this._storedZIndex);
		}

		this.dragging = false;

		if(!noPropagation) {
			this._trigger("beforeStop", event, this._uiHash());
		}

		//$(this.placeholder[0]).remove(); would have been the jQuery way - unfortunately, it unbinds ALL events from the original node!
		this.placeholder[0].parentNode.removeChild(this.placeholder[0]);

		if ( !this.cancelHelperRemoval ) {
			if ( this.helper[ 0 ] !== this.currentItem[ 0 ] ) {
				this.helper.remove();
			}
			this.helper = null;
		}

		if(!noPropagation) {
			for (i=0; i < delayedTriggers.length; i++) {
				delayedTriggers[i].call(this, event);
			} //Trigger all delayed events
			this._trigger("stop", event, this._uiHash());
		}

		this.fromOutside = false;
		return !this.cancelHelperRemoval;

	},

	_trigger: function() {
		if ($.Widget.prototype._trigger.apply(this, arguments) === false) {
			this.cancel();
		}
	},

	_uiHash: function(_inst) {
		var inst = _inst || this;
		return {
			helper: inst.helper,
			placeholder: inst.placeholder || $([]),
			position: inst.position,
			originalPosition: inst.originalPosition,
			offset: inst.positionAbs,
			item: inst.currentItem,
			sender: _inst ? _inst.element : null
		};
	}

});



}));
/* canvas-toBlob.js
 * A canvas.toBlob() implementation.
 * 2013-12-27
 * 
 * By Eli Grey, http://eligrey.com and Devin Samarin, https://github.com/eboyjr
 * License: X11/MIT
 *   See https://github.com/eligrey/canvas-toBlob.js/blob/master/LICENSE.md
 */

/*global self */
/*jslint bitwise: true, regexp: true, confusion: true, es5: true, vars: true, white: true,
  plusplus: true */

/*! @source http://purl.eligrey.com/github/canvas-toBlob.js/blob/master/canvas-toBlob.js */

(function(view) {
"use strict";
var
	  Uint8Array = view.Uint8Array
	, HTMLCanvasElement = view.HTMLCanvasElement
	, canvas_proto = HTMLCanvasElement && HTMLCanvasElement.prototype
	, is_base64_regex = /\s*;\s*base64\s*(?:;|$)/i
	, to_data_url = "toDataURL"
	, base64_ranks
	, decode_base64 = function(base64) {
		var
			  len = base64.length
			, buffer = new Uint8Array(len / 4 * 3 | 0)
			, i = 0
			, outptr = 0
			, last = [0, 0]
			, state = 0
			, save = 0
			, rank
			, code
			, undef
		;
		while (len--) {
			code = base64.charCodeAt(i++);
			rank = base64_ranks[code-43];
			if (rank !== 255 && rank !== undef) {
				last[1] = last[0];
				last[0] = code;
				save = (save << 6) | rank;
				state++;
				if (state === 4) {
					buffer[outptr++] = save >>> 16;
					if (last[1] !== 61 /* padding character */) {
						buffer[outptr++] = save >>> 8;
					}
					if (last[0] !== 61 /* padding character */) {
						buffer[outptr++] = save;
					}
					state = 0;
				}
			}
		}
		// 2/3 chance there's going to be some null bytes at the end, but that
		// doesn't really matter with most image formats.
		// If it somehow matters for you, truncate the buffer up outptr.
		return buffer;
	}
;
if (Uint8Array) {
	base64_ranks = new Uint8Array([
		  62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1
		, -1, -1,  0, -1, -1, -1,  0,  1,  2,  3,  4,  5,  6,  7,  8,  9
		, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25
		, -1, -1, -1, -1, -1, -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35
		, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51
	]);
}
if (HTMLCanvasElement && !canvas_proto.toBlob) {
	canvas_proto.toBlob = function(callback, type /*, ...args*/) {
		  if (!type) {
			type = "image/png";
		} if (this.mozGetAsFile) {
			callback(this.mozGetAsFile("canvas", type));
			return;
		} if (this.msToBlob && /^\s*image\/png\s*(?:$|;)/i.test(type)) {
			callback(this.msToBlob());
			return;
		}

		var
			  args = Array.prototype.slice.call(arguments, 1)
			, dataURI = this[to_data_url].apply(this, args)
			, header_end = dataURI.indexOf(",")
			, data = dataURI.substring(header_end + 1)
			, is_base64 = is_base64_regex.test(dataURI.substring(0, header_end))
			, blob
		;
		if (Blob.fake) {
			// no reason to decode a data: URI that's just going to become a data URI again
			blob = new Blob
			if (is_base64) {
				blob.encoding = "base64";
			} else {
				blob.encoding = "URI";
			}
			blob.data = data;
			blob.size = data.length;
		} else if (Uint8Array) {
			if (is_base64) {
				blob = new Blob([decode_base64(data)], {type: type});
			} else {
				blob = new Blob([decodeURIComponent(data)], {type: type});
			}
		}
		callback(blob);
	};

	if (canvas_proto.toDataURLHD) {
		canvas_proto.toBlobHD = function() {
			to_data_url = "toDataURLHD";
			var blob = this.toBlob();
			to_data_url = "toDataURL";
			return blob;
		}
	} else {
		canvas_proto.toBlobHD = canvas_proto.toBlob;
	}
}
}(typeof self !== "undefined" && self || typeof window !== "undefined" && window || this.content || this));

/* FileSaver.js
 * A saveAs() FileSaver implementation.
 * 2015-03-04
 *
 * By Eli Grey, http://eligrey.com
 * License: X11/MIT
 *   See https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md
 */

/*global self */
/*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */

/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */

var saveAs = saveAs
  // IE 10+ (native saveAs)
  || (typeof navigator !== "undefined" &&
      navigator.msSaveOrOpenBlob && navigator.msSaveOrOpenBlob.bind(navigator))
  // Everyone else
  || (function(view) {
	"use strict";
	// IE <10 is explicitly unsupported
	if (typeof navigator !== "undefined" &&
	    /MSIE [1-9]\./.test(navigator.userAgent)) {
		return;
	}
	var
		  doc = view.document
		  // only get URL when necessary in case Blob.js hasn't overridden it yet
		, get_URL = function() {
			return view.URL || view.webkitURL || view;
		}
		, save_link = doc.createElementNS("http://www.w3.org/1999/xhtml", "a")
		, can_use_save_link = "download" in save_link
		, click = function(node) {
			var event = doc.createEvent("MouseEvents");
			event.initMouseEvent(
				"click", true, false, view, 0, 0, 0, 0, 0
				, false, false, false, false, 0, null
			);
			node.dispatchEvent(event);
		}
		, webkit_req_fs = view.webkitRequestFileSystem
		, req_fs = view.requestFileSystem || webkit_req_fs || view.mozRequestFileSystem
		, throw_outside = function(ex) {
			(view.setImmediate || view.setTimeout)(function() {
				throw ex;
			}, 0);
		}
		, force_saveable_type = "application/octet-stream"
		, fs_min_size = 0
		// See https://code.google.com/p/chromium/issues/detail?id=375297#c7 and
		// https://github.com/eligrey/FileSaver.js/commit/485930a#commitcomment-8768047
		// for the reasoning behind the timeout and revocation flow
		, arbitrary_revoke_timeout = 500 // in ms
		, revoke = function(file) {
			var revoker = function() {
				if (typeof file === "string") { // file is an object URL
					get_URL().revokeObjectURL(file);
				} else { // file is a File
					file.remove();
				}
			};
			if (view.chrome) {
				revoker();
			} else {
				setTimeout(revoker, arbitrary_revoke_timeout);
			}
		}
		, dispatch = function(filesaver, event_types, event) {
			event_types = [].concat(event_types);
			var i = event_types.length;
			while (i--) {
				var listener = filesaver["on" + event_types[i]];
				if (typeof listener === "function") {
					try {
						listener.call(filesaver, event || filesaver);
					} catch (ex) {
						throw_outside(ex);
					}
				}
			}
		}
		, FileSaver = function(blob, name) {
			// First try a.download, then web filesystem, then object URLs
			var
				  filesaver = this
				, type = blob.type
				, blob_changed = false
				, object_url
				, target_view
				, dispatch_all = function() {
					dispatch(filesaver, "writestart progress write writeend".split(" "));
				}
				// on any filesys errors revert to saving with object URLs
				, fs_error = function() {
					// don't create more object URLs than needed
					if (blob_changed || !object_url) {
						object_url = get_URL().createObjectURL(blob);
					}
					if (target_view) {
						target_view.location.href = object_url;
					} else {
						var new_tab = view.open(object_url, "_blank");
						if (new_tab == undefined && typeof safari !== "undefined") {
							//Apple do not allow window.open, see http://bit.ly/1kZffRI
							view.location.href = object_url
						}
					}
					filesaver.readyState = filesaver.DONE;
					dispatch_all();
					revoke(object_url);
				}
				, abortable = function(func) {
					return function() {
						if (filesaver.readyState !== filesaver.DONE) {
							return func.apply(this, arguments);
						}
					};
				}
				, create_if_not_found = {create: true, exclusive: false}
				, slice
			;
			filesaver.readyState = filesaver.INIT;
			if (!name) {
				name = "download";
			}
			if (can_use_save_link) {
				object_url = get_URL().createObjectURL(blob);
				save_link.href = object_url;
				save_link.download = name;
				click(save_link);
				filesaver.readyState = filesaver.DONE;
				dispatch_all();
				revoke(object_url);
				return;
			}
			// prepend BOM for UTF-8 XML and text/plain types
			if (/^\s*(?:text\/(?:plain|xml)|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(blob.type)) {
				blob = new Blob(["\ufeff", blob], {type: blob.type});
			}
			// Object and web filesystem URLs have a problem saving in Google Chrome when
			// viewed in a tab, so I force save with application/octet-stream
			// http://code.google.com/p/chromium/issues/detail?id=91158
			// Update: Google errantly closed 91158, I submitted it again:
			// https://code.google.com/p/chromium/issues/detail?id=389642
			if (view.chrome && type && type !== force_saveable_type) {
				slice = blob.slice || blob.webkitSlice;
				blob = slice.call(blob, 0, blob.size, force_saveable_type);
				blob_changed = true;
			}
			// Since I can't be sure that the guessed media type will trigger a download
			// in WebKit, I append .download to the filename.
			// https://bugs.webkit.org/show_bug.cgi?id=65440
			if (webkit_req_fs && name !== "download") {
				name += ".download";
			}
			if (type === force_saveable_type || webkit_req_fs) {
				target_view = view;
			}
			if (!req_fs) {
				fs_error();
				return;
			}
			fs_min_size += blob.size;
			req_fs(view.TEMPORARY, fs_min_size, abortable(function(fs) {
				fs.root.getDirectory("saved", create_if_not_found, abortable(function(dir) {
					var save = function() {
						dir.getFile(name, create_if_not_found, abortable(function(file) {
							file.createWriter(abortable(function(writer) {
								writer.onwriteend = function(event) {
									target_view.location.href = file.toURL();
									filesaver.readyState = filesaver.DONE;
									dispatch(filesaver, "writeend", event);
									revoke(file);
								};
								writer.onerror = function() {
									var error = writer.error;
									if (error.code !== error.ABORT_ERR) {
										fs_error();
									}
								};
								"writestart progress write abort".split(" ").forEach(function(event) {
									writer["on" + event] = filesaver["on" + event];
								});
								writer.write(blob);
								filesaver.abort = function() {
									writer.abort();
									filesaver.readyState = filesaver.DONE;
								};
								filesaver.readyState = filesaver.WRITING;
							}), fs_error);
						}), fs_error);
					};
					dir.getFile(name, {create: false}, abortable(function(file) {
						// delete file if it already exists
						file.remove();
						save();
					}), abortable(function(ex) {
						if (ex.code === ex.NOT_FOUND_ERR) {
							save();
						} else {
							fs_error();
						}
					}));
				}), fs_error);
			}), fs_error);
		}
		, FS_proto = FileSaver.prototype
		, saveAs = function(blob, name) {
			return new FileSaver(blob, name);
		}
	;
	FS_proto.abort = function() {
		var filesaver = this;
		filesaver.readyState = filesaver.DONE;
		dispatch(filesaver, "abort");
	};
	FS_proto.readyState = FS_proto.INIT = 0;
	FS_proto.WRITING = 1;
	FS_proto.DONE = 2;

	FS_proto.error =
	FS_proto.onwritestart =
	FS_proto.onprogress =
	FS_proto.onwrite =
	FS_proto.onabort =
	FS_proto.onerror =
	FS_proto.onwriteend =
		null;

	return saveAs;
}(
	   typeof self !== "undefined" && self
	|| typeof window !== "undefined" && window
	|| this.content
));
// `self` is undefined in Firefox for Android content script context
// while `this` is nsIContentFrameMessageManager
// with an attribute `content` that corresponds to the window

if (typeof module !== "undefined" && module.exports) {
  module.exports.saveAs = saveAs;
} else if ((typeof define !== "undefined" && define !== null) && (define.amd != null)) {
  define([], function() {
    return saveAs;
  });
}

/**
* simplePagination.js v1.6
* A simple jQuery pagination plugin.
* http://flaviusmatis.github.com/simplePagination.js/
*
* Copyright 2012, Flavius Matis
* Released under the MIT license.
* http://flaviusmatis.github.com/license.html
*/

(function($){

	var methods = {
		init: function(options) {
			var o = $.extend({
				items: 1,
				itemsOnPage: 1,
				pages: 0,
				displayedPages: 5,
				edges: 2,
				currentPage: 0,
				hrefTextPrefix: '#page-',
				hrefTextSuffix: '',
				prevText: 'Prev',
				nextText: 'Next',
				ellipseText: '&hellip;',
				cssStyle: 'light-theme',
				labelMap: [],
				selectOnClick: true,
				nextAtFront: false,
				invertPageOrder: false,
				onPageClick: function(pageNumber, event) {
					// Callback triggered when a page is clicked
					// Page number is given as an optional parameter
				},
				onInit: function() {
					// Callback triggered immediately after initialization
				}
			}, options || {});

			var self = this;

			o.pages = o.pages ? o.pages : Math.ceil(o.items / o.itemsOnPage) ? Math.ceil(o.items / o.itemsOnPage) : 1;
			if (o.currentPage)
				o.currentPage = o.currentPage - 1;
			else
				o.currentPage = !o.invertPageOrder ? 0 : o.pages - 1;
			o.halfDisplayed = o.displayedPages / 2;

			this.each(function() {
				self.addClass(o.cssStyle + ' simple-pagination').data('pagination', o);
				methods._draw.call(self);
			});

			o.onInit();

			return this;
		},

		selectPage: function(page) {
			methods._selectPage.call(this, page - 1);
			return this;
		},

		prevPage: function() {
			var o = this.data('pagination');
			if (!o.invertPageOrder) {
				if (o.currentPage > 0) {
					methods._selectPage.call(this, o.currentPage - 1);
				}
			} else {
				if (o.currentPage < o.pages - 1) {
					methods._selectPage.call(this, o.currentPage + 1);
				}
			}
			return this;
		},

		nextPage: function() {
			var o = this.data('pagination');
			if (!o.invertPageOrder) {
				if (o.currentPage < o.pages - 1) {
					methods._selectPage.call(this, o.currentPage + 1);
				}
			} else {
				if (o.currentPage > 0) {
					methods._selectPage.call(this, o.currentPage - 1);
				}
			}
			return this;
		},

		getPagesCount: function() {
			return this.data('pagination').pages;
		},

		getCurrentPage: function () {
			return this.data('pagination').currentPage + 1;
		},

		destroy: function(){
			this.empty();
			return this;
		},

		drawPage: function (page) {
			var o = this.data('pagination');
			o.currentPage = page - 1;
			this.data('pagination', o);
			methods._draw.call(this);
			return this;
		},

		redraw: function(){
			methods._draw.call(this);
			return this;
		},

		disable: function(){
			var o = this.data('pagination');
			o.disabled = true;
			this.data('pagination', o);
			methods._draw.call(this);
			return this;
		},

		enable: function(){
			var o = this.data('pagination');
			o.disabled = false;
			this.data('pagination', o);
			methods._draw.call(this);
			return this;
		},

		updateItems: function (newItems) {
			var o = this.data('pagination');
			o.items = newItems;
			o.pages = methods._getPages(o);
			this.data('pagination', o);
			methods._draw.call(this);
		},

		updateItemsOnPage: function (itemsOnPage) {
			var o = this.data('pagination');
			o.itemsOnPage = itemsOnPage;
			o.pages = methods._getPages(o);
			this.data('pagination', o);
			methods._selectPage.call(this, 0);
			return this;
		},

		_draw: function() {
			var	o = this.data('pagination'),
				interval = methods._getInterval(o),
				i,
				tagName;

			methods.destroy.call(this);
			
			tagName = (typeof this.prop === 'function') ? this.prop('tagName') : this.attr('tagName');

			var $panel = tagName === 'UL' ? this : $('<ul></ul>').appendTo(this);

			// Generate Prev link
			if (o.prevText) {
				methods._appendItem.call(this, !o.invertPageOrder ? o.currentPage - 1 : o.currentPage + 1, {text: o.prevText, classes: 'prev'});
			}

			// Generate Next link (if option set for at front)
			if (o.nextText && o.nextAtFront) {
				methods._appendItem.call(this, !o.invertPageOrder ? o.currentPage + 1 : o.currentPage - 1, {text: o.nextText, classes: 'next'});
			}

			// Generate start edges
			if (!o.invertPageOrder) {
				if (interval.start > 0 && o.edges > 0) {
					var end = Math.min(o.edges, interval.start);
					for (i = 0; i < end; i++) {
						methods._appendItem.call(this, i);
					}
					if (o.edges < interval.start && (interval.start - o.edges != 1)) {
						$panel.append('<li class="disabled"><span class="ellipse">' + o.ellipseText + '</span></li>');
					} else if (interval.start - o.edges == 1) {
						methods._appendItem.call(this, o.edges);
					}
				}
			} else {
				if (interval.end < o.pages && o.edges > 0) {
					var begin = Math.max(o.pages - o.edges, interval.end);
					for (i = o.pages - 1; i >= begin; i--) {
						methods._appendItem.call(this, i);
					}
					if (o.pages - o.edges > interval.end && (o.pages - o.edges - interval.end != 1)) {
						$panel.append('<li class="disabled"><span class="ellipse">' + o.ellipseText + '</span></li>');
					} else if (o.pages - o.edges - interval.end == 1) {
						methods._appendItem.call(this, interval.end);
					}
				}
			}

			// Generate interval links
			if (!o.invertPageOrder) {
				for (i = interval.start; i < interval.end; i++) {
					methods._appendItem.call(this, i);
				}
			} else {
				for (i = interval.end - 1; i >= interval.start; i--) {
					methods._appendItem.call(this, i);
				}
			}

			// Generate end edges
			if (!o.invertPageOrder) {
				if (interval.end < o.pages && o.edges > 0) {
					if (o.pages - o.edges > interval.end && (o.pages - o.edges - interval.end != 1)) {
						$panel.append('<li class="disabled"><span class="ellipse">' + o.ellipseText + '</span></li>');
					} else if (o.pages - o.edges - interval.end == 1) {
						methods._appendItem.call(this, interval.end);
					}
					var begin = Math.max(o.pages - o.edges, interval.end);
					for (i = begin; i < o.pages; i++) {
						methods._appendItem.call(this, i);
					}
				}
			} else {
				if (interval.start > 0 && o.edges > 0) {
					if (o.edges < interval.start && (interval.start - o.edges != 1)) {
						$panel.append('<li class="disabled"><span class="ellipse">' + o.ellipseText + '</span></li>');
					} else if (interval.start - o.edges == 1) {
						methods._appendItem.call(this, o.edges);
					}
					var end = Math.min(o.edges, interval.start);
					for (i = end - 1; i >= 0; i--) {
						methods._appendItem.call(this, i);
					}
				}
			}

			// Generate Next link (unless option is set for at front)
			if (o.nextText && !o.nextAtFront) {
				methods._appendItem.call(this, !o.invertPageOrder ? o.currentPage + 1 : o.currentPage - 1, {text: o.nextText, classes: 'next'});
			}
		},

		_getPages: function(o) {
			var pages = Math.ceil(o.items / o.itemsOnPage);
			return pages || 1;
		},

		_getInterval: function(o) {
			return {
				start: Math.ceil(o.currentPage > o.halfDisplayed ? Math.max(Math.min(o.currentPage - o.halfDisplayed, (o.pages - o.displayedPages)), 0) : 0),
				end: Math.ceil(o.currentPage > o.halfDisplayed ? Math.min(o.currentPage + o.halfDisplayed, o.pages) : Math.min(o.displayedPages, o.pages))
			};
		},

		_appendItem: function(pageIndex, opts) {
			var self = this, options, $link, o = self.data('pagination'), $linkWrapper = $('<li></li>'), $ul = self.find('ul');

			pageIndex = pageIndex < 0 ? 0 : (pageIndex < o.pages ? pageIndex : o.pages - 1);

			options = {
				text: pageIndex + 1,
				classes: ''
			};

			if (o.labelMap.length && o.labelMap[pageIndex]) {
				options.text = o.labelMap[pageIndex];
			}

			options = $.extend(options, opts || {});

			if (pageIndex == o.currentPage || o.disabled) {
				if (o.disabled) {
					$linkWrapper.addClass('disabled');
				} else {
					$linkWrapper.addClass('active');
				}
				$link = $('<span class="current">' + (options.text) + '</span>');
			} else {
				$link = $('<a href="' + o.hrefTextPrefix + (pageIndex + 1) + o.hrefTextSuffix + '" class="page-link">' + (options.text) + '</a>');
				$link.click(function(event){
					return methods._selectPage.call(self, pageIndex, event);
				});
			}

			if (options.classes) {
				$link.addClass(options.classes);
			}

			$linkWrapper.append($link);

			if ($ul.length) {
				$ul.append($linkWrapper);
			} else {
				self.append($linkWrapper);
			}
		},

		_selectPage: function(pageIndex, event) {
			var o = this.data('pagination');
			o.currentPage = pageIndex;
			if (o.selectOnClick) {
				methods._draw.call(this);
			}
			return o.onPageClick(pageIndex + 1, event);
		}

	};

	$.fn.pagination = function(method) {

		// Method calling logic
		if (methods[method] && method.charAt(0) != '_') {
			return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
		} else if (typeof method === 'object' || !method) {
			return methods.init.apply(this, arguments);
		} else {
			$.error('Method ' +  method + ' does not exist on jQuery.pagination');
		}

	};

})(jQuery);

// Spectrum Colorpicker v1.6.0
// https://github.com/bgrins/spectrum
// Author: Brian Grinstead
// License: MIT

(function (factory) {
    "use strict";

    if (typeof define === 'function' && define.amd) { // AMD
        define(['jquery'], factory);
    }
    else if (typeof exports == "object" && typeof module == "object") { // CommonJS
        module.exports = factory;
    }
    else { // Browser
        factory(jQuery);
    }
})(function($, undefined) {
    "use strict";

    var defaultOpts = {

        // Callbacks
        beforeShow: noop,
        move: noop,
        change: noop,
        show: noop,
        hide: noop,

        // Options
        color: false,
        flat: false,
        showInput: false,
        allowEmpty: false,
        showButtons: true,
        clickoutFiresChange: false,
        showInitial: false,
        showPalette: false,
        showPaletteOnly: false,
        hideAfterPaletteSelect: false,
        togglePaletteOnly: false,
        showSelectionPalette: true,
        localStorageKey: false,
        appendTo: "body",
        maxSelectionSize: 7,
        cancelText: "cancel",
        chooseText: "choose",
        togglePaletteMoreText: "more",
        togglePaletteLessText: "less",
        clearText: "Clear Color Selection",
        noColorSelectedText: "No Color Selected",
        preferredFormat: false,
        className: "", // Deprecated - use containerClassName and replacerClassName instead.
        containerClassName: "",
        replacerClassName: "",
        showAlpha: false,
        theme: "sp-light",
        palette: [["#ffffff", "#000000", "#ff0000", "#ff8000", "#ffff00", "#008000", "#0000ff", "#4b0082", "#9400d3"]],
        selectionPalette: [],
        disabled: false,
        offset: null
    },
    spectrums = [],
    IE = !!/msie/i.exec( window.navigator.userAgent ),
    rgbaSupport = (function() {
        function contains( str, substr ) {
            return !!~('' + str).indexOf(substr);
        }

        var elem = document.createElement('div');
        var style = elem.style;
        style.cssText = 'background-color:rgba(0,0,0,.5)';
        return contains(style.backgroundColor, 'rgba') || contains(style.backgroundColor, 'hsla');
    })(),
    inputTypeColorSupport = (function() {
        var colorInput = $("<input type='color' value='!' />")[0];
        return colorInput.type === "color" && colorInput.value !== "!";
    })(),
    replaceInput = [
        "<div class='sp-replacer'>",
            "<div class='sp-preview'><div class='sp-preview-inner'></div></div>",
            "<div class='sp-dd'>&#9660;</div>",
        "</div>"
    ].join(''),
    markup = (function () {

        // IE does not support gradients with multiple stops, so we need to simulate
        //  that for the rainbow slider with 8 divs that each have a single gradient
        var gradientFix = "";
        if (IE) {
            for (var i = 1; i <= 6; i++) {
                gradientFix += "<div class='sp-" + i + "'></div>";
            }
        }

        return [
            "<div class='sp-container sp-hidden'>",
                "<div class='sp-palette-container'>",
                    "<div class='sp-palette sp-thumb sp-cf'></div>",
                    "<div class='sp-palette-button-container sp-cf'>",
                        "<button type='button' class='sp-palette-toggle'></button>",
                    "</div>",
                "</div>",
                "<div class='sp-picker-container'>",
                    "<div class='sp-top sp-cf'>",
                        "<div class='sp-fill'></div>",
                        "<div class='sp-top-inner'>",
                            "<div class='sp-color'>",
                                "<div class='sp-sat'>",
                                    "<div class='sp-val'>",
                                        "<div class='sp-dragger'></div>",
                                    "</div>",
                                "</div>",
                            "</div>",
                            "<div class='sp-clear sp-clear-display'>",
                            "</div>",
                            "<div class='sp-hue'>",
                                "<div class='sp-slider'></div>",
                                gradientFix,
                            "</div>",
                        "</div>",
                        "<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>",
                    "</div>",
                    "<div class='sp-input-container sp-cf'>",
                        "<input class='sp-input' type='text' spellcheck='false'  />",
                    "</div>",
                    "<div class='sp-initial sp-thumb sp-cf'></div>",
                    "<div class='sp-button-container sp-cf'>",
                        "<a class='sp-cancel' href='#'></a>",
                        "<button type='button' class='sp-choose'></button>",
                    "</div>",
                "</div>",
            "</div>"
        ].join("");
    })();

    function paletteTemplate (p, color, className, opts) {
        var html = [];
        for (var i = 0; i < p.length; i++) {
            var current = p[i];
            if(current) {
                var tiny = tinycolor(current);
                var c = tiny.toHsl().l < 0.5 ? "sp-thumb-el sp-thumb-dark" : "sp-thumb-el sp-thumb-light";
                c += (tinycolor.equals(color, current)) ? " sp-thumb-active" : "";
                var formattedString = tiny.toString(opts.preferredFormat || "rgb");
                var swatchStyle = rgbaSupport ? ("background-color:" + tiny.toRgbString()) : "filter:" + tiny.toFilter();
                html.push('<span title="' + formattedString + '" data-color="' + tiny.toRgbString() + '" class="' + c + '"><span class="sp-thumb-inner" style="' + swatchStyle + ';" /></span>');
            } else {
                var cls = 'sp-clear-display';
                html.push($('<div />')
                    .append($('<span data-color="" style="background-color:transparent;" class="' + cls + '"></span>')
                        .attr('title', opts.noColorSelectedText)
                    )
                    .html()
                );
            }
        }
        return "<div class='sp-cf " + className + "'>" + html.join('') + "</div>";
    }

    function hideAll() {
        for (var i = 0; i < spectrums.length; i++) {
            if (spectrums[i]) {
                spectrums[i].hide();
            }
        }
    }

    function instanceOptions(o, callbackContext) {
        var opts = $.extend({}, defaultOpts, o);
        opts.callbacks = {
            'move': bind(opts.move, callbackContext),
            'change': bind(opts.change, callbackContext),
            'show': bind(opts.show, callbackContext),
            'hide': bind(opts.hide, callbackContext),
            'beforeShow': bind(opts.beforeShow, callbackContext)
        };

        return opts;
    }

    function spectrum(element, o) {

        var opts = instanceOptions(o, element),
            flat = opts.flat,
            showSelectionPalette = opts.showSelectionPalette,
            localStorageKey = opts.localStorageKey,
            theme = opts.theme,
            callbacks = opts.callbacks,
            resize = throttle(reflow, 10),
            visible = false,
            dragWidth = 0,
            dragHeight = 0,
            dragHelperHeight = 0,
            slideHeight = 0,
            slideWidth = 0,
            alphaWidth = 0,
            alphaSlideHelperWidth = 0,
            slideHelperHeight = 0,
            currentHue = 0,
            currentSaturation = 0,
            currentValue = 0,
            currentAlpha = 1,
            palette = [],
            paletteArray = [],
            paletteLookup = {},
            selectionPalette = opts.selectionPalette.slice(0),
            maxSelectionSize = opts.maxSelectionSize,
            draggingClass = "sp-dragging",
            shiftMovementDirection = null;

        var doc = element.ownerDocument,
            body = doc.body,
            boundElement = $(element),
            disabled = false,
            container = $(markup, doc).addClass(theme),
            pickerContainer = container.find(".sp-picker-container"),
            dragger = container.find(".sp-color"),
            dragHelper = container.find(".sp-dragger"),
            slider = container.find(".sp-hue"),
            slideHelper = container.find(".sp-slider"),
            alphaSliderInner = container.find(".sp-alpha-inner"),
            alphaSlider = container.find(".sp-alpha"),
            alphaSlideHelper = container.find(".sp-alpha-handle"),
            textInput = container.find(".sp-input"),
            paletteContainer = container.find(".sp-palette"),
            initialColorContainer = container.find(".sp-initial"),
            cancelButton = container.find(".sp-cancel"),
            clearButton = container.find(".sp-clear"),
            chooseButton = container.find(".sp-choose"),
            toggleButton = container.find(".sp-palette-toggle"),
            isInput = boundElement.is("input"),
            isInputTypeColor = isInput && inputTypeColorSupport && boundElement.attr("type") === "color",
            shouldReplace = isInput && !flat,
            replacer = (shouldReplace) ? $(replaceInput).addClass(theme).addClass(opts.className).addClass(opts.replacerClassName) : $([]),
            offsetElement = (shouldReplace) ? replacer : boundElement,
            previewElement = replacer.find(".sp-preview-inner"),
            initialColor = opts.color || (isInput && boundElement.val()),
            colorOnShow = false,
            preferredFormat = opts.preferredFormat,
            currentPreferredFormat = preferredFormat,
            clickoutFiresChange = !opts.showButtons || opts.clickoutFiresChange,
            isEmpty = !initialColor,
            allowEmpty = opts.allowEmpty && !isInputTypeColor;

        function applyOptions() {

            if (opts.showPaletteOnly) {
                opts.showPalette = true;
            }

            toggleButton.text(opts.showPaletteOnly ? opts.togglePaletteMoreText : opts.togglePaletteLessText);

            if (opts.palette) {
                palette = opts.palette.slice(0);
                paletteArray = $.isArray(palette[0]) ? palette : [palette];
                paletteLookup = {};
                for (var i = 0; i < paletteArray.length; i++) {
                    for (var j = 0; j < paletteArray[i].length; j++) {
                        var rgb = tinycolor(paletteArray[i][j]).toRgbString();
                        paletteLookup[rgb] = true;
                    }
                }
            }

            container.toggleClass("sp-flat", flat);
            container.toggleClass("sp-input-disabled", !opts.showInput);
            container.toggleClass("sp-alpha-enabled", opts.showAlpha);
            container.toggleClass("sp-clear-enabled", allowEmpty);
            container.toggleClass("sp-buttons-disabled", !opts.showButtons);
            container.toggleClass("sp-palette-buttons-disabled", !opts.togglePaletteOnly);
            container.toggleClass("sp-palette-disabled", !opts.showPalette);
            container.toggleClass("sp-palette-only", opts.showPaletteOnly);
            container.toggleClass("sp-initial-disabled", !opts.showInitial);
            container.addClass(opts.className).addClass(opts.containerClassName);

            reflow();
        }

        function initialize() {

            if (IE) {
                container.find("*:not(input)").attr("unselectable", "on");
            }

            applyOptions();

            if (shouldReplace) {
                boundElement.after(replacer).hide();
            }

            if (!allowEmpty) {
                clearButton.hide();
            }

            if (flat) {
                boundElement.after(container).hide();
            }
            else {

                var appendTo = opts.appendTo === "parent" ? boundElement.parent() : $(opts.appendTo);
                if (appendTo.length !== 1) {
                    appendTo = $("body");
                }

                appendTo.append(container);
            }

            updateSelectionPaletteFromStorage();

            offsetElement.bind("click.spectrum touchstart.spectrum", function (e) {
                if (!disabled) {
                    toggle();
                }

                e.stopPropagation();

                if (!$(e.target).is("input")) {
                    e.preventDefault();
                }
            });

            if(boundElement.is(":disabled") || (opts.disabled === true)) {
                disable();
            }

            // Prevent clicks from bubbling up to document.  This would cause it to be hidden.
            container.click(stopPropagation);

            // Handle user typed input
            textInput.change(setFromTextInput);
            textInput.bind("paste", function () {
                setTimeout(setFromTextInput, 1);
            });
            textInput.keydown(function (e) { if (e.keyCode == 13) { setFromTextInput(); } });

            cancelButton.text(opts.cancelText);
            cancelButton.bind("click.spectrum", function (e) {
                e.stopPropagation();
                e.preventDefault();
                revert();
                hide();
            });

            clearButton.attr("title", opts.clearText);
            clearButton.bind("click.spectrum", function (e) {
                e.stopPropagation();
                e.preventDefault();
                isEmpty = true;
                move();

                if(flat) {
                    //for the flat style, this is a change event
                    updateOriginalInput(true);
                }
            });

            chooseButton.text(opts.chooseText);
            chooseButton.bind("click.spectrum", function (e) {
                e.stopPropagation();
                e.preventDefault();

                if (isValid()) {
                    updateOriginalInput(true);
                    hide();
                }
            });

            toggleButton.text(opts.showPaletteOnly ? opts.togglePaletteMoreText : opts.togglePaletteLessText);
            toggleButton.bind("click.spectrum", function (e) {
                e.stopPropagation();
                e.preventDefault();

                opts.showPaletteOnly = !opts.showPaletteOnly;

                // To make sure the Picker area is drawn on the right, next to the
                // Palette area (and not below the palette), first move the Palette
                // to the left to make space for the picker, plus 5px extra.
                // The 'applyOptions' function puts the whole container back into place
                // and takes care of the button-text and the sp-palette-only CSS class.
                if (!opts.showPaletteOnly && !flat) {
                    container.css('left', '-=' + (pickerContainer.outerWidth(true) + 5));
                }
                applyOptions();
            });

            draggable(alphaSlider, function (dragX, dragY, e) {
                currentAlpha = (dragX / alphaWidth);
                isEmpty = false;
                if (e.shiftKey) {
                    currentAlpha = Math.round(currentAlpha * 10) / 10;
                }

                move();
            }, dragStart, dragStop);

            draggable(slider, function (dragX, dragY) {
                currentHue = parseFloat(dragY / slideHeight);
                isEmpty = false;
                if (!opts.showAlpha) {
                    currentAlpha = 1;
                }
                move();
            }, dragStart, dragStop);

            draggable(dragger, function (dragX, dragY, e) {

                // shift+drag should snap the movement to either the x or y axis.
                if (!e.shiftKey) {
                    shiftMovementDirection = null;
                }
                else if (!shiftMovementDirection) {
                    var oldDragX = currentSaturation * dragWidth;
                    var oldDragY = dragHeight - (currentValue * dragHeight);
                    var furtherFromX = Math.abs(dragX - oldDragX) > Math.abs(dragY - oldDragY);

                    shiftMovementDirection = furtherFromX ? "x" : "y";
                }

                var setSaturation = !shiftMovementDirection || shiftMovementDirection === "x";
                var setValue = !shiftMovementDirection || shiftMovementDirection === "y";

                if (setSaturation) {
                    currentSaturation = parseFloat(dragX / dragWidth);
                }
                if (setValue) {
                    currentValue = parseFloat((dragHeight - dragY) / dragHeight);
                }

                isEmpty = false;
                if (!opts.showAlpha) {
                    currentAlpha = 1;
                }

                move();

            }, dragStart, dragStop);

            if (!!initialColor) {
                set(initialColor);

                // In case color was black - update the preview UI and set the format
                // since the set function will not run (default color is black).
                updateUI();
                currentPreferredFormat = preferredFormat || tinycolor(initialColor).format;

                addColorToSelectionPalette(initialColor);
            }
            else {
                updateUI();
            }

            if (flat) {
                show();
            }

            function paletteElementClick(e) {
                if (e.data && e.data.ignore) {
                    set($(e.target).closest(".sp-thumb-el").data("color"));
                    move();
                }
                else {
                    set($(e.target).closest(".sp-thumb-el").data("color"));
                    move();
                    updateOriginalInput(true);
                    if (opts.hideAfterPaletteSelect) {
                      hide();
                    }
                }

                return false;
            }

            var paletteEvent = IE ? "mousedown.spectrum" : "click.spectrum touchstart.spectrum";
            paletteContainer.delegate(".sp-thumb-el", paletteEvent, paletteElementClick);
            initialColorContainer.delegate(".sp-thumb-el:nth-child(1)", paletteEvent, { ignore: true }, paletteElementClick);
        }

        function updateSelectionPaletteFromStorage() {

            if (localStorageKey && window.localStorage) {

                // Migrate old palettes over to new format.  May want to remove this eventually.
                try {
                    var oldPalette = window.localStorage[localStorageKey].split(",#");
                    if (oldPalette.length > 1) {
                        delete window.localStorage[localStorageKey];
                        $.each(oldPalette, function(i, c) {
                             addColorToSelectionPalette(c);
                        });
                    }
                }
                catch(e) { }

                try {
                    selectionPalette = window.localStorage[localStorageKey].split(";");
                }
                catch (e) { }
            }
        }

        function addColorToSelectionPalette(color) {
            if (showSelectionPalette) {
                var rgb = tinycolor(color).toRgbString();
                if (!paletteLookup[rgb] && $.inArray(rgb, selectionPalette) === -1) {
                    selectionPalette.push(rgb);
                    while(selectionPalette.length > maxSelectionSize) {
                        selectionPalette.shift();
                    }
                }

                if (localStorageKey && window.localStorage) {
                    try {
                        window.localStorage[localStorageKey] = selectionPalette.join(";");
                    }
                    catch(e) { }
                }
            }
        }

        function getUniqueSelectionPalette() {
            var unique = [];
            if (opts.showPalette) {
                for (var i = 0; i < selectionPalette.length; i++) {
                    var rgb = tinycolor(selectionPalette[i]).toRgbString();

                    if (!paletteLookup[rgb]) {
                        unique.push(selectionPalette[i]);
                    }
                }
            }

            return unique.reverse().slice(0, opts.maxSelectionSize);
        }

        function drawPalette() {

            var currentColor = get();

            var html = $.map(paletteArray, function (palette, i) {
                return paletteTemplate(palette, currentColor, "sp-palette-row sp-palette-row-" + i, opts);
            });

            updateSelectionPaletteFromStorage();

            if (selectionPalette) {
                html.push(paletteTemplate(getUniqueSelectionPalette(), currentColor, "sp-palette-row sp-palette-row-selection", opts));
            }

            paletteContainer.html(html.join(""));
        }

        function drawInitial() {
            if (opts.showInitial) {
                var initial = colorOnShow;
                var current = get();
                initialColorContainer.html(paletteTemplate([initial, current], current, "sp-palette-row-initial", opts));
            }
        }

        function dragStart() {
            if (dragHeight <= 0 || dragWidth <= 0 || slideHeight <= 0) {
                reflow();
            }
            container.addClass(draggingClass);
            shiftMovementDirection = null;
            boundElement.trigger('dragstart.spectrum', [ get() ]);
        }

        function dragStop() {
            container.removeClass(draggingClass);
            boundElement.trigger('dragstop.spectrum', [ get() ]);
        }

        function setFromTextInput() {

            var value = textInput.val();

            if ((value === null || value === "") && allowEmpty) {
                set(null);
                updateOriginalInput(true);
            }
            else {
                var tiny = tinycolor(value);
                if (tiny.isValid()) {
                    set(tiny);
                    updateOriginalInput(true);
                }
                else {
                    textInput.addClass("sp-validation-error");
                }
            }
        }

        function toggle() {
            if (visible) {
                hide();
            }
            else {
                show();
            }
        }

        function show() {
            var event = $.Event('beforeShow.spectrum');

            if (visible) {
                reflow();
                return;
            }

            boundElement.trigger(event, [ get() ]);

            if (callbacks.beforeShow(get()) === false || event.isDefaultPrevented()) {
                return;
            }

            hideAll();
            visible = true;

            $(doc).bind("click.spectrum", clickout);
            $(window).bind("resize.spectrum", resize);
            replacer.addClass("sp-active");
            container.removeClass("sp-hidden");

            reflow();
            updateUI();

            colorOnShow = get();

            drawInitial();
            callbacks.show(colorOnShow);
            boundElement.trigger('show.spectrum', [ colorOnShow ]);
        }

        function clickout(e) {
            // Return on right click.
            if (e.button == 2) { return; }

            if (clickoutFiresChange) {
                updateOriginalInput(true);
            }
            else {
                revert();
            }
            hide();
        }

        function hide() {
            // Return if hiding is unnecessary
            if (!visible || flat) { return; }
            visible = false;

            $(doc).unbind("click.spectrum", clickout);
            $(window).unbind("resize.spectrum", resize);

            replacer.removeClass("sp-active");
            container.addClass("sp-hidden");

            callbacks.hide(get());
            boundElement.trigger('hide.spectrum', [ get() ]);
        }

        function revert() {
            set(colorOnShow, true);
        }

        function set(color, ignoreFormatChange) {
            if (tinycolor.equals(color, get())) {
                // Update UI just in case a validation error needs
                // to be cleared.
                updateUI();
                return;
            }

            var newColor, newHsv;
            if (!color && allowEmpty) {
                isEmpty = true;
            } else {
                isEmpty = false;
                newColor = tinycolor(color);
                newHsv = newColor.toHsv();

                currentHue = (newHsv.h % 360) / 360;
                currentSaturation = newHsv.s;
                currentValue = newHsv.v;
                currentAlpha = newHsv.a;
            }
            updateUI();

            if (newColor && newColor.isValid() && !ignoreFormatChange) {
                currentPreferredFormat = preferredFormat || newColor.getFormat();
            }
        }

        function get(opts) {
            opts = opts || { };

            if (allowEmpty && isEmpty) {
                return null;
            }

            return tinycolor.fromRatio({
                h: currentHue,
                s: currentSaturation,
                v: currentValue,
                a: Math.round(currentAlpha * 100) / 100
            }, { format: opts.format || currentPreferredFormat });
        }

        function isValid() {
            return !textInput.hasClass("sp-validation-error");
        }

        function move() {
            updateUI();

            callbacks.move(get());
            boundElement.trigger('move.spectrum', [ get() ]);
        }

        function updateUI() {

            textInput.removeClass("sp-validation-error");

            updateHelperLocations();

            // Update dragger background color (gradients take care of saturation and value).
            var flatColor = tinycolor.fromRatio({ h: currentHue, s: 1, v: 1 });
            dragger.css("background-color", flatColor.toHexString());

            // Get a format that alpha will be included in (hex and names ignore alpha)
            var format = currentPreferredFormat;
            if (currentAlpha < 1 && !(currentAlpha === 0 && format === "name")) {
                if (format === "hex" || format === "hex3" || format === "hex6" || format === "name") {
                    format = "rgb";
                }
            }

            var realColor = get({ format: format }),
                displayColor = '';

             //reset background info for preview element
            previewElement.removeClass("sp-clear-display");
            previewElement.css('background-color', 'transparent');

            if (!realColor && allowEmpty) {
                // Update the replaced elements background with icon indicating no color selection
                previewElement.addClass("sp-clear-display");
            }
            else {
                var realHex = realColor.toHexString(),
                    realRgb = realColor.toRgbString();

                // Update the replaced elements background color (with actual selected color)
                if (rgbaSupport || realColor.alpha === 1) {
                    previewElement.css("background-color", realRgb);
                }
                else {
                    previewElement.css("background-color", "transparent");
                    previewElement.css("filter", realColor.toFilter());
                }

                if (opts.showAlpha) {
                    var rgb = realColor.toRgb();
                    rgb.a = 0;
                    var realAlpha = tinycolor(rgb).toRgbString();
                    var gradient = "linear-gradient(left, " + realAlpha + ", " + realHex + ")";

                    if (IE) {
                        alphaSliderInner.css("filter", tinycolor(realAlpha).toFilter({ gradientType: 1 }, realHex));
                    }
                    else {
                        alphaSliderInner.css("background", "-webkit-" + gradient);
                        alphaSliderInner.css("background", "-moz-" + gradient);
                        alphaSliderInner.css("background", "-ms-" + gradient);
                        // Use current syntax gradient on unprefixed property.
                        alphaSliderInner.css("background",
                            "linear-gradient(to right, " + realAlpha + ", " + realHex + ")");
                    }
                }

                displayColor = realColor.toString(format);
            }

            // Update the text entry input as it changes happen
            if (opts.showInput) {
                textInput.val(displayColor);
            }

            if (opts.showPalette) {
                drawPalette();
            }

            drawInitial();
        }

        function updateHelperLocations() {
            var s = currentSaturation;
            var v = currentValue;

            if(allowEmpty && isEmpty) {
                //if selected color is empty, hide the helpers
                alphaSlideHelper.hide();
                slideHelper.hide();
                dragHelper.hide();
            }
            else {
                //make sure helpers are visible
                alphaSlideHelper.show();
                slideHelper.show();
                dragHelper.show();

                // Where to show the little circle in that displays your current selected color
                var dragX = s * dragWidth;
                var dragY = dragHeight - (v * dragHeight);
                dragX = Math.max(
                    -dragHelperHeight,
                    Math.min(dragWidth - dragHelperHeight, dragX - dragHelperHeight)
                );
                dragY = Math.max(
                    -dragHelperHeight,
                    Math.min(dragHeight - dragHelperHeight, dragY - dragHelperHeight)
                );
                dragHelper.css({
                    "top": dragY + "px",
                    "left": dragX + "px"
                });

                var alphaX = currentAlpha * alphaWidth;
                alphaSlideHelper.css({
                    "left": (alphaX - (alphaSlideHelperWidth / 2)) + "px"
                });

                // Where to show the bar that displays your current selected hue
                var slideY = (currentHue) * slideHeight;
                slideHelper.css({
                    "top": (slideY - slideHelperHeight) + "px"
                });
            }
        }

        function updateOriginalInput(fireCallback) {
            var color = get(),
                displayColor = '',
                hasChanged = !tinycolor.equals(color, colorOnShow);

            if (color) {
                displayColor = color.toString(currentPreferredFormat);
                // Update the selection palette with the current color
                addColorToSelectionPalette(color);
            }

            if (isInput) {
                boundElement.val(displayColor);
            }

            if (fireCallback && hasChanged) {
                callbacks.change(color);
                boundElement.trigger('change', [ color ]);
            }
        }

        function reflow() {
            dragWidth = dragger.width();
            dragHeight = dragger.height();
            dragHelperHeight = dragHelper.height();
            slideWidth = slider.width();
            slideHeight = slider.height();
            slideHelperHeight = slideHelper.height();
            alphaWidth = alphaSlider.width();
            alphaSlideHelperWidth = alphaSlideHelper.width();

            if (!flat) {
                container.css("position", "absolute");
                if (opts.offset) {
                    container.offset(opts.offset);
                } else {
                    container.offset(getOffset(container, offsetElement));
                }
            }

            updateHelperLocations();

            if (opts.showPalette) {
                drawPalette();
            }

            boundElement.trigger('reflow.spectrum');
        }

        function destroy() {
            boundElement.show();
            offsetElement.unbind("click.spectrum touchstart.spectrum");
            container.remove();
            replacer.remove();
            spectrums[spect.id] = null;
        }

        function option(optionName, optionValue) {
            if (optionName === undefined) {
                return $.extend({}, opts);
            }
            if (optionValue === undefined) {
                return opts[optionName];
            }

            opts[optionName] = optionValue;
            applyOptions();
        }

        function enable() {
            disabled = false;
            boundElement.attr("disabled", false);
            offsetElement.removeClass("sp-disabled");
        }

        function disable() {
            hide();
            disabled = true;
            boundElement.attr("disabled", true);
            offsetElement.addClass("sp-disabled");
        }

        function setOffset(coord) {
            opts.offset = coord;
            reflow();
        }

        initialize();

        var spect = {
            show: show,
            hide: hide,
            toggle: toggle,
            reflow: reflow,
            option: option,
            enable: enable,
            disable: disable,
            offset: setOffset,
            set: function (c) {
                set(c);
                updateOriginalInput();
            },
            get: get,
            destroy: destroy,
            container: container
        };

        spect.id = spectrums.push(spect) - 1;

        return spect;
    }

    /**
    * checkOffset - get the offset below/above and left/right element depending on screen position
    * Thanks https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.datepicker.js
    */
    function getOffset(picker, input) {
        var extraY = 0;
        var dpWidth = picker.outerWidth();
        var dpHeight = picker.outerHeight();
        var inputHeight = input.outerHeight();
        var doc = picker[0].ownerDocument;
        var docElem = doc.documentElement;
        var viewWidth = docElem.clientWidth + $(doc).scrollLeft();
        var viewHeight = docElem.clientHeight + $(doc).scrollTop();
        var offset = input.offset();
        offset.top += inputHeight;

        offset.left -=
            Math.min(offset.left, (offset.left + dpWidth > viewWidth && viewWidth > dpWidth) ?
            Math.abs(offset.left + dpWidth - viewWidth) : 0);

        offset.top -=
            Math.min(offset.top, ((offset.top + dpHeight > viewHeight && viewHeight > dpHeight) ?
            Math.abs(dpHeight + inputHeight - extraY) : extraY));

        return offset;
    }

    /**
    * noop - do nothing
    */
    function noop() {

    }

    /**
    * stopPropagation - makes the code only doing this a little easier to read in line
    */
    function stopPropagation(e) {
        e.stopPropagation();
    }

    /**
    * Create a function bound to a given object
    * Thanks to underscore.js
    */
    function bind(func, obj) {
        var slice = Array.prototype.slice;
        var args = slice.call(arguments, 2);
        return function () {
            return func.apply(obj, args.concat(slice.call(arguments)));
        };
    }

    /**
    * Lightweight drag helper.  Handles containment within the element, so that
    * when dragging, the x is within [0,element.width] and y is within [0,element.height]
    */
    function draggable(element, onmove, onstart, onstop) {
        onmove = onmove || function () { };
        onstart = onstart || function () { };
        onstop = onstop || function () { };
        var doc = document;
        var dragging = false;
        var offset = {};
        var maxHeight = 0;
        var maxWidth = 0;
        var hasTouch = ('ontouchstart' in window);

        var duringDragEvents = {};
        duringDragEvents["selectstart"] = prevent;
        duringDragEvents["dragstart"] = prevent;
        duringDragEvents["touchmove mousemove"] = move;
        duringDragEvents["touchend mouseup"] = stop;

        function prevent(e) {
            if (e.stopPropagation) {
                e.stopPropagation();
            }
            if (e.preventDefault) {
                e.preventDefault();
            }
            e.returnValue = false;
        }

        function move(e) {
            if (dragging) {
                // Mouseup happened outside of window
                if (IE && doc.documentMode < 9 && !e.button) {
                    return stop();
                }

                var touches = e.originalEvent && e.originalEvent.touches;
                var pageX = touches ? touches[0].pageX : e.pageX;
                var pageY = touches ? touches[0].pageY : e.pageY;

                var dragX = Math.max(0, Math.min(pageX - offset.left, maxWidth));
                var dragY = Math.max(0, Math.min(pageY - offset.top, maxHeight));

                if (hasTouch) {
                    // Stop scrolling in iOS
                    prevent(e);
                }

                onmove.apply(element, [dragX, dragY, e]);
            }
        }

        function start(e) {
            var rightclick = (e.which) ? (e.which == 3) : (e.button == 2);

            if (!rightclick && !dragging) {
                if (onstart.apply(element, arguments) !== false) {
                    dragging = true;
                    maxHeight = $(element).height();
                    maxWidth = $(element).width();
                    offset = $(element).offset();

                    $(doc).bind(duringDragEvents);
                    $(doc.body).addClass("sp-dragging");

                    if (!hasTouch) {
                        move(e);
                    }

                    prevent(e);
                }
            }
        }

        function stop() {
            if (dragging) {
                $(doc).unbind(duringDragEvents);
                $(doc.body).removeClass("sp-dragging");
                onstop.apply(element, arguments);
            }
            dragging = false;
        }

        $(element).bind("touchstart mousedown", start);
    }

    function throttle(func, wait, debounce) {
        var timeout;
        return function () {
            var context = this, args = arguments;
            var throttler = function () {
                timeout = null;
                func.apply(context, args);
            };
            if (debounce) clearTimeout(timeout);
            if (debounce || !timeout) timeout = setTimeout(throttler, wait);
        };
    }

    /**
    * Define a jQuery plugin
    */
    var dataID = "spectrum.id";
    $.fn.spectrum = function (opts, extra) {

        if (typeof opts == "string") {

            var returnValue = this;
            var args = Array.prototype.slice.call( arguments, 1 );

            this.each(function () {
                var spect = spectrums[$(this).data(dataID)];
                if (spect) {
                    var method = spect[opts];
                    if (!method) {
                        throw new Error( "Spectrum: no such method: '" + opts + "'" );
                    }

                    if (opts == "get") {
                        returnValue = spect.get();
                    }
                    else if (opts == "container") {
                        returnValue = spect.container;
                    }
                    else if (opts == "option") {
                        returnValue = spect.option.apply(spect, args);
                    }
                    else if (opts == "destroy") {
                        spect.destroy();
                        $(this).removeData(dataID);
                    }
                    else {
                        method.apply(spect, args);
                    }
                }
            });

            return returnValue;
        }

        // Initializing a new instance of spectrum
        return this.spectrum("destroy").each(function () {
            var options = $.extend({}, opts, $(this).data());
            var spect = spectrum(this, options);
            $(this).data(dataID, spect.id);
        });
    };

    $.fn.spectrum.load = true;
    $.fn.spectrum.loadOpts = {};
    $.fn.spectrum.draggable = draggable;
    $.fn.spectrum.defaults = defaultOpts;

    $.spectrum = { };
    $.spectrum.localization = { };
    $.spectrum.palettes = { };

    $.fn.spectrum.processNativeColorInputs = function () {
        if (!inputTypeColorSupport) {
            $("input[type=color]").spectrum({
                preferredFormat: "hex6"
            });
        }
    };

    // TinyColor v1.1.1
    // https://github.com/bgrins/TinyColor
    // Brian Grinstead, MIT License

    (function() {

    var trimLeft = /^[\s,#]+/,
        trimRight = /\s+$/,
        tinyCounter = 0,
        math = Math,
        mathRound = math.round,
        mathMin = math.min,
        mathMax = math.max,
        mathRandom = math.random;

    var tinycolor = function tinycolor (color, opts) {

        color = (color) ? color : '';
        opts = opts || { };

        // If input is already a tinycolor, return itself
        if (color instanceof tinycolor) {
           return color;
        }
        // If we are called as a function, call using new instead
        if (!(this instanceof tinycolor)) {
            return new tinycolor(color, opts);
        }

        var rgb = inputToRGB(color);
        this._originalInput = color,
        this._r = rgb.r,
        this._g = rgb.g,
        this._b = rgb.b,
        this._a = rgb.a,
        this._roundA = mathRound(100*this._a) / 100,
        this._format = opts.format || rgb.format;
        this._gradientType = opts.gradientType;

        // Don't let the range of [0,255] come back in [0,1].
        // Potentially lose a little bit of precision here, but will fix issues where
        // .5 gets interpreted as half of the total, instead of half of 1
        // If it was supposed to be 128, this was already taken care of by `inputToRgb`
        if (this._r < 1) { this._r = mathRound(this._r); }
        if (this._g < 1) { this._g = mathRound(this._g); }
        if (this._b < 1) { this._b = mathRound(this._b); }

        this._ok = rgb.ok;
        this._tc_id = tinyCounter++;
    };

    tinycolor.prototype = {
        isDark: function() {
            return this.getBrightness() < 128;
        },
        isLight: function() {
            return !this.isDark();
        },
        isValid: function() {
            return this._ok;
        },
        getOriginalInput: function() {
          return this._originalInput;
        },
        getFormat: function() {
            return this._format;
        },
        getAlpha: function() {
            return this._a;
        },
        getBrightness: function() {
            var rgb = this.toRgb();
            return (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000;
        },
        setAlpha: function(value) {
            this._a = boundAlpha(value);
            this._roundA = mathRound(100*this._a) / 100;
            return this;
        },
        toHsv: function() {
            var hsv = rgbToHsv(this._r, this._g, this._b);
            return { h: hsv.h * 360, s: hsv.s, v: hsv.v, a: this._a };
        },
        toHsvString: function() {
            var hsv = rgbToHsv(this._r, this._g, this._b);
            var h = mathRound(hsv.h * 360), s = mathRound(hsv.s * 100), v = mathRound(hsv.v * 100);
            return (this._a == 1) ?
              "hsv("  + h + ", " + s + "%, " + v + "%)" :
              "hsva(" + h + ", " + s + "%, " + v + "%, "+ this._roundA + ")";
        },
        toHsl: function() {
            var hsl = rgbToHsl(this._r, this._g, this._b);
            return { h: hsl.h * 360, s: hsl.s, l: hsl.l, a: this._a };
        },
        toHslString: function() {
            var hsl = rgbToHsl(this._r, this._g, this._b);
            var h = mathRound(hsl.h * 360), s = mathRound(hsl.s * 100), l = mathRound(hsl.l * 100);
            return (this._a == 1) ?
              "hsl("  + h + ", " + s + "%, " + l + "%)" :
              "hsla(" + h + ", " + s + "%, " + l + "%, "+ this._roundA + ")";
        },
        toHex: function(allow3Char) {
            return rgbToHex(this._r, this._g, this._b, allow3Char);
        },
        toHexString: function(allow3Char) {
            return '#' + this.toHex(allow3Char);
        },
        toHex8: function() {
            return rgbaToHex(this._r, this._g, this._b, this._a);
        },
        toHex8String: function() {
            return '#' + this.toHex8();
        },
        toRgb: function() {
            return { r: mathRound(this._r), g: mathRound(this._g), b: mathRound(this._b), a: this._a };
        },
        toRgbString: function() {
            return (this._a == 1) ?
              "rgb("  + mathRound(this._r) + ", " + mathRound(this._g) + ", " + mathRound(this._b) + ")" :
              "rgba(" + mathRound(this._r) + ", " + mathRound(this._g) + ", " + mathRound(this._b) + ", " + this._roundA + ")";
        },
        toPercentageRgb: function() {
            return { r: mathRound(bound01(this._r, 255) * 100) + "%", g: mathRound(bound01(this._g, 255) * 100) + "%", b: mathRound(bound01(this._b, 255) * 100) + "%", a: this._a };
        },
        toPercentageRgbString: function() {
            return (this._a == 1) ?
              "rgb("  + mathRound(bound01(this._r, 255) * 100) + "%, " + mathRound(bound01(this._g, 255) * 100) + "%, " + mathRound(bound01(this._b, 255) * 100) + "%)" :
              "rgba(" + mathRound(bound01(this._r, 255) * 100) + "%, " + mathRound(bound01(this._g, 255) * 100) + "%, " + mathRound(bound01(this._b, 255) * 100) + "%, " + this._roundA + ")";
        },
        toName: function() {
            if (this._a === 0) {
                return "transparent";
            }

            if (this._a < 1) {
                return false;
            }

            return hexNames[rgbToHex(this._r, this._g, this._b, true)] || false;
        },
        toFilter: function(secondColor) {
            var hex8String = '#' + rgbaToHex(this._r, this._g, this._b, this._a);
            var secondHex8String = hex8String;
            var gradientType = this._gradientType ? "GradientType = 1, " : "";

            if (secondColor) {
                var s = tinycolor(secondColor);
                secondHex8String = s.toHex8String();
            }

            return "progid:DXImageTransform.Microsoft.gradient("+gradientType+"startColorstr="+hex8String+",endColorstr="+secondHex8String+")";
        },
        toString: function(format) {
            var formatSet = !!format;
            format = format || this._format;

            var formattedString = false;
            var hasAlpha = this._a < 1 && this._a >= 0;
            var needsAlphaFormat = !formatSet && hasAlpha && (format === "hex" || format === "hex6" || format === "hex3" || format === "name");

            if (needsAlphaFormat) {
                // Special case for "transparent", all other non-alpha formats
                // will return rgba when there is transparency.
                if (format === "name" && this._a === 0) {
                    return this.toName();
                }
                return this.toRgbString();
            }
            if (format === "rgb") {
                formattedString = this.toRgbString();
            }
            if (format === "prgb") {
                formattedString = this.toPercentageRgbString();
            }
            if (format === "hex" || format === "hex6") {
                formattedString = this.toHexString();
            }
            if (format === "hex3") {
                formattedString = this.toHexString(true);
            }
            if (format === "hex8") {
                formattedString = this.toHex8String();
            }
            if (format === "name") {
                formattedString = this.toName();
            }
            if (format === "hsl") {
                formattedString = this.toHslString();
            }
            if (format === "hsv") {
                formattedString = this.toHsvString();
            }

            return formattedString || this.toHexString();
        },

        _applyModification: function(fn, args) {
            var color = fn.apply(null, [this].concat([].slice.call(args)));
            this._r = color._r;
            this._g = color._g;
            this._b = color._b;
            this.setAlpha(color._a);
            return this;
        },
        lighten: function() {
            return this._applyModification(lighten, arguments);
        },
        brighten: function() {
            return this._applyModification(brighten, arguments);
        },
        darken: function() {
            return this._applyModification(darken, arguments);
        },
        desaturate: function() {
            return this._applyModification(desaturate, arguments);
        },
        saturate: function() {
            return this._applyModification(saturate, arguments);
        },
        greyscale: function() {
            return this._applyModification(greyscale, arguments);
        },
        spin: function() {
            return this._applyModification(spin, arguments);
        },

        _applyCombination: function(fn, args) {
            return fn.apply(null, [this].concat([].slice.call(args)));
        },
        analogous: function() {
            return this._applyCombination(analogous, arguments);
        },
        complement: function() {
            return this._applyCombination(complement, arguments);
        },
        monochromatic: function() {
            return this._applyCombination(monochromatic, arguments);
        },
        splitcomplement: function() {
            return this._applyCombination(splitcomplement, arguments);
        },
        triad: function() {
            return this._applyCombination(triad, arguments);
        },
        tetrad: function() {
            return this._applyCombination(tetrad, arguments);
        }
    };

    // If input is an object, force 1 into "1.0" to handle ratios properly
    // String input requires "1.0" as input, so 1 will be treated as 1
    tinycolor.fromRatio = function(color, opts) {
        if (typeof color == "object") {
            var newColor = {};
            for (var i in color) {
                if (color.hasOwnProperty(i)) {
                    if (i === "a") {
                        newColor[i] = color[i];
                    }
                    else {
                        newColor[i] = convertToPercentage(color[i]);
                    }
                }
            }
            color = newColor;
        }

        return tinycolor(color, opts);
    };

    // Given a string or object, convert that input to RGB
    // Possible string inputs:
    //
    //     "red"
    //     "#f00" or "f00"
    //     "#ff0000" or "ff0000"
    //     "#ff000000" or "ff000000"
    //     "rgb 255 0 0" or "rgb (255, 0, 0)"
    //     "rgb 1.0 0 0" or "rgb (1, 0, 0)"
    //     "rgba (255, 0, 0, 1)" or "rgba 255, 0, 0, 1"
    //     "rgba (1.0, 0, 0, 1)" or "rgba 1.0, 0, 0, 1"
    //     "hsl(0, 100%, 50%)" or "hsl 0 100% 50%"
    //     "hsla(0, 100%, 50%, 1)" or "hsla 0 100% 50%, 1"
    //     "hsv(0, 100%, 100%)" or "hsv 0 100% 100%"
    //
    function inputToRGB(color) {

        var rgb = { r: 0, g: 0, b: 0 };
        var a = 1;
        var ok = false;
        var format = false;

        if (typeof color == "string") {
            color = stringInputToObject(color);
        }

        if (typeof color == "object") {
            if (color.hasOwnProperty("r") && color.hasOwnProperty("g") && color.hasOwnProperty("b")) {
                rgb = rgbToRgb(color.r, color.g, color.b);
                ok = true;
                format = String(color.r).substr(-1) === "%" ? "prgb" : "rgb";
            }
            else if (color.hasOwnProperty("h") && color.hasOwnProperty("s") && color.hasOwnProperty("v")) {
                color.s = convertToPercentage(color.s);
                color.v = convertToPercentage(color.v);
                rgb = hsvToRgb(color.h, color.s, color.v);
                ok = true;
                format = "hsv";
            }
            else if (color.hasOwnProperty("h") && color.hasOwnProperty("s") && color.hasOwnProperty("l")) {
                color.s = convertToPercentage(color.s);
                color.l = convertToPercentage(color.l);
                rgb = hslToRgb(color.h, color.s, color.l);
                ok = true;
                format = "hsl";
            }

            if (color.hasOwnProperty("a")) {
                a = color.a;
            }
        }

        a = boundAlpha(a);

        return {
            ok: ok,
            format: color.format || format,
            r: mathMin(255, mathMax(rgb.r, 0)),
            g: mathMin(255, mathMax(rgb.g, 0)),
            b: mathMin(255, mathMax(rgb.b, 0)),
            a: a
        };
    }


    // Conversion Functions
    // --------------------

    // `rgbToHsl`, `rgbToHsv`, `hslToRgb`, `hsvToRgb` modified from:
    // <http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript>

    // `rgbToRgb`
    // Handle bounds / percentage checking to conform to CSS color spec
    // <http://www.w3.org/TR/css3-color/>
    // *Assumes:* r, g, b in [0, 255] or [0, 1]
    // *Returns:* { r, g, b } in [0, 255]
    function rgbToRgb(r, g, b){
        return {
            r: bound01(r, 255) * 255,
            g: bound01(g, 255) * 255,
            b: bound01(b, 255) * 255
        };
    }

    // `rgbToHsl`
    // Converts an RGB color value to HSL.
    // *Assumes:* r, g, and b are contained in [0, 255] or [0, 1]
    // *Returns:* { h, s, l } in [0,1]
    function rgbToHsl(r, g, b) {

        r = bound01(r, 255);
        g = bound01(g, 255);
        b = bound01(b, 255);

        var max = mathMax(r, g, b), min = mathMin(r, g, b);
        var h, s, l = (max + min) / 2;

        if(max == min) {
            h = s = 0; // achromatic
        }
        else {
            var d = max - min;
            s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
            switch(max) {
                case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                case g: h = (b - r) / d + 2; break;
                case b: h = (r - g) / d + 4; break;
            }

            h /= 6;
        }

        return { h: h, s: s, l: l };
    }

    // `hslToRgb`
    // Converts an HSL color value to RGB.
    // *Assumes:* h is contained in [0, 1] or [0, 360] and s and l are contained [0, 1] or [0, 100]
    // *Returns:* { r, g, b } in the set [0, 255]
    function hslToRgb(h, s, l) {
        var r, g, b;

        h = bound01(h, 360);
        s = bound01(s, 100);
        l = bound01(l, 100);

        function hue2rgb(p, q, t) {
            if(t < 0) t += 1;
            if(t > 1) t -= 1;
            if(t < 1/6) return p + (q - p) * 6 * t;
            if(t < 1/2) return q;
            if(t < 2/3) return p + (q - p) * (2/3 - t) * 6;
            return p;
        }

        if(s === 0) {
            r = g = b = l; // achromatic
        }
        else {
            var q = l < 0.5 ? l * (1 + s) : l + s - l * s;
            var p = 2 * l - q;
            r = hue2rgb(p, q, h + 1/3);
            g = hue2rgb(p, q, h);
            b = hue2rgb(p, q, h - 1/3);
        }

        return { r: r * 255, g: g * 255, b: b * 255 };
    }

    // `rgbToHsv`
    // Converts an RGB color value to HSV
    // *Assumes:* r, g, and b are contained in the set [0, 255] or [0, 1]
    // *Returns:* { h, s, v } in [0,1]
    function rgbToHsv(r, g, b) {

        r = bound01(r, 255);
        g = bound01(g, 255);
        b = bound01(b, 255);

        var max = mathMax(r, g, b), min = mathMin(r, g, b);
        var h, s, v = max;

        var d = max - min;
        s = max === 0 ? 0 : d / max;

        if(max == min) {
            h = 0; // achromatic
        }
        else {
            switch(max) {
                case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                case g: h = (b - r) / d + 2; break;
                case b: h = (r - g) / d + 4; break;
            }
            h /= 6;
        }
        return { h: h, s: s, v: v };
    }

    // `hsvToRgb`
    // Converts an HSV color value to RGB.
    // *Assumes:* h is contained in [0, 1] or [0, 360] and s and v are contained in [0, 1] or [0, 100]
    // *Returns:* { r, g, b } in the set [0, 255]
     function hsvToRgb(h, s, v) {

        h = bound01(h, 360) * 6;
        s = bound01(s, 100);
        v = bound01(v, 100);

        var i = math.floor(h),
            f = h - i,
            p = v * (1 - s),
            q = v * (1 - f * s),
            t = v * (1 - (1 - f) * s),
            mod = i % 6,
            r = [v, q, p, p, t, v][mod],
            g = [t, v, v, q, p, p][mod],
            b = [p, p, t, v, v, q][mod];

        return { r: r * 255, g: g * 255, b: b * 255 };
    }

    // `rgbToHex`
    // Converts an RGB color to hex
    // Assumes r, g, and b are contained in the set [0, 255]
    // Returns a 3 or 6 character hex
    function rgbToHex(r, g, b, allow3Char) {

        var hex = [
            pad2(mathRound(r).toString(16)),
            pad2(mathRound(g).toString(16)),
            pad2(mathRound(b).toString(16))
        ];

        // Return a 3 character hex if possible
        if (allow3Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1)) {
            return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0);
        }

        return hex.join("");
    }
        // `rgbaToHex`
        // Converts an RGBA color plus alpha transparency to hex
        // Assumes r, g, b and a are contained in the set [0, 255]
        // Returns an 8 character hex
        function rgbaToHex(r, g, b, a) {

            var hex = [
                pad2(convertDecimalToHex(a)),
                pad2(mathRound(r).toString(16)),
                pad2(mathRound(g).toString(16)),
                pad2(mathRound(b).toString(16))
            ];

            return hex.join("");
        }

    // `equals`
    // Can be called with any tinycolor input
    tinycolor.equals = function (color1, color2) {
        if (!color1 || !color2) { return false; }
        return tinycolor(color1).toRgbString() == tinycolor(color2).toRgbString();
    };
    tinycolor.random = function() {
        return tinycolor.fromRatio({
            r: mathRandom(),
            g: mathRandom(),
            b: mathRandom()
        });
    };


    // Modification Functions
    // ----------------------
    // Thanks to less.js for some of the basics here
    // <https://github.com/cloudhead/less.js/blob/master/lib/less/functions.js>

    function desaturate(color, amount) {
        amount = (amount === 0) ? 0 : (amount || 10);
        var hsl = tinycolor(color).toHsl();
        hsl.s -= amount / 100;
        hsl.s = clamp01(hsl.s);
        return tinycolor(hsl);
    }

    function saturate(color, amount) {
        amount = (amount === 0) ? 0 : (amount || 10);
        var hsl = tinycolor(color).toHsl();
        hsl.s += amount / 100;
        hsl.s = clamp01(hsl.s);
        return tinycolor(hsl);
    }

    function greyscale(color) {
        return tinycolor(color).desaturate(100);
    }

    function lighten (color, amount) {
        amount = (amount === 0) ? 0 : (amount || 10);
        var hsl = tinycolor(color).toHsl();
        hsl.l += amount / 100;
        hsl.l = clamp01(hsl.l);
        return tinycolor(hsl);
    }

    function brighten(color, amount) {
        amount = (amount === 0) ? 0 : (amount || 10);
        var rgb = tinycolor(color).toRgb();
        rgb.r = mathMax(0, mathMin(255, rgb.r - mathRound(255 * - (amount / 100))));
        rgb.g = mathMax(0, mathMin(255, rgb.g - mathRound(255 * - (amount / 100))));
        rgb.b = mathMax(0, mathMin(255, rgb.b - mathRound(255 * - (amount / 100))));
        return tinycolor(rgb);
    }

    function darken (color, amount) {
        amount = (amount === 0) ? 0 : (amount || 10);
        var hsl = tinycolor(color).toHsl();
        hsl.l -= amount / 100;
        hsl.l = clamp01(hsl.l);
        return tinycolor(hsl);
    }

    // Spin takes a positive or negative amount within [-360, 360] indicating the change of hue.
    // Values outside of this range will be wrapped into this range.
    function spin(color, amount) {
        var hsl = tinycolor(color).toHsl();
        var hue = (mathRound(hsl.h) + amount) % 360;
        hsl.h = hue < 0 ? 360 + hue : hue;
        return tinycolor(hsl);
    }

    // Combination Functions
    // ---------------------
    // Thanks to jQuery xColor for some of the ideas behind these
    // <https://github.com/infusion/jQuery-xcolor/blob/master/jquery.xcolor.js>

    function complement(color) {
        var hsl = tinycolor(color).toHsl();
        hsl.h = (hsl.h + 180) % 360;
        return tinycolor(hsl);
    }

    function triad(color) {
        var hsl = tinycolor(color).toHsl();
        var h = hsl.h;
        return [
            tinycolor(color),
            tinycolor({ h: (h + 120) % 360, s: hsl.s, l: hsl.l }),
            tinycolor({ h: (h + 240) % 360, s: hsl.s, l: hsl.l })
        ];
    }

    function tetrad(color) {
        var hsl = tinycolor(color).toHsl();
        var h = hsl.h;
        return [
            tinycolor(color),
            tinycolor({ h: (h + 90) % 360, s: hsl.s, l: hsl.l }),
            tinycolor({ h: (h + 180) % 360, s: hsl.s, l: hsl.l }),
            tinycolor({ h: (h + 270) % 360, s: hsl.s, l: hsl.l })
        ];
    }

    function splitcomplement(color) {
        var hsl = tinycolor(color).toHsl();
        var h = hsl.h;
        return [
            tinycolor(color),
            tinycolor({ h: (h + 72) % 360, s: hsl.s, l: hsl.l}),
            tinycolor({ h: (h + 216) % 360, s: hsl.s, l: hsl.l})
        ];
    }

    function analogous(color, results, slices) {
        results = results || 6;
        slices = slices || 30;

        var hsl = tinycolor(color).toHsl();
        var part = 360 / slices;
        var ret = [tinycolor(color)];

        for (hsl.h = ((hsl.h - (part * results >> 1)) + 720) % 360; --results; ) {
            hsl.h = (hsl.h + part) % 360;
            ret.push(tinycolor(hsl));
        }
        return ret;
    }

    function monochromatic(color, results) {
        results = results || 6;
        var hsv = tinycolor(color).toHsv();
        var h = hsv.h, s = hsv.s, v = hsv.v;
        var ret = [];
        var modification = 1 / results;

        while (results--) {
            ret.push(tinycolor({ h: h, s: s, v: v}));
            v = (v + modification) % 1;
        }

        return ret;
    }

    // Utility Functions
    // ---------------------

    tinycolor.mix = function(color1, color2, amount) {
        amount = (amount === 0) ? 0 : (amount || 50);

        var rgb1 = tinycolor(color1).toRgb();
        var rgb2 = tinycolor(color2).toRgb();

        var p = amount / 100;
        var w = p * 2 - 1;
        var a = rgb2.a - rgb1.a;

        var w1;

        if (w * a == -1) {
            w1 = w;
        } else {
            w1 = (w + a) / (1 + w * a);
        }

        w1 = (w1 + 1) / 2;

        var w2 = 1 - w1;

        var rgba = {
            r: rgb2.r * w1 + rgb1.r * w2,
            g: rgb2.g * w1 + rgb1.g * w2,
            b: rgb2.b * w1 + rgb1.b * w2,
            a: rgb2.a * p  + rgb1.a * (1 - p)
        };

        return tinycolor(rgba);
    };


    // Readability Functions
    // ---------------------
    // <http://www.w3.org/TR/AERT#color-contrast>

    // `readability`
    // Analyze the 2 colors and returns an object with the following properties:
    //    `brightness`: difference in brightness between the two colors
    //    `color`: difference in color/hue between the two colors
    tinycolor.readability = function(color1, color2) {
        var c1 = tinycolor(color1);
        var c2 = tinycolor(color2);
        var rgb1 = c1.toRgb();
        var rgb2 = c2.toRgb();
        var brightnessA = c1.getBrightness();
        var brightnessB = c2.getBrightness();
        var colorDiff = (
            Math.max(rgb1.r, rgb2.r) - Math.min(rgb1.r, rgb2.r) +
            Math.max(rgb1.g, rgb2.g) - Math.min(rgb1.g, rgb2.g) +
            Math.max(rgb1.b, rgb2.b) - Math.min(rgb1.b, rgb2.b)
        );

        return {
            brightness: Math.abs(brightnessA - brightnessB),
            color: colorDiff
        };
    };

    // `readable`
    // http://www.w3.org/TR/AERT#color-contrast
    // Ensure that foreground and background color combinations provide sufficient contrast.
    // *Example*
    //    tinycolor.isReadable("#000", "#111") => false
    tinycolor.isReadable = function(color1, color2) {
        var readability = tinycolor.readability(color1, color2);
        return readability.brightness > 125 && readability.color > 500;
    };

    // `mostReadable`
    // Given a base color and a list of possible foreground or background
    // colors for that base, returns the most readable color.
    // *Example*
    //    tinycolor.mostReadable("#123", ["#fff", "#000"]) => "#000"
    tinycolor.mostReadable = function(baseColor, colorList) {
        var bestColor = null;
        var bestScore = 0;
        var bestIsReadable = false;
        for (var i=0; i < colorList.length; i++) {

            // We normalize both around the "acceptable" breaking point,
            // but rank brightness constrast higher than hue.

            var readability = tinycolor.readability(baseColor, colorList[i]);
            var readable = readability.brightness > 125 && readability.color > 500;
            var score = 3 * (readability.brightness / 125) + (readability.color / 500);

            if ((readable && ! bestIsReadable) ||
                (readable && bestIsReadable && score > bestScore) ||
                ((! readable) && (! bestIsReadable) && score > bestScore)) {
                bestIsReadable = readable;
                bestScore = score;
                bestColor = tinycolor(colorList[i]);
            }
        }
        return bestColor;
    };


    // Big List of Colors
    // ------------------
    // <http://www.w3.org/TR/css3-color/#svg-color>
    var names = tinycolor.names = {
        aliceblue: "f0f8ff",
        antiquewhite: "faebd7",
        aqua: "0ff",
        aquamarine: "7fffd4",
        azure: "f0ffff",
        beige: "f5f5dc",
        bisque: "ffe4c4",
        black: "000",
        blanchedalmond: "ffebcd",
        blue: "00f",
        blueviolet: "8a2be2",
        brown: "a52a2a",
        burlywood: "deb887",
        burntsienna: "ea7e5d",
        cadetblue: "5f9ea0",
        chartreuse: "7fff00",
        chocolate: "d2691e",
        coral: "ff7f50",
        cornflowerblue: "6495ed",
        cornsilk: "fff8dc",
        crimson: "dc143c",
        cyan: "0ff",
        darkblue: "00008b",
        darkcyan: "008b8b",
        darkgoldenrod: "b8860b",
        darkgray: "a9a9a9",
        darkgreen: "006400",
        darkgrey: "a9a9a9",
        darkkhaki: "bdb76b",
        darkmagenta: "8b008b",
        darkolivegreen: "556b2f",
        darkorange: "ff8c00",
        darkorchid: "9932cc",
        darkred: "8b0000",
        darksalmon: "e9967a",
        darkseagreen: "8fbc8f",
        darkslateblue: "483d8b",
        darkslategray: "2f4f4f",
        darkslategrey: "2f4f4f",
        darkturquoise: "00ced1",
        darkviolet: "9400d3",
        deeppink: "ff1493",
        deepskyblue: "00bfff",
        dimgray: "696969",
        dimgrey: "696969",
        dodgerblue: "1e90ff",
        firebrick: "b22222",
        floralwhite: "fffaf0",
        forestgreen: "228b22",
        fuchsia: "f0f",
        gainsboro: "dcdcdc",
        ghostwhite: "f8f8ff",
        gold: "ffd700",
        goldenrod: "daa520",
        gray: "808080",
        green: "008000",
        greenyellow: "adff2f",
        grey: "808080",
        honeydew: "f0fff0",
        hotpink: "ff69b4",
        indianred: "cd5c5c",
        indigo: "4b0082",
        ivory: "fffff0",
        khaki: "f0e68c",
        lavender: "e6e6fa",
        lavenderblush: "fff0f5",
        lawngreen: "7cfc00",
        lemonchiffon: "fffacd",
        lightblue: "add8e6",
        lightcoral: "f08080",
        lightcyan: "e0ffff",
        lightgoldenrodyellow: "fafad2",
        lightgray: "d3d3d3",
        lightgreen: "90ee90",
        lightgrey: "d3d3d3",
        lightpink: "ffb6c1",
        lightsalmon: "ffa07a",
        lightseagreen: "20b2aa",
        lightskyblue: "87cefa",
        lightslategray: "789",
        lightslategrey: "789",
        lightsteelblue: "b0c4de",
        lightyellow: "ffffe0",
        lime: "0f0",
        limegreen: "32cd32",
        linen: "faf0e6",
        magenta: "f0f",
        maroon: "800000",
        mediumaquamarine: "66cdaa",
        mediumblue: "0000cd",
        mediumorchid: "ba55d3",
        mediumpurple: "9370db",
        mediumseagreen: "3cb371",
        mediumslateblue: "7b68ee",
        mediumspringgreen: "00fa9a",
        mediumturquoise: "48d1cc",
        mediumvioletred: "c71585",
        midnightblue: "191970",
        mintcream: "f5fffa",
        mistyrose: "ffe4e1",
        moccasin: "ffe4b5",
        navajowhite: "ffdead",
        navy: "000080",
        oldlace: "fdf5e6",
        olive: "808000",
        olivedrab: "6b8e23",
        orange: "ffa500",
        orangered: "ff4500",
        orchid: "da70d6",
        palegoldenrod: "eee8aa",
        palegreen: "98fb98",
        paleturquoise: "afeeee",
        palevioletred: "db7093",
        papayawhip: "ffefd5",
        peachpuff: "ffdab9",
        peru: "cd853f",
        pink: "ffc0cb",
        plum: "dda0dd",
        powderblue: "b0e0e6",
        purple: "800080",
        rebeccapurple: "663399",
        red: "f00",
        rosybrown: "bc8f8f",
        royalblue: "4169e1",
        saddlebrown: "8b4513",
        salmon: "fa8072",
        sandybrown: "f4a460",
        seagreen: "2e8b57",
        seashell: "fff5ee",
        sienna: "a0522d",
        silver: "c0c0c0",
        skyblue: "87ceeb",
        slateblue: "6a5acd",
        slategray: "708090",
        slategrey: "708090",
        snow: "fffafa",
        springgreen: "00ff7f",
        steelblue: "4682b4",
        tan: "d2b48c",
        teal: "008080",
        thistle: "d8bfd8",
        tomato: "ff6347",
        turquoise: "40e0d0",
        violet: "ee82ee",
        wheat: "f5deb3",
        white: "fff",
        whitesmoke: "f5f5f5",
        yellow: "ff0",
        yellowgreen: "9acd32"
    };

    // Make it easy to access colors via `hexNames[hex]`
    var hexNames = tinycolor.hexNames = flip(names);


    // Utilities
    // ---------

    // `{ 'name1': 'val1' }` becomes `{ 'val1': 'name1' }`
    function flip(o) {
        var flipped = { };
        for (var i in o) {
            if (o.hasOwnProperty(i)) {
                flipped[o[i]] = i;
            }
        }
        return flipped;
    }

    // Return a valid alpha value [0,1] with all invalid values being set to 1
    function boundAlpha(a) {
        a = parseFloat(a);

        if (isNaN(a) || a < 0 || a > 1) {
            a = 1;
        }

        return a;
    }

    // Take input from [0, n] and return it as [0, 1]
    function bound01(n, max) {
        if (isOnePointZero(n)) { n = "100%"; }

        var processPercent = isPercentage(n);
        n = mathMin(max, mathMax(0, parseFloat(n)));

        // Automatically convert percentage into number
        if (processPercent) {
            n = parseInt(n * max, 10) / 100;
        }

        // Handle floating point rounding errors
        if ((math.abs(n - max) < 0.000001)) {
            return 1;
        }

        // Convert into [0, 1] range if it isn't already
        return (n % max) / parseFloat(max);
    }

    // Force a number between 0 and 1
    function clamp01(val) {
        return mathMin(1, mathMax(0, val));
    }

    // Parse a base-16 hex value into a base-10 integer
    function parseIntFromHex(val) {
        return parseInt(val, 16);
    }

    // Need to handle 1.0 as 100%, since once it is a number, there is no difference between it and 1
    // <http://stackoverflow.com/questions/7422072/javascript-how-to-detect-number-as-a-decimal-including-1-0>
    function isOnePointZero(n) {
        return typeof n == "string" && n.indexOf('.') != -1 && parseFloat(n) === 1;
    }

    // Check to see if string passed in is a percentage
    function isPercentage(n) {
        return typeof n === "string" && n.indexOf('%') != -1;
    }

    // Force a hex value to have 2 characters
    function pad2(c) {
        return c.length == 1 ? '0' + c : '' + c;
    }

    // Replace a decimal with it's percentage value
    function convertToPercentage(n) {
        if (n <= 1) {
            n = (n * 100) + "%";
        }

        return n;
    }

    // Converts a decimal to a hex value
    function convertDecimalToHex(d) {
        return Math.round(parseFloat(d) * 255).toString(16);
    }
    // Converts a hex value to a decimal
    function convertHexToDecimal(h) {
        return (parseIntFromHex(h) / 255);
    }

    var matchers = (function() {

        // <http://www.w3.org/TR/css3-values/#integers>
        var CSS_INTEGER = "[-\\+]?\\d+%?";

        // <http://www.w3.org/TR/css3-values/#number-value>
        var CSS_NUMBER = "[-\\+]?\\d*\\.\\d+%?";

        // Allow positive/negative integer/number.  Don't capture the either/or, just the entire outcome.
        var CSS_UNIT = "(?:" + CSS_NUMBER + ")|(?:" + CSS_INTEGER + ")";

        // Actual matching.
        // Parentheses and commas are optional, but not required.
        // Whitespace can take the place of commas or opening paren
        var PERMISSIVE_MATCH3 = "[\\s|\\(]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")\\s*\\)?";
        var PERMISSIVE_MATCH4 = "[\\s|\\(]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")\\s*\\)?";

        return {
            rgb: new RegExp("rgb" + PERMISSIVE_MATCH3),
            rgba: new RegExp("rgba" + PERMISSIVE_MATCH4),
            hsl: new RegExp("hsl" + PERMISSIVE_MATCH3),
            hsla: new RegExp("hsla" + PERMISSIVE_MATCH4),
            hsv: new RegExp("hsv" + PERMISSIVE_MATCH3),
            hsva: new RegExp("hsva" + PERMISSIVE_MATCH4),
            hex3: /^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,
            hex6: /^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,
            hex8: /^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/
        };
    })();

    // `stringInputToObject`
    // Permissive string parsing.  Take in a number of formats, and output an object
    // based on detected format.  Returns `{ r, g, b }` or `{ h, s, l }` or `{ h, s, v}`
    function stringInputToObject(color) {

        color = color.replace(trimLeft,'').replace(trimRight, '').toLowerCase();
        var named = false;
        if (names[color]) {
            color = names[color];
            named = true;
        }
        else if (color == 'transparent') {
            return { r: 0, g: 0, b: 0, a: 0, format: "name" };
        }

        // Try to match string input using regular expressions.
        // Keep most of the number bounding out of this function - don't worry about [0,1] or [0,100] or [0,360]
        // Just return an object and let the conversion functions handle that.
        // This way the result will be the same whether the tinycolor is initialized with string or object.
        var match;
        if ((match = matchers.rgb.exec(color))) {
            return { r: match[1], g: match[2], b: match[3] };
        }
        if ((match = matchers.rgba.exec(color))) {
            return { r: match[1], g: match[2], b: match[3], a: match[4] };
        }
        if ((match = matchers.hsl.exec(color))) {
            return { h: match[1], s: match[2], l: match[3] };
        }
        if ((match = matchers.hsla.exec(color))) {
            return { h: match[1], s: match[2], l: match[3], a: match[4] };
        }
        if ((match = matchers.hsv.exec(color))) {
            return { h: match[1], s: match[2], v: match[3] };
        }
        if ((match = matchers.hsva.exec(color))) {
            return { h: match[1], s: match[2], v: match[3], a: match[4] };
        }
        if ((match = matchers.hex8.exec(color))) {
            return {
                a: convertHexToDecimal(match[1]),
                r: parseIntFromHex(match[2]),
                g: parseIntFromHex(match[3]),
                b: parseIntFromHex(match[4]),
                format: named ? "name" : "hex8"
            };
        }
        if ((match = matchers.hex6.exec(color))) {
            return {
                r: parseIntFromHex(match[1]),
                g: parseIntFromHex(match[2]),
                b: parseIntFromHex(match[3]),
                format: named ? "name" : "hex"
            };
        }
        if ((match = matchers.hex3.exec(color))) {
            return {
                r: parseIntFromHex(match[1] + '' + match[1]),
                g: parseIntFromHex(match[2] + '' + match[2]),
                b: parseIntFromHex(match[3] + '' + match[3]),
                format: named ? "name" : "hex"
            };
        }

        return false;
    }

    window.tinycolor = tinycolor;
    })();


    $(function () {
        if ($.fn.spectrum.load) {
            $.fn.spectrum.processNativeColorInputs();
        }
    });

});

/*! Hammer.JS - v2.0.4 - 2014-09-28
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2014 Jorik Tangelder;
 * Licensed under the MIT license */
!function(a,b,c,d){"use strict";function e(a,b,c){return setTimeout(k(a,c),b)}function f(a,b,c){return Array.isArray(a)?(g(a,c[b],c),!0):!1}function g(a,b,c){var e;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==d)for(e=0;e<a.length;)b.call(c,a[e],e,a),e++;else for(e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e,a)}function h(a,b,c){for(var e=Object.keys(b),f=0;f<e.length;)(!c||c&&a[e[f]]===d)&&(a[e[f]]=b[e[f]]),f++;return a}function i(a,b){return h(a,b,!0)}function j(a,b,c){var d,e=b.prototype;d=a.prototype=Object.create(e),d.constructor=a,d._super=e,c&&h(d,c)}function k(a,b){return function(){return a.apply(b,arguments)}}function l(a,b){return typeof a==kb?a.apply(b?b[0]||d:d,b):a}function m(a,b){return a===d?b:a}function n(a,b,c){g(r(b),function(b){a.addEventListener(b,c,!1)})}function o(a,b,c){g(r(b),function(b){a.removeEventListener(b,c,!1)})}function p(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function q(a,b){return a.indexOf(b)>-1}function r(a){return a.trim().split(/\s+/g)}function s(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var d=0;d<a.length;){if(c&&a[d][c]==b||!c&&a[d]===b)return d;d++}return-1}function t(a){return Array.prototype.slice.call(a,0)}function u(a,b,c){for(var d=[],e=[],f=0;f<a.length;){var g=b?a[f][b]:a[f];s(e,g)<0&&d.push(a[f]),e[f]=g,f++}return c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort()),d}function v(a,b){for(var c,e,f=b[0].toUpperCase()+b.slice(1),g=0;g<ib.length;){if(c=ib[g],e=c?c+f:b,e in a)return e;g++}return d}function w(){return ob++}function x(a){var b=a.ownerDocument;return b.defaultView||b.parentWindow}function y(a,b){var c=this;this.manager=a,this.callback=b,this.element=a.element,this.target=a.options.inputTarget,this.domHandler=function(b){l(a.options.enable,[a])&&c.handler(b)},this.init()}function z(a){var b,c=a.options.inputClass;return new(b=c?c:rb?N:sb?Q:qb?S:M)(a,A)}function A(a,b,c){var d=c.pointers.length,e=c.changedPointers.length,f=b&yb&&d-e===0,g=b&(Ab|Bb)&&d-e===0;c.isFirst=!!f,c.isFinal=!!g,f&&(a.session={}),c.eventType=b,B(a,c),a.emit("hammer.input",c),a.recognize(c),a.session.prevInput=c}function B(a,b){var c=a.session,d=b.pointers,e=d.length;c.firstInput||(c.firstInput=E(b)),e>1&&!c.firstMultiple?c.firstMultiple=E(b):1===e&&(c.firstMultiple=!1);var f=c.firstInput,g=c.firstMultiple,h=g?g.center:f.center,i=b.center=F(d);b.timeStamp=nb(),b.deltaTime=b.timeStamp-f.timeStamp,b.angle=J(h,i),b.distance=I(h,i),C(c,b),b.offsetDirection=H(b.deltaX,b.deltaY),b.scale=g?L(g.pointers,d):1,b.rotation=g?K(g.pointers,d):0,D(c,b);var j=a.element;p(b.srcEvent.target,j)&&(j=b.srcEvent.target),b.target=j}function C(a,b){var c=b.center,d=a.offsetDelta||{},e=a.prevDelta||{},f=a.prevInput||{};(b.eventType===yb||f.eventType===Ab)&&(e=a.prevDelta={x:f.deltaX||0,y:f.deltaY||0},d=a.offsetDelta={x:c.x,y:c.y}),b.deltaX=e.x+(c.x-d.x),b.deltaY=e.y+(c.y-d.y)}function D(a,b){var c,e,f,g,h=a.lastInterval||b,i=b.timeStamp-h.timeStamp;if(b.eventType!=Bb&&(i>xb||h.velocity===d)){var j=h.deltaX-b.deltaX,k=h.deltaY-b.deltaY,l=G(i,j,k);e=l.x,f=l.y,c=mb(l.x)>mb(l.y)?l.x:l.y,g=H(j,k),a.lastInterval=b}else c=h.velocity,e=h.velocityX,f=h.velocityY,g=h.direction;b.velocity=c,b.velocityX=e,b.velocityY=f,b.direction=g}function E(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:lb(a.pointers[c].clientX),clientY:lb(a.pointers[c].clientY)},c++;return{timeStamp:nb(),pointers:b,center:F(b),deltaX:a.deltaX,deltaY:a.deltaY}}function F(a){var b=a.length;if(1===b)return{x:lb(a[0].clientX),y:lb(a[0].clientY)};for(var c=0,d=0,e=0;b>e;)c+=a[e].clientX,d+=a[e].clientY,e++;return{x:lb(c/b),y:lb(d/b)}}function G(a,b,c){return{x:b/a||0,y:c/a||0}}function H(a,b){return a===b?Cb:mb(a)>=mb(b)?a>0?Db:Eb:b>0?Fb:Gb}function I(a,b,c){c||(c=Kb);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.sqrt(d*d+e*e)}function J(a,b,c){c||(c=Kb);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return 180*Math.atan2(e,d)/Math.PI}function K(a,b){return J(b[1],b[0],Lb)-J(a[1],a[0],Lb)}function L(a,b){return I(b[0],b[1],Lb)/I(a[0],a[1],Lb)}function M(){this.evEl=Nb,this.evWin=Ob,this.allow=!0,this.pressed=!1,y.apply(this,arguments)}function N(){this.evEl=Rb,this.evWin=Sb,y.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function O(){this.evTarget=Ub,this.evWin=Vb,this.started=!1,y.apply(this,arguments)}function P(a,b){var c=t(a.touches),d=t(a.changedTouches);return b&(Ab|Bb)&&(c=u(c.concat(d),"identifier",!0)),[c,d]}function Q(){this.evTarget=Xb,this.targetIds={},y.apply(this,arguments)}function R(a,b){var c=t(a.touches),d=this.targetIds;if(b&(yb|zb)&&1===c.length)return d[c[0].identifier]=!0,[c,c];var e,f,g=t(a.changedTouches),h=[],i=this.target;if(f=c.filter(function(a){return p(a.target,i)}),b===yb)for(e=0;e<f.length;)d[f[e].identifier]=!0,e++;for(e=0;e<g.length;)d[g[e].identifier]&&h.push(g[e]),b&(Ab|Bb)&&delete d[g[e].identifier],e++;return h.length?[u(f.concat(h),"identifier",!0),h]:void 0}function S(){y.apply(this,arguments);var a=k(this.handler,this);this.touch=new Q(this.manager,a),this.mouse=new M(this.manager,a)}function T(a,b){this.manager=a,this.set(b)}function U(a){if(q(a,bc))return bc;var b=q(a,cc),c=q(a,dc);return b&&c?cc+" "+dc:b||c?b?cc:dc:q(a,ac)?ac:_b}function V(a){this.id=w(),this.manager=null,this.options=i(a||{},this.defaults),this.options.enable=m(this.options.enable,!0),this.state=ec,this.simultaneous={},this.requireFail=[]}function W(a){return a&jc?"cancel":a&hc?"end":a&gc?"move":a&fc?"start":""}function X(a){return a==Gb?"down":a==Fb?"up":a==Db?"left":a==Eb?"right":""}function Y(a,b){var c=b.manager;return c?c.get(a):a}function Z(){V.apply(this,arguments)}function $(){Z.apply(this,arguments),this.pX=null,this.pY=null}function _(){Z.apply(this,arguments)}function ab(){V.apply(this,arguments),this._timer=null,this._input=null}function bb(){Z.apply(this,arguments)}function cb(){Z.apply(this,arguments)}function db(){V.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function eb(a,b){return b=b||{},b.recognizers=m(b.recognizers,eb.defaults.preset),new fb(a,b)}function fb(a,b){b=b||{},this.options=i(b,eb.defaults),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.element=a,this.input=z(this),this.touchAction=new T(this,this.options.touchAction),gb(this,!0),g(b.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]),a[3]&&b.requireFailure(a[3])},this)}function gb(a,b){var c=a.element;g(a.options.cssProps,function(a,d){c.style[v(c.style,d)]=b?a:""})}function hb(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0),d.gesture=c,c.target.dispatchEvent(d)}var ib=["","webkit","moz","MS","ms","o"],jb=b.createElement("div"),kb="function",lb=Math.round,mb=Math.abs,nb=Date.now,ob=1,pb=/mobile|tablet|ip(ad|hone|od)|android/i,qb="ontouchstart"in a,rb=v(a,"PointerEvent")!==d,sb=qb&&pb.test(navigator.userAgent),tb="touch",ub="pen",vb="mouse",wb="kinect",xb=25,yb=1,zb=2,Ab=4,Bb=8,Cb=1,Db=2,Eb=4,Fb=8,Gb=16,Hb=Db|Eb,Ib=Fb|Gb,Jb=Hb|Ib,Kb=["x","y"],Lb=["clientX","clientY"];y.prototype={handler:function(){},init:function(){this.evEl&&n(this.element,this.evEl,this.domHandler),this.evTarget&&n(this.target,this.evTarget,this.domHandler),this.evWin&&n(x(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&o(this.element,this.evEl,this.domHandler),this.evTarget&&o(this.target,this.evTarget,this.domHandler),this.evWin&&o(x(this.element),this.evWin,this.domHandler)}};var Mb={mousedown:yb,mousemove:zb,mouseup:Ab},Nb="mousedown",Ob="mousemove mouseup";j(M,y,{handler:function(a){var b=Mb[a.type];b&yb&&0===a.button&&(this.pressed=!0),b&zb&&1!==a.which&&(b=Ab),this.pressed&&this.allow&&(b&Ab&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:vb,srcEvent:a}))}});var Pb={pointerdown:yb,pointermove:zb,pointerup:Ab,pointercancel:Bb,pointerout:Bb},Qb={2:tb,3:ub,4:vb,5:wb},Rb="pointerdown",Sb="pointermove pointerup pointercancel";a.MSPointerEvent&&(Rb="MSPointerDown",Sb="MSPointerMove MSPointerUp MSPointerCancel"),j(N,y,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace("ms",""),e=Pb[d],f=Qb[a.pointerType]||a.pointerType,g=f==tb,h=s(b,a.pointerId,"pointerId");e&yb&&(0===a.button||g)?0>h&&(b.push(a),h=b.length-1):e&(Ab|Bb)&&(c=!0),0>h||(b[h]=a,this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(h,1))}});var Tb={touchstart:yb,touchmove:zb,touchend:Ab,touchcancel:Bb},Ub="touchstart",Vb="touchstart touchmove touchend touchcancel";j(O,y,{handler:function(a){var b=Tb[a.type];if(b===yb&&(this.started=!0),this.started){var c=P.call(this,a,b);b&(Ab|Bb)&&c[0].length-c[1].length===0&&(this.started=!1),this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:tb,srcEvent:a})}}});var Wb={touchstart:yb,touchmove:zb,touchend:Ab,touchcancel:Bb},Xb="touchstart touchmove touchend touchcancel";j(Q,y,{handler:function(a){var b=Wb[a.type],c=R.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:tb,srcEvent:a})}}),j(S,y,{handler:function(a,b,c){var d=c.pointerType==tb,e=c.pointerType==vb;if(d)this.mouse.allow=!1;else if(e&&!this.mouse.allow)return;b&(Ab|Bb)&&(this.mouse.allow=!0),this.callback(a,b,c)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Yb=v(jb.style,"touchAction"),Zb=Yb!==d,$b="compute",_b="auto",ac="manipulation",bc="none",cc="pan-x",dc="pan-y";T.prototype={set:function(a){a==$b&&(a=this.compute()),Zb&&(this.manager.element.style[Yb]=a),this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return g(this.manager.recognizers,function(b){l(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))}),U(a.join(" "))},preventDefaults:function(a){if(!Zb){var b=a.srcEvent,c=a.offsetDirection;if(this.manager.session.prevented)return void b.preventDefault();var d=this.actions,e=q(d,bc),f=q(d,dc),g=q(d,cc);return e||f&&c&Hb||g&&c&Ib?this.preventSrc(b):void 0}},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault()}};var ec=1,fc=2,gc=4,hc=8,ic=hc,jc=16,kc=32;V.prototype={defaults:{},set:function(a){return h(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(f(a,"recognizeWith",this))return this;var b=this.simultaneous;return a=Y(a,this),b[a.id]||(b[a.id]=a,a.recognizeWith(this)),this},dropRecognizeWith:function(a){return f(a,"dropRecognizeWith",this)?this:(a=Y(a,this),delete this.simultaneous[a.id],this)},requireFailure:function(a){if(f(a,"requireFailure",this))return this;var b=this.requireFail;return a=Y(a,this),-1===s(b,a)&&(b.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(f(a,"dropRequireFailure",this))return this;a=Y(a,this);var b=s(this.requireFail,a);return b>-1&&this.requireFail.splice(b,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(b){c.manager.emit(c.options.event+(b?W(d):""),a)}var c=this,d=this.state;hc>d&&b(!0),b(),d>=hc&&b(!0)},tryEmit:function(a){return this.canEmit()?this.emit(a):void(this.state=kc)},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(kc|ec)))return!1;a++}return!0},recognize:function(a){var b=h({},a);return l(this.options.enable,[this,b])?(this.state&(ic|jc|kc)&&(this.state=ec),this.state=this.process(b),void(this.state&(fc|gc|hc|jc)&&this.tryEmit(b))):(this.reset(),void(this.state=kc))},process:function(){},getTouchAction:function(){},reset:function(){}},j(Z,V,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,d=b&(fc|gc),e=this.attrTest(a);return d&&(c&Bb||!e)?b|jc:d||e?c&Ab?b|hc:b&fc?b|gc:fc:kc}}),j($,Z,{defaults:{event:"pan",threshold:10,pointers:1,direction:Jb},getTouchAction:function(){var a=this.options.direction,b=[];return a&Hb&&b.push(dc),a&Ib&&b.push(cc),b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,e=a.direction,f=a.deltaX,g=a.deltaY;return e&b.direction||(b.direction&Hb?(e=0===f?Cb:0>f?Db:Eb,c=f!=this.pX,d=Math.abs(a.deltaX)):(e=0===g?Cb:0>g?Fb:Gb,c=g!=this.pY,d=Math.abs(a.deltaY))),a.direction=e,c&&d>b.threshold&&e&b.direction},attrTest:function(a){return Z.prototype.attrTest.call(this,a)&&(this.state&fc||!(this.state&fc)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var b=X(a.direction);b&&this.manager.emit(this.options.event+b,a),this._super.emit.call(this,a)}}),j(_,Z,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[bc]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&fc)},emit:function(a){if(this._super.emit.call(this,a),1!==a.scale){var b=a.scale<1?"in":"out";this.manager.emit(this.options.event+b,a)}}}),j(ab,V,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[_b]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime>b.time;if(this._input=a,!d||!c||a.eventType&(Ab|Bb)&&!f)this.reset();else if(a.eventType&yb)this.reset(),this._timer=e(function(){this.state=ic,this.tryEmit()},b.time,this);else if(a.eventType&Ab)return ic;return kc},reset:function(){clearTimeout(this._timer)},emit:function(a){this.state===ic&&(a&&a.eventType&Ab?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=nb(),this.manager.emit(this.options.event,this._input)))}}),j(bb,Z,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[bc]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&fc)}}),j(cb,Z,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:Hb|Ib,pointers:1},getTouchAction:function(){return $.prototype.getTouchAction.call(this)},attrTest:function(a){var b,c=this.options.direction;return c&(Hb|Ib)?b=a.velocity:c&Hb?b=a.velocityX:c&Ib&&(b=a.velocityY),this._super.attrTest.call(this,a)&&c&a.direction&&a.distance>this.options.threshold&&mb(b)>this.options.velocity&&a.eventType&Ab},emit:function(a){var b=X(a.direction);b&&this.manager.emit(this.options.event+b,a),this.manager.emit(this.options.event,a)}}),j(db,V,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[ac]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime<b.time;if(this.reset(),a.eventType&yb&&0===this.count)return this.failTimeout();if(d&&f&&c){if(a.eventType!=Ab)return this.failTimeout();var g=this.pTime?a.timeStamp-this.pTime<b.interval:!0,h=!this.pCenter||I(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp,this.pCenter=a.center,h&&g?this.count+=1:this.count=1,this._input=a;var i=this.count%b.taps;if(0===i)return this.hasRequireFailures()?(this._timer=e(function(){this.state=ic,this.tryEmit()},b.interval,this),fc):ic}return kc},failTimeout:function(){return this._timer=e(function(){this.state=kc},this.options.interval,this),kc},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ic&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),eb.VERSION="2.0.4",eb.defaults={domEvents:!1,touchAction:$b,enable:!0,inputTarget:null,inputClass:null,preset:[[bb,{enable:!1}],[_,{enable:!1},["rotate"]],[cb,{direction:Hb}],[$,{direction:Hb},["swipe"]],[db],[db,{event:"doubletap",taps:2},["tap"]],[ab]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var lc=1,mc=2;fb.prototype={set:function(a){return h(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=a?mc:lc},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,e=b.curRecognizer;(!e||e&&e.state&ic)&&(e=b.curRecognizer=null);for(var f=0;f<d.length;)c=d[f],b.stopped===mc||e&&c!=e&&!c.canRecognizeWith(e)?c.reset():c.recognize(a),!e&&c.state&(fc|gc|hc)&&(e=b.curRecognizer=c),f++}},get:function(a){if(a instanceof V)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(f(a,"add",this))return this;var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a},remove:function(a){if(f(a,"remove",this))return this;var b=this.recognizers;return a=this.get(a),b.splice(s(b,a),1),this.touchAction.update(),this},on:function(a,b){var c=this.handlers;return g(r(a),function(a){c[a]=c[a]||[],c[a].push(b)}),this},off:function(a,b){var c=this.handlers;return g(r(a),function(a){b?c[a].splice(s(c[a],b),1):delete c[a]}),this},emit:function(a,b){this.options.domEvents&&hb(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a,b.preventDefault=function(){b.srcEvent.preventDefault()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&gb(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},h(eb,{INPUT_START:yb,INPUT_MOVE:zb,INPUT_END:Ab,INPUT_CANCEL:Bb,STATE_POSSIBLE:ec,STATE_BEGAN:fc,STATE_CHANGED:gc,STATE_ENDED:hc,STATE_RECOGNIZED:ic,STATE_CANCELLED:jc,STATE_FAILED:kc,DIRECTION_NONE:Cb,DIRECTION_LEFT:Db,DIRECTION_RIGHT:Eb,DIRECTION_UP:Fb,DIRECTION_DOWN:Gb,DIRECTION_HORIZONTAL:Hb,DIRECTION_VERTICAL:Ib,DIRECTION_ALL:Jb,Manager:fb,Input:y,TouchAction:T,TouchInput:Q,MouseInput:M,PointerEventInput:N,TouchMouseInput:S,SingleTouchInput:O,Recognizer:V,AttrRecognizer:Z,Tap:db,Pan:$,Swipe:cb,Pinch:_,Rotate:bb,Press:ab,on:n,off:o,each:g,merge:i,extend:h,inherit:j,bindFn:k,prefixed:v}),typeof define==kb&&define.amd?define(function(){return eb}):"undefined"!=typeof module&&module.exports?module.exports=eb:a[c]=eb}(window,document,"Hammer");
//# sourceMappingURL=hammer.min.map
/* == jquery mousewheel plugin == Version: 3.1.12, License: MIT License (MIT) */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(m=-1*g.detail),"wheelDelta"in g&&(m=g.wheelDelta),"wheelDeltaY"in g&&(m=g.wheelDeltaY),"wheelDeltaX"in g&&(l=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,"deltaY"in g&&(m=-1*g.deltaY,j=m),"deltaX"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,"mousewheel-line-height");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,"mousewheel-page-height");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?"floor":"ceil"](j/f),l=Math[l>=1?"floor":"ceil"](l/f),m=Math[m>=1?"floor":"ceil"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&"mousewheel"===a.type&&b%120===0}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,"mousewheel-line-height"),a.removeData(this,"mousewheel-page-height")},getLineHeight:function(b){var c=a(b),d=c["offsetParent"in a.fn?"offsetParent":"parent"]();return d.length||(d=a("body")),parseInt(d.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})});
/* == malihu jquery custom scrollbar plugin == Version: 3.0.7, License: MIT License (MIT) */
!function(e,t,a){!function(t){var o="function"==typeof define&&define.amd,n="https:"==a.location.protocol?"https:":"http:",i="cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.12/jquery.mousewheel.min.js";o||e.event.special.mousewheel||e("head").append(decodeURI("%3Cscript src="+n+"//"+i+"%3E%3C/script%3E")),t()}(function(){var o,n="mCustomScrollbar",i="mCS",r=".mCustomScrollbar",l={setTop:0,setLeft:0,axis:"y",scrollbarPosition:"inside",scrollInertia:950,autoDraggerLength:!0,alwaysShowScrollbar:0,snapOffset:0,mouseWheel:{enable:!0,scrollAmount:"auto",axis:"y",deltaFactor:"auto",disableOver:["select","option","keygen","datalist","textarea"]},scrollButtons:{scrollType:"stepless",scrollAmount:"auto"},keyboard:{enable:!0,scrollType:"stepless",scrollAmount:"auto"},contentTouchScroll:25,advanced:{autoScrollOnFocus:"input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']",updateOnContentResize:!0,updateOnImageLoad:!0},theme:"light",callbacks:{onTotalScrollOffset:0,onTotalScrollBackOffset:0,alwaysTriggerOffsets:!0}},s=0,c={},d=t.attachEvent&&!t.addEventListener?1:0,u=!1,f=["mCSB_dragger_onDrag","mCSB_scrollTools_onDrag","mCS_img_loaded","mCS_disabled","mCS_destroyed","mCS_no_scrollbar","mCS-autoHide","mCS-dir-rtl","mCS_no_scrollbar_y","mCS_no_scrollbar_x","mCS_y_hidden","mCS_x_hidden","mCSB_draggerContainer","mCSB_buttonUp","mCSB_buttonDown","mCSB_buttonLeft","mCSB_buttonRight"],h={init:function(t){var t=e.extend(!0,{},l,t),a=m.call(this);if(t.live){var o=t.liveSelector||this.selector||r,n=e(o);if("off"===t.live)return void g(o);c[o]=setTimeout(function(){n.mCustomScrollbar(t),"once"===t.live&&n.length&&g(o)},500)}else g(o);return t.setWidth=t.set_width?t.set_width:t.setWidth,t.setHeight=t.set_height?t.set_height:t.setHeight,t.axis=t.horizontalScroll?"x":v(t.axis),t.scrollInertia=t.scrollInertia>0&&t.scrollInertia<17?17:t.scrollInertia,"object"!=typeof t.mouseWheel&&1==t.mouseWheel&&(t.mouseWheel={enable:!0,scrollAmount:"auto",axis:"y",preventDefault:!1,deltaFactor:"auto",normalizeDelta:!1,invert:!1}),t.mouseWheel.scrollAmount=t.mouseWheelPixels?t.mouseWheelPixels:t.mouseWheel.scrollAmount,t.mouseWheel.normalizeDelta=t.advanced.normalizeMouseWheelDelta?t.advanced.normalizeMouseWheelDelta:t.mouseWheel.normalizeDelta,t.scrollButtons.scrollType=x(t.scrollButtons.scrollType),p(t),e(a).each(function(){var a=e(this);if(!a.data(i)){a.data(i,{idx:++s,opt:t,scrollRatio:{y:null,x:null},overflowed:null,contentReset:{y:null,x:null},bindEvents:!1,tweenRunning:!1,sequential:{},langDir:a.css("direction"),cbOffsets:null,trigger:null});var o=a.data(i),n=o.opt,r=a.data("mcs-axis"),l=a.data("mcs-scrollbar-position"),c=a.data("mcs-theme");r&&(n.axis=r),l&&(n.scrollbarPosition=l),c&&(n.theme=c,p(n)),_.call(this),e("#mCSB_"+o.idx+"_container img:not(."+f[2]+")").addClass(f[2]),h.update.call(null,a)}})},update:function(t,a){var o=t||m.call(this);return e(o).each(function(){var t=e(this);if(t.data(i)){var o=t.data(i),n=o.opt,r=e("#mCSB_"+o.idx+"_container"),l=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")];if(!r.length)return;o.tweenRunning&&Q(t),t.hasClass(f[3])&&t.removeClass(f[3]),t.hasClass(f[4])&&t.removeClass(f[4]),C.call(this),w.call(this),"y"===n.axis||n.advanced.autoExpandHorizontalScroll||r.css("width",S(r.children())),o.overflowed=k.call(this),R.call(this),n.autoDraggerLength&&y.call(this),B.call(this),O.call(this);var s=[Math.abs(r[0].offsetTop),Math.abs(r[0].offsetLeft)];"x"!==n.axis&&(o.overflowed[0]?l[0].height()>l[0].parent().height()?M.call(this):(G(t,s[0].toString(),{dir:"y",dur:0,overwrite:"none"}),o.contentReset.y=null):(M.call(this),"y"===n.axis?I.call(this):"yx"===n.axis&&o.overflowed[1]&&G(t,s[1].toString(),{dir:"x",dur:0,overwrite:"none"}))),"y"!==n.axis&&(o.overflowed[1]?l[1].width()>l[1].parent().width()?M.call(this):(G(t,s[1].toString(),{dir:"x",dur:0,overwrite:"none"}),o.contentReset.x=null):(M.call(this),"x"===n.axis?I.call(this):"yx"===n.axis&&o.overflowed[0]&&G(t,s[0].toString(),{dir:"y",dur:0,overwrite:"none"}))),a&&o&&(2===a&&n.callbacks.onImageLoad&&"function"==typeof n.callbacks.onImageLoad?n.callbacks.onImageLoad.call(this):3===a&&n.callbacks.onSelectorChange&&"function"==typeof n.callbacks.onSelectorChange?n.callbacks.onSelectorChange.call(this):n.callbacks.onUpdate&&"function"==typeof n.callbacks.onUpdate&&n.callbacks.onUpdate.call(this)),N.call(this)}})},scrollTo:function(t,a){if("undefined"!=typeof t&&null!=t){var o=m.call(this);return e(o).each(function(){var o=e(this);if(o.data(i)){var n=o.data(i),r=n.opt,l={trigger:"external",scrollInertia:r.scrollInertia,scrollEasing:"mcsEaseInOut",moveDragger:!1,timeout:60,callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},s=e.extend(!0,{},l,a),c=Y.call(this,t),d=s.scrollInertia>0&&s.scrollInertia<17?17:s.scrollInertia;c[0]=X.call(this,c[0],"y"),c[1]=X.call(this,c[1],"x"),s.moveDragger&&(c[0]*=n.scrollRatio.y,c[1]*=n.scrollRatio.x),s.dur=d,setTimeout(function(){null!==c[0]&&"undefined"!=typeof c[0]&&"x"!==r.axis&&n.overflowed[0]&&(s.dir="y",s.overwrite="all",G(o,c[0].toString(),s)),null!==c[1]&&"undefined"!=typeof c[1]&&"y"!==r.axis&&n.overflowed[1]&&(s.dir="x",s.overwrite="none",G(o,c[1].toString(),s))},s.timeout)}})}},stop:function(){var t=m.call(this);return e(t).each(function(){var t=e(this);t.data(i)&&Q(t)})},disable:function(t){var a=m.call(this);return e(a).each(function(){var a=e(this);if(a.data(i)){{a.data(i)}N.call(this,"remove"),I.call(this),t&&M.call(this),R.call(this,!0),a.addClass(f[3])}})},destroy:function(){var t=m.call(this);return e(t).each(function(){var a=e(this);if(a.data(i)){var o=a.data(i),r=o.opt,l=e("#mCSB_"+o.idx),s=e("#mCSB_"+o.idx+"_container"),c=e(".mCSB_"+o.idx+"_scrollbar");r.live&&g(r.liveSelector||e(t).selector),N.call(this,"remove"),I.call(this),M.call(this),a.removeData(i),$(this,"mcs"),c.remove(),s.find("img."+f[2]).removeClass(f[2]),l.replaceWith(s.contents()),a.removeClass(n+" _"+i+"_"+o.idx+" "+f[6]+" "+f[7]+" "+f[5]+" "+f[3]).addClass(f[4])}})}},m=function(){return"object"!=typeof e(this)||e(this).length<1?r:this},p=function(t){var a=["rounded","rounded-dark","rounded-dots","rounded-dots-dark"],o=["rounded-dots","rounded-dots-dark","3d","3d-dark","3d-thick","3d-thick-dark","inset","inset-dark","inset-2","inset-2-dark","inset-3","inset-3-dark"],n=["minimal","minimal-dark"],i=["minimal","minimal-dark"],r=["minimal","minimal-dark"];t.autoDraggerLength=e.inArray(t.theme,a)>-1?!1:t.autoDraggerLength,t.autoExpandScrollbar=e.inArray(t.theme,o)>-1?!1:t.autoExpandScrollbar,t.scrollButtons.enable=e.inArray(t.theme,n)>-1?!1:t.scrollButtons.enable,t.autoHideScrollbar=e.inArray(t.theme,i)>-1?!0:t.autoHideScrollbar,t.scrollbarPosition=e.inArray(t.theme,r)>-1?"outside":t.scrollbarPosition},g=function(e){c[e]&&(clearTimeout(c[e]),$(c,e))},v=function(e){return"yx"===e||"xy"===e||"auto"===e?"yx":"x"===e||"horizontal"===e?"x":"y"},x=function(e){return"stepped"===e||"pixels"===e||"step"===e||"click"===e?"stepped":"stepless"},_=function(){var t=e(this),a=t.data(i),o=a.opt,r=o.autoExpandScrollbar?" "+f[1]+"_expand":"",l=["<div id='mCSB_"+a.idx+"_scrollbar_vertical' class='mCSB_scrollTools mCSB_"+a.idx+"_scrollbar mCS-"+o.theme+" mCSB_scrollTools_vertical"+r+"'><div class='"+f[12]+"'><div id='mCSB_"+a.idx+"_dragger_vertical' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>","<div id='mCSB_"+a.idx+"_scrollbar_horizontal' class='mCSB_scrollTools mCSB_"+a.idx+"_scrollbar mCS-"+o.theme+" mCSB_scrollTools_horizontal"+r+"'><div class='"+f[12]+"'><div id='mCSB_"+a.idx+"_dragger_horizontal' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>"],s="yx"===o.axis?"mCSB_vertical_horizontal":"x"===o.axis?"mCSB_horizontal":"mCSB_vertical",c="yx"===o.axis?l[0]+l[1]:"x"===o.axis?l[1]:l[0],d="yx"===o.axis?"<div id='mCSB_"+a.idx+"_container_wrapper' class='mCSB_container_wrapper' />":"",u=o.autoHideScrollbar?" "+f[6]:"",h="x"!==o.axis&&"rtl"===a.langDir?" "+f[7]:"";o.setWidth&&t.css("width",o.setWidth),o.setHeight&&t.css("height",o.setHeight),o.setLeft="y"!==o.axis&&"rtl"===a.langDir?"989999px":o.setLeft,t.addClass(n+" _"+i+"_"+a.idx+u+h).wrapInner("<div id='mCSB_"+a.idx+"' class='mCustomScrollBox mCS-"+o.theme+" "+s+"'><div id='mCSB_"+a.idx+"_container' class='mCSB_container' style='position:relative; top:"+o.setTop+"; left:"+o.setLeft+";' dir="+a.langDir+" /></div>");var m=e("#mCSB_"+a.idx),p=e("#mCSB_"+a.idx+"_container");"y"===o.axis||o.advanced.autoExpandHorizontalScroll||p.css("width",S(p.children())),"outside"===o.scrollbarPosition?("static"===t.css("position")&&t.css("position","relative"),t.css("overflow","visible"),m.addClass("mCSB_outside").after(c)):(m.addClass("mCSB_inside").append(c),p.wrap(d)),b.call(this);var g=[e("#mCSB_"+a.idx+"_dragger_vertical"),e("#mCSB_"+a.idx+"_dragger_horizontal")];g[0].css("min-height",g[0].height()),g[1].css("min-width",g[1].width())},S=function(t){return Math.max.apply(Math,t.map(function(){return e(this).outerWidth(!0)}).get())},w=function(){var t=e(this),a=t.data(i),o=a.opt,n=e("#mCSB_"+a.idx+"_container");o.advanced.autoExpandHorizontalScroll&&"y"!==o.axis&&n.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:Math.ceil(n[0].getBoundingClientRect().right+.4)-Math.floor(n[0].getBoundingClientRect().left),position:"relative"}).unwrap()},b=function(){var t=e(this),a=t.data(i),o=a.opt,n=e(".mCSB_"+a.idx+"_scrollbar:first"),r=at(o.scrollButtons.tabindex)?"tabindex='"+o.scrollButtons.tabindex+"'":"",l=["<a href='#' class='"+f[13]+"' oncontextmenu='return false;' "+r+" />","<a href='#' class='"+f[14]+"' oncontextmenu='return false;' "+r+" />","<a href='#' class='"+f[15]+"' oncontextmenu='return false;' "+r+" />","<a href='#' class='"+f[16]+"' oncontextmenu='return false;' "+r+" />"],s=["x"===o.axis?l[2]:l[0],"x"===o.axis?l[3]:l[1],l[2],l[3]];o.scrollButtons.enable&&n.prepend(s[0]).append(s[1]).next(".mCSB_scrollTools").prepend(s[2]).append(s[3])},C=function(){var t=e(this),a=t.data(i),o=e("#mCSB_"+a.idx),n=t.css("max-height")||"none",r=-1!==n.indexOf("%"),l=t.css("box-sizing");if("none"!==n){var s=r?t.parent().height()*parseInt(n)/100:parseInt(n);"border-box"===l&&(s-=t.innerHeight()-t.height()+(t.outerHeight()-t.innerHeight())),o.css("max-height",Math.round(s))}},y=function(){var t=e(this),a=t.data(i),o=e("#mCSB_"+a.idx),n=e("#mCSB_"+a.idx+"_container"),r=[e("#mCSB_"+a.idx+"_dragger_vertical"),e("#mCSB_"+a.idx+"_dragger_horizontal")],l=[o.height()/n.outerHeight(!1),o.width()/n.outerWidth(!1)],s=[parseInt(r[0].css("min-height")),Math.round(l[0]*r[0].parent().height()),parseInt(r[1].css("min-width")),Math.round(l[1]*r[1].parent().width())],c=d&&s[1]<s[0]?s[0]:s[1],u=d&&s[3]<s[2]?s[2]:s[3];r[0].css({height:c,"max-height":r[0].parent().height()-10}).find(".mCSB_dragger_bar").css({"line-height":s[0]+"px"}),r[1].css({width:u,"max-width":r[1].parent().width()-10})},B=function(){var t=e(this),a=t.data(i),o=e("#mCSB_"+a.idx),n=e("#mCSB_"+a.idx+"_container"),r=[e("#mCSB_"+a.idx+"_dragger_vertical"),e("#mCSB_"+a.idx+"_dragger_horizontal")],l=[n.outerHeight(!1)-o.height(),n.outerWidth(!1)-o.width()],s=[l[0]/(r[0].parent().height()-r[0].height()),l[1]/(r[1].parent().width()-r[1].width())];a.scrollRatio={y:s[0],x:s[1]}},T=function(e,t,a){var o=a?f[0]+"_expanded":"",n=e.closest(".mCSB_scrollTools");"active"===t?(e.toggleClass(f[0]+" "+o),n.toggleClass(f[1]),e[0]._draggable=e[0]._draggable?0:1):e[0]._draggable||("hide"===t?(e.removeClass(f[0]),n.removeClass(f[1])):(e.addClass(f[0]),n.addClass(f[1])))},k=function(){var t=e(this),a=t.data(i),o=e("#mCSB_"+a.idx),n=e("#mCSB_"+a.idx+"_container"),r=null==a.overflowed?n.height():n.outerHeight(!1),l=null==a.overflowed?n.width():n.outerWidth(!1);return[r>o.height(),l>o.width()]},M=function(){var t=e(this),a=t.data(i),o=a.opt,n=e("#mCSB_"+a.idx),r=e("#mCSB_"+a.idx+"_container"),l=[e("#mCSB_"+a.idx+"_dragger_vertical"),e("#mCSB_"+a.idx+"_dragger_horizontal")];if(Q(t),("x"!==o.axis&&!a.overflowed[0]||"y"===o.axis&&a.overflowed[0])&&(l[0].add(r).css("top",0),G(t,"_resetY")),"y"!==o.axis&&!a.overflowed[1]||"x"===o.axis&&a.overflowed[1]){var s=dx=0;"rtl"===a.langDir&&(s=n.width()-r.outerWidth(!1),dx=Math.abs(s/a.scrollRatio.x)),r.css("left",s),l[1].css("left",dx),G(t,"_resetX")}},O=function(){function t(){r=setTimeout(function(){e.event.special.mousewheel?(clearTimeout(r),A.call(a[0])):t()},100)}var a=e(this),o=a.data(i),n=o.opt;if(!o.bindEvents){if(D.call(this),n.contentTouchScroll&&L.call(this),W.call(this),n.mouseWheel.enable){var r;t()}z.call(this),U.call(this),n.advanced.autoScrollOnFocus&&H.call(this),n.scrollButtons.enable&&F.call(this),n.keyboard.enable&&q.call(this),o.bindEvents=!0}},I=function(){var t=e(this),o=t.data(i),n=o.opt,r=i+"_"+o.idx,l=".mCSB_"+o.idx+"_scrollbar",s=e("#mCSB_"+o.idx+",#mCSB_"+o.idx+"_container,#mCSB_"+o.idx+"_container_wrapper,"+l+" ."+f[12]+",#mCSB_"+o.idx+"_dragger_vertical,#mCSB_"+o.idx+"_dragger_horizontal,"+l+">a"),c=e("#mCSB_"+o.idx+"_container");n.advanced.releaseDraggableSelectors&&s.add(e(n.advanced.releaseDraggableSelectors)),o.bindEvents&&(e(a).unbind("."+r),s.each(function(){e(this).unbind("."+r)}),clearTimeout(t[0]._focusTimeout),$(t[0],"_focusTimeout"),clearTimeout(o.sequential.step),$(o.sequential,"step"),clearTimeout(c[0].onCompleteTimeout),$(c[0],"onCompleteTimeout"),o.bindEvents=!1)},R=function(t){var a=e(this),o=a.data(i),n=o.opt,r=e("#mCSB_"+o.idx+"_container_wrapper"),l=r.length?r:e("#mCSB_"+o.idx+"_container"),s=[e("#mCSB_"+o.idx+"_scrollbar_vertical"),e("#mCSB_"+o.idx+"_scrollbar_horizontal")],c=[s[0].find(".mCSB_dragger"),s[1].find(".mCSB_dragger")];"x"!==n.axis&&(o.overflowed[0]&&!t?(s[0].add(c[0]).add(s[0].children("a")).css("display","block"),l.removeClass(f[8]+" "+f[10])):(n.alwaysShowScrollbar?(2!==n.alwaysShowScrollbar&&c[0].css("display","none"),l.removeClass(f[10])):(s[0].css("display","none"),l.addClass(f[10])),l.addClass(f[8]))),"y"!==n.axis&&(o.overflowed[1]&&!t?(s[1].add(c[1]).add(s[1].children("a")).css("display","block"),l.removeClass(f[9]+" "+f[11])):(n.alwaysShowScrollbar?(2!==n.alwaysShowScrollbar&&c[1].css("display","none"),l.removeClass(f[11])):(s[1].css("display","none"),l.addClass(f[11])),l.addClass(f[9]))),o.overflowed[0]||o.overflowed[1]?a.removeClass(f[5]):a.addClass(f[5])},E=function(e){var t=e.type;switch(t){case"pointerdown":case"MSPointerDown":case"pointermove":case"MSPointerMove":case"pointerup":case"MSPointerUp":return[e.originalEvent.pageY,e.originalEvent.pageX,!1];case"touchstart":case"touchmove":case"touchend":var a=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],o=e.originalEvent.touches.length||e.originalEvent.changedTouches.length;return[a.pageY,a.pageX,o>1];default:return[e.pageY,e.pageX,!1]}},D=function(){function t(e){var t=p.find("iframe");if(t.length){var a=e?"auto":"none";t.css("pointer-events",a)}}function o(e,t,a,o){if(p[0].idleTimer=f.scrollInertia<233?250:0,n.attr("id")===m[1])var i="x",r=(n[0].offsetLeft-t+o)*c.scrollRatio.x;else var i="y",r=(n[0].offsetTop-e+a)*c.scrollRatio.y;G(s,r.toString(),{dir:i,drag:!0})}var n,r,l,s=e(this),c=s.data(i),f=c.opt,h=i+"_"+c.idx,m=["mCSB_"+c.idx+"_dragger_vertical","mCSB_"+c.idx+"_dragger_horizontal"],p=e("#mCSB_"+c.idx+"_container"),g=e("#"+m[0]+",#"+m[1]),v=f.advanced.releaseDraggableSelectors?g.add(e(f.advanced.releaseDraggableSelectors)):g;g.bind("mousedown."+h+" touchstart."+h+" pointerdown."+h+" MSPointerDown."+h,function(o){if(o.stopImmediatePropagation(),o.preventDefault(),et(o)){u=!0,d&&(a.onselectstart=function(){return!1}),t(!1),Q(s),n=e(this);var i=n.offset(),c=E(o)[0]-i.top,h=E(o)[1]-i.left,m=n.height()+i.top,p=n.width()+i.left;m>c&&c>0&&p>h&&h>0&&(r=c,l=h),T(n,"active",f.autoExpandScrollbar)}}).bind("touchmove."+h,function(e){e.stopImmediatePropagation(),e.preventDefault();var t=n.offset(),a=E(e)[0]-t.top,i=E(e)[1]-t.left;o(r,l,a,i)}),e(a).bind("mousemove."+h+" pointermove."+h+" MSPointerMove."+h,function(e){if(n){var t=n.offset(),a=E(e)[0]-t.top,i=E(e)[1]-t.left;if(r===a)return;o(r,l,a,i)}}).add(v).bind("mouseup."+h+" touchend."+h+" pointerup."+h+" MSPointerUp."+h,function(){n&&(T(n,"active",f.autoExpandScrollbar),n=null),u=!1,d&&(a.onselectstart=null),t(!0)})},L=function(){function t(e,t){var a=[1.5*t,2*t,t/1.5,t/2];return e>90?t>4?a[0]:a[3]:e>60?t>3?a[3]:a[2]:e>30?t>8?a[1]:t>6?a[0]:t>4?t:a[2]:t>8?t:a[3]}function a(e,t,a,o,n,i){e&&G(_,e.toString(),{dur:t,scrollEasing:a,dir:o,overwrite:n,drag:i})}var n,r,l,s,c,d,f,h,m,p,g,v,x,_=e(this),S=_.data(i),w=S.opt,b=i+"_"+S.idx,C=e("#mCSB_"+S.idx),y=e("#mCSB_"+S.idx+"_container"),B=[e("#mCSB_"+S.idx+"_dragger_vertical"),e("#mCSB_"+S.idx+"_dragger_horizontal")],T=[],k=[],M=0,O="yx"===w.axis?"none":"all",I=[];y.bind("touchstart."+b+" pointerdown."+b+" MSPointerDown."+b,function(e){if(!tt(e)||u||E(e)[2])return void(o=0);o=1,v=0,x=0;var t=y.offset();n=E(e)[0]-t.top,r=E(e)[1]-t.left,I=[E(e)[0],E(e)[1]]}).bind("touchmove."+b+" pointermove."+b+" MSPointerMove."+b,function(e){if(tt(e)&&!u&&!E(e)[2]&&(e.stopImmediatePropagation(),!x||v)){d=K();var t=C.offset(),o=E(e)[0]-t.top,i=E(e)[1]-t.left,l="mcsLinearOut";if(T.push(o),k.push(i),I[2]=Math.abs(E(e)[0]-I[0]),I[3]=Math.abs(E(e)[1]-I[1]),S.overflowed[0])var s=B[0].parent().height()-B[0].height(),c=n-o>0&&o-n>-(s*S.scrollRatio.y)&&(2*I[3]<I[2]||"yx"===w.axis);if(S.overflowed[1])var f=B[1].parent().width()-B[1].width(),h=r-i>0&&i-r>-(f*S.scrollRatio.x)&&(2*I[2]<I[3]||"yx"===w.axis);c||h?(e.preventDefault(),v=1):x=1,p="yx"===w.axis?[n-o,r-i]:"x"===w.axis?[null,r-i]:[n-o,null],y[0].idleTimer=250,S.overflowed[0]&&a(p[0],M,l,"y","all",!0),S.overflowed[1]&&a(p[1],M,l,"x",O,!0)}}),C.bind("touchstart."+b+" pointerdown."+b+" MSPointerDown."+b,function(e){if(!tt(e)||u||E(e)[2])return void(o=0);o=1,e.stopImmediatePropagation(),Q(_),c=K();var t=C.offset();l=E(e)[0]-t.top,s=E(e)[1]-t.left,T=[],k=[]}).bind("touchend."+b+" pointerup."+b+" MSPointerUp."+b,function(e){if(tt(e)&&!u&&!E(e)[2]){e.stopImmediatePropagation(),v=0,x=0,f=K();var o=C.offset(),n=E(e)[0]-o.top,i=E(e)[1]-o.left;if(!(f-d>30)){m=1e3/(f-c);var r="mcsEaseOut",_=2.5>m,b=_?[T[T.length-2],k[k.length-2]]:[0,0];h=_?[n-b[0],i-b[1]]:[n-l,i-s];var B=[Math.abs(h[0]),Math.abs(h[1])];m=_?[Math.abs(h[0]/4),Math.abs(h[1]/4)]:[m,m];var M=[Math.abs(y[0].offsetTop)-h[0]*t(B[0]/m[0],m[0]),Math.abs(y[0].offsetLeft)-h[1]*t(B[1]/m[1],m[1])];p="yx"===w.axis?[M[0],M[1]]:"x"===w.axis?[null,M[1]]:[M[0],null],g=[4*B[0]+w.scrollInertia,4*B[1]+w.scrollInertia];var I=parseInt(w.contentTouchScroll)||0;p[0]=B[0]>I?p[0]:0,p[1]=B[1]>I?p[1]:0,S.overflowed[0]&&a(p[0],g[0],r,"y",O,!1),S.overflowed[1]&&a(p[1],g[1],r,"x",O,!1)}}})},W=function(){function n(){return t.getSelection?t.getSelection().toString():a.selection&&"Control"!=a.selection.type?a.selection.createRange().text:0}function r(e,t,a){f.type=a&&l?"stepped":"stepless",f.scrollAmount=10,j(s,e,t,"mcsLinearOut",a?60:null)}var l,s=e(this),c=s.data(i),d=c.opt,f=c.sequential,h=i+"_"+c.idx,m=e("#mCSB_"+c.idx+"_container"),p=m.parent();m.bind("mousedown."+h,function(){o||l||(l=1,u=!0)}).add(a).bind("mousemove."+h,function(e){if(!o&&l&&n()){var t=m.offset(),a=E(e)[0]-t.top+m[0].offsetTop,i=E(e)[1]-t.left+m[0].offsetLeft;a>0&&a<p.height()&&i>0&&i<p.width()?f.step&&r("off",null,"stepped"):("x"!==d.axis&&c.overflowed[0]&&(0>a?r("on",38):a>p.height()&&r("on",40)),"y"!==d.axis&&c.overflowed[1]&&(0>i?r("on",37):i>p.width()&&r("on",39)))}}).bind("mouseup."+h,function(){o||(l&&(l=0,r("off",null)),u=!1)})},A=function(){function t(e){var t=null;try{var a=e.contentDocument||e.contentWindow.document;t=a.body.innerHTML}catch(o){}return null!==t}var a=e(this),o=a.data(i);if(o){var n=o.opt,r=i+"_"+o.idx,l=e("#mCSB_"+o.idx),s=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")],c=e("#mCSB_"+o.idx+"_container").find("iframe"),u=l;c.length&&c.each(function(){var a=this;t(a)&&(u=u.add(e(a).contents().find("body")))}),u.bind("mousewheel."+r,function(t,i){if(Q(a),!P(a,t.target)){var r="auto"!==n.mouseWheel.deltaFactor?parseInt(n.mouseWheel.deltaFactor):d&&t.deltaFactor<100?100:t.deltaFactor||100;if("x"===n.axis||"x"===n.mouseWheel.axis)var c="x",u=[Math.round(r*o.scrollRatio.x),parseInt(n.mouseWheel.scrollAmount)],f="auto"!==n.mouseWheel.scrollAmount?u[1]:u[0]>=l.width()?.9*l.width():u[0],h=Math.abs(e("#mCSB_"+o.idx+"_container")[0].offsetLeft),m=s[1][0].offsetLeft,p=s[1].parent().width()-s[1].width(),g=t.deltaX||t.deltaY||i;else var c="y",u=[Math.round(r*o.scrollRatio.y),parseInt(n.mouseWheel.scrollAmount)],f="auto"!==n.mouseWheel.scrollAmount?u[1]:u[0]>=l.height()?.9*l.height():u[0],h=Math.abs(e("#mCSB_"+o.idx+"_container")[0].offsetTop),m=s[0][0].offsetTop,p=s[0].parent().height()-s[0].height(),g=t.deltaY||i;"y"===c&&!o.overflowed[0]||"x"===c&&!o.overflowed[1]||(n.mouseWheel.invert&&(g=-g),n.mouseWheel.normalizeDelta&&(g=0>g?-1:1),(g>0&&0!==m||0>g&&m!==p||n.mouseWheel.preventDefault)&&(t.stopImmediatePropagation(),t.preventDefault()),G(a,(h-g*f).toString(),{dir:c}))}})}},P=function(t,a){var o=a.nodeName.toLowerCase(),n=t.data(i).opt.mouseWheel.disableOver,r=["select","textarea"];return e.inArray(o,n)>-1&&!(e.inArray(o,r)>-1&&!e(a).is(":focus"))},z=function(){var t=e(this),a=t.data(i),o=i+"_"+a.idx,n=e("#mCSB_"+a.idx+"_container"),r=n.parent(),l=e(".mCSB_"+a.idx+"_scrollbar ."+f[12]);l.bind("touchstart."+o+" pointerdown."+o+" MSPointerDown."+o,function(){u=!0}).bind("touchend."+o+" pointerup."+o+" MSPointerUp."+o,function(){u=!1}).bind("click."+o,function(o){if(e(o.target).hasClass(f[12])||e(o.target).hasClass("mCSB_draggerRail")){Q(t);var i=e(this),l=i.find(".mCSB_dragger");if(i.parent(".mCSB_scrollTools_horizontal").length>0){if(!a.overflowed[1])return;var s="x",c=o.pageX>l.offset().left?-1:1,d=Math.abs(n[0].offsetLeft)-.9*c*r.width()}else{if(!a.overflowed[0])return;var s="y",c=o.pageY>l.offset().top?-1:1,d=Math.abs(n[0].offsetTop)-.9*c*r.height()}G(t,d.toString(),{dir:s,scrollEasing:"mcsEaseInOut"})}})},H=function(){var t=e(this),o=t.data(i),n=o.opt,r=i+"_"+o.idx,l=e("#mCSB_"+o.idx+"_container"),s=l.parent();l.bind("focusin."+r,function(){var o=e(a.activeElement),i=l.find(".mCustomScrollBox").length,r=0;o.is(n.advanced.autoScrollOnFocus)&&(Q(t),clearTimeout(t[0]._focusTimeout),t[0]._focusTimer=i?(r+17)*i:0,t[0]._focusTimeout=setTimeout(function(){var e=[ot(o)[0],ot(o)[1]],a=[l[0].offsetTop,l[0].offsetLeft],i=[a[0]+e[0]>=0&&a[0]+e[0]<s.height()-o.outerHeight(!1),a[1]+e[1]>=0&&a[0]+e[1]<s.width()-o.outerWidth(!1)],c="yx"!==n.axis||i[0]||i[1]?"all":"none";"x"===n.axis||i[0]||G(t,e[0].toString(),{dir:"y",scrollEasing:"mcsEaseInOut",overwrite:c,dur:r}),"y"===n.axis||i[1]||G(t,e[1].toString(),{dir:"x",scrollEasing:"mcsEaseInOut",overwrite:c,dur:r})},t[0]._focusTimer))})},U=function(){var t=e(this),a=t.data(i),o=i+"_"+a.idx,n=e("#mCSB_"+a.idx+"_container").parent();n.bind("scroll."+o,function(){(0!==n.scrollTop()||0!==n.scrollLeft())&&e(".mCSB_"+a.idx+"_scrollbar").css("visibility","hidden")})},F=function(){var t=e(this),a=t.data(i),o=a.opt,n=a.sequential,r=i+"_"+a.idx,l=".mCSB_"+a.idx+"_scrollbar",s=e(l+">a");s.bind("mousedown."+r+" touchstart."+r+" pointerdown."+r+" MSPointerDown."+r+" mouseup."+r+" touchend."+r+" pointerup."+r+" MSPointerUp."+r+" mouseout."+r+" pointerout."+r+" MSPointerOut."+r+" click."+r,function(i){function r(e,a){n.scrollAmount=o.snapAmount||o.scrollButtons.scrollAmount,j(t,e,a)}if(i.preventDefault(),et(i)){var l=e(this).attr("class");switch(n.type=o.scrollButtons.scrollType,i.type){case"mousedown":case"touchstart":case"pointerdown":case"MSPointerDown":if("stepped"===n.type)return;u=!0,a.tweenRunning=!1,r("on",l);break;case"mouseup":case"touchend":case"pointerup":case"MSPointerUp":case"mouseout":case"pointerout":case"MSPointerOut":if("stepped"===n.type)return;u=!1,n.dir&&r("off",l);break;case"click":if("stepped"!==n.type||a.tweenRunning)return;r("on",l)}}})},q=function(){var t=e(this),o=t.data(i),n=o.opt,r=o.sequential,l=i+"_"+o.idx,s=e("#mCSB_"+o.idx),c=e("#mCSB_"+o.idx+"_container"),d=c.parent(),u="input,textarea,select,datalist,keygen,[contenteditable='true']";s.attr("tabindex","0").bind("blur."+l+" keydown."+l+" keyup."+l,function(i){function l(e,a){r.type=n.keyboard.scrollType,r.scrollAmount=n.snapAmount||n.keyboard.scrollAmount,"stepped"===r.type&&o.tweenRunning||j(t,e,a)}switch(i.type){case"blur":o.tweenRunning&&r.dir&&l("off",null);break;case"keydown":case"keyup":var s=i.keyCode?i.keyCode:i.which,f="on";if("x"!==n.axis&&(38===s||40===s)||"y"!==n.axis&&(37===s||39===s)){if((38===s||40===s)&&!o.overflowed[0]||(37===s||39===s)&&!o.overflowed[1])return;"keyup"===i.type&&(f="off"),e(a.activeElement).is(u)||(i.preventDefault(),i.stopImmediatePropagation(),l(f,s))}else if(33===s||34===s){if((o.overflowed[0]||o.overflowed[1])&&(i.preventDefault(),i.stopImmediatePropagation()),"keyup"===i.type){Q(t);var h=34===s?-1:1;if("x"===n.axis||"yx"===n.axis&&o.overflowed[1]&&!o.overflowed[0])var m="x",p=Math.abs(c[0].offsetLeft)-.9*h*d.width();else var m="y",p=Math.abs(c[0].offsetTop)-.9*h*d.height();G(t,p.toString(),{dir:m,scrollEasing:"mcsEaseInOut"})}}else if((35===s||36===s)&&!e(a.activeElement).is(u)&&((o.overflowed[0]||o.overflowed[1])&&(i.preventDefault(),i.stopImmediatePropagation()),"keyup"===i.type)){if("x"===n.axis||"yx"===n.axis&&o.overflowed[1]&&!o.overflowed[0])var m="x",p=35===s?Math.abs(d.width()-c.outerWidth(!1)):0;else var m="y",p=35===s?Math.abs(d.height()-c.outerHeight(!1)):0;G(t,p.toString(),{dir:m,scrollEasing:"mcsEaseInOut"})}}})},j=function(t,a,o,n,r){function l(e){var a="stepped"!==u.type,o=r?r:e?a?p/1.5:g:1e3/60,i=e?a?7.5:40:2.5,s=[Math.abs(h[0].offsetTop),Math.abs(h[0].offsetLeft)],d=[c.scrollRatio.y>10?10:c.scrollRatio.y,c.scrollRatio.x>10?10:c.scrollRatio.x],f="x"===u.dir[0]?s[1]+u.dir[1]*d[1]*i:s[0]+u.dir[1]*d[0]*i,m="x"===u.dir[0]?s[1]+u.dir[1]*parseInt(u.scrollAmount):s[0]+u.dir[1]*parseInt(u.scrollAmount),v="auto"!==u.scrollAmount?m:f,x=n?n:e?a?"mcsLinearOut":"mcsEaseInOut":"mcsLinear",_=e?!0:!1;return e&&17>o&&(v="x"===u.dir[0]?s[1]:s[0]),G(t,v.toString(),{dir:u.dir[0],scrollEasing:x,dur:o,onComplete:_}),e?void(u.dir=!1):(clearTimeout(u.step),void(u.step=setTimeout(function(){l()},o)))}function s(){clearTimeout(u.step),$(u,"step"),Q(t)}var c=t.data(i),d=c.opt,u=c.sequential,h=e("#mCSB_"+c.idx+"_container"),m="stepped"===u.type?!0:!1,p=d.scrollInertia<26?26:d.scrollInertia,g=d.scrollInertia<1?17:d.scrollInertia;switch(a){case"on":if(u.dir=[o===f[16]||o===f[15]||39===o||37===o?"x":"y",o===f[13]||o===f[15]||38===o||37===o?-1:1],Q(t),at(o)&&"stepped"===u.type)return;l(m);break;case"off":s(),(m||c.tweenRunning&&u.dir)&&l(!0)}},Y=function(t){var a=e(this).data(i).opt,o=[];return"function"==typeof t&&(t=t()),t instanceof Array?o=t.length>1?[t[0],t[1]]:"x"===a.axis?[null,t[0]]:[t[0],null]:(o[0]=t.y?t.y:t.x||"x"===a.axis?null:t,o[1]=t.x?t.x:t.y||"y"===a.axis?null:t),"function"==typeof o[0]&&(o[0]=o[0]()),"function"==typeof o[1]&&(o[1]=o[1]()),o},X=function(t,a){if(null!=t&&"undefined"!=typeof t){var o=e(this),n=o.data(i),r=n.opt,l=e("#mCSB_"+n.idx+"_container"),s=l.parent(),c=typeof t;a||(a="x"===r.axis?"x":"y");var d="x"===a?l.outerWidth(!1):l.outerHeight(!1),u="x"===a?l[0].offsetLeft:l[0].offsetTop,f="x"===a?"left":"top";switch(c){case"function":return t();case"object":var m=t.jquery?t:e(t);if(!m.length)return;return"x"===a?ot(m)[1]:ot(m)[0];case"string":case"number":if(at(t))return Math.abs(t);if(-1!==t.indexOf("%"))return Math.abs(d*parseInt(t)/100);if(-1!==t.indexOf("-="))return Math.abs(u-parseInt(t.split("-=")[1]));if(-1!==t.indexOf("+=")){var p=u+parseInt(t.split("+=")[1]);return p>=0?0:Math.abs(p)}if(-1!==t.indexOf("px")&&at(t.split("px")[0]))return Math.abs(t.split("px")[0]);if("top"===t||"left"===t)return 0;if("bottom"===t)return Math.abs(s.height()-l.outerHeight(!1));if("right"===t)return Math.abs(s.width()-l.outerWidth(!1));if("first"===t||"last"===t){var m=l.find(":"+t);return"x"===a?ot(m)[1]:ot(m)[0]}return e(t).length?"x"===a?ot(e(t))[1]:ot(e(t))[0]:(l.css(f,t),void h.update.call(null,o[0]))}}},N=function(t){function a(){clearTimeout(u[0].autoUpdate),u[0].autoUpdate=setTimeout(function(){return d.advanced.updateOnSelectorChange&&(m=r(),m!==S)?(l(3),void(S=m)):(d.advanced.updateOnContentResize&&(p=[u.outerHeight(!1),u.outerWidth(!1),v.height(),v.width(),_()[0],_()[1]],(p[0]!==w[0]||p[1]!==w[1]||p[2]!==w[2]||p[3]!==w[3]||p[4]!==w[4]||p[5]!==w[5])&&(l(p[0]!==w[0]||p[1]!==w[1]),w=p)),d.advanced.updateOnImageLoad&&(g=o(),g!==b&&(u.find("img").each(function(){n(this)}),b=g)),void((d.advanced.updateOnSelectorChange||d.advanced.updateOnContentResize||d.advanced.updateOnImageLoad)&&a()))},60)}function o(){var e=0;return d.advanced.updateOnImageLoad&&(e=u.find("img").length),e}function n(t){function a(e,t){return function(){return t.apply(e,arguments)}}function o(){this.onload=null,e(t).addClass(f[2]),l(2)}if(e(t).hasClass(f[2]))return void l();var n=new Image;n.onload=a(n,o),n.src=t.src}function r(){d.advanced.updateOnSelectorChange===!0&&(d.advanced.updateOnSelectorChange="*");var t=0,a=u.find(d.advanced.updateOnSelectorChange);return d.advanced.updateOnSelectorChange&&a.length>0&&a.each(function(){t+=e(this).height()+e(this).width()}),t}function l(e){clearTimeout(u[0].autoUpdate),h.update.call(null,s[0],e)}var s=e(this),c=s.data(i),d=c.opt,u=e("#mCSB_"+c.idx+"_container");if(t)return clearTimeout(u[0].autoUpdate),void $(u[0],"autoUpdate");var m,p,g,v=u.parent(),x=[e("#mCSB_"+c.idx+"_scrollbar_vertical"),e("#mCSB_"+c.idx+"_scrollbar_horizontal")],_=function(){return[x[0].is(":visible")?x[0].outerHeight(!0):0,x[1].is(":visible")?x[1].outerWidth(!0):0]},S=r(),w=[u.outerHeight(!1),u.outerWidth(!1),v.height(),v.width(),_()[0],_()[1]],b=o();a()},V=function(e,t,a){return Math.round(e/t)*t-a},Q=function(t){var a=t.data(i),o=e("#mCSB_"+a.idx+"_container,#mCSB_"+a.idx+"_container_wrapper,#mCSB_"+a.idx+"_dragger_vertical,#mCSB_"+a.idx+"_dragger_horizontal");o.each(function(){Z.call(this)})},G=function(t,a,o){function n(e){return s&&c.callbacks[e]&&"function"==typeof c.callbacks[e]}function r(){return[c.callbacks.alwaysTriggerOffsets||_>=S[0]+b,c.callbacks.alwaysTriggerOffsets||-C>=_]}function l(){var e=[h[0].offsetTop,h[0].offsetLeft],a=[v[0].offsetTop,v[0].offsetLeft],n=[h.outerHeight(!1),h.outerWidth(!1)],i=[f.height(),f.width()];t[0].mcs={content:h,top:e[0],left:e[1],draggerTop:a[0],draggerLeft:a[1],topPct:Math.round(100*Math.abs(e[0])/(Math.abs(n[0])-i[0])),leftPct:Math.round(100*Math.abs(e[1])/(Math.abs(n[1])-i[1])),direction:o.dir}}var s=t.data(i),c=s.opt,d={trigger:"internal",dir:"y",scrollEasing:"mcsEaseOut",drag:!1,dur:c.scrollInertia,overwrite:"all",callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},o=e.extend(d,o),u=[o.dur,o.drag?0:o.dur],f=e("#mCSB_"+s.idx),h=e("#mCSB_"+s.idx+"_container"),m=h.parent(),p=c.callbacks.onTotalScrollOffset?Y.call(t,c.callbacks.onTotalScrollOffset):[0,0],g=c.callbacks.onTotalScrollBackOffset?Y.call(t,c.callbacks.onTotalScrollBackOffset):[0,0];if(s.trigger=o.trigger,(0!==m.scrollTop()||0!==m.scrollLeft())&&(e(".mCSB_"+s.idx+"_scrollbar").css("visibility","visible"),m.scrollTop(0).scrollLeft(0)),"_resetY"!==a||s.contentReset.y||(n("onOverflowYNone")&&c.callbacks.onOverflowYNone.call(t[0]),s.contentReset.y=1),"_resetX"!==a||s.contentReset.x||(n("onOverflowXNone")&&c.callbacks.onOverflowXNone.call(t[0]),s.contentReset.x=1),"_resetY"!==a&&"_resetX"!==a){switch(!s.contentReset.y&&t[0].mcs||!s.overflowed[0]||(n("onOverflowY")&&c.callbacks.onOverflowY.call(t[0]),s.contentReset.x=null),!s.contentReset.x&&t[0].mcs||!s.overflowed[1]||(n("onOverflowX")&&c.callbacks.onOverflowX.call(t[0]),s.contentReset.x=null),c.snapAmount&&(a=V(a,c.snapAmount,c.snapOffset)),o.dir){case"x":var v=e("#mCSB_"+s.idx+"_dragger_horizontal"),x="left",_=h[0].offsetLeft,S=[f.width()-h.outerWidth(!1),v.parent().width()-v.width()],w=[a,0===a?0:a/s.scrollRatio.x],b=p[1],C=g[1],y=b>0?b/s.scrollRatio.x:0,B=C>0?C/s.scrollRatio.x:0;
break;case"y":var v=e("#mCSB_"+s.idx+"_dragger_vertical"),x="top",_=h[0].offsetTop,S=[f.height()-h.outerHeight(!1),v.parent().height()-v.height()],w=[a,0===a?0:a/s.scrollRatio.y],b=p[0],C=g[0],y=b>0?b/s.scrollRatio.y:0,B=C>0?C/s.scrollRatio.y:0}w[1]<0||0===w[0]&&0===w[1]?w=[0,0]:w[1]>=S[1]?w=[S[0],S[1]]:w[0]=-w[0],t[0].mcs||(l(),n("onInit")&&c.callbacks.onInit.call(t[0])),clearTimeout(h[0].onCompleteTimeout),(s.tweenRunning||!(0===_&&w[0]>=0||_===S[0]&&w[0]<=S[0]))&&(J(v[0],x,Math.round(w[1]),u[1],o.scrollEasing),J(h[0],x,Math.round(w[0]),u[0],o.scrollEasing,o.overwrite,{onStart:function(){o.callbacks&&o.onStart&&!s.tweenRunning&&(n("onScrollStart")&&(l(),c.callbacks.onScrollStart.call(t[0])),s.tweenRunning=!0,T(v),s.cbOffsets=r())},onUpdate:function(){o.callbacks&&o.onUpdate&&n("whileScrolling")&&(l(),c.callbacks.whileScrolling.call(t[0]))},onComplete:function(){if(o.callbacks&&o.onComplete){"yx"===c.axis&&clearTimeout(h[0].onCompleteTimeout);var e=h[0].idleTimer||0;h[0].onCompleteTimeout=setTimeout(function(){n("onScroll")&&(l(),c.callbacks.onScroll.call(t[0])),n("onTotalScroll")&&w[1]>=S[1]-y&&s.cbOffsets[0]&&(l(),c.callbacks.onTotalScroll.call(t[0])),n("onTotalScrollBack")&&w[1]<=B&&s.cbOffsets[1]&&(l(),c.callbacks.onTotalScrollBack.call(t[0])),s.tweenRunning=!1,h[0].idleTimer=0,T(v,"hide")},e)}}}))}},J=function(e,a,o,n,i,r,l){function s(){b.stop||(_||p.call(),_=K()-x,c(),_>=b.time&&(b.time=_>b.time?_+h-(_-b.time):_+h-1,b.time<_+1&&(b.time=_+1)),b.time<n?b.id=m(s):v.call())}function c(){n>0?(b.currVal=f(b.time,S,C,n,i),w[a]=Math.round(b.currVal)+"px"):w[a]=o+"px",g.call()}function d(){h=1e3/60,b.time=_+h,m=t.requestAnimationFrame?t.requestAnimationFrame:function(e){return c(),setTimeout(e,.01)},b.id=m(s)}function u(){null!=b.id&&(t.requestAnimationFrame?t.cancelAnimationFrame(b.id):clearTimeout(b.id),b.id=null)}function f(e,t,a,o,n){switch(n){case"linear":case"mcsLinear":return a*e/o+t;case"mcsLinearOut":return e/=o,e--,a*Math.sqrt(1-e*e)+t;case"easeInOutSmooth":return e/=o/2,1>e?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t);case"easeInOutStrong":return e/=o/2,1>e?a/2*Math.pow(2,10*(e-1))+t:(e--,a/2*(-Math.pow(2,-10*e)+2)+t);case"easeInOut":case"mcsEaseInOut":return e/=o/2,1>e?a/2*e*e*e+t:(e-=2,a/2*(e*e*e+2)+t);case"easeOutSmooth":return e/=o,e--,-a*(e*e*e*e-1)+t;case"easeOutStrong":return a*(-Math.pow(2,-10*e/o)+1)+t;case"easeOut":case"mcsEaseOut":default:var i=(e/=o)*e,r=i*e;return t+a*(.499999999999997*r*i+-2.5*i*i+5.5*r+-6.5*i+4*e)}}e._mTween||(e._mTween={top:{},left:{}});var h,m,l=l||{},p=l.onStart||function(){},g=l.onUpdate||function(){},v=l.onComplete||function(){},x=K(),_=0,S=e.offsetTop,w=e.style,b=e._mTween[a];"left"===a&&(S=e.offsetLeft);var C=o-S;b.stop=0,"none"!==r&&u(),d()},K=function(){return t.performance&&t.performance.now?t.performance.now():t.performance&&t.performance.webkitNow?t.performance.webkitNow():Date.now?Date.now():(new Date).getTime()},Z=function(){var e=this;e._mTween||(e._mTween={top:{},left:{}});for(var a=["top","left"],o=0;o<a.length;o++){var n=a[o];e._mTween[n].id&&(t.requestAnimationFrame?t.cancelAnimationFrame(e._mTween[n].id):clearTimeout(e._mTween[n].id),e._mTween[n].id=null,e._mTween[n].stop=1)}},$=function(e,t){try{delete e[t]}catch(a){e[t]=null}},et=function(e){return!(e.which&&1!==e.which)},tt=function(e){var t=e.originalEvent.pointerType;return!(t&&"touch"!==t&&2!==t)},at=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},ot=function(e){var t=e.parents(".mCSB_container");return[e.offset().top-t.offset().top,e.offset().left-t.offset().left]};e.fn[n]=function(t){return h[t]?h[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist"):h.init.apply(this,arguments)},e[n]=function(t){return h[t]?h[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist"):h.init.apply(this,arguments)},e[n].defaults=l,t[n]=!0,e(t).load(function(){e(r)[n](),e.extend(e.expr[":"],{mcsInView:e.expr[":"].mcsInView||function(t){var a,o,n=e(t),i=n.parents(".mCSB_container");if(i.length)return a=i.parent(),o=[i[0].offsetTop,i[0].offsetLeft],o[0]+ot(n)[0]>=0&&o[0]+ot(n)[0]<a.height()-n.outerHeight(!1)&&o[1]+ot(n)[1]>=0&&o[1]+ot(n)[1]<a.width()-n.outerWidth(!1)},mcsOverflow:e.expr[":"].mcsOverflow||function(t){var a=e(t).data(i);if(a)return a.overflowed[0]||a.overflowed[1]}})})})}(jQuery,window,document);
/*
 AngularJS v1.3.9
 (c) 2010-2014 Google, Inc. http://angularjs.org
 License: MIT
*/
(function(M,Y,t){'use strict';function T(b){return function(){var a=arguments[0],c;c="["+(b?b+":":"")+a+"] http://errors.angularjs.org/1.3.9/"+(b?b+"/":"")+a;for(a=1;a<arguments.length;a++){c=c+(1==a?"?":"&")+"p"+(a-1)+"=";var d=encodeURIComponent,e;e=arguments[a];e="function"==typeof e?e.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof e?"undefined":"string"!=typeof e?JSON.stringify(e):e;c+=d(e)}return Error(c)}}function Ta(b){if(null==b||Ua(b))return!1;var a=b.length;return b.nodeType===
oa&&a?!0:F(b)||D(b)||0===a||"number"===typeof a&&0<a&&a-1 in b}function s(b,a,c){var d,e;if(b)if(G(b))for(d in b)"prototype"==d||"length"==d||"name"==d||b.hasOwnProperty&&!b.hasOwnProperty(d)||a.call(c,b[d],d,b);else if(D(b)||Ta(b)){var f="object"!==typeof b;d=0;for(e=b.length;d<e;d++)(f||d in b)&&a.call(c,b[d],d,b)}else if(b.forEach&&b.forEach!==s)b.forEach(a,c,b);else for(d in b)b.hasOwnProperty(d)&&a.call(c,b[d],d,b);return b}function Ed(b,a,c){for(var d=Object.keys(b).sort(),e=0;e<d.length;e++)a.call(c,
b[d[e]],d[e]);return d}function kc(b){return function(a,c){b(c,a)}}function Fd(){return++nb}function lc(b,a){a?b.$$hashKey=a:delete b.$$hashKey}function z(b){for(var a=b.$$hashKey,c=1,d=arguments.length;c<d;c++){var e=arguments[c];if(e)for(var f=Object.keys(e),g=0,h=f.length;g<h;g++){var l=f[g];b[l]=e[l]}}lc(b,a);return b}function ba(b){return parseInt(b,10)}function H(){}function pa(b){return b}function da(b){return function(){return b}}function A(b){return"undefined"===typeof b}function y(b){return"undefined"!==
typeof b}function I(b){return null!==b&&"object"===typeof b}function F(b){return"string"===typeof b}function V(b){return"number"===typeof b}function qa(b){return"[object Date]"===Da.call(b)}function G(b){return"function"===typeof b}function ob(b){return"[object RegExp]"===Da.call(b)}function Ua(b){return b&&b.window===b}function Va(b){return b&&b.$evalAsync&&b.$watch}function Wa(b){return"boolean"===typeof b}function mc(b){return!(!b||!(b.nodeName||b.prop&&b.attr&&b.find))}function Gd(b){var a={};
b=b.split(",");var c;for(c=0;c<b.length;c++)a[b[c]]=!0;return a}function ua(b){return Q(b.nodeName||b[0]&&b[0].nodeName)}function Xa(b,a){var c=b.indexOf(a);0<=c&&b.splice(c,1);return a}function Ea(b,a,c,d){if(Ua(b)||Va(b))throw Ka("cpws");if(a){if(b===a)throw Ka("cpi");c=c||[];d=d||[];if(I(b)){var e=c.indexOf(b);if(-1!==e)return d[e];c.push(b);d.push(a)}if(D(b))for(var f=a.length=0;f<b.length;f++)e=Ea(b[f],null,c,d),I(b[f])&&(c.push(b[f]),d.push(e)),a.push(e);else{var g=a.$$hashKey;D(a)?a.length=
0:s(a,function(b,c){delete a[c]});for(f in b)b.hasOwnProperty(f)&&(e=Ea(b[f],null,c,d),I(b[f])&&(c.push(b[f]),d.push(e)),a[f]=e);lc(a,g)}}else if(a=b)D(b)?a=Ea(b,[],c,d):qa(b)?a=new Date(b.getTime()):ob(b)?(a=new RegExp(b.source,b.toString().match(/[^\/]*$/)[0]),a.lastIndex=b.lastIndex):I(b)&&(e=Object.create(Object.getPrototypeOf(b)),a=Ea(b,e,c,d));return a}function ra(b,a){if(D(b)){a=a||[];for(var c=0,d=b.length;c<d;c++)a[c]=b[c]}else if(I(b))for(c in a=a||{},b)if("$"!==c.charAt(0)||"$"!==c.charAt(1))a[c]=
b[c];return a||b}function fa(b,a){if(b===a)return!0;if(null===b||null===a)return!1;if(b!==b&&a!==a)return!0;var c=typeof b,d;if(c==typeof a&&"object"==c)if(D(b)){if(!D(a))return!1;if((c=b.length)==a.length){for(d=0;d<c;d++)if(!fa(b[d],a[d]))return!1;return!0}}else{if(qa(b))return qa(a)?fa(b.getTime(),a.getTime()):!1;if(ob(b)&&ob(a))return b.toString()==a.toString();if(Va(b)||Va(a)||Ua(b)||Ua(a)||D(a))return!1;c={};for(d in b)if("$"!==d.charAt(0)&&!G(b[d])){if(!fa(b[d],a[d]))return!1;c[d]=!0}for(d in a)if(!c.hasOwnProperty(d)&&
"$"!==d.charAt(0)&&a[d]!==t&&!G(a[d]))return!1;return!0}return!1}function Ya(b,a,c){return b.concat(Za.call(a,c))}function nc(b,a){var c=2<arguments.length?Za.call(arguments,2):[];return!G(a)||a instanceof RegExp?a:c.length?function(){return arguments.length?a.apply(b,Ya(c,arguments,0)):a.apply(b,c)}:function(){return arguments.length?a.apply(b,arguments):a.call(b)}}function Hd(b,a){var c=a;"string"===typeof b&&"$"===b.charAt(0)&&"$"===b.charAt(1)?c=t:Ua(a)?c="$WINDOW":a&&Y===a?c="$DOCUMENT":Va(a)&&
(c="$SCOPE");return c}function $a(b,a){if("undefined"===typeof b)return t;V(a)||(a=a?2:null);return JSON.stringify(b,Hd,a)}function oc(b){return F(b)?JSON.parse(b):b}function va(b){b=B(b).clone();try{b.empty()}catch(a){}var c=B("<div>").append(b).html();try{return b[0].nodeType===pb?Q(c):c.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(a,b){return"<"+Q(b)})}catch(d){return Q(c)}}function pc(b){try{return decodeURIComponent(b)}catch(a){}}function qc(b){var a={},c,d;s((b||"").split("&"),function(b){b&&
(c=b.replace(/\+/g,"%20").split("="),d=pc(c[0]),y(d)&&(b=y(c[1])?pc(c[1]):!0,rc.call(a,d)?D(a[d])?a[d].push(b):a[d]=[a[d],b]:a[d]=b))});return a}function Nb(b){var a=[];s(b,function(b,d){D(b)?s(b,function(b){a.push(Fa(d,!0)+(!0===b?"":"="+Fa(b,!0)))}):a.push(Fa(d,!0)+(!0===b?"":"="+Fa(b,!0)))});return a.length?a.join("&"):""}function qb(b){return Fa(b,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function Fa(b,a){return encodeURIComponent(b).replace(/%40/gi,"@").replace(/%3A/gi,
":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,a?"%20":"+")}function Id(b,a){var c,d,e=rb.length;b=B(b);for(d=0;d<e;++d)if(c=rb[d]+a,F(c=b.attr(c)))return c;return null}function Jd(b,a){var c,d,e={};s(rb,function(a){a+="app";!c&&b.hasAttribute&&b.hasAttribute(a)&&(c=b,d=b.getAttribute(a))});s(rb,function(a){a+="app";var e;!c&&(e=b.querySelector("["+a.replace(":","\\:")+"]"))&&(c=e,d=e.getAttribute(a))});c&&(e.strictDi=null!==Id(c,"strict-di"),a(c,d?[d]:[],e))}function sc(b,
a,c){I(c)||(c={});c=z({strictDi:!1},c);var d=function(){b=B(b);if(b.injector()){var d=b[0]===Y?"document":va(b);throw Ka("btstrpd",d.replace(/</,"&lt;").replace(/>/,"&gt;"));}a=a||[];a.unshift(["$provide",function(a){a.value("$rootElement",b)}]);c.debugInfoEnabled&&a.push(["$compileProvider",function(a){a.debugInfoEnabled(!0)}]);a.unshift("ng");d=Ob(a,c.strictDi);d.invoke(["$rootScope","$rootElement","$compile","$injector",function(a,b,c,d){a.$apply(function(){b.data("$injector",d);c(b)(a)})}]);return d},
e=/^NG_ENABLE_DEBUG_INFO!/,f=/^NG_DEFER_BOOTSTRAP!/;M&&e.test(M.name)&&(c.debugInfoEnabled=!0,M.name=M.name.replace(e,""));if(M&&!f.test(M.name))return d();M.name=M.name.replace(f,"");ga.resumeBootstrap=function(b){s(b,function(b){a.push(b)});d()}}function Kd(){M.name="NG_ENABLE_DEBUG_INFO!"+M.name;M.location.reload()}function Ld(b){b=ga.element(b).injector();if(!b)throw Ka("test");return b.get("$$testability")}function tc(b,a){a=a||"_";return b.replace(Md,function(b,d){return(d?a:"")+b.toLowerCase()})}
function Nd(){var b;uc||((sa=M.jQuery)&&sa.fn.on?(B=sa,z(sa.fn,{scope:La.scope,isolateScope:La.isolateScope,controller:La.controller,injector:La.injector,inheritedData:La.inheritedData}),b=sa.cleanData,sa.cleanData=function(a){var c;if(Pb)Pb=!1;else for(var d=0,e;null!=(e=a[d]);d++)(c=sa._data(e,"events"))&&c.$destroy&&sa(e).triggerHandler("$destroy");b(a)}):B=R,ga.element=B,uc=!0)}function Qb(b,a,c){if(!b)throw Ka("areq",a||"?",c||"required");return b}function sb(b,a,c){c&&D(b)&&(b=b[b.length-1]);
Qb(G(b),a,"not a function, got "+(b&&"object"===typeof b?b.constructor.name||"Object":typeof b));return b}function Ma(b,a){if("hasOwnProperty"===b)throw Ka("badname",a);}function vc(b,a,c){if(!a)return b;a=a.split(".");for(var d,e=b,f=a.length,g=0;g<f;g++)d=a[g],b&&(b=(e=b)[d]);return!c&&G(b)?nc(e,b):b}function tb(b){var a=b[0];b=b[b.length-1];var c=[a];do{a=a.nextSibling;if(!a)break;c.push(a)}while(a!==b);return B(c)}function ha(){return Object.create(null)}function Od(b){function a(a,b,c){return a[b]||
(a[b]=c())}var c=T("$injector"),d=T("ng");b=a(b,"angular",Object);b.$$minErr=b.$$minErr||T;return a(b,"module",function(){var b={};return function(f,g,h){if("hasOwnProperty"===f)throw d("badname","module");g&&b.hasOwnProperty(f)&&(b[f]=null);return a(b,f,function(){function a(c,d,e,f){f||(f=b);return function(){f[e||"push"]([c,d,arguments]);return u}}if(!g)throw c("nomod",f);var b=[],d=[],e=[],q=a("$injector","invoke","push",d),u={_invokeQueue:b,_configBlocks:d,_runBlocks:e,requires:g,name:f,provider:a("$provide",
"provider"),factory:a("$provide","factory"),service:a("$provide","service"),value:a("$provide","value"),constant:a("$provide","constant","unshift"),animation:a("$animateProvider","register"),filter:a("$filterProvider","register"),controller:a("$controllerProvider","register"),directive:a("$compileProvider","directive"),config:q,run:function(a){e.push(a);return this}};h&&q(h);return u})}})}function Pd(b){z(b,{bootstrap:sc,copy:Ea,extend:z,equals:fa,element:B,forEach:s,injector:Ob,noop:H,bind:nc,toJson:$a,
fromJson:oc,identity:pa,isUndefined:A,isDefined:y,isString:F,isFunction:G,isObject:I,isNumber:V,isElement:mc,isArray:D,version:Qd,isDate:qa,lowercase:Q,uppercase:ub,callbacks:{counter:0},getTestability:Ld,$$minErr:T,$$csp:ab,reloadWithDebugInfo:Kd});bb=Od(M);try{bb("ngLocale")}catch(a){bb("ngLocale",[]).provider("$locale",Rd)}bb("ng",["ngLocale"],["$provide",function(a){a.provider({$$sanitizeUri:Sd});a.provider("$compile",wc).directive({a:Td,input:xc,textarea:xc,form:Ud,script:Vd,select:Wd,style:Xd,
option:Yd,ngBind:Zd,ngBindHtml:$d,ngBindTemplate:ae,ngClass:be,ngClassEven:ce,ngClassOdd:de,ngCloak:ee,ngController:fe,ngForm:ge,ngHide:he,ngIf:ie,ngInclude:je,ngInit:ke,ngNonBindable:le,ngPluralize:me,ngRepeat:ne,ngShow:oe,ngStyle:pe,ngSwitch:qe,ngSwitchWhen:re,ngSwitchDefault:se,ngOptions:te,ngTransclude:ue,ngModel:ve,ngList:we,ngChange:xe,pattern:yc,ngPattern:yc,required:zc,ngRequired:zc,minlength:Ac,ngMinlength:Ac,maxlength:Bc,ngMaxlength:Bc,ngValue:ye,ngModelOptions:ze}).directive({ngInclude:Ae}).directive(vb).directive(Cc);
a.provider({$anchorScroll:Be,$animate:Ce,$browser:De,$cacheFactory:Ee,$controller:Fe,$document:Ge,$exceptionHandler:He,$filter:Dc,$interpolate:Ie,$interval:Je,$http:Ke,$httpBackend:Le,$location:Me,$log:Ne,$parse:Oe,$rootScope:Pe,$q:Qe,$$q:Re,$sce:Se,$sceDelegate:Te,$sniffer:Ue,$templateCache:Ve,$templateRequest:We,$$testability:Xe,$timeout:Ye,$window:Ze,$$rAF:$e,$$asyncCallback:af,$$jqLite:bf})}])}function cb(b){return b.replace(cf,function(a,b,d,e){return e?d.toUpperCase():d}).replace(df,"Moz$1")}
function Ec(b){b=b.nodeType;return b===oa||!b||9===b}function Fc(b,a){var c,d,e=a.createDocumentFragment(),f=[];if(Rb.test(b)){c=c||e.appendChild(a.createElement("div"));d=(ef.exec(b)||["",""])[1].toLowerCase();d=ia[d]||ia._default;c.innerHTML=d[1]+b.replace(ff,"<$1></$2>")+d[2];for(d=d[0];d--;)c=c.lastChild;f=Ya(f,c.childNodes);c=e.firstChild;c.textContent=""}else f.push(a.createTextNode(b));e.textContent="";e.innerHTML="";s(f,function(a){e.appendChild(a)});return e}function R(b){if(b instanceof
R)return b;var a;F(b)&&(b=U(b),a=!0);if(!(this instanceof R)){if(a&&"<"!=b.charAt(0))throw Sb("nosel");return new R(b)}if(a){a=Y;var c;b=(c=gf.exec(b))?[a.createElement(c[1])]:(c=Fc(b,a))?c.childNodes:[]}Gc(this,b)}function Tb(b){return b.cloneNode(!0)}function wb(b,a){a||xb(b);if(b.querySelectorAll)for(var c=b.querySelectorAll("*"),d=0,e=c.length;d<e;d++)xb(c[d])}function Hc(b,a,c,d){if(y(d))throw Sb("offargs");var e=(d=yb(b))&&d.events,f=d&&d.handle;if(f)if(a)s(a.split(" "),function(a){if(y(c)){var d=
e[a];Xa(d||[],c);if(d&&0<d.length)return}b.removeEventListener(a,f,!1);delete e[a]});else for(a in e)"$destroy"!==a&&b.removeEventListener(a,f,!1),delete e[a]}function xb(b,a){var c=b.ng339,d=c&&zb[c];d&&(a?delete d.data[a]:(d.handle&&(d.events.$destroy&&d.handle({},"$destroy"),Hc(b)),delete zb[c],b.ng339=t))}function yb(b,a){var c=b.ng339,c=c&&zb[c];a&&!c&&(b.ng339=c=++hf,c=zb[c]={events:{},data:{},handle:t});return c}function Ub(b,a,c){if(Ec(b)){var d=y(c),e=!d&&a&&!I(a),f=!a;b=(b=yb(b,!e))&&b.data;
if(d)b[a]=c;else{if(f)return b;if(e)return b&&b[a];z(b,a)}}}function Ab(b,a){return b.getAttribute?-1<(" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+a+" "):!1}function Bb(b,a){a&&b.setAttribute&&s(a.split(" "),function(a){b.setAttribute("class",U((" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+U(a)+" "," ")))})}function Cb(b,a){if(a&&b.setAttribute){var c=(" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");s(a.split(" "),function(a){a=
U(a);-1===c.indexOf(" "+a+" ")&&(c+=a+" ")});b.setAttribute("class",U(c))}}function Gc(b,a){if(a)if(a.nodeType)b[b.length++]=a;else{var c=a.length;if("number"===typeof c&&a.window!==a){if(c)for(var d=0;d<c;d++)b[b.length++]=a[d]}else b[b.length++]=a}}function Ic(b,a){return Db(b,"$"+(a||"ngController")+"Controller")}function Db(b,a,c){9==b.nodeType&&(b=b.documentElement);for(a=D(a)?a:[a];b;){for(var d=0,e=a.length;d<e;d++)if((c=B.data(b,a[d]))!==t)return c;b=b.parentNode||11===b.nodeType&&b.host}}
function Jc(b){for(wb(b,!0);b.firstChild;)b.removeChild(b.firstChild)}function Kc(b,a){a||wb(b);var c=b.parentNode;c&&c.removeChild(b)}function jf(b,a){a=a||M;if("complete"===a.document.readyState)a.setTimeout(b);else B(a).on("load",b)}function Lc(b,a){var c=Eb[a.toLowerCase()];return c&&Mc[ua(b)]&&c}function kf(b,a){var c=b.nodeName;return("INPUT"===c||"TEXTAREA"===c)&&Nc[a]}function lf(b,a){var c=function(c,e){c.isDefaultPrevented=function(){return c.defaultPrevented};var f=a[e||c.type],g=f?f.length:
0;if(g){if(A(c.immediatePropagationStopped)){var h=c.stopImmediatePropagation;c.stopImmediatePropagation=function(){c.immediatePropagationStopped=!0;c.stopPropagation&&c.stopPropagation();h&&h.call(c)}}c.isImmediatePropagationStopped=function(){return!0===c.immediatePropagationStopped};1<g&&(f=ra(f));for(var l=0;l<g;l++)c.isImmediatePropagationStopped()||f[l].call(b,c)}};c.elem=b;return c}function bf(){this.$get=function(){return z(R,{hasClass:function(b,a){b.attr&&(b=b[0]);return Ab(b,a)},addClass:function(b,
a){b.attr&&(b=b[0]);return Cb(b,a)},removeClass:function(b,a){b.attr&&(b=b[0]);return Bb(b,a)}})}}function Na(b,a){var c=b&&b.$$hashKey;if(c)return"function"===typeof c&&(c=b.$$hashKey()),c;c=typeof b;return c="function"==c||"object"==c&&null!==b?b.$$hashKey=c+":"+(a||Fd)():c+":"+b}function db(b,a){if(a){var c=0;this.nextUid=function(){return++c}}s(b,this.put,this)}function mf(b){return(b=b.toString().replace(Oc,"").match(Pc))?"function("+(b[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}function Vb(b,
a,c){var d;if("function"===typeof b){if(!(d=b.$inject)){d=[];if(b.length){if(a)throw F(c)&&c||(c=b.name||mf(b)),Ga("strictdi",c);a=b.toString().replace(Oc,"");a=a.match(Pc);s(a[1].split(nf),function(a){a.replace(of,function(a,b,c){d.push(c)})})}b.$inject=d}}else D(b)?(a=b.length-1,sb(b[a],"fn"),d=b.slice(0,a)):sb(b,"fn",!0);return d}function Ob(b,a){function c(a){return function(b,c){if(I(b))s(b,kc(a));else return a(b,c)}}function d(a,b){Ma(a,"service");if(G(b)||D(b))b=q.instantiate(b);if(!b.$get)throw Ga("pget",
a);return p[a+"Provider"]=b}function e(a,b){return function(){var c=r.invoke(b,this);if(A(c))throw Ga("undef",a);return c}}function f(a,b,c){return d(a,{$get:!1!==c?e(a,b):b})}function g(a){var b=[],c;s(a,function(a){function d(a){var b,c;b=0;for(c=a.length;b<c;b++){var e=a[b],f=q.get(e[0]);f[e[1]].apply(f,e[2])}}if(!m.get(a)){m.put(a,!0);try{F(a)?(c=bb(a),b=b.concat(g(c.requires)).concat(c._runBlocks),d(c._invokeQueue),d(c._configBlocks)):G(a)?b.push(q.invoke(a)):D(a)?b.push(q.invoke(a)):sb(a,"module")}catch(e){throw D(a)&&
(a=a[a.length-1]),e.message&&e.stack&&-1==e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),Ga("modulerr",a,e.stack||e.message||e);}}});return b}function h(b,c){function d(a,e){if(b.hasOwnProperty(a)){if(b[a]===l)throw Ga("cdep",a+" <- "+k.join(" <- "));return b[a]}try{return k.unshift(a),b[a]=l,b[a]=c(a,e)}catch(f){throw b[a]===l&&delete b[a],f;}finally{k.shift()}}function e(b,c,f,g){"string"===typeof f&&(g=f,f=null);var h=[],k=Vb(b,a,g),l,q,p;q=0;for(l=k.length;q<l;q++){p=k[q];if("string"!==
typeof p)throw Ga("itkn",p);h.push(f&&f.hasOwnProperty(p)?f[p]:d(p,g))}D(b)&&(b=b[l]);return b.apply(c,h)}return{invoke:e,instantiate:function(a,b,c){var d=Object.create((D(a)?a[a.length-1]:a).prototype);a=e(a,d,b,c);return I(a)||G(a)?a:d},get:d,annotate:Vb,has:function(a){return p.hasOwnProperty(a+"Provider")||b.hasOwnProperty(a)}}}a=!0===a;var l={},k=[],m=new db([],!0),p={$provide:{provider:c(d),factory:c(f),service:c(function(a,b){return f(a,["$injector",function(a){return a.instantiate(b)}])}),
value:c(function(a,b){return f(a,da(b),!1)}),constant:c(function(a,b){Ma(a,"constant");p[a]=b;u[a]=b}),decorator:function(a,b){var c=q.get(a+"Provider"),d=c.$get;c.$get=function(){var a=r.invoke(d,c);return r.invoke(b,null,{$delegate:a})}}}},q=p.$injector=h(p,function(a,b){ga.isString(b)&&k.push(b);throw Ga("unpr",k.join(" <- "));}),u={},r=u.$injector=h(u,function(a,b){var c=q.get(a+"Provider",b);return r.invoke(c.$get,c,t,a)});s(g(b),function(a){r.invoke(a||H)});return r}function Be(){var b=!0;this.disableAutoScrolling=
function(){b=!1};this.$get=["$window","$location","$rootScope",function(a,c,d){function e(a){var b=null;Array.prototype.some.call(a,function(a){if("a"===ua(a))return b=a,!0});return b}function f(b){if(b){b.scrollIntoView();var c;c=g.yOffset;G(c)?c=c():mc(c)?(c=c[0],c="fixed"!==a.getComputedStyle(c).position?0:c.getBoundingClientRect().bottom):V(c)||(c=0);c&&(b=b.getBoundingClientRect().top,a.scrollBy(0,b-c))}else a.scrollTo(0,0)}function g(){var a=c.hash(),b;a?(b=h.getElementById(a))?f(b):(b=e(h.getElementsByName(a)))?
f(b):"top"===a&&f(null):f(null)}var h=a.document;b&&d.$watch(function(){return c.hash()},function(a,b){a===b&&""===a||jf(function(){d.$evalAsync(g)})});return g}]}function af(){this.$get=["$$rAF","$timeout",function(b,a){return b.supported?function(a){return b(a)}:function(b){return a(b,0,!1)}}]}function pf(b,a,c,d){function e(a){try{a.apply(null,Za.call(arguments,1))}finally{if(v--,0===v)for(;w.length;)try{w.pop()()}catch(b){c.error(b)}}}function f(a,b){(function N(){s(L,function(a){a()});C=b(N,
a)})()}function g(){h();l()}function h(){x=b.history.state;x=A(x)?null:x;fa(x,J)&&(x=J);J=x}function l(){if(E!==m.url()||P!==x)E=m.url(),P=x,s(W,function(a){a(m.url(),x)})}function k(a){try{return decodeURIComponent(a)}catch(b){return a}}var m=this,p=a[0],q=b.location,u=b.history,r=b.setTimeout,O=b.clearTimeout,n={};m.isMock=!1;var v=0,w=[];m.$$completeOutstandingRequest=e;m.$$incOutstandingRequestCount=function(){v++};m.notifyWhenNoOutstandingRequests=function(a){s(L,function(a){a()});0===v?a():
w.push(a)};var L=[],C;m.addPollFn=function(a){A(C)&&f(100,r);L.push(a);return a};var x,P,E=q.href,S=a.find("base"),X=null;h();P=x;m.url=function(a,c,e){A(e)&&(e=null);q!==b.location&&(q=b.location);u!==b.history&&(u=b.history);if(a){var f=P===e;if(E===a&&(!d.history||f))return m;var g=E&&Ha(E)===Ha(a);E=a;P=e;!d.history||g&&f?(g||(X=a),c?q.replace(a):g?(c=q,e=a.indexOf("#"),a=-1===e?"":a.substr(e+1),c.hash=a):q.href=a):(u[c?"replaceState":"pushState"](e,"",a),h(),P=x);return m}return X||q.href.replace(/%27/g,
"'")};m.state=function(){return x};var W=[],wa=!1,J=null;m.onUrlChange=function(a){if(!wa){if(d.history)B(b).on("popstate",g);B(b).on("hashchange",g);wa=!0}W.push(a);return a};m.$$checkUrlChange=l;m.baseHref=function(){var a=S.attr("href");return a?a.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var ea={},y="",ca=m.baseHref();m.cookies=function(a,b){var d,e,f,g;if(a)b===t?p.cookie=encodeURIComponent(a)+"=;path="+ca+";expires=Thu, 01 Jan 1970 00:00:00 GMT":F(b)&&(d=(p.cookie=encodeURIComponent(a)+"="+encodeURIComponent(b)+
";path="+ca).length+1,4096<d&&c.warn("Cookie '"+a+"' possibly not set or overflowed because it was too large ("+d+" > 4096 bytes)!"));else{if(p.cookie!==y)for(y=p.cookie,d=y.split("; "),ea={},f=0;f<d.length;f++)e=d[f],g=e.indexOf("="),0<g&&(a=k(e.substring(0,g)),ea[a]===t&&(ea[a]=k(e.substring(g+1))));return ea}};m.defer=function(a,b){var c;v++;c=r(function(){delete n[c];e(a)},b||0);n[c]=!0;return c};m.defer.cancel=function(a){return n[a]?(delete n[a],O(a),e(H),!0):!1}}function De(){this.$get=["$window",
"$log","$sniffer","$document",function(b,a,c,d){return new pf(b,d,a,c)}]}function Ee(){this.$get=function(){function b(b,d){function e(a){a!=p&&(q?q==a&&(q=a.n):q=a,f(a.n,a.p),f(a,p),p=a,p.n=null)}function f(a,b){a!=b&&(a&&(a.p=b),b&&(b.n=a))}if(b in a)throw T("$cacheFactory")("iid",b);var g=0,h=z({},d,{id:b}),l={},k=d&&d.capacity||Number.MAX_VALUE,m={},p=null,q=null;return a[b]={put:function(a,b){if(k<Number.MAX_VALUE){var c=m[a]||(m[a]={key:a});e(c)}if(!A(b))return a in l||g++,l[a]=b,g>k&&this.remove(q.key),
b},get:function(a){if(k<Number.MAX_VALUE){var b=m[a];if(!b)return;e(b)}return l[a]},remove:function(a){if(k<Number.MAX_VALUE){var b=m[a];if(!b)return;b==p&&(p=b.p);b==q&&(q=b.n);f(b.n,b.p);delete m[a]}delete l[a];g--},removeAll:function(){l={};g=0;m={};p=q=null},destroy:function(){m=h=l=null;delete a[b]},info:function(){return z({},h,{size:g})}}}var a={};b.info=function(){var b={};s(a,function(a,e){b[e]=a.info()});return b};b.get=function(b){return a[b]};return b}}function Ve(){this.$get=["$cacheFactory",
function(b){return b("templates")}]}function wc(b,a){function c(a,b){var c=/^\s*([@&]|=(\*?))(\??)\s*(\w*)\s*$/,d={};s(a,function(a,e){var f=a.match(c);if(!f)throw ja("iscp",b,e,a);d[e]={mode:f[1][0],collection:"*"===f[2],optional:"?"===f[3],attrName:f[4]||e}});return d}var d={},e=/^\s*directive\:\s*([\w\-]+)\s+(.*)$/,f=/(([\w\-]+)(?:\:([^;]+))?;?)/,g=Gd("ngSrc,ngSrcset,src,srcset"),h=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,l=/^(on[a-z]+|formaction)$/;this.directive=function p(a,e){Ma(a,"directive");F(a)?(Qb(e,
"directiveFactory"),d.hasOwnProperty(a)||(d[a]=[],b.factory(a+"Directive",["$injector","$exceptionHandler",function(b,e){var f=[];s(d[a],function(d,g){try{var h=b.invoke(d);G(h)?h={compile:da(h)}:!h.compile&&h.link&&(h.compile=da(h.link));h.priority=h.priority||0;h.index=g;h.name=h.name||a;h.require=h.require||h.controller&&h.name;h.restrict=h.restrict||"EA";I(h.scope)&&(h.$$isolateBindings=c(h.scope,h.name));f.push(h)}catch(l){e(l)}});return f}])),d[a].push(e)):s(a,kc(p));return this};this.aHrefSanitizationWhitelist=
function(b){return y(b)?(a.aHrefSanitizationWhitelist(b),this):a.aHrefSanitizationWhitelist()};this.imgSrcSanitizationWhitelist=function(b){return y(b)?(a.imgSrcSanitizationWhitelist(b),this):a.imgSrcSanitizationWhitelist()};var k=!0;this.debugInfoEnabled=function(a){return y(a)?(k=a,this):k};this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function(a,b,c,r,O,n,v,w,L,C,x){function P(a,b){try{a.addClass(b)}catch(c){}}
function E(a,b,c,d,e){a instanceof B||(a=B(a));s(a,function(b,c){b.nodeType==pb&&b.nodeValue.match(/\S+/)&&(a[c]=B(b).wrap("<span></span>").parent()[0])});var f=S(a,b,a,c,d,e);E.$$addScopeClass(a);var g=null;return function(b,c,d){Qb(b,"scope");d=d||{};var e=d.parentBoundTranscludeFn,h=d.transcludeControllers;d=d.futureParentElement;e&&e.$$boundTransclude&&(e=e.$$boundTransclude);g||(g=(d=d&&d[0])?"foreignobject"!==ua(d)&&d.toString().match(/SVG/)?"svg":"html":"html");d="html"!==g?B(Wb(g,B("<div>").append(a).html())):
c?La.clone.call(a):a;if(h)for(var l in h)d.data("$"+l+"Controller",h[l].instance);E.$$addScopeInfo(d,b);c&&c(d,b);f&&f(b,d,d,e);return d}}function S(a,b,c,d,e,f){function g(a,c,d,e){var f,l,k,q,p,n,w;if(r)for(w=Array(c.length),q=0;q<h.length;q+=3)f=h[q],w[f]=c[f];else w=c;q=0;for(p=h.length;q<p;)l=w[h[q++]],c=h[q++],f=h[q++],c?(c.scope?(k=a.$new(),E.$$addScopeInfo(B(l),k)):k=a,n=c.transcludeOnThisElement?X(a,c.transclude,e,c.elementTranscludeOnThisElement):!c.templateOnThisElement&&e?e:!e&&b?X(a,
b):null,c(f,k,l,d,n)):f&&f(a,l.childNodes,t,e)}for(var h=[],l,k,q,p,r,n=0;n<a.length;n++){l=new Xb;k=W(a[n],[],l,0===n?d:t,e);(f=k.length?ea(k,a[n],l,b,c,null,[],[],f):null)&&f.scope&&E.$$addScopeClass(l.$$element);l=f&&f.terminal||!(q=a[n].childNodes)||!q.length?null:S(q,f?(f.transcludeOnThisElement||!f.templateOnThisElement)&&f.transclude:b);if(f||l)h.push(n,f,l),p=!0,r=r||f;f=null}return p?g:null}function X(a,b,c,d){return function(d,e,f,g,h){d||(d=a.$new(!1,h),d.$$transcluded=!0);return b(d,e,
{parentBoundTranscludeFn:c,transcludeControllers:f,futureParentElement:g})}}function W(a,b,c,d,g){var h=c.$attr,l;switch(a.nodeType){case oa:ca(b,ya(ua(a)),"E",d,g);for(var k,q,p,r=a.attributes,n=0,w=r&&r.length;n<w;n++){var O=!1,L=!1;k=r[n];l=k.name;q=U(k.value);k=ya(l);if(p=fb.test(k))l=l.replace(Rc,"").substr(8).replace(/_(.)/g,function(a,b){return b.toUpperCase()});var u=k.replace(/(Start|End)$/,"");A(u)&&k===u+"Start"&&(O=l,L=l.substr(0,l.length-5)+"end",l=l.substr(0,l.length-6));k=ya(l.toLowerCase());
h[k]=l;if(p||!c.hasOwnProperty(k))c[k]=q,Lc(a,k)&&(c[k]=!0);Pa(a,b,q,k,p);ca(b,k,"A",d,g,O,L)}a=a.className;if(F(a)&&""!==a)for(;l=f.exec(a);)k=ya(l[2]),ca(b,k,"C",d,g)&&(c[k]=U(l[3])),a=a.substr(l.index+l[0].length);break;case pb:M(b,a.nodeValue);break;case 8:try{if(l=e.exec(a.nodeValue))k=ya(l[1]),ca(b,k,"M",d,g)&&(c[k]=U(l[2]))}catch(v){}}b.sort(N);return b}function wa(a,b,c){var d=[],e=0;if(b&&a.hasAttribute&&a.hasAttribute(b)){do{if(!a)throw ja("uterdir",b,c);a.nodeType==oa&&(a.hasAttribute(b)&&
e++,a.hasAttribute(c)&&e--);d.push(a);a=a.nextSibling}while(0<e)}else d.push(a);return B(d)}function J(a,b,c){return function(d,e,f,g,h){e=wa(e[0],b,c);return a(d,e,f,g,h)}}function ea(a,d,e,f,g,l,k,p,r){function w(a,b,c,d){if(a){c&&(a=J(a,c,d));a.require=K.require;a.directiveName=z;if(S===K||K.$$isolateScope)a=Z(a,{isolateScope:!0});k.push(a)}if(b){c&&(b=J(b,c,d));b.require=K.require;b.directiveName=z;if(S===K||K.$$isolateScope)b=Z(b,{isolateScope:!0});p.push(b)}}function L(a,b,c,d){var e,f="data",
g=!1,l=c,k;if(F(b)){k=b.match(h);b=b.substring(k[0].length);k[3]&&(k[1]?k[3]=null:k[1]=k[3]);"^"===k[1]?f="inheritedData":"^^"===k[1]&&(f="inheritedData",l=c.parent());"?"===k[2]&&(g=!0);e=null;d&&"data"===f&&(e=d[b])&&(e=e.instance);e=e||l[f]("$"+b+"Controller");if(!e&&!g)throw ja("ctreq",b,a);return e||null}D(b)&&(e=[],s(b,function(b){e.push(L(a,b,c,d))}));return e}function v(a,c,f,g,h){function l(a,b,c){var d;Va(a)||(c=b,b=a,a=t);H&&(d=P);c||(c=H?W.parent():W);return h(a,b,d,c,wa)}var r,w,u,x,
P,eb,W,J;d===f?(J=e,W=e.$$element):(W=B(f),J=new Xb(W,e));S&&(x=c.$new(!0));h&&(eb=l,eb.$$boundTransclude=h);C&&(X={},P={},s(C,function(a){var b={$scope:a===S||a.$$isolateScope?x:c,$element:W,$attrs:J,$transclude:eb};u=a.controller;"@"==u&&(u=J[a.name]);b=n(u,b,!0,a.controllerAs);P[a.name]=b;H||W.data("$"+a.name+"Controller",b.instance);X[a.name]=b}));if(S){E.$$addScopeInfo(W,x,!0,!(ka&&(ka===S||ka===S.$$originalDirective)));E.$$addScopeClass(W,!0);g=X&&X[S.name];var xa=x;g&&g.identifier&&!0===S.bindToController&&
(xa=g.instance);s(x.$$isolateBindings=S.$$isolateBindings,function(a,d){var e=a.attrName,f=a.optional,g,h,l,k;switch(a.mode){case "@":J.$observe(e,function(a){xa[d]=a});J.$$observers[e].$$scope=c;J[e]&&(xa[d]=b(J[e])(c));break;case "=":if(f&&!J[e])break;h=O(J[e]);k=h.literal?fa:function(a,b){return a===b||a!==a&&b!==b};l=h.assign||function(){g=xa[d]=h(c);throw ja("nonassign",J[e],S.name);};g=xa[d]=h(c);f=function(a){k(a,xa[d])||(k(a,g)?l(c,a=xa[d]):xa[d]=a);return g=a};f.$stateful=!0;f=a.collection?
c.$watchCollection(J[e],f):c.$watch(O(J[e],f),null,h.literal);x.$on("$destroy",f);break;case "&":h=O(J[e]),xa[d]=function(a){return h(c,a)}}})}X&&(s(X,function(a){a()}),X=null);g=0;for(r=k.length;g<r;g++)w=k[g],$(w,w.isolateScope?x:c,W,J,w.require&&L(w.directiveName,w.require,W,P),eb);var wa=c;S&&(S.template||null===S.templateUrl)&&(wa=x);a&&a(wa,f.childNodes,t,h);for(g=p.length-1;0<=g;g--)w=p[g],$(w,w.isolateScope?x:c,W,J,w.require&&L(w.directiveName,w.require,W,P),eb)}r=r||{};for(var x=-Number.MAX_VALUE,
P,C=r.controllerDirectives,X,S=r.newIsolateScopeDirective,ka=r.templateDirective,ea=r.nonTlbTranscludeDirective,ca=!1,A=!1,H=r.hasElementTranscludeDirective,aa=e.$$element=B(d),K,z,N,Aa=f,Q,M=0,R=a.length;M<R;M++){K=a[M];var Pa=K.$$start,fb=K.$$end;Pa&&(aa=wa(d,Pa,fb));N=t;if(x>K.priority)break;if(N=K.scope)K.templateUrl||(I(N)?(Oa("new/isolated scope",S||P,K,aa),S=K):Oa("new/isolated scope",S,K,aa)),P=P||K;z=K.name;!K.templateUrl&&K.controller&&(N=K.controller,C=C||{},Oa("'"+z+"' controller",C[z],
K,aa),C[z]=K);if(N=K.transclude)ca=!0,K.$$tlb||(Oa("transclusion",ea,K,aa),ea=K),"element"==N?(H=!0,x=K.priority,N=aa,aa=e.$$element=B(Y.createComment(" "+z+": "+e[z]+" ")),d=aa[0],V(g,Za.call(N,0),d),Aa=E(N,f,x,l&&l.name,{nonTlbTranscludeDirective:ea})):(N=B(Tb(d)).contents(),aa.empty(),Aa=E(N,f));if(K.template)if(A=!0,Oa("template",ka,K,aa),ka=K,N=G(K.template)?K.template(aa,e):K.template,N=Sc(N),K.replace){l=K;N=Rb.test(N)?Tc(Wb(K.templateNamespace,U(N))):[];d=N[0];if(1!=N.length||d.nodeType!==
oa)throw ja("tplrt",z,"");V(g,aa,d);R={$attr:{}};N=W(d,[],R);var ba=a.splice(M+1,a.length-(M+1));S&&y(N);a=a.concat(N).concat(ba);Qc(e,R);R=a.length}else aa.html(N);if(K.templateUrl)A=!0,Oa("template",ka,K,aa),ka=K,K.replace&&(l=K),v=T(a.splice(M,a.length-M),aa,e,g,ca&&Aa,k,p,{controllerDirectives:C,newIsolateScopeDirective:S,templateDirective:ka,nonTlbTranscludeDirective:ea}),R=a.length;else if(K.compile)try{Q=K.compile(aa,e,Aa),G(Q)?w(null,Q,Pa,fb):Q&&w(Q.pre,Q.post,Pa,fb)}catch(qf){c(qf,va(aa))}K.terminal&&
(v.terminal=!0,x=Math.max(x,K.priority))}v.scope=P&&!0===P.scope;v.transcludeOnThisElement=ca;v.elementTranscludeOnThisElement=H;v.templateOnThisElement=A;v.transclude=Aa;r.hasElementTranscludeDirective=H;return v}function y(a){for(var b=0,c=a.length;b<c;b++){var d=b,e;e=z(Object.create(a[b]),{$$isolateScope:!0});a[d]=e}}function ca(b,e,f,g,h,l,k){if(e===h)return null;h=null;if(d.hasOwnProperty(e)){var q;e=a.get(e+"Directive");for(var r=0,n=e.length;r<n;r++)try{if(q=e[r],(g===t||g>q.priority)&&-1!=
q.restrict.indexOf(f)){if(l){var w={$$start:l,$$end:k};q=z(Object.create(q),w)}b.push(q);h=q}}catch(O){c(O)}}return h}function A(b){if(d.hasOwnProperty(b))for(var c=a.get(b+"Directive"),e=0,f=c.length;e<f;e++)if(b=c[e],b.multiElement)return!0;return!1}function Qc(a,b){var c=b.$attr,d=a.$attr,e=a.$$element;s(a,function(d,e){"$"!=e.charAt(0)&&(b[e]&&b[e]!==d&&(d+=("style"===e?";":" ")+b[e]),a.$set(e,d,!0,c[e]))});s(b,function(b,f){"class"==f?(P(e,b),a["class"]=(a["class"]?a["class"]+" ":"")+b):"style"==
f?(e.attr("style",e.attr("style")+";"+b),a.style=(a.style?a.style+";":"")+b):"$"==f.charAt(0)||a.hasOwnProperty(f)||(a[f]=b,d[f]=c[f])})}function T(a,b,c,d,e,f,g,h){var l=[],k,q,p=b[0],n=a.shift(),w=z({},n,{templateUrl:null,transclude:null,replace:null,$$originalDirective:n}),O=G(n.templateUrl)?n.templateUrl(b,c):n.templateUrl,u=n.templateNamespace;b.empty();r(L.getTrustedResourceUrl(O)).then(function(r){var L,v;r=Sc(r);if(n.replace){r=Rb.test(r)?Tc(Wb(u,U(r))):[];L=r[0];if(1!=r.length||L.nodeType!==
oa)throw ja("tplrt",n.name,O);r={$attr:{}};V(d,b,L);var x=W(L,[],r);I(n.scope)&&y(x);a=x.concat(a);Qc(c,r)}else L=p,b.html(r);a.unshift(w);k=ea(a,L,c,e,b,n,f,g,h);s(d,function(a,c){a==L&&(d[c]=b[0])});for(q=S(b[0].childNodes,e);l.length;){r=l.shift();v=l.shift();var C=l.shift(),E=l.shift(),x=b[0];if(!r.$$destroyed){if(v!==p){var J=v.className;h.hasElementTranscludeDirective&&n.replace||(x=Tb(L));V(C,B(v),x);P(B(x),J)}v=k.transcludeOnThisElement?X(r,k.transclude,E):E;k(q,r,x,d,v)}}l=null});return function(a,
b,c,d,e){a=e;b.$$destroyed||(l?l.push(b,c,d,a):(k.transcludeOnThisElement&&(a=X(b,k.transclude,e)),k(q,b,c,d,a)))}}function N(a,b){var c=b.priority-a.priority;return 0!==c?c:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function Oa(a,b,c,d){if(b)throw ja("multidir",b.name,c.name,a,va(d));}function M(a,c){var d=b(c,!0);d&&a.push({priority:0,compile:function(a){a=a.parent();var b=!!a.length;b&&E.$$addBindingClass(a);return function(a,c){var e=c.parent();b||E.$$addBindingClass(e);E.$$addBindingInfo(e,
d.expressions);a.$watch(d,function(a){c[0].nodeValue=a})}}})}function Wb(a,b){a=Q(a||"html");switch(a){case "svg":case "math":var c=Y.createElement("div");c.innerHTML="<"+a+">"+b+"</"+a+">";return c.childNodes[0].childNodes;default:return b}}function R(a,b){if("srcdoc"==b)return L.HTML;var c=ua(a);if("xlinkHref"==b||"form"==c&&"action"==b||"img"!=c&&("src"==b||"ngSrc"==b))return L.RESOURCE_URL}function Pa(a,c,d,e,f){var h=R(a,e);f=g[e]||f;var k=b(d,!0,h,f);if(k){if("multiple"===e&&"select"===ua(a))throw ja("selmulti",
va(a));c.push({priority:100,compile:function(){return{pre:function(a,c,g){c=g.$$observers||(g.$$observers={});if(l.test(e))throw ja("nodomevents");var p=g[e];p!==d&&(k=p&&b(p,!0,h,f),d=p);k&&(g[e]=k(a),(c[e]||(c[e]=[])).$$inter=!0,(g.$$observers&&g.$$observers[e].$$scope||a).$watch(k,function(a,b){"class"===e&&a!=b?g.$updateClass(a,b):g.$set(e,a)}))}}}})}}function V(a,b,c){var d=b[0],e=b.length,f=d.parentNode,g,h;if(a)for(g=0,h=a.length;g<h;g++)if(a[g]==d){a[g++]=c;h=g+e-1;for(var l=a.length;g<l;g++,
h++)h<l?a[g]=a[h]:delete a[g];a.length-=e-1;a.context===d&&(a.context=c);break}f&&f.replaceChild(c,d);a=Y.createDocumentFragment();a.appendChild(d);B(c).data(B(d).data());sa?(Pb=!0,sa.cleanData([d])):delete B.cache[d[B.expando]];d=1;for(e=b.length;d<e;d++)f=b[d],B(f).remove(),a.appendChild(f),delete b[d];b[0]=c;b.length=1}function Z(a,b){return z(function(){return a.apply(null,arguments)},a,b)}function $(a,b,d,e,f,g){try{a(b,d,e,f,g)}catch(h){c(h,va(d))}}var Xb=function(a,b){if(b){var c=Object.keys(b),
d,e,f;d=0;for(e=c.length;d<e;d++)f=c[d],this[f]=b[f]}else this.$attr={};this.$$element=a};Xb.prototype={$normalize:ya,$addClass:function(a){a&&0<a.length&&C.addClass(this.$$element,a)},$removeClass:function(a){a&&0<a.length&&C.removeClass(this.$$element,a)},$updateClass:function(a,b){var c=Uc(a,b);c&&c.length&&C.addClass(this.$$element,c);(c=Uc(b,a))&&c.length&&C.removeClass(this.$$element,c)},$set:function(a,b,d,e){var f=this.$$element[0],g=Lc(f,a),h=kf(f,a),f=a;g?(this.$$element.prop(a,b),e=g):
h&&(this[h]=b,f=h);this[a]=b;e?this.$attr[a]=e:(e=this.$attr[a])||(this.$attr[a]=e=tc(a,"-"));g=ua(this.$$element);if("a"===g&&"href"===a||"img"===g&&"src"===a)this[a]=b=x(b,"src"===a);else if("img"===g&&"srcset"===a){for(var g="",h=U(b),l=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,l=/\s/.test(h)?l:/(,)/,h=h.split(l),l=Math.floor(h.length/2),k=0;k<l;k++)var q=2*k,g=g+x(U(h[q]),!0),g=g+(" "+U(h[q+1]));h=U(h[2*k]).split(/\s/);g+=x(U(h[0]),!0);2===h.length&&(g+=" "+U(h[1]));this[a]=b=g}!1!==d&&(null===b||
b===t?this.$$element.removeAttr(e):this.$$element.attr(e,b));(a=this.$$observers)&&s(a[f],function(a){try{a(b)}catch(d){c(d)}})},$observe:function(a,b){var c=this,d=c.$$observers||(c.$$observers=ha()),e=d[a]||(d[a]=[]);e.push(b);v.$evalAsync(function(){!e.$$inter&&c.hasOwnProperty(a)&&b(c[a])});return function(){Xa(e,b)}}};var Aa=b.startSymbol(),ka=b.endSymbol(),Sc="{{"==Aa||"}}"==ka?pa:function(a){return a.replace(/\{\{/g,Aa).replace(/}}/g,ka)},fb=/^ngAttr[A-Z]/;E.$$addBindingInfo=k?function(a,b){var c=
a.data("$binding")||[];D(b)?c=c.concat(b):c.push(b);a.data("$binding",c)}:H;E.$$addBindingClass=k?function(a){P(a,"ng-binding")}:H;E.$$addScopeInfo=k?function(a,b,c,d){a.data(c?d?"$isolateScopeNoTemplate":"$isolateScope":"$scope",b)}:H;E.$$addScopeClass=k?function(a,b){P(a,b?"ng-isolate-scope":"ng-scope")}:H;return E}]}function ya(b){return cb(b.replace(Rc,""))}function Uc(b,a){var c="",d=b.split(/\s+/),e=a.split(/\s+/),f=0;a:for(;f<d.length;f++){for(var g=d[f],h=0;h<e.length;h++)if(g==e[h])continue a;
c+=(0<c.length?" ":"")+g}return c}function Tc(b){b=B(b);var a=b.length;if(1>=a)return b;for(;a--;)8===b[a].nodeType&&rf.call(b,a,1);return b}function Fe(){var b={},a=!1,c=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(a,c){Ma(a,"controller");I(a)?z(b,a):b[a]=c};this.allowGlobals=function(){a=!0};this.$get=["$injector","$window",function(d,e){function f(a,b,c,d){if(!a||!I(a.$scope))throw T("$controller")("noscp",d,b);a.$scope[b]=c}return function(g,h,l,k){var m,p,q;l=!0===l;k&&F(k)&&(q=k);F(g)&&
(k=g.match(c),p=k[1],q=q||k[3],g=b.hasOwnProperty(p)?b[p]:vc(h.$scope,p,!0)||(a?vc(e,p,!0):t),sb(g,p,!0));if(l)return l=(D(g)?g[g.length-1]:g).prototype,m=Object.create(l),q&&f(h,q,m,p||g.name),z(function(){d.invoke(g,m,h,p);return m},{instance:m,identifier:q});m=d.instantiate(g,h,p);q&&f(h,q,m,p||g.name);return m}}]}function Ge(){this.$get=["$window",function(b){return B(b.document)}]}function He(){this.$get=["$log",function(b){return function(a,c){b.error.apply(b,arguments)}}]}function Yb(b,a){if(F(b)){var c=
b.replace(sf,"").trim();if(c){var d=a("Content-Type");(d=d&&0===d.indexOf(Vc))||(d=(d=c.match(tf))&&uf[d[0]].test(c));d&&(b=oc(c))}}return b}function Wc(b){var a=ha(),c,d,e;if(!b)return a;s(b.split("\n"),function(b){e=b.indexOf(":");c=Q(U(b.substr(0,e)));d=U(b.substr(e+1));c&&(a[c]=a[c]?a[c]+", "+d:d)});return a}function Xc(b){var a=I(b)?b:t;return function(c){a||(a=Wc(b));return c?(c=a[Q(c)],void 0===c&&(c=null),c):a}}function Yc(b,a,c,d){if(G(d))return d(b,a,c);s(d,function(d){b=d(b,a,c)});return b}
function Ke(){var b=this.defaults={transformResponse:[Yb],transformRequest:[function(a){return I(a)&&"[object File]"!==Da.call(a)&&"[object Blob]"!==Da.call(a)&&"[object FormData]"!==Da.call(a)?$a(a):a}],headers:{common:{Accept:"application/json, text/plain, */*"},post:ra(Zb),put:ra(Zb),patch:ra(Zb)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},a=!1;this.useApplyAsync=function(b){return y(b)?(a=!!b,this):a};var c=this.interceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory",
"$rootScope","$q","$injector",function(d,e,f,g,h,l){function k(a){function c(a){var b=z({},a);b.data=a.data?Yc(a.data,a.headers,a.status,e.transformResponse):a.data;a=a.status;return 200<=a&&300>a?b:h.reject(b)}function d(a){var b,c={};s(a,function(a,d){G(a)?(b=a(),null!=b&&(c[d]=b)):c[d]=a});return c}if(!ga.isObject(a))throw T("$http")("badreq",a);var e=z({method:"get",transformRequest:b.transformRequest,transformResponse:b.transformResponse},a);e.headers=function(a){var c=b.headers,e=z({},a.headers),
f,g,c=z({},c.common,c[Q(a.method)]);a:for(f in c){a=Q(f);for(g in e)if(Q(g)===a)continue a;e[f]=c[f]}return d(e)}(a);e.method=ub(e.method);var f=[function(a){var d=a.headers,e=Yc(a.data,Xc(d),t,a.transformRequest);A(e)&&s(d,function(a,b){"content-type"===Q(b)&&delete d[b]});A(a.withCredentials)&&!A(b.withCredentials)&&(a.withCredentials=b.withCredentials);return m(a,e).then(c,c)},t],g=h.when(e);for(s(u,function(a){(a.request||a.requestError)&&f.unshift(a.request,a.requestError);(a.response||a.responseError)&&
f.push(a.response,a.responseError)});f.length;){a=f.shift();var l=f.shift(),g=g.then(a,l)}g.success=function(a){g.then(function(b){a(b.data,b.status,b.headers,e)});return g};g.error=function(a){g.then(null,function(b){a(b.data,b.status,b.headers,e)});return g};return g}function m(c,f){function l(b,c,d,e){function f(){m(c,b,d,e)}P&&(200<=b&&300>b?P.put(X,[b,c,Wc(d),e]):P.remove(X));a?g.$applyAsync(f):(f(),g.$$phase||g.$apply())}function m(a,b,d,e){b=Math.max(b,0);(200<=b&&300>b?C.resolve:C.reject)({data:a,
status:b,headers:Xc(d),config:c,statusText:e})}function w(a){m(a.data,a.status,ra(a.headers()),a.statusText)}function u(){var a=k.pendingRequests.indexOf(c);-1!==a&&k.pendingRequests.splice(a,1)}var C=h.defer(),x=C.promise,P,E,s=c.headers,X=p(c.url,c.params);k.pendingRequests.push(c);x.then(u,u);!c.cache&&!b.cache||!1===c.cache||"GET"!==c.method&&"JSONP"!==c.method||(P=I(c.cache)?c.cache:I(b.cache)?b.cache:q);P&&(E=P.get(X),y(E)?E&&G(E.then)?E.then(w,w):D(E)?m(E[1],E[0],ra(E[2]),E[3]):m(E,200,{},
"OK"):P.put(X,x));A(E)&&((E=Zc(c.url)?e.cookies()[c.xsrfCookieName||b.xsrfCookieName]:t)&&(s[c.xsrfHeaderName||b.xsrfHeaderName]=E),d(c.method,X,f,l,s,c.timeout,c.withCredentials,c.responseType));return x}function p(a,b){if(!b)return a;var c=[];Ed(b,function(a,b){null===a||A(a)||(D(a)||(a=[a]),s(a,function(a){I(a)&&(a=qa(a)?a.toISOString():$a(a));c.push(Fa(b)+"="+Fa(a))}))});0<c.length&&(a+=(-1==a.indexOf("?")?"?":"&")+c.join("&"));return a}var q=f("$http"),u=[];s(c,function(a){u.unshift(F(a)?l.get(a):
l.invoke(a))});k.pendingRequests=[];(function(a){s(arguments,function(a){k[a]=function(b,c){return k(z(c||{},{method:a,url:b}))}})})("get","delete","head","jsonp");(function(a){s(arguments,function(a){k[a]=function(b,c,d){return k(z(d||{},{method:a,url:b,data:c}))}})})("post","put","patch");k.defaults=b;return k}]}function vf(){return new M.XMLHttpRequest}function Le(){this.$get=["$browser","$window","$document",function(b,a,c){return wf(b,vf,b.defer,a.angular.callbacks,c[0])}]}function wf(b,a,c,
d,e){function f(a,b,c){var f=e.createElement("script"),m=null;f.type="text/javascript";f.src=a;f.async=!0;m=function(a){f.removeEventListener("load",m,!1);f.removeEventListener("error",m,!1);e.body.removeChild(f);f=null;var g=-1,u="unknown";a&&("load"!==a.type||d[b].called||(a={type:"error"}),u=a.type,g="error"===a.type?404:200);c&&c(g,u)};f.addEventListener("load",m,!1);f.addEventListener("error",m,!1);e.body.appendChild(f);return m}return function(e,h,l,k,m,p,q,u){function r(){v&&v();w&&w.abort()}
function O(a,d,e,f,g){C!==t&&c.cancel(C);v=w=null;a(d,e,f,g);b.$$completeOutstandingRequest(H)}b.$$incOutstandingRequestCount();h=h||b.url();if("jsonp"==Q(e)){var n="_"+(d.counter++).toString(36);d[n]=function(a){d[n].data=a;d[n].called=!0};var v=f(h.replace("JSON_CALLBACK","angular.callbacks."+n),n,function(a,b){O(k,a,d[n].data,"",b);d[n]=H})}else{var w=a();w.open(e,h,!0);s(m,function(a,b){y(a)&&w.setRequestHeader(b,a)});w.onload=function(){var a=w.statusText||"",b="response"in w?w.response:w.responseText,
c=1223===w.status?204:w.status;0===c&&(c=b?200:"file"==Ba(h).protocol?404:0);O(k,c,b,w.getAllResponseHeaders(),a)};e=function(){O(k,-1,null,null,"")};w.onerror=e;w.onabort=e;q&&(w.withCredentials=!0);if(u)try{w.responseType=u}catch(L){if("json"!==u)throw L;}w.send(l||null)}if(0<p)var C=c(r,p);else p&&G(p.then)&&p.then(r)}}function Ie(){var b="{{",a="}}";this.startSymbol=function(a){return a?(b=a,this):b};this.endSymbol=function(b){return b?(a=b,this):a};this.$get=["$parse","$exceptionHandler","$sce",
function(c,d,e){function f(a){return"\\\\\\"+a}function g(f,g,u,r){function O(c){return c.replace(k,b).replace(m,a)}function n(a){try{var b=a;a=u?e.getTrusted(u,b):e.valueOf(b);var c;if(r&&!y(a))c=a;else if(null==a)c="";else{switch(typeof a){case "string":break;case "number":a=""+a;break;default:a=$a(a)}c=a}return c}catch(g){c=$b("interr",f,g.toString()),d(c)}}r=!!r;for(var v,w,L=0,C=[],x=[],P=f.length,E=[],s=[];L<P;)if(-1!=(v=f.indexOf(b,L))&&-1!=(w=f.indexOf(a,v+h)))L!==v&&E.push(O(f.substring(L,
v))),L=f.substring(v+h,w),C.push(L),x.push(c(L,n)),L=w+l,s.push(E.length),E.push("");else{L!==P&&E.push(O(f.substring(L)));break}if(u&&1<E.length)throw $b("noconcat",f);if(!g||C.length){var X=function(a){for(var b=0,c=C.length;b<c;b++){if(r&&A(a[b]))return;E[s[b]]=a[b]}return E.join("")};return z(function(a){var b=0,c=C.length,e=Array(c);try{for(;b<c;b++)e[b]=x[b](a);return X(e)}catch(g){a=$b("interr",f,g.toString()),d(a)}},{exp:f,expressions:C,$$watchDelegate:function(a,b,c){var d;return a.$watchGroup(x,
function(c,e){var f=X(c);G(b)&&b.call(this,f,c!==e?d:f,a);d=f},c)}})}}var h=b.length,l=a.length,k=new RegExp(b.replace(/./g,f),"g"),m=new RegExp(a.replace(/./g,f),"g");g.startSymbol=function(){return b};g.endSymbol=function(){return a};return g}]}function Je(){this.$get=["$rootScope","$window","$q","$$q",function(b,a,c,d){function e(e,h,l,k){var m=a.setInterval,p=a.clearInterval,q=0,u=y(k)&&!k,r=(u?d:c).defer(),O=r.promise;l=y(l)?l:0;O.then(null,null,e);O.$$intervalId=m(function(){r.notify(q++);0<
l&&q>=l&&(r.resolve(q),p(O.$$intervalId),delete f[O.$$intervalId]);u||b.$apply()},h);f[O.$$intervalId]=r;return O}var f={};e.cancel=function(b){return b&&b.$$intervalId in f?(f[b.$$intervalId].reject("canceled"),a.clearInterval(b.$$intervalId),delete f[b.$$intervalId],!0):!1};return e}]}function Rd(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,
maxFrac:2,posPre:"\u00a4",posSuf:"",negPre:"(\u00a4",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January February March April May June July August September October November December".split(" "),SHORTMONTH:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),DAY:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),SHORTDAY:"Sun Mon Tue Wed Thu Fri Sat".split(" "),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a","short":"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",
longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(b){return 1===b?"one":"other"}}}}function ac(b){b=b.split("/");for(var a=b.length;a--;)b[a]=qb(b[a]);return b.join("/")}function $c(b,a){var c=Ba(b);a.$$protocol=c.protocol;a.$$host=c.hostname;a.$$port=ba(c.port)||xf[c.protocol]||null}function ad(b,a){var c="/"!==b.charAt(0);c&&(b="/"+b);var d=Ba(b);a.$$path=decodeURIComponent(c&&"/"===d.pathname.charAt(0)?d.pathname.substring(1):
d.pathname);a.$$search=qc(d.search);a.$$hash=decodeURIComponent(d.hash);a.$$path&&"/"!=a.$$path.charAt(0)&&(a.$$path="/"+a.$$path)}function za(b,a){if(0===a.indexOf(b))return a.substr(b.length)}function Ha(b){var a=b.indexOf("#");return-1==a?b:b.substr(0,a)}function bd(b){return b.replace(/(#.+)|#$/,"$1")}function bc(b){return b.substr(0,Ha(b).lastIndexOf("/")+1)}function cc(b,a){this.$$html5=!0;a=a||"";var c=bc(b);$c(b,this);this.$$parse=function(a){var b=za(c,a);if(!F(b))throw Fb("ipthprfx",a,c);
ad(b,this);this.$$path||(this.$$path="/");this.$$compose()};this.$$compose=function(){var a=Nb(this.$$search),b=this.$$hash?"#"+qb(this.$$hash):"";this.$$url=ac(this.$$path)+(a?"?"+a:"")+b;this.$$absUrl=c+this.$$url.substr(1)};this.$$parseLinkUrl=function(d,e){if(e&&"#"===e[0])return this.hash(e.slice(1)),!0;var f,g;(f=za(b,d))!==t?(g=f,g=(f=za(a,f))!==t?c+(za("/",f)||f):b+g):(f=za(c,d))!==t?g=c+f:c==d+"/"&&(g=c);g&&this.$$parse(g);return!!g}}function dc(b,a){var c=bc(b);$c(b,this);this.$$parse=function(d){d=
za(b,d)||za(c,d);var e;"#"===d.charAt(0)?(e=za(a,d),A(e)&&(e=d)):e=this.$$html5?d:"";ad(e,this);d=this.$$path;var f=/^\/[A-Z]:(\/.*)/;0===e.indexOf(b)&&(e=e.replace(b,""));f.exec(e)||(d=(e=f.exec(d))?e[1]:d);this.$$path=d;this.$$compose()};this.$$compose=function(){var c=Nb(this.$$search),e=this.$$hash?"#"+qb(this.$$hash):"";this.$$url=ac(this.$$path)+(c?"?"+c:"")+e;this.$$absUrl=b+(this.$$url?a+this.$$url:"")};this.$$parseLinkUrl=function(a,c){return Ha(b)==Ha(a)?(this.$$parse(a),!0):!1}}function cd(b,
a){this.$$html5=!0;dc.apply(this,arguments);var c=bc(b);this.$$parseLinkUrl=function(d,e){if(e&&"#"===e[0])return this.hash(e.slice(1)),!0;var f,g;b==Ha(d)?f=d:(g=za(c,d))?f=b+a+g:c===d+"/"&&(f=c);f&&this.$$parse(f);return!!f};this.$$compose=function(){var c=Nb(this.$$search),e=this.$$hash?"#"+qb(this.$$hash):"";this.$$url=ac(this.$$path)+(c?"?"+c:"")+e;this.$$absUrl=b+a+this.$$url}}function Gb(b){return function(){return this[b]}}function dd(b,a){return function(c){if(A(c))return this[b];this[b]=
a(c);this.$$compose();return this}}function Me(){var b="",a={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(a){return y(a)?(b=a,this):b};this.html5Mode=function(b){return Wa(b)?(a.enabled=b,this):I(b)?(Wa(b.enabled)&&(a.enabled=b.enabled),Wa(b.requireBase)&&(a.requireBase=b.requireBase),Wa(b.rewriteLinks)&&(a.rewriteLinks=b.rewriteLinks),this):a};this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function(c,d,e,f,g){function h(a,b,c){var e=k.url(),f=k.$$state;
try{d.url(a,b,c),k.$$state=d.state()}catch(g){throw k.url(e),k.$$state=f,g;}}function l(a,b){c.$broadcast("$locationChangeSuccess",k.absUrl(),a,k.$$state,b)}var k,m;m=d.baseHref();var p=d.url(),q;if(a.enabled){if(!m&&a.requireBase)throw Fb("nobase");q=p.substring(0,p.indexOf("/",p.indexOf("//")+2))+(m||"/");m=e.history?cc:cd}else q=Ha(p),m=dc;k=new m(q,"#"+b);k.$$parseLinkUrl(p,p);k.$$state=d.state();var u=/^\s*(javascript|mailto):/i;f.on("click",function(b){if(a.rewriteLinks&&!b.ctrlKey&&!b.metaKey&&
2!=b.which){for(var e=B(b.target);"a"!==ua(e[0]);)if(e[0]===f[0]||!(e=e.parent())[0])return;var h=e.prop("href"),l=e.attr("href")||e.attr("xlink:href");I(h)&&"[object SVGAnimatedString]"===h.toString()&&(h=Ba(h.animVal).href);u.test(h)||!h||e.attr("target")||b.isDefaultPrevented()||!k.$$parseLinkUrl(h,l)||(b.preventDefault(),k.absUrl()!=d.url()&&(c.$apply(),g.angular["ff-684208-preventDefault"]=!0))}});k.absUrl()!=p&&d.url(k.absUrl(),!0);var r=!0;d.onUrlChange(function(a,b){c.$evalAsync(function(){var d=
k.absUrl(),e=k.$$state,f;k.$$parse(a);k.$$state=b;f=c.$broadcast("$locationChangeStart",a,d,b,e).defaultPrevented;k.absUrl()===a&&(f?(k.$$parse(d),k.$$state=e,h(d,!1,e)):(r=!1,l(d,e)))});c.$$phase||c.$digest()});c.$watch(function(){var a=bd(d.url()),b=bd(k.absUrl()),f=d.state(),g=k.$$replace,q=a!==b||k.$$html5&&e.history&&f!==k.$$state;if(r||q)r=!1,c.$evalAsync(function(){var b=k.absUrl(),d=c.$broadcast("$locationChangeStart",b,a,k.$$state,f).defaultPrevented;k.absUrl()===b&&(d?(k.$$parse(a),k.$$state=
f):(q&&h(b,g,f===k.$$state?null:k.$$state),l(a,f)))});k.$$replace=!1});return k}]}function Ne(){var b=!0,a=this;this.debugEnabled=function(a){return y(a)?(b=a,this):b};this.$get=["$window",function(c){function d(a){a instanceof Error&&(a.stack?a=a.message&&-1===a.stack.indexOf(a.message)?"Error: "+a.message+"\n"+a.stack:a.stack:a.sourceURL&&(a=a.message+"\n"+a.sourceURL+":"+a.line));return a}function e(a){var b=c.console||{},e=b[a]||b.log||H;a=!1;try{a=!!e.apply}catch(l){}return a?function(){var a=
[];s(arguments,function(b){a.push(d(b))});return e.apply(b,a)}:function(a,b){e(a,null==b?"":b)}}return{log:e("log"),info:e("info"),warn:e("warn"),error:e("error"),debug:function(){var c=e("debug");return function(){b&&c.apply(a,arguments)}}()}}]}function ta(b,a){if("__defineGetter__"===b||"__defineSetter__"===b||"__lookupGetter__"===b||"__lookupSetter__"===b||"__proto__"===b)throw la("isecfld",a);return b}function ma(b,a){if(b){if(b.constructor===b)throw la("isecfn",a);if(b.window===b)throw la("isecwindow",
a);if(b.children&&(b.nodeName||b.prop&&b.attr&&b.find))throw la("isecdom",a);if(b===Object)throw la("isecobj",a);}return b}function ec(b){return b.constant}function gb(b,a,c,d,e){ma(b,e);ma(a,e);c=c.split(".");for(var f,g=0;1<c.length;g++){f=ta(c.shift(),e);var h=0===g&&a&&a[f]||b[f];h||(h={},b[f]=h);b=ma(h,e)}f=ta(c.shift(),e);ma(b[f],e);return b[f]=d}function Qa(b){return"constructor"==b}function ed(b,a,c,d,e,f,g){ta(b,f);ta(a,f);ta(c,f);ta(d,f);ta(e,f);var h=function(a){return ma(a,f)},l=g||Qa(b)?
h:pa,k=g||Qa(a)?h:pa,m=g||Qa(c)?h:pa,p=g||Qa(d)?h:pa,q=g||Qa(e)?h:pa;return function(f,g){var h=g&&g.hasOwnProperty(b)?g:f;if(null==h)return h;h=l(h[b]);if(!a)return h;if(null==h)return t;h=k(h[a]);if(!c)return h;if(null==h)return t;h=m(h[c]);if(!d)return h;if(null==h)return t;h=p(h[d]);return e?null==h?t:h=q(h[e]):h}}function yf(b,a){return function(c,d){return b(c,d,ma,a)}}function zf(b,a,c){var d=a.expensiveChecks,e=d?Af:Bf,f=e[b];if(f)return f;var g=b.split("."),h=g.length;if(a.csp)f=6>h?ed(g[0],
g[1],g[2],g[3],g[4],c,d):function(a,b){var e=0,f;do f=ed(g[e++],g[e++],g[e++],g[e++],g[e++],c,d)(a,b),b=t,a=f;while(e<h);return f};else{var l="";d&&(l+="s = eso(s, fe);\nl = eso(l, fe);\n");var k=d;s(g,function(a,b){ta(a,c);var e=(b?"s":'((l&&l.hasOwnProperty("'+a+'"))?l:s)')+"."+a;if(d||Qa(a))e="eso("+e+", fe)",k=!0;l+="if(s == null) return undefined;\ns="+e+";\n"});l+="return s;";a=new Function("s","l","eso","fe",l);a.toString=da(l);k&&(a=yf(a,c));f=a}f.sharedGetter=!0;f.assign=function(a,c,d){return gb(a,
d,b,c,b)};return e[b]=f}function fc(b){return G(b.valueOf)?b.valueOf():Cf.call(b)}function Oe(){var b=ha(),a=ha();this.$get=["$filter","$sniffer",function(c,d){function e(a){var b=a;a.sharedGetter&&(b=function(b,c){return a(b,c)},b.literal=a.literal,b.constant=a.constant,b.assign=a.assign);return b}function f(a,b){for(var c=0,d=a.length;c<d;c++){var e=a[c];e.constant||(e.inputs?f(e.inputs,b):-1===b.indexOf(e)&&b.push(e))}return b}function g(a,b){return null==a||null==b?a===b:"object"===typeof a&&
(a=fc(a),"object"===typeof a)?!1:a===b||a!==a&&b!==b}function h(a,b,c,d){var e=d.$$inputs||(d.$$inputs=f(d.inputs,[])),h;if(1===e.length){var l=g,e=e[0];return a.$watch(function(a){var b=e(a);g(b,l)||(h=d(a),l=b&&fc(b));return h},b,c)}for(var k=[],q=0,p=e.length;q<p;q++)k[q]=g;return a.$watch(function(a){for(var b=!1,c=0,f=e.length;c<f;c++){var l=e[c](a);if(b||(b=!g(l,k[c])))k[c]=l&&fc(l)}b&&(h=d(a));return h},b,c)}function l(a,b,c,d){var e,f;return e=a.$watch(function(a){return d(a)},function(a,
c,d){f=a;G(b)&&b.apply(this,arguments);y(a)&&d.$$postDigest(function(){y(f)&&e()})},c)}function k(a,b,c,d){function e(a){var b=!0;s(a,function(a){y(a)||(b=!1)});return b}var f,g;return f=a.$watch(function(a){return d(a)},function(a,c,d){g=a;G(b)&&b.call(this,a,c,d);e(a)&&d.$$postDigest(function(){e(g)&&f()})},c)}function m(a,b,c,d){var e;return e=a.$watch(function(a){return d(a)},function(a,c,d){G(b)&&b.apply(this,arguments);e()},c)}function p(a,b){if(!b)return a;var c=a.$$watchDelegate,c=c!==k&&
c!==l?function(c,d){var e=a(c,d);return b(e,c,d)}:function(c,d){var e=a(c,d),f=b(e,c,d);return y(e)?f:e};a.$$watchDelegate&&a.$$watchDelegate!==h?c.$$watchDelegate=a.$$watchDelegate:b.$stateful||(c.$$watchDelegate=h,c.inputs=[a]);return c}var q={csp:d.csp,expensiveChecks:!1},u={csp:d.csp,expensiveChecks:!0};return function(d,f,g){var v,w,L;switch(typeof d){case "string":L=d=d.trim();var C=g?a:b;v=C[L];v||(":"===d.charAt(0)&&":"===d.charAt(1)&&(w=!0,d=d.substring(2)),g=g?u:q,v=new gc(g),v=(new hb(v,
c,g)).parse(d),v.constant?v.$$watchDelegate=m:w?(v=e(v),v.$$watchDelegate=v.literal?k:l):v.inputs&&(v.$$watchDelegate=h),C[L]=v);return p(v,f);case "function":return p(d,f);default:return p(H,f)}}}]}function Qe(){this.$get=["$rootScope","$exceptionHandler",function(b,a){return fd(function(a){b.$evalAsync(a)},a)}]}function Re(){this.$get=["$browser","$exceptionHandler",function(b,a){return fd(function(a){b.defer(a)},a)}]}function fd(b,a){function c(a,b,c){function d(b){return function(c){e||(e=!0,
b.call(a,c))}}var e=!1;return[d(b),d(c)]}function d(){this.$$state={status:0}}function e(a,b){return function(c){b.call(a,c)}}function f(c){!c.processScheduled&&c.pending&&(c.processScheduled=!0,b(function(){var b,d,e;e=c.pending;c.processScheduled=!1;c.pending=t;for(var f=0,g=e.length;f<g;++f){d=e[f][0];b=e[f][c.status];try{G(b)?d.resolve(b(c.value)):1===c.status?d.resolve(c.value):d.reject(c.value)}catch(h){d.reject(h),a(h)}}}))}function g(){this.promise=new d;this.resolve=e(this,this.resolve);
this.reject=e(this,this.reject);this.notify=e(this,this.notify)}var h=T("$q",TypeError);d.prototype={then:function(a,b,c){var d=new g;this.$$state.pending=this.$$state.pending||[];this.$$state.pending.push([d,a,b,c]);0<this.$$state.status&&f(this.$$state);return d.promise},"catch":function(a){return this.then(null,a)},"finally":function(a,b){return this.then(function(b){return k(b,!0,a)},function(b){return k(b,!1,a)},b)}};g.prototype={resolve:function(a){this.promise.$$state.status||(a===this.promise?
this.$$reject(h("qcycle",a)):this.$$resolve(a))},$$resolve:function(b){var d,e;e=c(this,this.$$resolve,this.$$reject);try{if(I(b)||G(b))d=b&&b.then;G(d)?(this.promise.$$state.status=-1,d.call(b,e[0],e[1],this.notify)):(this.promise.$$state.value=b,this.promise.$$state.status=1,f(this.promise.$$state))}catch(g){e[1](g),a(g)}},reject:function(a){this.promise.$$state.status||this.$$reject(a)},$$reject:function(a){this.promise.$$state.value=a;this.promise.$$state.status=2;f(this.promise.$$state)},notify:function(c){var d=
this.promise.$$state.pending;0>=this.promise.$$state.status&&d&&d.length&&b(function(){for(var b,e,f=0,g=d.length;f<g;f++){e=d[f][0];b=d[f][3];try{e.notify(G(b)?b(c):c)}catch(h){a(h)}}})}};var l=function(a,b){var c=new g;b?c.resolve(a):c.reject(a);return c.promise},k=function(a,b,c){var d=null;try{G(c)&&(d=c())}catch(e){return l(e,!1)}return d&&G(d.then)?d.then(function(){return l(a,b)},function(a){return l(a,!1)}):l(a,b)},m=function(a,b,c,d){var e=new g;e.resolve(a);return e.promise.then(b,c,d)},
p=function u(a){if(!G(a))throw h("norslvr",a);if(!(this instanceof u))return new u(a);var b=new g;a(function(a){b.resolve(a)},function(a){b.reject(a)});return b.promise};p.defer=function(){return new g};p.reject=function(a){var b=new g;b.reject(a);return b.promise};p.when=m;p.all=function(a){var b=new g,c=0,d=D(a)?[]:{};s(a,function(a,e){c++;m(a).then(function(a){d.hasOwnProperty(e)||(d[e]=a,--c||b.resolve(d))},function(a){d.hasOwnProperty(e)||b.reject(a)})});0===c&&b.resolve(d);return b.promise};
return p}function $e(){this.$get=["$window","$timeout",function(b,a){var c=b.requestAnimationFrame||b.webkitRequestAnimationFrame,d=b.cancelAnimationFrame||b.webkitCancelAnimationFrame||b.webkitCancelRequestAnimationFrame,e=!!c,f=e?function(a){var b=c(a);return function(){d(b)}}:function(b){var c=a(b,16.66,!1);return function(){a.cancel(c)}};f.supported=e;return f}]}function Pe(){var b=10,a=T("$rootScope"),c=null,d=null;this.digestTtl=function(a){arguments.length&&(b=a);return b};this.$get=["$injector",
"$exceptionHandler","$parse","$browser",function(e,f,g,h){function l(){this.$id=++nb;this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null;this.$root=this;this.$$destroyed=!1;this.$$listeners={};this.$$listenerCount={};this.$$isolateBindings=null}function k(b){if(r.$$phase)throw a("inprog",r.$$phase);r.$$phase=b}function m(a,b,c){do a.$$listenerCount[c]-=b,0===a.$$listenerCount[c]&&delete a.$$listenerCount[c];while(a=a.$parent)}function p(){}
function q(){for(;v.length;)try{v.shift()()}catch(a){f(a)}d=null}function u(){null===d&&(d=h.defer(function(){r.$apply(q)}))}l.prototype={constructor:l,$new:function(a,b){function c(){d.$$destroyed=!0}var d;b=b||this;a?(d=new l,d.$root=this.$root):(this.$$ChildScope||(this.$$ChildScope=function(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null;this.$$listeners={};this.$$listenerCount={};this.$id=++nb;this.$$ChildScope=null},this.$$ChildScope.prototype=this),d=new this.$$ChildScope);
d.$parent=b;d.$$prevSibling=b.$$childTail;b.$$childHead?(b.$$childTail.$$nextSibling=d,b.$$childTail=d):b.$$childHead=b.$$childTail=d;(a||b!=this)&&d.$on("$destroy",c);return d},$watch:function(a,b,d){var e=g(a);if(e.$$watchDelegate)return e.$$watchDelegate(this,b,d,e);var f=this.$$watchers,h={fn:b,last:p,get:e,exp:a,eq:!!d};c=null;G(b)||(h.fn=H);f||(f=this.$$watchers=[]);f.unshift(h);return function(){Xa(f,h);c=null}},$watchGroup:function(a,b){function c(){h=!1;l?(l=!1,b(e,e,g)):b(e,d,g)}var d=Array(a.length),
e=Array(a.length),f=[],g=this,h=!1,l=!0;if(!a.length){var k=!0;g.$evalAsync(function(){k&&b(e,e,g)});return function(){k=!1}}if(1===a.length)return this.$watch(a[0],function(a,c,f){e[0]=a;d[0]=c;b(e,a===c?e:d,f)});s(a,function(a,b){var l=g.$watch(a,function(a,f){e[b]=a;d[b]=f;h||(h=!0,g.$evalAsync(c))});f.push(l)});return function(){for(;f.length;)f.shift()()}},$watchCollection:function(a,b){function c(a){e=a;var b,d,g,h;if(!A(e)){if(I(e))if(Ta(e))for(f!==q&&(f=q,u=f.length=0,k++),a=e.length,u!==
a&&(k++,f.length=u=a),b=0;b<a;b++)h=f[b],g=e[b],d=h!==h&&g!==g,d||h===g||(k++,f[b]=g);else{f!==m&&(f=m={},u=0,k++);a=0;for(b in e)e.hasOwnProperty(b)&&(a++,g=e[b],h=f[b],b in f?(d=h!==h&&g!==g,d||h===g||(k++,f[b]=g)):(u++,f[b]=g,k++));if(u>a)for(b in k++,f)e.hasOwnProperty(b)||(u--,delete f[b])}else f!==e&&(f=e,k++);return k}}c.$stateful=!0;var d=this,e,f,h,l=1<b.length,k=0,p=g(a,c),q=[],m={},n=!0,u=0;return this.$watch(p,function(){n?(n=!1,b(e,e,d)):b(e,h,d);if(l)if(I(e))if(Ta(e)){h=Array(e.length);
for(var a=0;a<e.length;a++)h[a]=e[a]}else for(a in h={},e)rc.call(e,a)&&(h[a]=e[a]);else h=e})},$digest:function(){var e,g,l,m,u,v,s=b,t,W=[],y,J;k("$digest");h.$$checkUrlChange();this===r&&null!==d&&(h.defer.cancel(d),q());c=null;do{v=!1;for(t=this;O.length;){try{J=O.shift(),J.scope.$eval(J.expression,J.locals)}catch(B){f(B)}c=null}a:do{if(m=t.$$watchers)for(u=m.length;u--;)try{if(e=m[u])if((g=e.get(t))!==(l=e.last)&&!(e.eq?fa(g,l):"number"===typeof g&&"number"===typeof l&&isNaN(g)&&isNaN(l)))v=
!0,c=e,e.last=e.eq?Ea(g,null):g,e.fn(g,l===p?g:l,t),5>s&&(y=4-s,W[y]||(W[y]=[]),W[y].push({msg:G(e.exp)?"fn: "+(e.exp.name||e.exp.toString()):e.exp,newVal:g,oldVal:l}));else if(e===c){v=!1;break a}}catch(A){f(A)}if(!(m=t.$$childHead||t!==this&&t.$$nextSibling))for(;t!==this&&!(m=t.$$nextSibling);)t=t.$parent}while(t=m);if((v||O.length)&&!s--)throw r.$$phase=null,a("infdig",b,W);}while(v||O.length);for(r.$$phase=null;n.length;)try{n.shift()()}catch(ca){f(ca)}},$destroy:function(){if(!this.$$destroyed){var a=
this.$parent;this.$broadcast("$destroy");this.$$destroyed=!0;if(this!==r){for(var b in this.$$listenerCount)m(this,this.$$listenerCount[b],b);a.$$childHead==this&&(a.$$childHead=this.$$nextSibling);a.$$childTail==this&&(a.$$childTail=this.$$prevSibling);this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling);this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling);this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=H;this.$on=this.$watch=this.$watchGroup=
function(){return H};this.$$listeners={};this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=this.$$watchers=null}}},$eval:function(a,b){return g(a)(this,b)},$evalAsync:function(a,b){r.$$phase||O.length||h.defer(function(){O.length&&r.$digest()});O.push({scope:this,expression:a,locals:b})},$$postDigest:function(a){n.push(a)},$apply:function(a){try{return k("$apply"),this.$eval(a)}catch(b){f(b)}finally{r.$$phase=null;try{r.$digest()}catch(c){throw f(c),c;
}}},$applyAsync:function(a){function b(){c.$eval(a)}var c=this;a&&v.push(b);u()},$on:function(a,b){var c=this.$$listeners[a];c||(this.$$listeners[a]=c=[]);c.push(b);var d=this;do d.$$listenerCount[a]||(d.$$listenerCount[a]=0),d.$$listenerCount[a]++;while(d=d.$parent);var e=this;return function(){var d=c.indexOf(b);-1!==d&&(c[d]=null,m(e,1,a))}},$emit:function(a,b){var c=[],d,e=this,g=!1,h={name:a,targetScope:e,stopPropagation:function(){g=!0},preventDefault:function(){h.defaultPrevented=!0},defaultPrevented:!1},
l=Ya([h],arguments,1),k,p;do{d=e.$$listeners[a]||c;h.currentScope=e;k=0;for(p=d.length;k<p;k++)if(d[k])try{d[k].apply(null,l)}catch(m){f(m)}else d.splice(k,1),k--,p--;if(g)return h.currentScope=null,h;e=e.$parent}while(e);h.currentScope=null;return h},$broadcast:function(a,b){var c=this,d=this,e={name:a,targetScope:this,preventDefault:function(){e.defaultPrevented=!0},defaultPrevented:!1};if(!this.$$listenerCount[a])return e;for(var g=Ya([e],arguments,1),h,l;c=d;){e.currentScope=c;d=c.$$listeners[a]||
[];h=0;for(l=d.length;h<l;h++)if(d[h])try{d[h].apply(null,g)}catch(k){f(k)}else d.splice(h,1),h--,l--;if(!(d=c.$$listenerCount[a]&&c.$$childHead||c!==this&&c.$$nextSibling))for(;c!==this&&!(d=c.$$nextSibling);)c=c.$parent}e.currentScope=null;return e}};var r=new l,O=r.$$asyncQueue=[],n=r.$$postDigestQueue=[],v=r.$$applyAsyncQueue=[];return r}]}function Sd(){var b=/^\s*(https?|ftp|mailto|tel|file):/,a=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(a){return y(a)?
(b=a,this):b};this.imgSrcSanitizationWhitelist=function(b){return y(b)?(a=b,this):a};this.$get=function(){return function(c,d){var e=d?a:b,f;f=Ba(c).href;return""===f||f.match(e)?c:"unsafe:"+f}}}function Df(b){if("self"===b)return b;if(F(b)){if(-1<b.indexOf("***"))throw Ca("iwcard",b);b=gd(b).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*");return new RegExp("^"+b+"$")}if(ob(b))return new RegExp("^"+b.source+"$");throw Ca("imatcher");}function hd(b){var a=[];y(b)&&s(b,function(b){a.push(Df(b))});
return a}function Te(){this.SCE_CONTEXTS=na;var b=["self"],a=[];this.resourceUrlWhitelist=function(a){arguments.length&&(b=hd(a));return b};this.resourceUrlBlacklist=function(b){arguments.length&&(a=hd(b));return a};this.$get=["$injector",function(c){function d(a,b){return"self"===a?Zc(b):!!a.exec(b.href)}function e(a){var b=function(a){this.$$unwrapTrustedValue=function(){return a}};a&&(b.prototype=new a);b.prototype.valueOf=function(){return this.$$unwrapTrustedValue()};b.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()};
return b}var f=function(a){throw Ca("unsafe");};c.has("$sanitize")&&(f=c.get("$sanitize"));var g=e(),h={};h[na.HTML]=e(g);h[na.CSS]=e(g);h[na.URL]=e(g);h[na.JS]=e(g);h[na.RESOURCE_URL]=e(h[na.URL]);return{trustAs:function(a,b){var c=h.hasOwnProperty(a)?h[a]:null;if(!c)throw Ca("icontext",a,b);if(null===b||b===t||""===b)return b;if("string"!==typeof b)throw Ca("itype",a);return new c(b)},getTrusted:function(c,e){if(null===e||e===t||""===e)return e;var g=h.hasOwnProperty(c)?h[c]:null;if(g&&e instanceof
g)return e.$$unwrapTrustedValue();if(c===na.RESOURCE_URL){var g=Ba(e.toString()),p,q,u=!1;p=0;for(q=b.length;p<q;p++)if(d(b[p],g)){u=!0;break}if(u)for(p=0,q=a.length;p<q;p++)if(d(a[p],g)){u=!1;break}if(u)return e;throw Ca("insecurl",e.toString());}if(c===na.HTML)return f(e);throw Ca("unsafe");},valueOf:function(a){return a instanceof g?a.$$unwrapTrustedValue():a}}}]}function Se(){var b=!0;this.enabled=function(a){arguments.length&&(b=!!a);return b};this.$get=["$parse","$sceDelegate",function(a,c){if(b&&
8>Ra)throw Ca("iequirks");var d=ra(na);d.isEnabled=function(){return b};d.trustAs=c.trustAs;d.getTrusted=c.getTrusted;d.valueOf=c.valueOf;b||(d.trustAs=d.getTrusted=function(a,b){return b},d.valueOf=pa);d.parseAs=function(b,c){var e=a(c);return e.literal&&e.constant?e:a(c,function(a){return d.getTrusted(b,a)})};var e=d.parseAs,f=d.getTrusted,g=d.trustAs;s(na,function(a,b){var c=Q(b);d[cb("parse_as_"+c)]=function(b){return e(a,b)};d[cb("get_trusted_"+c)]=function(b){return f(a,b)};d[cb("trust_as_"+
c)]=function(b){return g(a,b)}});return d}]}function Ue(){this.$get=["$window","$document",function(b,a){var c={},d=ba((/android (\d+)/.exec(Q((b.navigator||{}).userAgent))||[])[1]),e=/Boxee/i.test((b.navigator||{}).userAgent),f=a[0]||{},g,h=/^(Moz|webkit|ms)(?=[A-Z])/,l=f.body&&f.body.style,k=!1,m=!1;if(l){for(var p in l)if(k=h.exec(p)){g=k[0];g=g.substr(0,1).toUpperCase()+g.substr(1);break}g||(g="WebkitOpacity"in l&&"webkit");k=!!("transition"in l||g+"Transition"in l);m=!!("animation"in l||g+"Animation"in
l);!d||k&&m||(k=F(f.body.style.webkitTransition),m=F(f.body.style.webkitAnimation))}return{history:!(!b.history||!b.history.pushState||4>d||e),hasEvent:function(a){if("input"===a&&11>=Ra)return!1;if(A(c[a])){var b=f.createElement("div");c[a]="on"+a in b}return c[a]},csp:ab(),vendorPrefix:g,transitions:k,animations:m,android:d}}]}function We(){this.$get=["$templateCache","$http","$q",function(b,a,c){function d(e,f){d.totalPendingRequests++;var g=a.defaults&&a.defaults.transformResponse;D(g)?g=g.filter(function(a){return a!==
Yb}):g===Yb&&(g=null);return a.get(e,{cache:b,transformResponse:g}).then(function(a){d.totalPendingRequests--;return a.data},function(a){d.totalPendingRequests--;if(!f)throw ja("tpload",e);return c.reject(a)})}d.totalPendingRequests=0;return d}]}function Xe(){this.$get=["$rootScope","$browser","$location",function(b,a,c){return{findBindings:function(a,b,c){a=a.getElementsByClassName("ng-binding");var g=[];s(a,function(a){var d=ga.element(a).data("$binding");d&&s(d,function(d){c?(new RegExp("(^|\\s)"+
gd(b)+"(\\s|\\||$)")).test(d)&&g.push(a):-1!=d.indexOf(b)&&g.push(a)})});return g},findModels:function(a,b,c){for(var g=["ng-","data-ng-","ng\\:"],h=0;h<g.length;++h){var l=a.querySelectorAll("["+g[h]+"model"+(c?"=":"*=")+'"'+b+'"]');if(l.length)return l}},getLocation:function(){return c.url()},setLocation:function(a){a!==c.url()&&(c.url(a),b.$digest())},whenStable:function(b){a.notifyWhenNoOutstandingRequests(b)}}}]}function Ye(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",
function(b,a,c,d,e){function f(f,l,k){var m=y(k)&&!k,p=(m?d:c).defer(),q=p.promise;l=a.defer(function(){try{p.resolve(f())}catch(a){p.reject(a),e(a)}finally{delete g[q.$$timeoutId]}m||b.$apply()},l);q.$$timeoutId=l;g[l]=p;return q}var g={};f.cancel=function(b){return b&&b.$$timeoutId in g?(g[b.$$timeoutId].reject("canceled"),delete g[b.$$timeoutId],a.defer.cancel(b.$$timeoutId)):!1};return f}]}function Ba(b){Ra&&(Z.setAttribute("href",b),b=Z.href);Z.setAttribute("href",b);return{href:Z.href,protocol:Z.protocol?
Z.protocol.replace(/:$/,""):"",host:Z.host,search:Z.search?Z.search.replace(/^\?/,""):"",hash:Z.hash?Z.hash.replace(/^#/,""):"",hostname:Z.hostname,port:Z.port,pathname:"/"===Z.pathname.charAt(0)?Z.pathname:"/"+Z.pathname}}function Zc(b){b=F(b)?Ba(b):b;return b.protocol===id.protocol&&b.host===id.host}function Ze(){this.$get=da(M)}function Dc(b){function a(c,d){if(I(c)){var e={};s(c,function(b,c){e[c]=a(c,b)});return e}return b.factory(c+"Filter",d)}this.register=a;this.$get=["$injector",function(a){return function(b){return a.get(b+
"Filter")}}];a("currency",jd);a("date",kd);a("filter",Ef);a("json",Ff);a("limitTo",Gf);a("lowercase",Hf);a("number",ld);a("orderBy",md);a("uppercase",If)}function Ef(){return function(b,a,c){if(!D(b))return b;var d;switch(typeof a){case "function":break;case "boolean":case "number":case "string":d=!0;case "object":a=Jf(a,c,d);break;default:return b}return b.filter(a)}}function Jf(b,a,c){var d=I(b)&&"$"in b;!0===a?a=fa:G(a)||(a=function(a,b){if(I(a)||I(b))return!1;a=Q(""+a);b=Q(""+b);return-1!==a.indexOf(b)});
return function(e){return d&&!I(e)?Ia(e,b.$,a,!1):Ia(e,b,a,c)}}function Ia(b,a,c,d,e){var f=typeof b,g=typeof a;if("string"===g&&"!"===a.charAt(0))return!Ia(b,a.substring(1),c,d);if(D(b))return b.some(function(b){return Ia(b,a,c,d)});switch(f){case "object":var h;if(d){for(h in b)if("$"!==h.charAt(0)&&Ia(b[h],a,c,!0))return!0;return e?!1:Ia(b,a,c,!1)}if("object"===g){for(h in a)if(e=a[h],!G(e)&&(f="$"===h,!Ia(f?b:b[h],e,c,f,f)))return!1;return!0}return c(b,a);case "function":return!1;default:return c(b,
a)}}function jd(b){var a=b.NUMBER_FORMATS;return function(b,d,e){A(d)&&(d=a.CURRENCY_SYM);A(e)&&(e=a.PATTERNS[1].maxFrac);return null==b?b:nd(b,a.PATTERNS[1],a.GROUP_SEP,a.DECIMAL_SEP,e).replace(/\u00A4/g,d)}}function ld(b){var a=b.NUMBER_FORMATS;return function(b,d){return null==b?b:nd(b,a.PATTERNS[0],a.GROUP_SEP,a.DECIMAL_SEP,d)}}function nd(b,a,c,d,e){if(!isFinite(b)||I(b))return"";var f=0>b;b=Math.abs(b);var g=b+"",h="",l=[],k=!1;if(-1!==g.indexOf("e")){var m=g.match(/([\d\.]+)e(-?)(\d+)/);m&&
"-"==m[2]&&m[3]>e+1?b=0:(h=g,k=!0)}if(k)0<e&&1>b&&(h=b.toFixed(e),b=parseFloat(h));else{g=(g.split(od)[1]||"").length;A(e)&&(e=Math.min(Math.max(a.minFrac,g),a.maxFrac));b=+(Math.round(+(b.toString()+"e"+e)).toString()+"e"+-e);var g=(""+b).split(od),k=g[0],g=g[1]||"",p=0,q=a.lgSize,u=a.gSize;if(k.length>=q+u)for(p=k.length-q,m=0;m<p;m++)0===(p-m)%u&&0!==m&&(h+=c),h+=k.charAt(m);for(m=p;m<k.length;m++)0===(k.length-m)%q&&0!==m&&(h+=c),h+=k.charAt(m);for(;g.length<e;)g+="0";e&&"0"!==e&&(h+=d+g.substr(0,
e))}0===b&&(f=!1);l.push(f?a.negPre:a.posPre,h,f?a.negSuf:a.posSuf);return l.join("")}function Hb(b,a,c){var d="";0>b&&(d="-",b=-b);for(b=""+b;b.length<a;)b="0"+b;c&&(b=b.substr(b.length-a));return d+b}function $(b,a,c,d){c=c||0;return function(e){e=e["get"+b]();if(0<c||e>-c)e+=c;0===e&&-12==c&&(e=12);return Hb(e,a,d)}}function Ib(b,a){return function(c,d){var e=c["get"+b](),f=ub(a?"SHORT"+b:b);return d[f][e]}}function pd(b){var a=(new Date(b,0,1)).getDay();return new Date(b,0,(4>=a?5:12)-a)}function qd(b){return function(a){var c=
pd(a.getFullYear());a=+new Date(a.getFullYear(),a.getMonth(),a.getDate()+(4-a.getDay()))-+c;a=1+Math.round(a/6048E5);return Hb(a,b)}}function kd(b){function a(a){var b;if(b=a.match(c)){a=new Date(0);var f=0,g=0,h=b[8]?a.setUTCFullYear:a.setFullYear,l=b[8]?a.setUTCHours:a.setHours;b[9]&&(f=ba(b[9]+b[10]),g=ba(b[9]+b[11]));h.call(a,ba(b[1]),ba(b[2])-1,ba(b[3]));f=ba(b[4]||0)-f;g=ba(b[5]||0)-g;h=ba(b[6]||0);b=Math.round(1E3*parseFloat("0."+(b[7]||0)));l.call(a,f,g,h,b)}return a}var c=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;
return function(c,e,f){var g="",h=[],l,k;e=e||"mediumDate";e=b.DATETIME_FORMATS[e]||e;F(c)&&(c=Kf.test(c)?ba(c):a(c));V(c)&&(c=new Date(c));if(!qa(c))return c;for(;e;)(k=Lf.exec(e))?(h=Ya(h,k,1),e=h.pop()):(h.push(e),e=null);f&&"UTC"===f&&(c=new Date(c.getTime()),c.setMinutes(c.getMinutes()+c.getTimezoneOffset()));s(h,function(a){l=Mf[a];g+=l?l(c,b.DATETIME_FORMATS):a.replace(/(^'|'$)/g,"").replace(/''/g,"'")});return g}}function Ff(){return function(b,a){A(a)&&(a=2);return $a(b,a)}}function Gf(){return function(b,
a){V(b)&&(b=b.toString());return D(b)||F(b)?(a=Infinity===Math.abs(Number(a))?Number(a):ba(a))?0<a?b.slice(0,a):b.slice(a):F(b)?"":[]:b}}function md(b){return function(a,c,d){function e(a,b){return b?function(b,c){return a(c,b)}:a}function f(a){switch(typeof a){case "number":case "boolean":case "string":return!0;default:return!1}}function g(a){return null===a?"null":"function"===typeof a.valueOf&&(a=a.valueOf(),f(a))||"function"===typeof a.toString&&(a=a.toString(),f(a))?a:""}function h(a,b){var c=
typeof a,d=typeof b;c===d&&"object"===c&&(a=g(a),b=g(b));return c===d?("string"===c&&(a=a.toLowerCase(),b=b.toLowerCase()),a===b?0:a<b?-1:1):c<d?-1:1}if(!Ta(a))return a;c=D(c)?c:[c];0===c.length&&(c=["+"]);c=c.map(function(a){var c=!1,d=a||pa;if(F(a)){if("+"==a.charAt(0)||"-"==a.charAt(0))c="-"==a.charAt(0),a=a.substring(1);if(""===a)return e(h,c);d=b(a);if(d.constant){var f=d();return e(function(a,b){return h(a[f],b[f])},c)}}return e(function(a,b){return h(d(a),d(b))},c)});return Za.call(a).sort(e(function(a,
b){for(var d=0;d<c.length;d++){var e=c[d](a,b);if(0!==e)return e}return 0},d))}}function Ja(b){G(b)&&(b={link:b});b.restrict=b.restrict||"AC";return da(b)}function rd(b,a,c,d,e){var f=this,g=[],h=f.$$parentForm=b.parent().controller("form")||Jb;f.$error={};f.$$success={};f.$pending=t;f.$name=e(a.name||a.ngForm||"")(c);f.$dirty=!1;f.$pristine=!0;f.$valid=!0;f.$invalid=!1;f.$submitted=!1;h.$addControl(f);f.$rollbackViewValue=function(){s(g,function(a){a.$rollbackViewValue()})};f.$commitViewValue=function(){s(g,
function(a){a.$commitViewValue()})};f.$addControl=function(a){Ma(a.$name,"input");g.push(a);a.$name&&(f[a.$name]=a)};f.$$renameControl=function(a,b){var c=a.$name;f[c]===a&&delete f[c];f[b]=a;a.$name=b};f.$removeControl=function(a){a.$name&&f[a.$name]===a&&delete f[a.$name];s(f.$pending,function(b,c){f.$setValidity(c,null,a)});s(f.$error,function(b,c){f.$setValidity(c,null,a)});Xa(g,a)};sd({ctrl:this,$element:b,set:function(a,b,c){var d=a[b];d?-1===d.indexOf(c)&&d.push(c):a[b]=[c]},unset:function(a,
b,c){var d=a[b];d&&(Xa(d,c),0===d.length&&delete a[b])},parentForm:h,$animate:d});f.$setDirty=function(){d.removeClass(b,Sa);d.addClass(b,Kb);f.$dirty=!0;f.$pristine=!1;h.$setDirty()};f.$setPristine=function(){d.setClass(b,Sa,Kb+" ng-submitted");f.$dirty=!1;f.$pristine=!0;f.$submitted=!1;s(g,function(a){a.$setPristine()})};f.$setUntouched=function(){s(g,function(a){a.$setUntouched()})};f.$setSubmitted=function(){d.addClass(b,"ng-submitted");f.$submitted=!0;h.$setSubmitted()}}function hc(b){b.$formatters.push(function(a){return b.$isEmpty(a)?
a:a.toString()})}function ib(b,a,c,d,e,f){var g=Q(a[0].type);if(!e.android){var h=!1;a.on("compositionstart",function(a){h=!0});a.on("compositionend",function(){h=!1;l()})}var l=function(b){k&&(f.defer.cancel(k),k=null);if(!h){var e=a.val();b=b&&b.type;"password"===g||c.ngTrim&&"false"===c.ngTrim||(e=U(e));(d.$viewValue!==e||""===e&&d.$$hasNativeValidators)&&d.$setViewValue(e,b)}};if(e.hasEvent("input"))a.on("input",l);else{var k,m=function(a,b,c){k||(k=f.defer(function(){k=null;b&&b.value===c||l(a)}))};
a.on("keydown",function(a){var b=a.keyCode;91===b||15<b&&19>b||37<=b&&40>=b||m(a,this,this.value)});if(e.hasEvent("paste"))a.on("paste cut",m)}a.on("change",l);d.$render=function(){a.val(d.$isEmpty(d.$viewValue)?"":d.$viewValue)}}function Lb(b,a){return function(c,d){var e,f;if(qa(c))return c;if(F(c)){'"'==c.charAt(0)&&'"'==c.charAt(c.length-1)&&(c=c.substring(1,c.length-1));if(Nf.test(c))return new Date(c);b.lastIndex=0;if(e=b.exec(c))return e.shift(),f=d?{yyyy:d.getFullYear(),MM:d.getMonth()+1,
dd:d.getDate(),HH:d.getHours(),mm:d.getMinutes(),ss:d.getSeconds(),sss:d.getMilliseconds()/1E3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},s(e,function(b,c){c<a.length&&(f[a[c]]=+b)}),new Date(f.yyyy,f.MM-1,f.dd,f.HH,f.mm,f.ss||0,1E3*f.sss||0)}return NaN}}function jb(b,a,c,d){return function(e,f,g,h,l,k,m){function p(a){return a&&!(a.getTime&&a.getTime()!==a.getTime())}function q(a){return y(a)?qa(a)?a:c(a):t}td(e,f,g,h);ib(e,f,g,h,l,k);var u=h&&h.$options&&h.$options.timezone,r;h.$$parserName=b;
h.$parsers.push(function(b){return h.$isEmpty(b)?null:a.test(b)?(b=c(b,r),"UTC"===u&&b.setMinutes(b.getMinutes()-b.getTimezoneOffset()),b):t});h.$formatters.push(function(a){if(a&&!qa(a))throw Mb("datefmt",a);if(p(a)){if((r=a)&&"UTC"===u){var b=6E4*r.getTimezoneOffset();r=new Date(r.getTime()+b)}return m("date")(a,d,u)}r=null;return""});if(y(g.min)||g.ngMin){var s;h.$validators.min=function(a){return!p(a)||A(s)||c(a)>=s};g.$observe("min",function(a){s=q(a);h.$validate()})}if(y(g.max)||g.ngMax){var n;
h.$validators.max=function(a){return!p(a)||A(n)||c(a)<=n};g.$observe("max",function(a){n=q(a);h.$validate()})}}}function td(b,a,c,d){(d.$$hasNativeValidators=I(a[0].validity))&&d.$parsers.push(function(b){var c=a.prop("validity")||{};return c.badInput&&!c.typeMismatch?t:b})}function ud(b,a,c,d,e){if(y(d)){b=b(d);if(!b.constant)throw T("ngModel")("constexpr",c,d);return b(a)}return e}function ic(b,a){b="ngClass"+b;return["$animate",function(c){function d(a,b){var c=[],d=0;a:for(;d<a.length;d++){for(var e=
a[d],m=0;m<b.length;m++)if(e==b[m])continue a;c.push(e)}return c}function e(a){if(!D(a)){if(F(a))return a.split(" ");if(I(a)){var b=[];s(a,function(a,c){a&&(b=b.concat(c.split(" ")))});return b}}return a}return{restrict:"AC",link:function(f,g,h){function l(a,b){var c=g.data("$classCounts")||{},d=[];s(a,function(a){if(0<b||c[a])c[a]=(c[a]||0)+b,c[a]===+(0<b)&&d.push(a)});g.data("$classCounts",c);return d.join(" ")}function k(b){if(!0===a||f.$index%2===a){var k=e(b||[]);if(!m){var u=l(k,1);h.$addClass(u)}else if(!fa(b,
m)){var r=e(m),u=d(k,r),k=d(r,k),u=l(u,1),k=l(k,-1);u&&u.length&&c.addClass(g,u);k&&k.length&&c.removeClass(g,k)}}m=ra(b)}var m;f.$watch(h[b],k,!0);h.$observe("class",function(a){k(f.$eval(h[b]))});"ngClass"!==b&&f.$watch("$index",function(c,d){var g=c&1;if(g!==(d&1)){var k=e(f.$eval(h[b]));g===a?(g=l(k,1),h.$addClass(g)):(g=l(k,-1),h.$removeClass(g))}})}}}]}function sd(b){function a(a,b){b&&!f[a]?(k.addClass(e,a),f[a]=!0):!b&&f[a]&&(k.removeClass(e,a),f[a]=!1)}function c(b,c){b=b?"-"+tc(b,"-"):"";
a(kb+b,!0===c);a(vd+b,!1===c)}var d=b.ctrl,e=b.$element,f={},g=b.set,h=b.unset,l=b.parentForm,k=b.$animate;f[vd]=!(f[kb]=e.hasClass(kb));d.$setValidity=function(b,e,f){e===t?(d.$pending||(d.$pending={}),g(d.$pending,b,f)):(d.$pending&&h(d.$pending,b,f),wd(d.$pending)&&(d.$pending=t));Wa(e)?e?(h(d.$error,b,f),g(d.$$success,b,f)):(g(d.$error,b,f),h(d.$$success,b,f)):(h(d.$error,b,f),h(d.$$success,b,f));d.$pending?(a(xd,!0),d.$valid=d.$invalid=t,c("",null)):(a(xd,!1),d.$valid=wd(d.$error),d.$invalid=
!d.$valid,c("",d.$valid));e=d.$pending&&d.$pending[b]?t:d.$error[b]?!1:d.$$success[b]?!0:null;c(b,e);l.$setValidity(b,e,d)}}function wd(b){if(b)for(var a in b)return!1;return!0}var Of=/^\/(.+)\/([a-z]*)$/,Q=function(b){return F(b)?b.toLowerCase():b},rc=Object.prototype.hasOwnProperty,ub=function(b){return F(b)?b.toUpperCase():b},Ra,B,sa,Za=[].slice,rf=[].splice,Pf=[].push,Da=Object.prototype.toString,Ka=T("ng"),ga=M.angular||(M.angular={}),bb,nb=0;Ra=Y.documentMode;H.$inject=[];pa.$inject=[];var D=
Array.isArray,U=function(b){return F(b)?b.trim():b},gd=function(b){return b.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},ab=function(){if(y(ab.isActive_))return ab.isActive_;var b=!(!Y.querySelector("[ng-csp]")&&!Y.querySelector("[data-ng-csp]"));if(!b)try{new Function("")}catch(a){b=!0}return ab.isActive_=b},rb=["ng-","data-ng-","ng:","x-ng-"],Md=/[A-Z]/g,uc=!1,Pb,oa=1,pb=3,Qd={full:"1.3.9",major:1,minor:3,dot:9,codeName:"multidimensional-awareness"};R.expando="ng339";
var zb=R.cache={},hf=1;R._data=function(b){return this.cache[b[this.expando]]||{}};var cf=/([\:\-\_]+(.))/g,df=/^moz([A-Z])/,Qf={mouseleave:"mouseout",mouseenter:"mouseover"},Sb=T("jqLite"),gf=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,Rb=/<|&#?\w+;/,ef=/<([\w:]+)/,ff=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ia={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],
td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ia.optgroup=ia.option;ia.tbody=ia.tfoot=ia.colgroup=ia.caption=ia.thead;ia.th=ia.td;var La=R.prototype={ready:function(b){function a(){c||(c=!0,b())}var c=!1;"complete"===Y.readyState?setTimeout(a):(this.on("DOMContentLoaded",a),R(M).on("load",a))},toString:function(){var b=[];s(this,function(a){b.push(""+a)});return"["+b.join(", ")+"]"},eq:function(b){return 0<=b?B(this[b]):B(this[this.length+b])},length:0,push:Pf,sort:[].sort,
splice:[].splice},Eb={};s("multiple selected checked disabled readOnly required open".split(" "),function(b){Eb[Q(b)]=b});var Mc={};s("input select option textarea button form details".split(" "),function(b){Mc[b]=!0});var Nc={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern"};s({data:Ub,removeData:xb},function(b,a){R[a]=b});s({data:Ub,inheritedData:Db,scope:function(b){return B.data(b,"$scope")||Db(b.parentNode||b,["$isolateScope","$scope"])},isolateScope:function(b){return B.data(b,
"$isolateScope")||B.data(b,"$isolateScopeNoTemplate")},controller:Ic,injector:function(b){return Db(b,"$injector")},removeAttr:function(b,a){b.removeAttribute(a)},hasClass:Ab,css:function(b,a,c){a=cb(a);if(y(c))b.style[a]=c;else return b.style[a]},attr:function(b,a,c){var d=Q(a);if(Eb[d])if(y(c))c?(b[a]=!0,b.setAttribute(a,d)):(b[a]=!1,b.removeAttribute(d));else return b[a]||(b.attributes.getNamedItem(a)||H).specified?d:t;else if(y(c))b.setAttribute(a,c);else if(b.getAttribute)return b=b.getAttribute(a,
2),null===b?t:b},prop:function(b,a,c){if(y(c))b[a]=c;else return b[a]},text:function(){function b(a,b){if(A(b)){var d=a.nodeType;return d===oa||d===pb?a.textContent:""}a.textContent=b}b.$dv="";return b}(),val:function(b,a){if(A(a)){if(b.multiple&&"select"===ua(b)){var c=[];s(b.options,function(a){a.selected&&c.push(a.value||a.text)});return 0===c.length?null:c}return b.value}b.value=a},html:function(b,a){if(A(a))return b.innerHTML;wb(b,!0);b.innerHTML=a},empty:Jc},function(b,a){R.prototype[a]=function(a,
d){var e,f,g=this.length;if(b!==Jc&&(2==b.length&&b!==Ab&&b!==Ic?a:d)===t){if(I(a)){for(e=0;e<g;e++)if(b===Ub)b(this[e],a);else for(f in a)b(this[e],f,a[f]);return this}e=b.$dv;g=e===t?Math.min(g,1):g;for(f=0;f<g;f++){var h=b(this[f],a,d);e=e?e+h:h}return e}for(e=0;e<g;e++)b(this[e],a,d);return this}});s({removeData:xb,on:function a(c,d,e,f){if(y(f))throw Sb("onargs");if(Ec(c)){var g=yb(c,!0);f=g.events;var h=g.handle;h||(h=g.handle=lf(c,f));for(var g=0<=d.indexOf(" ")?d.split(" "):[d],l=g.length;l--;){d=
g[l];var k=f[d];k||(f[d]=[],"mouseenter"===d||"mouseleave"===d?a(c,Qf[d],function(a){var c=a.relatedTarget;c&&(c===this||this.contains(c))||h(a,d)}):"$destroy"!==d&&c.addEventListener(d,h,!1),k=f[d]);k.push(e)}}},off:Hc,one:function(a,c,d){a=B(a);a.on(c,function f(){a.off(c,d);a.off(c,f)});a.on(c,d)},replaceWith:function(a,c){var d,e=a.parentNode;wb(a);s(new R(c),function(c){d?e.insertBefore(c,d.nextSibling):e.replaceChild(c,a);d=c})},children:function(a){var c=[];s(a.childNodes,function(a){a.nodeType===
oa&&c.push(a)});return c},contents:function(a){return a.contentDocument||a.childNodes||[]},append:function(a,c){var d=a.nodeType;if(d===oa||11===d){c=new R(c);for(var d=0,e=c.length;d<e;d++)a.appendChild(c[d])}},prepend:function(a,c){if(a.nodeType===oa){var d=a.firstChild;s(new R(c),function(c){a.insertBefore(c,d)})}},wrap:function(a,c){c=B(c).eq(0).clone()[0];var d=a.parentNode;d&&d.replaceChild(c,a);c.appendChild(a)},remove:Kc,detach:function(a){Kc(a,!0)},after:function(a,c){var d=a,e=a.parentNode;
c=new R(c);for(var f=0,g=c.length;f<g;f++){var h=c[f];e.insertBefore(h,d.nextSibling);d=h}},addClass:Cb,removeClass:Bb,toggleClass:function(a,c,d){c&&s(c.split(" "),function(c){var f=d;A(f)&&(f=!Ab(a,c));(f?Cb:Bb)(a,c)})},parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},next:function(a){return a.nextElementSibling},find:function(a,c){return a.getElementsByTagName?a.getElementsByTagName(c):[]},clone:Tb,triggerHandler:function(a,c,d){var e,f,g=c.type||c,h=yb(a);if(h=(h=h&&h.events)&&
h[g])e={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return!0===this.defaultPrevented},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return!0===this.immediatePropagationStopped},stopPropagation:H,type:g,target:a},c.type&&(e=z(e,c)),c=ra(h),f=d?[e].concat(d):[e],s(c,function(c){e.isImmediatePropagationStopped()||c.apply(a,f)})}},function(a,c){R.prototype[c]=function(c,e,f){for(var g,h=0,l=this.length;h<
l;h++)A(g)?(g=a(this[h],c,e,f),y(g)&&(g=B(g))):Gc(g,a(this[h],c,e,f));return y(g)?g:this};R.prototype.bind=R.prototype.on;R.prototype.unbind=R.prototype.off});db.prototype={put:function(a,c){this[Na(a,this.nextUid)]=c},get:function(a){return this[Na(a,this.nextUid)]},remove:function(a){var c=this[a=Na(a,this.nextUid)];delete this[a];return c}};var Pc=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,nf=/,/,of=/^\s*(_?)(\S+?)\1\s*$/,Oc=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg,Ga=T("$injector");Ob.$$annotate=Vb;var Rf=
T("$animate"),Ce=["$provide",function(a){this.$$selectors={};this.register=function(c,d){var e=c+"-animation";if(c&&"."!=c.charAt(0))throw Rf("notcsel",c);this.$$selectors[c.substr(1)]=e;a.factory(e,d)};this.classNameFilter=function(a){1===arguments.length&&(this.$$classNameFilter=a instanceof RegExp?a:null);return this.$$classNameFilter};this.$get=["$$q","$$asyncCallback","$rootScope",function(a,d,e){function f(d){var f,g=a.defer();g.promise.$$cancelFn=function(){f&&f()};e.$$postDigest(function(){f=
d(function(){g.resolve()})});return g.promise}function g(a,c){var d=[],e=[],f=ha();s((a.attr("class")||"").split(/\s+/),function(a){f[a]=!0});s(c,function(a,c){var g=f[c];!1===a&&g?e.push(c):!0!==a||g||d.push(c)});return 0<d.length+e.length&&[d.length?d:null,e.length?e:null]}function h(a,c,d){for(var e=0,f=c.length;e<f;++e)a[c[e]]=d}function l(){m||(m=a.defer(),d(function(){m.resolve();m=null}));return m.promise}function k(a,c){if(ga.isObject(c)){var d=z(c.from||{},c.to||{});a.css(d)}}var m;return{animate:function(a,
c,d){k(a,{from:c,to:d});return l()},enter:function(a,c,d,e){k(a,e);d?d.after(a):c.prepend(a);return l()},leave:function(a,c){a.remove();return l()},move:function(a,c,d,e){return this.enter(a,c,d,e)},addClass:function(a,c,d){return this.setClass(a,c,[],d)},$$addClassImmediately:function(a,c,d){a=B(a);c=F(c)?c:D(c)?c.join(" "):"";s(a,function(a){Cb(a,c)});k(a,d);return l()},removeClass:function(a,c,d){return this.setClass(a,[],c,d)},$$removeClassImmediately:function(a,c,d){a=B(a);c=F(c)?c:D(c)?c.join(" "):
"";s(a,function(a){Bb(a,c)});k(a,d);return l()},setClass:function(a,c,d,e){var k=this,l=!1;a=B(a);var m=a.data("$$animateClasses");m?e&&m.options&&(m.options=ga.extend(m.options||{},e)):(m={classes:{},options:e},l=!0);e=m.classes;c=D(c)?c:c.split(" ");d=D(d)?d:d.split(" ");h(e,c,!0);h(e,d,!1);l&&(m.promise=f(function(c){var d=a.data("$$animateClasses");a.removeData("$$animateClasses");if(d){var e=g(a,d.classes);e&&k.$$setClassImmediately(a,e[0],e[1],d.options)}c()}),a.data("$$animateClasses",m));
return m.promise},$$setClassImmediately:function(a,c,d,e){c&&this.$$addClassImmediately(a,c);d&&this.$$removeClassImmediately(a,d);k(a,e);return l()},enabled:H,cancel:H}}]}],ja=T("$compile");wc.$inject=["$provide","$$sanitizeUriProvider"];var Rc=/^((?:x|data)[\:\-_])/i,Vc="application/json",Zb={"Content-Type":Vc+";charset=utf-8"},tf=/^\[|^\{(?!\{)/,uf={"[":/]$/,"{":/}$/},sf=/^\)\]\}',?\n/,$b=T("$interpolate"),Sf=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,xf={http:80,https:443,ftp:21},Fb=T("$location"),Tf=
{$$html5:!1,$$replace:!1,absUrl:Gb("$$absUrl"),url:function(a){if(A(a))return this.$$url;var c=Sf.exec(a);(c[1]||""===a)&&this.path(decodeURIComponent(c[1]));(c[2]||c[1]||""===a)&&this.search(c[3]||"");this.hash(c[5]||"");return this},protocol:Gb("$$protocol"),host:Gb("$$host"),port:Gb("$$port"),path:dd("$$path",function(a){a=null!==a?a.toString():"";return"/"==a.charAt(0)?a:"/"+a}),search:function(a,c){switch(arguments.length){case 0:return this.$$search;case 1:if(F(a)||V(a))a=a.toString(),this.$$search=
qc(a);else if(I(a))a=Ea(a,{}),s(a,function(c,e){null==c&&delete a[e]}),this.$$search=a;else throw Fb("isrcharg");break;default:A(c)||null===c?delete this.$$search[a]:this.$$search[a]=c}this.$$compose();return this},hash:dd("$$hash",function(a){return null!==a?a.toString():""}),replace:function(){this.$$replace=!0;return this}};s([cd,dc,cc],function(a){a.prototype=Object.create(Tf);a.prototype.state=function(c){if(!arguments.length)return this.$$state;if(a!==cc||!this.$$html5)throw Fb("nostate");this.$$state=
A(c)?null:c;return this}});var la=T("$parse"),Uf=Function.prototype.call,Vf=Function.prototype.apply,Wf=Function.prototype.bind,lb=ha();s({"null":function(){return null},"true":function(){return!0},"false":function(){return!1},undefined:function(){}},function(a,c){a.constant=a.literal=a.sharedGetter=!0;lb[c]=a});lb["this"]=function(a){return a};lb["this"].sharedGetter=!0;var mb=z(ha(),{"+":function(a,c,d,e){d=d(a,c);e=e(a,c);return y(d)?y(e)?d+e:d:y(e)?e:t},"-":function(a,c,d,e){d=d(a,c);e=e(a,c);
return(y(d)?d:0)-(y(e)?e:0)},"*":function(a,c,d,e){return d(a,c)*e(a,c)},"/":function(a,c,d,e){return d(a,c)/e(a,c)},"%":function(a,c,d,e){return d(a,c)%e(a,c)},"===":function(a,c,d,e){return d(a,c)===e(a,c)},"!==":function(a,c,d,e){return d(a,c)!==e(a,c)},"==":function(a,c,d,e){return d(a,c)==e(a,c)},"!=":function(a,c,d,e){return d(a,c)!=e(a,c)},"<":function(a,c,d,e){return d(a,c)<e(a,c)},">":function(a,c,d,e){return d(a,c)>e(a,c)},"<=":function(a,c,d,e){return d(a,c)<=e(a,c)},">=":function(a,c,
d,e){return d(a,c)>=e(a,c)},"&&":function(a,c,d,e){return d(a,c)&&e(a,c)},"||":function(a,c,d,e){return d(a,c)||e(a,c)},"!":function(a,c,d){return!d(a,c)},"=":!0,"|":!0}),Xf={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},gc=function(a){this.options=a};gc.prototype={constructor:gc,lex:function(a){this.text=a;this.index=0;for(this.tokens=[];this.index<this.text.length;)if(a=this.text.charAt(this.index),'"'===a||"'"===a)this.readString(a);else if(this.isNumber(a)||"."===a&&this.isNumber(this.peek()))this.readNumber();
else if(this.isIdent(a))this.readIdent();else if(this.is(a,"(){}[].,;:?"))this.tokens.push({index:this.index,text:a}),this.index++;else if(this.isWhitespace(a))this.index++;else{var c=a+this.peek(),d=c+this.peek(2),e=mb[c],f=mb[d];mb[a]||e||f?(a=f?d:e?c:a,this.tokens.push({index:this.index,text:a,operator:!0}),this.index+=a.length):this.throwError("Unexpected next character ",this.index,this.index+1)}return this.tokens},is:function(a,c){return-1!==c.indexOf(a)},peek:function(a){a=a||1;return this.index+
a<this.text.length?this.text.charAt(this.index+a):!1},isNumber:function(a){return"0"<=a&&"9">=a&&"string"===typeof a},isWhitespace:function(a){return" "===a||"\r"===a||"\t"===a||"\n"===a||"\v"===a||"\u00a0"===a},isIdent:function(a){return"a"<=a&&"z">=a||"A"<=a&&"Z">=a||"_"===a||"$"===a},isExpOperator:function(a){return"-"===a||"+"===a||this.isNumber(a)},throwError:function(a,c,d){d=d||this.index;c=y(c)?"s "+c+"-"+this.index+" ["+this.text.substring(c,d)+"]":" "+d;throw la("lexerr",a,c,this.text);
},readNumber:function(){for(var a="",c=this.index;this.index<this.text.length;){var d=Q(this.text.charAt(this.index));if("."==d||this.isNumber(d))a+=d;else{var e=this.peek();if("e"==d&&this.isExpOperator(e))a+=d;else if(this.isExpOperator(d)&&e&&this.isNumber(e)&&"e"==a.charAt(a.length-1))a+=d;else if(!this.isExpOperator(d)||e&&this.isNumber(e)||"e"!=a.charAt(a.length-1))break;else this.throwError("Invalid exponent")}this.index++}this.tokens.push({index:c,text:a,constant:!0,value:Number(a)})},readIdent:function(){for(var a=
this.index;this.index<this.text.length;){var c=this.text.charAt(this.index);if(!this.isIdent(c)&&!this.isNumber(c))break;this.index++}this.tokens.push({index:a,text:this.text.slice(a,this.index),identifier:!0})},readString:function(a){var c=this.index;this.index++;for(var d="",e=a,f=!1;this.index<this.text.length;){var g=this.text.charAt(this.index),e=e+g;if(f)"u"===g?(f=this.text.substring(this.index+1,this.index+5),f.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+f+"]"),this.index+=
4,d+=String.fromCharCode(parseInt(f,16))):d+=Xf[g]||g,f=!1;else if("\\"===g)f=!0;else{if(g===a){this.index++;this.tokens.push({index:c,text:e,constant:!0,value:d});return}d+=g}this.index++}this.throwError("Unterminated quote",c)}};var hb=function(a,c,d){this.lexer=a;this.$filter=c;this.options=d};hb.ZERO=z(function(){return 0},{sharedGetter:!0,constant:!0});hb.prototype={constructor:hb,parse:function(a){this.text=a;this.tokens=this.lexer.lex(a);a=this.statements();0!==this.tokens.length&&this.throwError("is an unexpected token",
this.tokens[0]);a.literal=!!a.literal;a.constant=!!a.constant;return a},primary:function(){var a;this.expect("(")?(a=this.filterChain(),this.consume(")")):this.expect("[")?a=this.arrayDeclaration():this.expect("{")?a=this.object():this.peek().identifier&&this.peek().text in lb?a=lb[this.consume().text]:this.peek().identifier?a=this.identifier():this.peek().constant?a=this.constant():this.throwError("not a primary expression",this.peek());for(var c,d;c=this.expect("(","[",".");)"("===c.text?(a=this.functionCall(a,
d),d=null):"["===c.text?(d=a,a=this.objectIndex(a)):"."===c.text?(d=a,a=this.fieldAccess(a)):this.throwError("IMPOSSIBLE");return a},throwError:function(a,c){throw la("syntax",c.text,a,c.index+1,this.text,this.text.substring(c.index));},peekToken:function(){if(0===this.tokens.length)throw la("ueoe",this.text);return this.tokens[0]},peek:function(a,c,d,e){return this.peekAhead(0,a,c,d,e)},peekAhead:function(a,c,d,e,f){if(this.tokens.length>a){a=this.tokens[a];var g=a.text;if(g===c||g===d||g===e||g===
f||!(c||d||e||f))return a}return!1},expect:function(a,c,d,e){return(a=this.peek(a,c,d,e))?(this.tokens.shift(),a):!1},consume:function(a){if(0===this.tokens.length)throw la("ueoe",this.text);var c=this.expect(a);c||this.throwError("is unexpected, expecting ["+a+"]",this.peek());return c},unaryFn:function(a,c){var d=mb[a];return z(function(a,f){return d(a,f,c)},{constant:c.constant,inputs:[c]})},binaryFn:function(a,c,d,e){var f=mb[c];return z(function(c,e){return f(c,e,a,d)},{constant:a.constant&&
d.constant,inputs:!e&&[a,d]})},identifier:function(){for(var a=this.consume().text;this.peek(".")&&this.peekAhead(1).identifier&&!this.peekAhead(2,"(");)a+=this.consume().text+this.consume().text;return zf(a,this.options,this.text)},constant:function(){var a=this.consume().value;return z(function(){return a},{constant:!0,literal:!0})},statements:function(){for(var a=[];;)if(0<this.tokens.length&&!this.peek("}",")",";","]")&&a.push(this.filterChain()),!this.expect(";"))return 1===a.length?a[0]:function(c,
d){for(var e,f=0,g=a.length;f<g;f++)e=a[f](c,d);return e}},filterChain:function(){for(var a=this.expression();this.expect("|");)a=this.filter(a);return a},filter:function(a){var c=this.$filter(this.consume().text),d,e;if(this.peek(":"))for(d=[],e=[];this.expect(":");)d.push(this.expression());var f=[a].concat(d||[]);return z(function(f,h){var l=a(f,h);if(e){e[0]=l;for(l=d.length;l--;)e[l+1]=d[l](f,h);return c.apply(t,e)}return c(l)},{constant:!c.$stateful&&f.every(ec),inputs:!c.$stateful&&f})},expression:function(){return this.assignment()},
assignment:function(){var a=this.ternary(),c,d;return(d=this.expect("="))?(a.assign||this.throwError("implies assignment but ["+this.text.substring(0,d.index)+"] can not be assigned to",d),c=this.ternary(),z(function(d,f){return a.assign(d,c(d,f),f)},{inputs:[a,c]})):a},ternary:function(){var a=this.logicalOR(),c;if(this.expect("?")&&(c=this.assignment(),this.consume(":"))){var d=this.assignment();return z(function(e,f){return a(e,f)?c(e,f):d(e,f)},{constant:a.constant&&c.constant&&d.constant})}return a},
logicalOR:function(){for(var a=this.logicalAND(),c;c=this.expect("||");)a=this.binaryFn(a,c.text,this.logicalAND(),!0);return a},logicalAND:function(){for(var a=this.equality(),c;c=this.expect("&&");)a=this.binaryFn(a,c.text,this.equality(),!0);return a},equality:function(){for(var a=this.relational(),c;c=this.expect("==","!=","===","!==");)a=this.binaryFn(a,c.text,this.relational());return a},relational:function(){for(var a=this.additive(),c;c=this.expect("<",">","<=",">=");)a=this.binaryFn(a,c.text,
this.additive());return a},additive:function(){for(var a=this.multiplicative(),c;c=this.expect("+","-");)a=this.binaryFn(a,c.text,this.multiplicative());return a},multiplicative:function(){for(var a=this.unary(),c;c=this.expect("*","/","%");)a=this.binaryFn(a,c.text,this.unary());return a},unary:function(){var a;return this.expect("+")?this.primary():(a=this.expect("-"))?this.binaryFn(hb.ZERO,a.text,this.unary()):(a=this.expect("!"))?this.unaryFn(a.text,this.unary()):this.primary()},fieldAccess:function(a){var c=
this.identifier();return z(function(d,e,f){d=f||a(d,e);return null==d?t:c(d)},{assign:function(d,e,f){var g=a(d,f);g||a.assign(d,g={},f);return c.assign(g,e)}})},objectIndex:function(a){var c=this.text,d=this.expression();this.consume("]");return z(function(e,f){var g=a(e,f),h=d(e,f);ta(h,c);return g?ma(g[h],c):t},{assign:function(e,f,g){var h=ta(d(e,g),c),l=ma(a(e,g),c);l||a.assign(e,l={},g);return l[h]=f}})},functionCall:function(a,c){var d=[];if(")"!==this.peekToken().text){do d.push(this.expression());
while(this.expect(","))}this.consume(")");var e=this.text,f=d.length?[]:null;return function(g,h){var l=c?c(g,h):y(c)?t:g,k=a(g,h,l)||H;if(f)for(var m=d.length;m--;)f[m]=ma(d[m](g,h),e);ma(l,e);if(k){if(k.constructor===k)throw la("isecfn",e);if(k===Uf||k===Vf||k===Wf)throw la("isecff",e);}l=k.apply?k.apply(l,f):k(f[0],f[1],f[2],f[3],f[4]);return ma(l,e)}},arrayDeclaration:function(){var a=[];if("]"!==this.peekToken().text){do{if(this.peek("]"))break;a.push(this.expression())}while(this.expect(","))
}this.consume("]");return z(function(c,d){for(var e=[],f=0,g=a.length;f<g;f++)e.push(a[f](c,d));return e},{literal:!0,constant:a.every(ec),inputs:a})},object:function(){var a=[],c=[];if("}"!==this.peekToken().text){do{if(this.peek("}"))break;var d=this.consume();d.constant?a.push(d.value):d.identifier?a.push(d.text):this.throwError("invalid key",d);this.consume(":");c.push(this.expression())}while(this.expect(","))}this.consume("}");return z(function(d,f){for(var g={},h=0,l=c.length;h<l;h++)g[a[h]]=
c[h](d,f);return g},{literal:!0,constant:c.every(ec),inputs:c})}};var Bf=ha(),Af=ha(),Cf=Object.prototype.valueOf,Ca=T("$sce"),na={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},ja=T("$compile"),Z=Y.createElement("a"),id=Ba(M.location.href);Dc.$inject=["$provide"];jd.$inject=["$locale"];ld.$inject=["$locale"];var od=".",Mf={yyyy:$("FullYear",4),yy:$("FullYear",2,0,!0),y:$("FullYear",1),MMMM:Ib("Month"),MMM:Ib("Month",!0),MM:$("Month",2,1),M:$("Month",1,1),dd:$("Date",2),d:$("Date",
1),HH:$("Hours",2),H:$("Hours",1),hh:$("Hours",2,-12),h:$("Hours",1,-12),mm:$("Minutes",2),m:$("Minutes",1),ss:$("Seconds",2),s:$("Seconds",1),sss:$("Milliseconds",3),EEEE:Ib("Day"),EEE:Ib("Day",!0),a:function(a,c){return 12>a.getHours()?c.AMPMS[0]:c.AMPMS[1]},Z:function(a){a=-1*a.getTimezoneOffset();return a=(0<=a?"+":"")+(Hb(Math[0<a?"floor":"ceil"](a/60),2)+Hb(Math.abs(a%60),2))},ww:qd(2),w:qd(1)},Lf=/((?:[^yMdHhmsaZEw']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z|w+))(.*)/,Kf=/^\-?\d+$/;
kd.$inject=["$locale"];var Hf=da(Q),If=da(ub);md.$inject=["$parse"];var Td=da({restrict:"E",compile:function(a,c){if(!c.href&&!c.xlinkHref&&!c.name)return function(a,c){var f="[object SVGAnimatedString]"===Da.call(c.prop("href"))?"xlink:href":"href";c.on("click",function(a){c.attr(f)||a.preventDefault()})}}}),vb={};s(Eb,function(a,c){if("multiple"!=a){var d=ya("ng-"+c);vb[d]=function(){return{restrict:"A",priority:100,link:function(a,f,g){a.$watch(g[d],function(a){g.$set(c,!!a)})}}}}});s(Nc,function(a,
c){vb[c]=function(){return{priority:100,link:function(a,e,f){if("ngPattern"===c&&"/"==f.ngPattern.charAt(0)&&(e=f.ngPattern.match(Of))){f.$set("ngPattern",new RegExp(e[1],e[2]));return}a.$watch(f[c],function(a){f.$set(c,a)})}}}});s(["src","srcset","href"],function(a){var c=ya("ng-"+a);vb[c]=function(){return{priority:99,link:function(d,e,f){var g=a,h=a;"href"===a&&"[object SVGAnimatedString]"===Da.call(e.prop("href"))&&(h="xlinkHref",f.$attr[h]="xlink:href",g=null);f.$observe(c,function(c){c?(f.$set(h,
c),Ra&&g&&e.prop(g,f[h])):"href"===a&&f.$set(h,null)})}}}});var Jb={$addControl:H,$$renameControl:function(a,c){a.$name=c},$removeControl:H,$setValidity:H,$setDirty:H,$setPristine:H,$setSubmitted:H};rd.$inject=["$element","$attrs","$scope","$animate","$interpolate"];var yd=function(a){return["$timeout",function(c){return{name:"form",restrict:a?"EAC":"E",controller:rd,compile:function(a){a.addClass(Sa).addClass(kb);return{pre:function(a,d,g,h){if(!("action"in g)){var l=function(c){a.$apply(function(){h.$commitViewValue();
h.$setSubmitted()});c.preventDefault()};d[0].addEventListener("submit",l,!1);d.on("$destroy",function(){c(function(){d[0].removeEventListener("submit",l,!1)},0,!1)})}var k=h.$$parentForm,m=h.$name;m&&(gb(a,null,m,h,m),g.$observe(g.name?"name":"ngForm",function(c){m!==c&&(gb(a,null,m,t,m),m=c,gb(a,null,m,h,m),k.$$renameControl(h,m))}));d.on("$destroy",function(){k.$removeControl(h);m&&gb(a,null,m,t,m);z(h,Jb)})}}}}}]},Ud=yd(),ge=yd(!0),Nf=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z)/,
Yf=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,Zf=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,$f=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,zd=/^(\d{4})-(\d{2})-(\d{2})$/,Ad=/^(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,jc=/^(\d{4})-W(\d\d)$/,Bd=/^(\d{4})-(\d\d)$/,Cd=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,Dd={text:function(a,c,d,e,f,g){ib(a,c,d,e,f,g);hc(e)},date:jb("date",zd,Lb(zd,["yyyy",
"MM","dd"]),"yyyy-MM-dd"),"datetime-local":jb("datetimelocal",Ad,Lb(Ad,"yyyy MM dd HH mm ss sss".split(" ")),"yyyy-MM-ddTHH:mm:ss.sss"),time:jb("time",Cd,Lb(Cd,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:jb("week",jc,function(a,c){if(qa(a))return a;if(F(a)){jc.lastIndex=0;var d=jc.exec(a);if(d){var e=+d[1],f=+d[2],g=d=0,h=0,l=0,k=pd(e),f=7*(f-1);c&&(d=c.getHours(),g=c.getMinutes(),h=c.getSeconds(),l=c.getMilliseconds());return new Date(e,0,k.getDate()+f,d,g,h,l)}}return NaN},"yyyy-Www"),month:jb("month",
Bd,Lb(Bd,["yyyy","MM"]),"yyyy-MM"),number:function(a,c,d,e,f,g){td(a,c,d,e);ib(a,c,d,e,f,g);e.$$parserName="number";e.$parsers.push(function(a){return e.$isEmpty(a)?null:$f.test(a)?parseFloat(a):t});e.$formatters.push(function(a){if(!e.$isEmpty(a)){if(!V(a))throw Mb("numfmt",a);a=a.toString()}return a});if(d.min||d.ngMin){var h;e.$validators.min=function(a){return e.$isEmpty(a)||A(h)||a>=h};d.$observe("min",function(a){y(a)&&!V(a)&&(a=parseFloat(a,10));h=V(a)&&!isNaN(a)?a:t;e.$validate()})}if(d.max||
d.ngMax){var l;e.$validators.max=function(a){return e.$isEmpty(a)||A(l)||a<=l};d.$observe("max",function(a){y(a)&&!V(a)&&(a=parseFloat(a,10));l=V(a)&&!isNaN(a)?a:t;e.$validate()})}},url:function(a,c,d,e,f,g){ib(a,c,d,e,f,g);hc(e);e.$$parserName="url";e.$validators.url=function(a,c){var d=a||c;return e.$isEmpty(d)||Yf.test(d)}},email:function(a,c,d,e,f,g){ib(a,c,d,e,f,g);hc(e);e.$$parserName="email";e.$validators.email=function(a,c){var d=a||c;return e.$isEmpty(d)||Zf.test(d)}},radio:function(a,c,
d,e){A(d.name)&&c.attr("name",++nb);c.on("click",function(a){c[0].checked&&e.$setViewValue(d.value,a&&a.type)});e.$render=function(){c[0].checked=d.value==e.$viewValue};d.$observe("value",e.$render)},checkbox:function(a,c,d,e,f,g,h,l){var k=ud(l,a,"ngTrueValue",d.ngTrueValue,!0),m=ud(l,a,"ngFalseValue",d.ngFalseValue,!1);c.on("click",function(a){e.$setViewValue(c[0].checked,a&&a.type)});e.$render=function(){c[0].checked=e.$viewValue};e.$isEmpty=function(a){return!1===a};e.$formatters.push(function(a){return fa(a,
k)});e.$parsers.push(function(a){return a?k:m})},hidden:H,button:H,submit:H,reset:H,file:H},xc=["$browser","$sniffer","$filter","$parse",function(a,c,d,e){return{restrict:"E",require:["?ngModel"],link:{pre:function(f,g,h,l){l[0]&&(Dd[Q(h.type)]||Dd.text)(f,g,h,l[0],c,a,d,e)}}}}],ag=/^(true|false|\d+)$/,ye=function(){return{restrict:"A",priority:100,compile:function(a,c){return ag.test(c.ngValue)?function(a,c,f){f.$set("value",a.$eval(f.ngValue))}:function(a,c,f){a.$watch(f.ngValue,function(a){f.$set("value",
a)})}}}},Zd=["$compile",function(a){return{restrict:"AC",compile:function(c){a.$$addBindingClass(c);return function(c,e,f){a.$$addBindingInfo(e,f.ngBind);e=e[0];c.$watch(f.ngBind,function(a){e.textContent=a===t?"":a})}}}}],ae=["$interpolate","$compile",function(a,c){return{compile:function(d){c.$$addBindingClass(d);return function(d,f,g){d=a(f.attr(g.$attr.ngBindTemplate));c.$$addBindingInfo(f,d.expressions);f=f[0];g.$observe("ngBindTemplate",function(a){f.textContent=a===t?"":a})}}}}],$d=["$sce",
"$parse","$compile",function(a,c,d){return{restrict:"A",compile:function(e,f){var g=c(f.ngBindHtml),h=c(f.ngBindHtml,function(a){return(a||"").toString()});d.$$addBindingClass(e);return function(c,e,f){d.$$addBindingInfo(e,f.ngBindHtml);c.$watch(h,function(){e.html(a.getTrustedHtml(g(c))||"")})}}}}],xe=da({restrict:"A",require:"ngModel",link:function(a,c,d,e){e.$viewChangeListeners.push(function(){a.$eval(d.ngChange)})}}),be=ic("",!0),de=ic("Odd",0),ce=ic("Even",1),ee=Ja({compile:function(a,c){c.$set("ngCloak",
t);a.removeClass("ng-cloak")}}),fe=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],Cc={},bg={blur:!0,focus:!0};s("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(a){var c=ya("ng-"+a);Cc[c]=["$parse","$rootScope",function(d,e){return{restrict:"A",compile:function(f,g){var h=d(g[c],null,!0);return function(c,d){d.on(a,function(d){var f=function(){h(c,{$event:d})};
bg[a]&&e.$$phase?c.$evalAsync(f):c.$apply(f)})}}}}]});var ie=["$animate",function(a){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(c,d,e,f,g){var h,l,k;c.$watch(e.ngIf,function(c){c?l||g(function(c,f){l=f;c[c.length++]=Y.createComment(" end ngIf: "+e.ngIf+" ");h={clone:c};a.enter(c,d.parent(),d)}):(k&&(k.remove(),k=null),l&&(l.$destroy(),l=null),h&&(k=tb(h.clone),a.leave(k).then(function(){k=null}),h=null))})}}}],je=["$templateRequest","$anchorScroll",
"$animate","$sce",function(a,c,d,e){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:ga.noop,compile:function(f,g){var h=g.ngInclude||g.src,l=g.onload||"",k=g.autoscroll;return function(f,g,q,s,r){var t=0,n,v,w,L=function(){v&&(v.remove(),v=null);n&&(n.$destroy(),n=null);w&&(d.leave(w).then(function(){v=null}),v=w,w=null)};f.$watch(e.parseAsResourceUrl(h),function(e){var h=function(){!y(k)||k&&!f.$eval(k)||c()},q=++t;e?(a(e,!0).then(function(a){if(q===t){var c=f.$new();
s.template=a;a=r(c,function(a){L();d.enter(a,null,g).then(h)});n=c;w=a;n.$emit("$includeContentLoaded",e);f.$eval(l)}},function(){q===t&&(L(),f.$emit("$includeContentError",e))}),f.$emit("$includeContentRequested",e)):(L(),s.template=null)})}}}}],Ae=["$compile",function(a){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(c,d,e,f){/SVG/.test(d[0].toString())?(d.empty(),a(Fc(f.template,Y).childNodes)(c,function(a){d.append(a)},{futureParentElement:d})):(d.html(f.template),a(d.contents())(c))}}}],
ke=Ja({priority:450,compile:function(){return{pre:function(a,c,d){a.$eval(d.ngInit)}}}}),we=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(a,c,d,e){var f=c.attr(d.$attr.ngList)||", ",g="false"!==d.ngTrim,h=g?U(f):f;e.$parsers.push(function(a){if(!A(a)){var c=[];a&&s(a.split(h),function(a){a&&c.push(g?U(a):a)});return c}});e.$formatters.push(function(a){return D(a)?a.join(f):t});e.$isEmpty=function(a){return!a||!a.length}}}},kb="ng-valid",vd="ng-invalid",Sa="ng-pristine",
Kb="ng-dirty",xd="ng-pending",Mb=new T("ngModel"),cg=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$rootScope","$q","$interpolate",function(a,c,d,e,f,g,h,l,k,m){this.$modelValue=this.$viewValue=Number.NaN;this.$$rawModelValue=t;this.$validators={};this.$asyncValidators={};this.$parsers=[];this.$formatters=[];this.$viewChangeListeners=[];this.$untouched=!0;this.$touched=!1;this.$pristine=!0;this.$dirty=!1;this.$valid=!0;this.$invalid=!1;this.$error={};this.$$success=
{};this.$pending=t;this.$name=m(d.name||"",!1)(a);var p=f(d.ngModel),q=p.assign,u=p,r=q,O=null,n=this;this.$$setOptions=function(a){if((n.$options=a)&&a.getterSetter){var c=f(d.ngModel+"()"),g=f(d.ngModel+"($$$p)");u=function(a){var d=p(a);G(d)&&(d=c(a));return d};r=function(a,c){G(p(a))?g(a,{$$$p:n.$modelValue}):q(a,n.$modelValue)}}else if(!p.assign)throw Mb("nonassign",d.ngModel,va(e));};this.$render=H;this.$isEmpty=function(a){return A(a)||""===a||null===a||a!==a};var v=e.inheritedData("$formController")||
Jb,w=0;sd({ctrl:this,$element:e,set:function(a,c){a[c]=!0},unset:function(a,c){delete a[c]},parentForm:v,$animate:g});this.$setPristine=function(){n.$dirty=!1;n.$pristine=!0;g.removeClass(e,Kb);g.addClass(e,Sa)};this.$setDirty=function(){n.$dirty=!0;n.$pristine=!1;g.removeClass(e,Sa);g.addClass(e,Kb);v.$setDirty()};this.$setUntouched=function(){n.$touched=!1;n.$untouched=!0;g.setClass(e,"ng-untouched","ng-touched")};this.$setTouched=function(){n.$touched=!0;n.$untouched=!1;g.setClass(e,"ng-touched",
"ng-untouched")};this.$rollbackViewValue=function(){h.cancel(O);n.$viewValue=n.$$lastCommittedViewValue;n.$render()};this.$validate=function(){if(!V(n.$modelValue)||!isNaN(n.$modelValue)){var a=n.$$rawModelValue,c=n.$valid,d=n.$modelValue,e=n.$options&&n.$options.allowInvalid;n.$$runValidators(n.$error[n.$$parserName||"parse"]?!1:t,a,n.$$lastCommittedViewValue,function(f){e||c===f||(n.$modelValue=f?a:t,n.$modelValue!==d&&n.$$writeModelToScope())})}};this.$$runValidators=function(a,c,d,e){function f(){var a=
!0;s(n.$validators,function(e,f){var g=e(c,d);a=a&&g;h(f,g)});return a?!0:(s(n.$asyncValidators,function(a,c){h(c,null)}),!1)}function g(){var a=[],e=!0;s(n.$asyncValidators,function(f,g){var l=f(c,d);if(!l||!G(l.then))throw Mb("$asyncValidators",l);h(g,t);a.push(l.then(function(){h(g,!0)},function(a){e=!1;h(g,!1)}))});a.length?k.all(a).then(function(){l(e)},H):l(!0)}function h(a,c){m===w&&n.$setValidity(a,c)}function l(a){m===w&&e(a)}w++;var m=w;(function(a){var c=n.$$parserName||"parse";if(a===
t)h(c,null);else if(h(c,a),!a)return s(n.$validators,function(a,c){h(c,null)}),s(n.$asyncValidators,function(a,c){h(c,null)}),!1;return!0})(a)?f()?g():l(!1):l(!1)};this.$commitViewValue=function(){var a=n.$viewValue;h.cancel(O);if(n.$$lastCommittedViewValue!==a||""===a&&n.$$hasNativeValidators)n.$$lastCommittedViewValue=a,n.$pristine&&this.$setDirty(),this.$$parseAndValidate()};this.$$parseAndValidate=function(){var c=n.$$lastCommittedViewValue,d=A(c)?t:!0;if(d)for(var e=0;e<n.$parsers.length;e++)if(c=
n.$parsers[e](c),A(c)){d=!1;break}V(n.$modelValue)&&isNaN(n.$modelValue)&&(n.$modelValue=u(a));var f=n.$modelValue,g=n.$options&&n.$options.allowInvalid;n.$$rawModelValue=c;g&&(n.$modelValue=c,n.$modelValue!==f&&n.$$writeModelToScope());n.$$runValidators(d,c,n.$$lastCommittedViewValue,function(a){g||(n.$modelValue=a?c:t,n.$modelValue!==f&&n.$$writeModelToScope())})};this.$$writeModelToScope=function(){r(a,n.$modelValue);s(n.$viewChangeListeners,function(a){try{a()}catch(d){c(d)}})};this.$setViewValue=
function(a,c){n.$viewValue=a;n.$options&&!n.$options.updateOnDefault||n.$$debounceViewValueCommit(c)};this.$$debounceViewValueCommit=function(c){var d=0,e=n.$options;e&&y(e.debounce)&&(e=e.debounce,V(e)?d=e:V(e[c])?d=e[c]:V(e["default"])&&(d=e["default"]));h.cancel(O);d?O=h(function(){n.$commitViewValue()},d):l.$$phase?n.$commitViewValue():a.$apply(function(){n.$commitViewValue()})};a.$watch(function(){var c=u(a);if(c!==n.$modelValue){n.$modelValue=n.$$rawModelValue=c;for(var d=n.$formatters,e=d.length,
f=c;e--;)f=d[e](f);n.$viewValue!==f&&(n.$viewValue=n.$$lastCommittedViewValue=f,n.$render(),n.$$runValidators(t,c,f,H))}return c})}],ve=["$rootScope",function(a){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:cg,priority:1,compile:function(c){c.addClass(Sa).addClass("ng-untouched").addClass(kb);return{pre:function(a,c,f,g){var h=g[0],l=g[1]||Jb;h.$$setOptions(g[2]&&g[2].$options);l.$addControl(h);f.$observe("name",function(a){h.$name!==a&&l.$$renameControl(h,a)});a.$on("$destroy",
function(){l.$removeControl(h)})},post:function(c,e,f,g){var h=g[0];if(h.$options&&h.$options.updateOn)e.on(h.$options.updateOn,function(a){h.$$debounceViewValueCommit(a&&a.type)});e.on("blur",function(e){h.$touched||(a.$$phase?c.$evalAsync(h.$setTouched):c.$apply(h.$setTouched))})}}}}}],dg=/(\s+|^)default(\s+|$)/,ze=function(){return{restrict:"A",controller:["$scope","$attrs",function(a,c){var d=this;this.$options=a.$eval(c.ngModelOptions);this.$options.updateOn!==t?(this.$options.updateOnDefault=
!1,this.$options.updateOn=U(this.$options.updateOn.replace(dg,function(){d.$options.updateOnDefault=!0;return" "}))):this.$options.updateOnDefault=!0}]}},le=Ja({terminal:!0,priority:1E3}),me=["$locale","$interpolate",function(a,c){var d=/{}/g,e=/^when(Minus)?(.+)$/;return{restrict:"EA",link:function(f,g,h){function l(a){g.text(a||"")}var k=h.count,m=h.$attr.when&&g.attr(h.$attr.when),p=h.offset||0,q=f.$eval(m)||{},u={},m=c.startSymbol(),r=c.endSymbol(),t=m+k+"-"+p+r,n=ga.noop,v;s(h,function(a,c){var d=
e.exec(c);d&&(d=(d[1]?"-":"")+Q(d[2]),q[d]=g.attr(h.$attr[c]))});s(q,function(a,e){u[e]=c(a.replace(d,t))});f.$watch(k,function(c){c=parseFloat(c);var d=isNaN(c);d||c in q||(c=a.pluralCat(c-p));c===v||d&&isNaN(v)||(n(),n=f.$watch(u[c],l),v=c)})}}}],ne=["$parse","$animate",function(a,c){var d=T("ngRepeat"),e=function(a,c,d,e,k,m,p){a[d]=e;k&&(a[k]=m);a.$index=c;a.$first=0===c;a.$last=c===p-1;a.$middle=!(a.$first||a.$last);a.$odd=!(a.$even=0===(c&1))};return{restrict:"A",multiElement:!0,transclude:"element",
priority:1E3,terminal:!0,$$tlb:!0,compile:function(f,g){var h=g.ngRepeat,l=Y.createComment(" end ngRepeat: "+h+" "),k=h.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!k)throw d("iexp",h);var m=k[1],p=k[2],q=k[3],u=k[4],k=m.match(/^(?:(\s*[\$\w]+)|\(\s*([\$\w]+)\s*,\s*([\$\w]+)\s*\))$/);if(!k)throw d("iidexp",m);var r=k[3]||k[1],y=k[2];if(q&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(q)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent)$/.test(q)))throw d("badident",
q);var n,v,w,A,z={$id:Na};u?n=a(u):(w=function(a,c){return Na(c)},A=function(a){return a});return function(a,f,g,k,m){n&&(v=function(c,d,e){y&&(z[y]=c);z[r]=d;z.$index=e;return n(a,z)});var u=ha();a.$watchCollection(p,function(g){var k,p,n=f[0],E,z=ha(),H,S,N,D,G,C,I;q&&(a[q]=g);if(Ta(g))G=g,p=v||w;else{p=v||A;G=[];for(I in g)g.hasOwnProperty(I)&&"$"!=I.charAt(0)&&G.push(I);G.sort()}H=G.length;I=Array(H);for(k=0;k<H;k++)if(S=g===G?k:G[k],N=g[S],D=p(S,N,k),u[D])C=u[D],delete u[D],z[D]=C,I[k]=C;else{if(z[D])throw s(I,
function(a){a&&a.scope&&(u[a.id]=a)}),d("dupes",h,D,N);I[k]={id:D,scope:t,clone:t};z[D]=!0}for(E in u){C=u[E];D=tb(C.clone);c.leave(D);if(D[0].parentNode)for(k=0,p=D.length;k<p;k++)D[k].$$NG_REMOVED=!0;C.scope.$destroy()}for(k=0;k<H;k++)if(S=g===G?k:G[k],N=g[S],C=I[k],C.scope){E=n;do E=E.nextSibling;while(E&&E.$$NG_REMOVED);C.clone[0]!=E&&c.move(tb(C.clone),null,B(n));n=C.clone[C.clone.length-1];e(C.scope,k,r,N,y,S,H)}else m(function(a,d){C.scope=d;var f=l.cloneNode(!1);a[a.length++]=f;c.enter(a,
null,B(n));n=f;C.clone=a;z[C.id]=C;e(C.scope,k,r,N,y,S,H)});u=z})}}}}],oe=["$animate",function(a){return{restrict:"A",multiElement:!0,link:function(c,d,e){c.$watch(e.ngShow,function(c){a[c?"removeClass":"addClass"](d,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],he=["$animate",function(a){return{restrict:"A",multiElement:!0,link:function(c,d,e){c.$watch(e.ngHide,function(c){a[c?"addClass":"removeClass"](d,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],pe=Ja(function(a,c,d){a.$watchCollection(d.ngStyle,
function(a,d){d&&a!==d&&s(d,function(a,d){c.css(d,"")});a&&c.css(a)})}),qe=["$animate",function(a){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(c,d,e,f){var g=[],h=[],l=[],k=[],m=function(a,c){return function(){a.splice(c,1)}};c.$watch(e.ngSwitch||e.on,function(c){var d,e;d=0;for(e=l.length;d<e;++d)a.cancel(l[d]);d=l.length=0;for(e=k.length;d<e;++d){var r=tb(h[d].clone);k[d].$destroy();(l[d]=a.leave(r)).then(m(l,d))}h.length=0;k.length=0;(g=
f.cases["!"+c]||f.cases["?"])&&s(g,function(c){c.transclude(function(d,e){k.push(e);var f=c.element;d[d.length++]=Y.createComment(" end ngSwitchWhen: ");h.push({clone:d});a.enter(d,f.parent(),f)})})})}}}],re=Ja({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(a,c,d,e,f){e.cases["!"+d.ngSwitchWhen]=e.cases["!"+d.ngSwitchWhen]||[];e.cases["!"+d.ngSwitchWhen].push({transclude:f,element:c})}}),se=Ja({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,
link:function(a,c,d,e,f){e.cases["?"]=e.cases["?"]||[];e.cases["?"].push({transclude:f,element:c})}}),ue=Ja({restrict:"EAC",link:function(a,c,d,e,f){if(!f)throw T("ngTransclude")("orphan",va(c));f(function(a){c.empty();c.append(a)})}}),Vd=["$templateCache",function(a){return{restrict:"E",terminal:!0,compile:function(c,d){"text/ng-template"==d.type&&a.put(d.id,c[0].text)}}}],eg=T("ngOptions"),te=da({restrict:"A",terminal:!0}),Wd=["$compile","$parse",function(a,c){var d=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,
e={$setViewValue:H};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function(a,c,d){var l=this,k={},m=e,p;l.databound=d.ngModel;l.init=function(a,c,d){m=a;p=d};l.addOption=function(c,d){Ma(c,'"option value"');k[c]=!0;m.$viewValue==c&&(a.val(c),p.parent()&&p.remove());d&&d[0].hasAttribute("selected")&&(d[0].selected=!0)};l.removeOption=function(a){this.hasOption(a)&&(delete k[a],m.$viewValue===a&&this.renderUnknownOption(a))};l.renderUnknownOption=function(c){c=
"? "+Na(c)+" ?";p.val(c);a.prepend(p);a.val(c);p.prop("selected",!0)};l.hasOption=function(a){return k.hasOwnProperty(a)};c.$on("$destroy",function(){l.renderUnknownOption=H})}],link:function(e,g,h,l){function k(a,c,d,e){d.$render=function(){var a=d.$viewValue;e.hasOption(a)?(C.parent()&&C.remove(),c.val(a),""===a&&n.prop("selected",!0)):A(a)&&n?c.val(""):e.renderUnknownOption(a)};c.on("change",function(){a.$apply(function(){C.parent()&&C.remove();d.$setViewValue(c.val())})})}function m(a,c,d){var e;
d.$render=function(){var a=new db(d.$viewValue);s(c.find("option"),function(c){c.selected=y(a.get(c.value))})};a.$watch(function(){fa(e,d.$viewValue)||(e=ra(d.$viewValue),d.$render())});c.on("change",function(){a.$apply(function(){var a=[];s(c.find("option"),function(c){c.selected&&a.push(c.value)});d.$setViewValue(a)})})}function p(e,f,g){function h(a,c,d){T[x]=d;G&&(T[G]=c);return a(e,T)}function k(a){var c;if(u)if(M&&D(a)){c=new db([]);for(var d=0;d<a.length;d++)c.put(h(M,null,a[d]),!0)}else c=
new db(a);else M&&(a=h(M,null,a));return function(d,e){var f;f=M?M:B?B:F;return u?y(c.remove(h(f,d,e))):a===h(f,d,e)}}function l(){v||(e.$$postDigest(p),v=!0)}function m(a,c,d){a[c]=a[c]||0;a[c]+=d?1:-1}function p(){v=!1;var a={"":[]},c=[""],d,l,n,r,t;n=g.$viewValue;r=P(e)||[];var B=G?Object.keys(r).sort():r,x,A,D,F,N={};t=k(n);var J=!1,U,V;Q={};for(F=0;D=B.length,F<D;F++){x=F;if(G&&(x=B[F],"$"===x.charAt(0)))continue;A=r[x];d=h(I,x,A)||"";(l=a[d])||(l=a[d]=[],c.push(d));d=t(x,A);J=J||d;A=h(C,x,A);
A=y(A)?A:"";V=M?M(e,T):G?B[F]:F;M&&(Q[V]=x);l.push({id:V,label:A,selected:d})}u||(z||null===n?a[""].unshift({id:"",label:"",selected:!J}):J||a[""].unshift({id:"?",label:"",selected:!0}));x=0;for(B=c.length;x<B;x++){d=c[x];l=a[d];R.length<=x?(n={element:H.clone().attr("label",d),label:l.label},r=[n],R.push(r),f.append(n.element)):(r=R[x],n=r[0],n.label!=d&&n.element.attr("label",n.label=d));J=null;F=0;for(D=l.length;F<D;F++)d=l[F],(t=r[F+1])?(J=t.element,t.label!==d.label&&(m(N,t.label,!1),m(N,d.label,
!0),J.text(t.label=d.label),J.prop("label",t.label)),t.id!==d.id&&J.val(t.id=d.id),J[0].selected!==d.selected&&(J.prop("selected",t.selected=d.selected),Ra&&J.prop("selected",t.selected))):(""===d.id&&z?U=z:(U=w.clone()).val(d.id).prop("selected",d.selected).attr("selected",d.selected).prop("label",d.label).text(d.label),r.push(t={element:U,label:d.label,id:d.id,selected:d.selected}),m(N,d.label,!0),J?J.after(U):n.element.append(U),J=U);for(F++;r.length>F;)d=r.pop(),m(N,d.label,!1),d.element.remove()}for(;R.length>
x;){l=R.pop();for(F=1;F<l.length;++F)m(N,l[F].label,!1);l[0].element.remove()}s(N,function(a,c){0<a?q.addOption(c):0>a&&q.removeOption(c)})}var n;if(!(n=r.match(d)))throw eg("iexp",r,va(f));var C=c(n[2]||n[1]),x=n[4]||n[6],A=/ as /.test(n[0])&&n[1],B=A?c(A):null,G=n[5],I=c(n[3]||""),F=c(n[2]?n[1]:x),P=c(n[7]),M=n[8]?c(n[8]):null,Q={},R=[[{element:f,label:""}]],T={};z&&(a(z)(e),z.removeClass("ng-scope"),z.remove());f.empty();f.on("change",function(){e.$apply(function(){var a=P(e)||[],c;if(u)c=[],s(f.val(),
function(d){d=M?Q[d]:d;c.push("?"===d?t:""===d?null:h(B?B:F,d,a[d]))});else{var d=M?Q[f.val()]:f.val();c="?"===d?t:""===d?null:h(B?B:F,d,a[d])}g.$setViewValue(c);p()})});g.$render=p;e.$watchCollection(P,l);e.$watchCollection(function(){var a=P(e),c;if(a&&D(a)){c=Array(a.length);for(var d=0,f=a.length;d<f;d++)c[d]=h(C,d,a[d])}else if(a)for(d in c={},a)a.hasOwnProperty(d)&&(c[d]=h(C,d,a[d]));return c},l);u&&e.$watchCollection(function(){return g.$modelValue},l)}if(l[1]){var q=l[0];l=l[1];var u=h.multiple,
r=h.ngOptions,z=!1,n,v=!1,w=B(Y.createElement("option")),H=B(Y.createElement("optgroup")),C=w.clone();h=0;for(var x=g.children(),G=x.length;h<G;h++)if(""===x[h].value){n=z=x.eq(h);break}q.init(l,z,C);u&&(l.$isEmpty=function(a){return!a||0===a.length});r?p(e,g,l):u?m(e,g,l):k(e,g,l,q)}}}}],Yd=["$interpolate",function(a){var c={addOption:H,removeOption:H};return{restrict:"E",priority:100,compile:function(d,e){if(A(e.value)){var f=a(d.text(),!0);f||e.$set("value",d.text())}return function(a,d,e){var k=
d.parent(),m=k.data("$selectController")||k.parent().data("$selectController");m&&m.databound||(m=c);f?a.$watch(f,function(a,c){e.$set("value",a);c!==a&&m.removeOption(c);m.addOption(a,d)}):m.addOption(e.value,d);d.on("$destroy",function(){m.removeOption(e.value)})}}}}],Xd=da({restrict:"E",terminal:!1}),zc=function(){return{restrict:"A",require:"?ngModel",link:function(a,c,d,e){e&&(d.required=!0,e.$validators.required=function(a,c){return!d.required||!e.$isEmpty(c)},d.$observe("required",function(){e.$validate()}))}}},
yc=function(){return{restrict:"A",require:"?ngModel",link:function(a,c,d,e){if(e){var f,g=d.ngPattern||d.pattern;d.$observe("pattern",function(a){F(a)&&0<a.length&&(a=new RegExp("^"+a+"$"));if(a&&!a.test)throw T("ngPattern")("noregexp",g,a,va(c));f=a||t;e.$validate()});e.$validators.pattern=function(a){return e.$isEmpty(a)||A(f)||f.test(a)}}}}},Bc=function(){return{restrict:"A",require:"?ngModel",link:function(a,c,d,e){if(e){var f=-1;d.$observe("maxlength",function(a){a=ba(a);f=isNaN(a)?-1:a;e.$validate()});
e.$validators.maxlength=function(a,c){return 0>f||e.$isEmpty(a)||c.length<=f}}}}},Ac=function(){return{restrict:"A",require:"?ngModel",link:function(a,c,d,e){if(e){var f=0;d.$observe("minlength",function(a){f=ba(a)||0;e.$validate()});e.$validators.minlength=function(a,c){return e.$isEmpty(c)||c.length>=f}}}}};M.angular.bootstrap?console.log("WARNING: Tried to load angular more than once."):(Nd(),Pd(ga),B(Y).ready(function(){Jd(Y,sc)}))})(window,document);!window.angular.$$csp()&&window.angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}</style>');
//# sourceMappingURL=angular.min.js.map

/**
 * @license AngularJS v1.3.11
 * (c) 2010-2014 Google, Inc. http://angularjs.org
 * License: MIT
 */
(function(window, angular, undefined) {'use strict';

/* jshint maxlen: false */

/**
 * @ngdoc module
 * @name ngAnimate
 * @description
 *
 * The `ngAnimate` module provides support for JavaScript, CSS3 transition and CSS3 keyframe animation hooks within existing core and custom directives.
 *
 * <div doc-module-components="ngAnimate"></div>
 *
 * # Usage
 *
 * To see animations in action, all that is required is to define the appropriate CSS classes
 * or to register a JavaScript animation via the `myModule.animation()` function. The directives that support animation automatically are:
 * `ngRepeat`, `ngInclude`, `ngIf`, `ngSwitch`, `ngShow`, `ngHide`, `ngView` and `ngClass`. Custom directives can take advantage of animation
 * by using the `$animate` service.
 *
 * Below is a more detailed breakdown of the supported animation events provided by pre-existing ng directives:
 *
 * | Directive                                                                                                | Supported Animations                                                     |
 * |----------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|
 * | {@link ng.directive:ngRepeat#animations ngRepeat}                                                        | enter, leave and move                                                    |
 * | {@link ngRoute.directive:ngView#animations ngView}                                                       | enter and leave                                                          |
 * | {@link ng.directive:ngInclude#animations ngInclude}                                                      | enter and leave                                                          |
 * | {@link ng.directive:ngSwitch#animations ngSwitch}                                                        | enter and leave                                                          |
 * | {@link ng.directive:ngIf#animations ngIf}                                                                | enter and leave                                                          |
 * | {@link ng.directive:ngClass#animations ngClass}                                                          | add and remove (the CSS class(es) present)                               |
 * | {@link ng.directive:ngShow#animations ngShow} & {@link ng.directive:ngHide#animations ngHide}            | add and remove (the ng-hide class value)                                 |
 * | {@link ng.directive:form#animation-hooks form} & {@link ng.directive:ngModel#animation-hooks ngModel}    | add and remove (dirty, pristine, valid, invalid & all other validations) |
 * | {@link module:ngMessages#animations ngMessages}                                                          | add and remove (ng-active & ng-inactive)                                 |
 * | {@link module:ngMessages#animations ngMessage}                                                           | enter and leave                                                          |
 *
 * You can find out more information about animations upon visiting each directive page.
 *
 * Below is an example of how to apply animations to a directive that supports animation hooks:
 *
 * ```html
 * <style type="text/css">
 * .slide.ng-enter, .slide.ng-leave {
 *   -webkit-transition:0.5s linear all;
 *   transition:0.5s linear all;
 * }
 *
 * .slide.ng-enter { }        /&#42; starting animations for enter &#42;/
 * .slide.ng-enter.ng-enter-active { } /&#42; terminal animations for enter &#42;/
 * .slide.ng-leave { }        /&#42; starting animations for leave &#42;/
 * .slide.ng-leave.ng-leave-active { } /&#42; terminal animations for leave &#42;/
 * </style>
 *
 * <!--
 * the animate service will automatically add .ng-enter and .ng-leave to the element
 * to trigger the CSS transition/animations
 * -->
 * <ANY class="slide" ng-include="..."></ANY>
 * ```
 *
 * Keep in mind that, by default, if an animation is running, any child elements cannot be animated
 * until the parent element's animation has completed. This blocking feature can be overridden by
 * placing the `ng-animate-children` attribute on a parent container tag.
 *
 * ```html
 * <div class="slide-animation" ng-if="on" ng-animate-children>
 *   <div class="fade-animation" ng-if="on">
 *     <div class="explode-animation" ng-if="on">
 *        ...
 *     </div>
 *   </div>
 * </div>
 * ```
 *
 * When the `on` expression value changes and an animation is triggered then each of the elements within
 * will all animate without the block being applied to child elements.
 *
 * ## Are animations run when the application starts?
 * No they are not. When an application is bootstrapped Angular will disable animations from running to avoid
 * a frenzy of animations from being triggered as soon as the browser has rendered the screen. For this to work,
 * Angular will wait for two digest cycles until enabling animations. From there on, any animation-triggering
 * layout changes in the application will trigger animations as normal.
 *
 * In addition, upon bootstrap, if the routing system or any directives or load remote data (via $http) then Angular
 * will automatically extend the wait time to enable animations once **all** of the outbound HTTP requests
 * are complete.
 *
 * ## CSS-defined Animations
 * The animate service will automatically apply two CSS classes to the animated element and these two CSS classes
 * are designed to contain the start and end CSS styling. Both CSS transitions and keyframe animations are supported
 * and can be used to play along with this naming structure.
 *
 * The following code below demonstrates how to perform animations using **CSS transitions** with Angular:
 *
 * ```html
 * <style type="text/css">
 * /&#42;
 *  The animate class is apart of the element and the ng-enter class
 *  is attached to the element once the enter animation event is triggered
 * &#42;/
 * .reveal-animation.ng-enter {
 *  -webkit-transition: 1s linear all; /&#42; Safari/Chrome &#42;/
 *  transition: 1s linear all; /&#42; All other modern browsers and IE10+ &#42;/
 *
 *  /&#42; The animation preparation code &#42;/
 *  opacity: 0;
 * }
 *
 * /&#42;
 *  Keep in mind that you want to combine both CSS
 *  classes together to avoid any CSS-specificity
 *  conflicts
 * &#42;/
 * .reveal-animation.ng-enter.ng-enter-active {
 *  /&#42; The animation code itself &#42;/
 *  opacity: 1;
 * }
 * </style>
 *
 * <div class="view-container">
 *   <div ng-view class="reveal-animation"></div>
 * </div>
 * ```
 *
 * The following code below demonstrates how to perform animations using **CSS animations** with Angular:
 *
 * ```html
 * <style type="text/css">
 * .reveal-animation.ng-enter {
 *   -webkit-animation: enter_sequence 1s linear; /&#42; Safari/Chrome &#42;/
 *   animation: enter_sequence 1s linear; /&#42; IE10+ and Future Browsers &#42;/
 * }
 * @-webkit-keyframes enter_sequence {
 *   from { opacity:0; }
 *   to { opacity:1; }
 * }
 * @keyframes enter_sequence {
 *   from { opacity:0; }
 *   to { opacity:1; }
 * }
 * </style>
 *
 * <div class="view-container">
 *   <div ng-view class="reveal-animation"></div>
 * </div>
 * ```
 *
 * Both CSS3 animations and transitions can be used together and the animate service will figure out the correct duration and delay timing.
 *
 * Upon DOM mutation, the event class is added first (something like `ng-enter`), then the browser prepares itself to add
 * the active class (in this case `ng-enter-active`) which then triggers the animation. The animation module will automatically
 * detect the CSS code to determine when the animation ends. Once the animation is over then both CSS classes will be
 * removed from the DOM. If a browser does not support CSS transitions or CSS animations then the animation will start and end
 * immediately resulting in a DOM element that is at its final state. This final state is when the DOM element
 * has no CSS transition/animation classes applied to it.
 *
 * ### Structural transition animations
 *
 * Structural transitions (such as enter, leave and move) will always apply a `0s none` transition
 * value to force the browser into rendering the styles defined in the setup (`.ng-enter`, `.ng-leave`
 * or `.ng-move`) class. This means that any active transition animations operating on the element
 * will be cut off to make way for the enter, leave or move animation.
 *
 * ### Class-based transition animations
 *
 * Class-based transitions refer to transition animations that are triggered when a CSS class is
 * added to or removed from the element (via `$animate.addClass`, `$animate.removeClass`,
 * `$animate.setClass`, or by directives such as `ngClass`, `ngModel` and `form`).
 * They are different when compared to structural animations since they **do not cancel existing
 * animations** nor do they **block successive transitions** from rendering on the same element.
 * This distinction allows for **multiple class-based transitions** to be performed on the same element.
 *
 * In addition to ngAnimate supporting the default (natural) functionality of class-based transition
 * animations, ngAnimate also decorates the element with starting and ending CSS classes to aid the
 * developer in further styling the element throughout the transition animation. Earlier versions
 * of ngAnimate may have caused natural CSS transitions to break and not render properly due to
 * $animate temporarily blocking transitions using `0s none` in order to allow the setup CSS class
 * (the `-add` or `-remove` class) to be applied without triggering an animation. However, as of
 * **version 1.3**, this workaround has been removed with ngAnimate and all non-ngAnimate CSS
 * class transitions are compatible with ngAnimate.
 *
 * There is, however, one special case when dealing with class-based transitions in ngAnimate.
 * When rendering class-based transitions that make use of the setup and active CSS classes
 * (e.g. `.fade-add` and `.fade-add-active` for when `.fade` is added) be sure to define
 * the transition value **on the active CSS class** and not the setup class.
 *
 * ```css
 * .fade-add {
 *   /&#42; remember to place a 0s transition here
 *      to ensure that the styles are applied instantly
 *      even if the element already has a transition style &#42;/
 *   transition:0s linear all;
 *
 *   /&#42; starting CSS styles &#42;/
 *   opacity:1;
 * }
 * .fade-add.fade-add-active {
 *   /&#42; this will be the length of the animation &#42;/
 *   transition:1s linear all;
 *   opacity:0;
 * }
 * ```
 *
 * The setup CSS class (in this case `.fade-add`) also has a transition style property, however, it
 * has a duration of zero. This may not be required, however, incase the browser is unable to render
 * the styling present in this CSS class instantly then it could be that the browser is attempting
 * to perform an unnecessary transition.
 *
 * This workaround, however, does not apply to  standard class-based transitions that are rendered
 * when a CSS class containing a transition is applied to an element:
 *
 * ```css
 * /&#42; this works as expected &#42;/
 * .fade {
 *   transition:1s linear all;
 *   opacity:0;
 * }
 * ```
 *
 * Please keep this in mind when coding the CSS markup that will be used within class-based transitions.
 * Also, try not to mix the two class-based animation flavors together since the CSS code may become
 * overly complex.
 *
 *
 * ### Preventing Collisions With Third Party Libraries
 *
 * Some third-party frameworks place animation duration defaults across many element or className
 * selectors in order to make their code small and reuseable. This can lead to issues with ngAnimate, which
 * is expecting actual animations on these elements and has to wait for their completion.
 *
 * You can prevent this unwanted behavior by using a prefix on all your animation classes:
 *
 * ```css
 * /&#42; prefixed with animate- &#42;/
 * .animate-fade-add.animate-fade-add-active {
 *   transition:1s linear all;
 *   opacity:0;
 * }
 * ```
 *
 * You then configure `$animate` to enforce this prefix:
 *
 * ```js
 * $animateProvider.classNameFilter(/animate-/);
 * ```
 * </div>
 *
 * ### CSS Staggering Animations
 * A Staggering animation is a collection of animations that are issued with a slight delay in between each successive operation resulting in a
 * curtain-like effect. The ngAnimate module (versions >=1.2) supports staggering animations and the stagger effect can be
 * performed by creating a **ng-EVENT-stagger** CSS class and attaching that class to the base CSS class used for
 * the animation. The style property expected within the stagger class can either be a **transition-delay** or an
 * **animation-delay** property (or both if your animation contains both transitions and keyframe animations).
 *
 * ```css
 * .my-animation.ng-enter {
 *   /&#42; standard transition code &#42;/
 *   -webkit-transition: 1s linear all;
 *   transition: 1s linear all;
 *   opacity:0;
 * }
 * .my-animation.ng-enter-stagger {
 *   /&#42; this will have a 100ms delay between each successive leave animation &#42;/
 *   -webkit-transition-delay: 0.1s;
 *   transition-delay: 0.1s;
 *
 *   /&#42; in case the stagger doesn't work then these two values
 *    must be set to 0 to avoid an accidental CSS inheritance &#42;/
 *   -webkit-transition-duration: 0s;
 *   transition-duration: 0s;
 * }
 * .my-animation.ng-enter.ng-enter-active {
 *   /&#42; standard transition styles &#42;/
 *   opacity:1;
 * }
 * ```
 *
 * Staggering animations work by default in ngRepeat (so long as the CSS class is defined). Outside of ngRepeat, to use staggering animations
 * on your own, they can be triggered by firing multiple calls to the same event on $animate. However, the restrictions surrounding this
 * are that each of the elements must have the same CSS className value as well as the same parent element. A stagger operation
 * will also be reset if more than 10ms has passed after the last animation has been fired.
 *
 * The following code will issue the **ng-leave-stagger** event on the element provided:
 *
 * ```js
 * var kids = parent.children();
 *
 * $animate.leave(kids[0]); //stagger index=0
 * $animate.leave(kids[1]); //stagger index=1
 * $animate.leave(kids[2]); //stagger index=2
 * $animate.leave(kids[3]); //stagger index=3
 * $animate.leave(kids[4]); //stagger index=4
 *
 * $timeout(function() {
 *   //stagger has reset itself
 *   $animate.leave(kids[5]); //stagger index=0
 *   $animate.leave(kids[6]); //stagger index=1
 * }, 100, false);
 * ```
 *
 * Stagger animations are currently only supported within CSS-defined animations.
 *
 * ## JavaScript-defined Animations
 * In the event that you do not want to use CSS3 transitions or CSS3 animations or if you wish to offer animations on browsers that do not
 * yet support CSS transitions/animations, then you can make use of JavaScript animations defined inside of your AngularJS module.
 *
 * ```js
 * //!annotate="YourApp" Your AngularJS Module|Replace this or ngModule with the module that you used to define your application.
 * var ngModule = angular.module('YourApp', ['ngAnimate']);
 * ngModule.animation('.my-crazy-animation', function() {
 *   return {
 *     enter: function(element, done) {
 *       //run the animation here and call done when the animation is complete
 *       return function(cancelled) {
 *         //this (optional) function will be called when the animation
 *         //completes or when the animation is cancelled (the cancelled
 *         //flag will be set to true if cancelled).
 *       };
 *     },
 *     leave: function(element, done) { },
 *     move: function(element, done) { },
 *
 *     //animation that can be triggered before the class is added
 *     beforeAddClass: function(element, className, done) { },
 *
 *     //animation that can be triggered after the class is added
 *     addClass: function(element, className, done) { },
 *
 *     //animation that can be triggered before the class is removed
 *     beforeRemoveClass: function(element, className, done) { },
 *
 *     //animation that can be triggered after the class is removed
 *     removeClass: function(element, className, done) { }
 *   };
 * });
 * ```
 *
 * JavaScript-defined animations are created with a CSS-like class selector and a collection of events which are set to run
 * a javascript callback function. When an animation is triggered, $animate will look for a matching animation which fits
 * the element's CSS class attribute value and then run the matching animation event function (if found).
 * In other words, if the CSS classes present on the animated element match any of the JavaScript animations then the callback function will
 * be executed. It should be also noted that only simple, single class selectors are allowed (compound class selectors are not supported).
 *
 * Within a JavaScript animation, an object containing various event callback animation functions is expected to be returned.
 * As explained above, these callbacks are triggered based on the animation event. Therefore if an enter animation is run,
 * and the JavaScript animation is found, then the enter callback will handle that animation (in addition to the CSS keyframe animation
 * or transition code that is defined via a stylesheet).
 *
 *
 * ### Applying Directive-specific Styles to an Animation
 * In some cases a directive or service may want to provide `$animate` with extra details that the animation will
 * include into its animation. Let's say for example we wanted to render an animation that animates an element
 * towards the mouse coordinates as to where the user clicked last. By collecting the X/Y coordinates of the click
 * (via the event parameter) we can set the `top` and `left` styles into an object and pass that into our function
 * call to `$animate.addClass`.
 *
 * ```js
 * canvas.on('click', function(e) {
 *   $animate.addClass(element, 'on', {
 *     to: {
 *       left : e.client.x + 'px',
 *       top : e.client.y + 'px'
 *     }
 *   }):
 * });
 * ```
 *
 * Now when the animation runs, and a transition or keyframe animation is picked up, then the animation itself will
 * also include and transition the styling of the `left` and `top` properties into its running animation. If we want
 * to provide some starting animation values then we can do so by placing the starting animations styles into an object
 * called `from` in the same object as the `to` animations.
 *
 * ```js
 * canvas.on('click', function(e) {
 *   $animate.addClass(element, 'on', {
 *     from: {
 *        position: 'absolute',
 *        left: '0px',
 *        top: '0px'
 *     },
 *     to: {
 *       left : e.client.x + 'px',
 *       top : e.client.y + 'px'
 *     }
 *   }):
 * });
 * ```
 *
 * Once the animation is complete or cancelled then the union of both the before and after styles are applied to the
 * element. If `ngAnimate` is not present then the styles will be applied immediately.
 *
 */

angular.module('ngAnimate', ['ng'])

  /**
   * @ngdoc provider
   * @name $animateProvider
   * @description
   *
   * The `$animateProvider` allows developers to register JavaScript animation event handlers directly inside of a module.
   * When an animation is triggered, the $animate service will query the $animate service to find any animations that match
   * the provided name value.
   *
   * Requires the {@link ngAnimate `ngAnimate`} module to be installed.
   *
   * Please visit the {@link ngAnimate `ngAnimate`} module overview page learn more about how to use animations in your application.
   *
   */
  .directive('ngAnimateChildren', function() {
    var NG_ANIMATE_CHILDREN = '$$ngAnimateChildren';
    return function(scope, element, attrs) {
      var val = attrs.ngAnimateChildren;
      if (angular.isString(val) && val.length === 0) { //empty attribute
        element.data(NG_ANIMATE_CHILDREN, true);
      } else {
        scope.$watch(val, function(value) {
          element.data(NG_ANIMATE_CHILDREN, !!value);
        });
      }
    };
  })

  //this private service is only used within CSS-enabled animations
  //IE8 + IE9 do not support rAF natively, but that is fine since they
  //also don't support transitions and keyframes which means that the code
  //below will never be used by the two browsers.
  .factory('$$animateReflow', ['$$rAF', '$document', function($$rAF, $document) {
    var bod = $document[0].body;
    return function(fn) {
      //the returned function acts as the cancellation function
      return $$rAF(function() {
        //the line below will force the browser to perform a repaint
        //so that all the animated elements within the animation frame
        //will be properly updated and drawn on screen. This is
        //required to perform multi-class CSS based animations with
        //Firefox. DO NOT REMOVE THIS LINE.
        var a = bod.offsetWidth + 1;
        fn();
      });
    };
  }])

  .config(['$provide', '$animateProvider', function($provide, $animateProvider) {
    var noop = angular.noop;
    var forEach = angular.forEach;
    var selectors = $animateProvider.$$selectors;
    var isArray = angular.isArray;
    var isString = angular.isString;
    var isObject = angular.isObject;

    var ELEMENT_NODE = 1;
    var NG_ANIMATE_STATE = '$$ngAnimateState';
    var NG_ANIMATE_CHILDREN = '$$ngAnimateChildren';
    var NG_ANIMATE_CLASS_NAME = 'ng-animate';
    var rootAnimateState = {running: true};

    function extractElementNode(element) {
      for (var i = 0; i < element.length; i++) {
        var elm = element[i];
        if (elm.nodeType == ELEMENT_NODE) {
          return elm;
        }
      }
    }

    function prepareElement(element) {
      return element && angular.element(element);
    }

    function stripCommentsFromElement(element) {
      return angular.element(extractElementNode(element));
    }

    function isMatchingElement(elm1, elm2) {
      return extractElementNode(elm1) == extractElementNode(elm2);
    }
    var $$jqLite;
    $provide.decorator('$animate',
        ['$delegate', '$$q', '$injector', '$sniffer', '$rootElement', '$$asyncCallback', '$rootScope', '$document', '$templateRequest', '$$jqLite',
 function($delegate,   $$q,   $injector,   $sniffer,   $rootElement,   $$asyncCallback,   $rootScope,   $document,   $templateRequest,   $$$jqLite) {

      $$jqLite = $$$jqLite;
      $rootElement.data(NG_ANIMATE_STATE, rootAnimateState);

      // Wait until all directive and route-related templates are downloaded and
      // compiled. The $templateRequest.totalPendingRequests variable keeps track of
      // all of the remote templates being currently downloaded. If there are no
      // templates currently downloading then the watcher will still fire anyway.
      var deregisterWatch = $rootScope.$watch(
        function() { return $templateRequest.totalPendingRequests; },
        function(val, oldVal) {
          if (val !== 0) return;
          deregisterWatch();

          // Now that all templates have been downloaded, $animate will wait until
          // the post digest queue is empty before enabling animations. By having two
          // calls to $postDigest calls we can ensure that the flag is enabled at the
          // very end of the post digest queue. Since all of the animations in $animate
          // use $postDigest, it's important that the code below executes at the end.
          // This basically means that the page is fully downloaded and compiled before
          // any animations are triggered.
          $rootScope.$$postDigest(function() {
            $rootScope.$$postDigest(function() {
              rootAnimateState.running = false;
            });
          });
        }
      );

      var globalAnimationCounter = 0;
      var classNameFilter = $animateProvider.classNameFilter();
      var isAnimatableClassName = !classNameFilter
              ? function() { return true; }
              : function(className) {
                return classNameFilter.test(className);
              };

      function classBasedAnimationsBlocked(element, setter) {
        var data = element.data(NG_ANIMATE_STATE) || {};
        if (setter) {
          data.running = true;
          data.structural = true;
          element.data(NG_ANIMATE_STATE, data);
        }
        return data.disabled || (data.running && data.structural);
      }

      function runAnimationPostDigest(fn) {
        var cancelFn, defer = $$q.defer();
        defer.promise.$$cancelFn = function() {
          cancelFn && cancelFn();
        };
        $rootScope.$$postDigest(function() {
          cancelFn = fn(function() {
            defer.resolve();
          });
        });
        return defer.promise;
      }

      function parseAnimateOptions(options) {
        // some plugin code may still be passing in the callback
        // function as the last param for the $animate methods so
        // it's best to only allow string or array values for now
        if (isObject(options)) {
          if (options.tempClasses && isString(options.tempClasses)) {
            options.tempClasses = options.tempClasses.split(/\s+/);
          }
          return options;
        }
      }

      function resolveElementClasses(element, cache, runningAnimations) {
        runningAnimations = runningAnimations || {};

        var lookup = {};
        forEach(runningAnimations, function(data, selector) {
          forEach(selector.split(' '), function(s) {
            lookup[s]=data;
          });
        });

        var hasClasses = Object.create(null);
        forEach((element.attr('class') || '').split(/\s+/), function(className) {
          hasClasses[className] = true;
        });

        var toAdd = [], toRemove = [];
        forEach((cache && cache.classes) || [], function(status, className) {
          var hasClass = hasClasses[className];
          var matchingAnimation = lookup[className] || {};

          // When addClass and removeClass is called then $animate will check to
          // see if addClass and removeClass cancel each other out. When there are
          // more calls to removeClass than addClass then the count falls below 0
          // and then the removeClass animation will be allowed. Otherwise if the
          // count is above 0 then that means an addClass animation will commence.
          // Once an animation is allowed then the code will also check to see if
          // there exists any on-going animation that is already adding or remvoing
          // the matching CSS class.
          if (status === false) {
            //does it have the class or will it have the class
            if (hasClass || matchingAnimation.event == 'addClass') {
              toRemove.push(className);
            }
          } else if (status === true) {
            //is the class missing or will it be removed?
            if (!hasClass || matchingAnimation.event == 'removeClass') {
              toAdd.push(className);
            }
          }
        });

        return (toAdd.length + toRemove.length) > 0 && [toAdd.join(' '), toRemove.join(' ')];
      }

      function lookup(name) {
        if (name) {
          var matches = [],
              flagMap = {},
              classes = name.substr(1).split('.');

          //the empty string value is the default animation
          //operation which performs CSS transition and keyframe
          //animations sniffing. This is always included for each
          //element animation procedure if the browser supports
          //transitions and/or keyframe animations. The default
          //animation is added to the top of the list to prevent
          //any previous animations from affecting the element styling
          //prior to the element being animated.
          if ($sniffer.transitions || $sniffer.animations) {
            matches.push($injector.get(selectors['']));
          }

          for (var i=0; i < classes.length; i++) {
            var klass = classes[i],
                selectorFactoryName = selectors[klass];
            if (selectorFactoryName && !flagMap[klass]) {
              matches.push($injector.get(selectorFactoryName));
              flagMap[klass] = true;
            }
          }
          return matches;
        }
      }

      function animationRunner(element, animationEvent, className, options) {
        //transcluded directives may sometimes fire an animation using only comment nodes
        //best to catch this early on to prevent any animation operations from occurring
        var node = element[0];
        if (!node) {
          return;
        }

        if (options) {
          options.to = options.to || {};
          options.from = options.from || {};
        }

        var classNameAdd;
        var classNameRemove;
        if (isArray(className)) {
          classNameAdd = className[0];
          classNameRemove = className[1];
          if (!classNameAdd) {
            className = classNameRemove;
            animationEvent = 'removeClass';
          } else if (!classNameRemove) {
            className = classNameAdd;
            animationEvent = 'addClass';
          } else {
            className = classNameAdd + ' ' + classNameRemove;
          }
        }

        var isSetClassOperation = animationEvent == 'setClass';
        var isClassBased = isSetClassOperation
                           || animationEvent == 'addClass'
                           || animationEvent == 'removeClass'
                           || animationEvent == 'animate';

        var currentClassName = element.attr('class');
        var classes = currentClassName + ' ' + className;
        if (!isAnimatableClassName(classes)) {
          return;
        }

        var beforeComplete = noop,
            beforeCancel = [],
            before = [],
            afterComplete = noop,
            afterCancel = [],
            after = [];

        var animationLookup = (' ' + classes).replace(/\s+/g,'.');
        forEach(lookup(animationLookup), function(animationFactory) {
          var created = registerAnimation(animationFactory, animationEvent);
          if (!created && isSetClassOperation) {
            registerAnimation(animationFactory, 'addClass');
            registerAnimation(animationFactory, 'removeClass');
          }
        });

        function registerAnimation(animationFactory, event) {
          var afterFn = animationFactory[event];
          var beforeFn = animationFactory['before' + event.charAt(0).toUpperCase() + event.substr(1)];
          if (afterFn || beforeFn) {
            if (event == 'leave') {
              beforeFn = afterFn;
              //when set as null then animation knows to skip this phase
              afterFn = null;
            }
            after.push({
              event: event, fn: afterFn
            });
            before.push({
              event: event, fn: beforeFn
            });
            return true;
          }
        }

        function run(fns, cancellations, allCompleteFn) {
          var animations = [];
          forEach(fns, function(animation) {
            animation.fn && animations.push(animation);
          });

          var count = 0;
          function afterAnimationComplete(index) {
            if (cancellations) {
              (cancellations[index] || noop)();
              if (++count < animations.length) return;
              cancellations = null;
            }
            allCompleteFn();
          }

          //The code below adds directly to the array in order to work with
          //both sync and async animations. Sync animations are when the done()
          //operation is called right away. DO NOT REFACTOR!
          forEach(animations, function(animation, index) {
            var progress = function() {
              afterAnimationComplete(index);
            };
            switch (animation.event) {
              case 'setClass':
                cancellations.push(animation.fn(element, classNameAdd, classNameRemove, progress, options));
                break;
              case 'animate':
                cancellations.push(animation.fn(element, className, options.from, options.to, progress));
                break;
              case 'addClass':
                cancellations.push(animation.fn(element, classNameAdd || className,     progress, options));
                break;
              case 'removeClass':
                cancellations.push(animation.fn(element, classNameRemove || className,  progress, options));
                break;
              default:
                cancellations.push(animation.fn(element, progress, options));
                break;
            }
          });

          if (cancellations && cancellations.length === 0) {
            allCompleteFn();
          }
        }

        return {
          node: node,
          event: animationEvent,
          className: className,
          isClassBased: isClassBased,
          isSetClassOperation: isSetClassOperation,
          applyStyles: function() {
            if (options) {
              element.css(angular.extend(options.from || {}, options.to || {}));
            }
          },
          before: function(allCompleteFn) {
            beforeComplete = allCompleteFn;
            run(before, beforeCancel, function() {
              beforeComplete = noop;
              allCompleteFn();
            });
          },
          after: function(allCompleteFn) {
            afterComplete = allCompleteFn;
            run(after, afterCancel, function() {
              afterComplete = noop;
              allCompleteFn();
            });
          },
          cancel: function() {
            if (beforeCancel) {
              forEach(beforeCancel, function(cancelFn) {
                (cancelFn || noop)(true);
              });
              beforeComplete(true);
            }
            if (afterCancel) {
              forEach(afterCancel, function(cancelFn) {
                (cancelFn || noop)(true);
              });
              afterComplete(true);
            }
          }
        };
      }

      /**
       * @ngdoc service
       * @name $animate
       * @kind object
       *
       * @description
       * The `$animate` service provides animation detection support while performing DOM operations (enter, leave and move) as well as during addClass and removeClass operations.
       * When any of these operations are run, the $animate service
       * will examine any JavaScript-defined animations (which are defined by using the $animateProvider provider object)
       * as well as any CSS-defined animations against the CSS classes present on the element once the DOM operation is run.
       *
       * The `$animate` service is used behind the scenes with pre-existing directives and animation with these directives
       * will work out of the box without any extra configuration.
       *
       * Requires the {@link ngAnimate `ngAnimate`} module to be installed.
       *
       * Please visit the {@link ngAnimate `ngAnimate`} module overview page learn more about how to use animations in your application.
       * ## Callback Promises
       * With AngularJS 1.3, each of the animation methods, on the `$animate` service, return a promise when called. The
       * promise itself is then resolved once the animation has completed itself, has been cancelled or has been
       * skipped due to animations being disabled. (Note that even if the animation is cancelled it will still
       * call the resolve function of the animation.)
       *
       * ```js
       * $animate.enter(element, container).then(function() {
       *   //...this is called once the animation is complete...
       * });
       * ```
       *
       * Also note that, due to the nature of the callback promise, if any Angular-specific code (like changing the scope,
       * location of the page, etc...) is executed within the callback promise then be sure to wrap the code using
       * `$scope.$apply(...)`;
       *
       * ```js
       * $animate.leave(element).then(function() {
       *   $scope.$apply(function() {
       *     $location.path('/new-page');
       *   });
       * });
       * ```
       *
       * An animation can also be cancelled by calling the `$animate.cancel(promise)` method with the provided
       * promise that was returned when the animation was started.
       *
       * ```js
       * var promise = $animate.addClass(element, 'super-long-animation');
       * promise.then(function() {
       *   //this will still be called even if cancelled
       * });
       *
       * element.on('click', function() {
       *   //tooo lazy to wait for the animation to end
       *   $animate.cancel(promise);
       * });
       * ```
       *
       * (Keep in mind that the promise cancellation is unique to `$animate` since promises in
       * general cannot be cancelled.)
       *
       */
      return {
        /**
         * @ngdoc method
         * @name $animate#animate
         * @kind function
         *
         * @description
         * Performs an inline animation on the element which applies the provided `to` and `from` CSS styles to the element.
         * If any detected CSS transition, keyframe or JavaScript matches the provided `className` value then the animation
         * will take on the provided styles. For example, if a transition animation is set for the given className then the
         * provided `from` and `to` styles will be applied alongside the given transition. If a JavaScript animation is
         * detected then the provided styles will be given in as function paramters.
         *
         * ```js
         * ngModule.animation('.my-inline-animation', function() {
         *   return {
         *     animate : function(element, className, from, to, done) {
         *       //styles
         *     }
         *   }
         * });
         * ```
         *
         * Below is a breakdown of each step that occurs during the `animate` animation:
         *
         * | Animation Step                                                                                                        | What the element class attribute looks like                  |
         * |-----------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
         * | 1. `$animate.animate(...)` is called                                                                                  | `class="my-animation"`                                       |
         * | 2. `$animate` waits for the next digest to start the animation                                                        | `class="my-animation ng-animate"`                            |
         * | 3. `$animate` runs the JavaScript-defined animations detected on the element                                          | `class="my-animation ng-animate"`                            |
         * | 4. the `className` class value is added to the element                                                                | `class="my-animation ng-animate className"`                  |
         * | 5. `$animate` scans the element styles to get the CSS transition/animation duration and delay                         | `class="my-animation ng-animate className"`                  |
         * | 6. `$animate` blocks all CSS transitions on the element to ensure the `.className` class styling is applied right away| `class="my-animation ng-animate className"`                  |
         * | 7. `$animate` applies the provided collection of `from` CSS styles to the element                                     | `class="my-animation ng-animate className"`                  |
         * | 8. `$animate` waits for a single animation frame (this performs a reflow)                                             | `class="my-animation ng-animate className"`                  |
         * | 9. `$animate` removes the CSS transition block placed on the element                                                  | `class="my-animation ng-animate className"`                  |
         * | 10. the `className-active` class is added (this triggers the CSS transition/animation)                                | `class="my-animation ng-animate className className-active"` |
         * | 11. `$animate` applies the collection of `to` CSS styles to the element which are then handled by the transition      | `class="my-animation ng-animate className className-active"` |
         * | 12. `$animate` waits for the animation to complete (via events and timeout)                                           | `class="my-animation ng-animate className className-active"` |
         * | 13. The animation ends and all generated CSS classes are removed from the element                                     | `class="my-animation"`                                       |
         * | 14. The returned promise is resolved.                                                                                 | `class="my-animation"`                                       |
         *
         * @param {DOMElement} element the element that will be the focus of the enter animation
         * @param {object} from a collection of CSS styles that will be applied to the element at the start of the animation
         * @param {object} to a collection of CSS styles that the element will animate towards
         * @param {string=} className an optional CSS class that will be added to the element for the duration of the animation (the default class is `ng-inline-animate`)
         * @param {object=} options an optional collection of options that will be picked up by the CSS transition/animation
         * @return {Promise} the animation callback promise
        */
        animate: function(element, from, to, className, options) {
          className = className || 'ng-inline-animate';
          options = parseAnimateOptions(options) || {};
          options.from = to ? from : null;
          options.to   = to ? to : from;

          return runAnimationPostDigest(function(done) {
            return performAnimation('animate', className, stripCommentsFromElement(element), null, null, noop, options, done);
          });
        },

        /**
         * @ngdoc method
         * @name $animate#enter
         * @kind function
         *
         * @description
         * Appends the element to the parentElement element that resides in the document and then runs the enter animation. Once
         * the animation is started, the following CSS classes will be present on the element for the duration of the animation:
         *
         * Below is a breakdown of each step that occurs during enter animation:
         *
         * | Animation Step                                                                                                        | What the element class attribute looks like                |
         * |-----------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|
         * | 1. `$animate.enter(...)` is called                                                                                    | `class="my-animation"`                                     |
         * | 2. element is inserted into the `parentElement` element or beside the `afterElement` element                          | `class="my-animation"`                                     |
         * | 3. `$animate` waits for the next digest to start the animation                                                        | `class="my-animation ng-animate"`                          |
         * | 4. `$animate` runs the JavaScript-defined animations detected on the element                                          | `class="my-animation ng-animate"`                          |
         * | 5. the `.ng-enter` class is added to the element                                                                      | `class="my-animation ng-animate ng-enter"`                 |
         * | 6. `$animate` scans the element styles to get the CSS transition/animation duration and delay                         | `class="my-animation ng-animate ng-enter"`                 |
         * | 7. `$animate` blocks all CSS transitions on the element to ensure the `.ng-enter` class styling is applied right away | `class="my-animation ng-animate ng-enter"`                 |
         * | 8. `$animate` waits for a single animation frame (this performs a reflow)                                             | `class="my-animation ng-animate ng-enter"`                 |
         * | 9. `$animate` removes the CSS transition block placed on the element                                                  | `class="my-animation ng-animate ng-enter"`                 |
         * | 10. the `.ng-enter-active` class is added (this triggers the CSS transition/animation)                                | `class="my-animation ng-animate ng-enter ng-enter-active"` |
         * | 11. `$animate` waits for the animation to complete (via events and timeout)                                           | `class="my-animation ng-animate ng-enter ng-enter-active"` |
         * | 12. The animation ends and all generated CSS classes are removed from the element                                     | `class="my-animation"`                                     |
         * | 13. The returned promise is resolved.                                                                                 | `class="my-animation"`                                     |
         *
         * @param {DOMElement} element the element that will be the focus of the enter animation
         * @param {DOMElement} parentElement the parent element of the element that will be the focus of the enter animation
         * @param {DOMElement} afterElement the sibling element (which is the previous element) of the element that will be the focus of the enter animation
         * @param {object=} options an optional collection of options that will be picked up by the CSS transition/animation
         * @return {Promise} the animation callback promise
        */
        enter: function(element, parentElement, afterElement, options) {
          options = parseAnimateOptions(options);
          element = angular.element(element);
          parentElement = prepareElement(parentElement);
          afterElement = prepareElement(afterElement);

          classBasedAnimationsBlocked(element, true);
          $delegate.enter(element, parentElement, afterElement);
          return runAnimationPostDigest(function(done) {
            return performAnimation('enter', 'ng-enter', stripCommentsFromElement(element), parentElement, afterElement, noop, options, done);
          });
        },

        /**
         * @ngdoc method
         * @name $animate#leave
         * @kind function
         *
         * @description
         * Runs the leave animation operation and, upon completion, removes the element from the DOM. Once
         * the animation is started, the following CSS classes will be added for the duration of the animation:
         *
         * Below is a breakdown of each step that occurs during leave animation:
         *
         * | Animation Step                                                                                                        | What the element class attribute looks like                |
         * |-----------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|
         * | 1. `$animate.leave(...)` is called                                                                                    | `class="my-animation"`                                     |
         * | 2. `$animate` runs the JavaScript-defined animations detected on the element                                          | `class="my-animation ng-animate"`                          |
         * | 3. `$animate` waits for the next digest to start the animation                                                        | `class="my-animation ng-animate"`                          |
         * | 4. the `.ng-leave` class is added to the element                                                                      | `class="my-animation ng-animate ng-leave"`                 |
         * | 5. `$animate` scans the element styles to get the CSS transition/animation duration and delay                         | `class="my-animation ng-animate ng-leave"`                 |
         * | 6. `$animate` blocks all CSS transitions on the element to ensure the `.ng-leave` class styling is applied right away | `class="my-animation ng-animate ng-leave"`                 |
         * | 7. `$animate` waits for a single animation frame (this performs a reflow)                                             | `class="my-animation ng-animate ng-leave"`                 |
         * | 8. `$animate` removes the CSS transition block placed on the element                                                  | `class="my-animation ng-animate ng-leave"`                 |
         * | 9. the `.ng-leave-active` class is added (this triggers the CSS transition/animation)                                 | `class="my-animation ng-animate ng-leave ng-leave-active"` |
         * | 10. `$animate` waits for the animation to complete (via events and timeout)                                           | `class="my-animation ng-animate ng-leave ng-leave-active"` |
         * | 11. The animation ends and all generated CSS classes are removed from the element                                     | `class="my-animation"`                                     |
         * | 12. The element is removed from the DOM                                                                               | ...                                                        |
         * | 13. The returned promise is resolved.                                                                                 | ...                                                        |
         *
         * @param {DOMElement} element the element that will be the focus of the leave animation
         * @param {object=} options an optional collection of styles that will be picked up by the CSS transition/animation
         * @return {Promise} the animation callback promise
        */
        leave: function(element, options) {
          options = parseAnimateOptions(options);
          element = angular.element(element);

          cancelChildAnimations(element);
          classBasedAnimationsBlocked(element, true);
          return runAnimationPostDigest(function(done) {
            return performAnimation('leave', 'ng-leave', stripCommentsFromElement(element), null, null, function() {
              $delegate.leave(element);
            }, options, done);
          });
        },

        /**
         * @ngdoc method
         * @name $animate#move
         * @kind function
         *
         * @description
         * Fires the move DOM operation. Just before the animation starts, the animate service will either append it into the parentElement container or
         * add the element directly after the afterElement element if present. Then the move animation will be run. Once
         * the animation is started, the following CSS classes will be added for the duration of the animation:
         *
         * Below is a breakdown of each step that occurs during move animation:
         *
         * | Animation Step                                                                                                       | What the element class attribute looks like              |
         * |----------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|
         * | 1. `$animate.move(...)` is called                                                                                    | `class="my-animation"`                                   |
         * | 2. element is moved into the parentElement element or beside the afterElement element                                | `class="my-animation"`                                   |
         * | 3. `$animate` waits for the next digest to start the animation                                                       | `class="my-animation ng-animate"`                        |
         * | 4. `$animate` runs the JavaScript-defined animations detected on the element                                         | `class="my-animation ng-animate"`                        |
         * | 5. the `.ng-move` class is added to the element                                                                      | `class="my-animation ng-animate ng-move"`                |
         * | 6. `$animate` scans the element styles to get the CSS transition/animation duration and delay                        | `class="my-animation ng-animate ng-move"`                |
         * | 7. `$animate` blocks all CSS transitions on the element to ensure the `.ng-move` class styling is applied right away | `class="my-animation ng-animate ng-move"`                |
         * | 8. `$animate` waits for a single animation frame (this performs a reflow)                                            | `class="my-animation ng-animate ng-move"`                |
         * | 9. `$animate` removes the CSS transition block placed on the element                                                 | `class="my-animation ng-animate ng-move"`                |
         * | 10. the `.ng-move-active` class is added (this triggers the CSS transition/animation)                                | `class="my-animation ng-animate ng-move ng-move-active"` |
         * | 11. `$animate` waits for the animation to complete (via events and timeout)                                          | `class="my-animation ng-animate ng-move ng-move-active"` |
         * | 12. The animation ends and all generated CSS classes are removed from the element                                    | `class="my-animation"`                                   |
         * | 13. The returned promise is resolved.                                                                                | `class="my-animation"`                                   |
         *
         * @param {DOMElement} element the element that will be the focus of the move animation
         * @param {DOMElement} parentElement the parentElement element of the element that will be the focus of the move animation
         * @param {DOMElement} afterElement the sibling element (which is the previous element) of the element that will be the focus of the move animation
         * @param {object=} options an optional collection of styles that will be picked up by the CSS transition/animation
         * @return {Promise} the animation callback promise
        */
        move: function(element, parentElement, afterElement, options) {
          options = parseAnimateOptions(options);
          element = angular.element(element);
          parentElement = prepareElement(parentElement);
          afterElement = prepareElement(afterElement);

          cancelChildAnimations(element);
          classBasedAnimationsBlocked(element, true);
          $delegate.move(element, parentElement, afterElement);
          return runAnimationPostDigest(function(done) {
            return performAnimation('move', 'ng-move', stripCommentsFromElement(element), parentElement, afterElement, noop, options, done);
          });
        },

        /**
         * @ngdoc method
         * @name $animate#addClass
         *
         * @description
         * Triggers a custom animation event based off the className variable and then attaches the className value to the element as a CSS class.
         * Unlike the other animation methods, the animate service will suffix the className value with {@type -add} in order to provide
         * the animate service the setup and active CSS classes in order to trigger the animation (this will be skipped if no CSS transitions
         * or keyframes are defined on the -add-active or base CSS class).
         *
         * Below is a breakdown of each step that occurs during addClass animation:
         *
         * | Animation Step                                                                                         | What the element class attribute looks like                        |
         * |--------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|
         * | 1. `$animate.addClass(element, 'super')` is called                                                     | `class="my-animation"`                                             |
         * | 2. `$animate` runs the JavaScript-defined animations detected on the element                           | `class="my-animation ng-animate"`                                  |
         * | 3. the `.super-add` class is added to the element                                                      | `class="my-animation ng-animate super-add"`                        |
         * | 4. `$animate` waits for a single animation frame (this performs a reflow)                              | `class="my-animation ng-animate super-add"`                        |
         * | 5. the `.super` and `.super-add-active` classes are added (this triggers the CSS transition/animation) | `class="my-animation ng-animate super super-add super-add-active"` |
         * | 6. `$animate` scans the element styles to get the CSS transition/animation duration and delay          | `class="my-animation ng-animate super super-add super-add-active"` |
         * | 7. `$animate` waits for the animation to complete (via events and timeout)                             | `class="my-animation ng-animate super super-add super-add-active"` |
         * | 8. The animation ends and all generated CSS classes are removed from the element                       | `class="my-animation super"`                                       |
         * | 9. The super class is kept on the element                                                              | `class="my-animation super"`                                       |
         * | 10. The returned promise is resolved.                                                                  | `class="my-animation super"`                                       |
         *
         * @param {DOMElement} element the element that will be animated
         * @param {string} className the CSS class that will be added to the element and then animated
         * @param {object=} options an optional collection of styles that will be picked up by the CSS transition/animation
         * @return {Promise} the animation callback promise
        */
        addClass: function(element, className, options) {
          return this.setClass(element, className, [], options);
        },

        /**
         * @ngdoc method
         * @name $animate#removeClass
         *
         * @description
         * Triggers a custom animation event based off the className variable and then removes the CSS class provided by the className value
         * from the element. Unlike the other animation methods, the animate service will suffix the className value with {@type -remove} in
         * order to provide the animate service the setup and active CSS classes in order to trigger the animation (this will be skipped if
         * no CSS transitions or keyframes are defined on the -remove or base CSS classes).
         *
         * Below is a breakdown of each step that occurs during removeClass animation:
         *
         * | Animation Step                                                                                                       | What the element class attribute looks like                        |
         * |----------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|
         * | 1. `$animate.removeClass(element, 'super')` is called                                                                | `class="my-animation super"`                                       |
         * | 2. `$animate` runs the JavaScript-defined animations detected on the element                                         | `class="my-animation super ng-animate"`                            |
         * | 3. the `.super-remove` class is added to the element                                                                 | `class="my-animation super ng-animate super-remove"`               |
         * | 4. `$animate` waits for a single animation frame (this performs a reflow)                                            | `class="my-animation super ng-animate super-remove"`               |
         * | 5. the `.super-remove-active` classes are added and `.super` is removed (this triggers the CSS transition/animation) | `class="my-animation ng-animate super-remove super-remove-active"` |
         * | 6. `$animate` scans the element styles to get the CSS transition/animation duration and delay                        | `class="my-animation ng-animate super-remove super-remove-active"` |
         * | 7. `$animate` waits for the animation to complete (via events and timeout)                                           | `class="my-animation ng-animate super-remove super-remove-active"` |
         * | 8. The animation ends and all generated CSS classes are removed from the element                                     | `class="my-animation"`                                             |
         * | 9. The returned promise is resolved.                                                                                 | `class="my-animation"`                                             |
         *
         *
         * @param {DOMElement} element the element that will be animated
         * @param {string} className the CSS class that will be animated and then removed from the element
         * @param {object=} options an optional collection of styles that will be picked up by the CSS transition/animation
         * @return {Promise} the animation callback promise
        */
        removeClass: function(element, className, options) {
          return this.setClass(element, [], className, options);
        },

        /**
         *
         * @ngdoc method
         * @name $animate#setClass
         *
         * @description Adds and/or removes the given CSS classes to and from the element.
         * Once complete, the `done()` callback will be fired (if provided).
         *
         * | Animation Step                                                                                                                               | What the element class attribute looks like                                            |
         * |----------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------|
         * | 1. `$animate.setClass(element, 'on', 'off')` is called                                                                                       | `class="my-animation off"`                                                             |
         * | 2. `$animate` runs the JavaScript-defined animations detected on the element                                                                 | `class="my-animation ng-animate off"`                                                  |
         * | 3. the `.on-add` and `.off-remove` classes are added to the element                                                                          | `class="my-animation ng-animate on-add off-remove off"`                                |
         * | 4. `$animate` waits for a single animation frame (this performs a reflow)                                                                    | `class="my-animation ng-animate on-add off-remove off"`                                |
         * | 5. the `.on`, `.on-add-active` and `.off-remove-active` classes are added and `.off` is removed (this triggers the CSS transition/animation) | `class="my-animation ng-animate on on-add on-add-active off-remove off-remove-active"` |
         * | 6. `$animate` scans the element styles to get the CSS transition/animation duration and delay                                                | `class="my-animation ng-animate on on-add on-add-active off-remove off-remove-active"` |
         * | 7. `$animate` waits for the animation to complete (via events and timeout)                                                                   | `class="my-animation ng-animate on on-add on-add-active off-remove off-remove-active"` |
         * | 8. The animation ends and all generated CSS classes are removed from the element                                                             | `class="my-animation on"`                                                              |
         * | 9. The returned promise is resolved.                                                                                                         | `class="my-animation on"`                                                              |
         *
         * @param {DOMElement} element the element which will have its CSS classes changed
         *   removed from it
         * @param {string} add the CSS classes which will be added to the element
         * @param {string} remove the CSS class which will be removed from the element
         *   CSS classes have been set on the element
         * @param {object=} options an optional collection of styles that will be picked up by the CSS transition/animation
         * @return {Promise} the animation callback promise
         */
        setClass: function(element, add, remove, options) {
          options = parseAnimateOptions(options);

          var STORAGE_KEY = '$$animateClasses';
          element = angular.element(element);
          element = stripCommentsFromElement(element);

          if (classBasedAnimationsBlocked(element)) {
            return $delegate.$$setClassImmediately(element, add, remove, options);
          }

          // we're using a combined array for both the add and remove
          // operations since the ORDER OF addClass and removeClass matters
          var classes, cache = element.data(STORAGE_KEY);
          var hasCache = !!cache;
          if (!cache) {
            cache = {};
            cache.classes = {};
          }
          classes = cache.classes;

          add = isArray(add) ? add : add.split(' ');
          forEach(add, function(c) {
            if (c && c.length) {
              classes[c] = true;
            }
          });

          remove = isArray(remove) ? remove : remove.split(' ');
          forEach(remove, function(c) {
            if (c && c.length) {
              classes[c] = false;
            }
          });

          if (hasCache) {
            if (options && cache.options) {
              cache.options = angular.extend(cache.options || {}, options);
            }

            //the digest cycle will combine all the animations into one function
            return cache.promise;
          } else {
            element.data(STORAGE_KEY, cache = {
              classes: classes,
              options: options
            });
          }

          return cache.promise = runAnimationPostDigest(function(done) {
            var parentElement = element.parent();
            var elementNode = extractElementNode(element);
            var parentNode = elementNode.parentNode;
            // TODO(matsko): move this code into the animationsDisabled() function once #8092 is fixed
            if (!parentNode || parentNode['$$NG_REMOVED'] || elementNode['$$NG_REMOVED']) {
              done();
              return;
            }

            var cache = element.data(STORAGE_KEY);
            element.removeData(STORAGE_KEY);

            var state = element.data(NG_ANIMATE_STATE) || {};
            var classes = resolveElementClasses(element, cache, state.active);
            return !classes
              ? done()
              : performAnimation('setClass', classes, element, parentElement, null, function() {
                  if (classes[0]) $delegate.$$addClassImmediately(element, classes[0]);
                  if (classes[1]) $delegate.$$removeClassImmediately(element, classes[1]);
                }, cache.options, done);
          });
        },

        /**
         * @ngdoc method
         * @name $animate#cancel
         * @kind function
         *
         * @param {Promise} animationPromise The animation promise that is returned when an animation is started.
         *
         * @description
         * Cancels the provided animation.
        */
        cancel: function(promise) {
          promise.$$cancelFn();
        },

        /**
         * @ngdoc method
         * @name $animate#enabled
         * @kind function
         *
         * @param {boolean=} value If provided then set the animation on or off.
         * @param {DOMElement=} element If provided then the element will be used to represent the enable/disable operation
         * @return {boolean} Current animation state.
         *
         * @description
         * Globally enables/disables animations.
         *
        */
        enabled: function(value, element) {
          switch (arguments.length) {
            case 2:
              if (value) {
                cleanup(element);
              } else {
                var data = element.data(NG_ANIMATE_STATE) || {};
                data.disabled = true;
                element.data(NG_ANIMATE_STATE, data);
              }
            break;

            case 1:
              rootAnimateState.disabled = !value;
            break;

            default:
              value = !rootAnimateState.disabled;
            break;
          }
          return !!value;
         }
      };

      /*
        all animations call this shared animation triggering function internally.
        The animationEvent variable refers to the JavaScript animation event that will be triggered
        and the className value is the name of the animation that will be applied within the
        CSS code. Element, `parentElement` and `afterElement` are provided DOM elements for the animation
        and the onComplete callback will be fired once the animation is fully complete.
      */
      function performAnimation(animationEvent, className, element, parentElement, afterElement, domOperation, options, doneCallback) {
        var noopCancel = noop;
        var runner = animationRunner(element, animationEvent, className, options);
        if (!runner) {
          fireDOMOperation();
          fireBeforeCallbackAsync();
          fireAfterCallbackAsync();
          closeAnimation();
          return noopCancel;
        }

        animationEvent = runner.event;
        className = runner.className;
        var elementEvents = angular.element._data(runner.node);
        elementEvents = elementEvents && elementEvents.events;

        if (!parentElement) {
          parentElement = afterElement ? afterElement.parent() : element.parent();
        }

        //skip the animation if animations are disabled, a parent is already being animated,
        //the element is not currently attached to the document body or then completely close
        //the animation if any matching animations are not found at all.
        //NOTE: IE8 + IE9 should close properly (run closeAnimation()) in case an animation was found.
        if (animationsDisabled(element, parentElement)) {
          fireDOMOperation();
          fireBeforeCallbackAsync();
          fireAfterCallbackAsync();
          closeAnimation();
          return noopCancel;
        }

        var ngAnimateState  = element.data(NG_ANIMATE_STATE) || {};
        var runningAnimations     = ngAnimateState.active || {};
        var totalActiveAnimations = ngAnimateState.totalActive || 0;
        var lastAnimation         = ngAnimateState.last;
        var skipAnimation = false;

        if (totalActiveAnimations > 0) {
          var animationsToCancel = [];
          if (!runner.isClassBased) {
            if (animationEvent == 'leave' && runningAnimations['ng-leave']) {
              skipAnimation = true;
            } else {
              //cancel all animations when a structural animation takes place
              for (var klass in runningAnimations) {
                animationsToCancel.push(runningAnimations[klass]);
              }
              ngAnimateState = {};
              cleanup(element, true);
            }
          } else if (lastAnimation.event == 'setClass') {
            animationsToCancel.push(lastAnimation);
            cleanup(element, className);
          }
          else if (runningAnimations[className]) {
            var current = runningAnimations[className];
            if (current.event == animationEvent) {
              skipAnimation = true;
            } else {
              animationsToCancel.push(current);
              cleanup(element, className);
            }
          }

          if (animationsToCancel.length > 0) {
            forEach(animationsToCancel, function(operation) {
              operation.cancel();
            });
          }
        }

        if (runner.isClassBased
            && !runner.isSetClassOperation
            && animationEvent != 'animate'
            && !skipAnimation) {
          skipAnimation = (animationEvent == 'addClass') == element.hasClass(className); //opposite of XOR
        }

        if (skipAnimation) {
          fireDOMOperation();
          fireBeforeCallbackAsync();
          fireAfterCallbackAsync();
          fireDoneCallbackAsync();
          return noopCancel;
        }

        runningAnimations     = ngAnimateState.active || {};
        totalActiveAnimations = ngAnimateState.totalActive || 0;

        if (animationEvent == 'leave') {
          //there's no need to ever remove the listener since the element
          //will be removed (destroyed) after the leave animation ends or
          //is cancelled midway
          element.one('$destroy', function(e) {
            var element = angular.element(this);
            var state = element.data(NG_ANIMATE_STATE);
            if (state) {
              var activeLeaveAnimation = state.active['ng-leave'];
              if (activeLeaveAnimation) {
                activeLeaveAnimation.cancel();
                cleanup(element, 'ng-leave');
              }
            }
          });
        }

        //the ng-animate class does nothing, but it's here to allow for
        //parent animations to find and cancel child animations when needed
        $$jqLite.addClass(element, NG_ANIMATE_CLASS_NAME);
        if (options && options.tempClasses) {
          forEach(options.tempClasses, function(className) {
            $$jqLite.addClass(element, className);
          });
        }

        var localAnimationCount = globalAnimationCounter++;
        totalActiveAnimations++;
        runningAnimations[className] = runner;

        element.data(NG_ANIMATE_STATE, {
          last: runner,
          active: runningAnimations,
          index: localAnimationCount,
          totalActive: totalActiveAnimations
        });

        //first we run the before animations and when all of those are complete
        //then we perform the DOM operation and run the next set of animations
        fireBeforeCallbackAsync();
        runner.before(function(cancelled) {
          var data = element.data(NG_ANIMATE_STATE);
          cancelled = cancelled ||
                        !data || !data.active[className] ||
                        (runner.isClassBased && data.active[className].event != animationEvent);

          fireDOMOperation();
          if (cancelled === true) {
            closeAnimation();
          } else {
            fireAfterCallbackAsync();
            runner.after(closeAnimation);
          }
        });

        return runner.cancel;

        function fireDOMCallback(animationPhase) {
          var eventName = '$animate:' + animationPhase;
          if (elementEvents && elementEvents[eventName] && elementEvents[eventName].length > 0) {
            $$asyncCallback(function() {
              element.triggerHandler(eventName, {
                event: animationEvent,
                className: className
              });
            });
          }
        }

        function fireBeforeCallbackAsync() {
          fireDOMCallback('before');
        }

        function fireAfterCallbackAsync() {
          fireDOMCallback('after');
        }

        function fireDoneCallbackAsync() {
          fireDOMCallback('close');
          doneCallback();
        }

        //it is less complicated to use a flag than managing and canceling
        //timeouts containing multiple callbacks.
        function fireDOMOperation() {
          if (!fireDOMOperation.hasBeenRun) {
            fireDOMOperation.hasBeenRun = true;
            domOperation();
          }
        }

        function closeAnimation() {
          if (!closeAnimation.hasBeenRun) {
            if (runner) { //the runner doesn't exist if it fails to instantiate
              runner.applyStyles();
            }

            closeAnimation.hasBeenRun = true;
            if (options && options.tempClasses) {
              forEach(options.tempClasses, function(className) {
                $$jqLite.removeClass(element, className);
              });
            }

            var data = element.data(NG_ANIMATE_STATE);
            if (data) {

              /* only structural animations wait for reflow before removing an
                 animation, but class-based animations don't. An example of this
                 failing would be when a parent HTML tag has a ng-class attribute
                 causing ALL directives below to skip animations during the digest */
              if (runner && runner.isClassBased) {
                cleanup(element, className);
              } else {
                $$asyncCallback(function() {
                  var data = element.data(NG_ANIMATE_STATE) || {};
                  if (localAnimationCount == data.index) {
                    cleanup(element, className, animationEvent);
                  }
                });
                element.data(NG_ANIMATE_STATE, data);
              }
            }
            fireDoneCallbackAsync();
          }
        }
      }

      function cancelChildAnimations(element) {
        var node = extractElementNode(element);
        if (node) {
          var nodes = angular.isFunction(node.getElementsByClassName) ?
            node.getElementsByClassName(NG_ANIMATE_CLASS_NAME) :
            node.querySelectorAll('.' + NG_ANIMATE_CLASS_NAME);
          forEach(nodes, function(element) {
            element = angular.element(element);
            var data = element.data(NG_ANIMATE_STATE);
            if (data && data.active) {
              forEach(data.active, function(runner) {
                runner.cancel();
              });
            }
          });
        }
      }

      function cleanup(element, className) {
        if (isMatchingElement(element, $rootElement)) {
          if (!rootAnimateState.disabled) {
            rootAnimateState.running = false;
            rootAnimateState.structural = false;
          }
        } else if (className) {
          var data = element.data(NG_ANIMATE_STATE) || {};

          var removeAnimations = className === true;
          if (!removeAnimations && data.active && data.active[className]) {
            data.totalActive--;
            delete data.active[className];
          }

          if (removeAnimations || !data.totalActive) {
            $$jqLite.removeClass(element, NG_ANIMATE_CLASS_NAME);
            element.removeData(NG_ANIMATE_STATE);
          }
        }
      }

      function animationsDisabled(element, parentElement) {
        if (rootAnimateState.disabled) {
          return true;
        }

        if (isMatchingElement(element, $rootElement)) {
          return rootAnimateState.running;
        }

        var allowChildAnimations, parentRunningAnimation, hasParent;
        do {
          //the element did not reach the root element which means that it
          //is not apart of the DOM. Therefore there is no reason to do
          //any animations on it
          if (parentElement.length === 0) break;

          var isRoot = isMatchingElement(parentElement, $rootElement);
          var state = isRoot ? rootAnimateState : (parentElement.data(NG_ANIMATE_STATE) || {});
          if (state.disabled) {
            return true;
          }

          //no matter what, for an animation to work it must reach the root element
          //this implies that the element is attached to the DOM when the animation is run
          if (isRoot) {
            hasParent = true;
          }

          //once a flag is found that is strictly false then everything before
          //it will be discarded and all child animations will be restricted
          if (allowChildAnimations !== false) {
            var animateChildrenFlag = parentElement.data(NG_ANIMATE_CHILDREN);
            if (angular.isDefined(animateChildrenFlag)) {
              allowChildAnimations = animateChildrenFlag;
            }
          }

          parentRunningAnimation = parentRunningAnimation ||
                                   state.running ||
                                   (state.last && !state.last.isClassBased);
        }
        while (parentElement = parentElement.parent());

        return !hasParent || (!allowChildAnimations && parentRunningAnimation);
      }
    }]);

    $animateProvider.register('', ['$window', '$sniffer', '$timeout', '$$animateReflow',
                           function($window,   $sniffer,   $timeout,   $$animateReflow) {
      // Detect proper transitionend/animationend event names.
      var CSS_PREFIX = '', TRANSITION_PROP, TRANSITIONEND_EVENT, ANIMATION_PROP, ANIMATIONEND_EVENT;

      // If unprefixed events are not supported but webkit-prefixed are, use the latter.
      // Otherwise, just use W3C names, browsers not supporting them at all will just ignore them.
      // Note: Chrome implements `window.onwebkitanimationend` and doesn't implement `window.onanimationend`
      // but at the same time dispatches the `animationend` event and not `webkitAnimationEnd`.
      // Register both events in case `window.onanimationend` is not supported because of that,
      // do the same for `transitionend` as Safari is likely to exhibit similar behavior.
      // Also, the only modern browser that uses vendor prefixes for transitions/keyframes is webkit
      // therefore there is no reason to test anymore for other vendor prefixes: http://caniuse.com/#search=transition
      if (window.ontransitionend === undefined && window.onwebkittransitionend !== undefined) {
        CSS_PREFIX = '-webkit-';
        TRANSITION_PROP = 'WebkitTransition';
        TRANSITIONEND_EVENT = 'webkitTransitionEnd transitionend';
      } else {
        TRANSITION_PROP = 'transition';
        TRANSITIONEND_EVENT = 'transitionend';
      }

      if (window.onanimationend === undefined && window.onwebkitanimationend !== undefined) {
        CSS_PREFIX = '-webkit-';
        ANIMATION_PROP = 'WebkitAnimation';
        ANIMATIONEND_EVENT = 'webkitAnimationEnd animationend';
      } else {
        ANIMATION_PROP = 'animation';
        ANIMATIONEND_EVENT = 'animationend';
      }

      var DURATION_KEY = 'Duration';
      var PROPERTY_KEY = 'Property';
      var DELAY_KEY = 'Delay';
      var ANIMATION_ITERATION_COUNT_KEY = 'IterationCount';
      var ANIMATION_PLAYSTATE_KEY = 'PlayState';
      var NG_ANIMATE_PARENT_KEY = '$$ngAnimateKey';
      var NG_ANIMATE_CSS_DATA_KEY = '$$ngAnimateCSS3Data';
      var ELAPSED_TIME_MAX_DECIMAL_PLACES = 3;
      var CLOSING_TIME_BUFFER = 1.5;
      var ONE_SECOND = 1000;

      var lookupCache = {};
      var parentCounter = 0;
      var animationReflowQueue = [];
      var cancelAnimationReflow;
      function clearCacheAfterReflow() {
        if (!cancelAnimationReflow) {
          cancelAnimationReflow = $$animateReflow(function() {
            animationReflowQueue = [];
            cancelAnimationReflow = null;
            lookupCache = {};
          });
        }
      }

      function afterReflow(element, callback) {
        if (cancelAnimationReflow) {
          cancelAnimationReflow();
        }
        animationReflowQueue.push(callback);
        cancelAnimationReflow = $$animateReflow(function() {
          forEach(animationReflowQueue, function(fn) {
            fn();
          });

          animationReflowQueue = [];
          cancelAnimationReflow = null;
          lookupCache = {};
        });
      }

      var closingTimer = null;
      var closingTimestamp = 0;
      var animationElementQueue = [];
      function animationCloseHandler(element, totalTime) {
        var node = extractElementNode(element);
        element = angular.element(node);

        //this item will be garbage collected by the closing
        //animation timeout
        animationElementQueue.push(element);

        //but it may not need to cancel out the existing timeout
        //if the timestamp is less than the previous one
        var futureTimestamp = Date.now() + totalTime;
        if (futureTimestamp <= closingTimestamp) {
          return;
        }

        $timeout.cancel(closingTimer);

        closingTimestamp = futureTimestamp;
        closingTimer = $timeout(function() {
          closeAllAnimations(animationElementQueue);
          animationElementQueue = [];
        }, totalTime, false);
      }

      function closeAllAnimations(elements) {
        forEach(elements, function(element) {
          var elementData = element.data(NG_ANIMATE_CSS_DATA_KEY);
          if (elementData) {
            forEach(elementData.closeAnimationFns, function(fn) {
              fn();
            });
          }
        });
      }

      function getElementAnimationDetails(element, cacheKey) {
        var data = cacheKey ? lookupCache[cacheKey] : null;
        if (!data) {
          var transitionDuration = 0;
          var transitionDelay = 0;
          var animationDuration = 0;
          var animationDelay = 0;

          //we want all the styles defined before and after
          forEach(element, function(element) {
            if (element.nodeType == ELEMENT_NODE) {
              var elementStyles = $window.getComputedStyle(element) || {};

              var transitionDurationStyle = elementStyles[TRANSITION_PROP + DURATION_KEY];
              transitionDuration = Math.max(parseMaxTime(transitionDurationStyle), transitionDuration);

              var transitionDelayStyle = elementStyles[TRANSITION_PROP + DELAY_KEY];
              transitionDelay  = Math.max(parseMaxTime(transitionDelayStyle), transitionDelay);

              var animationDelayStyle = elementStyles[ANIMATION_PROP + DELAY_KEY];
              animationDelay   = Math.max(parseMaxTime(elementStyles[ANIMATION_PROP + DELAY_KEY]), animationDelay);

              var aDuration  = parseMaxTime(elementStyles[ANIMATION_PROP + DURATION_KEY]);

              if (aDuration > 0) {
                aDuration *= parseInt(elementStyles[ANIMATION_PROP + ANIMATION_ITERATION_COUNT_KEY], 10) || 1;
              }
              animationDuration = Math.max(aDuration, animationDuration);
            }
          });
          data = {
            total: 0,
            transitionDelay: transitionDelay,
            transitionDuration: transitionDuration,
            animationDelay: animationDelay,
            animationDuration: animationDuration
          };
          if (cacheKey) {
            lookupCache[cacheKey] = data;
          }
        }
        return data;
      }

      function parseMaxTime(str) {
        var maxValue = 0;
        var values = isString(str) ?
          str.split(/\s*,\s*/) :
          [];
        forEach(values, function(value) {
          maxValue = Math.max(parseFloat(value) || 0, maxValue);
        });
        return maxValue;
      }

      function getCacheKey(element) {
        var parentElement = element.parent();
        var parentID = parentElement.data(NG_ANIMATE_PARENT_KEY);
        if (!parentID) {
          parentElement.data(NG_ANIMATE_PARENT_KEY, ++parentCounter);
          parentID = parentCounter;
        }
        return parentID + '-' + extractElementNode(element).getAttribute('class');
      }

      function animateSetup(animationEvent, element, className, styles) {
        var structural = ['ng-enter','ng-leave','ng-move'].indexOf(className) >= 0;

        var cacheKey = getCacheKey(element);
        var eventCacheKey = cacheKey + ' ' + className;
        var itemIndex = lookupCache[eventCacheKey] ? ++lookupCache[eventCacheKey].total : 0;

        var stagger = {};
        if (itemIndex > 0) {
          var staggerClassName = className + '-stagger';
          var staggerCacheKey = cacheKey + ' ' + staggerClassName;
          var applyClasses = !lookupCache[staggerCacheKey];

          applyClasses && $$jqLite.addClass(element, staggerClassName);

          stagger = getElementAnimationDetails(element, staggerCacheKey);

          applyClasses && $$jqLite.removeClass(element, staggerClassName);
        }

        $$jqLite.addClass(element, className);

        var formerData = element.data(NG_ANIMATE_CSS_DATA_KEY) || {};
        var timings = getElementAnimationDetails(element, eventCacheKey);
        var transitionDuration = timings.transitionDuration;
        var animationDuration = timings.animationDuration;

        if (structural && transitionDuration === 0 && animationDuration === 0) {
          $$jqLite.removeClass(element, className);
          return false;
        }

        var blockTransition = styles || (structural && transitionDuration > 0);
        var blockAnimation = animationDuration > 0 &&
                             stagger.animationDelay > 0 &&
                             stagger.animationDuration === 0;

        var closeAnimationFns = formerData.closeAnimationFns || [];
        element.data(NG_ANIMATE_CSS_DATA_KEY, {
          stagger: stagger,
          cacheKey: eventCacheKey,
          running: formerData.running || 0,
          itemIndex: itemIndex,
          blockTransition: blockTransition,
          closeAnimationFns: closeAnimationFns
        });

        var node = extractElementNode(element);

        if (blockTransition) {
          blockTransitions(node, true);
          if (styles) {
            element.css(styles);
          }
        }

        if (blockAnimation) {
          blockAnimations(node, true);
        }

        return true;
      }

      function animateRun(animationEvent, element, className, activeAnimationComplete, styles) {
        var node = extractElementNode(element);
        var elementData = element.data(NG_ANIMATE_CSS_DATA_KEY);
        if (node.getAttribute('class').indexOf(className) == -1 || !elementData) {
          activeAnimationComplete();
          return;
        }

        var activeClassName = '';
        var pendingClassName = '';
        forEach(className.split(' '), function(klass, i) {
          var prefix = (i > 0 ? ' ' : '') + klass;
          activeClassName += prefix + '-active';
          pendingClassName += prefix + '-pending';
        });

        var style = '';
        var appliedStyles = [];
        var itemIndex = elementData.itemIndex;
        var stagger = elementData.stagger;
        var staggerTime = 0;
        if (itemIndex > 0) {
          var transitionStaggerDelay = 0;
          if (stagger.transitionDelay > 0 && stagger.transitionDuration === 0) {
            transitionStaggerDelay = stagger.transitionDelay * itemIndex;
          }

          var animationStaggerDelay = 0;
          if (stagger.animationDelay > 0 && stagger.animationDuration === 0) {
            animationStaggerDelay = stagger.animationDelay * itemIndex;
            appliedStyles.push(CSS_PREFIX + 'animation-play-state');
          }

          staggerTime = Math.round(Math.max(transitionStaggerDelay, animationStaggerDelay) * 100) / 100;
        }

        if (!staggerTime) {
          $$jqLite.addClass(element, activeClassName);
          if (elementData.blockTransition) {
            blockTransitions(node, false);
          }
        }

        var eventCacheKey = elementData.cacheKey + ' ' + activeClassName;
        var timings = getElementAnimationDetails(element, eventCacheKey);
        var maxDuration = Math.max(timings.transitionDuration, timings.animationDuration);
        if (maxDuration === 0) {
          $$jqLite.removeClass(element, activeClassName);
          animateClose(element, className);
          activeAnimationComplete();
          return;
        }

        if (!staggerTime && styles && Object.keys(styles).length > 0) {
          if (!timings.transitionDuration) {
            element.css('transition', timings.animationDuration + 's linear all');
            appliedStyles.push('transition');
          }
          element.css(styles);
        }

        var maxDelay = Math.max(timings.transitionDelay, timings.animationDelay);
        var maxDelayTime = maxDelay * ONE_SECOND;

        if (appliedStyles.length > 0) {
          //the element being animated may sometimes contain comment nodes in
          //the jqLite object, so we're safe to use a single variable to house
          //the styles since there is always only one element being animated
          var oldStyle = node.getAttribute('style') || '';
          if (oldStyle.charAt(oldStyle.length - 1) !== ';') {
            oldStyle += ';';
          }
          node.setAttribute('style', oldStyle + ' ' + style);
        }

        var startTime = Date.now();
        var css3AnimationEvents = ANIMATIONEND_EVENT + ' ' + TRANSITIONEND_EVENT;
        var animationTime     = (maxDelay + maxDuration) * CLOSING_TIME_BUFFER;
        var totalTime         = (staggerTime + animationTime) * ONE_SECOND;

        var staggerTimeout;
        if (staggerTime > 0) {
          $$jqLite.addClass(element, pendingClassName);
          staggerTimeout = $timeout(function() {
            staggerTimeout = null;

            if (timings.transitionDuration > 0) {
              blockTransitions(node, false);
            }
            if (timings.animationDuration > 0) {
              blockAnimations(node, false);
            }

            $$jqLite.addClass(element, activeClassName);
            $$jqLite.removeClass(element, pendingClassName);

            if (styles) {
              if (timings.transitionDuration === 0) {
                element.css('transition', timings.animationDuration + 's linear all');
              }
              element.css(styles);
              appliedStyles.push('transition');
            }
          }, staggerTime * ONE_SECOND, false);
        }

        element.on(css3AnimationEvents, onAnimationProgress);
        elementData.closeAnimationFns.push(function() {
          onEnd();
          activeAnimationComplete();
        });

        elementData.running++;
        animationCloseHandler(element, totalTime);
        return onEnd;

        // This will automatically be called by $animate so
        // there is no need to attach this internally to the
        // timeout done method.
        function onEnd() {
          element.off(css3AnimationEvents, onAnimationProgress);
          $$jqLite.removeClass(element, activeClassName);
          $$jqLite.removeClass(element, pendingClassName);
          if (staggerTimeout) {
            $timeout.cancel(staggerTimeout);
          }
          animateClose(element, className);
          var node = extractElementNode(element);
          for (var i in appliedStyles) {
            node.style.removeProperty(appliedStyles[i]);
          }
        }

        function onAnimationProgress(event) {
          event.stopPropagation();
          var ev = event.originalEvent || event;
          var timeStamp = ev.$manualTimeStamp || ev.timeStamp || Date.now();

          /* Firefox (or possibly just Gecko) likes to not round values up
           * when a ms measurement is used for the animation */
          var elapsedTime = parseFloat(ev.elapsedTime.toFixed(ELAPSED_TIME_MAX_DECIMAL_PLACES));

          /* $manualTimeStamp is a mocked timeStamp value which is set
           * within browserTrigger(). This is only here so that tests can
           * mock animations properly. Real events fallback to event.timeStamp,
           * or, if they don't, then a timeStamp is automatically created for them.
           * We're checking to see if the timeStamp surpasses the expected delay,
           * but we're using elapsedTime instead of the timeStamp on the 2nd
           * pre-condition since animations sometimes close off early */
          if (Math.max(timeStamp - startTime, 0) >= maxDelayTime && elapsedTime >= maxDuration) {
            activeAnimationComplete();
          }
        }
      }

      function blockTransitions(node, bool) {
        node.style[TRANSITION_PROP + PROPERTY_KEY] = bool ? 'none' : '';
      }

      function blockAnimations(node, bool) {
        node.style[ANIMATION_PROP + ANIMATION_PLAYSTATE_KEY] = bool ? 'paused' : '';
      }

      function animateBefore(animationEvent, element, className, styles) {
        if (animateSetup(animationEvent, element, className, styles)) {
          return function(cancelled) {
            cancelled && animateClose(element, className);
          };
        }
      }

      function animateAfter(animationEvent, element, className, afterAnimationComplete, styles) {
        if (element.data(NG_ANIMATE_CSS_DATA_KEY)) {
          return animateRun(animationEvent, element, className, afterAnimationComplete, styles);
        } else {
          animateClose(element, className);
          afterAnimationComplete();
        }
      }

      function animate(animationEvent, element, className, animationComplete, options) {
        //If the animateSetup function doesn't bother returning a
        //cancellation function then it means that there is no animation
        //to perform at all
        var preReflowCancellation = animateBefore(animationEvent, element, className, options.from);
        if (!preReflowCancellation) {
          clearCacheAfterReflow();
          animationComplete();
          return;
        }

        //There are two cancellation functions: one is before the first
        //reflow animation and the second is during the active state
        //animation. The first function will take care of removing the
        //data from the element which will not make the 2nd animation
        //happen in the first place
        var cancel = preReflowCancellation;
        afterReflow(element, function() {
          //once the reflow is complete then we point cancel to
          //the new cancellation function which will remove all of the
          //animation properties from the active animation
          cancel = animateAfter(animationEvent, element, className, animationComplete, options.to);
        });

        return function(cancelled) {
          (cancel || noop)(cancelled);
        };
      }

      function animateClose(element, className) {
        $$jqLite.removeClass(element, className);
        var data = element.data(NG_ANIMATE_CSS_DATA_KEY);
        if (data) {
          if (data.running) {
            data.running--;
          }
          if (!data.running || data.running === 0) {
            element.removeData(NG_ANIMATE_CSS_DATA_KEY);
          }
        }
      }

      return {
        animate: function(element, className, from, to, animationCompleted, options) {
          options = options || {};
          options.from = from;
          options.to = to;
          return animate('animate', element, className, animationCompleted, options);
        },

        enter: function(element, animationCompleted, options) {
          options = options || {};
          return animate('enter', element, 'ng-enter', animationCompleted, options);
        },

        leave: function(element, animationCompleted, options) {
          options = options || {};
          return animate('leave', element, 'ng-leave', animationCompleted, options);
        },

        move: function(element, animationCompleted, options) {
          options = options || {};
          return animate('move', element, 'ng-move', animationCompleted, options);
        },

        beforeSetClass: function(element, add, remove, animationCompleted, options) {
          options = options || {};
          var className = suffixClasses(remove, '-remove') + ' ' +
                          suffixClasses(add, '-add');
          var cancellationMethod = animateBefore('setClass', element, className, options.from);
          if (cancellationMethod) {
            afterReflow(element, animationCompleted);
            return cancellationMethod;
          }
          clearCacheAfterReflow();
          animationCompleted();
        },

        beforeAddClass: function(element, className, animationCompleted, options) {
          options = options || {};
          var cancellationMethod = animateBefore('addClass', element, suffixClasses(className, '-add'), options.from);
          if (cancellationMethod) {
            afterReflow(element, animationCompleted);
            return cancellationMethod;
          }
          clearCacheAfterReflow();
          animationCompleted();
        },

        beforeRemoveClass: function(element, className, animationCompleted, options) {
          options = options || {};
          var cancellationMethod = animateBefore('removeClass', element, suffixClasses(className, '-remove'), options.from);
          if (cancellationMethod) {
            afterReflow(element, animationCompleted);
            return cancellationMethod;
          }
          clearCacheAfterReflow();
          animationCompleted();
        },

        setClass: function(element, add, remove, animationCompleted, options) {
          options = options || {};
          remove = suffixClasses(remove, '-remove');
          add = suffixClasses(add, '-add');
          var className = remove + ' ' + add;
          return animateAfter('setClass', element, className, animationCompleted, options.to);
        },

        addClass: function(element, className, animationCompleted, options) {
          options = options || {};
          return animateAfter('addClass', element, suffixClasses(className, '-add'), animationCompleted, options.to);
        },

        removeClass: function(element, className, animationCompleted, options) {
          options = options || {};
          return animateAfter('removeClass', element, suffixClasses(className, '-remove'), animationCompleted, options.to);
        }
      };

      function suffixClasses(classes, suffix) {
        var className = '';
        classes = isArray(classes) ? classes : classes.split(/\s+/);
        forEach(classes, function(klass, i) {
          if (klass && klass.length > 0) {
            className += (i > 0 ? ' ' : '') + klass + suffix;
          }
        });
        return className;
      }
    }]);
  }]);


})(window, window.angular);

/**
 * @license AngularJS v1.3.11
 * (c) 2010-2014 Google, Inc. http://angularjs.org
 * License: MIT
 */
(function(window, angular, undefined) {'use strict';

/**
 * @ngdoc module
 * @name ngAria
 * @description
 *
 * The `ngAria` module provides support for common
 * [<abbr title="Accessible Rich Internet Applications">ARIA</abbr>](http://www.w3.org/TR/wai-aria/)
 * attributes that convey state or semantic information about the application for users
 * of assistive technologies, such as screen readers.
 *
 * <div doc-module-components="ngAria"></div>
 *
 * ## Usage
 *
 * For ngAria to do its magic, simply include the module as a dependency. The directives supported
 * by ngAria are:
 * `ngModel`, `ngDisabled`, `ngShow`, `ngHide`, `ngClick`, `ngDblClick`, and `ngMessages`.
 *
 * Below is a more detailed breakdown of the attributes handled by ngAria:
 *
 * | Directive                                   | Supported Attributes                                                                   |
 * |---------------------------------------------|----------------------------------------------------------------------------------------|
 * | {@link ng.directive:ngModel ngModel}        | aria-checked, aria-valuemin, aria-valuemax, aria-valuenow, aria-invalid, aria-required |
 * | {@link ng.directive:ngDisabled ngDisabled}  | aria-disabled                                                                          |
 * | {@link ng.directive:ngShow ngShow}          | aria-hidden                                                                            |
 * | {@link ng.directive:ngHide ngHide}          | aria-hidden                                                                            |
 * | {@link ng.directive:ngClick ngClick}        | tabindex, keypress event                                                               |
 * | {@link ng.directive:ngDblclick ngDblclick}  | tabindex                                                                               |
 * | {@link module:ngMessages ngMessages}        | aria-live                                                                              |
 *
 * Find out more information about each directive by reading the
 * {@link guide/accessibility ngAria Developer Guide}.
 *
 * ##Example
 * Using ngDisabled with ngAria:
 * ```html
 * <md-checkbox ng-disabled="disabled">
 * ```
 * Becomes:
 * ```html
 * <md-checkbox ng-disabled="disabled" aria-disabled="true">
 * ```
 *
 * ##Disabling Attributes
 * It's possible to disable individual attributes added by ngAria with the
 * {@link ngAria.$ariaProvider#config config} method. For more details, see the
 * {@link guide/accessibility Developer Guide}.
 */
 /* global -ngAriaModule */
var ngAriaModule = angular.module('ngAria', ['ng']).
                        provider('$aria', $AriaProvider);

/**
 * @ngdoc provider
 * @name $ariaProvider
 *
 * @description
 *
 * Used for configuring the ARIA attributes injected and managed by ngAria.
 *
 * ```js
 * angular.module('myApp', ['ngAria'], function config($ariaProvider) {
 *   $ariaProvider.config({
 *     ariaValue: true,
 *     tabindex: false
 *   });
 * });
 *```
 *
 * ## Dependencies
 * Requires the {@link ngAria} module to be installed.
 *
 */
function $AriaProvider() {
  var config = {
    ariaHidden: true,
    ariaChecked: true,
    ariaDisabled: true,
    ariaRequired: true,
    ariaInvalid: true,
    ariaMultiline: true,
    ariaValue: true,
    tabindex: true,
    bindKeypress: true
  };

  /**
   * @ngdoc method
   * @name $ariaProvider#config
   *
   * @param {object} config object to enable/disable specific ARIA attributes
   *
   *  - **ariaHidden** – `{boolean}` – Enables/disables aria-hidden tags
   *  - **ariaChecked** – `{boolean}` – Enables/disables aria-checked tags
   *  - **ariaDisabled** – `{boolean}` – Enables/disables aria-disabled tags
   *  - **ariaRequired** – `{boolean}` – Enables/disables aria-required tags
   *  - **ariaInvalid** – `{boolean}` – Enables/disables aria-invalid tags
   *  - **ariaMultiline** – `{boolean}` – Enables/disables aria-multiline tags
   *  - **ariaValue** – `{boolean}` – Enables/disables aria-valuemin, aria-valuemax and aria-valuenow tags
   *  - **tabindex** – `{boolean}` – Enables/disables tabindex tags
   *  - **bindKeypress** – `{boolean}` – Enables/disables keypress event binding on ng-click
   *
   * @description
   * Enables/disables various ARIA attributes
   */
  this.config = function(newConfig) {
    config = angular.extend(config, newConfig);
  };

  function watchExpr(attrName, ariaAttr, negate) {
    return function(scope, elem, attr) {
      var ariaCamelName = attr.$normalize(ariaAttr);
      if (config[ariaCamelName] && !attr[ariaCamelName]) {
        scope.$watch(attr[attrName], function(boolVal) {
          if (negate) {
            boolVal = !boolVal;
          }
          elem.attr(ariaAttr, boolVal);
        });
      }
    };
  }

  /**
   * @ngdoc service
   * @name $aria
   *
   * @description
   *
   * The $aria service contains helper methods for applying common
   * [ARIA](http://www.w3.org/TR/wai-aria/) attributes to HTML directives.
   *
   * ngAria injects common accessibility attributes that tell assistive technologies when HTML
   * elements are enabled, selected, hidden, and more. To see how this is performed with ngAria,
   * let's review a code snippet from ngAria itself:
   *
   *```js
   * ngAriaModule.directive('ngDisabled', ['$aria', function($aria) {
   *   return $aria.$$watchExpr('ngDisabled', 'aria-disabled');
   * }])
   *```
   * Shown above, the ngAria module creates a directive with the same signature as the
   * traditional `ng-disabled` directive. But this ngAria version is dedicated to
   * solely managing accessibility attributes. The internal `$aria` service is used to watch the
   * boolean attribute `ngDisabled`. If it has not been explicitly set by the developer,
   * `aria-disabled` is injected as an attribute with its value synchronized to the value in
   * `ngDisabled`.
   *
   * Because ngAria hooks into the `ng-disabled` directive, developers do not have to do
   * anything to enable this feature. The `aria-disabled` attribute is automatically managed
   * simply as a silent side-effect of using `ng-disabled` with the ngAria module.
   *
   * The full list of directives that interface with ngAria:
   * * **ngModel**
   * * **ngShow**
   * * **ngHide**
   * * **ngClick**
   * * **ngDblclick**
   * * **ngMessages**
   * * **ngDisabled**
   *
   * Read the {@link guide/accessibility ngAria Developer Guide} for a thorough explanation of each
   * directive.
   *
   *
   * ## Dependencies
   * Requires the {@link ngAria} module to be installed.
   */
  this.$get = function() {
    return {
      config: function(key) {
        return config[key];
      },
      $$watchExpr: watchExpr
    };
  };
}


ngAriaModule.directive('ngShow', ['$aria', function($aria) {
  return $aria.$$watchExpr('ngShow', 'aria-hidden', true);
}])
.directive('ngHide', ['$aria', function($aria) {
  return $aria.$$watchExpr('ngHide', 'aria-hidden', false);
}])
.directive('ngModel', ['$aria', function($aria) {

  function shouldAttachAttr(attr, normalizedAttr, elem) {
    return $aria.config(normalizedAttr) && !elem.attr(attr);
  }

  function getShape(attr, elem) {
    var type = attr.type,
        role = attr.role;

    return ((type || role) === 'checkbox' || role === 'menuitemcheckbox') ? 'checkbox' :
           ((type || role) === 'radio'    || role === 'menuitemradio') ? 'radio' :
           (type === 'range'              || role === 'progressbar' || role === 'slider') ? 'range' :
           (type || role) === 'textbox'   || elem[0].nodeName === 'TEXTAREA' ? 'multiline' : '';
  }

  return {
    restrict: 'A',
    require: '?ngModel',
    link: function(scope, elem, attr, ngModel) {
      var shape = getShape(attr, elem);
      var needsTabIndex = shouldAttachAttr('tabindex', 'tabindex', elem);

      function ngAriaWatchModelValue() {
        return ngModel.$modelValue;
      }

      function getRadioReaction() {
        if (needsTabIndex) {
          needsTabIndex = false;
          return function ngAriaRadioReaction(newVal) {
            var boolVal = newVal === attr.value;
            elem.attr('aria-checked', boolVal);
            elem.attr('tabindex', 0 - !boolVal);
          };
        } else {
          return function ngAriaRadioReaction(newVal) {
            elem.attr('aria-checked', newVal === attr.value);
          };
        }
      }

      function ngAriaCheckboxReaction(newVal) {
        elem.attr('aria-checked', !!newVal);
      }

      switch (shape) {
        case 'radio':
        case 'checkbox':
          if (shouldAttachAttr('aria-checked', 'ariaChecked', elem)) {
            scope.$watch(ngAriaWatchModelValue, shape === 'radio' ?
                getRadioReaction() : ngAriaCheckboxReaction);
          }
          break;
        case 'range':
          if ($aria.config('ariaValue')) {
            if (attr.min && !elem.attr('aria-valuemin')) {
              elem.attr('aria-valuemin', attr.min);
            }
            if (attr.max && !elem.attr('aria-valuemax')) {
              elem.attr('aria-valuemax', attr.max);
            }
            if (!elem.attr('aria-valuenow')) {
              scope.$watch(ngAriaWatchModelValue, function ngAriaValueNowReaction(newVal) {
                elem.attr('aria-valuenow', newVal);
              });
            }
          }
          break;
        case 'multiline':
          if (shouldAttachAttr('aria-multiline', 'ariaMultiline', elem)) {
            elem.attr('aria-multiline', true);
          }
          break;
      }

      if (needsTabIndex) {
        elem.attr('tabindex', 0);
      }

      if (ngModel.$validators.required && shouldAttachAttr('aria-required', 'ariaRequired', elem)) {
        scope.$watch(function ngAriaRequiredWatch() {
          return ngModel.$error.required;
        }, function ngAriaRequiredReaction(newVal) {
          elem.attr('aria-required', !!newVal);
        });
      }

      if (shouldAttachAttr('aria-invalid', 'ariaInvalid', elem)) {
        scope.$watch(function ngAriaInvalidWatch() {
          return ngModel.$invalid;
        }, function ngAriaInvalidReaction(newVal) {
          elem.attr('aria-invalid', !!newVal);
        });
      }
    }
  };
}])
.directive('ngDisabled', ['$aria', function($aria) {
  return $aria.$$watchExpr('ngDisabled', 'aria-disabled');
}])
.directive('ngMessages', function() {
  return {
    restrict: 'A',
    require: '?ngMessages',
    link: function(scope, elem, attr, ngMessages) {
      if (!elem.attr('aria-live')) {
        elem.attr('aria-live', 'assertive');
      }
    }
  };
})
.directive('ngClick',['$aria', '$parse', function($aria, $parse) {
  return {
    restrict: 'A',
    compile: function(elem, attr) {
      var fn = $parse(attr.ngClick, /* interceptorFn */ null, /* expensiveChecks */ true);
      return function(scope, elem, attr) {
        if ($aria.config('tabindex') && !elem.attr('tabindex')) {
          elem.attr('tabindex', 0);
        }

        if ($aria.config('bindKeypress') && !attr.ngKeypress) {
          elem.on('keypress', function(event) {
            if (event.keyCode === 32 || event.keyCode === 13) {
              scope.$apply(callback);
            }

            function callback() {
              fn(scope, { $event: event });
            }
          });
        }
      };
    }
  };
}])
.directive('ngDblclick', ['$aria', function($aria) {
  return function(scope, elem, attr) {
    if ($aria.config('tabindex') && !elem.attr('tabindex')) {
      elem.attr('tabindex', 0);
    }
  };
}]);


})(window, window.angular);

/*!
 * Angular Material Design
 * https://github.com/angular/material
 * @license MIT
 * v0.10.0-master-6e9abdd
 */
(function( window, angular, undefined ){
"use strict";

(function(){
"use strict";

angular.module('ngMaterial', ["ng","ngAnimate","ngAria","material.core","material.core.gestures","material.core.theming.palette","material.core.theming","material.components.autocomplete","material.components.backdrop","material.components.bottomSheet","material.components.button","material.components.card","material.components.checkbox","material.components.chips","material.components.content","material.components.dialog","material.components.divider","material.components.fabActions","material.components.fabSpeedDial","material.components.fabToolbar","material.components.fabTrigger","material.components.gridList","material.components.icon","material.components.input","material.components.list","material.components.menu","material.components.progressCircular","material.components.progressLinear","material.components.radioButton","material.components.select","material.components.sidenav","material.components.slider","material.components.sticky","material.components.subheader","material.components.swipe","material.components.switch","material.components.tabs","material.components.toast","material.components.toolbar","material.components.tooltip","material.components.whiteframe"]);
})();
(function(){
"use strict";


/**
 * Initialization function that validates environment
 * requirements.
 */
angular
  .module('material.core', [ 'material.core.gestures', 'material.core.theming' ])
  .config( MdCoreConfigure );


function MdCoreConfigure($provide, $mdThemingProvider) {

  $provide.decorator('$$rAF', ["$delegate", rAFDecorator]);

  $mdThemingProvider.theme('default')
    .primaryPalette('indigo')
    .accentPalette('pink')
    .warnPalette('red')
    .backgroundPalette('grey');
}
MdCoreConfigure.$inject = ["$provide", "$mdThemingProvider"];

function rAFDecorator( $delegate ) {
  /**
   * Use this to throttle events that come in often.
   * The throttled function will always use the *last* invocation before the
   * coming frame.
   *
   * For example, window resize events that fire many times a second:
   * If we set to use an raf-throttled callback on window resize, then
   * our callback will only be fired once per frame, with the last resize
   * event that happened before that frame.
   *
   * @param {function} callback function to debounce
   */
  $delegate.throttle = function(cb) {
    var queueArgs, alreadyQueued, queueCb, context;
    return function debounced() {
      queueArgs = arguments;
      context = this;
      queueCb = cb;
      if (!alreadyQueued) {
        alreadyQueued = true;
        $delegate(function() {
          queueCb.apply(context, queueArgs);
          alreadyQueued = false;
        });
      }
    };
  };
  return $delegate;
}

})();
(function(){
"use strict";

angular.module('material.core')
.factory('$mdConstant', MdConstantFactory);

function MdConstantFactory($$rAF, $sniffer) {

  var webkit = /webkit/i.test($sniffer.vendorPrefix);
  function vendorProperty(name) {
    return webkit ?  ('webkit' + name.charAt(0).toUpperCase() + name.substring(1)) : name;
  }

  return {
    KEY_CODE: {
      ENTER: 13,
      ESCAPE: 27,
      SPACE: 32,
      LEFT_ARROW : 37,
      UP_ARROW : 38,
      RIGHT_ARROW : 39,
      DOWN_ARROW : 40,
      TAB : 9,
      BACKSPACE: 8,
      DELETE: 46
    },
    CSS: {
      /* Constants */
      TRANSITIONEND: 'transitionend' + (webkit ? ' webkitTransitionEnd' : ''),
      ANIMATIONEND: 'animationend' + (webkit ? ' webkitAnimationEnd' : ''),

      TRANSFORM: vendorProperty('transform'),
      TRANSFORM_ORIGIN: vendorProperty('transformOrigin'),
      TRANSITION: vendorProperty('transition'),
      TRANSITION_DURATION: vendorProperty('transitionDuration'),
      ANIMATION_PLAY_STATE: vendorProperty('animationPlayState'),
      ANIMATION_DURATION: vendorProperty('animationDuration'),
      ANIMATION_NAME: vendorProperty('animationName'),
      ANIMATION_TIMING: vendorProperty('animationTimingFunction'),
      ANIMATION_DIRECTION: vendorProperty('animationDirection')
    },
    MEDIA: {
      'sm': '(max-width: 600px)',
      'gt-sm': '(min-width: 600px)',
      'md': '(min-width: 600px) and (max-width: 960px)',
      'gt-md': '(min-width: 960px)',
      'lg': '(min-width: 960px) and (max-width: 1200px)',
      'gt-lg': '(min-width: 1200px)'
    },
    MEDIA_PRIORITY: [
      'gt-lg',
      'lg',
      'gt-md',
      'md',
      'gt-sm',
      'sm'
    ]
  };
}
MdConstantFactory.$inject = ["$$rAF", "$sniffer"];

})();
(function(){
"use strict";

  angular
    .module('material.core')
    .config( ["$provide", function($provide){
       $provide.decorator('$mdUtil', ['$delegate', function ($delegate){
           /**
            * Inject the iterator facade to easily support iteration and accessors
            * @see iterator below
            */
           $delegate.iterator = MdIterator;

           return $delegate;
         }
       ]);
     }]);

  /**
   * iterator is a list facade to easily support iteration and accessors
   *
   * @param items Array list which this iterator will enumerate
   * @param reloop Boolean enables iterator to consider the list as an endless reloop
   */
  function MdIterator(items, reloop) {
    var trueFn = function() { return true; };

    if (items && !angular.isArray(items)) {
      items = Array.prototype.slice.call(items);
    }

    reloop = !!reloop;
    var _items = items || [ ];

    // Published API
    return {
      items: getItems,
      count: count,

      inRange: inRange,
      contains: contains,
      indexOf: indexOf,
      itemAt: itemAt,

      findBy: findBy,

      add: add,
      remove: remove,

      first: first,
      last: last,
      next: angular.bind(null, findSubsequentItem, false),
      previous: angular.bind(null, findSubsequentItem, true),

      hasPrevious: hasPrevious,
      hasNext: hasNext

    };

    /**
     * Publish copy of the enumerable set
     * @returns {Array|*}
     */
    function getItems() {
      return [].concat(_items);
    }

    /**
     * Determine length of the list
     * @returns {Array.length|*|number}
     */
    function count() {
      return _items.length;
    }

    /**
     * Is the index specified valid
     * @param index
     * @returns {Array.length|*|number|boolean}
     */
    function inRange(index) {
      return _items.length && ( index > -1 ) && (index < _items.length );
    }

    /**
     * Can the iterator proceed to the next item in the list; relative to
     * the specified item.
     *
     * @param item
     * @returns {Array.length|*|number|boolean}
     */
    function hasNext(item) {
      return item ? inRange(indexOf(item) + 1) : false;
    }

    /**
     * Can the iterator proceed to the previous item in the list; relative to
     * the specified item.
     *
     * @param item
     * @returns {Array.length|*|number|boolean}
     */
    function hasPrevious(item) {
      return item ? inRange(indexOf(item) - 1) : false;
    }

    /**
     * Get item at specified index/position
     * @param index
     * @returns {*}
     */
    function itemAt(index) {
      return inRange(index) ? _items[index] : null;
    }

    /**
     * Find all elements matching the key/value pair
     * otherwise return null
     *
     * @param val
     * @param key
     *
     * @return array
     */
    function findBy(key, val) {
      return _items.filter(function(item) {
        return item[key] === val;
      });
    }

    /**
     * Add item to list
     * @param item
     * @param index
     * @returns {*}
     */
    function add(item, index) {
      if ( !item ) return -1;

      if (!angular.isNumber(index)) {
        index = _items.length;
      }

      _items.splice(index, 0, item);

      return indexOf(item);
    }

    /**
     * Remove item from list...
     * @param item
     */
    function remove(item) {
      if ( contains(item) ){
        _items.splice(indexOf(item), 1);
      }
    }

    /**
     * Get the zero-based index of the target item
     * @param item
     * @returns {*}
     */
    function indexOf(item) {
      return _items.indexOf(item);
    }

    /**
     * Boolean existence check
     * @param item
     * @returns {boolean}
     */
    function contains(item) {
      return item && (indexOf(item) > -1);
    }

    /**
     * Return first item in the list
     * @returns {*}
     */
    function first() {
      return _items.length ? _items[0] : null;
    }

    /**
     * Return last item in the list...
     * @returns {*}
     */
    function last() {
      return _items.length ? _items[_items.length - 1] : null;
    }

    /**
     * Find the next item. If reloop is true and at the end of the list, it will go back to the
     * first item. If given, the `validate` callback will be used to determine whether the next item
     * is valid. If not valid, it will try to find the next item again.
     *
     * @param {boolean} backwards Specifies the direction of searching (forwards/backwards)
     * @param {*} item The item whose subsequent item we are looking for
     * @param {Function=} validate The `validate` function
     * @param {integer=} limit The recursion limit
     *
     * @returns {*} The subsequent item or null
     */
    function findSubsequentItem(backwards, item, validate, limit) {
      validate = validate || trueFn;

      var curIndex = indexOf(item);
      while (true) {
        if (!inRange(curIndex)) return null;

        var nextIndex = curIndex + (backwards ? -1 : 1);
        var foundItem = null;
        if (inRange(nextIndex)) {
          foundItem = _items[nextIndex];
        } else if (reloop) {
          foundItem = backwards ? last() : first();
          nextIndex = indexOf(foundItem);
        }

        if ((foundItem === null) || (nextIndex === limit)) return null;
        if (validate(foundItem)) return foundItem;

        if (angular.isUndefined(limit)) limit = nextIndex;

        curIndex = nextIndex;
      }
    }
  }


})();
(function(){
"use strict";

angular.module('material.core')
.factory('$mdMedia', mdMediaFactory);

/**
 * @ngdoc service
 * @name $mdMedia
 * @module material.core
 *
 * @description
 * `$mdMedia` is used to evaluate whether a given media query is true or false given the
 * current device's screen / window size. The media query will be re-evaluated on resize, allowing
 * you to register a watch.
 *
 * `$mdMedia` also has pre-programmed support for media queries that match the layout breakpoints.
 *  (`sm`, `gt-sm`, `md`, `gt-md`, `lg`, `gt-lg`).
 *
 * @returns {boolean} a boolean representing whether or not the given media query is true or false.
 *
 * @usage
 * <hljs lang="js">
 * app.controller('MyController', function($mdMedia, $scope) {
 *   $scope.$watch(function() { return $mdMedia('lg'); }, function(big) {
 *     $scope.bigScreen = big;
 *   });
 *
 *   $scope.screenIsSmall = $mdMedia('sm');
 *   $scope.customQuery = $mdMedia('(min-width: 1234px)');
 *   $scope.anotherCustom = $mdMedia('max-width: 300px');
 * });
 * </hljs>
 */

function mdMediaFactory($mdConstant, $rootScope, $window) {
  var queries = {};
  var mqls = {};
  var results = {};
  var normalizeCache = {};

  $mdMedia.getResponsiveAttribute = getResponsiveAttribute;
  $mdMedia.getQuery = getQuery;
  $mdMedia.watchResponsiveAttributes = watchResponsiveAttributes;

  return $mdMedia;

  function $mdMedia(query) {
    var validated = queries[query];
    if (angular.isUndefined(validated)) {
      validated = queries[query] = validate(query);
    }

    var result = results[validated];
    if (angular.isUndefined(result)) {
      result = add(validated);
    }

    return result;
  }

  function validate(query) {
    return $mdConstant.MEDIA[query] ||
           ((query.charAt(0) !== '(') ? ('(' + query + ')') : query);
  }

  function add(query) {
    var result = mqls[query] = $window.matchMedia(query);
    result.addListener(onQueryChange);
    return (results[result.media] = !!result.matches);
  }

  function onQueryChange(query) {
    $rootScope.$evalAsync(function() {
      results[query.media] = !!query.matches;
    });
  }

  function getQuery(name) {
    return mqls[name];
  }

  function getResponsiveAttribute(attrs, attrName) {
    for (var i = 0; i < $mdConstant.MEDIA_PRIORITY.length; i++) {
      var mediaName = $mdConstant.MEDIA_PRIORITY[i];
      if (!mqls[queries[mediaName]].matches) {
        continue;
      }

      var normalizedName = getNormalizedName(attrs, attrName + '-' + mediaName);
      if (attrs[normalizedName]) {
        return attrs[normalizedName];
      }
    }

    // fallback on unprefixed
    return attrs[getNormalizedName(attrs, attrName)];
  }

  function watchResponsiveAttributes(attrNames, attrs, watchFn) {
    var unwatchFns = [];
    attrNames.forEach(function(attrName) {
      var normalizedName = getNormalizedName(attrs, attrName);
      if (attrs[normalizedName]) {
        unwatchFns.push(
            attrs.$observe(normalizedName, angular.bind(void 0, watchFn, null)));
      }

      for (var mediaName in $mdConstant.MEDIA) {
        normalizedName = getNormalizedName(attrs, attrName + '-' + mediaName);
        if (!attrs[normalizedName]) {
          return;
        }

        unwatchFns.push(attrs.$observe(normalizedName, angular.bind(void 0, watchFn, mediaName)));
      }
    });

    return function unwatch() {
      unwatchFns.forEach(function(fn) { fn(); })
    };
  }

  // Improves performance dramatically
  function getNormalizedName(attrs, attrName) {
    return normalizeCache[attrName] ||
        (normalizeCache[attrName] = attrs.$normalize(attrName));
  }
}
mdMediaFactory.$inject = ["$mdConstant", "$rootScope", "$window"];

})();
(function(){
"use strict";

/*
 * This var has to be outside the angular factory, otherwise when
 * there are multiple material apps on the same page, each app
 * will create its own instance of this array and the app's IDs
 * will not be unique.
 */
var nextUniqueId = 0;

angular.module('material.core')
  .factory('$mdUtil', ["$cacheFactory", "$document", "$timeout", "$q", "$window", "$mdConstant", function ($cacheFactory, $document, $timeout, $q, $window, $mdConstant) {
    var Util;

    function getNode(el) {
      return el[0] || el;
    }

    return Util = {
      now: window.performance ?
        angular.bind(window.performance, window.performance.now) :
        Date.now,

      clientRect: function (element, offsetParent, isOffsetRect) {
        var node = getNode(element);
        offsetParent = getNode(offsetParent || node.offsetParent || document.body);
        var nodeRect = node.getBoundingClientRect();

        // The user can ask for an offsetRect: a rect relative to the offsetParent,
        // or a clientRect: a rect relative to the page
        var offsetRect = isOffsetRect ?
          offsetParent.getBoundingClientRect() :
        {left: 0, top: 0, width: 0, height: 0};
        return {
          left: nodeRect.left - offsetRect.left,
          top: nodeRect.top - offsetRect.top,
          width: nodeRect.width,
          height: nodeRect.height
        };
      },
      offsetRect: function (element, offsetParent) {
        return Util.clientRect(element, offsetParent, true);
      },

      // Annoying method to copy nodes to an array, thanks to IE
      nodesToArray: function (nodes) {
        var results = [];
        for (var i = 0; i < nodes.length; ++i) {
          results.push(nodes.item(i));
        }
        return results;
      },

      // Disables scroll around the passed element.
      disableScrollAround: function (element) {
        if (Util.disableScrollAround._enableScrolling) return Util.disableScrollAround._enableScrolling;
        element = angular.element(element);
        var body = $document[0].body,
          restoreBody = disableBodyScroll(),
          restoreElement = disableElementScroll();

        return Util.disableScrollAround._enableScrolling = function () {
          restoreBody();
          restoreElement();
          delete Util.disableScrollAround._enableScrolling;
        };

        // Creates a virtual scrolling mask to absorb touchmove, keyboard, scrollbar clicking, and wheel events
        function disableElementScroll() {
          var zIndex = $window.getComputedStyle(element[0]).zIndex - 1;
          if (isNaN(zIndex)) zIndex = 99;
          var scrollMask = angular.element(
            '<div class="md-scroll-mask" style="z-index: ' + zIndex + '">' +
            '  <div class="md-scroll-mask-bar"></div>' +
            '</div>');
          body.appendChild(scrollMask[0]);

          scrollMask.on('wheel', preventDefault);
          scrollMask.on('touchmove', preventDefault);
          $document.on('keydown', disableKeyNav);

          return function restoreScroll() {
            scrollMask.off('wheel');
            scrollMask.off('touchmove');
            scrollMask[0].parentNode.removeChild(scrollMask[0]);
            $document.off('keydown', disableKeyNav);
            delete Util.disableScrollAround._enableScrolling;
          };

          // Prevent keypresses from elements inside the body
          // used to stop the keypresses that could cause the page to scroll
          // (arrow keys, spacebar, tab, etc).
          function disableKeyNav(e) {
            //-- temporarily removed this logic, will possibly re-add at a later date
            return;
            if (!element[0].contains(e.target)) {
              e.preventDefault();
              e.stopImmediatePropagation();
            }
          }

          function preventDefault(e) {
            e.preventDefault();
          }
        }

        // Converts the body to a position fixed block and translate it to the proper scroll
        // position
        function disableBodyScroll() {
          var restoreStyle = body.getAttribute('style') || '';
          var scrollOffset = body.scrollTop + body.parentElement.scrollTop;
          var clientWidth = body.clientWidth;

          applyStyles(body, {
            position: 'fixed',
            width: '100%',
            overflowY: 'scroll',
            top: -scrollOffset + 'px'
          });

          if (body.clientWidth < clientWidth) applyStyles(body, {overflow: 'hidden'});

          return function restoreScroll() {
            body.setAttribute('style', restoreStyle);
            body.scrollTop = scrollOffset;
          };
        }

        function applyStyles(el, styles) {
          for (var key in styles) {
            el.style[key] = styles[key];
          }
        }
      },
      enableScrolling: function () {
        var method = this.disableScrollAround._enableScrolling;
        method && method();
      },
      floatingScrollbars: function () {
        if (this.floatingScrollbars.cached === undefined) {
          var tempNode = angular.element('<div style="width: 100%; z-index: -1; position: absolute; height: 35px; overflow-y: scroll"><div style="height: 60;"></div></div>');
          $document[0].body.appendChild(tempNode[0]);
          this.floatingScrollbars.cached = (tempNode[0].offsetWidth == tempNode[0].childNodes[0].offsetWidth);
          tempNode.remove();
        }
        return this.floatingScrollbars.cached;
      },

      // Mobile safari only allows you to set focus in click event listeners...
      forceFocus: function (element) {
        var node = element[0] || element;

        document.addEventListener('click', function focusOnClick(ev) {
          if (ev.target === node && ev.$focus) {
            node.focus();
            ev.stopImmediatePropagation();
            ev.preventDefault();
            node.removeEventListener('click', focusOnClick);
          }
        }, true);

        var newEvent = document.createEvent('MouseEvents');
        newEvent.initMouseEvent('click', false, true, window, {}, 0, 0, 0, 0,
          false, false, false, false, 0, null);
        newEvent.$material = true;
        newEvent.$focus = true;
        node.dispatchEvent(newEvent);
      },

      transitionEndPromise: function (element, opts) {
        opts = opts || {};
        var deferred = $q.defer();
        element.on($mdConstant.CSS.TRANSITIONEND, finished);
        function finished(ev) {
          // Make sure this transitionend didn't bubble up from a child
          if (!ev || ev.target === element[0]) {
            element.off($mdConstant.CSS.TRANSITIONEND, finished);
            deferred.resolve();
          }
        }

        if (opts.timeout) $timeout(finished, opts.timeout);
        return deferred.promise;
      },

      fakeNgModel: function () {
        return {
          $fake: true,
          $setTouched: angular.noop,
          $setViewValue: function (value) {
            this.$viewValue = value;
            this.$render(value);
            this.$viewChangeListeners.forEach(function (cb) {
              cb();
            });
          },
          $isEmpty: function (value) {
            return ('' + value).length === 0;
          },
          $parsers: [],
          $formatters: [],
          $viewChangeListeners: [],
          $render: angular.noop
        };
      },

      // Returns a function, that, as long as it continues to be invoked, will not
      // be triggered. The function will be called after it stops being called for
      // N milliseconds.
      // @param wait Integer value of msecs to delay (since last debounce reset); default value 10 msecs
      // @param invokeApply should the $timeout trigger $digest() dirty checking
      debounce: function (func, wait, scope, invokeApply) {
        var timer;

        return function debounced() {
          var context = scope,
            args = Array.prototype.slice.call(arguments);

          $timeout.cancel(timer);
          timer = $timeout(function () {

            timer = undefined;
            func.apply(context, args);

          }, wait || 10, invokeApply);
        };
      },

      // Returns a function that can only be triggered every `delay` milliseconds.
      // In other words, the function will not be called unless it has been more
      // than `delay` milliseconds since the last call.
      throttle: function throttle(func, delay) {
        var recent;
        return function throttled() {
          var context = this;
          var args = arguments;
          var now = Util.now();

          if (!recent || (now - recent > delay)) {
            func.apply(context, args);
            recent = now;
          }
        };
      },

      /**
       * Measures the number of milliseconds taken to run the provided callback
       * function. Uses a high-precision timer if available.
       */
      time: function time(cb) {
        var start = Util.now();
        cb();
        return Util.now() - start;
      },

      /**
       * Get a unique ID.
       *
       * @returns {string} an unique numeric string
       */
      nextUid: function () {
        return '' + nextUniqueId++;
      },

      // Stop watchers and events from firing on a scope without destroying it,
      // by disconnecting it from its parent and its siblings' linked lists.
      disconnectScope: function disconnectScope(scope) {
        if (!scope) return;

        // we can't destroy the root scope or a scope that has been already destroyed
        if (scope.$root === scope) return;
        if (scope.$$destroyed) return;

        var parent = scope.$parent;
        scope.$$disconnected = true;

        // See Scope.$destroy
        if (parent.$$childHead === scope) parent.$$childHead = scope.$$nextSibling;
        if (parent.$$childTail === scope) parent.$$childTail = scope.$$prevSibling;
        if (scope.$$prevSibling) scope.$$prevSibling.$$nextSibling = scope.$$nextSibling;
        if (scope.$$nextSibling) scope.$$nextSibling.$$prevSibling = scope.$$prevSibling;

        scope.$$nextSibling = scope.$$prevSibling = null;

      },

      // Undo the effects of disconnectScope above.
      reconnectScope: function reconnectScope(scope) {
        if (!scope) return;

        // we can't disconnect the root node or scope already disconnected
        if (scope.$root === scope) return;
        if (!scope.$$disconnected) return;

        var child = scope;

        var parent = child.$parent;
        child.$$disconnected = false;
        // See Scope.$new for this logic...
        child.$$prevSibling = parent.$$childTail;
        if (parent.$$childHead) {
          parent.$$childTail.$$nextSibling = child;
          parent.$$childTail = child;
        } else {
          parent.$$childHead = parent.$$childTail = child;
        }
      },

      /*
       * getClosest replicates jQuery.closest() to walk up the DOM tree until it finds a matching nodeName
       *
       * @param el Element to start walking the DOM from
       * @param tagName Tag name to find closest to el, such as 'form'
       */
      getClosest: function getClosest(el, tagName, onlyParent) {
        if (el instanceof angular.element) el = el[0];
        tagName = tagName.toUpperCase();
        if (onlyParent) el = el.parentNode;
        if (!el) return null;
        do {
          if (el.nodeName === tagName) {
            return el;
          }
        } while (el = el.parentNode);
        return null;
      },

      /**
       * Functional equivalent for $element.filter(‘md-bottom-sheet’)
       * useful with interimElements where the element and its container are important...
       */
      extractElementByName: function (element, nodeName) {
        for (var i = 0, len = element.length; i < len; i++) {
          if (element[i].nodeName.toLowerCase() === nodeName) {
            return angular.element(element[i]);
          }
        }
        return element;
      },

      /**
       * Give optional properties with no value a boolean true if attr provided or false otherwise
       */
      initOptionalProperties: function (scope, attr, defaults) {
        defaults = defaults || {};
        angular.forEach(scope.$$isolateBindings, function (binding, key) {
          if (binding.optional && angular.isUndefined(scope[key])) {
            var attrIsDefined = angular.isDefined(attr[binding.attrName]);
            scope[key] = angular.isDefined(defaults[key]) ? defaults[key] : attrIsDefined;
          }
        });
      }

    };

  }]);

/*
 * Since removing jQuery from the demos, some code that uses `element.focus()` is broken.
 *
 * We need to add `element.focus()`, because it's testable unlike `element[0].focus`.
 *
 * TODO(ajoslin): This should be added in a better place later.
 */

angular.element.prototype.focus = angular.element.prototype.focus || function () {
    if (this.length) {
      this[0].focus();
    }
    return this;
  };
angular.element.prototype.blur = angular.element.prototype.blur || function () {
    if (this.length) {
      this[0].blur();
    }
    return this;
  };

})();
(function(){
"use strict";


angular.module('material.core')
  .service('$mdAria', AriaService);

/*
 * @ngInject
 */
function AriaService($$rAF, $log, $window) {

  return {
    expect: expect,
    expectAsync: expectAsync,
    expectWithText: expectWithText
  };

  /**
   * Check if expected attribute has been specified on the target element or child
   * @param element
   * @param attrName
   * @param {optional} defaultValue What to set the attr to if no value is found
   */
  function expect(element, attrName, defaultValue) {
    var node = element[0] || element;

    // if node exists and neither it nor its children have the attribute
    if (node &&
       ((!node.hasAttribute(attrName) ||
        node.getAttribute(attrName).length === 0) &&
        !childHasAttribute(node, attrName))) {

      defaultValue = angular.isString(defaultValue) ? defaultValue.trim() : '';
      if (defaultValue.length) {
        element.attr(attrName, defaultValue);
      } else {
        $log.warn('ARIA: Attribute "', attrName, '", required for accessibility, is missing on node:', node);
      }

    }
  }

  function expectAsync(element, attrName, defaultValueGetter) {
    // Problem: when retrieving the element's contents synchronously to find the label,
    // the text may not be defined yet in the case of a binding.
    // There is a higher chance that a binding will be defined if we wait one frame.
    $$rAF(function() {
      expect(element, attrName, defaultValueGetter());
    });
  }

  function expectWithText(element, attrName) {
    expectAsync(element, attrName, function() {
      return getText(element);
    });
  }

  function getText(element) {
    return element.text().trim();
  }

  function childHasAttribute(node, attrName) {
    var hasChildren = node.hasChildNodes(),
        hasAttr = false;

    function isHidden(el) {
      var style = el.currentStyle ? el.currentStyle : $window.getComputedStyle(el);
      return (style.display === 'none');
    }

    if(hasChildren) {
      var children = node.childNodes;
      for(var i=0; i<children.length; i++){
        var child = children[i];
        if(child.nodeType === 1 && child.hasAttribute(attrName)) {
          if(!isHidden(child)){
            hasAttr = true;
          }
        }
      }
    }
    return hasAttr;
  }
}
AriaService.$inject = ["$$rAF", "$log", "$window"];

})();
(function(){
"use strict";

angular.module('material.core')
  .service('$mdCompiler', mdCompilerService);

function mdCompilerService($q, $http, $injector, $compile, $controller, $templateCache) {
  /* jshint validthis: true */

  /*
   * @ngdoc service
   * @name $mdCompiler
   * @module material.core
   * @description
   * The $mdCompiler service is an abstraction of angular's compiler, that allows the developer
   * to easily compile an element with a templateUrl, controller, and locals.
   *
   * @usage
   * <hljs lang="js">
   * $mdCompiler.compile({
   *   templateUrl: 'modal.html',
   *   controller: 'ModalCtrl',
   *   locals: {
   *     modal: myModalInstance;
   *   }
   * }).then(function(compileData) {
   *   compileData.element; // modal.html's template in an element
   *   compileData.link(myScope); //attach controller & scope to element
   * });
   * </hljs>
   */

   /*
    * @ngdoc method
    * @name $mdCompiler#compile
    * @description A helper to compile an HTML template/templateUrl with a given controller,
    * locals, and scope.
    * @param {object} options An options object, with the following properties:
    *
    *    - `controller` - `{(string=|function()=}` Controller fn that should be associated with
    *      newly created scope or the name of a registered controller if passed as a string.
    *    - `controllerAs` - `{string=}` A controller alias name. If present the controller will be
    *      published to scope under the `controllerAs` name.
    *    - `template` - `{string=}` An html template as a string.
    *    - `templateUrl` - `{string=}` A path to an html template.
    *    - `transformTemplate` - `{function(template)=}` A function which transforms the template after
    *      it is loaded. It will be given the template string as a parameter, and should
    *      return a a new string representing the transformed template.
    *    - `resolve` - `{Object.<string, function>=}` - An optional map of dependencies which should
    *      be injected into the controller. If any of these dependencies are promises, the compiler
    *      will wait for them all to be resolved, or if one is rejected before the controller is
    *      instantiated `compile()` will fail..
    *      * `key` - `{string}`: a name of a dependency to be injected into the controller.
    *      * `factory` - `{string|function}`: If `string` then it is an alias for a service.
    *        Otherwise if function, then it is injected and the return value is treated as the
    *        dependency. If the result is a promise, it is resolved before its value is 
    *        injected into the controller.
    *
    * @returns {object=} promise A promise, which will be resolved with a `compileData` object.
    * `compileData` has the following properties: 
    *
    *   - `element` - `{element}`: an uncompiled element matching the provided template.
    *   - `link` - `{function(scope)}`: A link function, which, when called, will compile
    *     the element and instantiate the provided controller (if given).
    *   - `locals` - `{object}`: The locals which will be passed into the controller once `link` is
    *     called. If `bindToController` is true, they will be coppied to the ctrl instead
    *   - `bindToController` - `bool`: bind the locals to the controller, instead of passing them in.
    */
  this.compile = function(options) {
    var templateUrl = options.templateUrl;
    var template = options.template || '';
    var controller = options.controller;
    var controllerAs = options.controllerAs;
    var resolve = options.resolve || {};
    var locals = options.locals || {};
    var transformTemplate = options.transformTemplate || angular.identity;
    var bindToController = options.bindToController;

    // Take resolve values and invoke them.  
    // Resolves can either be a string (value: 'MyRegisteredAngularConst'),
    // or an invokable 'factory' of sorts: (value: function ValueGetter($dependency) {})
    angular.forEach(resolve, function(value, key) {
      if (angular.isString(value)) {
        resolve[key] = $injector.get(value);
      } else {
        resolve[key] = $injector.invoke(value);
      }
    });
    //Add the locals, which are just straight values to inject
    //eg locals: { three: 3 }, will inject three into the controller
    angular.extend(resolve, locals);

    if (templateUrl) {
      resolve.$template = $http.get(templateUrl, {cache: $templateCache})
        .then(function(response) {
          return response.data;
        });
    } else {
      resolve.$template = $q.when(template);
    }

    // Wait for all the resolves to finish if they are promises
    return $q.all(resolve).then(function(locals) {

      var template = transformTemplate(locals.$template);
      var element = options.element || angular.element('<div>').html(template.trim()).contents();
      var linkFn = $compile(element);

      //Return a linking function that can be used later when the element is ready
      return {
        locals: locals,
        element: element,
        link: function link(scope) {
          locals.$scope = scope;

          //Instantiate controller if it exists, because we have scope
          if (controller) {
            var invokeCtrl = $controller(controller, locals, true);
            if (bindToController) {
              angular.extend(invokeCtrl.instance, locals);
            }
            var ctrl = invokeCtrl();
            //See angular-route source for this logic
            element.data('$ngControllerController', ctrl);
            element.children().data('$ngControllerController', ctrl);

            if (controllerAs) {
              scope[controllerAs] = ctrl;
            }
          }
          return linkFn(scope);
        }
      };
    });

  };
}
mdCompilerService.$inject = ["$q", "$http", "$injector", "$compile", "$controller", "$templateCache"];

})();
(function(){
"use strict";

  var HANDLERS = {};
  /* The state of the current 'pointer'
   * The pointer represents the state of the current touch.
   * It contains normalized x and y coordinates from DOM events,
   * as well as other information abstracted from the DOM.
   */
  var pointer, lastPointer, forceSkipClickHijack = false;

  // Used to attach event listeners once when multiple ng-apps are running.
  var isInitialized = false;
  
  angular
    .module('material.core.gestures', [ ])
    .provider('$mdGesture', MdGestureProvider)
    .factory('$$MdGestureHandler', MdGestureHandler)
    .run( attachToDocument );

  /**
     * @ngdoc service
     * @name $mdGestureProvider
     * @module material.core.gestures
     *
     * @description
     * In some scenarios on Mobile devices (without jQuery), the click events should NOT be hijacked.
     * `$mdGestureProvider` is used to configure the Gesture module to ignore or skip click hijacking on mobile
     * devices.
     *
     * <hljs lang="js">
     *   app.config(function($mdGestureProvider) {
     *
     *     // For mobile devices without jQuery loaded, do not
     *     // intercept click events during the capture phase.
     *     $mdGestureProvider.skipClickHijack();
     *
     *   });
     * </hljs>
     *
     */
  function MdGestureProvider() { }

  MdGestureProvider.prototype = {

    // Publish access to setter to configure a variable  BEFORE the
    // $mdGesture service is instantiated...
    skipClickHijack: function() {
      return forceSkipClickHijack = true;
    },

    /**
     * $get is used to build an instance of $mdGesture
     * @ngInject
     */
    $get : ["$$MdGestureHandler", "$$rAF", "$timeout", function($$MdGestureHandler, $$rAF, $timeout) {
         return new MdGesture($$MdGestureHandler, $$rAF, $timeout);
    }]
  };



  /**
   * MdGesture factory construction function
   * @ngInject
   */
  function MdGesture($$MdGestureHandler, $$rAF, $timeout) {
    var userAgent = navigator.userAgent || navigator.vendor || window.opera;
    var isIos = userAgent.match(/ipad|iphone|ipod/i);
    var isAndroid = userAgent.match(/android/i);
    var hasJQuery =  (typeof window.jQuery !== 'undefined') && (angular.element === window.jQuery);

    var self = {
      handler: addHandler,
      register: register,
      // On mobile w/out jQuery, we normally intercept clicks. Should we skip that?
      isHijackingClicks: (isIos || isAndroid) && !hasJQuery && !forceSkipClickHijack
    };

    if (self.isHijackingClicks) {
      self.handler('click', {
        options: {
          maxDistance: 6
        },
        onEnd: function (ev, pointer) {
          if (pointer.distance < this.state.options.maxDistance) {
            this.dispatchEvent(ev, 'click');
          }
        }
      });
    }

    /*
     * Register an element to listen for a handler.
     * This allows an element to override the default options for a handler.
     * Additionally, some handlers like drag and hold only dispatch events if
     * the domEvent happens inside an element that's registered to listen for these events.
     *
     * @see GestureHandler for how overriding of default options works.
     * @example $mdGesture.register(myElement, 'drag', { minDistance: 20, horziontal: false })
     */
    function register(element, handlerName, options) {
      var handler = HANDLERS[handlerName.replace(/^\$md./, '')];
      if (!handler) {
        throw new Error('Failed to register element with handler ' + handlerName + '. ' +
        'Available handlers: ' + Object.keys(HANDLERS).join(', '));
      }
      return handler.registerElement(element, options);
    }

    /*
     * add a handler to $mdGesture. see below.
     */
    function addHandler(name, definition) {
      var handler = new $$MdGestureHandler(name);
      angular.extend(handler, definition);
      HANDLERS[name] = handler;

      return self;
    }

    /*
     * Register handlers. These listen to touch/start/move events, interpret them,
     * and dispatch gesture events depending on options & conditions. These are all
     * instances of GestureHandler.
     * @see GestureHandler 
     */
    return self
      /*
       * The press handler dispatches an event on touchdown/touchend.
       * It's a simple abstraction of touch/mouse/pointer start and end.
       */
      .handler('press', {
        onStart: function (ev, pointer) {
          this.dispatchEvent(ev, '$md.pressdown');
        },
        onEnd: function (ev, pointer) {
          this.dispatchEvent(ev, '$md.pressup');
        }
      })

      /*
       * The hold handler dispatches an event if the user keeps their finger within
       * the same <maxDistance> area for <delay> ms.
       * The hold handler will only run if a parent of the touch target is registered
       * to listen for hold events through $mdGesture.register()
       */
      .handler('hold', {
        options: {
          maxDistance: 6,
          delay: 500
        },
        onCancel: function () {
          $timeout.cancel(this.state.timeout);
        },
        onStart: function (ev, pointer) {
          // For hold, require a parent to be registered with $mdGesture.register()
          // Because we prevent scroll events, this is necessary.
          if (!this.state.registeredParent) return this.cancel();

          this.state.pos = {x: pointer.x, y: pointer.y};
          this.state.timeout = $timeout(angular.bind(this, function holdDelayFn() {
            this.dispatchEvent(ev, '$md.hold');
            this.cancel(); //we're done!
          }), this.state.options.delay, false);
        },
        onMove: function (ev, pointer) {
          // Don't scroll while waiting for hold.
          // If we don't preventDefault touchmove events here, Android will assume we don't
          // want to listen to anymore touch events. It will start scrolling and stop sending
          // touchmove events.
          ev.preventDefault();

          // If the user moves greater than <maxDistance> pixels, stop the hold timer
          // set in onStart
          var dx = this.state.pos.x - pointer.x;
          var dy = this.state.pos.y - pointer.y;
          if (Math.sqrt(dx * dx + dy * dy) > this.options.maxDistance) {
            this.cancel();
          }
        },
        onEnd: function () {
          this.onCancel();
        }
      })

      /*
       * The drag handler dispatches a drag event if the user holds and moves his finger greater than
       * <minDistance> px in the x or y direction, depending on options.horizontal.
       * The drag will be cancelled if the user moves his finger greater than <minDistance>*<cancelMultiplier> in
       * the perpindicular direction. Eg if the drag is horizontal and the user moves his finger <minDistance>*<cancelMultiplier>
       * pixels vertically, this handler won't consider the move part of a drag.
       */
      .handler('drag', {
        options: {
          minDistance: 6,
          horizontal: true,
          cancelMultiplier: 1.5
        },
        onStart: function (ev) {
          // For drag, require a parent to be registered with $mdGesture.register()
          if (!this.state.registeredParent) this.cancel();
        },
        onMove: function (ev, pointer) {
          var shouldStartDrag, shouldCancel;
          // Don't scroll while deciding if this touchmove qualifies as a drag event.
          // If we don't preventDefault touchmove events here, Android will assume we don't
          // want to listen to anymore touch events. It will start scrolling and stop sending
          // touchmove events.
          ev.preventDefault();

          if (!this.state.dragPointer) {
            if (this.state.options.horizontal) {
              shouldStartDrag = Math.abs(pointer.distanceX) > this.state.options.minDistance;
              shouldCancel = Math.abs(pointer.distanceY) > this.state.options.minDistance * this.state.options.cancelMultiplier;
            } else {
              shouldStartDrag = Math.abs(pointer.distanceY) > this.state.options.minDistance;
              shouldCancel = Math.abs(pointer.distanceX) > this.state.options.minDistance * this.state.options.cancelMultiplier;
            }

            if (shouldStartDrag) {
              // Create a new pointer representing this drag, starting at this point where the drag started.
              this.state.dragPointer = makeStartPointer(ev);
              updatePointerState(ev, this.state.dragPointer);
              this.dispatchEvent(ev, '$md.dragstart', this.state.dragPointer);

            } else if (shouldCancel) {
              this.cancel();
            }
          } else {
            this.dispatchDragMove(ev);
          }
        },
        // Only dispatch dragmove events every frame; any more is unnecessray
        dispatchDragMove: $$rAF.throttle(function (ev) {
          // Make sure the drag didn't stop while waiting for the next frame
          if (this.state.isRunning) {
            updatePointerState(ev, this.state.dragPointer);
            this.dispatchEvent(ev, '$md.drag', this.state.dragPointer);
          }
        }),
        onEnd: function (ev, pointer) {
          if (this.state.dragPointer) {
            updatePointerState(ev, this.state.dragPointer);
            this.dispatchEvent(ev, '$md.dragend', this.state.dragPointer);
          }
        }
      })

      /*
       * The swipe handler will dispatch a swipe event if, on the end of a touch,
       * the velocity and distance were high enough.
       * TODO: add vertical swiping with a `horizontal` option similar to the drag handler.
       */
      .handler('swipe', {
        options: {
          minVelocity: 0.65,
          minDistance: 10
        },
        onEnd: function (ev, pointer) {
          if (Math.abs(pointer.velocityX) > this.state.options.minVelocity &&
            Math.abs(pointer.distanceX) > this.state.options.minDistance) {
            var eventType = pointer.directionX == 'left' ? '$md.swipeleft' : '$md.swiperight';
            this.dispatchEvent(ev, eventType);
          }
        }
      });

  }
  MdGesture.$inject = ["$$MdGestureHandler", "$$rAF", "$timeout"];

  /**
   * MdGestureHandler
   * A GestureHandler is an object which is able to dispatch custom dom events
   * based on native dom {touch,pointer,mouse}{start,move,end} events.
   *
   * A gesture will manage its lifecycle through the start,move,end, and cancel
   * functions, which are called by native dom events.
   *
   * A gesture has the concept of 'options' (eg a swipe's required velocity), which can be
   * overridden by elements registering through $mdGesture.register()
   */
  function GestureHandler (name) {
    this.name = name;
    this.state = {};
  }

  function MdGestureHandler() {
    var hasJQuery =  (typeof window.jQuery !== 'undefined') && (angular.element === window.jQuery);

    GestureHandler.prototype = {
      options: {},
      // jQuery listeners don't work with custom DOMEvents, so we have to dispatch events
      // differently when jQuery is loaded
      dispatchEvent: hasJQuery ?  jQueryDispatchEvent : nativeDispatchEvent,

      // These are overridden by the registered handler
      onStart: angular.noop,
      onMove: angular.noop,
      onEnd: angular.noop,
      onCancel: angular.noop,

      // onStart sets up a new state for the handler, which includes options from the
      // nearest registered parent element of ev.target.
      start: function (ev, pointer) {
        if (this.state.isRunning) return;
        var parentTarget = this.getNearestParent(ev.target);
        // Get the options from the nearest registered parent
        var parentTargetOptions = parentTarget && parentTarget.$mdGesture[this.name] || {};

        this.state = {
          isRunning: true,
          // Override the default options with the nearest registered parent's options
          options: angular.extend({}, this.options, parentTargetOptions),
          // Pass in the registered parent node to the state so the onStart listener can use
          registeredParent: parentTarget
        };
        this.onStart(ev, pointer);
      },
      move: function (ev, pointer) {
        if (!this.state.isRunning) return;
        this.onMove(ev, pointer);
      },
      end: function (ev, pointer) {
        if (!this.state.isRunning) return;
        this.onEnd(ev, pointer);
        this.state.isRunning = false;
      },
      cancel: function (ev, pointer) {
        this.onCancel(ev, pointer);
        this.state = {};
      },

      // Find and return the nearest parent element that has been registered to
      // listen for this handler via $mdGesture.register(element, 'handlerName').
      getNearestParent: function (node) {
        var current = node;
        while (current) {
          if ((current.$mdGesture || {})[this.name]) {
            return current;
          }
          current = current.parentNode;
        }
        return null;
      },

      // Called from $mdGesture.register when an element reigsters itself with a handler.
      // Store the options the user gave on the DOMElement itself. These options will
      // be retrieved with getNearestParent when the handler starts.
      registerElement: function (element, options) {
        var self = this;
        element[0].$mdGesture = element[0].$mdGesture || {};
        element[0].$mdGesture[this.name] = options || {};
        element.on('$destroy', onDestroy);

        return onDestroy;

        function onDestroy() {
          delete element[0].$mdGesture[self.name];
          element.off('$destroy', onDestroy);
        }
      }
    };

    return GestureHandler;

    /*
     * Dispatch an event with jQuery
     * TODO: Make sure this sends bubbling events
     *
     * @param srcEvent the original DOM touch event that started this.
     * @param eventType the name of the custom event to send (eg 'click' or '$md.drag')
     * @param eventPointer the pointer object that matches this event.
     */
    function jQueryDispatchEvent(srcEvent, eventType, eventPointer) {
      eventPointer = eventPointer || pointer;
      var eventObj = new angular.element.Event(eventType);

      eventObj.$material = true;
      eventObj.pointer = eventPointer;
      eventObj.srcEvent = srcEvent;

      angular.extend(eventObj, {
        clientX: eventPointer.x,
        clientY: eventPointer.y,
        screenX: eventPointer.x,
        screenY: eventPointer.y,
        pageX: eventPointer.x,
        pageY: eventPointer.y,
        ctrlKey: srcEvent.ctrlKey,
        altKey: srcEvent.altKey,
        shiftKey: srcEvent.shiftKey,
        metaKey: srcEvent.metaKey
      });
      angular.element(eventPointer.target).trigger(eventObj);
    }

    /*
     * NOTE: nativeDispatchEvent is very performance sensitive.
     * @param srcEvent the original DOM touch event that started this.
     * @param eventType the name of the custom event to send (eg 'click' or '$md.drag')
     * @param eventPointer the pointer object that matches this event.
     */
    function nativeDispatchEvent(srcEvent, eventType, eventPointer) {
      eventPointer = eventPointer || pointer;
      var eventObj;

      if (eventType === 'click') {
        eventObj = document.createEvent('MouseEvents');
        eventObj.initMouseEvent(
          'click', true, true, window, srcEvent.detail,
          eventPointer.x, eventPointer.y, eventPointer.x, eventPointer.y,
          srcEvent.ctrlKey, srcEvent.altKey, srcEvent.shiftKey, srcEvent.metaKey,
          srcEvent.button, srcEvent.relatedTarget || null
        );

      } else {
        eventObj = document.createEvent('CustomEvent');
        eventObj.initCustomEvent(eventType, true, true, {});
      }
      eventObj.$material = true;
      eventObj.pointer = eventPointer;
      eventObj.srcEvent = srcEvent;
      eventPointer.target.dispatchEvent(eventObj);
    }

  }

  /**
   * Attach Gestures: hook document and check shouldHijack clicks
   * @ngInject
   */
  function attachToDocument( $mdGesture, $$MdGestureHandler ) {

    // Polyfill document.contains for IE11.
    // TODO: move to util
    document.contains || (document.contains = function (node) {
      return document.body.contains(node);
    });

    if (!isInitialized && $mdGesture.isHijackingClicks ) {
      /*
       * If hijack clicks is true, we preventDefault any click that wasn't
       * sent by ngMaterial. This is because on older Android & iOS, a false, or 'ghost',
       * click event will be sent ~400ms after a touchend event happens.
       * The only way to know if this click is real is to prevent any normal
       * click events, and add a flag to events sent by material so we know not to prevent those.
       * 
       * Two exceptions to click events that should be prevented are:
       *  - click events sent by the keyboard (eg form submit)
       *  - events that originate from an Ionic app
       */
      document.addEventListener('click', function clickHijacker(ev) {
        var isKeyClick = ev.clientX === 0 && ev.clientY === 0;
        if (!isKeyClick && !ev.$material && !ev.isIonicTap) {
          ev.preventDefault();
          ev.stopPropagation();
        }
      }, true);
      
      isInitialized = true;
    }

    // Listen to all events to cover all platforms.
    var START_EVENTS = 'mousedown touchstart pointerdown';
    var MOVE_EVENTS = 'mousemove touchmove pointermove';
    var END_EVENTS = 'mouseup mouseleave touchend touchcancel pointerup pointercancel';

    angular.element(document)
      .on(START_EVENTS, gestureStart)
      .on(MOVE_EVENTS, gestureMove)
      .on(END_EVENTS, gestureEnd)
      // For testing
      .on('$$mdGestureReset', function gestureClearCache () {
        lastPointer = pointer = null;
      });

    /*
     * When a DOM event happens, run all registered gesture handlers' lifecycle
     * methods which match the DOM event.
     * Eg when a 'touchstart' event happens, runHandlers('start') will call and
     * run `handler.cancel()` and `handler.start()` on all registered handlers.
     */
    function runHandlers(handlerEvent, event) {
      var handler;
      for (var name in HANDLERS) {
        handler = HANDLERS[name];
        if( handler instanceof $$MdGestureHandler ) {

          if (handlerEvent === 'start') {
            // Run cancel to reset any handlers' state
            handler.cancel();
          }
          handler[handlerEvent](event, pointer);

        }
      }
    }

    /*
     * gestureStart vets if a start event is legitimate (and not part of a 'ghost click' from iOS/Android)
     * If it is legitimate, we initiate the pointer state and mark the current pointer's type
     * For example, for a touchstart event, mark the current pointer as a 'touch' pointer, so mouse events
     * won't effect it.
     */
    function gestureStart(ev) {
      // If we're already touched down, abort
      if (pointer) return;

      var now = +Date.now();

      // iOS & old android bug: after a touch event, a click event is sent 350 ms later.
      // If <400ms have passed, don't allow an event of a different type than the previous event
      if (lastPointer && !typesMatch(ev, lastPointer) && (now - lastPointer.endTime < 1500)) {
        return;
      }

      pointer = makeStartPointer(ev);

      runHandlers('start', ev);
    }
    /*
     * If a move event happens of the right type, update the pointer and run all the move handlers.
     * "of the right type": if a mousemove happens but our pointer started with a touch event, do nothing.
     */
    function gestureMove(ev) {
      if (!pointer || !typesMatch(ev, pointer)) return;

      updatePointerState(ev, pointer);
      runHandlers('move', ev);
    }
    /*
     * If an end event happens of the right type, update the pointer, run endHandlers, and save the pointer as 'lastPointer'
     */
    function gestureEnd(ev) {
      if (!pointer || !typesMatch(ev, pointer)) return;

      updatePointerState(ev, pointer);
      pointer.endTime = +Date.now();

      runHandlers('end', ev);

      lastPointer = pointer;
      pointer = null;
    }

  }
  attachToDocument.$inject = ["$mdGesture", "$$MdGestureHandler"];

  // ********************
  // Module Functions
  // ********************

  /*
   * Initiate the pointer. x, y, and the pointer's type.
   */
  function makeStartPointer(ev) {
    var point = getEventPoint(ev);
    var startPointer = {
      startTime: +Date.now(),
      target: ev.target,
      // 'p' for pointer events, 'm' for mouse, 't' for touch
      type: ev.type.charAt(0)
    };
    startPointer.startX = startPointer.x = point.pageX;
    startPointer.startY = startPointer.y = point.pageY;
    return startPointer;
  }

  /*
   * return whether the pointer's type matches the event's type.
   * Eg if a touch event happens but the pointer has a mouse type, return false.
   */
  function typesMatch(ev, pointer) {
    return ev && pointer && ev.type.charAt(0) === pointer.type;
  }

  /*
   * Update the given pointer based upon the given DOMEvent.
   * Distance, velocity, direction, duration, etc
   */
  function updatePointerState(ev, pointer) {
    var point = getEventPoint(ev);
    var x = pointer.x = point.pageX;
    var y = pointer.y = point.pageY;

    pointer.distanceX = x - pointer.startX;
    pointer.distanceY = y - pointer.startY;
    pointer.distance = Math.sqrt(
      pointer.distanceX * pointer.distanceX + pointer.distanceY * pointer.distanceY
    );

    pointer.directionX = pointer.distanceX > 0 ? 'right' : pointer.distanceX < 0 ? 'left' : '';
    pointer.directionY = pointer.distanceY > 0 ? 'up' : pointer.distanceY < 0 ? 'down' : '';

    pointer.duration = +Date.now() - pointer.startTime;
    pointer.velocityX = pointer.distanceX / pointer.duration;
    pointer.velocityY = pointer.distanceY / pointer.duration;
  }

  /*
   * Normalize the point where the DOM event happened whether it's touch or mouse.
   * @returns point event obj with pageX and pageY on it.
   */
  function getEventPoint(ev) {
    ev = ev.originalEvent || ev; // support jQuery events
    return (ev.touches && ev.touches[0]) ||
      (ev.changedTouches && ev.changedTouches[0]) ||
      ev;
  }

})();
(function(){
"use strict";

angular.module('material.core')
  .provider('$$interimElement', InterimElementProvider);

/*
 * @ngdoc service
 * @name $$interimElement
 * @module material.core
 *
 * @description
 *
 * Factory that contructs `$$interimElement.$service` services.
 * Used internally in material design for elements that appear on screen temporarily.
 * The service provides a promise-like API for interacting with the temporary
 * elements.
 *
 * ```js
 * app.service('$mdToast', function($$interimElement) {
 *   var $mdToast = $$interimElement(toastDefaultOptions);
 *   return $mdToast;
 * });
 * ```
 * @param {object=} defaultOptions Options used by default for the `show` method on the service.
 *
 * @returns {$$interimElement.$service}
 *
 */

function InterimElementProvider() {
  createInterimElementProvider.$get = InterimElementFactory;
  InterimElementFactory.$inject = ["$document", "$q", "$rootScope", "$timeout", "$rootElement", "$animate", "$interpolate", "$mdCompiler", "$mdTheming"];
  return createInterimElementProvider;

  /**
   * Returns a new provider which allows configuration of a new interimElement
   * service. Allows configuration of default options & methods for options,
   * as well as configuration of 'preset' methods (eg dialog.basic(): basic is a preset method)
   */
  function createInterimElementProvider(interimFactoryName) {
    var EXPOSED_METHODS = ['onHide', 'onShow', 'onRemove'];

    var customMethods = {};
    var providerConfig = {
      presets: {}
    };

    var provider = {
      setDefaults: setDefaults,
      addPreset: addPreset,
      addMethod: addMethod,
      $get: factory
    };

    /**
     * all interim elements will come with the 'build' preset
     */
    provider.addPreset('build', {
      methods: ['controller', 'controllerAs', 'resolve',
        'template', 'templateUrl', 'themable', 'transformTemplate', 'parent']
    });

    factory.$inject = ["$$interimElement", "$animate", "$injector"];
    return provider;

    /**
     * Save the configured defaults to be used when the factory is instantiated
     */
    function setDefaults(definition) {
      providerConfig.optionsFactory = definition.options;
      providerConfig.methods = (definition.methods || []).concat(EXPOSED_METHODS);
      return provider;
    }

    /**
     * Add a method to the factory that isn't specific to any interim element operations
     */

    function addMethod(name, fn) {
      customMethods[name] = fn;
      return provider;
    }

    /**
     * Save the configured preset to be used when the factory is instantiated
     */
    function addPreset(name, definition) {
      definition = definition || {};
      definition.methods = definition.methods || [];
      definition.options = definition.options || function() { return {}; };

      if (/^cancel|hide|show$/.test(name)) {
        throw new Error("Preset '" + name + "' in " + interimFactoryName + " is reserved!");
      }
      if (definition.methods.indexOf('_options') > -1) {
        throw new Error("Method '_options' in " + interimFactoryName + " is reserved!");
      }
      providerConfig.presets[name] = {
        methods: definition.methods.concat(EXPOSED_METHODS),
        optionsFactory: definition.options,
        argOption: definition.argOption
      };
      return provider;
    }

    /**
     * Create a factory that has the given methods & defaults implementing interimElement
     */
    /* @ngInject */
    function factory($$interimElement, $animate, $injector) {
      var defaultMethods;
      var defaultOptions;
      var interimElementService = $$interimElement();

      /*
       * publicService is what the developer will be using.
       * It has methods hide(), cancel(), show(), build(), and any other
       * presets which were set during the config phase.
       */
      var publicService = {
        hide: interimElementService.hide,
        cancel: interimElementService.cancel,
        show: showInterimElement
      };

      defaultMethods = providerConfig.methods || [];
      // This must be invoked after the publicService is initialized
      defaultOptions = invokeFactory(providerConfig.optionsFactory, {});

      // Copy over the simple custom methods
      angular.forEach(customMethods, function(fn, name) {
        publicService[name] = fn;
      });

      angular.forEach(providerConfig.presets, function(definition, name) {
        var presetDefaults = invokeFactory(definition.optionsFactory, {});
        var presetMethods = (definition.methods || []).concat(defaultMethods);

        // Every interimElement built with a preset has a field called `$type`,
        // which matches the name of the preset.
        // Eg in preset 'confirm', options.$type === 'confirm'
        angular.extend(presetDefaults, { $type: name });

        // This creates a preset class which has setter methods for every
        // method given in the `.addPreset()` function, as well as every
        // method given in the `.setDefaults()` function.
        //
        // @example
        // .setDefaults({
        //   methods: ['hasBackdrop', 'clickOutsideToClose', 'escapeToClose', 'targetEvent'],
        //   options: dialogDefaultOptions
        // })
        // .addPreset('alert', {
        //   methods: ['title', 'ok'],
        //   options: alertDialogOptions
        // })
        //
        // Set values will be passed to the options when interimElemnt.show() is called.
        function Preset(opts) {
          this._options = angular.extend({}, presetDefaults, opts);
        }
        angular.forEach(presetMethods, function(name) {
          Preset.prototype[name] = function(value) {
            this._options[name] = value;
            return this;
          };
        });

        // Create shortcut method for one-linear methods
        if (definition.argOption) {
          var methodName = 'show' + name.charAt(0).toUpperCase() + name.slice(1);
          publicService[methodName] = function(arg) {
            var config = publicService[name](arg);
            return publicService.show(config);
          };
        }

        // eg $mdDialog.alert() will return a new alert preset
        publicService[name] = function(arg) {
          // If argOption is supplied, eg `argOption: 'content'`, then we assume
          // if the argument is not an options object then it is the `argOption` option.
          //
          // @example `$mdToast.simple('hello')` // sets options.content to hello
          //                                     // because argOption === 'content'
          if (arguments.length && definition.argOption && !angular.isObject(arg) &&
              !angular.isArray(arg)) {
            return (new Preset())[definition.argOption](arg);
          } else {
            return new Preset(arg);
          }

        };
      });

      return publicService;

      function showInterimElement(opts) {
        // opts is either a preset which stores its options on an _options field,
        // or just an object made up of options
        if (opts && opts._options) opts = opts._options;
        return interimElementService.show(
          angular.extend({}, defaultOptions, opts)
        );
      }

      /**
       * Helper to call $injector.invoke with a local of the factory name for
       * this provider.
       * If an $mdDialog is providing options for a dialog and tries to inject
       * $mdDialog, a circular dependency error will happen.
       * We get around that by manually injecting $mdDialog as a local.
       */
      function invokeFactory(factory, defaultVal) {
        var locals = {};
        locals[interimFactoryName] = publicService;
        return $injector.invoke(factory || function() { return defaultVal; }, {}, locals);
      }

    }

  }

  /* @ngInject */
  function InterimElementFactory($document, $q, $rootScope, $timeout, $rootElement, $animate,
                                 $interpolate, $mdCompiler, $mdTheming ) {
    var startSymbol = $interpolate.startSymbol(),
        endSymbol = $interpolate.endSymbol(),
        usesStandardSymbols = ((startSymbol === '{{') && (endSymbol === '}}')),
        processTemplate  = usesStandardSymbols ? angular.identity : replaceInterpolationSymbols;

    return function createInterimElementService() {
      /*
       * @ngdoc service
       * @name $$interimElement.$service
       *
       * @description
       * A service used to control inserting and removing an element into the DOM.
       *
       */
      var stack = [];
      var service;
      return service = {
        show: show,
        hide: hide,
        cancel: cancel
      };

      /*
       * @ngdoc method
       * @name $$interimElement.$service#show
       * @kind function
       *
       * @description
       * Adds the `$interimElement` to the DOM and returns a promise that will be resolved or rejected
       * with hide or cancel, respectively.
       *
       * @param {*} options is hashMap of settings
       * @returns a Promise
       *
       */
      function show(options) {
        if (stack.length) {
          return service.cancel().then(function() {
            return show(options);
          });
        } else {
          var interimElement = new InterimElement(options);
          stack.push(interimElement);
          return interimElement.show().then(function() {
            return interimElement.deferred.promise;
          });
        }
      }

      /*
       * @ngdoc method
       * @name $$interimElement.$service#hide
       * @kind function
       *
       * @description
       * Removes the `$interimElement` from the DOM and resolves the promise returned from `show`
       *
       * @param {*} resolveParam Data to resolve the promise with
       * @returns a Promise that will be resolved after the element has been removed.
       *
       */
      function hide(response) {
        var interimElement = stack.shift();
        return interimElement && interimElement.remove().then(function() {
          interimElement.deferred.resolve(response);
        });
      }

      /*
       * @ngdoc method
       * @name $$interimElement.$service#cancel
       * @kind function
       *
       * @description
       * Removes the `$interimElement` from the DOM and rejects the promise returned from `show`
       *
       * @param {*} reason Data to reject the promise with
       * @returns Promise that will be resolved after the element has been removed.
       *
       */
      function cancel(reason) {
        var interimElement = stack.shift();
        return $q.when(interimElement && interimElement.remove().then(function() {
          interimElement.deferred.reject(reason);
        }));
      }


      /*
       * Internal Interim Element Object
       * Used internally to manage the DOM element and related data
       */
      function InterimElement(options) {
        var self;
        var hideTimeout, element, showDone, removeDone;

        options = options || {};
        options = angular.extend({
          preserveScope: false,
          scope: options.scope || $rootScope.$new(options.isolateScope),
          onShow: function(scope, element, options) {
            return $animate.enter(element, options.parent);
          },
          onRemove: function(scope, element, options) {
            // Element could be undefined if a new element is shown before
            // the old one finishes compiling.
            return element && $animate.leave(element) || $q.when();
          }
        }, options);

        if (options.template) {
          options.template = processTemplate(options.template);
        }

        return self = {
          options: options,
          deferred: $q.defer(),
          show: function() {
            var compilePromise;
            if (options.skipCompile) {
              compilePromise = $q(function(resolve) { 
                resolve({
                  locals: {},
                  link: function() { return options.element; }
                });
              });
            } else {
              compilePromise = $mdCompiler.compile(options);
            }

            return showDone = compilePromise.then(function(compileData) {
              angular.extend(compileData.locals, self.options);

              element = compileData.link(options.scope);

              // Search for parent at insertion time, if not specified
              if (angular.isFunction(options.parent)) {
                options.parent = options.parent(options.scope, element, options);
              } else if (angular.isString(options.parent)) {
                options.parent = angular.element($document[0].querySelector(options.parent));
              }

              // If parent querySelector/getter function fails, or it's just null,
              // find a default.
              if (!(options.parent || {}).length) {
                var el;
                if ($rootElement[0] && $rootElement[0].querySelector) {
                  el = $rootElement[0].querySelector(':not(svg) > body');
                }
                if (!el) el = $rootElement[0];
                if (el.nodeName == '#comment') {
                  el = $document[0].body;
                }
                options.parent = angular.element(el);
              }

              if (options.themable) $mdTheming(element);
              var ret = options.onShow(options.scope, element, options);
              return $q.when(ret)
                .then(function(){
                  // Issue onComplete callback when the `show()` finishes
                  (options.onComplete || angular.noop)(options.scope, element, options);
                  startHideTimeout();
                });

              function startHideTimeout() {
                if (options.hideDelay) {
                  hideTimeout = $timeout(service.cancel, options.hideDelay) ;
                }
              }
            }, function(reason) { showDone = true; self.deferred.reject(reason); });
          },
          cancelTimeout: function() {
            if (hideTimeout) {
              $timeout.cancel(hideTimeout);
              hideTimeout = undefined;
            }
          },
          remove: function() {
            self.cancelTimeout();
            return removeDone = $q.when(showDone).then(function() {
              var ret = element ? options.onRemove(options.scope, element, options) : true;
              return $q.when(ret).then(function() {
                if (!options.preserveScope) options.scope.$destroy();
                removeDone = true;
              });
            });
          }
        };
      }
    };

    /*
     * Replace `{{` and `}}` in a string (usually a template) with the actual start-/endSymbols used
     * for interpolation. This allows pre-defined templates (for components such as dialog, toast etc)
     * to continue to work in apps that use custom interpolation start-/endSymbols.
     *
     * @param {string} text The text in which to replace `{{` / `}}`
     * @returns {string} The modified string using the actual interpolation start-/endSymbols
     */
    function replaceInterpolationSymbols(text) {
      if (!text || !angular.isString(text)) return text;
      return text.replace(/\{\{/g, startSymbol).replace(/}}/g, endSymbol);
    }
  }

}

})();
(function(){
"use strict";

  /**
   * @ngdoc module
   * @name material.core.componentRegistry
   *
   * @description
   * A component instance registration service.
   * Note: currently this as a private service in the SideNav component.
   */
  angular.module('material.core')
    .factory('$mdComponentRegistry', ComponentRegistry);

  /*
   * @private
   * @ngdoc factory
   * @name ComponentRegistry
   * @module material.core.componentRegistry
   *
   */
  function ComponentRegistry($log, $q) {

    var self;
    var instances = [ ];
    var pendings = { };

    return self = {
      /**
       * Used to print an error when an instance for a handle isn't found.
       */
      notFoundError: function(handle) {
        $log.error('No instance found for handle', handle);
      },
      /**
       * Return all registered instances as an array.
       */
      getInstances: function() {
        return instances;
      },

      /**
       * Get a registered instance.
       * @param handle the String handle to look up for a registered instance.
       */
      get: function(handle) {
        if ( !isValidID(handle) ) return null;

        var i, j, instance;
        for(i = 0, j = instances.length; i < j; i++) {
          instance = instances[i];
          if(instance.$$mdHandle === handle) {
            return instance;
          }
        }
        return null;
      },

      /**
       * Register an instance.
       * @param instance the instance to register
       * @param handle the handle to identify the instance under.
       */
      register: function(instance, handle) {
        if ( !handle ) return angular.noop;

        instance.$$mdHandle = handle;
        instances.push(instance);
        resolveWhen();

        return deregister;

        /**
         * Remove registration for an instance
         */
        function deregister() {
          var index = instances.indexOf(instance);
          if (index !== -1) {
            instances.splice(index, 1);
          }
        }

        /**
         * Resolve any pending promises for this instance
         */
        function resolveWhen() {
          var dfd = pendings[handle];
          if ( dfd ) {
            dfd.resolve( instance );
            delete pendings[handle];
          }
        }
      },

      /**
       * Async accessor to registered component instance
       * If not available then a promise is created to notify
       * all listeners when the instance is registered.
       */
      when : function(handle) {
        if ( isValidID(handle) ) {
          var deferred = $q.defer();
          var instance = self.get(handle);

          if ( instance )  {
            deferred.resolve( instance );
          } else {
            pendings[handle] = deferred;
          }

          return deferred.promise;
        }
        return $q.reject("Invalid `md-component-id` value.");
      }

    };

    function isValidID(handle){
      return handle && (handle !== "");
    }

  }
  ComponentRegistry.$inject = ["$log", "$q"];

})();
(function(){
"use strict";

(function() {
  'use strict';

  /**
   * @ngdoc service
   * @name $mdButtonInkRipple
   * @module material.core
   *
   * @description
   * Provides ripple effects for md-button.  See $mdInkRipple service for all possible configuration options.
   *
   * @param {object=} scope Scope within the current context
   * @param {object=} element The element the ripple effect should be applied to
   * @param {object=} options (Optional) Configuration options to override the defaultripple configuration
   */

  angular.module('material.core')
    .factory('$mdButtonInkRipple', MdButtonInkRipple);

  function MdButtonInkRipple($mdInkRipple) {
    return {
      attach: attach
    };

    function attach(scope, element, options) {
      var elementOptions = optionsForElement(element);
      return $mdInkRipple.attach(scope, element, angular.extend(elementOptions, options));
    };

    function optionsForElement(element) {
      if (element.hasClass('md-icon-button')) {
        return {
          isMenuItem: element.hasClass('md-menu-item'),
          fitRipple: true,
          center: true
        };
      } else {
        return {
          isMenuItem: element.hasClass('md-menu-item'),
          dimBackground: true
        }
      }
    };
  }
  MdButtonInkRipple.$inject = ["$mdInkRipple"];;
})();

})();
(function(){
"use strict";

(function() {
  'use strict';

    /**
   * @ngdoc service
   * @name $mdCheckboxInkRipple
   * @module material.core
   *
   * @description
   * Provides ripple effects for md-checkbox.  See $mdInkRipple service for all possible configuration options.
   *
   * @param {object=} scope Scope within the current context
   * @param {object=} element The element the ripple effect should be applied to
   * @param {object=} options (Optional) Configuration options to override the defaultripple configuration
   */

  angular.module('material.core')
    .factory('$mdCheckboxInkRipple', MdCheckboxInkRipple);

  function MdCheckboxInkRipple($mdInkRipple) {
    return {
      attach: attach
    };

    function attach(scope, element, options) {
      return $mdInkRipple.attach(scope, element, angular.extend({
        center: true,
        dimBackground: false,
        fitRipple: true
      }, options));
    };
  }
  MdCheckboxInkRipple.$inject = ["$mdInkRipple"];;
})();

})();
(function(){
"use strict";

(function() {
  'use strict';

  /**
   * @ngdoc service
   * @name $mdListInkRipple
   * @module material.core
   *
   * @description
   * Provides ripple effects for md-list.  See $mdInkRipple service for all possible configuration options.
   *
   * @param {object=} scope Scope within the current context
   * @param {object=} element The element the ripple effect should be applied to
   * @param {object=} options (Optional) Configuration options to override the defaultripple configuration
   */

  angular.module('material.core')
    .factory('$mdListInkRipple', MdListInkRipple);

  function MdListInkRipple($mdInkRipple) {
    return {
      attach: attach
    };

    function attach(scope, element, options) {
      return $mdInkRipple.attach(scope, element, angular.extend({
        center: false,
        dimBackground: true,
        outline: false,
        rippleSize: 'full'
      }, options));
    };
  }
  MdListInkRipple.$inject = ["$mdInkRipple"];;
})();

})();
(function(){
"use strict";

angular.module('material.core')
  .factory('$mdInkRipple', InkRippleService)
  .directive('mdInkRipple', InkRippleDirective)
  .directive('mdNoInk', attrNoDirective())
  .directive('mdNoBar', attrNoDirective())
  .directive('mdNoStretch', attrNoDirective());

function InkRippleDirective($mdButtonInkRipple, $mdCheckboxInkRipple) {
  return {
    controller: angular.noop,
    link: function (scope, element, attr) {
      if (attr.hasOwnProperty('mdInkRippleCheckbox')) {
        $mdCheckboxInkRipple.attach(scope, element);
      } else {
        $mdButtonInkRipple.attach(scope, element);
      }
    }
  };
}
InkRippleDirective.$inject = ["$mdButtonInkRipple", "$mdCheckboxInkRipple"];

function InkRippleService($window, $timeout) {

  return {
    attach: attach
  };

  function attach(scope, element, options) {
    if (element.controller('mdNoInk')) return angular.noop;

    options = angular.extend({
      colorElement: element,
      mousedown: true,
      hover: true,
      focus: true,
      center: false,
      mousedownPauseTime: 150,
      dimBackground: false,
      outline: false,
      fullRipple: true,
      isMenuItem: false,
      fitRipple: false
    }, options);

    var rippleSize,
        controller = element.controller('mdInkRipple') || {},
        counter = 0,
        ripples = [],
        states = [],
        isActiveExpr = element.attr('md-highlight'),
        isActive = false,
        isHeld = false,
        node = element[0],
        rippleSizeSetting = element.attr('md-ripple-size'),
        color = parseColor(element.attr('md-ink-ripple')) || parseColor(options.colorElement.length && $window.getComputedStyle(options.colorElement[0]).color || 'rgb(0, 0, 0)');

    switch (rippleSizeSetting) {
      case 'full':
        options.fullRipple = true;
        break;
      case 'partial':
        options.fullRipple = false;
        break;
    }

    // expose onInput for ripple testing
    if (options.mousedown) {
      element.on('$md.pressdown', onPressDown)
        .on('$md.pressup', onPressUp);
    }

    controller.createRipple = createRipple;

    if (isActiveExpr) {
      scope.$watch(isActiveExpr, function watchActive(newValue) {
        isActive = newValue;
        if (isActive && !ripples.length) {
          $timeout(function () { createRipple(0, 0); }, 0, false);
        }
        angular.forEach(ripples, updateElement);
      });
    }

    // Publish self-detach method if desired...
    return function detach() {
      element.off('$md.pressdown', onPressDown)
        .off('$md.pressup', onPressUp);
      getRippleContainer().remove();
    };

    /**
     * Gets the current ripple container
     * If there is no ripple container, it creates one and returns it
     *
     * @returns {angular.element} ripple container element
     */
    function getRippleContainer() {
      var container = element.data('$mdRippleContainer');
      if (container) return container;
      container = angular.element('<div class="md-ripple-container">');
      element.append(container);
      element.data('$mdRippleContainer', container);
      return container;
    }

    function parseColor(color) {
      if (!color) return;
      if (color.indexOf('rgba') === 0) return color.replace(/\d?\.?\d*\s*\)\s*$/, '0.1)');
      if (color.indexOf('rgb')  === 0) return rgbToRGBA(color);
      if (color.indexOf('#')    === 0) return hexToRGBA(color);

      /**
       * Converts a hex value to an rgba string
       *
       * @param {string} hex value (3 or 6 digits) to be converted
       *
       * @returns {string} rgba color with 0.1 alpha
       */
      function hexToRGBA(color) {
        var hex = color.charAt(0) === '#' ? color.substr(1) : color,
          dig = hex.length / 3,
          red = hex.substr(0, dig),
          grn = hex.substr(dig, dig),
          blu = hex.substr(dig * 2);
        if (dig === 1) {
          red += red;
          grn += grn;
          blu += blu;
        }
        return 'rgba(' + parseInt(red, 16) + ',' + parseInt(grn, 16) + ',' + parseInt(blu, 16) + ',0.1)';
      }

      /**
       * Converts rgb value to rgba string
       *
       * @param {string} rgb color string
       *
       * @returns {string} rgba color with 0.1 alpha
       */
      function rgbToRGBA(color) {
        return color.replace(')', ', 0.1)').replace('(', 'a(');
      }

    }

    function removeElement(elem, wait) {
      ripples.splice(ripples.indexOf(elem), 1);
      if (ripples.length === 0) {
        getRippleContainer().css({ backgroundColor: '' });
      }
      $timeout(function () { elem.remove(); }, wait, false);
    }

    function updateElement(elem) {
      var index = ripples.indexOf(elem),
          state = states[index] || {},
          elemIsActive = ripples.length > 1 ? false : isActive,
          elemIsHeld   = ripples.length > 1 ? false : isHeld;
      if (elemIsActive || state.animating || elemIsHeld) {
        elem.addClass('md-ripple-visible');
      } else if (elem) {
        elem.removeClass('md-ripple-visible');
        if (options.outline) {
          elem.css({
            width: rippleSize + 'px',
            height: rippleSize + 'px',
            marginLeft: (rippleSize * -1) + 'px',
            marginTop: (rippleSize * -1) + 'px'
          });
        }
        removeElement(elem, options.outline ? 450 : 650);
      }
    }

    /**
     * Creates a ripple at the provided coordinates
     *
     * @param {number} left cursor position
     * @param {number} top cursor position
     *
     * @returns {angular.element} the generated ripple element
     */
    function createRipple(left, top) {

      color = parseColor(element.attr('md-ink-ripple')) || parseColor($window.getComputedStyle(options.colorElement[0]).color || 'rgb(0, 0, 0)');

      var container = getRippleContainer(),
          size = getRippleSize(left, top),
          css = getRippleCss(size, left, top),
          elem = getRippleElement(css),
          index = ripples.indexOf(elem),
          state = states[index] || {};

      rippleSize = size;

      state.animating = true;

      $timeout(function () {
        if (options.dimBackground) {
          container.css({ backgroundColor: color });
        }
        elem.addClass('md-ripple-placed md-ripple-scaled');
        if (options.outline) {
          elem.css({
            borderWidth: (size * 0.5) + 'px',
            marginLeft: (size * -0.5) + 'px',
            marginTop: (size * -0.5) + 'px'
          });
        } else {
          elem.css({ left: '50%', top: '50%' });
        }
        updateElement(elem);
        $timeout(function () {
          state.animating = false;
          updateElement(elem);
        }, (options.outline ? 450 : 225), false);
      }, 0, false);

      return elem;

      /**
       * Creates the ripple element with the provided css
       *
       * @param {object} css properties to be applied
       *
       * @returns {angular.element} the generated ripple element
       */
      function getRippleElement(css) {
        var elem = angular.element('<div class="md-ripple" data-counter="' + counter++ + '">');
        ripples.unshift(elem);
        states.unshift({ animating: true });
        container.append(elem);
        css && elem.css(css);
        return elem;
      }

      /**
       * Calculate the ripple size
       *
       * @returns {number} calculated ripple diameter
       */
      function getRippleSize(left, top) {
        var width = container.prop('offsetWidth'),
            height = container.prop('offsetHeight'),
            multiplier, size, rect;
        if (options.isMenuItem) {
          size = Math.sqrt(Math.pow(width, 2) + Math.pow(height, 2));
        } else if (options.outline) {
          rect = node.getBoundingClientRect();
          left -= rect.left;
          top -= rect.top;
          width = Math.max(left, width - left);
          height = Math.max(top, height - top);
          size = 2 * Math.sqrt(Math.pow(width, 2) + Math.pow(height, 2));
        } else {
          multiplier = options.fullRipple ? 1.1 : 0.8;
          size = Math.sqrt(Math.pow(width, 2) + Math.pow(height, 2)) * multiplier;
          if (options.fitRipple) {
            size = Math.min(height, width, size);
          }
        }
        return size;
      }

      /**
       * Generates the ripple css
       *
       * @param {number} the diameter of the ripple
       * @param {number} the left cursor offset
       * @param {number} the top cursor offset
       *
       * @returns {{backgroundColor: string, borderColor: string, width: string, height: string}}
       */
      function getRippleCss(size, left, top) {
        var rect = node.getBoundingClientRect(),
            css  = {
              backgroundColor: rgbaToRGB(color),
              borderColor: rgbaToRGB(color),
              width: size + 'px',
              height: size + 'px'
            };

        if (options.outline) {
          css.width = 0;
          css.height = 0;
        } else {
          css.marginLeft = css.marginTop = (size * -0.5) + 'px';
        }

        if (options.center) {
          css.left = css.top = '50%';
        } else {
          css.left = Math.round((left - rect.left) / container.prop('offsetWidth') * 100) + '%';
          css.top = Math.round((top - rect.top) / container.prop('offsetHeight') * 100) + '%';
        }

        return css;

        /**
         * Converts rgba string to rgb, removing the alpha value
         *
         * @param {string} rgba color
         *
         * @returns {string} rgb color
         */
        function rgbaToRGB(color) {
          return color.replace('rgba', 'rgb').replace(/,[^\),]+\)/, ')');
        }
      }
    }

    /**
     * Handles user input start and stop events
     *
     */
    function onPressDown(ev) {
      if (!isRippleAllowed()) return;

      createRipple(ev.pointer.x, ev.pointer.y);
      isHeld = true;
    }
    function onPressUp() {
      isHeld = false;
      var ripple = ripples[ ripples.length - 1 ];
      $timeout(function () { updateElement(ripple); }, 0, false);
    }

    /**
     * Determines if the ripple is allowed
     *
     * @returns {boolean} true if the ripple is allowed, false if not
     */
    function isRippleAllowed() {
      var parent = node.parentNode;
      var grandparent = parent && parent.parentNode;
      var ancestor = grandparent && grandparent.parentNode;
      return !isDisabled(node) && !isDisabled(parent) && !isDisabled(grandparent) && !isDisabled(ancestor);
      function isDisabled (elem) {
        return elem && elem.hasAttribute && elem.hasAttribute('disabled');
      }
    }

  }
}
InkRippleService.$inject = ["$window", "$timeout"];

/**
 * noink/nobar/nostretch directive: make any element that has one of
 * these attributes be given a controller, so that other directives can
 * `require:` these and see if there is a `no<xxx>` parent attribute.
 *
 * @usage
 * <hljs lang="html">
 * <parent md-no-ink>
 *   <child detect-no>
 *   </child>
 * </parent>
 * </hljs>
 *
 * <hljs lang="js">
 * myApp.directive('detectNo', function() {
 *   return {
 *     require: ['^?mdNoInk', ^?mdNoBar'],
 *     link: function(scope, element, attr, ctrls) {
 *       var noinkCtrl = ctrls[0];
 *       var nobarCtrl = ctrls[1];
 *       if (noInkCtrl) {
 *         alert("the md-no-ink flag has been specified on an ancestor!");
 *       }
 *       if (nobarCtrl) {
 *         alert("the md-no-bar flag has been specified on an ancestor!");
 *       }
 *     }
 *   };
 * });
 * </hljs>
 */
function attrNoDirective() {
  return function() {
    return {
      controller: angular.noop
    };
  };
}

})();
(function(){
"use strict";

(function() {
  'use strict';

    /**
   * @ngdoc service
   * @name $mdTabInkRipple
   * @module material.core
   *
   * @description
   * Provides ripple effects for md-tabs.  See $mdInkRipple service for all possible configuration options.
   *
   * @param {object=} scope Scope within the current context
   * @param {object=} element The element the ripple effect should be applied to
   * @param {object=} options (Optional) Configuration options to override the defaultripple configuration
   */

  angular.module('material.core')
    .factory('$mdTabInkRipple', MdTabInkRipple);

  function MdTabInkRipple($mdInkRipple) {
    return {
      attach: attach
    };

    function attach(scope, element, options) {
      return $mdInkRipple.attach(scope, element, angular.extend({
        center: false,
        dimBackground: true,
        outline: false,
        rippleSize: 'full'
      }, options));
    };
  }
  MdTabInkRipple.$inject = ["$mdInkRipple"];;
})();

})();
(function(){
"use strict";

angular.module('material.core.theming.palette', [])
.constant('$mdColorPalette', {
  'red': {
    '50': '#ffebee',
    '100': '#ffcdd2',
    '200': '#ef9a9a',
    '300': '#e57373',
    '400': '#ef5350',
    '500': '#f44336',
    '600': '#e53935',
    '700': '#d32f2f',
    '800': '#c62828',
    '900': '#b71c1c',
    'A100': '#ff8a80',
    'A200': '#ff5252',
    'A400': '#ff1744',
    'A700': '#d50000',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200 300 400 A100',
    'contrastStrongLightColors': '500 600 700 A200 A400 A700'
  },
  'pink': {
    '50': '#fce4ec',
    '100': '#f8bbd0',
    '200': '#f48fb1',
    '300': '#f06292',
    '400': '#ec407a',
    '500': '#e91e63',
    '600': '#d81b60',
    '700': '#c2185b',
    '800': '#ad1457',
    '900': '#880e4f',
    'A100': '#ff80ab',
    'A200': '#ff4081',
    'A400': '#f50057',
    'A700': '#c51162',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200 300 400 A100',
    'contrastStrongLightColors': '500 600 A200 A400 A700'
  },
  'purple': {
    '50': '#f3e5f5',
    '100': '#e1bee7',
    '200': '#ce93d8',
    '300': '#ba68c8',
    '400': '#ab47bc',
    '500': '#9c27b0',
    '600': '#8e24aa',
    '700': '#7b1fa2',
    '800': '#6a1b9a',
    '900': '#4a148c',
    'A100': '#ea80fc',
    'A200': '#e040fb',
    'A400': '#d500f9',
    'A700': '#aa00ff',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200 A100',
    'contrastStrongLightColors': '300 400 A200 A400 A700'
  },
  'deep-purple': {
    '50': '#ede7f6',
    '100': '#d1c4e9',
    '200': '#b39ddb',
    '300': '#9575cd',
    '400': '#7e57c2',
    '500': '#673ab7',
    '600': '#5e35b1',
    '700': '#512da8',
    '800': '#4527a0',
    '900': '#311b92',
    'A100': '#b388ff',
    'A200': '#7c4dff',
    'A400': '#651fff',
    'A700': '#6200ea',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200 A100',
    'contrastStrongLightColors': '300 400 A200'
  },
  'indigo': {
    '50': '#e8eaf6',
    '100': '#c5cae9',
    '200': '#9fa8da',
    '300': '#7986cb',
    '400': '#5c6bc0',
    '500': '#3f51b5',
    '600': '#3949ab',
    '700': '#303f9f',
    '800': '#283593',
    '900': '#1a237e',
    'A100': '#8c9eff',
    'A200': '#536dfe',
    'A400': '#3d5afe',
    'A700': '#304ffe',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200 A100',
    'contrastStrongLightColors': '300 400 A200 A400'
  },
  'blue': {
    '50': '#e3f2fd',
    '100': '#bbdefb',
    '200': '#90caf9',
    '300': '#64b5f6',
    '400': '#42a5f5',
    '500': '#2196f3',
    '600': '#1e88e5',
    '700': '#1976d2',
    '800': '#1565c0',
    '900': '#0d47a1',
    'A100': '#82b1ff',
    'A200': '#448aff',
    'A400': '#2979ff',
    'A700': '#2962ff',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '100 200 300 400 A100',
    'contrastStrongLightColors': '500 600 700 A200 A400 A700'
  },
  'light-blue': {
    '50': '#e1f5fe',
    '100': '#b3e5fc',
    '200': '#81d4fa',
    '300': '#4fc3f7',
    '400': '#29b6f6',
    '500': '#03a9f4',
    '600': '#039be5',
    '700': '#0288d1',
    '800': '#0277bd',
    '900': '#01579b',
    'A100': '#80d8ff',
    'A200': '#40c4ff',
    'A400': '#00b0ff',
    'A700': '#0091ea',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '500 600 700 800 900 A700',
    'contrastStrongLightColors': '500 600 700 800 A700'
  },
  'cyan': {
    '50': '#e0f7fa',
    '100': '#b2ebf2',
    '200': '#80deea',
    '300': '#4dd0e1',
    '400': '#26c6da',
    '500': '#00bcd4',
    '600': '#00acc1',
    '700': '#0097a7',
    '800': '#00838f',
    '900': '#006064',
    'A100': '#84ffff',
    'A200': '#18ffff',
    'A400': '#00e5ff',
    'A700': '#00b8d4',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '500 600 700 800 900',
    'contrastStrongLightColors': '500 600 700 800'
  },
  'teal': {
    '50': '#e0f2f1',
    '100': '#b2dfdb',
    '200': '#80cbc4',
    '300': '#4db6ac',
    '400': '#26a69a',
    '500': '#009688',
    '600': '#00897b',
    '700': '#00796b',
    '800': '#00695c',
    '900': '#004d40',
    'A100': '#a7ffeb',
    'A200': '#64ffda',
    'A400': '#1de9b6',
    'A700': '#00bfa5',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '500 600 700 800 900',
    'contrastStrongLightColors': '500 600 700'
  },
  'green': {
    '50': '#e8f5e9',
    '100': '#c8e6c9',
    '200': '#a5d6a7',
    '300': '#81c784',
    '400': '#66bb6a',
    '500': '#4caf50',
    '600': '#43a047',
    '700': '#388e3c',
    '800': '#2e7d32',
    '900': '#1b5e20',
    'A100': '#b9f6ca',
    'A200': '#69f0ae',
    'A400': '#00e676',
    'A700': '#00c853',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '500 600 700 800 900',
    'contrastStrongLightColors': '500 600 700'
  },
  'light-green': {
    '50': '#f1f8e9',
    '100': '#dcedc8',
    '200': '#c5e1a5',
    '300': '#aed581',
    '400': '#9ccc65',
    '500': '#8bc34a',
    '600': '#7cb342',
    '700': '#689f38',
    '800': '#558b2f',
    '900': '#33691e',
    'A100': '#ccff90',
    'A200': '#b2ff59',
    'A400': '#76ff03',
    'A700': '#64dd17',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '800 900',
    'contrastStrongLightColors': '800 900'
  },
  'lime': {
    '50': '#f9fbe7',
    '100': '#f0f4c3',
    '200': '#e6ee9c',
    '300': '#dce775',
    '400': '#d4e157',
    '500': '#cddc39',
    '600': '#c0ca33',
    '700': '#afb42b',
    '800': '#9e9d24',
    '900': '#827717',
    'A100': '#f4ff81',
    'A200': '#eeff41',
    'A400': '#c6ff00',
    'A700': '#aeea00',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '900',
    'contrastStrongLightColors': '900'
  },
  'yellow': {
    '50': '#fffde7',
    '100': '#fff9c4',
    '200': '#fff59d',
    '300': '#fff176',
    '400': '#ffee58',
    '500': '#ffeb3b',
    '600': '#fdd835',
    '700': '#fbc02d',
    '800': '#f9a825',
    '900': '#f57f17',
    'A100': '#ffff8d',
    'A200': '#ffff00',
    'A400': '#ffea00',
    'A700': '#ffd600',
    'contrastDefaultColor': 'dark'
  },
  'amber': {
    '50': '#fff8e1',
    '100': '#ffecb3',
    '200': '#ffe082',
    '300': '#ffd54f',
    '400': '#ffca28',
    '500': '#ffc107',
    '600': '#ffb300',
    '700': '#ffa000',
    '800': '#ff8f00',
    '900': '#ff6f00',
    'A100': '#ffe57f',
    'A200': '#ffd740',
    'A400': '#ffc400',
    'A700': '#ffab00',
    'contrastDefaultColor': 'dark'
  },
  'orange': {
    '50': '#fff3e0',
    '100': '#ffe0b2',
    '200': '#ffcc80',
    '300': '#ffb74d',
    '400': '#ffa726',
    '500': '#ff9800',
    '600': '#fb8c00',
    '700': '#f57c00',
    '800': '#ef6c00',
    '900': '#e65100',
    'A100': '#ffd180',
    'A200': '#ffab40',
    'A400': '#ff9100',
    'A700': '#ff6d00',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '800 900',
    'contrastStrongLightColors': '800 900'
  },
  'deep-orange': {
    '50': '#fbe9e7',
    '100': '#ffccbc',
    '200': '#ffab91',
    '300': '#ff8a65',
    '400': '#ff7043',
    '500': '#ff5722',
    '600': '#f4511e',
    '700': '#e64a19',
    '800': '#d84315',
    '900': '#bf360c',
    'A100': '#ff9e80',
    'A200': '#ff6e40',
    'A400': '#ff3d00',
    'A700': '#dd2c00',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200 300 400 A100 A200',
    'contrastStrongLightColors': '500 600 700 800 900 A400 A700'
  },
  'brown': {
    '50': '#efebe9',
    '100': '#d7ccc8',
    '200': '#bcaaa4',
    '300': '#a1887f',
    '400': '#8d6e63',
    '500': '#795548',
    '600': '#6d4c41',
    '700': '#5d4037',
    '800': '#4e342e',
    '900': '#3e2723',
    'A100': '#d7ccc8',
    'A200': '#bcaaa4',
    'A400': '#8d6e63',
    'A700': '#5d4037',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200',
    'contrastStrongLightColors': '300 400'
  },
  'grey': {
    '50': '#fafafa',
    '100': '#f5f5f5',
    '200': '#eeeeee',
    '300': '#e0e0e0',
    '400': '#bdbdbd',
    '500': '#9e9e9e',
    '600': '#757575',
    '700': '#616161',
    '800': '#424242',
    '900': '#212121',
    '1000': '#000000',
    'A100': '#ffffff',
    'A200': '#eeeeee',
    'A400': '#bdbdbd',
    'A700': '#616161',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '600 700 800 900'
  },
  'blue-grey': {
    '50': '#eceff1',
    '100': '#cfd8dc',
    '200': '#b0bec5',
    '300': '#90a4ae',
    '400': '#78909c',
    '500': '#607d8b',
    '600': '#546e7a',
    '700': '#455a64',
    '800': '#37474f',
    '900': '#263238',
    'A100': '#cfd8dc',
    'A200': '#b0bec5',
    'A400': '#78909c',
    'A700': '#455a64',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200 300',
    'contrastStrongLightColors': '400 500'
  }
});

})();
(function(){
"use strict";

angular.module('material.core.theming', ['material.core.theming.palette'])
  .directive('mdTheme', ThemingDirective)
  .directive('mdThemable', ThemableDirective)
  .provider('$mdTheming', ThemingProvider)
  .run(generateThemes);

/**
 * @ngdoc provider
 * @name $mdThemingProvider
 * @module material.core
 *
 * @description Provider to configure the `$mdTheming` service.
 */

/**
 * @ngdoc method
 * @name $mdThemingProvider#setDefaultTheme
 * @param {string} themeName Default theme name to be applied to elements. Default value is `default`.
 */

/**
 * @ngdoc method
 * @name $mdThemingProvider#alwaysWatchTheme
 * @param {boolean} watch Whether or not to always watch themes for changes and re-apply
 * classes when they change. Default is `false`. Enabling can reduce performance.
 */

/* Some Example Valid Theming Expressions
 * =======================================
 *
 * Intention group expansion: (valid for primary, accent, warn, background)
 *
 * {{primary-100}} - grab shade 100 from the primary palette
 * {{primary-100-0.7}} - grab shade 100, apply opacity of 0.7
 * {{primary-hue-1}} - grab the shade assigned to hue-1 from the primary palette
 * {{primary-hue-1-0.7}} - apply 0.7 opacity to primary-hue-1
 * {{primary-color}} - Generates .md-hue-1, .md-hue-2, .md-hue-3 with configured shades set for each hue
 * {{primary-color-0.7}} - Apply 0.7 opacity to each of the above rules
 * {{primary-contrast}} - Generates .md-hue-1, .md-hue-2, .md-hue-3 with configured contrast (ie. text) color shades set for each hue
 * {{primary-contrast-0.7}} - Apply 0.7 opacity to each of the above rules
 *
 * Foreground expansion: Applies rgba to black/white foreground text
 *
 * {{foreground-1}} - used for primary text
 * {{foreground-2}} - used for secondary text/divider
 * {{foreground-3}} - used for disabled text
 * {{foreground-4}} - used for dividers
 *
 */

// In memory generated CSS rules; registered by theme.name
var GENERATED = { };

// In memory storage of defined themes and color palettes (both loaded by CSS, and user specified)
var PALETTES;
var THEMES;

var DARK_FOREGROUND = {
  name: 'dark',
  '1': 'rgba(0,0,0,0.87)',
  '2': 'rgba(0,0,0,0.54)',
  '3': 'rgba(0,0,0,0.26)',
  '4': 'rgba(0,0,0,0.12)'
};
var LIGHT_FOREGROUND = {
  name: 'light',
  '1': 'rgba(255,255,255,1.0)',
  '2': 'rgba(255,255,255,0.7)',
  '3': 'rgba(255,255,255,0.3)',
  '4': 'rgba(255,255,255,0.12)'
};

var DARK_SHADOW = '1px 1px 0px rgba(0,0,0,0.4), -1px -1px 0px rgba(0,0,0,0.4)';
var LIGHT_SHADOW = '';

var DARK_CONTRAST_COLOR = colorToRgbaArray('rgba(0,0,0,0.87)');
var LIGHT_CONTRAST_COLOR = colorToRgbaArray('rgba(255,255,255,0.87');
var STRONG_LIGHT_CONTRAST_COLOR = colorToRgbaArray('rgb(255,255,255)');

var THEME_COLOR_TYPES = ['primary', 'accent', 'warn', 'background'];
var DEFAULT_COLOR_TYPE = 'primary';

// A color in a theme will use these hues by default, if not specified by user.
var LIGHT_DEFAULT_HUES = {
  'accent': {
    'default': 'A200',
    'hue-1': 'A100',
    'hue-2': 'A400',
    'hue-3': 'A700'
  },
  'background': {
    'default': 'A100',
    'hue-1': '300',
    'hue-2': '800',
    'hue-3': '900'
  }
};

var DARK_DEFAULT_HUES = {
  'background': {
    'default': '800',
    'hue-1': '300',
    'hue-2': '600',
    'hue-3': '900'
  }
};
THEME_COLOR_TYPES.forEach(function(colorType) {
  // Color types with unspecified default hues will use these default hue values
  var defaultDefaultHues = {
    'default': '500',
    'hue-1': '300',
    'hue-2': '800',
    'hue-3': 'A100'
  };
  if (!LIGHT_DEFAULT_HUES[colorType]) LIGHT_DEFAULT_HUES[colorType] = defaultDefaultHues;
  if (!DARK_DEFAULT_HUES[colorType]) DARK_DEFAULT_HUES[colorType] = defaultDefaultHues;
});

var VALID_HUE_VALUES = [
  '50', '100', '200', '300', '400', '500', '600',
  '700', '800', '900', 'A100', 'A200', 'A400', 'A700'
];

function ThemingProvider($mdColorPalette) {
  PALETTES = { };
  THEMES = { };

  var themingProvider;
  var defaultTheme = 'default';
  var alwaysWatchTheme = false;

  // Load JS Defined Palettes
  angular.extend(PALETTES, $mdColorPalette);

  // Default theme defined in core.js

  ThemingService.$inject = ["$rootScope", "$log"];
  return themingProvider = {
    definePalette: definePalette,
    extendPalette: extendPalette,
    theme: registerTheme,

    setDefaultTheme: function(theme) {
      defaultTheme = theme;
    },
    alwaysWatchTheme: function(alwaysWatch) {
      alwaysWatchTheme = alwaysWatch;
    },
    $get: ThemingService,
    _LIGHT_DEFAULT_HUES: LIGHT_DEFAULT_HUES,
    _DARK_DEFAULT_HUES: DARK_DEFAULT_HUES,
    _PALETTES: PALETTES,
    _THEMES: THEMES,
    _parseRules: parseRules,
    _rgba: rgba
  };

  // Example: $mdThemingProvider.definePalette('neonRed', { 50: '#f5fafa', ... });
  function definePalette(name, map) {
    map = map || {};
    PALETTES[name] = checkPaletteValid(name, map);
    return themingProvider;
  }

  // Returns an new object which is a copy of a given palette `name` with variables from
  // `map` overwritten
  // Example: var neonRedMap = $mdThemingProvider.extendPalette('red', { 50: '#f5fafafa' });
  function extendPalette(name, map) {
    return checkPaletteValid(name,  angular.extend({}, PALETTES[name] || {}, map) );
  }

  // Make sure that palette has all required hues
  function checkPaletteValid(name, map) {
    var missingColors = VALID_HUE_VALUES.filter(function(field) {
      return !map[field];
    });
    if (missingColors.length) {
      throw new Error("Missing colors %1 in palette %2!"
                      .replace('%1', missingColors.join(', '))
                      .replace('%2', name));
    }

    return map;
  }

  // Register a theme (which is a collection of color palettes to use with various states
  // ie. warn, accent, primary )
  // Optionally inherit from an existing theme
  // $mdThemingProvider.theme('custom-theme').primaryPalette('red');
  function registerTheme(name, inheritFrom) {
    if (THEMES[name]) return THEMES[name];

    inheritFrom = inheritFrom || 'default';

    var parentTheme = typeof inheritFrom === 'string' ? THEMES[inheritFrom] : inheritFrom;
    var theme = new Theme(name);

    if (parentTheme) {
      angular.forEach(parentTheme.colors, function(color, colorType) {
        theme.colors[colorType] = {
          name: color.name,
          // Make sure a COPY of the hues is given to the child color,
          // not the same reference.
          hues: angular.extend({}, color.hues)
        };
      });
    }
    THEMES[name] = theme;

    return theme;
  }

  function Theme(name) {
    var self = this;
    self.name = name;
    self.colors = {};

    self.dark = setDark;
    setDark(false);

    function setDark(isDark) {
      isDark = arguments.length === 0 ? true : !!isDark;

      // If no change, abort
      if (isDark === self.isDark) return;

      self.isDark = isDark;

      self.foregroundPalette = self.isDark ? LIGHT_FOREGROUND : DARK_FOREGROUND;
      self.foregroundShadow = self.isDark ? DARK_SHADOW : LIGHT_SHADOW;

      // Light and dark themes have different default hues.
      // Go through each existing color type for this theme, and for every
      // hue value that is still the default hue value from the previous light/dark setting,
      // set it to the default hue value from the new light/dark setting.
      var newDefaultHues = self.isDark ? DARK_DEFAULT_HUES : LIGHT_DEFAULT_HUES;
      var oldDefaultHues = self.isDark ? LIGHT_DEFAULT_HUES : DARK_DEFAULT_HUES;
      angular.forEach(newDefaultHues, function(newDefaults, colorType) {
        var color = self.colors[colorType];
        var oldDefaults = oldDefaultHues[colorType];
        if (color) {
          for (var hueName in color.hues) {
            if (color.hues[hueName] === oldDefaults[hueName]) {
              color.hues[hueName] = newDefaults[hueName];
            }
          }
        }
      });

      return self;
    }

    THEME_COLOR_TYPES.forEach(function(colorType) {
      var defaultHues = (self.isDark ? DARK_DEFAULT_HUES : LIGHT_DEFAULT_HUES)[colorType];
      self[colorType + 'Palette'] = function setPaletteType(paletteName, hues) {
        var color = self.colors[colorType] = {
          name: paletteName,
          hues: angular.extend({}, defaultHues, hues)
        };

        Object.keys(color.hues).forEach(function(name) {
          if (!defaultHues[name]) {
            throw new Error("Invalid hue name '%1' in theme %2's %3 color %4. Available hue names: %4"
              .replace('%1', name)
              .replace('%2', self.name)
              .replace('%3', paletteName)
              .replace('%4', Object.keys(defaultHues).join(', '))
            );
          }
        });
        Object.keys(color.hues).map(function(key) {
          return color.hues[key];
        }).forEach(function(hueValue) {
          if (VALID_HUE_VALUES.indexOf(hueValue) == -1) {
            throw new Error("Invalid hue value '%1' in theme %2's %3 color %4. Available hue values: %5"
              .replace('%1', hueValue)
              .replace('%2', self.name)
              .replace('%3', colorType)
              .replace('%4', paletteName)
              .replace('%5', VALID_HUE_VALUES.join(', '))
            );
          }
        });
        return self;
      };

      self[colorType + 'Color'] = function() {
        var args = Array.prototype.slice.call(arguments);
        console.warn('$mdThemingProviderTheme.' + colorType + 'Color() has been deprecated. ' +
                     'Use $mdThemingProviderTheme.' + colorType + 'Palette() instead.');
        return self[colorType + 'Palette'].apply(self, args);
      };
    });
  }

  /**
   * @ngdoc service
   * @name $mdTheming
   *
   * @description
   *
   * Service that makes an element apply theming related classes to itself.
   *
   * ```js
   * app.directive('myFancyDirective', function($mdTheming) {
   *   return {
   *     restrict: 'e',
   *     link: function(scope, el, attrs) {
   *       $mdTheming(el);
   *     }
   *   };
   * });
   * ```
   * @param {el=} element to apply theming to
   */
  /* @ngInject */
  function ThemingService($rootScope, $log) {

    applyTheme.inherit = function(el, parent) {
      var ctrl = parent.controller('mdTheme');

      var attrThemeValue = el.attr('md-theme-watch');
      if ( (alwaysWatchTheme || angular.isDefined(attrThemeValue)) && attrThemeValue != 'false') {
        var deregisterWatch = $rootScope.$watch(function() {
          return ctrl && ctrl.$mdTheme || defaultTheme;
        }, changeTheme);
        el.on('$destroy', deregisterWatch);
      } else {
        var theme = ctrl && ctrl.$mdTheme || defaultTheme;
        changeTheme(theme);
      }

      function changeTheme(theme) {
        if (!registered(theme)) {
          $log.warn('Attempted to use unregistered theme \'' + theme + '\'. ' +
                    'Register it with $mdThemingProvider.theme().');
        }
        var oldTheme = el.data('$mdThemeName');
        if (oldTheme) el.removeClass('md-' + oldTheme +'-theme');
        el.addClass('md-' + theme + '-theme');
        el.data('$mdThemeName', theme);
      }
    };

    applyTheme.THEMES = angular.extend({}, THEMES);
    applyTheme.defaultTheme = function() { return defaultTheme; };
    applyTheme.registered = registered;

    return applyTheme;

    function registered(themeName) {
      if (themeName === undefined || themeName === '') return true;
      return applyTheme.THEMES[themeName] !== undefined;
    }

    function applyTheme(scope, el) {
      // Allow us to be invoked via a linking function signature.
      if (el === undefined) {
        el = scope;
        scope = undefined;
      }
      if (scope === undefined) {
        scope = $rootScope;
      }
      applyTheme.inherit(el, el);
    }
  }
}
ThemingProvider.$inject = ["$mdColorPalette"];

function ThemingDirective($mdTheming, $interpolate, $log) {
  return {
    priority: 100,
    link: {
      pre: function(scope, el, attrs) {
        var ctrl = {
          $setTheme: function(theme) {
            if (!$mdTheming.registered(theme)) {
              $log.warn('attempted to use unregistered theme \'' + theme + '\'');
            }
            ctrl.$mdTheme = theme;
          }
        };
        el.data('$mdThemeController', ctrl);
        ctrl.$setTheme($interpolate(attrs.mdTheme)(scope));
        attrs.$observe('mdTheme', ctrl.$setTheme);
      }
    }
  };
}
ThemingDirective.$inject = ["$mdTheming", "$interpolate", "$log"];

function ThemableDirective($mdTheming) {
  return $mdTheming;
}
ThemableDirective.$inject = ["$mdTheming"];

function parseRules(theme, colorType, rules) {
  checkValidPalette(theme, colorType);

  rules = rules.replace(/THEME_NAME/g, theme.name);
  var generatedRules = [];
  var color = theme.colors[colorType];

  var themeNameRegex = new RegExp('.md-' + theme.name + '-theme', 'g');
  // Matches '{{ primary-color }}', etc
  var hueRegex = new RegExp('(\'|")?{{\\s*(' + colorType + ')-(color|contrast)-?(\\d\\.?\\d*)?\\s*}}(\"|\')?','g');
  var simpleVariableRegex = /'?"?\{\{\s*([a-zA-Z]+)-(A?\d+|hue\-[0-3]|shadow)-?(\d\.?\d*)?\s*\}\}'?"?/g;
  var palette = PALETTES[color.name];

  // find and replace simple variables where we use a specific hue, not an entire palette
  // eg. "{{primary-100}}"
  //\(' + THEME_COLOR_TYPES.join('\|') + '\)'
  rules = rules.replace(simpleVariableRegex, function(match, colorType, hue, opacity) {
    if (colorType === 'foreground') {
      if (hue == 'shadow') {
        return theme.foregroundShadow;
      } else {
        return theme.foregroundPalette[hue] || theme.foregroundPalette['1'];
      }
    }
    if (hue.indexOf('hue') === 0) {
      hue = theme.colors[colorType].hues[hue];
    }
    return rgba( (PALETTES[ theme.colors[colorType].name ][hue] || '').value, opacity );
  });

  // For each type, generate rules for each hue (ie. default, md-hue-1, md-hue-2, md-hue-3)
  angular.forEach(color.hues, function(hueValue, hueName) {
    var newRule = rules
      .replace(hueRegex, function(match, _, colorType, hueType, opacity) {
        return rgba(palette[hueValue][hueType === 'color' ? 'value' : 'contrast'], opacity);
      });
    if (hueName !== 'default') {
      newRule = newRule.replace(themeNameRegex, '.md-' + theme.name + '-theme.md-' + hueName);
    }

    // Don't apply a selector rule to the default theme, making it easier to override
    // styles of the base-component
    if (theme.name == 'default') {
      newRule = newRule.replace(/\.md-default-theme/g, '');
    }
    generatedRules.push(newRule);
  });

  return generatedRules;
}

// Generate our themes at run time given the state of THEMES and PALETTES
function generateThemes($injector) {

  var head = document.getElementsByTagName('head')[0];
  var firstChild = head ? head.firstElementChild : null;
  var themeCss = $injector.has('$MD_THEME_CSS') ? $injector.get('$MD_THEME_CSS') : '';

  if ( !firstChild ) return;
  if (themeCss.length === 0) return; // no rules, so no point in running this expensive task

  // Expose contrast colors for palettes to ensure that text is always readable
  angular.forEach(PALETTES, sanitizePalette);

  // MD_THEME_CSS is a string generated by the build process that includes all the themable
  // components as templates

  // Break the CSS into individual rules
  var rulesByType = {};
  var rules = themeCss
                  .split(/\}(?!(\}|'|"|;))/)
                  .filter(function(rule) { return rule && rule.length; })
                  .map(function(rule) { return rule.trim() + '}'; });


  var ruleMatchRegex = new RegExp('md-(' + THEME_COLOR_TYPES.join('|') + ')', 'g');

  THEME_COLOR_TYPES.forEach(function(type) {
    rulesByType[type] = '';
  });


  // Sort the rules based on type, allowing us to do color substitution on a per-type basis
  rules.forEach(function(rule) {
    var match = rule.match(ruleMatchRegex);
    // First: test that if the rule has '.md-accent', it goes into the accent set of rules
    for (var i = 0, type; type = THEME_COLOR_TYPES[i]; i++) {
      if (rule.indexOf('.md-' + type) > -1) {
        return rulesByType[type] += rule;
      }
    }

    // If no eg 'md-accent' class is found, try to just find 'accent' in the rule and guess from
    // there
    for (i = 0; type = THEME_COLOR_TYPES[i]; i++) {
      if (rule.indexOf(type) > -1) {
        return rulesByType[type] += rule;
      }
    }

    // Default to the primary array
    return rulesByType[DEFAULT_COLOR_TYPE] += rule;
  });

    // For each theme, use the color palettes specified for
    // `primary`, `warn` and `accent` to generate CSS rules.

    angular.forEach(THEMES, function(theme) {
      if ( !GENERATED[theme.name] ) {


        THEME_COLOR_TYPES.forEach(function(colorType) {
          var styleStrings = parseRules(theme, colorType, rulesByType[colorType]);
          while (styleStrings.length) {
            var style = document.createElement('style');
                style.setAttribute('type', 'text/css');
            style.appendChild(document.createTextNode(styleStrings.shift()));
            head.insertBefore(style, firstChild);
          }
        });


        if (theme.colors.primary.name == theme.colors.accent.name) {
          console.warn("$mdThemingProvider: Using the same palette for primary and" +
                       " accent. This violates the material design spec.");
        }

        GENERATED[theme.name] = true;
      }
    });


  // *************************
  // Internal functions
  // *************************

  // The user specifies a 'default' contrast color as either light or dark,
  // then explicitly lists which hues are the opposite contrast (eg. A100 has dark, A200 has light)
  function sanitizePalette(palette) {
    var defaultContrast = palette.contrastDefaultColor;
    var lightColors = palette.contrastLightColors || [];
    var strongLightColors = palette.contrastStrongLightColors || [];
    var darkColors = palette.contrastDarkColors || [];

    // These colors are provided as space-separated lists
    if (typeof lightColors === 'string') lightColors = lightColors.split(' ');
    if (typeof strongLightColors === 'string') strongLightColors = strongLightColors.split(' ');
    if (typeof darkColors === 'string') darkColors = darkColors.split(' ');

    // Cleanup after ourselves
    delete palette.contrastDefaultColor;
    delete palette.contrastLightColors;
    delete palette.contrastStrongLightColors;
    delete palette.contrastDarkColors;

    // Change { 'A100': '#fffeee' } to { 'A100': { value: '#fffeee', contrast:DARK_CONTRAST_COLOR }
    angular.forEach(palette, function(hueValue, hueName) {
      if (angular.isObject(hueValue)) return; // Already converted
      // Map everything to rgb colors
      var rgbValue = colorToRgbaArray(hueValue);
      if (!rgbValue) {
        throw new Error("Color %1, in palette %2's hue %3, is invalid. Hex or rgb(a) color expected."
                        .replace('%1', hueValue)
                        .replace('%2', palette.name)
                        .replace('%3', hueName));
      }

      palette[hueName] = {
        value: rgbValue,
        contrast: getContrastColor()
      };
      function getContrastColor() {
        if (defaultContrast === 'light') {
          if (darkColors.indexOf(hueName) > -1) {
            return DARK_CONTRAST_COLOR;
          } else {
            return strongLightColors.indexOf(hueName) > -1 ? STRONG_LIGHT_CONTRAST_COLOR
              : LIGHT_CONTRAST_COLOR;
          }
        } else {
          if (lightColors.indexOf(hueName) > -1) {
            return strongLightColors.indexOf(hueName) > -1 ? STRONG_LIGHT_CONTRAST_COLOR
              : LIGHT_CONTRAST_COLOR;
          } else {
            return DARK_CONTRAST_COLOR;
          }
        }
      }
    });
  }


}
generateThemes.$inject = ["$injector"];

function checkValidPalette(theme, colorType) {
  // If theme attempts to use a palette that doesnt exist, throw error
  if (!PALETTES[ (theme.colors[colorType] || {}).name ]) {
    throw new Error(
      "You supplied an invalid color palette for theme %1's %2 palette. Available palettes: %3"
                    .replace('%1', theme.name)
                    .replace('%2', colorType)
                    .replace('%3', Object.keys(PALETTES).join(', '))
    );
  }
}

function colorToRgbaArray(clr) {
  if (angular.isArray(clr) && clr.length == 3) return clr;
  if (/^rgb/.test(clr)) {
    return clr.replace(/(^\s*rgba?\(|\)\s*$)/g, '').split(',').map(function(value, i) {
      return i == 3 ? parseFloat(value, 10) : parseInt(value, 10);
    });
  }
  if (clr.charAt(0) == '#') clr = clr.substring(1);
  if (!/^([a-fA-F0-9]{3}){1,2}$/g.test(clr)) return;

  var dig = clr.length / 3;
  var red = clr.substr(0, dig);
  var grn = clr.substr(dig, dig);
  var blu = clr.substr(dig * 2);
  if (dig === 1) {
    red += red;
    grn += grn;
    blu += blu;
  }
  return [parseInt(red, 16), parseInt(grn, 16), parseInt(blu, 16)];
}

function rgba(rgbArray, opacity) {
  if ( !rgbArray ) return "rgb('0,0,0')";

  if (rgbArray.length == 4) {
    rgbArray = angular.copy(rgbArray);
    opacity ? rgbArray.pop() : opacity = rgbArray.pop();
  }
  return opacity && (typeof opacity == 'number' || (typeof opacity == 'string' && opacity.length)) ?
    'rgba(' + rgbArray.join(',') + ',' + opacity + ')' :
    'rgb(' + rgbArray.join(',') + ')';
}


})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.autocomplete
 */
/*
 * @see js folder for autocomplete implementation
 */
angular.module('material.components.autocomplete', [
  'material.core',
  'material.components.icon'
]);

})();
(function(){
"use strict";

/*
 * @ngdoc module
 * @name material.components.backdrop
 * @description Backdrop
 */

/**
 * @ngdoc directive
 * @name mdBackdrop
 * @module material.components.backdrop
 *
 * @restrict E
 *
 * @description
 * `<md-backdrop>` is a backdrop element used by other components, such as dialog and bottom sheet.
 * Apply class `opaque` to make the backdrop use the theme backdrop color.
 *
 */

angular.module('material.components.backdrop', [
  'material.core'
])
  .directive('mdBackdrop', BackdropDirective);

function BackdropDirective($mdTheming) {
  return $mdTheming;
}
BackdropDirective.$inject = ["$mdTheming"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.bottomSheet
 * @description
 * BottomSheet
 */
angular.module('material.components.bottomSheet', [
  'material.core',
  'material.components.backdrop'
])
  .directive('mdBottomSheet', MdBottomSheetDirective)
  .provider('$mdBottomSheet', MdBottomSheetProvider);

function MdBottomSheetDirective() {
  return {
    restrict: 'E'
  };
}

/**
 * @ngdoc service
 * @name $mdBottomSheet
 * @module material.components.bottomSheet
 *
 * @description
 * `$mdBottomSheet` opens a bottom sheet over the app and provides a simple promise API.
 *
 * ## Restrictions
 *
 * - The bottom sheet's template must have an outer `<md-bottom-sheet>` element.
 * - Add the `md-grid` class to the bottom sheet for a grid layout.
 * - Add the `md-list` class to the bottom sheet for a list layout.
 *
 * @usage
 * <hljs lang="html">
 * <div ng-controller="MyController">
 *   <md-button ng-click="openBottomSheet()">
 *     Open a Bottom Sheet!
 *   </md-button>
 * </div>
 * </hljs>
 * <hljs lang="js">
 * var app = angular.module('app', ['ngMaterial']);
 * app.controller('MyController', function($scope, $mdBottomSheet) {
 *   $scope.openBottomSheet = function() {
 *     $mdBottomSheet.show({
 *       template: '<md-bottom-sheet>Hello!</md-bottom-sheet>'
 *     });
 *   };
 * });
 * </hljs>
 */

 /**
 * @ngdoc method
 * @name $mdBottomSheet#show
 *
 * @description
 * Show a bottom sheet with the specified options.
 *
 * @param {object} options An options object, with the following properties:
 *
 *   - `templateUrl` - `{string=}`: The url of an html template file that will
 *   be used as the content of the bottom sheet. Restrictions: the template must
 *   have an outer `md-bottom-sheet` element.
 *   - `template` - `{string=}`: Same as templateUrl, except this is an actual
 *   template string.
 *   - `scope` - `{object=}`: the scope to link the template / controller to. If none is specified, it will create a new child scope.
 *     This scope will be destroyed when the bottom sheet is removed unless `preserveScope` is set to true.
 *   - `preserveScope` - `{boolean=}`: whether to preserve the scope when the element is removed. Default is false
 *   - `controller` - `{string=}`: The controller to associate with this bottom sheet.
 *   - `locals` - `{string=}`: An object containing key/value pairs. The keys will
 *   be used as names of values to inject into the controller. For example,
 *   `locals: {three: 3}` would inject `three` into the controller with the value
 *   of 3.
 *   - `targetEvent` - `{DOMClickEvent=}`: A click's event object. When passed in as an option,
 *   the location of the click will be used as the starting point for the opening animation
 *   of the the dialog.
 *   - `resolve` - `{object=}`: Similar to locals, except it takes promises as values
 *   and the bottom sheet will not open until the promises resolve.
 *   - `controllerAs` - `{string=}`: An alias to assign the controller to on the scope.
 *   - `parent` - `{element=}`: The element to append the bottom sheet to. The `parent` may be a `function`, `string`,
 *   `object`, or null. Defaults to appending to the body of the root element (or the root element) of the application.
 *   e.g. angular.element(document.getElementById('content')) or "#content"
 *   - `disableParentScroll` - `{boolean=}`: Whether to disable scrolling while the bottom sheet is open.
 *     Default true.
 *
 * @returns {promise} A promise that can be resolved with `$mdBottomSheet.hide()` or
 * rejected with `$mdBottomSheet.cancel()`.
 */

/**
 * @ngdoc method
 * @name $mdBottomSheet#hide
 *
 * @description
 * Hide the existing bottom sheet and resolve the promise returned from
 * `$mdBottomSheet.show()`. This call will close the most recently opened/current bottomsheet (if any).
 *
 * @param {*=} response An argument for the resolved promise.
 *
 */

/**
 * @ngdoc method
 * @name $mdBottomSheet#cancel
 *
 * @description
 * Hide the existing bottom sheet and reject the promise returned from
 * `$mdBottomSheet.show()`.
 *
 * @param {*=} response An argument for the rejected promise.
 *
 */

function MdBottomSheetProvider($$interimElementProvider) {
  // how fast we need to flick down to close the sheet, pixels/ms
  var CLOSING_VELOCITY = 0.5;
  var PADDING = 80; // same as css

  bottomSheetDefaults.$inject = ["$animate", "$mdConstant", "$mdUtil", "$timeout", "$compile", "$mdTheming", "$mdBottomSheet", "$rootElement", "$mdGesture"];
  return $$interimElementProvider('$mdBottomSheet')
    .setDefaults({
      methods: ['disableParentScroll', 'escapeToClose', 'targetEvent'],
      options: bottomSheetDefaults
    });

  /* @ngInject */
  function bottomSheetDefaults($animate, $mdConstant, $mdUtil, $timeout, $compile, $mdTheming, $mdBottomSheet, $rootElement, $mdGesture) {
    var backdrop;

    return {
      themable: true,
      targetEvent: null,
      onShow: onShow,
      onRemove: onRemove,
      escapeToClose: true,
      disableParentScroll: true
    };


    function onShow(scope, element, options) {

      element = $mdUtil.extractElementByName(element, 'md-bottom-sheet');

      // Add a backdrop that will close on click
      backdrop = $compile('<md-backdrop class="md-opaque md-bottom-sheet-backdrop">')(scope);
      backdrop.on('click', function() {
        $timeout($mdBottomSheet.cancel);
      });
      $mdTheming.inherit(backdrop, options.parent);

      $animate.enter(backdrop, options.parent, null);

      var bottomSheet = new BottomSheet(element, options.parent);
      options.bottomSheet = bottomSheet;

      // Give up focus on calling item
      options.targetEvent && angular.element(options.targetEvent.target).blur();
      $mdTheming.inherit(bottomSheet.element, options.parent);

      if (options.disableParentScroll) {
        options.lastOverflow = options.parent.css('overflow');
        options.parent.css('overflow', 'hidden');
      }

      return $animate.enter(bottomSheet.element, options.parent)
        .then(function() {
          var focusable = angular.element(
            element[0].querySelector('button') ||
            element[0].querySelector('a') ||
            element[0].querySelector('[ng-click]')
          );
          focusable.focus();

          if (options.escapeToClose) {
            options.rootElementKeyupCallback = function(e) {
              if (e.keyCode === $mdConstant.KEY_CODE.ESCAPE) {
                $timeout($mdBottomSheet.cancel);
              }
            };
            $rootElement.on('keyup', options.rootElementKeyupCallback);
          }
        });

    }

    function onRemove(scope, element, options) {

      var bottomSheet = options.bottomSheet;

      $animate.leave(backdrop);
      return $animate.leave(bottomSheet.element).then(function() {
        if (options.disableParentScroll) {
          options.parent.css('overflow', options.lastOverflow);
          delete options.lastOverflow;
        }

        bottomSheet.cleanup();

        // Restore focus
        options.targetEvent && angular.element(options.targetEvent.target).focus();
      });
    }

    /**
     * BottomSheet class to apply bottom-sheet behavior to an element
     */
    function BottomSheet(element, parent) {
      var deregister = $mdGesture.register(parent, 'drag', { horizontal: false });
      parent.on('$md.dragstart', onDragStart)
        .on('$md.drag', onDrag)
        .on('$md.dragend', onDragEnd);

      return {
        element: element,
        cleanup: function cleanup() {
          deregister();
          parent.off('$md.dragstart', onDragStart)
            .off('$md.drag', onDrag)
            .off('$md.dragend', onDragEnd);
        }
      };

      function onDragStart(ev) {
        // Disable transitions on transform so that it feels fast
        element.css($mdConstant.CSS.TRANSITION_DURATION, '0ms');
      }

      function onDrag(ev) {
        var transform = ev.pointer.distanceY;
        if (transform < 5) {
          // Slow down drag when trying to drag up, and stop after PADDING
          transform = Math.max(-PADDING, transform / 2);
        }
        element.css($mdConstant.CSS.TRANSFORM, 'translate3d(0,' + (PADDING + transform) + 'px,0)');
      }

      function onDragEnd(ev) {
        if (ev.pointer.distanceY > 0 &&
            (ev.pointer.distanceY > 20 || Math.abs(ev.pointer.velocityY) > CLOSING_VELOCITY)) {
          var distanceRemaining = element.prop('offsetHeight') - ev.pointer.distanceY;
          var transitionDuration = Math.min(distanceRemaining / ev.pointer.velocityY * 0.75, 500);
          element.css($mdConstant.CSS.TRANSITION_DURATION, transitionDuration + 'ms');
          $timeout($mdBottomSheet.cancel);
        } else {
          element.css($mdConstant.CSS.TRANSITION_DURATION, '');
          element.css($mdConstant.CSS.TRANSFORM, '');
        }
      }
    }

  }

}
MdBottomSheetProvider.$inject = ["$$interimElementProvider"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.button
 * @description
 *
 * Button
 */
angular
    .module('material.components.button', [ 'material.core' ])
    .directive('mdButton', MdButtonDirective);

/**
 * @ngdoc directive
 * @name mdButton
 * @module material.components.button
 *
 * @restrict E
 *
 * @description
 * `<md-button>` is a button directive with optional ink ripples (default enabled).
 *
 * If you supply a `href` or `ng-href` attribute, it will become an `<a>` element. Otherwise, it will
 * become a `<button>` element. As per the [Material Design specifications](http://www.google.com/design/spec/style/color.html#color-ui-color-application)
 * the FAB button background is filled with the accent color [by default]. The primary color palette may be used with
 * the `md-primary` class.
 *
 * @param {boolean=} md-no-ink If present, disable ripple ink effects.
 * @param {expression=} ng-disabled En/Disable based on the expression
 * @param {string=} md-ripple-size Overrides the default ripple size logic. Options: `full`, `partial`, `auto`
 * @param {string=} aria-label Adds alternative text to button for accessibility, useful for icon buttons.
 * If no default text is found, a warning will be logged.
 *
 * @usage
 *
 * Regular buttons:
 *
 * <hljs lang="html">
 *  <md-button> Flat Button </md-button>
 *  <md-button href="http://google.com"> Flat link </md-button>
 *  <md-button class="md-raised"> Raised Button </md-button>
 *  <md-button ng-disabled="true"> Disabled Button </md-button>
 *  <md-button>
 *    <md-icon md-svg-src="your/icon.svg"></md-icon>
 *    Register Now
 *  </md-button>
 * </hljs>
 *
 * FAB buttons:
 *
 * <hljs lang="html">
 *  <md-button class="md-fab" aria-label="FAB">
 *    <md-icon md-svg-src="your/icon.svg"></md-icon>
 *  </md-button>
 *  <!-- mini-FAB -->
 *  <md-button class="md-fab md-mini" aria-label="Mini FAB">
 *    <md-icon md-svg-src="your/icon.svg"></md-icon>
 *  </md-button>
 *  <!-- Button with SVG Icon -->
 *  <md-button class="md-icon-button" aria-label="Custom Icon Button">
 *    <md-icon md-svg-icon="path/to/your.svg"></md-icon>
 *  </md-button>
 * </hljs>
 */
function MdButtonDirective($mdButtonInkRipple, $mdTheming, $mdAria, $timeout) {

  return {
    restrict: 'EA',
    replace: true,
    transclude: true,
    template: getTemplate,
    link: postLink
  };

  function isAnchor(attr) {
    return angular.isDefined(attr.href) || angular.isDefined(attr.ngHref) || angular.isDefined(attr.ngLink) || angular.isDefined(attr.uiSref);
  }

  function getTemplate(element, attr) {
    return isAnchor(attr) ?
           '<a class="md-button" ng-transclude></a>' :
           '<button class="md-button" ng-transclude></button>';
  }

  function postLink(scope, element, attr) {
    var node = element[0];
    $mdTheming(element);
    $mdButtonInkRipple.attach(scope, element);

    var elementHasText = node.textContent.trim();
    if (!elementHasText) {
      $mdAria.expect(element, 'aria-label');
    }

    // For anchor elements, we have to set tabindex manually when the
    // element is disabled
    if (isAnchor(attr) && angular.isDefined(attr.ngDisabled) ) {
      scope.$watch(attr.ngDisabled, function(isDisabled) {
        element.attr('tabindex', isDisabled ? -1 : 0);
      });
    }

    // disabling click event when disabled is true
    element.on('click', function(e){
      if (attr.disabled === true) {
        e.preventDefault();
        e.stopImmediatePropagation();
      }
    });

    // restrict focus styles to the keyboard
    scope.mouseActive = false;
    element.on('mousedown', function() {
        scope.mouseActive = true;
        $timeout(function(){
          scope.mouseActive = false;
        }, 100);
      })
      .on('focus', function() {
        if(scope.mouseActive === false) { element.addClass('md-focused'); }
      })
      .on('blur', function() { element.removeClass('md-focused'); });
  }

}
MdButtonDirective.$inject = ["$mdButtonInkRipple", "$mdTheming", "$mdAria", "$timeout"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.card
 *
 * @description
 * Card components.
 */
angular.module('material.components.card', [
  'material.core'
])
  .directive('mdCard', mdCardDirective);



/**
 * @ngdoc directive
 * @name mdCard
 * @module material.components.card
 *
 * @restrict E
 *
 * @description
 * The `<md-card>` directive is a container element used within `<md-content>` containers.
 *
 * An image included as a direct descendant will fill the card's width, while the `<md-card-content>`
 * container will wrap text content and provide padding. An `<md-card-footer>` element can be
 * optionally included to put content flush against the bottom edge of the card.
 *
 * Action buttons can be included in an element with the `.md-actions` class, also used in `md-dialog`.
 * You can then position buttons using layout attributes.
 *
 * Cards have constant width and variable heights; where the maximum height is limited to what can
 * fit within a single view on a platform, but it can temporarily expand as needed.
 *
 * @usage
 * ###Card with optional footer
 * <hljs lang="html">
 * <md-card>
 *  <img src="card-image.png" class="md-card-image" alt="image caption">
 *  <md-card-content>
 *    <h2>Card headline</h2>
 *    <p>Card content</p>
 *  </md-card-content>
 *  <md-card-footer>
 *    Card footer
 *  </md-card-footer>
 * </md-card>
 * </hljs>
 *
 * ###Card with actions
 * <hljs lang="html">
 * <md-card>
 *  <img src="card-image.png" class="md-card-image" alt="image caption">
 *  <md-card-content>
 *    <h2>Card headline</h2>
 *    <p>Card content</p>
 *  </md-card-content>
 *  <div class="md-actions" layout="row" layout-align="end center">
 *    <md-button>Action 1</md-button>
 *    <md-button>Action 2</md-button>
 *  </div>
 * </md-card>
 * </hljs>
 *
 */
function mdCardDirective($mdTheming) {
  return {
    restrict: 'E',
    link: function($scope, $element, $attr) {
      $mdTheming($element);
    }
  };
}
mdCardDirective.$inject = ["$mdTheming"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.checkbox
 * @description Checkbox module!
 */
angular
  .module('material.components.checkbox', ['material.core'])
  .directive('mdCheckbox', MdCheckboxDirective);

/**
 * @ngdoc directive
 * @name mdCheckbox
 * @module material.components.checkbox
 * @restrict E
 *
 * @description
 * The checkbox directive is used like the normal [angular checkbox](https://docs.angularjs.org/api/ng/input/input%5Bcheckbox%5D).
 *
 * As per the [material design spec](http://www.google.com/design/spec/style/color.html#color-ui-color-application)
 * the checkbox is in the accent color by default. The primary color palette may be used with
 * the `md-primary` class.
 *
 * @param {string} ng-model Assignable angular expression to data-bind to.
 * @param {string=} name Property name of the form under which the control is published.
 * @param {expression=} ng-true-value The value to which the expression should be set when selected.
 * @param {expression=} ng-false-value The value to which the expression should be set when not selected.
 * @param {string=} ng-change Angular expression to be executed when input changes due to user interaction with the input element.
 * @param {boolean=} md-no-ink Use of attribute indicates use of ripple ink effects
 * @param {string=} aria-label Adds label to checkbox for accessibility.
 * Defaults to checkbox's text. If no default text is found, a warning will be logged.
 *
 * @usage
 * <hljs lang="html">
 * <md-checkbox ng-model="isChecked" aria-label="Finished?">
 *   Finished ?
 * </md-checkbox>
 *
 * <md-checkbox md-no-ink ng-model="hasInk" aria-label="No Ink Effects">
 *   No Ink Effects
 * </md-checkbox>
 *
 * <md-checkbox ng-disabled="true" ng-model="isDisabled" aria-label="Disabled">
 *   Disabled
 * </md-checkbox>
 *
 * </hljs>
 *
 */
function MdCheckboxDirective(inputDirective, $mdInkRipple, $mdAria, $mdConstant, $mdTheming, $mdUtil, $timeout) {
  inputDirective = inputDirective[0];
  var CHECKED_CSS = 'md-checked';

  return {
    restrict: 'E',
    transclude: true,
    require: '?ngModel',
    priority:210, // Run before ngAria
    template: 
      '<div class="md-container" md-ink-ripple md-ink-ripple-checkbox>' +
        '<div class="md-icon"></div>' +
      '</div>' +
      '<div ng-transclude class="md-label"></div>',
    compile: compile
  };

  // **********************************************************
  // Private Methods
  // **********************************************************

  function compile (tElement, tAttrs) {

    tAttrs.type = 'checkbox';
    tAttrs.tabindex = tAttrs.tabindex || '0';
    tElement.attr('role', tAttrs.type);

    return function postLink(scope, element, attr, ngModelCtrl) {
      ngModelCtrl = ngModelCtrl || $mdUtil.fakeNgModel();
      $mdTheming(element);

      if (attr.ngChecked) {
        scope.$watch(
            scope.$eval.bind(scope, attr.ngChecked),
            ngModelCtrl.$setViewValue.bind(ngModelCtrl)
        );
      }
      $$watchExpr('ngDisabled', 'tabindex', {
        true: '-1',
        false: attr.tabindex
      });
      $mdAria.expectWithText(element, 'aria-label');

      // Reuse the original input[type=checkbox] directive from Angular core.
      // This is a bit hacky as we need our own event listener and own render
      // function.
      inputDirective.link.pre(scope, {
        on: angular.noop,
        0: {}
      }, attr, [ngModelCtrl]);

      scope.mouseActive = false;
      element.on('click', listener)
        .on('keypress', keypressHandler)
        .on('mousedown', function() {
          scope.mouseActive = true;
          $timeout(function(){
            scope.mouseActive = false;
          }, 100);
        })
        .on('focus', function() {
          if(scope.mouseActive === false) { element.addClass('md-focused'); }
        })
        .on('blur', function() { element.removeClass('md-focused'); });

      ngModelCtrl.$render = render;

      function $$watchExpr(expr, htmlAttr, valueOpts) {
        if (attr[expr]) {
          scope.$watch(attr[expr], function(val) {
            if (valueOpts[val]) {
              element.attr(htmlAttr, valueOpts[val]);
            }
          });
        }
      }

      function keypressHandler(ev) {
        var keyCode = ev.which || ev.keyCode;
        if (keyCode === $mdConstant.KEY_CODE.SPACE || keyCode === $mdConstant.KEY_CODE.ENTER) {
          ev.preventDefault();
          if (!element.hasClass('md-focused')) { element.addClass('md-focused'); }
          listener(ev);
        }
      }
      function listener(ev) {
        if (element[0].hasAttribute('disabled')) return;

        scope.$apply(function() {
          // Toggle the checkbox value...
          var viewValue = attr.ngChecked ? attr.checked : !ngModelCtrl.$viewValue;

          ngModelCtrl.$setViewValue( viewValue, ev && ev.type);
          ngModelCtrl.$render();
        });
      }

      function render() {
        if(ngModelCtrl.$viewValue) {
          element.addClass(CHECKED_CSS);
        } else {
          element.removeClass(CHECKED_CSS);
        }
      }
    };
  }
}
MdCheckboxDirective.$inject = ["inputDirective", "$mdInkRipple", "$mdAria", "$mdConstant", "$mdTheming", "$mdUtil", "$timeout"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.chips
 */
/*
 * @see js folder for chips implementation
 */
angular.module('material.components.chips', [
  'material.core',
  'material.components.autocomplete'
]);

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.content
 *
 * @description
 * Scrollable content
 */
angular.module('material.components.content', [
  'material.core'
])
  .directive('mdContent', mdContentDirective);

/**
 * @ngdoc directive
 * @name mdContent
 * @module material.components.content
 *
 * @restrict E
 *
 * @description
 * The `<md-content>` directive is a container element useful for scrollable content
 *
 * @usage
 *
 * - Add the `[layout-padding]` attribute to make the content padded.
 *
 * <hljs lang="html">
 *  <md-content layout-padding>
 *      Lorem ipsum dolor sit amet, ne quod novum mei.
 *  </md-content>
 * </hljs>
 *
 */

function mdContentDirective($mdTheming) {
  return {
    restrict: 'E',
    controller: ['$scope', '$element', ContentController],
    link: function(scope, element, attr) {
      var node = element[0];

      $mdTheming(element);
      scope.$broadcast('$mdContentLoaded', element);

      iosScrollFix(element[0]);
    }
  };

  function ContentController($scope, $element) {
    this.$scope = $scope;
    this.$element = $element;
  }
}
mdContentDirective.$inject = ["$mdTheming"];

function iosScrollFix(node) {
  // IOS FIX:
  // If we scroll where there is no more room for the webview to scroll,
  // by default the webview itself will scroll up and down, this looks really
  // bad.  So if we are scrolling to the very top or bottom, add/subtract one
  angular.element(node).on('$md.pressdown', function(ev) {
    // Only touch events
    if (ev.pointer.type !== 't') return;
    // Don't let a child content's touchstart ruin it for us.
    if (ev.$materialScrollFixed) return;
    ev.$materialScrollFixed = true;

    if (node.scrollTop === 0) {
      node.scrollTop = 1;
    } else if (node.scrollHeight === node.scrollTop + node.offsetHeight) {
      node.scrollTop -= 1;
    }
  });
}

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.dialog
 */
angular.module('material.components.dialog', [
  'material.core',
  'material.components.backdrop'
])
  .directive('mdDialog', MdDialogDirective)
  .provider('$mdDialog', MdDialogProvider);

function MdDialogDirective($$rAF, $mdTheming) {
  return {
    restrict: 'E',
    link: function(scope, element, attr) {
      $mdTheming(element);
      $$rAF(function() {
        var content = element[0].querySelector('md-dialog-content');
        if (content && content.scrollHeight > content.clientHeight) {
          element.addClass('md-content-overflow');
        }
      });
    }
  };
}
MdDialogDirective.$inject = ["$$rAF", "$mdTheming"];

/**
 * @ngdoc service
 * @name $mdDialog
 * @module material.components.dialog
 *
 * @description
 * `$mdDialog` opens a dialog over the app to inform users about critical information or require
 *  them to make decisions. There are two approaches for setup: a simple promise API
 *  and regular object syntax.
 *
 * ## Restrictions
 *
 * - The dialog is always given an isolate scope.
 * - The dialog's template must have an outer `<md-dialog>` element.
 *   Inside, use an `<md-dialog-content>` element for the dialog's content, and use
 *   an element with class `md-actions` for the dialog's actions.
 * - Dialogs must cover the entire application to keep interactions inside of them.
 * Use the `parent` option to change where dialogs are appended.
 *
 * ## Sizing
 * - Complex dialogs can be sized with `flex="percentage"`, i.e. `flex="66"`.
 * - Default max-width is 80% of the `rootElement` or `parent`.
 *
 * @usage
 * <hljs lang="html">
 * <div  ng-app="demoApp" ng-controller="EmployeeController">
 *   <div>
 *     <md-button ng-click="showAlert()" class="md-raised md-warn">
 *       Employee Alert!
 *       </md-button>
 *   </div>
 *   <div>
 *     <md-button ng-click="showDialog($event)" class="md-raised">
 *       Custom Dialog
 *       </md-button>
 *   </div>
 *   <div>
 *     <md-button ng-click="closeAlert()" ng-disabled="!hasAlert()" class="md-raised">
 *       Close Alert
 *     </md-button>
 *   </div>
 *   <div>
 *     <md-button ng-click="showGreeting($event)" class="md-raised md-primary" >
 *       Greet Employee
 *       </md-button>
 *   </div>
 * </div>
 * </hljs>
 *
 * ### JavaScript: object syntax
 * <hljs lang="js">
 * (function(angular, undefined){
 *   "use strict";
 *
 *   angular
 *    .module('demoApp', ['ngMaterial'])
 *    .controller('AppCtrl', AppController);
 *
 *   function AppController($scope, $mdDialog) {
 *     var alert;
 *     $scope.showAlert = showAlert;
 *     $scope.showDialog = showDialog;
 *     $scope.items = [1, 2, 3];
 *
 *     // Internal method
 *     function showAlert() {
 *       alert = $mdDialog.alert({
 *         title: 'Attention',
 *         content: 'This is an example of how easy dialogs can be!',
 *         ok: 'Close'
 *       });
 *
 *       $mdDialog
 *         .show( alert )
 *         .finally(function() {
 *           alert = undefined;
 *         });
 *     }
 *
 *     function showDialog($event) {
 *        var parentEl = angular.element(document.body);
 *        $mdDialog.show({
 *          parent: parentEl,
 *          targetEvent: $event,
 *          template:
 *            '<md-dialog aria-label="List dialog">' +
 *            '  <md-dialog-content>'+
 *            '    <md-list>'+
 *            '      <md-list-item ng-repeat="item in items">'+
 *            '       <p>Number {{item}}</p>' +
 *            '      </md-item>'+
 *            '    </md-list>'+
 *            '  </md-dialog-content>' +
 *            '  <div class="md-actions">' +
 *            '    <md-button ng-click="closeDialog()" class="md-primary">' +
 *            '      Close Dialog' +
 *            '    </md-button>' +
 *            '  </div>' +
 *            '</md-dialog>',
 *          locals: {
 *            items: $scope.items
 *          },
 *          controller: DialogController
 *       });
 *       function DialogController($scope, $mdDialog, items) {
 *         $scope.items = items;
 *         $scope.closeDialog = function() {
 *           $mdDialog.hide();
 *         }
 *       }
 *     }
 *   }
 * })(angular);
 * </hljs>
 *
 * ### JavaScript: promise API syntax, custom dialog template
 * <hljs lang="js">
 * (function(angular, undefined){
 *   "use strict";
 *
 *   angular
 *     .module('demoApp', ['ngMaterial'])
 *     .controller('EmployeeController', EmployeeEditor)
 *     .controller('GreetingController', GreetingController);
 *
 *   // Fictitious Employee Editor to show how to use simple and complex dialogs.
 *
 *   function EmployeeEditor($scope, $mdDialog) {
 *     var alert;
 *
 *     $scope.showAlert = showAlert;
 *     $scope.closeAlert = closeAlert;
 *     $scope.showGreeting = showCustomGreeting;
 *
 *     $scope.hasAlert = function() { return !!alert };
 *     $scope.userName = $scope.userName || 'Bobby';
 *
 *     // Dialog #1 - Show simple alert dialog and cache
 *     // reference to dialog instance
 *
 *     function showAlert() {
 *       alert = $mdDialog.alert()
 *         .title('Attention, ' + $scope.userName)
 *         .content('This is an example of how easy dialogs can be!')
 *         .ok('Close');
 *
 *       $mdDialog
 *           .show( alert )
 *           .finally(function() {
 *             alert = undefined;
 *           });
 *     }
 *
 *     // Close the specified dialog instance and resolve with 'finished' flag
 *     // Normally this is not needed, just use '$mdDialog.hide()' to close
 *     // the most recent dialog popup.
 *
 *     function closeAlert() {
 *       $mdDialog.hide( alert, "finished" );
 *       alert = undefined;
 *     }
 *
 *     // Dialog #2 - Demonstrate more complex dialogs construction and popup.
 *
 *     function showCustomGreeting($event) {
 *         $mdDialog.show({
 *           targetEvent: $event,
 *           template:
 *             '<md-dialog>' +
 *
 *             '  <md-dialog-content>Hello {{ employee }}!</md-dialog-content>' +
 *
 *             '  <div class="md-actions">' +
 *             '    <md-button ng-click="closeDialog()" class="md-primary">' +
 *             '      Close Greeting' +
 *             '    </md-button>' +
 *             '  </div>' +
 *             '</md-dialog>',
 *           controller: 'GreetingController',
 *           onComplete: afterShowAnimation,
 *           locals: { employee: $scope.userName }
 *         });
 *
 *         // When the 'enter' animation finishes...
 *
 *         function afterShowAnimation(scope, element, options) {
 *            // post-show code here: DOM element focus, etc.
 *         }
 *     }
 *
 *     // Dialog #3 - Demonstrate use of ControllerAs and passing $scope to dialog
 *     //             Here we used ng-controller="GreetingController as vm" and
 *     //             $scope.vm === <controller instance>
 *
 *     function showCustomGreeting() {
 *
 *        $mdDialog.show({
 *           clickOutsideToClose: true,
 *
 *           scope: $scope,        // use parent scope in template
 *           preserveScope: true,  // do not forget this if use parent scope

 *           // Since GreetingController is instantiated with ControllerAs syntax
 *           // AND we are passing the parent '$scope' to the dialog, we MUST
 *           // use 'vm.<xxx>' in the template markup
 *
 *           template: '<md-dialog>' +
 *                     '  <md-dialog-content>' +
 *                     '     Hi There {{vm.employee}}' +
 *                     '  </md-dialog-content>' +
 *                     '</md-dialog>',
 *
 *           controller: function DialogController($scope, $mdDialog) {
 *             $scope.closeDialog = function() {
 *               $mdDialog.hide();
 *             }
 *           }
 *        });
 *     }
 *
 *   }
 *
 *   // Greeting controller used with the more complex 'showCustomGreeting()' custom dialog
 *
 *   function GreetingController($scope, $mdDialog, employee) {
 *     // Assigned from construction <code>locals</code> options...
 *     $scope.employee = employee;
 *
 *     $scope.closeDialog = function() {
 *       // Easily hides most recent dialog shown...
 *       // no specific instance reference is needed.
 *       $mdDialog.hide();
 *     };
 *   }
 *
 * })(angular);
 * </hljs>
 */

 /**
 * @ngdoc method
 * @name $mdDialog#alert
 *
 * @description
 * Builds a preconfigured dialog with the specified message.
 *
 * @returns {obj} an `$mdDialogPreset` with the chainable configuration methods:
 *
 * - $mdDialogPreset#title(string) - sets title to string
 * - $mdDialogPreset#content(string) - sets content / message to string
 * - $mdDialogPreset#ok(string) - sets okay button text to string
 * - $mdDialogPreset#theme(string) - sets the theme of the dialog
 *
 */

 /**
 * @ngdoc method
 * @name $mdDialog#confirm
 *
 * @description
 * Builds a preconfigured dialog with the specified message. You can call show and the promise returned
 * will be resolved only if the user clicks the confirm action on the dialog.
 *
 * @returns {obj} an `$mdDialogPreset` with the chainable configuration methods:
 *
 * Additionally, it supports the following methods:
 *
 * - $mdDialogPreset#title(string) - sets title to string
 * - $mdDialogPreset#content(string) - sets content / message to string
 * - $mdDialogPreset#ok(string) - sets okay button text to string
 * - $mdDialogPreset#cancel(string) - sets cancel button text to string
 * - $mdDialogPreset#theme(string) - sets the theme of the dialog
 *
 */

/**
 * @ngdoc method
 * @name $mdDialog#show
 *
 * @description
 * Show a dialog with the specified options.
 *
 * @param {object} optionsOrPreset Either provide an `$mdDialogPreset` returned from `alert()`, and
 * `confirm()`, or an options object with the following properties:
 *   - `templateUrl` - `{string=}`: The url of a template that will be used as the content
 *   of the dialog.
 *   - `template` - `{string=}`: Same as templateUrl, except this is an actual template string.
 *   - `targetEvent` - `{DOMClickEvent=}`: A click's event object. When passed in as an option,
 *     the location of the click will be used as the starting point for the opening animation
 *     of the the dialog.
 *   - `scope` - `{object=}`: the scope to link the template / controller to. If none is specified,
 *     it will create a new isolate scope.
 *     This scope will be destroyed when the dialog is removed unless `preserveScope` is set to true.
 *   - `preserveScope` - `{boolean=}`: whether to preserve the scope when the element is removed. Default is false
 *   - `disableParentScroll` - `{boolean=}`: Whether to disable scrolling while the dialog is open.
 *     Default true.
 *   - `hasBackdrop` - `{boolean=}`: Whether there should be an opaque backdrop behind the dialog.
 *     Default true.
 *   - `clickOutsideToClose` - `{boolean=}`: Whether the user can click outside the dialog to
 *     close it. Default false.
 *   - `escapeToClose` - `{boolean=}`: Whether the user can press escape to close the dialog.
 *     Default true.
 *   - `focusOnOpen` - `{boolean=}`: An option to override focus behavior on open. Only disable if
 *     focusing some other way, as focus management is required for dialogs to be accessible.
 *     Defaults to true.
 *   - `controller` - `{string=}`: The controller to associate with the dialog. The controller
 *     will be injected with the local `$mdDialog`, which passes along a scope for the dialog.
 *   - `locals` - `{object=}`: An object containing key/value pairs. The keys will be used as names
 *     of values to inject into the controller. For example, `locals: {three: 3}` would inject
 *     `three` into the controller, with the value 3. If `bindToController` is true, they will be
 *     copied to the controller instead.
 *   - `bindToController` - `bool`: bind the locals to the controller, instead of passing them in.
 *     These values will not be available until after initialization.
 *   - `resolve` - `{object=}`: Similar to locals, except it takes promises as values, and the
 *     dialog will not open until all of the promises resolve.
 *   - `controllerAs` - `{string=}`: An alias to assign the controller to on the scope.
 *   - `parent` - `{element=}`: The element to append the dialog to. Defaults to appending
 *     to the root element of the application.
 *   - `onComplete` `{function=}`: Callback function used to announce when the show() action is
 *     finished.
 *
 * @returns {promise} A promise that can be resolved with `$mdDialog.hide()` or
 * rejected with `$mdDialog.cancel()`.
 */

/**
 * @ngdoc method
 * @name $mdDialog#hide
 *
 * @description
 * Hide an existing dialog and resolve the promise returned from `$mdDialog.show()`.
 *
 * @param {*=} response An argument for the resolved promise.
 *
 * @returns {promise} A promise that is resolved when the dialog has been closed.
 */

/**
 * @ngdoc method
 * @name $mdDialog#cancel
 *
 * @description
 * Hide an existing dialog and reject the promise returned from `$mdDialog.show()`.
 *
 * @param {*=} response An argument for the rejected promise.
 *
 * @returns {promise} A promise that is resolved when the dialog has been closed.
 */

function MdDialogProvider($$interimElementProvider) {

  var alertDialogMethods = ['title', 'content', 'ariaLabel', 'ok'];

  advancedDialogOptions.$inject = ["$mdDialog", "$mdTheming"];
  dialogDefaultOptions.$inject = ["$mdAria", "$document", "$mdUtil", "$mdConstant", "$mdTheming", "$mdDialog", "$timeout", "$rootElement", "$animate", "$$rAF", "$q"];
  return $$interimElementProvider('$mdDialog')
    .setDefaults({
      methods: ['disableParentScroll', 'hasBackdrop', 'clickOutsideToClose', 'escapeToClose', 'targetEvent', 'parent'],
      options: dialogDefaultOptions
    })
    .addPreset('alert', {
      methods: ['title', 'content', 'ariaLabel', 'ok', 'theme'],
      options: advancedDialogOptions
    })
    .addPreset('confirm', {
      methods: ['title', 'content', 'ariaLabel', 'ok', 'cancel', 'theme'],
      options: advancedDialogOptions
    });

  /* @ngInject */
  function advancedDialogOptions($mdDialog, $mdTheming) {
    return {
      template: [
        '<md-dialog md-theme="{{ dialog.theme }}" aria-label="{{ dialog.ariaLabel }}">',
          '<md-dialog-content role="document" tabIndex="-1">',
            '<h2 class="md-title">{{ dialog.title }}</h2>',
            '<p>{{ dialog.content }}</p>',
          '</md-dialog-content>',
          '<div class="md-actions">',
            '<md-button ng-if="dialog.$type == \'confirm\'"' +
                      ' ng-click="dialog.abort()" class="md-primary">',
              '{{ dialog.cancel }}',
            '</md-button>',
            '<md-button ng-click="dialog.hide()" class="md-primary">',
              '{{ dialog.ok }}',
            '</md-button>',
          '</div>',
        '</md-dialog>'
      ].join(''),
      controller: function mdDialogCtrl() {
        this.hide = function() {
          $mdDialog.hide(true);
        };
        this.abort = function() {
          $mdDialog.cancel();
        };
      },
      controllerAs: 'dialog',
      bindToController: true,
      theme: $mdTheming.defaultTheme()
    };
  }

  /* @ngInject */
  function dialogDefaultOptions($mdAria, $document, $mdUtil, $mdConstant, $mdTheming, $mdDialog, $timeout, $rootElement, $animate, $$rAF, $q) {
    return {
      hasBackdrop: true,
      isolateScope: true,
      onShow: onShow,
      onRemove: onRemove,
      clickOutsideToClose: false,
      escapeToClose: true,
      targetEvent: null,
      focusOnOpen: true,
      disableParentScroll: true,
      transformTemplate: function(template) {
        return '<div class="md-dialog-container">' + template + '</div>';
      }
    };

    function trapFocus(ev) {
      var dialog = document.querySelector('md-dialog');

      if (dialog && !dialog.contains(ev.target)) {
        ev.stopImmediatePropagation();
        dialog.focus();
      }
    }

    // On show method for dialogs
    function onShow(scope, element, options) {
      angular.element($document[0].body).addClass('md-dialog-is-showing');
      element = $mdUtil.extractElementByName(element, 'md-dialog');

      // Incase the user provides a raw dom element, always wrap it in jqLite
      options.parent = angular.element(options.parent);

      options.popInTarget = angular.element((options.targetEvent || {}).target);
      var closeButton = findCloseButton();

      if (options.hasBackdrop) {
        // Fix for IE 10
        var computeFrom = (options.parent[0] == $document[0].body && $document[0].documentElement
                           && $document[0].documentElement.scrollTop) ? angular.element($document[0].documentElement) : options.parent;
        var parentOffset = computeFrom.prop('scrollTop');
        options.backdrop = angular.element('<md-backdrop class="md-dialog-backdrop md-opaque">');
        options.backdrop.css('top', parentOffset +'px');
        $mdTheming.inherit(options.backdrop, options.parent);
        $animate.enter(options.backdrop, options.parent);
        element.css('top', parentOffset +'px');
      }

      var role = 'dialog',
          elementToFocus = closeButton;

      if (options.$type === 'alert') {
        role = 'alertdialog';
        elementToFocus = element.find('md-dialog-content');
      }

      configureAria(element.find('md-dialog'), role, options);

      document.addEventListener('focus', trapFocus, true);

      if (options.disableParentScroll) {
        options.lastOverflow = options.parent.css('overflow');
        options.parent.css('overflow', 'hidden');
      }

      return dialogPopIn(
        element,
        options.parent,
        options.popInTarget && options.popInTarget.length && options.popInTarget
      )
      .then(function() {

        applyAriaToSiblings(element, true);

        if (options.escapeToClose) {
          options.rootElementKeyupCallback = function(e) {
            if (e.keyCode === $mdConstant.KEY_CODE.ESCAPE) {
              $timeout($mdDialog.cancel);
            }
          };
          $rootElement.on('keyup', options.rootElementKeyupCallback);
        }

        if (options.clickOutsideToClose) {
          options.dialogClickOutsideCallback = function(ev) {
            // Only close if we click the flex container outside the backdrop
            if (ev.target === element[0]) {
              $timeout($mdDialog.cancel);
            }
          };
          element.on('click', options.dialogClickOutsideCallback);
        }

        if (options.focusOnOpen) {
          elementToFocus.focus();
        }
      });


      function findCloseButton() {
        //If no element with class dialog-close, try to find the last
        //button child in md-actions and assume it is a close button
        var closeButton = element[0].querySelector('.dialog-close');
        if (!closeButton) {
          var actionButtons = element[0].querySelectorAll('.md-actions button');
          closeButton = actionButtons[ actionButtons.length - 1 ];
        }
        return angular.element(closeButton);
      }

    }

    // On remove function for all dialogs
    function onRemove(scope, element, options) {
      angular.element($document[0].body).removeClass('md-dialog-is-showing');

      if (options.backdrop) {
        $animate.leave(options.backdrop);
      }
      if (options.disableParentScroll) {
        options.parent.css('overflow', options.lastOverflow);
        delete options.lastOverflow;
      }
      if (options.escapeToClose) {
        $rootElement.off('keyup', options.rootElementKeyupCallback);
      }
      if (options.clickOutsideToClose) {
        element.off('click', options.dialogClickOutsideCallback);
      }

      applyAriaToSiblings(element, false);

      document.removeEventListener('focus', trapFocus, true);

      return dialogPopOut(
        element,
        options.parent,
        options.popInTarget && options.popInTarget.length && options.popInTarget
      ).then(function() {
        element.remove();
        options.popInTarget && options.popInTarget.focus();
      });

    }

    /**
     * Inject ARIA-specific attributes appropriate for Dialogs
     */
    function configureAria(element, role, options) {

      element.attr({
        'role': role,
        'tabIndex': '-1'
      });

      var dialogContent = element.find('md-dialog-content');
      if (dialogContent.length === 0){
        dialogContent = element;
      }

      var dialogId = element.attr('id') || ('dialog_' + $mdUtil.nextUid());
      dialogContent.attr('id', dialogId);
      element.attr('aria-describedby', dialogId);

      if (options.ariaLabel) {
        $mdAria.expect(element, 'aria-label', options.ariaLabel);
      }
      else {
        $mdAria.expectAsync(element, 'aria-label', function() {
          var words = dialogContent.text().split(/\s+/);
          if (words.length > 3) words = words.slice(0,3).concat('...');
          return words.join(' ');
        });
      }
    }
    /**
     * Utility function to filter out raw DOM nodes
     */
    function isNodeOneOf(elem, nodeTypeArray) {
      if (nodeTypeArray.indexOf(elem.nodeName) !== -1) {
        return true;
      }
    }
    /**
     * Walk DOM to apply or remove aria-hidden on sibling nodes
     * and parent sibling nodes
     *
     * Prevents screen reader interaction behind modal window
     * on swipe interfaces
     */
    function applyAriaToSiblings(element, value) {
      var attribute = 'aria-hidden';

      // get raw DOM node
      element = element[0];

      function walkDOM(element) {
        while (element.parentNode) {
          if (element === document.body) {
            return;
          }
          var children = element.parentNode.children;
          for (var i = 0; i < children.length; i++) {
            // skip over child if it is an ascendant of the dialog
            // or a script or style tag
            if (element !== children[i] && !isNodeOneOf(children[i], ['SCRIPT', 'STYLE'])) {
              children[i].setAttribute(attribute, value);
            }
          }

          walkDOM(element = element.parentNode);
        }
      }
      walkDOM(element);
    }

    function dialogPopIn(container, parentElement, clickElement) {
      var dialogEl = container.find('md-dialog');

      parentElement.append(container);
      transformToClickElement(dialogEl, clickElement);

      $$rAF(function() {
        dialogEl.addClass('transition-in')
          .css($mdConstant.CSS.TRANSFORM, '');
      });

      return $mdUtil.transitionEndPromise(dialogEl);
    }

    function dialogPopOut(container, parentElement, clickElement) {
      var dialogEl = container.find('md-dialog');

      dialogEl.addClass('transition-out').removeClass('transition-in');
      transformToClickElement(dialogEl, clickElement);

      return $mdUtil.transitionEndPromise(dialogEl);
    }

    function transformToClickElement(dialogEl, clickElement) {
      if (clickElement) {
        var clickRect = clickElement[0].getBoundingClientRect();
        var dialogRect = dialogEl[0].getBoundingClientRect();

        var scaleX = Math.min(0.5, clickRect.width / dialogRect.width);
        var scaleY = Math.min(0.5, clickRect.height / dialogRect.height);

        dialogEl.css($mdConstant.CSS.TRANSFORM, 'translate3d(' +
          (-dialogRect.left + clickRect.left + clickRect.width/2 - dialogRect.width/2) + 'px,' +
          (-dialogRect.top + clickRect.top + clickRect.height/2 - dialogRect.height/2) + 'px,' +
          '0) scale(' + scaleX + ',' + scaleY + ')'
        );
      }
    }

    function dialogTransitionEnd(dialogEl) {
      var deferred = $q.defer();
      dialogEl.on($mdConstant.CSS.TRANSITIONEND, finished);
      function finished(ev) {
        //Make sure this transitionend didn't bubble up from a child
        if (ev.target === dialogEl[0]) {
          dialogEl.off($mdConstant.CSS.TRANSITIONEND, finished);
          deferred.resolve();
        }
      }
      return deferred.promise;
    }

  }
}
MdDialogProvider.$inject = ["$$interimElementProvider"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.divider
 * @description Divider module!
 */
angular.module('material.components.divider', [
  'material.core'
])
  .directive('mdDivider', MdDividerDirective);

/**
 * @ngdoc directive
 * @name mdDivider
 * @module material.components.divider
 * @restrict E
 *
 * @description
 * Dividers group and separate content within lists and page layouts using strong visual and spatial distinctions. This divider is a thin rule, lightweight enough to not distract the user from content.
 *
 * @param {boolean=} md-inset Add this attribute to activate the inset divider style.
 * @usage
 * <hljs lang="html">
 * <md-divider></md-divider>
 *
 * <md-divider md-inset></md-divider>
 * </hljs>
 *
 */
function MdDividerDirective($mdTheming) {
  return {
    restrict: 'E',
    link: $mdTheming
  };
}
MdDividerDirective.$inject = ["$mdTheming"];

})();
(function(){
"use strict";

(function() {
  'use strict';

  angular
    .module('material.components.fabActions', ['material.core'])
    .directive('mdFabActions', MdFabActionsDirective);

  /**
   * @ngdoc directive
   * @name mdFabActions
   * @module material.components.fabSpeedDial
   *
   * @restrict E
   *
   * @description
   * The `<md-fab-actions>` directive is used inside of a `<md-fab-speed-dial>` or
   * `<md-fab-toolbar>` directive to mark the an element (or elements) as the actions and setup the
   * proper event listeners.
   *
   * @usage
   * See the `<md-fab-speed-dial>` or `<md-fab-toolbar>` directives for example usage.
   */
  function MdFabActionsDirective() {
    return {
      restrict: 'E',

      require: ['^?mdFabSpeedDial', '^?mdFabToolbar'],

      link: function(scope, element, attributes, controllers) {
        // Grab whichever parent controller is used
        var controller = controllers[0] || controllers[1];

        // Make the children open/close their parent directive
        if (controller) {
          angular.forEach(element.children(), function(child) {
            angular.element(child).on('focus', controller.open);
            angular.element(child).on('blur', controller.close);
          });
        }

        // After setting up the listeners, wrap every child in a new div and add a class that we can
        // scale/fling independently
        element.children().wrap('<div class="md-fab-action-item">');
      }
    }
  }

})();
})();
(function(){
"use strict";

(function() {
  'use strict';

  angular
    .module('material.components.fabSpeedDial', [
      'material.core',
      'material.components.fabTrigger',
      'material.components.fabActions'
    ])
    .directive('mdFabSpeedDial', MdFabSpeedDialDirective)
    .animation('.md-fling', MdFabSpeedDialFlingAnimation)
    .animation('.md-scale', MdFabSpeedDialScaleAnimation);

  /**
   * @ngdoc directive
   * @name mdFabSpeedDial
   * @module material.components.fabSpeedDial
   *
   * @restrict E
   *
   * @description
   * The `<md-fab-speed-dial>` directive is used to present a series of popup elements (usually
   * `<md-button>`s) for quick access to common actions.
   *
   * There are currently two animations available by applying one of the following classes to
   * the component:
   *
   *  - `md-fling` - The speed dial items appear from underneath the trigger and move into their
   *    appropriate positions.
   *  - `md-scale` - The speed dial items appear in their proper places by scaling from 0% to 100%.
   *
   * @usage
   * <hljs lang="html">
   * <md-fab-speed-dial direction="up" class="md-fling">
   *   <md-fab-trigger>
   *     <md-button aria-label="Add..."><md-icon icon="/img/icons/plus.svg"></md-icon></md-button>
   *   </md-fab-trigger>
   *
   *   <md-fab-actions>
   *     <md-button aria-label="Add User">
   *       <md-icon icon="/img/icons/user.svg"></md-icon>
   *     </md-button>
   *
   *     <md-button aria-label="Add Group">
   *       <md-icon icon="/img/icons/group.svg"></md-icon>
   *     </md-button>
   *   </md-fab-actions>
   * </md-fab-speed-dial>
   * </hljs>
   *
   * @param {string=} md-direction From which direction you would like the speed dial to appear
   * relative to the trigger element.
   * @param {expression=} md-open Programmatically control whether or not the speed-dial is visible.
   */
  function MdFabSpeedDialDirective() {
    FabSpeedDialController.$inject = ["$scope", "$element", "$animate"];
    return {
      restrict: 'E',

      scope: {
        direction: '@?mdDirection',
        isOpen: '=?mdOpen'
      },

      bindToController: true,
      controller: FabSpeedDialController,
      controllerAs: 'vm',

      link: FabSpeedDialLink
    };

    function FabSpeedDialLink(scope, element) {
      // Prepend an element to hold our CSS variables so we can use them in the animations below
      element.prepend('<div class="md-css-variables"></div>');
    }

    function FabSpeedDialController($scope, $element, $animate) {
      var vm = this;

      // Define our open/close functions
      // Note: Used by fabTrigger and fabActions directives
      vm.open = function() {
        $scope.$apply('vm.isOpen = true');
      };

      vm.close = function() {
        $scope.$apply('vm.isOpen = false');
      };

      setupDefaults();
      setupListeners();
      setupWatchers();

      // Set our default variables
      function setupDefaults() {
        // Set the default direction to 'down' if none is specified
        vm.direction = vm.direction || 'down';

        // Set the default to be closed
        vm.isOpen = vm.isOpen || false;
      }

      // Setup our event listeners
      function setupListeners() {
        $element.on('mouseenter', vm.open);
        $element.on('mouseleave', vm.close);
      }

      // Setup our watchers
      function setupWatchers() {
        // Watch for changes to the direction and update classes/attributes
        $scope.$watch('vm.direction', function(newDir, oldDir) {
          // Add the appropriate classes so we can target the direction in the CSS
          $animate.removeClass($element, 'md-' + oldDir);
          $animate.addClass($element, 'md-' + newDir);
        });


        // Watch for changes to md-open
        $scope.$watch('vm.isOpen', function(isOpen) {
          var toAdd = isOpen ? 'md-is-open' : '';
          var toRemove = isOpen ? '' : 'md-is-open';

          $animate.setClass($element, toAdd, toRemove);
        });
      }
    }
  }

  function MdFabSpeedDialFlingAnimation() {
    function runAnimation(element) {
      var el = element[0];
      var ctrl = element.controller('mdFabSpeedDial');
      var items = el.querySelectorAll('.md-fab-action-item');

      // Grab our element which stores CSS variables
      var variablesElement = el.querySelector('.md-css-variables');

      // Setup JS variables based on our CSS variables
      var startZIndex = variablesElement.style.zIndex;

      // Always reset the items to their natural position/state
      angular.forEach(items, function(item, index) {
        var styles = item.style;

        styles.transform = '';
        styles.transitionDelay = '';
        styles.opacity = 1;

        // Make the items closest to the trigger have the highest z-index
        item.style.zIndex = (items.length - index) + startZIndex;
      });

      // If the control is closed, hide the items behind the trigger
      if (!ctrl.isOpen) {
        angular.forEach(items, function(item, index) {
          var newPosition, axis;

          switch (ctrl.direction) {
            case 'up':
              newPosition = item.scrollHeight * (index + 1);
              axis = 'Y';
              break;
            case 'down':
              newPosition = -item.scrollHeight * (index + 1);
              axis = 'Y';
              break;
            case 'left':
              newPosition = item.scrollWidth * (index + 1);
              axis = 'X';
              break;
            case 'right':
              newPosition = -item.scrollWidth * (index + 1);
              axis = 'X';
              break;
          }

          item.style.transform = 'translate' + axis + '(' + newPosition + 'px)';
        });
      }
    }

    return {
      addClass: function(element, className, done) {
        if (element.hasClass('md-fling')) {
          runAnimation(element);
        }
      },
      removeClass: function(element, className, done) {
        runAnimation(element);
      }
    }
  }

  function MdFabSpeedDialScaleAnimation() {
    var delay = 65;

    function runAnimation(element) {
      var el = element[0];
      var ctrl = element.controller('mdFabSpeedDial');
      var items = el.querySelectorAll('.md-fab-action-item');

      // Always reset the items to their natural position/state
      angular.forEach(items, function(item, index) {
        var styles = item.style,
          offsetDelay = index * delay;

        styles.opacity = ctrl.isOpen ? 1 : 0;
        styles.transform = ctrl.isOpen ? 'scale(1)' : 'scale(0)';
        styles.transitionDelay = (ctrl.isOpen ?  offsetDelay : (items.length - offsetDelay)) + 'ms';
      });
    }

    return {
      addClass: function(element, className, done) {
        runAnimation(element);
      },

      removeClass: function(element, className, done) {
        runAnimation(element);
      }
    }
  }
})();

})();
(function(){
"use strict";

(function() {
  'use strict';

  angular
    .module('material.components.fabToolbar', [
      'material.core',
      'material.components.fabTrigger',
      'material.components.fabActions'
    ])
    .directive('mdFabToolbar', MdFabToolbarDirective)
    .animation('.md-fab-toolbar', MdFabToolbarAnimation);

  /**
   * @ngdoc directive
   * @name mdFabToolbar
   * @module material.components.fabToolbar
   *
   * @restrict E
   *
   * @description
   *
   * The `<md-fab-toolbar>` directive is used present a toolbar of elements (usually `<md-button>`s)
   * for quick access to common actions when a floating action button is activated (via hover or
   * keyboard navigation).
   *
   * @usage
   *
   * <hljs lang="html">
   * <md-fab-toolbar>
   *   <md-fab-trigger>
   *     <md-button aria-label="Add..."><md-icon icon="/img/icons/plus.svg"></md-icon></md-button>
   *   </md-fab-trigger>
   *
   *   <md-fab-actions>
   *     <md-button aria-label="Add User">
   *       <md-icon icon="/img/icons/user.svg"></md-icon>
   *     </md-button>
   *
   *     <md-button aria-label="Add Group">
   *       <md-icon icon="/img/icons/group.svg"></md-icon>
   *     </md-button>
   *   </md-fab-actions>
   * </md-fab-toolbar>
   * </hljs>
   *
   * @param {expression=} md-open Programmatically control whether or not the toolbar is visible.
   */
  function MdFabToolbarDirective() {
    FabToolbarController.$inject = ["$scope", "$element", "$animate"];
    return {
      restrict: 'E',
      transclude: true,
      template:
        '<div class="md-fab-toolbar-wrapper">' +
        '  <div class="md-fab-toolbar-content" ng-transclude></div>' +
        '</div>',

      scope: {
        isOpen: '=?mdOpen'
      },

      bindToController: true,
      controller: FabToolbarController,
      controllerAs: 'vm',

      link: link
    };

    function FabToolbarController($scope, $element, $animate) {
      var vm = this;

      // Set the default to be closed
      vm.isOpen = vm.isOpen || false;

      vm.open = function() {
        vm.isOpen = true;
        $scope.$apply();
      };

      vm.close = function() {
        vm.isOpen = false;
        $scope.$apply();
      };

      // Add our class so we can trigger the animation on start
      $element.addClass('md-fab-toolbar');

      // Setup some mouse events so the hover effect can be triggered
      // anywhere over the toolbar
      $element.on('mouseenter', vm.open);
      $element.on('mouseleave', vm.close);

      // Watch for changes to md-open and toggle our class
      $scope.$watch('vm.isOpen', function(isOpen) {
        var toAdd = isOpen ? 'md-is-open' : '';
        var toRemove = isOpen ? '' : 'md-is-open';

        $animate.setClass($element, toAdd, toRemove);
      });
    }

    function link(scope, element, attributes) {
      // Don't allow focus on the trigger
      element.find('md-fab-trigger').find('button').attr('tabindex', '-1');

      // Prepend the background element to the trigger's button
      element.find('md-fab-trigger').find('button')
        .prepend('<div class="md-fab-toolbar-background"></div>');
    }
  }

  function MdFabToolbarAnimation() {
    var originalIconDelay;

    function runAnimation(element, className, done) {
      var el = element[0];
      var ctrl = element.controller('mdFabToolbar');

      // Grab the relevant child elements
      var backgroundElement = el.querySelector('.md-fab-toolbar-background');
      var triggerElement = el.querySelector('md-fab-trigger button');
      var iconElement = el.querySelector('md-fab-trigger button md-icon');
      var actions = element.find('md-fab-actions').children();

      // If we have both elements, use them to position the new background
      if (triggerElement && backgroundElement) {
        // Get our variables
        var color = window.getComputedStyle(triggerElement).getPropertyValue('background-color');
        var width = el.offsetWidth;
        var height = el.offsetHeight;

        // Make a square
        var scale = width * 2;

        // Set some basic styles no matter what animation we're doing
        backgroundElement.style.backgroundColor = color;
        backgroundElement.style.borderRadius = width + 'px';

        // If we're open
        if (ctrl.isOpen) {

          // Set the width/height to take up the full toolbar width
          backgroundElement.style.width = scale + 'px';
          backgroundElement.style.height = scale + 'px';

          // Set the top/left to move up/left (or right) by the scale width/height
          backgroundElement.style.top = -(scale / 2) + 'px';

          if (element.hasClass('md-left')) {
            backgroundElement.style.left = -(scale / 2) + 'px';
            backgroundElement.style.right = null;
          }

          if (element.hasClass('md-right')) {
            backgroundElement.style.right = -(scale / 2) + 'px';
            backgroundElement.style.left = null;
          }

          // Set the next close animation to have the proper delays
          backgroundElement.style.transitionDelay = '0ms';
          iconElement.style.transitionDelay = '.3s';

          // Apply a transition delay to actions
          angular.forEach(actions, function(action, index) {
            action.style.transitionDelay = (actions.length - index) * 25 + 'ms';
          });
        } else {
          // Otherwise, set the width/height to the trigger's width/height
          backgroundElement.style.width = triggerElement.offsetWidth + 'px';
          backgroundElement.style.height = triggerElement.offsetHeight + 'px';

          // Reset the position
          backgroundElement.style.top = '0px';

          if (element.hasClass('md-left')) {
            backgroundElement.style.left = '0px';
            backgroundElement.style.right = null;
          }

          if (element.hasClass('md-right')) {
            backgroundElement.style.right = '0px';
            backgroundElement.style.left = null;
          }

          // Set the next open animation to have the proper delays
          backgroundElement.style.transitionDelay = '200ms';
          iconElement.style.transitionDelay = '0ms';

          // Apply a transition delay to actions
          angular.forEach(actions, function(action, index) {
            action.style.transitionDelay = (index * 25) + 'ms';
          });
        }
      }
    }

    return {
      addClass: function(element, className, done) {
        runAnimation(element, className, done);
      },

      removeClass: function(element, className, done) {
        runAnimation(element, className, done);
      }
    }
  }
})();
})();
(function(){
"use strict";

(function() {
  'use strict';

  angular
    .module('material.components.fabTrigger', [ 'material.core' ])
    .directive('mdFabTrigger', MdFabTriggerDirective);

  /**
   * @ngdoc directive
   * @name mdFabTrigger
   * @module material.components.fabSpeedDial
   *
   * @restrict E
   *
   * @description
   * The `<md-fab-trigger>` directive is used inside of a `<md-fab-speed-dial>` or
   * `<md-fab-toolbar>` directive to mark the an element (or elements) as the trigger and setup the
   * proper event listeners.
   *
   * @usage
   * See the `<md-fab-speed-dial>` or `<md-fab-toolbar>` directives for example usage.
   */
  function MdFabTriggerDirective() {
    return {
      restrict: 'E',

      require: ['^?mdFabSpeedDial', '^?mdFabToolbar'],

      link: function(scope, element, attributes, controllers) {
        // Grab whichever parent controller is used
        var controller = controllers[0] || controllers[1];

        // Make the children open/close their parent directive
        if (controller) {
          angular.forEach(element.children(), function(child) {
            angular.element(child).on('focus', controller.open);
            angular.element(child).on('blur', controller.close);
          });
        }
      }
    }
  }
})();


})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.gridList
 */
angular.module('material.components.gridList', ['material.core'])
       .directive('mdGridList', GridListDirective)
       .directive('mdGridTile', GridTileDirective)
       .directive('mdGridTileFooter', GridTileCaptionDirective)
       .directive('mdGridTileHeader', GridTileCaptionDirective)
       .factory('$mdGridLayout', GridLayoutFactory);

/**
 * @ngdoc directive
 * @name mdGridList
 * @module material.components.gridList
 * @restrict E
 * @description
 * Grid lists are an alternative to standard list views. Grid lists are distinct
 * from grids used for layouts and other visual presentations.
 *
 * A grid list is best suited to presenting a homogenous data type, typically
 * images, and is optimized for visual comprehension and differentiating between
 * like data types.
 *
 * A grid list is a continuous element consisting of tessellated, regular
 * subdivisions called cells that contain tiles (`md-grid-tile`).
 *
 * <img src="//material-design.storage.googleapis.com/publish/v_2/material_ext_publish/0Bx4BSt6jniD7OVlEaXZ5YmU1Xzg/components_grids_usage2.png"
 *    style="width: 300px; height: auto; margin-right: 16px;" alt="Concept of grid explained visually">
 * <img src="//material-design.storage.googleapis.com/publish/v_2/material_ext_publish/0Bx4BSt6jniD7VGhsOE5idWlJWXM/components_grids_usage3.png"
 *    style="width: 300px; height: auto;" alt="Grid concepts legend">
 *
 * Cells are arrayed vertically and horizontally within the grid.
 *
 * Tiles hold content and can span one or more cells vertically or horizontally.
 *
 * ### Responsive Attributes
 *
 * The `md-grid-list` directive supports "responsive" attributes, which allow
 * different `md-cols`, `md-gutter` and `md-row-height` values depending on the
 * currently matching media query (as defined in `$mdConstant.MEDIA`).
 *
 * In order to set a responsive attribute, first define the fallback value with
 * the standard attribute name, then add additional attributes with the
 * following convention: `{base-attribute-name}-{media-query-name}="{value}"`
 * (ie. `md-cols-lg="8"`)
 *
 * @param {number} md-cols Number of columns in the grid.
 * @param {string} md-row-height One of
 * <ul>
 *   <li>CSS length - Fixed height rows (eg. `8px` or `1rem`)</li>
 *   <li>`{width}:{height}` - Ratio of width to height (eg.
 *   `md-row-height="16:9"`)</li>
 *   <li>`"fit"` - Height will be determined by subdividing the available
 *   height by the number of rows</li>
 * </ul>
 * @param {string=} md-gutter The amount of space between tiles in CSS units
 *     (default 1px)
 * @param {expression=} md-on-layout Expression to evaluate after layout. Event
 *     object is available as `$event`, and contains performance information.
 *
 * @usage
 * Basic:
 * <hljs lang="html">
 * <md-grid-list md-cols="5" md-gutter="1em" md-row-height="4:3">
 *   <md-grid-tile></md-grid-tile>
 * </md-grid-list>
 * </hljs>
 *
 * Fixed-height rows:
 * <hljs lang="html">
 * <md-grid-list md-cols="4" md-row-height="200px" ...>
 *   <md-grid-tile></md-grid-tile>
 * </md-grid-list>
 * </hljs>
 *
 * Fit rows:
 * <hljs lang="html">
 * <md-grid-list md-cols="4" md-row-height="fit" style="height: 400px;" ...>
 *   <md-grid-tile></md-grid-tile>
 * </md-grid-list>
 * </hljs>
 *
 * Using responsive attributes:
 * <hljs lang="html">
 * <md-grid-list
 *     md-cols-sm="2"
 *     md-cols-md="4"
 *     md-cols-lg="8"
 *     md-cols-gt-lg="12"
 *     ...>
 *   <md-grid-tile></md-grid-tile>
 * </md-grid-list>
 * </hljs>
 */
function GridListDirective($interpolate, $mdConstant, $mdGridLayout, $mdMedia) {
  return {
    restrict: 'E',
    controller: GridListController,
    scope: {
      mdOnLayout: '&'
    },
    link: postLink
  };

  function postLink(scope, element, attrs, ctrl) {
    // Apply semantics
    element.attr('role', 'list');

    // Provide the controller with a way to trigger layouts.
    ctrl.layoutDelegate = layoutDelegate;

    var invalidateLayout = angular.bind(ctrl, ctrl.invalidateLayout),
        unwatchAttrs = watchMedia();
      scope.$on('$destroy', unwatchMedia);

    /**
     * Watches for changes in media, invalidating layout as necessary.
     */
    function watchMedia() {
      for (var mediaName in $mdConstant.MEDIA) {
        $mdMedia(mediaName); // initialize
        $mdMedia.getQuery($mdConstant.MEDIA[mediaName])
            .addListener(invalidateLayout);
      }
      return $mdMedia.watchResponsiveAttributes(
          ['md-cols', 'md-row-height'], attrs, layoutIfMediaMatch);
    }

    function unwatchMedia() {
      ctrl.layoutDelegate = angular.noop;

      unwatchAttrs();
      for (var mediaName in $mdConstant.MEDIA) {
        $mdMedia.getQuery($mdConstant.MEDIA[mediaName])
            .removeListener(invalidateLayout);
      }
    }

    /**
     * Performs grid layout if the provided mediaName matches the currently
     * active media type.
     */
    function layoutIfMediaMatch(mediaName) {
      if (mediaName == null) {
        // TODO(shyndman): It would be nice to only layout if we have
        // instances of attributes using this media type
        ctrl.invalidateLayout();
      } else if ($mdMedia(mediaName)) {
        ctrl.invalidateLayout();
      }
    }

    var lastLayoutProps;

    /**
     * Invokes the layout engine, and uses its results to lay out our
     * tile elements.
     *
     * @param {boolean} tilesInvalidated Whether tiles have been
     *    added/removed/moved since the last layout. This is to avoid situations
     *    where tiles are replaced with properties identical to their removed
     *    counterparts.
     */
    function layoutDelegate(tilesInvalidated) {
      var tiles = getTileElements();
      var props = {
        tileSpans: getTileSpans(tiles),
        colCount: getColumnCount(),
        rowMode: getRowMode(),
        rowHeight: getRowHeight(),
        gutter: getGutter()
      };

      if (!tilesInvalidated && angular.equals(props, lastLayoutProps)) {
        return;
      }

      var performance =
        $mdGridLayout(props.colCount, props.tileSpans, tiles)
          .map(function(tilePositions, rowCount) {
            return {
              grid: {
                element: element,
                style: getGridStyle(props.colCount, rowCount,
                    props.gutter, props.rowMode, props.rowHeight)
              },
              tiles: tilePositions.map(function(ps, i) {
                return {
                  element: angular.element(tiles[i]),
                  style: getTileStyle(ps.position, ps.spans,
                      props.colCount, props.rowCount,
                      props.gutter, props.rowMode, props.rowHeight)
                }
              })
            }
          })
          .reflow()
          .performance();

      // Report layout
      scope.mdOnLayout({
        $event: {
          performance: performance
        }
      });

      lastLayoutProps = props;
    }

    // Use $interpolate to do some simple string interpolation as a convenience.

    var startSymbol = $interpolate.startSymbol();
    var endSymbol = $interpolate.endSymbol();

    // Returns an expression wrapped in the interpolator's start and end symbols.
    function expr(exprStr) {
      return startSymbol + exprStr + endSymbol;
    }

    // The amount of space a single 1x1 tile would take up (either width or height), used as
    // a basis for other calculations. This consists of taking the base size percent (as would be
    // if evenly dividing the size between cells), and then subtracting the size of one gutter.
    // However, since there are no gutters on the edges, each tile only uses a fration
    // (gutterShare = numGutters / numCells) of the gutter size. (Imagine having one gutter per
    // tile, and then breaking up the extra gutter on the edge evenly among the cells).
    var UNIT = $interpolate(expr('share') + '% - (' + expr('gutter') + ' * ' + expr('gutterShare') + ')');

    // The horizontal or vertical position of a tile, e.g., the 'top' or 'left' property value.
    // The position comes the size of a 1x1 tile plus gutter for each previous tile in the
    // row/column (offset).
    var POSITION  = $interpolate('calc((' + expr('unit') + ' + ' + expr('gutter') + ') * ' + expr('offset') + ')');

    // The actual size of a tile, e.g., width or height, taking rowSpan or colSpan into account.
    // This is computed by multiplying the base unit by the rowSpan/colSpan, and then adding back
    // in the space that the gutter would normally have used (which was already accounted for in
    // the base unit calculation).
    var DIMENSION = $interpolate('calc((' + expr('unit') + ') * ' + expr('span') + ' + (' + expr('span') + ' - 1) * ' + expr('gutter') + ')');

    /**
     * Gets the styles applied to a tile element described by the given parameters.
     * @param {{row: number, col: number}} position The row and column indices of the tile.
     * @param {{row: number, col: number}} spans The rowSpan and colSpan of the tile.
     * @param {number} colCount The number of columns.
     * @param {number} rowCount The number of rows.
     * @param {string} gutter The amount of space between tiles. This will be something like
     *     '5px' or '2em'.
     * @param {string} rowMode The row height mode. Can be one of:
     *     'fixed': all rows have a fixed size, given by rowHeight,
     *     'ratio': row height defined as a ratio to width, or
     *     'fit': fit to the grid-list element height, divinding evenly among rows.
     * @param {string|number} rowHeight The height of a row. This is only used for 'fixed' mode and
     *     for 'ratio' mode. For 'ratio' mode, this is the *ratio* of width-to-height (e.g., 0.75).
     * @returns {Object} Map of CSS properties to be applied to the style element. Will define
     *     values for top, left, width, height, marginTop, and paddingTop.
     */
    function getTileStyle(position, spans, colCount, rowCount, gutter, rowMode, rowHeight) {
      // TODO(shyndman): There are style caching opportunities here.

      // Percent of the available horizontal space that one column takes up.
      var hShare = (1 / colCount) * 100;

      // Fraction of the gutter size that each column takes up.
      var hGutterShare = (colCount - 1) / colCount;

      // Base horizontal size of a column.
      var hUnit = UNIT({share: hShare, gutterShare: hGutterShare, gutter: gutter});

      // The width and horizontal position of each tile is always calculated the same way, but the
      // height and vertical position depends on the rowMode.
      var style = {
        left: POSITION({ unit: hUnit, offset: position.col, gutter: gutter }),
        width: DIMENSION({ unit: hUnit, span: spans.col, gutter: gutter }),
        // resets
        paddingTop: '',
        marginTop: '',
        top: '',
        height: ''
      };

      switch (rowMode) {
        case 'fixed':
          // In fixed mode, simply use the given rowHeight.
          style.top = POSITION({ unit: rowHeight, offset: position.row, gutter: gutter });
          style.height = DIMENSION({ unit: rowHeight, span: spans.row, gutter: gutter });
          break;

        case 'ratio':
          // Percent of the available vertical space that one row takes up. Here, rowHeight holds
          // the ratio value. For example, if the width:height ratio is 4:3, rowHeight = 1.333.
          var vShare = hShare / rowHeight;

          // Base veritcal size of a row.
          var vUnit = UNIT({ share: vShare, gutterShare: hGutterShare, gutter: gutter });

          // padidngTop and marginTop are used to maintain the given aspect ratio, as
          // a percentage-based value for these properties is applied to the *width* of the
          // containing block. See http://www.w3.org/TR/CSS2/box.html#margin-properties
          style.paddingTop = DIMENSION({ unit: vUnit, span: spans.row, gutter: gutter});
          style.marginTop = POSITION({ unit: vUnit, offset: position.row, gutter: gutter });
          break;

        case 'fit':
          // Fraction of the gutter size that each column takes up.
          var vGutterShare = (rowCount - 1) / rowCount;

          // Percent of the available vertical space that one row takes up.
          var vShare = (1 / rowCount) * 100;

          // Base vertical size of a row.
          var vUnit = UNIT({share: vShare, gutterShare: vGutterShare, gutter: gutter});

          style.top = POSITION({unit: vUnit, offset: position.row, gutter: gutter});
          style.height = DIMENSION({unit: vUnit, span: spans.row, gutter: gutter});
          break;
      }

      return style;
    }

    function getGridStyle(colCount, rowCount, gutter, rowMode, rowHeight) {
      var style = {
        height: '',
        paddingBottom: ''
      };

      switch(rowMode) {
        case 'fixed':
          style.height = DIMENSION({ unit: rowHeight, span: rowCount, gutter: gutter });
          break;

        case 'ratio':
          // rowHeight is width / height
          var hGutterShare = colCount === 1 ? 0 : (colCount - 1) / colCount,
              hShare = (1 / colCount) * 100,
              vShare = hShare * (1 / rowHeight),
              vUnit = UNIT({ share: vShare, gutterShare: hGutterShare, gutter: gutter });

          style.paddingBottom = DIMENSION({ unit: vUnit, span: rowCount, gutter: gutter});
          break;

        case 'fit':
          // noop, as the height is user set
          break;
      }

      return style;
    }

    function getTileElements() {
      return [].filter.call(element.children(), function(ele) {
        return ele.tagName == 'MD-GRID-TILE';
      });
    }

    /**
     * Gets an array of objects containing the rowspan and colspan for each tile.
     * @returns {Array<{row: number, col: number}>}
     */
    function getTileSpans(tileElements) {
      return [].map.call(tileElements, function(ele) {
        var ctrl = angular.element(ele).controller('mdGridTile');
        return {
          row: parseInt(
              $mdMedia.getResponsiveAttribute(ctrl.$attrs, 'md-rowspan'), 10) || 1,
          col: parseInt(
              $mdMedia.getResponsiveAttribute(ctrl.$attrs, 'md-colspan'), 10) || 1
        };
      });
    }

    function getColumnCount() {
      var colCount = parseInt($mdMedia.getResponsiveAttribute(attrs, 'md-cols'), 10);
      if (isNaN(colCount)) {
        throw 'md-grid-list: md-cols attribute was not found, or contained a non-numeric value';
      }
      return colCount;
    }

    function getGutter() {
      return applyDefaultUnit($mdMedia.getResponsiveAttribute(attrs, 'md-gutter') || 1);
    }

    function getRowHeight() {
      var rowHeight = $mdMedia.getResponsiveAttribute(attrs, 'md-row-height');
      switch (getRowMode()) {
        case 'fixed':
          return applyDefaultUnit(rowHeight);
        case 'ratio':
          var whRatio = rowHeight.split(':');
          return parseFloat(whRatio[0]) / parseFloat(whRatio[1]);
        case 'fit':
          return 0; // N/A
      }
    }

    function getRowMode() {
      var rowHeight = $mdMedia.getResponsiveAttribute(attrs, 'md-row-height');
      if (rowHeight == 'fit') {
        return 'fit';
      } else if (rowHeight.indexOf(':') !== -1) {
        return 'ratio';
      } else {
        return 'fixed';
      }
    }

    function applyDefaultUnit(val) {
      return /\D$/.test(val) ? val : val + 'px';
    }
  }
}
GridListDirective.$inject = ["$interpolate", "$mdConstant", "$mdGridLayout", "$mdMedia"];

/* @ngInject */
function GridListController($timeout) {
  this.layoutInvalidated = false;
  this.tilesInvalidated = false;
  this.$timeout_ = $timeout;
  this.layoutDelegate = angular.noop;
}
GridListController.$inject = ["$timeout"];

GridListController.prototype = {
  invalidateTiles: function() {
    this.tilesInvalidated = true;
    this.invalidateLayout();
  },

  invalidateLayout: function() {
    if (this.layoutInvalidated) {
      return;
    }
    this.layoutInvalidated = true;
    this.$timeout_(angular.bind(this, this.layout));
  },

  layout: function() {
    try {
      this.layoutDelegate(this.tilesInvalidated);
    } finally {
      this.layoutInvalidated = false;
      this.tilesInvalidated = false;
    }
  }
};


/* @ngInject */
function GridLayoutFactory($mdUtil) {
  var defaultAnimator = GridTileAnimator;

  /**
   * Set the reflow animator callback
   */
  GridLayout.animateWith = function(customAnimator) {
    defaultAnimator = !angular.isFunction(customAnimator) ? GridTileAnimator : customAnimator;
  };

  return GridLayout;

  /**
   * Publish layout function
   */
  function GridLayout(colCount, tileSpans) {
      var self, layoutInfo, gridStyles, layoutTime, mapTime, reflowTime;

      layoutTime = $mdUtil.time(function() {
        layoutInfo = calculateGridFor(colCount, tileSpans);
      });

      return self = {

        /**
         * An array of objects describing each tile's position in the grid.
         */
        layoutInfo: function() {
          return layoutInfo;
        },

        /**
         * Maps grid positioning to an element and a set of styles using the
         * provided updateFn.
         */
        map: function(updateFn) {
          mapTime = $mdUtil.time(function() {
            var info = self.layoutInfo();
            gridStyles = updateFn(info.positioning, info.rowCount);
          });
          return self;
        },

        /**
         * Default animator simply sets the element.css( <styles> ). An alternate
         * animator can be provided as an argument. The function has the following
         * signature:
         *
         *    function({grid: {element: JQLite, style: Object}, tiles: Array<{element: JQLite, style: Object}>)
         */
        reflow: function(animatorFn) {
          reflowTime = $mdUtil.time(function() {
            var animator = animatorFn || defaultAnimator;
            animator(gridStyles.grid, gridStyles.tiles);
          });
          return self;
        },

        /**
         * Timing for the most recent layout run.
         */
        performance: function() {
          return {
            tileCount: tileSpans.length,
            layoutTime: layoutTime,
            mapTime: mapTime,
            reflowTime: reflowTime,
            totalTime: layoutTime + mapTime + reflowTime
          };
        }
      };
    }

  /**
   * Default Gridlist animator simple sets the css for each element;
   * NOTE: any transitions effects must be manually set in the CSS.
   * e.g.
   *
   *  md-grid-tile {
   *    transition: all 700ms ease-out 50ms;
   *  }
   *
   */
  function GridTileAnimator(grid, tiles) {
    grid.element.css(grid.style);
    tiles.forEach(function(t) {
      t.element.css(t.style);
    })
  }

  /**
   * Calculates the positions of tiles.
   *
   * The algorithm works as follows:
   *    An Array<Number> with length colCount (spaceTracker) keeps track of
   *    available tiling positions, where elements of value 0 represents an
   *    empty position. Space for a tile is reserved by finding a sequence of
   *    0s with length <= than the tile's colspan. When such a space has been
   *    found, the occupied tile positions are incremented by the tile's
   *    rowspan value, as these positions have become unavailable for that
   *    many rows.
   *
   *    If the end of a row has been reached without finding space for the
   *    tile, spaceTracker's elements are each decremented by 1 to a minimum
   *    of 0. Rows are searched in this fashion until space is found.
   */
  function calculateGridFor(colCount, tileSpans) {
    var curCol = 0,
        curRow = 0,
        spaceTracker = newSpaceTracker();

    return {
      positioning: tileSpans.map(function(spans, i) {
        return {
          spans: spans,
          position: reserveSpace(spans, i)
        };
      }),
      rowCount: curRow + Math.max.apply(Math, spaceTracker)
    };

    function reserveSpace(spans, i) {
      if (spans.col > colCount) {
        throw 'md-grid-list: Tile at position ' + i + ' has a colspan ' +
            '(' + spans.col + ') that exceeds the column count ' +
            '(' + colCount + ')';
      }

      var start = 0,
          end = 0;

      // TODO(shyndman): This loop isn't strictly necessary if you can
      // determine the minimum number of rows before a space opens up. To do
      // this, recognize that you've iterated across an entire row looking for
      // space, and if so fast-forward by the minimum rowSpan count. Repeat
      // until the required space opens up.
      while (end - start < spans.col) {
        if (curCol >= colCount) {
          nextRow();
          continue;
        }

        start = spaceTracker.indexOf(0, curCol);
        if (start === -1 || (end = findEnd(start + 1)) === -1) {
          start = end = 0;
          nextRow();
          continue;
        }

        curCol = end + 1;
      }

      adjustRow(start, spans.col, spans.row);
      curCol = start + spans.col;

      return {
        col: start,
        row: curRow
      };
    }

    function nextRow() {
      curCol = 0;
      curRow++;
      adjustRow(0, colCount, -1); // Decrement row spans by one
    }

    function adjustRow(from, cols, by) {
      for (var i = from; i < from + cols; i++) {
        spaceTracker[i] = Math.max(spaceTracker[i] + by, 0);
      }
    }

    function findEnd(start) {
      var i;
      for (i = start; i < spaceTracker.length; i++) {
        if (spaceTracker[i] !== 0) {
          return i;
        }
      }

      if (i === spaceTracker.length) {
        return i;
      }
    }

    function newSpaceTracker() {
      var tracker = [];
      for (var i = 0; i < colCount; i++) {
        tracker.push(0);
      }
      return tracker;
    }
  }
}
GridLayoutFactory.$inject = ["$mdUtil"];

/**
 * @ngdoc directive
 * @name mdGridTile
 * @module material.components.gridList
 * @restrict E
 * @description
 * Tiles contain the content of an `md-grid-list`. They span one or more grid
 * cells vertically or horizontally, and use `md-grid-tile-{footer,header}` to
 * display secondary content.
 *
 * ### Responsive Attributes
 *
 * The `md-grid-tile` directive supports "responsive" attributes, which allow
 * different `md-rowspan` and `md-colspan` values depending on the currently
 * matching media query (as defined in `$mdConstant.MEDIA`).
 *
 * In order to set a responsive attribute, first define the fallback value with
 * the standard attribute name, then add additional attributes with the
 * following convention: `{base-attribute-name}-{media-query-name}="{value}"`
 * (ie. `md-colspan-sm="4"`)
 *
 * @param {number=} md-colspan The number of columns to span (default 1). Cannot
 *    exceed the number of columns in the grid. Supports interpolation.
 * @param {number=} md-rowspan The number of rows to span (default 1). Supports
 *     interpolation.
 *
 * @usage
 * With header:
 * <hljs lang="html">
 * <md-grid-tile>
 *   <md-grid-tile-header>
 *     <h3>This is a header</h3>
 *   </md-grid-tile-header>
 * </md-grid-tile>
 * </hljs>
 *
 * With footer:
 * <hljs lang="html">
 * <md-grid-tile>
 *   <md-grid-tile-footer>
 *     <h3>This is a footer</h3>
 *   </md-grid-tile-footer>
 * </md-grid-tile>
 * </hljs>
 *
 * Spanning multiple rows/columns:
 * <hljs lang="html">
 * <md-grid-tile md-colspan="2" md-rowspan="3">
 * </md-grid-tile>
 * </hljs>
 *
 * Responsive attributes:
 * <hljs lang="html">
 * <md-grid-tile md-colspan="1" md-colspan-sm="3" md-colspan-md="5">
 * </md-grid-tile>
 * </hljs>
 */
function GridTileDirective($mdMedia) {
  return {
    restrict: 'E',
    require: '^mdGridList',
    template: '<figure ng-transclude></figure>',
    transclude: true,
    scope: {},
    // Simple controller that exposes attributes to the grid directive
    controller: ["$attrs", function($attrs) {
      this.$attrs = $attrs;
    }],
    link: postLink
  };

  function postLink(scope, element, attrs, gridCtrl) {
    // Apply semantics
    element.attr('role', 'listitem');

    // If our colspan or rowspan changes, trigger a layout
    var unwatchAttrs = $mdMedia.watchResponsiveAttributes(['md-colspan', 'md-rowspan'],
        attrs, angular.bind(gridCtrl, gridCtrl.invalidateLayout));

    // Tile registration/deregistration
    gridCtrl.invalidateTiles();
    scope.$on('$destroy', function() {
      unwatchAttrs();
      gridCtrl.invalidateLayout();
    });

    if (angular.isDefined(scope.$parent.$index)) {
      scope.$watch(function() { return scope.$parent.$index; },
        function indexChanged(newIdx, oldIdx) {
          if (newIdx === oldIdx) {
            return;
          }
          gridCtrl.invalidateTiles();
        });
    }
  }
}
GridTileDirective.$inject = ["$mdMedia"];


function GridTileCaptionDirective() {
  return {
    template: '<figcaption ng-transclude></figcaption>',
    transclude: true
  };
}

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.icon
 * @description
 * Icon
 */
angular.module('material.components.icon', [
    'material.core'
  ])
  .directive('mdIcon', mdIconDirective);

/**
 * @ngdoc directive
 * @name mdIcon
 * @module material.components.icon
 *
 * @restrict E
 *
 * @description
 * The `<md-icon>` directive is an markup element useful for showing an icon based on a font-icon
 * or a SVG. Icons are view-only elements that should not be used directly as buttons; instead nest a `<md-icon>`
 * inside a `md-button` to add hover and click features.
 *
 * When using SVGs, both external SVGs (via URLs) or sets of SVGs [from icon sets] can be
 * easily loaded and used.When use font-icons, developers must following three (3) simple steps:
 *
 * <ol>
 * <li>Load the font library. e.g.<br/>
 *    &lt;link href="https://fonts.googleapis.com/icon?family=Material+Icons"
 *    rel="stylesheet"&gt;
 * </li>
 * <li> Use either (a) font-icon class names or (b) font ligatures to render the font glyph by using its textual name</li>
 * <li> Use &lt;md-icon md-font-icon="classname" /&gt; or <br/>
 *     use &lt;md-icon md-font-set="font library classname or alias"&gt; textual_name &lt;/md-icon&gt; or <br/>
 *     use &lt;md-icon md-font-set="font library classname or alias"&gt; numerical_character_reference &lt;/md-icon&gt;
 * </li>
 * </ol>
 *
 * Full details for these steps can be found:
 *
 * <ul>
 * <li>http://google.github.io/material-design-icons/</li>
 * <li>http://google.github.io/material-design-icons/#icon-font-for-the-web</li>
 * </ul>
 *
 * The Material Design icon style <code>.material-icons</code> and the icon font references are published in
 * Material Design Icons:
 *
 * <ul>
 * <li>http://www.google.com/design/icons/</li>
 * <li>https://www.google.com/design/icons/#ic_accessibility</li>
 * </ul>
 *
 * <h2 id="material_design_icons">Material Design Icons</h2>
 * Using the Material Design Icon-Selector, developers can easily and quickly search for a Material Design font-icon and
 * determine its textual name and character reference code. Click on any icon to see the slide-up information
 * panel with details regarding a SVG download or information on the font-icon usage.
 *
 * <a href="https://www.google.com/design/icons/#ic_accessibility" target="_blank" style="border-bottom:none;">
 * <img src="https://cloud.githubusercontent.com/assets/210413/7902490/fe8dd14c-0780-11e5-98fb-c821cc6475e6.png"
 *      aria-label="Material Design Icon-Selector" style="max-width:75%;padding-left:10%">
 * </a>
 *
 * <span class="image_caption">
 *  Click on the image above to link to the
 *  <a href="https://www.google.com/design/icons/#ic_accessibility" target="_blank">Material Design Icon-Selector</a>.
 * </span>
 *
 * @param {string} md-font-icon Name of CSS icon associated with the font-face will be used
 * to render the icon. Requires the fonts and the named CSS styles to be preloaded.
 * @param {string} md-font-set CSS style name associated with the font library; which will be assigned as
 * the class for the font-icon ligature. This value may also be an alias that is used to lookup the classname;
 * internally use `$mdIconProvider.fontSet(<alias>)` to determine the style name.
 * @param {string} md-svg-src URL [or expression ] used to load, cache, and display an external SVG.
 * @param {string} md-svg-icon Name used for lookup of the icon from the internal cache; interpolated strings or
 * expressions may also be used. Specific set names can be used with the syntax `<set name>:<icon name>`.<br/><br/>
 * To use icon sets, developers are required to pre-register the sets using the `$mdIconProvider` service.
 * @param {string=} aria-label Labels icon for accessibility. If an empty string is provided, icon
 * will be hidden from accessibility layer with `aria-hidden="true"`. If there's no aria-label on the icon
 * nor a label on the parent element, a warning will be logged to the console.
 *
 * @usage
 * When using SVGs:
 * <hljs lang="html">
 *
 *  <!-- Icon ID; may contain optional icon set prefix; icons must registered using $mdIconProvider -->
 *  <md-icon md-svg-icon="social:android"    aria-label="android " ></md-icon>
 *
 *  <!-- Icon urls; may be preloaded in templateCache -->
 *  <md-icon md-svg-src="/android.svg"       aria-label="android " ></md-icon>
 *  <md-icon md-svg-src="{{ getAndroid() }}" aria-label="android " ></md-icon>
 *
 * </hljs>
 *
 * Use the <code>$mdIconProvider</code> to configure your application with
 * svg iconsets.
 *
 * <hljs lang="js">
 *  angular.module('appSvgIconSets', ['ngMaterial'])
 *    .controller('DemoCtrl', function($scope) {})
 *    .config(function($mdIconProvider) {
 *      $mdIconProvider
 *         .iconSet('social', 'img/icons/sets/social-icons.svg', 24)
 *         .defaultIconSet('img/icons/sets/core-icons.svg', 24);
 *     });
 * </hljs>
 *
 *
 * When using Font Icons with classnames:
 * <hljs lang="html">
 *
 *  <md-icon md-font-icon="android" aria-label="android" ></md-icon>
 *  <md-icon class="icon_home"      aria-label="Home"    ></md-icon>
 *
 * </hljs>
 *
 * When using Material Font Icons with ligatures:
 * <hljs lang="html">
 *  <!-- For Material Design Icons -->
 *  <!-- The class '.material-icons' is auto-added if a style has NOT been specified -->
 *  <md-icon> face </md-icon>
 *  <md-icon md-font-set="material-icons"> face </md-icon>
 *  <md-icon> #xE87C; </md-icon>
 *  <!-- The class '.material-icons' must be manually added if other styles are also specified-->
 *  <md-icon class="material-icons md-light md-48"> face </md-icon>
 * </hljs>
 *
 * When using other Font-Icon libraries:
 *
 * <hljs lang="js">
 *  // Specify a font-icon style alias
 *  angular.config(function($mdIconProvider) {
 *    $mdIconProvider.fontSet('fa', 'fontawesome');
 *  });
 * </hljs>
 *
 * <hljs lang="html">
 *  <md-icon md-font-set="fa">email</md-icon>
 * </hljs>
 *
 */
function mdIconDirective($mdIcon, $mdTheming, $mdAria, $interpolate ) {

  return {
    scope: {
      fontSet : '@mdFontSet',
      fontIcon: '@mdFontIcon',
      svgIcon : '@mdSvgIcon',
      svgSrc  : '@mdSvgSrc'
    },
    restrict: 'E',
    link : postLink
  };


  /**
   * Directive postLink
   * Supports embedded SVGs, font-icons, & external SVGs
   */
  function postLink(scope, element, attr) {
    $mdTheming(element);

    prepareForFontIcon();

    // If using a font-icon, then the textual name of the icon itself
    // provides the aria-label.

    var label = attr.alt || scope.fontIcon || scope.svgIcon || element.text();
    var attrName = attr.$normalize(attr.$attr.mdSvgIcon || attr.$attr.mdSvgSrc || '');

    if ( !attr['aria-label'] ) {

      if (label != '' && !parentsHaveText() ) {

        $mdAria.expect(element, 'aria-label', label);
        $mdAria.expect(element, 'role', 'img');

      } else if ( !element.text() ) {
        // If not a font-icon with ligature, then
        // hide from the accessibility layer.

        $mdAria.expect(element, 'aria-hidden', 'true');
      }
    }

    if (attrName) {
      // Use either pre-configured SVG or URL source, respectively.
      attr.$observe(attrName, function(attrVal) {

        element.empty();
        if (attrVal) {
          $mdIcon(attrVal).then(function(svg) {
            element.append(svg);
          });
        }

      });
    }

    function parentsHaveText() {
      var parent = element.parent();
      if (parent.attr('aria-label') || parent.text()) {
        return true;
      }
      else if(parent.parent().attr('aria-label') || parent.parent().text()) {
        return true;
      }
      return false;
    }

    function prepareForFontIcon () {
      if (!scope.svgIcon && !scope.svgSrc) {

        if (scope.fontIcon) {
          element.addClass('md-font');
          element.addClass(scope.fontIcon);
        }

        if (scope.fontSet) {
          element.addClass($mdIcon.fontSet(scope.fontSet));
        }

        // For Material Design font icons, the class '.material-icons'
        // is auto-added IF a style has not been specified

        if (!scope.fontIcon && !scope.fontSet && !angular.isDefined(attr.class)) {

            element.addClass('material-icons');
        }
      }

    }
  }
}
mdIconDirective.$inject = ["$mdIcon", "$mdTheming", "$mdAria", "$interpolate"];

})();
(function(){
"use strict";

  angular
    .module('material.components.icon' )
    .provider('$mdIcon', MdIconProvider);

  /**
    * @ngdoc service
    * @name $mdIconProvider
    * @module material.components.icon
    *
    * @description
    * `$mdIconProvider` is used only to register icon IDs with URLs. These configuration features allow
    * icons and icon sets to be pre-registered and associated with source URLs **before** the `<md-icon />`
    * directives are compiled.
    *
    * If using font-icons, the developer is repsonsible for loading the fonts.
    *
    * If using SVGs, loading of the actual svg files are deferred to on-demand requests and are loaded
    * internally by the `$mdIcon` service using the `$http` service. When an SVG is requested by name/ID,
    * the `$mdIcon` service searches its registry for the associated source URL;
    * that URL is used to on-demand load and parse the SVG dynamically.
    *
    * @usage
    * <hljs lang="js">
    *   app.config(function($mdIconProvider) {
    *
    *     // Configure URLs for icons specified by [set:]id.
    *
    *     $mdIconProvider
    *          .defaultFontSet( 'fontawesome' )
    *          .defaultIconSet('my/app/icons.svg')       // Register a default set of SVG icons
    *          .iconSet('social', 'my/app/social.svg')   // Register a named icon set of SVGs
    *          .icon('android', 'my/app/android.svg')    // Register a specific icon (by name)
    *          .icon('work:chair', 'my/app/chair.svg');  // Register icon in a specific set
    *   });
    * </hljs>
    *
    * SVG icons and icon sets can be easily pre-loaded and cached using either (a) a build process or (b) a runtime
    * **startup** process (shown below):
    *
    * <hljs lang="js">
    *   app.config(function($mdIconProvider) {
    *
    *     // Register a default set of SVG icon definitions
    *     $mdIconProvider.defaultIconSet('my/app/icons.svg')
    *
    *   })
    *   .run(function($http, $templateCache){
    *
    *     // Pre-fetch icons sources by URL and cache in the $templateCache...
    *     // subsequent $http calls will look there first.
    *
    *     var urls = [ 'imy/app/icons.svg', 'img/icons/android.svg'];
    *
    *     angular.forEach(urls, function(url) {
    *       $http.get(url, {cache: $templateCache});
    *     });
    *
    *   });
    *
    * </hljs>
    *
    * NOTE: the loaded SVG data is subsequently cached internally for future requests.
    *
    */

   /**
    * @ngdoc method
    * @name $mdIconProvider#icon
    *
    * @description
    * Register a source URL for a specific icon name; the name may include optional 'icon set' name prefix.
    * These icons  will later be retrieved from the cache using `$mdIcon( <icon name> )`
    *
    * @param {string} id Icon name/id used to register the icon
    * @param {string} url specifies the external location for the data file. Used internally by `$http` to load the
    * data or as part of the lookup in `$templateCache` if pre-loading was configured.
    * @param {number=} viewBoxSize Sets the width and height the icon's viewBox.
    * It is ignored for icons with an existing viewBox. Default size is 24.
    *
    * @returns {obj} an `$mdIconProvider` reference; used to support method call chains for the API
    *
    * @usage
    * <hljs lang="js">
    *   app.config(function($mdIconProvider) {
    *
    *     // Configure URLs for icons specified by [set:]id.
    *
    *     $mdIconProvider
    *          .icon('android', 'my/app/android.svg')    // Register a specific icon (by name)
    *          .icon('work:chair', 'my/app/chair.svg');  // Register icon in a specific set
    *   });
    * </hljs>
    *
    */
   /**
    * @ngdoc method
    * @name $mdIconProvider#iconSet
    *
    * @description
    * Register a source URL for a 'named' set of icons; group of SVG definitions where each definition
    * has an icon id. Individual icons can be subsequently retrieved from this cached set using
    * `$mdIcon(<icon set name>:<icon name>)`
    *
    * @param {string} id Icon name/id used to register the iconset
    * @param {string} url specifies the external location for the data file. Used internally by `$http` to load the
    * data or as part of the lookup in `$templateCache` if pre-loading was configured.
    * @param {number=} viewBoxSize Sets the width and height of the viewBox of all icons in the set. 
    * It is ignored for icons with an existing viewBox. All icons in the icon set should be the same size.
    * Default value is 24.
    *
    * @returns {obj} an `$mdIconProvider` reference; used to support method call chains for the API
    *
    *
    * @usage
    * <hljs lang="js">
    *   app.config(function($mdIconProvider) {
    *
    *     // Configure URLs for icons specified by [set:]id.
    *
    *     $mdIconProvider
    *          .iconSet('social', 'my/app/social.svg')   // Register a named icon set
    *   });
    * </hljs>
    *
    */
   /**
    * @ngdoc method
    * @name $mdIconProvider#defaultIconSet
    *
    * @description
    * Register a source URL for the default 'named' set of icons. Unless explicitly registered,
    * subsequent lookups of icons will failover to search this 'default' icon set.
    * Icon can be retrieved from this cached, default set using `$mdIcon(<name>)`
    *
    * @param {string} url specifies the external location for the data file. Used internally by `$http` to load the
    * data or as part of the lookup in `$templateCache` if pre-loading was configured.
    * @param {number=} viewBoxSize Sets the width and height of the viewBox of all icons in the set. 
    * It is ignored for icons with an existing viewBox. All icons in the icon set should be the same size.
    * Default value is 24.
    *
    * @returns {obj} an `$mdIconProvider` reference; used to support method call chains for the API
    *
    * @usage
    * <hljs lang="js">
    *   app.config(function($mdIconProvider) {
    *
    *     // Configure URLs for icons specified by [set:]id.
    *
    *     $mdIconProvider
    *          .defaultIconSet( 'my/app/social.svg' )   // Register a default icon set
    *   });
    * </hljs>
    *
    */
  /**
   * @ngdoc method
   * @name $mdIconProvider#defaultFontSet
   *
   * @description
   * When using Font-Icons, Angular Material assumes the the Material Design icons will be used and automatically
   * configures the default font-set == 'material-icons'. Note that the font-set references the font-icon library
   * class style that should be applied to the `<md-icon>`.
   *
   * Configuring the default means that the attributes
   * `md-font-set="material-icons"` or `class="material-icons"` do not need to be explicitly declared on the
   * `<md-icon>` markup. For example:
   *
   *  `<md-icon> face </md-icon>`
   *  will render as
   *  `<span class="material-icons"> face </span>`, and
   *
   *  `<md-icon md-font-set="fa"> face </md-icon>`
   *  will render as
   *  `<span class="fa"> face </span>`
   *
   * @param {string} name of the font-library style that should be applied to the md-icon DOM element
   *
   * @usage
   * <hljs lang="js">
   *   app.config(function($mdIconProvider) {
   *     $mdIconProvider.defaultFontSet( 'fontawesome' );
   *   });
   * </hljs>
   *
   */

   /**
    * @ngdoc method
    * @name $mdIconProvider#defaultViewBoxSize
    *
    * @description
    * While `<md-icon />` markup can also be style with sizing CSS, this method configures
    * the default width **and** height used for all icons; unless overridden by specific CSS.
    * The default sizing is (24px, 24px).
    * @param {number=} viewBoxSize Sets the width and height of the viewBox for an icon or an icon set.
    * All icons in a set should be the same size. The default value is 24.
    *
    * @returns {obj} an `$mdIconProvider` reference; used to support method call chains for the API
    *
    * @usage
    * <hljs lang="js">
    *   app.config(function($mdIconProvider) {
    *
    *     // Configure URLs for icons specified by [set:]id.
    *
    *     $mdIconProvider
    *          .defaultViewBoxSize(36)   // Register a default icon size (width == height)
    *   });
    * </hljs>
    *
    */

 var config = {
   defaultViewBoxSize: 24,
   defaultFontSet: 'material-icons',
   fontSets : [ ]
 };

 function MdIconProvider() { }

 MdIconProvider.prototype = {
   icon : function (id, url, viewBoxSize) {
     if ( id.indexOf(':') == -1 ) id = '$default:' + id;

     config[id] = new ConfigurationItem(url, viewBoxSize );
     return this;
   },

   iconSet : function (id, url, viewBoxSize) {
     config[id] = new ConfigurationItem(url, viewBoxSize );
     return this;
   },

   defaultIconSet : function (url, viewBoxSize) {
     var setName = '$default';

     if ( !config[setName] ) {
       config[setName] = new ConfigurationItem(url, viewBoxSize );
     }

     config[setName].viewBoxSize = viewBoxSize || config.defaultViewBoxSize;

     return this;
   },

   defaultViewBoxSize : function (viewBoxSize) {
     config.defaultViewBoxSize = viewBoxSize;
     return this;
   },
   
   /**
    * Register an alias name associated with a font-icon library style ;
    */
   fontSet : function fontSet(alias, className) {
    config.fontSets.push({
      alias : alias,
      fontSet : className || alias
    });
   },

   /**
    * Specify a default style name associated with a font-icon library
    * fallback to Material Icons.
    *
    */
   defaultFontSet : function defaultFontSet(className) {
    config.defaultFontSet = !className ? '' : className;
    return this;
   },

   defaultIconSize : function defaultIconSize(iconSize) {
     config.defaultIconSize = iconSize;
     return this;
   },

   preloadIcons: function ($templateCache) {
     var iconProvider = this;
     var svgRegistry = [
       {
         id : 'md-tabs-arrow',
         url: 'md-tabs-arrow.svg',
         svg: '<svg version="1.1" x="0px" y="0px" viewBox="0 0 24 24"><g><polygon points="15.4,7.4 14,6 8,12 14,18 15.4,16.6 10.8,12 "/></g></svg>'
       },
       {
         id : 'md-close',
         url: 'md-close.svg',
         svg: '<svg version="1.1" x="0px" y="0px" viewBox="0 0 24 24"><g><path d="M19 6.41l-1.41-1.41-5.59 5.59-5.59-5.59-1.41 1.41 5.59 5.59-5.59 5.59 1.41 1.41 5.59-5.59 5.59 5.59 1.41-1.41-5.59-5.59z"/></g></svg>'
       },
       {
         id:  'md-cancel',
         url: 'md-cancel.svg',
         svg: '<svg version="1.1" x="0px" y="0px" viewBox="0 0 24 24"><g><path d="M12 2c-5.53 0-10 4.47-10 10s4.47 10 10 10 10-4.47 10-10-4.47-10-10-10zm5 13.59l-1.41 1.41-3.59-3.59-3.59 3.59-1.41-1.41 3.59-3.59-3.59-3.59 1.41-1.41 3.59 3.59 3.59-3.59 1.41 1.41-3.59 3.59 3.59 3.59z"/></g></svg>'
       },
       {
         id:  'md-menu',
         url: 'md-menu.svg',
         svg: '<svg version="1.1" x="0px" y="0px" viewBox="0 0 100 100"><path d="M 50 0 L 100 14 L 92 80 L 50 100 L 8 80 L 0 14 Z" fill="#b2b2b2"></path><path d="M 50 5 L 6 18 L 13.5 77 L 50 94 Z" fill="#E42939"></path><path d="M 50 5 L 94 18 L 86.5 77 L 50 94 Z" fill="#B72833"></path><path d="M 50 7 L 83 75 L 72 75 L 65 59 L 50 59 L 50 50 L 61 50 L 50 26 Z" fill="#b2b2b2"></path><path d="M 50 7 L 17 75 L 28 75 L 35 59 L 50 59 L 50 50 L 39 50 L 50 26 Z" fill="#fff"></path></svg>'
       },
       {
         id:  'md-toggle-arrow',
         url: 'md-toggle-arrow-svg',
         svg: '<svg version="1.1" x="0px" y="0px" viewBox="0 0 48 48"><path d="M24 16l-12 12 2.83 2.83 9.17-9.17 9.17 9.17 2.83-2.83z"/><path d="M0 0h48v48h-48z" fill="none"/></svg>'
       }
     ];

     svgRegistry.forEach(function(asset){
       iconProvider.icon(asset.id,  asset.url);
       $templateCache.put(asset.url, asset.svg);
     });

   },

   $get : ['$http', '$q', '$log', '$templateCache', function($http, $q, $log, $templateCache) {
     this.preloadIcons($templateCache);
     return MdIconService(config, $http, $q, $log, $templateCache);
   }]
 };

   /**
    *  Configuration item stored in the Icon registry; used for lookups
    *  to load if not already cached in the `loaded` cache
    */
   function ConfigurationItem(url, viewBoxSize) {
     this.url = url;
     this.viewBoxSize = viewBoxSize || config.defaultViewBoxSize;
   }

 /**
  * @ngdoc service
  * @name $mdIcon
  * @module material.components.icon
  *
  * @description
  * The `$mdIcon` service is a function used to lookup SVG icons.
  *
  * @param {string} id Query value for a unique Id or URL. If the argument is a URL, then the service will retrieve the icon element
  * from its internal cache or load the icon and cache it first. If the value is not a URL-type string, then an ID lookup is
  * performed. The Id may be a unique icon ID or may include an iconSet ID prefix.
  *
  * For the **id** query to work properly, this means that all id-to-URL mappings must have been previously configured
  * using the `$mdIconProvider`.
  *
  * @returns {obj} Clone of the initial SVG DOM element; which was created from the SVG markup in the SVG data file.
  *
  * @usage
  * <hljs lang="js">
  * function SomeDirective($mdIcon) {
  *
  *   // See if the icon has already been loaded, if not
  *   // then lookup the icon from the registry cache, load and cache
  *   // it for future requests.
  *   // NOTE: ID queries require configuration with $mdIconProvider
  *
  *   $mdIcon('android').then(function(iconEl)    { element.append(iconEl); });
  *   $mdIcon('work:chair').then(function(iconEl) { element.append(iconEl); });
  *
  *   // Load and cache the external SVG using a URL
  *
  *   $mdIcon('img/icons/android.svg').then(function(iconEl) {
  *     element.append(iconEl);
  *   });
  * };
  * </hljs>
  *
  * NOTE: The `<md-icon />  ` directive internally uses the `$mdIcon` service to query, loaded, and instantiate
  * SVG DOM elements.
  */
 function MdIconService(config, $http, $q, $log, $templateCache) {
   var iconCache = {};
   var urlRegex = /[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/i;

   Icon.prototype = { clone : cloneSVG, prepare: prepareAndStyle };
   getIcon.fontSet = findRegisteredFontSet;

   // Publish service...
   return getIcon;

   /**
    * Actual $mdIcon service is essentially a lookup function
    */
   function getIcon(id) {
     id = id || '';

     // If already loaded and cached, use a clone of the cached icon.
     // Otherwise either load by URL, or lookup in the registry and then load by URL, and cache.

     if ( iconCache[id]         ) return $q.when( iconCache[id].clone() );
     if ( urlRegex.test(id)     ) return loadByURL(id).then( cacheIcon(id) );
     if ( id.indexOf(':') == -1 ) id = '$default:' + id;

     return loadByID(id)
         .catch(loadFromIconSet)
         .catch(announceIdNotFound)
         .catch(announceNotFound)
         .then( cacheIcon(id) );
   }

   /**
    * Lookup registered fontSet style using its alias...
    * If not found,
    */
   function findRegisteredFontSet(alias) {
      var useDefault = angular.isUndefined(alias) || !(alias && alias.length);
      if ( useDefault ) return config.defaultFontSet;

      var result = alias;
      angular.forEach(config.fontSets, function(it){
        if ( it.alias == alias ) result = it.fontSet || result;
      });

      return result;
   }

   /**
    * Prepare and cache the loaded icon for the specified `id`
    */
   function cacheIcon( id ) {

     return function updateCache( icon ) {
       iconCache[id] = isIcon(icon) ? icon : new Icon(icon, config[id]);

       return iconCache[id].clone();
     };
   }

   /**
    * Lookup the configuration in the registry, if !registered throw an error
    * otherwise load the icon [on-demand] using the registered URL.
    *
    */
   function loadByID(id) {
     var iconConfig = config[id];

     return !iconConfig ? $q.reject(id) : loadByURL(iconConfig.url).then(function(icon) {
       return new Icon(icon, iconConfig);
     });
   }

   /**
    *    Loads the file as XML and uses querySelector( <id> ) to find
    *    the desired node...
    */
   function loadFromIconSet(id) {
     var setName = id.substring(0, id.lastIndexOf(':')) || '$default';
     var iconSetConfig = config[setName];

     return !iconSetConfig ? $q.reject(id) : loadByURL(iconSetConfig.url).then(extractFromSet);

     function extractFromSet(set) {
       var iconName = id.slice(id.lastIndexOf(':') + 1);
       var icon = set.querySelector('#' + iconName);
       return !icon ? $q.reject(id) : new Icon(icon, iconSetConfig);
     }
   }

   /**
    * Load the icon by URL (may use the $templateCache).
    * Extract the data for later conversion to Icon
    */
   function loadByURL(url) {
     return $http
       .get(url, { cache: $templateCache })
       .then(function(response) {
         return angular.element('<div>').append(response.data).find('svg')[0];
       });
   }

   /**
    * User did not specify a URL and the ID has not been registered with the $mdIcon
    * registry
    */
   function announceIdNotFound(id) {
     var msg;

     if (angular.isString(id)) {
       msg = 'icon ' + id + ' not found';
       $log.warn(msg);
     }

     return $q.reject(msg || id);
   }

   /**
    * Catch HTTP or generic errors not related to incorrect icon IDs.
    */
   function announceNotFound(err) {
     var msg = angular.isString(err) ? err : (err.message || err.data || err.statusText);
     $log.warn(msg);

     return $q.reject(msg);
   }

   /**
    * Check target signature to see if it is an Icon instance.
    */
   function isIcon(target) {
     return angular.isDefined(target.element) && angular.isDefined(target.config);
   }

   /**
    *  Define the Icon class
    */
   function Icon(el, config) {
     if (el.tagName != 'svg') {
       el = angular.element('<svg xmlns="http://www.w3.org/2000/svg">').append(el)[0];
     }

     // Inject the namespace if not available...
     if ( !el.getAttribute('xmlns') ) {
       el.setAttribute('xmlns', "http://www.w3.org/2000/svg");
     }

     this.element = el;
     this.config = config;
     this.prepare();
   }

   /**
    *  Prepare the DOM element that will be cached in the
    *  loaded iconCache store.
    */
   function prepareAndStyle() {
     var viewBoxSize = this.config ? this.config.viewBoxSize : config.defaultViewBoxSize;
         angular.forEach({
           'fit'   : '',
           'height': '100%',
           'width' : '100%',
           'preserveAspectRatio': 'xMidYMid meet',
           'viewBox' : this.element.getAttribute('viewBox') || ('0 0 ' + viewBoxSize + ' ' + viewBoxSize)
         }, function(val, attr) {
           this.element.setAttribute(attr, val);
         }, this);

         angular.forEach({
           'pointer-events' : 'none',
           'display' : 'block'
         }, function(val, style) {
           this.element.style[style] = val;
         }, this);
   }

   /**
    * Clone the Icon DOM element.
    */
   function cloneSVG(){
     return this.element.cloneNode(true);
   }

 }

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.input
 */

angular.module('material.components.input', [
  'material.core'
])
  .directive('mdInputContainer', mdInputContainerDirective)
  .directive('label', labelDirective)
  .directive('input', inputTextareaDirective)
  .directive('textarea', inputTextareaDirective)
  .directive('mdMaxlength', mdMaxlengthDirective)
  .directive('placeholder', placeholderDirective);

/**
 * @ngdoc directive
 * @name mdInputContainer
 * @module material.components.input
 *
 * @restrict E
 *
 * @description
 * `<md-input-container>` is the parent of any input or textarea element.
 *
 * Input and textarea elements will not behave properly unless the md-input-container
 * parent is provided.
 *
 * @param md-is-error {expression=} When the given expression evaluates to true, the input container will go into error state. Defaults to erroring if the input has been touched and is invalid.
 * @param md-no-float {boolean=} When present, placeholders will not be converted to floating labels
 *
 * @usage
 * <hljs lang="html">
 *
 * <md-input-container>
 *   <label>Username</label>
 *   <input type="text" ng-model="user.name">
 * </md-input-container>
 *
 * <md-input-container>
 *   <label>Description</label>
 *   <textarea ng-model="user.description"></textarea>
 * </md-input-container>
 *
 * </hljs>
 */
function mdInputContainerDirective($mdTheming, $parse) {
  ContainerCtrl.$inject = ["$scope", "$element", "$attrs"];
  return {
    restrict: 'E',
    link: postLink,
    controller: ContainerCtrl
  };

  function postLink(scope, element, attr) {
    $mdTheming(element);
  }
  function ContainerCtrl($scope, $element, $attrs) {
    var self = this;

    self.isErrorGetter = $attrs.mdIsError && $parse($attrs.mdIsError);

    self.delegateClick = function() {
      self.input.focus();
    };
    self.element = $element;
    self.setFocused = function(isFocused) {
      $element.toggleClass('md-input-focused', !!isFocused);
    };
    self.setHasValue = function(hasValue) {
      $element.toggleClass('md-input-has-value', !!hasValue);
    };
    self.setInvalid = function(isInvalid) {
      $element.toggleClass('md-input-invalid', !!isInvalid);
    };
    $scope.$watch(function() {
      return self.label && self.input;
    }, function(hasLabelAndInput) {
      if (hasLabelAndInput && !self.label.attr('for')) {
        self.label.attr('for', self.input.attr('id'));
      }
    });
  }
}
mdInputContainerDirective.$inject = ["$mdTheming", "$parse"];

function labelDirective() {
  return {
    restrict: 'E',
    require: '^?mdInputContainer',
    link: function(scope, element, attr, containerCtrl) {
      if (!containerCtrl || attr.mdNoFloat) return;

      containerCtrl.label = element;
      scope.$on('$destroy', function() {
        containerCtrl.label = null;
      });
    }
  };
}

/**
 * @ngdoc directive
 * @name mdInput
 * @restrict E
 * @module material.components.input
 *
 * @description
 * Use the `<input>` or the  `<textarea>` as a child of an `<md-input-container>`.
 *
 * @param {number=} md-maxlength The maximum number of characters allowed in this input. If this is specified, a character counter will be shown underneath the input.<br/><br/>
 * The purpose of **`md-maxlength`** is exactly to show the max length counter text. If you don't want the counter text and only need "plain" validation, you can use the "simple" `ng-maxlength` or maxlength attributes.
 * @param {string=} aria-label Aria-label is required when no label is present.  A warning message will be logged in the console if not present.
 * @param {string=} placeholder An alternative approach to using aria-label when the label is not present.  The placeholder text is copied to the aria-label attribute.
 *
 * @usage
 * <hljs lang="html">
 * <md-input-container>
 *   <label>Color</label>
 *   <input type="text" ng-model="color" required md-maxlength="10">
 * </md-input-container>
 * </hljs>
 * <h3>With Errors</h3>
 *
 * <hljs lang="html">
 * <form name="userForm">
 *   <md-input-container>
 *     <label>Last Name</label>
 *     <input name="lastName" ng-model="lastName" required md-maxlength="10" minlength="4">
 *     <div ng-messages="userForm.lastName.$error" ng-show="userForm.lastName.$dirty">
 *       <div ng-message="required">This is required!</div>
 *       <div ng-message="md-maxlength">That's too long!</div>
 *       <div ng-message="minlength">That's too short!</div>
 *     </div>
 *   </md-input-container>
 *   <md-input-container>
 *     <label>Biography</label>
 *     <textarea name="bio" ng-model="biography" required md-maxlength="150"></textarea>
 *     <div ng-messages="userForm.bio.$error" ng-show="userForm.bio.$dirty">
 *       <div ng-message="required">This is required!</div>
 *       <div ng-message="md-maxlength">That's too long!</div>
 *     </div>
 *   </md-input-container>
 *   <md-input-container>
 *     <input aria-label='title' ng-model='title'>
 *   </md-input-container>
 *   <md-input-container>
 *     <input placeholder='title' ng-model='title'>
 *   </md-input-container>
 * </form>
 * </hljs>
 *
 * Requires [ngMessages](https://docs.angularjs.org/api/ngMessages).
 * Behaves like the [AngularJS input directive](https://docs.angularjs.org/api/ng/directive/input).
 *
 */

function inputTextareaDirective($mdUtil, $window, $mdAria) {
  return {
    restrict: 'E',
    require: ['^?mdInputContainer', '?ngModel'],
    link: postLink
  };

  function postLink(scope, element, attr, ctrls) {

    var containerCtrl = ctrls[0];
    var ngModelCtrl = ctrls[1] || $mdUtil.fakeNgModel();
    var isReadonly = angular.isDefined(attr.readonly);

    if ( !containerCtrl ) return;
    if (containerCtrl.input) {
      throw new Error("<md-input-container> can only have *one* <input> or <textarea> child element!");
    }
    containerCtrl.input = element;

    if(!containerCtrl.label) {
      $mdAria.expect(element, 'aria-label', element.attr('placeholder'));
    }

    element.addClass('md-input');
    if (!element.attr('id')) {
      element.attr('id', 'input_' + $mdUtil.nextUid());
    }

    if (element[0].tagName.toLowerCase() === 'textarea') {
      setupTextarea();
    }

    var isErrorGetter = containerCtrl.isErrorGetter || function() {
      return ngModelCtrl.$invalid && ngModelCtrl.$touched;
    };
    scope.$watch(isErrorGetter, containerCtrl.setInvalid);

    ngModelCtrl.$parsers.push(ngModelPipelineCheckValue);
    ngModelCtrl.$formatters.push(ngModelPipelineCheckValue);

    element.on('input', inputCheckValue);

    if (!isReadonly) {
      element
        .on('focus', function(ev) {
          containerCtrl.setFocused(true);
        })
        .on('blur', function(ev) {
          containerCtrl.setFocused(false);
          inputCheckValue();
        });

    }

    //ngModelCtrl.$setTouched();
    //if( ngModelCtrl.$invalid ) containerCtrl.setInvalid();

    scope.$on('$destroy', function() {
      containerCtrl.setFocused(false);
      containerCtrl.setHasValue(false);
      containerCtrl.input = null;
    });

    /**
     *
     */
    function ngModelPipelineCheckValue(arg) {
      containerCtrl.setHasValue(!ngModelCtrl.$isEmpty(arg));
      return arg;
    }
    function inputCheckValue() {
      // An input's value counts if its length > 0,
      // or if the input's validity state says it has bad input (eg string in a number input)
      containerCtrl.setHasValue(element.val().length > 0 || (element[0].validity||{}).badInput);
    }

    function setupTextarea() {
      var node = element[0];
      var onChangeTextarea = $mdUtil.debounce(growTextarea, 1);

      function pipelineListener(value) {
        onChangeTextarea();
        return value;
      }

      if (ngModelCtrl) {
        ngModelCtrl.$formatters.push(pipelineListener);
        ngModelCtrl.$viewChangeListeners.push(pipelineListener);
      } else {
        onChangeTextarea();
      }
      element.on('keydown input', onChangeTextarea);
      element.on('scroll', onScroll);
      angular.element($window).on('resize', onChangeTextarea);

      scope.$on('$destroy', function() {
        angular.element($window).off('resize', onChangeTextarea);
      });

      function growTextarea() {
        node.style.height = "auto";
        node.scrollTop = 0;
        var height = getHeight();
        if (height) node.style.height = height + 'px';
      }

      function getHeight () {
        var line = node.scrollHeight - node.offsetHeight;
        return node.offsetHeight + (line > 0 ? line : 0);
      }

      function onScroll(e) {
        node.scrollTop = 0;
        // for smooth new line adding
        var line = node.scrollHeight - node.offsetHeight;
        var height = node.offsetHeight + line;
        node.style.height = height + 'px';
      }
    }
  }
}
inputTextareaDirective.$inject = ["$mdUtil", "$window", "$mdAria"];

function mdMaxlengthDirective($animate) {
  return {
    restrict: 'A',
    require: ['ngModel', '^mdInputContainer'],
    link: postLink
  };

  function postLink(scope, element, attr, ctrls) {
    var maxlength;
    var ngModelCtrl = ctrls[0];
    var containerCtrl = ctrls[1];
    var charCountEl = angular.element('<div class="md-char-counter">');

    // Stop model from trimming. This makes it so whitespace
    // over the maxlength still counts as invalid.
    attr.$set('ngTrim', 'false');
    containerCtrl.element.append(charCountEl);

    ngModelCtrl.$formatters.push(renderCharCount);
    ngModelCtrl.$viewChangeListeners.push(renderCharCount);
    element.on('input keydown', function() {
      renderCharCount(); //make sure it's called with no args
    });

    scope.$watch(attr.mdMaxlength, function(value) {
      maxlength = value;
      if (angular.isNumber(value) && value > 0) {
        if (!charCountEl.parent().length) {
          $animate.enter(charCountEl, containerCtrl.element,
                         angular.element(containerCtrl.element[0].lastElementChild));
        }
        renderCharCount();
      } else {
        $animate.leave(charCountEl);
      }
    });

    ngModelCtrl.$validators['md-maxlength'] = function(modelValue, viewValue) {
      if (!angular.isNumber(maxlength) || maxlength < 0) {
        return true;
      }
      return ( modelValue || element.val() || viewValue || '' ).length <= maxlength;
    };

    function renderCharCount(value) {
      charCountEl.text( ( element.val() || value || '' ).length + '/' + maxlength );
      return value;
    }
  }
}
mdMaxlengthDirective.$inject = ["$animate"];

function placeholderDirective($log) {
  var blackListElements = ['MD-SELECT'];
  return {
    restrict: 'A',
    require: '^^?mdInputContainer',
    priority: 200,
    link: postLink
  };

  function postLink(scope, element, attr, inputContainer) {
    if (!inputContainer) return;
    if (blackListElements.indexOf(element[0].nodeName) != -1) return;
    if (angular.isDefined(inputContainer.element.attr('md-no-float'))) return;

    var placeholderText = attr.placeholder;
    element.removeAttr('placeholder');

    if ( inputContainer.element.find('label').length == 0 ) {
      var placeholder = '<label ng-click="delegateClick()">' + placeholderText + '</label>';

      inputContainer.element.addClass('md-icon-float');
      inputContainer.element.prepend(placeholder);
    } else {
      $log.warn("The placeholder='" + placeholderText + "' will be ignored since this md-input-container has a child label element.");
    }

  }
}
placeholderDirective.$inject = ["$log"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.list
 * @description
 * List module
 */
angular.module('material.components.list', [
  'material.core'
])
  .controller('MdListController', MdListController)
  .directive('mdList', mdListDirective)
  .directive('mdListItem', mdListItemDirective);

/**
 * @ngdoc directive
 * @name mdList
 * @module material.components.list
 *
 * @restrict E
 *
 * @description
 * The `<md-list>` directive is a list container for 1..n `<md-list-item>` tags.
 *
 * @usage
 * <hljs lang="html">
 * <md-list>
 *   <md-list-item class="md-2-line" ng-repeat="item in todos">
 *     <md-checkbox ng-model="item.done"></md-checkbox>
 *     <div class="md-list-item-text">
 *       <h3>{{item.title}}</h3>
 *       <p>{{item.description}}</p>
 *     </div>
 *   </md-list-item>
 * </md-list>
 * </hljs>
 */

function mdListDirective($mdTheming) {
  return {
    restrict: 'E',
    compile: function(tEl) {
      tEl[0].setAttribute('role', 'list');
      return $mdTheming;
    }
  };
}
mdListDirective.$inject = ["$mdTheming"];
/**
 * @ngdoc directive
 * @name mdListItem
 * @module material.components.list
 *
 * @restrict E
 *
 * @description
 * The `<md-list-item>` directive is a container intended for row items in a `<md-list>` container.
 *
 * @usage
 * <hljs lang="html">
 *  <md-list>
 *    <md-list-item>
 *            Item content in list
 *    </md-list-item>
 *  </md-list>
 * </hljs>
 *
 */
function mdListItemDirective($mdAria, $mdConstant, $timeout) {
  var proxiedTypes = ['md-checkbox', 'md-switch'];
  return {
    restrict: 'E',
    controller: 'MdListController',
    compile: function(tEl, tAttrs) {
      // Check for proxy controls (no ng-click on parent, and a control inside)
      var secondaryItem = tEl[0].querySelector('.md-secondary');
      var hasProxiedElement;
      var proxyElement;

      tEl[0].setAttribute('role', 'listitem');

      if (!tAttrs.ngClick) {
        for (var i = 0, type; type = proxiedTypes[i]; ++i) {
          if (proxyElement = tEl[0].querySelector(type)) {
            hasProxiedElement = true;
            break;
          }
        }
        if (hasProxiedElement) {
          wrapIn('div');
        } else if (!tEl[0].querySelector('md-button')) {
          tEl.addClass('md-no-proxy');
        }
      } else {
        wrapIn('button');
      }
      setupToggleAria();


      function setupToggleAria() {
        var toggleTypes = ['md-switch', 'md-checkbox'];
        var toggle;

        for (var i = 0, toggleType; toggleType = toggleTypes[i]; ++i) {
          if (toggle = tEl.find(toggleType)[0]) {
            if (!toggle.hasAttribute('aria-label')) {
              var p = tEl.find('p')[0];
              if (!p) return;
              toggle.setAttribute('aria-label', 'Toggle ' + p.textContent);
            }
          }
        }
      }

      function wrapIn(type) {
        var container;
        if (type == 'div') {
          container = angular.element('<div class="md-no-style md-list-item-inner">');
          container.append(tEl.contents());
          tEl.addClass('md-proxy-focus');
        } else {
          container = angular.element('<md-button class="md-no-style"><div class="md-list-item-inner"></div></md-button>');
          var copiedAttrs = ['ng-click', 'aria-label', 'ng-disabled'];
          angular.forEach(copiedAttrs, function(attr) {
            if (tEl[0].hasAttribute(attr)) {
              container[0].setAttribute(attr, tEl[0].getAttribute(attr));
              tEl[0].removeAttribute(attr);
            }
          });
          container.children().eq(0).append(tEl.contents());
        }

        tEl[0].setAttribute('tabindex', '-1');
        tEl.append(container);

        if (secondaryItem && secondaryItem.hasAttribute('ng-click')) {
          $mdAria.expect(secondaryItem, 'aria-label');
          var buttonWrapper = angular.element('<md-button class="md-secondary-container md-icon-button">');
          buttonWrapper.attr('ng-click', secondaryItem.getAttribute('ng-click'));
          secondaryItem.removeAttribute('ng-click');
          secondaryItem.setAttribute('tabindex', '-1');
          secondaryItem.classList.remove('md-secondary');
          buttonWrapper.append(secondaryItem);
          secondaryItem = buttonWrapper[0];
        }

        // Check for a secondary item and move it outside
        if ( secondaryItem && (
          secondaryItem.hasAttribute('ng-click') ||
            ( tAttrs.ngClick &&
             isProxiedElement(secondaryItem) )
        )) {
          tEl.addClass('md-with-secondary');
          tEl.append(secondaryItem);
        }
      }

      function isProxiedElement(el) {
        return proxiedTypes.indexOf(el.nodeName.toLowerCase()) != -1;
      }

      return postLink;

      function postLink($scope, $element, $attr, ctrl) {

        var proxies    = [],
            firstChild = $element[0].firstElementChild,
            hasClick   = firstChild && firstChild.hasAttribute('ng-click');

        computeProxies();
        computeClickable();

        if ($element.hasClass('md-proxy-focus') && proxies.length) {
          angular.forEach(proxies, function(proxy) {
            proxy = angular.element(proxy);

            $scope.mouseActive = false;
            proxy.on('mousedown', function() {
              $scope.mouseActive = true;
              $timeout(function(){
                $scope.mouseActive = false;
              }, 100);
            })
            .on('focus', function() {
              if ($scope.mouseActive === false) { $element.addClass('md-focused'); }
              proxy.on('blur', function proxyOnBlur() {
                $element.removeClass('md-focused');
                proxy.off('blur', proxyOnBlur);
              });
            });
          });
        }

        function computeProxies() {
          var children = $element.children();
          if (children.length && !children[0].hasAttribute('ng-click')) {
            angular.forEach(proxiedTypes, function(type) {
              angular.forEach(firstChild.querySelectorAll(type), function(child) {
                proxies.push(child);
              });
            });
          }
        }
        function computeClickable() {
          if (proxies.length || hasClick) {
            $element.addClass('md-clickable');

            ctrl.attachRipple($scope, angular.element($element[0].querySelector('.md-no-style')));
          }
        }

        if (!hasClick && !proxies.length) {
          firstChild && firstChild.addEventListener('keypress', function(e) {
            if (e.target.nodeName != 'INPUT' && e.target.nodeName != 'TEXTAREA') {
              var keyCode = e.which || e.keyCode;
              if (keyCode == $mdConstant.KEY_CODE.SPACE) {
                if (firstChild) {
                  firstChild.click();
                  e.preventDefault();
                  e.stopPropagation();
                }
              }
            }
          });
        }

        $element.off('click');
        $element.off('keypress');

        if (proxies.length && firstChild) {
          $element.children().eq(0).on('click', function(e) {
            if (firstChild.contains(e.target)) {
              angular.forEach(proxies, function(proxy) {
                if (e.target !== proxy && !proxy.contains(e.target)) {
                  angular.element(proxy).triggerHandler('click');
                }
              });
            }
          });
        }
      }
    }
  };
}
mdListItemDirective.$inject = ["$mdAria", "$mdConstant", "$timeout"];

/*
 * @private
 * @ngdoc controller
 * @name MdListController
 * @module material.components.list
 *
 */
function MdListController($scope, $element, $mdListInkRipple) {
  var ctrl = this;
  ctrl.attachRipple = attachRipple;

  function attachRipple (scope, element) {
    var options = {};
    $mdListInkRipple.attach(scope, element, options);
  }
}
MdListController.$inject = ["$scope", "$element", "$mdListInkRipple"];


})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.menu
 */

angular.module('material.components.menu', [
  'material.core',
  'material.components.backdrop'
])
.directive('mdMenu', MenuDirective)
.controller('mdMenuCtrl', MenuController);

/**
 * @ngdoc directive
 * @name mdMenu
 * @module material.components.menu
 * @restrict E
 * @description
 *
 * Menus are elements that open when clicked. They are useful for displaying
 * additional options within the context of an action.
 *
 * Every `md-menu` must specify exactly two child elements. The first element is what is
 * left in the DOM and is used to open the menu. This element is called the trigger element.
 * The trigger element's scope has access to `$mdOpenMenu($event)`
 * which it may call to open the menu. By passing $event as argument, the
 * corresponding event is stopped from propagating up the DOM-tree.
 *
 * The second element is the `md-menu-content` element which represents the
 * contents of the menu when it is open. Typically this will contain `md-menu-item`s,
 * but you can do custom content as well.
 *
 * <hljs lang="html">
 * <md-menu>
 *  <!-- Trigger element is a md-button with an icon -->
 *  <md-button ng-click="$mdOpenMenu($event)" class="md-icon-button" aria-label="Open sample menu">
 *    <md-icon md-svg-icon="call:phone"></md-icon>
 *  </md-button>
 *  <md-menu-content>
 *    <md-menu-item><md-button ng-click="doSomething()">Do Something</md-button></md-menu-item>
 *  </md-menu-content>
 * </md-menu>
 * </hljs>

 * ## Sizing Menus
 *
 * The width of the menu when it is open may be specified by specifying a `width`
 * attribute on the `md-menu-content` element.
 * See the [Material Design Spec](http://www.google.com/design/spec/components/menus.html#menus-specs)
 * for more information.
 *
 *
 * ## Aligning Menus
 *
 * When a menu opens, it is important that the content aligns with the trigger element.
 * Failure to align menus can result in jarring experiences for users as content
 * suddenly shifts. To help with this, `md-menu` provides serveral APIs to help
 * with alignment.
 *
 * ### Target Mode
 *
 * By default, `md-menu` will attempt to align the `md-menu-content` by aligning
 * designated child elements in both the trigger and the menu content.
 *
 * To specify the alignment element in the `trigger` you can use the `md-menu-origin`
 * attribute on a child element. If no `md-menu-origin` is specified, the `md-menu`
 * will be used as the origin element.
 *
 * Similarly, the `md-menu-content` may specify a `md-menu-align-target` for a
 * `md-menu-item` to specify the node that it should try and align with.
 *
 * In this example code, we specify an icon to be our origin element, and an
 * icon in our menu content to be our alignment target. This ensures that both
 * icons are aligned when the menu opens.
 *
 * <hljs lang="html">
 * <md-menu>
 *  <md-button ng-click="$mdOpenMenu($event)" class="md-icon-button" aria-label="Open some menu">
 *    <md-icon md-menu-origin md-svg-icon="call:phone"></md-icon>
 *  </md-button>
 *  <md-menu-content>
 *    <md-menu-item>
 *      <md-button ng-click="doSomething()" aria-label="Do something">
 *        <md-icon md-menu-align-target md-svg-icon="call:phone"></md-icon>
 *        Do Something
 *      </md-button>
 *    </md-menu-item>
 *  </md-menu-content>
 * </md-menu>
 * </hljs>
 *
 * Sometimes we want to specify alignment on the right side of an element, for example
 * if we have a menu on the right side a toolbar, we want to right align our menu content.
 *
 * We can specify the origin by using the `md-position-mode` attribute on both
 * the `x` and `y` axis. Right now only the `x-axis` has more than one option.
 * You may specify the default mode of `target target` or
 * `target-right target` to specify a right-oriented alignment target. See the
 * position section of the demos for more examples.
 *
 * ### Menu Offsets
 *
 * It is sometimes unavoidable to need to have a deeper level of control for
 * the positioning of a menu to ensure perfect alignment. `md-menu` provides
 * the `md-offset` attribute to allow pixel level specificty of adjusting the
 * exact positioning.
 *
 * This offset is provided in the format of `x y` or `n` where `n` will be used
 * in both the `x` and `y` axis.
 *
 * For example, to move a menu by `2px` from the top, we can use:
 * <hljs lang="html">
 * <md-menu md-offset="2 0">
 *   <!-- menu-content -->
 * </md-menu>
 * </hljs>
 *
 * @usage
 * <hljs lang="html">
 * <md-menu>
 *  <md-button ng-click="$mdOpenMenu($event)" class="md-icon-button">
 *    <md-icon md-svg-icon="call:phone"></md-icon>
 *  </md-button>
 *  <md-menu-content>
 *    <md-menu-item><md-button ng-click="doSomething()">Do Something</md-button></md-menu-item>
 *  </md-menu-content>
 * </md-menu>
 * </hljs>
 *
 * @param {string} md-position-mode The position mode in the form of
             `x`, `y`. Default value is `target`,`target`. Right now the `x` axis
             also suppports `target-right`.
 * @param {string} md-offset An offset to apply to the dropdown after positioning
             `x`, `y`. Default value is `0`,`0`.
 *
 */

function MenuDirective($mdMenu) {
  return {
    restrict: 'E',
    require: 'mdMenu',
    controller: 'mdMenuCtrl', // empty function to be built by link
    scope: true,
    compile: compile
  };

  function compile(templateElement) {
    templateElement.addClass('md-menu');
    var triggerElement = templateElement.children()[0];
    if (!triggerElement.hasAttribute('ng-click')) {
      triggerElement = triggerElement.querySelector('[ng-click]');
    }
    triggerElement && triggerElement.setAttribute('aria-haspopup', 'true');
    if (templateElement.children().length != 2) {
      throw Error('Invalid HTML for md-menu. Expected two children elements.');
    }
    return link;
  }

  function link(scope, element, attrs, mdMenuCtrl) {

    // Move everything into a md-menu-container and pass it to the controller
    var menuContainer = angular.element(
      '<div class="md-open-menu-container md-whiteframe-z2"></div>'
    );
    var menuContents = element.children()[1];
    menuContainer.append(menuContents);
    mdMenuCtrl.init(menuContainer);

    scope.$on('$destroy', function() {
      if (mdMenuCtrl.isOpen) {
        menuContainer.remove();
        mdMenuCtrl.close();
      }
    });

  }
}
MenuDirective.$inject = ["$mdMenu"];

function MenuController($mdMenu, $attrs, $element, $scope) {

  var menuContainer;
  var ctrl = this;
  var triggerElement;

  // Called by our linking fn to provide access to the menu-content
  // element removed during link
  this.init = function(setMenuContainer) {
    menuContainer = setMenuContainer;
    triggerElement = $element[0].querySelector('[ng-click]');
  };

  // Uses the $mdMenu interim element service to open the menu contents
  this.open = function openMenu(ev) {
    ev && ev.stopPropagation();

    ctrl.isOpen = true;
    triggerElement.setAttribute('aria-expanded', 'true');
    $mdMenu.show({
      mdMenuCtrl: ctrl,
      element: menuContainer,
      target: $element[0]
    });
  };
  // Expose a open function to the child scope for html to use
  $scope.$mdOpenMenu = this.open;

  // Use the $mdMenu interim element service to close the menu contents
  this.close = function closeMenu(skipFocus) {
    ctrl.isOpen = false;
    triggerElement.setAttribute('aria-expanded', 'false');
    $mdMenu.hide();

    if (!skipFocus) {
      $element.children()[0].focus();
    }
  };

  // Build a nice object out of our string attribute which specifies the
  // target mode for left and top positioning
  this.positionMode = function() {
    var attachment = ($attrs.mdPositionMode || 'target').split(' ');

    // If attachment is a single item, duplicate it for our second value.
    // ie. 'target' -> 'target target'
    if (attachment.length == 1) {
      attachment.push(attachment[0]);
    }

    return {
      left: attachment[0],
      top: attachment[1]
    };
  };

  // Build a nice object out of our string attribute which specifies
  // the offset of top and left in pixels.
  this.offsets = function() {
    var offsets = ($attrs.mdOffset || '0 0').split(' ').map(parseFloat);
    if (offsets.length == 2) {
      return {
        left: offsets[0],
        top: offsets[1]
      };
    } else if (offsets.length == 1) {
      return {
        top: offsets[0],
        left: offsets[0]
      };
    } else {
      throw Error('Invalid offsets specified. Please follow format <x, y> or <n>');
    }
  };
}
MenuController.$inject = ["$mdMenu", "$attrs", "$element", "$scope"];

})();
(function(){
"use strict";

angular.module('material.components.menu')
.provider('$mdMenu', MenuProvider);

/*
 * Interim element provider for the menu.
 * Handles behavior for a menu while it is open, including:
 *    - handling animating the menu opening/closing
 *    - handling key/mouse events on the menu element
 *    - handling enabling/disabling scroll while the menu is open
 *    - handling redrawing during resizes and orientation changes
 *
 */

function MenuProvider($$interimElementProvider) {
  var MENU_EDGE_MARGIN = 8;

  menuDefaultOptions.$inject = ["$$rAF", "$window", "$mdUtil", "$mdTheming", "$timeout", "$mdConstant", "$document"];
  return $$interimElementProvider('$mdMenu')
    .setDefaults({
      methods: ['target'],
      options: menuDefaultOptions
    });

  /* @ngInject */
  function menuDefaultOptions($$rAF, $window, $mdUtil, $mdTheming, $timeout, $mdConstant, $document) {
    return {
      parent: 'body',
      onShow: onShow,
      onRemove: onRemove,
      hasBackdrop: true,
      disableParentScroll: true,
      skipCompile: true,
      themable: true
    };

    /**
     * Boilerplate interimElement onShow function
     * Handles inserting the menu into the DOM, positioning it, and wiring up
     * various interaction events
     */
    function onShow(scope, element, opts) {

      // Sanitize and set defaults on opts
      buildOpts(opts);

      // Wire up theming on our menu element
      $mdTheming.inherit(opts.menuContentEl, opts.target);

      // Register various listeners to move menu on resize/orientation change
      handleResizing();

      // Disable scrolling
      if (opts.disableParentScroll) {
        opts.restoreScroll = $mdUtil.disableScrollAround(opts.element);
      }

      // Only activate click listeners after a short time to stop accidental double taps/clicks
      // from clicking the wrong item
      $timeout(activateInteraction, 75, false);

      if (opts.backdrop) {
        $mdTheming.inherit(opts.backdrop, opts.parent);
        opts.parent.append(opts.backdrop);
      }
      showMenu();

      // Return the promise for when our menu is done animating in
      return $mdUtil.transitionEndPromise(element, {timeout: 350});

      /** Check for valid opts and set some sane defaults */
      function buildOpts() {
        if (!opts.target) {
          throw Error(
            '$mdMenu.show() expected a target to animate from in options.target'
          );
        }
        angular.extend(opts, {
          alreadyOpen: false,
          isRemoved: false,
          target: angular.element(opts.target), //make sure it's not a naked dom node
          parent: angular.element(opts.parent),
          menuContentEl: angular.element(element[0].querySelector('md-menu-content')),
          backdrop: opts.hasBackdrop && angular.element('<md-backdrop class="md-menu-backdrop md-click-catcher">')
        });
      }

      /** Wireup various resize listeners for screen changes */
      function handleResizing() {
        opts.resizeFn = function() {
          positionMenu(element, opts);
        };
        angular.element($window).on('resize', opts.resizeFn);
        angular.element($window).on('orientationchange', opts.resizeFn);
      }

      /**
       * Place the menu into the DOM and call positioning related functions
       */
      function showMenu() {
        opts.parent.append(element);

        element.removeClass('md-leave');
        // Kick off our animation/positioning but first, wait a few frames
        // so all of our computed positions/sizes are accurate
        $$rAF(function() {
          $$rAF(function() {
            positionMenu(element, opts);
            // Wait a frame before fading in menu (md-active) so that we don't trigger
            // transitions on the menu position changing
            $$rAF(function() {
              element.addClass('md-active');
              opts.alreadyOpen = true;
              element[0].style[$mdConstant.CSS.TRANSFORM] = '';
            });
          });
        });
      }


      /**
       * Activate interaction on the menu. Wire up keyboard listerns for
       * clicks, keypresses, backdrop closing, etc.
       */
      function activateInteraction() {
        element.addClass('md-clickable');

        // close on backdrop click
        opts.backdrop && opts.backdrop.on('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          opts.mdMenuCtrl.close(true);
        });

        // Wire up keyboard listeners.
        // Close on escape, focus next item on down arrow, focus prev item on up
        opts.menuContentEl.on('keydown', function(ev) {
          scope.$apply(function() {
            switch (ev.keyCode) {
              case $mdConstant.KEY_CODE.ESCAPE: opts.mdMenuCtrl.close(); break;
              case $mdConstant.KEY_CODE.UP_ARROW: focusMenuItem(ev, opts.menuContentEl, opts, -1); break;
              case $mdConstant.KEY_CODE.DOWN_ARROW: focusMenuItem(ev, opts.menuContentEl, opts, 1); break;
            }
          });
        });

        // Close menu on menu item click, if said menu-item is not disabled
        opts.menuContentEl.on('click', function(e) {
          var target = e.target;
          // Traverse up the event until we get to the menuContentEl to see if
          // there is an ng-click and that the ng-click is not disabled
          do {
            if (target && target.hasAttribute('ng-click')) {
              if (!target.hasAttribute('disabled')) {
                close();
              }
              break;
            }
          } while ((target = target.parentNode) && target != opts.menuContentEl)

          function close() {
            scope.$apply(function() {
              opts.mdMenuCtrl.close();
            });
          }
        });

        // kick off initial focus in the menu on the first element
        var focusTarget = opts.menuContentEl[0].querySelector('[md-menu-focus-target]');
        if (!focusTarget) focusTarget = opts.menuContentEl[0].firstElementChild.firstElementChild;
        focusTarget.focus();
      }
    }

    /**
      * Takes a keypress event and focuses the next/previous menu
      * item from the emitting element
      * @param {event} e - The origin keypress event
      * @param {angular.element} menuEl - The menu element
      * @param {object} opts - The interim element options for the mdMenu
      * @param {number} direction - The direction to move in (+1 = next, -1 = prev)
      */
    function focusMenuItem(e, menuEl, opts, direction) {
      var currentItem = $mdUtil.getClosest(e.target, 'MD-MENU-ITEM');

      var items = $mdUtil.nodesToArray(menuEl[0].children);
      var currentIndex = items.indexOf(currentItem);

      // Traverse through our elements in the specified direction (+/-1) and try to
      // focus them until we find one that accepts focus
      for (var i = currentIndex + direction; i >= 0 && i < items.length; i = i + direction) {
        var focusTarget = items[i].firstElementChild || items[i];
        var didFocus = attemptFocus(focusTarget);
        if (didFocus) {
          break;
        }
      }
    }

    /**
     * Attempts to focus an element. Checks whether that element is the currently
     * focused element after attempting.
     * @param {HTMLElement} el - the element to attempt focus on
     * @returns {bool} - whether the element was successfully focused
     */
    function attemptFocus(el) {
      if (el && el.getAttribute('tabindex') != -1) {
        el.focus();
        if ($document[0].activeElement == el) {
          return true;
        } else {
          return false;
        }
      }
    }

    /**
     * Boilerplate interimElement onRemove function
     * Handles removing the menu from the DOM, cleaning up the element
     * and removing various listeners
     */
    function onRemove(scope, element, opts) {
      opts.isRemoved = true;
      element.addClass('md-leave')
        .removeClass('md-clickable');

      // Disable resizing handlers
      angular.element($window).off('resize', opts.resizeFn);
      angular.element($window).off('orientationchange', opts.resizeFn);
      opts.resizeFn = undefined;

      // Wait for animate out, then remove from the DOM
      return $mdUtil.transitionEndPromise(element, { timeout: 350 }).then(function() {
        element.removeClass('md-active');
        opts.backdrop && opts.backdrop.remove();
        if (element[0].parentNode === opts.parent[0]) {
          opts.parent[0].removeChild(element[0]);
        }
        opts.restoreScroll && opts.restoreScroll();
      });
    }

    /**
     * Computes menu position and sets the style on the menu container
     * @param {HTMLElement} el - the menu container element
     * @param {object} opts - the interim element options object
     */
    function positionMenu(el, opts) {
      if (opts.isRemoved) return;

      var containerNode = el[0],
          openMenuNode = el[0].firstElementChild,
          openMenuNodeRect = openMenuNode.getBoundingClientRect(),
          boundryNode = opts.parent[0],
          boundryNodeRect = boundryNode.getBoundingClientRect();

      var originNode = opts.target[0].querySelector('[md-menu-origin]') || opts.target[0],
          originNodeRect = originNode.getBoundingClientRect();


      var bounds = {
        left: boundryNodeRect.left + MENU_EDGE_MARGIN,
        top: boundryNodeRect.top + MENU_EDGE_MARGIN,
        bottom: boundryNodeRect.bottom - MENU_EDGE_MARGIN,
        right: boundryNodeRect.right - MENU_EDGE_MARGIN
      };


      var alignTarget, alignTargetRect, existingOffsets;
      var positionMode = opts.mdMenuCtrl.positionMode();

      if (positionMode.top == 'target' || positionMode.left == 'target' || positionMode.left == 'target-right') {
        // TODO: Allow centering on an arbitrary node, for now center on first menu-item's child
        alignTarget = openMenuNode.firstElementChild.firstElementChild || openMenuNode.firstElementChild;
        alignTarget = alignTarget.querySelector('[md-menu-align-target]') || alignTarget;
        alignTargetRect = alignTarget.getBoundingClientRect();

        existingOffsets = {
          top: parseFloat(containerNode.style.top || 0),
          left: parseFloat(containerNode.style.left || 0)
        };
      }

      var position = { };
      var transformOrigin = 'top ';

      switch (positionMode.top) {
        case 'target':
          position.top = existingOffsets.top + originNodeRect.top - alignTargetRect.top;
          break;
        // Future support for mdMenuBar
        // case 'top':
        //   position.top = originNodeRect.top;
        //   break;
        // case 'bottom':
        //   position.top = originNodeRect.top + originNodeRect.height;
        //   break;
        default:
          throw new Error('Invalid target mode "' + positionMode.top + '" specified for md-menu on Y axis.');
      }

      switch (positionMode.left) {
        case 'target':
          position.left = existingOffsets.left + originNodeRect.left - alignTargetRect.left;
          transformOrigin += 'left';
          break;
        case 'target-right':
          position.left = originNodeRect.right - openMenuNodeRect.width + (openMenuNodeRect.right - alignTargetRect.right);
          transformOrigin += 'right';
          break;
        // Future support for mdMenuBar
        // case 'left':
        //   position.left = originNodeRect.left;
        //   transformOrigin += 'left';
        //   break;
        // case 'right':
        //   position.left = originNodeRect.right - containerNode.offsetWidth;
        //   transformOrigin += 'right';
        //   break;
        default:
          throw new Error('Invalid target mode "' + positionMode.left + '" specified for md-menu on X axis.');
      }

      var offsets = opts.mdMenuCtrl.offsets();
      position.top += offsets.top;
      position.left += offsets.left;

      clamp(position);

      el.css({
        top: position.top + 'px',
        left: position.left + 'px'
      });

      containerNode.style[$mdConstant.CSS.TRANSFORM_ORIGIN] = transformOrigin;

      // Animate a scale out if we aren't just repositioning
      if (!opts.alreadyOpen) {
        containerNode.style[$mdConstant.CSS.TRANSFORM] = 'scale(' +
          Math.min(originNodeRect.width / containerNode.offsetWidth, 1.0) + ',' +
          Math.min(originNodeRect.height / containerNode.offsetHeight, 1.0) +
        ')';
      }

      /**
       * Clamps the repositioning of the menu within the confines of
       * bounding element (often the screen/body)
       */
      function clamp(pos) {
        pos.top = Math.max(Math.min(pos.top, bounds.bottom - containerNode.offsetHeight), bounds.top);
        pos.left = Math.max(Math.min(pos.left, bounds.right - containerNode.offsetWidth), bounds.left);
      }
    }
  }
}
MenuProvider.$inject = ["$$interimElementProvider"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.progressCircular
 * @description Circular Progress module!
 */
angular.module('material.components.progressCircular', [
  'material.core'
])
  .directive('mdProgressCircular', MdProgressCircularDirective);

/**
 * @ngdoc directive
 * @name mdProgressCircular
 * @module material.components.progressCircular
 * @restrict E
 *
* @description
 * The circular progress directive is used to make loading content in your app as delightful and
 * painless as possible by minimizing the amount of visual change a user sees before they can view
 * and interact with content.
 *
 * For operations where the percentage of the operation completed can be determined, use a
 * determinate indicator. They give users a quick sense of how long an operation will take.
 *
 * For operations where the user is asked to wait a moment while something finishes up, and it’s
 * not necessary to expose what's happening behind the scenes and how long it will take, use an
 * indeterminate indicator.
 *
 * @param {string} md-mode Select from one of two modes: determinate and indeterminate.
 * @param {number=} value In determinate mode, this number represents the percentage of the
 *     circular progress. Default: 0
 * @param {number=} md-diameter This specifies the diamter of the circular progress. Default: 48
 *
 * @usage
 * <hljs lang="html">
 * <md-progress-circular md-mode="determinate" value="..."></md-progress-circular>
 *
 * <md-progress-circular md-mode="determinate" ng-value="..."></md-progress-circular>
 *
 * <md-progress-circular md-mode="determinate" value="..." md-diameter="100"></md-progress-circular>
 *
 * <md-progress-circular md-mode="indeterminate"></md-progress-circular>
 * </hljs>
 */
function MdProgressCircularDirective($mdConstant, $mdTheming) {
  return {
    restrict: 'E',
    template:
        // The progress 'circle' is composed of two half-circles: the left side and the right
        // side. Each side has CSS applied to 'fill-in' the half-circle to the appropriate progress.
        '<div class="md-spinner-wrapper">' +
          '<div class="md-inner">' +
            '<div class="md-gap"></div>' +
            '<div class="md-left">' +
              '<div class="md-half-circle"></div>' +
            '</div>' +
            '<div class="md-right">' +
              '<div class="md-half-circle"></div>' +
            '</div>' +
          '</div>' +
        '</div>',
    compile: compile
  };

  function compile(tElement) {
    // The javascript in this file is mainly responsible for setting the correct aria attributes.
    // The animation of the progress spinner is done entirely with just CSS.
    tElement.attr('aria-valuemin', 0);
    tElement.attr('aria-valuemax', 100);
    tElement.attr('role', 'progressbar');

    return postLink;
  }

  function postLink(scope, element, attr) {
    $mdTheming(element);
    var circle = element[0];

    // Scale the progress circle based on the default diameter.
    var diameter = attr.mdDiameter || 48;
    var scale = diameter / 48;
    circle.style[$mdConstant.CSS.TRANSFORM] = 'scale(' + scale + ')';

    attr.$observe('value', function(value) {
      var percentValue = clamp(value);
      element.attr('aria-valuenow', percentValue);
    });
  }

  /**
   * Clamps the value to be between 0 and 100.
   * @param {number} value The value to clamp.
   * @returns {number}
   */
  function clamp(value) {
    return Math.max(0, Math.min(value || 0, 100));
  }
}
MdProgressCircularDirective.$inject = ["$mdConstant", "$mdTheming"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.progressLinear
 * @description Linear Progress module!
 */
angular.module('material.components.progressLinear', [
  'material.core'
])
  .directive('mdProgressLinear', MdProgressLinearDirective);

/**
 * @ngdoc directive
 * @name mdProgressLinear
 * @module material.components.progressLinear
 * @restrict E
 *
 * @description
 * The linear progress directive is used to make loading content in your app as delightful and painless as possible by minimizing the amount of visual change a user sees before they can view and interact with content. Each operation should only be represented by one activity indicator—for example, one refresh operation should not display both a refresh bar and an activity circle.
 *
 * For operations where the percentage of the operation completed can be determined, use a determinate indicator. They give users a quick sense of how long an operation will take.
 *
 * For operations where the user is asked to wait a moment while something finishes up, and it’s not necessary to expose what's happening behind the scenes and how long it will take, use an indeterminate indicator.
 *
 * @param {string} md-mode Select from one of four modes: determinate, indeterminate, buffer or query.
 * @param {number=} value In determinate and buffer modes, this number represents the percentage of the primary progress bar. Default: 0
 * @param {number=} md-buffer-value In the buffer mode, this number represents the precentage of the secondary progress bar. Default: 0
 *
 * @usage
 * <hljs lang="html">
 * <md-progress-linear md-mode="determinate" value="..."></md-progress-linear>
 *
 * <md-progress-linear md-mode="determinate" ng-value="..."></md-progress-linear>
 *
 * <md-progress-linear md-mode="indeterminate"></md-progress-linear>
 *
 * <md-progress-linear md-mode="buffer" value="..." md-buffer-value="..."></md-progress-linear>
 *
 * <md-progress-linear md-mode="query"></md-progress-linear>
 * </hljs>
 */
function MdProgressLinearDirective($$rAF, $mdConstant, $mdTheming) {

  return {
    restrict: 'E',
    template: '<div class="md-container">' +
      '<div class="md-dashed"></div>' +
      '<div class="md-bar md-bar1"></div>' +
      '<div class="md-bar md-bar2"></div>' +
      '</div>',
    compile: compile
  };
  
  function compile(tElement, tAttrs, transclude) {
    tElement.attr('aria-valuemin', 0);
    tElement.attr('aria-valuemax', 100);
    tElement.attr('role', 'progressbar');

    return postLink;
  }
  function postLink(scope, element, attr) {
    $mdTheming(element);
    var bar1Style = element[0].querySelector('.md-bar1').style,
      bar2Style = element[0].querySelector('.md-bar2').style,
      container = angular.element(element[0].querySelector('.md-container'));

    attr.$observe('value', function(value) {
      if (attr.mdMode == 'query') {
        return;
      }

      var clamped = clamp(value);
      element.attr('aria-valuenow', clamped);
      bar2Style[$mdConstant.CSS.TRANSFORM] = transforms[clamped];
    });

    attr.$observe('mdBufferValue', function(value) {
      bar1Style[$mdConstant.CSS.TRANSFORM] = transforms[clamp(value)];
    });

    $$rAF(function() {
      container.addClass('md-ready');
    });
  }

  function clamp(value) {
    if (value > 100) {
      return 100;
    }

    if (value < 0) {
      return 0;
    }

    return Math.ceil(value || 0);
  }
}
MdProgressLinearDirective.$inject = ["$$rAF", "$mdConstant", "$mdTheming"];


// **********************************************************
// Private Methods
// **********************************************************
var transforms = (function() {
  var values = new Array(101);
  for(var i = 0; i < 101; i++){
    values[i] = makeTransform(i);
  }

  return values;

  function makeTransform(value){
    var scale = value/100;
    var translateX = (value-100)/2;
    return 'translateX(' + translateX.toString() + '%) scale(' + scale.toString() + ', 1)';
  }
})();

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.radioButton
 * @description radioButton module!
 */
angular.module('material.components.radioButton', [
  'material.core'
])
  .directive('mdRadioGroup', mdRadioGroupDirective)
  .directive('mdRadioButton', mdRadioButtonDirective);

/**
 * @ngdoc directive
 * @module material.components.radioButton
 * @name mdRadioGroup
 *
 * @restrict E
 *
 * @description
 * The `<md-radio-group>` directive identifies a grouping
 * container for the 1..n grouped radio buttons; specified using nested
 * `<md-radio-button>` tags.
 *
 * As per the [material design spec](http://www.google.com/design/spec/style/color.html#color-ui-color-application)
 * the radio button is in the accent color by default. The primary color palette may be used with
 * the `md-primary` class.
 *
 * Note: `<md-radio-group>` and `<md-radio-button>` handle tabindex differently
 * than the native `<input type='radio'>` controls. Whereas the native controls
 * force the user to tab through all the radio buttons, `<md-radio-group>`
 * is focusable, and by default the `<md-radio-button>`s are not.
 *
 * @param {string} ng-model Assignable angular expression to data-bind to.
 * @param {boolean=} md-no-ink Use of attribute indicates flag to disable ink ripple effects.
 *
 * @usage
 * <hljs lang="html">
 * <md-radio-group ng-model="selected">
 *
 *   <md-radio-button
 *        ng-repeat="d in colorOptions"
 *        ng-value="d.value" aria-label="{{ d.label }}">
 *
 *          {{ d.label }}
 *
 *   </md-radio-button>
 *
 * </md-radio-group>
 * </hljs>
 *
 */
function mdRadioGroupDirective($mdUtil, $mdConstant, $mdTheming, $timeout) {
  RadioGroupController.prototype = createRadioGroupControllerProto();

  return {
    restrict: 'E',
    controller: ['$element', RadioGroupController],
    require: ['mdRadioGroup', '?ngModel'],
    link: { pre: linkRadioGroup }
  };

  function linkRadioGroup(scope, element, attr, ctrls) {
    $mdTheming(element);
    var rgCtrl = ctrls[0];
    var ngModelCtrl = ctrls[1] || $mdUtil.fakeNgModel();

    function setFocus() {
      if (!element.hasClass('md-focused')) { element.addClass('md-focused'); }
    }

    function keydownListener(ev) {
      var keyCode = ev.which || ev.keyCode;
      switch(keyCode) {
        case $mdConstant.KEY_CODE.LEFT_ARROW:
        case $mdConstant.KEY_CODE.UP_ARROW:
          ev.preventDefault();
          rgCtrl.selectPrevious();
          setFocus();
          break;

        case $mdConstant.KEY_CODE.RIGHT_ARROW:
        case $mdConstant.KEY_CODE.DOWN_ARROW:
          ev.preventDefault();
          rgCtrl.selectNext();
          setFocus();
          break;

        case $mdConstant.KEY_CODE.ENTER:
          var form = angular.element($mdUtil.getClosest(element[0], 'form'));
          if (form.length > 0) {
            form.triggerHandler('submit');
          }
          break;
      }
    }

    rgCtrl.init(ngModelCtrl);

    scope.mouseActive = false;
    element.attr({
              'role': 'radiogroup',
              'tabIndex': element.attr('tabindex') || '0'
            })
            .on('keydown', keydownListener)
            .on('mousedown', function(event) {
              scope.mouseActive = true;
              $timeout(function() {
                scope.mouseActive = false;
              }, 100);
            })
            .on('focus', function() {
              if(scope.mouseActive === false) { rgCtrl.$element.addClass('md-focused'); }
            })
            .on('blur', function() { rgCtrl.$element.removeClass('md-focused'); });
  }

  function RadioGroupController($element) {
    this._radioButtonRenderFns = [];
    this.$element = $element;
  }

  function createRadioGroupControllerProto() {
    return {
      init: function(ngModelCtrl) {
        this._ngModelCtrl = ngModelCtrl;
        this._ngModelCtrl.$render = angular.bind(this, this.render);
      },
      add: function(rbRender) {
        this._radioButtonRenderFns.push(rbRender);
      },
      remove: function(rbRender) {
        var index = this._radioButtonRenderFns.indexOf(rbRender);
        if (index !== -1) {
          this._radioButtonRenderFns.splice(index, 1);
        }
      },
      render: function() {
        this._radioButtonRenderFns.forEach(function(rbRender) {
          rbRender();
        });
      },
      setViewValue: function(value, eventType) {
        this._ngModelCtrl.$setViewValue(value, eventType);
        // update the other radio buttons as well
        this.render();
      },
      getViewValue: function() {
        return this._ngModelCtrl.$viewValue;
      },
      selectNext: function() {
        return changeSelectedButton(this.$element, 1);
      },
      selectPrevious: function() {
        return changeSelectedButton(this.$element, -1);
      },
      setActiveDescendant: function (radioId) {
        this.$element.attr('aria-activedescendant', radioId);
      }
    };
  }
  /**
   * Change the radio group's selected button by a given increment.
   * If no button is selected, select the first button.
   */
  function changeSelectedButton(parent, increment) {
    // Coerce all child radio buttons into an array, then wrap then in an iterator
    var buttons = $mdUtil.iterator(parent[0].querySelectorAll('md-radio-button'), true);

    if (buttons.count()) {
      var validate = function (button) {
        // If disabled, then NOT valid
        return !angular.element(button).attr("disabled");
      };
      var selected = parent[0].querySelector('md-radio-button.md-checked');
      var target = buttons[increment < 0 ? 'previous' : 'next'](selected, validate) || buttons.first();
      // Activate radioButton's click listener (triggerHandler won't create a real click event)
      angular.element(target).triggerHandler('click');


    }
  }

}
mdRadioGroupDirective.$inject = ["$mdUtil", "$mdConstant", "$mdTheming", "$timeout"];

/**
 * @ngdoc directive
 * @module material.components.radioButton
 * @name mdRadioButton
 *
 * @restrict E
 *
 * @description
 * The `<md-radio-button>`directive is the child directive required to be used within `<md-radio-group>` elements.
 *
 * While similar to the `<input type="radio" ng-model="" value="">` directive,
 * the `<md-radio-button>` directive provides ink effects, ARIA support, and
 * supports use within named radio groups.
 *
 * @param {string} ngModel Assignable angular expression to data-bind to.
 * @param {string=} ngChange Angular expression to be executed when input changes due to user
 *    interaction with the input element.
 * @param {string} ngValue Angular expression which sets the value to which the expression should
 *    be set when selected.*
 * @param {string} value The value to which the expression should be set when selected.
 * @param {string=} name Property name of the form under which the control is published.
 * @param {string=} aria-label Adds label to radio button for accessibility.
 * Defaults to radio button's text. If no text content is available, a warning will be logged.
 *
 * @usage
 * <hljs lang="html">
 *
 * <md-radio-button value="1" aria-label="Label 1">
 *   Label 1
 * </md-radio-button>
 *
 * <md-radio-button ng-model="color" ng-value="specialValue" aria-label="Green">
 *   Green
 * </md-radio-button>
 *
 * </hljs>
 *
 */
function mdRadioButtonDirective($mdAria, $mdUtil, $mdTheming) {

  var CHECKED_CSS = 'md-checked';

  return {
    restrict: 'E',
    require: '^mdRadioGroup',
    transclude: true,
    template: '<div class="md-container" md-ink-ripple md-ink-ripple-checkbox>' +
                '<div class="md-off"></div>' +
                '<div class="md-on"></div>' +
              '</div>' +
              '<div ng-transclude class="md-label"></div>',
    link: link
  };

  function link(scope, element, attr, rgCtrl) {
    var lastChecked;

    $mdTheming(element);
    configureAria(element, scope);

    rgCtrl.add(render);
    attr.$observe('value', render);

    element
      .on('click', listener)
      .on('$destroy', function() {
        rgCtrl.remove(render);
      });

    function listener(ev) {
      if (element[0].hasAttribute('disabled')) return;

      scope.$apply(function() {
        rgCtrl.setViewValue(attr.value, ev && ev.type);
      });
    }

    function render() {
      var checked = (rgCtrl.getViewValue() == attr.value);
      if (checked === lastChecked) {
        return;
      }
      lastChecked = checked;
      element.attr('aria-checked', checked);
      if (checked) {
        element.addClass(CHECKED_CSS);
        rgCtrl.setActiveDescendant(element.attr('id'));
      } else {
        element.removeClass(CHECKED_CSS);
      }
    }
    /**
     * Inject ARIA-specific attributes appropriate for each radio button
     */
    function configureAria( element, scope ){
      scope.ariaId = buildAriaID();

      element.attr({
        'id' :  scope.ariaId,
        'role' : 'radio',
        'aria-checked' : 'false'
      });

      $mdAria.expectWithText(element, 'aria-label');

      /**
       * Build a unique ID for each radio button that will be used with aria-activedescendant.
       * Preserve existing ID if already specified.
       * @returns {*|string}
       */
      function buildAriaID() {
        return attr.id || ( 'radio' + "_" + $mdUtil.nextUid() );
      }
    }
  }
}
mdRadioButtonDirective.$inject = ["$mdAria", "$mdUtil", "$mdTheming"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.select
 */

/***************************************************

### TODO ###
**DOCUMENTATION AND DEMOS**

- [ ] ng-model with child mdOptions (basic)
- [ ] ng-model="foo" ng-model-options="{ trackBy: '$value.id' }" for objects
- [ ] mdOption with value
- [ ] Usage with input inside

### TODO - POST RC1 ###
- [ ] Abstract placement logic in $mdSelect service to $mdMenu service

***************************************************/

var SELECT_EDGE_MARGIN = 8;
var selectNextId = 0;

angular.module('material.components.select', [
  'material.core',
  'material.components.backdrop'
])
.directive('mdSelect', SelectDirective)
.directive('mdSelectMenu', SelectMenuDirective)
.directive('mdOption', OptionDirective)
.directive('mdOptgroup', OptgroupDirective)
.provider('$mdSelect', SelectProvider);


/**
 * @ngdoc directive
 * @name mdSelect
 * @restrict E
 * @module material.components.select
 *
 * @description Displays a select box, bound to an ng-model.
 *
 * @param {expression} ng-model The model!
 * @param {expression=} md-on-close expression to be evaluated when the select is closed
 * @param {boolean=} multiple Whether it's multiple.
 * @param {string=} placeholder Placeholder hint text.
 * @param {string=} aria-label Optional label for accessibility. Only necessary if no placeholder or
 * explicit label is present.
 *
 * @usage
 * With a placeholder (label and aria-label are added dynamically)
 * <hljs lang="html">
 *   <md-select
 *     ng-model="someModel"
 *     placeholder="Select a state">
 *     <md-option ng-value="opt" ng-repeat="opt in neighborhoods2">{{ opt }}</md-option>
 *   </md-select>
 * </hljs>
 *
 * With an explicit label
 * <hljs lang="html">
 *   <md-select
 *     ng-model="someModel">
 *     <md-select-label>Select a state</md-select-label>
 *     <md-option ng-value="opt" ng-repeat="opt in neighborhoods2">{{ opt }}</md-option>
 *   </md-select>
 * </hljs>
 */
function SelectDirective($mdSelect, $mdUtil, $mdTheming, $mdAria, $interpolate, $compile, $parse) {
  return {
    restrict: 'E',
    require: ['mdSelect', 'ngModel', '?^form'],
    compile: compile,
    controller: function() { } // empty placeholder controller to be initialized in link
  };

  function compile(element, attr) {
    // The user is allowed to provide a label for the select as md-select-label child
    var labelEl = element.find('md-select-label').remove();

    // If not provided, we automatically make one
    if (!labelEl.length) {
      labelEl = angular.element('<md-select-label><span></span></md-select-label>');
    } else {
      if (!labelEl[0].firstElementChild) {
        var spanWrapper = angular.element('<span>');
        spanWrapper.append(labelEl.contents());
        labelEl.append(spanWrapper);
      }
    }
    labelEl.append('<span class="md-select-icon" aria-hidden="true"></span>');
    labelEl.addClass('md-select-label');
    if (!labelEl[0].hasAttribute('id')) {
      labelEl.attr('id', 'select_label_' + $mdUtil.nextUid());
    }

    // There's got to be an md-content inside. If there's not one, let's add it.
    if (!element.find('md-content').length) {
      element.append( angular.element('<md-content>').append(element.contents()) );
    }

    // Add progress spinner for md-options-loading
    if (attr.mdOnOpen) {
      element.find('md-content').prepend(
        angular.element('<md-progress-circular>')
               .attr('md-mode', 'indeterminate')
               .attr('ng-hide', '$$loadingAsyncDone')
               .wrap('<div>')
               .parent()
      );
    }

    if (attr.name) {
      var autofillClone = angular.element('<select class="md-visually-hidden">');
      autofillClone.attr({
        'name': '.' + attr.name,
        'ng-model': attr.ngModel,
        'aria-hidden': 'true',
        'tabindex': '-1'
      });
      var opts = element.find('md-option');
      angular.forEach(opts, function(el) {
        var newEl = angular.element('<option>' + el.innerHTML + '</option>');
        if (el.hasAttribute('ng-value')) newEl.attr('ng-value', el.getAttribute('ng-value'));
        else if (el.hasAttribute('value')) newEl.attr('value', el.getAttribute('value'));
        autofillClone.append(newEl);
      });

      element.parent().append(autofillClone);
    }

    // Use everything that's left inside element.contents() as the contents of the menu
    var selectTemplate = '<div class="md-select-menu-container">' +
        '<md-select-menu ' +
        (angular.isDefined(attr.multiple) ? 'multiple' : '') + '>' +
          element.html() +
        '</md-select-menu></div>';

    element.empty().append(labelEl);

    attr.tabindex = attr.tabindex || '0';

    return function postLink(scope, element, attr, ctrls) {
      var isOpen;
      var isDisabled;

      var mdSelectCtrl = ctrls[0];
      var ngModel = ctrls[1];
      var formCtrl = ctrls[2];

      var labelEl = element.find('md-select-label');
      var customLabel = labelEl.text().length !== 0;
      var selectContainer, selectScope, selectMenuCtrl;
      createSelect();

      $mdTheming(element);

      if (attr.name && formCtrl) {
        var selectEl = element.parent()[0].querySelector('select[name=".' + attr.name + '"]');
        formCtrl.$removeControl(angular.element(selectEl).controller());
      }

      var originalRender = ngModel.$render;
      ngModel.$render = function() {
        originalRender();
        syncLabelText();
      };

      mdSelectCtrl.setLabelText = function(text) {
        if (customLabel) return; // Assume that user is handling it on their own
        mdSelectCtrl.setIsPlaceholder(!text);
        text = text || attr.placeholder || '';
        var target = customLabel ? labelEl : labelEl.children().eq(0);
        target.text(text);
      };

      mdSelectCtrl.setIsPlaceholder = function(val) {
        val ? labelEl.addClass('md-placeholder') : labelEl.removeClass('md-placeholder');
      };

      mdSelectCtrl.triggerClose = function() {
        $parse(attr.mdOnClose)(scope);
      };

      scope.$$postDigest(function() {
        setAriaLabel();
        syncLabelText();
      });

      function setAriaLabel() {
        var labelText = element.attr('placeholder');
        if (!labelText) {
          labelText = element.find('md-select-label').text();
        }
        $mdAria.expect(element, 'aria-label', labelText);
      }

      function syncLabelText() {
        if (selectContainer) {
          selectMenuCtrl = selectMenuCtrl || selectContainer.find('md-select-menu').controller('mdSelectMenu');
          mdSelectCtrl.setLabelText(selectMenuCtrl.selectedLabels());
        }
      }

      var deregisterWatcher;
      attr.$observe('ngMultiple', function(val) {
        if (deregisterWatcher) deregisterWatcher();
        var parser = $parse(val);
        deregisterWatcher = scope.$watch(function() { return parser(scope); }, function(multiple, prevVal) {
          if (multiple === undefined && prevVal === undefined) return; // assume compiler did a good job
          if (multiple) {
            element.attr('multiple', 'multiple');
          } else {
            element.removeAttr('multiple');
          }
          if (selectContainer) {
            selectMenuCtrl.setMultiple(multiple);
            originalRender = ngModel.$render;
            ngModel.$render = function() {
              originalRender();
              syncLabelText();
            };
            selectMenuCtrl.refreshViewValue();
            ngModel.$render();
          }
        });
      });

      attr.$observe('disabled', function(disabled) {
        if (typeof disabled == "string") {
          disabled = true;
        }
        // Prevent click event being registered twice
        if (isDisabled !== undefined && isDisabled === disabled) {
          return;
        }
        isDisabled = disabled;
        if (disabled) {
          element.attr({'tabindex': -1, 'aria-disabled': 'true'});
          element.off('click', openSelect);
          element.off('keydown', handleKeypress);
        } else {
          element.attr({'tabindex': attr.tabindex, 'aria-disabled': 'false'});
          element.on('click', openSelect);
          element.on('keydown', handleKeypress);
        }
      });

      if (!attr.disabled && !attr.ngDisabled) {
        element.attr({'tabindex': attr.tabindex, 'aria-disabled': 'false'});
        element.on('click', openSelect);
        element.on('keydown', handleKeypress);
      }

      var ariaAttrs = {
        role: 'combobox',
        'aria-expanded': 'false'
      };
      if (!element[0].hasAttribute('id')) {
        ariaAttrs.id = 'select_' + $mdUtil.nextUid();
      }
      element.attr(ariaAttrs);

      scope.$on('$destroy', function() {
        if (isOpen) {
          $mdSelect.cancel().then(function() {
            selectContainer.remove();
          });
        } else {
          selectContainer.remove();
        }
      });


      // Create a fake select to find out the label value
      function createSelect() {
        selectContainer = angular.element(selectTemplate);
        var selectEl = selectContainer.find('md-select-menu');
        selectEl.data('$ngModelController', ngModel);
        selectEl.data('$mdSelectController', mdSelectCtrl);
        selectScope = scope.$new();
        selectContainer = $compile(selectContainer)(selectScope);
        selectMenuCtrl = selectContainer.find('md-select-menu').controller('mdSelectMenu');
      }

      function handleKeypress(e) {
        var allowedCodes = [32, 13, 38, 40];
        if (allowedCodes.indexOf(e.keyCode) != -1 ) {
          // prevent page scrolling on interaction
          e.preventDefault();
          openSelect(e);
        } else {
          if (e.keyCode <= 90 && e.keyCode >= 31) {
            e.preventDefault();
            var node = selectMenuCtrl.optNodeForKeyboardSearch(e);
            if (!node) return;
            var optionCtrl = angular.element(node).controller('mdOption');
            if (!selectMenuCtrl.isMultiple) {
              selectMenuCtrl.deselect( Object.keys(selectMenuCtrl.selected)[0] );
            }
            selectMenuCtrl.select(optionCtrl.hashKey, optionCtrl.value);
            selectMenuCtrl.refreshViewValue();
            ngModel.$render();
          }
        }
      }

      function openSelect() {
        scope.$evalAsync(function() {
          isOpen = true;
          $mdSelect.show({
            scope: selectScope,
            preserveScope: true,
            skipCompile: true,
            element: selectContainer,
            target: element[0],
            hasBackdrop: true,
            loadingAsync: attr.mdOnOpen ? scope.$eval(attr.mdOnOpen) || true : false,
          }).then(function(selectedText) {
            isOpen = false;
          });
        });
      }
    };
  }
}
SelectDirective.$inject = ["$mdSelect", "$mdUtil", "$mdTheming", "$mdAria", "$interpolate", "$compile", "$parse"];

function SelectMenuDirective($parse, $mdUtil, $mdTheming) {

  SelectMenuController.$inject = ["$scope", "$attrs", "$element"];
  return {
    restrict: 'E',
    require: ['mdSelectMenu', '?ngModel'],
    controller: SelectMenuController,
    link: { pre: preLink }
  };

  // We use preLink instead of postLink to ensure that the select is initialized before
  // its child options run postLink.
  function preLink(scope, element, attr, ctrls) {
    var selectCtrl = ctrls[0];
    var ngModel = ctrls[1];

    $mdTheming(element);
    element.on('click', clickListener);
    element.on('keypress', keyListener);
    if (ngModel) selectCtrl.init(ngModel);
    configureAria();

    function configureAria() {
      element.attr({
        'id': 'select_menu_' + $mdUtil.nextUid(),
        'role': 'listbox',
        'aria-multiselectable': (selectCtrl.isMultiple ? 'true' : 'false')
      });
    }

    function keyListener(e) {
      if (e.keyCode == 13 || e.keyCode == 32) {
        clickListener(e);
      }
    }

    function clickListener(ev) {
      var option = $mdUtil.getClosest(ev.target, 'md-option');
      var optionCtrl = option && angular.element(option).data('$mdOptionController');
      if (!option || !optionCtrl) return;

      var optionHashKey = selectCtrl.hashGetter(optionCtrl.value);
      var isSelected = angular.isDefined(selectCtrl.selected[optionHashKey]);

      scope.$apply(function() {
        if (selectCtrl.isMultiple) {
          if (isSelected) {
            selectCtrl.deselect(optionHashKey);
          } else {
            selectCtrl.select(optionHashKey, optionCtrl.value);
          }
        } else {
          if (!isSelected) {
            selectCtrl.deselect( Object.keys(selectCtrl.selected)[0] );
            selectCtrl.select( optionHashKey, optionCtrl.value );
          }
        }
        selectCtrl.refreshViewValue();
      });
    }
  }



  function SelectMenuController($scope, $attrs, $element) {
    var self = this;
    self.isMultiple = angular.isDefined($attrs.multiple);
    // selected is an object with keys matching all of the selected options' hashed values
    self.selected = {};
    // options is an object with keys matching every option's hash value,
    // and values matching every option's controller.
    self.options = {};

    $scope.$watch(function() { return self.options; }, function() {
      self.ngModel.$render();
    }, true);

    var deregisterCollectionWatch;
    self.setMultiple = function(isMultiple) {
      var ngModel = self.ngModel;
      self.isMultiple = isMultiple;
      if (deregisterCollectionWatch) deregisterCollectionWatch();

      if (self.isMultiple) {
        ngModel.$validators['md-multiple'] = validateArray;
        ngModel.$render = renderMultiple;

        // watchCollection on the model because by default ngModel only watches the model's
        // reference. This allowed the developer to also push and pop from their array.
        $scope.$watchCollection($attrs.ngModel, function(value) {
          if (validateArray(value)) renderMultiple(value);
        });
      } else {
        delete ngModel.$validators['md-multiple'];
        ngModel.$render = renderSingular;
      }

      function validateArray(modelValue, viewValue) {
        // If a value is truthy but not an array, reject it.
        // If value is undefined/falsy, accept that it's an empty array.
        return angular.isArray(modelValue || viewValue || []);
      }
    };

    var searchStr = '';
    var clearSearchTimeout, optNodes, optText;
    var CLEAR_SEARCH_AFTER = 300;
    self.optNodeForKeyboardSearch = function(e) {
      clearSearchTimeout && clearTimeout(clearSearchTimeout);
      clearSearchTimeout = setTimeout(function() {
        clearSearchTimeout = undefined;
        searchStr = '';
        optText = undefined;
        optNodes = undefined;
      }, CLEAR_SEARCH_AFTER);
      searchStr += String.fromCharCode(e.keyCode);
      var search = new RegExp('^' + searchStr, 'i');
      if (!optNodes) {
        optNodes = $element.find('md-option');
        optText = new Array(optNodes.length);
        angular.forEach(optNodes, function(el, i) {
          optText[i] = el.textContent.trim();
        });
      }
      for (var i = 0; i < optText.length; ++i) {
        if (search.test(optText[i])) {
          return optNodes[i];
        }
      }
    };


    self.init = function(ngModel) {
      self.ngModel = ngModel;

      // Allow users to provide `ng-model="foo" ng-model-options="{trackBy: 'foo.id'}"` so
      // that we can properly compare objects set on the model to the available options
      if (ngModel.$options && ngModel.$options.trackBy) {
        var trackByLocals = {};
        var trackByParsed = $parse(ngModel.$options.trackBy);
        self.hashGetter = function(value, valueScope) {
          trackByLocals.$value = value;
          return trackByParsed(valueScope || $scope, trackByLocals);
        };
      // If the user doesn't provide a trackBy, we automatically generate an id for every
      // value passed in
      } else {
        self.hashGetter = function getHashValue(value) {
          if (angular.isObject(value)) {
            return 'object_' + (value.$$mdSelectId || (value.$$mdSelectId = ++selectNextId));
          }
          return value;
        };
      }
      self.setMultiple(self.isMultiple);
    };

    self.selectedLabels = function() {
      var selectedOptionEls = $mdUtil.nodesToArray($element[0].querySelectorAll('md-option[selected]'));
      if (selectedOptionEls.length) {
        return selectedOptionEls.map(function(el) { return el.textContent; }).join(', ');
      } else {
        return '';
      }
    };

    self.select = function(hashKey, hashedValue) {
      var option = self.options[hashKey];
      option && option.setSelected(true);
      self.selected[hashKey] = hashedValue;
    };
    self.deselect = function(hashKey) {
      var option = self.options[hashKey];
      option && option.setSelected(false);
      delete self.selected[hashKey];
    };

    self.addOption = function(hashKey, optionCtrl) {
      if (angular.isDefined(self.options[hashKey])) {
        throw new Error('Duplicate md-option values are not allowed in a select. ' +
                        'Duplicate value "' + optionCtrl.value + '" found.');
      }
      self.options[hashKey] = optionCtrl;

      // If this option's value was already in our ngModel, go ahead and select it.
      if (angular.isDefined(self.selected[hashKey])) {
        self.select(hashKey, optionCtrl.value);
        self.refreshViewValue();
      }
    };
    self.removeOption = function(hashKey) {
      delete self.options[hashKey];
      // Don't deselect an option when it's removed - the user's ngModel should be allowed
      // to have values that do not match a currently available option.
    };

    self.refreshViewValue = function() {
      var values = [];
      var option;
      for (var hashKey in self.selected) {
         // If this hashKey has an associated option, push that option's value to the model.
         if ((option = self.options[hashKey])) {
           values.push(option.value);
         } else {
           // Otherwise, the given hashKey has no associated option, and we got it
           // from an ngModel value at an earlier time. Push the unhashed value of
           // this hashKey to the model.
           // This allows the developer to put a value in the model that doesn't yet have
           // an associated option.
           values.push(self.selected[hashKey]);
         }
      }
      self.ngModel.$setViewValue(self.isMultiple ? values : values[0]);
    };

    function renderMultiple() {
      var newSelectedValues = self.ngModel.$modelValue || self.ngModel.$viewValue;
      if (!angular.isArray(newSelectedValues)) return;

      var oldSelected = Object.keys(self.selected);

      var newSelectedHashes = newSelectedValues.map(self.hashGetter);
      var deselected = oldSelected.filter(function(hash) {
        return newSelectedHashes.indexOf(hash) === -1;
      });

      deselected.forEach(self.deselect);
      newSelectedHashes.forEach(function(hashKey, i) {
        self.select(hashKey, newSelectedValues[i]);
      });
    }
    function renderSingular() {
      var value = self.ngModel.$viewValue || self.ngModel.$modelValue;
      Object.keys(self.selected).forEach(self.deselect);
      self.select( self.hashGetter(value), value );
    }
  }

}
SelectMenuDirective.$inject = ["$parse", "$mdUtil", "$mdTheming"];

function OptionDirective($mdButtonInkRipple, $mdUtil) {

  OptionController.$inject = ["$element"];
  return {
    restrict: 'E',
    require: ['mdOption', '^^mdSelectMenu'],
    controller: OptionController,
    compile: compile
  };

  function compile(element, attr) {
    // Manual transclusion to avoid the extra inner <span> that ng-transclude generates
    element.append( angular.element('<div class="md-text">').append(element.contents()) );

    element.attr('tabindex', attr.tabindex || '0');
    return postLink;
  }

  function postLink(scope, element, attr, ctrls) {
    var optionCtrl = ctrls[0];
    var selectCtrl = ctrls[1];

    if (angular.isDefined(attr.ngValue)) {
      scope.$watch(attr.ngValue, setOptionValue);
    } else if (angular.isDefined(attr.value)) {
      setOptionValue(attr.value);
    } else {
      scope.$watch(function() { return element.text(); }, setOptionValue);
    }

    scope.$$postDigest(function() {
      attr.$observe('selected', function(selected) {
        if (!angular.isDefined(selected)) return;
        if (selected) {
          if (!selectCtrl.isMultiple) {
            selectCtrl.deselect( Object.keys(selectCtrl.selected)[0] );
          }
          selectCtrl.select(optionCtrl.hashKey, optionCtrl.value);
        } else {
          selectCtrl.deselect(optionCtrl.hashKey);
        }
        selectCtrl.refreshViewValue();
        selectCtrl.ngModel.$render();
      });
    });

    $mdButtonInkRipple.attach(scope, element);
    configureAria();

    function setOptionValue(newValue, oldValue) {
      var oldHashKey = selectCtrl.hashGetter(oldValue, scope);
      var newHashKey = selectCtrl.hashGetter(newValue, scope);

      optionCtrl.hashKey = newHashKey;
      optionCtrl.value = newValue;

      selectCtrl.removeOption(oldHashKey, optionCtrl);
      selectCtrl.addOption(newHashKey, optionCtrl);
    }

    scope.$on('$destroy', function() {
      selectCtrl.removeOption(optionCtrl.hashKey, optionCtrl);
    });

    function configureAria() {
      var ariaAttrs = {
        'role': 'option',
        'aria-selected': 'false'
      };

      if (!element[0].hasAttribute('id')) {
        ariaAttrs.id = 'select_option_' + $mdUtil.nextUid();
      }
      element.attr(ariaAttrs);
    }
  }

  function OptionController($element) {
    this.selected = false;
    this.setSelected = function(isSelected) {
      if (isSelected && !this.selected) {
        $element.attr({
          'selected': 'selected',
          'aria-selected': 'true'
        });
      } else if (!isSelected && this.selected) {
        $element.removeAttr('selected');
        $element.attr('aria-selected', 'false');
      }
      this.selected = isSelected;
    };
  }

}
OptionDirective.$inject = ["$mdButtonInkRipple", "$mdUtil"];

function OptgroupDirective() {
  return {
    restrict: 'E',
    compile: compile
  };
  function compile(el, attrs) {
    var labelElement = el.find('label');
    if (!labelElement.length) {
      labelElement = angular.element('<label>');
      el.prepend(labelElement);
    }
    if (attrs.label) labelElement.text(attrs.label);
  }
}

function SelectProvider($$interimElementProvider) {
  selectDefaultOptions.$inject = ["$mdSelect", "$mdConstant", "$$rAF", "$mdUtil", "$mdTheming", "$timeout", "$window"];
  return $$interimElementProvider('$mdSelect')
    .setDefaults({
      methods: ['target'],
      options: selectDefaultOptions
    });

  /* @ngInject */
  function selectDefaultOptions($mdSelect, $mdConstant, $$rAF, $mdUtil, $mdTheming, $timeout, $window ) {
    return {
      parent: 'body',
      onShow: onShow,
      onRemove: onRemove,
      hasBackdrop: true,
      disableParentScroll: true,
      themable: true
    };

    function onShow(scope, element, opts) {
      if (!opts.target) {
        throw new Error('$mdSelect.show() expected a target element in options.target but got ' +
                        '"' + opts.target + '"!');
      }

      angular.extend(opts, {
        isRemoved: false,
        target: angular.element(opts.target), //make sure it's not a naked dom node
        parent: angular.element(opts.parent),
        selectEl: element.find('md-select-menu'),
        contentEl: element.find('md-content'),
        backdrop: opts.hasBackdrop && angular.element('<md-backdrop class="md-select-backdrop md-click-catcher">')
      });

      opts.resizeFn = function() {
        $$rAF(function() {
          $$rAF(function() {
            animateSelect(scope, element, opts);
          });
        });
      };

      angular.element($window).on('resize', opts.resizeFn);
      angular.element($window).on('orientationchange', opts.resizeFn);


      configureAria();

      element.removeClass('md-leave');

      var optionNodes = opts.selectEl[0].getElementsByTagName('md-option');

      if (opts.loadingAsync && opts.loadingAsync.then) {
        opts.loadingAsync.then(function() {
          scope.$$loadingAsyncDone = true;
          // Give ourselves two frames for the progress loader to clear out.
          $$rAF(function() {
            $$rAF(function() {
              // Don't go forward if the select has been removed in this time...
              if (opts.isRemoved) return;
              animateSelect(scope, element, opts);
            });
          });
        });
      } else if (opts.loadingAsync) {
        scope.$$loadingAsyncDone = true;
      }

      if (opts.disableParentScroll && !$mdUtil.getClosest(opts.target, 'MD-DIALOG')) {
        opts.restoreScroll = $mdUtil.disableScrollAround(opts.element);
      } else {
        opts.disableParentScroll = false;
      }
      // Only activate click listeners after a short time to stop accidental double taps/clicks
      // from clicking the wrong item
      $timeout(activateInteraction, 75, false);

      if (opts.backdrop) {
        $mdTheming.inherit(opts.backdrop, opts.parent);
        opts.parent.append(opts.backdrop);
      }
      opts.parent.append(element);

      // Give the select a frame to 'initialize' in the DOM,
      // so we can read its height/width/position
      $$rAF(function() {
        $$rAF(function() {
          if (opts.isRemoved) return;
          animateSelect(scope, element, opts);
        });
      });

      return $mdUtil.transitionEndPromise(opts.selectEl, {timeout: 350});

      function configureAria() {
        opts.target.attr('aria-expanded', 'true');
      }

      function activateInteraction() {
        if (opts.isRemoved) return;
        var selectCtrl = opts.selectEl.controller('mdSelectMenu') || {};
        element.addClass('md-clickable');

        opts.backdrop && opts.backdrop.on('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          opts.restoreFocus = false;
          scope.$apply($mdSelect.cancel);
        });

        // Escape to close
        opts.selectEl.on('keydown', function(ev) {
          switch (ev.keyCode) {
            case $mdConstant.KEY_CODE.SPACE:
            case $mdConstant.KEY_CODE.ENTER:
              var option = $mdUtil.getClosest(ev.target, 'md-option');
              if (option) {
                opts.selectEl.triggerHandler({
                  type: 'click',
                  target: option
                });
                ev.preventDefault();
              }
              break;
            case $mdConstant.KEY_CODE.TAB:
            case $mdConstant.KEY_CODE.ESCAPE:
              ev.preventDefault();
              opts.restoreFocus = true;
              scope.$apply($mdSelect.cancel);
          }
        });

        // Cycling of options, and closing on enter
        opts.selectEl.on('keydown', function(ev) {
          switch (ev.keyCode) {
            case $mdConstant.KEY_CODE.UP_ARROW: return focusPrevOption();
            case $mdConstant.KEY_CODE.DOWN_ARROW: return focusNextOption();
            default:
              if (ev.keyCode >= 31 && ev.keyCode <= 90) {
                var optNode = opts.selectEl.controller('mdSelectMenu').optNodeForKeyboardSearch(ev);
                optNode && optNode.focus();
              }
          }
        });


        function focusOption(direction) {
          var optionsArray = $mdUtil.nodesToArray(optionNodes);
          var index = optionsArray.indexOf(opts.focusedNode);
          if (index === -1) {
            // We lost the previously focused element, reset to first option
            index = 0;
          } else if (direction === 'next' && index < optionsArray.length - 1) {
            index++;
          } else if (direction === 'prev' && index > 0) {
            index--;
          }
          var newOption = opts.focusedNode = optionsArray[index];
          newOption && newOption.focus();
        }
        function focusNextOption() {
          focusOption('next');
        }
        function focusPrevOption() {
          focusOption('prev');
        }

        opts.selectEl.on('click', checkCloseMenu);
        opts.selectEl.on('keydown', function(e) {
          if (e.keyCode == 32 || e.keyCode == 13) {
            checkCloseMenu();
          }
        });

        function checkCloseMenu() {
          if (!selectCtrl.isMultiple) {
            opts.restoreFocus = true;
            scope.$evalAsync(function() {
              $mdSelect.hide(selectCtrl.ngModel.$viewValue);
            });
          }
        }
      }

    }

    function onRemove(scope, element, opts) {
      opts.isRemoved = true;
      element.addClass('md-leave')
        .removeClass('md-clickable');
      opts.target.attr('aria-expanded', 'false');


      angular.element($window).off('resize', opts.resizeFn);
      angular.element($window).off('orientationchange', opts.resizefn);
      opts.resizeFn = undefined;

      var mdSelect = opts.selectEl.controller('mdSelect');
      if (mdSelect) {
        mdSelect.setLabelText(opts.selectEl.controller('mdSelectMenu').selectedLabels());
      }

      return $mdUtil.transitionEndPromise(element, { timeout: 350 }).then(function() {
        element.removeClass('md-active');
        opts.backdrop && opts.backdrop.remove();
        if (element[0].parentNode === opts.parent[0]) {
          opts.parent[0].removeChild(element[0]); // use browser to avoid $destroy event
        }
        if (opts.disableParentScroll) {
          opts.restoreScroll();
        }
        if (opts.restoreFocus) opts.target.focus();
        mdSelect && mdSelect.triggerClose();
      });
    }

    function animateSelect(scope, element, opts) {
      var containerNode = element[0],
          targetNode = opts.target[0].firstElementChild.firstElementChild, // target the first span, functioning as the label
          parentNode = opts.parent[0],
          selectNode = opts.selectEl[0],
          contentNode = opts.contentEl[0],
          parentRect = parentNode.getBoundingClientRect(),
          targetRect = targetNode.getBoundingClientRect(),
          shouldOpenAroundTarget = false,
          bounds = {
            left: parentRect.left + SELECT_EDGE_MARGIN,
            top: SELECT_EDGE_MARGIN,
            bottom: parentRect.height - SELECT_EDGE_MARGIN,
            right: parentRect.width - SELECT_EDGE_MARGIN - ($mdUtil.floatingScrollbars() ? 16 : 0)
          },
          spaceAvailable = {
            top: targetRect.top - bounds.top,
            left: targetRect.left - bounds.left,
            right: bounds.right - (targetRect.left + targetRect.width),
            bottom: bounds.bottom - (targetRect.top + targetRect.height)
          },
          maxWidth = parentRect.width - SELECT_EDGE_MARGIN * 2,
          isScrollable = contentNode.scrollHeight > contentNode.offsetHeight,
          selectedNode = selectNode.querySelector('md-option[selected]'),
          optionNodes = selectNode.getElementsByTagName('md-option'),
          optgroupNodes = selectNode.getElementsByTagName('md-optgroup');


      var centeredNode;
      // If a selected node, center around that
      if (selectedNode) {
        centeredNode = selectedNode;
      // If there are option groups, center around the first option group
      } else if (optgroupNodes.length) {
        centeredNode = optgroupNodes[0];
      // Otherwise, center around the first optionNode
      } else if (optionNodes.length){
        centeredNode = optionNodes[0];
      // In case there are no options, center on whatever's in there... (eg progress indicator)
      } else {
        centeredNode = contentNode.firstElementChild || contentNode;
      }

      if (contentNode.offsetWidth > maxWidth) {
        contentNode.style['max-width'] = maxWidth + 'px';
      }
      if (shouldOpenAroundTarget) {
        contentNode.style['min-width'] = targetRect.width + 'px';
      }

      // Remove padding before we compute the position of the menu
      if (isScrollable) {
        selectNode.classList.add('md-overflow');
      }

      // Get the selectMenuRect *after* max-width is possibly set above
      var selectMenuRect = selectNode.getBoundingClientRect();
      var centeredRect = getOffsetRect(centeredNode);

      if (centeredNode) {
        var centeredStyle = $window.getComputedStyle(centeredNode);
        centeredRect.paddingLeft = parseInt(centeredStyle.paddingLeft, 10) || 0;
        centeredRect.paddingRight = parseInt(centeredStyle.paddingRight, 10) || 0;
      }

      var focusedNode = centeredNode;
      if ((focusedNode.tagName || '').toUpperCase() === 'MD-OPTGROUP') {
        focusedNode = optionNodes[0] || contentNode.firstElementChild || contentNode;
      }

      if (isScrollable) {
        var scrollBuffer = contentNode.offsetHeight / 2;
        contentNode.scrollTop = centeredRect.top + centeredRect.height / 2 - scrollBuffer;

        if (spaceAvailable.top < scrollBuffer) {
          contentNode.scrollTop = Math.min(
            centeredRect.top,
            contentNode.scrollTop + scrollBuffer - spaceAvailable.top
          );
        } else if (spaceAvailable.bottom < scrollBuffer) {
          contentNode.scrollTop = Math.max(
            centeredRect.top + centeredRect.height - selectMenuRect.height,
            contentNode.scrollTop - scrollBuffer + spaceAvailable.bottom
          );
        }
      }

      var left, top, transformOrigin;
      if (shouldOpenAroundTarget) {
        left = targetRect.left;
        top = targetRect.top + targetRect.height;
        transformOrigin = '50% 0';
        if (top + selectMenuRect.height > bounds.bottom) {
          top = targetRect.top - selectMenuRect.height;
          transformOrigin = '50% 100%';
        }
      } else {
        left = targetRect.left + centeredRect.left - centeredRect.paddingLeft;
        top = Math.floor(targetRect.top + targetRect.height / 2 - centeredRect.height / 2 -
          centeredRect.top + contentNode.scrollTop);


        transformOrigin = (centeredRect.left + targetRect.width / 2) + 'px ' +
        (centeredRect.top + centeredRect.height / 2 - contentNode.scrollTop) + 'px 0px';

        containerNode.style.minWidth = targetRect.width + centeredRect.paddingLeft +
          centeredRect.paddingRight + 'px';
      }

      // Keep left and top within the window
      var containerRect = containerNode.getBoundingClientRect();
      containerNode.style.left = clamp(bounds.left, left, bounds.right - containerRect.width) + 'px';
      containerNode.style.top = clamp(bounds.top, top, bounds.bottom - containerRect.height) + 'px';
      selectNode.style[$mdConstant.CSS.TRANSFORM_ORIGIN] = transformOrigin;

      selectNode.style[$mdConstant.CSS.TRANSFORM] = 'scale(' +
        Math.min(targetRect.width / selectMenuRect.width, 1.0) + ',' +
        Math.min(targetRect.height / selectMenuRect.height, 1.0) +
      ')';


      $$rAF(function() {
        element.addClass('md-active');
        selectNode.style[$mdConstant.CSS.TRANSFORM] = '';
        if (focusedNode) {
          opts.focusedNode = focusedNode;
          focusedNode.focus();
        }
      });
    }

  }

  function clamp(min, n, max) {
    return Math.max(min, Math.min(n, max));
  }

  function getOffsetRect(node) {
    return node ? {
      left: node.offsetLeft,
      top: node.offsetTop,
      width: node.offsetWidth,
      height: node.offsetHeight
    } : { left: 0, top: 0, width: 0, height: 0 };
  }
}
SelectProvider.$inject = ["$$interimElementProvider"];


})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.sidenav
 *
 * @description
 * A Sidenav QP component.
 */
angular.module('material.components.sidenav', [
    'material.core',
    'material.components.backdrop'
  ])
  .factory('$mdSidenav', SidenavService )
  .directive('mdSidenav', SidenavDirective)
  .directive('mdSidenavFocus', SidenavFocusDirective)
  .controller('$mdSidenavController', SidenavController);


/**
 * @private
 * @ngdoc service
 * @name $mdSidenav
 * @module material.components.sidenav
 *
 * @description
 * `$mdSidenav` makes it easy to interact with multiple sidenavs
 * in an app.
 *
 * @usage
 * <hljs lang="js">
 * // Async lookup for sidenav instance; will resolve when the instance is available
 * $mdSidenav(componentId).then(function(instance) {
 *   $log.debug( componentId + "is now ready" );
 * });
 * // Async toggle the given sidenav;
 * // when instance is known ready and lazy lookup is not needed.
 * $mdSidenav(componentId)
 *    .toggle()
 *    .then(function(){
 *      $log.debug('toggled');
 *    });
 * // Async open the given sidenav
 * $mdSidenav(componentId)
 *    .open()
 *    .then(function(){
 *      $log.debug('opened');
 *    });
 * // Async close the given sidenav
 * $mdSidenav(componentId)
 *    .close()
 *    .then(function(){
 *      $log.debug('closed');
 *    });
 * // Sync check to see if the specified sidenav is set to be open
 * $mdSidenav(componentId).isOpen();
 * // Sync check to whether given sidenav is locked open
 * // If this is true, the sidenav will be open regardless of close()
 * $mdSidenav(componentId).isLockedOpen();
 * </hljs>
 */
function SidenavService($mdComponentRegistry, $q) {
  return function(handle) {

    // Lookup the controller instance for the specified sidNav instance
    var self;
    var errorMsg = "SideNav '" + handle + "' is not available!";
    var instance = $mdComponentRegistry.get(handle);

    if(!instance) {
      $mdComponentRegistry.notFoundError(handle);
    }

    return self = {
      // -----------------
      // Sync methods
      // -----------------
      isOpen: function() {
        return instance && instance.isOpen();
      },
      isLockedOpen: function() {
        return instance && instance.isLockedOpen();
      },
      // -----------------
      // Async methods
      // -----------------
      toggle: function() {
        return instance ? instance.toggle() : $q.reject(errorMsg);
      },
      open: function() {
        return instance ? instance.open() : $q.reject(errorMsg);
      },
      close: function() {
        return instance ? instance.close() : $q.reject(errorMsg);
      },
      then : function( callbackFn ) {
        var promise = instance ? $q.when(instance) : waitForInstance();
        return promise.then( callbackFn || angular.noop );
      }
    };

    /**
     * Deferred lookup of component instance using $component registry
     */
    function waitForInstance() {
      return $mdComponentRegistry
                .when(handle)
                .then(function( it ){
                  instance = it;
                  return it;
                });
    }
  };
}
SidenavService.$inject = ["$mdComponentRegistry", "$q"];
/**
 * @ngdoc directive
 * @name mdSidenavFocus
 * @module material.components.sidenav
 *
 * @restrict A
 *
 * @description
 * `$mdSidenavFocus` provides a way to specify the focused element when a sidenav opens.
 * This is completely optional, as the sidenav itself is focused by default.
 *
 * @usage
 * <hljs lang="html">
 * <md-sidenav>
 *   <form>
 *     <md-input-container>
 *       <label for="testInput">Label</label>
 *       <input id="testInput" type="text" md-sidenav-focus>
 *     </md-input-container>
 *   </form>
 * </md-sidenav>
 * </hljs>
 **/
function SidenavFocusDirective() {
  return {
    restrict: 'A',
    require: '^mdSidenav',
    link: function(scope, element, attr, sidenavCtrl) {
      sidenavCtrl.focusElement(element);
    }
  };
}
/**
 * @ngdoc directive
 * @name mdSidenav
 * @module material.components.sidenav
 * @restrict E
 *
 * @description
 *
 * A Sidenav component that can be opened and closed programatically.
 *
 * By default, upon opening it will slide out on top of the main content area.
 *
 * For keyboard and screen reader accessibility, focus is sent to the sidenav wrapper by default.
 * It can be overridden with the `md-sidenav-focus` directive on the child element you want focused.
 *
 * @usage
 * <hljs lang="html">
 * <div layout="row" ng-controller="MyController">
 *   <md-sidenav md-component-id="left" class="md-sidenav-left">
 *     Left Nav!
 *   </md-sidenav>
 *
 *   <md-content>
 *     Center Content
 *     <md-button ng-click="openLeftMenu()">
 *       Open Left Menu
 *     </md-button>
 *   </md-content>
 *
 *   <md-sidenav md-component-id="right"
 *     md-is-locked-open="$mdMedia('min-width: 333px')"
 *     class="md-sidenav-right">
 *     <form>
 *       <md-input-container>
 *         <label for="testInput">Test input</label>
 *         <input id="testInput" type="text"
 *                ng-model="data" md-sidenav-focus>
 *       </md-input-container>
 *     </form>
 *   </md-sidenav>
 * </div>
 * </hljs>
 *
 * <hljs lang="js">
 * var app = angular.module('myApp', ['ngMaterial']);
 * app.controller('MyController', function($scope, $mdSidenav) {
 *   $scope.openLeftMenu = function() {
 *     $mdSidenav('left').toggle();
 *   };
 * });
 * </hljs>
 *
 * @param {expression=} md-is-open A model bound to whether the sidenav is opened.
 * @param {string=} md-component-id componentId to use with $mdSidenav service.
 * @param {expression=} md-is-locked-open When this expression evalutes to true,
 * the sidenav 'locks open': it falls into the content's flow instead
 * of appearing over it. This overrides the `is-open` attribute.
 *
 * The $mdMedia() service is exposed to the is-locked-open attribute, which
 * can be given a media query or one of the `sm`, `gt-sm`, `md`, `gt-md`, `lg` or `gt-lg` presets.
 * Examples:
 *
 *   - `<md-sidenav md-is-locked-open="shouldLockOpen"></md-sidenav>`
 *   - `<md-sidenav md-is-locked-open="$mdMedia('min-width: 1000px')"></md-sidenav>`
 *   - `<md-sidenav md-is-locked-open="$mdMedia('sm')"></md-sidenav>` (locks open on small screens)
 */
function SidenavDirective($timeout, $animate, $parse, $log, $mdMedia, $mdConstant, $compile, $mdTheming, $q, $document) {
  return {
    restrict: 'E',
    scope: {
      isOpen: '=?mdIsOpen'
    },
    controller: '$mdSidenavController',
    compile: function(element) {
      element.addClass('md-closed');
      element.attr('tabIndex', '-1');
      return postLink;
    }
  };

  /**
   * Directive Post Link function...
   */
  function postLink(scope, element, attr, sidenavCtrl) {
    var lastParentOverFlow;
    var triggeringElement = null;
    var promise = $q.when(true);

    var isLockedOpenParsed = $parse(attr.mdIsLockedOpen);
    var isLocked = function() {
      return isLockedOpenParsed(scope.$parent, {
        $media: function(arg) {
          $log.warn("$media is deprecated for is-locked-open. Use $mdMedia instead.");
          return $mdMedia(arg);
        },
        $mdMedia: $mdMedia
      });
    };
    var backdrop = $compile(
      '<md-backdrop class="md-sidenav-backdrop md-opaque ng-enter">'
    )(scope);

    element.on('$destroy', sidenavCtrl.destroy);
    $mdTheming.inherit(backdrop, element);

    scope.$watch(isLocked, updateIsLocked);
    scope.$watch('isOpen', updateIsOpen);


    // Publish special accessor for the Controller instance
    sidenavCtrl.$toggleOpen = toggleOpen;
    sidenavCtrl.focusElement( sidenavCtrl.focusElement() || element );

    /**
     * Toggle the DOM classes to indicate `locked`
     * @param isLocked
     */
    function updateIsLocked(isLocked, oldValue) {
      scope.isLockedOpen = isLocked;
      if (isLocked === oldValue) {
        element.toggleClass('md-locked-open', !!isLocked);
      } else {
        $animate[isLocked ? 'addClass' : 'removeClass'](element, 'md-locked-open');
      }
      backdrop.toggleClass('md-locked-open', !!isLocked);
    }

    /**
     * Toggle the SideNav view and attach/detach listeners
     * @param isOpen
     */
    function updateIsOpen(isOpen) {
      var parent = element.parent();

      parent[isOpen ? 'on' : 'off']('keydown', onKeyDown);
      backdrop[isOpen ? 'on' : 'off']('click', close);

      if ( isOpen ) {
        // Capture upon opening..
        triggeringElement = $document[0].activeElement;
      }
      var focusEl = sidenavCtrl.focusElement();

      disableParentScroll(isOpen);

      return promise = $q.all([
                isOpen ? $animate.enter(backdrop, parent) : $animate.leave(backdrop),
                $animate[isOpen ? 'removeClass' : 'addClass'](element, 'md-closed')
              ])
              .then(function() {
                // Perform focus when animations are ALL done...
                if (scope.isOpen) {
                  focusEl && focusEl.focus();
                }
              });
    }

    /**
     * Prevent parent scrolling (when the SideNav is open)
     */
    function disableParentScroll(disabled) {
      var parent = element.parent();
      if ( disabled ) {
        lastParentOverFlow = parent.css('overflow');
        parent.css('overflow', 'hidden');
      } else if (angular.isDefined(lastParentOverFlow)) {
        parent.css('overflow', lastParentOverFlow);
        lastParentOverFlow = undefined;
      }
    }

    /**
     * Toggle the sideNav view and publish a promise to be resolved when
     * the view animation finishes.
     *
     * @param isOpen
     * @returns {*}
     */
    function toggleOpen( isOpen ) {
      if (scope.isOpen == isOpen ) {

        return $q.when(true);

      } else {
        var deferred = $q.defer();

        // Toggle value to force an async `updateIsOpen()` to run
        scope.isOpen = isOpen;

        $timeout(function() {

          // When the current `updateIsOpen()` animation finishes
          promise.then(function(result) {

            if ( !scope.isOpen ) {
              // reset focus to originating element (if available) upon close
              triggeringElement && triggeringElement.focus();
              triggeringElement = null;
            }

            deferred.resolve(result);
          });

        },0,false);

        return deferred.promise;
      }
    }

    /**
     * Auto-close sideNav when the `escape` key is pressed.
     * @param evt
     */
    function onKeyDown(ev) {
      var isEscape = (ev.keyCode === $mdConstant.KEY_CODE.ESCAPE);
      return isEscape ? close(ev) : $q.when(true);
    }

    /**
     * With backdrop `clicks` or `escape` key-press, immediately
     * apply the CSS close transition... Then notify the controller
     * to close() and perform its own actions.
     */
    function close(ev) {
      ev.preventDefault();
      ev.stopPropagation();

      return sidenavCtrl.close();
    }

  }
}
SidenavDirective.$inject = ["$timeout", "$animate", "$parse", "$log", "$mdMedia", "$mdConstant", "$compile", "$mdTheming", "$q", "$document"];

/*
 * @private
 * @ngdoc controller
 * @name SidenavController
 * @module material.components.sidenav
 *
 */
function SidenavController($scope, $element, $attrs, $mdComponentRegistry, $q) {

  var self = this,
      focusElement;

  // Use Default internal method until overridden by directive postLink

  // Synchronous getters
  self.isOpen = function() { return !!$scope.isOpen; };
  self.isLockedOpen = function() { return !!$scope.isLockedOpen; };

  // Async actions
  self.open   = function() { return self.$toggleOpen( true );  };
  self.close  = function() { return self.$toggleOpen( false ); };
  self.toggle = function() { return self.$toggleOpen( !$scope.isOpen );  };
  self.focusElement = function(el) {
    if ( angular.isDefined(el) ) {
      focusElement = el;
    }
    return focusElement;
  };

  self.$toggleOpen = function() { return $q.when($scope.isOpen); };

  self.destroy = $mdComponentRegistry.register(self, $attrs.mdComponentId);
}
SidenavController.$inject = ["$scope", "$element", "$attrs", "$mdComponentRegistry", "$q"];

})();
(function(){
"use strict";

  /**
   * @ngdoc module
   * @name material.components.slider
   */
  angular.module('material.components.slider', [
    'material.core'
  ])
  .directive('mdSlider', SliderDirective);

/**
 * @ngdoc directive
 * @name mdSlider
 * @module material.components.slider
 * @restrict E
 * @description
 * The `<md-slider>` component allows the user to choose from a range of
 * values.
 *
 * As per the [material design spec](http://www.google.com/design/spec/style/color.html#color-ui-color-application)
 * the slider is in the accent color by default. The primary color palette may be used with
 * the `md-primary` class.
 *
 * It has two modes: 'normal' mode, where the user slides between a wide range
 * of values, and 'discrete' mode, where the user slides between only a few
 * select values.
 *
 * To enable discrete mode, add the `md-discrete` attribute to a slider,
 * and use the `step` attribute to change the distance between
 * values the user is allowed to pick.
 *
 * @usage
 * <h4>Normal Mode</h4>
 * <hljs lang="html">
 * <md-slider ng-model="myValue" min="5" max="500">
 * </md-slider>
 * </hljs>
 * <h4>Discrete Mode</h4>
 * <hljs lang="html">
 * <md-slider md-discrete ng-model="myDiscreteValue" step="10" min="10" max="130">
 * </md-slider>
 * </hljs>
 *
 * @param {boolean=} md-discrete Whether to enable discrete mode.
 * @param {number=} step The distance between values the user is allowed to pick. Default 1.
 * @param {number=} min The minimum value the user is allowed to pick. Default 0.
 * @param {number=} max The maximum value the user is allowed to pick. Default 100.
 */
function SliderDirective($$rAF, $window, $mdAria, $mdUtil, $mdConstant, $mdTheming, $mdGesture, $parse) {
  return {
    scope: {},
    require: '?ngModel',
    template:
      '<div class="md-slider-wrapper">\
        <div class="md-track-container">\
          <div class="md-track"></div>\
          <div class="md-track md-track-fill"></div>\
          <div class="md-track-ticks"></div>\
        </div>\
        <div class="md-thumb-container">\
          <div class="md-thumb"></div>\
          <div class="md-focus-thumb"></div>\
          <div class="md-focus-ring"></div>\
          <div class="md-sign">\
            <span class="md-thumb-text"></span>\
          </div>\
          <div class="md-disabled-thumb"></div>\
        </div>\
      </div>',
    compile: compile
  };

  // **********************************************************
  // Private Methods
  // **********************************************************

  function compile (tElement, tAttrs) {
    tElement.attr({
      tabIndex: 0,
      role: 'slider'
    });

    $mdAria.expect(tElement, 'aria-label');

    return postLink;
  }

  function postLink(scope, element, attr, ngModelCtrl) {
    $mdTheming(element);
    ngModelCtrl = ngModelCtrl || {
      // Mock ngModelController if it doesn't exist to give us
      // the minimum functionality needed
      $setViewValue: function(val) {
        this.$viewValue = val;
        this.$viewChangeListeners.forEach(function(cb) { cb(); });
      },
      $parsers: [],
      $formatters: [],
      $viewChangeListeners: []
    };

    var isDisabledParsed = attr.ngDisabled && $parse(attr.ngDisabled);
    var isDisabledGetter = isDisabledParsed ?
      function() { return isDisabledParsed(scope.$parent); } :
      angular.noop;
    var thumb = angular.element(element[0].querySelector('.md-thumb'));
    var thumbText = angular.element(element[0].querySelector('.md-thumb-text'));
    var thumbContainer = thumb.parent();
    var trackContainer = angular.element(element[0].querySelector('.md-track-container'));
    var activeTrack = angular.element(element[0].querySelector('.md-track-fill'));
    var tickContainer = angular.element(element[0].querySelector('.md-track-ticks'));
    var throttledRefreshDimensions = $mdUtil.throttle(refreshSliderDimensions, 5000);

    // Default values, overridable by attrs
    angular.isDefined(attr.min) ? attr.$observe('min', updateMin) : updateMin(0);
    angular.isDefined(attr.max) ? attr.$observe('max', updateMax) : updateMax(100);
    angular.isDefined(attr.step)? attr.$observe('step', updateStep) : updateStep(1);

    // We have to manually stop the $watch on ngDisabled because it exists
    // on the parent scope, and won't be automatically destroyed when
    // the component is destroyed.
    var stopDisabledWatch = angular.noop;
    if (attr.ngDisabled) {
      stopDisabledWatch = scope.$parent.$watch(attr.ngDisabled, updateAriaDisabled);
    }

    $mdGesture.register(element, 'drag');

    element
      .on('keydown', keydownListener)
      .on('$md.pressdown', onPressDown)
      .on('$md.pressup', onPressUp)
      .on('$md.dragstart', onDragStart)
      .on('$md.drag', onDrag)
      .on('$md.dragend', onDragEnd);

    // On resize, recalculate the slider's dimensions and re-render
    function updateAll() {
      refreshSliderDimensions();
      ngModelRender();
      redrawTicks();
    }
    setTimeout(updateAll);

    var debouncedUpdateAll = $$rAF.throttle(updateAll);
    angular.element($window).on('resize', debouncedUpdateAll);

    scope.$on('$destroy', function() {
      angular.element($window).off('resize', debouncedUpdateAll);
      stopDisabledWatch();
    });

    ngModelCtrl.$render = ngModelRender;
    ngModelCtrl.$viewChangeListeners.push(ngModelRender);
    ngModelCtrl.$formatters.push(minMaxValidator);
    ngModelCtrl.$formatters.push(stepValidator);

    /**
     * Attributes
     */
    var min;
    var max;
    var step;
    function updateMin(value) {
      min = parseFloat(value);
      element.attr('aria-valuemin', value);
      updateAll();
    }
    function updateMax(value) {
      max = parseFloat(value);
      element.attr('aria-valuemax', value);
      updateAll();
    }
    function updateStep(value) {
      step = parseFloat(value);
      redrawTicks();
    }
    function updateAriaDisabled(isDisabled) {
      element.attr('aria-disabled', !!isDisabled);
    }

    // Draw the ticks with canvas.
    // The alternative to drawing ticks with canvas is to draw one element for each tick,
    // which could quickly become a performance bottleneck.
    var tickCanvas, tickCtx;
    function redrawTicks() {
      if (!angular.isDefined(attr.mdDiscrete)) return;

      var numSteps = Math.floor( (max - min) / step );
      if (!tickCanvas) {
        var trackTicksStyle = $window.getComputedStyle(tickContainer[0]);
        tickCanvas = angular.element('<canvas style="position:absolute;">');
        tickCtx = tickCanvas[0].getContext('2d');
        tickCtx.fillStyle = trackTicksStyle.backgroundColor || 'black';
        tickContainer.append(tickCanvas);
      }
      var dimensions = getSliderDimensions();
      tickCanvas[0].width = dimensions.width;
      tickCanvas[0].height = dimensions.height;

      var distance;
      for (var i = 0; i <= numSteps; i++) {
        distance = Math.floor(dimensions.width * (i / numSteps));
        tickCtx.fillRect(distance - 1, 0, 2, dimensions.height);
      }
    }


    /**
     * Refreshing Dimensions
     */
    var sliderDimensions = {};
    refreshSliderDimensions();
    function refreshSliderDimensions() {
      sliderDimensions = trackContainer[0].getBoundingClientRect();
    }
    function getSliderDimensions() {
      throttledRefreshDimensions();
      return sliderDimensions;
    }

    /**
     * left/right arrow listener
     */
    function keydownListener(ev) {
      if(element[0].hasAttribute('disabled')) {
        return;
      }

      var changeAmount;
      if (ev.keyCode === $mdConstant.KEY_CODE.LEFT_ARROW) {
        changeAmount = -step;
      } else if (ev.keyCode === $mdConstant.KEY_CODE.RIGHT_ARROW) {
        changeAmount = step;
      }
      if (changeAmount) {
        if (ev.metaKey || ev.ctrlKey || ev.altKey) {
          changeAmount *= 4;
        }
        ev.preventDefault();
        ev.stopPropagation();
        scope.$evalAsync(function() {
          setModelValue(ngModelCtrl.$viewValue + changeAmount);
        });
      }
    }

    /**
     * ngModel setters and validators
     */
    function setModelValue(value) {
      ngModelCtrl.$setViewValue( minMaxValidator(stepValidator(value)) );
    }
    function ngModelRender() {
      if (isNaN(ngModelCtrl.$viewValue)) {
        ngModelCtrl.$viewValue = ngModelCtrl.$modelValue;
      }

      var percent = (ngModelCtrl.$viewValue - min) / (max - min);
      scope.modelValue = ngModelCtrl.$viewValue;
      element.attr('aria-valuenow', ngModelCtrl.$viewValue);
      setSliderPercent(percent);
      thumbText.text( ngModelCtrl.$viewValue );
    }

    function minMaxValidator(value) {
      if (angular.isNumber(value)) {
        return Math.max(min, Math.min(max, value));
      }
    }
    function stepValidator(value) {
      if (angular.isNumber(value)) {
        var formattedValue = (Math.round(value / step) * step);
        // Format to 3 digits after the decimal point - fixes #2015.
        return (Math.round(formattedValue * 1000) / 1000);
      }
    }

    /**
     * @param percent 0-1
     */
    function setSliderPercent(percent) {
      activeTrack.css('width', (percent * 100) + '%');
      thumbContainer.css(
        'left',
        (percent * 100) + '%'
      );
      element.toggleClass('md-min', percent === 0);
    }


    /**
     * Slide listeners
     */
    var isDragging = false;
    var isDiscrete = angular.isDefined(attr.mdDiscrete);

    function onPressDown(ev) {
      if (isDisabledGetter()) return;

      element.addClass('active');
      element[0].focus();
      refreshSliderDimensions();

      var exactVal = percentToValue( positionToPercent( ev.pointer.x ));
      var closestVal = minMaxValidator( stepValidator(exactVal) );
      scope.$apply(function() {
        setModelValue( closestVal );
        setSliderPercent( valueToPercent(closestVal));
      });
    }
    function onPressUp(ev) {
      if (isDisabledGetter()) return;

      element.removeClass('dragging active');

      var exactVal = percentToValue( positionToPercent( ev.pointer.x ));
      var closestVal = minMaxValidator( stepValidator(exactVal) );
      scope.$apply(function() {
        setModelValue(closestVal);
        ngModelRender();
      });
    }
    function onDragStart(ev) {
      if (isDisabledGetter()) return;
      isDragging = true;
      ev.stopPropagation();

      element.addClass('dragging');
      setSliderFromEvent(ev);
    }
    function onDrag(ev) {
      if (!isDragging) return;
      ev.stopPropagation();
      setSliderFromEvent(ev);
    }
    function onDragEnd(ev) {
      if (!isDragging) return;
      ev.stopPropagation();
      isDragging = false;
    }

    function setSliderFromEvent(ev) {
      // While panning discrete, update only the
      // visual positioning but not the model value.
      if ( isDiscrete ) adjustThumbPosition( ev.pointer.x );
      else              doSlide( ev.pointer.x );
    }

    /**
     * Slide the UI by changing the model value
     * @param x
     */
    function doSlide( x ) {
      scope.$evalAsync( function() {
        setModelValue( percentToValue( positionToPercent(x) ));
      });
    }

    /**
     * Slide the UI without changing the model (while dragging/panning)
     * @param x
     */
    function adjustThumbPosition( x ) {
      var exactVal = percentToValue( positionToPercent( x ));
      var closestVal = minMaxValidator( stepValidator(exactVal) );
      setSliderPercent( positionToPercent(x) );
      thumbText.text( closestVal );
    }

    /**
     * Convert horizontal position on slider to percentage value of offset from beginning...
     * @param x
     * @returns {number}
     */
    function positionToPercent( x ) {
      return Math.max(0, Math.min(1, (x - sliderDimensions.left) / (sliderDimensions.width)));
    }

    /**
     * Convert percentage offset on slide to equivalent model value
     * @param percent
     * @returns {*}
     */
    function percentToValue( percent ) {
      return (min + percent * (max - min));
    }

    function valueToPercent( val ) {
      return (val - min)/(max - min);
    }
  }
}
SliderDirective.$inject = ["$$rAF", "$window", "$mdAria", "$mdUtil", "$mdConstant", "$mdTheming", "$mdGesture", "$parse"];

})();
(function(){
"use strict";

/*
 * @ngdoc module
 * @name material.components.sticky
 * @description
 *
 * Sticky effects for md
 */

angular.module('material.components.sticky', [
  'material.core',
  'material.components.content'
])
  .factory('$mdSticky', MdSticky);

/*
 * @ngdoc service
 * @name $mdSticky
 * @module material.components.sticky
 *
 * @description
 * The `$mdSticky`service provides a mixin to make elements sticky.
 *
 * @returns A `$mdSticky` function that takes three arguments:
 *   - `scope`
 *   - `element`: The element that will be 'sticky'
 *   - `elementClone`: A clone of the element, that will be shown
 *     when the user starts scrolling past the original element.
 *     If not provided, it will use the result of `element.clone()`.
 */

function MdSticky($document, $mdConstant, $compile, $$rAF, $mdUtil) {

  var browserStickySupport = checkStickySupport();

  /**
   * Registers an element as sticky, used internally by directives to register themselves
   */
  return function registerStickyElement(scope, element, stickyClone) {
    var contentCtrl = element.controller('mdContent');
    if (!contentCtrl) return;

    if (browserStickySupport) {
      element.css({
        position: browserStickySupport,
        top: 0,
        'z-index': 2
      });
    } else {
      var $$sticky = contentCtrl.$element.data('$$sticky');
      if (!$$sticky) {
        $$sticky = setupSticky(contentCtrl);
        contentCtrl.$element.data('$$sticky', $$sticky);
      }

      var deregister = $$sticky.add(element, stickyClone || element.clone());
      scope.$on('$destroy', deregister);
    }
  };

  function setupSticky(contentCtrl) {
    var contentEl = contentCtrl.$element;

    // Refresh elements is very expensive, so we use the debounced
    // version when possible.
    var debouncedRefreshElements = $$rAF.throttle(refreshElements);

    // setupAugmentedScrollEvents gives us `$scrollstart` and `$scroll`,
    // more reliable than `scroll` on android.
    setupAugmentedScrollEvents(contentEl);
    contentEl.on('$scrollstart', debouncedRefreshElements);
    contentEl.on('$scroll', onScroll);

    var self;
    var stickyBaseoffset = contentEl.prop('offsetTop');
    return self = {
      prev: null,
      current: null, //the currently stickied item
      next: null,
      items: [],
      add: add,
      refreshElements: refreshElements
    };

    /***************
     * Public
     ***************/
    // Add an element and its sticky clone to this content's sticky collection
    function add(element, stickyClone) {
      stickyClone.addClass('md-sticky-clone');
      stickyClone.css('top', stickyBaseoffset + 'px');

      var item = {
        element: element,
        clone: stickyClone
      };
      self.items.push(item);

      contentEl.parent().prepend(item.clone);

      debouncedRefreshElements();

      return function remove() {
        self.items.forEach(function(item, index) {
          if (item.element[0] === element[0]) {
            self.items.splice(index, 1);
            item.clone.remove();
          }
        });
        debouncedRefreshElements();
      };
    }

    function refreshElements() {
      // Sort our collection of elements by their current position in the DOM.
      // We need to do this because our elements' order of being added may not
      // be the same as their order of display.
      self.items.forEach(refreshPosition);
      self.items = self.items.sort(function(a, b) {
        return a.top < b.top ? -1 : 1;
      });

      // Find which item in the list should be active, 
      // based upon the content's current scroll position
      var item;
      var currentScrollTop = contentEl.prop('scrollTop');
      for (var i = self.items.length - 1; i >= 0; i--) {
        if (currentScrollTop > self.items[i].top) {
          item = self.items[i];
          break;
        }
      }
      setCurrentItem(item);
    }


    /***************
     * Private
     ***************/

    // Find the `top` of an item relative to the content element,
    // and also the height.
    function refreshPosition(item) {
      // Find the top of an item by adding to the offsetHeight until we reach the 
      // content element.
      var current = item.element[0];
      item.top = 0;
      item.left = 0;
      while (current && current !== contentEl[0]) {
        item.top += current.offsetTop;
        item.left += current.offsetLeft;
        current = current.offsetParent;
      }
      item.height = item.element.prop('offsetHeight');
      item.clone.css('margin-left', item.left + 'px');
      if ($mdUtil.floatingScrollbars()) {
        item.clone.css('margin-right', '0');
      }
    }


    // As we scroll, push in and select the correct sticky element.
    function onScroll() {
      var scrollTop = contentEl.prop('scrollTop');
      var isScrollingDown = scrollTop > (onScroll.prevScrollTop || 0);
      onScroll.prevScrollTop = scrollTop;

      // At the top?
      if (scrollTop === 0) {
        setCurrentItem(null);

      // Going to next item?
      } else if (isScrollingDown && self.next) {
        if (self.next.top - scrollTop <= 0) {
          // Sticky the next item if we've scrolled past its position.
          setCurrentItem(self.next);
        } else if (self.current) {
          // Push the current item up when we're almost at the next item.
          if (self.next.top - scrollTop <= self.next.height) {
            translate(self.current, self.next.top - self.next.height - scrollTop);
          } else {
            translate(self.current, null);
          }
        }
        
      // Scrolling up with a current sticky item?
      } else if (!isScrollingDown && self.current) {
        if (scrollTop < self.current.top) {
          // Sticky the previous item if we've scrolled up past
          // the original position of the currently stickied item.
          setCurrentItem(self.prev);
        }
        // Scrolling up, and just bumping into the item above (just set to current)?
        // If we have a next item bumping into the current item, translate
        // the current item up from the top as it scrolls into view.
        if (self.current && self.next) {
          if (scrollTop >= self.next.top - self.current.height) {
            translate(self.current, self.next.top - scrollTop - self.current.height);
          } else {
            translate(self.current, null);
          }
        }
      }
    }
     
   function setCurrentItem(item) {
     if (self.current === item) return;
     // Deactivate currently active item
     if (self.current) {
       translate(self.current, null);
       setStickyState(self.current, null);
     }

     // Activate new item if given
     if (item) {
       setStickyState(item, 'active');
     }

     self.current = item;
     var index = self.items.indexOf(item);
     // If index === -1, index + 1 = 0. It works out.
     self.next = self.items[index + 1];
     self.prev = self.items[index - 1];
     setStickyState(self.next, 'next');
     setStickyState(self.prev, 'prev');
   }

   function setStickyState(item, state) {
     if (!item || item.state === state) return;
     if (item.state) {
       item.clone.attr('sticky-prev-state', item.state);
       item.element.attr('sticky-prev-state', item.state);
     }
     item.clone.attr('sticky-state', state);
     item.element.attr('sticky-state', state);
     item.state = state;
   }

   function translate(item, amount) {
     if (!item) return;
     if (amount === null || amount === undefined) {
       if (item.translateY) {
         item.translateY = null;
         item.clone.css($mdConstant.CSS.TRANSFORM, '');
       }
     } else {
       item.translateY = amount;
       item.clone.css(
         $mdConstant.CSS.TRANSFORM, 
         'translate3d(' + item.left + 'px,' + amount + 'px,0)'
       );
     }
   }
  }

  // Function to check for browser sticky support
  function checkStickySupport($el) {
    var stickyProp;
    var testEl = angular.element('<div>');
    $document[0].body.appendChild(testEl[0]);

    var stickyProps = ['sticky', '-webkit-sticky'];
    for (var i = 0; i < stickyProps.length; ++i) {
      testEl.css({position: stickyProps[i], top: 0, 'z-index': 2});
      if (testEl.css('position') == stickyProps[i]) {
        stickyProp = stickyProps[i];
        break;
      }
    }
    testEl.remove();
    return stickyProp;
  }

  // Android 4.4 don't accurately give scroll events.
  // To fix this problem, we setup a fake scroll event. We say:
  // > If a scroll or touchmove event has happened in the last DELAY milliseconds, 
  //   then send a `$scroll` event every animationFrame.
  // Additionally, we add $scrollstart and $scrollend events.
  function setupAugmentedScrollEvents(element) {
    var SCROLL_END_DELAY = 200;
    var isScrolling;
    var lastScrollTime;
    element.on('scroll touchmove', function() {
      if (!isScrolling) {
        isScrolling = true;
        $$rAF(loopScrollEvent);
        element.triggerHandler('$scrollstart');
      }
      element.triggerHandler('$scroll');
      lastScrollTime = +$mdUtil.now();
    });

    function loopScrollEvent() {
      if (+$mdUtil.now() - lastScrollTime > SCROLL_END_DELAY) {
        isScrolling = false;
        element.triggerHandler('$scrollend');
      } else {
        element.triggerHandler('$scroll');
        $$rAF(loopScrollEvent);
      }
    }
  }

}
MdSticky.$inject = ["$document", "$mdConstant", "$compile", "$$rAF", "$mdUtil"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.subheader
 * @description
 * SubHeader module
 *
 *  Subheaders are special list tiles that delineate distinct sections of a
 *  list or grid list and are typically related to the current filtering or
 *  sorting criteria. Subheader tiles are either displayed inline with tiles or
 *  can be associated with content, for example, in an adjacent column.
 *
 *  Upon scrolling, subheaders remain pinned to the top of the screen and remain
 *  pinned until pushed on or off screen by the next subheader. @see [Material
 *  Design Specifications](https://www.google.com/design/spec/components/subheaders.html)
 *
 *  > To improve the visual grouping of content, use the system color for your subheaders.
 *
 */
angular.module('material.components.subheader', [
  'material.core',
  'material.components.sticky'
])
  .directive('mdSubheader', MdSubheaderDirective);

/**
 * @ngdoc directive
 * @name mdSubheader
 * @module material.components.subheader
 *
 * @restrict E
 *
 * @description
 * The `<md-subheader>` directive is a subheader for a section. By default it is sticky.
 * You can make it not sticky by applying the `md-no-sticky` class to the subheader.
 *
 *
 * @usage
 * <hljs lang="html">
 * <md-subheader>Online Friends</md-subheader>
 * </hljs>
 */

function MdSubheaderDirective($mdSticky, $compile, $mdTheming) {
  return {
    restrict: 'E',
    replace: true,
    transclude: true,
    template: 
      '<h2 class="md-subheader">' +
        '<div class="md-subheader-inner">' +
          '<span class="md-subheader-content"></span>' +
        '</div>' +
      '</h2>',
    compile: function(element, attr, transclude) {
      return function postLink(scope, element, attr) {
        $mdTheming(element);
        var outerHTML = element[0].outerHTML;

        function getContent(el) {
          return angular.element(el[0].querySelector('.md-subheader-content'));
        }

        // Transclude the user-given contents of the subheader
        // the conventional way.
        transclude(scope, function(clone) {
          getContent(element).append(clone);
        });

        // Create another clone, that uses the outer and inner contents
        // of the element, that will be 'stickied' as the user scrolls.
        if (!element.hasClass('md-no-sticky')) {
          transclude(scope, function(clone) {
            var stickyClone = $compile(angular.element(outerHTML))(scope);
            getContent(stickyClone).append(clone);
            $mdSticky(scope, element, stickyClone);
          });
        }
      };
    }
  };
}
MdSubheaderDirective.$inject = ["$mdSticky", "$compile", "$mdTheming"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.swipe
 * @description Swipe module!
 */
/**
 * @ngdoc directive
 * @module material.components.swipe
 * @name mdSwipeLeft
 *
 * @restrict A
 *
 * @description
 * The md-swipe-left directives allows you to specify custom behavior when an element is swiped
 * left.
 *
 * @usage
 * <hljs lang="html">
 * <div md-swipe-left="onSwipeLeft()">Swipe me left!</div>
 * </hljs>
 */
/**
 * @ngdoc directive
 * @module material.components.swipe
 * @name mdSwipeRight
 *
 * @restrict A
 *
 * @description
 * The md-swipe-right directives allows you to specify custom behavior when an element is swiped
 * right.
 *
 * @usage
 * <hljs lang="html">
 * <div md-swipe-right="onSwipeRight()">Swipe me right!</div>
 * </hljs>
 */

angular.module('material.components.swipe', ['material.core'])
    .directive('mdSwipeLeft', getDirective('SwipeLeft'))
    .directive('mdSwipeRight', getDirective('SwipeRight'));

function getDirective(name) {
  var directiveName = 'md' + name;
  var eventName = '$md.' + name.toLowerCase();

    DirectiveFactory.$inject = ["$parse"];
  return DirectiveFactory;

  /* @ngInject */
  function DirectiveFactory($parse) {
      return { restrict: 'A', link: postLink };
      function postLink(scope, element, attr) {
        var fn = $parse(attr[directiveName]);
        element.on(eventName, function(ev) {
          scope.$apply(function() { fn(scope, { $event: ev }); });
        });
      }
    }
}



})();
(function(){
"use strict";

/**
 * @private
 * @ngdoc module
 * @name material.components.switch
 */

angular.module('material.components.switch', [
  'material.core',
  'material.components.checkbox'
])
  .directive('mdSwitch', MdSwitch);

/**
 * @private
 * @ngdoc directive
 * @module material.components.switch
 * @name mdSwitch
 * @restrict E
 *
 * The switch directive is used very much like the normal [angular checkbox](https://docs.angularjs.org/api/ng/input/input%5Bcheckbox%5D).
 *
 * As per the [material design spec](http://www.google.com/design/spec/style/color.html#color-ui-color-application)
 * the switch is in the accent color by default. The primary color palette may be used with
 * the `md-primary` class.
 *
 * @param {string} ng-model Assignable angular expression to data-bind to.
 * @param {string=} name Property name of the form under which the control is published.
 * @param {expression=} ng-true-value The value to which the expression should be set when selected.
 * @param {expression=} ng-false-value The value to which the expression should be set when not selected.
 * @param {string=} ng-change Angular expression to be executed when input changes due to user interaction with the input element.
 * @param {boolean=} md-no-ink Use of attribute indicates use of ripple ink effects.
 * @param {string=} aria-label Publish the button label used by screen-readers for accessibility. Defaults to the switch's text.
 *
 * @usage
 * <hljs lang="html">
 * <md-switch ng-model="isActive" aria-label="Finished?">
 *   Finished ?
 * </md-switch>
 *
 * <md-switch md-no-ink ng-model="hasInk" aria-label="No Ink Effects">
 *   No Ink Effects
 * </md-switch>
 *
 * <md-switch ng-disabled="true" ng-model="isDisabled" aria-label="Disabled">
 *   Disabled
 * </md-switch>
 *
 * </hljs>
 */
function MdSwitch(mdCheckboxDirective, $mdTheming, $mdUtil, $document, $mdConstant, $parse, $$rAF, $mdGesture) {
  var checkboxDirective = mdCheckboxDirective[0];

  return {
    restrict: 'E',
    priority:210, // Run before ngAria
    transclude: true,
    template:
      '<div class="md-container">' +
        '<div class="md-bar"></div>' +
        '<div class="md-thumb-container">' +
          '<div class="md-thumb" md-ink-ripple md-ink-ripple-checkbox></div>' +
        '</div>'+
      '</div>' +
      '<div ng-transclude class="md-label">' +
      '</div>',
    require: '?ngModel',
    compile: compile
  };

  function compile(element, attr) {
    var checkboxLink = checkboxDirective.compile(element, attr);
    // no transition on initial load
    element.addClass('md-dragging');

    return function (scope, element, attr, ngModel) {
      ngModel = ngModel || $mdUtil.fakeNgModel();
      var disabledGetter = $parse(attr.ngDisabled);
      var thumbContainer = angular.element(element[0].querySelector('.md-thumb-container'));
      var switchContainer = angular.element(element[0].querySelector('.md-container'));

      // no transition on initial load
      $$rAF(function() {
        element.removeClass('md-dragging');
      });

      checkboxLink(scope, element, attr, ngModel);

      if (angular.isDefined(attr.ngDisabled)) {
        scope.$watch(disabledGetter, function(isDisabled) {
          element.attr('tabindex', isDisabled ? -1 : 0);
        });
      }

      // These events are triggered by setup drag
      $mdGesture.register(switchContainer, 'drag');
      switchContainer
        .on('$md.dragstart', onDragStart)
        .on('$md.drag', onDrag)
        .on('$md.dragend', onDragEnd);

      var drag;
      function onDragStart(ev) {
        // Don't go if ng-disabled===true
        if (disabledGetter(scope)) return;
        ev.stopPropagation();

        element.addClass('md-dragging');
        drag = {
          width: thumbContainer.prop('offsetWidth')
        };
        element.removeClass('transition');
      }

      function onDrag(ev) {
        if (!drag) return;
        ev.stopPropagation();
        ev.srcEvent && ev.srcEvent.preventDefault();

        var percent = ev.pointer.distanceX / drag.width;

        //if checked, start from right. else, start from left
        var translate = ngModel.$viewValue ?  1 + percent : percent;
        // Make sure the switch stays inside its bounds, 0-1%
        translate = Math.max(0, Math.min(1, translate));

        thumbContainer.css($mdConstant.CSS.TRANSFORM, 'translate3d(' + (100*translate) + '%,0,0)');
        drag.translate = translate;
      }

      function onDragEnd(ev) {
        if (!drag) return;
        ev.stopPropagation();

        element.removeClass('md-dragging');
        thumbContainer.css($mdConstant.CSS.TRANSFORM, '');

        // We changed if there is no distance (this is a click a click),
        // or if the drag distance is >50% of the total.
        var isChanged = ngModel.$viewValue ? drag.translate < 0.5 : drag.translate > 0.5;
        if (isChanged) {
          applyModelValue(!ngModel.$viewValue);
        }
        drag = null;
      }

      function applyModelValue(newValue) {
        scope.$apply(function() {
          ngModel.$setViewValue(newValue);
          ngModel.$render();
        });
      }

    };
  }


}
MdSwitch.$inject = ["mdCheckboxDirective", "$mdTheming", "$mdUtil", "$document", "$mdConstant", "$parse", "$$rAF", "$mdGesture"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.tabs
 * @description
 *
 *  Tabs, created with the `<md-tabs>` directive provide *tabbed* navigation with different styles.
 *  The Tabs component consists of clickable tabs that are aligned horizontally side-by-side.
 *
 *  Features include support for:
 *
 *  - static or dynamic tabs,
 *  - responsive designs,
 *  - accessibility support (ARIA),
 *  - tab pagination,
 *  - external or internal tab content,
 *  - focus indicators and arrow-key navigations,
 *  - programmatic lookup and access to tab controllers, and
 *  - dynamic transitions through different tab contents.
 *
 */
/*
 * @see js folder for tabs implementation
 */
angular.module('material.components.tabs', [
  'material.core',
  'material.components.icon'
]);

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.toast
 * @description
 * Toast
 */
angular.module('material.components.toast', [
  'material.core',
  'material.components.button'
])
  .directive('mdToast', MdToastDirective)
  .provider('$mdToast', MdToastProvider);

function MdToastDirective() {
  return {
    restrict: 'E'
  };
}

/**
 * @ngdoc service
 * @name $mdToast
 * @module material.components.toast
 *
 * @description
 * `$mdToast` is a service to build a toast notification on any position
 * on the screen with an optional duration, and provides a simple promise API.
 *
 *
 * ## Restrictions on custom toasts
 * - The toast's template must have an outer `<md-toast>` element.
 * - For a toast action, use element with class `md-action`.
 * - Add the class `md-capsule` for curved corners.
 *
 * @usage
 * <hljs lang="html">
 * <div ng-controller="MyController">
 *   <md-button ng-click="openToast()">
 *     Open a Toast!
 *   </md-button>
 * </div>
 * </hljs>
 *
 * <hljs lang="js">
 * var app = angular.module('app', ['ngMaterial']);
 * app.controller('MyController', function($scope, $mdToast) {
 *   $scope.openToast = function($event) {
 *     $mdToast.show($mdToast.simple().content('Hello!'));
 *     // Could also do $mdToast.showSimple('Hello');
 *   };
 * });
 * </hljs>
 */

/**
 * @ngdoc method
 * @name $mdToast#showSimple
 * 
 * @description
 * Convenience method which builds and shows a simple toast.
 *
 * @returns {promise} A promise that can be resolved with `$mdToast.hide()` or
 * rejected with `$mdToast.cancel()`.
 *
 */

 /**
 * @ngdoc method
 * @name $mdToast#simple
 *
 * @description
 * Builds a preconfigured toast.
 *
 * @returns {obj} a `$mdToastPreset` with the chainable configuration methods:
 *
 * - $mdToastPreset#content(string) - sets toast content to string
 * - $mdToastPreset#action(string) - adds an action button, which resolves the promise returned from `show()` if clicked.
 * - $mdToastPreset#highlightAction(boolean) - sets action button to be highlighted
 * - $mdToastPreset#capsule(boolean) - adds 'md-capsule' class to the toast (curved corners)
 * - $mdToastPreset#theme(string) - sets the theme on the toast to theme (default is `$mdThemingProvider`'s default theme)
 */

/**
 * @ngdoc method
 * @name $mdToast#updateContent
 * 
 * @description
 * Updates the content of an existing toast. Useful for updating things like counts, etc.
 *
 */

 /**
 * @ngdoc method
 * @name $mdToast#build
 *
 * @description
 * Creates a custom `$mdToastPreset` that you can configure.
 *
 * @returns {obj} a `$mdToastPreset` with the chainable configuration methods for shows' options (see below).
 */

 /**
 * @ngdoc method
 * @name $mdToast#show
 *
 * @description Shows the toast.
 *
 * @param {object} optionsOrPreset Either provide an `$mdToastPreset` returned from `simple()`
 * and `build()`, or an options object with the following properties:
 *
 *   - `templateUrl` - `{string=}`: The url of an html template file that will
 *     be used as the content of the toast. Restrictions: the template must
 *     have an outer `md-toast` element.
 *   - `template` - `{string=}`: Same as templateUrl, except this is an actual
 *     template string.
 *   - `scope` - `{object=}`: the scope to link the template / controller to. If none is specified, it will create a new child scope.
 *     This scope will be destroyed when the toast is removed unless `preserveScope` is set to true.
 *   - `preserveScope` - `{boolean=}`: whether to preserve the scope when the element is removed. Default is false
 *   - `hideDelay` - `{number=}`: How many milliseconds the toast should stay
 *     active before automatically closing.  Set to 0 or false to have the toast stay open until
 *     closed manually. Default: 3000.
 *   - `position` - `{string=}`: Where to place the toast. Available: any combination
 *     of 'bottom', 'left', 'top', 'right', 'fit'. Default: 'bottom left'.
 *   - `controller` - `{string=}`: The controller to associate with this toast.
 *     The controller will be injected the local `$hideToast`, which is a function
 *     used to hide the toast.
 *   - `locals` - `{string=}`: An object containing key/value pairs. The keys will
 *     be used as names of values to inject into the controller. For example,
 *     `locals: {three: 3}` would inject `three` into the controller with the value
 *     of 3.
 *   - `bindToController` - `bool`: bind the locals to the controller, instead of passing them in. These values will not be available until after initialization.
 *   - `resolve` - `{object=}`: Similar to locals, except it takes promises as values
 *     and the toast will not open until the promises resolve.
 *   - `controllerAs` - `{string=}`: An alias to assign the controller to on the scope.
 *   - `parent` - `{element=}`: The element to append the toast to. Defaults to appending
 *     to the root element of the application.
 *
 * @returns {promise} A promise that can be resolved with `$mdToast.hide()` or
 * rejected with `$mdToast.cancel()`.
 */

/**
 * @ngdoc method
 * @name $mdToast#hide
 *
 * @description
 * Hide an existing toast and resolve the promise returned from `$mdToast.show()`.
 *
 * @param {*=} response An argument for the resolved promise.
 *
 * @returns {promise} a promise that is called when the existing element is removed from the DOM
 *
 */

/**
 * @ngdoc method
 * @name $mdToast#cancel
 *
 * @description
 * Hide the existing toast and reject the promise returned from
 * `$mdToast.show()`.
 *
 * @param {*=} response An argument for the rejected promise.
 *
 * @returns {promise} a promise that is called when the existing element is removed from the DOM
 *
 */

function MdToastProvider($$interimElementProvider) {
  var activeToastContent;
  var $mdToast = $$interimElementProvider('$mdToast')
    .setDefaults({
      methods: ['position', 'hideDelay', 'capsule' ],
      options: toastDefaultOptions
    })
    .addPreset('simple', {
      argOption: 'content',
      methods: ['content', 'action', 'highlightAction', 'theme', 'parent'],
      options: /* @ngInject */ ["$mdToast", "$mdTheming", function($mdToast, $mdTheming) {
        var opts = {
          template: [
            '<md-toast md-theme="{{ toast.theme }}" ng-class="{\'md-capsule\': toast.capsule}">',
              '<span flex>{{ toast.content }}</span>',
              '<md-button class="md-action" ng-if="toast.action" ng-click="toast.resolve()" ng-class="{\'md-highlight\': toast.highlightAction}">',
                '{{ toast.action }}',
              '</md-button>',
            '</md-toast>'
          ].join(''),
          controller: /* @ngInject */ ["$scope", function mdToastCtrl($scope) {
            var self = this;
            $scope.$watch(function() { return activeToastContent; }, function() {
              self.content = activeToastContent;
            });
            this.resolve = function() {
              $mdToast.hide();
            };
          }],
          theme: $mdTheming.defaultTheme(),
          controllerAs: 'toast',
          bindToController: true
        };
        return opts;
      }]
    })
    .addMethod('updateContent', function(newContent) {
      activeToastContent = newContent;
    });

  toastDefaultOptions.$inject = ["$timeout", "$animate", "$mdToast", "$mdUtil"];
    return $mdToast;

  /* @ngInject */
  function toastDefaultOptions($timeout, $animate, $mdToast, $mdUtil) {
    return {
      onShow: onShow,
      onRemove: onRemove,
      position: 'bottom left',
      themable: true,
      hideDelay: 3000
    };

    function onShow(scope, element, options) {
      element = $mdUtil.extractElementByName(element, 'md-toast');

      // 'top left' -> 'md-top md-left'
      activeToastContent = options.content;
      element.addClass(options.position.split(' ').map(function(pos) {
        return 'md-' + pos;
      }).join(' '));
      options.parent.addClass(toastOpenClass(options.position));

      options.onSwipe = function(ev, gesture) {
        //Add swipeleft/swiperight class to element so it can animate correctly
        element.addClass('md-' + ev.type.replace('$md.',''));
        $timeout($mdToast.cancel);
      };
      element.on('$md.swipeleft $md.swiperight', options.onSwipe);
      return $animate.enter(element, options.parent);
    }

    function onRemove(scope, element, options) {
      element.off('$md.swipeleft $md.swiperight', options.onSwipe);
      options.parent.removeClass(toastOpenClass(options.position));
      return $animate.leave(element);
    }

    function toastOpenClass(position) {
      return 'md-toast-open-' +
        (position.indexOf('top') > -1 ? 'top' : 'bottom');
    }
  }

}
MdToastProvider.$inject = ["$$interimElementProvider"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.toolbar
 */
angular.module('material.components.toolbar', [
  'material.core',
  'material.components.content'
])
  .directive('mdToolbar', mdToolbarDirective);

/**
 * @ngdoc directive
 * @name mdToolbar
 * @module material.components.toolbar
 * @restrict E
 * @description
 * `md-toolbar` is used to place a toolbar in your app.
 *
 * Toolbars are usually used above a content area to display the title of the
 * current page, and show relevant action buttons for that page.
 *
 * You can change the height of the toolbar by adding either the
 * `md-medium-tall` or `md-tall` class to the toolbar.
 *
 * @usage
 * <hljs lang="html">
 * <div layout="column" layout-fill>
 *   <md-toolbar>
 *
 *     <div class="md-toolbar-tools">
 *       <span>My App's Title</span>
 *
 *       <!-- fill up the space between left and right area -->
 *       <span flex></span>
 *
 *       <md-button>
 *         Right Bar Button
 *       </md-button>
 *     </div>
 *
 *   </md-toolbar>
 *   <md-content>
 *     Hello!
 *   </md-content>
 * </div>
 * </hljs>
 *
 * @param {boolean=} md-scroll-shrink Whether the header should shrink away as
 * the user scrolls down, and reveal itself as the user scrolls up.
 * Note: for scrollShrink to work, the toolbar must be a sibling of a
 * `md-content` element, placed before it. See the scroll shrink demo.
 *
 *
 * @param {number=} md-shrink-speed-factor How much to change the speed of the toolbar's
 * shrinking by. For example, if 0.25 is given then the toolbar will shrink
 * at one fourth the rate at which the user scrolls down. Default 0.5.
 */
function mdToolbarDirective($$rAF, $mdConstant, $mdUtil, $mdTheming, $animate, $timeout) {

  return {
    restrict: 'E',
    controller: angular.noop,
    link: function(scope, element, attr) {
      $mdTheming(element);

      if (angular.isDefined(attr.mdScrollShrink)) {
        setupScrollShrink();
      }

      function setupScrollShrink() {
        // Current "y" position of scroll
        var y = 0;
        // Store the last scroll top position
        var prevScrollTop = 0;

        var shrinkSpeedFactor = attr.mdShrinkSpeedFactor || 0.5;

        var toolbarHeight;
        var contentElement;

        var debouncedContentScroll = $$rAF.throttle(onContentScroll);
        var debouncedUpdateHeight = $mdUtil.debounce(updateToolbarHeight, 5 * 1000);

        // Wait for $mdContentLoaded event from mdContent directive.
        // If the mdContent element is a sibling of our toolbar, hook it up
        // to scroll events.
        scope.$on('$mdContentLoaded', onMdContentLoad);

        function onMdContentLoad($event, newContentEl) {
          // Toolbar and content must be siblings
          if (element.parent()[0] === newContentEl.parent()[0]) {
            // unhook old content event listener if exists
            if (contentElement) {
              contentElement.off('scroll', debouncedContentScroll);
            }

            newContentEl.on('scroll', debouncedContentScroll);
            newContentEl.attr('scroll-shrink', 'true');

            contentElement = newContentEl;
            $$rAF(updateToolbarHeight);
          }
        }

        function updateToolbarHeight() {
          toolbarHeight = element.prop('offsetHeight');
          // Add a negative margin-top the size of the toolbar to the content el.
          // The content will start transformed down the toolbarHeight amount,
          // so everything looks normal.
          //
          // As the user scrolls down, the content will be transformed up slowly
          // to put the content underneath where the toolbar was.
          var margin =  (-toolbarHeight * shrinkSpeedFactor) + 'px';
          contentElement.css('margin-top', margin);
          contentElement.css('margin-bottom', margin);

          onContentScroll();
        }

        function onContentScroll(e) {
          var scrollTop = e ? e.target.scrollTop : prevScrollTop;

          debouncedUpdateHeight();

          y = Math.min(
            toolbarHeight / shrinkSpeedFactor,
            Math.max(0, y + scrollTop - prevScrollTop)
          );

          element.css(
            $mdConstant.CSS.TRANSFORM,
            'translate3d(0,' + (-y * shrinkSpeedFactor) + 'px,0)'
          );
          contentElement.css(
            $mdConstant.CSS.TRANSFORM,
            'translate3d(0,' + ((toolbarHeight - y) * shrinkSpeedFactor) + 'px,0)'
          );

          prevScrollTop = scrollTop;

            if (element.hasClass('md-whiteframe-z1')) {
              if (!y) {
                $timeout(function () { $animate.removeClass(element, 'md-whiteframe-z1'); });
              }
            } else {
              if (y) {
                $timeout(function () { $animate.addClass(element, 'md-whiteframe-z1'); });
              }
            }
        }

      }

    }
  };

}
mdToolbarDirective.$inject = ["$$rAF", "$mdConstant", "$mdUtil", "$mdTheming", "$animate", "$timeout"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.tooltip
 */
angular
    .module('material.components.tooltip', [ 'material.core' ])
    .directive('mdTooltip', MdTooltipDirective);

/**
 * @ngdoc directive
 * @name mdTooltip
 * @module material.components.tooltip
 * @description
 * Tooltips are used to describe elements that are interactive and primarily graphical (not textual).
 *
 * Place a `<md-tooltip>` as a child of the element it describes.
 *
 * A tooltip will activate when the user focuses, hovers over, or touches the parent.
 *
 * @usage
 * <hljs lang="html">
 * <md-button class="md-fab md-accent" aria-label="Play">
 *   <md-tooltip>
 *     Play Music
 *   </md-tooltip>
 *   <md-icon icon="img/icons/ic_play_arrow_24px.svg"></md-icon>
 * </md-button>
 * </hljs>
 *
 * @param {expression=} md-visible Boolean bound to whether the tooltip is
 * currently visible.
 * @param {number=} md-delay How many milliseconds to wait to show the tooltip after the user focuses, hovers, or touches the parent. Defaults to 400ms.
 * @param {string=} md-direction Which direction would you like the tooltip to go?  Supports left, right, top, and bottom.  Defaults to bottom.
 * @param {boolean=} md-autohide If present or provided with a boolean value, the tooltip will hide on mouse leave, regardless of focus
 */
function MdTooltipDirective($timeout, $window, $$rAF, $document, $mdUtil, $mdTheming, $rootElement,
                            $animate, $q) {

  var TOOLTIP_SHOW_DELAY = 300;
  var TOOLTIP_WINDOW_EDGE_SPACE = 8;

  return {
    restrict: 'E',
    transclude: true,
    priority:210, // Before ngAria
    template: '\
        <div class="md-background"></div>\
        <div class="md-content" ng-transclude></div>',
    scope: {
      visible: '=?mdVisible',
      delay: '=?mdDelay',
      autohide: '=?mdAutohide'
    },
    link: postLink
  };

  function postLink(scope, element, attr) {

    $mdTheming(element);

    var parent        = getParentWithPointerEvents(),
        background    = angular.element(element[0].getElementsByClassName('md-background')[0]),
        content       = angular.element(element[0].getElementsByClassName('md-content')[0]),
        direction     = attr.mdDirection,
        current       = getNearestContentElement(),
        tooltipParent = angular.element(current || document.body),
        debouncedOnResize = $$rAF.throttle(function () { if (scope.visible) positionTooltip(); });

    return init();

    function init () {
      setDefaults();
      manipulateElement();
      bindEvents();
      configureWatchers();
      addAriaLabel();
    }

    function setDefaults () {
      if (!angular.isDefined(attr.mdDelay)) scope.delay = TOOLTIP_SHOW_DELAY;
    }

    function configureWatchers () {
      scope.$on('$destroy', function() {
        scope.visible = false;
        element.remove();
        angular.element($window).off('resize', debouncedOnResize);
      });
      scope.$watch('visible', function (isVisible) {
        if (isVisible) showTooltip();
        else hideTooltip();
      });
    }

    function addAriaLabel () {
      if (!parent.attr('aria-label') && !parent.text().trim()) {
        parent.attr('aria-label', element.text().trim());
      }
    }

    function manipulateElement () {
      element.detach();
      element.attr('role', 'tooltip');
    }

    function getParentWithPointerEvents () {
      var parent = element.parent();
      while (parent && $window.getComputedStyle(parent[0])['pointer-events'] == 'none') {
        parent = parent.parent();
      }
      return parent;
    }

     function getNearestContentElement () {
       var current = element.parent()[0];
       // Look for the nearest parent md-content, stopping at the rootElement.
       while (current && current !== $rootElement[0] && current !== document.body) {
         current = current.parentNode;
       }
       return current;
     }

    function hasComputedStyleValue(key, value) {
        // Check if we should show it or not...
        var computedStyles = $window.getComputedStyle(element[0]);
        return angular.isDefined(computedStyles[key]) && (computedStyles[key] == value);
    }

    function bindEvents () {
      var mouseActive = false;
      var enterHandler = function() {
        if (!hasComputedStyleValue('pointer-events','none')) {
          setVisible(true);
        }
      };
      var leaveHandler = function () {
        var autohide = scope.hasOwnProperty('autohide') ? scope.autohide : attr.hasOwnProperty('mdAutohide');
        if (autohide || mouseActive || ($document[0].activeElement !== parent[0]) ) {
          setVisible(false);
        }
        mouseActive = false;
      };

      // to avoid `synthetic clicks` we listen to mousedown instead of `click`
      parent.on('mousedown', function() { mouseActive = true; });
      parent.on('focus mouseenter touchstart', enterHandler );
      parent.on('blur mouseleave touchend touchcancel', leaveHandler );


      angular.element($window).on('resize', debouncedOnResize);
    }

    function setVisible (value) {
      setVisible.value = !!value;
      if (!setVisible.queued) {
        if (value) {
          setVisible.queued = true;
          $timeout(function() {
            scope.visible = setVisible.value;
            setVisible.queued = false;
          }, scope.delay);
        } else {
          $timeout(function() { scope.visible = false; });
        }
      }
    }

    function showTooltip() {
      // Insert the element before positioning it, so we can get the position
      // and check if we should display it
      tooltipParent.append(element);

      // Check if we should display it or not.
      // This handles hide-* and show-* along with any user defined css
      if ( hasComputedStyleValue('display','none') ) {
        scope.visible = false;
        element.detach();
        return;
      }

      positionTooltip();
      angular.forEach([element, background, content], function (element) {
        $animate.addClass(element, 'md-show');
      });
    }

    function hideTooltip() {
      $q.all([
        $animate.removeClass(content, 'md-show'),
        $animate.removeClass(background, 'md-show'),
        $animate.removeClass(element, 'md-show')
      ]).then(function () {
        if (!scope.visible) element.detach();
      });
    }

    function positionTooltip() {
      var tipRect = $mdUtil.offsetRect(element, tooltipParent);
      var parentRect = $mdUtil.offsetRect(parent, tooltipParent);
      var newPosition = getPosition(direction);

      // If the user provided a direction, just nudge the tooltip onto the screen
      // Otherwise, recalculate based on 'top' since default is 'bottom'
      if (direction) {
        newPosition = fitInParent(newPosition);
      } else if (newPosition.top > element.prop('offsetParent').scrollHeight - tipRect.height - TOOLTIP_WINDOW_EDGE_SPACE) {
        newPosition = fitInParent(getPosition('top'));
      }

      element.css({top: newPosition.top + 'px', left: newPosition.left + 'px'});

      positionBackground();

      function positionBackground () {
        var size = direction === 'left' || direction === 'right'
              ? Math.sqrt(Math.pow(tipRect.width, 2) + Math.pow(tipRect.height / 2, 2)) * 2
              : Math.sqrt(Math.pow(tipRect.width / 2, 2) + Math.pow(tipRect.height, 2)) * 2,
            position = direction === 'left' ? { left: 100, top: 50 }
              : direction === 'right' ? { left: 0, top: 50 }
              : direction === 'top' ? { left: 50, top: 100 }
              : { left: 50, top: 0 };
        background.css({
          width: size + 'px',
          height: size + 'px',
          left: position.left + '%',
          top: position.top + '%'
        });
      }

      function fitInParent (pos) {
        var newPosition = { left: pos.left, top: pos.top };
        newPosition.left = Math.min( newPosition.left, tooltipParent.prop('scrollWidth') - tipRect.width - TOOLTIP_WINDOW_EDGE_SPACE );
        newPosition.left = Math.max( newPosition.left, TOOLTIP_WINDOW_EDGE_SPACE );
        newPosition.top  = Math.min( newPosition.top,  tooltipParent.prop('scrollHeight') - tipRect.height - TOOLTIP_WINDOW_EDGE_SPACE );
        newPosition.top  = Math.max( newPosition.top,  TOOLTIP_WINDOW_EDGE_SPACE );
        return newPosition;
      }

      function getPosition (dir) {
        return dir === 'left'
          ? { left: parentRect.left - tipRect.width - TOOLTIP_WINDOW_EDGE_SPACE,
              top: parentRect.top + parentRect.height / 2 - tipRect.height / 2 }
          : dir === 'right'
          ? { left: parentRect.left + parentRect.width + TOOLTIP_WINDOW_EDGE_SPACE,
              top: parentRect.top + parentRect.height / 2 - tipRect.height / 2 }
          : dir === 'top'
          ? { left: parentRect.left + parentRect.width / 2 - tipRect.width / 2,
              top: parentRect.top - tipRect.height - TOOLTIP_WINDOW_EDGE_SPACE }
          : { left: parentRect.left + parentRect.width / 2 - tipRect.width / 2,
              top: parentRect.top + parentRect.height + TOOLTIP_WINDOW_EDGE_SPACE };
      }
    }

  }

}
MdTooltipDirective.$inject = ["$timeout", "$window", "$$rAF", "$document", "$mdUtil", "$mdTheming", "$rootElement", "$animate", "$q"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.whiteframe
 */
angular.module('material.components.whiteframe', []);

})();
(function(){
"use strict";

angular
    .module('material.components.autocomplete')
    .controller('MdAutocompleteCtrl', MdAutocompleteCtrl);

var ITEM_HEIGHT = 41,
    MAX_HEIGHT = 5.5 * ITEM_HEIGHT,
    MENU_PADDING = 8;

function MdAutocompleteCtrl ($scope, $element, $mdUtil, $mdConstant, $timeout, $mdTheming, $window,
                             $animate, $rootElement, $attrs) {
  //-- private variables
  var ctrl      = this,
      itemParts = $scope.itemsExpr.split(/ in /i),
      itemExpr  = itemParts[1],
      elements  = null,
      promise   = null,
      cache     = {},
      noBlur    = false,
      selectedItemWatchers = [],
      hasFocus  = false,
      lastCount = 0;

  //-- public variables with handlers
  defineProperty('hidden', handleHiddenChange, true);

  //-- public variables
  ctrl.scope      = $scope;
  ctrl.parent     = $scope.$parent;
  ctrl.itemName   = itemParts[0];
  ctrl.matches    = [];
  ctrl.loading    = false;
  ctrl.hidden     = true;
  ctrl.index      = null;
  ctrl.messages   = [];
  ctrl.id         = $mdUtil.nextUid();
  ctrl.isDisabled = null;
  ctrl.isRequired = null;

  //-- public methods
  ctrl.keydown    = keydown;
  ctrl.blur       = blur;
  ctrl.focus      = focus;
  ctrl.clear      = clearValue;
  ctrl.select     = select;
  ctrl.listEnter  = onListEnter;
  ctrl.listLeave  = onListLeave;
  ctrl.mouseUp    = onMouseup;
  ctrl.getCurrentDisplayValue         = getCurrentDisplayValue;
  ctrl.registerSelectedItemWatcher    = registerSelectedItemWatcher;
  ctrl.unregisterSelectedItemWatcher  = unregisterSelectedItemWatcher;

  return init();

  //-- initialization methods

  /**
   * Initialize the controller, setup watchers, gather elements
   */
  function init () {
    $mdUtil.initOptionalProperties($scope, $attrs, { searchText: null, selectedItem: null } );
    $mdTheming($element);
    configureWatchers();
    $timeout(function () {
      gatherElements();
      focusElement();
      moveDropdown();
    });
  }

  /**
   * Calculates the dropdown's position and applies the new styles to the menu element
   * @returns {*}
   */
  function positionDropdown () {
    if (!elements) return $timeout(positionDropdown, 0, false);
    var hrect  = elements.wrap.getBoundingClientRect(),
        vrect  = elements.snap.getBoundingClientRect(),
        root   = elements.root.getBoundingClientRect(),
        top    = vrect.bottom - root.top,
        bot    = root.bottom - vrect.top,
        left   = hrect.left - root.left,
        width  = hrect.width,
        styles = {
          left:     left + 'px',
          minWidth: width + 'px',
          maxWidth: Math.max(hrect.right - root.left, root.right - hrect.left) - MENU_PADDING + 'px'
        };
    if (top > bot && root.height - hrect.bottom - MENU_PADDING < MAX_HEIGHT) {
      styles.top = 'auto';
      styles.bottom = bot + 'px';
      styles.maxHeight = Math.min(MAX_HEIGHT, hrect.top - root.top - MENU_PADDING) + 'px';
    } else {
      styles.top = top + 'px';
      styles.bottom = 'auto';
      styles.maxHeight = Math.min(MAX_HEIGHT, root.bottom - hrect.bottom - MENU_PADDING) + 'px';
    }
    elements.$.ul.css(styles);
    $timeout(correctHorizontalAlignment, 0, false);

    /**
     * Makes sure that the menu doesn't go off of the screen on either side.
     */
    function correctHorizontalAlignment () {
      var dropdown = elements.ul.getBoundingClientRect(),
          styles   = {};
      if (dropdown.right > root.right - MENU_PADDING) {
        styles.left = (hrect.right - dropdown.width) + 'px';
      }
      elements.$.ul.css(styles);
    }
  }

  /**
   * Moves the dropdown menu to the body tag in order to avoid z-index and overflow issues.
   */
  function moveDropdown () {
    if (!elements.$.root.length) return;
    $mdTheming(elements.$.ul);
    elements.$.ul.detach();
    elements.$.root.append(elements.$.ul);
    if ($animate.pin) $animate.pin(elements.$.ul, $rootElement);
  }

  /**
   * Sends focus to the input element.
   */
  function focusElement () {
    if ($scope.autofocus) elements.input.focus();
  }

  /**
   * Sets up any watchers used by autocomplete
   */
  function configureWatchers () {
    var wait = parseInt($scope.delay, 10) || 0;
    $attrs.$observe('disabled', function (value) { ctrl.isDisabled = value; });
    $attrs.$observe('required', function (value) { ctrl.isRequired = value !== null; });
    $scope.$watch('searchText', wait ? $mdUtil.debounce(handleSearchText, wait) : handleSearchText);
    registerSelectedItemWatcher(selectedItemChange);
    $scope.$watch('selectedItem', handleSelectedItemChange);
    angular.element($window).on('resize', positionDropdown);
    $scope.$on('$destroy', cleanup);
  }

  /**
   * Removes any events or leftover elements created by this controller
   */
  function cleanup () {
    angular.element($window).off('resize', positionDropdown);
    elements.$.ul.remove();
  }

  /**
   * Gathers all of the elements needed for this controller
   */
  function gatherElements () {
    elements = {
      main:  $element[0],
      ul:    $element.find('ul')[0],
      input: $element.find('input')[0],
      wrap:  $element.find('md-autocomplete-wrap')[0],
      root:  document.body
    };
    elements.li = elements.ul.getElementsByTagName('li');
    elements.snap = getSnapTarget();
    elements.$ = getAngularElements(elements);
  }

  /**
   * Finds the element that the menu will base its position on
   * @returns {*}
   */
  function getSnapTarget () {
    for (var element = $element; element.length; element = element.parent()) {
      if (angular.isDefined(element.attr('md-autocomplete-snap'))) return element[0];
    }
    return elements.wrap;
  }

  /**
   * Gathers angular-wrapped versions of each element
   * @param elements
   * @returns {{}}
   */
  function getAngularElements (elements) {
    var obj = {};
    for (var key in elements) {
      obj[key] = angular.element(elements[key]);
    }
    return obj;
  }

  //-- event/change handlers

  /**
   * Handles changes to the `hidden` property.
   * @param hidden
   * @param oldHidden
   */
  function handleHiddenChange (hidden, oldHidden) {
    if (!hidden && oldHidden) positionDropdown();
    if (!hidden) {
      if (elements) $timeout(function () { $mdUtil.disableScrollAround(elements.ul); }, 0, false);
    } else {
      $mdUtil.enableScrolling();
    }
  }

  /**
   * When the user mouses over the dropdown menu, ignore blur events.
   */
  function onListEnter () {
    noBlur = true;
  }

  /**
   * When the user's mouse leaves the menu, blur events may hide the menu again.
   */
  function onListLeave () {
    noBlur = false;
    if (!hasFocus) ctrl.hidden = true;
  }

  /**
   * When the mouse button is released, send focus back to the input field.
   */
  function onMouseup () {
    elements.input.focus();
  }

  /**
   * Handles changes to the selected item.
   * @param selectedItem
   * @param previousSelectedItem
   */
  function selectedItemChange (selectedItem, previousSelectedItem) {
    if (selectedItem) {
      $scope.searchText = getDisplayValue(selectedItem);
    }
    if (angular.isFunction($scope.itemChange) && selectedItem !== previousSelectedItem)
      $scope.itemChange(getItemScope(selectedItem));
  }

  /**
   * Calls any external watchers listening for the selected item.  Used in conjunction with
   * `registerSelectedItemWatcher`.
   * @param selectedItem
   * @param previousSelectedItem
   */
  function handleSelectedItemChange(selectedItem, previousSelectedItem) {
    for (var i = 0; i < selectedItemWatchers.length; ++i) {
      selectedItemWatchers[i](selectedItem, previousSelectedItem);
    }
  }

  /**
   * Register a function to be called when the selected item changes.
   * @param cb
   */
  function registerSelectedItemWatcher(cb) {
    if (selectedItemWatchers.indexOf(cb) == -1) {
      selectedItemWatchers.push(cb);
    }
  }

  /**
   * Unregister a function previously registered for selected item changes.
   * @param cb
   */
  function unregisterSelectedItemWatcher(cb) {
    var i = selectedItemWatchers.indexOf(cb);
    if (i != -1) {
      selectedItemWatchers.splice(i, 1);
    }
  }

  /**
   * Handles changes to the searchText property.
   * @param searchText
   * @param previousSearchText
   */
  function handleSearchText (searchText, previousSearchText) {
    ctrl.index = getDefaultIndex();
    //-- do nothing on init
    if (searchText === previousSearchText) return;
    //-- clear selected item if search text no longer matches it
    if (searchText !== getDisplayValue($scope.selectedItem)) $scope.selectedItem = null;
    else return;
    //-- trigger change event if available
    if (angular.isFunction($scope.textChange) && searchText !== previousSearchText)
      $scope.textChange(getItemScope($scope.selectedItem));
    //-- cancel results if search text is not long enough
    if (!isMinLengthMet()) {
      ctrl.loading = false;
      ctrl.matches = [];
      ctrl.hidden = shouldHide();
      updateMessages();
    } else {
      handleQuery();
    }
  }

  /**
   * Handles input blur event, determines if the dropdown should hide.
   */
  function blur () {
    hasFocus = false;
    if (!noBlur) ctrl.hidden = true;
  }

  /**
   * Handles input focus event, determines if the dropdown should show.
   */
  function focus () {
    hasFocus = true;
    //-- if searchText is null, let's force it to be a string
    if (!angular.isString($scope.searchText)) $scope.searchText = '';
    if ($scope.minLength > 0) return;
    ctrl.hidden = shouldHide();
    if (!ctrl.hidden) handleQuery();
  }

  /**
   * Handles keyboard input.
   * @param event
   */
  function keydown (event) {
    switch (event.keyCode) {
      case $mdConstant.KEY_CODE.DOWN_ARROW:
        if (ctrl.loading) return;
        event.preventDefault();
        ctrl.index = Math.min(ctrl.index + 1, ctrl.matches.length - 1);
        updateScroll();
        updateMessages();
        break;
      case $mdConstant.KEY_CODE.UP_ARROW:
        if (ctrl.loading) return;
        event.preventDefault();
        ctrl.index = ctrl.index < 0 ? ctrl.matches.length - 1 : Math.max(0, ctrl.index - 1);
        updateScroll();
        updateMessages();
        break;
      case $mdConstant.KEY_CODE.TAB:
      case $mdConstant.KEY_CODE.ENTER:
        if (ctrl.hidden || ctrl.loading || ctrl.index < 0 || ctrl.matches.length < 1) return;
        event.preventDefault();
        select(ctrl.index);
        break;
      case $mdConstant.KEY_CODE.ESCAPE:
        ctrl.matches = [];
        ctrl.hidden = true;
        ctrl.index = getDefaultIndex();
        break;
      default:
    }
  }

  //-- getters

  /**
   * Returns the minimum length needed to display the dropdown.
   * @returns {*}
   */
  function getMinLength () {
    return angular.isNumber($scope.minLength) ? $scope.minLength : 1;
  }

  /**
   * Returns the display value for an item.
   * @param item
   * @returns {*}
   */
  function getDisplayValue (item) {
    return (item && $scope.itemText) ? $scope.itemText(getItemScope(item)) : item;
  }

  /**
   * Returns the locals object for compiling item templates.
   * @param item
   * @returns {{}}
   */
  function getItemScope (item) {
    if (!item) return;
    var locals = {};
    if (ctrl.itemName) locals[ctrl.itemName] = item;
    return locals;
  }

  /**
   * Returns the default index based on whether or not autoselect is enabled.
   * @returns {number}
   */
  function getDefaultIndex () {
    return $scope.autoselect ? 0 : -1;
  }

  /**
   * Determines if the menu should be hidden.
   * @returns {boolean}
   */
  function shouldHide () {
    if (!isMinLengthMet()) return true;
  }

  /**
   * Returns the display value of the current item.
   * @returns {*}
   */
  function getCurrentDisplayValue () {
    return getDisplayValue(ctrl.matches[ctrl.index]);
  }

  /**
   * Determines if the minimum length is met by the search text.
   * @returns {*}
   */
  function isMinLengthMet () {
    return angular.isDefined($scope.searchText) && $scope.searchText.length >= getMinLength();
  }

  //-- actions

  /**
   * Defines a public property with a handler and a default value.
   * @param key
   * @param handler
   * @param value
   */
  function defineProperty (key, handler, value) {
    Object.defineProperty(ctrl, key, {
      get: function () { return value; },
      set: function (newValue) {
        var oldValue = value;
        value = newValue;
        handler(newValue, oldValue);
      }
    });
  }

  /**
   * Selects the item at the given index.
   * @param index
   */
  function select (index) {
    $scope.selectedItem = ctrl.matches[index];
    ctrl.hidden = true;
    ctrl.index = 0;
    ctrl.matches = [];
    //-- force form to update state for validation
    $timeout(function () {
      elements.$.input.controller('ngModel').$setViewValue(getDisplayValue($scope.selectedItem) ||
          $scope.searchText);
      ctrl.hidden = true;
    });
  }

  /**
   * Clears the searchText value and selected item.
   */
  function clearValue () {
    $scope.searchText = '';
    select(-1);

    // Per http://www.w3schools.com/jsref/event_oninput.asp
    var eventObj = document.createEvent('CustomEvent');
    eventObj.initCustomEvent('input', true, true, {value: $scope.searchText});
    elements.input.dispatchEvent(eventObj);

    elements.input.focus();
  }

  /**
   * Fetches the results for the provided search text.
   * @param searchText
   */
  function fetchResults (searchText) {
    var items = $scope.$parent.$eval(itemExpr),
        term = searchText.toLowerCase();
    if (angular.isArray(items)) {
      handleResults(items);
    } else if (items) {
      ctrl.loading = true;
      if (items.success) items.success(handleResults);
      if (items.then)    items.then(handleResults);
      if (items.error)   items.error(function () { ctrl.loading = false; });
    }
    function handleResults (matches) {
      cache[term] = matches;
      if (searchText !== $scope.searchText) return; //-- just cache the results if old request
      ctrl.loading = false;
      promise = null;
      ctrl.matches = matches;
      ctrl.hidden = shouldHide();
      updateMessages();
      positionDropdown();
    }
  }

  /**
   * Updates the ARIA messages
   */
  function updateMessages () {
    ctrl.messages = [ getCountMessage(), getCurrentDisplayValue() ];
  }

  /**
   * Returns the ARIA message for how many results match the current query.
   * @returns {*}
   */
  function getCountMessage () {
    if (lastCount === ctrl.matches.length) return '';
    lastCount = ctrl.matches.length;
    switch (ctrl.matches.length) {
      case 0:  return 'There are no matches available.';
      case 1:  return 'There is 1 match available.';
      default: return 'There are ' + ctrl.matches.length + ' matches available.';
    }
  }

  /**
   * Makes sure that the focused element is within view.
   */
  function updateScroll () {
    if (!elements.li[ctrl.index]) return;
    var li  = elements.li[ctrl.index],
        top = li.offsetTop,
        bot = top + li.offsetHeight,
        hgt = elements.ul.clientHeight;
    if (top < elements.ul.scrollTop) {
      elements.ul.scrollTop = top;
    } else if (bot > elements.ul.scrollTop + hgt) {
      elements.ul.scrollTop = bot - hgt;
    }
  }

  /**
   * Starts the query to gather the results for the current searchText.  Attempts to return cached
   * results first, then forwards the process to `fetchResults` if necessary.
   */
  function handleQuery () {
    var searchText = $scope.searchText,
        term = searchText.toLowerCase();
    //-- cancel promise if a promise is in progress
    if (promise && promise.cancel) {
      promise.cancel();
      promise = null;
    }
    //-- if results are cached, pull in cached results
    if (!$scope.noCache && cache[term]) {
      ctrl.matches = cache[term];
      updateMessages();
    } else {
      fetchResults(searchText);
    }
    if (hasFocus) ctrl.hidden = shouldHide();
  }

}
MdAutocompleteCtrl.$inject = ["$scope", "$element", "$mdUtil", "$mdConstant", "$timeout", "$mdTheming", "$window", "$animate", "$rootElement", "$attrs"];

})();
(function(){
"use strict";

angular
    .module('material.components.autocomplete')
    .directive('mdAutocomplete', MdAutocomplete);

/**
 * @ngdoc directive
 * @name mdAutocomplete
 * @module material.components.autocomplete
 *
 * @description
 * `<md-autocomplete>` is a special input component with a drop-down of all possible matches to a custom query.
 * This component allows you to provide real-time suggestions as the user types in the input area.
 *
 * To start, you will need to specify the required parameters and provide a template for your results.
 * The content inside `md-autocomplete` will be treated as a template.
 *
 * In more complex cases, you may want to include other content such as a message to display when
 * no matches were found.  You can do this by wrapping your template in `md-item-template` and adding
 * a tag for `md-not-found`.  An example of this is shown below.
 * ### Validation
 *
 * You can use `ng-messages` to include validation the same way that you would normally validate;
 * however, if you want to replicate a standard input with a floating label, you will have to do the
 * following:
 *
 * - Make sure that your template is wrapped in `md-item-template`
 * - Add your `ng-messages` code inside of `md-autocomplete`
 * - Add your validation properties to `md-autocomplete` (ie. `required`)
 * - Add a `name` to `md-autocomplete` (to be used on the generated `input`)
 *
 * There is an example below of how this should look.
 *
 *
 * @param {expression} md-items An expression in the format of `item in items` to iterate over matches for your search.
 * @param {expression=} md-selected-item-change An expression to be run each time a new item is selected
 * @param {expression=} md-search-text-change An expression to be run each time the search text updates
 * @param {string=} md-search-text A model to bind the search query text to
 * @param {object=} md-selected-item A model to bind the selected item to
 * @param {string=} md-item-text An expression that will convert your object to a single string.
 * @param {string=} placeholder Placeholder text that will be forwarded to the input.
 * @param {boolean=} md-no-cache Disables the internal caching that happens in autocomplete
 * @param {boolean=} ng-disabled Determines whether or not to disable the input field
 * @param {number=} md-min-length Specifies the minimum length of text before autocomplete will make suggestions
 * @param {number=} md-delay Specifies the amount of time (in milliseconds) to wait before looking for results
 * @param {boolean=} md-autofocus If true, will immediately focus the input element
 * @param {boolean=} md-autoselect If true, the first item will be selected by default
 * @param {string=} md-menu-class This will be applied to the dropdown menu for styling
 * @param {string=} md-floating-label This will add a floating label to autocomplete and wrap it in `md-input-container`
 *
 * @usage
 * ###Basic Example
 * <hljs lang="html">
 *   <md-autocomplete
 *       md-selected-item="selectedItem"
 *       md-search-text="searchText"
 *       md-items="item in getMatches(searchText)"
 *       md-item-text="item.display">
 *     <span md-highlight-text="searchText">{{item.display}}</span>
 *   </md-autocomplete>
 * </hljs>
 *
 * ###Example with "not found" message
 * <hljs lang="html">
 * <md-autocomplete
 *     md-selected-item="selectedItem"
 *     md-search-text="searchText"
 *     md-items="item in getMatches(searchText)"
 *     md-item-text="item.display">
 *   <md-item-template>
 *     <span md-highlight-text="searchText">{{item.display}}</span>
 *   </md-item-template>
 *   <md-not-found>
 *     No matches found.
 *   </md-not-found>
 * </md-autocomplete>
 * </hljs>
 *
 * In this example, our code utilizes `md-item-template` and `md-not-found` to specify the different
 * parts that make up our component.
 *
 * ### Example with validation
 * <hljs lang="html">
 * <form name="autocompleteForm">
 *   <md-autocomplete
 *       required
 *       input-name="autocomplete"
 *       md-selected-item="selectedItem"
 *       md-search-text="searchText"
 *       md-items="item in getMatches(searchText)"
 *       md-item-text="item.display">
 *     <md-item-template>
 *       <span md-highlight-text="searchText">{{item.display}}</span>
 *     </md-item-template>
 *     <div ng-messages="autocompleteForm.autocomplete.$error">
 *       <div ng-message="required">This field is required</div>
 *     </div>
 *   </md-autocomplete>
 * </form>
 * </hljs>
 *
 * In this example, our code utilizes `md-item-template` and `md-not-found` to specify the different
 * parts that make up our component.
 */

function MdAutocomplete ($mdTheming, $mdUtil) {
  return {
    controller:   'MdAutocompleteCtrl',
    controllerAs: '$mdAutocompleteCtrl',
    scope:        {
      inputName:      '@mdInputName',
      inputMinlength: '@mdInputMinlength',
      inputMaxlength: '@mdInputMaxlength',
      searchText:     '=?mdSearchText',
      selectedItem:   '=?mdSelectedItem',
      itemsExpr:      '@mdItems',
      itemText:       '&mdItemText',
      placeholder:    '@placeholder',
      noCache:        '=?mdNoCache',
      itemChange:     '&?mdSelectedItemChange',
      textChange:     '&?mdSearchTextChange',
      minLength:      '=?mdMinLength',
      delay:          '=?mdDelay',
      autofocus:      '=?mdAutofocus',
      floatingLabel:  '@?mdFloatingLabel',
      autoselect:     '=?mdAutoselect',
      menuClass:      '@?mdMenuClass'
    },
    template: function (element, attr) {
      var noItemsTemplate = getNoItemsTemplate(),
          itemTemplate = getItemTemplate(),
          leftover = element.html();
      return '\
        <md-autocomplete-wrap\
            layout="row"\
            ng-class="{ \'md-whiteframe-z1\': !floatingLabel }"\
            role="listbox">\
          ' + getInputElement() + '\
          <md-progress-linear\
              ng-if="$mdAutocompleteCtrl.loading"\
              md-mode="indeterminate"></md-progress-linear>\
          <ul role="presentation"\
              class="md-autocomplete-suggestions md-whiteframe-z1 {{menuClass || \'\'}}"\
              id="ul-{{$mdAutocompleteCtrl.id}}"\
              ng-hide="$mdAutocompleteCtrl.hidden"\
              ng-mouseenter="$mdAutocompleteCtrl.listEnter()"\
              ng-mouseleave="$mdAutocompleteCtrl.listLeave()"\
              ng-mouseup="$mdAutocompleteCtrl.mouseUp()">\
            <li ng-repeat="(index, item) in $mdAutocompleteCtrl.matches"\
                ng-class="{ selected: index === $mdAutocompleteCtrl.index }"\
                ng-click="$mdAutocompleteCtrl.select(index)"\
                md-autocomplete-list-item="$mdAutocompleteCtrl.itemName">\
                ' + itemTemplate + '\
            </li>\
            ' + noItemsTemplate + '\
          </ul>\
        </md-autocomplete-wrap>\
        <aria-status\
            class="md-visually-hidden"\
            role="status"\
            aria-live="assertive">\
          <p ng-repeat="message in $mdAutocompleteCtrl.messages" ng-if="message">{{message}}</p>\
        </aria-status>';

      function getItemTemplate() {
        var templateTag = element.find('md-item-template').remove(),
            html = templateTag.length ? templateTag.html() : element.html();
        if (!templateTag.length) element.empty();
        return html;
      }

      function getNoItemsTemplate() {
        var templateTag = element.find('md-not-found').remove(),
            template = templateTag.length ? templateTag.html() : '';
        return template
            ? '<li ng-if="!$mdAutocompleteCtrl.matches.length && !$mdAutocompleteCtrl.loading\
                         && !$mdAutocompleteCtrl.hidden"\
                         ng-hide="$mdAutocompleteCtrl.hidden"\
                         md-autocomplete-parent-scope>' + template + '</li>'
            : '';

      }

      function getInputElement() {
        if (attr.mdFloatingLabel) {
          return '\
            <md-input-container flex ng-if="floatingLabel">\
              <label>{{floatingLabel}}</label>\
              <input type="search"\
                  id="fl-input-{{$mdAutocompleteCtrl.id}}"\
                  name="{{inputName}}"\
                  autocomplete="off"\
                  ng-required="isRequired"\
                  ng-minlength="inputMinlength"\
                  ng-maxlength="inputMaxlength"\
                  ng-disabled="$mdAutocompleteCtrl.isDisabled"\
                  ng-model="$mdAutocompleteCtrl.scope.searchText"\
                  ng-keydown="$mdAutocompleteCtrl.keydown($event)"\
                  ng-blur="$mdAutocompleteCtrl.blur()"\
                  ng-focus="$mdAutocompleteCtrl.focus()"\
                  aria-owns="ul-{{$mdAutocompleteCtrl.id}}"\
                  aria-label="{{floatingLabel}}"\
                  aria-autocomplete="list"\
                  aria-haspopup="true"\
                  aria-activedescendant=""\
                  aria-expanded="{{!$mdAutocompleteCtrl.hidden}}"/>\
              <div md-autocomplete-parent-scope md-autocomplete-replace>' + leftover + '</div>\
            </md-input-container>';
        } else {
          return '\
            <input flex type="search"\
                id="input-{{$mdAutocompleteCtrl.id}}"\
                name="{{inputName}}"\
                ng-if="!floatingLabel"\
                autocomplete="off"\
                ng-required="isRequired"\
                ng-disabled="$mdAutocompleteCtrl.isDisabled"\
                ng-model="$mdAutocompleteCtrl.scope.searchText"\
                ng-keydown="$mdAutocompleteCtrl.keydown($event)"\
                ng-blur="$mdAutocompleteCtrl.blur()"\
                ng-focus="$mdAutocompleteCtrl.focus()"\
                placeholder="{{placeholder}}"\
                aria-owns="ul-{{$mdAutocompleteCtrl.id}}"\
                aria-label="{{placeholder}}"\
                aria-autocomplete="list"\
                aria-haspopup="true"\
                aria-activedescendant=""\
                aria-expanded="{{!$mdAutocompleteCtrl.hidden}}"/>\
            <button\
                type="button"\
                tabindex="-1"\
                ng-if="$mdAutocompleteCtrl.scope.searchText && !$mdAutocompleteCtrl.isDisabled"\
                ng-click="$mdAutocompleteCtrl.clear()">\
              <md-icon md-svg-icon="md-close"></md-icon>\
              <span class="md-visually-hidden">Clear</span>\
            </button>\
                ';
        }
      }
    }
  };
}
MdAutocomplete.$inject = ["$mdTheming", "$mdUtil"];

})();
(function(){
"use strict";

angular
    .module('material.components.autocomplete')
    .controller('MdHighlightCtrl', MdHighlightCtrl);

function MdHighlightCtrl ($scope, $element, $interpolate) {
  this.init = init;

  return init();

  function init (term) {
    var unsafeText = $interpolate($element.html())($scope),
        text = angular.element('<div>').text(unsafeText).html(),
        flags = $element.attr('md-highlight-flags') || '',
        watcher = $scope.$watch(term, function (term) {
          var regex = getRegExp(term, flags),
              html = text.replace(regex, '<span class="highlight">$&</span>');
          $element.html(html);
        });
    $element.on('$destroy', function () { watcher(); });
  }

  function sanitize (term) {
    if (!term) return term;
    return term.replace(/[\\\^\$\*\+\?\.\(\)\|\{\}\[\]]/g, '\\$&');
  }

  function getRegExp (text, flags) {
    var str = '';
    if (flags.indexOf('^') >= 1) str += '^';
    str += text;
    if (flags.indexOf('$') >= 1) str += '$';
    return new RegExp(sanitize(str), flags.replace(/[\$\^]/g, ''));
  }
}
MdHighlightCtrl.$inject = ["$scope", "$element", "$interpolate"];

})();
(function(){
"use strict";

angular
    .module('material.components.autocomplete')
    .directive('mdHighlightText', MdHighlight);

/**
 * @ngdoc directive
 * @name mdHighlightText
 * @module material.components.autocomplete
 *
 * @description
 * The `md-highlight-text` directive allows you to specify text that should be highlighted within
 * an element.  Highlighted text will be wrapped in `<span class="highlight"></span>` which can
 * be styled through CSS.  Please note that child elements may not be used with this directive.
 *
 * @param {string} md-highlight-text A model to be searched for
 * @param {string=} md-highlight-flags A list of flags (loosely based on JavaScript RexExp flags).
 *    #### **Supported flags**:
 *    - `g`: Find all matches within the provided text
 *    - `i`: Ignore case when searching for matches
 *    - `$`: Only match if the text ends with the search term
 *    - `^`: Only match if the text begins with the search term
 *
 * @usage
 * <hljs lang="html">
 * <input placeholder="Enter a search term..." ng-model="searchTerm" type="text" />
 * <ul>
 *   <li ng-repeat="result in results" md-highlight-text="searchTerm">
 *     {{result.text}}
 *   </li>
 * </ul>
 * </hljs>
 */

function MdHighlight () {
  return {
    terminal: true,
    scope: false,
    controller: 'MdHighlightCtrl',
    link: function (scope, element, attr, ctrl) {
      ctrl.init(attr.mdHighlightText);
    }
  };
}

})();
(function(){
"use strict";

angular
    .module('material.components.autocomplete')
    .directive('mdAutocompleteListItem', MdAutocompleteListItem);

function MdAutocompleteListItem ($compile, $mdUtil) {
  return {
    terminal: true,
    link: postLink,
    scope: false
  };
  function postLink (scope, element, attr) {
    var ctrl     = scope.$parent.$mdAutocompleteCtrl,
        newScope = ctrl.parent.$new(false, ctrl.parent),
        itemName = ctrl.scope.$eval(attr.mdAutocompleteListItem);
    newScope[itemName] = scope.item;
    $compile(element.contents())(newScope);
    element.attr({
      role: 'option',
      id: 'item_' + $mdUtil.nextUid()
    });
  }
}
MdAutocompleteListItem.$inject = ["$compile", "$mdUtil"];

})();
(function(){
"use strict";

angular
    .module('material.components.autocomplete')
    .directive('mdAutocompleteParentScope', MdAutocompleteParentScope);

function MdAutocompleteParentScope ($compile, $mdUtil) {
  return {
    restrict: 'A',
    terminal: true,
    link: postLink,
    scope: false
  };
  function postLink (scope, element, attr) {
    var ctrl     = scope.$parent.$mdAutocompleteCtrl;
    $compile(element.contents())(ctrl.parent);
    if (attr.hasOwnProperty('mdAutocompleteReplace')) {
      element.after(element.contents());
      element.remove();
    }
  }
}
MdAutocompleteParentScope.$inject = ["$compile", "$mdUtil"];

})();
(function(){
"use strict";

angular
    .module('material.components.chips')
    .directive('mdChip', MdChip);

/**
 * @ngdoc directive
 * @name mdChip
 * @module material.components.chips
 *
 * @description
 * `<md-chip>` is a component used within `<md-chips>` and is responsible for rendering individual
 * chips.
 *
 *
 * @usage
 * <hljs lang="html">
 *   <md-chip>{{$chip}}</md-chip>
 * </hljs>
 *
 */

// This hint text is hidden within a chip but used by screen readers to
// inform the user how they can interact with a chip.
var DELETE_HINT_TEMPLATE = '\
    <span ng-if="!$mdChipsCtrl.readonly" class="md-visually-hidden">\
      {{$mdChipsCtrl.deleteHint}}\
    </span>';

/**
 * MDChip Directive Definition
 *
 * @param $mdTheming
 * @param $mdInkRipple
 * @ngInject
 */
function MdChip($mdTheming) {
  return {
    restrict: 'E',
    require: '^?mdChips',
    compile:  compile
  };

  function compile(element, attr) {
    element.append(DELETE_HINT_TEMPLATE);
    return function postLink(scope, element, attr, ctrl) {
      element.addClass('md-chip');
      $mdTheming(element);

      if (ctrl) angular.element(element[0].querySelector('.md-chip-content'))
          .on('blur', function () {
            ctrl.selectedChip = -1;
          });
    };
  }
}
MdChip.$inject = ["$mdTheming"];

})();
(function(){
"use strict";

angular
    .module('material.components.chips')
    .directive('mdChipRemove', MdChipRemove);

/**
 * @ngdoc directive
 * @name mdChipRemove
 * @module material.components.chips
 *
 * @description
 * `<md-chip-remove>`
 * Designates an element to be used as the delete button for a chip. This
 * element is passed as a child of the `md-chips` element.
 *
 * @usage
 * <hljs lang="html">
 *   <md-chips><button md-chip-remove>DEL</button></md-chips>
 * </hljs>
 */


/**
 * MdChipRemove Directive Definition.
 * 
 * @param $compile
 * @param $timeout
 * @returns {{restrict: string, require: string[], link: Function, scope: boolean}}
 * @constructor
 */
function MdChipRemove ($timeout) {
  return {
    restrict: 'A',
    require: '^mdChips',
    scope: false,
    link: postLink
  };

  function postLink(scope, element, attr, ctrl) {
    element.on('click', function(event) {
      scope.$apply(function() {
        ctrl.removeChip(scope.$$replacedScope.$index);
      });
    });

    // Child elements aren't available until after a $timeout tick as they are hidden by an
    // `ng-if`. see http://goo.gl/zIWfuw
    $timeout(function() {
      element.attr({ tabindex: -1, ariaHidden: true });
      element.find('button').attr('tabindex', '-1');
    });
  }
}
MdChipRemove.$inject = ["$timeout"];

})();
(function(){
"use strict";

angular
    .module('material.components.chips')
    .directive('mdChipTransclude', MdChipTransclude);

function MdChipTransclude ($compile, $mdUtil) {
  return {
    restrict: 'EA',
    terminal: true,
    link: link,
    scope: false
  };
  function link (scope, element, attr) {
    var ctrl = scope.$parent.$mdChipsCtrl,
        newScope = ctrl.parent.$new(false, ctrl.parent);
    newScope.$$replacedScope = scope;
    newScope.$chip = scope.$chip;
    newScope.$mdChipsCtrl = ctrl;
    element.html(ctrl.$scope.$eval(attr.mdChipTransclude));
    $compile(element.contents())(newScope);
  }
}
MdChipTransclude.$inject = ["$compile", "$mdUtil"];

})();
(function(){
"use strict";

angular
    .module('material.components.chips')
    .controller('MdChipsCtrl', MdChipsCtrl);

/**
 * Controller for the MdChips component. Responsible for adding to and
 * removing from the list of chips, marking chips as selected, and binding to
 * the models of various input components.
 *
 * @param $scope
 * @param $mdConstant
 * @param $log
 * @param $element
 * @constructor
 */
function MdChipsCtrl ($scope, $mdConstant, $log, $element, $timeout) {
  /** @type {$timeout} **/
  this.$timeout = $timeout;

  /** @type {Object} */
  this.$mdConstant = $mdConstant;

  /** @type {angular.$scope} */
  this.$scope = $scope;

  /** @type {angular.$scope} */
  this.parent = $scope.$parent;

  /** @type {$log} */
  this.$log = $log;

  /** @type {$element} */
  this.$element = $element;

  /** @type {angular.NgModelController} */
  this.ngModelCtrl = null;

  /** @type {angular.NgModelController} */
  this.userInputNgModelCtrl = null;

  /** @type {Element} */
  this.userInputElement = null;

  /** @type {Array.<Object>} */
  this.items = [];

  /** @type {number} */
  this.selectedChip = -1;


  /**
   * Hidden hint text for how to delete a chip. Used to give context to screen readers.
   * @type {string}
   */
  this.deleteHint = 'Press delete to remove this chip.';

  /**
   * Hidden label for the delete button. Used to give context to screen readers.
   * @type {string}
   */
  this.deleteButtonLabel = 'Remove';

  /**
   * Model used by the input element.
   * @type {string}
   */
  this.chipBuffer = '';

  /**
   * Whether to use the mdOnAppend expression to transform the chip buffer
   * before appending it to the list.
   * @type {boolean}
   */
  this.useMdOnAppend = false;
}
MdChipsCtrl.$inject = ["$scope", "$mdConstant", "$log", "$element", "$timeout"];

/**
 * Handles the keydown event on the input element: <enter> appends the
 * buffer to the chip list, while backspace removes the last chip in the list
 * if the current buffer is empty.
 * @param event
 */
MdChipsCtrl.prototype.inputKeydown = function(event) {
  var chipBuffer = this.getChipBuffer();
  switch (event.keyCode) {
    case this.$mdConstant.KEY_CODE.ENTER:
      if (this.$scope.requireMatch || !chipBuffer) break;
      event.preventDefault();
      this.appendChip(chipBuffer);
      this.resetChipBuffer();
      break;
    case this.$mdConstant.KEY_CODE.BACKSPACE:
      if (chipBuffer) break;
      event.stopPropagation();
      if (this.items.length) this.selectAndFocusChipSafe(this.items.length - 1);
      break;
  }
};

/**
 * Handles the keydown event on the chip elements: backspace removes the selected chip, arrow
 * keys switch which chips is active
 * @param event
 */
MdChipsCtrl.prototype.chipKeydown = function (event) {
  if (this.getChipBuffer()) return;
  switch (event.keyCode) {
    case this.$mdConstant.KEY_CODE.BACKSPACE:
    case this.$mdConstant.KEY_CODE.DELETE:
      if (this.selectedChip < 0) return;
      event.preventDefault();
      this.removeAndSelectAdjacentChip(this.selectedChip);
      break;
    case this.$mdConstant.KEY_CODE.LEFT_ARROW:
      event.preventDefault();
      if (this.selectedChip < 0) this.selectedChip = this.items.length;
      if (this.items.length) this.selectAndFocusChipSafe(this.selectedChip - 1);
      break;
    case this.$mdConstant.KEY_CODE.RIGHT_ARROW:
      event.preventDefault();
      this.selectAndFocusChipSafe(this.selectedChip + 1);
      break;
    case this.$mdConstant.KEY_CODE.ESCAPE:
    case this.$mdConstant.KEY_CODE.TAB:
      if (this.selectedChip < 0) return;
      event.preventDefault();
      this.onFocus();
      break;
  }
};

/**
 * Get the input's placeholder - uses `placeholder` when list is empty and `secondary-placeholder`
 * when the list is non-empty. If `secondary-placeholder` is not provided, `placeholder` is used
 * always.
 */
MdChipsCtrl.prototype.getPlaceholder = function() {
  // Allow `secondary-placeholder` to be blank.
  var useSecondary = (this.items.length &&
      (this.secondaryPlaceholder == '' || this.secondaryPlaceholder));
  return useSecondary ? this.placeholder : this.secondaryPlaceholder;
};

/**
 * Removes chip at {@code index} and selects the adjacent chip.
 * @param index
 */
MdChipsCtrl.prototype.removeAndSelectAdjacentChip = function(index) {
  var selIndex = this.getAdjacentChipIndex(index);
  this.removeChip(index);
  this.$timeout(angular.bind(this, function () {
      this.selectAndFocusChipSafe(selIndex);
  }));
};

/**
 * Sets the selected chip index to -1.
 */
MdChipsCtrl.prototype.resetSelectedChip = function() {
  this.selectedChip = -1;
};

/**
 * Gets the index of an adjacent chip to select after deletion. Adjacency is
 * determined as the next chip in the list, unless the target chip is the
 * last in the list, then it is the chip immediately preceding the target. If
 * there is only one item in the list, -1 is returned (select none).
 * The number returned is the index to select AFTER the target has been
 * removed.
 * If the current chip is not selected, then -1 is returned to select none.
 */
MdChipsCtrl.prototype.getAdjacentChipIndex = function(index) {
  var len = this.items.length - 1;
  return (len == 0) ? -1 :
      (index == len) ? index -1 : index;
};

/**
 * Append the contents of the buffer to the chip list. This method will first
 * call out to the md-on-append method, if provided
 * @param newChip
 */
MdChipsCtrl.prototype.appendChip = function(newChip) {
  if (this.items.indexOf(newChip) + 1) return;
  if (this.useMdOnAppend && this.mdOnAppend) {
    newChip = this.mdOnAppend({'$chip': newChip});
  }
  this.items.push(newChip);
};

/**
 * Sets whether to use the md-on-append expression. This expression is
 * bound to scope and controller in {@code MdChipsDirective} as
 * {@code mdOnAppend}. Due to the nature of directive scope bindings, the
 * controller cannot know on its own/from the scope whether an expression was
 * actually provided.
 */
MdChipsCtrl.prototype.useMdOnAppendExpression = function() {
  this.useMdOnAppend = true;
};

/**
 * Gets the input buffer. The input buffer can be the model bound to the
 * default input item {@code this.chipBuffer}, the {@code selectedItem}
 * model of an {@code md-autocomplete}, or, through some magic, the model
 * bound to any inpput or text area element found within a
 * {@code md-input-container} element.
 * @return {Object|string}
 */
MdChipsCtrl.prototype.getChipBuffer = function() {
  return !this.userInputElement ? this.chipBuffer :
      this.userInputNgModelCtrl ? this.userInputNgModelCtrl.$viewValue :
          this.userInputElement[0].value;
};

/**
 * Resets the input buffer for either the internal input or user provided input element.
 */
MdChipsCtrl.prototype.resetChipBuffer = function() {
  if (this.userInputElement) {
    if (this.userInputNgModelCtrl) {
      this.userInputNgModelCtrl.$setViewValue('');
      this.userInputNgModelCtrl.$render();
    } else {
      this.userInputElement[0].value = '';
    }
  } else {
    this.chipBuffer = '';
  }
};

/**
 * Removes the chip at the given index.
 * @param index
 */
MdChipsCtrl.prototype.removeChip = function(index) {
  this.items.splice(index, 1);
};

MdChipsCtrl.prototype.removeChipAndFocusInput = function (index) {
  this.removeChip(index);
  this.onFocus();
};
/**
 * Selects the chip at `index`,
 * @param index
 */
MdChipsCtrl.prototype.selectAndFocusChipSafe = function(index) {
  if (!this.items.length) {
    this.selectChip(-1);
    this.onFocus();
    return;
  }
  if (index === this.items.length) return this.onFocus();
  index = Math.max(index, 0);
  index = Math.min(index, this.items.length - 1);
  this.selectChip(index);
  this.focusChip(index);
};

/**
 * Marks the chip at the given index as selected.
 * @param index
 */
MdChipsCtrl.prototype.selectChip = function(index) {
  if (index >= -1 && index <= this.items.length) {
    this.selectedChip = index;
  } else {
    this.$log.warn('Selected Chip index out of bounds; ignoring.');
  }
};

/**
 * Selects the chip at `index` and gives it focus.
 * @param index
 */
MdChipsCtrl.prototype.selectAndFocusChip = function(index) {
  this.selectChip(index);
  if (index != -1) {
    this.focusChip(index);
  }
};

/**
 * Call `focus()` on the chip at `index`
 */
MdChipsCtrl.prototype.focusChip = function(index) {
  this.$element[0].querySelector('md-chip[index="' + index + '"] .md-chip-content').focus();
};

/**
 * Configures the required interactions with the ngModel Controller.
 * Specifically, set {@code this.items} to the {@code NgModelCtrl#$viewVale}.
 * @param ngModelCtrl
 */
MdChipsCtrl.prototype.configureNgModel = function(ngModelCtrl) {
  this.ngModelCtrl = ngModelCtrl;

  var self = this;
  ngModelCtrl.$render = function() {
    // model is updated. do something.
    self.items = self.ngModelCtrl.$viewValue;
  };
};

MdChipsCtrl.prototype.onFocus = function () {
  var input = this.$element[0].querySelector('input');
  input && input.focus();
  this.resetSelectedChip();
};

MdChipsCtrl.prototype.onInputFocus = function () {
  this.inputHasFocus = true;
  this.resetSelectedChip();
};

MdChipsCtrl.prototype.onInputBlur = function () {
  this.inputHasFocus = false;
};

/**
 * Configure event bindings on a user-provided input element.
 * @param inputElement
 */
MdChipsCtrl.prototype.configureUserInput = function(inputElement) {
  this.userInputElement = inputElement;

  // Find the NgModelCtrl for the input element
  var ngModelCtrl = inputElement.controller('ngModel');
  // `.controller` will look in the parent as well.
  if (ngModelCtrl != this.ngModelCtrl) {
    this.userInputNgModelCtrl = ngModelCtrl;
  }

  // Bind to keydown and focus events of input
  var scope = this.$scope;
  var ctrl = this;
  inputElement
      .attr({ tabindex: 0 })
      .on('keydown', function(event) { scope.$apply( angular.bind(ctrl, function() { ctrl.inputKeydown(event); })) })
      .on('focus', angular.bind(ctrl, ctrl.onInputFocus))
      .on('blur', angular.bind(ctrl, ctrl.onInputBlur));
};

MdChipsCtrl.prototype.configureAutocomplete = function(ctrl) {

  ctrl.registerSelectedItemWatcher(angular.bind(this, function (item) {
    if (item) {
      this.appendChip(item);
      this.resetChipBuffer();
    }
  }));

  this.$element.find('input')
      .on('focus',angular.bind(this, this.onInputFocus) )
      .on('blur', angular.bind(this, this.onInputBlur) );
};

MdChipsCtrl.prototype.hasFocus = function () {
  return this.inputHasFocus || this.selectedChip >= 0;
};

})();
(function(){
"use strict";

  angular
      .module('material.components.chips')
      .directive('mdChips', MdChips);

  /**
   * @ngdoc directive
   * @name mdChips
   * @module material.components.chips
   *
   * @description
   * `<md-chips>` is an input component for building lists of strings or objects. The list items are
   * displayed as 'chips'. This component can make use of an `<input>` element or an
   * `<md-autocomplete>` element.
   *
   * <strong>Custom `<md-chip-template>` template</strong>
   * A custom template may be provided to render the content of each chip. This is achieved by
   * specifying an `<md-chip-template>` element as a child of `<md-chips>`. Note: Any attributes on
   * `<md-chip-template>` will be dropped as only the innerHTML is used for the chip template. The
   * variables `$chip` and `$index` are available in the scope of `<md-chip-template>`, representing
   * the chip object and its index in the list of chips, respectively.
   * To override the chip delete control, include an element (ideally a button) with the attribute
   * `md-chip-remove`. A click listener to remove the chip will be added automatically. The element
   * is also placed as a sibling to the chip content (on which there are also click listeners) to
   * avoid a nested ng-click situation.
   *
   * <h3> Pending Features </h3>
   * <ul style="padding-left:20px;">
   *
   *   <ul>Style
   *     <li>Colours for hover, press states (ripple?).</li>
   *   </ul>
   *
   *   <ul>List Manipulation
   *     <li>delete item via DEL or backspace keys when selected</li>
   *   </ul>
   *
   *   <ul>Validation
   *     <li>de-dupe values (or support duplicates, but fix the ng-repeat duplicate key issue)</li>
   *     <li>allow a validation callback</li>
   *     <li>hilighting style for invalid chips</li>
   *   </ul>
   *
   *   <ul>Item mutation
   *     <li>Support `
   *       <md-chip-edit>` template, show/hide the edit element on tap/click? double tap/double
   *       click?
   *     </li>
   *   </ul>
   *
   *   <ul>Truncation and Disambiguation (?)
   *     <li>Truncate chip text where possible, but do not truncate entries such that two are
   *     indistinguishable.</li>
   *   </ul>
   *
   *   <ul>Drag and Drop
   *     <li>Drag and drop chips between related `<md-chips>` elements.
   *     </li>
   *   </ul>
   * </ul>
   *
   *  <span style="font-size:.8em;text-align:center">
   *    Warning: This component is a WORK IN PROGRESS. If you use it now,
   *    it will probably break on you in the future.
   *  </span>
   *
   * @param {string=|object=} ng-model A model to bind the list of items to
   * @param {string=} placeholder Placeholder text that will be forwarded to the input.
   * @param {string=} secondary-placeholder Placeholder text that will be forwarded to the input,
   *    displayed when there is at least on item in the list
   * @param {boolean=} readonly Disables list manipulation (deleting or adding list items), hiding
   *    the input and delete buttons
   * @param {expression} md-on-append An expression expected to convert the input string into an
   *    object when adding a chip.
   * @param {string=} delete-hint A string read by screen readers instructing users that pressing
   *    the delete key will remove the chip.
   * @param {string=} delete-button-label A label for the delete button. Also hidden and read by
   *    screen readers.
   *
   * @usage
   * <hljs lang="html">
   *   <md-chips
   *       ng-model="myItems"
   *       placeholder="Add an item"
   *       readonly="isReadOnly">
   *   </md-chips>
   * </hljs>
   *
   */


  var MD_CHIPS_TEMPLATE = '\
      <md-chips-wrap\
          ng-if="!$mdChipsCtrl.readonly || $mdChipsCtrl.items.length > 0"\
          ng-keydown="$mdChipsCtrl.chipKeydown($event)"\
          ng-class="{ \'md-focused\': $mdChipsCtrl.hasFocus() }"\
          class="md-chips">\
        <md-chip ng-repeat="$chip in $mdChipsCtrl.items"\
            index="{{$index}}"\
            ng-class="{\'md-focused\': $mdChipsCtrl.selectedChip == $index}">\
          <div class="md-chip-content"\
              tabindex="-1"\
              aria-hidden="true"\
              ng-focus="!$mdChipsCtrl.readonly && $mdChipsCtrl.selectChip($index)"\
              md-chip-transclude="$mdChipsCtrl.chipContentsTemplate"></div>\
          <div class="md-chip-remove-container"\
              md-chip-transclude="$mdChipsCtrl.chipRemoveTemplate"></div>\
        </md-chip>\
        <div ng-if="!$mdChipsCtrl.readonly && $mdChipsCtrl.ngModelCtrl"\
            class="md-chip-input-container"\
            md-chip-transclude="$mdChipsCtrl.chipInputTemplate"></div>\
        </div>\
      </md-chips-wrap>';

  var CHIP_INPUT_TEMPLATE = '\
        <input\
            tabindex="0"\
            placeholder="{{$mdChipsCtrl.getPlaceholder()}}"\
            aria-label="{{$mdChipsCtrl.getPlaceholder()}}"\
            ng-model="$mdChipsCtrl.chipBuffer"\
            ng-focus="$mdChipsCtrl.onInputFocus()"\
            ng-blur="$mdChipsCtrl.onInputBlur()"\
            ng-keydown="$mdChipsCtrl.inputKeydown($event)">';

  var CHIP_DEFAULT_TEMPLATE = '\
      <span>{{$chip}}</span>';

  var CHIP_REMOVE_TEMPLATE = '\
      <button\
          class="md-chip-remove"\
          ng-if="!$mdChipsCtrl.readonly"\
          ng-click="$mdChipsCtrl.removeChipAndFocusInput($$replacedScope.$index)"\
          type="button"\
          aria-hidden="true"\
          tabindex="-1">\
        <md-icon md-svg-icon="md-close"></md-icon>\
        <span class="md-visually-hidden">\
          {{$mdChipsCtrl.deleteButtonLabel}}\
        </span>\
      </button>';

  /**
   * MDChips Directive Definition
   */
  function MdChips ($mdTheming, $mdUtil, $compile, $log, $timeout) {
    return {
      template: function(element, attrs) {
        // Clone the element into an attribute. By prepending the attribute
        // name with '$', Angular won't write it into the DOM. The cloned
        // element propagates to the link function via the attrs argument,
        // where various contained-elements can be consumed.
        var content = attrs['$mdUserTemplate'] = element.clone();
        return MD_CHIPS_TEMPLATE;
      },
      require: ['mdChips'],
      restrict: 'E',
      controller: 'MdChipsCtrl',
      controllerAs: '$mdChipsCtrl',
      bindToController: true,
      compile: compile,
      scope: {
        readonly: '=readonly',
        placeholder: '@',
        secondaryPlaceholder: '@',
        mdOnAppend: '&',
        deleteHint: '@',
        deleteButtonLabel: '@',
        requireMatch: '=?mdRequireMatch'
      }
    };

    /**
     * Builds the final template for `md-chips` and returns the postLink function.
     *
     * Building the template involves 3 key components:
     * static chips
     * chip template
     * input control
     *
     * If no `ng-model` is provided, only the static chip work needs to be done.
     *
     * If no user-passed `md-chip-template` exists, the default template is used. This resulting
     * template is appended to the chip content element.
     *
     * The remove button may be overridden by passing an element with an md-chip-remove attribute.
     *
     * If an `input` or `md-autocomplete` element is provided by the caller, it is set aside for
     * transclusion later. The transclusion happens in `postLink` as the parent scope is required.
     * If no user input is provided, a default one is appended to the input container node in the
     * template.
     *
     * Static Chips (i.e. `md-chip` elements passed from the caller) are gathered and set aside for
     * transclusion in the `postLink` function.
     *
     *
     * @param element
     * @param attr
     * @returns {Function}
     */
    function compile(element, attr) {
      // Grab the user template from attr and reset the attribute to null.
      var userTemplate = attr['$mdUserTemplate'];
      attr['$mdUserTemplate'] = null;

      // Set the chip remove, chip contents and chip input templates. The link function will put
      // them on the scope for transclusion later.
      var chipRemoveTemplate   = getTemplateByQuery('md-chips>*[md-chip-remove]') || CHIP_REMOVE_TEMPLATE,
          chipContentsTemplate = getTemplateByQuery('md-chips>md-chip-template') || CHIP_DEFAULT_TEMPLATE,
          chipInputTemplate    = getTemplateByQuery('md-chips>md-autocomplete')
              || getTemplateByQuery('md-chips>input')
              || CHIP_INPUT_TEMPLATE,
          staticChips = userTemplate.find('md-chip');

      // Warn of malformed template. See #2545
      if (userTemplate[0].querySelector('md-chip-template>*[md-chip-remove]')) {
        $log.warn('invalid placement of md-chip-remove within md-chip-template.');
      }

      function getTemplateByQuery (query) {
        if (!attr.ngModel) return;
        var element = userTemplate[0].querySelector(query);
        return element && element.outerHTML;
      }

      /**
       * Configures controller and transcludes.
       */
      return function postLink(scope, element, attrs, controllers) {

        $mdUtil.initOptionalProperties(scope, attr);

        $mdTheming(element);
        var mdChipsCtrl = controllers[0];
        mdChipsCtrl.chipContentsTemplate = chipContentsTemplate;
        mdChipsCtrl.chipRemoveTemplate   = chipRemoveTemplate;
        mdChipsCtrl.chipInputTemplate    = chipInputTemplate;

        element
            .attr({ ariaHidden: true, tabindex: -1 })
            .on('focus', function () { mdChipsCtrl.onFocus(); });

        if (attr.ngModel) {
          mdChipsCtrl.configureNgModel(element.controller('ngModel'));

          // If an `md-on-append` attribute was set, tell the controller to use the expression
          // when appending chips.
          if (attrs.mdOnAppend) mdChipsCtrl.useMdOnAppendExpression();

          // The md-autocomplete and input elements won't be compiled until after this directive
          // is complete (due to their nested nature). Wait a tick before looking for them to
          // configure the controller.
          if (chipInputTemplate != CHIP_INPUT_TEMPLATE) {
            $timeout(function() {
              if (chipInputTemplate.indexOf('<md-autocomplete') === 0)
                mdChipsCtrl
                    .configureAutocomplete(element.find('md-autocomplete')
                        .controller('mdAutocomplete'));
              mdChipsCtrl.configureUserInput(element.find('input'));
            });
          }
        }

        // Compile with the parent's scope and prepend any static chips to the wrapper.
        if (staticChips.length > 0) {
          var compiledStaticChips = $compile(staticChips)(scope.$parent);
          $timeout(function() { element.find('md-chips-wrap').prepend(compiledStaticChips); });
        }
      };
    }
  }
  MdChips.$inject = ["$mdTheming", "$mdUtil", "$compile", "$log", "$timeout"];

})();
(function(){
"use strict";

angular
    .module('material.components.chips')
    .controller('MdContactChipsCtrl', MdContactChipsCtrl);



/**
 * Controller for the MdContactChips component
 * @constructor
 */
function MdContactChipsCtrl () {
  /** @type {Object} */
  this.selectedItem = null;

  /** @type {string} */
  this.searchText = '';
}


MdContactChipsCtrl.prototype.queryContact = function(searchText) {
  var results = this.contactQuery({'$query': searchText});
  return this.filterSelected ?
      results.filter(angular.bind(this, this.filterSelectedContacts)) : results;
};


MdContactChipsCtrl.prototype.filterSelectedContacts = function(contact) {
  return this.contacts.indexOf(contact) == -1;
};

})();
(function(){
"use strict";

  angular
      .module('material.components.chips')
      .directive('mdContactChips', MdContactChips);

  /**
   * @ngdoc directive
   * @name mdContactChips
   * @module material.components.chips
   *
   * @description
   * `<md-contact-chips>` is an input component based on `md-chips` and makes use of an
   *    `md-autocomplete` element. The component allows the caller to supply a query expression
   *    which returns  a list of possible contacts. The user can select one of these and add it to
   *    the list of chips.
   *
   * @param {string=|object=} ng-model A model to bind the list of items to
   * @param {string=} placeholder Placeholder text that will be forwarded to the input.
   * @param {string=} secondary-placeholder Placeholder text that will be forwarded to the input,
   *    displayed when there is at least on item in the list
   * @param {expression} md-contacts An expression expected to return contacts matching the search
   *    test, `$query`.
   * @param {string} md-contact-name The field name of the contact object representing the
   *    contact's name.
   * @param {string} md-contact-email The field name of the contact object representing the
   *    contact's email address.
   * @param {string} md-contact-image The field name of the contact object representing the
   *    contact's image.
   *
   *
   * // The following attribute has been removed but may come back.
   * @param {expression=} filter-selected Whether to filter selected contacts from the list of
   *    suggestions shown in the autocomplete.
   *
   *
   *
   * @usage
   * <hljs lang="html">
   *   <md-contact-chips
   *       ng-model="ctrl.contacts"
   *       md-contacts="ctrl.querySearch($query)"
   *       md-contact-name="name"
   *       md-contact-image="image"
   *       md-contact-email="email"
   *       placeholder="To">
   *   </md-contact-chips>
   * </hljs>
   *
   */


  var MD_CONTACT_CHIPS_TEMPLATE = '\
      <md-chips class="md-contact-chips"\
          ng-model="$mdContactChipsCtrl.contacts"\
          md-require-match="$mdContactChipsCtrl.requireMatch"\
          md-autocomplete-snap>\
          <md-autocomplete\
              md-menu-class="md-contact-chips-suggestions"\
              md-selected-item="$mdContactChipsCtrl.selectedItem"\
              md-search-text="$mdContactChipsCtrl.searchText"\
              md-items="item in $mdContactChipsCtrl.queryContact($mdContactChipsCtrl.searchText)"\
              md-item-text="$mdContactChipsCtrl.mdContactName"\
              md-no-cache="true"\
              md-autoselect\
              placeholder="{{$mdContactChipsCtrl.contacts.length == 0 ?\
                  $mdContactChipsCtrl.placeholder : $mdContactChipsCtrl.secondaryPlaceholder}}">\
            <div class="md-contact-suggestion">\
              <img \
                  ng-src="{{item[$mdContactChipsCtrl.contactImage]}}"\
                  alt="{{item[$mdContactChipsCtrl.contactName]}}" />\
              <span class="md-contact-name" md-highlight-text="$mdContactChipsCtrl.searchText">\
                {{item[$mdContactChipsCtrl.contactName]}}\
              </span>\
              <span class="md-contact-email" >{{item[$mdContactChipsCtrl.contactEmail]}}</span>\
            </div>\
          </md-autocomplete>\
          <md-chip-template>\
            <div class="md-contact-avatar">\
              <img \
                  ng-src="{{$chip[$mdContactChipsCtrl.contactImage]}}"\
                  alt="{{$chip[$mdContactChipsCtrl.contactName]}}" />\
            </div>\
            <div class="md-contact-name">\
              {{$chip[$mdContactChipsCtrl.contactName]}}\
            </div>\
          </md-chip-template>\
      </md-chips>';


  /**
   * MDContactChips Directive Definition
   *
   * @param $mdTheming
   * @returns {*}
   * @ngInject
   */
  function MdContactChips ($mdTheming, $mdUtil) {
    return {
      template: function(element, attrs) {
        return MD_CONTACT_CHIPS_TEMPLATE;
      },
      restrict: 'E',
      controller: 'MdContactChipsCtrl',
      controllerAs: '$mdContactChipsCtrl',
      bindToController: true,
      compile: compile,
      scope: {
        contactQuery: '&mdContacts',
        placeholder: '@',
        secondaryPlaceholder: '@',
        contactName: '@mdContactName',
        contactImage: '@mdContactImage',
        contactEmail: '@mdContactEmail',
        contacts: '=ngModel',
        requireMatch: '=?mdRequireMatch'
      }
    };

    function compile(element, attr) {
      return function postLink(scope, element, attrs, controllers) {

        $mdUtil.initOptionalProperties(scope, attr);
        $mdTheming(element);

        element.attr('tabindex', '-1');
      };
    }
  }
  MdContactChips.$inject = ["$mdTheming", "$mdUtil"];

})();
(function(){
"use strict";

/**
 * @ngdoc directive
 * @name mdTab
 * @module material.components.tabs
 *
 * @restrict E
 *
 * @description
 * Use the `<md-tab>` a nested directive used within `<md-tabs>` to specify a tab with a **label** and optional *view content*.
 *
 * If the `label` attribute is not specified, then an optional `<md-tab-label>` tag can be used to specify more
 * complex tab header markup. If neither the **label** nor the **md-tab-label** are specified, then the nested
 * markup of the `<md-tab>` is used as the tab header markup.
 *
 * Please note that if you use `<md-tab-label>`, your content **MUST** be wrapped in the `<md-tab-body>` tag.  This
 * is to define a clear separation between the tab content and the tab label.
 *
 * If a tab **label** has been identified, then any **non-**`<md-tab-label>` markup
 * will be considered tab content and will be transcluded to the internal `<div class="md-tabs-content">` container.
 *
 * This container is used by the TabsController to show/hide the active tab's content view. This synchronization is
 * automatically managed by the internal TabsController whenever the tab selection changes. Selection changes can
 * be initiated via data binding changes, programmatic invocation, or user gestures.
 *
 * @param {string=} label Optional attribute to specify a simple string as the tab label
 * @param {boolean=} disabled If present, disabled tab selection.
 * @param {expression=} md-on-deselect Expression to be evaluated after the tab has been de-selected.
 * @param {expression=} md-on-select Expression to be evaluated after the tab has been selected.
 *
 *
 * @usage
 *
 * <hljs lang="html">
 * <md-tab label="" disabled="" md-on-select="" md-on-deselect="" >
 *   <h3>My Tab content</h3>
 * </md-tab>
 *
 * <md-tab >
 *   <md-tab-label>
 *     <h3>My Tab content</h3>
 *   </md-tab-label>
 *   <md-tab-body>
 *     <p>
 *       Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium,
 *       totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae
 *       dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit,
 *       sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt.
 *     </p>
 *   </md-tab-body>
 * </md-tab>
 * </hljs>
 *
 */
angular
    .module('material.components.tabs')
    .directive('mdTab', MdTab);

function MdTab () {
  return {
    require: '^?mdTabs',
    terminal: true,
    template: function (element, attr) {
      var label = getLabel(),
          body  = getTemplate();
      return '' +
          '<md-tab-label>' + label + '</md-tab-label>' +
          '<md-tab-body>' + body + '</md-tab-body>';
      function getLabel () {
        return getLabelElement() || getLabelAttribute() || getElementContents();
        function getLabelAttribute () { return attr.label; }
        function getLabelElement () {
          var label = element.find('md-tab-label').eq(0);
          if (label.length) return label.remove().html();
        }
        function getElementContents () {
          var html = element.html();
          element.empty();
          return html;
        }
      }
      function getTemplate () {
        var content = element.find('md-tab-body').eq(0),
            template = content.length ? content.html() : attr.label ? element.html() : '';
        if (content.length) content.remove();
        else if (attr.label) element.empty();
        return template;
      }
    },
    scope: {
      active:   '=?mdActive',
      disabled: '=?ngDisabled',
      select:   '&?mdOnSelect',
      deselect: '&?mdOnDeselect'
    },
    link: postLink
  };

  function postLink (scope, element, attr, ctrl) {
    if (!ctrl) return;
    var tabs = element.parent()[0].getElementsByTagName('md-tab'),
        index = Array.prototype.indexOf.call(tabs, element[0]),
        body = element.find('md-tab-body').eq(0).remove(),
        label = element.find('md-tab-label').eq(0).remove(),
        data = ctrl.insertTab({
          scope:    scope,
          parent:   scope.$parent,
          index:    index,
          element:  element,
          template: body.html(),
          label:    label.html()
        }, index);

    scope.select   = scope.select   || angular.noop;
    scope.deselect = scope.deselect || angular.noop;

    scope.$watch('active', function (active) { if (active) ctrl.select(data.getIndex()); });
    scope.$watch('disabled', function () { ctrl.refreshIndex(); });
    scope.$watch(
        function () {
          return Array.prototype.indexOf.call(tabs, element[0]);
        },
        function (newIndex) {
          data.index = newIndex;
          ctrl.updateTabOrder();
        }
    );
    scope.$on('$destroy', function () { ctrl.removeTab(data); });

  }
}

})();
(function(){
"use strict";

angular
    .module('material.components.tabs')
    .directive('mdTabItem', MdTabItem);

function MdTabItem () {
  return {
    require: '^?mdTabs',
    link: function link (scope, element, attr, ctrl) {
      if (!ctrl) return;
      ctrl.attachRipple(scope, element);
    }
  };
}

})();
(function(){
"use strict";

angular
    .module('material.components.tabs')
    .directive('mdTabLabel', MdTabLabel);

function MdTabLabel () {
  return { terminal: true };
}


})();
(function(){
"use strict";

angular.module('material.components.tabs')
    .directive('mdTabScroll', MdTabScroll);

function MdTabScroll ($parse) {
  return {
    restrict: 'A',
    compile: function ($element, attr) {
      var fn = $parse(attr.mdTabScroll, null, true);
      return function ngEventHandler (scope, element) {
        element.on('mousewheel', function (event) {
          scope.$apply(function () { fn(scope, { $event: event }); });
        });
      };
    }
  }
}
MdTabScroll.$inject = ["$parse"];

})();
(function(){
"use strict";

angular
    .module('material.components.tabs')
    .controller('MdTabsController', MdTabsController);

/**
 * @ngInject
 */
function MdTabsController ($scope, $element, $window, $timeout, $mdConstant, $mdTabInkRipple,
                           $mdUtil, $animate, $attrs, $compile, $mdTheming) {
  //-- define private properties
  var ctrl       = this,
      locked     = false,
      elements   = getElements(),
      queue      = [],
      destroyed  = false,
      loaded     = false;

  //-- define public properties with change handlers
  defineProperty('focusIndex', handleFocusIndexChange, $scope.selectedIndex || 0);
  defineProperty('offsetLeft', handleOffsetChange, 0);
  defineProperty('hasContent', handleHasContent, false);

  //-- define public properties
  ctrl.scope = $scope;
  ctrl.parent = $scope.$parent;
  ctrl.tabs = [];
  ctrl.lastSelectedIndex = null;
  ctrl.hasFocus = false;
  ctrl.lastClick = true;
  ctrl.shouldPaginate = false;
  ctrl.shouldCenterTabs = shouldCenterTabs();

  //-- define public methods
  ctrl.redirectFocus = redirectFocus;
  ctrl.attachRipple = attachRipple;
  ctrl.shouldStretchTabs = shouldStretchTabs;
  ctrl.insertTab = insertTab;
  ctrl.removeTab = removeTab;
  ctrl.select = select;
  ctrl.scroll = scroll;
  ctrl.nextPage = nextPage;
  ctrl.previousPage = previousPage;
  ctrl.keydown = keydown;
  ctrl.canPageForward = canPageForward;
  ctrl.canPageBack = canPageBack;
  ctrl.refreshIndex = refreshIndex;
  ctrl.incrementSelectedIndex = incrementSelectedIndex;
  ctrl.updateInkBarStyles = $mdUtil.debounce(updateInkBarStyles, 100);
  ctrl.updateTabOrder = $mdUtil.debounce(updateTabOrder, 100);

  init();

  /**
   * Perform initialization for the controller, setup events and watcher(s)
   */
  function init () {
    $scope.selectedIndex = $scope.selectedIndex || 0;
    compileTemplate();
    configureWatchers();
    bindEvents();
    $mdTheming($element);
    $timeout(function () {
      updateHeightFromContent();
      adjustOffset();
      updatePagination();
      ctrl.tabs[$scope.selectedIndex] && ctrl.tabs[$scope.selectedIndex].scope.select();
      loaded = true;
    });
  }

  function compileTemplate () {
    var template = $attrs.$mdTabsTemplate,
        element  = angular.element(elements.data);
    element.html(template);
    $compile(element.contents())(ctrl.parent);
    delete $attrs.$mdTabsTemplate;
  }

  function bindEvents () {
    angular.element($window).on('resize', handleWindowResize);
    angular.element(elements.paging).on('DOMSubtreeModified', ctrl.updateInkBarStyles);
    angular.element(elements.paging).on('DOMSubtreeModified', updatePagination);
  }

  function configureWatchers () {
    $mdUtil.initOptionalProperties($scope, $attrs);
    $attrs.$observe('mdNoBar', function (value) { $scope.noInkBar = angular.isDefined(value); });
    $scope.$watch('selectedIndex', handleSelectedIndexChange);
    $scope.$watch('dynamicHeight', function (value) {
      if (value) $element.addClass('md-dynamic-height');
      else $element.removeClass('md-dynamic-height');
    });
    $scope.$on('$destroy', cleanup);
  }

  /**
   * Remove any events defined by this controller
   */
  function cleanup () {
    destroyed = true;
    angular.element($window).off('resize', handleWindowResize);
    angular.element(elements.paging).off('DOMSubtreeModified', ctrl.updateInkBarStyles);
    angular.element(elements.paging).off('DOMSubtreeModified', updatePagination);
  }

  //-- Change handlers

  /**
   * Add/remove the `md-no-tab-content` class depending on `ctrl.hasContent`
   * @param hasContent
   */
  function handleHasContent (hasContent) {
    $element[hasContent ? 'removeClass' : 'addClass']('md-no-tab-content');
  }

  /**
   * Apply ctrl.offsetLeft to the paging element when it changes
   * @param left
   */
  function handleOffsetChange (left) {
    var newValue = ctrl.shouldCenterTabs ? '' : '-' + left + 'px';
    angular.element(elements.paging).css($mdConstant.CSS.TRANSFORM, 'translate3d(' + newValue + ', 0, 0)');
    $scope.$broadcast('$mdTabsPaginationChanged');
  }

  /**
   * Update the UI whenever `ctrl.focusIndex` is updated
   * @param newIndex
   * @param oldIndex
   */
  function handleFocusIndexChange (newIndex, oldIndex) {
    if (newIndex === oldIndex) return;
    if (!elements.tabs[newIndex]) return;
    adjustOffset();
    redirectFocus();
  }

  /**
   * Update the UI whenever the selected index changes. Calls user-defined select/deselect methods.
   * @param newValue
   * @param oldValue
   */
  function handleSelectedIndexChange (newValue, oldValue) {
    if (newValue === oldValue) return;

    $scope.selectedIndex = getNearestSafeIndex(newValue);
    ctrl.lastSelectedIndex = oldValue;
    ctrl.updateInkBarStyles();
    updateHeightFromContent();
    adjustOffset(newValue);
    $scope.$broadcast('$mdTabsChanged');
    ctrl.tabs[oldValue] && ctrl.tabs[oldValue].scope.deselect();
    ctrl.tabs[newValue] && ctrl.tabs[newValue].scope.select();
  }

  /**
   * Queues up a call to `handleWindowResize` when a resize occurs while the tabs component is
   * hidden.
   */
  function handleResizeWhenVisible () {
    //-- if there is already a watcher waiting for resize, do nothing
    if (handleResizeWhenVisible.watcher) return;
    //-- otherwise, we will abuse the $watch function to check for visible
    handleResizeWhenVisible.watcher = $scope.$watch(function () {
      //-- since we are checking for DOM size, we use $timeout to wait for after the DOM updates
      $timeout(function () {
        //-- if the watcher has already run (ie. multiple digests in one cycle), do nothing
        if (!handleResizeWhenVisible.watcher) return;

        if ($element.prop('offsetParent')) {
          handleResizeWhenVisible.watcher();
          handleResizeWhenVisible.watcher = null;

          //-- we have to trigger our own $apply so that the DOM bindings will update
          handleWindowResize();
        }
      }, 0, false);
    });
  }

  //-- Event handlers / actions

  /**
   * Handle user keyboard interactions
   * @param event
   */
  function keydown (event) {
    switch (event.keyCode) {
      case $mdConstant.KEY_CODE.LEFT_ARROW:
        event.preventDefault();
        incrementSelectedIndex(-1, true);
        break;
      case $mdConstant.KEY_CODE.RIGHT_ARROW:
        event.preventDefault();
        incrementSelectedIndex(1, true);
        break;
      case $mdConstant.KEY_CODE.SPACE:
      case $mdConstant.KEY_CODE.ENTER:
        event.preventDefault();
        if (!locked) $scope.selectedIndex = ctrl.focusIndex;
        break;
    }
    ctrl.lastClick = false;
  }

  /**
   * Update the selected index and trigger a click event on the original `md-tab` element in order
   * to fire user-added click events.
   * @param index
   */
  function select (index) {
    if (!locked) ctrl.focusIndex = $scope.selectedIndex = index;
    ctrl.lastClick = true;
    ctrl.tabs[index].element.triggerHandler('click');
  }

  /**
   * When pagination is on, this makes sure the selected index is in view.
   * @param event
   */
  function scroll (event) {
    if (!ctrl.shouldPaginate) return;
    event.preventDefault();
    ctrl.offsetLeft = fixOffset(ctrl.offsetLeft - event.wheelDelta);
  }

  /**
   * Slides the tabs over approximately one page forward.
   */
  function nextPage () {
    var viewportWidth = elements.canvas.clientWidth,
        totalWidth = viewportWidth + ctrl.offsetLeft,
        i, tab;
    for (i = 0; i < elements.tabs.length; i++) {
      tab = elements.tabs[i];
      if (tab.offsetLeft + tab.offsetWidth > totalWidth) break;
    }
    ctrl.offsetLeft = fixOffset(tab.offsetLeft);
  }

  /**
   * Slides the tabs over approximately one page backward.
   */
  function previousPage () {
    var i, tab;
    for (i = 0; i < elements.tabs.length; i++) {
      tab = elements.tabs[i];
      if (tab.offsetLeft + tab.offsetWidth >= ctrl.offsetLeft) break;
    }
    ctrl.offsetLeft = fixOffset(tab.offsetLeft + tab.offsetWidth - elements.canvas.clientWidth);
  }

  /**
   * Update size calculations when the window is resized.
   */
  function handleWindowResize () {
    $scope.$apply(function () {
      ctrl.lastSelectedIndex = $scope.selectedIndex;
      ctrl.offsetLeft = fixOffset(ctrl.offsetLeft);
      $timeout(ctrl.updateInkBarStyles, 0, false);
      $timeout(updatePagination);
    });
  }

  /**
   * Remove a tab from the data and select the nearest valid tab.
   * @param tabData
   */
  function removeTab (tabData) {
    var selectedIndex = $scope.selectedIndex,
        tab = ctrl.tabs.splice(tabData.getIndex(), 1)[0];
    refreshIndex();
    //-- when removing a tab, if the selected index did not change, we have to manually trigger the
    //   tab select/deselect events
    if ($scope.selectedIndex === selectedIndex && !destroyed) {
      tab.scope.deselect();
      ctrl.tabs[$scope.selectedIndex] && ctrl.tabs[$scope.selectedIndex].scope.select();
    }
    $timeout(function () {
      updatePagination();
      ctrl.offsetLeft = fixOffset(ctrl.offsetLeft);
    });
  }

  /**
   * Create an entry in the tabs array for a new tab at the specified index.
   * @param tabData
   * @param index
   * @returns {*}
   */
  function insertTab (tabData, index) {
    var proto = {
          getIndex: function () { return ctrl.tabs.indexOf(tab); },
          isActive: function () { return this.getIndex() === $scope.selectedIndex; },
          isLeft:   function () { return this.getIndex() < $scope.selectedIndex; },
          isRight:  function () { return this.getIndex() > $scope.selectedIndex; },
          shouldRender: function () { return !$scope.noDisconnect || this.isActive(); },
          hasFocus: function () { return !ctrl.lastClick
              && ctrl.hasFocus && this.getIndex() === ctrl.focusIndex; },
          id:       $mdUtil.nextUid()
        },
        tab = angular.extend(proto, tabData);
    if (angular.isDefined(index)) {
      ctrl.tabs.splice(index, 0, tab);
    } else {
      ctrl.tabs.push(tab);
    }
    processQueue();
    updateHasContent();
    //-- if autoselect is enabled, select the newly added tab
    if (loaded && $scope.autoselect) $timeout(function () { select(ctrl.tabs.indexOf(tab)); });
    $timeout(updatePagination);
    return tab;
  }

  //-- Getter methods

  /**
   * Gathers references to all of the DOM elements used by this controller.
   * @returns {{}}
   */
  function getElements () {
    var elements      = {};

    //-- gather tab bar elements
    elements.wrapper  = $element[0].getElementsByTagName('md-tabs-wrapper')[0];
    elements.data     = $element[0].getElementsByTagName('md-tab-data')[0];
    elements.canvas   = elements.wrapper.getElementsByTagName('md-tabs-canvas')[0];
    elements.paging   = elements.canvas.getElementsByTagName('md-pagination-wrapper')[0];
    elements.tabs     = elements.paging.getElementsByTagName('md-tab-item');
    elements.dummies  = elements.canvas.getElementsByTagName('md-dummy-tab');
    elements.inkBar   = elements.paging.getElementsByTagName('md-ink-bar')[0];

    //-- gather tab content elements
    elements.contentsWrapper = $element[0].getElementsByTagName('md-tabs-content-wrapper')[0];
    elements.contents = elements.contentsWrapper.getElementsByTagName('md-tab-content');

    return elements;
  }

  /**
   * Determines whether or not the left pagination arrow should be enabled.
   * @returns {boolean}
   */
  function canPageBack () {
    return ctrl.offsetLeft > 0;
  }

  /**
   * Determines whether or not the right pagination arrow should be enabled.
   * @returns {*|boolean}
   */
  function canPageForward () {
    var lastTab = elements.tabs[elements.tabs.length - 1];
    return lastTab && lastTab.offsetLeft + lastTab.offsetWidth > elements.canvas.clientWidth +
        ctrl.offsetLeft;
  }

  /**
   * Determines if the UI should stretch the tabs to fill the available space.
   * @returns {*}
   */
  function shouldStretchTabs () {
    switch ($scope.stretchTabs) {
      case 'always': return true;
      case 'never':  return false;
      default:       return !ctrl.shouldPaginate
          && $window.matchMedia('(max-width: 600px)').matches;
    }
  }

  /**
   * Determines if the tabs should appear centered.
   * @returns {string|boolean}
   */
  function shouldCenterTabs () {
    return $scope.centerTabs && !ctrl.shouldPaginate;
  }

  /**
   * Determines if pagination is necessary to display the tabs within the available space.
   * @returns {boolean}
   */
  function shouldPaginate () {
    if ($scope.noPagination || !loaded) return false;
    var canvasWidth = $element.prop('clientWidth');
    angular.forEach(elements.dummies, function (tab) { canvasWidth -= tab.offsetWidth; });
    return canvasWidth < 0;
  }

  /**
   * Finds the nearest tab index that is available.  This is primarily used for when the active
   * tab is removed.
   * @param newIndex
   * @returns {*}
   */
  function getNearestSafeIndex(newIndex) {
    var maxOffset = Math.max(ctrl.tabs.length - newIndex, newIndex),
        i, tab;
    for (i = 0; i <= maxOffset; i++) {
      tab = ctrl.tabs[newIndex + i];
      if (tab && (tab.scope.disabled !== true)) return tab.getIndex();
      tab = ctrl.tabs[newIndex - i];
      if (tab && (tab.scope.disabled !== true)) return tab.getIndex();
    }
    return newIndex;
  }

  //-- Utility methods

  /**
   * Defines a property using a getter and setter in order to trigger a change handler without
   * using `$watch` to observe changes.
   * @param key
   * @param handler
   * @param value
   */
  function defineProperty (key, handler, value) {
    Object.defineProperty(ctrl, key, {
      get: function () { return value; },
      set: function (newValue) {
        var oldValue = value;
        value = newValue;
        handler(newValue, oldValue);
      }
    });
  }

  /**
   * Updates whether or not pagination should be displayed.
   */
  function updatePagination () {
    ctrl.shouldPaginate = shouldPaginate();
    ctrl.shouldCenterTabs = shouldCenterTabs();
    $timeout(function () {
      adjustOffset($scope.selectedIndex);
    });
  }

  /**
   * Re-orders the tabs and updates the selected and focus indexes to their new positions.
   * This is triggered by `tabDirective.js` when the user's tabs have been re-ordered.
   */
  function updateTabOrder () {
    var selectedItem = ctrl.tabs[$scope.selectedIndex],
        focusItem = ctrl.tabs[ctrl.focusIndex];
    ctrl.tabs = ctrl.tabs.sort(function (a, b) {
      return a.index - b.index;
    });
    $scope.selectedIndex = ctrl.tabs.indexOf(selectedItem);
    ctrl.focusIndex = ctrl.tabs.indexOf(focusItem);
  }

  /**
   * This moves the selected or focus index left or right.  This is used by the keydown handler.
   * @param inc
   */
  function incrementSelectedIndex (inc) {
    var newIndex,
        index = ctrl.focusIndex;
    for (newIndex = index + inc;
         ctrl.tabs[newIndex] && ctrl.tabs[newIndex].scope.disabled;
         newIndex += inc) {}
    if (ctrl.tabs[newIndex]) {
      ctrl.focusIndex = newIndex;
    }
  }

  /**
   * This is used to forward focus to dummy elements.  This method is necessary to avoid aniation
   * issues when attempting to focus an item that is out of view.
   */
  function redirectFocus () {
    elements.dummies[ctrl.focusIndex].focus();
  }

  /**
   * Forces the pagination to move the focused tab into view.
   */
  function adjustOffset (index) {
    if (!elements.tabs[index]) return;
    if (ctrl.shouldCenterTabs) return;
    if (index == null) index = ctrl.focusIndex;
    var tab = elements.tabs[index],
        left = tab.offsetLeft,
        right = tab.offsetWidth + left;
    ctrl.offsetLeft = Math.max(ctrl.offsetLeft, fixOffset(right - elements.canvas.clientWidth));
    ctrl.offsetLeft = Math.min(ctrl.offsetLeft, fixOffset(left));
  }

  /**
   * Iterates through all queued functions and clears the queue.  This is used for functions that
   * are called before the UI is ready, such as size calculations.
   */
  function processQueue () {
    queue.forEach(function (func) { $timeout(func); });
    queue = [];
  }

  /**
   * Determines if the tab content area is needed.
   */
  function updateHasContent () {
    var hasContent = false;
    angular.forEach(ctrl.tabs, function (tab) {
      if (tab.template) hasContent = true;
    });
    ctrl.hasContent = hasContent;
  }

  /**
   * Moves the indexes to their nearest valid values.
   */
  function refreshIndex () {
    $scope.selectedIndex = getNearestSafeIndex($scope.selectedIndex);
    ctrl.focusIndex = getNearestSafeIndex(ctrl.focusIndex);
  }

  /**
   * Calculates the content height of the current tab.
   * @returns {*}
   */
  function updateHeightFromContent () {
    if (!$scope.dynamicHeight) return $element.css('height', '');
    if (!ctrl.tabs.length) return queue.push(updateHeightFromContent);
    var tabContent    = elements.contents[$scope.selectedIndex],
        contentHeight = tabContent ? tabContent.offsetHeight : 0,
        tabsHeight    = elements.wrapper.offsetHeight,
        newHeight     = contentHeight + tabsHeight,
        currentHeight = $element.prop('clientHeight');
    if (currentHeight === newHeight) return;
    locked = true;
    $animate
        .animate(
          $element,
          { height: currentHeight + 'px' },
          { height: newHeight + 'px'}
        )
        .then(function () {
          $element.css('height', '');
          locked = false;
        });
  }

  /**
   * Repositions the ink bar to the selected tab.
   * @returns {*}
   */
  function updateInkBarStyles () {
    if (!elements.tabs[$scope.selectedIndex]) return;
    if (!ctrl.tabs.length) return queue.push(ctrl.updateInkBarStyles);
    //-- if the element is not visible, we will not be able to calculate sizes until it is
    //-- we should treat that as a resize event rather than just updating the ink bar
    if (!$element.prop('offsetParent')) return handleResizeWhenVisible();
    var index = $scope.selectedIndex,
        totalWidth = elements.paging.offsetWidth,
        tab = elements.tabs[index],
        left = tab.offsetLeft,
        right = totalWidth - left - tab.offsetWidth;
    updateInkBarClassName();
    angular.element(elements.inkBar).css({ left: left + 'px', right: right + 'px' });
  }

  /**
   * Adds left/right classes so that the ink bar will animate properly.
   */
  function updateInkBarClassName () {
    var newIndex = $scope.selectedIndex,
        oldIndex = ctrl.lastSelectedIndex,
        ink = angular.element(elements.inkBar);
    if (!angular.isNumber(oldIndex)) return;
    if (newIndex < oldIndex) {
      ink.addClass('md-left').removeClass('md-right');
    } else if (newIndex > oldIndex) {
      ink.addClass('md-right').removeClass('md-left');
    }
  }

  /**
   * Takes an offset value and makes sure that it is within the min/max allowed values.
   * @param value
   * @returns {*}
   */
  function fixOffset (value) {
    if (!elements.tabs.length || !ctrl.shouldPaginate) return 0;
    var lastTab = elements.tabs[elements.tabs.length - 1],
        totalWidth = lastTab.offsetLeft + lastTab.offsetWidth;
    value = Math.max(0, value);
    value = Math.min(totalWidth - elements.canvas.clientWidth, value);
    return value;
  }

  /**
   * Attaches a ripple to the tab item element.
   * @param scope
   * @param element
   */
  function attachRipple (scope, element) {
    var options = { colorElement: angular.element(elements.inkBar) };
    $mdTabInkRipple.attach(scope, element, options);
  }
}
MdTabsController.$inject = ["$scope", "$element", "$window", "$timeout", "$mdConstant", "$mdTabInkRipple", "$mdUtil", "$animate", "$attrs", "$compile", "$mdTheming"];

})();
(function(){
"use strict";

/**
 * @ngdoc directive
 * @name mdTabs
 * @module material.components.tabs
 *
 * @restrict E
 *
 * @description
 * The `<md-tabs>` directive serves as the container for 1..n `<md-tab>` child directives to produces a Tabs components.
 * In turn, the nested `<md-tab>` directive is used to specify a tab label for the **header button** and a [optional] tab view
 * content that will be associated with each tab button.
 *
 * Below is the markup for its simplest usage:
 *
 *  <hljs lang="html">
 *  <md-tabs>
 *    <md-tab label="Tab #1"></md-tab>
 *    <md-tab label="Tab #2"></md-tab>
 *    <md-tab label="Tab #3"></md-tab>
 *  </md-tabs>
 *  </hljs>
 *
 * Tabs supports three (3) usage scenarios:
 *
 *  1. Tabs (buttons only)
 *  2. Tabs with internal view content
 *  3. Tabs with external view content
 *
 * **Tab-only** support is useful when tab buttons are used for custom navigation regardless of any other components, content, or views.
 * **Tabs with internal views** are the traditional usages where each tab has associated view content and the view switching is managed internally by the Tabs component.
 * **Tabs with external view content** is often useful when content associated with each tab is independently managed and data-binding notifications announce tab selection changes.
 *
 * Additional features also include:
 *
 * *  Content can include any markup.
 * *  If a tab is disabled while active/selected, then the next tab will be auto-selected.
 *
 * ### Explanation of tab stretching
 *
 * Initially, tabs will have an inherent size.  This size will either be defined by how much space is needed to accommodate their text or set by the user through CSS.  Calculations will be based on this size.
 *
 * On mobile devices, tabs will be expanded to fill the available horizontal space.  When this happens, all tabs will become the same size.
 *
 * On desktops, by default, stretching will never occur.
 *
 * This default behavior can be overridden through the `md-stretch-tabs` attribute.  Here is a table showing when stretching will occur:
 *
 * `md-stretch-tabs` | mobile    | desktop
 * ------------------|-----------|--------
 * `auto`            | stretched | ---
 * `always`          | stretched | stretched
 * `never`           | ---       | ---
 *
 * @param {integer=} md-selected Index of the active/selected tab
 * @param {boolean=} md-no-ink If present, disables ink ripple effects.
 * @param {boolean=} md-no-bar If present, disables the selection ink bar.
 * @param {string=}  md-align-tabs Attribute to indicate position of tab buttons: `bottom` or `top`; default is `top`
 * @param {string=} md-stretch-tabs Attribute to indicate whether or not to stretch tabs: `auto`, `always`, or `never`; default is `auto`
 * @param {boolean=} md-dynamic-height When enabled, the tab wrapper will resize based on the contents of the selected tab
 * @param {boolean=} md-center-tabs When enabled, tabs will be centered provided there is no need for pagination
 * @param {boolean=} md-no-pagination When enabled, pagination will remain off
 * @param {boolean=} md-swipe-content When enabled, swipe gestures will be enabled for the content area to jump between tabs
 * @param {boolean=} md-no-disconnect If your tab content has background tasks (ie. event listeners), you will want to include this to prevent the scope from being disconnected
 * @param {boolean=} md-autoselect When present, any tabs added after the initial load will be automatically selected
 *
 * @usage
 * <hljs lang="html">
 * <md-tabs md-selected="selectedIndex" >
 *   <img ng-src="img/angular.png" class="centered">
 *   <md-tab
 *       ng-repeat="tab in tabs | orderBy:predicate:reversed"
 *       md-on-select="onTabSelected(tab)"
 *       md-on-deselect="announceDeselected(tab)"
 *       ng-disabled="tab.disabled">
 *     <md-tab-label>
 *       {{tab.title}}
 *       <img src="img/removeTab.png" ng-click="removeTab(tab)" class="delete">
 *     </md-tab-label>
 *     <md-tab-body>
 *       {{tab.content}}
 *     </md-tab-body>
 *   </md-tab>
 * </md-tabs>
 * </hljs>
 *
 */
angular
    .module('material.components.tabs')
    .directive('mdTabs', MdTabs);

function MdTabs ($mdTheming, $mdUtil, $compile) {
  return {
    scope: {
      noPagination:  '=?mdNoPagination',
      dynamicHeight: '=?mdDynamicHeight',
      centerTabs:    '=?mdCenterTabs',
      selectedIndex: '=?mdSelected',
      stretchTabs:   '@?mdStretchTabs',
      swipeContent:  '=?mdSwipeContent',
      noDisconnect:  '=?mdNoDisconnect',
      autoselect:    '=?mdAutoselect'
    },
    template: function (element, attr) {
      attr["$mdTabsTemplate"] = element.html();
      return '\
        <md-tabs-wrapper ng-class="{ \'md-stretch-tabs\': $mdTabsCtrl.shouldStretchTabs() }">\
          <md-tab-data></md-tab-data>\
          <md-prev-button\
              tabindex="-1"\
              role="button"\
              aria-label="Previous Page"\
              aria-disabled="{{!$mdTabsCtrl.canPageBack()}}"\
              ng-class="{ \'md-disabled\': !$mdTabsCtrl.canPageBack() }"\
              ng-if="$mdTabsCtrl.shouldPaginate"\
              ng-click="$mdTabsCtrl.previousPage()">\
            <md-icon md-svg-icon="md-tabs-arrow"></md-icon>\
          </md-prev-button>\
          <md-next-button\
              tabindex="-1"\
              role="button"\
              aria-label="Next Page"\
              aria-disabled="{{!$mdTabsCtrl.canPageForward()}}"\
              ng-class="{ \'md-disabled\': !$mdTabsCtrl.canPageForward() }"\
              ng-if="$mdTabsCtrl.shouldPaginate"\
              ng-click="$mdTabsCtrl.nextPage()">\
            <md-icon md-svg-icon="md-tabs-arrow"></md-icon>\
          </md-next-button>\
          <md-tabs-canvas\
              tabindex="0"\
              aria-activedescendant="tab-item-{{$mdTabsCtrl.tabs[$mdTabsCtrl.focusIndex].id}}"\
              ng-focus="$mdTabsCtrl.redirectFocus()"\
              ng-class="{\
                  \'md-paginated\': $mdTabsCtrl.shouldPaginate,\
                  \'md-center-tabs\': $mdTabsCtrl.shouldCenterTabs\
              }"\
              ng-keydown="$mdTabsCtrl.keydown($event)"\
              role="tablist">\
            <md-pagination-wrapper\
                ng-class="{ \'md-center-tabs\': $mdTabsCtrl.shouldCenterTabs }"\
                md-tab-scroll="$mdTabsCtrl.scroll($event)">\
              <md-tab-item\
                  tabindex="-1"\
                  class="md-tab"\
                  style="max-width: {{ tabWidth ? tabWidth + \'px\' : \'none\' }}"\
                  ng-repeat="tab in $mdTabsCtrl.tabs"\
                  role="tab"\
                  aria-controls="tab-content-{{tab.id}}"\
                  aria-selected="{{tab.isActive()}}"\
                  aria-disabled="{{tab.scope.disabled || \'false\'}}"\
                  ng-click="$mdTabsCtrl.select(tab.getIndex())"\
                  ng-class="{\
                      \'md-active\':    tab.isActive(),\
                      \'md-focused\':   tab.hasFocus(),\
                      \'md-disabled\':  tab.scope.disabled\
                  }"\
                  ng-disabled="tab.scope.disabled"\
                  md-swipe-left="$mdTabsCtrl.nextPage()"\
                  md-swipe-right="$mdTabsCtrl.previousPage()"\
                  md-template="tab.label"\
                  md-scope="tab.parent"></md-tab-item>\
              <md-ink-bar ng-hide="noInkBar"></md-ink-bar>\
            </md-pagination-wrapper>\
            <div class="md-visually-hidden md-dummy-wrapper">\
              <md-dummy-tab\
                  class="md-tab"\
                  tabindex="-1"\
                  id="tab-item-{{tab.id}}"\
                  role="tab"\
                  aria-controls="tab-content-{{tab.id}}"\
                  aria-selected="{{tab.isActive()}}"\
                  aria-disabled="{{tab.scope.disabled || \'false\'}}"\
                  ng-focus="$mdTabsCtrl.hasFocus = true"\
                  ng-blur="$mdTabsCtrl.hasFocus = false"\
                  ng-repeat="tab in $mdTabsCtrl.tabs"\
                  md-template="tab.label"\
                  md-scope="tab.parent"></md-dummy-tab>\
            </div>\
          </md-tabs-canvas>\
        </md-tabs-wrapper>\
        <md-tabs-content-wrapper ng-show="$mdTabsCtrl.hasContent">\
          <md-tab-content\
              id="tab-content-{{tab.id}}"\
              role="tabpanel"\
              aria-labelledby="tab-item-{{tab.id}}"\
              md-swipe-left="swipeContent && $mdTabsCtrl.incrementSelectedIndex(1)"\
              md-swipe-right="swipeContent && $mdTabsCtrl.incrementSelectedIndex(-1)"\
              ng-if="$mdTabsCtrl.hasContent"\
              ng-repeat="(index, tab) in $mdTabsCtrl.tabs"\
              md-connected-if="tab.isActive()"\
              ng-class="{\
                \'md-no-transition\': $mdTabsCtrl.lastSelectedIndex == null,\
                \'md-active\':        tab.isActive(),\
                \'md-left\':          tab.isLeft(),\
                \'md-right\':         tab.isRight(),\
                \'md-no-scroll\':     dynamicHeight\
              }">\
            <div\
                md-template="tab.template"\
                md-scope="tab.parent"\
                ng-if="tab.shouldRender()"></div>\
          </md-tab-content>\
        </md-tabs-content-wrapper>\
      ';
    },
    controller: 'MdTabsController',
    controllerAs: '$mdTabsCtrl'
  };
}
MdTabs.$inject = ["$mdTheming", "$mdUtil", "$compile"];

})();
(function(){
"use strict";

angular
    .module('material.components.tabs')
    .directive('mdTemplate', MdTemplate);

function MdTemplate ($compile, $mdUtil, $timeout) {
  return {
    restrict: 'A',
    link: link,
    scope: {
      template: '=mdTemplate',
      compileScope: '=mdScope',
      connected: '=?mdConnectedIf'
    },
    require: '^?mdTabs'
  };
  function link (scope, element, attr, ctrl) {
    if (!ctrl) return;
    var compileScope = scope.compileScope.$new();
    element.html(scope.template);
    $compile(element.contents())(compileScope);
    return $timeout(handleScope);
    function handleScope () {
      scope.$watch('connected', function (value) { value === false ? disconnect() : reconnect(); });
      scope.$on('$destroy', reconnect);
    }
    function disconnect () {
      if (ctrl.scope.noDisconnect) return;
      $mdUtil.disconnectScope(compileScope);
    }
    function reconnect () {
      if (ctrl.scope.noDisconnect) return;
      $mdUtil.reconnectScope(compileScope);
    }
  }
}
MdTemplate.$inject = ["$compile", "$mdUtil", "$timeout"];

})();
(function(){ 
angular.module("material.core").constant("$MD_THEME_CSS", "/* mixin definition ; sets LTR and RTL within the same style call */md-autocomplete.md-THEME_NAME-theme {  background: '{{background-50}}'; }  md-autocomplete.md-THEME_NAME-theme[disabled] {    background: '{{background-100}}'; }  md-autocomplete.md-THEME_NAME-theme button md-icon path {    fill: '{{background-600}}'; }  md-autocomplete.md-THEME_NAME-theme button:after {    background: '{{background-600-0.3}}'; }.md-autocomplete-suggestions.md-THEME_NAME-theme {  background: '{{background-50}}'; }  .md-autocomplete-suggestions.md-THEME_NAME-theme li {    color: '{{background-900}}'; }    .md-autocomplete-suggestions.md-THEME_NAME-theme li .highlight {      color: '{{background-600}}'; }    .md-autocomplete-suggestions.md-THEME_NAME-theme li:hover, .md-autocomplete-suggestions.md-THEME_NAME-theme li.selected {      background: '{{background-200}}'; }md-backdrop.md-opaque.md-THEME_NAME-theme {  background-color: '{{foreground-4-0.5}}'; }md-bottom-sheet.md-THEME_NAME-theme {  background-color: '{{background-50}}';  border-top-color: '{{background-300}}'; }  md-bottom-sheet.md-THEME_NAME-theme.md-list md-list-item {    color: '{{foreground-1}}'; }  md-bottom-sheet.md-THEME_NAME-theme .md-subheader {    background-color: '{{background-50}}'; }  md-bottom-sheet.md-THEME_NAME-theme .md-subheader {    color: '{{foreground-1}}'; }a.md-button.md-THEME_NAME-theme, .md-button.md-THEME_NAME-theme {  border-radius: 3px; }  a.md-button.md-THEME_NAME-theme:not([disabled]):hover, .md-button.md-THEME_NAME-theme:not([disabled]):hover {    background-color: '{{background-500-0.2}}'; }  a.md-button.md-THEME_NAME-theme:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme:not([disabled]).md-focused {    background-color: '{{background-500-0.2}}'; }  a.md-button.md-THEME_NAME-theme:not([disabled]).md-icon-button:hover, .md-button.md-THEME_NAME-theme:not([disabled]).md-icon-button:hover {    background-color: transparent; }  a.md-button.md-THEME_NAME-theme.md-fab, .md-button.md-THEME_NAME-theme.md-fab {    border-radius: 50%;    background-color: '{{accent-color}}';    color: '{{accent-contrast}}'; }    a.md-button.md-THEME_NAME-theme.md-fab md-icon, .md-button.md-THEME_NAME-theme.md-fab md-icon {      color: '{{accent-contrast}}'; }    a.md-button.md-THEME_NAME-theme.md-fab:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-fab:not([disabled]):hover {      background-color: '{{accent-color}}'; }    a.md-button.md-THEME_NAME-theme.md-fab:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-fab:not([disabled]).md-focused {      background-color: '{{accent-A700}}'; }  a.md-button.md-THEME_NAME-theme.md-icon-button, .md-button.md-THEME_NAME-theme.md-icon-button {    border-radius: 50%; }  a.md-button.md-THEME_NAME-theme.md-primary, .md-button.md-THEME_NAME-theme.md-primary {    color: '{{primary-color}}'; }    a.md-button.md-THEME_NAME-theme.md-primary.md-raised, a.md-button.md-THEME_NAME-theme.md-primary.md-fab, .md-button.md-THEME_NAME-theme.md-primary.md-raised, .md-button.md-THEME_NAME-theme.md-primary.md-fab {      color: '{{primary-contrast}}';      background-color: '{{primary-color}}'; }      a.md-button.md-THEME_NAME-theme.md-primary.md-raised:not([disabled]) md-icon, a.md-button.md-THEME_NAME-theme.md-primary.md-fab:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-primary.md-raised:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-primary.md-fab:not([disabled]) md-icon {        color: '{{primary-contrast}}'; }      a.md-button.md-THEME_NAME-theme.md-primary.md-raised:not([disabled]):hover, a.md-button.md-THEME_NAME-theme.md-primary.md-fab:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-primary.md-raised:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-primary.md-fab:not([disabled]):hover {        background-color: '{{primary-color}}'; }      a.md-button.md-THEME_NAME-theme.md-primary.md-raised:not([disabled]).md-focused, a.md-button.md-THEME_NAME-theme.md-primary.md-fab:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-primary.md-raised:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-primary.md-fab:not([disabled]).md-focused {        background-color: '{{primary-600}}'; }    a.md-button.md-THEME_NAME-theme.md-primary:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-primary:not([disabled]) md-icon {      color: '{{primary-color}}'; }  a.md-button.md-THEME_NAME-theme.md-fab, .md-button.md-THEME_NAME-theme.md-fab {    border-radius: 50%;    background-color: '{{accent-color}}';    color: '{{accent-contrast}}'; }    a.md-button.md-THEME_NAME-theme.md-fab:not([disabled]) .md-icon, .md-button.md-THEME_NAME-theme.md-fab:not([disabled]) .md-icon {      color: '{{accent-contrast}}'; }    a.md-button.md-THEME_NAME-theme.md-fab:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-fab:not([disabled]):hover {      background-color: '{{accent-color}}'; }    a.md-button.md-THEME_NAME-theme.md-fab:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-fab:not([disabled]).md-focused {      background-color: '{{accent-A700}}'; }  a.md-button.md-THEME_NAME-theme.md-raised, .md-button.md-THEME_NAME-theme.md-raised {    color: '{{background-contrast}}';    background-color: '{{background-50}}'; }    a.md-button.md-THEME_NAME-theme.md-raised:not([disabled]) .md-icon, .md-button.md-THEME_NAME-theme.md-raised:not([disabled]) .md-icon {      color: '{{background-contrast}}'; }    a.md-button.md-THEME_NAME-theme.md-raised:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-raised:not([disabled]):hover {      background-color: '{{background-50}}'; }    a.md-button.md-THEME_NAME-theme.md-raised:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-raised:not([disabled]).md-focused {      background-color: '{{background-200}}'; }  a.md-button.md-THEME_NAME-theme.md-warn, .md-button.md-THEME_NAME-theme.md-warn {    color: '{{warn-color}}'; }    a.md-button.md-THEME_NAME-theme.md-warn.md-raised, a.md-button.md-THEME_NAME-theme.md-warn.md-fab, .md-button.md-THEME_NAME-theme.md-warn.md-raised, .md-button.md-THEME_NAME-theme.md-warn.md-fab {      color: '{{warn-contrast}}';      background-color: '{{warn-color}}'; }      a.md-button.md-THEME_NAME-theme.md-warn.md-raised:not([disabled]) md-icon, a.md-button.md-THEME_NAME-theme.md-warn.md-fab:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-warn.md-raised:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-warn.md-fab:not([disabled]) md-icon {        color: '{{warn-contrast}}'; }      a.md-button.md-THEME_NAME-theme.md-warn.md-raised:not([disabled]):hover, a.md-button.md-THEME_NAME-theme.md-warn.md-fab:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-warn.md-raised:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-warn.md-fab:not([disabled]):hover {        background-color: '{{warn-color}}'; }      a.md-button.md-THEME_NAME-theme.md-warn.md-raised:not([disabled]).md-focused, a.md-button.md-THEME_NAME-theme.md-warn.md-fab:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-warn.md-raised:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-warn.md-fab:not([disabled]).md-focused {        background-color: '{{warn-700}}'; }    a.md-button.md-THEME_NAME-theme.md-warn:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-warn:not([disabled]) md-icon {      color: '{{warn-color}}'; }  a.md-button.md-THEME_NAME-theme.md-accent, .md-button.md-THEME_NAME-theme.md-accent {    color: '{{accent-color}}'; }    a.md-button.md-THEME_NAME-theme.md-accent.md-raised, a.md-button.md-THEME_NAME-theme.md-accent.md-fab, .md-button.md-THEME_NAME-theme.md-accent.md-raised, .md-button.md-THEME_NAME-theme.md-accent.md-fab {      color: '{{accent-contrast}}';      background-color: '{{accent-color}}'; }      a.md-button.md-THEME_NAME-theme.md-accent.md-raised:not([disabled]) md-icon, a.md-button.md-THEME_NAME-theme.md-accent.md-fab:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-accent.md-raised:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-accent.md-fab:not([disabled]) md-icon {        color: '{{accent-contrast}}'; }      a.md-button.md-THEME_NAME-theme.md-accent.md-raised:not([disabled]):hover, a.md-button.md-THEME_NAME-theme.md-accent.md-fab:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-accent.md-raised:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-accent.md-fab:not([disabled]):hover {        background-color: '{{accent-color}}'; }      a.md-button.md-THEME_NAME-theme.md-accent.md-raised:not([disabled]).md-focused, a.md-button.md-THEME_NAME-theme.md-accent.md-fab:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-accent.md-raised:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-accent.md-fab:not([disabled]).md-focused {        background-color: '{{accent-700}}'; }    a.md-button.md-THEME_NAME-theme.md-accent:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-accent:not([disabled]) md-icon {      color: '{{accent-color}}'; }  a.md-button.md-THEME_NAME-theme[disabled], a.md-button.md-THEME_NAME-theme.md-raised[disabled], a.md-button.md-THEME_NAME-theme.md-fab[disabled], a.md-button.md-THEME_NAME-theme.md-accent[disabled], a.md-button.md-THEME_NAME-theme.md-warn[disabled], .md-button.md-THEME_NAME-theme[disabled], .md-button.md-THEME_NAME-theme.md-raised[disabled], .md-button.md-THEME_NAME-theme.md-fab[disabled], .md-button.md-THEME_NAME-theme.md-accent[disabled], .md-button.md-THEME_NAME-theme.md-warn[disabled] {    color: '{{foreground-3}}';    cursor: not-allowed; }    a.md-button.md-THEME_NAME-theme[disabled] md-icon, a.md-button.md-THEME_NAME-theme.md-raised[disabled] md-icon, a.md-button.md-THEME_NAME-theme.md-fab[disabled] md-icon, a.md-button.md-THEME_NAME-theme.md-accent[disabled] md-icon, a.md-button.md-THEME_NAME-theme.md-warn[disabled] md-icon, .md-button.md-THEME_NAME-theme[disabled] md-icon, .md-button.md-THEME_NAME-theme.md-raised[disabled] md-icon, .md-button.md-THEME_NAME-theme.md-fab[disabled] md-icon, .md-button.md-THEME_NAME-theme.md-accent[disabled] md-icon, .md-button.md-THEME_NAME-theme.md-warn[disabled] md-icon {      color: '{{foreground-3}}'; }  a.md-button.md-THEME_NAME-theme.md-raised[disabled], a.md-button.md-THEME_NAME-theme.md-fab[disabled], .md-button.md-THEME_NAME-theme.md-raised[disabled], .md-button.md-THEME_NAME-theme.md-fab[disabled] {    background-color: '{{foreground-4}}'; }  a.md-button.md-THEME_NAME-theme[disabled], .md-button.md-THEME_NAME-theme[disabled] {    background-color: transparent; }md-card.md-THEME_NAME-theme {  background-color: '{{background-color}}';  border-radius: 2px; }  md-card.md-THEME_NAME-theme .md-card-image {    border-radius: 2px 2px 0 0; }md-checkbox.md-THEME_NAME-theme .md-ripple {  color: '{{accent-600}}'; }md-checkbox.md-THEME_NAME-theme.md-checked .md-ripple {  color: '{{background-600}}'; }md-checkbox.md-THEME_NAME-theme.md-checked.md-focused .md-container:before {  background-color: '{{accent-color-0.26}}'; }md-checkbox.md-THEME_NAME-theme .md-icon {  border-color: '{{foreground-2}}'; }md-checkbox.md-THEME_NAME-theme.md-checked .md-icon {  background-color: '{{accent-color-0.87}}'; }md-checkbox.md-THEME_NAME-theme.md-checked .md-icon:after {  border-color: '{{background-200}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-primary .md-ripple {  color: '{{primary-600}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked .md-ripple {  color: '{{background-600}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-primary .md-icon {  border-color: '{{foreground-2}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked .md-icon {  background-color: '{{primary-color-0.87}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked.md-focused .md-container:before {  background-color: '{{primary-color-0.26}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked .md-icon:after {  border-color: '{{background-200}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-warn .md-ripple {  color: '{{warn-600}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-warn .md-icon {  border-color: '{{foreground-2}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-warn.md-checked .md-icon {  background-color: '{{warn-color-0.87}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-warn.md-checked.md-focused:not([disabled]) .md-container:before {  background-color: '{{warn-color-0.26}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-warn.md-checked .md-icon:after {  border-color: '{{background-200}}'; }md-checkbox.md-THEME_NAME-theme[disabled] .md-icon {  border-color: '{{foreground-3}}'; }md-checkbox.md-THEME_NAME-theme[disabled].md-checked .md-icon {  background-color: '{{foreground-3}}'; }md-checkbox.md-THEME_NAME-theme[disabled] .md-label {  color: '{{foreground-3}}'; }md-chips.md-THEME_NAME-theme .md-chips {  box-shadow: 0 1px '{{background-300}}'; }  md-chips.md-THEME_NAME-theme .md-chips.md-focused {    box-shadow: 0 2px '{{primary-color}}'; }md-chips.md-THEME_NAME-theme .md-chip {  background: '{{background-300}}';  color: '{{background-800}}'; }  md-chips.md-THEME_NAME-theme .md-chip.md-focused {    background: '{{primary-color}}';    color: '{{primary-contrast}}'; }    md-chips.md-THEME_NAME-theme .md-chip.md-focused md-icon {      color: '{{primary-contrast}}'; }md-chips.md-THEME_NAME-theme md-chip-remove .md-button md-icon path {  fill: '{{background-500}}'; }.md-contact-suggestion span.md-contact-email {  color: '{{background-400}}'; }md-content.md-THEME_NAME-theme {  background-color: '{{background-color}}'; }md-dialog.md-THEME_NAME-theme {  border-radius: 4px;  background-color: '{{background-color}}'; }  md-dialog.md-THEME_NAME-theme.md-content-overflow .md-actions {    border-top-color: '{{foreground-4}}'; }md-divider.md-THEME_NAME-theme {  border-top-color: '{{foreground-4}}'; }md-icon.md-THEME_NAME-theme {  color: '{{foreground-2}}'; }  md-icon.md-THEME_NAME-theme.md-primary {    color: '{{primary-color}}'; }  md-icon.md-THEME_NAME-theme.md-accent {    color: '{{accent-color}}'; }  md-icon.md-THEME_NAME-theme.md-warn {    color: '{{warn-color}}'; }md-input-container.md-THEME_NAME-theme .md-input {  color: '{{foreground-1}}';  border-color: '{{foreground-4}}';  text-shadow: '{{foreground-shadow}}'; }  md-input-container.md-THEME_NAME-theme .md-input::-webkit-input-placeholder, md-input-container.md-THEME_NAME-theme .md-input::-moz-placeholder, md-input-container.md-THEME_NAME-theme .md-input:-moz-placeholder, md-input-container.md-THEME_NAME-theme .md-input:-ms-input-placeholder {    color: '{{foreground-3}}'; }md-input-container.md-THEME_NAME-theme > md-icon {  color: '{{foreground-1}}'; }md-input-container.md-THEME_NAME-theme label, md-input-container.md-THEME_NAME-theme .md-placeholder {  text-shadow: '{{foreground-shadow}}';  color: '{{foreground-3}}'; }md-input-container.md-THEME_NAME-theme ng-messages, md-input-container.md-THEME_NAME-theme [ng-message], md-input-container.md-THEME_NAME-theme [data-ng-message], md-input-container.md-THEME_NAME-theme [x-ng-message] {  color: '{{warn-500}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-has-value label {  color: '{{foreground-2}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-focused .md-input {  border-color: '{{primary-500}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-focused label {  color: '{{primary-500}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-focused md-icon {  color: '{{primary-500}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-focused.md-accent .md-input {  border-color: '{{accent-500}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-focused.md-accent label {  color: '{{accent-500}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-focused.md-warn .md-input {  border-color: '{{warn-500}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-focused.md-warn label {  color: '{{warn-500}}'; }md-input-container.md-THEME_NAME-theme.md-input-invalid .md-input {  border-color: '{{warn-500}}'; }md-input-container.md-THEME_NAME-theme.md-input-invalid.md-input-focused label {  color: '{{warn-500}}'; }md-input-container.md-THEME_NAME-theme.md-input-invalid ng-message, md-input-container.md-THEME_NAME-theme.md-input-invalid data-ng-message, md-input-container.md-THEME_NAME-theme.md-input-invalid x-ng-message, md-input-container.md-THEME_NAME-theme.md-input-invalid [ng-message], md-input-container.md-THEME_NAME-theme.md-input-invalid [data-ng-message], md-input-container.md-THEME_NAME-theme.md-input-invalid [x-ng-message], md-input-container.md-THEME_NAME-theme.md-input-invalid .md-char-counter {  color: '{{warn-500}}'; }md-input-container.md-THEME_NAME-theme .md-input[disabled], [disabled] md-input-container.md-THEME_NAME-theme .md-input {  border-bottom-color: transparent;  color: '{{foreground-3}}';  background-image: linear-gradient(to right, '{{foreground-3}}' 0%, '{{foreground-3}}' 33%, transparent 0%);  background-image: -ms-linear-gradient(left, transparent 0%, '{{foreground-3}}' 100%); }md-list.md-THEME_NAME-theme md-list-item.md-2-line .md-list-item-text h3, md-list.md-THEME_NAME-theme md-list-item.md-2-line .md-list-item-text h4, md-list.md-THEME_NAME-theme md-list-item.md-3-line .md-list-item-text h3, md-list.md-THEME_NAME-theme md-list-item.md-3-line .md-list-item-text h4 {  color: '{{foreground-1}}'; }md-list.md-THEME_NAME-theme md-list-item.md-2-line .md-list-item-text p, md-list.md-THEME_NAME-theme md-list-item.md-3-line .md-list-item-text p {  color: '{{foreground-2}}'; }md-list.md-THEME_NAME-theme .md-proxy-focus.md-focused div.md-no-style {  background-color: '{{background-100}}'; }md-list.md-THEME_NAME-theme md-list-item > md-icon {  color: '{{foreground-2}}'; }  md-list.md-THEME_NAME-theme md-list-item > md-icon.md-highlight {    color: '{{primary-color}}'; }    md-list.md-THEME_NAME-theme md-list-item > md-icon.md-highlight.md-accent {      color: '{{accent-color}}'; }md-list.md-THEME_NAME-theme md-list-item button {  background-color: '{{background-color}}'; }  md-list.md-THEME_NAME-theme md-list-item button.md-button:not([disabled]):hover {    background-color: '{{background-color}}'; }md-menu-content.md-THEME_NAME-theme {  background-color: '{{background-color}}'; }  md-menu-content.md-THEME_NAME-theme md-menu-divider {    background-color: '{{foreground-4}}'; }md-progress-circular.md-THEME_NAME-theme {  background-color: transparent; }  md-progress-circular.md-THEME_NAME-theme .md-inner .md-gap {    border-top-color: '{{primary-color}}';    border-bottom-color: '{{primary-color}}'; }  md-progress-circular.md-THEME_NAME-theme .md-inner .md-left .md-half-circle, md-progress-circular.md-THEME_NAME-theme .md-inner .md-right .md-half-circle {    border-top-color: '{{primary-color}}'; }  md-progress-circular.md-THEME_NAME-theme .md-inner .md-right .md-half-circle {    border-right-color: '{{primary-color}}'; }  md-progress-circular.md-THEME_NAME-theme .md-inner .md-left .md-half-circle {    border-left-color: '{{primary-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-warn .md-inner .md-gap {    border-top-color: '{{warn-color}}';    border-bottom-color: '{{warn-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-warn .md-inner .md-left .md-half-circle, md-progress-circular.md-THEME_NAME-theme.md-warn .md-inner .md-right .md-half-circle {    border-top-color: '{{warn-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-warn .md-inner .md-right .md-half-circle {    border-right-color: '{{warn-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-warn .md-inner .md-left .md-half-circle {    border-left-color: '{{warn-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-accent .md-inner .md-gap {    border-top-color: '{{accent-color}}';    border-bottom-color: '{{accent-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-accent .md-inner .md-left .md-half-circle, md-progress-circular.md-THEME_NAME-theme.md-accent .md-inner .md-right .md-half-circle {    border-top-color: '{{accent-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-accent .md-inner .md-right .md-half-circle {    border-right-color: '{{accent-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-accent .md-inner .md-left .md-half-circle {    border-left-color: '{{accent-color}}'; }md-progress-linear.md-THEME_NAME-theme .md-container {  background-color: '{{primary-100}}'; }md-progress-linear.md-THEME_NAME-theme .md-bar {  background-color: '{{primary-color}}'; }md-progress-linear.md-THEME_NAME-theme.md-warn .md-container {  background-color: '{{warn-100}}'; }md-progress-linear.md-THEME_NAME-theme.md-warn .md-bar {  background-color: '{{warn-color}}'; }md-progress-linear.md-THEME_NAME-theme.md-accent .md-container {  background-color: '{{accent-100}}'; }md-progress-linear.md-THEME_NAME-theme.md-accent .md-bar {  background-color: '{{accent-color}}'; }md-progress-linear.md-THEME_NAME-theme[md-mode=buffer].md-warn .md-bar1 {  background-color: '{{warn-100}}'; }md-progress-linear.md-THEME_NAME-theme[md-mode=buffer].md-warn .md-dashed:before {  background: radial-gradient('{{warn-100}}' 0%, '{{warn-100}}' 16%, transparent 42%); }md-progress-linear.md-THEME_NAME-theme[md-mode=buffer].md-accent .md-bar1 {  background-color: '{{accent-100}}'; }md-progress-linear.md-THEME_NAME-theme[md-mode=buffer].md-accent .md-dashed:before {  background: radial-gradient('{{accent-100}}' 0%, '{{accent-100}}' 16%, transparent 42%); }md-radio-button.md-THEME_NAME-theme .md-off {  border-color: '{{foreground-2}}'; }md-radio-button.md-THEME_NAME-theme .md-on {  background-color: '{{accent-color-0.87}}'; }md-radio-button.md-THEME_NAME-theme.md-checked .md-off {  border-color: '{{accent-color-0.87}}'; }md-radio-button.md-THEME_NAME-theme.md-checked .md-ink-ripple {  color: '{{accent-color-0.87}}'; }md-radio-button.md-THEME_NAME-theme .md-container .md-ripple {  color: '{{accent-600}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-primary .md-on, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-primary .md-on, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-primary .md-on, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-primary .md-on {  background-color: '{{primary-color-0.87}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-primary .md-checked .md-off, md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-primary.md-checked .md-off, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-primary .md-checked .md-off, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-primary .md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-primary.md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-primary .md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked .md-off {  border-color: '{{primary-color-0.87}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-primary .md-checked .md-ink-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-primary.md-checked .md-ink-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-primary .md-checked .md-ink-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-primary .md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-primary.md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-primary .md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked .md-ink-ripple {  color: '{{primary-color-0.87}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-primary .md-container .md-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-primary .md-container .md-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-primary .md-container .md-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-primary .md-container .md-ripple {  color: '{{primary-600}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-warn .md-on, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-warn .md-on, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-warn .md-on, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-warn .md-on {  background-color: '{{warn-color-0.87}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-warn .md-checked .md-off, md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-warn.md-checked .md-off, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-warn .md-checked .md-off, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-warn.md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-warn .md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-warn.md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-warn .md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-warn.md-checked .md-off {  border-color: '{{warn-color-0.87}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-warn .md-checked .md-ink-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-warn.md-checked .md-ink-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-warn .md-checked .md-ink-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-warn.md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-warn .md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-warn.md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-warn .md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-warn.md-checked .md-ink-ripple {  color: '{{warn-color-0.87}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-warn .md-container .md-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-warn .md-container .md-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-warn .md-container .md-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-warn .md-container .md-ripple {  color: '{{warn-600}}'; }md-radio-group.md-THEME_NAME-theme[disabled], md-radio-button.md-THEME_NAME-theme[disabled] {  color: '{{foreground-3}}'; }  md-radio-group.md-THEME_NAME-theme[disabled] .md-container .md-off, md-radio-button.md-THEME_NAME-theme[disabled] .md-container .md-off {    border-color: '{{foreground-3}}'; }  md-radio-group.md-THEME_NAME-theme[disabled] .md-container .md-on, md-radio-button.md-THEME_NAME-theme[disabled] .md-container .md-on {    border-color: '{{foreground-3}}'; }md-radio-group.md-THEME_NAME-theme.md-focused:not(:empty) .md-checked .md-container:before {  background-color: '{{accent-color-0.26}}'; }md-radio-group.md-THEME_NAME-theme.md-focused:not(:empty) .md-checked:not([disabled]).md-primary .md-container:before {  background-color: '{{primary-color-0.26}}'; }md-radio-group.md-THEME_NAME-theme.md-focused:not(:empty) .md-checked.md-primary .md-container:before {  background-color: '{{warn-color-0.26}}'; }md-select.md-THEME_NAME-theme.ng-invalid.ng-dirty .md-select-label {  color: '{{warn-500}}' !important;  border-bottom-color: '{{warn-500}}' !important; }md-select.md-THEME_NAME-theme:not([disabled]):focus .md-select-label {  border-bottom-color: '{{primary-color}}';  color: '{{ foreground-1 }}'; }  md-select.md-THEME_NAME-theme:not([disabled]):focus .md-select-label.md-placeholder {    color: '{{ foreground-1 }}'; }md-select.md-THEME_NAME-theme:not([disabled]):focus.md-accent .md-select-label {  border-bottom-color: '{{accent-color}}'; }md-select.md-THEME_NAME-theme:not([disabled]):focus.md-warn .md-select-label {  border-bottom-color: '{{warn-color}}'; }md-select.md-THEME_NAME-theme[disabled] .md-select-label {  color: '{{foreground-3}}'; }  md-select.md-THEME_NAME-theme[disabled] .md-select-label.md-placeholder {    color: '{{foreground-3}}'; }md-select.md-THEME_NAME-theme .md-select-label {  border-bottom-color: '{{foreground-4}}'; }  md-select.md-THEME_NAME-theme .md-select-label.md-placeholder {    color: '{{foreground-2}}'; }md-select-menu.md-THEME_NAME-theme md-optgroup {  color: '{{foreground-2}}'; }  md-select-menu.md-THEME_NAME-theme md-optgroup md-option {    color: '{{foreground-1}}'; }md-select-menu.md-THEME_NAME-theme md-option[selected] {  color: '{{primary-500}}'; }  md-select-menu.md-THEME_NAME-theme md-option[selected]:focus {    color: '{{primary-600}}'; }  md-select-menu.md-THEME_NAME-theme md-option[selected].md-accent {    color: '{{accent-500}}'; }    md-select-menu.md-THEME_NAME-theme md-option[selected].md-accent:focus {      color: '{{accent-600}}'; }md-select-menu.md-THEME_NAME-theme md-option:focus:not([selected]) {  background: '{{background-200}}'; }md-sidenav.md-THEME_NAME-theme {  background-color: '{{background-color}}'; }md-slider.md-THEME_NAME-theme .md-track {  background-color: '{{foreground-3}}'; }md-slider.md-THEME_NAME-theme .md-track-ticks {  background-color: '{{foreground-4}}'; }md-slider.md-THEME_NAME-theme .md-focus-thumb {  background-color: '{{foreground-2}}'; }md-slider.md-THEME_NAME-theme .md-focus-ring {  border-color: '{{foreground-4}}'; }md-slider.md-THEME_NAME-theme .md-disabled-thumb {  border-color: '{{background-color}}'; }md-slider.md-THEME_NAME-theme.md-min .md-thumb:after {  background-color: '{{background-color}}'; }md-slider.md-THEME_NAME-theme .md-track.md-track-fill {  background-color: '{{accent-color}}'; }md-slider.md-THEME_NAME-theme .md-thumb:after {  border-color: '{{accent-color}}';  background-color: '{{accent-color}}'; }md-slider.md-THEME_NAME-theme .md-sign {  background-color: '{{accent-color}}'; }  md-slider.md-THEME_NAME-theme .md-sign:after {    border-top-color: '{{accent-color}}'; }md-slider.md-THEME_NAME-theme .md-thumb-text {  color: '{{accent-contrast}}'; }md-slider.md-THEME_NAME-theme.md-warn .md-track.md-track-fill {  background-color: '{{warn-color}}'; }md-slider.md-THEME_NAME-theme.md-warn .md-thumb:after {  border-color: '{{warn-color}}';  background-color: '{{warn-color}}'; }md-slider.md-THEME_NAME-theme.md-warn .md-sign {  background-color: '{{warn-color}}'; }  md-slider.md-THEME_NAME-theme.md-warn .md-sign:after {    border-top-color: '{{warn-color}}'; }md-slider.md-THEME_NAME-theme.md-warn .md-thumb-text {  color: '{{warn-contrast}}'; }md-slider.md-THEME_NAME-theme.md-primary .md-track.md-track-fill {  background-color: '{{primary-color}}'; }md-slider.md-THEME_NAME-theme.md-primary .md-thumb:after {  border-color: '{{primary-color}}';  background-color: '{{primary-color}}'; }md-slider.md-THEME_NAME-theme.md-primary .md-sign {  background-color: '{{primary-color}}'; }  md-slider.md-THEME_NAME-theme.md-primary .md-sign:after {    border-top-color: '{{primary-color}}'; }md-slider.md-THEME_NAME-theme.md-primary .md-thumb-text {  color: '{{primary-contrast}}'; }md-slider.md-THEME_NAME-theme[disabled] .md-thumb:after {  border-color: '{{foreground-3}}'; }md-slider.md-THEME_NAME-theme[disabled]:not(.md-min) .md-thumb:after {  background-color: '{{foreground-3}}'; }.md-subheader.md-THEME_NAME-theme {  color: '{{ foreground-2-0.23 }}';  background-color: '{{background-color}}'; }  .md-subheader.md-THEME_NAME-theme.md-primary {    color: '{{primary-color}}'; }  .md-subheader.md-THEME_NAME-theme.md-accent {    color: '{{accent-color}}'; }  .md-subheader.md-THEME_NAME-theme.md-warn {    color: '{{warn-color}}'; }md-switch.md-THEME_NAME-theme .md-thumb {  background-color: '{{background-50}}'; }md-switch.md-THEME_NAME-theme .md-bar {  background-color: '{{background-500}}'; }md-switch.md-THEME_NAME-theme.md-checked .md-thumb {  background-color: '{{accent-color}}'; }md-switch.md-THEME_NAME-theme.md-checked .md-bar {  background-color: '{{accent-color-0.5}}'; }md-switch.md-THEME_NAME-theme.md-checked.md-focused .md-thumb:before {  background-color: '{{accent-color-0.26}}'; }md-switch.md-THEME_NAME-theme.md-checked.md-primary .md-thumb {  background-color: '{{primary-color}}'; }md-switch.md-THEME_NAME-theme.md-checked.md-primary .md-bar {  background-color: '{{primary-color-0.5}}'; }md-switch.md-THEME_NAME-theme.md-checked.md-primary.md-focused .md-thumb:before {  background-color: '{{primary-color-0.26}}'; }md-switch.md-THEME_NAME-theme.md-checked.md-warn .md-thumb {  background-color: '{{warn-color}}'; }md-switch.md-THEME_NAME-theme.md-checked.md-warn .md-bar {  background-color: '{{warn-color-0.5}}'; }md-switch.md-THEME_NAME-theme.md-checked.md-warn.md-focused .md-thumb:before {  background-color: '{{warn-color-0.26}}'; }md-switch.md-THEME_NAME-theme[disabled] .md-thumb {  background-color: '{{background-400}}'; }md-switch.md-THEME_NAME-theme[disabled] .md-bar {  background-color: '{{foreground-4}}'; }md-tabs.md-THEME_NAME-theme md-tabs-wrapper {  background-color: transparent;  border-color: '{{foreground-4}}'; }md-tabs.md-THEME_NAME-theme .md-paginator md-icon {  color: '{{primary-color}}'; }md-tabs.md-THEME_NAME-theme md-ink-bar {  color: '{{accent-color}}';  background: '{{accent-color}}'; }md-tabs.md-THEME_NAME-theme .md-tab {  color: '{{foreground-2}}'; }  md-tabs.md-THEME_NAME-theme .md-tab[disabled] {    color: '{{foreground-3}}'; }  md-tabs.md-THEME_NAME-theme .md-tab.md-active, md-tabs.md-THEME_NAME-theme .md-tab.md-focused {    color: '{{primary-color}}'; }  md-tabs.md-THEME_NAME-theme .md-tab.md-focused {    background: '{{primary-color-0.1}}'; }  md-tabs.md-THEME_NAME-theme .md-tab .md-ripple-container {    color: '{{accent-100}}'; }md-tabs.md-THEME_NAME-theme.md-accent md-tabs-wrapper {  background-color: '{{accent-color}}'; }md-tabs.md-THEME_NAME-theme.md-accent md-tab-item:not([disabled]) {  color: '{{accent-100}}'; }  md-tabs.md-THEME_NAME-theme.md-accent md-tab-item:not([disabled]).md-active, md-tabs.md-THEME_NAME-theme.md-accent md-tab-item:not([disabled]).md-focused {    color: '{{accent-contrast}}'; }  md-tabs.md-THEME_NAME-theme.md-accent md-tab-item:not([disabled]).md-focused {    background: '{{accent-contrast-0.1}}'; }md-tabs.md-THEME_NAME-theme.md-accent md-ink-bar {  color: '{{primary-600-1}}';  background: '{{primary-600-1}}'; }md-tabs.md-THEME_NAME-theme.md-primary md-tabs-wrapper {  background-color: '{{primary-color}}'; }md-tabs.md-THEME_NAME-theme.md-primary md-tab-item:not([disabled]) {  color: '{{primary-100}}'; }  md-tabs.md-THEME_NAME-theme.md-primary md-tab-item:not([disabled]).md-active, md-tabs.md-THEME_NAME-theme.md-primary md-tab-item:not([disabled]).md-focused {    color: '{{primary-contrast}}'; }  md-tabs.md-THEME_NAME-theme.md-primary md-tab-item:not([disabled]).md-focused {    background: '{{primary-contrast-0.1}}'; }md-tabs.md-THEME_NAME-theme.md-warn md-tabs-wrapper {  background-color: '{{warn-color}}'; }md-tabs.md-THEME_NAME-theme.md-warn md-tab-item:not([disabled]) {  color: '{{warn-100}}'; }  md-tabs.md-THEME_NAME-theme.md-warn md-tab-item:not([disabled]).md-active, md-tabs.md-THEME_NAME-theme.md-warn md-tab-item:not([disabled]).md-focused {    color: '{{warn-contrast}}'; }  md-tabs.md-THEME_NAME-theme.md-warn md-tab-item:not([disabled]).md-focused {    background: '{{warn-contrast-0.1}}'; }md-toolbar > md-tabs.md-THEME_NAME-theme md-tabs-wrapper {  background-color: '{{primary-color}}'; }md-toolbar > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]) {  color: '{{primary-100}}'; }  md-toolbar > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-active, md-toolbar > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-focused {    color: '{{primary-contrast}}'; }  md-toolbar > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-focused {    background: '{{primary-contrast-0.1}}'; }md-toolbar.md-accent > md-tabs.md-THEME_NAME-theme md-tabs-wrapper {  background-color: '{{accent-color}}'; }md-toolbar.md-accent > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]) {  color: '{{accent-100}}'; }  md-toolbar.md-accent > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-active, md-toolbar.md-accent > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-focused {    color: '{{accent-contrast}}'; }  md-toolbar.md-accent > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-focused {    background: '{{accent-contrast-0.1}}'; }md-toolbar.md-accent > md-tabs.md-THEME_NAME-theme md-ink-bar {  color: '{{primary-600-1}}';  background: '{{primary-600-1}}'; }md-toolbar.md-warn > md-tabs.md-THEME_NAME-theme md-tabs-wrapper {  background-color: '{{warn-color}}'; }md-toolbar.md-warn > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]) {  color: '{{warn-100}}'; }  md-toolbar.md-warn > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-active, md-toolbar.md-warn > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-focused {    color: '{{warn-contrast}}'; }  md-toolbar.md-warn > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-focused {    background: '{{warn-contrast-0.1}}'; }md-toast.md-THEME_NAME-theme {  background-color: #323232;  color: '{{background-50}}'; }  md-toast.md-THEME_NAME-theme .md-button {    color: '{{background-50}}'; }    md-toast.md-THEME_NAME-theme .md-button.md-highlight {      color: '{{primary-A200}}'; }      md-toast.md-THEME_NAME-theme .md-button.md-highlight.md-accent {        color: '{{accent-A200}}'; }      md-toast.md-THEME_NAME-theme .md-button.md-highlight.md-warn {        color: '{{warn-A200}}'; }md-toolbar.md-THEME_NAME-theme {  background-color: '{{primary-color}}';  color: '{{primary-contrast}}'; }  md-toolbar.md-THEME_NAME-theme md-icon {    color: '{{primary-contrast}}'; }  md-toolbar.md-THEME_NAME-theme .md-button {    color: '{{primary-contrast}}'; }  md-toolbar.md-THEME_NAME-theme.md-accent {    background-color: '{{accent-color}}';    color: '{{accent-contrast}}'; }  md-toolbar.md-THEME_NAME-theme.md-warn {    background-color: '{{warn-color}}';    color: '{{warn-contrast}}'; }md-tooltip.md-THEME_NAME-theme {  color: '{{background-A100}}'; }  md-tooltip.md-THEME_NAME-theme .md-background {    background-color: '{{foreground-2}}'; }"); 
})();


})(window, window.angular);
/*
 jQuery UI Sortable plugin wrapper

 @param [ui-sortable] {object} Options to pass to $.fn.sortable() merged onto ui.config
 */
angular.module('ui.sortable', [])
  .value('uiSortableConfig',{})
  .directive('uiSortable', [
    'uiSortableConfig', '$timeout', '$log',
    function(uiSortableConfig, $timeout, $log) {
      return {
        require: '?ngModel',
        scope: {
          ngModel: '=',
          uiSortable: '='
        },
        link: function(scope, element, attrs, ngModel) {
          var savedNodes;

          function combineCallbacks(first,second){
            if(second && (typeof second === 'function')) {
              return function() {
                first.apply(this, arguments);
                second.apply(this, arguments);
              };
            }
            return first;
          }

          function getSortableWidgetInstance(element) {
            // this is a fix to support jquery-ui prior to v1.11.x
            // otherwise we should be using `element.sortable('instance')`
            var data = element.data('ui-sortable');
            if (data && typeof data === 'object' && data.widgetFullName === 'ui-sortable') {
              return data;
            }
            return null;
          }

          function hasSortingHelper (element, ui) {
            var helperOption = element.sortable('option','helper');
            return helperOption === 'clone' || (typeof helperOption === 'function' && ui.item.sortable.isCustomHelperUsed());
          }

          // thanks jquery-ui
          function isFloating (item) {
            return (/left|right/).test(item.css('float')) || (/inline|table-cell/).test(item.css('display'));
          }

          function getElementScope(elementScopes, element) {
            var result = null;
            for (var i = 0; i < elementScopes.length; i++) {
              var x = elementScopes[i];
              if (x.element[0] === element[0]) {
                result = x.scope;
                break;
              }
            }
            return result;
          }

          function afterStop(e, ui) {
            ui.item.sortable._destroy();
          }

          var opts = {};

          // directive specific options
          var directiveOpts = {
            'ui-floating': undefined
          };

          var callbacks = {
            receive: null,
            remove:null,
            start:null,
            stop:null,
            update:null
          };

          var wrappers = {
            helper: null
          };

          angular.extend(opts, directiveOpts, uiSortableConfig, scope.uiSortable);

          if (!angular.element.fn || !angular.element.fn.jquery) {
            $log.error('ui.sortable: jQuery should be included before AngularJS!');
            return;
          }

          if (ngModel) {

            // When we add or remove elements, we need the sortable to 'refresh'
            // so it can find the new/removed elements.
            scope.$watch('ngModel.length', function() {
              // Timeout to let ng-repeat modify the DOM
              $timeout(function() {
                // ensure that the jquery-ui-sortable widget instance
                // is still bound to the directive's element
                if (!!getSortableWidgetInstance(element)) {
                  element.sortable('refresh');
                }
              }, 0, false);
            });

            callbacks.start = function(e, ui) {
              if (opts['ui-floating'] === 'auto') {
                // since the drag has started, the element will be
                // absolutely positioned, so we check its siblings
                var siblings = ui.item.siblings();
                var sortableWidgetInstance = getSortableWidgetInstance(angular.element(e.target));
                sortableWidgetInstance.floating = isFloating(siblings);
              }

              // Save the starting position of dragged item
              ui.item.sortable = {
                model: ngModel.$modelValue[ui.item.index()],
                index: ui.item.index(),
                source: ui.item.parent(),
                sourceModel: ngModel.$modelValue,
                cancel: function () {
                  ui.item.sortable._isCanceled = true;
                },
                isCanceled: function () {
                  return ui.item.sortable._isCanceled;
                },
                isCustomHelperUsed: function () {
                  return !!ui.item.sortable._isCustomHelperUsed;
                },
                _isCanceled: false,
                _isCustomHelperUsed: ui.item.sortable._isCustomHelperUsed,
                _destroy: function () {
                  angular.forEach(ui.item.sortable, function(value, key) {
                    ui.item.sortable[key] = undefined;
                  });
                }
              };
            };

            callbacks.activate = function(e, ui) {
              // We need to make a copy of the current element's contents so
              // we can restore it after sortable has messed it up.
              // This is inside activate (instead of start) in order to save
              // both lists when dragging between connected lists.
              savedNodes = element.contents();

              // If this list has a placeholder (the connected lists won't),
              // don't inlcude it in saved nodes.
              var placeholder = element.sortable('option','placeholder');

              // placeholder.element will be a function if the placeholder, has
              // been created (placeholder will be an object).  If it hasn't
              // been created, either placeholder will be false if no
              // placeholder class was given or placeholder.element will be
              // undefined if a class was given (placeholder will be a string)
              if (placeholder && placeholder.element && typeof placeholder.element === 'function') {
                var phElement = placeholder.element();
                // workaround for jquery ui 1.9.x,
                // not returning jquery collection
                phElement = angular.element(phElement);

                // exact match with the placeholder's class attribute to handle
                // the case that multiple connected sortables exist and
                // the placehoilder option equals the class of sortable items
                var excludes = element.find('[class="' + phElement.attr('class') + '"]:not([ng-repeat], [data-ng-repeat])');

                savedNodes = savedNodes.not(excludes);
              }

              // save the directive's scope so that it is accessible from ui.item.sortable
              var connectedSortables = ui.item.sortable._connectedSortables || [];

              connectedSortables.push({
                element: element,
                scope: scope
              });

              ui.item.sortable._connectedSortables = connectedSortables;
            };

            callbacks.update = function(e, ui) {
              // Save current drop position but only if this is not a second
              // update that happens when moving between lists because then
              // the value will be overwritten with the old value
              if(!ui.item.sortable.received) {
                ui.item.sortable.dropindex = ui.item.index();
                var droptarget = ui.item.parent();
                ui.item.sortable.droptarget = droptarget;

                var droptargetScope = getElementScope(ui.item.sortable._connectedSortables, droptarget);
                ui.item.sortable.droptargetModel = droptargetScope.ngModel;

                // Cancel the sort (let ng-repeat do the sort for us)
                // Don't cancel if this is the received list because it has
                // already been canceled in the other list, and trying to cancel
                // here will mess up the DOM.
                element.sortable('cancel');
              }

              // Put the nodes back exactly the way they started (this is very
              // important because ng-repeat uses comment elements to delineate
              // the start and stop of repeat sections and sortable doesn't
              // respect their order (even if we cancel, the order of the
              // comments are still messed up).
              if (hasSortingHelper(element, ui) && !ui.item.sortable.received &&
                  element.sortable( 'option', 'appendTo' ) === 'parent') {
                // restore all the savedNodes except .ui-sortable-helper element
                // (which is placed last). That way it will be garbage collected.
                savedNodes = savedNodes.not(savedNodes.last());
              }
              savedNodes.appendTo(element);

              // If this is the target connected list then
              // it's safe to clear the restored nodes since:
              // update is currently running and
              // stop is not called for the target list.
              if(ui.item.sortable.received) {
                savedNodes = null;
              }

              // If received is true (an item was dropped in from another list)
              // then we add the new item to this list otherwise wait until the
              // stop event where we will know if it was a sort or item was
              // moved here from another list
              if(ui.item.sortable.received && !ui.item.sortable.isCanceled()) {
                scope.$apply(function () {
                  ngModel.$modelValue.splice(ui.item.sortable.dropindex, 0,
                                             ui.item.sortable.moved);
                });
              }
            };

            callbacks.stop = function(e, ui) {
              // If the received flag hasn't be set on the item, this is a
              // normal sort, if dropindex is set, the item was moved, so move
              // the items in the list.
              if(!ui.item.sortable.received &&
                 ('dropindex' in ui.item.sortable) &&
                 !ui.item.sortable.isCanceled()) {

                scope.$apply(function () {
                  ngModel.$modelValue.splice(
                    ui.item.sortable.dropindex, 0,
                    ngModel.$modelValue.splice(ui.item.sortable.index, 1)[0]);
                });
              } else {
                // if the item was not moved, then restore the elements
                // so that the ngRepeat's comment are correct.
                if ((!('dropindex' in ui.item.sortable) || ui.item.sortable.isCanceled()) &&
                    !hasSortingHelper(element, ui)) {
                  savedNodes.appendTo(element);
                }
              }

              // It's now safe to clear the savedNodes
              // since stop is the last callback.
              savedNodes = null;
            };

            callbacks.receive = function(e, ui) {
              // An item was dropped here from another list, set a flag on the
              // item.
              ui.item.sortable.received = true;
            };

            callbacks.remove = function(e, ui) {
              // Workaround for a problem observed in nested connected lists.
              // There should be an 'update' event before 'remove' when moving
              // elements. If the event did not fire, cancel sorting.
              if (!('dropindex' in ui.item.sortable)) {
                element.sortable('cancel');
                ui.item.sortable.cancel();
              }

              // Remove the item from this list's model and copy data into item,
              // so the next list can retrive it
              if (!ui.item.sortable.isCanceled()) {
                scope.$apply(function () {
                  ui.item.sortable.moved = ngModel.$modelValue.splice(
                    ui.item.sortable.index, 1)[0];
                });
              }
            };

            wrappers.helper = function (inner) {
              if (inner && typeof inner === 'function') {
                return function (e, item) {
                  var innerResult = inner.apply(this, arguments);
                  item.sortable._isCustomHelperUsed = item !== innerResult;
                  return innerResult;
                };
              }
              return inner;
            };

            scope.$watch('uiSortable', function(newVal /*, oldVal*/) {
              // ensure that the jquery-ui-sortable widget instance
              // is still bound to the directive's element
              var sortableWidgetInstance = getSortableWidgetInstance(element);
              if (!!sortableWidgetInstance) {
                angular.forEach(newVal, function(value, key) {
                  // if it's a custom option of the directive,
                  // handle it approprietly
                  if (key in directiveOpts) {
                    if (key === 'ui-floating' && (value === false || value === true)) {
                      sortableWidgetInstance.floating = value;
                    }

                    opts[key] = value;
                    return;
                  }

                  if (callbacks[key]) {
                    if( key === 'stop' ){
                      // call apply after stop
                      value = combineCallbacks(
                        value, function() { scope.$apply(); });

                      value = combineCallbacks(value, afterStop);
                    }
                    // wrap the callback
                    value = combineCallbacks(callbacks[key], value);
                  } else if (wrappers[key]) {
                    value = wrappers[key](value);
                  }

                  opts[key] = value;
                  element.sortable('option', key, value);
                });
              }
            }, true);

            angular.forEach(callbacks, function(value, key) {
              opts[key] = combineCallbacks(value, opts[key]);
              if( key === 'stop' ){
                opts[key] = combineCallbacks(opts[key], afterStop);
              }
            });

          } else {
            $log.info('ui.sortable: ngModel not provided!', element);
          }

          // Create sortable
          element.sortable(opts);
        }
      };
    }
  ]);

var fabric=fabric||{version:"1.5.0"};"undefined"!=typeof exports&&(exports.fabric=fabric),"undefined"!=typeof document&&"undefined"!=typeof window?(fabric.document=document,fabric.window=window,window.fabric=fabric):(fabric.document=require("jsdom").jsdom("<!DOCTYPE html><html><head></head><body></body></html>"),fabric.document.createWindow?fabric.window=fabric.document.createWindow():fabric.window=fabric.document.parentWindow),fabric.isTouchSupported="ontouchstart"in fabric.document.documentElement,fabric.isLikelyNode="undefined"!=typeof Buffer&&"undefined"==typeof window,fabric.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width"],fabric.DPI=96,fabric.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)",function(){function t(t,e){this.__eventListeners[t]&&(e?fabric.util.removeFromArray(this.__eventListeners[t],e):this.__eventListeners[t].length=0)}function e(t,e){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var i in t)this.on(i,t[i]);else this.__eventListeners[t]||(this.__eventListeners[t]=[]),this.__eventListeners[t].push(e);return this}function i(e,i){if(this.__eventListeners){if(0===arguments.length)this.__eventListeners={};else if(1===arguments.length&&"object"==typeof arguments[0])for(var r in e)t.call(this,r,e[r]);else t.call(this,e,i);return this}}function r(t,e){if(this.__eventListeners){var i=this.__eventListeners[t];if(i){for(var r=0,s=i.length;s>r;r++)i[r].call(this,e||{});return this}}}fabric.Observable={observe:e,stopObserving:i,fire:r,on:e,off:i,trigger:r}}(),fabric.Collection={add:function(){this._objects.push.apply(this._objects,arguments);for(var t=0,e=arguments.length;e>t;t++)this._onObjectAdded(arguments[t]);return this.renderOnAddRemove&&this.renderAll(),this},insertAt:function(t,e,i){var r=this.getObjects();return i?r[e]=t:r.splice(e,0,t),this._onObjectAdded(t),this.renderOnAddRemove&&this.renderAll(),this},remove:function(){for(var t,e=this.getObjects(),i=0,r=arguments.length;r>i;i++)t=e.indexOf(arguments[i]),-1!==t&&(e.splice(t,1),this._onObjectRemoved(arguments[i]));return this.renderOnAddRemove&&this.renderAll(),this},forEachObject:function(t,e){for(var i=this.getObjects(),r=i.length;r--;)t.call(e,i[r],r,i);return this},getObjects:function(t){return"undefined"==typeof t?this._objects:this._objects.filter(function(e){return e.type===t})},item:function(t){return this.getObjects()[t]},isEmpty:function(){return 0===this.getObjects().length},size:function(){return this.getObjects().length},contains:function(t){return this.getObjects().indexOf(t)>-1},complexity:function(){return this.getObjects().reduce(function(t,e){return t+=e.complexity?e.complexity():0},0)}},function(t){var e=Math.sqrt,i=Math.atan2,r=Math.PI/180;fabric.util={removeFromArray:function(t,e){var i=t.indexOf(e);return-1!==i&&t.splice(i,1),t},getRandomInt:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},degreesToRadians:function(t){return t*r},radiansToDegrees:function(t){return t/r},rotatePoint:function(t,e,i){var r=Math.sin(i),s=Math.cos(i);t.subtractEquals(e);var n=t.x*s-t.y*r,o=t.x*r+t.y*s;return new fabric.Point(n,o).addEquals(e)},transformPoint:function(t,e,i){return i?new fabric.Point(e[0]*t.x+e[2]*t.y,e[1]*t.x+e[3]*t.y):new fabric.Point(e[0]*t.x+e[2]*t.y+e[4],e[1]*t.x+e[3]*t.y+e[5])},invertTransform:function(t){var e=t.slice(),i=1/(t[0]*t[3]-t[1]*t[2]);e=[i*t[3],-i*t[1],-i*t[2],i*t[0],0,0];var r=fabric.util.transformPoint({x:t[4],y:t[5]},e);return e[4]=-r.x,e[5]=-r.y,e},toFixed:function(t,e){return parseFloat(Number(t).toFixed(e))},parseUnit:function(t,e){var i=/\D{0,2}$/.exec(t),r=parseFloat(t);switch(e||(e=fabric.Text.DEFAULT_SVG_FONT_SIZE),i[0]){case"mm":return r*fabric.DPI/25.4;case"cm":return r*fabric.DPI/2.54;case"in":return r*fabric.DPI;case"pt":return r*fabric.DPI/72;case"pc":return r*fabric.DPI/72*12;case"em":return r*e;default:return r}},falseFunction:function(){return!1},getKlass:function(t,e){return t=fabric.util.string.camelize(t.charAt(0).toUpperCase()+t.slice(1)),fabric.util.resolveNamespace(e)[t]},resolveNamespace:function(e){if(!e)return fabric;for(var i=e.split("."),r=i.length,s=t||fabric.window,n=0;r>n;++n)s=s[i[n]];return s},loadImage:function(t,e,i,r){if(!t)return void(e&&e.call(i,t));var s=fabric.util.createImage();s.onload=function(){e&&e.call(i,s),s=s.onload=s.onerror=null},s.onerror=function(){fabric.log("Error loading "+s.src),e&&e.call(i,null,!0),s=s.onload=s.onerror=null},0!==t.indexOf("data")&&"undefined"!=typeof r&&(s.crossOrigin=r),s.src=t},enlivenObjects:function(t,e,i,r){function s(){++o===a&&e&&e(n)}t=t||[];var n=[],o=0,a=t.length;return a?void t.forEach(function(t,e){if(!t||!t.type)return void s();var o=fabric.util.getKlass(t.type,i);o.async?o.fromObject(t,function(i,o){o||(n[e]=i,r&&r(t,n[e])),s()}):(n[e]=o.fromObject(t),r&&r(t,n[e]),s())}):void(e&&e(n))},groupSVGElements:function(t,e,i){var r;return r=new fabric.PathGroup(t,e),"undefined"!=typeof i&&r.setSourcePath(i),r},populateWithProperties:function(t,e,i){if(i&&"[object Array]"===Object.prototype.toString.call(i))for(var r=0,s=i.length;s>r;r++)i[r]in t&&(e[i[r]]=t[i[r]])},drawDashedLine:function(t,r,s,n,o,a){var h=n-r,c=o-s,l=e(h*h+c*c),u=i(c,h),f=a.length,d=0,g=!0;for(t.save(),t.translate(r,s),t.moveTo(0,0),t.rotate(u),r=0;l>r;)r+=a[d++%f],r>l&&(r=l),t[g?"lineTo":"moveTo"](r,0),g=!g;t.restore()},createCanvasElement:function(t){return t||(t=fabric.document.createElement("canvas")),t.getContext||"undefined"==typeof G_vmlCanvasManager||G_vmlCanvasManager.initElement(t),t},createImage:function(){return fabric.isLikelyNode?new(require("canvas").Image):fabric.document.createElement("img")},createAccessors:function(t){for(var e=t.prototype,i=e.stateProperties.length;i--;){var r=e.stateProperties[i],s=r.charAt(0).toUpperCase()+r.slice(1),n="set"+s,o="get"+s;e[o]||(e[o]=function(t){return new Function('return this.get("'+t+'")')}(r)),e[n]||(e[n]=function(t){return new Function("value",'return this.set("'+t+'", value)')}(r))}},clipContext:function(t,e){e.save(),e.beginPath(),t.clipTo(e),e.clip()},multiplyTransformMatrices:function(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]},getFunctionBody:function(t){return(String(t).match(/function[^{]*\{([\s\S]*)\}/)||{})[1]},isTransparent:function(t,e,i,r){r>0&&(e>r?e-=r:e=0,i>r?i-=r:i=0);for(var s=!0,n=t.getImageData(e,i,2*r||1,2*r||1),o=3,a=n.data.length;a>o;o+=4){var h=n.data[o];if(s=0>=h,s===!1)break}return n=null,s}}}("undefined"!=typeof exports?exports:this),function(){function t(t,r,n,o,h,c,l){var u=a.call(arguments);if(s[u])return s[u];var f=Math.PI,d=l*f/180,g=Math.sin(d),p=Math.cos(d),v=0,b=0;n=Math.abs(n),o=Math.abs(o);var m=-p*t*.5-g*r*.5,y=-p*r*.5+g*t*.5,_=n*n,x=o*o,C=y*y,S=m*m,w=_*x-_*C-x*S,O=0;if(0>w){var T=Math.sqrt(1-w/(_*x));n*=T,o*=T}else O=(h===c?-1:1)*Math.sqrt(w/(_*C+x*S));var k=O*n*y/o,j=-O*o*m/n,A=p*k-g*j+.5*t,P=g*k+p*j+.5*r,E=i(1,0,(m-k)/n,(y-j)/o),M=i((m-k)/n,(y-j)/o,(-m-k)/n,(-y-j)/o);0===c&&M>0?M-=2*f:1===c&&0>M&&(M+=2*f);for(var I=Math.ceil(Math.abs(M/f*2)),D=[],L=M/I,F=8/3*Math.sin(L/4)*Math.sin(L/4)/Math.sin(L/2),R=E+L,B=0;I>B;B++)D[B]=e(E,R,p,g,n,o,A,P,F,v,b),v=D[B][4],b=D[B][5],E=R,R+=L;return s[u]=D,D}function e(t,e,i,r,s,o,h,c,l,u,f){var d=a.call(arguments);if(n[d])return n[d];var g=Math.cos(t),p=Math.sin(t),v=Math.cos(e),b=Math.sin(e),m=i*s*v-r*o*b+h,y=r*s*v+i*o*b+c,_=u+l*(-i*s*p-r*o*g),x=f+l*(-r*s*p+i*o*g),C=m+l*(i*s*b+r*o*v),S=y+l*(r*s*b-i*o*v);return n[d]=[_,x,C,S,m,y],n[d]}function i(t,e,i,r){var s=Math.atan2(e,t),n=Math.atan2(r,i);return n>=s?n-s:2*Math.PI-(s-n)}function r(t,e,i,r,s,n,h,c){var l=a.call(arguments);if(o[l])return o[l];var u,f,d,g,p,v,b,m,y=Math.sqrt,_=Math.min,x=Math.max,C=Math.abs,S=[],w=[[],[]];f=6*t-12*i+6*s,u=-3*t+9*i-9*s+3*h,d=3*i-3*t;for(var O=0;2>O;++O)if(O>0&&(f=6*e-12*r+6*n,u=-3*e+9*r-9*n+3*c,d=3*r-3*e),C(u)<1e-12){if(C(f)<1e-12)continue;g=-d/f,g>0&&1>g&&S.push(g)}else b=f*f-4*d*u,0>b||(m=y(b),p=(-f+m)/(2*u),p>0&&1>p&&S.push(p),v=(-f-m)/(2*u),v>0&&1>v&&S.push(v));for(var T,k,j,A=S.length,P=A;A--;)g=S[A],j=1-g,T=j*j*j*t+3*j*j*g*i+3*j*g*g*s+g*g*g*h,w[0][A]=T,k=j*j*j*e+3*j*j*g*r+3*j*g*g*n+g*g*g*c,w[1][A]=k;w[0][P]=t,w[1][P]=e,w[0][P+1]=h,w[1][P+1]=c;var E=[{x:_.apply(null,w[0]),y:_.apply(null,w[1])},{x:x.apply(null,w[0]),y:x.apply(null,w[1])}];return o[l]=E,E}var s={},n={},o={},a=Array.prototype.join;fabric.util.drawArc=function(e,i,r,s){for(var n=s[0],o=s[1],a=s[2],h=s[3],c=s[4],l=s[5],u=s[6],f=[[],[],[],[]],d=t(l-i,u-r,n,o,h,c,a),g=0,p=d.length;p>g;g++)f[g][0]=d[g][0]+i,f[g][1]=d[g][1]+r,f[g][2]=d[g][2]+i,f[g][3]=d[g][3]+r,f[g][4]=d[g][4]+i,f[g][5]=d[g][5]+r,e.bezierCurveTo.apply(e,f[g])},fabric.util.getBoundsOfArc=function(e,i,s,n,o,a,h,c,l){for(var u=0,f=0,d=[],g=[],p=t(c-e,l-i,s,n,a,h,o),v=[[],[]],b=0,m=p.length;m>b;b++)d=r(u,f,p[b][0],p[b][1],p[b][2],p[b][3],p[b][4],p[b][5]),v[0].x=d[0].x+e,v[0].y=d[0].y+i,v[1].x=d[1].x+e,v[1].y=d[1].y+i,g.push(v[0]),g.push(v[1]),u=p[b][4],f=p[b][5];return g},fabric.util.getBoundsOfCurve=r}(),function(){function t(t,e){for(var i=s.call(arguments,2),r=[],n=0,o=t.length;o>n;n++)r[n]=i.length?t[n][e].apply(t[n],i):t[n][e].call(t[n]);return r}function e(t,e){return r(t,e,function(t,e){return t>=e})}function i(t,e){return r(t,e,function(t,e){return e>t})}function r(t,e,i){if(t&&0!==t.length){var r=t.length-1,s=e?t[r][e]:t[r];if(e)for(;r--;)i(t[r][e],s)&&(s=t[r][e]);else for(;r--;)i(t[r],s)&&(s=t[r]);return s}}var s=Array.prototype.slice;Array.prototype.indexOf||(Array.prototype.indexOf=function(t){if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if(0===i)return-1;var r=0;if(arguments.length>0&&(r=Number(arguments[1]),r!==r?r=0:0!==r&&r!==Number.POSITIVE_INFINITY&&r!==Number.NEGATIVE_INFINITY&&(r=(r>0||-1)*Math.floor(Math.abs(r)))),r>=i)return-1;for(var s=r>=0?r:Math.max(i-Math.abs(r),0);i>s;s++)if(s in e&&e[s]===t)return s;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){for(var i=0,r=this.length>>>0;r>i;i++)i in this&&t.call(e,this[i],i,this)}),Array.prototype.map||(Array.prototype.map=function(t,e){for(var i=[],r=0,s=this.length>>>0;s>r;r++)r in this&&(i[r]=t.call(e,this[r],r,this));return i}),Array.prototype.every||(Array.prototype.every=function(t,e){for(var i=0,r=this.length>>>0;r>i;i++)if(i in this&&!t.call(e,this[i],i,this))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(t,e){for(var i=0,r=this.length>>>0;r>i;i++)if(i in this&&t.call(e,this[i],i,this))return!0;return!1}),Array.prototype.filter||(Array.prototype.filter=function(t,e){for(var i,r=[],s=0,n=this.length>>>0;n>s;s++)s in this&&(i=this[s],t.call(e,i,s,this)&&r.push(i));return r}),Array.prototype.reduce||(Array.prototype.reduce=function(t){var e,i=this.length>>>0,r=0;if(arguments.length>1)e=arguments[1];else for(;;){if(r in this){e=this[r++];break}if(++r>=i)throw new TypeError}for(;i>r;r++)r in this&&(e=t.call(null,e,this[r],r,this));return e}),fabric.util.array={invoke:t,min:i,max:e}}(),function(){function t(t,e){for(var i in e)t[i]=e[i];return t}function e(e){return t({},e)}fabric.util.object={extend:t,clone:e}}(),function(){function t(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})}function e(t,e){return t.charAt(0).toUpperCase()+(e?t.slice(1):t.slice(1).toLowerCase())}function i(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"")}),fabric.util.string={camelize:t,capitalize:e,escapeXml:i}}(),function(){var t=Array.prototype.slice,e=Function.prototype.apply,i=function(){};Function.prototype.bind||(Function.prototype.bind=function(r){var s,n=this,o=t.call(arguments,1);return s=o.length?function(){return e.call(n,this instanceof i?this:r,o.concat(t.call(arguments)))}:function(){return e.call(n,this instanceof i?this:r,arguments)},i.prototype=this.prototype,s.prototype=new i,s})}(),function(){function t(){}function e(t){var e=this.constructor.superclass.prototype[t];return arguments.length>1?e.apply(this,r.call(arguments,1)):e.call(this)}function i(){function i(){this.initialize.apply(this,arguments)}var n=null,a=r.call(arguments,0);"function"==typeof a[0]&&(n=a.shift()),i.superclass=n,i.subclasses=[],n&&(t.prototype=n.prototype,i.prototype=new t,n.subclasses.push(i));for(var h=0,c=a.length;c>h;h++)o(i,a[h],n);return i.prototype.initialize||(i.prototype.initialize=s),i.prototype.constructor=i,i.prototype.callSuper=e,i}var r=Array.prototype.slice,s=function(){},n=function(){for(var t in{toString:1})if("toString"===t)return!1;return!0}(),o=function(t,e,i){for(var r in e)r in t.prototype&&"function"==typeof t.prototype[r]&&(e[r]+"").indexOf("callSuper")>-1?t.prototype[r]=function(t){return function(){var r=this.constructor.superclass;this.constructor.superclass=i;var s=e[t].apply(this,arguments);return this.constructor.superclass=r,"initialize"!==t?s:void 0}}(r):t.prototype[r]=e[r],n&&(e.toString!==Object.prototype.toString&&(t.prototype.toString=e.toString),e.valueOf!==Object.prototype.valueOf&&(t.prototype.valueOf=e.valueOf))};fabric.util.createClass=i}(),function(){function t(t){var e,i,r=Array.prototype.slice.call(arguments,1),s=r.length;for(i=0;s>i;i++)if(e=typeof t[r[i]],!/^(?:function|object|unknown)$/.test(e))return!1;return!0}function e(t,e){return{handler:e,wrappedHandler:i(t,e)}}function i(t,e){return function(i){e.call(o(t),i||fabric.window.event)}}function r(t,e){return function(i){if(p[t]&&p[t][e])for(var r=p[t][e],s=0,n=r.length;n>s;s++)r[s].call(this,i||fabric.window.event)}}function s(t,e){t||(t=fabric.window.event);var i=t.target||(typeof t.srcElement!==h?t.srcElement:null),r=fabric.util.getScrollLeftTop(i,e);return{x:v(t)+r.left,y:b(t)+r.top}}function n(t,e,i){var r="touchend"===t.type?"changedTouches":"touches";return t[r]&&t[r][0]?t[r][0][e]-(t[r][0][e]-t[r][0][i])||t[i]:t[i]}var o,a,h="unknown",c=function(){var t=0;return function(e){return e.__uniqueID||(e.__uniqueID="uniqueID__"+t++)}}();!function(){var t={};o=function(e){return t[e]},a=function(e,i){t[e]=i}}();var l,u,f=t(fabric.document.documentElement,"addEventListener","removeEventListener")&&t(fabric.window,"addEventListener","removeEventListener"),d=t(fabric.document.documentElement,"attachEvent","detachEvent")&&t(fabric.window,"attachEvent","detachEvent"),g={},p={};f?(l=function(t,e,i){t.addEventListener(e,i,!1)},u=function(t,e,i){t.removeEventListener(e,i,!1)}):d?(l=function(t,i,r){var s=c(t);a(s,t),g[s]||(g[s]={}),g[s][i]||(g[s][i]=[]);var n=e(s,r);g[s][i].push(n),t.attachEvent("on"+i,n.wrappedHandler)},u=function(t,e,i){var r,s=c(t);if(g[s]&&g[s][e])for(var n=0,o=g[s][e].length;o>n;n++)r=g[s][e][n],r&&r.handler===i&&(t.detachEvent("on"+e,r.wrappedHandler),g[s][e][n]=null)}):(l=function(t,e,i){var s=c(t);if(p[s]||(p[s]={}),!p[s][e]){p[s][e]=[];var n=t["on"+e];n&&p[s][e].push(n),t["on"+e]=r(s,e)}p[s][e].push(i)},u=function(t,e,i){var r=c(t);if(p[r]&&p[r][e])for(var s=p[r][e],n=0,o=s.length;o>n;n++)s[n]===i&&s.splice(n,1)}),fabric.util.addListener=l,fabric.util.removeListener=u;var v=function(t){return typeof t.clientX!==h?t.clientX:0},b=function(t){return typeof t.clientY!==h?t.clientY:0};fabric.isTouchSupported&&(v=function(t){return n(t,"pageX","clientX")},b=function(t){return n(t,"pageY","clientY")}),fabric.util.getPointer=s,fabric.util.object.extend(fabric.util,fabric.Observable)}(),function(){function t(t,e){var i=t.style;if(!i)return t;if("string"==typeof e)return t.style.cssText+=";"+e,e.indexOf("opacity")>-1?n(t,e.match(/opacity:\s*(\d?\.?\d*)/)[1]):t;for(var r in e)if("opacity"===r)n(t,e[r]);else{var s="float"===r||"cssFloat"===r?"undefined"==typeof i.styleFloat?"cssFloat":"styleFloat":r;i[s]=e[r]}return t}var e=fabric.document.createElement("div"),i="string"==typeof e.style.opacity,r="string"==typeof e.style.filter,s=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,n=function(t){return t};i?n=function(t,e){return t.style.opacity=e,t}:r&&(n=function(t,e){var i=t.style;return t.currentStyle&&!t.currentStyle.hasLayout&&(i.zoom=1),s.test(i.filter)?(e=e>=.9999?"":"alpha(opacity="+100*e+")",i.filter=i.filter.replace(s,e)):i.filter+=" alpha(opacity="+100*e+")",t}),fabric.util.setStyle=t}(),function(){function t(t){return"string"==typeof t?fabric.document.getElementById(t):t}function e(t,e){var i=fabric.document.createElement(t);for(var r in e)"class"===r?i.className=e[r]:"for"===r?i.htmlFor=e[r]:i.setAttribute(r,e[r]);return i}function i(t,e){t&&-1===(" "+t.className+" ").indexOf(" "+e+" ")&&(t.className+=(t.className?" ":"")+e)}function r(t,i,r){return"string"==typeof i&&(i=e(i,r)),t.parentNode&&t.parentNode.replaceChild(i,t),i.appendChild(t),i}function s(t,e){var i,r,s=0,n=0,o=fabric.document.documentElement,a=fabric.document.body||{scrollLeft:0,scrollTop:0};for(r=t;t&&t.parentNode&&!i;)t=t.parentNode,1===t.nodeType&&"fixed"===fabric.util.getElementStyle(t,"position")&&(i=t),1===t.nodeType&&r!==e&&"absolute"===fabric.util.getElementStyle(t,"position")?(s=0,n=0):t===fabric.document?(s=a.scrollLeft||o.scrollLeft||0,n=a.scrollTop||o.scrollTop||0):(s+=t.scrollLeft||0,n+=t.scrollTop||0);return{left:s,top:n}}function n(t){var e,i,r=t&&t.ownerDocument,s={left:0,top:0},n={left:0,top:0},o={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!r)return{left:0,top:0};for(var a in o)n[o[a]]+=parseInt(l(t,a),10)||0;return e=r.documentElement,"undefined"!=typeof t.getBoundingClientRect&&(s=t.getBoundingClientRect()),i=fabric.util.getScrollLeftTop(t,null),{left:s.left+i.left-(e.clientLeft||0)+n.left,top:s.top+i.top-(e.clientTop||0)+n.top}}var o,a=Array.prototype.slice,h=function(t){return a.call(t,0)};try{o=h(fabric.document.childNodes)instanceof Array}catch(c){}o||(h=function(t){for(var e=new Array(t.length),i=t.length;i--;)e[i]=t[i];return e});var l;l=fabric.document.defaultView&&fabric.document.defaultView.getComputedStyle?function(t,e){var i=fabric.document.defaultView.getComputedStyle(t,null);return i?i[e]:void 0}:function(t,e){var i=t.style[e];return!i&&t.currentStyle&&(i=t.currentStyle[e]),i},function(){function t(t){return"undefined"!=typeof t.onselectstart&&(t.onselectstart=fabric.util.falseFunction),r?t.style[r]="none":"string"==typeof t.unselectable&&(t.unselectable="on"),t}function e(t){return"undefined"!=typeof t.onselectstart&&(t.onselectstart=null),r?t.style[r]="":"string"==typeof t.unselectable&&(t.unselectable=""),t}var i=fabric.document.documentElement.style,r="userSelect"in i?"userSelect":"MozUserSelect"in i?"MozUserSelect":"WebkitUserSelect"in i?"WebkitUserSelect":"KhtmlUserSelect"in i?"KhtmlUserSelect":"";fabric.util.makeElementUnselectable=t,fabric.util.makeElementSelectable=e}(),function(){function t(t,e){var i=fabric.document.getElementsByTagName("head")[0],r=fabric.document.createElement("script"),s=!0;r.onload=r.onreadystatechange=function(t){if(s){if("string"==typeof this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState)return;s=!1,e(t||fabric.window.event),r=r.onload=r.onreadystatechange=null}},r.src=t,i.appendChild(r)}fabric.util.getScript=t}(),fabric.util.getById=t,fabric.util.toArray=h,fabric.util.makeElement=e,fabric.util.addClass=i,fabric.util.wrapElement=r,fabric.util.getScrollLeftTop=s,fabric.util.getElementOffset=n,fabric.util.getElementStyle=l}(),function(){function t(t,e){return t+(/\?/.test(t)?"&":"?")+e}function e(){}function i(i,s){s||(s={});var n,o=s.method?s.method.toUpperCase():"GET",a=s.onComplete||function(){},h=r();return h.onreadystatechange=function(){4===h.readyState&&(a(h),h.onreadystatechange=e)},"GET"===o&&(n=null,"string"==typeof s.parameters&&(i=t(i,s.parameters))),h.open(o,i,!0),("POST"===o||"PUT"===o)&&h.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),h.send(n),h}var r=function(){for(var t=[function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.3.0")},function(){return new XMLHttpRequest}],e=t.length;e--;)try{var i=t[e]();if(i)return t[e]}catch(r){}}();fabric.util.request=i}(),fabric.log=function(){},fabric.warn=function(){},"undefined"!=typeof console&&["log","warn"].forEach(function(t){"undefined"!=typeof console[t]&&"function"==typeof console[t].apply&&(fabric[t]=function(){return console[t].apply(console,arguments)})}),function(){function t(t){e(function(i){t||(t={});var r,s=i||+new Date,n=t.duration||500,o=s+n,a=t.onChange||function(){},h=t.abort||function(){return!1},c=t.easing||function(t,e,i,r){return-i*Math.cos(t/r*(Math.PI/2))+i+e},l="startValue"in t?t.startValue:0,u="endValue"in t?t.endValue:100,f=t.byValue||u-l;t.onStart&&t.onStart(),function d(i){r=i||+new Date;var u=r>o?n:r-s;return h()?void(t.onComplete&&t.onComplete()):(a(c(u,l,f,n)),r>o?void(t.onComplete&&t.onComplete()):void e(d))}(s)})}function e(){return i.apply(fabric.window,arguments)}var i=fabric.window.requestAnimationFrame||fabric.window.webkitRequestAnimationFrame||fabric.window.mozRequestAnimationFrame||fabric.window.oRequestAnimationFrame||fabric.window.msRequestAnimationFrame||function(t){fabric.window.setTimeout(t,1e3/60)};fabric.util.animate=t,fabric.util.requestAnimFrame=e}(),function(){function t(t,e,i,r){return t<Math.abs(e)?(t=e,r=i/4):r=i/(2*Math.PI)*Math.asin(e/t),{a:t,c:e,p:i,s:r}}function e(t,e,i){return t.a*Math.pow(2,10*(e-=1))*Math.sin(2*(e*i-t.s)*Math.PI/t.p)}function i(t,e,i,r){return i*((t=t/r-1)*t*t+1)+e}function r(t,e,i,r){return t/=r/2,1>t?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e}function s(t,e,i,r){return i*(t/=r)*t*t*t+e}function n(t,e,i,r){return-i*((t=t/r-1)*t*t*t-1)+e}function o(t,e,i,r){return t/=r/2,1>t?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e}function a(t,e,i,r){return i*(t/=r)*t*t*t*t+e}function h(t,e,i,r){return i*((t=t/r-1)*t*t*t*t+1)+e}function c(t,e,i,r){return t/=r/2,1>t?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e}function l(t,e,i,r){return-i*Math.cos(t/r*(Math.PI/2))+i+e}function u(t,e,i,r){return i*Math.sin(t/r*(Math.PI/2))+e}function f(t,e,i,r){return-i/2*(Math.cos(Math.PI*t/r)-1)+e}function d(t,e,i,r){return 0===t?e:i*Math.pow(2,10*(t/r-1))+e}function g(t,e,i,r){return t===r?e+i:i*(-Math.pow(2,-10*t/r)+1)+e}function p(t,e,i,r){return 0===t?e:t===r?e+i:(t/=r/2,1>t?i/2*Math.pow(2,10*(t-1))+e:i/2*(-Math.pow(2,-10*--t)+2)+e)}function v(t,e,i,r){return-i*(Math.sqrt(1-(t/=r)*t)-1)+e}function b(t,e,i,r){return i*Math.sqrt(1-(t=t/r-1)*t)+e}function m(t,e,i,r){return t/=r/2,1>t?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e}function y(i,r,s,n){var o=1.70158,a=0,h=s;if(0===i)return r;if(i/=n,1===i)return r+s;a||(a=.3*n);var c=t(h,s,a,o);return-e(c,i,n)+r}function _(e,i,r,s){var n=1.70158,o=0,a=r;if(0===e)return i;if(e/=s,1===e)return i+r;o||(o=.3*s);var h=t(a,r,o,n);return h.a*Math.pow(2,-10*e)*Math.sin(2*(e*s-h.s)*Math.PI/h.p)+h.c+i}function x(i,r,s,n){var o=1.70158,a=0,h=s;if(0===i)return r;if(i/=n/2,2===i)return r+s;a||(a=.3*n*1.5);var c=t(h,s,a,o);return 1>i?-.5*e(c,i,n)+r:c.a*Math.pow(2,-10*(i-=1))*Math.sin(2*(i*n-c.s)*Math.PI/c.p)*.5+c.c+r}function C(t,e,i,r,s){return void 0===s&&(s=1.70158),i*(t/=r)*t*((s+1)*t-s)+e}function S(t,e,i,r,s){return void 0===s&&(s=1.70158),i*((t=t/r-1)*t*((s+1)*t+s)+1)+e}function w(t,e,i,r,s){return void 0===s&&(s=1.70158),t/=r/2,1>t?i/2*t*t*(((s*=1.525)+1)*t-s)+e:i/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+e}function O(t,e,i,r){return i-T(r-t,0,i,r)+e}function T(t,e,i,r){return(t/=r)<1/2.75?7.5625*i*t*t+e:2/2.75>t?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e}function k(t,e,i,r){return r/2>t?.5*O(2*t,0,i,r)+e:.5*T(2*t-r,0,i,r)+.5*i+e}fabric.util.ease={easeInQuad:function(t,e,i,r){return i*(t/=r)*t+e},easeOutQuad:function(t,e,i,r){return-i*(t/=r)*(t-2)+e},easeInOutQuad:function(t,e,i,r){return t/=r/2,1>t?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,i,r){return i*(t/=r)*t*t+e},easeOutCubic:i,easeInOutCubic:r,easeInQuart:s,easeOutQuart:n,easeInOutQuart:o,easeInQuint:a,easeOutQuint:h,easeInOutQuint:c,easeInSine:l,easeOutSine:u,easeInOutSine:f,easeInExpo:d,easeOutExpo:g,easeInOutExpo:p,easeInCirc:v,easeOutCirc:b,easeInOutCirc:m,easeInElastic:y,easeOutElastic:_,easeInOutElastic:x,easeInBack:C,easeOutBack:S,easeInOutBack:w,easeInBounce:O,easeOutBounce:T,easeInOutBounce:k}}(),function(t){"use strict";function e(t){return t in C?C[t]:t}function i(t,e,i,r){var s,n="[object Array]"===Object.prototype.toString.call(e);return"fill"!==t&&"stroke"!==t||"none"!==e?"strokeDashArray"===t?e=e.replace(/,/g," ").split(/\s+/).map(function(t){return parseFloat(t)}):"transformMatrix"===t?e=i&&i.transformMatrix?x(i.transformMatrix,p.parseTransformAttribute(e)):p.parseTransformAttribute(e):"visible"===t?(e="none"===e||"hidden"===e?!1:!0,i&&i.visible===!1&&(e=!1)):"originX"===t?e="start"===e?"left":"end"===e?"right":"center":s=n?e.map(_):_(e,r):e="",!n&&isNaN(s)?e:s}function r(t){for(var e in S)if(t[e]&&"undefined"!=typeof t[S[e]]&&0!==t[e].indexOf("url(")){var i=new p.Color(t[e]);t[e]=i.setAlpha(y(i.getAlpha()*t[S[e]],2)).toRgba()}return t}function s(t,r){var s,n;t.replace(/;$/,"").split(";").forEach(function(t){var o=t.split(":");s=e(o[0].trim().toLowerCase()),n=i(s,o[1].trim()),r[s]=n})}function n(t,r){var s,n;for(var o in t)"undefined"!=typeof t[o]&&(s=e(o.toLowerCase()),n=i(s,t[o]),r[s]=n)}function o(t,e){var i={};for(var r in p.cssRules[e])if(a(t,r.split(" ")))for(var s in p.cssRules[e][r])i[s]=p.cssRules[e][r][s];return i}function a(t,e){var i,r=!0;return i=c(t,e.pop()),i&&e.length&&(r=h(t,e)),i&&r&&0===e.length}function h(t,e){for(var i,r=!0;t.parentNode&&1===t.parentNode.nodeType&&e.length;)r&&(i=e.pop()),t=t.parentNode,r=c(t,i);return 0===e.length}function c(t,e){var i,r=t.nodeName,s=t.getAttribute("class"),n=t.getAttribute("id");if(i=new RegExp("^"+r,"i"),e=e.replace(i,""),n&&e.length&&(i=new RegExp("#"+n+"(?![a-zA-Z\\-]+)","i"),e=e.replace(i,"")),s&&e.length){s=s.split(" ");for(var o=s.length;o--;)i=new RegExp("\\."+s[o]+"(?![a-zA-Z\\-]+)","i"),e=e.replace(i,"")}return 0===e.length}function l(t,e){var i;if(t.getElementById&&(i=t.getElementById(e)),i)return i;var r,s,n,o=t.getElementsByTagName("*");for(s=0;s<o.length;s++)if(r=o[s],n===r.getAttribute("id"))return r}function u(t){for(var e=t.getElementsByTagName("use"),i=0;e.length&&i<e.length;){for(var r,s=e[i],n=s.getAttribute("xlink:href").substr(1),o=s.getAttribute("x")||0,a=s.getAttribute("y")||0,h=l(t,n).cloneNode(!0),c=(h.getAttribute("transform")||"")+" translate("+o+", "+a+")",u=e.length,f=0,d=s.attributes,g=d.length;g>f;f++){var p=d.item(f);"x"!==p.nodeName&&"y"!==p.nodeName&&"xlink:href"!==p.nodeName&&("transform"===p.nodeName?c=p.nodeValue+" "+c:h.setAttribute(p.nodeName,p.nodeValue))}h.setAttribute("transform",c),h.setAttribute("instantiated_by_use","1"),h.removeAttribute("id"),r=s.parentNode,r.replaceChild(h,s),e.length===u&&i++}}function f(t,e,i){var r,s,n,o,a=t.getAttribute("viewBox"),h=1,c=1,l=0,u=0;if(a&&(a=a.match(w))&&(l=-parseFloat(a[1]),u=-parseFloat(a[2]),r=parseFloat(a[3]),s=parseFloat(a[4]),e&&e!==r&&(h=e/r),i&&i!==s&&(c=i/s),c=h=h>c?c:h,1!==h||1!==c||0!==l||0!==u)){if(n=" matrix("+h+" 0 0 "+c+" "+l*h+" "+u*c+") ","svg"===t.tagName){for(o=t.ownerDocument.createElement("g");null!=t.firstChild;)o.appendChild(t.firstChild);t.appendChild(o)}else o=t,n=o.getAttribute("transform")+n;o.setAttribute("transform",n)}}function d(t){var e=t.objects,i=t.options;return e=e.map(function(t){return p[b(t.type)].fromObject(t)}),{objects:e,options:i}}function g(t,e,i){e[i]&&e[i].toSVG&&t.push('<pattern x="0" y="0" id="',i,'Pattern" ','width="',e[i].source.width,'" height="',e[i].source.height,'" patternUnits="userSpaceOnUse">','<image x="0" y="0" ','width="',e[i].source.width,'" height="',e[i].source.height,'" xlink:href="',e[i].source.src,'"></image></pattern>')}var p=t.fabric||(t.fabric={}),v=p.util.object.extend,b=p.util.string.capitalize,m=p.util.object.clone,y=p.util.toFixed,_=p.util.parseUnit,x=p.util.multiplyTransformMatrices,C={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","stroke-dasharray":"strokeDashArray","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"originX"},S={stroke:"strokeOpacity",fill:"fillOpacity"};p.cssRules={},p.gradientDefs={},p.parseTransformAttribute=function(){function t(t,e){var i=e[0];t[0]=Math.cos(i),t[1]=Math.sin(i),t[2]=-Math.sin(i),t[3]=Math.cos(i)}function e(t,e){var i=e[0],r=2===e.length?e[1]:e[0];t[0]=i,t[3]=r}function i(t,e){t[2]=Math.tan(p.util.degreesToRadians(e[0]))}function r(t,e){t[1]=Math.tan(p.util.degreesToRadians(e[0]))}function s(t,e){t[4]=e[0],2===e.length&&(t[5]=e[1])}var n=[1,0,0,1,0,0],o=p.reNum,a="(?:\\s+,?\\s*|,\\s*)",h="(?:(skewX)\\s*\\(\\s*("+o+")\\s*\\))",c="(?:(skewY)\\s*\\(\\s*("+o+")\\s*\\))",l="(?:(rotate)\\s*\\(\\s*("+o+")(?:"+a+"("+o+")"+a+"("+o+"))?\\s*\\))",u="(?:(scale)\\s*\\(\\s*("+o+")(?:"+a+"("+o+"))?\\s*\\))",f="(?:(translate)\\s*\\(\\s*("+o+")(?:"+a+"("+o+"))?\\s*\\))",d="(?:(matrix)\\s*\\(\\s*("+o+")"+a+"("+o+")"+a+"("+o+")"+a+"("+o+")"+a+"("+o+")"+a+"("+o+")\\s*\\))",g="(?:"+d+"|"+f+"|"+u+"|"+l+"|"+h+"|"+c+")",v="(?:"+g+"(?:"+a+g+")*)",b="^\\s*(?:"+v+"?)\\s*$",m=new RegExp(b),y=new RegExp(g,"g");return function(o){var a=n.concat(),h=[];if(!o||o&&!m.test(o))return a;o.replace(y,function(o){var c=new RegExp(g).exec(o).filter(function(t){return""!==t&&null!=t}),l=c[1],u=c.slice(2).map(parseFloat);switch(l){case"translate":s(a,u);break;case"rotate":u[0]=p.util.degreesToRadians(u[0]),t(a,u);break;case"scale":e(a,u);break;case"skewX":i(a,u);break;case"skewY":r(a,u);break;case"matrix":a=u}h.push(a.concat()),a=n.concat()});for(var c=h[0];h.length>1;)h.shift(),c=p.util.multiplyTransformMatrices(c,h[0]);return c}}();var w=new RegExp("^\\s*("+p.reNum+"+)\\s*,?\\s*("+p.reNum+"+)\\s*,?\\s*("+p.reNum+"+)\\s*,?\\s*("+p.reNum+"+)\\s*$");p.parseSVGDocument=function(){function t(t,e){for(;t&&(t=t.parentNode);)if(e.test(t.nodeName)&&!t.getAttribute("instantiated_by_use"))return!0;return!1}var e=/^(path|circle|polygon|polyline|ellipse|rect|line|image|text)$/,i=/^(symbol|image|marker|pattern|view)$/;return function(r,s,n){if(r){u(r);var o,a,h=new Date,c=p.Object.__uid++,l=!1;if(r.getAttribute("width")&&"100%"!==r.getAttribute("width")&&(o=_(r.getAttribute("width"))),r.getAttribute("height")&&"100%"!==r.getAttribute("height")&&(a=_(r.getAttribute("height"))),!o||!a){var d=r.getAttribute("viewBox");d&&(d=d.match(w))?(o=parseFloat(d[3]),a=parseFloat(d[4])):l=!0}f(r,o,a);var g=p.util.toArray(r.getElementsByTagName("*"));if(0===g.length&&p.isLikelyNode){g=r.selectNodes('//*[name(.)!="svg"]');for(var v=[],b=0,y=g.length;y>b;b++)v[b]=g[b];g=v}var x=g.filter(function(r){return i.test(r.tagName)&&f(r,0,0),e.test(r.tagName)&&!t(r,/^(?:pattern|defs|symbol|metadata)$/)});if(!x||x&&!x.length)return void(s&&s([],{}));var C={width:o,height:a,svgUid:c,toBeParsed:l};p.gradientDefs[c]=p.getGradientDefs(r),p.cssRules[c]=p.getCSSRules(r),p.parseElements(x,function(t){p.documentParsingTime=new Date-h,s&&s(t,C)},m(C),n)}}}();var O={has:function(t,e){e(!1)},get:function(){},set:function(){}},T=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+p.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+p.reNum+"))?\\s+(.*)");v(p,{parseFontDeclaration:function(t,e){var i=t.match(T);if(i){var r=i[1],s=i[3],n=i[4],o=i[5],a=i[6];r&&(e.fontStyle=r),s&&(e.fontWeight=isNaN(parseFloat(s))?s:parseFloat(s)),n&&(e.fontSize=_(n)),
a&&(e.fontFamily=a),o&&(e.lineHeight="normal"===o?1:o)}},getGradientDefs:function(t){var e,i,r,s,n=t.getElementsByTagName("linearGradient"),o=t.getElementsByTagName("radialGradient"),a=0,h=[],c={},l={};for(h.length=n.length+o.length,i=n.length;i--;)h[a++]=n[i];for(i=o.length;i--;)h[a++]=o[i];for(;a--;)e=h[a],s=e.getAttribute("xlink:href"),r=e.getAttribute("id"),s&&(l[r]=s.substr(1)),c[r]=e;for(r in l){var u=c[l[r]].cloneNode(!0);for(e=c[r];u.firstChild;)e.appendChild(u.firstChild)}return c},parseAttributes:function(t,s,n){if(t){var a,h,c={};"undefined"==typeof n&&(n=t.getAttribute("svgUid")),t.parentNode&&/^symbol|[g|a]$/i.test(t.parentNode.nodeName)&&(c=p.parseAttributes(t.parentNode,s,n)),h=c&&c.fontSize||t.getAttribute("font-size")||p.Text.DEFAULT_SVG_FONT_SIZE;var l=s.reduce(function(r,s){return a=t.getAttribute(s),a&&(s=e(s),a=i(s,a,c,h),r[s]=a),r},{});return l=v(l,v(o(t,n),p.parseStyleAttribute(t))),l.font&&p.parseFontDeclaration(l.font,l),r(v(c,l))}},parseElements:function(t,e,i,r){new p.ElementsParser(t,e,i,r).parse()},parseStyleAttribute:function(t){var e={},i=t.getAttribute("style");return i?("string"==typeof i?s(i,e):n(i,e),e):e},parsePointsAttribute:function(t){if(!t)return null;t=t.replace(/,/g," ").trim(),t=t.split(/\s+/);var e,i,r=[];for(e=0,i=t.length;i>e;e+=2)r.push({x:parseFloat(t[e]),y:parseFloat(t[e+1])});return r},getCSSRules:function(t){for(var r,s=t.getElementsByTagName("style"),n={},o=0,a=s.length;a>o;o++){var h=s[o].textContent;h=h.replace(/\/\*[\s\S]*?\*\//g,""),""!==h.trim()&&(r=h.match(/[^{]*\{[\s\S]*?\}/g),r=r.map(function(t){return t.trim()}),r.forEach(function(t){for(var r=t.match(/([\s\S]*?)\s*\{([^}]*)\}/),s={},o=r[2].trim(),a=o.replace(/;$/,"").split(/\s*;\s*/),h=0,c=a.length;c>h;h++){var l=a[h].split(/\s*:\s*/),u=e(l[0]),f=i(u,l[1],l[0]);s[u]=f}t=r[1],t.split(",").forEach(function(t){t=t.replace(/^svg/i,"").trim(),""!==t&&(n[t]=p.util.object.clone(s))})}))}return n},loadSVGFromURL:function(t,e,i){function r(r){var s=r.responseXML;s&&!s.documentElement&&p.window.ActiveXObject&&r.responseText&&(s=new ActiveXObject("Microsoft.XMLDOM"),s.async="false",s.loadXML(r.responseText.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,""))),s&&s.documentElement&&p.parseSVGDocument(s.documentElement,function(i,r){O.set(t,{objects:p.util.array.invoke(i,"toObject"),options:r}),e(i,r)},i)}t=t.replace(/^\n\s*/,"").trim(),O.has(t,function(i){i?O.get(t,function(t){var i=d(t);e(i.objects,i.options)}):new p.util.request(t,{method:"get",onComplete:r})})},loadSVGFromString:function(t,e,i){t=t.trim();var r;if("undefined"!=typeof DOMParser){var s=new DOMParser;s&&s.parseFromString&&(r=s.parseFromString(t,"text/xml"))}else p.window.ActiveXObject&&(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(t.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));p.parseSVGDocument(r.documentElement,function(t,i){e(t,i)},i)},createSVGFontFacesMarkup:function(t){for(var e="",i=0,r=t.length;r>i;i++)"text"===t[i].type&&t[i].path&&(e+=["@font-face {","font-family: ",t[i].fontFamily,"; ","src: url('",t[i].path,"')","}"].join(""));return e&&(e=['<style type="text/css">',"<![CDATA[",e,"]]>","</style>"].join("")),e},createSVGRefElementsMarkup:function(t){var e=[];return g(e,t,"backgroundColor"),g(e,t,"overlayColor"),e.join("")}})}("undefined"!=typeof exports?exports:this),fabric.ElementsParser=function(t,e,i,r){this.elements=t,this.callback=e,this.options=i,this.reviver=r,this.svgUid=i&&i.svgUid||0},fabric.ElementsParser.prototype.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},fabric.ElementsParser.prototype.createObjects=function(){for(var t=0,e=this.elements.length;e>t;t++)this.elements[t].setAttribute("svgUid",this.svgUid),function(t,e){setTimeout(function(){t.createObject(t.elements[e],e)},0)}(this,t)},fabric.ElementsParser.prototype.createObject=function(t,e){var i=fabric[fabric.util.string.capitalize(t.tagName)];if(i&&i.fromElement)try{this._createObject(i,t,e)}catch(r){fabric.log(r)}else this.checkIfDone()},fabric.ElementsParser.prototype._createObject=function(t,e,i){if(t.async)t.fromElement(e,this.createCallback(i,e),this.options);else{var r=t.fromElement(e,this.options);this.resolveGradient(r,"fill"),this.resolveGradient(r,"stroke"),this.reviver&&this.reviver(e,r),this.instances[i]=r,this.checkIfDone()}},fabric.ElementsParser.prototype.createCallback=function(t,e){var i=this;return function(r){i.resolveGradient(r,"fill"),i.resolveGradient(r,"stroke"),i.reviver&&i.reviver(e,r),i.instances[t]=r,i.checkIfDone()}},fabric.ElementsParser.prototype.resolveGradient=function(t,e){var i=t.get(e);if(/^url\(/.test(i)){var r=i.slice(5,i.length-1);fabric.gradientDefs[this.svgUid][r]&&t.set(e,fabric.Gradient.fromElement(fabric.gradientDefs[this.svgUid][r],t))}},fabric.ElementsParser.prototype.checkIfDone=function(){0===--this.numElements&&(this.instances=this.instances.filter(function(t){return null!=t}),this.callback(this.instances))},function(t){"use strict";function e(t,e){this.x=t,this.y=e}var i=t.fabric||(t.fabric={});return i.Point?void i.warn("fabric.Point is already defined"):(i.Point=e,void(e.prototype={constructor:e,add:function(t){return new e(this.x+t.x,this.y+t.y)},addEquals:function(t){return this.x+=t.x,this.y+=t.y,this},scalarAdd:function(t){return new e(this.x+t,this.y+t)},scalarAddEquals:function(t){return this.x+=t,this.y+=t,this},subtract:function(t){return new e(this.x-t.x,this.y-t.y)},subtractEquals:function(t){return this.x-=t.x,this.y-=t.y,this},scalarSubtract:function(t){return new e(this.x-t,this.y-t)},scalarSubtractEquals:function(t){return this.x-=t,this.y-=t,this},multiply:function(t){return new e(this.x*t,this.y*t)},multiplyEquals:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return new e(this.x/t,this.y/t)},divideEquals:function(t){return this.x/=t,this.y/=t,this},eq:function(t){return this.x===t.x&&this.y===t.y},lt:function(t){return this.x<t.x&&this.y<t.y},lte:function(t){return this.x<=t.x&&this.y<=t.y},gt:function(t){return this.x>t.x&&this.y>t.y},gte:function(t){return this.x>=t.x&&this.y>=t.y},lerp:function(t,i){return new e(this.x+(t.x-this.x)*i,this.y+(t.y-this.y)*i)},distanceFrom:function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},midPointFrom:function(t){return new e(this.x+(t.x-this.x)/2,this.y+(t.y-this.y)/2)},min:function(t){return new e(Math.min(this.x,t.x),Math.min(this.y,t.y))},max:function(t){return new e(Math.max(this.x,t.x),Math.max(this.y,t.y))},toString:function(){return this.x+","+this.y},setXY:function(t,e){this.x=t,this.y=e},setFromPoint:function(t){this.x=t.x,this.y=t.y},swap:function(t){var e=this.x,i=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=i}}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";function e(t){this.status=t,this.points=[]}var i=t.fabric||(t.fabric={});return i.Intersection?void i.warn("fabric.Intersection is already defined"):(i.Intersection=e,i.Intersection.prototype={appendPoint:function(t){this.points.push(t)},appendPoints:function(t){this.points=this.points.concat(t)}},i.Intersection.intersectLineLine=function(t,r,s,n){var o,a=(n.x-s.x)*(t.y-s.y)-(n.y-s.y)*(t.x-s.x),h=(r.x-t.x)*(t.y-s.y)-(r.y-t.y)*(t.x-s.x),c=(n.y-s.y)*(r.x-t.x)-(n.x-s.x)*(r.y-t.y);if(0!==c){var l=a/c,u=h/c;l>=0&&1>=l&&u>=0&&1>=u?(o=new e("Intersection"),o.points.push(new i.Point(t.x+l*(r.x-t.x),t.y+l*(r.y-t.y)))):o=new e}else o=new e(0===a||0===h?"Coincident":"Parallel");return o},i.Intersection.intersectLinePolygon=function(t,i,r){for(var s=new e,n=r.length,o=0;n>o;o++){var a=r[o],h=r[(o+1)%n],c=e.intersectLineLine(t,i,a,h);s.appendPoints(c.points)}return s.points.length>0&&(s.status="Intersection"),s},i.Intersection.intersectPolygonPolygon=function(t,i){for(var r=new e,s=t.length,n=0;s>n;n++){var o=t[n],a=t[(n+1)%s],h=e.intersectLinePolygon(o,a,i);r.appendPoints(h.points)}return r.points.length>0&&(r.status="Intersection"),r},void(i.Intersection.intersectPolygonRectangle=function(t,r,s){var n=r.min(s),o=r.max(s),a=new i.Point(o.x,n.y),h=new i.Point(n.x,o.y),c=e.intersectLinePolygon(n,a,t),l=e.intersectLinePolygon(a,o,t),u=e.intersectLinePolygon(o,h,t),f=e.intersectLinePolygon(h,n,t),d=new e;return d.appendPoints(c.points),d.appendPoints(l.points),d.appendPoints(u.points),d.appendPoints(f.points),d.points.length>0&&(d.status="Intersection"),d}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";function e(t){t?this._tryParsingColor(t):this.setSource([0,0,0,1])}function i(t,e,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?t+6*(e-t)*i:.5>i?e:2/3>i?t+(e-t)*(2/3-i)*6:t}var r=t.fabric||(t.fabric={});return r.Color?void r.warn("fabric.Color is already defined."):(r.Color=e,r.Color.prototype={_tryParsingColor:function(t){var i;return t in e.colorNameMap&&(t=e.colorNameMap[t]),"transparent"===t?void this.setSource([255,255,255,0]):(i=e.sourceFromHex(t),i||(i=e.sourceFromRgb(t)),i||(i=e.sourceFromHsl(t)),void(i&&this.setSource(i)))},_rgbToHsl:function(t,e,i){t/=255,e/=255,i/=255;var s,n,o,a=r.util.array.max([t,e,i]),h=r.util.array.min([t,e,i]);if(o=(a+h)/2,a===h)s=n=0;else{var c=a-h;switch(n=o>.5?c/(2-a-h):c/(a+h),a){case t:s=(e-i)/c+(i>e?6:0);break;case e:s=(i-t)/c+2;break;case i:s=(t-e)/c+4}s/=6}return[Math.round(360*s),Math.round(100*n),Math.round(100*o)]},getSource:function(){return this._source},setSource:function(t){this._source=t},toRgb:function(){var t=this.getSource();return"rgb("+t[0]+","+t[1]+","+t[2]+")"},toRgba:function(){var t=this.getSource();return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},toHsl:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsl("+e[0]+","+e[1]+"%,"+e[2]+"%)"},toHsla:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsla("+e[0]+","+e[1]+"%,"+e[2]+"%,"+t[3]+")"},toHex:function(){var t,e,i,r=this.getSource();return t=r[0].toString(16),t=1===t.length?"0"+t:t,e=r[1].toString(16),e=1===e.length?"0"+e:e,i=r[2].toString(16),i=1===i.length?"0"+i:i,t.toUpperCase()+e.toUpperCase()+i.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(t){var e=this.getSource();return e[3]=t,this.setSource(e),this},toGrayscale:function(){var t=this.getSource(),e=parseInt((.3*t[0]+.59*t[1]+.11*t[2]).toFixed(0),10),i=t[3];return this.setSource([e,e,e,i]),this},toBlackWhite:function(t){var e=this.getSource(),i=(.3*e[0]+.59*e[1]+.11*e[2]).toFixed(0),r=e[3];return t=t||127,i=Number(i)<Number(t)?0:255,this.setSource([i,i,i,r]),this},overlayWith:function(t){t instanceof e||(t=new e(t));for(var i=[],r=this.getAlpha(),s=.5,n=this.getSource(),o=t.getSource(),a=0;3>a;a++)i.push(Math.round(n[a]*(1-s)+o[a]*s));return i[3]=r,this.setSource(i),this}},r.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,r.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,r.Color.reHex=/^#?([0-9a-f]{6}|[0-9a-f]{3})$/i,r.Color.colorNameMap={aqua:"#00FFFF",black:"#000000",blue:"#0000FF",fuchsia:"#FF00FF",gray:"#808080",green:"#008000",lime:"#00FF00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#FFA500",purple:"#800080",red:"#FF0000",silver:"#C0C0C0",teal:"#008080",white:"#FFFFFF",yellow:"#FFFF00"},r.Color.fromRgb=function(t){return e.fromSource(e.sourceFromRgb(t))},r.Color.sourceFromRgb=function(t){var i=t.match(e.reRGBa);if(i){var r=parseInt(i[1],10)/(/%$/.test(i[1])?100:1)*(/%$/.test(i[1])?255:1),s=parseInt(i[2],10)/(/%$/.test(i[2])?100:1)*(/%$/.test(i[2])?255:1),n=parseInt(i[3],10)/(/%$/.test(i[3])?100:1)*(/%$/.test(i[3])?255:1);return[parseInt(r,10),parseInt(s,10),parseInt(n,10),i[4]?parseFloat(i[4]):1]}},r.Color.fromRgba=e.fromRgb,r.Color.fromHsl=function(t){return e.fromSource(e.sourceFromHsl(t))},r.Color.sourceFromHsl=function(t){var r=t.match(e.reHSLa);if(r){var s,n,o,a=(parseFloat(r[1])%360+360)%360/360,h=parseFloat(r[2])/(/%$/.test(r[2])?100:1),c=parseFloat(r[3])/(/%$/.test(r[3])?100:1);if(0===h)s=n=o=c;else{var l=.5>=c?c*(h+1):c+h-c*h,u=2*c-l;s=i(u,l,a+1/3),n=i(u,l,a),o=i(u,l,a-1/3)}return[Math.round(255*s),Math.round(255*n),Math.round(255*o),r[4]?parseFloat(r[4]):1]}},r.Color.fromHsla=e.fromHsl,r.Color.fromHex=function(t){return e.fromSource(e.sourceFromHex(t))},r.Color.sourceFromHex=function(t){if(t.match(e.reHex)){var i=t.slice(t.indexOf("#")+1),r=3===i.length,s=r?i.charAt(0)+i.charAt(0):i.substring(0,2),n=r?i.charAt(1)+i.charAt(1):i.substring(2,4),o=r?i.charAt(2)+i.charAt(2):i.substring(4,6);return[parseInt(s,16),parseInt(n,16),parseInt(o,16),1]}},void(r.Color.fromSource=function(t){var i=new e;return i.setSource(t),i}))}("undefined"!=typeof exports?exports:this),function(){function t(t){var e,i,r,s=t.getAttribute("style"),n=t.getAttribute("offset");if(n=parseFloat(n)/(/%$/.test(n)?100:1),n=0>n?0:n>1?1:n,s){var o=s.split(/\s*;\s*/);""===o[o.length-1]&&o.pop();for(var a=o.length;a--;){var h=o[a].split(/\s*:\s*/),c=h[0].trim(),l=h[1].trim();"stop-color"===c?e=l:"stop-opacity"===c&&(r=l)}}return e||(e=t.getAttribute("stop-color")||"rgb(0,0,0)"),r||(r=t.getAttribute("stop-opacity")),e=new fabric.Color(e),i=e.getAlpha(),r=isNaN(parseFloat(r))?1:parseFloat(r),r*=i,{offset:n,color:e.toRgb(),opacity:r}}function e(t){return{x1:t.getAttribute("x1")||0,y1:t.getAttribute("y1")||0,x2:t.getAttribute("x2")||"100%",y2:t.getAttribute("y2")||0}}function i(t){return{x1:t.getAttribute("fx")||t.getAttribute("cx")||"50%",y1:t.getAttribute("fy")||t.getAttribute("cy")||"50%",r1:0,x2:t.getAttribute("cx")||"50%",y2:t.getAttribute("cy")||"50%",r2:t.getAttribute("r")||"50%"}}function r(t,e,i){var r,s=0,n=1,o="";for(var a in e)r=parseFloat(e[a],10),n="string"==typeof e[a]&&/^\d+%$/.test(e[a])?.01:1,"x1"===a||"x2"===a||"r2"===a?(n*="objectBoundingBox"===i?t.width:1,s="objectBoundingBox"===i?t.left||0:0):("y1"===a||"y2"===a)&&(n*="objectBoundingBox"===i?t.height:1,s="objectBoundingBox"===i?t.top||0:0),e[a]=r*n+s;if("ellipse"===t.type&&null!==e.r2&&"objectBoundingBox"===i&&t.rx!==t.ry){var h=t.ry/t.rx;o=" scale(1, "+h+")",e.y1&&(e.y1/=h),e.y2&&(e.y2/=h)}return o}fabric.Gradient=fabric.util.createClass({offsetX:0,offsetY:0,initialize:function(t){t||(t={});var e={};this.id=fabric.Object.__uid++,this.type=t.type||"linear",e={x1:t.coords.x1||0,y1:t.coords.y1||0,x2:t.coords.x2||0,y2:t.coords.y2||0},"radial"===this.type&&(e.r1=t.coords.r1||0,e.r2=t.coords.r2||0),this.coords=e,this.colorStops=t.colorStops.slice(),t.gradientTransform&&(this.gradientTransform=t.gradientTransform),this.offsetX=t.offsetX||this.offsetX,this.offsetY=t.offsetY||this.offsetY},addColorStop:function(t){for(var e in t){var i=new fabric.Color(t[e]);this.colorStops.push({offset:e,color:i.toRgb(),opacity:i.getAlpha()})}return this},toObject:function(){return{type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY}},toSVG:function(t){var e,i,r=fabric.util.object.clone(this.coords);if(this.colorStops.sort(function(t,e){return t.offset-e.offset}),!t.group||"path-group"!==t.group.type)for(var s in r)"x1"===s||"x2"===s||"r2"===s?r[s]+=this.offsetX-t.width/2:("y1"===s||"y2"===s)&&(r[s]+=this.offsetY-t.height/2);i='id="SVGID_'+this.id+'" gradientUnits="userSpaceOnUse"',this.gradientTransform&&(i+=' gradientTransform="matrix('+this.gradientTransform.join(" ")+')" '),"linear"===this.type?e=["<linearGradient ",i,' x1="',r.x1,'" y1="',r.y1,'" x2="',r.x2,'" y2="',r.y2,'">\n']:"radial"===this.type&&(e=["<radialGradient ",i,' cx="',r.x2,'" cy="',r.y2,'" r="',r.r2,'" fx="',r.x1,'" fy="',r.y1,'">\n']);for(var n=0;n<this.colorStops.length;n++)e.push("<stop ",'offset="',100*this.colorStops[n].offset+"%",'" style="stop-color:',this.colorStops[n].color,null!=this.colorStops[n].opacity?";stop-opacity: "+this.colorStops[n].opacity:";",'"/>\n');return e.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n"),e.join("")},toLive:function(t,e){var i,r,s=fabric.util.object.clone(this.coords);if(this.type){if(e.group&&"path-group"===e.group.type)for(r in s)"x1"===r||"x2"===r?s[r]+=-this.offsetX+e.width/2:("y1"===r||"y2"===r)&&(s[r]+=-this.offsetY+e.height/2);"linear"===this.type?i=t.createLinearGradient(s.x1,s.y1,s.x2,s.y2):"radial"===this.type&&(i=t.createRadialGradient(s.x1,s.y1,s.r1,s.x2,s.y2,s.r2));for(var n=0,o=this.colorStops.length;o>n;n++){var a=this.colorStops[n].color,h=this.colorStops[n].opacity,c=this.colorStops[n].offset;"undefined"!=typeof h&&(a=new fabric.Color(a).setAlpha(h).toRgba()),i.addColorStop(parseFloat(c),a)}return i}}}),fabric.util.object.extend(fabric.Gradient,{fromElement:function(s,n){var o,a=s.getElementsByTagName("stop"),h="linearGradient"===s.nodeName?"linear":"radial",c=s.getAttribute("gradientUnits")||"objectBoundingBox",l=s.getAttribute("gradientTransform"),u=[],f={};"linear"===h?f=e(s):"radial"===h&&(f=i(s));for(var d=a.length;d--;)u.push(t(a[d]));o=r(n,f,c);var g=new fabric.Gradient({type:h,coords:f,colorStops:u,offsetX:-n.left,offsetY:-n.top});return(l||""!==o)&&(g.gradientTransform=fabric.parseTransformAttribute((l||"")+o)),g},forObject:function(t,e){return e||(e={}),r(t,e.coords,"userSpaceOnUse"),new fabric.Gradient(e)}})}(),fabric.Pattern=fabric.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,initialize:function(t){if(t||(t={}),this.id=fabric.Object.__uid++,t.source)if("string"==typeof t.source)if("undefined"!=typeof fabric.util.getFunctionBody(t.source))this.source=new Function(fabric.util.getFunctionBody(t.source));else{var e=this;this.source=fabric.util.createImage(),fabric.util.loadImage(t.source,function(t){e.source=t})}else this.source=t.source;t.repeat&&(this.repeat=t.repeat),t.offsetX&&(this.offsetX=t.offsetX),t.offsetY&&(this.offsetY=t.offsetY)},toObject:function(){var t;return"function"==typeof this.source?t=String(this.source):"string"==typeof this.source.src&&(t=this.source.src),{source:t,repeat:this.repeat,offsetX:this.offsetX,offsetY:this.offsetY}},toSVG:function(t){var e="function"==typeof this.source?this.source():this.source,i=e.width/t.getWidth(),r=e.height/t.getHeight(),s=this.offsetX/t.getWidth(),n=this.offsetY/t.getHeight(),o="";return("repeat-x"===this.repeat||"no-repeat"===this.repeat)&&(r=1),("repeat-y"===this.repeat||"no-repeat"===this.repeat)&&(i=1),e.src?o=e.src:e.toDataURL&&(o=e.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+s+'" y="'+n+'" width="'+i+'" height="'+r+'">\n<image x="0" y="0" width="'+e.width+'" height="'+e.height+'" xlink:href="'+o+'"></image>\n</pattern>\n'},toLive:function(t){var e="function"==typeof this.source?this.source():this.source;if(!e)return"";if("undefined"!=typeof e.src){if(!e.complete)return"";if(0===e.naturalWidth||0===e.naturalHeight)return""}return t.createPattern(e,this.repeat)}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.toFixed;return e.Shadow?void e.warn("fabric.Shadow is already defined."):(e.Shadow=e.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,initialize:function(t){"string"==typeof t&&(t=this._parseShadow(t));for(var i in t)this[i]=t[i];this.id=e.Object.__uid++},_parseShadow:function(t){var i=t.trim(),r=e.Shadow.reOffsetsAndBlur.exec(i)||[],s=i.replace(e.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:s.trim(),offsetX:parseInt(r[1],10)||0,offsetY:parseInt(r[2],10)||0,blur:parseInt(r[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(t){var e="SourceAlpha",r=40,s=40;return!t||t.fill!==this.color&&t.stroke!==this.color||(e="SourceGraphic"),t.width&&t.height&&(r=100*i(Math.abs(this.offsetX/t.getWidth()),2)+20,s=100*i(Math.abs(this.offsetY/t.getHeight()),2)+20),'<filter id="SVGID_'+this.id+'" y="-'+s+'%" height="'+(100+2*s)+'%" x="-'+r+'%" width="'+(100+2*r)+'%" >\n	<feGaussianBlur in="'+e+'" stdDeviation="'+i(this.blur?this.blur/2:0,3)+'" result="blurOut"></feGaussianBlur>\n	<feColorMatrix result="matrixOut" in="blurOut" type="matrix" values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0.30 0" ></feColorMatrix >\n	<feOffset dx="'+this.offsetX+'" dy="'+this.offsetY+'"></feOffset>\n	<feMerge>\n		<feMergeNode></feMergeNode>\n		<feMergeNode in="SourceGraphic"></feMergeNode>\n	</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY};var t={},i=e.Shadow.prototype;return this.color!==i.color&&(t.color=this.color),this.blur!==i.blur&&(t.blur=this.blur),this.offsetX!==i.offsetX&&(t.offsetX=this.offsetX),this.offsetY!==i.offsetY&&(t.offsetY=this.offsetY),t}}),void(e.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:px)?(?:\s?|$))?(-?\d+(?:px)?(?:\s?|$))?(\d+(?:px)?)?(?:\s?|$)(?:$|\s)/))}("undefined"!=typeof exports?exports:this),function(){"use strict";if(fabric.StaticCanvas)return void fabric.warn("fabric.StaticCanvas is already defined.");var t=fabric.util.object.extend,e=fabric.util.getElementOffset,i=fabric.util.removeFromArray,r=new Error("Could not initialize `canvas` element");fabric.StaticCanvas=fabric.util.createClass({initialize:function(t,e){e||(e={}),this._initStatic(t,e),fabric.StaticCanvas.activeInstance=this},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!0,renderOnAddRemove:!0,clipTo:null,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,preserveObjectStacking:!1,viewportTransform:[1,0,0,1,0,0],onBeforeScaleRotate:function(){},_initStatic:function(t,e){this._objects=[],this._createLowerCanvas(t),this._initOptions(e),this._setImageSmoothing(),e.overlayImage&&this.setOverlayImage(e.overlayImage,this.renderAll.bind(this)),e.backgroundImage&&this.setBackgroundImage(e.backgroundImage,this.renderAll.bind(this)),e.backgroundColor&&this.setBackgroundColor(e.backgroundColor,this.renderAll.bind(this)),e.overlayColor&&this.setOverlayColor(e.overlayColor,this.renderAll.bind(this)),this.calcOffset()},calcOffset:function(){return this._offset=e(this.lowerCanvasEl),this},setOverlayImage:function(t,e,i){return this.__setBgOverlayImage("overlayImage",t,e,i)},setBackgroundImage:function(t,e,i){return this.__setBgOverlayImage("backgroundImage",t,e,i)},setOverlayColor:function(t,e){return this.__setBgOverlayColor("overlayColor",t,e)},setBackgroundColor:function(t,e){return this.__setBgOverlayColor("backgroundColor",t,e)},_setImageSmoothing:function(){var t=this.getContext();t.imageSmoothingEnabled=this.imageSmoothingEnabled,t.webkitImageSmoothingEnabled=this.imageSmoothingEnabled,t.mozImageSmoothingEnabled=this.imageSmoothingEnabled,t.msImageSmoothingEnabled=this.imageSmoothingEnabled,t.oImageSmoothingEnabled=this.imageSmoothingEnabled},__setBgOverlayImage:function(t,e,i,r){return"string"==typeof e?fabric.util.loadImage(e,function(e){this[t]=new fabric.Image(e,r),i&&i()},this,r&&r.crossOrigin):(r&&e.setOptions(r),this[t]=e,i&&i()),this},__setBgOverlayColor:function(t,e,i){if(e&&e.source){var r=this;fabric.util.loadImage(e.source,function(s){r[t]=new fabric.Pattern({source:s,repeat:e.repeat,offsetX:e.offsetX,offsetY:e.offsetY}),i&&i()})}else this[t]=e,i&&i();return this},_createCanvasElement:function(){var t=fabric.document.createElement("canvas");if(t.style||(t.style={}),!t)throw r;return this._initCanvasElement(t),t},_initCanvasElement:function(t){if(fabric.util.createCanvasElement(t),"undefined"==typeof t.getContext)throw r},_initOptions:function(t){for(var e in t)this[e]=t[e];this.width=this.width||parseInt(this.lowerCanvasEl.width,10)||0,this.height=this.height||parseInt(this.lowerCanvasEl.height,10)||0,this.lowerCanvasEl.style&&(this.lowerCanvasEl.width=this.width,this.lowerCanvasEl.height=this.height,this.lowerCanvasEl.style.width=this.width+"px",this.lowerCanvasEl.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(t){this.lowerCanvasEl=fabric.util.getById(t)||this._createCanvasElement(),this._initCanvasElement(this.lowerCanvasEl),fabric.util.addClass(this.lowerCanvasEl,"lower-canvas"),this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(t,e){return this.setDimensions({width:t},e)},setHeight:function(t,e){return this.setDimensions({height:t},e)},setDimensions:function(t,e){var i;e=e||{};for(var r in t)i=t[r],e.cssOnly||(this._setBackstoreDimension(r,t[r]),i+="px"),e.backstoreOnly||this._setCssDimension(r,i);return e.cssOnly||this.renderAll(),this.calcOffset(),this},_setBackstoreDimension:function(t,e){return this.lowerCanvasEl[t]=e,this.upperCanvasEl&&(this.upperCanvasEl[t]=e),this.cacheCanvasEl&&(this.cacheCanvasEl[t]=e),this[t]=e,this},_setCssDimension:function(t,e){return this.lowerCanvasEl.style[t]=e,this.upperCanvasEl&&(this.upperCanvasEl.style[t]=e),this.wrapperEl&&(this.wrapperEl.style[t]=e),this},getZoom:function(){return Math.sqrt(this.viewportTransform[0]*this.viewportTransform[3])},setViewportTransform:function(t){var e=this.getActiveGroup();this.viewportTransform=t,this.renderAll();for(var i=0,r=this._objects.length;r>i;i++)this._objects[i].setCoords();return e&&e.setCoords(),this},zoomToPoint:function(t,e){var i=t;t=fabric.util.transformPoint(t,fabric.util.invertTransform(this.viewportTransform)),this.viewportTransform[0]=e,this.viewportTransform[3]=e;var r=fabric.util.transformPoint(t,this.viewportTransform);this.viewportTransform[4]+=i.x-r.x,this.viewportTransform[5]+=i.y-r.y,this.renderAll();for(var s=0,n=this._objects.length;n>s;s++)this._objects[s].setCoords();return this},setZoom:function(t){return this.zoomToPoint(new fabric.Point(0,0),t),this},absolutePan:function(t){this.viewportTransform[4]=-t.x,this.viewportTransform[5]=-t.y,this.renderAll();for(var e=0,i=this._objects.length;i>e;e++)this._objects[e].setCoords();return this},relativePan:function(t){return this.absolutePan(new fabric.Point(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},getActiveObject:function(){return null},getActiveGroup:function(){return null},_draw:function(t,e){if(e){t.save();var i=this.viewportTransform;t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this._shouldRenderObject(e)&&e.render(t),t.restore(),this.controlsAboveOverlay||e._renderControls(t)}},_shouldRenderObject:function(t){return t?t!==this.getActiveGroup()||!this.preserveObjectStacking:!1},_onObjectAdded:function(t){this.stateful&&t.setupState(),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added")},_onObjectRemoved:function(t){this.getActiveObject()===t&&(this.fire("before:selection:cleared",{target:t}),this._discardActiveObject(),this.fire("selection:cleared")),this.fire("object:removed",{target:t}),t.fire("removed")},clearContext:function(t){return t.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this._objects.length=0,this.discardActiveGroup&&this.discardActiveGroup(),this.discardActiveObject&&this.discardActiveObject(),this.clearContext(this.contextContainer),this.contextTop&&this.clearContext(this.contextTop),this.fire("canvas:cleared"),this.renderAll(),this},renderAll:function(t){var e=this[t===!0&&this.interactive?"contextTop":"contextContainer"],i=this.getActiveGroup();return this.contextTop&&this.selection&&!this._groupSelector&&this.clearContext(this.contextTop),t||this.clearContext(e),this.fire("before:render"),this.clipTo&&fabric.util.clipContext(this,e),this._renderBackground(e),this._renderObjects(e,i),this._renderActiveGroup(e,i),this.clipTo&&e.restore(),this._renderOverlay(e),this.controlsAboveOverlay&&this.interactive&&this.drawControls(e),this.fire("after:render"),this},_renderObjects:function(t,e){var i,r;if(!e||this.preserveObjectStacking)for(i=0,r=this._objects.length;r>i;++i)this._draw(t,this._objects[i]);else for(i=0,r=this._objects.length;r>i;++i)this._objects[i]&&!e.contains(this._objects[i])&&this._draw(t,this._objects[i])},_renderActiveGroup:function(t,e){if(e){var i=[];this.forEachObject(function(t){e.contains(t)&&i.push(t)}),e._set("_objects",i.reverse()),this._draw(t,e)}},_renderBackground:function(t){this.backgroundColor&&(t.fillStyle=this.backgroundColor.toLive?this.backgroundColor.toLive(t):this.backgroundColor,t.fillRect(this.backgroundColor.offsetX||0,this.backgroundColor.offsetY||0,this.width,this.height)),this.backgroundImage&&this._draw(t,this.backgroundImage)},_renderOverlay:function(t){this.overlayColor&&(t.fillStyle=this.overlayColor.toLive?this.overlayColor.toLive(t):this.overlayColor,t.fillRect(this.overlayColor.offsetX||0,this.overlayColor.offsetY||0,this.width,this.height)),this.overlayImage&&this._draw(t,this.overlayImage)},renderTop:function(){var t=this.contextTop||this.contextContainer;this.clearContext(t),this.selection&&this._groupSelector&&this._drawSelection();var e=this.getActiveGroup();return e&&e.render(t),this._renderOverlay(t),this.fire("after:render"),this},getCenter:function(){return{top:this.getHeight()/2,left:this.getWidth()/2}},centerObjectH:function(t){return this._centerObject(t,new fabric.Point(this.getCenter().left,t.getCenterPoint().y)),this.renderAll(),this},centerObjectV:function(t){return this._centerObject(t,new fabric.Point(t.getCenterPoint().x,this.getCenter().top)),this.renderAll(),this},centerObject:function(t){var e=this.getCenter();return this._centerObject(t,new fabric.Point(e.left,e.top)),this.renderAll(),this},_centerObject:function(t,e){return t.setPositionByOrigin(e,"center","center"),this},toDatalessJSON:function(t){return this.toDatalessObject(t)},toObject:function(t){return this._toObjectMethod("toObject",t)},toDatalessObject:function(t){return this._toObjectMethod("toDatalessObject",t)},_toObjectMethod:function(e,i){var r={objects:this._toObjects(e,i)};return t(r,this.__serializeBgOverlay()),fabric.util.populateWithProperties(this,r,i),r},_toObjects:function(t,e){return this.getObjects().map(function(i){return this._toObject(i,t,e)},this)},_toObject:function(t,e,i){var r;this.includeDefaultValues||(r=t.includeDefaultValues,t.includeDefaultValues=!1);var s=this._realizeGroupTransformOnObject(t),n=t[e](i);return this.includeDefaultValues||(t.includeDefaultValues=r),this._unwindGroupTransformOnObject(t,s),n},_realizeGroupTransformOnObject:function(t){var e=["angle","flipX","flipY","height","left","scaleX","scaleY","top","width"];if(t.group&&t.group===this.getActiveGroup()){var i={};return e.forEach(function(e){i[e]=t[e]}),this.getActiveGroup().realizeTransform(t),i}return null},_unwindGroupTransformOnObject:function(t,e){e&&t.set(e)},__serializeBgOverlay:function(){var t={background:this.backgroundColor&&this.backgroundColor.toObject?this.backgroundColor.toObject():this.backgroundColor};return this.overlayColor&&(t.overlay=this.overlayColor.toObject?this.overlayColor.toObject():this.overlayColor),this.backgroundImage&&(t.backgroundImage=this.backgroundImage.toObject()),this.overlayImage&&(t.overlayImage=this.overlayImage.toObject()),t},svgViewportTransformation:!0,toSVG:function(t,e){t||(t={});var i=[];return this._setSVGPreamble(i,t),this._setSVGHeader(i,t),this._setSVGBgOverlayColor(i,"backgroundColor"),this._setSVGBgOverlayImage(i,"backgroundImage"),this._setSVGObjects(i,e),this._setSVGBgOverlayColor(i,"overlayColor"),this._setSVGBgOverlayImage(i,"overlayImage"),i.push("</svg>"),i.join("")},_setSVGPreamble:function(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",'" standalone="no" ?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(t,e){var i,r,s;e.viewBox?(i=e.viewBox.width,r=e.viewBox.height):(i=this.width,r=this.height,this.svgViewportTransformation||(s=this.viewportTransform,i/=s[0],r/=s[3])),t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',i,'" ','height="',r,'" ',this.backgroundColor&&!this.backgroundColor.toLive?'style="background-color: '+this.backgroundColor+'" ':null,e.viewBox?'viewBox="'+e.viewBox.x+" "+e.viewBox.y+" "+e.viewBox.width+" "+e.viewBox.height+'" ':null,'xml:space="preserve">',"<desc>Created with Fabric.js ",fabric.version,"</desc>","<defs>",fabric.createSVGFontFacesMarkup(this.getObjects()),fabric.createSVGRefElementsMarkup(this),"</defs>");

},_setSVGObjects:function(t,e){for(var i=0,r=this.getObjects(),s=r.length;s>i;i++){var n=r[i],o=this._realizeGroupTransformOnObject(n);t.push(n.toSVG(e)),this._unwindGroupTransformOnObject(n,o)}},_setSVGBgOverlayImage:function(t,e){this[e]&&this[e].toSVG&&t.push(this[e].toSVG())},_setSVGBgOverlayColor:function(t,e){this[e]&&this[e].source?t.push('<rect x="',this[e].offsetX,'" y="',this[e].offsetY,'" ','width="',"repeat-y"===this[e].repeat||"no-repeat"===this[e].repeat?this[e].source.width:this.width,'" height="',"repeat-x"===this[e].repeat||"no-repeat"===this[e].repeat?this[e].source.height:this.height,'" fill="url(#'+e+'Pattern)"',"></rect>"):this[e]&&"overlayColor"===e&&t.push('<rect x="0" y="0" ','width="',this.width,'" height="',this.height,'" fill="',this[e],'"',"></rect>")},sendToBack:function(t){return i(this._objects,t),this._objects.unshift(t),this.renderAll&&this.renderAll()},bringToFront:function(t){return i(this._objects,t),this._objects.push(t),this.renderAll&&this.renderAll()},sendBackwards:function(t,e){var r=this._objects.indexOf(t);if(0!==r){var s=this._findNewLowerIndex(t,r,e);i(this._objects,t),this._objects.splice(s,0,t),this.renderAll&&this.renderAll()}return this},_findNewLowerIndex:function(t,e,i){var r;if(i){r=e;for(var s=e-1;s>=0;--s){var n=t.intersectsWithObject(this._objects[s])||t.isContainedWithinObject(this._objects[s])||this._objects[s].isContainedWithinObject(t);if(n){r=s;break}}}else r=e-1;return r},bringForward:function(t,e){var r=this._objects.indexOf(t);if(r!==this._objects.length-1){var s=this._findNewUpperIndex(t,r,e);i(this._objects,t),this._objects.splice(s,0,t),this.renderAll&&this.renderAll()}return this},_findNewUpperIndex:function(t,e,i){var r;if(i){r=e;for(var s=e+1;s<this._objects.length;++s){var n=t.intersectsWithObject(this._objects[s])||t.isContainedWithinObject(this._objects[s])||this._objects[s].isContainedWithinObject(t);if(n){r=s;break}}}else r=e+1;return r},moveTo:function(t,e){return i(this._objects,t),this._objects.splice(e,0,t),this.renderAll&&this.renderAll()},dispose:function(){return this.clear(),this.interactive&&this.removeListeners(),this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this.getObjects().length+" }>"}}),t(fabric.StaticCanvas.prototype,fabric.Observable),t(fabric.StaticCanvas.prototype,fabric.Collection),t(fabric.StaticCanvas.prototype,fabric.DataURLExporter),t(fabric.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(t){var e=fabric.util.createCanvasElement();if(!e||!e.getContext)return null;var i=e.getContext("2d");if(!i)return null;switch(t){case"getImageData":return"undefined"!=typeof i.getImageData;case"setLineDash":return"undefined"!=typeof i.setLineDash;case"toDataURL":return"undefined"!=typeof e.toDataURL;case"toDataURLWithQuality":try{return e.toDataURL("image/jpeg",0),!0}catch(r){}return!1;default:return null}}}),fabric.StaticCanvas.prototype.toJSON=fabric.StaticCanvas.prototype.toObject}(),fabric.BaseBrush=fabric.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeDashArray:null,setShadow:function(t){return this.shadow=new fabric.Shadow(t),this},_setBrushStyles:function(){var t=this.canvas.contextTop;t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.lineJoin=this.strokeLineJoin,this.strokeDashArray&&fabric.StaticCanvas.supports("setLineDash")&&t.setLineDash(this.strokeDashArray)},_setShadow:function(){if(this.shadow){var t=this.canvas.contextTop;t.shadowColor=this.shadow.color,t.shadowBlur=this.shadow.blur,t.shadowOffsetX=this.shadow.offsetX,t.shadowOffsetY=this.shadow.offsetY}},_resetShadow:function(){var t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0}}),function(){fabric.PencilBrush=fabric.util.createClass(fabric.BaseBrush,{initialize:function(t){this.canvas=t,this._points=[]},onMouseDown:function(t){this._prepareForDrawing(t),this._captureDrawingPath(t),this._render()},onMouseMove:function(t){this._captureDrawingPath(t),this.canvas.clearContext(this.canvas.contextTop),this._render()},onMouseUp:function(){this._finalizeAndAddPath()},_prepareForDrawing:function(t){var e=new fabric.Point(t.x,t.y);this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)},_addPoint:function(t){this._points.push(t)},_reset:function(){this._points.length=0,this._setBrushStyles(),this._setShadow()},_captureDrawingPath:function(t){var e=new fabric.Point(t.x,t.y);this._addPoint(e)},_render:function(){var t=this.canvas.contextTop,e=this.canvas.viewportTransform,i=this._points[0],r=this._points[1];t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t.beginPath(),2===this._points.length&&i.x===r.x&&i.y===r.y&&(i.x-=.5,r.x+=.5),t.moveTo(i.x,i.y);for(var s=1,n=this._points.length;n>s;s++){var o=i.midPointFrom(r);t.quadraticCurveTo(i.x,i.y,o.x,o.y),i=this._points[s],r=this._points[s+1]}t.lineTo(i.x,i.y),t.stroke(),t.restore()},convertPointsToSVGPath:function(t){var e=[],i=new fabric.Point(t[0].x,t[0].y),r=new fabric.Point(t[1].x,t[1].y);e.push("M ",t[0].x," ",t[0].y," ");for(var s=1,n=t.length;n>s;s++){var o=i.midPointFrom(r);e.push("Q ",i.x," ",i.y," ",o.x," ",o.y," "),i=new fabric.Point(t[s].x,t[s].y),s+1<t.length&&(r=new fabric.Point(t[s+1].x,t[s+1].y))}return e.push("L ",i.x," ",i.y," "),e},createPath:function(t){var e=new fabric.Path(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray,originX:"center",originY:"center"});return this.shadow&&(this.shadow.affectStroke=!0,e.setShadow(this.shadow)),e},_finalizeAndAddPath:function(){var t=this.canvas.contextTop;t.closePath();var e=this.convertPointsToSVGPath(this._points).join("");if("M 0 0 Q 0 0 0 0 L 0 0"===e)return void this.canvas.renderAll();var i=this.createPath(e);this.canvas.add(i),i.setCoords(),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderAll(),this.canvas.fire("path:created",{path:i})}})}(),fabric.CircleBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,initialize:function(t){this.canvas=t,this.points=[]},drawDot:function(t){var e=this.addPoint(t),i=this.canvas.contextTop,r=this.canvas.viewportTransform;i.save(),i.transform(r[0],r[1],r[2],r[3],r[4],r[5]),i.fillStyle=e.fill,i.beginPath(),i.arc(e.x,e.y,e.radius,0,2*Math.PI,!1),i.closePath(),i.fill(),i.restore()},onMouseDown:function(t){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(t)},onMouseMove:function(t){this.drawDot(t)},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],i=0,r=this.points.length;r>i;i++){var s=this.points[i],n=new fabric.Circle({radius:s.radius,left:s.x,top:s.y,originX:"center",originY:"center",fill:s.fill});this.shadow&&n.setShadow(this.shadow),e.push(n)}var o=new fabric.Group(e,{originX:"center",originY:"center"});o.canvas=this.canvas,this.canvas.add(o),this.canvas.fire("path:created",{path:o}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.renderAll()},addPoint:function(t){var e=new fabric.Point(t.x,t.y),i=fabric.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,r=new fabric.Color(this.color).setAlpha(fabric.util.getRandomInt(0,100)/100).toRgba();return e.radius=i,e.fill=r,this.points.push(e),e}}),fabric.SprayBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(t){this.canvas=t,this.sprayChunks=[]},onMouseDown:function(t){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(t),this.render()},onMouseMove:function(t){this.addSprayChunk(t),this.render()},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],i=0,r=this.sprayChunks.length;r>i;i++)for(var s=this.sprayChunks[i],n=0,o=s.length;o>n;n++){var a=new fabric.Rect({width:s[n].width,height:s[n].width,left:s[n].x+1,top:s[n].y+1,originX:"center",originY:"center",fill:this.color});this.shadow&&a.setShadow(this.shadow),e.push(a)}this.optimizeOverlapping&&(e=this._getOptimizedRects(e));var h=new fabric.Group(e,{originX:"center",originY:"center"});h.canvas=this.canvas,this.canvas.add(h),this.canvas.fire("path:created",{path:h}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.renderAll()},_getOptimizedRects:function(t){for(var e,i={},r=0,s=t.length;s>r;r++)e=t[r].left+""+t[r].top,i[e]||(i[e]=t[r]);var n=[];for(e in i)n.push(i[e]);return n},render:function(){var t=this.canvas.contextTop;t.fillStyle=this.color;var e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5]);for(var i=0,r=this.sprayChunkPoints.length;r>i;i++){var s=this.sprayChunkPoints[i];"undefined"!=typeof s.opacity&&(t.globalAlpha=s.opacity),t.fillRect(s.x,s.y,s.width,s.width)}t.restore()},addSprayChunk:function(t){this.sprayChunkPoints=[];for(var e,i,r,s=this.width/2,n=0;n<this.density;n++){e=fabric.util.getRandomInt(t.x-s,t.x+s),i=fabric.util.getRandomInt(t.y-s,t.y+s),r=this.dotWidthVariance?fabric.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var o=new fabric.Point(e,i);o.width=r,this.randomOpacity&&(o.opacity=fabric.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(o)}this.sprayChunks.push(this.sprayChunkPoints)}}),fabric.PatternBrush=fabric.util.createClass(fabric.PencilBrush,{getPatternSrc:function(){var t=20,e=5,i=fabric.document.createElement("canvas"),r=i.getContext("2d");return i.width=i.height=t+e,r.fillStyle=this.color,r.beginPath(),r.arc(t/2,t/2,t/2,0,2*Math.PI,!1),r.closePath(),r.fill(),i},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(){return this.canvas.contextTop.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(){this.callSuper("_setBrushStyles"),this.canvas.contextTop.strokeStyle=this.getPattern()},createPath:function(t){var e=this.callSuper("createPath",t);return e.stroke=new fabric.Pattern({source:this.source||this.getPatternSrcFunction()}),e}}),function(){var t=fabric.util.getPointer,e=fabric.util.degreesToRadians,i=fabric.util.radiansToDegrees,r=Math.atan2,s=Math.abs,n=.5;fabric.Canvas=fabric.util.createClass(fabric.StaticCanvas,{initialize:function(t,e){e||(e={}),this._initStatic(t,e),this._initInteractive(),this._createCacheCanvas(),fabric.Canvas.activeInstance=this},uniScaleTransform:!1,centeredScaling:!1,centeredRotation:!1,interactive:!0,selection:!0,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this.freeDrawingBrush=fabric.PencilBrush&&new fabric.PencilBrush(this),this.calcOffset()},_resetCurrentTransform:function(t){var e=this._currentTransform;e.target.set({scaleX:e.original.scaleX,scaleY:e.original.scaleY,left:e.original.left,top:e.original.top}),this._shouldCenterTransform(t,e.target)?"rotate"===e.action?this._setOriginToCenter(e.target):("center"!==e.originX&&("right"===e.originX?e.mouseXSign=-1:e.mouseXSign=1),"center"!==e.originY&&("bottom"===e.originY?e.mouseYSign=-1:e.mouseYSign=1),e.originX="center",e.originY="center"):(e.originX=e.original.originX,e.originY=e.original.originY)},containsPoint:function(t,e){var i=this.getPointer(t,!0),r=this._normalizePointer(e,i);return e.containsPoint(r)||e._findTargetCorner(i)},_normalizePointer:function(t,e){var i,r=this.getActiveGroup(),s=e.x,n=e.y,o=r&&"group"!==t.type&&r.contains(t);return o&&(i=new fabric.Point(r.left,r.top),i=fabric.util.transformPoint(i,this.viewportTransform,!0),s-=i.x,n-=i.y),{x:s,y:n}},isTargetTransparent:function(t,e,i){var r=t.hasBorders,s=t.transparentCorners;t.hasBorders=t.transparentCorners=!1,this._draw(this.contextCache,t),t.hasBorders=r,t.transparentCorners=s;var n=fabric.util.isTransparent(this.contextCache,e,i,this.targetFindTolerance);return this.clearContext(this.contextCache),n},_shouldClearSelection:function(t,e){var i=this.getActiveGroup(),r=this.getActiveObject();return!e||e&&i&&!i.contains(e)&&i!==e&&!t.shiftKey||e&&!e.evented||e&&!e.selectable&&r&&r!==e},_shouldCenterTransform:function(t,e){if(e){var i,r=this._currentTransform;return"scale"===r.action||"scaleX"===r.action||"scaleY"===r.action?i=this.centeredScaling||e.centeredScaling:"rotate"===r.action&&(i=this.centeredRotation||e.centeredRotation),i?!t.altKey:t.altKey}},_getOriginFromCorner:function(t,e){var i={x:t.originX,y:t.originY};return"ml"===e||"tl"===e||"bl"===e?i.x="right":("mr"===e||"tr"===e||"br"===e)&&(i.x="left"),"tl"===e||"mt"===e||"tr"===e?i.y="bottom":("bl"===e||"mb"===e||"br"===e)&&(i.y="top"),i},_getActionFromCorner:function(t,e){var i="drag";return e&&(i="ml"===e||"mr"===e?"scaleX":"mt"===e||"mb"===e?"scaleY":"mtr"===e?"rotate":"scale"),i},_setupCurrentTransform:function(t,i){if(i){var r=this.getPointer(t),s=i._findTargetCorner(this.getPointer(t,!0)),n=this._getActionFromCorner(i,s),o=this._getOriginFromCorner(i,s);this._currentTransform={target:i,action:n,scaleX:i.scaleX,scaleY:i.scaleY,offsetX:r.x-i.left,offsetY:r.y-i.top,originX:o.x,originY:o.y,ex:r.x,ey:r.y,left:i.left,top:i.top,theta:e(i.angle),width:i.width*i.scaleX,mouseXSign:1,mouseYSign:1},this._currentTransform.original={left:i.left,top:i.top,scaleX:i.scaleX,scaleY:i.scaleY,originX:o.x,originY:o.y},this._resetCurrentTransform(t)}},_translateObject:function(t,e){var i=this._currentTransform.target;i.get("lockMovementX")||i.set("left",t-this._currentTransform.offsetX),i.get("lockMovementY")||i.set("top",e-this._currentTransform.offsetY)},_scaleObject:function(t,e,i){var r=this._currentTransform,s=r.target,n=s.get("lockScalingX"),o=s.get("lockScalingY"),a=s.get("lockScalingFlip");if(!n||!o){var h=s.translateToOriginPoint(s.getCenterPoint(),r.originX,r.originY),c=s.toLocalPoint(new fabric.Point(t,e),r.originX,r.originY);this._setLocalMouse(c,r),this._setObjectScale(c,r,n,o,i,a),s.setPositionByOrigin(h,r.originX,r.originY)}},_setObjectScale:function(t,e,i,r,s,n){var o=e.target,a=!1,h=!1,c="line"===o.type&&0===o.width,l="line"===o.type&&0===o.height,u=l?0:o.strokeWidth,f=c?0:o.strokeWidth;e.newScaleX=t.x/(o.width+u),e.newScaleY=t.y/(o.height+f),n&&e.newScaleX<=0&&e.newScaleX<o.scaleX&&(a=!0),n&&e.newScaleY<=0&&e.newScaleY<o.scaleY&&(h=!0),"equally"!==s||i||r?s?"x"!==s||o.get("lockUniScaling")?"y"!==s||o.get("lockUniScaling")||h||r||o.set("scaleY",e.newScaleY):a||i||o.set("scaleX",e.newScaleX):(a||i||o.set("scaleX",e.newScaleX),h||r||o.set("scaleY",e.newScaleY)):a||h||this._scaleObjectEqually(t,o,e),a||h||this._flipObject(e,s)},_scaleObjectEqually:function(t,e,i){var r=t.y+t.x,s="line"===e.type&&0===e.width,n="line"===e.type&&0===e.height,o=n?0:e.strokeWidth,a=s?0:e.strokeWidth,h=(e.height+a)*i.original.scaleY+(e.width+o)*i.original.scaleX;i.newScaleX=i.original.scaleX*r/h,i.newScaleY=i.original.scaleY*r/h,e.set("scaleX",i.newScaleX),e.set("scaleY",i.newScaleY)},_flipObject:function(t,e){t.newScaleX<0&&"y"!==e&&("left"===t.originX?t.originX="right":"right"===t.originX&&(t.originX="left")),t.newScaleY<0&&"x"!==e&&("top"===t.originY?t.originY="bottom":"bottom"===t.originY&&(t.originY="top"))},_setLocalMouse:function(t,e){var i=e.target;"right"===e.originX?t.x*=-1:"center"===e.originX&&(t.x*=2*e.mouseXSign,t.x<0&&(e.mouseXSign=-e.mouseXSign)),"bottom"===e.originY?t.y*=-1:"center"===e.originY&&(t.y*=2*e.mouseYSign,t.y<0&&(e.mouseYSign=-e.mouseYSign)),s(t.x)>i.padding?t.x<0?t.x+=i.padding:t.x-=i.padding:t.x=0,s(t.y)>i.padding?t.y<0?t.y+=i.padding:t.y-=i.padding:t.y=0},_rotateObject:function(t,e){var s=this._currentTransform;if(!s.target.get("lockRotation")){var n=r(s.ey-s.top,s.ex-s.left),o=r(e-s.top,t-s.left),a=i(o-n+s.theta);0>a&&(a=360+a),s.target.angle=a%360}},setCursor:function(t){this.upperCanvasEl.style.cursor=t},_resetObjectTransform:function(t){t.scaleX=1,t.scaleY=1,t.setAngle(0)},_drawSelection:function(){var t=this.contextTop,e=this._groupSelector,i=e.left,r=e.top,o=s(i),a=s(r);if(t.fillStyle=this.selectionColor,t.fillRect(e.ex-(i>0?0:-i),e.ey-(r>0?0:-r),o,a),t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,this.selectionDashArray.length>1){var h=e.ex+n-(i>0?0:o),c=e.ey+n-(r>0?0:a);t.beginPath(),fabric.util.drawDashedLine(t,h,c,h+o,c,this.selectionDashArray),fabric.util.drawDashedLine(t,h,c+a-1,h+o,c+a-1,this.selectionDashArray),fabric.util.drawDashedLine(t,h,c,h,c+a,this.selectionDashArray),fabric.util.drawDashedLine(t,h+o-1,c,h+o-1,c+a,this.selectionDashArray),t.closePath(),t.stroke()}else t.strokeRect(e.ex+n-(i>0?0:o),e.ey+n-(r>0?0:a),o,a)},_isLastRenderedObject:function(t){return this.controlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay.visible&&this.containsPoint(t,this.lastRenderedObjectWithControlsAboveOverlay)&&this.lastRenderedObjectWithControlsAboveOverlay._findTargetCorner(this.getPointer(t,!0))},findTarget:function(t,e){if(!this.skipTargetFind){if(this._isLastRenderedObject(t))return this.lastRenderedObjectWithControlsAboveOverlay;var i=this.getActiveGroup();if(i&&!e&&this.containsPoint(t,i))return i;var r=this._searchPossibleTargets(t);return this._fireOverOutEvents(r,t),r}},_fireOverOutEvents:function(t,e){t?this._hoveredTarget!==t&&(this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget,e:e}),this._hoveredTarget.fire("mouseout")),this.fire("mouse:over",{target:t,e:e}),t.fire("mouseover"),this._hoveredTarget=t):this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget,e:e}),this._hoveredTarget.fire("mouseout"),this._hoveredTarget=null)},_checkTarget:function(t,e,i){if(e&&e.visible&&e.evented&&this.containsPoint(t,e)){if(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing)return!0;var r=this.isTargetTransparent(e,i.x,i.y);if(!r)return!0}},_searchPossibleTargets:function(t){for(var e,i=this.getPointer(t,!0),r=this._objects.length;r--;)if(!this._objects[r].group&&this._checkTarget(t,this._objects[r],i)){this.relatedTarget=this._objects[r],e=this._objects[r];break}return e},getPointer:function(e,i,r){r||(r=this.upperCanvasEl);var s,n=t(e,r),o=r.getBoundingClientRect(),a=o.width||0,h=o.height||0;return a&&h||("top"in o&&"bottom"in o&&(h=Math.abs(o.top-o.bottom)),"right"in o&&"left"in o&&(a=Math.abs(o.right-o.left))),this.calcOffset(),n.x=n.x-this._offset.left,n.y=n.y-this._offset.top,i||(n=fabric.util.transformPoint(n,fabric.util.invertTransform(this.viewportTransform))),s=0===a||0===h?{width:1,height:1}:{width:r.width/a,height:r.height/h},{x:n.x*s.width,y:n.y*s.height}},_createUpperCanvas:function(){var t=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,"");this.upperCanvasEl=this._createCanvasElement(),fabric.util.addClass(this.upperCanvasEl,"upper-canvas "+t),this.wrapperEl.appendChild(this.upperCanvasEl),this._copyCanvasStyle(this.lowerCanvasEl,this.upperCanvasEl),this._applyCanvasStyle(this.upperCanvasEl),this.contextTop=this.upperCanvasEl.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=fabric.util.wrapElement(this.lowerCanvasEl,"div",{"class":this.containerClass}),fabric.util.setStyle(this.wrapperEl,{width:this.getWidth()+"px",height:this.getHeight()+"px",position:"relative"}),fabric.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(t){var e=this.getWidth()||t.width,i=this.getHeight()||t.height;fabric.util.setStyle(t,{position:"absolute",width:e+"px",height:i+"px",left:0,top:0}),t.width=e,t.height=i,fabric.util.makeElementUnselectable(t)},_copyCanvasStyle:function(t,e){e.style.cssText=t.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},_setActiveObject:function(t){this._activeObject&&this._activeObject.set("active",!1),this._activeObject=t,t.set("active",!0)},setActiveObject:function(t,e){return this._setActiveObject(t),this.renderAll(),this.fire("object:selected",{target:t,e:e}),t.fire("selected",{e:e}),this},getActiveObject:function(){return this._activeObject},_discardActiveObject:function(){this._activeObject&&this._activeObject.set("active",!1),this._activeObject=null},discardActiveObject:function(t){return this._discardActiveObject(),this.renderAll(),this.fire("selection:cleared",{e:t}),this},_setActiveGroup:function(t){this._activeGroup=t,t&&t.set("active",!0)},setActiveGroup:function(t,e){return this._setActiveGroup(t),t&&(this.fire("object:selected",{target:t,e:e}),t.fire("selected",{e:e})),this},getActiveGroup:function(){return this._activeGroup},_discardActiveGroup:function(){var t=this.getActiveGroup();t&&t.destroy(),this.setActiveGroup(null)},discardActiveGroup:function(t){return this._discardActiveGroup(),this.fire("selection:cleared",{e:t}),this},deactivateAll:function(){for(var t=this.getObjects(),e=0,i=t.length;i>e;e++)t[e].set("active",!1);return this._discardActiveGroup(),this._discardActiveObject(),this},deactivateAllWithDispatch:function(t){var e=this.getActiveGroup()||this.getActiveObject();return e&&this.fire("before:selection:cleared",{target:e,e:t}),this.deactivateAll(),e&&this.fire("selection:cleared",{e:t}),this},drawControls:function(t){var e=this.getActiveGroup();e?this._drawGroupControls(t,e):this._drawObjectsControls(t)},_drawGroupControls:function(t,e){e._renderControls(t)},_drawObjectsControls:function(t){for(var e=0,i=this._objects.length;i>e;++e)this._objects[e]&&this._objects[e].active&&(this._objects[e]._renderControls(t),this.lastRenderedObjectWithControlsAboveOverlay=this._objects[e])}});for(var o in fabric.StaticCanvas)"prototype"!==o&&(fabric.Canvas[o]=fabric.StaticCanvas[o]);fabric.isTouchSupported&&(fabric.Canvas.prototype._setCursorFromEvent=function(){}),fabric.Element=fabric.Canvas}(),function(){var t={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7},e=fabric.util.addListener,i=fabric.util.removeListener;fabric.util.object.extend(fabric.Canvas.prototype,{cursorMap:["n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize"],_initEventListeners:function(){this._bindEvents(),e(fabric.window,"resize",this._onResize),e(this.upperCanvasEl,"mousedown",this._onMouseDown),e(this.upperCanvasEl,"mousemove",this._onMouseMove),e(this.upperCanvasEl,"mousewheel",this._onMouseWheel),e(this.upperCanvasEl,"touchstart",this._onMouseDown),e(this.upperCanvasEl,"touchmove",this._onMouseMove),"undefined"!=typeof eventjs&&"add"in eventjs&&(eventjs.add(this.upperCanvasEl,"gesture",this._onGesture),eventjs.add(this.upperCanvasEl,"drag",this._onDrag),eventjs.add(this.upperCanvasEl,"orientation",this._onOrientationChange),eventjs.add(this.upperCanvasEl,"shake",this._onShake),eventjs.add(this.upperCanvasEl,"longpress",this._onLongPress))},_bindEvents:function(){this._onMouseDown=this._onMouseDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this)},removeListeners:function(){i(fabric.window,"resize",this._onResize),i(this.upperCanvasEl,"mousedown",this._onMouseDown),i(this.upperCanvasEl,"mousemove",this._onMouseMove),i(this.upperCanvasEl,"mousewheel",this._onMouseWheel),i(this.upperCanvasEl,"touchstart",this._onMouseDown),i(this.upperCanvasEl,"touchmove",this._onMouseMove),"undefined"!=typeof eventjs&&"remove"in eventjs&&(eventjs.remove(this.upperCanvasEl,"gesture",this._onGesture),eventjs.remove(this.upperCanvasEl,"drag",this._onDrag),eventjs.remove(this.upperCanvasEl,"orientation",this._onOrientationChange),eventjs.remove(this.upperCanvasEl,"shake",this._onShake),eventjs.remove(this.upperCanvasEl,"longpress",this._onLongPress))},_onGesture:function(t,e){this.__onTransformGesture&&this.__onTransformGesture(t,e)},_onDrag:function(t,e){this.__onDrag&&this.__onDrag(t,e)},_onMouseWheel:function(t,e){this.__onMouseWheel&&this.__onMouseWheel(t,e)},_onOrientationChange:function(t,e){this.__onOrientationChange&&this.__onOrientationChange(t,e)},_onShake:function(t,e){this.__onShake&&this.__onShake(t,e)},_onLongPress:function(t,e){this.__onLongPress&&this.__onLongPress(t,e)},_onMouseDown:function(t){this.__onMouseDown(t),e(fabric.document,"touchend",this._onMouseUp),e(fabric.document,"touchmove",this._onMouseMove),i(this.upperCanvasEl,"mousemove",this._onMouseMove),i(this.upperCanvasEl,"touchmove",this._onMouseMove),"touchstart"===t.type?i(this.upperCanvasEl,"mousedown",this._onMouseDown):(e(fabric.document,"mouseup",this._onMouseUp),e(fabric.document,"mousemove",this._onMouseMove))},_onMouseUp:function(t){if(this.__onMouseUp(t),i(fabric.document,"mouseup",this._onMouseUp),i(fabric.document,"touchend",this._onMouseUp),i(fabric.document,"mousemove",this._onMouseMove),i(fabric.document,"touchmove",this._onMouseMove),e(this.upperCanvasEl,"mousemove",this._onMouseMove),e(this.upperCanvasEl,"touchmove",this._onMouseMove),"touchend"===t.type){var r=this;setTimeout(function(){e(r.upperCanvasEl,"mousedown",r._onMouseDown)},400)}},_onMouseMove:function(t){!this.allowTouchScrolling&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)},_onResize:function(){this.calcOffset()},_shouldRender:function(t,e){var i=this.getActiveGroup()||this.getActiveObject();return!!(t&&(t.isMoving||t!==i)||!t&&i||!t&&!i&&!this._groupSelector||e&&this._previousPointer&&this.selection&&(e.x!==this._previousPointer.x||e.y!==this._previousPointer.y))},__onMouseUp:function(t){var e;if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(t);this._currentTransform?(this._finalizeCurrentTransform(),e=this._currentTransform.target):e=this.findTarget(t,!0);var i=this._shouldRender(e,this.getPointer(t));this._maybeGroupObjects(t),e&&(e.isMoving=!1),i&&this.renderAll(),this._handleCursorAndEvent(t,e)},_handleCursorAndEvent:function(t,e){this._setCursorFromEvent(t,e);var i=this;setTimeout(function(){i._setCursorFromEvent(t,e)},50),this.fire("mouse:up",{target:e,e:t}),e&&e.fire("mouseup",{e:t})},_finalizeCurrentTransform:function(){var t=this._currentTransform,e=t.target;e._scaling&&(e._scaling=!1),e.setCoords(),this.stateful&&e.hasStateChanged()&&(this.fire("object:modified",{target:e}),e.fire("modified")),this._restoreOriginXY(e)},_restoreOriginXY:function(t){if(this._previousOriginX&&this._previousOriginY){var e=t.translateToOriginPoint(t.getCenterPoint(),this._previousOriginX,this._previousOriginY);t.originX=this._previousOriginX,t.originY=this._previousOriginY,t.left=e.x,t.top=e.y,this._previousOriginX=null,this._previousOriginY=null}},_onMouseDownInDrawingMode:function(t){this._isCurrentlyDrawing=!0,this.discardActiveObject(t).renderAll(),this.clipTo&&fabric.util.clipContext(this,this.contextTop);var e=fabric.util.invertTransform(this.viewportTransform),i=fabric.util.transformPoint(this.getPointer(t,!0),e);this.freeDrawingBrush.onMouseDown(i),this.fire("mouse:down",{e:t});var r=this.findTarget(t);"undefined"!=typeof r&&r.fire("mousedown",{e:t,target:r})},_onMouseMoveInDrawingMode:function(t){if(this._isCurrentlyDrawing){var e=fabric.util.invertTransform(this.viewportTransform),i=fabric.util.transformPoint(this.getPointer(t,!0),e);this.freeDrawingBrush.onMouseMove(i)}this.setCursor(this.freeDrawingCursor),this.fire("mouse:move",{e:t});var r=this.findTarget(t);"undefined"!=typeof r&&r.fire("mousemove",{e:t,target:r})},_onMouseUpInDrawingMode:function(t){this._isCurrentlyDrawing=!1,this.clipTo&&this.contextTop.restore(),this.freeDrawingBrush.onMouseUp(),this.fire("mouse:up",{e:t});var e=this.findTarget(t);"undefined"!=typeof e&&e.fire("mouseup",{e:t,target:e})},__onMouseDown:function(t){var e="which"in t?1===t.which:1===t.button;if(e||fabric.isTouchSupported){if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(t);if(!this._currentTransform){var i=this.findTarget(t),r=this.getPointer(t,!0);this._previousPointer=r;var s=this._shouldRender(i,r),n=this._shouldGroup(t,i);this._shouldClearSelection(t,i)?this._clearSelection(t,i,r):n&&(this._handleGrouping(t,i),i=this.getActiveGroup()),i&&i.selectable&&!n&&(this._beforeTransform(t,i),this._setupCurrentTransform(t,i)),s&&this.renderAll(),this.fire("mouse:down",{target:i,e:t}),i&&i.fire("mousedown",{e:t})}}},_beforeTransform:function(t,e){this.stateful&&e.saveState(),e._findTargetCorner(this.getPointer(t))&&this.onBeforeScaleRotate(e),e!==this.getActiveGroup()&&e!==this.getActiveObject()&&(this.deactivateAll(),this.setActiveObject(e,t))},_clearSelection:function(t,e,i){this.deactivateAllWithDispatch(t),e&&e.selectable?this.setActiveObject(e,t):this.selection&&(this._groupSelector={ex:i.x,ey:i.y,top:0,left:0})},_setOriginToCenter:function(t){this._previousOriginX=this._currentTransform.target.originX,this._previousOriginY=this._currentTransform.target.originY;var e=t.getCenterPoint();t.originX="center",t.originY="center",t.left=e.x,t.top=e.y,this._currentTransform.left=t.left,this._currentTransform.top=t.top},_setCenterToOrigin:function(t){var e=t.translateToOriginPoint(t.getCenterPoint(),this._previousOriginX,this._previousOriginY);t.originX=this._previousOriginX,t.originY=this._previousOriginY,t.left=e.x,t.top=e.y,this._previousOriginX=null,this._previousOriginY=null},__onMouseMove:function(t){var e,i;if(this.isDrawingMode)return void this._onMouseMoveInDrawingMode(t);if(!("undefined"!=typeof t.touches&&t.touches.length>1)){var r=this._groupSelector;r?(i=this.getPointer(t,!0),r.left=i.x-r.ex,r.top=i.y-r.ey,this.renderTop()):this._currentTransform?this._transformObject(t):(e=this.findTarget(t),!e||e&&!e.selectable?this.setCursor(this.defaultCursor):this._setCursorFromEvent(t,e)),this.fire("mouse:move",{target:e,e:t}),e&&e.fire("mousemove",{e:t})}},_transformObject:function(t){var e=this.getPointer(t),i=this._currentTransform;i.reset=!1,i.target.isMoving=!0,this._beforeScaleTransform(t,i),this._performTransformAction(t,i,e),this.renderAll()},_performTransformAction:function(t,e,i){var r=i.x,s=i.y,n=e.target,o=e.action;"rotate"===o?(this._rotateObject(r,s),this._fire("rotating",n,t)):"scale"===o?(this._onScale(t,e,r,s),this._fire("scaling",n,t)):"scaleX"===o?(this._scaleObject(r,s,"x"),this._fire("scaling",n,t)):"scaleY"===o?(this._scaleObject(r,s,"y"),this._fire("scaling",n,t)):(this._translateObject(r,s),this._fire("moving",n,t),this.setCursor(this.moveCursor))},_fire:function(t,e,i){this.fire("object:"+t,{target:e,e:i}),e.fire(t,{e:i})},_beforeScaleTransform:function(t,e){if("scale"===e.action||"scaleX"===e.action||"scaleY"===e.action){var i=this._shouldCenterTransform(t,e.target);(i&&("center"!==e.originX||"center"!==e.originY)||!i&&"center"===e.originX&&"center"===e.originY)&&(this._resetCurrentTransform(t),e.reset=!0)}},_onScale:function(t,e,i,r){!t.shiftKey&&!this.uniScaleTransform||e.target.get("lockUniScaling")?(e.reset||"scale"!==e.currentAction||this._resetCurrentTransform(t,e.target),e.currentAction="scaleEqually",this._scaleObject(i,r,"equally")):(e.currentAction="scale",this._scaleObject(i,r));

},_setCursorFromEvent:function(t,e){if(!e||!e.selectable)return this.setCursor(this.defaultCursor),!1;var i=this.getActiveGroup(),r=e._findTargetCorner&&(!i||!i.contains(e))&&e._findTargetCorner(this.getPointer(t,!0));return r?this._setCornerCursor(r,e):this.setCursor(e.hoverCursor||this.hoverCursor),!0},_setCornerCursor:function(e,i){if(e in t)this.setCursor(this._getRotatedCornerCursor(e,i));else{if("mtr"!==e||!i.hasRotatingPoint)return this.setCursor(this.defaultCursor),!1;this.setCursor(this.rotationCursor)}},_getRotatedCornerCursor:function(e,i){var r=Math.round(i.getAngle()%360/45);return 0>r&&(r+=8),r+=t[e],r%=8,this.cursorMap[r]}})}(),function(){var t=Math.min,e=Math.max;fabric.util.object.extend(fabric.Canvas.prototype,{_shouldGroup:function(t,e){var i=this.getActiveObject();return t.shiftKey&&(this.getActiveGroup()||i&&i!==e)&&this.selection},_handleGrouping:function(t,e){(e!==this.getActiveGroup()||(e=this.findTarget(t,!0),e&&!e.isType("group")))&&(this.getActiveGroup()?this._updateActiveGroup(e,t):this._createActiveGroup(e,t),this._activeGroup&&this._activeGroup.saveCoords())},_updateActiveGroup:function(t,e){var i=this.getActiveGroup();if(i.contains(t)){if(i.removeWithUpdate(t),this._resetObjectTransform(i),t.set("active",!1),1===i.size())return this.discardActiveGroup(e),void this.setActiveObject(i.item(0))}else i.addWithUpdate(t),this._resetObjectTransform(i);this.fire("selection:created",{target:i,e:e}),i.set("active",!0)},_createActiveGroup:function(t,e){if(this._activeObject&&t!==this._activeObject){var i=this._createGroup(t);i.addWithUpdate(),this.setActiveGroup(i),this._activeObject=null,this.fire("selection:created",{target:i,e:e})}t.set("active",!0)},_createGroup:function(t){var e=this.getObjects(),i=e.indexOf(this._activeObject)<e.indexOf(t),r=i?[this._activeObject,t]:[t,this._activeObject];return new fabric.Group(r,{canvas:this})},_groupSelectedObjects:function(t){var e=this._collectObjects();1===e.length?this.setActiveObject(e[0],t):e.length>1&&(e=new fabric.Group(e.reverse(),{canvas:this}),e.addWithUpdate(),this.setActiveGroup(e,t),e.saveCoords(),this.fire("selection:created",{target:e}),this.renderAll())},_collectObjects:function(){for(var i,r=[],s=this._groupSelector.ex,n=this._groupSelector.ey,o=s+this._groupSelector.left,a=n+this._groupSelector.top,h=new fabric.Point(t(s,o),t(n,a)),c=new fabric.Point(e(s,o),e(n,a)),l=s===o&&n===a,u=this._objects.length;u--&&(i=this._objects[u],!(i&&i.selectable&&i.visible&&(i.intersectsWithRect(h,c)||i.isContainedWithinRect(h,c)||i.containsPoint(h)||i.containsPoint(c))&&(i.set("active",!0),r.push(i),l))););return r},_maybeGroupObjects:function(t){this.selection&&this._groupSelector&&this._groupSelectedObjects(t);var e=this.getActiveGroup();e&&(e.setObjectsCoords().setCoords(),e.isMoving=!1,this.setCursor(this.defaultCursor)),this._groupSelector=null,this._currentTransform=null}})}(),fabric.util.object.extend(fabric.StaticCanvas.prototype,{toDataURL:function(t){t||(t={});var e=t.format||"png",i=t.quality||1,r=t.multiplier||1,s={left:t.left,top:t.top,width:t.width,height:t.height};return 1!==r?this.__toDataURLWithMultiplier(e,i,s,r):this.__toDataURL(e,i,s)},__toDataURL:function(t,e,i){this.renderAll(!0);var r=this.upperCanvasEl||this.lowerCanvasEl,s=this.__getCroppedCanvas(r,i);"jpg"===t&&(t="jpeg");var n=fabric.StaticCanvas.supports("toDataURLWithQuality")?(s||r).toDataURL("image/"+t,e):(s||r).toDataURL("image/"+t);return this.contextTop&&this.clearContext(this.contextTop),this.renderAll(),s&&(s=null),n},__getCroppedCanvas:function(t,e){var i,r,s="left"in e||"top"in e||"width"in e||"height"in e;return s&&(i=fabric.util.createCanvasElement(),r=i.getContext("2d"),i.width=e.width||this.width,i.height=e.height||this.height,r.drawImage(t,-e.left||0,-e.top||0)),i},__toDataURLWithMultiplier:function(t,e,i,r){var s=this.getWidth(),n=this.getHeight(),o=s*r,a=n*r,h=this.getActiveObject(),c=this.getActiveGroup(),l=this.contextTop||this.contextContainer;r>1&&this.setWidth(o).setHeight(a),l.scale(r,r),i.left&&(i.left*=r),i.top&&(i.top*=r),i.width?i.width*=r:1>r&&(i.width=o),i.height?i.height*=r:1>r&&(i.height=a),c?this._tempRemoveBordersControlsFromGroup(c):h&&this.deactivateAll&&this.deactivateAll(),this.renderAll(!0);var u=this.__toDataURL(t,e,i);return this.width=s,this.height=n,l.scale(1/r,1/r),this.setWidth(s).setHeight(n),c?this._restoreBordersControlsOnGroup(c):h&&this.setActiveObject&&this.setActiveObject(h),this.contextTop&&this.clearContext(this.contextTop),this.renderAll(),u},toDataURLWithMultiplier:function(t,e,i){return this.toDataURL({format:t,multiplier:e,quality:i})},_tempRemoveBordersControlsFromGroup:function(t){t.origHasControls=t.hasControls,t.origBorderColor=t.borderColor,t.hasControls=!0,t.borderColor="rgba(0,0,0,0)",t.forEachObject(function(t){t.origBorderColor=t.borderColor,t.borderColor="rgba(0,0,0,0)"})},_restoreBordersControlsOnGroup:function(t){t.hideControls=t.origHideControls,t.borderColor=t.origBorderColor,t.forEachObject(function(t){t.borderColor=t.origBorderColor,delete t.origBorderColor})}}),fabric.util.object.extend(fabric.StaticCanvas.prototype,{loadFromDatalessJSON:function(t,e,i){return this.loadFromJSON(t,e,i)},loadFromJSON:function(t,e,i){if(t){var r="string"==typeof t?JSON.parse(t):t;this.clear();var s=this;return this._enlivenObjects(r.objects,function(){s._setBgOverlay(r,e)},i),this}},_setBgOverlay:function(t,e){var i=this,r={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!(t.backgroundImage||t.overlayImage||t.background||t.overlay))return void(e&&e());var s=function(){r.backgroundImage&&r.overlayImage&&r.backgroundColor&&r.overlayColor&&(i.renderAll(),e&&e())};this.__setBgOverlay("backgroundImage",t.backgroundImage,r,s),this.__setBgOverlay("overlayImage",t.overlayImage,r,s),this.__setBgOverlay("backgroundColor",t.background,r,s),this.__setBgOverlay("overlayColor",t.overlay,r,s),s()},__setBgOverlay:function(t,e,i,r){var s=this;return e?void("backgroundImage"===t||"overlayImage"===t?fabric.Image.fromObject(e,function(e){s[t]=e,i[t]=!0,r&&r()}):this["set"+fabric.util.string.capitalize(t,!0)](e,function(){i[t]=!0,r&&r()})):void(i[t]=!0)},_enlivenObjects:function(t,e,i){var r=this;if(!t||0===t.length)return void(e&&e());var s=this.renderOnAddRemove;this.renderOnAddRemove=!1,fabric.util.enlivenObjects(t,function(t){t.forEach(function(t,e){r.insertAt(t,e,!0)}),r.renderOnAddRemove=s,e&&e()},null,i)},_toDataURL:function(t,e){this.clone(function(i){e(i.toDataURL(t))})},_toDataURLWithMultiplier:function(t,e,i){this.clone(function(r){i(r.toDataURLWithMultiplier(t,e))})},clone:function(t,e){var i=JSON.stringify(this.toJSON(e));this.cloneWithoutData(function(e){e.loadFromJSON(i,function(){t&&t(e)})})},cloneWithoutData:function(t){var e=fabric.document.createElement("canvas");e.width=this.getWidth(),e.height=this.getHeight();var i=new fabric.Canvas(e);i.clipTo=this.clipTo,this.backgroundImage?(i.setBackgroundImage(this.backgroundImage.src,function(){i.renderAll(),t&&t(i)}),i.backgroundImageOpacity=this.backgroundImageOpacity,i.backgroundImageStretch=this.backgroundImageStretch):t&&t(i)}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.toFixed,s=e.util.string.capitalize,n=e.util.degreesToRadians,o=e.StaticCanvas.supports("setLineDash");e.Object||(e.Object=e.util.createClass({type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,cornerSize:12,transparentCorners:!0,hoverCursor:null,padding:0,borderColor:"rgba(102,153,255,0.75)",cornerColor:"rgba(102,153,255,0.5)",centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:10,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,transformMatrix:null,minScaleLimit:.01,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,hasRotatingPoint:!0,rotatingPointOffset:40,perPixelTargetFind:!1,includeDefaultValues:!0,clipTo:null,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockUniScaling:!1,lockScalingFlip:!1,stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeLineJoin strokeMiterLimit angle opacity fill fillRule globalCompositeOperation shadow clipTo visible backgroundColor".split(" "),initialize:function(t){t&&this.setOptions(t)},_initGradient:function(t){!t.fill||!t.fill.colorStops||t.fill instanceof e.Gradient||this.set("fill",new e.Gradient(t.fill)),!t.stroke||!t.stroke.colorStops||t.stroke instanceof e.Gradient||this.set("stroke",new e.Gradient(t.stroke))},_initPattern:function(t){!t.fill||!t.fill.source||t.fill instanceof e.Pattern||this.set("fill",new e.Pattern(t.fill)),!t.stroke||!t.stroke.source||t.stroke instanceof e.Pattern||this.set("stroke",new e.Pattern(t.stroke))},_initClipping:function(t){if(t.clipTo&&"string"==typeof t.clipTo){var i=e.util.getFunctionBody(t.clipTo);"undefined"!=typeof i&&(this.clipTo=new Function("ctx",i))}},setOptions:function(t){for(var e in t)this.set(e,t[e]);this._initGradient(t),this._initPattern(t),this._initClipping(t)},transform:function(t,e){this.group&&this.canvas.preserveObjectStacking&&this.group===this.canvas._activeGroup&&this.group.transform(t);var i=e?this._getLeftTopCoords():this.getCenterPoint();t.translate(i.x,i.y),t.rotate(n(this.angle)),t.scale(this.scaleX*(this.flipX?-1:1),this.scaleY*(this.flipY?-1:1))},toObject:function(t){var i=e.Object.NUM_FRACTION_DIGITS,s={type:this.type,originX:this.originX,originY:this.originY,left:r(this.left,i),top:r(this.top,i),width:r(this.width,i),height:r(this.height,i),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:r(this.strokeWidth,i),strokeDashArray:this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:r(this.strokeMiterLimit,i),scaleX:r(this.scaleX,i),scaleY:r(this.scaleY,i),angle:r(this.getAngle(),i),flipX:this.flipX,flipY:this.flipY,opacity:r(this.opacity,i),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,clipTo:this.clipTo&&String(this.clipTo),backgroundColor:this.backgroundColor,fillRule:this.fillRule,globalCompositeOperation:this.globalCompositeOperation};return this.includeDefaultValues||(s=this._removeDefaultValues(s)),e.util.populateWithProperties(this,s,t),s},toDatalessObject:function(t){return this.toObject(t)},_removeDefaultValues:function(t){var i=e.util.getKlass(t.type).prototype,r=i.stateProperties;return r.forEach(function(e){t[e]===i[e]&&delete t[e]}),t},toString:function(){return"#<fabric."+s(this.type)+">"},get:function(t){return this[t]},_setObject:function(t){for(var e in t)this._set(e,t[e])},set:function(t,e){return"object"==typeof t?this._setObject(t):"function"==typeof e&&"clipTo"!==t?this._set(t,e(this.get(t))):this._set(t,e),this},_set:function(t,i){var s="scaleX"===t||"scaleY"===t;return s&&(i=this._constrainScale(i)),"scaleX"===t&&0>i?(this.flipX=!this.flipX,i*=-1):"scaleY"===t&&0>i?(this.flipY=!this.flipY,i*=-1):"width"===t||"height"===t?this.minScaleLimit=r(Math.min(.1,1/Math.max(this.width,this.height)),2):"shadow"!==t||!i||i instanceof e.Shadow||(i=new e.Shadow(i)),this[t]=i,this},toggle:function(t){var e=this.get(t);return"boolean"==typeof e&&this.set(t,!e),this},setSourcePath:function(t){return this.sourcePath=t,this},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:[1,0,0,1,0,0]},render:function(t,i){0===this.width&&0===this.height||!this.visible||(t.save(),this._setupCompositeOperation(t),i||this.transform(t),this._setStrokeStyles(t),this._setFillStyles(t),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this._setOpacity(t),this._setShadow(t),this.clipTo&&e.util.clipContext(this,t),this._render(t,i),this.clipTo&&t.restore(),t.restore())},_setOpacity:function(t){this.group&&this.group._setOpacity(t),t.globalAlpha*=this.opacity},_setStrokeStyles:function(t){this.stroke&&(t.lineWidth=this.strokeWidth,t.lineCap=this.strokeLineCap,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,t.strokeStyle=this.stroke.toLive?this.stroke.toLive(t,this):this.stroke)},_setFillStyles:function(t){this.fill&&(t.fillStyle=this.fill.toLive?this.fill.toLive(t,this):this.fill)},_renderControls:function(t,i){if(this.active&&!i){var r=this.getViewportTransform();t.save();var s;this.group&&(s=e.util.transformPoint(this.group.getCenterPoint(),r),t.translate(s.x,s.y),t.rotate(n(this.group.angle))),s=e.util.transformPoint(this.getCenterPoint(),r,null!=this.group),this.group&&(s.x*=this.group.scaleX,s.y*=this.group.scaleY),t.translate(s.x,s.y),t.rotate(n(this.angle)),this.drawBorders(t),this.drawControls(t),t.restore()}},_setShadow:function(t){if(this.shadow){var e=this.canvas&&this.canvas.viewportTransform[0]||1,i=this.canvas&&this.canvas.viewportTransform[3]||1;t.shadowColor=this.shadow.color,t.shadowBlur=this.shadow.blur*(e+i)*(this.scaleX+this.scaleY)/4,t.shadowOffsetX=this.shadow.offsetX*e*this.scaleX,t.shadowOffsetY=this.shadow.offsetY*i*this.scaleY}},_removeShadow:function(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)},_renderFill:function(t){if(this.fill){if(t.save(),this.fill.gradientTransform){var e=this.fill.gradientTransform;t.transform.apply(t,e)}this.fill.toLive&&t.translate(-this.width/2+this.fill.offsetX||0,-this.height/2+this.fill.offsetY||0),"evenodd"===this.fillRule?t.fill("evenodd"):t.fill(),t.restore()}},_renderStroke:function(t){if(this.stroke&&0!==this.strokeWidth){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeDashArray)1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),o?(t.setLineDash(this.strokeDashArray),this._stroke&&this._stroke(t)):this._renderDashedStroke&&this._renderDashedStroke(t),t.stroke();else{if(this.stroke.gradientTransform){var e=this.stroke.gradientTransform;t.transform.apply(t,e)}this._stroke?this._stroke(t):t.stroke()}t.restore()}},clone:function(t,i){return this.constructor.fromObject?this.constructor.fromObject(this.toObject(i),t):new e.Object(this.toObject(i))},cloneAsImage:function(t){var i=this.toDataURL();return e.util.loadImage(i,function(i){t&&t(new e.Image(i))}),this},toDataURL:function(t){t||(t={});var i=e.util.createCanvasElement(),r=this.getBoundingRect();i.width=r.width,i.height=r.height,e.util.wrapElement(i,"div");var s=new e.StaticCanvas(i);"jpg"===t.format&&(t.format="jpeg"),"jpeg"===t.format&&(s.backgroundColor="#fff");var n={active:this.get("active"),left:this.getLeft(),top:this.getTop()};this.set("active",!1),this.setPositionByOrigin(new e.Point(i.width/2,i.height/2),"center","center");var o=this.canvas;s.add(this);var a=s.toDataURL(t);return this.set(n).setCoords(),this.canvas=o,s.dispose(),s=null,a},isType:function(t){return this.type===t},complexity:function(){return 0},toJSON:function(t){return this.toObject(t)},setGradient:function(t,i){i||(i={});var r={colorStops:[]};r.type=i.type||(i.r1||i.r2?"radial":"linear"),r.coords={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},(i.r1||i.r2)&&(r.coords.r1=i.r1,r.coords.r2=i.r2);for(var s in i.colorStops){var n=new e.Color(i.colorStops[s]);r.colorStops.push({offset:s,color:n.toRgb(),opacity:n.getAlpha()})}return this.set(t,e.Gradient.forObject(this,r))},setPatternFill:function(t){return this.set("fill",new e.Pattern(t))},setShadow:function(t){return this.set("shadow",t?new e.Shadow(t):null)},setColor:function(t){return this.set("fill",t),this},setAngle:function(t){var e=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return e&&this._setOriginToCenter(),this.set("angle",t),e&&this._resetOrigin(),this},centerH:function(){return this.canvas.centerObjectH(this),this},centerV:function(){return this.canvas.centerObjectV(this),this},center:function(){return this.canvas.centerObject(this),this},remove:function(){return this.canvas.remove(this),this},getLocalPointer:function(t,e){e=e||this.canvas.getPointer(t);var i=this.translateToOriginPoint(this.getCenterPoint(),"left","top");return{x:e.x-i.x,y:e.y-i.y}},_setupCompositeOperation:function(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)}}),e.util.createAccessors(e.Object),e.Object.prototype.rotate=e.Object.prototype.setAngle,i(e.Object.prototype,e.Observable),e.Object.NUM_FRACTION_DIGITS=2,e.Object.__uid=0)}("undefined"!=typeof exports?exports:this),function(){var t=fabric.util.degreesToRadians;fabric.util.object.extend(fabric.Object.prototype,{translateToCenterPoint:function(e,i,r){var s=e.x,n=e.y;return"left"===i?s=e.x+(this.getWidth()+this.strokeWidth*this.scaleX)/2:"right"===i&&(s=e.x-(this.getWidth()+this.strokeWidth*this.scaleX)/2),"top"===r?n=e.y+(this.getHeight()+this.strokeWidth*this.scaleY)/2:"bottom"===r&&(n=e.y-(this.getHeight()+this.strokeWidth*this.scaleY)/2),fabric.util.rotatePoint(new fabric.Point(s,n),e,t(this.angle))},translateToOriginPoint:function(e,i,r){var s=e.x,n=e.y;return"left"===i?s=e.x-(this.getWidth()+this.strokeWidth*this.scaleX)/2:"right"===i&&(s=e.x+(this.getWidth()+this.strokeWidth*this.scaleX)/2),"top"===r?n=e.y-(this.getHeight()+this.strokeWidth*this.scaleY)/2:"bottom"===r&&(n=e.y+(this.getHeight()+this.strokeWidth*this.scaleY)/2),fabric.util.rotatePoint(new fabric.Point(s,n),e,t(this.angle))},getCenterPoint:function(){var t=new fabric.Point(this.left,this.top);return this.translateToCenterPoint(t,this.originX,this.originY)},getPointByOrigin:function(t,e){var i=this.getCenterPoint();return this.translateToOriginPoint(i,t,e)},toLocalPoint:function(e,i,r){var s,n,o=this.getCenterPoint();return i&&r?(s="left"===i?o.x-(this.getWidth()+this.strokeWidth*this.scaleX)/2:"right"===i?o.x+(this.getWidth()+this.strokeWidth*this.scaleX)/2:o.x,n="top"===r?o.y-(this.getHeight()+this.strokeWidth*this.scaleY)/2:"bottom"===r?o.y+(this.getHeight()+this.strokeWidth*this.scaleY)/2:o.y):(s=this.left,n=this.top),fabric.util.rotatePoint(new fabric.Point(e.x,e.y),o,-t(this.angle)).subtractEquals(new fabric.Point(s,n))},setPositionByOrigin:function(t,e,i){var r=this.translateToCenterPoint(t,e,i),s=this.translateToOriginPoint(r,this.originX,this.originY);this.set("left",s.x),this.set("top",s.y)},adjustPosition:function(e){var i=t(this.angle),r=this.getWidth()/2,s=Math.cos(i)*r,n=Math.sin(i)*r,o=this.getWidth(),a=Math.cos(i)*o,h=Math.sin(i)*o;"center"===this.originX&&"left"===e||"right"===this.originX&&"center"===e?(this.left-=s,this.top-=n):"left"===this.originX&&"center"===e||"center"===this.originX&&"right"===e?(this.left+=s,this.top+=n):"left"===this.originX&&"right"===e?(this.left+=a,this.top+=h):"right"===this.originX&&"left"===e&&(this.left-=a,this.top-=h),this.setCoords(),this.originX=e},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var t=this.getCenterPoint();this.originX="center",this.originY="center",this.left=t.x,this.top=t.y},_resetOrigin:function(){var t=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=t.x,this.top=t.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){var t=fabric.util.degreesToRadians;fabric.util.object.extend(fabric.Object.prototype,{oCoords:null,intersectsWithRect:function(t,e){var i=this.oCoords,r=new fabric.Point(i.tl.x,i.tl.y),s=new fabric.Point(i.tr.x,i.tr.y),n=new fabric.Point(i.bl.x,i.bl.y),o=new fabric.Point(i.br.x,i.br.y),a=fabric.Intersection.intersectPolygonRectangle([r,s,o,n],t,e);return"Intersection"===a.status},intersectsWithObject:function(t){function e(t){return{tl:new fabric.Point(t.tl.x,t.tl.y),tr:new fabric.Point(t.tr.x,t.tr.y),bl:new fabric.Point(t.bl.x,t.bl.y),br:new fabric.Point(t.br.x,t.br.y)}}var i=e(this.oCoords),r=e(t.oCoords),s=fabric.Intersection.intersectPolygonPolygon([i.tl,i.tr,i.br,i.bl],[r.tl,r.tr,r.br,r.bl]);return"Intersection"===s.status},isContainedWithinObject:function(t){var e=t.getBoundingRect(),i=new fabric.Point(e.left,e.top),r=new fabric.Point(e.left+e.width,e.top+e.height);return this.isContainedWithinRect(i,r)},isContainedWithinRect:function(t,e){var i=this.getBoundingRect();return i.left>=t.x&&i.left+i.width<=e.x&&i.top>=t.y&&i.top+i.height<=e.y},containsPoint:function(t){var e=this._getImageLines(this.oCoords),i=this._findCrossPoints(t,e);return 0!==i&&i%2===1},_getImageLines:function(t){return{topline:{o:t.tl,d:t.tr},rightline:{o:t.tr,d:t.br},bottomline:{o:t.br,d:t.bl},leftline:{o:t.bl,d:t.tl}}},_findCrossPoints:function(t,e){var i,r,s,n,o,a,h,c=0;for(var l in e)if(h=e[l],!(h.o.y<t.y&&h.d.y<t.y||h.o.y>=t.y&&h.d.y>=t.y||(h.o.x===h.d.x&&h.o.x>=t.x?(o=h.o.x,a=t.y):(i=0,r=(h.d.y-h.o.y)/(h.d.x-h.o.x),s=t.y-i*t.x,n=h.o.y-r*h.o.x,o=-(s-n)/(i-r),a=s+i*o),o>=t.x&&(c+=1),2!==c)))break;return c},getBoundingRectWidth:function(){return this.getBoundingRect().width},getBoundingRectHeight:function(){return this.getBoundingRect().height},getBoundingRect:function(){this.oCoords||this.setCoords();var t=[this.oCoords.tl.x,this.oCoords.tr.x,this.oCoords.br.x,this.oCoords.bl.x],e=fabric.util.array.min(t),i=fabric.util.array.max(t),r=Math.abs(e-i),s=[this.oCoords.tl.y,this.oCoords.tr.y,this.oCoords.br.y,this.oCoords.bl.y],n=fabric.util.array.min(s),o=fabric.util.array.max(s),a=Math.abs(n-o);return{left:e,top:n,width:r,height:a}},getWidth:function(){return this.width*this.scaleX},getHeight:function(){return this.height*this.scaleY},_constrainScale:function(t){return Math.abs(t)<this.minScaleLimit?0>t?-this.minScaleLimit:this.minScaleLimit:t},scale:function(t){return t=this._constrainScale(t),0>t&&(this.flipX=!this.flipX,this.flipY=!this.flipY,t*=-1),this.scaleX=t,this.scaleY=t,this.setCoords(),this},scaleToWidth:function(t){var e=this.getBoundingRectWidth()/this.getWidth();return this.scale(t/this.width/e)},scaleToHeight:function(t){var e=this.getBoundingRectHeight()/this.getHeight();return this.scale(t/this.height/e)},setCoords:function(){var e=t(this.angle),i=this.getViewportTransform(),r=function(t){return fabric.util.transformPoint(t,i)},s=this._calculateCurrentDimensions(!1),n=s.x,o=s.y;0>n&&(n=Math.abs(n));var a=Math.sqrt(Math.pow(n/2,2)+Math.pow(o/2,2)),h=Math.atan(isFinite(o/n)?o/n:0),c=Math.cos(h+e)*a,l=Math.sin(h+e)*a,u=Math.sin(e),f=Math.cos(e),d=this.getCenterPoint(),g=new fabric.Point(n,o),p=new fabric.Point(d.x-c,d.y-l),v=new fabric.Point(p.x+g.x*f,p.y+g.x*u),b=r(new fabric.Point(p.x-g.y*u,p.y+g.y*f)),m=r(new fabric.Point(v.x-g.y*u,v.y+g.y*f)),y=r(p),_=r(v),x=new fabric.Point((y.x+b.x)/2,(y.y+b.y)/2),C=new fabric.Point((_.x+y.x)/2,(_.y+y.y)/2),S=new fabric.Point((m.x+_.x)/2,(m.y+_.y)/2),w=new fabric.Point((m.x+b.x)/2,(m.y+b.y)/2),O=new fabric.Point(C.x+u*this.rotatingPointOffset,C.y-f*this.rotatingPointOffset);return this.oCoords={tl:y,tr:_,br:m,bl:b,ml:x,mt:C,mr:S,mb:w,mtr:O},this._setCornerCoords&&this._setCornerCoords(),this}})}(),fabric.util.object.extend(fabric.Object.prototype,{sendToBack:function(){return this.group?fabric.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?fabric.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas.bringToFront(this),this},sendBackwards:function(t){return this.group?fabric.StaticCanvas.prototype.sendBackwards.call(this.group,this,t):this.canvas.sendBackwards(this,t),this},bringForward:function(t){return this.group?fabric.StaticCanvas.prototype.bringForward.call(this.group,this,t):this.canvas.bringForward(this,t),this},moveTo:function(t){return this.group?fabric.StaticCanvas.prototype.moveTo.call(this.group,this,t):this.canvas.moveTo(this,t),this}}),fabric.util.object.extend(fabric.Object.prototype,{getSvgStyles:function(){var t=this.fill?this.fill.toLive?"url(#SVGID_"+this.fill.id+")":this.fill:"none",e=this.fillRule,i=this.stroke?this.stroke.toLive?"url(#SVGID_"+this.stroke.id+")":this.stroke:"none",r=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):"",n=this.strokeLineCap?this.strokeLineCap:"butt",o=this.strokeLineJoin?this.strokeLineJoin:"miter",a=this.strokeMiterLimit?this.strokeMiterLimit:"4",h="undefined"!=typeof this.opacity?this.opacity:"1",c=this.visible?"":" visibility: hidden;",l=this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":"";return["stroke: ",i,"; ","stroke-width: ",r,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",n,"; ","stroke-linejoin: ",o,"; ","stroke-miterlimit: ",a,"; ","fill: ",t,"; ","fill-rule: ",e,"; ","opacity: ",h,";",l,c].join("")},getSvgTransform:function(){if(this.group&&"path-group"===this.group.type)return"";var t=fabric.util.toFixed,e=this.getAngle(),i=!this.canvas||this.canvas.svgViewportTransformation?this.getViewportTransform():[1,0,0,1,0,0],r=fabric.util.transformPoint(this.getCenterPoint(),i),s=fabric.Object.NUM_FRACTION_DIGITS,n="path-group"===this.type?"":"translate("+t(r.x,s)+" "+t(r.y,s)+")",o=0!==e?" rotate("+t(e,s)+")":"",a=1===this.scaleX&&1===this.scaleY&&1===i[0]&&1===i[3]?"":" scale("+t(this.scaleX*i[0],s)+" "+t(this.scaleY*i[3],s)+")",h="path-group"===this.type?this.width*i[0]:0,c=this.flipX?" matrix(-1 0 0 1 "+h+" 0) ":"",l="path-group"===this.type?this.height*i[3]:0,u=this.flipY?" matrix(1 0 0 -1 0 "+l+")":"";return[n,o,a,c,u].join("")},getSvgTransformMatrix:function(){return this.transformMatrix?" matrix("+this.transformMatrix.join(" ")+") ":""},_createBaseSVGMarkup:function(){var t=[];return this.fill&&this.fill.toLive&&t.push(this.fill.toSVG(this,!1)),this.stroke&&this.stroke.toLive&&t.push(this.stroke.toSVG(this,!1)),this.shadow&&t.push(this.shadow.toSVG(this)),t}}),fabric.util.object.extend(fabric.Object.prototype,{hasStateChanged:function(){return this.stateProperties.some(function(t){return this.get(t)!==this.originalState[t]},this)},saveState:function(t){return this.stateProperties.forEach(function(t){this.originalState[t]=this.get(t)},this),t&&t.stateProperties&&t.stateProperties.forEach(function(t){this.originalState[t]=this.get(t)},this),this},setupState:function(){return this.originalState={},this.saveState(),this}}),function(){var t=fabric.util.degreesToRadians,e=function(){return"undefined"!=typeof G_vmlCanvasManager};fabric.util.object.extend(fabric.Object.prototype,{_controlsVisibility:null,_findTargetCorner:function(t){if(!this.hasControls||!this.active)return!1;var e,i,r=t.x,s=t.y;for(var n in this.oCoords)if(this.isControlVisible(n)&&("mtr"!==n||this.hasRotatingPoint)&&(!this.get("lockUniScaling")||"mt"!==n&&"mr"!==n&&"mb"!==n&&"ml"!==n)&&(i=this._getImageLines(this.oCoords[n].corner),e=this._findCrossPoints({x:r,y:s},i),0!==e&&e%2===1))return this.__corner=n,n;return!1},_setCornerCoords:function(){var e,i,r=this.oCoords,s=t(45-this.angle),n=Math.sqrt(2*Math.pow(this.cornerSize,2))/2,o=n*Math.cos(s),a=n*Math.sin(s);for(var h in r)e=r[h].x,i=r[h].y,r[h].corner={tl:{x:e-a,y:i-o},tr:{x:e+o,y:i-a},bl:{x:e-o,y:i+a},br:{x:e+a,y:i+o}}},_calculateCurrentDimensions:function(t){var e=this.getViewportTransform(),i=this.strokeWidth,r=this.width,s=this.height,n="round"===this.strokeLineCap||"square"===this.strokeLineCap,o="line"===this.type&&0===this.width,a="line"===this.type&&0===this.height,h=o||a,c=n&&a||!h,l=n&&o||!h;return o?r=i:a&&(s=i),c&&(r+=0>r?-i:i),l&&(s+=0>s?-i:i),r=r*this.scaleX+2*this.padding,s=s*this.scaleY+2*this.padding,t?fabric.util.transformPoint(new fabric.Point(r,s),e,!0):{x:r,y:s}},drawBorders:function(t){if(!this.hasBorders)return this;t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,t.strokeStyle=this.borderColor,t.lineWidth=1/this.borderScaleFactor;var e=this._calculateCurrentDimensions(!0),i=e.x,r=e.y;if(this.group&&(i*=this.group.scaleX,r*=this.group.scaleY),t.strokeRect(~~-(i/2)-.5,~~-(r/2)-.5,~~i+1,~~r+1),this.hasRotatingPoint&&this.isControlVisible("mtr")&&!this.get("lockRotation")&&this.hasControls){var s=-r/2;t.beginPath(),t.moveTo(0,s),t.lineTo(0,s-this.rotatingPointOffset),t.closePath(),t.stroke()}return t.restore(),this},drawControls:function(t){if(!this.hasControls)return this;var e=this._calculateCurrentDimensions(!0),i=e.x,r=e.y,s=-(i/2),n=-(r/2),o=this.cornerSize/2,a=this.transparentCorners?"strokeRect":"fillRect";return t.save(),t.lineWidth=1,t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,t.strokeStyle=t.fillStyle=this.cornerColor,this._drawControl("tl",t,a,s-o,n-o),this._drawControl("tr",t,a,s+i-o,n-o),this._drawControl("bl",t,a,s-o,n+r-o),this._drawControl("br",t,a,s+i-o,n+r-o),this.get("lockUniScaling")||(this._drawControl("mt",t,a,s+i/2-o,n-o),this._drawControl("mb",t,a,s+i/2-o,n+r-o),this._drawControl("mr",t,a,s+i-o,n+r/2-o),this._drawControl("ml",t,a,s-o,n+r/2-o)),this.hasRotatingPoint&&this._drawControl("mtr",t,a,s+i/2-o,n-this.rotatingPointOffset-o),t.restore(),this},_drawControl:function(t,i,r,s,n){if(this.isControlVisible(t)){var o=this.cornerSize;e()||this.transparentCorners||i.clearRect(s,n,o,o),i[r](s,n,o,o)}},isControlVisible:function(t){return this._getControlsVisibility()[t]},setControlVisible:function(t,e){return this._getControlsVisibility()[t]=e,this},setControlsVisibility:function(t){t||(t={});for(var e in t)this.setControlVisible(e,t[e]);return this},_getControlsVisibility:function(){return this._controlsVisibility||(this._controlsVisibility={tl:!0,tr:!0,br:!0,bl:!0,ml:!0,mt:!0,mr:!0,mb:!0,mtr:!0}),this._controlsVisibility}})}(),fabric.util.object.extend(fabric.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(t,e){e=e||{};var i=function(){},r=e.onComplete||i,s=e.onChange||i,n=this;return fabric.util.animate({startValue:t.get("left"),endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(e){t.set("left",e),n.renderAll(),s()},onComplete:function(){t.setCoords(),r()}}),this},fxCenterObjectV:function(t,e){e=e||{};var i=function(){},r=e.onComplete||i,s=e.onChange||i,n=this;return fabric.util.animate({startValue:t.get("top"),endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(e){t.set("top",e),n.renderAll(),s()},onComplete:function(){t.setCoords(),r()}}),this},fxRemove:function(t,e){e=e||{};var i=function(){},r=e.onComplete||i,s=e.onChange||i,n=this;return fabric.util.animate({startValue:t.get("opacity"),endValue:0,duration:this.FX_DURATION,onStart:function(){t.set("active",!1)},onChange:function(e){t.set("opacity",e),n.renderAll(),s()},onComplete:function(){n.remove(t),r()}}),this}}),fabric.util.object.extend(fabric.Object.prototype,{animate:function(){if(arguments[0]&&"object"==typeof arguments[0]){var t,e,i=[];for(t in arguments[0])i.push(t);for(var r=0,s=i.length;s>r;r++)t=i[r],e=r!==s-1,this._animate(t,arguments[0][t],arguments[1],e)}else this._animate.apply(this,arguments);return this},_animate:function(t,e,i,r){var s,n=this;e=e.toString(),i=i?fabric.util.object.clone(i):{},~t.indexOf(".")&&(s=t.split("."));var o=s?this.get(s[0])[s[1]]:this.get(t);"from"in i||(i.from=o),e=~e.indexOf("=")?o+parseFloat(e.replace("=","")):parseFloat(e),fabric.util.animate({startValue:i.from,endValue:e,byValue:i.by,easing:i.easing,duration:i.duration,abort:i.abort&&function(){return i.abort.call(n)},onChange:function(e){s?n[s[0]][s[1]]=e:n.set(t,e),r||i.onChange&&i.onChange()},onComplete:function(){r||(n.setCoords(),i.onComplete&&i.onComplete())}})}}),function(t){"use strict";function e(t,e){var i=t.origin,r=t.axis1,s=t.axis2,n=t.dimension,o=e.nearest,a=e.center,h=e.farthest;return function(){switch(this.get(i)){case o:return Math.min(this.get(r),this.get(s));case a:return Math.min(this.get(r),this.get(s))+.5*this.get(n);case h:return Math.max(this.get(r),this.get(s));

}}}var i=t.fabric||(t.fabric={}),r=i.util.object.extend,s={x1:1,x2:1,y1:1,y2:1},n=i.StaticCanvas.supports("setLineDash");return i.Line?void i.warn("fabric.Line is already defined"):(i.Line=i.util.createClass(i.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,initialize:function(t,e){e=e||{},t||(t=[0,0,0,0]),this.callSuper("initialize",e),this.set("x1",t[0]),this.set("y1",t[1]),this.set("x2",t[2]),this.set("y2",t[3]),this._setWidthHeight(e)},_setWidthHeight:function(t){t||(t={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in t?t.left:this._getLeftToOriginX(),this.top="top"in t?t.top:this._getTopToOriginY()},_set:function(t,e){return this.callSuper("_set",t,e),"undefined"!=typeof s[t]&&this._setWidthHeight(),this},_getLeftToOriginX:e({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:e({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(t,e){if(t.beginPath(),e){var i=this.getCenterPoint();t.translate(i.x-this.strokeWidth/2,i.y-this.strokeWidth/2)}if(!this.strokeDashArray||this.strokeDashArray&&n){var r=this.calcLinePoints();t.moveTo(r.x1,r.y1),t.lineTo(r.x2,r.y2)}t.lineWidth=this.strokeWidth;var s=t.strokeStyle;t.strokeStyle=this.stroke||t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=s},_renderDashedStroke:function(t){var e=this.calcLinePoints();t.beginPath(),i.util.drawDashedLine(t,e.x1,e.y1,e.x2,e.y2,this.strokeDashArray),t.closePath()},toObject:function(t){return r(this.callSuper("toObject",t),this.calcLinePoints())},calcLinePoints:function(){var t=this.x1<=this.x2?-1:1,e=this.y1<=this.y2?-1:1,i=t*this.width*.5,r=e*this.height*.5,s=t*this.width*-.5,n=e*this.height*-.5;return{x1:i,x2:s,y1:r,y2:n}},toSVG:function(t){var e=this._createBaseSVGMarkup(),i={x1:this.x1,x2:this.x2,y1:this.y1,y2:this.y2};return this.group&&"path-group"===this.group.type||(i=this.calcLinePoints()),e.push("<line ",'x1="',i.x1,'" y1="',i.y1,'" x2="',i.x2,'" y2="',i.y2,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),t?t(e.join("")):e.join("")},complexity:function(){return 1}}),i.Line.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),i.Line.fromElement=function(t,e){var s=i.parseAttributes(t,i.Line.ATTRIBUTE_NAMES),n=[s.x1||0,s.y1||0,s.x2||0,s.y2||0];return new i.Line(n,r(s,e))},void(i.Line.fromObject=function(t){var e=[t.x1,t.y1,t.x2,t.y2];return new i.Line(e,t)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";function e(t){return"radius"in t&&t.radius>=0}var i=t.fabric||(t.fabric={}),r=Math.PI,s=i.util.object.extend;return i.Circle?void i.warn("fabric.Circle is already defined."):(i.Circle=i.util.createClass(i.Object,{type:"circle",radius:0,startAngle:0,endAngle:2*r,initialize:function(t){t=t||{},this.callSuper("initialize",t),this.set("radius",t.radius||0),this.startAngle=t.startAngle||this.startAngle,this.endAngle=t.endAngle||this.endAngle},_set:function(t,e){return this.callSuper("_set",t,e),"radius"===t&&this.setRadius(e),this},toObject:function(t){return s(this.callSuper("toObject",t),{radius:this.get("radius"),startAngle:this.startAngle,endAngle:this.endAngle})},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=0,s=0,n=(this.endAngle-this.startAngle)%(2*r);if(0===n)this.group&&"path-group"===this.group.type&&(i=this.left+this.radius,s=this.top+this.radius),e.push("<circle ",'cx="'+i+'" cy="'+s+'" ','r="',this.radius,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n');else{var o=Math.cos(this.startAngle)*this.radius,a=Math.sin(this.startAngle)*this.radius,h=Math.cos(this.endAngle)*this.radius,c=Math.sin(this.endAngle)*this.radius,l=n>r?"1":"0";e.push('<path d="M '+o+" "+a," A "+this.radius+" "+this.radius," 0 ",+l+" 1"," "+h+" "+c,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n')}return t?t(e.join("")):e.join("")},_render:function(t,e){t.beginPath(),t.arc(e?this.left+this.radius:0,e?this.top+this.radius:0,this.radius,this.startAngle,this.endAngle,!1),this._renderFill(t),this._renderStroke(t)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(t){this.radius=t,this.set("width",2*t).set("height",2*t)},complexity:function(){return 1}}),i.Circle.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),i.Circle.fromElement=function(t,r){r||(r={});var n=i.parseAttributes(t,i.Circle.ATTRIBUTE_NAMES);if(!e(n))throw new Error("value of `r` attribute is required and can not be negative");n.left=n.left||0,n.top=n.top||0;var o=new i.Circle(s(n,r));return o.left-=o.radius,o.top-=o.radius,o},void(i.Circle.fromObject=function(t){return new i.Circle(t)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});return e.Triangle?void e.warn("fabric.Triangle is already defined"):(e.Triangle=e.util.createClass(e.Object,{type:"triangle",initialize:function(t){t=t||{},this.callSuper("initialize",t),this.set("width",t.width||100).set("height",t.height||100)},_render:function(t){var e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,i),t.lineTo(0,-i),t.lineTo(e,i),t.closePath(),this._renderFill(t),this._renderStroke(t)},_renderDashedStroke:function(t){var i=this.width/2,r=this.height/2;t.beginPath(),e.util.drawDashedLine(t,-i,r,0,-r,this.strokeDashArray),e.util.drawDashedLine(t,0,-r,i,r,this.strokeDashArray),e.util.drawDashedLine(t,i,r,-i,r,this.strokeDashArray),t.closePath()},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this.width/2,r=this.height/2,s=[-i+" "+r,"0 "+-r,i+" "+r].join(",");return e.push("<polygon ",'points="',s,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>'),t?t(e.join("")):e.join("")},complexity:function(){return 1}}),void(e.Triangle.fromObject=function(t){return new e.Triangle(t)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=2*Math.PI,r=e.util.object.extend;return e.Ellipse?void e.warn("fabric.Ellipse is already defined."):(e.Ellipse=e.util.createClass(e.Object,{type:"ellipse",rx:0,ry:0,initialize:function(t){t=t||{},this.callSuper("initialize",t),this.set("rx",t.rx||0),this.set("ry",t.ry||0)},_set:function(t,e){switch(this.callSuper("_set",t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(t){return r(this.callSuper("toObject",t),{rx:this.get("rx"),ry:this.get("ry")})},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=0,r=0;return this.group&&"path-group"===this.group.type&&(i=this.left+this.rx,r=this.top+this.ry),e.push("<ellipse ",'cx="',i,'" cy="',r,'" ','rx="',this.rx,'" ry="',this.ry,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),t?t(e.join("")):e.join("")},_render:function(t,e){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(e?this.left+this.rx:0,e?(this.top+this.ry)*this.rx/this.ry:0,this.rx,0,i,!1),t.restore(),this._renderFill(t),this._renderStroke(t)},complexity:function(){return 1}}),e.Ellipse.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),e.Ellipse.fromElement=function(t,i){i||(i={});var s=e.parseAttributes(t,e.Ellipse.ATTRIBUTE_NAMES);s.left=s.left||0,s.top=s.top||0;var n=new e.Ellipse(r(s,i));return n.top-=n.ry,n.left-=n.rx,n},void(e.Ellipse.fromObject=function(t){return new e.Ellipse(t)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;if(e.Rect)return void console.warn("fabric.Rect is already defined");var r=e.Object.prototype.stateProperties.concat();r.push("rx","ry","x","y"),e.Rect=e.util.createClass(e.Object,{stateProperties:r,type:"rect",rx:0,ry:0,strokeDashArray:null,initialize:function(t){t=t||{},this.callSuper("initialize",t),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(t,e){if(1===this.width&&1===this.height)return void t.fillRect(0,0,1,1);var i=this.rx?Math.min(this.rx,this.width/2):0,r=this.ry?Math.min(this.ry,this.height/2):0,s=this.width,n=this.height,o=e?this.left:-this.width/2,a=e?this.top:-this.height/2,h=0!==i||0!==r,c=.4477152502;t.beginPath(),t.moveTo(o+i,a),t.lineTo(o+s-i,a),h&&t.bezierCurveTo(o+s-c*i,a,o+s,a+c*r,o+s,a+r),t.lineTo(o+s,a+n-r),h&&t.bezierCurveTo(o+s,a+n-c*r,o+s-c*i,a+n,o+s-i,a+n),t.lineTo(o+i,a+n),h&&t.bezierCurveTo(o+c*i,a+n,o,a+n-c*r,o,a+n-r),t.lineTo(o,a+r),h&&t.bezierCurveTo(o,a+c*r,o+c*i,a,o+i,a),t.closePath(),this._renderFill(t),this._renderStroke(t)},_renderDashedStroke:function(t){var i=-this.width/2,r=-this.height/2,s=this.width,n=this.height;t.beginPath(),e.util.drawDashedLine(t,i,r,i+s,r,this.strokeDashArray),e.util.drawDashedLine(t,i+s,r,i+s,r+n,this.strokeDashArray),e.util.drawDashedLine(t,i+s,r+n,i,r+n,this.strokeDashArray),e.util.drawDashedLine(t,i,r+n,i,r,this.strokeDashArray),t.closePath()},toObject:function(t){var e=i(this.callSuper("toObject",t),{rx:this.get("rx")||0,ry:this.get("ry")||0});return this.includeDefaultValues||this._removeDefaultValues(e),e},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this.left,r=this.top;return this.group&&"path-group"===this.group.type||(i=-this.width/2,r=-this.height/2),e.push("<rect ",'x="',i,'" y="',r,'" rx="',this.get("rx"),'" ry="',this.get("ry"),'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),t?t(e.join("")):e.join("")},complexity:function(){return 1}}),e.Rect.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),e.Rect.fromElement=function(t,r){if(!t)return null;r=r||{};var s=e.parseAttributes(t,e.Rect.ATTRIBUTE_NAMES);s.left=s.left||0,s.top=s.top||0;var n=new e.Rect(i(r?e.util.object.clone(r):{},s));return n.visible=n.width>0&&n.height>0,n},e.Rect.fromObject=function(t){return new e.Rect(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});return e.Polyline?void e.warn("fabric.Polyline is already defined"):(e.Polyline=e.util.createClass(e.Object,{type:"polyline",points:null,minX:0,minY:0,initialize:function(t,i){return e.Polygon.prototype.initialize.call(this,t,i)},_calcDimensions:function(){return e.Polygon.prototype._calcDimensions.call(this)},_applyPointOffset:function(){return e.Polygon.prototype._applyPointOffset.call(this)},toObject:function(t){return e.Polygon.prototype.toObject.call(this,t)},toSVG:function(t){return e.Polygon.prototype.toSVG.call(this,t)},_render:function(t){e.Polygon.prototype.commonRender.call(this,t)&&(this._renderFill(t),this._renderStroke(t))},_renderDashedStroke:function(t){var i,r;t.beginPath();for(var s=0,n=this.points.length;n>s;s++)i=this.points[s],r=this.points[s+1]||i,e.util.drawDashedLine(t,i.x,i.y,r.x,r.y,this.strokeDashArray)},complexity:function(){return this.get("points").length}}),e.Polyline.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polyline.fromElement=function(t,i){if(!t)return null;i||(i={});var r=e.parsePointsAttribute(t.getAttribute("points")),s=e.parseAttributes(t,e.Polyline.ATTRIBUTE_NAMES);return new e.Polyline(r,e.util.object.extend(s,i))},void(e.Polyline.fromObject=function(t){var i=t.points;return new e.Polyline(i,t,!0)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.array.min,s=e.util.array.max,n=e.util.toFixed;return e.Polygon?void e.warn("fabric.Polygon is already defined"):(e.Polygon=e.util.createClass(e.Object,{type:"polygon",points:null,minX:0,minY:0,initialize:function(t,e){e=e||{},this.points=t||[],this.callSuper("initialize",e),this._calcDimensions(),"top"in e||(this.top=this.minY),"left"in e||(this.left=this.minX)},_calcDimensions:function(){var t=this.points,e=r(t,"x"),i=r(t,"y"),n=s(t,"x"),o=s(t,"y");this.width=n-e||0,this.height=o-i||0,this.minX=e||0,this.minY=i||0},_applyPointOffset:function(){this.points.forEach(function(t){t.x-=this.minX+this.width/2,t.y-=this.minY+this.height/2},this)},toObject:function(t){return i(this.callSuper("toObject",t),{points:this.points.concat()})},toSVG:function(t){for(var e=[],i=this._createBaseSVGMarkup(),r=0,s=this.points.length;s>r;r++)e.push(n(this.points[r].x,2),",",n(this.points[r].y,2)," ");return i.push("<",this.type," ",'points="',e.join(""),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n'),t?t(i.join("")):i.join("")},_render:function(t){this.commonRender(t)&&(this._renderFill(t),(this.stroke||this.strokeDashArray)&&(t.closePath(),this._renderStroke(t)))},commonRender:function(t){var e,i=this.points.length;if(!i||isNaN(this.points[i-1].y))return!1;t.beginPath(),this._applyPointOffset&&(this.group&&"path-group"===this.group.type||this._applyPointOffset(),this._applyPointOffset=null),t.moveTo(this.points[0].x,this.points[0].y);for(var r=0;i>r;r++)e=this.points[r],t.lineTo(e.x,e.y);return!0},_renderDashedStroke:function(t){e.Polyline.prototype._renderDashedStroke.call(this,t),t.closePath()},complexity:function(){return this.points.length}}),e.Polygon.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polygon.fromElement=function(t,r){if(!t)return null;r||(r={});var s=e.parsePointsAttribute(t.getAttribute("points")),n=e.parseAttributes(t,e.Polygon.ATTRIBUTE_NAMES);return new e.Polygon(s,i(n,r))},void(e.Polygon.fromObject=function(t){return new e.Polygon(t.points,t,!0)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.array.min,r=e.util.array.max,s=e.util.object.extend,n=Object.prototype.toString,o=e.util.drawArc,a={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},h={m:"l",M:"L"};return e.Path?void e.warn("fabric.Path is already defined"):(e.Path=e.util.createClass(e.Object,{type:"path",path:null,minX:0,minY:0,initialize:function(t,e){if(e=e||{},this.setOptions(e),!t)throw new Error("`path` argument is required");var i="[object Array]"===n.call(t);this.path=i?t:t.match&&t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi),this.path&&(i||(this.path=this._parsePath()),this._setPositionDimensions(e),e.sourcePath&&this.setSourcePath(e.sourcePath))},_setPositionDimensions:function(t){var e=this._parseDimensions();this.minX=e.left,this.minY=e.top,this.width=e.width,this.height=e.height,"undefined"==typeof t.left&&(this.left=e.left+("center"===this.originX?this.width/2:"right"===this.originX?this.width:0)),"undefined"==typeof t.top&&(this.top=e.top+("center"===this.originY?this.height/2:"bottom"===this.originY?this.height:0)),this.pathOffset=this.pathOffset||{x:this.minX+this.width/2,y:this.minY+this.height/2}},_render:function(t){var e,i,r,s=null,n=0,a=0,h=0,c=0,l=0,u=0,f=-this.pathOffset.x,d=-this.pathOffset.y;this.group&&"path-group"===this.group.type&&(f=0,d=0),t.beginPath();for(var g=0,p=this.path.length;p>g;++g){switch(e=this.path[g],e[0]){case"l":h+=e[1],c+=e[2],t.lineTo(h+f,c+d);break;case"L":h=e[1],c=e[2],t.lineTo(h+f,c+d);break;case"h":h+=e[1],t.lineTo(h+f,c+d);break;case"H":h=e[1],t.lineTo(h+f,c+d);break;case"v":c+=e[1],t.lineTo(h+f,c+d);break;case"V":c=e[1],t.lineTo(h+f,c+d);break;case"m":h+=e[1],c+=e[2],n=h,a=c,t.moveTo(h+f,c+d);break;case"M":h=e[1],c=e[2],n=h,a=c,t.moveTo(h+f,c+d);break;case"c":i=h+e[5],r=c+e[6],l=h+e[3],u=c+e[4],t.bezierCurveTo(h+e[1]+f,c+e[2]+d,l+f,u+d,i+f,r+d),h=i,c=r;break;case"C":h=e[5],c=e[6],l=e[3],u=e[4],t.bezierCurveTo(e[1]+f,e[2]+d,l+f,u+d,h+f,c+d);break;case"s":i=h+e[3],r=c+e[4],null===s[0].match(/[CcSs]/)?(l=h,u=c):(l=2*h-l,u=2*c-u),t.bezierCurveTo(l+f,u+d,h+e[1]+f,c+e[2]+d,i+f,r+d),l=h+e[1],u=c+e[2],h=i,c=r;break;case"S":i=e[3],r=e[4],null===s[0].match(/[CcSs]/)?(l=h,u=c):(l=2*h-l,u=2*c-u),t.bezierCurveTo(l+f,u+d,e[1]+f,e[2]+d,i+f,r+d),h=i,c=r,l=e[1],u=e[2];break;case"q":i=h+e[3],r=c+e[4],l=h+e[1],u=c+e[2],t.quadraticCurveTo(l+f,u+d,i+f,r+d),h=i,c=r;break;case"Q":i=e[3],r=e[4],t.quadraticCurveTo(e[1]+f,e[2]+d,i+f,r+d),h=i,c=r,l=e[1],u=e[2];break;case"t":i=h+e[1],r=c+e[2],null===s[0].match(/[QqTt]/)?(l=h,u=c):(l=2*h-l,u=2*c-u),t.quadraticCurveTo(l+f,u+d,i+f,r+d),h=i,c=r;break;case"T":i=e[1],r=e[2],null===s[0].match(/[QqTt]/)?(l=h,u=c):(l=2*h-l,u=2*c-u),t.quadraticCurveTo(l+f,u+d,i+f,r+d),h=i,c=r;break;case"a":o(t,h+f,c+d,[e[1],e[2],e[3],e[4],e[5],e[6]+h+f,e[7]+c+d]),h+=e[6],c+=e[7];break;case"A":o(t,h+f,c+d,[e[1],e[2],e[3],e[4],e[5],e[6]+f,e[7]+d]),h=e[6],c=e[7];break;case"z":case"Z":h=n,c=a,t.closePath()}s=e}this._renderFill(t),this._renderStroke(t)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(t){var e=s(this.callSuper("toObject",t),{path:this.path.map(function(t){return t.slice()}),pathOffset:this.pathOffset});return this.sourcePath&&(e.sourcePath=this.sourcePath),this.transformMatrix&&(e.transformMatrix=this.transformMatrix),e},toDatalessObject:function(t){var e=this.toObject(t);return this.sourcePath&&(e.path=this.sourcePath),delete e.sourcePath,e},toSVG:function(t){for(var e=[],i=this._createBaseSVGMarkup(),r="",s=0,n=this.path.length;n>s;s++)e.push(this.path[s].join(" "));var o=e.join(" ");return this.group&&"path-group"===this.group.type||(r=" translate("+-this.pathOffset.x+", "+-this.pathOffset.y+") "),i.push("<path ",'d="',o,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),r,this.getSvgTransformMatrix(),'" stroke-linecap="round" ',"/>\n"),t?t(i.join("")):i.join("")},complexity:function(){return this.path.length},_parsePath:function(){for(var t,e,i,r,s,n=[],o=[],c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,l=0,u=this.path.length;u>l;l++){for(t=this.path[l],r=t.slice(1).trim(),o.length=0;i=c.exec(r);)o.push(i[0]);s=[t.charAt(0)];for(var f=0,d=o.length;d>f;f++)e=parseFloat(o[f]),isNaN(e)||s.push(e);var g=s[0],p=a[g.toLowerCase()],v=h[g]||g;if(s.length-1>p)for(var b=1,m=s.length;m>b;b+=p)n.push([g].concat(s.slice(b,b+p))),g=v;else n.push(s)}return n},_parseDimensions:function(){for(var t,s,n,o,a=[],h=[],c=null,l=0,u=0,f=0,d=0,g=0,p=0,v=0,b=this.path.length;b>v;++v){switch(t=this.path[v],t[0]){case"l":f+=t[1],d+=t[2],o=[];break;case"L":f=t[1],d=t[2],o=[];break;case"h":f+=t[1],o=[];break;case"H":f=t[1],o=[];break;case"v":d+=t[1],o=[];break;case"V":d=t[1],o=[];break;case"m":f+=t[1],d+=t[2],l=f,u=d,o=[];break;case"M":f=t[1],d=t[2],l=f,u=d,o=[];break;case"c":s=f+t[5],n=d+t[6],g=f+t[3],p=d+t[4],o=e.util.getBoundsOfCurve(f,d,f+t[1],d+t[2],g,p,s,n),f=s,d=n;break;case"C":f=t[5],d=t[6],g=t[3],p=t[4],o=e.util.getBoundsOfCurve(f,d,t[1],t[2],g,p,f,d);break;case"s":s=f+t[3],n=d+t[4],null===c[0].match(/[CcSs]/)?(g=f,p=d):(g=2*f-g,p=2*d-p),o=e.util.getBoundsOfCurve(f,d,g,p,f+t[1],d+t[2],s,n),g=f+t[1],p=d+t[2],f=s,d=n;break;case"S":s=t[3],n=t[4],null===c[0].match(/[CcSs]/)?(g=f,p=d):(g=2*f-g,p=2*d-p),o=e.util.getBoundsOfCurve(f,d,g,p,t[1],t[2],s,n),f=s,d=n,g=t[1],p=t[2];break;case"q":s=f+t[3],n=d+t[4],g=f+t[1],p=d+t[2],o=e.util.getBoundsOfCurve(f,d,g,p,g,p,s,n),f=s,d=n;break;case"Q":g=t[1],p=t[2],o=e.util.getBoundsOfCurve(f,d,g,p,g,p,t[3],t[4]),f=t[3],d=t[4];break;case"t":s=f+t[1],n=d+t[2],null===c[0].match(/[QqTt]/)?(g=f,p=d):(g=2*f-g,p=2*d-p),o=e.util.getBoundsOfCurve(f,d,g,p,g,p,s,n),f=s,d=n;break;case"T":s=t[1],n=t[2],null===c[0].match(/[QqTt]/)?(g=f,p=d):(g=2*f-g,p=2*d-p),o=e.util.getBoundsOfCurve(f,d,g,p,g,p,s,n),f=s,d=n;break;case"a":o=e.util.getBoundsOfArc(f,d,t[1],t[2],t[3],t[4],t[5],t[6]+f,t[7]+d),f+=t[6],d+=t[7];break;case"A":o=e.util.getBoundsOfArc(f,d,t[1],t[2],t[3],t[4],t[5],t[6],t[7]),f=t[6],d=t[7];break;case"z":case"Z":f=l,d=u}c=t,o.forEach(function(t){a.push(t.x),h.push(t.y)}),a.push(f),h.push(d)}var m=i(a),y=i(h),_=r(a),x=r(h),C=_-m,S=x-y,w={left:m,top:y,width:C,height:S};return w}}),e.Path.fromObject=function(t,i){"string"==typeof t.path?e.loadSVGFromURL(t.path,function(r){var s=r[0],n=t.path;delete t.path,e.util.object.extend(s,t),s.setSourcePath(n),i(s)}):i(new e.Path(t.path,t))},e.Path.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(["d"]),e.Path.fromElement=function(t,i,r){var n=e.parseAttributes(t,e.Path.ATTRIBUTE_NAMES);i&&i(new e.Path(n.d,s(n,r)))},void(e.Path.async=!0))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.array.invoke,s=e.Object.prototype.toObject;return e.PathGroup?void e.warn("fabric.PathGroup is already defined"):(e.PathGroup=e.util.createClass(e.Path,{type:"path-group",fill:"",initialize:function(t,e){e=e||{},this.paths=t||[];for(var i=this.paths.length;i--;)this.paths[i].group=this;e.toBeParsed&&(this.parseDimensionsFromPaths(e),delete e.toBeParsed),this.setOptions(e),this.setCoords(),e.sourcePath&&this.setSourcePath(e.sourcePath)},parseDimensionsFromPaths:function(t){for(var i,r,s,n,o,a=[],h=[],c=this.transformMatrix,l=this.paths.length;l--;){s=this.paths[l],n=s.height+s.strokeWidth,o=s.width+s.strokeWidth,i=[{x:s.left,y:s.top},{x:s.left+o,y:s.top},{x:s.left,y:s.top+n},{x:s.left+o,y:s.top+n}];for(var u=0;u<i.length;u++)r=i[u],c&&(r=e.util.transformPoint(r,c,!1)),a.push(r.x),h.push(r.y)}t.width=Math.max.apply(null,a),t.height=Math.max.apply(null,h)},render:function(t){if(this.visible){t.save(),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this.transform(t),this._setShadow(t),this.clipTo&&e.util.clipContext(this,t),t.translate(-this.width/2,-this.height/2);for(var i=0,r=this.paths.length;r>i;++i)this.paths[i].render(t,!0);this.clipTo&&t.restore(),t.restore()}},_set:function(t,e){if("fill"===t&&e&&this.isSameColor())for(var i=this.paths.length;i--;)this.paths[i]._set(t,e);return this.callSuper("_set",t,e)},toObject:function(t){var e=i(s.call(this,t),{paths:r(this.getObjects(),"toObject",t)});return this.sourcePath&&(e.sourcePath=this.sourcePath),e},toDatalessObject:function(t){var e=this.toObject(t);return this.sourcePath&&(e.paths=this.sourcePath),e},toSVG:function(t){for(var e=this.getObjects(),i=this.getPointByOrigin("left","top"),r="translate("+i.x+" "+i.y+")",s=["<g ",'style="',this.getSvgStyles(),'" ','transform="',this.getSvgTransformMatrix(),r,this.getSvgTransform(),'" ',">\n"],n=0,o=e.length;o>n;n++)s.push(e[n].toSVG(t));return s.push("</g>\n"),t?t(s.join("")):s.join("")},toString:function(){return"#<fabric.PathGroup ("+this.complexity()+"): { top: "+this.top+", left: "+this.left+" }>"},isSameColor:function(){var t=(this.getObjects()[0].get("fill")||"").toLowerCase();return this.getObjects().every(function(e){return(e.get("fill")||"").toLowerCase()===t})},complexity:function(){return this.paths.reduce(function(t,e){return t+(e&&e.complexity?e.complexity():0)},0)},getObjects:function(){return this.paths}}),e.PathGroup.fromObject=function(t,i){"string"==typeof t.paths?e.loadSVGFromURL(t.paths,function(r){var s=t.paths;delete t.paths;var n=e.util.groupSVGElements(r,t,s);i(n)}):e.util.enlivenObjects(t.paths,function(r){delete t.paths,i(new e.PathGroup(r,t))})},void(e.PathGroup.async=!0))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.array.min,s=e.util.array.max,n=e.util.array.invoke;if(!e.Group){var o={lockMovementX:!0,lockMovementY:!0,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,lockUniScaling:!0};e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",strokeWidth:0,initialize:function(t,e){e=e||{},this._objects=t||[];for(var i=this._objects.length;i--;)this._objects[i].group=this;this.originalState={},e.originX&&(this.originX=e.originX),e.originY&&(this.originY=e.originY),this._calcBounds(),this._updateObjectsCoords(),this.callSuper("initialize",e),this.setCoords(),this.saveCoords()},_updateObjectsCoords:function(){this.forEachObject(this._updateObjectCoords,this)},_updateObjectCoords:function(t){var e=t.getLeft(),i=t.getTop(),r=this.getCenterPoint();t.set({originalLeft:e,originalTop:i,left:e-r.x,top:i-r.y}),t.setCoords(),t.__origHasControls=t.hasControls,t.hasControls=!1},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(t){return this._restoreObjectsState(),t&&(this._objects.push(t),t.group=this,t._set("canvas",this.canvas)),this.forEachObject(this._setObjectActive,this),this._calcBounds(),this._updateObjectsCoords(),this},_setObjectActive:function(t){t.set("active",!0),t.group=this},removeWithUpdate:function(t){return this._moveFlippedObject(t),this._restoreObjectsState(),this.forEachObject(this._setObjectActive,this),this.remove(t),this._calcBounds(),this._updateObjectsCoords(),this},_onObjectAdded:function(t){t.group=this,t._set("canvas",this.canvas)},_onObjectRemoved:function(t){delete t.group,t.set("active",!1)},delegatedProperties:{fill:!0,opacity:!0,fontFamily:!0,fontWeight:!0,fontSize:!0,fontStyle:!0,lineHeight:!0,textDecoration:!0,textAlign:!0,backgroundColor:!0},_set:function(t,e){if(t in this.delegatedProperties||"canvas"===t)for(var i=this._objects.length;i--;)this._objects[i].set(t,e);this.callSuper("_set",t,e)},toObject:function(t){return i(this.callSuper("toObject",t),{objects:n(this._objects,"toObject",t)})},render:function(t){if(this.visible){t.save(),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this.transform(t),this.clipTo&&e.util.clipContext(this,t);for(var i=0,r=this._objects.length;r>i;i++)this._renderObject(this._objects[i],t);this.clipTo&&t.restore(),t.restore()}},_renderControls:function(t,e){this.callSuper("_renderControls",t,e);for(var i=0,r=this._objects.length;r>i;i++)this._objects[i]._renderControls(t)},_renderObject:function(t,e){if(t.visible){var i=t.hasRotatingPoint;t.hasRotatingPoint=!1,t.render(e),t.hasRotatingPoint=i}},_restoreObjectsState:function(){return this._objects.forEach(this._restoreObjectState,this),this},realizeTransform:function(t){return this._moveFlippedObject(t),this._setObjectPosition(t),t},_moveFlippedObject:function(t){var e=t.get("originX"),i=t.get("originY"),r=t.getCenterPoint();t.set({originX:"center",originY:"center",left:r.x,top:r.y}),this._toggleFlipping(t);var s=t.getPointByOrigin(e,i);return t.set({originX:e,originY:i,left:s.x,top:s.y}),this},_toggleFlipping:function(t){this.flipX&&(t.toggle("flipX"),t.set("left",-t.get("left")),t.setAngle(-t.getAngle())),this.flipY&&(t.toggle("flipY"),t.set("top",-t.get("top")),t.setAngle(-t.getAngle()))},_restoreObjectState:function(t){return this._setObjectPosition(t),t.setCoords(),t.hasControls=t.__origHasControls,delete t.__origHasControls,t.set("active",!1),t.setCoords(),delete t.group,this},_setObjectPosition:function(t){var e=this.getCenterPoint(),i=this._getRotatedLeftTop(t);t.set({angle:t.getAngle()+this.getAngle(),left:e.x+i.left,top:e.y+i.top,scaleX:t.get("scaleX")*this.get("scaleX"),scaleY:t.get("scaleY")*this.get("scaleY")})},_getRotatedLeftTop:function(t){var e=this.getAngle()*(Math.PI/180);return{left:-Math.sin(e)*t.getTop()*this.get("scaleY")+Math.cos(e)*t.getLeft()*this.get("scaleX"),top:Math.cos(e)*t.getTop()*this.get("scaleY")+Math.sin(e)*t.getLeft()*this.get("scaleX")}},destroy:function(){return this._objects.forEach(this._moveFlippedObject,this),this._restoreObjectsState()},saveCoords:function(){return this._originalLeft=this.get("left"),this._originalTop=this.get("top"),this},hasMoved:function(){return this._originalLeft!==this.get("left")||this._originalTop!==this.get("top")},setObjectsCoords:function(){return this.forEachObject(function(t){t.setCoords()}),this},_calcBounds:function(t){for(var e,i,r=[],s=[],n=["tr","br","bl","tl"],o=0,a=this._objects.length;a>o;++o){e=this._objects[o],e.setCoords();for(var h=0;h<n.length;h++)i=n[h],r.push(e.oCoords[i].x),s.push(e.oCoords[i].y)}this.set(this._getBounds(r,s,t))},_getBounds:function(t,i,n){var o=e.util.invertTransform(this.getViewportTransform()),a=e.util.transformPoint(new e.Point(r(t),r(i)),o),h=e.util.transformPoint(new e.Point(s(t),s(i)),o),c={width:h.x-a.x||0,height:h.y-a.y||0};return n||(c.left=a.x||0,c.top=a.y||0,"center"===this.originX&&(c.left+=c.width/2),"right"===this.originX&&(c.left+=c.width),"center"===this.originY&&(c.top+=c.height/2),"bottom"===this.originY&&(c.top+=c.height)),c},toSVG:function(t){for(var e=["<g ",'transform="',this.getSvgTransform(),'">\n'],i=0,r=this._objects.length;r>i;i++)e.push(this._objects[i].toSVG(t));return e.push("</g>\n"),t?t(e.join("")):e.join("")},get:function(t){if(t in o){if(this[t])return this[t];for(var e=0,i=this._objects.length;i>e;e++)if(this._objects[e][t])return!0;return!1}return t in this.delegatedProperties?this._objects[0]&&this._objects[0].get(t):this[t]}}),e.Group.fromObject=function(t,i){e.util.enlivenObjects(t.objects,function(r){delete t.objects,i&&i(new e.Group(r,t))})},e.Group.async=!0}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=fabric.util.object.extend;return t.fabric||(t.fabric={}),t.fabric.Image?void fabric.warn("fabric.Image is already defined."):(fabric.Image=fabric.util.createClass(fabric.Object,{type:"image",crossOrigin:"",alignX:"none",alignY:"none",meetOrSlice:"meet",_lastScaleX:1,_lastScaleY:1,initialize:function(t,e){e||(e={}),this.filters=[],this.resizeFilters=[],this.callSuper("initialize",e),this._initElement(t,e)},getElement:function(){return this._element},setElement:function(t,e,i){return this._element=t,this._originalElement=t,this._initConfig(i),0!==this.filters.length?this.applyFilters(e):e&&e(),this},setCrossOrigin:function(t){return this.crossOrigin=t,this._element.crossOrigin=t,this},getOriginalSize:function(){var t=this.getElement();return{width:t.width,height:t.height}},_stroke:function(t){t.save(),this._setStrokeStyles(t),t.beginPath(),t.strokeRect(-this.width/2,-this.height/2,this.width,this.height),t.closePath(),t.restore()},_renderDashedStroke:function(t){var e=-this.width/2,i=-this.height/2,r=this.width,s=this.height;t.save(),this._setStrokeStyles(t),t.beginPath(),fabric.util.drawDashedLine(t,e,i,e+r,i,this.strokeDashArray),fabric.util.drawDashedLine(t,e+r,i,e+r,i+s,this.strokeDashArray),fabric.util.drawDashedLine(t,e+r,i+s,e,i+s,this.strokeDashArray),fabric.util.drawDashedLine(t,e,i+s,e,i,this.strokeDashArray),t.closePath(),t.restore()},toObject:function(t){var i=e(this.callSuper("toObject",t),{src:this._originalElement.src||this._originalElement._src,filters:this.filters.map(function(t){return t&&t.toObject()}),crossOrigin:this.crossOrigin,alignX:this.alignX,alignY:this.alignY,meetOrSlice:this.meetOrSlice});return this.resizeFilters.length>0&&(i.resizeFilters=this.resizeFilters.map(function(t){return t&&t.toObject()})),i},toSVG:function(t){var e=[],i=-this.width/2,r=-this.height/2,s="none";if(this.group&&"path-group"===this.group.type&&(i=this.left,r=this.top),"none"!==this.alignX&&"none"!==this.alignY&&(s="x"+this.alignX+"Y"+this.alignY+" "+this.meetOrSlice),e.push('<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n','<image xlink:href="',this.getSvgSrc(),'" x="',i,'" y="',r,'" style="',this.getSvgStyles(),'" width="',this.width,'" height="',this.height,'" preserveAspectRatio="',s,'"',"></image>\n"),this.stroke||this.strokeDashArray){var n=this.fill;this.fill=null,e.push("<rect ",'x="',i,'" y="',r,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'),this.fill=n}return e.push("</g>\n"),t?t(e.join("")):e.join("")},getSrc:function(){return this.getElement()?this.getElement().src||this.getElement()._src:void 0},setSrc:function(t,e,i){fabric.util.loadImage(t,function(t){return this.setElement(t,e,i)},this,i&&i.crossOrigin)},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},clone:function(t,e){this.constructor.fromObject(this.toObject(e),t)},applyFilters:function(t,e,i,r){if(e=e||this.filters,
i=i||this._originalElement){var s=i,n=fabric.util.createCanvasElement(),o=fabric.util.createImage(),a=this;return n.width=s.width,n.height=s.height,n.getContext("2d").drawImage(s,0,0,s.width,s.height),0===e.length?(this._element=i,t&&t(),n):(e.forEach(function(t){t&&t.applyTo(n,t.scaleX||a.scaleX,t.scaleY||a.scaleY),!r&&t&&"Resize"===t.type&&(a.width*=t.scaleX,a.height*=t.scaleY)}),o.width=n.width,o.height=n.height,fabric.isLikelyNode?(o.src=n.toBuffer(void 0,fabric.Image.pngCompression),a._element=o,!r&&(a._filteredEl=o),t&&t()):(o.onload=function(){a._element=o,!r&&(a._filteredEl=o),t&&t(),o.onload=n=s=null},o.src=n.toDataURL("image/png")),n)}},_render:function(t,e){var i,r,s,n=this._findMargins();i=e?this.left:-this.width/2,r=e?this.top:-this.height/2,"slice"===this.meetOrSlice&&(t.beginPath(),t.rect(i,r,this.width,this.height),t.clip()),this.isMoving===!1&&this.resizeFilters.length&&this._needsResize()?(this._lastScaleX=this.scaleX,this._lastScaleY=this.scaleY,s=this.applyFilters(null,this.resizeFilters,this._filteredEl||this._originalElement,!0)):s=this._element,s&&t.drawImage(s,i+n.marginX,r+n.marginY,n.width,n.height),this._renderStroke(t)},_needsResize:function(){return this.scaleX!==this._lastScaleX||this.scaleY!==this._lastScaleY},_findMargins:function(){var t,e,i=this.width,r=this.height,s=0,n=0;return("none"!==this.alignX||"none"!==this.alignY)&&(t=[this.width/this._element.width,this.height/this._element.height],e="meet"===this.meetOrSlice?Math.min.apply(null,t):Math.max.apply(null,t),i=this._element.width*e,r=this._element.height*e,"Mid"===this.alignX&&(s=(this.width-i)/2),"Max"===this.alignX&&(s=this.width-i),"Mid"===this.alignY&&(n=(this.height-r)/2),"Max"===this.alignY&&(n=this.height-r)),{width:i,height:r,marginX:s,marginY:n}},_resetWidthHeight:function(){var t=this.getElement();this.set("width",t.width),this.set("height",t.height)},_initElement:function(t){this.setElement(fabric.util.getById(t)),fabric.util.addClass(this.getElement(),fabric.Image.CSS_CANVAS)},_initConfig:function(t){t||(t={}),this.setOptions(t),this._setWidthHeight(t),this._element&&this.crossOrigin&&(this._element.crossOrigin=this.crossOrigin)},_initFilters:function(t,e){t&&t.length?fabric.util.enlivenObjects(t,function(t){e&&e(t)},"fabric.Image.filters"):e&&e()},_setWidthHeight:function(t){this.width="width"in t?t.width:this.getElement()?this.getElement().width||0:0,this.height="height"in t?t.height:this.getElement()?this.getElement().height||0:0},complexity:function(){return 1}}),fabric.Image.CSS_CANVAS="canvas-img",fabric.Image.prototype.getSvgSrc=fabric.Image.prototype.getSrc,fabric.Image.fromObject=function(t,e){fabric.util.loadImage(t.src,function(i){fabric.Image.prototype._initFilters.call(t,t.filters,function(r){t.filters=r||[],fabric.Image.prototype._initFilters.call(t,t.resizeFilters,function(r){t.resizeFilters=r||[];var s=new fabric.Image(i,t);e&&e(s)})})},null,t.crossOrigin)},fabric.Image.fromURL=function(t,e,i){fabric.util.loadImage(t,function(t){e&&e(new fabric.Image(t,i))},null,i&&i.crossOrigin)},fabric.Image.ATTRIBUTE_NAMES=fabric.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href".split(" ")),fabric.Image.fromElement=function(t,i,r){var s,n,o,a=fabric.parseAttributes(t,fabric.Image.ATTRIBUTE_NAMES),h="xMidYMid",c="meet";a.preserveAspectRatio&&(o=a.preserveAspectRatio.split(" ")),o&&o.length&&(c=o.pop(),"meet"!==c&&"slice"!==c?(h=c,c="meet"):o.length&&(h=o.pop())),s="none"!==h?h.slice(1,4):"none",n="none"!==h?h.slice(5,8):"none",a.alignX=s,a.alignY=n,a.meetOrSlice=c,fabric.Image.fromURL(a["xlink:href"],i,e(r?fabric.util.object.clone(r):{},a))},fabric.Image.async=!0,void(fabric.Image.pngCompression=1))}("undefined"!=typeof exports?exports:this),fabric.util.object.extend(fabric.Object.prototype,{_getAngleValueForStraighten:function(){var t=this.getAngle()%360;return t>0?90*Math.round((t-1)/90):90*Math.round(t/90)},straighten:function(){return this.setAngle(this._getAngleValueForStraighten()),this},fxStraighten:function(t){t=t||{};var e=function(){},i=t.onComplete||e,r=t.onChange||e,s=this;return fabric.util.animate({startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(t){s.setAngle(t),r()},onComplete:function(){s.setCoords(),i()},onStart:function(){s.set("active",!1)}}),this}}),fabric.util.object.extend(fabric.StaticCanvas.prototype,{straightenObject:function(t){return t.straighten(),this.renderAll(),this},fxStraightenObject:function(t){return t.fxStraighten({onChange:this.renderAll.bind(this)}),this}}),fabric.Image.filters=fabric.Image.filters||{},fabric.Image.filters.BaseFilter=fabric.util.createClass({type:"BaseFilter",initialize:function(t){t&&this.setOptions(t)},setOptions:function(t){for(var e in t)this[e]=t[e]},toObject:function(){return{type:this.type}},toJSON:function(){return this.toObject()}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Brightness=e.util.createClass(e.Image.filters.BaseFilter,{type:"Brightness",initialize:function(t){t=t||{},this.brightness=t.brightness||0},applyTo:function(t){for(var e=t.getContext("2d"),i=e.getImageData(0,0,t.width,t.height),r=i.data,s=this.brightness,n=0,o=r.length;o>n;n+=4)r[n]+=s,r[n+1]+=s,r[n+2]+=s;e.putImageData(i,0,0)},toObject:function(){return i(this.callSuper("toObject"),{brightness:this.brightness})}}),e.Image.filters.Brightness.fromObject=function(t){return new e.Image.filters.Brightness(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Convolute=e.util.createClass(e.Image.filters.BaseFilter,{type:"Convolute",initialize:function(t){t=t||{},this.opaque=t.opaque,this.matrix=t.matrix||[0,0,0,0,1,0,0,0,0];var i=e.util.createCanvasElement();this.tmpCtx=i.getContext("2d")},_createImageData:function(t,e){return this.tmpCtx.createImageData(t,e)},applyTo:function(t){for(var e=this.matrix,i=t.getContext("2d"),r=i.getImageData(0,0,t.width,t.height),s=Math.round(Math.sqrt(e.length)),n=Math.floor(s/2),o=r.data,a=r.width,h=r.height,c=a,l=h,u=this._createImageData(c,l),f=u.data,d=this.opaque?1:0,g=0;l>g;g++)for(var p=0;c>p;p++){for(var v=g,b=p,m=4*(g*c+p),y=0,_=0,x=0,C=0,S=0;s>S;S++)for(var w=0;s>w;w++){var O=v+S-n,T=b+w-n;if(!(0>O||O>h||0>T||T>a)){var k=4*(O*a+T),j=e[S*s+w];y+=o[k]*j,_+=o[k+1]*j,x+=o[k+2]*j,C+=o[k+3]*j}}f[m]=y,f[m+1]=_,f[m+2]=x,f[m+3]=C+d*(255-C)}i.putImageData(u,0,0)},toObject:function(){return i(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),e.Image.filters.Convolute.fromObject=function(t){return new e.Image.filters.Convolute(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.GradientTransparency=e.util.createClass(e.Image.filters.BaseFilter,{type:"GradientTransparency",initialize:function(t){t=t||{},this.threshold=t.threshold||100},applyTo:function(t){for(var e=t.getContext("2d"),i=e.getImageData(0,0,t.width,t.height),r=i.data,s=this.threshold,n=r.length,o=0,a=r.length;a>o;o+=4)r[o+3]=s+255*(n-o)/n;e.putImageData(i,0,0)},toObject:function(){return i(this.callSuper("toObject"),{threshold:this.threshold})}}),e.Image.filters.GradientTransparency.fromObject=function(t){return new e.Image.filters.GradientTransparency(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Image.filters.Grayscale=e.util.createClass(e.Image.filters.BaseFilter,{type:"Grayscale",applyTo:function(t){for(var e,i=t.getContext("2d"),r=i.getImageData(0,0,t.width,t.height),s=r.data,n=r.width*r.height*4,o=0;n>o;)e=(s[o]+s[o+1]+s[o+2])/3,s[o]=e,s[o+1]=e,s[o+2]=e,o+=4;i.putImageData(r,0,0)}}),e.Image.filters.Grayscale.fromObject=function(){return new e.Image.filters.Grayscale}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Image.filters.Invert=e.util.createClass(e.Image.filters.BaseFilter,{type:"Invert",applyTo:function(t){var e,i=t.getContext("2d"),r=i.getImageData(0,0,t.width,t.height),s=r.data,n=s.length;for(e=0;n>e;e+=4)s[e]=255-s[e],s[e+1]=255-s[e+1],s[e+2]=255-s[e+2];i.putImageData(r,0,0)}}),e.Image.filters.Invert.fromObject=function(){return new e.Image.filters.Invert}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Mask=e.util.createClass(e.Image.filters.BaseFilter,{type:"Mask",initialize:function(t){t=t||{},this.mask=t.mask,this.channel=[0,1,2,3].indexOf(t.channel)>-1?t.channel:0},applyTo:function(t){if(this.mask){var i,r=t.getContext("2d"),s=r.getImageData(0,0,t.width,t.height),n=s.data,o=this.mask.getElement(),a=e.util.createCanvasElement(),h=this.channel,c=s.width*s.height*4;a.width=o.width,a.height=o.height,a.getContext("2d").drawImage(o,0,0,o.width,o.height);var l=a.getContext("2d").getImageData(0,0,o.width,o.height),u=l.data;for(i=0;c>i;i+=4)n[i+3]=u[i+h];r.putImageData(s,0,0)}},toObject:function(){return i(this.callSuper("toObject"),{mask:this.mask.toObject(),channel:this.channel})}}),e.Image.filters.Mask.fromObject=function(t,i){e.util.loadImage(t.mask.src,function(r){t.mask=new e.Image(r,t.mask),i&&i(new e.Image.filters.Mask(t))})},e.Image.filters.Mask.async=!0}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Noise=e.util.createClass(e.Image.filters.BaseFilter,{type:"Noise",initialize:function(t){t=t||{},this.noise=t.noise||0},applyTo:function(t){for(var e,i=t.getContext("2d"),r=i.getImageData(0,0,t.width,t.height),s=r.data,n=this.noise,o=0,a=s.length;a>o;o+=4)e=(.5-Math.random())*n,s[o]+=e,s[o+1]+=e,s[o+2]+=e;i.putImageData(r,0,0)},toObject:function(){return i(this.callSuper("toObject"),{noise:this.noise})}}),e.Image.filters.Noise.fromObject=function(t){return new e.Image.filters.Noise(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Pixelate=e.util.createClass(e.Image.filters.BaseFilter,{type:"Pixelate",initialize:function(t){t=t||{},this.blocksize=t.blocksize||4},applyTo:function(t){var e,i,r,s,n,o,a,h=t.getContext("2d"),c=h.getImageData(0,0,t.width,t.height),l=c.data,u=c.height,f=c.width;for(i=0;u>i;i+=this.blocksize)for(r=0;f>r;r+=this.blocksize){e=4*i*f+4*r,s=l[e],n=l[e+1],o=l[e+2],a=l[e+3];for(var d=i,g=i+this.blocksize;g>d;d++)for(var p=r,v=r+this.blocksize;v>p;p++)e=4*d*f+4*p,l[e]=s,l[e+1]=n,l[e+2]=o,l[e+3]=a}h.putImageData(c,0,0)},toObject:function(){return i(this.callSuper("toObject"),{blocksize:this.blocksize})}}),e.Image.filters.Pixelate.fromObject=function(t){return new e.Image.filters.Pixelate(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.RemoveWhite=e.util.createClass(e.Image.filters.BaseFilter,{type:"RemoveWhite",initialize:function(t){t=t||{},this.threshold=t.threshold||30,this.distance=t.distance||20},applyTo:function(t){for(var e,i,r,s=t.getContext("2d"),n=s.getImageData(0,0,t.width,t.height),o=n.data,a=this.threshold,h=this.distance,c=255-a,l=Math.abs,u=0,f=o.length;f>u;u+=4)e=o[u],i=o[u+1],r=o[u+2],e>c&&i>c&&r>c&&l(e-i)<h&&l(e-r)<h&&l(i-r)<h&&(o[u+3]=1);s.putImageData(n,0,0)},toObject:function(){return i(this.callSuper("toObject"),{threshold:this.threshold,distance:this.distance})}}),e.Image.filters.RemoveWhite.fromObject=function(t){return new e.Image.filters.RemoveWhite(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Image.filters.Sepia=e.util.createClass(e.Image.filters.BaseFilter,{type:"Sepia",applyTo:function(t){var e,i,r=t.getContext("2d"),s=r.getImageData(0,0,t.width,t.height),n=s.data,o=n.length;for(e=0;o>e;e+=4)i=.3*n[e]+.59*n[e+1]+.11*n[e+2],n[e]=i+100,n[e+1]=i+50,n[e+2]=i+255;r.putImageData(s,0,0)}}),e.Image.filters.Sepia.fromObject=function(){return new e.Image.filters.Sepia}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Image.filters.Sepia2=e.util.createClass(e.Image.filters.BaseFilter,{type:"Sepia2",applyTo:function(t){var e,i,r,s,n=t.getContext("2d"),o=n.getImageData(0,0,t.width,t.height),a=o.data,h=a.length;for(e=0;h>e;e+=4)i=a[e],r=a[e+1],s=a[e+2],a[e]=(.393*i+.769*r+.189*s)/1.351,a[e+1]=(.349*i+.686*r+.168*s)/1.203,a[e+2]=(.272*i+.534*r+.131*s)/2.14;n.putImageData(o,0,0)}}),e.Image.filters.Sepia2.fromObject=function(){return new e.Image.filters.Sepia2}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Tint=e.util.createClass(e.Image.filters.BaseFilter,{type:"Tint",initialize:function(t){t=t||{},this.color=t.color||"#000000",this.opacity="undefined"!=typeof t.opacity?t.opacity:new e.Color(this.color).getAlpha()},applyTo:function(t){var i,r,s,n,o,a,h,c,l,u=t.getContext("2d"),f=u.getImageData(0,0,t.width,t.height),d=f.data,g=d.length;for(l=new e.Color(this.color).getSource(),r=l[0]*this.opacity,s=l[1]*this.opacity,n=l[2]*this.opacity,c=1-this.opacity,i=0;g>i;i+=4)o=d[i],a=d[i+1],h=d[i+2],d[i]=r+o*c,d[i+1]=s+a*c,d[i+2]=n+h*c;u.putImageData(f,0,0)},toObject:function(){return i(this.callSuper("toObject"),{color:this.color,opacity:this.opacity})}}),e.Image.filters.Tint.fromObject=function(t){return new e.Image.filters.Tint(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Multiply=e.util.createClass(e.Image.filters.BaseFilter,{type:"Multiply",initialize:function(t){t=t||{},this.color=t.color||"#000000"},applyTo:function(t){var i,r,s=t.getContext("2d"),n=s.getImageData(0,0,t.width,t.height),o=n.data,a=o.length;for(r=new e.Color(this.color).getSource(),i=0;a>i;i+=4)o[i]*=r[0]/255,o[i+1]*=r[1]/255,o[i+2]*=r[2]/255;s.putImageData(n,0,0)},toObject:function(){return i(this.callSuper("toObject"),{color:this.color})}}),e.Image.filters.Multiply.fromObject=function(t){return new e.Image.filters.Multiply(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric;e.Image.filters.Blend=e.util.createClass({type:"Blend",initialize:function(t){t=t||{},this.color=t.color||"#000",this.image=t.image||!1,this.mode=t.mode||"multiply",this.alpha=t.alpha||1},applyTo:function(t){var i,r,s,n,o,a,h,c,l,u,f=t.getContext("2d"),d=f.getImageData(0,0,t.width,t.height),g=d.data,p=!1;if(this.image){p=!0;var v=e.util.createCanvasElement();v.width=this.image.width,v.height=this.image.height;var b=new e.StaticCanvas(v);b.add(this.image);var m=b.getContext("2d");u=m.getImageData(0,0,b.width,b.height).data}else u=new e.Color(this.color).getSource(),i=u[0]*this.alpha,r=u[1]*this.alpha,s=u[2]*this.alpha;for(var y=0,_=g.length;_>y;y+=4)switch(n=g[y],o=g[y+1],a=g[y+2],p&&(i=u[y]*this.alpha,r=u[y+1]*this.alpha,s=u[y+2]*this.alpha),this.mode){case"multiply":g[y]=n*i/255,g[y+1]=o*r/255,g[y+2]=a*s/255;break;case"screen":g[y]=1-(1-n)*(1-i),g[y+1]=1-(1-o)*(1-r),g[y+2]=1-(1-a)*(1-s);break;case"add":g[y]=Math.min(255,n+i),g[y+1]=Math.min(255,o+r),g[y+2]=Math.min(255,a+s);break;case"diff":case"difference":g[y]=Math.abs(n-i),g[y+1]=Math.abs(o-r),g[y+2]=Math.abs(a-s);break;case"subtract":h=n-i,c=o-r,l=a-s,g[y]=0>h?0:h,g[y+1]=0>c?0:c,g[y+2]=0>l?0:l;break;case"darken":g[y]=Math.min(n,i),g[y+1]=Math.min(o,r),g[y+2]=Math.min(a,s);break;case"lighten":g[y]=Math.max(n,i),g[y+1]=Math.max(o,r),g[y+2]=Math.max(a,s)}f.putImageData(d,0,0)},toObject:function(){return{color:this.color,image:this.image,mode:this.mode,alpha:this.alpha}}}),e.Image.filters.Blend.fromObject=function(t){return new e.Image.filters.Blend(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=Math.pow,r=Math.floor,s=Math.sqrt,n=Math.abs,o=Math.max,a=Math.round,h=Math.sin,c=Math.ceil;e.Image.filters.Resize=e.util.createClass(e.Image.filters.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:0,scaleY:0,lanczosLobes:3,applyTo:function(t,e,i){this.rcpScaleX=1/e,this.rcpScaleY=1/i;var r,s=t.width,n=t.height,o=a(s*e),h=a(n*i);"sliceHack"===this.resizeType&&(r=this.sliceByTwo(t,s,n,o,h)),"hermite"===this.resizeType&&(r=this.hermiteFastResize(t,s,n,o,h)),"bilinear"===this.resizeType&&(r=this.bilinearFiltering(t,s,n,o,h)),"lanczos"===this.resizeType&&(r=this.lanczosResize(t,s,n,o,h)),t.width=o,t.height=h,t.getContext("2d").putImageData(r,0,0)},sliceByTwo:function(t,i,s,n,a){var h,c=t.getContext("2d"),l=.5,u=.5,f=1,d=1,g=!1,p=!1,v=i,b=s,m=e.util.createCanvasElement(),y=m.getContext("2d");for(n=r(n),a=r(a),m.width=o(n,i),m.height=o(a,s),n>i&&(l=2,f=-1),a>s&&(u=2,d=-1),h=c.getImageData(0,0,i,s),t.width=o(n,i),t.height=o(a,s),c.putImageData(h,0,0);!g||!p;)i=v,s=b,n*f<r(v*l*f)?v=r(v*l):(v=n,g=!0),a*d<r(b*u*d)?b=r(b*u):(b=a,p=!0),h=c.getImageData(0,0,i,s),y.putImageData(h,0,0),c.clearRect(0,0,v,b),c.drawImage(m,0,0,i,s,0,0,v,b);return c.getImageData(0,0,n,a)},lanczosResize:function(t,e,o,a,l){function u(t){return function(e){if(e>t)return 0;if(e*=Math.PI,n(e)<1e-16)return 1;var i=e/t;return h(e)*h(i)/e/i}}function f(t){var h,c,u,d,g,j,A,P,E,M,I;for(T.x=(t+.5)*y,k.x=r(T.x),h=0;l>h;h++){for(T.y=(h+.5)*_,k.y=r(T.y),g=0,j=0,A=0,P=0,E=0,c=k.x-S;c<=k.x+S;c++)if(!(0>c||c>=e)){M=r(1e3*n(c-T.x)),O[M]||(O[M]={});for(var D=k.y-w;D<=k.y+w;D++)0>D||D>=o||(I=r(1e3*n(D-T.y)),O[M][I]||(O[M][I]=m(s(i(M*x,2)+i(I*C,2))/1e3)),u=O[M][I],u>0&&(d=4*(D*e+c),g+=u,j+=u*v[d],A+=u*v[d+1],P+=u*v[d+2],E+=u*v[d+3]))}d=4*(h*a+t),b[d]=j/g,b[d+1]=A/g,b[d+2]=P/g,b[d+3]=E/g}return++t<a?f(t):p}var d=t.getContext("2d"),g=d.getImageData(0,0,e,o),p=d.getImageData(0,0,a,l),v=g.data,b=p.data,m=u(this.lanczosLobes),y=this.rcpScaleX,_=this.rcpScaleY,x=2/this.rcpScaleX,C=2/this.rcpScaleY,S=c(y*this.lanczosLobes/2),w=c(_*this.lanczosLobes/2),O={},T={},k={};return f(0)},bilinearFiltering:function(t,e,i,s,n){var o,a,h,c,l,u,f,d,g,p,v,b,m,y=0,_=this.rcpScaleX,x=this.rcpScaleY,C=t.getContext("2d"),S=4*(e-1),w=C.getImageData(0,0,e,i),O=w.data,T=C.getImageData(0,0,s,n),k=T.data;for(f=0;n>f;f++)for(d=0;s>d;d++)for(l=r(_*d),u=r(x*f),g=_*d-l,p=x*f-u,m=4*(u*e+l),v=0;4>v;v++)o=O[m+v],a=O[m+4+v],h=O[m+S+v],c=O[m+S+4+v],b=o*(1-g)*(1-p)+a*g*(1-p)+h*p*(1-g)+c*g*p,k[y++]=b;return T},hermiteFastResize:function(t,e,i,o,a){for(var h=this.rcpScaleX,l=this.rcpScaleY,u=c(h/2),f=c(l/2),d=t.getContext("2d"),g=d.getImageData(0,0,e,i),p=g.data,v=d.getImageData(0,0,o,a),b=v.data,m=0;a>m;m++)for(var y=0;o>y;y++){for(var _=4*(y+m*o),x=0,C=0,S=0,w=0,O=0,T=0,k=0,j=(m+.5)*l,A=r(m*l);(m+1)*l>A;A++)for(var P=n(j-(A+.5))/f,E=(y+.5)*h,M=P*P,I=r(y*h);(y+1)*h>I;I++){var D=n(E-(I+.5))/u,L=s(M+D*D);L>1&&-1>L||(x=2*L*L*L-3*L*L+1,x>0&&(D=4*(I+A*e),k+=x*p[D+3],S+=x,p[D+3]<255&&(x=x*p[D+3]/250),w+=x*p[D],O+=x*p[D+1],T+=x*p[D+2],C+=x))}b[_]=w/C,b[_+1]=O/C,b[_+2]=T/C,b[_+3]=k/S}return v},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),e.Image.filters.Resize.fromObject=function(t){return new e.Image.filters.Resize(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.object.clone,s=e.util.toFixed,n=e.StaticCanvas.supports("setLineDash"),o=e.Object.NUM_FRACTION_DIGITS;if(e.Text)return void e.warn("fabric.Text is already defined");var a=e.Object.prototype.stateProperties.concat();a.push("fontFamily","fontWeight","fontSize","text","textDecoration","textAlign","fontStyle","lineHeight","textBackgroundColor"),e.Text=e.util.createClass(e.Object,{_dimensionAffectingProps:{fontSize:!0,fontWeight:!0,fontFamily:!0,fontStyle:!0,lineHeight:!0,stroke:!0,strokeWidth:!0,text:!0,textAlign:!0},_reNewline:/\r?\n/,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",textDecoration:"",textAlign:"left",fontStyle:"",lineHeight:1.16,textBackgroundColor:"",stateProperties:a,stroke:null,shadow:null,_fontSizeFraction:.25,_fontSizeMult:1.13,initialize:function(t,e){e=e||{},this.text=t,this.__skipDimension=!0,this.setOptions(e),this.__skipDimension=!1,this._initDimensions()},_initDimensions:function(t){if(!this.__skipDimension){t||(t=e.util.createCanvasElement().getContext("2d"),this._setTextStyles(t)),this._textLines=this.text.split(this._reNewline),this._clearCache();var i=this.textAlign;this.textAlign="left",this.width=this._getTextWidth(t),this.textAlign=i,this.height=this._getTextHeight(t)}},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_render:function(t){this.clipTo&&e.util.clipContext(this,t),this._renderTextBackground(t),this._renderText(t),this._renderTextDecoration(t),this.clipTo&&t.restore()},_renderText:function(t){t.save(),this._translateForTextAlign(t),this._setOpacity(t),this._setShadow(t),this._setupCompositeOperation(t),this._renderTextFill(t),this._renderTextStroke(t),t.restore()},_translateForTextAlign:function(t){"left"!==this.textAlign&&"justify"!==this.textAlign&&t.translate("center"===this.textAlign?this.width/2:this.width,0)},_setTextStyles:function(t){t.textBaseline="alphabetic",this.skipTextAlign||(t.textAlign=this.textAlign),t.font=this._getFontDeclaration()},_getTextHeight:function(){return this._textLines.length*this._getHeightOfLine()},_getTextWidth:function(t){for(var e=this._getLineWidth(t,0),i=1,r=this._textLines.length;r>i;i++){var s=this._getLineWidth(t,i);s>e&&(e=s)}return e},_renderChars:function(t,e,i,r,s){var n=t.slice(0,-4);if(this[n].toLive){var o=-this.width/2+this[n].offsetX||0,a=-this.height/2+this[n].offsetY||0;e.save(),e.translate(o,a),r-=o,s-=a}e[t](i,r,s),this[n].toLive&&e.restore()},_renderTextLine:function(t,e,i,r,s,n){if(s-=this.fontSize*this._fontSizeFraction,"justify"!==this.textAlign)return void this._renderChars(t,e,i,r,s,n);var o=this._getLineWidth(e,n),a=this.width;if(a>=o)for(var h=i.split(/\s+/),c=this._getWidthOfWords(e,i,n),l=a-c,u=h.length-1,f=l/u,d=0,g=0,p=h.length;p>g;g++)this._renderChars(t,e,h[g],r+d,s,n),d+=e.measureText(h[g]).width+f;else this._renderChars(t,e,i,r,s,n)},_getWidthOfWords:function(t,e){return t.measureText(e.replace(/\s+/g,"")).width},_getLeftOffset:function(){return-this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextFill:function(t){if(this.fill||this._skipFillStrokeCheck)for(var e=0,i=0,r=this._textLines.length;r>i;i++){var s=this._getHeightOfLine(t,i),n=s/this.lineHeight;this._renderTextLine("fillText",t,this._textLines[i],this._getLeftOffset(),this._getTopOffset()+e+n,i),e+=s}},_renderTextStroke:function(t){if(this.stroke&&0!==this.strokeWidth||this._skipFillStrokeCheck){var e=0;this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeDashArray&&(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),n&&t.setLineDash(this.strokeDashArray)),t.beginPath();for(var i=0,r=this._textLines.length;r>i;i++){var s=this._getHeightOfLine(t,i),o=s/this.lineHeight;this._renderTextLine("strokeText",t,this._textLines[i],this._getLeftOffset(),this._getTopOffset()+e+o,i),e+=s}t.closePath(),t.restore()}},_getHeightOfLine:function(){return this.fontSize*this._fontSizeMult*this.lineHeight},_renderTextBackground:function(t){this._renderTextBoxBackground(t),this._renderTextLinesBackground(t)},_renderTextBoxBackground:function(t){this.backgroundColor&&(t.save(),t.fillStyle=this.backgroundColor,t.fillRect(this._getLeftOffset(),this._getTopOffset(),this.width,this.height),t.restore())},_renderTextLinesBackground:function(t){var e=0,i=this._getHeightOfLine();if(this.textBackgroundColor){t.save(),t.fillStyle=this.textBackgroundColor;for(var r=0,s=this._textLines.length;s>r;r++){if(""!==this._textLines[r]){var n=this._getLineWidth(t,r),o=this._getLineLeftOffset(n);t.fillRect(this._getLeftOffset()+o,this._getTopOffset()+e,n,this.fontSize*this._fontSizeMult)}e+=i}t.restore()}},_getLineLeftOffset:function(t){return"center"===this.textAlign?(this.width-t)/2:"right"===this.textAlign?this.width-t:0},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__lineOffsets=[]},_shouldClearCache:function(){var t=!1;for(var e in this._dimensionAffectingProps)this["__"+e]!==this[e]&&(this["__"+e]=this[e],t=!0);return t},_getLineWidth:function(t,e){return this.__lineWidths[e]?this.__lineWidths[e]:(this.__lineWidths[e]=t.measureText(this._textLines[e]).width,this.__lineWidths[e])},_renderTextDecoration:function(t){function e(e){var s,n,o,a,h=0;for(s=0,n=r._textLines.length;n>s;s++){var c=r._getLineWidth(t,s),l=r._getLineLeftOffset(c),u=r._getHeightOfLine(t,s);for(o=0,a=e.length;a>o;o++)t.fillRect(r._getLeftOffset()+l,h+(r._fontSizeMult-1+e[o])*r.fontSize-i,c,r.fontSize/15);h+=u}}if(this.textDecoration){var i=this.height/2,r=this,s=[];this.textDecoration.indexOf("underline")>-1&&s.push(.85),this.textDecoration.indexOf("line-through")>-1&&s.push(.43),this.textDecoration.indexOf("overline")>-1&&s.push(-.12),s.length>0&&e(s)}},_getFontDeclaration:function(){return[e.isLikelyNode?this.fontWeight:this.fontStyle,e.isLikelyNode?this.fontStyle:this.fontWeight,this.fontSize+"px",e.isLikelyNode?'"'+this.fontFamily+'"':this.fontFamily].join(" ")},render:function(t,e){this.visible&&(t.save(),this._setTextStyles(t),this._shouldClearCache()&&this._initDimensions(t),e||this.transform(t),this._setStrokeStyles(t),this._setFillStyles(t),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this.group&&"path-group"===this.group.type&&t.translate(this.left,this.top),this._render(t),t.restore())},toObject:function(t){var e=i(this.callSuper("toObject",t),{text:this.text,fontSize:this.fontSize,fontWeight:this.fontWeight,fontFamily:this.fontFamily,fontStyle:this.fontStyle,lineHeight:this.lineHeight,textDecoration:this.textDecoration,textAlign:this.textAlign,textBackgroundColor:this.textBackgroundColor});return this.includeDefaultValues||this._removeDefaultValues(e),e},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this._getSVGLeftTopOffsets(this.ctx),r=this._getSVGTextAndBg(i.textTop,i.textLeft);return this._wrapSVGTextAndBg(e,r),t?t(e.join("")):e.join("")},_getSVGLeftTopOffsets:function(t){var e=this._getHeightOfLine(t,0),i=-this.width/2,r=0;return{textLeft:i+(this.group&&"path-group"===this.group.type?this.left:0),textTop:r+(this.group&&"path-group"===this.group.type?-this.top:0),lineTop:e}},_wrapSVGTextAndBg:function(t,e){t.push('	<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n',e.textBgRects.join(""),"		<text ",this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",this.textDecoration?'text-decoration="'+this.textDecoration+'" ':"",'style="',this.getSvgStyles(),'" >',e.textSpans.join(""),"</text>\n","	</g>\n")},_getSVGTextAndBg:function(t,e){var i=[],r=[],s=0;this._setSVGBg(r);for(var n=0,o=this._textLines.length;o>n;n++)this.textBackgroundColor&&this._setSVGTextLineBg(r,n,e,t,s),this._setSVGTextLineText(n,i,s,e,t,r),s+=this._getHeightOfLine(this.ctx,n);return{textSpans:i,textBgRects:r}},_setSVGTextLineText:function(t,i,r,n,a){var h=this.fontSize*(this._fontSizeMult-this._fontSizeFraction)-a+r-this.height/2;i.push('<tspan x="',s(n+this._getLineLeftOffset(this.__lineWidths[t]),o),'" ','y="',s(h,o),'" ',this._getFillAttributes(this.fill),">",e.util.string.escapeXml(this._textLines[t]),"</tspan>")},_setSVGTextLineBg:function(t,e,i,r,n){t.push("		<rect ",this._getFillAttributes(this.textBackgroundColor),' x="',s(i+this._getLineLeftOffset(this.__lineWidths[e]),o),'" y="',s(n-this.height/2,o),'" width="',s(this.__lineWidths[e],o),'" height="',s(this._getHeightOfLine(this.ctx,e)/this.lineHeight,o),'"></rect>\n')},_setSVGBg:function(t){this.backgroundColor&&t.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',s(-this.width/2,o),'" y="',s(-this.height/2,o),'" width="',s(this.width,o),'" height="',s(this.height,o),'"></rect>\n')},_getFillAttributes:function(t){var i=t&&"string"==typeof t?new e.Color(t):"";return i&&i.getSource()&&1!==i.getAlpha()?'opacity="'+i.getAlpha()+'" fill="'+i.setAlpha(1).toRgb()+'"':'fill="'+t+'"'},_set:function(t,e){this.callSuper("_set",t,e),t in this._dimensionAffectingProps&&(this._initDimensions(),this.setCoords())},complexity:function(){return 1}}),e.Text.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size text-decoration text-anchor".split(" ")),e.Text.DEFAULT_SVG_FONT_SIZE=16,e.Text.fromElement=function(t,i){if(!t)return null;var r=e.parseAttributes(t,e.Text.ATTRIBUTE_NAMES);i=e.util.object.extend(i?e.util.object.clone(i):{},r),i.top=i.top||0,i.left=i.left||0,"dx"in r&&(i.left+=r.dx),"dy"in r&&(i.top+=r.dy),"fontSize"in i||(i.fontSize=e.Text.DEFAULT_SVG_FONT_SIZE),i.originX||(i.originX="left");var s=t.textContent.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),n=new e.Text(s,i),o=0;return"left"===n.originX&&(o=n.getWidth()/2),"right"===n.originX&&(o=-n.getWidth()/2),n.set({left:n.getLeft()+o,top:n.getTop()-n.getHeight()/2+n.fontSize*(.18+n._fontSizeFraction)}),n},e.Text.fromObject=function(t){return new e.Text(t.text,r(t))},e.util.createAccessors(e.Text)}("undefined"!=typeof exports?exports:this),function(){var t=fabric.util.object.clone;fabric.IText=fabric.util.createClass(fabric.Text,fabric.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"#333",cursorDelay:1e3,cursorDuration:600,styles:null,caching:!0,_skipFillStrokeCheck:!1,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,_charWidthsCache:{},initialize:function(t,e){this.styles=e?e.styles||{}:{},this.callSuper("initialize",t,e),this.initBehavior()},_clearCache:function(){this.callSuper("_clearCache"),this.__maxFontHeights=[],this.__widthOfSpace=[]},isEmptyStyles:function(){if(!this.styles)return!0;var t=this.styles;for(var e in t)for(var i in t[e])for(var r in t[e][i])return!1;return!0},setSelectionStart:function(t){t=Math.max(t,0),this.selectionStart!==t&&(this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this}),this.selectionStart=t),this._updateTextarea()},setSelectionEnd:function(t){t=Math.min(t,this.text.length),this.selectionEnd!==t&&(this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this}),this.selectionEnd=t),this._updateTextarea()},getSelectionStyles:function(t,e){if(2===arguments.length){for(var i=[],r=t;e>r;r++)i.push(this.getSelectionStyles(r));return i}var s=this.get2DCursorLocation(t);return this.styles[s.lineIndex]?this.styles[s.lineIndex][s.charIndex]||{}:{}},setSelectionStyles:function(t){if(this.selectionStart===this.selectionEnd)this._extendStyles(this.selectionStart,t);else for(var e=this.selectionStart;e<this.selectionEnd;e++)this._extendStyles(e,t);return this._clearCache(),this},_extendStyles:function(t,e){var i=this.get2DCursorLocation(t);this.styles[i.lineIndex]||(this.styles[i.lineIndex]={}),this.styles[i.lineIndex][i.charIndex]||(this.styles[i.lineIndex][i.charIndex]={}),fabric.util.object.extend(this.styles[i.lineIndex][i.charIndex],e)},_render:function(t){this.callSuper("_render",t),this.ctx=t,this.isEditing&&this.renderCursorOrSelection()},renderCursorOrSelection:function(){if(this.active){var t,e,i=this.text.split("");this.canvas.contextTop?(e=this.canvas.contextTop,e.save(),e.transform.apply(e,this.canvas.viewportTransform),this.transform(e),this.transformMatrix&&e.transform.apply(e,this.transformMatrix)):(e=this.ctx,e.save()),this.selectionStart===this.selectionEnd?(t=this._getCursorBoundaries(i,"cursor"),this.renderCursor(t,e)):(t=this._getCursorBoundaries(i,"selection"),this.renderSelection(i,t,e)),
e.restore()}},get2DCursorLocation:function(t){"undefined"==typeof t&&(t=this.selectionStart);for(var e=this._textLines.length,i=0;e>i;i++){if(t<=this._textLines[i].length)return{lineIndex:i,charIndex:t};t-=this._textLines[i].length+1}return{lineIndex:i-1,charIndex:this._textLines[i-1].length<t?this._textLines[i-1].length:t}},getCurrentCharStyle:function(t,e){var i=this.styles[t]&&this.styles[t][0===e?0:e-1];return{fontSize:i&&i.fontSize||this.fontSize,fill:i&&i.fill||this.fill,textBackgroundColor:i&&i.textBackgroundColor||this.textBackgroundColor,textDecoration:i&&i.textDecoration||this.textDecoration,fontFamily:i&&i.fontFamily||this.fontFamily,fontWeight:i&&i.fontWeight||this.fontWeight,fontStyle:i&&i.fontStyle||this.fontStyle,stroke:i&&i.stroke||this.stroke,strokeWidth:i&&i.strokeWidth||this.strokeWidth}},getCurrentCharFontSize:function(t,e){return this.styles[t]&&this.styles[t][0===e?0:e-1]&&this.styles[t][0===e?0:e-1].fontSize||this.fontSize},getCurrentCharColor:function(t,e){return this.styles[t]&&this.styles[t][0===e?0:e-1]&&this.styles[t][0===e?0:e-1].fill||this.cursorColor},_getCursorBoundaries:function(t,e){var i=Math.round(this._getLeftOffset()),r=this._getTopOffset(),s=this._getCursorBoundariesOffsets(t,e);return{left:i,top:r,leftOffset:s.left+s.lineLeft,topOffset:s.top}},_getCursorBoundariesOffsets:function(t,e){for(var i=0,r=0,s=0,n=0,o=0,a=0;a<this.selectionStart;a++)"\n"===t[a]?(o=0,n+=this._getHeightOfLine(this.ctx,r),r++,s=0):(o+=this._getWidthOfChar(this.ctx,t[a],r,s),s++),i=this._getCachedLineOffset(r);return"cursor"===e&&(n+=(1-this._fontSizeFraction)*this._getHeightOfLine(this.ctx,r)/this.lineHeight-this.getCurrentCharFontSize(r,s)*(1-this._fontSizeFraction)),{top:n,left:o,lineLeft:i}},_getCachedLineOffset:function(t){var e=this._getLineWidth(this.ctx,t);return this.__lineOffsets[t]||(this.__lineOffsets[t]=this._getLineLeftOffset(e))},renderCursor:function(t,e){var i=this.get2DCursorLocation(),r=i.lineIndex,s=i.charIndex,n=this.getCurrentCharFontSize(r,s),o=0===r&&0===s?this._getCachedLineOffset(r):t.leftOffset;e.fillStyle=this.getCurrentCharColor(r,s),e.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,e.fillRect(t.left+o,t.top+t.topOffset,this.cursorWidth/this.scaleX,n)},renderSelection:function(t,e,i){i.fillStyle=this.selectionColor;for(var r=this.get2DCursorLocation(this.selectionStart),s=this.get2DCursorLocation(this.selectionEnd),n=r.lineIndex,o=s.lineIndex,a=n;o>=a;a++){var h=this._getCachedLineOffset(a)||0,c=this._getHeightOfLine(this.ctx,a),l=0,u=this._textLines[a];if(a===n)for(var f=0,d=u.length;d>f;f++)f>=r.charIndex&&(a!==o||f<s.charIndex)&&(l+=this._getWidthOfChar(i,u[f],a,f)),f<r.charIndex&&(h+=this._getWidthOfChar(i,u[f],a,f));else if(a>n&&o>a)l+=this._getLineWidth(i,a)||5;else if(a===o)for(var g=0,p=s.charIndex;p>g;g++)l+=this._getWidthOfChar(i,u[g],a,g);i.fillRect(e.left+h,e.top+e.topOffset,l,c),e.topOffset+=c}},_renderChars:function(t,e,i,r,s,n){if(this.isEmptyStyles())return this._renderCharsFast(t,e,i,r,s);this.skipTextAlign=!0,r-="center"===this.textAlign?this.width/2:"right"===this.textAlign?this.width:0;var o,a=this._getHeightOfLine(e,n),h=this._getCachedLineOffset(n),c="";r+=h||0,e.save(),s-=a/this.lineHeight*this._fontSizeFraction;for(var l=0,u=i.length;u>=l;l++){o=o||this.getCurrentCharStyle(n,l);var f=this.getCurrentCharStyle(n,l+1);(this._hasStyleChanged(o,f)||l===u)&&(this._renderChar(t,e,n,l-1,c,r,s,a),c="",o=f),c+=i[l]}e.restore()},_renderCharsFast:function(t,e,i,r,s){this.skipTextAlign=!1,"fillText"===t&&this.fill&&this.callSuper("_renderChars",t,e,i,r,s),"strokeText"===t&&(this.stroke&&this.strokeWidth>0||this.skipFillStrokeCheck)&&this.callSuper("_renderChars",t,e,i,r,s)},_renderChar:function(t,e,i,r,s,n,o,a){var h,c,l,u=this._fontSizeFraction*a/this.lineHeight;if(this.styles&&this.styles[i]&&(h=this.styles[i][r])){var f=h.stroke||this.stroke,d=h.fill||this.fill;e.save(),c=this._applyCharStylesGetWidth(e,s,i,r,h),l=this._getHeightOfChar(e,s,i,r),d&&e.fillText(s,n,o),f&&e.strokeText(s,n,o),this._renderCharDecoration(e,h,n,o,u,c,l),e.restore(),e.translate(c,0)}else"strokeText"===t&&this.stroke&&e[t](s,n,o),"fillText"===t&&this.fill&&e[t](s,n,o),c=this._applyCharStylesGetWidth(e,s,i,r),this._renderCharDecoration(e,null,n,o,u,c,this.fontSize),e.translate(e.measureText(s).width,0)},_hasStyleChanged:function(t,e){return t.fill!==e.fill||t.fontSize!==e.fontSize||t.textBackgroundColor!==e.textBackgroundColor||t.textDecoration!==e.textDecoration||t.fontFamily!==e.fontFamily||t.fontWeight!==e.fontWeight||t.fontStyle!==e.fontStyle||t.stroke!==e.stroke||t.strokeWidth!==e.strokeWidth},_renderCharDecoration:function(t,e,i,r,s,n,o){var a=e?e.textDecoration||this.textDecoration:this.textDecoration;a&&(a.indexOf("underline")>-1&&t.fillRect(i,r+o/10,n,o/15),a.indexOf("line-through")>-1&&t.fillRect(i,r-o*(this._fontSizeFraction+this._fontSizeMult-1)+o/15,n,o/15),a.indexOf("overline")>-1&&t.fillRect(i,r-(this._fontSizeMult-this._fontSizeFraction)*o,n,o/15))},_renderTextLine:function(t,e,i,r,s,n){this.isEmptyStyles()||(s+=this.fontSize*(this._fontSizeFraction+.03)),this.callSuper("_renderTextLine",t,e,i,r,s,n)},_renderTextDecoration:function(t){return this.isEmptyStyles()?this.callSuper("_renderTextDecoration",t):void 0},_renderTextLinesBackground:function(t){if(this.textBackgroundColor||this.styles){t.save(),this.textBackgroundColor&&(t.fillStyle=this.textBackgroundColor);for(var e=0,i=0,r=this._textLines.length;r>i;i++){var s=this._getHeightOfLine(t,i);if(""!==this._textLines[i]){var n=this._getLineWidth(t,i),o=this._getCachedLineOffset(i);if(this.textBackgroundColor&&(t.fillStyle=this.textBackgroundColor,t.fillRect(this._getLeftOffset()+o,this._getTopOffset()+e,n,s/this.lineHeight)),this.styles[i])for(var a=0,h=this._textLines[i].length;h>a;a++)if(this.styles[i]&&this.styles[i][a]&&this.styles[i][a].textBackgroundColor){var c=this._textLines[i][a];t.fillStyle=this.styles[i][a].textBackgroundColor,t.fillRect(this._getLeftOffset()+o+this._getWidthOfCharsAt(t,i,a),this._getTopOffset()+e,this._getWidthOfChar(t,c,i,a)+1,s/this.lineHeight)}e+=s}else e+=s}t.restore()}},_getCacheProp:function(t,e){return t+e.fontFamily+e.fontSize+e.fontWeight+e.fontStyle+e.shadow},_applyCharStylesGetWidth:function(e,i,r,s,n){var o=n||this.styles[r]&&this.styles[r][s];o=o?t(o):{},this._applyFontStyles(o);var a=this._getCacheProp(i,o);if(this.isEmptyStyles()&&this._charWidthsCache[a]&&this.caching)return this._charWidthsCache[a];"string"==typeof o.shadow&&(o.shadow=new fabric.Shadow(o.shadow));var h=o.fill||this.fill;return e.fillStyle=h.toLive?h.toLive(e,this):h,o.stroke&&(e.strokeStyle=o.stroke&&o.stroke.toLive?o.stroke.toLive(e,this):o.stroke),e.lineWidth=o.strokeWidth||this.strokeWidth,e.font=this._getFontDeclaration.call(o),this._setShadow.call(o,e),this.caching?(this._charWidthsCache[a]||(this._charWidthsCache[a]=e.measureText(i).width),this._charWidthsCache[a]):e.measureText(i).width},_applyFontStyles:function(t){t.fontFamily||(t.fontFamily=this.fontFamily),t.fontSize||(t.fontSize=this.fontSize),t.fontWeight||(t.fontWeight=this.fontWeight),t.fontStyle||(t.fontStyle=this.fontStyle)},_getStyleDeclaration:function(e,i){return this.styles[e]&&this.styles[e][i]?t(this.styles[e][i]):{}},_getWidthOfChar:function(t,e,i,r){if("justify"===this.textAlign&&/\s/.test(e))return this._getWidthOfSpace(t,i);var s=this._getStyleDeclaration(i,r);this._applyFontStyles(s);var n=this._getCacheProp(e,s);if(this._charWidthsCache[n]&&this.caching)return this._charWidthsCache[n];if(t){t.save();var o=this._applyCharStylesGetWidth(t,e,i,r);return t.restore(),o}},_getHeightOfChar:function(t,e,i,r){return this.styles[i]&&this.styles[i][r]?this.styles[i][r].fontSize||this.fontSize:this.fontSize},_getHeightOfCharAt:function(t,e,i){var r=this._textLines[e][i];return this._getHeightOfChar(t,r,e,i)},_getWidthOfCharsAt:function(t,e,i){var r,s,n=0;for(r=0;i>r;r++)s=this._textLines[e][r],n+=this._getWidthOfChar(t,s,e,r);return n},_getLineWidth:function(t,e){return this.__lineWidths[e]?this.__lineWidths[e]:(this.__lineWidths[e]=this._getWidthOfCharsAt(t,e,this._textLines[e].length),this.__lineWidths[e])},_getWidthOfSpace:function(t,e){if(this.__widthOfSpace[e])return this.__widthOfSpace[e];var i=this._textLines[e],r=this._getWidthOfWords(t,i,e),s=this.width-r,n=i.length-i.replace(/\s+/g,"").length,o=s/n;return this.__widthOfSpace[e]=o,o},_getWidthOfWords:function(t,e,i){for(var r=0,s=0;s<e.length;s++){var n=e[s];n.match(/\s/)||(r+=this._getWidthOfChar(t,n,i,s))}return r},_getHeightOfLine:function(t,e){if(this.__lineHeights[e])return this.__lineHeights[e];for(var i=this._textLines[e],r=this._getHeightOfChar(t,i[0],e,0),s=1,n=i.length;n>s;s++){var o=this._getHeightOfChar(t,i[s],e,s);o>r&&(r=o)}return this.__maxFontHeights[e]=r,this.__lineHeights[e]=r*this.lineHeight*this._fontSizeMult,this.__lineHeights[e]},_getTextHeight:function(t){for(var e=0,i=0,r=this._textLines.length;r>i;i++)e+=this._getHeightOfLine(t,i);return e},_renderTextBoxBackground:function(t){this.backgroundColor&&(t.save(),t.fillStyle=this.backgroundColor,t.fillRect(this._getLeftOffset(),this._getTopOffset(),this.width,this.height),t.restore())},toObject:function(e){return fabric.util.object.extend(this.callSuper("toObject",e),{styles:t(this.styles)})}}),fabric.IText.fromObject=function(e){return new fabric.IText(e.text,t(e))}}(),function(){var t=fabric.util.object.clone;fabric.util.object.extend(fabric.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation()},initSelectedHandler:function(){this.on("selected",function(){var t=this;setTimeout(function(){t.selected=!0},100)})},initAddedHandler:function(){var t=this;this.on("added",function(){this.canvas&&!this.canvas._hasITextHandlers&&(this.canvas._hasITextHandlers=!0,this._initCanvasHandlers()),t.canvas&&(t.canvas._iTextInstances=t.canvas._iTextInstances||[],t.canvas._iTextInstances.push(t))})},initRemovedHandler:function(){var t=this;this.on("removed",function(){t.canvas&&(t.canvas._iTextInstances=t.canvas._iTextInstances||[],fabric.util.removeFromArray(t.canvas._iTextInstances,t))})},_initCanvasHandlers:function(){var t=this;this.canvas.on("selection:cleared",function(){fabric.IText.prototype.exitEditingOnOthers(t.canvas)}),this.canvas.on("mouse:up",function(){t.canvas._iTextInstances&&t.canvas._iTextInstances.forEach(function(t){t.__isMousedown=!1})}),this.canvas.on("object:selected",function(){fabric.IText.prototype.exitEditingOnOthers(t.canvas)})},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(t,e,i,r){var s;return s={isAborted:!1,abort:function(){this.isAborted=!0}},t.animate("_currentCursorOpacity",e,{duration:i,onComplete:function(){s.isAborted||t[r]()},onChange:function(){t.canvas&&(t.canvas.clearContext(t.canvas.contextTop||t.ctx),t.renderCursorOrSelection())},abort:function(){return s.isAborted}}),s},_onTickComplete:function(){var t=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){t._currentTickCompleteState=t._animateCursor(t,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(t){var e=this,i=t?0:this.cursorDelay;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),this._currentCursorOpacity=1,this.canvas&&(this.canvas.clearContext(this.canvas.contextTop||this.ctx),this.renderCursorOrSelection()),this._cursorTimeout2&&clearTimeout(this._cursorTimeout2),this._cursorTimeout2=setTimeout(function(){e._tick()},i)},abortCursorAnimation:function(){this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,this.canvas&&this.canvas.clearContext(this.canvas.contextTop||this.ctx)},selectAll:function(){this.setSelectionStart(0),this.setSelectionEnd(this.text.length)},getSelectedText:function(){return this.text.slice(this.selectionStart,this.selectionEnd)},findWordBoundaryLeft:function(t){var e=0,i=t-1;if(this._reSpace.test(this.text.charAt(i)))for(;this._reSpace.test(this.text.charAt(i));)e++,i--;for(;/\S/.test(this.text.charAt(i))&&i>-1;)e++,i--;return t-e},findWordBoundaryRight:function(t){var e=0,i=t;if(this._reSpace.test(this.text.charAt(i)))for(;this._reSpace.test(this.text.charAt(i));)e++,i++;for(;/\S/.test(this.text.charAt(i))&&i<this.text.length;)e++,i++;return t+e},findLineBoundaryLeft:function(t){for(var e=0,i=t-1;!/\n/.test(this.text.charAt(i))&&i>-1;)e++,i--;return t-e},findLineBoundaryRight:function(t){for(var e=0,i=t;!/\n/.test(this.text.charAt(i))&&i<this.text.length;)e++,i++;return t+e},getNumNewLinesInSelectedText:function(){for(var t=this.getSelectedText(),e=0,i=0,r=t.length;r>i;i++)"\n"===t[i]&&e++;return e},searchWordBoundary:function(t,e){for(var i=this._reSpace.test(this.text.charAt(t))?t-1:t,r=this.text.charAt(i),s=/[ \n\.,;!\?\-]/;!s.test(r)&&i>0&&i<this.text.length;)i+=e,r=this.text.charAt(i);return s.test(r)&&"\n"!==r&&(i+=1===e?0:1),i},selectWord:function(t){var e=this.searchWordBoundary(t,-1),i=this.searchWordBoundary(t,1);this.setSelectionStart(e),this.setSelectionEnd(i)},selectLine:function(t){var e=this.findLineBoundaryLeft(t),i=this.findLineBoundaryRight(t);this.setSelectionStart(e),this.setSelectionEnd(i)},enterEditing:function(){return!this.isEditing&&this.editable?(this.canvas&&this.exitEditingOnOthers(this.canvas),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._tick(),this.fire("editing:entered"),this.canvas?(this.canvas.renderAll(),this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this):this):void 0},exitEditingOnOthers:function(t){t._iTextInstances&&t._iTextInstances.forEach(function(t){t.selected=!1,t.isEditing&&t.exitEditing()})},initMouseMoveHandler:function(){var t=this;this.canvas.on("mouse:move",function(e){if(t.__isMousedown&&t.isEditing){var i=t.getSelectionStartFromPointer(e.e);i>=t.__selectionStartOnMouseDown?(t.setSelectionStart(t.__selectionStartOnMouseDown),t.setSelectionEnd(i)):(t.setSelectionStart(i),t.setSelectionEnd(t.__selectionStartOnMouseDown))}})},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},_updateTextarea:function(){this.hiddenTextarea&&(this.hiddenTextarea.value=this.text,this.hiddenTextarea.selectionStart=this.selectionStart,this.hiddenTextarea.selectionEnd=this.selectionEnd)},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.overCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){return this.selected=!1,this.isEditing=!1,this.selectable=!0,this.selectionEnd=this.selectionStart,this.hiddenTextarea&&this.canvas&&this.hiddenTextarea.parentNode.removeChild(this.hiddenTextarea),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this.fire("editing:exited"),this.canvas&&this.canvas.fire("text:editing:exited",{target:this}),this},_removeExtraneousStyles:function(){for(var t in this.styles)this._textLines[t]||delete this.styles[t]},_removeCharsFromTo:function(t,e){for(;e!==t;)this._removeSingleCharAndStyle(t+1),e--;this.setSelectionStart(t)},_removeSingleCharAndStyle:function(t){var e="\n"===this.text[t-1],i=e?t:t-1;this.removeStyleObject(e,i),this.text=this.text.slice(0,t-1)+this.text.slice(t),this._textLines=this.text.split(this._reNewline)},insertChars:function(t,e){this.selectionEnd-this.selectionStart>1&&(this._removeCharsFromTo(this.selectionStart,this.selectionEnd),this.setSelectionEnd(this.selectionStart));var i="\n"===this.text[this.selectionStart];this.text=this.text.slice(0,this.selectionStart)+t+this.text.slice(this.selectionEnd),this.insertStyleObjects(t,i,e),this.setSelectionStart(this.selectionStart+t.length),this.setSelectionEnd(this.selectionStart),this.canvas&&this.canvas.renderAll(),this.setCoords(),this.fire("changed"),this.canvas&&this.canvas.fire("text:changed",{target:this})},insertNewlineStyleObject:function(e,i,r){this.shiftLineStyles(e,1),this.styles[e+1]||(this.styles[e+1]={});var s={},n={};if(this.styles[e]&&this.styles[e][i-1]&&(s=this.styles[e][i-1]),r)n[0]=t(s),this.styles[e+1]=n;else{for(var o in this.styles[e])parseInt(o,10)>=i&&(n[parseInt(o,10)-i]=this.styles[e][o],delete this.styles[e][o]);this.styles[e+1]=n}this._clearCache()},insertCharStyleObject:function(e,i,r){var s=this.styles[e],n=t(s);0!==i||r||(i=1);for(var o in n){var a=parseInt(o,10);a>=i&&(s[a+1]=n[a])}this.styles[e][i]=r||t(s[i-1]),this._clearCache()},insertStyleObjects:function(t,e,i){var r=this.get2DCursorLocation(),s=r.lineIndex,n=r.charIndex;this.styles[s]||(this.styles[s]={}),"\n"===t?this.insertNewlineStyleObject(s,n,e):i?this._insertStyles(this.copiedStyles):this.insertCharStyleObject(s,n)},_insertStyles:function(t){for(var e=0,i=t.length;i>e;e++){var r=this.get2DCursorLocation(this.selectionStart+e),s=r.lineIndex,n=r.charIndex;this.insertCharStyleObject(s,n,t[e])}},shiftLineStyles:function(e,i){var r=t(this.styles);for(var s in this.styles){var n=parseInt(s,10);n>e&&(this.styles[n+i]=r[n],r[n-i]||delete this.styles[n])}},removeStyleObject:function(e,i){var r=this.get2DCursorLocation(i),s=r.lineIndex,n=r.charIndex;if(e){var o=this._textLines[s-1],a=o?o.length:0;this.styles[s-1]||(this.styles[s-1]={});for(n in this.styles[s])this.styles[s-1][parseInt(n,10)+a]=this.styles[s][n];this.shiftLineStyles(s,-1)}else{var h=this.styles[s];h&&delete h[n];var c=t(h);for(var l in c){var u=parseInt(l,10);u>=n&&0!==u&&(h[u-1]=c[u],delete h[u])}}},insertNewline:function(){this.insertChars("\n")}})}(),fabric.util.object.extend(fabric.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown.bind(this))},onMouseDown:function(t){this.__newClickTime=+new Date;var e=this.canvas.getPointer(t.e);this.isTripleClick(e)?(this.fire("tripleclick",t),this._stopEvent(t.e)):this.isDoubleClick(e)&&(this.fire("dblclick",t),this._stopEvent(t.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected},isDoubleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y&&this.__lastIsEditing},isTripleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y},_stopEvent:function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()},initCursorSelectionHandlers:function(){this.initSelectedHandler(),this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},initClicks:function(){this.on("dblclick",function(t){this.selectWord(this.getSelectionStartFromPointer(t.e))}),this.on("tripleclick",function(t){this.selectLine(this.getSelectionStartFromPointer(t.e))})},initMousedownHandler:function(){this.on("mousedown",function(t){var e=this.canvas.getPointer(t.e);this.__mousedownX=e.x,this.__mousedownY=e.y,this.__isMousedown=!0,this.hiddenTextarea&&this.canvas&&this.canvas.wrapperEl.appendChild(this.hiddenTextarea),this.selected&&this.setCursorByClick(t.e),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.initDelayedCursor(!0))})},_isObjectMoved:function(t){var e=this.canvas.getPointer(t);return this.__mousedownX!==e.x||this.__mousedownY!==e.y},initMouseupHandler:function(){this.on("mouseup",function(t){this.__isMousedown=!1,this._isObjectMoved(t.e)||(this.__lastSelected&&(this.enterEditing(),this.initDelayedCursor(!0)),this.selected=!0)})},setCursorByClick:function(t){var e=this.getSelectionStartFromPointer(t);t.shiftKey?e<this.selectionStart?(this.setSelectionEnd(this.selectionStart),this.setSelectionStart(e)):this.setSelectionEnd(e):(this.setSelectionStart(e),this.setSelectionEnd(e))},_getLocalRotatedPointer:function(t){var e=this.canvas.getPointer(t),i=new fabric.Point(e.x,e.y),r=new fabric.Point(this.left,this.top),s=fabric.util.rotatePoint(i,r,fabric.util.degreesToRadians(-this.angle));return this.getLocalPointer(t,s)},getSelectionStartFromPointer:function(t){for(var e,i,r=this._getLocalRotatedPointer(t),s=0,n=0,o=0,a=0,h=0,c=this._textLines.length;c>h;h++){i=this._textLines[h],o+=this._getHeightOfLine(this.ctx,h)*this.scaleY;var l=this._getLineWidth(this.ctx,h),u=this._getLineLeftOffset(l);n=u*this.scaleX,this.flipX&&(this._textLines[h]=i.reverse().join(""));for(var f=0,d=i.length;d>f;f++){if(s=n,n+=this._getWidthOfChar(this.ctx,i[f],h,this.flipX?d-f:f)*this.scaleX,!(o<=r.y||n<=r.x))return this._getNewSelectionStartFromOffset(r,s,n,a+h,d);a++}if(r.y<o)return this._getNewSelectionStartFromOffset(r,s,n,a+h,d)}return"undefined"==typeof e?this.text.length:void 0},_getNewSelectionStartFromOffset:function(t,e,i,r,s){var n=t.x-e,o=i-t.x,a=o>n?0:1,h=r+a;return this.flipX&&(h=s-h),h>this.text.length&&(h=this.text.length),h}}),fabric.util.object.extend(fabric.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=fabric.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.style.cssText="position: fixed; bottom: 20px; left: 0px; opacity: 0; width: 0px; height: 0px; z-index: -999;",fabric.document.body.appendChild(this.hiddenTextarea),fabric.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),fabric.util.addListener(this.hiddenTextarea,"keypress",this.onKeyPress.bind(this)),fabric.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),fabric.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(fabric.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},_keysMap:{8:"removeChars",9:"exitEditing",27:"exitEditing",13:"insertNewline",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown",46:"forwardDelete"},_ctrlKeysMap:{65:"selectAll",88:"cut"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(t){if(this.isEditing){if(t.keyCode in this._keysMap)this[this._keysMap[t.keyCode]](t);else{if(!(t.keyCode in this._ctrlKeysMap&&(t.ctrlKey||t.metaKey)))return;this[this._ctrlKeysMap[t.keyCode]](t)}t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.renderAll()}},forwardDelete:function(t){this.selectionStart===this.selectionEnd&&this.moveCursorRight(t),this.removeChars(t)},copy:function(t){var e=this.getSelectedText(),i=this._getClipboardData(t);i&&i.setData("text",e),this.copiedText=e,this.copiedStyles=this.getSelectionStyles(this.selectionStart,this.selectionEnd)},paste:function(t){var e=null,i=this._getClipboardData(t);e=i?i.getData("text"):this.copiedText,e&&this.insertChars(e,!0)},cut:function(t){this.selectionStart!==this.selectionEnd&&(this.copy(),this.removeChars(t))},_getClipboardData:function(t){return t&&(t.clipboardData||fabric.window.clipboardData)},onKeyPress:function(t){!this.isEditing||t.metaKey||t.ctrlKey||(0!==t.which&&this.insertChars(String.fromCharCode(t.which)),t.stopPropagation())},getDownCursorOffset:function(t,e){var i,r,s=e?this.selectionEnd:this.selectionStart,n=this.get2DCursorLocation(s),o=n.lineIndex,a=this._textLines[o].slice(0,n.charIndex),h=this._textLines[o].slice(n.charIndex),c=this._textLines[o+1]||"";if(o===this._textLines.length-1||t.metaKey||34===t.keyCode)return this.text.length-s;var l=this._getLineWidth(this.ctx,o);r=this._getLineLeftOffset(l);for(var u=r,f=0,d=a.length;d>f;f++)i=a[f],u+=this._getWidthOfChar(this.ctx,i,o,f);var g=this._getIndexOnNextLine(n,c,u);return h.length+1+g},_getIndexOnNextLine:function(t,e,i){for(var r,s=t.lineIndex+1,n=this._getLineWidth(this.ctx,s),o=this._getLineLeftOffset(n),a=o,h=0,c=0,l=e.length;l>c;c++){var u=e[c],f=this._getWidthOfChar(this.ctx,u,s,c);if(a+=f,a>i){r=!0;var d=a-f,g=a,p=Math.abs(d-i),v=Math.abs(g-i);h=p>v?c+1:c;break}}return r||(h=e.length),h},moveCursorDown:function(t){this.abortCursorAnimation(),this._currentCursorOpacity=1;var e=this.getDownCursorOffset(t,"right"===this._selectionDirection);t.shiftKey?this.moveCursorDownWithShift(e):this.moveCursorDownWithoutShift(e),this.initDelayedCursor()},moveCursorDownWithoutShift:function(t){this._selectionDirection="right",this.setSelectionStart(this.selectionStart+t),this.setSelectionEnd(this.selectionStart)},swapSelectionPoints:function(){var t=this.selectionEnd;this.setSelectionEnd(this.selectionStart),this.setSelectionStart(t)},moveCursorDownWithShift:function(t){this.selectionEnd===this.selectionStart&&(this._selectionDirection="right"),"right"===this._selectionDirection?this.setSelectionEnd(this.selectionEnd+t):this.setSelectionStart(this.selectionStart+t),this.selectionEnd<this.selectionStart&&"left"===this._selectionDirection&&(this.swapSelectionPoints(),this._selectionDirection="right"),this.selectionEnd>this.text.length&&this.setSelectionEnd(this.text.length)},getUpCursorOffset:function(t,e){var i=e?this.selectionEnd:this.selectionStart,r=this.get2DCursorLocation(i),s=r.lineIndex;if(0===s||t.metaKey||33===t.keyCode)return i;for(var n,o=this._textLines[s].slice(0,r.charIndex),a=this._textLines[s-1]||"",h=this._getLineWidth(this.ctx,r.lineIndex),c=this._getLineLeftOffset(h),l=c,u=0,f=o.length;f>u;u++)n=o[u],l+=this._getWidthOfChar(this.ctx,n,s,u);var d=this._getIndexOnPrevLine(r,a,l);return a.length-d+o.length},_getIndexOnPrevLine:function(t,e,i){for(var r,s=t.lineIndex-1,n=this._getLineWidth(this.ctx,s),o=this._getLineLeftOffset(n),a=o,h=0,c=0,l=e.length;l>c;c++){var u=e[c],f=this._getWidthOfChar(this.ctx,u,s,c);if(a+=f,a>i){r=!0;var d=a-f,g=a,p=Math.abs(d-i),v=Math.abs(g-i);h=p>v?c:c-1;break}}return r||(h=e.length-1),h},moveCursorUp:function(t){this.abortCursorAnimation(),this._currentCursorOpacity=1;var e=this.getUpCursorOffset(t,"right"===this._selectionDirection);t.shiftKey?this.moveCursorUpWithShift(e):this.moveCursorUpWithoutShift(e),this.initDelayedCursor()},moveCursorUpWithShift:function(t){this.selectionEnd===this.selectionStart&&(this._selectionDirection="left"),"right"===this._selectionDirection?this.setSelectionEnd(this.selectionEnd-t):this.setSelectionStart(this.selectionStart-t),this.selectionEnd<this.selectionStart&&"right"===this._selectionDirection&&(this.swapSelectionPoints(),this._selectionDirection="left")},moveCursorUpWithoutShift:function(t){this.selectionStart===this.selectionEnd&&this.setSelectionStart(this.selectionStart-t),this.setSelectionEnd(this.selectionStart),this._selectionDirection="left"},moveCursorLeft:function(t){(0!==this.selectionStart||0!==this.selectionEnd)&&(this.abortCursorAnimation(),this._currentCursorOpacity=1,t.shiftKey?this.moveCursorLeftWithShift(t):this.moveCursorLeftWithoutShift(t),this.initDelayedCursor())},_move:function(t,e,i){var r="selectionStart"===e?"setSelectionStart":"setSelectionEnd";this[r](t.altKey?this["findWordBoundary"+i](this[e]):t.metaKey||35===t.keyCode||36===t.keyCode?this["findLineBoundary"+i](this[e]):this[e]+("Left"===i?-1:1))},_moveLeft:function(t,e){this._move(t,e,"Left")},_moveRight:function(t,e){this._move(t,e,"Right")},moveCursorLeftWithoutShift:function(t){this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this._moveLeft(t,"selectionStart"),this.setSelectionEnd(this.selectionStart)},moveCursorLeftWithShift:function(t){"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):(this._selectionDirection="left",this._moveLeft(t,"selectionStart"))},moveCursorRight:function(t){this.selectionStart>=this.text.length&&this.selectionEnd>=this.text.length||(this.abortCursorAnimation(),this._currentCursorOpacity=1,t.shiftKey?this.moveCursorRightWithShift(t):this.moveCursorRightWithoutShift(t),this.initDelayedCursor())},moveCursorRightWithShift:function(t){"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):(this._selectionDirection="right",this._moveRight(t,"selectionEnd"))},moveCursorRightWithoutShift:function(t){this._selectionDirection="right",this.selectionStart===this.selectionEnd?(this._moveRight(t,"selectionStart"),this.setSelectionEnd(this.selectionStart)):(this.setSelectionEnd(this.selectionEnd+this.getNumNewLinesInSelectedText()),this.setSelectionStart(this.selectionEnd))},removeChars:function(t){this.selectionStart===this.selectionEnd?this._removeCharsNearCursor(t):this._removeCharsFromTo(this.selectionStart,this.selectionEnd),this.setSelectionEnd(this.selectionStart),this._removeExtraneousStyles(),this._clearCache(),this.canvas&&this.canvas.renderAll(),this.setCoords(),this.fire("changed"),this.canvas&&this.canvas.fire("text:changed",{target:this})},_removeCharsNearCursor:function(t){if(0!==this.selectionStart)if(t.metaKey){var e=this.findLineBoundaryLeft(this.selectionStart);this._removeCharsFromTo(e,this.selectionStart),this.setSelectionStart(e)}else if(t.altKey){var i=this.findWordBoundaryLeft(this.selectionStart);this._removeCharsFromTo(i,this.selectionStart),this.setSelectionStart(i)}else this._removeSingleCharAndStyle(this.selectionStart),this.setSelectionStart(this.selectionStart-1)}}),function(){var t=fabric.util.toFixed,e=fabric.Object.NUM_FRACTION_DIGITS;fabric.util.object.extend(fabric.IText.prototype,{_setSVGTextLineText:function(t,e,i,r,s,n){this.styles[t]?this._setSVGTextLineChars(t,e,i,r,n):this.callSuper("_setSVGTextLineText",t,e,i,r,s)},_setSVGTextLineChars:function(t,e,i,r,s){for(var n=this._textLines[t],o=0,a=this._getSVGLineLeftOffset(t)-this.width/2,h=this._getSVGLineTopOffset(t),c=this._getHeightOfLine(this.ctx,t),l=0,u=n.length;u>l;l++){var f=this.styles[t][l]||{};e.push(this._createTextCharSpan(n[l],f,a,h.lineTop+h.offset,o));var d=this._getWidthOfChar(this.ctx,n[l],t,l);f.textBackgroundColor&&s.push(this._createTextCharBg(f,a,h.lineTop,c,d,o)),o+=d}},_getSVGLineLeftOffset:function(t){return fabric.util.toFixed(this._getLineLeftOffset(this.__lineWidths[t]),2)},_getSVGLineTopOffset:function(t){for(var e=0,i=0,r=0;t>r;r++)e+=this._getHeightOfLine(this.ctx,r);return i=this._getHeightOfLine(this.ctx,r),{lineTop:e,offset:(this._fontSizeMult-this._fontSizeFraction)*i/(this.lineHeight*this._fontSizeMult)}},_createTextCharBg:function(i,r,s,n,o,a){return['<rect fill="',i.textBackgroundColor,'" x="',t(r+a,e),'" y="',t(s-this.height/2,e),'" width="',t(o,e),'" height="',t(n/this.lineHeight,e),'"></rect>'].join("")},_createTextCharSpan:function(t,e,i,r,s){var n=this.getSvgStyles.call(fabric.util.object.extend({visible:!0,fill:this.fill,stroke:this.stroke,type:"text"},e));return['<tspan x="',i+s,'" y="',r-this.height/2,'" ',e.fontFamily?'font-family="'+e.fontFamily.replace(/"/g,"'")+'" ':"",e.fontSize?'font-size="'+e.fontSize+'" ':"",e.fontStyle?'font-style="'+e.fontStyle+'" ':"",e.fontWeight?'font-weight="'+e.fontWeight+'" ':"",e.textDecoration?'text-decoration="'+e.textDecoration+'" ':"",'style="',n,'">',fabric.util.string.escapeXml(t),"</tspan>"].join("");

}})}(),function(){function request(t,e,i){var r=URL.parse(t);r.port||(r.port=0===r.protocol.indexOf("https:")?443:80);var s=0===r.protocol.indexOf("https:")?HTTPS:HTTP,n=s.request({hostname:r.hostname,port:r.port,path:r.path,method:"GET"},function(t){var r="";e&&t.setEncoding(e),t.on("end",function(){i(r)}),t.on("data",function(e){200===t.statusCode&&(r+=e)})});n.on("error",function(t){fabric.log(t.errno===process.ECONNREFUSED?"ECONNREFUSED: connection refused to "+r.hostname+":"+r.port:t.message),i(null)}),n.end()}function requestFs(t,e){var i=require("fs");i.readFile(t,function(t,i){if(t)throw fabric.log(t),t;e(i)})}if("undefined"==typeof document||"undefined"==typeof window){var DOMParser=require("xmldom").DOMParser,URL=require("url"),HTTP=require("http"),HTTPS=require("https"),Canvas=require("canvas"),Image=require("canvas").Image;fabric.util.loadImage=function(t,e,i){function r(r){r?(s.src=new Buffer(r,"binary"),s._src=t,e&&e.call(i,s)):(s=null,e&&e.call(i,null,!0))}var s=new Image;t&&(t instanceof Buffer||0===t.indexOf("data"))?(s.src=s._src=t,e&&e.call(i,s)):t&&0!==t.indexOf("http")?requestFs(t,r):t?request(t,"binary",r):e&&e.call(i,t)},fabric.loadSVGFromURL=function(t,e,i){t=t.replace(/^\n\s*/,"").replace(/\?.*$/,"").trim(),0!==t.indexOf("http")?requestFs(t,function(t){fabric.loadSVGFromString(t.toString(),e,i)}):request(t,"",function(t){fabric.loadSVGFromString(t,e,i)})},fabric.loadSVGFromString=function(t,e,i){var r=(new DOMParser).parseFromString(t);fabric.parseSVGDocument(r.documentElement,function(t,i){e&&e(t,i)},i)},fabric.util.getScript=function(url,callback){request(url,"",function(body){eval(body),callback&&callback()})},fabric.Image.fromObject=function(t,e){fabric.util.loadImage(t.src,function(i){var r=new fabric.Image(i);r._initConfig(t),r._initFilters(t.filters,function(i){r.filters=i||[],r._initFilters(t.resizeFilters,function(t){r.resizeFilters=t||[],e&&e(r)})})})},fabric.createCanvasForNode=function(t,e,i,r){r=r||i;var s=fabric.document.createElement("canvas"),n=new Canvas(t||600,e||600,r);s.style={},s.width=n.width,s.height=n.height;var o=fabric.Canvas||fabric.StaticCanvas,a=new o(s,i);return a.contextContainer=n.getContext("2d"),a.nodeCanvas=n,a.Font=Canvas.Font,a},fabric.StaticCanvas.prototype.createPNGStream=function(){return this.nodeCanvas.createPNGStream()},fabric.StaticCanvas.prototype.createJPEGStream=function(t){return this.nodeCanvas.createJPEGStream(t)};var origSetWidth=fabric.StaticCanvas.prototype.setWidth;fabric.StaticCanvas.prototype.setWidth=function(t,e){return origSetWidth.call(this,t,e),this.nodeCanvas.width=t,this},fabric.Canvas&&(fabric.Canvas.prototype.setWidth=fabric.StaticCanvas.prototype.setWidth);var origSetHeight=fabric.StaticCanvas.prototype.setHeight;fabric.StaticCanvas.prototype.setHeight=function(t,e){return origSetHeight.call(this,t,e),this.nodeCanvas.height=t,this},fabric.Canvas&&(fabric.Canvas.prototype.setHeight=fabric.StaticCanvas.prototype.setHeight)}}();
'use strict';

angular.module('ImageEditor', ['ngMaterial', 'ngAnimate', 'ui.sortable', 'image.crop', 'image.text', 'image.drawing', 'image.filters', 'image.shapes', 'image.directives', 'image.basics'])

.config(['$mdThemingProvider', function($mdThemingProvider) {
    $mdThemingProvider.theme('default')
        .primaryPalette('deep-orange')
        .accentPalette('brown'); 
}])

.controller('MainController', ['$rootScope', '$scope', '$timeout', '$$rAF', '$mdBottomSheet', 'canvas', 'history', 'simpleShapes', 'filters', function($rootScope, $scope, $timeout, $$rAF, $mdBottomSheet, canvas, history, simpleShapes, filters) {

    //true after user uploads an image or create a new canvas
    $rootScope.started = false;

    //check if we're on a demo site
    $rootScope.isDemo = document.URL.indexOf('pixie.vebto.com') > -1;

    $rootScope.isIntegrationMode = false; 
    var params = location.search.substring(1).split('&');
    var values = {};
    for(var id in params){
        var key_value = params[id].split('=');
        values[key_value[0]] = key_value[1];
    }
    $rootScope.order_id =values['order_id'];
    $rootScope.product_id = values['product_id'];

    //check if we're running in integration mode
    try {
        if (window.self !== window.top) { 
            $('script', window.parent.document).each(function(i, node) {
                if (node.src.indexOf('pixie-integrate') > -1) {
                    $rootScope.isIntegrationMode = true;
                    return false;
                }
            });
        }
    } catch (e) {
        $rootScope.isIntegrationMode = false;
    }

    //get a reference to top window if we're inside iframe
    if ($rootScope.isIntegrationMode) {
        $rootScope.pixie = window.parent.Pixie;
    }

    $rootScope.getParam = function(name) {
        if ($rootScope.pixie) {
            return $rootScope.pixie.getParams()[name];
        } else if (window.PixieParams) {
            return window.PixieParams[name];
        }
    };

    canvas.start();

    //make actions panels draggable
    $('.actions-menu').draggable({
        handle: '.menu-header',
        containment: 'body'
    });

	$rootScope.canvas = canvas;
	$rootScope.history = history;
    if(values['order_id']!='' && values['product_id']!=''){
        //"/wp-content/uploads/wineshop-labels/"+$rootScope.order_id + "-" + $rootScope.product_id+".json"

        // TODO: Convert straight file load to an AJAX request?
        jQuery.getJSON("/wp-admin/admin-ajax.php", {
            action: "wineshop_label_load",
            order_id: $rootScope.order_id,
            product_id: $rootScope.product_id
        })
            .done(function( data ) {
                console.log( "Existing JSON Found!" );
                $scope.history = data;
                $rootScope.history = data;
                history.load(data);
            })
            .fail(function() {
                console.log("No Existing JSON Found");
                canvas.openNew(1157, 1228);
                $rootScope.isNotLoading();
                jQuery(".btn-help").trigger("click");
                console.log("Showing Help Modal");
            });

        /*jQuery.getJSON("/wp-content/uploads/wineshop-labels/"+$rootScope.order_id + "-" + $rootScope.product_id+".json",function(data){
            $scope.history = data;
            $rootScope.history = data;
            history.load(data);

        }).fail(function(){
            canvas.openNew(1157, 1228);
        });*/

    }else{
        canvas.openNew(1157, 1228);
    }
    // console.log(canvas.fabric);

    // setTimeout(function(){
    //     if(!canvas.fabric.backgroundColor || canvas.fabric.backgroundColor==''){
    //         //canvas.fabric.backgroundColor = '#ffffff';
    //     }
    //     $rootScope.bgColor = canvas.fabric.backgroundColor;
    // }, 1000);

    $rootScope.shapes = simpleShapes;
	$rootScope.loading = false;
    $rootScope.animationEndEvent = 'webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend';
    $rootScope.transitionEndEvent = 'webkitTransitionEnd mozTransitionEnd MSTransitionEnd oatransitionend atransitionend transitionend';

    $rootScope.maxPanelHeight = $(window).height() - 120;

    $rootScope.openPanel = function(name, e) {
        if ($rootScope.activePanel === name) return;

        if(name=='canvasColor'){
            console.log(canvas);
            if(!canvas.fabric.backgroundColor || canvas.fabric.backgroundColor==''){
                canvas.fabric.setBackgroundColor('#ffffff');
                canvas.fabric.renderAll();
            }
            $rootScope.bgColor = canvas.fabric.backgroundColor;
            console.log(canvas);
            $("#cvs-bgcolor").spectrum("set", $rootScope.bgColor);
        }

        $rootScope.activePanel = name;

        var panel = $('[data-name="'+name+'"]');

        var clickRect = e.target.getBoundingClientRect();
        var panelRect = panel[0].getBoundingClientRect();

        var scaleX = Math.min(0.5, clickRect.width / panelRect.width);
        var scaleY = Math.min(0.5, clickRect.height / panelRect.height);

        panel.removeClass('transition-in').css('transform', 'translate3d(' +
            (-panelRect.left + clickRect.left + clickRect.width/2 - panelRect.width/2) + 'px,' +
            (-panelRect.top + clickRect.top + clickRect.height/2 - panelRect.height/2) + 'px,' +
            '0) scale(' + scaleX + ',' + scaleY + ')'
        );

        $$rAF(function() {
            $(panel).addClass('transition-in').css('transform', '');
        });
    };

	$rootScope.isLoading = function() {
		$timeout(function() {
			$rootScope.loading = true;
		});
	};

	$rootScope.isNotLoading = function() {
		$timeout(function() {
			$rootScope.loading = false;
		});
	};

	$rootScope.activePanel = false;
    $rootScope.activeTab   = false;

	$rootScope.keys = {
		google_fonts: 'AIzaSyDhc_8NKxXjtv69htFcUPe6A7oGSQ4om2o',
	};

	$rootScope.$watch('activePanel', function() {
		setTimeout(function () {
			$(window).resize(); 
		}, 100);
	});
    
    $rootScope.resetUI = function() {
        $timeout(function() {
            $rootScope.activePanel = null;
            $rootScope.activeTab   = 'basics';
            simpleShapes.selected  = null;
            filters.appliedFilters = [];
            $rootScope.history.all = [];
        });
    };

    //open corresponding tab in left panel when user selects an object
    canvas.fabric.on('object:selected', function(e) {
        if (e.target.name == 'text') {
            $rootScope.activeTab = 'text';
        } else if (e.target.name == 'sticker' && $rootScope.activeTab !== 'stickers') {
            $rootScope.activeTab = 'stickers';
        } else if (e.target.name && $rootScope.activeTab !== 'simple-shapes') {
            for (var i = 0; i < simpleShapes.available.length; i++) {
                var shape = simpleShapes.available[i];

                if (shape.name === e.target.name && $rootScope.activeTab !== 'simple-shapes') {
                    simpleShapes.selected = shape;
                    $rootScope.activeTab = 'simple-shapes';
                }
            }
        }

        $timeout(angular.noop);
    });

    //Close object panel when object is de-selected
    canvas.fabric.on('selection:cleared', function() {
        $timeout(angular.noop);
    });

    //deselect all objects when clicking outside canvas
    $('#viewport').on('click', function(e) {
        if (e.target.id === 'viewport') {
            console.log("viewport");
            $timeout(function() {
                canvas.fabric.deactivateAll().renderAll();
            });
        }
    });

    $scope.openBottomSheet = function(name) {
        $mdBottomSheet.show({
            template: $('#'+name+'-sheet-template').html(),
            controller: 'BottomSheetController'
        });
    }; 

    //cleanup. remove color picker containers on scope destroy.
    $scope.$on('$destroy', function() {
        $('.sp-container').remove();
    });

     $rootScope.spacify = function(text) {
        if (text) {
            var temp = text.replace( /([A-Z])/g, " $1" );
            return temp.charAt(0).toUpperCase() + temp.slice(1);
        }
     };


}])

.controller('BottomSheetController', ['$rootScope', '$scope', '$mdBottomSheet', '$mdDialog', 'simpleShapes', function($rootScope, $scope, $mdBottomSheet, $mdDialog, simpleShapes) {
    $scope.shapes = simpleShapes;

    $scope.showDialog = function($event) {
        $mdDialog.show({
            template: $('#texture-upload-dialog-template').html(),
            targetEvent: $event,
            controller: 'BottomSheetController'
        });
    }
}]);
angular.module('ImageEditor')

.factory('localStorage', function() {
	var storage = {

		/**
		 * How long (days) data will be cached in local storage.
		 * 
		 * @type {Number}
		 */
		expireAfter: 2,

		/**
		 * Retrieve value under given key from local storage.
		 * 
		 * @param  string key
		 * @return mixed
		 */
		get: function(key) {
			var value = JSON.parse(localStorage.getItem(key));
			
			if ( ! value || ! storage.isValid(value.time)) {
				return false;
			}

			return value.value;
		},

		/**
		 * Store value into browser local storage.
		 * 
		 * @param string key
		 * @param mixed value
		 */
		set: function(key, value) {
			var data = { value: value, time: new Date().getTime() };

			return localStorage.setItem(key, JSON.stringify(data));
		},

		/**
		 * Whether or not cache with given time is considered expired.
		 * 
		 * @param  string  time
		 * @return {Boolean}
		 */
		isValid: function(time) {
			var days = (new Date().getTime() - new Date(time).getTime())/(1000*60*60*24);

			return days < storage.expireAfter;
		}
	};

	return storage;
});
'use strict';

angular.module('ImageEditor').factory('settings', ['$rootScope', '$http', function($rootScope, $http) {

	var settings = {
        all: {},

        get: function(name) {
            return this.all[name];
        }
	}

    $http.get('/wp-admin/admin-ajax.php?action=wineshop_label_get_photos_and_stickers').success(function(data) {
        settings.all = data;

        $rootScope.$emit('settings.ready');
    });

	return settings;
}]);
'use strict';

angular.module('ImageEditor')

.factory('keybinds', ['$rootScope', function($rootScope) {

    var keybinds = {

        fabric: false,

        init: function(fabric) {
            this.fabric = fabric;
            init();
        },

        destroy: function() {
            $('.canvas-container').off("keydown", processKeys, false);
        }
    };

    function init() {
        $(document).on('keydown', handleKeyDown);
    }

    function handleKeyDown(e) {
        e = e || window.event;

        if ([37, 38, 39, 40].indexOf(e.keyCode) > -1) moveObject(e);
        if (e.keyCode === 46) deleteObject();

    }

    function deleteObject() {
        var activeObject = keybinds.fabric.getActiveObject();

        if (activeObject) {
            keybinds.fabric.remove(activeObject);
            keybinds.fabric.renderAll();
        }
    }

    function moveObject(e) {
        var movementDelta = 2;

        var activeObject = keybinds.fabric.getActiveObject();
        var activeGroup = keybinds.fabric.getActiveGroup();

        if (e.keyCode === 37) {
            e.preventDefault();
            if (activeObject) {
                var a = activeObject.get('left') - movementDelta;
                activeObject.set('left', a);
            }
            else if (activeGroup) {
                var a = activeGroup.get('left') - movementDelta;
                activeGroup.set('left', a);
            }

        } else if (e.keyCode === 39) {
            e.preventDefault();
            if (activeObject) {
                var a = activeObject.get('left') + movementDelta;
                activeObject.set('left', a);
            }
            else if (activeGroup) {
                var a = activeGroup.get('left') + movementDelta;
                activeGroup.set('left', a);
            }

        } else if (e.keyCode === 38) {
            e.preventDefault();
            if (activeObject) {
                var a = activeObject.get('top') - movementDelta;
                activeObject.set('top', a);
            }
            else if (activeGroup) {
                var a = activeGroup.get('top') - movementDelta;
                activeGroup.set('top', a);
            }

        } else if (e.keyCode === 40) {
            e.preventDefault();
            if (activeObject) {
                var a = activeObject.get('top') + movementDelta;
                activeObject.set('top', a);
            }
            else if (activeGroup) {
                var a = activeGroup.get('top') + movementDelta;
                activeGroup.set('top', a);
            }
        }

        if (activeObject) {
            activeObject.setCoords();
            keybinds.fabric.renderAll();
        } else if (activeGroup) {
            activeGroup.setCoords();
            keybinds.fabric.renderAll();
        }
    }

    return keybinds;
}]);
angular.module('ImageEditor')

.service('canvas', ['$rootScope', '$mdDialog', 'keybinds', function($rootScope, $mdDialog, keybinds) {

	var canvas = {

        original: {},

        //store window width and height so we don't execute
        //functions unnecessarily on resize event if they didn't change
        oldWindowDimensions: {
            width: window.innerWidth,
            height: window.innerHeight
        },

		mainImage: false,
		fabric: false,
		ctx: false,
		container: false,
		viewport: false,
		offset: false,
		element: false,

        minWidth: 50,
        minHeight: 50,

		imageStatic: {
            locked: true,
			selectable: false,
	      	evented: false,
	      	lockMovementX: true,
	      	lockMovementY: true,
	      	lockRotation: true,
	      	lockScalingX: true,
	      	lockScalingY: true,
	      	lockUniScaling: true,
	      	hasControls: false,
	      	hasBorders: false
		},

        destroy: function() {
            this.fabric.dispose();
            this.mainImage = false;
            this.fabric = false;
            this.ctx = false;
            this.container = false;
            this.viewport = false;
            this.offset = false;
            this.element = false;
            this.original = {};
            this.currentZoom = 1;
            $rootScope.editorCustomActions = {};
            $(window).off('resize');
            keybinds.destroy();
        },

		start: function(url) {
            this.element = document.getElementById('canvas');
            this.fabric = new fabric.Canvas('canvas');
            this.ctx = this.fabric.getContext('2d');
            this.container = $('.canvas-container');
            this.viewport = document.getElementById('viewport');
            $rootScope.editorCustomActions = {};

            this.fabric.selection = false; 
            this.fabric.renderOnAddRemove = false;

            if(!this.fabric.backgroundColor || this.fabric.backgroundColor==''){
                this.fabric.setBackgroundColor('#ffffff');
            }
            $rootScope.bgColor = this.fabric.backgroundColor;
            fabric.Object.prototype.borderColor = '#2196F3';
            fabric.Object.prototype.cornerColor = '#2196F3';
            fabric.Object.prototype.transparentCorners = false;

            if ( ! url) url = $rootScope.getParam('url');

            if (url) {
                this.loadMainImage(url);
                $rootScope.started = true;
            } else if ($rootScope.getParam('blankCanvasSize')) {
                var size = $rootScope.getParam('blankCanvasSize');
                this.openNew(size.width, size.height, 'newCanvas');
                $rootScope.started = true;
            }

            if ( ! $rootScope.started && ! $rootScope.isIntegrationMode && ! $rootScope.delayEditorStart) {
                /*$mdDialog.show({
                    template: $('#main-image-upload-dialog-template').html(),
                    controller: 'TopPanelController',
                    clickOutsideToClose: false
                });*/

                //$scope.createNewCanvas(500, 500)
                //canvas.openNew(500,500,"Unnamed");

                canvas.openNew(1157, 1228);
                $rootScope.started = true;
            }

            $(window).off('resize').on('resize', function(e) {
                if (canvas.oldWindowDimensions.height !== e.target.innerHeight ||
                    canvas.oldWindowDimensions.width !== e.target.innerWidth) {
                    canvas.fitToScreen();
                }

                canvas.oldWindowDimensions.width = e.target.innerWidth;
                canvas.oldWindowDimensions.height = e.target.innerHeight;
            });

            $rootScope.$emit('canvas.init');

            keybinds.init(this.fabric);

            if ($rootScope.getParam('onLoad')) {
                $rootScope.getParam('onLoad')(this.viewport, $rootScope, window); 
            }
        },

        hideModals: function() {
            $mdDialog.hide();
        },

        mergeObjects: function() {
            canvas.zoom(1);
            this.fabric.deactivateAll();
            var data = this.fabric.toDataURL();
            this.fabric.clear();
            this.loadMainImage(data);
        },

        loadFromJSON: function(design, callback) {
            canvas.fabric.loadFromJSON(design.serialized_editor_state || design.state, function() {
                canvas.fabric.forEachObject(function(obj) {

                    //reapply any filters object used to have
                    if (obj.applyFilters && obj.filters.length) {
                        obj.applyFilters(canvas.fabric.renderAll.bind(canvas.fabric));
                    }

                    //assign new reference to mainImage property
                    if (obj.name == 'mainImage') {
                        canvas.mainImage = obj;
                    }
                });

                if(!canvas.fabric.backgroundColor || canvas.fabric.backgroundColor==''){
                    canvas.fabric.setBackgroundColor('#ffffff');
                }
                $rootScope.bgColor = canvas.fabric.backgroundColor;

                if (design.width && design.height) {
                    canvas.fabric.setWidth(design.width);
                    canvas.fabric.setHeight(design.height);
                    canvas.original.height = design.height;
                    canvas.original.width = design.width;
                }

                canvas.fabric.renderAll();
                canvas.fabric.calcOffset();
                canvas.fitToScreen();
                $rootScope.$emit('history.loaded');

                callback && callback(design);
            });
        },

        /**
         * Create a new image with given dimensions.
         *
         * @param {int|string} width
         * @param {int|string} height
         * @param {string|undefined} name
         */
        openNew: function(width, height, name) {
            width = width < this.minWidth ? this.minWidth : width;
            height = height < this.minHeight ? this.minHeight : height;

            this.fabric.clear();
            this.fabric.setBackgroundColor('#ffffff');
            this.fabric.setWidth(width);
            this.fabric.setHeight(height);
            this.fabric.renderAll();
            canvas.fitToScreen();

            //save the dimensions so we can scale images opened later to them
            $rootScope.userPreset = {
                width: width,
                height: height,
                name: name
            };

            canvas.original.height = height;
            canvas.original.width = width;

            $rootScope.$emit('canvas.openedNew');
        },

        center: function(obj) {
            obj.center();

            if (canvas.zoom > 100) {
                obj.setLeft(10);
                obj.setTop(35);
            }

            obj.setCoords();
        },

        serialize: function() {
            return this.fabric.toJSON(['selectable', 'name']);
        },

		loadMainImage: function(url, height, width, dontFit, callback) {
			var object;

			fabric.util.loadImage(url, function (img) {
                //img.crossOrigin = 'anonymous';

			    object = new fabric.Image(img, canvas.imageStatic);
			    object.name = 'mainImage';

                if (width && height) {
                    object.width = width;
                    object.height = height;
                }

			    canvas.mainImage = object;

                canvas.fabric.forEachObject(function(obj) {
                    if (obj.name == 'mainImage') {
                        canvas.fabric.remove(obj);
                    }
                });
			    canvas.fabric.add(object);
			   	object.top = -0.5;
			   	object.left = -0.5;
			    object.moveTo(0);

			    canvas.fabric.setHeight(object.height);
			    canvas.fabric.setWidth(object.width);
                
                if(!canvas.fabric.backgroundColor || canvas.fabric.backgroundColor==''){
                    //canvas.fabric.setBackgroundColor('#ffffff');
                }
                $rootScope.bgColor = canvas.fabric.backgroundColor;

                canvas.original.height = object.height;
                canvas.original.width = object.width;

				if ( ! dontFit) {
                    canvas.fitToScreen();
                }

				$rootScope.$apply(function() {
					$rootScope.$emit('editor.mainImage.loaded');
				});

                if (callback) {
                    callback();
                }
			});
		},

        /**
         * Open image at given url in canvas.
         *
         * @param {string} url
         */
        openImage: function(url) {
            canvas.zoom(1);
            fabric.util.loadImage(url, function(image) {
                if ( ! image) return;

                var object = new fabric.Image(image);
                object.name = 'image';

                //use either main image or canvas dimensions as outter boundaries for scaling new image
                var maxWidth  = canvas.mainImage ? canvas.mainImage.getWidth() : canvas.fabric.getWidth(),
                    maxHeight = canvas.mainImage ? canvas.mainImage.getHeight() : canvas.fabric.getHeight();

                //if image is wider or heigher then the current canvas, we'll scale id down
                if (object.width >= maxWidth || object.height >= maxHeight) {

                    //calc new image dimensions (main image height - 10% and width - 10%)
                    var newWidth  = maxWidth - (0.1 * maxWidth),
                        newHeight = maxHeight - (0.1 * maxHeight),
                        scale     = 1 / (Math.min(newHeight / object.getHeight(), newWidth / object.getWidth()));

                    //scale newly uploaded image to the above dimesnsions
                    object.scaleX = object.scaleX * (1 / scale);
                    object.scaleY = object.scaleY * (1 / scale);
                }

                //center and render newly uploaded image on the canvas
                canvas.fabric.add(object);
                object.left = (canvas.fabric.getWidth() - object.getWidth()) / 2;
                object.top = (canvas.fabric.getHeight() - object.getHeight()) / 2;
                object.setCoords();
                canvas.fabric.setActiveObject(object);
                canvas.fabric.renderAll();

                canvas.fitToScreen();
            });
        },

        getDataURL: function(options) {
            if ( ! options) options = {};

            //ignore zoom when getting data url
            options.multiplier = 1 / canvas.currentZoom;

            return this.fabric.toDataURL(options);
        },

        currentZoom: 1,

        zoom: function(scaleFactor) {
            this.fabric.setZoom(scaleFactor);
            this.fabric.setHeight(this.original.height * scaleFactor);
            this.fabric.setWidth(this.original.width * scaleFactor);

            this.currentZoom = scaleFactor;
        },

        fitToScreen: function () {
            console.log("fitToScreen");
            var maxWidth  = canvas.viewport.offsetWidth - 40,
                maxHeight = canvas.viewport.offsetHeight - 120,
                outter    = canvas.mainImage || canvas.fabric,
            	scale     = Math.min(maxHeight / outter.getHeight(), maxWidth / outter.getWidth());

            if (outter.getHeight() > maxHeight || outter.getWidth() > maxWidth) {
                canvas.zoom(scale); 
            }
        }
	};

	return canvas;

}]);
angular.module('image.crop', [])

.service('cropper', ['$rootScope', 'cropzone', 'canvas', 'history', function($rootScope, cropzone, canvas, history) {
	
	var cropper = {

		start: function(e) {
			if (cropzone.initiated) return;
			
			cropzone.add();
			$rootScope.openPanel('crop', e);
		},

		stop: function(e) {
			cropzone.remove();
			$rootScope.activePanel = false;
		},

		crop: function() {
			if ( ! cropzone.initiated) return false;

			cropzone.hide();
		    var image = new Image();

		    image.onload = function() {
		        var fabricImage = new fabric.Image(this, canvas.imageStatic);
                fabricImage.name = 'mainImage';

		        canvas.mainImage && canvas.mainImage.remove();
                canvas.fabric.clear();
		        canvas.fabric.setWidth(Math.ceil(cropzone.rect.getWidth()));
		        canvas.fabric.setHeight(Math.ceil(cropzone.rect.getHeight()));

        		canvas.fabric.add(fabricImage);
                fabricImage.moveTo(0);
                fabricImage.center();
        		canvas.mainImage = fabricImage;
        		cropzone.remove();

                history.add('crop', 'crop');

				$rootScope.$apply(function() {
					$rootScope.activePanel = false;
				});
		    };

            canvas.zoom(1);

            $rootScope.editorCustomActions.crop = {
                left: cropzone.rect.getLeft(),
                top: cropzone.rect.getTop(),
                width: Math.ceil(cropzone.rect.getWidth()),
                height: Math.ceil(cropzone.rect.getHeight())
            };

		    image.src = canvas.fabric.toDataURL({
		        left: cropzone.rect.getLeft(),
		        top: cropzone.rect.getTop(),
		        width: Math.ceil(cropzone.rect.getWidth()),
		        height: Math.ceil(cropzone.rect.getHeight())
		    });

            canvas.original.width = Math.ceil(cropzone.rect.getWidth());
            canvas.original.height = Math.ceil(cropzone.rect.getHeight());
		}

	};

	return cropper;

}]);
angular.module('image.crop')

.service('cropzone', ['$rootScope', 'canvas', function($rootScope, canvas) {

	var cropzone = {

		rect: {},

		dragging: false,

		initiated: false,

		minHeight: 25,

		minWidth: 25,

		setWidth: function(width) {
            if ( ! width) return;

            width = parseInt(width);

			if (width < this.minWidth) {
				width = this.minWidth;
			}

			if (width > canvas.original.width) {
				width = canvas.original.width - 25;
			}

            this.rect.width = width;
			this.rect.setTop((canvas.original.height - this.rect.getHeight()) / 2);
			this.rect.setLeft((canvas.original.width - this.rect.getWidth()) / 2);
			this.rect.setCoords();
			this.drawGrid();
			this.drawOverlay();
			canvas.fabric.renderAll();
		},

		setHeight: function(height) {
            if ( ! height) return;

            height = parseInt(height);

			if (height < this.minHeight) {
				height = this.minHeight;
			}

            if (height > canvas.original.height) {
                height = canvas.original.height - 25;
            }

            this.rect.height = height;
			this.rect.setTop((canvas.original.height - this.rect.getHeight()) / 2);
			this.rect.setLeft((canvas.original.width - this.rect.getWidth()) / 2);
			this.rect.setCoords();
			this.drawGrid();
			this.drawOverlay();
			canvas.fabric.renderAll();
		},

		add: function() {
			this.drawMainZone();
			this.drawOverlay();
			this.drawGrid();
			this.attachEvents();

			canvas.fabric.renderAll();

			this.initiated = true;

			$rootScope.$emit('cropzone.added');
		},

		constrainWithinCanvas: function(object) {
		    var x = object.getLeft(), y = object.getTop();
		    var w = object.getWidth(), h = object.getHeight();
		    var maxX = canvas.original.width - w;
		    var maxY = canvas.original.height - h;

		    if (x < 0) {
		    	object.set('left', 0);
		    }
		    if (y < 0) {
		        object.set('top', 0);
			}
		    if (x > maxX) {
		        object.set('left', maxX);
		    }
		    if (y > maxY) {
		    	object.set('top', maxY);
		    }
		},

		constrainWithinCanvasOnScaling: function(object) {

		    var minX = object.getLeft();
		    var minY = object.getTop();
		    var maxX = object.getLeft() + object.getWidth();
		    var maxY = object.getTop() + object.getHeight();

		    if (minX < 0 || maxX > canvas.original.width) {
		        var lastScaleX = this.lastScaleX || 1;
		        object.setScaleX(lastScaleX);
		    }

		    if (minX < 0) {
		        object.setLeft(0);
		    }

		    if (minY < 0 || maxY > canvas.original.height) {
		        var lastScaleY = this.lastScaleY || 1;
		        object.setScaleY(lastScaleY);
		    }

		    if (minY < 0) {
		        object.setTop(0);
		    }

		    if (object.getWidth() < this.minWidth) {
		        object.width = this.minWidth;
		        object.setScaleX(1);
		    }

		    if (object.getHeight() < this.minHeight) {
		       object.height = this.minHeight;
		       object.setScaleY(1);
		    }

		    this.lastScaleX = object.getScaleX();
		    this.lastScaleY = object.getScaleY();
		},

		onMouseDown: function(event) {
			if (event.target && (event.target.name === 'cropzone' || event.target.name === 'crop.grid')) return;

			cropzone.dragging = true;

			//hide cropzone on single click on overlay
			cropzone.overlay.visible = false;
			cropzone.grid.visible = false;
			cropzone.rect.visible = false;

			//start position for drawing a cropzone
		    cropzone.rect.left = event.e.pageX - canvas.fabric._offset.left;
		    cropzone.rect.top = event.e.pageY - canvas.fabric._offset.top;

		    //make sure cropzone scale is 1 for accurate coordinates
		    cropzone.rect.scale(1);
            cropzone.overlay.scale(1);
            cropzone.grid.scale(1);
		    cropzone.mousex = event.e.pageX;
		    cropzone.mousey = event.e.pageY;

		    //prevent selection of objects while dragging
		    canvas.fabric.selection = false;

		    cropzone.drawOverlay();
		},

		onMouseMove: function(event) {
			if ( ! cropzone.dragging) return;

			var width  = event.e.pageX - cropzone.mousex,
				height = event.e.pageY - cropzone.mousey;

			//prevent cropzone going over the right edge
			if (canvas.offset.left + canvas.original.width < event.e.pageX) {
				width = (canvas.offset.left + canvas.original.width) - cropzone.mousex;
			}

			//left edge
			if (canvas.offset.left > event.e.pageX) {
				width = canvas.offset.left - cropzone.mousex;
			}

			//bottom edge
			if (canvas.offset.top + canvas.original.height < event.e.pageY) {
				height = (canvas.offset.top + canvas.original.height) - cropzone.mousey;
			}

			//top edge
			if (canvas.offset.top > event.e.pageY) {
				height = canvas.offset.top - cropzone.mousey;
			}

			cropzone.rect.width = width;
        	cropzone.rect.height = height;
        	cropzone.rect.moveTo(3);
            cropzone.rect.setCoords();
        	cropzone.drawOverlay();
	        cropzone.drawGrid();

			if ( ! cropzone.rect.visible) {
				cropzone.rect.visible = true;
				cropzone.overlay.visible = true;
				cropzone.grid.visible = true;
			}
		},

		onMouseUp: function() {
		   	cropzone.dragging = false;
		    canvas.fabric.selection = true;
		    cropzone.rect.setCoords();
            cropzone.grid.setCoords();
            cropzone.overlay.setCoords();

		    if (cropzone.rect.visible) {
		    	canvas.fabric.setActiveObject(cropzone.rect);
			}
		},

		attachEvents: function() {

			//redraw cropzone grid and overlay when cropzone is resized
			this.rect.on('moving', function() {
				cropzone.constrainWithinCanvas(cropzone.rect);
				cropzone.drawOverlay();
				cropzone.drawGrid();
			});

			this.rect.on('scaling', function(e) {
				cropzone.constrainWithinCanvasOnScaling(cropzone.rect, e);
				cropzone.drawOverlay();
				cropzone.drawGrid();
			});

			canvas.fabric.on("mouse:down", cropzone.onMouseDown);
			canvas.fabric.on("mouse:move", cropzone.onMouseMove);
			canvas.fabric.on("mouse:up", cropzone.onMouseUp);
		},

		remove: function() {
			canvas.fabric.off("mouse:down", cropzone.onMouseDown);
			canvas.fabric.off("mouse:move", cropzone.onMouseMove);
			canvas.fabric.off("mouse:up", cropzone.onMouseUp);

			canvas.fabric.remove(this.rect);
			canvas.fabric.remove(this.grid);
			canvas.fabric.remove(this.overlay);
            canvas.fabric.renderAll();
			this.initiated = false;
		},

		hide: function() {
			this.rect.visible = false;
			this.rect.hasControls = false;
			this.grid.visible = false;
			this.overlay.visible = false;
		},

		getOptimalDimensions: function () {
            var width = canvas.original.width / 2,
                height = canvas.original.height / 2,
                left = canvas.original.width / 4,
                top = canvas.original.height / 4;

			if (canvas.viewport.offsetWidth < canvas.original.width) {
				width = canvas.viewport.offsetWidth / 2;
				left = canvas.viewport.offsetWidth / 4;

			}

            if (canvas.viewport.offsetHeight < canvas.original.height) {
                height = canvas.viewport.offsetHeight / 2;
                top = canvas.viewport.offsetHeight / 4;
            }

			return {width: width, height: height, left: left, top: top};
		},

		drawMainZone: function() {
			var dimensions = this.getOptimalDimensions();

			this.rect = new fabric.Rect({
			    fill: 'transparent',
			    stroke: 'rgba(255, 255, 255, 0.6)',
			    hasBorders: false,
			    width: dimensions.width,
			    height: dimensions.height,
			    left: dimensions.left,
			    top: dimensions.top,
			    hasRotatingPoint: false,
			    name: 'cropzone',
			    cornerColor: 'rgba(255, 255, 255, 0.6)',
			    transparentCorners: false,
                ignore: true
			});

			canvas.fabric.add(this.rect);
			this.rect.moveTo(3);
			canvas.fabric.setActiveObject(cropzone.rect);
		},

		drawGrid: function() {

			if ( ! this.initiated) {
				this.line1 = new fabric.Line([], { stroke: 'rgba(255, 255, 255, 0.6)', strokeWidth: 1, selectable: false, evented: false });
				this.line2 = new fabric.Line([], { stroke: 'rgba(255, 255, 255, 0.6)', strokeWidth: 1, selectable: false, evented: false });
				this.line3 = new fabric.Line([], { stroke: 'rgba(255, 255, 255, 0.6)', strokeWidth: 1, selectable: false, evented: false });
				this.line4 = new fabric.Line([], { stroke: 'rgba(255, 255, 255, 0.6)', strokeWidth: 1, selectable: false, evented: false });
				this.grid = new fabric.Group([this.line1, this.line2, this.line3, this.line4]);
				this.grid.originY = 'left';
				this.grid.originX = 'top';
                this.grid.ignore = true;
                this.grid.selectable = false;
				canvas.fabric.add(this.grid);
		    	this.grid.moveTo(10);
			}

			this.grid.width = this.rect.getWidth();
			this.grid.height = this.rect.getHeight();
			this.grid.left = this.rect.getLeft();
			this.grid.top = this.rect.getTop();

			var width  = cropzone.rect.getWidth() / 3,
				height = cropzone.rect.getHeight() / 3;

			this.line1.set({
				x1: width,
				y1: 0,
				x2: width,
				y2: cropzone.grid.getHeight(),
			});

			this.line2.set({
				x1: width * 2,
				y1: 0,
				x2: width * 2,
				y2: cropzone.grid.getHeight()
			});

			this.line3.set({
				x1: 0,
				y1: height,
				x2: cropzone.grid.getWidth(),
				y2: height
			});

			this.line4.set({
				x1: 0,
				y1: height * 2,
				x2: cropzone.grid.getWidth(),
				y2: height * 2
			});

			this.constrainWithinCanvas(this.grid);
		},

		drawOverlay: function() {

	    	if ( ! this.initiated) {
	    		this.topRect = new fabric.Rect({fill: 'rgba(0,0,0,0.7)', selectable: true, evented: false});
	    		this.rightRect = new fabric.Rect({fill: 'rgba(0,0,0,0.7)', selectable: true, evented: false});
	    		this.bottomRect = new fabric.Rect({fill: 'rgba(0,0,0,0.7)', selectable: true, evented: false});
	    		this.leftRect = new fabric.Rect({fill: 'rgba(0,0,0,0.7)', selectable: true, evented: false});
	    		this.overlay = new fabric.Group([this.topRect, this.rightRect, this.bottomRect, this.leftRect]);
                this.overlay.ignore = true;
                this.overlay.name = 'grid.overlay';
				canvas.fabric.add(this.overlay);
				this.overlay.moveTo(1);
	    	}

    		this.topRect.set({
	    		left: 0,
				top: 0,
				width: canvas.original.width,
				height: this.rect.getHeight() < 0 ? this.rect.getTop() - Math.abs(this.rect.getHeight()) : this.rect.getTop(),
	    	});

	    	this.rightRect.set({
	    		left: this.rect.getWidth() < 0 ? this.rect.getLeft() : this.rect.getLeft() + this.rect.getWidth(),
				top: this.rect.getTop(),
				width: this.rect.getWidth() < 0 ? canvas.original.width - (this.rect.getLeft() + this.rect.getWidth()) - Math.abs(this.rect.getWidth()) : canvas.original.width - (this.rect.getLeft() + this.rect.getWidth()),
				height: this.rect.getHeight(),
	    	});

	    	this.bottomRect.set({
	    		left: 0,
				top: this.rect.getHeight() < 0 ? this.rect.getTop() : this.rect.getTop() + this.rect.getHeight(),
				width: canvas.original.width,
				height: this.rect.getHeight() < 0 ? canvas.original.height - (this.rect.getTop()) : canvas.original.height - (this.rect.getTop() + this.rect.getHeight()),
	    	});

	    	this.leftRect.set({
	    		left: 0,
				top: this.rect.getTop(),
				width: this.rect.getWidth() > 0 ? this.rect.getLeft() : this.rect.getLeft() - Math.abs(this.rect.getWidth()),
				height: this.rect.getHeight(),
	    	});


	    }
	};

	return cropzone;

}]);
angular.module('image.crop')

.controller('CropController', ['$scope', '$rootScope', 'cropper', 'cropzone', function($scope, $rootScope, cropper, cropzone) {

	$scope.cropper = cropper;
	$scope.cropzone = cropzone;

    $rootScope.$on('tab.changed', function(e, newTab, oldTab) {
       if (oldTab === 'basics' && newTab !== 'basics') {
           cropper.stop();
       }
    });

    $rootScope.$watch('activePanel', function(newPanel, oldPanel) {
        if (newPanel !== 'crop' && oldPanel === 'crop') {
            cropzone.remove();
        }
    });

	$rootScope.$on('cropzone.added', function() {
		$scope.width = Math.round(cropzone.rect.width);
		$scope.height = Math.round(cropzone.rect.height);
	});
}]);
angular.module('image.basics', [])

.controller('RotateController', ['$scope', '$rootScope', 'canvas', 'history', function($scope, $rootScope, canvas, history) {

        $scope.angle = 0;

        $scope.startRotator = function($event) {
            history.add('rotate-original-state', 'backup', true);
            $scope.openPanel('rotate', $event);
        };

        $scope.applyRotation = function() {
            $rootScope.activePanel = false;
            history.add('rotation', 'rotate-right');
        };

        $scope.cancel = function() {
            history.load('rotate-original-state');
            $rootScope.activePanel = false;
            $scope.angle = 0;
        };

        //rotate properly by scaling canvas to new height after rotating main image by 90 degrees
        $scope.rotateProper = function(originalAngle) {
            canvas.zoom(1);
            var angle = (canvas.mainImage.getAngle() + originalAngle) % 360;

            var height = Math.abs(canvas.mainImage.getWidth()*(Math.sin(angle*Math.PI/180)))+Math.abs(canvas.mainImage.getHeight()*(Math.cos(angle*Math.PI/180))),
                width = Math.abs(canvas.mainImage.getHeight()*(Math.sin(angle*Math.PI/180)))+Math.abs(canvas.mainImage.getWidth()*(Math.cos(angle*Math.PI/180)));

            canvas.fabric.setWidth(width * canvas.currentZoom);
            canvas.fabric.setHeight(height * canvas.currentZoom);
            canvas.original.height = height;
            canvas.original.width  = width;
            canvas.mainImage.center();

            canvas.fabric.forEachObject(function(obj) {
                obj.rotate((obj.getAngle() + originalAngle) % 360);
                obj.setCoords();
            });

            $rootScope.editorCustomActions.rotate = originalAngle;
            canvas.fabric.renderAll();
            canvas.fitToScreen();
        };

        //only rotate the objects of canvas while leaving canvas width/height intact
        $scope.rotate = function(angle, direction) {
            if (angle > 360 || angle < 0) return;
            var resetOrigin = false;

            canvas.fabric.forEachObject(function(obj) {

                if (direction && direction === 'left') {
                    angle = obj.getAngle() - 90;
                } else if (direction && direction === 'right') {
                    angle = obj.getAngle() + 90;
                }

                if ((obj.originX !== 'center' || obj.originY !== 'center') && obj.centeredRotation) {
                    $scope.setOriginToCenter && $scope.setOriginToCenter(obj);
                    resetOrigin = true;
                }

                angle = angle > 360 ? 90 : angle < 0 ? 270 : angle;

                obj.setAngle(angle).setCoords();

                if (resetOrigin) {
                    $scope.setCenterToOrigin && $scope.setCenterToOrigin(obj);
                }
            });

            canvas.fitToScreen();
            canvas.fabric.renderAll();
        };

        $scope.setOriginToCenter = function (obj) {
            obj._originalOriginX = obj.originX;
            obj._originalOriginY = obj.originY;

            var center = obj.getCenterPoint();

            obj.set({
                originX: 'center',
                originY: 'center',
                left: center.x,
                top: center.y
            });
        };

        $scope.setCenterToOrigin = function (obj) {
            var originPoint = obj.translateToOriginPoint(
                obj.getCenterPoint(),
                obj._originalOriginX,
                obj._originalOriginY);

            obj.set({
                originX: obj._originalOriginX,
                originY: obj._originalOriginY,
                left: originPoint.x,
                top: originPoint.y
            });
        };
}]);
angular.module('image.basics')

.controller('CanvasBackgroundController', ['$scope', '$rootScope', 'canvas', 'history', function($scope, $rootScope, canvas, history) {

    //canvas.fabric.setBackgroundColor('#ffffff');
    //canvas.fabric.renderAll();
    $scope.setBackground = function(color) {
        canvas.fabric.setBackgroundColor(color);
        canvas.fabric.renderAll();
    };

    $scope.apply = function() {
        $rootScope.activePanel = false;
        $rootScope.bgColor = $("#cvs-bgcolor").val();
        history.add('Canvas Color', 'format-color-fill');
    };

    $scope.cancel = function() {
        $rootScope.activePanel = false;
        canvas.fabric.setBackgroundColor($rootScope.bgColor);
        canvas.fabric.renderAll();
    };
}]);
angular.module('image.basics')

.controller('ResizeController', ['$scope', '$rootScope', 'canvas', 'history', function($scope, $rootScope, canvas, history) {

    $scope.constrainProportions = true;

    $scope.percent = 100;

    $scope.startResizer = function($event) {
        $scope.width  = $scope.usePercentages ? 100 : Math.ceil(canvas.original.width);
        $scope.height = $scope.usePercentages ? 100 : Math.ceil(canvas.original.height);
        history.add('beforeResize', false, true);
        canvas.zoom(1);
        $scope.openPanel('resize', $event);
    };

    /**
     * Toggle resizing mode between percentages and pixles.
     *
     * @param {boolean} usePercentages
     */
    $scope.togglePercentages = function(usePercentages) {
        if (usePercentages) {
            $scope.width = ($scope.width / canvas.original.width) * 100;
            $scope.height = ($scope.height / canvas.original.height) * 100;
        } else {
            $scope.width = ($scope.width * canvas.original.width) / 100;
            $scope.height = ($scope.height * canvas.original.height) / 100;
        }
    };

    $scope.apply = function() {
        var currentWidth  = Math.ceil(canvas.original.width),
            currentHeight = Math.ceil(canvas.original.height),
            newWidth      = Math.ceil($scope.width),
            newHeight     = Math.ceil($scope.height);

        if ($scope.usePercentages) {
            var widthScale    = $scope.width / 100;
            var heightScale   = $scope.height / 100;
        } else {
            var widthScale    = $scope.width / canvas.original.width;
            var heightScale   = $scope.height / canvas.original.height;
        }

        if (currentWidth === newWidth && currentHeight === newHeight) return;

        resize(widthScale, heightScale);

        $rootScope.activePanel = false;
        history.add('resize', 'open-width');
        canvas.fitToScreen();
    };

    $scope.close = function() {
        $rootScope.activePanel = false;
        canvas.fitToScreen();
    };

    $scope.aspectToHeight = function(newWidth) {
        if ( ! $scope.constrainProportions) return;

        if ($scope.usePercentages) {
            $scope.height = newWidth;
        } else {
            var wRatio = parseFloat((canvas.original.width / newWidth).toPrecision(3));
            $scope.height = Math.ceil(canvas.original.height / wRatio);
        }
    };

    $scope.aspectToWidth = function(newHeight) {
        if ( ! $scope.constrainProportions) return;

        if ($scope.usePercentages) {
            $scope.width = newHeight;
        } else {
            var hRatio = parseFloat((canvas.original.height / newHeight).toPrecision(3));
            $scope.width = Math.floor(canvas.original.width / hRatio);
        }
    };

    function resize(widthScale, heightScale) {
        var newHeight = Math.round(canvas.original.height * heightScale),
            newWidth  = Math.round(canvas.original.width * widthScale);

        canvas.fabric.setHeight(newHeight);
        canvas.fabric.setWidth(newWidth);
        canvas.original.width = newWidth;
        canvas.original.height = newHeight;

        var objects = canvas.fabric.getObjects();
        for (var i in objects) {
            var scaleX = objects[i].scaleX;
            var scaleY = objects[i].scaleY;
            var left = objects[i].left;
            var top = objects[i].top;

            var tempScaleX = scaleX * widthScale;
            var tempScaleY = scaleY * heightScale;
            var tempLeft = left * widthScale;
            var tempTop = top * heightScale;

            objects[i].scaleX = tempScaleX;
            objects[i].scaleY = tempScaleY;
            objects[i].left = tempLeft;
            objects[i].top = tempTop;

            objects[i].setCoords();
        }

        canvas.fabric.renderAll();
    }
}]);
angular.module('image.basics')

.controller('RoundedCornersController', ['$scope', '$rootScope', 'canvas', 'history', function($scope, $rootScope, canvas, history) {

    $scope.radius = 50;

    $scope.startRoundedCorners = function(e) {
        if ($rootScope.activePanel === 'round') return;

        $rootScope.openPanel('round', e);

        $scope.rect = new fabric.Rect({
            width: canvas.original.width,
            height: canvas.original.height,
            rx: $scope.radius,
            ry: $scope.radius,
            opacity: 1,
            fill: 'transparent',
            name: 'rounding-rect',
            stroke: '#fff',
            strokeDashArray: [5, 5],
            selectable: false,
            evented: false,
            ignore: true
        });

        canvas.fabric.add($scope.rect);
        canvas.fabric.renderAll();
    };

    $scope.adjustPreview = function() {
        if ( ! $scope.rect) return;

        $scope.rect.set({
            rx: $scope.radius, ry: $scope.radius
        });
        canvas.fabric.renderAll();
    };

    $scope.cancel = function(leavePanel) {
        canvas.fabric.remove($scope.rect);
        $scope.rect  = false;
        $scope.radius = 50;
        canvas.fabric.renderAll();

        if ( !leavePanel) {
            $rootScope.activePanel = false;
        }
    };

    $scope.apply = function() {
        $rootScope.editorCustomActions.roundCorners = angular.copy($scope.radius);

        canvas.fabric.remove($scope.rect);
        canvas.zoom(1);

        canvas.fabric.clipTo = function(ctx) {
            $scope.rect.render(ctx);
            canvas.fabric.clipTo = false;
        };
        var data = canvas.fabric.toDataURL(); //canvas.getDataURL();
        canvas.fabric.clear();
        $scope.cancel();

        canvas.loadMainImage(data, false, false, false, function() {
            $rootScope.$apply(function() {
                history.add('Round Corners', 'panorama-wide-angle');
            });
        });
    };

    $rootScope.$on('tab.changed', function(e, newTab, oldTab) {
        if (oldTab === 'basics' && $scope.rect && newTab !== 'basics') {
            $scope.cancel();
        }
    });

    $rootScope.$watch('activePanel', function(newPanel, oldPanel) {
        if (newPanel !== 'round' && oldPanel === 'round') {
            $scope.cancel(true);
        }
    });
}]);
'use strict';

angular.module('ImageEditor')

.controller('ZoomController', ['$rootScope', '$scope', 'canvas', function($rootScope, $scope, canvas) {

    $scope.canvas = canvas;
    $scope.zoom = 1;
    $scope.maxScale = 200;
    $scope.minScale = 30;

    $rootScope.$on('editor.mainImage.loaded', function() { $scope.fitToScreen() });
    $rootScope.$on('canvas.openedNew', function() { $scope.fitToScreen() });

    $scope.$watch('canvas.currentZoom', function(newValue) {
        var canvasZoom = newValue * 100;

        if (canvasZoom !== $scope.zoom) {
            $scope.zoom = canvasZoom;
        }
    });

    $scope.fitToScreen = function () {
        $scope.zoom = canvas.currentZoom * 100;
            
        if (canvas.mainImage) {
            var oWidth = canvas.mainImage.originalState.width,
                oHeight = canvas.mainImage.originalState.height;
        } else {
            var oWidth = canvas.original.width,
                oHeight = canvas.original.height;
        }

        var maxScale = Math.min(3582 / oHeight, 5731 / oWidth) * 100,
            minScale = Math.min(141 / oHeight, 211 / oWidth) * 100;

        $scope.maxScale = Math.ceil(maxScale);
        $scope.minScale = Math.ceil(minScale);

        canvas.zoom(canvas.currentZoom);
    };

    //make sure we adjust zoom slider properly on history change
    $rootScope.$on('history.loaded', function() {
        $scope.zoom = canvas.currentScale * 100;
    });

    $scope.doZoom = function () {
        canvas.zoom($scope.zoom / 100);
    };

    $scope.getCurrentZoom = function() {
        return Math.round(canvas.currentZoom * 100);
    };
}]);




'use strict';

angular.module('ImageEditor')

.controller('TopPanelController', ['$rootScope', '$scope', '$mdDialog', '$mdToast', '$$rAF', '$timeout', '$window', 'canvas', 'history', 'saver', function($rootScope, $scope, $mdDialog, $mdToast, $$rAF, $timeout, $window, canvas, history, saver) {

    $scope.history = history;

    $scope.isDemo = $rootScope.isDemo;
    $scope.canOpenImage = false;
    $scope.canvas = canvas;
    $scope.openImageMode = 'open';

    $scope.canvasWidth = 800;
    $scope.canvasHeight = 600;

    $scope.imageName = 'image';
    $scope.imageType = 'jpeg';
    $scope.imageQuality = 8;
    
    $scope.imageName = $rootScope.order_id + "-" + $rootScope.product_id;
    $scope.objectsPanelOpen = true;
    $scope.historyPanelOpen = false;

    $scope.openUploadDialog = function($event) {
        $mdDialog.show({
            template: $('#main-image-upload-dialog-template').html(),
            targetEvent: $event,
            controller: 'TopPanelController',
            clickOutsideToClose: true,
        });
    };

    $scope.toggleRightPanel = function(name, e) {
        var panelIsOpen = $scope[name+'PanelOpen'];

        if (panelIsOpen) {
            $scope[name+'PanelOpen'] = false;
            $('#'+name).hide();
        } else {
            $scope[name+'PanelOpen'] = true;
            $('#'+name).show();
        }
    };

    $scope.transformOpen = function(name, e) {
        var panel = $('#'+name);

        panel.removeClass('transition-out transition-in').show();
        $scope.transformToClickElement(panel, e);

        $$rAF(function() {
            panel.addClass('transition-in').css('transform', '');
            e.currentTarget.blur();
        });
    };

    $scope.transformClose = function(name, e) {
        var panel = $('#'+name);

        panel.addClass('transition-out').removeClass('transition-in');
        $scope.transformToClickElement(panel, e);

        panel.one($rootScope.transitionEndEvent, function() {
            panel.hide().css('transform', '').removeClass('transition-out');
            e.currentTarget.blur();
        });
    };

    $scope.transformToClickElement = function(panel, e) {
        var clickRect = e.target.getBoundingClientRect();
        var panelRect = panel[0].getBoundingClientRect();

        var scaleX = Math.min(0.5, clickRect.width / panelRect.width);
        var scaleY = Math.min(0.5, clickRect.height / panelRect.height);

        panel.css('transform', 'translate3d(' +
            (-panelRect.left + clickRect.left + clickRect.width/2 - panelRect.width/2) + 'px,' +
            (-panelRect.top + clickRect.top + clickRect.height/2 - panelRect.height/2) + 'px,' +
            '0) scale(' + scaleX + ',' + scaleY + ')'
        );
    };

    $scope.openSaveDialog = function($event) {
        if ($rootScope.getParam('onSaveButtonClick')) {
            return $rootScope.getParam('onSaveButtonClick')();
        }

        if ($rootScope.delayEditorStart) {
            return saver.saveImage();
        }

        $mdDialog.show({
            template: $('#save-image-dialog').html(),
            targetEvent: $event,
            controller: 'TopPanelController',
            clickOutsideToClose: true,
        });
    };

    $scope.openHelp = function($event) {

        $mdDialog.show({
            template: $('#modal-help-text').html(),
            clickOutsideToClose: true,
            controller: ['$scope', '$mdDialog', function($scope, $mdDialog) {
                $scope.closeModal = $mdDialog.hide;
            }]
        });        
    };

    $scope.createNewCanvas = function(width, height) {
        canvas.openNew(width, height);
        $scope.closeUploadDialog();
        $rootScope.started = true;
        $rootScope.resetUI(); 
    };

    $scope.openSampleImage = function() {
        canvas.loadMainImage('assets/images/lotus.jpg');
        $scope.closeUploadDialog();
        $rootScope.started = true;
    };

    $scope.saveImage = function($event) {
        saver.saveImage($scope.imageType, $scope.imageQuality, $scope.imageName, $event, false);
        //$scope.saveToServer($scope.imageName, false);
    };

    $scope.saveImageClose = function($event) {
        saver.saveImage($scope.imageType, $scope.imageQuality, $scope.imageName, $event, true);
        // $timeout(function() {
        //     top.tb_remove();
        // }, 1000);
    };

    $scope.saveToServer = function(name, close){
        canvas.fabric.deactivateAll();
        //cropper.stop();

        canvas.zoom(150/canvas.original.height);
        var data_jpeg = saver.getDataUrl('jpeg', 8);

        canvas.zoom(1);            
        var data_png = saver.getDataUrl('png', 8),
            data_json = saver.getDataUrl('json', 8);
        canvas.fitToScreen();  
        $rootScope.isLoading();
        jQuery.ajax({
            url: "/wp-admin/admin-ajax.php",
            data: {
                action: 'wineshop_label_save',
                order_id: $rootScope.order_id,
                product_id: $rootScope.product_id,
                jpeg : data_jpeg,
                png : data_png,
                json : data_json
            },
            async: false,
            type: 'POST',
            success: function(res){
                console.log($rootScope.loading);
                $rootScope.isNotLoading();
                if(close){
                    $timeout(function() {

                        if (typeof top.tb_remove == 'function') {
                            top.tb_remove();
                        }

                        var event;
                        var closeEventName = "personalized-wine-designer-modal-close";
                        if (document.createEvent) {
                            event = document.createEvent("HTMLEvents");
                            event.initEvent(closeEventName, true, true);
                        } else {
                            event = document.createEventObject();
                            event.eventType = closeEventName;
                        }

                        event.eventName = closeEventName;

                        if (document.createEvent) {
                            document.dispatchEvent(event);
                            window.parent.document.dispatchEvent(event);
                        } else {
                            document.fireEvent("on" + event.eventType, event);
                            window.parent.document.fireEvent("on" + event.eventType, event);
                        }

                    }, 1000);
                }
            }
        })
    }

    $scope.showImagePreview = function(url) {
        var historyObject = false;

        try {
            historyObject = JSON.parse(url);
        } catch (e) {
            //
        }

        if (historyObject && historyObject.state) {
            $scope.$apply(function() {
                $scope.canOpenImage = false;
            });

            canvas.fabric.clear();
            history.load(historyObject);
            $scope.closeUploadDialog();
            $rootScope.started = true;
            return;
        }

        fabric.util.loadImage(url, function(image) {
            if (image) {
                $scope.$apply(function() {
                    $('.img-preview').html('').append(image);
                    $scope.canOpenImage = true;
                });
            } else {
                $scope.$apply(function() {
                    $scope.canOpenImage = false;
                });
            }
        });
    };

    $scope.openImage = function() {
        var url = $('.img-preview img').attr('src');
            
        if ( ! url || ! $scope.canOpenImage) return;

        if ((!canvas.fabric._objects.length || ! canvas.mainImage) && ! $rootScope.userPreset) {
            canvas.fabric.clear();
            canvas.loadMainImage(url);
        } else {
            canvas.openImage(url);
        }

        $scope.closeUploadDialog();
        $rootScope.started = true;
    };

    $scope.closeUploadDialog = function() {
        $scope.canUploadImage = false;
        $scope.openImageMode = 'open';
        $('.img-preview').html();
        $mdDialog.hide();
    };
}]);




'use strict';

angular.module('image.directives', [])

.directive('edTabs', ['$rootScope', function ($rootScope) {
    return {
        link: function ($scope, el, attrs) {
            var blockClicks = false;

            $('#'+attrs.edTabs).addClass('open');
            $('[data-activates="'+attrs.edTabs+'"]').addClass('active');

            el.find('#navigation-bar').on('click', '.nav-item', function (e) {
                if (blockClicks === true) return;

                $scope.$apply(function() {
                    blockClicks = true;
                    $rootScope.activeTab = e.currentTarget.dataset.activates;
                });
            });

            $rootScope.$watch('activeTab', function(newTab, oldTab) {
                if (newTab && newTab !== oldTab) {
                    var oldTabNode = oldTab ? el.find('#'+oldTab) : el.find('.tab.open');
                    changeTab(newTab, oldTabNode, el.find('#'+newTab), $('[data-activates="'+newTab+'"]'));
                }
            });

            var changeTab = function(name, oldTab, newTab, tabButton) {
                var inAnimation  = 'fadeInLeft',
                    outAnimation = 'fadeOutRight';

                if (tabButton.hasClass('active')) return;

                //tab navigation
                $('.nav-item.active').removeClass('active');
                tabButton.addClass('active');

                //tabs
                if (parseInt(newTab.data('index')) < parseInt(oldTab.data('index'))) {
                    outAnimation = 'fadeOutLeft';
                    inAnimation  = 'fadeInRight';
                }

                oldTab.addClass('animated '+outAnimation).one($rootScope.animationEndEvent, function() {
                    if (newTab[0].id === $scope.activeTab) {
                        $(this).removeClass('open '+outAnimation);
                    }
                });
                newTab.addClass('open animated '+inAnimation).one($rootScope.animationEndEvent, function() {
                    $(this).removeClass(inAnimation);
                });

                $rootScope.$emit('tab.changed', name, oldTab[0].id);
                $rootScope.activePanel = false;

                setTimeout(function() {
                    newTab.removeClass('fadeOutRight fadeOutLeft');
                    blockClicks = false;
                }, 270)
            }
        }
    };
}]);

angular.module('image.directives')

.directive('edPrettyScrollbar', function() {
    return {
        restrict: 'A',
        compile: function(el, attrs) {
            setTimeout(function() {
                el.mCustomScrollbar({
                    theme: attrs.edScrollTheme || 'inset',
                    scrollInertia: 300,
                    autoExpandScrollbar: false,
                    axis: attrs.edScrollAxis || 'x',
                    advanced: { autoExpandHorizontalScroll:true },
                });
            }, 1)
        }
   	}
})

//fix some bug between custom scrollbar and material slider
.directive('edIeSliderFix', function() {
    return {
        restrict: 'A',
        template: '<div class="slider-fix-outter" style="height: 2px; position: absolute"><div class="slider-fix-inner" style="height: 1px; overflow: auto;">IE FIX</div></div>',
        compile: function(el) {
            el.find('.slider-fix-inner').mCustomScrollbar();
        }
    }
});
'use strict';

angular.module('image.directives')

.directive('edColorPicker', ['$rootScope', '$parse', function ($rootScope, $parse) {
    return {
        link: function ($scope, el, attrs) {
            var flat = 'edFlat' in attrs;

            $scope.$watch(attrs.ngDisabled, function(newVal) {
                if (newVal) {
                    el.spectrum('disable');
                } else {
                    el.spectrum('enable');
                }
            });

            var params = {
                color: attrs.startColor,
                clickoutFiresChange: true,
                showPalette: !flat,
                palette: colorsForPicker,
                preferredFormat: 'hex',
                showAlpha: true,
                showInput: true,
                flat: flat,
                showButtons: !flat
            },
            setter = function(selectedColor) {
                $parse(attrs.edColorPicker)($scope, {color: selectedColor.toString()});
                el.val(selectedColor.toString());
            };

            if (attrs.edDiscrete !== undefined) {
                el.on('dragstop.spectrum', function(e, selectedColor) {
                    setter(selectedColor);
                });

                params.change = function(selectedColor) {
                    setter(selectedColor);
                }
            } else {
                params.move = function(selectedColor) {
                    setter(selectedColor);
                }
            }

            el.spectrum(params);
        }
    };
}]);

angular.module('image.directives')

.directive('edFileUploader', ['$parse', '$mdDialog', '$mdBottomSheet', function($parse, $mdDialog, $mdBottomSheet) {
    var validTypes = ['png', 'jpg', 'jpeg', 'gif'];

    return {
        restrict: 'A',
        link: function($scope, el, attrs) {
            var setter = $parse(attrs.edFileUploader)($scope);

            $(el[0]).on('change', function(e) {
                var reader = new FileReader();

                reader.onload = function(event) {
                    var mime = event.target.result.split(",")[0].split(":")[1].split(";")[0].split('/')[1];

                    if (validTypes.indexOf(mime) < 0) {
                        //
                    }

                    if (setter) {
                        setter(event.target.result);

                        if (typeof attrs.edCloseAfter !== 'undefined') {
                            $mdDialog.hide();
                            $mdBottomSheet.hide();
                        }
                    }
                };

                if (e.target.files[0].name.match('.json')) {
                    reader.readAsText(e.target.files[0]);
                } else {
                    reader.readAsDataURL(e.target.files[0]);
                }
            });
        }
   	}
}]);
angular.module('image.directives')

.directive('edTogglePanelVisibility', function() {
    return {
        restrict: 'A',
        compile: function(el, attrs) {
            el.on('click', function() {
                el.find('.icon').toggleClass('toggled');

                $('#'+attrs.edTogglePanelVisibility).find('ul').mCustomScrollbar('disable').slideToggle(150, function() {
                    $(this).mCustomScrollbar('update');
                });
            });
        }
   	}
});
angular.module('image.directives')

.directive('edToggleSidebar', function() {
    return {
        restrict: 'A',
        compile: function(el, attrs) {
            var sidebar = $('#left-sidebar');

            el.on('click', function() {
                sidebar.toggleClass('open');
            });
        }
   	}
});
angular.module('image.text', [])

    .service('text', ['$rootScope', 'canvas', function ($rootScope, canvas) {

        var text = {

            removeTextFromCanvas: function(textObject) {
                  if ( ! textObject) {
                      textObject = canvas.fabric.getActiveObject();
                  }

                  //bail if we don't have a text object
                  if ( ! textObject.setFontSize) return;

                  canvas.fabric.remove(textObject);
                  canvas.fabric.renderAll();
            },

            getTextObject: function() {
                var active = canvas.fabric.getActiveObject();

                if (active && active.fontFamily) {
                    return active;
                }

                //if there is no active object or active object
                //is not text, return first text object available
                if ( ! active || ! active.fontFamily) {
                    var objects = canvas.fabric.getObjects();

                    for (var i = 0; i < objects.length; i++) {
                        if (objects[i].fontFamily) {
                            return objects[i];
                        }
                    }
                }
            },

            toggleTextDecoration: function(value) {
                var text = this.getTextObject(),
                    current = text.textDecoration.trim();

                //font style
                if (value == 'italic') {
                    if (text.fontStyle.indexOf('italic') > -1) {
                        text.setFontStyle('normal');
                    } else {
                        text.setFontStyle('italic');
                    }
                }

                //text decoration
                else {
                    if (current.indexOf(value) > -1) {
                        current = current.replace(value, '').trim();
                    } else {
                        current += ' '+value;
                    }

                    if (text.setTextDecoration) {
                        text.setTextDecoration(current);
                    }
                }

                canvas.fabric.renderAll();

                var decorations = text.fontStyle+' '+text.textDecoration.trim();

                return decorations.split(' ');
            },

            setProperty: function(property, value, enabled) {
                var text   = this.getTextObject(),
                    setter = this.makeSetterName(property);

                  if (text[setter] && enabled) {
                      text[setter](value);
                  }
                  canvas.fabric.renderAll();
            },

            /**
             * Toggle given property on/off on text object.
             *
             * @param {string}  property
             * @param {boolean} enabled
             */
            toggleProperty: function(property, enabled) {
                var text   = this.getTextObject(),
                    setter = this.makeSetterName(property);
                    
                if (text[setter]) {
                  if(!enabled){
                    text[setter](enabled);
                  }else{
                    if(property=='backgroundColor'){
                      text[setter](jQuery("#txtBgColor").val());
                    }else if(property=='stroke'){
                      text[setter](jQuery("#txtOutlineColor").val());
                    }
                  }
                }

                canvas.fabric.renderAll();
            },

            /**
             * Compile a fabric setter function name from give property.
             *
             * @param name (backgroundColor)
             * @returns string (setBackgroundColor)
             */
            makeSetterName: function(name) {
                  return 'set'+name.charAt(0).toUpperCase()+name.slice(1);
            }
        };

        return text;

    }]);
angular.module('image.text')

.controller('TextController', ['$scope', '$rootScope', '$timeout', 'canvas', 'text', 'fonts', function($scope, $rootScope, $timeout, canvas, text, fonts) {
	$scope.text  = text;
	$scope.fonts = fonts;

	$scope.activeFont = '';
	$scope.opacity = 1;
	$scope.fontSize = 25;
	$scope.txtColor = '#000000';
	$scope.enableBackground = true;
	$scope.txtBgColor = 'rgba(0,0,0,0)';
	$scope.enableOutline = true;
	$scope.txtOutlineColor = 'rgba(0,0,0,0)';
	$scope.txtAlign = 'left';
	$scope.txtUnderline = '';
	$scope.txtStyle = '';
	$scope.txtLineHeight = '';
	$scope.txtOutlineWidth = '';
	$scope.filters = {
		category: 'handwriting',
		family: ''
	};

	fonts.getAll($scope.filters);
    $scope.isPanelEnabled = function() {
        var obj = canvas.fabric.getActiveObject();
        $rootScope.activeObject = obj;
        if(obj && obj.name === 'text') $scope.setTxtValue(obj);
        return obj && obj.name === 'text' && $rootScope.activeTab === 'text';
    };

    $scope.setTxtValue = function(obj){
    	console.log(obj);
    	$scope.activeFont = obj.fontFamily;
	   	$scope.opacity = obj.opacity;
		$scope.fontSize = obj.fontSize;
		$scope.txtColor = obj.fill;
		if(obj.backgroundColor) {
			$scope.enableBackground = true;
			$scope.txtBgColor = obj.backgroundColor;
		}else{
			$scope.enableBackground = false;
		}
		if(obj.stroke) {
			$scope.enableOutline = true;
			$scope.txtOutlineColor = obj.stroke; 	
		}else{
			$scope.enableOutline = false;
		}
		$scope.txtAlign = obj.textAlign;
		console.log($scope.txtAlign);
		$scope.txtUnderline = obj.textDecoration;
		$scope.txtStyle = obj.fontStyle;
		$scope.txtLineHeight = obj.lineHight;
		$scope.txtOutlineWidth = obj.strokeWidth;
		jQuery("#txtColor").spectrum("set", obj.fill);
		if($scope.enableBackground) jQuery("#txtBgColor").spectrum("set", $scope.txtBgColor);
		if($scope.enableOutline) jQuery("#txtOutlineColor").spectrum("set", $scope.txtOutlineColor);
    };

	$scope.changeFont = function(font, e) {
        var active = canvas.fabric.getActiveObject();
		$rootScope.openPanel('text', e);

		if ( ! active || active.name !== 'text') {
			var newText = new fabric.IText('Double click me to edit my contents.', {
				fontFamily: font,
				fontWeight: 400,
				fontSize: $scope.fontSize,
				fill: $scope.txtColor,
				removeOnCancel: true,
				name: 'text'
			});

			canvas.fabric.add(newText);
            newText.setTop(25);
            newText.setLeft(25);
			canvas.fabric.setActiveObject(newText);
			canvas.fabric.renderAll();
		}

        text.setProperty('fontFamily', font, true);
		$scope.setTxtValue(active);
		$scope.activeFont = font;
	};

	$scope.cancelAddingTextToCanvas = function() {
		var textObject = text.getTextObject();

		if (textObject.removeOnCancel) {
			text.removeTextFromCanvas(textObject);
		}

		$rootScope.activePanel = false;
	};

	$scope.finishAddingTextToCanvas = function() {
		var textObject = text.getTextObject();

		$rootScope.activePanel = false;
		$rootScope.$emit('text.added', textObject);
		canvas.fabric.setActiveObject(canvas.mainImage);
		fonts.createLinkToFont(textObject.fontFamily);
		$rootScope.activeObject = canvas.mainImage;
	};

	$rootScope.$on('tab.changed', function(e, name) {
		if (name == 'text') {
			var textObject = $scope.text.getTextObject();

			//if we can find an existing text object set it as active
			if (textObject) {
				textObject.removeOnCancel = false;
				canvas.fabric.setActiveObject(textObject);
			}
		}
	});

}]);
'use strict';

angular.module('image.text')

.directive('edTextAlignButtons', ['text', function (text) {
    return {
        compile: function (el) {
            el.on('click', 'i', function(e) {
                var align = e.currentTarget.dataset.align;
                text.setProperty('textAlign', align, true);
                el.find('i').removeClass('active');
                $(e.currentTarget).addClass('active');

            });
        }
    };
}])

'use strict';

angular.module('image.text')

.directive('edTextDecorationButtons', ['text', function (text) {
    return {
        compile: function (el) {
            el.on('click', '.toolbar-btn', function(e) {
                var name = e.currentTarget.dataset.decoration;

                var decorations = text.toggleTextDecoration(name);

                el.find('.toolbar-btn').removeClass('active');

                for (var i = 0; i < decorations.length; i++) {
                    el.find('[data-decoration="'+decorations[i].trim()+'"]').addClass('active');
                }
            });
        }
    };
}])

'use strict';

angular.module('image.text')

.directive('edFontsPagination', ['$rootScope', 'fonts', function($rootScope, fonts) {

    return {
        restrict: 'A',
        link: function($scope, el) {

            //initiate pagination plugin
            el.pagination({
                items: 0,
                itemsOnPage: fonts.paginator.perPage,
                onPageClick: function(num) {
                    $scope.$apply(function() {
                        fonts.paginator.selectPage(num);
                    })
                }
            });

            //redraw pagination bar on total items change
            $scope.$watch('fonts.paginator.totalItems', function(value) {
                if (value) { el.pagination('updateItems', value) }
            });
        }
    }
}])

.factory('fonts', ['$rootScope', '$http', '$timeout', '$filter', 'localStorage', function($rootScope, $http, $timeout, $filter, localStorage) {

    var fonts = {

        loading: false,

        paginator: {

            /**
             * All available fonts.
             *
             * @type array
             */
            sourceItems: ["Slabo 27px",
                            "Roboto",
                            "Saira" ,
                            "Open Sans",
                            "Times New Roman",
                            "Playfair Display",
                            "Monotype Corsiva",
                            "PT Serif",
                            "IM Fell Double Pica SC",
                            "Cormorant Unicase",
                            "Chewy",
                            "Limelight",
                            "Poiret One",
                            "Voltaire",
                            "Oswald",
                            "Sniglet",
                            "Crushed",
                            //"Bookman Old Style",
                            "Arial",
                            "Helvetica",
                            "Lobster",
                            //"Disney",
                            "Star Trek",
                            //"Garamond",
                            "PT Sans",
                            "Indie Flower",
                            "Fjalla One",
                            "Pacifico",
                            "Amatic SC",
                            "Great Vibes",
                            "Permanent Marker",
                            "Bad Script",
                            "Monoton",
                            "Coming Soon",
                            "Just Another Hand",
                            "Delius Swash Caps",
                            "Rochester",
                            "Elsie Swash Caps",
                            "Inconsolata",
                            "Trocchi",
                            "Creepster",
                            "Bungee",
                            "Black Ops One",
                        ],

            /**
             * All available fonts with filtrs applied.
             */
            filteredItems: [],

            /**
             * Fonts currently being shown.
             *
             * @type array
             */
            currentItems: [],

            /**
             * Fonts to show per page.
             *
             * @type int
             */
            perPage: 10,

            /**
             * Total number of fonts.
             *
             * @type int
             */
            totalItems: 0,

            /**
             * Slice items for the given page.
             *
             * @param  {int} page
             * @return void
             */
            selectPage: function(page) {
                this.currentItems = this.filteredItems.slice(
                    (page-1)*this.perPage, (page-1)*this.perPage+this.perPage
                );

                //fonts.load();
            },

            filter: function(filters) {
                this.start($filter('filter')(fonts.paginator.sourceItems, filters));
            },

            /**
             * Start the paginator with given items.
             *
             * @param  {array} items
             * @return void
             */
            start: function(items) {
                console.log(items);
                this.perPage = items.length;
                this.filteredItems  = items;
                this.totalItems   = items.length;
                this.currentItems = items.slice(0, this.perPage);

                fonts.load(items);
            }
        },

        /**
         * Fetch all available fonts from GoogleFonts API.
         *
         * @return void
         */
        getAll: function(filters) {
            var self   = this,
                cached = localStorage.get('googleFonts'),
                key    = $rootScope.keys['google_fonts'];
            // console.log(fonts.paginator.currentItems);
            // if (cached) {
            //     self.paginator.sourceItems = cached;
            //     return filters ? self.paginator.filter(filters) : self.paginator.start(cached);
            // }

            // $http.get('https://www.googleapis.com/webfonts/v1/webfonts?sort=popularity&key='+key)
            //     .success(function(data) {
            //         localStorage.set('googleFonts', data.items);
            //         self.paginator.sourceItems = data.items;
            //         filters ? self.paginator.filter(filters) : self.paginator.start(data.items);
            //     });
            //console.log(self.paginator.sourceItems);
            //localStorage.set('googleFonts', self.paginator.sourceItems);
            //filters ? self.paginator.filter(filters) : self.paginator.start(self.paginator.sourceItems);
            self.paginator.start(self.paginator.sourceItems);
        },

        /**
         * Load given google fonts into the DOM.
         *
         * @param  {mixed} names
         * @return void
         */
        load: function(names) {
            var head = $('head');
            $rootScope.loading = true;

            //make an array of font names from current fonts
            //in the paginator if none passed
            if ( ! names) {
                names = $.map(fonts.paginator.currentItems, function(font) {
                    console.log(font);
                    //return font.family;
                    return font;
                });

                //normalize names to array if string passed
            } else if ( ! angular.isArray(names)) {
                names = [names];
            }

            //remove previous page fonts
            //$(head).find('#dynamic-fonts').remove();
            names = names.filter(val => val !== "Times New Roman");
            names = names.filter(val => val !== "Helvetica");
            names = names.filter(val => val !== "Monotype Corsiva");
            var perPage = 17;
            //load the given fonts
            for( var i=0; i*perPage < names.length; i++){
                var subfonts = names.slice(i*perPage, (i+1)*perPage);
                head.append(
                    '<link rel="stylesheet" id="dynamic-fonts'+i+'" href="https://fonts.googleapis.com/css?family='+
                    subfonts.join('|').replace(/ /g, '+')+'">'
                );
            }
        },

        createLinkToFont: function(font) {
            var name = font.replace(/ /g, '+'),
                link = $('#'+name);
                
            if (link[0]) {
                link.attr('href', 'https://fonts.googleapis.com/css?family='+name);
            } else {
                $('head').append('<link rel="stylesheet" id="'+name+'" href="https://fonts.googleapis.com/css?family='+name+'">');
            }
        }
    };

    return fonts;
}]);
angular.module('image.drawing', [])

.service('drawing', ['$rootScope', 'canvas', function ($rootScope, canvas) {

    var drawing = {

        availableBrushes: ['pencil', 'vLine', 'diamond', 'hLine', 'circle', 'square', 'spray'],

        defaultBrushName: 'pencil',

        activeBrushName: false,

        isEnabled: false,

        params: {
            shadowColor: '#1E89E6',
            brushWidth: 9,
            brushColor: '#000',
            shadowBlur: 30,
            shadowOffsetX: 10,
            shadowOffsetY: 10,
            enableShadow: false
        },

        enable: function() {
            canvas.fabric.isDrawingMode = true;
            this.changeBrush(this.defaultBrushName);

            if ( ! this.shadow) {
                this.shadow = new fabric.Shadow({
                    color: this.params.shadowColor,
                    blur: this.params.shadowBlur,
                    offsetX: this.params.shadowOffsetX,
                    offsetY: this.params.shadowOffsetY
                });
            }

            this.isEnabled = true;
        },

        disable: function() {
            canvas.fabric.isDrawingMode = false;
            this.isEnabled = false;
        },

        setShadowProperty: function(name, value) {
            if (canvas.fabric.freeDrawingBrush.shadow[name]) {
                canvas.fabric.freeDrawingBrush.shadow[name] = value;
            }
        },

        setProperty: function(name, value) {
            if (canvas.fabric.freeDrawingBrush[name]) {
                canvas.fabric.freeDrawingBrush[name] = value;
            }
        },

        toggleShadow: function(on) {
            if (on) {
                canvas.fabric.freeDrawingBrush.shadow = this.shadow;
            } else {
                this.shadow = canvas.fabric.freeDrawingBrush.shadow;
                canvas.fabric.freeDrawingBrush.shadow = undefined;
            }
        },
        
        changeBrush: function(name) {
            this.activeBrushName = name;
            name = this.makeBrushName(name);

            //check if it's a base fabric brush
            if (fabric[name]) {
                canvas.fabric.freeDrawingBrush = new fabric[name](canvas.fabric);

            //check if it's a custom brush that we have already made
            } else if (this[name]) {
                canvas.fabric.freeDrawingBrush = this[name];

            //check if we can make a request brush
            } else if (this['make'+name]) {
                canvas.fabric.freeDrawingBrush = this['make'+name]();
            }

            canvas.fabric.freeDrawingBrush.width  = this.params.brushWidth;
            canvas.fabric.freeDrawingBrush.color  = this.params.brushColor;

            if (this.params.enableShadow) {
                canvas.fabric.freeDrawingBrush.shadow = this.shadow;
            }
        },

        /**
         * Compile a fabric brush function name from given name.
         *
         * @param name (pencil)
         * @returns string (PencilBrush)
         */
        makeBrushName: function(name) {
            return name.charAt(0).toUpperCase()+name.slice(1) + 'Brush';
        },

        makeVLineBrush: function() {
            this.VLineBrush = new fabric.PatternBrush(canvas.fabric);

            this.VLineBrush.getPatternSrc = function() {

                var patternCanvas = fabric.document.createElement('canvas');
                patternCanvas.width = patternCanvas.height = 10;
                var ctx = patternCanvas.getContext('2d');

                ctx.strokeStyle = this.color;
                ctx.lineWidth = 5;
                ctx.beginPath();
                ctx.moveTo(0, 5);
                ctx.lineTo(10, 5);
                ctx.closePath();
                ctx.stroke();

                return patternCanvas;
            };

            return this.VLineBrush;
        },

        makeDiamondBrush: function () {
            this.DiamondBrush = new fabric.PatternBrush(canvas.fabric);

            this.DiamondBrush.getPatternSrc = function() {

                var squareWidth = 10, squareDistance = 5;
                var patternCanvas = fabric.document.createElement('canvas');
                var rect = new fabric.Rect({
                    width: squareWidth,
                    height: squareWidth,
                    angle: 45,
                    fill: this.color
                });

                var canvasWidth = rect.getBoundingRectWidth();

                patternCanvas.width = patternCanvas.height = canvasWidth + squareDistance;
                rect.set({ left: canvasWidth / 2, top: canvasWidth / 2 });

                var ctx = patternCanvas.getContext('2d');
                rect.render(ctx);

                return patternCanvas;
            };

            return this.DiamondBrush;
        },

        makeHLineBrush: function () {
            this.HLineBrush = new fabric.PatternBrush(canvas.fabric);

            this.HLineBrush.getPatternSrc = function() {

                var patternCanvas = fabric.document.createElement('canvas');
                patternCanvas.width = patternCanvas.height = 10;
                var ctx = patternCanvas.getContext('2d');

                ctx.strokeStyle = this.color;
                ctx.lineWidth = 5;
                ctx.beginPath();
                ctx.moveTo(5, 0);
                ctx.lineTo(5, 10);
                ctx.closePath();
                ctx.stroke();

                return patternCanvas;
            };

            return this.HLineBrush;
        },

        makeSquareBrush: function () {
            this.SquareBrush = new fabric.PatternBrush(canvas.fabric);

            this.SquareBrush.getPatternSrc = function() {

                var squareWidth = 10, squareDistance = 2;

                var patternCanvas = fabric.document.createElement('canvas');
                patternCanvas.width = patternCanvas.height = squareWidth + squareDistance;
                var ctx = patternCanvas.getContext('2d');

                ctx.fillStyle = this.color;
                ctx.fillRect(0, 0, squareWidth, squareWidth);

                return patternCanvas;
            };

            return this.SquareBrush;
        }

    };

    return drawing;

}]);
angular.module('image.drawing')

.controller('DrawingController', ['$scope', '$rootScope', 'canvas', 'drawing', 'history', function($scope, $rootScope, canvas, drawing, history) {
	$scope.drawing = drawing;
    window.fb = canvas.fabric;

	$scope.changeBrush = function(brush, $event) {
		$scope.openPanel('drawing', $event);

		if ( ! drawing.isEnabled) {
			drawing.enable();
		}

		drawing.changeBrush(brush);
	};

	$scope.finishAddingDrawingsToCanvas = function() {
		$rootScope.activePanel = false;

        if (canvas.mainImage) {
            canvas.fabric.setActiveObject(canvas.mainImage);
        }

		canvas.fabric.forEachObject(function(obj) {
			if (obj.name === 'freeDrawing') {
				obj.removeOnCancel = false;
			}
		});

        drawing.disable();

		$rootScope.activeObject = canvas.mainImage;
		history.add('added drawing', 'brush');
	};

	$scope.cancelAddingDrawingsToCanvas = function() {
        canvas.fabric.forEachObject(function (obj) {
			if (obj.name === 'freeDrawing' && obj.removeOnCancel) {
				canvas.fabric.remove(obj);
			}
		});

		drawing.disable();
        canvas.fabric.renderAll();
		$rootScope.activePanel = false;
	};

	$rootScope.$on('tab.changed', function(e, name) {
		if (name !== 'drawing') {
			drawing.disable();
			$scope.cancelAddingDrawingsToCanvas();
		}
	});

	canvas.fabric.on('path:created', function(e) {
		if (drawing.isEnabled) {
			e.path.setOptions(canvas.imageStatic);
			e.path.name = 'freeDrawing';
			e.path.removeOnCancel = true;
		}
	});
}]);
'use strict';

angular.module('image.directives')

.directive('edRenderBrushes', ['$rootScope', '$compile', function ($rootScope, $compile) {
    return {
        link: function ($scope, el) {
            var template = '<div ng-repeat="brush in drawing.availableBrushes" ng-class="{ active: drawing.activeBrushName == brush }" class="brush animated-in-sequence" ng-click="changeBrush(brush)">'+
                '<img class="img-responsive" ng-src="assets/images/brushes/{{brush}}.png"/>'+
                '<div class="brush-name">{{ brush }}</div>'+
            '</div>';

            var unbind = $rootScope.$on('tab.changed', function(e, name) {
                if (name === 'drawing') {
                    $scope.$apply(function() {
                        el.append($compile(template)($scope));
                    });
                    unbind();
                }
            });
        }
    };
}]);

'use strict';

angular.module('ImageEditor')

.factory('history', ['$rootScope', 'canvas', function($rootScope, canvas) {

	var history = {

		all: [],

        //used for backing up canvas and other serializations
        //that are not visible to the user
        ignored: [], 

		add: function(name, icon, ignore) {
            var prop = ignore ? 'ignored' : 'all';

            //make sure don't have duplicates in ignored array
            if (prop === 'ignored') { 
                for (var i = 0; i < this.ignored.length; i++) {
                    if (this.ignored[i].name === name) {
                        this.ignored.splice(i, 1)
                    }
                }
            }

			this[prop].unshift({
				name: name,
				state: canvas.fabric.toJSON(['selectable', 'name']),
				index: this.all.length+1,
				icon: icon,
                zoom: canvas.zoom,
				canvasWidth: canvas.original.width || canvas.fabric.getWidth(),
				canvasHeight: canvas.original.height || canvas.fabric.getHeight()
			});
		},

        get: function(name, prop) {
            if ( !prop) prop = 'ignored';

            for (var i = 0; i < history[prop].length; i++) {
                if (history[prop][i].name === name) {
                    return history[prop][i];
                }
            }
        },

        getCurrentCanvasState: function() {
            return {
                state: canvas.fabric.toJSON(['selectable', 'name']),
                index: this.all.length+1,
                zoom: canvas.zoom,
                canvasWidth: canvas.original.width || canvas.fabric.getWidth(),
                canvasHeight: canvas.original.height || canvas.fabric.getHeight()
            }
        },

		load: function(item) {
			$rootScope.isLoading();

            //if we get passed a name, fetch a matching history item
            if (angular.isString(item)) {
                item = this.get(item);
            }

            if ( ! item) {
                return $rootScope.isNotLoading();
            }

			setTimeout(function() {
				canvas.fabric.loadFromJSON(item.state, function() {
					canvas.fabric.forEachObject(function(obj) {

						//reapply any filters object used to have
						if (obj.applyFilters && obj.filters.length) {
							obj.applyFilters(canvas.fabric.renderAll.bind(canvas.fabric));
						}

						//assign new reference to mainImage property
						if (obj.name == 'mainImage') {
							canvas.mainImage = obj;
						}
					});

                    canvas.zoom(1);

                    if (item.canvasWidth && item.canvasHeight) {
                        canvas.fabric.setWidth(item.canvasWidth);
                        canvas.fabric.setHeight(item.canvasHeight);
                        canvas.original.width = item.canvasWidth;
                        canvas.original.height = item.canvasHeight;
                    }

                    canvas.fabric.renderAll();
                    canvas.fabric.calcOffset();
                    $rootScope.isNotLoading();
                    canvas.fitToScreen();

                    $rootScope.$emit('history.loaded');
                    
                    document.fonts.ready.then(function () {
                        console.log("loaded");
                        canvas.fabric.renderAll();
                        $rootScope.isNotLoading();
                    });
				});
			}, 30);

		}
	};

	return history;
}]);
'use strict';

angular.module('ImageEditor')

.factory('saver', ['$rootScope', '$mdDialog', '$http', '$timeout', 'canvas', 'cropper', 'history', function($rootScope, $mdDialog, $http, $timeout, canvas, cropper, history) {

	var saver = {

        saveImage: function(format, quality, name, e, close) {

            canvas.fabric.deactivateAll();
            cropper.stop();

            if ($rootScope.isDemo) {
                return this.handleDemoSiteSave(e);
            }

            if ($rootScope.isIntegrationMode) {
                return this.handleIntegrationModeSave(format, quality, name);
            }

            //this.saveToComputer(format, quality, name);
            this.saveToServer(name, close);
        },

        handleIntegrationModeSave: function(format, quality, name) {
            canvas.zoom(150/canvas.original.height);
            var data = this.getDataUrl(format, quality);

            this.handleCallbacks(data, name);

            //firefox integration mode fix
            $('.md-dialog-container').remove();
            
            $mdDialog.hide();
            $rootScope.pixie.close();
            canvas.zoom(0.5);
        },

        saveToServer: function(name, close) {

            canvas.zoom(150/canvas.original.height);
            var data_jpeg = this.getDataUrl('jpeg', 8);

            canvas.zoom(1);            
            var data_png = this.getDataUrl('png', 8),
                data_json = this.getDataUrl('json', 8);
            canvas.fitToScreen();  
            $rootScope.isLoading();
            jQuery.ajax({
                url: "/wp-admin/admin-ajax.php",
                data: {
                    action: 'wineshop_label_save',
                    order_id: $rootScope.order_id,
                    product_id: $rootScope.product_id,
                    jpeg : data_jpeg,
                    png : data_png,
                    json : data_json
                },
                type: 'POST',
                success: function(res){

                    $rootScope.isNotLoading();
                    if(close){
                        $timeout(function() {
                            if (typeof top.tb_remove == 'function') {
                                top.tb_remove();
                            }

                            var event;
                            var closeEventName = "personalized-wine-designer-modal-close";
                            if (document.createEvent) {
                                event = document.createEvent("HTMLEvents");
                                event.initEvent(closeEventName, true, true);
                            } else {
                                event = document.createEventObject();
                                event.eventType = closeEventName;
                            }

                            event.eventName = closeEventName;

                            if (document.createEvent) {
                                document.dispatchEvent(event);
                                window.parent.document.dispatchEvent(event);
                            } else {
                                document.fireEvent("on" + event.eventType, event);
                                window.parent.document.fireEvent("on" + event.eventType, event);
                            }
                        }, 1000);
                    }
                }
            })
            $mdDialog.hide();
        },

        saveToComputer: function(format, quality, name) {
            canvas.zoom(1);

            var link = document.createElement('a'),
                data = this.getDataUrl(format, quality);

            this.handleCallbacks(data, name);

            //browser supports html5 download attribute
            if (typeof link.download !== 'undefined') {
                link.download = (name || 'image')+'.'+format;
                link.href = data;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }

            //canvas blob and file saver workaround
            else {
                canvas.fabric.lowerCanvasEl.toBlob(function(blob) {
                    saveAs(blob, name+'.'+format);
                }, 'image/'+format, quality);
            }

            $mdDialog.hide();
        },

        handleCallbacks: function(data, name) {
            //replace image src with new data url in original window
            if ($rootScope.getParam('replaceOriginal') && $rootScope.getParam('image')) {
                $rootScope.getParam('image').src = data;
            }

            //send image data to user specified url
            if ($rootScope.getParam('saveUrl')) {
                $http.post($rootScope.getParam('saveUrl'), { data: data, name: name });
            }

            if ($rootScope.getParam('onSave')) {
                var img = $rootScope.getParam('image') || new Image(data);
                $rootScope.getParam('onSave')(data, img, name);
            }
        },

        handleDemoSiteSave: function(e) {
            $('.demo-alert').one($rootScope.animationEndEvent, function() {
                $(this).removeClass('animated shake');  e.target.blur();
            }).addClass('animated shake');
        },

        getDataUrl: function(format, quality) {
            if (format === 'json') {
                return "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(history.getCurrentCanvasState()));
            }
            return canvas.fabric.toDataURL({
                format: format || 'png',
                quality: (quality || 8) / 10
            });
        },

        getThumbDataUrl: function(datas, wantedWidth, wantedHeight){
            // We create an image to receive the Data URI
            var img = document.createElement('img');

            // We put the Data URI in the image's src attribute
            img.src = datas;
            var dataURI = '';
            // When the event "onload" is triggered we can resize the image.
            img.onload = function()
                {        
                    // We create a canvas and get its context.
                    var canvas = document.createElement('canvas');
                    var ctx = canvas.getContext('2d');

                    // We set the dimensions at the wanted size.
                    canvas.width = wantedWidth;
                    canvas.height = wantedHeight;

                    // We resize the image with the canvas method drawImage();
                    ctx.drawImage(this, 0, 0, wantedWidth, wantedHeight);

                    dataURI = canvas.toDataURL();
                    /////////////////////////////////////////
                    // Use and treat your Data URI here !! //
                    /////////////////////////////////////////
                };
            while(dataURI == ''){};
            return dataURI;
        }
	};

	return saver;
}]);
angular.module('image.filters', [])

.controller('FiltersController', ['$scope', '$rootScope', 'canvas', 'filters', function($scope, $rootScope, canvas, filters) {

    $scope.filters = filters;

    $rootScope.$on('history.loaded', function () {
        if ( ! canvas.mainImage) return;

        var appliedFilters = [];

        for (var i = 0; i < canvas.mainImage.filters.length; i++) {
            appliedFilters.push(canvas.mainImage.filters[i].name);
        }

        $scope.$apply(function() {
            filters.appliedFilters = appliedFilters;
        });
    });
}]);

'use strict';

angular.module('image.filters')

.service('filters', ['$rootScope', 'canvas', 'history', function ($rootScope, canvas, history) {

    var filters = {

        all: [
            { name: 'grayscale' },
            { name: 'invert' },
            { name: 'sepia' },
            { name: 'sepia2' },
            {
                name: 'removeWhite',
                options: {
                    distance: { current: 10 },
                    threshold: { current: 50 }
                }
            },
            {
                name: 'brightness',
                options: {
                    brightness: { current: 50 }
                }
            },
            {
                name: 'noise',
                options: {
                    noise: { current: 40, max: 600 }
                }
            },
            {
                name: 'GradientTransparency',
                displayName: 'Gradient',
                options: {
                    threshold: { current: 40 }
                }
            },
            {
                name: 'pixelate',
                options: {
                    blocksize: { max: 40, current: 2 }
                }
            },
            {
                name: 'sharpen',
                uses: 'Convolute',
                matrix: [ 0, -1,  0, -1,  5, -1, 0, -1,  0 ]
            },
            {
                name: 'blur',
                uses: 'Convolute',
                matrix: [ 1/9, 1/9, 1/9, 1/9, 1/9, 1/9, 1/9, 1/9, 1/9 ]
            },
            {
                name: 'emboss',
                uses: 'Convolute',
                matrix: [ 1,   1,  1, 1, 0.7, -1, -1,  -1, -1 ]
            },
            {
                name: 'tint',
                options: {
                    opacity: { current: 0.5, min: 0.1, max: 1, step: 0.1 },
                    color: { colorpicker: true, current: '#FF4081' }
                }
            },
            {
                name: 'multiply',
                options: {
                    color: { colorpicker: true, current: '#FF4081' }
                }
            },
            {
                name: 'blend',
                options: {
                    mode: { current: 'add', select: true, available: ['add', 'multiply', 'subtract', 'diff', 'screen', 'lighten', 'darken'] },
                    alpha: { current: 0.5, min: 0.1, max: 1, step: 0.1 },
                    color: { colorpicker: true, current: '#FF4081' }

                }
            }

        ],

        appliedFilters: [],

        applyFilter: function(filter) {
            if ( ! this.filterExists(filter)) return;

            if (this.filterAlreadyApplied(filter.name)) {
                return this.removeFilter(filter);
            }

            $rootScope.isLoading();
            filters.markAsApplied(filter.name);

            //need to use timeout to display loading spinner properly
            setTimeout(function() {
                canvas.fabric.forEachObject(function(obj) {
                    if (obj.applyFilters) {
                        obj.filters.push(filters.getFilter(filter));
                        obj.applyFilters(canvas.fabric.renderAll.bind(canvas.fabric));
                    }
                });

                history.add('filter: '+(filter.displayName || filter.name), 'brightness-6');
                filters.lastAppliedFilter = filter;
                $rootScope.isNotLoading();
            }, 30);
        },

        removeFilter: function(filter) {
            if ( ! this.filterExists(filter)) return;

            $rootScope.isLoading();
            filters.unmarkAsApplied(filter.name);

            setTimeout(function() {
                canvas.fabric.forEachObject(function(obj) {
                    if (obj.applyFilters) {
                        for (var i = 0; i < obj.filters.length; i++) {
                            if (obj.filters[i].name.toLowerCase() === filter.name.toLowerCase()) {
                                obj.filters.splice(i, 1);
                                obj.applyFilters(canvas.fabric.renderAll.bind(canvas.fabric));
                            }
                        }
                    }
                });

                filters.lastAppliedFilter = false;
                $rootScope.isNotLoading();
            }, 30);
        },

        applyValue: function(filterName, optionName, optionValue) {
            $rootScope.isLoading();

            setTimeout(function() {
                canvas.fabric.forEachObject(function(obj) {
                    if (obj.applyFilters) {
                        for (var i = 0; i < obj.filters.length; i++) {
                            var filter = obj.filters[i];

                            if (filter.type.toLowerCase() === filterName.toLowerCase()) {
                                filter[optionName] = optionValue;
                                obj.applyFilters(canvas.fabric.renderAll.bind(canvas.fabric));
                            }
                        }
                    }
                });

                $rootScope.isNotLoading();
            }, 30);
        },

        filterAlreadyApplied: function(name) {
            return this.appliedFilters.indexOf(name) !== -1
        },

        markAsApplied: function(name) {
            if (this.appliedFilters.indexOf(name) === -1) {
                this.appliedFilters.push(name);
            }
        },

        unmarkAsApplied: function(name) {
            for (var i = 0; i < this.appliedFilters.length; i++) {
                if (this.appliedFilters[i] === name) {
                    this.appliedFilters.splice(i, 1);
                }
            }
        },

        filterExists: function(filter) {
            return fabric.Image.filters[fabric.util.string.capitalize(filter.uses || filter.name, true)] !== undefined;
        },

        getFilter: function(filter) {
            var newFilter;

            if (filter.uses) {
                newFilter = new fabric.Image.filters[fabric.util.string.capitalize(filter.uses, true)]({ matrix: filter.matrix });
            }

            else {
                var options = {};

                for (var key in filter.options) {
                    options[key] = filter.options[key].current;
                }

                newFilter = new fabric.Image.filters[fabric.util.string.capitalize(filter.name, true)](options);
            }

            newFilter.name = filter.name;

            return newFilter;
        },
    };

    return filters;

}]);
angular.module('image.shapes', [])

.controller('SimpleShapesController', ['$scope', '$rootScope', '$timeout', 'canvas', 'simpleShapes', function($scope, $rootScope, $timeout, canvas, simpleShapes) {
	$scope.shapes = simpleShapes;

    $scope.available = ['rect', 'triangle', 'circle', 'ellipse', 'polygon'];

    $scope.isPanelEnabled = function() {
        var obj = canvas.fabric.getActiveObject();
        if(obj && $scope.available.indexOf(obj.name) > -1){
            $scope.setSeletedShape(obj);
            $rootScope.activeObject = obj;
        }
        return obj && $scope.available.indexOf(obj.name) > -1 && simpleShapes.selected.options;
    };

    $scope.setSeletedShape = function(obj){

        $scope.shapes.selectShape(obj.name);
        $scope.shapes.selectedShape = obj;

        var selectedShape = $scope.shapes.selected;

        selectedShape.options.main.fill.current = obj.fill;
        selectedShape.options.main.opacity.current = obj.opacity;
        if(obj.name == 'circle'){
            selectedShape.options.main.radius.current = obj.radius;
        }else if(obj.name == 'ellipse'){
            selectedShape.options.main.rx.current = obj.rx;
            selectedShape.options.main.ry.current = obj.ry;
        }else if(obj.name != 'polygon'){
            selectedShape.options.main.width.current = obj.width;
            selectedShape.options.main.height.current = obj.height;
        }
        jQuery("#shapeBgColor").spectrum("set", obj.fill);
        if(obj.stroke){
            selectedShape.options.border.enabled = true;
            selectedShape.options.border.stroke.current = obj.stroke;
            selectedShape.options.border.strokeWidth.current = obj.strokeWidth;
            jQuery("#borderstroke").spectrum("set", obj.stroke);
        }else{
            selectedShape.options.border.enabled = false;
        }
        if(obj.shadow){
            selectedShape.options.shadow.enabled = true;
            selectedShape.options.shadow.color.current = obj.shadow.color;
            selectedShape.options.shadow.blur.current = obj.shadow.blur;
            selectedShape.options.shadow.offsetX.current = obj.shadow.offsetX;
            selectedShape.options.shadow.offsetY.current = obj.shadow.offsetY;
            jQuery("#shadowcolor").spectrum("set", obj.shadow.color);
        }else{
            selectedShape.options.shadow.enabled = false;
        }

        // $scope.selectedShape['height'] = obj.height;
        // $scope.selectedShape['opacity'] = obj.opacity;
        // $scope.selectedShape['width'] = obj.width;
        // $scope.selectedShape['strokeWidth'] = obj.strokeWidth;
        // $scope.selectedShape['stroke'] = obj.stroke;
        // $scope.selectedShape['shadow'] = obj.shadow;

    };

    // canvas.fabric.on('object:selected', function(object) {
    //     if ($rootScope.activeTab !== 'simple-shapes') return;
    //     simpleShapes.selectShape(object.target.name);
    // });
}]);
'use strict';

angular.module('ImageEditor')

.controller('PhotoController', ['$rootScope', '$scope', '$mdDialog', '$mdToast', '$$rAF', 'canvas', 'history', 'settings', 'saver', function($rootScope, $scope, $mdDialog, $mdToast, $$rAF, canvas, history, settings, saver) {

    $scope.history = history;

    $scope.isDemo = $rootScope.isDemo;
    $scope.canOpenImage = false;
    $scope.canvas = canvas;
    $scope.openImageMode = 'open';

    $scope.canvasWidth = 800;
    $scope.canvasHeight = 600;

    $scope.imageName = 'image';
    $scope.imageType = 'jpeg';
    $scope.imageQuality = 8;
    $scope.photoPath = '';

    $scope.objectsPanelOpen = true;
    $scope.historyPanelOpen = false;

    $rootScope.$on('settings.ready', function() {
        var photos = settings.get('photos').photos;
        //var images = photos.images.items;

        // for (var cat in photos) {
        //     photos[cat].items = new Array(photos[cat].length);
        // };

        $scope.photos = photos;
    });

    $scope.activePhotoCategory = 'user';

    $scope.setActivePhotoCategory = function(name) {
        if ($scope.activePhotoCategory === name) {
            $scope.activePhotoCategory = false;
        } else {
            $scope.activePhotoCategory = name;
        }
    };

    $scope.openUploadDialog = function($event) {
        $mdDialog.show({
            template: $('#main-image-upload-dialog-template').html(),
            targetEvent: $event,
            controller: 'PhotoController',
            clickOutsideToClose: true,
        });
    };

    $scope.transformOpen = function(name, e) {
        var panel = $('#'+name);

        panel.removeClass('transition-out transition-in').show();
        $scope.transformToClickElement(panel, e);

        $$rAF(function() {
            panel.addClass('transition-in').css('transform', '');
            e.currentTarget.blur();
        });
    };

    $scope.transformClose = function(name, e) {
        var panel = $('#'+name);

        panel.addClass('transition-out').removeClass('transition-in');
        $scope.transformToClickElement(panel, e);

        panel.one($rootScope.transitionEndEvent, function() {
            panel.hide().css('transform', '').removeClass('transition-out');
            e.currentTarget.blur();
        });
    };

    $scope.transformToClickElement = function(panel, e) {
        var clickRect = e.target.getBoundingClientRect();
        var panelRect = panel[0].getBoundingClientRect();

        var scaleX = Math.min(0.5, clickRect.width / panelRect.width);
        var scaleY = Math.min(0.5, clickRect.height / panelRect.height);

        panel.css('transform', 'translate3d(' +
            (-panelRect.left + clickRect.left + clickRect.width/2 - panelRect.width/2) + 'px,' +
            (-panelRect.top + clickRect.top + clickRect.height/2 - panelRect.height/2) + 'px,' +
            '0) scale(' + scaleX + ',' + scaleY + ')'
        );
    };


    $scope.openSampleImage = function() {
        canvas.loadMainImage('assets/images/lotus.jpg');
        $scope.closeUploadDialog();
        $rootScope.started = true;
    };


    $scope.showImagePreview = function(url) {
        var historyObject = false;

        try {
            historyObject = JSON.parse(url);
        } catch (e) {
            //
        }

        if (historyObject && historyObject.state) {
            $scope.$apply(function() {
                $scope.canOpenImage = false;
            });

            canvas.fabric.clear();
            history.load(historyObject);
            $scope.closeUploadDialog();
            $rootScope.started = true;
            return;
        }

        fabric.util.loadImage(url, function(image) {
            if (image) {
                $scope.$apply(function() {
                    $('.img-preview').html('').append(image);
                    $scope.canOpenImage = true;
                });
            } else {
                $scope.$apply(function() {
                    $scope.canOpenImage = false;
                });
            }
        });
    };

    $scope.openImage = function() {
        var url = $('.img-preview img').attr('src');
            
        if ( ! url || ! $scope.canOpenImage) return;

        if ((!canvas.fabric._objects.length || ! canvas.mainImage) && ! $rootScope.userPreset) {
            canvas.fabric.clear();
            canvas.loadMainImage(url);
        } else {
            canvas.openImage(url);
        }

        $scope.closeUploadDialog();
        $rootScope.started = true;
    };

    $scope.closeUploadDialog = function() {
        $scope.canUploadImage = false;
        $scope.openImageMode = 'open';
        $('.img-preview').html();
        $mdDialog.hide();
    };


    $scope.addToCanvas = function(category, index, e) {
        if ($scope.loading) return;
        $scope.loading = true;
        //$scope.openPanel('photos', e);
        var img_url = category.path + category.items[index].image;
        // var http = new XMLHttpRequest();
        // http.open('HEAD', img_url, false);
        // http.send();
        // if(http.status==404) img_url = 'assets/images/photos/'+category.name+'/'+index+'.'+category.type;
        fabric.util.loadImage( img_url, function(img) {
            var image = new fabric.Image(img);
            afterAddPhotoToCanvas(image);
        });
        canvas.fitToScreen(); 
    }

    function afterAddPhotoToCanvas(image) {
        image.name = 'photo';
        canvas.fabric.add(image);
        image.scaleToHeight((50 / 100) * canvas.original.height);

        image.center();
        image.setCoords();
        canvas.fabric.setActiveObject(image);
        canvas.fabric.renderAll();
        $rootScope.activeObject = image;

        $scope.$apply(function() {
            $scope.loading = false;
        });

        history.add('Added: Photo', 'favorite');
    }

}]);




angular.module('image.shapes')

.directive('edPhotosCategories', function() {
    return {
        restrict: 'A',
        link: function($scope, el) {

            //load photo images into open category when photos tab is opened
            var unbind = $scope.$watch('activeTab', function(newTab) {
                if (newTab !== 'photos') return;

                var cat = $('.category-photos.open');

                cat.find('img').each(function() {
                    this.src = this.dataset.src;
                });

                cat.parent().addClass('loaded');

                unbind();
            });

            //load photo images for the category that just been opened
            el.on('click', '.category-header', function(e) {
                $scope.$apply(function() {
                    $scope.setActivePhotoCategory(e.target.dataset.name);
                });

                var category = $(e.currentTarget).parent();

                if ( ! category.hasClass('loaded')) {
                    category.addClass('loaded').find('img').each(function() {
                        this.src = this.dataset.src;
                    });
                }
            });
        }
   	}
});
angular.module('image.shapes')

.controller('StickersController', ['$scope', '$rootScope', 'canvas', 'simpleShapes', 'history', 'settings', function($scope, $rootScope, canvas, simpleShapes, history, settings) {
	$scope.shapes = simpleShapes;
    $scope.opacity = 0.9;

    $rootScope.$on('settings.ready', function() {
        var stickers = settings.get('stickers').stickers;

        // for (var i = stickers.length - 1; i >= 0; i--) {
        //     stickers[i].items = new Array(stickers[i].items);
        // };

        $scope.categories = stickers;
    });

    $scope.activeCategory = 'doodles';

    $scope.activeStickerIsSvg = function() {
        var obj = canvas.fabric.getActiveObject();

        return obj && angular.isDefined(obj.svgUid);
    };

    $scope.isPanelEnabled = function() {
        var obj = canvas.fabric.getActiveObject();
        return obj && obj.name === 'sticker' && $rootScope.activeTab === 'stickers';
    };

    $scope.setActiveCategory = function(name) {
        if ($scope.activeCategory === name) {
            $scope.activeCategory = false;
        } else {
            $scope.activeCategory = name;
        }
    };

    $scope.setOpacity = function(opacity) {
        simpleShapes.getShape('sticker').setOpacity(opacity);
        canvas.fabric.renderAll();
    };

    $scope.setColor = function(color) {
        var obj = simpleShapes.getShape('sticker');

        if (obj.isSameColor && obj.isSameColor() || ! obj.paths) {
            obj.setFill(color);
        }
        else if (obj.paths) {
            for (var i = 0; i < obj.paths.length; i++) {
                obj.paths[i].setFill(color);
            }
        }

        canvas.fabric.renderAll();
    };

    $scope.addToCanvas = function(category, index, e) {
        if ($scope.loading) return;
        $scope.loading = true;
        $scope.openPanel('stickers', e);

        if (category.type === 'svg') {
            fabric.loadSVGFromURL(category.path + category.items[index].thumbnail, function (objects, options) {
                var image = fabric.util.groupSVGElements(objects, options);
                afterAddStickerToCanvas(image);
            });
        } else {
            fabric.util.loadImage(category.path + category.items[index].thumbnail, function(img) {
                var image = new fabric.Image(img);
                afterAddStickerToCanvas(image);
            });
        }
    }

    function afterAddStickerToCanvas(image) {
        image.name = 'sticker';
        canvas.fabric.add(image);
        image.scaleToHeight((40 / 100) * canvas.original.height);

        image.center();
        image.setCoords();
        canvas.fabric.setActiveObject(image);
        canvas.fabric.renderAll();

        $scope.$apply(function() {
            $scope.loading = false;
        });
        $rootScope.activeObject = image;
        history.add('Added: Sticker', 'favorite');
    }
}]);
angular.module('image.shapes')

.directive('edStickersCategories', function() {
    return {
        restrict: 'A',
        link: function($scope, el) {

            //load sticker images into open category when stickers tab is opened
            var unbind = $scope.$watch('activeTab', function(newTab) {
                if (newTab !== 'stickers') return;

                var cat = $('.category-stickers.open');

                cat.find('img').each(function() {
                    this.src = this.dataset.src;
                });

                cat.parent().addClass('loaded');

                unbind();
            });

            //load sticker images for the category that just been opened
            el.on('click', '.category-header', function(e) {
                $scope.$apply(function() {
                    $scope.setActiveCategory(e.target.dataset.name);
                });

                var category = $(e.currentTarget).parent();

                if ( ! category.hasClass('loaded')) {
                    category.addClass('loaded').find('img').each(function() {
                        this.src = this.dataset.src;
                    });
                }
            });
        }
   	}
});
angular.module('image.shapes')

.filter('orderOptions', function() {
    return function(items, field, reverse) {
        var filtered = [];
        angular.forEach(items, function(item, key) {
            item.name = key;
            filtered.push(item);
        });
        filtered.sort(function (a, b) {
            return (a[field] > b[field] ? 1 : -1);
        });
        if(reverse) filtered.reverse();

        return filtered;
    };
})

.service('simpleShapes', ['$rootScope', 'canvas', 'polygon', 'history', function ($rootScope, canvas, polygon, history) {

    var shapes = {

        gradients: edGradients,

        textures: new Array(28),

        baseOptions: {
            main: {
                enabled: true,
                opacity: { type: 'slider', current: 1, min: 0.1, max: 1, step: 0.1 },
                fill: { type: 'colorpicker', current: '#263238', hidden: true }
            },
            border: {
                enabled: false,
                onToggle: 'toggleBorder',
                stroke: { type: 'colorpicker', current: '#2196F3', displayName: 'Color' },
                strokeWidth: { type: 'slider', current: 5, max: 40, displayName: 'Width' }
            },
            shadow: {
                enabled: false,
                onToggle: 'toggleShadow',
                color: { type: 'colorpicker', current: 'rgba(0,0,0,0.5)'},
                blur: { type: 'slider', current: 5, max: 80 },
                offsetX: { type: 'slider', current: 8, max: 30 },
                offsetY: { type: 'slider', current: 5, max: 30 }
            }
        },

        available: [],

        selected: false,
        selectedShape: false,

        fillWithGradient: function(index, type) {
            var shape = canvas.fabric.getActiveObject();

            shape.setGradient(type||'fill', this.gradients[index]);

            canvas.fabric.renderAll();
        },

        fillWithImage: function(url) {
            var shape = canvas.fabric.getActiveObject();

            fabric.util.loadImage(url, function(img) {
                shape.setPatternFill({ source: img });
                canvas.fabric.renderAll();
            });
        },

        addToCanvas: function(shape) {
            if ( ! this.shapeExists(shape)) return;
            this.selected = shape;
            console.log(shape);
            jQuery("#shapeBgColor").spectrum("set", shape.fill);
            // if(shape.stroke) jQuery("#borderstroke").spectrum("set", shape.stroke.color);
            // if(shape.shadow) jQuery("#shadowcolor").spectrum("set", shape.shadow.color);

            //we might need to enable a drawing mode instead
            //of added a shape to canvas if we get passed polygon
            if (shape.service && shape.service.enable) {
                return shape.service.enable();
            }

            var fabricShape = this.createNewShape(shape);

            canvas.fabric.add(fabricShape);
            canvas.center(fabricShape);
            canvas.fabric.setActiveObject(fabricShape);
            canvas.fabric.renderAll();
            this.selectedShape = fabricShape;

            history.add('Added: '+shape.name, 'panorama-vertical');
        },

        applyValue: function(group, name, option, value) {
            var setter = 'set'+fabric.util.string.capitalize(option, true),
                shape  = this.getShape(name);

            if (group === 'shadow') {
                return this.applyShadowValue(shape, option, value);
            }

            if (this.selected && this.selected.name === name) {
                console.log(setter);
                //use setter if available, other simply assign the value
                shape[setter] ? shape[setter](value) : shape[option] = value;
                shape.setCoords();
                canvas.fabric.setActiveObject(shape);
                canvas.fabric.renderAll();
            }
        },

        applyShadowValue: function(shape, option, value) {
            if ( ! shape) return;

            var options = {
                color: this.selected.options.shadow.color.current,
                blur: this.selected.options.shadow.blur.current,
                offsetX: this.selected.options.shadow.offsetX.current,
                offsetY: this.selected.options.shadow.offsetY.current
            };

            if (option && value) {
                options[option] = value;
            }

            shape.setShadow(options);
            canvas.fabric.renderAll();
        },

        toggleShadow: function(name, on) {
            if (on) {
                this.applyShadowValue(this.getShape(name));
            } else {
                this.getShape(name).setShadow(false);
                canvas.fabric.renderAll();
            }
        },

        /**
         * Toggle border on/off on active object in the canvas.
         *
         * @param name
         * @param on
         */
        toggleBorder: function(name, on) {
            if (on) {
                this.getShape(name).setStroke(this.selected.options.border.stroke);
            } else {
                this.getShape(name).setStroke(false);
            }

            canvas.fabric.renderAll();
        },

        shapeExists: function(shape) {
            for (var i = 0; i < this.available.length; i++) {
                if (this.available[i].name === shape.name) {
                    return true;
                }
            }
        },

        /**
         * Return a first available fabric object that matches given name.
         *
         * @param name
         * @returns {fabric.Object|*}
         */
        getShape: function(name) {
            var active = canvas.fabric.getActiveObject();

            if (active && active.name === name) {
                return active;
            }

            canvas.fabric.forEachObject(function(obj) {
                if (obj.name === name) {
                    canvas.fabric.setActiveObject(obj);
                    return active = obj;
                }
            });

            return active;
        },

        /**
         * Create new fabric shape from given config object.
         *
         * @param shape
         */
        createNewShape: function(shape) {
            var shapeName = fabric.util.string.capitalize(shape.name, true);

            console.log(shape);
            if (fabric[shapeName]) {

                var options = {
                    strokeWidth: shape.options.border.strokeWidth.current,
                    fill: shape.options.main.fill.current
                };

                angular.forEach(shape.options.main, function(val, key) {
                    if (typeof val !== 'boolean') {
                       options[key] = val.current;
                    }
                });

                if (shape.options.points) {
                    var newShape = new fabric[shapeName](shape.options.points.current, options);
                } else {
                    var newShape = new fabric[shapeName](options);
                }

                newShape.name = shape.name;

                return newShape;
            }
        },

        selectShape: function(name) {
            if ( ! name || this.selected.name === name) return;

            for (var i = 0; i < this.available.length; i++) {
                if (this.available[i].name === name) {
                    return this.selected = this.available[i];
                }
            }
        }
    };

    var circleOptions = angular.copy(shapes.baseOptions);
    circleOptions.main.radius = { type: 'slider', current: 72, min: 20 };

    shapes.available.push({
        name: 'circle',
        options: circleOptions
    });

    var rectOptions = angular.copy(shapes.baseOptions);
    rectOptions.main.width = { type: 'slider', current: 140 };
    rectOptions.main.height = { type: 'slider', current: 140 };

    shapes.available.push({
        name: 'rect',
        displayName: 'rectangle',
        options: rectOptions
    });

    var triangleOptions = angular.copy(shapes.baseOptions);
    triangleOptions.main.width = { type: 'slider', current: 140, min: 25 };
    triangleOptions.main.height = { type: 'slider', current: 140, min: 25 };

    shapes.available.push({
        name: 'triangle',
        options: triangleOptions
    });

    var ellipse = angular.copy(shapes.baseOptions);
    ellipse.main.rx = { type: 'slider', current: 80, displayName: 'horizontal radius' };
    ellipse.main.ry = { type: 'slider', current: 30, displayName: 'vertical radius' };

    shapes.available.push({
        name: 'ellipse',
        options: ellipse
    });

    shapes.available.push({
        name: 'polygon',  options: angular.copy(shapes.baseOptions), service: polygon
    });

    return shapes;
}]);
angular.module('image.shapes')

.service('polygon', ['$rootScope', '$mdDialog', 'canvas', function ($rootScope, $mdDialog, canvas) {

    var self = {

        mode: 'add',
        currentShape: false,

        onMouseMove: function(event) {
            var pos = canvas.fabric.getPointer(event.e);
            if (self.mode === "edit" && self.currentShape) {
                var points = self.currentShape.get("points");
                points[points.length - 1].x = pos.x - self.currentShape.get("left");
                points[points.length - 1].y = pos.y - self.currentShape.get("top");
                self.currentShape.set({
                    points: points
                });
                canvas.fabric.renderAll();
            }
        },

        onMouseDown: function(event) {
            var pos = canvas.fabric.getPointer(event.e);

            if (self.mode === "add") {
                var poly = new fabric.Polygon([{
                    x: pos.x,
                    y: pos.y
                }, {
                    x: pos.x + 0.5,
                    y: pos.y + 0.5
                }], {
                    fill: 'black',
                    opacity: 1,
                    selectable: false
                });
                self.currentShape = poly;
                self.currentShape.name = 'polygon';
                canvas.fabric.add(self.currentShape);
                self.mode = "edit";
            } else if (self.mode === "edit" && self.currentShape && self.currentShape.type === "polygon") {
                var points = self.currentShape.get("points");
                points.push({
                    x: pos.x - self.currentShape.get("left"),
                    y: pos.y - self.currentShape.get("top")
                });
                self.currentShape.set({
                    points: points
                });
                canvas.fabric.renderAll();
            }
        },

        onEscape: function(e) {
            if ((!e && self.currentShape) || e && e.keyCode === 27) {
                if (self.mode === 'edit' || self.mode === 'add') {
                    self.mode = 'normal';
                    self.currentShape.set({
                        selectable: true
                    });

                    self.currentShape._calcDimensions();
                    self.currentShape.setCoords();

                    canvas.fabric.setActiveObject(self.currentShape);
                    canvas.fabric.renderAll();
                } else {
                    self.mode = 'add';
                }

                self.currentShape = null;
            }
        },

        onClick: function(e) {
            var clickedInModal = $(e.target).closest('.md-dialog-container')[0];

            if (e.target.nodeName !== 'CANVAS' && $(e.target).closest('.shape').data('name') !== 'polygon' && !clickedInModal) {
                self.disable();
            }
        },

        enable: function() {
            if (this.enabled) return;

            this.enabled = true;
            canvas.fabric.on('mouse:move', self.onMouseMove);
            canvas.fabric.on('mouse:down', self.onMouseDown);
            fabric.util.addListener(window, 'keyup', self.onEscape);

            setTimeout(function() {
                fabric.util.addListener(window, 'click', self.onClick);
            }, 20);

            $mdDialog.show({
                templateUrl: 'modals/polygon.html',
                clickOutsideToClose: true,
                controller: ['$scope', '$mdDialog', function($scope, $mdDialog) {
                    $scope.closeModal = $mdDialog.hide;
                }]
            });
        },

        disable: function() {
            this.enabled = false;
            canvas.fabric.off('mouse:move', self.onMouseMove);
            canvas.fabric.off('mouse:down', self.onMouseDown);
            fabric.util.removeListener(window, 'keyup', self.onEscape);
            fabric.util.removeListener(window, 'click', self.onClick);
            self.onEscape();
        }
    };

    return self;

}]);
angular.module('ImageEditor')

.controller('ObjectsPanelController', ['$scope', '$rootScope', '$timeout', 'canvas', function($scope, $rootScope, $timeout, canvas) {
	$scope.objects = canvas.fabric._objects || [];
    $rootScope.activeObject = false;
    $scope.sortableOptions = {
        items: '.object:visible',
        scroll: false,
        containment: 'parent',
        start: function(e, ui) {
            console.log("Start");
            console.log(ui.item.index());
            ui.item.data('start', ui.item.index());
        },
        stop: function(e, ui) {
            console.log("Stop");
            console.log(ui.item.index());



        },
        update: function(e, ui) {
            console.log("Update");
            console.log(ui.item.index());

            var start = ui.item.data('start'),
                end   = ui.item.index();


            obj = canvas.fabric.getObjects()[start];

            if ( ! obj) return;

            if (end > start) {
                //send object forwards by the amount of objects it passed
                for (var i = 0; i < (end - start); i++) {
                    canvas.fabric.bringForward(obj);
                    //canvas.fabric.sendBackwards(obj);
                }
            } else {
                //send object backwards by the amount of objects it passed
                for (var i = 0; i < (start - end); i++) {
                    canvas.fabric.sendBackwards(obj);
                    //canvas.fabric.bringForward(obj);
                }
            }

            $timeout(function() {
                canvas.fabric.renderAll();
                start = false; end = false;
            });
        }
    }

    $scope.setAsActive = function(object) {
        if (object) {
            canvas.fabric.setActiveObject(object);
            $rootScope.activeObject = object;
        }
    };

    $scope.toggleVisibility = function(object) {
        if ( ! object) return;

        if (object.visible) {
            object.set({ visible: false, evented: false, selectable: false, hasBorders: false, hasCorners: false });
        } else {
            object.set({ visible: true, evented: true, selectable: true, hasBorders: true, hasCorners: true });
            canvas.fabric.setActiveObject(object);
        }

        canvas.fabric.renderAll();
    };

    $scope.deleteObject = function(object) {
        if (object) {
            canvas.fabric.remove(object);
            canvas.fabric.renderAll();
        }
    };

    $scope.toggleLock = function(object) {
        if ( ! object) return;

        if (object.locked) {
            object.set({
                locked: false,
                selectable: true,
                evented: true,
                lockMovementX: false,
                lockMovementY: false,
                lockRotation: false,
                lockScalingX: false,
                lockScalingY: false,
                lockUniScaling: false,
                hasControls: true,
                hasBorders: true
            });

            canvas.fabric.setActiveObject(object);
        } else {
            object.set({
                locked: true,
                selectable: false,
                evented: false,
                lockMovementX: true,
                lockMovementY: true,
                lockRotation: true,
                lockScalingX: true,
                lockScalingY: true,
                lockUniScaling: true,
                hasControls: false,
                hasBorders: false
            });
        }

        canvas.fabric.renderAll();
    }
}])
.filter('reverse', function() {
  return function(items) {
    return items.slice().reverse();
  };
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbG9ycy5qcyIsImdyYWRpZW50cy5qcyIsImpxdWVyeS5qcyIsImpxdWVyeS11aS5qcyIsImZpbGUtc2F2ZXIuanMiLCJwYWdpbmF0aW9uLmpzIiwic3BlY3RydW0uanMiLCJoYW1tZXIuanMiLCJzY3JvbGxiYXIuanMiLCJhbmd1bGFyLm1pbi5qcyIsImFuZ3VsYXItYW5pbWF0ZS5qcyIsImFuZ3VsYXItYXJpYS5qcyIsImFuZ3VsYXItbWF0ZXJpYWwuanMiLCJhbmd1bGFyLXNvcnRhYmxlLmpzIiwiZmFicmljLmpzIiwiQXBwLmpzIiwiTG9jYWxTdG9yYWdlLmpzIiwiU2V0dGluZ3MuanMiLCJLZXliaW5kcy5qcyIsIkNhbnZhcy5qcyIsImNyb3BwZXIuanMiLCJjcm9wem9uZS5qcyIsImNyb3BDb250cm9sbGVyLmpzIiwiUm90YXRlQ29udHJvbGxlci5qcyIsIkNhbnZhc0JhY2tncm91bmRDb250cm9sbGVyLmpzIiwiUmVzaXplQ29udHJvbGxlci5qcyIsIlJvdW5kZWRDb3JuZXJzQ29udHJvbGxlci5qcyIsInpvb21Db250cm9sbGVyLmpzIiwiVG9wUGFuZWxDb250cm9sbGVyLmpzIiwiVGFicy5qcyIsIlByZXR0eVNjcm9sbGJhci5qcyIsIkNvbG9yUGlja2VyLmpzIiwiRmlsZVVwbG9hZGVyLmpzIiwiVG9nZ2xlUGFuZWxWaXNpYmlsaXR5LmpzIiwiVG9nZ2xlU2lkZWJhci5qcyIsIlRleHQuanMiLCJUZXh0Q29udHJvbGxlci5qcyIsIlRleHRBbGlnbkJ1dHRvbnMuanMiLCJUZXh0RGVjb3JhdGlvbkJ1dHRvbnMuanMiLCJGb250cy5qcyIsIkRyYXdpbmcuanMiLCJEcmF3aW5nQ29udHJvbGxlci5qcyIsIlJlbmRlckJydXNoZXNEaXJlY3RpdmUuanMiLCJIaXN0b3J5LmpzIiwiU2F2ZXIuanMiLCJGaWx0ZXJzQ29udHJvbGxlci5qcyIsIkZpbHRlcnMuanMiLCJTaW1wbGVTaGFwZXNDb250cm9sbGVyLmpzIiwiUGhvdG9Db250cm9sbGVyLmpzIiwiUGhvdG9DYXRlZ29yaWVzLmpzIiwiU3RpY2tlcnNDb250cm9sbGVyLmpzIiwiU3RpY2tlcnNDYXRlZ29yaWVzLmpzIiwiU2ltcGxlU2hhcGVzLmpzIiwiUG9seWdvbi5qcyIsIk9iamVjdHNQYW5lbENvbnRyb2xsZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNwS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdDRHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDclhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDcFVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMvdUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMxUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDMWxFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ25WQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2xrZUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDOVZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM3UEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN0REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ25CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3RHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDcFZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN0RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM1WUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3hHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNoSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2xGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDMURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2pRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDaEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNuREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDZkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3ZIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN2SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDakJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDckJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDcE9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN2TUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzdEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2hIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3BCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMzTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ25FQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNyTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMzRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDalJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3BIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJzY3JpcHRzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBjb2xvcnNGb3JQaWNrZXIgPSBbJyNEMjRENTcnLCAnI0YyMjYxMycsICcjRDkxRTE4JywgJyM5NjI4MUInLCAnI0VGNDgzNicsICcjRDY0NTQxJywgJyNDMDM5MkInLCAnI0NGMDAwRicsICcjRTc0QzNDJywgJyNEQjBBNUInLCAnI0Y2NDc0NycsICcjRjFBOUEwJywgJyNEMjUyN0YnLCAnI0UwODI4MycsICcjRjYyNDU5JywgJyNFMjZBNkEnLCAnI0RDQzZFMCcsICcjNjYzMzk5JywgJyM2NzQxNzInLCAnI0FFQThEMycsICcjOTEzRDg4JywgJyM5QTEyQjMnLCAnI0JGNTVFQycsICcjQkU5MEQ0JywgJyM4RTQ0QUQnLCAnIzlCNTlCNicsICcjNDQ2Q0IzJywgJyNFNEYxRkUnLCAnIzQxODNENycsICcjNTlBQkUzJywgJyM4MUNGRTAnLCAnIzUyQjNEOScsICcjQzVFRkY3JywgJyMyMkE3RjAnLCAnIzM0OThEQicsICcjMkMzRTUwJywgJyMxOUI1RkUnLCAnIzMzNkU3QicsICcjMjIzMTNGJywgJyM2QkI5RjAnLCAnIzFFOEJDMycsICcjM0E1MzlCJywgJyMzNDQ5NUUnLCAnIzY3ODA5RicsICcjMjU3NEE5JywgJyMxRjNBOTMnLCAnIzg5QzRGNCcsICcjNEI3N0JFJywgJyM1Qzk3QkYnLCAnIzRFQ0RDNCcsICcjQTJERUQwJywgJyM4N0QzN0MnLCAnIzkwQzY5NScsICcjMjZBNjVCJywgJyMwM0M5QTknLCAnIzY4QzNBMycsICcjNjVDNkJCJywgJyMxQkJDOUInLCAnIzFCQTM5QycsICcjNjZDQzk5JywgJyMzNkQ3QjcnLCAnI0M4RjdDNScsICcjODZFMkQ1JywgJyMyRUNDNzEnLCAnIzE2YTA4NScsICcjM0ZDMzgwJywgJyMwMTk4NzUnLCAnIzAzQTY3OCcsICcjNERBRjdDJywgJyMyQUJCOUInLCAnIzAwQjE2QScsICcjMUU4MjRDJywgJyMwNDkzNzInLCAnIzI2QzI4MScsICcjRkRFM0E3JywgJyNGODk0MDYnLCAnI0VCOTUzMicsICcjRTg3RTA0JywgJyNGNEIzNTAnLCAnI0YyNzg0QicsICcjRUI5NzRFJywgJyNGNUFCMzUnLCAnI0QzNTQwMCcsICcjRjM5QzEyJywgJyNGOTY5MEUnLCAnI0Y5QkYzQicsICcjRjI3OTM1JywgJyNFNjdFMjInLCAnI2VjZWNlYycsICcjNkM3QTg5JywgJyNEMkQ3RDMnLCAnI0VFRUVFRScsICcjQkRDM0M3JywgJyNFQ0YwRjEnLCAnIzk1QTVBNicsICcjREFERkUxJywgJyNBQkI3QjcnLCAnI0YyRjFFRicsICcjQkZCRkJGJywgJyNFNkUyQUYnLCAnI0E3QTM3RScsICcjRUZFQ0NBJywgJyMwNDYzODAnLCAnIzAwMkYyRicsICcjNDY4OTY2JywgJyNGRkYwQTUnLCAnI0ZGQjAzQicsICcjQjY0OTI2JywgJyM4RTI4MDAnLCAnIzFFMUUyMCddOyIsInZhciBlZEdyYWRpZW50cyA9IHtcclxuICAgIDE6IHtcclxuICAgICAgICB0eXBlOiAnbGluZWFyJyxcclxuICAgICAgICB4MTogLTgwLFxyXG4gICAgICAgIHkxOiAwLFxyXG4gICAgICAgIHgyOiA4MCxcclxuICAgICAgICB5MjogMCxcclxuICAgICAgICBjb2xvclN0b3BzOiB7XHJcbiAgICAgICAgICAgIDA6ICcjZmZlNDdiJyxcclxuICAgICAgICAgICAgMTogJ3JnYigxMTEsMTU0LDIxMSknXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAyOiAge1xyXG4gICAgICAgIHR5cGU6ICdsaW5lYXInLFxyXG4gICAgICAgIHgxOiAwLFxyXG4gICAgICAgIHkxOiAtMTIwLFxyXG4gICAgICAgIHgyOiAwLFxyXG4gICAgICAgIHkyOiAxMjAsXHJcbiAgICAgICAgY29sb3JTdG9wczoge1xyXG4gICAgICAgICAgICAwOiAnI2ZmNDA0MCcsXHJcbiAgICAgICAgICAgIDE6ICcjZTYzOTliJ1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgMzoge1xyXG4gICAgICAgIHR5cGU6ICdsaW5lYXInLFxyXG4gICAgICAgIHgxOiAtOTAsXHJcbiAgICAgICAgeTE6IC05MCxcclxuICAgICAgICB4MjogOTAsXHJcbiAgICAgICAgeTI6IDkwLFxyXG4gICAgICAgIGNvbG9yU3RvcHM6IHtcclxuICAgICAgICAgICAgMDogJ3JnYigxNjYsMTExLDIxMyknLFxyXG4gICAgICAgICAgICAwLjU6ICdyZ2JhKDEwNiwgNzIsIDIxNSwgMC41KScsXHJcbiAgICAgICAgICAgIDE6ICcjMjAwNzcyJ1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgNDoge1xyXG4gICAgICAgIHR5cGU6ICdyYWRpYWwnLFxyXG4gICAgICAgIHIxOiAxMDAsXHJcbiAgICAgICAgcjI6IDEwLFxyXG4gICAgICAgIHgxOiAwLFxyXG4gICAgICAgIHkxOiAwLFxyXG4gICAgICAgIHgyOiAwLFxyXG4gICAgICAgIHkyOiAwLFxyXG4gICAgICAgIGNvbG9yU3RvcHM6IHtcclxuICAgICAgICAgICAgMDogJyNGRjRGNEYnLFxyXG4gICAgICAgICAgICAxOiAncmdiKDI1NSwgMjM5LCA2NCknXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICA1OiB7XHJcbiAgICAgICAgdHlwZTogJ3JhZGlhbCcsXHJcbiAgICAgICAgcjE6IDEwMCxcclxuICAgICAgICByMjogMTAsXHJcbiAgICAgICAgeDE6IDAsXHJcbiAgICAgICAgeTE6IDAsXHJcbiAgICAgICAgeDI6IDIwLFxyXG4gICAgICAgIHkyOiAyMCxcclxuICAgICAgICBjb2xvclN0b3BzOiB7XHJcbiAgICAgICAgICAgIDA6ICcjZmZlNDdiJyxcclxuICAgICAgICAgICAgMC41OiAncmdiKDExMSwxNTQsMjExKScsXHJcbiAgICAgICAgICAgIDE6ICdyZ2IoMTY2LDExMSwyMTMpJ1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgNjoge1xyXG4gICAgICAgIHR5cGU6ICdyYWRpYWwnLFxyXG4gICAgICAgIHIxOiA1MCxcclxuICAgICAgICByMjogODAsXHJcbiAgICAgICAgeDE6IDQ1LFxyXG4gICAgICAgIHkxOiA0NSxcclxuICAgICAgICB4MjogNTIsXHJcbiAgICAgICAgeTI6IDUwLFxyXG4gICAgICAgIGNvbG9yU3RvcHM6IHtcclxuICAgICAgICAgICAgMDogJ3JnYigxNTUsIDIzNywgMCknLFxyXG4gICAgICAgICAgICAxOiAncmdiYSgwLCAxNjQsIDEyOCwwLjQpJ1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgNzoge1xyXG4gICAgICAgIHR5cGU6ICdsaW5lYXInLFxyXG4gICAgICAgIHgxOiAtOTAsXHJcbiAgICAgICAgeTE6IC05MCxcclxuICAgICAgICB4MjogOTAsXHJcbiAgICAgICAgeTI6IDkwLFxyXG4gICAgICAgIGNvbG9yU3RvcHM6IHtcclxuICAgICAgICAgICAgMDogJyM5ZWNiMmQnLFxyXG4gICAgICAgICAgICAwLjU6ICcjNzJhYTAwJyxcclxuICAgICAgICAgICAgMTogJyNiZmQyNTUnXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICA4OiB7XHJcbiAgICAgICAgdHlwZTogJ3JhZGlhbCcsXHJcbiAgICAgICAgcjE6IDEwMCxcclxuICAgICAgICByMjogNTAsXHJcbiAgICAgICAgeDE6IDMwLFxyXG4gICAgICAgIHkxOiAwLFxyXG4gICAgICAgIHgyOiAwLFxyXG4gICAgICAgIHkyOiAwLFxyXG4gICAgICAgIGNvbG9yU3RvcHM6IHtcclxuICAgICAgICAgICAgMDogJyNhZWJjYmYnLFxyXG4gICAgICAgICAgICAxOiAnIzBhMDgwOSdcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIDk6IHtcclxuICAgICAgICB0eXBlOiAnbGluZWFyJyxcclxuICAgICAgICB4MTogLTgwLFxyXG4gICAgICAgIHkxOiAwLFxyXG4gICAgICAgIHgyOiA4MCxcclxuICAgICAgICB5MjogMCxcclxuICAgICAgICBjb2xvclN0b3BzOiB7XHJcbiAgICAgICAgICAgIDA6ICcjZmZmZmZmJyxcclxuICAgICAgICAgICAgMTogJyNmNmY2ZjYnXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIDEwOiAge1xyXG4gICAgICAgIHR5cGU6ICdsaW5lYXInLFxyXG4gICAgICAgIHgxOiAwLFxyXG4gICAgICAgIHkxOiAtMTIwLFxyXG4gICAgICAgIHgyOiAwLFxyXG4gICAgICAgIHkyOiAxMjAsXHJcbiAgICAgICAgY29sb3JTdG9wczoge1xyXG4gICAgICAgICAgICAwOiAnI2ZlZmNlYScsXHJcbiAgICAgICAgICAgIDE6ICcjZjFkYTM2J1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAxMToge1xyXG4gICAgICAgIHR5cGU6ICdsaW5lYXInLFxyXG4gICAgICAgIHgxOiAtOTAsXHJcbiAgICAgICAgeTE6IC05MCxcclxuICAgICAgICB4MjogOTAsXHJcbiAgICAgICAgeTI6IDkwLFxyXG4gICAgICAgIGNvbG9yU3RvcHM6IHtcclxuICAgICAgICAgICAgMDogJ3JnYigxNjYsMTExLDIxMyknLFxyXG4gICAgICAgICAgICAwLjU6ICdyZ2JhKDEwNiwgNzIsIDIxNSwgMC41KScsXHJcbiAgICAgICAgICAgIDE6ICcjZmYxYTAwJ1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAxMjogIHtcclxuICAgICAgICB0eXBlOiAnbGluZWFyJyxcclxuICAgICAgICB4MTogMCxcclxuICAgICAgICB5MTogLTEyMCxcclxuICAgICAgICB4MjogMCxcclxuICAgICAgICB5MjogMTIwLFxyXG4gICAgICAgIGNvbG9yU3RvcHM6IHtcclxuICAgICAgICAgICAgMDogJyNiN2RlZWQnLFxyXG4gICAgICAgICAgICAxOiAnIzIxYjRlMidcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgMTM6IHtcclxuICAgICAgICB0eXBlOiAnbGluZWFyJyxcclxuICAgICAgICB4MTogLTgwLFxyXG4gICAgICAgIHkxOiAxMDAsXHJcbiAgICAgICAgeDI6IDgwLFxyXG4gICAgICAgIHkyOiAtMTAwLFxyXG4gICAgICAgIGNvbG9yU3RvcHM6IHtcclxuICAgICAgICAgICAgMDogJyNmZmU0N2InLFxyXG4gICAgICAgICAgICAxOiAncmdiKDExMSwxNTQsMjExKSdcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG59OyIsIi8qISBqUXVlcnkgdjIuMS4zIHwgKGMpIDIwMDUsIDIwMTQgalF1ZXJ5IEZvdW5kYXRpb24sIEluYy4gfCBqcXVlcnkub3JnL2xpY2Vuc2UgKi9cclxuIWZ1bmN0aW9uKGEsYil7XCJvYmplY3RcIj09dHlwZW9mIG1vZHVsZSYmXCJvYmplY3RcIj09dHlwZW9mIG1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWEuZG9jdW1lbnQ/YihhLCEwKTpmdW5jdGlvbihhKXtpZighYS5kb2N1bWVudCl0aHJvdyBuZXcgRXJyb3IoXCJqUXVlcnkgcmVxdWlyZXMgYSB3aW5kb3cgd2l0aCBhIGRvY3VtZW50XCIpO3JldHVybiBiKGEpfTpiKGEpfShcInVuZGVmaW5lZFwiIT10eXBlb2Ygd2luZG93P3dpbmRvdzp0aGlzLGZ1bmN0aW9uKGEsYil7dmFyIGM9W10sZD1jLnNsaWNlLGU9Yy5jb25jYXQsZj1jLnB1c2gsZz1jLmluZGV4T2YsaD17fSxpPWgudG9TdHJpbmcsaj1oLmhhc093blByb3BlcnR5LGs9e30sbD1hLmRvY3VtZW50LG09XCIyLjEuM1wiLG49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IG4uZm4uaW5pdChhLGIpfSxvPS9eW1xcc1xcdUZFRkZcXHhBMF0rfFtcXHNcXHVGRUZGXFx4QTBdKyQvZyxwPS9eLW1zLS8scT0vLShbXFxkYS16XSkvZ2kscj1mdW5jdGlvbihhLGIpe3JldHVybiBiLnRvVXBwZXJDYXNlKCl9O24uZm49bi5wcm90b3R5cGU9e2pxdWVyeTptLGNvbnN0cnVjdG9yOm4sc2VsZWN0b3I6XCJcIixsZW5ndGg6MCx0b0FycmF5OmZ1bmN0aW9uKCl7cmV0dXJuIGQuY2FsbCh0aGlzKX0sZ2V0OmZ1bmN0aW9uKGEpe3JldHVybiBudWxsIT1hPzA+YT90aGlzW2ErdGhpcy5sZW5ndGhdOnRoaXNbYV06ZC5jYWxsKHRoaXMpfSxwdXNoU3RhY2s6ZnVuY3Rpb24oYSl7dmFyIGI9bi5tZXJnZSh0aGlzLmNvbnN0cnVjdG9yKCksYSk7cmV0dXJuIGIucHJldk9iamVjdD10aGlzLGIuY29udGV4dD10aGlzLmNvbnRleHQsYn0sZWFjaDpmdW5jdGlvbihhLGIpe3JldHVybiBuLmVhY2godGhpcyxhLGIpfSxtYXA6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKG4ubWFwKHRoaXMsZnVuY3Rpb24oYixjKXtyZXR1cm4gYS5jYWxsKGIsYyxiKX0pKX0sc2xpY2U6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soZC5hcHBseSh0aGlzLGFyZ3VtZW50cykpfSxmaXJzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVxKDApfSxsYXN0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZXEoLTEpfSxlcTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmxlbmd0aCxjPSthKygwPmE/YjowKTtyZXR1cm4gdGhpcy5wdXNoU3RhY2soYz49MCYmYj5jP1t0aGlzW2NdXTpbXSl9LGVuZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnByZXZPYmplY3R8fHRoaXMuY29uc3RydWN0b3IobnVsbCl9LHB1c2g6Zixzb3J0OmMuc29ydCxzcGxpY2U6Yy5zcGxpY2V9LG4uZXh0ZW5kPW4uZm4uZXh0ZW5kPWZ1bmN0aW9uKCl7dmFyIGEsYixjLGQsZSxmLGc9YXJndW1lbnRzWzBdfHx7fSxoPTEsaT1hcmd1bWVudHMubGVuZ3RoLGo9ITE7Zm9yKFwiYm9vbGVhblwiPT10eXBlb2YgZyYmKGo9ZyxnPWFyZ3VtZW50c1toXXx8e30saCsrKSxcIm9iamVjdFwiPT10eXBlb2YgZ3x8bi5pc0Z1bmN0aW9uKGcpfHwoZz17fSksaD09PWkmJihnPXRoaXMsaC0tKTtpPmg7aCsrKWlmKG51bGwhPShhPWFyZ3VtZW50c1toXSkpZm9yKGIgaW4gYSljPWdbYl0sZD1hW2JdLGchPT1kJiYoaiYmZCYmKG4uaXNQbGFpbk9iamVjdChkKXx8KGU9bi5pc0FycmF5KGQpKSk/KGU/KGU9ITEsZj1jJiZuLmlzQXJyYXkoYyk/YzpbXSk6Zj1jJiZuLmlzUGxhaW5PYmplY3QoYyk/Yzp7fSxnW2JdPW4uZXh0ZW5kKGosZixkKSk6dm9pZCAwIT09ZCYmKGdbYl09ZCkpO3JldHVybiBnfSxuLmV4dGVuZCh7ZXhwYW5kbzpcImpRdWVyeVwiKyhtK01hdGgucmFuZG9tKCkpLnJlcGxhY2UoL1xcRC9nLFwiXCIpLGlzUmVhZHk6ITAsZXJyb3I6ZnVuY3Rpb24oYSl7dGhyb3cgbmV3IEVycm9yKGEpfSxub29wOmZ1bmN0aW9uKCl7fSxpc0Z1bmN0aW9uOmZ1bmN0aW9uKGEpe3JldHVyblwiZnVuY3Rpb25cIj09PW4udHlwZShhKX0saXNBcnJheTpBcnJheS5pc0FycmF5LGlzV2luZG93OmZ1bmN0aW9uKGEpe3JldHVybiBudWxsIT1hJiZhPT09YS53aW5kb3d9LGlzTnVtZXJpYzpmdW5jdGlvbihhKXtyZXR1cm4hbi5pc0FycmF5KGEpJiZhLXBhcnNlRmxvYXQoYSkrMT49MH0saXNQbGFpbk9iamVjdDpmdW5jdGlvbihhKXtyZXR1cm5cIm9iamVjdFwiIT09bi50eXBlKGEpfHxhLm5vZGVUeXBlfHxuLmlzV2luZG93KGEpPyExOmEuY29uc3RydWN0b3ImJiFqLmNhbGwoYS5jb25zdHJ1Y3Rvci5wcm90b3R5cGUsXCJpc1Byb3RvdHlwZU9mXCIpPyExOiEwfSxpc0VtcHR5T2JqZWN0OmZ1bmN0aW9uKGEpe3ZhciBiO2ZvcihiIGluIGEpcmV0dXJuITE7cmV0dXJuITB9LHR5cGU6ZnVuY3Rpb24oYSl7cmV0dXJuIG51bGw9PWE/YStcIlwiOlwib2JqZWN0XCI9PXR5cGVvZiBhfHxcImZ1bmN0aW9uXCI9PXR5cGVvZiBhP2hbaS5jYWxsKGEpXXx8XCJvYmplY3RcIjp0eXBlb2YgYX0sZ2xvYmFsRXZhbDpmdW5jdGlvbihhKXt2YXIgYixjPWV2YWw7YT1uLnRyaW0oYSksYSYmKDE9PT1hLmluZGV4T2YoXCJ1c2Ugc3RyaWN0XCIpPyhiPWwuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKSxiLnRleHQ9YSxsLmhlYWQuYXBwZW5kQ2hpbGQoYikucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChiKSk6YyhhKSl9LGNhbWVsQ2FzZTpmdW5jdGlvbihhKXtyZXR1cm4gYS5yZXBsYWNlKHAsXCJtcy1cIikucmVwbGFjZShxLHIpfSxub2RlTmFtZTpmdW5jdGlvbihhLGIpe3JldHVybiBhLm5vZGVOYW1lJiZhLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT1iLnRvTG93ZXJDYXNlKCl9LGVhY2g6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGU9MCxmPWEubGVuZ3RoLGc9cyhhKTtpZihjKXtpZihnKXtmb3IoO2Y+ZTtlKyspaWYoZD1iLmFwcGx5KGFbZV0sYyksZD09PSExKWJyZWFrfWVsc2UgZm9yKGUgaW4gYSlpZihkPWIuYXBwbHkoYVtlXSxjKSxkPT09ITEpYnJlYWt9ZWxzZSBpZihnKXtmb3IoO2Y+ZTtlKyspaWYoZD1iLmNhbGwoYVtlXSxlLGFbZV0pLGQ9PT0hMSlicmVha31lbHNlIGZvcihlIGluIGEpaWYoZD1iLmNhbGwoYVtlXSxlLGFbZV0pLGQ9PT0hMSlicmVhaztyZXR1cm4gYX0sdHJpbTpmdW5jdGlvbihhKXtyZXR1cm4gbnVsbD09YT9cIlwiOihhK1wiXCIpLnJlcGxhY2UobyxcIlwiKX0sbWFrZUFycmF5OmZ1bmN0aW9uKGEsYil7dmFyIGM9Ynx8W107cmV0dXJuIG51bGwhPWEmJihzKE9iamVjdChhKSk/bi5tZXJnZShjLFwic3RyaW5nXCI9PXR5cGVvZiBhP1thXTphKTpmLmNhbGwoYyxhKSksY30saW5BcnJheTpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIG51bGw9PWI/LTE6Zy5jYWxsKGIsYSxjKX0sbWVyZ2U6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9K2IubGVuZ3RoLGQ9MCxlPWEubGVuZ3RoO2M+ZDtkKyspYVtlKytdPWJbZF07cmV0dXJuIGEubGVuZ3RoPWUsYX0sZ3JlcDpmdW5jdGlvbihhLGIsYyl7Zm9yKHZhciBkLGU9W10sZj0wLGc9YS5sZW5ndGgsaD0hYztnPmY7ZisrKWQ9IWIoYVtmXSxmKSxkIT09aCYmZS5wdXNoKGFbZl0pO3JldHVybiBlfSxtYXA6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGY9MCxnPWEubGVuZ3RoLGg9cyhhKSxpPVtdO2lmKGgpZm9yKDtnPmY7ZisrKWQ9YihhW2ZdLGYsYyksbnVsbCE9ZCYmaS5wdXNoKGQpO2Vsc2UgZm9yKGYgaW4gYSlkPWIoYVtmXSxmLGMpLG51bGwhPWQmJmkucHVzaChkKTtyZXR1cm4gZS5hcHBseShbXSxpKX0sZ3VpZDoxLHByb3h5OmZ1bmN0aW9uKGEsYil7dmFyIGMsZSxmO3JldHVyblwic3RyaW5nXCI9PXR5cGVvZiBiJiYoYz1hW2JdLGI9YSxhPWMpLG4uaXNGdW5jdGlvbihhKT8oZT1kLmNhbGwoYXJndW1lbnRzLDIpLGY9ZnVuY3Rpb24oKXtyZXR1cm4gYS5hcHBseShifHx0aGlzLGUuY29uY2F0KGQuY2FsbChhcmd1bWVudHMpKSl9LGYuZ3VpZD1hLmd1aWQ9YS5ndWlkfHxuLmd1aWQrKyxmKTp2b2lkIDB9LG5vdzpEYXRlLm5vdyxzdXBwb3J0Omt9KSxuLmVhY2goXCJCb29sZWFuIE51bWJlciBTdHJpbmcgRnVuY3Rpb24gQXJyYXkgRGF0ZSBSZWdFeHAgT2JqZWN0IEVycm9yXCIuc3BsaXQoXCIgXCIpLGZ1bmN0aW9uKGEsYil7aFtcIltvYmplY3QgXCIrYitcIl1cIl09Yi50b0xvd2VyQ2FzZSgpfSk7ZnVuY3Rpb24gcyhhKXt2YXIgYj1hLmxlbmd0aCxjPW4udHlwZShhKTtyZXR1cm5cImZ1bmN0aW9uXCI9PT1jfHxuLmlzV2luZG93KGEpPyExOjE9PT1hLm5vZGVUeXBlJiZiPyEwOlwiYXJyYXlcIj09PWN8fDA9PT1ifHxcIm51bWJlclwiPT10eXBlb2YgYiYmYj4wJiZiLTEgaW4gYX12YXIgdD1mdW5jdGlvbihhKXt2YXIgYixjLGQsZSxmLGcsaCxpLGosayxsLG0sbixvLHAscSxyLHMsdCx1PVwic2l6emxlXCIrMSpuZXcgRGF0ZSx2PWEuZG9jdW1lbnQsdz0wLHg9MCx5PWhiKCksej1oYigpLEE9aGIoKSxCPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGE9PT1iJiYobD0hMCksMH0sQz0xPDwzMSxEPXt9Lmhhc093blByb3BlcnR5LEU9W10sRj1FLnBvcCxHPUUucHVzaCxIPUUucHVzaCxJPUUuc2xpY2UsSj1mdW5jdGlvbihhLGIpe2Zvcih2YXIgYz0wLGQ9YS5sZW5ndGg7ZD5jO2MrKylpZihhW2NdPT09YilyZXR1cm4gYztyZXR1cm4tMX0sSz1cImNoZWNrZWR8c2VsZWN0ZWR8YXN5bmN8YXV0b2ZvY3VzfGF1dG9wbGF5fGNvbnRyb2xzfGRlZmVyfGRpc2FibGVkfGhpZGRlbnxpc21hcHxsb29wfG11bHRpcGxlfG9wZW58cmVhZG9ubHl8cmVxdWlyZWR8c2NvcGVkXCIsTD1cIltcXFxceDIwXFxcXHRcXFxcclxcXFxuXFxcXGZdXCIsTT1cIig/OlxcXFxcXFxcLnxbXFxcXHctXXxbXlxcXFx4MDAtXFxcXHhhMF0pK1wiLE49TS5yZXBsYWNlKFwid1wiLFwidyNcIiksTz1cIlxcXFxbXCIrTCtcIiooXCIrTStcIikoPzpcIitMK1wiKihbKl4kfCF+XT89KVwiK0wrXCIqKD86JygoPzpcXFxcXFxcXC58W15cXFxcXFxcXCddKSopJ3xcXFwiKCg/OlxcXFxcXFxcLnxbXlxcXFxcXFxcXFxcIl0pKilcXFwifChcIitOK1wiKSl8KVwiK0wrXCIqXFxcXF1cIixQPVwiOihcIitNK1wiKSg/OlxcXFwoKCgnKCg/OlxcXFxcXFxcLnxbXlxcXFxcXFxcJ10pKiknfFxcXCIoKD86XFxcXFxcXFwufFteXFxcXFxcXFxcXFwiXSkqKVxcXCIpfCgoPzpcXFxcXFxcXC58W15cXFxcXFxcXCgpW1xcXFxdXXxcIitPK1wiKSopfC4qKVxcXFwpfClcIixRPW5ldyBSZWdFeHAoTCtcIitcIixcImdcIiksUj1uZXcgUmVnRXhwKFwiXlwiK0wrXCIrfCgoPzpefFteXFxcXFxcXFxdKSg/OlxcXFxcXFxcLikqKVwiK0wrXCIrJFwiLFwiZ1wiKSxTPW5ldyBSZWdFeHAoXCJeXCIrTCtcIiosXCIrTCtcIipcIiksVD1uZXcgUmVnRXhwKFwiXlwiK0wrXCIqKFs+K35dfFwiK0wrXCIpXCIrTCtcIipcIiksVT1uZXcgUmVnRXhwKFwiPVwiK0wrXCIqKFteXFxcXF0nXFxcIl0qPylcIitMK1wiKlxcXFxdXCIsXCJnXCIpLFY9bmV3IFJlZ0V4cChQKSxXPW5ldyBSZWdFeHAoXCJeXCIrTitcIiRcIiksWD17SUQ6bmV3IFJlZ0V4cChcIl4jKFwiK00rXCIpXCIpLENMQVNTOm5ldyBSZWdFeHAoXCJeXFxcXC4oXCIrTStcIilcIiksVEFHOm5ldyBSZWdFeHAoXCJeKFwiK00ucmVwbGFjZShcIndcIixcIncqXCIpK1wiKVwiKSxBVFRSOm5ldyBSZWdFeHAoXCJeXCIrTyksUFNFVURPOm5ldyBSZWdFeHAoXCJeXCIrUCksQ0hJTEQ6bmV3IFJlZ0V4cChcIl46KG9ubHl8Zmlyc3R8bGFzdHxudGh8bnRoLWxhc3QpLShjaGlsZHxvZi10eXBlKSg/OlxcXFwoXCIrTCtcIiooZXZlbnxvZGR8KChbKy1dfCkoXFxcXGQqKW58KVwiK0wrXCIqKD86KFsrLV18KVwiK0wrXCIqKFxcXFxkKyl8KSlcIitMK1wiKlxcXFwpfClcIixcImlcIiksYm9vbDpuZXcgUmVnRXhwKFwiXig/OlwiK0srXCIpJFwiLFwiaVwiKSxuZWVkc0NvbnRleHQ6bmV3IFJlZ0V4cChcIl5cIitMK1wiKls+K35dfDooZXZlbnxvZGR8ZXF8Z3R8bHR8bnRofGZpcnN0fGxhc3QpKD86XFxcXChcIitMK1wiKigoPzotXFxcXGQpP1xcXFxkKilcIitMK1wiKlxcXFwpfCkoPz1bXi1dfCQpXCIsXCJpXCIpfSxZPS9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2ksWj0vXmhcXGQkL2ksJD0vXltee10rXFx7XFxzKlxcW25hdGl2ZSBcXHcvLF89L14oPzojKFtcXHctXSspfChcXHcrKXxcXC4oW1xcdy1dKykpJC8sYWI9L1srfl0vLGJiPS8nfFxcXFwvZyxjYj1uZXcgUmVnRXhwKFwiXFxcXFxcXFwoW1xcXFxkYS1mXXsxLDZ9XCIrTCtcIj98KFwiK0wrXCIpfC4pXCIsXCJpZ1wiKSxkYj1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9XCIweFwiK2ItNjU1MzY7cmV0dXJuIGQhPT1kfHxjP2I6MD5kP1N0cmluZy5mcm9tQ2hhckNvZGUoZCs2NTUzNik6U3RyaW5nLmZyb21DaGFyQ29kZShkPj4xMHw1NTI5NiwxMDIzJmR8NTYzMjApfSxlYj1mdW5jdGlvbigpe20oKX07dHJ5e0guYXBwbHkoRT1JLmNhbGwodi5jaGlsZE5vZGVzKSx2LmNoaWxkTm9kZXMpLEVbdi5jaGlsZE5vZGVzLmxlbmd0aF0ubm9kZVR5cGV9Y2F0Y2goZmIpe0g9e2FwcGx5OkUubGVuZ3RoP2Z1bmN0aW9uKGEsYil7Ry5hcHBseShhLEkuY2FsbChiKSl9OmZ1bmN0aW9uKGEsYil7dmFyIGM9YS5sZW5ndGgsZD0wO3doaWxlKGFbYysrXT1iW2QrK10pO2EubGVuZ3RoPWMtMX19fWZ1bmN0aW9uIGdiKGEsYixkLGUpe3ZhciBmLGgsaixrLGwsbyxyLHMsdyx4O2lmKChiP2Iub3duZXJEb2N1bWVudHx8Yjp2KSE9PW4mJm0oYiksYj1ifHxuLGQ9ZHx8W10saz1iLm5vZGVUeXBlLFwic3RyaW5nXCIhPXR5cGVvZiBhfHwhYXx8MSE9PWsmJjkhPT1rJiYxMSE9PWspcmV0dXJuIGQ7aWYoIWUmJnApe2lmKDExIT09ayYmKGY9Xy5leGVjKGEpKSlpZihqPWZbMV0pe2lmKDk9PT1rKXtpZihoPWIuZ2V0RWxlbWVudEJ5SWQoaiksIWh8fCFoLnBhcmVudE5vZGUpcmV0dXJuIGQ7aWYoaC5pZD09PWopcmV0dXJuIGQucHVzaChoKSxkfWVsc2UgaWYoYi5vd25lckRvY3VtZW50JiYoaD1iLm93bmVyRG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaikpJiZ0KGIsaCkmJmguaWQ9PT1qKXJldHVybiBkLnB1c2goaCksZH1lbHNle2lmKGZbMl0pcmV0dXJuIEguYXBwbHkoZCxiLmdldEVsZW1lbnRzQnlUYWdOYW1lKGEpKSxkO2lmKChqPWZbM10pJiZjLmdldEVsZW1lbnRzQnlDbGFzc05hbWUpcmV0dXJuIEguYXBwbHkoZCxiLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoaikpLGR9aWYoYy5xc2EmJighcXx8IXEudGVzdChhKSkpe2lmKHM9cj11LHc9Yix4PTEhPT1rJiZhLDE9PT1rJiZcIm9iamVjdFwiIT09Yi5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpKXtvPWcoYSksKHI9Yi5nZXRBdHRyaWJ1dGUoXCJpZFwiKSk/cz1yLnJlcGxhY2UoYmIsXCJcXFxcJCZcIik6Yi5zZXRBdHRyaWJ1dGUoXCJpZFwiLHMpLHM9XCJbaWQ9J1wiK3MrXCInXSBcIixsPW8ubGVuZ3RoO3doaWxlKGwtLSlvW2xdPXMrcmIob1tsXSk7dz1hYi50ZXN0KGEpJiZwYihiLnBhcmVudE5vZGUpfHxiLHg9by5qb2luKFwiLFwiKX1pZih4KXRyeXtyZXR1cm4gSC5hcHBseShkLHcucXVlcnlTZWxlY3RvckFsbCh4KSksZH1jYXRjaCh5KXt9ZmluYWxseXtyfHxiLnJlbW92ZUF0dHJpYnV0ZShcImlkXCIpfX19cmV0dXJuIGkoYS5yZXBsYWNlKFIsXCIkMVwiKSxiLGQsZSl9ZnVuY3Rpb24gaGIoKXt2YXIgYT1bXTtmdW5jdGlvbiBiKGMsZSl7cmV0dXJuIGEucHVzaChjK1wiIFwiKT5kLmNhY2hlTGVuZ3RoJiZkZWxldGUgYlthLnNoaWZ0KCldLGJbYytcIiBcIl09ZX1yZXR1cm4gYn1mdW5jdGlvbiBpYihhKXtyZXR1cm4gYVt1XT0hMCxhfWZ1bmN0aW9uIGpiKGEpe3ZhciBiPW4uY3JlYXRlRWxlbWVudChcImRpdlwiKTt0cnl7cmV0dXJuISFhKGIpfWNhdGNoKGMpe3JldHVybiExfWZpbmFsbHl7Yi5wYXJlbnROb2RlJiZiLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYiksYj1udWxsfX1mdW5jdGlvbiBrYihhLGIpe3ZhciBjPWEuc3BsaXQoXCJ8XCIpLGU9YS5sZW5ndGg7d2hpbGUoZS0tKWQuYXR0ckhhbmRsZVtjW2VdXT1ifWZ1bmN0aW9uIGxiKGEsYil7dmFyIGM9YiYmYSxkPWMmJjE9PT1hLm5vZGVUeXBlJiYxPT09Yi5ub2RlVHlwZSYmKH5iLnNvdXJjZUluZGV4fHxDKS0ofmEuc291cmNlSW5kZXh8fEMpO2lmKGQpcmV0dXJuIGQ7aWYoYyl3aGlsZShjPWMubmV4dFNpYmxpbmcpaWYoYz09PWIpcmV0dXJuLTE7cmV0dXJuIGE/MTotMX1mdW5jdGlvbiBtYihhKXtyZXR1cm4gZnVuY3Rpb24oYil7dmFyIGM9Yi5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO3JldHVyblwiaW5wdXRcIj09PWMmJmIudHlwZT09PWF9fWZ1bmN0aW9uIG5iKGEpe3JldHVybiBmdW5jdGlvbihiKXt2YXIgYz1iLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuKFwiaW5wdXRcIj09PWN8fFwiYnV0dG9uXCI9PT1jKSYmYi50eXBlPT09YX19ZnVuY3Rpb24gb2IoYSl7cmV0dXJuIGliKGZ1bmN0aW9uKGIpe3JldHVybiBiPStiLGliKGZ1bmN0aW9uKGMsZCl7dmFyIGUsZj1hKFtdLGMubGVuZ3RoLGIpLGc9Zi5sZW5ndGg7d2hpbGUoZy0tKWNbZT1mW2ddXSYmKGNbZV09IShkW2VdPWNbZV0pKX0pfSl9ZnVuY3Rpb24gcGIoYSl7cmV0dXJuIGEmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBhLmdldEVsZW1lbnRzQnlUYWdOYW1lJiZhfWM9Z2Iuc3VwcG9ydD17fSxmPWdiLmlzWE1MPWZ1bmN0aW9uKGEpe3ZhciBiPWEmJihhLm93bmVyRG9jdW1lbnR8fGEpLmRvY3VtZW50RWxlbWVudDtyZXR1cm4gYj9cIkhUTUxcIiE9PWIubm9kZU5hbWU6ITF9LG09Z2Iuc2V0RG9jdW1lbnQ9ZnVuY3Rpb24oYSl7dmFyIGIsZSxnPWE/YS5vd25lckRvY3VtZW50fHxhOnY7cmV0dXJuIGchPT1uJiY5PT09Zy5ub2RlVHlwZSYmZy5kb2N1bWVudEVsZW1lbnQ/KG49ZyxvPWcuZG9jdW1lbnRFbGVtZW50LGU9Zy5kZWZhdWx0VmlldyxlJiZlIT09ZS50b3AmJihlLmFkZEV2ZW50TGlzdGVuZXI/ZS5hZGRFdmVudExpc3RlbmVyKFwidW5sb2FkXCIsZWIsITEpOmUuYXR0YWNoRXZlbnQmJmUuYXR0YWNoRXZlbnQoXCJvbnVubG9hZFwiLGViKSkscD0hZihnKSxjLmF0dHJpYnV0ZXM9amIoZnVuY3Rpb24oYSl7cmV0dXJuIGEuY2xhc3NOYW1lPVwiaVwiLCFhLmdldEF0dHJpYnV0ZShcImNsYXNzTmFtZVwiKX0pLGMuZ2V0RWxlbWVudHNCeVRhZ05hbWU9amIoZnVuY3Rpb24oYSl7cmV0dXJuIGEuYXBwZW5kQ2hpbGQoZy5jcmVhdGVDb21tZW50KFwiXCIpKSwhYS5nZXRFbGVtZW50c0J5VGFnTmFtZShcIipcIikubGVuZ3RofSksYy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lPSQudGVzdChnLmdldEVsZW1lbnRzQnlDbGFzc05hbWUpLGMuZ2V0QnlJZD1qYihmdW5jdGlvbihhKXtyZXR1cm4gby5hcHBlbmRDaGlsZChhKS5pZD11LCFnLmdldEVsZW1lbnRzQnlOYW1lfHwhZy5nZXRFbGVtZW50c0J5TmFtZSh1KS5sZW5ndGh9KSxjLmdldEJ5SWQ/KGQuZmluZC5JRD1mdW5jdGlvbihhLGIpe2lmKFwidW5kZWZpbmVkXCIhPXR5cGVvZiBiLmdldEVsZW1lbnRCeUlkJiZwKXt2YXIgYz1iLmdldEVsZW1lbnRCeUlkKGEpO3JldHVybiBjJiZjLnBhcmVudE5vZGU/W2NdOltdfX0sZC5maWx0ZXIuSUQ9ZnVuY3Rpb24oYSl7dmFyIGI9YS5yZXBsYWNlKGNiLGRiKTtyZXR1cm4gZnVuY3Rpb24oYSl7cmV0dXJuIGEuZ2V0QXR0cmlidXRlKFwiaWRcIik9PT1ifX0pOihkZWxldGUgZC5maW5kLklELGQuZmlsdGVyLklEPWZ1bmN0aW9uKGEpe3ZhciBiPWEucmVwbGFjZShjYixkYik7cmV0dXJuIGZ1bmN0aW9uKGEpe3ZhciBjPVwidW5kZWZpbmVkXCIhPXR5cGVvZiBhLmdldEF0dHJpYnV0ZU5vZGUmJmEuZ2V0QXR0cmlidXRlTm9kZShcImlkXCIpO3JldHVybiBjJiZjLnZhbHVlPT09Yn19KSxkLmZpbmQuVEFHPWMuZ2V0RWxlbWVudHNCeVRhZ05hbWU/ZnVuY3Rpb24oYSxiKXtyZXR1cm5cInVuZGVmaW5lZFwiIT10eXBlb2YgYi5nZXRFbGVtZW50c0J5VGFnTmFtZT9iLmdldEVsZW1lbnRzQnlUYWdOYW1lKGEpOmMucXNhP2IucXVlcnlTZWxlY3RvckFsbChhKTp2b2lkIDB9OmZ1bmN0aW9uKGEsYil7dmFyIGMsZD1bXSxlPTAsZj1iLmdldEVsZW1lbnRzQnlUYWdOYW1lKGEpO2lmKFwiKlwiPT09YSl7d2hpbGUoYz1mW2UrK10pMT09PWMubm9kZVR5cGUmJmQucHVzaChjKTtyZXR1cm4gZH1yZXR1cm4gZn0sZC5maW5kLkNMQVNTPWMuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSYmZnVuY3Rpb24oYSxiKXtyZXR1cm4gcD9iLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoYSk6dm9pZCAwfSxyPVtdLHE9W10sKGMucXNhPSQudGVzdChnLnF1ZXJ5U2VsZWN0b3JBbGwpKSYmKGpiKGZ1bmN0aW9uKGEpe28uYXBwZW5kQ2hpbGQoYSkuaW5uZXJIVE1MPVwiPGEgaWQ9J1wiK3UrXCInPjwvYT48c2VsZWN0IGlkPSdcIit1K1wiLVxcZl0nIG1zYWxsb3djYXB0dXJlPScnPjxvcHRpb24gc2VsZWN0ZWQ9Jyc+PC9vcHRpb24+PC9zZWxlY3Q+XCIsYS5xdWVyeVNlbGVjdG9yQWxsKFwiW21zYWxsb3djYXB0dXJlXj0nJ11cIikubGVuZ3RoJiZxLnB1c2goXCJbKl4kXT1cIitMK1wiKig/OicnfFxcXCJcXFwiKVwiKSxhLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbc2VsZWN0ZWRdXCIpLmxlbmd0aHx8cS5wdXNoKFwiXFxcXFtcIitMK1wiKig/OnZhbHVlfFwiK0srXCIpXCIpLGEucXVlcnlTZWxlY3RvckFsbChcIltpZH49XCIrdStcIi1dXCIpLmxlbmd0aHx8cS5wdXNoKFwifj1cIiksYS5xdWVyeVNlbGVjdG9yQWxsKFwiOmNoZWNrZWRcIikubGVuZ3RofHxxLnB1c2goXCI6Y2hlY2tlZFwiKSxhLnF1ZXJ5U2VsZWN0b3JBbGwoXCJhI1wiK3UrXCIrKlwiKS5sZW5ndGh8fHEucHVzaChcIi4jLitbK35dXCIpfSksamIoZnVuY3Rpb24oYSl7dmFyIGI9Zy5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7Yi5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsXCJoaWRkZW5cIiksYS5hcHBlbmRDaGlsZChiKS5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIsXCJEXCIpLGEucXVlcnlTZWxlY3RvckFsbChcIltuYW1lPWRdXCIpLmxlbmd0aCYmcS5wdXNoKFwibmFtZVwiK0wrXCIqWypeJHwhfl0/PVwiKSxhLnF1ZXJ5U2VsZWN0b3JBbGwoXCI6ZW5hYmxlZFwiKS5sZW5ndGh8fHEucHVzaChcIjplbmFibGVkXCIsXCI6ZGlzYWJsZWRcIiksYS5xdWVyeVNlbGVjdG9yQWxsKFwiKiw6eFwiKSxxLnB1c2goXCIsLio6XCIpfSkpLChjLm1hdGNoZXNTZWxlY3Rvcj0kLnRlc3Qocz1vLm1hdGNoZXN8fG8ud2Via2l0TWF0Y2hlc1NlbGVjdG9yfHxvLm1vek1hdGNoZXNTZWxlY3Rvcnx8by5vTWF0Y2hlc1NlbGVjdG9yfHxvLm1zTWF0Y2hlc1NlbGVjdG9yKSkmJmpiKGZ1bmN0aW9uKGEpe2MuZGlzY29ubmVjdGVkTWF0Y2g9cy5jYWxsKGEsXCJkaXZcIikscy5jYWxsKGEsXCJbcyE9JyddOnhcIiksci5wdXNoKFwiIT1cIixQKX0pLHE9cS5sZW5ndGgmJm5ldyBSZWdFeHAocS5qb2luKFwifFwiKSkscj1yLmxlbmd0aCYmbmV3IFJlZ0V4cChyLmpvaW4oXCJ8XCIpKSxiPSQudGVzdChvLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKSx0PWJ8fCQudGVzdChvLmNvbnRhaW5zKT9mdW5jdGlvbihhLGIpe3ZhciBjPTk9PT1hLm5vZGVUeXBlP2EuZG9jdW1lbnRFbGVtZW50OmEsZD1iJiZiLnBhcmVudE5vZGU7cmV0dXJuIGE9PT1kfHwhKCFkfHwxIT09ZC5ub2RlVHlwZXx8IShjLmNvbnRhaW5zP2MuY29udGFpbnMoZCk6YS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiYmMTYmYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihkKSkpfTpmdW5jdGlvbihhLGIpe2lmKGIpd2hpbGUoYj1iLnBhcmVudE5vZGUpaWYoYj09PWEpcmV0dXJuITA7cmV0dXJuITF9LEI9Yj9mdW5jdGlvbihhLGIpe2lmKGE9PT1iKXJldHVybiBsPSEwLDA7dmFyIGQ9IWEuY29tcGFyZURvY3VtZW50UG9zaXRpb24tIWIuY29tcGFyZURvY3VtZW50UG9zaXRpb247cmV0dXJuIGQ/ZDooZD0oYS5vd25lckRvY3VtZW50fHxhKT09PShiLm93bmVyRG9jdW1lbnR8fGIpP2EuY29tcGFyZURvY3VtZW50UG9zaXRpb24oYik6MSwxJmR8fCFjLnNvcnREZXRhY2hlZCYmYi5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihhKT09PWQ/YT09PWd8fGEub3duZXJEb2N1bWVudD09PXYmJnQodixhKT8tMTpiPT09Z3x8Yi5vd25lckRvY3VtZW50PT09diYmdCh2LGIpPzE6az9KKGssYSktSihrLGIpOjA6NCZkPy0xOjEpfTpmdW5jdGlvbihhLGIpe2lmKGE9PT1iKXJldHVybiBsPSEwLDA7dmFyIGMsZD0wLGU9YS5wYXJlbnROb2RlLGY9Yi5wYXJlbnROb2RlLGg9W2FdLGk9W2JdO2lmKCFlfHwhZilyZXR1cm4gYT09PWc/LTE6Yj09PWc/MTplPy0xOmY/MTprP0ooayxhKS1KKGssYik6MDtpZihlPT09ZilyZXR1cm4gbGIoYSxiKTtjPWE7d2hpbGUoYz1jLnBhcmVudE5vZGUpaC51bnNoaWZ0KGMpO2M9Yjt3aGlsZShjPWMucGFyZW50Tm9kZSlpLnVuc2hpZnQoYyk7d2hpbGUoaFtkXT09PWlbZF0pZCsrO3JldHVybiBkP2xiKGhbZF0saVtkXSk6aFtkXT09PXY/LTE6aVtkXT09PXY/MTowfSxnKTpufSxnYi5tYXRjaGVzPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGdiKGEsbnVsbCxudWxsLGIpfSxnYi5tYXRjaGVzU2VsZWN0b3I9ZnVuY3Rpb24oYSxiKXtpZigoYS5vd25lckRvY3VtZW50fHxhKSE9PW4mJm0oYSksYj1iLnJlcGxhY2UoVSxcIj0nJDEnXVwiKSwhKCFjLm1hdGNoZXNTZWxlY3Rvcnx8IXB8fHImJnIudGVzdChiKXx8cSYmcS50ZXN0KGIpKSl0cnl7dmFyIGQ9cy5jYWxsKGEsYik7aWYoZHx8Yy5kaXNjb25uZWN0ZWRNYXRjaHx8YS5kb2N1bWVudCYmMTEhPT1hLmRvY3VtZW50Lm5vZGVUeXBlKXJldHVybiBkfWNhdGNoKGUpe31yZXR1cm4gZ2IoYixuLG51bGwsW2FdKS5sZW5ndGg+MH0sZ2IuY29udGFpbnM9ZnVuY3Rpb24oYSxiKXtyZXR1cm4oYS5vd25lckRvY3VtZW50fHxhKSE9PW4mJm0oYSksdChhLGIpfSxnYi5hdHRyPWZ1bmN0aW9uKGEsYil7KGEub3duZXJEb2N1bWVudHx8YSkhPT1uJiZtKGEpO3ZhciBlPWQuYXR0ckhhbmRsZVtiLnRvTG93ZXJDYXNlKCldLGY9ZSYmRC5jYWxsKGQuYXR0ckhhbmRsZSxiLnRvTG93ZXJDYXNlKCkpP2UoYSxiLCFwKTp2b2lkIDA7cmV0dXJuIHZvaWQgMCE9PWY/ZjpjLmF0dHJpYnV0ZXN8fCFwP2EuZ2V0QXR0cmlidXRlKGIpOihmPWEuZ2V0QXR0cmlidXRlTm9kZShiKSkmJmYuc3BlY2lmaWVkP2YudmFsdWU6bnVsbH0sZ2IuZXJyb3I9ZnVuY3Rpb24oYSl7dGhyb3cgbmV3IEVycm9yKFwiU3ludGF4IGVycm9yLCB1bnJlY29nbml6ZWQgZXhwcmVzc2lvbjogXCIrYSl9LGdiLnVuaXF1ZVNvcnQ9ZnVuY3Rpb24oYSl7dmFyIGIsZD1bXSxlPTAsZj0wO2lmKGw9IWMuZGV0ZWN0RHVwbGljYXRlcyxrPSFjLnNvcnRTdGFibGUmJmEuc2xpY2UoMCksYS5zb3J0KEIpLGwpe3doaWxlKGI9YVtmKytdKWI9PT1hW2ZdJiYoZT1kLnB1c2goZikpO3doaWxlKGUtLSlhLnNwbGljZShkW2VdLDEpfXJldHVybiBrPW51bGwsYX0sZT1nYi5nZXRUZXh0PWZ1bmN0aW9uKGEpe3ZhciBiLGM9XCJcIixkPTAsZj1hLm5vZGVUeXBlO2lmKGYpe2lmKDE9PT1mfHw5PT09Znx8MTE9PT1mKXtpZihcInN0cmluZ1wiPT10eXBlb2YgYS50ZXh0Q29udGVudClyZXR1cm4gYS50ZXh0Q29udGVudDtmb3IoYT1hLmZpcnN0Q2hpbGQ7YTthPWEubmV4dFNpYmxpbmcpYys9ZShhKX1lbHNlIGlmKDM9PT1mfHw0PT09ZilyZXR1cm4gYS5ub2RlVmFsdWV9ZWxzZSB3aGlsZShiPWFbZCsrXSljKz1lKGIpO3JldHVybiBjfSxkPWdiLnNlbGVjdG9ycz17Y2FjaGVMZW5ndGg6NTAsY3JlYXRlUHNldWRvOmliLG1hdGNoOlgsYXR0ckhhbmRsZTp7fSxmaW5kOnt9LHJlbGF0aXZlOntcIj5cIjp7ZGlyOlwicGFyZW50Tm9kZVwiLGZpcnN0OiEwfSxcIiBcIjp7ZGlyOlwicGFyZW50Tm9kZVwifSxcIitcIjp7ZGlyOlwicHJldmlvdXNTaWJsaW5nXCIsZmlyc3Q6ITB9LFwiflwiOntkaXI6XCJwcmV2aW91c1NpYmxpbmdcIn19LHByZUZpbHRlcjp7QVRUUjpmdW5jdGlvbihhKXtyZXR1cm4gYVsxXT1hWzFdLnJlcGxhY2UoY2IsZGIpLGFbM109KGFbM118fGFbNF18fGFbNV18fFwiXCIpLnJlcGxhY2UoY2IsZGIpLFwifj1cIj09PWFbMl0mJihhWzNdPVwiIFwiK2FbM10rXCIgXCIpLGEuc2xpY2UoMCw0KX0sQ0hJTEQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGFbMV09YVsxXS50b0xvd2VyQ2FzZSgpLFwibnRoXCI9PT1hWzFdLnNsaWNlKDAsMyk/KGFbM118fGdiLmVycm9yKGFbMF0pLGFbNF09KyhhWzRdP2FbNV0rKGFbNl18fDEpOjIqKFwiZXZlblwiPT09YVszXXx8XCJvZGRcIj09PWFbM10pKSxhWzVdPSsoYVs3XSthWzhdfHxcIm9kZFwiPT09YVszXSkpOmFbM10mJmdiLmVycm9yKGFbMF0pLGF9LFBTRVVETzpmdW5jdGlvbihhKXt2YXIgYixjPSFhWzZdJiZhWzJdO3JldHVybiBYLkNISUxELnRlc3QoYVswXSk/bnVsbDooYVszXT9hWzJdPWFbNF18fGFbNV18fFwiXCI6YyYmVi50ZXN0KGMpJiYoYj1nKGMsITApKSYmKGI9Yy5pbmRleE9mKFwiKVwiLGMubGVuZ3RoLWIpLWMubGVuZ3RoKSYmKGFbMF09YVswXS5zbGljZSgwLGIpLGFbMl09Yy5zbGljZSgwLGIpKSxhLnNsaWNlKDAsMykpfX0sZmlsdGVyOntUQUc6ZnVuY3Rpb24oYSl7dmFyIGI9YS5yZXBsYWNlKGNiLGRiKS50b0xvd2VyQ2FzZSgpO3JldHVyblwiKlwiPT09YT9mdW5jdGlvbigpe3JldHVybiEwfTpmdW5jdGlvbihhKXtyZXR1cm4gYS5ub2RlTmFtZSYmYS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09Yn19LENMQVNTOmZ1bmN0aW9uKGEpe3ZhciBiPXlbYStcIiBcIl07cmV0dXJuIGJ8fChiPW5ldyBSZWdFeHAoXCIoXnxcIitMK1wiKVwiK2ErXCIoXCIrTCtcInwkKVwiKSkmJnkoYSxmdW5jdGlvbihhKXtyZXR1cm4gYi50ZXN0KFwic3RyaW5nXCI9PXR5cGVvZiBhLmNsYXNzTmFtZSYmYS5jbGFzc05hbWV8fFwidW5kZWZpbmVkXCIhPXR5cGVvZiBhLmdldEF0dHJpYnV0ZSYmYS5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKXx8XCJcIil9KX0sQVRUUjpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIGZ1bmN0aW9uKGQpe3ZhciBlPWdiLmF0dHIoZCxhKTtyZXR1cm4gbnVsbD09ZT9cIiE9XCI9PT1iOmI/KGUrPVwiXCIsXCI9XCI9PT1iP2U9PT1jOlwiIT1cIj09PWI/ZSE9PWM6XCJePVwiPT09Yj9jJiYwPT09ZS5pbmRleE9mKGMpOlwiKj1cIj09PWI/YyYmZS5pbmRleE9mKGMpPi0xOlwiJD1cIj09PWI/YyYmZS5zbGljZSgtYy5sZW5ndGgpPT09YzpcIn49XCI9PT1iPyhcIiBcIitlLnJlcGxhY2UoUSxcIiBcIikrXCIgXCIpLmluZGV4T2YoYyk+LTE6XCJ8PVwiPT09Yj9lPT09Y3x8ZS5zbGljZSgwLGMubGVuZ3RoKzEpPT09YytcIi1cIjohMSk6ITB9fSxDSElMRDpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPVwibnRoXCIhPT1hLnNsaWNlKDAsMyksZz1cImxhc3RcIiE9PWEuc2xpY2UoLTQpLGg9XCJvZi10eXBlXCI9PT1iO3JldHVybiAxPT09ZCYmMD09PWU/ZnVuY3Rpb24oYSl7cmV0dXJuISFhLnBhcmVudE5vZGV9OmZ1bmN0aW9uKGIsYyxpKXt2YXIgaixrLGwsbSxuLG8scD1mIT09Zz9cIm5leHRTaWJsaW5nXCI6XCJwcmV2aW91c1NpYmxpbmdcIixxPWIucGFyZW50Tm9kZSxyPWgmJmIubm9kZU5hbWUudG9Mb3dlckNhc2UoKSxzPSFpJiYhaDtpZihxKXtpZihmKXt3aGlsZShwKXtsPWI7d2hpbGUobD1sW3BdKWlmKGg/bC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09cjoxPT09bC5ub2RlVHlwZSlyZXR1cm4hMTtvPXA9XCJvbmx5XCI9PT1hJiYhbyYmXCJuZXh0U2libGluZ1wifXJldHVybiEwfWlmKG89W2c/cS5maXJzdENoaWxkOnEubGFzdENoaWxkXSxnJiZzKXtrPXFbdV18fChxW3VdPXt9KSxqPWtbYV18fFtdLG49alswXT09PXcmJmpbMV0sbT1qWzBdPT09dyYmalsyXSxsPW4mJnEuY2hpbGROb2Rlc1tuXTt3aGlsZShsPSsrbiYmbCYmbFtwXXx8KG09bj0wKXx8by5wb3AoKSlpZigxPT09bC5ub2RlVHlwZSYmKyttJiZsPT09Yil7a1thXT1bdyxuLG1dO2JyZWFrfX1lbHNlIGlmKHMmJihqPShiW3VdfHwoYlt1XT17fSkpW2FdKSYmalswXT09PXcpbT1qWzFdO2Vsc2Ugd2hpbGUobD0rK24mJmwmJmxbcF18fChtPW49MCl8fG8ucG9wKCkpaWYoKGg/bC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09cjoxPT09bC5ub2RlVHlwZSkmJisrbSYmKHMmJigobFt1XXx8KGxbdV09e30pKVthXT1bdyxtXSksbD09PWIpKWJyZWFrO3JldHVybiBtLT1lLG09PT1kfHxtJWQ9PT0wJiZtL2Q+PTB9fX0sUFNFVURPOmZ1bmN0aW9uKGEsYil7dmFyIGMsZT1kLnBzZXVkb3NbYV18fGQuc2V0RmlsdGVyc1thLnRvTG93ZXJDYXNlKCldfHxnYi5lcnJvcihcInVuc3VwcG9ydGVkIHBzZXVkbzogXCIrYSk7cmV0dXJuIGVbdV0/ZShiKTplLmxlbmd0aD4xPyhjPVthLGEsXCJcIixiXSxkLnNldEZpbHRlcnMuaGFzT3duUHJvcGVydHkoYS50b0xvd2VyQ2FzZSgpKT9pYihmdW5jdGlvbihhLGMpe3ZhciBkLGY9ZShhLGIpLGc9Zi5sZW5ndGg7d2hpbGUoZy0tKWQ9SihhLGZbZ10pLGFbZF09IShjW2RdPWZbZ10pfSk6ZnVuY3Rpb24oYSl7cmV0dXJuIGUoYSwwLGMpfSk6ZX19LHBzZXVkb3M6e25vdDppYihmdW5jdGlvbihhKXt2YXIgYj1bXSxjPVtdLGQ9aChhLnJlcGxhY2UoUixcIiQxXCIpKTtyZXR1cm4gZFt1XT9pYihmdW5jdGlvbihhLGIsYyxlKXt2YXIgZixnPWQoYSxudWxsLGUsW10pLGg9YS5sZW5ndGg7d2hpbGUoaC0tKShmPWdbaF0pJiYoYVtoXT0hKGJbaF09ZikpfSk6ZnVuY3Rpb24oYSxlLGYpe3JldHVybiBiWzBdPWEsZChiLG51bGwsZixjKSxiWzBdPW51bGwsIWMucG9wKCl9fSksaGFzOmliKGZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gZ2IoYSxiKS5sZW5ndGg+MH19KSxjb250YWluczppYihmdW5jdGlvbihhKXtyZXR1cm4gYT1hLnJlcGxhY2UoY2IsZGIpLGZ1bmN0aW9uKGIpe3JldHVybihiLnRleHRDb250ZW50fHxiLmlubmVyVGV4dHx8ZShiKSkuaW5kZXhPZihhKT4tMX19KSxsYW5nOmliKGZ1bmN0aW9uKGEpe3JldHVybiBXLnRlc3QoYXx8XCJcIil8fGdiLmVycm9yKFwidW5zdXBwb3J0ZWQgbGFuZzogXCIrYSksYT1hLnJlcGxhY2UoY2IsZGIpLnRvTG93ZXJDYXNlKCksZnVuY3Rpb24oYil7dmFyIGM7ZG8gaWYoYz1wP2IubGFuZzpiLmdldEF0dHJpYnV0ZShcInhtbDpsYW5nXCIpfHxiLmdldEF0dHJpYnV0ZShcImxhbmdcIikpcmV0dXJuIGM9Yy50b0xvd2VyQ2FzZSgpLGM9PT1hfHwwPT09Yy5pbmRleE9mKGErXCItXCIpO3doaWxlKChiPWIucGFyZW50Tm9kZSkmJjE9PT1iLm5vZGVUeXBlKTtyZXR1cm4hMX19KSx0YXJnZXQ6ZnVuY3Rpb24oYil7dmFyIGM9YS5sb2NhdGlvbiYmYS5sb2NhdGlvbi5oYXNoO3JldHVybiBjJiZjLnNsaWNlKDEpPT09Yi5pZH0scm9vdDpmdW5jdGlvbihhKXtyZXR1cm4gYT09PW99LGZvY3VzOmZ1bmN0aW9uKGEpe3JldHVybiBhPT09bi5hY3RpdmVFbGVtZW50JiYoIW4uaGFzRm9jdXN8fG4uaGFzRm9jdXMoKSkmJiEhKGEudHlwZXx8YS5ocmVmfHx+YS50YWJJbmRleCl9LGVuYWJsZWQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGEuZGlzYWJsZWQ9PT0hMX0sZGlzYWJsZWQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGEuZGlzYWJsZWQ9PT0hMH0sY2hlY2tlZDpmdW5jdGlvbihhKXt2YXIgYj1hLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuXCJpbnB1dFwiPT09YiYmISFhLmNoZWNrZWR8fFwib3B0aW9uXCI9PT1iJiYhIWEuc2VsZWN0ZWR9LHNlbGVjdGVkOmZ1bmN0aW9uKGEpe3JldHVybiBhLnBhcmVudE5vZGUmJmEucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4LGEuc2VsZWN0ZWQ9PT0hMH0sZW1wdHk6ZnVuY3Rpb24oYSl7Zm9yKGE9YS5maXJzdENoaWxkO2E7YT1hLm5leHRTaWJsaW5nKWlmKGEubm9kZVR5cGU8NilyZXR1cm4hMTtyZXR1cm4hMH0scGFyZW50OmZ1bmN0aW9uKGEpe3JldHVybiFkLnBzZXVkb3MuZW1wdHkoYSl9LGhlYWRlcjpmdW5jdGlvbihhKXtyZXR1cm4gWi50ZXN0KGEubm9kZU5hbWUpfSxpbnB1dDpmdW5jdGlvbihhKXtyZXR1cm4gWS50ZXN0KGEubm9kZU5hbWUpfSxidXR0b246ZnVuY3Rpb24oYSl7dmFyIGI9YS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO3JldHVyblwiaW5wdXRcIj09PWImJlwiYnV0dG9uXCI9PT1hLnR5cGV8fFwiYnV0dG9uXCI9PT1ifSx0ZXh0OmZ1bmN0aW9uKGEpe3ZhciBiO3JldHVyblwiaW5wdXRcIj09PWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKSYmXCJ0ZXh0XCI9PT1hLnR5cGUmJihudWxsPT0oYj1hLmdldEF0dHJpYnV0ZShcInR5cGVcIikpfHxcInRleHRcIj09PWIudG9Mb3dlckNhc2UoKSl9LGZpcnN0Om9iKGZ1bmN0aW9uKCl7cmV0dXJuWzBdfSksbGFzdDpvYihmdW5jdGlvbihhLGIpe3JldHVybltiLTFdfSksZXE6b2IoZnVuY3Rpb24oYSxiLGMpe3JldHVyblswPmM/YytiOmNdfSksZXZlbjpvYihmdW5jdGlvbihhLGIpe2Zvcih2YXIgYz0wO2I+YztjKz0yKWEucHVzaChjKTtyZXR1cm4gYX0pLG9kZDpvYihmdW5jdGlvbihhLGIpe2Zvcih2YXIgYz0xO2I+YztjKz0yKWEucHVzaChjKTtyZXR1cm4gYX0pLGx0Om9iKGZ1bmN0aW9uKGEsYixjKXtmb3IodmFyIGQ9MD5jP2MrYjpjOy0tZD49MDspYS5wdXNoKGQpO3JldHVybiBhfSksZ3Q6b2IoZnVuY3Rpb24oYSxiLGMpe2Zvcih2YXIgZD0wPmM/YytiOmM7KytkPGI7KWEucHVzaChkKTtyZXR1cm4gYX0pfX0sZC5wc2V1ZG9zLm50aD1kLnBzZXVkb3MuZXE7Zm9yKGIgaW57cmFkaW86ITAsY2hlY2tib3g6ITAsZmlsZTohMCxwYXNzd29yZDohMCxpbWFnZTohMH0pZC5wc2V1ZG9zW2JdPW1iKGIpO2ZvcihiIGlue3N1Ym1pdDohMCxyZXNldDohMH0pZC5wc2V1ZG9zW2JdPW5iKGIpO2Z1bmN0aW9uIHFiKCl7fXFiLnByb3RvdHlwZT1kLmZpbHRlcnM9ZC5wc2V1ZG9zLGQuc2V0RmlsdGVycz1uZXcgcWIsZz1nYi50b2tlbml6ZT1mdW5jdGlvbihhLGIpe3ZhciBjLGUsZixnLGgsaSxqLGs9elthK1wiIFwiXTtpZihrKXJldHVybiBiPzA6ay5zbGljZSgwKTtoPWEsaT1bXSxqPWQucHJlRmlsdGVyO3doaWxlKGgpeyghY3x8KGU9Uy5leGVjKGgpKSkmJihlJiYoaD1oLnNsaWNlKGVbMF0ubGVuZ3RoKXx8aCksaS5wdXNoKGY9W10pKSxjPSExLChlPVQuZXhlYyhoKSkmJihjPWUuc2hpZnQoKSxmLnB1c2goe3ZhbHVlOmMsdHlwZTplWzBdLnJlcGxhY2UoUixcIiBcIil9KSxoPWguc2xpY2UoYy5sZW5ndGgpKTtmb3IoZyBpbiBkLmZpbHRlcikhKGU9WFtnXS5leGVjKGgpKXx8altnXSYmIShlPWpbZ10oZSkpfHwoYz1lLnNoaWZ0KCksZi5wdXNoKHt2YWx1ZTpjLHR5cGU6ZyxtYXRjaGVzOmV9KSxoPWguc2xpY2UoYy5sZW5ndGgpKTtpZighYylicmVha31yZXR1cm4gYj9oLmxlbmd0aDpoP2diLmVycm9yKGEpOnooYSxpKS5zbGljZSgwKX07ZnVuY3Rpb24gcmIoYSl7Zm9yKHZhciBiPTAsYz1hLmxlbmd0aCxkPVwiXCI7Yz5iO2IrKylkKz1hW2JdLnZhbHVlO3JldHVybiBkfWZ1bmN0aW9uIHNiKGEsYixjKXt2YXIgZD1iLmRpcixlPWMmJlwicGFyZW50Tm9kZVwiPT09ZCxmPXgrKztyZXR1cm4gYi5maXJzdD9mdW5jdGlvbihiLGMsZil7d2hpbGUoYj1iW2RdKWlmKDE9PT1iLm5vZGVUeXBlfHxlKXJldHVybiBhKGIsYyxmKX06ZnVuY3Rpb24oYixjLGcpe3ZhciBoLGksaj1bdyxmXTtpZihnKXt3aGlsZShiPWJbZF0paWYoKDE9PT1iLm5vZGVUeXBlfHxlKSYmYShiLGMsZykpcmV0dXJuITB9ZWxzZSB3aGlsZShiPWJbZF0paWYoMT09PWIubm9kZVR5cGV8fGUpe2lmKGk9Ylt1XXx8KGJbdV09e30pLChoPWlbZF0pJiZoWzBdPT09dyYmaFsxXT09PWYpcmV0dXJuIGpbMl09aFsyXTtpZihpW2RdPWosalsyXT1hKGIsYyxnKSlyZXR1cm4hMH19fWZ1bmN0aW9uIHRiKGEpe3JldHVybiBhLmxlbmd0aD4xP2Z1bmN0aW9uKGIsYyxkKXt2YXIgZT1hLmxlbmd0aDt3aGlsZShlLS0paWYoIWFbZV0oYixjLGQpKXJldHVybiExO3JldHVybiEwfTphWzBdfWZ1bmN0aW9uIHViKGEsYixjKXtmb3IodmFyIGQ9MCxlPWIubGVuZ3RoO2U+ZDtkKyspZ2IoYSxiW2RdLGMpO3JldHVybiBjfWZ1bmN0aW9uIHZiKGEsYixjLGQsZSl7Zm9yKHZhciBmLGc9W10saD0wLGk9YS5sZW5ndGgsaj1udWxsIT1iO2k+aDtoKyspKGY9YVtoXSkmJighY3x8YyhmLGQsZSkpJiYoZy5wdXNoKGYpLGomJmIucHVzaChoKSk7cmV0dXJuIGd9ZnVuY3Rpb24gd2IoYSxiLGMsZCxlLGYpe3JldHVybiBkJiYhZFt1XSYmKGQ9d2IoZCkpLGUmJiFlW3VdJiYoZT13YihlLGYpKSxpYihmdW5jdGlvbihmLGcsaCxpKXt2YXIgaixrLGwsbT1bXSxuPVtdLG89Zy5sZW5ndGgscD1mfHx1YihifHxcIipcIixoLm5vZGVUeXBlP1toXTpoLFtdKSxxPSFhfHwhZiYmYj9wOnZiKHAsbSxhLGgsaSkscj1jP2V8fChmP2E6b3x8ZCk/W106ZzpxO2lmKGMmJmMocSxyLGgsaSksZCl7aj12YihyLG4pLGQoaixbXSxoLGkpLGs9ai5sZW5ndGg7d2hpbGUoay0tKShsPWpba10pJiYocltuW2tdXT0hKHFbbltrXV09bCkpfWlmKGYpe2lmKGV8fGEpe2lmKGUpe2o9W10saz1yLmxlbmd0aDt3aGlsZShrLS0pKGw9cltrXSkmJmoucHVzaChxW2tdPWwpO2UobnVsbCxyPVtdLGosaSl9az1yLmxlbmd0aDt3aGlsZShrLS0pKGw9cltrXSkmJihqPWU/SihmLGwpOm1ba10pPi0xJiYoZltqXT0hKGdbal09bCkpfX1lbHNlIHI9dmIocj09PWc/ci5zcGxpY2UobyxyLmxlbmd0aCk6ciksZT9lKG51bGwsZyxyLGkpOkguYXBwbHkoZyxyKX0pfWZ1bmN0aW9uIHhiKGEpe2Zvcih2YXIgYixjLGUsZj1hLmxlbmd0aCxnPWQucmVsYXRpdmVbYVswXS50eXBlXSxoPWd8fGQucmVsYXRpdmVbXCIgXCJdLGk9Zz8xOjAsaz1zYihmdW5jdGlvbihhKXtyZXR1cm4gYT09PWJ9LGgsITApLGw9c2IoZnVuY3Rpb24oYSl7cmV0dXJuIEooYixhKT4tMX0saCwhMCksbT1bZnVuY3Rpb24oYSxjLGQpe3ZhciBlPSFnJiYoZHx8YyE9PWopfHwoKGI9Yykubm9kZVR5cGU/ayhhLGMsZCk6bChhLGMsZCkpO3JldHVybiBiPW51bGwsZX1dO2Y+aTtpKyspaWYoYz1kLnJlbGF0aXZlW2FbaV0udHlwZV0pbT1bc2IodGIobSksYyldO2Vsc2V7aWYoYz1kLmZpbHRlclthW2ldLnR5cGVdLmFwcGx5KG51bGwsYVtpXS5tYXRjaGVzKSxjW3VdKXtmb3IoZT0rK2k7Zj5lO2UrKylpZihkLnJlbGF0aXZlW2FbZV0udHlwZV0pYnJlYWs7cmV0dXJuIHdiKGk+MSYmdGIobSksaT4xJiZyYihhLnNsaWNlKDAsaS0xKS5jb25jYXQoe3ZhbHVlOlwiIFwiPT09YVtpLTJdLnR5cGU/XCIqXCI6XCJcIn0pKS5yZXBsYWNlKFIsXCIkMVwiKSxjLGU+aSYmeGIoYS5zbGljZShpLGUpKSxmPmUmJnhiKGE9YS5zbGljZShlKSksZj5lJiZyYihhKSl9bS5wdXNoKGMpfXJldHVybiB0YihtKX1mdW5jdGlvbiB5YihhLGIpe3ZhciBjPWIubGVuZ3RoPjAsZT1hLmxlbmd0aD4wLGY9ZnVuY3Rpb24oZixnLGgsaSxrKXt2YXIgbCxtLG8scD0wLHE9XCIwXCIscj1mJiZbXSxzPVtdLHQ9aix1PWZ8fGUmJmQuZmluZC5UQUcoXCIqXCIsayksdj13Kz1udWxsPT10PzE6TWF0aC5yYW5kb20oKXx8LjEseD11Lmxlbmd0aDtmb3IoayYmKGo9ZyE9PW4mJmcpO3EhPT14JiZudWxsIT0obD11W3FdKTtxKyspe2lmKGUmJmwpe209MDt3aGlsZShvPWFbbSsrXSlpZihvKGwsZyxoKSl7aS5wdXNoKGwpO2JyZWFrfWsmJih3PXYpfWMmJigobD0hbyYmbCkmJnAtLSxmJiZyLnB1c2gobCkpfWlmKHArPXEsYyYmcSE9PXApe209MDt3aGlsZShvPWJbbSsrXSlvKHIscyxnLGgpO2lmKGYpe2lmKHA+MCl3aGlsZShxLS0pcltxXXx8c1txXXx8KHNbcV09Ri5jYWxsKGkpKTtzPXZiKHMpfUguYXBwbHkoaSxzKSxrJiYhZiYmcy5sZW5ndGg+MCYmcCtiLmxlbmd0aD4xJiZnYi51bmlxdWVTb3J0KGkpfXJldHVybiBrJiYodz12LGo9dCkscn07cmV0dXJuIGM/aWIoZik6Zn1yZXR1cm4gaD1nYi5jb21waWxlPWZ1bmN0aW9uKGEsYil7dmFyIGMsZD1bXSxlPVtdLGY9QVthK1wiIFwiXTtpZighZil7Ynx8KGI9ZyhhKSksYz1iLmxlbmd0aDt3aGlsZShjLS0pZj14YihiW2NdKSxmW3VdP2QucHVzaChmKTplLnB1c2goZik7Zj1BKGEseWIoZSxkKSksZi5zZWxlY3Rvcj1hfXJldHVybiBmfSxpPWdiLnNlbGVjdD1mdW5jdGlvbihhLGIsZSxmKXt2YXIgaSxqLGssbCxtLG49XCJmdW5jdGlvblwiPT10eXBlb2YgYSYmYSxvPSFmJiZnKGE9bi5zZWxlY3Rvcnx8YSk7aWYoZT1lfHxbXSwxPT09by5sZW5ndGgpe2lmKGo9b1swXT1vWzBdLnNsaWNlKDApLGoubGVuZ3RoPjImJlwiSURcIj09PShrPWpbMF0pLnR5cGUmJmMuZ2V0QnlJZCYmOT09PWIubm9kZVR5cGUmJnAmJmQucmVsYXRpdmVbalsxXS50eXBlXSl7aWYoYj0oZC5maW5kLklEKGsubWF0Y2hlc1swXS5yZXBsYWNlKGNiLGRiKSxiKXx8W10pWzBdLCFiKXJldHVybiBlO24mJihiPWIucGFyZW50Tm9kZSksYT1hLnNsaWNlKGouc2hpZnQoKS52YWx1ZS5sZW5ndGgpfWk9WC5uZWVkc0NvbnRleHQudGVzdChhKT8wOmoubGVuZ3RoO3doaWxlKGktLSl7aWYoaz1qW2ldLGQucmVsYXRpdmVbbD1rLnR5cGVdKWJyZWFrO2lmKChtPWQuZmluZFtsXSkmJihmPW0oay5tYXRjaGVzWzBdLnJlcGxhY2UoY2IsZGIpLGFiLnRlc3QoalswXS50eXBlKSYmcGIoYi5wYXJlbnROb2RlKXx8YikpKXtpZihqLnNwbGljZShpLDEpLGE9Zi5sZW5ndGgmJnJiKGopLCFhKXJldHVybiBILmFwcGx5KGUsZiksZTticmVha319fXJldHVybihufHxoKGEsbykpKGYsYiwhcCxlLGFiLnRlc3QoYSkmJnBiKGIucGFyZW50Tm9kZSl8fGIpLGV9LGMuc29ydFN0YWJsZT11LnNwbGl0KFwiXCIpLnNvcnQoQikuam9pbihcIlwiKT09PXUsYy5kZXRlY3REdXBsaWNhdGVzPSEhbCxtKCksYy5zb3J0RGV0YWNoZWQ9amIoZnVuY3Rpb24oYSl7cmV0dXJuIDEmYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihuLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIikpfSksamIoZnVuY3Rpb24oYSl7cmV0dXJuIGEuaW5uZXJIVE1MPVwiPGEgaHJlZj0nIyc+PC9hPlwiLFwiI1wiPT09YS5maXJzdENoaWxkLmdldEF0dHJpYnV0ZShcImhyZWZcIil9KXx8a2IoXCJ0eXBlfGhyZWZ8aGVpZ2h0fHdpZHRoXCIsZnVuY3Rpb24oYSxiLGMpe3JldHVybiBjP3ZvaWQgMDphLmdldEF0dHJpYnV0ZShiLFwidHlwZVwiPT09Yi50b0xvd2VyQ2FzZSgpPzE6Mil9KSxjLmF0dHJpYnV0ZXMmJmpiKGZ1bmN0aW9uKGEpe3JldHVybiBhLmlubmVySFRNTD1cIjxpbnB1dC8+XCIsYS5maXJzdENoaWxkLnNldEF0dHJpYnV0ZShcInZhbHVlXCIsXCJcIiksXCJcIj09PWEuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiKX0pfHxrYihcInZhbHVlXCIsZnVuY3Rpb24oYSxiLGMpe3JldHVybiBjfHxcImlucHV0XCIhPT1hLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk/dm9pZCAwOmEuZGVmYXVsdFZhbHVlfSksamIoZnVuY3Rpb24oYSl7cmV0dXJuIG51bGw9PWEuZ2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIil9KXx8a2IoSyxmdW5jdGlvbihhLGIsYyl7dmFyIGQ7cmV0dXJuIGM/dm9pZCAwOmFbYl09PT0hMD9iLnRvTG93ZXJDYXNlKCk6KGQ9YS5nZXRBdHRyaWJ1dGVOb2RlKGIpKSYmZC5zcGVjaWZpZWQ/ZC52YWx1ZTpudWxsfSksZ2J9KGEpO24uZmluZD10LG4uZXhwcj10LnNlbGVjdG9ycyxuLmV4cHJbXCI6XCJdPW4uZXhwci5wc2V1ZG9zLG4udW5pcXVlPXQudW5pcXVlU29ydCxuLnRleHQ9dC5nZXRUZXh0LG4uaXNYTUxEb2M9dC5pc1hNTCxuLmNvbnRhaW5zPXQuY29udGFpbnM7dmFyIHU9bi5leHByLm1hdGNoLm5lZWRzQ29udGV4dCx2PS9ePChcXHcrKVxccypcXC8/Pig/OjxcXC9cXDE+fCkkLyx3PS9eLlteOiNcXFtcXC4sXSokLztmdW5jdGlvbiB4KGEsYixjKXtpZihuLmlzRnVuY3Rpb24oYikpcmV0dXJuIG4uZ3JlcChhLGZ1bmN0aW9uKGEsZCl7cmV0dXJuISFiLmNhbGwoYSxkLGEpIT09Y30pO2lmKGIubm9kZVR5cGUpcmV0dXJuIG4uZ3JlcChhLGZ1bmN0aW9uKGEpe3JldHVybiBhPT09YiE9PWN9KTtpZihcInN0cmluZ1wiPT10eXBlb2YgYil7aWYody50ZXN0KGIpKXJldHVybiBuLmZpbHRlcihiLGEsYyk7Yj1uLmZpbHRlcihiLGEpfXJldHVybiBuLmdyZXAoYSxmdW5jdGlvbihhKXtyZXR1cm4gZy5jYWxsKGIsYSk+PTAhPT1jfSl9bi5maWx0ZXI9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWJbMF07cmV0dXJuIGMmJihhPVwiOm5vdChcIithK1wiKVwiKSwxPT09Yi5sZW5ndGgmJjE9PT1kLm5vZGVUeXBlP24uZmluZC5tYXRjaGVzU2VsZWN0b3IoZCxhKT9bZF06W106bi5maW5kLm1hdGNoZXMoYSxuLmdyZXAoYixmdW5jdGlvbihhKXtyZXR1cm4gMT09PWEubm9kZVR5cGV9KSl9LG4uZm4uZXh0ZW5kKHtmaW5kOmZ1bmN0aW9uKGEpe3ZhciBiLGM9dGhpcy5sZW5ndGgsZD1bXSxlPXRoaXM7aWYoXCJzdHJpbmdcIiE9dHlwZW9mIGEpcmV0dXJuIHRoaXMucHVzaFN0YWNrKG4oYSkuZmlsdGVyKGZ1bmN0aW9uKCl7Zm9yKGI9MDtjPmI7YisrKWlmKG4uY29udGFpbnMoZVtiXSx0aGlzKSlyZXR1cm4hMH0pKTtmb3IoYj0wO2M+YjtiKyspbi5maW5kKGEsZVtiXSxkKTtyZXR1cm4gZD10aGlzLnB1c2hTdGFjayhjPjE/bi51bmlxdWUoZCk6ZCksZC5zZWxlY3Rvcj10aGlzLnNlbGVjdG9yP3RoaXMuc2VsZWN0b3IrXCIgXCIrYTphLGR9LGZpbHRlcjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soeCh0aGlzLGF8fFtdLCExKSl9LG5vdDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soeCh0aGlzLGF8fFtdLCEwKSl9LGlzOmZ1bmN0aW9uKGEpe3JldHVybiEheCh0aGlzLFwic3RyaW5nXCI9PXR5cGVvZiBhJiZ1LnRlc3QoYSk/bihhKTphfHxbXSwhMSkubGVuZ3RofX0pO3ZhciB5LHo9L14oPzpcXHMqKDxbXFx3XFxXXSs+KVtePl0qfCMoW1xcdy1dKikpJC8sQT1uLmZuLmluaXQ9ZnVuY3Rpb24oYSxiKXt2YXIgYyxkO2lmKCFhKXJldHVybiB0aGlzO2lmKFwic3RyaW5nXCI9PXR5cGVvZiBhKXtpZihjPVwiPFwiPT09YVswXSYmXCI+XCI9PT1hW2EubGVuZ3RoLTFdJiZhLmxlbmd0aD49Mz9bbnVsbCxhLG51bGxdOnouZXhlYyhhKSwhY3x8IWNbMV0mJmIpcmV0dXJuIWJ8fGIuanF1ZXJ5PyhifHx5KS5maW5kKGEpOnRoaXMuY29uc3RydWN0b3IoYikuZmluZChhKTtpZihjWzFdKXtpZihiPWIgaW5zdGFuY2VvZiBuP2JbMF06YixuLm1lcmdlKHRoaXMsbi5wYXJzZUhUTUwoY1sxXSxiJiZiLm5vZGVUeXBlP2Iub3duZXJEb2N1bWVudHx8YjpsLCEwKSksdi50ZXN0KGNbMV0pJiZuLmlzUGxhaW5PYmplY3QoYikpZm9yKGMgaW4gYiluLmlzRnVuY3Rpb24odGhpc1tjXSk/dGhpc1tjXShiW2NdKTp0aGlzLmF0dHIoYyxiW2NdKTtyZXR1cm4gdGhpc31yZXR1cm4gZD1sLmdldEVsZW1lbnRCeUlkKGNbMl0pLGQmJmQucGFyZW50Tm9kZSYmKHRoaXMubGVuZ3RoPTEsdGhpc1swXT1kKSx0aGlzLmNvbnRleHQ9bCx0aGlzLnNlbGVjdG9yPWEsdGhpc31yZXR1cm4gYS5ub2RlVHlwZT8odGhpcy5jb250ZXh0PXRoaXNbMF09YSx0aGlzLmxlbmd0aD0xLHRoaXMpOm4uaXNGdW5jdGlvbihhKT9cInVuZGVmaW5lZFwiIT10eXBlb2YgeS5yZWFkeT95LnJlYWR5KGEpOmEobik6KHZvaWQgMCE9PWEuc2VsZWN0b3ImJih0aGlzLnNlbGVjdG9yPWEuc2VsZWN0b3IsdGhpcy5jb250ZXh0PWEuY29udGV4dCksbi5tYWtlQXJyYXkoYSx0aGlzKSl9O0EucHJvdG90eXBlPW4uZm4seT1uKGwpO3ZhciBCPS9eKD86cGFyZW50c3xwcmV2KD86VW50aWx8QWxsKSkvLEM9e2NoaWxkcmVuOiEwLGNvbnRlbnRzOiEwLG5leHQ6ITAscHJldjohMH07bi5leHRlbmQoe2RpcjpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9W10sZT12b2lkIDAhPT1jO3doaWxlKChhPWFbYl0pJiY5IT09YS5ub2RlVHlwZSlpZigxPT09YS5ub2RlVHlwZSl7aWYoZSYmbihhKS5pcyhjKSlicmVhaztkLnB1c2goYSl9cmV0dXJuIGR9LHNpYmxpbmc6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9W107YTthPWEubmV4dFNpYmxpbmcpMT09PWEubm9kZVR5cGUmJmEhPT1iJiZjLnB1c2goYSk7cmV0dXJuIGN9fSksbi5mbi5leHRlbmQoe2hhczpmdW5jdGlvbihhKXt2YXIgYj1uKGEsdGhpcyksYz1iLmxlbmd0aDtyZXR1cm4gdGhpcy5maWx0ZXIoZnVuY3Rpb24oKXtmb3IodmFyIGE9MDtjPmE7YSsrKWlmKG4uY29udGFpbnModGhpcyxiW2FdKSlyZXR1cm4hMH0pfSxjbG9zZXN0OmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjLGQ9MCxlPXRoaXMubGVuZ3RoLGY9W10sZz11LnRlc3QoYSl8fFwic3RyaW5nXCIhPXR5cGVvZiBhP24oYSxifHx0aGlzLmNvbnRleHQpOjA7ZT5kO2QrKylmb3IoYz10aGlzW2RdO2MmJmMhPT1iO2M9Yy5wYXJlbnROb2RlKWlmKGMubm9kZVR5cGU8MTEmJihnP2cuaW5kZXgoYyk+LTE6MT09PWMubm9kZVR5cGUmJm4uZmluZC5tYXRjaGVzU2VsZWN0b3IoYyxhKSkpe2YucHVzaChjKTticmVha31yZXR1cm4gdGhpcy5wdXNoU3RhY2soZi5sZW5ndGg+MT9uLnVuaXF1ZShmKTpmKX0saW5kZXg6ZnVuY3Rpb24oYSl7cmV0dXJuIGE/XCJzdHJpbmdcIj09dHlwZW9mIGE/Zy5jYWxsKG4oYSksdGhpc1swXSk6Zy5jYWxsKHRoaXMsYS5qcXVlcnk/YVswXTphKTp0aGlzWzBdJiZ0aGlzWzBdLnBhcmVudE5vZGU/dGhpcy5maXJzdCgpLnByZXZBbGwoKS5sZW5ndGg6LTF9LGFkZDpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLnB1c2hTdGFjayhuLnVuaXF1ZShuLm1lcmdlKHRoaXMuZ2V0KCksbihhLGIpKSkpfSxhZGRCYWNrOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmFkZChudWxsPT1hP3RoaXMucHJldk9iamVjdDp0aGlzLnByZXZPYmplY3QuZmlsdGVyKGEpKX19KTtmdW5jdGlvbiBEKGEsYil7d2hpbGUoKGE9YVtiXSkmJjEhPT1hLm5vZGVUeXBlKTtyZXR1cm4gYX1uLmVhY2goe3BhcmVudDpmdW5jdGlvbihhKXt2YXIgYj1hLnBhcmVudE5vZGU7cmV0dXJuIGImJjExIT09Yi5ub2RlVHlwZT9iOm51bGx9LHBhcmVudHM6ZnVuY3Rpb24oYSl7cmV0dXJuIG4uZGlyKGEsXCJwYXJlbnROb2RlXCIpfSxwYXJlbnRzVW50aWw6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuLmRpcihhLFwicGFyZW50Tm9kZVwiLGMpfSxuZXh0OmZ1bmN0aW9uKGEpe3JldHVybiBEKGEsXCJuZXh0U2libGluZ1wiKX0scHJldjpmdW5jdGlvbihhKXtyZXR1cm4gRChhLFwicHJldmlvdXNTaWJsaW5nXCIpfSxuZXh0QWxsOmZ1bmN0aW9uKGEpe3JldHVybiBuLmRpcihhLFwibmV4dFNpYmxpbmdcIil9LHByZXZBbGw6ZnVuY3Rpb24oYSl7cmV0dXJuIG4uZGlyKGEsXCJwcmV2aW91c1NpYmxpbmdcIil9LG5leHRVbnRpbDpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIG4uZGlyKGEsXCJuZXh0U2libGluZ1wiLGMpfSxwcmV2VW50aWw6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuLmRpcihhLFwicHJldmlvdXNTaWJsaW5nXCIsYyl9LHNpYmxpbmdzOmZ1bmN0aW9uKGEpe3JldHVybiBuLnNpYmxpbmcoKGEucGFyZW50Tm9kZXx8e30pLmZpcnN0Q2hpbGQsYSl9LGNoaWxkcmVuOmZ1bmN0aW9uKGEpe3JldHVybiBuLnNpYmxpbmcoYS5maXJzdENoaWxkKX0sY29udGVudHM6ZnVuY3Rpb24oYSl7cmV0dXJuIGEuY29udGVudERvY3VtZW50fHxuLm1lcmdlKFtdLGEuY2hpbGROb2Rlcyl9fSxmdW5jdGlvbihhLGIpe24uZm5bYV09ZnVuY3Rpb24oYyxkKXt2YXIgZT1uLm1hcCh0aGlzLGIsYyk7cmV0dXJuXCJVbnRpbFwiIT09YS5zbGljZSgtNSkmJihkPWMpLGQmJlwic3RyaW5nXCI9PXR5cGVvZiBkJiYoZT1uLmZpbHRlcihkLGUpKSx0aGlzLmxlbmd0aD4xJiYoQ1thXXx8bi51bmlxdWUoZSksQi50ZXN0KGEpJiZlLnJldmVyc2UoKSksdGhpcy5wdXNoU3RhY2soZSl9fSk7dmFyIEU9L1xcUysvZyxGPXt9O2Z1bmN0aW9uIEcoYSl7dmFyIGI9RlthXT17fTtyZXR1cm4gbi5lYWNoKGEubWF0Y2goRSl8fFtdLGZ1bmN0aW9uKGEsYyl7YltjXT0hMH0pLGJ9bi5DYWxsYmFja3M9ZnVuY3Rpb24oYSl7YT1cInN0cmluZ1wiPT10eXBlb2YgYT9GW2FdfHxHKGEpOm4uZXh0ZW5kKHt9LGEpO3ZhciBiLGMsZCxlLGYsZyxoPVtdLGk9IWEub25jZSYmW10saj1mdW5jdGlvbihsKXtmb3IoYj1hLm1lbW9yeSYmbCxjPSEwLGc9ZXx8MCxlPTAsZj1oLmxlbmd0aCxkPSEwO2gmJmY+ZztnKyspaWYoaFtnXS5hcHBseShsWzBdLGxbMV0pPT09ITEmJmEuc3RvcE9uRmFsc2Upe2I9ITE7YnJlYWt9ZD0hMSxoJiYoaT9pLmxlbmd0aCYmaihpLnNoaWZ0KCkpOmI/aD1bXTprLmRpc2FibGUoKSl9LGs9e2FkZDpmdW5jdGlvbigpe2lmKGgpe3ZhciBjPWgubGVuZ3RoOyFmdW5jdGlvbiBnKGIpe24uZWFjaChiLGZ1bmN0aW9uKGIsYyl7dmFyIGQ9bi50eXBlKGMpO1wiZnVuY3Rpb25cIj09PWQ/YS51bmlxdWUmJmsuaGFzKGMpfHxoLnB1c2goYyk6YyYmYy5sZW5ndGgmJlwic3RyaW5nXCIhPT1kJiZnKGMpfSl9KGFyZ3VtZW50cyksZD9mPWgubGVuZ3RoOmImJihlPWMsaihiKSl9cmV0dXJuIHRoaXN9LHJlbW92ZTpmdW5jdGlvbigpe3JldHVybiBoJiZuLmVhY2goYXJndW1lbnRzLGZ1bmN0aW9uKGEsYil7dmFyIGM7d2hpbGUoKGM9bi5pbkFycmF5KGIsaCxjKSk+LTEpaC5zcGxpY2UoYywxKSxkJiYoZj49YyYmZi0tLGc+PWMmJmctLSl9KSx0aGlzfSxoYXM6ZnVuY3Rpb24oYSl7cmV0dXJuIGE/bi5pbkFycmF5KGEsaCk+LTE6ISghaHx8IWgubGVuZ3RoKX0sZW1wdHk6ZnVuY3Rpb24oKXtyZXR1cm4gaD1bXSxmPTAsdGhpc30sZGlzYWJsZTpmdW5jdGlvbigpe3JldHVybiBoPWk9Yj12b2lkIDAsdGhpc30sZGlzYWJsZWQ6ZnVuY3Rpb24oKXtyZXR1cm4haH0sbG9jazpmdW5jdGlvbigpe3JldHVybiBpPXZvaWQgMCxifHxrLmRpc2FibGUoKSx0aGlzfSxsb2NrZWQ6ZnVuY3Rpb24oKXtyZXR1cm4haX0sZmlyZVdpdGg6ZnVuY3Rpb24oYSxiKXtyZXR1cm4haHx8YyYmIWl8fChiPWJ8fFtdLGI9W2EsYi5zbGljZT9iLnNsaWNlKCk6Yl0sZD9pLnB1c2goYik6aihiKSksdGhpc30sZmlyZTpmdW5jdGlvbigpe3JldHVybiBrLmZpcmVXaXRoKHRoaXMsYXJndW1lbnRzKSx0aGlzfSxmaXJlZDpmdW5jdGlvbigpe3JldHVybiEhY319O3JldHVybiBrfSxuLmV4dGVuZCh7RGVmZXJyZWQ6ZnVuY3Rpb24oYSl7dmFyIGI9W1tcInJlc29sdmVcIixcImRvbmVcIixuLkNhbGxiYWNrcyhcIm9uY2UgbWVtb3J5XCIpLFwicmVzb2x2ZWRcIl0sW1wicmVqZWN0XCIsXCJmYWlsXCIsbi5DYWxsYmFja3MoXCJvbmNlIG1lbW9yeVwiKSxcInJlamVjdGVkXCJdLFtcIm5vdGlmeVwiLFwicHJvZ3Jlc3NcIixuLkNhbGxiYWNrcyhcIm1lbW9yeVwiKV1dLGM9XCJwZW5kaW5nXCIsZD17c3RhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gY30sYWx3YXlzOmZ1bmN0aW9uKCl7cmV0dXJuIGUuZG9uZShhcmd1bWVudHMpLmZhaWwoYXJndW1lbnRzKSx0aGlzfSx0aGVuOmZ1bmN0aW9uKCl7dmFyIGE9YXJndW1lbnRzO3JldHVybiBuLkRlZmVycmVkKGZ1bmN0aW9uKGMpe24uZWFjaChiLGZ1bmN0aW9uKGIsZil7dmFyIGc9bi5pc0Z1bmN0aW9uKGFbYl0pJiZhW2JdO2VbZlsxXV0oZnVuY3Rpb24oKXt2YXIgYT1nJiZnLmFwcGx5KHRoaXMsYXJndW1lbnRzKTthJiZuLmlzRnVuY3Rpb24oYS5wcm9taXNlKT9hLnByb21pc2UoKS5kb25lKGMucmVzb2x2ZSkuZmFpbChjLnJlamVjdCkucHJvZ3Jlc3MoYy5ub3RpZnkpOmNbZlswXStcIldpdGhcIl0odGhpcz09PWQ/Yy5wcm9taXNlKCk6dGhpcyxnP1thXTphcmd1bWVudHMpfSl9KSxhPW51bGx9KS5wcm9taXNlKCl9LHByb21pc2U6ZnVuY3Rpb24oYSl7cmV0dXJuIG51bGwhPWE/bi5leHRlbmQoYSxkKTpkfX0sZT17fTtyZXR1cm4gZC5waXBlPWQudGhlbixuLmVhY2goYixmdW5jdGlvbihhLGYpe3ZhciBnPWZbMl0saD1mWzNdO2RbZlsxXV09Zy5hZGQsaCYmZy5hZGQoZnVuY3Rpb24oKXtjPWh9LGJbMV5hXVsyXS5kaXNhYmxlLGJbMl1bMl0ubG9jayksZVtmWzBdXT1mdW5jdGlvbigpe3JldHVybiBlW2ZbMF0rXCJXaXRoXCJdKHRoaXM9PT1lP2Q6dGhpcyxhcmd1bWVudHMpLHRoaXN9LGVbZlswXStcIldpdGhcIl09Zy5maXJlV2l0aH0pLGQucHJvbWlzZShlKSxhJiZhLmNhbGwoZSxlKSxlfSx3aGVuOmZ1bmN0aW9uKGEpe3ZhciBiPTAsYz1kLmNhbGwoYXJndW1lbnRzKSxlPWMubGVuZ3RoLGY9MSE9PWV8fGEmJm4uaXNGdW5jdGlvbihhLnByb21pc2UpP2U6MCxnPTE9PT1mP2E6bi5EZWZlcnJlZCgpLGg9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBmdW5jdGlvbihlKXtiW2FdPXRoaXMsY1thXT1hcmd1bWVudHMubGVuZ3RoPjE/ZC5jYWxsKGFyZ3VtZW50cyk6ZSxjPT09aT9nLm5vdGlmeVdpdGgoYixjKTotLWZ8fGcucmVzb2x2ZVdpdGgoYixjKX19LGksaixrO2lmKGU+MSlmb3IoaT1uZXcgQXJyYXkoZSksaj1uZXcgQXJyYXkoZSksaz1uZXcgQXJyYXkoZSk7ZT5iO2IrKyljW2JdJiZuLmlzRnVuY3Rpb24oY1tiXS5wcm9taXNlKT9jW2JdLnByb21pc2UoKS5kb25lKGgoYixrLGMpKS5mYWlsKGcucmVqZWN0KS5wcm9ncmVzcyhoKGIsaixpKSk6LS1mO3JldHVybiBmfHxnLnJlc29sdmVXaXRoKGssYyksZy5wcm9taXNlKCl9fSk7dmFyIEg7bi5mbi5yZWFkeT1mdW5jdGlvbihhKXtyZXR1cm4gbi5yZWFkeS5wcm9taXNlKCkuZG9uZShhKSx0aGlzfSxuLmV4dGVuZCh7aXNSZWFkeTohMSxyZWFkeVdhaXQ6MSxob2xkUmVhZHk6ZnVuY3Rpb24oYSl7YT9uLnJlYWR5V2FpdCsrOm4ucmVhZHkoITApfSxyZWFkeTpmdW5jdGlvbihhKXsoYT09PSEwPy0tbi5yZWFkeVdhaXQ6bi5pc1JlYWR5KXx8KG4uaXNSZWFkeT0hMCxhIT09ITAmJi0tbi5yZWFkeVdhaXQ+MHx8KEgucmVzb2x2ZVdpdGgobCxbbl0pLG4uZm4udHJpZ2dlckhhbmRsZXImJihuKGwpLnRyaWdnZXJIYW5kbGVyKFwicmVhZHlcIiksbihsKS5vZmYoXCJyZWFkeVwiKSkpKX19KTtmdW5jdGlvbiBJKCl7bC5yZW1vdmVFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLEksITEpLGEucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImxvYWRcIixJLCExKSxuLnJlYWR5KCl9bi5yZWFkeS5wcm9taXNlPWZ1bmN0aW9uKGIpe3JldHVybiBIfHwoSD1uLkRlZmVycmVkKCksXCJjb21wbGV0ZVwiPT09bC5yZWFkeVN0YXRlP3NldFRpbWVvdXQobi5yZWFkeSk6KGwuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIixJLCExKSxhLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsSSwhMSkpKSxILnByb21pc2UoYil9LG4ucmVhZHkucHJvbWlzZSgpO3ZhciBKPW4uYWNjZXNzPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGcpe3ZhciBoPTAsaT1hLmxlbmd0aCxqPW51bGw9PWM7aWYoXCJvYmplY3RcIj09PW4udHlwZShjKSl7ZT0hMDtmb3IoaCBpbiBjKW4uYWNjZXNzKGEsYixoLGNbaF0sITAsZixnKX1lbHNlIGlmKHZvaWQgMCE9PWQmJihlPSEwLG4uaXNGdW5jdGlvbihkKXx8KGc9ITApLGomJihnPyhiLmNhbGwoYSxkKSxiPW51bGwpOihqPWIsYj1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGouY2FsbChuKGEpLGMpfSkpLGIpKWZvcig7aT5oO2grKyliKGFbaF0sYyxnP2Q6ZC5jYWxsKGFbaF0saCxiKGFbaF0sYykpKTtyZXR1cm4gZT9hOmo/Yi5jYWxsKGEpOmk/YihhWzBdLGMpOmZ9O24uYWNjZXB0RGF0YT1mdW5jdGlvbihhKXtyZXR1cm4gMT09PWEubm9kZVR5cGV8fDk9PT1hLm5vZGVUeXBlfHwhK2Eubm9kZVR5cGV9O2Z1bmN0aW9uIEsoKXtPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcy5jYWNoZT17fSwwLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm57fX19KSx0aGlzLmV4cGFuZG89bi5leHBhbmRvK0sudWlkKyt9Sy51aWQ9MSxLLmFjY2VwdHM9bi5hY2NlcHREYXRhLEsucHJvdG90eXBlPXtrZXk6ZnVuY3Rpb24oYSl7aWYoIUsuYWNjZXB0cyhhKSlyZXR1cm4gMDt2YXIgYj17fSxjPWFbdGhpcy5leHBhbmRvXTtpZighYyl7Yz1LLnVpZCsrO3RyeXtiW3RoaXMuZXhwYW5kb109e3ZhbHVlOmN9LE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGEsYil9Y2F0Y2goZCl7Ylt0aGlzLmV4cGFuZG9dPWMsbi5leHRlbmQoYSxiKX19cmV0dXJuIHRoaXMuY2FjaGVbY118fCh0aGlzLmNhY2hlW2NdPXt9KSxjfSxzZXQ6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGU9dGhpcy5rZXkoYSksZj10aGlzLmNhY2hlW2VdO2lmKFwic3RyaW5nXCI9PXR5cGVvZiBiKWZbYl09YztlbHNlIGlmKG4uaXNFbXB0eU9iamVjdChmKSluLmV4dGVuZCh0aGlzLmNhY2hlW2VdLGIpO2Vsc2UgZm9yKGQgaW4gYilmW2RdPWJbZF07cmV0dXJuIGZ9LGdldDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuY2FjaGVbdGhpcy5rZXkoYSldO3JldHVybiB2b2lkIDA9PT1iP2M6Y1tiXX0sYWNjZXNzOmZ1bmN0aW9uKGEsYixjKXt2YXIgZDtyZXR1cm4gdm9pZCAwPT09Ynx8YiYmXCJzdHJpbmdcIj09dHlwZW9mIGImJnZvaWQgMD09PWM/KGQ9dGhpcy5nZXQoYSxiKSx2b2lkIDAhPT1kP2Q6dGhpcy5nZXQoYSxuLmNhbWVsQ2FzZShiKSkpOih0aGlzLnNldChhLGIsYyksdm9pZCAwIT09Yz9jOmIpfSxyZW1vdmU6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkLGUsZj10aGlzLmtleShhKSxnPXRoaXMuY2FjaGVbZl07aWYodm9pZCAwPT09Yil0aGlzLmNhY2hlW2ZdPXt9O2Vsc2V7bi5pc0FycmF5KGIpP2Q9Yi5jb25jYXQoYi5tYXAobi5jYW1lbENhc2UpKTooZT1uLmNhbWVsQ2FzZShiKSxiIGluIGc/ZD1bYixlXTooZD1lLGQ9ZCBpbiBnP1tkXTpkLm1hdGNoKEUpfHxbXSkpLGM9ZC5sZW5ndGg7d2hpbGUoYy0tKWRlbGV0ZSBnW2RbY11dfX0saGFzRGF0YTpmdW5jdGlvbihhKXtyZXR1cm4hbi5pc0VtcHR5T2JqZWN0KHRoaXMuY2FjaGVbYVt0aGlzLmV4cGFuZG9dXXx8e30pfSxkaXNjYXJkOmZ1bmN0aW9uKGEpe2FbdGhpcy5leHBhbmRvXSYmZGVsZXRlIHRoaXMuY2FjaGVbYVt0aGlzLmV4cGFuZG9dXX19O3ZhciBMPW5ldyBLLE09bmV3IEssTj0vXig/Olxce1tcXHdcXFddKlxcfXxcXFtbXFx3XFxXXSpcXF0pJC8sTz0vKFtBLVpdKS9nO2Z1bmN0aW9uIFAoYSxiLGMpe3ZhciBkO2lmKHZvaWQgMD09PWMmJjE9PT1hLm5vZGVUeXBlKWlmKGQ9XCJkYXRhLVwiK2IucmVwbGFjZShPLFwiLSQxXCIpLnRvTG93ZXJDYXNlKCksYz1hLmdldEF0dHJpYnV0ZShkKSxcInN0cmluZ1wiPT10eXBlb2YgYyl7dHJ5e2M9XCJ0cnVlXCI9PT1jPyEwOlwiZmFsc2VcIj09PWM/ITE6XCJudWxsXCI9PT1jP251bGw6K2MrXCJcIj09PWM/K2M6Ti50ZXN0KGMpP24ucGFyc2VKU09OKGMpOmN9Y2F0Y2goZSl7fU0uc2V0KGEsYixjKX1lbHNlIGM9dm9pZCAwO3JldHVybiBjfW4uZXh0ZW5kKHtoYXNEYXRhOmZ1bmN0aW9uKGEpe3JldHVybiBNLmhhc0RhdGEoYSl8fEwuaGFzRGF0YShhKX0sZGF0YTpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIE0uYWNjZXNzKGEsYixjKVxyXG59LHJlbW92ZURhdGE6ZnVuY3Rpb24oYSxiKXtNLnJlbW92ZShhLGIpfSxfZGF0YTpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIEwuYWNjZXNzKGEsYixjKX0sX3JlbW92ZURhdGE6ZnVuY3Rpb24oYSxiKXtMLnJlbW92ZShhLGIpfX0pLG4uZm4uZXh0ZW5kKHtkYXRhOmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlLGY9dGhpc1swXSxnPWYmJmYuYXR0cmlidXRlcztpZih2b2lkIDA9PT1hKXtpZih0aGlzLmxlbmd0aCYmKGU9TS5nZXQoZiksMT09PWYubm9kZVR5cGUmJiFMLmdldChmLFwiaGFzRGF0YUF0dHJzXCIpKSl7Yz1nLmxlbmd0aDt3aGlsZShjLS0pZ1tjXSYmKGQ9Z1tjXS5uYW1lLDA9PT1kLmluZGV4T2YoXCJkYXRhLVwiKSYmKGQ9bi5jYW1lbENhc2UoZC5zbGljZSg1KSksUChmLGQsZVtkXSkpKTtMLnNldChmLFwiaGFzRGF0YUF0dHJzXCIsITApfXJldHVybiBlfXJldHVyblwib2JqZWN0XCI9PXR5cGVvZiBhP3RoaXMuZWFjaChmdW5jdGlvbigpe00uc2V0KHRoaXMsYSl9KTpKKHRoaXMsZnVuY3Rpb24oYil7dmFyIGMsZD1uLmNhbWVsQ2FzZShhKTtpZihmJiZ2b2lkIDA9PT1iKXtpZihjPU0uZ2V0KGYsYSksdm9pZCAwIT09YylyZXR1cm4gYztpZihjPU0uZ2V0KGYsZCksdm9pZCAwIT09YylyZXR1cm4gYztpZihjPVAoZixkLHZvaWQgMCksdm9pZCAwIT09YylyZXR1cm4gY31lbHNlIHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBjPU0uZ2V0KHRoaXMsZCk7TS5zZXQodGhpcyxkLGIpLC0xIT09YS5pbmRleE9mKFwiLVwiKSYmdm9pZCAwIT09YyYmTS5zZXQodGhpcyxhLGIpfSl9LG51bGwsYixhcmd1bWVudHMubGVuZ3RoPjEsbnVsbCwhMCl9LHJlbW92ZURhdGE6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe00ucmVtb3ZlKHRoaXMsYSl9KX19KSxuLmV4dGVuZCh7cXVldWU6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkO3JldHVybiBhPyhiPShifHxcImZ4XCIpK1wicXVldWVcIixkPUwuZ2V0KGEsYiksYyYmKCFkfHxuLmlzQXJyYXkoYyk/ZD1MLmFjY2VzcyhhLGIsbi5tYWtlQXJyYXkoYykpOmQucHVzaChjKSksZHx8W10pOnZvaWQgMH0sZGVxdWV1ZTpmdW5jdGlvbihhLGIpe2I9Ynx8XCJmeFwiO3ZhciBjPW4ucXVldWUoYSxiKSxkPWMubGVuZ3RoLGU9Yy5zaGlmdCgpLGY9bi5fcXVldWVIb29rcyhhLGIpLGc9ZnVuY3Rpb24oKXtuLmRlcXVldWUoYSxiKX07XCJpbnByb2dyZXNzXCI9PT1lJiYoZT1jLnNoaWZ0KCksZC0tKSxlJiYoXCJmeFwiPT09YiYmYy51bnNoaWZ0KFwiaW5wcm9ncmVzc1wiKSxkZWxldGUgZi5zdG9wLGUuY2FsbChhLGcsZikpLCFkJiZmJiZmLmVtcHR5LmZpcmUoKX0sX3F1ZXVlSG9va3M6ZnVuY3Rpb24oYSxiKXt2YXIgYz1iK1wicXVldWVIb29rc1wiO3JldHVybiBMLmdldChhLGMpfHxMLmFjY2VzcyhhLGMse2VtcHR5Om4uQ2FsbGJhY2tzKFwib25jZSBtZW1vcnlcIikuYWRkKGZ1bmN0aW9uKCl7TC5yZW1vdmUoYSxbYitcInF1ZXVlXCIsY10pfSl9KX19KSxuLmZuLmV4dGVuZCh7cXVldWU6ZnVuY3Rpb24oYSxiKXt2YXIgYz0yO3JldHVyblwic3RyaW5nXCIhPXR5cGVvZiBhJiYoYj1hLGE9XCJmeFwiLGMtLSksYXJndW1lbnRzLmxlbmd0aDxjP24ucXVldWUodGhpc1swXSxhKTp2b2lkIDA9PT1iP3RoaXM6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGM9bi5xdWV1ZSh0aGlzLGEsYik7bi5fcXVldWVIb29rcyh0aGlzLGEpLFwiZnhcIj09PWEmJlwiaW5wcm9ncmVzc1wiIT09Y1swXSYmbi5kZXF1ZXVlKHRoaXMsYSl9KX0sZGVxdWV1ZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7bi5kZXF1ZXVlKHRoaXMsYSl9KX0sY2xlYXJRdWV1ZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5xdWV1ZShhfHxcImZ4XCIsW10pfSxwcm9taXNlOmZ1bmN0aW9uKGEsYil7dmFyIGMsZD0xLGU9bi5EZWZlcnJlZCgpLGY9dGhpcyxnPXRoaXMubGVuZ3RoLGg9ZnVuY3Rpb24oKXstLWR8fGUucmVzb2x2ZVdpdGgoZixbZl0pfTtcInN0cmluZ1wiIT10eXBlb2YgYSYmKGI9YSxhPXZvaWQgMCksYT1hfHxcImZ4XCI7d2hpbGUoZy0tKWM9TC5nZXQoZltnXSxhK1wicXVldWVIb29rc1wiKSxjJiZjLmVtcHR5JiYoZCsrLGMuZW1wdHkuYWRkKGgpKTtyZXR1cm4gaCgpLGUucHJvbWlzZShiKX19KTt2YXIgUT0vWystXT8oPzpcXGQqXFwufClcXGQrKD86W2VFXVsrLV0/XFxkK3wpLy5zb3VyY2UsUj1bXCJUb3BcIixcIlJpZ2h0XCIsXCJCb3R0b21cIixcIkxlZnRcIl0sUz1mdW5jdGlvbihhLGIpe3JldHVybiBhPWJ8fGEsXCJub25lXCI9PT1uLmNzcyhhLFwiZGlzcGxheVwiKXx8IW4uY29udGFpbnMoYS5vd25lckRvY3VtZW50LGEpfSxUPS9eKD86Y2hlY2tib3h8cmFkaW8pJC9pOyFmdW5jdGlvbigpe3ZhciBhPWwuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLGI9YS5hcHBlbmRDaGlsZChsLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIikpLGM9bC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7Yy5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsXCJyYWRpb1wiKSxjLnNldEF0dHJpYnV0ZShcImNoZWNrZWRcIixcImNoZWNrZWRcIiksYy5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIsXCJ0XCIpLGIuYXBwZW5kQ2hpbGQoYyksay5jaGVja0Nsb25lPWIuY2xvbmVOb2RlKCEwKS5jbG9uZU5vZGUoITApLmxhc3RDaGlsZC5jaGVja2VkLGIuaW5uZXJIVE1MPVwiPHRleHRhcmVhPng8L3RleHRhcmVhPlwiLGsubm9DbG9uZUNoZWNrZWQ9ISFiLmNsb25lTm9kZSghMCkubGFzdENoaWxkLmRlZmF1bHRWYWx1ZX0oKTt2YXIgVT1cInVuZGVmaW5lZFwiO2suZm9jdXNpbkJ1YmJsZXM9XCJvbmZvY3VzaW5cImluIGE7dmFyIFY9L15rZXkvLFc9L14oPzptb3VzZXxwb2ludGVyfGNvbnRleHRtZW51KXxjbGljay8sWD0vXig/OmZvY3VzaW5mb2N1c3xmb2N1c291dGJsdXIpJC8sWT0vXihbXi5dKikoPzpcXC4oLispfCkkLztmdW5jdGlvbiBaKCl7cmV0dXJuITB9ZnVuY3Rpb24gJCgpe3JldHVybiExfWZ1bmN0aW9uIF8oKXt0cnl7cmV0dXJuIGwuYWN0aXZlRWxlbWVudH1jYXRjaChhKXt9fW4uZXZlbnQ9e2dsb2JhbDp7fSxhZGQ6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZixnLGgsaSxqLGssbCxtLG8scCxxLHI9TC5nZXQoYSk7aWYocil7Yy5oYW5kbGVyJiYoZj1jLGM9Zi5oYW5kbGVyLGU9Zi5zZWxlY3RvciksYy5ndWlkfHwoYy5ndWlkPW4uZ3VpZCsrKSwoaT1yLmV2ZW50cyl8fChpPXIuZXZlbnRzPXt9KSwoZz1yLmhhbmRsZSl8fChnPXIuaGFuZGxlPWZ1bmN0aW9uKGIpe3JldHVybiB0eXBlb2YgbiE9PVUmJm4uZXZlbnQudHJpZ2dlcmVkIT09Yi50eXBlP24uZXZlbnQuZGlzcGF0Y2guYXBwbHkoYSxhcmd1bWVudHMpOnZvaWQgMH0pLGI9KGJ8fFwiXCIpLm1hdGNoKEUpfHxbXCJcIl0saj1iLmxlbmd0aDt3aGlsZShqLS0paD1ZLmV4ZWMoYltqXSl8fFtdLG89cT1oWzFdLHA9KGhbMl18fFwiXCIpLnNwbGl0KFwiLlwiKS5zb3J0KCksbyYmKGw9bi5ldmVudC5zcGVjaWFsW29dfHx7fSxvPShlP2wuZGVsZWdhdGVUeXBlOmwuYmluZFR5cGUpfHxvLGw9bi5ldmVudC5zcGVjaWFsW29dfHx7fSxrPW4uZXh0ZW5kKHt0eXBlOm8sb3JpZ1R5cGU6cSxkYXRhOmQsaGFuZGxlcjpjLGd1aWQ6Yy5ndWlkLHNlbGVjdG9yOmUsbmVlZHNDb250ZXh0OmUmJm4uZXhwci5tYXRjaC5uZWVkc0NvbnRleHQudGVzdChlKSxuYW1lc3BhY2U6cC5qb2luKFwiLlwiKX0sZiksKG09aVtvXSl8fChtPWlbb109W10sbS5kZWxlZ2F0ZUNvdW50PTAsbC5zZXR1cCYmbC5zZXR1cC5jYWxsKGEsZCxwLGcpIT09ITF8fGEuYWRkRXZlbnRMaXN0ZW5lciYmYS5hZGRFdmVudExpc3RlbmVyKG8sZywhMSkpLGwuYWRkJiYobC5hZGQuY2FsbChhLGspLGsuaGFuZGxlci5ndWlkfHwoay5oYW5kbGVyLmd1aWQ9Yy5ndWlkKSksZT9tLnNwbGljZShtLmRlbGVnYXRlQ291bnQrKywwLGspOm0ucHVzaChrKSxuLmV2ZW50Lmdsb2JhbFtvXT0hMCl9fSxyZW1vdmU6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZixnLGgsaSxqLGssbCxtLG8scCxxLHI9TC5oYXNEYXRhKGEpJiZMLmdldChhKTtpZihyJiYoaT1yLmV2ZW50cykpe2I9KGJ8fFwiXCIpLm1hdGNoKEUpfHxbXCJcIl0saj1iLmxlbmd0aDt3aGlsZShqLS0paWYoaD1ZLmV4ZWMoYltqXSl8fFtdLG89cT1oWzFdLHA9KGhbMl18fFwiXCIpLnNwbGl0KFwiLlwiKS5zb3J0KCksbyl7bD1uLmV2ZW50LnNwZWNpYWxbb118fHt9LG89KGQ/bC5kZWxlZ2F0ZVR5cGU6bC5iaW5kVHlwZSl8fG8sbT1pW29dfHxbXSxoPWhbMl0mJm5ldyBSZWdFeHAoXCIoXnxcXFxcLilcIitwLmpvaW4oXCJcXFxcLig/Oi4qXFxcXC58KVwiKStcIihcXFxcLnwkKVwiKSxnPWY9bS5sZW5ndGg7d2hpbGUoZi0tKWs9bVtmXSwhZSYmcSE9PWsub3JpZ1R5cGV8fGMmJmMuZ3VpZCE9PWsuZ3VpZHx8aCYmIWgudGVzdChrLm5hbWVzcGFjZSl8fGQmJmQhPT1rLnNlbGVjdG9yJiYoXCIqKlwiIT09ZHx8IWsuc2VsZWN0b3IpfHwobS5zcGxpY2UoZiwxKSxrLnNlbGVjdG9yJiZtLmRlbGVnYXRlQ291bnQtLSxsLnJlbW92ZSYmbC5yZW1vdmUuY2FsbChhLGspKTtnJiYhbS5sZW5ndGgmJihsLnRlYXJkb3duJiZsLnRlYXJkb3duLmNhbGwoYSxwLHIuaGFuZGxlKSE9PSExfHxuLnJlbW92ZUV2ZW50KGEsbyxyLmhhbmRsZSksZGVsZXRlIGlbb10pfWVsc2UgZm9yKG8gaW4gaSluLmV2ZW50LnJlbW92ZShhLG8rYltqXSxjLGQsITApO24uaXNFbXB0eU9iamVjdChpKSYmKGRlbGV0ZSByLmhhbmRsZSxMLnJlbW92ZShhLFwiZXZlbnRzXCIpKX19LHRyaWdnZXI6ZnVuY3Rpb24oYixjLGQsZSl7dmFyIGYsZyxoLGksayxtLG8scD1bZHx8bF0scT1qLmNhbGwoYixcInR5cGVcIik/Yi50eXBlOmIscj1qLmNhbGwoYixcIm5hbWVzcGFjZVwiKT9iLm5hbWVzcGFjZS5zcGxpdChcIi5cIik6W107aWYoZz1oPWQ9ZHx8bCwzIT09ZC5ub2RlVHlwZSYmOCE9PWQubm9kZVR5cGUmJiFYLnRlc3QocStuLmV2ZW50LnRyaWdnZXJlZCkmJihxLmluZGV4T2YoXCIuXCIpPj0wJiYocj1xLnNwbGl0KFwiLlwiKSxxPXIuc2hpZnQoKSxyLnNvcnQoKSksaz1xLmluZGV4T2YoXCI6XCIpPDAmJlwib25cIitxLGI9YltuLmV4cGFuZG9dP2I6bmV3IG4uRXZlbnQocSxcIm9iamVjdFwiPT10eXBlb2YgYiYmYiksYi5pc1RyaWdnZXI9ZT8yOjMsYi5uYW1lc3BhY2U9ci5qb2luKFwiLlwiKSxiLm5hbWVzcGFjZV9yZT1iLm5hbWVzcGFjZT9uZXcgUmVnRXhwKFwiKF58XFxcXC4pXCIrci5qb2luKFwiXFxcXC4oPzouKlxcXFwufClcIikrXCIoXFxcXC58JClcIik6bnVsbCxiLnJlc3VsdD12b2lkIDAsYi50YXJnZXR8fChiLnRhcmdldD1kKSxjPW51bGw9PWM/W2JdOm4ubWFrZUFycmF5KGMsW2JdKSxvPW4uZXZlbnQuc3BlY2lhbFtxXXx8e30sZXx8IW8udHJpZ2dlcnx8by50cmlnZ2VyLmFwcGx5KGQsYykhPT0hMSkpe2lmKCFlJiYhby5ub0J1YmJsZSYmIW4uaXNXaW5kb3coZCkpe2ZvcihpPW8uZGVsZWdhdGVUeXBlfHxxLFgudGVzdChpK3EpfHwoZz1nLnBhcmVudE5vZGUpO2c7Zz1nLnBhcmVudE5vZGUpcC5wdXNoKGcpLGg9ZztoPT09KGQub3duZXJEb2N1bWVudHx8bCkmJnAucHVzaChoLmRlZmF1bHRWaWV3fHxoLnBhcmVudFdpbmRvd3x8YSl9Zj0wO3doaWxlKChnPXBbZisrXSkmJiFiLmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpYi50eXBlPWY+MT9pOm8uYmluZFR5cGV8fHEsbT0oTC5nZXQoZyxcImV2ZW50c1wiKXx8e30pW2IudHlwZV0mJkwuZ2V0KGcsXCJoYW5kbGVcIiksbSYmbS5hcHBseShnLGMpLG09ayYmZ1trXSxtJiZtLmFwcGx5JiZuLmFjY2VwdERhdGEoZykmJihiLnJlc3VsdD1tLmFwcGx5KGcsYyksYi5yZXN1bHQ9PT0hMSYmYi5wcmV2ZW50RGVmYXVsdCgpKTtyZXR1cm4gYi50eXBlPXEsZXx8Yi5pc0RlZmF1bHRQcmV2ZW50ZWQoKXx8by5fZGVmYXVsdCYmby5fZGVmYXVsdC5hcHBseShwLnBvcCgpLGMpIT09ITF8fCFuLmFjY2VwdERhdGEoZCl8fGsmJm4uaXNGdW5jdGlvbihkW3FdKSYmIW4uaXNXaW5kb3coZCkmJihoPWRba10saCYmKGRba109bnVsbCksbi5ldmVudC50cmlnZ2VyZWQ9cSxkW3FdKCksbi5ldmVudC50cmlnZ2VyZWQ9dm9pZCAwLGgmJihkW2tdPWgpKSxiLnJlc3VsdH19LGRpc3BhdGNoOmZ1bmN0aW9uKGEpe2E9bi5ldmVudC5maXgoYSk7dmFyIGIsYyxlLGYsZyxoPVtdLGk9ZC5jYWxsKGFyZ3VtZW50cyksaj0oTC5nZXQodGhpcyxcImV2ZW50c1wiKXx8e30pW2EudHlwZV18fFtdLGs9bi5ldmVudC5zcGVjaWFsW2EudHlwZV18fHt9O2lmKGlbMF09YSxhLmRlbGVnYXRlVGFyZ2V0PXRoaXMsIWsucHJlRGlzcGF0Y2h8fGsucHJlRGlzcGF0Y2guY2FsbCh0aGlzLGEpIT09ITEpe2g9bi5ldmVudC5oYW5kbGVycy5jYWxsKHRoaXMsYSxqKSxiPTA7d2hpbGUoKGY9aFtiKytdKSYmIWEuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSl7YS5jdXJyZW50VGFyZ2V0PWYuZWxlbSxjPTA7d2hpbGUoKGc9Zi5oYW5kbGVyc1tjKytdKSYmIWEuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKSkoIWEubmFtZXNwYWNlX3JlfHxhLm5hbWVzcGFjZV9yZS50ZXN0KGcubmFtZXNwYWNlKSkmJihhLmhhbmRsZU9iaj1nLGEuZGF0YT1nLmRhdGEsZT0oKG4uZXZlbnQuc3BlY2lhbFtnLm9yaWdUeXBlXXx8e30pLmhhbmRsZXx8Zy5oYW5kbGVyKS5hcHBseShmLmVsZW0saSksdm9pZCAwIT09ZSYmKGEucmVzdWx0PWUpPT09ITEmJihhLnByZXZlbnREZWZhdWx0KCksYS5zdG9wUHJvcGFnYXRpb24oKSkpfXJldHVybiBrLnBvc3REaXNwYXRjaCYmay5wb3N0RGlzcGF0Y2guY2FsbCh0aGlzLGEpLGEucmVzdWx0fX0saGFuZGxlcnM6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkLGUsZixnPVtdLGg9Yi5kZWxlZ2F0ZUNvdW50LGk9YS50YXJnZXQ7aWYoaCYmaS5ub2RlVHlwZSYmKCFhLmJ1dHRvbnx8XCJjbGlja1wiIT09YS50eXBlKSlmb3IoO2khPT10aGlzO2k9aS5wYXJlbnROb2RlfHx0aGlzKWlmKGkuZGlzYWJsZWQhPT0hMHx8XCJjbGlja1wiIT09YS50eXBlKXtmb3IoZD1bXSxjPTA7aD5jO2MrKylmPWJbY10sZT1mLnNlbGVjdG9yK1wiIFwiLHZvaWQgMD09PWRbZV0mJihkW2VdPWYubmVlZHNDb250ZXh0P24oZSx0aGlzKS5pbmRleChpKT49MDpuLmZpbmQoZSx0aGlzLG51bGwsW2ldKS5sZW5ndGgpLGRbZV0mJmQucHVzaChmKTtkLmxlbmd0aCYmZy5wdXNoKHtlbGVtOmksaGFuZGxlcnM6ZH0pfXJldHVybiBoPGIubGVuZ3RoJiZnLnB1c2goe2VsZW06dGhpcyxoYW5kbGVyczpiLnNsaWNlKGgpfSksZ30scHJvcHM6XCJhbHRLZXkgYnViYmxlcyBjYW5jZWxhYmxlIGN0cmxLZXkgY3VycmVudFRhcmdldCBldmVudFBoYXNlIG1ldGFLZXkgcmVsYXRlZFRhcmdldCBzaGlmdEtleSB0YXJnZXQgdGltZVN0YW1wIHZpZXcgd2hpY2hcIi5zcGxpdChcIiBcIiksZml4SG9va3M6e30sa2V5SG9va3M6e3Byb3BzOlwiY2hhciBjaGFyQ29kZSBrZXkga2V5Q29kZVwiLnNwbGl0KFwiIFwiKSxmaWx0ZXI6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbnVsbD09YS53aGljaCYmKGEud2hpY2g9bnVsbCE9Yi5jaGFyQ29kZT9iLmNoYXJDb2RlOmIua2V5Q29kZSksYX19LG1vdXNlSG9va3M6e3Byb3BzOlwiYnV0dG9uIGJ1dHRvbnMgY2xpZW50WCBjbGllbnRZIG9mZnNldFggb2Zmc2V0WSBwYWdlWCBwYWdlWSBzY3JlZW5YIHNjcmVlblkgdG9FbGVtZW50XCIuc3BsaXQoXCIgXCIpLGZpbHRlcjpmdW5jdGlvbihhLGIpe3ZhciBjLGQsZSxmPWIuYnV0dG9uO3JldHVybiBudWxsPT1hLnBhZ2VYJiZudWxsIT1iLmNsaWVudFgmJihjPWEudGFyZ2V0Lm93bmVyRG9jdW1lbnR8fGwsZD1jLmRvY3VtZW50RWxlbWVudCxlPWMuYm9keSxhLnBhZ2VYPWIuY2xpZW50WCsoZCYmZC5zY3JvbGxMZWZ0fHxlJiZlLnNjcm9sbExlZnR8fDApLShkJiZkLmNsaWVudExlZnR8fGUmJmUuY2xpZW50TGVmdHx8MCksYS5wYWdlWT1iLmNsaWVudFkrKGQmJmQuc2Nyb2xsVG9wfHxlJiZlLnNjcm9sbFRvcHx8MCktKGQmJmQuY2xpZW50VG9wfHxlJiZlLmNsaWVudFRvcHx8MCkpLGEud2hpY2h8fHZvaWQgMD09PWZ8fChhLndoaWNoPTEmZj8xOjImZj8zOjQmZj8yOjApLGF9fSxmaXg6ZnVuY3Rpb24oYSl7aWYoYVtuLmV4cGFuZG9dKXJldHVybiBhO3ZhciBiLGMsZCxlPWEudHlwZSxmPWEsZz10aGlzLmZpeEhvb2tzW2VdO2d8fCh0aGlzLmZpeEhvb2tzW2VdPWc9Vy50ZXN0KGUpP3RoaXMubW91c2VIb29rczpWLnRlc3QoZSk/dGhpcy5rZXlIb29rczp7fSksZD1nLnByb3BzP3RoaXMucHJvcHMuY29uY2F0KGcucHJvcHMpOnRoaXMucHJvcHMsYT1uZXcgbi5FdmVudChmKSxiPWQubGVuZ3RoO3doaWxlKGItLSljPWRbYl0sYVtjXT1mW2NdO3JldHVybiBhLnRhcmdldHx8KGEudGFyZ2V0PWwpLDM9PT1hLnRhcmdldC5ub2RlVHlwZSYmKGEudGFyZ2V0PWEudGFyZ2V0LnBhcmVudE5vZGUpLGcuZmlsdGVyP2cuZmlsdGVyKGEsZik6YX0sc3BlY2lhbDp7bG9hZDp7bm9CdWJibGU6ITB9LGZvY3VzOnt0cmlnZ2VyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMhPT1fKCkmJnRoaXMuZm9jdXM/KHRoaXMuZm9jdXMoKSwhMSk6dm9pZCAwfSxkZWxlZ2F0ZVR5cGU6XCJmb2N1c2luXCJ9LGJsdXI6e3RyaWdnZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcz09PV8oKSYmdGhpcy5ibHVyPyh0aGlzLmJsdXIoKSwhMSk6dm9pZCAwfSxkZWxlZ2F0ZVR5cGU6XCJmb2N1c291dFwifSxjbGljazp7dHJpZ2dlcjpmdW5jdGlvbigpe3JldHVyblwiY2hlY2tib3hcIj09PXRoaXMudHlwZSYmdGhpcy5jbGljayYmbi5ub2RlTmFtZSh0aGlzLFwiaW5wdXRcIik/KHRoaXMuY2xpY2soKSwhMSk6dm9pZCAwfSxfZGVmYXVsdDpmdW5jdGlvbihhKXtyZXR1cm4gbi5ub2RlTmFtZShhLnRhcmdldCxcImFcIil9fSxiZWZvcmV1bmxvYWQ6e3Bvc3REaXNwYXRjaDpmdW5jdGlvbihhKXt2b2lkIDAhPT1hLnJlc3VsdCYmYS5vcmlnaW5hbEV2ZW50JiYoYS5vcmlnaW5hbEV2ZW50LnJldHVyblZhbHVlPWEucmVzdWx0KX19fSxzaW11bGF0ZTpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT1uLmV4dGVuZChuZXcgbi5FdmVudCxjLHt0eXBlOmEsaXNTaW11bGF0ZWQ6ITAsb3JpZ2luYWxFdmVudDp7fX0pO2Q/bi5ldmVudC50cmlnZ2VyKGUsbnVsbCxiKTpuLmV2ZW50LmRpc3BhdGNoLmNhbGwoYixlKSxlLmlzRGVmYXVsdFByZXZlbnRlZCgpJiZjLnByZXZlbnREZWZhdWx0KCl9fSxuLnJlbW92ZUV2ZW50PWZ1bmN0aW9uKGEsYixjKXthLnJlbW92ZUV2ZW50TGlzdGVuZXImJmEucmVtb3ZlRXZlbnRMaXN0ZW5lcihiLGMsITEpfSxuLkV2ZW50PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBuLkV2ZW50PyhhJiZhLnR5cGU/KHRoaXMub3JpZ2luYWxFdmVudD1hLHRoaXMudHlwZT1hLnR5cGUsdGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQ9YS5kZWZhdWx0UHJldmVudGVkfHx2b2lkIDA9PT1hLmRlZmF1bHRQcmV2ZW50ZWQmJmEucmV0dXJuVmFsdWU9PT0hMT9aOiQpOnRoaXMudHlwZT1hLGImJm4uZXh0ZW5kKHRoaXMsYiksdGhpcy50aW1lU3RhbXA9YSYmYS50aW1lU3RhbXB8fG4ubm93KCksdm9pZCh0aGlzW24uZXhwYW5kb109ITApKTpuZXcgbi5FdmVudChhLGIpfSxuLkV2ZW50LnByb3RvdHlwZT17aXNEZWZhdWx0UHJldmVudGVkOiQsaXNQcm9wYWdhdGlvblN0b3BwZWQ6JCxpc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZDokLHByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcmlnaW5hbEV2ZW50O3RoaXMuaXNEZWZhdWx0UHJldmVudGVkPVosYSYmYS5wcmV2ZW50RGVmYXVsdCYmYS5wcmV2ZW50RGVmYXVsdCgpfSxzdG9wUHJvcGFnYXRpb246ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9yaWdpbmFsRXZlbnQ7dGhpcy5pc1Byb3BhZ2F0aW9uU3RvcHBlZD1aLGEmJmEuc3RvcFByb3BhZ2F0aW9uJiZhLnN0b3BQcm9wYWdhdGlvbigpfSxzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb246ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9yaWdpbmFsRXZlbnQ7dGhpcy5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZD1aLGEmJmEuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uJiZhLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLHRoaXMuc3RvcFByb3BhZ2F0aW9uKCl9fSxuLmVhY2goe21vdXNlZW50ZXI6XCJtb3VzZW92ZXJcIixtb3VzZWxlYXZlOlwibW91c2VvdXRcIixwb2ludGVyZW50ZXI6XCJwb2ludGVyb3ZlclwiLHBvaW50ZXJsZWF2ZTpcInBvaW50ZXJvdXRcIn0sZnVuY3Rpb24oYSxiKXtuLmV2ZW50LnNwZWNpYWxbYV09e2RlbGVnYXRlVHlwZTpiLGJpbmRUeXBlOmIsaGFuZGxlOmZ1bmN0aW9uKGEpe3ZhciBjLGQ9dGhpcyxlPWEucmVsYXRlZFRhcmdldCxmPWEuaGFuZGxlT2JqO3JldHVybighZXx8ZSE9PWQmJiFuLmNvbnRhaW5zKGQsZSkpJiYoYS50eXBlPWYub3JpZ1R5cGUsYz1mLmhhbmRsZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLGEudHlwZT1iKSxjfX19KSxrLmZvY3VzaW5CdWJibGVzfHxuLmVhY2goe2ZvY3VzOlwiZm9jdXNpblwiLGJsdXI6XCJmb2N1c291dFwifSxmdW5jdGlvbihhLGIpe3ZhciBjPWZ1bmN0aW9uKGEpe24uZXZlbnQuc2ltdWxhdGUoYixhLnRhcmdldCxuLmV2ZW50LmZpeChhKSwhMCl9O24uZXZlbnQuc3BlY2lhbFtiXT17c2V0dXA6ZnVuY3Rpb24oKXt2YXIgZD10aGlzLm93bmVyRG9jdW1lbnR8fHRoaXMsZT1MLmFjY2VzcyhkLGIpO2V8fGQuYWRkRXZlbnRMaXN0ZW5lcihhLGMsITApLEwuYWNjZXNzKGQsYiwoZXx8MCkrMSl9LHRlYXJkb3duOmZ1bmN0aW9uKCl7dmFyIGQ9dGhpcy5vd25lckRvY3VtZW50fHx0aGlzLGU9TC5hY2Nlc3MoZCxiKS0xO2U/TC5hY2Nlc3MoZCxiLGUpOihkLnJlbW92ZUV2ZW50TGlzdGVuZXIoYSxjLCEwKSxMLnJlbW92ZShkLGIpKX19fSksbi5mbi5leHRlbmQoe29uOmZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGYsZztpZihcIm9iamVjdFwiPT10eXBlb2YgYSl7XCJzdHJpbmdcIiE9dHlwZW9mIGImJihjPWN8fGIsYj12b2lkIDApO2ZvcihnIGluIGEpdGhpcy5vbihnLGIsYyxhW2ddLGUpO3JldHVybiB0aGlzfWlmKG51bGw9PWMmJm51bGw9PWQ/KGQ9YixjPWI9dm9pZCAwKTpudWxsPT1kJiYoXCJzdHJpbmdcIj09dHlwZW9mIGI/KGQ9YyxjPXZvaWQgMCk6KGQ9YyxjPWIsYj12b2lkIDApKSxkPT09ITEpZD0kO2Vsc2UgaWYoIWQpcmV0dXJuIHRoaXM7cmV0dXJuIDE9PT1lJiYoZj1kLGQ9ZnVuY3Rpb24oYSl7cmV0dXJuIG4oKS5vZmYoYSksZi5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGQuZ3VpZD1mLmd1aWR8fChmLmd1aWQ9bi5ndWlkKyspKSx0aGlzLmVhY2goZnVuY3Rpb24oKXtuLmV2ZW50LmFkZCh0aGlzLGEsZCxjLGIpfSl9LG9uZTpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gdGhpcy5vbihhLGIsYyxkLDEpfSxvZmY6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGU7aWYoYSYmYS5wcmV2ZW50RGVmYXVsdCYmYS5oYW5kbGVPYmopcmV0dXJuIGQ9YS5oYW5kbGVPYmosbihhLmRlbGVnYXRlVGFyZ2V0KS5vZmYoZC5uYW1lc3BhY2U/ZC5vcmlnVHlwZStcIi5cIitkLm5hbWVzcGFjZTpkLm9yaWdUeXBlLGQuc2VsZWN0b3IsZC5oYW5kbGVyKSx0aGlzO2lmKFwib2JqZWN0XCI9PXR5cGVvZiBhKXtmb3IoZSBpbiBhKXRoaXMub2ZmKGUsYixhW2VdKTtyZXR1cm4gdGhpc31yZXR1cm4oYj09PSExfHxcImZ1bmN0aW9uXCI9PXR5cGVvZiBiKSYmKGM9YixiPXZvaWQgMCksYz09PSExJiYoYz0kKSx0aGlzLmVhY2goZnVuY3Rpb24oKXtuLmV2ZW50LnJlbW92ZSh0aGlzLGEsYyxiKX0pfSx0cmlnZ2VyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe24uZXZlbnQudHJpZ2dlcihhLGIsdGhpcyl9KX0sdHJpZ2dlckhhbmRsZXI6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzWzBdO3JldHVybiBjP24uZXZlbnQudHJpZ2dlcihhLGIsYywhMCk6dm9pZCAwfX0pO3ZhciBhYj0vPCg/IWFyZWF8YnJ8Y29sfGVtYmVkfGhyfGltZ3xpbnB1dHxsaW5rfG1ldGF8cGFyYW0pKChbXFx3Ol0rKVtePl0qKVxcLz4vZ2ksYmI9LzwoW1xcdzpdKykvLGNiPS88fCYjP1xcdys7LyxkYj0vPCg/OnNjcmlwdHxzdHlsZXxsaW5rKS9pLGViPS9jaGVja2VkXFxzKig/OltePV18PVxccyouY2hlY2tlZC4pL2ksZmI9L14kfFxcLyg/OmphdmF8ZWNtYSlzY3JpcHQvaSxnYj0vXnRydWVcXC8oLiopLyxoYj0vXlxccyo8ISg/OlxcW0NEQVRBXFxbfC0tKXwoPzpcXF1cXF18LS0pPlxccyokL2csaWI9e29wdGlvbjpbMSxcIjxzZWxlY3QgbXVsdGlwbGU9J211bHRpcGxlJz5cIixcIjwvc2VsZWN0PlwiXSx0aGVhZDpbMSxcIjx0YWJsZT5cIixcIjwvdGFibGU+XCJdLGNvbDpbMixcIjx0YWJsZT48Y29sZ3JvdXA+XCIsXCI8L2NvbGdyb3VwPjwvdGFibGU+XCJdLHRyOlsyLFwiPHRhYmxlPjx0Ym9keT5cIixcIjwvdGJvZHk+PC90YWJsZT5cIl0sdGQ6WzMsXCI8dGFibGU+PHRib2R5Pjx0cj5cIixcIjwvdHI+PC90Ym9keT48L3RhYmxlPlwiXSxfZGVmYXVsdDpbMCxcIlwiLFwiXCJdfTtpYi5vcHRncm91cD1pYi5vcHRpb24saWIudGJvZHk9aWIudGZvb3Q9aWIuY29sZ3JvdXA9aWIuY2FwdGlvbj1pYi50aGVhZCxpYi50aD1pYi50ZDtmdW5jdGlvbiBqYihhLGIpe3JldHVybiBuLm5vZGVOYW1lKGEsXCJ0YWJsZVwiKSYmbi5ub2RlTmFtZSgxMSE9PWIubm9kZVR5cGU/YjpiLmZpcnN0Q2hpbGQsXCJ0clwiKT9hLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwidGJvZHlcIilbMF18fGEuYXBwZW5kQ2hpbGQoYS5vd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0Ym9keVwiKSk6YX1mdW5jdGlvbiBrYihhKXtyZXR1cm4gYS50eXBlPShudWxsIT09YS5nZXRBdHRyaWJ1dGUoXCJ0eXBlXCIpKStcIi9cIithLnR5cGUsYX1mdW5jdGlvbiBsYihhKXt2YXIgYj1nYi5leGVjKGEudHlwZSk7cmV0dXJuIGI/YS50eXBlPWJbMV06YS5yZW1vdmVBdHRyaWJ1dGUoXCJ0eXBlXCIpLGF9ZnVuY3Rpb24gbWIoYSxiKXtmb3IodmFyIGM9MCxkPWEubGVuZ3RoO2Q+YztjKyspTC5zZXQoYVtjXSxcImdsb2JhbEV2YWxcIiwhYnx8TC5nZXQoYltjXSxcImdsb2JhbEV2YWxcIikpfWZ1bmN0aW9uIG5iKGEsYil7dmFyIGMsZCxlLGYsZyxoLGksajtpZigxPT09Yi5ub2RlVHlwZSl7aWYoTC5oYXNEYXRhKGEpJiYoZj1MLmFjY2VzcyhhKSxnPUwuc2V0KGIsZiksaj1mLmV2ZW50cykpe2RlbGV0ZSBnLmhhbmRsZSxnLmV2ZW50cz17fTtmb3IoZSBpbiBqKWZvcihjPTAsZD1qW2VdLmxlbmd0aDtkPmM7YysrKW4uZXZlbnQuYWRkKGIsZSxqW2VdW2NdKX1NLmhhc0RhdGEoYSkmJihoPU0uYWNjZXNzKGEpLGk9bi5leHRlbmQoe30saCksTS5zZXQoYixpKSl9fWZ1bmN0aW9uIG9iKGEsYil7dmFyIGM9YS5nZXRFbGVtZW50c0J5VGFnTmFtZT9hLmdldEVsZW1lbnRzQnlUYWdOYW1lKGJ8fFwiKlwiKTphLnF1ZXJ5U2VsZWN0b3JBbGw/YS5xdWVyeVNlbGVjdG9yQWxsKGJ8fFwiKlwiKTpbXTtyZXR1cm4gdm9pZCAwPT09Ynx8YiYmbi5ub2RlTmFtZShhLGIpP24ubWVyZ2UoW2FdLGMpOmN9ZnVuY3Rpb24gcGIoYSxiKXt2YXIgYz1iLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7XCJpbnB1dFwiPT09YyYmVC50ZXN0KGEudHlwZSk/Yi5jaGVja2VkPWEuY2hlY2tlZDooXCJpbnB1dFwiPT09Y3x8XCJ0ZXh0YXJlYVwiPT09YykmJihiLmRlZmF1bHRWYWx1ZT1hLmRlZmF1bHRWYWx1ZSl9bi5leHRlbmQoe2Nsb25lOmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlLGYsZyxoPWEuY2xvbmVOb2RlKCEwKSxpPW4uY29udGFpbnMoYS5vd25lckRvY3VtZW50LGEpO2lmKCEoay5ub0Nsb25lQ2hlY2tlZHx8MSE9PWEubm9kZVR5cGUmJjExIT09YS5ub2RlVHlwZXx8bi5pc1hNTERvYyhhKSkpZm9yKGc9b2IoaCksZj1vYihhKSxkPTAsZT1mLmxlbmd0aDtlPmQ7ZCsrKXBiKGZbZF0sZ1tkXSk7aWYoYilpZihjKWZvcihmPWZ8fG9iKGEpLGc9Z3x8b2IoaCksZD0wLGU9Zi5sZW5ndGg7ZT5kO2QrKyluYihmW2RdLGdbZF0pO2Vsc2UgbmIoYSxoKTtyZXR1cm4gZz1vYihoLFwic2NyaXB0XCIpLGcubGVuZ3RoPjAmJm1iKGcsIWkmJm9iKGEsXCJzY3JpcHRcIikpLGh9LGJ1aWxkRnJhZ21lbnQ6ZnVuY3Rpb24oYSxiLGMsZCl7Zm9yKHZhciBlLGYsZyxoLGksaixrPWIuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLGw9W10sbT0wLG89YS5sZW5ndGg7bz5tO20rKylpZihlPWFbbV0sZXx8MD09PWUpaWYoXCJvYmplY3RcIj09PW4udHlwZShlKSluLm1lcmdlKGwsZS5ub2RlVHlwZT9bZV06ZSk7ZWxzZSBpZihjYi50ZXN0KGUpKXtmPWZ8fGsuYXBwZW5kQ2hpbGQoYi5jcmVhdGVFbGVtZW50KFwiZGl2XCIpKSxnPShiYi5leGVjKGUpfHxbXCJcIixcIlwiXSlbMV0udG9Mb3dlckNhc2UoKSxoPWliW2ddfHxpYi5fZGVmYXVsdCxmLmlubmVySFRNTD1oWzFdK2UucmVwbGFjZShhYixcIjwkMT48LyQyPlwiKStoWzJdLGo9aFswXTt3aGlsZShqLS0pZj1mLmxhc3RDaGlsZDtuLm1lcmdlKGwsZi5jaGlsZE5vZGVzKSxmPWsuZmlyc3RDaGlsZCxmLnRleHRDb250ZW50PVwiXCJ9ZWxzZSBsLnB1c2goYi5jcmVhdGVUZXh0Tm9kZShlKSk7ay50ZXh0Q29udGVudD1cIlwiLG09MDt3aGlsZShlPWxbbSsrXSlpZigoIWR8fC0xPT09bi5pbkFycmF5KGUsZCkpJiYoaT1uLmNvbnRhaW5zKGUub3duZXJEb2N1bWVudCxlKSxmPW9iKGsuYXBwZW5kQ2hpbGQoZSksXCJzY3JpcHRcIiksaSYmbWIoZiksYykpe2o9MDt3aGlsZShlPWZbaisrXSlmYi50ZXN0KGUudHlwZXx8XCJcIikmJmMucHVzaChlKX1yZXR1cm4ga30sY2xlYW5EYXRhOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYixjLGQsZSxmPW4uZXZlbnQuc3BlY2lhbCxnPTA7dm9pZCAwIT09KGM9YVtnXSk7ZysrKXtpZihuLmFjY2VwdERhdGEoYykmJihlPWNbTC5leHBhbmRvXSxlJiYoYj1MLmNhY2hlW2VdKSkpe2lmKGIuZXZlbnRzKWZvcihkIGluIGIuZXZlbnRzKWZbZF0/bi5ldmVudC5yZW1vdmUoYyxkKTpuLnJlbW92ZUV2ZW50KGMsZCxiLmhhbmRsZSk7TC5jYWNoZVtlXSYmZGVsZXRlIEwuY2FjaGVbZV19ZGVsZXRlIE0uY2FjaGVbY1tNLmV4cGFuZG9dXX19fSksbi5mbi5leHRlbmQoe3RleHQ6ZnVuY3Rpb24oYSl7cmV0dXJuIEoodGhpcyxmdW5jdGlvbihhKXtyZXR1cm4gdm9pZCAwPT09YT9uLnRleHQodGhpcyk6dGhpcy5lbXB0eSgpLmVhY2goZnVuY3Rpb24oKXsoMT09PXRoaXMubm9kZVR5cGV8fDExPT09dGhpcy5ub2RlVHlwZXx8OT09PXRoaXMubm9kZVR5cGUpJiYodGhpcy50ZXh0Q29udGVudD1hKX0pfSxudWxsLGEsYXJndW1lbnRzLmxlbmd0aCl9LGFwcGVuZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cyxmdW5jdGlvbihhKXtpZigxPT09dGhpcy5ub2RlVHlwZXx8MTE9PT10aGlzLm5vZGVUeXBlfHw5PT09dGhpcy5ub2RlVHlwZSl7dmFyIGI9amIodGhpcyxhKTtiLmFwcGVuZENoaWxkKGEpfX0pfSxwcmVwZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLGZ1bmN0aW9uKGEpe2lmKDE9PT10aGlzLm5vZGVUeXBlfHwxMT09PXRoaXMubm9kZVR5cGV8fDk9PT10aGlzLm5vZGVUeXBlKXt2YXIgYj1qYih0aGlzLGEpO2IuaW5zZXJ0QmVmb3JlKGEsYi5maXJzdENoaWxkKX19KX0sYmVmb3JlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLGZ1bmN0aW9uKGEpe3RoaXMucGFyZW50Tm9kZSYmdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShhLHRoaXMpfSl9LGFmdGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLGZ1bmN0aW9uKGEpe3RoaXMucGFyZW50Tm9kZSYmdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShhLHRoaXMubmV4dFNpYmxpbmcpfSl9LHJlbW92ZTpmdW5jdGlvbihhLGIpe2Zvcih2YXIgYyxkPWE/bi5maWx0ZXIoYSx0aGlzKTp0aGlzLGU9MDtudWxsIT0oYz1kW2VdKTtlKyspYnx8MSE9PWMubm9kZVR5cGV8fG4uY2xlYW5EYXRhKG9iKGMpKSxjLnBhcmVudE5vZGUmJihiJiZuLmNvbnRhaW5zKGMub3duZXJEb2N1bWVudCxjKSYmbWIob2IoYyxcInNjcmlwdFwiKSksYy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGMpKTtyZXR1cm4gdGhpc30sZW1wdHk6ZnVuY3Rpb24oKXtmb3IodmFyIGEsYj0wO251bGwhPShhPXRoaXNbYl0pO2IrKykxPT09YS5ub2RlVHlwZSYmKG4uY2xlYW5EYXRhKG9iKGEsITEpKSxhLnRleHRDb250ZW50PVwiXCIpO3JldHVybiB0aGlzfSxjbG9uZTpmdW5jdGlvbihhLGIpe3JldHVybiBhPW51bGw9PWE/ITE6YSxiPW51bGw9PWI/YTpiLHRoaXMubWFwKGZ1bmN0aW9uKCl7cmV0dXJuIG4uY2xvbmUodGhpcyxhLGIpfSl9LGh0bWw6ZnVuY3Rpb24oYSl7cmV0dXJuIEoodGhpcyxmdW5jdGlvbihhKXt2YXIgYj10aGlzWzBdfHx7fSxjPTAsZD10aGlzLmxlbmd0aDtpZih2b2lkIDA9PT1hJiYxPT09Yi5ub2RlVHlwZSlyZXR1cm4gYi5pbm5lckhUTUw7aWYoXCJzdHJpbmdcIj09dHlwZW9mIGEmJiFkYi50ZXN0KGEpJiYhaWJbKGJiLmV4ZWMoYSl8fFtcIlwiLFwiXCJdKVsxXS50b0xvd2VyQ2FzZSgpXSl7YT1hLnJlcGxhY2UoYWIsXCI8JDE+PC8kMj5cIik7dHJ5e2Zvcig7ZD5jO2MrKyliPXRoaXNbY118fHt9LDE9PT1iLm5vZGVUeXBlJiYobi5jbGVhbkRhdGEob2IoYiwhMSkpLGIuaW5uZXJIVE1MPWEpO2I9MH1jYXRjaChlKXt9fWImJnRoaXMuZW1wdHkoKS5hcHBlbmQoYSl9LG51bGwsYSxhcmd1bWVudHMubGVuZ3RoKX0scmVwbGFjZVdpdGg6ZnVuY3Rpb24oKXt2YXIgYT1hcmd1bWVudHNbMF07cmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLGZ1bmN0aW9uKGIpe2E9dGhpcy5wYXJlbnROb2RlLG4uY2xlYW5EYXRhKG9iKHRoaXMpKSxhJiZhLnJlcGxhY2VDaGlsZChiLHRoaXMpfSksYSYmKGEubGVuZ3RofHxhLm5vZGVUeXBlKT90aGlzOnRoaXMucmVtb3ZlKCl9LGRldGFjaDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5yZW1vdmUoYSwhMCl9LGRvbU1hbmlwOmZ1bmN0aW9uKGEsYil7YT1lLmFwcGx5KFtdLGEpO3ZhciBjLGQsZixnLGgsaSxqPTAsbD10aGlzLmxlbmd0aCxtPXRoaXMsbz1sLTEscD1hWzBdLHE9bi5pc0Z1bmN0aW9uKHApO2lmKHF8fGw+MSYmXCJzdHJpbmdcIj09dHlwZW9mIHAmJiFrLmNoZWNrQ2xvbmUmJmViLnRlc3QocCkpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihjKXt2YXIgZD1tLmVxKGMpO3EmJihhWzBdPXAuY2FsbCh0aGlzLGMsZC5odG1sKCkpKSxkLmRvbU1hbmlwKGEsYil9KTtpZihsJiYoYz1uLmJ1aWxkRnJhZ21lbnQoYSx0aGlzWzBdLm93bmVyRG9jdW1lbnQsITEsdGhpcyksZD1jLmZpcnN0Q2hpbGQsMT09PWMuY2hpbGROb2Rlcy5sZW5ndGgmJihjPWQpLGQpKXtmb3IoZj1uLm1hcChvYihjLFwic2NyaXB0XCIpLGtiKSxnPWYubGVuZ3RoO2w+ajtqKyspaD1jLGohPT1vJiYoaD1uLmNsb25lKGgsITAsITApLGcmJm4ubWVyZ2UoZixvYihoLFwic2NyaXB0XCIpKSksYi5jYWxsKHRoaXNbal0saCxqKTtpZihnKWZvcihpPWZbZi5sZW5ndGgtMV0ub3duZXJEb2N1bWVudCxuLm1hcChmLGxiKSxqPTA7Zz5qO2orKyloPWZbal0sZmIudGVzdChoLnR5cGV8fFwiXCIpJiYhTC5hY2Nlc3MoaCxcImdsb2JhbEV2YWxcIikmJm4uY29udGFpbnMoaSxoKSYmKGguc3JjP24uX2V2YWxVcmwmJm4uX2V2YWxVcmwoaC5zcmMpOm4uZ2xvYmFsRXZhbChoLnRleHRDb250ZW50LnJlcGxhY2UoaGIsXCJcIikpKX1yZXR1cm4gdGhpc319KSxuLmVhY2goe2FwcGVuZFRvOlwiYXBwZW5kXCIscHJlcGVuZFRvOlwicHJlcGVuZFwiLGluc2VydEJlZm9yZTpcImJlZm9yZVwiLGluc2VydEFmdGVyOlwiYWZ0ZXJcIixyZXBsYWNlQWxsOlwicmVwbGFjZVdpdGhcIn0sZnVuY3Rpb24oYSxiKXtuLmZuW2FdPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYyxkPVtdLGU9bihhKSxnPWUubGVuZ3RoLTEsaD0wO2c+PWg7aCsrKWM9aD09PWc/dGhpczp0aGlzLmNsb25lKCEwKSxuKGVbaF0pW2JdKGMpLGYuYXBwbHkoZCxjLmdldCgpKTtyZXR1cm4gdGhpcy5wdXNoU3RhY2soZCl9fSk7dmFyIHFiLHJiPXt9O2Z1bmN0aW9uIHNiKGIsYyl7dmFyIGQsZT1uKGMuY3JlYXRlRWxlbWVudChiKSkuYXBwZW5kVG8oYy5ib2R5KSxmPWEuZ2V0RGVmYXVsdENvbXB1dGVkU3R5bGUmJihkPWEuZ2V0RGVmYXVsdENvbXB1dGVkU3R5bGUoZVswXSkpP2QuZGlzcGxheTpuLmNzcyhlWzBdLFwiZGlzcGxheVwiKTtyZXR1cm4gZS5kZXRhY2goKSxmfWZ1bmN0aW9uIHRiKGEpe3ZhciBiPWwsYz1yYlthXTtyZXR1cm4gY3x8KGM9c2IoYSxiKSxcIm5vbmVcIiE9PWMmJmN8fChxYj0ocWJ8fG4oXCI8aWZyYW1lIGZyYW1lYm9yZGVyPScwJyB3aWR0aD0nMCcgaGVpZ2h0PScwJy8+XCIpKS5hcHBlbmRUbyhiLmRvY3VtZW50RWxlbWVudCksYj1xYlswXS5jb250ZW50RG9jdW1lbnQsYi53cml0ZSgpLGIuY2xvc2UoKSxjPXNiKGEsYikscWIuZGV0YWNoKCkpLHJiW2FdPWMpLGN9dmFyIHViPS9ebWFyZ2luLyx2Yj1uZXcgUmVnRXhwKFwiXihcIitRK1wiKSg/IXB4KVthLXolXSskXCIsXCJpXCIpLHdiPWZ1bmN0aW9uKGIpe3JldHVybiBiLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcub3BlbmVyP2Iub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKGIsbnVsbCk6YS5nZXRDb21wdXRlZFN0eWxlKGIsbnVsbCl9O2Z1bmN0aW9uIHhiKGEsYixjKXt2YXIgZCxlLGYsZyxoPWEuc3R5bGU7cmV0dXJuIGM9Y3x8d2IoYSksYyYmKGc9Yy5nZXRQcm9wZXJ0eVZhbHVlKGIpfHxjW2JdKSxjJiYoXCJcIiE9PWd8fG4uY29udGFpbnMoYS5vd25lckRvY3VtZW50LGEpfHwoZz1uLnN0eWxlKGEsYikpLHZiLnRlc3QoZykmJnViLnRlc3QoYikmJihkPWgud2lkdGgsZT1oLm1pbldpZHRoLGY9aC5tYXhXaWR0aCxoLm1pbldpZHRoPWgubWF4V2lkdGg9aC53aWR0aD1nLGc9Yy53aWR0aCxoLndpZHRoPWQsaC5taW5XaWR0aD1lLGgubWF4V2lkdGg9ZikpLHZvaWQgMCE9PWc/ZytcIlwiOmd9ZnVuY3Rpb24geWIoYSxiKXtyZXR1cm57Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGEoKT92b2lkIGRlbGV0ZSB0aGlzLmdldDoodGhpcy5nZXQ9YikuYXBwbHkodGhpcyxhcmd1bWVudHMpfX19IWZ1bmN0aW9uKCl7dmFyIGIsYyxkPWwuZG9jdW1lbnRFbGVtZW50LGU9bC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLGY9bC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO2lmKGYuc3R5bGUpe2Yuc3R5bGUuYmFja2dyb3VuZENsaXA9XCJjb250ZW50LWJveFwiLGYuY2xvbmVOb2RlKCEwKS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcD1cIlwiLGsuY2xlYXJDbG9uZVN0eWxlPVwiY29udGVudC1ib3hcIj09PWYuc3R5bGUuYmFja2dyb3VuZENsaXAsZS5zdHlsZS5jc3NUZXh0PVwiYm9yZGVyOjA7d2lkdGg6MDtoZWlnaHQ6MDt0b3A6MDtsZWZ0Oi05OTk5cHg7bWFyZ2luLXRvcDoxcHg7cG9zaXRpb246YWJzb2x1dGVcIixlLmFwcGVuZENoaWxkKGYpO2Z1bmN0aW9uIGcoKXtmLnN0eWxlLmNzc1RleHQ9XCItd2Via2l0LWJveC1zaXppbmc6Ym9yZGVyLWJveDstbW96LWJveC1zaXppbmc6Ym9yZGVyLWJveDtib3gtc2l6aW5nOmJvcmRlci1ib3g7ZGlzcGxheTpibG9jazttYXJnaW4tdG9wOjElO3RvcDoxJTtib3JkZXI6MXB4O3BhZGRpbmc6MXB4O3dpZHRoOjRweDtwb3NpdGlvbjphYnNvbHV0ZVwiLGYuaW5uZXJIVE1MPVwiXCIsZC5hcHBlbmRDaGlsZChlKTt2YXIgZz1hLmdldENvbXB1dGVkU3R5bGUoZixudWxsKTtiPVwiMSVcIiE9PWcudG9wLGM9XCI0cHhcIj09PWcud2lkdGgsZC5yZW1vdmVDaGlsZChlKX1hLmdldENvbXB1dGVkU3R5bGUmJm4uZXh0ZW5kKGsse3BpeGVsUG9zaXRpb246ZnVuY3Rpb24oKXtyZXR1cm4gZygpLGJ9LGJveFNpemluZ1JlbGlhYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIG51bGw9PWMmJmcoKSxjfSxyZWxpYWJsZU1hcmdpblJpZ2h0OmZ1bmN0aW9uKCl7dmFyIGIsYz1mLmFwcGVuZENoaWxkKGwuY3JlYXRlRWxlbWVudChcImRpdlwiKSk7cmV0dXJuIGMuc3R5bGUuY3NzVGV4dD1mLnN0eWxlLmNzc1RleHQ9XCItd2Via2l0LWJveC1zaXppbmc6Y29udGVudC1ib3g7LW1vei1ib3gtc2l6aW5nOmNvbnRlbnQtYm94O2JveC1zaXppbmc6Y29udGVudC1ib3g7ZGlzcGxheTpibG9jazttYXJnaW46MDtib3JkZXI6MDtwYWRkaW5nOjBcIixjLnN0eWxlLm1hcmdpblJpZ2h0PWMuc3R5bGUud2lkdGg9XCIwXCIsZi5zdHlsZS53aWR0aD1cIjFweFwiLGQuYXBwZW5kQ2hpbGQoZSksYj0hcGFyc2VGbG9hdChhLmdldENvbXB1dGVkU3R5bGUoYyxudWxsKS5tYXJnaW5SaWdodCksZC5yZW1vdmVDaGlsZChlKSxmLnJlbW92ZUNoaWxkKGMpLGJ9fSl9fSgpLG4uc3dhcD1mdW5jdGlvbihhLGIsYyxkKXt2YXIgZSxmLGc9e307Zm9yKGYgaW4gYilnW2ZdPWEuc3R5bGVbZl0sYS5zdHlsZVtmXT1iW2ZdO2U9Yy5hcHBseShhLGR8fFtdKTtmb3IoZiBpbiBiKWEuc3R5bGVbZl09Z1tmXTtyZXR1cm4gZX07dmFyIHpiPS9eKG5vbmV8dGFibGUoPyEtY1tlYV0pLispLyxBYj1uZXcgUmVnRXhwKFwiXihcIitRK1wiKSguKikkXCIsXCJpXCIpLEJiPW5ldyBSZWdFeHAoXCJeKFsrLV0pPShcIitRK1wiKVwiLFwiaVwiKSxDYj17cG9zaXRpb246XCJhYnNvbHV0ZVwiLHZpc2liaWxpdHk6XCJoaWRkZW5cIixkaXNwbGF5OlwiYmxvY2tcIn0sRGI9e2xldHRlclNwYWNpbmc6XCIwXCIsZm9udFdlaWdodDpcIjQwMFwifSxFYj1bXCJXZWJraXRcIixcIk9cIixcIk1velwiLFwibXNcIl07ZnVuY3Rpb24gRmIoYSxiKXtpZihiIGluIGEpcmV0dXJuIGI7dmFyIGM9YlswXS50b1VwcGVyQ2FzZSgpK2Iuc2xpY2UoMSksZD1iLGU9RWIubGVuZ3RoO3doaWxlKGUtLSlpZihiPUViW2VdK2MsYiBpbiBhKXJldHVybiBiO3JldHVybiBkfWZ1bmN0aW9uIEdiKGEsYixjKXt2YXIgZD1BYi5leGVjKGIpO3JldHVybiBkP01hdGgubWF4KDAsZFsxXS0oY3x8MCkpKyhkWzJdfHxcInB4XCIpOmJ9ZnVuY3Rpb24gSGIoYSxiLGMsZCxlKXtmb3IodmFyIGY9Yz09PShkP1wiYm9yZGVyXCI6XCJjb250ZW50XCIpPzQ6XCJ3aWR0aFwiPT09Yj8xOjAsZz0wOzQ+ZjtmKz0yKVwibWFyZ2luXCI9PT1jJiYoZys9bi5jc3MoYSxjK1JbZl0sITAsZSkpLGQ/KFwiY29udGVudFwiPT09YyYmKGctPW4uY3NzKGEsXCJwYWRkaW5nXCIrUltmXSwhMCxlKSksXCJtYXJnaW5cIiE9PWMmJihnLT1uLmNzcyhhLFwiYm9yZGVyXCIrUltmXStcIldpZHRoXCIsITAsZSkpKTooZys9bi5jc3MoYSxcInBhZGRpbmdcIitSW2ZdLCEwLGUpLFwicGFkZGluZ1wiIT09YyYmKGcrPW4uY3NzKGEsXCJib3JkZXJcIitSW2ZdK1wiV2lkdGhcIiwhMCxlKSkpO3JldHVybiBnfWZ1bmN0aW9uIEliKGEsYixjKXt2YXIgZD0hMCxlPVwid2lkdGhcIj09PWI/YS5vZmZzZXRXaWR0aDphLm9mZnNldEhlaWdodCxmPXdiKGEpLGc9XCJib3JkZXItYm94XCI9PT1uLmNzcyhhLFwiYm94U2l6aW5nXCIsITEsZik7aWYoMD49ZXx8bnVsbD09ZSl7aWYoZT14YihhLGIsZiksKDA+ZXx8bnVsbD09ZSkmJihlPWEuc3R5bGVbYl0pLHZiLnRlc3QoZSkpcmV0dXJuIGU7ZD1nJiYoay5ib3hTaXppbmdSZWxpYWJsZSgpfHxlPT09YS5zdHlsZVtiXSksZT1wYXJzZUZsb2F0KGUpfHwwfXJldHVybiBlK0hiKGEsYixjfHwoZz9cImJvcmRlclwiOlwiY29udGVudFwiKSxkLGYpK1wicHhcIn1mdW5jdGlvbiBKYihhLGIpe2Zvcih2YXIgYyxkLGUsZj1bXSxnPTAsaD1hLmxlbmd0aDtoPmc7ZysrKWQ9YVtnXSxkLnN0eWxlJiYoZltnXT1MLmdldChkLFwib2xkZGlzcGxheVwiKSxjPWQuc3R5bGUuZGlzcGxheSxiPyhmW2ddfHxcIm5vbmVcIiE9PWN8fChkLnN0eWxlLmRpc3BsYXk9XCJcIiksXCJcIj09PWQuc3R5bGUuZGlzcGxheSYmUyhkKSYmKGZbZ109TC5hY2Nlc3MoZCxcIm9sZGRpc3BsYXlcIix0YihkLm5vZGVOYW1lKSkpKTooZT1TKGQpLFwibm9uZVwiPT09YyYmZXx8TC5zZXQoZCxcIm9sZGRpc3BsYXlcIixlP2M6bi5jc3MoZCxcImRpc3BsYXlcIikpKSk7Zm9yKGc9MDtoPmc7ZysrKWQ9YVtnXSxkLnN0eWxlJiYoYiYmXCJub25lXCIhPT1kLnN0eWxlLmRpc3BsYXkmJlwiXCIhPT1kLnN0eWxlLmRpc3BsYXl8fChkLnN0eWxlLmRpc3BsYXk9Yj9mW2ddfHxcIlwiOlwibm9uZVwiKSk7cmV0dXJuIGF9bi5leHRlbmQoe2Nzc0hvb2tzOntvcGFjaXR5OntnZXQ6ZnVuY3Rpb24oYSxiKXtpZihiKXt2YXIgYz14YihhLFwib3BhY2l0eVwiKTtyZXR1cm5cIlwiPT09Yz9cIjFcIjpjfX19fSxjc3NOdW1iZXI6e2NvbHVtbkNvdW50OiEwLGZpbGxPcGFjaXR5OiEwLGZsZXhHcm93OiEwLGZsZXhTaHJpbms6ITAsZm9udFdlaWdodDohMCxsaW5lSGVpZ2h0OiEwLG9wYWNpdHk6ITAsb3JkZXI6ITAsb3JwaGFuczohMCx3aWRvd3M6ITAsekluZGV4OiEwLHpvb206ITB9LGNzc1Byb3BzOntcImZsb2F0XCI6XCJjc3NGbG9hdFwifSxzdHlsZTpmdW5jdGlvbihhLGIsYyxkKXtpZihhJiYzIT09YS5ub2RlVHlwZSYmOCE9PWEubm9kZVR5cGUmJmEuc3R5bGUpe3ZhciBlLGYsZyxoPW4uY2FtZWxDYXNlKGIpLGk9YS5zdHlsZTtyZXR1cm4gYj1uLmNzc1Byb3BzW2hdfHwobi5jc3NQcm9wc1toXT1GYihpLGgpKSxnPW4uY3NzSG9va3NbYl18fG4uY3NzSG9va3NbaF0sdm9pZCAwPT09Yz9nJiZcImdldFwiaW4gZyYmdm9pZCAwIT09KGU9Zy5nZXQoYSwhMSxkKSk/ZTppW2JdOihmPXR5cGVvZiBjLFwic3RyaW5nXCI9PT1mJiYoZT1CYi5leGVjKGMpKSYmKGM9KGVbMV0rMSkqZVsyXStwYXJzZUZsb2F0KG4uY3NzKGEsYikpLGY9XCJudW1iZXJcIiksbnVsbCE9YyYmYz09PWMmJihcIm51bWJlclwiIT09Znx8bi5jc3NOdW1iZXJbaF18fChjKz1cInB4XCIpLGsuY2xlYXJDbG9uZVN0eWxlfHxcIlwiIT09Y3x8MCE9PWIuaW5kZXhPZihcImJhY2tncm91bmRcIil8fChpW2JdPVwiaW5oZXJpdFwiKSxnJiZcInNldFwiaW4gZyYmdm9pZCAwPT09KGM9Zy5zZXQoYSxjLGQpKXx8KGlbYl09YykpLHZvaWQgMCl9fSxjc3M6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGUsZixnLGg9bi5jYW1lbENhc2UoYik7cmV0dXJuIGI9bi5jc3NQcm9wc1toXXx8KG4uY3NzUHJvcHNbaF09RmIoYS5zdHlsZSxoKSksZz1uLmNzc0hvb2tzW2JdfHxuLmNzc0hvb2tzW2hdLGcmJlwiZ2V0XCJpbiBnJiYoZT1nLmdldChhLCEwLGMpKSx2b2lkIDA9PT1lJiYoZT14YihhLGIsZCkpLFwibm9ybWFsXCI9PT1lJiZiIGluIERiJiYoZT1EYltiXSksXCJcIj09PWN8fGM/KGY9cGFyc2VGbG9hdChlKSxjPT09ITB8fG4uaXNOdW1lcmljKGYpP2Z8fDA6ZSk6ZX19KSxuLmVhY2goW1wiaGVpZ2h0XCIsXCJ3aWR0aFwiXSxmdW5jdGlvbihhLGIpe24uY3NzSG9va3NbYl09e2dldDpmdW5jdGlvbihhLGMsZCl7cmV0dXJuIGM/emIudGVzdChuLmNzcyhhLFwiZGlzcGxheVwiKSkmJjA9PT1hLm9mZnNldFdpZHRoP24uc3dhcChhLENiLGZ1bmN0aW9uKCl7cmV0dXJuIEliKGEsYixkKX0pOkliKGEsYixkKTp2b2lkIDB9LHNldDpmdW5jdGlvbihhLGMsZCl7dmFyIGU9ZCYmd2IoYSk7cmV0dXJuIEdiKGEsYyxkP0hiKGEsYixkLFwiYm9yZGVyLWJveFwiPT09bi5jc3MoYSxcImJveFNpemluZ1wiLCExLGUpLGUpOjApfX19KSxuLmNzc0hvb2tzLm1hcmdpblJpZ2h0PXliKGsucmVsaWFibGVNYXJnaW5SaWdodCxmdW5jdGlvbihhLGIpe3JldHVybiBiP24uc3dhcChhLHtkaXNwbGF5OlwiaW5saW5lLWJsb2NrXCJ9LHhiLFthLFwibWFyZ2luUmlnaHRcIl0pOnZvaWQgMH0pLG4uZWFjaCh7bWFyZ2luOlwiXCIscGFkZGluZzpcIlwiLGJvcmRlcjpcIldpZHRoXCJ9LGZ1bmN0aW9uKGEsYil7bi5jc3NIb29rc1thK2JdPXtleHBhbmQ6ZnVuY3Rpb24oYyl7Zm9yKHZhciBkPTAsZT17fSxmPVwic3RyaW5nXCI9PXR5cGVvZiBjP2Muc3BsaXQoXCIgXCIpOltjXTs0PmQ7ZCsrKWVbYStSW2RdK2JdPWZbZF18fGZbZC0yXXx8ZlswXTtyZXR1cm4gZX19LHViLnRlc3QoYSl8fChuLmNzc0hvb2tzW2ErYl0uc2V0PUdiKX0pLG4uZm4uZXh0ZW5kKHtjc3M6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gSih0aGlzLGZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlLGY9e30sZz0wO2lmKG4uaXNBcnJheShiKSl7Zm9yKGQ9d2IoYSksZT1iLmxlbmd0aDtlPmc7ZysrKWZbYltnXV09bi5jc3MoYSxiW2ddLCExLGQpO3JldHVybiBmfXJldHVybiB2b2lkIDAhPT1jP24uc3R5bGUoYSxiLGMpOm4uY3NzKGEsYil9LGEsYixhcmd1bWVudHMubGVuZ3RoPjEpfSxzaG93OmZ1bmN0aW9uKCl7cmV0dXJuIEpiKHRoaXMsITApfSxoaWRlOmZ1bmN0aW9uKCl7cmV0dXJuIEpiKHRoaXMpfSx0b2dnbGU6ZnVuY3Rpb24oYSl7cmV0dXJuXCJib29sZWFuXCI9PXR5cGVvZiBhP2E/dGhpcy5zaG93KCk6dGhpcy5oaWRlKCk6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7Uyh0aGlzKT9uKHRoaXMpLnNob3coKTpuKHRoaXMpLmhpZGUoKX0pfX0pO2Z1bmN0aW9uIEtiKGEsYixjLGQsZSl7cmV0dXJuIG5ldyBLYi5wcm90b3R5cGUuaW5pdChhLGIsYyxkLGUpfW4uVHdlZW49S2IsS2IucHJvdG90eXBlPXtjb25zdHJ1Y3RvcjpLYixpbml0OmZ1bmN0aW9uKGEsYixjLGQsZSxmKXt0aGlzLmVsZW09YSx0aGlzLnByb3A9Yyx0aGlzLmVhc2luZz1lfHxcInN3aW5nXCIsdGhpcy5vcHRpb25zPWIsdGhpcy5zdGFydD10aGlzLm5vdz10aGlzLmN1cigpLHRoaXMuZW5kPWQsdGhpcy51bml0PWZ8fChuLmNzc051bWJlcltjXT9cIlwiOlwicHhcIil9LGN1cjpmdW5jdGlvbigpe3ZhciBhPUtiLnByb3BIb29rc1t0aGlzLnByb3BdO3JldHVybiBhJiZhLmdldD9hLmdldCh0aGlzKTpLYi5wcm9wSG9va3MuX2RlZmF1bHQuZ2V0KHRoaXMpfSxydW46ZnVuY3Rpb24oYSl7dmFyIGIsYz1LYi5wcm9wSG9va3NbdGhpcy5wcm9wXTtyZXR1cm4gdGhpcy5wb3M9Yj10aGlzLm9wdGlvbnMuZHVyYXRpb24/bi5lYXNpbmdbdGhpcy5lYXNpbmddKGEsdGhpcy5vcHRpb25zLmR1cmF0aW9uKmEsMCwxLHRoaXMub3B0aW9ucy5kdXJhdGlvbik6YSx0aGlzLm5vdz0odGhpcy5lbmQtdGhpcy5zdGFydCkqYit0aGlzLnN0YXJ0LHRoaXMub3B0aW9ucy5zdGVwJiZ0aGlzLm9wdGlvbnMuc3RlcC5jYWxsKHRoaXMuZWxlbSx0aGlzLm5vdyx0aGlzKSxjJiZjLnNldD9jLnNldCh0aGlzKTpLYi5wcm9wSG9va3MuX2RlZmF1bHQuc2V0KHRoaXMpLHRoaXN9fSxLYi5wcm90b3R5cGUuaW5pdC5wcm90b3R5cGU9S2IucHJvdG90eXBlLEtiLnByb3BIb29rcz17X2RlZmF1bHQ6e2dldDpmdW5jdGlvbihhKXt2YXIgYjtyZXR1cm4gbnVsbD09YS5lbGVtW2EucHJvcF18fGEuZWxlbS5zdHlsZSYmbnVsbCE9YS5lbGVtLnN0eWxlW2EucHJvcF0/KGI9bi5jc3MoYS5lbGVtLGEucHJvcCxcIlwiKSxiJiZcImF1dG9cIiE9PWI/YjowKTphLmVsZW1bYS5wcm9wXX0sc2V0OmZ1bmN0aW9uKGEpe24uZnguc3RlcFthLnByb3BdP24uZnguc3RlcFthLnByb3BdKGEpOmEuZWxlbS5zdHlsZSYmKG51bGwhPWEuZWxlbS5zdHlsZVtuLmNzc1Byb3BzW2EucHJvcF1dfHxuLmNzc0hvb2tzW2EucHJvcF0pP24uc3R5bGUoYS5lbGVtLGEucHJvcCxhLm5vdythLnVuaXQpOmEuZWxlbVthLnByb3BdPWEubm93fX19LEtiLnByb3BIb29rcy5zY3JvbGxUb3A9S2IucHJvcEhvb2tzLnNjcm9sbExlZnQ9e3NldDpmdW5jdGlvbihhKXthLmVsZW0ubm9kZVR5cGUmJmEuZWxlbS5wYXJlbnROb2RlJiYoYS5lbGVtW2EucHJvcF09YS5ub3cpfX0sbi5lYXNpbmc9e2xpbmVhcjpmdW5jdGlvbihhKXtyZXR1cm4gYX0sc3dpbmc6ZnVuY3Rpb24oYSl7cmV0dXJuLjUtTWF0aC5jb3MoYSpNYXRoLlBJKS8yfX0sbi5meD1LYi5wcm90b3R5cGUuaW5pdCxuLmZ4LnN0ZXA9e307dmFyIExiLE1iLE5iPS9eKD86dG9nZ2xlfHNob3d8aGlkZSkkLyxPYj1uZXcgUmVnRXhwKFwiXig/OihbKy1dKT18KShcIitRK1wiKShbYS16JV0qKSRcIixcImlcIiksUGI9L3F1ZXVlSG9va3MkLyxRYj1bVmJdLFJiPXtcIipcIjpbZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNyZWF0ZVR3ZWVuKGEsYiksZD1jLmN1cigpLGU9T2IuZXhlYyhiKSxmPWUmJmVbM118fChuLmNzc051bWJlclthXT9cIlwiOlwicHhcIiksZz0obi5jc3NOdW1iZXJbYV18fFwicHhcIiE9PWYmJitkKSYmT2IuZXhlYyhuLmNzcyhjLmVsZW0sYSkpLGg9MSxpPTIwO2lmKGcmJmdbM10hPT1mKXtmPWZ8fGdbM10sZT1lfHxbXSxnPStkfHwxO2RvIGg9aHx8XCIuNVwiLGcvPWgsbi5zdHlsZShjLmVsZW0sYSxnK2YpO3doaWxlKGghPT0oaD1jLmN1cigpL2QpJiYxIT09aCYmLS1pKX1yZXR1cm4gZSYmKGc9Yy5zdGFydD0rZ3x8K2R8fDAsYy51bml0PWYsYy5lbmQ9ZVsxXT9nKyhlWzFdKzEpKmVbMl06K2VbMl0pLGN9XX07ZnVuY3Rpb24gU2IoKXtyZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpe0xiPXZvaWQgMH0pLExiPW4ubm93KCl9ZnVuY3Rpb24gVGIoYSxiKXt2YXIgYyxkPTAsZT17aGVpZ2h0OmF9O2ZvcihiPWI/MTowOzQ+ZDtkKz0yLWIpYz1SW2RdLGVbXCJtYXJnaW5cIitjXT1lW1wicGFkZGluZ1wiK2NdPWE7cmV0dXJuIGImJihlLm9wYWNpdHk9ZS53aWR0aD1hKSxlfWZ1bmN0aW9uIFViKGEsYixjKXtmb3IodmFyIGQsZT0oUmJbYl18fFtdKS5jb25jYXQoUmJbXCIqXCJdKSxmPTAsZz1lLmxlbmd0aDtnPmY7ZisrKWlmKGQ9ZVtmXS5jYWxsKGMsYixhKSlyZXR1cm4gZH1mdW5jdGlvbiBWYihhLGIsYyl7dmFyIGQsZSxmLGcsaCxpLGosayxsPXRoaXMsbT17fSxvPWEuc3R5bGUscD1hLm5vZGVUeXBlJiZTKGEpLHE9TC5nZXQoYSxcImZ4c2hvd1wiKTtjLnF1ZXVlfHwoaD1uLl9xdWV1ZUhvb2tzKGEsXCJmeFwiKSxudWxsPT1oLnVucXVldWVkJiYoaC51bnF1ZXVlZD0wLGk9aC5lbXB0eS5maXJlLGguZW1wdHkuZmlyZT1mdW5jdGlvbigpe2gudW5xdWV1ZWR8fGkoKX0pLGgudW5xdWV1ZWQrKyxsLmFsd2F5cyhmdW5jdGlvbigpe2wuYWx3YXlzKGZ1bmN0aW9uKCl7aC51bnF1ZXVlZC0tLG4ucXVldWUoYSxcImZ4XCIpLmxlbmd0aHx8aC5lbXB0eS5maXJlKCl9KX0pKSwxPT09YS5ub2RlVHlwZSYmKFwiaGVpZ2h0XCJpbiBifHxcIndpZHRoXCJpbiBiKSYmKGMub3ZlcmZsb3c9W28ub3ZlcmZsb3csby5vdmVyZmxvd1gsby5vdmVyZmxvd1ldLGo9bi5jc3MoYSxcImRpc3BsYXlcIiksaz1cIm5vbmVcIj09PWo/TC5nZXQoYSxcIm9sZGRpc3BsYXlcIil8fHRiKGEubm9kZU5hbWUpOmosXCJpbmxpbmVcIj09PWsmJlwibm9uZVwiPT09bi5jc3MoYSxcImZsb2F0XCIpJiYoby5kaXNwbGF5PVwiaW5saW5lLWJsb2NrXCIpKSxjLm92ZXJmbG93JiYoby5vdmVyZmxvdz1cImhpZGRlblwiLGwuYWx3YXlzKGZ1bmN0aW9uKCl7by5vdmVyZmxvdz1jLm92ZXJmbG93WzBdLG8ub3ZlcmZsb3dYPWMub3ZlcmZsb3dbMV0sby5vdmVyZmxvd1k9Yy5vdmVyZmxvd1syXX0pKTtmb3IoZCBpbiBiKWlmKGU9YltkXSxOYi5leGVjKGUpKXtpZihkZWxldGUgYltkXSxmPWZ8fFwidG9nZ2xlXCI9PT1lLGU9PT0ocD9cImhpZGVcIjpcInNob3dcIikpe2lmKFwic2hvd1wiIT09ZXx8IXF8fHZvaWQgMD09PXFbZF0pY29udGludWU7cD0hMH1tW2RdPXEmJnFbZF18fG4uc3R5bGUoYSxkKX1lbHNlIGo9dm9pZCAwO2lmKG4uaXNFbXB0eU9iamVjdChtKSlcImlubGluZVwiPT09KFwibm9uZVwiPT09aj90YihhLm5vZGVOYW1lKTpqKSYmKG8uZGlzcGxheT1qKTtlbHNle3E/XCJoaWRkZW5cImluIHEmJihwPXEuaGlkZGVuKTpxPUwuYWNjZXNzKGEsXCJmeHNob3dcIix7fSksZiYmKHEuaGlkZGVuPSFwKSxwP24oYSkuc2hvdygpOmwuZG9uZShmdW5jdGlvbigpe24oYSkuaGlkZSgpfSksbC5kb25lKGZ1bmN0aW9uKCl7dmFyIGI7TC5yZW1vdmUoYSxcImZ4c2hvd1wiKTtmb3IoYiBpbiBtKW4uc3R5bGUoYSxiLG1bYl0pfSk7Zm9yKGQgaW4gbSlnPVViKHA/cVtkXTowLGQsbCksZCBpbiBxfHwocVtkXT1nLnN0YXJ0LHAmJihnLmVuZD1nLnN0YXJ0LGcuc3RhcnQ9XCJ3aWR0aFwiPT09ZHx8XCJoZWlnaHRcIj09PWQ/MTowKSl9fWZ1bmN0aW9uIFdiKGEsYil7dmFyIGMsZCxlLGYsZztmb3IoYyBpbiBhKWlmKGQ9bi5jYW1lbENhc2UoYyksZT1iW2RdLGY9YVtjXSxuLmlzQXJyYXkoZikmJihlPWZbMV0sZj1hW2NdPWZbMF0pLGMhPT1kJiYoYVtkXT1mLGRlbGV0ZSBhW2NdKSxnPW4uY3NzSG9va3NbZF0sZyYmXCJleHBhbmRcImluIGcpe2Y9Zy5leHBhbmQoZiksZGVsZXRlIGFbZF07Zm9yKGMgaW4gZiljIGluIGF8fChhW2NdPWZbY10sYltjXT1lKX1lbHNlIGJbZF09ZX1mdW5jdGlvbiBYYihhLGIsYyl7dmFyIGQsZSxmPTAsZz1RYi5sZW5ndGgsaD1uLkRlZmVycmVkKCkuYWx3YXlzKGZ1bmN0aW9uKCl7ZGVsZXRlIGkuZWxlbX0pLGk9ZnVuY3Rpb24oKXtpZihlKXJldHVybiExO2Zvcih2YXIgYj1MYnx8U2IoKSxjPU1hdGgubWF4KDAsai5zdGFydFRpbWUrai5kdXJhdGlvbi1iKSxkPWMvai5kdXJhdGlvbnx8MCxmPTEtZCxnPTAsaT1qLnR3ZWVucy5sZW5ndGg7aT5nO2crKylqLnR3ZWVuc1tnXS5ydW4oZik7cmV0dXJuIGgubm90aWZ5V2l0aChhLFtqLGYsY10pLDE+ZiYmaT9jOihoLnJlc29sdmVXaXRoKGEsW2pdKSwhMSl9LGo9aC5wcm9taXNlKHtlbGVtOmEscHJvcHM6bi5leHRlbmQoe30sYiksb3B0czpuLmV4dGVuZCghMCx7c3BlY2lhbEVhc2luZzp7fX0sYyksb3JpZ2luYWxQcm9wZXJ0aWVzOmIsb3JpZ2luYWxPcHRpb25zOmMsc3RhcnRUaW1lOkxifHxTYigpLGR1cmF0aW9uOmMuZHVyYXRpb24sdHdlZW5zOltdLGNyZWF0ZVR3ZWVuOmZ1bmN0aW9uKGIsYyl7dmFyIGQ9bi5Ud2VlbihhLGoub3B0cyxiLGMsai5vcHRzLnNwZWNpYWxFYXNpbmdbYl18fGoub3B0cy5lYXNpbmcpO3JldHVybiBqLnR3ZWVucy5wdXNoKGQpLGR9LHN0b3A6ZnVuY3Rpb24oYil7dmFyIGM9MCxkPWI/ai50d2VlbnMubGVuZ3RoOjA7aWYoZSlyZXR1cm4gdGhpcztmb3IoZT0hMDtkPmM7YysrKWoudHdlZW5zW2NdLnJ1bigxKTtyZXR1cm4gYj9oLnJlc29sdmVXaXRoKGEsW2osYl0pOmgucmVqZWN0V2l0aChhLFtqLGJdKSx0aGlzfX0pLGs9ai5wcm9wcztmb3IoV2IoayxqLm9wdHMuc3BlY2lhbEVhc2luZyk7Zz5mO2YrKylpZihkPVFiW2ZdLmNhbGwoaixhLGssai5vcHRzKSlyZXR1cm4gZDtyZXR1cm4gbi5tYXAoayxVYixqKSxuLmlzRnVuY3Rpb24oai5vcHRzLnN0YXJ0KSYmai5vcHRzLnN0YXJ0LmNhbGwoYSxqKSxuLmZ4LnRpbWVyKG4uZXh0ZW5kKGkse2VsZW06YSxhbmltOmoscXVldWU6ai5vcHRzLnF1ZXVlfSkpLGoucHJvZ3Jlc3Moai5vcHRzLnByb2dyZXNzKS5kb25lKGoub3B0cy5kb25lLGoub3B0cy5jb21wbGV0ZSkuZmFpbChqLm9wdHMuZmFpbCkuYWx3YXlzKGoub3B0cy5hbHdheXMpfW4uQW5pbWF0aW9uPW4uZXh0ZW5kKFhiLHt0d2VlbmVyOmZ1bmN0aW9uKGEsYil7bi5pc0Z1bmN0aW9uKGEpPyhiPWEsYT1bXCIqXCJdKTphPWEuc3BsaXQoXCIgXCIpO2Zvcih2YXIgYyxkPTAsZT1hLmxlbmd0aDtlPmQ7ZCsrKWM9YVtkXSxSYltjXT1SYltjXXx8W10sUmJbY10udW5zaGlmdChiKX0scHJlZmlsdGVyOmZ1bmN0aW9uKGEsYil7Yj9RYi51bnNoaWZ0KGEpOlFiLnB1c2goYSl9fSksbi5zcGVlZD1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9YSYmXCJvYmplY3RcIj09dHlwZW9mIGE/bi5leHRlbmQoe30sYSk6e2NvbXBsZXRlOmN8fCFjJiZifHxuLmlzRnVuY3Rpb24oYSkmJmEsZHVyYXRpb246YSxlYXNpbmc6YyYmYnx8YiYmIW4uaXNGdW5jdGlvbihiKSYmYn07cmV0dXJuIGQuZHVyYXRpb249bi5meC5vZmY/MDpcIm51bWJlclwiPT10eXBlb2YgZC5kdXJhdGlvbj9kLmR1cmF0aW9uOmQuZHVyYXRpb24gaW4gbi5meC5zcGVlZHM/bi5meC5zcGVlZHNbZC5kdXJhdGlvbl06bi5meC5zcGVlZHMuX2RlZmF1bHQsKG51bGw9PWQucXVldWV8fGQucXVldWU9PT0hMCkmJihkLnF1ZXVlPVwiZnhcIiksZC5vbGQ9ZC5jb21wbGV0ZSxkLmNvbXBsZXRlPWZ1bmN0aW9uKCl7bi5pc0Z1bmN0aW9uKGQub2xkKSYmZC5vbGQuY2FsbCh0aGlzKSxkLnF1ZXVlJiZuLmRlcXVldWUodGhpcyxkLnF1ZXVlKX0sZH0sbi5mbi5leHRlbmQoe2ZhZGVUbzpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gdGhpcy5maWx0ZXIoUykuY3NzKFwib3BhY2l0eVwiLDApLnNob3coKS5lbmQoKS5hbmltYXRlKHtvcGFjaXR5OmJ9LGEsYyxkKX0sYW5pbWF0ZTpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT1uLmlzRW1wdHlPYmplY3QoYSksZj1uLnNwZWVkKGIsYyxkKSxnPWZ1bmN0aW9uKCl7dmFyIGI9WGIodGhpcyxuLmV4dGVuZCh7fSxhKSxmKTsoZXx8TC5nZXQodGhpcyxcImZpbmlzaFwiKSkmJmIuc3RvcCghMCl9O3JldHVybiBnLmZpbmlzaD1nLGV8fGYucXVldWU9PT0hMT90aGlzLmVhY2goZyk6dGhpcy5xdWV1ZShmLnF1ZXVlLGcpfSxzdG9wOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1mdW5jdGlvbihhKXt2YXIgYj1hLnN0b3A7ZGVsZXRlIGEuc3RvcCxiKGMpfTtyZXR1cm5cInN0cmluZ1wiIT10eXBlb2YgYSYmKGM9YixiPWEsYT12b2lkIDApLGImJmEhPT0hMSYmdGhpcy5xdWV1ZShhfHxcImZ4XCIsW10pLHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBiPSEwLGU9bnVsbCE9YSYmYStcInF1ZXVlSG9va3NcIixmPW4udGltZXJzLGc9TC5nZXQodGhpcyk7aWYoZSlnW2VdJiZnW2VdLnN0b3AmJmQoZ1tlXSk7ZWxzZSBmb3IoZSBpbiBnKWdbZV0mJmdbZV0uc3RvcCYmUGIudGVzdChlKSYmZChnW2VdKTtmb3IoZT1mLmxlbmd0aDtlLS07KWZbZV0uZWxlbSE9PXRoaXN8fG51bGwhPWEmJmZbZV0ucXVldWUhPT1hfHwoZltlXS5hbmltLnN0b3AoYyksYj0hMSxmLnNwbGljZShlLDEpKTsoYnx8IWMpJiZuLmRlcXVldWUodGhpcyxhKX0pfSxmaW5pc2g6ZnVuY3Rpb24oYSl7cmV0dXJuIGEhPT0hMSYmKGE9YXx8XCJmeFwiKSx0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgYixjPUwuZ2V0KHRoaXMpLGQ9Y1thK1wicXVldWVcIl0sZT1jW2ErXCJxdWV1ZUhvb2tzXCJdLGY9bi50aW1lcnMsZz1kP2QubGVuZ3RoOjA7Zm9yKGMuZmluaXNoPSEwLG4ucXVldWUodGhpcyxhLFtdKSxlJiZlLnN0b3AmJmUuc3RvcC5jYWxsKHRoaXMsITApLGI9Zi5sZW5ndGg7Yi0tOylmW2JdLmVsZW09PT10aGlzJiZmW2JdLnF1ZXVlPT09YSYmKGZbYl0uYW5pbS5zdG9wKCEwKSxmLnNwbGljZShiLDEpKTtmb3IoYj0wO2c+YjtiKyspZFtiXSYmZFtiXS5maW5pc2gmJmRbYl0uZmluaXNoLmNhbGwodGhpcyk7ZGVsZXRlIGMuZmluaXNofSl9fSksbi5lYWNoKFtcInRvZ2dsZVwiLFwic2hvd1wiLFwiaGlkZVwiXSxmdW5jdGlvbihhLGIpe3ZhciBjPW4uZm5bYl07bi5mbltiXT1mdW5jdGlvbihhLGQsZSl7cmV0dXJuIG51bGw9PWF8fFwiYm9vbGVhblwiPT10eXBlb2YgYT9jLmFwcGx5KHRoaXMsYXJndW1lbnRzKTp0aGlzLmFuaW1hdGUoVGIoYiwhMCksYSxkLGUpfX0pLG4uZWFjaCh7c2xpZGVEb3duOlRiKFwic2hvd1wiKSxzbGlkZVVwOlRiKFwiaGlkZVwiKSxzbGlkZVRvZ2dsZTpUYihcInRvZ2dsZVwiKSxmYWRlSW46e29wYWNpdHk6XCJzaG93XCJ9LGZhZGVPdXQ6e29wYWNpdHk6XCJoaWRlXCJ9LGZhZGVUb2dnbGU6e29wYWNpdHk6XCJ0b2dnbGVcIn19LGZ1bmN0aW9uKGEsYil7bi5mblthXT1mdW5jdGlvbihhLGMsZCl7cmV0dXJuIHRoaXMuYW5pbWF0ZShiLGEsYyxkKX19KSxuLnRpbWVycz1bXSxuLmZ4LnRpY2s9ZnVuY3Rpb24oKXt2YXIgYSxiPTAsYz1uLnRpbWVycztmb3IoTGI9bi5ub3coKTtiPGMubGVuZ3RoO2IrKylhPWNbYl0sYSgpfHxjW2JdIT09YXx8Yy5zcGxpY2UoYi0tLDEpO2MubGVuZ3RofHxuLmZ4LnN0b3AoKSxMYj12b2lkIDB9LG4uZngudGltZXI9ZnVuY3Rpb24oYSl7bi50aW1lcnMucHVzaChhKSxhKCk/bi5meC5zdGFydCgpOm4udGltZXJzLnBvcCgpfSxuLmZ4LmludGVydmFsPTEzLG4uZnguc3RhcnQ9ZnVuY3Rpb24oKXtNYnx8KE1iPXNldEludGVydmFsKG4uZngudGljayxuLmZ4LmludGVydmFsKSl9LG4uZnguc3RvcD1mdW5jdGlvbigpe2NsZWFySW50ZXJ2YWwoTWIpLE1iPW51bGx9LG4uZnguc3BlZWRzPXtzbG93OjYwMCxmYXN0OjIwMCxfZGVmYXVsdDo0MDB9LG4uZm4uZGVsYXk9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT1uLmZ4P24uZnguc3BlZWRzW2FdfHxhOmEsYj1ifHxcImZ4XCIsdGhpcy5xdWV1ZShiLGZ1bmN0aW9uKGIsYyl7dmFyIGQ9c2V0VGltZW91dChiLGEpO2Muc3RvcD1mdW5jdGlvbigpe2NsZWFyVGltZW91dChkKX19KX0sZnVuY3Rpb24oKXt2YXIgYT1sLmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKSxiPWwuY3JlYXRlRWxlbWVudChcInNlbGVjdFwiKSxjPWIuYXBwZW5kQ2hpbGQobC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIpKTthLnR5cGU9XCJjaGVja2JveFwiLGsuY2hlY2tPbj1cIlwiIT09YS52YWx1ZSxrLm9wdFNlbGVjdGVkPWMuc2VsZWN0ZWQsYi5kaXNhYmxlZD0hMCxrLm9wdERpc2FibGVkPSFjLmRpc2FibGVkLGE9bC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIiksYS52YWx1ZT1cInRcIixhLnR5cGU9XCJyYWRpb1wiLGsucmFkaW9WYWx1ZT1cInRcIj09PWEudmFsdWV9KCk7dmFyIFliLFpiLCRiPW4uZXhwci5hdHRySGFuZGxlO24uZm4uZXh0ZW5kKHthdHRyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIEoodGhpcyxuLmF0dHIsYSxiLGFyZ3VtZW50cy5sZW5ndGg+MSl9LHJlbW92ZUF0dHI6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe24ucmVtb3ZlQXR0cih0aGlzLGEpfSl9fSksbi5leHRlbmQoe2F0dHI6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZj1hLm5vZGVUeXBlO2lmKGEmJjMhPT1mJiY4IT09ZiYmMiE9PWYpcmV0dXJuIHR5cGVvZiBhLmdldEF0dHJpYnV0ZT09PVU/bi5wcm9wKGEsYixjKTooMT09PWYmJm4uaXNYTUxEb2MoYSl8fChiPWIudG9Mb3dlckNhc2UoKSxkPW4uYXR0ckhvb2tzW2JdfHwobi5leHByLm1hdGNoLmJvb2wudGVzdChiKT9aYjpZYikpLHZvaWQgMD09PWM/ZCYmXCJnZXRcImluIGQmJm51bGwhPT0oZT1kLmdldChhLGIpKT9lOihlPW4uZmluZC5hdHRyKGEsYiksbnVsbD09ZT92b2lkIDA6ZSk6bnVsbCE9PWM/ZCYmXCJzZXRcImluIGQmJnZvaWQgMCE9PShlPWQuc2V0KGEsYyxiKSk/ZTooYS5zZXRBdHRyaWJ1dGUoYixjK1wiXCIpLGMpOnZvaWQgbi5yZW1vdmVBdHRyKGEsYikpXHJcbn0scmVtb3ZlQXR0cjpmdW5jdGlvbihhLGIpe3ZhciBjLGQsZT0wLGY9YiYmYi5tYXRjaChFKTtpZihmJiYxPT09YS5ub2RlVHlwZSl3aGlsZShjPWZbZSsrXSlkPW4ucHJvcEZpeFtjXXx8YyxuLmV4cHIubWF0Y2guYm9vbC50ZXN0KGMpJiYoYVtkXT0hMSksYS5yZW1vdmVBdHRyaWJ1dGUoYyl9LGF0dHJIb29rczp7dHlwZTp7c2V0OmZ1bmN0aW9uKGEsYil7aWYoIWsucmFkaW9WYWx1ZSYmXCJyYWRpb1wiPT09YiYmbi5ub2RlTmFtZShhLFwiaW5wdXRcIikpe3ZhciBjPWEudmFsdWU7cmV0dXJuIGEuc2V0QXR0cmlidXRlKFwidHlwZVwiLGIpLGMmJihhLnZhbHVlPWMpLGJ9fX19fSksWmI9e3NldDpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIGI9PT0hMT9uLnJlbW92ZUF0dHIoYSxjKTphLnNldEF0dHJpYnV0ZShjLGMpLGN9fSxuLmVhY2gobi5leHByLm1hdGNoLmJvb2wuc291cmNlLm1hdGNoKC9cXHcrL2cpLGZ1bmN0aW9uKGEsYil7dmFyIGM9JGJbYl18fG4uZmluZC5hdHRyOyRiW2JdPWZ1bmN0aW9uKGEsYixkKXt2YXIgZSxmO3JldHVybiBkfHwoZj0kYltiXSwkYltiXT1lLGU9bnVsbCE9YyhhLGIsZCk/Yi50b0xvd2VyQ2FzZSgpOm51bGwsJGJbYl09ZiksZX19KTt2YXIgX2I9L14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8YnV0dG9uKSQvaTtuLmZuLmV4dGVuZCh7cHJvcDpmdW5jdGlvbihhLGIpe3JldHVybiBKKHRoaXMsbi5wcm9wLGEsYixhcmd1bWVudHMubGVuZ3RoPjEpfSxyZW1vdmVQcm9wOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtkZWxldGUgdGhpc1tuLnByb3BGaXhbYV18fGFdfSl9fSksbi5leHRlbmQoe3Byb3BGaXg6e1wiZm9yXCI6XCJodG1sRm9yXCIsXCJjbGFzc1wiOlwiY2xhc3NOYW1lXCJ9LHByb3A6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZixnPWEubm9kZVR5cGU7aWYoYSYmMyE9PWcmJjghPT1nJiYyIT09ZylyZXR1cm4gZj0xIT09Z3x8IW4uaXNYTUxEb2MoYSksZiYmKGI9bi5wcm9wRml4W2JdfHxiLGU9bi5wcm9wSG9va3NbYl0pLHZvaWQgMCE9PWM/ZSYmXCJzZXRcImluIGUmJnZvaWQgMCE9PShkPWUuc2V0KGEsYyxiKSk/ZDphW2JdPWM6ZSYmXCJnZXRcImluIGUmJm51bGwhPT0oZD1lLmdldChhLGIpKT9kOmFbYl19LHByb3BIb29rczp7dGFiSW5kZXg6e2dldDpmdW5jdGlvbihhKXtyZXR1cm4gYS5oYXNBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiKXx8X2IudGVzdChhLm5vZGVOYW1lKXx8YS5ocmVmP2EudGFiSW5kZXg6LTF9fX19KSxrLm9wdFNlbGVjdGVkfHwobi5wcm9wSG9va3Muc2VsZWN0ZWQ9e2dldDpmdW5jdGlvbihhKXt2YXIgYj1hLnBhcmVudE5vZGU7cmV0dXJuIGImJmIucGFyZW50Tm9kZSYmYi5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXgsbnVsbH19KSxuLmVhY2goW1widGFiSW5kZXhcIixcInJlYWRPbmx5XCIsXCJtYXhMZW5ndGhcIixcImNlbGxTcGFjaW5nXCIsXCJjZWxsUGFkZGluZ1wiLFwicm93U3BhblwiLFwiY29sU3BhblwiLFwidXNlTWFwXCIsXCJmcmFtZUJvcmRlclwiLFwiY29udGVudEVkaXRhYmxlXCJdLGZ1bmN0aW9uKCl7bi5wcm9wRml4W3RoaXMudG9Mb3dlckNhc2UoKV09dGhpc30pO3ZhciBhYz0vW1xcdFxcclxcblxcZl0vZztuLmZuLmV4dGVuZCh7YWRkQ2xhc3M6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGUsZixnLGg9XCJzdHJpbmdcIj09dHlwZW9mIGEmJmEsaT0wLGo9dGhpcy5sZW5ndGg7aWYobi5pc0Z1bmN0aW9uKGEpKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oYil7bih0aGlzKS5hZGRDbGFzcyhhLmNhbGwodGhpcyxiLHRoaXMuY2xhc3NOYW1lKSl9KTtpZihoKWZvcihiPShhfHxcIlwiKS5tYXRjaChFKXx8W107aj5pO2krKylpZihjPXRoaXNbaV0sZD0xPT09Yy5ub2RlVHlwZSYmKGMuY2xhc3NOYW1lPyhcIiBcIitjLmNsYXNzTmFtZStcIiBcIikucmVwbGFjZShhYyxcIiBcIik6XCIgXCIpKXtmPTA7d2hpbGUoZT1iW2YrK10pZC5pbmRleE9mKFwiIFwiK2UrXCIgXCIpPDAmJihkKz1lK1wiIFwiKTtnPW4udHJpbShkKSxjLmNsYXNzTmFtZSE9PWcmJihjLmNsYXNzTmFtZT1nKX1yZXR1cm4gdGhpc30scmVtb3ZlQ2xhc3M6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGUsZixnLGg9MD09PWFyZ3VtZW50cy5sZW5ndGh8fFwic3RyaW5nXCI9PXR5cGVvZiBhJiZhLGk9MCxqPXRoaXMubGVuZ3RoO2lmKG4uaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGIpe24odGhpcykucmVtb3ZlQ2xhc3MoYS5jYWxsKHRoaXMsYix0aGlzLmNsYXNzTmFtZSkpfSk7aWYoaClmb3IoYj0oYXx8XCJcIikubWF0Y2goRSl8fFtdO2o+aTtpKyspaWYoYz10aGlzW2ldLGQ9MT09PWMubm9kZVR5cGUmJihjLmNsYXNzTmFtZT8oXCIgXCIrYy5jbGFzc05hbWUrXCIgXCIpLnJlcGxhY2UoYWMsXCIgXCIpOlwiXCIpKXtmPTA7d2hpbGUoZT1iW2YrK10pd2hpbGUoZC5pbmRleE9mKFwiIFwiK2UrXCIgXCIpPj0wKWQ9ZC5yZXBsYWNlKFwiIFwiK2UrXCIgXCIsXCIgXCIpO2c9YT9uLnRyaW0oZCk6XCJcIixjLmNsYXNzTmFtZSE9PWcmJihjLmNsYXNzTmFtZT1nKX1yZXR1cm4gdGhpc30sdG9nZ2xlQ2xhc3M6ZnVuY3Rpb24oYSxiKXt2YXIgYz10eXBlb2YgYTtyZXR1cm5cImJvb2xlYW5cIj09dHlwZW9mIGImJlwic3RyaW5nXCI9PT1jP2I/dGhpcy5hZGRDbGFzcyhhKTp0aGlzLnJlbW92ZUNsYXNzKGEpOnRoaXMuZWFjaChuLmlzRnVuY3Rpb24oYSk/ZnVuY3Rpb24oYyl7bih0aGlzKS50b2dnbGVDbGFzcyhhLmNhbGwodGhpcyxjLHRoaXMuY2xhc3NOYW1lLGIpLGIpfTpmdW5jdGlvbigpe2lmKFwic3RyaW5nXCI9PT1jKXt2YXIgYixkPTAsZT1uKHRoaXMpLGY9YS5tYXRjaChFKXx8W107d2hpbGUoYj1mW2QrK10pZS5oYXNDbGFzcyhiKT9lLnJlbW92ZUNsYXNzKGIpOmUuYWRkQ2xhc3MoYil9ZWxzZShjPT09VXx8XCJib29sZWFuXCI9PT1jKSYmKHRoaXMuY2xhc3NOYW1lJiZMLnNldCh0aGlzLFwiX19jbGFzc05hbWVfX1wiLHRoaXMuY2xhc3NOYW1lKSx0aGlzLmNsYXNzTmFtZT10aGlzLmNsYXNzTmFtZXx8YT09PSExP1wiXCI6TC5nZXQodGhpcyxcIl9fY2xhc3NOYW1lX19cIil8fFwiXCIpfSl9LGhhc0NsYXNzOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1cIiBcIithK1wiIFwiLGM9MCxkPXRoaXMubGVuZ3RoO2Q+YztjKyspaWYoMT09PXRoaXNbY10ubm9kZVR5cGUmJihcIiBcIit0aGlzW2NdLmNsYXNzTmFtZStcIiBcIikucmVwbGFjZShhYyxcIiBcIikuaW5kZXhPZihiKT49MClyZXR1cm4hMDtyZXR1cm4hMX19KTt2YXIgYmM9L1xcci9nO24uZm4uZXh0ZW5kKHt2YWw6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGU9dGhpc1swXTt7aWYoYXJndW1lbnRzLmxlbmd0aClyZXR1cm4gZD1uLmlzRnVuY3Rpb24oYSksdGhpcy5lYWNoKGZ1bmN0aW9uKGMpe3ZhciBlOzE9PT10aGlzLm5vZGVUeXBlJiYoZT1kP2EuY2FsbCh0aGlzLGMsbih0aGlzKS52YWwoKSk6YSxudWxsPT1lP2U9XCJcIjpcIm51bWJlclwiPT10eXBlb2YgZT9lKz1cIlwiOm4uaXNBcnJheShlKSYmKGU9bi5tYXAoZSxmdW5jdGlvbihhKXtyZXR1cm4gbnVsbD09YT9cIlwiOmErXCJcIn0pKSxiPW4udmFsSG9va3NbdGhpcy50eXBlXXx8bi52YWxIb29rc1t0aGlzLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldLGImJlwic2V0XCJpbiBiJiZ2b2lkIDAhPT1iLnNldCh0aGlzLGUsXCJ2YWx1ZVwiKXx8KHRoaXMudmFsdWU9ZSkpfSk7aWYoZSlyZXR1cm4gYj1uLnZhbEhvb2tzW2UudHlwZV18fG4udmFsSG9va3NbZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXSxiJiZcImdldFwiaW4gYiYmdm9pZCAwIT09KGM9Yi5nZXQoZSxcInZhbHVlXCIpKT9jOihjPWUudmFsdWUsXCJzdHJpbmdcIj09dHlwZW9mIGM/Yy5yZXBsYWNlKGJjLFwiXCIpOm51bGw9PWM/XCJcIjpjKX19fSksbi5leHRlbmQoe3ZhbEhvb2tzOntvcHRpb246e2dldDpmdW5jdGlvbihhKXt2YXIgYj1uLmZpbmQuYXR0cihhLFwidmFsdWVcIik7cmV0dXJuIG51bGwhPWI/YjpuLnRyaW0obi50ZXh0KGEpKX19LHNlbGVjdDp7Z2V0OmZ1bmN0aW9uKGEpe2Zvcih2YXIgYixjLGQ9YS5vcHRpb25zLGU9YS5zZWxlY3RlZEluZGV4LGY9XCJzZWxlY3Qtb25lXCI9PT1hLnR5cGV8fDA+ZSxnPWY/bnVsbDpbXSxoPWY/ZSsxOmQubGVuZ3RoLGk9MD5lP2g6Zj9lOjA7aD5pO2krKylpZihjPWRbaV0sISghYy5zZWxlY3RlZCYmaSE9PWV8fChrLm9wdERpc2FibGVkP2MuZGlzYWJsZWQ6bnVsbCE9PWMuZ2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIikpfHxjLnBhcmVudE5vZGUuZGlzYWJsZWQmJm4ubm9kZU5hbWUoYy5wYXJlbnROb2RlLFwib3B0Z3JvdXBcIikpKXtpZihiPW4oYykudmFsKCksZilyZXR1cm4gYjtnLnB1c2goYil9cmV0dXJuIGd9LHNldDpmdW5jdGlvbihhLGIpe3ZhciBjLGQsZT1hLm9wdGlvbnMsZj1uLm1ha2VBcnJheShiKSxnPWUubGVuZ3RoO3doaWxlKGctLSlkPWVbZ10sKGQuc2VsZWN0ZWQ9bi5pbkFycmF5KGQudmFsdWUsZik+PTApJiYoYz0hMCk7cmV0dXJuIGN8fChhLnNlbGVjdGVkSW5kZXg9LTEpLGZ9fX19KSxuLmVhY2goW1wicmFkaW9cIixcImNoZWNrYm94XCJdLGZ1bmN0aW9uKCl7bi52YWxIb29rc1t0aGlzXT17c2V0OmZ1bmN0aW9uKGEsYil7cmV0dXJuIG4uaXNBcnJheShiKT9hLmNoZWNrZWQ9bi5pbkFycmF5KG4oYSkudmFsKCksYik+PTA6dm9pZCAwfX0say5jaGVja09ufHwobi52YWxIb29rc1t0aGlzXS5nZXQ9ZnVuY3Rpb24oYSl7cmV0dXJuIG51bGw9PT1hLmdldEF0dHJpYnV0ZShcInZhbHVlXCIpP1wib25cIjphLnZhbHVlfSl9KSxuLmVhY2goXCJibHVyIGZvY3VzIGZvY3VzaW4gZm9jdXNvdXQgbG9hZCByZXNpemUgc2Nyb2xsIHVubG9hZCBjbGljayBkYmxjbGljayBtb3VzZWRvd24gbW91c2V1cCBtb3VzZW1vdmUgbW91c2VvdmVyIG1vdXNlb3V0IG1vdXNlZW50ZXIgbW91c2VsZWF2ZSBjaGFuZ2Ugc2VsZWN0IHN1Ym1pdCBrZXlkb3duIGtleXByZXNzIGtleXVwIGVycm9yIGNvbnRleHRtZW51XCIuc3BsaXQoXCIgXCIpLGZ1bmN0aW9uKGEsYil7bi5mbltiXT1mdW5jdGlvbihhLGMpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPjA/dGhpcy5vbihiLG51bGwsYSxjKTp0aGlzLnRyaWdnZXIoYil9fSksbi5mbi5leHRlbmQoe2hvdmVyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMubW91c2VlbnRlcihhKS5tb3VzZWxlYXZlKGJ8fGEpfSxiaW5kOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdGhpcy5vbihhLG51bGwsYixjKX0sdW5iaW5kOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMub2ZmKGEsbnVsbCxiKX0sZGVsZWdhdGU6ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIHRoaXMub24oYixhLGMsZCl9LHVuZGVsZWdhdGU6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiAxPT09YXJndW1lbnRzLmxlbmd0aD90aGlzLm9mZihhLFwiKipcIik6dGhpcy5vZmYoYixhfHxcIioqXCIsYyl9fSk7dmFyIGNjPW4ubm93KCksZGM9L1xcPy87bi5wYXJzZUpTT049ZnVuY3Rpb24oYSl7cmV0dXJuIEpTT04ucGFyc2UoYStcIlwiKX0sbi5wYXJzZVhNTD1mdW5jdGlvbihhKXt2YXIgYixjO2lmKCFhfHxcInN0cmluZ1wiIT10eXBlb2YgYSlyZXR1cm4gbnVsbDt0cnl7Yz1uZXcgRE9NUGFyc2VyLGI9Yy5wYXJzZUZyb21TdHJpbmcoYSxcInRleHQveG1sXCIpfWNhdGNoKGQpe2I9dm9pZCAwfXJldHVybighYnx8Yi5nZXRFbGVtZW50c0J5VGFnTmFtZShcInBhcnNlcmVycm9yXCIpLmxlbmd0aCkmJm4uZXJyb3IoXCJJbnZhbGlkIFhNTDogXCIrYSksYn07dmFyIGVjPS8jLiokLyxmYz0vKFs/Jl0pXz1bXiZdKi8sZ2M9L14oLio/KTpbIFxcdF0qKFteXFxyXFxuXSopJC9nbSxoYz0vXig/OmFib3V0fGFwcHxhcHAtc3RvcmFnZXwuKy1leHRlbnNpb258ZmlsZXxyZXN8d2lkZ2V0KTokLyxpYz0vXig/OkdFVHxIRUFEKSQvLGpjPS9eXFwvXFwvLyxrYz0vXihbXFx3ListXSs6KSg/OlxcL1xcLyg/OlteXFwvPyNdKkB8KShbXlxcLz8jOl0qKSg/OjooXFxkKyl8KXwpLyxsYz17fSxtYz17fSxuYz1cIiovXCIuY29uY2F0KFwiKlwiKSxvYz1hLmxvY2F0aW9uLmhyZWYscGM9a2MuZXhlYyhvYy50b0xvd2VyQ2FzZSgpKXx8W107ZnVuY3Rpb24gcWMoYSl7cmV0dXJuIGZ1bmN0aW9uKGIsYyl7XCJzdHJpbmdcIiE9dHlwZW9mIGImJihjPWIsYj1cIipcIik7dmFyIGQsZT0wLGY9Yi50b0xvd2VyQ2FzZSgpLm1hdGNoKEUpfHxbXTtpZihuLmlzRnVuY3Rpb24oYykpd2hpbGUoZD1mW2UrK10pXCIrXCI9PT1kWzBdPyhkPWQuc2xpY2UoMSl8fFwiKlwiLChhW2RdPWFbZF18fFtdKS51bnNoaWZ0KGMpKTooYVtkXT1hW2RdfHxbXSkucHVzaChjKX19ZnVuY3Rpb24gcmMoYSxiLGMsZCl7dmFyIGU9e30sZj1hPT09bWM7ZnVuY3Rpb24gZyhoKXt2YXIgaTtyZXR1cm4gZVtoXT0hMCxuLmVhY2goYVtoXXx8W10sZnVuY3Rpb24oYSxoKXt2YXIgaj1oKGIsYyxkKTtyZXR1cm5cInN0cmluZ1wiIT10eXBlb2Yganx8Znx8ZVtqXT9mPyEoaT1qKTp2b2lkIDA6KGIuZGF0YVR5cGVzLnVuc2hpZnQoaiksZyhqKSwhMSl9KSxpfXJldHVybiBnKGIuZGF0YVR5cGVzWzBdKXx8IWVbXCIqXCJdJiZnKFwiKlwiKX1mdW5jdGlvbiBzYyhhLGIpe3ZhciBjLGQsZT1uLmFqYXhTZXR0aW5ncy5mbGF0T3B0aW9uc3x8e307Zm9yKGMgaW4gYil2b2lkIDAhPT1iW2NdJiYoKGVbY10/YTpkfHwoZD17fSkpW2NdPWJbY10pO3JldHVybiBkJiZuLmV4dGVuZCghMCxhLGQpLGF9ZnVuY3Rpb24gdGMoYSxiLGMpe3ZhciBkLGUsZixnLGg9YS5jb250ZW50cyxpPWEuZGF0YVR5cGVzO3doaWxlKFwiKlwiPT09aVswXSlpLnNoaWZ0KCksdm9pZCAwPT09ZCYmKGQ9YS5taW1lVHlwZXx8Yi5nZXRSZXNwb25zZUhlYWRlcihcIkNvbnRlbnQtVHlwZVwiKSk7aWYoZClmb3IoZSBpbiBoKWlmKGhbZV0mJmhbZV0udGVzdChkKSl7aS51bnNoaWZ0KGUpO2JyZWFrfWlmKGlbMF1pbiBjKWY9aVswXTtlbHNle2ZvcihlIGluIGMpe2lmKCFpWzBdfHxhLmNvbnZlcnRlcnNbZStcIiBcIitpWzBdXSl7Zj1lO2JyZWFrfWd8fChnPWUpfWY9Znx8Z31yZXR1cm4gZj8oZiE9PWlbMF0mJmkudW5zaGlmdChmKSxjW2ZdKTp2b2lkIDB9ZnVuY3Rpb24gdWMoYSxiLGMsZCl7dmFyIGUsZixnLGgsaSxqPXt9LGs9YS5kYXRhVHlwZXMuc2xpY2UoKTtpZihrWzFdKWZvcihnIGluIGEuY29udmVydGVycylqW2cudG9Mb3dlckNhc2UoKV09YS5jb252ZXJ0ZXJzW2ddO2Y9ay5zaGlmdCgpO3doaWxlKGYpaWYoYS5yZXNwb25zZUZpZWxkc1tmXSYmKGNbYS5yZXNwb25zZUZpZWxkc1tmXV09YiksIWkmJmQmJmEuZGF0YUZpbHRlciYmKGI9YS5kYXRhRmlsdGVyKGIsYS5kYXRhVHlwZSkpLGk9ZixmPWsuc2hpZnQoKSlpZihcIipcIj09PWYpZj1pO2Vsc2UgaWYoXCIqXCIhPT1pJiZpIT09Zil7aWYoZz1qW2krXCIgXCIrZl18fGpbXCIqIFwiK2ZdLCFnKWZvcihlIGluIGopaWYoaD1lLnNwbGl0KFwiIFwiKSxoWzFdPT09ZiYmKGc9altpK1wiIFwiK2hbMF1dfHxqW1wiKiBcIitoWzBdXSkpe2c9PT0hMD9nPWpbZV06altlXSE9PSEwJiYoZj1oWzBdLGsudW5zaGlmdChoWzFdKSk7YnJlYWt9aWYoZyE9PSEwKWlmKGcmJmFbXCJ0aHJvd3NcIl0pYj1nKGIpO2Vsc2UgdHJ5e2I9ZyhiKX1jYXRjaChsKXtyZXR1cm57c3RhdGU6XCJwYXJzZXJlcnJvclwiLGVycm9yOmc/bDpcIk5vIGNvbnZlcnNpb24gZnJvbSBcIitpK1wiIHRvIFwiK2Z9fX1yZXR1cm57c3RhdGU6XCJzdWNjZXNzXCIsZGF0YTpifX1uLmV4dGVuZCh7YWN0aXZlOjAsbGFzdE1vZGlmaWVkOnt9LGV0YWc6e30sYWpheFNldHRpbmdzOnt1cmw6b2MsdHlwZTpcIkdFVFwiLGlzTG9jYWw6aGMudGVzdChwY1sxXSksZ2xvYmFsOiEwLHByb2Nlc3NEYXRhOiEwLGFzeW5jOiEwLGNvbnRlbnRUeXBlOlwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04XCIsYWNjZXB0czp7XCIqXCI6bmMsdGV4dDpcInRleHQvcGxhaW5cIixodG1sOlwidGV4dC9odG1sXCIseG1sOlwiYXBwbGljYXRpb24veG1sLCB0ZXh0L3htbFwiLGpzb246XCJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L2phdmFzY3JpcHRcIn0sY29udGVudHM6e3htbDoveG1sLyxodG1sOi9odG1sLyxqc29uOi9qc29uL30scmVzcG9uc2VGaWVsZHM6e3htbDpcInJlc3BvbnNlWE1MXCIsdGV4dDpcInJlc3BvbnNlVGV4dFwiLGpzb246XCJyZXNwb25zZUpTT05cIn0sY29udmVydGVyczp7XCIqIHRleHRcIjpTdHJpbmcsXCJ0ZXh0IGh0bWxcIjohMCxcInRleHQganNvblwiOm4ucGFyc2VKU09OLFwidGV4dCB4bWxcIjpuLnBhcnNlWE1MfSxmbGF0T3B0aW9uczp7dXJsOiEwLGNvbnRleHQ6ITB9fSxhamF4U2V0dXA6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYj9zYyhzYyhhLG4uYWpheFNldHRpbmdzKSxiKTpzYyhuLmFqYXhTZXR0aW5ncyxhKX0sYWpheFByZWZpbHRlcjpxYyhsYyksYWpheFRyYW5zcG9ydDpxYyhtYyksYWpheDpmdW5jdGlvbihhLGIpe1wib2JqZWN0XCI9PXR5cGVvZiBhJiYoYj1hLGE9dm9pZCAwKSxiPWJ8fHt9O3ZhciBjLGQsZSxmLGcsaCxpLGosaz1uLmFqYXhTZXR1cCh7fSxiKSxsPWsuY29udGV4dHx8ayxtPWsuY29udGV4dCYmKGwubm9kZVR5cGV8fGwuanF1ZXJ5KT9uKGwpOm4uZXZlbnQsbz1uLkRlZmVycmVkKCkscD1uLkNhbGxiYWNrcyhcIm9uY2UgbWVtb3J5XCIpLHE9ay5zdGF0dXNDb2RlfHx7fSxyPXt9LHM9e30sdD0wLHU9XCJjYW5jZWxlZFwiLHY9e3JlYWR5U3RhdGU6MCxnZXRSZXNwb25zZUhlYWRlcjpmdW5jdGlvbihhKXt2YXIgYjtpZigyPT09dCl7aWYoIWYpe2Y9e307d2hpbGUoYj1nYy5leGVjKGUpKWZbYlsxXS50b0xvd2VyQ2FzZSgpXT1iWzJdfWI9ZlthLnRvTG93ZXJDYXNlKCldfXJldHVybiBudWxsPT1iP251bGw6Yn0sZ2V0QWxsUmVzcG9uc2VIZWFkZXJzOmZ1bmN0aW9uKCl7cmV0dXJuIDI9PT10P2U6bnVsbH0sc2V0UmVxdWVzdEhlYWRlcjpmdW5jdGlvbihhLGIpe3ZhciBjPWEudG9Mb3dlckNhc2UoKTtyZXR1cm4gdHx8KGE9c1tjXT1zW2NdfHxhLHJbYV09YiksdGhpc30sb3ZlcnJpZGVNaW1lVHlwZTpmdW5jdGlvbihhKXtyZXR1cm4gdHx8KGsubWltZVR5cGU9YSksdGhpc30sc3RhdHVzQ29kZTpmdW5jdGlvbihhKXt2YXIgYjtpZihhKWlmKDI+dClmb3IoYiBpbiBhKXFbYl09W3FbYl0sYVtiXV07ZWxzZSB2LmFsd2F5cyhhW3Yuc3RhdHVzXSk7cmV0dXJuIHRoaXN9LGFib3J0OmZ1bmN0aW9uKGEpe3ZhciBiPWF8fHU7cmV0dXJuIGMmJmMuYWJvcnQoYikseCgwLGIpLHRoaXN9fTtpZihvLnByb21pc2UodikuY29tcGxldGU9cC5hZGQsdi5zdWNjZXNzPXYuZG9uZSx2LmVycm9yPXYuZmFpbCxrLnVybD0oKGF8fGsudXJsfHxvYykrXCJcIikucmVwbGFjZShlYyxcIlwiKS5yZXBsYWNlKGpjLHBjWzFdK1wiLy9cIiksay50eXBlPWIubWV0aG9kfHxiLnR5cGV8fGsubWV0aG9kfHxrLnR5cGUsay5kYXRhVHlwZXM9bi50cmltKGsuZGF0YVR5cGV8fFwiKlwiKS50b0xvd2VyQ2FzZSgpLm1hdGNoKEUpfHxbXCJcIl0sbnVsbD09ay5jcm9zc0RvbWFpbiYmKGg9a2MuZXhlYyhrLnVybC50b0xvd2VyQ2FzZSgpKSxrLmNyb3NzRG9tYWluPSEoIWh8fGhbMV09PT1wY1sxXSYmaFsyXT09PXBjWzJdJiYoaFszXXx8KFwiaHR0cDpcIj09PWhbMV0/XCI4MFwiOlwiNDQzXCIpKT09PShwY1szXXx8KFwiaHR0cDpcIj09PXBjWzFdP1wiODBcIjpcIjQ0M1wiKSkpKSxrLmRhdGEmJmsucHJvY2Vzc0RhdGEmJlwic3RyaW5nXCIhPXR5cGVvZiBrLmRhdGEmJihrLmRhdGE9bi5wYXJhbShrLmRhdGEsay50cmFkaXRpb25hbCkpLHJjKGxjLGssYix2KSwyPT09dClyZXR1cm4gdjtpPW4uZXZlbnQmJmsuZ2xvYmFsLGkmJjA9PT1uLmFjdGl2ZSsrJiZuLmV2ZW50LnRyaWdnZXIoXCJhamF4U3RhcnRcIiksay50eXBlPWsudHlwZS50b1VwcGVyQ2FzZSgpLGsuaGFzQ29udGVudD0haWMudGVzdChrLnR5cGUpLGQ9ay51cmwsay5oYXNDb250ZW50fHwoay5kYXRhJiYoZD1rLnVybCs9KGRjLnRlc3QoZCk/XCImXCI6XCI/XCIpK2suZGF0YSxkZWxldGUgay5kYXRhKSxrLmNhY2hlPT09ITEmJihrLnVybD1mYy50ZXN0KGQpP2QucmVwbGFjZShmYyxcIiQxXz1cIitjYysrKTpkKyhkYy50ZXN0KGQpP1wiJlwiOlwiP1wiKStcIl89XCIrY2MrKykpLGsuaWZNb2RpZmllZCYmKG4ubGFzdE1vZGlmaWVkW2RdJiZ2LnNldFJlcXVlc3RIZWFkZXIoXCJJZi1Nb2RpZmllZC1TaW5jZVwiLG4ubGFzdE1vZGlmaWVkW2RdKSxuLmV0YWdbZF0mJnYuc2V0UmVxdWVzdEhlYWRlcihcIklmLU5vbmUtTWF0Y2hcIixuLmV0YWdbZF0pKSwoay5kYXRhJiZrLmhhc0NvbnRlbnQmJmsuY29udGVudFR5cGUhPT0hMXx8Yi5jb250ZW50VHlwZSkmJnYuc2V0UmVxdWVzdEhlYWRlcihcIkNvbnRlbnQtVHlwZVwiLGsuY29udGVudFR5cGUpLHYuc2V0UmVxdWVzdEhlYWRlcihcIkFjY2VwdFwiLGsuZGF0YVR5cGVzWzBdJiZrLmFjY2VwdHNbay5kYXRhVHlwZXNbMF1dP2suYWNjZXB0c1trLmRhdGFUeXBlc1swXV0rKFwiKlwiIT09ay5kYXRhVHlwZXNbMF0/XCIsIFwiK25jK1wiOyBxPTAuMDFcIjpcIlwiKTprLmFjY2VwdHNbXCIqXCJdKTtmb3IoaiBpbiBrLmhlYWRlcnMpdi5zZXRSZXF1ZXN0SGVhZGVyKGosay5oZWFkZXJzW2pdKTtpZihrLmJlZm9yZVNlbmQmJihrLmJlZm9yZVNlbmQuY2FsbChsLHYsayk9PT0hMXx8Mj09PXQpKXJldHVybiB2LmFib3J0KCk7dT1cImFib3J0XCI7Zm9yKGogaW57c3VjY2VzczoxLGVycm9yOjEsY29tcGxldGU6MX0pdltqXShrW2pdKTtpZihjPXJjKG1jLGssYix2KSl7di5yZWFkeVN0YXRlPTEsaSYmbS50cmlnZ2VyKFwiYWpheFNlbmRcIixbdixrXSksay5hc3luYyYmay50aW1lb3V0PjAmJihnPXNldFRpbWVvdXQoZnVuY3Rpb24oKXt2LmFib3J0KFwidGltZW91dFwiKX0say50aW1lb3V0KSk7dHJ5e3Q9MSxjLnNlbmQocix4KX1jYXRjaCh3KXtpZighKDI+dCkpdGhyb3cgdzt4KC0xLHcpfX1lbHNlIHgoLTEsXCJObyBUcmFuc3BvcnRcIik7ZnVuY3Rpb24geChhLGIsZixoKXt2YXIgaixyLHMsdSx3LHg9YjsyIT09dCYmKHQ9MixnJiZjbGVhclRpbWVvdXQoZyksYz12b2lkIDAsZT1ofHxcIlwiLHYucmVhZHlTdGF0ZT1hPjA/NDowLGo9YT49MjAwJiYzMDA+YXx8MzA0PT09YSxmJiYodT10YyhrLHYsZikpLHU9dWMoayx1LHYsaiksaj8oay5pZk1vZGlmaWVkJiYodz12LmdldFJlc3BvbnNlSGVhZGVyKFwiTGFzdC1Nb2RpZmllZFwiKSx3JiYobi5sYXN0TW9kaWZpZWRbZF09dyksdz12LmdldFJlc3BvbnNlSGVhZGVyKFwiZXRhZ1wiKSx3JiYobi5ldGFnW2RdPXcpKSwyMDQ9PT1hfHxcIkhFQURcIj09PWsudHlwZT94PVwibm9jb250ZW50XCI6MzA0PT09YT94PVwibm90bW9kaWZpZWRcIjooeD11LnN0YXRlLHI9dS5kYXRhLHM9dS5lcnJvcixqPSFzKSk6KHM9eCwoYXx8IXgpJiYoeD1cImVycm9yXCIsMD5hJiYoYT0wKSkpLHYuc3RhdHVzPWEsdi5zdGF0dXNUZXh0PShifHx4KStcIlwiLGo/by5yZXNvbHZlV2l0aChsLFtyLHgsdl0pOm8ucmVqZWN0V2l0aChsLFt2LHgsc10pLHYuc3RhdHVzQ29kZShxKSxxPXZvaWQgMCxpJiZtLnRyaWdnZXIoaj9cImFqYXhTdWNjZXNzXCI6XCJhamF4RXJyb3JcIixbdixrLGo/cjpzXSkscC5maXJlV2l0aChsLFt2LHhdKSxpJiYobS50cmlnZ2VyKFwiYWpheENvbXBsZXRlXCIsW3Ysa10pLC0tbi5hY3RpdmV8fG4uZXZlbnQudHJpZ2dlcihcImFqYXhTdG9wXCIpKSl9cmV0dXJuIHZ9LGdldEpTT046ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuLmdldChhLGIsYyxcImpzb25cIil9LGdldFNjcmlwdDpmdW5jdGlvbihhLGIpe3JldHVybiBuLmdldChhLHZvaWQgMCxiLFwic2NyaXB0XCIpfX0pLG4uZWFjaChbXCJnZXRcIixcInBvc3RcIl0sZnVuY3Rpb24oYSxiKXtuW2JdPWZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBuLmlzRnVuY3Rpb24oYykmJihlPWV8fGQsZD1jLGM9dm9pZCAwKSxuLmFqYXgoe3VybDphLHR5cGU6YixkYXRhVHlwZTplLGRhdGE6YyxzdWNjZXNzOmR9KX19KSxuLl9ldmFsVXJsPWZ1bmN0aW9uKGEpe3JldHVybiBuLmFqYXgoe3VybDphLHR5cGU6XCJHRVRcIixkYXRhVHlwZTpcInNjcmlwdFwiLGFzeW5jOiExLGdsb2JhbDohMSxcInRocm93c1wiOiEwfSl9LG4uZm4uZXh0ZW5kKHt3cmFwQWxsOmZ1bmN0aW9uKGEpe3ZhciBiO3JldHVybiBuLmlzRnVuY3Rpb24oYSk/dGhpcy5lYWNoKGZ1bmN0aW9uKGIpe24odGhpcykud3JhcEFsbChhLmNhbGwodGhpcyxiKSl9KToodGhpc1swXSYmKGI9bihhLHRoaXNbMF0ub3duZXJEb2N1bWVudCkuZXEoMCkuY2xvbmUoITApLHRoaXNbMF0ucGFyZW50Tm9kZSYmYi5pbnNlcnRCZWZvcmUodGhpc1swXSksYi5tYXAoZnVuY3Rpb24oKXt2YXIgYT10aGlzO3doaWxlKGEuZmlyc3RFbGVtZW50Q2hpbGQpYT1hLmZpcnN0RWxlbWVudENoaWxkO3JldHVybiBhfSkuYXBwZW5kKHRoaXMpKSx0aGlzKX0sd3JhcElubmVyOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmVhY2gobi5pc0Z1bmN0aW9uKGEpP2Z1bmN0aW9uKGIpe24odGhpcykud3JhcElubmVyKGEuY2FsbCh0aGlzLGIpKX06ZnVuY3Rpb24oKXt2YXIgYj1uKHRoaXMpLGM9Yi5jb250ZW50cygpO2MubGVuZ3RoP2Mud3JhcEFsbChhKTpiLmFwcGVuZChhKX0pfSx3cmFwOmZ1bmN0aW9uKGEpe3ZhciBiPW4uaXNGdW5jdGlvbihhKTtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGMpe24odGhpcykud3JhcEFsbChiP2EuY2FsbCh0aGlzLGMpOmEpfSl9LHVud3JhcDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnBhcmVudCgpLmVhY2goZnVuY3Rpb24oKXtuLm5vZGVOYW1lKHRoaXMsXCJib2R5XCIpfHxuKHRoaXMpLnJlcGxhY2VXaXRoKHRoaXMuY2hpbGROb2Rlcyl9KS5lbmQoKX19KSxuLmV4cHIuZmlsdGVycy5oaWRkZW49ZnVuY3Rpb24oYSl7cmV0dXJuIGEub2Zmc2V0V2lkdGg8PTAmJmEub2Zmc2V0SGVpZ2h0PD0wfSxuLmV4cHIuZmlsdGVycy52aXNpYmxlPWZ1bmN0aW9uKGEpe3JldHVybiFuLmV4cHIuZmlsdGVycy5oaWRkZW4oYSl9O3ZhciB2Yz0vJTIwL2csd2M9L1xcW1xcXSQvLHhjPS9cXHI/XFxuL2cseWM9L14oPzpzdWJtaXR8YnV0dG9ufGltYWdlfHJlc2V0fGZpbGUpJC9pLHpjPS9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGtleWdlbikvaTtmdW5jdGlvbiBBYyhhLGIsYyxkKXt2YXIgZTtpZihuLmlzQXJyYXkoYikpbi5lYWNoKGIsZnVuY3Rpb24oYixlKXtjfHx3Yy50ZXN0KGEpP2QoYSxlKTpBYyhhK1wiW1wiKyhcIm9iamVjdFwiPT10eXBlb2YgZT9iOlwiXCIpK1wiXVwiLGUsYyxkKX0pO2Vsc2UgaWYoY3x8XCJvYmplY3RcIiE9PW4udHlwZShiKSlkKGEsYik7ZWxzZSBmb3IoZSBpbiBiKUFjKGErXCJbXCIrZStcIl1cIixiW2VdLGMsZCl9bi5wYXJhbT1mdW5jdGlvbihhLGIpe3ZhciBjLGQ9W10sZT1mdW5jdGlvbihhLGIpe2I9bi5pc0Z1bmN0aW9uKGIpP2IoKTpudWxsPT1iP1wiXCI6YixkW2QubGVuZ3RoXT1lbmNvZGVVUklDb21wb25lbnQoYSkrXCI9XCIrZW5jb2RlVVJJQ29tcG9uZW50KGIpfTtpZih2b2lkIDA9PT1iJiYoYj1uLmFqYXhTZXR0aW5ncyYmbi5hamF4U2V0dGluZ3MudHJhZGl0aW9uYWwpLG4uaXNBcnJheShhKXx8YS5qcXVlcnkmJiFuLmlzUGxhaW5PYmplY3QoYSkpbi5lYWNoKGEsZnVuY3Rpb24oKXtlKHRoaXMubmFtZSx0aGlzLnZhbHVlKX0pO2Vsc2UgZm9yKGMgaW4gYSlBYyhjLGFbY10sYixlKTtyZXR1cm4gZC5qb2luKFwiJlwiKS5yZXBsYWNlKHZjLFwiK1wiKX0sbi5mbi5leHRlbmQoe3NlcmlhbGl6ZTpmdW5jdGlvbigpe3JldHVybiBuLnBhcmFtKHRoaXMuc2VyaWFsaXplQXJyYXkoKSl9LHNlcmlhbGl6ZUFycmF5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCl7dmFyIGE9bi5wcm9wKHRoaXMsXCJlbGVtZW50c1wiKTtyZXR1cm4gYT9uLm1ha2VBcnJheShhKTp0aGlzfSkuZmlsdGVyKGZ1bmN0aW9uKCl7dmFyIGE9dGhpcy50eXBlO3JldHVybiB0aGlzLm5hbWUmJiFuKHRoaXMpLmlzKFwiOmRpc2FibGVkXCIpJiZ6Yy50ZXN0KHRoaXMubm9kZU5hbWUpJiYheWMudGVzdChhKSYmKHRoaXMuY2hlY2tlZHx8IVQudGVzdChhKSl9KS5tYXAoZnVuY3Rpb24oYSxiKXt2YXIgYz1uKHRoaXMpLnZhbCgpO3JldHVybiBudWxsPT1jP251bGw6bi5pc0FycmF5KGMpP24ubWFwKGMsZnVuY3Rpb24oYSl7cmV0dXJue25hbWU6Yi5uYW1lLHZhbHVlOmEucmVwbGFjZSh4YyxcIlxcclxcblwiKX19KTp7bmFtZTpiLm5hbWUsdmFsdWU6Yy5yZXBsYWNlKHhjLFwiXFxyXFxuXCIpfX0pLmdldCgpfX0pLG4uYWpheFNldHRpbmdzLnhocj1mdW5jdGlvbigpe3RyeXtyZXR1cm4gbmV3IFhNTEh0dHBSZXF1ZXN0fWNhdGNoKGEpe319O3ZhciBCYz0wLENjPXt9LERjPXswOjIwMCwxMjIzOjIwNH0sRWM9bi5hamF4U2V0dGluZ3MueGhyKCk7YS5hdHRhY2hFdmVudCYmYS5hdHRhY2hFdmVudChcIm9udW5sb2FkXCIsZnVuY3Rpb24oKXtmb3IodmFyIGEgaW4gQ2MpQ2NbYV0oKX0pLGsuY29ycz0hIUVjJiZcIndpdGhDcmVkZW50aWFsc1wiaW4gRWMsay5hamF4PUVjPSEhRWMsbi5hamF4VHJhbnNwb3J0KGZ1bmN0aW9uKGEpe3ZhciBiO3JldHVybiBrLmNvcnN8fEVjJiYhYS5jcm9zc0RvbWFpbj97c2VuZDpmdW5jdGlvbihjLGQpe3ZhciBlLGY9YS54aHIoKSxnPSsrQmM7aWYoZi5vcGVuKGEudHlwZSxhLnVybCxhLmFzeW5jLGEudXNlcm5hbWUsYS5wYXNzd29yZCksYS54aHJGaWVsZHMpZm9yKGUgaW4gYS54aHJGaWVsZHMpZltlXT1hLnhockZpZWxkc1tlXTthLm1pbWVUeXBlJiZmLm92ZXJyaWRlTWltZVR5cGUmJmYub3ZlcnJpZGVNaW1lVHlwZShhLm1pbWVUeXBlKSxhLmNyb3NzRG9tYWlufHxjW1wiWC1SZXF1ZXN0ZWQtV2l0aFwiXXx8KGNbXCJYLVJlcXVlc3RlZC1XaXRoXCJdPVwiWE1MSHR0cFJlcXVlc3RcIik7Zm9yKGUgaW4gYylmLnNldFJlcXVlc3RIZWFkZXIoZSxjW2VdKTtiPWZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbigpe2ImJihkZWxldGUgQ2NbZ10sYj1mLm9ubG9hZD1mLm9uZXJyb3I9bnVsbCxcImFib3J0XCI9PT1hP2YuYWJvcnQoKTpcImVycm9yXCI9PT1hP2QoZi5zdGF0dXMsZi5zdGF0dXNUZXh0KTpkKERjW2Yuc3RhdHVzXXx8Zi5zdGF0dXMsZi5zdGF0dXNUZXh0LFwic3RyaW5nXCI9PXR5cGVvZiBmLnJlc3BvbnNlVGV4dD97dGV4dDpmLnJlc3BvbnNlVGV4dH06dm9pZCAwLGYuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkpKX19LGYub25sb2FkPWIoKSxmLm9uZXJyb3I9YihcImVycm9yXCIpLGI9Q2NbZ109YihcImFib3J0XCIpO3RyeXtmLnNlbmQoYS5oYXNDb250ZW50JiZhLmRhdGF8fG51bGwpfWNhdGNoKGgpe2lmKGIpdGhyb3cgaH19LGFib3J0OmZ1bmN0aW9uKCl7YiYmYigpfX06dm9pZCAwfSksbi5hamF4U2V0dXAoe2FjY2VwdHM6e3NjcmlwdDpcInRleHQvamF2YXNjcmlwdCwgYXBwbGljYXRpb24vamF2YXNjcmlwdCwgYXBwbGljYXRpb24vZWNtYXNjcmlwdCwgYXBwbGljYXRpb24veC1lY21hc2NyaXB0XCJ9LGNvbnRlbnRzOntzY3JpcHQ6Lyg/OmphdmF8ZWNtYSlzY3JpcHQvfSxjb252ZXJ0ZXJzOntcInRleHQgc2NyaXB0XCI6ZnVuY3Rpb24oYSl7cmV0dXJuIG4uZ2xvYmFsRXZhbChhKSxhfX19KSxuLmFqYXhQcmVmaWx0ZXIoXCJzY3JpcHRcIixmdW5jdGlvbihhKXt2b2lkIDA9PT1hLmNhY2hlJiYoYS5jYWNoZT0hMSksYS5jcm9zc0RvbWFpbiYmKGEudHlwZT1cIkdFVFwiKX0pLG4uYWpheFRyYW5zcG9ydChcInNjcmlwdFwiLGZ1bmN0aW9uKGEpe2lmKGEuY3Jvc3NEb21haW4pe3ZhciBiLGM7cmV0dXJue3NlbmQ6ZnVuY3Rpb24oZCxlKXtiPW4oXCI8c2NyaXB0PlwiKS5wcm9wKHthc3luYzohMCxjaGFyc2V0OmEuc2NyaXB0Q2hhcnNldCxzcmM6YS51cmx9KS5vbihcImxvYWQgZXJyb3JcIixjPWZ1bmN0aW9uKGEpe2IucmVtb3ZlKCksYz1udWxsLGEmJmUoXCJlcnJvclwiPT09YS50eXBlPzQwNDoyMDAsYS50eXBlKX0pLGwuaGVhZC5hcHBlbmRDaGlsZChiWzBdKX0sYWJvcnQ6ZnVuY3Rpb24oKXtjJiZjKCl9fX19KTt2YXIgRmM9W10sR2M9Lyg9KVxcPyg/PSZ8JCl8XFw/XFw/LztuLmFqYXhTZXR1cCh7anNvbnA6XCJjYWxsYmFja1wiLGpzb25wQ2FsbGJhY2s6ZnVuY3Rpb24oKXt2YXIgYT1GYy5wb3AoKXx8bi5leHBhbmRvK1wiX1wiK2NjKys7cmV0dXJuIHRoaXNbYV09ITAsYX19KSxuLmFqYXhQcmVmaWx0ZXIoXCJqc29uIGpzb25wXCIsZnVuY3Rpb24oYixjLGQpe3ZhciBlLGYsZyxoPWIuanNvbnAhPT0hMSYmKEdjLnRlc3QoYi51cmwpP1widXJsXCI6XCJzdHJpbmdcIj09dHlwZW9mIGIuZGF0YSYmIShiLmNvbnRlbnRUeXBlfHxcIlwiKS5pbmRleE9mKFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCIpJiZHYy50ZXN0KGIuZGF0YSkmJlwiZGF0YVwiKTtyZXR1cm4gaHx8XCJqc29ucFwiPT09Yi5kYXRhVHlwZXNbMF0/KGU9Yi5qc29ucENhbGxiYWNrPW4uaXNGdW5jdGlvbihiLmpzb25wQ2FsbGJhY2spP2IuanNvbnBDYWxsYmFjaygpOmIuanNvbnBDYWxsYmFjayxoP2JbaF09YltoXS5yZXBsYWNlKEdjLFwiJDFcIitlKTpiLmpzb25wIT09ITEmJihiLnVybCs9KGRjLnRlc3QoYi51cmwpP1wiJlwiOlwiP1wiKStiLmpzb25wK1wiPVwiK2UpLGIuY29udmVydGVyc1tcInNjcmlwdCBqc29uXCJdPWZ1bmN0aW9uKCl7cmV0dXJuIGd8fG4uZXJyb3IoZStcIiB3YXMgbm90IGNhbGxlZFwiKSxnWzBdfSxiLmRhdGFUeXBlc1swXT1cImpzb25cIixmPWFbZV0sYVtlXT1mdW5jdGlvbigpe2c9YXJndW1lbnRzfSxkLmFsd2F5cyhmdW5jdGlvbigpe2FbZV09ZixiW2VdJiYoYi5qc29ucENhbGxiYWNrPWMuanNvbnBDYWxsYmFjayxGYy5wdXNoKGUpKSxnJiZuLmlzRnVuY3Rpb24oZikmJmYoZ1swXSksZz1mPXZvaWQgMH0pLFwic2NyaXB0XCIpOnZvaWQgMH0pLG4ucGFyc2VIVE1MPWZ1bmN0aW9uKGEsYixjKXtpZighYXx8XCJzdHJpbmdcIiE9dHlwZW9mIGEpcmV0dXJuIG51bGw7XCJib29sZWFuXCI9PXR5cGVvZiBiJiYoYz1iLGI9ITEpLGI9Ynx8bDt2YXIgZD12LmV4ZWMoYSksZT0hYyYmW107cmV0dXJuIGQ/W2IuY3JlYXRlRWxlbWVudChkWzFdKV06KGQ9bi5idWlsZEZyYWdtZW50KFthXSxiLGUpLGUmJmUubGVuZ3RoJiZuKGUpLnJlbW92ZSgpLG4ubWVyZ2UoW10sZC5jaGlsZE5vZGVzKSl9O3ZhciBIYz1uLmZuLmxvYWQ7bi5mbi5sb2FkPWZ1bmN0aW9uKGEsYixjKXtpZihcInN0cmluZ1wiIT10eXBlb2YgYSYmSGMpcmV0dXJuIEhjLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgZCxlLGYsZz10aGlzLGg9YS5pbmRleE9mKFwiIFwiKTtyZXR1cm4gaD49MCYmKGQ9bi50cmltKGEuc2xpY2UoaCkpLGE9YS5zbGljZSgwLGgpKSxuLmlzRnVuY3Rpb24oYik/KGM9YixiPXZvaWQgMCk6YiYmXCJvYmplY3RcIj09dHlwZW9mIGImJihlPVwiUE9TVFwiKSxnLmxlbmd0aD4wJiZuLmFqYXgoe3VybDphLHR5cGU6ZSxkYXRhVHlwZTpcImh0bWxcIixkYXRhOmJ9KS5kb25lKGZ1bmN0aW9uKGEpe2Y9YXJndW1lbnRzLGcuaHRtbChkP24oXCI8ZGl2PlwiKS5hcHBlbmQobi5wYXJzZUhUTUwoYSkpLmZpbmQoZCk6YSl9KS5jb21wbGV0ZShjJiZmdW5jdGlvbihhLGIpe2cuZWFjaChjLGZ8fFthLnJlc3BvbnNlVGV4dCxiLGFdKX0pLHRoaXN9LG4uZWFjaChbXCJhamF4U3RhcnRcIixcImFqYXhTdG9wXCIsXCJhamF4Q29tcGxldGVcIixcImFqYXhFcnJvclwiLFwiYWpheFN1Y2Nlc3NcIixcImFqYXhTZW5kXCJdLGZ1bmN0aW9uKGEsYil7bi5mbltiXT1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5vbihiLGEpfX0pLG4uZXhwci5maWx0ZXJzLmFuaW1hdGVkPWZ1bmN0aW9uKGEpe3JldHVybiBuLmdyZXAobi50aW1lcnMsZnVuY3Rpb24oYil7cmV0dXJuIGE9PT1iLmVsZW19KS5sZW5ndGh9O3ZhciBJYz1hLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtmdW5jdGlvbiBKYyhhKXtyZXR1cm4gbi5pc1dpbmRvdyhhKT9hOjk9PT1hLm5vZGVUeXBlJiZhLmRlZmF1bHRWaWV3fW4ub2Zmc2V0PXtzZXRPZmZzZXQ6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZixnLGgsaSxqLGs9bi5jc3MoYSxcInBvc2l0aW9uXCIpLGw9bihhKSxtPXt9O1wic3RhdGljXCI9PT1rJiYoYS5zdHlsZS5wb3NpdGlvbj1cInJlbGF0aXZlXCIpLGg9bC5vZmZzZXQoKSxmPW4uY3NzKGEsXCJ0b3BcIiksaT1uLmNzcyhhLFwibGVmdFwiKSxqPShcImFic29sdXRlXCI9PT1rfHxcImZpeGVkXCI9PT1rKSYmKGYraSkuaW5kZXhPZihcImF1dG9cIik+LTEsaj8oZD1sLnBvc2l0aW9uKCksZz1kLnRvcCxlPWQubGVmdCk6KGc9cGFyc2VGbG9hdChmKXx8MCxlPXBhcnNlRmxvYXQoaSl8fDApLG4uaXNGdW5jdGlvbihiKSYmKGI9Yi5jYWxsKGEsYyxoKSksbnVsbCE9Yi50b3AmJihtLnRvcD1iLnRvcC1oLnRvcCtnKSxudWxsIT1iLmxlZnQmJihtLmxlZnQ9Yi5sZWZ0LWgubGVmdCtlKSxcInVzaW5nXCJpbiBiP2IudXNpbmcuY2FsbChhLG0pOmwuY3NzKG0pfX0sbi5mbi5leHRlbmQoe29mZnNldDpmdW5jdGlvbihhKXtpZihhcmd1bWVudHMubGVuZ3RoKXJldHVybiB2b2lkIDA9PT1hP3RoaXM6dGhpcy5lYWNoKGZ1bmN0aW9uKGIpe24ub2Zmc2V0LnNldE9mZnNldCh0aGlzLGEsYil9KTt2YXIgYixjLGQ9dGhpc1swXSxlPXt0b3A6MCxsZWZ0OjB9LGY9ZCYmZC5vd25lckRvY3VtZW50O2lmKGYpcmV0dXJuIGI9Zi5kb2N1bWVudEVsZW1lbnQsbi5jb250YWlucyhiLGQpPyh0eXBlb2YgZC5nZXRCb3VuZGluZ0NsaWVudFJlY3QhPT1VJiYoZT1kLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpKSxjPUpjKGYpLHt0b3A6ZS50b3ArYy5wYWdlWU9mZnNldC1iLmNsaWVudFRvcCxsZWZ0OmUubGVmdCtjLnBhZ2VYT2Zmc2V0LWIuY2xpZW50TGVmdH0pOmV9LHBvc2l0aW9uOmZ1bmN0aW9uKCl7aWYodGhpc1swXSl7dmFyIGEsYixjPXRoaXNbMF0sZD17dG9wOjAsbGVmdDowfTtyZXR1cm5cImZpeGVkXCI9PT1uLmNzcyhjLFwicG9zaXRpb25cIik/Yj1jLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOihhPXRoaXMub2Zmc2V0UGFyZW50KCksYj10aGlzLm9mZnNldCgpLG4ubm9kZU5hbWUoYVswXSxcImh0bWxcIil8fChkPWEub2Zmc2V0KCkpLGQudG9wKz1uLmNzcyhhWzBdLFwiYm9yZGVyVG9wV2lkdGhcIiwhMCksZC5sZWZ0Kz1uLmNzcyhhWzBdLFwiYm9yZGVyTGVmdFdpZHRoXCIsITApKSx7dG9wOmIudG9wLWQudG9wLW4uY3NzKGMsXCJtYXJnaW5Ub3BcIiwhMCksbGVmdDpiLmxlZnQtZC5sZWZ0LW4uY3NzKGMsXCJtYXJnaW5MZWZ0XCIsITApfX19LG9mZnNldFBhcmVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1hcChmdW5jdGlvbigpe3ZhciBhPXRoaXMub2Zmc2V0UGFyZW50fHxJYzt3aGlsZShhJiYhbi5ub2RlTmFtZShhLFwiaHRtbFwiKSYmXCJzdGF0aWNcIj09PW4uY3NzKGEsXCJwb3NpdGlvblwiKSlhPWEub2Zmc2V0UGFyZW50O3JldHVybiBhfHxJY30pfX0pLG4uZWFjaCh7c2Nyb2xsTGVmdDpcInBhZ2VYT2Zmc2V0XCIsc2Nyb2xsVG9wOlwicGFnZVlPZmZzZXRcIn0sZnVuY3Rpb24oYixjKXt2YXIgZD1cInBhZ2VZT2Zmc2V0XCI9PT1jO24uZm5bYl09ZnVuY3Rpb24oZSl7cmV0dXJuIEoodGhpcyxmdW5jdGlvbihiLGUsZil7dmFyIGc9SmMoYik7cmV0dXJuIHZvaWQgMD09PWY/Zz9nW2NdOmJbZV06dm9pZChnP2cuc2Nyb2xsVG8oZD9hLnBhZ2VYT2Zmc2V0OmYsZD9mOmEucGFnZVlPZmZzZXQpOmJbZV09Zil9LGIsZSxhcmd1bWVudHMubGVuZ3RoLG51bGwpfX0pLG4uZWFjaChbXCJ0b3BcIixcImxlZnRcIl0sZnVuY3Rpb24oYSxiKXtuLmNzc0hvb2tzW2JdPXliKGsucGl4ZWxQb3NpdGlvbixmdW5jdGlvbihhLGMpe3JldHVybiBjPyhjPXhiKGEsYiksdmIudGVzdChjKT9uKGEpLnBvc2l0aW9uKClbYl0rXCJweFwiOmMpOnZvaWQgMH0pfSksbi5lYWNoKHtIZWlnaHQ6XCJoZWlnaHRcIixXaWR0aDpcIndpZHRoXCJ9LGZ1bmN0aW9uKGEsYil7bi5lYWNoKHtwYWRkaW5nOlwiaW5uZXJcIithLGNvbnRlbnQ6YixcIlwiOlwib3V0ZXJcIithfSxmdW5jdGlvbihjLGQpe24uZm5bZF09ZnVuY3Rpb24oZCxlKXt2YXIgZj1hcmd1bWVudHMubGVuZ3RoJiYoY3x8XCJib29sZWFuXCIhPXR5cGVvZiBkKSxnPWN8fChkPT09ITB8fGU9PT0hMD9cIm1hcmdpblwiOlwiYm9yZGVyXCIpO3JldHVybiBKKHRoaXMsZnVuY3Rpb24oYixjLGQpe3ZhciBlO3JldHVybiBuLmlzV2luZG93KGIpP2IuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50W1wiY2xpZW50XCIrYV06OT09PWIubm9kZVR5cGU/KGU9Yi5kb2N1bWVudEVsZW1lbnQsTWF0aC5tYXgoYi5ib2R5W1wic2Nyb2xsXCIrYV0sZVtcInNjcm9sbFwiK2FdLGIuYm9keVtcIm9mZnNldFwiK2FdLGVbXCJvZmZzZXRcIithXSxlW1wiY2xpZW50XCIrYV0pKTp2b2lkIDA9PT1kP24uY3NzKGIsYyxnKTpuLnN0eWxlKGIsYyxkLGcpfSxiLGY/ZDp2b2lkIDAsZixudWxsKX19KX0pLG4uZm4uc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxlbmd0aH0sbi5mbi5hbmRTZWxmPW4uZm4uYWRkQmFjayxcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQmJmRlZmluZShcImpxdWVyeVwiLFtdLGZ1bmN0aW9uKCl7cmV0dXJuIG59KTt2YXIgS2M9YS5qUXVlcnksTGM9YS4kO3JldHVybiBuLm5vQ29uZmxpY3Q9ZnVuY3Rpb24oYil7cmV0dXJuIGEuJD09PW4mJihhLiQ9TGMpLGImJmEualF1ZXJ5PT09biYmKGEualF1ZXJ5PUtjKSxufSx0eXBlb2YgYj09PVUmJihhLmpRdWVyeT1hLiQ9biksbn0pO1xyXG4iLCIvKiEgalF1ZXJ5IFVJIC0gdjEuMTEuNCAtIDIwMTUtMDMtMTlcclxuKiBodHRwOi8vanF1ZXJ5dWkuY29tXHJcbiogSW5jbHVkZXM6IGNvcmUuanMsIHdpZGdldC5qcywgbW91c2UuanMsIGRyYWdnYWJsZS5qcywgc29ydGFibGUuanNcclxuKiBDb3B5cmlnaHQgMjAxNSBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzOyBMaWNlbnNlZCBNSVQgKi9cclxuXHJcbihmdW5jdGlvbiggZmFjdG9yeSApIHtcclxuXHRpZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xyXG5cclxuXHRcdC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cclxuXHRcdGRlZmluZShbIFwianF1ZXJ5XCIgXSwgZmFjdG9yeSApO1xyXG5cdH0gZWxzZSB7XHJcblxyXG5cdFx0Ly8gQnJvd3NlciBnbG9iYWxzXHJcblx0XHRmYWN0b3J5KCBqUXVlcnkgKTtcclxuXHR9XHJcbn0oZnVuY3Rpb24oICQgKSB7XHJcbi8qIVxyXG4gKiBqUXVlcnkgVUkgQ29yZSAxLjExLjRcclxuICogaHR0cDovL2pxdWVyeXVpLmNvbVxyXG4gKlxyXG4gKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xyXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXHJcbiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2VcclxuICpcclxuICogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vY2F0ZWdvcnkvdWktY29yZS9cclxuICovXHJcblxyXG5cclxuLy8gJC51aSBtaWdodCBleGlzdCBmcm9tIGNvbXBvbmVudHMgd2l0aCBubyBkZXBlbmRlbmNpZXMsIGUuZy4sICQudWkucG9zaXRpb25cclxuJC51aSA9ICQudWkgfHwge307XHJcblxyXG4kLmV4dGVuZCggJC51aSwge1xyXG5cdHZlcnNpb246IFwiMS4xMS40XCIsXHJcblxyXG5cdGtleUNvZGU6IHtcclxuXHRcdEJBQ0tTUEFDRTogOCxcclxuXHRcdENPTU1BOiAxODgsXHJcblx0XHRERUxFVEU6IDQ2LFxyXG5cdFx0RE9XTjogNDAsXHJcblx0XHRFTkQ6IDM1LFxyXG5cdFx0RU5URVI6IDEzLFxyXG5cdFx0RVNDQVBFOiAyNyxcclxuXHRcdEhPTUU6IDM2LFxyXG5cdFx0TEVGVDogMzcsXHJcblx0XHRQQUdFX0RPV046IDM0LFxyXG5cdFx0UEFHRV9VUDogMzMsXHJcblx0XHRQRVJJT0Q6IDE5MCxcclxuXHRcdFJJR0hUOiAzOSxcclxuXHRcdFNQQUNFOiAzMixcclxuXHRcdFRBQjogOSxcclxuXHRcdFVQOiAzOFxyXG5cdH1cclxufSk7XHJcblxyXG4vLyBwbHVnaW5zXHJcbiQuZm4uZXh0ZW5kKHtcclxuXHRzY3JvbGxQYXJlbnQ6IGZ1bmN0aW9uKCBpbmNsdWRlSGlkZGVuICkge1xyXG5cdFx0dmFyIHBvc2l0aW9uID0gdGhpcy5jc3MoIFwicG9zaXRpb25cIiApLFxyXG5cdFx0XHRleGNsdWRlU3RhdGljUGFyZW50ID0gcG9zaXRpb24gPT09IFwiYWJzb2x1dGVcIixcclxuXHRcdFx0b3ZlcmZsb3dSZWdleCA9IGluY2x1ZGVIaWRkZW4gPyAvKGF1dG98c2Nyb2xsfGhpZGRlbikvIDogLyhhdXRvfHNjcm9sbCkvLFxyXG5cdFx0XHRzY3JvbGxQYXJlbnQgPSB0aGlzLnBhcmVudHMoKS5maWx0ZXIoIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHZhciBwYXJlbnQgPSAkKCB0aGlzICk7XHJcblx0XHRcdFx0aWYgKCBleGNsdWRlU3RhdGljUGFyZW50ICYmIHBhcmVudC5jc3MoIFwicG9zaXRpb25cIiApID09PSBcInN0YXRpY1wiICkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZXR1cm4gb3ZlcmZsb3dSZWdleC50ZXN0KCBwYXJlbnQuY3NzKCBcIm92ZXJmbG93XCIgKSArIHBhcmVudC5jc3MoIFwib3ZlcmZsb3cteVwiICkgKyBwYXJlbnQuY3NzKCBcIm92ZXJmbG93LXhcIiApICk7XHJcblx0XHRcdH0pLmVxKCAwICk7XHJcblxyXG5cdFx0cmV0dXJuIHBvc2l0aW9uID09PSBcImZpeGVkXCIgfHwgIXNjcm9sbFBhcmVudC5sZW5ndGggPyAkKCB0aGlzWyAwIF0ub3duZXJEb2N1bWVudCB8fCBkb2N1bWVudCApIDogc2Nyb2xsUGFyZW50O1xyXG5cdH0sXHJcblxyXG5cdHVuaXF1ZUlkOiAoZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgdXVpZCA9IDA7XHJcblxyXG5cdFx0cmV0dXJuIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdGlmICggIXRoaXMuaWQgKSB7XHJcblx0XHRcdFx0XHR0aGlzLmlkID0gXCJ1aS1pZC1cIiArICggKyt1dWlkICk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH07XHJcblx0fSkoKSxcclxuXHJcblx0cmVtb3ZlVW5pcXVlSWQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0aWYgKCAvXnVpLWlkLVxcZCskLy50ZXN0KCB0aGlzLmlkICkgKSB7XHJcblx0XHRcdFx0JCggdGhpcyApLnJlbW92ZUF0dHIoIFwiaWRcIiApO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn0pO1xyXG5cclxuLy8gc2VsZWN0b3JzXHJcbmZ1bmN0aW9uIGZvY3VzYWJsZSggZWxlbWVudCwgaXNUYWJJbmRleE5vdE5hTiApIHtcclxuXHR2YXIgbWFwLCBtYXBOYW1lLCBpbWcsXHJcblx0XHRub2RlTmFtZSA9IGVsZW1lbnQubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcclxuXHRpZiAoIFwiYXJlYVwiID09PSBub2RlTmFtZSApIHtcclxuXHRcdG1hcCA9IGVsZW1lbnQucGFyZW50Tm9kZTtcclxuXHRcdG1hcE5hbWUgPSBtYXAubmFtZTtcclxuXHRcdGlmICggIWVsZW1lbnQuaHJlZiB8fCAhbWFwTmFtZSB8fCBtYXAubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPT0gXCJtYXBcIiApIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cdFx0aW1nID0gJCggXCJpbWdbdXNlbWFwPScjXCIgKyBtYXBOYW1lICsgXCInXVwiIClbIDAgXTtcclxuXHRcdHJldHVybiAhIWltZyAmJiB2aXNpYmxlKCBpbWcgKTtcclxuXHR9XHJcblx0cmV0dXJuICggL14oaW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbnxvYmplY3QpJC8udGVzdCggbm9kZU5hbWUgKSA/XHJcblx0XHQhZWxlbWVudC5kaXNhYmxlZCA6XHJcblx0XHRcImFcIiA9PT0gbm9kZU5hbWUgP1xyXG5cdFx0XHRlbGVtZW50LmhyZWYgfHwgaXNUYWJJbmRleE5vdE5hTiA6XHJcblx0XHRcdGlzVGFiSW5kZXhOb3ROYU4pICYmXHJcblx0XHQvLyB0aGUgZWxlbWVudCBhbmQgYWxsIG9mIGl0cyBhbmNlc3RvcnMgbXVzdCBiZSB2aXNpYmxlXHJcblx0XHR2aXNpYmxlKCBlbGVtZW50ICk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHZpc2libGUoIGVsZW1lbnQgKSB7XHJcblx0cmV0dXJuICQuZXhwci5maWx0ZXJzLnZpc2libGUoIGVsZW1lbnQgKSAmJlxyXG5cdFx0ISQoIGVsZW1lbnQgKS5wYXJlbnRzKCkuYWRkQmFjaygpLmZpbHRlcihmdW5jdGlvbigpIHtcclxuXHRcdFx0cmV0dXJuICQuY3NzKCB0aGlzLCBcInZpc2liaWxpdHlcIiApID09PSBcImhpZGRlblwiO1xyXG5cdFx0fSkubGVuZ3RoO1xyXG59XHJcblxyXG4kLmV4dGVuZCggJC5leHByWyBcIjpcIiBdLCB7XHJcblx0ZGF0YTogJC5leHByLmNyZWF0ZVBzZXVkbyA/XHJcblx0XHQkLmV4cHIuY3JlYXRlUHNldWRvKGZ1bmN0aW9uKCBkYXRhTmFtZSApIHtcclxuXHRcdFx0cmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkge1xyXG5cdFx0XHRcdHJldHVybiAhISQuZGF0YSggZWxlbSwgZGF0YU5hbWUgKTtcclxuXHRcdFx0fTtcclxuXHRcdH0pIDpcclxuXHRcdC8vIHN1cHBvcnQ6IGpRdWVyeSA8MS44XHJcblx0XHRmdW5jdGlvbiggZWxlbSwgaSwgbWF0Y2ggKSB7XHJcblx0XHRcdHJldHVybiAhISQuZGF0YSggZWxlbSwgbWF0Y2hbIDMgXSApO1xyXG5cdFx0fSxcclxuXHJcblx0Zm9jdXNhYmxlOiBmdW5jdGlvbiggZWxlbWVudCApIHtcclxuXHRcdHJldHVybiBmb2N1c2FibGUoIGVsZW1lbnQsICFpc05hTiggJC5hdHRyKCBlbGVtZW50LCBcInRhYmluZGV4XCIgKSApICk7XHJcblx0fSxcclxuXHJcblx0dGFiYmFibGU6IGZ1bmN0aW9uKCBlbGVtZW50ICkge1xyXG5cdFx0dmFyIHRhYkluZGV4ID0gJC5hdHRyKCBlbGVtZW50LCBcInRhYmluZGV4XCIgKSxcclxuXHRcdFx0aXNUYWJJbmRleE5hTiA9IGlzTmFOKCB0YWJJbmRleCApO1xyXG5cdFx0cmV0dXJuICggaXNUYWJJbmRleE5hTiB8fCB0YWJJbmRleCA+PSAwICkgJiYgZm9jdXNhYmxlKCBlbGVtZW50LCAhaXNUYWJJbmRleE5hTiApO1xyXG5cdH1cclxufSk7XHJcblxyXG4vLyBzdXBwb3J0OiBqUXVlcnkgPDEuOFxyXG5pZiAoICEkKCBcIjxhPlwiICkub3V0ZXJXaWR0aCggMSApLmpxdWVyeSApIHtcclxuXHQkLmVhY2goIFsgXCJXaWR0aFwiLCBcIkhlaWdodFwiIF0sIGZ1bmN0aW9uKCBpLCBuYW1lICkge1xyXG5cdFx0dmFyIHNpZGUgPSBuYW1lID09PSBcIldpZHRoXCIgPyBbIFwiTGVmdFwiLCBcIlJpZ2h0XCIgXSA6IFsgXCJUb3BcIiwgXCJCb3R0b21cIiBdLFxyXG5cdFx0XHR0eXBlID0gbmFtZS50b0xvd2VyQ2FzZSgpLFxyXG5cdFx0XHRvcmlnID0ge1xyXG5cdFx0XHRcdGlubmVyV2lkdGg6ICQuZm4uaW5uZXJXaWR0aCxcclxuXHRcdFx0XHRpbm5lckhlaWdodDogJC5mbi5pbm5lckhlaWdodCxcclxuXHRcdFx0XHRvdXRlcldpZHRoOiAkLmZuLm91dGVyV2lkdGgsXHJcblx0XHRcdFx0b3V0ZXJIZWlnaHQ6ICQuZm4ub3V0ZXJIZWlnaHRcclxuXHRcdFx0fTtcclxuXHJcblx0XHRmdW5jdGlvbiByZWR1Y2UoIGVsZW0sIHNpemUsIGJvcmRlciwgbWFyZ2luICkge1xyXG5cdFx0XHQkLmVhY2goIHNpZGUsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHNpemUgLT0gcGFyc2VGbG9hdCggJC5jc3MoIGVsZW0sIFwicGFkZGluZ1wiICsgdGhpcyApICkgfHwgMDtcclxuXHRcdFx0XHRpZiAoIGJvcmRlciApIHtcclxuXHRcdFx0XHRcdHNpemUgLT0gcGFyc2VGbG9hdCggJC5jc3MoIGVsZW0sIFwiYm9yZGVyXCIgKyB0aGlzICsgXCJXaWR0aFwiICkgKSB8fCAwO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoIG1hcmdpbiApIHtcclxuXHRcdFx0XHRcdHNpemUgLT0gcGFyc2VGbG9hdCggJC5jc3MoIGVsZW0sIFwibWFyZ2luXCIgKyB0aGlzICkgKSB8fCAwO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHRcdHJldHVybiBzaXplO1xyXG5cdFx0fVxyXG5cclxuXHRcdCQuZm5bIFwiaW5uZXJcIiArIG5hbWUgXSA9IGZ1bmN0aW9uKCBzaXplICkge1xyXG5cdFx0XHRpZiAoIHNpemUgPT09IHVuZGVmaW5lZCApIHtcclxuXHRcdFx0XHRyZXR1cm4gb3JpZ1sgXCJpbm5lclwiICsgbmFtZSBdLmNhbGwoIHRoaXMgKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHQkKCB0aGlzICkuY3NzKCB0eXBlLCByZWR1Y2UoIHRoaXMsIHNpemUgKSArIFwicHhcIiApO1xyXG5cdFx0XHR9KTtcclxuXHRcdH07XHJcblxyXG5cdFx0JC5mblsgXCJvdXRlclwiICsgbmFtZV0gPSBmdW5jdGlvbiggc2l6ZSwgbWFyZ2luICkge1xyXG5cdFx0XHRpZiAoIHR5cGVvZiBzaXplICE9PSBcIm51bWJlclwiICkge1xyXG5cdFx0XHRcdHJldHVybiBvcmlnWyBcIm91dGVyXCIgKyBuYW1lIF0uY2FsbCggdGhpcywgc2l6ZSApO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdCQoIHRoaXMpLmNzcyggdHlwZSwgcmVkdWNlKCB0aGlzLCBzaXplLCB0cnVlLCBtYXJnaW4gKSArIFwicHhcIiApO1xyXG5cdFx0XHR9KTtcclxuXHRcdH07XHJcblx0fSk7XHJcbn1cclxuXHJcbi8vIHN1cHBvcnQ6IGpRdWVyeSA8MS44XHJcbmlmICggISQuZm4uYWRkQmFjayApIHtcclxuXHQkLmZuLmFkZEJhY2sgPSBmdW5jdGlvbiggc2VsZWN0b3IgKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5hZGQoIHNlbGVjdG9yID09IG51bGwgP1xyXG5cdFx0XHR0aGlzLnByZXZPYmplY3QgOiB0aGlzLnByZXZPYmplY3QuZmlsdGVyKCBzZWxlY3RvciApXHJcblx0XHQpO1xyXG5cdH07XHJcbn1cclxuXHJcbi8vIHN1cHBvcnQ6IGpRdWVyeSAxLjYuMSwgMS42LjIgKGh0dHA6Ly9idWdzLmpxdWVyeS5jb20vdGlja2V0Lzk0MTMpXHJcbmlmICggJCggXCI8YT5cIiApLmRhdGEoIFwiYS1iXCIsIFwiYVwiICkucmVtb3ZlRGF0YSggXCJhLWJcIiApLmRhdGEoIFwiYS1iXCIgKSApIHtcclxuXHQkLmZuLnJlbW92ZURhdGEgPSAoZnVuY3Rpb24oIHJlbW92ZURhdGEgKSB7XHJcblx0XHRyZXR1cm4gZnVuY3Rpb24oIGtleSApIHtcclxuXHRcdFx0aWYgKCBhcmd1bWVudHMubGVuZ3RoICkge1xyXG5cdFx0XHRcdHJldHVybiByZW1vdmVEYXRhLmNhbGwoIHRoaXMsICQuY2FtZWxDYXNlKCBrZXkgKSApO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHJldHVybiByZW1vdmVEYXRhLmNhbGwoIHRoaXMgKTtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHR9KSggJC5mbi5yZW1vdmVEYXRhICk7XHJcbn1cclxuXHJcbi8vIGRlcHJlY2F0ZWRcclxuJC51aS5pZSA9ICEhL21zaWUgW1xcdy5dKy8uZXhlYyggbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpICk7XHJcblxyXG4kLmZuLmV4dGVuZCh7XHJcblx0Zm9jdXM6IChmdW5jdGlvbiggb3JpZyApIHtcclxuXHRcdHJldHVybiBmdW5jdGlvbiggZGVsYXksIGZuICkge1xyXG5cdFx0XHRyZXR1cm4gdHlwZW9mIGRlbGF5ID09PSBcIm51bWJlclwiID9cclxuXHRcdFx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR2YXIgZWxlbSA9IHRoaXM7XHJcblx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQkKCBlbGVtICkuZm9jdXMoKTtcclxuXHRcdFx0XHRcdFx0aWYgKCBmbiApIHtcclxuXHRcdFx0XHRcdFx0XHRmbi5jYWxsKCBlbGVtICk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0sIGRlbGF5ICk7XHJcblx0XHRcdFx0fSkgOlxyXG5cdFx0XHRcdG9yaWcuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApO1xyXG5cdFx0fTtcclxuXHR9KSggJC5mbi5mb2N1cyApLFxyXG5cclxuXHRkaXNhYmxlU2VsZWN0aW9uOiAoZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgZXZlbnRUeXBlID0gXCJvbnNlbGVjdHN0YXJ0XCIgaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggXCJkaXZcIiApID9cclxuXHRcdFx0XCJzZWxlY3RzdGFydFwiIDpcclxuXHRcdFx0XCJtb3VzZWRvd25cIjtcclxuXHJcblx0XHRyZXR1cm4gZnVuY3Rpb24oKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLmJpbmQoIGV2ZW50VHlwZSArIFwiLnVpLWRpc2FibGVTZWxlY3Rpb25cIiwgZnVuY3Rpb24oIGV2ZW50ICkge1xyXG5cdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fTtcclxuXHR9KSgpLFxyXG5cclxuXHRlbmFibGVTZWxlY3Rpb246IGZ1bmN0aW9uKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMudW5iaW5kKCBcIi51aS1kaXNhYmxlU2VsZWN0aW9uXCIgKTtcclxuXHR9LFxyXG5cclxuXHR6SW5kZXg6IGZ1bmN0aW9uKCB6SW5kZXggKSB7XHJcblx0XHRpZiAoIHpJbmRleCAhPT0gdW5kZWZpbmVkICkge1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5jc3MoIFwiekluZGV4XCIsIHpJbmRleCApO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICggdGhpcy5sZW5ndGggKSB7XHJcblx0XHRcdHZhciBlbGVtID0gJCggdGhpc1sgMCBdICksIHBvc2l0aW9uLCB2YWx1ZTtcclxuXHRcdFx0d2hpbGUgKCBlbGVtLmxlbmd0aCAmJiBlbGVtWyAwIF0gIT09IGRvY3VtZW50ICkge1xyXG5cdFx0XHRcdC8vIElnbm9yZSB6LWluZGV4IGlmIHBvc2l0aW9uIGlzIHNldCB0byBhIHZhbHVlIHdoZXJlIHotaW5kZXggaXMgaWdub3JlZCBieSB0aGUgYnJvd3NlclxyXG5cdFx0XHRcdC8vIFRoaXMgbWFrZXMgYmVoYXZpb3Igb2YgdGhpcyBmdW5jdGlvbiBjb25zaXN0ZW50IGFjcm9zcyBicm93c2Vyc1xyXG5cdFx0XHRcdC8vIFdlYktpdCBhbHdheXMgcmV0dXJucyBhdXRvIGlmIHRoZSBlbGVtZW50IGlzIHBvc2l0aW9uZWRcclxuXHRcdFx0XHRwb3NpdGlvbiA9IGVsZW0uY3NzKCBcInBvc2l0aW9uXCIgKTtcclxuXHRcdFx0XHRpZiAoIHBvc2l0aW9uID09PSBcImFic29sdXRlXCIgfHwgcG9zaXRpb24gPT09IFwicmVsYXRpdmVcIiB8fCBwb3NpdGlvbiA9PT0gXCJmaXhlZFwiICkge1xyXG5cdFx0XHRcdFx0Ly8gSUUgcmV0dXJucyAwIHdoZW4gekluZGV4IGlzIG5vdCBzcGVjaWZpZWRcclxuXHRcdFx0XHRcdC8vIG90aGVyIGJyb3dzZXJzIHJldHVybiBhIHN0cmluZ1xyXG5cdFx0XHRcdFx0Ly8gd2UgaWdub3JlIHRoZSBjYXNlIG9mIG5lc3RlZCBlbGVtZW50cyB3aXRoIGFuIGV4cGxpY2l0IHZhbHVlIG9mIDBcclxuXHRcdFx0XHRcdC8vIDxkaXYgc3R5bGU9XCJ6LWluZGV4OiAtMTA7XCI+PGRpdiBzdHlsZT1cInotaW5kZXg6IDA7XCI+PC9kaXY+PC9kaXY+XHJcblx0XHRcdFx0XHR2YWx1ZSA9IHBhcnNlSW50KCBlbGVtLmNzcyggXCJ6SW5kZXhcIiApLCAxMCApO1xyXG5cdFx0XHRcdFx0aWYgKCAhaXNOYU4oIHZhbHVlICkgJiYgdmFsdWUgIT09IDAgKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybiB2YWx1ZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxlbSA9IGVsZW0ucGFyZW50KCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gMDtcclxuXHR9XHJcbn0pO1xyXG5cclxuLy8gJC51aS5wbHVnaW4gaXMgZGVwcmVjYXRlZC4gVXNlICQud2lkZ2V0KCkgZXh0ZW5zaW9ucyBpbnN0ZWFkLlxyXG4kLnVpLnBsdWdpbiA9IHtcclxuXHRhZGQ6IGZ1bmN0aW9uKCBtb2R1bGUsIG9wdGlvbiwgc2V0ICkge1xyXG5cdFx0dmFyIGksXHJcblx0XHRcdHByb3RvID0gJC51aVsgbW9kdWxlIF0ucHJvdG90eXBlO1xyXG5cdFx0Zm9yICggaSBpbiBzZXQgKSB7XHJcblx0XHRcdHByb3RvLnBsdWdpbnNbIGkgXSA9IHByb3RvLnBsdWdpbnNbIGkgXSB8fCBbXTtcclxuXHRcdFx0cHJvdG8ucGx1Z2luc1sgaSBdLnB1c2goIFsgb3B0aW9uLCBzZXRbIGkgXSBdICk7XHJcblx0XHR9XHJcblx0fSxcclxuXHRjYWxsOiBmdW5jdGlvbiggaW5zdGFuY2UsIG5hbWUsIGFyZ3MsIGFsbG93RGlzY29ubmVjdGVkICkge1xyXG5cdFx0dmFyIGksXHJcblx0XHRcdHNldCA9IGluc3RhbmNlLnBsdWdpbnNbIG5hbWUgXTtcclxuXHJcblx0XHRpZiAoICFzZXQgKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoICFhbGxvd0Rpc2Nvbm5lY3RlZCAmJiAoICFpbnN0YW5jZS5lbGVtZW50WyAwIF0ucGFyZW50Tm9kZSB8fCBpbnN0YW5jZS5lbGVtZW50WyAwIF0ucGFyZW50Tm9kZS5ub2RlVHlwZSA9PT0gMTEgKSApIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdGZvciAoIGkgPSAwOyBpIDwgc2V0Lmxlbmd0aDsgaSsrICkge1xyXG5cdFx0XHRpZiAoIGluc3RhbmNlLm9wdGlvbnNbIHNldFsgaSBdWyAwIF0gXSApIHtcclxuXHRcdFx0XHRzZXRbIGkgXVsgMSBdLmFwcGx5KCBpbnN0YW5jZS5lbGVtZW50LCBhcmdzICk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG5cclxuLyohXHJcbiAqIGpRdWVyeSBVSSBXaWRnZXQgMS4xMS40XHJcbiAqIGh0dHA6Ly9qcXVlcnl1aS5jb21cclxuICpcclxuICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnNcclxuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxyXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXHJcbiAqXHJcbiAqIGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2pRdWVyeS53aWRnZXQvXHJcbiAqL1xyXG5cclxuXHJcbnZhciB3aWRnZXRfdXVpZCA9IDAsXHJcblx0d2lkZ2V0X3NsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlO1xyXG5cclxuJC5jbGVhbkRhdGEgPSAoZnVuY3Rpb24oIG9yaWcgKSB7XHJcblx0cmV0dXJuIGZ1bmN0aW9uKCBlbGVtcyApIHtcclxuXHRcdHZhciBldmVudHMsIGVsZW0sIGk7XHJcblx0XHRmb3IgKCBpID0gMDsgKGVsZW0gPSBlbGVtc1tpXSkgIT0gbnVsbDsgaSsrICkge1xyXG5cdFx0XHR0cnkge1xyXG5cclxuXHRcdFx0XHQvLyBPbmx5IHRyaWdnZXIgcmVtb3ZlIHdoZW4gbmVjZXNzYXJ5IHRvIHNhdmUgdGltZVxyXG5cdFx0XHRcdGV2ZW50cyA9ICQuX2RhdGEoIGVsZW0sIFwiZXZlbnRzXCIgKTtcclxuXHRcdFx0XHRpZiAoIGV2ZW50cyAmJiBldmVudHMucmVtb3ZlICkge1xyXG5cdFx0XHRcdFx0JCggZWxlbSApLnRyaWdnZXJIYW5kbGVyKCBcInJlbW92ZVwiICk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gaHR0cDovL2J1Z3MuanF1ZXJ5LmNvbS90aWNrZXQvODIzNVxyXG5cdFx0XHR9IGNhdGNoICggZSApIHt9XHJcblx0XHR9XHJcblx0XHRvcmlnKCBlbGVtcyApO1xyXG5cdH07XHJcbn0pKCAkLmNsZWFuRGF0YSApO1xyXG5cclxuJC53aWRnZXQgPSBmdW5jdGlvbiggbmFtZSwgYmFzZSwgcHJvdG90eXBlICkge1xyXG5cdHZhciBmdWxsTmFtZSwgZXhpc3RpbmdDb25zdHJ1Y3RvciwgY29uc3RydWN0b3IsIGJhc2VQcm90b3R5cGUsXHJcblx0XHQvLyBwcm94aWVkUHJvdG90eXBlIGFsbG93cyB0aGUgcHJvdmlkZWQgcHJvdG90eXBlIHRvIHJlbWFpbiB1bm1vZGlmaWVkXHJcblx0XHQvLyBzbyB0aGF0IGl0IGNhbiBiZSB1c2VkIGFzIGEgbWl4aW4gZm9yIG11bHRpcGxlIHdpZGdldHMgKCM4ODc2KVxyXG5cdFx0cHJveGllZFByb3RvdHlwZSA9IHt9LFxyXG5cdFx0bmFtZXNwYWNlID0gbmFtZS5zcGxpdCggXCIuXCIgKVsgMCBdO1xyXG5cclxuXHRuYW1lID0gbmFtZS5zcGxpdCggXCIuXCIgKVsgMSBdO1xyXG5cdGZ1bGxOYW1lID0gbmFtZXNwYWNlICsgXCItXCIgKyBuYW1lO1xyXG5cclxuXHRpZiAoICFwcm90b3R5cGUgKSB7XHJcblx0XHRwcm90b3R5cGUgPSBiYXNlO1xyXG5cdFx0YmFzZSA9ICQuV2lkZ2V0O1xyXG5cdH1cclxuXHJcblx0Ly8gY3JlYXRlIHNlbGVjdG9yIGZvciBwbHVnaW5cclxuXHQkLmV4cHJbIFwiOlwiIF1bIGZ1bGxOYW1lLnRvTG93ZXJDYXNlKCkgXSA9IGZ1bmN0aW9uKCBlbGVtICkge1xyXG5cdFx0cmV0dXJuICEhJC5kYXRhKCBlbGVtLCBmdWxsTmFtZSApO1xyXG5cdH07XHJcblxyXG5cdCRbIG5hbWVzcGFjZSBdID0gJFsgbmFtZXNwYWNlIF0gfHwge307XHJcblx0ZXhpc3RpbmdDb25zdHJ1Y3RvciA9ICRbIG5hbWVzcGFjZSBdWyBuYW1lIF07XHJcblx0Y29uc3RydWN0b3IgPSAkWyBuYW1lc3BhY2UgXVsgbmFtZSBdID0gZnVuY3Rpb24oIG9wdGlvbnMsIGVsZW1lbnQgKSB7XHJcblx0XHQvLyBhbGxvdyBpbnN0YW50aWF0aW9uIHdpdGhvdXQgXCJuZXdcIiBrZXl3b3JkXHJcblx0XHRpZiAoICF0aGlzLl9jcmVhdGVXaWRnZXQgKSB7XHJcblx0XHRcdHJldHVybiBuZXcgY29uc3RydWN0b3IoIG9wdGlvbnMsIGVsZW1lbnQgKTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBhbGxvdyBpbnN0YW50aWF0aW9uIHdpdGhvdXQgaW5pdGlhbGl6aW5nIGZvciBzaW1wbGUgaW5oZXJpdGFuY2VcclxuXHRcdC8vIG11c3QgdXNlIFwibmV3XCIga2V5d29yZCAodGhlIGNvZGUgYWJvdmUgYWx3YXlzIHBhc3NlcyBhcmdzKVxyXG5cdFx0aWYgKCBhcmd1bWVudHMubGVuZ3RoICkge1xyXG5cdFx0XHR0aGlzLl9jcmVhdGVXaWRnZXQoIG9wdGlvbnMsIGVsZW1lbnQgKTtcclxuXHRcdH1cclxuXHR9O1xyXG5cdC8vIGV4dGVuZCB3aXRoIHRoZSBleGlzdGluZyBjb25zdHJ1Y3RvciB0byBjYXJyeSBvdmVyIGFueSBzdGF0aWMgcHJvcGVydGllc1xyXG5cdCQuZXh0ZW5kKCBjb25zdHJ1Y3RvciwgZXhpc3RpbmdDb25zdHJ1Y3Rvciwge1xyXG5cdFx0dmVyc2lvbjogcHJvdG90eXBlLnZlcnNpb24sXHJcblx0XHQvLyBjb3B5IHRoZSBvYmplY3QgdXNlZCB0byBjcmVhdGUgdGhlIHByb3RvdHlwZSBpbiBjYXNlIHdlIG5lZWQgdG9cclxuXHRcdC8vIHJlZGVmaW5lIHRoZSB3aWRnZXQgbGF0ZXJcclxuXHRcdF9wcm90bzogJC5leHRlbmQoIHt9LCBwcm90b3R5cGUgKSxcclxuXHRcdC8vIHRyYWNrIHdpZGdldHMgdGhhdCBpbmhlcml0IGZyb20gdGhpcyB3aWRnZXQgaW4gY2FzZSB0aGlzIHdpZGdldCBpc1xyXG5cdFx0Ly8gcmVkZWZpbmVkIGFmdGVyIGEgd2lkZ2V0IGluaGVyaXRzIGZyb20gaXRcclxuXHRcdF9jaGlsZENvbnN0cnVjdG9yczogW11cclxuXHR9KTtcclxuXHJcblx0YmFzZVByb3RvdHlwZSA9IG5ldyBiYXNlKCk7XHJcblx0Ly8gd2UgbmVlZCB0byBtYWtlIHRoZSBvcHRpb25zIGhhc2ggYSBwcm9wZXJ0eSBkaXJlY3RseSBvbiB0aGUgbmV3IGluc3RhbmNlXHJcblx0Ly8gb3RoZXJ3aXNlIHdlJ2xsIG1vZGlmeSB0aGUgb3B0aW9ucyBoYXNoIG9uIHRoZSBwcm90b3R5cGUgdGhhdCB3ZSdyZVxyXG5cdC8vIGluaGVyaXRpbmcgZnJvbVxyXG5cdGJhc2VQcm90b3R5cGUub3B0aW9ucyA9ICQud2lkZ2V0LmV4dGVuZCgge30sIGJhc2VQcm90b3R5cGUub3B0aW9ucyApO1xyXG5cdCQuZWFjaCggcHJvdG90eXBlLCBmdW5jdGlvbiggcHJvcCwgdmFsdWUgKSB7XHJcblx0XHRpZiAoICEkLmlzRnVuY3Rpb24oIHZhbHVlICkgKSB7XHJcblx0XHRcdHByb3hpZWRQcm90b3R5cGVbIHByb3AgXSA9IHZhbHVlO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHRwcm94aWVkUHJvdG90eXBlWyBwcm9wIF0gPSAoZnVuY3Rpb24oKSB7XHJcblx0XHRcdHZhciBfc3VwZXIgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdHJldHVybiBiYXNlLnByb3RvdHlwZVsgcHJvcCBdLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTtcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdF9zdXBlckFwcGx5ID0gZnVuY3Rpb24oIGFyZ3MgKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gYmFzZS5wcm90b3R5cGVbIHByb3AgXS5hcHBseSggdGhpcywgYXJncyApO1xyXG5cdFx0XHRcdH07XHJcblx0XHRcdHJldHVybiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHR2YXIgX19zdXBlciA9IHRoaXMuX3N1cGVyLFxyXG5cdFx0XHRcdFx0X19zdXBlckFwcGx5ID0gdGhpcy5fc3VwZXJBcHBseSxcclxuXHRcdFx0XHRcdHJldHVyblZhbHVlO1xyXG5cclxuXHRcdFx0XHR0aGlzLl9zdXBlciA9IF9zdXBlcjtcclxuXHRcdFx0XHR0aGlzLl9zdXBlckFwcGx5ID0gX3N1cGVyQXBwbHk7XHJcblxyXG5cdFx0XHRcdHJldHVyblZhbHVlID0gdmFsdWUuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApO1xyXG5cclxuXHRcdFx0XHR0aGlzLl9zdXBlciA9IF9fc3VwZXI7XHJcblx0XHRcdFx0dGhpcy5fc3VwZXJBcHBseSA9IF9fc3VwZXJBcHBseTtcclxuXHJcblx0XHRcdFx0cmV0dXJuIHJldHVyblZhbHVlO1xyXG5cdFx0XHR9O1xyXG5cdFx0fSkoKTtcclxuXHR9KTtcclxuXHRjb25zdHJ1Y3Rvci5wcm90b3R5cGUgPSAkLndpZGdldC5leHRlbmQoIGJhc2VQcm90b3R5cGUsIHtcclxuXHRcdC8vIFRPRE86IHJlbW92ZSBzdXBwb3J0IGZvciB3aWRnZXRFdmVudFByZWZpeFxyXG5cdFx0Ly8gYWx3YXlzIHVzZSB0aGUgbmFtZSArIGEgY29sb24gYXMgdGhlIHByZWZpeCwgZS5nLiwgZHJhZ2dhYmxlOnN0YXJ0XHJcblx0XHQvLyBkb24ndCBwcmVmaXggZm9yIHdpZGdldHMgdGhhdCBhcmVuJ3QgRE9NLWJhc2VkXHJcblx0XHR3aWRnZXRFdmVudFByZWZpeDogZXhpc3RpbmdDb25zdHJ1Y3RvciA/IChiYXNlUHJvdG90eXBlLndpZGdldEV2ZW50UHJlZml4IHx8IG5hbWUpIDogbmFtZVxyXG5cdH0sIHByb3hpZWRQcm90b3R5cGUsIHtcclxuXHRcdGNvbnN0cnVjdG9yOiBjb25zdHJ1Y3RvcixcclxuXHRcdG5hbWVzcGFjZTogbmFtZXNwYWNlLFxyXG5cdFx0d2lkZ2V0TmFtZTogbmFtZSxcclxuXHRcdHdpZGdldEZ1bGxOYW1lOiBmdWxsTmFtZVxyXG5cdH0pO1xyXG5cclxuXHQvLyBJZiB0aGlzIHdpZGdldCBpcyBiZWluZyByZWRlZmluZWQgdGhlbiB3ZSBuZWVkIHRvIGZpbmQgYWxsIHdpZGdldHMgdGhhdFxyXG5cdC8vIGFyZSBpbmhlcml0aW5nIGZyb20gaXQgYW5kIHJlZGVmaW5lIGFsbCBvZiB0aGVtIHNvIHRoYXQgdGhleSBpbmhlcml0IGZyb21cclxuXHQvLyB0aGUgbmV3IHZlcnNpb24gb2YgdGhpcyB3aWRnZXQuIFdlJ3JlIGVzc2VudGlhbGx5IHRyeWluZyB0byByZXBsYWNlIG9uZVxyXG5cdC8vIGxldmVsIGluIHRoZSBwcm90b3R5cGUgY2hhaW4uXHJcblx0aWYgKCBleGlzdGluZ0NvbnN0cnVjdG9yICkge1xyXG5cdFx0JC5lYWNoKCBleGlzdGluZ0NvbnN0cnVjdG9yLl9jaGlsZENvbnN0cnVjdG9ycywgZnVuY3Rpb24oIGksIGNoaWxkICkge1xyXG5cdFx0XHR2YXIgY2hpbGRQcm90b3R5cGUgPSBjaGlsZC5wcm90b3R5cGU7XHJcblxyXG5cdFx0XHQvLyByZWRlZmluZSB0aGUgY2hpbGQgd2lkZ2V0IHVzaW5nIHRoZSBzYW1lIHByb3RvdHlwZSB0aGF0IHdhc1xyXG5cdFx0XHQvLyBvcmlnaW5hbGx5IHVzZWQsIGJ1dCBpbmhlcml0IGZyb20gdGhlIG5ldyB2ZXJzaW9uIG9mIHRoZSBiYXNlXHJcblx0XHRcdCQud2lkZ2V0KCBjaGlsZFByb3RvdHlwZS5uYW1lc3BhY2UgKyBcIi5cIiArIGNoaWxkUHJvdG90eXBlLndpZGdldE5hbWUsIGNvbnN0cnVjdG9yLCBjaGlsZC5fcHJvdG8gKTtcclxuXHRcdH0pO1xyXG5cdFx0Ly8gcmVtb3ZlIHRoZSBsaXN0IG9mIGV4aXN0aW5nIGNoaWxkIGNvbnN0cnVjdG9ycyBmcm9tIHRoZSBvbGQgY29uc3RydWN0b3JcclxuXHRcdC8vIHNvIHRoZSBvbGQgY2hpbGQgY29uc3RydWN0b3JzIGNhbiBiZSBnYXJiYWdlIGNvbGxlY3RlZFxyXG5cdFx0ZGVsZXRlIGV4aXN0aW5nQ29uc3RydWN0b3IuX2NoaWxkQ29uc3RydWN0b3JzO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRiYXNlLl9jaGlsZENvbnN0cnVjdG9ycy5wdXNoKCBjb25zdHJ1Y3RvciApO1xyXG5cdH1cclxuXHJcblx0JC53aWRnZXQuYnJpZGdlKCBuYW1lLCBjb25zdHJ1Y3RvciApO1xyXG5cclxuXHRyZXR1cm4gY29uc3RydWN0b3I7XHJcbn07XHJcblxyXG4kLndpZGdldC5leHRlbmQgPSBmdW5jdGlvbiggdGFyZ2V0ICkge1xyXG5cdHZhciBpbnB1dCA9IHdpZGdldF9zbGljZS5jYWxsKCBhcmd1bWVudHMsIDEgKSxcclxuXHRcdGlucHV0SW5kZXggPSAwLFxyXG5cdFx0aW5wdXRMZW5ndGggPSBpbnB1dC5sZW5ndGgsXHJcblx0XHRrZXksXHJcblx0XHR2YWx1ZTtcclxuXHRmb3IgKCA7IGlucHV0SW5kZXggPCBpbnB1dExlbmd0aDsgaW5wdXRJbmRleCsrICkge1xyXG5cdFx0Zm9yICgga2V5IGluIGlucHV0WyBpbnB1dEluZGV4IF0gKSB7XHJcblx0XHRcdHZhbHVlID0gaW5wdXRbIGlucHV0SW5kZXggXVsga2V5IF07XHJcblx0XHRcdGlmICggaW5wdXRbIGlucHV0SW5kZXggXS5oYXNPd25Qcm9wZXJ0eSgga2V5ICkgJiYgdmFsdWUgIT09IHVuZGVmaW5lZCApIHtcclxuXHRcdFx0XHQvLyBDbG9uZSBvYmplY3RzXHJcblx0XHRcdFx0aWYgKCAkLmlzUGxhaW5PYmplY3QoIHZhbHVlICkgKSB7XHJcblx0XHRcdFx0XHR0YXJnZXRbIGtleSBdID0gJC5pc1BsYWluT2JqZWN0KCB0YXJnZXRbIGtleSBdICkgP1xyXG5cdFx0XHRcdFx0XHQkLndpZGdldC5leHRlbmQoIHt9LCB0YXJnZXRbIGtleSBdLCB2YWx1ZSApIDpcclxuXHRcdFx0XHRcdFx0Ly8gRG9uJ3QgZXh0ZW5kIHN0cmluZ3MsIGFycmF5cywgZXRjLiB3aXRoIG9iamVjdHNcclxuXHRcdFx0XHRcdFx0JC53aWRnZXQuZXh0ZW5kKCB7fSwgdmFsdWUgKTtcclxuXHRcdFx0XHQvLyBDb3B5IGV2ZXJ5dGhpbmcgZWxzZSBieSByZWZlcmVuY2VcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0dGFyZ2V0WyBrZXkgXSA9IHZhbHVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHRyZXR1cm4gdGFyZ2V0O1xyXG59O1xyXG5cclxuJC53aWRnZXQuYnJpZGdlID0gZnVuY3Rpb24oIG5hbWUsIG9iamVjdCApIHtcclxuXHR2YXIgZnVsbE5hbWUgPSBvYmplY3QucHJvdG90eXBlLndpZGdldEZ1bGxOYW1lIHx8IG5hbWU7XHJcblx0JC5mblsgbmFtZSBdID0gZnVuY3Rpb24oIG9wdGlvbnMgKSB7XHJcblx0XHR2YXIgaXNNZXRob2RDYWxsID0gdHlwZW9mIG9wdGlvbnMgPT09IFwic3RyaW5nXCIsXHJcblx0XHRcdGFyZ3MgPSB3aWRnZXRfc2xpY2UuY2FsbCggYXJndW1lbnRzLCAxICksXHJcblx0XHRcdHJldHVyblZhbHVlID0gdGhpcztcclxuXHJcblx0XHRpZiAoIGlzTWV0aG9kQ2FsbCApIHtcclxuXHRcdFx0dGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHZhciBtZXRob2RWYWx1ZSxcclxuXHRcdFx0XHRcdGluc3RhbmNlID0gJC5kYXRhKCB0aGlzLCBmdWxsTmFtZSApO1xyXG5cdFx0XHRcdGlmICggb3B0aW9ucyA9PT0gXCJpbnN0YW5jZVwiICkge1xyXG5cdFx0XHRcdFx0cmV0dXJuVmFsdWUgPSBpbnN0YW5jZTtcclxuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKCAhaW5zdGFuY2UgKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gJC5lcnJvciggXCJjYW5ub3QgY2FsbCBtZXRob2RzIG9uIFwiICsgbmFtZSArIFwiIHByaW9yIHRvIGluaXRpYWxpemF0aW9uOyBcIiArXHJcblx0XHRcdFx0XHRcdFwiYXR0ZW1wdGVkIHRvIGNhbGwgbWV0aG9kICdcIiArIG9wdGlvbnMgKyBcIidcIiApO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoICEkLmlzRnVuY3Rpb24oIGluc3RhbmNlW29wdGlvbnNdICkgfHwgb3B0aW9ucy5jaGFyQXQoIDAgKSA9PT0gXCJfXCIgKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gJC5lcnJvciggXCJubyBzdWNoIG1ldGhvZCAnXCIgKyBvcHRpb25zICsgXCInIGZvciBcIiArIG5hbWUgKyBcIiB3aWRnZXQgaW5zdGFuY2VcIiApO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRtZXRob2RWYWx1ZSA9IGluc3RhbmNlWyBvcHRpb25zIF0uYXBwbHkoIGluc3RhbmNlLCBhcmdzICk7XHJcblx0XHRcdFx0aWYgKCBtZXRob2RWYWx1ZSAhPT0gaW5zdGFuY2UgJiYgbWV0aG9kVmFsdWUgIT09IHVuZGVmaW5lZCApIHtcclxuXHRcdFx0XHRcdHJldHVyblZhbHVlID0gbWV0aG9kVmFsdWUgJiYgbWV0aG9kVmFsdWUuanF1ZXJ5ID9cclxuXHRcdFx0XHRcdFx0cmV0dXJuVmFsdWUucHVzaFN0YWNrKCBtZXRob2RWYWx1ZS5nZXQoKSApIDpcclxuXHRcdFx0XHRcdFx0bWV0aG9kVmFsdWU7XHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH0gZWxzZSB7XHJcblxyXG5cdFx0XHQvLyBBbGxvdyBtdWx0aXBsZSBoYXNoZXMgdG8gYmUgcGFzc2VkIG9uIGluaXRcclxuXHRcdFx0aWYgKCBhcmdzLmxlbmd0aCApIHtcclxuXHRcdFx0XHRvcHRpb25zID0gJC53aWRnZXQuZXh0ZW5kLmFwcGx5KCBudWxsLCBbIG9wdGlvbnMgXS5jb25jYXQoYXJncykgKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0dGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHZhciBpbnN0YW5jZSA9ICQuZGF0YSggdGhpcywgZnVsbE5hbWUgKTtcclxuXHRcdFx0XHRpZiAoIGluc3RhbmNlICkge1xyXG5cdFx0XHRcdFx0aW5zdGFuY2Uub3B0aW9uKCBvcHRpb25zIHx8IHt9ICk7XHJcblx0XHRcdFx0XHRpZiAoIGluc3RhbmNlLl9pbml0ICkge1xyXG5cdFx0XHRcdFx0XHRpbnN0YW5jZS5faW5pdCgpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHQkLmRhdGEoIHRoaXMsIGZ1bGxOYW1lLCBuZXcgb2JqZWN0KCBvcHRpb25zLCB0aGlzICkgKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiByZXR1cm5WYWx1ZTtcclxuXHR9O1xyXG59O1xyXG5cclxuJC5XaWRnZXQgPSBmdW5jdGlvbiggLyogb3B0aW9ucywgZWxlbWVudCAqLyApIHt9O1xyXG4kLldpZGdldC5fY2hpbGRDb25zdHJ1Y3RvcnMgPSBbXTtcclxuXHJcbiQuV2lkZ2V0LnByb3RvdHlwZSA9IHtcclxuXHR3aWRnZXROYW1lOiBcIndpZGdldFwiLFxyXG5cdHdpZGdldEV2ZW50UHJlZml4OiBcIlwiLFxyXG5cdGRlZmF1bHRFbGVtZW50OiBcIjxkaXY+XCIsXHJcblx0b3B0aW9uczoge1xyXG5cdFx0ZGlzYWJsZWQ6IGZhbHNlLFxyXG5cclxuXHRcdC8vIGNhbGxiYWNrc1xyXG5cdFx0Y3JlYXRlOiBudWxsXHJcblx0fSxcclxuXHRfY3JlYXRlV2lkZ2V0OiBmdW5jdGlvbiggb3B0aW9ucywgZWxlbWVudCApIHtcclxuXHRcdGVsZW1lbnQgPSAkKCBlbGVtZW50IHx8IHRoaXMuZGVmYXVsdEVsZW1lbnQgfHwgdGhpcyApWyAwIF07XHJcblx0XHR0aGlzLmVsZW1lbnQgPSAkKCBlbGVtZW50ICk7XHJcblx0XHR0aGlzLnV1aWQgPSB3aWRnZXRfdXVpZCsrO1xyXG5cdFx0dGhpcy5ldmVudE5hbWVzcGFjZSA9IFwiLlwiICsgdGhpcy53aWRnZXROYW1lICsgdGhpcy51dWlkO1xyXG5cclxuXHRcdHRoaXMuYmluZGluZ3MgPSAkKCk7XHJcblx0XHR0aGlzLmhvdmVyYWJsZSA9ICQoKTtcclxuXHRcdHRoaXMuZm9jdXNhYmxlID0gJCgpO1xyXG5cclxuXHRcdGlmICggZWxlbWVudCAhPT0gdGhpcyApIHtcclxuXHRcdFx0JC5kYXRhKCBlbGVtZW50LCB0aGlzLndpZGdldEZ1bGxOYW1lLCB0aGlzICk7XHJcblx0XHRcdHRoaXMuX29uKCB0cnVlLCB0aGlzLmVsZW1lbnQsIHtcclxuXHRcdFx0XHRyZW1vdmU6IGZ1bmN0aW9uKCBldmVudCApIHtcclxuXHRcdFx0XHRcdGlmICggZXZlbnQudGFyZ2V0ID09PSBlbGVtZW50ICkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLmRlc3Ryb3koKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHR0aGlzLmRvY3VtZW50ID0gJCggZWxlbWVudC5zdHlsZSA/XHJcblx0XHRcdFx0Ly8gZWxlbWVudCB3aXRoaW4gdGhlIGRvY3VtZW50XHJcblx0XHRcdFx0ZWxlbWVudC5vd25lckRvY3VtZW50IDpcclxuXHRcdFx0XHQvLyBlbGVtZW50IGlzIHdpbmRvdyBvciBkb2N1bWVudFxyXG5cdFx0XHRcdGVsZW1lbnQuZG9jdW1lbnQgfHwgZWxlbWVudCApO1xyXG5cdFx0XHR0aGlzLndpbmRvdyA9ICQoIHRoaXMuZG9jdW1lbnRbMF0uZGVmYXVsdFZpZXcgfHwgdGhpcy5kb2N1bWVudFswXS5wYXJlbnRXaW5kb3cgKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLm9wdGlvbnMgPSAkLndpZGdldC5leHRlbmQoIHt9LFxyXG5cdFx0XHR0aGlzLm9wdGlvbnMsXHJcblx0XHRcdHRoaXMuX2dldENyZWF0ZU9wdGlvbnMoKSxcclxuXHRcdFx0b3B0aW9ucyApO1xyXG5cclxuXHRcdHRoaXMuX2NyZWF0ZSgpO1xyXG5cdFx0dGhpcy5fdHJpZ2dlciggXCJjcmVhdGVcIiwgbnVsbCwgdGhpcy5fZ2V0Q3JlYXRlRXZlbnREYXRhKCkgKTtcclxuXHRcdHRoaXMuX2luaXQoKTtcclxuXHR9LFxyXG5cdF9nZXRDcmVhdGVPcHRpb25zOiAkLm5vb3AsXHJcblx0X2dldENyZWF0ZUV2ZW50RGF0YTogJC5ub29wLFxyXG5cdF9jcmVhdGU6ICQubm9vcCxcclxuXHRfaW5pdDogJC5ub29wLFxyXG5cclxuXHRkZXN0cm95OiBmdW5jdGlvbigpIHtcclxuXHRcdHRoaXMuX2Rlc3Ryb3koKTtcclxuXHRcdC8vIHdlIGNhbiBwcm9iYWJseSByZW1vdmUgdGhlIHVuYmluZCBjYWxscyBpbiAyLjBcclxuXHRcdC8vIGFsbCBldmVudCBiaW5kaW5ncyBzaG91bGQgZ28gdGhyb3VnaCB0aGlzLl9vbigpXHJcblx0XHR0aGlzLmVsZW1lbnRcclxuXHRcdFx0LnVuYmluZCggdGhpcy5ldmVudE5hbWVzcGFjZSApXHJcblx0XHRcdC5yZW1vdmVEYXRhKCB0aGlzLndpZGdldEZ1bGxOYW1lIClcclxuXHRcdFx0Ly8gc3VwcG9ydDoganF1ZXJ5IDwxLjYuM1xyXG5cdFx0XHQvLyBodHRwOi8vYnVncy5qcXVlcnkuY29tL3RpY2tldC85NDEzXHJcblx0XHRcdC5yZW1vdmVEYXRhKCAkLmNhbWVsQ2FzZSggdGhpcy53aWRnZXRGdWxsTmFtZSApICk7XHJcblx0XHR0aGlzLndpZGdldCgpXHJcblx0XHRcdC51bmJpbmQoIHRoaXMuZXZlbnROYW1lc3BhY2UgKVxyXG5cdFx0XHQucmVtb3ZlQXR0ciggXCJhcmlhLWRpc2FibGVkXCIgKVxyXG5cdFx0XHQucmVtb3ZlQ2xhc3MoXHJcblx0XHRcdFx0dGhpcy53aWRnZXRGdWxsTmFtZSArIFwiLWRpc2FibGVkIFwiICtcclxuXHRcdFx0XHRcInVpLXN0YXRlLWRpc2FibGVkXCIgKTtcclxuXHJcblx0XHQvLyBjbGVhbiB1cCBldmVudHMgYW5kIHN0YXRlc1xyXG5cdFx0dGhpcy5iaW5kaW5ncy51bmJpbmQoIHRoaXMuZXZlbnROYW1lc3BhY2UgKTtcclxuXHRcdHRoaXMuaG92ZXJhYmxlLnJlbW92ZUNsYXNzKCBcInVpLXN0YXRlLWhvdmVyXCIgKTtcclxuXHRcdHRoaXMuZm9jdXNhYmxlLnJlbW92ZUNsYXNzKCBcInVpLXN0YXRlLWZvY3VzXCIgKTtcclxuXHR9LFxyXG5cdF9kZXN0cm95OiAkLm5vb3AsXHJcblxyXG5cdHdpZGdldDogZnVuY3Rpb24oKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5lbGVtZW50O1xyXG5cdH0sXHJcblxyXG5cdG9wdGlvbjogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7XHJcblx0XHR2YXIgb3B0aW9ucyA9IGtleSxcclxuXHRcdFx0cGFydHMsXHJcblx0XHRcdGN1ck9wdGlvbixcclxuXHRcdFx0aTtcclxuXHJcblx0XHRpZiAoIGFyZ3VtZW50cy5sZW5ndGggPT09IDAgKSB7XHJcblx0XHRcdC8vIGRvbid0IHJldHVybiBhIHJlZmVyZW5jZSB0byB0aGUgaW50ZXJuYWwgaGFzaFxyXG5cdFx0XHRyZXR1cm4gJC53aWRnZXQuZXh0ZW5kKCB7fSwgdGhpcy5vcHRpb25zICk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKCB0eXBlb2Yga2V5ID09PSBcInN0cmluZ1wiICkge1xyXG5cdFx0XHQvLyBoYW5kbGUgbmVzdGVkIGtleXMsIGUuZy4sIFwiZm9vLmJhclwiID0+IHsgZm9vOiB7IGJhcjogX19fIH0gfVxyXG5cdFx0XHRvcHRpb25zID0ge307XHJcblx0XHRcdHBhcnRzID0ga2V5LnNwbGl0KCBcIi5cIiApO1xyXG5cdFx0XHRrZXkgPSBwYXJ0cy5zaGlmdCgpO1xyXG5cdFx0XHRpZiAoIHBhcnRzLmxlbmd0aCApIHtcclxuXHRcdFx0XHRjdXJPcHRpb24gPSBvcHRpb25zWyBrZXkgXSA9ICQud2lkZ2V0LmV4dGVuZCgge30sIHRoaXMub3B0aW9uc1sga2V5IF0gKTtcclxuXHRcdFx0XHRmb3IgKCBpID0gMDsgaSA8IHBhcnRzLmxlbmd0aCAtIDE7IGkrKyApIHtcclxuXHRcdFx0XHRcdGN1ck9wdGlvblsgcGFydHNbIGkgXSBdID0gY3VyT3B0aW9uWyBwYXJ0c1sgaSBdIF0gfHwge307XHJcblx0XHRcdFx0XHRjdXJPcHRpb24gPSBjdXJPcHRpb25bIHBhcnRzWyBpIF0gXTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0a2V5ID0gcGFydHMucG9wKCk7XHJcblx0XHRcdFx0aWYgKCBhcmd1bWVudHMubGVuZ3RoID09PSAxICkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGN1ck9wdGlvblsga2V5IF0gPT09IHVuZGVmaW5lZCA/IG51bGwgOiBjdXJPcHRpb25bIGtleSBdO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRjdXJPcHRpb25bIGtleSBdID0gdmFsdWU7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0aWYgKCBhcmd1bWVudHMubGVuZ3RoID09PSAxICkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIHRoaXMub3B0aW9uc1sga2V5IF0gPT09IHVuZGVmaW5lZCA/IG51bGwgOiB0aGlzLm9wdGlvbnNbIGtleSBdO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRvcHRpb25zWyBrZXkgXSA9IHZhbHVlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fc2V0T3B0aW9ucyggb3B0aW9ucyApO1xyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblx0X3NldE9wdGlvbnM6IGZ1bmN0aW9uKCBvcHRpb25zICkge1xyXG5cdFx0dmFyIGtleTtcclxuXHJcblx0XHRmb3IgKCBrZXkgaW4gb3B0aW9ucyApIHtcclxuXHRcdFx0dGhpcy5fc2V0T3B0aW9uKCBrZXksIG9wdGlvbnNbIGtleSBdICk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHRfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcclxuXHRcdHRoaXMub3B0aW9uc1sga2V5IF0gPSB2YWx1ZTtcclxuXHJcblx0XHRpZiAoIGtleSA9PT0gXCJkaXNhYmxlZFwiICkge1xyXG5cdFx0XHR0aGlzLndpZGdldCgpXHJcblx0XHRcdFx0LnRvZ2dsZUNsYXNzKCB0aGlzLndpZGdldEZ1bGxOYW1lICsgXCItZGlzYWJsZWRcIiwgISF2YWx1ZSApO1xyXG5cclxuXHRcdFx0Ly8gSWYgdGhlIHdpZGdldCBpcyBiZWNvbWluZyBkaXNhYmxlZCwgdGhlbiBub3RoaW5nIGlzIGludGVyYWN0aXZlXHJcblx0XHRcdGlmICggdmFsdWUgKSB7XHJcblx0XHRcdFx0dGhpcy5ob3ZlcmFibGUucmVtb3ZlQ2xhc3MoIFwidWktc3RhdGUtaG92ZXJcIiApO1xyXG5cdFx0XHRcdHRoaXMuZm9jdXNhYmxlLnJlbW92ZUNsYXNzKCBcInVpLXN0YXRlLWZvY3VzXCIgKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdGVuYWJsZTogZnVuY3Rpb24oKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5fc2V0T3B0aW9ucyh7IGRpc2FibGVkOiBmYWxzZSB9KTtcclxuXHR9LFxyXG5cdGRpc2FibGU6IGZ1bmN0aW9uKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX3NldE9wdGlvbnMoeyBkaXNhYmxlZDogdHJ1ZSB9KTtcclxuXHR9LFxyXG5cclxuXHRfb246IGZ1bmN0aW9uKCBzdXBwcmVzc0Rpc2FibGVkQ2hlY2ssIGVsZW1lbnQsIGhhbmRsZXJzICkge1xyXG5cdFx0dmFyIGRlbGVnYXRlRWxlbWVudCxcclxuXHRcdFx0aW5zdGFuY2UgPSB0aGlzO1xyXG5cclxuXHRcdC8vIG5vIHN1cHByZXNzRGlzYWJsZWRDaGVjayBmbGFnLCBzaHVmZmxlIGFyZ3VtZW50c1xyXG5cdFx0aWYgKCB0eXBlb2Ygc3VwcHJlc3NEaXNhYmxlZENoZWNrICE9PSBcImJvb2xlYW5cIiApIHtcclxuXHRcdFx0aGFuZGxlcnMgPSBlbGVtZW50O1xyXG5cdFx0XHRlbGVtZW50ID0gc3VwcHJlc3NEaXNhYmxlZENoZWNrO1xyXG5cdFx0XHRzdXBwcmVzc0Rpc2FibGVkQ2hlY2sgPSBmYWxzZTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBubyBlbGVtZW50IGFyZ3VtZW50LCBzaHVmZmxlIGFuZCB1c2UgdGhpcy5lbGVtZW50XHJcblx0XHRpZiAoICFoYW5kbGVycyApIHtcclxuXHRcdFx0aGFuZGxlcnMgPSBlbGVtZW50O1xyXG5cdFx0XHRlbGVtZW50ID0gdGhpcy5lbGVtZW50O1xyXG5cdFx0XHRkZWxlZ2F0ZUVsZW1lbnQgPSB0aGlzLndpZGdldCgpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0ZWxlbWVudCA9IGRlbGVnYXRlRWxlbWVudCA9ICQoIGVsZW1lbnQgKTtcclxuXHRcdFx0dGhpcy5iaW5kaW5ncyA9IHRoaXMuYmluZGluZ3MuYWRkKCBlbGVtZW50ICk7XHJcblx0XHR9XHJcblxyXG5cdFx0JC5lYWNoKCBoYW5kbGVycywgZnVuY3Rpb24oIGV2ZW50LCBoYW5kbGVyICkge1xyXG5cdFx0XHRmdW5jdGlvbiBoYW5kbGVyUHJveHkoKSB7XHJcblx0XHRcdFx0Ly8gYWxsb3cgd2lkZ2V0cyB0byBjdXN0b21pemUgdGhlIGRpc2FibGVkIGhhbmRsaW5nXHJcblx0XHRcdFx0Ly8gLSBkaXNhYmxlZCBhcyBhbiBhcnJheSBpbnN0ZWFkIG9mIGJvb2xlYW5cclxuXHRcdFx0XHQvLyAtIGRpc2FibGVkIGNsYXNzIGFzIG1ldGhvZCBmb3IgZGlzYWJsaW5nIGluZGl2aWR1YWwgcGFydHNcclxuXHRcdFx0XHRpZiAoICFzdXBwcmVzc0Rpc2FibGVkQ2hlY2sgJiZcclxuXHRcdFx0XHRcdFx0KCBpbnN0YW5jZS5vcHRpb25zLmRpc2FibGVkID09PSB0cnVlIHx8XHJcblx0XHRcdFx0XHRcdFx0JCggdGhpcyApLmhhc0NsYXNzKCBcInVpLXN0YXRlLWRpc2FibGVkXCIgKSApICkge1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZXR1cm4gKCB0eXBlb2YgaGFuZGxlciA9PT0gXCJzdHJpbmdcIiA/IGluc3RhbmNlWyBoYW5kbGVyIF0gOiBoYW5kbGVyIClcclxuXHRcdFx0XHRcdC5hcHBseSggaW5zdGFuY2UsIGFyZ3VtZW50cyApO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBjb3B5IHRoZSBndWlkIHNvIGRpcmVjdCB1bmJpbmRpbmcgd29ya3NcclxuXHRcdFx0aWYgKCB0eXBlb2YgaGFuZGxlciAhPT0gXCJzdHJpbmdcIiApIHtcclxuXHRcdFx0XHRoYW5kbGVyUHJveHkuZ3VpZCA9IGhhbmRsZXIuZ3VpZCA9XHJcblx0XHRcdFx0XHRoYW5kbGVyLmd1aWQgfHwgaGFuZGxlclByb3h5Lmd1aWQgfHwgJC5ndWlkKys7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHZhciBtYXRjaCA9IGV2ZW50Lm1hdGNoKCAvXihbXFx3Oi1dKilcXHMqKC4qKSQvICksXHJcblx0XHRcdFx0ZXZlbnROYW1lID0gbWF0Y2hbMV0gKyBpbnN0YW5jZS5ldmVudE5hbWVzcGFjZSxcclxuXHRcdFx0XHRzZWxlY3RvciA9IG1hdGNoWzJdO1xyXG5cdFx0XHRpZiAoIHNlbGVjdG9yICkge1xyXG5cdFx0XHRcdGRlbGVnYXRlRWxlbWVudC5kZWxlZ2F0ZSggc2VsZWN0b3IsIGV2ZW50TmFtZSwgaGFuZGxlclByb3h5ICk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0ZWxlbWVudC5iaW5kKCBldmVudE5hbWUsIGhhbmRsZXJQcm94eSApO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cclxuXHRfb2ZmOiBmdW5jdGlvbiggZWxlbWVudCwgZXZlbnROYW1lICkge1xyXG5cdFx0ZXZlbnROYW1lID0gKGV2ZW50TmFtZSB8fCBcIlwiKS5zcGxpdCggXCIgXCIgKS5qb2luKCB0aGlzLmV2ZW50TmFtZXNwYWNlICsgXCIgXCIgKSArXHJcblx0XHRcdHRoaXMuZXZlbnROYW1lc3BhY2U7XHJcblx0XHRlbGVtZW50LnVuYmluZCggZXZlbnROYW1lICkudW5kZWxlZ2F0ZSggZXZlbnROYW1lICk7XHJcblxyXG5cdFx0Ly8gQ2xlYXIgdGhlIHN0YWNrIHRvIGF2b2lkIG1lbW9yeSBsZWFrcyAoIzEwMDU2KVxyXG5cdFx0dGhpcy5iaW5kaW5ncyA9ICQoIHRoaXMuYmluZGluZ3Mubm90KCBlbGVtZW50ICkuZ2V0KCkgKTtcclxuXHRcdHRoaXMuZm9jdXNhYmxlID0gJCggdGhpcy5mb2N1c2FibGUubm90KCBlbGVtZW50ICkuZ2V0KCkgKTtcclxuXHRcdHRoaXMuaG92ZXJhYmxlID0gJCggdGhpcy5ob3ZlcmFibGUubm90KCBlbGVtZW50ICkuZ2V0KCkgKTtcclxuXHR9LFxyXG5cclxuXHRfZGVsYXk6IGZ1bmN0aW9uKCBoYW5kbGVyLCBkZWxheSApIHtcclxuXHRcdGZ1bmN0aW9uIGhhbmRsZXJQcm94eSgpIHtcclxuXHRcdFx0cmV0dXJuICggdHlwZW9mIGhhbmRsZXIgPT09IFwic3RyaW5nXCIgPyBpbnN0YW5jZVsgaGFuZGxlciBdIDogaGFuZGxlciApXHJcblx0XHRcdFx0LmFwcGx5KCBpbnN0YW5jZSwgYXJndW1lbnRzICk7XHJcblx0XHR9XHJcblx0XHR2YXIgaW5zdGFuY2UgPSB0aGlzO1xyXG5cdFx0cmV0dXJuIHNldFRpbWVvdXQoIGhhbmRsZXJQcm94eSwgZGVsYXkgfHwgMCApO1xyXG5cdH0sXHJcblxyXG5cdF9ob3ZlcmFibGU6IGZ1bmN0aW9uKCBlbGVtZW50ICkge1xyXG5cdFx0dGhpcy5ob3ZlcmFibGUgPSB0aGlzLmhvdmVyYWJsZS5hZGQoIGVsZW1lbnQgKTtcclxuXHRcdHRoaXMuX29uKCBlbGVtZW50LCB7XHJcblx0XHRcdG1vdXNlZW50ZXI6IGZ1bmN0aW9uKCBldmVudCApIHtcclxuXHRcdFx0XHQkKCBldmVudC5jdXJyZW50VGFyZ2V0ICkuYWRkQ2xhc3MoIFwidWktc3RhdGUtaG92ZXJcIiApO1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRtb3VzZWxlYXZlOiBmdW5jdGlvbiggZXZlbnQgKSB7XHJcblx0XHRcdFx0JCggZXZlbnQuY3VycmVudFRhcmdldCApLnJlbW92ZUNsYXNzKCBcInVpLXN0YXRlLWhvdmVyXCIgKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fSxcclxuXHJcblx0X2ZvY3VzYWJsZTogZnVuY3Rpb24oIGVsZW1lbnQgKSB7XHJcblx0XHR0aGlzLmZvY3VzYWJsZSA9IHRoaXMuZm9jdXNhYmxlLmFkZCggZWxlbWVudCApO1xyXG5cdFx0dGhpcy5fb24oIGVsZW1lbnQsIHtcclxuXHRcdFx0Zm9jdXNpbjogZnVuY3Rpb24oIGV2ZW50ICkge1xyXG5cdFx0XHRcdCQoIGV2ZW50LmN1cnJlbnRUYXJnZXQgKS5hZGRDbGFzcyggXCJ1aS1zdGF0ZS1mb2N1c1wiICk7XHJcblx0XHRcdH0sXHJcblx0XHRcdGZvY3Vzb3V0OiBmdW5jdGlvbiggZXZlbnQgKSB7XHJcblx0XHRcdFx0JCggZXZlbnQuY3VycmVudFRhcmdldCApLnJlbW92ZUNsYXNzKCBcInVpLXN0YXRlLWZvY3VzXCIgKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fSxcclxuXHJcblx0X3RyaWdnZXI6IGZ1bmN0aW9uKCB0eXBlLCBldmVudCwgZGF0YSApIHtcclxuXHRcdHZhciBwcm9wLCBvcmlnLFxyXG5cdFx0XHRjYWxsYmFjayA9IHRoaXMub3B0aW9uc1sgdHlwZSBdO1xyXG5cclxuXHRcdGRhdGEgPSBkYXRhIHx8IHt9O1xyXG5cdFx0ZXZlbnQgPSAkLkV2ZW50KCBldmVudCApO1xyXG5cdFx0ZXZlbnQudHlwZSA9ICggdHlwZSA9PT0gdGhpcy53aWRnZXRFdmVudFByZWZpeCA/XHJcblx0XHRcdHR5cGUgOlxyXG5cdFx0XHR0aGlzLndpZGdldEV2ZW50UHJlZml4ICsgdHlwZSApLnRvTG93ZXJDYXNlKCk7XHJcblx0XHQvLyB0aGUgb3JpZ2luYWwgZXZlbnQgbWF5IGNvbWUgZnJvbSBhbnkgZWxlbWVudFxyXG5cdFx0Ly8gc28gd2UgbmVlZCB0byByZXNldCB0aGUgdGFyZ2V0IG9uIHRoZSBuZXcgZXZlbnRcclxuXHRcdGV2ZW50LnRhcmdldCA9IHRoaXMuZWxlbWVudFsgMCBdO1xyXG5cclxuXHRcdC8vIGNvcHkgb3JpZ2luYWwgZXZlbnQgcHJvcGVydGllcyBvdmVyIHRvIHRoZSBuZXcgZXZlbnRcclxuXHRcdG9yaWcgPSBldmVudC5vcmlnaW5hbEV2ZW50O1xyXG5cdFx0aWYgKCBvcmlnICkge1xyXG5cdFx0XHRmb3IgKCBwcm9wIGluIG9yaWcgKSB7XHJcblx0XHRcdFx0aWYgKCAhKCBwcm9wIGluIGV2ZW50ICkgKSB7XHJcblx0XHRcdFx0XHRldmVudFsgcHJvcCBdID0gb3JpZ1sgcHJvcCBdO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuZWxlbWVudC50cmlnZ2VyKCBldmVudCwgZGF0YSApO1xyXG5cdFx0cmV0dXJuICEoICQuaXNGdW5jdGlvbiggY2FsbGJhY2sgKSAmJlxyXG5cdFx0XHRjYWxsYmFjay5hcHBseSggdGhpcy5lbGVtZW50WzBdLCBbIGV2ZW50IF0uY29uY2F0KCBkYXRhICkgKSA9PT0gZmFsc2UgfHxcclxuXHRcdFx0ZXZlbnQuaXNEZWZhdWx0UHJldmVudGVkKCkgKTtcclxuXHR9XHJcbn07XHJcblxyXG4kLmVhY2goIHsgc2hvdzogXCJmYWRlSW5cIiwgaGlkZTogXCJmYWRlT3V0XCIgfSwgZnVuY3Rpb24oIG1ldGhvZCwgZGVmYXVsdEVmZmVjdCApIHtcclxuXHQkLldpZGdldC5wcm90b3R5cGVbIFwiX1wiICsgbWV0aG9kIF0gPSBmdW5jdGlvbiggZWxlbWVudCwgb3B0aW9ucywgY2FsbGJhY2sgKSB7XHJcblx0XHRpZiAoIHR5cGVvZiBvcHRpb25zID09PSBcInN0cmluZ1wiICkge1xyXG5cdFx0XHRvcHRpb25zID0geyBlZmZlY3Q6IG9wdGlvbnMgfTtcclxuXHRcdH1cclxuXHRcdHZhciBoYXNPcHRpb25zLFxyXG5cdFx0XHRlZmZlY3ROYW1lID0gIW9wdGlvbnMgP1xyXG5cdFx0XHRcdG1ldGhvZCA6XHJcblx0XHRcdFx0b3B0aW9ucyA9PT0gdHJ1ZSB8fCB0eXBlb2Ygb3B0aW9ucyA9PT0gXCJudW1iZXJcIiA/XHJcblx0XHRcdFx0XHRkZWZhdWx0RWZmZWN0IDpcclxuXHRcdFx0XHRcdG9wdGlvbnMuZWZmZWN0IHx8IGRlZmF1bHRFZmZlY3Q7XHJcblx0XHRvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuXHRcdGlmICggdHlwZW9mIG9wdGlvbnMgPT09IFwibnVtYmVyXCIgKSB7XHJcblx0XHRcdG9wdGlvbnMgPSB7IGR1cmF0aW9uOiBvcHRpb25zIH07XHJcblx0XHR9XHJcblx0XHRoYXNPcHRpb25zID0gISQuaXNFbXB0eU9iamVjdCggb3B0aW9ucyApO1xyXG5cdFx0b3B0aW9ucy5jb21wbGV0ZSA9IGNhbGxiYWNrO1xyXG5cdFx0aWYgKCBvcHRpb25zLmRlbGF5ICkge1xyXG5cdFx0XHRlbGVtZW50LmRlbGF5KCBvcHRpb25zLmRlbGF5ICk7XHJcblx0XHR9XHJcblx0XHRpZiAoIGhhc09wdGlvbnMgJiYgJC5lZmZlY3RzICYmICQuZWZmZWN0cy5lZmZlY3RbIGVmZmVjdE5hbWUgXSApIHtcclxuXHRcdFx0ZWxlbWVudFsgbWV0aG9kIF0oIG9wdGlvbnMgKTtcclxuXHRcdH0gZWxzZSBpZiAoIGVmZmVjdE5hbWUgIT09IG1ldGhvZCAmJiBlbGVtZW50WyBlZmZlY3ROYW1lIF0gKSB7XHJcblx0XHRcdGVsZW1lbnRbIGVmZmVjdE5hbWUgXSggb3B0aW9ucy5kdXJhdGlvbiwgb3B0aW9ucy5lYXNpbmcsIGNhbGxiYWNrICk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRlbGVtZW50LnF1ZXVlKGZ1bmN0aW9uKCBuZXh0ICkge1xyXG5cdFx0XHRcdCQoIHRoaXMgKVsgbWV0aG9kIF0oKTtcclxuXHRcdFx0XHRpZiAoIGNhbGxiYWNrICkge1xyXG5cdFx0XHRcdFx0Y2FsbGJhY2suY2FsbCggZWxlbWVudFsgMCBdICk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdG5leHQoKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0fTtcclxufSk7XHJcblxyXG52YXIgd2lkZ2V0ID0gJC53aWRnZXQ7XHJcblxyXG5cclxuLyohXHJcbiAqIGpRdWVyeSBVSSBNb3VzZSAxLjExLjRcclxuICogaHR0cDovL2pxdWVyeXVpLmNvbVxyXG4gKlxyXG4gKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xyXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXHJcbiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2VcclxuICpcclxuICogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vbW91c2UvXHJcbiAqL1xyXG5cclxuXHJcbnZhciBtb3VzZUhhbmRsZWQgPSBmYWxzZTtcclxuJCggZG9jdW1lbnQgKS5tb3VzZXVwKCBmdW5jdGlvbigpIHtcclxuXHRtb3VzZUhhbmRsZWQgPSBmYWxzZTtcclxufSk7XHJcblxyXG52YXIgbW91c2UgPSAkLndpZGdldChcInVpLm1vdXNlXCIsIHtcclxuXHR2ZXJzaW9uOiBcIjEuMTEuNFwiLFxyXG5cdG9wdGlvbnM6IHtcclxuXHRcdGNhbmNlbDogXCJpbnB1dCx0ZXh0YXJlYSxidXR0b24sc2VsZWN0LG9wdGlvblwiLFxyXG5cdFx0ZGlzdGFuY2U6IDEsXHJcblx0XHRkZWxheTogMFxyXG5cdH0sXHJcblx0X21vdXNlSW5pdDogZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgdGhhdCA9IHRoaXM7XHJcblxyXG5cdFx0dGhpcy5lbGVtZW50XHJcblx0XHRcdC5iaW5kKFwibW91c2Vkb3duLlwiICsgdGhpcy53aWRnZXROYW1lLCBmdW5jdGlvbihldmVudCkge1xyXG5cdFx0XHRcdHJldHVybiB0aGF0Ll9tb3VzZURvd24oZXZlbnQpO1xyXG5cdFx0XHR9KVxyXG5cdFx0XHQuYmluZChcImNsaWNrLlwiICsgdGhpcy53aWRnZXROYW1lLCBmdW5jdGlvbihldmVudCkge1xyXG5cdFx0XHRcdGlmICh0cnVlID09PSAkLmRhdGEoZXZlbnQudGFyZ2V0LCB0aGF0LndpZGdldE5hbWUgKyBcIi5wcmV2ZW50Q2xpY2tFdmVudFwiKSkge1xyXG5cdFx0XHRcdFx0JC5yZW1vdmVEYXRhKGV2ZW50LnRhcmdldCwgdGhhdC53aWRnZXROYW1lICsgXCIucHJldmVudENsaWNrRXZlbnRcIik7XHJcblx0XHRcdFx0XHRldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcclxuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xyXG5cdH0sXHJcblxyXG5cdC8vIFRPRE86IG1ha2Ugc3VyZSBkZXN0cm95aW5nIG9uZSBpbnN0YW5jZSBvZiBtb3VzZSBkb2Vzbid0IG1lc3Mgd2l0aFxyXG5cdC8vIG90aGVyIGluc3RhbmNlcyBvZiBtb3VzZVxyXG5cdF9tb3VzZURlc3Ryb3k6IGZ1bmN0aW9uKCkge1xyXG5cdFx0dGhpcy5lbGVtZW50LnVuYmluZChcIi5cIiArIHRoaXMud2lkZ2V0TmFtZSk7XHJcblx0XHRpZiAoIHRoaXMuX21vdXNlTW92ZURlbGVnYXRlICkge1xyXG5cdFx0XHR0aGlzLmRvY3VtZW50XHJcblx0XHRcdFx0LnVuYmluZChcIm1vdXNlbW92ZS5cIiArIHRoaXMud2lkZ2V0TmFtZSwgdGhpcy5fbW91c2VNb3ZlRGVsZWdhdGUpXHJcblx0XHRcdFx0LnVuYmluZChcIm1vdXNldXAuXCIgKyB0aGlzLndpZGdldE5hbWUsIHRoaXMuX21vdXNlVXBEZWxlZ2F0ZSk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0X21vdXNlRG93bjogZnVuY3Rpb24oZXZlbnQpIHtcclxuXHRcdC8vIGRvbid0IGxldCBtb3JlIHRoYW4gb25lIHdpZGdldCBoYW5kbGUgbW91c2VTdGFydFxyXG5cdFx0aWYgKCBtb3VzZUhhbmRsZWQgKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLl9tb3VzZU1vdmVkID0gZmFsc2U7XHJcblxyXG5cdFx0Ly8gd2UgbWF5IGhhdmUgbWlzc2VkIG1vdXNldXAgKG91dCBvZiB3aW5kb3cpXHJcblx0XHQodGhpcy5fbW91c2VTdGFydGVkICYmIHRoaXMuX21vdXNlVXAoZXZlbnQpKTtcclxuXHJcblx0XHR0aGlzLl9tb3VzZURvd25FdmVudCA9IGV2ZW50O1xyXG5cclxuXHRcdHZhciB0aGF0ID0gdGhpcyxcclxuXHRcdFx0YnRuSXNMZWZ0ID0gKGV2ZW50LndoaWNoID09PSAxKSxcclxuXHRcdFx0Ly8gZXZlbnQudGFyZ2V0Lm5vZGVOYW1lIHdvcmtzIGFyb3VuZCBhIGJ1ZyBpbiBJRSA4IHdpdGhcclxuXHRcdFx0Ly8gZGlzYWJsZWQgaW5wdXRzICgjNzYyMClcclxuXHRcdFx0ZWxJc0NhbmNlbCA9ICh0eXBlb2YgdGhpcy5vcHRpb25zLmNhbmNlbCA9PT0gXCJzdHJpbmdcIiAmJiBldmVudC50YXJnZXQubm9kZU5hbWUgPyAkKGV2ZW50LnRhcmdldCkuY2xvc2VzdCh0aGlzLm9wdGlvbnMuY2FuY2VsKS5sZW5ndGggOiBmYWxzZSk7XHJcblx0XHRpZiAoIWJ0bklzTGVmdCB8fCBlbElzQ2FuY2VsIHx8ICF0aGlzLl9tb3VzZUNhcHR1cmUoZXZlbnQpKSB7XHJcblx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMubW91c2VEZWxheU1ldCA9ICF0aGlzLm9wdGlvbnMuZGVsYXk7XHJcblx0XHRpZiAoIXRoaXMubW91c2VEZWxheU1ldCkge1xyXG5cdFx0XHR0aGlzLl9tb3VzZURlbGF5VGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHRoYXQubW91c2VEZWxheU1ldCA9IHRydWU7XHJcblx0XHRcdH0sIHRoaXMub3B0aW9ucy5kZWxheSk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHRoaXMuX21vdXNlRGlzdGFuY2VNZXQoZXZlbnQpICYmIHRoaXMuX21vdXNlRGVsYXlNZXQoZXZlbnQpKSB7XHJcblx0XHRcdHRoaXMuX21vdXNlU3RhcnRlZCA9ICh0aGlzLl9tb3VzZVN0YXJ0KGV2ZW50KSAhPT0gZmFsc2UpO1xyXG5cdFx0XHRpZiAoIXRoaXMuX21vdXNlU3RhcnRlZCkge1xyXG5cdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvLyBDbGljayBldmVudCBtYXkgbmV2ZXIgaGF2ZSBmaXJlZCAoR2Vja28gJiBPcGVyYSlcclxuXHRcdGlmICh0cnVlID09PSAkLmRhdGEoZXZlbnQudGFyZ2V0LCB0aGlzLndpZGdldE5hbWUgKyBcIi5wcmV2ZW50Q2xpY2tFdmVudFwiKSkge1xyXG5cdFx0XHQkLnJlbW92ZURhdGEoZXZlbnQudGFyZ2V0LCB0aGlzLndpZGdldE5hbWUgKyBcIi5wcmV2ZW50Q2xpY2tFdmVudFwiKTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyB0aGVzZSBkZWxlZ2F0ZXMgYXJlIHJlcXVpcmVkIHRvIGtlZXAgY29udGV4dFxyXG5cdFx0dGhpcy5fbW91c2VNb3ZlRGVsZWdhdGUgPSBmdW5jdGlvbihldmVudCkge1xyXG5cdFx0XHRyZXR1cm4gdGhhdC5fbW91c2VNb3ZlKGV2ZW50KTtcclxuXHRcdH07XHJcblx0XHR0aGlzLl9tb3VzZVVwRGVsZWdhdGUgPSBmdW5jdGlvbihldmVudCkge1xyXG5cdFx0XHRyZXR1cm4gdGhhdC5fbW91c2VVcChldmVudCk7XHJcblx0XHR9O1xyXG5cclxuXHRcdHRoaXMuZG9jdW1lbnRcclxuXHRcdFx0LmJpbmQoIFwibW91c2Vtb3ZlLlwiICsgdGhpcy53aWRnZXROYW1lLCB0aGlzLl9tb3VzZU1vdmVEZWxlZ2F0ZSApXHJcblx0XHRcdC5iaW5kKCBcIm1vdXNldXAuXCIgKyB0aGlzLndpZGdldE5hbWUsIHRoaXMuX21vdXNlVXBEZWxlZ2F0ZSApO1xyXG5cclxuXHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG5cdFx0bW91c2VIYW5kbGVkID0gdHJ1ZTtcclxuXHRcdHJldHVybiB0cnVlO1xyXG5cdH0sXHJcblxyXG5cdF9tb3VzZU1vdmU6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcblx0XHQvLyBPbmx5IGNoZWNrIGZvciBtb3VzZXVwcyBvdXRzaWRlIHRoZSBkb2N1bWVudCBpZiB5b3UndmUgbW92ZWQgaW5zaWRlIHRoZSBkb2N1bWVudFxyXG5cdFx0Ly8gYXQgbGVhc3Qgb25jZS4gVGhpcyBwcmV2ZW50cyB0aGUgZmlyaW5nIG9mIG1vdXNldXAgaW4gdGhlIGNhc2Ugb2YgSUU8OSwgd2hpY2ggd2lsbFxyXG5cdFx0Ly8gZmlyZSBhIG1vdXNlbW92ZSBldmVudCBpZiBjb250ZW50IGlzIHBsYWNlZCB1bmRlciB0aGUgY3Vyc29yLiBTZWUgIzc3NzhcclxuXHRcdC8vIFN1cHBvcnQ6IElFIDw5XHJcblx0XHRpZiAoIHRoaXMuX21vdXNlTW92ZWQgKSB7XHJcblx0XHRcdC8vIElFIG1vdXNldXAgY2hlY2sgLSBtb3VzZXVwIGhhcHBlbmVkIHdoZW4gbW91c2Ugd2FzIG91dCBvZiB3aW5kb3dcclxuXHRcdFx0aWYgKCQudWkuaWUgJiYgKCAhZG9jdW1lbnQuZG9jdW1lbnRNb2RlIHx8IGRvY3VtZW50LmRvY3VtZW50TW9kZSA8IDkgKSAmJiAhZXZlbnQuYnV0dG9uKSB7XHJcblx0XHRcdFx0cmV0dXJuIHRoaXMuX21vdXNlVXAoZXZlbnQpO1xyXG5cclxuXHRcdFx0Ly8gSWZyYW1lIG1vdXNldXAgY2hlY2sgLSBtb3VzZXVwIG9jY3VycmVkIGluIGFub3RoZXIgZG9jdW1lbnRcclxuXHRcdFx0fSBlbHNlIGlmICggIWV2ZW50LndoaWNoICkge1xyXG5cdFx0XHRcdHJldHVybiB0aGlzLl9tb3VzZVVwKCBldmVudCApO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKCBldmVudC53aGljaCB8fCBldmVudC5idXR0b24gKSB7XHJcblx0XHRcdHRoaXMuX21vdXNlTW92ZWQgPSB0cnVlO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLl9tb3VzZVN0YXJ0ZWQpIHtcclxuXHRcdFx0dGhpcy5fbW91c2VEcmFnKGV2ZW50KTtcclxuXHRcdFx0cmV0dXJuIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHRoaXMuX21vdXNlRGlzdGFuY2VNZXQoZXZlbnQpICYmIHRoaXMuX21vdXNlRGVsYXlNZXQoZXZlbnQpKSB7XHJcblx0XHRcdHRoaXMuX21vdXNlU3RhcnRlZCA9XHJcblx0XHRcdFx0KHRoaXMuX21vdXNlU3RhcnQodGhpcy5fbW91c2VEb3duRXZlbnQsIGV2ZW50KSAhPT0gZmFsc2UpO1xyXG5cdFx0XHQodGhpcy5fbW91c2VTdGFydGVkID8gdGhpcy5fbW91c2VEcmFnKGV2ZW50KSA6IHRoaXMuX21vdXNlVXAoZXZlbnQpKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gIXRoaXMuX21vdXNlU3RhcnRlZDtcclxuXHR9LFxyXG5cclxuXHRfbW91c2VVcDogZnVuY3Rpb24oZXZlbnQpIHtcclxuXHRcdHRoaXMuZG9jdW1lbnRcclxuXHRcdFx0LnVuYmluZCggXCJtb3VzZW1vdmUuXCIgKyB0aGlzLndpZGdldE5hbWUsIHRoaXMuX21vdXNlTW92ZURlbGVnYXRlIClcclxuXHRcdFx0LnVuYmluZCggXCJtb3VzZXVwLlwiICsgdGhpcy53aWRnZXROYW1lLCB0aGlzLl9tb3VzZVVwRGVsZWdhdGUgKTtcclxuXHJcblx0XHRpZiAodGhpcy5fbW91c2VTdGFydGVkKSB7XHJcblx0XHRcdHRoaXMuX21vdXNlU3RhcnRlZCA9IGZhbHNlO1xyXG5cclxuXHRcdFx0aWYgKGV2ZW50LnRhcmdldCA9PT0gdGhpcy5fbW91c2VEb3duRXZlbnQudGFyZ2V0KSB7XHJcblx0XHRcdFx0JC5kYXRhKGV2ZW50LnRhcmdldCwgdGhpcy53aWRnZXROYW1lICsgXCIucHJldmVudENsaWNrRXZlbnRcIiwgdHJ1ZSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHRoaXMuX21vdXNlU3RvcChldmVudCk7XHJcblx0XHR9XHJcblxyXG5cdFx0bW91c2VIYW5kbGVkID0gZmFsc2U7XHJcblx0XHRyZXR1cm4gZmFsc2U7XHJcblx0fSxcclxuXHJcblx0X21vdXNlRGlzdGFuY2VNZXQ6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcblx0XHRyZXR1cm4gKE1hdGgubWF4KFxyXG5cdFx0XHRcdE1hdGguYWJzKHRoaXMuX21vdXNlRG93bkV2ZW50LnBhZ2VYIC0gZXZlbnQucGFnZVgpLFxyXG5cdFx0XHRcdE1hdGguYWJzKHRoaXMuX21vdXNlRG93bkV2ZW50LnBhZ2VZIC0gZXZlbnQucGFnZVkpXHJcblx0XHRcdCkgPj0gdGhpcy5vcHRpb25zLmRpc3RhbmNlXHJcblx0XHQpO1xyXG5cdH0sXHJcblxyXG5cdF9tb3VzZURlbGF5TWV0OiBmdW5jdGlvbigvKiBldmVudCAqLykge1xyXG5cdFx0cmV0dXJuIHRoaXMubW91c2VEZWxheU1ldDtcclxuXHR9LFxyXG5cclxuXHQvLyBUaGVzZSBhcmUgcGxhY2Vob2xkZXIgbWV0aG9kcywgdG8gYmUgb3ZlcnJpZGVuIGJ5IGV4dGVuZGluZyBwbHVnaW5cclxuXHRfbW91c2VTdGFydDogZnVuY3Rpb24oLyogZXZlbnQgKi8pIHt9LFxyXG5cdF9tb3VzZURyYWc6IGZ1bmN0aW9uKC8qIGV2ZW50ICovKSB7fSxcclxuXHRfbW91c2VTdG9wOiBmdW5jdGlvbigvKiBldmVudCAqLykge30sXHJcblx0X21vdXNlQ2FwdHVyZTogZnVuY3Rpb24oLyogZXZlbnQgKi8pIHsgcmV0dXJuIHRydWU7IH1cclxufSk7XHJcblxyXG5cclxuLyohXHJcbiAqIGpRdWVyeSBVSSBEcmFnZ2FibGUgMS4xMS40XHJcbiAqIGh0dHA6Ly9qcXVlcnl1aS5jb21cclxuICpcclxuICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnNcclxuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxyXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXHJcbiAqXHJcbiAqIGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2RyYWdnYWJsZS9cclxuICovXHJcblxyXG5cclxuJC53aWRnZXQoXCJ1aS5kcmFnZ2FibGVcIiwgJC51aS5tb3VzZSwge1xyXG5cdHZlcnNpb246IFwiMS4xMS40XCIsXHJcblx0d2lkZ2V0RXZlbnRQcmVmaXg6IFwiZHJhZ1wiLFxyXG5cdG9wdGlvbnM6IHtcclxuXHRcdGFkZENsYXNzZXM6IHRydWUsXHJcblx0XHRhcHBlbmRUbzogXCJwYXJlbnRcIixcclxuXHRcdGF4aXM6IGZhbHNlLFxyXG5cdFx0Y29ubmVjdFRvU29ydGFibGU6IGZhbHNlLFxyXG5cdFx0Y29udGFpbm1lbnQ6IGZhbHNlLFxyXG5cdFx0Y3Vyc29yOiBcImF1dG9cIixcclxuXHRcdGN1cnNvckF0OiBmYWxzZSxcclxuXHRcdGdyaWQ6IGZhbHNlLFxyXG5cdFx0aGFuZGxlOiBmYWxzZSxcclxuXHRcdGhlbHBlcjogXCJvcmlnaW5hbFwiLFxyXG5cdFx0aWZyYW1lRml4OiBmYWxzZSxcclxuXHRcdG9wYWNpdHk6IGZhbHNlLFxyXG5cdFx0cmVmcmVzaFBvc2l0aW9uczogZmFsc2UsXHJcblx0XHRyZXZlcnQ6IGZhbHNlLFxyXG5cdFx0cmV2ZXJ0RHVyYXRpb246IDUwMCxcclxuXHRcdHNjb3BlOiBcImRlZmF1bHRcIixcclxuXHRcdHNjcm9sbDogdHJ1ZSxcclxuXHRcdHNjcm9sbFNlbnNpdGl2aXR5OiAyMCxcclxuXHRcdHNjcm9sbFNwZWVkOiAyMCxcclxuXHRcdHNuYXA6IGZhbHNlLFxyXG5cdFx0c25hcE1vZGU6IFwiYm90aFwiLFxyXG5cdFx0c25hcFRvbGVyYW5jZTogMjAsXHJcblx0XHRzdGFjazogZmFsc2UsXHJcblx0XHR6SW5kZXg6IGZhbHNlLFxyXG5cclxuXHRcdC8vIGNhbGxiYWNrc1xyXG5cdFx0ZHJhZzogbnVsbCxcclxuXHRcdHN0YXJ0OiBudWxsLFxyXG5cdFx0c3RvcDogbnVsbFxyXG5cdH0sXHJcblx0X2NyZWF0ZTogZnVuY3Rpb24oKSB7XHJcblxyXG5cdFx0aWYgKCB0aGlzLm9wdGlvbnMuaGVscGVyID09PSBcIm9yaWdpbmFsXCIgKSB7XHJcblx0XHRcdHRoaXMuX3NldFBvc2l0aW9uUmVsYXRpdmUoKTtcclxuXHRcdH1cclxuXHRcdGlmICh0aGlzLm9wdGlvbnMuYWRkQ2xhc3Nlcyl7XHJcblx0XHRcdHRoaXMuZWxlbWVudC5hZGRDbGFzcyhcInVpLWRyYWdnYWJsZVwiKTtcclxuXHRcdH1cclxuXHRcdGlmICh0aGlzLm9wdGlvbnMuZGlzYWJsZWQpe1xyXG5cdFx0XHR0aGlzLmVsZW1lbnQuYWRkQ2xhc3MoXCJ1aS1kcmFnZ2FibGUtZGlzYWJsZWRcIik7XHJcblx0XHR9XHJcblx0XHR0aGlzLl9zZXRIYW5kbGVDbGFzc05hbWUoKTtcclxuXHJcblx0XHR0aGlzLl9tb3VzZUluaXQoKTtcclxuXHR9LFxyXG5cclxuXHRfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcclxuXHRcdHRoaXMuX3N1cGVyKCBrZXksIHZhbHVlICk7XHJcblx0XHRpZiAoIGtleSA9PT0gXCJoYW5kbGVcIiApIHtcclxuXHRcdFx0dGhpcy5fcmVtb3ZlSGFuZGxlQ2xhc3NOYW1lKCk7XHJcblx0XHRcdHRoaXMuX3NldEhhbmRsZUNsYXNzTmFtZSgpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdF9kZXN0cm95OiBmdW5jdGlvbigpIHtcclxuXHRcdGlmICggKCB0aGlzLmhlbHBlciB8fCB0aGlzLmVsZW1lbnQgKS5pcyggXCIudWktZHJhZ2dhYmxlLWRyYWdnaW5nXCIgKSApIHtcclxuXHRcdFx0dGhpcy5kZXN0cm95T25DbGVhciA9IHRydWU7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdHRoaXMuZWxlbWVudC5yZW1vdmVDbGFzcyggXCJ1aS1kcmFnZ2FibGUgdWktZHJhZ2dhYmxlLWRyYWdnaW5nIHVpLWRyYWdnYWJsZS1kaXNhYmxlZFwiICk7XHJcblx0XHR0aGlzLl9yZW1vdmVIYW5kbGVDbGFzc05hbWUoKTtcclxuXHRcdHRoaXMuX21vdXNlRGVzdHJveSgpO1xyXG5cdH0sXHJcblxyXG5cdF9tb3VzZUNhcHR1cmU6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcblx0XHR2YXIgbyA9IHRoaXMub3B0aW9ucztcclxuXHJcblx0XHR0aGlzLl9ibHVyQWN0aXZlRWxlbWVudCggZXZlbnQgKTtcclxuXHJcblx0XHQvLyBhbW9uZyBvdGhlcnMsIHByZXZlbnQgYSBkcmFnIG9uIGEgcmVzaXphYmxlLWhhbmRsZVxyXG5cdFx0aWYgKHRoaXMuaGVscGVyIHx8IG8uZGlzYWJsZWQgfHwgJChldmVudC50YXJnZXQpLmNsb3Nlc3QoXCIudWktcmVzaXphYmxlLWhhbmRsZVwiKS5sZW5ndGggPiAwKSB7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHJcblx0XHQvL1F1aXQgaWYgd2UncmUgbm90IG9uIGEgdmFsaWQgaGFuZGxlXHJcblx0XHR0aGlzLmhhbmRsZSA9IHRoaXMuX2dldEhhbmRsZShldmVudCk7XHJcblx0XHRpZiAoIXRoaXMuaGFuZGxlKSB7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLl9ibG9ja0ZyYW1lcyggby5pZnJhbWVGaXggPT09IHRydWUgPyBcImlmcmFtZVwiIDogby5pZnJhbWVGaXggKTtcclxuXHJcblx0XHRyZXR1cm4gdHJ1ZTtcclxuXHJcblx0fSxcclxuXHJcblx0X2Jsb2NrRnJhbWVzOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7XHJcblx0XHR0aGlzLmlmcmFtZUJsb2NrcyA9IHRoaXMuZG9jdW1lbnQuZmluZCggc2VsZWN0b3IgKS5tYXAoZnVuY3Rpb24oKSB7XHJcblx0XHRcdHZhciBpZnJhbWUgPSAkKCB0aGlzICk7XHJcblxyXG5cdFx0XHRyZXR1cm4gJCggXCI8ZGl2PlwiIClcclxuXHRcdFx0XHQuY3NzKCBcInBvc2l0aW9uXCIsIFwiYWJzb2x1dGVcIiApXHJcblx0XHRcdFx0LmFwcGVuZFRvKCBpZnJhbWUucGFyZW50KCkgKVxyXG5cdFx0XHRcdC5vdXRlcldpZHRoKCBpZnJhbWUub3V0ZXJXaWR0aCgpIClcclxuXHRcdFx0XHQub3V0ZXJIZWlnaHQoIGlmcmFtZS5vdXRlckhlaWdodCgpIClcclxuXHRcdFx0XHQub2Zmc2V0KCBpZnJhbWUub2Zmc2V0KCkgKVsgMCBdO1xyXG5cdFx0fSk7XHJcblx0fSxcclxuXHJcblx0X3VuYmxvY2tGcmFtZXM6IGZ1bmN0aW9uKCkge1xyXG5cdFx0aWYgKCB0aGlzLmlmcmFtZUJsb2NrcyApIHtcclxuXHRcdFx0dGhpcy5pZnJhbWVCbG9ja3MucmVtb3ZlKCk7XHJcblx0XHRcdGRlbGV0ZSB0aGlzLmlmcmFtZUJsb2NrcztcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRfYmx1ckFjdGl2ZUVsZW1lbnQ6IGZ1bmN0aW9uKCBldmVudCApIHtcclxuXHRcdHZhciBkb2N1bWVudCA9IHRoaXMuZG9jdW1lbnRbIDAgXTtcclxuXHJcblx0XHQvLyBPbmx5IG5lZWQgdG8gYmx1ciBpZiB0aGUgZXZlbnQgb2NjdXJyZWQgb24gdGhlIGRyYWdnYWJsZSBpdHNlbGYsIHNlZSAjMTA1MjdcclxuXHRcdGlmICggIXRoaXMuaGFuZGxlRWxlbWVudC5pcyggZXZlbnQudGFyZ2V0ICkgKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBzdXBwb3J0OiBJRTlcclxuXHRcdC8vIElFOSB0aHJvd3MgYW4gXCJVbnNwZWNpZmllZCBlcnJvclwiIGFjY2Vzc2luZyBkb2N1bWVudC5hY3RpdmVFbGVtZW50IGZyb20gYW4gPGlmcmFtZT5cclxuXHRcdHRyeSB7XHJcblxyXG5cdFx0XHQvLyBTdXBwb3J0OiBJRTksIElFMTBcclxuXHRcdFx0Ly8gSWYgdGhlIDxib2R5PiBpcyBibHVycmVkLCBJRSB3aWxsIHN3aXRjaCB3aW5kb3dzLCBzZWUgIzk1MjBcclxuXHRcdFx0aWYgKCBkb2N1bWVudC5hY3RpdmVFbGVtZW50ICYmIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPT0gXCJib2R5XCIgKSB7XHJcblxyXG5cdFx0XHRcdC8vIEJsdXIgYW55IGVsZW1lbnQgdGhhdCBjdXJyZW50bHkgaGFzIGZvY3VzLCBzZWUgIzQyNjFcclxuXHRcdFx0XHQkKCBkb2N1bWVudC5hY3RpdmVFbGVtZW50ICkuYmx1cigpO1xyXG5cdFx0XHR9XHJcblx0XHR9IGNhdGNoICggZXJyb3IgKSB7fVxyXG5cdH0sXHJcblxyXG5cdF9tb3VzZVN0YXJ0OiBmdW5jdGlvbihldmVudCkge1xyXG5cclxuXHRcdHZhciBvID0gdGhpcy5vcHRpb25zO1xyXG5cclxuXHRcdC8vQ3JlYXRlIGFuZCBhcHBlbmQgdGhlIHZpc2libGUgaGVscGVyXHJcblx0XHR0aGlzLmhlbHBlciA9IHRoaXMuX2NyZWF0ZUhlbHBlcihldmVudCk7XHJcblxyXG5cdFx0dGhpcy5oZWxwZXIuYWRkQ2xhc3MoXCJ1aS1kcmFnZ2FibGUtZHJhZ2dpbmdcIik7XHJcblxyXG5cdFx0Ly9DYWNoZSB0aGUgaGVscGVyIHNpemVcclxuXHRcdHRoaXMuX2NhY2hlSGVscGVyUHJvcG9ydGlvbnMoKTtcclxuXHJcblx0XHQvL0lmIGRkbWFuYWdlciBpcyB1c2VkIGZvciBkcm9wcGFibGVzLCBzZXQgdGhlIGdsb2JhbCBkcmFnZ2FibGVcclxuXHRcdGlmICgkLnVpLmRkbWFuYWdlcikge1xyXG5cdFx0XHQkLnVpLmRkbWFuYWdlci5jdXJyZW50ID0gdGhpcztcclxuXHRcdH1cclxuXHJcblx0XHQvKlxyXG5cdFx0ICogLSBQb3NpdGlvbiBnZW5lcmF0aW9uIC1cclxuXHRcdCAqIFRoaXMgYmxvY2sgZ2VuZXJhdGVzIGV2ZXJ5dGhpbmcgcG9zaXRpb24gcmVsYXRlZCAtIGl0J3MgdGhlIGNvcmUgb2YgZHJhZ2dhYmxlcy5cclxuXHRcdCAqL1xyXG5cclxuXHRcdC8vQ2FjaGUgdGhlIG1hcmdpbnMgb2YgdGhlIG9yaWdpbmFsIGVsZW1lbnRcclxuXHRcdHRoaXMuX2NhY2hlTWFyZ2lucygpO1xyXG5cclxuXHRcdC8vU3RvcmUgdGhlIGhlbHBlcidzIGNzcyBwb3NpdGlvblxyXG5cdFx0dGhpcy5jc3NQb3NpdGlvbiA9IHRoaXMuaGVscGVyLmNzcyggXCJwb3NpdGlvblwiICk7XHJcblx0XHR0aGlzLnNjcm9sbFBhcmVudCA9IHRoaXMuaGVscGVyLnNjcm9sbFBhcmVudCggdHJ1ZSApO1xyXG5cdFx0dGhpcy5vZmZzZXRQYXJlbnQgPSB0aGlzLmhlbHBlci5vZmZzZXRQYXJlbnQoKTtcclxuXHRcdHRoaXMuaGFzRml4ZWRBbmNlc3RvciA9IHRoaXMuaGVscGVyLnBhcmVudHMoKS5maWx0ZXIoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0cmV0dXJuICQoIHRoaXMgKS5jc3MoIFwicG9zaXRpb25cIiApID09PSBcImZpeGVkXCI7XHJcblx0XHRcdH0pLmxlbmd0aCA+IDA7XHJcblxyXG5cdFx0Ly9UaGUgZWxlbWVudCdzIGFic29sdXRlIHBvc2l0aW9uIG9uIHRoZSBwYWdlIG1pbnVzIG1hcmdpbnNcclxuXHRcdHRoaXMucG9zaXRpb25BYnMgPSB0aGlzLmVsZW1lbnQub2Zmc2V0KCk7XHJcblx0XHR0aGlzLl9yZWZyZXNoT2Zmc2V0cyggZXZlbnQgKTtcclxuXHJcblx0XHQvL0dlbmVyYXRlIHRoZSBvcmlnaW5hbCBwb3NpdGlvblxyXG5cdFx0dGhpcy5vcmlnaW5hbFBvc2l0aW9uID0gdGhpcy5wb3NpdGlvbiA9IHRoaXMuX2dlbmVyYXRlUG9zaXRpb24oIGV2ZW50LCBmYWxzZSApO1xyXG5cdFx0dGhpcy5vcmlnaW5hbFBhZ2VYID0gZXZlbnQucGFnZVg7XHJcblx0XHR0aGlzLm9yaWdpbmFsUGFnZVkgPSBldmVudC5wYWdlWTtcclxuXHJcblx0XHQvL0FkanVzdCB0aGUgbW91c2Ugb2Zmc2V0IHJlbGF0aXZlIHRvIHRoZSBoZWxwZXIgaWYgXCJjdXJzb3JBdFwiIGlzIHN1cHBsaWVkXHJcblx0XHQoby5jdXJzb3JBdCAmJiB0aGlzLl9hZGp1c3RPZmZzZXRGcm9tSGVscGVyKG8uY3Vyc29yQXQpKTtcclxuXHJcblx0XHQvL1NldCBhIGNvbnRhaW5tZW50IGlmIGdpdmVuIGluIHRoZSBvcHRpb25zXHJcblx0XHR0aGlzLl9zZXRDb250YWlubWVudCgpO1xyXG5cclxuXHRcdC8vVHJpZ2dlciBldmVudCArIGNhbGxiYWNrc1xyXG5cdFx0aWYgKHRoaXMuX3RyaWdnZXIoXCJzdGFydFwiLCBldmVudCkgPT09IGZhbHNlKSB7XHJcblx0XHRcdHRoaXMuX2NsZWFyKCk7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHJcblx0XHQvL1JlY2FjaGUgdGhlIGhlbHBlciBzaXplXHJcblx0XHR0aGlzLl9jYWNoZUhlbHBlclByb3BvcnRpb25zKCk7XHJcblxyXG5cdFx0Ly9QcmVwYXJlIHRoZSBkcm9wcGFibGUgb2Zmc2V0c1xyXG5cdFx0aWYgKCQudWkuZGRtYW5hZ2VyICYmICFvLmRyb3BCZWhhdmlvdXIpIHtcclxuXHRcdFx0JC51aS5kZG1hbmFnZXIucHJlcGFyZU9mZnNldHModGhpcywgZXZlbnQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFJlc2V0IGhlbHBlcidzIHJpZ2h0L2JvdHRvbSBjc3MgaWYgdGhleSdyZSBzZXQgYW5kIHNldCBleHBsaWNpdCB3aWR0aC9oZWlnaHQgaW5zdGVhZFxyXG5cdFx0Ly8gYXMgdGhpcyBwcmV2ZW50cyByZXNpemluZyBvZiBlbGVtZW50cyB3aXRoIHJpZ2h0L2JvdHRvbSBzZXQgKHNlZSAjNzc3MilcclxuXHRcdHRoaXMuX25vcm1hbGl6ZVJpZ2h0Qm90dG9tKCk7XHJcblxyXG5cdFx0dGhpcy5fbW91c2VEcmFnKGV2ZW50LCB0cnVlKTsgLy9FeGVjdXRlIHRoZSBkcmFnIG9uY2UgLSB0aGlzIGNhdXNlcyB0aGUgaGVscGVyIG5vdCB0byBiZSB2aXNpYmxlIGJlZm9yZSBnZXR0aW5nIGl0cyBjb3JyZWN0IHBvc2l0aW9uXHJcblxyXG5cdFx0Ly9JZiB0aGUgZGRtYW5hZ2VyIGlzIHVzZWQgZm9yIGRyb3BwYWJsZXMsIGluZm9ybSB0aGUgbWFuYWdlciB0aGF0IGRyYWdnaW5nIGhhcyBzdGFydGVkIChzZWUgIzUwMDMpXHJcblx0XHRpZiAoICQudWkuZGRtYW5hZ2VyICkge1xyXG5cdFx0XHQkLnVpLmRkbWFuYWdlci5kcmFnU3RhcnQodGhpcywgZXZlbnQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0cnVlO1xyXG5cdH0sXHJcblxyXG5cdF9yZWZyZXNoT2Zmc2V0czogZnVuY3Rpb24oIGV2ZW50ICkge1xyXG5cdFx0dGhpcy5vZmZzZXQgPSB7XHJcblx0XHRcdHRvcDogdGhpcy5wb3NpdGlvbkFicy50b3AgLSB0aGlzLm1hcmdpbnMudG9wLFxyXG5cdFx0XHRsZWZ0OiB0aGlzLnBvc2l0aW9uQWJzLmxlZnQgLSB0aGlzLm1hcmdpbnMubGVmdCxcclxuXHRcdFx0c2Nyb2xsOiBmYWxzZSxcclxuXHRcdFx0cGFyZW50OiB0aGlzLl9nZXRQYXJlbnRPZmZzZXQoKSxcclxuXHRcdFx0cmVsYXRpdmU6IHRoaXMuX2dldFJlbGF0aXZlT2Zmc2V0KClcclxuXHRcdH07XHJcblxyXG5cdFx0dGhpcy5vZmZzZXQuY2xpY2sgPSB7XHJcblx0XHRcdGxlZnQ6IGV2ZW50LnBhZ2VYIC0gdGhpcy5vZmZzZXQubGVmdCxcclxuXHRcdFx0dG9wOiBldmVudC5wYWdlWSAtIHRoaXMub2Zmc2V0LnRvcFxyXG5cdFx0fTtcclxuXHR9LFxyXG5cclxuXHRfbW91c2VEcmFnOiBmdW5jdGlvbihldmVudCwgbm9Qcm9wYWdhdGlvbikge1xyXG5cdFx0Ly8gcmVzZXQgYW55IG5lY2Vzc2FyeSBjYWNoZWQgcHJvcGVydGllcyAoc2VlICM1MDA5KVxyXG5cdFx0aWYgKCB0aGlzLmhhc0ZpeGVkQW5jZXN0b3IgKSB7XHJcblx0XHRcdHRoaXMub2Zmc2V0LnBhcmVudCA9IHRoaXMuX2dldFBhcmVudE9mZnNldCgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vQ29tcHV0ZSB0aGUgaGVscGVycyBwb3NpdGlvblxyXG5cdFx0dGhpcy5wb3NpdGlvbiA9IHRoaXMuX2dlbmVyYXRlUG9zaXRpb24oIGV2ZW50LCB0cnVlICk7XHJcblx0XHR0aGlzLnBvc2l0aW9uQWJzID0gdGhpcy5fY29udmVydFBvc2l0aW9uVG8oXCJhYnNvbHV0ZVwiKTtcclxuXHJcblx0XHQvL0NhbGwgcGx1Z2lucyBhbmQgY2FsbGJhY2tzIGFuZCB1c2UgdGhlIHJlc3VsdGluZyBwb3NpdGlvbiBpZiBzb21ldGhpbmcgaXMgcmV0dXJuZWRcclxuXHRcdGlmICghbm9Qcm9wYWdhdGlvbikge1xyXG5cdFx0XHR2YXIgdWkgPSB0aGlzLl91aUhhc2goKTtcclxuXHRcdFx0aWYgKHRoaXMuX3RyaWdnZXIoXCJkcmFnXCIsIGV2ZW50LCB1aSkgPT09IGZhbHNlKSB7XHJcblx0XHRcdFx0dGhpcy5fbW91c2VVcCh7fSk7XHJcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHRcdHRoaXMucG9zaXRpb24gPSB1aS5wb3NpdGlvbjtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmhlbHBlclsgMCBdLnN0eWxlLmxlZnQgPSB0aGlzLnBvc2l0aW9uLmxlZnQgKyBcInB4XCI7XHJcblx0XHR0aGlzLmhlbHBlclsgMCBdLnN0eWxlLnRvcCA9IHRoaXMucG9zaXRpb24udG9wICsgXCJweFwiO1xyXG5cclxuXHRcdGlmICgkLnVpLmRkbWFuYWdlcikge1xyXG5cdFx0XHQkLnVpLmRkbWFuYWdlci5kcmFnKHRoaXMsIGV2ZW50KTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gZmFsc2U7XHJcblx0fSxcclxuXHJcblx0X21vdXNlU3RvcDogZnVuY3Rpb24oZXZlbnQpIHtcclxuXHJcblx0XHQvL0lmIHdlIGFyZSB1c2luZyBkcm9wcGFibGVzLCBpbmZvcm0gdGhlIG1hbmFnZXIgYWJvdXQgdGhlIGRyb3BcclxuXHRcdHZhciB0aGF0ID0gdGhpcyxcclxuXHRcdFx0ZHJvcHBlZCA9IGZhbHNlO1xyXG5cdFx0aWYgKCQudWkuZGRtYW5hZ2VyICYmICF0aGlzLm9wdGlvbnMuZHJvcEJlaGF2aW91cikge1xyXG5cdFx0XHRkcm9wcGVkID0gJC51aS5kZG1hbmFnZXIuZHJvcCh0aGlzLCBldmVudCk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly9pZiBhIGRyb3AgY29tZXMgZnJvbSBvdXRzaWRlIChhIHNvcnRhYmxlKVxyXG5cdFx0aWYgKHRoaXMuZHJvcHBlZCkge1xyXG5cdFx0XHRkcm9wcGVkID0gdGhpcy5kcm9wcGVkO1xyXG5cdFx0XHR0aGlzLmRyb3BwZWQgPSBmYWxzZTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoKHRoaXMub3B0aW9ucy5yZXZlcnQgPT09IFwiaW52YWxpZFwiICYmICFkcm9wcGVkKSB8fCAodGhpcy5vcHRpb25zLnJldmVydCA9PT0gXCJ2YWxpZFwiICYmIGRyb3BwZWQpIHx8IHRoaXMub3B0aW9ucy5yZXZlcnQgPT09IHRydWUgfHwgKCQuaXNGdW5jdGlvbih0aGlzLm9wdGlvbnMucmV2ZXJ0KSAmJiB0aGlzLm9wdGlvbnMucmV2ZXJ0LmNhbGwodGhpcy5lbGVtZW50LCBkcm9wcGVkKSkpIHtcclxuXHRcdFx0JCh0aGlzLmhlbHBlcikuYW5pbWF0ZSh0aGlzLm9yaWdpbmFsUG9zaXRpb24sIHBhcnNlSW50KHRoaXMub3B0aW9ucy5yZXZlcnREdXJhdGlvbiwgMTApLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRpZiAodGhhdC5fdHJpZ2dlcihcInN0b3BcIiwgZXZlbnQpICE9PSBmYWxzZSkge1xyXG5cdFx0XHRcdFx0dGhhdC5fY2xlYXIoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0aWYgKHRoaXMuX3RyaWdnZXIoXCJzdG9wXCIsIGV2ZW50KSAhPT0gZmFsc2UpIHtcclxuXHRcdFx0XHR0aGlzLl9jbGVhcigpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH0sXHJcblxyXG5cdF9tb3VzZVVwOiBmdW5jdGlvbiggZXZlbnQgKSB7XHJcblx0XHR0aGlzLl91bmJsb2NrRnJhbWVzKCk7XHJcblxyXG5cdFx0Ly9JZiB0aGUgZGRtYW5hZ2VyIGlzIHVzZWQgZm9yIGRyb3BwYWJsZXMsIGluZm9ybSB0aGUgbWFuYWdlciB0aGF0IGRyYWdnaW5nIGhhcyBzdG9wcGVkIChzZWUgIzUwMDMpXHJcblx0XHRpZiAoICQudWkuZGRtYW5hZ2VyICkge1xyXG5cdFx0XHQkLnVpLmRkbWFuYWdlci5kcmFnU3RvcCh0aGlzLCBldmVudCk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gT25seSBuZWVkIHRvIGZvY3VzIGlmIHRoZSBldmVudCBvY2N1cnJlZCBvbiB0aGUgZHJhZ2dhYmxlIGl0c2VsZiwgc2VlICMxMDUyN1xyXG5cdFx0aWYgKCB0aGlzLmhhbmRsZUVsZW1lbnQuaXMoIGV2ZW50LnRhcmdldCApICkge1xyXG5cdFx0XHQvLyBUaGUgaW50ZXJhY3Rpb24gaXMgb3Zlcjsgd2hldGhlciBvciBub3QgdGhlIGNsaWNrIHJlc3VsdGVkIGluIGEgZHJhZywgZm9jdXMgdGhlIGVsZW1lbnRcclxuXHRcdFx0dGhpcy5lbGVtZW50LmZvY3VzKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuICQudWkubW91c2UucHJvdG90eXBlLl9tb3VzZVVwLmNhbGwodGhpcywgZXZlbnQpO1xyXG5cdH0sXHJcblxyXG5cdGNhbmNlbDogZnVuY3Rpb24oKSB7XHJcblxyXG5cdFx0aWYgKHRoaXMuaGVscGVyLmlzKFwiLnVpLWRyYWdnYWJsZS1kcmFnZ2luZ1wiKSkge1xyXG5cdFx0XHR0aGlzLl9tb3VzZVVwKHt9KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRoaXMuX2NsZWFyKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblxyXG5cdH0sXHJcblxyXG5cdF9nZXRIYW5kbGU6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcblx0XHRyZXR1cm4gdGhpcy5vcHRpb25zLmhhbmRsZSA/XHJcblx0XHRcdCEhJCggZXZlbnQudGFyZ2V0ICkuY2xvc2VzdCggdGhpcy5lbGVtZW50LmZpbmQoIHRoaXMub3B0aW9ucy5oYW5kbGUgKSApLmxlbmd0aCA6XHJcblx0XHRcdHRydWU7XHJcblx0fSxcclxuXHJcblx0X3NldEhhbmRsZUNsYXNzTmFtZTogZnVuY3Rpb24oKSB7XHJcblx0XHR0aGlzLmhhbmRsZUVsZW1lbnQgPSB0aGlzLm9wdGlvbnMuaGFuZGxlID9cclxuXHRcdFx0dGhpcy5lbGVtZW50LmZpbmQoIHRoaXMub3B0aW9ucy5oYW5kbGUgKSA6IHRoaXMuZWxlbWVudDtcclxuXHRcdHRoaXMuaGFuZGxlRWxlbWVudC5hZGRDbGFzcyggXCJ1aS1kcmFnZ2FibGUtaGFuZGxlXCIgKTtcclxuXHR9LFxyXG5cclxuXHRfcmVtb3ZlSGFuZGxlQ2xhc3NOYW1lOiBmdW5jdGlvbigpIHtcclxuXHRcdHRoaXMuaGFuZGxlRWxlbWVudC5yZW1vdmVDbGFzcyggXCJ1aS1kcmFnZ2FibGUtaGFuZGxlXCIgKTtcclxuXHR9LFxyXG5cclxuXHRfY3JlYXRlSGVscGVyOiBmdW5jdGlvbihldmVudCkge1xyXG5cclxuXHRcdHZhciBvID0gdGhpcy5vcHRpb25zLFxyXG5cdFx0XHRoZWxwZXJJc0Z1bmN0aW9uID0gJC5pc0Z1bmN0aW9uKCBvLmhlbHBlciApLFxyXG5cdFx0XHRoZWxwZXIgPSBoZWxwZXJJc0Z1bmN0aW9uID9cclxuXHRcdFx0XHQkKCBvLmhlbHBlci5hcHBseSggdGhpcy5lbGVtZW50WyAwIF0sIFsgZXZlbnQgXSApICkgOlxyXG5cdFx0XHRcdCggby5oZWxwZXIgPT09IFwiY2xvbmVcIiA/XHJcblx0XHRcdFx0XHR0aGlzLmVsZW1lbnQuY2xvbmUoKS5yZW1vdmVBdHRyKCBcImlkXCIgKSA6XHJcblx0XHRcdFx0XHR0aGlzLmVsZW1lbnQgKTtcclxuXHJcblx0XHRpZiAoIWhlbHBlci5wYXJlbnRzKFwiYm9keVwiKS5sZW5ndGgpIHtcclxuXHRcdFx0aGVscGVyLmFwcGVuZFRvKChvLmFwcGVuZFRvID09PSBcInBhcmVudFwiID8gdGhpcy5lbGVtZW50WzBdLnBhcmVudE5vZGUgOiBvLmFwcGVuZFRvKSk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gaHR0cDovL2J1Z3MuanF1ZXJ5dWkuY29tL3RpY2tldC85NDQ2XHJcblx0XHQvLyBhIGhlbHBlciBmdW5jdGlvbiBjYW4gcmV0dXJuIHRoZSBvcmlnaW5hbCBlbGVtZW50XHJcblx0XHQvLyB3aGljaCB3b3VsZG4ndCBoYXZlIGJlZW4gc2V0IHRvIHJlbGF0aXZlIGluIF9jcmVhdGVcclxuXHRcdGlmICggaGVscGVySXNGdW5jdGlvbiAmJiBoZWxwZXJbIDAgXSA9PT0gdGhpcy5lbGVtZW50WyAwIF0gKSB7XHJcblx0XHRcdHRoaXMuX3NldFBvc2l0aW9uUmVsYXRpdmUoKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoaGVscGVyWzBdICE9PSB0aGlzLmVsZW1lbnRbMF0gJiYgISgvKGZpeGVkfGFic29sdXRlKS8pLnRlc3QoaGVscGVyLmNzcyhcInBvc2l0aW9uXCIpKSkge1xyXG5cdFx0XHRoZWxwZXIuY3NzKFwicG9zaXRpb25cIiwgXCJhYnNvbHV0ZVwiKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gaGVscGVyO1xyXG5cclxuXHR9LFxyXG5cclxuXHRfc2V0UG9zaXRpb25SZWxhdGl2ZTogZnVuY3Rpb24oKSB7XHJcblx0XHRpZiAoICEoIC9eKD86cnxhfGYpLyApLnRlc3QoIHRoaXMuZWxlbWVudC5jc3MoIFwicG9zaXRpb25cIiApICkgKSB7XHJcblx0XHRcdHRoaXMuZWxlbWVudFsgMCBdLnN0eWxlLnBvc2l0aW9uID0gXCJyZWxhdGl2ZVwiO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdF9hZGp1c3RPZmZzZXRGcm9tSGVscGVyOiBmdW5jdGlvbihvYmopIHtcclxuXHRcdGlmICh0eXBlb2Ygb2JqID09PSBcInN0cmluZ1wiKSB7XHJcblx0XHRcdG9iaiA9IG9iai5zcGxpdChcIiBcIik7XHJcblx0XHR9XHJcblx0XHRpZiAoJC5pc0FycmF5KG9iaikpIHtcclxuXHRcdFx0b2JqID0geyBsZWZ0OiArb2JqWzBdLCB0b3A6ICtvYmpbMV0gfHwgMCB9O1xyXG5cdFx0fVxyXG5cdFx0aWYgKFwibGVmdFwiIGluIG9iaikge1xyXG5cdFx0XHR0aGlzLm9mZnNldC5jbGljay5sZWZ0ID0gb2JqLmxlZnQgKyB0aGlzLm1hcmdpbnMubGVmdDtcclxuXHRcdH1cclxuXHRcdGlmIChcInJpZ2h0XCIgaW4gb2JqKSB7XHJcblx0XHRcdHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPSB0aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoIC0gb2JqLnJpZ2h0ICsgdGhpcy5tYXJnaW5zLmxlZnQ7XHJcblx0XHR9XHJcblx0XHRpZiAoXCJ0b3BcIiBpbiBvYmopIHtcclxuXHRcdFx0dGhpcy5vZmZzZXQuY2xpY2sudG9wID0gb2JqLnRvcCArIHRoaXMubWFyZ2lucy50b3A7XHJcblx0XHR9XHJcblx0XHRpZiAoXCJib3R0b21cIiBpbiBvYmopIHtcclxuXHRcdFx0dGhpcy5vZmZzZXQuY2xpY2sudG9wID0gdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQgLSBvYmouYm90dG9tICsgdGhpcy5tYXJnaW5zLnRvcDtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRfaXNSb290Tm9kZTogZnVuY3Rpb24oIGVsZW1lbnQgKSB7XHJcblx0XHRyZXR1cm4gKCAvKGh0bWx8Ym9keSkvaSApLnRlc3QoIGVsZW1lbnQudGFnTmFtZSApIHx8IGVsZW1lbnQgPT09IHRoaXMuZG9jdW1lbnRbIDAgXTtcclxuXHR9LFxyXG5cclxuXHRfZ2V0UGFyZW50T2Zmc2V0OiBmdW5jdGlvbigpIHtcclxuXHJcblx0XHQvL0dldCB0aGUgb2Zmc2V0UGFyZW50IGFuZCBjYWNoZSBpdHMgcG9zaXRpb25cclxuXHRcdHZhciBwbyA9IHRoaXMub2Zmc2V0UGFyZW50Lm9mZnNldCgpLFxyXG5cdFx0XHRkb2N1bWVudCA9IHRoaXMuZG9jdW1lbnRbIDAgXTtcclxuXHJcblx0XHQvLyBUaGlzIGlzIGEgc3BlY2lhbCBjYXNlIHdoZXJlIHdlIG5lZWQgdG8gbW9kaWZ5IGEgb2Zmc2V0IGNhbGN1bGF0ZWQgb24gc3RhcnQsIHNpbmNlIHRoZSBmb2xsb3dpbmcgaGFwcGVuZWQ6XHJcblx0XHQvLyAxLiBUaGUgcG9zaXRpb24gb2YgdGhlIGhlbHBlciBpcyBhYnNvbHV0ZSwgc28gaXQncyBwb3NpdGlvbiBpcyBjYWxjdWxhdGVkIGJhc2VkIG9uIHRoZSBuZXh0IHBvc2l0aW9uZWQgcGFyZW50XHJcblx0XHQvLyAyLiBUaGUgYWN0dWFsIG9mZnNldCBwYXJlbnQgaXMgYSBjaGlsZCBvZiB0aGUgc2Nyb2xsIHBhcmVudCwgYW5kIHRoZSBzY3JvbGwgcGFyZW50IGlzbid0IHRoZSBkb2N1bWVudCwgd2hpY2ggbWVhbnMgdGhhdFxyXG5cdFx0Ly8gICAgdGhlIHNjcm9sbCBpcyBpbmNsdWRlZCBpbiB0aGUgaW5pdGlhbCBjYWxjdWxhdGlvbiBvZiB0aGUgb2Zmc2V0IG9mIHRoZSBwYXJlbnQsIGFuZCBuZXZlciByZWNhbGN1bGF0ZWQgdXBvbiBkcmFnXHJcblx0XHRpZiAodGhpcy5jc3NQb3NpdGlvbiA9PT0gXCJhYnNvbHV0ZVwiICYmIHRoaXMuc2Nyb2xsUGFyZW50WzBdICE9PSBkb2N1bWVudCAmJiAkLmNvbnRhaW5zKHRoaXMuc2Nyb2xsUGFyZW50WzBdLCB0aGlzLm9mZnNldFBhcmVudFswXSkpIHtcclxuXHRcdFx0cG8ubGVmdCArPSB0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KCk7XHJcblx0XHRcdHBvLnRvcCArPSB0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxUb3AoKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoIHRoaXMuX2lzUm9vdE5vZGUoIHRoaXMub2Zmc2V0UGFyZW50WyAwIF0gKSApIHtcclxuXHRcdFx0cG8gPSB7IHRvcDogMCwgbGVmdDogMCB9O1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB7XHJcblx0XHRcdHRvcDogcG8udG9wICsgKHBhcnNlSW50KHRoaXMub2Zmc2V0UGFyZW50LmNzcyhcImJvcmRlclRvcFdpZHRoXCIpLCAxMCkgfHwgMCksXHJcblx0XHRcdGxlZnQ6IHBvLmxlZnQgKyAocGFyc2VJbnQodGhpcy5vZmZzZXRQYXJlbnQuY3NzKFwiYm9yZGVyTGVmdFdpZHRoXCIpLCAxMCkgfHwgMClcclxuXHRcdH07XHJcblxyXG5cdH0sXHJcblxyXG5cdF9nZXRSZWxhdGl2ZU9mZnNldDogZnVuY3Rpb24oKSB7XHJcblx0XHRpZiAoIHRoaXMuY3NzUG9zaXRpb24gIT09IFwicmVsYXRpdmVcIiApIHtcclxuXHRcdFx0cmV0dXJuIHsgdG9wOiAwLCBsZWZ0OiAwIH07XHJcblx0XHR9XHJcblxyXG5cdFx0dmFyIHAgPSB0aGlzLmVsZW1lbnQucG9zaXRpb24oKSxcclxuXHRcdFx0c2Nyb2xsSXNSb290Tm9kZSA9IHRoaXMuX2lzUm9vdE5vZGUoIHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0gKTtcclxuXHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHR0b3A6IHAudG9wIC0gKCBwYXJzZUludCh0aGlzLmhlbHBlci5jc3MoIFwidG9wXCIgKSwgMTApIHx8IDAgKSArICggIXNjcm9sbElzUm9vdE5vZGUgPyB0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxUb3AoKSA6IDAgKSxcclxuXHRcdFx0bGVmdDogcC5sZWZ0IC0gKCBwYXJzZUludCh0aGlzLmhlbHBlci5jc3MoIFwibGVmdFwiICksIDEwKSB8fCAwICkgKyAoICFzY3JvbGxJc1Jvb3ROb2RlID8gdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCgpIDogMCApXHJcblx0XHR9O1xyXG5cclxuXHR9LFxyXG5cclxuXHRfY2FjaGVNYXJnaW5zOiBmdW5jdGlvbigpIHtcclxuXHRcdHRoaXMubWFyZ2lucyA9IHtcclxuXHRcdFx0bGVmdDogKHBhcnNlSW50KHRoaXMuZWxlbWVudC5jc3MoXCJtYXJnaW5MZWZ0XCIpLCAxMCkgfHwgMCksXHJcblx0XHRcdHRvcDogKHBhcnNlSW50KHRoaXMuZWxlbWVudC5jc3MoXCJtYXJnaW5Ub3BcIiksIDEwKSB8fCAwKSxcclxuXHRcdFx0cmlnaHQ6IChwYXJzZUludCh0aGlzLmVsZW1lbnQuY3NzKFwibWFyZ2luUmlnaHRcIiksIDEwKSB8fCAwKSxcclxuXHRcdFx0Ym90dG9tOiAocGFyc2VJbnQodGhpcy5lbGVtZW50LmNzcyhcIm1hcmdpbkJvdHRvbVwiKSwgMTApIHx8IDApXHJcblx0XHR9O1xyXG5cdH0sXHJcblxyXG5cdF9jYWNoZUhlbHBlclByb3BvcnRpb25zOiBmdW5jdGlvbigpIHtcclxuXHRcdHRoaXMuaGVscGVyUHJvcG9ydGlvbnMgPSB7XHJcblx0XHRcdHdpZHRoOiB0aGlzLmhlbHBlci5vdXRlcldpZHRoKCksXHJcblx0XHRcdGhlaWdodDogdGhpcy5oZWxwZXIub3V0ZXJIZWlnaHQoKVxyXG5cdFx0fTtcclxuXHR9LFxyXG5cclxuXHRfc2V0Q29udGFpbm1lbnQ6IGZ1bmN0aW9uKCkge1xyXG5cclxuXHRcdHZhciBpc1VzZXJTY3JvbGxhYmxlLCBjLCBjZSxcclxuXHRcdFx0byA9IHRoaXMub3B0aW9ucyxcclxuXHRcdFx0ZG9jdW1lbnQgPSB0aGlzLmRvY3VtZW50WyAwIF07XHJcblxyXG5cdFx0dGhpcy5yZWxhdGl2ZUNvbnRhaW5lciA9IG51bGw7XHJcblxyXG5cdFx0aWYgKCAhby5jb250YWlubWVudCApIHtcclxuXHRcdFx0dGhpcy5jb250YWlubWVudCA9IG51bGw7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoIG8uY29udGFpbm1lbnQgPT09IFwid2luZG93XCIgKSB7XHJcblx0XHRcdHRoaXMuY29udGFpbm1lbnQgPSBbXHJcblx0XHRcdFx0JCggd2luZG93ICkuc2Nyb2xsTGVmdCgpIC0gdGhpcy5vZmZzZXQucmVsYXRpdmUubGVmdCAtIHRoaXMub2Zmc2V0LnBhcmVudC5sZWZ0LFxyXG5cdFx0XHRcdCQoIHdpbmRvdyApLnNjcm9sbFRvcCgpIC0gdGhpcy5vZmZzZXQucmVsYXRpdmUudG9wIC0gdGhpcy5vZmZzZXQucGFyZW50LnRvcCxcclxuXHRcdFx0XHQkKCB3aW5kb3cgKS5zY3JvbGxMZWZ0KCkgKyAkKCB3aW5kb3cgKS53aWR0aCgpIC0gdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAtIHRoaXMubWFyZ2lucy5sZWZ0LFxyXG5cdFx0XHRcdCQoIHdpbmRvdyApLnNjcm9sbFRvcCgpICsgKCAkKCB3aW5kb3cgKS5oZWlnaHQoKSB8fCBkb2N1bWVudC5ib2R5LnBhcmVudE5vZGUuc2Nyb2xsSGVpZ2h0ICkgLSB0aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCAtIHRoaXMubWFyZ2lucy50b3BcclxuXHRcdFx0XTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICggby5jb250YWlubWVudCA9PT0gXCJkb2N1bWVudFwiKSB7XHJcblx0XHRcdHRoaXMuY29udGFpbm1lbnQgPSBbXHJcblx0XHRcdFx0MCxcclxuXHRcdFx0XHQwLFxyXG5cdFx0XHRcdCQoIGRvY3VtZW50ICkud2lkdGgoKSAtIHRoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGggLSB0aGlzLm1hcmdpbnMubGVmdCxcclxuXHRcdFx0XHQoICQoIGRvY3VtZW50ICkuaGVpZ2h0KCkgfHwgZG9jdW1lbnQuYm9keS5wYXJlbnROb2RlLnNjcm9sbEhlaWdodCApIC0gdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQgLSB0aGlzLm1hcmdpbnMudG9wXHJcblx0XHRcdF07XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoIG8uY29udGFpbm1lbnQuY29uc3RydWN0b3IgPT09IEFycmF5ICkge1xyXG5cdFx0XHR0aGlzLmNvbnRhaW5tZW50ID0gby5jb250YWlubWVudDtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICggby5jb250YWlubWVudCA9PT0gXCJwYXJlbnRcIiApIHtcclxuXHRcdFx0by5jb250YWlubWVudCA9IHRoaXMuaGVscGVyWyAwIF0ucGFyZW50Tm9kZTtcclxuXHRcdH1cclxuXHJcblx0XHRjID0gJCggby5jb250YWlubWVudCApO1xyXG5cdFx0Y2UgPSBjWyAwIF07XHJcblxyXG5cdFx0aWYgKCAhY2UgKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRpc1VzZXJTY3JvbGxhYmxlID0gLyhzY3JvbGx8YXV0bykvLnRlc3QoIGMuY3NzKCBcIm92ZXJmbG93XCIgKSApO1xyXG5cclxuXHRcdHRoaXMuY29udGFpbm1lbnQgPSBbXHJcblx0XHRcdCggcGFyc2VJbnQoIGMuY3NzKCBcImJvcmRlckxlZnRXaWR0aFwiICksIDEwICkgfHwgMCApICsgKCBwYXJzZUludCggYy5jc3MoIFwicGFkZGluZ0xlZnRcIiApLCAxMCApIHx8IDAgKSxcclxuXHRcdFx0KCBwYXJzZUludCggYy5jc3MoIFwiYm9yZGVyVG9wV2lkdGhcIiApLCAxMCApIHx8IDAgKSArICggcGFyc2VJbnQoIGMuY3NzKCBcInBhZGRpbmdUb3BcIiApLCAxMCApIHx8IDAgKSxcclxuXHRcdFx0KCBpc1VzZXJTY3JvbGxhYmxlID8gTWF0aC5tYXgoIGNlLnNjcm9sbFdpZHRoLCBjZS5vZmZzZXRXaWR0aCApIDogY2Uub2Zmc2V0V2lkdGggKSAtXHJcblx0XHRcdFx0KCBwYXJzZUludCggYy5jc3MoIFwiYm9yZGVyUmlnaHRXaWR0aFwiICksIDEwICkgfHwgMCApIC1cclxuXHRcdFx0XHQoIHBhcnNlSW50KCBjLmNzcyggXCJwYWRkaW5nUmlnaHRcIiApLCAxMCApIHx8IDAgKSAtXHJcblx0XHRcdFx0dGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAtXHJcblx0XHRcdFx0dGhpcy5tYXJnaW5zLmxlZnQgLVxyXG5cdFx0XHRcdHRoaXMubWFyZ2lucy5yaWdodCxcclxuXHRcdFx0KCBpc1VzZXJTY3JvbGxhYmxlID8gTWF0aC5tYXgoIGNlLnNjcm9sbEhlaWdodCwgY2Uub2Zmc2V0SGVpZ2h0ICkgOiBjZS5vZmZzZXRIZWlnaHQgKSAtXHJcblx0XHRcdFx0KCBwYXJzZUludCggYy5jc3MoIFwiYm9yZGVyQm90dG9tV2lkdGhcIiApLCAxMCApIHx8IDAgKSAtXHJcblx0XHRcdFx0KCBwYXJzZUludCggYy5jc3MoIFwicGFkZGluZ0JvdHRvbVwiICksIDEwICkgfHwgMCApIC1cclxuXHRcdFx0XHR0aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCAtXHJcblx0XHRcdFx0dGhpcy5tYXJnaW5zLnRvcCAtXHJcblx0XHRcdFx0dGhpcy5tYXJnaW5zLmJvdHRvbVxyXG5cdFx0XTtcclxuXHRcdHRoaXMucmVsYXRpdmVDb250YWluZXIgPSBjO1xyXG5cdH0sXHJcblxyXG5cdF9jb252ZXJ0UG9zaXRpb25UbzogZnVuY3Rpb24oZCwgcG9zKSB7XHJcblxyXG5cdFx0aWYgKCFwb3MpIHtcclxuXHRcdFx0cG9zID0gdGhpcy5wb3NpdGlvbjtcclxuXHRcdH1cclxuXHJcblx0XHR2YXIgbW9kID0gZCA9PT0gXCJhYnNvbHV0ZVwiID8gMSA6IC0xLFxyXG5cdFx0XHRzY3JvbGxJc1Jvb3ROb2RlID0gdGhpcy5faXNSb290Tm9kZSggdGhpcy5zY3JvbGxQYXJlbnRbIDAgXSApO1xyXG5cclxuXHRcdHJldHVybiB7XHJcblx0XHRcdHRvcDogKFxyXG5cdFx0XHRcdHBvcy50b3BcdCtcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRoZSBhYnNvbHV0ZSBtb3VzZSBwb3NpdGlvblxyXG5cdFx0XHRcdHRoaXMub2Zmc2V0LnJlbGF0aXZlLnRvcCAqIG1vZCArXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBPbmx5IGZvciByZWxhdGl2ZSBwb3NpdGlvbmVkIG5vZGVzOiBSZWxhdGl2ZSBvZmZzZXQgZnJvbSBlbGVtZW50IHRvIG9mZnNldCBwYXJlbnRcclxuXHRcdFx0XHR0aGlzLm9mZnNldC5wYXJlbnQudG9wICogbW9kIC1cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRoZSBvZmZzZXRQYXJlbnQncyBvZmZzZXQgd2l0aG91dCBib3JkZXJzIChvZmZzZXQgKyBib3JkZXIpXHJcblx0XHRcdFx0KCAoIHRoaXMuY3NzUG9zaXRpb24gPT09IFwiZml4ZWRcIiA/IC10aGlzLm9mZnNldC5zY3JvbGwudG9wIDogKCBzY3JvbGxJc1Jvb3ROb2RlID8gMCA6IHRoaXMub2Zmc2V0LnNjcm9sbC50b3AgKSApICogbW9kKVxyXG5cdFx0XHQpLFxyXG5cdFx0XHRsZWZ0OiAoXHJcblx0XHRcdFx0cG9zLmxlZnQgK1x0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIGFic29sdXRlIG1vdXNlIHBvc2l0aW9uXHJcblx0XHRcdFx0dGhpcy5vZmZzZXQucmVsYXRpdmUubGVmdCAqIG1vZCArXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBPbmx5IGZvciByZWxhdGl2ZSBwb3NpdGlvbmVkIG5vZGVzOiBSZWxhdGl2ZSBvZmZzZXQgZnJvbSBlbGVtZW50IHRvIG9mZnNldCBwYXJlbnRcclxuXHRcdFx0XHR0aGlzLm9mZnNldC5wYXJlbnQubGVmdCAqIG1vZFx0LVx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIG9mZnNldFBhcmVudCdzIG9mZnNldCB3aXRob3V0IGJvcmRlcnMgKG9mZnNldCArIGJvcmRlcilcclxuXHRcdFx0XHQoICggdGhpcy5jc3NQb3NpdGlvbiA9PT0gXCJmaXhlZFwiID8gLXRoaXMub2Zmc2V0LnNjcm9sbC5sZWZ0IDogKCBzY3JvbGxJc1Jvb3ROb2RlID8gMCA6IHRoaXMub2Zmc2V0LnNjcm9sbC5sZWZ0ICkgKSAqIG1vZClcclxuXHRcdFx0KVxyXG5cdFx0fTtcclxuXHJcblx0fSxcclxuXHJcblx0X2dlbmVyYXRlUG9zaXRpb246IGZ1bmN0aW9uKCBldmVudCwgY29uc3RyYWluUG9zaXRpb24gKSB7XHJcblxyXG5cdFx0dmFyIGNvbnRhaW5tZW50LCBjbywgdG9wLCBsZWZ0LFxyXG5cdFx0XHRvID0gdGhpcy5vcHRpb25zLFxyXG5cdFx0XHRzY3JvbGxJc1Jvb3ROb2RlID0gdGhpcy5faXNSb290Tm9kZSggdGhpcy5zY3JvbGxQYXJlbnRbIDAgXSApLFxyXG5cdFx0XHRwYWdlWCA9IGV2ZW50LnBhZ2VYLFxyXG5cdFx0XHRwYWdlWSA9IGV2ZW50LnBhZ2VZO1xyXG5cclxuXHRcdC8vIENhY2hlIHRoZSBzY3JvbGxcclxuXHRcdGlmICggIXNjcm9sbElzUm9vdE5vZGUgfHwgIXRoaXMub2Zmc2V0LnNjcm9sbCApIHtcclxuXHRcdFx0dGhpcy5vZmZzZXQuc2Nyb2xsID0ge1xyXG5cdFx0XHRcdHRvcDogdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsVG9wKCksXHJcblx0XHRcdFx0bGVmdDogdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCgpXHJcblx0XHRcdH07XHJcblx0XHR9XHJcblxyXG5cdFx0LypcclxuXHRcdCAqIC0gUG9zaXRpb24gY29uc3RyYWluaW5nIC1cclxuXHRcdCAqIENvbnN0cmFpbiB0aGUgcG9zaXRpb24gdG8gYSBtaXggb2YgZ3JpZCwgY29udGFpbm1lbnQuXHJcblx0XHQgKi9cclxuXHJcblx0XHQvLyBJZiB3ZSBhcmUgbm90IGRyYWdnaW5nIHlldCwgd2Ugd29uJ3QgY2hlY2sgZm9yIG9wdGlvbnNcclxuXHRcdGlmICggY29uc3RyYWluUG9zaXRpb24gKSB7XHJcblx0XHRcdGlmICggdGhpcy5jb250YWlubWVudCApIHtcclxuXHRcdFx0XHRpZiAoIHRoaXMucmVsYXRpdmVDb250YWluZXIgKXtcclxuXHRcdFx0XHRcdGNvID0gdGhpcy5yZWxhdGl2ZUNvbnRhaW5lci5vZmZzZXQoKTtcclxuXHRcdFx0XHRcdGNvbnRhaW5tZW50ID0gW1xyXG5cdFx0XHRcdFx0XHR0aGlzLmNvbnRhaW5tZW50WyAwIF0gKyBjby5sZWZ0LFxyXG5cdFx0XHRcdFx0XHR0aGlzLmNvbnRhaW5tZW50WyAxIF0gKyBjby50b3AsXHJcblx0XHRcdFx0XHRcdHRoaXMuY29udGFpbm1lbnRbIDIgXSArIGNvLmxlZnQsXHJcblx0XHRcdFx0XHRcdHRoaXMuY29udGFpbm1lbnRbIDMgXSArIGNvLnRvcFxyXG5cdFx0XHRcdFx0XTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0Y29udGFpbm1lbnQgPSB0aGlzLmNvbnRhaW5tZW50O1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0aWYgKGV2ZW50LnBhZ2VYIC0gdGhpcy5vZmZzZXQuY2xpY2subGVmdCA8IGNvbnRhaW5tZW50WzBdKSB7XHJcblx0XHRcdFx0XHRwYWdlWCA9IGNvbnRhaW5tZW50WzBdICsgdGhpcy5vZmZzZXQuY2xpY2subGVmdDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKGV2ZW50LnBhZ2VZIC0gdGhpcy5vZmZzZXQuY2xpY2sudG9wIDwgY29udGFpbm1lbnRbMV0pIHtcclxuXHRcdFx0XHRcdHBhZ2VZID0gY29udGFpbm1lbnRbMV0gKyB0aGlzLm9mZnNldC5jbGljay50b3A7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmIChldmVudC5wYWdlWCAtIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPiBjb250YWlubWVudFsyXSkge1xyXG5cdFx0XHRcdFx0cGFnZVggPSBjb250YWlubWVudFsyXSArIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQ7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmIChldmVudC5wYWdlWSAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA+IGNvbnRhaW5tZW50WzNdKSB7XHJcblx0XHRcdFx0XHRwYWdlWSA9IGNvbnRhaW5tZW50WzNdICsgdGhpcy5vZmZzZXQuY2xpY2sudG9wO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKG8uZ3JpZCkge1xyXG5cdFx0XHRcdC8vQ2hlY2sgZm9yIGdyaWQgZWxlbWVudHMgc2V0IHRvIDAgdG8gcHJldmVudCBkaXZpZGUgYnkgMCBlcnJvciBjYXVzaW5nIGludmFsaWQgYXJndW1lbnQgZXJyb3JzIGluIElFIChzZWUgdGlja2V0ICM2OTUwKVxyXG5cdFx0XHRcdHRvcCA9IG8uZ3JpZFsxXSA/IHRoaXMub3JpZ2luYWxQYWdlWSArIE1hdGgucm91bmQoKHBhZ2VZIC0gdGhpcy5vcmlnaW5hbFBhZ2VZKSAvIG8uZ3JpZFsxXSkgKiBvLmdyaWRbMV0gOiB0aGlzLm9yaWdpbmFsUGFnZVk7XHJcblx0XHRcdFx0cGFnZVkgPSBjb250YWlubWVudCA/ICgodG9wIC0gdGhpcy5vZmZzZXQuY2xpY2sudG9wID49IGNvbnRhaW5tZW50WzFdIHx8IHRvcCAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA+IGNvbnRhaW5tZW50WzNdKSA/IHRvcCA6ICgodG9wIC0gdGhpcy5vZmZzZXQuY2xpY2sudG9wID49IGNvbnRhaW5tZW50WzFdKSA/IHRvcCAtIG8uZ3JpZFsxXSA6IHRvcCArIG8uZ3JpZFsxXSkpIDogdG9wO1xyXG5cclxuXHRcdFx0XHRsZWZ0ID0gby5ncmlkWzBdID8gdGhpcy5vcmlnaW5hbFBhZ2VYICsgTWF0aC5yb3VuZCgocGFnZVggLSB0aGlzLm9yaWdpbmFsUGFnZVgpIC8gby5ncmlkWzBdKSAqIG8uZ3JpZFswXSA6IHRoaXMub3JpZ2luYWxQYWdlWDtcclxuXHRcdFx0XHRwYWdlWCA9IGNvbnRhaW5tZW50ID8gKChsZWZ0IC0gdGhpcy5vZmZzZXQuY2xpY2subGVmdCA+PSBjb250YWlubWVudFswXSB8fCBsZWZ0IC0gdGhpcy5vZmZzZXQuY2xpY2subGVmdCA+IGNvbnRhaW5tZW50WzJdKSA/IGxlZnQgOiAoKGxlZnQgLSB0aGlzLm9mZnNldC5jbGljay5sZWZ0ID49IGNvbnRhaW5tZW50WzBdKSA/IGxlZnQgLSBvLmdyaWRbMF0gOiBsZWZ0ICsgby5ncmlkWzBdKSkgOiBsZWZ0O1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZiAoIG8uYXhpcyA9PT0gXCJ5XCIgKSB7XHJcblx0XHRcdFx0cGFnZVggPSB0aGlzLm9yaWdpbmFsUGFnZVg7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmICggby5heGlzID09PSBcInhcIiApIHtcclxuXHRcdFx0XHRwYWdlWSA9IHRoaXMub3JpZ2luYWxQYWdlWTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB7XHJcblx0XHRcdHRvcDogKFxyXG5cdFx0XHRcdHBhZ2VZIC1cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIGFic29sdXRlIG1vdXNlIHBvc2l0aW9uXHJcblx0XHRcdFx0dGhpcy5vZmZzZXQuY2xpY2sudG9wXHQtXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gQ2xpY2sgb2Zmc2V0IChyZWxhdGl2ZSB0byB0aGUgZWxlbWVudClcclxuXHRcdFx0XHR0aGlzLm9mZnNldC5yZWxhdGl2ZS50b3AgLVx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIE9ubHkgZm9yIHJlbGF0aXZlIHBvc2l0aW9uZWQgbm9kZXM6IFJlbGF0aXZlIG9mZnNldCBmcm9tIGVsZW1lbnQgdG8gb2Zmc2V0IHBhcmVudFxyXG5cdFx0XHRcdHRoaXMub2Zmc2V0LnBhcmVudC50b3AgK1x0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRoZSBvZmZzZXRQYXJlbnQncyBvZmZzZXQgd2l0aG91dCBib3JkZXJzIChvZmZzZXQgKyBib3JkZXIpXHJcblx0XHRcdFx0KCB0aGlzLmNzc1Bvc2l0aW9uID09PSBcImZpeGVkXCIgPyAtdGhpcy5vZmZzZXQuc2Nyb2xsLnRvcCA6ICggc2Nyb2xsSXNSb290Tm9kZSA/IDAgOiB0aGlzLm9mZnNldC5zY3JvbGwudG9wICkgKVxyXG5cdFx0XHQpLFxyXG5cdFx0XHRsZWZ0OiAoXHJcblx0XHRcdFx0cGFnZVggLVx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBUaGUgYWJzb2x1dGUgbW91c2UgcG9zaXRpb25cclxuXHRcdFx0XHR0aGlzLm9mZnNldC5jbGljay5sZWZ0IC1cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBDbGljayBvZmZzZXQgKHJlbGF0aXZlIHRvIHRoZSBlbGVtZW50KVxyXG5cdFx0XHRcdHRoaXMub2Zmc2V0LnJlbGF0aXZlLmxlZnQgLVx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIE9ubHkgZm9yIHJlbGF0aXZlIHBvc2l0aW9uZWQgbm9kZXM6IFJlbGF0aXZlIG9mZnNldCBmcm9tIGVsZW1lbnQgdG8gb2Zmc2V0IHBhcmVudFxyXG5cdFx0XHRcdHRoaXMub2Zmc2V0LnBhcmVudC5sZWZ0ICtcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBUaGUgb2Zmc2V0UGFyZW50J3Mgb2Zmc2V0IHdpdGhvdXQgYm9yZGVycyAob2Zmc2V0ICsgYm9yZGVyKVxyXG5cdFx0XHRcdCggdGhpcy5jc3NQb3NpdGlvbiA9PT0gXCJmaXhlZFwiID8gLXRoaXMub2Zmc2V0LnNjcm9sbC5sZWZ0IDogKCBzY3JvbGxJc1Jvb3ROb2RlID8gMCA6IHRoaXMub2Zmc2V0LnNjcm9sbC5sZWZ0ICkgKVxyXG5cdFx0XHQpXHJcblx0XHR9O1xyXG5cclxuXHR9LFxyXG5cclxuXHRfY2xlYXI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0dGhpcy5oZWxwZXIucmVtb3ZlQ2xhc3MoXCJ1aS1kcmFnZ2FibGUtZHJhZ2dpbmdcIik7XHJcblx0XHRpZiAodGhpcy5oZWxwZXJbMF0gIT09IHRoaXMuZWxlbWVudFswXSAmJiAhdGhpcy5jYW5jZWxIZWxwZXJSZW1vdmFsKSB7XHJcblx0XHRcdHRoaXMuaGVscGVyLnJlbW92ZSgpO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy5oZWxwZXIgPSBudWxsO1xyXG5cdFx0dGhpcy5jYW5jZWxIZWxwZXJSZW1vdmFsID0gZmFsc2U7XHJcblx0XHRpZiAoIHRoaXMuZGVzdHJveU9uQ2xlYXIgKSB7XHJcblx0XHRcdHRoaXMuZGVzdHJveSgpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdF9ub3JtYWxpemVSaWdodEJvdHRvbTogZnVuY3Rpb24oKSB7XHJcblx0XHRpZiAoIHRoaXMub3B0aW9ucy5heGlzICE9PSBcInlcIiAmJiB0aGlzLmhlbHBlci5jc3MoIFwicmlnaHRcIiApICE9PSBcImF1dG9cIiApIHtcclxuXHRcdFx0dGhpcy5oZWxwZXIud2lkdGgoIHRoaXMuaGVscGVyLndpZHRoKCkgKTtcclxuXHRcdFx0dGhpcy5oZWxwZXIuY3NzKCBcInJpZ2h0XCIsIFwiYXV0b1wiICk7XHJcblx0XHR9XHJcblx0XHRpZiAoIHRoaXMub3B0aW9ucy5heGlzICE9PSBcInhcIiAmJiB0aGlzLmhlbHBlci5jc3MoIFwiYm90dG9tXCIgKSAhPT0gXCJhdXRvXCIgKSB7XHJcblx0XHRcdHRoaXMuaGVscGVyLmhlaWdodCggdGhpcy5oZWxwZXIuaGVpZ2h0KCkgKTtcclxuXHRcdFx0dGhpcy5oZWxwZXIuY3NzKCBcImJvdHRvbVwiLCBcImF1dG9cIiApO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdC8vIEZyb20gbm93IG9uIGJ1bGsgc3R1ZmYgLSBtYWlubHkgaGVscGVyc1xyXG5cclxuXHRfdHJpZ2dlcjogZnVuY3Rpb24oIHR5cGUsIGV2ZW50LCB1aSApIHtcclxuXHRcdHVpID0gdWkgfHwgdGhpcy5fdWlIYXNoKCk7XHJcblx0XHQkLnVpLnBsdWdpbi5jYWxsKCB0aGlzLCB0eXBlLCBbIGV2ZW50LCB1aSwgdGhpcyBdLCB0cnVlICk7XHJcblxyXG5cdFx0Ly8gQWJzb2x1dGUgcG9zaXRpb24gYW5kIG9mZnNldCAoc2VlICM2ODg0ICkgaGF2ZSB0byBiZSByZWNhbGN1bGF0ZWQgYWZ0ZXIgcGx1Z2luc1xyXG5cdFx0aWYgKCAvXihkcmFnfHN0YXJ0fHN0b3ApLy50ZXN0KCB0eXBlICkgKSB7XHJcblx0XHRcdHRoaXMucG9zaXRpb25BYnMgPSB0aGlzLl9jb252ZXJ0UG9zaXRpb25UbyggXCJhYnNvbHV0ZVwiICk7XHJcblx0XHRcdHVpLm9mZnNldCA9IHRoaXMucG9zaXRpb25BYnM7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gJC5XaWRnZXQucHJvdG90eXBlLl90cmlnZ2VyLmNhbGwoIHRoaXMsIHR5cGUsIGV2ZW50LCB1aSApO1xyXG5cdH0sXHJcblxyXG5cdHBsdWdpbnM6IHt9LFxyXG5cclxuXHRfdWlIYXNoOiBmdW5jdGlvbigpIHtcclxuXHRcdHJldHVybiB7XHJcblx0XHRcdGhlbHBlcjogdGhpcy5oZWxwZXIsXHJcblx0XHRcdHBvc2l0aW9uOiB0aGlzLnBvc2l0aW9uLFxyXG5cdFx0XHRvcmlnaW5hbFBvc2l0aW9uOiB0aGlzLm9yaWdpbmFsUG9zaXRpb24sXHJcblx0XHRcdG9mZnNldDogdGhpcy5wb3NpdGlvbkFic1xyXG5cdFx0fTtcclxuXHR9XHJcblxyXG59KTtcclxuXHJcbiQudWkucGx1Z2luLmFkZCggXCJkcmFnZ2FibGVcIiwgXCJjb25uZWN0VG9Tb3J0YWJsZVwiLCB7XHJcblx0c3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWksIGRyYWdnYWJsZSApIHtcclxuXHRcdHZhciB1aVNvcnRhYmxlID0gJC5leHRlbmQoIHt9LCB1aSwge1xyXG5cdFx0XHRpdGVtOiBkcmFnZ2FibGUuZWxlbWVudFxyXG5cdFx0fSk7XHJcblxyXG5cdFx0ZHJhZ2dhYmxlLnNvcnRhYmxlcyA9IFtdO1xyXG5cdFx0JCggZHJhZ2dhYmxlLm9wdGlvbnMuY29ubmVjdFRvU29ydGFibGUgKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2YXIgc29ydGFibGUgPSAkKCB0aGlzICkuc29ydGFibGUoIFwiaW5zdGFuY2VcIiApO1xyXG5cclxuXHRcdFx0aWYgKCBzb3J0YWJsZSAmJiAhc29ydGFibGUub3B0aW9ucy5kaXNhYmxlZCApIHtcclxuXHRcdFx0XHRkcmFnZ2FibGUuc29ydGFibGVzLnB1c2goIHNvcnRhYmxlICk7XHJcblxyXG5cdFx0XHRcdC8vIHJlZnJlc2hQb3NpdGlvbnMgaXMgY2FsbGVkIGF0IGRyYWcgc3RhcnQgdG8gcmVmcmVzaCB0aGUgY29udGFpbmVyQ2FjaGVcclxuXHRcdFx0XHQvLyB3aGljaCBpcyB1c2VkIGluIGRyYWcuIFRoaXMgZW5zdXJlcyBpdCdzIGluaXRpYWxpemVkIGFuZCBzeW5jaHJvbml6ZWRcclxuXHRcdFx0XHQvLyB3aXRoIGFueSBjaGFuZ2VzIHRoYXQgbWlnaHQgaGF2ZSBoYXBwZW5lZCBvbiB0aGUgcGFnZSBzaW5jZSBpbml0aWFsaXphdGlvbi5cclxuXHRcdFx0XHRzb3J0YWJsZS5yZWZyZXNoUG9zaXRpb25zKCk7XHJcblx0XHRcdFx0c29ydGFibGUuX3RyaWdnZXIoXCJhY3RpdmF0ZVwiLCBldmVudCwgdWlTb3J0YWJsZSk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0c3RvcDogZnVuY3Rpb24oIGV2ZW50LCB1aSwgZHJhZ2dhYmxlICkge1xyXG5cdFx0dmFyIHVpU29ydGFibGUgPSAkLmV4dGVuZCgge30sIHVpLCB7XHJcblx0XHRcdGl0ZW06IGRyYWdnYWJsZS5lbGVtZW50XHJcblx0XHR9KTtcclxuXHJcblx0XHRkcmFnZ2FibGUuY2FuY2VsSGVscGVyUmVtb3ZhbCA9IGZhbHNlO1xyXG5cclxuXHRcdCQuZWFjaCggZHJhZ2dhYmxlLnNvcnRhYmxlcywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdHZhciBzb3J0YWJsZSA9IHRoaXM7XHJcblxyXG5cdFx0XHRpZiAoIHNvcnRhYmxlLmlzT3ZlciApIHtcclxuXHRcdFx0XHRzb3J0YWJsZS5pc092ZXIgPSAwO1xyXG5cclxuXHRcdFx0XHQvLyBBbGxvdyB0aGlzIHNvcnRhYmxlIHRvIGhhbmRsZSByZW1vdmluZyB0aGUgaGVscGVyXHJcblx0XHRcdFx0ZHJhZ2dhYmxlLmNhbmNlbEhlbHBlclJlbW92YWwgPSB0cnVlO1xyXG5cdFx0XHRcdHNvcnRhYmxlLmNhbmNlbEhlbHBlclJlbW92YWwgPSBmYWxzZTtcclxuXHJcblx0XHRcdFx0Ly8gVXNlIF9zdG9yZWRDU1MgVG8gcmVzdG9yZSBwcm9wZXJ0aWVzIGluIHRoZSBzb3J0YWJsZSxcclxuXHRcdFx0XHQvLyBhcyB0aGlzIGFsc28gaGFuZGxlcyByZXZlcnQgKCM5Njc1KSBzaW5jZSB0aGUgZHJhZ2dhYmxlXHJcblx0XHRcdFx0Ly8gbWF5IGhhdmUgbW9kaWZpZWQgdGhlbSBpbiB1bmV4cGVjdGVkIHdheXMgKCM4ODA5KVxyXG5cdFx0XHRcdHNvcnRhYmxlLl9zdG9yZWRDU1MgPSB7XHJcblx0XHRcdFx0XHRwb3NpdGlvbjogc29ydGFibGUucGxhY2Vob2xkZXIuY3NzKCBcInBvc2l0aW9uXCIgKSxcclxuXHRcdFx0XHRcdHRvcDogc29ydGFibGUucGxhY2Vob2xkZXIuY3NzKCBcInRvcFwiICksXHJcblx0XHRcdFx0XHRsZWZ0OiBzb3J0YWJsZS5wbGFjZWhvbGRlci5jc3MoIFwibGVmdFwiIClcclxuXHRcdFx0XHR9O1xyXG5cclxuXHRcdFx0XHRzb3J0YWJsZS5fbW91c2VTdG9wKGV2ZW50KTtcclxuXHJcblx0XHRcdFx0Ly8gT25jZSBkcmFnIGhhcyBlbmRlZCwgdGhlIHNvcnRhYmxlIHNob3VsZCByZXR1cm4gdG8gdXNpbmdcclxuXHRcdFx0XHQvLyBpdHMgb3JpZ2luYWwgaGVscGVyLCBub3QgdGhlIHNoYXJlZCBoZWxwZXIgZnJvbSBkcmFnZ2FibGVcclxuXHRcdFx0XHRzb3J0YWJsZS5vcHRpb25zLmhlbHBlciA9IHNvcnRhYmxlLm9wdGlvbnMuX2hlbHBlcjtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvLyBQcmV2ZW50IHRoaXMgU29ydGFibGUgZnJvbSByZW1vdmluZyB0aGUgaGVscGVyLlxyXG5cdFx0XHRcdC8vIEhvd2V2ZXIsIGRvbid0IHNldCB0aGUgZHJhZ2dhYmxlIHRvIHJlbW92ZSB0aGUgaGVscGVyXHJcblx0XHRcdFx0Ly8gZWl0aGVyIGFzIGFub3RoZXIgY29ubmVjdGVkIFNvcnRhYmxlIG1heSB5ZXQgaGFuZGxlIHRoZSByZW1vdmFsLlxyXG5cdFx0XHRcdHNvcnRhYmxlLmNhbmNlbEhlbHBlclJlbW92YWwgPSB0cnVlO1xyXG5cclxuXHRcdFx0XHRzb3J0YWJsZS5fdHJpZ2dlciggXCJkZWFjdGl2YXRlXCIsIGV2ZW50LCB1aVNvcnRhYmxlICk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0ZHJhZzogZnVuY3Rpb24oIGV2ZW50LCB1aSwgZHJhZ2dhYmxlICkge1xyXG5cdFx0JC5lYWNoKCBkcmFnZ2FibGUuc29ydGFibGVzLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0dmFyIGlubmVybW9zdEludGVyc2VjdGluZyA9IGZhbHNlLFxyXG5cdFx0XHRcdHNvcnRhYmxlID0gdGhpcztcclxuXHJcblx0XHRcdC8vIENvcHkgb3ZlciB2YXJpYWJsZXMgdGhhdCBzb3J0YWJsZSdzIF9pbnRlcnNlY3RzV2l0aCB1c2VzXHJcblx0XHRcdHNvcnRhYmxlLnBvc2l0aW9uQWJzID0gZHJhZ2dhYmxlLnBvc2l0aW9uQWJzO1xyXG5cdFx0XHRzb3J0YWJsZS5oZWxwZXJQcm9wb3J0aW9ucyA9IGRyYWdnYWJsZS5oZWxwZXJQcm9wb3J0aW9ucztcclxuXHRcdFx0c29ydGFibGUub2Zmc2V0LmNsaWNrID0gZHJhZ2dhYmxlLm9mZnNldC5jbGljaztcclxuXHJcblx0XHRcdGlmICggc29ydGFibGUuX2ludGVyc2VjdHNXaXRoKCBzb3J0YWJsZS5jb250YWluZXJDYWNoZSApICkge1xyXG5cdFx0XHRcdGlubmVybW9zdEludGVyc2VjdGluZyA9IHRydWU7XHJcblxyXG5cdFx0XHRcdCQuZWFjaCggZHJhZ2dhYmxlLnNvcnRhYmxlcywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQvLyBDb3B5IG92ZXIgdmFyaWFibGVzIHRoYXQgc29ydGFibGUncyBfaW50ZXJzZWN0c1dpdGggdXNlc1xyXG5cdFx0XHRcdFx0dGhpcy5wb3NpdGlvbkFicyA9IGRyYWdnYWJsZS5wb3NpdGlvbkFicztcclxuXHRcdFx0XHRcdHRoaXMuaGVscGVyUHJvcG9ydGlvbnMgPSBkcmFnZ2FibGUuaGVscGVyUHJvcG9ydGlvbnM7XHJcblx0XHRcdFx0XHR0aGlzLm9mZnNldC5jbGljayA9IGRyYWdnYWJsZS5vZmZzZXQuY2xpY2s7XHJcblxyXG5cdFx0XHRcdFx0aWYgKCB0aGlzICE9PSBzb3J0YWJsZSAmJlxyXG5cdFx0XHRcdFx0XHRcdHRoaXMuX2ludGVyc2VjdHNXaXRoKCB0aGlzLmNvbnRhaW5lckNhY2hlICkgJiZcclxuXHRcdFx0XHRcdFx0XHQkLmNvbnRhaW5zKCBzb3J0YWJsZS5lbGVtZW50WyAwIF0sIHRoaXMuZWxlbWVudFsgMCBdICkgKSB7XHJcblx0XHRcdFx0XHRcdGlubmVybW9zdEludGVyc2VjdGluZyA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdHJldHVybiBpbm5lcm1vc3RJbnRlcnNlY3Rpbmc7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmICggaW5uZXJtb3N0SW50ZXJzZWN0aW5nICkge1xyXG5cdFx0XHRcdC8vIElmIGl0IGludGVyc2VjdHMsIHdlIHVzZSBhIGxpdHRsZSBpc092ZXIgdmFyaWFibGUgYW5kIHNldCBpdCBvbmNlLFxyXG5cdFx0XHRcdC8vIHNvIHRoYXQgdGhlIG1vdmUtaW4gc3R1ZmYgZ2V0cyBmaXJlZCBvbmx5IG9uY2UuXHJcblx0XHRcdFx0aWYgKCAhc29ydGFibGUuaXNPdmVyICkge1xyXG5cdFx0XHRcdFx0c29ydGFibGUuaXNPdmVyID0gMTtcclxuXHJcblx0XHRcdFx0XHQvLyBTdG9yZSBkcmFnZ2FibGUncyBwYXJlbnQgaW4gY2FzZSB3ZSBuZWVkIHRvIHJlYXBwZW5kIHRvIGl0IGxhdGVyLlxyXG5cdFx0XHRcdFx0ZHJhZ2dhYmxlLl9wYXJlbnQgPSB1aS5oZWxwZXIucGFyZW50KCk7XHJcblxyXG5cdFx0XHRcdFx0c29ydGFibGUuY3VycmVudEl0ZW0gPSB1aS5oZWxwZXJcclxuXHRcdFx0XHRcdFx0LmFwcGVuZFRvKCBzb3J0YWJsZS5lbGVtZW50IClcclxuXHRcdFx0XHRcdFx0LmRhdGEoIFwidWktc29ydGFibGUtaXRlbVwiLCB0cnVlICk7XHJcblxyXG5cdFx0XHRcdFx0Ly8gU3RvcmUgaGVscGVyIG9wdGlvbiB0byBsYXRlciByZXN0b3JlIGl0XHJcblx0XHRcdFx0XHRzb3J0YWJsZS5vcHRpb25zLl9oZWxwZXIgPSBzb3J0YWJsZS5vcHRpb25zLmhlbHBlcjtcclxuXHJcblx0XHRcdFx0XHRzb3J0YWJsZS5vcHRpb25zLmhlbHBlciA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gdWkuaGVscGVyWyAwIF07XHJcblx0XHRcdFx0XHR9O1xyXG5cclxuXHRcdFx0XHRcdC8vIEZpcmUgdGhlIHN0YXJ0IGV2ZW50cyBvZiB0aGUgc29ydGFibGUgd2l0aCBvdXIgcGFzc2VkIGJyb3dzZXIgZXZlbnQsXHJcblx0XHRcdFx0XHQvLyBhbmQgb3VyIG93biBoZWxwZXIgKHNvIGl0IGRvZXNuJ3QgY3JlYXRlIGEgbmV3IG9uZSlcclxuXHRcdFx0XHRcdGV2ZW50LnRhcmdldCA9IHNvcnRhYmxlLmN1cnJlbnRJdGVtWyAwIF07XHJcblx0XHRcdFx0XHRzb3J0YWJsZS5fbW91c2VDYXB0dXJlKCBldmVudCwgdHJ1ZSApO1xyXG5cdFx0XHRcdFx0c29ydGFibGUuX21vdXNlU3RhcnQoIGV2ZW50LCB0cnVlLCB0cnVlICk7XHJcblxyXG5cdFx0XHRcdFx0Ly8gQmVjYXVzZSB0aGUgYnJvd3NlciBldmVudCBpcyB3YXkgb2ZmIHRoZSBuZXcgYXBwZW5kZWQgcG9ydGxldCxcclxuXHRcdFx0XHRcdC8vIG1vZGlmeSBuZWNlc3NhcnkgdmFyaWFibGVzIHRvIHJlZmxlY3QgdGhlIGNoYW5nZXNcclxuXHRcdFx0XHRcdHNvcnRhYmxlLm9mZnNldC5jbGljay50b3AgPSBkcmFnZ2FibGUub2Zmc2V0LmNsaWNrLnRvcDtcclxuXHRcdFx0XHRcdHNvcnRhYmxlLm9mZnNldC5jbGljay5sZWZ0ID0gZHJhZ2dhYmxlLm9mZnNldC5jbGljay5sZWZ0O1xyXG5cdFx0XHRcdFx0c29ydGFibGUub2Zmc2V0LnBhcmVudC5sZWZ0IC09IGRyYWdnYWJsZS5vZmZzZXQucGFyZW50LmxlZnQgLVxyXG5cdFx0XHRcdFx0XHRzb3J0YWJsZS5vZmZzZXQucGFyZW50LmxlZnQ7XHJcblx0XHRcdFx0XHRzb3J0YWJsZS5vZmZzZXQucGFyZW50LnRvcCAtPSBkcmFnZ2FibGUub2Zmc2V0LnBhcmVudC50b3AgLVxyXG5cdFx0XHRcdFx0XHRzb3J0YWJsZS5vZmZzZXQucGFyZW50LnRvcDtcclxuXHJcblx0XHRcdFx0XHRkcmFnZ2FibGUuX3RyaWdnZXIoIFwidG9Tb3J0YWJsZVwiLCBldmVudCApO1xyXG5cclxuXHRcdFx0XHRcdC8vIEluZm9ybSBkcmFnZ2FibGUgdGhhdCB0aGUgaGVscGVyIGlzIGluIGEgdmFsaWQgZHJvcCB6b25lLFxyXG5cdFx0XHRcdFx0Ly8gdXNlZCBzb2xlbHkgaW4gdGhlIHJldmVydCBvcHRpb24gdG8gaGFuZGxlIFwidmFsaWQvaW52YWxpZFwiLlxyXG5cdFx0XHRcdFx0ZHJhZ2dhYmxlLmRyb3BwZWQgPSBzb3J0YWJsZS5lbGVtZW50O1xyXG5cclxuXHRcdFx0XHRcdC8vIE5lZWQgdG8gcmVmcmVzaFBvc2l0aW9ucyBvZiBhbGwgc29ydGFibGVzIGluIHRoZSBjYXNlIHRoYXRcclxuXHRcdFx0XHRcdC8vIGFkZGluZyB0byBvbmUgc29ydGFibGUgY2hhbmdlcyB0aGUgbG9jYXRpb24gb2YgdGhlIG90aGVyIHNvcnRhYmxlcyAoIzk2NzUpXHJcblx0XHRcdFx0XHQkLmVhY2goIGRyYWdnYWJsZS5zb3J0YWJsZXMsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLnJlZnJlc2hQb3NpdGlvbnMoKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHRcdC8vIGhhY2sgc28gcmVjZWl2ZS91cGRhdGUgY2FsbGJhY2tzIHdvcmsgKG1vc3RseSlcclxuXHRcdFx0XHRcdGRyYWdnYWJsZS5jdXJyZW50SXRlbSA9IGRyYWdnYWJsZS5lbGVtZW50O1xyXG5cdFx0XHRcdFx0c29ydGFibGUuZnJvbU91dHNpZGUgPSBkcmFnZ2FibGU7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRpZiAoIHNvcnRhYmxlLmN1cnJlbnRJdGVtICkge1xyXG5cdFx0XHRcdFx0c29ydGFibGUuX21vdXNlRHJhZyggZXZlbnQgKTtcclxuXHRcdFx0XHRcdC8vIENvcHkgdGhlIHNvcnRhYmxlJ3MgcG9zaXRpb24gYmVjYXVzZSB0aGUgZHJhZ2dhYmxlJ3MgY2FuIHBvdGVudGlhbGx5IHJlZmxlY3RcclxuXHRcdFx0XHRcdC8vIGEgcmVsYXRpdmUgcG9zaXRpb24sIHdoaWxlIHNvcnRhYmxlIGlzIGFsd2F5cyBhYnNvbHV0ZSwgd2hpY2ggdGhlIGRyYWdnZWRcclxuXHRcdFx0XHRcdC8vIGVsZW1lbnQgaGFzIG5vdyBiZWNvbWUuICgjODgwOSlcclxuXHRcdFx0XHRcdHVpLnBvc2l0aW9uID0gc29ydGFibGUucG9zaXRpb247XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdC8vIElmIGl0IGRvZXNuJ3QgaW50ZXJzZWN0IHdpdGggdGhlIHNvcnRhYmxlLCBhbmQgaXQgaW50ZXJzZWN0ZWQgYmVmb3JlLFxyXG5cdFx0XHRcdC8vIHdlIGZha2UgdGhlIGRyYWcgc3RvcCBvZiB0aGUgc29ydGFibGUsIGJ1dCBtYWtlIHN1cmUgaXQgZG9lc24ndCByZW1vdmVcclxuXHRcdFx0XHQvLyB0aGUgaGVscGVyIGJ5IHVzaW5nIGNhbmNlbEhlbHBlclJlbW92YWwuXHJcblx0XHRcdFx0aWYgKCBzb3J0YWJsZS5pc092ZXIgKSB7XHJcblxyXG5cdFx0XHRcdFx0c29ydGFibGUuaXNPdmVyID0gMDtcclxuXHRcdFx0XHRcdHNvcnRhYmxlLmNhbmNlbEhlbHBlclJlbW92YWwgPSB0cnVlO1xyXG5cclxuXHRcdFx0XHRcdC8vIENhbGxpbmcgc29ydGFibGUncyBtb3VzZVN0b3Agd291bGQgdHJpZ2dlciBhIHJldmVydCxcclxuXHRcdFx0XHRcdC8vIHNvIHJldmVydCBtdXN0IGJlIHRlbXBvcmFyaWx5IGZhbHNlIHVudGlsIGFmdGVyIG1vdXNlU3RvcCBpcyBjYWxsZWQuXHJcblx0XHRcdFx0XHRzb3J0YWJsZS5vcHRpb25zLl9yZXZlcnQgPSBzb3J0YWJsZS5vcHRpb25zLnJldmVydDtcclxuXHRcdFx0XHRcdHNvcnRhYmxlLm9wdGlvbnMucmV2ZXJ0ID0gZmFsc2U7XHJcblxyXG5cdFx0XHRcdFx0c29ydGFibGUuX3RyaWdnZXIoIFwib3V0XCIsIGV2ZW50LCBzb3J0YWJsZS5fdWlIYXNoKCBzb3J0YWJsZSApICk7XHJcblx0XHRcdFx0XHRzb3J0YWJsZS5fbW91c2VTdG9wKCBldmVudCwgdHJ1ZSApO1xyXG5cclxuXHRcdFx0XHRcdC8vIHJlc3RvcmUgc29ydGFibGUgYmVoYXZpb3JzIHRoYXQgd2VyZSBtb2RmaWVkXHJcblx0XHRcdFx0XHQvLyB3aGVuIHRoZSBkcmFnZ2FibGUgZW50ZXJlZCB0aGUgc29ydGFibGUgYXJlYSAoIzk0ODEpXHJcblx0XHRcdFx0XHRzb3J0YWJsZS5vcHRpb25zLnJldmVydCA9IHNvcnRhYmxlLm9wdGlvbnMuX3JldmVydDtcclxuXHRcdFx0XHRcdHNvcnRhYmxlLm9wdGlvbnMuaGVscGVyID0gc29ydGFibGUub3B0aW9ucy5faGVscGVyO1xyXG5cclxuXHRcdFx0XHRcdGlmICggc29ydGFibGUucGxhY2Vob2xkZXIgKSB7XHJcblx0XHRcdFx0XHRcdHNvcnRhYmxlLnBsYWNlaG9sZGVyLnJlbW92ZSgpO1xyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdC8vIFJlc3RvcmUgYW5kIHJlY2FsY3VsYXRlIHRoZSBkcmFnZ2FibGUncyBvZmZzZXQgY29uc2lkZXJpbmcgdGhlIHNvcnRhYmxlXHJcblx0XHRcdFx0XHQvLyBtYXkgaGF2ZSBtb2RpZmllZCB0aGVtIGluIHVuZXhwZWN0ZWQgd2F5cy4gKCM4ODA5LCAjMTA2NjkpXHJcblx0XHRcdFx0XHR1aS5oZWxwZXIuYXBwZW5kVG8oIGRyYWdnYWJsZS5fcGFyZW50ICk7XHJcblx0XHRcdFx0XHRkcmFnZ2FibGUuX3JlZnJlc2hPZmZzZXRzKCBldmVudCApO1xyXG5cdFx0XHRcdFx0dWkucG9zaXRpb24gPSBkcmFnZ2FibGUuX2dlbmVyYXRlUG9zaXRpb24oIGV2ZW50LCB0cnVlICk7XHJcblxyXG5cdFx0XHRcdFx0ZHJhZ2dhYmxlLl90cmlnZ2VyKCBcImZyb21Tb3J0YWJsZVwiLCBldmVudCApO1xyXG5cclxuXHRcdFx0XHRcdC8vIEluZm9ybSBkcmFnZ2FibGUgdGhhdCB0aGUgaGVscGVyIGlzIG5vIGxvbmdlciBpbiBhIHZhbGlkIGRyb3Agem9uZVxyXG5cdFx0XHRcdFx0ZHJhZ2dhYmxlLmRyb3BwZWQgPSBmYWxzZTtcclxuXHJcblx0XHRcdFx0XHQvLyBOZWVkIHRvIHJlZnJlc2hQb3NpdGlvbnMgb2YgYWxsIHNvcnRhYmxlcyBqdXN0IGluIGNhc2UgcmVtb3ZpbmdcclxuXHRcdFx0XHRcdC8vIGZyb20gb25lIHNvcnRhYmxlIGNoYW5nZXMgdGhlIGxvY2F0aW9uIG9mIG90aGVyIHNvcnRhYmxlcyAoIzk2NzUpXHJcblx0XHRcdFx0XHQkLmVhY2goIGRyYWdnYWJsZS5zb3J0YWJsZXMsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLnJlZnJlc2hQb3NpdGlvbnMoKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59KTtcclxuXHJcbiQudWkucGx1Z2luLmFkZChcImRyYWdnYWJsZVwiLCBcImN1cnNvclwiLCB7XHJcblx0c3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWksIGluc3RhbmNlICkge1xyXG5cdFx0dmFyIHQgPSAkKCBcImJvZHlcIiApLFxyXG5cdFx0XHRvID0gaW5zdGFuY2Uub3B0aW9ucztcclxuXHJcblx0XHRpZiAodC5jc3MoXCJjdXJzb3JcIikpIHtcclxuXHRcdFx0by5fY3Vyc29yID0gdC5jc3MoXCJjdXJzb3JcIik7XHJcblx0XHR9XHJcblx0XHR0LmNzcyhcImN1cnNvclwiLCBvLmN1cnNvcik7XHJcblx0fSxcclxuXHRzdG9wOiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpbnN0YW5jZSApIHtcclxuXHRcdHZhciBvID0gaW5zdGFuY2Uub3B0aW9ucztcclxuXHRcdGlmIChvLl9jdXJzb3IpIHtcclxuXHRcdFx0JChcImJvZHlcIikuY3NzKFwiY3Vyc29yXCIsIG8uX2N1cnNvcik7XHJcblx0XHR9XHJcblx0fVxyXG59KTtcclxuXHJcbiQudWkucGx1Z2luLmFkZChcImRyYWdnYWJsZVwiLCBcIm9wYWNpdHlcIiwge1xyXG5cdHN0YXJ0OiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpbnN0YW5jZSApIHtcclxuXHRcdHZhciB0ID0gJCggdWkuaGVscGVyICksXHJcblx0XHRcdG8gPSBpbnN0YW5jZS5vcHRpb25zO1xyXG5cdFx0aWYgKHQuY3NzKFwib3BhY2l0eVwiKSkge1xyXG5cdFx0XHRvLl9vcGFjaXR5ID0gdC5jc3MoXCJvcGFjaXR5XCIpO1xyXG5cdFx0fVxyXG5cdFx0dC5jc3MoXCJvcGFjaXR5XCIsIG8ub3BhY2l0eSk7XHJcblx0fSxcclxuXHRzdG9wOiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpbnN0YW5jZSApIHtcclxuXHRcdHZhciBvID0gaW5zdGFuY2Uub3B0aW9ucztcclxuXHRcdGlmIChvLl9vcGFjaXR5KSB7XHJcblx0XHRcdCQodWkuaGVscGVyKS5jc3MoXCJvcGFjaXR5XCIsIG8uX29wYWNpdHkpO1xyXG5cdFx0fVxyXG5cdH1cclxufSk7XHJcblxyXG4kLnVpLnBsdWdpbi5hZGQoXCJkcmFnZ2FibGVcIiwgXCJzY3JvbGxcIiwge1xyXG5cdHN0YXJ0OiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpICkge1xyXG5cdFx0aWYgKCAhaS5zY3JvbGxQYXJlbnROb3RIaWRkZW4gKSB7XHJcblx0XHRcdGkuc2Nyb2xsUGFyZW50Tm90SGlkZGVuID0gaS5oZWxwZXIuc2Nyb2xsUGFyZW50KCBmYWxzZSApO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICggaS5zY3JvbGxQYXJlbnROb3RIaWRkZW5bIDAgXSAhPT0gaS5kb2N1bWVudFsgMCBdICYmIGkuc2Nyb2xsUGFyZW50Tm90SGlkZGVuWyAwIF0udGFnTmFtZSAhPT0gXCJIVE1MXCIgKSB7XHJcblx0XHRcdGkub3ZlcmZsb3dPZmZzZXQgPSBpLnNjcm9sbFBhcmVudE5vdEhpZGRlbi5vZmZzZXQoKTtcclxuXHRcdH1cclxuXHR9LFxyXG5cdGRyYWc6IGZ1bmN0aW9uKCBldmVudCwgdWksIGkgICkge1xyXG5cclxuXHRcdHZhciBvID0gaS5vcHRpb25zLFxyXG5cdFx0XHRzY3JvbGxlZCA9IGZhbHNlLFxyXG5cdFx0XHRzY3JvbGxQYXJlbnQgPSBpLnNjcm9sbFBhcmVudE5vdEhpZGRlblsgMCBdLFxyXG5cdFx0XHRkb2N1bWVudCA9IGkuZG9jdW1lbnRbIDAgXTtcclxuXHJcblx0XHRpZiAoIHNjcm9sbFBhcmVudCAhPT0gZG9jdW1lbnQgJiYgc2Nyb2xsUGFyZW50LnRhZ05hbWUgIT09IFwiSFRNTFwiICkge1xyXG5cdFx0XHRpZiAoICFvLmF4aXMgfHwgby5heGlzICE9PSBcInhcIiApIHtcclxuXHRcdFx0XHRpZiAoICggaS5vdmVyZmxvd09mZnNldC50b3AgKyBzY3JvbGxQYXJlbnQub2Zmc2V0SGVpZ2h0ICkgLSBldmVudC5wYWdlWSA8IG8uc2Nyb2xsU2Vuc2l0aXZpdHkgKSB7XHJcblx0XHRcdFx0XHRzY3JvbGxQYXJlbnQuc2Nyb2xsVG9wID0gc2Nyb2xsZWQgPSBzY3JvbGxQYXJlbnQuc2Nyb2xsVG9wICsgby5zY3JvbGxTcGVlZDtcclxuXHRcdFx0XHR9IGVsc2UgaWYgKCBldmVudC5wYWdlWSAtIGkub3ZlcmZsb3dPZmZzZXQudG9wIDwgby5zY3JvbGxTZW5zaXRpdml0eSApIHtcclxuXHRcdFx0XHRcdHNjcm9sbFBhcmVudC5zY3JvbGxUb3AgPSBzY3JvbGxlZCA9IHNjcm9sbFBhcmVudC5zY3JvbGxUb3AgLSBvLnNjcm9sbFNwZWVkO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKCAhby5heGlzIHx8IG8uYXhpcyAhPT0gXCJ5XCIgKSB7XHJcblx0XHRcdFx0aWYgKCAoIGkub3ZlcmZsb3dPZmZzZXQubGVmdCArIHNjcm9sbFBhcmVudC5vZmZzZXRXaWR0aCApIC0gZXZlbnQucGFnZVggPCBvLnNjcm9sbFNlbnNpdGl2aXR5ICkge1xyXG5cdFx0XHRcdFx0c2Nyb2xsUGFyZW50LnNjcm9sbExlZnQgPSBzY3JvbGxlZCA9IHNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0ICsgby5zY3JvbGxTcGVlZDtcclxuXHRcdFx0XHR9IGVsc2UgaWYgKCBldmVudC5wYWdlWCAtIGkub3ZlcmZsb3dPZmZzZXQubGVmdCA8IG8uc2Nyb2xsU2Vuc2l0aXZpdHkgKSB7XHJcblx0XHRcdFx0XHRzY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCA9IHNjcm9sbGVkID0gc2Nyb2xsUGFyZW50LnNjcm9sbExlZnQgLSBvLnNjcm9sbFNwZWVkO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdH0gZWxzZSB7XHJcblxyXG5cdFx0XHRpZiAoIW8uYXhpcyB8fCBvLmF4aXMgIT09IFwieFwiKSB7XHJcblx0XHRcdFx0aWYgKGV2ZW50LnBhZ2VZIC0gJChkb2N1bWVudCkuc2Nyb2xsVG9wKCkgPCBvLnNjcm9sbFNlbnNpdGl2aXR5KSB7XHJcblx0XHRcdFx0XHRzY3JvbGxlZCA9ICQoZG9jdW1lbnQpLnNjcm9sbFRvcCgkKGRvY3VtZW50KS5zY3JvbGxUb3AoKSAtIG8uc2Nyb2xsU3BlZWQpO1xyXG5cdFx0XHRcdH0gZWxzZSBpZiAoJCh3aW5kb3cpLmhlaWdodCgpIC0gKGV2ZW50LnBhZ2VZIC0gJChkb2N1bWVudCkuc2Nyb2xsVG9wKCkpIDwgby5zY3JvbGxTZW5zaXRpdml0eSkge1xyXG5cdFx0XHRcdFx0c2Nyb2xsZWQgPSAkKGRvY3VtZW50KS5zY3JvbGxUb3AoJChkb2N1bWVudCkuc2Nyb2xsVG9wKCkgKyBvLnNjcm9sbFNwZWVkKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmICghby5heGlzIHx8IG8uYXhpcyAhPT0gXCJ5XCIpIHtcclxuXHRcdFx0XHRpZiAoZXZlbnQucGFnZVggLSAkKGRvY3VtZW50KS5zY3JvbGxMZWZ0KCkgPCBvLnNjcm9sbFNlbnNpdGl2aXR5KSB7XHJcblx0XHRcdFx0XHRzY3JvbGxlZCA9ICQoZG9jdW1lbnQpLnNjcm9sbExlZnQoJChkb2N1bWVudCkuc2Nyb2xsTGVmdCgpIC0gby5zY3JvbGxTcGVlZCk7XHJcblx0XHRcdFx0fSBlbHNlIGlmICgkKHdpbmRvdykud2lkdGgoKSAtIChldmVudC5wYWdlWCAtICQoZG9jdW1lbnQpLnNjcm9sbExlZnQoKSkgPCBvLnNjcm9sbFNlbnNpdGl2aXR5KSB7XHJcblx0XHRcdFx0XHRzY3JvbGxlZCA9ICQoZG9jdW1lbnQpLnNjcm9sbExlZnQoJChkb2N1bWVudCkuc2Nyb2xsTGVmdCgpICsgby5zY3JvbGxTcGVlZCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChzY3JvbGxlZCAhPT0gZmFsc2UgJiYgJC51aS5kZG1hbmFnZXIgJiYgIW8uZHJvcEJlaGF2aW91cikge1xyXG5cdFx0XHQkLnVpLmRkbWFuYWdlci5wcmVwYXJlT2Zmc2V0cyhpLCBldmVudCk7XHJcblx0XHR9XHJcblxyXG5cdH1cclxufSk7XHJcblxyXG4kLnVpLnBsdWdpbi5hZGQoXCJkcmFnZ2FibGVcIiwgXCJzbmFwXCIsIHtcclxuXHRzdGFydDogZnVuY3Rpb24oIGV2ZW50LCB1aSwgaSApIHtcclxuXHJcblx0XHR2YXIgbyA9IGkub3B0aW9ucztcclxuXHJcblx0XHRpLnNuYXBFbGVtZW50cyA9IFtdO1xyXG5cclxuXHRcdCQoby5zbmFwLmNvbnN0cnVjdG9yICE9PSBTdHJpbmcgPyAoIG8uc25hcC5pdGVtcyB8fCBcIjpkYXRhKHVpLWRyYWdnYWJsZSlcIiApIDogby5zbmFwKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2YXIgJHQgPSAkKHRoaXMpLFxyXG5cdFx0XHRcdCRvID0gJHQub2Zmc2V0KCk7XHJcblx0XHRcdGlmICh0aGlzICE9PSBpLmVsZW1lbnRbMF0pIHtcclxuXHRcdFx0XHRpLnNuYXBFbGVtZW50cy5wdXNoKHtcclxuXHRcdFx0XHRcdGl0ZW06IHRoaXMsXHJcblx0XHRcdFx0XHR3aWR0aDogJHQub3V0ZXJXaWR0aCgpLCBoZWlnaHQ6ICR0Lm91dGVySGVpZ2h0KCksXHJcblx0XHRcdFx0XHR0b3A6ICRvLnRvcCwgbGVmdDogJG8ubGVmdFxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHJcblx0fSxcclxuXHRkcmFnOiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpbnN0ICkge1xyXG5cclxuXHRcdHZhciB0cywgYnMsIGxzLCBycywgbCwgciwgdCwgYiwgaSwgZmlyc3QsXHJcblx0XHRcdG8gPSBpbnN0Lm9wdGlvbnMsXHJcblx0XHRcdGQgPSBvLnNuYXBUb2xlcmFuY2UsXHJcblx0XHRcdHgxID0gdWkub2Zmc2V0LmxlZnQsIHgyID0geDEgKyBpbnN0LmhlbHBlclByb3BvcnRpb25zLndpZHRoLFxyXG5cdFx0XHR5MSA9IHVpLm9mZnNldC50b3AsIHkyID0geTEgKyBpbnN0LmhlbHBlclByb3BvcnRpb25zLmhlaWdodDtcclxuXHJcblx0XHRmb3IgKGkgPSBpbnN0LnNuYXBFbGVtZW50cy5sZW5ndGggLSAxOyBpID49IDA7IGktLSl7XHJcblxyXG5cdFx0XHRsID0gaW5zdC5zbmFwRWxlbWVudHNbaV0ubGVmdCAtIGluc3QubWFyZ2lucy5sZWZ0O1xyXG5cdFx0XHRyID0gbCArIGluc3Quc25hcEVsZW1lbnRzW2ldLndpZHRoO1xyXG5cdFx0XHR0ID0gaW5zdC5zbmFwRWxlbWVudHNbaV0udG9wIC0gaW5zdC5tYXJnaW5zLnRvcDtcclxuXHRcdFx0YiA9IHQgKyBpbnN0LnNuYXBFbGVtZW50c1tpXS5oZWlnaHQ7XHJcblxyXG5cdFx0XHRpZiAoIHgyIDwgbCAtIGQgfHwgeDEgPiByICsgZCB8fCB5MiA8IHQgLSBkIHx8IHkxID4gYiArIGQgfHwgISQuY29udGFpbnMoIGluc3Quc25hcEVsZW1lbnRzWyBpIF0uaXRlbS5vd25lckRvY3VtZW50LCBpbnN0LnNuYXBFbGVtZW50c1sgaSBdLml0ZW0gKSApIHtcclxuXHRcdFx0XHRpZiAoaW5zdC5zbmFwRWxlbWVudHNbaV0uc25hcHBpbmcpIHtcclxuXHRcdFx0XHRcdChpbnN0Lm9wdGlvbnMuc25hcC5yZWxlYXNlICYmIGluc3Qub3B0aW9ucy5zbmFwLnJlbGVhc2UuY2FsbChpbnN0LmVsZW1lbnQsIGV2ZW50LCAkLmV4dGVuZChpbnN0Ll91aUhhc2goKSwgeyBzbmFwSXRlbTogaW5zdC5zbmFwRWxlbWVudHNbaV0uaXRlbSB9KSkpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpbnN0LnNuYXBFbGVtZW50c1tpXS5zbmFwcGluZyA9IGZhbHNlO1xyXG5cdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZiAoby5zbmFwTW9kZSAhPT0gXCJpbm5lclwiKSB7XHJcblx0XHRcdFx0dHMgPSBNYXRoLmFicyh0IC0geTIpIDw9IGQ7XHJcblx0XHRcdFx0YnMgPSBNYXRoLmFicyhiIC0geTEpIDw9IGQ7XHJcblx0XHRcdFx0bHMgPSBNYXRoLmFicyhsIC0geDIpIDw9IGQ7XHJcblx0XHRcdFx0cnMgPSBNYXRoLmFicyhyIC0geDEpIDw9IGQ7XHJcblx0XHRcdFx0aWYgKHRzKSB7XHJcblx0XHRcdFx0XHR1aS5wb3NpdGlvbi50b3AgPSBpbnN0Ll9jb252ZXJ0UG9zaXRpb25UbyhcInJlbGF0aXZlXCIsIHsgdG9wOiB0IC0gaW5zdC5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQsIGxlZnQ6IDAgfSkudG9wO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoYnMpIHtcclxuXHRcdFx0XHRcdHVpLnBvc2l0aW9uLnRvcCA9IGluc3QuX2NvbnZlcnRQb3NpdGlvblRvKFwicmVsYXRpdmVcIiwgeyB0b3A6IGIsIGxlZnQ6IDAgfSkudG9wO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAobHMpIHtcclxuXHRcdFx0XHRcdHVpLnBvc2l0aW9uLmxlZnQgPSBpbnN0Ll9jb252ZXJ0UG9zaXRpb25UbyhcInJlbGF0aXZlXCIsIHsgdG9wOiAwLCBsZWZ0OiBsIC0gaW5zdC5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCB9KS5sZWZ0O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAocnMpIHtcclxuXHRcdFx0XHRcdHVpLnBvc2l0aW9uLmxlZnQgPSBpbnN0Ll9jb252ZXJ0UG9zaXRpb25UbyhcInJlbGF0aXZlXCIsIHsgdG9wOiAwLCBsZWZ0OiByIH0pLmxlZnQ7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRmaXJzdCA9ICh0cyB8fCBicyB8fCBscyB8fCBycyk7XHJcblxyXG5cdFx0XHRpZiAoby5zbmFwTW9kZSAhPT0gXCJvdXRlclwiKSB7XHJcblx0XHRcdFx0dHMgPSBNYXRoLmFicyh0IC0geTEpIDw9IGQ7XHJcblx0XHRcdFx0YnMgPSBNYXRoLmFicyhiIC0geTIpIDw9IGQ7XHJcblx0XHRcdFx0bHMgPSBNYXRoLmFicyhsIC0geDEpIDw9IGQ7XHJcblx0XHRcdFx0cnMgPSBNYXRoLmFicyhyIC0geDIpIDw9IGQ7XHJcblx0XHRcdFx0aWYgKHRzKSB7XHJcblx0XHRcdFx0XHR1aS5wb3NpdGlvbi50b3AgPSBpbnN0Ll9jb252ZXJ0UG9zaXRpb25UbyhcInJlbGF0aXZlXCIsIHsgdG9wOiB0LCBsZWZ0OiAwIH0pLnRvcDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKGJzKSB7XHJcblx0XHRcdFx0XHR1aS5wb3NpdGlvbi50b3AgPSBpbnN0Ll9jb252ZXJ0UG9zaXRpb25UbyhcInJlbGF0aXZlXCIsIHsgdG9wOiBiIC0gaW5zdC5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQsIGxlZnQ6IDAgfSkudG9wO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAobHMpIHtcclxuXHRcdFx0XHRcdHVpLnBvc2l0aW9uLmxlZnQgPSBpbnN0Ll9jb252ZXJ0UG9zaXRpb25UbyhcInJlbGF0aXZlXCIsIHsgdG9wOiAwLCBsZWZ0OiBsIH0pLmxlZnQ7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmIChycykge1xyXG5cdFx0XHRcdFx0dWkucG9zaXRpb24ubGVmdCA9IGluc3QuX2NvbnZlcnRQb3NpdGlvblRvKFwicmVsYXRpdmVcIiwgeyB0b3A6IDAsIGxlZnQ6IHIgLSBpbnN0LmhlbHBlclByb3BvcnRpb25zLndpZHRoIH0pLmxlZnQ7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZiAoIWluc3Quc25hcEVsZW1lbnRzW2ldLnNuYXBwaW5nICYmICh0cyB8fCBicyB8fCBscyB8fCBycyB8fCBmaXJzdCkpIHtcclxuXHRcdFx0XHQoaW5zdC5vcHRpb25zLnNuYXAuc25hcCAmJiBpbnN0Lm9wdGlvbnMuc25hcC5zbmFwLmNhbGwoaW5zdC5lbGVtZW50LCBldmVudCwgJC5leHRlbmQoaW5zdC5fdWlIYXNoKCksIHsgc25hcEl0ZW06IGluc3Quc25hcEVsZW1lbnRzW2ldLml0ZW0gfSkpKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpbnN0LnNuYXBFbGVtZW50c1tpXS5zbmFwcGluZyA9ICh0cyB8fCBicyB8fCBscyB8fCBycyB8fCBmaXJzdCk7XHJcblxyXG5cdFx0fVxyXG5cclxuXHR9XHJcbn0pO1xyXG5cclxuJC51aS5wbHVnaW4uYWRkKFwiZHJhZ2dhYmxlXCIsIFwic3RhY2tcIiwge1xyXG5cdHN0YXJ0OiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpbnN0YW5jZSApIHtcclxuXHRcdHZhciBtaW4sXHJcblx0XHRcdG8gPSBpbnN0YW5jZS5vcHRpb25zLFxyXG5cdFx0XHRncm91cCA9ICQubWFrZUFycmF5KCQoby5zdGFjaykpLnNvcnQoZnVuY3Rpb24oYSwgYikge1xyXG5cdFx0XHRcdHJldHVybiAocGFyc2VJbnQoJChhKS5jc3MoXCJ6SW5kZXhcIiksIDEwKSB8fCAwKSAtIChwYXJzZUludCgkKGIpLmNzcyhcInpJbmRleFwiKSwgMTApIHx8IDApO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRpZiAoIWdyb3VwLmxlbmd0aCkgeyByZXR1cm47IH1cclxuXHJcblx0XHRtaW4gPSBwYXJzZUludCgkKGdyb3VwWzBdKS5jc3MoXCJ6SW5kZXhcIiksIDEwKSB8fCAwO1xyXG5cdFx0JChncm91cCkuZWFjaChmdW5jdGlvbihpKSB7XHJcblx0XHRcdCQodGhpcykuY3NzKFwiekluZGV4XCIsIG1pbiArIGkpO1xyXG5cdFx0fSk7XHJcblx0XHR0aGlzLmNzcyhcInpJbmRleFwiLCAobWluICsgZ3JvdXAubGVuZ3RoKSk7XHJcblx0fVxyXG59KTtcclxuXHJcbiQudWkucGx1Z2luLmFkZChcImRyYWdnYWJsZVwiLCBcInpJbmRleFwiLCB7XHJcblx0c3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWksIGluc3RhbmNlICkge1xyXG5cdFx0dmFyIHQgPSAkKCB1aS5oZWxwZXIgKSxcclxuXHRcdFx0byA9IGluc3RhbmNlLm9wdGlvbnM7XHJcblxyXG5cdFx0aWYgKHQuY3NzKFwiekluZGV4XCIpKSB7XHJcblx0XHRcdG8uX3pJbmRleCA9IHQuY3NzKFwiekluZGV4XCIpO1xyXG5cdFx0fVxyXG5cdFx0dC5jc3MoXCJ6SW5kZXhcIiwgby56SW5kZXgpO1xyXG5cdH0sXHJcblx0c3RvcDogZnVuY3Rpb24oIGV2ZW50LCB1aSwgaW5zdGFuY2UgKSB7XHJcblx0XHR2YXIgbyA9IGluc3RhbmNlLm9wdGlvbnM7XHJcblxyXG5cdFx0aWYgKG8uX3pJbmRleCkge1xyXG5cdFx0XHQkKHVpLmhlbHBlcikuY3NzKFwiekluZGV4XCIsIG8uX3pJbmRleCk7XHJcblx0XHR9XHJcblx0fVxyXG59KTtcclxuXHJcbnZhciBkcmFnZ2FibGUgPSAkLnVpLmRyYWdnYWJsZTtcclxuXHJcblxyXG4vKiFcclxuICogalF1ZXJ5IFVJIFNvcnRhYmxlIDEuMTEuNFxyXG4gKiBodHRwOi8vanF1ZXJ5dWkuY29tXHJcbiAqXHJcbiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXHJcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cclxuICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZVxyXG4gKlxyXG4gKiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9zb3J0YWJsZS9cclxuICovXHJcblxyXG5cclxudmFyIHNvcnRhYmxlID0gJC53aWRnZXQoXCJ1aS5zb3J0YWJsZVwiLCAkLnVpLm1vdXNlLCB7XHJcblx0dmVyc2lvbjogXCIxLjExLjRcIixcclxuXHR3aWRnZXRFdmVudFByZWZpeDogXCJzb3J0XCIsXHJcblx0cmVhZHk6IGZhbHNlLFxyXG5cdG9wdGlvbnM6IHtcclxuXHRcdGFwcGVuZFRvOiBcInBhcmVudFwiLFxyXG5cdFx0YXhpczogZmFsc2UsXHJcblx0XHRjb25uZWN0V2l0aDogZmFsc2UsXHJcblx0XHRjb250YWlubWVudDogZmFsc2UsXHJcblx0XHRjdXJzb3I6IFwiYXV0b1wiLFxyXG5cdFx0Y3Vyc29yQXQ6IGZhbHNlLFxyXG5cdFx0ZHJvcE9uRW1wdHk6IHRydWUsXHJcblx0XHRmb3JjZVBsYWNlaG9sZGVyU2l6ZTogZmFsc2UsXHJcblx0XHRmb3JjZUhlbHBlclNpemU6IGZhbHNlLFxyXG5cdFx0Z3JpZDogZmFsc2UsXHJcblx0XHRoYW5kbGU6IGZhbHNlLFxyXG5cdFx0aGVscGVyOiBcIm9yaWdpbmFsXCIsXHJcblx0XHRpdGVtczogXCI+ICpcIixcclxuXHRcdG9wYWNpdHk6IGZhbHNlLFxyXG5cdFx0cGxhY2Vob2xkZXI6IGZhbHNlLFxyXG5cdFx0cmV2ZXJ0OiBmYWxzZSxcclxuXHRcdHNjcm9sbDogdHJ1ZSxcclxuXHRcdHNjcm9sbFNlbnNpdGl2aXR5OiAyMCxcclxuXHRcdHNjcm9sbFNwZWVkOiAyMCxcclxuXHRcdHNjb3BlOiBcImRlZmF1bHRcIixcclxuXHRcdHRvbGVyYW5jZTogXCJpbnRlcnNlY3RcIixcclxuXHRcdHpJbmRleDogMTAwMCxcclxuXHJcblx0XHQvLyBjYWxsYmFja3NcclxuXHRcdGFjdGl2YXRlOiBudWxsLFxyXG5cdFx0YmVmb3JlU3RvcDogbnVsbCxcclxuXHRcdGNoYW5nZTogbnVsbCxcclxuXHRcdGRlYWN0aXZhdGU6IG51bGwsXHJcblx0XHRvdXQ6IG51bGwsXHJcblx0XHRvdmVyOiBudWxsLFxyXG5cdFx0cmVjZWl2ZTogbnVsbCxcclxuXHRcdHJlbW92ZTogbnVsbCxcclxuXHRcdHNvcnQ6IG51bGwsXHJcblx0XHRzdGFydDogbnVsbCxcclxuXHRcdHN0b3A6IG51bGwsXHJcblx0XHR1cGRhdGU6IG51bGxcclxuXHR9LFxyXG5cclxuXHRfaXNPdmVyQXhpczogZnVuY3Rpb24oIHgsIHJlZmVyZW5jZSwgc2l6ZSApIHtcclxuXHRcdHJldHVybiAoIHggPj0gcmVmZXJlbmNlICkgJiYgKCB4IDwgKCByZWZlcmVuY2UgKyBzaXplICkgKTtcclxuXHR9LFxyXG5cclxuXHRfaXNGbG9hdGluZzogZnVuY3Rpb24oIGl0ZW0gKSB7XHJcblx0XHRyZXR1cm4gKC9sZWZ0fHJpZ2h0LykudGVzdChpdGVtLmNzcyhcImZsb2F0XCIpKSB8fCAoL2lubGluZXx0YWJsZS1jZWxsLykudGVzdChpdGVtLmNzcyhcImRpc3BsYXlcIikpO1xyXG5cdH0sXHJcblxyXG5cdF9jcmVhdGU6IGZ1bmN0aW9uKCkge1xyXG5cdFx0dGhpcy5jb250YWluZXJDYWNoZSA9IHt9O1xyXG5cdFx0dGhpcy5lbGVtZW50LmFkZENsYXNzKFwidWktc29ydGFibGVcIik7XHJcblxyXG5cdFx0Ly9HZXQgdGhlIGl0ZW1zXHJcblx0XHR0aGlzLnJlZnJlc2goKTtcclxuXHJcblx0XHQvL0xldCdzIGRldGVybWluZSB0aGUgcGFyZW50J3Mgb2Zmc2V0XHJcblx0XHR0aGlzLm9mZnNldCA9IHRoaXMuZWxlbWVudC5vZmZzZXQoKTtcclxuXHJcblx0XHQvL0luaXRpYWxpemUgbW91c2UgZXZlbnRzIGZvciBpbnRlcmFjdGlvblxyXG5cdFx0dGhpcy5fbW91c2VJbml0KCk7XHJcblxyXG5cdFx0dGhpcy5fc2V0SGFuZGxlQ2xhc3NOYW1lKCk7XHJcblxyXG5cdFx0Ly9XZSdyZSByZWFkeSB0byBnb1xyXG5cdFx0dGhpcy5yZWFkeSA9IHRydWU7XHJcblxyXG5cdH0sXHJcblxyXG5cdF9zZXRPcHRpb246IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkge1xyXG5cdFx0dGhpcy5fc3VwZXIoIGtleSwgdmFsdWUgKTtcclxuXHJcblx0XHRpZiAoIGtleSA9PT0gXCJoYW5kbGVcIiApIHtcclxuXHRcdFx0dGhpcy5fc2V0SGFuZGxlQ2xhc3NOYW1lKCk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0X3NldEhhbmRsZUNsYXNzTmFtZTogZnVuY3Rpb24oKSB7XHJcblx0XHR0aGlzLmVsZW1lbnQuZmluZCggXCIudWktc29ydGFibGUtaGFuZGxlXCIgKS5yZW1vdmVDbGFzcyggXCJ1aS1zb3J0YWJsZS1oYW5kbGVcIiApO1xyXG5cdFx0JC5lYWNoKCB0aGlzLml0ZW1zLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0KCB0aGlzLmluc3RhbmNlLm9wdGlvbnMuaGFuZGxlID9cclxuXHRcdFx0XHR0aGlzLml0ZW0uZmluZCggdGhpcy5pbnN0YW5jZS5vcHRpb25zLmhhbmRsZSApIDogdGhpcy5pdGVtIClcclxuXHRcdFx0XHQuYWRkQ2xhc3MoIFwidWktc29ydGFibGUtaGFuZGxlXCIgKTtcclxuXHRcdH0pO1xyXG5cdH0sXHJcblxyXG5cdF9kZXN0cm95OiBmdW5jdGlvbigpIHtcclxuXHRcdHRoaXMuZWxlbWVudFxyXG5cdFx0XHQucmVtb3ZlQ2xhc3MoIFwidWktc29ydGFibGUgdWktc29ydGFibGUtZGlzYWJsZWRcIiApXHJcblx0XHRcdC5maW5kKCBcIi51aS1zb3J0YWJsZS1oYW5kbGVcIiApXHJcblx0XHRcdFx0LnJlbW92ZUNsYXNzKCBcInVpLXNvcnRhYmxlLWhhbmRsZVwiICk7XHJcblx0XHR0aGlzLl9tb3VzZURlc3Ryb3koKTtcclxuXHJcblx0XHRmb3IgKCB2YXIgaSA9IHRoaXMuaXRlbXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0gKSB7XHJcblx0XHRcdHRoaXMuaXRlbXNbaV0uaXRlbS5yZW1vdmVEYXRhKHRoaXMud2lkZ2V0TmFtZSArIFwiLWl0ZW1cIik7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0X21vdXNlQ2FwdHVyZTogZnVuY3Rpb24oZXZlbnQsIG92ZXJyaWRlSGFuZGxlKSB7XHJcblx0XHR2YXIgY3VycmVudEl0ZW0gPSBudWxsLFxyXG5cdFx0XHR2YWxpZEhhbmRsZSA9IGZhbHNlLFxyXG5cdFx0XHR0aGF0ID0gdGhpcztcclxuXHJcblx0XHRpZiAodGhpcy5yZXZlcnRpbmcpIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKHRoaXMub3B0aW9ucy5kaXNhYmxlZCB8fCB0aGlzLm9wdGlvbnMudHlwZSA9PT0gXCJzdGF0aWNcIikge1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly9XZSBoYXZlIHRvIHJlZnJlc2ggdGhlIGl0ZW1zIGRhdGEgb25jZSBmaXJzdFxyXG5cdFx0dGhpcy5fcmVmcmVzaEl0ZW1zKGV2ZW50KTtcclxuXHJcblx0XHQvL0ZpbmQgb3V0IGlmIHRoZSBjbGlja2VkIG5vZGUgKG9yIG9uZSBvZiBpdHMgcGFyZW50cykgaXMgYSBhY3R1YWwgaXRlbSBpbiB0aGlzLml0ZW1zXHJcblx0XHQkKGV2ZW50LnRhcmdldCkucGFyZW50cygpLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmKCQuZGF0YSh0aGlzLCB0aGF0LndpZGdldE5hbWUgKyBcIi1pdGVtXCIpID09PSB0aGF0KSB7XHJcblx0XHRcdFx0Y3VycmVudEl0ZW0gPSAkKHRoaXMpO1xyXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRpZigkLmRhdGEoZXZlbnQudGFyZ2V0LCB0aGF0LndpZGdldE5hbWUgKyBcIi1pdGVtXCIpID09PSB0aGF0KSB7XHJcblx0XHRcdGN1cnJlbnRJdGVtID0gJChldmVudC50YXJnZXQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKCFjdXJyZW50SXRlbSkge1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblx0XHRpZih0aGlzLm9wdGlvbnMuaGFuZGxlICYmICFvdmVycmlkZUhhbmRsZSkge1xyXG5cdFx0XHQkKHRoaXMub3B0aW9ucy5oYW5kbGUsIGN1cnJlbnRJdGVtKS5maW5kKFwiKlwiKS5hZGRCYWNrKCkuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRpZih0aGlzID09PSBldmVudC50YXJnZXQpIHtcclxuXHRcdFx0XHRcdHZhbGlkSGFuZGxlID0gdHJ1ZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRpZighdmFsaWRIYW5kbGUpIHtcclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmN1cnJlbnRJdGVtID0gY3VycmVudEl0ZW07XHJcblx0XHR0aGlzLl9yZW1vdmVDdXJyZW50c0Zyb21JdGVtcygpO1xyXG5cdFx0cmV0dXJuIHRydWU7XHJcblxyXG5cdH0sXHJcblxyXG5cdF9tb3VzZVN0YXJ0OiBmdW5jdGlvbihldmVudCwgb3ZlcnJpZGVIYW5kbGUsIG5vQWN0aXZhdGlvbikge1xyXG5cclxuXHRcdHZhciBpLCBib2R5LFxyXG5cdFx0XHRvID0gdGhpcy5vcHRpb25zO1xyXG5cclxuXHRcdHRoaXMuY3VycmVudENvbnRhaW5lciA9IHRoaXM7XHJcblxyXG5cdFx0Ly9XZSBvbmx5IG5lZWQgdG8gY2FsbCByZWZyZXNoUG9zaXRpb25zLCBiZWNhdXNlIHRoZSByZWZyZXNoSXRlbXMgY2FsbCBoYXMgYmVlbiBtb3ZlZCB0byBtb3VzZUNhcHR1cmVcclxuXHRcdHRoaXMucmVmcmVzaFBvc2l0aW9ucygpO1xyXG5cclxuXHRcdC8vQ3JlYXRlIGFuZCBhcHBlbmQgdGhlIHZpc2libGUgaGVscGVyXHJcblx0XHR0aGlzLmhlbHBlciA9IHRoaXMuX2NyZWF0ZUhlbHBlcihldmVudCk7XHJcblxyXG5cdFx0Ly9DYWNoZSB0aGUgaGVscGVyIHNpemVcclxuXHRcdHRoaXMuX2NhY2hlSGVscGVyUHJvcG9ydGlvbnMoKTtcclxuXHJcblx0XHQvKlxyXG5cdFx0ICogLSBQb3NpdGlvbiBnZW5lcmF0aW9uIC1cclxuXHRcdCAqIFRoaXMgYmxvY2sgZ2VuZXJhdGVzIGV2ZXJ5dGhpbmcgcG9zaXRpb24gcmVsYXRlZCAtIGl0J3MgdGhlIGNvcmUgb2YgZHJhZ2dhYmxlcy5cclxuXHRcdCAqL1xyXG5cclxuXHRcdC8vQ2FjaGUgdGhlIG1hcmdpbnMgb2YgdGhlIG9yaWdpbmFsIGVsZW1lbnRcclxuXHRcdHRoaXMuX2NhY2hlTWFyZ2lucygpO1xyXG5cclxuXHRcdC8vR2V0IHRoZSBuZXh0IHNjcm9sbGluZyBwYXJlbnRcclxuXHRcdHRoaXMuc2Nyb2xsUGFyZW50ID0gdGhpcy5oZWxwZXIuc2Nyb2xsUGFyZW50KCk7XHJcblxyXG5cdFx0Ly9UaGUgZWxlbWVudCdzIGFic29sdXRlIHBvc2l0aW9uIG9uIHRoZSBwYWdlIG1pbnVzIG1hcmdpbnNcclxuXHRcdHRoaXMub2Zmc2V0ID0gdGhpcy5jdXJyZW50SXRlbS5vZmZzZXQoKTtcclxuXHRcdHRoaXMub2Zmc2V0ID0ge1xyXG5cdFx0XHR0b3A6IHRoaXMub2Zmc2V0LnRvcCAtIHRoaXMubWFyZ2lucy50b3AsXHJcblx0XHRcdGxlZnQ6IHRoaXMub2Zmc2V0LmxlZnQgLSB0aGlzLm1hcmdpbnMubGVmdFxyXG5cdFx0fTtcclxuXHJcblx0XHQkLmV4dGVuZCh0aGlzLm9mZnNldCwge1xyXG5cdFx0XHRjbGljazogeyAvL1doZXJlIHRoZSBjbGljayBoYXBwZW5lZCwgcmVsYXRpdmUgdG8gdGhlIGVsZW1lbnRcclxuXHRcdFx0XHRsZWZ0OiBldmVudC5wYWdlWCAtIHRoaXMub2Zmc2V0LmxlZnQsXHJcblx0XHRcdFx0dG9wOiBldmVudC5wYWdlWSAtIHRoaXMub2Zmc2V0LnRvcFxyXG5cdFx0XHR9LFxyXG5cdFx0XHRwYXJlbnQ6IHRoaXMuX2dldFBhcmVudE9mZnNldCgpLFxyXG5cdFx0XHRyZWxhdGl2ZTogdGhpcy5fZ2V0UmVsYXRpdmVPZmZzZXQoKSAvL1RoaXMgaXMgYSByZWxhdGl2ZSB0byBhYnNvbHV0ZSBwb3NpdGlvbiBtaW51cyB0aGUgYWN0dWFsIHBvc2l0aW9uIGNhbGN1bGF0aW9uIC0gb25seSB1c2VkIGZvciByZWxhdGl2ZSBwb3NpdGlvbmVkIGhlbHBlclxyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8gT25seSBhZnRlciB3ZSBnb3QgdGhlIG9mZnNldCwgd2UgY2FuIGNoYW5nZSB0aGUgaGVscGVyJ3MgcG9zaXRpb24gdG8gYWJzb2x1dGVcclxuXHRcdC8vIFRPRE86IFN0aWxsIG5lZWQgdG8gZmlndXJlIG91dCBhIHdheSB0byBtYWtlIHJlbGF0aXZlIHNvcnRpbmcgcG9zc2libGVcclxuXHRcdHRoaXMuaGVscGVyLmNzcyhcInBvc2l0aW9uXCIsIFwiYWJzb2x1dGVcIik7XHJcblx0XHR0aGlzLmNzc1Bvc2l0aW9uID0gdGhpcy5oZWxwZXIuY3NzKFwicG9zaXRpb25cIik7XHJcblxyXG5cdFx0Ly9HZW5lcmF0ZSB0aGUgb3JpZ2luYWwgcG9zaXRpb25cclxuXHRcdHRoaXMub3JpZ2luYWxQb3NpdGlvbiA9IHRoaXMuX2dlbmVyYXRlUG9zaXRpb24oZXZlbnQpO1xyXG5cdFx0dGhpcy5vcmlnaW5hbFBhZ2VYID0gZXZlbnQucGFnZVg7XHJcblx0XHR0aGlzLm9yaWdpbmFsUGFnZVkgPSBldmVudC5wYWdlWTtcclxuXHJcblx0XHQvL0FkanVzdCB0aGUgbW91c2Ugb2Zmc2V0IHJlbGF0aXZlIHRvIHRoZSBoZWxwZXIgaWYgXCJjdXJzb3JBdFwiIGlzIHN1cHBsaWVkXHJcblx0XHQoby5jdXJzb3JBdCAmJiB0aGlzLl9hZGp1c3RPZmZzZXRGcm9tSGVscGVyKG8uY3Vyc29yQXQpKTtcclxuXHJcblx0XHQvL0NhY2hlIHRoZSBmb3JtZXIgRE9NIHBvc2l0aW9uXHJcblx0XHR0aGlzLmRvbVBvc2l0aW9uID0geyBwcmV2OiB0aGlzLmN1cnJlbnRJdGVtLnByZXYoKVswXSwgcGFyZW50OiB0aGlzLmN1cnJlbnRJdGVtLnBhcmVudCgpWzBdIH07XHJcblxyXG5cdFx0Ly9JZiB0aGUgaGVscGVyIGlzIG5vdCB0aGUgb3JpZ2luYWwsIGhpZGUgdGhlIG9yaWdpbmFsIHNvIGl0J3Mgbm90IHBsYXlpbmcgYW55IHJvbGUgZHVyaW5nIHRoZSBkcmFnLCB3b24ndCBjYXVzZSBhbnl0aGluZyBiYWQgdGhpcyB3YXlcclxuXHRcdGlmKHRoaXMuaGVscGVyWzBdICE9PSB0aGlzLmN1cnJlbnRJdGVtWzBdKSB7XHJcblx0XHRcdHRoaXMuY3VycmVudEl0ZW0uaGlkZSgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vQ3JlYXRlIHRoZSBwbGFjZWhvbGRlclxyXG5cdFx0dGhpcy5fY3JlYXRlUGxhY2Vob2xkZXIoKTtcclxuXHJcblx0XHQvL1NldCBhIGNvbnRhaW5tZW50IGlmIGdpdmVuIGluIHRoZSBvcHRpb25zXHJcblx0XHRpZihvLmNvbnRhaW5tZW50KSB7XHJcblx0XHRcdHRoaXMuX3NldENvbnRhaW5tZW50KCk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYoIG8uY3Vyc29yICYmIG8uY3Vyc29yICE9PSBcImF1dG9cIiApIHsgLy8gY3Vyc29yIG9wdGlvblxyXG5cdFx0XHRib2R5ID0gdGhpcy5kb2N1bWVudC5maW5kKCBcImJvZHlcIiApO1xyXG5cclxuXHRcdFx0Ly8gc3VwcG9ydDogSUVcclxuXHRcdFx0dGhpcy5zdG9yZWRDdXJzb3IgPSBib2R5LmNzcyggXCJjdXJzb3JcIiApO1xyXG5cdFx0XHRib2R5LmNzcyggXCJjdXJzb3JcIiwgby5jdXJzb3IgKTtcclxuXHJcblx0XHRcdHRoaXMuc3RvcmVkU3R5bGVzaGVldCA9ICQoIFwiPHN0eWxlPip7IGN1cnNvcjogXCIrby5jdXJzb3IrXCIgIWltcG9ydGFudDsgfTwvc3R5bGU+XCIgKS5hcHBlbmRUbyggYm9keSApO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKG8ub3BhY2l0eSkgeyAvLyBvcGFjaXR5IG9wdGlvblxyXG5cdFx0XHRpZiAodGhpcy5oZWxwZXIuY3NzKFwib3BhY2l0eVwiKSkge1xyXG5cdFx0XHRcdHRoaXMuX3N0b3JlZE9wYWNpdHkgPSB0aGlzLmhlbHBlci5jc3MoXCJvcGFjaXR5XCIpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHRoaXMuaGVscGVyLmNzcyhcIm9wYWNpdHlcIiwgby5vcGFjaXR5KTtcclxuXHRcdH1cclxuXHJcblx0XHRpZihvLnpJbmRleCkgeyAvLyB6SW5kZXggb3B0aW9uXHJcblx0XHRcdGlmICh0aGlzLmhlbHBlci5jc3MoXCJ6SW5kZXhcIikpIHtcclxuXHRcdFx0XHR0aGlzLl9zdG9yZWRaSW5kZXggPSB0aGlzLmhlbHBlci5jc3MoXCJ6SW5kZXhcIik7XHJcblx0XHRcdH1cclxuXHRcdFx0dGhpcy5oZWxwZXIuY3NzKFwiekluZGV4XCIsIG8uekluZGV4KTtcclxuXHRcdH1cclxuXHJcblx0XHQvL1ByZXBhcmUgc2Nyb2xsaW5nXHJcblx0XHRpZih0aGlzLnNjcm9sbFBhcmVudFswXSAhPT0gdGhpcy5kb2N1bWVudFswXSAmJiB0aGlzLnNjcm9sbFBhcmVudFswXS50YWdOYW1lICE9PSBcIkhUTUxcIikge1xyXG5cdFx0XHR0aGlzLm92ZXJmbG93T2Zmc2V0ID0gdGhpcy5zY3JvbGxQYXJlbnQub2Zmc2V0KCk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly9DYWxsIGNhbGxiYWNrc1xyXG5cdFx0dGhpcy5fdHJpZ2dlcihcInN0YXJ0XCIsIGV2ZW50LCB0aGlzLl91aUhhc2goKSk7XHJcblxyXG5cdFx0Ly9SZWNhY2hlIHRoZSBoZWxwZXIgc2l6ZVxyXG5cdFx0aWYoIXRoaXMuX3ByZXNlcnZlSGVscGVyUHJvcG9ydGlvbnMpIHtcclxuXHRcdFx0dGhpcy5fY2FjaGVIZWxwZXJQcm9wb3J0aW9ucygpO1xyXG5cdFx0fVxyXG5cclxuXHJcblx0XHQvL1Bvc3QgXCJhY3RpdmF0ZVwiIGV2ZW50cyB0byBwb3NzaWJsZSBjb250YWluZXJzXHJcblx0XHRpZiggIW5vQWN0aXZhdGlvbiApIHtcclxuXHRcdFx0Zm9yICggaSA9IHRoaXMuY29udGFpbmVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSApIHtcclxuXHRcdFx0XHR0aGlzLmNvbnRhaW5lcnNbIGkgXS5fdHJpZ2dlciggXCJhY3RpdmF0ZVwiLCBldmVudCwgdGhpcy5fdWlIYXNoKCB0aGlzICkgKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vUHJlcGFyZSBwb3NzaWJsZSBkcm9wcGFibGVzXHJcblx0XHRpZigkLnVpLmRkbWFuYWdlcikge1xyXG5cdFx0XHQkLnVpLmRkbWFuYWdlci5jdXJyZW50ID0gdGhpcztcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoJC51aS5kZG1hbmFnZXIgJiYgIW8uZHJvcEJlaGF2aW91cikge1xyXG5cdFx0XHQkLnVpLmRkbWFuYWdlci5wcmVwYXJlT2Zmc2V0cyh0aGlzLCBldmVudCk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5kcmFnZ2luZyA9IHRydWU7XHJcblxyXG5cdFx0dGhpcy5oZWxwZXIuYWRkQ2xhc3MoXCJ1aS1zb3J0YWJsZS1oZWxwZXJcIik7XHJcblx0XHR0aGlzLl9tb3VzZURyYWcoZXZlbnQpOyAvL0V4ZWN1dGUgdGhlIGRyYWcgb25jZSAtIHRoaXMgY2F1c2VzIHRoZSBoZWxwZXIgbm90IHRvIGJlIHZpc2libGUgYmVmb3JlIGdldHRpbmcgaXRzIGNvcnJlY3QgcG9zaXRpb25cclxuXHRcdHJldHVybiB0cnVlO1xyXG5cclxuXHR9LFxyXG5cclxuXHRfbW91c2VEcmFnOiBmdW5jdGlvbihldmVudCkge1xyXG5cdFx0dmFyIGksIGl0ZW0sIGl0ZW1FbGVtZW50LCBpbnRlcnNlY3Rpb24sXHJcblx0XHRcdG8gPSB0aGlzLm9wdGlvbnMsXHJcblx0XHRcdHNjcm9sbGVkID0gZmFsc2U7XHJcblxyXG5cdFx0Ly9Db21wdXRlIHRoZSBoZWxwZXJzIHBvc2l0aW9uXHJcblx0XHR0aGlzLnBvc2l0aW9uID0gdGhpcy5fZ2VuZXJhdGVQb3NpdGlvbihldmVudCk7XHJcblx0XHR0aGlzLnBvc2l0aW9uQWJzID0gdGhpcy5fY29udmVydFBvc2l0aW9uVG8oXCJhYnNvbHV0ZVwiKTtcclxuXHJcblx0XHRpZiAoIXRoaXMubGFzdFBvc2l0aW9uQWJzKSB7XHJcblx0XHRcdHRoaXMubGFzdFBvc2l0aW9uQWJzID0gdGhpcy5wb3NpdGlvbkFicztcclxuXHRcdH1cclxuXHJcblx0XHQvL0RvIHNjcm9sbGluZ1xyXG5cdFx0aWYodGhpcy5vcHRpb25zLnNjcm9sbCkge1xyXG5cdFx0XHRpZih0aGlzLnNjcm9sbFBhcmVudFswXSAhPT0gdGhpcy5kb2N1bWVudFswXSAmJiB0aGlzLnNjcm9sbFBhcmVudFswXS50YWdOYW1lICE9PSBcIkhUTUxcIikge1xyXG5cclxuXHRcdFx0XHRpZigodGhpcy5vdmVyZmxvd09mZnNldC50b3AgKyB0aGlzLnNjcm9sbFBhcmVudFswXS5vZmZzZXRIZWlnaHQpIC0gZXZlbnQucGFnZVkgPCBvLnNjcm9sbFNlbnNpdGl2aXR5KSB7XHJcblx0XHRcdFx0XHR0aGlzLnNjcm9sbFBhcmVudFswXS5zY3JvbGxUb3AgPSBzY3JvbGxlZCA9IHRoaXMuc2Nyb2xsUGFyZW50WzBdLnNjcm9sbFRvcCArIG8uc2Nyb2xsU3BlZWQ7XHJcblx0XHRcdFx0fSBlbHNlIGlmKGV2ZW50LnBhZ2VZIC0gdGhpcy5vdmVyZmxvd09mZnNldC50b3AgPCBvLnNjcm9sbFNlbnNpdGl2aXR5KSB7XHJcblx0XHRcdFx0XHR0aGlzLnNjcm9sbFBhcmVudFswXS5zY3JvbGxUb3AgPSBzY3JvbGxlZCA9IHRoaXMuc2Nyb2xsUGFyZW50WzBdLnNjcm9sbFRvcCAtIG8uc2Nyb2xsU3BlZWQ7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRpZigodGhpcy5vdmVyZmxvd09mZnNldC5sZWZ0ICsgdGhpcy5zY3JvbGxQYXJlbnRbMF0ub2Zmc2V0V2lkdGgpIC0gZXZlbnQucGFnZVggPCBvLnNjcm9sbFNlbnNpdGl2aXR5KSB7XHJcblx0XHRcdFx0XHR0aGlzLnNjcm9sbFBhcmVudFswXS5zY3JvbGxMZWZ0ID0gc2Nyb2xsZWQgPSB0aGlzLnNjcm9sbFBhcmVudFswXS5zY3JvbGxMZWZ0ICsgby5zY3JvbGxTcGVlZDtcclxuXHRcdFx0XHR9IGVsc2UgaWYoZXZlbnQucGFnZVggLSB0aGlzLm92ZXJmbG93T2Zmc2V0LmxlZnQgPCBvLnNjcm9sbFNlbnNpdGl2aXR5KSB7XHJcblx0XHRcdFx0XHR0aGlzLnNjcm9sbFBhcmVudFswXS5zY3JvbGxMZWZ0ID0gc2Nyb2xsZWQgPSB0aGlzLnNjcm9sbFBhcmVudFswXS5zY3JvbGxMZWZ0IC0gby5zY3JvbGxTcGVlZDtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cclxuXHRcdFx0XHRpZihldmVudC5wYWdlWSAtIHRoaXMuZG9jdW1lbnQuc2Nyb2xsVG9wKCkgPCBvLnNjcm9sbFNlbnNpdGl2aXR5KSB7XHJcblx0XHRcdFx0XHRzY3JvbGxlZCA9IHRoaXMuZG9jdW1lbnQuc2Nyb2xsVG9wKHRoaXMuZG9jdW1lbnQuc2Nyb2xsVG9wKCkgLSBvLnNjcm9sbFNwZWVkKTtcclxuXHRcdFx0XHR9IGVsc2UgaWYodGhpcy53aW5kb3cuaGVpZ2h0KCkgLSAoZXZlbnQucGFnZVkgLSB0aGlzLmRvY3VtZW50LnNjcm9sbFRvcCgpKSA8IG8uc2Nyb2xsU2Vuc2l0aXZpdHkpIHtcclxuXHRcdFx0XHRcdHNjcm9sbGVkID0gdGhpcy5kb2N1bWVudC5zY3JvbGxUb3AodGhpcy5kb2N1bWVudC5zY3JvbGxUb3AoKSArIG8uc2Nyb2xsU3BlZWQpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0aWYoZXZlbnQucGFnZVggLSB0aGlzLmRvY3VtZW50LnNjcm9sbExlZnQoKSA8IG8uc2Nyb2xsU2Vuc2l0aXZpdHkpIHtcclxuXHRcdFx0XHRcdHNjcm9sbGVkID0gdGhpcy5kb2N1bWVudC5zY3JvbGxMZWZ0KHRoaXMuZG9jdW1lbnQuc2Nyb2xsTGVmdCgpIC0gby5zY3JvbGxTcGVlZCk7XHJcblx0XHRcdFx0fSBlbHNlIGlmKHRoaXMud2luZG93LndpZHRoKCkgLSAoZXZlbnQucGFnZVggLSB0aGlzLmRvY3VtZW50LnNjcm9sbExlZnQoKSkgPCBvLnNjcm9sbFNlbnNpdGl2aXR5KSB7XHJcblx0XHRcdFx0XHRzY3JvbGxlZCA9IHRoaXMuZG9jdW1lbnQuc2Nyb2xsTGVmdCh0aGlzLmRvY3VtZW50LnNjcm9sbExlZnQoKSArIG8uc2Nyb2xsU3BlZWQpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmKHNjcm9sbGVkICE9PSBmYWxzZSAmJiAkLnVpLmRkbWFuYWdlciAmJiAhby5kcm9wQmVoYXZpb3VyKSB7XHJcblx0XHRcdFx0JC51aS5kZG1hbmFnZXIucHJlcGFyZU9mZnNldHModGhpcywgZXZlbnQpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly9SZWdlbmVyYXRlIHRoZSBhYnNvbHV0ZSBwb3NpdGlvbiB1c2VkIGZvciBwb3NpdGlvbiBjaGVja3NcclxuXHRcdHRoaXMucG9zaXRpb25BYnMgPSB0aGlzLl9jb252ZXJ0UG9zaXRpb25UbyhcImFic29sdXRlXCIpO1xyXG5cclxuXHRcdC8vU2V0IHRoZSBoZWxwZXIgcG9zaXRpb25cclxuXHRcdGlmKCF0aGlzLm9wdGlvbnMuYXhpcyB8fCB0aGlzLm9wdGlvbnMuYXhpcyAhPT0gXCJ5XCIpIHtcclxuXHRcdFx0dGhpcy5oZWxwZXJbMF0uc3R5bGUubGVmdCA9IHRoaXMucG9zaXRpb24ubGVmdCtcInB4XCI7XHJcblx0XHR9XHJcblx0XHRpZighdGhpcy5vcHRpb25zLmF4aXMgfHwgdGhpcy5vcHRpb25zLmF4aXMgIT09IFwieFwiKSB7XHJcblx0XHRcdHRoaXMuaGVscGVyWzBdLnN0eWxlLnRvcCA9IHRoaXMucG9zaXRpb24udG9wK1wicHhcIjtcclxuXHRcdH1cclxuXHJcblx0XHQvL1JlYXJyYW5nZVxyXG5cdFx0Zm9yIChpID0gdGhpcy5pdGVtcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xyXG5cclxuXHRcdFx0Ly9DYWNoZSB2YXJpYWJsZXMgYW5kIGludGVyc2VjdGlvbiwgY29udGludWUgaWYgbm8gaW50ZXJzZWN0aW9uXHJcblx0XHRcdGl0ZW0gPSB0aGlzLml0ZW1zW2ldO1xyXG5cdFx0XHRpdGVtRWxlbWVudCA9IGl0ZW0uaXRlbVswXTtcclxuXHRcdFx0aW50ZXJzZWN0aW9uID0gdGhpcy5faW50ZXJzZWN0c1dpdGhQb2ludGVyKGl0ZW0pO1xyXG5cdFx0XHRpZiAoIWludGVyc2VjdGlvbikge1xyXG5cdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBPbmx5IHB1dCB0aGUgcGxhY2Vob2xkZXIgaW5zaWRlIHRoZSBjdXJyZW50IENvbnRhaW5lciwgc2tpcCBhbGxcclxuXHRcdFx0Ly8gaXRlbXMgZnJvbSBvdGhlciBjb250YWluZXJzLiBUaGlzIHdvcmtzIGJlY2F1c2Ugd2hlbiBtb3ZpbmdcclxuXHRcdFx0Ly8gYW4gaXRlbSBmcm9tIG9uZSBjb250YWluZXIgdG8gYW5vdGhlciB0aGVcclxuXHRcdFx0Ly8gY3VycmVudENvbnRhaW5lciBpcyBzd2l0Y2hlZCBiZWZvcmUgdGhlIHBsYWNlaG9sZGVyIGlzIG1vdmVkLlxyXG5cdFx0XHQvL1xyXG5cdFx0XHQvLyBXaXRob3V0IHRoaXMsIG1vdmluZyBpdGVtcyBpbiBcInN1Yi1zb3J0YWJsZXNcIiBjYW4gY2F1c2VcclxuXHRcdFx0Ly8gdGhlIHBsYWNlaG9sZGVyIHRvIGppdHRlciBiZXR3ZWVuIHRoZSBvdXRlciBhbmQgaW5uZXIgY29udGFpbmVyLlxyXG5cdFx0XHRpZiAoaXRlbS5pbnN0YW5jZSAhPT0gdGhpcy5jdXJyZW50Q29udGFpbmVyKSB7XHJcblx0XHRcdFx0Y29udGludWU7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIGNhbm5vdCBpbnRlcnNlY3Qgd2l0aCBpdHNlbGZcclxuXHRcdFx0Ly8gbm8gdXNlbGVzcyBhY3Rpb25zIHRoYXQgaGF2ZSBiZWVuIGRvbmUgYmVmb3JlXHJcblx0XHRcdC8vIG5vIGFjdGlvbiBpZiB0aGUgaXRlbSBtb3ZlZCBpcyB0aGUgcGFyZW50IG9mIHRoZSBpdGVtIGNoZWNrZWRcclxuXHRcdFx0aWYgKGl0ZW1FbGVtZW50ICE9PSB0aGlzLmN1cnJlbnRJdGVtWzBdICYmXHJcblx0XHRcdFx0dGhpcy5wbGFjZWhvbGRlcltpbnRlcnNlY3Rpb24gPT09IDEgPyBcIm5leHRcIiA6IFwicHJldlwiXSgpWzBdICE9PSBpdGVtRWxlbWVudCAmJlxyXG5cdFx0XHRcdCEkLmNvbnRhaW5zKHRoaXMucGxhY2Vob2xkZXJbMF0sIGl0ZW1FbGVtZW50KSAmJlxyXG5cdFx0XHRcdCh0aGlzLm9wdGlvbnMudHlwZSA9PT0gXCJzZW1pLWR5bmFtaWNcIiA/ICEkLmNvbnRhaW5zKHRoaXMuZWxlbWVudFswXSwgaXRlbUVsZW1lbnQpIDogdHJ1ZSlcclxuXHRcdFx0KSB7XHJcblxyXG5cdFx0XHRcdHRoaXMuZGlyZWN0aW9uID0gaW50ZXJzZWN0aW9uID09PSAxID8gXCJkb3duXCIgOiBcInVwXCI7XHJcblxyXG5cdFx0XHRcdGlmICh0aGlzLm9wdGlvbnMudG9sZXJhbmNlID09PSBcInBvaW50ZXJcIiB8fCB0aGlzLl9pbnRlcnNlY3RzV2l0aFNpZGVzKGl0ZW0pKSB7XHJcblx0XHRcdFx0XHR0aGlzLl9yZWFycmFuZ2UoZXZlbnQsIGl0ZW0pO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdHRoaXMuX3RyaWdnZXIoXCJjaGFuZ2VcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCgpKTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vUG9zdCBldmVudHMgdG8gY29udGFpbmVyc1xyXG5cdFx0dGhpcy5fY29udGFjdENvbnRhaW5lcnMoZXZlbnQpO1xyXG5cclxuXHRcdC8vSW50ZXJjb25uZWN0IHdpdGggZHJvcHBhYmxlc1xyXG5cdFx0aWYoJC51aS5kZG1hbmFnZXIpIHtcclxuXHRcdFx0JC51aS5kZG1hbmFnZXIuZHJhZyh0aGlzLCBldmVudCk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly9DYWxsIGNhbGxiYWNrc1xyXG5cdFx0dGhpcy5fdHJpZ2dlcihcInNvcnRcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCgpKTtcclxuXHJcblx0XHR0aGlzLmxhc3RQb3NpdGlvbkFicyA9IHRoaXMucG9zaXRpb25BYnM7XHJcblx0XHRyZXR1cm4gZmFsc2U7XHJcblxyXG5cdH0sXHJcblxyXG5cdF9tb3VzZVN0b3A6IGZ1bmN0aW9uKGV2ZW50LCBub1Byb3BhZ2F0aW9uKSB7XHJcblxyXG5cdFx0aWYoIWV2ZW50KSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQvL0lmIHdlIGFyZSB1c2luZyBkcm9wcGFibGVzLCBpbmZvcm0gdGhlIG1hbmFnZXIgYWJvdXQgdGhlIGRyb3BcclxuXHRcdGlmICgkLnVpLmRkbWFuYWdlciAmJiAhdGhpcy5vcHRpb25zLmRyb3BCZWhhdmlvdXIpIHtcclxuXHRcdFx0JC51aS5kZG1hbmFnZXIuZHJvcCh0aGlzLCBldmVudCk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYodGhpcy5vcHRpb25zLnJldmVydCkge1xyXG5cdFx0XHR2YXIgdGhhdCA9IHRoaXMsXHJcblx0XHRcdFx0Y3VyID0gdGhpcy5wbGFjZWhvbGRlci5vZmZzZXQoKSxcclxuXHRcdFx0XHRheGlzID0gdGhpcy5vcHRpb25zLmF4aXMsXHJcblx0XHRcdFx0YW5pbWF0aW9uID0ge307XHJcblxyXG5cdFx0XHRpZiAoICFheGlzIHx8IGF4aXMgPT09IFwieFwiICkge1xyXG5cdFx0XHRcdGFuaW1hdGlvbi5sZWZ0ID0gY3VyLmxlZnQgLSB0aGlzLm9mZnNldC5wYXJlbnQubGVmdCAtIHRoaXMubWFyZ2lucy5sZWZ0ICsgKHRoaXMub2Zmc2V0UGFyZW50WzBdID09PSB0aGlzLmRvY3VtZW50WzBdLmJvZHkgPyAwIDogdGhpcy5vZmZzZXRQYXJlbnRbMF0uc2Nyb2xsTGVmdCk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKCAhYXhpcyB8fCBheGlzID09PSBcInlcIiApIHtcclxuXHRcdFx0XHRhbmltYXRpb24udG9wID0gY3VyLnRvcCAtIHRoaXMub2Zmc2V0LnBhcmVudC50b3AgLSB0aGlzLm1hcmdpbnMudG9wICsgKHRoaXMub2Zmc2V0UGFyZW50WzBdID09PSB0aGlzLmRvY3VtZW50WzBdLmJvZHkgPyAwIDogdGhpcy5vZmZzZXRQYXJlbnRbMF0uc2Nyb2xsVG9wKTtcclxuXHRcdFx0fVxyXG5cdFx0XHR0aGlzLnJldmVydGluZyA9IHRydWU7XHJcblx0XHRcdCQodGhpcy5oZWxwZXIpLmFuaW1hdGUoIGFuaW1hdGlvbiwgcGFyc2VJbnQodGhpcy5vcHRpb25zLnJldmVydCwgMTApIHx8IDUwMCwgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0dGhhdC5fY2xlYXIoZXZlbnQpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRoaXMuX2NsZWFyKGV2ZW50LCBub1Byb3BhZ2F0aW9uKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gZmFsc2U7XHJcblxyXG5cdH0sXHJcblxyXG5cdGNhbmNlbDogZnVuY3Rpb24oKSB7XHJcblxyXG5cdFx0aWYodGhpcy5kcmFnZ2luZykge1xyXG5cclxuXHRcdFx0dGhpcy5fbW91c2VVcCh7IHRhcmdldDogbnVsbCB9KTtcclxuXHJcblx0XHRcdGlmKHRoaXMub3B0aW9ucy5oZWxwZXIgPT09IFwib3JpZ2luYWxcIikge1xyXG5cdFx0XHRcdHRoaXMuY3VycmVudEl0ZW0uY3NzKHRoaXMuX3N0b3JlZENTUykucmVtb3ZlQ2xhc3MoXCJ1aS1zb3J0YWJsZS1oZWxwZXJcIik7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dGhpcy5jdXJyZW50SXRlbS5zaG93KCk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vUG9zdCBkZWFjdGl2YXRpbmcgZXZlbnRzIHRvIGNvbnRhaW5lcnNcclxuXHRcdFx0Zm9yICh2YXIgaSA9IHRoaXMuY29udGFpbmVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSl7XHJcblx0XHRcdFx0dGhpcy5jb250YWluZXJzW2ldLl90cmlnZ2VyKFwiZGVhY3RpdmF0ZVwiLCBudWxsLCB0aGlzLl91aUhhc2godGhpcykpO1xyXG5cdFx0XHRcdGlmKHRoaXMuY29udGFpbmVyc1tpXS5jb250YWluZXJDYWNoZS5vdmVyKSB7XHJcblx0XHRcdFx0XHR0aGlzLmNvbnRhaW5lcnNbaV0uX3RyaWdnZXIoXCJvdXRcIiwgbnVsbCwgdGhpcy5fdWlIYXNoKHRoaXMpKTtcclxuXHRcdFx0XHRcdHRoaXMuY29udGFpbmVyc1tpXS5jb250YWluZXJDYWNoZS5vdmVyID0gMDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHRoaXMucGxhY2Vob2xkZXIpIHtcclxuXHRcdFx0Ly8kKHRoaXMucGxhY2Vob2xkZXJbMF0pLnJlbW92ZSgpOyB3b3VsZCBoYXZlIGJlZW4gdGhlIGpRdWVyeSB3YXkgLSB1bmZvcnR1bmF0ZWx5LCBpdCB1bmJpbmRzIEFMTCBldmVudHMgZnJvbSB0aGUgb3JpZ2luYWwgbm9kZSFcclxuXHRcdFx0aWYodGhpcy5wbGFjZWhvbGRlclswXS5wYXJlbnROb2RlKSB7XHJcblx0XHRcdFx0dGhpcy5wbGFjZWhvbGRlclswXS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMucGxhY2Vob2xkZXJbMF0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKHRoaXMub3B0aW9ucy5oZWxwZXIgIT09IFwib3JpZ2luYWxcIiAmJiB0aGlzLmhlbHBlciAmJiB0aGlzLmhlbHBlclswXS5wYXJlbnROb2RlKSB7XHJcblx0XHRcdFx0dGhpcy5oZWxwZXIucmVtb3ZlKCk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdCQuZXh0ZW5kKHRoaXMsIHtcclxuXHRcdFx0XHRoZWxwZXI6IG51bGwsXHJcblx0XHRcdFx0ZHJhZ2dpbmc6IGZhbHNlLFxyXG5cdFx0XHRcdHJldmVydGluZzogZmFsc2UsXHJcblx0XHRcdFx0X25vRmluYWxTb3J0OiBudWxsXHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0aWYodGhpcy5kb21Qb3NpdGlvbi5wcmV2KSB7XHJcblx0XHRcdFx0JCh0aGlzLmRvbVBvc2l0aW9uLnByZXYpLmFmdGVyKHRoaXMuY3VycmVudEl0ZW0pO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdCQodGhpcy5kb21Qb3NpdGlvbi5wYXJlbnQpLnByZXBlbmQodGhpcy5jdXJyZW50SXRlbSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHJcblx0fSxcclxuXHJcblx0c2VyaWFsaXplOiBmdW5jdGlvbihvKSB7XHJcblxyXG5cdFx0dmFyIGl0ZW1zID0gdGhpcy5fZ2V0SXRlbXNBc2pRdWVyeShvICYmIG8uY29ubmVjdGVkKSxcclxuXHRcdFx0c3RyID0gW107XHJcblx0XHRvID0gbyB8fCB7fTtcclxuXHJcblx0XHQkKGl0ZW1zKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2YXIgcmVzID0gKCQoby5pdGVtIHx8IHRoaXMpLmF0dHIoby5hdHRyaWJ1dGUgfHwgXCJpZFwiKSB8fCBcIlwiKS5tYXRjaChvLmV4cHJlc3Npb24gfHwgKC8oLispW1xcLT1fXSguKykvKSk7XHJcblx0XHRcdGlmIChyZXMpIHtcclxuXHRcdFx0XHRzdHIucHVzaCgoby5rZXkgfHwgcmVzWzFdK1wiW11cIikrXCI9XCIrKG8ua2V5ICYmIG8uZXhwcmVzc2lvbiA/IHJlc1sxXSA6IHJlc1syXSkpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHJcblx0XHRpZighc3RyLmxlbmd0aCAmJiBvLmtleSkge1xyXG5cdFx0XHRzdHIucHVzaChvLmtleSArIFwiPVwiKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gc3RyLmpvaW4oXCImXCIpO1xyXG5cclxuXHR9LFxyXG5cclxuXHR0b0FycmF5OiBmdW5jdGlvbihvKSB7XHJcblxyXG5cdFx0dmFyIGl0ZW1zID0gdGhpcy5fZ2V0SXRlbXNBc2pRdWVyeShvICYmIG8uY29ubmVjdGVkKSxcclxuXHRcdFx0cmV0ID0gW107XHJcblxyXG5cdFx0byA9IG8gfHwge307XHJcblxyXG5cdFx0aXRlbXMuZWFjaChmdW5jdGlvbigpIHsgcmV0LnB1c2goJChvLml0ZW0gfHwgdGhpcykuYXR0cihvLmF0dHJpYnV0ZSB8fCBcImlkXCIpIHx8IFwiXCIpOyB9KTtcclxuXHRcdHJldHVybiByZXQ7XHJcblxyXG5cdH0sXHJcblxyXG5cdC8qIEJlIGNhcmVmdWwgd2l0aCB0aGUgZm9sbG93aW5nIGNvcmUgZnVuY3Rpb25zICovXHJcblx0X2ludGVyc2VjdHNXaXRoOiBmdW5jdGlvbihpdGVtKSB7XHJcblxyXG5cdFx0dmFyIHgxID0gdGhpcy5wb3NpdGlvbkFicy5sZWZ0LFxyXG5cdFx0XHR4MiA9IHgxICsgdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCxcclxuXHRcdFx0eTEgPSB0aGlzLnBvc2l0aW9uQWJzLnRvcCxcclxuXHRcdFx0eTIgPSB5MSArIHRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LFxyXG5cdFx0XHRsID0gaXRlbS5sZWZ0LFxyXG5cdFx0XHRyID0gbCArIGl0ZW0ud2lkdGgsXHJcblx0XHRcdHQgPSBpdGVtLnRvcCxcclxuXHRcdFx0YiA9IHQgKyBpdGVtLmhlaWdodCxcclxuXHRcdFx0ZHlDbGljayA9IHRoaXMub2Zmc2V0LmNsaWNrLnRvcCxcclxuXHRcdFx0ZHhDbGljayA9IHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQsXHJcblx0XHRcdGlzT3ZlckVsZW1lbnRIZWlnaHQgPSAoIHRoaXMub3B0aW9ucy5heGlzID09PSBcInhcIiApIHx8ICggKCB5MSArIGR5Q2xpY2sgKSA+IHQgJiYgKCB5MSArIGR5Q2xpY2sgKSA8IGIgKSxcclxuXHRcdFx0aXNPdmVyRWxlbWVudFdpZHRoID0gKCB0aGlzLm9wdGlvbnMuYXhpcyA9PT0gXCJ5XCIgKSB8fCAoICggeDEgKyBkeENsaWNrICkgPiBsICYmICggeDEgKyBkeENsaWNrICkgPCByICksXHJcblx0XHRcdGlzT3ZlckVsZW1lbnQgPSBpc092ZXJFbGVtZW50SGVpZ2h0ICYmIGlzT3ZlckVsZW1lbnRXaWR0aDtcclxuXHJcblx0XHRpZiAoIHRoaXMub3B0aW9ucy50b2xlcmFuY2UgPT09IFwicG9pbnRlclwiIHx8XHJcblx0XHRcdHRoaXMub3B0aW9ucy5mb3JjZVBvaW50ZXJGb3JDb250YWluZXJzIHx8XHJcblx0XHRcdCh0aGlzLm9wdGlvbnMudG9sZXJhbmNlICE9PSBcInBvaW50ZXJcIiAmJiB0aGlzLmhlbHBlclByb3BvcnRpb25zW3RoaXMuZmxvYXRpbmcgPyBcIndpZHRoXCIgOiBcImhlaWdodFwiXSA+IGl0ZW1bdGhpcy5mbG9hdGluZyA/IFwid2lkdGhcIiA6IFwiaGVpZ2h0XCJdKVxyXG5cdFx0KSB7XHJcblx0XHRcdHJldHVybiBpc092ZXJFbGVtZW50O1xyXG5cdFx0fSBlbHNlIHtcclxuXHJcblx0XHRcdHJldHVybiAobCA8IHgxICsgKHRoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGggLyAyKSAmJiAvLyBSaWdodCBIYWxmXHJcblx0XHRcdFx0eDIgLSAodGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAvIDIpIDwgciAmJiAvLyBMZWZ0IEhhbGZcclxuXHRcdFx0XHR0IDwgeTEgKyAodGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQgLyAyKSAmJiAvLyBCb3R0b20gSGFsZlxyXG5cdFx0XHRcdHkyIC0gKHRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0IC8gMikgPCBiICk7IC8vIFRvcCBIYWxmXHJcblxyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdF9pbnRlcnNlY3RzV2l0aFBvaW50ZXI6IGZ1bmN0aW9uKGl0ZW0pIHtcclxuXHJcblx0XHR2YXIgaXNPdmVyRWxlbWVudEhlaWdodCA9ICh0aGlzLm9wdGlvbnMuYXhpcyA9PT0gXCJ4XCIpIHx8IHRoaXMuX2lzT3ZlckF4aXModGhpcy5wb3NpdGlvbkFicy50b3AgKyB0aGlzLm9mZnNldC5jbGljay50b3AsIGl0ZW0udG9wLCBpdGVtLmhlaWdodCksXHJcblx0XHRcdGlzT3ZlckVsZW1lbnRXaWR0aCA9ICh0aGlzLm9wdGlvbnMuYXhpcyA9PT0gXCJ5XCIpIHx8IHRoaXMuX2lzT3ZlckF4aXModGhpcy5wb3NpdGlvbkFicy5sZWZ0ICsgdGhpcy5vZmZzZXQuY2xpY2subGVmdCwgaXRlbS5sZWZ0LCBpdGVtLndpZHRoKSxcclxuXHRcdFx0aXNPdmVyRWxlbWVudCA9IGlzT3ZlckVsZW1lbnRIZWlnaHQgJiYgaXNPdmVyRWxlbWVudFdpZHRoLFxyXG5cdFx0XHR2ZXJ0aWNhbERpcmVjdGlvbiA9IHRoaXMuX2dldERyYWdWZXJ0aWNhbERpcmVjdGlvbigpLFxyXG5cdFx0XHRob3Jpem9udGFsRGlyZWN0aW9uID0gdGhpcy5fZ2V0RHJhZ0hvcml6b250YWxEaXJlY3Rpb24oKTtcclxuXHJcblx0XHRpZiAoIWlzT3ZlckVsZW1lbnQpIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzLmZsb2F0aW5nID9cclxuXHRcdFx0KCAoKGhvcml6b250YWxEaXJlY3Rpb24gJiYgaG9yaXpvbnRhbERpcmVjdGlvbiA9PT0gXCJyaWdodFwiKSB8fCB2ZXJ0aWNhbERpcmVjdGlvbiA9PT0gXCJkb3duXCIpID8gMiA6IDEgKVxyXG5cdFx0XHQ6ICggdmVydGljYWxEaXJlY3Rpb24gJiYgKHZlcnRpY2FsRGlyZWN0aW9uID09PSBcImRvd25cIiA/IDIgOiAxKSApO1xyXG5cclxuXHR9LFxyXG5cclxuXHRfaW50ZXJzZWN0c1dpdGhTaWRlczogZnVuY3Rpb24oaXRlbSkge1xyXG5cclxuXHRcdHZhciBpc092ZXJCb3R0b21IYWxmID0gdGhpcy5faXNPdmVyQXhpcyh0aGlzLnBvc2l0aW9uQWJzLnRvcCArIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCwgaXRlbS50b3AgKyAoaXRlbS5oZWlnaHQvMiksIGl0ZW0uaGVpZ2h0KSxcclxuXHRcdFx0aXNPdmVyUmlnaHRIYWxmID0gdGhpcy5faXNPdmVyQXhpcyh0aGlzLnBvc2l0aW9uQWJzLmxlZnQgKyB0aGlzLm9mZnNldC5jbGljay5sZWZ0LCBpdGVtLmxlZnQgKyAoaXRlbS53aWR0aC8yKSwgaXRlbS53aWR0aCksXHJcblx0XHRcdHZlcnRpY2FsRGlyZWN0aW9uID0gdGhpcy5fZ2V0RHJhZ1ZlcnRpY2FsRGlyZWN0aW9uKCksXHJcblx0XHRcdGhvcml6b250YWxEaXJlY3Rpb24gPSB0aGlzLl9nZXREcmFnSG9yaXpvbnRhbERpcmVjdGlvbigpO1xyXG5cclxuXHRcdGlmICh0aGlzLmZsb2F0aW5nICYmIGhvcml6b250YWxEaXJlY3Rpb24pIHtcclxuXHRcdFx0cmV0dXJuICgoaG9yaXpvbnRhbERpcmVjdGlvbiA9PT0gXCJyaWdodFwiICYmIGlzT3ZlclJpZ2h0SGFsZikgfHwgKGhvcml6b250YWxEaXJlY3Rpb24gPT09IFwibGVmdFwiICYmICFpc092ZXJSaWdodEhhbGYpKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHJldHVybiB2ZXJ0aWNhbERpcmVjdGlvbiAmJiAoKHZlcnRpY2FsRGlyZWN0aW9uID09PSBcImRvd25cIiAmJiBpc092ZXJCb3R0b21IYWxmKSB8fCAodmVydGljYWxEaXJlY3Rpb24gPT09IFwidXBcIiAmJiAhaXNPdmVyQm90dG9tSGFsZikpO1xyXG5cdFx0fVxyXG5cclxuXHR9LFxyXG5cclxuXHRfZ2V0RHJhZ1ZlcnRpY2FsRGlyZWN0aW9uOiBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBkZWx0YSA9IHRoaXMucG9zaXRpb25BYnMudG9wIC0gdGhpcy5sYXN0UG9zaXRpb25BYnMudG9wO1xyXG5cdFx0cmV0dXJuIGRlbHRhICE9PSAwICYmIChkZWx0YSA+IDAgPyBcImRvd25cIiA6IFwidXBcIik7XHJcblx0fSxcclxuXHJcblx0X2dldERyYWdIb3Jpem9udGFsRGlyZWN0aW9uOiBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBkZWx0YSA9IHRoaXMucG9zaXRpb25BYnMubGVmdCAtIHRoaXMubGFzdFBvc2l0aW9uQWJzLmxlZnQ7XHJcblx0XHRyZXR1cm4gZGVsdGEgIT09IDAgJiYgKGRlbHRhID4gMCA/IFwicmlnaHRcIiA6IFwibGVmdFwiKTtcclxuXHR9LFxyXG5cclxuXHRyZWZyZXNoOiBmdW5jdGlvbihldmVudCkge1xyXG5cdFx0dGhpcy5fcmVmcmVzaEl0ZW1zKGV2ZW50KTtcclxuXHRcdHRoaXMuX3NldEhhbmRsZUNsYXNzTmFtZSgpO1xyXG5cdFx0dGhpcy5yZWZyZXNoUG9zaXRpb25zKCk7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRfY29ubmVjdFdpdGg6IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7XHJcblx0XHRyZXR1cm4gb3B0aW9ucy5jb25uZWN0V2l0aC5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nID8gW29wdGlvbnMuY29ubmVjdFdpdGhdIDogb3B0aW9ucy5jb25uZWN0V2l0aDtcclxuXHR9LFxyXG5cclxuXHRfZ2V0SXRlbXNBc2pRdWVyeTogZnVuY3Rpb24oY29ubmVjdGVkKSB7XHJcblxyXG5cdFx0dmFyIGksIGosIGN1ciwgaW5zdCxcclxuXHRcdFx0aXRlbXMgPSBbXSxcclxuXHRcdFx0cXVlcmllcyA9IFtdLFxyXG5cdFx0XHRjb25uZWN0V2l0aCA9IHRoaXMuX2Nvbm5lY3RXaXRoKCk7XHJcblxyXG5cdFx0aWYoY29ubmVjdFdpdGggJiYgY29ubmVjdGVkKSB7XHJcblx0XHRcdGZvciAoaSA9IGNvbm5lY3RXaXRoLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKXtcclxuXHRcdFx0XHRjdXIgPSAkKGNvbm5lY3RXaXRoW2ldLCB0aGlzLmRvY3VtZW50WzBdKTtcclxuXHRcdFx0XHRmb3IgKCBqID0gY3VyLmxlbmd0aCAtIDE7IGogPj0gMDsgai0tKXtcclxuXHRcdFx0XHRcdGluc3QgPSAkLmRhdGEoY3VyW2pdLCB0aGlzLndpZGdldEZ1bGxOYW1lKTtcclxuXHRcdFx0XHRcdGlmKGluc3QgJiYgaW5zdCAhPT0gdGhpcyAmJiAhaW5zdC5vcHRpb25zLmRpc2FibGVkKSB7XHJcblx0XHRcdFx0XHRcdHF1ZXJpZXMucHVzaChbJC5pc0Z1bmN0aW9uKGluc3Qub3B0aW9ucy5pdGVtcykgPyBpbnN0Lm9wdGlvbnMuaXRlbXMuY2FsbChpbnN0LmVsZW1lbnQpIDogJChpbnN0Lm9wdGlvbnMuaXRlbXMsIGluc3QuZWxlbWVudCkubm90KFwiLnVpLXNvcnRhYmxlLWhlbHBlclwiKS5ub3QoXCIudWktc29ydGFibGUtcGxhY2Vob2xkZXJcIiksIGluc3RdKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRxdWVyaWVzLnB1c2goWyQuaXNGdW5jdGlvbih0aGlzLm9wdGlvbnMuaXRlbXMpID8gdGhpcy5vcHRpb25zLml0ZW1zLmNhbGwodGhpcy5lbGVtZW50LCBudWxsLCB7IG9wdGlvbnM6IHRoaXMub3B0aW9ucywgaXRlbTogdGhpcy5jdXJyZW50SXRlbSB9KSA6ICQodGhpcy5vcHRpb25zLml0ZW1zLCB0aGlzLmVsZW1lbnQpLm5vdChcIi51aS1zb3J0YWJsZS1oZWxwZXJcIikubm90KFwiLnVpLXNvcnRhYmxlLXBsYWNlaG9sZGVyXCIpLCB0aGlzXSk7XHJcblxyXG5cdFx0ZnVuY3Rpb24gYWRkSXRlbXMoKSB7XHJcblx0XHRcdGl0ZW1zLnB1c2goIHRoaXMgKTtcclxuXHRcdH1cclxuXHRcdGZvciAoaSA9IHF1ZXJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pe1xyXG5cdFx0XHRxdWVyaWVzW2ldWzBdLmVhY2goIGFkZEl0ZW1zICk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuICQoaXRlbXMpO1xyXG5cclxuXHR9LFxyXG5cclxuXHRfcmVtb3ZlQ3VycmVudHNGcm9tSXRlbXM6IGZ1bmN0aW9uKCkge1xyXG5cclxuXHRcdHZhciBsaXN0ID0gdGhpcy5jdXJyZW50SXRlbS5maW5kKFwiOmRhdGEoXCIgKyB0aGlzLndpZGdldE5hbWUgKyBcIi1pdGVtKVwiKTtcclxuXHJcblx0XHR0aGlzLml0ZW1zID0gJC5ncmVwKHRoaXMuaXRlbXMsIGZ1bmN0aW9uIChpdGVtKSB7XHJcblx0XHRcdGZvciAodmFyIGo9MDsgaiA8IGxpc3QubGVuZ3RoOyBqKyspIHtcclxuXHRcdFx0XHRpZihsaXN0W2pdID09PSBpdGVtLml0ZW1bMF0pIHtcclxuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHR9KTtcclxuXHJcblx0fSxcclxuXHJcblx0X3JlZnJlc2hJdGVtczogZnVuY3Rpb24oZXZlbnQpIHtcclxuXHJcblx0XHR0aGlzLml0ZW1zID0gW107XHJcblx0XHR0aGlzLmNvbnRhaW5lcnMgPSBbdGhpc107XHJcblxyXG5cdFx0dmFyIGksIGosIGN1ciwgaW5zdCwgdGFyZ2V0RGF0YSwgX3F1ZXJpZXMsIGl0ZW0sIHF1ZXJpZXNMZW5ndGgsXHJcblx0XHRcdGl0ZW1zID0gdGhpcy5pdGVtcyxcclxuXHRcdFx0cXVlcmllcyA9IFtbJC5pc0Z1bmN0aW9uKHRoaXMub3B0aW9ucy5pdGVtcykgPyB0aGlzLm9wdGlvbnMuaXRlbXMuY2FsbCh0aGlzLmVsZW1lbnRbMF0sIGV2ZW50LCB7IGl0ZW06IHRoaXMuY3VycmVudEl0ZW0gfSkgOiAkKHRoaXMub3B0aW9ucy5pdGVtcywgdGhpcy5lbGVtZW50KSwgdGhpc11dLFxyXG5cdFx0XHRjb25uZWN0V2l0aCA9IHRoaXMuX2Nvbm5lY3RXaXRoKCk7XHJcblxyXG5cdFx0aWYoY29ubmVjdFdpdGggJiYgdGhpcy5yZWFkeSkgeyAvL1Nob3VsZG4ndCBiZSBydW4gdGhlIGZpcnN0IHRpbWUgdGhyb3VnaCBkdWUgdG8gbWFzc2l2ZSBzbG93LWRvd25cclxuXHRcdFx0Zm9yIChpID0gY29ubmVjdFdpdGgubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pe1xyXG5cdFx0XHRcdGN1ciA9ICQoY29ubmVjdFdpdGhbaV0sIHRoaXMuZG9jdW1lbnRbMF0pO1xyXG5cdFx0XHRcdGZvciAoaiA9IGN1ci5sZW5ndGggLSAxOyBqID49IDA7IGotLSl7XHJcblx0XHRcdFx0XHRpbnN0ID0gJC5kYXRhKGN1cltqXSwgdGhpcy53aWRnZXRGdWxsTmFtZSk7XHJcblx0XHRcdFx0XHRpZihpbnN0ICYmIGluc3QgIT09IHRoaXMgJiYgIWluc3Qub3B0aW9ucy5kaXNhYmxlZCkge1xyXG5cdFx0XHRcdFx0XHRxdWVyaWVzLnB1c2goWyQuaXNGdW5jdGlvbihpbnN0Lm9wdGlvbnMuaXRlbXMpID8gaW5zdC5vcHRpb25zLml0ZW1zLmNhbGwoaW5zdC5lbGVtZW50WzBdLCBldmVudCwgeyBpdGVtOiB0aGlzLmN1cnJlbnRJdGVtIH0pIDogJChpbnN0Lm9wdGlvbnMuaXRlbXMsIGluc3QuZWxlbWVudCksIGluc3RdKTtcclxuXHRcdFx0XHRcdFx0dGhpcy5jb250YWluZXJzLnB1c2goaW5zdCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Zm9yIChpID0gcXVlcmllcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xyXG5cdFx0XHR0YXJnZXREYXRhID0gcXVlcmllc1tpXVsxXTtcclxuXHRcdFx0X3F1ZXJpZXMgPSBxdWVyaWVzW2ldWzBdO1xyXG5cclxuXHRcdFx0Zm9yIChqPTAsIHF1ZXJpZXNMZW5ndGggPSBfcXVlcmllcy5sZW5ndGg7IGogPCBxdWVyaWVzTGVuZ3RoOyBqKyspIHtcclxuXHRcdFx0XHRpdGVtID0gJChfcXVlcmllc1tqXSk7XHJcblxyXG5cdFx0XHRcdGl0ZW0uZGF0YSh0aGlzLndpZGdldE5hbWUgKyBcIi1pdGVtXCIsIHRhcmdldERhdGEpOyAvLyBEYXRhIGZvciB0YXJnZXQgY2hlY2tpbmcgKG1vdXNlIG1hbmFnZXIpXHJcblxyXG5cdFx0XHRcdGl0ZW1zLnB1c2goe1xyXG5cdFx0XHRcdFx0aXRlbTogaXRlbSxcclxuXHRcdFx0XHRcdGluc3RhbmNlOiB0YXJnZXREYXRhLFxyXG5cdFx0XHRcdFx0d2lkdGg6IDAsIGhlaWdodDogMCxcclxuXHRcdFx0XHRcdGxlZnQ6IDAsIHRvcDogMFxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdH0sXHJcblxyXG5cdHJlZnJlc2hQb3NpdGlvbnM6IGZ1bmN0aW9uKGZhc3QpIHtcclxuXHJcblx0XHQvLyBEZXRlcm1pbmUgd2hldGhlciBpdGVtcyBhcmUgYmVpbmcgZGlzcGxheWVkIGhvcml6b250YWxseVxyXG5cdFx0dGhpcy5mbG9hdGluZyA9IHRoaXMuaXRlbXMubGVuZ3RoID9cclxuXHRcdFx0dGhpcy5vcHRpb25zLmF4aXMgPT09IFwieFwiIHx8IHRoaXMuX2lzRmxvYXRpbmcoIHRoaXMuaXRlbXNbIDAgXS5pdGVtICkgOlxyXG5cdFx0XHRmYWxzZTtcclxuXHJcblx0XHQvL1RoaXMgaGFzIHRvIGJlIHJlZG9uZSBiZWNhdXNlIGR1ZSB0byB0aGUgaXRlbSBiZWluZyBtb3ZlZCBvdXQvaW50byB0aGUgb2Zmc2V0UGFyZW50LCB0aGUgb2Zmc2V0UGFyZW50J3MgcG9zaXRpb24gd2lsbCBjaGFuZ2VcclxuXHRcdGlmKHRoaXMub2Zmc2V0UGFyZW50ICYmIHRoaXMuaGVscGVyKSB7XHJcblx0XHRcdHRoaXMub2Zmc2V0LnBhcmVudCA9IHRoaXMuX2dldFBhcmVudE9mZnNldCgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHZhciBpLCBpdGVtLCB0LCBwO1xyXG5cclxuXHRcdGZvciAoaSA9IHRoaXMuaXRlbXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pe1xyXG5cdFx0XHRpdGVtID0gdGhpcy5pdGVtc1tpXTtcclxuXHJcblx0XHRcdC8vV2UgaWdub3JlIGNhbGN1bGF0aW5nIHBvc2l0aW9ucyBvZiBhbGwgY29ubmVjdGVkIGNvbnRhaW5lcnMgd2hlbiB3ZSdyZSBub3Qgb3ZlciB0aGVtXHJcblx0XHRcdGlmKGl0ZW0uaW5zdGFuY2UgIT09IHRoaXMuY3VycmVudENvbnRhaW5lciAmJiB0aGlzLmN1cnJlbnRDb250YWluZXIgJiYgaXRlbS5pdGVtWzBdICE9PSB0aGlzLmN1cnJlbnRJdGVtWzBdKSB7XHJcblx0XHRcdFx0Y29udGludWU7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHQgPSB0aGlzLm9wdGlvbnMudG9sZXJhbmNlRWxlbWVudCA/ICQodGhpcy5vcHRpb25zLnRvbGVyYW5jZUVsZW1lbnQsIGl0ZW0uaXRlbSkgOiBpdGVtLml0ZW07XHJcblxyXG5cdFx0XHRpZiAoIWZhc3QpIHtcclxuXHRcdFx0XHRpdGVtLndpZHRoID0gdC5vdXRlcldpZHRoKCk7XHJcblx0XHRcdFx0aXRlbS5oZWlnaHQgPSB0Lm91dGVySGVpZ2h0KCk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHAgPSB0Lm9mZnNldCgpO1xyXG5cdFx0XHRpdGVtLmxlZnQgPSBwLmxlZnQ7XHJcblx0XHRcdGl0ZW0udG9wID0gcC50b3A7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYodGhpcy5vcHRpb25zLmN1c3RvbSAmJiB0aGlzLm9wdGlvbnMuY3VzdG9tLnJlZnJlc2hDb250YWluZXJzKSB7XHJcblx0XHRcdHRoaXMub3B0aW9ucy5jdXN0b20ucmVmcmVzaENvbnRhaW5lcnMuY2FsbCh0aGlzKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGZvciAoaSA9IHRoaXMuY29udGFpbmVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSl7XHJcblx0XHRcdFx0cCA9IHRoaXMuY29udGFpbmVyc1tpXS5lbGVtZW50Lm9mZnNldCgpO1xyXG5cdFx0XHRcdHRoaXMuY29udGFpbmVyc1tpXS5jb250YWluZXJDYWNoZS5sZWZ0ID0gcC5sZWZ0O1xyXG5cdFx0XHRcdHRoaXMuY29udGFpbmVyc1tpXS5jb250YWluZXJDYWNoZS50b3AgPSBwLnRvcDtcclxuXHRcdFx0XHR0aGlzLmNvbnRhaW5lcnNbaV0uY29udGFpbmVyQ2FjaGUud2lkdGggPSB0aGlzLmNvbnRhaW5lcnNbaV0uZWxlbWVudC5vdXRlcldpZHRoKCk7XHJcblx0XHRcdFx0dGhpcy5jb250YWluZXJzW2ldLmNvbnRhaW5lckNhY2hlLmhlaWdodCA9IHRoaXMuY29udGFpbmVyc1tpXS5lbGVtZW50Lm91dGVySGVpZ2h0KCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRfY3JlYXRlUGxhY2Vob2xkZXI6IGZ1bmN0aW9uKHRoYXQpIHtcclxuXHRcdHRoYXQgPSB0aGF0IHx8IHRoaXM7XHJcblx0XHR2YXIgY2xhc3NOYW1lLFxyXG5cdFx0XHRvID0gdGhhdC5vcHRpb25zO1xyXG5cclxuXHRcdGlmKCFvLnBsYWNlaG9sZGVyIHx8IG8ucGxhY2Vob2xkZXIuY29uc3RydWN0b3IgPT09IFN0cmluZykge1xyXG5cdFx0XHRjbGFzc05hbWUgPSBvLnBsYWNlaG9sZGVyO1xyXG5cdFx0XHRvLnBsYWNlaG9sZGVyID0ge1xyXG5cdFx0XHRcdGVsZW1lbnQ6IGZ1bmN0aW9uKCkge1xyXG5cclxuXHRcdFx0XHRcdHZhciBub2RlTmFtZSA9IHRoYXQuY3VycmVudEl0ZW1bMF0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSxcclxuXHRcdFx0XHRcdFx0ZWxlbWVudCA9ICQoIFwiPFwiICsgbm9kZU5hbWUgKyBcIj5cIiwgdGhhdC5kb2N1bWVudFswXSApXHJcblx0XHRcdFx0XHRcdFx0LmFkZENsYXNzKGNsYXNzTmFtZSB8fCB0aGF0LmN1cnJlbnRJdGVtWzBdLmNsYXNzTmFtZStcIiB1aS1zb3J0YWJsZS1wbGFjZWhvbGRlclwiKVxyXG5cdFx0XHRcdFx0XHRcdC5yZW1vdmVDbGFzcyhcInVpLXNvcnRhYmxlLWhlbHBlclwiKTtcclxuXHJcblx0XHRcdFx0XHRpZiAoIG5vZGVOYW1lID09PSBcInRib2R5XCIgKSB7XHJcblx0XHRcdFx0XHRcdHRoYXQuX2NyZWF0ZVRyUGxhY2Vob2xkZXIoXHJcblx0XHRcdFx0XHRcdFx0dGhhdC5jdXJyZW50SXRlbS5maW5kKCBcInRyXCIgKS5lcSggMCApLFxyXG5cdFx0XHRcdFx0XHRcdCQoIFwiPHRyPlwiLCB0aGF0LmRvY3VtZW50WyAwIF0gKS5hcHBlbmRUbyggZWxlbWVudCApXHJcblx0XHRcdFx0XHRcdCk7XHJcblx0XHRcdFx0XHR9IGVsc2UgaWYgKCBub2RlTmFtZSA9PT0gXCJ0clwiICkge1xyXG5cdFx0XHRcdFx0XHR0aGF0Ll9jcmVhdGVUclBsYWNlaG9sZGVyKCB0aGF0LmN1cnJlbnRJdGVtLCBlbGVtZW50ICk7XHJcblx0XHRcdFx0XHR9IGVsc2UgaWYgKCBub2RlTmFtZSA9PT0gXCJpbWdcIiApIHtcclxuXHRcdFx0XHRcdFx0ZWxlbWVudC5hdHRyKCBcInNyY1wiLCB0aGF0LmN1cnJlbnRJdGVtLmF0dHIoIFwic3JjXCIgKSApO1xyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdGlmICggIWNsYXNzTmFtZSApIHtcclxuXHRcdFx0XHRcdFx0ZWxlbWVudC5jc3MoIFwidmlzaWJpbGl0eVwiLCBcImhpZGRlblwiICk7XHJcblx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0cmV0dXJuIGVsZW1lbnQ7XHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHR1cGRhdGU6IGZ1bmN0aW9uKGNvbnRhaW5lciwgcCkge1xyXG5cclxuXHRcdFx0XHRcdC8vIDEuIElmIGEgY2xhc3NOYW1lIGlzIHNldCBhcyAncGxhY2Vob2xkZXIgb3B0aW9uLCB3ZSBkb24ndCBmb3JjZSBzaXplcyAtIHRoZSBjbGFzcyBpcyByZXNwb25zaWJsZSBmb3IgdGhhdFxyXG5cdFx0XHRcdFx0Ly8gMi4gVGhlIG9wdGlvbiAnZm9yY2VQbGFjZWhvbGRlclNpemUgY2FuIGJlIGVuYWJsZWQgdG8gZm9yY2UgaXQgZXZlbiBpZiBhIGNsYXNzIG5hbWUgaXMgc3BlY2lmaWVkXHJcblx0XHRcdFx0XHRpZihjbGFzc05hbWUgJiYgIW8uZm9yY2VQbGFjZWhvbGRlclNpemUpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdC8vSWYgdGhlIGVsZW1lbnQgZG9lc24ndCBoYXZlIGEgYWN0dWFsIGhlaWdodCBieSBpdHNlbGYgKHdpdGhvdXQgc3R5bGVzIGNvbWluZyBmcm9tIGEgc3R5bGVzaGVldCksIGl0IHJlY2VpdmVzIHRoZSBpbmxpbmUgaGVpZ2h0IGZyb20gdGhlIGRyYWdnZWQgaXRlbVxyXG5cdFx0XHRcdFx0aWYoIXAuaGVpZ2h0KCkpIHsgcC5oZWlnaHQodGhhdC5jdXJyZW50SXRlbS5pbm5lckhlaWdodCgpIC0gcGFyc2VJbnQodGhhdC5jdXJyZW50SXRlbS5jc3MoXCJwYWRkaW5nVG9wXCIpfHwwLCAxMCkgLSBwYXJzZUludCh0aGF0LmN1cnJlbnRJdGVtLmNzcyhcInBhZGRpbmdCb3R0b21cIil8fDAsIDEwKSk7IH1cclxuXHRcdFx0XHRcdGlmKCFwLndpZHRoKCkpIHsgcC53aWR0aCh0aGF0LmN1cnJlbnRJdGVtLmlubmVyV2lkdGgoKSAtIHBhcnNlSW50KHRoYXQuY3VycmVudEl0ZW0uY3NzKFwicGFkZGluZ0xlZnRcIil8fDAsIDEwKSAtIHBhcnNlSW50KHRoYXQuY3VycmVudEl0ZW0uY3NzKFwicGFkZGluZ1JpZ2h0XCIpfHwwLCAxMCkpOyB9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9O1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vQ3JlYXRlIHRoZSBwbGFjZWhvbGRlclxyXG5cdFx0dGhhdC5wbGFjZWhvbGRlciA9ICQoby5wbGFjZWhvbGRlci5lbGVtZW50LmNhbGwodGhhdC5lbGVtZW50LCB0aGF0LmN1cnJlbnRJdGVtKSk7XHJcblxyXG5cdFx0Ly9BcHBlbmQgaXQgYWZ0ZXIgdGhlIGFjdHVhbCBjdXJyZW50IGl0ZW1cclxuXHRcdHRoYXQuY3VycmVudEl0ZW0uYWZ0ZXIodGhhdC5wbGFjZWhvbGRlcik7XHJcblxyXG5cdFx0Ly9VcGRhdGUgdGhlIHNpemUgb2YgdGhlIHBsYWNlaG9sZGVyIChUT0RPOiBMb2dpYyB0byBmdXp6eSwgc2VlIGxpbmUgMzE2LzMxNylcclxuXHRcdG8ucGxhY2Vob2xkZXIudXBkYXRlKHRoYXQsIHRoYXQucGxhY2Vob2xkZXIpO1xyXG5cclxuXHR9LFxyXG5cclxuXHRfY3JlYXRlVHJQbGFjZWhvbGRlcjogZnVuY3Rpb24oIHNvdXJjZVRyLCB0YXJnZXRUciApIHtcclxuXHRcdHZhciB0aGF0ID0gdGhpcztcclxuXHJcblx0XHRzb3VyY2VUci5jaGlsZHJlbigpLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHRcdCQoIFwiPHRkPiYjMTYwOzwvdGQ+XCIsIHRoYXQuZG9jdW1lbnRbIDAgXSApXHJcblx0XHRcdFx0LmF0dHIoIFwiY29sc3BhblwiLCAkKCB0aGlzICkuYXR0ciggXCJjb2xzcGFuXCIgKSB8fCAxIClcclxuXHRcdFx0XHQuYXBwZW5kVG8oIHRhcmdldFRyICk7XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cclxuXHRfY29udGFjdENvbnRhaW5lcnM6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcblx0XHR2YXIgaSwgaiwgZGlzdCwgaXRlbVdpdGhMZWFzdERpc3RhbmNlLCBwb3NQcm9wZXJ0eSwgc2l6ZVByb3BlcnR5LCBjdXIsIG5lYXJCb3R0b20sIGZsb2F0aW5nLCBheGlzLFxyXG5cdFx0XHRpbm5lcm1vc3RDb250YWluZXIgPSBudWxsLFxyXG5cdFx0XHRpbm5lcm1vc3RJbmRleCA9IG51bGw7XHJcblxyXG5cdFx0Ly8gZ2V0IGlubmVybW9zdCBjb250YWluZXIgdGhhdCBpbnRlcnNlY3RzIHdpdGggaXRlbVxyXG5cdFx0Zm9yIChpID0gdGhpcy5jb250YWluZXJzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcblxyXG5cdFx0XHQvLyBuZXZlciBjb25zaWRlciBhIGNvbnRhaW5lciB0aGF0J3MgbG9jYXRlZCB3aXRoaW4gdGhlIGl0ZW0gaXRzZWxmXHJcblx0XHRcdGlmKCQuY29udGFpbnModGhpcy5jdXJyZW50SXRlbVswXSwgdGhpcy5jb250YWluZXJzW2ldLmVsZW1lbnRbMF0pKSB7XHJcblx0XHRcdFx0Y29udGludWU7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmKHRoaXMuX2ludGVyc2VjdHNXaXRoKHRoaXMuY29udGFpbmVyc1tpXS5jb250YWluZXJDYWNoZSkpIHtcclxuXHJcblx0XHRcdFx0Ly8gaWYgd2UndmUgYWxyZWFkeSBmb3VuZCBhIGNvbnRhaW5lciBhbmQgaXQncyBtb3JlIFwiaW5uZXJcIiB0aGFuIHRoaXMsIHRoZW4gY29udGludWVcclxuXHRcdFx0XHRpZihpbm5lcm1vc3RDb250YWluZXIgJiYgJC5jb250YWlucyh0aGlzLmNvbnRhaW5lcnNbaV0uZWxlbWVudFswXSwgaW5uZXJtb3N0Q29udGFpbmVyLmVsZW1lbnRbMF0pKSB7XHJcblx0XHRcdFx0XHRjb250aW51ZTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGlubmVybW9zdENvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyc1tpXTtcclxuXHRcdFx0XHRpbm5lcm1vc3RJbmRleCA9IGk7XHJcblxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdC8vIGNvbnRhaW5lciBkb2Vzbid0IGludGVyc2VjdC4gdHJpZ2dlciBcIm91dFwiIGV2ZW50IGlmIG5lY2Vzc2FyeVxyXG5cdFx0XHRcdGlmKHRoaXMuY29udGFpbmVyc1tpXS5jb250YWluZXJDYWNoZS5vdmVyKSB7XHJcblx0XHRcdFx0XHR0aGlzLmNvbnRhaW5lcnNbaV0uX3RyaWdnZXIoXCJvdXRcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCh0aGlzKSk7XHJcblx0XHRcdFx0XHR0aGlzLmNvbnRhaW5lcnNbaV0uY29udGFpbmVyQ2FjaGUub3ZlciA9IDA7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIGlmIG5vIGludGVyc2VjdGluZyBjb250YWluZXJzIGZvdW5kLCByZXR1cm5cclxuXHRcdGlmKCFpbm5lcm1vc3RDb250YWluZXIpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIG1vdmUgdGhlIGl0ZW0gaW50byB0aGUgY29udGFpbmVyIGlmIGl0J3Mgbm90IHRoZXJlIGFscmVhZHlcclxuXHRcdGlmKHRoaXMuY29udGFpbmVycy5sZW5ndGggPT09IDEpIHtcclxuXHRcdFx0aWYgKCF0aGlzLmNvbnRhaW5lcnNbaW5uZXJtb3N0SW5kZXhdLmNvbnRhaW5lckNhY2hlLm92ZXIpIHtcclxuXHRcdFx0XHR0aGlzLmNvbnRhaW5lcnNbaW5uZXJtb3N0SW5kZXhdLl90cmlnZ2VyKFwib3ZlclwiLCBldmVudCwgdGhpcy5fdWlIYXNoKHRoaXMpKTtcclxuXHRcdFx0XHR0aGlzLmNvbnRhaW5lcnNbaW5uZXJtb3N0SW5kZXhdLmNvbnRhaW5lckNhY2hlLm92ZXIgPSAxO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2Uge1xyXG5cclxuXHRcdFx0Ly9XaGVuIGVudGVyaW5nIGEgbmV3IGNvbnRhaW5lciwgd2Ugd2lsbCBmaW5kIHRoZSBpdGVtIHdpdGggdGhlIGxlYXN0IGRpc3RhbmNlIGFuZCBhcHBlbmQgb3VyIGl0ZW0gbmVhciBpdFxyXG5cdFx0XHRkaXN0ID0gMTAwMDA7XHJcblx0XHRcdGl0ZW1XaXRoTGVhc3REaXN0YW5jZSA9IG51bGw7XHJcblx0XHRcdGZsb2F0aW5nID0gaW5uZXJtb3N0Q29udGFpbmVyLmZsb2F0aW5nIHx8IHRoaXMuX2lzRmxvYXRpbmcodGhpcy5jdXJyZW50SXRlbSk7XHJcblx0XHRcdHBvc1Byb3BlcnR5ID0gZmxvYXRpbmcgPyBcImxlZnRcIiA6IFwidG9wXCI7XHJcblx0XHRcdHNpemVQcm9wZXJ0eSA9IGZsb2F0aW5nID8gXCJ3aWR0aFwiIDogXCJoZWlnaHRcIjtcclxuXHRcdFx0YXhpcyA9IGZsb2F0aW5nID8gXCJjbGllbnRYXCIgOiBcImNsaWVudFlcIjtcclxuXHJcblx0XHRcdGZvciAoaiA9IHRoaXMuaXRlbXMubGVuZ3RoIC0gMTsgaiA+PSAwOyBqLS0pIHtcclxuXHRcdFx0XHRpZighJC5jb250YWlucyh0aGlzLmNvbnRhaW5lcnNbaW5uZXJtb3N0SW5kZXhdLmVsZW1lbnRbMF0sIHRoaXMuaXRlbXNbal0uaXRlbVswXSkpIHtcclxuXHRcdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZih0aGlzLml0ZW1zW2pdLml0ZW1bMF0gPT09IHRoaXMuY3VycmVudEl0ZW1bMF0pIHtcclxuXHRcdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0Y3VyID0gdGhpcy5pdGVtc1tqXS5pdGVtLm9mZnNldCgpW3Bvc1Byb3BlcnR5XTtcclxuXHRcdFx0XHRuZWFyQm90dG9tID0gZmFsc2U7XHJcblx0XHRcdFx0aWYgKCBldmVudFsgYXhpcyBdIC0gY3VyID4gdGhpcy5pdGVtc1sgaiBdWyBzaXplUHJvcGVydHkgXSAvIDIgKSB7XHJcblx0XHRcdFx0XHRuZWFyQm90dG9tID0gdHJ1ZTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGlmICggTWF0aC5hYnMoIGV2ZW50WyBheGlzIF0gLSBjdXIgKSA8IGRpc3QgKSB7XHJcblx0XHRcdFx0XHRkaXN0ID0gTWF0aC5hYnMoIGV2ZW50WyBheGlzIF0gLSBjdXIgKTtcclxuXHRcdFx0XHRcdGl0ZW1XaXRoTGVhc3REaXN0YW5jZSA9IHRoaXMuaXRlbXNbIGogXTtcclxuXHRcdFx0XHRcdHRoaXMuZGlyZWN0aW9uID0gbmVhckJvdHRvbSA/IFwidXBcIjogXCJkb3duXCI7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvL0NoZWNrIGlmIGRyb3BPbkVtcHR5IGlzIGVuYWJsZWRcclxuXHRcdFx0aWYoIWl0ZW1XaXRoTGVhc3REaXN0YW5jZSAmJiAhdGhpcy5vcHRpb25zLmRyb3BPbkVtcHR5KSB7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZih0aGlzLmN1cnJlbnRDb250YWluZXIgPT09IHRoaXMuY29udGFpbmVyc1tpbm5lcm1vc3RJbmRleF0pIHtcclxuXHRcdFx0XHRpZiAoICF0aGlzLmN1cnJlbnRDb250YWluZXIuY29udGFpbmVyQ2FjaGUub3ZlciApIHtcclxuXHRcdFx0XHRcdHRoaXMuY29udGFpbmVyc1sgaW5uZXJtb3N0SW5kZXggXS5fdHJpZ2dlciggXCJvdmVyXCIsIGV2ZW50LCB0aGlzLl91aUhhc2goKSApO1xyXG5cdFx0XHRcdFx0dGhpcy5jdXJyZW50Q29udGFpbmVyLmNvbnRhaW5lckNhY2hlLm92ZXIgPSAxO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGl0ZW1XaXRoTGVhc3REaXN0YW5jZSA/IHRoaXMuX3JlYXJyYW5nZShldmVudCwgaXRlbVdpdGhMZWFzdERpc3RhbmNlLCBudWxsLCB0cnVlKSA6IHRoaXMuX3JlYXJyYW5nZShldmVudCwgbnVsbCwgdGhpcy5jb250YWluZXJzW2lubmVybW9zdEluZGV4XS5lbGVtZW50LCB0cnVlKTtcclxuXHRcdFx0dGhpcy5fdHJpZ2dlcihcImNoYW5nZVwiLCBldmVudCwgdGhpcy5fdWlIYXNoKCkpO1xyXG5cdFx0XHR0aGlzLmNvbnRhaW5lcnNbaW5uZXJtb3N0SW5kZXhdLl90cmlnZ2VyKFwiY2hhbmdlXCIsIGV2ZW50LCB0aGlzLl91aUhhc2godGhpcykpO1xyXG5cdFx0XHR0aGlzLmN1cnJlbnRDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lcnNbaW5uZXJtb3N0SW5kZXhdO1xyXG5cclxuXHRcdFx0Ly9VcGRhdGUgdGhlIHBsYWNlaG9sZGVyXHJcblx0XHRcdHRoaXMub3B0aW9ucy5wbGFjZWhvbGRlci51cGRhdGUodGhpcy5jdXJyZW50Q29udGFpbmVyLCB0aGlzLnBsYWNlaG9sZGVyKTtcclxuXHJcblx0XHRcdHRoaXMuY29udGFpbmVyc1tpbm5lcm1vc3RJbmRleF0uX3RyaWdnZXIoXCJvdmVyXCIsIGV2ZW50LCB0aGlzLl91aUhhc2godGhpcykpO1xyXG5cdFx0XHR0aGlzLmNvbnRhaW5lcnNbaW5uZXJtb3N0SW5kZXhdLmNvbnRhaW5lckNhY2hlLm92ZXIgPSAxO1xyXG5cdFx0fVxyXG5cclxuXHJcblx0fSxcclxuXHJcblx0X2NyZWF0ZUhlbHBlcjogZnVuY3Rpb24oZXZlbnQpIHtcclxuXHJcblx0XHR2YXIgbyA9IHRoaXMub3B0aW9ucyxcclxuXHRcdFx0aGVscGVyID0gJC5pc0Z1bmN0aW9uKG8uaGVscGVyKSA/ICQoby5oZWxwZXIuYXBwbHkodGhpcy5lbGVtZW50WzBdLCBbZXZlbnQsIHRoaXMuY3VycmVudEl0ZW1dKSkgOiAoby5oZWxwZXIgPT09IFwiY2xvbmVcIiA/IHRoaXMuY3VycmVudEl0ZW0uY2xvbmUoKSA6IHRoaXMuY3VycmVudEl0ZW0pO1xyXG5cclxuXHRcdC8vQWRkIHRoZSBoZWxwZXIgdG8gdGhlIERPTSBpZiB0aGF0IGRpZG4ndCBoYXBwZW4gYWxyZWFkeVxyXG5cdFx0aWYoIWhlbHBlci5wYXJlbnRzKFwiYm9keVwiKS5sZW5ndGgpIHtcclxuXHRcdFx0JChvLmFwcGVuZFRvICE9PSBcInBhcmVudFwiID8gby5hcHBlbmRUbyA6IHRoaXMuY3VycmVudEl0ZW1bMF0ucGFyZW50Tm9kZSlbMF0uYXBwZW5kQ2hpbGQoaGVscGVyWzBdKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZihoZWxwZXJbMF0gPT09IHRoaXMuY3VycmVudEl0ZW1bMF0pIHtcclxuXHRcdFx0dGhpcy5fc3RvcmVkQ1NTID0geyB3aWR0aDogdGhpcy5jdXJyZW50SXRlbVswXS5zdHlsZS53aWR0aCwgaGVpZ2h0OiB0aGlzLmN1cnJlbnRJdGVtWzBdLnN0eWxlLmhlaWdodCwgcG9zaXRpb246IHRoaXMuY3VycmVudEl0ZW0uY3NzKFwicG9zaXRpb25cIiksIHRvcDogdGhpcy5jdXJyZW50SXRlbS5jc3MoXCJ0b3BcIiksIGxlZnQ6IHRoaXMuY3VycmVudEl0ZW0uY3NzKFwibGVmdFwiKSB9O1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKCFoZWxwZXJbMF0uc3R5bGUud2lkdGggfHwgby5mb3JjZUhlbHBlclNpemUpIHtcclxuXHRcdFx0aGVscGVyLndpZHRoKHRoaXMuY3VycmVudEl0ZW0ud2lkdGgoKSk7XHJcblx0XHR9XHJcblx0XHRpZighaGVscGVyWzBdLnN0eWxlLmhlaWdodCB8fCBvLmZvcmNlSGVscGVyU2l6ZSkge1xyXG5cdFx0XHRoZWxwZXIuaGVpZ2h0KHRoaXMuY3VycmVudEl0ZW0uaGVpZ2h0KCkpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBoZWxwZXI7XHJcblxyXG5cdH0sXHJcblxyXG5cdF9hZGp1c3RPZmZzZXRGcm9tSGVscGVyOiBmdW5jdGlvbihvYmopIHtcclxuXHRcdGlmICh0eXBlb2Ygb2JqID09PSBcInN0cmluZ1wiKSB7XHJcblx0XHRcdG9iaiA9IG9iai5zcGxpdChcIiBcIik7XHJcblx0XHR9XHJcblx0XHRpZiAoJC5pc0FycmF5KG9iaikpIHtcclxuXHRcdFx0b2JqID0ge2xlZnQ6ICtvYmpbMF0sIHRvcDogK29ialsxXSB8fCAwfTtcclxuXHRcdH1cclxuXHRcdGlmIChcImxlZnRcIiBpbiBvYmopIHtcclxuXHRcdFx0dGhpcy5vZmZzZXQuY2xpY2subGVmdCA9IG9iai5sZWZ0ICsgdGhpcy5tYXJnaW5zLmxlZnQ7XHJcblx0XHR9XHJcblx0XHRpZiAoXCJyaWdodFwiIGluIG9iaikge1xyXG5cdFx0XHR0aGlzLm9mZnNldC5jbGljay5sZWZ0ID0gdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAtIG9iai5yaWdodCArIHRoaXMubWFyZ2lucy5sZWZ0O1xyXG5cdFx0fVxyXG5cdFx0aWYgKFwidG9wXCIgaW4gb2JqKSB7XHJcblx0XHRcdHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA9IG9iai50b3AgKyB0aGlzLm1hcmdpbnMudG9wO1xyXG5cdFx0fVxyXG5cdFx0aWYgKFwiYm90dG9tXCIgaW4gb2JqKSB7XHJcblx0XHRcdHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA9IHRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0IC0gb2JqLmJvdHRvbSArIHRoaXMubWFyZ2lucy50b3A7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0X2dldFBhcmVudE9mZnNldDogZnVuY3Rpb24oKSB7XHJcblxyXG5cclxuXHRcdC8vR2V0IHRoZSBvZmZzZXRQYXJlbnQgYW5kIGNhY2hlIGl0cyBwb3NpdGlvblxyXG5cdFx0dGhpcy5vZmZzZXRQYXJlbnQgPSB0aGlzLmhlbHBlci5vZmZzZXRQYXJlbnQoKTtcclxuXHRcdHZhciBwbyA9IHRoaXMub2Zmc2V0UGFyZW50Lm9mZnNldCgpO1xyXG5cclxuXHRcdC8vIFRoaXMgaXMgYSBzcGVjaWFsIGNhc2Ugd2hlcmUgd2UgbmVlZCB0byBtb2RpZnkgYSBvZmZzZXQgY2FsY3VsYXRlZCBvbiBzdGFydCwgc2luY2UgdGhlIGZvbGxvd2luZyBoYXBwZW5lZDpcclxuXHRcdC8vIDEuIFRoZSBwb3NpdGlvbiBvZiB0aGUgaGVscGVyIGlzIGFic29sdXRlLCBzbyBpdCdzIHBvc2l0aW9uIGlzIGNhbGN1bGF0ZWQgYmFzZWQgb24gdGhlIG5leHQgcG9zaXRpb25lZCBwYXJlbnRcclxuXHRcdC8vIDIuIFRoZSBhY3R1YWwgb2Zmc2V0IHBhcmVudCBpcyBhIGNoaWxkIG9mIHRoZSBzY3JvbGwgcGFyZW50LCBhbmQgdGhlIHNjcm9sbCBwYXJlbnQgaXNuJ3QgdGhlIGRvY3VtZW50LCB3aGljaCBtZWFucyB0aGF0XHJcblx0XHQvLyAgICB0aGUgc2Nyb2xsIGlzIGluY2x1ZGVkIGluIHRoZSBpbml0aWFsIGNhbGN1bGF0aW9uIG9mIHRoZSBvZmZzZXQgb2YgdGhlIHBhcmVudCwgYW5kIG5ldmVyIHJlY2FsY3VsYXRlZCB1cG9uIGRyYWdcclxuXHRcdGlmKHRoaXMuY3NzUG9zaXRpb24gPT09IFwiYWJzb2x1dGVcIiAmJiB0aGlzLnNjcm9sbFBhcmVudFswXSAhPT0gdGhpcy5kb2N1bWVudFswXSAmJiAkLmNvbnRhaW5zKHRoaXMuc2Nyb2xsUGFyZW50WzBdLCB0aGlzLm9mZnNldFBhcmVudFswXSkpIHtcclxuXHRcdFx0cG8ubGVmdCArPSB0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KCk7XHJcblx0XHRcdHBvLnRvcCArPSB0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxUb3AoKTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBUaGlzIG5lZWRzIHRvIGJlIGFjdHVhbGx5IGRvbmUgZm9yIGFsbCBicm93c2Vycywgc2luY2UgcGFnZVgvcGFnZVkgaW5jbHVkZXMgdGhpcyBpbmZvcm1hdGlvblxyXG5cdFx0Ly8gd2l0aCBhbiB1Z2x5IElFIGZpeFxyXG5cdFx0aWYoIHRoaXMub2Zmc2V0UGFyZW50WzBdID09PSB0aGlzLmRvY3VtZW50WzBdLmJvZHkgfHwgKHRoaXMub2Zmc2V0UGFyZW50WzBdLnRhZ05hbWUgJiYgdGhpcy5vZmZzZXRQYXJlbnRbMF0udGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSBcImh0bWxcIiAmJiAkLnVpLmllKSkge1xyXG5cdFx0XHRwbyA9IHsgdG9wOiAwLCBsZWZ0OiAwIH07XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHtcclxuXHRcdFx0dG9wOiBwby50b3AgKyAocGFyc2VJbnQodGhpcy5vZmZzZXRQYXJlbnQuY3NzKFwiYm9yZGVyVG9wV2lkdGhcIiksMTApIHx8IDApLFxyXG5cdFx0XHRsZWZ0OiBwby5sZWZ0ICsgKHBhcnNlSW50KHRoaXMub2Zmc2V0UGFyZW50LmNzcyhcImJvcmRlckxlZnRXaWR0aFwiKSwxMCkgfHwgMClcclxuXHRcdH07XHJcblxyXG5cdH0sXHJcblxyXG5cdF9nZXRSZWxhdGl2ZU9mZnNldDogZnVuY3Rpb24oKSB7XHJcblxyXG5cdFx0aWYodGhpcy5jc3NQb3NpdGlvbiA9PT0gXCJyZWxhdGl2ZVwiKSB7XHJcblx0XHRcdHZhciBwID0gdGhpcy5jdXJyZW50SXRlbS5wb3NpdGlvbigpO1xyXG5cdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdHRvcDogcC50b3AgLSAocGFyc2VJbnQodGhpcy5oZWxwZXIuY3NzKFwidG9wXCIpLDEwKSB8fCAwKSArIHRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpLFxyXG5cdFx0XHRcdGxlZnQ6IHAubGVmdCAtIChwYXJzZUludCh0aGlzLmhlbHBlci5jc3MoXCJsZWZ0XCIpLDEwKSB8fCAwKSArIHRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbExlZnQoKVxyXG5cdFx0XHR9O1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0cmV0dXJuIHsgdG9wOiAwLCBsZWZ0OiAwIH07XHJcblx0XHR9XHJcblxyXG5cdH0sXHJcblxyXG5cdF9jYWNoZU1hcmdpbnM6IGZ1bmN0aW9uKCkge1xyXG5cdFx0dGhpcy5tYXJnaW5zID0ge1xyXG5cdFx0XHRsZWZ0OiAocGFyc2VJbnQodGhpcy5jdXJyZW50SXRlbS5jc3MoXCJtYXJnaW5MZWZ0XCIpLDEwKSB8fCAwKSxcclxuXHRcdFx0dG9wOiAocGFyc2VJbnQodGhpcy5jdXJyZW50SXRlbS5jc3MoXCJtYXJnaW5Ub3BcIiksMTApIHx8IDApXHJcblx0XHR9O1xyXG5cdH0sXHJcblxyXG5cdF9jYWNoZUhlbHBlclByb3BvcnRpb25zOiBmdW5jdGlvbigpIHtcclxuXHRcdHRoaXMuaGVscGVyUHJvcG9ydGlvbnMgPSB7XHJcblx0XHRcdHdpZHRoOiB0aGlzLmhlbHBlci5vdXRlcldpZHRoKCksXHJcblx0XHRcdGhlaWdodDogdGhpcy5oZWxwZXIub3V0ZXJIZWlnaHQoKVxyXG5cdFx0fTtcclxuXHR9LFxyXG5cclxuXHRfc2V0Q29udGFpbm1lbnQ6IGZ1bmN0aW9uKCkge1xyXG5cclxuXHRcdHZhciBjZSwgY28sIG92ZXIsXHJcblx0XHRcdG8gPSB0aGlzLm9wdGlvbnM7XHJcblx0XHRpZihvLmNvbnRhaW5tZW50ID09PSBcInBhcmVudFwiKSB7XHJcblx0XHRcdG8uY29udGFpbm1lbnQgPSB0aGlzLmhlbHBlclswXS5wYXJlbnROb2RlO1xyXG5cdFx0fVxyXG5cdFx0aWYoby5jb250YWlubWVudCA9PT0gXCJkb2N1bWVudFwiIHx8IG8uY29udGFpbm1lbnQgPT09IFwid2luZG93XCIpIHtcclxuXHRcdFx0dGhpcy5jb250YWlubWVudCA9IFtcclxuXHRcdFx0XHQwIC0gdGhpcy5vZmZzZXQucmVsYXRpdmUubGVmdCAtIHRoaXMub2Zmc2V0LnBhcmVudC5sZWZ0LFxyXG5cdFx0XHRcdDAgLSB0aGlzLm9mZnNldC5yZWxhdGl2ZS50b3AgLSB0aGlzLm9mZnNldC5wYXJlbnQudG9wLFxyXG5cdFx0XHRcdG8uY29udGFpbm1lbnQgPT09IFwiZG9jdW1lbnRcIiA/IHRoaXMuZG9jdW1lbnQud2lkdGgoKSA6IHRoaXMud2luZG93LndpZHRoKCkgLSB0aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoIC0gdGhpcy5tYXJnaW5zLmxlZnQsXHJcblx0XHRcdFx0KG8uY29udGFpbm1lbnQgPT09IFwiZG9jdW1lbnRcIiA/IHRoaXMuZG9jdW1lbnQud2lkdGgoKSA6IHRoaXMud2luZG93LmhlaWdodCgpIHx8IHRoaXMuZG9jdW1lbnRbMF0uYm9keS5wYXJlbnROb2RlLnNjcm9sbEhlaWdodCkgLSB0aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCAtIHRoaXMubWFyZ2lucy50b3BcclxuXHRcdFx0XTtcclxuXHRcdH1cclxuXHJcblx0XHRpZighKC9eKGRvY3VtZW50fHdpbmRvd3xwYXJlbnQpJC8pLnRlc3Qoby5jb250YWlubWVudCkpIHtcclxuXHRcdFx0Y2UgPSAkKG8uY29udGFpbm1lbnQpWzBdO1xyXG5cdFx0XHRjbyA9ICQoby5jb250YWlubWVudCkub2Zmc2V0KCk7XHJcblx0XHRcdG92ZXIgPSAoJChjZSkuY3NzKFwib3ZlcmZsb3dcIikgIT09IFwiaGlkZGVuXCIpO1xyXG5cclxuXHRcdFx0dGhpcy5jb250YWlubWVudCA9IFtcclxuXHRcdFx0XHRjby5sZWZ0ICsgKHBhcnNlSW50KCQoY2UpLmNzcyhcImJvcmRlckxlZnRXaWR0aFwiKSwxMCkgfHwgMCkgKyAocGFyc2VJbnQoJChjZSkuY3NzKFwicGFkZGluZ0xlZnRcIiksMTApIHx8IDApIC0gdGhpcy5tYXJnaW5zLmxlZnQsXHJcblx0XHRcdFx0Y28udG9wICsgKHBhcnNlSW50KCQoY2UpLmNzcyhcImJvcmRlclRvcFdpZHRoXCIpLDEwKSB8fCAwKSArIChwYXJzZUludCgkKGNlKS5jc3MoXCJwYWRkaW5nVG9wXCIpLDEwKSB8fCAwKSAtIHRoaXMubWFyZ2lucy50b3AsXHJcblx0XHRcdFx0Y28ubGVmdCsob3ZlciA/IE1hdGgubWF4KGNlLnNjcm9sbFdpZHRoLGNlLm9mZnNldFdpZHRoKSA6IGNlLm9mZnNldFdpZHRoKSAtIChwYXJzZUludCgkKGNlKS5jc3MoXCJib3JkZXJMZWZ0V2lkdGhcIiksMTApIHx8IDApIC0gKHBhcnNlSW50KCQoY2UpLmNzcyhcInBhZGRpbmdSaWdodFwiKSwxMCkgfHwgMCkgLSB0aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoIC0gdGhpcy5tYXJnaW5zLmxlZnQsXHJcblx0XHRcdFx0Y28udG9wKyhvdmVyID8gTWF0aC5tYXgoY2Uuc2Nyb2xsSGVpZ2h0LGNlLm9mZnNldEhlaWdodCkgOiBjZS5vZmZzZXRIZWlnaHQpIC0gKHBhcnNlSW50KCQoY2UpLmNzcyhcImJvcmRlclRvcFdpZHRoXCIpLDEwKSB8fCAwKSAtIChwYXJzZUludCgkKGNlKS5jc3MoXCJwYWRkaW5nQm90dG9tXCIpLDEwKSB8fCAwKSAtIHRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0IC0gdGhpcy5tYXJnaW5zLnRvcFxyXG5cdFx0XHRdO1xyXG5cdFx0fVxyXG5cclxuXHR9LFxyXG5cclxuXHRfY29udmVydFBvc2l0aW9uVG86IGZ1bmN0aW9uKGQsIHBvcykge1xyXG5cclxuXHRcdGlmKCFwb3MpIHtcclxuXHRcdFx0cG9zID0gdGhpcy5wb3NpdGlvbjtcclxuXHRcdH1cclxuXHRcdHZhciBtb2QgPSBkID09PSBcImFic29sdXRlXCIgPyAxIDogLTEsXHJcblx0XHRcdHNjcm9sbCA9IHRoaXMuY3NzUG9zaXRpb24gPT09IFwiYWJzb2x1dGVcIiAmJiAhKHRoaXMuc2Nyb2xsUGFyZW50WzBdICE9PSB0aGlzLmRvY3VtZW50WzBdICYmICQuY29udGFpbnModGhpcy5zY3JvbGxQYXJlbnRbMF0sIHRoaXMub2Zmc2V0UGFyZW50WzBdKSkgPyB0aGlzLm9mZnNldFBhcmVudCA6IHRoaXMuc2Nyb2xsUGFyZW50LFxyXG5cdFx0XHRzY3JvbGxJc1Jvb3ROb2RlID0gKC8oaHRtbHxib2R5KS9pKS50ZXN0KHNjcm9sbFswXS50YWdOYW1lKTtcclxuXHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHR0b3A6IChcclxuXHRcdFx0XHRwb3MudG9wXHQrXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBUaGUgYWJzb2x1dGUgbW91c2UgcG9zaXRpb25cclxuXHRcdFx0XHR0aGlzLm9mZnNldC5yZWxhdGl2ZS50b3AgKiBtb2QgK1x0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gT25seSBmb3IgcmVsYXRpdmUgcG9zaXRpb25lZCBub2RlczogUmVsYXRpdmUgb2Zmc2V0IGZyb20gZWxlbWVudCB0byBvZmZzZXQgcGFyZW50XHJcblx0XHRcdFx0dGhpcy5vZmZzZXQucGFyZW50LnRvcCAqIG1vZCAtXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRoZSBvZmZzZXRQYXJlbnQncyBvZmZzZXQgd2l0aG91dCBib3JkZXJzIChvZmZzZXQgKyBib3JkZXIpXHJcblx0XHRcdFx0KCAoIHRoaXMuY3NzUG9zaXRpb24gPT09IFwiZml4ZWRcIiA/IC10aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxUb3AoKSA6ICggc2Nyb2xsSXNSb290Tm9kZSA/IDAgOiBzY3JvbGwuc2Nyb2xsVG9wKCkgKSApICogbW9kKVxyXG5cdFx0XHQpLFxyXG5cdFx0XHRsZWZ0OiAoXHJcblx0XHRcdFx0cG9zLmxlZnQgK1x0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIGFic29sdXRlIG1vdXNlIHBvc2l0aW9uXHJcblx0XHRcdFx0dGhpcy5vZmZzZXQucmVsYXRpdmUubGVmdCAqIG1vZCArXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBPbmx5IGZvciByZWxhdGl2ZSBwb3NpdGlvbmVkIG5vZGVzOiBSZWxhdGl2ZSBvZmZzZXQgZnJvbSBlbGVtZW50IHRvIG9mZnNldCBwYXJlbnRcclxuXHRcdFx0XHR0aGlzLm9mZnNldC5wYXJlbnQubGVmdCAqIG1vZFx0LVx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIG9mZnNldFBhcmVudCdzIG9mZnNldCB3aXRob3V0IGJvcmRlcnMgKG9mZnNldCArIGJvcmRlcilcclxuXHRcdFx0XHQoICggdGhpcy5jc3NQb3NpdGlvbiA9PT0gXCJmaXhlZFwiID8gLXRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbExlZnQoKSA6IHNjcm9sbElzUm9vdE5vZGUgPyAwIDogc2Nyb2xsLnNjcm9sbExlZnQoKSApICogbW9kKVxyXG5cdFx0XHQpXHJcblx0XHR9O1xyXG5cclxuXHR9LFxyXG5cclxuXHRfZ2VuZXJhdGVQb3NpdGlvbjogZnVuY3Rpb24oZXZlbnQpIHtcclxuXHJcblx0XHR2YXIgdG9wLCBsZWZ0LFxyXG5cdFx0XHRvID0gdGhpcy5vcHRpb25zLFxyXG5cdFx0XHRwYWdlWCA9IGV2ZW50LnBhZ2VYLFxyXG5cdFx0XHRwYWdlWSA9IGV2ZW50LnBhZ2VZLFxyXG5cdFx0XHRzY3JvbGwgPSB0aGlzLmNzc1Bvc2l0aW9uID09PSBcImFic29sdXRlXCIgJiYgISh0aGlzLnNjcm9sbFBhcmVudFswXSAhPT0gdGhpcy5kb2N1bWVudFswXSAmJiAkLmNvbnRhaW5zKHRoaXMuc2Nyb2xsUGFyZW50WzBdLCB0aGlzLm9mZnNldFBhcmVudFswXSkpID8gdGhpcy5vZmZzZXRQYXJlbnQgOiB0aGlzLnNjcm9sbFBhcmVudCwgc2Nyb2xsSXNSb290Tm9kZSA9ICgvKGh0bWx8Ym9keSkvaSkudGVzdChzY3JvbGxbMF0udGFnTmFtZSk7XHJcblxyXG5cdFx0Ly8gVGhpcyBpcyBhbm90aGVyIHZlcnkgd2VpcmQgc3BlY2lhbCBjYXNlIHRoYXQgb25seSBoYXBwZW5zIGZvciByZWxhdGl2ZSBlbGVtZW50czpcclxuXHRcdC8vIDEuIElmIHRoZSBjc3MgcG9zaXRpb24gaXMgcmVsYXRpdmVcclxuXHRcdC8vIDIuIGFuZCB0aGUgc2Nyb2xsIHBhcmVudCBpcyB0aGUgZG9jdW1lbnQgb3Igc2ltaWxhciB0byB0aGUgb2Zmc2V0IHBhcmVudFxyXG5cdFx0Ly8gd2UgaGF2ZSB0byByZWZyZXNoIHRoZSByZWxhdGl2ZSBvZmZzZXQgZHVyaW5nIHRoZSBzY3JvbGwgc28gdGhlcmUgYXJlIG5vIGp1bXBzXHJcblx0XHRpZih0aGlzLmNzc1Bvc2l0aW9uID09PSBcInJlbGF0aXZlXCIgJiYgISh0aGlzLnNjcm9sbFBhcmVudFswXSAhPT0gdGhpcy5kb2N1bWVudFswXSAmJiB0aGlzLnNjcm9sbFBhcmVudFswXSAhPT0gdGhpcy5vZmZzZXRQYXJlbnRbMF0pKSB7XHJcblx0XHRcdHRoaXMub2Zmc2V0LnJlbGF0aXZlID0gdGhpcy5fZ2V0UmVsYXRpdmVPZmZzZXQoKTtcclxuXHRcdH1cclxuXHJcblx0XHQvKlxyXG5cdFx0ICogLSBQb3NpdGlvbiBjb25zdHJhaW5pbmcgLVxyXG5cdFx0ICogQ29uc3RyYWluIHRoZSBwb3NpdGlvbiB0byBhIG1peCBvZiBncmlkLCBjb250YWlubWVudC5cclxuXHRcdCAqL1xyXG5cclxuXHRcdGlmKHRoaXMub3JpZ2luYWxQb3NpdGlvbikgeyAvL0lmIHdlIGFyZSBub3QgZHJhZ2dpbmcgeWV0LCB3ZSB3b24ndCBjaGVjayBmb3Igb3B0aW9uc1xyXG5cclxuXHRcdFx0aWYodGhpcy5jb250YWlubWVudCkge1xyXG5cdFx0XHRcdGlmKGV2ZW50LnBhZ2VYIC0gdGhpcy5vZmZzZXQuY2xpY2subGVmdCA8IHRoaXMuY29udGFpbm1lbnRbMF0pIHtcclxuXHRcdFx0XHRcdHBhZ2VYID0gdGhpcy5jb250YWlubWVudFswXSArIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQ7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKGV2ZW50LnBhZ2VZIC0gdGhpcy5vZmZzZXQuY2xpY2sudG9wIDwgdGhpcy5jb250YWlubWVudFsxXSkge1xyXG5cdFx0XHRcdFx0cGFnZVkgPSB0aGlzLmNvbnRhaW5tZW50WzFdICsgdGhpcy5vZmZzZXQuY2xpY2sudG9wO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZihldmVudC5wYWdlWCAtIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPiB0aGlzLmNvbnRhaW5tZW50WzJdKSB7XHJcblx0XHRcdFx0XHRwYWdlWCA9IHRoaXMuY29udGFpbm1lbnRbMl0gKyB0aGlzLm9mZnNldC5jbGljay5sZWZ0O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZihldmVudC5wYWdlWSAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA+IHRoaXMuY29udGFpbm1lbnRbM10pIHtcclxuXHRcdFx0XHRcdHBhZ2VZID0gdGhpcy5jb250YWlubWVudFszXSArIHRoaXMub2Zmc2V0LmNsaWNrLnRvcDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmKG8uZ3JpZCkge1xyXG5cdFx0XHRcdHRvcCA9IHRoaXMub3JpZ2luYWxQYWdlWSArIE1hdGgucm91bmQoKHBhZ2VZIC0gdGhpcy5vcmlnaW5hbFBhZ2VZKSAvIG8uZ3JpZFsxXSkgKiBvLmdyaWRbMV07XHJcblx0XHRcdFx0cGFnZVkgPSB0aGlzLmNvbnRhaW5tZW50ID8gKCAodG9wIC0gdGhpcy5vZmZzZXQuY2xpY2sudG9wID49IHRoaXMuY29udGFpbm1lbnRbMV0gJiYgdG9wIC0gdGhpcy5vZmZzZXQuY2xpY2sudG9wIDw9IHRoaXMuY29udGFpbm1lbnRbM10pID8gdG9wIDogKCh0b3AgLSB0aGlzLm9mZnNldC5jbGljay50b3AgPj0gdGhpcy5jb250YWlubWVudFsxXSkgPyB0b3AgLSBvLmdyaWRbMV0gOiB0b3AgKyBvLmdyaWRbMV0pKSA6IHRvcDtcclxuXHJcblx0XHRcdFx0bGVmdCA9IHRoaXMub3JpZ2luYWxQYWdlWCArIE1hdGgucm91bmQoKHBhZ2VYIC0gdGhpcy5vcmlnaW5hbFBhZ2VYKSAvIG8uZ3JpZFswXSkgKiBvLmdyaWRbMF07XHJcblx0XHRcdFx0cGFnZVggPSB0aGlzLmNvbnRhaW5tZW50ID8gKCAobGVmdCAtIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPj0gdGhpcy5jb250YWlubWVudFswXSAmJiBsZWZ0IC0gdGhpcy5vZmZzZXQuY2xpY2subGVmdCA8PSB0aGlzLmNvbnRhaW5tZW50WzJdKSA/IGxlZnQgOiAoKGxlZnQgLSB0aGlzLm9mZnNldC5jbGljay5sZWZ0ID49IHRoaXMuY29udGFpbm1lbnRbMF0pID8gbGVmdCAtIG8uZ3JpZFswXSA6IGxlZnQgKyBvLmdyaWRbMF0pKSA6IGxlZnQ7XHJcblx0XHRcdH1cclxuXHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHtcclxuXHRcdFx0dG9wOiAoXHJcblx0XHRcdFx0cGFnZVkgLVx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIGFic29sdXRlIG1vdXNlIHBvc2l0aW9uXHJcblx0XHRcdFx0dGhpcy5vZmZzZXQuY2xpY2sudG9wIC1cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIENsaWNrIG9mZnNldCAocmVsYXRpdmUgdG8gdGhlIGVsZW1lbnQpXHJcblx0XHRcdFx0dGhpcy5vZmZzZXQucmVsYXRpdmUudG9wXHQtXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIE9ubHkgZm9yIHJlbGF0aXZlIHBvc2l0aW9uZWQgbm9kZXM6IFJlbGF0aXZlIG9mZnNldCBmcm9tIGVsZW1lbnQgdG8gb2Zmc2V0IHBhcmVudFxyXG5cdFx0XHRcdHRoaXMub2Zmc2V0LnBhcmVudC50b3AgK1x0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRoZSBvZmZzZXRQYXJlbnQncyBvZmZzZXQgd2l0aG91dCBib3JkZXJzIChvZmZzZXQgKyBib3JkZXIpXHJcblx0XHRcdFx0KCAoIHRoaXMuY3NzUG9zaXRpb24gPT09IFwiZml4ZWRcIiA/IC10aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxUb3AoKSA6ICggc2Nyb2xsSXNSb290Tm9kZSA/IDAgOiBzY3JvbGwuc2Nyb2xsVG9wKCkgKSApKVxyXG5cdFx0XHQpLFxyXG5cdFx0XHRsZWZ0OiAoXHJcblx0XHRcdFx0cGFnZVggLVx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIGFic29sdXRlIG1vdXNlIHBvc2l0aW9uXHJcblx0XHRcdFx0dGhpcy5vZmZzZXQuY2xpY2subGVmdCAtXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gQ2xpY2sgb2Zmc2V0IChyZWxhdGl2ZSB0byB0aGUgZWxlbWVudClcclxuXHRcdFx0XHR0aGlzLm9mZnNldC5yZWxhdGl2ZS5sZWZ0XHQtXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIE9ubHkgZm9yIHJlbGF0aXZlIHBvc2l0aW9uZWQgbm9kZXM6IFJlbGF0aXZlIG9mZnNldCBmcm9tIGVsZW1lbnQgdG8gb2Zmc2V0IHBhcmVudFxyXG5cdFx0XHRcdHRoaXMub2Zmc2V0LnBhcmVudC5sZWZ0ICtcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBUaGUgb2Zmc2V0UGFyZW50J3Mgb2Zmc2V0IHdpdGhvdXQgYm9yZGVycyAob2Zmc2V0ICsgYm9yZGVyKVxyXG5cdFx0XHRcdCggKCB0aGlzLmNzc1Bvc2l0aW9uID09PSBcImZpeGVkXCIgPyAtdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCgpIDogc2Nyb2xsSXNSb290Tm9kZSA/IDAgOiBzY3JvbGwuc2Nyb2xsTGVmdCgpICkpXHJcblx0XHRcdClcclxuXHRcdH07XHJcblxyXG5cdH0sXHJcblxyXG5cdF9yZWFycmFuZ2U6IGZ1bmN0aW9uKGV2ZW50LCBpLCBhLCBoYXJkUmVmcmVzaCkge1xyXG5cclxuXHRcdGEgPyBhWzBdLmFwcGVuZENoaWxkKHRoaXMucGxhY2Vob2xkZXJbMF0pIDogaS5pdGVtWzBdLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHRoaXMucGxhY2Vob2xkZXJbMF0sICh0aGlzLmRpcmVjdGlvbiA9PT0gXCJkb3duXCIgPyBpLml0ZW1bMF0gOiBpLml0ZW1bMF0ubmV4dFNpYmxpbmcpKTtcclxuXHJcblx0XHQvL1ZhcmlvdXMgdGhpbmdzIGRvbmUgaGVyZSB0byBpbXByb3ZlIHRoZSBwZXJmb3JtYW5jZTpcclxuXHRcdC8vIDEuIHdlIGNyZWF0ZSBhIHNldFRpbWVvdXQsIHRoYXQgY2FsbHMgcmVmcmVzaFBvc2l0aW9uc1xyXG5cdFx0Ly8gMi4gb24gdGhlIGluc3RhbmNlLCB3ZSBoYXZlIGEgY291bnRlciB2YXJpYWJsZSwgdGhhdCBnZXQncyBoaWdoZXIgYWZ0ZXIgZXZlcnkgYXBwZW5kXHJcblx0XHQvLyAzLiBvbiB0aGUgbG9jYWwgc2NvcGUsIHdlIGNvcHkgdGhlIGNvdW50ZXIgdmFyaWFibGUsIGFuZCBjaGVjayBpbiB0aGUgdGltZW91dCwgaWYgaXQncyBzdGlsbCB0aGUgc2FtZVxyXG5cdFx0Ly8gNC4gdGhpcyBsZXRzIG9ubHkgdGhlIGxhc3QgYWRkaXRpb24gdG8gdGhlIHRpbWVvdXQgc3RhY2sgdGhyb3VnaFxyXG5cdFx0dGhpcy5jb3VudGVyID0gdGhpcy5jb3VudGVyID8gKyt0aGlzLmNvdW50ZXIgOiAxO1xyXG5cdFx0dmFyIGNvdW50ZXIgPSB0aGlzLmNvdW50ZXI7XHJcblxyXG5cdFx0dGhpcy5fZGVsYXkoZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmKGNvdW50ZXIgPT09IHRoaXMuY291bnRlcikge1xyXG5cdFx0XHRcdHRoaXMucmVmcmVzaFBvc2l0aW9ucyghaGFyZFJlZnJlc2gpOyAvL1ByZWNvbXB1dGUgYWZ0ZXIgZWFjaCBET00gaW5zZXJ0aW9uLCBOT1Qgb24gbW91c2Vtb3ZlXHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cclxuXHR9LFxyXG5cclxuXHRfY2xlYXI6IGZ1bmN0aW9uKGV2ZW50LCBub1Byb3BhZ2F0aW9uKSB7XHJcblxyXG5cdFx0dGhpcy5yZXZlcnRpbmcgPSBmYWxzZTtcclxuXHRcdC8vIFdlIGRlbGF5IGFsbCBldmVudHMgdGhhdCBoYXZlIHRvIGJlIHRyaWdnZXJlZCB0byBhZnRlciB0aGUgcG9pbnQgd2hlcmUgdGhlIHBsYWNlaG9sZGVyIGhhcyBiZWVuIHJlbW92ZWQgYW5kXHJcblx0XHQvLyBldmVyeXRoaW5nIGVsc2Ugbm9ybWFsaXplZCBhZ2FpblxyXG5cdFx0dmFyIGksXHJcblx0XHRcdGRlbGF5ZWRUcmlnZ2VycyA9IFtdO1xyXG5cclxuXHRcdC8vIFdlIGZpcnN0IGhhdmUgdG8gdXBkYXRlIHRoZSBkb20gcG9zaXRpb24gb2YgdGhlIGFjdHVhbCBjdXJyZW50SXRlbVxyXG5cdFx0Ly8gTm90ZTogZG9uJ3QgZG8gaXQgaWYgdGhlIGN1cnJlbnQgaXRlbSBpcyBhbHJlYWR5IHJlbW92ZWQgKGJ5IGEgdXNlciksIG9yIGl0IGdldHMgcmVhcHBlbmRlZCAoc2VlICM0MDg4KVxyXG5cdFx0aWYoIXRoaXMuX25vRmluYWxTb3J0ICYmIHRoaXMuY3VycmVudEl0ZW0ucGFyZW50KCkubGVuZ3RoKSB7XHJcblx0XHRcdHRoaXMucGxhY2Vob2xkZXIuYmVmb3JlKHRoaXMuY3VycmVudEl0ZW0pO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy5fbm9GaW5hbFNvcnQgPSBudWxsO1xyXG5cclxuXHRcdGlmKHRoaXMuaGVscGVyWzBdID09PSB0aGlzLmN1cnJlbnRJdGVtWzBdKSB7XHJcblx0XHRcdGZvcihpIGluIHRoaXMuX3N0b3JlZENTUykge1xyXG5cdFx0XHRcdGlmKHRoaXMuX3N0b3JlZENTU1tpXSA9PT0gXCJhdXRvXCIgfHwgdGhpcy5fc3RvcmVkQ1NTW2ldID09PSBcInN0YXRpY1wiKSB7XHJcblx0XHRcdFx0XHR0aGlzLl9zdG9yZWRDU1NbaV0gPSBcIlwiO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHR0aGlzLmN1cnJlbnRJdGVtLmNzcyh0aGlzLl9zdG9yZWRDU1MpLnJlbW92ZUNsYXNzKFwidWktc29ydGFibGUtaGVscGVyXCIpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhpcy5jdXJyZW50SXRlbS5zaG93KCk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYodGhpcy5mcm9tT3V0c2lkZSAmJiAhbm9Qcm9wYWdhdGlvbikge1xyXG5cdFx0XHRkZWxheWVkVHJpZ2dlcnMucHVzaChmdW5jdGlvbihldmVudCkgeyB0aGlzLl90cmlnZ2VyKFwicmVjZWl2ZVwiLCBldmVudCwgdGhpcy5fdWlIYXNoKHRoaXMuZnJvbU91dHNpZGUpKTsgfSk7XHJcblx0XHR9XHJcblx0XHRpZigodGhpcy5mcm9tT3V0c2lkZSB8fCB0aGlzLmRvbVBvc2l0aW9uLnByZXYgIT09IHRoaXMuY3VycmVudEl0ZW0ucHJldigpLm5vdChcIi51aS1zb3J0YWJsZS1oZWxwZXJcIilbMF0gfHwgdGhpcy5kb21Qb3NpdGlvbi5wYXJlbnQgIT09IHRoaXMuY3VycmVudEl0ZW0ucGFyZW50KClbMF0pICYmICFub1Byb3BhZ2F0aW9uKSB7XHJcblx0XHRcdGRlbGF5ZWRUcmlnZ2Vycy5wdXNoKGZ1bmN0aW9uKGV2ZW50KSB7IHRoaXMuX3RyaWdnZXIoXCJ1cGRhdGVcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCgpKTsgfSk7IC8vVHJpZ2dlciB1cGRhdGUgY2FsbGJhY2sgaWYgdGhlIERPTSBwb3NpdGlvbiBoYXMgY2hhbmdlZFxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIENoZWNrIGlmIHRoZSBpdGVtcyBDb250YWluZXIgaGFzIENoYW5nZWQgYW5kIHRyaWdnZXIgYXBwcm9wcmlhdGVcclxuXHRcdC8vIGV2ZW50cy5cclxuXHRcdGlmICh0aGlzICE9PSB0aGlzLmN1cnJlbnRDb250YWluZXIpIHtcclxuXHRcdFx0aWYoIW5vUHJvcGFnYXRpb24pIHtcclxuXHRcdFx0XHRkZWxheWVkVHJpZ2dlcnMucHVzaChmdW5jdGlvbihldmVudCkgeyB0aGlzLl90cmlnZ2VyKFwicmVtb3ZlXCIsIGV2ZW50LCB0aGlzLl91aUhhc2goKSk7IH0pO1xyXG5cdFx0XHRcdGRlbGF5ZWRUcmlnZ2Vycy5wdXNoKChmdW5jdGlvbihjKSB7IHJldHVybiBmdW5jdGlvbihldmVudCkgeyBjLl90cmlnZ2VyKFwicmVjZWl2ZVwiLCBldmVudCwgdGhpcy5fdWlIYXNoKHRoaXMpKTsgfTsgIH0pLmNhbGwodGhpcywgdGhpcy5jdXJyZW50Q29udGFpbmVyKSk7XHJcblx0XHRcdFx0ZGVsYXllZFRyaWdnZXJzLnB1c2goKGZ1bmN0aW9uKGMpIHsgcmV0dXJuIGZ1bmN0aW9uKGV2ZW50KSB7IGMuX3RyaWdnZXIoXCJ1cGRhdGVcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCh0aGlzKSk7ICB9OyB9KS5jYWxsKHRoaXMsIHRoaXMuY3VycmVudENvbnRhaW5lcikpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cclxuXHRcdC8vUG9zdCBldmVudHMgdG8gY29udGFpbmVyc1xyXG5cdFx0ZnVuY3Rpb24gZGVsYXlFdmVudCggdHlwZSwgaW5zdGFuY2UsIGNvbnRhaW5lciApIHtcclxuXHRcdFx0cmV0dXJuIGZ1bmN0aW9uKCBldmVudCApIHtcclxuXHRcdFx0XHRjb250YWluZXIuX3RyaWdnZXIoIHR5cGUsIGV2ZW50LCBpbnN0YW5jZS5fdWlIYXNoKCBpbnN0YW5jZSApICk7XHJcblx0XHRcdH07XHJcblx0XHR9XHJcblx0XHRmb3IgKGkgPSB0aGlzLmNvbnRhaW5lcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pe1xyXG5cdFx0XHRpZiAoIW5vUHJvcGFnYXRpb24pIHtcclxuXHRcdFx0XHRkZWxheWVkVHJpZ2dlcnMucHVzaCggZGVsYXlFdmVudCggXCJkZWFjdGl2YXRlXCIsIHRoaXMsIHRoaXMuY29udGFpbmVyc1sgaSBdICkgKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZih0aGlzLmNvbnRhaW5lcnNbaV0uY29udGFpbmVyQ2FjaGUub3Zlcikge1xyXG5cdFx0XHRcdGRlbGF5ZWRUcmlnZ2Vycy5wdXNoKCBkZWxheUV2ZW50KCBcIm91dFwiLCB0aGlzLCB0aGlzLmNvbnRhaW5lcnNbIGkgXSApICk7XHJcblx0XHRcdFx0dGhpcy5jb250YWluZXJzW2ldLmNvbnRhaW5lckNhY2hlLm92ZXIgPSAwO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly9EbyB3aGF0IHdhcyBvcmlnaW5hbGx5IGluIHBsdWdpbnNcclxuXHRcdGlmICggdGhpcy5zdG9yZWRDdXJzb3IgKSB7XHJcblx0XHRcdHRoaXMuZG9jdW1lbnQuZmluZCggXCJib2R5XCIgKS5jc3MoIFwiY3Vyc29yXCIsIHRoaXMuc3RvcmVkQ3Vyc29yICk7XHJcblx0XHRcdHRoaXMuc3RvcmVkU3R5bGVzaGVldC5yZW1vdmUoKTtcclxuXHRcdH1cclxuXHRcdGlmKHRoaXMuX3N0b3JlZE9wYWNpdHkpIHtcclxuXHRcdFx0dGhpcy5oZWxwZXIuY3NzKFwib3BhY2l0eVwiLCB0aGlzLl9zdG9yZWRPcGFjaXR5KTtcclxuXHRcdH1cclxuXHRcdGlmKHRoaXMuX3N0b3JlZFpJbmRleCkge1xyXG5cdFx0XHR0aGlzLmhlbHBlci5jc3MoXCJ6SW5kZXhcIiwgdGhpcy5fc3RvcmVkWkluZGV4ID09PSBcImF1dG9cIiA/IFwiXCIgOiB0aGlzLl9zdG9yZWRaSW5kZXgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuZHJhZ2dpbmcgPSBmYWxzZTtcclxuXHJcblx0XHRpZighbm9Qcm9wYWdhdGlvbikge1xyXG5cdFx0XHR0aGlzLl90cmlnZ2VyKFwiYmVmb3JlU3RvcFwiLCBldmVudCwgdGhpcy5fdWlIYXNoKCkpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vJCh0aGlzLnBsYWNlaG9sZGVyWzBdKS5yZW1vdmUoKTsgd291bGQgaGF2ZSBiZWVuIHRoZSBqUXVlcnkgd2F5IC0gdW5mb3J0dW5hdGVseSwgaXQgdW5iaW5kcyBBTEwgZXZlbnRzIGZyb20gdGhlIG9yaWdpbmFsIG5vZGUhXHJcblx0XHR0aGlzLnBsYWNlaG9sZGVyWzBdLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5wbGFjZWhvbGRlclswXSk7XHJcblxyXG5cdFx0aWYgKCAhdGhpcy5jYW5jZWxIZWxwZXJSZW1vdmFsICkge1xyXG5cdFx0XHRpZiAoIHRoaXMuaGVscGVyWyAwIF0gIT09IHRoaXMuY3VycmVudEl0ZW1bIDAgXSApIHtcclxuXHRcdFx0XHR0aGlzLmhlbHBlci5yZW1vdmUoKTtcclxuXHRcdFx0fVxyXG5cdFx0XHR0aGlzLmhlbHBlciA9IG51bGw7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYoIW5vUHJvcGFnYXRpb24pIHtcclxuXHRcdFx0Zm9yIChpPTA7IGkgPCBkZWxheWVkVHJpZ2dlcnMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHRkZWxheWVkVHJpZ2dlcnNbaV0uY2FsbCh0aGlzLCBldmVudCk7XHJcblx0XHRcdH0gLy9UcmlnZ2VyIGFsbCBkZWxheWVkIGV2ZW50c1xyXG5cdFx0XHR0aGlzLl90cmlnZ2VyKFwic3RvcFwiLCBldmVudCwgdGhpcy5fdWlIYXNoKCkpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuZnJvbU91dHNpZGUgPSBmYWxzZTtcclxuXHRcdHJldHVybiAhdGhpcy5jYW5jZWxIZWxwZXJSZW1vdmFsO1xyXG5cclxuXHR9LFxyXG5cclxuXHRfdHJpZ2dlcjogZnVuY3Rpb24oKSB7XHJcblx0XHRpZiAoJC5XaWRnZXQucHJvdG90eXBlLl90cmlnZ2VyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgPT09IGZhbHNlKSB7XHJcblx0XHRcdHRoaXMuY2FuY2VsKCk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0X3VpSGFzaDogZnVuY3Rpb24oX2luc3QpIHtcclxuXHRcdHZhciBpbnN0ID0gX2luc3QgfHwgdGhpcztcclxuXHRcdHJldHVybiB7XHJcblx0XHRcdGhlbHBlcjogaW5zdC5oZWxwZXIsXHJcblx0XHRcdHBsYWNlaG9sZGVyOiBpbnN0LnBsYWNlaG9sZGVyIHx8ICQoW10pLFxyXG5cdFx0XHRwb3NpdGlvbjogaW5zdC5wb3NpdGlvbixcclxuXHRcdFx0b3JpZ2luYWxQb3NpdGlvbjogaW5zdC5vcmlnaW5hbFBvc2l0aW9uLFxyXG5cdFx0XHRvZmZzZXQ6IGluc3QucG9zaXRpb25BYnMsXHJcblx0XHRcdGl0ZW06IGluc3QuY3VycmVudEl0ZW0sXHJcblx0XHRcdHNlbmRlcjogX2luc3QgPyBfaW5zdC5lbGVtZW50IDogbnVsbFxyXG5cdFx0fTtcclxuXHR9XHJcblxyXG59KTtcclxuXHJcblxyXG5cclxufSkpOyIsIi8qIGNhbnZhcy10b0Jsb2IuanNcclxuICogQSBjYW52YXMudG9CbG9iKCkgaW1wbGVtZW50YXRpb24uXHJcbiAqIDIwMTMtMTItMjdcclxuICogXHJcbiAqIEJ5IEVsaSBHcmV5LCBodHRwOi8vZWxpZ3JleS5jb20gYW5kIERldmluIFNhbWFyaW4sIGh0dHBzOi8vZ2l0aHViLmNvbS9lYm95anJcclxuICogTGljZW5zZTogWDExL01JVFxyXG4gKiAgIFNlZSBodHRwczovL2dpdGh1Yi5jb20vZWxpZ3JleS9jYW52YXMtdG9CbG9iLmpzL2Jsb2IvbWFzdGVyL0xJQ0VOU0UubWRcclxuICovXHJcblxyXG4vKmdsb2JhbCBzZWxmICovXHJcbi8qanNsaW50IGJpdHdpc2U6IHRydWUsIHJlZ2V4cDogdHJ1ZSwgY29uZnVzaW9uOiB0cnVlLCBlczU6IHRydWUsIHZhcnM6IHRydWUsIHdoaXRlOiB0cnVlLFxyXG4gIHBsdXNwbHVzOiB0cnVlICovXHJcblxyXG4vKiEgQHNvdXJjZSBodHRwOi8vcHVybC5lbGlncmV5LmNvbS9naXRodWIvY2FudmFzLXRvQmxvYi5qcy9ibG9iL21hc3Rlci9jYW52YXMtdG9CbG9iLmpzICovXHJcblxyXG4oZnVuY3Rpb24odmlldykge1xyXG5cInVzZSBzdHJpY3RcIjtcclxudmFyXHJcblx0ICBVaW50OEFycmF5ID0gdmlldy5VaW50OEFycmF5XHJcblx0LCBIVE1MQ2FudmFzRWxlbWVudCA9IHZpZXcuSFRNTENhbnZhc0VsZW1lbnRcclxuXHQsIGNhbnZhc19wcm90byA9IEhUTUxDYW52YXNFbGVtZW50ICYmIEhUTUxDYW52YXNFbGVtZW50LnByb3RvdHlwZVxyXG5cdCwgaXNfYmFzZTY0X3JlZ2V4ID0gL1xccyo7XFxzKmJhc2U2NFxccyooPzo7fCQpL2lcclxuXHQsIHRvX2RhdGFfdXJsID0gXCJ0b0RhdGFVUkxcIlxyXG5cdCwgYmFzZTY0X3JhbmtzXHJcblx0LCBkZWNvZGVfYmFzZTY0ID0gZnVuY3Rpb24oYmFzZTY0KSB7XHJcblx0XHR2YXJcclxuXHRcdFx0ICBsZW4gPSBiYXNlNjQubGVuZ3RoXHJcblx0XHRcdCwgYnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkobGVuIC8gNCAqIDMgfCAwKVxyXG5cdFx0XHQsIGkgPSAwXHJcblx0XHRcdCwgb3V0cHRyID0gMFxyXG5cdFx0XHQsIGxhc3QgPSBbMCwgMF1cclxuXHRcdFx0LCBzdGF0ZSA9IDBcclxuXHRcdFx0LCBzYXZlID0gMFxyXG5cdFx0XHQsIHJhbmtcclxuXHRcdFx0LCBjb2RlXHJcblx0XHRcdCwgdW5kZWZcclxuXHRcdDtcclxuXHRcdHdoaWxlIChsZW4tLSkge1xyXG5cdFx0XHRjb2RlID0gYmFzZTY0LmNoYXJDb2RlQXQoaSsrKTtcclxuXHRcdFx0cmFuayA9IGJhc2U2NF9yYW5rc1tjb2RlLTQzXTtcclxuXHRcdFx0aWYgKHJhbmsgIT09IDI1NSAmJiByYW5rICE9PSB1bmRlZikge1xyXG5cdFx0XHRcdGxhc3RbMV0gPSBsYXN0WzBdO1xyXG5cdFx0XHRcdGxhc3RbMF0gPSBjb2RlO1xyXG5cdFx0XHRcdHNhdmUgPSAoc2F2ZSA8PCA2KSB8IHJhbms7XHJcblx0XHRcdFx0c3RhdGUrKztcclxuXHRcdFx0XHRpZiAoc3RhdGUgPT09IDQpIHtcclxuXHRcdFx0XHRcdGJ1ZmZlcltvdXRwdHIrK10gPSBzYXZlID4+PiAxNjtcclxuXHRcdFx0XHRcdGlmIChsYXN0WzFdICE9PSA2MSAvKiBwYWRkaW5nIGNoYXJhY3RlciAqLykge1xyXG5cdFx0XHRcdFx0XHRidWZmZXJbb3V0cHRyKytdID0gc2F2ZSA+Pj4gODtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmIChsYXN0WzBdICE9PSA2MSAvKiBwYWRkaW5nIGNoYXJhY3RlciAqLykge1xyXG5cdFx0XHRcdFx0XHRidWZmZXJbb3V0cHRyKytdID0gc2F2ZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHN0YXRlID0gMDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdC8vIDIvMyBjaGFuY2UgdGhlcmUncyBnb2luZyB0byBiZSBzb21lIG51bGwgYnl0ZXMgYXQgdGhlIGVuZCwgYnV0IHRoYXRcclxuXHRcdC8vIGRvZXNuJ3QgcmVhbGx5IG1hdHRlciB3aXRoIG1vc3QgaW1hZ2UgZm9ybWF0cy5cclxuXHRcdC8vIElmIGl0IHNvbWVob3cgbWF0dGVycyBmb3IgeW91LCB0cnVuY2F0ZSB0aGUgYnVmZmVyIHVwIG91dHB0ci5cclxuXHRcdHJldHVybiBidWZmZXI7XHJcblx0fVxyXG47XHJcbmlmIChVaW50OEFycmF5KSB7XHJcblx0YmFzZTY0X3JhbmtzID0gbmV3IFVpbnQ4QXJyYXkoW1xyXG5cdFx0ICA2MiwgLTEsIC0xLCAtMSwgNjMsIDUyLCA1MywgNTQsIDU1LCA1NiwgNTcsIDU4LCA1OSwgNjAsIDYxLCAtMVxyXG5cdFx0LCAtMSwgLTEsICAwLCAtMSwgLTEsIC0xLCAgMCwgIDEsICAyLCAgMywgIDQsICA1LCAgNiwgIDcsICA4LCAgOVxyXG5cdFx0LCAxMCwgMTEsIDEyLCAxMywgMTQsIDE1LCAxNiwgMTcsIDE4LCAxOSwgMjAsIDIxLCAyMiwgMjMsIDI0LCAyNVxyXG5cdFx0LCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAyNiwgMjcsIDI4LCAyOSwgMzAsIDMxLCAzMiwgMzMsIDM0LCAzNVxyXG5cdFx0LCAzNiwgMzcsIDM4LCAzOSwgNDAsIDQxLCA0MiwgNDMsIDQ0LCA0NSwgNDYsIDQ3LCA0OCwgNDksIDUwLCA1MVxyXG5cdF0pO1xyXG59XHJcbmlmIChIVE1MQ2FudmFzRWxlbWVudCAmJiAhY2FudmFzX3Byb3RvLnRvQmxvYikge1xyXG5cdGNhbnZhc19wcm90by50b0Jsb2IgPSBmdW5jdGlvbihjYWxsYmFjaywgdHlwZSAvKiwgLi4uYXJncyovKSB7XHJcblx0XHQgIGlmICghdHlwZSkge1xyXG5cdFx0XHR0eXBlID0gXCJpbWFnZS9wbmdcIjtcclxuXHRcdH0gaWYgKHRoaXMubW96R2V0QXNGaWxlKSB7XHJcblx0XHRcdGNhbGxiYWNrKHRoaXMubW96R2V0QXNGaWxlKFwiY2FudmFzXCIsIHR5cGUpKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fSBpZiAodGhpcy5tc1RvQmxvYiAmJiAvXlxccyppbWFnZVxcL3BuZ1xccyooPzokfDspL2kudGVzdCh0eXBlKSkge1xyXG5cdFx0XHRjYWxsYmFjayh0aGlzLm1zVG9CbG9iKCkpO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0dmFyXHJcblx0XHRcdCAgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSlcclxuXHRcdFx0LCBkYXRhVVJJID0gdGhpc1t0b19kYXRhX3VybF0uYXBwbHkodGhpcywgYXJncylcclxuXHRcdFx0LCBoZWFkZXJfZW5kID0gZGF0YVVSSS5pbmRleE9mKFwiLFwiKVxyXG5cdFx0XHQsIGRhdGEgPSBkYXRhVVJJLnN1YnN0cmluZyhoZWFkZXJfZW5kICsgMSlcclxuXHRcdFx0LCBpc19iYXNlNjQgPSBpc19iYXNlNjRfcmVnZXgudGVzdChkYXRhVVJJLnN1YnN0cmluZygwLCBoZWFkZXJfZW5kKSlcclxuXHRcdFx0LCBibG9iXHJcblx0XHQ7XHJcblx0XHRpZiAoQmxvYi5mYWtlKSB7XHJcblx0XHRcdC8vIG5vIHJlYXNvbiB0byBkZWNvZGUgYSBkYXRhOiBVUkkgdGhhdCdzIGp1c3QgZ29pbmcgdG8gYmVjb21lIGEgZGF0YSBVUkkgYWdhaW5cclxuXHRcdFx0YmxvYiA9IG5ldyBCbG9iXHJcblx0XHRcdGlmIChpc19iYXNlNjQpIHtcclxuXHRcdFx0XHRibG9iLmVuY29kaW5nID0gXCJiYXNlNjRcIjtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRibG9iLmVuY29kaW5nID0gXCJVUklcIjtcclxuXHRcdFx0fVxyXG5cdFx0XHRibG9iLmRhdGEgPSBkYXRhO1xyXG5cdFx0XHRibG9iLnNpemUgPSBkYXRhLmxlbmd0aDtcclxuXHRcdH0gZWxzZSBpZiAoVWludDhBcnJheSkge1xyXG5cdFx0XHRpZiAoaXNfYmFzZTY0KSB7XHJcblx0XHRcdFx0YmxvYiA9IG5ldyBCbG9iKFtkZWNvZGVfYmFzZTY0KGRhdGEpXSwge3R5cGU6IHR5cGV9KTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRibG9iID0gbmV3IEJsb2IoW2RlY29kZVVSSUNvbXBvbmVudChkYXRhKV0sIHt0eXBlOiB0eXBlfSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGNhbGxiYWNrKGJsb2IpO1xyXG5cdH07XHJcblxyXG5cdGlmIChjYW52YXNfcHJvdG8udG9EYXRhVVJMSEQpIHtcclxuXHRcdGNhbnZhc19wcm90by50b0Jsb2JIRCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR0b19kYXRhX3VybCA9IFwidG9EYXRhVVJMSERcIjtcclxuXHRcdFx0dmFyIGJsb2IgPSB0aGlzLnRvQmxvYigpO1xyXG5cdFx0XHR0b19kYXRhX3VybCA9IFwidG9EYXRhVVJMXCI7XHJcblx0XHRcdHJldHVybiBibG9iO1xyXG5cdFx0fVxyXG5cdH0gZWxzZSB7XHJcblx0XHRjYW52YXNfcHJvdG8udG9CbG9iSEQgPSBjYW52YXNfcHJvdG8udG9CbG9iO1xyXG5cdH1cclxufVxyXG59KHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiICYmIHNlbGYgfHwgdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiAmJiB3aW5kb3cgfHwgdGhpcy5jb250ZW50IHx8IHRoaXMpKTtcclxuXHJcbi8qIEZpbGVTYXZlci5qc1xyXG4gKiBBIHNhdmVBcygpIEZpbGVTYXZlciBpbXBsZW1lbnRhdGlvbi5cclxuICogMjAxNS0wMy0wNFxyXG4gKlxyXG4gKiBCeSBFbGkgR3JleSwgaHR0cDovL2VsaWdyZXkuY29tXHJcbiAqIExpY2Vuc2U6IFgxMS9NSVRcclxuICogICBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2VsaWdyZXkvRmlsZVNhdmVyLmpzL2Jsb2IvbWFzdGVyL0xJQ0VOU0UubWRcclxuICovXHJcblxyXG4vKmdsb2JhbCBzZWxmICovXHJcbi8qanNsaW50IGJpdHdpc2U6IHRydWUsIGluZGVudDogNCwgbGF4YnJlYWs6IHRydWUsIGxheGNvbW1hOiB0cnVlLCBzbWFydHRhYnM6IHRydWUsIHBsdXNwbHVzOiB0cnVlICovXHJcblxyXG4vKiEgQHNvdXJjZSBodHRwOi8vcHVybC5lbGlncmV5LmNvbS9naXRodWIvRmlsZVNhdmVyLmpzL2Jsb2IvbWFzdGVyL0ZpbGVTYXZlci5qcyAqL1xyXG5cclxudmFyIHNhdmVBcyA9IHNhdmVBc1xyXG4gIC8vIElFIDEwKyAobmF0aXZlIHNhdmVBcylcclxuICB8fCAodHlwZW9mIG5hdmlnYXRvciAhPT0gXCJ1bmRlZmluZWRcIiAmJlxyXG4gICAgICBuYXZpZ2F0b3IubXNTYXZlT3JPcGVuQmxvYiAmJiBuYXZpZ2F0b3IubXNTYXZlT3JPcGVuQmxvYi5iaW5kKG5hdmlnYXRvcikpXHJcbiAgLy8gRXZlcnlvbmUgZWxzZVxyXG4gIHx8IChmdW5jdGlvbih2aWV3KSB7XHJcblx0XCJ1c2Ugc3RyaWN0XCI7XHJcblx0Ly8gSUUgPDEwIGlzIGV4cGxpY2l0bHkgdW5zdXBwb3J0ZWRcclxuXHRpZiAodHlwZW9mIG5hdmlnYXRvciAhPT0gXCJ1bmRlZmluZWRcIiAmJlxyXG5cdCAgICAvTVNJRSBbMS05XVxcLi8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkge1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHR2YXJcclxuXHRcdCAgZG9jID0gdmlldy5kb2N1bWVudFxyXG5cdFx0ICAvLyBvbmx5IGdldCBVUkwgd2hlbiBuZWNlc3NhcnkgaW4gY2FzZSBCbG9iLmpzIGhhc24ndCBvdmVycmlkZGVuIGl0IHlldFxyXG5cdFx0LCBnZXRfVVJMID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdHJldHVybiB2aWV3LlVSTCB8fCB2aWV3LndlYmtpdFVSTCB8fCB2aWV3O1xyXG5cdFx0fVxyXG5cdFx0LCBzYXZlX2xpbmsgPSBkb2MuY3JlYXRlRWxlbWVudE5TKFwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbFwiLCBcImFcIilcclxuXHRcdCwgY2FuX3VzZV9zYXZlX2xpbmsgPSBcImRvd25sb2FkXCIgaW4gc2F2ZV9saW5rXHJcblx0XHQsIGNsaWNrID0gZnVuY3Rpb24obm9kZSkge1xyXG5cdFx0XHR2YXIgZXZlbnQgPSBkb2MuY3JlYXRlRXZlbnQoXCJNb3VzZUV2ZW50c1wiKTtcclxuXHRcdFx0ZXZlbnQuaW5pdE1vdXNlRXZlbnQoXHJcblx0XHRcdFx0XCJjbGlja1wiLCB0cnVlLCBmYWxzZSwgdmlldywgMCwgMCwgMCwgMCwgMFxyXG5cdFx0XHRcdCwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIDAsIG51bGxcclxuXHRcdFx0KTtcclxuXHRcdFx0bm9kZS5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcclxuXHRcdH1cclxuXHRcdCwgd2Via2l0X3JlcV9mcyA9IHZpZXcud2Via2l0UmVxdWVzdEZpbGVTeXN0ZW1cclxuXHRcdCwgcmVxX2ZzID0gdmlldy5yZXF1ZXN0RmlsZVN5c3RlbSB8fCB3ZWJraXRfcmVxX2ZzIHx8IHZpZXcubW96UmVxdWVzdEZpbGVTeXN0ZW1cclxuXHRcdCwgdGhyb3dfb3V0c2lkZSA9IGZ1bmN0aW9uKGV4KSB7XHJcblx0XHRcdCh2aWV3LnNldEltbWVkaWF0ZSB8fCB2aWV3LnNldFRpbWVvdXQpKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHRocm93IGV4O1xyXG5cdFx0XHR9LCAwKTtcclxuXHRcdH1cclxuXHRcdCwgZm9yY2Vfc2F2ZWFibGVfdHlwZSA9IFwiYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtXCJcclxuXHRcdCwgZnNfbWluX3NpemUgPSAwXHJcblx0XHQvLyBTZWUgaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTM3NTI5NyNjNyBhbmRcclxuXHRcdC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9lbGlncmV5L0ZpbGVTYXZlci5qcy9jb21taXQvNDg1OTMwYSNjb21taXRjb21tZW50LTg3NjgwNDdcclxuXHRcdC8vIGZvciB0aGUgcmVhc29uaW5nIGJlaGluZCB0aGUgdGltZW91dCBhbmQgcmV2b2NhdGlvbiBmbG93XHJcblx0XHQsIGFyYml0cmFyeV9yZXZva2VfdGltZW91dCA9IDUwMCAvLyBpbiBtc1xyXG5cdFx0LCByZXZva2UgPSBmdW5jdGlvbihmaWxlKSB7XHJcblx0XHRcdHZhciByZXZva2VyID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0aWYgKHR5cGVvZiBmaWxlID09PSBcInN0cmluZ1wiKSB7IC8vIGZpbGUgaXMgYW4gb2JqZWN0IFVSTFxyXG5cdFx0XHRcdFx0Z2V0X1VSTCgpLnJldm9rZU9iamVjdFVSTChmaWxlKTtcclxuXHRcdFx0XHR9IGVsc2UgeyAvLyBmaWxlIGlzIGEgRmlsZVxyXG5cdFx0XHRcdFx0ZmlsZS5yZW1vdmUoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH07XHJcblx0XHRcdGlmICh2aWV3LmNocm9tZSkge1xyXG5cdFx0XHRcdHJldm9rZXIoKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRzZXRUaW1lb3V0KHJldm9rZXIsIGFyYml0cmFyeV9yZXZva2VfdGltZW91dCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdCwgZGlzcGF0Y2ggPSBmdW5jdGlvbihmaWxlc2F2ZXIsIGV2ZW50X3R5cGVzLCBldmVudCkge1xyXG5cdFx0XHRldmVudF90eXBlcyA9IFtdLmNvbmNhdChldmVudF90eXBlcyk7XHJcblx0XHRcdHZhciBpID0gZXZlbnRfdHlwZXMubGVuZ3RoO1xyXG5cdFx0XHR3aGlsZSAoaS0tKSB7XHJcblx0XHRcdFx0dmFyIGxpc3RlbmVyID0gZmlsZXNhdmVyW1wib25cIiArIGV2ZW50X3R5cGVzW2ldXTtcclxuXHRcdFx0XHRpZiAodHlwZW9mIGxpc3RlbmVyID09PSBcImZ1bmN0aW9uXCIpIHtcclxuXHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdGxpc3RlbmVyLmNhbGwoZmlsZXNhdmVyLCBldmVudCB8fCBmaWxlc2F2ZXIpO1xyXG5cdFx0XHRcdFx0fSBjYXRjaCAoZXgpIHtcclxuXHRcdFx0XHRcdFx0dGhyb3dfb3V0c2lkZShleCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHQsIEZpbGVTYXZlciA9IGZ1bmN0aW9uKGJsb2IsIG5hbWUpIHtcclxuXHRcdFx0Ly8gRmlyc3QgdHJ5IGEuZG93bmxvYWQsIHRoZW4gd2ViIGZpbGVzeXN0ZW0sIHRoZW4gb2JqZWN0IFVSTHNcclxuXHRcdFx0dmFyXHJcblx0XHRcdFx0ICBmaWxlc2F2ZXIgPSB0aGlzXHJcblx0XHRcdFx0LCB0eXBlID0gYmxvYi50eXBlXHJcblx0XHRcdFx0LCBibG9iX2NoYW5nZWQgPSBmYWxzZVxyXG5cdFx0XHRcdCwgb2JqZWN0X3VybFxyXG5cdFx0XHRcdCwgdGFyZ2V0X3ZpZXdcclxuXHRcdFx0XHQsIGRpc3BhdGNoX2FsbCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0ZGlzcGF0Y2goZmlsZXNhdmVyLCBcIndyaXRlc3RhcnQgcHJvZ3Jlc3Mgd3JpdGUgd3JpdGVlbmRcIi5zcGxpdChcIiBcIikpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQvLyBvbiBhbnkgZmlsZXN5cyBlcnJvcnMgcmV2ZXJ0IHRvIHNhdmluZyB3aXRoIG9iamVjdCBVUkxzXHJcblx0XHRcdFx0LCBmc19lcnJvciA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gZG9uJ3QgY3JlYXRlIG1vcmUgb2JqZWN0IFVSTHMgdGhhbiBuZWVkZWRcclxuXHRcdFx0XHRcdGlmIChibG9iX2NoYW5nZWQgfHwgIW9iamVjdF91cmwpIHtcclxuXHRcdFx0XHRcdFx0b2JqZWN0X3VybCA9IGdldF9VUkwoKS5jcmVhdGVPYmplY3RVUkwoYmxvYik7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZiAodGFyZ2V0X3ZpZXcpIHtcclxuXHRcdFx0XHRcdFx0dGFyZ2V0X3ZpZXcubG9jYXRpb24uaHJlZiA9IG9iamVjdF91cmw7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHR2YXIgbmV3X3RhYiA9IHZpZXcub3BlbihvYmplY3RfdXJsLCBcIl9ibGFua1wiKTtcclxuXHRcdFx0XHRcdFx0aWYgKG5ld190YWIgPT0gdW5kZWZpbmVkICYmIHR5cGVvZiBzYWZhcmkgIT09IFwidW5kZWZpbmVkXCIpIHtcclxuXHRcdFx0XHRcdFx0XHQvL0FwcGxlIGRvIG5vdCBhbGxvdyB3aW5kb3cub3Blbiwgc2VlIGh0dHA6Ly9iaXQubHkvMWtaZmZSSVxyXG5cdFx0XHRcdFx0XHRcdHZpZXcubG9jYXRpb24uaHJlZiA9IG9iamVjdF91cmxcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0ZmlsZXNhdmVyLnJlYWR5U3RhdGUgPSBmaWxlc2F2ZXIuRE9ORTtcclxuXHRcdFx0XHRcdGRpc3BhdGNoX2FsbCgpO1xyXG5cdFx0XHRcdFx0cmV2b2tlKG9iamVjdF91cmwpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQsIGFib3J0YWJsZSA9IGZ1bmN0aW9uKGZ1bmMpIHtcclxuXHRcdFx0XHRcdHJldHVybiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0aWYgKGZpbGVzYXZlci5yZWFkeVN0YXRlICE9PSBmaWxlc2F2ZXIuRE9ORSkge1xyXG5cdFx0XHRcdFx0XHRcdHJldHVybiBmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH07XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCwgY3JlYXRlX2lmX25vdF9mb3VuZCA9IHtjcmVhdGU6IHRydWUsIGV4Y2x1c2l2ZTogZmFsc2V9XHJcblx0XHRcdFx0LCBzbGljZVxyXG5cdFx0XHQ7XHJcblx0XHRcdGZpbGVzYXZlci5yZWFkeVN0YXRlID0gZmlsZXNhdmVyLklOSVQ7XHJcblx0XHRcdGlmICghbmFtZSkge1xyXG5cdFx0XHRcdG5hbWUgPSBcImRvd25sb2FkXCI7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKGNhbl91c2Vfc2F2ZV9saW5rKSB7XHJcblx0XHRcdFx0b2JqZWN0X3VybCA9IGdldF9VUkwoKS5jcmVhdGVPYmplY3RVUkwoYmxvYik7XHJcblx0XHRcdFx0c2F2ZV9saW5rLmhyZWYgPSBvYmplY3RfdXJsO1xyXG5cdFx0XHRcdHNhdmVfbGluay5kb3dubG9hZCA9IG5hbWU7XHJcblx0XHRcdFx0Y2xpY2soc2F2ZV9saW5rKTtcclxuXHRcdFx0XHRmaWxlc2F2ZXIucmVhZHlTdGF0ZSA9IGZpbGVzYXZlci5ET05FO1xyXG5cdFx0XHRcdGRpc3BhdGNoX2FsbCgpO1xyXG5cdFx0XHRcdHJldm9rZShvYmplY3RfdXJsKTtcclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gcHJlcGVuZCBCT00gZm9yIFVURi04IFhNTCBhbmQgdGV4dC9wbGFpbiB0eXBlc1xyXG5cdFx0XHRpZiAoL15cXHMqKD86dGV4dFxcLyg/OnBsYWlufHhtbCl8YXBwbGljYXRpb25cXC94bWx8XFxTKlxcL1xcUypcXCt4bWwpXFxzKjsuKmNoYXJzZXRcXHMqPVxccyp1dGYtOC9pLnRlc3QoYmxvYi50eXBlKSkge1xyXG5cdFx0XHRcdGJsb2IgPSBuZXcgQmxvYihbXCJcXHVmZWZmXCIsIGJsb2JdLCB7dHlwZTogYmxvYi50eXBlfSk7XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gT2JqZWN0IGFuZCB3ZWIgZmlsZXN5c3RlbSBVUkxzIGhhdmUgYSBwcm9ibGVtIHNhdmluZyBpbiBHb29nbGUgQ2hyb21lIHdoZW5cclxuXHRcdFx0Ly8gdmlld2VkIGluIGEgdGFiLCBzbyBJIGZvcmNlIHNhdmUgd2l0aCBhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW1cclxuXHRcdFx0Ly8gaHR0cDovL2NvZGUuZ29vZ2xlLmNvbS9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9OTExNThcclxuXHRcdFx0Ly8gVXBkYXRlOiBHb29nbGUgZXJyYW50bHkgY2xvc2VkIDkxMTU4LCBJIHN1Ym1pdHRlZCBpdCBhZ2FpbjpcclxuXHRcdFx0Ly8gaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTM4OTY0MlxyXG5cdFx0XHRpZiAodmlldy5jaHJvbWUgJiYgdHlwZSAmJiB0eXBlICE9PSBmb3JjZV9zYXZlYWJsZV90eXBlKSB7XHJcblx0XHRcdFx0c2xpY2UgPSBibG9iLnNsaWNlIHx8IGJsb2Iud2Via2l0U2xpY2U7XHJcblx0XHRcdFx0YmxvYiA9IHNsaWNlLmNhbGwoYmxvYiwgMCwgYmxvYi5zaXplLCBmb3JjZV9zYXZlYWJsZV90eXBlKTtcclxuXHRcdFx0XHRibG9iX2NoYW5nZWQgPSB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vIFNpbmNlIEkgY2FuJ3QgYmUgc3VyZSB0aGF0IHRoZSBndWVzc2VkIG1lZGlhIHR5cGUgd2lsbCB0cmlnZ2VyIGEgZG93bmxvYWRcclxuXHRcdFx0Ly8gaW4gV2ViS2l0LCBJIGFwcGVuZCAuZG93bmxvYWQgdG8gdGhlIGZpbGVuYW1lLlxyXG5cdFx0XHQvLyBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9NjU0NDBcclxuXHRcdFx0aWYgKHdlYmtpdF9yZXFfZnMgJiYgbmFtZSAhPT0gXCJkb3dubG9hZFwiKSB7XHJcblx0XHRcdFx0bmFtZSArPSBcIi5kb3dubG9hZFwiO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmICh0eXBlID09PSBmb3JjZV9zYXZlYWJsZV90eXBlIHx8IHdlYmtpdF9yZXFfZnMpIHtcclxuXHRcdFx0XHR0YXJnZXRfdmlldyA9IHZpZXc7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKCFyZXFfZnMpIHtcclxuXHRcdFx0XHRmc19lcnJvcigpO1xyXG5cdFx0XHRcdHJldHVybjtcclxuXHRcdFx0fVxyXG5cdFx0XHRmc19taW5fc2l6ZSArPSBibG9iLnNpemU7XHJcblx0XHRcdHJlcV9mcyh2aWV3LlRFTVBPUkFSWSwgZnNfbWluX3NpemUsIGFib3J0YWJsZShmdW5jdGlvbihmcykge1xyXG5cdFx0XHRcdGZzLnJvb3QuZ2V0RGlyZWN0b3J5KFwic2F2ZWRcIiwgY3JlYXRlX2lmX25vdF9mb3VuZCwgYWJvcnRhYmxlKGZ1bmN0aW9uKGRpcikge1xyXG5cdFx0XHRcdFx0dmFyIHNhdmUgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0ZGlyLmdldEZpbGUobmFtZSwgY3JlYXRlX2lmX25vdF9mb3VuZCwgYWJvcnRhYmxlKGZ1bmN0aW9uKGZpbGUpIHtcclxuXHRcdFx0XHRcdFx0XHRmaWxlLmNyZWF0ZVdyaXRlcihhYm9ydGFibGUoZnVuY3Rpb24od3JpdGVyKSB7XHJcblx0XHRcdFx0XHRcdFx0XHR3cml0ZXIub253cml0ZWVuZCA9IGZ1bmN0aW9uKGV2ZW50KSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRhcmdldF92aWV3LmxvY2F0aW9uLmhyZWYgPSBmaWxlLnRvVVJMKCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGZpbGVzYXZlci5yZWFkeVN0YXRlID0gZmlsZXNhdmVyLkRPTkU7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGRpc3BhdGNoKGZpbGVzYXZlciwgXCJ3cml0ZWVuZFwiLCBldmVudCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHJldm9rZShmaWxlKTtcclxuXHRcdFx0XHRcdFx0XHRcdH07XHJcblx0XHRcdFx0XHRcdFx0XHR3cml0ZXIub25lcnJvciA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgZXJyb3IgPSB3cml0ZXIuZXJyb3I7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChlcnJvci5jb2RlICE9PSBlcnJvci5BQk9SVF9FUlIpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRmc19lcnJvcigpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHR9O1xyXG5cdFx0XHRcdFx0XHRcdFx0XCJ3cml0ZXN0YXJ0IHByb2dyZXNzIHdyaXRlIGFib3J0XCIuc3BsaXQoXCIgXCIpLmZvckVhY2goZnVuY3Rpb24oZXZlbnQpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0d3JpdGVyW1wib25cIiArIGV2ZW50XSA9IGZpbGVzYXZlcltcIm9uXCIgKyBldmVudF07XHJcblx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHRcdHdyaXRlci53cml0ZShibG9iKTtcclxuXHRcdFx0XHRcdFx0XHRcdGZpbGVzYXZlci5hYm9ydCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR3cml0ZXIuYWJvcnQoKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZmlsZXNhdmVyLnJlYWR5U3RhdGUgPSBmaWxlc2F2ZXIuRE9ORTtcclxuXHRcdFx0XHRcdFx0XHRcdH07XHJcblx0XHRcdFx0XHRcdFx0XHRmaWxlc2F2ZXIucmVhZHlTdGF0ZSA9IGZpbGVzYXZlci5XUklUSU5HO1xyXG5cdFx0XHRcdFx0XHRcdH0pLCBmc19lcnJvcik7XHJcblx0XHRcdFx0XHRcdH0pLCBmc19lcnJvcik7XHJcblx0XHRcdFx0XHR9O1xyXG5cdFx0XHRcdFx0ZGlyLmdldEZpbGUobmFtZSwge2NyZWF0ZTogZmFsc2V9LCBhYm9ydGFibGUoZnVuY3Rpb24oZmlsZSkge1xyXG5cdFx0XHRcdFx0XHQvLyBkZWxldGUgZmlsZSBpZiBpdCBhbHJlYWR5IGV4aXN0c1xyXG5cdFx0XHRcdFx0XHRmaWxlLnJlbW92ZSgpO1xyXG5cdFx0XHRcdFx0XHRzYXZlKCk7XHJcblx0XHRcdFx0XHR9KSwgYWJvcnRhYmxlKGZ1bmN0aW9uKGV4KSB7XHJcblx0XHRcdFx0XHRcdGlmIChleC5jb2RlID09PSBleC5OT1RfRk9VTkRfRVJSKSB7XHJcblx0XHRcdFx0XHRcdFx0c2F2ZSgpO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdGZzX2Vycm9yKCk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pKTtcclxuXHRcdFx0XHR9KSwgZnNfZXJyb3IpO1xyXG5cdFx0XHR9KSwgZnNfZXJyb3IpO1xyXG5cdFx0fVxyXG5cdFx0LCBGU19wcm90byA9IEZpbGVTYXZlci5wcm90b3R5cGVcclxuXHRcdCwgc2F2ZUFzID0gZnVuY3Rpb24oYmxvYiwgbmFtZSkge1xyXG5cdFx0XHRyZXR1cm4gbmV3IEZpbGVTYXZlcihibG9iLCBuYW1lKTtcclxuXHRcdH1cclxuXHQ7XHJcblx0RlNfcHJvdG8uYWJvcnQgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBmaWxlc2F2ZXIgPSB0aGlzO1xyXG5cdFx0ZmlsZXNhdmVyLnJlYWR5U3RhdGUgPSBmaWxlc2F2ZXIuRE9ORTtcclxuXHRcdGRpc3BhdGNoKGZpbGVzYXZlciwgXCJhYm9ydFwiKTtcclxuXHR9O1xyXG5cdEZTX3Byb3RvLnJlYWR5U3RhdGUgPSBGU19wcm90by5JTklUID0gMDtcclxuXHRGU19wcm90by5XUklUSU5HID0gMTtcclxuXHRGU19wcm90by5ET05FID0gMjtcclxuXHJcblx0RlNfcHJvdG8uZXJyb3IgPVxyXG5cdEZTX3Byb3RvLm9ud3JpdGVzdGFydCA9XHJcblx0RlNfcHJvdG8ub25wcm9ncmVzcyA9XHJcblx0RlNfcHJvdG8ub253cml0ZSA9XHJcblx0RlNfcHJvdG8ub25hYm9ydCA9XHJcblx0RlNfcHJvdG8ub25lcnJvciA9XHJcblx0RlNfcHJvdG8ub253cml0ZWVuZCA9XHJcblx0XHRudWxsO1xyXG5cclxuXHRyZXR1cm4gc2F2ZUFzO1xyXG59KFxyXG5cdCAgIHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiICYmIHNlbGZcclxuXHR8fCB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiICYmIHdpbmRvd1xyXG5cdHx8IHRoaXMuY29udGVudFxyXG4pKTtcclxuLy8gYHNlbGZgIGlzIHVuZGVmaW5lZCBpbiBGaXJlZm94IGZvciBBbmRyb2lkIGNvbnRlbnQgc2NyaXB0IGNvbnRleHRcclxuLy8gd2hpbGUgYHRoaXNgIGlzIG5zSUNvbnRlbnRGcmFtZU1lc3NhZ2VNYW5hZ2VyXHJcbi8vIHdpdGggYW4gYXR0cmlidXRlIGBjb250ZW50YCB0aGF0IGNvcnJlc3BvbmRzIHRvIHRoZSB3aW5kb3dcclxuXHJcbmlmICh0eXBlb2YgbW9kdWxlICE9PSBcInVuZGVmaW5lZFwiICYmIG1vZHVsZS5leHBvcnRzKSB7XHJcbiAgbW9kdWxlLmV4cG9ydHMuc2F2ZUFzID0gc2F2ZUFzO1xyXG59IGVsc2UgaWYgKCh0eXBlb2YgZGVmaW5lICE9PSBcInVuZGVmaW5lZFwiICYmIGRlZmluZSAhPT0gbnVsbCkgJiYgKGRlZmluZS5hbWQgIT0gbnVsbCkpIHtcclxuICBkZWZpbmUoW10sIGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIHNhdmVBcztcclxuICB9KTtcclxufVxyXG4iLCIvKipcclxuKiBzaW1wbGVQYWdpbmF0aW9uLmpzIHYxLjZcclxuKiBBIHNpbXBsZSBqUXVlcnkgcGFnaW5hdGlvbiBwbHVnaW4uXHJcbiogaHR0cDovL2ZsYXZpdXNtYXRpcy5naXRodWIuY29tL3NpbXBsZVBhZ2luYXRpb24uanMvXHJcbipcclxuKiBDb3B5cmlnaHQgMjAxMiwgRmxhdml1cyBNYXRpc1xyXG4qIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cclxuKiBodHRwOi8vZmxhdml1c21hdGlzLmdpdGh1Yi5jb20vbGljZW5zZS5odG1sXHJcbiovXHJcblxyXG4oZnVuY3Rpb24oJCl7XHJcblxyXG5cdHZhciBtZXRob2RzID0ge1xyXG5cdFx0aW5pdDogZnVuY3Rpb24ob3B0aW9ucykge1xyXG5cdFx0XHR2YXIgbyA9ICQuZXh0ZW5kKHtcclxuXHRcdFx0XHRpdGVtczogMSxcclxuXHRcdFx0XHRpdGVtc09uUGFnZTogMSxcclxuXHRcdFx0XHRwYWdlczogMCxcclxuXHRcdFx0XHRkaXNwbGF5ZWRQYWdlczogNSxcclxuXHRcdFx0XHRlZGdlczogMixcclxuXHRcdFx0XHRjdXJyZW50UGFnZTogMCxcclxuXHRcdFx0XHRocmVmVGV4dFByZWZpeDogJyNwYWdlLScsXHJcblx0XHRcdFx0aHJlZlRleHRTdWZmaXg6ICcnLFxyXG5cdFx0XHRcdHByZXZUZXh0OiAnUHJldicsXHJcblx0XHRcdFx0bmV4dFRleHQ6ICdOZXh0JyxcclxuXHRcdFx0XHRlbGxpcHNlVGV4dDogJyZoZWxsaXA7JyxcclxuXHRcdFx0XHRjc3NTdHlsZTogJ2xpZ2h0LXRoZW1lJyxcclxuXHRcdFx0XHRsYWJlbE1hcDogW10sXHJcblx0XHRcdFx0c2VsZWN0T25DbGljazogdHJ1ZSxcclxuXHRcdFx0XHRuZXh0QXRGcm9udDogZmFsc2UsXHJcblx0XHRcdFx0aW52ZXJ0UGFnZU9yZGVyOiBmYWxzZSxcclxuXHRcdFx0XHRvblBhZ2VDbGljazogZnVuY3Rpb24ocGFnZU51bWJlciwgZXZlbnQpIHtcclxuXHRcdFx0XHRcdC8vIENhbGxiYWNrIHRyaWdnZXJlZCB3aGVuIGEgcGFnZSBpcyBjbGlja2VkXHJcblx0XHRcdFx0XHQvLyBQYWdlIG51bWJlciBpcyBnaXZlbiBhcyBhbiBvcHRpb25hbCBwYXJhbWV0ZXJcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdG9uSW5pdDogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQvLyBDYWxsYmFjayB0cmlnZ2VyZWQgaW1tZWRpYXRlbHkgYWZ0ZXIgaW5pdGlhbGl6YXRpb25cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sIG9wdGlvbnMgfHwge30pO1xyXG5cclxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuXHRcdFx0by5wYWdlcyA9IG8ucGFnZXMgPyBvLnBhZ2VzIDogTWF0aC5jZWlsKG8uaXRlbXMgLyBvLml0ZW1zT25QYWdlKSA/IE1hdGguY2VpbChvLml0ZW1zIC8gby5pdGVtc09uUGFnZSkgOiAxO1xyXG5cdFx0XHRpZiAoby5jdXJyZW50UGFnZSlcclxuXHRcdFx0XHRvLmN1cnJlbnRQYWdlID0gby5jdXJyZW50UGFnZSAtIDE7XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHRvLmN1cnJlbnRQYWdlID0gIW8uaW52ZXJ0UGFnZU9yZGVyID8gMCA6IG8ucGFnZXMgLSAxO1xyXG5cdFx0XHRvLmhhbGZEaXNwbGF5ZWQgPSBvLmRpc3BsYXllZFBhZ2VzIC8gMjtcclxuXHJcblx0XHRcdHRoaXMuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRzZWxmLmFkZENsYXNzKG8uY3NzU3R5bGUgKyAnIHNpbXBsZS1wYWdpbmF0aW9uJykuZGF0YSgncGFnaW5hdGlvbicsIG8pO1xyXG5cdFx0XHRcdG1ldGhvZHMuX2RyYXcuY2FsbChzZWxmKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRvLm9uSW5pdCgpO1xyXG5cclxuXHRcdFx0cmV0dXJuIHRoaXM7XHJcblx0XHR9LFxyXG5cclxuXHRcdHNlbGVjdFBhZ2U6IGZ1bmN0aW9uKHBhZ2UpIHtcclxuXHRcdFx0bWV0aG9kcy5fc2VsZWN0UGFnZS5jYWxsKHRoaXMsIHBhZ2UgLSAxKTtcclxuXHRcdFx0cmV0dXJuIHRoaXM7XHJcblx0XHR9LFxyXG5cclxuXHRcdHByZXZQYWdlOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0dmFyIG8gPSB0aGlzLmRhdGEoJ3BhZ2luYXRpb24nKTtcclxuXHRcdFx0aWYgKCFvLmludmVydFBhZ2VPcmRlcikge1xyXG5cdFx0XHRcdGlmIChvLmN1cnJlbnRQYWdlID4gMCkge1xyXG5cdFx0XHRcdFx0bWV0aG9kcy5fc2VsZWN0UGFnZS5jYWxsKHRoaXMsIG8uY3VycmVudFBhZ2UgLSAxKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0aWYgKG8uY3VycmVudFBhZ2UgPCBvLnBhZ2VzIC0gMSkge1xyXG5cdFx0XHRcdFx0bWV0aG9kcy5fc2VsZWN0UGFnZS5jYWxsKHRoaXMsIG8uY3VycmVudFBhZ2UgKyAxKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIHRoaXM7XHJcblx0XHR9LFxyXG5cclxuXHRcdG5leHRQYWdlOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0dmFyIG8gPSB0aGlzLmRhdGEoJ3BhZ2luYXRpb24nKTtcclxuXHRcdFx0aWYgKCFvLmludmVydFBhZ2VPcmRlcikge1xyXG5cdFx0XHRcdGlmIChvLmN1cnJlbnRQYWdlIDwgby5wYWdlcyAtIDEpIHtcclxuXHRcdFx0XHRcdG1ldGhvZHMuX3NlbGVjdFBhZ2UuY2FsbCh0aGlzLCBvLmN1cnJlbnRQYWdlICsgMSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGlmIChvLmN1cnJlbnRQYWdlID4gMCkge1xyXG5cdFx0XHRcdFx0bWV0aG9kcy5fc2VsZWN0UGFnZS5jYWxsKHRoaXMsIG8uY3VycmVudFBhZ2UgLSAxKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIHRoaXM7XHJcblx0XHR9LFxyXG5cclxuXHRcdGdldFBhZ2VzQ291bnQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5kYXRhKCdwYWdpbmF0aW9uJykucGFnZXM7XHJcblx0XHR9LFxyXG5cclxuXHRcdGdldEN1cnJlbnRQYWdlOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLmRhdGEoJ3BhZ2luYXRpb24nKS5jdXJyZW50UGFnZSArIDE7XHJcblx0XHR9LFxyXG5cclxuXHRcdGRlc3Ryb3k6IGZ1bmN0aW9uKCl7XHJcblx0XHRcdHRoaXMuZW1wdHkoKTtcclxuXHRcdFx0cmV0dXJuIHRoaXM7XHJcblx0XHR9LFxyXG5cclxuXHRcdGRyYXdQYWdlOiBmdW5jdGlvbiAocGFnZSkge1xyXG5cdFx0XHR2YXIgbyA9IHRoaXMuZGF0YSgncGFnaW5hdGlvbicpO1xyXG5cdFx0XHRvLmN1cnJlbnRQYWdlID0gcGFnZSAtIDE7XHJcblx0XHRcdHRoaXMuZGF0YSgncGFnaW5hdGlvbicsIG8pO1xyXG5cdFx0XHRtZXRob2RzLl9kcmF3LmNhbGwodGhpcyk7XHJcblx0XHRcdHJldHVybiB0aGlzO1xyXG5cdFx0fSxcclxuXHJcblx0XHRyZWRyYXc6IGZ1bmN0aW9uKCl7XHJcblx0XHRcdG1ldGhvZHMuX2RyYXcuY2FsbCh0aGlzKTtcclxuXHRcdFx0cmV0dXJuIHRoaXM7XHJcblx0XHR9LFxyXG5cclxuXHRcdGRpc2FibGU6IGZ1bmN0aW9uKCl7XHJcblx0XHRcdHZhciBvID0gdGhpcy5kYXRhKCdwYWdpbmF0aW9uJyk7XHJcblx0XHRcdG8uZGlzYWJsZWQgPSB0cnVlO1xyXG5cdFx0XHR0aGlzLmRhdGEoJ3BhZ2luYXRpb24nLCBvKTtcclxuXHRcdFx0bWV0aG9kcy5fZHJhdy5jYWxsKHRoaXMpO1xyXG5cdFx0XHRyZXR1cm4gdGhpcztcclxuXHRcdH0sXHJcblxyXG5cdFx0ZW5hYmxlOiBmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgbyA9IHRoaXMuZGF0YSgncGFnaW5hdGlvbicpO1xyXG5cdFx0XHRvLmRpc2FibGVkID0gZmFsc2U7XHJcblx0XHRcdHRoaXMuZGF0YSgncGFnaW5hdGlvbicsIG8pO1xyXG5cdFx0XHRtZXRob2RzLl9kcmF3LmNhbGwodGhpcyk7XHJcblx0XHRcdHJldHVybiB0aGlzO1xyXG5cdFx0fSxcclxuXHJcblx0XHR1cGRhdGVJdGVtczogZnVuY3Rpb24gKG5ld0l0ZW1zKSB7XHJcblx0XHRcdHZhciBvID0gdGhpcy5kYXRhKCdwYWdpbmF0aW9uJyk7XHJcblx0XHRcdG8uaXRlbXMgPSBuZXdJdGVtcztcclxuXHRcdFx0by5wYWdlcyA9IG1ldGhvZHMuX2dldFBhZ2VzKG8pO1xyXG5cdFx0XHR0aGlzLmRhdGEoJ3BhZ2luYXRpb24nLCBvKTtcclxuXHRcdFx0bWV0aG9kcy5fZHJhdy5jYWxsKHRoaXMpO1xyXG5cdFx0fSxcclxuXHJcblx0XHR1cGRhdGVJdGVtc09uUGFnZTogZnVuY3Rpb24gKGl0ZW1zT25QYWdlKSB7XHJcblx0XHRcdHZhciBvID0gdGhpcy5kYXRhKCdwYWdpbmF0aW9uJyk7XHJcblx0XHRcdG8uaXRlbXNPblBhZ2UgPSBpdGVtc09uUGFnZTtcclxuXHRcdFx0by5wYWdlcyA9IG1ldGhvZHMuX2dldFBhZ2VzKG8pO1xyXG5cdFx0XHR0aGlzLmRhdGEoJ3BhZ2luYXRpb24nLCBvKTtcclxuXHRcdFx0bWV0aG9kcy5fc2VsZWN0UGFnZS5jYWxsKHRoaXMsIDApO1xyXG5cdFx0XHRyZXR1cm4gdGhpcztcclxuXHRcdH0sXHJcblxyXG5cdFx0X2RyYXc6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2YXJcdG8gPSB0aGlzLmRhdGEoJ3BhZ2luYXRpb24nKSxcclxuXHRcdFx0XHRpbnRlcnZhbCA9IG1ldGhvZHMuX2dldEludGVydmFsKG8pLFxyXG5cdFx0XHRcdGksXHJcblx0XHRcdFx0dGFnTmFtZTtcclxuXHJcblx0XHRcdG1ldGhvZHMuZGVzdHJveS5jYWxsKHRoaXMpO1xyXG5cdFx0XHRcclxuXHRcdFx0dGFnTmFtZSA9ICh0eXBlb2YgdGhpcy5wcm9wID09PSAnZnVuY3Rpb24nKSA/IHRoaXMucHJvcCgndGFnTmFtZScpIDogdGhpcy5hdHRyKCd0YWdOYW1lJyk7XHJcblxyXG5cdFx0XHR2YXIgJHBhbmVsID0gdGFnTmFtZSA9PT0gJ1VMJyA/IHRoaXMgOiAkKCc8dWw+PC91bD4nKS5hcHBlbmRUbyh0aGlzKTtcclxuXHJcblx0XHRcdC8vIEdlbmVyYXRlIFByZXYgbGlua1xyXG5cdFx0XHRpZiAoby5wcmV2VGV4dCkge1xyXG5cdFx0XHRcdG1ldGhvZHMuX2FwcGVuZEl0ZW0uY2FsbCh0aGlzLCAhby5pbnZlcnRQYWdlT3JkZXIgPyBvLmN1cnJlbnRQYWdlIC0gMSA6IG8uY3VycmVudFBhZ2UgKyAxLCB7dGV4dDogby5wcmV2VGV4dCwgY2xhc3NlczogJ3ByZXYnfSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIEdlbmVyYXRlIE5leHQgbGluayAoaWYgb3B0aW9uIHNldCBmb3IgYXQgZnJvbnQpXHJcblx0XHRcdGlmIChvLm5leHRUZXh0ICYmIG8ubmV4dEF0RnJvbnQpIHtcclxuXHRcdFx0XHRtZXRob2RzLl9hcHBlbmRJdGVtLmNhbGwodGhpcywgIW8uaW52ZXJ0UGFnZU9yZGVyID8gby5jdXJyZW50UGFnZSArIDEgOiBvLmN1cnJlbnRQYWdlIC0gMSwge3RleHQ6IG8ubmV4dFRleHQsIGNsYXNzZXM6ICduZXh0J30pO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBHZW5lcmF0ZSBzdGFydCBlZGdlc1xyXG5cdFx0XHRpZiAoIW8uaW52ZXJ0UGFnZU9yZGVyKSB7XHJcblx0XHRcdFx0aWYgKGludGVydmFsLnN0YXJ0ID4gMCAmJiBvLmVkZ2VzID4gMCkge1xyXG5cdFx0XHRcdFx0dmFyIGVuZCA9IE1hdGgubWluKG8uZWRnZXMsIGludGVydmFsLnN0YXJ0KTtcclxuXHRcdFx0XHRcdGZvciAoaSA9IDA7IGkgPCBlbmQ7IGkrKykge1xyXG5cdFx0XHRcdFx0XHRtZXRob2RzLl9hcHBlbmRJdGVtLmNhbGwodGhpcywgaSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZiAoby5lZGdlcyA8IGludGVydmFsLnN0YXJ0ICYmIChpbnRlcnZhbC5zdGFydCAtIG8uZWRnZXMgIT0gMSkpIHtcclxuXHRcdFx0XHRcdFx0JHBhbmVsLmFwcGVuZCgnPGxpIGNsYXNzPVwiZGlzYWJsZWRcIj48c3BhbiBjbGFzcz1cImVsbGlwc2VcIj4nICsgby5lbGxpcHNlVGV4dCArICc8L3NwYW4+PC9saT4nKTtcclxuXHRcdFx0XHRcdH0gZWxzZSBpZiAoaW50ZXJ2YWwuc3RhcnQgLSBvLmVkZ2VzID09IDEpIHtcclxuXHRcdFx0XHRcdFx0bWV0aG9kcy5fYXBwZW5kSXRlbS5jYWxsKHRoaXMsIG8uZWRnZXMpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRpZiAoaW50ZXJ2YWwuZW5kIDwgby5wYWdlcyAmJiBvLmVkZ2VzID4gMCkge1xyXG5cdFx0XHRcdFx0dmFyIGJlZ2luID0gTWF0aC5tYXgoby5wYWdlcyAtIG8uZWRnZXMsIGludGVydmFsLmVuZCk7XHJcblx0XHRcdFx0XHRmb3IgKGkgPSBvLnBhZ2VzIC0gMTsgaSA+PSBiZWdpbjsgaS0tKSB7XHJcblx0XHRcdFx0XHRcdG1ldGhvZHMuX2FwcGVuZEl0ZW0uY2FsbCh0aGlzLCBpKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmIChvLnBhZ2VzIC0gby5lZGdlcyA+IGludGVydmFsLmVuZCAmJiAoby5wYWdlcyAtIG8uZWRnZXMgLSBpbnRlcnZhbC5lbmQgIT0gMSkpIHtcclxuXHRcdFx0XHRcdFx0JHBhbmVsLmFwcGVuZCgnPGxpIGNsYXNzPVwiZGlzYWJsZWRcIj48c3BhbiBjbGFzcz1cImVsbGlwc2VcIj4nICsgby5lbGxpcHNlVGV4dCArICc8L3NwYW4+PC9saT4nKTtcclxuXHRcdFx0XHRcdH0gZWxzZSBpZiAoby5wYWdlcyAtIG8uZWRnZXMgLSBpbnRlcnZhbC5lbmQgPT0gMSkge1xyXG5cdFx0XHRcdFx0XHRtZXRob2RzLl9hcHBlbmRJdGVtLmNhbGwodGhpcywgaW50ZXJ2YWwuZW5kKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIEdlbmVyYXRlIGludGVydmFsIGxpbmtzXHJcblx0XHRcdGlmICghby5pbnZlcnRQYWdlT3JkZXIpIHtcclxuXHRcdFx0XHRmb3IgKGkgPSBpbnRlcnZhbC5zdGFydDsgaSA8IGludGVydmFsLmVuZDsgaSsrKSB7XHJcblx0XHRcdFx0XHRtZXRob2RzLl9hcHBlbmRJdGVtLmNhbGwodGhpcywgaSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGZvciAoaSA9IGludGVydmFsLmVuZCAtIDE7IGkgPj0gaW50ZXJ2YWwuc3RhcnQ7IGktLSkge1xyXG5cdFx0XHRcdFx0bWV0aG9kcy5fYXBwZW5kSXRlbS5jYWxsKHRoaXMsIGkpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gR2VuZXJhdGUgZW5kIGVkZ2VzXHJcblx0XHRcdGlmICghby5pbnZlcnRQYWdlT3JkZXIpIHtcclxuXHRcdFx0XHRpZiAoaW50ZXJ2YWwuZW5kIDwgby5wYWdlcyAmJiBvLmVkZ2VzID4gMCkge1xyXG5cdFx0XHRcdFx0aWYgKG8ucGFnZXMgLSBvLmVkZ2VzID4gaW50ZXJ2YWwuZW5kICYmIChvLnBhZ2VzIC0gby5lZGdlcyAtIGludGVydmFsLmVuZCAhPSAxKSkge1xyXG5cdFx0XHRcdFx0XHQkcGFuZWwuYXBwZW5kKCc8bGkgY2xhc3M9XCJkaXNhYmxlZFwiPjxzcGFuIGNsYXNzPVwiZWxsaXBzZVwiPicgKyBvLmVsbGlwc2VUZXh0ICsgJzwvc3Bhbj48L2xpPicpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIGlmIChvLnBhZ2VzIC0gby5lZGdlcyAtIGludGVydmFsLmVuZCA9PSAxKSB7XHJcblx0XHRcdFx0XHRcdG1ldGhvZHMuX2FwcGVuZEl0ZW0uY2FsbCh0aGlzLCBpbnRlcnZhbC5lbmQpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0dmFyIGJlZ2luID0gTWF0aC5tYXgoby5wYWdlcyAtIG8uZWRnZXMsIGludGVydmFsLmVuZCk7XHJcblx0XHRcdFx0XHRmb3IgKGkgPSBiZWdpbjsgaSA8IG8ucGFnZXM7IGkrKykge1xyXG5cdFx0XHRcdFx0XHRtZXRob2RzLl9hcHBlbmRJdGVtLmNhbGwodGhpcywgaSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGlmIChpbnRlcnZhbC5zdGFydCA+IDAgJiYgby5lZGdlcyA+IDApIHtcclxuXHRcdFx0XHRcdGlmIChvLmVkZ2VzIDwgaW50ZXJ2YWwuc3RhcnQgJiYgKGludGVydmFsLnN0YXJ0IC0gby5lZGdlcyAhPSAxKSkge1xyXG5cdFx0XHRcdFx0XHQkcGFuZWwuYXBwZW5kKCc8bGkgY2xhc3M9XCJkaXNhYmxlZFwiPjxzcGFuIGNsYXNzPVwiZWxsaXBzZVwiPicgKyBvLmVsbGlwc2VUZXh0ICsgJzwvc3Bhbj48L2xpPicpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIGlmIChpbnRlcnZhbC5zdGFydCAtIG8uZWRnZXMgPT0gMSkge1xyXG5cdFx0XHRcdFx0XHRtZXRob2RzLl9hcHBlbmRJdGVtLmNhbGwodGhpcywgby5lZGdlcyk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR2YXIgZW5kID0gTWF0aC5taW4oby5lZGdlcywgaW50ZXJ2YWwuc3RhcnQpO1xyXG5cdFx0XHRcdFx0Zm9yIChpID0gZW5kIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuXHRcdFx0XHRcdFx0bWV0aG9kcy5fYXBwZW5kSXRlbS5jYWxsKHRoaXMsIGkpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gR2VuZXJhdGUgTmV4dCBsaW5rICh1bmxlc3Mgb3B0aW9uIGlzIHNldCBmb3IgYXQgZnJvbnQpXHJcblx0XHRcdGlmIChvLm5leHRUZXh0ICYmICFvLm5leHRBdEZyb250KSB7XHJcblx0XHRcdFx0bWV0aG9kcy5fYXBwZW5kSXRlbS5jYWxsKHRoaXMsICFvLmludmVydFBhZ2VPcmRlciA/IG8uY3VycmVudFBhZ2UgKyAxIDogby5jdXJyZW50UGFnZSAtIDEsIHt0ZXh0OiBvLm5leHRUZXh0LCBjbGFzc2VzOiAnbmV4dCd9KTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHJcblx0XHRfZ2V0UGFnZXM6IGZ1bmN0aW9uKG8pIHtcclxuXHRcdFx0dmFyIHBhZ2VzID0gTWF0aC5jZWlsKG8uaXRlbXMgLyBvLml0ZW1zT25QYWdlKTtcclxuXHRcdFx0cmV0dXJuIHBhZ2VzIHx8IDE7XHJcblx0XHR9LFxyXG5cclxuXHRcdF9nZXRJbnRlcnZhbDogZnVuY3Rpb24obykge1xyXG5cdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdHN0YXJ0OiBNYXRoLmNlaWwoby5jdXJyZW50UGFnZSA+IG8uaGFsZkRpc3BsYXllZCA/IE1hdGgubWF4KE1hdGgubWluKG8uY3VycmVudFBhZ2UgLSBvLmhhbGZEaXNwbGF5ZWQsIChvLnBhZ2VzIC0gby5kaXNwbGF5ZWRQYWdlcykpLCAwKSA6IDApLFxyXG5cdFx0XHRcdGVuZDogTWF0aC5jZWlsKG8uY3VycmVudFBhZ2UgPiBvLmhhbGZEaXNwbGF5ZWQgPyBNYXRoLm1pbihvLmN1cnJlbnRQYWdlICsgby5oYWxmRGlzcGxheWVkLCBvLnBhZ2VzKSA6IE1hdGgubWluKG8uZGlzcGxheWVkUGFnZXMsIG8ucGFnZXMpKVxyXG5cdFx0XHR9O1xyXG5cdFx0fSxcclxuXHJcblx0XHRfYXBwZW5kSXRlbTogZnVuY3Rpb24ocGFnZUluZGV4LCBvcHRzKSB7XHJcblx0XHRcdHZhciBzZWxmID0gdGhpcywgb3B0aW9ucywgJGxpbmssIG8gPSBzZWxmLmRhdGEoJ3BhZ2luYXRpb24nKSwgJGxpbmtXcmFwcGVyID0gJCgnPGxpPjwvbGk+JyksICR1bCA9IHNlbGYuZmluZCgndWwnKTtcclxuXHJcblx0XHRcdHBhZ2VJbmRleCA9IHBhZ2VJbmRleCA8IDAgPyAwIDogKHBhZ2VJbmRleCA8IG8ucGFnZXMgPyBwYWdlSW5kZXggOiBvLnBhZ2VzIC0gMSk7XHJcblxyXG5cdFx0XHRvcHRpb25zID0ge1xyXG5cdFx0XHRcdHRleHQ6IHBhZ2VJbmRleCArIDEsXHJcblx0XHRcdFx0Y2xhc3NlczogJydcclxuXHRcdFx0fTtcclxuXHJcblx0XHRcdGlmIChvLmxhYmVsTWFwLmxlbmd0aCAmJiBvLmxhYmVsTWFwW3BhZ2VJbmRleF0pIHtcclxuXHRcdFx0XHRvcHRpb25zLnRleHQgPSBvLmxhYmVsTWFwW3BhZ2VJbmRleF07XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdG9wdGlvbnMgPSAkLmV4dGVuZChvcHRpb25zLCBvcHRzIHx8IHt9KTtcclxuXHJcblx0XHRcdGlmIChwYWdlSW5kZXggPT0gby5jdXJyZW50UGFnZSB8fCBvLmRpc2FibGVkKSB7XHJcblx0XHRcdFx0aWYgKG8uZGlzYWJsZWQpIHtcclxuXHRcdFx0XHRcdCRsaW5rV3JhcHBlci5hZGRDbGFzcygnZGlzYWJsZWQnKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0JGxpbmtXcmFwcGVyLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0JGxpbmsgPSAkKCc8c3BhbiBjbGFzcz1cImN1cnJlbnRcIj4nICsgKG9wdGlvbnMudGV4dCkgKyAnPC9zcGFuPicpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdCRsaW5rID0gJCgnPGEgaHJlZj1cIicgKyBvLmhyZWZUZXh0UHJlZml4ICsgKHBhZ2VJbmRleCArIDEpICsgby5ocmVmVGV4dFN1ZmZpeCArICdcIiBjbGFzcz1cInBhZ2UtbGlua1wiPicgKyAob3B0aW9ucy50ZXh0KSArICc8L2E+Jyk7XHJcblx0XHRcdFx0JGxpbmsuY2xpY2soZnVuY3Rpb24oZXZlbnQpe1xyXG5cdFx0XHRcdFx0cmV0dXJuIG1ldGhvZHMuX3NlbGVjdFBhZ2UuY2FsbChzZWxmLCBwYWdlSW5kZXgsIGV2ZW50KTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKG9wdGlvbnMuY2xhc3Nlcykge1xyXG5cdFx0XHRcdCRsaW5rLmFkZENsYXNzKG9wdGlvbnMuY2xhc3Nlcyk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdCRsaW5rV3JhcHBlci5hcHBlbmQoJGxpbmspO1xyXG5cclxuXHRcdFx0aWYgKCR1bC5sZW5ndGgpIHtcclxuXHRcdFx0XHQkdWwuYXBwZW5kKCRsaW5rV3JhcHBlcik7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0c2VsZi5hcHBlbmQoJGxpbmtXcmFwcGVyKTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHJcblx0XHRfc2VsZWN0UGFnZTogZnVuY3Rpb24ocGFnZUluZGV4LCBldmVudCkge1xyXG5cdFx0XHR2YXIgbyA9IHRoaXMuZGF0YSgncGFnaW5hdGlvbicpO1xyXG5cdFx0XHRvLmN1cnJlbnRQYWdlID0gcGFnZUluZGV4O1xyXG5cdFx0XHRpZiAoby5zZWxlY3RPbkNsaWNrKSB7XHJcblx0XHRcdFx0bWV0aG9kcy5fZHJhdy5jYWxsKHRoaXMpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiBvLm9uUGFnZUNsaWNrKHBhZ2VJbmRleCArIDEsIGV2ZW50KTtcclxuXHRcdH1cclxuXHJcblx0fTtcclxuXHJcblx0JC5mbi5wYWdpbmF0aW9uID0gZnVuY3Rpb24obWV0aG9kKSB7XHJcblxyXG5cdFx0Ly8gTWV0aG9kIGNhbGxpbmcgbG9naWNcclxuXHRcdGlmIChtZXRob2RzW21ldGhvZF0gJiYgbWV0aG9kLmNoYXJBdCgwKSAhPSAnXycpIHtcclxuXHRcdFx0cmV0dXJuIG1ldGhvZHNbbWV0aG9kXS5hcHBseSh0aGlzLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcclxuXHRcdH0gZWxzZSBpZiAodHlwZW9mIG1ldGhvZCA9PT0gJ29iamVjdCcgfHwgIW1ldGhvZCkge1xyXG5cdFx0XHRyZXR1cm4gbWV0aG9kcy5pbml0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQkLmVycm9yKCdNZXRob2QgJyArICBtZXRob2QgKyAnIGRvZXMgbm90IGV4aXN0IG9uIGpRdWVyeS5wYWdpbmF0aW9uJyk7XHJcblx0XHR9XHJcblxyXG5cdH07XHJcblxyXG59KShqUXVlcnkpO1xyXG4iLCIvLyBTcGVjdHJ1bSBDb2xvcnBpY2tlciB2MS42LjBcclxuLy8gaHR0cHM6Ly9naXRodWIuY29tL2Jncmlucy9zcGVjdHJ1bVxyXG4vLyBBdXRob3I6IEJyaWFuIEdyaW5zdGVhZFxyXG4vLyBMaWNlbnNlOiBNSVRcclxuXHJcbihmdW5jdGlvbiAoZmFjdG9yeSkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkgeyAvLyBBTURcclxuICAgICAgICBkZWZpbmUoWydqcXVlcnknXSwgZmFjdG9yeSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyA9PSBcIm9iamVjdFwiICYmIHR5cGVvZiBtb2R1bGUgPT0gXCJvYmplY3RcIikgeyAvLyBDb21tb25KU1xyXG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeTtcclxuICAgIH1cclxuICAgIGVsc2UgeyAvLyBCcm93c2VyXHJcbiAgICAgICAgZmFjdG9yeShqUXVlcnkpO1xyXG4gICAgfVxyXG59KShmdW5jdGlvbigkLCB1bmRlZmluZWQpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIHZhciBkZWZhdWx0T3B0cyA9IHtcclxuXHJcbiAgICAgICAgLy8gQ2FsbGJhY2tzXHJcbiAgICAgICAgYmVmb3JlU2hvdzogbm9vcCxcclxuICAgICAgICBtb3ZlOiBub29wLFxyXG4gICAgICAgIGNoYW5nZTogbm9vcCxcclxuICAgICAgICBzaG93OiBub29wLFxyXG4gICAgICAgIGhpZGU6IG5vb3AsXHJcblxyXG4gICAgICAgIC8vIE9wdGlvbnNcclxuICAgICAgICBjb2xvcjogZmFsc2UsXHJcbiAgICAgICAgZmxhdDogZmFsc2UsXHJcbiAgICAgICAgc2hvd0lucHV0OiBmYWxzZSxcclxuICAgICAgICBhbGxvd0VtcHR5OiBmYWxzZSxcclxuICAgICAgICBzaG93QnV0dG9uczogdHJ1ZSxcclxuICAgICAgICBjbGlja291dEZpcmVzQ2hhbmdlOiBmYWxzZSxcclxuICAgICAgICBzaG93SW5pdGlhbDogZmFsc2UsXHJcbiAgICAgICAgc2hvd1BhbGV0dGU6IGZhbHNlLFxyXG4gICAgICAgIHNob3dQYWxldHRlT25seTogZmFsc2UsXHJcbiAgICAgICAgaGlkZUFmdGVyUGFsZXR0ZVNlbGVjdDogZmFsc2UsXHJcbiAgICAgICAgdG9nZ2xlUGFsZXR0ZU9ubHk6IGZhbHNlLFxyXG4gICAgICAgIHNob3dTZWxlY3Rpb25QYWxldHRlOiB0cnVlLFxyXG4gICAgICAgIGxvY2FsU3RvcmFnZUtleTogZmFsc2UsXHJcbiAgICAgICAgYXBwZW5kVG86IFwiYm9keVwiLFxyXG4gICAgICAgIG1heFNlbGVjdGlvblNpemU6IDcsXHJcbiAgICAgICAgY2FuY2VsVGV4dDogXCJjYW5jZWxcIixcclxuICAgICAgICBjaG9vc2VUZXh0OiBcImNob29zZVwiLFxyXG4gICAgICAgIHRvZ2dsZVBhbGV0dGVNb3JlVGV4dDogXCJtb3JlXCIsXHJcbiAgICAgICAgdG9nZ2xlUGFsZXR0ZUxlc3NUZXh0OiBcImxlc3NcIixcclxuICAgICAgICBjbGVhclRleHQ6IFwiQ2xlYXIgQ29sb3IgU2VsZWN0aW9uXCIsXHJcbiAgICAgICAgbm9Db2xvclNlbGVjdGVkVGV4dDogXCJObyBDb2xvciBTZWxlY3RlZFwiLFxyXG4gICAgICAgIHByZWZlcnJlZEZvcm1hdDogZmFsc2UsXHJcbiAgICAgICAgY2xhc3NOYW1lOiBcIlwiLCAvLyBEZXByZWNhdGVkIC0gdXNlIGNvbnRhaW5lckNsYXNzTmFtZSBhbmQgcmVwbGFjZXJDbGFzc05hbWUgaW5zdGVhZC5cclxuICAgICAgICBjb250YWluZXJDbGFzc05hbWU6IFwiXCIsXHJcbiAgICAgICAgcmVwbGFjZXJDbGFzc05hbWU6IFwiXCIsXHJcbiAgICAgICAgc2hvd0FscGhhOiBmYWxzZSxcclxuICAgICAgICB0aGVtZTogXCJzcC1saWdodFwiLFxyXG4gICAgICAgIHBhbGV0dGU6IFtbXCIjZmZmZmZmXCIsIFwiIzAwMDAwMFwiLCBcIiNmZjAwMDBcIiwgXCIjZmY4MDAwXCIsIFwiI2ZmZmYwMFwiLCBcIiMwMDgwMDBcIiwgXCIjMDAwMGZmXCIsIFwiIzRiMDA4MlwiLCBcIiM5NDAwZDNcIl1dLFxyXG4gICAgICAgIHNlbGVjdGlvblBhbGV0dGU6IFtdLFxyXG4gICAgICAgIGRpc2FibGVkOiBmYWxzZSxcclxuICAgICAgICBvZmZzZXQ6IG51bGxcclxuICAgIH0sXHJcbiAgICBzcGVjdHJ1bXMgPSBbXSxcclxuICAgIElFID0gISEvbXNpZS9pLmV4ZWMoIHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50ICksXHJcbiAgICByZ2JhU3VwcG9ydCA9IChmdW5jdGlvbigpIHtcclxuICAgICAgICBmdW5jdGlvbiBjb250YWlucyggc3RyLCBzdWJzdHIgKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhIX4oJycgKyBzdHIpLmluZGV4T2Yoc3Vic3RyKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBlbGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgdmFyIHN0eWxlID0gZWxlbS5zdHlsZTtcclxuICAgICAgICBzdHlsZS5jc3NUZXh0ID0gJ2JhY2tncm91bmQtY29sb3I6cmdiYSgwLDAsMCwuNSknO1xyXG4gICAgICAgIHJldHVybiBjb250YWlucyhzdHlsZS5iYWNrZ3JvdW5kQ29sb3IsICdyZ2JhJykgfHwgY29udGFpbnMoc3R5bGUuYmFja2dyb3VuZENvbG9yLCAnaHNsYScpO1xyXG4gICAgfSkoKSxcclxuICAgIGlucHV0VHlwZUNvbG9yU3VwcG9ydCA9IChmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgY29sb3JJbnB1dCA9ICQoXCI8aW5wdXQgdHlwZT0nY29sb3InIHZhbHVlPSchJyAvPlwiKVswXTtcclxuICAgICAgICByZXR1cm4gY29sb3JJbnB1dC50eXBlID09PSBcImNvbG9yXCIgJiYgY29sb3JJbnB1dC52YWx1ZSAhPT0gXCIhXCI7XHJcbiAgICB9KSgpLFxyXG4gICAgcmVwbGFjZUlucHV0ID0gW1xyXG4gICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtcmVwbGFjZXInPlwiLFxyXG4gICAgICAgICAgICBcIjxkaXYgY2xhc3M9J3NwLXByZXZpZXcnPjxkaXYgY2xhc3M9J3NwLXByZXZpZXctaW5uZXInPjwvZGl2PjwvZGl2PlwiLFxyXG4gICAgICAgICAgICBcIjxkaXYgY2xhc3M9J3NwLWRkJz4mIzk2NjA7PC9kaXY+XCIsXHJcbiAgICAgICAgXCI8L2Rpdj5cIlxyXG4gICAgXS5qb2luKCcnKSxcclxuICAgIG1hcmt1cCA9IChmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIC8vIElFIGRvZXMgbm90IHN1cHBvcnQgZ3JhZGllbnRzIHdpdGggbXVsdGlwbGUgc3RvcHMsIHNvIHdlIG5lZWQgdG8gc2ltdWxhdGVcclxuICAgICAgICAvLyAgdGhhdCBmb3IgdGhlIHJhaW5ib3cgc2xpZGVyIHdpdGggOCBkaXZzIHRoYXQgZWFjaCBoYXZlIGEgc2luZ2xlIGdyYWRpZW50XHJcbiAgICAgICAgdmFyIGdyYWRpZW50Rml4ID0gXCJcIjtcclxuICAgICAgICBpZiAoSUUpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gNjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBncmFkaWVudEZpeCArPSBcIjxkaXYgY2xhc3M9J3NwLVwiICsgaSArIFwiJz48L2Rpdj5cIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcC1jb250YWluZXIgc3AtaGlkZGVuJz5cIixcclxuICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtcGFsZXR0ZS1jb250YWluZXInPlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtcGFsZXR0ZSBzcC10aHVtYiBzcC1jZic+PC9kaXY+XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcC1wYWxldHRlLWJ1dHRvbi1jb250YWluZXIgc3AtY2YnPlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIjxidXR0b24gdHlwZT0nYnV0dG9uJyBjbGFzcz0nc3AtcGFsZXR0ZS10b2dnbGUnPjwvYnV0dG9uPlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXHJcbiAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxyXG4gICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcC1waWNrZXItY29udGFpbmVyJz5cIixcclxuICAgICAgICAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9J3NwLXRvcCBzcC1jZic+XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtZmlsbCc+PC9kaXY+XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtdG9wLWlubmVyJz5cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtY29sb3InPlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3Atc2F0Jz5cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcC12YWwnPlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcC1kcmFnZ2VyJz48L2Rpdj5cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtY2xlYXIgc3AtY2xlYXItZGlzcGxheSc+XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcC1odWUnPlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3Atc2xpZGVyJz48L2Rpdj5cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncmFkaWVudEZpeCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtYWxwaGEnPjxkaXYgY2xhc3M9J3NwLWFscGhhLWlubmVyJz48ZGl2IGNsYXNzPSdzcC1hbHBoYS1oYW5kbGUnPjwvZGl2PjwvZGl2PjwvZGl2PlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcC1pbnB1dC1jb250YWluZXIgc3AtY2YnPlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIjxpbnB1dCBjbGFzcz0nc3AtaW5wdXQnIHR5cGU9J3RleHQnIHNwZWxsY2hlY2s9J2ZhbHNlJyAgLz5cIixcclxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtaW5pdGlhbCBzcC10aHVtYiBzcC1jZic+PC9kaXY+XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcC1idXR0b24tY29udGFpbmVyIHNwLWNmJz5cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCI8YSBjbGFzcz0nc3AtY2FuY2VsJyBocmVmPScjJz48L2E+XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiPGJ1dHRvbiB0eXBlPSdidXR0b24nIGNsYXNzPSdzcC1jaG9vc2UnPjwvYnV0dG9uPlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXHJcbiAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxyXG4gICAgICAgICAgICBcIjwvZGl2PlwiXHJcbiAgICAgICAgXS5qb2luKFwiXCIpO1xyXG4gICAgfSkoKTtcclxuXHJcbiAgICBmdW5jdGlvbiBwYWxldHRlVGVtcGxhdGUgKHAsIGNvbG9yLCBjbGFzc05hbWUsIG9wdHMpIHtcclxuICAgICAgICB2YXIgaHRtbCA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgY3VycmVudCA9IHBbaV07XHJcbiAgICAgICAgICAgIGlmKGN1cnJlbnQpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0aW55ID0gdGlueWNvbG9yKGN1cnJlbnQpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSB0aW55LnRvSHNsKCkubCA8IDAuNSA/IFwic3AtdGh1bWItZWwgc3AtdGh1bWItZGFya1wiIDogXCJzcC10aHVtYi1lbCBzcC10aHVtYi1saWdodFwiO1xyXG4gICAgICAgICAgICAgICAgYyArPSAodGlueWNvbG9yLmVxdWFscyhjb2xvciwgY3VycmVudCkpID8gXCIgc3AtdGh1bWItYWN0aXZlXCIgOiBcIlwiO1xyXG4gICAgICAgICAgICAgICAgdmFyIGZvcm1hdHRlZFN0cmluZyA9IHRpbnkudG9TdHJpbmcob3B0cy5wcmVmZXJyZWRGb3JtYXQgfHwgXCJyZ2JcIik7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3dhdGNoU3R5bGUgPSByZ2JhU3VwcG9ydCA/IChcImJhY2tncm91bmQtY29sb3I6XCIgKyB0aW55LnRvUmdiU3RyaW5nKCkpIDogXCJmaWx0ZXI6XCIgKyB0aW55LnRvRmlsdGVyKCk7XHJcbiAgICAgICAgICAgICAgICBodG1sLnB1c2goJzxzcGFuIHRpdGxlPVwiJyArIGZvcm1hdHRlZFN0cmluZyArICdcIiBkYXRhLWNvbG9yPVwiJyArIHRpbnkudG9SZ2JTdHJpbmcoKSArICdcIiBjbGFzcz1cIicgKyBjICsgJ1wiPjxzcGFuIGNsYXNzPVwic3AtdGh1bWItaW5uZXJcIiBzdHlsZT1cIicgKyBzd2F0Y2hTdHlsZSArICc7XCIgLz48L3NwYW4+Jyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2xzID0gJ3NwLWNsZWFyLWRpc3BsYXknO1xyXG4gICAgICAgICAgICAgICAgaHRtbC5wdXNoKCQoJzxkaXYgLz4nKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHNwYW4gZGF0YS1jb2xvcj1cIlwiIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjp0cmFuc3BhcmVudDtcIiBjbGFzcz1cIicgKyBjbHMgKyAnXCI+PC9zcGFuPicpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCd0aXRsZScsIG9wdHMubm9Db2xvclNlbGVjdGVkVGV4dClcclxuICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgLmh0bWwoKVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gXCI8ZGl2IGNsYXNzPSdzcC1jZiBcIiArIGNsYXNzTmFtZSArIFwiJz5cIiArIGh0bWwuam9pbignJykgKyBcIjwvZGl2PlwiO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGhpZGVBbGwoKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzcGVjdHJ1bXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKHNwZWN0cnVtc1tpXSkge1xyXG4gICAgICAgICAgICAgICAgc3BlY3RydW1zW2ldLmhpZGUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBpbnN0YW5jZU9wdGlvbnMobywgY2FsbGJhY2tDb250ZXh0KSB7XHJcbiAgICAgICAgdmFyIG9wdHMgPSAkLmV4dGVuZCh7fSwgZGVmYXVsdE9wdHMsIG8pO1xyXG4gICAgICAgIG9wdHMuY2FsbGJhY2tzID0ge1xyXG4gICAgICAgICAgICAnbW92ZSc6IGJpbmQob3B0cy5tb3ZlLCBjYWxsYmFja0NvbnRleHQpLFxyXG4gICAgICAgICAgICAnY2hhbmdlJzogYmluZChvcHRzLmNoYW5nZSwgY2FsbGJhY2tDb250ZXh0KSxcclxuICAgICAgICAgICAgJ3Nob3cnOiBiaW5kKG9wdHMuc2hvdywgY2FsbGJhY2tDb250ZXh0KSxcclxuICAgICAgICAgICAgJ2hpZGUnOiBiaW5kKG9wdHMuaGlkZSwgY2FsbGJhY2tDb250ZXh0KSxcclxuICAgICAgICAgICAgJ2JlZm9yZVNob3cnOiBiaW5kKG9wdHMuYmVmb3JlU2hvdywgY2FsbGJhY2tDb250ZXh0KVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiBvcHRzO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNwZWN0cnVtKGVsZW1lbnQsIG8pIHtcclxuXHJcbiAgICAgICAgdmFyIG9wdHMgPSBpbnN0YW5jZU9wdGlvbnMobywgZWxlbWVudCksXHJcbiAgICAgICAgICAgIGZsYXQgPSBvcHRzLmZsYXQsXHJcbiAgICAgICAgICAgIHNob3dTZWxlY3Rpb25QYWxldHRlID0gb3B0cy5zaG93U2VsZWN0aW9uUGFsZXR0ZSxcclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlS2V5ID0gb3B0cy5sb2NhbFN0b3JhZ2VLZXksXHJcbiAgICAgICAgICAgIHRoZW1lID0gb3B0cy50aGVtZSxcclxuICAgICAgICAgICAgY2FsbGJhY2tzID0gb3B0cy5jYWxsYmFja3MsXHJcbiAgICAgICAgICAgIHJlc2l6ZSA9IHRocm90dGxlKHJlZmxvdywgMTApLFxyXG4gICAgICAgICAgICB2aXNpYmxlID0gZmFsc2UsXHJcbiAgICAgICAgICAgIGRyYWdXaWR0aCA9IDAsXHJcbiAgICAgICAgICAgIGRyYWdIZWlnaHQgPSAwLFxyXG4gICAgICAgICAgICBkcmFnSGVscGVySGVpZ2h0ID0gMCxcclxuICAgICAgICAgICAgc2xpZGVIZWlnaHQgPSAwLFxyXG4gICAgICAgICAgICBzbGlkZVdpZHRoID0gMCxcclxuICAgICAgICAgICAgYWxwaGFXaWR0aCA9IDAsXHJcbiAgICAgICAgICAgIGFscGhhU2xpZGVIZWxwZXJXaWR0aCA9IDAsXHJcbiAgICAgICAgICAgIHNsaWRlSGVscGVySGVpZ2h0ID0gMCxcclxuICAgICAgICAgICAgY3VycmVudEh1ZSA9IDAsXHJcbiAgICAgICAgICAgIGN1cnJlbnRTYXR1cmF0aW9uID0gMCxcclxuICAgICAgICAgICAgY3VycmVudFZhbHVlID0gMCxcclxuICAgICAgICAgICAgY3VycmVudEFscGhhID0gMSxcclxuICAgICAgICAgICAgcGFsZXR0ZSA9IFtdLFxyXG4gICAgICAgICAgICBwYWxldHRlQXJyYXkgPSBbXSxcclxuICAgICAgICAgICAgcGFsZXR0ZUxvb2t1cCA9IHt9LFxyXG4gICAgICAgICAgICBzZWxlY3Rpb25QYWxldHRlID0gb3B0cy5zZWxlY3Rpb25QYWxldHRlLnNsaWNlKDApLFxyXG4gICAgICAgICAgICBtYXhTZWxlY3Rpb25TaXplID0gb3B0cy5tYXhTZWxlY3Rpb25TaXplLFxyXG4gICAgICAgICAgICBkcmFnZ2luZ0NsYXNzID0gXCJzcC1kcmFnZ2luZ1wiLFxyXG4gICAgICAgICAgICBzaGlmdE1vdmVtZW50RGlyZWN0aW9uID0gbnVsbDtcclxuXHJcbiAgICAgICAgdmFyIGRvYyA9IGVsZW1lbnQub3duZXJEb2N1bWVudCxcclxuICAgICAgICAgICAgYm9keSA9IGRvYy5ib2R5LFxyXG4gICAgICAgICAgICBib3VuZEVsZW1lbnQgPSAkKGVsZW1lbnQpLFxyXG4gICAgICAgICAgICBkaXNhYmxlZCA9IGZhbHNlLFxyXG4gICAgICAgICAgICBjb250YWluZXIgPSAkKG1hcmt1cCwgZG9jKS5hZGRDbGFzcyh0aGVtZSksXHJcbiAgICAgICAgICAgIHBpY2tlckNvbnRhaW5lciA9IGNvbnRhaW5lci5maW5kKFwiLnNwLXBpY2tlci1jb250YWluZXJcIiksXHJcbiAgICAgICAgICAgIGRyYWdnZXIgPSBjb250YWluZXIuZmluZChcIi5zcC1jb2xvclwiKSxcclxuICAgICAgICAgICAgZHJhZ0hlbHBlciA9IGNvbnRhaW5lci5maW5kKFwiLnNwLWRyYWdnZXJcIiksXHJcbiAgICAgICAgICAgIHNsaWRlciA9IGNvbnRhaW5lci5maW5kKFwiLnNwLWh1ZVwiKSxcclxuICAgICAgICAgICAgc2xpZGVIZWxwZXIgPSBjb250YWluZXIuZmluZChcIi5zcC1zbGlkZXJcIiksXHJcbiAgICAgICAgICAgIGFscGhhU2xpZGVySW5uZXIgPSBjb250YWluZXIuZmluZChcIi5zcC1hbHBoYS1pbm5lclwiKSxcclxuICAgICAgICAgICAgYWxwaGFTbGlkZXIgPSBjb250YWluZXIuZmluZChcIi5zcC1hbHBoYVwiKSxcclxuICAgICAgICAgICAgYWxwaGFTbGlkZUhlbHBlciA9IGNvbnRhaW5lci5maW5kKFwiLnNwLWFscGhhLWhhbmRsZVwiKSxcclxuICAgICAgICAgICAgdGV4dElucHV0ID0gY29udGFpbmVyLmZpbmQoXCIuc3AtaW5wdXRcIiksXHJcbiAgICAgICAgICAgIHBhbGV0dGVDb250YWluZXIgPSBjb250YWluZXIuZmluZChcIi5zcC1wYWxldHRlXCIpLFxyXG4gICAgICAgICAgICBpbml0aWFsQ29sb3JDb250YWluZXIgPSBjb250YWluZXIuZmluZChcIi5zcC1pbml0aWFsXCIpLFxyXG4gICAgICAgICAgICBjYW5jZWxCdXR0b24gPSBjb250YWluZXIuZmluZChcIi5zcC1jYW5jZWxcIiksXHJcbiAgICAgICAgICAgIGNsZWFyQnV0dG9uID0gY29udGFpbmVyLmZpbmQoXCIuc3AtY2xlYXJcIiksXHJcbiAgICAgICAgICAgIGNob29zZUJ1dHRvbiA9IGNvbnRhaW5lci5maW5kKFwiLnNwLWNob29zZVwiKSxcclxuICAgICAgICAgICAgdG9nZ2xlQnV0dG9uID0gY29udGFpbmVyLmZpbmQoXCIuc3AtcGFsZXR0ZS10b2dnbGVcIiksXHJcbiAgICAgICAgICAgIGlzSW5wdXQgPSBib3VuZEVsZW1lbnQuaXMoXCJpbnB1dFwiKSxcclxuICAgICAgICAgICAgaXNJbnB1dFR5cGVDb2xvciA9IGlzSW5wdXQgJiYgaW5wdXRUeXBlQ29sb3JTdXBwb3J0ICYmIGJvdW5kRWxlbWVudC5hdHRyKFwidHlwZVwiKSA9PT0gXCJjb2xvclwiLFxyXG4gICAgICAgICAgICBzaG91bGRSZXBsYWNlID0gaXNJbnB1dCAmJiAhZmxhdCxcclxuICAgICAgICAgICAgcmVwbGFjZXIgPSAoc2hvdWxkUmVwbGFjZSkgPyAkKHJlcGxhY2VJbnB1dCkuYWRkQ2xhc3ModGhlbWUpLmFkZENsYXNzKG9wdHMuY2xhc3NOYW1lKS5hZGRDbGFzcyhvcHRzLnJlcGxhY2VyQ2xhc3NOYW1lKSA6ICQoW10pLFxyXG4gICAgICAgICAgICBvZmZzZXRFbGVtZW50ID0gKHNob3VsZFJlcGxhY2UpID8gcmVwbGFjZXIgOiBib3VuZEVsZW1lbnQsXHJcbiAgICAgICAgICAgIHByZXZpZXdFbGVtZW50ID0gcmVwbGFjZXIuZmluZChcIi5zcC1wcmV2aWV3LWlubmVyXCIpLFxyXG4gICAgICAgICAgICBpbml0aWFsQ29sb3IgPSBvcHRzLmNvbG9yIHx8IChpc0lucHV0ICYmIGJvdW5kRWxlbWVudC52YWwoKSksXHJcbiAgICAgICAgICAgIGNvbG9yT25TaG93ID0gZmFsc2UsXHJcbiAgICAgICAgICAgIHByZWZlcnJlZEZvcm1hdCA9IG9wdHMucHJlZmVycmVkRm9ybWF0LFxyXG4gICAgICAgICAgICBjdXJyZW50UHJlZmVycmVkRm9ybWF0ID0gcHJlZmVycmVkRm9ybWF0LFxyXG4gICAgICAgICAgICBjbGlja291dEZpcmVzQ2hhbmdlID0gIW9wdHMuc2hvd0J1dHRvbnMgfHwgb3B0cy5jbGlja291dEZpcmVzQ2hhbmdlLFxyXG4gICAgICAgICAgICBpc0VtcHR5ID0gIWluaXRpYWxDb2xvcixcclxuICAgICAgICAgICAgYWxsb3dFbXB0eSA9IG9wdHMuYWxsb3dFbXB0eSAmJiAhaXNJbnB1dFR5cGVDb2xvcjtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYXBwbHlPcHRpb25zKCkge1xyXG5cclxuICAgICAgICAgICAgaWYgKG9wdHMuc2hvd1BhbGV0dGVPbmx5KSB7XHJcbiAgICAgICAgICAgICAgICBvcHRzLnNob3dQYWxldHRlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdG9nZ2xlQnV0dG9uLnRleHQob3B0cy5zaG93UGFsZXR0ZU9ubHkgPyBvcHRzLnRvZ2dsZVBhbGV0dGVNb3JlVGV4dCA6IG9wdHMudG9nZ2xlUGFsZXR0ZUxlc3NUZXh0KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChvcHRzLnBhbGV0dGUpIHtcclxuICAgICAgICAgICAgICAgIHBhbGV0dGUgPSBvcHRzLnBhbGV0dGUuc2xpY2UoMCk7XHJcbiAgICAgICAgICAgICAgICBwYWxldHRlQXJyYXkgPSAkLmlzQXJyYXkocGFsZXR0ZVswXSkgPyBwYWxldHRlIDogW3BhbGV0dGVdO1xyXG4gICAgICAgICAgICAgICAgcGFsZXR0ZUxvb2t1cCA9IHt9O1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYWxldHRlQXJyYXkubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHBhbGV0dGVBcnJheVtpXS5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmdiID0gdGlueWNvbG9yKHBhbGV0dGVBcnJheVtpXVtqXSkudG9SZ2JTdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFsZXR0ZUxvb2t1cFtyZ2JdID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnRhaW5lci50b2dnbGVDbGFzcyhcInNwLWZsYXRcIiwgZmxhdCk7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lci50b2dnbGVDbGFzcyhcInNwLWlucHV0LWRpc2FibGVkXCIsICFvcHRzLnNob3dJbnB1dCk7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lci50b2dnbGVDbGFzcyhcInNwLWFscGhhLWVuYWJsZWRcIiwgb3B0cy5zaG93QWxwaGEpO1xyXG4gICAgICAgICAgICBjb250YWluZXIudG9nZ2xlQ2xhc3MoXCJzcC1jbGVhci1lbmFibGVkXCIsIGFsbG93RW1wdHkpO1xyXG4gICAgICAgICAgICBjb250YWluZXIudG9nZ2xlQ2xhc3MoXCJzcC1idXR0b25zLWRpc2FibGVkXCIsICFvcHRzLnNob3dCdXR0b25zKTtcclxuICAgICAgICAgICAgY29udGFpbmVyLnRvZ2dsZUNsYXNzKFwic3AtcGFsZXR0ZS1idXR0b25zLWRpc2FibGVkXCIsICFvcHRzLnRvZ2dsZVBhbGV0dGVPbmx5KTtcclxuICAgICAgICAgICAgY29udGFpbmVyLnRvZ2dsZUNsYXNzKFwic3AtcGFsZXR0ZS1kaXNhYmxlZFwiLCAhb3B0cy5zaG93UGFsZXR0ZSk7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lci50b2dnbGVDbGFzcyhcInNwLXBhbGV0dGUtb25seVwiLCBvcHRzLnNob3dQYWxldHRlT25seSk7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lci50b2dnbGVDbGFzcyhcInNwLWluaXRpYWwtZGlzYWJsZWRcIiwgIW9wdHMuc2hvd0luaXRpYWwpO1xyXG4gICAgICAgICAgICBjb250YWluZXIuYWRkQ2xhc3Mob3B0cy5jbGFzc05hbWUpLmFkZENsYXNzKG9wdHMuY29udGFpbmVyQ2xhc3NOYW1lKTtcclxuXHJcbiAgICAgICAgICAgIHJlZmxvdygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaW5pdGlhbGl6ZSgpIHtcclxuXHJcbiAgICAgICAgICAgIGlmIChJRSkge1xyXG4gICAgICAgICAgICAgICAgY29udGFpbmVyLmZpbmQoXCIqOm5vdChpbnB1dClcIikuYXR0cihcInVuc2VsZWN0YWJsZVwiLCBcIm9uXCIpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhcHBseU9wdGlvbnMoKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChzaG91bGRSZXBsYWNlKSB7XHJcbiAgICAgICAgICAgICAgICBib3VuZEVsZW1lbnQuYWZ0ZXIocmVwbGFjZXIpLmhpZGUoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCFhbGxvd0VtcHR5KSB7XHJcbiAgICAgICAgICAgICAgICBjbGVhckJ1dHRvbi5oaWRlKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChmbGF0KSB7XHJcbiAgICAgICAgICAgICAgICBib3VuZEVsZW1lbnQuYWZ0ZXIoY29udGFpbmVyKS5oaWRlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGFwcGVuZFRvID0gb3B0cy5hcHBlbmRUbyA9PT0gXCJwYXJlbnRcIiA/IGJvdW5kRWxlbWVudC5wYXJlbnQoKSA6ICQob3B0cy5hcHBlbmRUbyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoYXBwZW5kVG8ubGVuZ3RoICE9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXBwZW5kVG8gPSAkKFwiYm9keVwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBhcHBlbmRUby5hcHBlbmQoY29udGFpbmVyKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdXBkYXRlU2VsZWN0aW9uUGFsZXR0ZUZyb21TdG9yYWdlKCk7XHJcblxyXG4gICAgICAgICAgICBvZmZzZXRFbGVtZW50LmJpbmQoXCJjbGljay5zcGVjdHJ1bSB0b3VjaHN0YXJ0LnNwZWN0cnVtXCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWRpc2FibGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9nZ2xlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoISQoZS50YXJnZXQpLmlzKFwiaW5wdXRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYoYm91bmRFbGVtZW50LmlzKFwiOmRpc2FibGVkXCIpIHx8IChvcHRzLmRpc2FibGVkID09PSB0cnVlKSkge1xyXG4gICAgICAgICAgICAgICAgZGlzYWJsZSgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBQcmV2ZW50IGNsaWNrcyBmcm9tIGJ1YmJsaW5nIHVwIHRvIGRvY3VtZW50LiAgVGhpcyB3b3VsZCBjYXVzZSBpdCB0byBiZSBoaWRkZW4uXHJcbiAgICAgICAgICAgIGNvbnRhaW5lci5jbGljayhzdG9wUHJvcGFnYXRpb24pO1xyXG5cclxuICAgICAgICAgICAgLy8gSGFuZGxlIHVzZXIgdHlwZWQgaW5wdXRcclxuICAgICAgICAgICAgdGV4dElucHV0LmNoYW5nZShzZXRGcm9tVGV4dElucHV0KTtcclxuICAgICAgICAgICAgdGV4dElucHV0LmJpbmQoXCJwYXN0ZVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KHNldEZyb21UZXh0SW5wdXQsIDEpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGV4dElucHV0LmtleWRvd24oZnVuY3Rpb24gKGUpIHsgaWYgKGUua2V5Q29kZSA9PSAxMykgeyBzZXRGcm9tVGV4dElucHV0KCk7IH0gfSk7XHJcblxyXG4gICAgICAgICAgICBjYW5jZWxCdXR0b24udGV4dChvcHRzLmNhbmNlbFRleHQpO1xyXG4gICAgICAgICAgICBjYW5jZWxCdXR0b24uYmluZChcImNsaWNrLnNwZWN0cnVtXCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgcmV2ZXJ0KCk7XHJcbiAgICAgICAgICAgICAgICBoaWRlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY2xlYXJCdXR0b24uYXR0cihcInRpdGxlXCIsIG9wdHMuY2xlYXJUZXh0KTtcclxuICAgICAgICAgICAgY2xlYXJCdXR0b24uYmluZChcImNsaWNrLnNwZWN0cnVtXCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgaXNFbXB0eSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBtb3ZlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoZmxhdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vZm9yIHRoZSBmbGF0IHN0eWxlLCB0aGlzIGlzIGEgY2hhbmdlIGV2ZW50XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlT3JpZ2luYWxJbnB1dCh0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjaG9vc2VCdXR0b24udGV4dChvcHRzLmNob29zZVRleHQpO1xyXG4gICAgICAgICAgICBjaG9vc2VCdXR0b24uYmluZChcImNsaWNrLnNwZWN0cnVtXCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChpc1ZhbGlkKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVPcmlnaW5hbElucHV0KHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGhpZGUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB0b2dnbGVCdXR0b24udGV4dChvcHRzLnNob3dQYWxldHRlT25seSA/IG9wdHMudG9nZ2xlUGFsZXR0ZU1vcmVUZXh0IDogb3B0cy50b2dnbGVQYWxldHRlTGVzc1RleHQpO1xyXG4gICAgICAgICAgICB0b2dnbGVCdXR0b24uYmluZChcImNsaWNrLnNwZWN0cnVtXCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIG9wdHMuc2hvd1BhbGV0dGVPbmx5ID0gIW9wdHMuc2hvd1BhbGV0dGVPbmx5O1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIFRvIG1ha2Ugc3VyZSB0aGUgUGlja2VyIGFyZWEgaXMgZHJhd24gb24gdGhlIHJpZ2h0LCBuZXh0IHRvIHRoZVxyXG4gICAgICAgICAgICAgICAgLy8gUGFsZXR0ZSBhcmVhIChhbmQgbm90IGJlbG93IHRoZSBwYWxldHRlKSwgZmlyc3QgbW92ZSB0aGUgUGFsZXR0ZVxyXG4gICAgICAgICAgICAgICAgLy8gdG8gdGhlIGxlZnQgdG8gbWFrZSBzcGFjZSBmb3IgdGhlIHBpY2tlciwgcGx1cyA1cHggZXh0cmEuXHJcbiAgICAgICAgICAgICAgICAvLyBUaGUgJ2FwcGx5T3B0aW9ucycgZnVuY3Rpb24gcHV0cyB0aGUgd2hvbGUgY29udGFpbmVyIGJhY2sgaW50byBwbGFjZVxyXG4gICAgICAgICAgICAgICAgLy8gYW5kIHRha2VzIGNhcmUgb2YgdGhlIGJ1dHRvbi10ZXh0IGFuZCB0aGUgc3AtcGFsZXR0ZS1vbmx5IENTUyBjbGFzcy5cclxuICAgICAgICAgICAgICAgIGlmICghb3B0cy5zaG93UGFsZXR0ZU9ubHkgJiYgIWZsYXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuY3NzKCdsZWZ0JywgJy09JyArIChwaWNrZXJDb250YWluZXIub3V0ZXJXaWR0aCh0cnVlKSArIDUpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGFwcGx5T3B0aW9ucygpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGRyYWdnYWJsZShhbHBoYVNsaWRlciwgZnVuY3Rpb24gKGRyYWdYLCBkcmFnWSwgZSkge1xyXG4gICAgICAgICAgICAgICAgY3VycmVudEFscGhhID0gKGRyYWdYIC8gYWxwaGFXaWR0aCk7XHJcbiAgICAgICAgICAgICAgICBpc0VtcHR5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBpZiAoZS5zaGlmdEtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRBbHBoYSA9IE1hdGgucm91bmQoY3VycmVudEFscGhhICogMTApIC8gMTA7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgbW92ZSgpO1xyXG4gICAgICAgICAgICB9LCBkcmFnU3RhcnQsIGRyYWdTdG9wKTtcclxuXHJcbiAgICAgICAgICAgIGRyYWdnYWJsZShzbGlkZXIsIGZ1bmN0aW9uIChkcmFnWCwgZHJhZ1kpIHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRIdWUgPSBwYXJzZUZsb2F0KGRyYWdZIC8gc2xpZGVIZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgaXNFbXB0eSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFvcHRzLnNob3dBbHBoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRBbHBoYSA9IDE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBtb3ZlKCk7XHJcbiAgICAgICAgICAgIH0sIGRyYWdTdGFydCwgZHJhZ1N0b3ApO1xyXG5cclxuICAgICAgICAgICAgZHJhZ2dhYmxlKGRyYWdnZXIsIGZ1bmN0aW9uIChkcmFnWCwgZHJhZ1ksIGUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBzaGlmdCtkcmFnIHNob3VsZCBzbmFwIHRoZSBtb3ZlbWVudCB0byBlaXRoZXIgdGhlIHggb3IgeSBheGlzLlxyXG4gICAgICAgICAgICAgICAgaWYgKCFlLnNoaWZ0S2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hpZnRNb3ZlbWVudERpcmVjdGlvbiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmICghc2hpZnRNb3ZlbWVudERpcmVjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBvbGREcmFnWCA9IGN1cnJlbnRTYXR1cmF0aW9uICogZHJhZ1dpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBvbGREcmFnWSA9IGRyYWdIZWlnaHQgLSAoY3VycmVudFZhbHVlICogZHJhZ0hlaWdodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZ1cnRoZXJGcm9tWCA9IE1hdGguYWJzKGRyYWdYIC0gb2xkRHJhZ1gpID4gTWF0aC5hYnMoZHJhZ1kgLSBvbGREcmFnWSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHNoaWZ0TW92ZW1lbnREaXJlY3Rpb24gPSBmdXJ0aGVyRnJvbVggPyBcInhcIiA6IFwieVwiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHZhciBzZXRTYXR1cmF0aW9uID0gIXNoaWZ0TW92ZW1lbnREaXJlY3Rpb24gfHwgc2hpZnRNb3ZlbWVudERpcmVjdGlvbiA9PT0gXCJ4XCI7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2V0VmFsdWUgPSAhc2hpZnRNb3ZlbWVudERpcmVjdGlvbiB8fCBzaGlmdE1vdmVtZW50RGlyZWN0aW9uID09PSBcInlcIjtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc2V0U2F0dXJhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTYXR1cmF0aW9uID0gcGFyc2VGbG9hdChkcmFnWCAvIGRyYWdXaWR0aCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoc2V0VmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50VmFsdWUgPSBwYXJzZUZsb2F0KChkcmFnSGVpZ2h0IC0gZHJhZ1kpIC8gZHJhZ0hlaWdodCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaXNFbXB0eSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFvcHRzLnNob3dBbHBoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRBbHBoYSA9IDE7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgbW92ZSgpO1xyXG5cclxuICAgICAgICAgICAgfSwgZHJhZ1N0YXJ0LCBkcmFnU3RvcCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoISFpbml0aWFsQ29sb3IpIHtcclxuICAgICAgICAgICAgICAgIHNldChpbml0aWFsQ29sb3IpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIEluIGNhc2UgY29sb3Igd2FzIGJsYWNrIC0gdXBkYXRlIHRoZSBwcmV2aWV3IFVJIGFuZCBzZXQgdGhlIGZvcm1hdFxyXG4gICAgICAgICAgICAgICAgLy8gc2luY2UgdGhlIHNldCBmdW5jdGlvbiB3aWxsIG5vdCBydW4gKGRlZmF1bHQgY29sb3IgaXMgYmxhY2spLlxyXG4gICAgICAgICAgICAgICAgdXBkYXRlVUkoKTtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRQcmVmZXJyZWRGb3JtYXQgPSBwcmVmZXJyZWRGb3JtYXQgfHwgdGlueWNvbG9yKGluaXRpYWxDb2xvcikuZm9ybWF0O1xyXG5cclxuICAgICAgICAgICAgICAgIGFkZENvbG9yVG9TZWxlY3Rpb25QYWxldHRlKGluaXRpYWxDb2xvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGVVSSgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoZmxhdCkge1xyXG4gICAgICAgICAgICAgICAgc2hvdygpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBwYWxldHRlRWxlbWVudENsaWNrKGUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlLmRhdGEgJiYgZS5kYXRhLmlnbm9yZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldCgkKGUudGFyZ2V0KS5jbG9zZXN0KFwiLnNwLXRodW1iLWVsXCIpLmRhdGEoXCJjb2xvclwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0KCQoZS50YXJnZXQpLmNsb3Nlc3QoXCIuc3AtdGh1bWItZWxcIikuZGF0YShcImNvbG9yXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICBtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlT3JpZ2luYWxJbnB1dCh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAob3B0cy5oaWRlQWZ0ZXJQYWxldHRlU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICBoaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIHBhbGV0dGVFdmVudCA9IElFID8gXCJtb3VzZWRvd24uc3BlY3RydW1cIiA6IFwiY2xpY2suc3BlY3RydW0gdG91Y2hzdGFydC5zcGVjdHJ1bVwiO1xyXG4gICAgICAgICAgICBwYWxldHRlQ29udGFpbmVyLmRlbGVnYXRlKFwiLnNwLXRodW1iLWVsXCIsIHBhbGV0dGVFdmVudCwgcGFsZXR0ZUVsZW1lbnRDbGljayk7XHJcbiAgICAgICAgICAgIGluaXRpYWxDb2xvckNvbnRhaW5lci5kZWxlZ2F0ZShcIi5zcC10aHVtYi1lbDpudGgtY2hpbGQoMSlcIiwgcGFsZXR0ZUV2ZW50LCB7IGlnbm9yZTogdHJ1ZSB9LCBwYWxldHRlRWxlbWVudENsaWNrKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVNlbGVjdGlvblBhbGV0dGVGcm9tU3RvcmFnZSgpIHtcclxuXHJcbiAgICAgICAgICAgIGlmIChsb2NhbFN0b3JhZ2VLZXkgJiYgd2luZG93LmxvY2FsU3RvcmFnZSkge1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIE1pZ3JhdGUgb2xkIHBhbGV0dGVzIG92ZXIgdG8gbmV3IGZvcm1hdC4gIE1heSB3YW50IHRvIHJlbW92ZSB0aGlzIGV2ZW50dWFsbHkuXHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBvbGRQYWxldHRlID0gd2luZG93LmxvY2FsU3RvcmFnZVtsb2NhbFN0b3JhZ2VLZXldLnNwbGl0KFwiLCNcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9sZFBhbGV0dGUubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgd2luZG93LmxvY2FsU3RvcmFnZVtsb2NhbFN0b3JhZ2VLZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2gob2xkUGFsZXR0ZSwgZnVuY3Rpb24oaSwgYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZENvbG9yVG9TZWxlY3Rpb25QYWxldHRlKGMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaChlKSB7IH1cclxuXHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvblBhbGV0dGUgPSB3aW5kb3cubG9jYWxTdG9yYWdlW2xvY2FsU3RvcmFnZUtleV0uc3BsaXQoXCI7XCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHsgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBhZGRDb2xvclRvU2VsZWN0aW9uUGFsZXR0ZShjb2xvcikge1xyXG4gICAgICAgICAgICBpZiAoc2hvd1NlbGVjdGlvblBhbGV0dGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZ2IgPSB0aW55Y29sb3IoY29sb3IpLnRvUmdiU3RyaW5nKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXBhbGV0dGVMb29rdXBbcmdiXSAmJiAkLmluQXJyYXkocmdiLCBzZWxlY3Rpb25QYWxldHRlKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb25QYWxldHRlLnB1c2gocmdiKTtcclxuICAgICAgICAgICAgICAgICAgICB3aGlsZShzZWxlY3Rpb25QYWxldHRlLmxlbmd0aCA+IG1heFNlbGVjdGlvblNpemUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uUGFsZXR0ZS5zaGlmdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAobG9jYWxTdG9yYWdlS2V5ICYmIHdpbmRvdy5sb2NhbFN0b3JhZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlW2xvY2FsU3RvcmFnZUtleV0gPSBzZWxlY3Rpb25QYWxldHRlLmpvaW4oXCI7XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjYXRjaChlKSB7IH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0VW5pcXVlU2VsZWN0aW9uUGFsZXR0ZSgpIHtcclxuICAgICAgICAgICAgdmFyIHVuaXF1ZSA9IFtdO1xyXG4gICAgICAgICAgICBpZiAob3B0cy5zaG93UGFsZXR0ZSkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxlY3Rpb25QYWxldHRlLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJnYiA9IHRpbnljb2xvcihzZWxlY3Rpb25QYWxldHRlW2ldKS50b1JnYlN0cmluZygpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXBhbGV0dGVMb29rdXBbcmdiXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1bmlxdWUucHVzaChzZWxlY3Rpb25QYWxldHRlW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1bmlxdWUucmV2ZXJzZSgpLnNsaWNlKDAsIG9wdHMubWF4U2VsZWN0aW9uU2l6ZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBkcmF3UGFsZXR0ZSgpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBjdXJyZW50Q29sb3IgPSBnZXQoKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBodG1sID0gJC5tYXAocGFsZXR0ZUFycmF5LCBmdW5jdGlvbiAocGFsZXR0ZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhbGV0dGVUZW1wbGF0ZShwYWxldHRlLCBjdXJyZW50Q29sb3IsIFwic3AtcGFsZXR0ZS1yb3cgc3AtcGFsZXR0ZS1yb3ctXCIgKyBpLCBvcHRzKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB1cGRhdGVTZWxlY3Rpb25QYWxldHRlRnJvbVN0b3JhZ2UoKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChzZWxlY3Rpb25QYWxldHRlKSB7XHJcbiAgICAgICAgICAgICAgICBodG1sLnB1c2gocGFsZXR0ZVRlbXBsYXRlKGdldFVuaXF1ZVNlbGVjdGlvblBhbGV0dGUoKSwgY3VycmVudENvbG9yLCBcInNwLXBhbGV0dGUtcm93IHNwLXBhbGV0dGUtcm93LXNlbGVjdGlvblwiLCBvcHRzKSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHBhbGV0dGVDb250YWluZXIuaHRtbChodG1sLmpvaW4oXCJcIikpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZHJhd0luaXRpYWwoKSB7XHJcbiAgICAgICAgICAgIGlmIChvcHRzLnNob3dJbml0aWFsKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5pdGlhbCA9IGNvbG9yT25TaG93O1xyXG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnQgPSBnZXQoKTtcclxuICAgICAgICAgICAgICAgIGluaXRpYWxDb2xvckNvbnRhaW5lci5odG1sKHBhbGV0dGVUZW1wbGF0ZShbaW5pdGlhbCwgY3VycmVudF0sIGN1cnJlbnQsIFwic3AtcGFsZXR0ZS1yb3ctaW5pdGlhbFwiLCBvcHRzKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGRyYWdTdGFydCgpIHtcclxuICAgICAgICAgICAgaWYgKGRyYWdIZWlnaHQgPD0gMCB8fCBkcmFnV2lkdGggPD0gMCB8fCBzbGlkZUhlaWdodCA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZWZsb3coKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb250YWluZXIuYWRkQ2xhc3MoZHJhZ2dpbmdDbGFzcyk7XHJcbiAgICAgICAgICAgIHNoaWZ0TW92ZW1lbnREaXJlY3Rpb24gPSBudWxsO1xyXG4gICAgICAgICAgICBib3VuZEVsZW1lbnQudHJpZ2dlcignZHJhZ3N0YXJ0LnNwZWN0cnVtJywgWyBnZXQoKSBdKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGRyYWdTdG9wKCkge1xyXG4gICAgICAgICAgICBjb250YWluZXIucmVtb3ZlQ2xhc3MoZHJhZ2dpbmdDbGFzcyk7XHJcbiAgICAgICAgICAgIGJvdW5kRWxlbWVudC50cmlnZ2VyKCdkcmFnc3RvcC5zcGVjdHJ1bScsIFsgZ2V0KCkgXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzZXRGcm9tVGV4dElucHV0KCkge1xyXG5cclxuICAgICAgICAgICAgdmFyIHZhbHVlID0gdGV4dElucHV0LnZhbCgpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gXCJcIikgJiYgYWxsb3dFbXB0eSkge1xyXG4gICAgICAgICAgICAgICAgc2V0KG51bGwpO1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlT3JpZ2luYWxJbnB1dCh0cnVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciB0aW55ID0gdGlueWNvbG9yKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aW55LmlzVmFsaWQoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldCh0aW55KTtcclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVPcmlnaW5hbElucHV0KHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dElucHV0LmFkZENsYXNzKFwic3AtdmFsaWRhdGlvbi1lcnJvclwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdG9nZ2xlKCkge1xyXG4gICAgICAgICAgICBpZiAodmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgaGlkZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc2hvdygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzaG93KCkge1xyXG4gICAgICAgICAgICB2YXIgZXZlbnQgPSAkLkV2ZW50KCdiZWZvcmVTaG93LnNwZWN0cnVtJyk7XHJcblxyXG4gICAgICAgICAgICBpZiAodmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgcmVmbG93KCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGJvdW5kRWxlbWVudC50cmlnZ2VyKGV2ZW50LCBbIGdldCgpIF0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrcy5iZWZvcmVTaG93KGdldCgpKSA9PT0gZmFsc2UgfHwgZXZlbnQuaXNEZWZhdWx0UHJldmVudGVkKCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaGlkZUFsbCgpO1xyXG4gICAgICAgICAgICB2aXNpYmxlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgICQoZG9jKS5iaW5kKFwiY2xpY2suc3BlY3RydW1cIiwgY2xpY2tvdXQpO1xyXG4gICAgICAgICAgICAkKHdpbmRvdykuYmluZChcInJlc2l6ZS5zcGVjdHJ1bVwiLCByZXNpemUpO1xyXG4gICAgICAgICAgICByZXBsYWNlci5hZGRDbGFzcyhcInNwLWFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgY29udGFpbmVyLnJlbW92ZUNsYXNzKFwic3AtaGlkZGVuXCIpO1xyXG5cclxuICAgICAgICAgICAgcmVmbG93KCk7XHJcbiAgICAgICAgICAgIHVwZGF0ZVVJKCk7XHJcblxyXG4gICAgICAgICAgICBjb2xvck9uU2hvdyA9IGdldCgpO1xyXG5cclxuICAgICAgICAgICAgZHJhd0luaXRpYWwoKTtcclxuICAgICAgICAgICAgY2FsbGJhY2tzLnNob3coY29sb3JPblNob3cpO1xyXG4gICAgICAgICAgICBib3VuZEVsZW1lbnQudHJpZ2dlcignc2hvdy5zcGVjdHJ1bScsIFsgY29sb3JPblNob3cgXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBjbGlja291dChlKSB7XHJcbiAgICAgICAgICAgIC8vIFJldHVybiBvbiByaWdodCBjbGljay5cclxuICAgICAgICAgICAgaWYgKGUuYnV0dG9uID09IDIpIHsgcmV0dXJuOyB9XHJcblxyXG4gICAgICAgICAgICBpZiAoY2xpY2tvdXRGaXJlc0NoYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlT3JpZ2luYWxJbnB1dCh0cnVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldmVydCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGhpZGUoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGhpZGUoKSB7XHJcbiAgICAgICAgICAgIC8vIFJldHVybiBpZiBoaWRpbmcgaXMgdW5uZWNlc3NhcnlcclxuICAgICAgICAgICAgaWYgKCF2aXNpYmxlIHx8IGZsYXQpIHsgcmV0dXJuOyB9XHJcbiAgICAgICAgICAgIHZpc2libGUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICQoZG9jKS51bmJpbmQoXCJjbGljay5zcGVjdHJ1bVwiLCBjbGlja291dCk7XHJcbiAgICAgICAgICAgICQod2luZG93KS51bmJpbmQoXCJyZXNpemUuc3BlY3RydW1cIiwgcmVzaXplKTtcclxuXHJcbiAgICAgICAgICAgIHJlcGxhY2VyLnJlbW92ZUNsYXNzKFwic3AtYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBjb250YWluZXIuYWRkQ2xhc3MoXCJzcC1oaWRkZW5cIik7XHJcblxyXG4gICAgICAgICAgICBjYWxsYmFja3MuaGlkZShnZXQoKSk7XHJcbiAgICAgICAgICAgIGJvdW5kRWxlbWVudC50cmlnZ2VyKCdoaWRlLnNwZWN0cnVtJywgWyBnZXQoKSBdKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHJldmVydCgpIHtcclxuICAgICAgICAgICAgc2V0KGNvbG9yT25TaG93LCB0cnVlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNldChjb2xvciwgaWdub3JlRm9ybWF0Q2hhbmdlKSB7XHJcbiAgICAgICAgICAgIGlmICh0aW55Y29sb3IuZXF1YWxzKGNvbG9yLCBnZXQoKSkpIHtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBVSSBqdXN0IGluIGNhc2UgYSB2YWxpZGF0aW9uIGVycm9yIG5lZWRzXHJcbiAgICAgICAgICAgICAgICAvLyB0byBiZSBjbGVhcmVkLlxyXG4gICAgICAgICAgICAgICAgdXBkYXRlVUkoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIG5ld0NvbG9yLCBuZXdIc3Y7XHJcbiAgICAgICAgICAgIGlmICghY29sb3IgJiYgYWxsb3dFbXB0eSkge1xyXG4gICAgICAgICAgICAgICAgaXNFbXB0eSA9IHRydWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpc0VtcHR5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBuZXdDb2xvciA9IHRpbnljb2xvcihjb2xvcik7XHJcbiAgICAgICAgICAgICAgICBuZXdIc3YgPSBuZXdDb2xvci50b0hzdigpO1xyXG5cclxuICAgICAgICAgICAgICAgIGN1cnJlbnRIdWUgPSAobmV3SHN2LmggJSAzNjApIC8gMzYwO1xyXG4gICAgICAgICAgICAgICAgY3VycmVudFNhdHVyYXRpb24gPSBuZXdIc3YucztcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRWYWx1ZSA9IG5ld0hzdi52O1xyXG4gICAgICAgICAgICAgICAgY3VycmVudEFscGhhID0gbmV3SHN2LmE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdXBkYXRlVUkoKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChuZXdDb2xvciAmJiBuZXdDb2xvci5pc1ZhbGlkKCkgJiYgIWlnbm9yZUZvcm1hdENoYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgY3VycmVudFByZWZlcnJlZEZvcm1hdCA9IHByZWZlcnJlZEZvcm1hdCB8fCBuZXdDb2xvci5nZXRGb3JtYXQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0KG9wdHMpIHtcclxuICAgICAgICAgICAgb3B0cyA9IG9wdHMgfHwgeyB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKGFsbG93RW1wdHkgJiYgaXNFbXB0eSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0aW55Y29sb3IuZnJvbVJhdGlvKHtcclxuICAgICAgICAgICAgICAgIGg6IGN1cnJlbnRIdWUsXHJcbiAgICAgICAgICAgICAgICBzOiBjdXJyZW50U2F0dXJhdGlvbixcclxuICAgICAgICAgICAgICAgIHY6IGN1cnJlbnRWYWx1ZSxcclxuICAgICAgICAgICAgICAgIGE6IE1hdGgucm91bmQoY3VycmVudEFscGhhICogMTAwKSAvIDEwMFxyXG4gICAgICAgICAgICB9LCB7IGZvcm1hdDogb3B0cy5mb3JtYXQgfHwgY3VycmVudFByZWZlcnJlZEZvcm1hdCB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGlzVmFsaWQoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhdGV4dElucHV0Lmhhc0NsYXNzKFwic3AtdmFsaWRhdGlvbi1lcnJvclwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG1vdmUoKSB7XHJcbiAgICAgICAgICAgIHVwZGF0ZVVJKCk7XHJcblxyXG4gICAgICAgICAgICBjYWxsYmFja3MubW92ZShnZXQoKSk7XHJcbiAgICAgICAgICAgIGJvdW5kRWxlbWVudC50cmlnZ2VyKCdtb3ZlLnNwZWN0cnVtJywgWyBnZXQoKSBdKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVVJKCkge1xyXG5cclxuICAgICAgICAgICAgdGV4dElucHV0LnJlbW92ZUNsYXNzKFwic3AtdmFsaWRhdGlvbi1lcnJvclwiKTtcclxuXHJcbiAgICAgICAgICAgIHVwZGF0ZUhlbHBlckxvY2F0aW9ucygpO1xyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIGRyYWdnZXIgYmFja2dyb3VuZCBjb2xvciAoZ3JhZGllbnRzIHRha2UgY2FyZSBvZiBzYXR1cmF0aW9uIGFuZCB2YWx1ZSkuXHJcbiAgICAgICAgICAgIHZhciBmbGF0Q29sb3IgPSB0aW55Y29sb3IuZnJvbVJhdGlvKHsgaDogY3VycmVudEh1ZSwgczogMSwgdjogMSB9KTtcclxuICAgICAgICAgICAgZHJhZ2dlci5jc3MoXCJiYWNrZ3JvdW5kLWNvbG9yXCIsIGZsYXRDb2xvci50b0hleFN0cmluZygpKTtcclxuXHJcbiAgICAgICAgICAgIC8vIEdldCBhIGZvcm1hdCB0aGF0IGFscGhhIHdpbGwgYmUgaW5jbHVkZWQgaW4gKGhleCBhbmQgbmFtZXMgaWdub3JlIGFscGhhKVxyXG4gICAgICAgICAgICB2YXIgZm9ybWF0ID0gY3VycmVudFByZWZlcnJlZEZvcm1hdDtcclxuICAgICAgICAgICAgaWYgKGN1cnJlbnRBbHBoYSA8IDEgJiYgIShjdXJyZW50QWxwaGEgPT09IDAgJiYgZm9ybWF0ID09PSBcIm5hbWVcIikpIHtcclxuICAgICAgICAgICAgICAgIGlmIChmb3JtYXQgPT09IFwiaGV4XCIgfHwgZm9ybWF0ID09PSBcImhleDNcIiB8fCBmb3JtYXQgPT09IFwiaGV4NlwiIHx8IGZvcm1hdCA9PT0gXCJuYW1lXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3JtYXQgPSBcInJnYlwiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgcmVhbENvbG9yID0gZ2V0KHsgZm9ybWF0OiBmb3JtYXQgfSksXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5Q29sb3IgPSAnJztcclxuXHJcbiAgICAgICAgICAgICAvL3Jlc2V0IGJhY2tncm91bmQgaW5mbyBmb3IgcHJldmlldyBlbGVtZW50XHJcbiAgICAgICAgICAgIHByZXZpZXdFbGVtZW50LnJlbW92ZUNsYXNzKFwic3AtY2xlYXItZGlzcGxheVwiKTtcclxuICAgICAgICAgICAgcHJldmlld0VsZW1lbnQuY3NzKCdiYWNrZ3JvdW5kLWNvbG9yJywgJ3RyYW5zcGFyZW50Jyk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXJlYWxDb2xvciAmJiBhbGxvd0VtcHR5KSB7XHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGhlIHJlcGxhY2VkIGVsZW1lbnRzIGJhY2tncm91bmQgd2l0aCBpY29uIGluZGljYXRpbmcgbm8gY29sb3Igc2VsZWN0aW9uXHJcbiAgICAgICAgICAgICAgICBwcmV2aWV3RWxlbWVudC5hZGRDbGFzcyhcInNwLWNsZWFyLWRpc3BsYXlcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVhbEhleCA9IHJlYWxDb2xvci50b0hleFN0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlYWxSZ2IgPSByZWFsQ29sb3IudG9SZ2JTdHJpbmcoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGhlIHJlcGxhY2VkIGVsZW1lbnRzIGJhY2tncm91bmQgY29sb3IgKHdpdGggYWN0dWFsIHNlbGVjdGVkIGNvbG9yKVxyXG4gICAgICAgICAgICAgICAgaWYgKHJnYmFTdXBwb3J0IHx8IHJlYWxDb2xvci5hbHBoYSA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXdFbGVtZW50LmNzcyhcImJhY2tncm91bmQtY29sb3JcIiwgcmVhbFJnYik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3RWxlbWVudC5jc3MoXCJiYWNrZ3JvdW5kLWNvbG9yXCIsIFwidHJhbnNwYXJlbnRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld0VsZW1lbnQuY3NzKFwiZmlsdGVyXCIsIHJlYWxDb2xvci50b0ZpbHRlcigpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAob3B0cy5zaG93QWxwaGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmdiID0gcmVhbENvbG9yLnRvUmdiKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmdiLmEgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZWFsQWxwaGEgPSB0aW55Y29sb3IocmdiKS50b1JnYlN0cmluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBncmFkaWVudCA9IFwibGluZWFyLWdyYWRpZW50KGxlZnQsIFwiICsgcmVhbEFscGhhICsgXCIsIFwiICsgcmVhbEhleCArIFwiKVwiO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoSUUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGFTbGlkZXJJbm5lci5jc3MoXCJmaWx0ZXJcIiwgdGlueWNvbG9yKHJlYWxBbHBoYSkudG9GaWx0ZXIoeyBncmFkaWVudFR5cGU6IDEgfSwgcmVhbEhleCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGFTbGlkZXJJbm5lci5jc3MoXCJiYWNrZ3JvdW5kXCIsIFwiLXdlYmtpdC1cIiArIGdyYWRpZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGFTbGlkZXJJbm5lci5jc3MoXCJiYWNrZ3JvdW5kXCIsIFwiLW1vei1cIiArIGdyYWRpZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGFTbGlkZXJJbm5lci5jc3MoXCJiYWNrZ3JvdW5kXCIsIFwiLW1zLVwiICsgZ3JhZGllbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBVc2UgY3VycmVudCBzeW50YXggZ3JhZGllbnQgb24gdW5wcmVmaXhlZCBwcm9wZXJ0eS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGFTbGlkZXJJbm5lci5jc3MoXCJiYWNrZ3JvdW5kXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxpbmVhci1ncmFkaWVudCh0byByaWdodCwgXCIgKyByZWFsQWxwaGEgKyBcIiwgXCIgKyByZWFsSGV4ICsgXCIpXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5Q29sb3IgPSByZWFsQ29sb3IudG9TdHJpbmcoZm9ybWF0KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSB0ZXh0IGVudHJ5IGlucHV0IGFzIGl0IGNoYW5nZXMgaGFwcGVuXHJcbiAgICAgICAgICAgIGlmIChvcHRzLnNob3dJbnB1dCkge1xyXG4gICAgICAgICAgICAgICAgdGV4dElucHV0LnZhbChkaXNwbGF5Q29sb3IpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAob3B0cy5zaG93UGFsZXR0ZSkge1xyXG4gICAgICAgICAgICAgICAgZHJhd1BhbGV0dGUoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZHJhd0luaXRpYWwoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUhlbHBlckxvY2F0aW9ucygpIHtcclxuICAgICAgICAgICAgdmFyIHMgPSBjdXJyZW50U2F0dXJhdGlvbjtcclxuICAgICAgICAgICAgdmFyIHYgPSBjdXJyZW50VmFsdWU7XHJcblxyXG4gICAgICAgICAgICBpZihhbGxvd0VtcHR5ICYmIGlzRW1wdHkpIHtcclxuICAgICAgICAgICAgICAgIC8vaWYgc2VsZWN0ZWQgY29sb3IgaXMgZW1wdHksIGhpZGUgdGhlIGhlbHBlcnNcclxuICAgICAgICAgICAgICAgIGFscGhhU2xpZGVIZWxwZXIuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgc2xpZGVIZWxwZXIuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgZHJhZ0hlbHBlci5oaWRlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvL21ha2Ugc3VyZSBoZWxwZXJzIGFyZSB2aXNpYmxlXHJcbiAgICAgICAgICAgICAgICBhbHBoYVNsaWRlSGVscGVyLnNob3coKTtcclxuICAgICAgICAgICAgICAgIHNsaWRlSGVscGVyLnNob3coKTtcclxuICAgICAgICAgICAgICAgIGRyYWdIZWxwZXIuc2hvdygpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIFdoZXJlIHRvIHNob3cgdGhlIGxpdHRsZSBjaXJjbGUgaW4gdGhhdCBkaXNwbGF5cyB5b3VyIGN1cnJlbnQgc2VsZWN0ZWQgY29sb3JcclxuICAgICAgICAgICAgICAgIHZhciBkcmFnWCA9IHMgKiBkcmFnV2lkdGg7XHJcbiAgICAgICAgICAgICAgICB2YXIgZHJhZ1kgPSBkcmFnSGVpZ2h0IC0gKHYgKiBkcmFnSGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgIGRyYWdYID0gTWF0aC5tYXgoXHJcbiAgICAgICAgICAgICAgICAgICAgLWRyYWdIZWxwZXJIZWlnaHQsXHJcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5taW4oZHJhZ1dpZHRoIC0gZHJhZ0hlbHBlckhlaWdodCwgZHJhZ1ggLSBkcmFnSGVscGVySGVpZ2h0KVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIGRyYWdZID0gTWF0aC5tYXgoXHJcbiAgICAgICAgICAgICAgICAgICAgLWRyYWdIZWxwZXJIZWlnaHQsXHJcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5taW4oZHJhZ0hlaWdodCAtIGRyYWdIZWxwZXJIZWlnaHQsIGRyYWdZIC0gZHJhZ0hlbHBlckhlaWdodClcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICBkcmFnSGVscGVyLmNzcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJ0b3BcIjogZHJhZ1kgKyBcInB4XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCI6IGRyYWdYICsgXCJweFwiXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgYWxwaGFYID0gY3VycmVudEFscGhhICogYWxwaGFXaWR0aDtcclxuICAgICAgICAgICAgICAgIGFscGhhU2xpZGVIZWxwZXIuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICBcImxlZnRcIjogKGFscGhhWCAtIChhbHBoYVNsaWRlSGVscGVyV2lkdGggLyAyKSkgKyBcInB4XCJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIFdoZXJlIHRvIHNob3cgdGhlIGJhciB0aGF0IGRpc3BsYXlzIHlvdXIgY3VycmVudCBzZWxlY3RlZCBodWVcclxuICAgICAgICAgICAgICAgIHZhciBzbGlkZVkgPSAoY3VycmVudEh1ZSkgKiBzbGlkZUhlaWdodDtcclxuICAgICAgICAgICAgICAgIHNsaWRlSGVscGVyLmNzcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJ0b3BcIjogKHNsaWRlWSAtIHNsaWRlSGVscGVySGVpZ2h0KSArIFwicHhcIlxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZU9yaWdpbmFsSW5wdXQoZmlyZUNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIHZhciBjb2xvciA9IGdldCgpLFxyXG4gICAgICAgICAgICAgICAgZGlzcGxheUNvbG9yID0gJycsXHJcbiAgICAgICAgICAgICAgICBoYXNDaGFuZ2VkID0gIXRpbnljb2xvci5lcXVhbHMoY29sb3IsIGNvbG9yT25TaG93KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjb2xvcikge1xyXG4gICAgICAgICAgICAgICAgZGlzcGxheUNvbG9yID0gY29sb3IudG9TdHJpbmcoY3VycmVudFByZWZlcnJlZEZvcm1hdCk7XHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGhlIHNlbGVjdGlvbiBwYWxldHRlIHdpdGggdGhlIGN1cnJlbnQgY29sb3JcclxuICAgICAgICAgICAgICAgIGFkZENvbG9yVG9TZWxlY3Rpb25QYWxldHRlKGNvbG9yKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGlzSW5wdXQpIHtcclxuICAgICAgICAgICAgICAgIGJvdW5kRWxlbWVudC52YWwoZGlzcGxheUNvbG9yKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGZpcmVDYWxsYmFjayAmJiBoYXNDaGFuZ2VkKSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFja3MuY2hhbmdlKGNvbG9yKTtcclxuICAgICAgICAgICAgICAgIGJvdW5kRWxlbWVudC50cmlnZ2VyKCdjaGFuZ2UnLCBbIGNvbG9yIF0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiByZWZsb3coKSB7XHJcbiAgICAgICAgICAgIGRyYWdXaWR0aCA9IGRyYWdnZXIud2lkdGgoKTtcclxuICAgICAgICAgICAgZHJhZ0hlaWdodCA9IGRyYWdnZXIuaGVpZ2h0KCk7XHJcbiAgICAgICAgICAgIGRyYWdIZWxwZXJIZWlnaHQgPSBkcmFnSGVscGVyLmhlaWdodCgpO1xyXG4gICAgICAgICAgICBzbGlkZVdpZHRoID0gc2xpZGVyLndpZHRoKCk7XHJcbiAgICAgICAgICAgIHNsaWRlSGVpZ2h0ID0gc2xpZGVyLmhlaWdodCgpO1xyXG4gICAgICAgICAgICBzbGlkZUhlbHBlckhlaWdodCA9IHNsaWRlSGVscGVyLmhlaWdodCgpO1xyXG4gICAgICAgICAgICBhbHBoYVdpZHRoID0gYWxwaGFTbGlkZXIud2lkdGgoKTtcclxuICAgICAgICAgICAgYWxwaGFTbGlkZUhlbHBlcldpZHRoID0gYWxwaGFTbGlkZUhlbHBlci53aWR0aCgpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFmbGF0KSB7XHJcbiAgICAgICAgICAgICAgICBjb250YWluZXIuY3NzKFwicG9zaXRpb25cIiwgXCJhYnNvbHV0ZVwiKTtcclxuICAgICAgICAgICAgICAgIGlmIChvcHRzLm9mZnNldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5vZmZzZXQob3B0cy5vZmZzZXQpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250YWluZXIub2Zmc2V0KGdldE9mZnNldChjb250YWluZXIsIG9mZnNldEVsZW1lbnQpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdXBkYXRlSGVscGVyTG9jYXRpb25zKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAob3B0cy5zaG93UGFsZXR0ZSkge1xyXG4gICAgICAgICAgICAgICAgZHJhd1BhbGV0dGUoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYm91bmRFbGVtZW50LnRyaWdnZXIoJ3JlZmxvdy5zcGVjdHJ1bScpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZGVzdHJveSgpIHtcclxuICAgICAgICAgICAgYm91bmRFbGVtZW50LnNob3coKTtcclxuICAgICAgICAgICAgb2Zmc2V0RWxlbWVudC51bmJpbmQoXCJjbGljay5zcGVjdHJ1bSB0b3VjaHN0YXJ0LnNwZWN0cnVtXCIpO1xyXG4gICAgICAgICAgICBjb250YWluZXIucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIHJlcGxhY2VyLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICBzcGVjdHJ1bXNbc3BlY3QuaWRdID0gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG9wdGlvbihvcHRpb25OYW1lLCBvcHRpb25WYWx1ZSkge1xyXG4gICAgICAgICAgICBpZiAob3B0aW9uTmFtZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJC5leHRlbmQoe30sIG9wdHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChvcHRpb25WYWx1ZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gb3B0c1tvcHRpb25OYW1lXTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgb3B0c1tvcHRpb25OYW1lXSA9IG9wdGlvblZhbHVlO1xyXG4gICAgICAgICAgICBhcHBseU9wdGlvbnMoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGVuYWJsZSgpIHtcclxuICAgICAgICAgICAgZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgYm91bmRFbGVtZW50LmF0dHIoXCJkaXNhYmxlZFwiLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIG9mZnNldEVsZW1lbnQucmVtb3ZlQ2xhc3MoXCJzcC1kaXNhYmxlZFwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGRpc2FibGUoKSB7XHJcbiAgICAgICAgICAgIGhpZGUoKTtcclxuICAgICAgICAgICAgZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICBib3VuZEVsZW1lbnQuYXR0cihcImRpc2FibGVkXCIsIHRydWUpO1xyXG4gICAgICAgICAgICBvZmZzZXRFbGVtZW50LmFkZENsYXNzKFwic3AtZGlzYWJsZWRcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzZXRPZmZzZXQoY29vcmQpIHtcclxuICAgICAgICAgICAgb3B0cy5vZmZzZXQgPSBjb29yZDtcclxuICAgICAgICAgICAgcmVmbG93KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpbml0aWFsaXplKCk7XHJcblxyXG4gICAgICAgIHZhciBzcGVjdCA9IHtcclxuICAgICAgICAgICAgc2hvdzogc2hvdyxcclxuICAgICAgICAgICAgaGlkZTogaGlkZSxcclxuICAgICAgICAgICAgdG9nZ2xlOiB0b2dnbGUsXHJcbiAgICAgICAgICAgIHJlZmxvdzogcmVmbG93LFxyXG4gICAgICAgICAgICBvcHRpb246IG9wdGlvbixcclxuICAgICAgICAgICAgZW5hYmxlOiBlbmFibGUsXHJcbiAgICAgICAgICAgIGRpc2FibGU6IGRpc2FibGUsXHJcbiAgICAgICAgICAgIG9mZnNldDogc2V0T2Zmc2V0LFxyXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgICAgICBzZXQoYyk7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGVPcmlnaW5hbElucHV0KCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGdldDogZ2V0LFxyXG4gICAgICAgICAgICBkZXN0cm95OiBkZXN0cm95LFxyXG4gICAgICAgICAgICBjb250YWluZXI6IGNvbnRhaW5lclxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHNwZWN0LmlkID0gc3BlY3RydW1zLnB1c2goc3BlY3QpIC0gMTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHNwZWN0O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgKiBjaGVja09mZnNldCAtIGdldCB0aGUgb2Zmc2V0IGJlbG93L2Fib3ZlIGFuZCBsZWZ0L3JpZ2h0IGVsZW1lbnQgZGVwZW5kaW5nIG9uIHNjcmVlbiBwb3NpdGlvblxyXG4gICAgKiBUaGFua3MgaHR0cHM6Ly9naXRodWIuY29tL2pxdWVyeS9qcXVlcnktdWkvYmxvYi9tYXN0ZXIvdWkvanF1ZXJ5LnVpLmRhdGVwaWNrZXIuanNcclxuICAgICovXHJcbiAgICBmdW5jdGlvbiBnZXRPZmZzZXQocGlja2VyLCBpbnB1dCkge1xyXG4gICAgICAgIHZhciBleHRyYVkgPSAwO1xyXG4gICAgICAgIHZhciBkcFdpZHRoID0gcGlja2VyLm91dGVyV2lkdGgoKTtcclxuICAgICAgICB2YXIgZHBIZWlnaHQgPSBwaWNrZXIub3V0ZXJIZWlnaHQoKTtcclxuICAgICAgICB2YXIgaW5wdXRIZWlnaHQgPSBpbnB1dC5vdXRlckhlaWdodCgpO1xyXG4gICAgICAgIHZhciBkb2MgPSBwaWNrZXJbMF0ub3duZXJEb2N1bWVudDtcclxuICAgICAgICB2YXIgZG9jRWxlbSA9IGRvYy5kb2N1bWVudEVsZW1lbnQ7XHJcbiAgICAgICAgdmFyIHZpZXdXaWR0aCA9IGRvY0VsZW0uY2xpZW50V2lkdGggKyAkKGRvYykuc2Nyb2xsTGVmdCgpO1xyXG4gICAgICAgIHZhciB2aWV3SGVpZ2h0ID0gZG9jRWxlbS5jbGllbnRIZWlnaHQgKyAkKGRvYykuc2Nyb2xsVG9wKCk7XHJcbiAgICAgICAgdmFyIG9mZnNldCA9IGlucHV0Lm9mZnNldCgpO1xyXG4gICAgICAgIG9mZnNldC50b3AgKz0gaW5wdXRIZWlnaHQ7XHJcblxyXG4gICAgICAgIG9mZnNldC5sZWZ0IC09XHJcbiAgICAgICAgICAgIE1hdGgubWluKG9mZnNldC5sZWZ0LCAob2Zmc2V0LmxlZnQgKyBkcFdpZHRoID4gdmlld1dpZHRoICYmIHZpZXdXaWR0aCA+IGRwV2lkdGgpID9cclxuICAgICAgICAgICAgTWF0aC5hYnMob2Zmc2V0LmxlZnQgKyBkcFdpZHRoIC0gdmlld1dpZHRoKSA6IDApO1xyXG5cclxuICAgICAgICBvZmZzZXQudG9wIC09XHJcbiAgICAgICAgICAgIE1hdGgubWluKG9mZnNldC50b3AsICgob2Zmc2V0LnRvcCArIGRwSGVpZ2h0ID4gdmlld0hlaWdodCAmJiB2aWV3SGVpZ2h0ID4gZHBIZWlnaHQpID9cclxuICAgICAgICAgICAgTWF0aC5hYnMoZHBIZWlnaHQgKyBpbnB1dEhlaWdodCAtIGV4dHJhWSkgOiBleHRyYVkpKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIG9mZnNldDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICogbm9vcCAtIGRvIG5vdGhpbmdcclxuICAgICovXHJcbiAgICBmdW5jdGlvbiBub29wKCkge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICogc3RvcFByb3BhZ2F0aW9uIC0gbWFrZXMgdGhlIGNvZGUgb25seSBkb2luZyB0aGlzIGEgbGl0dGxlIGVhc2llciB0byByZWFkIGluIGxpbmVcclxuICAgICovXHJcbiAgICBmdW5jdGlvbiBzdG9wUHJvcGFnYXRpb24oZSkge1xyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAqIENyZWF0ZSBhIGZ1bmN0aW9uIGJvdW5kIHRvIGEgZ2l2ZW4gb2JqZWN0XHJcbiAgICAqIFRoYW5rcyB0byB1bmRlcnNjb3JlLmpzXHJcbiAgICAqL1xyXG4gICAgZnVuY3Rpb24gYmluZChmdW5jLCBvYmopIHtcclxuICAgICAgICB2YXIgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMik7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmMuYXBwbHkob2JqLCBhcmdzLmNvbmNhdChzbGljZS5jYWxsKGFyZ3VtZW50cykpKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgKiBMaWdodHdlaWdodCBkcmFnIGhlbHBlci4gIEhhbmRsZXMgY29udGFpbm1lbnQgd2l0aGluIHRoZSBlbGVtZW50LCBzbyB0aGF0XHJcbiAgICAqIHdoZW4gZHJhZ2dpbmcsIHRoZSB4IGlzIHdpdGhpbiBbMCxlbGVtZW50LndpZHRoXSBhbmQgeSBpcyB3aXRoaW4gWzAsZWxlbWVudC5oZWlnaHRdXHJcbiAgICAqL1xyXG4gICAgZnVuY3Rpb24gZHJhZ2dhYmxlKGVsZW1lbnQsIG9ubW92ZSwgb25zdGFydCwgb25zdG9wKSB7XHJcbiAgICAgICAgb25tb3ZlID0gb25tb3ZlIHx8IGZ1bmN0aW9uICgpIHsgfTtcclxuICAgICAgICBvbnN0YXJ0ID0gb25zdGFydCB8fCBmdW5jdGlvbiAoKSB7IH07XHJcbiAgICAgICAgb25zdG9wID0gb25zdG9wIHx8IGZ1bmN0aW9uICgpIHsgfTtcclxuICAgICAgICB2YXIgZG9jID0gZG9jdW1lbnQ7XHJcbiAgICAgICAgdmFyIGRyYWdnaW5nID0gZmFsc2U7XHJcbiAgICAgICAgdmFyIG9mZnNldCA9IHt9O1xyXG4gICAgICAgIHZhciBtYXhIZWlnaHQgPSAwO1xyXG4gICAgICAgIHZhciBtYXhXaWR0aCA9IDA7XHJcbiAgICAgICAgdmFyIGhhc1RvdWNoID0gKCdvbnRvdWNoc3RhcnQnIGluIHdpbmRvdyk7XHJcblxyXG4gICAgICAgIHZhciBkdXJpbmdEcmFnRXZlbnRzID0ge307XHJcbiAgICAgICAgZHVyaW5nRHJhZ0V2ZW50c1tcInNlbGVjdHN0YXJ0XCJdID0gcHJldmVudDtcclxuICAgICAgICBkdXJpbmdEcmFnRXZlbnRzW1wiZHJhZ3N0YXJ0XCJdID0gcHJldmVudDtcclxuICAgICAgICBkdXJpbmdEcmFnRXZlbnRzW1widG91Y2htb3ZlIG1vdXNlbW92ZVwiXSA9IG1vdmU7XHJcbiAgICAgICAgZHVyaW5nRHJhZ0V2ZW50c1tcInRvdWNoZW5kIG1vdXNldXBcIl0gPSBzdG9wO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBwcmV2ZW50KGUpIHtcclxuICAgICAgICAgICAgaWYgKGUuc3RvcFByb3BhZ2F0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChlLnByZXZlbnREZWZhdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZS5yZXR1cm5WYWx1ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbW92ZShlKSB7XHJcbiAgICAgICAgICAgIGlmIChkcmFnZ2luZykge1xyXG4gICAgICAgICAgICAgICAgLy8gTW91c2V1cCBoYXBwZW5lZCBvdXRzaWRlIG9mIHdpbmRvd1xyXG4gICAgICAgICAgICAgICAgaWYgKElFICYmIGRvYy5kb2N1bWVudE1vZGUgPCA5ICYmICFlLmJ1dHRvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdG9wKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHRvdWNoZXMgPSBlLm9yaWdpbmFsRXZlbnQgJiYgZS5vcmlnaW5hbEV2ZW50LnRvdWNoZXM7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGFnZVggPSB0b3VjaGVzID8gdG91Y2hlc1swXS5wYWdlWCA6IGUucGFnZVg7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGFnZVkgPSB0b3VjaGVzID8gdG91Y2hlc1swXS5wYWdlWSA6IGUucGFnZVk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGRyYWdYID0gTWF0aC5tYXgoMCwgTWF0aC5taW4ocGFnZVggLSBvZmZzZXQubGVmdCwgbWF4V2lkdGgpKTtcclxuICAgICAgICAgICAgICAgIHZhciBkcmFnWSA9IE1hdGgubWF4KDAsIE1hdGgubWluKHBhZ2VZIC0gb2Zmc2V0LnRvcCwgbWF4SGVpZ2h0KSk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGhhc1RvdWNoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gU3RvcCBzY3JvbGxpbmcgaW4gaU9TXHJcbiAgICAgICAgICAgICAgICAgICAgcHJldmVudChlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBvbm1vdmUuYXBwbHkoZWxlbWVudCwgW2RyYWdYLCBkcmFnWSwgZV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzdGFydChlKSB7XHJcbiAgICAgICAgICAgIHZhciByaWdodGNsaWNrID0gKGUud2hpY2gpID8gKGUud2hpY2ggPT0gMykgOiAoZS5idXR0b24gPT0gMik7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXJpZ2h0Y2xpY2sgJiYgIWRyYWdnaW5nKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAob25zdGFydC5hcHBseShlbGVtZW50LCBhcmd1bWVudHMpICE9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRyYWdnaW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBtYXhIZWlnaHQgPSAkKGVsZW1lbnQpLmhlaWdodCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIG1heFdpZHRoID0gJChlbGVtZW50KS53aWR0aCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldCA9ICQoZWxlbWVudCkub2Zmc2V0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICQoZG9jKS5iaW5kKGR1cmluZ0RyYWdFdmVudHMpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoZG9jLmJvZHkpLmFkZENsYXNzKFwic3AtZHJhZ2dpbmdcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaGFzVG91Y2gpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW92ZShlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZlbnQoZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHN0b3AoKSB7XHJcbiAgICAgICAgICAgIGlmIChkcmFnZ2luZykge1xyXG4gICAgICAgICAgICAgICAgJChkb2MpLnVuYmluZChkdXJpbmdEcmFnRXZlbnRzKTtcclxuICAgICAgICAgICAgICAgICQoZG9jLmJvZHkpLnJlbW92ZUNsYXNzKFwic3AtZHJhZ2dpbmdcIik7XHJcbiAgICAgICAgICAgICAgICBvbnN0b3AuYXBwbHkoZWxlbWVudCwgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBkcmFnZ2luZyA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJChlbGVtZW50KS5iaW5kKFwidG91Y2hzdGFydCBtb3VzZWRvd25cIiwgc3RhcnQpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHRocm90dGxlKGZ1bmMsIHdhaXQsIGRlYm91bmNlKSB7XHJcbiAgICAgICAgdmFyIHRpbWVvdXQ7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzLCBhcmdzID0gYXJndW1lbnRzO1xyXG4gICAgICAgICAgICB2YXIgdGhyb3R0bGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdGltZW91dCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpZiAoZGVib3VuY2UpIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcclxuICAgICAgICAgICAgaWYgKGRlYm91bmNlIHx8ICF0aW1lb3V0KSB0aW1lb3V0ID0gc2V0VGltZW91dCh0aHJvdHRsZXIsIHdhaXQpO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAqIERlZmluZSBhIGpRdWVyeSBwbHVnaW5cclxuICAgICovXHJcbiAgICB2YXIgZGF0YUlEID0gXCJzcGVjdHJ1bS5pZFwiO1xyXG4gICAgJC5mbi5zcGVjdHJ1bSA9IGZ1bmN0aW9uIChvcHRzLCBleHRyYSkge1xyXG5cclxuICAgICAgICBpZiAodHlwZW9mIG9wdHMgPT0gXCJzdHJpbmdcIikge1xyXG5cclxuICAgICAgICAgICAgdmFyIHJldHVyblZhbHVlID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCggYXJndW1lbnRzLCAxICk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNwZWN0ID0gc3BlY3RydW1zWyQodGhpcykuZGF0YShkYXRhSUQpXTtcclxuICAgICAgICAgICAgICAgIGlmIChzcGVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtZXRob2QgPSBzcGVjdFtvcHRzXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW1ldGhvZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIFwiU3BlY3RydW06IG5vIHN1Y2ggbWV0aG9kOiAnXCIgKyBvcHRzICsgXCInXCIgKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRzID09IFwiZ2V0XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuVmFsdWUgPSBzcGVjdC5nZXQoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAob3B0cyA9PSBcImNvbnRhaW5lclwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblZhbHVlID0gc3BlY3QuY29udGFpbmVyO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChvcHRzID09IFwib3B0aW9uXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuVmFsdWUgPSBzcGVjdC5vcHRpb24uYXBwbHkoc3BlY3QsIGFyZ3MpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChvcHRzID09IFwiZGVzdHJveVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNwZWN0LmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVEYXRhKGRhdGFJRCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2QuYXBwbHkoc3BlY3QsIGFyZ3MpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcmV0dXJuVmFsdWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBJbml0aWFsaXppbmcgYSBuZXcgaW5zdGFuY2Ugb2Ygc3BlY3RydW1cclxuICAgICAgICByZXR1cm4gdGhpcy5zcGVjdHJ1bShcImRlc3Ryb3lcIikuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gJC5leHRlbmQoe30sIG9wdHMsICQodGhpcykuZGF0YSgpKTtcclxuICAgICAgICAgICAgdmFyIHNwZWN0ID0gc3BlY3RydW0odGhpcywgb3B0aW9ucyk7XHJcbiAgICAgICAgICAgICQodGhpcykuZGF0YShkYXRhSUQsIHNwZWN0LmlkKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgJC5mbi5zcGVjdHJ1bS5sb2FkID0gdHJ1ZTtcclxuICAgICQuZm4uc3BlY3RydW0ubG9hZE9wdHMgPSB7fTtcclxuICAgICQuZm4uc3BlY3RydW0uZHJhZ2dhYmxlID0gZHJhZ2dhYmxlO1xyXG4gICAgJC5mbi5zcGVjdHJ1bS5kZWZhdWx0cyA9IGRlZmF1bHRPcHRzO1xyXG5cclxuICAgICQuc3BlY3RydW0gPSB7IH07XHJcbiAgICAkLnNwZWN0cnVtLmxvY2FsaXphdGlvbiA9IHsgfTtcclxuICAgICQuc3BlY3RydW0ucGFsZXR0ZXMgPSB7IH07XHJcblxyXG4gICAgJC5mbi5zcGVjdHJ1bS5wcm9jZXNzTmF0aXZlQ29sb3JJbnB1dHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCFpbnB1dFR5cGVDb2xvclN1cHBvcnQpIHtcclxuICAgICAgICAgICAgJChcImlucHV0W3R5cGU9Y29sb3JdXCIpLnNwZWN0cnVtKHtcclxuICAgICAgICAgICAgICAgIHByZWZlcnJlZEZvcm1hdDogXCJoZXg2XCJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBUaW55Q29sb3IgdjEuMS4xXHJcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vYmdyaW5zL1RpbnlDb2xvclxyXG4gICAgLy8gQnJpYW4gR3JpbnN0ZWFkLCBNSVQgTGljZW5zZVxyXG5cclxuICAgIChmdW5jdGlvbigpIHtcclxuXHJcbiAgICB2YXIgdHJpbUxlZnQgPSAvXltcXHMsI10rLyxcclxuICAgICAgICB0cmltUmlnaHQgPSAvXFxzKyQvLFxyXG4gICAgICAgIHRpbnlDb3VudGVyID0gMCxcclxuICAgICAgICBtYXRoID0gTWF0aCxcclxuICAgICAgICBtYXRoUm91bmQgPSBtYXRoLnJvdW5kLFxyXG4gICAgICAgIG1hdGhNaW4gPSBtYXRoLm1pbixcclxuICAgICAgICBtYXRoTWF4ID0gbWF0aC5tYXgsXHJcbiAgICAgICAgbWF0aFJhbmRvbSA9IG1hdGgucmFuZG9tO1xyXG5cclxuICAgIHZhciB0aW55Y29sb3IgPSBmdW5jdGlvbiB0aW55Y29sb3IgKGNvbG9yLCBvcHRzKSB7XHJcblxyXG4gICAgICAgIGNvbG9yID0gKGNvbG9yKSA/IGNvbG9yIDogJyc7XHJcbiAgICAgICAgb3B0cyA9IG9wdHMgfHwgeyB9O1xyXG5cclxuICAgICAgICAvLyBJZiBpbnB1dCBpcyBhbHJlYWR5IGEgdGlueWNvbG9yLCByZXR1cm4gaXRzZWxmXHJcbiAgICAgICAgaWYgKGNvbG9yIGluc3RhbmNlb2YgdGlueWNvbG9yKSB7XHJcbiAgICAgICAgICAgcmV0dXJuIGNvbG9yO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBJZiB3ZSBhcmUgY2FsbGVkIGFzIGEgZnVuY3Rpb24sIGNhbGwgdXNpbmcgbmV3IGluc3RlYWRcclxuICAgICAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgdGlueWNvbG9yKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IHRpbnljb2xvcihjb2xvciwgb3B0cyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgcmdiID0gaW5wdXRUb1JHQihjb2xvcik7XHJcbiAgICAgICAgdGhpcy5fb3JpZ2luYWxJbnB1dCA9IGNvbG9yLFxyXG4gICAgICAgIHRoaXMuX3IgPSByZ2IucixcclxuICAgICAgICB0aGlzLl9nID0gcmdiLmcsXHJcbiAgICAgICAgdGhpcy5fYiA9IHJnYi5iLFxyXG4gICAgICAgIHRoaXMuX2EgPSByZ2IuYSxcclxuICAgICAgICB0aGlzLl9yb3VuZEEgPSBtYXRoUm91bmQoMTAwKnRoaXMuX2EpIC8gMTAwLFxyXG4gICAgICAgIHRoaXMuX2Zvcm1hdCA9IG9wdHMuZm9ybWF0IHx8IHJnYi5mb3JtYXQ7XHJcbiAgICAgICAgdGhpcy5fZ3JhZGllbnRUeXBlID0gb3B0cy5ncmFkaWVudFR5cGU7XHJcblxyXG4gICAgICAgIC8vIERvbid0IGxldCB0aGUgcmFuZ2Ugb2YgWzAsMjU1XSBjb21lIGJhY2sgaW4gWzAsMV0uXHJcbiAgICAgICAgLy8gUG90ZW50aWFsbHkgbG9zZSBhIGxpdHRsZSBiaXQgb2YgcHJlY2lzaW9uIGhlcmUsIGJ1dCB3aWxsIGZpeCBpc3N1ZXMgd2hlcmVcclxuICAgICAgICAvLyAuNSBnZXRzIGludGVycHJldGVkIGFzIGhhbGYgb2YgdGhlIHRvdGFsLCBpbnN0ZWFkIG9mIGhhbGYgb2YgMVxyXG4gICAgICAgIC8vIElmIGl0IHdhcyBzdXBwb3NlZCB0byBiZSAxMjgsIHRoaXMgd2FzIGFscmVhZHkgdGFrZW4gY2FyZSBvZiBieSBgaW5wdXRUb1JnYmBcclxuICAgICAgICBpZiAodGhpcy5fciA8IDEpIHsgdGhpcy5fciA9IG1hdGhSb3VuZCh0aGlzLl9yKTsgfVxyXG4gICAgICAgIGlmICh0aGlzLl9nIDwgMSkgeyB0aGlzLl9nID0gbWF0aFJvdW5kKHRoaXMuX2cpOyB9XHJcbiAgICAgICAgaWYgKHRoaXMuX2IgPCAxKSB7IHRoaXMuX2IgPSBtYXRoUm91bmQodGhpcy5fYik7IH1cclxuXHJcbiAgICAgICAgdGhpcy5fb2sgPSByZ2Iub2s7XHJcbiAgICAgICAgdGhpcy5fdGNfaWQgPSB0aW55Q291bnRlcisrO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aW55Y29sb3IucHJvdG90eXBlID0ge1xyXG4gICAgICAgIGlzRGFyazogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEJyaWdodG5lc3MoKSA8IDEyODtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGlzTGlnaHQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gIXRoaXMuaXNEYXJrKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBpc1ZhbGlkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29rO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2V0T3JpZ2luYWxJbnB1dDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICByZXR1cm4gdGhpcy5fb3JpZ2luYWxJbnB1dDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldEZvcm1hdDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9mb3JtYXQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXRBbHBoYTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2V0QnJpZ2h0bmVzczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciByZ2IgPSB0aGlzLnRvUmdiKCk7XHJcbiAgICAgICAgICAgIHJldHVybiAocmdiLnIgKiAyOTkgKyByZ2IuZyAqIDU4NyArIHJnYi5iICogMTE0KSAvIDEwMDA7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXRBbHBoYTogZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5fYSA9IGJvdW5kQWxwaGEodmFsdWUpO1xyXG4gICAgICAgICAgICB0aGlzLl9yb3VuZEEgPSBtYXRoUm91bmQoMTAwKnRoaXMuX2EpIC8gMTAwO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRvSHN2OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGhzdiA9IHJnYlRvSHN2KHRoaXMuX3IsIHRoaXMuX2csIHRoaXMuX2IpO1xyXG4gICAgICAgICAgICByZXR1cm4geyBoOiBoc3YuaCAqIDM2MCwgczogaHN2LnMsIHY6IGhzdi52LCBhOiB0aGlzLl9hIH07XHJcbiAgICAgICAgfSxcclxuICAgICAgICB0b0hzdlN0cmluZzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBoc3YgPSByZ2JUb0hzdih0aGlzLl9yLCB0aGlzLl9nLCB0aGlzLl9iKTtcclxuICAgICAgICAgICAgdmFyIGggPSBtYXRoUm91bmQoaHN2LmggKiAzNjApLCBzID0gbWF0aFJvdW5kKGhzdi5zICogMTAwKSwgdiA9IG1hdGhSb3VuZChoc3YudiAqIDEwMCk7XHJcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5fYSA9PSAxKSA/XHJcbiAgICAgICAgICAgICAgXCJoc3YoXCIgICsgaCArIFwiLCBcIiArIHMgKyBcIiUsIFwiICsgdiArIFwiJSlcIiA6XHJcbiAgICAgICAgICAgICAgXCJoc3ZhKFwiICsgaCArIFwiLCBcIiArIHMgKyBcIiUsIFwiICsgdiArIFwiJSwgXCIrIHRoaXMuX3JvdW5kQSArIFwiKVwiO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdG9Ic2w6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgaHNsID0gcmdiVG9Ic2wodGhpcy5fciwgdGhpcy5fZywgdGhpcy5fYik7XHJcbiAgICAgICAgICAgIHJldHVybiB7IGg6IGhzbC5oICogMzYwLCBzOiBoc2wucywgbDogaHNsLmwsIGE6IHRoaXMuX2EgfTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRvSHNsU3RyaW5nOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGhzbCA9IHJnYlRvSHNsKHRoaXMuX3IsIHRoaXMuX2csIHRoaXMuX2IpO1xyXG4gICAgICAgICAgICB2YXIgaCA9IG1hdGhSb3VuZChoc2wuaCAqIDM2MCksIHMgPSBtYXRoUm91bmQoaHNsLnMgKiAxMDApLCBsID0gbWF0aFJvdW5kKGhzbC5sICogMTAwKTtcclxuICAgICAgICAgICAgcmV0dXJuICh0aGlzLl9hID09IDEpID9cclxuICAgICAgICAgICAgICBcImhzbChcIiAgKyBoICsgXCIsIFwiICsgcyArIFwiJSwgXCIgKyBsICsgXCIlKVwiIDpcclxuICAgICAgICAgICAgICBcImhzbGEoXCIgKyBoICsgXCIsIFwiICsgcyArIFwiJSwgXCIgKyBsICsgXCIlLCBcIisgdGhpcy5fcm91bmRBICsgXCIpXCI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICB0b0hleDogZnVuY3Rpb24oYWxsb3czQ2hhcikge1xyXG4gICAgICAgICAgICByZXR1cm4gcmdiVG9IZXgodGhpcy5fciwgdGhpcy5fZywgdGhpcy5fYiwgYWxsb3czQ2hhcik7XHJcbiAgICAgICAgfSxcclxuICAgICAgICB0b0hleFN0cmluZzogZnVuY3Rpb24oYWxsb3czQ2hhcikge1xyXG4gICAgICAgICAgICByZXR1cm4gJyMnICsgdGhpcy50b0hleChhbGxvdzNDaGFyKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRvSGV4ODogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZ2JhVG9IZXgodGhpcy5fciwgdGhpcy5fZywgdGhpcy5fYiwgdGhpcy5fYSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICB0b0hleDhTdHJpbmc6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJyMnICsgdGhpcy50b0hleDgoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRvUmdiOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgcjogbWF0aFJvdW5kKHRoaXMuX3IpLCBnOiBtYXRoUm91bmQodGhpcy5fZyksIGI6IG1hdGhSb3VuZCh0aGlzLl9iKSwgYTogdGhpcy5fYSB9O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdG9SZ2JTdHJpbmc6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gKHRoaXMuX2EgPT0gMSkgP1xyXG4gICAgICAgICAgICAgIFwicmdiKFwiICArIG1hdGhSb3VuZCh0aGlzLl9yKSArIFwiLCBcIiArIG1hdGhSb3VuZCh0aGlzLl9nKSArIFwiLCBcIiArIG1hdGhSb3VuZCh0aGlzLl9iKSArIFwiKVwiIDpcclxuICAgICAgICAgICAgICBcInJnYmEoXCIgKyBtYXRoUm91bmQodGhpcy5fcikgKyBcIiwgXCIgKyBtYXRoUm91bmQodGhpcy5fZykgKyBcIiwgXCIgKyBtYXRoUm91bmQodGhpcy5fYikgKyBcIiwgXCIgKyB0aGlzLl9yb3VuZEEgKyBcIilcIjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRvUGVyY2VudGFnZVJnYjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHI6IG1hdGhSb3VuZChib3VuZDAxKHRoaXMuX3IsIDI1NSkgKiAxMDApICsgXCIlXCIsIGc6IG1hdGhSb3VuZChib3VuZDAxKHRoaXMuX2csIDI1NSkgKiAxMDApICsgXCIlXCIsIGI6IG1hdGhSb3VuZChib3VuZDAxKHRoaXMuX2IsIDI1NSkgKiAxMDApICsgXCIlXCIsIGE6IHRoaXMuX2EgfTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRvUGVyY2VudGFnZVJnYlN0cmluZzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5fYSA9PSAxKSA/XHJcbiAgICAgICAgICAgICAgXCJyZ2IoXCIgICsgbWF0aFJvdW5kKGJvdW5kMDEodGhpcy5fciwgMjU1KSAqIDEwMCkgKyBcIiUsIFwiICsgbWF0aFJvdW5kKGJvdW5kMDEodGhpcy5fZywgMjU1KSAqIDEwMCkgKyBcIiUsIFwiICsgbWF0aFJvdW5kKGJvdW5kMDEodGhpcy5fYiwgMjU1KSAqIDEwMCkgKyBcIiUpXCIgOlxyXG4gICAgICAgICAgICAgIFwicmdiYShcIiArIG1hdGhSb3VuZChib3VuZDAxKHRoaXMuX3IsIDI1NSkgKiAxMDApICsgXCIlLCBcIiArIG1hdGhSb3VuZChib3VuZDAxKHRoaXMuX2csIDI1NSkgKiAxMDApICsgXCIlLCBcIiArIG1hdGhSb3VuZChib3VuZDAxKHRoaXMuX2IsIDI1NSkgKiAxMDApICsgXCIlLCBcIiArIHRoaXMuX3JvdW5kQSArIFwiKVwiO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdG9OYW1lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2EgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcInRyYW5zcGFyZW50XCI7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9hIDwgMSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gaGV4TmFtZXNbcmdiVG9IZXgodGhpcy5fciwgdGhpcy5fZywgdGhpcy5fYiwgdHJ1ZSldIHx8IGZhbHNlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdG9GaWx0ZXI6IGZ1bmN0aW9uKHNlY29uZENvbG9yKSB7XHJcbiAgICAgICAgICAgIHZhciBoZXg4U3RyaW5nID0gJyMnICsgcmdiYVRvSGV4KHRoaXMuX3IsIHRoaXMuX2csIHRoaXMuX2IsIHRoaXMuX2EpO1xyXG4gICAgICAgICAgICB2YXIgc2Vjb25kSGV4OFN0cmluZyA9IGhleDhTdHJpbmc7XHJcbiAgICAgICAgICAgIHZhciBncmFkaWVudFR5cGUgPSB0aGlzLl9ncmFkaWVudFR5cGUgPyBcIkdyYWRpZW50VHlwZSA9IDEsIFwiIDogXCJcIjtcclxuXHJcbiAgICAgICAgICAgIGlmIChzZWNvbmRDb2xvcikge1xyXG4gICAgICAgICAgICAgICAgdmFyIHMgPSB0aW55Y29sb3Ioc2Vjb25kQ29sb3IpO1xyXG4gICAgICAgICAgICAgICAgc2Vjb25kSGV4OFN0cmluZyA9IHMudG9IZXg4U3RyaW5nKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBcInByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5ncmFkaWVudChcIitncmFkaWVudFR5cGUrXCJzdGFydENvbG9yc3RyPVwiK2hleDhTdHJpbmcrXCIsZW5kQ29sb3JzdHI9XCIrc2Vjb25kSGV4OFN0cmluZytcIilcIjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbihmb3JtYXQpIHtcclxuICAgICAgICAgICAgdmFyIGZvcm1hdFNldCA9ICEhZm9ybWF0O1xyXG4gICAgICAgICAgICBmb3JtYXQgPSBmb3JtYXQgfHwgdGhpcy5fZm9ybWF0O1xyXG5cclxuICAgICAgICAgICAgdmFyIGZvcm1hdHRlZFN0cmluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB2YXIgaGFzQWxwaGEgPSB0aGlzLl9hIDwgMSAmJiB0aGlzLl9hID49IDA7XHJcbiAgICAgICAgICAgIHZhciBuZWVkc0FscGhhRm9ybWF0ID0gIWZvcm1hdFNldCAmJiBoYXNBbHBoYSAmJiAoZm9ybWF0ID09PSBcImhleFwiIHx8IGZvcm1hdCA9PT0gXCJoZXg2XCIgfHwgZm9ybWF0ID09PSBcImhleDNcIiB8fCBmb3JtYXQgPT09IFwibmFtZVwiKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChuZWVkc0FscGhhRm9ybWF0KSB7XHJcbiAgICAgICAgICAgICAgICAvLyBTcGVjaWFsIGNhc2UgZm9yIFwidHJhbnNwYXJlbnRcIiwgYWxsIG90aGVyIG5vbi1hbHBoYSBmb3JtYXRzXHJcbiAgICAgICAgICAgICAgICAvLyB3aWxsIHJldHVybiByZ2JhIHdoZW4gdGhlcmUgaXMgdHJhbnNwYXJlbmN5LlxyXG4gICAgICAgICAgICAgICAgaWYgKGZvcm1hdCA9PT0gXCJuYW1lXCIgJiYgdGhpcy5fYSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRvTmFtZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudG9SZ2JTdHJpbmcoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZm9ybWF0ID09PSBcInJnYlwiKSB7XHJcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZWRTdHJpbmcgPSB0aGlzLnRvUmdiU3RyaW5nKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGZvcm1hdCA9PT0gXCJwcmdiXCIpIHtcclxuICAgICAgICAgICAgICAgIGZvcm1hdHRlZFN0cmluZyA9IHRoaXMudG9QZXJjZW50YWdlUmdiU3RyaW5nKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGZvcm1hdCA9PT0gXCJoZXhcIiB8fCBmb3JtYXQgPT09IFwiaGV4NlwiKSB7XHJcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZWRTdHJpbmcgPSB0aGlzLnRvSGV4U3RyaW5nKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGZvcm1hdCA9PT0gXCJoZXgzXCIpIHtcclxuICAgICAgICAgICAgICAgIGZvcm1hdHRlZFN0cmluZyA9IHRoaXMudG9IZXhTdHJpbmcodHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGZvcm1hdCA9PT0gXCJoZXg4XCIpIHtcclxuICAgICAgICAgICAgICAgIGZvcm1hdHRlZFN0cmluZyA9IHRoaXMudG9IZXg4U3RyaW5nKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGZvcm1hdCA9PT0gXCJuYW1lXCIpIHtcclxuICAgICAgICAgICAgICAgIGZvcm1hdHRlZFN0cmluZyA9IHRoaXMudG9OYW1lKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGZvcm1hdCA9PT0gXCJoc2xcIikge1xyXG4gICAgICAgICAgICAgICAgZm9ybWF0dGVkU3RyaW5nID0gdGhpcy50b0hzbFN0cmluZygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChmb3JtYXQgPT09IFwiaHN2XCIpIHtcclxuICAgICAgICAgICAgICAgIGZvcm1hdHRlZFN0cmluZyA9IHRoaXMudG9Ic3ZTdHJpbmcoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGZvcm1hdHRlZFN0cmluZyB8fCB0aGlzLnRvSGV4U3RyaW5nKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX2FwcGx5TW9kaWZpY2F0aW9uOiBmdW5jdGlvbihmbiwgYXJncykge1xyXG4gICAgICAgICAgICB2YXIgY29sb3IgPSBmbi5hcHBseShudWxsLCBbdGhpc10uY29uY2F0KFtdLnNsaWNlLmNhbGwoYXJncykpKTtcclxuICAgICAgICAgICAgdGhpcy5fciA9IGNvbG9yLl9yO1xyXG4gICAgICAgICAgICB0aGlzLl9nID0gY29sb3IuX2c7XHJcbiAgICAgICAgICAgIHRoaXMuX2IgPSBjb2xvci5fYjtcclxuICAgICAgICAgICAgdGhpcy5zZXRBbHBoYShjb2xvci5fYSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbGlnaHRlbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hcHBseU1vZGlmaWNhdGlvbihsaWdodGVuLCBhcmd1bWVudHMpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYnJpZ2h0ZW46IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXBwbHlNb2RpZmljYXRpb24oYnJpZ2h0ZW4sIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBkYXJrZW46IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXBwbHlNb2RpZmljYXRpb24oZGFya2VuLCBhcmd1bWVudHMpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZGVzYXR1cmF0ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hcHBseU1vZGlmaWNhdGlvbihkZXNhdHVyYXRlLCBhcmd1bWVudHMpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2F0dXJhdGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXBwbHlNb2RpZmljYXRpb24oc2F0dXJhdGUsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBncmV5c2NhbGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXBwbHlNb2RpZmljYXRpb24oZ3JleXNjYWxlLCBhcmd1bWVudHMpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc3BpbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hcHBseU1vZGlmaWNhdGlvbihzcGluLCBhcmd1bWVudHMpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIF9hcHBseUNvbWJpbmF0aW9uOiBmdW5jdGlvbihmbiwgYXJncykge1xyXG4gICAgICAgICAgICByZXR1cm4gZm4uYXBwbHkobnVsbCwgW3RoaXNdLmNvbmNhdChbXS5zbGljZS5jYWxsKGFyZ3MpKSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBhbmFsb2dvdXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXBwbHlDb21iaW5hdGlvbihhbmFsb2dvdXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBjb21wbGVtZW50OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FwcGx5Q29tYmluYXRpb24oY29tcGxlbWVudCwgYXJndW1lbnRzKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIG1vbm9jaHJvbWF0aWM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXBwbHlDb21iaW5hdGlvbihtb25vY2hyb21hdGljLCBhcmd1bWVudHMpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc3BsaXRjb21wbGVtZW50OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FwcGx5Q29tYmluYXRpb24oc3BsaXRjb21wbGVtZW50LCBhcmd1bWVudHMpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdHJpYWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXBwbHlDb21iaW5hdGlvbih0cmlhZCwgYXJndW1lbnRzKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRldHJhZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hcHBseUNvbWJpbmF0aW9uKHRldHJhZCwgYXJndW1lbnRzKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIElmIGlucHV0IGlzIGFuIG9iamVjdCwgZm9yY2UgMSBpbnRvIFwiMS4wXCIgdG8gaGFuZGxlIHJhdGlvcyBwcm9wZXJseVxyXG4gICAgLy8gU3RyaW5nIGlucHV0IHJlcXVpcmVzIFwiMS4wXCIgYXMgaW5wdXQsIHNvIDEgd2lsbCBiZSB0cmVhdGVkIGFzIDFcclxuICAgIHRpbnljb2xvci5mcm9tUmF0aW8gPSBmdW5jdGlvbihjb2xvciwgb3B0cykge1xyXG4gICAgICAgIGlmICh0eXBlb2YgY29sb3IgPT0gXCJvYmplY3RcIikge1xyXG4gICAgICAgICAgICB2YXIgbmV3Q29sb3IgPSB7fTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBjb2xvcikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbG9yLmhhc093blByb3BlcnR5KGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT09IFwiYVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NvbG9yW2ldID0gY29sb3JbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdDb2xvcltpXSA9IGNvbnZlcnRUb1BlcmNlbnRhZ2UoY29sb3JbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb2xvciA9IG5ld0NvbG9yO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRpbnljb2xvcihjb2xvciwgb3B0cyk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIEdpdmVuIGEgc3RyaW5nIG9yIG9iamVjdCwgY29udmVydCB0aGF0IGlucHV0IHRvIFJHQlxyXG4gICAgLy8gUG9zc2libGUgc3RyaW5nIGlucHV0czpcclxuICAgIC8vXHJcbiAgICAvLyAgICAgXCJyZWRcIlxyXG4gICAgLy8gICAgIFwiI2YwMFwiIG9yIFwiZjAwXCJcclxuICAgIC8vICAgICBcIiNmZjAwMDBcIiBvciBcImZmMDAwMFwiXHJcbiAgICAvLyAgICAgXCIjZmYwMDAwMDBcIiBvciBcImZmMDAwMDAwXCJcclxuICAgIC8vICAgICBcInJnYiAyNTUgMCAwXCIgb3IgXCJyZ2IgKDI1NSwgMCwgMClcIlxyXG4gICAgLy8gICAgIFwicmdiIDEuMCAwIDBcIiBvciBcInJnYiAoMSwgMCwgMClcIlxyXG4gICAgLy8gICAgIFwicmdiYSAoMjU1LCAwLCAwLCAxKVwiIG9yIFwicmdiYSAyNTUsIDAsIDAsIDFcIlxyXG4gICAgLy8gICAgIFwicmdiYSAoMS4wLCAwLCAwLCAxKVwiIG9yIFwicmdiYSAxLjAsIDAsIDAsIDFcIlxyXG4gICAgLy8gICAgIFwiaHNsKDAsIDEwMCUsIDUwJSlcIiBvciBcImhzbCAwIDEwMCUgNTAlXCJcclxuICAgIC8vICAgICBcImhzbGEoMCwgMTAwJSwgNTAlLCAxKVwiIG9yIFwiaHNsYSAwIDEwMCUgNTAlLCAxXCJcclxuICAgIC8vICAgICBcImhzdigwLCAxMDAlLCAxMDAlKVwiIG9yIFwiaHN2IDAgMTAwJSAxMDAlXCJcclxuICAgIC8vXHJcbiAgICBmdW5jdGlvbiBpbnB1dFRvUkdCKGNvbG9yKSB7XHJcblxyXG4gICAgICAgIHZhciByZ2IgPSB7IHI6IDAsIGc6IDAsIGI6IDAgfTtcclxuICAgICAgICB2YXIgYSA9IDE7XHJcbiAgICAgICAgdmFyIG9rID0gZmFsc2U7XHJcbiAgICAgICAgdmFyIGZvcm1hdCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBpZiAodHlwZW9mIGNvbG9yID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgY29sb3IgPSBzdHJpbmdJbnB1dFRvT2JqZWN0KGNvbG9yKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0eXBlb2YgY29sb3IgPT0gXCJvYmplY3RcIikge1xyXG4gICAgICAgICAgICBpZiAoY29sb3IuaGFzT3duUHJvcGVydHkoXCJyXCIpICYmIGNvbG9yLmhhc093blByb3BlcnR5KFwiZ1wiKSAmJiBjb2xvci5oYXNPd25Qcm9wZXJ0eShcImJcIikpIHtcclxuICAgICAgICAgICAgICAgIHJnYiA9IHJnYlRvUmdiKGNvbG9yLnIsIGNvbG9yLmcsIGNvbG9yLmIpO1xyXG4gICAgICAgICAgICAgICAgb2sgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgZm9ybWF0ID0gU3RyaW5nKGNvbG9yLnIpLnN1YnN0cigtMSkgPT09IFwiJVwiID8gXCJwcmdiXCIgOiBcInJnYlwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGNvbG9yLmhhc093blByb3BlcnR5KFwiaFwiKSAmJiBjb2xvci5oYXNPd25Qcm9wZXJ0eShcInNcIikgJiYgY29sb3IuaGFzT3duUHJvcGVydHkoXCJ2XCIpKSB7XHJcbiAgICAgICAgICAgICAgICBjb2xvci5zID0gY29udmVydFRvUGVyY2VudGFnZShjb2xvci5zKTtcclxuICAgICAgICAgICAgICAgIGNvbG9yLnYgPSBjb252ZXJ0VG9QZXJjZW50YWdlKGNvbG9yLnYpO1xyXG4gICAgICAgICAgICAgICAgcmdiID0gaHN2VG9SZ2IoY29sb3IuaCwgY29sb3IucywgY29sb3Iudik7XHJcbiAgICAgICAgICAgICAgICBvayA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBmb3JtYXQgPSBcImhzdlwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGNvbG9yLmhhc093blByb3BlcnR5KFwiaFwiKSAmJiBjb2xvci5oYXNPd25Qcm9wZXJ0eShcInNcIikgJiYgY29sb3IuaGFzT3duUHJvcGVydHkoXCJsXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBjb2xvci5zID0gY29udmVydFRvUGVyY2VudGFnZShjb2xvci5zKTtcclxuICAgICAgICAgICAgICAgIGNvbG9yLmwgPSBjb252ZXJ0VG9QZXJjZW50YWdlKGNvbG9yLmwpO1xyXG4gICAgICAgICAgICAgICAgcmdiID0gaHNsVG9SZ2IoY29sb3IuaCwgY29sb3IucywgY29sb3IubCk7XHJcbiAgICAgICAgICAgICAgICBvayA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBmb3JtYXQgPSBcImhzbFwiO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoY29sb3IuaGFzT3duUHJvcGVydHkoXCJhXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBhID0gY29sb3IuYTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYSA9IGJvdW5kQWxwaGEoYSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG9rOiBvayxcclxuICAgICAgICAgICAgZm9ybWF0OiBjb2xvci5mb3JtYXQgfHwgZm9ybWF0LFxyXG4gICAgICAgICAgICByOiBtYXRoTWluKDI1NSwgbWF0aE1heChyZ2IuciwgMCkpLFxyXG4gICAgICAgICAgICBnOiBtYXRoTWluKDI1NSwgbWF0aE1heChyZ2IuZywgMCkpLFxyXG4gICAgICAgICAgICBiOiBtYXRoTWluKDI1NSwgbWF0aE1heChyZ2IuYiwgMCkpLFxyXG4gICAgICAgICAgICBhOiBhXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLy8gQ29udmVyc2lvbiBGdW5jdGlvbnNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgLy8gYHJnYlRvSHNsYCwgYHJnYlRvSHN2YCwgYGhzbFRvUmdiYCwgYGhzdlRvUmdiYCBtb2RpZmllZCBmcm9tOlxyXG4gICAgLy8gPGh0dHA6Ly9tamlqYWNrc29uLmNvbS8yMDA4LzAyL3JnYi10by1oc2wtYW5kLXJnYi10by1oc3YtY29sb3ItbW9kZWwtY29udmVyc2lvbi1hbGdvcml0aG1zLWluLWphdmFzY3JpcHQ+XHJcblxyXG4gICAgLy8gYHJnYlRvUmdiYFxyXG4gICAgLy8gSGFuZGxlIGJvdW5kcyAvIHBlcmNlbnRhZ2UgY2hlY2tpbmcgdG8gY29uZm9ybSB0byBDU1MgY29sb3Igc3BlY1xyXG4gICAgLy8gPGh0dHA6Ly93d3cudzMub3JnL1RSL2NzczMtY29sb3IvPlxyXG4gICAgLy8gKkFzc3VtZXM6KiByLCBnLCBiIGluIFswLCAyNTVdIG9yIFswLCAxXVxyXG4gICAgLy8gKlJldHVybnM6KiB7IHIsIGcsIGIgfSBpbiBbMCwgMjU1XVxyXG4gICAgZnVuY3Rpb24gcmdiVG9SZ2IociwgZywgYil7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcjogYm91bmQwMShyLCAyNTUpICogMjU1LFxyXG4gICAgICAgICAgICBnOiBib3VuZDAxKGcsIDI1NSkgKiAyNTUsXHJcbiAgICAgICAgICAgIGI6IGJvdW5kMDEoYiwgMjU1KSAqIDI1NVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gYHJnYlRvSHNsYFxyXG4gICAgLy8gQ29udmVydHMgYW4gUkdCIGNvbG9yIHZhbHVlIHRvIEhTTC5cclxuICAgIC8vICpBc3N1bWVzOiogciwgZywgYW5kIGIgYXJlIGNvbnRhaW5lZCBpbiBbMCwgMjU1XSBvciBbMCwgMV1cclxuICAgIC8vICpSZXR1cm5zOiogeyBoLCBzLCBsIH0gaW4gWzAsMV1cclxuICAgIGZ1bmN0aW9uIHJnYlRvSHNsKHIsIGcsIGIpIHtcclxuXHJcbiAgICAgICAgciA9IGJvdW5kMDEociwgMjU1KTtcclxuICAgICAgICBnID0gYm91bmQwMShnLCAyNTUpO1xyXG4gICAgICAgIGIgPSBib3VuZDAxKGIsIDI1NSk7XHJcblxyXG4gICAgICAgIHZhciBtYXggPSBtYXRoTWF4KHIsIGcsIGIpLCBtaW4gPSBtYXRoTWluKHIsIGcsIGIpO1xyXG4gICAgICAgIHZhciBoLCBzLCBsID0gKG1heCArIG1pbikgLyAyO1xyXG5cclxuICAgICAgICBpZihtYXggPT0gbWluKSB7XHJcbiAgICAgICAgICAgIGggPSBzID0gMDsgLy8gYWNocm9tYXRpY1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIGQgPSBtYXggLSBtaW47XHJcbiAgICAgICAgICAgIHMgPSBsID4gMC41ID8gZCAvICgyIC0gbWF4IC0gbWluKSA6IGQgLyAobWF4ICsgbWluKTtcclxuICAgICAgICAgICAgc3dpdGNoKG1heCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSByOiBoID0gKGcgLSBiKSAvIGQgKyAoZyA8IGIgPyA2IDogMCk7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBnOiBoID0gKGIgLSByKSAvIGQgKyAyOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgYjogaCA9IChyIC0gZykgLyBkICsgNDsgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGggLz0gNjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7IGg6IGgsIHM6IHMsIGw6IGwgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBgaHNsVG9SZ2JgXHJcbiAgICAvLyBDb252ZXJ0cyBhbiBIU0wgY29sb3IgdmFsdWUgdG8gUkdCLlxyXG4gICAgLy8gKkFzc3VtZXM6KiBoIGlzIGNvbnRhaW5lZCBpbiBbMCwgMV0gb3IgWzAsIDM2MF0gYW5kIHMgYW5kIGwgYXJlIGNvbnRhaW5lZCBbMCwgMV0gb3IgWzAsIDEwMF1cclxuICAgIC8vICpSZXR1cm5zOiogeyByLCBnLCBiIH0gaW4gdGhlIHNldCBbMCwgMjU1XVxyXG4gICAgZnVuY3Rpb24gaHNsVG9SZ2IoaCwgcywgbCkge1xyXG4gICAgICAgIHZhciByLCBnLCBiO1xyXG5cclxuICAgICAgICBoID0gYm91bmQwMShoLCAzNjApO1xyXG4gICAgICAgIHMgPSBib3VuZDAxKHMsIDEwMCk7XHJcbiAgICAgICAgbCA9IGJvdW5kMDEobCwgMTAwKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaHVlMnJnYihwLCBxLCB0KSB7XHJcbiAgICAgICAgICAgIGlmKHQgPCAwKSB0ICs9IDE7XHJcbiAgICAgICAgICAgIGlmKHQgPiAxKSB0IC09IDE7XHJcbiAgICAgICAgICAgIGlmKHQgPCAxLzYpIHJldHVybiBwICsgKHEgLSBwKSAqIDYgKiB0O1xyXG4gICAgICAgICAgICBpZih0IDwgMS8yKSByZXR1cm4gcTtcclxuICAgICAgICAgICAgaWYodCA8IDIvMykgcmV0dXJuIHAgKyAocSAtIHApICogKDIvMyAtIHQpICogNjtcclxuICAgICAgICAgICAgcmV0dXJuIHA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZihzID09PSAwKSB7XHJcbiAgICAgICAgICAgIHIgPSBnID0gYiA9IGw7IC8vIGFjaHJvbWF0aWNcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBxID0gbCA8IDAuNSA/IGwgKiAoMSArIHMpIDogbCArIHMgLSBsICogcztcclxuICAgICAgICAgICAgdmFyIHAgPSAyICogbCAtIHE7XHJcbiAgICAgICAgICAgIHIgPSBodWUycmdiKHAsIHEsIGggKyAxLzMpO1xyXG4gICAgICAgICAgICBnID0gaHVlMnJnYihwLCBxLCBoKTtcclxuICAgICAgICAgICAgYiA9IGh1ZTJyZ2IocCwgcSwgaCAtIDEvMyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4geyByOiByICogMjU1LCBnOiBnICogMjU1LCBiOiBiICogMjU1IH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gYHJnYlRvSHN2YFxyXG4gICAgLy8gQ29udmVydHMgYW4gUkdCIGNvbG9yIHZhbHVlIHRvIEhTVlxyXG4gICAgLy8gKkFzc3VtZXM6KiByLCBnLCBhbmQgYiBhcmUgY29udGFpbmVkIGluIHRoZSBzZXQgWzAsIDI1NV0gb3IgWzAsIDFdXHJcbiAgICAvLyAqUmV0dXJuczoqIHsgaCwgcywgdiB9IGluIFswLDFdXHJcbiAgICBmdW5jdGlvbiByZ2JUb0hzdihyLCBnLCBiKSB7XHJcblxyXG4gICAgICAgIHIgPSBib3VuZDAxKHIsIDI1NSk7XHJcbiAgICAgICAgZyA9IGJvdW5kMDEoZywgMjU1KTtcclxuICAgICAgICBiID0gYm91bmQwMShiLCAyNTUpO1xyXG5cclxuICAgICAgICB2YXIgbWF4ID0gbWF0aE1heChyLCBnLCBiKSwgbWluID0gbWF0aE1pbihyLCBnLCBiKTtcclxuICAgICAgICB2YXIgaCwgcywgdiA9IG1heDtcclxuXHJcbiAgICAgICAgdmFyIGQgPSBtYXggLSBtaW47XHJcbiAgICAgICAgcyA9IG1heCA9PT0gMCA/IDAgOiBkIC8gbWF4O1xyXG5cclxuICAgICAgICBpZihtYXggPT0gbWluKSB7XHJcbiAgICAgICAgICAgIGggPSAwOyAvLyBhY2hyb21hdGljXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBzd2l0Y2gobWF4KSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIHI6IGggPSAoZyAtIGIpIC8gZCArIChnIDwgYiA/IDYgOiAwKTsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIGc6IGggPSAoYiAtIHIpIC8gZCArIDI7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBiOiBoID0gKHIgLSBnKSAvIGQgKyA0OyBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBoIC89IDY7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7IGg6IGgsIHM6IHMsIHY6IHYgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBgaHN2VG9SZ2JgXHJcbiAgICAvLyBDb252ZXJ0cyBhbiBIU1YgY29sb3IgdmFsdWUgdG8gUkdCLlxyXG4gICAgLy8gKkFzc3VtZXM6KiBoIGlzIGNvbnRhaW5lZCBpbiBbMCwgMV0gb3IgWzAsIDM2MF0gYW5kIHMgYW5kIHYgYXJlIGNvbnRhaW5lZCBpbiBbMCwgMV0gb3IgWzAsIDEwMF1cclxuICAgIC8vICpSZXR1cm5zOiogeyByLCBnLCBiIH0gaW4gdGhlIHNldCBbMCwgMjU1XVxyXG4gICAgIGZ1bmN0aW9uIGhzdlRvUmdiKGgsIHMsIHYpIHtcclxuXHJcbiAgICAgICAgaCA9IGJvdW5kMDEoaCwgMzYwKSAqIDY7XHJcbiAgICAgICAgcyA9IGJvdW5kMDEocywgMTAwKTtcclxuICAgICAgICB2ID0gYm91bmQwMSh2LCAxMDApO1xyXG5cclxuICAgICAgICB2YXIgaSA9IG1hdGguZmxvb3IoaCksXHJcbiAgICAgICAgICAgIGYgPSBoIC0gaSxcclxuICAgICAgICAgICAgcCA9IHYgKiAoMSAtIHMpLFxyXG4gICAgICAgICAgICBxID0gdiAqICgxIC0gZiAqIHMpLFxyXG4gICAgICAgICAgICB0ID0gdiAqICgxIC0gKDEgLSBmKSAqIHMpLFxyXG4gICAgICAgICAgICBtb2QgPSBpICUgNixcclxuICAgICAgICAgICAgciA9IFt2LCBxLCBwLCBwLCB0LCB2XVttb2RdLFxyXG4gICAgICAgICAgICBnID0gW3QsIHYsIHYsIHEsIHAsIHBdW21vZF0sXHJcbiAgICAgICAgICAgIGIgPSBbcCwgcCwgdCwgdiwgdiwgcV1bbW9kXTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgcjogciAqIDI1NSwgZzogZyAqIDI1NSwgYjogYiAqIDI1NSB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGByZ2JUb0hleGBcclxuICAgIC8vIENvbnZlcnRzIGFuIFJHQiBjb2xvciB0byBoZXhcclxuICAgIC8vIEFzc3VtZXMgciwgZywgYW5kIGIgYXJlIGNvbnRhaW5lZCBpbiB0aGUgc2V0IFswLCAyNTVdXHJcbiAgICAvLyBSZXR1cm5zIGEgMyBvciA2IGNoYXJhY3RlciBoZXhcclxuICAgIGZ1bmN0aW9uIHJnYlRvSGV4KHIsIGcsIGIsIGFsbG93M0NoYXIpIHtcclxuXHJcbiAgICAgICAgdmFyIGhleCA9IFtcclxuICAgICAgICAgICAgcGFkMihtYXRoUm91bmQocikudG9TdHJpbmcoMTYpKSxcclxuICAgICAgICAgICAgcGFkMihtYXRoUm91bmQoZykudG9TdHJpbmcoMTYpKSxcclxuICAgICAgICAgICAgcGFkMihtYXRoUm91bmQoYikudG9TdHJpbmcoMTYpKVxyXG4gICAgICAgIF07XHJcblxyXG4gICAgICAgIC8vIFJldHVybiBhIDMgY2hhcmFjdGVyIGhleCBpZiBwb3NzaWJsZVxyXG4gICAgICAgIGlmIChhbGxvdzNDaGFyICYmIGhleFswXS5jaGFyQXQoMCkgPT0gaGV4WzBdLmNoYXJBdCgxKSAmJiBoZXhbMV0uY2hhckF0KDApID09IGhleFsxXS5jaGFyQXQoMSkgJiYgaGV4WzJdLmNoYXJBdCgwKSA9PSBoZXhbMl0uY2hhckF0KDEpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBoZXhbMF0uY2hhckF0KDApICsgaGV4WzFdLmNoYXJBdCgwKSArIGhleFsyXS5jaGFyQXQoMCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gaGV4LmpvaW4oXCJcIik7XHJcbiAgICB9XHJcbiAgICAgICAgLy8gYHJnYmFUb0hleGBcclxuICAgICAgICAvLyBDb252ZXJ0cyBhbiBSR0JBIGNvbG9yIHBsdXMgYWxwaGEgdHJhbnNwYXJlbmN5IHRvIGhleFxyXG4gICAgICAgIC8vIEFzc3VtZXMgciwgZywgYiBhbmQgYSBhcmUgY29udGFpbmVkIGluIHRoZSBzZXQgWzAsIDI1NV1cclxuICAgICAgICAvLyBSZXR1cm5zIGFuIDggY2hhcmFjdGVyIGhleFxyXG4gICAgICAgIGZ1bmN0aW9uIHJnYmFUb0hleChyLCBnLCBiLCBhKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgaGV4ID0gW1xyXG4gICAgICAgICAgICAgICAgcGFkMihjb252ZXJ0RGVjaW1hbFRvSGV4KGEpKSxcclxuICAgICAgICAgICAgICAgIHBhZDIobWF0aFJvdW5kKHIpLnRvU3RyaW5nKDE2KSksXHJcbiAgICAgICAgICAgICAgICBwYWQyKG1hdGhSb3VuZChnKS50b1N0cmluZygxNikpLFxyXG4gICAgICAgICAgICAgICAgcGFkMihtYXRoUm91bmQoYikudG9TdHJpbmcoMTYpKVxyXG4gICAgICAgICAgICBdO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGhleC5qb2luKFwiXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAvLyBgZXF1YWxzYFxyXG4gICAgLy8gQ2FuIGJlIGNhbGxlZCB3aXRoIGFueSB0aW55Y29sb3IgaW5wdXRcclxuICAgIHRpbnljb2xvci5lcXVhbHMgPSBmdW5jdGlvbiAoY29sb3IxLCBjb2xvcjIpIHtcclxuICAgICAgICBpZiAoIWNvbG9yMSB8fCAhY29sb3IyKSB7IHJldHVybiBmYWxzZTsgfVxyXG4gICAgICAgIHJldHVybiB0aW55Y29sb3IoY29sb3IxKS50b1JnYlN0cmluZygpID09IHRpbnljb2xvcihjb2xvcjIpLnRvUmdiU3RyaW5nKCk7XHJcbiAgICB9O1xyXG4gICAgdGlueWNvbG9yLnJhbmRvbSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aW55Y29sb3IuZnJvbVJhdGlvKHtcclxuICAgICAgICAgICAgcjogbWF0aFJhbmRvbSgpLFxyXG4gICAgICAgICAgICBnOiBtYXRoUmFuZG9tKCksXHJcbiAgICAgICAgICAgIGI6IG1hdGhSYW5kb20oKVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcblxyXG4gICAgLy8gTW9kaWZpY2F0aW9uIEZ1bmN0aW9uc1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gVGhhbmtzIHRvIGxlc3MuanMgZm9yIHNvbWUgb2YgdGhlIGJhc2ljcyBoZXJlXHJcbiAgICAvLyA8aHR0cHM6Ly9naXRodWIuY29tL2Nsb3VkaGVhZC9sZXNzLmpzL2Jsb2IvbWFzdGVyL2xpYi9sZXNzL2Z1bmN0aW9ucy5qcz5cclxuXHJcbiAgICBmdW5jdGlvbiBkZXNhdHVyYXRlKGNvbG9yLCBhbW91bnQpIHtcclxuICAgICAgICBhbW91bnQgPSAoYW1vdW50ID09PSAwKSA/IDAgOiAoYW1vdW50IHx8IDEwKTtcclxuICAgICAgICB2YXIgaHNsID0gdGlueWNvbG9yKGNvbG9yKS50b0hzbCgpO1xyXG4gICAgICAgIGhzbC5zIC09IGFtb3VudCAvIDEwMDtcclxuICAgICAgICBoc2wucyA9IGNsYW1wMDEoaHNsLnMpO1xyXG4gICAgICAgIHJldHVybiB0aW55Y29sb3IoaHNsKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBzYXR1cmF0ZShjb2xvciwgYW1vdW50KSB7XHJcbiAgICAgICAgYW1vdW50ID0gKGFtb3VudCA9PT0gMCkgPyAwIDogKGFtb3VudCB8fCAxMCk7XHJcbiAgICAgICAgdmFyIGhzbCA9IHRpbnljb2xvcihjb2xvcikudG9Ic2woKTtcclxuICAgICAgICBoc2wucyArPSBhbW91bnQgLyAxMDA7XHJcbiAgICAgICAgaHNsLnMgPSBjbGFtcDAxKGhzbC5zKTtcclxuICAgICAgICByZXR1cm4gdGlueWNvbG9yKGhzbCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ3JleXNjYWxlKGNvbG9yKSB7XHJcbiAgICAgICAgcmV0dXJuIHRpbnljb2xvcihjb2xvcikuZGVzYXR1cmF0ZSgxMDApO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGxpZ2h0ZW4gKGNvbG9yLCBhbW91bnQpIHtcclxuICAgICAgICBhbW91bnQgPSAoYW1vdW50ID09PSAwKSA/IDAgOiAoYW1vdW50IHx8IDEwKTtcclxuICAgICAgICB2YXIgaHNsID0gdGlueWNvbG9yKGNvbG9yKS50b0hzbCgpO1xyXG4gICAgICAgIGhzbC5sICs9IGFtb3VudCAvIDEwMDtcclxuICAgICAgICBoc2wubCA9IGNsYW1wMDEoaHNsLmwpO1xyXG4gICAgICAgIHJldHVybiB0aW55Y29sb3IoaHNsKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBicmlnaHRlbihjb2xvciwgYW1vdW50KSB7XHJcbiAgICAgICAgYW1vdW50ID0gKGFtb3VudCA9PT0gMCkgPyAwIDogKGFtb3VudCB8fCAxMCk7XHJcbiAgICAgICAgdmFyIHJnYiA9IHRpbnljb2xvcihjb2xvcikudG9SZ2IoKTtcclxuICAgICAgICByZ2IuciA9IG1hdGhNYXgoMCwgbWF0aE1pbigyNTUsIHJnYi5yIC0gbWF0aFJvdW5kKDI1NSAqIC0gKGFtb3VudCAvIDEwMCkpKSk7XHJcbiAgICAgICAgcmdiLmcgPSBtYXRoTWF4KDAsIG1hdGhNaW4oMjU1LCByZ2IuZyAtIG1hdGhSb3VuZCgyNTUgKiAtIChhbW91bnQgLyAxMDApKSkpO1xyXG4gICAgICAgIHJnYi5iID0gbWF0aE1heCgwLCBtYXRoTWluKDI1NSwgcmdiLmIgLSBtYXRoUm91bmQoMjU1ICogLSAoYW1vdW50IC8gMTAwKSkpKTtcclxuICAgICAgICByZXR1cm4gdGlueWNvbG9yKHJnYik7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZGFya2VuIChjb2xvciwgYW1vdW50KSB7XHJcbiAgICAgICAgYW1vdW50ID0gKGFtb3VudCA9PT0gMCkgPyAwIDogKGFtb3VudCB8fCAxMCk7XHJcbiAgICAgICAgdmFyIGhzbCA9IHRpbnljb2xvcihjb2xvcikudG9Ic2woKTtcclxuICAgICAgICBoc2wubCAtPSBhbW91bnQgLyAxMDA7XHJcbiAgICAgICAgaHNsLmwgPSBjbGFtcDAxKGhzbC5sKTtcclxuICAgICAgICByZXR1cm4gdGlueWNvbG9yKGhzbCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU3BpbiB0YWtlcyBhIHBvc2l0aXZlIG9yIG5lZ2F0aXZlIGFtb3VudCB3aXRoaW4gWy0zNjAsIDM2MF0gaW5kaWNhdGluZyB0aGUgY2hhbmdlIG9mIGh1ZS5cclxuICAgIC8vIFZhbHVlcyBvdXRzaWRlIG9mIHRoaXMgcmFuZ2Ugd2lsbCBiZSB3cmFwcGVkIGludG8gdGhpcyByYW5nZS5cclxuICAgIGZ1bmN0aW9uIHNwaW4oY29sb3IsIGFtb3VudCkge1xyXG4gICAgICAgIHZhciBoc2wgPSB0aW55Y29sb3IoY29sb3IpLnRvSHNsKCk7XHJcbiAgICAgICAgdmFyIGh1ZSA9IChtYXRoUm91bmQoaHNsLmgpICsgYW1vdW50KSAlIDM2MDtcclxuICAgICAgICBoc2wuaCA9IGh1ZSA8IDAgPyAzNjAgKyBodWUgOiBodWU7XHJcbiAgICAgICAgcmV0dXJuIHRpbnljb2xvcihoc2wpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENvbWJpbmF0aW9uIEZ1bmN0aW9uc1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBUaGFua3MgdG8galF1ZXJ5IHhDb2xvciBmb3Igc29tZSBvZiB0aGUgaWRlYXMgYmVoaW5kIHRoZXNlXHJcbiAgICAvLyA8aHR0cHM6Ly9naXRodWIuY29tL2luZnVzaW9uL2pRdWVyeS14Y29sb3IvYmxvYi9tYXN0ZXIvanF1ZXJ5Lnhjb2xvci5qcz5cclxuXHJcbiAgICBmdW5jdGlvbiBjb21wbGVtZW50KGNvbG9yKSB7XHJcbiAgICAgICAgdmFyIGhzbCA9IHRpbnljb2xvcihjb2xvcikudG9Ic2woKTtcclxuICAgICAgICBoc2wuaCA9IChoc2wuaCArIDE4MCkgJSAzNjA7XHJcbiAgICAgICAgcmV0dXJuIHRpbnljb2xvcihoc2wpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHRyaWFkKGNvbG9yKSB7XHJcbiAgICAgICAgdmFyIGhzbCA9IHRpbnljb2xvcihjb2xvcikudG9Ic2woKTtcclxuICAgICAgICB2YXIgaCA9IGhzbC5oO1xyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIHRpbnljb2xvcihjb2xvciksXHJcbiAgICAgICAgICAgIHRpbnljb2xvcih7IGg6IChoICsgMTIwKSAlIDM2MCwgczogaHNsLnMsIGw6IGhzbC5sIH0pLFxyXG4gICAgICAgICAgICB0aW55Y29sb3IoeyBoOiAoaCArIDI0MCkgJSAzNjAsIHM6IGhzbC5zLCBsOiBoc2wubCB9KVxyXG4gICAgICAgIF07XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gdGV0cmFkKGNvbG9yKSB7XHJcbiAgICAgICAgdmFyIGhzbCA9IHRpbnljb2xvcihjb2xvcikudG9Ic2woKTtcclxuICAgICAgICB2YXIgaCA9IGhzbC5oO1xyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIHRpbnljb2xvcihjb2xvciksXHJcbiAgICAgICAgICAgIHRpbnljb2xvcih7IGg6IChoICsgOTApICUgMzYwLCBzOiBoc2wucywgbDogaHNsLmwgfSksXHJcbiAgICAgICAgICAgIHRpbnljb2xvcih7IGg6IChoICsgMTgwKSAlIDM2MCwgczogaHNsLnMsIGw6IGhzbC5sIH0pLFxyXG4gICAgICAgICAgICB0aW55Y29sb3IoeyBoOiAoaCArIDI3MCkgJSAzNjAsIHM6IGhzbC5zLCBsOiBoc2wubCB9KVxyXG4gICAgICAgIF07XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gc3BsaXRjb21wbGVtZW50KGNvbG9yKSB7XHJcbiAgICAgICAgdmFyIGhzbCA9IHRpbnljb2xvcihjb2xvcikudG9Ic2woKTtcclxuICAgICAgICB2YXIgaCA9IGhzbC5oO1xyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIHRpbnljb2xvcihjb2xvciksXHJcbiAgICAgICAgICAgIHRpbnljb2xvcih7IGg6IChoICsgNzIpICUgMzYwLCBzOiBoc2wucywgbDogaHNsLmx9KSxcclxuICAgICAgICAgICAgdGlueWNvbG9yKHsgaDogKGggKyAyMTYpICUgMzYwLCBzOiBoc2wucywgbDogaHNsLmx9KVxyXG4gICAgICAgIF07XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gYW5hbG9nb3VzKGNvbG9yLCByZXN1bHRzLCBzbGljZXMpIHtcclxuICAgICAgICByZXN1bHRzID0gcmVzdWx0cyB8fCA2O1xyXG4gICAgICAgIHNsaWNlcyA9IHNsaWNlcyB8fCAzMDtcclxuXHJcbiAgICAgICAgdmFyIGhzbCA9IHRpbnljb2xvcihjb2xvcikudG9Ic2woKTtcclxuICAgICAgICB2YXIgcGFydCA9IDM2MCAvIHNsaWNlcztcclxuICAgICAgICB2YXIgcmV0ID0gW3Rpbnljb2xvcihjb2xvcildO1xyXG5cclxuICAgICAgICBmb3IgKGhzbC5oID0gKChoc2wuaCAtIChwYXJ0ICogcmVzdWx0cyA+PiAxKSkgKyA3MjApICUgMzYwOyAtLXJlc3VsdHM7ICkge1xyXG4gICAgICAgICAgICBoc2wuaCA9IChoc2wuaCArIHBhcnQpICUgMzYwO1xyXG4gICAgICAgICAgICByZXQucHVzaCh0aW55Y29sb3IoaHNsKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXQ7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbW9ub2Nocm9tYXRpYyhjb2xvciwgcmVzdWx0cykge1xyXG4gICAgICAgIHJlc3VsdHMgPSByZXN1bHRzIHx8IDY7XHJcbiAgICAgICAgdmFyIGhzdiA9IHRpbnljb2xvcihjb2xvcikudG9Ic3YoKTtcclxuICAgICAgICB2YXIgaCA9IGhzdi5oLCBzID0gaHN2LnMsIHYgPSBoc3YudjtcclxuICAgICAgICB2YXIgcmV0ID0gW107XHJcbiAgICAgICAgdmFyIG1vZGlmaWNhdGlvbiA9IDEgLyByZXN1bHRzO1xyXG5cclxuICAgICAgICB3aGlsZSAocmVzdWx0cy0tKSB7XHJcbiAgICAgICAgICAgIHJldC5wdXNoKHRpbnljb2xvcih7IGg6IGgsIHM6IHMsIHY6IHZ9KSk7XHJcbiAgICAgICAgICAgIHYgPSAodiArIG1vZGlmaWNhdGlvbikgJSAxO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHJldDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBVdGlsaXR5IEZ1bmN0aW9uc1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgdGlueWNvbG9yLm1peCA9IGZ1bmN0aW9uKGNvbG9yMSwgY29sb3IyLCBhbW91bnQpIHtcclxuICAgICAgICBhbW91bnQgPSAoYW1vdW50ID09PSAwKSA/IDAgOiAoYW1vdW50IHx8IDUwKTtcclxuXHJcbiAgICAgICAgdmFyIHJnYjEgPSB0aW55Y29sb3IoY29sb3IxKS50b1JnYigpO1xyXG4gICAgICAgIHZhciByZ2IyID0gdGlueWNvbG9yKGNvbG9yMikudG9SZ2IoKTtcclxuXHJcbiAgICAgICAgdmFyIHAgPSBhbW91bnQgLyAxMDA7XHJcbiAgICAgICAgdmFyIHcgPSBwICogMiAtIDE7XHJcbiAgICAgICAgdmFyIGEgPSByZ2IyLmEgLSByZ2IxLmE7XHJcblxyXG4gICAgICAgIHZhciB3MTtcclxuXHJcbiAgICAgICAgaWYgKHcgKiBhID09IC0xKSB7XHJcbiAgICAgICAgICAgIHcxID0gdztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB3MSA9ICh3ICsgYSkgLyAoMSArIHcgKiBhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHcxID0gKHcxICsgMSkgLyAyO1xyXG5cclxuICAgICAgICB2YXIgdzIgPSAxIC0gdzE7XHJcblxyXG4gICAgICAgIHZhciByZ2JhID0ge1xyXG4gICAgICAgICAgICByOiByZ2IyLnIgKiB3MSArIHJnYjEuciAqIHcyLFxyXG4gICAgICAgICAgICBnOiByZ2IyLmcgKiB3MSArIHJnYjEuZyAqIHcyLFxyXG4gICAgICAgICAgICBiOiByZ2IyLmIgKiB3MSArIHJnYjEuYiAqIHcyLFxyXG4gICAgICAgICAgICBhOiByZ2IyLmEgKiBwICArIHJnYjEuYSAqICgxIC0gcClcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4gdGlueWNvbG9yKHJnYmEpO1xyXG4gICAgfTtcclxuXHJcblxyXG4gICAgLy8gUmVhZGFiaWxpdHkgRnVuY3Rpb25zXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIDxodHRwOi8vd3d3LnczLm9yZy9UUi9BRVJUI2NvbG9yLWNvbnRyYXN0PlxyXG5cclxuICAgIC8vIGByZWFkYWJpbGl0eWBcclxuICAgIC8vIEFuYWx5emUgdGhlIDIgY29sb3JzIGFuZCByZXR1cm5zIGFuIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcclxuICAgIC8vICAgIGBicmlnaHRuZXNzYDogZGlmZmVyZW5jZSBpbiBicmlnaHRuZXNzIGJldHdlZW4gdGhlIHR3byBjb2xvcnNcclxuICAgIC8vICAgIGBjb2xvcmA6IGRpZmZlcmVuY2UgaW4gY29sb3IvaHVlIGJldHdlZW4gdGhlIHR3byBjb2xvcnNcclxuICAgIHRpbnljb2xvci5yZWFkYWJpbGl0eSA9IGZ1bmN0aW9uKGNvbG9yMSwgY29sb3IyKSB7XHJcbiAgICAgICAgdmFyIGMxID0gdGlueWNvbG9yKGNvbG9yMSk7XHJcbiAgICAgICAgdmFyIGMyID0gdGlueWNvbG9yKGNvbG9yMik7XHJcbiAgICAgICAgdmFyIHJnYjEgPSBjMS50b1JnYigpO1xyXG4gICAgICAgIHZhciByZ2IyID0gYzIudG9SZ2IoKTtcclxuICAgICAgICB2YXIgYnJpZ2h0bmVzc0EgPSBjMS5nZXRCcmlnaHRuZXNzKCk7XHJcbiAgICAgICAgdmFyIGJyaWdodG5lc3NCID0gYzIuZ2V0QnJpZ2h0bmVzcygpO1xyXG4gICAgICAgIHZhciBjb2xvckRpZmYgPSAoXHJcbiAgICAgICAgICAgIE1hdGgubWF4KHJnYjEuciwgcmdiMi5yKSAtIE1hdGgubWluKHJnYjEuciwgcmdiMi5yKSArXHJcbiAgICAgICAgICAgIE1hdGgubWF4KHJnYjEuZywgcmdiMi5nKSAtIE1hdGgubWluKHJnYjEuZywgcmdiMi5nKSArXHJcbiAgICAgICAgICAgIE1hdGgubWF4KHJnYjEuYiwgcmdiMi5iKSAtIE1hdGgubWluKHJnYjEuYiwgcmdiMi5iKVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGJyaWdodG5lc3M6IE1hdGguYWJzKGJyaWdodG5lc3NBIC0gYnJpZ2h0bmVzc0IpLFxyXG4gICAgICAgICAgICBjb2xvcjogY29sb3JEaWZmXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgLy8gYHJlYWRhYmxlYFxyXG4gICAgLy8gaHR0cDovL3d3dy53My5vcmcvVFIvQUVSVCNjb2xvci1jb250cmFzdFxyXG4gICAgLy8gRW5zdXJlIHRoYXQgZm9yZWdyb3VuZCBhbmQgYmFja2dyb3VuZCBjb2xvciBjb21iaW5hdGlvbnMgcHJvdmlkZSBzdWZmaWNpZW50IGNvbnRyYXN0LlxyXG4gICAgLy8gKkV4YW1wbGUqXHJcbiAgICAvLyAgICB0aW55Y29sb3IuaXNSZWFkYWJsZShcIiMwMDBcIiwgXCIjMTExXCIpID0+IGZhbHNlXHJcbiAgICB0aW55Y29sb3IuaXNSZWFkYWJsZSA9IGZ1bmN0aW9uKGNvbG9yMSwgY29sb3IyKSB7XHJcbiAgICAgICAgdmFyIHJlYWRhYmlsaXR5ID0gdGlueWNvbG9yLnJlYWRhYmlsaXR5KGNvbG9yMSwgY29sb3IyKTtcclxuICAgICAgICByZXR1cm4gcmVhZGFiaWxpdHkuYnJpZ2h0bmVzcyA+IDEyNSAmJiByZWFkYWJpbGl0eS5jb2xvciA+IDUwMDtcclxuICAgIH07XHJcblxyXG4gICAgLy8gYG1vc3RSZWFkYWJsZWBcclxuICAgIC8vIEdpdmVuIGEgYmFzZSBjb2xvciBhbmQgYSBsaXN0IG9mIHBvc3NpYmxlIGZvcmVncm91bmQgb3IgYmFja2dyb3VuZFxyXG4gICAgLy8gY29sb3JzIGZvciB0aGF0IGJhc2UsIHJldHVybnMgdGhlIG1vc3QgcmVhZGFibGUgY29sb3IuXHJcbiAgICAvLyAqRXhhbXBsZSpcclxuICAgIC8vICAgIHRpbnljb2xvci5tb3N0UmVhZGFibGUoXCIjMTIzXCIsIFtcIiNmZmZcIiwgXCIjMDAwXCJdKSA9PiBcIiMwMDBcIlxyXG4gICAgdGlueWNvbG9yLm1vc3RSZWFkYWJsZSA9IGZ1bmN0aW9uKGJhc2VDb2xvciwgY29sb3JMaXN0KSB7XHJcbiAgICAgICAgdmFyIGJlc3RDb2xvciA9IG51bGw7XHJcbiAgICAgICAgdmFyIGJlc3RTY29yZSA9IDA7XHJcbiAgICAgICAgdmFyIGJlc3RJc1JlYWRhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgZm9yICh2YXIgaT0wOyBpIDwgY29sb3JMaXN0Lmxlbmd0aDsgaSsrKSB7XHJcblxyXG4gICAgICAgICAgICAvLyBXZSBub3JtYWxpemUgYm90aCBhcm91bmQgdGhlIFwiYWNjZXB0YWJsZVwiIGJyZWFraW5nIHBvaW50LFxyXG4gICAgICAgICAgICAvLyBidXQgcmFuayBicmlnaHRuZXNzIGNvbnN0cmFzdCBoaWdoZXIgdGhhbiBodWUuXHJcblxyXG4gICAgICAgICAgICB2YXIgcmVhZGFiaWxpdHkgPSB0aW55Y29sb3IucmVhZGFiaWxpdHkoYmFzZUNvbG9yLCBjb2xvckxpc3RbaV0pO1xyXG4gICAgICAgICAgICB2YXIgcmVhZGFibGUgPSByZWFkYWJpbGl0eS5icmlnaHRuZXNzID4gMTI1ICYmIHJlYWRhYmlsaXR5LmNvbG9yID4gNTAwO1xyXG4gICAgICAgICAgICB2YXIgc2NvcmUgPSAzICogKHJlYWRhYmlsaXR5LmJyaWdodG5lc3MgLyAxMjUpICsgKHJlYWRhYmlsaXR5LmNvbG9yIC8gNTAwKTtcclxuXHJcbiAgICAgICAgICAgIGlmICgocmVhZGFibGUgJiYgISBiZXN0SXNSZWFkYWJsZSkgfHxcclxuICAgICAgICAgICAgICAgIChyZWFkYWJsZSAmJiBiZXN0SXNSZWFkYWJsZSAmJiBzY29yZSA+IGJlc3RTY29yZSkgfHxcclxuICAgICAgICAgICAgICAgICgoISByZWFkYWJsZSkgJiYgKCEgYmVzdElzUmVhZGFibGUpICYmIHNjb3JlID4gYmVzdFNjb3JlKSkge1xyXG4gICAgICAgICAgICAgICAgYmVzdElzUmVhZGFibGUgPSByZWFkYWJsZTtcclxuICAgICAgICAgICAgICAgIGJlc3RTY29yZSA9IHNjb3JlO1xyXG4gICAgICAgICAgICAgICAgYmVzdENvbG9yID0gdGlueWNvbG9yKGNvbG9yTGlzdFtpXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGJlc3RDb2xvcjtcclxuICAgIH07XHJcblxyXG5cclxuICAgIC8vIEJpZyBMaXN0IG9mIENvbG9yc1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyA8aHR0cDovL3d3dy53My5vcmcvVFIvY3NzMy1jb2xvci8jc3ZnLWNvbG9yPlxyXG4gICAgdmFyIG5hbWVzID0gdGlueWNvbG9yLm5hbWVzID0ge1xyXG4gICAgICAgIGFsaWNlYmx1ZTogXCJmMGY4ZmZcIixcclxuICAgICAgICBhbnRpcXVld2hpdGU6IFwiZmFlYmQ3XCIsXHJcbiAgICAgICAgYXF1YTogXCIwZmZcIixcclxuICAgICAgICBhcXVhbWFyaW5lOiBcIjdmZmZkNFwiLFxyXG4gICAgICAgIGF6dXJlOiBcImYwZmZmZlwiLFxyXG4gICAgICAgIGJlaWdlOiBcImY1ZjVkY1wiLFxyXG4gICAgICAgIGJpc3F1ZTogXCJmZmU0YzRcIixcclxuICAgICAgICBibGFjazogXCIwMDBcIixcclxuICAgICAgICBibGFuY2hlZGFsbW9uZDogXCJmZmViY2RcIixcclxuICAgICAgICBibHVlOiBcIjAwZlwiLFxyXG4gICAgICAgIGJsdWV2aW9sZXQ6IFwiOGEyYmUyXCIsXHJcbiAgICAgICAgYnJvd246IFwiYTUyYTJhXCIsXHJcbiAgICAgICAgYnVybHl3b29kOiBcImRlYjg4N1wiLFxyXG4gICAgICAgIGJ1cm50c2llbm5hOiBcImVhN2U1ZFwiLFxyXG4gICAgICAgIGNhZGV0Ymx1ZTogXCI1ZjllYTBcIixcclxuICAgICAgICBjaGFydHJldXNlOiBcIjdmZmYwMFwiLFxyXG4gICAgICAgIGNob2NvbGF0ZTogXCJkMjY5MWVcIixcclxuICAgICAgICBjb3JhbDogXCJmZjdmNTBcIixcclxuICAgICAgICBjb3JuZmxvd2VyYmx1ZTogXCI2NDk1ZWRcIixcclxuICAgICAgICBjb3Juc2lsazogXCJmZmY4ZGNcIixcclxuICAgICAgICBjcmltc29uOiBcImRjMTQzY1wiLFxyXG4gICAgICAgIGN5YW46IFwiMGZmXCIsXHJcbiAgICAgICAgZGFya2JsdWU6IFwiMDAwMDhiXCIsXHJcbiAgICAgICAgZGFya2N5YW46IFwiMDA4YjhiXCIsXHJcbiAgICAgICAgZGFya2dvbGRlbnJvZDogXCJiODg2MGJcIixcclxuICAgICAgICBkYXJrZ3JheTogXCJhOWE5YTlcIixcclxuICAgICAgICBkYXJrZ3JlZW46IFwiMDA2NDAwXCIsXHJcbiAgICAgICAgZGFya2dyZXk6IFwiYTlhOWE5XCIsXHJcbiAgICAgICAgZGFya2toYWtpOiBcImJkYjc2YlwiLFxyXG4gICAgICAgIGRhcmttYWdlbnRhOiBcIjhiMDA4YlwiLFxyXG4gICAgICAgIGRhcmtvbGl2ZWdyZWVuOiBcIjU1NmIyZlwiLFxyXG4gICAgICAgIGRhcmtvcmFuZ2U6IFwiZmY4YzAwXCIsXHJcbiAgICAgICAgZGFya29yY2hpZDogXCI5OTMyY2NcIixcclxuICAgICAgICBkYXJrcmVkOiBcIjhiMDAwMFwiLFxyXG4gICAgICAgIGRhcmtzYWxtb246IFwiZTk5NjdhXCIsXHJcbiAgICAgICAgZGFya3NlYWdyZWVuOiBcIjhmYmM4ZlwiLFxyXG4gICAgICAgIGRhcmtzbGF0ZWJsdWU6IFwiNDgzZDhiXCIsXHJcbiAgICAgICAgZGFya3NsYXRlZ3JheTogXCIyZjRmNGZcIixcclxuICAgICAgICBkYXJrc2xhdGVncmV5OiBcIjJmNGY0ZlwiLFxyXG4gICAgICAgIGRhcmt0dXJxdW9pc2U6IFwiMDBjZWQxXCIsXHJcbiAgICAgICAgZGFya3Zpb2xldDogXCI5NDAwZDNcIixcclxuICAgICAgICBkZWVwcGluazogXCJmZjE0OTNcIixcclxuICAgICAgICBkZWVwc2t5Ymx1ZTogXCIwMGJmZmZcIixcclxuICAgICAgICBkaW1ncmF5OiBcIjY5Njk2OVwiLFxyXG4gICAgICAgIGRpbWdyZXk6IFwiNjk2OTY5XCIsXHJcbiAgICAgICAgZG9kZ2VyYmx1ZTogXCIxZTkwZmZcIixcclxuICAgICAgICBmaXJlYnJpY2s6IFwiYjIyMjIyXCIsXHJcbiAgICAgICAgZmxvcmFsd2hpdGU6IFwiZmZmYWYwXCIsXHJcbiAgICAgICAgZm9yZXN0Z3JlZW46IFwiMjI4YjIyXCIsXHJcbiAgICAgICAgZnVjaHNpYTogXCJmMGZcIixcclxuICAgICAgICBnYWluc2Jvcm86IFwiZGNkY2RjXCIsXHJcbiAgICAgICAgZ2hvc3R3aGl0ZTogXCJmOGY4ZmZcIixcclxuICAgICAgICBnb2xkOiBcImZmZDcwMFwiLFxyXG4gICAgICAgIGdvbGRlbnJvZDogXCJkYWE1MjBcIixcclxuICAgICAgICBncmF5OiBcIjgwODA4MFwiLFxyXG4gICAgICAgIGdyZWVuOiBcIjAwODAwMFwiLFxyXG4gICAgICAgIGdyZWVueWVsbG93OiBcImFkZmYyZlwiLFxyXG4gICAgICAgIGdyZXk6IFwiODA4MDgwXCIsXHJcbiAgICAgICAgaG9uZXlkZXc6IFwiZjBmZmYwXCIsXHJcbiAgICAgICAgaG90cGluazogXCJmZjY5YjRcIixcclxuICAgICAgICBpbmRpYW5yZWQ6IFwiY2Q1YzVjXCIsXHJcbiAgICAgICAgaW5kaWdvOiBcIjRiMDA4MlwiLFxyXG4gICAgICAgIGl2b3J5OiBcImZmZmZmMFwiLFxyXG4gICAgICAgIGtoYWtpOiBcImYwZTY4Y1wiLFxyXG4gICAgICAgIGxhdmVuZGVyOiBcImU2ZTZmYVwiLFxyXG4gICAgICAgIGxhdmVuZGVyYmx1c2g6IFwiZmZmMGY1XCIsXHJcbiAgICAgICAgbGF3bmdyZWVuOiBcIjdjZmMwMFwiLFxyXG4gICAgICAgIGxlbW9uY2hpZmZvbjogXCJmZmZhY2RcIixcclxuICAgICAgICBsaWdodGJsdWU6IFwiYWRkOGU2XCIsXHJcbiAgICAgICAgbGlnaHRjb3JhbDogXCJmMDgwODBcIixcclxuICAgICAgICBsaWdodGN5YW46IFwiZTBmZmZmXCIsXHJcbiAgICAgICAgbGlnaHRnb2xkZW5yb2R5ZWxsb3c6IFwiZmFmYWQyXCIsXHJcbiAgICAgICAgbGlnaHRncmF5OiBcImQzZDNkM1wiLFxyXG4gICAgICAgIGxpZ2h0Z3JlZW46IFwiOTBlZTkwXCIsXHJcbiAgICAgICAgbGlnaHRncmV5OiBcImQzZDNkM1wiLFxyXG4gICAgICAgIGxpZ2h0cGluazogXCJmZmI2YzFcIixcclxuICAgICAgICBsaWdodHNhbG1vbjogXCJmZmEwN2FcIixcclxuICAgICAgICBsaWdodHNlYWdyZWVuOiBcIjIwYjJhYVwiLFxyXG4gICAgICAgIGxpZ2h0c2t5Ymx1ZTogXCI4N2NlZmFcIixcclxuICAgICAgICBsaWdodHNsYXRlZ3JheTogXCI3ODlcIixcclxuICAgICAgICBsaWdodHNsYXRlZ3JleTogXCI3ODlcIixcclxuICAgICAgICBsaWdodHN0ZWVsYmx1ZTogXCJiMGM0ZGVcIixcclxuICAgICAgICBsaWdodHllbGxvdzogXCJmZmZmZTBcIixcclxuICAgICAgICBsaW1lOiBcIjBmMFwiLFxyXG4gICAgICAgIGxpbWVncmVlbjogXCIzMmNkMzJcIixcclxuICAgICAgICBsaW5lbjogXCJmYWYwZTZcIixcclxuICAgICAgICBtYWdlbnRhOiBcImYwZlwiLFxyXG4gICAgICAgIG1hcm9vbjogXCI4MDAwMDBcIixcclxuICAgICAgICBtZWRpdW1hcXVhbWFyaW5lOiBcIjY2Y2RhYVwiLFxyXG4gICAgICAgIG1lZGl1bWJsdWU6IFwiMDAwMGNkXCIsXHJcbiAgICAgICAgbWVkaXVtb3JjaGlkOiBcImJhNTVkM1wiLFxyXG4gICAgICAgIG1lZGl1bXB1cnBsZTogXCI5MzcwZGJcIixcclxuICAgICAgICBtZWRpdW1zZWFncmVlbjogXCIzY2IzNzFcIixcclxuICAgICAgICBtZWRpdW1zbGF0ZWJsdWU6IFwiN2I2OGVlXCIsXHJcbiAgICAgICAgbWVkaXVtc3ByaW5nZ3JlZW46IFwiMDBmYTlhXCIsXHJcbiAgICAgICAgbWVkaXVtdHVycXVvaXNlOiBcIjQ4ZDFjY1wiLFxyXG4gICAgICAgIG1lZGl1bXZpb2xldHJlZDogXCJjNzE1ODVcIixcclxuICAgICAgICBtaWRuaWdodGJsdWU6IFwiMTkxOTcwXCIsXHJcbiAgICAgICAgbWludGNyZWFtOiBcImY1ZmZmYVwiLFxyXG4gICAgICAgIG1pc3R5cm9zZTogXCJmZmU0ZTFcIixcclxuICAgICAgICBtb2NjYXNpbjogXCJmZmU0YjVcIixcclxuICAgICAgICBuYXZham93aGl0ZTogXCJmZmRlYWRcIixcclxuICAgICAgICBuYXZ5OiBcIjAwMDA4MFwiLFxyXG4gICAgICAgIG9sZGxhY2U6IFwiZmRmNWU2XCIsXHJcbiAgICAgICAgb2xpdmU6IFwiODA4MDAwXCIsXHJcbiAgICAgICAgb2xpdmVkcmFiOiBcIjZiOGUyM1wiLFxyXG4gICAgICAgIG9yYW5nZTogXCJmZmE1MDBcIixcclxuICAgICAgICBvcmFuZ2VyZWQ6IFwiZmY0NTAwXCIsXHJcbiAgICAgICAgb3JjaGlkOiBcImRhNzBkNlwiLFxyXG4gICAgICAgIHBhbGVnb2xkZW5yb2Q6IFwiZWVlOGFhXCIsXHJcbiAgICAgICAgcGFsZWdyZWVuOiBcIjk4ZmI5OFwiLFxyXG4gICAgICAgIHBhbGV0dXJxdW9pc2U6IFwiYWZlZWVlXCIsXHJcbiAgICAgICAgcGFsZXZpb2xldHJlZDogXCJkYjcwOTNcIixcclxuICAgICAgICBwYXBheWF3aGlwOiBcImZmZWZkNVwiLFxyXG4gICAgICAgIHBlYWNocHVmZjogXCJmZmRhYjlcIixcclxuICAgICAgICBwZXJ1OiBcImNkODUzZlwiLFxyXG4gICAgICAgIHBpbms6IFwiZmZjMGNiXCIsXHJcbiAgICAgICAgcGx1bTogXCJkZGEwZGRcIixcclxuICAgICAgICBwb3dkZXJibHVlOiBcImIwZTBlNlwiLFxyXG4gICAgICAgIHB1cnBsZTogXCI4MDAwODBcIixcclxuICAgICAgICByZWJlY2NhcHVycGxlOiBcIjY2MzM5OVwiLFxyXG4gICAgICAgIHJlZDogXCJmMDBcIixcclxuICAgICAgICByb3N5YnJvd246IFwiYmM4ZjhmXCIsXHJcbiAgICAgICAgcm95YWxibHVlOiBcIjQxNjllMVwiLFxyXG4gICAgICAgIHNhZGRsZWJyb3duOiBcIjhiNDUxM1wiLFxyXG4gICAgICAgIHNhbG1vbjogXCJmYTgwNzJcIixcclxuICAgICAgICBzYW5keWJyb3duOiBcImY0YTQ2MFwiLFxyXG4gICAgICAgIHNlYWdyZWVuOiBcIjJlOGI1N1wiLFxyXG4gICAgICAgIHNlYXNoZWxsOiBcImZmZjVlZVwiLFxyXG4gICAgICAgIHNpZW5uYTogXCJhMDUyMmRcIixcclxuICAgICAgICBzaWx2ZXI6IFwiYzBjMGMwXCIsXHJcbiAgICAgICAgc2t5Ymx1ZTogXCI4N2NlZWJcIixcclxuICAgICAgICBzbGF0ZWJsdWU6IFwiNmE1YWNkXCIsXHJcbiAgICAgICAgc2xhdGVncmF5OiBcIjcwODA5MFwiLFxyXG4gICAgICAgIHNsYXRlZ3JleTogXCI3MDgwOTBcIixcclxuICAgICAgICBzbm93OiBcImZmZmFmYVwiLFxyXG4gICAgICAgIHNwcmluZ2dyZWVuOiBcIjAwZmY3ZlwiLFxyXG4gICAgICAgIHN0ZWVsYmx1ZTogXCI0NjgyYjRcIixcclxuICAgICAgICB0YW46IFwiZDJiNDhjXCIsXHJcbiAgICAgICAgdGVhbDogXCIwMDgwODBcIixcclxuICAgICAgICB0aGlzdGxlOiBcImQ4YmZkOFwiLFxyXG4gICAgICAgIHRvbWF0bzogXCJmZjYzNDdcIixcclxuICAgICAgICB0dXJxdW9pc2U6IFwiNDBlMGQwXCIsXHJcbiAgICAgICAgdmlvbGV0OiBcImVlODJlZVwiLFxyXG4gICAgICAgIHdoZWF0OiBcImY1ZGViM1wiLFxyXG4gICAgICAgIHdoaXRlOiBcImZmZlwiLFxyXG4gICAgICAgIHdoaXRlc21va2U6IFwiZjVmNWY1XCIsXHJcbiAgICAgICAgeWVsbG93OiBcImZmMFwiLFxyXG4gICAgICAgIHllbGxvd2dyZWVuOiBcIjlhY2QzMlwiXHJcbiAgICB9O1xyXG5cclxuICAgIC8vIE1ha2UgaXQgZWFzeSB0byBhY2Nlc3MgY29sb3JzIHZpYSBgaGV4TmFtZXNbaGV4XWBcclxuICAgIHZhciBoZXhOYW1lcyA9IHRpbnljb2xvci5oZXhOYW1lcyA9IGZsaXAobmFtZXMpO1xyXG5cclxuXHJcbiAgICAvLyBVdGlsaXRpZXNcclxuICAgIC8vIC0tLS0tLS0tLVxyXG5cclxuICAgIC8vIGB7ICduYW1lMSc6ICd2YWwxJyB9YCBiZWNvbWVzIGB7ICd2YWwxJzogJ25hbWUxJyB9YFxyXG4gICAgZnVuY3Rpb24gZmxpcChvKSB7XHJcbiAgICAgICAgdmFyIGZsaXBwZWQgPSB7IH07XHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiBvKSB7XHJcbiAgICAgICAgICAgIGlmIChvLmhhc093blByb3BlcnR5KGkpKSB7XHJcbiAgICAgICAgICAgICAgICBmbGlwcGVkW29baV1dID0gaTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmxpcHBlZDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZXR1cm4gYSB2YWxpZCBhbHBoYSB2YWx1ZSBbMCwxXSB3aXRoIGFsbCBpbnZhbGlkIHZhbHVlcyBiZWluZyBzZXQgdG8gMVxyXG4gICAgZnVuY3Rpb24gYm91bmRBbHBoYShhKSB7XHJcbiAgICAgICAgYSA9IHBhcnNlRmxvYXQoYSk7XHJcblxyXG4gICAgICAgIGlmIChpc05hTihhKSB8fCBhIDwgMCB8fCBhID4gMSkge1xyXG4gICAgICAgICAgICBhID0gMTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBhO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFRha2UgaW5wdXQgZnJvbSBbMCwgbl0gYW5kIHJldHVybiBpdCBhcyBbMCwgMV1cclxuICAgIGZ1bmN0aW9uIGJvdW5kMDEobiwgbWF4KSB7XHJcbiAgICAgICAgaWYgKGlzT25lUG9pbnRaZXJvKG4pKSB7IG4gPSBcIjEwMCVcIjsgfVxyXG5cclxuICAgICAgICB2YXIgcHJvY2Vzc1BlcmNlbnQgPSBpc1BlcmNlbnRhZ2Uobik7XHJcbiAgICAgICAgbiA9IG1hdGhNaW4obWF4LCBtYXRoTWF4KDAsIHBhcnNlRmxvYXQobikpKTtcclxuXHJcbiAgICAgICAgLy8gQXV0b21hdGljYWxseSBjb252ZXJ0IHBlcmNlbnRhZ2UgaW50byBudW1iZXJcclxuICAgICAgICBpZiAocHJvY2Vzc1BlcmNlbnQpIHtcclxuICAgICAgICAgICAgbiA9IHBhcnNlSW50KG4gKiBtYXgsIDEwKSAvIDEwMDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEhhbmRsZSBmbG9hdGluZyBwb2ludCByb3VuZGluZyBlcnJvcnNcclxuICAgICAgICBpZiAoKG1hdGguYWJzKG4gLSBtYXgpIDwgMC4wMDAwMDEpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAxO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ29udmVydCBpbnRvIFswLCAxXSByYW5nZSBpZiBpdCBpc24ndCBhbHJlYWR5XHJcbiAgICAgICAgcmV0dXJuIChuICUgbWF4KSAvIHBhcnNlRmxvYXQobWF4KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBGb3JjZSBhIG51bWJlciBiZXR3ZWVuIDAgYW5kIDFcclxuICAgIGZ1bmN0aW9uIGNsYW1wMDEodmFsKSB7XHJcbiAgICAgICAgcmV0dXJuIG1hdGhNaW4oMSwgbWF0aE1heCgwLCB2YWwpKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBQYXJzZSBhIGJhc2UtMTYgaGV4IHZhbHVlIGludG8gYSBiYXNlLTEwIGludGVnZXJcclxuICAgIGZ1bmN0aW9uIHBhcnNlSW50RnJvbUhleCh2YWwpIHtcclxuICAgICAgICByZXR1cm4gcGFyc2VJbnQodmFsLCAxNik7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gTmVlZCB0byBoYW5kbGUgMS4wIGFzIDEwMCUsIHNpbmNlIG9uY2UgaXQgaXMgYSBudW1iZXIsIHRoZXJlIGlzIG5vIGRpZmZlcmVuY2UgYmV0d2VlbiBpdCBhbmQgMVxyXG4gICAgLy8gPGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNzQyMjA3Mi9qYXZhc2NyaXB0LWhvdy10by1kZXRlY3QtbnVtYmVyLWFzLWEtZGVjaW1hbC1pbmNsdWRpbmctMS0wPlxyXG4gICAgZnVuY3Rpb24gaXNPbmVQb2ludFplcm8obikge1xyXG4gICAgICAgIHJldHVybiB0eXBlb2YgbiA9PSBcInN0cmluZ1wiICYmIG4uaW5kZXhPZignLicpICE9IC0xICYmIHBhcnNlRmxvYXQobikgPT09IDE7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgdG8gc2VlIGlmIHN0cmluZyBwYXNzZWQgaW4gaXMgYSBwZXJjZW50YWdlXHJcbiAgICBmdW5jdGlvbiBpc1BlcmNlbnRhZ2Uobikge1xyXG4gICAgICAgIHJldHVybiB0eXBlb2YgbiA9PT0gXCJzdHJpbmdcIiAmJiBuLmluZGV4T2YoJyUnKSAhPSAtMTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBGb3JjZSBhIGhleCB2YWx1ZSB0byBoYXZlIDIgY2hhcmFjdGVyc1xyXG4gICAgZnVuY3Rpb24gcGFkMihjKSB7XHJcbiAgICAgICAgcmV0dXJuIGMubGVuZ3RoID09IDEgPyAnMCcgKyBjIDogJycgKyBjO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFJlcGxhY2UgYSBkZWNpbWFsIHdpdGggaXQncyBwZXJjZW50YWdlIHZhbHVlXHJcbiAgICBmdW5jdGlvbiBjb252ZXJ0VG9QZXJjZW50YWdlKG4pIHtcclxuICAgICAgICBpZiAobiA8PSAxKSB7XHJcbiAgICAgICAgICAgIG4gPSAobiAqIDEwMCkgKyBcIiVcIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENvbnZlcnRzIGEgZGVjaW1hbCB0byBhIGhleCB2YWx1ZVxyXG4gICAgZnVuY3Rpb24gY29udmVydERlY2ltYWxUb0hleChkKSB7XHJcbiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQocGFyc2VGbG9hdChkKSAqIDI1NSkudG9TdHJpbmcoMTYpO1xyXG4gICAgfVxyXG4gICAgLy8gQ29udmVydHMgYSBoZXggdmFsdWUgdG8gYSBkZWNpbWFsXHJcbiAgICBmdW5jdGlvbiBjb252ZXJ0SGV4VG9EZWNpbWFsKGgpIHtcclxuICAgICAgICByZXR1cm4gKHBhcnNlSW50RnJvbUhleChoKSAvIDI1NSk7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIG1hdGNoZXJzID0gKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAvLyA8aHR0cDovL3d3dy53My5vcmcvVFIvY3NzMy12YWx1ZXMvI2ludGVnZXJzPlxyXG4gICAgICAgIHZhciBDU1NfSU5URUdFUiA9IFwiWy1cXFxcK10/XFxcXGQrJT9cIjtcclxuXHJcbiAgICAgICAgLy8gPGh0dHA6Ly93d3cudzMub3JnL1RSL2NzczMtdmFsdWVzLyNudW1iZXItdmFsdWU+XHJcbiAgICAgICAgdmFyIENTU19OVU1CRVIgPSBcIlstXFxcXCtdP1xcXFxkKlxcXFwuXFxcXGQrJT9cIjtcclxuXHJcbiAgICAgICAgLy8gQWxsb3cgcG9zaXRpdmUvbmVnYXRpdmUgaW50ZWdlci9udW1iZXIuICBEb24ndCBjYXB0dXJlIHRoZSBlaXRoZXIvb3IsIGp1c3QgdGhlIGVudGlyZSBvdXRjb21lLlxyXG4gICAgICAgIHZhciBDU1NfVU5JVCA9IFwiKD86XCIgKyBDU1NfTlVNQkVSICsgXCIpfCg/OlwiICsgQ1NTX0lOVEVHRVIgKyBcIilcIjtcclxuXHJcbiAgICAgICAgLy8gQWN0dWFsIG1hdGNoaW5nLlxyXG4gICAgICAgIC8vIFBhcmVudGhlc2VzIGFuZCBjb21tYXMgYXJlIG9wdGlvbmFsLCBidXQgbm90IHJlcXVpcmVkLlxyXG4gICAgICAgIC8vIFdoaXRlc3BhY2UgY2FuIHRha2UgdGhlIHBsYWNlIG9mIGNvbW1hcyBvciBvcGVuaW5nIHBhcmVuXHJcbiAgICAgICAgdmFyIFBFUk1JU1NJVkVfTUFUQ0gzID0gXCJbXFxcXHN8XFxcXChdKyhcIiArIENTU19VTklUICsgXCIpWyx8XFxcXHNdKyhcIiArIENTU19VTklUICsgXCIpWyx8XFxcXHNdKyhcIiArIENTU19VTklUICsgXCIpXFxcXHMqXFxcXCk/XCI7XHJcbiAgICAgICAgdmFyIFBFUk1JU1NJVkVfTUFUQ0g0ID0gXCJbXFxcXHN8XFxcXChdKyhcIiArIENTU19VTklUICsgXCIpWyx8XFxcXHNdKyhcIiArIENTU19VTklUICsgXCIpWyx8XFxcXHNdKyhcIiArIENTU19VTklUICsgXCIpWyx8XFxcXHNdKyhcIiArIENTU19VTklUICsgXCIpXFxcXHMqXFxcXCk/XCI7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJnYjogbmV3IFJlZ0V4cChcInJnYlwiICsgUEVSTUlTU0lWRV9NQVRDSDMpLFxyXG4gICAgICAgICAgICByZ2JhOiBuZXcgUmVnRXhwKFwicmdiYVwiICsgUEVSTUlTU0lWRV9NQVRDSDQpLFxyXG4gICAgICAgICAgICBoc2w6IG5ldyBSZWdFeHAoXCJoc2xcIiArIFBFUk1JU1NJVkVfTUFUQ0gzKSxcclxuICAgICAgICAgICAgaHNsYTogbmV3IFJlZ0V4cChcImhzbGFcIiArIFBFUk1JU1NJVkVfTUFUQ0g0KSxcclxuICAgICAgICAgICAgaHN2OiBuZXcgUmVnRXhwKFwiaHN2XCIgKyBQRVJNSVNTSVZFX01BVENIMyksXHJcbiAgICAgICAgICAgIGhzdmE6IG5ldyBSZWdFeHAoXCJoc3ZhXCIgKyBQRVJNSVNTSVZFX01BVENINCksXHJcbiAgICAgICAgICAgIGhleDM6IC9eKFswLTlhLWZBLUZdezF9KShbMC05YS1mQS1GXXsxfSkoWzAtOWEtZkEtRl17MX0pJC8sXHJcbiAgICAgICAgICAgIGhleDY6IC9eKFswLTlhLWZBLUZdezJ9KShbMC05YS1mQS1GXXsyfSkoWzAtOWEtZkEtRl17Mn0pJC8sXHJcbiAgICAgICAgICAgIGhleDg6IC9eKFswLTlhLWZBLUZdezJ9KShbMC05YS1mQS1GXXsyfSkoWzAtOWEtZkEtRl17Mn0pKFswLTlhLWZBLUZdezJ9KSQvXHJcbiAgICAgICAgfTtcclxuICAgIH0pKCk7XHJcblxyXG4gICAgLy8gYHN0cmluZ0lucHV0VG9PYmplY3RgXHJcbiAgICAvLyBQZXJtaXNzaXZlIHN0cmluZyBwYXJzaW5nLiAgVGFrZSBpbiBhIG51bWJlciBvZiBmb3JtYXRzLCBhbmQgb3V0cHV0IGFuIG9iamVjdFxyXG4gICAgLy8gYmFzZWQgb24gZGV0ZWN0ZWQgZm9ybWF0LiAgUmV0dXJucyBgeyByLCBnLCBiIH1gIG9yIGB7IGgsIHMsIGwgfWAgb3IgYHsgaCwgcywgdn1gXHJcbiAgICBmdW5jdGlvbiBzdHJpbmdJbnB1dFRvT2JqZWN0KGNvbG9yKSB7XHJcblxyXG4gICAgICAgIGNvbG9yID0gY29sb3IucmVwbGFjZSh0cmltTGVmdCwnJykucmVwbGFjZSh0cmltUmlnaHQsICcnKS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgIHZhciBuYW1lZCA9IGZhbHNlO1xyXG4gICAgICAgIGlmIChuYW1lc1tjb2xvcl0pIHtcclxuICAgICAgICAgICAgY29sb3IgPSBuYW1lc1tjb2xvcl07XHJcbiAgICAgICAgICAgIG5hbWVkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoY29sb3IgPT0gJ3RyYW5zcGFyZW50Jykge1xyXG4gICAgICAgICAgICByZXR1cm4geyByOiAwLCBnOiAwLCBiOiAwLCBhOiAwLCBmb3JtYXQ6IFwibmFtZVwiIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBUcnkgdG8gbWF0Y2ggc3RyaW5nIGlucHV0IHVzaW5nIHJlZ3VsYXIgZXhwcmVzc2lvbnMuXHJcbiAgICAgICAgLy8gS2VlcCBtb3N0IG9mIHRoZSBudW1iZXIgYm91bmRpbmcgb3V0IG9mIHRoaXMgZnVuY3Rpb24gLSBkb24ndCB3b3JyeSBhYm91dCBbMCwxXSBvciBbMCwxMDBdIG9yIFswLDM2MF1cclxuICAgICAgICAvLyBKdXN0IHJldHVybiBhbiBvYmplY3QgYW5kIGxldCB0aGUgY29udmVyc2lvbiBmdW5jdGlvbnMgaGFuZGxlIHRoYXQuXHJcbiAgICAgICAgLy8gVGhpcyB3YXkgdGhlIHJlc3VsdCB3aWxsIGJlIHRoZSBzYW1lIHdoZXRoZXIgdGhlIHRpbnljb2xvciBpcyBpbml0aWFsaXplZCB3aXRoIHN0cmluZyBvciBvYmplY3QuXHJcbiAgICAgICAgdmFyIG1hdGNoO1xyXG4gICAgICAgIGlmICgobWF0Y2ggPSBtYXRjaGVycy5yZ2IuZXhlYyhjb2xvcikpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHI6IG1hdGNoWzFdLCBnOiBtYXRjaFsyXSwgYjogbWF0Y2hbM10gfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKChtYXRjaCA9IG1hdGNoZXJzLnJnYmEuZXhlYyhjb2xvcikpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHI6IG1hdGNoWzFdLCBnOiBtYXRjaFsyXSwgYjogbWF0Y2hbM10sIGE6IG1hdGNoWzRdIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgobWF0Y2ggPSBtYXRjaGVycy5oc2wuZXhlYyhjb2xvcikpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IGg6IG1hdGNoWzFdLCBzOiBtYXRjaFsyXSwgbDogbWF0Y2hbM10gfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKChtYXRjaCA9IG1hdGNoZXJzLmhzbGEuZXhlYyhjb2xvcikpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IGg6IG1hdGNoWzFdLCBzOiBtYXRjaFsyXSwgbDogbWF0Y2hbM10sIGE6IG1hdGNoWzRdIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgobWF0Y2ggPSBtYXRjaGVycy5oc3YuZXhlYyhjb2xvcikpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IGg6IG1hdGNoWzFdLCBzOiBtYXRjaFsyXSwgdjogbWF0Y2hbM10gfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKChtYXRjaCA9IG1hdGNoZXJzLmhzdmEuZXhlYyhjb2xvcikpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IGg6IG1hdGNoWzFdLCBzOiBtYXRjaFsyXSwgdjogbWF0Y2hbM10sIGE6IG1hdGNoWzRdIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgobWF0Y2ggPSBtYXRjaGVycy5oZXg4LmV4ZWMoY29sb3IpKSkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgYTogY29udmVydEhleFRvRGVjaW1hbChtYXRjaFsxXSksXHJcbiAgICAgICAgICAgICAgICByOiBwYXJzZUludEZyb21IZXgobWF0Y2hbMl0pLFxyXG4gICAgICAgICAgICAgICAgZzogcGFyc2VJbnRGcm9tSGV4KG1hdGNoWzNdKSxcclxuICAgICAgICAgICAgICAgIGI6IHBhcnNlSW50RnJvbUhleChtYXRjaFs0XSksXHJcbiAgICAgICAgICAgICAgICBmb3JtYXQ6IG5hbWVkID8gXCJuYW1lXCIgOiBcImhleDhcIlxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoKG1hdGNoID0gbWF0Y2hlcnMuaGV4Ni5leGVjKGNvbG9yKSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHI6IHBhcnNlSW50RnJvbUhleChtYXRjaFsxXSksXHJcbiAgICAgICAgICAgICAgICBnOiBwYXJzZUludEZyb21IZXgobWF0Y2hbMl0pLFxyXG4gICAgICAgICAgICAgICAgYjogcGFyc2VJbnRGcm9tSGV4KG1hdGNoWzNdKSxcclxuICAgICAgICAgICAgICAgIGZvcm1hdDogbmFtZWQgPyBcIm5hbWVcIiA6IFwiaGV4XCJcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKChtYXRjaCA9IG1hdGNoZXJzLmhleDMuZXhlYyhjb2xvcikpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICByOiBwYXJzZUludEZyb21IZXgobWF0Y2hbMV0gKyAnJyArIG1hdGNoWzFdKSxcclxuICAgICAgICAgICAgICAgIGc6IHBhcnNlSW50RnJvbUhleChtYXRjaFsyXSArICcnICsgbWF0Y2hbMl0pLFxyXG4gICAgICAgICAgICAgICAgYjogcGFyc2VJbnRGcm9tSGV4KG1hdGNoWzNdICsgJycgKyBtYXRjaFszXSksXHJcbiAgICAgICAgICAgICAgICBmb3JtYXQ6IG5hbWVkID8gXCJuYW1lXCIgOiBcImhleFwiXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgd2luZG93LnRpbnljb2xvciA9IHRpbnljb2xvcjtcclxuICAgIH0pKCk7XHJcblxyXG5cclxuICAgICQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICgkLmZuLnNwZWN0cnVtLmxvYWQpIHtcclxuICAgICAgICAgICAgJC5mbi5zcGVjdHJ1bS5wcm9jZXNzTmF0aXZlQ29sb3JJbnB1dHMoKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbn0pO1xyXG4iLCIvKiEgSGFtbWVyLkpTIC0gdjIuMC40IC0gMjAxNC0wOS0yOFxyXG4gKiBodHRwOi8vaGFtbWVyanMuZ2l0aHViLmlvL1xyXG4gKlxyXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgSm9yaWsgVGFuZ2VsZGVyO1xyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgKi9cclxuIWZ1bmN0aW9uKGEsYixjLGQpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGUoYSxiLGMpe3JldHVybiBzZXRUaW1lb3V0KGsoYSxjKSxiKX1mdW5jdGlvbiBmKGEsYixjKXtyZXR1cm4gQXJyYXkuaXNBcnJheShhKT8oZyhhLGNbYl0sYyksITApOiExfWZ1bmN0aW9uIGcoYSxiLGMpe3ZhciBlO2lmKGEpaWYoYS5mb3JFYWNoKWEuZm9yRWFjaChiLGMpO2Vsc2UgaWYoYS5sZW5ndGghPT1kKWZvcihlPTA7ZTxhLmxlbmd0aDspYi5jYWxsKGMsYVtlXSxlLGEpLGUrKztlbHNlIGZvcihlIGluIGEpYS5oYXNPd25Qcm9wZXJ0eShlKSYmYi5jYWxsKGMsYVtlXSxlLGEpfWZ1bmN0aW9uIGgoYSxiLGMpe2Zvcih2YXIgZT1PYmplY3Qua2V5cyhiKSxmPTA7ZjxlLmxlbmd0aDspKCFjfHxjJiZhW2VbZl1dPT09ZCkmJihhW2VbZl1dPWJbZVtmXV0pLGYrKztyZXR1cm4gYX1mdW5jdGlvbiBpKGEsYil7cmV0dXJuIGgoYSxiLCEwKX1mdW5jdGlvbiBqKGEsYixjKXt2YXIgZCxlPWIucHJvdG90eXBlO2Q9YS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShlKSxkLmNvbnN0cnVjdG9yPWEsZC5fc3VwZXI9ZSxjJiZoKGQsYyl9ZnVuY3Rpb24gayhhLGIpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiBhLmFwcGx5KGIsYXJndW1lbnRzKX19ZnVuY3Rpb24gbChhLGIpe3JldHVybiB0eXBlb2YgYT09a2I/YS5hcHBseShiP2JbMF18fGQ6ZCxiKTphfWZ1bmN0aW9uIG0oYSxiKXtyZXR1cm4gYT09PWQ/YjphfWZ1bmN0aW9uIG4oYSxiLGMpe2cocihiKSxmdW5jdGlvbihiKXthLmFkZEV2ZW50TGlzdGVuZXIoYixjLCExKX0pfWZ1bmN0aW9uIG8oYSxiLGMpe2cocihiKSxmdW5jdGlvbihiKXthLnJlbW92ZUV2ZW50TGlzdGVuZXIoYixjLCExKX0pfWZ1bmN0aW9uIHAoYSxiKXtmb3IoO2E7KXtpZihhPT1iKXJldHVybiEwO2E9YS5wYXJlbnROb2RlfXJldHVybiExfWZ1bmN0aW9uIHEoYSxiKXtyZXR1cm4gYS5pbmRleE9mKGIpPi0xfWZ1bmN0aW9uIHIoYSl7cmV0dXJuIGEudHJpbSgpLnNwbGl0KC9cXHMrL2cpfWZ1bmN0aW9uIHMoYSxiLGMpe2lmKGEuaW5kZXhPZiYmIWMpcmV0dXJuIGEuaW5kZXhPZihiKTtmb3IodmFyIGQ9MDtkPGEubGVuZ3RoOyl7aWYoYyYmYVtkXVtjXT09Ynx8IWMmJmFbZF09PT1iKXJldHVybiBkO2QrK31yZXR1cm4tMX1mdW5jdGlvbiB0KGEpe3JldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhLDApfWZ1bmN0aW9uIHUoYSxiLGMpe2Zvcih2YXIgZD1bXSxlPVtdLGY9MDtmPGEubGVuZ3RoOyl7dmFyIGc9Yj9hW2ZdW2JdOmFbZl07cyhlLGcpPDAmJmQucHVzaChhW2ZdKSxlW2ZdPWcsZisrfXJldHVybiBjJiYoZD1iP2Quc29ydChmdW5jdGlvbihhLGMpe3JldHVybiBhW2JdPmNbYl19KTpkLnNvcnQoKSksZH1mdW5jdGlvbiB2KGEsYil7Zm9yKHZhciBjLGUsZj1iWzBdLnRvVXBwZXJDYXNlKCkrYi5zbGljZSgxKSxnPTA7ZzxpYi5sZW5ndGg7KXtpZihjPWliW2ddLGU9Yz9jK2Y6YixlIGluIGEpcmV0dXJuIGU7ZysrfXJldHVybiBkfWZ1bmN0aW9uIHcoKXtyZXR1cm4gb2IrK31mdW5jdGlvbiB4KGEpe3ZhciBiPWEub3duZXJEb2N1bWVudDtyZXR1cm4gYi5kZWZhdWx0Vmlld3x8Yi5wYXJlbnRXaW5kb3d9ZnVuY3Rpb24geShhLGIpe3ZhciBjPXRoaXM7dGhpcy5tYW5hZ2VyPWEsdGhpcy5jYWxsYmFjaz1iLHRoaXMuZWxlbWVudD1hLmVsZW1lbnQsdGhpcy50YXJnZXQ9YS5vcHRpb25zLmlucHV0VGFyZ2V0LHRoaXMuZG9tSGFuZGxlcj1mdW5jdGlvbihiKXtsKGEub3B0aW9ucy5lbmFibGUsW2FdKSYmYy5oYW5kbGVyKGIpfSx0aGlzLmluaXQoKX1mdW5jdGlvbiB6KGEpe3ZhciBiLGM9YS5vcHRpb25zLmlucHV0Q2xhc3M7cmV0dXJuIG5ldyhiPWM/YzpyYj9OOnNiP1E6cWI/UzpNKShhLEEpfWZ1bmN0aW9uIEEoYSxiLGMpe3ZhciBkPWMucG9pbnRlcnMubGVuZ3RoLGU9Yy5jaGFuZ2VkUG9pbnRlcnMubGVuZ3RoLGY9YiZ5YiYmZC1lPT09MCxnPWImKEFifEJiKSYmZC1lPT09MDtjLmlzRmlyc3Q9ISFmLGMuaXNGaW5hbD0hIWcsZiYmKGEuc2Vzc2lvbj17fSksYy5ldmVudFR5cGU9YixCKGEsYyksYS5lbWl0KFwiaGFtbWVyLmlucHV0XCIsYyksYS5yZWNvZ25pemUoYyksYS5zZXNzaW9uLnByZXZJbnB1dD1jfWZ1bmN0aW9uIEIoYSxiKXt2YXIgYz1hLnNlc3Npb24sZD1iLnBvaW50ZXJzLGU9ZC5sZW5ndGg7Yy5maXJzdElucHV0fHwoYy5maXJzdElucHV0PUUoYikpLGU+MSYmIWMuZmlyc3RNdWx0aXBsZT9jLmZpcnN0TXVsdGlwbGU9RShiKToxPT09ZSYmKGMuZmlyc3RNdWx0aXBsZT0hMSk7dmFyIGY9Yy5maXJzdElucHV0LGc9Yy5maXJzdE11bHRpcGxlLGg9Zz9nLmNlbnRlcjpmLmNlbnRlcixpPWIuY2VudGVyPUYoZCk7Yi50aW1lU3RhbXA9bmIoKSxiLmRlbHRhVGltZT1iLnRpbWVTdGFtcC1mLnRpbWVTdGFtcCxiLmFuZ2xlPUooaCxpKSxiLmRpc3RhbmNlPUkoaCxpKSxDKGMsYiksYi5vZmZzZXREaXJlY3Rpb249SChiLmRlbHRhWCxiLmRlbHRhWSksYi5zY2FsZT1nP0woZy5wb2ludGVycyxkKToxLGIucm90YXRpb249Zz9LKGcucG9pbnRlcnMsZCk6MCxEKGMsYik7dmFyIGo9YS5lbGVtZW50O3AoYi5zcmNFdmVudC50YXJnZXQsaikmJihqPWIuc3JjRXZlbnQudGFyZ2V0KSxiLnRhcmdldD1qfWZ1bmN0aW9uIEMoYSxiKXt2YXIgYz1iLmNlbnRlcixkPWEub2Zmc2V0RGVsdGF8fHt9LGU9YS5wcmV2RGVsdGF8fHt9LGY9YS5wcmV2SW5wdXR8fHt9OyhiLmV2ZW50VHlwZT09PXlifHxmLmV2ZW50VHlwZT09PUFiKSYmKGU9YS5wcmV2RGVsdGE9e3g6Zi5kZWx0YVh8fDAseTpmLmRlbHRhWXx8MH0sZD1hLm9mZnNldERlbHRhPXt4OmMueCx5OmMueX0pLGIuZGVsdGFYPWUueCsoYy54LWQueCksYi5kZWx0YVk9ZS55KyhjLnktZC55KX1mdW5jdGlvbiBEKGEsYil7dmFyIGMsZSxmLGcsaD1hLmxhc3RJbnRlcnZhbHx8YixpPWIudGltZVN0YW1wLWgudGltZVN0YW1wO2lmKGIuZXZlbnRUeXBlIT1CYiYmKGk+eGJ8fGgudmVsb2NpdHk9PT1kKSl7dmFyIGo9aC5kZWx0YVgtYi5kZWx0YVgsaz1oLmRlbHRhWS1iLmRlbHRhWSxsPUcoaSxqLGspO2U9bC54LGY9bC55LGM9bWIobC54KT5tYihsLnkpP2wueDpsLnksZz1IKGosayksYS5sYXN0SW50ZXJ2YWw9Yn1lbHNlIGM9aC52ZWxvY2l0eSxlPWgudmVsb2NpdHlYLGY9aC52ZWxvY2l0eVksZz1oLmRpcmVjdGlvbjtiLnZlbG9jaXR5PWMsYi52ZWxvY2l0eVg9ZSxiLnZlbG9jaXR5WT1mLGIuZGlyZWN0aW9uPWd9ZnVuY3Rpb24gRShhKXtmb3IodmFyIGI9W10sYz0wO2M8YS5wb2ludGVycy5sZW5ndGg7KWJbY109e2NsaWVudFg6bGIoYS5wb2ludGVyc1tjXS5jbGllbnRYKSxjbGllbnRZOmxiKGEucG9pbnRlcnNbY10uY2xpZW50WSl9LGMrKztyZXR1cm57dGltZVN0YW1wOm5iKCkscG9pbnRlcnM6YixjZW50ZXI6RihiKSxkZWx0YVg6YS5kZWx0YVgsZGVsdGFZOmEuZGVsdGFZfX1mdW5jdGlvbiBGKGEpe3ZhciBiPWEubGVuZ3RoO2lmKDE9PT1iKXJldHVybnt4OmxiKGFbMF0uY2xpZW50WCkseTpsYihhWzBdLmNsaWVudFkpfTtmb3IodmFyIGM9MCxkPTAsZT0wO2I+ZTspYys9YVtlXS5jbGllbnRYLGQrPWFbZV0uY2xpZW50WSxlKys7cmV0dXJue3g6bGIoYy9iKSx5OmxiKGQvYil9fWZ1bmN0aW9uIEcoYSxiLGMpe3JldHVybnt4OmIvYXx8MCx5OmMvYXx8MH19ZnVuY3Rpb24gSChhLGIpe3JldHVybiBhPT09Yj9DYjptYihhKT49bWIoYik/YT4wP0RiOkViOmI+MD9GYjpHYn1mdW5jdGlvbiBJKGEsYixjKXtjfHwoYz1LYik7dmFyIGQ9YltjWzBdXS1hW2NbMF1dLGU9YltjWzFdXS1hW2NbMV1dO3JldHVybiBNYXRoLnNxcnQoZCpkK2UqZSl9ZnVuY3Rpb24gSihhLGIsYyl7Y3x8KGM9S2IpO3ZhciBkPWJbY1swXV0tYVtjWzBdXSxlPWJbY1sxXV0tYVtjWzFdXTtyZXR1cm4gMTgwKk1hdGguYXRhbjIoZSxkKS9NYXRoLlBJfWZ1bmN0aW9uIEsoYSxiKXtyZXR1cm4gSihiWzFdLGJbMF0sTGIpLUooYVsxXSxhWzBdLExiKX1mdW5jdGlvbiBMKGEsYil7cmV0dXJuIEkoYlswXSxiWzFdLExiKS9JKGFbMF0sYVsxXSxMYil9ZnVuY3Rpb24gTSgpe3RoaXMuZXZFbD1OYix0aGlzLmV2V2luPU9iLHRoaXMuYWxsb3c9ITAsdGhpcy5wcmVzc2VkPSExLHkuYXBwbHkodGhpcyxhcmd1bWVudHMpfWZ1bmN0aW9uIE4oKXt0aGlzLmV2RWw9UmIsdGhpcy5ldldpbj1TYix5LmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLnN0b3JlPXRoaXMubWFuYWdlci5zZXNzaW9uLnBvaW50ZXJFdmVudHM9W119ZnVuY3Rpb24gTygpe3RoaXMuZXZUYXJnZXQ9VWIsdGhpcy5ldldpbj1WYix0aGlzLnN0YXJ0ZWQ9ITEseS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9ZnVuY3Rpb24gUChhLGIpe3ZhciBjPXQoYS50b3VjaGVzKSxkPXQoYS5jaGFuZ2VkVG91Y2hlcyk7cmV0dXJuIGImKEFifEJiKSYmKGM9dShjLmNvbmNhdChkKSxcImlkZW50aWZpZXJcIiwhMCkpLFtjLGRdfWZ1bmN0aW9uIFEoKXt0aGlzLmV2VGFyZ2V0PVhiLHRoaXMudGFyZ2V0SWRzPXt9LHkuYXBwbHkodGhpcyxhcmd1bWVudHMpfWZ1bmN0aW9uIFIoYSxiKXt2YXIgYz10KGEudG91Y2hlcyksZD10aGlzLnRhcmdldElkcztpZihiJih5Ynx6YikmJjE9PT1jLmxlbmd0aClyZXR1cm4gZFtjWzBdLmlkZW50aWZpZXJdPSEwLFtjLGNdO3ZhciBlLGYsZz10KGEuY2hhbmdlZFRvdWNoZXMpLGg9W10saT10aGlzLnRhcmdldDtpZihmPWMuZmlsdGVyKGZ1bmN0aW9uKGEpe3JldHVybiBwKGEudGFyZ2V0LGkpfSksYj09PXliKWZvcihlPTA7ZTxmLmxlbmd0aDspZFtmW2VdLmlkZW50aWZpZXJdPSEwLGUrKztmb3IoZT0wO2U8Zy5sZW5ndGg7KWRbZ1tlXS5pZGVudGlmaWVyXSYmaC5wdXNoKGdbZV0pLGImKEFifEJiKSYmZGVsZXRlIGRbZ1tlXS5pZGVudGlmaWVyXSxlKys7cmV0dXJuIGgubGVuZ3RoP1t1KGYuY29uY2F0KGgpLFwiaWRlbnRpZmllclwiLCEwKSxoXTp2b2lkIDB9ZnVuY3Rpb24gUygpe3kuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBhPWsodGhpcy5oYW5kbGVyLHRoaXMpO3RoaXMudG91Y2g9bmV3IFEodGhpcy5tYW5hZ2VyLGEpLHRoaXMubW91c2U9bmV3IE0odGhpcy5tYW5hZ2VyLGEpfWZ1bmN0aW9uIFQoYSxiKXt0aGlzLm1hbmFnZXI9YSx0aGlzLnNldChiKX1mdW5jdGlvbiBVKGEpe2lmKHEoYSxiYykpcmV0dXJuIGJjO3ZhciBiPXEoYSxjYyksYz1xKGEsZGMpO3JldHVybiBiJiZjP2NjK1wiIFwiK2RjOmJ8fGM/Yj9jYzpkYzpxKGEsYWMpP2FjOl9ifWZ1bmN0aW9uIFYoYSl7dGhpcy5pZD13KCksdGhpcy5tYW5hZ2VyPW51bGwsdGhpcy5vcHRpb25zPWkoYXx8e30sdGhpcy5kZWZhdWx0cyksdGhpcy5vcHRpb25zLmVuYWJsZT1tKHRoaXMub3B0aW9ucy5lbmFibGUsITApLHRoaXMuc3RhdGU9ZWMsdGhpcy5zaW11bHRhbmVvdXM9e30sdGhpcy5yZXF1aXJlRmFpbD1bXX1mdW5jdGlvbiBXKGEpe3JldHVybiBhJmpjP1wiY2FuY2VsXCI6YSZoYz9cImVuZFwiOmEmZ2M/XCJtb3ZlXCI6YSZmYz9cInN0YXJ0XCI6XCJcIn1mdW5jdGlvbiBYKGEpe3JldHVybiBhPT1HYj9cImRvd25cIjphPT1GYj9cInVwXCI6YT09RGI/XCJsZWZ0XCI6YT09RWI/XCJyaWdodFwiOlwiXCJ9ZnVuY3Rpb24gWShhLGIpe3ZhciBjPWIubWFuYWdlcjtyZXR1cm4gYz9jLmdldChhKTphfWZ1bmN0aW9uIFooKXtWLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1mdW5jdGlvbiAkKCl7Wi5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5wWD1udWxsLHRoaXMucFk9bnVsbH1mdW5jdGlvbiBfKCl7Wi5hcHBseSh0aGlzLGFyZ3VtZW50cyl9ZnVuY3Rpb24gYWIoKXtWLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLl90aW1lcj1udWxsLHRoaXMuX2lucHV0PW51bGx9ZnVuY3Rpb24gYmIoKXtaLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1mdW5jdGlvbiBjYigpe1ouYXBwbHkodGhpcyxhcmd1bWVudHMpfWZ1bmN0aW9uIGRiKCl7Vi5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5wVGltZT0hMSx0aGlzLnBDZW50ZXI9ITEsdGhpcy5fdGltZXI9bnVsbCx0aGlzLl9pbnB1dD1udWxsLHRoaXMuY291bnQ9MH1mdW5jdGlvbiBlYihhLGIpe3JldHVybiBiPWJ8fHt9LGIucmVjb2duaXplcnM9bShiLnJlY29nbml6ZXJzLGViLmRlZmF1bHRzLnByZXNldCksbmV3IGZiKGEsYil9ZnVuY3Rpb24gZmIoYSxiKXtiPWJ8fHt9LHRoaXMub3B0aW9ucz1pKGIsZWIuZGVmYXVsdHMpLHRoaXMub3B0aW9ucy5pbnB1dFRhcmdldD10aGlzLm9wdGlvbnMuaW5wdXRUYXJnZXR8fGEsdGhpcy5oYW5kbGVycz17fSx0aGlzLnNlc3Npb249e30sdGhpcy5yZWNvZ25pemVycz1bXSx0aGlzLmVsZW1lbnQ9YSx0aGlzLmlucHV0PXoodGhpcyksdGhpcy50b3VjaEFjdGlvbj1uZXcgVCh0aGlzLHRoaXMub3B0aW9ucy50b3VjaEFjdGlvbiksZ2IodGhpcywhMCksZyhiLnJlY29nbml6ZXJzLGZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuYWRkKG5ldyBhWzBdKGFbMV0pKTthWzJdJiZiLnJlY29nbml6ZVdpdGgoYVsyXSksYVszXSYmYi5yZXF1aXJlRmFpbHVyZShhWzNdKX0sdGhpcyl9ZnVuY3Rpb24gZ2IoYSxiKXt2YXIgYz1hLmVsZW1lbnQ7ZyhhLm9wdGlvbnMuY3NzUHJvcHMsZnVuY3Rpb24oYSxkKXtjLnN0eWxlW3YoYy5zdHlsZSxkKV09Yj9hOlwiXCJ9KX1mdW5jdGlvbiBoYihhLGMpe3ZhciBkPWIuY3JlYXRlRXZlbnQoXCJFdmVudFwiKTtkLmluaXRFdmVudChhLCEwLCEwKSxkLmdlc3R1cmU9YyxjLnRhcmdldC5kaXNwYXRjaEV2ZW50KGQpfXZhciBpYj1bXCJcIixcIndlYmtpdFwiLFwibW96XCIsXCJNU1wiLFwibXNcIixcIm9cIl0samI9Yi5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLGtiPVwiZnVuY3Rpb25cIixsYj1NYXRoLnJvdW5kLG1iPU1hdGguYWJzLG5iPURhdGUubm93LG9iPTEscGI9L21vYmlsZXx0YWJsZXR8aXAoYWR8aG9uZXxvZCl8YW5kcm9pZC9pLHFiPVwib250b3VjaHN0YXJ0XCJpbiBhLHJiPXYoYSxcIlBvaW50ZXJFdmVudFwiKSE9PWQsc2I9cWImJnBiLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCksdGI9XCJ0b3VjaFwiLHViPVwicGVuXCIsdmI9XCJtb3VzZVwiLHdiPVwia2luZWN0XCIseGI9MjUseWI9MSx6Yj0yLEFiPTQsQmI9OCxDYj0xLERiPTIsRWI9NCxGYj04LEdiPTE2LEhiPURifEViLEliPUZifEdiLEpiPUhifEliLEtiPVtcInhcIixcInlcIl0sTGI9W1wiY2xpZW50WFwiLFwiY2xpZW50WVwiXTt5LnByb3RvdHlwZT17aGFuZGxlcjpmdW5jdGlvbigpe30saW5pdDpmdW5jdGlvbigpe3RoaXMuZXZFbCYmbih0aGlzLmVsZW1lbnQsdGhpcy5ldkVsLHRoaXMuZG9tSGFuZGxlciksdGhpcy5ldlRhcmdldCYmbih0aGlzLnRhcmdldCx0aGlzLmV2VGFyZ2V0LHRoaXMuZG9tSGFuZGxlciksdGhpcy5ldldpbiYmbih4KHRoaXMuZWxlbWVudCksdGhpcy5ldldpbix0aGlzLmRvbUhhbmRsZXIpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5ldkVsJiZvKHRoaXMuZWxlbWVudCx0aGlzLmV2RWwsdGhpcy5kb21IYW5kbGVyKSx0aGlzLmV2VGFyZ2V0JiZvKHRoaXMudGFyZ2V0LHRoaXMuZXZUYXJnZXQsdGhpcy5kb21IYW5kbGVyKSx0aGlzLmV2V2luJiZvKHgodGhpcy5lbGVtZW50KSx0aGlzLmV2V2luLHRoaXMuZG9tSGFuZGxlcil9fTt2YXIgTWI9e21vdXNlZG93bjp5Yixtb3VzZW1vdmU6emIsbW91c2V1cDpBYn0sTmI9XCJtb3VzZWRvd25cIixPYj1cIm1vdXNlbW92ZSBtb3VzZXVwXCI7aihNLHkse2hhbmRsZXI6ZnVuY3Rpb24oYSl7dmFyIGI9TWJbYS50eXBlXTtiJnliJiYwPT09YS5idXR0b24mJih0aGlzLnByZXNzZWQ9ITApLGImemImJjEhPT1hLndoaWNoJiYoYj1BYiksdGhpcy5wcmVzc2VkJiZ0aGlzLmFsbG93JiYoYiZBYiYmKHRoaXMucHJlc3NlZD0hMSksdGhpcy5jYWxsYmFjayh0aGlzLm1hbmFnZXIsYix7cG9pbnRlcnM6W2FdLGNoYW5nZWRQb2ludGVyczpbYV0scG9pbnRlclR5cGU6dmIsc3JjRXZlbnQ6YX0pKX19KTt2YXIgUGI9e3BvaW50ZXJkb3duOnliLHBvaW50ZXJtb3ZlOnpiLHBvaW50ZXJ1cDpBYixwb2ludGVyY2FuY2VsOkJiLHBvaW50ZXJvdXQ6QmJ9LFFiPXsyOnRiLDM6dWIsNDp2Yiw1OndifSxSYj1cInBvaW50ZXJkb3duXCIsU2I9XCJwb2ludGVybW92ZSBwb2ludGVydXAgcG9pbnRlcmNhbmNlbFwiO2EuTVNQb2ludGVyRXZlbnQmJihSYj1cIk1TUG9pbnRlckRvd25cIixTYj1cIk1TUG9pbnRlck1vdmUgTVNQb2ludGVyVXAgTVNQb2ludGVyQ2FuY2VsXCIpLGooTix5LHtoYW5kbGVyOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuc3RvcmUsYz0hMSxkPWEudHlwZS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoXCJtc1wiLFwiXCIpLGU9UGJbZF0sZj1RYlthLnBvaW50ZXJUeXBlXXx8YS5wb2ludGVyVHlwZSxnPWY9PXRiLGg9cyhiLGEucG9pbnRlcklkLFwicG9pbnRlcklkXCIpO2UmeWImJigwPT09YS5idXR0b258fGcpPzA+aCYmKGIucHVzaChhKSxoPWIubGVuZ3RoLTEpOmUmKEFifEJiKSYmKGM9ITApLDA+aHx8KGJbaF09YSx0aGlzLmNhbGxiYWNrKHRoaXMubWFuYWdlcixlLHtwb2ludGVyczpiLGNoYW5nZWRQb2ludGVyczpbYV0scG9pbnRlclR5cGU6ZixzcmNFdmVudDphfSksYyYmYi5zcGxpY2UoaCwxKSl9fSk7dmFyIFRiPXt0b3VjaHN0YXJ0OnliLHRvdWNobW92ZTp6Yix0b3VjaGVuZDpBYix0b3VjaGNhbmNlbDpCYn0sVWI9XCJ0b3VjaHN0YXJ0XCIsVmI9XCJ0b3VjaHN0YXJ0IHRvdWNobW92ZSB0b3VjaGVuZCB0b3VjaGNhbmNlbFwiO2ooTyx5LHtoYW5kbGVyOmZ1bmN0aW9uKGEpe3ZhciBiPVRiW2EudHlwZV07aWYoYj09PXliJiYodGhpcy5zdGFydGVkPSEwKSx0aGlzLnN0YXJ0ZWQpe3ZhciBjPVAuY2FsbCh0aGlzLGEsYik7YiYoQWJ8QmIpJiZjWzBdLmxlbmd0aC1jWzFdLmxlbmd0aD09PTAmJih0aGlzLnN0YXJ0ZWQ9ITEpLHRoaXMuY2FsbGJhY2sodGhpcy5tYW5hZ2VyLGIse3BvaW50ZXJzOmNbMF0sY2hhbmdlZFBvaW50ZXJzOmNbMV0scG9pbnRlclR5cGU6dGIsc3JjRXZlbnQ6YX0pfX19KTt2YXIgV2I9e3RvdWNoc3RhcnQ6eWIsdG91Y2htb3ZlOnpiLHRvdWNoZW5kOkFiLHRvdWNoY2FuY2VsOkJifSxYYj1cInRvdWNoc3RhcnQgdG91Y2htb3ZlIHRvdWNoZW5kIHRvdWNoY2FuY2VsXCI7aihRLHkse2hhbmRsZXI6ZnVuY3Rpb24oYSl7dmFyIGI9V2JbYS50eXBlXSxjPVIuY2FsbCh0aGlzLGEsYik7YyYmdGhpcy5jYWxsYmFjayh0aGlzLm1hbmFnZXIsYix7cG9pbnRlcnM6Y1swXSxjaGFuZ2VkUG9pbnRlcnM6Y1sxXSxwb2ludGVyVHlwZTp0YixzcmNFdmVudDphfSl9fSksaihTLHkse2hhbmRsZXI6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWMucG9pbnRlclR5cGU9PXRiLGU9Yy5wb2ludGVyVHlwZT09dmI7aWYoZCl0aGlzLm1vdXNlLmFsbG93PSExO2Vsc2UgaWYoZSYmIXRoaXMubW91c2UuYWxsb3cpcmV0dXJuO2ImKEFifEJiKSYmKHRoaXMubW91c2UuYWxsb3c9ITApLHRoaXMuY2FsbGJhY2soYSxiLGMpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy50b3VjaC5kZXN0cm95KCksdGhpcy5tb3VzZS5kZXN0cm95KCl9fSk7dmFyIFliPXYoamIuc3R5bGUsXCJ0b3VjaEFjdGlvblwiKSxaYj1ZYiE9PWQsJGI9XCJjb21wdXRlXCIsX2I9XCJhdXRvXCIsYWM9XCJtYW5pcHVsYXRpb25cIixiYz1cIm5vbmVcIixjYz1cInBhbi14XCIsZGM9XCJwYW4teVwiO1QucHJvdG90eXBlPXtzZXQ6ZnVuY3Rpb24oYSl7YT09JGImJihhPXRoaXMuY29tcHV0ZSgpKSxaYiYmKHRoaXMubWFuYWdlci5lbGVtZW50LnN0eWxlW1liXT1hKSx0aGlzLmFjdGlvbnM9YS50b0xvd2VyQ2FzZSgpLnRyaW0oKX0sdXBkYXRlOmZ1bmN0aW9uKCl7dGhpcy5zZXQodGhpcy5tYW5hZ2VyLm9wdGlvbnMudG91Y2hBY3Rpb24pfSxjb21wdXRlOmZ1bmN0aW9uKCl7dmFyIGE9W107cmV0dXJuIGcodGhpcy5tYW5hZ2VyLnJlY29nbml6ZXJzLGZ1bmN0aW9uKGIpe2woYi5vcHRpb25zLmVuYWJsZSxbYl0pJiYoYT1hLmNvbmNhdChiLmdldFRvdWNoQWN0aW9uKCkpKX0pLFUoYS5qb2luKFwiIFwiKSl9LHByZXZlbnREZWZhdWx0czpmdW5jdGlvbihhKXtpZighWmIpe3ZhciBiPWEuc3JjRXZlbnQsYz1hLm9mZnNldERpcmVjdGlvbjtpZih0aGlzLm1hbmFnZXIuc2Vzc2lvbi5wcmV2ZW50ZWQpcmV0dXJuIHZvaWQgYi5wcmV2ZW50RGVmYXVsdCgpO3ZhciBkPXRoaXMuYWN0aW9ucyxlPXEoZCxiYyksZj1xKGQsZGMpLGc9cShkLGNjKTtyZXR1cm4gZXx8ZiYmYyZIYnx8ZyYmYyZJYj90aGlzLnByZXZlbnRTcmMoYik6dm9pZCAwfX0scHJldmVudFNyYzpmdW5jdGlvbihhKXt0aGlzLm1hbmFnZXIuc2Vzc2lvbi5wcmV2ZW50ZWQ9ITAsYS5wcmV2ZW50RGVmYXVsdCgpfX07dmFyIGVjPTEsZmM9MixnYz00LGhjPTgsaWM9aGMsamM9MTYsa2M9MzI7Vi5wcm90b3R5cGU9e2RlZmF1bHRzOnt9LHNldDpmdW5jdGlvbihhKXtyZXR1cm4gaCh0aGlzLm9wdGlvbnMsYSksdGhpcy5tYW5hZ2VyJiZ0aGlzLm1hbmFnZXIudG91Y2hBY3Rpb24udXBkYXRlKCksdGhpc30scmVjb2duaXplV2l0aDpmdW5jdGlvbihhKXtpZihmKGEsXCJyZWNvZ25pemVXaXRoXCIsdGhpcykpcmV0dXJuIHRoaXM7dmFyIGI9dGhpcy5zaW11bHRhbmVvdXM7cmV0dXJuIGE9WShhLHRoaXMpLGJbYS5pZF18fChiW2EuaWRdPWEsYS5yZWNvZ25pemVXaXRoKHRoaXMpKSx0aGlzfSxkcm9wUmVjb2duaXplV2l0aDpmdW5jdGlvbihhKXtyZXR1cm4gZihhLFwiZHJvcFJlY29nbml6ZVdpdGhcIix0aGlzKT90aGlzOihhPVkoYSx0aGlzKSxkZWxldGUgdGhpcy5zaW11bHRhbmVvdXNbYS5pZF0sdGhpcyl9LHJlcXVpcmVGYWlsdXJlOmZ1bmN0aW9uKGEpe2lmKGYoYSxcInJlcXVpcmVGYWlsdXJlXCIsdGhpcykpcmV0dXJuIHRoaXM7dmFyIGI9dGhpcy5yZXF1aXJlRmFpbDtyZXR1cm4gYT1ZKGEsdGhpcyksLTE9PT1zKGIsYSkmJihiLnB1c2goYSksYS5yZXF1aXJlRmFpbHVyZSh0aGlzKSksdGhpc30sZHJvcFJlcXVpcmVGYWlsdXJlOmZ1bmN0aW9uKGEpe2lmKGYoYSxcImRyb3BSZXF1aXJlRmFpbHVyZVwiLHRoaXMpKXJldHVybiB0aGlzO2E9WShhLHRoaXMpO3ZhciBiPXModGhpcy5yZXF1aXJlRmFpbCxhKTtyZXR1cm4gYj4tMSYmdGhpcy5yZXF1aXJlRmFpbC5zcGxpY2UoYiwxKSx0aGlzfSxoYXNSZXF1aXJlRmFpbHVyZXM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXF1aXJlRmFpbC5sZW5ndGg+MH0sY2FuUmVjb2duaXplV2l0aDpmdW5jdGlvbihhKXtyZXR1cm4hIXRoaXMuc2ltdWx0YW5lb3VzW2EuaWRdfSxlbWl0OmZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYil7Yy5tYW5hZ2VyLmVtaXQoYy5vcHRpb25zLmV2ZW50KyhiP1coZCk6XCJcIiksYSl9dmFyIGM9dGhpcyxkPXRoaXMuc3RhdGU7aGM+ZCYmYighMCksYigpLGQ+PWhjJiZiKCEwKX0sdHJ5RW1pdDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jYW5FbWl0KCk/dGhpcy5lbWl0KGEpOnZvaWQodGhpcy5zdGF0ZT1rYyl9LGNhbkVtaXQ6ZnVuY3Rpb24oKXtmb3IodmFyIGE9MDthPHRoaXMucmVxdWlyZUZhaWwubGVuZ3RoOyl7aWYoISh0aGlzLnJlcXVpcmVGYWlsW2FdLnN0YXRlJihrY3xlYykpKXJldHVybiExO2ErK31yZXR1cm4hMH0scmVjb2duaXplOmZ1bmN0aW9uKGEpe3ZhciBiPWgoe30sYSk7cmV0dXJuIGwodGhpcy5vcHRpb25zLmVuYWJsZSxbdGhpcyxiXSk/KHRoaXMuc3RhdGUmKGljfGpjfGtjKSYmKHRoaXMuc3RhdGU9ZWMpLHRoaXMuc3RhdGU9dGhpcy5wcm9jZXNzKGIpLHZvaWQodGhpcy5zdGF0ZSYoZmN8Z2N8aGN8amMpJiZ0aGlzLnRyeUVtaXQoYikpKToodGhpcy5yZXNldCgpLHZvaWQodGhpcy5zdGF0ZT1rYykpfSxwcm9jZXNzOmZ1bmN0aW9uKCl7fSxnZXRUb3VjaEFjdGlvbjpmdW5jdGlvbigpe30scmVzZXQ6ZnVuY3Rpb24oKXt9fSxqKFosVix7ZGVmYXVsdHM6e3BvaW50ZXJzOjF9LGF0dHJUZXN0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9ucy5wb2ludGVycztyZXR1cm4gMD09PWJ8fGEucG9pbnRlcnMubGVuZ3RoPT09Yn0scHJvY2VzczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnN0YXRlLGM9YS5ldmVudFR5cGUsZD1iJihmY3xnYyksZT10aGlzLmF0dHJUZXN0KGEpO3JldHVybiBkJiYoYyZCYnx8IWUpP2J8amM6ZHx8ZT9jJkFiP2J8aGM6YiZmYz9ifGdjOmZjOmtjfX0pLGooJCxaLHtkZWZhdWx0czp7ZXZlbnQ6XCJwYW5cIix0aHJlc2hvbGQ6MTAscG9pbnRlcnM6MSxkaXJlY3Rpb246SmJ9LGdldFRvdWNoQWN0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLmRpcmVjdGlvbixiPVtdO3JldHVybiBhJkhiJiZiLnB1c2goZGMpLGEmSWImJmIucHVzaChjYyksYn0sZGlyZWN0aW9uVGVzdDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm9wdGlvbnMsYz0hMCxkPWEuZGlzdGFuY2UsZT1hLmRpcmVjdGlvbixmPWEuZGVsdGFYLGc9YS5kZWx0YVk7cmV0dXJuIGUmYi5kaXJlY3Rpb258fChiLmRpcmVjdGlvbiZIYj8oZT0wPT09Zj9DYjowPmY/RGI6RWIsYz1mIT10aGlzLnBYLGQ9TWF0aC5hYnMoYS5kZWx0YVgpKTooZT0wPT09Zz9DYjowPmc/RmI6R2IsYz1nIT10aGlzLnBZLGQ9TWF0aC5hYnMoYS5kZWx0YVkpKSksYS5kaXJlY3Rpb249ZSxjJiZkPmIudGhyZXNob2xkJiZlJmIuZGlyZWN0aW9ufSxhdHRyVGVzdDpmdW5jdGlvbihhKXtyZXR1cm4gWi5wcm90b3R5cGUuYXR0clRlc3QuY2FsbCh0aGlzLGEpJiYodGhpcy5zdGF0ZSZmY3x8ISh0aGlzLnN0YXRlJmZjKSYmdGhpcy5kaXJlY3Rpb25UZXN0KGEpKX0sZW1pdDpmdW5jdGlvbihhKXt0aGlzLnBYPWEuZGVsdGFYLHRoaXMucFk9YS5kZWx0YVk7dmFyIGI9WChhLmRpcmVjdGlvbik7YiYmdGhpcy5tYW5hZ2VyLmVtaXQodGhpcy5vcHRpb25zLmV2ZW50K2IsYSksdGhpcy5fc3VwZXIuZW1pdC5jYWxsKHRoaXMsYSl9fSksaihfLFose2RlZmF1bHRzOntldmVudDpcInBpbmNoXCIsdGhyZXNob2xkOjAscG9pbnRlcnM6Mn0sZ2V0VG91Y2hBY3Rpb246ZnVuY3Rpb24oKXtyZXR1cm5bYmNdfSxhdHRyVGVzdDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5fc3VwZXIuYXR0clRlc3QuY2FsbCh0aGlzLGEpJiYoTWF0aC5hYnMoYS5zY2FsZS0xKT50aGlzLm9wdGlvbnMudGhyZXNob2xkfHx0aGlzLnN0YXRlJmZjKX0sZW1pdDpmdW5jdGlvbihhKXtpZih0aGlzLl9zdXBlci5lbWl0LmNhbGwodGhpcyxhKSwxIT09YS5zY2FsZSl7dmFyIGI9YS5zY2FsZTwxP1wiaW5cIjpcIm91dFwiO3RoaXMubWFuYWdlci5lbWl0KHRoaXMub3B0aW9ucy5ldmVudCtiLGEpfX19KSxqKGFiLFYse2RlZmF1bHRzOntldmVudDpcInByZXNzXCIscG9pbnRlcnM6MSx0aW1lOjUwMCx0aHJlc2hvbGQ6NX0sZ2V0VG91Y2hBY3Rpb246ZnVuY3Rpb24oKXtyZXR1cm5bX2JdfSxwcm9jZXNzOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9ucyxjPWEucG9pbnRlcnMubGVuZ3RoPT09Yi5wb2ludGVycyxkPWEuZGlzdGFuY2U8Yi50aHJlc2hvbGQsZj1hLmRlbHRhVGltZT5iLnRpbWU7aWYodGhpcy5faW5wdXQ9YSwhZHx8IWN8fGEuZXZlbnRUeXBlJihBYnxCYikmJiFmKXRoaXMucmVzZXQoKTtlbHNlIGlmKGEuZXZlbnRUeXBlJnliKXRoaXMucmVzZXQoKSx0aGlzLl90aW1lcj1lKGZ1bmN0aW9uKCl7dGhpcy5zdGF0ZT1pYyx0aGlzLnRyeUVtaXQoKX0sYi50aW1lLHRoaXMpO2Vsc2UgaWYoYS5ldmVudFR5cGUmQWIpcmV0dXJuIGljO3JldHVybiBrY30scmVzZXQ6ZnVuY3Rpb24oKXtjbGVhclRpbWVvdXQodGhpcy5fdGltZXIpfSxlbWl0OmZ1bmN0aW9uKGEpe3RoaXMuc3RhdGU9PT1pYyYmKGEmJmEuZXZlbnRUeXBlJkFiP3RoaXMubWFuYWdlci5lbWl0KHRoaXMub3B0aW9ucy5ldmVudCtcInVwXCIsYSk6KHRoaXMuX2lucHV0LnRpbWVTdGFtcD1uYigpLHRoaXMubWFuYWdlci5lbWl0KHRoaXMub3B0aW9ucy5ldmVudCx0aGlzLl9pbnB1dCkpKX19KSxqKGJiLFose2RlZmF1bHRzOntldmVudDpcInJvdGF0ZVwiLHRocmVzaG9sZDowLHBvaW50ZXJzOjJ9LGdldFRvdWNoQWN0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuW2JjXX0sYXR0clRlc3Q6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuX3N1cGVyLmF0dHJUZXN0LmNhbGwodGhpcyxhKSYmKE1hdGguYWJzKGEucm90YXRpb24pPnRoaXMub3B0aW9ucy50aHJlc2hvbGR8fHRoaXMuc3RhdGUmZmMpfX0pLGooY2IsWix7ZGVmYXVsdHM6e2V2ZW50Olwic3dpcGVcIix0aHJlc2hvbGQ6MTAsdmVsb2NpdHk6LjY1LGRpcmVjdGlvbjpIYnxJYixwb2ludGVyczoxfSxnZXRUb3VjaEFjdGlvbjpmdW5jdGlvbigpe3JldHVybiAkLnByb3RvdHlwZS5nZXRUb3VjaEFjdGlvbi5jYWxsKHRoaXMpfSxhdHRyVGVzdDpmdW5jdGlvbihhKXt2YXIgYixjPXRoaXMub3B0aW9ucy5kaXJlY3Rpb247cmV0dXJuIGMmKEhifEliKT9iPWEudmVsb2NpdHk6YyZIYj9iPWEudmVsb2NpdHlYOmMmSWImJihiPWEudmVsb2NpdHlZKSx0aGlzLl9zdXBlci5hdHRyVGVzdC5jYWxsKHRoaXMsYSkmJmMmYS5kaXJlY3Rpb24mJmEuZGlzdGFuY2U+dGhpcy5vcHRpb25zLnRocmVzaG9sZCYmbWIoYik+dGhpcy5vcHRpb25zLnZlbG9jaXR5JiZhLmV2ZW50VHlwZSZBYn0sZW1pdDpmdW5jdGlvbihhKXt2YXIgYj1YKGEuZGlyZWN0aW9uKTtiJiZ0aGlzLm1hbmFnZXIuZW1pdCh0aGlzLm9wdGlvbnMuZXZlbnQrYixhKSx0aGlzLm1hbmFnZXIuZW1pdCh0aGlzLm9wdGlvbnMuZXZlbnQsYSl9fSksaihkYixWLHtkZWZhdWx0czp7ZXZlbnQ6XCJ0YXBcIixwb2ludGVyczoxLHRhcHM6MSxpbnRlcnZhbDozMDAsdGltZToyNTAsdGhyZXNob2xkOjIscG9zVGhyZXNob2xkOjEwfSxnZXRUb3VjaEFjdGlvbjpmdW5jdGlvbigpe3JldHVyblthY119LHByb2Nlc3M6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcHRpb25zLGM9YS5wb2ludGVycy5sZW5ndGg9PT1iLnBvaW50ZXJzLGQ9YS5kaXN0YW5jZTxiLnRocmVzaG9sZCxmPWEuZGVsdGFUaW1lPGIudGltZTtpZih0aGlzLnJlc2V0KCksYS5ldmVudFR5cGUmeWImJjA9PT10aGlzLmNvdW50KXJldHVybiB0aGlzLmZhaWxUaW1lb3V0KCk7aWYoZCYmZiYmYyl7aWYoYS5ldmVudFR5cGUhPUFiKXJldHVybiB0aGlzLmZhaWxUaW1lb3V0KCk7dmFyIGc9dGhpcy5wVGltZT9hLnRpbWVTdGFtcC10aGlzLnBUaW1lPGIuaW50ZXJ2YWw6ITAsaD0hdGhpcy5wQ2VudGVyfHxJKHRoaXMucENlbnRlcixhLmNlbnRlcik8Yi5wb3NUaHJlc2hvbGQ7dGhpcy5wVGltZT1hLnRpbWVTdGFtcCx0aGlzLnBDZW50ZXI9YS5jZW50ZXIsaCYmZz90aGlzLmNvdW50Kz0xOnRoaXMuY291bnQ9MSx0aGlzLl9pbnB1dD1hO3ZhciBpPXRoaXMuY291bnQlYi50YXBzO2lmKDA9PT1pKXJldHVybiB0aGlzLmhhc1JlcXVpcmVGYWlsdXJlcygpPyh0aGlzLl90aW1lcj1lKGZ1bmN0aW9uKCl7dGhpcy5zdGF0ZT1pYyx0aGlzLnRyeUVtaXQoKX0sYi5pbnRlcnZhbCx0aGlzKSxmYyk6aWN9cmV0dXJuIGtjfSxmYWlsVGltZW91dDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl90aW1lcj1lKGZ1bmN0aW9uKCl7dGhpcy5zdGF0ZT1rY30sdGhpcy5vcHRpb25zLmludGVydmFsLHRoaXMpLGtjfSxyZXNldDpmdW5jdGlvbigpe2NsZWFyVGltZW91dCh0aGlzLl90aW1lcil9LGVtaXQ6ZnVuY3Rpb24oKXt0aGlzLnN0YXRlPT1pYyYmKHRoaXMuX2lucHV0LnRhcENvdW50PXRoaXMuY291bnQsdGhpcy5tYW5hZ2VyLmVtaXQodGhpcy5vcHRpb25zLmV2ZW50LHRoaXMuX2lucHV0KSl9fSksZWIuVkVSU0lPTj1cIjIuMC40XCIsZWIuZGVmYXVsdHM9e2RvbUV2ZW50czohMSx0b3VjaEFjdGlvbjokYixlbmFibGU6ITAsaW5wdXRUYXJnZXQ6bnVsbCxpbnB1dENsYXNzOm51bGwscHJlc2V0OltbYmIse2VuYWJsZTohMX1dLFtfLHtlbmFibGU6ITF9LFtcInJvdGF0ZVwiXV0sW2NiLHtkaXJlY3Rpb246SGJ9XSxbJCx7ZGlyZWN0aW9uOkhifSxbXCJzd2lwZVwiXV0sW2RiXSxbZGIse2V2ZW50OlwiZG91YmxldGFwXCIsdGFwczoyfSxbXCJ0YXBcIl1dLFthYl1dLGNzc1Byb3BzOnt1c2VyU2VsZWN0Olwibm9uZVwiLHRvdWNoU2VsZWN0Olwibm9uZVwiLHRvdWNoQ2FsbG91dDpcIm5vbmVcIixjb250ZW50Wm9vbWluZzpcIm5vbmVcIix1c2VyRHJhZzpcIm5vbmVcIix0YXBIaWdobGlnaHRDb2xvcjpcInJnYmEoMCwwLDAsMClcIn19O3ZhciBsYz0xLG1jPTI7ZmIucHJvdG90eXBlPXtzZXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGgodGhpcy5vcHRpb25zLGEpLGEudG91Y2hBY3Rpb24mJnRoaXMudG91Y2hBY3Rpb24udXBkYXRlKCksYS5pbnB1dFRhcmdldCYmKHRoaXMuaW5wdXQuZGVzdHJveSgpLHRoaXMuaW5wdXQudGFyZ2V0PWEuaW5wdXRUYXJnZXQsdGhpcy5pbnB1dC5pbml0KCkpLHRoaXN9LHN0b3A6ZnVuY3Rpb24oYSl7dGhpcy5zZXNzaW9uLnN0b3BwZWQ9YT9tYzpsY30scmVjb2duaXplOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuc2Vzc2lvbjtpZighYi5zdG9wcGVkKXt0aGlzLnRvdWNoQWN0aW9uLnByZXZlbnREZWZhdWx0cyhhKTt2YXIgYyxkPXRoaXMucmVjb2duaXplcnMsZT1iLmN1clJlY29nbml6ZXI7KCFlfHxlJiZlLnN0YXRlJmljKSYmKGU9Yi5jdXJSZWNvZ25pemVyPW51bGwpO2Zvcih2YXIgZj0wO2Y8ZC5sZW5ndGg7KWM9ZFtmXSxiLnN0b3BwZWQ9PT1tY3x8ZSYmYyE9ZSYmIWMuY2FuUmVjb2duaXplV2l0aChlKT9jLnJlc2V0KCk6Yy5yZWNvZ25pemUoYSksIWUmJmMuc3RhdGUmKGZjfGdjfGhjKSYmKGU9Yi5jdXJSZWNvZ25pemVyPWMpLGYrK319LGdldDpmdW5jdGlvbihhKXtpZihhIGluc3RhbmNlb2YgVilyZXR1cm4gYTtmb3IodmFyIGI9dGhpcy5yZWNvZ25pemVycyxjPTA7YzxiLmxlbmd0aDtjKyspaWYoYltjXS5vcHRpb25zLmV2ZW50PT1hKXJldHVybiBiW2NdO3JldHVybiBudWxsfSxhZGQ6ZnVuY3Rpb24oYSl7aWYoZihhLFwiYWRkXCIsdGhpcykpcmV0dXJuIHRoaXM7dmFyIGI9dGhpcy5nZXQoYS5vcHRpb25zLmV2ZW50KTtyZXR1cm4gYiYmdGhpcy5yZW1vdmUoYiksdGhpcy5yZWNvZ25pemVycy5wdXNoKGEpLGEubWFuYWdlcj10aGlzLHRoaXMudG91Y2hBY3Rpb24udXBkYXRlKCksYX0scmVtb3ZlOmZ1bmN0aW9uKGEpe2lmKGYoYSxcInJlbW92ZVwiLHRoaXMpKXJldHVybiB0aGlzO3ZhciBiPXRoaXMucmVjb2duaXplcnM7cmV0dXJuIGE9dGhpcy5nZXQoYSksYi5zcGxpY2UocyhiLGEpLDEpLHRoaXMudG91Y2hBY3Rpb24udXBkYXRlKCksdGhpc30sb246ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmhhbmRsZXJzO3JldHVybiBnKHIoYSksZnVuY3Rpb24oYSl7Y1thXT1jW2FdfHxbXSxjW2FdLnB1c2goYil9KSx0aGlzfSxvZmY6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmhhbmRsZXJzO3JldHVybiBnKHIoYSksZnVuY3Rpb24oYSl7Yj9jW2FdLnNwbGljZShzKGNbYV0sYiksMSk6ZGVsZXRlIGNbYV19KSx0aGlzfSxlbWl0OmZ1bmN0aW9uKGEsYil7dGhpcy5vcHRpb25zLmRvbUV2ZW50cyYmaGIoYSxiKTt2YXIgYz10aGlzLmhhbmRsZXJzW2FdJiZ0aGlzLmhhbmRsZXJzW2FdLnNsaWNlKCk7aWYoYyYmYy5sZW5ndGgpe2IudHlwZT1hLGIucHJldmVudERlZmF1bHQ9ZnVuY3Rpb24oKXtiLnNyY0V2ZW50LnByZXZlbnREZWZhdWx0KCl9O2Zvcih2YXIgZD0wO2Q8Yy5sZW5ndGg7KWNbZF0oYiksZCsrfX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuZWxlbWVudCYmZ2IodGhpcywhMSksdGhpcy5oYW5kbGVycz17fSx0aGlzLnNlc3Npb249e30sdGhpcy5pbnB1dC5kZXN0cm95KCksdGhpcy5lbGVtZW50PW51bGx9fSxoKGViLHtJTlBVVF9TVEFSVDp5YixJTlBVVF9NT1ZFOnpiLElOUFVUX0VORDpBYixJTlBVVF9DQU5DRUw6QmIsU1RBVEVfUE9TU0lCTEU6ZWMsU1RBVEVfQkVHQU46ZmMsU1RBVEVfQ0hBTkdFRDpnYyxTVEFURV9FTkRFRDpoYyxTVEFURV9SRUNPR05JWkVEOmljLFNUQVRFX0NBTkNFTExFRDpqYyxTVEFURV9GQUlMRUQ6a2MsRElSRUNUSU9OX05PTkU6Q2IsRElSRUNUSU9OX0xFRlQ6RGIsRElSRUNUSU9OX1JJR0hUOkViLERJUkVDVElPTl9VUDpGYixESVJFQ1RJT05fRE9XTjpHYixESVJFQ1RJT05fSE9SSVpPTlRBTDpIYixESVJFQ1RJT05fVkVSVElDQUw6SWIsRElSRUNUSU9OX0FMTDpKYixNYW5hZ2VyOmZiLElucHV0OnksVG91Y2hBY3Rpb246VCxUb3VjaElucHV0OlEsTW91c2VJbnB1dDpNLFBvaW50ZXJFdmVudElucHV0Ok4sVG91Y2hNb3VzZUlucHV0OlMsU2luZ2xlVG91Y2hJbnB1dDpPLFJlY29nbml6ZXI6VixBdHRyUmVjb2duaXplcjpaLFRhcDpkYixQYW46JCxTd2lwZTpjYixQaW5jaDpfLFJvdGF0ZTpiYixQcmVzczphYixvbjpuLG9mZjpvLGVhY2g6ZyxtZXJnZTppLGV4dGVuZDpoLGluaGVyaXQ6aixiaW5kRm46ayxwcmVmaXhlZDp2fSksdHlwZW9mIGRlZmluZT09a2ImJmRlZmluZS5hbWQ/ZGVmaW5lKGZ1bmN0aW9uKCl7cmV0dXJuIGVifSk6XCJ1bmRlZmluZWRcIiE9dHlwZW9mIG1vZHVsZSYmbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9ZWI6YVtjXT1lYn0od2luZG93LGRvY3VtZW50LFwiSGFtbWVyXCIpO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1oYW1tZXIubWluLm1hcCIsIi8qID09IGpxdWVyeSBtb3VzZXdoZWVsIHBsdWdpbiA9PSBWZXJzaW9uOiAzLjEuMTIsIExpY2Vuc2U6IE1JVCBMaWNlbnNlIChNSVQpICovXHJcbiFmdW5jdGlvbihhKXtcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFtcImpxdWVyeVwiXSxhKTpcIm9iamVjdFwiPT10eXBlb2YgZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1hOmEoalF1ZXJ5KX0oZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihiKXt2YXIgZz1ifHx3aW5kb3cuZXZlbnQsaD1pLmNhbGwoYXJndW1lbnRzLDEpLGo9MCxsPTAsbT0wLG49MCxvPTAscD0wO2lmKGI9YS5ldmVudC5maXgoZyksYi50eXBlPVwibW91c2V3aGVlbFwiLFwiZGV0YWlsXCJpbiBnJiYobT0tMSpnLmRldGFpbCksXCJ3aGVlbERlbHRhXCJpbiBnJiYobT1nLndoZWVsRGVsdGEpLFwid2hlZWxEZWx0YVlcImluIGcmJihtPWcud2hlZWxEZWx0YVkpLFwid2hlZWxEZWx0YVhcImluIGcmJihsPS0xKmcud2hlZWxEZWx0YVgpLFwiYXhpc1wiaW4gZyYmZy5heGlzPT09Zy5IT1JJWk9OVEFMX0FYSVMmJihsPS0xKm0sbT0wKSxqPTA9PT1tP2w6bSxcImRlbHRhWVwiaW4gZyYmKG09LTEqZy5kZWx0YVksaj1tKSxcImRlbHRhWFwiaW4gZyYmKGw9Zy5kZWx0YVgsMD09PW0mJihqPS0xKmwpKSwwIT09bXx8MCE9PWwpe2lmKDE9PT1nLmRlbHRhTW9kZSl7dmFyIHE9YS5kYXRhKHRoaXMsXCJtb3VzZXdoZWVsLWxpbmUtaGVpZ2h0XCIpO2oqPXEsbSo9cSxsKj1xfWVsc2UgaWYoMj09PWcuZGVsdGFNb2RlKXt2YXIgcj1hLmRhdGEodGhpcyxcIm1vdXNld2hlZWwtcGFnZS1oZWlnaHRcIik7aio9cixtKj1yLGwqPXJ9aWYobj1NYXRoLm1heChNYXRoLmFicyhtKSxNYXRoLmFicyhsKSksKCFmfHxmPm4pJiYoZj1uLGQoZyxuKSYmKGYvPTQwKSksZChnLG4pJiYoai89NDAsbC89NDAsbS89NDApLGo9TWF0aFtqPj0xP1wiZmxvb3JcIjpcImNlaWxcIl0oai9mKSxsPU1hdGhbbD49MT9cImZsb29yXCI6XCJjZWlsXCJdKGwvZiksbT1NYXRoW20+PTE/XCJmbG9vclwiOlwiY2VpbFwiXShtL2YpLGsuc2V0dGluZ3Mubm9ybWFsaXplT2Zmc2V0JiZ0aGlzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCl7dmFyIHM9dGhpcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtvPWIuY2xpZW50WC1zLmxlZnQscD1iLmNsaWVudFktcy50b3B9cmV0dXJuIGIuZGVsdGFYPWwsYi5kZWx0YVk9bSxiLmRlbHRhRmFjdG9yPWYsYi5vZmZzZXRYPW8sYi5vZmZzZXRZPXAsYi5kZWx0YU1vZGU9MCxoLnVuc2hpZnQoYixqLGwsbSksZSYmY2xlYXJUaW1lb3V0KGUpLGU9c2V0VGltZW91dChjLDIwMCksKGEuZXZlbnQuZGlzcGF0Y2h8fGEuZXZlbnQuaGFuZGxlKS5hcHBseSh0aGlzLGgpfX1mdW5jdGlvbiBjKCl7Zj1udWxsfWZ1bmN0aW9uIGQoYSxiKXtyZXR1cm4gay5zZXR0aW5ncy5hZGp1c3RPbGREZWx0YXMmJlwibW91c2V3aGVlbFwiPT09YS50eXBlJiZiJTEyMD09PTB9dmFyIGUsZixnPVtcIndoZWVsXCIsXCJtb3VzZXdoZWVsXCIsXCJET01Nb3VzZVNjcm9sbFwiLFwiTW96TW91c2VQaXhlbFNjcm9sbFwiXSxoPVwib253aGVlbFwiaW4gZG9jdW1lbnR8fGRvY3VtZW50LmRvY3VtZW50TW9kZT49OT9bXCJ3aGVlbFwiXTpbXCJtb3VzZXdoZWVsXCIsXCJEb21Nb3VzZVNjcm9sbFwiLFwiTW96TW91c2VQaXhlbFNjcm9sbFwiXSxpPUFycmF5LnByb3RvdHlwZS5zbGljZTtpZihhLmV2ZW50LmZpeEhvb2tzKWZvcih2YXIgaj1nLmxlbmd0aDtqOylhLmV2ZW50LmZpeEhvb2tzW2dbLS1qXV09YS5ldmVudC5tb3VzZUhvb2tzO3ZhciBrPWEuZXZlbnQuc3BlY2lhbC5tb3VzZXdoZWVsPXt2ZXJzaW9uOlwiMy4xLjEyXCIsc2V0dXA6ZnVuY3Rpb24oKXtpZih0aGlzLmFkZEV2ZW50TGlzdGVuZXIpZm9yKHZhciBjPWgubGVuZ3RoO2M7KXRoaXMuYWRkRXZlbnRMaXN0ZW5lcihoWy0tY10sYiwhMSk7ZWxzZSB0aGlzLm9ubW91c2V3aGVlbD1iO2EuZGF0YSh0aGlzLFwibW91c2V3aGVlbC1saW5lLWhlaWdodFwiLGsuZ2V0TGluZUhlaWdodCh0aGlzKSksYS5kYXRhKHRoaXMsXCJtb3VzZXdoZWVsLXBhZ2UtaGVpZ2h0XCIsay5nZXRQYWdlSGVpZ2h0KHRoaXMpKX0sdGVhcmRvd246ZnVuY3Rpb24oKXtpZih0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIpZm9yKHZhciBjPWgubGVuZ3RoO2M7KXRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcihoWy0tY10sYiwhMSk7ZWxzZSB0aGlzLm9ubW91c2V3aGVlbD1udWxsO2EucmVtb3ZlRGF0YSh0aGlzLFwibW91c2V3aGVlbC1saW5lLWhlaWdodFwiKSxhLnJlbW92ZURhdGEodGhpcyxcIm1vdXNld2hlZWwtcGFnZS1oZWlnaHRcIil9LGdldExpbmVIZWlnaHQ6ZnVuY3Rpb24oYil7dmFyIGM9YShiKSxkPWNbXCJvZmZzZXRQYXJlbnRcImluIGEuZm4/XCJvZmZzZXRQYXJlbnRcIjpcInBhcmVudFwiXSgpO3JldHVybiBkLmxlbmd0aHx8KGQ9YShcImJvZHlcIikpLHBhcnNlSW50KGQuY3NzKFwiZm9udFNpemVcIiksMTApfHxwYXJzZUludChjLmNzcyhcImZvbnRTaXplXCIpLDEwKXx8MTZ9LGdldFBhZ2VIZWlnaHQ6ZnVuY3Rpb24oYil7cmV0dXJuIGEoYikuaGVpZ2h0KCl9LHNldHRpbmdzOnthZGp1c3RPbGREZWx0YXM6ITAsbm9ybWFsaXplT2Zmc2V0OiEwfX07YS5mbi5leHRlbmQoe21vdXNld2hlZWw6ZnVuY3Rpb24oYSl7cmV0dXJuIGE/dGhpcy5iaW5kKFwibW91c2V3aGVlbFwiLGEpOnRoaXMudHJpZ2dlcihcIm1vdXNld2hlZWxcIil9LHVubW91c2V3aGVlbDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy51bmJpbmQoXCJtb3VzZXdoZWVsXCIsYSl9fSl9KTtcclxuLyogPT0gbWFsaWh1IGpxdWVyeSBjdXN0b20gc2Nyb2xsYmFyIHBsdWdpbiA9PSBWZXJzaW9uOiAzLjAuNywgTGljZW5zZTogTUlUIExpY2Vuc2UgKE1JVCkgKi9cclxuIWZ1bmN0aW9uKGUsdCxhKXshZnVuY3Rpb24odCl7dmFyIG89XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kLG49XCJodHRwczpcIj09YS5sb2NhdGlvbi5wcm90b2NvbD9cImh0dHBzOlwiOlwiaHR0cDpcIixpPVwiY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2pxdWVyeS1tb3VzZXdoZWVsLzMuMS4xMi9qcXVlcnkubW91c2V3aGVlbC5taW4uanNcIjtvfHxlLmV2ZW50LnNwZWNpYWwubW91c2V3aGVlbHx8ZShcImhlYWRcIikuYXBwZW5kKGRlY29kZVVSSShcIiUzQ3NjcmlwdCBzcmM9XCIrbitcIi8vXCIraStcIiUzRSUzQy9zY3JpcHQlM0VcIikpLHQoKX0oZnVuY3Rpb24oKXt2YXIgbyxuPVwibUN1c3RvbVNjcm9sbGJhclwiLGk9XCJtQ1NcIixyPVwiLm1DdXN0b21TY3JvbGxiYXJcIixsPXtzZXRUb3A6MCxzZXRMZWZ0OjAsYXhpczpcInlcIixzY3JvbGxiYXJQb3NpdGlvbjpcImluc2lkZVwiLHNjcm9sbEluZXJ0aWE6OTUwLGF1dG9EcmFnZ2VyTGVuZ3RoOiEwLGFsd2F5c1Nob3dTY3JvbGxiYXI6MCxzbmFwT2Zmc2V0OjAsbW91c2VXaGVlbDp7ZW5hYmxlOiEwLHNjcm9sbEFtb3VudDpcImF1dG9cIixheGlzOlwieVwiLGRlbHRhRmFjdG9yOlwiYXV0b1wiLGRpc2FibGVPdmVyOltcInNlbGVjdFwiLFwib3B0aW9uXCIsXCJrZXlnZW5cIixcImRhdGFsaXN0XCIsXCJ0ZXh0YXJlYVwiXX0sc2Nyb2xsQnV0dG9uczp7c2Nyb2xsVHlwZTpcInN0ZXBsZXNzXCIsc2Nyb2xsQW1vdW50OlwiYXV0b1wifSxrZXlib2FyZDp7ZW5hYmxlOiEwLHNjcm9sbFR5cGU6XCJzdGVwbGVzc1wiLHNjcm9sbEFtb3VudDpcImF1dG9cIn0sY29udGVudFRvdWNoU2Nyb2xsOjI1LGFkdmFuY2VkOnthdXRvU2Nyb2xsT25Gb2N1czpcImlucHV0LHRleHRhcmVhLHNlbGVjdCxidXR0b24sZGF0YWxpc3Qsa2V5Z2VuLGFbdGFiaW5kZXhdLGFyZWEsb2JqZWN0LFtjb250ZW50ZWRpdGFibGU9J3RydWUnXVwiLHVwZGF0ZU9uQ29udGVudFJlc2l6ZTohMCx1cGRhdGVPbkltYWdlTG9hZDohMH0sdGhlbWU6XCJsaWdodFwiLGNhbGxiYWNrczp7b25Ub3RhbFNjcm9sbE9mZnNldDowLG9uVG90YWxTY3JvbGxCYWNrT2Zmc2V0OjAsYWx3YXlzVHJpZ2dlck9mZnNldHM6ITB9fSxzPTAsYz17fSxkPXQuYXR0YWNoRXZlbnQmJiF0LmFkZEV2ZW50TGlzdGVuZXI/MTowLHU9ITEsZj1bXCJtQ1NCX2RyYWdnZXJfb25EcmFnXCIsXCJtQ1NCX3Njcm9sbFRvb2xzX29uRHJhZ1wiLFwibUNTX2ltZ19sb2FkZWRcIixcIm1DU19kaXNhYmxlZFwiLFwibUNTX2Rlc3Ryb3llZFwiLFwibUNTX25vX3Njcm9sbGJhclwiLFwibUNTLWF1dG9IaWRlXCIsXCJtQ1MtZGlyLXJ0bFwiLFwibUNTX25vX3Njcm9sbGJhcl95XCIsXCJtQ1Nfbm9fc2Nyb2xsYmFyX3hcIixcIm1DU195X2hpZGRlblwiLFwibUNTX3hfaGlkZGVuXCIsXCJtQ1NCX2RyYWdnZXJDb250YWluZXJcIixcIm1DU0JfYnV0dG9uVXBcIixcIm1DU0JfYnV0dG9uRG93blwiLFwibUNTQl9idXR0b25MZWZ0XCIsXCJtQ1NCX2J1dHRvblJpZ2h0XCJdLGg9e2luaXQ6ZnVuY3Rpb24odCl7dmFyIHQ9ZS5leHRlbmQoITAse30sbCx0KSxhPW0uY2FsbCh0aGlzKTtpZih0LmxpdmUpe3ZhciBvPXQubGl2ZVNlbGVjdG9yfHx0aGlzLnNlbGVjdG9yfHxyLG49ZShvKTtpZihcIm9mZlwiPT09dC5saXZlKXJldHVybiB2b2lkIGcobyk7Y1tvXT1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7bi5tQ3VzdG9tU2Nyb2xsYmFyKHQpLFwib25jZVwiPT09dC5saXZlJiZuLmxlbmd0aCYmZyhvKX0sNTAwKX1lbHNlIGcobyk7cmV0dXJuIHQuc2V0V2lkdGg9dC5zZXRfd2lkdGg/dC5zZXRfd2lkdGg6dC5zZXRXaWR0aCx0LnNldEhlaWdodD10LnNldF9oZWlnaHQ/dC5zZXRfaGVpZ2h0OnQuc2V0SGVpZ2h0LHQuYXhpcz10Lmhvcml6b250YWxTY3JvbGw/XCJ4XCI6dih0LmF4aXMpLHQuc2Nyb2xsSW5lcnRpYT10LnNjcm9sbEluZXJ0aWE+MCYmdC5zY3JvbGxJbmVydGlhPDE3PzE3OnQuc2Nyb2xsSW5lcnRpYSxcIm9iamVjdFwiIT10eXBlb2YgdC5tb3VzZVdoZWVsJiYxPT10Lm1vdXNlV2hlZWwmJih0Lm1vdXNlV2hlZWw9e2VuYWJsZTohMCxzY3JvbGxBbW91bnQ6XCJhdXRvXCIsYXhpczpcInlcIixwcmV2ZW50RGVmYXVsdDohMSxkZWx0YUZhY3RvcjpcImF1dG9cIixub3JtYWxpemVEZWx0YTohMSxpbnZlcnQ6ITF9KSx0Lm1vdXNlV2hlZWwuc2Nyb2xsQW1vdW50PXQubW91c2VXaGVlbFBpeGVscz90Lm1vdXNlV2hlZWxQaXhlbHM6dC5tb3VzZVdoZWVsLnNjcm9sbEFtb3VudCx0Lm1vdXNlV2hlZWwubm9ybWFsaXplRGVsdGE9dC5hZHZhbmNlZC5ub3JtYWxpemVNb3VzZVdoZWVsRGVsdGE/dC5hZHZhbmNlZC5ub3JtYWxpemVNb3VzZVdoZWVsRGVsdGE6dC5tb3VzZVdoZWVsLm5vcm1hbGl6ZURlbHRhLHQuc2Nyb2xsQnV0dG9ucy5zY3JvbGxUeXBlPXgodC5zY3JvbGxCdXR0b25zLnNjcm9sbFR5cGUpLHAodCksZShhKS5lYWNoKGZ1bmN0aW9uKCl7dmFyIGE9ZSh0aGlzKTtpZighYS5kYXRhKGkpKXthLmRhdGEoaSx7aWR4OisrcyxvcHQ6dCxzY3JvbGxSYXRpbzp7eTpudWxsLHg6bnVsbH0sb3ZlcmZsb3dlZDpudWxsLGNvbnRlbnRSZXNldDp7eTpudWxsLHg6bnVsbH0sYmluZEV2ZW50czohMSx0d2VlblJ1bm5pbmc6ITEsc2VxdWVudGlhbDp7fSxsYW5nRGlyOmEuY3NzKFwiZGlyZWN0aW9uXCIpLGNiT2Zmc2V0czpudWxsLHRyaWdnZXI6bnVsbH0pO3ZhciBvPWEuZGF0YShpKSxuPW8ub3B0LHI9YS5kYXRhKFwibWNzLWF4aXNcIiksbD1hLmRhdGEoXCJtY3Mtc2Nyb2xsYmFyLXBvc2l0aW9uXCIpLGM9YS5kYXRhKFwibWNzLXRoZW1lXCIpO3ImJihuLmF4aXM9ciksbCYmKG4uc2Nyb2xsYmFyUG9zaXRpb249bCksYyYmKG4udGhlbWU9YyxwKG4pKSxfLmNhbGwodGhpcyksZShcIiNtQ1NCX1wiK28uaWR4K1wiX2NvbnRhaW5lciBpbWc6bm90KC5cIitmWzJdK1wiKVwiKS5hZGRDbGFzcyhmWzJdKSxoLnVwZGF0ZS5jYWxsKG51bGwsYSl9fSl9LHVwZGF0ZTpmdW5jdGlvbih0LGEpe3ZhciBvPXR8fG0uY2FsbCh0aGlzKTtyZXR1cm4gZShvKS5lYWNoKGZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKTtpZih0LmRhdGEoaSkpe3ZhciBvPXQuZGF0YShpKSxuPW8ub3B0LHI9ZShcIiNtQ1NCX1wiK28uaWR4K1wiX2NvbnRhaW5lclwiKSxsPVtlKFwiI21DU0JfXCIrby5pZHgrXCJfZHJhZ2dlcl92ZXJ0aWNhbFwiKSxlKFwiI21DU0JfXCIrby5pZHgrXCJfZHJhZ2dlcl9ob3Jpem9udGFsXCIpXTtpZighci5sZW5ndGgpcmV0dXJuO28udHdlZW5SdW5uaW5nJiZRKHQpLHQuaGFzQ2xhc3MoZlszXSkmJnQucmVtb3ZlQ2xhc3MoZlszXSksdC5oYXNDbGFzcyhmWzRdKSYmdC5yZW1vdmVDbGFzcyhmWzRdKSxDLmNhbGwodGhpcyksdy5jYWxsKHRoaXMpLFwieVwiPT09bi5heGlzfHxuLmFkdmFuY2VkLmF1dG9FeHBhbmRIb3Jpem9udGFsU2Nyb2xsfHxyLmNzcyhcIndpZHRoXCIsUyhyLmNoaWxkcmVuKCkpKSxvLm92ZXJmbG93ZWQ9ay5jYWxsKHRoaXMpLFIuY2FsbCh0aGlzKSxuLmF1dG9EcmFnZ2VyTGVuZ3RoJiZ5LmNhbGwodGhpcyksQi5jYWxsKHRoaXMpLE8uY2FsbCh0aGlzKTt2YXIgcz1bTWF0aC5hYnMoclswXS5vZmZzZXRUb3ApLE1hdGguYWJzKHJbMF0ub2Zmc2V0TGVmdCldO1wieFwiIT09bi5heGlzJiYoby5vdmVyZmxvd2VkWzBdP2xbMF0uaGVpZ2h0KCk+bFswXS5wYXJlbnQoKS5oZWlnaHQoKT9NLmNhbGwodGhpcyk6KEcodCxzWzBdLnRvU3RyaW5nKCkse2RpcjpcInlcIixkdXI6MCxvdmVyd3JpdGU6XCJub25lXCJ9KSxvLmNvbnRlbnRSZXNldC55PW51bGwpOihNLmNhbGwodGhpcyksXCJ5XCI9PT1uLmF4aXM/SS5jYWxsKHRoaXMpOlwieXhcIj09PW4uYXhpcyYmby5vdmVyZmxvd2VkWzFdJiZHKHQsc1sxXS50b1N0cmluZygpLHtkaXI6XCJ4XCIsZHVyOjAsb3ZlcndyaXRlOlwibm9uZVwifSkpKSxcInlcIiE9PW4uYXhpcyYmKG8ub3ZlcmZsb3dlZFsxXT9sWzFdLndpZHRoKCk+bFsxXS5wYXJlbnQoKS53aWR0aCgpP00uY2FsbCh0aGlzKTooRyh0LHNbMV0udG9TdHJpbmcoKSx7ZGlyOlwieFwiLGR1cjowLG92ZXJ3cml0ZTpcIm5vbmVcIn0pLG8uY29udGVudFJlc2V0Lng9bnVsbCk6KE0uY2FsbCh0aGlzKSxcInhcIj09PW4uYXhpcz9JLmNhbGwodGhpcyk6XCJ5eFwiPT09bi5heGlzJiZvLm92ZXJmbG93ZWRbMF0mJkcodCxzWzBdLnRvU3RyaW5nKCkse2RpcjpcInlcIixkdXI6MCxvdmVyd3JpdGU6XCJub25lXCJ9KSkpLGEmJm8mJigyPT09YSYmbi5jYWxsYmFja3Mub25JbWFnZUxvYWQmJlwiZnVuY3Rpb25cIj09dHlwZW9mIG4uY2FsbGJhY2tzLm9uSW1hZ2VMb2FkP24uY2FsbGJhY2tzLm9uSW1hZ2VMb2FkLmNhbGwodGhpcyk6Mz09PWEmJm4uY2FsbGJhY2tzLm9uU2VsZWN0b3JDaGFuZ2UmJlwiZnVuY3Rpb25cIj09dHlwZW9mIG4uY2FsbGJhY2tzLm9uU2VsZWN0b3JDaGFuZ2U/bi5jYWxsYmFja3Mub25TZWxlY3RvckNoYW5nZS5jYWxsKHRoaXMpOm4uY2FsbGJhY2tzLm9uVXBkYXRlJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBuLmNhbGxiYWNrcy5vblVwZGF0ZSYmbi5jYWxsYmFja3Mub25VcGRhdGUuY2FsbCh0aGlzKSksTi5jYWxsKHRoaXMpfX0pfSxzY3JvbGxUbzpmdW5jdGlvbih0LGEpe2lmKFwidW5kZWZpbmVkXCIhPXR5cGVvZiB0JiZudWxsIT10KXt2YXIgbz1tLmNhbGwodGhpcyk7cmV0dXJuIGUobykuZWFjaChmdW5jdGlvbigpe3ZhciBvPWUodGhpcyk7aWYoby5kYXRhKGkpKXt2YXIgbj1vLmRhdGEoaSkscj1uLm9wdCxsPXt0cmlnZ2VyOlwiZXh0ZXJuYWxcIixzY3JvbGxJbmVydGlhOnIuc2Nyb2xsSW5lcnRpYSxzY3JvbGxFYXNpbmc6XCJtY3NFYXNlSW5PdXRcIixtb3ZlRHJhZ2dlcjohMSx0aW1lb3V0OjYwLGNhbGxiYWNrczohMCxvblN0YXJ0OiEwLG9uVXBkYXRlOiEwLG9uQ29tcGxldGU6ITB9LHM9ZS5leHRlbmQoITAse30sbCxhKSxjPVkuY2FsbCh0aGlzLHQpLGQ9cy5zY3JvbGxJbmVydGlhPjAmJnMuc2Nyb2xsSW5lcnRpYTwxNz8xNzpzLnNjcm9sbEluZXJ0aWE7Y1swXT1YLmNhbGwodGhpcyxjWzBdLFwieVwiKSxjWzFdPVguY2FsbCh0aGlzLGNbMV0sXCJ4XCIpLHMubW92ZURyYWdnZXImJihjWzBdKj1uLnNjcm9sbFJhdGlvLnksY1sxXSo9bi5zY3JvbGxSYXRpby54KSxzLmR1cj1kLHNldFRpbWVvdXQoZnVuY3Rpb24oKXtudWxsIT09Y1swXSYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGNbMF0mJlwieFwiIT09ci5heGlzJiZuLm92ZXJmbG93ZWRbMF0mJihzLmRpcj1cInlcIixzLm92ZXJ3cml0ZT1cImFsbFwiLEcobyxjWzBdLnRvU3RyaW5nKCkscykpLG51bGwhPT1jWzFdJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgY1sxXSYmXCJ5XCIhPT1yLmF4aXMmJm4ub3ZlcmZsb3dlZFsxXSYmKHMuZGlyPVwieFwiLHMub3ZlcndyaXRlPVwibm9uZVwiLEcobyxjWzFdLnRvU3RyaW5nKCkscykpfSxzLnRpbWVvdXQpfX0pfX0sc3RvcDpmdW5jdGlvbigpe3ZhciB0PW0uY2FsbCh0aGlzKTtyZXR1cm4gZSh0KS5lYWNoKGZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKTt0LmRhdGEoaSkmJlEodCl9KX0sZGlzYWJsZTpmdW5jdGlvbih0KXt2YXIgYT1tLmNhbGwodGhpcyk7cmV0dXJuIGUoYSkuZWFjaChmdW5jdGlvbigpe3ZhciBhPWUodGhpcyk7aWYoYS5kYXRhKGkpKXt7YS5kYXRhKGkpfU4uY2FsbCh0aGlzLFwicmVtb3ZlXCIpLEkuY2FsbCh0aGlzKSx0JiZNLmNhbGwodGhpcyksUi5jYWxsKHRoaXMsITApLGEuYWRkQ2xhc3MoZlszXSl9fSl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgdD1tLmNhbGwodGhpcyk7cmV0dXJuIGUodCkuZWFjaChmdW5jdGlvbigpe3ZhciBhPWUodGhpcyk7aWYoYS5kYXRhKGkpKXt2YXIgbz1hLmRhdGEoaSkscj1vLm9wdCxsPWUoXCIjbUNTQl9cIitvLmlkeCkscz1lKFwiI21DU0JfXCIrby5pZHgrXCJfY29udGFpbmVyXCIpLGM9ZShcIi5tQ1NCX1wiK28uaWR4K1wiX3Njcm9sbGJhclwiKTtyLmxpdmUmJmcoci5saXZlU2VsZWN0b3J8fGUodCkuc2VsZWN0b3IpLE4uY2FsbCh0aGlzLFwicmVtb3ZlXCIpLEkuY2FsbCh0aGlzKSxNLmNhbGwodGhpcyksYS5yZW1vdmVEYXRhKGkpLCQodGhpcyxcIm1jc1wiKSxjLnJlbW92ZSgpLHMuZmluZChcImltZy5cIitmWzJdKS5yZW1vdmVDbGFzcyhmWzJdKSxsLnJlcGxhY2VXaXRoKHMuY29udGVudHMoKSksYS5yZW1vdmVDbGFzcyhuK1wiIF9cIitpK1wiX1wiK28uaWR4K1wiIFwiK2ZbNl0rXCIgXCIrZls3XStcIiBcIitmWzVdK1wiIFwiK2ZbM10pLmFkZENsYXNzKGZbNF0pfX0pfX0sbT1mdW5jdGlvbigpe3JldHVyblwib2JqZWN0XCIhPXR5cGVvZiBlKHRoaXMpfHxlKHRoaXMpLmxlbmd0aDwxP3I6dGhpc30scD1mdW5jdGlvbih0KXt2YXIgYT1bXCJyb3VuZGVkXCIsXCJyb3VuZGVkLWRhcmtcIixcInJvdW5kZWQtZG90c1wiLFwicm91bmRlZC1kb3RzLWRhcmtcIl0sbz1bXCJyb3VuZGVkLWRvdHNcIixcInJvdW5kZWQtZG90cy1kYXJrXCIsXCIzZFwiLFwiM2QtZGFya1wiLFwiM2QtdGhpY2tcIixcIjNkLXRoaWNrLWRhcmtcIixcImluc2V0XCIsXCJpbnNldC1kYXJrXCIsXCJpbnNldC0yXCIsXCJpbnNldC0yLWRhcmtcIixcImluc2V0LTNcIixcImluc2V0LTMtZGFya1wiXSxuPVtcIm1pbmltYWxcIixcIm1pbmltYWwtZGFya1wiXSxpPVtcIm1pbmltYWxcIixcIm1pbmltYWwtZGFya1wiXSxyPVtcIm1pbmltYWxcIixcIm1pbmltYWwtZGFya1wiXTt0LmF1dG9EcmFnZ2VyTGVuZ3RoPWUuaW5BcnJheSh0LnRoZW1lLGEpPi0xPyExOnQuYXV0b0RyYWdnZXJMZW5ndGgsdC5hdXRvRXhwYW5kU2Nyb2xsYmFyPWUuaW5BcnJheSh0LnRoZW1lLG8pPi0xPyExOnQuYXV0b0V4cGFuZFNjcm9sbGJhcix0LnNjcm9sbEJ1dHRvbnMuZW5hYmxlPWUuaW5BcnJheSh0LnRoZW1lLG4pPi0xPyExOnQuc2Nyb2xsQnV0dG9ucy5lbmFibGUsdC5hdXRvSGlkZVNjcm9sbGJhcj1lLmluQXJyYXkodC50aGVtZSxpKT4tMT8hMDp0LmF1dG9IaWRlU2Nyb2xsYmFyLHQuc2Nyb2xsYmFyUG9zaXRpb249ZS5pbkFycmF5KHQudGhlbWUscik+LTE/XCJvdXRzaWRlXCI6dC5zY3JvbGxiYXJQb3NpdGlvbn0sZz1mdW5jdGlvbihlKXtjW2VdJiYoY2xlYXJUaW1lb3V0KGNbZV0pLCQoYyxlKSl9LHY9ZnVuY3Rpb24oZSl7cmV0dXJuXCJ5eFwiPT09ZXx8XCJ4eVwiPT09ZXx8XCJhdXRvXCI9PT1lP1wieXhcIjpcInhcIj09PWV8fFwiaG9yaXpvbnRhbFwiPT09ZT9cInhcIjpcInlcIn0seD1mdW5jdGlvbihlKXtyZXR1cm5cInN0ZXBwZWRcIj09PWV8fFwicGl4ZWxzXCI9PT1lfHxcInN0ZXBcIj09PWV8fFwiY2xpY2tcIj09PWU/XCJzdGVwcGVkXCI6XCJzdGVwbGVzc1wifSxfPWZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKSxhPXQuZGF0YShpKSxvPWEub3B0LHI9by5hdXRvRXhwYW5kU2Nyb2xsYmFyP1wiIFwiK2ZbMV0rXCJfZXhwYW5kXCI6XCJcIixsPVtcIjxkaXYgaWQ9J21DU0JfXCIrYS5pZHgrXCJfc2Nyb2xsYmFyX3ZlcnRpY2FsJyBjbGFzcz0nbUNTQl9zY3JvbGxUb29scyBtQ1NCX1wiK2EuaWR4K1wiX3Njcm9sbGJhciBtQ1MtXCIrby50aGVtZStcIiBtQ1NCX3Njcm9sbFRvb2xzX3ZlcnRpY2FsXCIrcitcIic+PGRpdiBjbGFzcz0nXCIrZlsxMl0rXCInPjxkaXYgaWQ9J21DU0JfXCIrYS5pZHgrXCJfZHJhZ2dlcl92ZXJ0aWNhbCcgY2xhc3M9J21DU0JfZHJhZ2dlcicgc3R5bGU9J3Bvc2l0aW9uOmFic29sdXRlOycgb25jb250ZXh0bWVudT0ncmV0dXJuIGZhbHNlOyc+PGRpdiBjbGFzcz0nbUNTQl9kcmFnZ2VyX2JhcicgLz48L2Rpdj48ZGl2IGNsYXNzPSdtQ1NCX2RyYWdnZXJSYWlsJyAvPjwvZGl2PjwvZGl2PlwiLFwiPGRpdiBpZD0nbUNTQl9cIithLmlkeCtcIl9zY3JvbGxiYXJfaG9yaXpvbnRhbCcgY2xhc3M9J21DU0Jfc2Nyb2xsVG9vbHMgbUNTQl9cIithLmlkeCtcIl9zY3JvbGxiYXIgbUNTLVwiK28udGhlbWUrXCIgbUNTQl9zY3JvbGxUb29sc19ob3Jpem9udGFsXCIrcitcIic+PGRpdiBjbGFzcz0nXCIrZlsxMl0rXCInPjxkaXYgaWQ9J21DU0JfXCIrYS5pZHgrXCJfZHJhZ2dlcl9ob3Jpem9udGFsJyBjbGFzcz0nbUNTQl9kcmFnZ2VyJyBzdHlsZT0ncG9zaXRpb246YWJzb2x1dGU7JyBvbmNvbnRleHRtZW51PSdyZXR1cm4gZmFsc2U7Jz48ZGl2IGNsYXNzPSdtQ1NCX2RyYWdnZXJfYmFyJyAvPjwvZGl2PjxkaXYgY2xhc3M9J21DU0JfZHJhZ2dlclJhaWwnIC8+PC9kaXY+PC9kaXY+XCJdLHM9XCJ5eFwiPT09by5heGlzP1wibUNTQl92ZXJ0aWNhbF9ob3Jpem9udGFsXCI6XCJ4XCI9PT1vLmF4aXM/XCJtQ1NCX2hvcml6b250YWxcIjpcIm1DU0JfdmVydGljYWxcIixjPVwieXhcIj09PW8uYXhpcz9sWzBdK2xbMV06XCJ4XCI9PT1vLmF4aXM/bFsxXTpsWzBdLGQ9XCJ5eFwiPT09by5heGlzP1wiPGRpdiBpZD0nbUNTQl9cIithLmlkeCtcIl9jb250YWluZXJfd3JhcHBlcicgY2xhc3M9J21DU0JfY29udGFpbmVyX3dyYXBwZXInIC8+XCI6XCJcIix1PW8uYXV0b0hpZGVTY3JvbGxiYXI/XCIgXCIrZls2XTpcIlwiLGg9XCJ4XCIhPT1vLmF4aXMmJlwicnRsXCI9PT1hLmxhbmdEaXI/XCIgXCIrZls3XTpcIlwiO28uc2V0V2lkdGgmJnQuY3NzKFwid2lkdGhcIixvLnNldFdpZHRoKSxvLnNldEhlaWdodCYmdC5jc3MoXCJoZWlnaHRcIixvLnNldEhlaWdodCksby5zZXRMZWZ0PVwieVwiIT09by5heGlzJiZcInJ0bFwiPT09YS5sYW5nRGlyP1wiOTg5OTk5cHhcIjpvLnNldExlZnQsdC5hZGRDbGFzcyhuK1wiIF9cIitpK1wiX1wiK2EuaWR4K3UraCkud3JhcElubmVyKFwiPGRpdiBpZD0nbUNTQl9cIithLmlkeCtcIicgY2xhc3M9J21DdXN0b21TY3JvbGxCb3ggbUNTLVwiK28udGhlbWUrXCIgXCIrcytcIic+PGRpdiBpZD0nbUNTQl9cIithLmlkeCtcIl9jb250YWluZXInIGNsYXNzPSdtQ1NCX2NvbnRhaW5lcicgc3R5bGU9J3Bvc2l0aW9uOnJlbGF0aXZlOyB0b3A6XCIrby5zZXRUb3ArXCI7IGxlZnQ6XCIrby5zZXRMZWZ0K1wiOycgZGlyPVwiK2EubGFuZ0RpcitcIiAvPjwvZGl2PlwiKTt2YXIgbT1lKFwiI21DU0JfXCIrYS5pZHgpLHA9ZShcIiNtQ1NCX1wiK2EuaWR4K1wiX2NvbnRhaW5lclwiKTtcInlcIj09PW8uYXhpc3x8by5hZHZhbmNlZC5hdXRvRXhwYW5kSG9yaXpvbnRhbFNjcm9sbHx8cC5jc3MoXCJ3aWR0aFwiLFMocC5jaGlsZHJlbigpKSksXCJvdXRzaWRlXCI9PT1vLnNjcm9sbGJhclBvc2l0aW9uPyhcInN0YXRpY1wiPT09dC5jc3MoXCJwb3NpdGlvblwiKSYmdC5jc3MoXCJwb3NpdGlvblwiLFwicmVsYXRpdmVcIiksdC5jc3MoXCJvdmVyZmxvd1wiLFwidmlzaWJsZVwiKSxtLmFkZENsYXNzKFwibUNTQl9vdXRzaWRlXCIpLmFmdGVyKGMpKToobS5hZGRDbGFzcyhcIm1DU0JfaW5zaWRlXCIpLmFwcGVuZChjKSxwLndyYXAoZCkpLGIuY2FsbCh0aGlzKTt2YXIgZz1bZShcIiNtQ1NCX1wiK2EuaWR4K1wiX2RyYWdnZXJfdmVydGljYWxcIiksZShcIiNtQ1NCX1wiK2EuaWR4K1wiX2RyYWdnZXJfaG9yaXpvbnRhbFwiKV07Z1swXS5jc3MoXCJtaW4taGVpZ2h0XCIsZ1swXS5oZWlnaHQoKSksZ1sxXS5jc3MoXCJtaW4td2lkdGhcIixnWzFdLndpZHRoKCkpfSxTPWZ1bmN0aW9uKHQpe3JldHVybiBNYXRoLm1heC5hcHBseShNYXRoLHQubWFwKGZ1bmN0aW9uKCl7cmV0dXJuIGUodGhpcykub3V0ZXJXaWR0aCghMCl9KS5nZXQoKSl9LHc9ZnVuY3Rpb24oKXt2YXIgdD1lKHRoaXMpLGE9dC5kYXRhKGkpLG89YS5vcHQsbj1lKFwiI21DU0JfXCIrYS5pZHgrXCJfY29udGFpbmVyXCIpO28uYWR2YW5jZWQuYXV0b0V4cGFuZEhvcml6b250YWxTY3JvbGwmJlwieVwiIT09by5heGlzJiZuLmNzcyh7cG9zaXRpb246XCJhYnNvbHV0ZVwiLHdpZHRoOlwiYXV0b1wifSkud3JhcChcIjxkaXYgY2xhc3M9J21DU0JfaF93cmFwcGVyJyBzdHlsZT0ncG9zaXRpb246cmVsYXRpdmU7IGxlZnQ6MDsgd2lkdGg6OTk5OTk5cHg7JyAvPlwiKS5jc3Moe3dpZHRoOk1hdGguY2VpbChuWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnJpZ2h0Ky40KS1NYXRoLmZsb29yKG5bMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCkscG9zaXRpb246XCJyZWxhdGl2ZVwifSkudW53cmFwKCl9LGI9ZnVuY3Rpb24oKXt2YXIgdD1lKHRoaXMpLGE9dC5kYXRhKGkpLG89YS5vcHQsbj1lKFwiLm1DU0JfXCIrYS5pZHgrXCJfc2Nyb2xsYmFyOmZpcnN0XCIpLHI9YXQoby5zY3JvbGxCdXR0b25zLnRhYmluZGV4KT9cInRhYmluZGV4PSdcIitvLnNjcm9sbEJ1dHRvbnMudGFiaW5kZXgrXCInXCI6XCJcIixsPVtcIjxhIGhyZWY9JyMnIGNsYXNzPSdcIitmWzEzXStcIicgb25jb250ZXh0bWVudT0ncmV0dXJuIGZhbHNlOycgXCIrcitcIiAvPlwiLFwiPGEgaHJlZj0nIycgY2xhc3M9J1wiK2ZbMTRdK1wiJyBvbmNvbnRleHRtZW51PSdyZXR1cm4gZmFsc2U7JyBcIityK1wiIC8+XCIsXCI8YSBocmVmPScjJyBjbGFzcz0nXCIrZlsxNV0rXCInIG9uY29udGV4dG1lbnU9J3JldHVybiBmYWxzZTsnIFwiK3IrXCIgLz5cIixcIjxhIGhyZWY9JyMnIGNsYXNzPSdcIitmWzE2XStcIicgb25jb250ZXh0bWVudT0ncmV0dXJuIGZhbHNlOycgXCIrcitcIiAvPlwiXSxzPVtcInhcIj09PW8uYXhpcz9sWzJdOmxbMF0sXCJ4XCI9PT1vLmF4aXM/bFszXTpsWzFdLGxbMl0sbFszXV07by5zY3JvbGxCdXR0b25zLmVuYWJsZSYmbi5wcmVwZW5kKHNbMF0pLmFwcGVuZChzWzFdKS5uZXh0KFwiLm1DU0Jfc2Nyb2xsVG9vbHNcIikucHJlcGVuZChzWzJdKS5hcHBlbmQoc1szXSl9LEM9ZnVuY3Rpb24oKXt2YXIgdD1lKHRoaXMpLGE9dC5kYXRhKGkpLG89ZShcIiNtQ1NCX1wiK2EuaWR4KSxuPXQuY3NzKFwibWF4LWhlaWdodFwiKXx8XCJub25lXCIscj0tMSE9PW4uaW5kZXhPZihcIiVcIiksbD10LmNzcyhcImJveC1zaXppbmdcIik7aWYoXCJub25lXCIhPT1uKXt2YXIgcz1yP3QucGFyZW50KCkuaGVpZ2h0KCkqcGFyc2VJbnQobikvMTAwOnBhcnNlSW50KG4pO1wiYm9yZGVyLWJveFwiPT09bCYmKHMtPXQuaW5uZXJIZWlnaHQoKS10LmhlaWdodCgpKyh0Lm91dGVySGVpZ2h0KCktdC5pbm5lckhlaWdodCgpKSksby5jc3MoXCJtYXgtaGVpZ2h0XCIsTWF0aC5yb3VuZChzKSl9fSx5PWZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKSxhPXQuZGF0YShpKSxvPWUoXCIjbUNTQl9cIithLmlkeCksbj1lKFwiI21DU0JfXCIrYS5pZHgrXCJfY29udGFpbmVyXCIpLHI9W2UoXCIjbUNTQl9cIithLmlkeCtcIl9kcmFnZ2VyX3ZlcnRpY2FsXCIpLGUoXCIjbUNTQl9cIithLmlkeCtcIl9kcmFnZ2VyX2hvcml6b250YWxcIildLGw9W28uaGVpZ2h0KCkvbi5vdXRlckhlaWdodCghMSksby53aWR0aCgpL24ub3V0ZXJXaWR0aCghMSldLHM9W3BhcnNlSW50KHJbMF0uY3NzKFwibWluLWhlaWdodFwiKSksTWF0aC5yb3VuZChsWzBdKnJbMF0ucGFyZW50KCkuaGVpZ2h0KCkpLHBhcnNlSW50KHJbMV0uY3NzKFwibWluLXdpZHRoXCIpKSxNYXRoLnJvdW5kKGxbMV0qclsxXS5wYXJlbnQoKS53aWR0aCgpKV0sYz1kJiZzWzFdPHNbMF0/c1swXTpzWzFdLHU9ZCYmc1szXTxzWzJdP3NbMl06c1szXTtyWzBdLmNzcyh7aGVpZ2h0OmMsXCJtYXgtaGVpZ2h0XCI6clswXS5wYXJlbnQoKS5oZWlnaHQoKS0xMH0pLmZpbmQoXCIubUNTQl9kcmFnZ2VyX2JhclwiKS5jc3Moe1wibGluZS1oZWlnaHRcIjpzWzBdK1wicHhcIn0pLHJbMV0uY3NzKHt3aWR0aDp1LFwibWF4LXdpZHRoXCI6clsxXS5wYXJlbnQoKS53aWR0aCgpLTEwfSl9LEI9ZnVuY3Rpb24oKXt2YXIgdD1lKHRoaXMpLGE9dC5kYXRhKGkpLG89ZShcIiNtQ1NCX1wiK2EuaWR4KSxuPWUoXCIjbUNTQl9cIithLmlkeCtcIl9jb250YWluZXJcIikscj1bZShcIiNtQ1NCX1wiK2EuaWR4K1wiX2RyYWdnZXJfdmVydGljYWxcIiksZShcIiNtQ1NCX1wiK2EuaWR4K1wiX2RyYWdnZXJfaG9yaXpvbnRhbFwiKV0sbD1bbi5vdXRlckhlaWdodCghMSktby5oZWlnaHQoKSxuLm91dGVyV2lkdGgoITEpLW8ud2lkdGgoKV0scz1bbFswXS8oclswXS5wYXJlbnQoKS5oZWlnaHQoKS1yWzBdLmhlaWdodCgpKSxsWzFdLyhyWzFdLnBhcmVudCgpLndpZHRoKCktclsxXS53aWR0aCgpKV07YS5zY3JvbGxSYXRpbz17eTpzWzBdLHg6c1sxXX19LFQ9ZnVuY3Rpb24oZSx0LGEpe3ZhciBvPWE/ZlswXStcIl9leHBhbmRlZFwiOlwiXCIsbj1lLmNsb3Nlc3QoXCIubUNTQl9zY3JvbGxUb29sc1wiKTtcImFjdGl2ZVwiPT09dD8oZS50b2dnbGVDbGFzcyhmWzBdK1wiIFwiK28pLG4udG9nZ2xlQ2xhc3MoZlsxXSksZVswXS5fZHJhZ2dhYmxlPWVbMF0uX2RyYWdnYWJsZT8wOjEpOmVbMF0uX2RyYWdnYWJsZXx8KFwiaGlkZVwiPT09dD8oZS5yZW1vdmVDbGFzcyhmWzBdKSxuLnJlbW92ZUNsYXNzKGZbMV0pKTooZS5hZGRDbGFzcyhmWzBdKSxuLmFkZENsYXNzKGZbMV0pKSl9LGs9ZnVuY3Rpb24oKXt2YXIgdD1lKHRoaXMpLGE9dC5kYXRhKGkpLG89ZShcIiNtQ1NCX1wiK2EuaWR4KSxuPWUoXCIjbUNTQl9cIithLmlkeCtcIl9jb250YWluZXJcIikscj1udWxsPT1hLm92ZXJmbG93ZWQ/bi5oZWlnaHQoKTpuLm91dGVySGVpZ2h0KCExKSxsPW51bGw9PWEub3ZlcmZsb3dlZD9uLndpZHRoKCk6bi5vdXRlcldpZHRoKCExKTtyZXR1cm5bcj5vLmhlaWdodCgpLGw+by53aWR0aCgpXX0sTT1mdW5jdGlvbigpe3ZhciB0PWUodGhpcyksYT10LmRhdGEoaSksbz1hLm9wdCxuPWUoXCIjbUNTQl9cIithLmlkeCkscj1lKFwiI21DU0JfXCIrYS5pZHgrXCJfY29udGFpbmVyXCIpLGw9W2UoXCIjbUNTQl9cIithLmlkeCtcIl9kcmFnZ2VyX3ZlcnRpY2FsXCIpLGUoXCIjbUNTQl9cIithLmlkeCtcIl9kcmFnZ2VyX2hvcml6b250YWxcIildO2lmKFEodCksKFwieFwiIT09by5heGlzJiYhYS5vdmVyZmxvd2VkWzBdfHxcInlcIj09PW8uYXhpcyYmYS5vdmVyZmxvd2VkWzBdKSYmKGxbMF0uYWRkKHIpLmNzcyhcInRvcFwiLDApLEcodCxcIl9yZXNldFlcIikpLFwieVwiIT09by5heGlzJiYhYS5vdmVyZmxvd2VkWzFdfHxcInhcIj09PW8uYXhpcyYmYS5vdmVyZmxvd2VkWzFdKXt2YXIgcz1keD0wO1wicnRsXCI9PT1hLmxhbmdEaXImJihzPW4ud2lkdGgoKS1yLm91dGVyV2lkdGgoITEpLGR4PU1hdGguYWJzKHMvYS5zY3JvbGxSYXRpby54KSksci5jc3MoXCJsZWZ0XCIscyksbFsxXS5jc3MoXCJsZWZ0XCIsZHgpLEcodCxcIl9yZXNldFhcIil9fSxPPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3I9c2V0VGltZW91dChmdW5jdGlvbigpe2UuZXZlbnQuc3BlY2lhbC5tb3VzZXdoZWVsPyhjbGVhclRpbWVvdXQociksQS5jYWxsKGFbMF0pKTp0KCl9LDEwMCl9dmFyIGE9ZSh0aGlzKSxvPWEuZGF0YShpKSxuPW8ub3B0O2lmKCFvLmJpbmRFdmVudHMpe2lmKEQuY2FsbCh0aGlzKSxuLmNvbnRlbnRUb3VjaFNjcm9sbCYmTC5jYWxsKHRoaXMpLFcuY2FsbCh0aGlzKSxuLm1vdXNlV2hlZWwuZW5hYmxlKXt2YXIgcjt0KCl9ei5jYWxsKHRoaXMpLFUuY2FsbCh0aGlzKSxuLmFkdmFuY2VkLmF1dG9TY3JvbGxPbkZvY3VzJiZILmNhbGwodGhpcyksbi5zY3JvbGxCdXR0b25zLmVuYWJsZSYmRi5jYWxsKHRoaXMpLG4ua2V5Ym9hcmQuZW5hYmxlJiZxLmNhbGwodGhpcyksby5iaW5kRXZlbnRzPSEwfX0sST1mdW5jdGlvbigpe3ZhciB0PWUodGhpcyksbz10LmRhdGEoaSksbj1vLm9wdCxyPWkrXCJfXCIrby5pZHgsbD1cIi5tQ1NCX1wiK28uaWR4K1wiX3Njcm9sbGJhclwiLHM9ZShcIiNtQ1NCX1wiK28uaWR4K1wiLCNtQ1NCX1wiK28uaWR4K1wiX2NvbnRhaW5lciwjbUNTQl9cIitvLmlkeCtcIl9jb250YWluZXJfd3JhcHBlcixcIitsK1wiIC5cIitmWzEyXStcIiwjbUNTQl9cIitvLmlkeCtcIl9kcmFnZ2VyX3ZlcnRpY2FsLCNtQ1NCX1wiK28uaWR4K1wiX2RyYWdnZXJfaG9yaXpvbnRhbCxcIitsK1wiPmFcIiksYz1lKFwiI21DU0JfXCIrby5pZHgrXCJfY29udGFpbmVyXCIpO24uYWR2YW5jZWQucmVsZWFzZURyYWdnYWJsZVNlbGVjdG9ycyYmcy5hZGQoZShuLmFkdmFuY2VkLnJlbGVhc2VEcmFnZ2FibGVTZWxlY3RvcnMpKSxvLmJpbmRFdmVudHMmJihlKGEpLnVuYmluZChcIi5cIityKSxzLmVhY2goZnVuY3Rpb24oKXtlKHRoaXMpLnVuYmluZChcIi5cIityKX0pLGNsZWFyVGltZW91dCh0WzBdLl9mb2N1c1RpbWVvdXQpLCQodFswXSxcIl9mb2N1c1RpbWVvdXRcIiksY2xlYXJUaW1lb3V0KG8uc2VxdWVudGlhbC5zdGVwKSwkKG8uc2VxdWVudGlhbCxcInN0ZXBcIiksY2xlYXJUaW1lb3V0KGNbMF0ub25Db21wbGV0ZVRpbWVvdXQpLCQoY1swXSxcIm9uQ29tcGxldGVUaW1lb3V0XCIpLG8uYmluZEV2ZW50cz0hMSl9LFI9ZnVuY3Rpb24odCl7dmFyIGE9ZSh0aGlzKSxvPWEuZGF0YShpKSxuPW8ub3B0LHI9ZShcIiNtQ1NCX1wiK28uaWR4K1wiX2NvbnRhaW5lcl93cmFwcGVyXCIpLGw9ci5sZW5ndGg/cjplKFwiI21DU0JfXCIrby5pZHgrXCJfY29udGFpbmVyXCIpLHM9W2UoXCIjbUNTQl9cIitvLmlkeCtcIl9zY3JvbGxiYXJfdmVydGljYWxcIiksZShcIiNtQ1NCX1wiK28uaWR4K1wiX3Njcm9sbGJhcl9ob3Jpem9udGFsXCIpXSxjPVtzWzBdLmZpbmQoXCIubUNTQl9kcmFnZ2VyXCIpLHNbMV0uZmluZChcIi5tQ1NCX2RyYWdnZXJcIildO1wieFwiIT09bi5heGlzJiYoby5vdmVyZmxvd2VkWzBdJiYhdD8oc1swXS5hZGQoY1swXSkuYWRkKHNbMF0uY2hpbGRyZW4oXCJhXCIpKS5jc3MoXCJkaXNwbGF5XCIsXCJibG9ja1wiKSxsLnJlbW92ZUNsYXNzKGZbOF0rXCIgXCIrZlsxMF0pKToobi5hbHdheXNTaG93U2Nyb2xsYmFyPygyIT09bi5hbHdheXNTaG93U2Nyb2xsYmFyJiZjWzBdLmNzcyhcImRpc3BsYXlcIixcIm5vbmVcIiksbC5yZW1vdmVDbGFzcyhmWzEwXSkpOihzWzBdLmNzcyhcImRpc3BsYXlcIixcIm5vbmVcIiksbC5hZGRDbGFzcyhmWzEwXSkpLGwuYWRkQ2xhc3MoZls4XSkpKSxcInlcIiE9PW4uYXhpcyYmKG8ub3ZlcmZsb3dlZFsxXSYmIXQ/KHNbMV0uYWRkKGNbMV0pLmFkZChzWzFdLmNoaWxkcmVuKFwiYVwiKSkuY3NzKFwiZGlzcGxheVwiLFwiYmxvY2tcIiksbC5yZW1vdmVDbGFzcyhmWzldK1wiIFwiK2ZbMTFdKSk6KG4uYWx3YXlzU2hvd1Njcm9sbGJhcj8oMiE9PW4uYWx3YXlzU2hvd1Njcm9sbGJhciYmY1sxXS5jc3MoXCJkaXNwbGF5XCIsXCJub25lXCIpLGwucmVtb3ZlQ2xhc3MoZlsxMV0pKTooc1sxXS5jc3MoXCJkaXNwbGF5XCIsXCJub25lXCIpLGwuYWRkQ2xhc3MoZlsxMV0pKSxsLmFkZENsYXNzKGZbOV0pKSksby5vdmVyZmxvd2VkWzBdfHxvLm92ZXJmbG93ZWRbMV0/YS5yZW1vdmVDbGFzcyhmWzVdKTphLmFkZENsYXNzKGZbNV0pfSxFPWZ1bmN0aW9uKGUpe3ZhciB0PWUudHlwZTtzd2l0Y2godCl7Y2FzZVwicG9pbnRlcmRvd25cIjpjYXNlXCJNU1BvaW50ZXJEb3duXCI6Y2FzZVwicG9pbnRlcm1vdmVcIjpjYXNlXCJNU1BvaW50ZXJNb3ZlXCI6Y2FzZVwicG9pbnRlcnVwXCI6Y2FzZVwiTVNQb2ludGVyVXBcIjpyZXR1cm5bZS5vcmlnaW5hbEV2ZW50LnBhZ2VZLGUub3JpZ2luYWxFdmVudC5wYWdlWCwhMV07Y2FzZVwidG91Y2hzdGFydFwiOmNhc2VcInRvdWNobW92ZVwiOmNhc2VcInRvdWNoZW5kXCI6dmFyIGE9ZS5vcmlnaW5hbEV2ZW50LnRvdWNoZXNbMF18fGUub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlc1swXSxvPWUub3JpZ2luYWxFdmVudC50b3VjaGVzLmxlbmd0aHx8ZS5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzLmxlbmd0aDtyZXR1cm5bYS5wYWdlWSxhLnBhZ2VYLG8+MV07ZGVmYXVsdDpyZXR1cm5bZS5wYWdlWSxlLnBhZ2VYLCExXX19LEQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUpe3ZhciB0PXAuZmluZChcImlmcmFtZVwiKTtpZih0Lmxlbmd0aCl7dmFyIGE9ZT9cImF1dG9cIjpcIm5vbmVcIjt0LmNzcyhcInBvaW50ZXItZXZlbnRzXCIsYSl9fWZ1bmN0aW9uIG8oZSx0LGEsbyl7aWYocFswXS5pZGxlVGltZXI9Zi5zY3JvbGxJbmVydGlhPDIzMz8yNTA6MCxuLmF0dHIoXCJpZFwiKT09PW1bMV0pdmFyIGk9XCJ4XCIscj0oblswXS5vZmZzZXRMZWZ0LXQrbykqYy5zY3JvbGxSYXRpby54O2Vsc2UgdmFyIGk9XCJ5XCIscj0oblswXS5vZmZzZXRUb3AtZSthKSpjLnNjcm9sbFJhdGlvLnk7RyhzLHIudG9TdHJpbmcoKSx7ZGlyOmksZHJhZzohMH0pfXZhciBuLHIsbCxzPWUodGhpcyksYz1zLmRhdGEoaSksZj1jLm9wdCxoPWkrXCJfXCIrYy5pZHgsbT1bXCJtQ1NCX1wiK2MuaWR4K1wiX2RyYWdnZXJfdmVydGljYWxcIixcIm1DU0JfXCIrYy5pZHgrXCJfZHJhZ2dlcl9ob3Jpem9udGFsXCJdLHA9ZShcIiNtQ1NCX1wiK2MuaWR4K1wiX2NvbnRhaW5lclwiKSxnPWUoXCIjXCIrbVswXStcIiwjXCIrbVsxXSksdj1mLmFkdmFuY2VkLnJlbGVhc2VEcmFnZ2FibGVTZWxlY3RvcnM/Zy5hZGQoZShmLmFkdmFuY2VkLnJlbGVhc2VEcmFnZ2FibGVTZWxlY3RvcnMpKTpnO2cuYmluZChcIm1vdXNlZG93bi5cIitoK1wiIHRvdWNoc3RhcnQuXCIraCtcIiBwb2ludGVyZG93bi5cIitoK1wiIE1TUG9pbnRlckRvd24uXCIraCxmdW5jdGlvbihvKXtpZihvLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLG8ucHJldmVudERlZmF1bHQoKSxldChvKSl7dT0hMCxkJiYoYS5vbnNlbGVjdHN0YXJ0PWZ1bmN0aW9uKCl7cmV0dXJuITF9KSx0KCExKSxRKHMpLG49ZSh0aGlzKTt2YXIgaT1uLm9mZnNldCgpLGM9RShvKVswXS1pLnRvcCxoPUUobylbMV0taS5sZWZ0LG09bi5oZWlnaHQoKStpLnRvcCxwPW4ud2lkdGgoKStpLmxlZnQ7bT5jJiZjPjAmJnA+aCYmaD4wJiYocj1jLGw9aCksVChuLFwiYWN0aXZlXCIsZi5hdXRvRXhwYW5kU2Nyb2xsYmFyKX19KS5iaW5kKFwidG91Y2htb3ZlLlwiK2gsZnVuY3Rpb24oZSl7ZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSxlLnByZXZlbnREZWZhdWx0KCk7dmFyIHQ9bi5vZmZzZXQoKSxhPUUoZSlbMF0tdC50b3AsaT1FKGUpWzFdLXQubGVmdDtvKHIsbCxhLGkpfSksZShhKS5iaW5kKFwibW91c2Vtb3ZlLlwiK2grXCIgcG9pbnRlcm1vdmUuXCIraCtcIiBNU1BvaW50ZXJNb3ZlLlwiK2gsZnVuY3Rpb24oZSl7aWYobil7dmFyIHQ9bi5vZmZzZXQoKSxhPUUoZSlbMF0tdC50b3AsaT1FKGUpWzFdLXQubGVmdDtpZihyPT09YSlyZXR1cm47byhyLGwsYSxpKX19KS5hZGQodikuYmluZChcIm1vdXNldXAuXCIraCtcIiB0b3VjaGVuZC5cIitoK1wiIHBvaW50ZXJ1cC5cIitoK1wiIE1TUG9pbnRlclVwLlwiK2gsZnVuY3Rpb24oKXtuJiYoVChuLFwiYWN0aXZlXCIsZi5hdXRvRXhwYW5kU2Nyb2xsYmFyKSxuPW51bGwpLHU9ITEsZCYmKGEub25zZWxlY3RzdGFydD1udWxsKSx0KCEwKX0pfSxMPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChlLHQpe3ZhciBhPVsxLjUqdCwyKnQsdC8xLjUsdC8yXTtyZXR1cm4gZT45MD90PjQ/YVswXTphWzNdOmU+NjA/dD4zP2FbM106YVsyXTplPjMwP3Q+OD9hWzFdOnQ+Nj9hWzBdOnQ+ND90OmFbMl06dD44P3Q6YVszXX1mdW5jdGlvbiBhKGUsdCxhLG8sbixpKXtlJiZHKF8sZS50b1N0cmluZygpLHtkdXI6dCxzY3JvbGxFYXNpbmc6YSxkaXI6byxvdmVyd3JpdGU6bixkcmFnOml9KX12YXIgbixyLGwscyxjLGQsZixoLG0scCxnLHYseCxfPWUodGhpcyksUz1fLmRhdGEoaSksdz1TLm9wdCxiPWkrXCJfXCIrUy5pZHgsQz1lKFwiI21DU0JfXCIrUy5pZHgpLHk9ZShcIiNtQ1NCX1wiK1MuaWR4K1wiX2NvbnRhaW5lclwiKSxCPVtlKFwiI21DU0JfXCIrUy5pZHgrXCJfZHJhZ2dlcl92ZXJ0aWNhbFwiKSxlKFwiI21DU0JfXCIrUy5pZHgrXCJfZHJhZ2dlcl9ob3Jpem9udGFsXCIpXSxUPVtdLGs9W10sTT0wLE89XCJ5eFwiPT09dy5heGlzP1wibm9uZVwiOlwiYWxsXCIsST1bXTt5LmJpbmQoXCJ0b3VjaHN0YXJ0LlwiK2IrXCIgcG9pbnRlcmRvd24uXCIrYitcIiBNU1BvaW50ZXJEb3duLlwiK2IsZnVuY3Rpb24oZSl7aWYoIXR0KGUpfHx1fHxFKGUpWzJdKXJldHVybiB2b2lkKG89MCk7bz0xLHY9MCx4PTA7dmFyIHQ9eS5vZmZzZXQoKTtuPUUoZSlbMF0tdC50b3Ascj1FKGUpWzFdLXQubGVmdCxJPVtFKGUpWzBdLEUoZSlbMV1dfSkuYmluZChcInRvdWNobW92ZS5cIitiK1wiIHBvaW50ZXJtb3ZlLlwiK2IrXCIgTVNQb2ludGVyTW92ZS5cIitiLGZ1bmN0aW9uKGUpe2lmKHR0KGUpJiYhdSYmIUUoZSlbMl0mJihlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLCF4fHx2KSl7ZD1LKCk7dmFyIHQ9Qy5vZmZzZXQoKSxvPUUoZSlbMF0tdC50b3AsaT1FKGUpWzFdLXQubGVmdCxsPVwibWNzTGluZWFyT3V0XCI7aWYoVC5wdXNoKG8pLGsucHVzaChpKSxJWzJdPU1hdGguYWJzKEUoZSlbMF0tSVswXSksSVszXT1NYXRoLmFicyhFKGUpWzFdLUlbMV0pLFMub3ZlcmZsb3dlZFswXSl2YXIgcz1CWzBdLnBhcmVudCgpLmhlaWdodCgpLUJbMF0uaGVpZ2h0KCksYz1uLW8+MCYmby1uPi0ocypTLnNjcm9sbFJhdGlvLnkpJiYoMipJWzNdPElbMl18fFwieXhcIj09PXcuYXhpcyk7aWYoUy5vdmVyZmxvd2VkWzFdKXZhciBmPUJbMV0ucGFyZW50KCkud2lkdGgoKS1CWzFdLndpZHRoKCksaD1yLWk+MCYmaS1yPi0oZipTLnNjcm9sbFJhdGlvLngpJiYoMipJWzJdPElbM118fFwieXhcIj09PXcuYXhpcyk7Y3x8aD8oZS5wcmV2ZW50RGVmYXVsdCgpLHY9MSk6eD0xLHA9XCJ5eFwiPT09dy5heGlzP1tuLW8sci1pXTpcInhcIj09PXcuYXhpcz9bbnVsbCxyLWldOltuLW8sbnVsbF0seVswXS5pZGxlVGltZXI9MjUwLFMub3ZlcmZsb3dlZFswXSYmYShwWzBdLE0sbCxcInlcIixcImFsbFwiLCEwKSxTLm92ZXJmbG93ZWRbMV0mJmEocFsxXSxNLGwsXCJ4XCIsTywhMCl9fSksQy5iaW5kKFwidG91Y2hzdGFydC5cIitiK1wiIHBvaW50ZXJkb3duLlwiK2IrXCIgTVNQb2ludGVyRG93bi5cIitiLGZ1bmN0aW9uKGUpe2lmKCF0dChlKXx8dXx8RShlKVsyXSlyZXR1cm4gdm9pZChvPTApO289MSxlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLFEoXyksYz1LKCk7dmFyIHQ9Qy5vZmZzZXQoKTtsPUUoZSlbMF0tdC50b3Ascz1FKGUpWzFdLXQubGVmdCxUPVtdLGs9W119KS5iaW5kKFwidG91Y2hlbmQuXCIrYitcIiBwb2ludGVydXAuXCIrYitcIiBNU1BvaW50ZXJVcC5cIitiLGZ1bmN0aW9uKGUpe2lmKHR0KGUpJiYhdSYmIUUoZSlbMl0pe2Uuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksdj0wLHg9MCxmPUsoKTt2YXIgbz1DLm9mZnNldCgpLG49RShlKVswXS1vLnRvcCxpPUUoZSlbMV0tby5sZWZ0O2lmKCEoZi1kPjMwKSl7bT0xZTMvKGYtYyk7dmFyIHI9XCJtY3NFYXNlT3V0XCIsXz0yLjU+bSxiPV8/W1RbVC5sZW5ndGgtMl0sa1trLmxlbmd0aC0yXV06WzAsMF07aD1fP1tuLWJbMF0saS1iWzFdXTpbbi1sLGktc107dmFyIEI9W01hdGguYWJzKGhbMF0pLE1hdGguYWJzKGhbMV0pXTttPV8/W01hdGguYWJzKGhbMF0vNCksTWF0aC5hYnMoaFsxXS80KV06W20sbV07dmFyIE09W01hdGguYWJzKHlbMF0ub2Zmc2V0VG9wKS1oWzBdKnQoQlswXS9tWzBdLG1bMF0pLE1hdGguYWJzKHlbMF0ub2Zmc2V0TGVmdCktaFsxXSp0KEJbMV0vbVsxXSxtWzFdKV07cD1cInl4XCI9PT13LmF4aXM/W01bMF0sTVsxXV06XCJ4XCI9PT13LmF4aXM/W251bGwsTVsxXV06W01bMF0sbnVsbF0sZz1bNCpCWzBdK3cuc2Nyb2xsSW5lcnRpYSw0KkJbMV0rdy5zY3JvbGxJbmVydGlhXTt2YXIgST1wYXJzZUludCh3LmNvbnRlbnRUb3VjaFNjcm9sbCl8fDA7cFswXT1CWzBdPkk/cFswXTowLHBbMV09QlsxXT5JP3BbMV06MCxTLm92ZXJmbG93ZWRbMF0mJmEocFswXSxnWzBdLHIsXCJ5XCIsTywhMSksUy5vdmVyZmxvd2VkWzFdJiZhKHBbMV0sZ1sxXSxyLFwieFwiLE8sITEpfX19KX0sVz1mdW5jdGlvbigpe2Z1bmN0aW9uIG4oKXtyZXR1cm4gdC5nZXRTZWxlY3Rpb24/dC5nZXRTZWxlY3Rpb24oKS50b1N0cmluZygpOmEuc2VsZWN0aW9uJiZcIkNvbnRyb2xcIiE9YS5zZWxlY3Rpb24udHlwZT9hLnNlbGVjdGlvbi5jcmVhdGVSYW5nZSgpLnRleHQ6MH1mdW5jdGlvbiByKGUsdCxhKXtmLnR5cGU9YSYmbD9cInN0ZXBwZWRcIjpcInN0ZXBsZXNzXCIsZi5zY3JvbGxBbW91bnQ9MTAsaihzLGUsdCxcIm1jc0xpbmVhck91dFwiLGE/NjA6bnVsbCl9dmFyIGwscz1lKHRoaXMpLGM9cy5kYXRhKGkpLGQ9Yy5vcHQsZj1jLnNlcXVlbnRpYWwsaD1pK1wiX1wiK2MuaWR4LG09ZShcIiNtQ1NCX1wiK2MuaWR4K1wiX2NvbnRhaW5lclwiKSxwPW0ucGFyZW50KCk7bS5iaW5kKFwibW91c2Vkb3duLlwiK2gsZnVuY3Rpb24oKXtvfHxsfHwobD0xLHU9ITApfSkuYWRkKGEpLmJpbmQoXCJtb3VzZW1vdmUuXCIraCxmdW5jdGlvbihlKXtpZighbyYmbCYmbigpKXt2YXIgdD1tLm9mZnNldCgpLGE9RShlKVswXS10LnRvcCttWzBdLm9mZnNldFRvcCxpPUUoZSlbMV0tdC5sZWZ0K21bMF0ub2Zmc2V0TGVmdDthPjAmJmE8cC5oZWlnaHQoKSYmaT4wJiZpPHAud2lkdGgoKT9mLnN0ZXAmJnIoXCJvZmZcIixudWxsLFwic3RlcHBlZFwiKTooXCJ4XCIhPT1kLmF4aXMmJmMub3ZlcmZsb3dlZFswXSYmKDA+YT9yKFwib25cIiwzOCk6YT5wLmhlaWdodCgpJiZyKFwib25cIiw0MCkpLFwieVwiIT09ZC5heGlzJiZjLm92ZXJmbG93ZWRbMV0mJigwPmk/cihcIm9uXCIsMzcpOmk+cC53aWR0aCgpJiZyKFwib25cIiwzOSkpKX19KS5iaW5kKFwibW91c2V1cC5cIitoLGZ1bmN0aW9uKCl7b3x8KGwmJihsPTAscihcIm9mZlwiLG51bGwpKSx1PSExKX0pfSxBPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChlKXt2YXIgdD1udWxsO3RyeXt2YXIgYT1lLmNvbnRlbnREb2N1bWVudHx8ZS5jb250ZW50V2luZG93LmRvY3VtZW50O3Q9YS5ib2R5LmlubmVySFRNTH1jYXRjaChvKXt9cmV0dXJuIG51bGwhPT10fXZhciBhPWUodGhpcyksbz1hLmRhdGEoaSk7aWYobyl7dmFyIG49by5vcHQscj1pK1wiX1wiK28uaWR4LGw9ZShcIiNtQ1NCX1wiK28uaWR4KSxzPVtlKFwiI21DU0JfXCIrby5pZHgrXCJfZHJhZ2dlcl92ZXJ0aWNhbFwiKSxlKFwiI21DU0JfXCIrby5pZHgrXCJfZHJhZ2dlcl9ob3Jpem9udGFsXCIpXSxjPWUoXCIjbUNTQl9cIitvLmlkeCtcIl9jb250YWluZXJcIikuZmluZChcImlmcmFtZVwiKSx1PWw7Yy5sZW5ndGgmJmMuZWFjaChmdW5jdGlvbigpe3ZhciBhPXRoaXM7dChhKSYmKHU9dS5hZGQoZShhKS5jb250ZW50cygpLmZpbmQoXCJib2R5XCIpKSl9KSx1LmJpbmQoXCJtb3VzZXdoZWVsLlwiK3IsZnVuY3Rpb24odCxpKXtpZihRKGEpLCFQKGEsdC50YXJnZXQpKXt2YXIgcj1cImF1dG9cIiE9PW4ubW91c2VXaGVlbC5kZWx0YUZhY3Rvcj9wYXJzZUludChuLm1vdXNlV2hlZWwuZGVsdGFGYWN0b3IpOmQmJnQuZGVsdGFGYWN0b3I8MTAwPzEwMDp0LmRlbHRhRmFjdG9yfHwxMDA7aWYoXCJ4XCI9PT1uLmF4aXN8fFwieFwiPT09bi5tb3VzZVdoZWVsLmF4aXMpdmFyIGM9XCJ4XCIsdT1bTWF0aC5yb3VuZChyKm8uc2Nyb2xsUmF0aW8ueCkscGFyc2VJbnQobi5tb3VzZVdoZWVsLnNjcm9sbEFtb3VudCldLGY9XCJhdXRvXCIhPT1uLm1vdXNlV2hlZWwuc2Nyb2xsQW1vdW50P3VbMV06dVswXT49bC53aWR0aCgpPy45Kmwud2lkdGgoKTp1WzBdLGg9TWF0aC5hYnMoZShcIiNtQ1NCX1wiK28uaWR4K1wiX2NvbnRhaW5lclwiKVswXS5vZmZzZXRMZWZ0KSxtPXNbMV1bMF0ub2Zmc2V0TGVmdCxwPXNbMV0ucGFyZW50KCkud2lkdGgoKS1zWzFdLndpZHRoKCksZz10LmRlbHRhWHx8dC5kZWx0YVl8fGk7ZWxzZSB2YXIgYz1cInlcIix1PVtNYXRoLnJvdW5kKHIqby5zY3JvbGxSYXRpby55KSxwYXJzZUludChuLm1vdXNlV2hlZWwuc2Nyb2xsQW1vdW50KV0sZj1cImF1dG9cIiE9PW4ubW91c2VXaGVlbC5zY3JvbGxBbW91bnQ/dVsxXTp1WzBdPj1sLmhlaWdodCgpPy45KmwuaGVpZ2h0KCk6dVswXSxoPU1hdGguYWJzKGUoXCIjbUNTQl9cIitvLmlkeCtcIl9jb250YWluZXJcIilbMF0ub2Zmc2V0VG9wKSxtPXNbMF1bMF0ub2Zmc2V0VG9wLHA9c1swXS5wYXJlbnQoKS5oZWlnaHQoKS1zWzBdLmhlaWdodCgpLGc9dC5kZWx0YVl8fGk7XCJ5XCI9PT1jJiYhby5vdmVyZmxvd2VkWzBdfHxcInhcIj09PWMmJiFvLm92ZXJmbG93ZWRbMV18fChuLm1vdXNlV2hlZWwuaW52ZXJ0JiYoZz0tZyksbi5tb3VzZVdoZWVsLm5vcm1hbGl6ZURlbHRhJiYoZz0wPmc/LTE6MSksKGc+MCYmMCE9PW18fDA+ZyYmbSE9PXB8fG4ubW91c2VXaGVlbC5wcmV2ZW50RGVmYXVsdCkmJih0LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLHQucHJldmVudERlZmF1bHQoKSksRyhhLChoLWcqZikudG9TdHJpbmcoKSx7ZGlyOmN9KSl9fSl9fSxQPWZ1bmN0aW9uKHQsYSl7dmFyIG89YS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpLG49dC5kYXRhKGkpLm9wdC5tb3VzZVdoZWVsLmRpc2FibGVPdmVyLHI9W1wic2VsZWN0XCIsXCJ0ZXh0YXJlYVwiXTtyZXR1cm4gZS5pbkFycmF5KG8sbik+LTEmJiEoZS5pbkFycmF5KG8scik+LTEmJiFlKGEpLmlzKFwiOmZvY3VzXCIpKX0sej1mdW5jdGlvbigpe3ZhciB0PWUodGhpcyksYT10LmRhdGEoaSksbz1pK1wiX1wiK2EuaWR4LG49ZShcIiNtQ1NCX1wiK2EuaWR4K1wiX2NvbnRhaW5lclwiKSxyPW4ucGFyZW50KCksbD1lKFwiLm1DU0JfXCIrYS5pZHgrXCJfc2Nyb2xsYmFyIC5cIitmWzEyXSk7bC5iaW5kKFwidG91Y2hzdGFydC5cIitvK1wiIHBvaW50ZXJkb3duLlwiK28rXCIgTVNQb2ludGVyRG93bi5cIitvLGZ1bmN0aW9uKCl7dT0hMH0pLmJpbmQoXCJ0b3VjaGVuZC5cIitvK1wiIHBvaW50ZXJ1cC5cIitvK1wiIE1TUG9pbnRlclVwLlwiK28sZnVuY3Rpb24oKXt1PSExfSkuYmluZChcImNsaWNrLlwiK28sZnVuY3Rpb24obyl7aWYoZShvLnRhcmdldCkuaGFzQ2xhc3MoZlsxMl0pfHxlKG8udGFyZ2V0KS5oYXNDbGFzcyhcIm1DU0JfZHJhZ2dlclJhaWxcIikpe1EodCk7dmFyIGk9ZSh0aGlzKSxsPWkuZmluZChcIi5tQ1NCX2RyYWdnZXJcIik7aWYoaS5wYXJlbnQoXCIubUNTQl9zY3JvbGxUb29sc19ob3Jpem9udGFsXCIpLmxlbmd0aD4wKXtpZighYS5vdmVyZmxvd2VkWzFdKXJldHVybjt2YXIgcz1cInhcIixjPW8ucGFnZVg+bC5vZmZzZXQoKS5sZWZ0Py0xOjEsZD1NYXRoLmFicyhuWzBdLm9mZnNldExlZnQpLS45KmMqci53aWR0aCgpfWVsc2V7aWYoIWEub3ZlcmZsb3dlZFswXSlyZXR1cm47dmFyIHM9XCJ5XCIsYz1vLnBhZ2VZPmwub2Zmc2V0KCkudG9wPy0xOjEsZD1NYXRoLmFicyhuWzBdLm9mZnNldFRvcCktLjkqYypyLmhlaWdodCgpfUcodCxkLnRvU3RyaW5nKCkse2RpcjpzLHNjcm9sbEVhc2luZzpcIm1jc0Vhc2VJbk91dFwifSl9fSl9LEg9ZnVuY3Rpb24oKXt2YXIgdD1lKHRoaXMpLG89dC5kYXRhKGkpLG49by5vcHQscj1pK1wiX1wiK28uaWR4LGw9ZShcIiNtQ1NCX1wiK28uaWR4K1wiX2NvbnRhaW5lclwiKSxzPWwucGFyZW50KCk7bC5iaW5kKFwiZm9jdXNpbi5cIityLGZ1bmN0aW9uKCl7dmFyIG89ZShhLmFjdGl2ZUVsZW1lbnQpLGk9bC5maW5kKFwiLm1DdXN0b21TY3JvbGxCb3hcIikubGVuZ3RoLHI9MDtvLmlzKG4uYWR2YW5jZWQuYXV0b1Njcm9sbE9uRm9jdXMpJiYoUSh0KSxjbGVhclRpbWVvdXQodFswXS5fZm9jdXNUaW1lb3V0KSx0WzBdLl9mb2N1c1RpbWVyPWk/KHIrMTcpKmk6MCx0WzBdLl9mb2N1c1RpbWVvdXQ9c2V0VGltZW91dChmdW5jdGlvbigpe3ZhciBlPVtvdChvKVswXSxvdChvKVsxXV0sYT1bbFswXS5vZmZzZXRUb3AsbFswXS5vZmZzZXRMZWZ0XSxpPVthWzBdK2VbMF0+PTAmJmFbMF0rZVswXTxzLmhlaWdodCgpLW8ub3V0ZXJIZWlnaHQoITEpLGFbMV0rZVsxXT49MCYmYVswXStlWzFdPHMud2lkdGgoKS1vLm91dGVyV2lkdGgoITEpXSxjPVwieXhcIiE9PW4uYXhpc3x8aVswXXx8aVsxXT9cImFsbFwiOlwibm9uZVwiO1wieFwiPT09bi5heGlzfHxpWzBdfHxHKHQsZVswXS50b1N0cmluZygpLHtkaXI6XCJ5XCIsc2Nyb2xsRWFzaW5nOlwibWNzRWFzZUluT3V0XCIsb3ZlcndyaXRlOmMsZHVyOnJ9KSxcInlcIj09PW4uYXhpc3x8aVsxXXx8Ryh0LGVbMV0udG9TdHJpbmcoKSx7ZGlyOlwieFwiLHNjcm9sbEVhc2luZzpcIm1jc0Vhc2VJbk91dFwiLG92ZXJ3cml0ZTpjLGR1cjpyfSl9LHRbMF0uX2ZvY3VzVGltZXIpKX0pfSxVPWZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKSxhPXQuZGF0YShpKSxvPWkrXCJfXCIrYS5pZHgsbj1lKFwiI21DU0JfXCIrYS5pZHgrXCJfY29udGFpbmVyXCIpLnBhcmVudCgpO24uYmluZChcInNjcm9sbC5cIitvLGZ1bmN0aW9uKCl7KDAhPT1uLnNjcm9sbFRvcCgpfHwwIT09bi5zY3JvbGxMZWZ0KCkpJiZlKFwiLm1DU0JfXCIrYS5pZHgrXCJfc2Nyb2xsYmFyXCIpLmNzcyhcInZpc2liaWxpdHlcIixcImhpZGRlblwiKX0pfSxGPWZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKSxhPXQuZGF0YShpKSxvPWEub3B0LG49YS5zZXF1ZW50aWFsLHI9aStcIl9cIithLmlkeCxsPVwiLm1DU0JfXCIrYS5pZHgrXCJfc2Nyb2xsYmFyXCIscz1lKGwrXCI+YVwiKTtzLmJpbmQoXCJtb3VzZWRvd24uXCIrcitcIiB0b3VjaHN0YXJ0LlwiK3IrXCIgcG9pbnRlcmRvd24uXCIrcitcIiBNU1BvaW50ZXJEb3duLlwiK3IrXCIgbW91c2V1cC5cIityK1wiIHRvdWNoZW5kLlwiK3IrXCIgcG9pbnRlcnVwLlwiK3IrXCIgTVNQb2ludGVyVXAuXCIrcitcIiBtb3VzZW91dC5cIityK1wiIHBvaW50ZXJvdXQuXCIrcitcIiBNU1BvaW50ZXJPdXQuXCIrcitcIiBjbGljay5cIityLGZ1bmN0aW9uKGkpe2Z1bmN0aW9uIHIoZSxhKXtuLnNjcm9sbEFtb3VudD1vLnNuYXBBbW91bnR8fG8uc2Nyb2xsQnV0dG9ucy5zY3JvbGxBbW91bnQsaih0LGUsYSl9aWYoaS5wcmV2ZW50RGVmYXVsdCgpLGV0KGkpKXt2YXIgbD1lKHRoaXMpLmF0dHIoXCJjbGFzc1wiKTtzd2l0Y2gobi50eXBlPW8uc2Nyb2xsQnV0dG9ucy5zY3JvbGxUeXBlLGkudHlwZSl7Y2FzZVwibW91c2Vkb3duXCI6Y2FzZVwidG91Y2hzdGFydFwiOmNhc2VcInBvaW50ZXJkb3duXCI6Y2FzZVwiTVNQb2ludGVyRG93blwiOmlmKFwic3RlcHBlZFwiPT09bi50eXBlKXJldHVybjt1PSEwLGEudHdlZW5SdW5uaW5nPSExLHIoXCJvblwiLGwpO2JyZWFrO2Nhc2VcIm1vdXNldXBcIjpjYXNlXCJ0b3VjaGVuZFwiOmNhc2VcInBvaW50ZXJ1cFwiOmNhc2VcIk1TUG9pbnRlclVwXCI6Y2FzZVwibW91c2VvdXRcIjpjYXNlXCJwb2ludGVyb3V0XCI6Y2FzZVwiTVNQb2ludGVyT3V0XCI6aWYoXCJzdGVwcGVkXCI9PT1uLnR5cGUpcmV0dXJuO3U9ITEsbi5kaXImJnIoXCJvZmZcIixsKTticmVhaztjYXNlXCJjbGlja1wiOmlmKFwic3RlcHBlZFwiIT09bi50eXBlfHxhLnR3ZWVuUnVubmluZylyZXR1cm47cihcIm9uXCIsbCl9fX0pfSxxPWZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKSxvPXQuZGF0YShpKSxuPW8ub3B0LHI9by5zZXF1ZW50aWFsLGw9aStcIl9cIitvLmlkeCxzPWUoXCIjbUNTQl9cIitvLmlkeCksYz1lKFwiI21DU0JfXCIrby5pZHgrXCJfY29udGFpbmVyXCIpLGQ9Yy5wYXJlbnQoKSx1PVwiaW5wdXQsdGV4dGFyZWEsc2VsZWN0LGRhdGFsaXN0LGtleWdlbixbY29udGVudGVkaXRhYmxlPSd0cnVlJ11cIjtzLmF0dHIoXCJ0YWJpbmRleFwiLFwiMFwiKS5iaW5kKFwiYmx1ci5cIitsK1wiIGtleWRvd24uXCIrbCtcIiBrZXl1cC5cIitsLGZ1bmN0aW9uKGkpe2Z1bmN0aW9uIGwoZSxhKXtyLnR5cGU9bi5rZXlib2FyZC5zY3JvbGxUeXBlLHIuc2Nyb2xsQW1vdW50PW4uc25hcEFtb3VudHx8bi5rZXlib2FyZC5zY3JvbGxBbW91bnQsXCJzdGVwcGVkXCI9PT1yLnR5cGUmJm8udHdlZW5SdW5uaW5nfHxqKHQsZSxhKX1zd2l0Y2goaS50eXBlKXtjYXNlXCJibHVyXCI6by50d2VlblJ1bm5pbmcmJnIuZGlyJiZsKFwib2ZmXCIsbnVsbCk7YnJlYWs7Y2FzZVwia2V5ZG93blwiOmNhc2VcImtleXVwXCI6dmFyIHM9aS5rZXlDb2RlP2kua2V5Q29kZTppLndoaWNoLGY9XCJvblwiO2lmKFwieFwiIT09bi5heGlzJiYoMzg9PT1zfHw0MD09PXMpfHxcInlcIiE9PW4uYXhpcyYmKDM3PT09c3x8Mzk9PT1zKSl7aWYoKDM4PT09c3x8NDA9PT1zKSYmIW8ub3ZlcmZsb3dlZFswXXx8KDM3PT09c3x8Mzk9PT1zKSYmIW8ub3ZlcmZsb3dlZFsxXSlyZXR1cm47XCJrZXl1cFwiPT09aS50eXBlJiYoZj1cIm9mZlwiKSxlKGEuYWN0aXZlRWxlbWVudCkuaXModSl8fChpLnByZXZlbnREZWZhdWx0KCksaS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSxsKGYscykpfWVsc2UgaWYoMzM9PT1zfHwzND09PXMpe2lmKChvLm92ZXJmbG93ZWRbMF18fG8ub3ZlcmZsb3dlZFsxXSkmJihpLnByZXZlbnREZWZhdWx0KCksaS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSksXCJrZXl1cFwiPT09aS50eXBlKXtRKHQpO3ZhciBoPTM0PT09cz8tMToxO2lmKFwieFwiPT09bi5heGlzfHxcInl4XCI9PT1uLmF4aXMmJm8ub3ZlcmZsb3dlZFsxXSYmIW8ub3ZlcmZsb3dlZFswXSl2YXIgbT1cInhcIixwPU1hdGguYWJzKGNbMF0ub2Zmc2V0TGVmdCktLjkqaCpkLndpZHRoKCk7ZWxzZSB2YXIgbT1cInlcIixwPU1hdGguYWJzKGNbMF0ub2Zmc2V0VG9wKS0uOSpoKmQuaGVpZ2h0KCk7Ryh0LHAudG9TdHJpbmcoKSx7ZGlyOm0sc2Nyb2xsRWFzaW5nOlwibWNzRWFzZUluT3V0XCJ9KX19ZWxzZSBpZigoMzU9PT1zfHwzNj09PXMpJiYhZShhLmFjdGl2ZUVsZW1lbnQpLmlzKHUpJiYoKG8ub3ZlcmZsb3dlZFswXXx8by5vdmVyZmxvd2VkWzFdKSYmKGkucHJldmVudERlZmF1bHQoKSxpLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpKSxcImtleXVwXCI9PT1pLnR5cGUpKXtpZihcInhcIj09PW4uYXhpc3x8XCJ5eFwiPT09bi5heGlzJiZvLm92ZXJmbG93ZWRbMV0mJiFvLm92ZXJmbG93ZWRbMF0pdmFyIG09XCJ4XCIscD0zNT09PXM/TWF0aC5hYnMoZC53aWR0aCgpLWMub3V0ZXJXaWR0aCghMSkpOjA7ZWxzZSB2YXIgbT1cInlcIixwPTM1PT09cz9NYXRoLmFicyhkLmhlaWdodCgpLWMub3V0ZXJIZWlnaHQoITEpKTowO0codCxwLnRvU3RyaW5nKCkse2RpcjptLHNjcm9sbEVhc2luZzpcIm1jc0Vhc2VJbk91dFwifSl9fX0pfSxqPWZ1bmN0aW9uKHQsYSxvLG4scil7ZnVuY3Rpb24gbChlKXt2YXIgYT1cInN0ZXBwZWRcIiE9PXUudHlwZSxvPXI/cjplP2E/cC8xLjU6ZzoxZTMvNjAsaT1lP2E/Ny41OjQwOjIuNSxzPVtNYXRoLmFicyhoWzBdLm9mZnNldFRvcCksTWF0aC5hYnMoaFswXS5vZmZzZXRMZWZ0KV0sZD1bYy5zY3JvbGxSYXRpby55PjEwPzEwOmMuc2Nyb2xsUmF0aW8ueSxjLnNjcm9sbFJhdGlvLng+MTA/MTA6Yy5zY3JvbGxSYXRpby54XSxmPVwieFwiPT09dS5kaXJbMF0/c1sxXSt1LmRpclsxXSpkWzFdKmk6c1swXSt1LmRpclsxXSpkWzBdKmksbT1cInhcIj09PXUuZGlyWzBdP3NbMV0rdS5kaXJbMV0qcGFyc2VJbnQodS5zY3JvbGxBbW91bnQpOnNbMF0rdS5kaXJbMV0qcGFyc2VJbnQodS5zY3JvbGxBbW91bnQpLHY9XCJhdXRvXCIhPT11LnNjcm9sbEFtb3VudD9tOmYseD1uP246ZT9hP1wibWNzTGluZWFyT3V0XCI6XCJtY3NFYXNlSW5PdXRcIjpcIm1jc0xpbmVhclwiLF89ZT8hMDohMTtyZXR1cm4gZSYmMTc+byYmKHY9XCJ4XCI9PT11LmRpclswXT9zWzFdOnNbMF0pLEcodCx2LnRvU3RyaW5nKCkse2Rpcjp1LmRpclswXSxzY3JvbGxFYXNpbmc6eCxkdXI6byxvbkNvbXBsZXRlOl99KSxlP3ZvaWQodS5kaXI9ITEpOihjbGVhclRpbWVvdXQodS5zdGVwKSx2b2lkKHUuc3RlcD1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7bCgpfSxvKSkpfWZ1bmN0aW9uIHMoKXtjbGVhclRpbWVvdXQodS5zdGVwKSwkKHUsXCJzdGVwXCIpLFEodCl9dmFyIGM9dC5kYXRhKGkpLGQ9Yy5vcHQsdT1jLnNlcXVlbnRpYWwsaD1lKFwiI21DU0JfXCIrYy5pZHgrXCJfY29udGFpbmVyXCIpLG09XCJzdGVwcGVkXCI9PT11LnR5cGU/ITA6ITEscD1kLnNjcm9sbEluZXJ0aWE8MjY/MjY6ZC5zY3JvbGxJbmVydGlhLGc9ZC5zY3JvbGxJbmVydGlhPDE/MTc6ZC5zY3JvbGxJbmVydGlhO3N3aXRjaChhKXtjYXNlXCJvblwiOmlmKHUuZGlyPVtvPT09ZlsxNl18fG89PT1mWzE1XXx8Mzk9PT1vfHwzNz09PW8/XCJ4XCI6XCJ5XCIsbz09PWZbMTNdfHxvPT09ZlsxNV18fDM4PT09b3x8Mzc9PT1vPy0xOjFdLFEodCksYXQobykmJlwic3RlcHBlZFwiPT09dS50eXBlKXJldHVybjtsKG0pO2JyZWFrO2Nhc2VcIm9mZlwiOnMoKSwobXx8Yy50d2VlblJ1bm5pbmcmJnUuZGlyKSYmbCghMCl9fSxZPWZ1bmN0aW9uKHQpe3ZhciBhPWUodGhpcykuZGF0YShpKS5vcHQsbz1bXTtyZXR1cm5cImZ1bmN0aW9uXCI9PXR5cGVvZiB0JiYodD10KCkpLHQgaW5zdGFuY2VvZiBBcnJheT9vPXQubGVuZ3RoPjE/W3RbMF0sdFsxXV06XCJ4XCI9PT1hLmF4aXM/W251bGwsdFswXV06W3RbMF0sbnVsbF06KG9bMF09dC55P3QueTp0Lnh8fFwieFwiPT09YS5heGlzP251bGw6dCxvWzFdPXQueD90Lng6dC55fHxcInlcIj09PWEuYXhpcz9udWxsOnQpLFwiZnVuY3Rpb25cIj09dHlwZW9mIG9bMF0mJihvWzBdPW9bMF0oKSksXCJmdW5jdGlvblwiPT10eXBlb2Ygb1sxXSYmKG9bMV09b1sxXSgpKSxvfSxYPWZ1bmN0aW9uKHQsYSl7aWYobnVsbCE9dCYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHQpe3ZhciBvPWUodGhpcyksbj1vLmRhdGEoaSkscj1uLm9wdCxsPWUoXCIjbUNTQl9cIituLmlkeCtcIl9jb250YWluZXJcIikscz1sLnBhcmVudCgpLGM9dHlwZW9mIHQ7YXx8KGE9XCJ4XCI9PT1yLmF4aXM/XCJ4XCI6XCJ5XCIpO3ZhciBkPVwieFwiPT09YT9sLm91dGVyV2lkdGgoITEpOmwub3V0ZXJIZWlnaHQoITEpLHU9XCJ4XCI9PT1hP2xbMF0ub2Zmc2V0TGVmdDpsWzBdLm9mZnNldFRvcCxmPVwieFwiPT09YT9cImxlZnRcIjpcInRvcFwiO3N3aXRjaChjKXtjYXNlXCJmdW5jdGlvblwiOnJldHVybiB0KCk7Y2FzZVwib2JqZWN0XCI6dmFyIG09dC5qcXVlcnk/dDplKHQpO2lmKCFtLmxlbmd0aClyZXR1cm47cmV0dXJuXCJ4XCI9PT1hP290KG0pWzFdOm90KG0pWzBdO2Nhc2VcInN0cmluZ1wiOmNhc2VcIm51bWJlclwiOmlmKGF0KHQpKXJldHVybiBNYXRoLmFicyh0KTtpZigtMSE9PXQuaW5kZXhPZihcIiVcIikpcmV0dXJuIE1hdGguYWJzKGQqcGFyc2VJbnQodCkvMTAwKTtpZigtMSE9PXQuaW5kZXhPZihcIi09XCIpKXJldHVybiBNYXRoLmFicyh1LXBhcnNlSW50KHQuc3BsaXQoXCItPVwiKVsxXSkpO2lmKC0xIT09dC5pbmRleE9mKFwiKz1cIikpe3ZhciBwPXUrcGFyc2VJbnQodC5zcGxpdChcIis9XCIpWzFdKTtyZXR1cm4gcD49MD8wOk1hdGguYWJzKHApfWlmKC0xIT09dC5pbmRleE9mKFwicHhcIikmJmF0KHQuc3BsaXQoXCJweFwiKVswXSkpcmV0dXJuIE1hdGguYWJzKHQuc3BsaXQoXCJweFwiKVswXSk7aWYoXCJ0b3BcIj09PXR8fFwibGVmdFwiPT09dClyZXR1cm4gMDtpZihcImJvdHRvbVwiPT09dClyZXR1cm4gTWF0aC5hYnMocy5oZWlnaHQoKS1sLm91dGVySGVpZ2h0KCExKSk7aWYoXCJyaWdodFwiPT09dClyZXR1cm4gTWF0aC5hYnMocy53aWR0aCgpLWwub3V0ZXJXaWR0aCghMSkpO2lmKFwiZmlyc3RcIj09PXR8fFwibGFzdFwiPT09dCl7dmFyIG09bC5maW5kKFwiOlwiK3QpO3JldHVyblwieFwiPT09YT9vdChtKVsxXTpvdChtKVswXX1yZXR1cm4gZSh0KS5sZW5ndGg/XCJ4XCI9PT1hP290KGUodCkpWzFdOm90KGUodCkpWzBdOihsLmNzcyhmLHQpLHZvaWQgaC51cGRhdGUuY2FsbChudWxsLG9bMF0pKX19fSxOPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGEoKXtjbGVhclRpbWVvdXQodVswXS5hdXRvVXBkYXRlKSx1WzBdLmF1dG9VcGRhdGU9c2V0VGltZW91dChmdW5jdGlvbigpe3JldHVybiBkLmFkdmFuY2VkLnVwZGF0ZU9uU2VsZWN0b3JDaGFuZ2UmJihtPXIoKSxtIT09Uyk/KGwoMyksdm9pZChTPW0pKTooZC5hZHZhbmNlZC51cGRhdGVPbkNvbnRlbnRSZXNpemUmJihwPVt1Lm91dGVySGVpZ2h0KCExKSx1Lm91dGVyV2lkdGgoITEpLHYuaGVpZ2h0KCksdi53aWR0aCgpLF8oKVswXSxfKClbMV1dLChwWzBdIT09d1swXXx8cFsxXSE9PXdbMV18fHBbMl0hPT13WzJdfHxwWzNdIT09d1szXXx8cFs0XSE9PXdbNF18fHBbNV0hPT13WzVdKSYmKGwocFswXSE9PXdbMF18fHBbMV0hPT13WzFdKSx3PXApKSxkLmFkdmFuY2VkLnVwZGF0ZU9uSW1hZ2VMb2FkJiYoZz1vKCksZyE9PWImJih1LmZpbmQoXCJpbWdcIikuZWFjaChmdW5jdGlvbigpe24odGhpcyl9KSxiPWcpKSx2b2lkKChkLmFkdmFuY2VkLnVwZGF0ZU9uU2VsZWN0b3JDaGFuZ2V8fGQuYWR2YW5jZWQudXBkYXRlT25Db250ZW50UmVzaXplfHxkLmFkdmFuY2VkLnVwZGF0ZU9uSW1hZ2VMb2FkKSYmYSgpKSl9LDYwKX1mdW5jdGlvbiBvKCl7dmFyIGU9MDtyZXR1cm4gZC5hZHZhbmNlZC51cGRhdGVPbkltYWdlTG9hZCYmKGU9dS5maW5kKFwiaW1nXCIpLmxlbmd0aCksZX1mdW5jdGlvbiBuKHQpe2Z1bmN0aW9uIGEoZSx0KXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdC5hcHBseShlLGFyZ3VtZW50cyl9fWZ1bmN0aW9uIG8oKXt0aGlzLm9ubG9hZD1udWxsLGUodCkuYWRkQ2xhc3MoZlsyXSksbCgyKX1pZihlKHQpLmhhc0NsYXNzKGZbMl0pKXJldHVybiB2b2lkIGwoKTt2YXIgbj1uZXcgSW1hZ2U7bi5vbmxvYWQ9YShuLG8pLG4uc3JjPXQuc3JjfWZ1bmN0aW9uIHIoKXtkLmFkdmFuY2VkLnVwZGF0ZU9uU2VsZWN0b3JDaGFuZ2U9PT0hMCYmKGQuYWR2YW5jZWQudXBkYXRlT25TZWxlY3RvckNoYW5nZT1cIipcIik7dmFyIHQ9MCxhPXUuZmluZChkLmFkdmFuY2VkLnVwZGF0ZU9uU2VsZWN0b3JDaGFuZ2UpO3JldHVybiBkLmFkdmFuY2VkLnVwZGF0ZU9uU2VsZWN0b3JDaGFuZ2UmJmEubGVuZ3RoPjAmJmEuZWFjaChmdW5jdGlvbigpe3QrPWUodGhpcykuaGVpZ2h0KCkrZSh0aGlzKS53aWR0aCgpfSksdH1mdW5jdGlvbiBsKGUpe2NsZWFyVGltZW91dCh1WzBdLmF1dG9VcGRhdGUpLGgudXBkYXRlLmNhbGwobnVsbCxzWzBdLGUpfXZhciBzPWUodGhpcyksYz1zLmRhdGEoaSksZD1jLm9wdCx1PWUoXCIjbUNTQl9cIitjLmlkeCtcIl9jb250YWluZXJcIik7aWYodClyZXR1cm4gY2xlYXJUaW1lb3V0KHVbMF0uYXV0b1VwZGF0ZSksdm9pZCAkKHVbMF0sXCJhdXRvVXBkYXRlXCIpO3ZhciBtLHAsZyx2PXUucGFyZW50KCkseD1bZShcIiNtQ1NCX1wiK2MuaWR4K1wiX3Njcm9sbGJhcl92ZXJ0aWNhbFwiKSxlKFwiI21DU0JfXCIrYy5pZHgrXCJfc2Nyb2xsYmFyX2hvcml6b250YWxcIildLF89ZnVuY3Rpb24oKXtyZXR1cm5beFswXS5pcyhcIjp2aXNpYmxlXCIpP3hbMF0ub3V0ZXJIZWlnaHQoITApOjAseFsxXS5pcyhcIjp2aXNpYmxlXCIpP3hbMV0ub3V0ZXJXaWR0aCghMCk6MF19LFM9cigpLHc9W3Uub3V0ZXJIZWlnaHQoITEpLHUub3V0ZXJXaWR0aCghMSksdi5oZWlnaHQoKSx2LndpZHRoKCksXygpWzBdLF8oKVsxXV0sYj1vKCk7YSgpfSxWPWZ1bmN0aW9uKGUsdCxhKXtyZXR1cm4gTWF0aC5yb3VuZChlL3QpKnQtYX0sUT1mdW5jdGlvbih0KXt2YXIgYT10LmRhdGEoaSksbz1lKFwiI21DU0JfXCIrYS5pZHgrXCJfY29udGFpbmVyLCNtQ1NCX1wiK2EuaWR4K1wiX2NvbnRhaW5lcl93cmFwcGVyLCNtQ1NCX1wiK2EuaWR4K1wiX2RyYWdnZXJfdmVydGljYWwsI21DU0JfXCIrYS5pZHgrXCJfZHJhZ2dlcl9ob3Jpem9udGFsXCIpO28uZWFjaChmdW5jdGlvbigpe1ouY2FsbCh0aGlzKX0pfSxHPWZ1bmN0aW9uKHQsYSxvKXtmdW5jdGlvbiBuKGUpe3JldHVybiBzJiZjLmNhbGxiYWNrc1tlXSYmXCJmdW5jdGlvblwiPT10eXBlb2YgYy5jYWxsYmFja3NbZV19ZnVuY3Rpb24gcigpe3JldHVybltjLmNhbGxiYWNrcy5hbHdheXNUcmlnZ2VyT2Zmc2V0c3x8Xz49U1swXStiLGMuY2FsbGJhY2tzLmFsd2F5c1RyaWdnZXJPZmZzZXRzfHwtQz49X119ZnVuY3Rpb24gbCgpe3ZhciBlPVtoWzBdLm9mZnNldFRvcCxoWzBdLm9mZnNldExlZnRdLGE9W3ZbMF0ub2Zmc2V0VG9wLHZbMF0ub2Zmc2V0TGVmdF0sbj1baC5vdXRlckhlaWdodCghMSksaC5vdXRlcldpZHRoKCExKV0saT1bZi5oZWlnaHQoKSxmLndpZHRoKCldO3RbMF0ubWNzPXtjb250ZW50OmgsdG9wOmVbMF0sbGVmdDplWzFdLGRyYWdnZXJUb3A6YVswXSxkcmFnZ2VyTGVmdDphWzFdLHRvcFBjdDpNYXRoLnJvdW5kKDEwMCpNYXRoLmFicyhlWzBdKS8oTWF0aC5hYnMoblswXSktaVswXSkpLGxlZnRQY3Q6TWF0aC5yb3VuZCgxMDAqTWF0aC5hYnMoZVsxXSkvKE1hdGguYWJzKG5bMV0pLWlbMV0pKSxkaXJlY3Rpb246by5kaXJ9fXZhciBzPXQuZGF0YShpKSxjPXMub3B0LGQ9e3RyaWdnZXI6XCJpbnRlcm5hbFwiLGRpcjpcInlcIixzY3JvbGxFYXNpbmc6XCJtY3NFYXNlT3V0XCIsZHJhZzohMSxkdXI6Yy5zY3JvbGxJbmVydGlhLG92ZXJ3cml0ZTpcImFsbFwiLGNhbGxiYWNrczohMCxvblN0YXJ0OiEwLG9uVXBkYXRlOiEwLG9uQ29tcGxldGU6ITB9LG89ZS5leHRlbmQoZCxvKSx1PVtvLmR1cixvLmRyYWc/MDpvLmR1cl0sZj1lKFwiI21DU0JfXCIrcy5pZHgpLGg9ZShcIiNtQ1NCX1wiK3MuaWR4K1wiX2NvbnRhaW5lclwiKSxtPWgucGFyZW50KCkscD1jLmNhbGxiYWNrcy5vblRvdGFsU2Nyb2xsT2Zmc2V0P1kuY2FsbCh0LGMuY2FsbGJhY2tzLm9uVG90YWxTY3JvbGxPZmZzZXQpOlswLDBdLGc9Yy5jYWxsYmFja3Mub25Ub3RhbFNjcm9sbEJhY2tPZmZzZXQ/WS5jYWxsKHQsYy5jYWxsYmFja3Mub25Ub3RhbFNjcm9sbEJhY2tPZmZzZXQpOlswLDBdO2lmKHMudHJpZ2dlcj1vLnRyaWdnZXIsKDAhPT1tLnNjcm9sbFRvcCgpfHwwIT09bS5zY3JvbGxMZWZ0KCkpJiYoZShcIi5tQ1NCX1wiK3MuaWR4K1wiX3Njcm9sbGJhclwiKS5jc3MoXCJ2aXNpYmlsaXR5XCIsXCJ2aXNpYmxlXCIpLG0uc2Nyb2xsVG9wKDApLnNjcm9sbExlZnQoMCkpLFwiX3Jlc2V0WVwiIT09YXx8cy5jb250ZW50UmVzZXQueXx8KG4oXCJvbk92ZXJmbG93WU5vbmVcIikmJmMuY2FsbGJhY2tzLm9uT3ZlcmZsb3dZTm9uZS5jYWxsKHRbMF0pLHMuY29udGVudFJlc2V0Lnk9MSksXCJfcmVzZXRYXCIhPT1hfHxzLmNvbnRlbnRSZXNldC54fHwobihcIm9uT3ZlcmZsb3dYTm9uZVwiKSYmYy5jYWxsYmFja3Mub25PdmVyZmxvd1hOb25lLmNhbGwodFswXSkscy5jb250ZW50UmVzZXQueD0xKSxcIl9yZXNldFlcIiE9PWEmJlwiX3Jlc2V0WFwiIT09YSl7c3dpdGNoKCFzLmNvbnRlbnRSZXNldC55JiZ0WzBdLm1jc3x8IXMub3ZlcmZsb3dlZFswXXx8KG4oXCJvbk92ZXJmbG93WVwiKSYmYy5jYWxsYmFja3Mub25PdmVyZmxvd1kuY2FsbCh0WzBdKSxzLmNvbnRlbnRSZXNldC54PW51bGwpLCFzLmNvbnRlbnRSZXNldC54JiZ0WzBdLm1jc3x8IXMub3ZlcmZsb3dlZFsxXXx8KG4oXCJvbk92ZXJmbG93WFwiKSYmYy5jYWxsYmFja3Mub25PdmVyZmxvd1guY2FsbCh0WzBdKSxzLmNvbnRlbnRSZXNldC54PW51bGwpLGMuc25hcEFtb3VudCYmKGE9VihhLGMuc25hcEFtb3VudCxjLnNuYXBPZmZzZXQpKSxvLmRpcil7Y2FzZVwieFwiOnZhciB2PWUoXCIjbUNTQl9cIitzLmlkeCtcIl9kcmFnZ2VyX2hvcml6b250YWxcIikseD1cImxlZnRcIixfPWhbMF0ub2Zmc2V0TGVmdCxTPVtmLndpZHRoKCktaC5vdXRlcldpZHRoKCExKSx2LnBhcmVudCgpLndpZHRoKCktdi53aWR0aCgpXSx3PVthLDA9PT1hPzA6YS9zLnNjcm9sbFJhdGlvLnhdLGI9cFsxXSxDPWdbMV0seT1iPjA/Yi9zLnNjcm9sbFJhdGlvLng6MCxCPUM+MD9DL3Muc2Nyb2xsUmF0aW8ueDowO1xyXG5icmVhaztjYXNlXCJ5XCI6dmFyIHY9ZShcIiNtQ1NCX1wiK3MuaWR4K1wiX2RyYWdnZXJfdmVydGljYWxcIikseD1cInRvcFwiLF89aFswXS5vZmZzZXRUb3AsUz1bZi5oZWlnaHQoKS1oLm91dGVySGVpZ2h0KCExKSx2LnBhcmVudCgpLmhlaWdodCgpLXYuaGVpZ2h0KCldLHc9W2EsMD09PWE/MDphL3Muc2Nyb2xsUmF0aW8ueV0sYj1wWzBdLEM9Z1swXSx5PWI+MD9iL3Muc2Nyb2xsUmF0aW8ueTowLEI9Qz4wP0Mvcy5zY3JvbGxSYXRpby55OjB9d1sxXTwwfHwwPT09d1swXSYmMD09PXdbMV0/dz1bMCwwXTp3WzFdPj1TWzFdP3c9W1NbMF0sU1sxXV06d1swXT0td1swXSx0WzBdLm1jc3x8KGwoKSxuKFwib25Jbml0XCIpJiZjLmNhbGxiYWNrcy5vbkluaXQuY2FsbCh0WzBdKSksY2xlYXJUaW1lb3V0KGhbMF0ub25Db21wbGV0ZVRpbWVvdXQpLChzLnR3ZWVuUnVubmluZ3x8ISgwPT09XyYmd1swXT49MHx8Xz09PVNbMF0mJndbMF08PVNbMF0pKSYmKEoodlswXSx4LE1hdGgucm91bmQod1sxXSksdVsxXSxvLnNjcm9sbEVhc2luZyksSihoWzBdLHgsTWF0aC5yb3VuZCh3WzBdKSx1WzBdLG8uc2Nyb2xsRWFzaW5nLG8ub3ZlcndyaXRlLHtvblN0YXJ0OmZ1bmN0aW9uKCl7by5jYWxsYmFja3MmJm8ub25TdGFydCYmIXMudHdlZW5SdW5uaW5nJiYobihcIm9uU2Nyb2xsU3RhcnRcIikmJihsKCksYy5jYWxsYmFja3Mub25TY3JvbGxTdGFydC5jYWxsKHRbMF0pKSxzLnR3ZWVuUnVubmluZz0hMCxUKHYpLHMuY2JPZmZzZXRzPXIoKSl9LG9uVXBkYXRlOmZ1bmN0aW9uKCl7by5jYWxsYmFja3MmJm8ub25VcGRhdGUmJm4oXCJ3aGlsZVNjcm9sbGluZ1wiKSYmKGwoKSxjLmNhbGxiYWNrcy53aGlsZVNjcm9sbGluZy5jYWxsKHRbMF0pKX0sb25Db21wbGV0ZTpmdW5jdGlvbigpe2lmKG8uY2FsbGJhY2tzJiZvLm9uQ29tcGxldGUpe1wieXhcIj09PWMuYXhpcyYmY2xlYXJUaW1lb3V0KGhbMF0ub25Db21wbGV0ZVRpbWVvdXQpO3ZhciBlPWhbMF0uaWRsZVRpbWVyfHwwO2hbMF0ub25Db21wbGV0ZVRpbWVvdXQ9c2V0VGltZW91dChmdW5jdGlvbigpe24oXCJvblNjcm9sbFwiKSYmKGwoKSxjLmNhbGxiYWNrcy5vblNjcm9sbC5jYWxsKHRbMF0pKSxuKFwib25Ub3RhbFNjcm9sbFwiKSYmd1sxXT49U1sxXS15JiZzLmNiT2Zmc2V0c1swXSYmKGwoKSxjLmNhbGxiYWNrcy5vblRvdGFsU2Nyb2xsLmNhbGwodFswXSkpLG4oXCJvblRvdGFsU2Nyb2xsQmFja1wiKSYmd1sxXTw9QiYmcy5jYk9mZnNldHNbMV0mJihsKCksYy5jYWxsYmFja3Mub25Ub3RhbFNjcm9sbEJhY2suY2FsbCh0WzBdKSkscy50d2VlblJ1bm5pbmc9ITEsaFswXS5pZGxlVGltZXI9MCxUKHYsXCJoaWRlXCIpfSxlKX19fSkpfX0sSj1mdW5jdGlvbihlLGEsbyxuLGkscixsKXtmdW5jdGlvbiBzKCl7Yi5zdG9wfHwoX3x8cC5jYWxsKCksXz1LKCkteCxjKCksXz49Yi50aW1lJiYoYi50aW1lPV8+Yi50aW1lP18raC0oXy1iLnRpbWUpOl8raC0xLGIudGltZTxfKzEmJihiLnRpbWU9XysxKSksYi50aW1lPG4/Yi5pZD1tKHMpOnYuY2FsbCgpKX1mdW5jdGlvbiBjKCl7bj4wPyhiLmN1cnJWYWw9ZihiLnRpbWUsUyxDLG4saSksd1thXT1NYXRoLnJvdW5kKGIuY3VyclZhbCkrXCJweFwiKTp3W2FdPW8rXCJweFwiLGcuY2FsbCgpfWZ1bmN0aW9uIGQoKXtoPTFlMy82MCxiLnRpbWU9XytoLG09dC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWU/dC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGMoKSxzZXRUaW1lb3V0KGUsLjAxKX0sYi5pZD1tKHMpfWZ1bmN0aW9uIHUoKXtudWxsIT1iLmlkJiYodC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWU/dC5jYW5jZWxBbmltYXRpb25GcmFtZShiLmlkKTpjbGVhclRpbWVvdXQoYi5pZCksYi5pZD1udWxsKX1mdW5jdGlvbiBmKGUsdCxhLG8sbil7c3dpdGNoKG4pe2Nhc2VcImxpbmVhclwiOmNhc2VcIm1jc0xpbmVhclwiOnJldHVybiBhKmUvbyt0O2Nhc2VcIm1jc0xpbmVhck91dFwiOnJldHVybiBlLz1vLGUtLSxhKk1hdGguc3FydCgxLWUqZSkrdDtjYXNlXCJlYXNlSW5PdXRTbW9vdGhcIjpyZXR1cm4gZS89by8yLDE+ZT9hLzIqZSplK3Q6KGUtLSwtYS8yKihlKihlLTIpLTEpK3QpO2Nhc2VcImVhc2VJbk91dFN0cm9uZ1wiOnJldHVybiBlLz1vLzIsMT5lP2EvMipNYXRoLnBvdygyLDEwKihlLTEpKSt0OihlLS0sYS8yKigtTWF0aC5wb3coMiwtMTAqZSkrMikrdCk7Y2FzZVwiZWFzZUluT3V0XCI6Y2FzZVwibWNzRWFzZUluT3V0XCI6cmV0dXJuIGUvPW8vMiwxPmU/YS8yKmUqZSplK3Q6KGUtPTIsYS8yKihlKmUqZSsyKSt0KTtjYXNlXCJlYXNlT3V0U21vb3RoXCI6cmV0dXJuIGUvPW8sZS0tLC1hKihlKmUqZSplLTEpK3Q7Y2FzZVwiZWFzZU91dFN0cm9uZ1wiOnJldHVybiBhKigtTWF0aC5wb3coMiwtMTAqZS9vKSsxKSt0O2Nhc2VcImVhc2VPdXRcIjpjYXNlXCJtY3NFYXNlT3V0XCI6ZGVmYXVsdDp2YXIgaT0oZS89bykqZSxyPWkqZTtyZXR1cm4gdCthKiguNDk5OTk5OTk5OTk5OTk3KnIqaSstMi41KmkqaSs1LjUqcistNi41KmkrNCplKX19ZS5fbVR3ZWVufHwoZS5fbVR3ZWVuPXt0b3A6e30sbGVmdDp7fX0pO3ZhciBoLG0sbD1sfHx7fSxwPWwub25TdGFydHx8ZnVuY3Rpb24oKXt9LGc9bC5vblVwZGF0ZXx8ZnVuY3Rpb24oKXt9LHY9bC5vbkNvbXBsZXRlfHxmdW5jdGlvbigpe30seD1LKCksXz0wLFM9ZS5vZmZzZXRUb3Asdz1lLnN0eWxlLGI9ZS5fbVR3ZWVuW2FdO1wibGVmdFwiPT09YSYmKFM9ZS5vZmZzZXRMZWZ0KTt2YXIgQz1vLVM7Yi5zdG9wPTAsXCJub25lXCIhPT1yJiZ1KCksZCgpfSxLPWZ1bmN0aW9uKCl7cmV0dXJuIHQucGVyZm9ybWFuY2UmJnQucGVyZm9ybWFuY2Uubm93P3QucGVyZm9ybWFuY2Uubm93KCk6dC5wZXJmb3JtYW5jZSYmdC5wZXJmb3JtYW5jZS53ZWJraXROb3c/dC5wZXJmb3JtYW5jZS53ZWJraXROb3coKTpEYXRlLm5vdz9EYXRlLm5vdygpOihuZXcgRGF0ZSkuZ2V0VGltZSgpfSxaPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcztlLl9tVHdlZW58fChlLl9tVHdlZW49e3RvcDp7fSxsZWZ0Ont9fSk7Zm9yKHZhciBhPVtcInRvcFwiLFwibGVmdFwiXSxvPTA7bzxhLmxlbmd0aDtvKyspe3ZhciBuPWFbb107ZS5fbVR3ZWVuW25dLmlkJiYodC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWU/dC5jYW5jZWxBbmltYXRpb25GcmFtZShlLl9tVHdlZW5bbl0uaWQpOmNsZWFyVGltZW91dChlLl9tVHdlZW5bbl0uaWQpLGUuX21Ud2VlbltuXS5pZD1udWxsLGUuX21Ud2VlbltuXS5zdG9wPTEpfX0sJD1mdW5jdGlvbihlLHQpe3RyeXtkZWxldGUgZVt0XX1jYXRjaChhKXtlW3RdPW51bGx9fSxldD1mdW5jdGlvbihlKXtyZXR1cm4hKGUud2hpY2gmJjEhPT1lLndoaWNoKX0sdHQ9ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5vcmlnaW5hbEV2ZW50LnBvaW50ZXJUeXBlO3JldHVybiEodCYmXCJ0b3VjaFwiIT09dCYmMiE9PXQpfSxhdD1mdW5jdGlvbihlKXtyZXR1cm4haXNOYU4ocGFyc2VGbG9hdChlKSkmJmlzRmluaXRlKGUpfSxvdD1mdW5jdGlvbihlKXt2YXIgdD1lLnBhcmVudHMoXCIubUNTQl9jb250YWluZXJcIik7cmV0dXJuW2Uub2Zmc2V0KCkudG9wLXQub2Zmc2V0KCkudG9wLGUub2Zmc2V0KCkubGVmdC10Lm9mZnNldCgpLmxlZnRdfTtlLmZuW25dPWZ1bmN0aW9uKHQpe3JldHVybiBoW3RdP2hbdF0uYXBwbHkodGhpcyxBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpOlwib2JqZWN0XCIhPXR5cGVvZiB0JiZ0P3ZvaWQgZS5lcnJvcihcIk1ldGhvZCBcIit0K1wiIGRvZXMgbm90IGV4aXN0XCIpOmguaW5pdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGVbbl09ZnVuY3Rpb24odCl7cmV0dXJuIGhbdF0/aFt0XS5hcHBseSh0aGlzLEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSk6XCJvYmplY3RcIiE9dHlwZW9mIHQmJnQ/dm9pZCBlLmVycm9yKFwiTWV0aG9kIFwiK3QrXCIgZG9lcyBub3QgZXhpc3RcIik6aC5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZVtuXS5kZWZhdWx0cz1sLHRbbl09ITAsZSh0KS5sb2FkKGZ1bmN0aW9uKCl7ZShyKVtuXSgpLGUuZXh0ZW5kKGUuZXhwcltcIjpcIl0se21jc0luVmlldzplLmV4cHJbXCI6XCJdLm1jc0luVmlld3x8ZnVuY3Rpb24odCl7dmFyIGEsbyxuPWUodCksaT1uLnBhcmVudHMoXCIubUNTQl9jb250YWluZXJcIik7aWYoaS5sZW5ndGgpcmV0dXJuIGE9aS5wYXJlbnQoKSxvPVtpWzBdLm9mZnNldFRvcCxpWzBdLm9mZnNldExlZnRdLG9bMF0rb3QobilbMF0+PTAmJm9bMF0rb3QobilbMF08YS5oZWlnaHQoKS1uLm91dGVySGVpZ2h0KCExKSYmb1sxXStvdChuKVsxXT49MCYmb1sxXStvdChuKVsxXTxhLndpZHRoKCktbi5vdXRlcldpZHRoKCExKX0sbWNzT3ZlcmZsb3c6ZS5leHByW1wiOlwiXS5tY3NPdmVyZmxvd3x8ZnVuY3Rpb24odCl7dmFyIGE9ZSh0KS5kYXRhKGkpO2lmKGEpcmV0dXJuIGEub3ZlcmZsb3dlZFswXXx8YS5vdmVyZmxvd2VkWzFdfX0pfSl9KX0oalF1ZXJ5LHdpbmRvdyxkb2N1bWVudCk7IiwiLypcclxuIEFuZ3VsYXJKUyB2MS4zLjlcclxuIChjKSAyMDEwLTIwMTQgR29vZ2xlLCBJbmMuIGh0dHA6Ly9hbmd1bGFyanMub3JnXHJcbiBMaWNlbnNlOiBNSVRcclxuKi9cclxuKGZ1bmN0aW9uKE0sWSx0KXsndXNlIHN0cmljdCc7ZnVuY3Rpb24gVChiKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYT1hcmd1bWVudHNbMF0sYztjPVwiW1wiKyhiP2IrXCI6XCI6XCJcIikrYStcIl0gaHR0cDovL2Vycm9ycy5hbmd1bGFyanMub3JnLzEuMy45L1wiKyhiP2IrXCIvXCI6XCJcIikrYTtmb3IoYT0xO2E8YXJndW1lbnRzLmxlbmd0aDthKyspe2M9YysoMT09YT9cIj9cIjpcIiZcIikrXCJwXCIrKGEtMSkrXCI9XCI7dmFyIGQ9ZW5jb2RlVVJJQ29tcG9uZW50LGU7ZT1hcmd1bWVudHNbYV07ZT1cImZ1bmN0aW9uXCI9PXR5cGVvZiBlP2UudG9TdHJpbmcoKS5yZXBsYWNlKC8gXFx7W1xcc1xcU10qJC8sXCJcIik6XCJ1bmRlZmluZWRcIj09dHlwZW9mIGU/XCJ1bmRlZmluZWRcIjpcInN0cmluZ1wiIT10eXBlb2YgZT9KU09OLnN0cmluZ2lmeShlKTplO2MrPWQoZSl9cmV0dXJuIEVycm9yKGMpfX1mdW5jdGlvbiBUYShiKXtpZihudWxsPT1ifHxVYShiKSlyZXR1cm4hMTt2YXIgYT1iLmxlbmd0aDtyZXR1cm4gYi5ub2RlVHlwZT09PVxyXG5vYSYmYT8hMDpGKGIpfHxEKGIpfHwwPT09YXx8XCJudW1iZXJcIj09PXR5cGVvZiBhJiYwPGEmJmEtMSBpbiBifWZ1bmN0aW9uIHMoYixhLGMpe3ZhciBkLGU7aWYoYilpZihHKGIpKWZvcihkIGluIGIpXCJwcm90b3R5cGVcIj09ZHx8XCJsZW5ndGhcIj09ZHx8XCJuYW1lXCI9PWR8fGIuaGFzT3duUHJvcGVydHkmJiFiLmhhc093blByb3BlcnR5KGQpfHxhLmNhbGwoYyxiW2RdLGQsYik7ZWxzZSBpZihEKGIpfHxUYShiKSl7dmFyIGY9XCJvYmplY3RcIiE9PXR5cGVvZiBiO2Q9MDtmb3IoZT1iLmxlbmd0aDtkPGU7ZCsrKShmfHxkIGluIGIpJiZhLmNhbGwoYyxiW2RdLGQsYil9ZWxzZSBpZihiLmZvckVhY2gmJmIuZm9yRWFjaCE9PXMpYi5mb3JFYWNoKGEsYyxiKTtlbHNlIGZvcihkIGluIGIpYi5oYXNPd25Qcm9wZXJ0eShkKSYmYS5jYWxsKGMsYltkXSxkLGIpO3JldHVybiBifWZ1bmN0aW9uIEVkKGIsYSxjKXtmb3IodmFyIGQ9T2JqZWN0LmtleXMoYikuc29ydCgpLGU9MDtlPGQubGVuZ3RoO2UrKylhLmNhbGwoYyxcclxuYltkW2VdXSxkW2VdKTtyZXR1cm4gZH1mdW5jdGlvbiBrYyhiKXtyZXR1cm4gZnVuY3Rpb24oYSxjKXtiKGMsYSl9fWZ1bmN0aW9uIEZkKCl7cmV0dXJuKytuYn1mdW5jdGlvbiBsYyhiLGEpe2E/Yi4kJGhhc2hLZXk9YTpkZWxldGUgYi4kJGhhc2hLZXl9ZnVuY3Rpb24geihiKXtmb3IodmFyIGE9Yi4kJGhhc2hLZXksYz0xLGQ9YXJndW1lbnRzLmxlbmd0aDtjPGQ7YysrKXt2YXIgZT1hcmd1bWVudHNbY107aWYoZSlmb3IodmFyIGY9T2JqZWN0LmtleXMoZSksZz0wLGg9Zi5sZW5ndGg7ZzxoO2crKyl7dmFyIGw9ZltnXTtiW2xdPWVbbF19fWxjKGIsYSk7cmV0dXJuIGJ9ZnVuY3Rpb24gYmEoYil7cmV0dXJuIHBhcnNlSW50KGIsMTApfWZ1bmN0aW9uIEgoKXt9ZnVuY3Rpb24gcGEoYil7cmV0dXJuIGJ9ZnVuY3Rpb24gZGEoYil7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGJ9fWZ1bmN0aW9uIEEoYil7cmV0dXJuXCJ1bmRlZmluZWRcIj09PXR5cGVvZiBifWZ1bmN0aW9uIHkoYil7cmV0dXJuXCJ1bmRlZmluZWRcIiE9PVxyXG50eXBlb2YgYn1mdW5jdGlvbiBJKGIpe3JldHVybiBudWxsIT09YiYmXCJvYmplY3RcIj09PXR5cGVvZiBifWZ1bmN0aW9uIEYoYil7cmV0dXJuXCJzdHJpbmdcIj09PXR5cGVvZiBifWZ1bmN0aW9uIFYoYil7cmV0dXJuXCJudW1iZXJcIj09PXR5cGVvZiBifWZ1bmN0aW9uIHFhKGIpe3JldHVyblwiW29iamVjdCBEYXRlXVwiPT09RGEuY2FsbChiKX1mdW5jdGlvbiBHKGIpe3JldHVyblwiZnVuY3Rpb25cIj09PXR5cGVvZiBifWZ1bmN0aW9uIG9iKGIpe3JldHVyblwiW29iamVjdCBSZWdFeHBdXCI9PT1EYS5jYWxsKGIpfWZ1bmN0aW9uIFVhKGIpe3JldHVybiBiJiZiLndpbmRvdz09PWJ9ZnVuY3Rpb24gVmEoYil7cmV0dXJuIGImJmIuJGV2YWxBc3luYyYmYi4kd2F0Y2h9ZnVuY3Rpb24gV2EoYil7cmV0dXJuXCJib29sZWFuXCI9PT10eXBlb2YgYn1mdW5jdGlvbiBtYyhiKXtyZXR1cm4hKCFifHwhKGIubm9kZU5hbWV8fGIucHJvcCYmYi5hdHRyJiZiLmZpbmQpKX1mdW5jdGlvbiBHZChiKXt2YXIgYT17fTtcclxuYj1iLnNwbGl0KFwiLFwiKTt2YXIgYztmb3IoYz0wO2M8Yi5sZW5ndGg7YysrKWFbYltjXV09ITA7cmV0dXJuIGF9ZnVuY3Rpb24gdWEoYil7cmV0dXJuIFEoYi5ub2RlTmFtZXx8YlswXSYmYlswXS5ub2RlTmFtZSl9ZnVuY3Rpb24gWGEoYixhKXt2YXIgYz1iLmluZGV4T2YoYSk7MDw9YyYmYi5zcGxpY2UoYywxKTtyZXR1cm4gYX1mdW5jdGlvbiBFYShiLGEsYyxkKXtpZihVYShiKXx8VmEoYikpdGhyb3cgS2EoXCJjcHdzXCIpO2lmKGEpe2lmKGI9PT1hKXRocm93IEthKFwiY3BpXCIpO2M9Y3x8W107ZD1kfHxbXTtpZihJKGIpKXt2YXIgZT1jLmluZGV4T2YoYik7aWYoLTEhPT1lKXJldHVybiBkW2VdO2MucHVzaChiKTtkLnB1c2goYSl9aWYoRChiKSlmb3IodmFyIGY9YS5sZW5ndGg9MDtmPGIubGVuZ3RoO2YrKyllPUVhKGJbZl0sbnVsbCxjLGQpLEkoYltmXSkmJihjLnB1c2goYltmXSksZC5wdXNoKGUpKSxhLnB1c2goZSk7ZWxzZXt2YXIgZz1hLiQkaGFzaEtleTtEKGEpP2EubGVuZ3RoPVxyXG4wOnMoYSxmdW5jdGlvbihiLGMpe2RlbGV0ZSBhW2NdfSk7Zm9yKGYgaW4gYiliLmhhc093blByb3BlcnR5KGYpJiYoZT1FYShiW2ZdLG51bGwsYyxkKSxJKGJbZl0pJiYoYy5wdXNoKGJbZl0pLGQucHVzaChlKSksYVtmXT1lKTtsYyhhLGcpfX1lbHNlIGlmKGE9YilEKGIpP2E9RWEoYixbXSxjLGQpOnFhKGIpP2E9bmV3IERhdGUoYi5nZXRUaW1lKCkpOm9iKGIpPyhhPW5ldyBSZWdFeHAoYi5zb3VyY2UsYi50b1N0cmluZygpLm1hdGNoKC9bXlxcL10qJC8pWzBdKSxhLmxhc3RJbmRleD1iLmxhc3RJbmRleCk6SShiKSYmKGU9T2JqZWN0LmNyZWF0ZShPYmplY3QuZ2V0UHJvdG90eXBlT2YoYikpLGE9RWEoYixlLGMsZCkpO3JldHVybiBhfWZ1bmN0aW9uIHJhKGIsYSl7aWYoRChiKSl7YT1hfHxbXTtmb3IodmFyIGM9MCxkPWIubGVuZ3RoO2M8ZDtjKyspYVtjXT1iW2NdfWVsc2UgaWYoSShiKSlmb3IoYyBpbiBhPWF8fHt9LGIpaWYoXCIkXCIhPT1jLmNoYXJBdCgwKXx8XCIkXCIhPT1jLmNoYXJBdCgxKSlhW2NdPVxyXG5iW2NdO3JldHVybiBhfHxifWZ1bmN0aW9uIGZhKGIsYSl7aWYoYj09PWEpcmV0dXJuITA7aWYobnVsbD09PWJ8fG51bGw9PT1hKXJldHVybiExO2lmKGIhPT1iJiZhIT09YSlyZXR1cm4hMDt2YXIgYz10eXBlb2YgYixkO2lmKGM9PXR5cGVvZiBhJiZcIm9iamVjdFwiPT1jKWlmKEQoYikpe2lmKCFEKGEpKXJldHVybiExO2lmKChjPWIubGVuZ3RoKT09YS5sZW5ndGgpe2ZvcihkPTA7ZDxjO2QrKylpZighZmEoYltkXSxhW2RdKSlyZXR1cm4hMTtyZXR1cm4hMH19ZWxzZXtpZihxYShiKSlyZXR1cm4gcWEoYSk/ZmEoYi5nZXRUaW1lKCksYS5nZXRUaW1lKCkpOiExO2lmKG9iKGIpJiZvYihhKSlyZXR1cm4gYi50b1N0cmluZygpPT1hLnRvU3RyaW5nKCk7aWYoVmEoYil8fFZhKGEpfHxVYShiKXx8VWEoYSl8fEQoYSkpcmV0dXJuITE7Yz17fTtmb3IoZCBpbiBiKWlmKFwiJFwiIT09ZC5jaGFyQXQoMCkmJiFHKGJbZF0pKXtpZighZmEoYltkXSxhW2RdKSlyZXR1cm4hMTtjW2RdPSEwfWZvcihkIGluIGEpaWYoIWMuaGFzT3duUHJvcGVydHkoZCkmJlxyXG5cIiRcIiE9PWQuY2hhckF0KDApJiZhW2RdIT09dCYmIUcoYVtkXSkpcmV0dXJuITE7cmV0dXJuITB9cmV0dXJuITF9ZnVuY3Rpb24gWWEoYixhLGMpe3JldHVybiBiLmNvbmNhdChaYS5jYWxsKGEsYykpfWZ1bmN0aW9uIG5jKGIsYSl7dmFyIGM9Mjxhcmd1bWVudHMubGVuZ3RoP1phLmNhbGwoYXJndW1lbnRzLDIpOltdO3JldHVybiFHKGEpfHxhIGluc3RhbmNlb2YgUmVnRXhwP2E6Yy5sZW5ndGg/ZnVuY3Rpb24oKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD9hLmFwcGx5KGIsWWEoYyxhcmd1bWVudHMsMCkpOmEuYXBwbHkoYixjKX06ZnVuY3Rpb24oKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD9hLmFwcGx5KGIsYXJndW1lbnRzKTphLmNhbGwoYil9fWZ1bmN0aW9uIEhkKGIsYSl7dmFyIGM9YTtcInN0cmluZ1wiPT09dHlwZW9mIGImJlwiJFwiPT09Yi5jaGFyQXQoMCkmJlwiJFwiPT09Yi5jaGFyQXQoMSk/Yz10OlVhKGEpP2M9XCIkV0lORE9XXCI6YSYmWT09PWE/Yz1cIiRET0NVTUVOVFwiOlZhKGEpJiZcclxuKGM9XCIkU0NPUEVcIik7cmV0dXJuIGN9ZnVuY3Rpb24gJGEoYixhKXtpZihcInVuZGVmaW5lZFwiPT09dHlwZW9mIGIpcmV0dXJuIHQ7VihhKXx8KGE9YT8yOm51bGwpO3JldHVybiBKU09OLnN0cmluZ2lmeShiLEhkLGEpfWZ1bmN0aW9uIG9jKGIpe3JldHVybiBGKGIpP0pTT04ucGFyc2UoYik6Yn1mdW5jdGlvbiB2YShiKXtiPUIoYikuY2xvbmUoKTt0cnl7Yi5lbXB0eSgpfWNhdGNoKGEpe312YXIgYz1CKFwiPGRpdj5cIikuYXBwZW5kKGIpLmh0bWwoKTt0cnl7cmV0dXJuIGJbMF0ubm9kZVR5cGU9PT1wYj9RKGMpOmMubWF0Y2goL14oPFtePl0rPikvKVsxXS5yZXBsYWNlKC9ePChbXFx3XFwtXSspLyxmdW5jdGlvbihhLGIpe3JldHVyblwiPFwiK1EoYil9KX1jYXRjaChkKXtyZXR1cm4gUShjKX19ZnVuY3Rpb24gcGMoYil7dHJ5e3JldHVybiBkZWNvZGVVUklDb21wb25lbnQoYil9Y2F0Y2goYSl7fX1mdW5jdGlvbiBxYyhiKXt2YXIgYT17fSxjLGQ7cygoYnx8XCJcIikuc3BsaXQoXCImXCIpLGZ1bmN0aW9uKGIpe2ImJlxyXG4oYz1iLnJlcGxhY2UoL1xcKy9nLFwiJTIwXCIpLnNwbGl0KFwiPVwiKSxkPXBjKGNbMF0pLHkoZCkmJihiPXkoY1sxXSk/cGMoY1sxXSk6ITAscmMuY2FsbChhLGQpP0QoYVtkXSk/YVtkXS5wdXNoKGIpOmFbZF09W2FbZF0sYl06YVtkXT1iKSl9KTtyZXR1cm4gYX1mdW5jdGlvbiBOYihiKXt2YXIgYT1bXTtzKGIsZnVuY3Rpb24oYixkKXtEKGIpP3MoYixmdW5jdGlvbihiKXthLnB1c2goRmEoZCwhMCkrKCEwPT09Yj9cIlwiOlwiPVwiK0ZhKGIsITApKSl9KTphLnB1c2goRmEoZCwhMCkrKCEwPT09Yj9cIlwiOlwiPVwiK0ZhKGIsITApKSl9KTtyZXR1cm4gYS5sZW5ndGg/YS5qb2luKFwiJlwiKTpcIlwifWZ1bmN0aW9uIHFiKGIpe3JldHVybiBGYShiLCEwKS5yZXBsYWNlKC8lMjYvZ2ksXCImXCIpLnJlcGxhY2UoLyUzRC9naSxcIj1cIikucmVwbGFjZSgvJTJCL2dpLFwiK1wiKX1mdW5jdGlvbiBGYShiLGEpe3JldHVybiBlbmNvZGVVUklDb21wb25lbnQoYikucmVwbGFjZSgvJTQwL2dpLFwiQFwiKS5yZXBsYWNlKC8lM0EvZ2ksXHJcblwiOlwiKS5yZXBsYWNlKC8lMjQvZyxcIiRcIikucmVwbGFjZSgvJTJDL2dpLFwiLFwiKS5yZXBsYWNlKC8lM0IvZ2ksXCI7XCIpLnJlcGxhY2UoLyUyMC9nLGE/XCIlMjBcIjpcIitcIil9ZnVuY3Rpb24gSWQoYixhKXt2YXIgYyxkLGU9cmIubGVuZ3RoO2I9QihiKTtmb3IoZD0wO2Q8ZTsrK2QpaWYoYz1yYltkXSthLEYoYz1iLmF0dHIoYykpKXJldHVybiBjO3JldHVybiBudWxsfWZ1bmN0aW9uIEpkKGIsYSl7dmFyIGMsZCxlPXt9O3MocmIsZnVuY3Rpb24oYSl7YSs9XCJhcHBcIjshYyYmYi5oYXNBdHRyaWJ1dGUmJmIuaGFzQXR0cmlidXRlKGEpJiYoYz1iLGQ9Yi5nZXRBdHRyaWJ1dGUoYSkpfSk7cyhyYixmdW5jdGlvbihhKXthKz1cImFwcFwiO3ZhciBlOyFjJiYoZT1iLnF1ZXJ5U2VsZWN0b3IoXCJbXCIrYS5yZXBsYWNlKFwiOlwiLFwiXFxcXDpcIikrXCJdXCIpKSYmKGM9ZSxkPWUuZ2V0QXR0cmlidXRlKGEpKX0pO2MmJihlLnN0cmljdERpPW51bGwhPT1JZChjLFwic3RyaWN0LWRpXCIpLGEoYyxkP1tkXTpbXSxlKSl9ZnVuY3Rpb24gc2MoYixcclxuYSxjKXtJKGMpfHwoYz17fSk7Yz16KHtzdHJpY3REaTohMX0sYyk7dmFyIGQ9ZnVuY3Rpb24oKXtiPUIoYik7aWYoYi5pbmplY3RvcigpKXt2YXIgZD1iWzBdPT09WT9cImRvY3VtZW50XCI6dmEoYik7dGhyb3cgS2EoXCJidHN0cnBkXCIsZC5yZXBsYWNlKC88LyxcIiZsdDtcIikucmVwbGFjZSgvPi8sXCImZ3Q7XCIpKTt9YT1hfHxbXTthLnVuc2hpZnQoW1wiJHByb3ZpZGVcIixmdW5jdGlvbihhKXthLnZhbHVlKFwiJHJvb3RFbGVtZW50XCIsYil9XSk7Yy5kZWJ1Z0luZm9FbmFibGVkJiZhLnB1c2goW1wiJGNvbXBpbGVQcm92aWRlclwiLGZ1bmN0aW9uKGEpe2EuZGVidWdJbmZvRW5hYmxlZCghMCl9XSk7YS51bnNoaWZ0KFwibmdcIik7ZD1PYihhLGMuc3RyaWN0RGkpO2QuaW52b2tlKFtcIiRyb290U2NvcGVcIixcIiRyb290RWxlbWVudFwiLFwiJGNvbXBpbGVcIixcIiRpbmplY3RvclwiLGZ1bmN0aW9uKGEsYixjLGQpe2EuJGFwcGx5KGZ1bmN0aW9uKCl7Yi5kYXRhKFwiJGluamVjdG9yXCIsZCk7YyhiKShhKX0pfV0pO3JldHVybiBkfSxcclxuZT0vXk5HX0VOQUJMRV9ERUJVR19JTkZPIS8sZj0vXk5HX0RFRkVSX0JPT1RTVFJBUCEvO00mJmUudGVzdChNLm5hbWUpJiYoYy5kZWJ1Z0luZm9FbmFibGVkPSEwLE0ubmFtZT1NLm5hbWUucmVwbGFjZShlLFwiXCIpKTtpZihNJiYhZi50ZXN0KE0ubmFtZSkpcmV0dXJuIGQoKTtNLm5hbWU9TS5uYW1lLnJlcGxhY2UoZixcIlwiKTtnYS5yZXN1bWVCb290c3RyYXA9ZnVuY3Rpb24oYil7cyhiLGZ1bmN0aW9uKGIpe2EucHVzaChiKX0pO2QoKX19ZnVuY3Rpb24gS2QoKXtNLm5hbWU9XCJOR19FTkFCTEVfREVCVUdfSU5GTyFcIitNLm5hbWU7TS5sb2NhdGlvbi5yZWxvYWQoKX1mdW5jdGlvbiBMZChiKXtiPWdhLmVsZW1lbnQoYikuaW5qZWN0b3IoKTtpZighYil0aHJvdyBLYShcInRlc3RcIik7cmV0dXJuIGIuZ2V0KFwiJCR0ZXN0YWJpbGl0eVwiKX1mdW5jdGlvbiB0YyhiLGEpe2E9YXx8XCJfXCI7cmV0dXJuIGIucmVwbGFjZShNZCxmdW5jdGlvbihiLGQpe3JldHVybihkP2E6XCJcIikrYi50b0xvd2VyQ2FzZSgpfSl9XHJcbmZ1bmN0aW9uIE5kKCl7dmFyIGI7dWN8fCgoc2E9TS5qUXVlcnkpJiZzYS5mbi5vbj8oQj1zYSx6KHNhLmZuLHtzY29wZTpMYS5zY29wZSxpc29sYXRlU2NvcGU6TGEuaXNvbGF0ZVNjb3BlLGNvbnRyb2xsZXI6TGEuY29udHJvbGxlcixpbmplY3RvcjpMYS5pbmplY3Rvcixpbmhlcml0ZWREYXRhOkxhLmluaGVyaXRlZERhdGF9KSxiPXNhLmNsZWFuRGF0YSxzYS5jbGVhbkRhdGE9ZnVuY3Rpb24oYSl7dmFyIGM7aWYoUGIpUGI9ITE7ZWxzZSBmb3IodmFyIGQ9MCxlO251bGwhPShlPWFbZF0pO2QrKykoYz1zYS5fZGF0YShlLFwiZXZlbnRzXCIpKSYmYy4kZGVzdHJveSYmc2EoZSkudHJpZ2dlckhhbmRsZXIoXCIkZGVzdHJveVwiKTtiKGEpfSk6Qj1SLGdhLmVsZW1lbnQ9Qix1Yz0hMCl9ZnVuY3Rpb24gUWIoYixhLGMpe2lmKCFiKXRocm93IEthKFwiYXJlcVwiLGF8fFwiP1wiLGN8fFwicmVxdWlyZWRcIik7cmV0dXJuIGJ9ZnVuY3Rpb24gc2IoYixhLGMpe2MmJkQoYikmJihiPWJbYi5sZW5ndGgtMV0pO1xyXG5RYihHKGIpLGEsXCJub3QgYSBmdW5jdGlvbiwgZ290IFwiKyhiJiZcIm9iamVjdFwiPT09dHlwZW9mIGI/Yi5jb25zdHJ1Y3Rvci5uYW1lfHxcIk9iamVjdFwiOnR5cGVvZiBiKSk7cmV0dXJuIGJ9ZnVuY3Rpb24gTWEoYixhKXtpZihcImhhc093blByb3BlcnR5XCI9PT1iKXRocm93IEthKFwiYmFkbmFtZVwiLGEpO31mdW5jdGlvbiB2YyhiLGEsYyl7aWYoIWEpcmV0dXJuIGI7YT1hLnNwbGl0KFwiLlwiKTtmb3IodmFyIGQsZT1iLGY9YS5sZW5ndGgsZz0wO2c8ZjtnKyspZD1hW2ddLGImJihiPShlPWIpW2RdKTtyZXR1cm4hYyYmRyhiKT9uYyhlLGIpOmJ9ZnVuY3Rpb24gdGIoYil7dmFyIGE9YlswXTtiPWJbYi5sZW5ndGgtMV07dmFyIGM9W2FdO2Rve2E9YS5uZXh0U2libGluZztpZighYSlicmVhaztjLnB1c2goYSl9d2hpbGUoYSE9PWIpO3JldHVybiBCKGMpfWZ1bmN0aW9uIGhhKCl7cmV0dXJuIE9iamVjdC5jcmVhdGUobnVsbCl9ZnVuY3Rpb24gT2QoYil7ZnVuY3Rpb24gYShhLGIsYyl7cmV0dXJuIGFbYl18fFxyXG4oYVtiXT1jKCkpfXZhciBjPVQoXCIkaW5qZWN0b3JcIiksZD1UKFwibmdcIik7Yj1hKGIsXCJhbmd1bGFyXCIsT2JqZWN0KTtiLiQkbWluRXJyPWIuJCRtaW5FcnJ8fFQ7cmV0dXJuIGEoYixcIm1vZHVsZVwiLGZ1bmN0aW9uKCl7dmFyIGI9e307cmV0dXJuIGZ1bmN0aW9uKGYsZyxoKXtpZihcImhhc093blByb3BlcnR5XCI9PT1mKXRocm93IGQoXCJiYWRuYW1lXCIsXCJtb2R1bGVcIik7ZyYmYi5oYXNPd25Qcm9wZXJ0eShmKSYmKGJbZl09bnVsbCk7cmV0dXJuIGEoYixmLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGQsZSxmKXtmfHwoZj1iKTtyZXR1cm4gZnVuY3Rpb24oKXtmW2V8fFwicHVzaFwiXShbYyxkLGFyZ3VtZW50c10pO3JldHVybiB1fX1pZighZyl0aHJvdyBjKFwibm9tb2RcIixmKTt2YXIgYj1bXSxkPVtdLGU9W10scT1hKFwiJGluamVjdG9yXCIsXCJpbnZva2VcIixcInB1c2hcIixkKSx1PXtfaW52b2tlUXVldWU6YixfY29uZmlnQmxvY2tzOmQsX3J1bkJsb2NrczplLHJlcXVpcmVzOmcsbmFtZTpmLHByb3ZpZGVyOmEoXCIkcHJvdmlkZVwiLFxyXG5cInByb3ZpZGVyXCIpLGZhY3Rvcnk6YShcIiRwcm92aWRlXCIsXCJmYWN0b3J5XCIpLHNlcnZpY2U6YShcIiRwcm92aWRlXCIsXCJzZXJ2aWNlXCIpLHZhbHVlOmEoXCIkcHJvdmlkZVwiLFwidmFsdWVcIiksY29uc3RhbnQ6YShcIiRwcm92aWRlXCIsXCJjb25zdGFudFwiLFwidW5zaGlmdFwiKSxhbmltYXRpb246YShcIiRhbmltYXRlUHJvdmlkZXJcIixcInJlZ2lzdGVyXCIpLGZpbHRlcjphKFwiJGZpbHRlclByb3ZpZGVyXCIsXCJyZWdpc3RlclwiKSxjb250cm9sbGVyOmEoXCIkY29udHJvbGxlclByb3ZpZGVyXCIsXCJyZWdpc3RlclwiKSxkaXJlY3RpdmU6YShcIiRjb21waWxlUHJvdmlkZXJcIixcImRpcmVjdGl2ZVwiKSxjb25maWc6cSxydW46ZnVuY3Rpb24oYSl7ZS5wdXNoKGEpO3JldHVybiB0aGlzfX07aCYmcShoKTtyZXR1cm4gdX0pfX0pfWZ1bmN0aW9uIFBkKGIpe3ooYix7Ym9vdHN0cmFwOnNjLGNvcHk6RWEsZXh0ZW5kOnosZXF1YWxzOmZhLGVsZW1lbnQ6Qixmb3JFYWNoOnMsaW5qZWN0b3I6T2Isbm9vcDpILGJpbmQ6bmMsdG9Kc29uOiRhLFxyXG5mcm9tSnNvbjpvYyxpZGVudGl0eTpwYSxpc1VuZGVmaW5lZDpBLGlzRGVmaW5lZDp5LGlzU3RyaW5nOkYsaXNGdW5jdGlvbjpHLGlzT2JqZWN0OkksaXNOdW1iZXI6Vixpc0VsZW1lbnQ6bWMsaXNBcnJheTpELHZlcnNpb246UWQsaXNEYXRlOnFhLGxvd2VyY2FzZTpRLHVwcGVyY2FzZTp1YixjYWxsYmFja3M6e2NvdW50ZXI6MH0sZ2V0VGVzdGFiaWxpdHk6TGQsJCRtaW5FcnI6VCwkJGNzcDphYixyZWxvYWRXaXRoRGVidWdJbmZvOktkfSk7YmI9T2QoTSk7dHJ5e2JiKFwibmdMb2NhbGVcIil9Y2F0Y2goYSl7YmIoXCJuZ0xvY2FsZVwiLFtdKS5wcm92aWRlcihcIiRsb2NhbGVcIixSZCl9YmIoXCJuZ1wiLFtcIm5nTG9jYWxlXCJdLFtcIiRwcm92aWRlXCIsZnVuY3Rpb24oYSl7YS5wcm92aWRlcih7JCRzYW5pdGl6ZVVyaTpTZH0pO2EucHJvdmlkZXIoXCIkY29tcGlsZVwiLHdjKS5kaXJlY3RpdmUoe2E6VGQsaW5wdXQ6eGMsdGV4dGFyZWE6eGMsZm9ybTpVZCxzY3JpcHQ6VmQsc2VsZWN0OldkLHN0eWxlOlhkLFxyXG5vcHRpb246WWQsbmdCaW5kOlpkLG5nQmluZEh0bWw6JGQsbmdCaW5kVGVtcGxhdGU6YWUsbmdDbGFzczpiZSxuZ0NsYXNzRXZlbjpjZSxuZ0NsYXNzT2RkOmRlLG5nQ2xvYWs6ZWUsbmdDb250cm9sbGVyOmZlLG5nRm9ybTpnZSxuZ0hpZGU6aGUsbmdJZjppZSxuZ0luY2x1ZGU6amUsbmdJbml0OmtlLG5nTm9uQmluZGFibGU6bGUsbmdQbHVyYWxpemU6bWUsbmdSZXBlYXQ6bmUsbmdTaG93Om9lLG5nU3R5bGU6cGUsbmdTd2l0Y2g6cWUsbmdTd2l0Y2hXaGVuOnJlLG5nU3dpdGNoRGVmYXVsdDpzZSxuZ09wdGlvbnM6dGUsbmdUcmFuc2NsdWRlOnVlLG5nTW9kZWw6dmUsbmdMaXN0OndlLG5nQ2hhbmdlOnhlLHBhdHRlcm46eWMsbmdQYXR0ZXJuOnljLHJlcXVpcmVkOnpjLG5nUmVxdWlyZWQ6emMsbWlubGVuZ3RoOkFjLG5nTWlubGVuZ3RoOkFjLG1heGxlbmd0aDpCYyxuZ01heGxlbmd0aDpCYyxuZ1ZhbHVlOnllLG5nTW9kZWxPcHRpb25zOnplfSkuZGlyZWN0aXZlKHtuZ0luY2x1ZGU6QWV9KS5kaXJlY3RpdmUodmIpLmRpcmVjdGl2ZShDYyk7XHJcbmEucHJvdmlkZXIoeyRhbmNob3JTY3JvbGw6QmUsJGFuaW1hdGU6Q2UsJGJyb3dzZXI6RGUsJGNhY2hlRmFjdG9yeTpFZSwkY29udHJvbGxlcjpGZSwkZG9jdW1lbnQ6R2UsJGV4Y2VwdGlvbkhhbmRsZXI6SGUsJGZpbHRlcjpEYywkaW50ZXJwb2xhdGU6SWUsJGludGVydmFsOkplLCRodHRwOktlLCRodHRwQmFja2VuZDpMZSwkbG9jYXRpb246TWUsJGxvZzpOZSwkcGFyc2U6T2UsJHJvb3RTY29wZTpQZSwkcTpRZSwkJHE6UmUsJHNjZTpTZSwkc2NlRGVsZWdhdGU6VGUsJHNuaWZmZXI6VWUsJHRlbXBsYXRlQ2FjaGU6VmUsJHRlbXBsYXRlUmVxdWVzdDpXZSwkJHRlc3RhYmlsaXR5OlhlLCR0aW1lb3V0OlllLCR3aW5kb3c6WmUsJCRyQUY6JGUsJCRhc3luY0NhbGxiYWNrOmFmLCQkanFMaXRlOmJmfSl9XSl9ZnVuY3Rpb24gY2IoYil7cmV0dXJuIGIucmVwbGFjZShjZixmdW5jdGlvbihhLGIsZCxlKXtyZXR1cm4gZT9kLnRvVXBwZXJDYXNlKCk6ZH0pLnJlcGxhY2UoZGYsXCJNb3okMVwiKX1cclxuZnVuY3Rpb24gRWMoYil7Yj1iLm5vZGVUeXBlO3JldHVybiBiPT09b2F8fCFifHw5PT09Yn1mdW5jdGlvbiBGYyhiLGEpe3ZhciBjLGQsZT1hLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxmPVtdO2lmKFJiLnRlc3QoYikpe2M9Y3x8ZS5hcHBlbmRDaGlsZChhLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIikpO2Q9KGVmLmV4ZWMoYil8fFtcIlwiLFwiXCJdKVsxXS50b0xvd2VyQ2FzZSgpO2Q9aWFbZF18fGlhLl9kZWZhdWx0O2MuaW5uZXJIVE1MPWRbMV0rYi5yZXBsYWNlKGZmLFwiPCQxPjwvJDI+XCIpK2RbMl07Zm9yKGQ9ZFswXTtkLS07KWM9Yy5sYXN0Q2hpbGQ7Zj1ZYShmLGMuY2hpbGROb2Rlcyk7Yz1lLmZpcnN0Q2hpbGQ7Yy50ZXh0Q29udGVudD1cIlwifWVsc2UgZi5wdXNoKGEuY3JlYXRlVGV4dE5vZGUoYikpO2UudGV4dENvbnRlbnQ9XCJcIjtlLmlubmVySFRNTD1cIlwiO3MoZixmdW5jdGlvbihhKXtlLmFwcGVuZENoaWxkKGEpfSk7cmV0dXJuIGV9ZnVuY3Rpb24gUihiKXtpZihiIGluc3RhbmNlb2ZcclxuUilyZXR1cm4gYjt2YXIgYTtGKGIpJiYoYj1VKGIpLGE9ITApO2lmKCEodGhpcyBpbnN0YW5jZW9mIFIpKXtpZihhJiZcIjxcIiE9Yi5jaGFyQXQoMCkpdGhyb3cgU2IoXCJub3NlbFwiKTtyZXR1cm4gbmV3IFIoYil9aWYoYSl7YT1ZO3ZhciBjO2I9KGM9Z2YuZXhlYyhiKSk/W2EuY3JlYXRlRWxlbWVudChjWzFdKV06KGM9RmMoYixhKSk/Yy5jaGlsZE5vZGVzOltdfUdjKHRoaXMsYil9ZnVuY3Rpb24gVGIoYil7cmV0dXJuIGIuY2xvbmVOb2RlKCEwKX1mdW5jdGlvbiB3YihiLGEpe2F8fHhiKGIpO2lmKGIucXVlcnlTZWxlY3RvckFsbClmb3IodmFyIGM9Yi5xdWVyeVNlbGVjdG9yQWxsKFwiKlwiKSxkPTAsZT1jLmxlbmd0aDtkPGU7ZCsrKXhiKGNbZF0pfWZ1bmN0aW9uIEhjKGIsYSxjLGQpe2lmKHkoZCkpdGhyb3cgU2IoXCJvZmZhcmdzXCIpO3ZhciBlPShkPXliKGIpKSYmZC5ldmVudHMsZj1kJiZkLmhhbmRsZTtpZihmKWlmKGEpcyhhLnNwbGl0KFwiIFwiKSxmdW5jdGlvbihhKXtpZih5KGMpKXt2YXIgZD1cclxuZVthXTtYYShkfHxbXSxjKTtpZihkJiYwPGQubGVuZ3RoKXJldHVybn1iLnJlbW92ZUV2ZW50TGlzdGVuZXIoYSxmLCExKTtkZWxldGUgZVthXX0pO2Vsc2UgZm9yKGEgaW4gZSlcIiRkZXN0cm95XCIhPT1hJiZiLnJlbW92ZUV2ZW50TGlzdGVuZXIoYSxmLCExKSxkZWxldGUgZVthXX1mdW5jdGlvbiB4YihiLGEpe3ZhciBjPWIubmczMzksZD1jJiZ6YltjXTtkJiYoYT9kZWxldGUgZC5kYXRhW2FdOihkLmhhbmRsZSYmKGQuZXZlbnRzLiRkZXN0cm95JiZkLmhhbmRsZSh7fSxcIiRkZXN0cm95XCIpLEhjKGIpKSxkZWxldGUgemJbY10sYi5uZzMzOT10KSl9ZnVuY3Rpb24geWIoYixhKXt2YXIgYz1iLm5nMzM5LGM9YyYmemJbY107YSYmIWMmJihiLm5nMzM5PWM9KytoZixjPXpiW2NdPXtldmVudHM6e30sZGF0YTp7fSxoYW5kbGU6dH0pO3JldHVybiBjfWZ1bmN0aW9uIFViKGIsYSxjKXtpZihFYyhiKSl7dmFyIGQ9eShjKSxlPSFkJiZhJiYhSShhKSxmPSFhO2I9KGI9eWIoYiwhZSkpJiZiLmRhdGE7XHJcbmlmKGQpYlthXT1jO2Vsc2V7aWYoZilyZXR1cm4gYjtpZihlKXJldHVybiBiJiZiW2FdO3ooYixhKX19fWZ1bmN0aW9uIEFiKGIsYSl7cmV0dXJuIGIuZ2V0QXR0cmlidXRlPy0xPChcIiBcIisoYi5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKXx8XCJcIikrXCIgXCIpLnJlcGxhY2UoL1tcXG5cXHRdL2csXCIgXCIpLmluZGV4T2YoXCIgXCIrYStcIiBcIik6ITF9ZnVuY3Rpb24gQmIoYixhKXthJiZiLnNldEF0dHJpYnV0ZSYmcyhhLnNwbGl0KFwiIFwiKSxmdW5jdGlvbihhKXtiLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsVSgoXCIgXCIrKGIuZ2V0QXR0cmlidXRlKFwiY2xhc3NcIil8fFwiXCIpK1wiIFwiKS5yZXBsYWNlKC9bXFxuXFx0XS9nLFwiIFwiKS5yZXBsYWNlKFwiIFwiK1UoYSkrXCIgXCIsXCIgXCIpKSl9KX1mdW5jdGlvbiBDYihiLGEpe2lmKGEmJmIuc2V0QXR0cmlidXRlKXt2YXIgYz0oXCIgXCIrKGIuZ2V0QXR0cmlidXRlKFwiY2xhc3NcIil8fFwiXCIpK1wiIFwiKS5yZXBsYWNlKC9bXFxuXFx0XS9nLFwiIFwiKTtzKGEuc3BsaXQoXCIgXCIpLGZ1bmN0aW9uKGEpe2E9XHJcblUoYSk7LTE9PT1jLmluZGV4T2YoXCIgXCIrYStcIiBcIikmJihjKz1hK1wiIFwiKX0pO2Iuc2V0QXR0cmlidXRlKFwiY2xhc3NcIixVKGMpKX19ZnVuY3Rpb24gR2MoYixhKXtpZihhKWlmKGEubm9kZVR5cGUpYltiLmxlbmd0aCsrXT1hO2Vsc2V7dmFyIGM9YS5sZW5ndGg7aWYoXCJudW1iZXJcIj09PXR5cGVvZiBjJiZhLndpbmRvdyE9PWEpe2lmKGMpZm9yKHZhciBkPTA7ZDxjO2QrKyliW2IubGVuZ3RoKytdPWFbZF19ZWxzZSBiW2IubGVuZ3RoKytdPWF9fWZ1bmN0aW9uIEljKGIsYSl7cmV0dXJuIERiKGIsXCIkXCIrKGF8fFwibmdDb250cm9sbGVyXCIpK1wiQ29udHJvbGxlclwiKX1mdW5jdGlvbiBEYihiLGEsYyl7OT09Yi5ub2RlVHlwZSYmKGI9Yi5kb2N1bWVudEVsZW1lbnQpO2ZvcihhPUQoYSk/YTpbYV07Yjspe2Zvcih2YXIgZD0wLGU9YS5sZW5ndGg7ZDxlO2QrKylpZigoYz1CLmRhdGEoYixhW2RdKSkhPT10KXJldHVybiBjO2I9Yi5wYXJlbnROb2RlfHwxMT09PWIubm9kZVR5cGUmJmIuaG9zdH19XHJcbmZ1bmN0aW9uIEpjKGIpe2Zvcih3YihiLCEwKTtiLmZpcnN0Q2hpbGQ7KWIucmVtb3ZlQ2hpbGQoYi5maXJzdENoaWxkKX1mdW5jdGlvbiBLYyhiLGEpe2F8fHdiKGIpO3ZhciBjPWIucGFyZW50Tm9kZTtjJiZjLnJlbW92ZUNoaWxkKGIpfWZ1bmN0aW9uIGpmKGIsYSl7YT1hfHxNO2lmKFwiY29tcGxldGVcIj09PWEuZG9jdW1lbnQucmVhZHlTdGF0ZSlhLnNldFRpbWVvdXQoYik7ZWxzZSBCKGEpLm9uKFwibG9hZFwiLGIpfWZ1bmN0aW9uIExjKGIsYSl7dmFyIGM9RWJbYS50b0xvd2VyQ2FzZSgpXTtyZXR1cm4gYyYmTWNbdWEoYildJiZjfWZ1bmN0aW9uIGtmKGIsYSl7dmFyIGM9Yi5ub2RlTmFtZTtyZXR1cm4oXCJJTlBVVFwiPT09Y3x8XCJURVhUQVJFQVwiPT09YykmJk5jW2FdfWZ1bmN0aW9uIGxmKGIsYSl7dmFyIGM9ZnVuY3Rpb24oYyxlKXtjLmlzRGVmYXVsdFByZXZlbnRlZD1mdW5jdGlvbigpe3JldHVybiBjLmRlZmF1bHRQcmV2ZW50ZWR9O3ZhciBmPWFbZXx8Yy50eXBlXSxnPWY/Zi5sZW5ndGg6XHJcbjA7aWYoZyl7aWYoQShjLmltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCkpe3ZhciBoPWMuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uO2Muc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uPWZ1bmN0aW9uKCl7Yy5pbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ9ITA7Yy5zdG9wUHJvcGFnYXRpb24mJmMuc3RvcFByb3BhZ2F0aW9uKCk7aCYmaC5jYWxsKGMpfX1jLmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkPWZ1bmN0aW9uKCl7cmV0dXJuITA9PT1jLmltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZH07MTxnJiYoZj1yYShmKSk7Zm9yKHZhciBsPTA7bDxnO2wrKyljLmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKCl8fGZbbF0uY2FsbChiLGMpfX07Yy5lbGVtPWI7cmV0dXJuIGN9ZnVuY3Rpb24gYmYoKXt0aGlzLiRnZXQ9ZnVuY3Rpb24oKXtyZXR1cm4geihSLHtoYXNDbGFzczpmdW5jdGlvbihiLGEpe2IuYXR0ciYmKGI9YlswXSk7cmV0dXJuIEFiKGIsYSl9LGFkZENsYXNzOmZ1bmN0aW9uKGIsXHJcbmEpe2IuYXR0ciYmKGI9YlswXSk7cmV0dXJuIENiKGIsYSl9LHJlbW92ZUNsYXNzOmZ1bmN0aW9uKGIsYSl7Yi5hdHRyJiYoYj1iWzBdKTtyZXR1cm4gQmIoYixhKX19KX19ZnVuY3Rpb24gTmEoYixhKXt2YXIgYz1iJiZiLiQkaGFzaEtleTtpZihjKXJldHVyblwiZnVuY3Rpb25cIj09PXR5cGVvZiBjJiYoYz1iLiQkaGFzaEtleSgpKSxjO2M9dHlwZW9mIGI7cmV0dXJuIGM9XCJmdW5jdGlvblwiPT1jfHxcIm9iamVjdFwiPT1jJiZudWxsIT09Yj9iLiQkaGFzaEtleT1jK1wiOlwiKyhhfHxGZCkoKTpjK1wiOlwiK2J9ZnVuY3Rpb24gZGIoYixhKXtpZihhKXt2YXIgYz0wO3RoaXMubmV4dFVpZD1mdW5jdGlvbigpe3JldHVybisrY319cyhiLHRoaXMucHV0LHRoaXMpfWZ1bmN0aW9uIG1mKGIpe3JldHVybihiPWIudG9TdHJpbmcoKS5yZXBsYWNlKE9jLFwiXCIpLm1hdGNoKFBjKSk/XCJmdW5jdGlvbihcIisoYlsxXXx8XCJcIikucmVwbGFjZSgvW1xcc1xcclxcbl0rLyxcIiBcIikrXCIpXCI6XCJmblwifWZ1bmN0aW9uIFZiKGIsXHJcbmEsYyl7dmFyIGQ7aWYoXCJmdW5jdGlvblwiPT09dHlwZW9mIGIpe2lmKCEoZD1iLiRpbmplY3QpKXtkPVtdO2lmKGIubGVuZ3RoKXtpZihhKXRocm93IEYoYykmJmN8fChjPWIubmFtZXx8bWYoYikpLEdhKFwic3RyaWN0ZGlcIixjKTthPWIudG9TdHJpbmcoKS5yZXBsYWNlKE9jLFwiXCIpO2E9YS5tYXRjaChQYyk7cyhhWzFdLnNwbGl0KG5mKSxmdW5jdGlvbihhKXthLnJlcGxhY2Uob2YsZnVuY3Rpb24oYSxiLGMpe2QucHVzaChjKX0pfSl9Yi4kaW5qZWN0PWR9fWVsc2UgRChiKT8oYT1iLmxlbmd0aC0xLHNiKGJbYV0sXCJmblwiKSxkPWIuc2xpY2UoMCxhKSk6c2IoYixcImZuXCIsITApO3JldHVybiBkfWZ1bmN0aW9uIE9iKGIsYSl7ZnVuY3Rpb24gYyhhKXtyZXR1cm4gZnVuY3Rpb24oYixjKXtpZihJKGIpKXMoYixrYyhhKSk7ZWxzZSByZXR1cm4gYShiLGMpfX1mdW5jdGlvbiBkKGEsYil7TWEoYSxcInNlcnZpY2VcIik7aWYoRyhiKXx8RChiKSliPXEuaW5zdGFudGlhdGUoYik7aWYoIWIuJGdldCl0aHJvdyBHYShcInBnZXRcIixcclxuYSk7cmV0dXJuIHBbYStcIlByb3ZpZGVyXCJdPWJ9ZnVuY3Rpb24gZShhLGIpe3JldHVybiBmdW5jdGlvbigpe3ZhciBjPXIuaW52b2tlKGIsdGhpcyk7aWYoQShjKSl0aHJvdyBHYShcInVuZGVmXCIsYSk7cmV0dXJuIGN9fWZ1bmN0aW9uIGYoYSxiLGMpe3JldHVybiBkKGEseyRnZXQ6ITEhPT1jP2UoYSxiKTpifSl9ZnVuY3Rpb24gZyhhKXt2YXIgYj1bXSxjO3MoYSxmdW5jdGlvbihhKXtmdW5jdGlvbiBkKGEpe3ZhciBiLGM7Yj0wO2ZvcihjPWEubGVuZ3RoO2I8YztiKyspe3ZhciBlPWFbYl0sZj1xLmdldChlWzBdKTtmW2VbMV1dLmFwcGx5KGYsZVsyXSl9fWlmKCFtLmdldChhKSl7bS5wdXQoYSwhMCk7dHJ5e0YoYSk/KGM9YmIoYSksYj1iLmNvbmNhdChnKGMucmVxdWlyZXMpKS5jb25jYXQoYy5fcnVuQmxvY2tzKSxkKGMuX2ludm9rZVF1ZXVlKSxkKGMuX2NvbmZpZ0Jsb2NrcykpOkcoYSk/Yi5wdXNoKHEuaW52b2tlKGEpKTpEKGEpP2IucHVzaChxLmludm9rZShhKSk6c2IoYSxcIm1vZHVsZVwiKX1jYXRjaChlKXt0aHJvdyBEKGEpJiZcclxuKGE9YVthLmxlbmd0aC0xXSksZS5tZXNzYWdlJiZlLnN0YWNrJiYtMT09ZS5zdGFjay5pbmRleE9mKGUubWVzc2FnZSkmJihlPWUubWVzc2FnZStcIlxcblwiK2Uuc3RhY2spLEdhKFwibW9kdWxlcnJcIixhLGUuc3RhY2t8fGUubWVzc2FnZXx8ZSk7fX19KTtyZXR1cm4gYn1mdW5jdGlvbiBoKGIsYyl7ZnVuY3Rpb24gZChhLGUpe2lmKGIuaGFzT3duUHJvcGVydHkoYSkpe2lmKGJbYV09PT1sKXRocm93IEdhKFwiY2RlcFwiLGErXCIgPC0gXCIray5qb2luKFwiIDwtIFwiKSk7cmV0dXJuIGJbYV19dHJ5e3JldHVybiBrLnVuc2hpZnQoYSksYlthXT1sLGJbYV09YyhhLGUpfWNhdGNoKGYpe3Rocm93IGJbYV09PT1sJiZkZWxldGUgYlthXSxmO31maW5hbGx5e2suc2hpZnQoKX19ZnVuY3Rpb24gZShiLGMsZixnKXtcInN0cmluZ1wiPT09dHlwZW9mIGYmJihnPWYsZj1udWxsKTt2YXIgaD1bXSxrPVZiKGIsYSxnKSxsLHEscDtxPTA7Zm9yKGw9ay5sZW5ndGg7cTxsO3ErKyl7cD1rW3FdO2lmKFwic3RyaW5nXCIhPT1cclxudHlwZW9mIHApdGhyb3cgR2EoXCJpdGtuXCIscCk7aC5wdXNoKGYmJmYuaGFzT3duUHJvcGVydHkocCk/ZltwXTpkKHAsZykpfUQoYikmJihiPWJbbF0pO3JldHVybiBiLmFwcGx5KGMsaCl9cmV0dXJue2ludm9rZTplLGluc3RhbnRpYXRlOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1PYmplY3QuY3JlYXRlKChEKGEpP2FbYS5sZW5ndGgtMV06YSkucHJvdG90eXBlKTthPWUoYSxkLGIsYyk7cmV0dXJuIEkoYSl8fEcoYSk/YTpkfSxnZXQ6ZCxhbm5vdGF0ZTpWYixoYXM6ZnVuY3Rpb24oYSl7cmV0dXJuIHAuaGFzT3duUHJvcGVydHkoYStcIlByb3ZpZGVyXCIpfHxiLmhhc093blByb3BlcnR5KGEpfX19YT0hMD09PWE7dmFyIGw9e30saz1bXSxtPW5ldyBkYihbXSwhMCkscD17JHByb3ZpZGU6e3Byb3ZpZGVyOmMoZCksZmFjdG9yeTpjKGYpLHNlcnZpY2U6YyhmdW5jdGlvbihhLGIpe3JldHVybiBmKGEsW1wiJGluamVjdG9yXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGEuaW5zdGFudGlhdGUoYil9XSl9KSxcclxudmFsdWU6YyhmdW5jdGlvbihhLGIpe3JldHVybiBmKGEsZGEoYiksITEpfSksY29uc3RhbnQ6YyhmdW5jdGlvbihhLGIpe01hKGEsXCJjb25zdGFudFwiKTtwW2FdPWI7dVthXT1ifSksZGVjb3JhdG9yOmZ1bmN0aW9uKGEsYil7dmFyIGM9cS5nZXQoYStcIlByb3ZpZGVyXCIpLGQ9Yy4kZ2V0O2MuJGdldD1mdW5jdGlvbigpe3ZhciBhPXIuaW52b2tlKGQsYyk7cmV0dXJuIHIuaW52b2tlKGIsbnVsbCx7JGRlbGVnYXRlOmF9KX19fX0scT1wLiRpbmplY3Rvcj1oKHAsZnVuY3Rpb24oYSxiKXtnYS5pc1N0cmluZyhiKSYmay5wdXNoKGIpO3Rocm93IEdhKFwidW5wclwiLGsuam9pbihcIiA8LSBcIikpO30pLHU9e30scj11LiRpbmplY3Rvcj1oKHUsZnVuY3Rpb24oYSxiKXt2YXIgYz1xLmdldChhK1wiUHJvdmlkZXJcIixiKTtyZXR1cm4gci5pbnZva2UoYy4kZ2V0LGMsdCxhKX0pO3MoZyhiKSxmdW5jdGlvbihhKXtyLmludm9rZShhfHxIKX0pO3JldHVybiByfWZ1bmN0aW9uIEJlKCl7dmFyIGI9ITA7dGhpcy5kaXNhYmxlQXV0b1Njcm9sbGluZz1cclxuZnVuY3Rpb24oKXtiPSExfTt0aGlzLiRnZXQ9W1wiJHdpbmRvd1wiLFwiJGxvY2F0aW9uXCIsXCIkcm9vdFNjb3BlXCIsZnVuY3Rpb24oYSxjLGQpe2Z1bmN0aW9uIGUoYSl7dmFyIGI9bnVsbDtBcnJheS5wcm90b3R5cGUuc29tZS5jYWxsKGEsZnVuY3Rpb24oYSl7aWYoXCJhXCI9PT11YShhKSlyZXR1cm4gYj1hLCEwfSk7cmV0dXJuIGJ9ZnVuY3Rpb24gZihiKXtpZihiKXtiLnNjcm9sbEludG9WaWV3KCk7dmFyIGM7Yz1nLnlPZmZzZXQ7RyhjKT9jPWMoKTptYyhjKT8oYz1jWzBdLGM9XCJmaXhlZFwiIT09YS5nZXRDb21wdXRlZFN0eWxlKGMpLnBvc2l0aW9uPzA6Yy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5ib3R0b20pOlYoYyl8fChjPTApO2MmJihiPWIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wLGEuc2Nyb2xsQnkoMCxiLWMpKX1lbHNlIGEuc2Nyb2xsVG8oMCwwKX1mdW5jdGlvbiBnKCl7dmFyIGE9Yy5oYXNoKCksYjthPyhiPWguZ2V0RWxlbWVudEJ5SWQoYSkpP2YoYik6KGI9ZShoLmdldEVsZW1lbnRzQnlOYW1lKGEpKSk/XHJcbmYoYik6XCJ0b3BcIj09PWEmJmYobnVsbCk6ZihudWxsKX12YXIgaD1hLmRvY3VtZW50O2ImJmQuJHdhdGNoKGZ1bmN0aW9uKCl7cmV0dXJuIGMuaGFzaCgpfSxmdW5jdGlvbihhLGIpe2E9PT1iJiZcIlwiPT09YXx8amYoZnVuY3Rpb24oKXtkLiRldmFsQXN5bmMoZyl9KX0pO3JldHVybiBnfV19ZnVuY3Rpb24gYWYoKXt0aGlzLiRnZXQ9W1wiJCRyQUZcIixcIiR0aW1lb3V0XCIsZnVuY3Rpb24oYixhKXtyZXR1cm4gYi5zdXBwb3J0ZWQ/ZnVuY3Rpb24oYSl7cmV0dXJuIGIoYSl9OmZ1bmN0aW9uKGIpe3JldHVybiBhKGIsMCwhMSl9fV19ZnVuY3Rpb24gcGYoYixhLGMsZCl7ZnVuY3Rpb24gZShhKXt0cnl7YS5hcHBseShudWxsLFphLmNhbGwoYXJndW1lbnRzLDEpKX1maW5hbGx5e2lmKHYtLSwwPT09dilmb3IoO3cubGVuZ3RoOyl0cnl7dy5wb3AoKSgpfWNhdGNoKGIpe2MuZXJyb3IoYil9fX1mdW5jdGlvbiBmKGEsYil7KGZ1bmN0aW9uIE4oKXtzKEwsZnVuY3Rpb24oYSl7YSgpfSk7Qz1iKE4sXHJcbmEpfSkoKX1mdW5jdGlvbiBnKCl7aCgpO2woKX1mdW5jdGlvbiBoKCl7eD1iLmhpc3Rvcnkuc3RhdGU7eD1BKHgpP251bGw6eDtmYSh4LEopJiYoeD1KKTtKPXh9ZnVuY3Rpb24gbCgpe2lmKEUhPT1tLnVybCgpfHxQIT09eClFPW0udXJsKCksUD14LHMoVyxmdW5jdGlvbihhKXthKG0udXJsKCkseCl9KX1mdW5jdGlvbiBrKGEpe3RyeXtyZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGEpfWNhdGNoKGIpe3JldHVybiBhfX12YXIgbT10aGlzLHA9YVswXSxxPWIubG9jYXRpb24sdT1iLmhpc3Rvcnkscj1iLnNldFRpbWVvdXQsTz1iLmNsZWFyVGltZW91dCxuPXt9O20uaXNNb2NrPSExO3ZhciB2PTAsdz1bXTttLiQkY29tcGxldGVPdXRzdGFuZGluZ1JlcXVlc3Q9ZTttLiQkaW5jT3V0c3RhbmRpbmdSZXF1ZXN0Q291bnQ9ZnVuY3Rpb24oKXt2Kyt9O20ubm90aWZ5V2hlbk5vT3V0c3RhbmRpbmdSZXF1ZXN0cz1mdW5jdGlvbihhKXtzKEwsZnVuY3Rpb24oYSl7YSgpfSk7MD09PXY/YSgpOlxyXG53LnB1c2goYSl9O3ZhciBMPVtdLEM7bS5hZGRQb2xsRm49ZnVuY3Rpb24oYSl7QShDKSYmZigxMDAscik7TC5wdXNoKGEpO3JldHVybiBhfTt2YXIgeCxQLEU9cS5ocmVmLFM9YS5maW5kKFwiYmFzZVwiKSxYPW51bGw7aCgpO1A9eDttLnVybD1mdW5jdGlvbihhLGMsZSl7QShlKSYmKGU9bnVsbCk7cSE9PWIubG9jYXRpb24mJihxPWIubG9jYXRpb24pO3UhPT1iLmhpc3RvcnkmJih1PWIuaGlzdG9yeSk7aWYoYSl7dmFyIGY9UD09PWU7aWYoRT09PWEmJighZC5oaXN0b3J5fHxmKSlyZXR1cm4gbTt2YXIgZz1FJiZIYShFKT09PUhhKGEpO0U9YTtQPWU7IWQuaGlzdG9yeXx8ZyYmZj8oZ3x8KFg9YSksYz9xLnJlcGxhY2UoYSk6Zz8oYz1xLGU9YS5pbmRleE9mKFwiI1wiKSxhPS0xPT09ZT9cIlwiOmEuc3Vic3RyKGUrMSksYy5oYXNoPWEpOnEuaHJlZj1hKToodVtjP1wicmVwbGFjZVN0YXRlXCI6XCJwdXNoU3RhdGVcIl0oZSxcIlwiLGEpLGgoKSxQPXgpO3JldHVybiBtfXJldHVybiBYfHxxLmhyZWYucmVwbGFjZSgvJTI3L2csXHJcblwiJ1wiKX07bS5zdGF0ZT1mdW5jdGlvbigpe3JldHVybiB4fTt2YXIgVz1bXSx3YT0hMSxKPW51bGw7bS5vblVybENoYW5nZT1mdW5jdGlvbihhKXtpZighd2Epe2lmKGQuaGlzdG9yeSlCKGIpLm9uKFwicG9wc3RhdGVcIixnKTtCKGIpLm9uKFwiaGFzaGNoYW5nZVwiLGcpO3dhPSEwfVcucHVzaChhKTtyZXR1cm4gYX07bS4kJGNoZWNrVXJsQ2hhbmdlPWw7bS5iYXNlSHJlZj1mdW5jdGlvbigpe3ZhciBhPVMuYXR0cihcImhyZWZcIik7cmV0dXJuIGE/YS5yZXBsYWNlKC9eKGh0dHBzP1xcOik/XFwvXFwvW15cXC9dKi8sXCJcIik6XCJcIn07dmFyIGVhPXt9LHk9XCJcIixjYT1tLmJhc2VIcmVmKCk7bS5jb29raWVzPWZ1bmN0aW9uKGEsYil7dmFyIGQsZSxmLGc7aWYoYSliPT09dD9wLmNvb2tpZT1lbmNvZGVVUklDb21wb25lbnQoYSkrXCI9O3BhdGg9XCIrY2ErXCI7ZXhwaXJlcz1UaHUsIDAxIEphbiAxOTcwIDAwOjAwOjAwIEdNVFwiOkYoYikmJihkPShwLmNvb2tpZT1lbmNvZGVVUklDb21wb25lbnQoYSkrXCI9XCIrZW5jb2RlVVJJQ29tcG9uZW50KGIpK1xyXG5cIjtwYXRoPVwiK2NhKS5sZW5ndGgrMSw0MDk2PGQmJmMud2FybihcIkNvb2tpZSAnXCIrYStcIicgcG9zc2libHkgbm90IHNldCBvciBvdmVyZmxvd2VkIGJlY2F1c2UgaXQgd2FzIHRvbyBsYXJnZSAoXCIrZCtcIiA+IDQwOTYgYnl0ZXMpIVwiKSk7ZWxzZXtpZihwLmNvb2tpZSE9PXkpZm9yKHk9cC5jb29raWUsZD15LnNwbGl0KFwiOyBcIiksZWE9e30sZj0wO2Y8ZC5sZW5ndGg7ZisrKWU9ZFtmXSxnPWUuaW5kZXhPZihcIj1cIiksMDxnJiYoYT1rKGUuc3Vic3RyaW5nKDAsZykpLGVhW2FdPT09dCYmKGVhW2FdPWsoZS5zdWJzdHJpbmcoZysxKSkpKTtyZXR1cm4gZWF9fTttLmRlZmVyPWZ1bmN0aW9uKGEsYil7dmFyIGM7disrO2M9cihmdW5jdGlvbigpe2RlbGV0ZSBuW2NdO2UoYSl9LGJ8fDApO25bY109ITA7cmV0dXJuIGN9O20uZGVmZXIuY2FuY2VsPWZ1bmN0aW9uKGEpe3JldHVybiBuW2FdPyhkZWxldGUgblthXSxPKGEpLGUoSCksITApOiExfX1mdW5jdGlvbiBEZSgpe3RoaXMuJGdldD1bXCIkd2luZG93XCIsXHJcblwiJGxvZ1wiLFwiJHNuaWZmZXJcIixcIiRkb2N1bWVudFwiLGZ1bmN0aW9uKGIsYSxjLGQpe3JldHVybiBuZXcgcGYoYixkLGEsYyl9XX1mdW5jdGlvbiBFZSgpe3RoaXMuJGdldD1mdW5jdGlvbigpe2Z1bmN0aW9uIGIoYixkKXtmdW5jdGlvbiBlKGEpe2EhPXAmJihxP3E9PWEmJihxPWEubik6cT1hLGYoYS5uLGEucCksZihhLHApLHA9YSxwLm49bnVsbCl9ZnVuY3Rpb24gZihhLGIpe2EhPWImJihhJiYoYS5wPWIpLGImJihiLm49YSkpfWlmKGIgaW4gYSl0aHJvdyBUKFwiJGNhY2hlRmFjdG9yeVwiKShcImlpZFwiLGIpO3ZhciBnPTAsaD16KHt9LGQse2lkOmJ9KSxsPXt9LGs9ZCYmZC5jYXBhY2l0eXx8TnVtYmVyLk1BWF9WQUxVRSxtPXt9LHA9bnVsbCxxPW51bGw7cmV0dXJuIGFbYl09e3B1dDpmdW5jdGlvbihhLGIpe2lmKGs8TnVtYmVyLk1BWF9WQUxVRSl7dmFyIGM9bVthXXx8KG1bYV09e2tleTphfSk7ZShjKX1pZighQShiKSlyZXR1cm4gYSBpbiBsfHxnKyssbFthXT1iLGc+ayYmdGhpcy5yZW1vdmUocS5rZXkpLFxyXG5ifSxnZXQ6ZnVuY3Rpb24oYSl7aWYoazxOdW1iZXIuTUFYX1ZBTFVFKXt2YXIgYj1tW2FdO2lmKCFiKXJldHVybjtlKGIpfXJldHVybiBsW2FdfSxyZW1vdmU6ZnVuY3Rpb24oYSl7aWYoazxOdW1iZXIuTUFYX1ZBTFVFKXt2YXIgYj1tW2FdO2lmKCFiKXJldHVybjtiPT1wJiYocD1iLnApO2I9PXEmJihxPWIubik7ZihiLm4sYi5wKTtkZWxldGUgbVthXX1kZWxldGUgbFthXTtnLS19LHJlbW92ZUFsbDpmdW5jdGlvbigpe2w9e307Zz0wO209e307cD1xPW51bGx9LGRlc3Ryb3k6ZnVuY3Rpb24oKXttPWg9bD1udWxsO2RlbGV0ZSBhW2JdfSxpbmZvOmZ1bmN0aW9uKCl7cmV0dXJuIHooe30saCx7c2l6ZTpnfSl9fX12YXIgYT17fTtiLmluZm89ZnVuY3Rpb24oKXt2YXIgYj17fTtzKGEsZnVuY3Rpb24oYSxlKXtiW2VdPWEuaW5mbygpfSk7cmV0dXJuIGJ9O2IuZ2V0PWZ1bmN0aW9uKGIpe3JldHVybiBhW2JdfTtyZXR1cm4gYn19ZnVuY3Rpb24gVmUoKXt0aGlzLiRnZXQ9W1wiJGNhY2hlRmFjdG9yeVwiLFxyXG5mdW5jdGlvbihiKXtyZXR1cm4gYihcInRlbXBsYXRlc1wiKX1dfWZ1bmN0aW9uIHdjKGIsYSl7ZnVuY3Rpb24gYyhhLGIpe3ZhciBjPS9eXFxzKihbQCZdfD0oXFwqPykpKFxcPz8pXFxzKihcXHcqKVxccyokLyxkPXt9O3MoYSxmdW5jdGlvbihhLGUpe3ZhciBmPWEubWF0Y2goYyk7aWYoIWYpdGhyb3cgamEoXCJpc2NwXCIsYixlLGEpO2RbZV09e21vZGU6ZlsxXVswXSxjb2xsZWN0aW9uOlwiKlwiPT09ZlsyXSxvcHRpb25hbDpcIj9cIj09PWZbM10sYXR0ck5hbWU6Zls0XXx8ZX19KTtyZXR1cm4gZH12YXIgZD17fSxlPS9eXFxzKmRpcmVjdGl2ZVxcOlxccyooW1xcd1xcLV0rKVxccysoLiopJC8sZj0vKChbXFx3XFwtXSspKD86XFw6KFteO10rKSk/Oz8pLyxnPUdkKFwibmdTcmMsbmdTcmNzZXQsc3JjLHNyY3NldFwiKSxoPS9eKD86KFxcXlxcXj8pPyhcXD8pPyhcXF5cXF4/KT8pPy8sbD0vXihvblthLXpdK3xmb3JtYWN0aW9uKSQvO3RoaXMuZGlyZWN0aXZlPWZ1bmN0aW9uIHAoYSxlKXtNYShhLFwiZGlyZWN0aXZlXCIpO0YoYSk/KFFiKGUsXHJcblwiZGlyZWN0aXZlRmFjdG9yeVwiKSxkLmhhc093blByb3BlcnR5KGEpfHwoZFthXT1bXSxiLmZhY3RvcnkoYStcIkRpcmVjdGl2ZVwiLFtcIiRpbmplY3RvclwiLFwiJGV4Y2VwdGlvbkhhbmRsZXJcIixmdW5jdGlvbihiLGUpe3ZhciBmPVtdO3MoZFthXSxmdW5jdGlvbihkLGcpe3RyeXt2YXIgaD1iLmludm9rZShkKTtHKGgpP2g9e2NvbXBpbGU6ZGEoaCl9OiFoLmNvbXBpbGUmJmgubGluayYmKGguY29tcGlsZT1kYShoLmxpbmspKTtoLnByaW9yaXR5PWgucHJpb3JpdHl8fDA7aC5pbmRleD1nO2gubmFtZT1oLm5hbWV8fGE7aC5yZXF1aXJlPWgucmVxdWlyZXx8aC5jb250cm9sbGVyJiZoLm5hbWU7aC5yZXN0cmljdD1oLnJlc3RyaWN0fHxcIkVBXCI7SShoLnNjb3BlKSYmKGguJCRpc29sYXRlQmluZGluZ3M9YyhoLnNjb3BlLGgubmFtZSkpO2YucHVzaChoKX1jYXRjaChsKXtlKGwpfX0pO3JldHVybiBmfV0pKSxkW2FdLnB1c2goZSkpOnMoYSxrYyhwKSk7cmV0dXJuIHRoaXN9O3RoaXMuYUhyZWZTYW5pdGl6YXRpb25XaGl0ZWxpc3Q9XHJcbmZ1bmN0aW9uKGIpe3JldHVybiB5KGIpPyhhLmFIcmVmU2FuaXRpemF0aW9uV2hpdGVsaXN0KGIpLHRoaXMpOmEuYUhyZWZTYW5pdGl6YXRpb25XaGl0ZWxpc3QoKX07dGhpcy5pbWdTcmNTYW5pdGl6YXRpb25XaGl0ZWxpc3Q9ZnVuY3Rpb24oYil7cmV0dXJuIHkoYik/KGEuaW1nU3JjU2FuaXRpemF0aW9uV2hpdGVsaXN0KGIpLHRoaXMpOmEuaW1nU3JjU2FuaXRpemF0aW9uV2hpdGVsaXN0KCl9O3ZhciBrPSEwO3RoaXMuZGVidWdJbmZvRW5hYmxlZD1mdW5jdGlvbihhKXtyZXR1cm4geShhKT8oaz1hLHRoaXMpOmt9O3RoaXMuJGdldD1bXCIkaW5qZWN0b3JcIixcIiRpbnRlcnBvbGF0ZVwiLFwiJGV4Y2VwdGlvbkhhbmRsZXJcIixcIiR0ZW1wbGF0ZVJlcXVlc3RcIixcIiRwYXJzZVwiLFwiJGNvbnRyb2xsZXJcIixcIiRyb290U2NvcGVcIixcIiRkb2N1bWVudFwiLFwiJHNjZVwiLFwiJGFuaW1hdGVcIixcIiQkc2FuaXRpemVVcmlcIixmdW5jdGlvbihhLGIsYyxyLE8sbix2LHcsTCxDLHgpe2Z1bmN0aW9uIFAoYSxiKXt0cnl7YS5hZGRDbGFzcyhiKX1jYXRjaChjKXt9fVxyXG5mdW5jdGlvbiBFKGEsYixjLGQsZSl7YSBpbnN0YW5jZW9mIEJ8fChhPUIoYSkpO3MoYSxmdW5jdGlvbihiLGMpe2Iubm9kZVR5cGU9PXBiJiZiLm5vZGVWYWx1ZS5tYXRjaCgvXFxTKy8pJiYoYVtjXT1CKGIpLndyYXAoXCI8c3Bhbj48L3NwYW4+XCIpLnBhcmVudCgpWzBdKX0pO3ZhciBmPVMoYSxiLGEsYyxkLGUpO0UuJCRhZGRTY29wZUNsYXNzKGEpO3ZhciBnPW51bGw7cmV0dXJuIGZ1bmN0aW9uKGIsYyxkKXtRYihiLFwic2NvcGVcIik7ZD1kfHx7fTt2YXIgZT1kLnBhcmVudEJvdW5kVHJhbnNjbHVkZUZuLGg9ZC50cmFuc2NsdWRlQ29udHJvbGxlcnM7ZD1kLmZ1dHVyZVBhcmVudEVsZW1lbnQ7ZSYmZS4kJGJvdW5kVHJhbnNjbHVkZSYmKGU9ZS4kJGJvdW5kVHJhbnNjbHVkZSk7Z3x8KGc9KGQ9ZCYmZFswXSk/XCJmb3JlaWdub2JqZWN0XCIhPT11YShkKSYmZC50b1N0cmluZygpLm1hdGNoKC9TVkcvKT9cInN2Z1wiOlwiaHRtbFwiOlwiaHRtbFwiKTtkPVwiaHRtbFwiIT09Zz9CKFdiKGcsQihcIjxkaXY+XCIpLmFwcGVuZChhKS5odG1sKCkpKTpcclxuYz9MYS5jbG9uZS5jYWxsKGEpOmE7aWYoaClmb3IodmFyIGwgaW4gaClkLmRhdGEoXCIkXCIrbCtcIkNvbnRyb2xsZXJcIixoW2xdLmluc3RhbmNlKTtFLiQkYWRkU2NvcGVJbmZvKGQsYik7YyYmYyhkLGIpO2YmJmYoYixkLGQsZSk7cmV0dXJuIGR9fWZ1bmN0aW9uIFMoYSxiLGMsZCxlLGYpe2Z1bmN0aW9uIGcoYSxjLGQsZSl7dmFyIGYsbCxrLHEscCxuLHc7aWYocilmb3Iodz1BcnJheShjLmxlbmd0aCkscT0wO3E8aC5sZW5ndGg7cSs9MylmPWhbcV0sd1tmXT1jW2ZdO2Vsc2Ugdz1jO3E9MDtmb3IocD1oLmxlbmd0aDtxPHA7KWw9d1toW3ErK11dLGM9aFtxKytdLGY9aFtxKytdLGM/KGMuc2NvcGU/KGs9YS4kbmV3KCksRS4kJGFkZFNjb3BlSW5mbyhCKGwpLGspKTprPWEsbj1jLnRyYW5zY2x1ZGVPblRoaXNFbGVtZW50P1goYSxjLnRyYW5zY2x1ZGUsZSxjLmVsZW1lbnRUcmFuc2NsdWRlT25UaGlzRWxlbWVudCk6IWMudGVtcGxhdGVPblRoaXNFbGVtZW50JiZlP2U6IWUmJmI/WChhLFxyXG5iKTpudWxsLGMoZixrLGwsZCxuKSk6ZiYmZihhLGwuY2hpbGROb2Rlcyx0LGUpfWZvcih2YXIgaD1bXSxsLGsscSxwLHIsbj0wO248YS5sZW5ndGg7bisrKXtsPW5ldyBYYjtrPVcoYVtuXSxbXSxsLDA9PT1uP2Q6dCxlKTsoZj1rLmxlbmd0aD9lYShrLGFbbl0sbCxiLGMsbnVsbCxbXSxbXSxmKTpudWxsKSYmZi5zY29wZSYmRS4kJGFkZFNjb3BlQ2xhc3MobC4kJGVsZW1lbnQpO2w9ZiYmZi50ZXJtaW5hbHx8IShxPWFbbl0uY2hpbGROb2Rlcyl8fCFxLmxlbmd0aD9udWxsOlMocSxmPyhmLnRyYW5zY2x1ZGVPblRoaXNFbGVtZW50fHwhZi50ZW1wbGF0ZU9uVGhpc0VsZW1lbnQpJiZmLnRyYW5zY2x1ZGU6Yik7aWYoZnx8bCloLnB1c2gobixmLGwpLHA9ITAscj1yfHxmO2Y9bnVsbH1yZXR1cm4gcD9nOm51bGx9ZnVuY3Rpb24gWChhLGIsYyxkKXtyZXR1cm4gZnVuY3Rpb24oZCxlLGYsZyxoKXtkfHwoZD1hLiRuZXcoITEsaCksZC4kJHRyYW5zY2x1ZGVkPSEwKTtyZXR1cm4gYihkLGUsXHJcbntwYXJlbnRCb3VuZFRyYW5zY2x1ZGVGbjpjLHRyYW5zY2x1ZGVDb250cm9sbGVyczpmLGZ1dHVyZVBhcmVudEVsZW1lbnQ6Z30pfX1mdW5jdGlvbiBXKGEsYixjLGQsZyl7dmFyIGg9Yy4kYXR0cixsO3N3aXRjaChhLm5vZGVUeXBlKXtjYXNlIG9hOmNhKGIseWEodWEoYSkpLFwiRVwiLGQsZyk7Zm9yKHZhciBrLHEscCxyPWEuYXR0cmlidXRlcyxuPTAsdz1yJiZyLmxlbmd0aDtuPHc7bisrKXt2YXIgTz0hMSxMPSExO2s9cltuXTtsPWsubmFtZTtxPVUoay52YWx1ZSk7az15YShsKTtpZihwPWZiLnRlc3QoaykpbD1sLnJlcGxhY2UoUmMsXCJcIikuc3Vic3RyKDgpLnJlcGxhY2UoL18oLikvZyxmdW5jdGlvbihhLGIpe3JldHVybiBiLnRvVXBwZXJDYXNlKCl9KTt2YXIgdT1rLnJlcGxhY2UoLyhTdGFydHxFbmQpJC8sXCJcIik7QSh1KSYmaz09PXUrXCJTdGFydFwiJiYoTz1sLEw9bC5zdWJzdHIoMCxsLmxlbmd0aC01KStcImVuZFwiLGw9bC5zdWJzdHIoMCxsLmxlbmd0aC02KSk7az15YShsLnRvTG93ZXJDYXNlKCkpO1xyXG5oW2tdPWw7aWYocHx8IWMuaGFzT3duUHJvcGVydHkoaykpY1trXT1xLExjKGEsaykmJihjW2tdPSEwKTtQYShhLGIscSxrLHApO2NhKGIsayxcIkFcIixkLGcsTyxMKX1hPWEuY2xhc3NOYW1lO2lmKEYoYSkmJlwiXCIhPT1hKWZvcig7bD1mLmV4ZWMoYSk7KWs9eWEobFsyXSksY2EoYixrLFwiQ1wiLGQsZykmJihjW2tdPVUobFszXSkpLGE9YS5zdWJzdHIobC5pbmRleCtsWzBdLmxlbmd0aCk7YnJlYWs7Y2FzZSBwYjpNKGIsYS5ub2RlVmFsdWUpO2JyZWFrO2Nhc2UgODp0cnl7aWYobD1lLmV4ZWMoYS5ub2RlVmFsdWUpKWs9eWEobFsxXSksY2EoYixrLFwiTVwiLGQsZykmJihjW2tdPVUobFsyXSkpfWNhdGNoKHYpe319Yi5zb3J0KE4pO3JldHVybiBifWZ1bmN0aW9uIHdhKGEsYixjKXt2YXIgZD1bXSxlPTA7aWYoYiYmYS5oYXNBdHRyaWJ1dGUmJmEuaGFzQXR0cmlidXRlKGIpKXtkb3tpZighYSl0aHJvdyBqYShcInV0ZXJkaXJcIixiLGMpO2Eubm9kZVR5cGU9PW9hJiYoYS5oYXNBdHRyaWJ1dGUoYikmJlxyXG5lKyssYS5oYXNBdHRyaWJ1dGUoYykmJmUtLSk7ZC5wdXNoKGEpO2E9YS5uZXh0U2libGluZ313aGlsZSgwPGUpfWVsc2UgZC5wdXNoKGEpO3JldHVybiBCKGQpfWZ1bmN0aW9uIEooYSxiLGMpe3JldHVybiBmdW5jdGlvbihkLGUsZixnLGgpe2U9d2EoZVswXSxiLGMpO3JldHVybiBhKGQsZSxmLGcsaCl9fWZ1bmN0aW9uIGVhKGEsZCxlLGYsZyxsLGsscCxyKXtmdW5jdGlvbiB3KGEsYixjLGQpe2lmKGEpe2MmJihhPUooYSxjLGQpKTthLnJlcXVpcmU9Sy5yZXF1aXJlO2EuZGlyZWN0aXZlTmFtZT16O2lmKFM9PT1LfHxLLiQkaXNvbGF0ZVNjb3BlKWE9WihhLHtpc29sYXRlU2NvcGU6ITB9KTtrLnB1c2goYSl9aWYoYil7YyYmKGI9SihiLGMsZCkpO2IucmVxdWlyZT1LLnJlcXVpcmU7Yi5kaXJlY3RpdmVOYW1lPXo7aWYoUz09PUt8fEsuJCRpc29sYXRlU2NvcGUpYj1aKGIse2lzb2xhdGVTY29wZTohMH0pO3AucHVzaChiKX19ZnVuY3Rpb24gTChhLGIsYyxkKXt2YXIgZSxmPVwiZGF0YVwiLFxyXG5nPSExLGw9YyxrO2lmKEYoYikpe2s9Yi5tYXRjaChoKTtiPWIuc3Vic3RyaW5nKGtbMF0ubGVuZ3RoKTtrWzNdJiYoa1sxXT9rWzNdPW51bGw6a1sxXT1rWzNdKTtcIl5cIj09PWtbMV0/Zj1cImluaGVyaXRlZERhdGFcIjpcIl5eXCI9PT1rWzFdJiYoZj1cImluaGVyaXRlZERhdGFcIixsPWMucGFyZW50KCkpO1wiP1wiPT09a1syXSYmKGc9ITApO2U9bnVsbDtkJiZcImRhdGFcIj09PWYmJihlPWRbYl0pJiYoZT1lLmluc3RhbmNlKTtlPWV8fGxbZl0oXCIkXCIrYitcIkNvbnRyb2xsZXJcIik7aWYoIWUmJiFnKXRocm93IGphKFwiY3RyZXFcIixiLGEpO3JldHVybiBlfHxudWxsfUQoYikmJihlPVtdLHMoYixmdW5jdGlvbihiKXtlLnB1c2goTChhLGIsYyxkKSl9KSk7cmV0dXJuIGV9ZnVuY3Rpb24gdihhLGMsZixnLGgpe2Z1bmN0aW9uIGwoYSxiLGMpe3ZhciBkO1ZhKGEpfHwoYz1iLGI9YSxhPXQpO0gmJihkPVApO2N8fChjPUg/Vy5wYXJlbnQoKTpXKTtyZXR1cm4gaChhLGIsZCxjLHdhKX12YXIgcix3LHUseCxcclxuUCxlYixXLEo7ZD09PWY/KEo9ZSxXPWUuJCRlbGVtZW50KTooVz1CKGYpLEo9bmV3IFhiKFcsZSkpO1MmJih4PWMuJG5ldyghMCkpO2gmJihlYj1sLGViLiQkYm91bmRUcmFuc2NsdWRlPWgpO0MmJihYPXt9LFA9e30scyhDLGZ1bmN0aW9uKGEpe3ZhciBiPXskc2NvcGU6YT09PVN8fGEuJCRpc29sYXRlU2NvcGU/eDpjLCRlbGVtZW50OlcsJGF0dHJzOkosJHRyYW5zY2x1ZGU6ZWJ9O3U9YS5jb250cm9sbGVyO1wiQFwiPT11JiYodT1KW2EubmFtZV0pO2I9bih1LGIsITAsYS5jb250cm9sbGVyQXMpO1BbYS5uYW1lXT1iO0h8fFcuZGF0YShcIiRcIithLm5hbWUrXCJDb250cm9sbGVyXCIsYi5pbnN0YW5jZSk7WFthLm5hbWVdPWJ9KSk7aWYoUyl7RS4kJGFkZFNjb3BlSW5mbyhXLHgsITAsIShrYSYmKGthPT09U3x8a2E9PT1TLiQkb3JpZ2luYWxEaXJlY3RpdmUpKSk7RS4kJGFkZFNjb3BlQ2xhc3MoVywhMCk7Zz1YJiZYW1MubmFtZV07dmFyIHhhPXg7ZyYmZy5pZGVudGlmaWVyJiYhMD09PVMuYmluZFRvQ29udHJvbGxlciYmXHJcbih4YT1nLmluc3RhbmNlKTtzKHguJCRpc29sYXRlQmluZGluZ3M9Uy4kJGlzb2xhdGVCaW5kaW5ncyxmdW5jdGlvbihhLGQpe3ZhciBlPWEuYXR0ck5hbWUsZj1hLm9wdGlvbmFsLGcsaCxsLGs7c3dpdGNoKGEubW9kZSl7Y2FzZSBcIkBcIjpKLiRvYnNlcnZlKGUsZnVuY3Rpb24oYSl7eGFbZF09YX0pO0ouJCRvYnNlcnZlcnNbZV0uJCRzY29wZT1jO0pbZV0mJih4YVtkXT1iKEpbZV0pKGMpKTticmVhaztjYXNlIFwiPVwiOmlmKGYmJiFKW2VdKWJyZWFrO2g9TyhKW2VdKTtrPWgubGl0ZXJhbD9mYTpmdW5jdGlvbihhLGIpe3JldHVybiBhPT09Ynx8YSE9PWEmJmIhPT1ifTtsPWguYXNzaWdufHxmdW5jdGlvbigpe2c9eGFbZF09aChjKTt0aHJvdyBqYShcIm5vbmFzc2lnblwiLEpbZV0sUy5uYW1lKTt9O2c9eGFbZF09aChjKTtmPWZ1bmN0aW9uKGEpe2soYSx4YVtkXSl8fChrKGEsZyk/bChjLGE9eGFbZF0pOnhhW2RdPWEpO3JldHVybiBnPWF9O2YuJHN0YXRlZnVsPSEwO2Y9YS5jb2xsZWN0aW9uP1xyXG5jLiR3YXRjaENvbGxlY3Rpb24oSltlXSxmKTpjLiR3YXRjaChPKEpbZV0sZiksbnVsbCxoLmxpdGVyYWwpO3guJG9uKFwiJGRlc3Ryb3lcIixmKTticmVhaztjYXNlIFwiJlwiOmg9TyhKW2VdKSx4YVtkXT1mdW5jdGlvbihhKXtyZXR1cm4gaChjLGEpfX19KX1YJiYocyhYLGZ1bmN0aW9uKGEpe2EoKX0pLFg9bnVsbCk7Zz0wO2ZvcihyPWsubGVuZ3RoO2c8cjtnKyspdz1rW2ddLCQodyx3Lmlzb2xhdGVTY29wZT94OmMsVyxKLHcucmVxdWlyZSYmTCh3LmRpcmVjdGl2ZU5hbWUsdy5yZXF1aXJlLFcsUCksZWIpO3ZhciB3YT1jO1MmJihTLnRlbXBsYXRlfHxudWxsPT09Uy50ZW1wbGF0ZVVybCkmJih3YT14KTthJiZhKHdhLGYuY2hpbGROb2Rlcyx0LGgpO2ZvcihnPXAubGVuZ3RoLTE7MDw9ZztnLS0pdz1wW2ddLCQodyx3Lmlzb2xhdGVTY29wZT94OmMsVyxKLHcucmVxdWlyZSYmTCh3LmRpcmVjdGl2ZU5hbWUsdy5yZXF1aXJlLFcsUCksZWIpfXI9cnx8e307Zm9yKHZhciB4PS1OdW1iZXIuTUFYX1ZBTFVFLFxyXG5QLEM9ci5jb250cm9sbGVyRGlyZWN0aXZlcyxYLFM9ci5uZXdJc29sYXRlU2NvcGVEaXJlY3RpdmUsa2E9ci50ZW1wbGF0ZURpcmVjdGl2ZSxlYT1yLm5vblRsYlRyYW5zY2x1ZGVEaXJlY3RpdmUsY2E9ITEsQT0hMSxIPXIuaGFzRWxlbWVudFRyYW5zY2x1ZGVEaXJlY3RpdmUsYWE9ZS4kJGVsZW1lbnQ9QihkKSxLLHosTixBYT1mLFEsTT0wLFI9YS5sZW5ndGg7TTxSO00rKyl7Sz1hW01dO3ZhciBQYT1LLiQkc3RhcnQsZmI9Sy4kJGVuZDtQYSYmKGFhPXdhKGQsUGEsZmIpKTtOPXQ7aWYoeD5LLnByaW9yaXR5KWJyZWFrO2lmKE49Sy5zY29wZSlLLnRlbXBsYXRlVXJsfHwoSShOKT8oT2EoXCJuZXcvaXNvbGF0ZWQgc2NvcGVcIixTfHxQLEssYWEpLFM9Syk6T2EoXCJuZXcvaXNvbGF0ZWQgc2NvcGVcIixTLEssYWEpKSxQPVB8fEs7ej1LLm5hbWU7IUsudGVtcGxhdGVVcmwmJksuY29udHJvbGxlciYmKE49Sy5jb250cm9sbGVyLEM9Q3x8e30sT2EoXCInXCIreitcIicgY29udHJvbGxlclwiLENbel0sXHJcbkssYWEpLENbel09Syk7aWYoTj1LLnRyYW5zY2x1ZGUpY2E9ITAsSy4kJHRsYnx8KE9hKFwidHJhbnNjbHVzaW9uXCIsZWEsSyxhYSksZWE9SyksXCJlbGVtZW50XCI9PU4/KEg9ITAseD1LLnByaW9yaXR5LE49YWEsYWE9ZS4kJGVsZW1lbnQ9QihZLmNyZWF0ZUNvbW1lbnQoXCIgXCIreitcIjogXCIrZVt6XStcIiBcIikpLGQ9YWFbMF0sVihnLFphLmNhbGwoTiwwKSxkKSxBYT1FKE4sZix4LGwmJmwubmFtZSx7bm9uVGxiVHJhbnNjbHVkZURpcmVjdGl2ZTplYX0pKTooTj1CKFRiKGQpKS5jb250ZW50cygpLGFhLmVtcHR5KCksQWE9RShOLGYpKTtpZihLLnRlbXBsYXRlKWlmKEE9ITAsT2EoXCJ0ZW1wbGF0ZVwiLGthLEssYWEpLGthPUssTj1HKEsudGVtcGxhdGUpP0sudGVtcGxhdGUoYWEsZSk6Sy50ZW1wbGF0ZSxOPVNjKE4pLEsucmVwbGFjZSl7bD1LO049UmIudGVzdChOKT9UYyhXYihLLnRlbXBsYXRlTmFtZXNwYWNlLFUoTikpKTpbXTtkPU5bMF07aWYoMSE9Ti5sZW5ndGh8fGQubm9kZVR5cGUhPT1cclxub2EpdGhyb3cgamEoXCJ0cGxydFwiLHosXCJcIik7VihnLGFhLGQpO1I9eyRhdHRyOnt9fTtOPVcoZCxbXSxSKTt2YXIgYmE9YS5zcGxpY2UoTSsxLGEubGVuZ3RoLShNKzEpKTtTJiZ5KE4pO2E9YS5jb25jYXQoTikuY29uY2F0KGJhKTtRYyhlLFIpO1I9YS5sZW5ndGh9ZWxzZSBhYS5odG1sKE4pO2lmKEsudGVtcGxhdGVVcmwpQT0hMCxPYShcInRlbXBsYXRlXCIsa2EsSyxhYSksa2E9SyxLLnJlcGxhY2UmJihsPUspLHY9VChhLnNwbGljZShNLGEubGVuZ3RoLU0pLGFhLGUsZyxjYSYmQWEsayxwLHtjb250cm9sbGVyRGlyZWN0aXZlczpDLG5ld0lzb2xhdGVTY29wZURpcmVjdGl2ZTpTLHRlbXBsYXRlRGlyZWN0aXZlOmthLG5vblRsYlRyYW5zY2x1ZGVEaXJlY3RpdmU6ZWF9KSxSPWEubGVuZ3RoO2Vsc2UgaWYoSy5jb21waWxlKXRyeXtRPUsuY29tcGlsZShhYSxlLEFhKSxHKFEpP3cobnVsbCxRLFBhLGZiKTpRJiZ3KFEucHJlLFEucG9zdCxQYSxmYil9Y2F0Y2gocWYpe2MocWYsdmEoYWEpKX1LLnRlcm1pbmFsJiZcclxuKHYudGVybWluYWw9ITAseD1NYXRoLm1heCh4LEsucHJpb3JpdHkpKX12LnNjb3BlPVAmJiEwPT09UC5zY29wZTt2LnRyYW5zY2x1ZGVPblRoaXNFbGVtZW50PWNhO3YuZWxlbWVudFRyYW5zY2x1ZGVPblRoaXNFbGVtZW50PUg7di50ZW1wbGF0ZU9uVGhpc0VsZW1lbnQ9QTt2LnRyYW5zY2x1ZGU9QWE7ci5oYXNFbGVtZW50VHJhbnNjbHVkZURpcmVjdGl2ZT1IO3JldHVybiB2fWZ1bmN0aW9uIHkoYSl7Zm9yKHZhciBiPTAsYz1hLmxlbmd0aDtiPGM7YisrKXt2YXIgZD1iLGU7ZT16KE9iamVjdC5jcmVhdGUoYVtiXSkseyQkaXNvbGF0ZVNjb3BlOiEwfSk7YVtkXT1lfX1mdW5jdGlvbiBjYShiLGUsZixnLGgsbCxrKXtpZihlPT09aClyZXR1cm4gbnVsbDtoPW51bGw7aWYoZC5oYXNPd25Qcm9wZXJ0eShlKSl7dmFyIHE7ZT1hLmdldChlK1wiRGlyZWN0aXZlXCIpO2Zvcih2YXIgcj0wLG49ZS5sZW5ndGg7cjxuO3IrKyl0cnl7aWYocT1lW3JdLChnPT09dHx8Zz5xLnByaW9yaXR5KSYmLTEhPVxyXG5xLnJlc3RyaWN0LmluZGV4T2YoZikpe2lmKGwpe3ZhciB3PXskJHN0YXJ0OmwsJCRlbmQ6a307cT16KE9iamVjdC5jcmVhdGUocSksdyl9Yi5wdXNoKHEpO2g9cX19Y2F0Y2goTyl7YyhPKX19cmV0dXJuIGh9ZnVuY3Rpb24gQShiKXtpZihkLmhhc093blByb3BlcnR5KGIpKWZvcih2YXIgYz1hLmdldChiK1wiRGlyZWN0aXZlXCIpLGU9MCxmPWMubGVuZ3RoO2U8ZjtlKyspaWYoYj1jW2VdLGIubXVsdGlFbGVtZW50KXJldHVybiEwO3JldHVybiExfWZ1bmN0aW9uIFFjKGEsYil7dmFyIGM9Yi4kYXR0cixkPWEuJGF0dHIsZT1hLiQkZWxlbWVudDtzKGEsZnVuY3Rpb24oZCxlKXtcIiRcIiE9ZS5jaGFyQXQoMCkmJihiW2VdJiZiW2VdIT09ZCYmKGQrPShcInN0eWxlXCI9PT1lP1wiO1wiOlwiIFwiKStiW2VdKSxhLiRzZXQoZSxkLCEwLGNbZV0pKX0pO3MoYixmdW5jdGlvbihiLGYpe1wiY2xhc3NcIj09Zj8oUChlLGIpLGFbXCJjbGFzc1wiXT0oYVtcImNsYXNzXCJdP2FbXCJjbGFzc1wiXStcIiBcIjpcIlwiKStiKTpcInN0eWxlXCI9PVxyXG5mPyhlLmF0dHIoXCJzdHlsZVwiLGUuYXR0cihcInN0eWxlXCIpK1wiO1wiK2IpLGEuc3R5bGU9KGEuc3R5bGU/YS5zdHlsZStcIjtcIjpcIlwiKStiKTpcIiRcIj09Zi5jaGFyQXQoMCl8fGEuaGFzT3duUHJvcGVydHkoZil8fChhW2ZdPWIsZFtmXT1jW2ZdKX0pfWZ1bmN0aW9uIFQoYSxiLGMsZCxlLGYsZyxoKXt2YXIgbD1bXSxrLHEscD1iWzBdLG49YS5zaGlmdCgpLHc9eih7fSxuLHt0ZW1wbGF0ZVVybDpudWxsLHRyYW5zY2x1ZGU6bnVsbCxyZXBsYWNlOm51bGwsJCRvcmlnaW5hbERpcmVjdGl2ZTpufSksTz1HKG4udGVtcGxhdGVVcmwpP24udGVtcGxhdGVVcmwoYixjKTpuLnRlbXBsYXRlVXJsLHU9bi50ZW1wbGF0ZU5hbWVzcGFjZTtiLmVtcHR5KCk7cihMLmdldFRydXN0ZWRSZXNvdXJjZVVybChPKSkudGhlbihmdW5jdGlvbihyKXt2YXIgTCx2O3I9U2Mocik7aWYobi5yZXBsYWNlKXtyPVJiLnRlc3Qocik/VGMoV2IodSxVKHIpKSk6W107TD1yWzBdO2lmKDEhPXIubGVuZ3RofHxMLm5vZGVUeXBlIT09XHJcbm9hKXRocm93IGphKFwidHBscnRcIixuLm5hbWUsTyk7cj17JGF0dHI6e319O1YoZCxiLEwpO3ZhciB4PVcoTCxbXSxyKTtJKG4uc2NvcGUpJiZ5KHgpO2E9eC5jb25jYXQoYSk7UWMoYyxyKX1lbHNlIEw9cCxiLmh0bWwocik7YS51bnNoaWZ0KHcpO2s9ZWEoYSxMLGMsZSxiLG4sZixnLGgpO3MoZCxmdW5jdGlvbihhLGMpe2E9PUwmJihkW2NdPWJbMF0pfSk7Zm9yKHE9UyhiWzBdLmNoaWxkTm9kZXMsZSk7bC5sZW5ndGg7KXtyPWwuc2hpZnQoKTt2PWwuc2hpZnQoKTt2YXIgQz1sLnNoaWZ0KCksRT1sLnNoaWZ0KCkseD1iWzBdO2lmKCFyLiQkZGVzdHJveWVkKXtpZih2IT09cCl7dmFyIEo9di5jbGFzc05hbWU7aC5oYXNFbGVtZW50VHJhbnNjbHVkZURpcmVjdGl2ZSYmbi5yZXBsYWNlfHwoeD1UYihMKSk7VihDLEIodikseCk7UChCKHgpLEopfXY9ay50cmFuc2NsdWRlT25UaGlzRWxlbWVudD9YKHIsay50cmFuc2NsdWRlLEUpOkU7ayhxLHIseCxkLHYpfX1sPW51bGx9KTtyZXR1cm4gZnVuY3Rpb24oYSxcclxuYixjLGQsZSl7YT1lO2IuJCRkZXN0cm95ZWR8fChsP2wucHVzaChiLGMsZCxhKTooay50cmFuc2NsdWRlT25UaGlzRWxlbWVudCYmKGE9WChiLGsudHJhbnNjbHVkZSxlKSksayhxLGIsYyxkLGEpKSl9fWZ1bmN0aW9uIE4oYSxiKXt2YXIgYz1iLnByaW9yaXR5LWEucHJpb3JpdHk7cmV0dXJuIDAhPT1jP2M6YS5uYW1lIT09Yi5uYW1lP2EubmFtZTxiLm5hbWU/LTE6MTphLmluZGV4LWIuaW5kZXh9ZnVuY3Rpb24gT2EoYSxiLGMsZCl7aWYoYil0aHJvdyBqYShcIm11bHRpZGlyXCIsYi5uYW1lLGMubmFtZSxhLHZhKGQpKTt9ZnVuY3Rpb24gTShhLGMpe3ZhciBkPWIoYywhMCk7ZCYmYS5wdXNoKHtwcmlvcml0eTowLGNvbXBpbGU6ZnVuY3Rpb24oYSl7YT1hLnBhcmVudCgpO3ZhciBiPSEhYS5sZW5ndGg7YiYmRS4kJGFkZEJpbmRpbmdDbGFzcyhhKTtyZXR1cm4gZnVuY3Rpb24oYSxjKXt2YXIgZT1jLnBhcmVudCgpO2J8fEUuJCRhZGRCaW5kaW5nQ2xhc3MoZSk7RS4kJGFkZEJpbmRpbmdJbmZvKGUsXHJcbmQuZXhwcmVzc2lvbnMpO2EuJHdhdGNoKGQsZnVuY3Rpb24oYSl7Y1swXS5ub2RlVmFsdWU9YX0pfX19KX1mdW5jdGlvbiBXYihhLGIpe2E9UShhfHxcImh0bWxcIik7c3dpdGNoKGEpe2Nhc2UgXCJzdmdcIjpjYXNlIFwibWF0aFwiOnZhciBjPVkuY3JlYXRlRWxlbWVudChcImRpdlwiKTtjLmlubmVySFRNTD1cIjxcIithK1wiPlwiK2IrXCI8L1wiK2ErXCI+XCI7cmV0dXJuIGMuY2hpbGROb2Rlc1swXS5jaGlsZE5vZGVzO2RlZmF1bHQ6cmV0dXJuIGJ9fWZ1bmN0aW9uIFIoYSxiKXtpZihcInNyY2RvY1wiPT1iKXJldHVybiBMLkhUTUw7dmFyIGM9dWEoYSk7aWYoXCJ4bGlua0hyZWZcIj09Ynx8XCJmb3JtXCI9PWMmJlwiYWN0aW9uXCI9PWJ8fFwiaW1nXCIhPWMmJihcInNyY1wiPT1ifHxcIm5nU3JjXCI9PWIpKXJldHVybiBMLlJFU09VUkNFX1VSTH1mdW5jdGlvbiBQYShhLGMsZCxlLGYpe3ZhciBoPVIoYSxlKTtmPWdbZV18fGY7dmFyIGs9YihkLCEwLGgsZik7aWYoayl7aWYoXCJtdWx0aXBsZVwiPT09ZSYmXCJzZWxlY3RcIj09PXVhKGEpKXRocm93IGphKFwic2VsbXVsdGlcIixcclxudmEoYSkpO2MucHVzaCh7cHJpb3JpdHk6MTAwLGNvbXBpbGU6ZnVuY3Rpb24oKXtyZXR1cm57cHJlOmZ1bmN0aW9uKGEsYyxnKXtjPWcuJCRvYnNlcnZlcnN8fChnLiQkb2JzZXJ2ZXJzPXt9KTtpZihsLnRlc3QoZSkpdGhyb3cgamEoXCJub2RvbWV2ZW50c1wiKTt2YXIgcD1nW2VdO3AhPT1kJiYoaz1wJiZiKHAsITAsaCxmKSxkPXApO2smJihnW2VdPWsoYSksKGNbZV18fChjW2VdPVtdKSkuJCRpbnRlcj0hMCwoZy4kJG9ic2VydmVycyYmZy4kJG9ic2VydmVyc1tlXS4kJHNjb3BlfHxhKS4kd2F0Y2goayxmdW5jdGlvbihhLGIpe1wiY2xhc3NcIj09PWUmJmEhPWI/Zy4kdXBkYXRlQ2xhc3MoYSxiKTpnLiRzZXQoZSxhKX0pKX19fX0pfX1mdW5jdGlvbiBWKGEsYixjKXt2YXIgZD1iWzBdLGU9Yi5sZW5ndGgsZj1kLnBhcmVudE5vZGUsZyxoO2lmKGEpZm9yKGc9MCxoPWEubGVuZ3RoO2c8aDtnKyspaWYoYVtnXT09ZCl7YVtnKytdPWM7aD1nK2UtMTtmb3IodmFyIGw9YS5sZW5ndGg7ZzxsO2crKyxcclxuaCsrKWg8bD9hW2ddPWFbaF06ZGVsZXRlIGFbZ107YS5sZW5ndGgtPWUtMTthLmNvbnRleHQ9PT1kJiYoYS5jb250ZXh0PWMpO2JyZWFrfWYmJmYucmVwbGFjZUNoaWxkKGMsZCk7YT1ZLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTthLmFwcGVuZENoaWxkKGQpO0IoYykuZGF0YShCKGQpLmRhdGEoKSk7c2E/KFBiPSEwLHNhLmNsZWFuRGF0YShbZF0pKTpkZWxldGUgQi5jYWNoZVtkW0IuZXhwYW5kb11dO2Q9MTtmb3IoZT1iLmxlbmd0aDtkPGU7ZCsrKWY9YltkXSxCKGYpLnJlbW92ZSgpLGEuYXBwZW5kQ2hpbGQoZiksZGVsZXRlIGJbZF07YlswXT1jO2IubGVuZ3RoPTF9ZnVuY3Rpb24gWihhLGIpe3JldHVybiB6KGZ1bmN0aW9uKCl7cmV0dXJuIGEuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxhLGIpfWZ1bmN0aW9uICQoYSxiLGQsZSxmLGcpe3RyeXthKGIsZCxlLGYsZyl9Y2F0Y2goaCl7YyhoLHZhKGQpKX19dmFyIFhiPWZ1bmN0aW9uKGEsYil7aWYoYil7dmFyIGM9T2JqZWN0LmtleXMoYiksXHJcbmQsZSxmO2Q9MDtmb3IoZT1jLmxlbmd0aDtkPGU7ZCsrKWY9Y1tkXSx0aGlzW2ZdPWJbZl19ZWxzZSB0aGlzLiRhdHRyPXt9O3RoaXMuJCRlbGVtZW50PWF9O1hiLnByb3RvdHlwZT17JG5vcm1hbGl6ZTp5YSwkYWRkQ2xhc3M6ZnVuY3Rpb24oYSl7YSYmMDxhLmxlbmd0aCYmQy5hZGRDbGFzcyh0aGlzLiQkZWxlbWVudCxhKX0sJHJlbW92ZUNsYXNzOmZ1bmN0aW9uKGEpe2EmJjA8YS5sZW5ndGgmJkMucmVtb3ZlQ2xhc3ModGhpcy4kJGVsZW1lbnQsYSl9LCR1cGRhdGVDbGFzczpmdW5jdGlvbihhLGIpe3ZhciBjPVVjKGEsYik7YyYmYy5sZW5ndGgmJkMuYWRkQ2xhc3ModGhpcy4kJGVsZW1lbnQsYyk7KGM9VWMoYixhKSkmJmMubGVuZ3RoJiZDLnJlbW92ZUNsYXNzKHRoaXMuJCRlbGVtZW50LGMpfSwkc2V0OmZ1bmN0aW9uKGEsYixkLGUpe3ZhciBmPXRoaXMuJCRlbGVtZW50WzBdLGc9TGMoZixhKSxoPWtmKGYsYSksZj1hO2c/KHRoaXMuJCRlbGVtZW50LnByb3AoYSxiKSxlPWcpOlxyXG5oJiYodGhpc1toXT1iLGY9aCk7dGhpc1thXT1iO2U/dGhpcy4kYXR0clthXT1lOihlPXRoaXMuJGF0dHJbYV0pfHwodGhpcy4kYXR0clthXT1lPXRjKGEsXCItXCIpKTtnPXVhKHRoaXMuJCRlbGVtZW50KTtpZihcImFcIj09PWcmJlwiaHJlZlwiPT09YXx8XCJpbWdcIj09PWcmJlwic3JjXCI9PT1hKXRoaXNbYV09Yj14KGIsXCJzcmNcIj09PWEpO2Vsc2UgaWYoXCJpbWdcIj09PWcmJlwic3Jjc2V0XCI9PT1hKXtmb3IodmFyIGc9XCJcIixoPVUoYiksbD0vKFxccytcXGQreFxccyosfFxccytcXGQrd1xccyosfFxccyssfCxcXHMrKS8sbD0vXFxzLy50ZXN0KGgpP2w6LygsKS8saD1oLnNwbGl0KGwpLGw9TWF0aC5mbG9vcihoLmxlbmd0aC8yKSxrPTA7azxsO2srKyl2YXIgcT0yKmssZz1nK3goVShoW3FdKSwhMCksZz1nKyhcIiBcIitVKGhbcSsxXSkpO2g9VShoWzIqa10pLnNwbGl0KC9cXHMvKTtnKz14KFUoaFswXSksITApOzI9PT1oLmxlbmd0aCYmKGcrPVwiIFwiK1UoaFsxXSkpO3RoaXNbYV09Yj1nfSExIT09ZCYmKG51bGw9PT1ifHxcclxuYj09PXQ/dGhpcy4kJGVsZW1lbnQucmVtb3ZlQXR0cihlKTp0aGlzLiQkZWxlbWVudC5hdHRyKGUsYikpOyhhPXRoaXMuJCRvYnNlcnZlcnMpJiZzKGFbZl0sZnVuY3Rpb24oYSl7dHJ5e2EoYil9Y2F0Y2goZCl7YyhkKX19KX0sJG9ic2VydmU6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGQ9Yy4kJG9ic2VydmVyc3x8KGMuJCRvYnNlcnZlcnM9aGEoKSksZT1kW2FdfHwoZFthXT1bXSk7ZS5wdXNoKGIpO3YuJGV2YWxBc3luYyhmdW5jdGlvbigpeyFlLiQkaW50ZXImJmMuaGFzT3duUHJvcGVydHkoYSkmJmIoY1thXSl9KTtyZXR1cm4gZnVuY3Rpb24oKXtYYShlLGIpfX19O3ZhciBBYT1iLnN0YXJ0U3ltYm9sKCksa2E9Yi5lbmRTeW1ib2woKSxTYz1cInt7XCI9PUFhfHxcIn19XCI9PWthP3BhOmZ1bmN0aW9uKGEpe3JldHVybiBhLnJlcGxhY2UoL1xce1xcey9nLEFhKS5yZXBsYWNlKC99fS9nLGthKX0sZmI9L15uZ0F0dHJbQS1aXS87RS4kJGFkZEJpbmRpbmdJbmZvPWs/ZnVuY3Rpb24oYSxiKXt2YXIgYz1cclxuYS5kYXRhKFwiJGJpbmRpbmdcIil8fFtdO0QoYik/Yz1jLmNvbmNhdChiKTpjLnB1c2goYik7YS5kYXRhKFwiJGJpbmRpbmdcIixjKX06SDtFLiQkYWRkQmluZGluZ0NsYXNzPWs/ZnVuY3Rpb24oYSl7UChhLFwibmctYmluZGluZ1wiKX06SDtFLiQkYWRkU2NvcGVJbmZvPWs/ZnVuY3Rpb24oYSxiLGMsZCl7YS5kYXRhKGM/ZD9cIiRpc29sYXRlU2NvcGVOb1RlbXBsYXRlXCI6XCIkaXNvbGF0ZVNjb3BlXCI6XCIkc2NvcGVcIixiKX06SDtFLiQkYWRkU2NvcGVDbGFzcz1rP2Z1bmN0aW9uKGEsYil7UChhLGI/XCJuZy1pc29sYXRlLXNjb3BlXCI6XCJuZy1zY29wZVwiKX06SDtyZXR1cm4gRX1dfWZ1bmN0aW9uIHlhKGIpe3JldHVybiBjYihiLnJlcGxhY2UoUmMsXCJcIikpfWZ1bmN0aW9uIFVjKGIsYSl7dmFyIGM9XCJcIixkPWIuc3BsaXQoL1xccysvKSxlPWEuc3BsaXQoL1xccysvKSxmPTA7YTpmb3IoO2Y8ZC5sZW5ndGg7ZisrKXtmb3IodmFyIGc9ZFtmXSxoPTA7aDxlLmxlbmd0aDtoKyspaWYoZz09ZVtoXSljb250aW51ZSBhO1xyXG5jKz0oMDxjLmxlbmd0aD9cIiBcIjpcIlwiKStnfXJldHVybiBjfWZ1bmN0aW9uIFRjKGIpe2I9QihiKTt2YXIgYT1iLmxlbmd0aDtpZigxPj1hKXJldHVybiBiO2Zvcig7YS0tOyk4PT09YlthXS5ub2RlVHlwZSYmcmYuY2FsbChiLGEsMSk7cmV0dXJuIGJ9ZnVuY3Rpb24gRmUoKXt2YXIgYj17fSxhPSExLGM9L14oXFxTKykoXFxzK2FzXFxzKyhcXHcrKSk/JC87dGhpcy5yZWdpc3Rlcj1mdW5jdGlvbihhLGMpe01hKGEsXCJjb250cm9sbGVyXCIpO0koYSk/eihiLGEpOmJbYV09Y307dGhpcy5hbGxvd0dsb2JhbHM9ZnVuY3Rpb24oKXthPSEwfTt0aGlzLiRnZXQ9W1wiJGluamVjdG9yXCIsXCIkd2luZG93XCIsZnVuY3Rpb24oZCxlKXtmdW5jdGlvbiBmKGEsYixjLGQpe2lmKCFhfHwhSShhLiRzY29wZSkpdGhyb3cgVChcIiRjb250cm9sbGVyXCIpKFwibm9zY3BcIixkLGIpO2EuJHNjb3BlW2JdPWN9cmV0dXJuIGZ1bmN0aW9uKGcsaCxsLGspe3ZhciBtLHAscTtsPSEwPT09bDtrJiZGKGspJiYocT1rKTtGKGcpJiZcclxuKGs9Zy5tYXRjaChjKSxwPWtbMV0scT1xfHxrWzNdLGc9Yi5oYXNPd25Qcm9wZXJ0eShwKT9iW3BdOnZjKGguJHNjb3BlLHAsITApfHwoYT92YyhlLHAsITApOnQpLHNiKGcscCwhMCkpO2lmKGwpcmV0dXJuIGw9KEQoZyk/Z1tnLmxlbmd0aC0xXTpnKS5wcm90b3R5cGUsbT1PYmplY3QuY3JlYXRlKGwpLHEmJmYoaCxxLG0scHx8Zy5uYW1lKSx6KGZ1bmN0aW9uKCl7ZC5pbnZva2UoZyxtLGgscCk7cmV0dXJuIG19LHtpbnN0YW5jZTptLGlkZW50aWZpZXI6cX0pO209ZC5pbnN0YW50aWF0ZShnLGgscCk7cSYmZihoLHEsbSxwfHxnLm5hbWUpO3JldHVybiBtfX1dfWZ1bmN0aW9uIEdlKCl7dGhpcy4kZ2V0PVtcIiR3aW5kb3dcIixmdW5jdGlvbihiKXtyZXR1cm4gQihiLmRvY3VtZW50KX1dfWZ1bmN0aW9uIEhlKCl7dGhpcy4kZ2V0PVtcIiRsb2dcIixmdW5jdGlvbihiKXtyZXR1cm4gZnVuY3Rpb24oYSxjKXtiLmVycm9yLmFwcGx5KGIsYXJndW1lbnRzKX19XX1mdW5jdGlvbiBZYihiLGEpe2lmKEYoYikpe3ZhciBjPVxyXG5iLnJlcGxhY2Uoc2YsXCJcIikudHJpbSgpO2lmKGMpe3ZhciBkPWEoXCJDb250ZW50LVR5cGVcIik7KGQ9ZCYmMD09PWQuaW5kZXhPZihWYykpfHwoZD0oZD1jLm1hdGNoKHRmKSkmJnVmW2RbMF1dLnRlc3QoYykpO2QmJihiPW9jKGMpKX19cmV0dXJuIGJ9ZnVuY3Rpb24gV2MoYil7dmFyIGE9aGEoKSxjLGQsZTtpZighYilyZXR1cm4gYTtzKGIuc3BsaXQoXCJcXG5cIiksZnVuY3Rpb24oYil7ZT1iLmluZGV4T2YoXCI6XCIpO2M9UShVKGIuc3Vic3RyKDAsZSkpKTtkPVUoYi5zdWJzdHIoZSsxKSk7YyYmKGFbY109YVtjXT9hW2NdK1wiLCBcIitkOmQpfSk7cmV0dXJuIGF9ZnVuY3Rpb24gWGMoYil7dmFyIGE9SShiKT9iOnQ7cmV0dXJuIGZ1bmN0aW9uKGMpe2F8fChhPVdjKGIpKTtyZXR1cm4gYz8oYz1hW1EoYyldLHZvaWQgMD09PWMmJihjPW51bGwpLGMpOmF9fWZ1bmN0aW9uIFljKGIsYSxjLGQpe2lmKEcoZCkpcmV0dXJuIGQoYixhLGMpO3MoZCxmdW5jdGlvbihkKXtiPWQoYixhLGMpfSk7cmV0dXJuIGJ9XHJcbmZ1bmN0aW9uIEtlKCl7dmFyIGI9dGhpcy5kZWZhdWx0cz17dHJhbnNmb3JtUmVzcG9uc2U6W1liXSx0cmFuc2Zvcm1SZXF1ZXN0OltmdW5jdGlvbihhKXtyZXR1cm4gSShhKSYmXCJbb2JqZWN0IEZpbGVdXCIhPT1EYS5jYWxsKGEpJiZcIltvYmplY3QgQmxvYl1cIiE9PURhLmNhbGwoYSkmJlwiW29iamVjdCBGb3JtRGF0YV1cIiE9PURhLmNhbGwoYSk/JGEoYSk6YX1dLGhlYWRlcnM6e2NvbW1vbjp7QWNjZXB0OlwiYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qXCJ9LHBvc3Q6cmEoWmIpLHB1dDpyYShaYikscGF0Y2g6cmEoWmIpfSx4c3JmQ29va2llTmFtZTpcIlhTUkYtVE9LRU5cIix4c3JmSGVhZGVyTmFtZTpcIlgtWFNSRi1UT0tFTlwifSxhPSExO3RoaXMudXNlQXBwbHlBc3luYz1mdW5jdGlvbihiKXtyZXR1cm4geShiKT8oYT0hIWIsdGhpcyk6YX07dmFyIGM9dGhpcy5pbnRlcmNlcHRvcnM9W107dGhpcy4kZ2V0PVtcIiRodHRwQmFja2VuZFwiLFwiJGJyb3dzZXJcIixcIiRjYWNoZUZhY3RvcnlcIixcclxuXCIkcm9vdFNjb3BlXCIsXCIkcVwiLFwiJGluamVjdG9yXCIsZnVuY3Rpb24oZCxlLGYsZyxoLGwpe2Z1bmN0aW9uIGsoYSl7ZnVuY3Rpb24gYyhhKXt2YXIgYj16KHt9LGEpO2IuZGF0YT1hLmRhdGE/WWMoYS5kYXRhLGEuaGVhZGVycyxhLnN0YXR1cyxlLnRyYW5zZm9ybVJlc3BvbnNlKTphLmRhdGE7YT1hLnN0YXR1cztyZXR1cm4gMjAwPD1hJiYzMDA+YT9iOmgucmVqZWN0KGIpfWZ1bmN0aW9uIGQoYSl7dmFyIGIsYz17fTtzKGEsZnVuY3Rpb24oYSxkKXtHKGEpPyhiPWEoKSxudWxsIT1iJiYoY1tkXT1iKSk6Y1tkXT1hfSk7cmV0dXJuIGN9aWYoIWdhLmlzT2JqZWN0KGEpKXRocm93IFQoXCIkaHR0cFwiKShcImJhZHJlcVwiLGEpO3ZhciBlPXooe21ldGhvZDpcImdldFwiLHRyYW5zZm9ybVJlcXVlc3Q6Yi50cmFuc2Zvcm1SZXF1ZXN0LHRyYW5zZm9ybVJlc3BvbnNlOmIudHJhbnNmb3JtUmVzcG9uc2V9LGEpO2UuaGVhZGVycz1mdW5jdGlvbihhKXt2YXIgYz1iLmhlYWRlcnMsZT16KHt9LGEuaGVhZGVycyksXHJcbmYsZyxjPXooe30sYy5jb21tb24sY1tRKGEubWV0aG9kKV0pO2E6Zm9yKGYgaW4gYyl7YT1RKGYpO2ZvcihnIGluIGUpaWYoUShnKT09PWEpY29udGludWUgYTtlW2ZdPWNbZl19cmV0dXJuIGQoZSl9KGEpO2UubWV0aG9kPXViKGUubWV0aG9kKTt2YXIgZj1bZnVuY3Rpb24oYSl7dmFyIGQ9YS5oZWFkZXJzLGU9WWMoYS5kYXRhLFhjKGQpLHQsYS50cmFuc2Zvcm1SZXF1ZXN0KTtBKGUpJiZzKGQsZnVuY3Rpb24oYSxiKXtcImNvbnRlbnQtdHlwZVwiPT09UShiKSYmZGVsZXRlIGRbYl19KTtBKGEud2l0aENyZWRlbnRpYWxzKSYmIUEoYi53aXRoQ3JlZGVudGlhbHMpJiYoYS53aXRoQ3JlZGVudGlhbHM9Yi53aXRoQ3JlZGVudGlhbHMpO3JldHVybiBtKGEsZSkudGhlbihjLGMpfSx0XSxnPWgud2hlbihlKTtmb3Iocyh1LGZ1bmN0aW9uKGEpeyhhLnJlcXVlc3R8fGEucmVxdWVzdEVycm9yKSYmZi51bnNoaWZ0KGEucmVxdWVzdCxhLnJlcXVlc3RFcnJvcik7KGEucmVzcG9uc2V8fGEucmVzcG9uc2VFcnJvcikmJlxyXG5mLnB1c2goYS5yZXNwb25zZSxhLnJlc3BvbnNlRXJyb3IpfSk7Zi5sZW5ndGg7KXthPWYuc2hpZnQoKTt2YXIgbD1mLnNoaWZ0KCksZz1nLnRoZW4oYSxsKX1nLnN1Y2Nlc3M9ZnVuY3Rpb24oYSl7Zy50aGVuKGZ1bmN0aW9uKGIpe2EoYi5kYXRhLGIuc3RhdHVzLGIuaGVhZGVycyxlKX0pO3JldHVybiBnfTtnLmVycm9yPWZ1bmN0aW9uKGEpe2cudGhlbihudWxsLGZ1bmN0aW9uKGIpe2EoYi5kYXRhLGIuc3RhdHVzLGIuaGVhZGVycyxlKX0pO3JldHVybiBnfTtyZXR1cm4gZ31mdW5jdGlvbiBtKGMsZil7ZnVuY3Rpb24gbChiLGMsZCxlKXtmdW5jdGlvbiBmKCl7bShjLGIsZCxlKX1QJiYoMjAwPD1iJiYzMDA+Yj9QLnB1dChYLFtiLGMsV2MoZCksZV0pOlAucmVtb3ZlKFgpKTthP2cuJGFwcGx5QXN5bmMoZik6KGYoKSxnLiQkcGhhc2V8fGcuJGFwcGx5KCkpfWZ1bmN0aW9uIG0oYSxiLGQsZSl7Yj1NYXRoLm1heChiLDApOygyMDA8PWImJjMwMD5iP0MucmVzb2x2ZTpDLnJlamVjdCkoe2RhdGE6YSxcclxuc3RhdHVzOmIsaGVhZGVyczpYYyhkKSxjb25maWc6YyxzdGF0dXNUZXh0OmV9KX1mdW5jdGlvbiB3KGEpe20oYS5kYXRhLGEuc3RhdHVzLHJhKGEuaGVhZGVycygpKSxhLnN0YXR1c1RleHQpfWZ1bmN0aW9uIHUoKXt2YXIgYT1rLnBlbmRpbmdSZXF1ZXN0cy5pbmRleE9mKGMpOy0xIT09YSYmay5wZW5kaW5nUmVxdWVzdHMuc3BsaWNlKGEsMSl9dmFyIEM9aC5kZWZlcigpLHg9Qy5wcm9taXNlLFAsRSxzPWMuaGVhZGVycyxYPXAoYy51cmwsYy5wYXJhbXMpO2sucGVuZGluZ1JlcXVlc3RzLnB1c2goYyk7eC50aGVuKHUsdSk7IWMuY2FjaGUmJiFiLmNhY2hlfHwhMT09PWMuY2FjaGV8fFwiR0VUXCIhPT1jLm1ldGhvZCYmXCJKU09OUFwiIT09Yy5tZXRob2R8fChQPUkoYy5jYWNoZSk/Yy5jYWNoZTpJKGIuY2FjaGUpP2IuY2FjaGU6cSk7UCYmKEU9UC5nZXQoWCkseShFKT9FJiZHKEUudGhlbik/RS50aGVuKHcsdyk6RChFKT9tKEVbMV0sRVswXSxyYShFWzJdKSxFWzNdKTptKEUsMjAwLHt9LFxyXG5cIk9LXCIpOlAucHV0KFgseCkpO0EoRSkmJigoRT1aYyhjLnVybCk/ZS5jb29raWVzKClbYy54c3JmQ29va2llTmFtZXx8Yi54c3JmQ29va2llTmFtZV06dCkmJihzW2MueHNyZkhlYWRlck5hbWV8fGIueHNyZkhlYWRlck5hbWVdPUUpLGQoYy5tZXRob2QsWCxmLGwscyxjLnRpbWVvdXQsYy53aXRoQ3JlZGVudGlhbHMsYy5yZXNwb25zZVR5cGUpKTtyZXR1cm4geH1mdW5jdGlvbiBwKGEsYil7aWYoIWIpcmV0dXJuIGE7dmFyIGM9W107RWQoYixmdW5jdGlvbihhLGIpe251bGw9PT1hfHxBKGEpfHwoRChhKXx8KGE9W2FdKSxzKGEsZnVuY3Rpb24oYSl7SShhKSYmKGE9cWEoYSk/YS50b0lTT1N0cmluZygpOiRhKGEpKTtjLnB1c2goRmEoYikrXCI9XCIrRmEoYSkpfSkpfSk7MDxjLmxlbmd0aCYmKGErPSgtMT09YS5pbmRleE9mKFwiP1wiKT9cIj9cIjpcIiZcIikrYy5qb2luKFwiJlwiKSk7cmV0dXJuIGF9dmFyIHE9ZihcIiRodHRwXCIpLHU9W107cyhjLGZ1bmN0aW9uKGEpe3UudW5zaGlmdChGKGEpP2wuZ2V0KGEpOlxyXG5sLmludm9rZShhKSl9KTtrLnBlbmRpbmdSZXF1ZXN0cz1bXTsoZnVuY3Rpb24oYSl7cyhhcmd1bWVudHMsZnVuY3Rpb24oYSl7a1thXT1mdW5jdGlvbihiLGMpe3JldHVybiBrKHooY3x8e30se21ldGhvZDphLHVybDpifSkpfX0pfSkoXCJnZXRcIixcImRlbGV0ZVwiLFwiaGVhZFwiLFwianNvbnBcIik7KGZ1bmN0aW9uKGEpe3MoYXJndW1lbnRzLGZ1bmN0aW9uKGEpe2tbYV09ZnVuY3Rpb24oYixjLGQpe3JldHVybiBrKHooZHx8e30se21ldGhvZDphLHVybDpiLGRhdGE6Y30pKX19KX0pKFwicG9zdFwiLFwicHV0XCIsXCJwYXRjaFwiKTtrLmRlZmF1bHRzPWI7cmV0dXJuIGt9XX1mdW5jdGlvbiB2Zigpe3JldHVybiBuZXcgTS5YTUxIdHRwUmVxdWVzdH1mdW5jdGlvbiBMZSgpe3RoaXMuJGdldD1bXCIkYnJvd3NlclwiLFwiJHdpbmRvd1wiLFwiJGRvY3VtZW50XCIsZnVuY3Rpb24oYixhLGMpe3JldHVybiB3ZihiLHZmLGIuZGVmZXIsYS5hbmd1bGFyLmNhbGxiYWNrcyxjWzBdKX1dfWZ1bmN0aW9uIHdmKGIsYSxjLFxyXG5kLGUpe2Z1bmN0aW9uIGYoYSxiLGMpe3ZhciBmPWUuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKSxtPW51bGw7Zi50eXBlPVwidGV4dC9qYXZhc2NyaXB0XCI7Zi5zcmM9YTtmLmFzeW5jPSEwO209ZnVuY3Rpb24oYSl7Zi5yZW1vdmVFdmVudExpc3RlbmVyKFwibG9hZFwiLG0sITEpO2YucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsbSwhMSk7ZS5ib2R5LnJlbW92ZUNoaWxkKGYpO2Y9bnVsbDt2YXIgZz0tMSx1PVwidW5rbm93blwiO2EmJihcImxvYWRcIiE9PWEudHlwZXx8ZFtiXS5jYWxsZWR8fChhPXt0eXBlOlwiZXJyb3JcIn0pLHU9YS50eXBlLGc9XCJlcnJvclwiPT09YS50eXBlPzQwNDoyMDApO2MmJmMoZyx1KX07Zi5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLG0sITEpO2YuYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsbSwhMSk7ZS5ib2R5LmFwcGVuZENoaWxkKGYpO3JldHVybiBtfXJldHVybiBmdW5jdGlvbihlLGgsbCxrLG0scCxxLHUpe2Z1bmN0aW9uIHIoKXt2JiZ2KCk7dyYmdy5hYm9ydCgpfVxyXG5mdW5jdGlvbiBPKGEsZCxlLGYsZyl7QyE9PXQmJmMuY2FuY2VsKEMpO3Y9dz1udWxsO2EoZCxlLGYsZyk7Yi4kJGNvbXBsZXRlT3V0c3RhbmRpbmdSZXF1ZXN0KEgpfWIuJCRpbmNPdXRzdGFuZGluZ1JlcXVlc3RDb3VudCgpO2g9aHx8Yi51cmwoKTtpZihcImpzb25wXCI9PVEoZSkpe3ZhciBuPVwiX1wiKyhkLmNvdW50ZXIrKykudG9TdHJpbmcoMzYpO2Rbbl09ZnVuY3Rpb24oYSl7ZFtuXS5kYXRhPWE7ZFtuXS5jYWxsZWQ9ITB9O3ZhciB2PWYoaC5yZXBsYWNlKFwiSlNPTl9DQUxMQkFDS1wiLFwiYW5ndWxhci5jYWxsYmFja3MuXCIrbiksbixmdW5jdGlvbihhLGIpe08oayxhLGRbbl0uZGF0YSxcIlwiLGIpO2Rbbl09SH0pfWVsc2V7dmFyIHc9YSgpO3cub3BlbihlLGgsITApO3MobSxmdW5jdGlvbihhLGIpe3koYSkmJncuc2V0UmVxdWVzdEhlYWRlcihiLGEpfSk7dy5vbmxvYWQ9ZnVuY3Rpb24oKXt2YXIgYT13LnN0YXR1c1RleHR8fFwiXCIsYj1cInJlc3BvbnNlXCJpbiB3P3cucmVzcG9uc2U6dy5yZXNwb25zZVRleHQsXHJcbmM9MTIyMz09PXcuc3RhdHVzPzIwNDp3LnN0YXR1czswPT09YyYmKGM9Yj8yMDA6XCJmaWxlXCI9PUJhKGgpLnByb3RvY29sPzQwNDowKTtPKGssYyxiLHcuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCksYSl9O2U9ZnVuY3Rpb24oKXtPKGssLTEsbnVsbCxudWxsLFwiXCIpfTt3Lm9uZXJyb3I9ZTt3Lm9uYWJvcnQ9ZTtxJiYody53aXRoQ3JlZGVudGlhbHM9ITApO2lmKHUpdHJ5e3cucmVzcG9uc2VUeXBlPXV9Y2F0Y2goTCl7aWYoXCJqc29uXCIhPT11KXRocm93IEw7fXcuc2VuZChsfHxudWxsKX1pZigwPHApdmFyIEM9YyhyLHApO2Vsc2UgcCYmRyhwLnRoZW4pJiZwLnRoZW4ocil9fWZ1bmN0aW9uIEllKCl7dmFyIGI9XCJ7e1wiLGE9XCJ9fVwiO3RoaXMuc3RhcnRTeW1ib2w9ZnVuY3Rpb24oYSl7cmV0dXJuIGE/KGI9YSx0aGlzKTpifTt0aGlzLmVuZFN5bWJvbD1mdW5jdGlvbihiKXtyZXR1cm4gYj8oYT1iLHRoaXMpOmF9O3RoaXMuJGdldD1bXCIkcGFyc2VcIixcIiRleGNlcHRpb25IYW5kbGVyXCIsXCIkc2NlXCIsXHJcbmZ1bmN0aW9uKGMsZCxlKXtmdW5jdGlvbiBmKGEpe3JldHVyblwiXFxcXFxcXFxcXFxcXCIrYX1mdW5jdGlvbiBnKGYsZyx1LHIpe2Z1bmN0aW9uIE8oYyl7cmV0dXJuIGMucmVwbGFjZShrLGIpLnJlcGxhY2UobSxhKX1mdW5jdGlvbiBuKGEpe3RyeXt2YXIgYj1hO2E9dT9lLmdldFRydXN0ZWQodSxiKTplLnZhbHVlT2YoYik7dmFyIGM7aWYociYmIXkoYSkpYz1hO2Vsc2UgaWYobnVsbD09YSljPVwiXCI7ZWxzZXtzd2l0Y2godHlwZW9mIGEpe2Nhc2UgXCJzdHJpbmdcIjpicmVhaztjYXNlIFwibnVtYmVyXCI6YT1cIlwiK2E7YnJlYWs7ZGVmYXVsdDphPSRhKGEpfWM9YX1yZXR1cm4gY31jYXRjaChnKXtjPSRiKFwiaW50ZXJyXCIsZixnLnRvU3RyaW5nKCkpLGQoYyl9fXI9ISFyO2Zvcih2YXIgdix3LEw9MCxDPVtdLHg9W10sUD1mLmxlbmd0aCxFPVtdLHM9W107TDxQOylpZigtMSE9KHY9Zi5pbmRleE9mKGIsTCkpJiYtMSE9KHc9Zi5pbmRleE9mKGEsditoKSkpTCE9PXYmJkUucHVzaChPKGYuc3Vic3RyaW5nKEwsXHJcbnYpKSksTD1mLnN1YnN0cmluZyh2K2gsdyksQy5wdXNoKEwpLHgucHVzaChjKEwsbikpLEw9dytsLHMucHVzaChFLmxlbmd0aCksRS5wdXNoKFwiXCIpO2Vsc2V7TCE9PVAmJkUucHVzaChPKGYuc3Vic3RyaW5nKEwpKSk7YnJlYWt9aWYodSYmMTxFLmxlbmd0aCl0aHJvdyAkYihcIm5vY29uY2F0XCIsZik7aWYoIWd8fEMubGVuZ3RoKXt2YXIgWD1mdW5jdGlvbihhKXtmb3IodmFyIGI9MCxjPUMubGVuZ3RoO2I8YztiKyspe2lmKHImJkEoYVtiXSkpcmV0dXJuO0Vbc1tiXV09YVtiXX1yZXR1cm4gRS5qb2luKFwiXCIpfTtyZXR1cm4geihmdW5jdGlvbihhKXt2YXIgYj0wLGM9Qy5sZW5ndGgsZT1BcnJheShjKTt0cnl7Zm9yKDtiPGM7YisrKWVbYl09eFtiXShhKTtyZXR1cm4gWChlKX1jYXRjaChnKXthPSRiKFwiaW50ZXJyXCIsZixnLnRvU3RyaW5nKCkpLGQoYSl9fSx7ZXhwOmYsZXhwcmVzc2lvbnM6QywkJHdhdGNoRGVsZWdhdGU6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkO3JldHVybiBhLiR3YXRjaEdyb3VwKHgsXHJcbmZ1bmN0aW9uKGMsZSl7dmFyIGY9WChjKTtHKGIpJiZiLmNhbGwodGhpcyxmLGMhPT1lP2Q6ZixhKTtkPWZ9LGMpfX0pfX12YXIgaD1iLmxlbmd0aCxsPWEubGVuZ3RoLGs9bmV3IFJlZ0V4cChiLnJlcGxhY2UoLy4vZyxmKSxcImdcIiksbT1uZXcgUmVnRXhwKGEucmVwbGFjZSgvLi9nLGYpLFwiZ1wiKTtnLnN0YXJ0U3ltYm9sPWZ1bmN0aW9uKCl7cmV0dXJuIGJ9O2cuZW5kU3ltYm9sPWZ1bmN0aW9uKCl7cmV0dXJuIGF9O3JldHVybiBnfV19ZnVuY3Rpb24gSmUoKXt0aGlzLiRnZXQ9W1wiJHJvb3RTY29wZVwiLFwiJHdpbmRvd1wiLFwiJHFcIixcIiQkcVwiLGZ1bmN0aW9uKGIsYSxjLGQpe2Z1bmN0aW9uIGUoZSxoLGwsayl7dmFyIG09YS5zZXRJbnRlcnZhbCxwPWEuY2xlYXJJbnRlcnZhbCxxPTAsdT15KGspJiYhayxyPSh1P2Q6YykuZGVmZXIoKSxPPXIucHJvbWlzZTtsPXkobCk/bDowO08udGhlbihudWxsLG51bGwsZSk7Ty4kJGludGVydmFsSWQ9bShmdW5jdGlvbigpe3Iubm90aWZ5KHErKyk7MDxcclxubCYmcT49bCYmKHIucmVzb2x2ZShxKSxwKE8uJCRpbnRlcnZhbElkKSxkZWxldGUgZltPLiQkaW50ZXJ2YWxJZF0pO3V8fGIuJGFwcGx5KCl9LGgpO2ZbTy4kJGludGVydmFsSWRdPXI7cmV0dXJuIE99dmFyIGY9e307ZS5jYW5jZWw9ZnVuY3Rpb24oYil7cmV0dXJuIGImJmIuJCRpbnRlcnZhbElkIGluIGY/KGZbYi4kJGludGVydmFsSWRdLnJlamVjdChcImNhbmNlbGVkXCIpLGEuY2xlYXJJbnRlcnZhbChiLiQkaW50ZXJ2YWxJZCksZGVsZXRlIGZbYi4kJGludGVydmFsSWRdLCEwKTohMX07cmV0dXJuIGV9XX1mdW5jdGlvbiBSZCgpe3RoaXMuJGdldD1mdW5jdGlvbigpe3JldHVybntpZDpcImVuLXVzXCIsTlVNQkVSX0ZPUk1BVFM6e0RFQ0lNQUxfU0VQOlwiLlwiLEdST1VQX1NFUDpcIixcIixQQVRURVJOUzpbe21pbkludDoxLG1pbkZyYWM6MCxtYXhGcmFjOjMscG9zUHJlOlwiXCIscG9zU3VmOlwiXCIsbmVnUHJlOlwiLVwiLG5lZ1N1ZjpcIlwiLGdTaXplOjMsbGdTaXplOjN9LHttaW5JbnQ6MSxtaW5GcmFjOjIsXHJcbm1heEZyYWM6Mixwb3NQcmU6XCJcXHUwMGE0XCIscG9zU3VmOlwiXCIsbmVnUHJlOlwiKFxcdTAwYTRcIixuZWdTdWY6XCIpXCIsZ1NpemU6MyxsZ1NpemU6M31dLENVUlJFTkNZX1NZTTpcIiRcIn0sREFURVRJTUVfRk9STUFUUzp7TU9OVEg6XCJKYW51YXJ5IEZlYnJ1YXJ5IE1hcmNoIEFwcmlsIE1heSBKdW5lIEp1bHkgQXVndXN0IFNlcHRlbWJlciBPY3RvYmVyIE5vdmVtYmVyIERlY2VtYmVyXCIuc3BsaXQoXCIgXCIpLFNIT1JUTU9OVEg6XCJKYW4gRmViIE1hciBBcHIgTWF5IEp1biBKdWwgQXVnIFNlcCBPY3QgTm92IERlY1wiLnNwbGl0KFwiIFwiKSxEQVk6XCJTdW5kYXkgTW9uZGF5IFR1ZXNkYXkgV2VkbmVzZGF5IFRodXJzZGF5IEZyaWRheSBTYXR1cmRheVwiLnNwbGl0KFwiIFwiKSxTSE9SVERBWTpcIlN1biBNb24gVHVlIFdlZCBUaHUgRnJpIFNhdFwiLnNwbGl0KFwiIFwiKSxBTVBNUzpbXCJBTVwiLFwiUE1cIl0sbWVkaXVtOlwiTU1NIGQsIHkgaDptbTpzcyBhXCIsXCJzaG9ydFwiOlwiTS9kL3l5IGg6bW0gYVwiLGZ1bGxEYXRlOlwiRUVFRSwgTU1NTSBkLCB5XCIsXHJcbmxvbmdEYXRlOlwiTU1NTSBkLCB5XCIsbWVkaXVtRGF0ZTpcIk1NTSBkLCB5XCIsc2hvcnREYXRlOlwiTS9kL3l5XCIsbWVkaXVtVGltZTpcImg6bW06c3MgYVwiLHNob3J0VGltZTpcImg6bW0gYVwifSxwbHVyYWxDYXQ6ZnVuY3Rpb24oYil7cmV0dXJuIDE9PT1iP1wib25lXCI6XCJvdGhlclwifX19fWZ1bmN0aW9uIGFjKGIpe2I9Yi5zcGxpdChcIi9cIik7Zm9yKHZhciBhPWIubGVuZ3RoO2EtLTspYlthXT1xYihiW2FdKTtyZXR1cm4gYi5qb2luKFwiL1wiKX1mdW5jdGlvbiAkYyhiLGEpe3ZhciBjPUJhKGIpO2EuJCRwcm90b2NvbD1jLnByb3RvY29sO2EuJCRob3N0PWMuaG9zdG5hbWU7YS4kJHBvcnQ9YmEoYy5wb3J0KXx8eGZbYy5wcm90b2NvbF18fG51bGx9ZnVuY3Rpb24gYWQoYixhKXt2YXIgYz1cIi9cIiE9PWIuY2hhckF0KDApO2MmJihiPVwiL1wiK2IpO3ZhciBkPUJhKGIpO2EuJCRwYXRoPWRlY29kZVVSSUNvbXBvbmVudChjJiZcIi9cIj09PWQucGF0aG5hbWUuY2hhckF0KDApP2QucGF0aG5hbWUuc3Vic3RyaW5nKDEpOlxyXG5kLnBhdGhuYW1lKTthLiQkc2VhcmNoPXFjKGQuc2VhcmNoKTthLiQkaGFzaD1kZWNvZGVVUklDb21wb25lbnQoZC5oYXNoKTthLiQkcGF0aCYmXCIvXCIhPWEuJCRwYXRoLmNoYXJBdCgwKSYmKGEuJCRwYXRoPVwiL1wiK2EuJCRwYXRoKX1mdW5jdGlvbiB6YShiLGEpe2lmKDA9PT1hLmluZGV4T2YoYikpcmV0dXJuIGEuc3Vic3RyKGIubGVuZ3RoKX1mdW5jdGlvbiBIYShiKXt2YXIgYT1iLmluZGV4T2YoXCIjXCIpO3JldHVybi0xPT1hP2I6Yi5zdWJzdHIoMCxhKX1mdW5jdGlvbiBiZChiKXtyZXR1cm4gYi5yZXBsYWNlKC8oIy4rKXwjJC8sXCIkMVwiKX1mdW5jdGlvbiBiYyhiKXtyZXR1cm4gYi5zdWJzdHIoMCxIYShiKS5sYXN0SW5kZXhPZihcIi9cIikrMSl9ZnVuY3Rpb24gY2MoYixhKXt0aGlzLiQkaHRtbDU9ITA7YT1hfHxcIlwiO3ZhciBjPWJjKGIpOyRjKGIsdGhpcyk7dGhpcy4kJHBhcnNlPWZ1bmN0aW9uKGEpe3ZhciBiPXphKGMsYSk7aWYoIUYoYikpdGhyb3cgRmIoXCJpcHRocHJmeFwiLGEsYyk7XHJcbmFkKGIsdGhpcyk7dGhpcy4kJHBhdGh8fCh0aGlzLiQkcGF0aD1cIi9cIik7dGhpcy4kJGNvbXBvc2UoKX07dGhpcy4kJGNvbXBvc2U9ZnVuY3Rpb24oKXt2YXIgYT1OYih0aGlzLiQkc2VhcmNoKSxiPXRoaXMuJCRoYXNoP1wiI1wiK3FiKHRoaXMuJCRoYXNoKTpcIlwiO3RoaXMuJCR1cmw9YWModGhpcy4kJHBhdGgpKyhhP1wiP1wiK2E6XCJcIikrYjt0aGlzLiQkYWJzVXJsPWMrdGhpcy4kJHVybC5zdWJzdHIoMSl9O3RoaXMuJCRwYXJzZUxpbmtVcmw9ZnVuY3Rpb24oZCxlKXtpZihlJiZcIiNcIj09PWVbMF0pcmV0dXJuIHRoaXMuaGFzaChlLnNsaWNlKDEpKSwhMDt2YXIgZixnOyhmPXphKGIsZCkpIT09dD8oZz1mLGc9KGY9emEoYSxmKSkhPT10P2MrKHphKFwiL1wiLGYpfHxmKTpiK2cpOihmPXphKGMsZCkpIT09dD9nPWMrZjpjPT1kK1wiL1wiJiYoZz1jKTtnJiZ0aGlzLiQkcGFyc2UoZyk7cmV0dXJuISFnfX1mdW5jdGlvbiBkYyhiLGEpe3ZhciBjPWJjKGIpOyRjKGIsdGhpcyk7dGhpcy4kJHBhcnNlPWZ1bmN0aW9uKGQpe2Q9XHJcbnphKGIsZCl8fHphKGMsZCk7dmFyIGU7XCIjXCI9PT1kLmNoYXJBdCgwKT8oZT16YShhLGQpLEEoZSkmJihlPWQpKTplPXRoaXMuJCRodG1sNT9kOlwiXCI7YWQoZSx0aGlzKTtkPXRoaXMuJCRwYXRoO3ZhciBmPS9eXFwvW0EtWl06KFxcLy4qKS87MD09PWUuaW5kZXhPZihiKSYmKGU9ZS5yZXBsYWNlKGIsXCJcIikpO2YuZXhlYyhlKXx8KGQ9KGU9Zi5leGVjKGQpKT9lWzFdOmQpO3RoaXMuJCRwYXRoPWQ7dGhpcy4kJGNvbXBvc2UoKX07dGhpcy4kJGNvbXBvc2U9ZnVuY3Rpb24oKXt2YXIgYz1OYih0aGlzLiQkc2VhcmNoKSxlPXRoaXMuJCRoYXNoP1wiI1wiK3FiKHRoaXMuJCRoYXNoKTpcIlwiO3RoaXMuJCR1cmw9YWModGhpcy4kJHBhdGgpKyhjP1wiP1wiK2M6XCJcIikrZTt0aGlzLiQkYWJzVXJsPWIrKHRoaXMuJCR1cmw/YSt0aGlzLiQkdXJsOlwiXCIpfTt0aGlzLiQkcGFyc2VMaW5rVXJsPWZ1bmN0aW9uKGEsYyl7cmV0dXJuIEhhKGIpPT1IYShhKT8odGhpcy4kJHBhcnNlKGEpLCEwKTohMX19ZnVuY3Rpb24gY2QoYixcclxuYSl7dGhpcy4kJGh0bWw1PSEwO2RjLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgYz1iYyhiKTt0aGlzLiQkcGFyc2VMaW5rVXJsPWZ1bmN0aW9uKGQsZSl7aWYoZSYmXCIjXCI9PT1lWzBdKXJldHVybiB0aGlzLmhhc2goZS5zbGljZSgxKSksITA7dmFyIGYsZztiPT1IYShkKT9mPWQ6KGc9emEoYyxkKSk/Zj1iK2ErZzpjPT09ZCtcIi9cIiYmKGY9Yyk7ZiYmdGhpcy4kJHBhcnNlKGYpO3JldHVybiEhZn07dGhpcy4kJGNvbXBvc2U9ZnVuY3Rpb24oKXt2YXIgYz1OYih0aGlzLiQkc2VhcmNoKSxlPXRoaXMuJCRoYXNoP1wiI1wiK3FiKHRoaXMuJCRoYXNoKTpcIlwiO3RoaXMuJCR1cmw9YWModGhpcy4kJHBhdGgpKyhjP1wiP1wiK2M6XCJcIikrZTt0aGlzLiQkYWJzVXJsPWIrYSt0aGlzLiQkdXJsfX1mdW5jdGlvbiBHYihiKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdGhpc1tiXX19ZnVuY3Rpb24gZGQoYixhKXtyZXR1cm4gZnVuY3Rpb24oYyl7aWYoQShjKSlyZXR1cm4gdGhpc1tiXTt0aGlzW2JdPVxyXG5hKGMpO3RoaXMuJCRjb21wb3NlKCk7cmV0dXJuIHRoaXN9fWZ1bmN0aW9uIE1lKCl7dmFyIGI9XCJcIixhPXtlbmFibGVkOiExLHJlcXVpcmVCYXNlOiEwLHJld3JpdGVMaW5rczohMH07dGhpcy5oYXNoUHJlZml4PWZ1bmN0aW9uKGEpe3JldHVybiB5KGEpPyhiPWEsdGhpcyk6Yn07dGhpcy5odG1sNU1vZGU9ZnVuY3Rpb24oYil7cmV0dXJuIFdhKGIpPyhhLmVuYWJsZWQ9Yix0aGlzKTpJKGIpPyhXYShiLmVuYWJsZWQpJiYoYS5lbmFibGVkPWIuZW5hYmxlZCksV2EoYi5yZXF1aXJlQmFzZSkmJihhLnJlcXVpcmVCYXNlPWIucmVxdWlyZUJhc2UpLFdhKGIucmV3cml0ZUxpbmtzKSYmKGEucmV3cml0ZUxpbmtzPWIucmV3cml0ZUxpbmtzKSx0aGlzKTphfTt0aGlzLiRnZXQ9W1wiJHJvb3RTY29wZVwiLFwiJGJyb3dzZXJcIixcIiRzbmlmZmVyXCIsXCIkcm9vdEVsZW1lbnRcIixcIiR3aW5kb3dcIixmdW5jdGlvbihjLGQsZSxmLGcpe2Z1bmN0aW9uIGgoYSxiLGMpe3ZhciBlPWsudXJsKCksZj1rLiQkc3RhdGU7XHJcbnRyeXtkLnVybChhLGIsYyksay4kJHN0YXRlPWQuc3RhdGUoKX1jYXRjaChnKXt0aHJvdyBrLnVybChlKSxrLiQkc3RhdGU9ZixnO319ZnVuY3Rpb24gbChhLGIpe2MuJGJyb2FkY2FzdChcIiRsb2NhdGlvbkNoYW5nZVN1Y2Nlc3NcIixrLmFic1VybCgpLGEsay4kJHN0YXRlLGIpfXZhciBrLG07bT1kLmJhc2VIcmVmKCk7dmFyIHA9ZC51cmwoKSxxO2lmKGEuZW5hYmxlZCl7aWYoIW0mJmEucmVxdWlyZUJhc2UpdGhyb3cgRmIoXCJub2Jhc2VcIik7cT1wLnN1YnN0cmluZygwLHAuaW5kZXhPZihcIi9cIixwLmluZGV4T2YoXCIvL1wiKSsyKSkrKG18fFwiL1wiKTttPWUuaGlzdG9yeT9jYzpjZH1lbHNlIHE9SGEocCksbT1kYztrPW5ldyBtKHEsXCIjXCIrYik7ay4kJHBhcnNlTGlua1VybChwLHApO2suJCRzdGF0ZT1kLnN0YXRlKCk7dmFyIHU9L15cXHMqKGphdmFzY3JpcHR8bWFpbHRvKTovaTtmLm9uKFwiY2xpY2tcIixmdW5jdGlvbihiKXtpZihhLnJld3JpdGVMaW5rcyYmIWIuY3RybEtleSYmIWIubWV0YUtleSYmXHJcbjIhPWIud2hpY2gpe2Zvcih2YXIgZT1CKGIudGFyZ2V0KTtcImFcIiE9PXVhKGVbMF0pOylpZihlWzBdPT09ZlswXXx8IShlPWUucGFyZW50KCkpWzBdKXJldHVybjt2YXIgaD1lLnByb3AoXCJocmVmXCIpLGw9ZS5hdHRyKFwiaHJlZlwiKXx8ZS5hdHRyKFwieGxpbms6aHJlZlwiKTtJKGgpJiZcIltvYmplY3QgU1ZHQW5pbWF0ZWRTdHJpbmddXCI9PT1oLnRvU3RyaW5nKCkmJihoPUJhKGguYW5pbVZhbCkuaHJlZik7dS50ZXN0KGgpfHwhaHx8ZS5hdHRyKFwidGFyZ2V0XCIpfHxiLmlzRGVmYXVsdFByZXZlbnRlZCgpfHwhay4kJHBhcnNlTGlua1VybChoLGwpfHwoYi5wcmV2ZW50RGVmYXVsdCgpLGsuYWJzVXJsKCkhPWQudXJsKCkmJihjLiRhcHBseSgpLGcuYW5ndWxhcltcImZmLTY4NDIwOC1wcmV2ZW50RGVmYXVsdFwiXT0hMCkpfX0pO2suYWJzVXJsKCkhPXAmJmQudXJsKGsuYWJzVXJsKCksITApO3ZhciByPSEwO2Qub25VcmxDaGFuZ2UoZnVuY3Rpb24oYSxiKXtjLiRldmFsQXN5bmMoZnVuY3Rpb24oKXt2YXIgZD1cclxuay5hYnNVcmwoKSxlPWsuJCRzdGF0ZSxmO2suJCRwYXJzZShhKTtrLiQkc3RhdGU9YjtmPWMuJGJyb2FkY2FzdChcIiRsb2NhdGlvbkNoYW5nZVN0YXJ0XCIsYSxkLGIsZSkuZGVmYXVsdFByZXZlbnRlZDtrLmFic1VybCgpPT09YSYmKGY/KGsuJCRwYXJzZShkKSxrLiQkc3RhdGU9ZSxoKGQsITEsZSkpOihyPSExLGwoZCxlKSkpfSk7Yy4kJHBoYXNlfHxjLiRkaWdlc3QoKX0pO2MuJHdhdGNoKGZ1bmN0aW9uKCl7dmFyIGE9YmQoZC51cmwoKSksYj1iZChrLmFic1VybCgpKSxmPWQuc3RhdGUoKSxnPWsuJCRyZXBsYWNlLHE9YSE9PWJ8fGsuJCRodG1sNSYmZS5oaXN0b3J5JiZmIT09ay4kJHN0YXRlO2lmKHJ8fHEpcj0hMSxjLiRldmFsQXN5bmMoZnVuY3Rpb24oKXt2YXIgYj1rLmFic1VybCgpLGQ9Yy4kYnJvYWRjYXN0KFwiJGxvY2F0aW9uQ2hhbmdlU3RhcnRcIixiLGEsay4kJHN0YXRlLGYpLmRlZmF1bHRQcmV2ZW50ZWQ7ay5hYnNVcmwoKT09PWImJihkPyhrLiQkcGFyc2UoYSksay4kJHN0YXRlPVxyXG5mKToocSYmaChiLGcsZj09PWsuJCRzdGF0ZT9udWxsOmsuJCRzdGF0ZSksbChhLGYpKSl9KTtrLiQkcmVwbGFjZT0hMX0pO3JldHVybiBrfV19ZnVuY3Rpb24gTmUoKXt2YXIgYj0hMCxhPXRoaXM7dGhpcy5kZWJ1Z0VuYWJsZWQ9ZnVuY3Rpb24oYSl7cmV0dXJuIHkoYSk/KGI9YSx0aGlzKTpifTt0aGlzLiRnZXQ9W1wiJHdpbmRvd1wiLGZ1bmN0aW9uKGMpe2Z1bmN0aW9uIGQoYSl7YSBpbnN0YW5jZW9mIEVycm9yJiYoYS5zdGFjaz9hPWEubWVzc2FnZSYmLTE9PT1hLnN0YWNrLmluZGV4T2YoYS5tZXNzYWdlKT9cIkVycm9yOiBcIithLm1lc3NhZ2UrXCJcXG5cIithLnN0YWNrOmEuc3RhY2s6YS5zb3VyY2VVUkwmJihhPWEubWVzc2FnZStcIlxcblwiK2Euc291cmNlVVJMK1wiOlwiK2EubGluZSkpO3JldHVybiBhfWZ1bmN0aW9uIGUoYSl7dmFyIGI9Yy5jb25zb2xlfHx7fSxlPWJbYV18fGIubG9nfHxIO2E9ITE7dHJ5e2E9ISFlLmFwcGx5fWNhdGNoKGwpe31yZXR1cm4gYT9mdW5jdGlvbigpe3ZhciBhPVxyXG5bXTtzKGFyZ3VtZW50cyxmdW5jdGlvbihiKXthLnB1c2goZChiKSl9KTtyZXR1cm4gZS5hcHBseShiLGEpfTpmdW5jdGlvbihhLGIpe2UoYSxudWxsPT1iP1wiXCI6Yil9fXJldHVybntsb2c6ZShcImxvZ1wiKSxpbmZvOmUoXCJpbmZvXCIpLHdhcm46ZShcIndhcm5cIiksZXJyb3I6ZShcImVycm9yXCIpLGRlYnVnOmZ1bmN0aW9uKCl7dmFyIGM9ZShcImRlYnVnXCIpO3JldHVybiBmdW5jdGlvbigpe2ImJmMuYXBwbHkoYSxhcmd1bWVudHMpfX0oKX19XX1mdW5jdGlvbiB0YShiLGEpe2lmKFwiX19kZWZpbmVHZXR0ZXJfX1wiPT09Ynx8XCJfX2RlZmluZVNldHRlcl9fXCI9PT1ifHxcIl9fbG9va3VwR2V0dGVyX19cIj09PWJ8fFwiX19sb29rdXBTZXR0ZXJfX1wiPT09Ynx8XCJfX3Byb3RvX19cIj09PWIpdGhyb3cgbGEoXCJpc2VjZmxkXCIsYSk7cmV0dXJuIGJ9ZnVuY3Rpb24gbWEoYixhKXtpZihiKXtpZihiLmNvbnN0cnVjdG9yPT09Yil0aHJvdyBsYShcImlzZWNmblwiLGEpO2lmKGIud2luZG93PT09Yil0aHJvdyBsYShcImlzZWN3aW5kb3dcIixcclxuYSk7aWYoYi5jaGlsZHJlbiYmKGIubm9kZU5hbWV8fGIucHJvcCYmYi5hdHRyJiZiLmZpbmQpKXRocm93IGxhKFwiaXNlY2RvbVwiLGEpO2lmKGI9PT1PYmplY3QpdGhyb3cgbGEoXCJpc2Vjb2JqXCIsYSk7fXJldHVybiBifWZ1bmN0aW9uIGVjKGIpe3JldHVybiBiLmNvbnN0YW50fWZ1bmN0aW9uIGdiKGIsYSxjLGQsZSl7bWEoYixlKTttYShhLGUpO2M9Yy5zcGxpdChcIi5cIik7Zm9yKHZhciBmLGc9MDsxPGMubGVuZ3RoO2crKyl7Zj10YShjLnNoaWZ0KCksZSk7dmFyIGg9MD09PWcmJmEmJmFbZl18fGJbZl07aHx8KGg9e30sYltmXT1oKTtiPW1hKGgsZSl9Zj10YShjLnNoaWZ0KCksZSk7bWEoYltmXSxlKTtyZXR1cm4gYltmXT1kfWZ1bmN0aW9uIFFhKGIpe3JldHVyblwiY29uc3RydWN0b3JcIj09Yn1mdW5jdGlvbiBlZChiLGEsYyxkLGUsZixnKXt0YShiLGYpO3RhKGEsZik7dGEoYyxmKTt0YShkLGYpO3RhKGUsZik7dmFyIGg9ZnVuY3Rpb24oYSl7cmV0dXJuIG1hKGEsZil9LGw9Z3x8UWEoYik/XHJcbmg6cGEsaz1nfHxRYShhKT9oOnBhLG09Z3x8UWEoYyk/aDpwYSxwPWd8fFFhKGQpP2g6cGEscT1nfHxRYShlKT9oOnBhO3JldHVybiBmdW5jdGlvbihmLGcpe3ZhciBoPWcmJmcuaGFzT3duUHJvcGVydHkoYik/ZzpmO2lmKG51bGw9PWgpcmV0dXJuIGg7aD1sKGhbYl0pO2lmKCFhKXJldHVybiBoO2lmKG51bGw9PWgpcmV0dXJuIHQ7aD1rKGhbYV0pO2lmKCFjKXJldHVybiBoO2lmKG51bGw9PWgpcmV0dXJuIHQ7aD1tKGhbY10pO2lmKCFkKXJldHVybiBoO2lmKG51bGw9PWgpcmV0dXJuIHQ7aD1wKGhbZF0pO3JldHVybiBlP251bGw9PWg/dDpoPXEoaFtlXSk6aH19ZnVuY3Rpb24geWYoYixhKXtyZXR1cm4gZnVuY3Rpb24oYyxkKXtyZXR1cm4gYihjLGQsbWEsYSl9fWZ1bmN0aW9uIHpmKGIsYSxjKXt2YXIgZD1hLmV4cGVuc2l2ZUNoZWNrcyxlPWQ/QWY6QmYsZj1lW2JdO2lmKGYpcmV0dXJuIGY7dmFyIGc9Yi5zcGxpdChcIi5cIiksaD1nLmxlbmd0aDtpZihhLmNzcClmPTY+aD9lZChnWzBdLFxyXG5nWzFdLGdbMl0sZ1szXSxnWzRdLGMsZCk6ZnVuY3Rpb24oYSxiKXt2YXIgZT0wLGY7ZG8gZj1lZChnW2UrK10sZ1tlKytdLGdbZSsrXSxnW2UrK10sZ1tlKytdLGMsZCkoYSxiKSxiPXQsYT1mO3doaWxlKGU8aCk7cmV0dXJuIGZ9O2Vsc2V7dmFyIGw9XCJcIjtkJiYobCs9XCJzID0gZXNvKHMsIGZlKTtcXG5sID0gZXNvKGwsIGZlKTtcXG5cIik7dmFyIGs9ZDtzKGcsZnVuY3Rpb24oYSxiKXt0YShhLGMpO3ZhciBlPShiP1wic1wiOicoKGwmJmwuaGFzT3duUHJvcGVydHkoXCInK2ErJ1wiKSk/bDpzKScpK1wiLlwiK2E7aWYoZHx8UWEoYSkpZT1cImVzbyhcIitlK1wiLCBmZSlcIixrPSEwO2wrPVwiaWYocyA9PSBudWxsKSByZXR1cm4gdW5kZWZpbmVkO1xcbnM9XCIrZStcIjtcXG5cIn0pO2wrPVwicmV0dXJuIHM7XCI7YT1uZXcgRnVuY3Rpb24oXCJzXCIsXCJsXCIsXCJlc29cIixcImZlXCIsbCk7YS50b1N0cmluZz1kYShsKTtrJiYoYT15ZihhLGMpKTtmPWF9Zi5zaGFyZWRHZXR0ZXI9ITA7Zi5hc3NpZ249ZnVuY3Rpb24oYSxjLGQpe3JldHVybiBnYihhLFxyXG5kLGIsYyxiKX07cmV0dXJuIGVbYl09Zn1mdW5jdGlvbiBmYyhiKXtyZXR1cm4gRyhiLnZhbHVlT2YpP2IudmFsdWVPZigpOkNmLmNhbGwoYil9ZnVuY3Rpb24gT2UoKXt2YXIgYj1oYSgpLGE9aGEoKTt0aGlzLiRnZXQ9W1wiJGZpbHRlclwiLFwiJHNuaWZmZXJcIixmdW5jdGlvbihjLGQpe2Z1bmN0aW9uIGUoYSl7dmFyIGI9YTthLnNoYXJlZEdldHRlciYmKGI9ZnVuY3Rpb24oYixjKXtyZXR1cm4gYShiLGMpfSxiLmxpdGVyYWw9YS5saXRlcmFsLGIuY29uc3RhbnQ9YS5jb25zdGFudCxiLmFzc2lnbj1hLmFzc2lnbik7cmV0dXJuIGJ9ZnVuY3Rpb24gZihhLGIpe2Zvcih2YXIgYz0wLGQ9YS5sZW5ndGg7YzxkO2MrKyl7dmFyIGU9YVtjXTtlLmNvbnN0YW50fHwoZS5pbnB1dHM/ZihlLmlucHV0cyxiKTotMT09PWIuaW5kZXhPZihlKSYmYi5wdXNoKGUpKX1yZXR1cm4gYn1mdW5jdGlvbiBnKGEsYil7cmV0dXJuIG51bGw9PWF8fG51bGw9PWI/YT09PWI6XCJvYmplY3RcIj09PXR5cGVvZiBhJiZcclxuKGE9ZmMoYSksXCJvYmplY3RcIj09PXR5cGVvZiBhKT8hMTphPT09Ynx8YSE9PWEmJmIhPT1ifWZ1bmN0aW9uIGgoYSxiLGMsZCl7dmFyIGU9ZC4kJGlucHV0c3x8KGQuJCRpbnB1dHM9ZihkLmlucHV0cyxbXSkpLGg7aWYoMT09PWUubGVuZ3RoKXt2YXIgbD1nLGU9ZVswXTtyZXR1cm4gYS4kd2F0Y2goZnVuY3Rpb24oYSl7dmFyIGI9ZShhKTtnKGIsbCl8fChoPWQoYSksbD1iJiZmYyhiKSk7cmV0dXJuIGh9LGIsYyl9Zm9yKHZhciBrPVtdLHE9MCxwPWUubGVuZ3RoO3E8cDtxKyspa1txXT1nO3JldHVybiBhLiR3YXRjaChmdW5jdGlvbihhKXtmb3IodmFyIGI9ITEsYz0wLGY9ZS5sZW5ndGg7YzxmO2MrKyl7dmFyIGw9ZVtjXShhKTtpZihifHwoYj0hZyhsLGtbY10pKSlrW2NdPWwmJmZjKGwpfWImJihoPWQoYSkpO3JldHVybiBofSxiLGMpfWZ1bmN0aW9uIGwoYSxiLGMsZCl7dmFyIGUsZjtyZXR1cm4gZT1hLiR3YXRjaChmdW5jdGlvbihhKXtyZXR1cm4gZChhKX0sZnVuY3Rpb24oYSxcclxuYyxkKXtmPWE7RyhiKSYmYi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7eShhKSYmZC4kJHBvc3REaWdlc3QoZnVuY3Rpb24oKXt5KGYpJiZlKCl9KX0sYyl9ZnVuY3Rpb24gayhhLGIsYyxkKXtmdW5jdGlvbiBlKGEpe3ZhciBiPSEwO3MoYSxmdW5jdGlvbihhKXt5KGEpfHwoYj0hMSl9KTtyZXR1cm4gYn12YXIgZixnO3JldHVybiBmPWEuJHdhdGNoKGZ1bmN0aW9uKGEpe3JldHVybiBkKGEpfSxmdW5jdGlvbihhLGMsZCl7Zz1hO0coYikmJmIuY2FsbCh0aGlzLGEsYyxkKTtlKGEpJiZkLiQkcG9zdERpZ2VzdChmdW5jdGlvbigpe2UoZykmJmYoKX0pfSxjKX1mdW5jdGlvbiBtKGEsYixjLGQpe3ZhciBlO3JldHVybiBlPWEuJHdhdGNoKGZ1bmN0aW9uKGEpe3JldHVybiBkKGEpfSxmdW5jdGlvbihhLGMsZCl7RyhiKSYmYi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7ZSgpfSxjKX1mdW5jdGlvbiBwKGEsYil7aWYoIWIpcmV0dXJuIGE7dmFyIGM9YS4kJHdhdGNoRGVsZWdhdGUsYz1jIT09ayYmXHJcbmMhPT1sP2Z1bmN0aW9uKGMsZCl7dmFyIGU9YShjLGQpO3JldHVybiBiKGUsYyxkKX06ZnVuY3Rpb24oYyxkKXt2YXIgZT1hKGMsZCksZj1iKGUsYyxkKTtyZXR1cm4geShlKT9mOmV9O2EuJCR3YXRjaERlbGVnYXRlJiZhLiQkd2F0Y2hEZWxlZ2F0ZSE9PWg/Yy4kJHdhdGNoRGVsZWdhdGU9YS4kJHdhdGNoRGVsZWdhdGU6Yi4kc3RhdGVmdWx8fChjLiQkd2F0Y2hEZWxlZ2F0ZT1oLGMuaW5wdXRzPVthXSk7cmV0dXJuIGN9dmFyIHE9e2NzcDpkLmNzcCxleHBlbnNpdmVDaGVja3M6ITF9LHU9e2NzcDpkLmNzcCxleHBlbnNpdmVDaGVja3M6ITB9O3JldHVybiBmdW5jdGlvbihkLGYsZyl7dmFyIHYsdyxMO3N3aXRjaCh0eXBlb2YgZCl7Y2FzZSBcInN0cmluZ1wiOkw9ZD1kLnRyaW0oKTt2YXIgQz1nP2E6Yjt2PUNbTF07dnx8KFwiOlwiPT09ZC5jaGFyQXQoMCkmJlwiOlwiPT09ZC5jaGFyQXQoMSkmJih3PSEwLGQ9ZC5zdWJzdHJpbmcoMikpLGc9Zz91OnEsdj1uZXcgZ2MoZyksdj0obmV3IGhiKHYsXHJcbmMsZykpLnBhcnNlKGQpLHYuY29uc3RhbnQ/di4kJHdhdGNoRGVsZWdhdGU9bTp3Pyh2PWUodiksdi4kJHdhdGNoRGVsZWdhdGU9di5saXRlcmFsP2s6bCk6di5pbnB1dHMmJih2LiQkd2F0Y2hEZWxlZ2F0ZT1oKSxDW0xdPXYpO3JldHVybiBwKHYsZik7Y2FzZSBcImZ1bmN0aW9uXCI6cmV0dXJuIHAoZCxmKTtkZWZhdWx0OnJldHVybiBwKEgsZil9fX1dfWZ1bmN0aW9uIFFlKCl7dGhpcy4kZ2V0PVtcIiRyb290U2NvcGVcIixcIiRleGNlcHRpb25IYW5kbGVyXCIsZnVuY3Rpb24oYixhKXtyZXR1cm4gZmQoZnVuY3Rpb24oYSl7Yi4kZXZhbEFzeW5jKGEpfSxhKX1dfWZ1bmN0aW9uIFJlKCl7dGhpcy4kZ2V0PVtcIiRicm93c2VyXCIsXCIkZXhjZXB0aW9uSGFuZGxlclwiLGZ1bmN0aW9uKGIsYSl7cmV0dXJuIGZkKGZ1bmN0aW9uKGEpe2IuZGVmZXIoYSl9LGEpfV19ZnVuY3Rpb24gZmQoYixhKXtmdW5jdGlvbiBjKGEsYixjKXtmdW5jdGlvbiBkKGIpe3JldHVybiBmdW5jdGlvbihjKXtlfHwoZT0hMCxcclxuYi5jYWxsKGEsYykpfX12YXIgZT0hMTtyZXR1cm5bZChiKSxkKGMpXX1mdW5jdGlvbiBkKCl7dGhpcy4kJHN0YXRlPXtzdGF0dXM6MH19ZnVuY3Rpb24gZShhLGIpe3JldHVybiBmdW5jdGlvbihjKXtiLmNhbGwoYSxjKX19ZnVuY3Rpb24gZihjKXshYy5wcm9jZXNzU2NoZWR1bGVkJiZjLnBlbmRpbmcmJihjLnByb2Nlc3NTY2hlZHVsZWQ9ITAsYihmdW5jdGlvbigpe3ZhciBiLGQsZTtlPWMucGVuZGluZztjLnByb2Nlc3NTY2hlZHVsZWQ9ITE7Yy5wZW5kaW5nPXQ7Zm9yKHZhciBmPTAsZz1lLmxlbmd0aDtmPGc7KytmKXtkPWVbZl1bMF07Yj1lW2ZdW2Muc3RhdHVzXTt0cnl7RyhiKT9kLnJlc29sdmUoYihjLnZhbHVlKSk6MT09PWMuc3RhdHVzP2QucmVzb2x2ZShjLnZhbHVlKTpkLnJlamVjdChjLnZhbHVlKX1jYXRjaChoKXtkLnJlamVjdChoKSxhKGgpfX19KSl9ZnVuY3Rpb24gZygpe3RoaXMucHJvbWlzZT1uZXcgZDt0aGlzLnJlc29sdmU9ZSh0aGlzLHRoaXMucmVzb2x2ZSk7XHJcbnRoaXMucmVqZWN0PWUodGhpcyx0aGlzLnJlamVjdCk7dGhpcy5ub3RpZnk9ZSh0aGlzLHRoaXMubm90aWZ5KX12YXIgaD1UKFwiJHFcIixUeXBlRXJyb3IpO2QucHJvdG90eXBlPXt0aGVuOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1uZXcgZzt0aGlzLiQkc3RhdGUucGVuZGluZz10aGlzLiQkc3RhdGUucGVuZGluZ3x8W107dGhpcy4kJHN0YXRlLnBlbmRpbmcucHVzaChbZCxhLGIsY10pOzA8dGhpcy4kJHN0YXRlLnN0YXR1cyYmZih0aGlzLiQkc3RhdGUpO3JldHVybiBkLnByb21pc2V9LFwiY2F0Y2hcIjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy50aGVuKG51bGwsYSl9LFwiZmluYWxseVwiOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMudGhlbihmdW5jdGlvbihiKXtyZXR1cm4gayhiLCEwLGEpfSxmdW5jdGlvbihiKXtyZXR1cm4gayhiLCExLGEpfSxiKX19O2cucHJvdG90eXBlPXtyZXNvbHZlOmZ1bmN0aW9uKGEpe3RoaXMucHJvbWlzZS4kJHN0YXRlLnN0YXR1c3x8KGE9PT10aGlzLnByb21pc2U/XHJcbnRoaXMuJCRyZWplY3QoaChcInFjeWNsZVwiLGEpKTp0aGlzLiQkcmVzb2x2ZShhKSl9LCQkcmVzb2x2ZTpmdW5jdGlvbihiKXt2YXIgZCxlO2U9Yyh0aGlzLHRoaXMuJCRyZXNvbHZlLHRoaXMuJCRyZWplY3QpO3RyeXtpZihJKGIpfHxHKGIpKWQ9YiYmYi50aGVuO0coZCk/KHRoaXMucHJvbWlzZS4kJHN0YXRlLnN0YXR1cz0tMSxkLmNhbGwoYixlWzBdLGVbMV0sdGhpcy5ub3RpZnkpKToodGhpcy5wcm9taXNlLiQkc3RhdGUudmFsdWU9Yix0aGlzLnByb21pc2UuJCRzdGF0ZS5zdGF0dXM9MSxmKHRoaXMucHJvbWlzZS4kJHN0YXRlKSl9Y2F0Y2goZyl7ZVsxXShnKSxhKGcpfX0scmVqZWN0OmZ1bmN0aW9uKGEpe3RoaXMucHJvbWlzZS4kJHN0YXRlLnN0YXR1c3x8dGhpcy4kJHJlamVjdChhKX0sJCRyZWplY3Q6ZnVuY3Rpb24oYSl7dGhpcy5wcm9taXNlLiQkc3RhdGUudmFsdWU9YTt0aGlzLnByb21pc2UuJCRzdGF0ZS5zdGF0dXM9MjtmKHRoaXMucHJvbWlzZS4kJHN0YXRlKX0sbm90aWZ5OmZ1bmN0aW9uKGMpe3ZhciBkPVxyXG50aGlzLnByb21pc2UuJCRzdGF0ZS5wZW5kaW5nOzA+PXRoaXMucHJvbWlzZS4kJHN0YXRlLnN0YXR1cyYmZCYmZC5sZW5ndGgmJmIoZnVuY3Rpb24oKXtmb3IodmFyIGIsZSxmPTAsZz1kLmxlbmd0aDtmPGc7ZisrKXtlPWRbZl1bMF07Yj1kW2ZdWzNdO3RyeXtlLm5vdGlmeShHKGIpP2IoYyk6Yyl9Y2F0Y2goaCl7YShoKX19fSl9fTt2YXIgbD1mdW5jdGlvbihhLGIpe3ZhciBjPW5ldyBnO2I/Yy5yZXNvbHZlKGEpOmMucmVqZWN0KGEpO3JldHVybiBjLnByb21pc2V9LGs9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPW51bGw7dHJ5e0coYykmJihkPWMoKSl9Y2F0Y2goZSl7cmV0dXJuIGwoZSwhMSl9cmV0dXJuIGQmJkcoZC50aGVuKT9kLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gbChhLGIpfSxmdW5jdGlvbihhKXtyZXR1cm4gbChhLCExKX0pOmwoYSxiKX0sbT1mdW5jdGlvbihhLGIsYyxkKXt2YXIgZT1uZXcgZztlLnJlc29sdmUoYSk7cmV0dXJuIGUucHJvbWlzZS50aGVuKGIsYyxkKX0sXHJcbnA9ZnVuY3Rpb24gdShhKXtpZighRyhhKSl0aHJvdyBoKFwibm9yc2x2clwiLGEpO2lmKCEodGhpcyBpbnN0YW5jZW9mIHUpKXJldHVybiBuZXcgdShhKTt2YXIgYj1uZXcgZzthKGZ1bmN0aW9uKGEpe2IucmVzb2x2ZShhKX0sZnVuY3Rpb24oYSl7Yi5yZWplY3QoYSl9KTtyZXR1cm4gYi5wcm9taXNlfTtwLmRlZmVyPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBnfTtwLnJlamVjdD1mdW5jdGlvbihhKXt2YXIgYj1uZXcgZztiLnJlamVjdChhKTtyZXR1cm4gYi5wcm9taXNlfTtwLndoZW49bTtwLmFsbD1mdW5jdGlvbihhKXt2YXIgYj1uZXcgZyxjPTAsZD1EKGEpP1tdOnt9O3MoYSxmdW5jdGlvbihhLGUpe2MrKzttKGEpLnRoZW4oZnVuY3Rpb24oYSl7ZC5oYXNPd25Qcm9wZXJ0eShlKXx8KGRbZV09YSwtLWN8fGIucmVzb2x2ZShkKSl9LGZ1bmN0aW9uKGEpe2QuaGFzT3duUHJvcGVydHkoZSl8fGIucmVqZWN0KGEpfSl9KTswPT09YyYmYi5yZXNvbHZlKGQpO3JldHVybiBiLnByb21pc2V9O1xyXG5yZXR1cm4gcH1mdW5jdGlvbiAkZSgpe3RoaXMuJGdldD1bXCIkd2luZG93XCIsXCIkdGltZW91dFwiLGZ1bmN0aW9uKGIsYSl7dmFyIGM9Yi5yZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGIud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lLGQ9Yi5jYW5jZWxBbmltYXRpb25GcmFtZXx8Yi53ZWJraXRDYW5jZWxBbmltYXRpb25GcmFtZXx8Yi53ZWJraXRDYW5jZWxSZXF1ZXN0QW5pbWF0aW9uRnJhbWUsZT0hIWMsZj1lP2Z1bmN0aW9uKGEpe3ZhciBiPWMoYSk7cmV0dXJuIGZ1bmN0aW9uKCl7ZChiKX19OmZ1bmN0aW9uKGIpe3ZhciBjPWEoYiwxNi42NiwhMSk7cmV0dXJuIGZ1bmN0aW9uKCl7YS5jYW5jZWwoYyl9fTtmLnN1cHBvcnRlZD1lO3JldHVybiBmfV19ZnVuY3Rpb24gUGUoKXt2YXIgYj0xMCxhPVQoXCIkcm9vdFNjb3BlXCIpLGM9bnVsbCxkPW51bGw7dGhpcy5kaWdlc3RUdGw9ZnVuY3Rpb24oYSl7YXJndW1lbnRzLmxlbmd0aCYmKGI9YSk7cmV0dXJuIGJ9O3RoaXMuJGdldD1bXCIkaW5qZWN0b3JcIixcclxuXCIkZXhjZXB0aW9uSGFuZGxlclwiLFwiJHBhcnNlXCIsXCIkYnJvd3NlclwiLGZ1bmN0aW9uKGUsZixnLGgpe2Z1bmN0aW9uIGwoKXt0aGlzLiRpZD0rK25iO3RoaXMuJCRwaGFzZT10aGlzLiRwYXJlbnQ9dGhpcy4kJHdhdGNoZXJzPXRoaXMuJCRuZXh0U2libGluZz10aGlzLiQkcHJldlNpYmxpbmc9dGhpcy4kJGNoaWxkSGVhZD10aGlzLiQkY2hpbGRUYWlsPW51bGw7dGhpcy4kcm9vdD10aGlzO3RoaXMuJCRkZXN0cm95ZWQ9ITE7dGhpcy4kJGxpc3RlbmVycz17fTt0aGlzLiQkbGlzdGVuZXJDb3VudD17fTt0aGlzLiQkaXNvbGF0ZUJpbmRpbmdzPW51bGx9ZnVuY3Rpb24gayhiKXtpZihyLiQkcGhhc2UpdGhyb3cgYShcImlucHJvZ1wiLHIuJCRwaGFzZSk7ci4kJHBoYXNlPWJ9ZnVuY3Rpb24gbShhLGIsYyl7ZG8gYS4kJGxpc3RlbmVyQ291bnRbY10tPWIsMD09PWEuJCRsaXN0ZW5lckNvdW50W2NdJiZkZWxldGUgYS4kJGxpc3RlbmVyQ291bnRbY107d2hpbGUoYT1hLiRwYXJlbnQpfWZ1bmN0aW9uIHAoKXt9XHJcbmZ1bmN0aW9uIHEoKXtmb3IoO3YubGVuZ3RoOyl0cnl7di5zaGlmdCgpKCl9Y2F0Y2goYSl7ZihhKX1kPW51bGx9ZnVuY3Rpb24gdSgpe251bGw9PT1kJiYoZD1oLmRlZmVyKGZ1bmN0aW9uKCl7ci4kYXBwbHkocSl9KSl9bC5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOmwsJG5ldzpmdW5jdGlvbihhLGIpe2Z1bmN0aW9uIGMoKXtkLiQkZGVzdHJveWVkPSEwfXZhciBkO2I9Ynx8dGhpczthPyhkPW5ldyBsLGQuJHJvb3Q9dGhpcy4kcm9vdCk6KHRoaXMuJCRDaGlsZFNjb3BlfHwodGhpcy4kJENoaWxkU2NvcGU9ZnVuY3Rpb24oKXt0aGlzLiQkd2F0Y2hlcnM9dGhpcy4kJG5leHRTaWJsaW5nPXRoaXMuJCRjaGlsZEhlYWQ9dGhpcy4kJGNoaWxkVGFpbD1udWxsO3RoaXMuJCRsaXN0ZW5lcnM9e307dGhpcy4kJGxpc3RlbmVyQ291bnQ9e307dGhpcy4kaWQ9KytuYjt0aGlzLiQkQ2hpbGRTY29wZT1udWxsfSx0aGlzLiQkQ2hpbGRTY29wZS5wcm90b3R5cGU9dGhpcyksZD1uZXcgdGhpcy4kJENoaWxkU2NvcGUpO1xyXG5kLiRwYXJlbnQ9YjtkLiQkcHJldlNpYmxpbmc9Yi4kJGNoaWxkVGFpbDtiLiQkY2hpbGRIZWFkPyhiLiQkY2hpbGRUYWlsLiQkbmV4dFNpYmxpbmc9ZCxiLiQkY2hpbGRUYWlsPWQpOmIuJCRjaGlsZEhlYWQ9Yi4kJGNoaWxkVGFpbD1kOyhhfHxiIT10aGlzKSYmZC4kb24oXCIkZGVzdHJveVwiLGMpO3JldHVybiBkfSwkd2F0Y2g6ZnVuY3Rpb24oYSxiLGQpe3ZhciBlPWcoYSk7aWYoZS4kJHdhdGNoRGVsZWdhdGUpcmV0dXJuIGUuJCR3YXRjaERlbGVnYXRlKHRoaXMsYixkLGUpO3ZhciBmPXRoaXMuJCR3YXRjaGVycyxoPXtmbjpiLGxhc3Q6cCxnZXQ6ZSxleHA6YSxlcTohIWR9O2M9bnVsbDtHKGIpfHwoaC5mbj1IKTtmfHwoZj10aGlzLiQkd2F0Y2hlcnM9W10pO2YudW5zaGlmdChoKTtyZXR1cm4gZnVuY3Rpb24oKXtYYShmLGgpO2M9bnVsbH19LCR3YXRjaEdyb3VwOmZ1bmN0aW9uKGEsYil7ZnVuY3Rpb24gYygpe2g9ITE7bD8obD0hMSxiKGUsZSxnKSk6YihlLGQsZyl9dmFyIGQ9QXJyYXkoYS5sZW5ndGgpLFxyXG5lPUFycmF5KGEubGVuZ3RoKSxmPVtdLGc9dGhpcyxoPSExLGw9ITA7aWYoIWEubGVuZ3RoKXt2YXIgaz0hMDtnLiRldmFsQXN5bmMoZnVuY3Rpb24oKXtrJiZiKGUsZSxnKX0pO3JldHVybiBmdW5jdGlvbigpe2s9ITF9fWlmKDE9PT1hLmxlbmd0aClyZXR1cm4gdGhpcy4kd2F0Y2goYVswXSxmdW5jdGlvbihhLGMsZil7ZVswXT1hO2RbMF09YztiKGUsYT09PWM/ZTpkLGYpfSk7cyhhLGZ1bmN0aW9uKGEsYil7dmFyIGw9Zy4kd2F0Y2goYSxmdW5jdGlvbihhLGYpe2VbYl09YTtkW2JdPWY7aHx8KGg9ITAsZy4kZXZhbEFzeW5jKGMpKX0pO2YucHVzaChsKX0pO3JldHVybiBmdW5jdGlvbigpe2Zvcig7Zi5sZW5ndGg7KWYuc2hpZnQoKSgpfX0sJHdhdGNoQ29sbGVjdGlvbjpmdW5jdGlvbihhLGIpe2Z1bmN0aW9uIGMoYSl7ZT1hO3ZhciBiLGQsZyxoO2lmKCFBKGUpKXtpZihJKGUpKWlmKFRhKGUpKWZvcihmIT09cSYmKGY9cSx1PWYubGVuZ3RoPTAsaysrKSxhPWUubGVuZ3RoLHUhPT1cclxuYSYmKGsrKyxmLmxlbmd0aD11PWEpLGI9MDtiPGE7YisrKWg9ZltiXSxnPWVbYl0sZD1oIT09aCYmZyE9PWcsZHx8aD09PWd8fChrKyssZltiXT1nKTtlbHNle2YhPT1tJiYoZj1tPXt9LHU9MCxrKyspO2E9MDtmb3IoYiBpbiBlKWUuaGFzT3duUHJvcGVydHkoYikmJihhKyssZz1lW2JdLGg9ZltiXSxiIGluIGY/KGQ9aCE9PWgmJmchPT1nLGR8fGg9PT1nfHwoaysrLGZbYl09ZykpOih1KyssZltiXT1nLGsrKykpO2lmKHU+YSlmb3IoYiBpbiBrKyssZillLmhhc093blByb3BlcnR5KGIpfHwodS0tLGRlbGV0ZSBmW2JdKX1lbHNlIGYhPT1lJiYoZj1lLGsrKyk7cmV0dXJuIGt9fWMuJHN0YXRlZnVsPSEwO3ZhciBkPXRoaXMsZSxmLGgsbD0xPGIubGVuZ3RoLGs9MCxwPWcoYSxjKSxxPVtdLG09e30sbj0hMCx1PTA7cmV0dXJuIHRoaXMuJHdhdGNoKHAsZnVuY3Rpb24oKXtuPyhuPSExLGIoZSxlLGQpKTpiKGUsaCxkKTtpZihsKWlmKEkoZSkpaWYoVGEoZSkpe2g9QXJyYXkoZS5sZW5ndGgpO1xyXG5mb3IodmFyIGE9MDthPGUubGVuZ3RoO2ErKyloW2FdPWVbYV19ZWxzZSBmb3IoYSBpbiBoPXt9LGUpcmMuY2FsbChlLGEpJiYoaFthXT1lW2FdKTtlbHNlIGg9ZX0pfSwkZGlnZXN0OmZ1bmN0aW9uKCl7dmFyIGUsZyxsLG0sdSx2LHM9Yix0LFc9W10seSxKO2soXCIkZGlnZXN0XCIpO2guJCRjaGVja1VybENoYW5nZSgpO3RoaXM9PT1yJiZudWxsIT09ZCYmKGguZGVmZXIuY2FuY2VsKGQpLHEoKSk7Yz1udWxsO2Rve3Y9ITE7Zm9yKHQ9dGhpcztPLmxlbmd0aDspe3RyeXtKPU8uc2hpZnQoKSxKLnNjb3BlLiRldmFsKEouZXhwcmVzc2lvbixKLmxvY2Fscyl9Y2F0Y2goQil7ZihCKX1jPW51bGx9YTpkb3tpZihtPXQuJCR3YXRjaGVycylmb3IodT1tLmxlbmd0aDt1LS07KXRyeXtpZihlPW1bdV0paWYoKGc9ZS5nZXQodCkpIT09KGw9ZS5sYXN0KSYmIShlLmVxP2ZhKGcsbCk6XCJudW1iZXJcIj09PXR5cGVvZiBnJiZcIm51bWJlclwiPT09dHlwZW9mIGwmJmlzTmFOKGcpJiZpc05hTihsKSkpdj1cclxuITAsYz1lLGUubGFzdD1lLmVxP0VhKGcsbnVsbCk6ZyxlLmZuKGcsbD09PXA/ZzpsLHQpLDU+cyYmKHk9NC1zLFdbeV18fChXW3ldPVtdKSxXW3ldLnB1c2goe21zZzpHKGUuZXhwKT9cImZuOiBcIisoZS5leHAubmFtZXx8ZS5leHAudG9TdHJpbmcoKSk6ZS5leHAsbmV3VmFsOmcsb2xkVmFsOmx9KSk7ZWxzZSBpZihlPT09Yyl7dj0hMTticmVhayBhfX1jYXRjaChBKXtmKEEpfWlmKCEobT10LiQkY2hpbGRIZWFkfHx0IT09dGhpcyYmdC4kJG5leHRTaWJsaW5nKSlmb3IoO3QhPT10aGlzJiYhKG09dC4kJG5leHRTaWJsaW5nKTspdD10LiRwYXJlbnR9d2hpbGUodD1tKTtpZigodnx8Ty5sZW5ndGgpJiYhcy0tKXRocm93IHIuJCRwaGFzZT1udWxsLGEoXCJpbmZkaWdcIixiLFcpO313aGlsZSh2fHxPLmxlbmd0aCk7Zm9yKHIuJCRwaGFzZT1udWxsO24ubGVuZ3RoOyl0cnl7bi5zaGlmdCgpKCl9Y2F0Y2goY2Epe2YoY2EpfX0sJGRlc3Ryb3k6ZnVuY3Rpb24oKXtpZighdGhpcy4kJGRlc3Ryb3llZCl7dmFyIGE9XHJcbnRoaXMuJHBhcmVudDt0aGlzLiRicm9hZGNhc3QoXCIkZGVzdHJveVwiKTt0aGlzLiQkZGVzdHJveWVkPSEwO2lmKHRoaXMhPT1yKXtmb3IodmFyIGIgaW4gdGhpcy4kJGxpc3RlbmVyQ291bnQpbSh0aGlzLHRoaXMuJCRsaXN0ZW5lckNvdW50W2JdLGIpO2EuJCRjaGlsZEhlYWQ9PXRoaXMmJihhLiQkY2hpbGRIZWFkPXRoaXMuJCRuZXh0U2libGluZyk7YS4kJGNoaWxkVGFpbD09dGhpcyYmKGEuJCRjaGlsZFRhaWw9dGhpcy4kJHByZXZTaWJsaW5nKTt0aGlzLiQkcHJldlNpYmxpbmcmJih0aGlzLiQkcHJldlNpYmxpbmcuJCRuZXh0U2libGluZz10aGlzLiQkbmV4dFNpYmxpbmcpO3RoaXMuJCRuZXh0U2libGluZyYmKHRoaXMuJCRuZXh0U2libGluZy4kJHByZXZTaWJsaW5nPXRoaXMuJCRwcmV2U2libGluZyk7dGhpcy4kZGVzdHJveT10aGlzLiRkaWdlc3Q9dGhpcy4kYXBwbHk9dGhpcy4kZXZhbEFzeW5jPXRoaXMuJGFwcGx5QXN5bmM9SDt0aGlzLiRvbj10aGlzLiR3YXRjaD10aGlzLiR3YXRjaEdyb3VwPVxyXG5mdW5jdGlvbigpe3JldHVybiBIfTt0aGlzLiQkbGlzdGVuZXJzPXt9O3RoaXMuJHBhcmVudD10aGlzLiQkbmV4dFNpYmxpbmc9dGhpcy4kJHByZXZTaWJsaW5nPXRoaXMuJCRjaGlsZEhlYWQ9dGhpcy4kJGNoaWxkVGFpbD10aGlzLiRyb290PXRoaXMuJCR3YXRjaGVycz1udWxsfX19LCRldmFsOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGcoYSkodGhpcyxiKX0sJGV2YWxBc3luYzpmdW5jdGlvbihhLGIpe3IuJCRwaGFzZXx8Ty5sZW5ndGh8fGguZGVmZXIoZnVuY3Rpb24oKXtPLmxlbmd0aCYmci4kZGlnZXN0KCl9KTtPLnB1c2goe3Njb3BlOnRoaXMsZXhwcmVzc2lvbjphLGxvY2FsczpifSl9LCQkcG9zdERpZ2VzdDpmdW5jdGlvbihhKXtuLnB1c2goYSl9LCRhcHBseTpmdW5jdGlvbihhKXt0cnl7cmV0dXJuIGsoXCIkYXBwbHlcIiksdGhpcy4kZXZhbChhKX1jYXRjaChiKXtmKGIpfWZpbmFsbHl7ci4kJHBoYXNlPW51bGw7dHJ5e3IuJGRpZ2VzdCgpfWNhdGNoKGMpe3Rocm93IGYoYyksYztcclxufX19LCRhcHBseUFzeW5jOmZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoKXtjLiRldmFsKGEpfXZhciBjPXRoaXM7YSYmdi5wdXNoKGIpO3UoKX0sJG9uOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy4kJGxpc3RlbmVyc1thXTtjfHwodGhpcy4kJGxpc3RlbmVyc1thXT1jPVtdKTtjLnB1c2goYik7dmFyIGQ9dGhpcztkbyBkLiQkbGlzdGVuZXJDb3VudFthXXx8KGQuJCRsaXN0ZW5lckNvdW50W2FdPTApLGQuJCRsaXN0ZW5lckNvdW50W2FdKys7d2hpbGUoZD1kLiRwYXJlbnQpO3ZhciBlPXRoaXM7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGQ9Yy5pbmRleE9mKGIpOy0xIT09ZCYmKGNbZF09bnVsbCxtKGUsMSxhKSl9fSwkZW1pdDpmdW5jdGlvbihhLGIpe3ZhciBjPVtdLGQsZT10aGlzLGc9ITEsaD17bmFtZTphLHRhcmdldFNjb3BlOmUsc3RvcFByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7Zz0hMH0scHJldmVudERlZmF1bHQ6ZnVuY3Rpb24oKXtoLmRlZmF1bHRQcmV2ZW50ZWQ9ITB9LGRlZmF1bHRQcmV2ZW50ZWQ6ITF9LFxyXG5sPVlhKFtoXSxhcmd1bWVudHMsMSksayxwO2Rve2Q9ZS4kJGxpc3RlbmVyc1thXXx8YztoLmN1cnJlbnRTY29wZT1lO2s9MDtmb3IocD1kLmxlbmd0aDtrPHA7aysrKWlmKGRba10pdHJ5e2Rba10uYXBwbHkobnVsbCxsKX1jYXRjaChtKXtmKG0pfWVsc2UgZC5zcGxpY2UoaywxKSxrLS0scC0tO2lmKGcpcmV0dXJuIGguY3VycmVudFNjb3BlPW51bGwsaDtlPWUuJHBhcmVudH13aGlsZShlKTtoLmN1cnJlbnRTY29wZT1udWxsO3JldHVybiBofSwkYnJvYWRjYXN0OmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxkPXRoaXMsZT17bmFtZTphLHRhcmdldFNjb3BlOnRoaXMscHJldmVudERlZmF1bHQ6ZnVuY3Rpb24oKXtlLmRlZmF1bHRQcmV2ZW50ZWQ9ITB9LGRlZmF1bHRQcmV2ZW50ZWQ6ITF9O2lmKCF0aGlzLiQkbGlzdGVuZXJDb3VudFthXSlyZXR1cm4gZTtmb3IodmFyIGc9WWEoW2VdLGFyZ3VtZW50cywxKSxoLGw7Yz1kOyl7ZS5jdXJyZW50U2NvcGU9YztkPWMuJCRsaXN0ZW5lcnNbYV18fFxyXG5bXTtoPTA7Zm9yKGw9ZC5sZW5ndGg7aDxsO2grKylpZihkW2hdKXRyeXtkW2hdLmFwcGx5KG51bGwsZyl9Y2F0Y2goayl7ZihrKX1lbHNlIGQuc3BsaWNlKGgsMSksaC0tLGwtLTtpZighKGQ9Yy4kJGxpc3RlbmVyQ291bnRbYV0mJmMuJCRjaGlsZEhlYWR8fGMhPT10aGlzJiZjLiQkbmV4dFNpYmxpbmcpKWZvcig7YyE9PXRoaXMmJiEoZD1jLiQkbmV4dFNpYmxpbmcpOyljPWMuJHBhcmVudH1lLmN1cnJlbnRTY29wZT1udWxsO3JldHVybiBlfX07dmFyIHI9bmV3IGwsTz1yLiQkYXN5bmNRdWV1ZT1bXSxuPXIuJCRwb3N0RGlnZXN0UXVldWU9W10sdj1yLiQkYXBwbHlBc3luY1F1ZXVlPVtdO3JldHVybiByfV19ZnVuY3Rpb24gU2QoKXt2YXIgYj0vXlxccyooaHR0cHM/fGZ0cHxtYWlsdG98dGVsfGZpbGUpOi8sYT0vXlxccyooKGh0dHBzP3xmdHB8ZmlsZXxibG9iKTp8ZGF0YTppbWFnZVxcLykvO3RoaXMuYUhyZWZTYW5pdGl6YXRpb25XaGl0ZWxpc3Q9ZnVuY3Rpb24oYSl7cmV0dXJuIHkoYSk/XHJcbihiPWEsdGhpcyk6Yn07dGhpcy5pbWdTcmNTYW5pdGl6YXRpb25XaGl0ZWxpc3Q9ZnVuY3Rpb24oYil7cmV0dXJuIHkoYik/KGE9Yix0aGlzKTphfTt0aGlzLiRnZXQ9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYyxkKXt2YXIgZT1kP2E6YixmO2Y9QmEoYykuaHJlZjtyZXR1cm5cIlwiPT09Znx8Zi5tYXRjaChlKT9jOlwidW5zYWZlOlwiK2Z9fX1mdW5jdGlvbiBEZihiKXtpZihcInNlbGZcIj09PWIpcmV0dXJuIGI7aWYoRihiKSl7aWYoLTE8Yi5pbmRleE9mKFwiKioqXCIpKXRocm93IENhKFwiaXdjYXJkXCIsYik7Yj1nZChiKS5yZXBsYWNlKFwiXFxcXCpcXFxcKlwiLFwiLipcIikucmVwbGFjZShcIlxcXFwqXCIsXCJbXjovLj8mO10qXCIpO3JldHVybiBuZXcgUmVnRXhwKFwiXlwiK2IrXCIkXCIpfWlmKG9iKGIpKXJldHVybiBuZXcgUmVnRXhwKFwiXlwiK2Iuc291cmNlK1wiJFwiKTt0aHJvdyBDYShcImltYXRjaGVyXCIpO31mdW5jdGlvbiBoZChiKXt2YXIgYT1bXTt5KGIpJiZzKGIsZnVuY3Rpb24oYil7YS5wdXNoKERmKGIpKX0pO1xyXG5yZXR1cm4gYX1mdW5jdGlvbiBUZSgpe3RoaXMuU0NFX0NPTlRFWFRTPW5hO3ZhciBiPVtcInNlbGZcIl0sYT1bXTt0aGlzLnJlc291cmNlVXJsV2hpdGVsaXN0PWZ1bmN0aW9uKGEpe2FyZ3VtZW50cy5sZW5ndGgmJihiPWhkKGEpKTtyZXR1cm4gYn07dGhpcy5yZXNvdXJjZVVybEJsYWNrbGlzdD1mdW5jdGlvbihiKXthcmd1bWVudHMubGVuZ3RoJiYoYT1oZChiKSk7cmV0dXJuIGF9O3RoaXMuJGdldD1bXCIkaW5qZWN0b3JcIixmdW5jdGlvbihjKXtmdW5jdGlvbiBkKGEsYil7cmV0dXJuXCJzZWxmXCI9PT1hP1pjKGIpOiEhYS5leGVjKGIuaHJlZil9ZnVuY3Rpb24gZShhKXt2YXIgYj1mdW5jdGlvbihhKXt0aGlzLiQkdW53cmFwVHJ1c3RlZFZhbHVlPWZ1bmN0aW9uKCl7cmV0dXJuIGF9fTthJiYoYi5wcm90b3R5cGU9bmV3IGEpO2IucHJvdG90eXBlLnZhbHVlT2Y9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kJHVud3JhcFRydXN0ZWRWYWx1ZSgpfTtiLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLiQkdW53cmFwVHJ1c3RlZFZhbHVlKCkudG9TdHJpbmcoKX07XHJcbnJldHVybiBifXZhciBmPWZ1bmN0aW9uKGEpe3Rocm93IENhKFwidW5zYWZlXCIpO307Yy5oYXMoXCIkc2FuaXRpemVcIikmJihmPWMuZ2V0KFwiJHNhbml0aXplXCIpKTt2YXIgZz1lKCksaD17fTtoW25hLkhUTUxdPWUoZyk7aFtuYS5DU1NdPWUoZyk7aFtuYS5VUkxdPWUoZyk7aFtuYS5KU109ZShnKTtoW25hLlJFU09VUkNFX1VSTF09ZShoW25hLlVSTF0pO3JldHVybnt0cnVzdEFzOmZ1bmN0aW9uKGEsYil7dmFyIGM9aC5oYXNPd25Qcm9wZXJ0eShhKT9oW2FdOm51bGw7aWYoIWMpdGhyb3cgQ2EoXCJpY29udGV4dFwiLGEsYik7aWYobnVsbD09PWJ8fGI9PT10fHxcIlwiPT09YilyZXR1cm4gYjtpZihcInN0cmluZ1wiIT09dHlwZW9mIGIpdGhyb3cgQ2EoXCJpdHlwZVwiLGEpO3JldHVybiBuZXcgYyhiKX0sZ2V0VHJ1c3RlZDpmdW5jdGlvbihjLGUpe2lmKG51bGw9PT1lfHxlPT09dHx8XCJcIj09PWUpcmV0dXJuIGU7dmFyIGc9aC5oYXNPd25Qcm9wZXJ0eShjKT9oW2NdOm51bGw7aWYoZyYmZSBpbnN0YW5jZW9mXHJcbmcpcmV0dXJuIGUuJCR1bndyYXBUcnVzdGVkVmFsdWUoKTtpZihjPT09bmEuUkVTT1VSQ0VfVVJMKXt2YXIgZz1CYShlLnRvU3RyaW5nKCkpLHAscSx1PSExO3A9MDtmb3IocT1iLmxlbmd0aDtwPHE7cCsrKWlmKGQoYltwXSxnKSl7dT0hMDticmVha31pZih1KWZvcihwPTAscT1hLmxlbmd0aDtwPHE7cCsrKWlmKGQoYVtwXSxnKSl7dT0hMTticmVha31pZih1KXJldHVybiBlO3Rocm93IENhKFwiaW5zZWN1cmxcIixlLnRvU3RyaW5nKCkpO31pZihjPT09bmEuSFRNTClyZXR1cm4gZihlKTt0aHJvdyBDYShcInVuc2FmZVwiKTt9LHZhbHVlT2Y6ZnVuY3Rpb24oYSl7cmV0dXJuIGEgaW5zdGFuY2VvZiBnP2EuJCR1bndyYXBUcnVzdGVkVmFsdWUoKTphfX19XX1mdW5jdGlvbiBTZSgpe3ZhciBiPSEwO3RoaXMuZW5hYmxlZD1mdW5jdGlvbihhKXthcmd1bWVudHMubGVuZ3RoJiYoYj0hIWEpO3JldHVybiBifTt0aGlzLiRnZXQ9W1wiJHBhcnNlXCIsXCIkc2NlRGVsZWdhdGVcIixmdW5jdGlvbihhLGMpe2lmKGImJlxyXG44PlJhKXRocm93IENhKFwiaWVxdWlya3NcIik7dmFyIGQ9cmEobmEpO2QuaXNFbmFibGVkPWZ1bmN0aW9uKCl7cmV0dXJuIGJ9O2QudHJ1c3RBcz1jLnRydXN0QXM7ZC5nZXRUcnVzdGVkPWMuZ2V0VHJ1c3RlZDtkLnZhbHVlT2Y9Yy52YWx1ZU9mO2J8fChkLnRydXN0QXM9ZC5nZXRUcnVzdGVkPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGJ9LGQudmFsdWVPZj1wYSk7ZC5wYXJzZUFzPWZ1bmN0aW9uKGIsYyl7dmFyIGU9YShjKTtyZXR1cm4gZS5saXRlcmFsJiZlLmNvbnN0YW50P2U6YShjLGZ1bmN0aW9uKGEpe3JldHVybiBkLmdldFRydXN0ZWQoYixhKX0pfTt2YXIgZT1kLnBhcnNlQXMsZj1kLmdldFRydXN0ZWQsZz1kLnRydXN0QXM7cyhuYSxmdW5jdGlvbihhLGIpe3ZhciBjPVEoYik7ZFtjYihcInBhcnNlX2FzX1wiK2MpXT1mdW5jdGlvbihiKXtyZXR1cm4gZShhLGIpfTtkW2NiKFwiZ2V0X3RydXN0ZWRfXCIrYyldPWZ1bmN0aW9uKGIpe3JldHVybiBmKGEsYil9O2RbY2IoXCJ0cnVzdF9hc19cIitcclxuYyldPWZ1bmN0aW9uKGIpe3JldHVybiBnKGEsYil9fSk7cmV0dXJuIGR9XX1mdW5jdGlvbiBVZSgpe3RoaXMuJGdldD1bXCIkd2luZG93XCIsXCIkZG9jdW1lbnRcIixmdW5jdGlvbihiLGEpe3ZhciBjPXt9LGQ9YmEoKC9hbmRyb2lkIChcXGQrKS8uZXhlYyhRKChiLm5hdmlnYXRvcnx8e30pLnVzZXJBZ2VudCkpfHxbXSlbMV0pLGU9L0JveGVlL2kudGVzdCgoYi5uYXZpZ2F0b3J8fHt9KS51c2VyQWdlbnQpLGY9YVswXXx8e30sZyxoPS9eKE1venx3ZWJraXR8bXMpKD89W0EtWl0pLyxsPWYuYm9keSYmZi5ib2R5LnN0eWxlLGs9ITEsbT0hMTtpZihsKXtmb3IodmFyIHAgaW4gbClpZihrPWguZXhlYyhwKSl7Zz1rWzBdO2c9Zy5zdWJzdHIoMCwxKS50b1VwcGVyQ2FzZSgpK2cuc3Vic3RyKDEpO2JyZWFrfWd8fChnPVwiV2Via2l0T3BhY2l0eVwiaW4gbCYmXCJ3ZWJraXRcIik7az0hIShcInRyYW5zaXRpb25cImluIGx8fGcrXCJUcmFuc2l0aW9uXCJpbiBsKTttPSEhKFwiYW5pbWF0aW9uXCJpbiBsfHxnK1wiQW5pbWF0aW9uXCJpblxyXG5sKTshZHx8ayYmbXx8KGs9RihmLmJvZHkuc3R5bGUud2Via2l0VHJhbnNpdGlvbiksbT1GKGYuYm9keS5zdHlsZS53ZWJraXRBbmltYXRpb24pKX1yZXR1cm57aGlzdG9yeTohKCFiLmhpc3Rvcnl8fCFiLmhpc3RvcnkucHVzaFN0YXRlfHw0PmR8fGUpLGhhc0V2ZW50OmZ1bmN0aW9uKGEpe2lmKFwiaW5wdXRcIj09PWEmJjExPj1SYSlyZXR1cm4hMTtpZihBKGNbYV0pKXt2YXIgYj1mLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7Y1thXT1cIm9uXCIrYSBpbiBifXJldHVybiBjW2FdfSxjc3A6YWIoKSx2ZW5kb3JQcmVmaXg6Zyx0cmFuc2l0aW9uczprLGFuaW1hdGlvbnM6bSxhbmRyb2lkOmR9fV19ZnVuY3Rpb24gV2UoKXt0aGlzLiRnZXQ9W1wiJHRlbXBsYXRlQ2FjaGVcIixcIiRodHRwXCIsXCIkcVwiLGZ1bmN0aW9uKGIsYSxjKXtmdW5jdGlvbiBkKGUsZil7ZC50b3RhbFBlbmRpbmdSZXF1ZXN0cysrO3ZhciBnPWEuZGVmYXVsdHMmJmEuZGVmYXVsdHMudHJhbnNmb3JtUmVzcG9uc2U7RChnKT9nPWcuZmlsdGVyKGZ1bmN0aW9uKGEpe3JldHVybiBhIT09XHJcbllifSk6Zz09PVliJiYoZz1udWxsKTtyZXR1cm4gYS5nZXQoZSx7Y2FjaGU6Yix0cmFuc2Zvcm1SZXNwb25zZTpnfSkudGhlbihmdW5jdGlvbihhKXtkLnRvdGFsUGVuZGluZ1JlcXVlc3RzLS07cmV0dXJuIGEuZGF0YX0sZnVuY3Rpb24oYSl7ZC50b3RhbFBlbmRpbmdSZXF1ZXN0cy0tO2lmKCFmKXRocm93IGphKFwidHBsb2FkXCIsZSk7cmV0dXJuIGMucmVqZWN0KGEpfSl9ZC50b3RhbFBlbmRpbmdSZXF1ZXN0cz0wO3JldHVybiBkfV19ZnVuY3Rpb24gWGUoKXt0aGlzLiRnZXQ9W1wiJHJvb3RTY29wZVwiLFwiJGJyb3dzZXJcIixcIiRsb2NhdGlvblwiLGZ1bmN0aW9uKGIsYSxjKXtyZXR1cm57ZmluZEJpbmRpbmdzOmZ1bmN0aW9uKGEsYixjKXthPWEuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcIm5nLWJpbmRpbmdcIik7dmFyIGc9W107cyhhLGZ1bmN0aW9uKGEpe3ZhciBkPWdhLmVsZW1lbnQoYSkuZGF0YShcIiRiaW5kaW5nXCIpO2QmJnMoZCxmdW5jdGlvbihkKXtjPyhuZXcgUmVnRXhwKFwiKF58XFxcXHMpXCIrXHJcbmdkKGIpK1wiKFxcXFxzfFxcXFx8fCQpXCIpKS50ZXN0KGQpJiZnLnB1c2goYSk6LTEhPWQuaW5kZXhPZihiKSYmZy5wdXNoKGEpfSl9KTtyZXR1cm4gZ30sZmluZE1vZGVsczpmdW5jdGlvbihhLGIsYyl7Zm9yKHZhciBnPVtcIm5nLVwiLFwiZGF0YS1uZy1cIixcIm5nXFxcXDpcIl0saD0wO2g8Zy5sZW5ndGg7KytoKXt2YXIgbD1hLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbXCIrZ1toXStcIm1vZGVsXCIrKGM/XCI9XCI6XCIqPVwiKSsnXCInK2IrJ1wiXScpO2lmKGwubGVuZ3RoKXJldHVybiBsfX0sZ2V0TG9jYXRpb246ZnVuY3Rpb24oKXtyZXR1cm4gYy51cmwoKX0sc2V0TG9jYXRpb246ZnVuY3Rpb24oYSl7YSE9PWMudXJsKCkmJihjLnVybChhKSxiLiRkaWdlc3QoKSl9LHdoZW5TdGFibGU6ZnVuY3Rpb24oYil7YS5ub3RpZnlXaGVuTm9PdXRzdGFuZGluZ1JlcXVlc3RzKGIpfX19XX1mdW5jdGlvbiBZZSgpe3RoaXMuJGdldD1bXCIkcm9vdFNjb3BlXCIsXCIkYnJvd3NlclwiLFwiJHFcIixcIiQkcVwiLFwiJGV4Y2VwdGlvbkhhbmRsZXJcIixcclxuZnVuY3Rpb24oYixhLGMsZCxlKXtmdW5jdGlvbiBmKGYsbCxrKXt2YXIgbT15KGspJiYhayxwPShtP2Q6YykuZGVmZXIoKSxxPXAucHJvbWlzZTtsPWEuZGVmZXIoZnVuY3Rpb24oKXt0cnl7cC5yZXNvbHZlKGYoKSl9Y2F0Y2goYSl7cC5yZWplY3QoYSksZShhKX1maW5hbGx5e2RlbGV0ZSBnW3EuJCR0aW1lb3V0SWRdfW18fGIuJGFwcGx5KCl9LGwpO3EuJCR0aW1lb3V0SWQ9bDtnW2xdPXA7cmV0dXJuIHF9dmFyIGc9e307Zi5jYW5jZWw9ZnVuY3Rpb24oYil7cmV0dXJuIGImJmIuJCR0aW1lb3V0SWQgaW4gZz8oZ1tiLiQkdGltZW91dElkXS5yZWplY3QoXCJjYW5jZWxlZFwiKSxkZWxldGUgZ1tiLiQkdGltZW91dElkXSxhLmRlZmVyLmNhbmNlbChiLiQkdGltZW91dElkKSk6ITF9O3JldHVybiBmfV19ZnVuY3Rpb24gQmEoYil7UmEmJihaLnNldEF0dHJpYnV0ZShcImhyZWZcIixiKSxiPVouaHJlZik7Wi5zZXRBdHRyaWJ1dGUoXCJocmVmXCIsYik7cmV0dXJue2hyZWY6Wi5ocmVmLHByb3RvY29sOloucHJvdG9jb2w/XHJcbloucHJvdG9jb2wucmVwbGFjZSgvOiQvLFwiXCIpOlwiXCIsaG9zdDpaLmhvc3Qsc2VhcmNoOlouc2VhcmNoP1ouc2VhcmNoLnJlcGxhY2UoL15cXD8vLFwiXCIpOlwiXCIsaGFzaDpaLmhhc2g/Wi5oYXNoLnJlcGxhY2UoL14jLyxcIlwiKTpcIlwiLGhvc3RuYW1lOlouaG9zdG5hbWUscG9ydDpaLnBvcnQscGF0aG5hbWU6XCIvXCI9PT1aLnBhdGhuYW1lLmNoYXJBdCgwKT9aLnBhdGhuYW1lOlwiL1wiK1oucGF0aG5hbWV9fWZ1bmN0aW9uIFpjKGIpe2I9RihiKT9CYShiKTpiO3JldHVybiBiLnByb3RvY29sPT09aWQucHJvdG9jb2wmJmIuaG9zdD09PWlkLmhvc3R9ZnVuY3Rpb24gWmUoKXt0aGlzLiRnZXQ9ZGEoTSl9ZnVuY3Rpb24gRGMoYil7ZnVuY3Rpb24gYShjLGQpe2lmKEkoYykpe3ZhciBlPXt9O3MoYyxmdW5jdGlvbihiLGMpe2VbY109YShjLGIpfSk7cmV0dXJuIGV9cmV0dXJuIGIuZmFjdG9yeShjK1wiRmlsdGVyXCIsZCl9dGhpcy5yZWdpc3Rlcj1hO3RoaXMuJGdldD1bXCIkaW5qZWN0b3JcIixmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIGEuZ2V0KGIrXHJcblwiRmlsdGVyXCIpfX1dO2EoXCJjdXJyZW5jeVwiLGpkKTthKFwiZGF0ZVwiLGtkKTthKFwiZmlsdGVyXCIsRWYpO2EoXCJqc29uXCIsRmYpO2EoXCJsaW1pdFRvXCIsR2YpO2EoXCJsb3dlcmNhc2VcIixIZik7YShcIm51bWJlclwiLGxkKTthKFwib3JkZXJCeVwiLG1kKTthKFwidXBwZXJjYXNlXCIsSWYpfWZ1bmN0aW9uIEVmKCl7cmV0dXJuIGZ1bmN0aW9uKGIsYSxjKXtpZighRChiKSlyZXR1cm4gYjt2YXIgZDtzd2l0Y2godHlwZW9mIGEpe2Nhc2UgXCJmdW5jdGlvblwiOmJyZWFrO2Nhc2UgXCJib29sZWFuXCI6Y2FzZSBcIm51bWJlclwiOmNhc2UgXCJzdHJpbmdcIjpkPSEwO2Nhc2UgXCJvYmplY3RcIjphPUpmKGEsYyxkKTticmVhaztkZWZhdWx0OnJldHVybiBifXJldHVybiBiLmZpbHRlcihhKX19ZnVuY3Rpb24gSmYoYixhLGMpe3ZhciBkPUkoYikmJlwiJFwiaW4gYjshMD09PWE/YT1mYTpHKGEpfHwoYT1mdW5jdGlvbihhLGIpe2lmKEkoYSl8fEkoYikpcmV0dXJuITE7YT1RKFwiXCIrYSk7Yj1RKFwiXCIrYik7cmV0dXJuLTEhPT1hLmluZGV4T2YoYil9KTtcclxucmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiBkJiYhSShlKT9JYShlLGIuJCxhLCExKTpJYShlLGIsYSxjKX19ZnVuY3Rpb24gSWEoYixhLGMsZCxlKXt2YXIgZj10eXBlb2YgYixnPXR5cGVvZiBhO2lmKFwic3RyaW5nXCI9PT1nJiZcIiFcIj09PWEuY2hhckF0KDApKXJldHVybiFJYShiLGEuc3Vic3RyaW5nKDEpLGMsZCk7aWYoRChiKSlyZXR1cm4gYi5zb21lKGZ1bmN0aW9uKGIpe3JldHVybiBJYShiLGEsYyxkKX0pO3N3aXRjaChmKXtjYXNlIFwib2JqZWN0XCI6dmFyIGg7aWYoZCl7Zm9yKGggaW4gYilpZihcIiRcIiE9PWguY2hhckF0KDApJiZJYShiW2hdLGEsYywhMCkpcmV0dXJuITA7cmV0dXJuIGU/ITE6SWEoYixhLGMsITEpfWlmKFwib2JqZWN0XCI9PT1nKXtmb3IoaCBpbiBhKWlmKGU9YVtoXSwhRyhlKSYmKGY9XCIkXCI9PT1oLCFJYShmP2I6YltoXSxlLGMsZixmKSkpcmV0dXJuITE7cmV0dXJuITB9cmV0dXJuIGMoYixhKTtjYXNlIFwiZnVuY3Rpb25cIjpyZXR1cm4hMTtkZWZhdWx0OnJldHVybiBjKGIsXHJcbmEpfX1mdW5jdGlvbiBqZChiKXt2YXIgYT1iLk5VTUJFUl9GT1JNQVRTO3JldHVybiBmdW5jdGlvbihiLGQsZSl7QShkKSYmKGQ9YS5DVVJSRU5DWV9TWU0pO0EoZSkmJihlPWEuUEFUVEVSTlNbMV0ubWF4RnJhYyk7cmV0dXJuIG51bGw9PWI/YjpuZChiLGEuUEFUVEVSTlNbMV0sYS5HUk9VUF9TRVAsYS5ERUNJTUFMX1NFUCxlKS5yZXBsYWNlKC9cXHUwMEE0L2csZCl9fWZ1bmN0aW9uIGxkKGIpe3ZhciBhPWIuTlVNQkVSX0ZPUk1BVFM7cmV0dXJuIGZ1bmN0aW9uKGIsZCl7cmV0dXJuIG51bGw9PWI/YjpuZChiLGEuUEFUVEVSTlNbMF0sYS5HUk9VUF9TRVAsYS5ERUNJTUFMX1NFUCxkKX19ZnVuY3Rpb24gbmQoYixhLGMsZCxlKXtpZighaXNGaW5pdGUoYil8fEkoYikpcmV0dXJuXCJcIjt2YXIgZj0wPmI7Yj1NYXRoLmFicyhiKTt2YXIgZz1iK1wiXCIsaD1cIlwiLGw9W10saz0hMTtpZigtMSE9PWcuaW5kZXhPZihcImVcIikpe3ZhciBtPWcubWF0Y2goLyhbXFxkXFwuXSspZSgtPykoXFxkKykvKTttJiZcclxuXCItXCI9PW1bMl0mJm1bM10+ZSsxP2I9MDooaD1nLGs9ITApfWlmKGspMDxlJiYxPmImJihoPWIudG9GaXhlZChlKSxiPXBhcnNlRmxvYXQoaCkpO2Vsc2V7Zz0oZy5zcGxpdChvZClbMV18fFwiXCIpLmxlbmd0aDtBKGUpJiYoZT1NYXRoLm1pbihNYXRoLm1heChhLm1pbkZyYWMsZyksYS5tYXhGcmFjKSk7Yj0rKE1hdGgucm91bmQoKyhiLnRvU3RyaW5nKCkrXCJlXCIrZSkpLnRvU3RyaW5nKCkrXCJlXCIrLWUpO3ZhciBnPShcIlwiK2IpLnNwbGl0KG9kKSxrPWdbMF0sZz1nWzFdfHxcIlwiLHA9MCxxPWEubGdTaXplLHU9YS5nU2l6ZTtpZihrLmxlbmd0aD49cSt1KWZvcihwPWsubGVuZ3RoLXEsbT0wO208cDttKyspMD09PShwLW0pJXUmJjAhPT1tJiYoaCs9YyksaCs9ay5jaGFyQXQobSk7Zm9yKG09cDttPGsubGVuZ3RoO20rKykwPT09KGsubGVuZ3RoLW0pJXEmJjAhPT1tJiYoaCs9YyksaCs9ay5jaGFyQXQobSk7Zm9yKDtnLmxlbmd0aDxlOylnKz1cIjBcIjtlJiZcIjBcIiE9PWUmJihoKz1kK2cuc3Vic3RyKDAsXHJcbmUpKX0wPT09YiYmKGY9ITEpO2wucHVzaChmP2EubmVnUHJlOmEucG9zUHJlLGgsZj9hLm5lZ1N1ZjphLnBvc1N1Zik7cmV0dXJuIGwuam9pbihcIlwiKX1mdW5jdGlvbiBIYihiLGEsYyl7dmFyIGQ9XCJcIjswPmImJihkPVwiLVwiLGI9LWIpO2ZvcihiPVwiXCIrYjtiLmxlbmd0aDxhOyliPVwiMFwiK2I7YyYmKGI9Yi5zdWJzdHIoYi5sZW5ndGgtYSkpO3JldHVybiBkK2J9ZnVuY3Rpb24gJChiLGEsYyxkKXtjPWN8fDA7cmV0dXJuIGZ1bmN0aW9uKGUpe2U9ZVtcImdldFwiK2JdKCk7aWYoMDxjfHxlPi1jKWUrPWM7MD09PWUmJi0xMj09YyYmKGU9MTIpO3JldHVybiBIYihlLGEsZCl9fWZ1bmN0aW9uIEliKGIsYSl7cmV0dXJuIGZ1bmN0aW9uKGMsZCl7dmFyIGU9Y1tcImdldFwiK2JdKCksZj11YihhP1wiU0hPUlRcIitiOmIpO3JldHVybiBkW2ZdW2VdfX1mdW5jdGlvbiBwZChiKXt2YXIgYT0obmV3IERhdGUoYiwwLDEpKS5nZXREYXkoKTtyZXR1cm4gbmV3IERhdGUoYiwwLCg0Pj1hPzU6MTIpLWEpfWZ1bmN0aW9uIHFkKGIpe3JldHVybiBmdW5jdGlvbihhKXt2YXIgYz1cclxucGQoYS5nZXRGdWxsWWVhcigpKTthPStuZXcgRGF0ZShhLmdldEZ1bGxZZWFyKCksYS5nZXRNb250aCgpLGEuZ2V0RGF0ZSgpKyg0LWEuZ2V0RGF5KCkpKS0rYzthPTErTWF0aC5yb3VuZChhLzYwNDhFNSk7cmV0dXJuIEhiKGEsYil9fWZ1bmN0aW9uIGtkKGIpe2Z1bmN0aW9uIGEoYSl7dmFyIGI7aWYoYj1hLm1hdGNoKGMpKXthPW5ldyBEYXRlKDApO3ZhciBmPTAsZz0wLGg9Yls4XT9hLnNldFVUQ0Z1bGxZZWFyOmEuc2V0RnVsbFllYXIsbD1iWzhdP2Euc2V0VVRDSG91cnM6YS5zZXRIb3VycztiWzldJiYoZj1iYShiWzldK2JbMTBdKSxnPWJhKGJbOV0rYlsxMV0pKTtoLmNhbGwoYSxiYShiWzFdKSxiYShiWzJdKS0xLGJhKGJbM10pKTtmPWJhKGJbNF18fDApLWY7Zz1iYShiWzVdfHwwKS1nO2g9YmEoYls2XXx8MCk7Yj1NYXRoLnJvdW5kKDFFMypwYXJzZUZsb2F0KFwiMC5cIisoYls3XXx8MCkpKTtsLmNhbGwoYSxmLGcsaCxiKX1yZXR1cm4gYX12YXIgYz0vXihcXGR7NH0pLT8oXFxkXFxkKS0/KFxcZFxcZCkoPzpUKFxcZFxcZCkoPzo6PyhcXGRcXGQpKD86Oj8oXFxkXFxkKSg/OlxcLihcXGQrKSk/KT8pPyhafChbKy1dKShcXGRcXGQpOj8oXFxkXFxkKSk/KT8kLztcclxucmV0dXJuIGZ1bmN0aW9uKGMsZSxmKXt2YXIgZz1cIlwiLGg9W10sbCxrO2U9ZXx8XCJtZWRpdW1EYXRlXCI7ZT1iLkRBVEVUSU1FX0ZPUk1BVFNbZV18fGU7RihjKSYmKGM9S2YudGVzdChjKT9iYShjKTphKGMpKTtWKGMpJiYoYz1uZXcgRGF0ZShjKSk7aWYoIXFhKGMpKXJldHVybiBjO2Zvcig7ZTspKGs9TGYuZXhlYyhlKSk/KGg9WWEoaCxrLDEpLGU9aC5wb3AoKSk6KGgucHVzaChlKSxlPW51bGwpO2YmJlwiVVRDXCI9PT1mJiYoYz1uZXcgRGF0ZShjLmdldFRpbWUoKSksYy5zZXRNaW51dGVzKGMuZ2V0TWludXRlcygpK2MuZ2V0VGltZXpvbmVPZmZzZXQoKSkpO3MoaCxmdW5jdGlvbihhKXtsPU1mW2FdO2crPWw/bChjLGIuREFURVRJTUVfRk9STUFUUyk6YS5yZXBsYWNlKC8oXid8JyQpL2csXCJcIikucmVwbGFjZSgvJycvZyxcIidcIil9KTtyZXR1cm4gZ319ZnVuY3Rpb24gRmYoKXtyZXR1cm4gZnVuY3Rpb24oYixhKXtBKGEpJiYoYT0yKTtyZXR1cm4gJGEoYixhKX19ZnVuY3Rpb24gR2YoKXtyZXR1cm4gZnVuY3Rpb24oYixcclxuYSl7VihiKSYmKGI9Yi50b1N0cmluZygpKTtyZXR1cm4gRChiKXx8RihiKT8oYT1JbmZpbml0eT09PU1hdGguYWJzKE51bWJlcihhKSk/TnVtYmVyKGEpOmJhKGEpKT8wPGE/Yi5zbGljZSgwLGEpOmIuc2xpY2UoYSk6RihiKT9cIlwiOltdOmJ9fWZ1bmN0aW9uIG1kKGIpe3JldHVybiBmdW5jdGlvbihhLGMsZCl7ZnVuY3Rpb24gZShhLGIpe3JldHVybiBiP2Z1bmN0aW9uKGIsYyl7cmV0dXJuIGEoYyxiKX06YX1mdW5jdGlvbiBmKGEpe3N3aXRjaCh0eXBlb2YgYSl7Y2FzZSBcIm51bWJlclwiOmNhc2UgXCJib29sZWFuXCI6Y2FzZSBcInN0cmluZ1wiOnJldHVybiEwO2RlZmF1bHQ6cmV0dXJuITF9fWZ1bmN0aW9uIGcoYSl7cmV0dXJuIG51bGw9PT1hP1wibnVsbFwiOlwiZnVuY3Rpb25cIj09PXR5cGVvZiBhLnZhbHVlT2YmJihhPWEudmFsdWVPZigpLGYoYSkpfHxcImZ1bmN0aW9uXCI9PT10eXBlb2YgYS50b1N0cmluZyYmKGE9YS50b1N0cmluZygpLGYoYSkpP2E6XCJcIn1mdW5jdGlvbiBoKGEsYil7dmFyIGM9XHJcbnR5cGVvZiBhLGQ9dHlwZW9mIGI7Yz09PWQmJlwib2JqZWN0XCI9PT1jJiYoYT1nKGEpLGI9ZyhiKSk7cmV0dXJuIGM9PT1kPyhcInN0cmluZ1wiPT09YyYmKGE9YS50b0xvd2VyQ2FzZSgpLGI9Yi50b0xvd2VyQ2FzZSgpKSxhPT09Yj8wOmE8Yj8tMToxKTpjPGQ/LTE6MX1pZighVGEoYSkpcmV0dXJuIGE7Yz1EKGMpP2M6W2NdOzA9PT1jLmxlbmd0aCYmKGM9W1wiK1wiXSk7Yz1jLm1hcChmdW5jdGlvbihhKXt2YXIgYz0hMSxkPWF8fHBhO2lmKEYoYSkpe2lmKFwiK1wiPT1hLmNoYXJBdCgwKXx8XCItXCI9PWEuY2hhckF0KDApKWM9XCItXCI9PWEuY2hhckF0KDApLGE9YS5zdWJzdHJpbmcoMSk7aWYoXCJcIj09PWEpcmV0dXJuIGUoaCxjKTtkPWIoYSk7aWYoZC5jb25zdGFudCl7dmFyIGY9ZCgpO3JldHVybiBlKGZ1bmN0aW9uKGEsYil7cmV0dXJuIGgoYVtmXSxiW2ZdKX0sYyl9fXJldHVybiBlKGZ1bmN0aW9uKGEsYil7cmV0dXJuIGgoZChhKSxkKGIpKX0sYyl9KTtyZXR1cm4gWmEuY2FsbChhKS5zb3J0KGUoZnVuY3Rpb24oYSxcclxuYil7Zm9yKHZhciBkPTA7ZDxjLmxlbmd0aDtkKyspe3ZhciBlPWNbZF0oYSxiKTtpZigwIT09ZSlyZXR1cm4gZX1yZXR1cm4gMH0sZCkpfX1mdW5jdGlvbiBKYShiKXtHKGIpJiYoYj17bGluazpifSk7Yi5yZXN0cmljdD1iLnJlc3RyaWN0fHxcIkFDXCI7cmV0dXJuIGRhKGIpfWZ1bmN0aW9uIHJkKGIsYSxjLGQsZSl7dmFyIGY9dGhpcyxnPVtdLGg9Zi4kJHBhcmVudEZvcm09Yi5wYXJlbnQoKS5jb250cm9sbGVyKFwiZm9ybVwiKXx8SmI7Zi4kZXJyb3I9e307Zi4kJHN1Y2Nlc3M9e307Zi4kcGVuZGluZz10O2YuJG5hbWU9ZShhLm5hbWV8fGEubmdGb3JtfHxcIlwiKShjKTtmLiRkaXJ0eT0hMTtmLiRwcmlzdGluZT0hMDtmLiR2YWxpZD0hMDtmLiRpbnZhbGlkPSExO2YuJHN1Ym1pdHRlZD0hMTtoLiRhZGRDb250cm9sKGYpO2YuJHJvbGxiYWNrVmlld1ZhbHVlPWZ1bmN0aW9uKCl7cyhnLGZ1bmN0aW9uKGEpe2EuJHJvbGxiYWNrVmlld1ZhbHVlKCl9KX07Zi4kY29tbWl0Vmlld1ZhbHVlPWZ1bmN0aW9uKCl7cyhnLFxyXG5mdW5jdGlvbihhKXthLiRjb21taXRWaWV3VmFsdWUoKX0pfTtmLiRhZGRDb250cm9sPWZ1bmN0aW9uKGEpe01hKGEuJG5hbWUsXCJpbnB1dFwiKTtnLnB1c2goYSk7YS4kbmFtZSYmKGZbYS4kbmFtZV09YSl9O2YuJCRyZW5hbWVDb250cm9sPWZ1bmN0aW9uKGEsYil7dmFyIGM9YS4kbmFtZTtmW2NdPT09YSYmZGVsZXRlIGZbY107ZltiXT1hO2EuJG5hbWU9Yn07Zi4kcmVtb3ZlQ29udHJvbD1mdW5jdGlvbihhKXthLiRuYW1lJiZmW2EuJG5hbWVdPT09YSYmZGVsZXRlIGZbYS4kbmFtZV07cyhmLiRwZW5kaW5nLGZ1bmN0aW9uKGIsYyl7Zi4kc2V0VmFsaWRpdHkoYyxudWxsLGEpfSk7cyhmLiRlcnJvcixmdW5jdGlvbihiLGMpe2YuJHNldFZhbGlkaXR5KGMsbnVsbCxhKX0pO1hhKGcsYSl9O3NkKHtjdHJsOnRoaXMsJGVsZW1lbnQ6YixzZXQ6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWFbYl07ZD8tMT09PWQuaW5kZXhPZihjKSYmZC5wdXNoKGMpOmFbYl09W2NdfSx1bnNldDpmdW5jdGlvbihhLFxyXG5iLGMpe3ZhciBkPWFbYl07ZCYmKFhhKGQsYyksMD09PWQubGVuZ3RoJiZkZWxldGUgYVtiXSl9LHBhcmVudEZvcm06aCwkYW5pbWF0ZTpkfSk7Zi4kc2V0RGlydHk9ZnVuY3Rpb24oKXtkLnJlbW92ZUNsYXNzKGIsU2EpO2QuYWRkQ2xhc3MoYixLYik7Zi4kZGlydHk9ITA7Zi4kcHJpc3RpbmU9ITE7aC4kc2V0RGlydHkoKX07Zi4kc2V0UHJpc3RpbmU9ZnVuY3Rpb24oKXtkLnNldENsYXNzKGIsU2EsS2IrXCIgbmctc3VibWl0dGVkXCIpO2YuJGRpcnR5PSExO2YuJHByaXN0aW5lPSEwO2YuJHN1Ym1pdHRlZD0hMTtzKGcsZnVuY3Rpb24oYSl7YS4kc2V0UHJpc3RpbmUoKX0pfTtmLiRzZXRVbnRvdWNoZWQ9ZnVuY3Rpb24oKXtzKGcsZnVuY3Rpb24oYSl7YS4kc2V0VW50b3VjaGVkKCl9KX07Zi4kc2V0U3VibWl0dGVkPWZ1bmN0aW9uKCl7ZC5hZGRDbGFzcyhiLFwibmctc3VibWl0dGVkXCIpO2YuJHN1Ym1pdHRlZD0hMDtoLiRzZXRTdWJtaXR0ZWQoKX19ZnVuY3Rpb24gaGMoYil7Yi4kZm9ybWF0dGVycy5wdXNoKGZ1bmN0aW9uKGEpe3JldHVybiBiLiRpc0VtcHR5KGEpP1xyXG5hOmEudG9TdHJpbmcoKX0pfWZ1bmN0aW9uIGliKGIsYSxjLGQsZSxmKXt2YXIgZz1RKGFbMF0udHlwZSk7aWYoIWUuYW5kcm9pZCl7dmFyIGg9ITE7YS5vbihcImNvbXBvc2l0aW9uc3RhcnRcIixmdW5jdGlvbihhKXtoPSEwfSk7YS5vbihcImNvbXBvc2l0aW9uZW5kXCIsZnVuY3Rpb24oKXtoPSExO2woKX0pfXZhciBsPWZ1bmN0aW9uKGIpe2smJihmLmRlZmVyLmNhbmNlbChrKSxrPW51bGwpO2lmKCFoKXt2YXIgZT1hLnZhbCgpO2I9YiYmYi50eXBlO1wicGFzc3dvcmRcIj09PWd8fGMubmdUcmltJiZcImZhbHNlXCI9PT1jLm5nVHJpbXx8KGU9VShlKSk7KGQuJHZpZXdWYWx1ZSE9PWV8fFwiXCI9PT1lJiZkLiQkaGFzTmF0aXZlVmFsaWRhdG9ycykmJmQuJHNldFZpZXdWYWx1ZShlLGIpfX07aWYoZS5oYXNFdmVudChcImlucHV0XCIpKWEub24oXCJpbnB1dFwiLGwpO2Vsc2V7dmFyIGssbT1mdW5jdGlvbihhLGIsYyl7a3x8KGs9Zi5kZWZlcihmdW5jdGlvbigpe2s9bnVsbDtiJiZiLnZhbHVlPT09Y3x8bChhKX0pKX07XHJcbmEub24oXCJrZXlkb3duXCIsZnVuY3Rpb24oYSl7dmFyIGI9YS5rZXlDb2RlOzkxPT09Ynx8MTU8YiYmMTk+Ynx8Mzc8PWImJjQwPj1ifHxtKGEsdGhpcyx0aGlzLnZhbHVlKX0pO2lmKGUuaGFzRXZlbnQoXCJwYXN0ZVwiKSlhLm9uKFwicGFzdGUgY3V0XCIsbSl9YS5vbihcImNoYW5nZVwiLGwpO2QuJHJlbmRlcj1mdW5jdGlvbigpe2EudmFsKGQuJGlzRW1wdHkoZC4kdmlld1ZhbHVlKT9cIlwiOmQuJHZpZXdWYWx1ZSl9fWZ1bmN0aW9uIExiKGIsYSl7cmV0dXJuIGZ1bmN0aW9uKGMsZCl7dmFyIGUsZjtpZihxYShjKSlyZXR1cm4gYztpZihGKGMpKXsnXCInPT1jLmNoYXJBdCgwKSYmJ1wiJz09Yy5jaGFyQXQoYy5sZW5ndGgtMSkmJihjPWMuc3Vic3RyaW5nKDEsYy5sZW5ndGgtMSkpO2lmKE5mLnRlc3QoYykpcmV0dXJuIG5ldyBEYXRlKGMpO2IubGFzdEluZGV4PTA7aWYoZT1iLmV4ZWMoYykpcmV0dXJuIGUuc2hpZnQoKSxmPWQ/e3l5eXk6ZC5nZXRGdWxsWWVhcigpLE1NOmQuZ2V0TW9udGgoKSsxLFxyXG5kZDpkLmdldERhdGUoKSxISDpkLmdldEhvdXJzKCksbW06ZC5nZXRNaW51dGVzKCksc3M6ZC5nZXRTZWNvbmRzKCksc3NzOmQuZ2V0TWlsbGlzZWNvbmRzKCkvMUUzfTp7eXl5eToxOTcwLE1NOjEsZGQ6MSxISDowLG1tOjAsc3M6MCxzc3M6MH0scyhlLGZ1bmN0aW9uKGIsYyl7YzxhLmxlbmd0aCYmKGZbYVtjXV09K2IpfSksbmV3IERhdGUoZi55eXl5LGYuTU0tMSxmLmRkLGYuSEgsZi5tbSxmLnNzfHwwLDFFMypmLnNzc3x8MCl9cmV0dXJuIE5hTn19ZnVuY3Rpb24gamIoYixhLGMsZCl7cmV0dXJuIGZ1bmN0aW9uKGUsZixnLGgsbCxrLG0pe2Z1bmN0aW9uIHAoYSl7cmV0dXJuIGEmJiEoYS5nZXRUaW1lJiZhLmdldFRpbWUoKSE9PWEuZ2V0VGltZSgpKX1mdW5jdGlvbiBxKGEpe3JldHVybiB5KGEpP3FhKGEpP2E6YyhhKTp0fXRkKGUsZixnLGgpO2liKGUsZixnLGgsbCxrKTt2YXIgdT1oJiZoLiRvcHRpb25zJiZoLiRvcHRpb25zLnRpbWV6b25lLHI7aC4kJHBhcnNlck5hbWU9YjtcclxuaC4kcGFyc2Vycy5wdXNoKGZ1bmN0aW9uKGIpe3JldHVybiBoLiRpc0VtcHR5KGIpP251bGw6YS50ZXN0KGIpPyhiPWMoYixyKSxcIlVUQ1wiPT09dSYmYi5zZXRNaW51dGVzKGIuZ2V0TWludXRlcygpLWIuZ2V0VGltZXpvbmVPZmZzZXQoKSksYik6dH0pO2guJGZvcm1hdHRlcnMucHVzaChmdW5jdGlvbihhKXtpZihhJiYhcWEoYSkpdGhyb3cgTWIoXCJkYXRlZm10XCIsYSk7aWYocChhKSl7aWYoKHI9YSkmJlwiVVRDXCI9PT11KXt2YXIgYj02RTQqci5nZXRUaW1lem9uZU9mZnNldCgpO3I9bmV3IERhdGUoci5nZXRUaW1lKCkrYil9cmV0dXJuIG0oXCJkYXRlXCIpKGEsZCx1KX1yPW51bGw7cmV0dXJuXCJcIn0pO2lmKHkoZy5taW4pfHxnLm5nTWluKXt2YXIgcztoLiR2YWxpZGF0b3JzLm1pbj1mdW5jdGlvbihhKXtyZXR1cm4hcChhKXx8QShzKXx8YyhhKT49c307Zy4kb2JzZXJ2ZShcIm1pblwiLGZ1bmN0aW9uKGEpe3M9cShhKTtoLiR2YWxpZGF0ZSgpfSl9aWYoeShnLm1heCl8fGcubmdNYXgpe3ZhciBuO1xyXG5oLiR2YWxpZGF0b3JzLm1heD1mdW5jdGlvbihhKXtyZXR1cm4hcChhKXx8QShuKXx8YyhhKTw9bn07Zy4kb2JzZXJ2ZShcIm1heFwiLGZ1bmN0aW9uKGEpe249cShhKTtoLiR2YWxpZGF0ZSgpfSl9fX1mdW5jdGlvbiB0ZChiLGEsYyxkKXsoZC4kJGhhc05hdGl2ZVZhbGlkYXRvcnM9SShhWzBdLnZhbGlkaXR5KSkmJmQuJHBhcnNlcnMucHVzaChmdW5jdGlvbihiKXt2YXIgYz1hLnByb3AoXCJ2YWxpZGl0eVwiKXx8e307cmV0dXJuIGMuYmFkSW5wdXQmJiFjLnR5cGVNaXNtYXRjaD90OmJ9KX1mdW5jdGlvbiB1ZChiLGEsYyxkLGUpe2lmKHkoZCkpe2I9YihkKTtpZighYi5jb25zdGFudCl0aHJvdyBUKFwibmdNb2RlbFwiKShcImNvbnN0ZXhwclwiLGMsZCk7cmV0dXJuIGIoYSl9cmV0dXJuIGV9ZnVuY3Rpb24gaWMoYixhKXtiPVwibmdDbGFzc1wiK2I7cmV0dXJuW1wiJGFuaW1hdGVcIixmdW5jdGlvbihjKXtmdW5jdGlvbiBkKGEsYil7dmFyIGM9W10sZD0wO2E6Zm9yKDtkPGEubGVuZ3RoO2QrKyl7Zm9yKHZhciBlPVxyXG5hW2RdLG09MDttPGIubGVuZ3RoO20rKylpZihlPT1iW21dKWNvbnRpbnVlIGE7Yy5wdXNoKGUpfXJldHVybiBjfWZ1bmN0aW9uIGUoYSl7aWYoIUQoYSkpe2lmKEYoYSkpcmV0dXJuIGEuc3BsaXQoXCIgXCIpO2lmKEkoYSkpe3ZhciBiPVtdO3MoYSxmdW5jdGlvbihhLGMpe2EmJihiPWIuY29uY2F0KGMuc3BsaXQoXCIgXCIpKSl9KTtyZXR1cm4gYn19cmV0dXJuIGF9cmV0dXJue3Jlc3RyaWN0OlwiQUNcIixsaW5rOmZ1bmN0aW9uKGYsZyxoKXtmdW5jdGlvbiBsKGEsYil7dmFyIGM9Zy5kYXRhKFwiJGNsYXNzQ291bnRzXCIpfHx7fSxkPVtdO3MoYSxmdW5jdGlvbihhKXtpZigwPGJ8fGNbYV0pY1thXT0oY1thXXx8MCkrYixjW2FdPT09KygwPGIpJiZkLnB1c2goYSl9KTtnLmRhdGEoXCIkY2xhc3NDb3VudHNcIixjKTtyZXR1cm4gZC5qb2luKFwiIFwiKX1mdW5jdGlvbiBrKGIpe2lmKCEwPT09YXx8Zi4kaW5kZXglMj09PWEpe3ZhciBrPWUoYnx8W10pO2lmKCFtKXt2YXIgdT1sKGssMSk7aC4kYWRkQ2xhc3ModSl9ZWxzZSBpZighZmEoYixcclxubSkpe3ZhciByPWUobSksdT1kKGssciksaz1kKHIsayksdT1sKHUsMSksaz1sKGssLTEpO3UmJnUubGVuZ3RoJiZjLmFkZENsYXNzKGcsdSk7ayYmay5sZW5ndGgmJmMucmVtb3ZlQ2xhc3MoZyxrKX19bT1yYShiKX12YXIgbTtmLiR3YXRjaChoW2JdLGssITApO2guJG9ic2VydmUoXCJjbGFzc1wiLGZ1bmN0aW9uKGEpe2soZi4kZXZhbChoW2JdKSl9KTtcIm5nQ2xhc3NcIiE9PWImJmYuJHdhdGNoKFwiJGluZGV4XCIsZnVuY3Rpb24oYyxkKXt2YXIgZz1jJjE7aWYoZyE9PShkJjEpKXt2YXIgaz1lKGYuJGV2YWwoaFtiXSkpO2c9PT1hPyhnPWwoaywxKSxoLiRhZGRDbGFzcyhnKSk6KGc9bChrLC0xKSxoLiRyZW1vdmVDbGFzcyhnKSl9fSl9fX1dfWZ1bmN0aW9uIHNkKGIpe2Z1bmN0aW9uIGEoYSxiKXtiJiYhZlthXT8oay5hZGRDbGFzcyhlLGEpLGZbYV09ITApOiFiJiZmW2FdJiYoay5yZW1vdmVDbGFzcyhlLGEpLGZbYV09ITEpfWZ1bmN0aW9uIGMoYixjKXtiPWI/XCItXCIrdGMoYixcIi1cIik6XCJcIjtcclxuYShrYitiLCEwPT09Yyk7YSh2ZCtiLCExPT09Yyl9dmFyIGQ9Yi5jdHJsLGU9Yi4kZWxlbWVudCxmPXt9LGc9Yi5zZXQsaD1iLnVuc2V0LGw9Yi5wYXJlbnRGb3JtLGs9Yi4kYW5pbWF0ZTtmW3ZkXT0hKGZba2JdPWUuaGFzQ2xhc3Moa2IpKTtkLiRzZXRWYWxpZGl0eT1mdW5jdGlvbihiLGUsZil7ZT09PXQ/KGQuJHBlbmRpbmd8fChkLiRwZW5kaW5nPXt9KSxnKGQuJHBlbmRpbmcsYixmKSk6KGQuJHBlbmRpbmcmJmgoZC4kcGVuZGluZyxiLGYpLHdkKGQuJHBlbmRpbmcpJiYoZC4kcGVuZGluZz10KSk7V2EoZSk/ZT8oaChkLiRlcnJvcixiLGYpLGcoZC4kJHN1Y2Nlc3MsYixmKSk6KGcoZC4kZXJyb3IsYixmKSxoKGQuJCRzdWNjZXNzLGIsZikpOihoKGQuJGVycm9yLGIsZiksaChkLiQkc3VjY2VzcyxiLGYpKTtkLiRwZW5kaW5nPyhhKHhkLCEwKSxkLiR2YWxpZD1kLiRpbnZhbGlkPXQsYyhcIlwiLG51bGwpKTooYSh4ZCwhMSksZC4kdmFsaWQ9d2QoZC4kZXJyb3IpLGQuJGludmFsaWQ9XHJcbiFkLiR2YWxpZCxjKFwiXCIsZC4kdmFsaWQpKTtlPWQuJHBlbmRpbmcmJmQuJHBlbmRpbmdbYl0/dDpkLiRlcnJvcltiXT8hMTpkLiQkc3VjY2Vzc1tiXT8hMDpudWxsO2MoYixlKTtsLiRzZXRWYWxpZGl0eShiLGUsZCl9fWZ1bmN0aW9uIHdkKGIpe2lmKGIpZm9yKHZhciBhIGluIGIpcmV0dXJuITE7cmV0dXJuITB9dmFyIE9mPS9eXFwvKC4rKVxcLyhbYS16XSopJC8sUT1mdW5jdGlvbihiKXtyZXR1cm4gRihiKT9iLnRvTG93ZXJDYXNlKCk6Yn0scmM9T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSx1Yj1mdW5jdGlvbihiKXtyZXR1cm4gRihiKT9iLnRvVXBwZXJDYXNlKCk6Yn0sUmEsQixzYSxaYT1bXS5zbGljZSxyZj1bXS5zcGxpY2UsUGY9W10ucHVzaCxEYT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLEthPVQoXCJuZ1wiKSxnYT1NLmFuZ3VsYXJ8fChNLmFuZ3VsYXI9e30pLGJiLG5iPTA7UmE9WS5kb2N1bWVudE1vZGU7SC4kaW5qZWN0PVtdO3BhLiRpbmplY3Q9W107dmFyIEQ9XHJcbkFycmF5LmlzQXJyYXksVT1mdW5jdGlvbihiKXtyZXR1cm4gRihiKT9iLnRyaW0oKTpifSxnZD1mdW5jdGlvbihiKXtyZXR1cm4gYi5yZXBsYWNlKC8oWy0oKVxcW1xcXXt9Kz8qLiRcXF58LDojPCFcXFxcXSkvZyxcIlxcXFwkMVwiKS5yZXBsYWNlKC9cXHgwOC9nLFwiXFxcXHgwOFwiKX0sYWI9ZnVuY3Rpb24oKXtpZih5KGFiLmlzQWN0aXZlXykpcmV0dXJuIGFiLmlzQWN0aXZlXzt2YXIgYj0hKCFZLnF1ZXJ5U2VsZWN0b3IoXCJbbmctY3NwXVwiKSYmIVkucXVlcnlTZWxlY3RvcihcIltkYXRhLW5nLWNzcF1cIikpO2lmKCFiKXRyeXtuZXcgRnVuY3Rpb24oXCJcIil9Y2F0Y2goYSl7Yj0hMH1yZXR1cm4gYWIuaXNBY3RpdmVfPWJ9LHJiPVtcIm5nLVwiLFwiZGF0YS1uZy1cIixcIm5nOlwiLFwieC1uZy1cIl0sTWQ9L1tBLVpdL2csdWM9ITEsUGIsb2E9MSxwYj0zLFFkPXtmdWxsOlwiMS4zLjlcIixtYWpvcjoxLG1pbm9yOjMsZG90OjksY29kZU5hbWU6XCJtdWx0aWRpbWVuc2lvbmFsLWF3YXJlbmVzc1wifTtSLmV4cGFuZG89XCJuZzMzOVwiO1xyXG52YXIgemI9Ui5jYWNoZT17fSxoZj0xO1IuX2RhdGE9ZnVuY3Rpb24oYil7cmV0dXJuIHRoaXMuY2FjaGVbYlt0aGlzLmV4cGFuZG9dXXx8e319O3ZhciBjZj0vKFtcXDpcXC1cXF9dKyguKSkvZyxkZj0vXm1veihbQS1aXSkvLFFmPXttb3VzZWxlYXZlOlwibW91c2VvdXRcIixtb3VzZWVudGVyOlwibW91c2VvdmVyXCJ9LFNiPVQoXCJqcUxpdGVcIiksZ2Y9L148KFxcdyspXFxzKlxcLz8+KD86PFxcL1xcMT58KSQvLFJiPS88fCYjP1xcdys7LyxlZj0vPChbXFx3Ol0rKS8sZmY9LzwoPyFhcmVhfGJyfGNvbHxlbWJlZHxocnxpbWd8aW5wdXR8bGlua3xtZXRhfHBhcmFtKSgoW1xcdzpdKylbXj5dKilcXC8+L2dpLGlhPXtvcHRpb246WzEsJzxzZWxlY3QgbXVsdGlwbGU9XCJtdWx0aXBsZVwiPicsXCI8L3NlbGVjdD5cIl0sdGhlYWQ6WzEsXCI8dGFibGU+XCIsXCI8L3RhYmxlPlwiXSxjb2w6WzIsXCI8dGFibGU+PGNvbGdyb3VwPlwiLFwiPC9jb2xncm91cD48L3RhYmxlPlwiXSx0cjpbMixcIjx0YWJsZT48dGJvZHk+XCIsXCI8L3Rib2R5PjwvdGFibGU+XCJdLFxyXG50ZDpbMyxcIjx0YWJsZT48dGJvZHk+PHRyPlwiLFwiPC90cj48L3Rib2R5PjwvdGFibGU+XCJdLF9kZWZhdWx0OlswLFwiXCIsXCJcIl19O2lhLm9wdGdyb3VwPWlhLm9wdGlvbjtpYS50Ym9keT1pYS50Zm9vdD1pYS5jb2xncm91cD1pYS5jYXB0aW9uPWlhLnRoZWFkO2lhLnRoPWlhLnRkO3ZhciBMYT1SLnByb3RvdHlwZT17cmVhZHk6ZnVuY3Rpb24oYil7ZnVuY3Rpb24gYSgpe2N8fChjPSEwLGIoKSl9dmFyIGM9ITE7XCJjb21wbGV0ZVwiPT09WS5yZWFkeVN0YXRlP3NldFRpbWVvdXQoYSk6KHRoaXMub24oXCJET01Db250ZW50TG9hZGVkXCIsYSksUihNKS5vbihcImxvYWRcIixhKSl9LHRvU3RyaW5nOmZ1bmN0aW9uKCl7dmFyIGI9W107cyh0aGlzLGZ1bmN0aW9uKGEpe2IucHVzaChcIlwiK2EpfSk7cmV0dXJuXCJbXCIrYi5qb2luKFwiLCBcIikrXCJdXCJ9LGVxOmZ1bmN0aW9uKGIpe3JldHVybiAwPD1iP0IodGhpc1tiXSk6Qih0aGlzW3RoaXMubGVuZ3RoK2JdKX0sbGVuZ3RoOjAscHVzaDpQZixzb3J0OltdLnNvcnQsXHJcbnNwbGljZTpbXS5zcGxpY2V9LEViPXt9O3MoXCJtdWx0aXBsZSBzZWxlY3RlZCBjaGVja2VkIGRpc2FibGVkIHJlYWRPbmx5IHJlcXVpcmVkIG9wZW5cIi5zcGxpdChcIiBcIiksZnVuY3Rpb24oYil7RWJbUShiKV09Yn0pO3ZhciBNYz17fTtzKFwiaW5wdXQgc2VsZWN0IG9wdGlvbiB0ZXh0YXJlYSBidXR0b24gZm9ybSBkZXRhaWxzXCIuc3BsaXQoXCIgXCIpLGZ1bmN0aW9uKGIpe01jW2JdPSEwfSk7dmFyIE5jPXtuZ01pbmxlbmd0aDpcIm1pbmxlbmd0aFwiLG5nTWF4bGVuZ3RoOlwibWF4bGVuZ3RoXCIsbmdNaW46XCJtaW5cIixuZ01heDpcIm1heFwiLG5nUGF0dGVybjpcInBhdHRlcm5cIn07cyh7ZGF0YTpVYixyZW1vdmVEYXRhOnhifSxmdW5jdGlvbihiLGEpe1JbYV09Yn0pO3Moe2RhdGE6VWIsaW5oZXJpdGVkRGF0YTpEYixzY29wZTpmdW5jdGlvbihiKXtyZXR1cm4gQi5kYXRhKGIsXCIkc2NvcGVcIil8fERiKGIucGFyZW50Tm9kZXx8YixbXCIkaXNvbGF0ZVNjb3BlXCIsXCIkc2NvcGVcIl0pfSxpc29sYXRlU2NvcGU6ZnVuY3Rpb24oYil7cmV0dXJuIEIuZGF0YShiLFxyXG5cIiRpc29sYXRlU2NvcGVcIil8fEIuZGF0YShiLFwiJGlzb2xhdGVTY29wZU5vVGVtcGxhdGVcIil9LGNvbnRyb2xsZXI6SWMsaW5qZWN0b3I6ZnVuY3Rpb24oYil7cmV0dXJuIERiKGIsXCIkaW5qZWN0b3JcIil9LHJlbW92ZUF0dHI6ZnVuY3Rpb24oYixhKXtiLnJlbW92ZUF0dHJpYnV0ZShhKX0saGFzQ2xhc3M6QWIsY3NzOmZ1bmN0aW9uKGIsYSxjKXthPWNiKGEpO2lmKHkoYykpYi5zdHlsZVthXT1jO2Vsc2UgcmV0dXJuIGIuc3R5bGVbYV19LGF0dHI6ZnVuY3Rpb24oYixhLGMpe3ZhciBkPVEoYSk7aWYoRWJbZF0paWYoeShjKSljPyhiW2FdPSEwLGIuc2V0QXR0cmlidXRlKGEsZCkpOihiW2FdPSExLGIucmVtb3ZlQXR0cmlidXRlKGQpKTtlbHNlIHJldHVybiBiW2FdfHwoYi5hdHRyaWJ1dGVzLmdldE5hbWVkSXRlbShhKXx8SCkuc3BlY2lmaWVkP2Q6dDtlbHNlIGlmKHkoYykpYi5zZXRBdHRyaWJ1dGUoYSxjKTtlbHNlIGlmKGIuZ2V0QXR0cmlidXRlKXJldHVybiBiPWIuZ2V0QXR0cmlidXRlKGEsXHJcbjIpLG51bGw9PT1iP3Q6Yn0scHJvcDpmdW5jdGlvbihiLGEsYyl7aWYoeShjKSliW2FdPWM7ZWxzZSByZXR1cm4gYlthXX0sdGV4dDpmdW5jdGlvbigpe2Z1bmN0aW9uIGIoYSxiKXtpZihBKGIpKXt2YXIgZD1hLm5vZGVUeXBlO3JldHVybiBkPT09b2F8fGQ9PT1wYj9hLnRleHRDb250ZW50OlwiXCJ9YS50ZXh0Q29udGVudD1ifWIuJGR2PVwiXCI7cmV0dXJuIGJ9KCksdmFsOmZ1bmN0aW9uKGIsYSl7aWYoQShhKSl7aWYoYi5tdWx0aXBsZSYmXCJzZWxlY3RcIj09PXVhKGIpKXt2YXIgYz1bXTtzKGIub3B0aW9ucyxmdW5jdGlvbihhKXthLnNlbGVjdGVkJiZjLnB1c2goYS52YWx1ZXx8YS50ZXh0KX0pO3JldHVybiAwPT09Yy5sZW5ndGg/bnVsbDpjfXJldHVybiBiLnZhbHVlfWIudmFsdWU9YX0saHRtbDpmdW5jdGlvbihiLGEpe2lmKEEoYSkpcmV0dXJuIGIuaW5uZXJIVE1MO3diKGIsITApO2IuaW5uZXJIVE1MPWF9LGVtcHR5OkpjfSxmdW5jdGlvbihiLGEpe1IucHJvdG90eXBlW2FdPWZ1bmN0aW9uKGEsXHJcbmQpe3ZhciBlLGYsZz10aGlzLmxlbmd0aDtpZihiIT09SmMmJigyPT1iLmxlbmd0aCYmYiE9PUFiJiZiIT09SWM/YTpkKT09PXQpe2lmKEkoYSkpe2ZvcihlPTA7ZTxnO2UrKylpZihiPT09VWIpYih0aGlzW2VdLGEpO2Vsc2UgZm9yKGYgaW4gYSliKHRoaXNbZV0sZixhW2ZdKTtyZXR1cm4gdGhpc31lPWIuJGR2O2c9ZT09PXQ/TWF0aC5taW4oZywxKTpnO2ZvcihmPTA7ZjxnO2YrKyl7dmFyIGg9Yih0aGlzW2ZdLGEsZCk7ZT1lP2UraDpofXJldHVybiBlfWZvcihlPTA7ZTxnO2UrKyliKHRoaXNbZV0sYSxkKTtyZXR1cm4gdGhpc319KTtzKHtyZW1vdmVEYXRhOnhiLG9uOmZ1bmN0aW9uIGEoYyxkLGUsZil7aWYoeShmKSl0aHJvdyBTYihcIm9uYXJnc1wiKTtpZihFYyhjKSl7dmFyIGc9eWIoYywhMCk7Zj1nLmV2ZW50czt2YXIgaD1nLmhhbmRsZTtofHwoaD1nLmhhbmRsZT1sZihjLGYpKTtmb3IodmFyIGc9MDw9ZC5pbmRleE9mKFwiIFwiKT9kLnNwbGl0KFwiIFwiKTpbZF0sbD1nLmxlbmd0aDtsLS07KXtkPVxyXG5nW2xdO3ZhciBrPWZbZF07a3x8KGZbZF09W10sXCJtb3VzZWVudGVyXCI9PT1kfHxcIm1vdXNlbGVhdmVcIj09PWQ/YShjLFFmW2RdLGZ1bmN0aW9uKGEpe3ZhciBjPWEucmVsYXRlZFRhcmdldDtjJiYoYz09PXRoaXN8fHRoaXMuY29udGFpbnMoYykpfHxoKGEsZCl9KTpcIiRkZXN0cm95XCIhPT1kJiZjLmFkZEV2ZW50TGlzdGVuZXIoZCxoLCExKSxrPWZbZF0pO2sucHVzaChlKX19fSxvZmY6SGMsb25lOmZ1bmN0aW9uKGEsYyxkKXthPUIoYSk7YS5vbihjLGZ1bmN0aW9uIGYoKXthLm9mZihjLGQpO2Eub2ZmKGMsZil9KTthLm9uKGMsZCl9LHJlcGxhY2VXaXRoOmZ1bmN0aW9uKGEsYyl7dmFyIGQsZT1hLnBhcmVudE5vZGU7d2IoYSk7cyhuZXcgUihjKSxmdW5jdGlvbihjKXtkP2UuaW5zZXJ0QmVmb3JlKGMsZC5uZXh0U2libGluZyk6ZS5yZXBsYWNlQ2hpbGQoYyxhKTtkPWN9KX0sY2hpbGRyZW46ZnVuY3Rpb24oYSl7dmFyIGM9W107cyhhLmNoaWxkTm9kZXMsZnVuY3Rpb24oYSl7YS5ub2RlVHlwZT09PVxyXG5vYSYmYy5wdXNoKGEpfSk7cmV0dXJuIGN9LGNvbnRlbnRzOmZ1bmN0aW9uKGEpe3JldHVybiBhLmNvbnRlbnREb2N1bWVudHx8YS5jaGlsZE5vZGVzfHxbXX0sYXBwZW5kOmZ1bmN0aW9uKGEsYyl7dmFyIGQ9YS5ub2RlVHlwZTtpZihkPT09b2F8fDExPT09ZCl7Yz1uZXcgUihjKTtmb3IodmFyIGQ9MCxlPWMubGVuZ3RoO2Q8ZTtkKyspYS5hcHBlbmRDaGlsZChjW2RdKX19LHByZXBlbmQ6ZnVuY3Rpb24oYSxjKXtpZihhLm5vZGVUeXBlPT09b2Epe3ZhciBkPWEuZmlyc3RDaGlsZDtzKG5ldyBSKGMpLGZ1bmN0aW9uKGMpe2EuaW5zZXJ0QmVmb3JlKGMsZCl9KX19LHdyYXA6ZnVuY3Rpb24oYSxjKXtjPUIoYykuZXEoMCkuY2xvbmUoKVswXTt2YXIgZD1hLnBhcmVudE5vZGU7ZCYmZC5yZXBsYWNlQ2hpbGQoYyxhKTtjLmFwcGVuZENoaWxkKGEpfSxyZW1vdmU6S2MsZGV0YWNoOmZ1bmN0aW9uKGEpe0tjKGEsITApfSxhZnRlcjpmdW5jdGlvbihhLGMpe3ZhciBkPWEsZT1hLnBhcmVudE5vZGU7XHJcbmM9bmV3IFIoYyk7Zm9yKHZhciBmPTAsZz1jLmxlbmd0aDtmPGc7ZisrKXt2YXIgaD1jW2ZdO2UuaW5zZXJ0QmVmb3JlKGgsZC5uZXh0U2libGluZyk7ZD1ofX0sYWRkQ2xhc3M6Q2IscmVtb3ZlQ2xhc3M6QmIsdG9nZ2xlQ2xhc3M6ZnVuY3Rpb24oYSxjLGQpe2MmJnMoYy5zcGxpdChcIiBcIiksZnVuY3Rpb24oYyl7dmFyIGY9ZDtBKGYpJiYoZj0hQWIoYSxjKSk7KGY/Q2I6QmIpKGEsYyl9KX0scGFyZW50OmZ1bmN0aW9uKGEpe3JldHVybihhPWEucGFyZW50Tm9kZSkmJjExIT09YS5ub2RlVHlwZT9hOm51bGx9LG5leHQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGEubmV4dEVsZW1lbnRTaWJsaW5nfSxmaW5kOmZ1bmN0aW9uKGEsYyl7cmV0dXJuIGEuZ2V0RWxlbWVudHNCeVRhZ05hbWU/YS5nZXRFbGVtZW50c0J5VGFnTmFtZShjKTpbXX0sY2xvbmU6VGIsdHJpZ2dlckhhbmRsZXI6ZnVuY3Rpb24oYSxjLGQpe3ZhciBlLGYsZz1jLnR5cGV8fGMsaD15YihhKTtpZihoPShoPWgmJmguZXZlbnRzKSYmXHJcbmhbZ10pZT17cHJldmVudERlZmF1bHQ6ZnVuY3Rpb24oKXt0aGlzLmRlZmF1bHRQcmV2ZW50ZWQ9ITB9LGlzRGVmYXVsdFByZXZlbnRlZDpmdW5jdGlvbigpe3JldHVybiEwPT09dGhpcy5kZWZhdWx0UHJldmVudGVkfSxzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb246ZnVuY3Rpb24oKXt0aGlzLmltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZD0hMH0saXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ6ZnVuY3Rpb24oKXtyZXR1cm4hMD09PXRoaXMuaW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkfSxzdG9wUHJvcGFnYXRpb246SCx0eXBlOmcsdGFyZ2V0OmF9LGMudHlwZSYmKGU9eihlLGMpKSxjPXJhKGgpLGY9ZD9bZV0uY29uY2F0KGQpOltlXSxzKGMsZnVuY3Rpb24oYyl7ZS5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCgpfHxjLmFwcGx5KGEsZil9KX19LGZ1bmN0aW9uKGEsYyl7Ui5wcm90b3R5cGVbY109ZnVuY3Rpb24oYyxlLGYpe2Zvcih2YXIgZyxoPTAsbD10aGlzLmxlbmd0aDtoPFxyXG5sO2grKylBKGcpPyhnPWEodGhpc1toXSxjLGUsZikseShnKSYmKGc9QihnKSkpOkdjKGcsYSh0aGlzW2hdLGMsZSxmKSk7cmV0dXJuIHkoZyk/Zzp0aGlzfTtSLnByb3RvdHlwZS5iaW5kPVIucHJvdG90eXBlLm9uO1IucHJvdG90eXBlLnVuYmluZD1SLnByb3RvdHlwZS5vZmZ9KTtkYi5wcm90b3R5cGU9e3B1dDpmdW5jdGlvbihhLGMpe3RoaXNbTmEoYSx0aGlzLm5leHRVaWQpXT1jfSxnZXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXNbTmEoYSx0aGlzLm5leHRVaWQpXX0scmVtb3ZlOmZ1bmN0aW9uKGEpe3ZhciBjPXRoaXNbYT1OYShhLHRoaXMubmV4dFVpZCldO2RlbGV0ZSB0aGlzW2FdO3JldHVybiBjfX07dmFyIFBjPS9eZnVuY3Rpb25cXHMqW15cXChdKlxcKFxccyooW15cXCldKilcXCkvbSxuZj0vLC8sb2Y9L15cXHMqKF8/KShcXFMrPylcXDFcXHMqJC8sT2M9LygoXFwvXFwvLiokKXwoXFwvXFwqW1xcc1xcU10qP1xcKlxcLykpL21nLEdhPVQoXCIkaW5qZWN0b3JcIik7T2IuJCRhbm5vdGF0ZT1WYjt2YXIgUmY9XHJcblQoXCIkYW5pbWF0ZVwiKSxDZT1bXCIkcHJvdmlkZVwiLGZ1bmN0aW9uKGEpe3RoaXMuJCRzZWxlY3RvcnM9e307dGhpcy5yZWdpc3Rlcj1mdW5jdGlvbihjLGQpe3ZhciBlPWMrXCItYW5pbWF0aW9uXCI7aWYoYyYmXCIuXCIhPWMuY2hhckF0KDApKXRocm93IFJmKFwibm90Y3NlbFwiLGMpO3RoaXMuJCRzZWxlY3RvcnNbYy5zdWJzdHIoMSldPWU7YS5mYWN0b3J5KGUsZCl9O3RoaXMuY2xhc3NOYW1lRmlsdGVyPWZ1bmN0aW9uKGEpezE9PT1hcmd1bWVudHMubGVuZ3RoJiYodGhpcy4kJGNsYXNzTmFtZUZpbHRlcj1hIGluc3RhbmNlb2YgUmVnRXhwP2E6bnVsbCk7cmV0dXJuIHRoaXMuJCRjbGFzc05hbWVGaWx0ZXJ9O3RoaXMuJGdldD1bXCIkJHFcIixcIiQkYXN5bmNDYWxsYmFja1wiLFwiJHJvb3RTY29wZVwiLGZ1bmN0aW9uKGEsZCxlKXtmdW5jdGlvbiBmKGQpe3ZhciBmLGc9YS5kZWZlcigpO2cucHJvbWlzZS4kJGNhbmNlbEZuPWZ1bmN0aW9uKCl7ZiYmZigpfTtlLiQkcG9zdERpZ2VzdChmdW5jdGlvbigpe2Y9XHJcbmQoZnVuY3Rpb24oKXtnLnJlc29sdmUoKX0pfSk7cmV0dXJuIGcucHJvbWlzZX1mdW5jdGlvbiBnKGEsYyl7dmFyIGQ9W10sZT1bXSxmPWhhKCk7cygoYS5hdHRyKFwiY2xhc3NcIil8fFwiXCIpLnNwbGl0KC9cXHMrLyksZnVuY3Rpb24oYSl7ZlthXT0hMH0pO3MoYyxmdW5jdGlvbihhLGMpe3ZhciBnPWZbY107ITE9PT1hJiZnP2UucHVzaChjKTohMCE9PWF8fGd8fGQucHVzaChjKX0pO3JldHVybiAwPGQubGVuZ3RoK2UubGVuZ3RoJiZbZC5sZW5ndGg/ZDpudWxsLGUubGVuZ3RoP2U6bnVsbF19ZnVuY3Rpb24gaChhLGMsZCl7Zm9yKHZhciBlPTAsZj1jLmxlbmd0aDtlPGY7KytlKWFbY1tlXV09ZH1mdW5jdGlvbiBsKCl7bXx8KG09YS5kZWZlcigpLGQoZnVuY3Rpb24oKXttLnJlc29sdmUoKTttPW51bGx9KSk7cmV0dXJuIG0ucHJvbWlzZX1mdW5jdGlvbiBrKGEsYyl7aWYoZ2EuaXNPYmplY3QoYykpe3ZhciBkPXooYy5mcm9tfHx7fSxjLnRvfHx7fSk7YS5jc3MoZCl9fXZhciBtO3JldHVybnthbmltYXRlOmZ1bmN0aW9uKGEsXHJcbmMsZCl7ayhhLHtmcm9tOmMsdG86ZH0pO3JldHVybiBsKCl9LGVudGVyOmZ1bmN0aW9uKGEsYyxkLGUpe2soYSxlKTtkP2QuYWZ0ZXIoYSk6Yy5wcmVwZW5kKGEpO3JldHVybiBsKCl9LGxlYXZlOmZ1bmN0aW9uKGEsYyl7YS5yZW1vdmUoKTtyZXR1cm4gbCgpfSxtb3ZlOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiB0aGlzLmVudGVyKGEsYyxkLGUpfSxhZGRDbGFzczpmdW5jdGlvbihhLGMsZCl7cmV0dXJuIHRoaXMuc2V0Q2xhc3MoYSxjLFtdLGQpfSwkJGFkZENsYXNzSW1tZWRpYXRlbHk6ZnVuY3Rpb24oYSxjLGQpe2E9QihhKTtjPUYoYyk/YzpEKGMpP2Muam9pbihcIiBcIik6XCJcIjtzKGEsZnVuY3Rpb24oYSl7Q2IoYSxjKX0pO2soYSxkKTtyZXR1cm4gbCgpfSxyZW1vdmVDbGFzczpmdW5jdGlvbihhLGMsZCl7cmV0dXJuIHRoaXMuc2V0Q2xhc3MoYSxbXSxjLGQpfSwkJHJlbW92ZUNsYXNzSW1tZWRpYXRlbHk6ZnVuY3Rpb24oYSxjLGQpe2E9QihhKTtjPUYoYyk/YzpEKGMpP2Muam9pbihcIiBcIik6XHJcblwiXCI7cyhhLGZ1bmN0aW9uKGEpe0JiKGEsYyl9KTtrKGEsZCk7cmV0dXJuIGwoKX0sc2V0Q2xhc3M6ZnVuY3Rpb24oYSxjLGQsZSl7dmFyIGs9dGhpcyxsPSExO2E9QihhKTt2YXIgbT1hLmRhdGEoXCIkJGFuaW1hdGVDbGFzc2VzXCIpO20/ZSYmbS5vcHRpb25zJiYobS5vcHRpb25zPWdhLmV4dGVuZChtLm9wdGlvbnN8fHt9LGUpKToobT17Y2xhc3Nlczp7fSxvcHRpb25zOmV9LGw9ITApO2U9bS5jbGFzc2VzO2M9RChjKT9jOmMuc3BsaXQoXCIgXCIpO2Q9RChkKT9kOmQuc3BsaXQoXCIgXCIpO2goZSxjLCEwKTtoKGUsZCwhMSk7bCYmKG0ucHJvbWlzZT1mKGZ1bmN0aW9uKGMpe3ZhciBkPWEuZGF0YShcIiQkYW5pbWF0ZUNsYXNzZXNcIik7YS5yZW1vdmVEYXRhKFwiJCRhbmltYXRlQ2xhc3Nlc1wiKTtpZihkKXt2YXIgZT1nKGEsZC5jbGFzc2VzKTtlJiZrLiQkc2V0Q2xhc3NJbW1lZGlhdGVseShhLGVbMF0sZVsxXSxkLm9wdGlvbnMpfWMoKX0pLGEuZGF0YShcIiQkYW5pbWF0ZUNsYXNzZXNcIixtKSk7XHJcbnJldHVybiBtLnByb21pc2V9LCQkc2V0Q2xhc3NJbW1lZGlhdGVseTpmdW5jdGlvbihhLGMsZCxlKXtjJiZ0aGlzLiQkYWRkQ2xhc3NJbW1lZGlhdGVseShhLGMpO2QmJnRoaXMuJCRyZW1vdmVDbGFzc0ltbWVkaWF0ZWx5KGEsZCk7ayhhLGUpO3JldHVybiBsKCl9LGVuYWJsZWQ6SCxjYW5jZWw6SH19XX1dLGphPVQoXCIkY29tcGlsZVwiKTt3Yy4kaW5qZWN0PVtcIiRwcm92aWRlXCIsXCIkJHNhbml0aXplVXJpUHJvdmlkZXJcIl07dmFyIFJjPS9eKCg/Onh8ZGF0YSlbXFw6XFwtX10pL2ksVmM9XCJhcHBsaWNhdGlvbi9qc29uXCIsWmI9e1wiQ29udGVudC1UeXBlXCI6VmMrXCI7Y2hhcnNldD11dGYtOFwifSx0Zj0vXlxcW3xeXFx7KD8hXFx7KS8sdWY9e1wiW1wiOi9dJC8sXCJ7XCI6L30kL30sc2Y9L15cXClcXF1cXH0nLD9cXG4vLCRiPVQoXCIkaW50ZXJwb2xhdGVcIiksU2Y9L14oW15cXD8jXSopKFxcPyhbXiNdKikpPygjKC4qKSk/JC8seGY9e2h0dHA6ODAsaHR0cHM6NDQzLGZ0cDoyMX0sRmI9VChcIiRsb2NhdGlvblwiKSxUZj1cclxueyQkaHRtbDU6ITEsJCRyZXBsYWNlOiExLGFic1VybDpHYihcIiQkYWJzVXJsXCIpLHVybDpmdW5jdGlvbihhKXtpZihBKGEpKXJldHVybiB0aGlzLiQkdXJsO3ZhciBjPVNmLmV4ZWMoYSk7KGNbMV18fFwiXCI9PT1hKSYmdGhpcy5wYXRoKGRlY29kZVVSSUNvbXBvbmVudChjWzFdKSk7KGNbMl18fGNbMV18fFwiXCI9PT1hKSYmdGhpcy5zZWFyY2goY1szXXx8XCJcIik7dGhpcy5oYXNoKGNbNV18fFwiXCIpO3JldHVybiB0aGlzfSxwcm90b2NvbDpHYihcIiQkcHJvdG9jb2xcIiksaG9zdDpHYihcIiQkaG9zdFwiKSxwb3J0OkdiKFwiJCRwb3J0XCIpLHBhdGg6ZGQoXCIkJHBhdGhcIixmdW5jdGlvbihhKXthPW51bGwhPT1hP2EudG9TdHJpbmcoKTpcIlwiO3JldHVyblwiL1wiPT1hLmNoYXJBdCgwKT9hOlwiL1wiK2F9KSxzZWFyY2g6ZnVuY3Rpb24oYSxjKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiB0aGlzLiQkc2VhcmNoO2Nhc2UgMTppZihGKGEpfHxWKGEpKWE9YS50b1N0cmluZygpLHRoaXMuJCRzZWFyY2g9XHJcbnFjKGEpO2Vsc2UgaWYoSShhKSlhPUVhKGEse30pLHMoYSxmdW5jdGlvbihjLGUpe251bGw9PWMmJmRlbGV0ZSBhW2VdfSksdGhpcy4kJHNlYXJjaD1hO2Vsc2UgdGhyb3cgRmIoXCJpc3JjaGFyZ1wiKTticmVhaztkZWZhdWx0OkEoYyl8fG51bGw9PT1jP2RlbGV0ZSB0aGlzLiQkc2VhcmNoW2FdOnRoaXMuJCRzZWFyY2hbYV09Y310aGlzLiQkY29tcG9zZSgpO3JldHVybiB0aGlzfSxoYXNoOmRkKFwiJCRoYXNoXCIsZnVuY3Rpb24oYSl7cmV0dXJuIG51bGwhPT1hP2EudG9TdHJpbmcoKTpcIlwifSkscmVwbGFjZTpmdW5jdGlvbigpe3RoaXMuJCRyZXBsYWNlPSEwO3JldHVybiB0aGlzfX07cyhbY2QsZGMsY2NdLGZ1bmN0aW9uKGEpe2EucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoVGYpO2EucHJvdG90eXBlLnN0YXRlPWZ1bmN0aW9uKGMpe2lmKCFhcmd1bWVudHMubGVuZ3RoKXJldHVybiB0aGlzLiQkc3RhdGU7aWYoYSE9PWNjfHwhdGhpcy4kJGh0bWw1KXRocm93IEZiKFwibm9zdGF0ZVwiKTt0aGlzLiQkc3RhdGU9XHJcbkEoYyk/bnVsbDpjO3JldHVybiB0aGlzfX0pO3ZhciBsYT1UKFwiJHBhcnNlXCIpLFVmPUZ1bmN0aW9uLnByb3RvdHlwZS5jYWxsLFZmPUZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseSxXZj1GdW5jdGlvbi5wcm90b3R5cGUuYmluZCxsYj1oYSgpO3Moe1wibnVsbFwiOmZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9LFwidHJ1ZVwiOmZ1bmN0aW9uKCl7cmV0dXJuITB9LFwiZmFsc2VcIjpmdW5jdGlvbigpe3JldHVybiExfSx1bmRlZmluZWQ6ZnVuY3Rpb24oKXt9fSxmdW5jdGlvbihhLGMpe2EuY29uc3RhbnQ9YS5saXRlcmFsPWEuc2hhcmVkR2V0dGVyPSEwO2xiW2NdPWF9KTtsYltcInRoaXNcIl09ZnVuY3Rpb24oYSl7cmV0dXJuIGF9O2xiW1widGhpc1wiXS5zaGFyZWRHZXR0ZXI9ITA7dmFyIG1iPXooaGEoKSx7XCIrXCI6ZnVuY3Rpb24oYSxjLGQsZSl7ZD1kKGEsYyk7ZT1lKGEsYyk7cmV0dXJuIHkoZCk/eShlKT9kK2U6ZDp5KGUpP2U6dH0sXCItXCI6ZnVuY3Rpb24oYSxjLGQsZSl7ZD1kKGEsYyk7ZT1lKGEsYyk7XHJcbnJldHVybih5KGQpP2Q6MCktKHkoZSk/ZTowKX0sXCIqXCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKSplKGEsYyl9LFwiL1wiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYykvZShhLGMpfSxcIiVcIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpJWUoYSxjKX0sXCI9PT1cIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpPT09ZShhLGMpfSxcIiE9PVwiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYykhPT1lKGEsYyl9LFwiPT1cIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpPT1lKGEsYyl9LFwiIT1cIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpIT1lKGEsYyl9LFwiPFwiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYyk8ZShhLGMpfSxcIj5cIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpPmUoYSxjKX0sXCI8PVwiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYyk8PWUoYSxjKX0sXCI+PVwiOmZ1bmN0aW9uKGEsYyxcclxuZCxlKXtyZXR1cm4gZChhLGMpPj1lKGEsYyl9LFwiJiZcIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpJiZlKGEsYyl9LFwifHxcIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpfHxlKGEsYyl9LFwiIVwiOmZ1bmN0aW9uKGEsYyxkKXtyZXR1cm4hZChhLGMpfSxcIj1cIjohMCxcInxcIjohMH0pLFhmPXtuOlwiXFxuXCIsZjpcIlxcZlwiLHI6XCJcXHJcIix0OlwiXFx0XCIsdjpcIlxcdlwiLFwiJ1wiOlwiJ1wiLCdcIic6J1wiJ30sZ2M9ZnVuY3Rpb24oYSl7dGhpcy5vcHRpb25zPWF9O2djLnByb3RvdHlwZT17Y29uc3RydWN0b3I6Z2MsbGV4OmZ1bmN0aW9uKGEpe3RoaXMudGV4dD1hO3RoaXMuaW5kZXg9MDtmb3IodGhpcy50b2tlbnM9W107dGhpcy5pbmRleDx0aGlzLnRleHQubGVuZ3RoOylpZihhPXRoaXMudGV4dC5jaGFyQXQodGhpcy5pbmRleCksJ1wiJz09PWF8fFwiJ1wiPT09YSl0aGlzLnJlYWRTdHJpbmcoYSk7ZWxzZSBpZih0aGlzLmlzTnVtYmVyKGEpfHxcIi5cIj09PWEmJnRoaXMuaXNOdW1iZXIodGhpcy5wZWVrKCkpKXRoaXMucmVhZE51bWJlcigpO1xyXG5lbHNlIGlmKHRoaXMuaXNJZGVudChhKSl0aGlzLnJlYWRJZGVudCgpO2Vsc2UgaWYodGhpcy5pcyhhLFwiKCl7fVtdLiw7Oj9cIikpdGhpcy50b2tlbnMucHVzaCh7aW5kZXg6dGhpcy5pbmRleCx0ZXh0OmF9KSx0aGlzLmluZGV4Kys7ZWxzZSBpZih0aGlzLmlzV2hpdGVzcGFjZShhKSl0aGlzLmluZGV4Kys7ZWxzZXt2YXIgYz1hK3RoaXMucGVlaygpLGQ9Yyt0aGlzLnBlZWsoMiksZT1tYltjXSxmPW1iW2RdO21iW2FdfHxlfHxmPyhhPWY/ZDplP2M6YSx0aGlzLnRva2Vucy5wdXNoKHtpbmRleDp0aGlzLmluZGV4LHRleHQ6YSxvcGVyYXRvcjohMH0pLHRoaXMuaW5kZXgrPWEubGVuZ3RoKTp0aGlzLnRocm93RXJyb3IoXCJVbmV4cGVjdGVkIG5leHQgY2hhcmFjdGVyIFwiLHRoaXMuaW5kZXgsdGhpcy5pbmRleCsxKX1yZXR1cm4gdGhpcy50b2tlbnN9LGlzOmZ1bmN0aW9uKGEsYyl7cmV0dXJuLTEhPT1jLmluZGV4T2YoYSl9LHBlZWs6ZnVuY3Rpb24oYSl7YT1hfHwxO3JldHVybiB0aGlzLmluZGV4K1xyXG5hPHRoaXMudGV4dC5sZW5ndGg/dGhpcy50ZXh0LmNoYXJBdCh0aGlzLmluZGV4K2EpOiExfSxpc051bWJlcjpmdW5jdGlvbihhKXtyZXR1cm5cIjBcIjw9YSYmXCI5XCI+PWEmJlwic3RyaW5nXCI9PT10eXBlb2YgYX0saXNXaGl0ZXNwYWNlOmZ1bmN0aW9uKGEpe3JldHVyblwiIFwiPT09YXx8XCJcXHJcIj09PWF8fFwiXFx0XCI9PT1hfHxcIlxcblwiPT09YXx8XCJcXHZcIj09PWF8fFwiXFx1MDBhMFwiPT09YX0saXNJZGVudDpmdW5jdGlvbihhKXtyZXR1cm5cImFcIjw9YSYmXCJ6XCI+PWF8fFwiQVwiPD1hJiZcIlpcIj49YXx8XCJfXCI9PT1hfHxcIiRcIj09PWF9LGlzRXhwT3BlcmF0b3I6ZnVuY3Rpb24oYSl7cmV0dXJuXCItXCI9PT1hfHxcIitcIj09PWF8fHRoaXMuaXNOdW1iZXIoYSl9LHRocm93RXJyb3I6ZnVuY3Rpb24oYSxjLGQpe2Q9ZHx8dGhpcy5pbmRleDtjPXkoYyk/XCJzIFwiK2MrXCItXCIrdGhpcy5pbmRleCtcIiBbXCIrdGhpcy50ZXh0LnN1YnN0cmluZyhjLGQpK1wiXVwiOlwiIFwiK2Q7dGhyb3cgbGEoXCJsZXhlcnJcIixhLGMsdGhpcy50ZXh0KTtcclxufSxyZWFkTnVtYmVyOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPVwiXCIsYz10aGlzLmluZGV4O3RoaXMuaW5kZXg8dGhpcy50ZXh0Lmxlbmd0aDspe3ZhciBkPVEodGhpcy50ZXh0LmNoYXJBdCh0aGlzLmluZGV4KSk7aWYoXCIuXCI9PWR8fHRoaXMuaXNOdW1iZXIoZCkpYSs9ZDtlbHNle3ZhciBlPXRoaXMucGVlaygpO2lmKFwiZVwiPT1kJiZ0aGlzLmlzRXhwT3BlcmF0b3IoZSkpYSs9ZDtlbHNlIGlmKHRoaXMuaXNFeHBPcGVyYXRvcihkKSYmZSYmdGhpcy5pc051bWJlcihlKSYmXCJlXCI9PWEuY2hhckF0KGEubGVuZ3RoLTEpKWErPWQ7ZWxzZSBpZighdGhpcy5pc0V4cE9wZXJhdG9yKGQpfHxlJiZ0aGlzLmlzTnVtYmVyKGUpfHxcImVcIiE9YS5jaGFyQXQoYS5sZW5ndGgtMSkpYnJlYWs7ZWxzZSB0aGlzLnRocm93RXJyb3IoXCJJbnZhbGlkIGV4cG9uZW50XCIpfXRoaXMuaW5kZXgrK310aGlzLnRva2Vucy5wdXNoKHtpbmRleDpjLHRleHQ6YSxjb25zdGFudDohMCx2YWx1ZTpOdW1iZXIoYSl9KX0scmVhZElkZW50OmZ1bmN0aW9uKCl7Zm9yKHZhciBhPVxyXG50aGlzLmluZGV4O3RoaXMuaW5kZXg8dGhpcy50ZXh0Lmxlbmd0aDspe3ZhciBjPXRoaXMudGV4dC5jaGFyQXQodGhpcy5pbmRleCk7aWYoIXRoaXMuaXNJZGVudChjKSYmIXRoaXMuaXNOdW1iZXIoYykpYnJlYWs7dGhpcy5pbmRleCsrfXRoaXMudG9rZW5zLnB1c2goe2luZGV4OmEsdGV4dDp0aGlzLnRleHQuc2xpY2UoYSx0aGlzLmluZGV4KSxpZGVudGlmaWVyOiEwfSl9LHJlYWRTdHJpbmc6ZnVuY3Rpb24oYSl7dmFyIGM9dGhpcy5pbmRleDt0aGlzLmluZGV4Kys7Zm9yKHZhciBkPVwiXCIsZT1hLGY9ITE7dGhpcy5pbmRleDx0aGlzLnRleHQubGVuZ3RoOyl7dmFyIGc9dGhpcy50ZXh0LmNoYXJBdCh0aGlzLmluZGV4KSxlPWUrZztpZihmKVwidVwiPT09Zz8oZj10aGlzLnRleHQuc3Vic3RyaW5nKHRoaXMuaW5kZXgrMSx0aGlzLmluZGV4KzUpLGYubWF0Y2goL1tcXGRhLWZdezR9L2kpfHx0aGlzLnRocm93RXJyb3IoXCJJbnZhbGlkIHVuaWNvZGUgZXNjYXBlIFtcXFxcdVwiK2YrXCJdXCIpLHRoaXMuaW5kZXgrPVxyXG40LGQrPVN0cmluZy5mcm9tQ2hhckNvZGUocGFyc2VJbnQoZiwxNikpKTpkKz1YZltnXXx8ZyxmPSExO2Vsc2UgaWYoXCJcXFxcXCI9PT1nKWY9ITA7ZWxzZXtpZihnPT09YSl7dGhpcy5pbmRleCsrO3RoaXMudG9rZW5zLnB1c2goe2luZGV4OmMsdGV4dDplLGNvbnN0YW50OiEwLHZhbHVlOmR9KTtyZXR1cm59ZCs9Z310aGlzLmluZGV4Kyt9dGhpcy50aHJvd0Vycm9yKFwiVW50ZXJtaW5hdGVkIHF1b3RlXCIsYyl9fTt2YXIgaGI9ZnVuY3Rpb24oYSxjLGQpe3RoaXMubGV4ZXI9YTt0aGlzLiRmaWx0ZXI9Yzt0aGlzLm9wdGlvbnM9ZH07aGIuWkVSTz16KGZ1bmN0aW9uKCl7cmV0dXJuIDB9LHtzaGFyZWRHZXR0ZXI6ITAsY29uc3RhbnQ6ITB9KTtoYi5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOmhiLHBhcnNlOmZ1bmN0aW9uKGEpe3RoaXMudGV4dD1hO3RoaXMudG9rZW5zPXRoaXMubGV4ZXIubGV4KGEpO2E9dGhpcy5zdGF0ZW1lbnRzKCk7MCE9PXRoaXMudG9rZW5zLmxlbmd0aCYmdGhpcy50aHJvd0Vycm9yKFwiaXMgYW4gdW5leHBlY3RlZCB0b2tlblwiLFxyXG50aGlzLnRva2Vuc1swXSk7YS5saXRlcmFsPSEhYS5saXRlcmFsO2EuY29uc3RhbnQ9ISFhLmNvbnN0YW50O3JldHVybiBhfSxwcmltYXJ5OmZ1bmN0aW9uKCl7dmFyIGE7dGhpcy5leHBlY3QoXCIoXCIpPyhhPXRoaXMuZmlsdGVyQ2hhaW4oKSx0aGlzLmNvbnN1bWUoXCIpXCIpKTp0aGlzLmV4cGVjdChcIltcIik/YT10aGlzLmFycmF5RGVjbGFyYXRpb24oKTp0aGlzLmV4cGVjdChcIntcIik/YT10aGlzLm9iamVjdCgpOnRoaXMucGVlaygpLmlkZW50aWZpZXImJnRoaXMucGVlaygpLnRleHQgaW4gbGI/YT1sYlt0aGlzLmNvbnN1bWUoKS50ZXh0XTp0aGlzLnBlZWsoKS5pZGVudGlmaWVyP2E9dGhpcy5pZGVudGlmaWVyKCk6dGhpcy5wZWVrKCkuY29uc3RhbnQ/YT10aGlzLmNvbnN0YW50KCk6dGhpcy50aHJvd0Vycm9yKFwibm90IGEgcHJpbWFyeSBleHByZXNzaW9uXCIsdGhpcy5wZWVrKCkpO2Zvcih2YXIgYyxkO2M9dGhpcy5leHBlY3QoXCIoXCIsXCJbXCIsXCIuXCIpOylcIihcIj09PWMudGV4dD8oYT10aGlzLmZ1bmN0aW9uQ2FsbChhLFxyXG5kKSxkPW51bGwpOlwiW1wiPT09Yy50ZXh0PyhkPWEsYT10aGlzLm9iamVjdEluZGV4KGEpKTpcIi5cIj09PWMudGV4dD8oZD1hLGE9dGhpcy5maWVsZEFjY2VzcyhhKSk6dGhpcy50aHJvd0Vycm9yKFwiSU1QT1NTSUJMRVwiKTtyZXR1cm4gYX0sdGhyb3dFcnJvcjpmdW5jdGlvbihhLGMpe3Rocm93IGxhKFwic3ludGF4XCIsYy50ZXh0LGEsYy5pbmRleCsxLHRoaXMudGV4dCx0aGlzLnRleHQuc3Vic3RyaW5nKGMuaW5kZXgpKTt9LHBlZWtUb2tlbjpmdW5jdGlvbigpe2lmKDA9PT10aGlzLnRva2Vucy5sZW5ndGgpdGhyb3cgbGEoXCJ1ZW9lXCIsdGhpcy50ZXh0KTtyZXR1cm4gdGhpcy50b2tlbnNbMF19LHBlZWs6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIHRoaXMucGVla0FoZWFkKDAsYSxjLGQsZSl9LHBlZWtBaGVhZDpmdW5jdGlvbihhLGMsZCxlLGYpe2lmKHRoaXMudG9rZW5zLmxlbmd0aD5hKXthPXRoaXMudG9rZW5zW2FdO3ZhciBnPWEudGV4dDtpZihnPT09Y3x8Zz09PWR8fGc9PT1lfHxnPT09XHJcbmZ8fCEoY3x8ZHx8ZXx8ZikpcmV0dXJuIGF9cmV0dXJuITF9LGV4cGVjdDpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4oYT10aGlzLnBlZWsoYSxjLGQsZSkpPyh0aGlzLnRva2Vucy5zaGlmdCgpLGEpOiExfSxjb25zdW1lOmZ1bmN0aW9uKGEpe2lmKDA9PT10aGlzLnRva2Vucy5sZW5ndGgpdGhyb3cgbGEoXCJ1ZW9lXCIsdGhpcy50ZXh0KTt2YXIgYz10aGlzLmV4cGVjdChhKTtjfHx0aGlzLnRocm93RXJyb3IoXCJpcyB1bmV4cGVjdGVkLCBleHBlY3RpbmcgW1wiK2ErXCJdXCIsdGhpcy5wZWVrKCkpO3JldHVybiBjfSx1bmFyeUZuOmZ1bmN0aW9uKGEsYyl7dmFyIGQ9bWJbYV07cmV0dXJuIHooZnVuY3Rpb24oYSxmKXtyZXR1cm4gZChhLGYsYyl9LHtjb25zdGFudDpjLmNvbnN0YW50LGlucHV0czpbY119KX0sYmluYXJ5Rm46ZnVuY3Rpb24oYSxjLGQsZSl7dmFyIGY9bWJbY107cmV0dXJuIHooZnVuY3Rpb24oYyxlKXtyZXR1cm4gZihjLGUsYSxkKX0se2NvbnN0YW50OmEuY29uc3RhbnQmJlxyXG5kLmNvbnN0YW50LGlucHV0czohZSYmW2EsZF19KX0saWRlbnRpZmllcjpmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLmNvbnN1bWUoKS50ZXh0O3RoaXMucGVlayhcIi5cIikmJnRoaXMucGVla0FoZWFkKDEpLmlkZW50aWZpZXImJiF0aGlzLnBlZWtBaGVhZCgyLFwiKFwiKTspYSs9dGhpcy5jb25zdW1lKCkudGV4dCt0aGlzLmNvbnN1bWUoKS50ZXh0O3JldHVybiB6ZihhLHRoaXMub3B0aW9ucyx0aGlzLnRleHQpfSxjb25zdGFudDpmdW5jdGlvbigpe3ZhciBhPXRoaXMuY29uc3VtZSgpLnZhbHVlO3JldHVybiB6KGZ1bmN0aW9uKCl7cmV0dXJuIGF9LHtjb25zdGFudDohMCxsaXRlcmFsOiEwfSl9LHN0YXRlbWVudHM6ZnVuY3Rpb24oKXtmb3IodmFyIGE9W107OylpZigwPHRoaXMudG9rZW5zLmxlbmd0aCYmIXRoaXMucGVlayhcIn1cIixcIilcIixcIjtcIixcIl1cIikmJmEucHVzaCh0aGlzLmZpbHRlckNoYWluKCkpLCF0aGlzLmV4cGVjdChcIjtcIikpcmV0dXJuIDE9PT1hLmxlbmd0aD9hWzBdOmZ1bmN0aW9uKGMsXHJcbmQpe2Zvcih2YXIgZSxmPTAsZz1hLmxlbmd0aDtmPGc7ZisrKWU9YVtmXShjLGQpO3JldHVybiBlfX0sZmlsdGVyQ2hhaW46ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5leHByZXNzaW9uKCk7dGhpcy5leHBlY3QoXCJ8XCIpOylhPXRoaXMuZmlsdGVyKGEpO3JldHVybiBhfSxmaWx0ZXI6ZnVuY3Rpb24oYSl7dmFyIGM9dGhpcy4kZmlsdGVyKHRoaXMuY29uc3VtZSgpLnRleHQpLGQsZTtpZih0aGlzLnBlZWsoXCI6XCIpKWZvcihkPVtdLGU9W107dGhpcy5leHBlY3QoXCI6XCIpOylkLnB1c2godGhpcy5leHByZXNzaW9uKCkpO3ZhciBmPVthXS5jb25jYXQoZHx8W10pO3JldHVybiB6KGZ1bmN0aW9uKGYsaCl7dmFyIGw9YShmLGgpO2lmKGUpe2VbMF09bDtmb3IobD1kLmxlbmd0aDtsLS07KWVbbCsxXT1kW2xdKGYsaCk7cmV0dXJuIGMuYXBwbHkodCxlKX1yZXR1cm4gYyhsKX0se2NvbnN0YW50OiFjLiRzdGF0ZWZ1bCYmZi5ldmVyeShlYyksaW5wdXRzOiFjLiRzdGF0ZWZ1bCYmZn0pfSxleHByZXNzaW9uOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYXNzaWdubWVudCgpfSxcclxuYXNzaWdubWVudDpmdW5jdGlvbigpe3ZhciBhPXRoaXMudGVybmFyeSgpLGMsZDtyZXR1cm4oZD10aGlzLmV4cGVjdChcIj1cIikpPyhhLmFzc2lnbnx8dGhpcy50aHJvd0Vycm9yKFwiaW1wbGllcyBhc3NpZ25tZW50IGJ1dCBbXCIrdGhpcy50ZXh0LnN1YnN0cmluZygwLGQuaW5kZXgpK1wiXSBjYW4gbm90IGJlIGFzc2lnbmVkIHRvXCIsZCksYz10aGlzLnRlcm5hcnkoKSx6KGZ1bmN0aW9uKGQsZil7cmV0dXJuIGEuYXNzaWduKGQsYyhkLGYpLGYpfSx7aW5wdXRzOlthLGNdfSkpOmF9LHRlcm5hcnk6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmxvZ2ljYWxPUigpLGM7aWYodGhpcy5leHBlY3QoXCI/XCIpJiYoYz10aGlzLmFzc2lnbm1lbnQoKSx0aGlzLmNvbnN1bWUoXCI6XCIpKSl7dmFyIGQ9dGhpcy5hc3NpZ25tZW50KCk7cmV0dXJuIHooZnVuY3Rpb24oZSxmKXtyZXR1cm4gYShlLGYpP2MoZSxmKTpkKGUsZil9LHtjb25zdGFudDphLmNvbnN0YW50JiZjLmNvbnN0YW50JiZkLmNvbnN0YW50fSl9cmV0dXJuIGF9LFxyXG5sb2dpY2FsT1I6ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5sb2dpY2FsQU5EKCksYztjPXRoaXMuZXhwZWN0KFwifHxcIik7KWE9dGhpcy5iaW5hcnlGbihhLGMudGV4dCx0aGlzLmxvZ2ljYWxBTkQoKSwhMCk7cmV0dXJuIGF9LGxvZ2ljYWxBTkQ6ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5lcXVhbGl0eSgpLGM7Yz10aGlzLmV4cGVjdChcIiYmXCIpOylhPXRoaXMuYmluYXJ5Rm4oYSxjLnRleHQsdGhpcy5lcXVhbGl0eSgpLCEwKTtyZXR1cm4gYX0sZXF1YWxpdHk6ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5yZWxhdGlvbmFsKCksYztjPXRoaXMuZXhwZWN0KFwiPT1cIixcIiE9XCIsXCI9PT1cIixcIiE9PVwiKTspYT10aGlzLmJpbmFyeUZuKGEsYy50ZXh0LHRoaXMucmVsYXRpb25hbCgpKTtyZXR1cm4gYX0scmVsYXRpb25hbDpmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLmFkZGl0aXZlKCksYztjPXRoaXMuZXhwZWN0KFwiPFwiLFwiPlwiLFwiPD1cIixcIj49XCIpOylhPXRoaXMuYmluYXJ5Rm4oYSxjLnRleHQsXHJcbnRoaXMuYWRkaXRpdmUoKSk7cmV0dXJuIGF9LGFkZGl0aXZlOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMubXVsdGlwbGljYXRpdmUoKSxjO2M9dGhpcy5leHBlY3QoXCIrXCIsXCItXCIpOylhPXRoaXMuYmluYXJ5Rm4oYSxjLnRleHQsdGhpcy5tdWx0aXBsaWNhdGl2ZSgpKTtyZXR1cm4gYX0sbXVsdGlwbGljYXRpdmU6ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy51bmFyeSgpLGM7Yz10aGlzLmV4cGVjdChcIipcIixcIi9cIixcIiVcIik7KWE9dGhpcy5iaW5hcnlGbihhLGMudGV4dCx0aGlzLnVuYXJ5KCkpO3JldHVybiBhfSx1bmFyeTpmdW5jdGlvbigpe3ZhciBhO3JldHVybiB0aGlzLmV4cGVjdChcIitcIik/dGhpcy5wcmltYXJ5KCk6KGE9dGhpcy5leHBlY3QoXCItXCIpKT90aGlzLmJpbmFyeUZuKGhiLlpFUk8sYS50ZXh0LHRoaXMudW5hcnkoKSk6KGE9dGhpcy5leHBlY3QoXCIhXCIpKT90aGlzLnVuYXJ5Rm4oYS50ZXh0LHRoaXMudW5hcnkoKSk6dGhpcy5wcmltYXJ5KCl9LGZpZWxkQWNjZXNzOmZ1bmN0aW9uKGEpe3ZhciBjPVxyXG50aGlzLmlkZW50aWZpZXIoKTtyZXR1cm4geihmdW5jdGlvbihkLGUsZil7ZD1mfHxhKGQsZSk7cmV0dXJuIG51bGw9PWQ/dDpjKGQpfSx7YXNzaWduOmZ1bmN0aW9uKGQsZSxmKXt2YXIgZz1hKGQsZik7Z3x8YS5hc3NpZ24oZCxnPXt9LGYpO3JldHVybiBjLmFzc2lnbihnLGUpfX0pfSxvYmplY3RJbmRleDpmdW5jdGlvbihhKXt2YXIgYz10aGlzLnRleHQsZD10aGlzLmV4cHJlc3Npb24oKTt0aGlzLmNvbnN1bWUoXCJdXCIpO3JldHVybiB6KGZ1bmN0aW9uKGUsZil7dmFyIGc9YShlLGYpLGg9ZChlLGYpO3RhKGgsYyk7cmV0dXJuIGc/bWEoZ1toXSxjKTp0fSx7YXNzaWduOmZ1bmN0aW9uKGUsZixnKXt2YXIgaD10YShkKGUsZyksYyksbD1tYShhKGUsZyksYyk7bHx8YS5hc3NpZ24oZSxsPXt9LGcpO3JldHVybiBsW2hdPWZ9fSl9LGZ1bmN0aW9uQ2FsbDpmdW5jdGlvbihhLGMpe3ZhciBkPVtdO2lmKFwiKVwiIT09dGhpcy5wZWVrVG9rZW4oKS50ZXh0KXtkbyBkLnB1c2godGhpcy5leHByZXNzaW9uKCkpO1xyXG53aGlsZSh0aGlzLmV4cGVjdChcIixcIikpfXRoaXMuY29uc3VtZShcIilcIik7dmFyIGU9dGhpcy50ZXh0LGY9ZC5sZW5ndGg/W106bnVsbDtyZXR1cm4gZnVuY3Rpb24oZyxoKXt2YXIgbD1jP2MoZyxoKTp5KGMpP3Q6ZyxrPWEoZyxoLGwpfHxIO2lmKGYpZm9yKHZhciBtPWQubGVuZ3RoO20tLTspZlttXT1tYShkW21dKGcsaCksZSk7bWEobCxlKTtpZihrKXtpZihrLmNvbnN0cnVjdG9yPT09ayl0aHJvdyBsYShcImlzZWNmblwiLGUpO2lmKGs9PT1VZnx8az09PVZmfHxrPT09V2YpdGhyb3cgbGEoXCJpc2VjZmZcIixlKTt9bD1rLmFwcGx5P2suYXBwbHkobCxmKTprKGZbMF0sZlsxXSxmWzJdLGZbM10sZls0XSk7cmV0dXJuIG1hKGwsZSl9fSxhcnJheURlY2xhcmF0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9W107aWYoXCJdXCIhPT10aGlzLnBlZWtUb2tlbigpLnRleHQpe2Rve2lmKHRoaXMucGVlayhcIl1cIikpYnJlYWs7YS5wdXNoKHRoaXMuZXhwcmVzc2lvbigpKX13aGlsZSh0aGlzLmV4cGVjdChcIixcIikpXHJcbn10aGlzLmNvbnN1bWUoXCJdXCIpO3JldHVybiB6KGZ1bmN0aW9uKGMsZCl7Zm9yKHZhciBlPVtdLGY9MCxnPWEubGVuZ3RoO2Y8ZztmKyspZS5wdXNoKGFbZl0oYyxkKSk7cmV0dXJuIGV9LHtsaXRlcmFsOiEwLGNvbnN0YW50OmEuZXZlcnkoZWMpLGlucHV0czphfSl9LG9iamVjdDpmdW5jdGlvbigpe3ZhciBhPVtdLGM9W107aWYoXCJ9XCIhPT10aGlzLnBlZWtUb2tlbigpLnRleHQpe2Rve2lmKHRoaXMucGVlayhcIn1cIikpYnJlYWs7dmFyIGQ9dGhpcy5jb25zdW1lKCk7ZC5jb25zdGFudD9hLnB1c2goZC52YWx1ZSk6ZC5pZGVudGlmaWVyP2EucHVzaChkLnRleHQpOnRoaXMudGhyb3dFcnJvcihcImludmFsaWQga2V5XCIsZCk7dGhpcy5jb25zdW1lKFwiOlwiKTtjLnB1c2godGhpcy5leHByZXNzaW9uKCkpfXdoaWxlKHRoaXMuZXhwZWN0KFwiLFwiKSl9dGhpcy5jb25zdW1lKFwifVwiKTtyZXR1cm4geihmdW5jdGlvbihkLGYpe2Zvcih2YXIgZz17fSxoPTAsbD1jLmxlbmd0aDtoPGw7aCsrKWdbYVtoXV09XHJcbmNbaF0oZCxmKTtyZXR1cm4gZ30se2xpdGVyYWw6ITAsY29uc3RhbnQ6Yy5ldmVyeShlYyksaW5wdXRzOmN9KX19O3ZhciBCZj1oYSgpLEFmPWhhKCksQ2Y9T2JqZWN0LnByb3RvdHlwZS52YWx1ZU9mLENhPVQoXCIkc2NlXCIpLG5hPXtIVE1MOlwiaHRtbFwiLENTUzpcImNzc1wiLFVSTDpcInVybFwiLFJFU09VUkNFX1VSTDpcInJlc291cmNlVXJsXCIsSlM6XCJqc1wifSxqYT1UKFwiJGNvbXBpbGVcIiksWj1ZLmNyZWF0ZUVsZW1lbnQoXCJhXCIpLGlkPUJhKE0ubG9jYXRpb24uaHJlZik7RGMuJGluamVjdD1bXCIkcHJvdmlkZVwiXTtqZC4kaW5qZWN0PVtcIiRsb2NhbGVcIl07bGQuJGluamVjdD1bXCIkbG9jYWxlXCJdO3ZhciBvZD1cIi5cIixNZj17eXl5eTokKFwiRnVsbFllYXJcIiw0KSx5eTokKFwiRnVsbFllYXJcIiwyLDAsITApLHk6JChcIkZ1bGxZZWFyXCIsMSksTU1NTTpJYihcIk1vbnRoXCIpLE1NTTpJYihcIk1vbnRoXCIsITApLE1NOiQoXCJNb250aFwiLDIsMSksTTokKFwiTW9udGhcIiwxLDEpLGRkOiQoXCJEYXRlXCIsMiksZDokKFwiRGF0ZVwiLFxyXG4xKSxISDokKFwiSG91cnNcIiwyKSxIOiQoXCJIb3Vyc1wiLDEpLGhoOiQoXCJIb3Vyc1wiLDIsLTEyKSxoOiQoXCJIb3Vyc1wiLDEsLTEyKSxtbTokKFwiTWludXRlc1wiLDIpLG06JChcIk1pbnV0ZXNcIiwxKSxzczokKFwiU2Vjb25kc1wiLDIpLHM6JChcIlNlY29uZHNcIiwxKSxzc3M6JChcIk1pbGxpc2Vjb25kc1wiLDMpLEVFRUU6SWIoXCJEYXlcIiksRUVFOkliKFwiRGF5XCIsITApLGE6ZnVuY3Rpb24oYSxjKXtyZXR1cm4gMTI+YS5nZXRIb3VycygpP2MuQU1QTVNbMF06Yy5BTVBNU1sxXX0sWjpmdW5jdGlvbihhKXthPS0xKmEuZ2V0VGltZXpvbmVPZmZzZXQoKTtyZXR1cm4gYT0oMDw9YT9cIitcIjpcIlwiKSsoSGIoTWF0aFswPGE/XCJmbG9vclwiOlwiY2VpbFwiXShhLzYwKSwyKStIYihNYXRoLmFicyhhJTYwKSwyKSl9LHd3OnFkKDIpLHc6cWQoMSl9LExmPS8oKD86W155TWRIaG1zYVpFdyddKyl8KD86Jyg/OlteJ118JycpKicpfCg/OkUrfHkrfE0rfGQrfEgrfGgrfG0rfHMrfGF8Wnx3KykpKC4qKS8sS2Y9L15cXC0/XFxkKyQvO1xyXG5rZC4kaW5qZWN0PVtcIiRsb2NhbGVcIl07dmFyIEhmPWRhKFEpLElmPWRhKHViKTttZC4kaW5qZWN0PVtcIiRwYXJzZVwiXTt2YXIgVGQ9ZGEoe3Jlc3RyaWN0OlwiRVwiLGNvbXBpbGU6ZnVuY3Rpb24oYSxjKXtpZighYy5ocmVmJiYhYy54bGlua0hyZWYmJiFjLm5hbWUpcmV0dXJuIGZ1bmN0aW9uKGEsYyl7dmFyIGY9XCJbb2JqZWN0IFNWR0FuaW1hdGVkU3RyaW5nXVwiPT09RGEuY2FsbChjLnByb3AoXCJocmVmXCIpKT9cInhsaW5rOmhyZWZcIjpcImhyZWZcIjtjLm9uKFwiY2xpY2tcIixmdW5jdGlvbihhKXtjLmF0dHIoZil8fGEucHJldmVudERlZmF1bHQoKX0pfX19KSx2Yj17fTtzKEViLGZ1bmN0aW9uKGEsYyl7aWYoXCJtdWx0aXBsZVwiIT1hKXt2YXIgZD15YShcIm5nLVwiK2MpO3ZiW2RdPWZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiQVwiLHByaW9yaXR5OjEwMCxsaW5rOmZ1bmN0aW9uKGEsZixnKXthLiR3YXRjaChnW2RdLGZ1bmN0aW9uKGEpe2cuJHNldChjLCEhYSl9KX19fX19KTtzKE5jLGZ1bmN0aW9uKGEsXHJcbmMpe3ZiW2NdPWZ1bmN0aW9uKCl7cmV0dXJue3ByaW9yaXR5OjEwMCxsaW5rOmZ1bmN0aW9uKGEsZSxmKXtpZihcIm5nUGF0dGVyblwiPT09YyYmXCIvXCI9PWYubmdQYXR0ZXJuLmNoYXJBdCgwKSYmKGU9Zi5uZ1BhdHRlcm4ubWF0Y2goT2YpKSl7Zi4kc2V0KFwibmdQYXR0ZXJuXCIsbmV3IFJlZ0V4cChlWzFdLGVbMl0pKTtyZXR1cm59YS4kd2F0Y2goZltjXSxmdW5jdGlvbihhKXtmLiRzZXQoYyxhKX0pfX19fSk7cyhbXCJzcmNcIixcInNyY3NldFwiLFwiaHJlZlwiXSxmdW5jdGlvbihhKXt2YXIgYz15YShcIm5nLVwiK2EpO3ZiW2NdPWZ1bmN0aW9uKCl7cmV0dXJue3ByaW9yaXR5Ojk5LGxpbms6ZnVuY3Rpb24oZCxlLGYpe3ZhciBnPWEsaD1hO1wiaHJlZlwiPT09YSYmXCJbb2JqZWN0IFNWR0FuaW1hdGVkU3RyaW5nXVwiPT09RGEuY2FsbChlLnByb3AoXCJocmVmXCIpKSYmKGg9XCJ4bGlua0hyZWZcIixmLiRhdHRyW2hdPVwieGxpbms6aHJlZlwiLGc9bnVsbCk7Zi4kb2JzZXJ2ZShjLGZ1bmN0aW9uKGMpe2M/KGYuJHNldChoLFxyXG5jKSxSYSYmZyYmZS5wcm9wKGcsZltoXSkpOlwiaHJlZlwiPT09YSYmZi4kc2V0KGgsbnVsbCl9KX19fX0pO3ZhciBKYj17JGFkZENvbnRyb2w6SCwkJHJlbmFtZUNvbnRyb2w6ZnVuY3Rpb24oYSxjKXthLiRuYW1lPWN9LCRyZW1vdmVDb250cm9sOkgsJHNldFZhbGlkaXR5OkgsJHNldERpcnR5OkgsJHNldFByaXN0aW5lOkgsJHNldFN1Ym1pdHRlZDpIfTtyZC4kaW5qZWN0PVtcIiRlbGVtZW50XCIsXCIkYXR0cnNcIixcIiRzY29wZVwiLFwiJGFuaW1hdGVcIixcIiRpbnRlcnBvbGF0ZVwiXTt2YXIgeWQ9ZnVuY3Rpb24oYSl7cmV0dXJuW1wiJHRpbWVvdXRcIixmdW5jdGlvbihjKXtyZXR1cm57bmFtZTpcImZvcm1cIixyZXN0cmljdDphP1wiRUFDXCI6XCJFXCIsY29udHJvbGxlcjpyZCxjb21waWxlOmZ1bmN0aW9uKGEpe2EuYWRkQ2xhc3MoU2EpLmFkZENsYXNzKGtiKTtyZXR1cm57cHJlOmZ1bmN0aW9uKGEsZCxnLGgpe2lmKCEoXCJhY3Rpb25cImluIGcpKXt2YXIgbD1mdW5jdGlvbihjKXthLiRhcHBseShmdW5jdGlvbigpe2guJGNvbW1pdFZpZXdWYWx1ZSgpO1xyXG5oLiRzZXRTdWJtaXR0ZWQoKX0pO2MucHJldmVudERlZmF1bHQoKX07ZFswXS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsbCwhMSk7ZC5vbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXtjKGZ1bmN0aW9uKCl7ZFswXS5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VibWl0XCIsbCwhMSl9LDAsITEpfSl9dmFyIGs9aC4kJHBhcmVudEZvcm0sbT1oLiRuYW1lO20mJihnYihhLG51bGwsbSxoLG0pLGcuJG9ic2VydmUoZy5uYW1lP1wibmFtZVwiOlwibmdGb3JtXCIsZnVuY3Rpb24oYyl7bSE9PWMmJihnYihhLG51bGwsbSx0LG0pLG09YyxnYihhLG51bGwsbSxoLG0pLGsuJCRyZW5hbWVDb250cm9sKGgsbSkpfSkpO2Qub24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7ay4kcmVtb3ZlQ29udHJvbChoKTttJiZnYihhLG51bGwsbSx0LG0pO3ooaCxKYil9KX19fX19XX0sVWQ9eWQoKSxnZT15ZCghMCksTmY9L1xcZHs0fS1bMDFdXFxkLVswLTNdXFxkVFswLTJdXFxkOlswLTVdXFxkOlswLTVdXFxkXFwuXFxkKyhbKy1dWzAtMl1cXGQ6WzAtNV1cXGR8WikvLFxyXG5ZZj0vXihmdHB8aHR0cHxodHRwcyk6XFwvXFwvKFxcdys6ezAsMX1cXHcqQCk/KFxcUyspKDpbMC05XSspPyhcXC98XFwvKFtcXHcjITouPys9JiVAIVxcLVxcL10pKT8kLyxaZj0vXlthLXowLTkhIyQlJicqK1xcLz0/Xl9ge3x9fi4tXStAW2EtejAtOV0oW2EtejAtOS1dKlthLXowLTldKT8oXFwuW2EtejAtOV0oW2EtejAtOS1dKlthLXowLTldKT8pKiQvaSwkZj0vXlxccyooXFwtfFxcKyk/KFxcZCt8KFxcZCooXFwuXFxkKikpKVxccyokLyx6ZD0vXihcXGR7NH0pLShcXGR7Mn0pLShcXGR7Mn0pJC8sQWQ9L14oXFxkezR9KS0oXFxkXFxkKS0oXFxkXFxkKVQoXFxkXFxkKTooXFxkXFxkKSg/OjooXFxkXFxkKShcXC5cXGR7MSwzfSk/KT8kLyxqYz0vXihcXGR7NH0pLVcoXFxkXFxkKSQvLEJkPS9eKFxcZHs0fSktKFxcZFxcZCkkLyxDZD0vXihcXGRcXGQpOihcXGRcXGQpKD86OihcXGRcXGQpKFxcLlxcZHsxLDN9KT8pPyQvLERkPXt0ZXh0OmZ1bmN0aW9uKGEsYyxkLGUsZixnKXtpYihhLGMsZCxlLGYsZyk7aGMoZSl9LGRhdGU6amIoXCJkYXRlXCIsemQsTGIoemQsW1wieXl5eVwiLFxyXG5cIk1NXCIsXCJkZFwiXSksXCJ5eXl5LU1NLWRkXCIpLFwiZGF0ZXRpbWUtbG9jYWxcIjpqYihcImRhdGV0aW1lbG9jYWxcIixBZCxMYihBZCxcInl5eXkgTU0gZGQgSEggbW0gc3Mgc3NzXCIuc3BsaXQoXCIgXCIpKSxcInl5eXktTU0tZGRUSEg6bW06c3Muc3NzXCIpLHRpbWU6amIoXCJ0aW1lXCIsQ2QsTGIoQ2QsW1wiSEhcIixcIm1tXCIsXCJzc1wiLFwic3NzXCJdKSxcIkhIOm1tOnNzLnNzc1wiKSx3ZWVrOmpiKFwid2Vla1wiLGpjLGZ1bmN0aW9uKGEsYyl7aWYocWEoYSkpcmV0dXJuIGE7aWYoRihhKSl7amMubGFzdEluZGV4PTA7dmFyIGQ9amMuZXhlYyhhKTtpZihkKXt2YXIgZT0rZFsxXSxmPStkWzJdLGc9ZD0wLGg9MCxsPTAsaz1wZChlKSxmPTcqKGYtMSk7YyYmKGQ9Yy5nZXRIb3VycygpLGc9Yy5nZXRNaW51dGVzKCksaD1jLmdldFNlY29uZHMoKSxsPWMuZ2V0TWlsbGlzZWNvbmRzKCkpO3JldHVybiBuZXcgRGF0ZShlLDAsay5nZXREYXRlKCkrZixkLGcsaCxsKX19cmV0dXJuIE5hTn0sXCJ5eXl5LVd3d1wiKSxtb250aDpqYihcIm1vbnRoXCIsXHJcbkJkLExiKEJkLFtcInl5eXlcIixcIk1NXCJdKSxcInl5eXktTU1cIiksbnVtYmVyOmZ1bmN0aW9uKGEsYyxkLGUsZixnKXt0ZChhLGMsZCxlKTtpYihhLGMsZCxlLGYsZyk7ZS4kJHBhcnNlck5hbWU9XCJudW1iZXJcIjtlLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24oYSl7cmV0dXJuIGUuJGlzRW1wdHkoYSk/bnVsbDokZi50ZXN0KGEpP3BhcnNlRmxvYXQoYSk6dH0pO2UuJGZvcm1hdHRlcnMucHVzaChmdW5jdGlvbihhKXtpZighZS4kaXNFbXB0eShhKSl7aWYoIVYoYSkpdGhyb3cgTWIoXCJudW1mbXRcIixhKTthPWEudG9TdHJpbmcoKX1yZXR1cm4gYX0pO2lmKGQubWlufHxkLm5nTWluKXt2YXIgaDtlLiR2YWxpZGF0b3JzLm1pbj1mdW5jdGlvbihhKXtyZXR1cm4gZS4kaXNFbXB0eShhKXx8QShoKXx8YT49aH07ZC4kb2JzZXJ2ZShcIm1pblwiLGZ1bmN0aW9uKGEpe3koYSkmJiFWKGEpJiYoYT1wYXJzZUZsb2F0KGEsMTApKTtoPVYoYSkmJiFpc05hTihhKT9hOnQ7ZS4kdmFsaWRhdGUoKX0pfWlmKGQubWF4fHxcclxuZC5uZ01heCl7dmFyIGw7ZS4kdmFsaWRhdG9ycy5tYXg9ZnVuY3Rpb24oYSl7cmV0dXJuIGUuJGlzRW1wdHkoYSl8fEEobCl8fGE8PWx9O2QuJG9ic2VydmUoXCJtYXhcIixmdW5jdGlvbihhKXt5KGEpJiYhVihhKSYmKGE9cGFyc2VGbG9hdChhLDEwKSk7bD1WKGEpJiYhaXNOYU4oYSk/YTp0O2UuJHZhbGlkYXRlKCl9KX19LHVybDpmdW5jdGlvbihhLGMsZCxlLGYsZyl7aWIoYSxjLGQsZSxmLGcpO2hjKGUpO2UuJCRwYXJzZXJOYW1lPVwidXJsXCI7ZS4kdmFsaWRhdG9ycy51cmw9ZnVuY3Rpb24oYSxjKXt2YXIgZD1hfHxjO3JldHVybiBlLiRpc0VtcHR5KGQpfHxZZi50ZXN0KGQpfX0sZW1haWw6ZnVuY3Rpb24oYSxjLGQsZSxmLGcpe2liKGEsYyxkLGUsZixnKTtoYyhlKTtlLiQkcGFyc2VyTmFtZT1cImVtYWlsXCI7ZS4kdmFsaWRhdG9ycy5lbWFpbD1mdW5jdGlvbihhLGMpe3ZhciBkPWF8fGM7cmV0dXJuIGUuJGlzRW1wdHkoZCl8fFpmLnRlc3QoZCl9fSxyYWRpbzpmdW5jdGlvbihhLGMsXHJcbmQsZSl7QShkLm5hbWUpJiZjLmF0dHIoXCJuYW1lXCIsKytuYik7Yy5vbihcImNsaWNrXCIsZnVuY3Rpb24oYSl7Y1swXS5jaGVja2VkJiZlLiRzZXRWaWV3VmFsdWUoZC52YWx1ZSxhJiZhLnR5cGUpfSk7ZS4kcmVuZGVyPWZ1bmN0aW9uKCl7Y1swXS5jaGVja2VkPWQudmFsdWU9PWUuJHZpZXdWYWx1ZX07ZC4kb2JzZXJ2ZShcInZhbHVlXCIsZS4kcmVuZGVyKX0sY2hlY2tib3g6ZnVuY3Rpb24oYSxjLGQsZSxmLGcsaCxsKXt2YXIgaz11ZChsLGEsXCJuZ1RydWVWYWx1ZVwiLGQubmdUcnVlVmFsdWUsITApLG09dWQobCxhLFwibmdGYWxzZVZhbHVlXCIsZC5uZ0ZhbHNlVmFsdWUsITEpO2Mub24oXCJjbGlja1wiLGZ1bmN0aW9uKGEpe2UuJHNldFZpZXdWYWx1ZShjWzBdLmNoZWNrZWQsYSYmYS50eXBlKX0pO2UuJHJlbmRlcj1mdW5jdGlvbigpe2NbMF0uY2hlY2tlZD1lLiR2aWV3VmFsdWV9O2UuJGlzRW1wdHk9ZnVuY3Rpb24oYSl7cmV0dXJuITE9PT1hfTtlLiRmb3JtYXR0ZXJzLnB1c2goZnVuY3Rpb24oYSl7cmV0dXJuIGZhKGEsXHJcbmspfSk7ZS4kcGFyc2Vycy5wdXNoKGZ1bmN0aW9uKGEpe3JldHVybiBhP2s6bX0pfSxoaWRkZW46SCxidXR0b246SCxzdWJtaXQ6SCxyZXNldDpILGZpbGU6SH0seGM9W1wiJGJyb3dzZXJcIixcIiRzbmlmZmVyXCIsXCIkZmlsdGVyXCIsXCIkcGFyc2VcIixmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm57cmVzdHJpY3Q6XCJFXCIscmVxdWlyZTpbXCI/bmdNb2RlbFwiXSxsaW5rOntwcmU6ZnVuY3Rpb24oZixnLGgsbCl7bFswXSYmKERkW1EoaC50eXBlKV18fERkLnRleHQpKGYsZyxoLGxbMF0sYyxhLGQsZSl9fX19XSxhZz0vXih0cnVlfGZhbHNlfFxcZCspJC8seWU9ZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJBXCIscHJpb3JpdHk6MTAwLGNvbXBpbGU6ZnVuY3Rpb24oYSxjKXtyZXR1cm4gYWcudGVzdChjLm5nVmFsdWUpP2Z1bmN0aW9uKGEsYyxmKXtmLiRzZXQoXCJ2YWx1ZVwiLGEuJGV2YWwoZi5uZ1ZhbHVlKSl9OmZ1bmN0aW9uKGEsYyxmKXthLiR3YXRjaChmLm5nVmFsdWUsZnVuY3Rpb24oYSl7Zi4kc2V0KFwidmFsdWVcIixcclxuYSl9KX19fX0sWmQ9W1wiJGNvbXBpbGVcIixmdW5jdGlvbihhKXtyZXR1cm57cmVzdHJpY3Q6XCJBQ1wiLGNvbXBpbGU6ZnVuY3Rpb24oYyl7YS4kJGFkZEJpbmRpbmdDbGFzcyhjKTtyZXR1cm4gZnVuY3Rpb24oYyxlLGYpe2EuJCRhZGRCaW5kaW5nSW5mbyhlLGYubmdCaW5kKTtlPWVbMF07Yy4kd2F0Y2goZi5uZ0JpbmQsZnVuY3Rpb24oYSl7ZS50ZXh0Q29udGVudD1hPT09dD9cIlwiOmF9KX19fX1dLGFlPVtcIiRpbnRlcnBvbGF0ZVwiLFwiJGNvbXBpbGVcIixmdW5jdGlvbihhLGMpe3JldHVybntjb21waWxlOmZ1bmN0aW9uKGQpe2MuJCRhZGRCaW5kaW5nQ2xhc3MoZCk7cmV0dXJuIGZ1bmN0aW9uKGQsZixnKXtkPWEoZi5hdHRyKGcuJGF0dHIubmdCaW5kVGVtcGxhdGUpKTtjLiQkYWRkQmluZGluZ0luZm8oZixkLmV4cHJlc3Npb25zKTtmPWZbMF07Zy4kb2JzZXJ2ZShcIm5nQmluZFRlbXBsYXRlXCIsZnVuY3Rpb24oYSl7Zi50ZXh0Q29udGVudD1hPT09dD9cIlwiOmF9KX19fX1dLCRkPVtcIiRzY2VcIixcclxuXCIkcGFyc2VcIixcIiRjb21waWxlXCIsZnVuY3Rpb24oYSxjLGQpe3JldHVybntyZXN0cmljdDpcIkFcIixjb21waWxlOmZ1bmN0aW9uKGUsZil7dmFyIGc9YyhmLm5nQmluZEh0bWwpLGg9YyhmLm5nQmluZEh0bWwsZnVuY3Rpb24oYSl7cmV0dXJuKGF8fFwiXCIpLnRvU3RyaW5nKCl9KTtkLiQkYWRkQmluZGluZ0NsYXNzKGUpO3JldHVybiBmdW5jdGlvbihjLGUsZil7ZC4kJGFkZEJpbmRpbmdJbmZvKGUsZi5uZ0JpbmRIdG1sKTtjLiR3YXRjaChoLGZ1bmN0aW9uKCl7ZS5odG1sKGEuZ2V0VHJ1c3RlZEh0bWwoZyhjKSl8fFwiXCIpfSl9fX19XSx4ZT1kYSh7cmVzdHJpY3Q6XCJBXCIscmVxdWlyZTpcIm5nTW9kZWxcIixsaW5rOmZ1bmN0aW9uKGEsYyxkLGUpe2UuJHZpZXdDaGFuZ2VMaXN0ZW5lcnMucHVzaChmdW5jdGlvbigpe2EuJGV2YWwoZC5uZ0NoYW5nZSl9KX19KSxiZT1pYyhcIlwiLCEwKSxkZT1pYyhcIk9kZFwiLDApLGNlPWljKFwiRXZlblwiLDEpLGVlPUphKHtjb21waWxlOmZ1bmN0aW9uKGEsYyl7Yy4kc2V0KFwibmdDbG9ha1wiLFxyXG50KTthLnJlbW92ZUNsYXNzKFwibmctY2xvYWtcIil9fSksZmU9W2Z1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiQVwiLHNjb3BlOiEwLGNvbnRyb2xsZXI6XCJAXCIscHJpb3JpdHk6NTAwfX1dLENjPXt9LGJnPXtibHVyOiEwLGZvY3VzOiEwfTtzKFwiY2xpY2sgZGJsY2xpY2sgbW91c2Vkb3duIG1vdXNldXAgbW91c2VvdmVyIG1vdXNlb3V0IG1vdXNlbW92ZSBtb3VzZWVudGVyIG1vdXNlbGVhdmUga2V5ZG93biBrZXl1cCBrZXlwcmVzcyBzdWJtaXQgZm9jdXMgYmx1ciBjb3B5IGN1dCBwYXN0ZVwiLnNwbGl0KFwiIFwiKSxmdW5jdGlvbihhKXt2YXIgYz15YShcIm5nLVwiK2EpO0NjW2NdPVtcIiRwYXJzZVwiLFwiJHJvb3RTY29wZVwiLGZ1bmN0aW9uKGQsZSl7cmV0dXJue3Jlc3RyaWN0OlwiQVwiLGNvbXBpbGU6ZnVuY3Rpb24oZixnKXt2YXIgaD1kKGdbY10sbnVsbCwhMCk7cmV0dXJuIGZ1bmN0aW9uKGMsZCl7ZC5vbihhLGZ1bmN0aW9uKGQpe3ZhciBmPWZ1bmN0aW9uKCl7aChjLHskZXZlbnQ6ZH0pfTtcclxuYmdbYV0mJmUuJCRwaGFzZT9jLiRldmFsQXN5bmMoZik6Yy4kYXBwbHkoZil9KX19fX1dfSk7dmFyIGllPVtcIiRhbmltYXRlXCIsZnVuY3Rpb24oYSl7cmV0dXJue211bHRpRWxlbWVudDohMCx0cmFuc2NsdWRlOlwiZWxlbWVudFwiLHByaW9yaXR5OjYwMCx0ZXJtaW5hbDohMCxyZXN0cmljdDpcIkFcIiwkJHRsYjohMCxsaW5rOmZ1bmN0aW9uKGMsZCxlLGYsZyl7dmFyIGgsbCxrO2MuJHdhdGNoKGUubmdJZixmdW5jdGlvbihjKXtjP2x8fGcoZnVuY3Rpb24oYyxmKXtsPWY7Y1tjLmxlbmd0aCsrXT1ZLmNyZWF0ZUNvbW1lbnQoXCIgZW5kIG5nSWY6IFwiK2UubmdJZitcIiBcIik7aD17Y2xvbmU6Y307YS5lbnRlcihjLGQucGFyZW50KCksZCl9KTooayYmKGsucmVtb3ZlKCksaz1udWxsKSxsJiYobC4kZGVzdHJveSgpLGw9bnVsbCksaCYmKGs9dGIoaC5jbG9uZSksYS5sZWF2ZShrKS50aGVuKGZ1bmN0aW9uKCl7az1udWxsfSksaD1udWxsKSl9KX19fV0samU9W1wiJHRlbXBsYXRlUmVxdWVzdFwiLFwiJGFuY2hvclNjcm9sbFwiLFxyXG5cIiRhbmltYXRlXCIsXCIkc2NlXCIsZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJue3Jlc3RyaWN0OlwiRUNBXCIscHJpb3JpdHk6NDAwLHRlcm1pbmFsOiEwLHRyYW5zY2x1ZGU6XCJlbGVtZW50XCIsY29udHJvbGxlcjpnYS5ub29wLGNvbXBpbGU6ZnVuY3Rpb24oZixnKXt2YXIgaD1nLm5nSW5jbHVkZXx8Zy5zcmMsbD1nLm9ubG9hZHx8XCJcIixrPWcuYXV0b3Njcm9sbDtyZXR1cm4gZnVuY3Rpb24oZixnLHEscyxyKXt2YXIgdD0wLG4sdix3LEw9ZnVuY3Rpb24oKXt2JiYodi5yZW1vdmUoKSx2PW51bGwpO24mJihuLiRkZXN0cm95KCksbj1udWxsKTt3JiYoZC5sZWF2ZSh3KS50aGVuKGZ1bmN0aW9uKCl7dj1udWxsfSksdj13LHc9bnVsbCl9O2YuJHdhdGNoKGUucGFyc2VBc1Jlc291cmNlVXJsKGgpLGZ1bmN0aW9uKGUpe3ZhciBoPWZ1bmN0aW9uKCl7IXkoayl8fGsmJiFmLiRldmFsKGspfHxjKCl9LHE9Kyt0O2U/KGEoZSwhMCkudGhlbihmdW5jdGlvbihhKXtpZihxPT09dCl7dmFyIGM9Zi4kbmV3KCk7XHJcbnMudGVtcGxhdGU9YTthPXIoYyxmdW5jdGlvbihhKXtMKCk7ZC5lbnRlcihhLG51bGwsZykudGhlbihoKX0pO249Yzt3PWE7bi4kZW1pdChcIiRpbmNsdWRlQ29udGVudExvYWRlZFwiLGUpO2YuJGV2YWwobCl9fSxmdW5jdGlvbigpe3E9PT10JiYoTCgpLGYuJGVtaXQoXCIkaW5jbHVkZUNvbnRlbnRFcnJvclwiLGUpKX0pLGYuJGVtaXQoXCIkaW5jbHVkZUNvbnRlbnRSZXF1ZXN0ZWRcIixlKSk6KEwoKSxzLnRlbXBsYXRlPW51bGwpfSl9fX19XSxBZT1bXCIkY29tcGlsZVwiLGZ1bmN0aW9uKGEpe3JldHVybntyZXN0cmljdDpcIkVDQVwiLHByaW9yaXR5Oi00MDAscmVxdWlyZTpcIm5nSW5jbHVkZVwiLGxpbms6ZnVuY3Rpb24oYyxkLGUsZil7L1NWRy8udGVzdChkWzBdLnRvU3RyaW5nKCkpPyhkLmVtcHR5KCksYShGYyhmLnRlbXBsYXRlLFkpLmNoaWxkTm9kZXMpKGMsZnVuY3Rpb24oYSl7ZC5hcHBlbmQoYSl9LHtmdXR1cmVQYXJlbnRFbGVtZW50OmR9KSk6KGQuaHRtbChmLnRlbXBsYXRlKSxhKGQuY29udGVudHMoKSkoYykpfX19XSxcclxua2U9SmEoe3ByaW9yaXR5OjQ1MCxjb21waWxlOmZ1bmN0aW9uKCl7cmV0dXJue3ByZTpmdW5jdGlvbihhLGMsZCl7YS4kZXZhbChkLm5nSW5pdCl9fX19KSx3ZT1mdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkFcIixwcmlvcml0eToxMDAscmVxdWlyZTpcIm5nTW9kZWxcIixsaW5rOmZ1bmN0aW9uKGEsYyxkLGUpe3ZhciBmPWMuYXR0cihkLiRhdHRyLm5nTGlzdCl8fFwiLCBcIixnPVwiZmFsc2VcIiE9PWQubmdUcmltLGg9Zz9VKGYpOmY7ZS4kcGFyc2Vycy5wdXNoKGZ1bmN0aW9uKGEpe2lmKCFBKGEpKXt2YXIgYz1bXTthJiZzKGEuc3BsaXQoaCksZnVuY3Rpb24oYSl7YSYmYy5wdXNoKGc/VShhKTphKX0pO3JldHVybiBjfX0pO2UuJGZvcm1hdHRlcnMucHVzaChmdW5jdGlvbihhKXtyZXR1cm4gRChhKT9hLmpvaW4oZik6dH0pO2UuJGlzRW1wdHk9ZnVuY3Rpb24oYSl7cmV0dXJuIWF8fCFhLmxlbmd0aH19fX0sa2I9XCJuZy12YWxpZFwiLHZkPVwibmctaW52YWxpZFwiLFNhPVwibmctcHJpc3RpbmVcIixcclxuS2I9XCJuZy1kaXJ0eVwiLHhkPVwibmctcGVuZGluZ1wiLE1iPW5ldyBUKFwibmdNb2RlbFwiKSxjZz1bXCIkc2NvcGVcIixcIiRleGNlcHRpb25IYW5kbGVyXCIsXCIkYXR0cnNcIixcIiRlbGVtZW50XCIsXCIkcGFyc2VcIixcIiRhbmltYXRlXCIsXCIkdGltZW91dFwiLFwiJHJvb3RTY29wZVwiLFwiJHFcIixcIiRpbnRlcnBvbGF0ZVwiLGZ1bmN0aW9uKGEsYyxkLGUsZixnLGgsbCxrLG0pe3RoaXMuJG1vZGVsVmFsdWU9dGhpcy4kdmlld1ZhbHVlPU51bWJlci5OYU47dGhpcy4kJHJhd01vZGVsVmFsdWU9dDt0aGlzLiR2YWxpZGF0b3JzPXt9O3RoaXMuJGFzeW5jVmFsaWRhdG9ycz17fTt0aGlzLiRwYXJzZXJzPVtdO3RoaXMuJGZvcm1hdHRlcnM9W107dGhpcy4kdmlld0NoYW5nZUxpc3RlbmVycz1bXTt0aGlzLiR1bnRvdWNoZWQ9ITA7dGhpcy4kdG91Y2hlZD0hMTt0aGlzLiRwcmlzdGluZT0hMDt0aGlzLiRkaXJ0eT0hMTt0aGlzLiR2YWxpZD0hMDt0aGlzLiRpbnZhbGlkPSExO3RoaXMuJGVycm9yPXt9O3RoaXMuJCRzdWNjZXNzPVxyXG57fTt0aGlzLiRwZW5kaW5nPXQ7dGhpcy4kbmFtZT1tKGQubmFtZXx8XCJcIiwhMSkoYSk7dmFyIHA9ZihkLm5nTW9kZWwpLHE9cC5hc3NpZ24sdT1wLHI9cSxPPW51bGwsbj10aGlzO3RoaXMuJCRzZXRPcHRpb25zPWZ1bmN0aW9uKGEpe2lmKChuLiRvcHRpb25zPWEpJiZhLmdldHRlclNldHRlcil7dmFyIGM9ZihkLm5nTW9kZWwrXCIoKVwiKSxnPWYoZC5uZ01vZGVsK1wiKCQkJHApXCIpO3U9ZnVuY3Rpb24oYSl7dmFyIGQ9cChhKTtHKGQpJiYoZD1jKGEpKTtyZXR1cm4gZH07cj1mdW5jdGlvbihhLGMpe0cocChhKSk/ZyhhLHskJCRwOm4uJG1vZGVsVmFsdWV9KTpxKGEsbi4kbW9kZWxWYWx1ZSl9fWVsc2UgaWYoIXAuYXNzaWduKXRocm93IE1iKFwibm9uYXNzaWduXCIsZC5uZ01vZGVsLHZhKGUpKTt9O3RoaXMuJHJlbmRlcj1IO3RoaXMuJGlzRW1wdHk9ZnVuY3Rpb24oYSl7cmV0dXJuIEEoYSl8fFwiXCI9PT1hfHxudWxsPT09YXx8YSE9PWF9O3ZhciB2PWUuaW5oZXJpdGVkRGF0YShcIiRmb3JtQ29udHJvbGxlclwiKXx8XHJcbkpiLHc9MDtzZCh7Y3RybDp0aGlzLCRlbGVtZW50OmUsc2V0OmZ1bmN0aW9uKGEsYyl7YVtjXT0hMH0sdW5zZXQ6ZnVuY3Rpb24oYSxjKXtkZWxldGUgYVtjXX0scGFyZW50Rm9ybTp2LCRhbmltYXRlOmd9KTt0aGlzLiRzZXRQcmlzdGluZT1mdW5jdGlvbigpe24uJGRpcnR5PSExO24uJHByaXN0aW5lPSEwO2cucmVtb3ZlQ2xhc3MoZSxLYik7Zy5hZGRDbGFzcyhlLFNhKX07dGhpcy4kc2V0RGlydHk9ZnVuY3Rpb24oKXtuLiRkaXJ0eT0hMDtuLiRwcmlzdGluZT0hMTtnLnJlbW92ZUNsYXNzKGUsU2EpO2cuYWRkQ2xhc3MoZSxLYik7di4kc2V0RGlydHkoKX07dGhpcy4kc2V0VW50b3VjaGVkPWZ1bmN0aW9uKCl7bi4kdG91Y2hlZD0hMTtuLiR1bnRvdWNoZWQ9ITA7Zy5zZXRDbGFzcyhlLFwibmctdW50b3VjaGVkXCIsXCJuZy10b3VjaGVkXCIpfTt0aGlzLiRzZXRUb3VjaGVkPWZ1bmN0aW9uKCl7bi4kdG91Y2hlZD0hMDtuLiR1bnRvdWNoZWQ9ITE7Zy5zZXRDbGFzcyhlLFwibmctdG91Y2hlZFwiLFxyXG5cIm5nLXVudG91Y2hlZFwiKX07dGhpcy4kcm9sbGJhY2tWaWV3VmFsdWU9ZnVuY3Rpb24oKXtoLmNhbmNlbChPKTtuLiR2aWV3VmFsdWU9bi4kJGxhc3RDb21taXR0ZWRWaWV3VmFsdWU7bi4kcmVuZGVyKCl9O3RoaXMuJHZhbGlkYXRlPWZ1bmN0aW9uKCl7aWYoIVYobi4kbW9kZWxWYWx1ZSl8fCFpc05hTihuLiRtb2RlbFZhbHVlKSl7dmFyIGE9bi4kJHJhd01vZGVsVmFsdWUsYz1uLiR2YWxpZCxkPW4uJG1vZGVsVmFsdWUsZT1uLiRvcHRpb25zJiZuLiRvcHRpb25zLmFsbG93SW52YWxpZDtuLiQkcnVuVmFsaWRhdG9ycyhuLiRlcnJvcltuLiQkcGFyc2VyTmFtZXx8XCJwYXJzZVwiXT8hMTp0LGEsbi4kJGxhc3RDb21taXR0ZWRWaWV3VmFsdWUsZnVuY3Rpb24oZil7ZXx8Yz09PWZ8fChuLiRtb2RlbFZhbHVlPWY/YTp0LG4uJG1vZGVsVmFsdWUhPT1kJiZuLiQkd3JpdGVNb2RlbFRvU2NvcGUoKSl9KX19O3RoaXMuJCRydW5WYWxpZGF0b3JzPWZ1bmN0aW9uKGEsYyxkLGUpe2Z1bmN0aW9uIGYoKXt2YXIgYT1cclxuITA7cyhuLiR2YWxpZGF0b3JzLGZ1bmN0aW9uKGUsZil7dmFyIGc9ZShjLGQpO2E9YSYmZztoKGYsZyl9KTtyZXR1cm4gYT8hMDoocyhuLiRhc3luY1ZhbGlkYXRvcnMsZnVuY3Rpb24oYSxjKXtoKGMsbnVsbCl9KSwhMSl9ZnVuY3Rpb24gZygpe3ZhciBhPVtdLGU9ITA7cyhuLiRhc3luY1ZhbGlkYXRvcnMsZnVuY3Rpb24oZixnKXt2YXIgbD1mKGMsZCk7aWYoIWx8fCFHKGwudGhlbikpdGhyb3cgTWIoXCIkYXN5bmNWYWxpZGF0b3JzXCIsbCk7aChnLHQpO2EucHVzaChsLnRoZW4oZnVuY3Rpb24oKXtoKGcsITApfSxmdW5jdGlvbihhKXtlPSExO2goZywhMSl9KSl9KTthLmxlbmd0aD9rLmFsbChhKS50aGVuKGZ1bmN0aW9uKCl7bChlKX0sSCk6bCghMCl9ZnVuY3Rpb24gaChhLGMpe209PT13JiZuLiRzZXRWYWxpZGl0eShhLGMpfWZ1bmN0aW9uIGwoYSl7bT09PXcmJmUoYSl9dysrO3ZhciBtPXc7KGZ1bmN0aW9uKGEpe3ZhciBjPW4uJCRwYXJzZXJOYW1lfHxcInBhcnNlXCI7aWYoYT09PVxyXG50KWgoYyxudWxsKTtlbHNlIGlmKGgoYyxhKSwhYSlyZXR1cm4gcyhuLiR2YWxpZGF0b3JzLGZ1bmN0aW9uKGEsYyl7aChjLG51bGwpfSkscyhuLiRhc3luY1ZhbGlkYXRvcnMsZnVuY3Rpb24oYSxjKXtoKGMsbnVsbCl9KSwhMTtyZXR1cm4hMH0pKGEpP2YoKT9nKCk6bCghMSk6bCghMSl9O3RoaXMuJGNvbW1pdFZpZXdWYWx1ZT1mdW5jdGlvbigpe3ZhciBhPW4uJHZpZXdWYWx1ZTtoLmNhbmNlbChPKTtpZihuLiQkbGFzdENvbW1pdHRlZFZpZXdWYWx1ZSE9PWF8fFwiXCI9PT1hJiZuLiQkaGFzTmF0aXZlVmFsaWRhdG9ycyluLiQkbGFzdENvbW1pdHRlZFZpZXdWYWx1ZT1hLG4uJHByaXN0aW5lJiZ0aGlzLiRzZXREaXJ0eSgpLHRoaXMuJCRwYXJzZUFuZFZhbGlkYXRlKCl9O3RoaXMuJCRwYXJzZUFuZFZhbGlkYXRlPWZ1bmN0aW9uKCl7dmFyIGM9bi4kJGxhc3RDb21taXR0ZWRWaWV3VmFsdWUsZD1BKGMpP3Q6ITA7aWYoZClmb3IodmFyIGU9MDtlPG4uJHBhcnNlcnMubGVuZ3RoO2UrKylpZihjPVxyXG5uLiRwYXJzZXJzW2VdKGMpLEEoYykpe2Q9ITE7YnJlYWt9VihuLiRtb2RlbFZhbHVlKSYmaXNOYU4obi4kbW9kZWxWYWx1ZSkmJihuLiRtb2RlbFZhbHVlPXUoYSkpO3ZhciBmPW4uJG1vZGVsVmFsdWUsZz1uLiRvcHRpb25zJiZuLiRvcHRpb25zLmFsbG93SW52YWxpZDtuLiQkcmF3TW9kZWxWYWx1ZT1jO2cmJihuLiRtb2RlbFZhbHVlPWMsbi4kbW9kZWxWYWx1ZSE9PWYmJm4uJCR3cml0ZU1vZGVsVG9TY29wZSgpKTtuLiQkcnVuVmFsaWRhdG9ycyhkLGMsbi4kJGxhc3RDb21taXR0ZWRWaWV3VmFsdWUsZnVuY3Rpb24oYSl7Z3x8KG4uJG1vZGVsVmFsdWU9YT9jOnQsbi4kbW9kZWxWYWx1ZSE9PWYmJm4uJCR3cml0ZU1vZGVsVG9TY29wZSgpKX0pfTt0aGlzLiQkd3JpdGVNb2RlbFRvU2NvcGU9ZnVuY3Rpb24oKXtyKGEsbi4kbW9kZWxWYWx1ZSk7cyhuLiR2aWV3Q2hhbmdlTGlzdGVuZXJzLGZ1bmN0aW9uKGEpe3RyeXthKCl9Y2F0Y2goZCl7YyhkKX19KX07dGhpcy4kc2V0Vmlld1ZhbHVlPVxyXG5mdW5jdGlvbihhLGMpe24uJHZpZXdWYWx1ZT1hO24uJG9wdGlvbnMmJiFuLiRvcHRpb25zLnVwZGF0ZU9uRGVmYXVsdHx8bi4kJGRlYm91bmNlVmlld1ZhbHVlQ29tbWl0KGMpfTt0aGlzLiQkZGVib3VuY2VWaWV3VmFsdWVDb21taXQ9ZnVuY3Rpb24oYyl7dmFyIGQ9MCxlPW4uJG9wdGlvbnM7ZSYmeShlLmRlYm91bmNlKSYmKGU9ZS5kZWJvdW5jZSxWKGUpP2Q9ZTpWKGVbY10pP2Q9ZVtjXTpWKGVbXCJkZWZhdWx0XCJdKSYmKGQ9ZVtcImRlZmF1bHRcIl0pKTtoLmNhbmNlbChPKTtkP089aChmdW5jdGlvbigpe24uJGNvbW1pdFZpZXdWYWx1ZSgpfSxkKTpsLiQkcGhhc2U/bi4kY29tbWl0Vmlld1ZhbHVlKCk6YS4kYXBwbHkoZnVuY3Rpb24oKXtuLiRjb21taXRWaWV3VmFsdWUoKX0pfTthLiR3YXRjaChmdW5jdGlvbigpe3ZhciBjPXUoYSk7aWYoYyE9PW4uJG1vZGVsVmFsdWUpe24uJG1vZGVsVmFsdWU9bi4kJHJhd01vZGVsVmFsdWU9Yztmb3IodmFyIGQ9bi4kZm9ybWF0dGVycyxlPWQubGVuZ3RoLFxyXG5mPWM7ZS0tOylmPWRbZV0oZik7bi4kdmlld1ZhbHVlIT09ZiYmKG4uJHZpZXdWYWx1ZT1uLiQkbGFzdENvbW1pdHRlZFZpZXdWYWx1ZT1mLG4uJHJlbmRlcigpLG4uJCRydW5WYWxpZGF0b3JzKHQsYyxmLEgpKX1yZXR1cm4gY30pfV0sdmU9W1wiJHJvb3RTY29wZVwiLGZ1bmN0aW9uKGEpe3JldHVybntyZXN0cmljdDpcIkFcIixyZXF1aXJlOltcIm5nTW9kZWxcIixcIl4/Zm9ybVwiLFwiXj9uZ01vZGVsT3B0aW9uc1wiXSxjb250cm9sbGVyOmNnLHByaW9yaXR5OjEsY29tcGlsZTpmdW5jdGlvbihjKXtjLmFkZENsYXNzKFNhKS5hZGRDbGFzcyhcIm5nLXVudG91Y2hlZFwiKS5hZGRDbGFzcyhrYik7cmV0dXJue3ByZTpmdW5jdGlvbihhLGMsZixnKXt2YXIgaD1nWzBdLGw9Z1sxXXx8SmI7aC4kJHNldE9wdGlvbnMoZ1syXSYmZ1syXS4kb3B0aW9ucyk7bC4kYWRkQ29udHJvbChoKTtmLiRvYnNlcnZlKFwibmFtZVwiLGZ1bmN0aW9uKGEpe2guJG5hbWUhPT1hJiZsLiQkcmVuYW1lQ29udHJvbChoLGEpfSk7YS4kb24oXCIkZGVzdHJveVwiLFxyXG5mdW5jdGlvbigpe2wuJHJlbW92ZUNvbnRyb2woaCl9KX0scG9zdDpmdW5jdGlvbihjLGUsZixnKXt2YXIgaD1nWzBdO2lmKGguJG9wdGlvbnMmJmguJG9wdGlvbnMudXBkYXRlT24pZS5vbihoLiRvcHRpb25zLnVwZGF0ZU9uLGZ1bmN0aW9uKGEpe2guJCRkZWJvdW5jZVZpZXdWYWx1ZUNvbW1pdChhJiZhLnR5cGUpfSk7ZS5vbihcImJsdXJcIixmdW5jdGlvbihlKXtoLiR0b3VjaGVkfHwoYS4kJHBoYXNlP2MuJGV2YWxBc3luYyhoLiRzZXRUb3VjaGVkKTpjLiRhcHBseShoLiRzZXRUb3VjaGVkKSl9KX19fX19XSxkZz0vKFxccyt8XilkZWZhdWx0KFxccyt8JCkvLHplPWZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiQVwiLGNvbnRyb2xsZXI6W1wiJHNjb3BlXCIsXCIkYXR0cnNcIixmdW5jdGlvbihhLGMpe3ZhciBkPXRoaXM7dGhpcy4kb3B0aW9ucz1hLiRldmFsKGMubmdNb2RlbE9wdGlvbnMpO3RoaXMuJG9wdGlvbnMudXBkYXRlT24hPT10Pyh0aGlzLiRvcHRpb25zLnVwZGF0ZU9uRGVmYXVsdD1cclxuITEsdGhpcy4kb3B0aW9ucy51cGRhdGVPbj1VKHRoaXMuJG9wdGlvbnMudXBkYXRlT24ucmVwbGFjZShkZyxmdW5jdGlvbigpe2QuJG9wdGlvbnMudXBkYXRlT25EZWZhdWx0PSEwO3JldHVyblwiIFwifSkpKTp0aGlzLiRvcHRpb25zLnVwZGF0ZU9uRGVmYXVsdD0hMH1dfX0sbGU9SmEoe3Rlcm1pbmFsOiEwLHByaW9yaXR5OjFFM30pLG1lPVtcIiRsb2NhbGVcIixcIiRpbnRlcnBvbGF0ZVwiLGZ1bmN0aW9uKGEsYyl7dmFyIGQ9L3t9L2csZT0vXndoZW4oTWludXMpPyguKykkLztyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLGxpbms6ZnVuY3Rpb24oZixnLGgpe2Z1bmN0aW9uIGwoYSl7Zy50ZXh0KGF8fFwiXCIpfXZhciBrPWguY291bnQsbT1oLiRhdHRyLndoZW4mJmcuYXR0cihoLiRhdHRyLndoZW4pLHA9aC5vZmZzZXR8fDAscT1mLiRldmFsKG0pfHx7fSx1PXt9LG09Yy5zdGFydFN5bWJvbCgpLHI9Yy5lbmRTeW1ib2woKSx0PW0raytcIi1cIitwK3Isbj1nYS5ub29wLHY7cyhoLGZ1bmN0aW9uKGEsYyl7dmFyIGQ9XHJcbmUuZXhlYyhjKTtkJiYoZD0oZFsxXT9cIi1cIjpcIlwiKStRKGRbMl0pLHFbZF09Zy5hdHRyKGguJGF0dHJbY10pKX0pO3MocSxmdW5jdGlvbihhLGUpe3VbZV09YyhhLnJlcGxhY2UoZCx0KSl9KTtmLiR3YXRjaChrLGZ1bmN0aW9uKGMpe2M9cGFyc2VGbG9hdChjKTt2YXIgZD1pc05hTihjKTtkfHxjIGluIHF8fChjPWEucGx1cmFsQ2F0KGMtcCkpO2M9PT12fHxkJiZpc05hTih2KXx8KG4oKSxuPWYuJHdhdGNoKHVbY10sbCksdj1jKX0pfX19XSxuZT1bXCIkcGFyc2VcIixcIiRhbmltYXRlXCIsZnVuY3Rpb24oYSxjKXt2YXIgZD1UKFwibmdSZXBlYXRcIiksZT1mdW5jdGlvbihhLGMsZCxlLGssbSxwKXthW2RdPWU7ayYmKGFba109bSk7YS4kaW5kZXg9YzthLiRmaXJzdD0wPT09YzthLiRsYXN0PWM9PT1wLTE7YS4kbWlkZGxlPSEoYS4kZmlyc3R8fGEuJGxhc3QpO2EuJG9kZD0hKGEuJGV2ZW49MD09PShjJjEpKX07cmV0dXJue3Jlc3RyaWN0OlwiQVwiLG11bHRpRWxlbWVudDohMCx0cmFuc2NsdWRlOlwiZWxlbWVudFwiLFxyXG5wcmlvcml0eToxRTMsdGVybWluYWw6ITAsJCR0bGI6ITAsY29tcGlsZTpmdW5jdGlvbihmLGcpe3ZhciBoPWcubmdSZXBlYXQsbD1ZLmNyZWF0ZUNvbW1lbnQoXCIgZW5kIG5nUmVwZWF0OiBcIitoK1wiIFwiKSxrPWgubWF0Y2goL15cXHMqKFtcXHNcXFNdKz8pXFxzK2luXFxzKyhbXFxzXFxTXSs/KSg/Olxccythc1xccysoW1xcc1xcU10rPykpPyg/Olxccyt0cmFja1xccytieVxccysoW1xcc1xcU10rPykpP1xccyokLyk7aWYoIWspdGhyb3cgZChcImlleHBcIixoKTt2YXIgbT1rWzFdLHA9a1syXSxxPWtbM10sdT1rWzRdLGs9bS5tYXRjaCgvXig/OihcXHMqW1xcJFxcd10rKXxcXChcXHMqKFtcXCRcXHddKylcXHMqLFxccyooW1xcJFxcd10rKVxccypcXCkpJC8pO2lmKCFrKXRocm93IGQoXCJpaWRleHBcIixtKTt2YXIgcj1rWzNdfHxrWzFdLHk9a1syXTtpZihxJiYoIS9eWyRhLXpBLVpfXVskYS16QS1aMC05X10qJC8udGVzdChxKXx8L14obnVsbHx1bmRlZmluZWR8dGhpc3xcXCRpbmRleHxcXCRmaXJzdHxcXCRtaWRkbGV8XFwkbGFzdHxcXCRldmVufFxcJG9kZHxcXCRwYXJlbnQpJC8udGVzdChxKSkpdGhyb3cgZChcImJhZGlkZW50XCIsXHJcbnEpO3ZhciBuLHYsdyxBLHo9eyRpZDpOYX07dT9uPWEodSk6KHc9ZnVuY3Rpb24oYSxjKXtyZXR1cm4gTmEoYyl9LEE9ZnVuY3Rpb24oYSl7cmV0dXJuIGF9KTtyZXR1cm4gZnVuY3Rpb24oYSxmLGcsayxtKXtuJiYodj1mdW5jdGlvbihjLGQsZSl7eSYmKHpbeV09Yyk7eltyXT1kO3ouJGluZGV4PWU7cmV0dXJuIG4oYSx6KX0pO3ZhciB1PWhhKCk7YS4kd2F0Y2hDb2xsZWN0aW9uKHAsZnVuY3Rpb24oZyl7dmFyIGsscCxuPWZbMF0sRSx6PWhhKCksSCxTLE4sRCxHLEMsSTtxJiYoYVtxXT1nKTtpZihUYShnKSlHPWcscD12fHx3O2Vsc2V7cD12fHxBO0c9W107Zm9yKEkgaW4gZylnLmhhc093blByb3BlcnR5KEkpJiZcIiRcIiE9SS5jaGFyQXQoMCkmJkcucHVzaChJKTtHLnNvcnQoKX1IPUcubGVuZ3RoO0k9QXJyYXkoSCk7Zm9yKGs9MDtrPEg7aysrKWlmKFM9Zz09PUc/azpHW2tdLE49Z1tTXSxEPXAoUyxOLGspLHVbRF0pQz11W0RdLGRlbGV0ZSB1W0RdLHpbRF09QyxJW2tdPUM7ZWxzZXtpZih6W0RdKXRocm93IHMoSSxcclxuZnVuY3Rpb24oYSl7YSYmYS5zY29wZSYmKHVbYS5pZF09YSl9KSxkKFwiZHVwZXNcIixoLEQsTik7SVtrXT17aWQ6RCxzY29wZTp0LGNsb25lOnR9O3pbRF09ITB9Zm9yKEUgaW4gdSl7Qz11W0VdO0Q9dGIoQy5jbG9uZSk7Yy5sZWF2ZShEKTtpZihEWzBdLnBhcmVudE5vZGUpZm9yKGs9MCxwPUQubGVuZ3RoO2s8cDtrKyspRFtrXS4kJE5HX1JFTU9WRUQ9ITA7Qy5zY29wZS4kZGVzdHJveSgpfWZvcihrPTA7azxIO2srKylpZihTPWc9PT1HP2s6R1trXSxOPWdbU10sQz1JW2tdLEMuc2NvcGUpe0U9bjtkbyBFPUUubmV4dFNpYmxpbmc7d2hpbGUoRSYmRS4kJE5HX1JFTU9WRUQpO0MuY2xvbmVbMF0hPUUmJmMubW92ZSh0YihDLmNsb25lKSxudWxsLEIobikpO249Qy5jbG9uZVtDLmNsb25lLmxlbmd0aC0xXTtlKEMuc2NvcGUsayxyLE4seSxTLEgpfWVsc2UgbShmdW5jdGlvbihhLGQpe0Muc2NvcGU9ZDt2YXIgZj1sLmNsb25lTm9kZSghMSk7YVthLmxlbmd0aCsrXT1mO2MuZW50ZXIoYSxcclxubnVsbCxCKG4pKTtuPWY7Qy5jbG9uZT1hO3pbQy5pZF09QztlKEMuc2NvcGUsayxyLE4seSxTLEgpfSk7dT16fSl9fX19XSxvZT1bXCIkYW5pbWF0ZVwiLGZ1bmN0aW9uKGEpe3JldHVybntyZXN0cmljdDpcIkFcIixtdWx0aUVsZW1lbnQ6ITAsbGluazpmdW5jdGlvbihjLGQsZSl7Yy4kd2F0Y2goZS5uZ1Nob3csZnVuY3Rpb24oYyl7YVtjP1wicmVtb3ZlQ2xhc3NcIjpcImFkZENsYXNzXCJdKGQsXCJuZy1oaWRlXCIse3RlbXBDbGFzc2VzOlwibmctaGlkZS1hbmltYXRlXCJ9KX0pfX19XSxoZT1bXCIkYW5pbWF0ZVwiLGZ1bmN0aW9uKGEpe3JldHVybntyZXN0cmljdDpcIkFcIixtdWx0aUVsZW1lbnQ6ITAsbGluazpmdW5jdGlvbihjLGQsZSl7Yy4kd2F0Y2goZS5uZ0hpZGUsZnVuY3Rpb24oYyl7YVtjP1wiYWRkQ2xhc3NcIjpcInJlbW92ZUNsYXNzXCJdKGQsXCJuZy1oaWRlXCIse3RlbXBDbGFzc2VzOlwibmctaGlkZS1hbmltYXRlXCJ9KX0pfX19XSxwZT1KYShmdW5jdGlvbihhLGMsZCl7YS4kd2F0Y2hDb2xsZWN0aW9uKGQubmdTdHlsZSxcclxuZnVuY3Rpb24oYSxkKXtkJiZhIT09ZCYmcyhkLGZ1bmN0aW9uKGEsZCl7Yy5jc3MoZCxcIlwiKX0pO2EmJmMuY3NzKGEpfSl9KSxxZT1bXCIkYW5pbWF0ZVwiLGZ1bmN0aW9uKGEpe3JldHVybntyZXN0cmljdDpcIkVBXCIscmVxdWlyZTpcIm5nU3dpdGNoXCIsY29udHJvbGxlcjpbXCIkc2NvcGVcIixmdW5jdGlvbigpe3RoaXMuY2FzZXM9e319XSxsaW5rOmZ1bmN0aW9uKGMsZCxlLGYpe3ZhciBnPVtdLGg9W10sbD1bXSxrPVtdLG09ZnVuY3Rpb24oYSxjKXtyZXR1cm4gZnVuY3Rpb24oKXthLnNwbGljZShjLDEpfX07Yy4kd2F0Y2goZS5uZ1N3aXRjaHx8ZS5vbixmdW5jdGlvbihjKXt2YXIgZCxlO2Q9MDtmb3IoZT1sLmxlbmd0aDtkPGU7KytkKWEuY2FuY2VsKGxbZF0pO2Q9bC5sZW5ndGg9MDtmb3IoZT1rLmxlbmd0aDtkPGU7KytkKXt2YXIgcj10YihoW2RdLmNsb25lKTtrW2RdLiRkZXN0cm95KCk7KGxbZF09YS5sZWF2ZShyKSkudGhlbihtKGwsZCkpfWgubGVuZ3RoPTA7ay5sZW5ndGg9MDsoZz1cclxuZi5jYXNlc1tcIiFcIitjXXx8Zi5jYXNlc1tcIj9cIl0pJiZzKGcsZnVuY3Rpb24oYyl7Yy50cmFuc2NsdWRlKGZ1bmN0aW9uKGQsZSl7ay5wdXNoKGUpO3ZhciBmPWMuZWxlbWVudDtkW2QubGVuZ3RoKytdPVkuY3JlYXRlQ29tbWVudChcIiBlbmQgbmdTd2l0Y2hXaGVuOiBcIik7aC5wdXNoKHtjbG9uZTpkfSk7YS5lbnRlcihkLGYucGFyZW50KCksZil9KX0pfSl9fX1dLHJlPUphKHt0cmFuc2NsdWRlOlwiZWxlbWVudFwiLHByaW9yaXR5OjEyMDAscmVxdWlyZTpcIl5uZ1N3aXRjaFwiLG11bHRpRWxlbWVudDohMCxsaW5rOmZ1bmN0aW9uKGEsYyxkLGUsZil7ZS5jYXNlc1tcIiFcIitkLm5nU3dpdGNoV2hlbl09ZS5jYXNlc1tcIiFcIitkLm5nU3dpdGNoV2hlbl18fFtdO2UuY2FzZXNbXCIhXCIrZC5uZ1N3aXRjaFdoZW5dLnB1c2goe3RyYW5zY2x1ZGU6ZixlbGVtZW50OmN9KX19KSxzZT1KYSh7dHJhbnNjbHVkZTpcImVsZW1lbnRcIixwcmlvcml0eToxMjAwLHJlcXVpcmU6XCJebmdTd2l0Y2hcIixtdWx0aUVsZW1lbnQ6ITAsXHJcbmxpbms6ZnVuY3Rpb24oYSxjLGQsZSxmKXtlLmNhc2VzW1wiP1wiXT1lLmNhc2VzW1wiP1wiXXx8W107ZS5jYXNlc1tcIj9cIl0ucHVzaCh7dHJhbnNjbHVkZTpmLGVsZW1lbnQ6Y30pfX0pLHVlPUphKHtyZXN0cmljdDpcIkVBQ1wiLGxpbms6ZnVuY3Rpb24oYSxjLGQsZSxmKXtpZighZil0aHJvdyBUKFwibmdUcmFuc2NsdWRlXCIpKFwib3JwaGFuXCIsdmEoYykpO2YoZnVuY3Rpb24oYSl7Yy5lbXB0eSgpO2MuYXBwZW5kKGEpfSl9fSksVmQ9W1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXtyZXR1cm57cmVzdHJpY3Q6XCJFXCIsdGVybWluYWw6ITAsY29tcGlsZTpmdW5jdGlvbihjLGQpe1widGV4dC9uZy10ZW1wbGF0ZVwiPT1kLnR5cGUmJmEucHV0KGQuaWQsY1swXS50ZXh0KX19fV0sZWc9VChcIm5nT3B0aW9uc1wiKSx0ZT1kYSh7cmVzdHJpY3Q6XCJBXCIsdGVybWluYWw6ITB9KSxXZD1bXCIkY29tcGlsZVwiLFwiJHBhcnNlXCIsZnVuY3Rpb24oYSxjKXt2YXIgZD0vXlxccyooW1xcc1xcU10rPykoPzpcXHMrYXNcXHMrKFtcXHNcXFNdKz8pKT8oPzpcXHMrZ3JvdXBcXHMrYnlcXHMrKFtcXHNcXFNdKz8pKT9cXHMrZm9yXFxzKyg/OihbXFwkXFx3XVtcXCRcXHddKil8KD86XFwoXFxzKihbXFwkXFx3XVtcXCRcXHddKilcXHMqLFxccyooW1xcJFxcd11bXFwkXFx3XSopXFxzKlxcKSkpXFxzK2luXFxzKyhbXFxzXFxTXSs/KSg/Olxccyt0cmFja1xccytieVxccysoW1xcc1xcU10rPykpPyQvLFxyXG5lPXskc2V0Vmlld1ZhbHVlOkh9O3JldHVybntyZXN0cmljdDpcIkVcIixyZXF1aXJlOltcInNlbGVjdFwiLFwiP25nTW9kZWxcIl0sY29udHJvbGxlcjpbXCIkZWxlbWVudFwiLFwiJHNjb3BlXCIsXCIkYXR0cnNcIixmdW5jdGlvbihhLGMsZCl7dmFyIGw9dGhpcyxrPXt9LG09ZSxwO2wuZGF0YWJvdW5kPWQubmdNb2RlbDtsLmluaXQ9ZnVuY3Rpb24oYSxjLGQpe209YTtwPWR9O2wuYWRkT3B0aW9uPWZ1bmN0aW9uKGMsZCl7TWEoYywnXCJvcHRpb24gdmFsdWVcIicpO2tbY109ITA7bS4kdmlld1ZhbHVlPT1jJiYoYS52YWwoYykscC5wYXJlbnQoKSYmcC5yZW1vdmUoKSk7ZCYmZFswXS5oYXNBdHRyaWJ1dGUoXCJzZWxlY3RlZFwiKSYmKGRbMF0uc2VsZWN0ZWQ9ITApfTtsLnJlbW92ZU9wdGlvbj1mdW5jdGlvbihhKXt0aGlzLmhhc09wdGlvbihhKSYmKGRlbGV0ZSBrW2FdLG0uJHZpZXdWYWx1ZT09PWEmJnRoaXMucmVuZGVyVW5rbm93bk9wdGlvbihhKSl9O2wucmVuZGVyVW5rbm93bk9wdGlvbj1mdW5jdGlvbihjKXtjPVxyXG5cIj8gXCIrTmEoYykrXCIgP1wiO3AudmFsKGMpO2EucHJlcGVuZChwKTthLnZhbChjKTtwLnByb3AoXCJzZWxlY3RlZFwiLCEwKX07bC5oYXNPcHRpb249ZnVuY3Rpb24oYSl7cmV0dXJuIGsuaGFzT3duUHJvcGVydHkoYSl9O2MuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe2wucmVuZGVyVW5rbm93bk9wdGlvbj1IfSl9XSxsaW5rOmZ1bmN0aW9uKGUsZyxoLGwpe2Z1bmN0aW9uIGsoYSxjLGQsZSl7ZC4kcmVuZGVyPWZ1bmN0aW9uKCl7dmFyIGE9ZC4kdmlld1ZhbHVlO2UuaGFzT3B0aW9uKGEpPyhDLnBhcmVudCgpJiZDLnJlbW92ZSgpLGMudmFsKGEpLFwiXCI9PT1hJiZuLnByb3AoXCJzZWxlY3RlZFwiLCEwKSk6QShhKSYmbj9jLnZhbChcIlwiKTplLnJlbmRlclVua25vd25PcHRpb24oYSl9O2Mub24oXCJjaGFuZ2VcIixmdW5jdGlvbigpe2EuJGFwcGx5KGZ1bmN0aW9uKCl7Qy5wYXJlbnQoKSYmQy5yZW1vdmUoKTtkLiRzZXRWaWV3VmFsdWUoYy52YWwoKSl9KX0pfWZ1bmN0aW9uIG0oYSxjLGQpe3ZhciBlO1xyXG5kLiRyZW5kZXI9ZnVuY3Rpb24oKXt2YXIgYT1uZXcgZGIoZC4kdmlld1ZhbHVlKTtzKGMuZmluZChcIm9wdGlvblwiKSxmdW5jdGlvbihjKXtjLnNlbGVjdGVkPXkoYS5nZXQoYy52YWx1ZSkpfSl9O2EuJHdhdGNoKGZ1bmN0aW9uKCl7ZmEoZSxkLiR2aWV3VmFsdWUpfHwoZT1yYShkLiR2aWV3VmFsdWUpLGQuJHJlbmRlcigpKX0pO2Mub24oXCJjaGFuZ2VcIixmdW5jdGlvbigpe2EuJGFwcGx5KGZ1bmN0aW9uKCl7dmFyIGE9W107cyhjLmZpbmQoXCJvcHRpb25cIiksZnVuY3Rpb24oYyl7Yy5zZWxlY3RlZCYmYS5wdXNoKGMudmFsdWUpfSk7ZC4kc2V0Vmlld1ZhbHVlKGEpfSl9KX1mdW5jdGlvbiBwKGUsZixnKXtmdW5jdGlvbiBoKGEsYyxkKXtUW3hdPWQ7RyYmKFRbR109Yyk7cmV0dXJuIGEoZSxUKX1mdW5jdGlvbiBrKGEpe3ZhciBjO2lmKHUpaWYoTSYmRChhKSl7Yz1uZXcgZGIoW10pO2Zvcih2YXIgZD0wO2Q8YS5sZW5ndGg7ZCsrKWMucHV0KGgoTSxudWxsLGFbZF0pLCEwKX1lbHNlIGM9XHJcbm5ldyBkYihhKTtlbHNlIE0mJihhPWgoTSxudWxsLGEpKTtyZXR1cm4gZnVuY3Rpb24oZCxlKXt2YXIgZjtmPU0/TTpCP0I6RjtyZXR1cm4gdT95KGMucmVtb3ZlKGgoZixkLGUpKSk6YT09PWgoZixkLGUpfX1mdW5jdGlvbiBsKCl7dnx8KGUuJCRwb3N0RGlnZXN0KHApLHY9ITApfWZ1bmN0aW9uIG0oYSxjLGQpe2FbY109YVtjXXx8MDthW2NdKz1kPzE6LTF9ZnVuY3Rpb24gcCgpe3Y9ITE7dmFyIGE9e1wiXCI6W119LGM9W1wiXCJdLGQsbCxuLHIsdDtuPWcuJHZpZXdWYWx1ZTtyPVAoZSl8fFtdO3ZhciBCPUc/T2JqZWN0LmtleXMocikuc29ydCgpOnIseCxBLEQsRixOPXt9O3Q9ayhuKTt2YXIgSj0hMSxVLFY7UT17fTtmb3IoRj0wO0Q9Qi5sZW5ndGgsRjxEO0YrKyl7eD1GO2lmKEcmJih4PUJbRl0sXCIkXCI9PT14LmNoYXJBdCgwKSkpY29udGludWU7QT1yW3hdO2Q9aChJLHgsQSl8fFwiXCI7KGw9YVtkXSl8fChsPWFbZF09W10sYy5wdXNoKGQpKTtkPXQoeCxBKTtKPUp8fGQ7QT1oKEMseCxBKTtcclxuQT15KEEpP0E6XCJcIjtWPU0/TShlLFQpOkc/QltGXTpGO00mJihRW1ZdPXgpO2wucHVzaCh7aWQ6VixsYWJlbDpBLHNlbGVjdGVkOmR9KX11fHwoenx8bnVsbD09PW4/YVtcIlwiXS51bnNoaWZ0KHtpZDpcIlwiLGxhYmVsOlwiXCIsc2VsZWN0ZWQ6IUp9KTpKfHxhW1wiXCJdLnVuc2hpZnQoe2lkOlwiP1wiLGxhYmVsOlwiXCIsc2VsZWN0ZWQ6ITB9KSk7eD0wO2ZvcihCPWMubGVuZ3RoO3g8Qjt4Kyspe2Q9Y1t4XTtsPWFbZF07Ui5sZW5ndGg8PXg/KG49e2VsZW1lbnQ6SC5jbG9uZSgpLmF0dHIoXCJsYWJlbFwiLGQpLGxhYmVsOmwubGFiZWx9LHI9W25dLFIucHVzaChyKSxmLmFwcGVuZChuLmVsZW1lbnQpKToocj1SW3hdLG49clswXSxuLmxhYmVsIT1kJiZuLmVsZW1lbnQuYXR0cihcImxhYmVsXCIsbi5sYWJlbD1kKSk7Sj1udWxsO0Y9MDtmb3IoRD1sLmxlbmd0aDtGPEQ7RisrKWQ9bFtGXSwodD1yW0YrMV0pPyhKPXQuZWxlbWVudCx0LmxhYmVsIT09ZC5sYWJlbCYmKG0oTix0LmxhYmVsLCExKSxtKE4sZC5sYWJlbCxcclxuITApLEoudGV4dCh0LmxhYmVsPWQubGFiZWwpLEoucHJvcChcImxhYmVsXCIsdC5sYWJlbCkpLHQuaWQhPT1kLmlkJiZKLnZhbCh0LmlkPWQuaWQpLEpbMF0uc2VsZWN0ZWQhPT1kLnNlbGVjdGVkJiYoSi5wcm9wKFwic2VsZWN0ZWRcIix0LnNlbGVjdGVkPWQuc2VsZWN0ZWQpLFJhJiZKLnByb3AoXCJzZWxlY3RlZFwiLHQuc2VsZWN0ZWQpKSk6KFwiXCI9PT1kLmlkJiZ6P1U9ejooVT13LmNsb25lKCkpLnZhbChkLmlkKS5wcm9wKFwic2VsZWN0ZWRcIixkLnNlbGVjdGVkKS5hdHRyKFwic2VsZWN0ZWRcIixkLnNlbGVjdGVkKS5wcm9wKFwibGFiZWxcIixkLmxhYmVsKS50ZXh0KGQubGFiZWwpLHIucHVzaCh0PXtlbGVtZW50OlUsbGFiZWw6ZC5sYWJlbCxpZDpkLmlkLHNlbGVjdGVkOmQuc2VsZWN0ZWR9KSxtKE4sZC5sYWJlbCwhMCksSj9KLmFmdGVyKFUpOm4uZWxlbWVudC5hcHBlbmQoVSksSj1VKTtmb3IoRisrO3IubGVuZ3RoPkY7KWQ9ci5wb3AoKSxtKE4sZC5sYWJlbCwhMSksZC5lbGVtZW50LnJlbW92ZSgpfWZvcig7Ui5sZW5ndGg+XHJcbng7KXtsPVIucG9wKCk7Zm9yKEY9MTtGPGwubGVuZ3RoOysrRiltKE4sbFtGXS5sYWJlbCwhMSk7bFswXS5lbGVtZW50LnJlbW92ZSgpfXMoTixmdW5jdGlvbihhLGMpezA8YT9xLmFkZE9wdGlvbihjKTowPmEmJnEucmVtb3ZlT3B0aW9uKGMpfSl9dmFyIG47aWYoIShuPXIubWF0Y2goZCkpKXRocm93IGVnKFwiaWV4cFwiLHIsdmEoZikpO3ZhciBDPWMoblsyXXx8blsxXSkseD1uWzRdfHxuWzZdLEE9LyBhcyAvLnRlc3QoblswXSkmJm5bMV0sQj1BP2MoQSk6bnVsbCxHPW5bNV0sST1jKG5bM118fFwiXCIpLEY9YyhuWzJdP25bMV06eCksUD1jKG5bN10pLE09bls4XT9jKG5bOF0pOm51bGwsUT17fSxSPVtbe2VsZW1lbnQ6ZixsYWJlbDpcIlwifV1dLFQ9e307eiYmKGEoeikoZSksei5yZW1vdmVDbGFzcyhcIm5nLXNjb3BlXCIpLHoucmVtb3ZlKCkpO2YuZW1wdHkoKTtmLm9uKFwiY2hhbmdlXCIsZnVuY3Rpb24oKXtlLiRhcHBseShmdW5jdGlvbigpe3ZhciBhPVAoZSl8fFtdLGM7aWYodSljPVtdLHMoZi52YWwoKSxcclxuZnVuY3Rpb24oZCl7ZD1NP1FbZF06ZDtjLnB1c2goXCI/XCI9PT1kP3Q6XCJcIj09PWQ/bnVsbDpoKEI/QjpGLGQsYVtkXSkpfSk7ZWxzZXt2YXIgZD1NP1FbZi52YWwoKV06Zi52YWwoKTtjPVwiP1wiPT09ZD90OlwiXCI9PT1kP251bGw6aChCP0I6RixkLGFbZF0pfWcuJHNldFZpZXdWYWx1ZShjKTtwKCl9KX0pO2cuJHJlbmRlcj1wO2UuJHdhdGNoQ29sbGVjdGlvbihQLGwpO2UuJHdhdGNoQ29sbGVjdGlvbihmdW5jdGlvbigpe3ZhciBhPVAoZSksYztpZihhJiZEKGEpKXtjPUFycmF5KGEubGVuZ3RoKTtmb3IodmFyIGQ9MCxmPWEubGVuZ3RoO2Q8ZjtkKyspY1tkXT1oKEMsZCxhW2RdKX1lbHNlIGlmKGEpZm9yKGQgaW4gYz17fSxhKWEuaGFzT3duUHJvcGVydHkoZCkmJihjW2RdPWgoQyxkLGFbZF0pKTtyZXR1cm4gY30sbCk7dSYmZS4kd2F0Y2hDb2xsZWN0aW9uKGZ1bmN0aW9uKCl7cmV0dXJuIGcuJG1vZGVsVmFsdWV9LGwpfWlmKGxbMV0pe3ZhciBxPWxbMF07bD1sWzFdO3ZhciB1PWgubXVsdGlwbGUsXHJcbnI9aC5uZ09wdGlvbnMsej0hMSxuLHY9ITEsdz1CKFkuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKSksSD1CKFkuY3JlYXRlRWxlbWVudChcIm9wdGdyb3VwXCIpKSxDPXcuY2xvbmUoKTtoPTA7Zm9yKHZhciB4PWcuY2hpbGRyZW4oKSxHPXgubGVuZ3RoO2g8RztoKyspaWYoXCJcIj09PXhbaF0udmFsdWUpe249ej14LmVxKGgpO2JyZWFrfXEuaW5pdChsLHosQyk7dSYmKGwuJGlzRW1wdHk9ZnVuY3Rpb24oYSl7cmV0dXJuIWF8fDA9PT1hLmxlbmd0aH0pO3I/cChlLGcsbCk6dT9tKGUsZyxsKTprKGUsZyxsLHEpfX19fV0sWWQ9W1wiJGludGVycG9sYXRlXCIsZnVuY3Rpb24oYSl7dmFyIGM9e2FkZE9wdGlvbjpILHJlbW92ZU9wdGlvbjpIfTtyZXR1cm57cmVzdHJpY3Q6XCJFXCIscHJpb3JpdHk6MTAwLGNvbXBpbGU6ZnVuY3Rpb24oZCxlKXtpZihBKGUudmFsdWUpKXt2YXIgZj1hKGQudGV4dCgpLCEwKTtmfHxlLiRzZXQoXCJ2YWx1ZVwiLGQudGV4dCgpKX1yZXR1cm4gZnVuY3Rpb24oYSxkLGUpe3ZhciBrPVxyXG5kLnBhcmVudCgpLG09ay5kYXRhKFwiJHNlbGVjdENvbnRyb2xsZXJcIil8fGsucGFyZW50KCkuZGF0YShcIiRzZWxlY3RDb250cm9sbGVyXCIpO20mJm0uZGF0YWJvdW5kfHwobT1jKTtmP2EuJHdhdGNoKGYsZnVuY3Rpb24oYSxjKXtlLiRzZXQoXCJ2YWx1ZVwiLGEpO2MhPT1hJiZtLnJlbW92ZU9wdGlvbihjKTttLmFkZE9wdGlvbihhLGQpfSk6bS5hZGRPcHRpb24oZS52YWx1ZSxkKTtkLm9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe20ucmVtb3ZlT3B0aW9uKGUudmFsdWUpfSl9fX19XSxYZD1kYSh7cmVzdHJpY3Q6XCJFXCIsdGVybWluYWw6ITF9KSx6Yz1mdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkFcIixyZXF1aXJlOlwiP25nTW9kZWxcIixsaW5rOmZ1bmN0aW9uKGEsYyxkLGUpe2UmJihkLnJlcXVpcmVkPSEwLGUuJHZhbGlkYXRvcnMucmVxdWlyZWQ9ZnVuY3Rpb24oYSxjKXtyZXR1cm4hZC5yZXF1aXJlZHx8IWUuJGlzRW1wdHkoYyl9LGQuJG9ic2VydmUoXCJyZXF1aXJlZFwiLGZ1bmN0aW9uKCl7ZS4kdmFsaWRhdGUoKX0pKX19fSxcclxueWM9ZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJBXCIscmVxdWlyZTpcIj9uZ01vZGVsXCIsbGluazpmdW5jdGlvbihhLGMsZCxlKXtpZihlKXt2YXIgZixnPWQubmdQYXR0ZXJufHxkLnBhdHRlcm47ZC4kb2JzZXJ2ZShcInBhdHRlcm5cIixmdW5jdGlvbihhKXtGKGEpJiYwPGEubGVuZ3RoJiYoYT1uZXcgUmVnRXhwKFwiXlwiK2ErXCIkXCIpKTtpZihhJiYhYS50ZXN0KXRocm93IFQoXCJuZ1BhdHRlcm5cIikoXCJub3JlZ2V4cFwiLGcsYSx2YShjKSk7Zj1hfHx0O2UuJHZhbGlkYXRlKCl9KTtlLiR2YWxpZGF0b3JzLnBhdHRlcm49ZnVuY3Rpb24oYSl7cmV0dXJuIGUuJGlzRW1wdHkoYSl8fEEoZil8fGYudGVzdChhKX19fX19LEJjPWZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiQVwiLHJlcXVpcmU6XCI/bmdNb2RlbFwiLGxpbms6ZnVuY3Rpb24oYSxjLGQsZSl7aWYoZSl7dmFyIGY9LTE7ZC4kb2JzZXJ2ZShcIm1heGxlbmd0aFwiLGZ1bmN0aW9uKGEpe2E9YmEoYSk7Zj1pc05hTihhKT8tMTphO2UuJHZhbGlkYXRlKCl9KTtcclxuZS4kdmFsaWRhdG9ycy5tYXhsZW5ndGg9ZnVuY3Rpb24oYSxjKXtyZXR1cm4gMD5mfHxlLiRpc0VtcHR5KGEpfHxjLmxlbmd0aDw9Zn19fX19LEFjPWZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiQVwiLHJlcXVpcmU6XCI/bmdNb2RlbFwiLGxpbms6ZnVuY3Rpb24oYSxjLGQsZSl7aWYoZSl7dmFyIGY9MDtkLiRvYnNlcnZlKFwibWlubGVuZ3RoXCIsZnVuY3Rpb24oYSl7Zj1iYShhKXx8MDtlLiR2YWxpZGF0ZSgpfSk7ZS4kdmFsaWRhdG9ycy5taW5sZW5ndGg9ZnVuY3Rpb24oYSxjKXtyZXR1cm4gZS4kaXNFbXB0eShjKXx8Yy5sZW5ndGg+PWZ9fX19fTtNLmFuZ3VsYXIuYm9vdHN0cmFwP2NvbnNvbGUubG9nKFwiV0FSTklORzogVHJpZWQgdG8gbG9hZCBhbmd1bGFyIG1vcmUgdGhhbiBvbmNlLlwiKTooTmQoKSxQZChnYSksQihZKS5yZWFkeShmdW5jdGlvbigpe0pkKFksc2MpfSkpfSkod2luZG93LGRvY3VtZW50KTshd2luZG93LmFuZ3VsYXIuJCRjc3AoKSYmd2luZG93LmFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkuZmluZChcImhlYWRcIikucHJlcGVuZCgnPHN0eWxlIHR5cGU9XCJ0ZXh0L2Nzc1wiPkBjaGFyc2V0IFwiVVRGLThcIjtbbmdcXFxcOmNsb2FrXSxbbmctY2xvYWtdLFtkYXRhLW5nLWNsb2FrXSxbeC1uZy1jbG9ha10sLm5nLWNsb2FrLC54LW5nLWNsb2FrLC5uZy1oaWRlOm5vdCgubmctaGlkZS1hbmltYXRlKXtkaXNwbGF5Om5vbmUgIWltcG9ydGFudDt9bmdcXFxcOmZvcm17ZGlzcGxheTpibG9jazt9PC9zdHlsZT4nKTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YW5ndWxhci5taW4uanMubWFwXHJcbiIsIi8qKlxyXG4gKiBAbGljZW5zZSBBbmd1bGFySlMgdjEuMy4xMVxyXG4gKiAoYykgMjAxMC0yMDE0IEdvb2dsZSwgSW5jLiBodHRwOi8vYW5ndWxhcmpzLm9yZ1xyXG4gKiBMaWNlbnNlOiBNSVRcclxuICovXHJcbihmdW5jdGlvbih3aW5kb3csIGFuZ3VsYXIsIHVuZGVmaW5lZCkgeyd1c2Ugc3RyaWN0JztcclxuXHJcbi8qIGpzaGludCBtYXhsZW46IGZhbHNlICovXHJcblxyXG4vKipcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBuZ0FuaW1hdGVcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqXHJcbiAqIFRoZSBgbmdBbmltYXRlYCBtb2R1bGUgcHJvdmlkZXMgc3VwcG9ydCBmb3IgSmF2YVNjcmlwdCwgQ1NTMyB0cmFuc2l0aW9uIGFuZCBDU1MzIGtleWZyYW1lIGFuaW1hdGlvbiBob29rcyB3aXRoaW4gZXhpc3RpbmcgY29yZSBhbmQgY3VzdG9tIGRpcmVjdGl2ZXMuXHJcbiAqXHJcbiAqIDxkaXYgZG9jLW1vZHVsZS1jb21wb25lbnRzPVwibmdBbmltYXRlXCI+PC9kaXY+XHJcbiAqXHJcbiAqICMgVXNhZ2VcclxuICpcclxuICogVG8gc2VlIGFuaW1hdGlvbnMgaW4gYWN0aW9uLCBhbGwgdGhhdCBpcyByZXF1aXJlZCBpcyB0byBkZWZpbmUgdGhlIGFwcHJvcHJpYXRlIENTUyBjbGFzc2VzXHJcbiAqIG9yIHRvIHJlZ2lzdGVyIGEgSmF2YVNjcmlwdCBhbmltYXRpb24gdmlhIHRoZSBgbXlNb2R1bGUuYW5pbWF0aW9uKClgIGZ1bmN0aW9uLiBUaGUgZGlyZWN0aXZlcyB0aGF0IHN1cHBvcnQgYW5pbWF0aW9uIGF1dG9tYXRpY2FsbHkgYXJlOlxyXG4gKiBgbmdSZXBlYXRgLCBgbmdJbmNsdWRlYCwgYG5nSWZgLCBgbmdTd2l0Y2hgLCBgbmdTaG93YCwgYG5nSGlkZWAsIGBuZ1ZpZXdgIGFuZCBgbmdDbGFzc2AuIEN1c3RvbSBkaXJlY3RpdmVzIGNhbiB0YWtlIGFkdmFudGFnZSBvZiBhbmltYXRpb25cclxuICogYnkgdXNpbmcgdGhlIGAkYW5pbWF0ZWAgc2VydmljZS5cclxuICpcclxuICogQmVsb3cgaXMgYSBtb3JlIGRldGFpbGVkIGJyZWFrZG93biBvZiB0aGUgc3VwcG9ydGVkIGFuaW1hdGlvbiBldmVudHMgcHJvdmlkZWQgYnkgcHJlLWV4aXN0aW5nIG5nIGRpcmVjdGl2ZXM6XHJcbiAqXHJcbiAqIHwgRGlyZWN0aXZlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBTdXBwb3J0ZWQgQW5pbWF0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gKiB8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcclxuICogfCB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nUmVwZWF0I2FuaW1hdGlvbnMgbmdSZXBlYXR9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGVudGVyLCBsZWF2ZSBhbmQgbW92ZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAqIHwge0BsaW5rIG5nUm91dGUuZGlyZWN0aXZlOm5nVmlldyNhbmltYXRpb25zIG5nVmlld30gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBlbnRlciBhbmQgbGVhdmUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gKiB8IHtAbGluayBuZy5kaXJlY3RpdmU6bmdJbmNsdWRlI2FuaW1hdGlvbnMgbmdJbmNsdWRlfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgZW50ZXIgYW5kIGxlYXZlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICogfCB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nU3dpdGNoI2FuaW1hdGlvbnMgbmdTd2l0Y2h9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGVudGVyIGFuZCBsZWF2ZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAqIHwge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0lmI2FuaW1hdGlvbnMgbmdJZn0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBlbnRlciBhbmQgbGVhdmUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gKiB8IHtAbGluayBuZy5kaXJlY3RpdmU6bmdDbGFzcyNhbmltYXRpb25zIG5nQ2xhc3N9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYWRkIGFuZCByZW1vdmUgKHRoZSBDU1MgY2xhc3MoZXMpIHByZXNlbnQpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICogfCB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nU2hvdyNhbmltYXRpb25zIG5nU2hvd30gJiB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nSGlkZSNhbmltYXRpb25zIG5nSGlkZX0gICAgICAgICAgICB8IGFkZCBhbmQgcmVtb3ZlICh0aGUgbmctaGlkZSBjbGFzcyB2YWx1ZSkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAqIHwge0BsaW5rIG5nLmRpcmVjdGl2ZTpmb3JtI2FuaW1hdGlvbi1ob29rcyBmb3JtfSAmIHtAbGluayBuZy5kaXJlY3RpdmU6bmdNb2RlbCNhbmltYXRpb24taG9va3MgbmdNb2RlbH0gICAgfCBhZGQgYW5kIHJlbW92ZSAoZGlydHksIHByaXN0aW5lLCB2YWxpZCwgaW52YWxpZCAmIGFsbCBvdGhlciB2YWxpZGF0aW9ucykgfFxyXG4gKiB8IHtAbGluayBtb2R1bGU6bmdNZXNzYWdlcyNhbmltYXRpb25zIG5nTWVzc2FnZXN9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYWRkIGFuZCByZW1vdmUgKG5nLWFjdGl2ZSAmIG5nLWluYWN0aXZlKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICogfCB7QGxpbmsgbW9kdWxlOm5nTWVzc2FnZXMjYW5pbWF0aW9ucyBuZ01lc3NhZ2V9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGVudGVyIGFuZCBsZWF2ZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAqXHJcbiAqIFlvdSBjYW4gZmluZCBvdXQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBhbmltYXRpb25zIHVwb24gdmlzaXRpbmcgZWFjaCBkaXJlY3RpdmUgcGFnZS5cclxuICpcclxuICogQmVsb3cgaXMgYW4gZXhhbXBsZSBvZiBob3cgdG8gYXBwbHkgYW5pbWF0aW9ucyB0byBhIGRpcmVjdGl2ZSB0aGF0IHN1cHBvcnRzIGFuaW1hdGlvbiBob29rczpcclxuICpcclxuICogYGBgaHRtbFxyXG4gKiA8c3R5bGUgdHlwZT1cInRleHQvY3NzXCI+XHJcbiAqIC5zbGlkZS5uZy1lbnRlciwgLnNsaWRlLm5nLWxlYXZlIHtcclxuICogICAtd2Via2l0LXRyYW5zaXRpb246MC41cyBsaW5lYXIgYWxsO1xyXG4gKiAgIHRyYW5zaXRpb246MC41cyBsaW5lYXIgYWxsO1xyXG4gKiB9XHJcbiAqXHJcbiAqIC5zbGlkZS5uZy1lbnRlciB7IH0gICAgICAgIC8mIzQyOyBzdGFydGluZyBhbmltYXRpb25zIGZvciBlbnRlciAmIzQyOy9cclxuICogLnNsaWRlLm5nLWVudGVyLm5nLWVudGVyLWFjdGl2ZSB7IH0gLyYjNDI7IHRlcm1pbmFsIGFuaW1hdGlvbnMgZm9yIGVudGVyICYjNDI7L1xyXG4gKiAuc2xpZGUubmctbGVhdmUgeyB9ICAgICAgICAvJiM0Mjsgc3RhcnRpbmcgYW5pbWF0aW9ucyBmb3IgbGVhdmUgJiM0MjsvXHJcbiAqIC5zbGlkZS5uZy1sZWF2ZS5uZy1sZWF2ZS1hY3RpdmUgeyB9IC8mIzQyOyB0ZXJtaW5hbCBhbmltYXRpb25zIGZvciBsZWF2ZSAmIzQyOy9cclxuICogPC9zdHlsZT5cclxuICpcclxuICogPCEtLVxyXG4gKiB0aGUgYW5pbWF0ZSBzZXJ2aWNlIHdpbGwgYXV0b21hdGljYWxseSBhZGQgLm5nLWVudGVyIGFuZCAubmctbGVhdmUgdG8gdGhlIGVsZW1lbnRcclxuICogdG8gdHJpZ2dlciB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uc1xyXG4gKiAtLT5cclxuICogPEFOWSBjbGFzcz1cInNsaWRlXCIgbmctaW5jbHVkZT1cIi4uLlwiPjwvQU5ZPlxyXG4gKiBgYGBcclxuICpcclxuICogS2VlcCBpbiBtaW5kIHRoYXQsIGJ5IGRlZmF1bHQsIGlmIGFuIGFuaW1hdGlvbiBpcyBydW5uaW5nLCBhbnkgY2hpbGQgZWxlbWVudHMgY2Fubm90IGJlIGFuaW1hdGVkXHJcbiAqIHVudGlsIHRoZSBwYXJlbnQgZWxlbWVudCdzIGFuaW1hdGlvbiBoYXMgY29tcGxldGVkLiBUaGlzIGJsb2NraW5nIGZlYXR1cmUgY2FuIGJlIG92ZXJyaWRkZW4gYnlcclxuICogcGxhY2luZyB0aGUgYG5nLWFuaW1hdGUtY2hpbGRyZW5gIGF0dHJpYnV0ZSBvbiBhIHBhcmVudCBjb250YWluZXIgdGFnLlxyXG4gKlxyXG4gKiBgYGBodG1sXHJcbiAqIDxkaXYgY2xhc3M9XCJzbGlkZS1hbmltYXRpb25cIiBuZy1pZj1cIm9uXCIgbmctYW5pbWF0ZS1jaGlsZHJlbj5cclxuICogICA8ZGl2IGNsYXNzPVwiZmFkZS1hbmltYXRpb25cIiBuZy1pZj1cIm9uXCI+XHJcbiAqICAgICA8ZGl2IGNsYXNzPVwiZXhwbG9kZS1hbmltYXRpb25cIiBuZy1pZj1cIm9uXCI+XHJcbiAqICAgICAgICAuLi5cclxuICogICAgIDwvZGl2PlxyXG4gKiAgIDwvZGl2PlxyXG4gKiA8L2Rpdj5cclxuICogYGBgXHJcbiAqXHJcbiAqIFdoZW4gdGhlIGBvbmAgZXhwcmVzc2lvbiB2YWx1ZSBjaGFuZ2VzIGFuZCBhbiBhbmltYXRpb24gaXMgdHJpZ2dlcmVkIHRoZW4gZWFjaCBvZiB0aGUgZWxlbWVudHMgd2l0aGluXHJcbiAqIHdpbGwgYWxsIGFuaW1hdGUgd2l0aG91dCB0aGUgYmxvY2sgYmVpbmcgYXBwbGllZCB0byBjaGlsZCBlbGVtZW50cy5cclxuICpcclxuICogIyMgQXJlIGFuaW1hdGlvbnMgcnVuIHdoZW4gdGhlIGFwcGxpY2F0aW9uIHN0YXJ0cz9cclxuICogTm8gdGhleSBhcmUgbm90LiBXaGVuIGFuIGFwcGxpY2F0aW9uIGlzIGJvb3RzdHJhcHBlZCBBbmd1bGFyIHdpbGwgZGlzYWJsZSBhbmltYXRpb25zIGZyb20gcnVubmluZyB0byBhdm9pZFxyXG4gKiBhIGZyZW56eSBvZiBhbmltYXRpb25zIGZyb20gYmVpbmcgdHJpZ2dlcmVkIGFzIHNvb24gYXMgdGhlIGJyb3dzZXIgaGFzIHJlbmRlcmVkIHRoZSBzY3JlZW4uIEZvciB0aGlzIHRvIHdvcmssXHJcbiAqIEFuZ3VsYXIgd2lsbCB3YWl0IGZvciB0d28gZGlnZXN0IGN5Y2xlcyB1bnRpbCBlbmFibGluZyBhbmltYXRpb25zLiBGcm9tIHRoZXJlIG9uLCBhbnkgYW5pbWF0aW9uLXRyaWdnZXJpbmdcclxuICogbGF5b3V0IGNoYW5nZXMgaW4gdGhlIGFwcGxpY2F0aW9uIHdpbGwgdHJpZ2dlciBhbmltYXRpb25zIGFzIG5vcm1hbC5cclxuICpcclxuICogSW4gYWRkaXRpb24sIHVwb24gYm9vdHN0cmFwLCBpZiB0aGUgcm91dGluZyBzeXN0ZW0gb3IgYW55IGRpcmVjdGl2ZXMgb3IgbG9hZCByZW1vdGUgZGF0YSAodmlhICRodHRwKSB0aGVuIEFuZ3VsYXJcclxuICogd2lsbCBhdXRvbWF0aWNhbGx5IGV4dGVuZCB0aGUgd2FpdCB0aW1lIHRvIGVuYWJsZSBhbmltYXRpb25zIG9uY2UgKiphbGwqKiBvZiB0aGUgb3V0Ym91bmQgSFRUUCByZXF1ZXN0c1xyXG4gKiBhcmUgY29tcGxldGUuXHJcbiAqXHJcbiAqICMjIENTUy1kZWZpbmVkIEFuaW1hdGlvbnNcclxuICogVGhlIGFuaW1hdGUgc2VydmljZSB3aWxsIGF1dG9tYXRpY2FsbHkgYXBwbHkgdHdvIENTUyBjbGFzc2VzIHRvIHRoZSBhbmltYXRlZCBlbGVtZW50IGFuZCB0aGVzZSB0d28gQ1NTIGNsYXNzZXNcclxuICogYXJlIGRlc2lnbmVkIHRvIGNvbnRhaW4gdGhlIHN0YXJ0IGFuZCBlbmQgQ1NTIHN0eWxpbmcuIEJvdGggQ1NTIHRyYW5zaXRpb25zIGFuZCBrZXlmcmFtZSBhbmltYXRpb25zIGFyZSBzdXBwb3J0ZWRcclxuICogYW5kIGNhbiBiZSB1c2VkIHRvIHBsYXkgYWxvbmcgd2l0aCB0aGlzIG5hbWluZyBzdHJ1Y3R1cmUuXHJcbiAqXHJcbiAqIFRoZSBmb2xsb3dpbmcgY29kZSBiZWxvdyBkZW1vbnN0cmF0ZXMgaG93IHRvIHBlcmZvcm0gYW5pbWF0aW9ucyB1c2luZyAqKkNTUyB0cmFuc2l0aW9ucyoqIHdpdGggQW5ndWxhcjpcclxuICpcclxuICogYGBgaHRtbFxyXG4gKiA8c3R5bGUgdHlwZT1cInRleHQvY3NzXCI+XHJcbiAqIC8mIzQyO1xyXG4gKiAgVGhlIGFuaW1hdGUgY2xhc3MgaXMgYXBhcnQgb2YgdGhlIGVsZW1lbnQgYW5kIHRoZSBuZy1lbnRlciBjbGFzc1xyXG4gKiAgaXMgYXR0YWNoZWQgdG8gdGhlIGVsZW1lbnQgb25jZSB0aGUgZW50ZXIgYW5pbWF0aW9uIGV2ZW50IGlzIHRyaWdnZXJlZFxyXG4gKiAmIzQyOy9cclxuICogLnJldmVhbC1hbmltYXRpb24ubmctZW50ZXIge1xyXG4gKiAgLXdlYmtpdC10cmFuc2l0aW9uOiAxcyBsaW5lYXIgYWxsOyAvJiM0MjsgU2FmYXJpL0Nocm9tZSAmIzQyOy9cclxuICogIHRyYW5zaXRpb246IDFzIGxpbmVhciBhbGw7IC8mIzQyOyBBbGwgb3RoZXIgbW9kZXJuIGJyb3dzZXJzIGFuZCBJRTEwKyAmIzQyOy9cclxuICpcclxuICogIC8mIzQyOyBUaGUgYW5pbWF0aW9uIHByZXBhcmF0aW9uIGNvZGUgJiM0MjsvXHJcbiAqICBvcGFjaXR5OiAwO1xyXG4gKiB9XHJcbiAqXHJcbiAqIC8mIzQyO1xyXG4gKiAgS2VlcCBpbiBtaW5kIHRoYXQgeW91IHdhbnQgdG8gY29tYmluZSBib3RoIENTU1xyXG4gKiAgY2xhc3NlcyB0b2dldGhlciB0byBhdm9pZCBhbnkgQ1NTLXNwZWNpZmljaXR5XHJcbiAqICBjb25mbGljdHNcclxuICogJiM0MjsvXHJcbiAqIC5yZXZlYWwtYW5pbWF0aW9uLm5nLWVudGVyLm5nLWVudGVyLWFjdGl2ZSB7XHJcbiAqICAvJiM0MjsgVGhlIGFuaW1hdGlvbiBjb2RlIGl0c2VsZiAmIzQyOy9cclxuICogIG9wYWNpdHk6IDE7XHJcbiAqIH1cclxuICogPC9zdHlsZT5cclxuICpcclxuICogPGRpdiBjbGFzcz1cInZpZXctY29udGFpbmVyXCI+XHJcbiAqICAgPGRpdiBuZy12aWV3IGNsYXNzPVwicmV2ZWFsLWFuaW1hdGlvblwiPjwvZGl2PlxyXG4gKiA8L2Rpdj5cclxuICogYGBgXHJcbiAqXHJcbiAqIFRoZSBmb2xsb3dpbmcgY29kZSBiZWxvdyBkZW1vbnN0cmF0ZXMgaG93IHRvIHBlcmZvcm0gYW5pbWF0aW9ucyB1c2luZyAqKkNTUyBhbmltYXRpb25zKiogd2l0aCBBbmd1bGFyOlxyXG4gKlxyXG4gKiBgYGBodG1sXHJcbiAqIDxzdHlsZSB0eXBlPVwidGV4dC9jc3NcIj5cclxuICogLnJldmVhbC1hbmltYXRpb24ubmctZW50ZXIge1xyXG4gKiAgIC13ZWJraXQtYW5pbWF0aW9uOiBlbnRlcl9zZXF1ZW5jZSAxcyBsaW5lYXI7IC8mIzQyOyBTYWZhcmkvQ2hyb21lICYjNDI7L1xyXG4gKiAgIGFuaW1hdGlvbjogZW50ZXJfc2VxdWVuY2UgMXMgbGluZWFyOyAvJiM0MjsgSUUxMCsgYW5kIEZ1dHVyZSBCcm93c2VycyAmIzQyOy9cclxuICogfVxyXG4gKiBALXdlYmtpdC1rZXlmcmFtZXMgZW50ZXJfc2VxdWVuY2Uge1xyXG4gKiAgIGZyb20geyBvcGFjaXR5OjA7IH1cclxuICogICB0byB7IG9wYWNpdHk6MTsgfVxyXG4gKiB9XHJcbiAqIEBrZXlmcmFtZXMgZW50ZXJfc2VxdWVuY2Uge1xyXG4gKiAgIGZyb20geyBvcGFjaXR5OjA7IH1cclxuICogICB0byB7IG9wYWNpdHk6MTsgfVxyXG4gKiB9XHJcbiAqIDwvc3R5bGU+XHJcbiAqXHJcbiAqIDxkaXYgY2xhc3M9XCJ2aWV3LWNvbnRhaW5lclwiPlxyXG4gKiAgIDxkaXYgbmctdmlldyBjbGFzcz1cInJldmVhbC1hbmltYXRpb25cIj48L2Rpdj5cclxuICogPC9kaXY+XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBCb3RoIENTUzMgYW5pbWF0aW9ucyBhbmQgdHJhbnNpdGlvbnMgY2FuIGJlIHVzZWQgdG9nZXRoZXIgYW5kIHRoZSBhbmltYXRlIHNlcnZpY2Ugd2lsbCBmaWd1cmUgb3V0IHRoZSBjb3JyZWN0IGR1cmF0aW9uIGFuZCBkZWxheSB0aW1pbmcuXHJcbiAqXHJcbiAqIFVwb24gRE9NIG11dGF0aW9uLCB0aGUgZXZlbnQgY2xhc3MgaXMgYWRkZWQgZmlyc3QgKHNvbWV0aGluZyBsaWtlIGBuZy1lbnRlcmApLCB0aGVuIHRoZSBicm93c2VyIHByZXBhcmVzIGl0c2VsZiB0byBhZGRcclxuICogdGhlIGFjdGl2ZSBjbGFzcyAoaW4gdGhpcyBjYXNlIGBuZy1lbnRlci1hY3RpdmVgKSB3aGljaCB0aGVuIHRyaWdnZXJzIHRoZSBhbmltYXRpb24uIFRoZSBhbmltYXRpb24gbW9kdWxlIHdpbGwgYXV0b21hdGljYWxseVxyXG4gKiBkZXRlY3QgdGhlIENTUyBjb2RlIHRvIGRldGVybWluZSB3aGVuIHRoZSBhbmltYXRpb24gZW5kcy4gT25jZSB0aGUgYW5pbWF0aW9uIGlzIG92ZXIgdGhlbiBib3RoIENTUyBjbGFzc2VzIHdpbGwgYmVcclxuICogcmVtb3ZlZCBmcm9tIHRoZSBET00uIElmIGEgYnJvd3NlciBkb2VzIG5vdCBzdXBwb3J0IENTUyB0cmFuc2l0aW9ucyBvciBDU1MgYW5pbWF0aW9ucyB0aGVuIHRoZSBhbmltYXRpb24gd2lsbCBzdGFydCBhbmQgZW5kXHJcbiAqIGltbWVkaWF0ZWx5IHJlc3VsdGluZyBpbiBhIERPTSBlbGVtZW50IHRoYXQgaXMgYXQgaXRzIGZpbmFsIHN0YXRlLiBUaGlzIGZpbmFsIHN0YXRlIGlzIHdoZW4gdGhlIERPTSBlbGVtZW50XHJcbiAqIGhhcyBubyBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24gY2xhc3NlcyBhcHBsaWVkIHRvIGl0LlxyXG4gKlxyXG4gKiAjIyMgU3RydWN0dXJhbCB0cmFuc2l0aW9uIGFuaW1hdGlvbnNcclxuICpcclxuICogU3RydWN0dXJhbCB0cmFuc2l0aW9ucyAoc3VjaCBhcyBlbnRlciwgbGVhdmUgYW5kIG1vdmUpIHdpbGwgYWx3YXlzIGFwcGx5IGEgYDBzIG5vbmVgIHRyYW5zaXRpb25cclxuICogdmFsdWUgdG8gZm9yY2UgdGhlIGJyb3dzZXIgaW50byByZW5kZXJpbmcgdGhlIHN0eWxlcyBkZWZpbmVkIGluIHRoZSBzZXR1cCAoYC5uZy1lbnRlcmAsIGAubmctbGVhdmVgXHJcbiAqIG9yIGAubmctbW92ZWApIGNsYXNzLiBUaGlzIG1lYW5zIHRoYXQgYW55IGFjdGl2ZSB0cmFuc2l0aW9uIGFuaW1hdGlvbnMgb3BlcmF0aW5nIG9uIHRoZSBlbGVtZW50XHJcbiAqIHdpbGwgYmUgY3V0IG9mZiB0byBtYWtlIHdheSBmb3IgdGhlIGVudGVyLCBsZWF2ZSBvciBtb3ZlIGFuaW1hdGlvbi5cclxuICpcclxuICogIyMjIENsYXNzLWJhc2VkIHRyYW5zaXRpb24gYW5pbWF0aW9uc1xyXG4gKlxyXG4gKiBDbGFzcy1iYXNlZCB0cmFuc2l0aW9ucyByZWZlciB0byB0cmFuc2l0aW9uIGFuaW1hdGlvbnMgdGhhdCBhcmUgdHJpZ2dlcmVkIHdoZW4gYSBDU1MgY2xhc3MgaXNcclxuICogYWRkZWQgdG8gb3IgcmVtb3ZlZCBmcm9tIHRoZSBlbGVtZW50ICh2aWEgYCRhbmltYXRlLmFkZENsYXNzYCwgYCRhbmltYXRlLnJlbW92ZUNsYXNzYCxcclxuICogYCRhbmltYXRlLnNldENsYXNzYCwgb3IgYnkgZGlyZWN0aXZlcyBzdWNoIGFzIGBuZ0NsYXNzYCwgYG5nTW9kZWxgIGFuZCBgZm9ybWApLlxyXG4gKiBUaGV5IGFyZSBkaWZmZXJlbnQgd2hlbiBjb21wYXJlZCB0byBzdHJ1Y3R1cmFsIGFuaW1hdGlvbnMgc2luY2UgdGhleSAqKmRvIG5vdCBjYW5jZWwgZXhpc3RpbmdcclxuICogYW5pbWF0aW9ucyoqIG5vciBkbyB0aGV5ICoqYmxvY2sgc3VjY2Vzc2l2ZSB0cmFuc2l0aW9ucyoqIGZyb20gcmVuZGVyaW5nIG9uIHRoZSBzYW1lIGVsZW1lbnQuXHJcbiAqIFRoaXMgZGlzdGluY3Rpb24gYWxsb3dzIGZvciAqKm11bHRpcGxlIGNsYXNzLWJhc2VkIHRyYW5zaXRpb25zKiogdG8gYmUgcGVyZm9ybWVkIG9uIHRoZSBzYW1lIGVsZW1lbnQuXHJcbiAqXHJcbiAqIEluIGFkZGl0aW9uIHRvIG5nQW5pbWF0ZSBzdXBwb3J0aW5nIHRoZSBkZWZhdWx0IChuYXR1cmFsKSBmdW5jdGlvbmFsaXR5IG9mIGNsYXNzLWJhc2VkIHRyYW5zaXRpb25cclxuICogYW5pbWF0aW9ucywgbmdBbmltYXRlIGFsc28gZGVjb3JhdGVzIHRoZSBlbGVtZW50IHdpdGggc3RhcnRpbmcgYW5kIGVuZGluZyBDU1MgY2xhc3NlcyB0byBhaWQgdGhlXHJcbiAqIGRldmVsb3BlciBpbiBmdXJ0aGVyIHN0eWxpbmcgdGhlIGVsZW1lbnQgdGhyb3VnaG91dCB0aGUgdHJhbnNpdGlvbiBhbmltYXRpb24uIEVhcmxpZXIgdmVyc2lvbnNcclxuICogb2YgbmdBbmltYXRlIG1heSBoYXZlIGNhdXNlZCBuYXR1cmFsIENTUyB0cmFuc2l0aW9ucyB0byBicmVhayBhbmQgbm90IHJlbmRlciBwcm9wZXJseSBkdWUgdG9cclxuICogJGFuaW1hdGUgdGVtcG9yYXJpbHkgYmxvY2tpbmcgdHJhbnNpdGlvbnMgdXNpbmcgYDBzIG5vbmVgIGluIG9yZGVyIHRvIGFsbG93IHRoZSBzZXR1cCBDU1MgY2xhc3NcclxuICogKHRoZSBgLWFkZGAgb3IgYC1yZW1vdmVgIGNsYXNzKSB0byBiZSBhcHBsaWVkIHdpdGhvdXQgdHJpZ2dlcmluZyBhbiBhbmltYXRpb24uIEhvd2V2ZXIsIGFzIG9mXHJcbiAqICoqdmVyc2lvbiAxLjMqKiwgdGhpcyB3b3JrYXJvdW5kIGhhcyBiZWVuIHJlbW92ZWQgd2l0aCBuZ0FuaW1hdGUgYW5kIGFsbCBub24tbmdBbmltYXRlIENTU1xyXG4gKiBjbGFzcyB0cmFuc2l0aW9ucyBhcmUgY29tcGF0aWJsZSB3aXRoIG5nQW5pbWF0ZS5cclxuICpcclxuICogVGhlcmUgaXMsIGhvd2V2ZXIsIG9uZSBzcGVjaWFsIGNhc2Ugd2hlbiBkZWFsaW5nIHdpdGggY2xhc3MtYmFzZWQgdHJhbnNpdGlvbnMgaW4gbmdBbmltYXRlLlxyXG4gKiBXaGVuIHJlbmRlcmluZyBjbGFzcy1iYXNlZCB0cmFuc2l0aW9ucyB0aGF0IG1ha2UgdXNlIG9mIHRoZSBzZXR1cCBhbmQgYWN0aXZlIENTUyBjbGFzc2VzXHJcbiAqIChlLmcuIGAuZmFkZS1hZGRgIGFuZCBgLmZhZGUtYWRkLWFjdGl2ZWAgZm9yIHdoZW4gYC5mYWRlYCBpcyBhZGRlZCkgYmUgc3VyZSB0byBkZWZpbmVcclxuICogdGhlIHRyYW5zaXRpb24gdmFsdWUgKipvbiB0aGUgYWN0aXZlIENTUyBjbGFzcyoqIGFuZCBub3QgdGhlIHNldHVwIGNsYXNzLlxyXG4gKlxyXG4gKiBgYGBjc3NcclxuICogLmZhZGUtYWRkIHtcclxuICogICAvJiM0MjsgcmVtZW1iZXIgdG8gcGxhY2UgYSAwcyB0cmFuc2l0aW9uIGhlcmVcclxuICogICAgICB0byBlbnN1cmUgdGhhdCB0aGUgc3R5bGVzIGFyZSBhcHBsaWVkIGluc3RhbnRseVxyXG4gKiAgICAgIGV2ZW4gaWYgdGhlIGVsZW1lbnQgYWxyZWFkeSBoYXMgYSB0cmFuc2l0aW9uIHN0eWxlICYjNDI7L1xyXG4gKiAgIHRyYW5zaXRpb246MHMgbGluZWFyIGFsbDtcclxuICpcclxuICogICAvJiM0Mjsgc3RhcnRpbmcgQ1NTIHN0eWxlcyAmIzQyOy9cclxuICogICBvcGFjaXR5OjE7XHJcbiAqIH1cclxuICogLmZhZGUtYWRkLmZhZGUtYWRkLWFjdGl2ZSB7XHJcbiAqICAgLyYjNDI7IHRoaXMgd2lsbCBiZSB0aGUgbGVuZ3RoIG9mIHRoZSBhbmltYXRpb24gJiM0MjsvXHJcbiAqICAgdHJhbnNpdGlvbjoxcyBsaW5lYXIgYWxsO1xyXG4gKiAgIG9wYWNpdHk6MDtcclxuICogfVxyXG4gKiBgYGBcclxuICpcclxuICogVGhlIHNldHVwIENTUyBjbGFzcyAoaW4gdGhpcyBjYXNlIGAuZmFkZS1hZGRgKSBhbHNvIGhhcyBhIHRyYW5zaXRpb24gc3R5bGUgcHJvcGVydHksIGhvd2V2ZXIsIGl0XHJcbiAqIGhhcyBhIGR1cmF0aW9uIG9mIHplcm8uIFRoaXMgbWF5IG5vdCBiZSByZXF1aXJlZCwgaG93ZXZlciwgaW5jYXNlIHRoZSBicm93c2VyIGlzIHVuYWJsZSB0byByZW5kZXJcclxuICogdGhlIHN0eWxpbmcgcHJlc2VudCBpbiB0aGlzIENTUyBjbGFzcyBpbnN0YW50bHkgdGhlbiBpdCBjb3VsZCBiZSB0aGF0IHRoZSBicm93c2VyIGlzIGF0dGVtcHRpbmdcclxuICogdG8gcGVyZm9ybSBhbiB1bm5lY2Vzc2FyeSB0cmFuc2l0aW9uLlxyXG4gKlxyXG4gKiBUaGlzIHdvcmthcm91bmQsIGhvd2V2ZXIsIGRvZXMgbm90IGFwcGx5IHRvICBzdGFuZGFyZCBjbGFzcy1iYXNlZCB0cmFuc2l0aW9ucyB0aGF0IGFyZSByZW5kZXJlZFxyXG4gKiB3aGVuIGEgQ1NTIGNsYXNzIGNvbnRhaW5pbmcgYSB0cmFuc2l0aW9uIGlzIGFwcGxpZWQgdG8gYW4gZWxlbWVudDpcclxuICpcclxuICogYGBgY3NzXHJcbiAqIC8mIzQyOyB0aGlzIHdvcmtzIGFzIGV4cGVjdGVkICYjNDI7L1xyXG4gKiAuZmFkZSB7XHJcbiAqICAgdHJhbnNpdGlvbjoxcyBsaW5lYXIgYWxsO1xyXG4gKiAgIG9wYWNpdHk6MDtcclxuICogfVxyXG4gKiBgYGBcclxuICpcclxuICogUGxlYXNlIGtlZXAgdGhpcyBpbiBtaW5kIHdoZW4gY29kaW5nIHRoZSBDU1MgbWFya3VwIHRoYXQgd2lsbCBiZSB1c2VkIHdpdGhpbiBjbGFzcy1iYXNlZCB0cmFuc2l0aW9ucy5cclxuICogQWxzbywgdHJ5IG5vdCB0byBtaXggdGhlIHR3byBjbGFzcy1iYXNlZCBhbmltYXRpb24gZmxhdm9ycyB0b2dldGhlciBzaW5jZSB0aGUgQ1NTIGNvZGUgbWF5IGJlY29tZVxyXG4gKiBvdmVybHkgY29tcGxleC5cclxuICpcclxuICpcclxuICogIyMjIFByZXZlbnRpbmcgQ29sbGlzaW9ucyBXaXRoIFRoaXJkIFBhcnR5IExpYnJhcmllc1xyXG4gKlxyXG4gKiBTb21lIHRoaXJkLXBhcnR5IGZyYW1ld29ya3MgcGxhY2UgYW5pbWF0aW9uIGR1cmF0aW9uIGRlZmF1bHRzIGFjcm9zcyBtYW55IGVsZW1lbnQgb3IgY2xhc3NOYW1lXHJcbiAqIHNlbGVjdG9ycyBpbiBvcmRlciB0byBtYWtlIHRoZWlyIGNvZGUgc21hbGwgYW5kIHJldXNlYWJsZS4gVGhpcyBjYW4gbGVhZCB0byBpc3N1ZXMgd2l0aCBuZ0FuaW1hdGUsIHdoaWNoXHJcbiAqIGlzIGV4cGVjdGluZyBhY3R1YWwgYW5pbWF0aW9ucyBvbiB0aGVzZSBlbGVtZW50cyBhbmQgaGFzIHRvIHdhaXQgZm9yIHRoZWlyIGNvbXBsZXRpb24uXHJcbiAqXHJcbiAqIFlvdSBjYW4gcHJldmVudCB0aGlzIHVud2FudGVkIGJlaGF2aW9yIGJ5IHVzaW5nIGEgcHJlZml4IG9uIGFsbCB5b3VyIGFuaW1hdGlvbiBjbGFzc2VzOlxyXG4gKlxyXG4gKiBgYGBjc3NcclxuICogLyYjNDI7IHByZWZpeGVkIHdpdGggYW5pbWF0ZS0gJiM0MjsvXHJcbiAqIC5hbmltYXRlLWZhZGUtYWRkLmFuaW1hdGUtZmFkZS1hZGQtYWN0aXZlIHtcclxuICogICB0cmFuc2l0aW9uOjFzIGxpbmVhciBhbGw7XHJcbiAqICAgb3BhY2l0eTowO1xyXG4gKiB9XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBZb3UgdGhlbiBjb25maWd1cmUgYCRhbmltYXRlYCB0byBlbmZvcmNlIHRoaXMgcHJlZml4OlxyXG4gKlxyXG4gKiBgYGBqc1xyXG4gKiAkYW5pbWF0ZVByb3ZpZGVyLmNsYXNzTmFtZUZpbHRlcigvYW5pbWF0ZS0vKTtcclxuICogYGBgXHJcbiAqIDwvZGl2PlxyXG4gKlxyXG4gKiAjIyMgQ1NTIFN0YWdnZXJpbmcgQW5pbWF0aW9uc1xyXG4gKiBBIFN0YWdnZXJpbmcgYW5pbWF0aW9uIGlzIGEgY29sbGVjdGlvbiBvZiBhbmltYXRpb25zIHRoYXQgYXJlIGlzc3VlZCB3aXRoIGEgc2xpZ2h0IGRlbGF5IGluIGJldHdlZW4gZWFjaCBzdWNjZXNzaXZlIG9wZXJhdGlvbiByZXN1bHRpbmcgaW4gYVxyXG4gKiBjdXJ0YWluLWxpa2UgZWZmZWN0LiBUaGUgbmdBbmltYXRlIG1vZHVsZSAodmVyc2lvbnMgPj0xLjIpIHN1cHBvcnRzIHN0YWdnZXJpbmcgYW5pbWF0aW9ucyBhbmQgdGhlIHN0YWdnZXIgZWZmZWN0IGNhbiBiZVxyXG4gKiBwZXJmb3JtZWQgYnkgY3JlYXRpbmcgYSAqKm5nLUVWRU5ULXN0YWdnZXIqKiBDU1MgY2xhc3MgYW5kIGF0dGFjaGluZyB0aGF0IGNsYXNzIHRvIHRoZSBiYXNlIENTUyBjbGFzcyB1c2VkIGZvclxyXG4gKiB0aGUgYW5pbWF0aW9uLiBUaGUgc3R5bGUgcHJvcGVydHkgZXhwZWN0ZWQgd2l0aGluIHRoZSBzdGFnZ2VyIGNsYXNzIGNhbiBlaXRoZXIgYmUgYSAqKnRyYW5zaXRpb24tZGVsYXkqKiBvciBhblxyXG4gKiAqKmFuaW1hdGlvbi1kZWxheSoqIHByb3BlcnR5IChvciBib3RoIGlmIHlvdXIgYW5pbWF0aW9uIGNvbnRhaW5zIGJvdGggdHJhbnNpdGlvbnMgYW5kIGtleWZyYW1lIGFuaW1hdGlvbnMpLlxyXG4gKlxyXG4gKiBgYGBjc3NcclxuICogLm15LWFuaW1hdGlvbi5uZy1lbnRlciB7XHJcbiAqICAgLyYjNDI7IHN0YW5kYXJkIHRyYW5zaXRpb24gY29kZSAmIzQyOy9cclxuICogICAtd2Via2l0LXRyYW5zaXRpb246IDFzIGxpbmVhciBhbGw7XHJcbiAqICAgdHJhbnNpdGlvbjogMXMgbGluZWFyIGFsbDtcclxuICogICBvcGFjaXR5OjA7XHJcbiAqIH1cclxuICogLm15LWFuaW1hdGlvbi5uZy1lbnRlci1zdGFnZ2VyIHtcclxuICogICAvJiM0MjsgdGhpcyB3aWxsIGhhdmUgYSAxMDBtcyBkZWxheSBiZXR3ZWVuIGVhY2ggc3VjY2Vzc2l2ZSBsZWF2ZSBhbmltYXRpb24gJiM0MjsvXHJcbiAqICAgLXdlYmtpdC10cmFuc2l0aW9uLWRlbGF5OiAwLjFzO1xyXG4gKiAgIHRyYW5zaXRpb24tZGVsYXk6IDAuMXM7XHJcbiAqXHJcbiAqICAgLyYjNDI7IGluIGNhc2UgdGhlIHN0YWdnZXIgZG9lc24ndCB3b3JrIHRoZW4gdGhlc2UgdHdvIHZhbHVlc1xyXG4gKiAgICBtdXN0IGJlIHNldCB0byAwIHRvIGF2b2lkIGFuIGFjY2lkZW50YWwgQ1NTIGluaGVyaXRhbmNlICYjNDI7L1xyXG4gKiAgIC13ZWJraXQtdHJhbnNpdGlvbi1kdXJhdGlvbjogMHM7XHJcbiAqICAgdHJhbnNpdGlvbi1kdXJhdGlvbjogMHM7XHJcbiAqIH1cclxuICogLm15LWFuaW1hdGlvbi5uZy1lbnRlci5uZy1lbnRlci1hY3RpdmUge1xyXG4gKiAgIC8mIzQyOyBzdGFuZGFyZCB0cmFuc2l0aW9uIHN0eWxlcyAmIzQyOy9cclxuICogICBvcGFjaXR5OjE7XHJcbiAqIH1cclxuICogYGBgXHJcbiAqXHJcbiAqIFN0YWdnZXJpbmcgYW5pbWF0aW9ucyB3b3JrIGJ5IGRlZmF1bHQgaW4gbmdSZXBlYXQgKHNvIGxvbmcgYXMgdGhlIENTUyBjbGFzcyBpcyBkZWZpbmVkKS4gT3V0c2lkZSBvZiBuZ1JlcGVhdCwgdG8gdXNlIHN0YWdnZXJpbmcgYW5pbWF0aW9uc1xyXG4gKiBvbiB5b3VyIG93biwgdGhleSBjYW4gYmUgdHJpZ2dlcmVkIGJ5IGZpcmluZyBtdWx0aXBsZSBjYWxscyB0byB0aGUgc2FtZSBldmVudCBvbiAkYW5pbWF0ZS4gSG93ZXZlciwgdGhlIHJlc3RyaWN0aW9ucyBzdXJyb3VuZGluZyB0aGlzXHJcbiAqIGFyZSB0aGF0IGVhY2ggb2YgdGhlIGVsZW1lbnRzIG11c3QgaGF2ZSB0aGUgc2FtZSBDU1MgY2xhc3NOYW1lIHZhbHVlIGFzIHdlbGwgYXMgdGhlIHNhbWUgcGFyZW50IGVsZW1lbnQuIEEgc3RhZ2dlciBvcGVyYXRpb25cclxuICogd2lsbCBhbHNvIGJlIHJlc2V0IGlmIG1vcmUgdGhhbiAxMG1zIGhhcyBwYXNzZWQgYWZ0ZXIgdGhlIGxhc3QgYW5pbWF0aW9uIGhhcyBiZWVuIGZpcmVkLlxyXG4gKlxyXG4gKiBUaGUgZm9sbG93aW5nIGNvZGUgd2lsbCBpc3N1ZSB0aGUgKipuZy1sZWF2ZS1zdGFnZ2VyKiogZXZlbnQgb24gdGhlIGVsZW1lbnQgcHJvdmlkZWQ6XHJcbiAqXHJcbiAqIGBgYGpzXHJcbiAqIHZhciBraWRzID0gcGFyZW50LmNoaWxkcmVuKCk7XHJcbiAqXHJcbiAqICRhbmltYXRlLmxlYXZlKGtpZHNbMF0pOyAvL3N0YWdnZXIgaW5kZXg9MFxyXG4gKiAkYW5pbWF0ZS5sZWF2ZShraWRzWzFdKTsgLy9zdGFnZ2VyIGluZGV4PTFcclxuICogJGFuaW1hdGUubGVhdmUoa2lkc1syXSk7IC8vc3RhZ2dlciBpbmRleD0yXHJcbiAqICRhbmltYXRlLmxlYXZlKGtpZHNbM10pOyAvL3N0YWdnZXIgaW5kZXg9M1xyXG4gKiAkYW5pbWF0ZS5sZWF2ZShraWRzWzRdKTsgLy9zdGFnZ2VyIGluZGV4PTRcclxuICpcclxuICogJHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAqICAgLy9zdGFnZ2VyIGhhcyByZXNldCBpdHNlbGZcclxuICogICAkYW5pbWF0ZS5sZWF2ZShraWRzWzVdKTsgLy9zdGFnZ2VyIGluZGV4PTBcclxuICogICAkYW5pbWF0ZS5sZWF2ZShraWRzWzZdKTsgLy9zdGFnZ2VyIGluZGV4PTFcclxuICogfSwgMTAwLCBmYWxzZSk7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBTdGFnZ2VyIGFuaW1hdGlvbnMgYXJlIGN1cnJlbnRseSBvbmx5IHN1cHBvcnRlZCB3aXRoaW4gQ1NTLWRlZmluZWQgYW5pbWF0aW9ucy5cclxuICpcclxuICogIyMgSmF2YVNjcmlwdC1kZWZpbmVkIEFuaW1hdGlvbnNcclxuICogSW4gdGhlIGV2ZW50IHRoYXQgeW91IGRvIG5vdCB3YW50IHRvIHVzZSBDU1MzIHRyYW5zaXRpb25zIG9yIENTUzMgYW5pbWF0aW9ucyBvciBpZiB5b3Ugd2lzaCB0byBvZmZlciBhbmltYXRpb25zIG9uIGJyb3dzZXJzIHRoYXQgZG8gbm90XHJcbiAqIHlldCBzdXBwb3J0IENTUyB0cmFuc2l0aW9ucy9hbmltYXRpb25zLCB0aGVuIHlvdSBjYW4gbWFrZSB1c2Ugb2YgSmF2YVNjcmlwdCBhbmltYXRpb25zIGRlZmluZWQgaW5zaWRlIG9mIHlvdXIgQW5ndWxhckpTIG1vZHVsZS5cclxuICpcclxuICogYGBganNcclxuICogLy8hYW5ub3RhdGU9XCJZb3VyQXBwXCIgWW91ciBBbmd1bGFySlMgTW9kdWxlfFJlcGxhY2UgdGhpcyBvciBuZ01vZHVsZSB3aXRoIHRoZSBtb2R1bGUgdGhhdCB5b3UgdXNlZCB0byBkZWZpbmUgeW91ciBhcHBsaWNhdGlvbi5cclxuICogdmFyIG5nTW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ1lvdXJBcHAnLCBbJ25nQW5pbWF0ZSddKTtcclxuICogbmdNb2R1bGUuYW5pbWF0aW9uKCcubXktY3JhenktYW5pbWF0aW9uJywgZnVuY3Rpb24oKSB7XHJcbiAqICAgcmV0dXJuIHtcclxuICogICAgIGVudGVyOiBmdW5jdGlvbihlbGVtZW50LCBkb25lKSB7XHJcbiAqICAgICAgIC8vcnVuIHRoZSBhbmltYXRpb24gaGVyZSBhbmQgY2FsbCBkb25lIHdoZW4gdGhlIGFuaW1hdGlvbiBpcyBjb21wbGV0ZVxyXG4gKiAgICAgICByZXR1cm4gZnVuY3Rpb24oY2FuY2VsbGVkKSB7XHJcbiAqICAgICAgICAgLy90aGlzIChvcHRpb25hbCkgZnVuY3Rpb24gd2lsbCBiZSBjYWxsZWQgd2hlbiB0aGUgYW5pbWF0aW9uXHJcbiAqICAgICAgICAgLy9jb21wbGV0ZXMgb3Igd2hlbiB0aGUgYW5pbWF0aW9uIGlzIGNhbmNlbGxlZCAodGhlIGNhbmNlbGxlZFxyXG4gKiAgICAgICAgIC8vZmxhZyB3aWxsIGJlIHNldCB0byB0cnVlIGlmIGNhbmNlbGxlZCkuXHJcbiAqICAgICAgIH07XHJcbiAqICAgICB9LFxyXG4gKiAgICAgbGVhdmU6IGZ1bmN0aW9uKGVsZW1lbnQsIGRvbmUpIHsgfSxcclxuICogICAgIG1vdmU6IGZ1bmN0aW9uKGVsZW1lbnQsIGRvbmUpIHsgfSxcclxuICpcclxuICogICAgIC8vYW5pbWF0aW9uIHRoYXQgY2FuIGJlIHRyaWdnZXJlZCBiZWZvcmUgdGhlIGNsYXNzIGlzIGFkZGVkXHJcbiAqICAgICBiZWZvcmVBZGRDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lKSB7IH0sXHJcbiAqXHJcbiAqICAgICAvL2FuaW1hdGlvbiB0aGF0IGNhbiBiZSB0cmlnZ2VyZWQgYWZ0ZXIgdGhlIGNsYXNzIGlzIGFkZGVkXHJcbiAqICAgICBhZGRDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lKSB7IH0sXHJcbiAqXHJcbiAqICAgICAvL2FuaW1hdGlvbiB0aGF0IGNhbiBiZSB0cmlnZ2VyZWQgYmVmb3JlIHRoZSBjbGFzcyBpcyByZW1vdmVkXHJcbiAqICAgICBiZWZvcmVSZW1vdmVDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lKSB7IH0sXHJcbiAqXHJcbiAqICAgICAvL2FuaW1hdGlvbiB0aGF0IGNhbiBiZSB0cmlnZ2VyZWQgYWZ0ZXIgdGhlIGNsYXNzIGlzIHJlbW92ZWRcclxuICogICAgIHJlbW92ZUNsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGRvbmUpIHsgfVxyXG4gKiAgIH07XHJcbiAqIH0pO1xyXG4gKiBgYGBcclxuICpcclxuICogSmF2YVNjcmlwdC1kZWZpbmVkIGFuaW1hdGlvbnMgYXJlIGNyZWF0ZWQgd2l0aCBhIENTUy1saWtlIGNsYXNzIHNlbGVjdG9yIGFuZCBhIGNvbGxlY3Rpb24gb2YgZXZlbnRzIHdoaWNoIGFyZSBzZXQgdG8gcnVuXHJcbiAqIGEgamF2YXNjcmlwdCBjYWxsYmFjayBmdW5jdGlvbi4gV2hlbiBhbiBhbmltYXRpb24gaXMgdHJpZ2dlcmVkLCAkYW5pbWF0ZSB3aWxsIGxvb2sgZm9yIGEgbWF0Y2hpbmcgYW5pbWF0aW9uIHdoaWNoIGZpdHNcclxuICogdGhlIGVsZW1lbnQncyBDU1MgY2xhc3MgYXR0cmlidXRlIHZhbHVlIGFuZCB0aGVuIHJ1biB0aGUgbWF0Y2hpbmcgYW5pbWF0aW9uIGV2ZW50IGZ1bmN0aW9uIChpZiBmb3VuZCkuXHJcbiAqIEluIG90aGVyIHdvcmRzLCBpZiB0aGUgQ1NTIGNsYXNzZXMgcHJlc2VudCBvbiB0aGUgYW5pbWF0ZWQgZWxlbWVudCBtYXRjaCBhbnkgb2YgdGhlIEphdmFTY3JpcHQgYW5pbWF0aW9ucyB0aGVuIHRoZSBjYWxsYmFjayBmdW5jdGlvbiB3aWxsXHJcbiAqIGJlIGV4ZWN1dGVkLiBJdCBzaG91bGQgYmUgYWxzbyBub3RlZCB0aGF0IG9ubHkgc2ltcGxlLCBzaW5nbGUgY2xhc3Mgc2VsZWN0b3JzIGFyZSBhbGxvd2VkIChjb21wb3VuZCBjbGFzcyBzZWxlY3RvcnMgYXJlIG5vdCBzdXBwb3J0ZWQpLlxyXG4gKlxyXG4gKiBXaXRoaW4gYSBKYXZhU2NyaXB0IGFuaW1hdGlvbiwgYW4gb2JqZWN0IGNvbnRhaW5pbmcgdmFyaW91cyBldmVudCBjYWxsYmFjayBhbmltYXRpb24gZnVuY3Rpb25zIGlzIGV4cGVjdGVkIHRvIGJlIHJldHVybmVkLlxyXG4gKiBBcyBleHBsYWluZWQgYWJvdmUsIHRoZXNlIGNhbGxiYWNrcyBhcmUgdHJpZ2dlcmVkIGJhc2VkIG9uIHRoZSBhbmltYXRpb24gZXZlbnQuIFRoZXJlZm9yZSBpZiBhbiBlbnRlciBhbmltYXRpb24gaXMgcnVuLFxyXG4gKiBhbmQgdGhlIEphdmFTY3JpcHQgYW5pbWF0aW9uIGlzIGZvdW5kLCB0aGVuIHRoZSBlbnRlciBjYWxsYmFjayB3aWxsIGhhbmRsZSB0aGF0IGFuaW1hdGlvbiAoaW4gYWRkaXRpb24gdG8gdGhlIENTUyBrZXlmcmFtZSBhbmltYXRpb25cclxuICogb3IgdHJhbnNpdGlvbiBjb2RlIHRoYXQgaXMgZGVmaW5lZCB2aWEgYSBzdHlsZXNoZWV0KS5cclxuICpcclxuICpcclxuICogIyMjIEFwcGx5aW5nIERpcmVjdGl2ZS1zcGVjaWZpYyBTdHlsZXMgdG8gYW4gQW5pbWF0aW9uXHJcbiAqIEluIHNvbWUgY2FzZXMgYSBkaXJlY3RpdmUgb3Igc2VydmljZSBtYXkgd2FudCB0byBwcm92aWRlIGAkYW5pbWF0ZWAgd2l0aCBleHRyYSBkZXRhaWxzIHRoYXQgdGhlIGFuaW1hdGlvbiB3aWxsXHJcbiAqIGluY2x1ZGUgaW50byBpdHMgYW5pbWF0aW9uLiBMZXQncyBzYXkgZm9yIGV4YW1wbGUgd2Ugd2FudGVkIHRvIHJlbmRlciBhbiBhbmltYXRpb24gdGhhdCBhbmltYXRlcyBhbiBlbGVtZW50XHJcbiAqIHRvd2FyZHMgdGhlIG1vdXNlIGNvb3JkaW5hdGVzIGFzIHRvIHdoZXJlIHRoZSB1c2VyIGNsaWNrZWQgbGFzdC4gQnkgY29sbGVjdGluZyB0aGUgWC9ZIGNvb3JkaW5hdGVzIG9mIHRoZSBjbGlja1xyXG4gKiAodmlhIHRoZSBldmVudCBwYXJhbWV0ZXIpIHdlIGNhbiBzZXQgdGhlIGB0b3BgIGFuZCBgbGVmdGAgc3R5bGVzIGludG8gYW4gb2JqZWN0IGFuZCBwYXNzIHRoYXQgaW50byBvdXIgZnVuY3Rpb25cclxuICogY2FsbCB0byBgJGFuaW1hdGUuYWRkQ2xhc3NgLlxyXG4gKlxyXG4gKiBgYGBqc1xyXG4gKiBjYW52YXMub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gKiAgICRhbmltYXRlLmFkZENsYXNzKGVsZW1lbnQsICdvbicsIHtcclxuICogICAgIHRvOiB7XHJcbiAqICAgICAgIGxlZnQgOiBlLmNsaWVudC54ICsgJ3B4JyxcclxuICogICAgICAgdG9wIDogZS5jbGllbnQueSArICdweCdcclxuICogICAgIH1cclxuICogICB9KTpcclxuICogfSk7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBOb3cgd2hlbiB0aGUgYW5pbWF0aW9uIHJ1bnMsIGFuZCBhIHRyYW5zaXRpb24gb3Iga2V5ZnJhbWUgYW5pbWF0aW9uIGlzIHBpY2tlZCB1cCwgdGhlbiB0aGUgYW5pbWF0aW9uIGl0c2VsZiB3aWxsXHJcbiAqIGFsc28gaW5jbHVkZSBhbmQgdHJhbnNpdGlvbiB0aGUgc3R5bGluZyBvZiB0aGUgYGxlZnRgIGFuZCBgdG9wYCBwcm9wZXJ0aWVzIGludG8gaXRzIHJ1bm5pbmcgYW5pbWF0aW9uLiBJZiB3ZSB3YW50XHJcbiAqIHRvIHByb3ZpZGUgc29tZSBzdGFydGluZyBhbmltYXRpb24gdmFsdWVzIHRoZW4gd2UgY2FuIGRvIHNvIGJ5IHBsYWNpbmcgdGhlIHN0YXJ0aW5nIGFuaW1hdGlvbnMgc3R5bGVzIGludG8gYW4gb2JqZWN0XHJcbiAqIGNhbGxlZCBgZnJvbWAgaW4gdGhlIHNhbWUgb2JqZWN0IGFzIHRoZSBgdG9gIGFuaW1hdGlvbnMuXHJcbiAqXHJcbiAqIGBgYGpzXHJcbiAqIGNhbnZhcy5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcbiAqICAgJGFuaW1hdGUuYWRkQ2xhc3MoZWxlbWVudCwgJ29uJywge1xyXG4gKiAgICAgZnJvbToge1xyXG4gKiAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXHJcbiAqICAgICAgICBsZWZ0OiAnMHB4JyxcclxuICogICAgICAgIHRvcDogJzBweCdcclxuICogICAgIH0sXHJcbiAqICAgICB0bzoge1xyXG4gKiAgICAgICBsZWZ0IDogZS5jbGllbnQueCArICdweCcsXHJcbiAqICAgICAgIHRvcCA6IGUuY2xpZW50LnkgKyAncHgnXHJcbiAqICAgICB9XHJcbiAqICAgfSk6XHJcbiAqIH0pO1xyXG4gKiBgYGBcclxuICpcclxuICogT25jZSB0aGUgYW5pbWF0aW9uIGlzIGNvbXBsZXRlIG9yIGNhbmNlbGxlZCB0aGVuIHRoZSB1bmlvbiBvZiBib3RoIHRoZSBiZWZvcmUgYW5kIGFmdGVyIHN0eWxlcyBhcmUgYXBwbGllZCB0byB0aGVcclxuICogZWxlbWVudC4gSWYgYG5nQW5pbWF0ZWAgaXMgbm90IHByZXNlbnQgdGhlbiB0aGUgc3R5bGVzIHdpbGwgYmUgYXBwbGllZCBpbW1lZGlhdGVseS5cclxuICpcclxuICovXHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnbmdBbmltYXRlJywgWyduZyddKVxyXG5cclxuICAvKipcclxuICAgKiBAbmdkb2MgcHJvdmlkZXJcclxuICAgKiBAbmFtZSAkYW5pbWF0ZVByb3ZpZGVyXHJcbiAgICogQGRlc2NyaXB0aW9uXHJcbiAgICpcclxuICAgKiBUaGUgYCRhbmltYXRlUHJvdmlkZXJgIGFsbG93cyBkZXZlbG9wZXJzIHRvIHJlZ2lzdGVyIEphdmFTY3JpcHQgYW5pbWF0aW9uIGV2ZW50IGhhbmRsZXJzIGRpcmVjdGx5IGluc2lkZSBvZiBhIG1vZHVsZS5cclxuICAgKiBXaGVuIGFuIGFuaW1hdGlvbiBpcyB0cmlnZ2VyZWQsIHRoZSAkYW5pbWF0ZSBzZXJ2aWNlIHdpbGwgcXVlcnkgdGhlICRhbmltYXRlIHNlcnZpY2UgdG8gZmluZCBhbnkgYW5pbWF0aW9ucyB0aGF0IG1hdGNoXHJcbiAgICogdGhlIHByb3ZpZGVkIG5hbWUgdmFsdWUuXHJcbiAgICpcclxuICAgKiBSZXF1aXJlcyB0aGUge0BsaW5rIG5nQW5pbWF0ZSBgbmdBbmltYXRlYH0gbW9kdWxlIHRvIGJlIGluc3RhbGxlZC5cclxuICAgKlxyXG4gICAqIFBsZWFzZSB2aXNpdCB0aGUge0BsaW5rIG5nQW5pbWF0ZSBgbmdBbmltYXRlYH0gbW9kdWxlIG92ZXJ2aWV3IHBhZ2UgbGVhcm4gbW9yZSBhYm91dCBob3cgdG8gdXNlIGFuaW1hdGlvbnMgaW4geW91ciBhcHBsaWNhdGlvbi5cclxuICAgKlxyXG4gICAqL1xyXG4gIC5kaXJlY3RpdmUoJ25nQW5pbWF0ZUNoaWxkcmVuJywgZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgTkdfQU5JTUFURV9DSElMRFJFTiA9ICckJG5nQW5pbWF0ZUNoaWxkcmVuJztcclxuICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcclxuICAgICAgdmFyIHZhbCA9IGF0dHJzLm5nQW5pbWF0ZUNoaWxkcmVuO1xyXG4gICAgICBpZiAoYW5ndWxhci5pc1N0cmluZyh2YWwpICYmIHZhbC5sZW5ndGggPT09IDApIHsgLy9lbXB0eSBhdHRyaWJ1dGVcclxuICAgICAgICBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9DSElMRFJFTiwgdHJ1ZSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgc2NvcGUuJHdhdGNoKHZhbCwgZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICAgIGVsZW1lbnQuZGF0YShOR19BTklNQVRFX0NISUxEUkVOLCAhIXZhbHVlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9KVxyXG5cclxuICAvL3RoaXMgcHJpdmF0ZSBzZXJ2aWNlIGlzIG9ubHkgdXNlZCB3aXRoaW4gQ1NTLWVuYWJsZWQgYW5pbWF0aW9uc1xyXG4gIC8vSUU4ICsgSUU5IGRvIG5vdCBzdXBwb3J0IHJBRiBuYXRpdmVseSwgYnV0IHRoYXQgaXMgZmluZSBzaW5jZSB0aGV5XHJcbiAgLy9hbHNvIGRvbid0IHN1cHBvcnQgdHJhbnNpdGlvbnMgYW5kIGtleWZyYW1lcyB3aGljaCBtZWFucyB0aGF0IHRoZSBjb2RlXHJcbiAgLy9iZWxvdyB3aWxsIG5ldmVyIGJlIHVzZWQgYnkgdGhlIHR3byBicm93c2Vycy5cclxuICAuZmFjdG9yeSgnJCRhbmltYXRlUmVmbG93JywgWyckJHJBRicsICckZG9jdW1lbnQnLCBmdW5jdGlvbigkJHJBRiwgJGRvY3VtZW50KSB7XHJcbiAgICB2YXIgYm9kID0gJGRvY3VtZW50WzBdLmJvZHk7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24oZm4pIHtcclxuICAgICAgLy90aGUgcmV0dXJuZWQgZnVuY3Rpb24gYWN0cyBhcyB0aGUgY2FuY2VsbGF0aW9uIGZ1bmN0aW9uXHJcbiAgICAgIHJldHVybiAkJHJBRihmdW5jdGlvbigpIHtcclxuICAgICAgICAvL3RoZSBsaW5lIGJlbG93IHdpbGwgZm9yY2UgdGhlIGJyb3dzZXIgdG8gcGVyZm9ybSBhIHJlcGFpbnRcclxuICAgICAgICAvL3NvIHRoYXQgYWxsIHRoZSBhbmltYXRlZCBlbGVtZW50cyB3aXRoaW4gdGhlIGFuaW1hdGlvbiBmcmFtZVxyXG4gICAgICAgIC8vd2lsbCBiZSBwcm9wZXJseSB1cGRhdGVkIGFuZCBkcmF3biBvbiBzY3JlZW4uIFRoaXMgaXNcclxuICAgICAgICAvL3JlcXVpcmVkIHRvIHBlcmZvcm0gbXVsdGktY2xhc3MgQ1NTIGJhc2VkIGFuaW1hdGlvbnMgd2l0aFxyXG4gICAgICAgIC8vRmlyZWZveC4gRE8gTk9UIFJFTU9WRSBUSElTIExJTkUuXHJcbiAgICAgICAgdmFyIGEgPSBib2Qub2Zmc2V0V2lkdGggKyAxO1xyXG4gICAgICAgIGZuKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfTtcclxuICB9XSlcclxuXHJcbiAgLmNvbmZpZyhbJyRwcm92aWRlJywgJyRhbmltYXRlUHJvdmlkZXInLCBmdW5jdGlvbigkcHJvdmlkZSwgJGFuaW1hdGVQcm92aWRlcikge1xyXG4gICAgdmFyIG5vb3AgPSBhbmd1bGFyLm5vb3A7XHJcbiAgICB2YXIgZm9yRWFjaCA9IGFuZ3VsYXIuZm9yRWFjaDtcclxuICAgIHZhciBzZWxlY3RvcnMgPSAkYW5pbWF0ZVByb3ZpZGVyLiQkc2VsZWN0b3JzO1xyXG4gICAgdmFyIGlzQXJyYXkgPSBhbmd1bGFyLmlzQXJyYXk7XHJcbiAgICB2YXIgaXNTdHJpbmcgPSBhbmd1bGFyLmlzU3RyaW5nO1xyXG4gICAgdmFyIGlzT2JqZWN0ID0gYW5ndWxhci5pc09iamVjdDtcclxuXHJcbiAgICB2YXIgRUxFTUVOVF9OT0RFID0gMTtcclxuICAgIHZhciBOR19BTklNQVRFX1NUQVRFID0gJyQkbmdBbmltYXRlU3RhdGUnO1xyXG4gICAgdmFyIE5HX0FOSU1BVEVfQ0hJTERSRU4gPSAnJCRuZ0FuaW1hdGVDaGlsZHJlbic7XHJcbiAgICB2YXIgTkdfQU5JTUFURV9DTEFTU19OQU1FID0gJ25nLWFuaW1hdGUnO1xyXG4gICAgdmFyIHJvb3RBbmltYXRlU3RhdGUgPSB7cnVubmluZzogdHJ1ZX07XHJcblxyXG4gICAgZnVuY3Rpb24gZXh0cmFjdEVsZW1lbnROb2RlKGVsZW1lbnQpIHtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGVsbSA9IGVsZW1lbnRbaV07XHJcbiAgICAgICAgaWYgKGVsbS5ub2RlVHlwZSA9PSBFTEVNRU5UX05PREUpIHtcclxuICAgICAgICAgIHJldHVybiBlbG07XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcHJlcGFyZUVsZW1lbnQoZWxlbWVudCkge1xyXG4gICAgICByZXR1cm4gZWxlbWVudCAmJiBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gc3RyaXBDb21tZW50c0Zyb21FbGVtZW50KGVsZW1lbnQpIHtcclxuICAgICAgcmV0dXJuIGFuZ3VsYXIuZWxlbWVudChleHRyYWN0RWxlbWVudE5vZGUoZWxlbWVudCkpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGlzTWF0Y2hpbmdFbGVtZW50KGVsbTEsIGVsbTIpIHtcclxuICAgICAgcmV0dXJuIGV4dHJhY3RFbGVtZW50Tm9kZShlbG0xKSA9PSBleHRyYWN0RWxlbWVudE5vZGUoZWxtMik7XHJcbiAgICB9XHJcbiAgICB2YXIgJCRqcUxpdGU7XHJcbiAgICAkcHJvdmlkZS5kZWNvcmF0b3IoJyRhbmltYXRlJyxcclxuICAgICAgICBbJyRkZWxlZ2F0ZScsICckJHEnLCAnJGluamVjdG9yJywgJyRzbmlmZmVyJywgJyRyb290RWxlbWVudCcsICckJGFzeW5jQ2FsbGJhY2snLCAnJHJvb3RTY29wZScsICckZG9jdW1lbnQnLCAnJHRlbXBsYXRlUmVxdWVzdCcsICckJGpxTGl0ZScsXHJcbiBmdW5jdGlvbigkZGVsZWdhdGUsICAgJCRxLCAgICRpbmplY3RvciwgICAkc25pZmZlciwgICAkcm9vdEVsZW1lbnQsICAgJCRhc3luY0NhbGxiYWNrLCAgICRyb290U2NvcGUsICAgJGRvY3VtZW50LCAgICR0ZW1wbGF0ZVJlcXVlc3QsICAgJCQkanFMaXRlKSB7XHJcblxyXG4gICAgICAkJGpxTGl0ZSA9ICQkJGpxTGl0ZTtcclxuICAgICAgJHJvb3RFbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSwgcm9vdEFuaW1hdGVTdGF0ZSk7XHJcblxyXG4gICAgICAvLyBXYWl0IHVudGlsIGFsbCBkaXJlY3RpdmUgYW5kIHJvdXRlLXJlbGF0ZWQgdGVtcGxhdGVzIGFyZSBkb3dubG9hZGVkIGFuZFxyXG4gICAgICAvLyBjb21waWxlZC4gVGhlICR0ZW1wbGF0ZVJlcXVlc3QudG90YWxQZW5kaW5nUmVxdWVzdHMgdmFyaWFibGUga2VlcHMgdHJhY2sgb2ZcclxuICAgICAgLy8gYWxsIG9mIHRoZSByZW1vdGUgdGVtcGxhdGVzIGJlaW5nIGN1cnJlbnRseSBkb3dubG9hZGVkLiBJZiB0aGVyZSBhcmUgbm9cclxuICAgICAgLy8gdGVtcGxhdGVzIGN1cnJlbnRseSBkb3dubG9hZGluZyB0aGVuIHRoZSB3YXRjaGVyIHdpbGwgc3RpbGwgZmlyZSBhbnl3YXkuXHJcbiAgICAgIHZhciBkZXJlZ2lzdGVyV2F0Y2ggPSAkcm9vdFNjb3BlLiR3YXRjaChcclxuICAgICAgICBmdW5jdGlvbigpIHsgcmV0dXJuICR0ZW1wbGF0ZVJlcXVlc3QudG90YWxQZW5kaW5nUmVxdWVzdHM7IH0sXHJcbiAgICAgICAgZnVuY3Rpb24odmFsLCBvbGRWYWwpIHtcclxuICAgICAgICAgIGlmICh2YWwgIT09IDApIHJldHVybjtcclxuICAgICAgICAgIGRlcmVnaXN0ZXJXYXRjaCgpO1xyXG5cclxuICAgICAgICAgIC8vIE5vdyB0aGF0IGFsbCB0ZW1wbGF0ZXMgaGF2ZSBiZWVuIGRvd25sb2FkZWQsICRhbmltYXRlIHdpbGwgd2FpdCB1bnRpbFxyXG4gICAgICAgICAgLy8gdGhlIHBvc3QgZGlnZXN0IHF1ZXVlIGlzIGVtcHR5IGJlZm9yZSBlbmFibGluZyBhbmltYXRpb25zLiBCeSBoYXZpbmcgdHdvXHJcbiAgICAgICAgICAvLyBjYWxscyB0byAkcG9zdERpZ2VzdCBjYWxscyB3ZSBjYW4gZW5zdXJlIHRoYXQgdGhlIGZsYWcgaXMgZW5hYmxlZCBhdCB0aGVcclxuICAgICAgICAgIC8vIHZlcnkgZW5kIG9mIHRoZSBwb3N0IGRpZ2VzdCBxdWV1ZS4gU2luY2UgYWxsIG9mIHRoZSBhbmltYXRpb25zIGluICRhbmltYXRlXHJcbiAgICAgICAgICAvLyB1c2UgJHBvc3REaWdlc3QsIGl0J3MgaW1wb3J0YW50IHRoYXQgdGhlIGNvZGUgYmVsb3cgZXhlY3V0ZXMgYXQgdGhlIGVuZC5cclxuICAgICAgICAgIC8vIFRoaXMgYmFzaWNhbGx5IG1lYW5zIHRoYXQgdGhlIHBhZ2UgaXMgZnVsbHkgZG93bmxvYWRlZCBhbmQgY29tcGlsZWQgYmVmb3JlXHJcbiAgICAgICAgICAvLyBhbnkgYW5pbWF0aW9ucyBhcmUgdHJpZ2dlcmVkLlxyXG4gICAgICAgICAgJHJvb3RTY29wZS4kJHBvc3REaWdlc3QoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuJCRwb3N0RGlnZXN0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIHJvb3RBbmltYXRlU3RhdGUucnVubmluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgKTtcclxuXHJcbiAgICAgIHZhciBnbG9iYWxBbmltYXRpb25Db3VudGVyID0gMDtcclxuICAgICAgdmFyIGNsYXNzTmFtZUZpbHRlciA9ICRhbmltYXRlUHJvdmlkZXIuY2xhc3NOYW1lRmlsdGVyKCk7XHJcbiAgICAgIHZhciBpc0FuaW1hdGFibGVDbGFzc05hbWUgPSAhY2xhc3NOYW1lRmlsdGVyXHJcbiAgICAgICAgICAgICAgPyBmdW5jdGlvbigpIHsgcmV0dXJuIHRydWU7IH1cclxuICAgICAgICAgICAgICA6IGZ1bmN0aW9uKGNsYXNzTmFtZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNsYXNzTmFtZUZpbHRlci50ZXN0KGNsYXNzTmFtZSk7XHJcbiAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgIGZ1bmN0aW9uIGNsYXNzQmFzZWRBbmltYXRpb25zQmxvY2tlZChlbGVtZW50LCBzZXR0ZXIpIHtcclxuICAgICAgICB2YXIgZGF0YSA9IGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFKSB8fCB7fTtcclxuICAgICAgICBpZiAoc2V0dGVyKSB7XHJcbiAgICAgICAgICBkYXRhLnJ1bm5pbmcgPSB0cnVlO1xyXG4gICAgICAgICAgZGF0YS5zdHJ1Y3R1cmFsID0gdHJ1ZTtcclxuICAgICAgICAgIGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFLCBkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRhdGEuZGlzYWJsZWQgfHwgKGRhdGEucnVubmluZyAmJiBkYXRhLnN0cnVjdHVyYWwpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBydW5BbmltYXRpb25Qb3N0RGlnZXN0KGZuKSB7XHJcbiAgICAgICAgdmFyIGNhbmNlbEZuLCBkZWZlciA9ICQkcS5kZWZlcigpO1xyXG4gICAgICAgIGRlZmVyLnByb21pc2UuJCRjYW5jZWxGbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgY2FuY2VsRm4gJiYgY2FuY2VsRm4oKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRyb290U2NvcGUuJCRwb3N0RGlnZXN0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgY2FuY2VsRm4gPSBmbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgZGVmZXIucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIHBhcnNlQW5pbWF0ZU9wdGlvbnMob3B0aW9ucykge1xyXG4gICAgICAgIC8vIHNvbWUgcGx1Z2luIGNvZGUgbWF5IHN0aWxsIGJlIHBhc3NpbmcgaW4gdGhlIGNhbGxiYWNrXHJcbiAgICAgICAgLy8gZnVuY3Rpb24gYXMgdGhlIGxhc3QgcGFyYW0gZm9yIHRoZSAkYW5pbWF0ZSBtZXRob2RzIHNvXHJcbiAgICAgICAgLy8gaXQncyBiZXN0IHRvIG9ubHkgYWxsb3cgc3RyaW5nIG9yIGFycmF5IHZhbHVlcyBmb3Igbm93XHJcbiAgICAgICAgaWYgKGlzT2JqZWN0KG9wdGlvbnMpKSB7XHJcbiAgICAgICAgICBpZiAob3B0aW9ucy50ZW1wQ2xhc3NlcyAmJiBpc1N0cmluZyhvcHRpb25zLnRlbXBDbGFzc2VzKSkge1xyXG4gICAgICAgICAgICBvcHRpb25zLnRlbXBDbGFzc2VzID0gb3B0aW9ucy50ZW1wQ2xhc3Nlcy5zcGxpdCgvXFxzKy8pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIG9wdGlvbnM7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiByZXNvbHZlRWxlbWVudENsYXNzZXMoZWxlbWVudCwgY2FjaGUsIHJ1bm5pbmdBbmltYXRpb25zKSB7XHJcbiAgICAgICAgcnVubmluZ0FuaW1hdGlvbnMgPSBydW5uaW5nQW5pbWF0aW9ucyB8fCB7fTtcclxuXHJcbiAgICAgICAgdmFyIGxvb2t1cCA9IHt9O1xyXG4gICAgICAgIGZvckVhY2gocnVubmluZ0FuaW1hdGlvbnMsIGZ1bmN0aW9uKGRhdGEsIHNlbGVjdG9yKSB7XHJcbiAgICAgICAgICBmb3JFYWNoKHNlbGVjdG9yLnNwbGl0KCcgJyksIGZ1bmN0aW9uKHMpIHtcclxuICAgICAgICAgICAgbG9va3VwW3NdPWRhdGE7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdmFyIGhhc0NsYXNzZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG4gICAgICAgIGZvckVhY2goKGVsZW1lbnQuYXR0cignY2xhc3MnKSB8fCAnJykuc3BsaXQoL1xccysvKSwgZnVuY3Rpb24oY2xhc3NOYW1lKSB7XHJcbiAgICAgICAgICBoYXNDbGFzc2VzW2NsYXNzTmFtZV0gPSB0cnVlO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB2YXIgdG9BZGQgPSBbXSwgdG9SZW1vdmUgPSBbXTtcclxuICAgICAgICBmb3JFYWNoKChjYWNoZSAmJiBjYWNoZS5jbGFzc2VzKSB8fCBbXSwgZnVuY3Rpb24oc3RhdHVzLCBjbGFzc05hbWUpIHtcclxuICAgICAgICAgIHZhciBoYXNDbGFzcyA9IGhhc0NsYXNzZXNbY2xhc3NOYW1lXTtcclxuICAgICAgICAgIHZhciBtYXRjaGluZ0FuaW1hdGlvbiA9IGxvb2t1cFtjbGFzc05hbWVdIHx8IHt9O1xyXG5cclxuICAgICAgICAgIC8vIFdoZW4gYWRkQ2xhc3MgYW5kIHJlbW92ZUNsYXNzIGlzIGNhbGxlZCB0aGVuICRhbmltYXRlIHdpbGwgY2hlY2sgdG9cclxuICAgICAgICAgIC8vIHNlZSBpZiBhZGRDbGFzcyBhbmQgcmVtb3ZlQ2xhc3MgY2FuY2VsIGVhY2ggb3RoZXIgb3V0LiBXaGVuIHRoZXJlIGFyZVxyXG4gICAgICAgICAgLy8gbW9yZSBjYWxscyB0byByZW1vdmVDbGFzcyB0aGFuIGFkZENsYXNzIHRoZW4gdGhlIGNvdW50IGZhbGxzIGJlbG93IDBcclxuICAgICAgICAgIC8vIGFuZCB0aGVuIHRoZSByZW1vdmVDbGFzcyBhbmltYXRpb24gd2lsbCBiZSBhbGxvd2VkLiBPdGhlcndpc2UgaWYgdGhlXHJcbiAgICAgICAgICAvLyBjb3VudCBpcyBhYm92ZSAwIHRoZW4gdGhhdCBtZWFucyBhbiBhZGRDbGFzcyBhbmltYXRpb24gd2lsbCBjb21tZW5jZS5cclxuICAgICAgICAgIC8vIE9uY2UgYW4gYW5pbWF0aW9uIGlzIGFsbG93ZWQgdGhlbiB0aGUgY29kZSB3aWxsIGFsc28gY2hlY2sgdG8gc2VlIGlmXHJcbiAgICAgICAgICAvLyB0aGVyZSBleGlzdHMgYW55IG9uLWdvaW5nIGFuaW1hdGlvbiB0aGF0IGlzIGFscmVhZHkgYWRkaW5nIG9yIHJlbXZvaW5nXHJcbiAgICAgICAgICAvLyB0aGUgbWF0Y2hpbmcgQ1NTIGNsYXNzLlxyXG4gICAgICAgICAgaWYgKHN0YXR1cyA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgLy9kb2VzIGl0IGhhdmUgdGhlIGNsYXNzIG9yIHdpbGwgaXQgaGF2ZSB0aGUgY2xhc3NcclxuICAgICAgICAgICAgaWYgKGhhc0NsYXNzIHx8IG1hdGNoaW5nQW5pbWF0aW9uLmV2ZW50ID09ICdhZGRDbGFzcycpIHtcclxuICAgICAgICAgICAgICB0b1JlbW92ZS5wdXNoKGNsYXNzTmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdHVzID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgIC8vaXMgdGhlIGNsYXNzIG1pc3Npbmcgb3Igd2lsbCBpdCBiZSByZW1vdmVkP1xyXG4gICAgICAgICAgICBpZiAoIWhhc0NsYXNzIHx8IG1hdGNoaW5nQW5pbWF0aW9uLmV2ZW50ID09ICdyZW1vdmVDbGFzcycpIHtcclxuICAgICAgICAgICAgICB0b0FkZC5wdXNoKGNsYXNzTmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuICh0b0FkZC5sZW5ndGggKyB0b1JlbW92ZS5sZW5ndGgpID4gMCAmJiBbdG9BZGQuam9pbignICcpLCB0b1JlbW92ZS5qb2luKCcgJyldO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBsb29rdXAobmFtZSkge1xyXG4gICAgICAgIGlmIChuYW1lKSB7XHJcbiAgICAgICAgICB2YXIgbWF0Y2hlcyA9IFtdLFxyXG4gICAgICAgICAgICAgIGZsYWdNYXAgPSB7fSxcclxuICAgICAgICAgICAgICBjbGFzc2VzID0gbmFtZS5zdWJzdHIoMSkuc3BsaXQoJy4nKTtcclxuXHJcbiAgICAgICAgICAvL3RoZSBlbXB0eSBzdHJpbmcgdmFsdWUgaXMgdGhlIGRlZmF1bHQgYW5pbWF0aW9uXHJcbiAgICAgICAgICAvL29wZXJhdGlvbiB3aGljaCBwZXJmb3JtcyBDU1MgdHJhbnNpdGlvbiBhbmQga2V5ZnJhbWVcclxuICAgICAgICAgIC8vYW5pbWF0aW9ucyBzbmlmZmluZy4gVGhpcyBpcyBhbHdheXMgaW5jbHVkZWQgZm9yIGVhY2hcclxuICAgICAgICAgIC8vZWxlbWVudCBhbmltYXRpb24gcHJvY2VkdXJlIGlmIHRoZSBicm93c2VyIHN1cHBvcnRzXHJcbiAgICAgICAgICAvL3RyYW5zaXRpb25zIGFuZC9vciBrZXlmcmFtZSBhbmltYXRpb25zLiBUaGUgZGVmYXVsdFxyXG4gICAgICAgICAgLy9hbmltYXRpb24gaXMgYWRkZWQgdG8gdGhlIHRvcCBvZiB0aGUgbGlzdCB0byBwcmV2ZW50XHJcbiAgICAgICAgICAvL2FueSBwcmV2aW91cyBhbmltYXRpb25zIGZyb20gYWZmZWN0aW5nIHRoZSBlbGVtZW50IHN0eWxpbmdcclxuICAgICAgICAgIC8vcHJpb3IgdG8gdGhlIGVsZW1lbnQgYmVpbmcgYW5pbWF0ZWQuXHJcbiAgICAgICAgICBpZiAoJHNuaWZmZXIudHJhbnNpdGlvbnMgfHwgJHNuaWZmZXIuYW5pbWF0aW9ucykge1xyXG4gICAgICAgICAgICBtYXRjaGVzLnB1c2goJGluamVjdG9yLmdldChzZWxlY3RvcnNbJyddKSk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgZm9yICh2YXIgaT0wOyBpIDwgY2xhc3Nlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIga2xhc3MgPSBjbGFzc2VzW2ldLFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0b3JGYWN0b3J5TmFtZSA9IHNlbGVjdG9yc1trbGFzc107XHJcbiAgICAgICAgICAgIGlmIChzZWxlY3RvckZhY3RvcnlOYW1lICYmICFmbGFnTWFwW2tsYXNzXSkge1xyXG4gICAgICAgICAgICAgIG1hdGNoZXMucHVzaCgkaW5qZWN0b3IuZ2V0KHNlbGVjdG9yRmFjdG9yeU5hbWUpKTtcclxuICAgICAgICAgICAgICBmbGFnTWFwW2tsYXNzXSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiBtYXRjaGVzO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gYW5pbWF0aW9uUnVubmVyKGVsZW1lbnQsIGFuaW1hdGlvbkV2ZW50LCBjbGFzc05hbWUsIG9wdGlvbnMpIHtcclxuICAgICAgICAvL3RyYW5zY2x1ZGVkIGRpcmVjdGl2ZXMgbWF5IHNvbWV0aW1lcyBmaXJlIGFuIGFuaW1hdGlvbiB1c2luZyBvbmx5IGNvbW1lbnQgbm9kZXNcclxuICAgICAgICAvL2Jlc3QgdG8gY2F0Y2ggdGhpcyBlYXJseSBvbiB0byBwcmV2ZW50IGFueSBhbmltYXRpb24gb3BlcmF0aW9ucyBmcm9tIG9jY3VycmluZ1xyXG4gICAgICAgIHZhciBub2RlID0gZWxlbWVudFswXTtcclxuICAgICAgICBpZiAoIW5vZGUpIHtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChvcHRpb25zKSB7XHJcbiAgICAgICAgICBvcHRpb25zLnRvID0gb3B0aW9ucy50byB8fCB7fTtcclxuICAgICAgICAgIG9wdGlvbnMuZnJvbSA9IG9wdGlvbnMuZnJvbSB8fCB7fTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBjbGFzc05hbWVBZGQ7XHJcbiAgICAgICAgdmFyIGNsYXNzTmFtZVJlbW92ZTtcclxuICAgICAgICBpZiAoaXNBcnJheShjbGFzc05hbWUpKSB7XHJcbiAgICAgICAgICBjbGFzc05hbWVBZGQgPSBjbGFzc05hbWVbMF07XHJcbiAgICAgICAgICBjbGFzc05hbWVSZW1vdmUgPSBjbGFzc05hbWVbMV07XHJcbiAgICAgICAgICBpZiAoIWNsYXNzTmFtZUFkZCkge1xyXG4gICAgICAgICAgICBjbGFzc05hbWUgPSBjbGFzc05hbWVSZW1vdmU7XHJcbiAgICAgICAgICAgIGFuaW1hdGlvbkV2ZW50ID0gJ3JlbW92ZUNsYXNzJztcclxuICAgICAgICAgIH0gZWxzZSBpZiAoIWNsYXNzTmFtZVJlbW92ZSkge1xyXG4gICAgICAgICAgICBjbGFzc05hbWUgPSBjbGFzc05hbWVBZGQ7XHJcbiAgICAgICAgICAgIGFuaW1hdGlvbkV2ZW50ID0gJ2FkZENsYXNzJztcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNsYXNzTmFtZSA9IGNsYXNzTmFtZUFkZCArICcgJyArIGNsYXNzTmFtZVJlbW92ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBpc1NldENsYXNzT3BlcmF0aW9uID0gYW5pbWF0aW9uRXZlbnQgPT0gJ3NldENsYXNzJztcclxuICAgICAgICB2YXIgaXNDbGFzc0Jhc2VkID0gaXNTZXRDbGFzc09wZXJhdGlvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBhbmltYXRpb25FdmVudCA9PSAnYWRkQ2xhc3MnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8IGFuaW1hdGlvbkV2ZW50ID09ICdyZW1vdmVDbGFzcydcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgYW5pbWF0aW9uRXZlbnQgPT0gJ2FuaW1hdGUnO1xyXG5cclxuICAgICAgICB2YXIgY3VycmVudENsYXNzTmFtZSA9IGVsZW1lbnQuYXR0cignY2xhc3MnKTtcclxuICAgICAgICB2YXIgY2xhc3NlcyA9IGN1cnJlbnRDbGFzc05hbWUgKyAnICcgKyBjbGFzc05hbWU7XHJcbiAgICAgICAgaWYgKCFpc0FuaW1hdGFibGVDbGFzc05hbWUoY2xhc3NlcykpIHtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBiZWZvcmVDb21wbGV0ZSA9IG5vb3AsXHJcbiAgICAgICAgICAgIGJlZm9yZUNhbmNlbCA9IFtdLFxyXG4gICAgICAgICAgICBiZWZvcmUgPSBbXSxcclxuICAgICAgICAgICAgYWZ0ZXJDb21wbGV0ZSA9IG5vb3AsXHJcbiAgICAgICAgICAgIGFmdGVyQ2FuY2VsID0gW10sXHJcbiAgICAgICAgICAgIGFmdGVyID0gW107XHJcblxyXG4gICAgICAgIHZhciBhbmltYXRpb25Mb29rdXAgPSAoJyAnICsgY2xhc3NlcykucmVwbGFjZSgvXFxzKy9nLCcuJyk7XHJcbiAgICAgICAgZm9yRWFjaChsb29rdXAoYW5pbWF0aW9uTG9va3VwKSwgZnVuY3Rpb24oYW5pbWF0aW9uRmFjdG9yeSkge1xyXG4gICAgICAgICAgdmFyIGNyZWF0ZWQgPSByZWdpc3RlckFuaW1hdGlvbihhbmltYXRpb25GYWN0b3J5LCBhbmltYXRpb25FdmVudCk7XHJcbiAgICAgICAgICBpZiAoIWNyZWF0ZWQgJiYgaXNTZXRDbGFzc09wZXJhdGlvbikge1xyXG4gICAgICAgICAgICByZWdpc3RlckFuaW1hdGlvbihhbmltYXRpb25GYWN0b3J5LCAnYWRkQ2xhc3MnKTtcclxuICAgICAgICAgICAgcmVnaXN0ZXJBbmltYXRpb24oYW5pbWF0aW9uRmFjdG9yeSwgJ3JlbW92ZUNsYXNzJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHJlZ2lzdGVyQW5pbWF0aW9uKGFuaW1hdGlvbkZhY3RvcnksIGV2ZW50KSB7XHJcbiAgICAgICAgICB2YXIgYWZ0ZXJGbiA9IGFuaW1hdGlvbkZhY3RvcnlbZXZlbnRdO1xyXG4gICAgICAgICAgdmFyIGJlZm9yZUZuID0gYW5pbWF0aW9uRmFjdG9yeVsnYmVmb3JlJyArIGV2ZW50LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgZXZlbnQuc3Vic3RyKDEpXTtcclxuICAgICAgICAgIGlmIChhZnRlckZuIHx8IGJlZm9yZUZuKSB7XHJcbiAgICAgICAgICAgIGlmIChldmVudCA9PSAnbGVhdmUnKSB7XHJcbiAgICAgICAgICAgICAgYmVmb3JlRm4gPSBhZnRlckZuO1xyXG4gICAgICAgICAgICAgIC8vd2hlbiBzZXQgYXMgbnVsbCB0aGVuIGFuaW1hdGlvbiBrbm93cyB0byBza2lwIHRoaXMgcGhhc2VcclxuICAgICAgICAgICAgICBhZnRlckZuID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBhZnRlci5wdXNoKHtcclxuICAgICAgICAgICAgICBldmVudDogZXZlbnQsIGZuOiBhZnRlckZuXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBiZWZvcmUucHVzaCh7XHJcbiAgICAgICAgICAgICAgZXZlbnQ6IGV2ZW50LCBmbjogYmVmb3JlRm5cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcnVuKGZucywgY2FuY2VsbGF0aW9ucywgYWxsQ29tcGxldGVGbikge1xyXG4gICAgICAgICAgdmFyIGFuaW1hdGlvbnMgPSBbXTtcclxuICAgICAgICAgIGZvckVhY2goZm5zLCBmdW5jdGlvbihhbmltYXRpb24pIHtcclxuICAgICAgICAgICAgYW5pbWF0aW9uLmZuICYmIGFuaW1hdGlvbnMucHVzaChhbmltYXRpb24pO1xyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgdmFyIGNvdW50ID0gMDtcclxuICAgICAgICAgIGZ1bmN0aW9uIGFmdGVyQW5pbWF0aW9uQ29tcGxldGUoaW5kZXgpIHtcclxuICAgICAgICAgICAgaWYgKGNhbmNlbGxhdGlvbnMpIHtcclxuICAgICAgICAgICAgICAoY2FuY2VsbGF0aW9uc1tpbmRleF0gfHwgbm9vcCkoKTtcclxuICAgICAgICAgICAgICBpZiAoKytjb3VudCA8IGFuaW1hdGlvbnMubGVuZ3RoKSByZXR1cm47XHJcbiAgICAgICAgICAgICAgY2FuY2VsbGF0aW9ucyA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYWxsQ29tcGxldGVGbigpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC8vVGhlIGNvZGUgYmVsb3cgYWRkcyBkaXJlY3RseSB0byB0aGUgYXJyYXkgaW4gb3JkZXIgdG8gd29yayB3aXRoXHJcbiAgICAgICAgICAvL2JvdGggc3luYyBhbmQgYXN5bmMgYW5pbWF0aW9ucy4gU3luYyBhbmltYXRpb25zIGFyZSB3aGVuIHRoZSBkb25lKClcclxuICAgICAgICAgIC8vb3BlcmF0aW9uIGlzIGNhbGxlZCByaWdodCBhd2F5LiBETyBOT1QgUkVGQUNUT1IhXHJcbiAgICAgICAgICBmb3JFYWNoKGFuaW1hdGlvbnMsIGZ1bmN0aW9uKGFuaW1hdGlvbiwgaW5kZXgpIHtcclxuICAgICAgICAgICAgdmFyIHByb2dyZXNzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgYWZ0ZXJBbmltYXRpb25Db21wbGV0ZShpbmRleCk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHN3aXRjaCAoYW5pbWF0aW9uLmV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgY2FzZSAnc2V0Q2xhc3MnOlxyXG4gICAgICAgICAgICAgICAgY2FuY2VsbGF0aW9ucy5wdXNoKGFuaW1hdGlvbi5mbihlbGVtZW50LCBjbGFzc05hbWVBZGQsIGNsYXNzTmFtZVJlbW92ZSwgcHJvZ3Jlc3MsIG9wdGlvbnMpKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgIGNhc2UgJ2FuaW1hdGUnOlxyXG4gICAgICAgICAgICAgICAgY2FuY2VsbGF0aW9ucy5wdXNoKGFuaW1hdGlvbi5mbihlbGVtZW50LCBjbGFzc05hbWUsIG9wdGlvbnMuZnJvbSwgb3B0aW9ucy50bywgcHJvZ3Jlc3MpKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgIGNhc2UgJ2FkZENsYXNzJzpcclxuICAgICAgICAgICAgICAgIGNhbmNlbGxhdGlvbnMucHVzaChhbmltYXRpb24uZm4oZWxlbWVudCwgY2xhc3NOYW1lQWRkIHx8IGNsYXNzTmFtZSwgICAgIHByb2dyZXNzLCBvcHRpb25zKSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICBjYXNlICdyZW1vdmVDbGFzcyc6XHJcbiAgICAgICAgICAgICAgICBjYW5jZWxsYXRpb25zLnB1c2goYW5pbWF0aW9uLmZuKGVsZW1lbnQsIGNsYXNzTmFtZVJlbW92ZSB8fCBjbGFzc05hbWUsICBwcm9ncmVzcywgb3B0aW9ucykpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIGNhbmNlbGxhdGlvbnMucHVzaChhbmltYXRpb24uZm4oZWxlbWVudCwgcHJvZ3Jlc3MsIG9wdGlvbnMpKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICBpZiAoY2FuY2VsbGF0aW9ucyAmJiBjYW5jZWxsYXRpb25zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICBhbGxDb21wbGV0ZUZuKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgbm9kZTogbm9kZSxcclxuICAgICAgICAgIGV2ZW50OiBhbmltYXRpb25FdmVudCxcclxuICAgICAgICAgIGNsYXNzTmFtZTogY2xhc3NOYW1lLFxyXG4gICAgICAgICAgaXNDbGFzc0Jhc2VkOiBpc0NsYXNzQmFzZWQsXHJcbiAgICAgICAgICBpc1NldENsYXNzT3BlcmF0aW9uOiBpc1NldENsYXNzT3BlcmF0aW9uLFxyXG4gICAgICAgICAgYXBwbHlTdHlsZXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAob3B0aW9ucykge1xyXG4gICAgICAgICAgICAgIGVsZW1lbnQuY3NzKGFuZ3VsYXIuZXh0ZW5kKG9wdGlvbnMuZnJvbSB8fCB7fSwgb3B0aW9ucy50byB8fCB7fSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgYmVmb3JlOiBmdW5jdGlvbihhbGxDb21wbGV0ZUZuKSB7XHJcbiAgICAgICAgICAgIGJlZm9yZUNvbXBsZXRlID0gYWxsQ29tcGxldGVGbjtcclxuICAgICAgICAgICAgcnVuKGJlZm9yZSwgYmVmb3JlQ2FuY2VsLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICBiZWZvcmVDb21wbGV0ZSA9IG5vb3A7XHJcbiAgICAgICAgICAgICAgYWxsQ29tcGxldGVGbigpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBhZnRlcjogZnVuY3Rpb24oYWxsQ29tcGxldGVGbikge1xyXG4gICAgICAgICAgICBhZnRlckNvbXBsZXRlID0gYWxsQ29tcGxldGVGbjtcclxuICAgICAgICAgICAgcnVuKGFmdGVyLCBhZnRlckNhbmNlbCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgYWZ0ZXJDb21wbGV0ZSA9IG5vb3A7XHJcbiAgICAgICAgICAgICAgYWxsQ29tcGxldGVGbigpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBjYW5jZWw6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoYmVmb3JlQ2FuY2VsKSB7XHJcbiAgICAgICAgICAgICAgZm9yRWFjaChiZWZvcmVDYW5jZWwsIGZ1bmN0aW9uKGNhbmNlbEZuKSB7XHJcbiAgICAgICAgICAgICAgICAoY2FuY2VsRm4gfHwgbm9vcCkodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgYmVmb3JlQ29tcGxldGUodHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGFmdGVyQ2FuY2VsKSB7XHJcbiAgICAgICAgICAgICAgZm9yRWFjaChhZnRlckNhbmNlbCwgZnVuY3Rpb24oY2FuY2VsRm4pIHtcclxuICAgICAgICAgICAgICAgIChjYW5jZWxGbiB8fCBub29wKSh0cnVlKTtcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICBhZnRlckNvbXBsZXRlKHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLyoqXHJcbiAgICAgICAqIEBuZ2RvYyBzZXJ2aWNlXHJcbiAgICAgICAqIEBuYW1lICRhbmltYXRlXHJcbiAgICAgICAqIEBraW5kIG9iamVjdFxyXG4gICAgICAgKlxyXG4gICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICogVGhlIGAkYW5pbWF0ZWAgc2VydmljZSBwcm92aWRlcyBhbmltYXRpb24gZGV0ZWN0aW9uIHN1cHBvcnQgd2hpbGUgcGVyZm9ybWluZyBET00gb3BlcmF0aW9ucyAoZW50ZXIsIGxlYXZlIGFuZCBtb3ZlKSBhcyB3ZWxsIGFzIGR1cmluZyBhZGRDbGFzcyBhbmQgcmVtb3ZlQ2xhc3Mgb3BlcmF0aW9ucy5cclxuICAgICAgICogV2hlbiBhbnkgb2YgdGhlc2Ugb3BlcmF0aW9ucyBhcmUgcnVuLCB0aGUgJGFuaW1hdGUgc2VydmljZVxyXG4gICAgICAgKiB3aWxsIGV4YW1pbmUgYW55IEphdmFTY3JpcHQtZGVmaW5lZCBhbmltYXRpb25zICh3aGljaCBhcmUgZGVmaW5lZCBieSB1c2luZyB0aGUgJGFuaW1hdGVQcm92aWRlciBwcm92aWRlciBvYmplY3QpXHJcbiAgICAgICAqIGFzIHdlbGwgYXMgYW55IENTUy1kZWZpbmVkIGFuaW1hdGlvbnMgYWdhaW5zdCB0aGUgQ1NTIGNsYXNzZXMgcHJlc2VudCBvbiB0aGUgZWxlbWVudCBvbmNlIHRoZSBET00gb3BlcmF0aW9uIGlzIHJ1bi5cclxuICAgICAgICpcclxuICAgICAgICogVGhlIGAkYW5pbWF0ZWAgc2VydmljZSBpcyB1c2VkIGJlaGluZCB0aGUgc2NlbmVzIHdpdGggcHJlLWV4aXN0aW5nIGRpcmVjdGl2ZXMgYW5kIGFuaW1hdGlvbiB3aXRoIHRoZXNlIGRpcmVjdGl2ZXNcclxuICAgICAgICogd2lsbCB3b3JrIG91dCBvZiB0aGUgYm94IHdpdGhvdXQgYW55IGV4dHJhIGNvbmZpZ3VyYXRpb24uXHJcbiAgICAgICAqXHJcbiAgICAgICAqIFJlcXVpcmVzIHRoZSB7QGxpbmsgbmdBbmltYXRlIGBuZ0FuaW1hdGVgfSBtb2R1bGUgdG8gYmUgaW5zdGFsbGVkLlxyXG4gICAgICAgKlxyXG4gICAgICAgKiBQbGVhc2UgdmlzaXQgdGhlIHtAbGluayBuZ0FuaW1hdGUgYG5nQW5pbWF0ZWB9IG1vZHVsZSBvdmVydmlldyBwYWdlIGxlYXJuIG1vcmUgYWJvdXQgaG93IHRvIHVzZSBhbmltYXRpb25zIGluIHlvdXIgYXBwbGljYXRpb24uXHJcbiAgICAgICAqICMjIENhbGxiYWNrIFByb21pc2VzXHJcbiAgICAgICAqIFdpdGggQW5ndWxhckpTIDEuMywgZWFjaCBvZiB0aGUgYW5pbWF0aW9uIG1ldGhvZHMsIG9uIHRoZSBgJGFuaW1hdGVgIHNlcnZpY2UsIHJldHVybiBhIHByb21pc2Ugd2hlbiBjYWxsZWQuIFRoZVxyXG4gICAgICAgKiBwcm9taXNlIGl0c2VsZiBpcyB0aGVuIHJlc29sdmVkIG9uY2UgdGhlIGFuaW1hdGlvbiBoYXMgY29tcGxldGVkIGl0c2VsZiwgaGFzIGJlZW4gY2FuY2VsbGVkIG9yIGhhcyBiZWVuXHJcbiAgICAgICAqIHNraXBwZWQgZHVlIHRvIGFuaW1hdGlvbnMgYmVpbmcgZGlzYWJsZWQuIChOb3RlIHRoYXQgZXZlbiBpZiB0aGUgYW5pbWF0aW9uIGlzIGNhbmNlbGxlZCBpdCB3aWxsIHN0aWxsXHJcbiAgICAgICAqIGNhbGwgdGhlIHJlc29sdmUgZnVuY3Rpb24gb2YgdGhlIGFuaW1hdGlvbi4pXHJcbiAgICAgICAqXHJcbiAgICAgICAqIGBgYGpzXHJcbiAgICAgICAqICRhbmltYXRlLmVudGVyKGVsZW1lbnQsIGNvbnRhaW5lcikudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICogICAvLy4uLnRoaXMgaXMgY2FsbGVkIG9uY2UgdGhlIGFuaW1hdGlvbiBpcyBjb21wbGV0ZS4uLlxyXG4gICAgICAgKiB9KTtcclxuICAgICAgICogYGBgXHJcbiAgICAgICAqXHJcbiAgICAgICAqIEFsc28gbm90ZSB0aGF0LCBkdWUgdG8gdGhlIG5hdHVyZSBvZiB0aGUgY2FsbGJhY2sgcHJvbWlzZSwgaWYgYW55IEFuZ3VsYXItc3BlY2lmaWMgY29kZSAobGlrZSBjaGFuZ2luZyB0aGUgc2NvcGUsXHJcbiAgICAgICAqIGxvY2F0aW9uIG9mIHRoZSBwYWdlLCBldGMuLi4pIGlzIGV4ZWN1dGVkIHdpdGhpbiB0aGUgY2FsbGJhY2sgcHJvbWlzZSB0aGVuIGJlIHN1cmUgdG8gd3JhcCB0aGUgY29kZSB1c2luZ1xyXG4gICAgICAgKiBgJHNjb3BlLiRhcHBseSguLi4pYDtcclxuICAgICAgICpcclxuICAgICAgICogYGBganNcclxuICAgICAgICogJGFuaW1hdGUubGVhdmUoZWxlbWVudCkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICogICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgKiAgICAgJGxvY2F0aW9uLnBhdGgoJy9uZXctcGFnZScpO1xyXG4gICAgICAgKiAgIH0pO1xyXG4gICAgICAgKiB9KTtcclxuICAgICAgICogYGBgXHJcbiAgICAgICAqXHJcbiAgICAgICAqIEFuIGFuaW1hdGlvbiBjYW4gYWxzbyBiZSBjYW5jZWxsZWQgYnkgY2FsbGluZyB0aGUgYCRhbmltYXRlLmNhbmNlbChwcm9taXNlKWAgbWV0aG9kIHdpdGggdGhlIHByb3ZpZGVkXHJcbiAgICAgICAqIHByb21pc2UgdGhhdCB3YXMgcmV0dXJuZWQgd2hlbiB0aGUgYW5pbWF0aW9uIHdhcyBzdGFydGVkLlxyXG4gICAgICAgKlxyXG4gICAgICAgKiBgYGBqc1xyXG4gICAgICAgKiB2YXIgcHJvbWlzZSA9ICRhbmltYXRlLmFkZENsYXNzKGVsZW1lbnQsICdzdXBlci1sb25nLWFuaW1hdGlvbicpO1xyXG4gICAgICAgKiBwcm9taXNlLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAqICAgLy90aGlzIHdpbGwgc3RpbGwgYmUgY2FsbGVkIGV2ZW4gaWYgY2FuY2VsbGVkXHJcbiAgICAgICAqIH0pO1xyXG4gICAgICAgKlxyXG4gICAgICAgKiBlbGVtZW50Lm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgKiAgIC8vdG9vbyBsYXp5IHRvIHdhaXQgZm9yIHRoZSBhbmltYXRpb24gdG8gZW5kXHJcbiAgICAgICAqICAgJGFuaW1hdGUuY2FuY2VsKHByb21pc2UpO1xyXG4gICAgICAgKiB9KTtcclxuICAgICAgICogYGBgXHJcbiAgICAgICAqXHJcbiAgICAgICAqIChLZWVwIGluIG1pbmQgdGhhdCB0aGUgcHJvbWlzZSBjYW5jZWxsYXRpb24gaXMgdW5pcXVlIHRvIGAkYW5pbWF0ZWAgc2luY2UgcHJvbWlzZXMgaW5cclxuICAgICAgICogZ2VuZXJhbCBjYW5ub3QgYmUgY2FuY2VsbGVkLilcclxuICAgICAgICpcclxuICAgICAgICovXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgICAgICAqIEBuYW1lICRhbmltYXRlI2FuaW1hdGVcclxuICAgICAgICAgKiBAa2luZCBmdW5jdGlvblxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uXHJcbiAgICAgICAgICogUGVyZm9ybXMgYW4gaW5saW5lIGFuaW1hdGlvbiBvbiB0aGUgZWxlbWVudCB3aGljaCBhcHBsaWVzIHRoZSBwcm92aWRlZCBgdG9gIGFuZCBgZnJvbWAgQ1NTIHN0eWxlcyB0byB0aGUgZWxlbWVudC5cclxuICAgICAgICAgKiBJZiBhbnkgZGV0ZWN0ZWQgQ1NTIHRyYW5zaXRpb24sIGtleWZyYW1lIG9yIEphdmFTY3JpcHQgbWF0Y2hlcyB0aGUgcHJvdmlkZWQgYGNsYXNzTmFtZWAgdmFsdWUgdGhlbiB0aGUgYW5pbWF0aW9uXHJcbiAgICAgICAgICogd2lsbCB0YWtlIG9uIHRoZSBwcm92aWRlZCBzdHlsZXMuIEZvciBleGFtcGxlLCBpZiBhIHRyYW5zaXRpb24gYW5pbWF0aW9uIGlzIHNldCBmb3IgdGhlIGdpdmVuIGNsYXNzTmFtZSB0aGVuIHRoZVxyXG4gICAgICAgICAqIHByb3ZpZGVkIGBmcm9tYCBhbmQgYHRvYCBzdHlsZXMgd2lsbCBiZSBhcHBsaWVkIGFsb25nc2lkZSB0aGUgZ2l2ZW4gdHJhbnNpdGlvbi4gSWYgYSBKYXZhU2NyaXB0IGFuaW1hdGlvbiBpc1xyXG4gICAgICAgICAqIGRldGVjdGVkIHRoZW4gdGhlIHByb3ZpZGVkIHN0eWxlcyB3aWxsIGJlIGdpdmVuIGluIGFzIGZ1bmN0aW9uIHBhcmFtdGVycy5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIGBgYGpzXHJcbiAgICAgICAgICogbmdNb2R1bGUuYW5pbWF0aW9uKCcubXktaW5saW5lLWFuaW1hdGlvbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAqICAgcmV0dXJuIHtcclxuICAgICAgICAgKiAgICAgYW5pbWF0ZSA6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgZnJvbSwgdG8sIGRvbmUpIHtcclxuICAgICAgICAgKiAgICAgICAvL3N0eWxlc1xyXG4gICAgICAgICAqICAgICB9XHJcbiAgICAgICAgICogICB9XHJcbiAgICAgICAgICogfSk7XHJcbiAgICAgICAgICogYGBgXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBCZWxvdyBpcyBhIGJyZWFrZG93biBvZiBlYWNoIHN0ZXAgdGhhdCBvY2N1cnMgZHVyaW5nIHRoZSBgYW5pbWF0ZWAgYW5pbWF0aW9uOlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogfCBBbmltYXRpb24gU3RlcCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBXaGF0IHRoZSBlbGVtZW50IGNsYXNzIGF0dHJpYnV0ZSBsb29rcyBsaWtlICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcclxuICAgICAgICAgKiB8IDEuIGAkYW5pbWF0ZS5hbmltYXRlKC4uLilgIGlzIGNhbGxlZCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDIuIGAkYW5pbWF0ZWAgd2FpdHMgZm9yIHRoZSBuZXh0IGRpZ2VzdCB0byBzdGFydCB0aGUgYW5pbWF0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDMuIGAkYW5pbWF0ZWAgcnVucyB0aGUgSmF2YVNjcmlwdC1kZWZpbmVkIGFuaW1hdGlvbnMgZGV0ZWN0ZWQgb24gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDQuIHRoZSBgY2xhc3NOYW1lYCBjbGFzcyB2YWx1ZSBpcyBhZGRlZCB0byB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIGNsYXNzTmFtZVwiYCAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDUuIGAkYW5pbWF0ZWAgc2NhbnMgdGhlIGVsZW1lbnQgc3R5bGVzIHRvIGdldCB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uIGR1cmF0aW9uIGFuZCBkZWxheSAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIGNsYXNzTmFtZVwiYCAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDYuIGAkYW5pbWF0ZWAgYmxvY2tzIGFsbCBDU1MgdHJhbnNpdGlvbnMgb24gdGhlIGVsZW1lbnQgdG8gZW5zdXJlIHRoZSBgLmNsYXNzTmFtZWAgY2xhc3Mgc3R5bGluZyBpcyBhcHBsaWVkIHJpZ2h0IGF3YXl8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIGNsYXNzTmFtZVwiYCAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDcuIGAkYW5pbWF0ZWAgYXBwbGllcyB0aGUgcHJvdmlkZWQgY29sbGVjdGlvbiBvZiBgZnJvbWAgQ1NTIHN0eWxlcyB0byB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIGNsYXNzTmFtZVwiYCAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDguIGAkYW5pbWF0ZWAgd2FpdHMgZm9yIGEgc2luZ2xlIGFuaW1hdGlvbiBmcmFtZSAodGhpcyBwZXJmb3JtcyBhIHJlZmxvdykgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIGNsYXNzTmFtZVwiYCAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDkuIGAkYW5pbWF0ZWAgcmVtb3ZlcyB0aGUgQ1NTIHRyYW5zaXRpb24gYmxvY2sgcGxhY2VkIG9uIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIGNsYXNzTmFtZVwiYCAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDEwLiB0aGUgYGNsYXNzTmFtZS1hY3RpdmVgIGNsYXNzIGlzIGFkZGVkICh0aGlzIHRyaWdnZXJzIHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIGNsYXNzTmFtZSBjbGFzc05hbWUtYWN0aXZlXCJgIHxcclxuICAgICAgICAgKiB8IDExLiBgJGFuaW1hdGVgIGFwcGxpZXMgdGhlIGNvbGxlY3Rpb24gb2YgYHRvYCBDU1Mgc3R5bGVzIHRvIHRoZSBlbGVtZW50IHdoaWNoIGFyZSB0aGVuIGhhbmRsZWQgYnkgdGhlIHRyYW5zaXRpb24gICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIGNsYXNzTmFtZSBjbGFzc05hbWUtYWN0aXZlXCJgIHxcclxuICAgICAgICAgKiB8IDEyLiBgJGFuaW1hdGVgIHdhaXRzIGZvciB0aGUgYW5pbWF0aW9uIHRvIGNvbXBsZXRlICh2aWEgZXZlbnRzIGFuZCB0aW1lb3V0KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIGNsYXNzTmFtZSBjbGFzc05hbWUtYWN0aXZlXCJgIHxcclxuICAgICAgICAgKiB8IDEzLiBUaGUgYW5pbWF0aW9uIGVuZHMgYW5kIGFsbCBnZW5lcmF0ZWQgQ1NTIGNsYXNzZXMgYXJlIHJlbW92ZWQgZnJvbSB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDE0LiBUaGUgcmV0dXJuZWQgcHJvbWlzZSBpcyByZXNvbHZlZC4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gZWxlbWVudCB0aGUgZWxlbWVudCB0aGF0IHdpbGwgYmUgdGhlIGZvY3VzIG9mIHRoZSBlbnRlciBhbmltYXRpb25cclxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdH0gZnJvbSBhIGNvbGxlY3Rpb24gb2YgQ1NTIHN0eWxlcyB0aGF0IHdpbGwgYmUgYXBwbGllZCB0byB0aGUgZWxlbWVudCBhdCB0aGUgc3RhcnQgb2YgdGhlIGFuaW1hdGlvblxyXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSB0byBhIGNvbGxlY3Rpb24gb2YgQ1NTIHN0eWxlcyB0aGF0IHRoZSBlbGVtZW50IHdpbGwgYW5pbWF0ZSB0b3dhcmRzXHJcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmc9fSBjbGFzc05hbWUgYW4gb3B0aW9uYWwgQ1NTIGNsYXNzIHRoYXQgd2lsbCBiZSBhZGRlZCB0byB0aGUgZWxlbWVudCBmb3IgdGhlIGR1cmF0aW9uIG9mIHRoZSBhbmltYXRpb24gKHRoZSBkZWZhdWx0IGNsYXNzIGlzIGBuZy1pbmxpbmUtYW5pbWF0ZWApXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3Q9fSBvcHRpb25zIGFuIG9wdGlvbmFsIGNvbGxlY3Rpb24gb2Ygb3B0aW9ucyB0aGF0IHdpbGwgYmUgcGlja2VkIHVwIGJ5IHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb25cclxuICAgICAgICAgKiBAcmV0dXJuIHtQcm9taXNlfSB0aGUgYW5pbWF0aW9uIGNhbGxiYWNrIHByb21pc2VcclxuICAgICAgICAqL1xyXG4gICAgICAgIGFuaW1hdGU6IGZ1bmN0aW9uKGVsZW1lbnQsIGZyb20sIHRvLCBjbGFzc05hbWUsIG9wdGlvbnMpIHtcclxuICAgICAgICAgIGNsYXNzTmFtZSA9IGNsYXNzTmFtZSB8fCAnbmctaW5saW5lLWFuaW1hdGUnO1xyXG4gICAgICAgICAgb3B0aW9ucyA9IHBhcnNlQW5pbWF0ZU9wdGlvbnMob3B0aW9ucykgfHwge307XHJcbiAgICAgICAgICBvcHRpb25zLmZyb20gPSB0byA/IGZyb20gOiBudWxsO1xyXG4gICAgICAgICAgb3B0aW9ucy50byAgID0gdG8gPyB0byA6IGZyb207XHJcblxyXG4gICAgICAgICAgcmV0dXJuIHJ1bkFuaW1hdGlvblBvc3REaWdlc3QoZnVuY3Rpb24oZG9uZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcGVyZm9ybUFuaW1hdGlvbignYW5pbWF0ZScsIGNsYXNzTmFtZSwgc3RyaXBDb21tZW50c0Zyb21FbGVtZW50KGVsZW1lbnQpLCBudWxsLCBudWxsLCBub29wLCBvcHRpb25zLCBkb25lKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICAgICAgKiBAbmFtZSAkYW5pbWF0ZSNlbnRlclxyXG4gICAgICAgICAqIEBraW5kIGZ1bmN0aW9uXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBBcHBlbmRzIHRoZSBlbGVtZW50IHRvIHRoZSBwYXJlbnRFbGVtZW50IGVsZW1lbnQgdGhhdCByZXNpZGVzIGluIHRoZSBkb2N1bWVudCBhbmQgdGhlbiBydW5zIHRoZSBlbnRlciBhbmltYXRpb24uIE9uY2VcclxuICAgICAgICAgKiB0aGUgYW5pbWF0aW9uIGlzIHN0YXJ0ZWQsIHRoZSBmb2xsb3dpbmcgQ1NTIGNsYXNzZXMgd2lsbCBiZSBwcmVzZW50IG9uIHRoZSBlbGVtZW50IGZvciB0aGUgZHVyYXRpb24gb2YgdGhlIGFuaW1hdGlvbjpcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEJlbG93IGlzIGEgYnJlYWtkb3duIG9mIGVhY2ggc3RlcCB0aGF0IG9jY3VycyBkdXJpbmcgZW50ZXIgYW5pbWF0aW9uOlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogfCBBbmltYXRpb24gU3RlcCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBXaGF0IHRoZSBlbGVtZW50IGNsYXNzIGF0dHJpYnV0ZSBsb29rcyBsaWtlICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxyXG4gICAgICAgICAqIHwgMS4gYCRhbmltYXRlLmVudGVyKC4uLilgIGlzIGNhbGxlZCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDIuIGVsZW1lbnQgaXMgaW5zZXJ0ZWQgaW50byB0aGUgYHBhcmVudEVsZW1lbnRgIGVsZW1lbnQgb3IgYmVzaWRlIHRoZSBgYWZ0ZXJFbGVtZW50YCBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCAzLiBgJGFuaW1hdGVgIHdhaXRzIGZvciB0aGUgbmV4dCBkaWdlc3QgdG8gc3RhcnQgdGhlIGFuaW1hdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZVwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgNC4gYCRhbmltYXRlYCBydW5zIHRoZSBKYXZhU2NyaXB0LWRlZmluZWQgYW5pbWF0aW9ucyBkZXRlY3RlZCBvbiB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGVcImAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDUuIHRoZSBgLm5nLWVudGVyYCBjbGFzcyBpcyBhZGRlZCB0byB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWVudGVyXCJgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA2LiBgJGFuaW1hdGVgIHNjYW5zIHRoZSBlbGVtZW50IHN0eWxlcyB0byBnZXQgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbiBkdXJhdGlvbiBhbmQgZGVsYXkgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1lbnRlclwiYCAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgNy4gYCRhbmltYXRlYCBibG9ja3MgYWxsIENTUyB0cmFuc2l0aW9ucyBvbiB0aGUgZWxlbWVudCB0byBlbnN1cmUgdGhlIGAubmctZW50ZXJgIGNsYXNzIHN0eWxpbmcgaXMgYXBwbGllZCByaWdodCBhd2F5IHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctZW50ZXJcImAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDguIGAkYW5pbWF0ZWAgd2FpdHMgZm9yIGEgc2luZ2xlIGFuaW1hdGlvbiBmcmFtZSAodGhpcyBwZXJmb3JtcyBhIHJlZmxvdykgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWVudGVyXCJgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA5LiBgJGFuaW1hdGVgIHJlbW92ZXMgdGhlIENTUyB0cmFuc2l0aW9uIGJsb2NrIHBsYWNlZCBvbiB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1lbnRlclwiYCAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgMTAuIHRoZSBgLm5nLWVudGVyLWFjdGl2ZWAgY2xhc3MgaXMgYWRkZWQgKHRoaXMgdHJpZ2dlcnMgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbikgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctZW50ZXIgbmctZW50ZXItYWN0aXZlXCJgIHxcclxuICAgICAgICAgKiB8IDExLiBgJGFuaW1hdGVgIHdhaXRzIGZvciB0aGUgYW5pbWF0aW9uIHRvIGNvbXBsZXRlICh2aWEgZXZlbnRzIGFuZCB0aW1lb3V0KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWVudGVyIG5nLWVudGVyLWFjdGl2ZVwiYCB8XHJcbiAgICAgICAgICogfCAxMi4gVGhlIGFuaW1hdGlvbiBlbmRzIGFuZCBhbGwgZ2VuZXJhdGVkIENTUyBjbGFzc2VzIGFyZSByZW1vdmVkIGZyb20gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb25cImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgMTMuIFRoZSByZXR1cm5lZCBwcm9taXNlIGlzIHJlc29sdmVkLiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gZWxlbWVudCB0aGUgZWxlbWVudCB0aGF0IHdpbGwgYmUgdGhlIGZvY3VzIG9mIHRoZSBlbnRlciBhbmltYXRpb25cclxuICAgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IHBhcmVudEVsZW1lbnQgdGhlIHBhcmVudCBlbGVtZW50IG9mIHRoZSBlbGVtZW50IHRoYXQgd2lsbCBiZSB0aGUgZm9jdXMgb2YgdGhlIGVudGVyIGFuaW1hdGlvblxyXG4gICAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gYWZ0ZXJFbGVtZW50IHRoZSBzaWJsaW5nIGVsZW1lbnQgKHdoaWNoIGlzIHRoZSBwcmV2aW91cyBlbGVtZW50KSBvZiB0aGUgZWxlbWVudCB0aGF0IHdpbGwgYmUgdGhlIGZvY3VzIG9mIHRoZSBlbnRlciBhbmltYXRpb25cclxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdD19IG9wdGlvbnMgYW4gb3B0aW9uYWwgY29sbGVjdGlvbiBvZiBvcHRpb25zIHRoYXQgd2lsbCBiZSBwaWNrZWQgdXAgYnkgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvblxyXG4gICAgICAgICAqIEByZXR1cm4ge1Byb21pc2V9IHRoZSBhbmltYXRpb24gY2FsbGJhY2sgcHJvbWlzZVxyXG4gICAgICAgICovXHJcbiAgICAgICAgZW50ZXI6IGZ1bmN0aW9uKGVsZW1lbnQsIHBhcmVudEVsZW1lbnQsIGFmdGVyRWxlbWVudCwgb3B0aW9ucykge1xyXG4gICAgICAgICAgb3B0aW9ucyA9IHBhcnNlQW5pbWF0ZU9wdGlvbnMob3B0aW9ucyk7XHJcbiAgICAgICAgICBlbGVtZW50ID0gYW5ndWxhci5lbGVtZW50KGVsZW1lbnQpO1xyXG4gICAgICAgICAgcGFyZW50RWxlbWVudCA9IHByZXBhcmVFbGVtZW50KHBhcmVudEVsZW1lbnQpO1xyXG4gICAgICAgICAgYWZ0ZXJFbGVtZW50ID0gcHJlcGFyZUVsZW1lbnQoYWZ0ZXJFbGVtZW50KTtcclxuXHJcbiAgICAgICAgICBjbGFzc0Jhc2VkQW5pbWF0aW9uc0Jsb2NrZWQoZWxlbWVudCwgdHJ1ZSk7XHJcbiAgICAgICAgICAkZGVsZWdhdGUuZW50ZXIoZWxlbWVudCwgcGFyZW50RWxlbWVudCwgYWZ0ZXJFbGVtZW50KTtcclxuICAgICAgICAgIHJldHVybiBydW5BbmltYXRpb25Qb3N0RGlnZXN0KGZ1bmN0aW9uKGRvbmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHBlcmZvcm1BbmltYXRpb24oJ2VudGVyJywgJ25nLWVudGVyJywgc3RyaXBDb21tZW50c0Zyb21FbGVtZW50KGVsZW1lbnQpLCBwYXJlbnRFbGVtZW50LCBhZnRlckVsZW1lbnQsIG5vb3AsIG9wdGlvbnMsIGRvbmUpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgICAgICAqIEBuYW1lICRhbmltYXRlI2xlYXZlXHJcbiAgICAgICAgICogQGtpbmQgZnVuY3Rpb25cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgICAqIFJ1bnMgdGhlIGxlYXZlIGFuaW1hdGlvbiBvcGVyYXRpb24gYW5kLCB1cG9uIGNvbXBsZXRpb24sIHJlbW92ZXMgdGhlIGVsZW1lbnQgZnJvbSB0aGUgRE9NLiBPbmNlXHJcbiAgICAgICAgICogdGhlIGFuaW1hdGlvbiBpcyBzdGFydGVkLCB0aGUgZm9sbG93aW5nIENTUyBjbGFzc2VzIHdpbGwgYmUgYWRkZWQgZm9yIHRoZSBkdXJhdGlvbiBvZiB0aGUgYW5pbWF0aW9uOlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQmVsb3cgaXMgYSBicmVha2Rvd24gb2YgZWFjaCBzdGVwIHRoYXQgb2NjdXJzIGR1cmluZyBsZWF2ZSBhbmltYXRpb246XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiB8IEFuaW1hdGlvbiBTdGVwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IFdoYXQgdGhlIGVsZW1lbnQgY2xhc3MgYXR0cmlidXRlIGxvb2tzIGxpa2UgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18XHJcbiAgICAgICAgICogfCAxLiBgJGFuaW1hdGUubGVhdmUoLi4uKWAgaXMgY2FsbGVkICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb25cImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgMi4gYCRhbmltYXRlYCBydW5zIHRoZSBKYXZhU2NyaXB0LWRlZmluZWQgYW5pbWF0aW9ucyBkZXRlY3RlZCBvbiB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGVcImAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDMuIGAkYW5pbWF0ZWAgd2FpdHMgZm9yIHRoZSBuZXh0IGRpZ2VzdCB0byBzdGFydCB0aGUgYW5pbWF0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlXCJgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA0LiB0aGUgYC5uZy1sZWF2ZWAgY2xhc3MgaXMgYWRkZWQgdG8gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1sZWF2ZVwiYCAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgNS4gYCRhbmltYXRlYCBzY2FucyB0aGUgZWxlbWVudCBzdHlsZXMgdG8gZ2V0IHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24gZHVyYXRpb24gYW5kIGRlbGF5ICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctbGVhdmVcImAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDYuIGAkYW5pbWF0ZWAgYmxvY2tzIGFsbCBDU1MgdHJhbnNpdGlvbnMgb24gdGhlIGVsZW1lbnQgdG8gZW5zdXJlIHRoZSBgLm5nLWxlYXZlYCBjbGFzcyBzdHlsaW5nIGlzIGFwcGxpZWQgcmlnaHQgYXdheSB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWxlYXZlXCJgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA3LiBgJGFuaW1hdGVgIHdhaXRzIGZvciBhIHNpbmdsZSBhbmltYXRpb24gZnJhbWUgKHRoaXMgcGVyZm9ybXMgYSByZWZsb3cpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1sZWF2ZVwiYCAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgOC4gYCRhbmltYXRlYCByZW1vdmVzIHRoZSBDU1MgdHJhbnNpdGlvbiBibG9jayBwbGFjZWQgb24gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctbGVhdmVcImAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDkuIHRoZSBgLm5nLWxlYXZlLWFjdGl2ZWAgY2xhc3MgaXMgYWRkZWQgKHRoaXMgdHJpZ2dlcnMgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbikgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWxlYXZlIG5nLWxlYXZlLWFjdGl2ZVwiYCB8XHJcbiAgICAgICAgICogfCAxMC4gYCRhbmltYXRlYCB3YWl0cyBmb3IgdGhlIGFuaW1hdGlvbiB0byBjb21wbGV0ZSAodmlhIGV2ZW50cyBhbmQgdGltZW91dCkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1sZWF2ZSBuZy1sZWF2ZS1hY3RpdmVcImAgfFxyXG4gICAgICAgICAqIHwgMTEuIFRoZSBhbmltYXRpb24gZW5kcyBhbmQgYWxsIGdlbmVyYXRlZCBDU1MgY2xhc3NlcyBhcmUgcmVtb3ZlZCBmcm9tIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDEyLiBUaGUgZWxlbWVudCBpcyByZW1vdmVkIGZyb20gdGhlIERPTSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IC4uLiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgMTMuIFRoZSByZXR1cm5lZCBwcm9taXNlIGlzIHJlc29sdmVkLiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgLi4uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgdGhlIGVsZW1lbnQgdGhhdCB3aWxsIGJlIHRoZSBmb2N1cyBvZiB0aGUgbGVhdmUgYW5pbWF0aW9uXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3Q9fSBvcHRpb25zIGFuIG9wdGlvbmFsIGNvbGxlY3Rpb24gb2Ygc3R5bGVzIHRoYXQgd2lsbCBiZSBwaWNrZWQgdXAgYnkgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvblxyXG4gICAgICAgICAqIEByZXR1cm4ge1Byb21pc2V9IHRoZSBhbmltYXRpb24gY2FsbGJhY2sgcHJvbWlzZVxyXG4gICAgICAgICovXHJcbiAgICAgICAgbGVhdmU6IGZ1bmN0aW9uKGVsZW1lbnQsIG9wdGlvbnMpIHtcclxuICAgICAgICAgIG9wdGlvbnMgPSBwYXJzZUFuaW1hdGVPcHRpb25zKG9wdGlvbnMpO1xyXG4gICAgICAgICAgZWxlbWVudCA9IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50KTtcclxuXHJcbiAgICAgICAgICBjYW5jZWxDaGlsZEFuaW1hdGlvbnMoZWxlbWVudCk7XHJcbiAgICAgICAgICBjbGFzc0Jhc2VkQW5pbWF0aW9uc0Jsb2NrZWQoZWxlbWVudCwgdHJ1ZSk7XHJcbiAgICAgICAgICByZXR1cm4gcnVuQW5pbWF0aW9uUG9zdERpZ2VzdChmdW5jdGlvbihkb25lKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwZXJmb3JtQW5pbWF0aW9uKCdsZWF2ZScsICduZy1sZWF2ZScsIHN0cmlwQ29tbWVudHNGcm9tRWxlbWVudChlbGVtZW50KSwgbnVsbCwgbnVsbCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgJGRlbGVnYXRlLmxlYXZlKGVsZW1lbnQpO1xyXG4gICAgICAgICAgICB9LCBvcHRpb25zLCBkb25lKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICAgICAgKiBAbmFtZSAkYW5pbWF0ZSNtb3ZlXHJcbiAgICAgICAgICogQGtpbmQgZnVuY3Rpb25cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgICAqIEZpcmVzIHRoZSBtb3ZlIERPTSBvcGVyYXRpb24uIEp1c3QgYmVmb3JlIHRoZSBhbmltYXRpb24gc3RhcnRzLCB0aGUgYW5pbWF0ZSBzZXJ2aWNlIHdpbGwgZWl0aGVyIGFwcGVuZCBpdCBpbnRvIHRoZSBwYXJlbnRFbGVtZW50IGNvbnRhaW5lciBvclxyXG4gICAgICAgICAqIGFkZCB0aGUgZWxlbWVudCBkaXJlY3RseSBhZnRlciB0aGUgYWZ0ZXJFbGVtZW50IGVsZW1lbnQgaWYgcHJlc2VudC4gVGhlbiB0aGUgbW92ZSBhbmltYXRpb24gd2lsbCBiZSBydW4uIE9uY2VcclxuICAgICAgICAgKiB0aGUgYW5pbWF0aW9uIGlzIHN0YXJ0ZWQsIHRoZSBmb2xsb3dpbmcgQ1NTIGNsYXNzZXMgd2lsbCBiZSBhZGRlZCBmb3IgdGhlIGR1cmF0aW9uIG9mIHRoZSBhbmltYXRpb246XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBCZWxvdyBpcyBhIGJyZWFrZG93biBvZiBlYWNoIHN0ZXAgdGhhdCBvY2N1cnMgZHVyaW5nIG1vdmUgYW5pbWF0aW9uOlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogfCBBbmltYXRpb24gU3RlcCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IFdoYXQgdGhlIGVsZW1lbnQgY2xhc3MgYXR0cmlidXRlIGxvb2tzIGxpa2UgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxyXG4gICAgICAgICAqIHwgMS4gYCRhbmltYXRlLm1vdmUoLi4uKWAgaXMgY2FsbGVkICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb25cImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDIuIGVsZW1lbnQgaXMgbW92ZWQgaW50byB0aGUgcGFyZW50RWxlbWVudCBlbGVtZW50IG9yIGJlc2lkZSB0aGUgYWZ0ZXJFbGVtZW50IGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCAzLiBgJGFuaW1hdGVgIHdhaXRzIGZvciB0aGUgbmV4dCBkaWdlc3QgdG8gc3RhcnQgdGhlIGFuaW1hdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlXCJgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgNC4gYCRhbmltYXRlYCBydW5zIHRoZSBKYXZhU2NyaXB0LWRlZmluZWQgYW5pbWF0aW9ucyBkZXRlY3RlZCBvbiB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZVwiYCAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDUuIHRoZSBgLm5nLW1vdmVgIGNsYXNzIGlzIGFkZGVkIHRvIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctbW92ZVwiYCAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA2LiBgJGFuaW1hdGVgIHNjYW5zIHRoZSBlbGVtZW50IHN0eWxlcyB0byBnZXQgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbiBkdXJhdGlvbiBhbmQgZGVsYXkgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLW1vdmVcImAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgNy4gYCRhbmltYXRlYCBibG9ja3MgYWxsIENTUyB0cmFuc2l0aW9ucyBvbiB0aGUgZWxlbWVudCB0byBlbnN1cmUgdGhlIGAubmctbW92ZWAgY2xhc3Mgc3R5bGluZyBpcyBhcHBsaWVkIHJpZ2h0IGF3YXkgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1tb3ZlXCJgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDguIGAkYW5pbWF0ZWAgd2FpdHMgZm9yIGEgc2luZ2xlIGFuaW1hdGlvbiBmcmFtZSAodGhpcyBwZXJmb3JtcyBhIHJlZmxvdykgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctbW92ZVwiYCAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA5LiBgJGFuaW1hdGVgIHJlbW92ZXMgdGhlIENTUyB0cmFuc2l0aW9uIGJsb2NrIHBsYWNlZCBvbiB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLW1vdmVcImAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgMTAuIHRoZSBgLm5nLW1vdmUtYWN0aXZlYCBjbGFzcyBpcyBhZGRlZCAodGhpcyB0cmlnZ2VycyB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1tb3ZlIG5nLW1vdmUtYWN0aXZlXCJgIHxcclxuICAgICAgICAgKiB8IDExLiBgJGFuaW1hdGVgIHdhaXRzIGZvciB0aGUgYW5pbWF0aW9uIHRvIGNvbXBsZXRlICh2aWEgZXZlbnRzIGFuZCB0aW1lb3V0KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctbW92ZSBuZy1tb3ZlLWFjdGl2ZVwiYCB8XHJcbiAgICAgICAgICogfCAxMi4gVGhlIGFuaW1hdGlvbiBlbmRzIGFuZCBhbGwgZ2VuZXJhdGVkIENTUyBjbGFzc2VzIGFyZSByZW1vdmVkIGZyb20gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgMTMuIFRoZSByZXR1cm5lZCBwcm9taXNlIGlzIHJlc29sdmVkLiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb25cImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gZWxlbWVudCB0aGUgZWxlbWVudCB0aGF0IHdpbGwgYmUgdGhlIGZvY3VzIG9mIHRoZSBtb3ZlIGFuaW1hdGlvblxyXG4gICAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gcGFyZW50RWxlbWVudCB0aGUgcGFyZW50RWxlbWVudCBlbGVtZW50IG9mIHRoZSBlbGVtZW50IHRoYXQgd2lsbCBiZSB0aGUgZm9jdXMgb2YgdGhlIG1vdmUgYW5pbWF0aW9uXHJcbiAgICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBhZnRlckVsZW1lbnQgdGhlIHNpYmxpbmcgZWxlbWVudCAod2hpY2ggaXMgdGhlIHByZXZpb3VzIGVsZW1lbnQpIG9mIHRoZSBlbGVtZW50IHRoYXQgd2lsbCBiZSB0aGUgZm9jdXMgb2YgdGhlIG1vdmUgYW5pbWF0aW9uXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3Q9fSBvcHRpb25zIGFuIG9wdGlvbmFsIGNvbGxlY3Rpb24gb2Ygc3R5bGVzIHRoYXQgd2lsbCBiZSBwaWNrZWQgdXAgYnkgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvblxyXG4gICAgICAgICAqIEByZXR1cm4ge1Byb21pc2V9IHRoZSBhbmltYXRpb24gY2FsbGJhY2sgcHJvbWlzZVxyXG4gICAgICAgICovXHJcbiAgICAgICAgbW92ZTogZnVuY3Rpb24oZWxlbWVudCwgcGFyZW50RWxlbWVudCwgYWZ0ZXJFbGVtZW50LCBvcHRpb25zKSB7XHJcbiAgICAgICAgICBvcHRpb25zID0gcGFyc2VBbmltYXRlT3B0aW9ucyhvcHRpb25zKTtcclxuICAgICAgICAgIGVsZW1lbnQgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudCk7XHJcbiAgICAgICAgICBwYXJlbnRFbGVtZW50ID0gcHJlcGFyZUVsZW1lbnQocGFyZW50RWxlbWVudCk7XHJcbiAgICAgICAgICBhZnRlckVsZW1lbnQgPSBwcmVwYXJlRWxlbWVudChhZnRlckVsZW1lbnQpO1xyXG5cclxuICAgICAgICAgIGNhbmNlbENoaWxkQW5pbWF0aW9ucyhlbGVtZW50KTtcclxuICAgICAgICAgIGNsYXNzQmFzZWRBbmltYXRpb25zQmxvY2tlZChlbGVtZW50LCB0cnVlKTtcclxuICAgICAgICAgICRkZWxlZ2F0ZS5tb3ZlKGVsZW1lbnQsIHBhcmVudEVsZW1lbnQsIGFmdGVyRWxlbWVudCk7XHJcbiAgICAgICAgICByZXR1cm4gcnVuQW5pbWF0aW9uUG9zdERpZ2VzdChmdW5jdGlvbihkb25lKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwZXJmb3JtQW5pbWF0aW9uKCdtb3ZlJywgJ25nLW1vdmUnLCBzdHJpcENvbW1lbnRzRnJvbUVsZW1lbnQoZWxlbWVudCksIHBhcmVudEVsZW1lbnQsIGFmdGVyRWxlbWVudCwgbm9vcCwgb3B0aW9ucywgZG9uZSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAgICAgICogQG5hbWUgJGFuaW1hdGUjYWRkQ2xhc3NcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgICAqIFRyaWdnZXJzIGEgY3VzdG9tIGFuaW1hdGlvbiBldmVudCBiYXNlZCBvZmYgdGhlIGNsYXNzTmFtZSB2YXJpYWJsZSBhbmQgdGhlbiBhdHRhY2hlcyB0aGUgY2xhc3NOYW1lIHZhbHVlIHRvIHRoZSBlbGVtZW50IGFzIGEgQ1NTIGNsYXNzLlxyXG4gICAgICAgICAqIFVubGlrZSB0aGUgb3RoZXIgYW5pbWF0aW9uIG1ldGhvZHMsIHRoZSBhbmltYXRlIHNlcnZpY2Ugd2lsbCBzdWZmaXggdGhlIGNsYXNzTmFtZSB2YWx1ZSB3aXRoIHtAdHlwZSAtYWRkfSBpbiBvcmRlciB0byBwcm92aWRlXHJcbiAgICAgICAgICogdGhlIGFuaW1hdGUgc2VydmljZSB0aGUgc2V0dXAgYW5kIGFjdGl2ZSBDU1MgY2xhc3NlcyBpbiBvcmRlciB0byB0cmlnZ2VyIHRoZSBhbmltYXRpb24gKHRoaXMgd2lsbCBiZSBza2lwcGVkIGlmIG5vIENTUyB0cmFuc2l0aW9uc1xyXG4gICAgICAgICAqIG9yIGtleWZyYW1lcyBhcmUgZGVmaW5lZCBvbiB0aGUgLWFkZC1hY3RpdmUgb3IgYmFzZSBDU1MgY2xhc3MpLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQmVsb3cgaXMgYSBicmVha2Rvd24gb2YgZWFjaCBzdGVwIHRoYXQgb2NjdXJzIGR1cmluZyBhZGRDbGFzcyBhbmltYXRpb246XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiB8IEFuaW1hdGlvbiBTdGVwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IFdoYXQgdGhlIGVsZW1lbnQgY2xhc3MgYXR0cmlidXRlIGxvb2tzIGxpa2UgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxyXG4gICAgICAgICAqIHwgMS4gYCRhbmltYXRlLmFkZENsYXNzKGVsZW1lbnQsICdzdXBlcicpYCBpcyBjYWxsZWQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgMi4gYCRhbmltYXRlYCBydW5zIHRoZSBKYXZhU2NyaXB0LWRlZmluZWQgYW5pbWF0aW9ucyBkZXRlY3RlZCBvbiB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGVcImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgMy4gdGhlIGAuc3VwZXItYWRkYCBjbGFzcyBpcyBhZGRlZCB0byB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgc3VwZXItYWRkXCJgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgNC4gYCRhbmltYXRlYCB3YWl0cyBmb3IgYSBzaW5nbGUgYW5pbWF0aW9uIGZyYW1lICh0aGlzIHBlcmZvcm1zIGEgcmVmbG93KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgc3VwZXItYWRkXCJgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgNS4gdGhlIGAuc3VwZXJgIGFuZCBgLnN1cGVyLWFkZC1hY3RpdmVgIGNsYXNzZXMgYXJlIGFkZGVkICh0aGlzIHRyaWdnZXJzIHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24pIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgc3VwZXIgc3VwZXItYWRkIHN1cGVyLWFkZC1hY3RpdmVcImAgfFxyXG4gICAgICAgICAqIHwgNi4gYCRhbmltYXRlYCBzY2FucyB0aGUgZWxlbWVudCBzdHlsZXMgdG8gZ2V0IHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24gZHVyYXRpb24gYW5kIGRlbGF5ICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgc3VwZXIgc3VwZXItYWRkIHN1cGVyLWFkZC1hY3RpdmVcImAgfFxyXG4gICAgICAgICAqIHwgNy4gYCRhbmltYXRlYCB3YWl0cyBmb3IgdGhlIGFuaW1hdGlvbiB0byBjb21wbGV0ZSAodmlhIGV2ZW50cyBhbmQgdGltZW91dCkgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgc3VwZXIgc3VwZXItYWRkIHN1cGVyLWFkZC1hY3RpdmVcImAgfFxyXG4gICAgICAgICAqIHwgOC4gVGhlIGFuaW1hdGlvbiBlbmRzIGFuZCBhbGwgZ2VuZXJhdGVkIENTUyBjbGFzc2VzIGFyZSByZW1vdmVkIGZyb20gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIHN1cGVyXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgOS4gVGhlIHN1cGVyIGNsYXNzIGlzIGtlcHQgb24gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIHN1cGVyXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgMTAuIFRoZSByZXR1cm5lZCBwcm9taXNlIGlzIHJlc29sdmVkLiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIHN1cGVyXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBlbGVtZW50IHRoZSBlbGVtZW50IHRoYXQgd2lsbCBiZSBhbmltYXRlZFxyXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjbGFzc05hbWUgdGhlIENTUyBjbGFzcyB0aGF0IHdpbGwgYmUgYWRkZWQgdG8gdGhlIGVsZW1lbnQgYW5kIHRoZW4gYW5pbWF0ZWRcclxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdD19IG9wdGlvbnMgYW4gb3B0aW9uYWwgY29sbGVjdGlvbiBvZiBzdHlsZXMgdGhhdCB3aWxsIGJlIHBpY2tlZCB1cCBieSB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uXHJcbiAgICAgICAgICogQHJldHVybiB7UHJvbWlzZX0gdGhlIGFuaW1hdGlvbiBjYWxsYmFjayBwcm9taXNlXHJcbiAgICAgICAgKi9cclxuICAgICAgICBhZGRDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBvcHRpb25zKSB7XHJcbiAgICAgICAgICByZXR1cm4gdGhpcy5zZXRDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUsIFtdLCBvcHRpb25zKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAgICAgICogQG5hbWUgJGFuaW1hdGUjcmVtb3ZlQ2xhc3NcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgICAqIFRyaWdnZXJzIGEgY3VzdG9tIGFuaW1hdGlvbiBldmVudCBiYXNlZCBvZmYgdGhlIGNsYXNzTmFtZSB2YXJpYWJsZSBhbmQgdGhlbiByZW1vdmVzIHRoZSBDU1MgY2xhc3MgcHJvdmlkZWQgYnkgdGhlIGNsYXNzTmFtZSB2YWx1ZVxyXG4gICAgICAgICAqIGZyb20gdGhlIGVsZW1lbnQuIFVubGlrZSB0aGUgb3RoZXIgYW5pbWF0aW9uIG1ldGhvZHMsIHRoZSBhbmltYXRlIHNlcnZpY2Ugd2lsbCBzdWZmaXggdGhlIGNsYXNzTmFtZSB2YWx1ZSB3aXRoIHtAdHlwZSAtcmVtb3ZlfSBpblxyXG4gICAgICAgICAqIG9yZGVyIHRvIHByb3ZpZGUgdGhlIGFuaW1hdGUgc2VydmljZSB0aGUgc2V0dXAgYW5kIGFjdGl2ZSBDU1MgY2xhc3NlcyBpbiBvcmRlciB0byB0cmlnZ2VyIHRoZSBhbmltYXRpb24gKHRoaXMgd2lsbCBiZSBza2lwcGVkIGlmXHJcbiAgICAgICAgICogbm8gQ1NTIHRyYW5zaXRpb25zIG9yIGtleWZyYW1lcyBhcmUgZGVmaW5lZCBvbiB0aGUgLXJlbW92ZSBvciBiYXNlIENTUyBjbGFzc2VzKS5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEJlbG93IGlzIGEgYnJlYWtkb3duIG9mIGVhY2ggc3RlcCB0aGF0IG9jY3VycyBkdXJpbmcgcmVtb3ZlQ2xhc3MgYW5pbWF0aW9uOlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogfCBBbmltYXRpb24gU3RlcCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IFdoYXQgdGhlIGVsZW1lbnQgY2xhc3MgYXR0cmlidXRlIGxvb2tzIGxpa2UgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18XHJcbiAgICAgICAgICogfCAxLiBgJGFuaW1hdGUucmVtb3ZlQ2xhc3MoZWxlbWVudCwgJ3N1cGVyJylgIGlzIGNhbGxlZCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBzdXBlclwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDIuIGAkYW5pbWF0ZWAgcnVucyB0aGUgSmF2YVNjcmlwdC1kZWZpbmVkIGFuaW1hdGlvbnMgZGV0ZWN0ZWQgb24gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIHN1cGVyIG5nLWFuaW1hdGVcImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgMy4gdGhlIGAuc3VwZXItcmVtb3ZlYCBjbGFzcyBpcyBhZGRlZCB0byB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gc3VwZXIgbmctYW5pbWF0ZSBzdXBlci1yZW1vdmVcImAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA0LiBgJGFuaW1hdGVgIHdhaXRzIGZvciBhIHNpbmdsZSBhbmltYXRpb24gZnJhbWUgKHRoaXMgcGVyZm9ybXMgYSByZWZsb3cpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBzdXBlciBuZy1hbmltYXRlIHN1cGVyLXJlbW92ZVwiYCAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDUuIHRoZSBgLnN1cGVyLXJlbW92ZS1hY3RpdmVgIGNsYXNzZXMgYXJlIGFkZGVkIGFuZCBgLnN1cGVyYCBpcyByZW1vdmVkICh0aGlzIHRyaWdnZXJzIHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24pIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgc3VwZXItcmVtb3ZlIHN1cGVyLXJlbW92ZS1hY3RpdmVcImAgfFxyXG4gICAgICAgICAqIHwgNi4gYCRhbmltYXRlYCBzY2FucyB0aGUgZWxlbWVudCBzdHlsZXMgdG8gZ2V0IHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24gZHVyYXRpb24gYW5kIGRlbGF5ICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBzdXBlci1yZW1vdmUgc3VwZXItcmVtb3ZlLWFjdGl2ZVwiYCB8XHJcbiAgICAgICAgICogfCA3LiBgJGFuaW1hdGVgIHdhaXRzIGZvciB0aGUgYW5pbWF0aW9uIHRvIGNvbXBsZXRlICh2aWEgZXZlbnRzIGFuZCB0aW1lb3V0KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIHN1cGVyLXJlbW92ZSBzdXBlci1yZW1vdmUtYWN0aXZlXCJgIHxcclxuICAgICAgICAgKiB8IDguIFRoZSBhbmltYXRpb24gZW5kcyBhbmQgYWxsIGdlbmVyYXRlZCBDU1MgY2xhc3NlcyBhcmUgcmVtb3ZlZCBmcm9tIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgOS4gVGhlIHJldHVybmVkIHByb21pc2UgaXMgcmVzb2x2ZWQuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb25cImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gZWxlbWVudCB0aGUgZWxlbWVudCB0aGF0IHdpbGwgYmUgYW5pbWF0ZWRcclxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NOYW1lIHRoZSBDU1MgY2xhc3MgdGhhdCB3aWxsIGJlIGFuaW1hdGVkIGFuZCB0aGVuIHJlbW92ZWQgZnJvbSB0aGUgZWxlbWVudFxyXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyBhbiBvcHRpb25hbCBjb2xsZWN0aW9uIG9mIHN0eWxlcyB0aGF0IHdpbGwgYmUgcGlja2VkIHVwIGJ5IHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb25cclxuICAgICAgICAgKiBAcmV0dXJuIHtQcm9taXNlfSB0aGUgYW5pbWF0aW9uIGNhbGxiYWNrIHByb21pc2VcclxuICAgICAgICAqL1xyXG4gICAgICAgIHJlbW92ZUNsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIG9wdGlvbnMpIHtcclxuICAgICAgICAgIHJldHVybiB0aGlzLnNldENsYXNzKGVsZW1lbnQsIFtdLCBjbGFzc05hbWUsIG9wdGlvbnMpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgICAgICAqIEBuYW1lICRhbmltYXRlI3NldENsYXNzXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gQWRkcyBhbmQvb3IgcmVtb3ZlcyB0aGUgZ2l2ZW4gQ1NTIGNsYXNzZXMgdG8gYW5kIGZyb20gdGhlIGVsZW1lbnQuXHJcbiAgICAgICAgICogT25jZSBjb21wbGV0ZSwgdGhlIGBkb25lKClgIGNhbGxiYWNrIHdpbGwgYmUgZmlyZWQgKGlmIHByb3ZpZGVkKS5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIHwgQW5pbWF0aW9uIFN0ZXAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBXaGF0IHRoZSBlbGVtZW50IGNsYXNzIGF0dHJpYnV0ZSBsb29rcyBsaWtlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcclxuICAgICAgICAgKiB8IDEuIGAkYW5pbWF0ZS5zZXRDbGFzcyhlbGVtZW50LCAnb24nLCAnb2ZmJylgIGlzIGNhbGxlZCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG9mZlwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCAyLiBgJGFuaW1hdGVgIHJ1bnMgdGhlIEphdmFTY3JpcHQtZGVmaW5lZCBhbmltYXRpb25zIGRldGVjdGVkIG9uIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG9mZlwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgMy4gdGhlIGAub24tYWRkYCBhbmQgYC5vZmYtcmVtb3ZlYCBjbGFzc2VzIGFyZSBhZGRlZCB0byB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBvbi1hZGQgb2ZmLXJlbW92ZSBvZmZcImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDQuIGAkYW5pbWF0ZWAgd2FpdHMgZm9yIGEgc2luZ2xlIGFuaW1hdGlvbiBmcmFtZSAodGhpcyBwZXJmb3JtcyBhIHJlZmxvdykgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgb24tYWRkIG9mZi1yZW1vdmUgb2ZmXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA1LiB0aGUgYC5vbmAsIGAub24tYWRkLWFjdGl2ZWAgYW5kIGAub2ZmLXJlbW92ZS1hY3RpdmVgIGNsYXNzZXMgYXJlIGFkZGVkIGFuZCBgLm9mZmAgaXMgcmVtb3ZlZCAodGhpcyB0cmlnZ2VycyB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uKSB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG9uIG9uLWFkZCBvbi1hZGQtYWN0aXZlIG9mZi1yZW1vdmUgb2ZmLXJlbW92ZS1hY3RpdmVcImAgfFxyXG4gICAgICAgICAqIHwgNi4gYCRhbmltYXRlYCBzY2FucyB0aGUgZWxlbWVudCBzdHlsZXMgdG8gZ2V0IHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24gZHVyYXRpb24gYW5kIGRlbGF5ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBvbiBvbi1hZGQgb24tYWRkLWFjdGl2ZSBvZmYtcmVtb3ZlIG9mZi1yZW1vdmUtYWN0aXZlXCJgIHxcclxuICAgICAgICAgKiB8IDcuIGAkYW5pbWF0ZWAgd2FpdHMgZm9yIHRoZSBhbmltYXRpb24gdG8gY29tcGxldGUgKHZpYSBldmVudHMgYW5kIHRpbWVvdXQpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgb24gb24tYWRkIG9uLWFkZC1hY3RpdmUgb2ZmLXJlbW92ZSBvZmYtcmVtb3ZlLWFjdGl2ZVwiYCB8XHJcbiAgICAgICAgICogfCA4LiBUaGUgYW5pbWF0aW9uIGVuZHMgYW5kIGFsbCBnZW5lcmF0ZWQgQ1NTIGNsYXNzZXMgYXJlIHJlbW92ZWQgZnJvbSB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgOS4gVGhlIHJldHVybmVkIHByb21pc2UgaXMgcmVzb2x2ZWQuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gb25cImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gZWxlbWVudCB0aGUgZWxlbWVudCB3aGljaCB3aWxsIGhhdmUgaXRzIENTUyBjbGFzc2VzIGNoYW5nZWRcclxuICAgICAgICAgKiAgIHJlbW92ZWQgZnJvbSBpdFxyXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhZGQgdGhlIENTUyBjbGFzc2VzIHdoaWNoIHdpbGwgYmUgYWRkZWQgdG8gdGhlIGVsZW1lbnRcclxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gcmVtb3ZlIHRoZSBDU1MgY2xhc3Mgd2hpY2ggd2lsbCBiZSByZW1vdmVkIGZyb20gdGhlIGVsZW1lbnRcclxuICAgICAgICAgKiAgIENTUyBjbGFzc2VzIGhhdmUgYmVlbiBzZXQgb24gdGhlIGVsZW1lbnRcclxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdD19IG9wdGlvbnMgYW4gb3B0aW9uYWwgY29sbGVjdGlvbiBvZiBzdHlsZXMgdGhhdCB3aWxsIGJlIHBpY2tlZCB1cCBieSB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uXHJcbiAgICAgICAgICogQHJldHVybiB7UHJvbWlzZX0gdGhlIGFuaW1hdGlvbiBjYWxsYmFjayBwcm9taXNlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0Q2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGFkZCwgcmVtb3ZlLCBvcHRpb25zKSB7XHJcbiAgICAgICAgICBvcHRpb25zID0gcGFyc2VBbmltYXRlT3B0aW9ucyhvcHRpb25zKTtcclxuXHJcbiAgICAgICAgICB2YXIgU1RPUkFHRV9LRVkgPSAnJCRhbmltYXRlQ2xhc3Nlcyc7XHJcbiAgICAgICAgICBlbGVtZW50ID0gYW5ndWxhci5lbGVtZW50KGVsZW1lbnQpO1xyXG4gICAgICAgICAgZWxlbWVudCA9IHN0cmlwQ29tbWVudHNGcm9tRWxlbWVudChlbGVtZW50KTtcclxuXHJcbiAgICAgICAgICBpZiAoY2xhc3NCYXNlZEFuaW1hdGlvbnNCbG9ja2VkKGVsZW1lbnQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkZGVsZWdhdGUuJCRzZXRDbGFzc0ltbWVkaWF0ZWx5KGVsZW1lbnQsIGFkZCwgcmVtb3ZlLCBvcHRpb25zKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvLyB3ZSdyZSB1c2luZyBhIGNvbWJpbmVkIGFycmF5IGZvciBib3RoIHRoZSBhZGQgYW5kIHJlbW92ZVxyXG4gICAgICAgICAgLy8gb3BlcmF0aW9ucyBzaW5jZSB0aGUgT1JERVIgT0YgYWRkQ2xhc3MgYW5kIHJlbW92ZUNsYXNzIG1hdHRlcnNcclxuICAgICAgICAgIHZhciBjbGFzc2VzLCBjYWNoZSA9IGVsZW1lbnQuZGF0YShTVE9SQUdFX0tFWSk7XHJcbiAgICAgICAgICB2YXIgaGFzQ2FjaGUgPSAhIWNhY2hlO1xyXG4gICAgICAgICAgaWYgKCFjYWNoZSkge1xyXG4gICAgICAgICAgICBjYWNoZSA9IHt9O1xyXG4gICAgICAgICAgICBjYWNoZS5jbGFzc2VzID0ge307XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBjbGFzc2VzID0gY2FjaGUuY2xhc3NlcztcclxuXHJcbiAgICAgICAgICBhZGQgPSBpc0FycmF5KGFkZCkgPyBhZGQgOiBhZGQuc3BsaXQoJyAnKTtcclxuICAgICAgICAgIGZvckVhY2goYWRkLCBmdW5jdGlvbihjKSB7XHJcbiAgICAgICAgICAgIGlmIChjICYmIGMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgY2xhc3Nlc1tjXSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIHJlbW92ZSA9IGlzQXJyYXkocmVtb3ZlKSA/IHJlbW92ZSA6IHJlbW92ZS5zcGxpdCgnICcpO1xyXG4gICAgICAgICAgZm9yRWFjaChyZW1vdmUsIGZ1bmN0aW9uKGMpIHtcclxuICAgICAgICAgICAgaWYgKGMgJiYgYy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICBjbGFzc2VzW2NdID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIGlmIChoYXNDYWNoZSkge1xyXG4gICAgICAgICAgICBpZiAob3B0aW9ucyAmJiBjYWNoZS5vcHRpb25zKSB7XHJcbiAgICAgICAgICAgICAgY2FjaGUub3B0aW9ucyA9IGFuZ3VsYXIuZXh0ZW5kKGNhY2hlLm9wdGlvbnMgfHwge30sIG9wdGlvbnMpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvL3RoZSBkaWdlc3QgY3ljbGUgd2lsbCBjb21iaW5lIGFsbCB0aGUgYW5pbWF0aW9ucyBpbnRvIG9uZSBmdW5jdGlvblxyXG4gICAgICAgICAgICByZXR1cm4gY2FjaGUucHJvbWlzZTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuZGF0YShTVE9SQUdFX0tFWSwgY2FjaGUgPSB7XHJcbiAgICAgICAgICAgICAgY2xhc3NlczogY2xhc3NlcyxcclxuICAgICAgICAgICAgICBvcHRpb25zOiBvcHRpb25zXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIHJldHVybiBjYWNoZS5wcm9taXNlID0gcnVuQW5pbWF0aW9uUG9zdERpZ2VzdChmdW5jdGlvbihkb25lKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXJlbnRFbGVtZW50ID0gZWxlbWVudC5wYXJlbnQoKTtcclxuICAgICAgICAgICAgdmFyIGVsZW1lbnROb2RlID0gZXh0cmFjdEVsZW1lbnROb2RlKGVsZW1lbnQpO1xyXG4gICAgICAgICAgICB2YXIgcGFyZW50Tm9kZSA9IGVsZW1lbnROb2RlLnBhcmVudE5vZGU7XHJcbiAgICAgICAgICAgIC8vIFRPRE8obWF0c2tvKTogbW92ZSB0aGlzIGNvZGUgaW50byB0aGUgYW5pbWF0aW9uc0Rpc2FibGVkKCkgZnVuY3Rpb24gb25jZSAjODA5MiBpcyBmaXhlZFxyXG4gICAgICAgICAgICBpZiAoIXBhcmVudE5vZGUgfHwgcGFyZW50Tm9kZVsnJCROR19SRU1PVkVEJ10gfHwgZWxlbWVudE5vZGVbJyQkTkdfUkVNT1ZFRCddKSB7XHJcbiAgICAgICAgICAgICAgZG9uZSgpO1xyXG4gICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIGNhY2hlID0gZWxlbWVudC5kYXRhKFNUT1JBR0VfS0VZKTtcclxuICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVEYXRhKFNUT1JBR0VfS0VZKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBzdGF0ZSA9IGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFKSB8fCB7fTtcclxuICAgICAgICAgICAgdmFyIGNsYXNzZXMgPSByZXNvbHZlRWxlbWVudENsYXNzZXMoZWxlbWVudCwgY2FjaGUsIHN0YXRlLmFjdGl2ZSk7XHJcbiAgICAgICAgICAgIHJldHVybiAhY2xhc3Nlc1xyXG4gICAgICAgICAgICAgID8gZG9uZSgpXHJcbiAgICAgICAgICAgICAgOiBwZXJmb3JtQW5pbWF0aW9uKCdzZXRDbGFzcycsIGNsYXNzZXMsIGVsZW1lbnQsIHBhcmVudEVsZW1lbnQsIG51bGwsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICBpZiAoY2xhc3Nlc1swXSkgJGRlbGVnYXRlLiQkYWRkQ2xhc3NJbW1lZGlhdGVseShlbGVtZW50LCBjbGFzc2VzWzBdKTtcclxuICAgICAgICAgICAgICAgICAgaWYgKGNsYXNzZXNbMV0pICRkZWxlZ2F0ZS4kJHJlbW92ZUNsYXNzSW1tZWRpYXRlbHkoZWxlbWVudCwgY2xhc3Nlc1sxXSk7XHJcbiAgICAgICAgICAgICAgICB9LCBjYWNoZS5vcHRpb25zLCBkb25lKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICAgICAgKiBAbmFtZSAkYW5pbWF0ZSNjYW5jZWxcclxuICAgICAgICAgKiBAa2luZCBmdW5jdGlvblxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHtQcm9taXNlfSBhbmltYXRpb25Qcm9taXNlIFRoZSBhbmltYXRpb24gcHJvbWlzZSB0aGF0IGlzIHJldHVybmVkIHdoZW4gYW4gYW5pbWF0aW9uIGlzIHN0YXJ0ZWQuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBDYW5jZWxzIHRoZSBwcm92aWRlZCBhbmltYXRpb24uXHJcbiAgICAgICAgKi9cclxuICAgICAgICBjYW5jZWw6IGZ1bmN0aW9uKHByb21pc2UpIHtcclxuICAgICAgICAgIHByb21pc2UuJCRjYW5jZWxGbigpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICAgICAgKiBAbmFtZSAkYW5pbWF0ZSNlbmFibGVkXHJcbiAgICAgICAgICogQGtpbmQgZnVuY3Rpb25cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7Ym9vbGVhbj19IHZhbHVlIElmIHByb3ZpZGVkIHRoZW4gc2V0IHRoZSBhbmltYXRpb24gb24gb3Igb2ZmLlxyXG4gICAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudD19IGVsZW1lbnQgSWYgcHJvdmlkZWQgdGhlbiB0aGUgZWxlbWVudCB3aWxsIGJlIHVzZWQgdG8gcmVwcmVzZW50IHRoZSBlbmFibGUvZGlzYWJsZSBvcGVyYXRpb25cclxuICAgICAgICAgKiBAcmV0dXJuIHtib29sZWFufSBDdXJyZW50IGFuaW1hdGlvbiBzdGF0ZS5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgICAqIEdsb2JhbGx5IGVuYWJsZXMvZGlzYWJsZXMgYW5pbWF0aW9ucy5cclxuICAgICAgICAgKlxyXG4gICAgICAgICovXHJcbiAgICAgICAgZW5hYmxlZDogZnVuY3Rpb24odmFsdWUsIGVsZW1lbnQpIHtcclxuICAgICAgICAgIHN3aXRjaCAoYXJndW1lbnRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBjbGVhbnVwKGVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFKSB8fCB7fTtcclxuICAgICAgICAgICAgICAgIGRhdGEuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUsIGRhdGEpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgcm9vdEFuaW1hdGVTdGF0ZS5kaXNhYmxlZCA9ICF2YWx1ZTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgIHZhbHVlID0gIXJvb3RBbmltYXRlU3RhdGUuZGlzYWJsZWQ7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuICEhdmFsdWU7XHJcbiAgICAgICAgIH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8qXHJcbiAgICAgICAgYWxsIGFuaW1hdGlvbnMgY2FsbCB0aGlzIHNoYXJlZCBhbmltYXRpb24gdHJpZ2dlcmluZyBmdW5jdGlvbiBpbnRlcm5hbGx5LlxyXG4gICAgICAgIFRoZSBhbmltYXRpb25FdmVudCB2YXJpYWJsZSByZWZlcnMgdG8gdGhlIEphdmFTY3JpcHQgYW5pbWF0aW9uIGV2ZW50IHRoYXQgd2lsbCBiZSB0cmlnZ2VyZWRcclxuICAgICAgICBhbmQgdGhlIGNsYXNzTmFtZSB2YWx1ZSBpcyB0aGUgbmFtZSBvZiB0aGUgYW5pbWF0aW9uIHRoYXQgd2lsbCBiZSBhcHBsaWVkIHdpdGhpbiB0aGVcclxuICAgICAgICBDU1MgY29kZS4gRWxlbWVudCwgYHBhcmVudEVsZW1lbnRgIGFuZCBgYWZ0ZXJFbGVtZW50YCBhcmUgcHJvdmlkZWQgRE9NIGVsZW1lbnRzIGZvciB0aGUgYW5pbWF0aW9uXHJcbiAgICAgICAgYW5kIHRoZSBvbkNvbXBsZXRlIGNhbGxiYWNrIHdpbGwgYmUgZmlyZWQgb25jZSB0aGUgYW5pbWF0aW9uIGlzIGZ1bGx5IGNvbXBsZXRlLlxyXG4gICAgICAqL1xyXG4gICAgICBmdW5jdGlvbiBwZXJmb3JtQW5pbWF0aW9uKGFuaW1hdGlvbkV2ZW50LCBjbGFzc05hbWUsIGVsZW1lbnQsIHBhcmVudEVsZW1lbnQsIGFmdGVyRWxlbWVudCwgZG9tT3BlcmF0aW9uLCBvcHRpb25zLCBkb25lQ2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgbm9vcENhbmNlbCA9IG5vb3A7XHJcbiAgICAgICAgdmFyIHJ1bm5lciA9IGFuaW1hdGlvblJ1bm5lcihlbGVtZW50LCBhbmltYXRpb25FdmVudCwgY2xhc3NOYW1lLCBvcHRpb25zKTtcclxuICAgICAgICBpZiAoIXJ1bm5lcikge1xyXG4gICAgICAgICAgZmlyZURPTU9wZXJhdGlvbigpO1xyXG4gICAgICAgICAgZmlyZUJlZm9yZUNhbGxiYWNrQXN5bmMoKTtcclxuICAgICAgICAgIGZpcmVBZnRlckNhbGxiYWNrQXN5bmMoKTtcclxuICAgICAgICAgIGNsb3NlQW5pbWF0aW9uKCk7XHJcbiAgICAgICAgICByZXR1cm4gbm9vcENhbmNlbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGFuaW1hdGlvbkV2ZW50ID0gcnVubmVyLmV2ZW50O1xyXG4gICAgICAgIGNsYXNzTmFtZSA9IHJ1bm5lci5jbGFzc05hbWU7XHJcbiAgICAgICAgdmFyIGVsZW1lbnRFdmVudHMgPSBhbmd1bGFyLmVsZW1lbnQuX2RhdGEocnVubmVyLm5vZGUpO1xyXG4gICAgICAgIGVsZW1lbnRFdmVudHMgPSBlbGVtZW50RXZlbnRzICYmIGVsZW1lbnRFdmVudHMuZXZlbnRzO1xyXG5cclxuICAgICAgICBpZiAoIXBhcmVudEVsZW1lbnQpIHtcclxuICAgICAgICAgIHBhcmVudEVsZW1lbnQgPSBhZnRlckVsZW1lbnQgPyBhZnRlckVsZW1lbnQucGFyZW50KCkgOiBlbGVtZW50LnBhcmVudCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy9za2lwIHRoZSBhbmltYXRpb24gaWYgYW5pbWF0aW9ucyBhcmUgZGlzYWJsZWQsIGEgcGFyZW50IGlzIGFscmVhZHkgYmVpbmcgYW5pbWF0ZWQsXHJcbiAgICAgICAgLy90aGUgZWxlbWVudCBpcyBub3QgY3VycmVudGx5IGF0dGFjaGVkIHRvIHRoZSBkb2N1bWVudCBib2R5IG9yIHRoZW4gY29tcGxldGVseSBjbG9zZVxyXG4gICAgICAgIC8vdGhlIGFuaW1hdGlvbiBpZiBhbnkgbWF0Y2hpbmcgYW5pbWF0aW9ucyBhcmUgbm90IGZvdW5kIGF0IGFsbC5cclxuICAgICAgICAvL05PVEU6IElFOCArIElFOSBzaG91bGQgY2xvc2UgcHJvcGVybHkgKHJ1biBjbG9zZUFuaW1hdGlvbigpKSBpbiBjYXNlIGFuIGFuaW1hdGlvbiB3YXMgZm91bmQuXHJcbiAgICAgICAgaWYgKGFuaW1hdGlvbnNEaXNhYmxlZChlbGVtZW50LCBwYXJlbnRFbGVtZW50KSkge1xyXG4gICAgICAgICAgZmlyZURPTU9wZXJhdGlvbigpO1xyXG4gICAgICAgICAgZmlyZUJlZm9yZUNhbGxiYWNrQXN5bmMoKTtcclxuICAgICAgICAgIGZpcmVBZnRlckNhbGxiYWNrQXN5bmMoKTtcclxuICAgICAgICAgIGNsb3NlQW5pbWF0aW9uKCk7XHJcbiAgICAgICAgICByZXR1cm4gbm9vcENhbmNlbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBuZ0FuaW1hdGVTdGF0ZSAgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSkgfHwge307XHJcbiAgICAgICAgdmFyIHJ1bm5pbmdBbmltYXRpb25zICAgICA9IG5nQW5pbWF0ZVN0YXRlLmFjdGl2ZSB8fCB7fTtcclxuICAgICAgICB2YXIgdG90YWxBY3RpdmVBbmltYXRpb25zID0gbmdBbmltYXRlU3RhdGUudG90YWxBY3RpdmUgfHwgMDtcclxuICAgICAgICB2YXIgbGFzdEFuaW1hdGlvbiAgICAgICAgID0gbmdBbmltYXRlU3RhdGUubGFzdDtcclxuICAgICAgICB2YXIgc2tpcEFuaW1hdGlvbiA9IGZhbHNlO1xyXG5cclxuICAgICAgICBpZiAodG90YWxBY3RpdmVBbmltYXRpb25zID4gMCkge1xyXG4gICAgICAgICAgdmFyIGFuaW1hdGlvbnNUb0NhbmNlbCA9IFtdO1xyXG4gICAgICAgICAgaWYgKCFydW5uZXIuaXNDbGFzc0Jhc2VkKSB7XHJcbiAgICAgICAgICAgIGlmIChhbmltYXRpb25FdmVudCA9PSAnbGVhdmUnICYmIHJ1bm5pbmdBbmltYXRpb25zWyduZy1sZWF2ZSddKSB7XHJcbiAgICAgICAgICAgICAgc2tpcEFuaW1hdGlvbiA9IHRydWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgLy9jYW5jZWwgYWxsIGFuaW1hdGlvbnMgd2hlbiBhIHN0cnVjdHVyYWwgYW5pbWF0aW9uIHRha2VzIHBsYWNlXHJcbiAgICAgICAgICAgICAgZm9yICh2YXIga2xhc3MgaW4gcnVubmluZ0FuaW1hdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGFuaW1hdGlvbnNUb0NhbmNlbC5wdXNoKHJ1bm5pbmdBbmltYXRpb25zW2tsYXNzXSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIG5nQW5pbWF0ZVN0YXRlID0ge307XHJcbiAgICAgICAgICAgICAgY2xlYW51cChlbGVtZW50LCB0cnVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBlbHNlIGlmIChsYXN0QW5pbWF0aW9uLmV2ZW50ID09ICdzZXRDbGFzcycpIHtcclxuICAgICAgICAgICAgYW5pbWF0aW9uc1RvQ2FuY2VsLnB1c2gobGFzdEFuaW1hdGlvbik7XHJcbiAgICAgICAgICAgIGNsZWFudXAoZWxlbWVudCwgY2xhc3NOYW1lKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2UgaWYgKHJ1bm5pbmdBbmltYXRpb25zW2NsYXNzTmFtZV0pIHtcclxuICAgICAgICAgICAgdmFyIGN1cnJlbnQgPSBydW5uaW5nQW5pbWF0aW9uc1tjbGFzc05hbWVdO1xyXG4gICAgICAgICAgICBpZiAoY3VycmVudC5ldmVudCA9PSBhbmltYXRpb25FdmVudCkge1xyXG4gICAgICAgICAgICAgIHNraXBBbmltYXRpb24gPSB0cnVlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIGFuaW1hdGlvbnNUb0NhbmNlbC5wdXNoKGN1cnJlbnQpO1xyXG4gICAgICAgICAgICAgIGNsZWFudXAoZWxlbWVudCwgY2xhc3NOYW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGlmIChhbmltYXRpb25zVG9DYW5jZWwubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3JFYWNoKGFuaW1hdGlvbnNUb0NhbmNlbCwgZnVuY3Rpb24ob3BlcmF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgb3BlcmF0aW9uLmNhbmNlbCgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChydW5uZXIuaXNDbGFzc0Jhc2VkXHJcbiAgICAgICAgICAgICYmICFydW5uZXIuaXNTZXRDbGFzc09wZXJhdGlvblxyXG4gICAgICAgICAgICAmJiBhbmltYXRpb25FdmVudCAhPSAnYW5pbWF0ZSdcclxuICAgICAgICAgICAgJiYgIXNraXBBbmltYXRpb24pIHtcclxuICAgICAgICAgIHNraXBBbmltYXRpb24gPSAoYW5pbWF0aW9uRXZlbnQgPT0gJ2FkZENsYXNzJykgPT0gZWxlbWVudC5oYXNDbGFzcyhjbGFzc05hbWUpOyAvL29wcG9zaXRlIG9mIFhPUlxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHNraXBBbmltYXRpb24pIHtcclxuICAgICAgICAgIGZpcmVET01PcGVyYXRpb24oKTtcclxuICAgICAgICAgIGZpcmVCZWZvcmVDYWxsYmFja0FzeW5jKCk7XHJcbiAgICAgICAgICBmaXJlQWZ0ZXJDYWxsYmFja0FzeW5jKCk7XHJcbiAgICAgICAgICBmaXJlRG9uZUNhbGxiYWNrQXN5bmMoKTtcclxuICAgICAgICAgIHJldHVybiBub29wQ2FuY2VsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcnVubmluZ0FuaW1hdGlvbnMgICAgID0gbmdBbmltYXRlU3RhdGUuYWN0aXZlIHx8IHt9O1xyXG4gICAgICAgIHRvdGFsQWN0aXZlQW5pbWF0aW9ucyA9IG5nQW5pbWF0ZVN0YXRlLnRvdGFsQWN0aXZlIHx8IDA7XHJcblxyXG4gICAgICAgIGlmIChhbmltYXRpb25FdmVudCA9PSAnbGVhdmUnKSB7XHJcbiAgICAgICAgICAvL3RoZXJlJ3Mgbm8gbmVlZCB0byBldmVyIHJlbW92ZSB0aGUgbGlzdGVuZXIgc2luY2UgdGhlIGVsZW1lbnRcclxuICAgICAgICAgIC8vd2lsbCBiZSByZW1vdmVkIChkZXN0cm95ZWQpIGFmdGVyIHRoZSBsZWF2ZSBhbmltYXRpb24gZW5kcyBvclxyXG4gICAgICAgICAgLy9pcyBjYW5jZWxsZWQgbWlkd2F5XHJcbiAgICAgICAgICBlbGVtZW50Lm9uZSgnJGRlc3Ryb3knLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gYW5ndWxhci5lbGVtZW50KHRoaXMpO1xyXG4gICAgICAgICAgICB2YXIgc3RhdGUgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSk7XHJcbiAgICAgICAgICAgIGlmIChzdGF0ZSkge1xyXG4gICAgICAgICAgICAgIHZhciBhY3RpdmVMZWF2ZUFuaW1hdGlvbiA9IHN0YXRlLmFjdGl2ZVsnbmctbGVhdmUnXTtcclxuICAgICAgICAgICAgICBpZiAoYWN0aXZlTGVhdmVBbmltYXRpb24pIHtcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUxlYXZlQW5pbWF0aW9uLmNhbmNlbCgpO1xyXG4gICAgICAgICAgICAgICAgY2xlYW51cChlbGVtZW50LCAnbmctbGVhdmUnKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy90aGUgbmctYW5pbWF0ZSBjbGFzcyBkb2VzIG5vdGhpbmcsIGJ1dCBpdCdzIGhlcmUgdG8gYWxsb3cgZm9yXHJcbiAgICAgICAgLy9wYXJlbnQgYW5pbWF0aW9ucyB0byBmaW5kIGFuZCBjYW5jZWwgY2hpbGQgYW5pbWF0aW9ucyB3aGVuIG5lZWRlZFxyXG4gICAgICAgICQkanFMaXRlLmFkZENsYXNzKGVsZW1lbnQsIE5HX0FOSU1BVEVfQ0xBU1NfTkFNRSk7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy50ZW1wQ2xhc3Nlcykge1xyXG4gICAgICAgICAgZm9yRWFjaChvcHRpb25zLnRlbXBDbGFzc2VzLCBmdW5jdGlvbihjbGFzc05hbWUpIHtcclxuICAgICAgICAgICAgJCRqcUxpdGUuYWRkQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGxvY2FsQW5pbWF0aW9uQ291bnQgPSBnbG9iYWxBbmltYXRpb25Db3VudGVyKys7XHJcbiAgICAgICAgdG90YWxBY3RpdmVBbmltYXRpb25zKys7XHJcbiAgICAgICAgcnVubmluZ0FuaW1hdGlvbnNbY2xhc3NOYW1lXSA9IHJ1bm5lcjtcclxuXHJcbiAgICAgICAgZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUsIHtcclxuICAgICAgICAgIGxhc3Q6IHJ1bm5lcixcclxuICAgICAgICAgIGFjdGl2ZTogcnVubmluZ0FuaW1hdGlvbnMsXHJcbiAgICAgICAgICBpbmRleDogbG9jYWxBbmltYXRpb25Db3VudCxcclxuICAgICAgICAgIHRvdGFsQWN0aXZlOiB0b3RhbEFjdGl2ZUFuaW1hdGlvbnNcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy9maXJzdCB3ZSBydW4gdGhlIGJlZm9yZSBhbmltYXRpb25zIGFuZCB3aGVuIGFsbCBvZiB0aG9zZSBhcmUgY29tcGxldGVcclxuICAgICAgICAvL3RoZW4gd2UgcGVyZm9ybSB0aGUgRE9NIG9wZXJhdGlvbiBhbmQgcnVuIHRoZSBuZXh0IHNldCBvZiBhbmltYXRpb25zXHJcbiAgICAgICAgZmlyZUJlZm9yZUNhbGxiYWNrQXN5bmMoKTtcclxuICAgICAgICBydW5uZXIuYmVmb3JlKGZ1bmN0aW9uKGNhbmNlbGxlZCkge1xyXG4gICAgICAgICAgdmFyIGRhdGEgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSk7XHJcbiAgICAgICAgICBjYW5jZWxsZWQgPSBjYW5jZWxsZWQgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgIWRhdGEgfHwgIWRhdGEuYWN0aXZlW2NsYXNzTmFtZV0gfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKHJ1bm5lci5pc0NsYXNzQmFzZWQgJiYgZGF0YS5hY3RpdmVbY2xhc3NOYW1lXS5ldmVudCAhPSBhbmltYXRpb25FdmVudCk7XHJcblxyXG4gICAgICAgICAgZmlyZURPTU9wZXJhdGlvbigpO1xyXG4gICAgICAgICAgaWYgKGNhbmNlbGxlZCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICBjbG9zZUFuaW1hdGlvbigpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZmlyZUFmdGVyQ2FsbGJhY2tBc3luYygpO1xyXG4gICAgICAgICAgICBydW5uZXIuYWZ0ZXIoY2xvc2VBbmltYXRpb24pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gcnVubmVyLmNhbmNlbDtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZmlyZURPTUNhbGxiYWNrKGFuaW1hdGlvblBoYXNlKSB7XHJcbiAgICAgICAgICB2YXIgZXZlbnROYW1lID0gJyRhbmltYXRlOicgKyBhbmltYXRpb25QaGFzZTtcclxuICAgICAgICAgIGlmIChlbGVtZW50RXZlbnRzICYmIGVsZW1lbnRFdmVudHNbZXZlbnROYW1lXSAmJiBlbGVtZW50RXZlbnRzW2V2ZW50TmFtZV0ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAkJGFzeW5jQ2FsbGJhY2soZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgZWxlbWVudC50cmlnZ2VySGFuZGxlcihldmVudE5hbWUsIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50OiBhbmltYXRpb25FdmVudCxcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogY2xhc3NOYW1lXHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZmlyZUJlZm9yZUNhbGxiYWNrQXN5bmMoKSB7XHJcbiAgICAgICAgICBmaXJlRE9NQ2FsbGJhY2soJ2JlZm9yZScpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZmlyZUFmdGVyQ2FsbGJhY2tBc3luYygpIHtcclxuICAgICAgICAgIGZpcmVET01DYWxsYmFjaygnYWZ0ZXInKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGZpcmVEb25lQ2FsbGJhY2tBc3luYygpIHtcclxuICAgICAgICAgIGZpcmVET01DYWxsYmFjaygnY2xvc2UnKTtcclxuICAgICAgICAgIGRvbmVDYWxsYmFjaygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy9pdCBpcyBsZXNzIGNvbXBsaWNhdGVkIHRvIHVzZSBhIGZsYWcgdGhhbiBtYW5hZ2luZyBhbmQgY2FuY2VsaW5nXHJcbiAgICAgICAgLy90aW1lb3V0cyBjb250YWluaW5nIG11bHRpcGxlIGNhbGxiYWNrcy5cclxuICAgICAgICBmdW5jdGlvbiBmaXJlRE9NT3BlcmF0aW9uKCkge1xyXG4gICAgICAgICAgaWYgKCFmaXJlRE9NT3BlcmF0aW9uLmhhc0JlZW5SdW4pIHtcclxuICAgICAgICAgICAgZmlyZURPTU9wZXJhdGlvbi5oYXNCZWVuUnVuID0gdHJ1ZTtcclxuICAgICAgICAgICAgZG9tT3BlcmF0aW9uKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBjbG9zZUFuaW1hdGlvbigpIHtcclxuICAgICAgICAgIGlmICghY2xvc2VBbmltYXRpb24uaGFzQmVlblJ1bikge1xyXG4gICAgICAgICAgICBpZiAocnVubmVyKSB7IC8vdGhlIHJ1bm5lciBkb2Vzbid0IGV4aXN0IGlmIGl0IGZhaWxzIHRvIGluc3RhbnRpYXRlXHJcbiAgICAgICAgICAgICAgcnVubmVyLmFwcGx5U3R5bGVzKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNsb3NlQW5pbWF0aW9uLmhhc0JlZW5SdW4gPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLnRlbXBDbGFzc2VzKSB7XHJcbiAgICAgICAgICAgICAgZm9yRWFjaChvcHRpb25zLnRlbXBDbGFzc2VzLCBmdW5jdGlvbihjbGFzc05hbWUpIHtcclxuICAgICAgICAgICAgICAgICQkanFMaXRlLnJlbW92ZUNsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSk7XHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUpO1xyXG4gICAgICAgICAgICBpZiAoZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAvKiBvbmx5IHN0cnVjdHVyYWwgYW5pbWF0aW9ucyB3YWl0IGZvciByZWZsb3cgYmVmb3JlIHJlbW92aW5nIGFuXHJcbiAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLCBidXQgY2xhc3MtYmFzZWQgYW5pbWF0aW9ucyBkb24ndC4gQW4gZXhhbXBsZSBvZiB0aGlzXHJcbiAgICAgICAgICAgICAgICAgZmFpbGluZyB3b3VsZCBiZSB3aGVuIGEgcGFyZW50IEhUTUwgdGFnIGhhcyBhIG5nLWNsYXNzIGF0dHJpYnV0ZVxyXG4gICAgICAgICAgICAgICAgIGNhdXNpbmcgQUxMIGRpcmVjdGl2ZXMgYmVsb3cgdG8gc2tpcCBhbmltYXRpb25zIGR1cmluZyB0aGUgZGlnZXN0ICovXHJcbiAgICAgICAgICAgICAgaWYgKHJ1bm5lciAmJiBydW5uZXIuaXNDbGFzc0Jhc2VkKSB7XHJcbiAgICAgICAgICAgICAgICBjbGVhbnVwKGVsZW1lbnQsIGNsYXNzTmFtZSk7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICQkYXN5bmNDYWxsYmFjayhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSkgfHwge307XHJcbiAgICAgICAgICAgICAgICAgIGlmIChsb2NhbEFuaW1hdGlvbkNvdW50ID09IGRhdGEuaW5kZXgpIHtcclxuICAgICAgICAgICAgICAgICAgICBjbGVhbnVwKGVsZW1lbnQsIGNsYXNzTmFtZSwgYW5pbWF0aW9uRXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFLCBkYXRhKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZmlyZURvbmVDYWxsYmFja0FzeW5jKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBjYW5jZWxDaGlsZEFuaW1hdGlvbnMoZWxlbWVudCkge1xyXG4gICAgICAgIHZhciBub2RlID0gZXh0cmFjdEVsZW1lbnROb2RlKGVsZW1lbnQpO1xyXG4gICAgICAgIGlmIChub2RlKSB7XHJcbiAgICAgICAgICB2YXIgbm9kZXMgPSBhbmd1bGFyLmlzRnVuY3Rpb24obm9kZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKSA/XHJcbiAgICAgICAgICAgIG5vZGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShOR19BTklNQVRFX0NMQVNTX05BTUUpIDpcclxuICAgICAgICAgICAgbm9kZS5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIE5HX0FOSU1BVEVfQ0xBU1NfTkFNRSk7XHJcbiAgICAgICAgICBmb3JFYWNoKG5vZGVzLCBmdW5jdGlvbihlbGVtZW50KSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudCk7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUpO1xyXG4gICAgICAgICAgICBpZiAoZGF0YSAmJiBkYXRhLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICAgIGZvckVhY2goZGF0YS5hY3RpdmUsIGZ1bmN0aW9uKHJ1bm5lcikge1xyXG4gICAgICAgICAgICAgICAgcnVubmVyLmNhbmNlbCgpO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGNsZWFudXAoZWxlbWVudCwgY2xhc3NOYW1lKSB7XHJcbiAgICAgICAgaWYgKGlzTWF0Y2hpbmdFbGVtZW50KGVsZW1lbnQsICRyb290RWxlbWVudCkpIHtcclxuICAgICAgICAgIGlmICghcm9vdEFuaW1hdGVTdGF0ZS5kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICByb290QW5pbWF0ZVN0YXRlLnJ1bm5pbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgcm9vdEFuaW1hdGVTdGF0ZS5zdHJ1Y3R1cmFsID0gZmFsc2U7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmIChjbGFzc05hbWUpIHtcclxuICAgICAgICAgIHZhciBkYXRhID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUpIHx8IHt9O1xyXG5cclxuICAgICAgICAgIHZhciByZW1vdmVBbmltYXRpb25zID0gY2xhc3NOYW1lID09PSB0cnVlO1xyXG4gICAgICAgICAgaWYgKCFyZW1vdmVBbmltYXRpb25zICYmIGRhdGEuYWN0aXZlICYmIGRhdGEuYWN0aXZlW2NsYXNzTmFtZV0pIHtcclxuICAgICAgICAgICAgZGF0YS50b3RhbEFjdGl2ZS0tO1xyXG4gICAgICAgICAgICBkZWxldGUgZGF0YS5hY3RpdmVbY2xhc3NOYW1lXTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBpZiAocmVtb3ZlQW5pbWF0aW9ucyB8fCAhZGF0YS50b3RhbEFjdGl2ZSkge1xyXG4gICAgICAgICAgICAkJGpxTGl0ZS5yZW1vdmVDbGFzcyhlbGVtZW50LCBOR19BTklNQVRFX0NMQVNTX05BTUUpO1xyXG4gICAgICAgICAgICBlbGVtZW50LnJlbW92ZURhdGEoTkdfQU5JTUFURV9TVEFURSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBhbmltYXRpb25zRGlzYWJsZWQoZWxlbWVudCwgcGFyZW50RWxlbWVudCkge1xyXG4gICAgICAgIGlmIChyb290QW5pbWF0ZVN0YXRlLmRpc2FibGVkKSB7XHJcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChpc01hdGNoaW5nRWxlbWVudChlbGVtZW50LCAkcm9vdEVsZW1lbnQpKSB7XHJcbiAgICAgICAgICByZXR1cm4gcm9vdEFuaW1hdGVTdGF0ZS5ydW5uaW5nO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGFsbG93Q2hpbGRBbmltYXRpb25zLCBwYXJlbnRSdW5uaW5nQW5pbWF0aW9uLCBoYXNQYXJlbnQ7XHJcbiAgICAgICAgZG8ge1xyXG4gICAgICAgICAgLy90aGUgZWxlbWVudCBkaWQgbm90IHJlYWNoIHRoZSByb290IGVsZW1lbnQgd2hpY2ggbWVhbnMgdGhhdCBpdFxyXG4gICAgICAgICAgLy9pcyBub3QgYXBhcnQgb2YgdGhlIERPTS4gVGhlcmVmb3JlIHRoZXJlIGlzIG5vIHJlYXNvbiB0byBkb1xyXG4gICAgICAgICAgLy9hbnkgYW5pbWF0aW9ucyBvbiBpdFxyXG4gICAgICAgICAgaWYgKHBhcmVudEVsZW1lbnQubGVuZ3RoID09PSAwKSBicmVhaztcclxuXHJcbiAgICAgICAgICB2YXIgaXNSb290ID0gaXNNYXRjaGluZ0VsZW1lbnQocGFyZW50RWxlbWVudCwgJHJvb3RFbGVtZW50KTtcclxuICAgICAgICAgIHZhciBzdGF0ZSA9IGlzUm9vdCA/IHJvb3RBbmltYXRlU3RhdGUgOiAocGFyZW50RWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUpIHx8IHt9KTtcclxuICAgICAgICAgIGlmIChzdGF0ZS5kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvL25vIG1hdHRlciB3aGF0LCBmb3IgYW4gYW5pbWF0aW9uIHRvIHdvcmsgaXQgbXVzdCByZWFjaCB0aGUgcm9vdCBlbGVtZW50XHJcbiAgICAgICAgICAvL3RoaXMgaW1wbGllcyB0aGF0IHRoZSBlbGVtZW50IGlzIGF0dGFjaGVkIHRvIHRoZSBET00gd2hlbiB0aGUgYW5pbWF0aW9uIGlzIHJ1blxyXG4gICAgICAgICAgaWYgKGlzUm9vdCkge1xyXG4gICAgICAgICAgICBoYXNQYXJlbnQgPSB0cnVlO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC8vb25jZSBhIGZsYWcgaXMgZm91bmQgdGhhdCBpcyBzdHJpY3RseSBmYWxzZSB0aGVuIGV2ZXJ5dGhpbmcgYmVmb3JlXHJcbiAgICAgICAgICAvL2l0IHdpbGwgYmUgZGlzY2FyZGVkIGFuZCBhbGwgY2hpbGQgYW5pbWF0aW9ucyB3aWxsIGJlIHJlc3RyaWN0ZWRcclxuICAgICAgICAgIGlmIChhbGxvd0NoaWxkQW5pbWF0aW9ucyAhPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgdmFyIGFuaW1hdGVDaGlsZHJlbkZsYWcgPSBwYXJlbnRFbGVtZW50LmRhdGEoTkdfQU5JTUFURV9DSElMRFJFTik7XHJcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChhbmltYXRlQ2hpbGRyZW5GbGFnKSkge1xyXG4gICAgICAgICAgICAgIGFsbG93Q2hpbGRBbmltYXRpb25zID0gYW5pbWF0ZUNoaWxkcmVuRmxhZztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIHBhcmVudFJ1bm5pbmdBbmltYXRpb24gPSBwYXJlbnRSdW5uaW5nQW5pbWF0aW9uIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUucnVubmluZyB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChzdGF0ZS5sYXN0ICYmICFzdGF0ZS5sYXN0LmlzQ2xhc3NCYXNlZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHdoaWxlIChwYXJlbnRFbGVtZW50ID0gcGFyZW50RWxlbWVudC5wYXJlbnQoKSk7XHJcblxyXG4gICAgICAgIHJldHVybiAhaGFzUGFyZW50IHx8ICghYWxsb3dDaGlsZEFuaW1hdGlvbnMgJiYgcGFyZW50UnVubmluZ0FuaW1hdGlvbik7XHJcbiAgICAgIH1cclxuICAgIH1dKTtcclxuXHJcbiAgICAkYW5pbWF0ZVByb3ZpZGVyLnJlZ2lzdGVyKCcnLCBbJyR3aW5kb3cnLCAnJHNuaWZmZXInLCAnJHRpbWVvdXQnLCAnJCRhbmltYXRlUmVmbG93JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oJHdpbmRvdywgICAkc25pZmZlciwgICAkdGltZW91dCwgICAkJGFuaW1hdGVSZWZsb3cpIHtcclxuICAgICAgLy8gRGV0ZWN0IHByb3BlciB0cmFuc2l0aW9uZW5kL2FuaW1hdGlvbmVuZCBldmVudCBuYW1lcy5cclxuICAgICAgdmFyIENTU19QUkVGSVggPSAnJywgVFJBTlNJVElPTl9QUk9QLCBUUkFOU0lUSU9ORU5EX0VWRU5ULCBBTklNQVRJT05fUFJPUCwgQU5JTUFUSU9ORU5EX0VWRU5UO1xyXG5cclxuICAgICAgLy8gSWYgdW5wcmVmaXhlZCBldmVudHMgYXJlIG5vdCBzdXBwb3J0ZWQgYnV0IHdlYmtpdC1wcmVmaXhlZCBhcmUsIHVzZSB0aGUgbGF0dGVyLlxyXG4gICAgICAvLyBPdGhlcndpc2UsIGp1c3QgdXNlIFczQyBuYW1lcywgYnJvd3NlcnMgbm90IHN1cHBvcnRpbmcgdGhlbSBhdCBhbGwgd2lsbCBqdXN0IGlnbm9yZSB0aGVtLlxyXG4gICAgICAvLyBOb3RlOiBDaHJvbWUgaW1wbGVtZW50cyBgd2luZG93Lm9ud2Via2l0YW5pbWF0aW9uZW5kYCBhbmQgZG9lc24ndCBpbXBsZW1lbnQgYHdpbmRvdy5vbmFuaW1hdGlvbmVuZGBcclxuICAgICAgLy8gYnV0IGF0IHRoZSBzYW1lIHRpbWUgZGlzcGF0Y2hlcyB0aGUgYGFuaW1hdGlvbmVuZGAgZXZlbnQgYW5kIG5vdCBgd2Via2l0QW5pbWF0aW9uRW5kYC5cclxuICAgICAgLy8gUmVnaXN0ZXIgYm90aCBldmVudHMgaW4gY2FzZSBgd2luZG93Lm9uYW5pbWF0aW9uZW5kYCBpcyBub3Qgc3VwcG9ydGVkIGJlY2F1c2Ugb2YgdGhhdCxcclxuICAgICAgLy8gZG8gdGhlIHNhbWUgZm9yIGB0cmFuc2l0aW9uZW5kYCBhcyBTYWZhcmkgaXMgbGlrZWx5IHRvIGV4aGliaXQgc2ltaWxhciBiZWhhdmlvci5cclxuICAgICAgLy8gQWxzbywgdGhlIG9ubHkgbW9kZXJuIGJyb3dzZXIgdGhhdCB1c2VzIHZlbmRvciBwcmVmaXhlcyBmb3IgdHJhbnNpdGlvbnMva2V5ZnJhbWVzIGlzIHdlYmtpdFxyXG4gICAgICAvLyB0aGVyZWZvcmUgdGhlcmUgaXMgbm8gcmVhc29uIHRvIHRlc3QgYW55bW9yZSBmb3Igb3RoZXIgdmVuZG9yIHByZWZpeGVzOiBodHRwOi8vY2FuaXVzZS5jb20vI3NlYXJjaD10cmFuc2l0aW9uXHJcbiAgICAgIGlmICh3aW5kb3cub250cmFuc2l0aW9uZW5kID09PSB1bmRlZmluZWQgJiYgd2luZG93Lm9ud2Via2l0dHJhbnNpdGlvbmVuZCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgQ1NTX1BSRUZJWCA9ICctd2Via2l0LSc7XHJcbiAgICAgICAgVFJBTlNJVElPTl9QUk9QID0gJ1dlYmtpdFRyYW5zaXRpb24nO1xyXG4gICAgICAgIFRSQU5TSVRJT05FTkRfRVZFTlQgPSAnd2Via2l0VHJhbnNpdGlvbkVuZCB0cmFuc2l0aW9uZW5kJztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBUUkFOU0lUSU9OX1BST1AgPSAndHJhbnNpdGlvbic7XHJcbiAgICAgICAgVFJBTlNJVElPTkVORF9FVkVOVCA9ICd0cmFuc2l0aW9uZW5kJztcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKHdpbmRvdy5vbmFuaW1hdGlvbmVuZCA9PT0gdW5kZWZpbmVkICYmIHdpbmRvdy5vbndlYmtpdGFuaW1hdGlvbmVuZCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgQ1NTX1BSRUZJWCA9ICctd2Via2l0LSc7XHJcbiAgICAgICAgQU5JTUFUSU9OX1BST1AgPSAnV2Via2l0QW5pbWF0aW9uJztcclxuICAgICAgICBBTklNQVRJT05FTkRfRVZFTlQgPSAnd2Via2l0QW5pbWF0aW9uRW5kIGFuaW1hdGlvbmVuZCc7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgQU5JTUFUSU9OX1BST1AgPSAnYW5pbWF0aW9uJztcclxuICAgICAgICBBTklNQVRJT05FTkRfRVZFTlQgPSAnYW5pbWF0aW9uZW5kJztcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIERVUkFUSU9OX0tFWSA9ICdEdXJhdGlvbic7XHJcbiAgICAgIHZhciBQUk9QRVJUWV9LRVkgPSAnUHJvcGVydHknO1xyXG4gICAgICB2YXIgREVMQVlfS0VZID0gJ0RlbGF5JztcclxuICAgICAgdmFyIEFOSU1BVElPTl9JVEVSQVRJT05fQ09VTlRfS0VZID0gJ0l0ZXJhdGlvbkNvdW50JztcclxuICAgICAgdmFyIEFOSU1BVElPTl9QTEFZU1RBVEVfS0VZID0gJ1BsYXlTdGF0ZSc7XHJcbiAgICAgIHZhciBOR19BTklNQVRFX1BBUkVOVF9LRVkgPSAnJCRuZ0FuaW1hdGVLZXknO1xyXG4gICAgICB2YXIgTkdfQU5JTUFURV9DU1NfREFUQV9LRVkgPSAnJCRuZ0FuaW1hdGVDU1MzRGF0YSc7XHJcbiAgICAgIHZhciBFTEFQU0VEX1RJTUVfTUFYX0RFQ0lNQUxfUExBQ0VTID0gMztcclxuICAgICAgdmFyIENMT1NJTkdfVElNRV9CVUZGRVIgPSAxLjU7XHJcbiAgICAgIHZhciBPTkVfU0VDT05EID0gMTAwMDtcclxuXHJcbiAgICAgIHZhciBsb29rdXBDYWNoZSA9IHt9O1xyXG4gICAgICB2YXIgcGFyZW50Q291bnRlciA9IDA7XHJcbiAgICAgIHZhciBhbmltYXRpb25SZWZsb3dRdWV1ZSA9IFtdO1xyXG4gICAgICB2YXIgY2FuY2VsQW5pbWF0aW9uUmVmbG93O1xyXG4gICAgICBmdW5jdGlvbiBjbGVhckNhY2hlQWZ0ZXJSZWZsb3coKSB7XHJcbiAgICAgICAgaWYgKCFjYW5jZWxBbmltYXRpb25SZWZsb3cpIHtcclxuICAgICAgICAgIGNhbmNlbEFuaW1hdGlvblJlZmxvdyA9ICQkYW5pbWF0ZVJlZmxvdyhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgYW5pbWF0aW9uUmVmbG93UXVldWUgPSBbXTtcclxuICAgICAgICAgICAgY2FuY2VsQW5pbWF0aW9uUmVmbG93ID0gbnVsbDtcclxuICAgICAgICAgICAgbG9va3VwQ2FjaGUgPSB7fTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gYWZ0ZXJSZWZsb3coZWxlbWVudCwgY2FsbGJhY2spIHtcclxuICAgICAgICBpZiAoY2FuY2VsQW5pbWF0aW9uUmVmbG93KSB7XHJcbiAgICAgICAgICBjYW5jZWxBbmltYXRpb25SZWZsb3coKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYW5pbWF0aW9uUmVmbG93UXVldWUucHVzaChjYWxsYmFjayk7XHJcbiAgICAgICAgY2FuY2VsQW5pbWF0aW9uUmVmbG93ID0gJCRhbmltYXRlUmVmbG93KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgZm9yRWFjaChhbmltYXRpb25SZWZsb3dRdWV1ZSwgZnVuY3Rpb24oZm4pIHtcclxuICAgICAgICAgICAgZm4oKTtcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIGFuaW1hdGlvblJlZmxvd1F1ZXVlID0gW107XHJcbiAgICAgICAgICBjYW5jZWxBbmltYXRpb25SZWZsb3cgPSBudWxsO1xyXG4gICAgICAgICAgbG9va3VwQ2FjaGUgPSB7fTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIGNsb3NpbmdUaW1lciA9IG51bGw7XHJcbiAgICAgIHZhciBjbG9zaW5nVGltZXN0YW1wID0gMDtcclxuICAgICAgdmFyIGFuaW1hdGlvbkVsZW1lbnRRdWV1ZSA9IFtdO1xyXG4gICAgICBmdW5jdGlvbiBhbmltYXRpb25DbG9zZUhhbmRsZXIoZWxlbWVudCwgdG90YWxUaW1lKSB7XHJcbiAgICAgICAgdmFyIG5vZGUgPSBleHRyYWN0RWxlbWVudE5vZGUoZWxlbWVudCk7XHJcbiAgICAgICAgZWxlbWVudCA9IGFuZ3VsYXIuZWxlbWVudChub2RlKTtcclxuXHJcbiAgICAgICAgLy90aGlzIGl0ZW0gd2lsbCBiZSBnYXJiYWdlIGNvbGxlY3RlZCBieSB0aGUgY2xvc2luZ1xyXG4gICAgICAgIC8vYW5pbWF0aW9uIHRpbWVvdXRcclxuICAgICAgICBhbmltYXRpb25FbGVtZW50UXVldWUucHVzaChlbGVtZW50KTtcclxuXHJcbiAgICAgICAgLy9idXQgaXQgbWF5IG5vdCBuZWVkIHRvIGNhbmNlbCBvdXQgdGhlIGV4aXN0aW5nIHRpbWVvdXRcclxuICAgICAgICAvL2lmIHRoZSB0aW1lc3RhbXAgaXMgbGVzcyB0aGFuIHRoZSBwcmV2aW91cyBvbmVcclxuICAgICAgICB2YXIgZnV0dXJlVGltZXN0YW1wID0gRGF0ZS5ub3coKSArIHRvdGFsVGltZTtcclxuICAgICAgICBpZiAoZnV0dXJlVGltZXN0YW1wIDw9IGNsb3NpbmdUaW1lc3RhbXApIHtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICR0aW1lb3V0LmNhbmNlbChjbG9zaW5nVGltZXIpO1xyXG5cclxuICAgICAgICBjbG9zaW5nVGltZXN0YW1wID0gZnV0dXJlVGltZXN0YW1wO1xyXG4gICAgICAgIGNsb3NpbmdUaW1lciA9ICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgY2xvc2VBbGxBbmltYXRpb25zKGFuaW1hdGlvbkVsZW1lbnRRdWV1ZSk7XHJcbiAgICAgICAgICBhbmltYXRpb25FbGVtZW50UXVldWUgPSBbXTtcclxuICAgICAgICB9LCB0b3RhbFRpbWUsIGZhbHNlKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gY2xvc2VBbGxBbmltYXRpb25zKGVsZW1lbnRzKSB7XHJcbiAgICAgICAgZm9yRWFjaChlbGVtZW50cywgZnVuY3Rpb24oZWxlbWVudCkge1xyXG4gICAgICAgICAgdmFyIGVsZW1lbnREYXRhID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfQ1NTX0RBVEFfS0VZKTtcclxuICAgICAgICAgIGlmIChlbGVtZW50RGF0YSkge1xyXG4gICAgICAgICAgICBmb3JFYWNoKGVsZW1lbnREYXRhLmNsb3NlQW5pbWF0aW9uRm5zLCBmdW5jdGlvbihmbikge1xyXG4gICAgICAgICAgICAgIGZuKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBnZXRFbGVtZW50QW5pbWF0aW9uRGV0YWlscyhlbGVtZW50LCBjYWNoZUtleSkge1xyXG4gICAgICAgIHZhciBkYXRhID0gY2FjaGVLZXkgPyBsb29rdXBDYWNoZVtjYWNoZUtleV0gOiBudWxsO1xyXG4gICAgICAgIGlmICghZGF0YSkge1xyXG4gICAgICAgICAgdmFyIHRyYW5zaXRpb25EdXJhdGlvbiA9IDA7XHJcbiAgICAgICAgICB2YXIgdHJhbnNpdGlvbkRlbGF5ID0gMDtcclxuICAgICAgICAgIHZhciBhbmltYXRpb25EdXJhdGlvbiA9IDA7XHJcbiAgICAgICAgICB2YXIgYW5pbWF0aW9uRGVsYXkgPSAwO1xyXG5cclxuICAgICAgICAgIC8vd2Ugd2FudCBhbGwgdGhlIHN0eWxlcyBkZWZpbmVkIGJlZm9yZSBhbmQgYWZ0ZXJcclxuICAgICAgICAgIGZvckVhY2goZWxlbWVudCwgZnVuY3Rpb24oZWxlbWVudCkge1xyXG4gICAgICAgICAgICBpZiAoZWxlbWVudC5ub2RlVHlwZSA9PSBFTEVNRU5UX05PREUpIHtcclxuICAgICAgICAgICAgICB2YXIgZWxlbWVudFN0eWxlcyA9ICR3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KSB8fCB7fTtcclxuXHJcbiAgICAgICAgICAgICAgdmFyIHRyYW5zaXRpb25EdXJhdGlvblN0eWxlID0gZWxlbWVudFN0eWxlc1tUUkFOU0lUSU9OX1BST1AgKyBEVVJBVElPTl9LRVldO1xyXG4gICAgICAgICAgICAgIHRyYW5zaXRpb25EdXJhdGlvbiA9IE1hdGgubWF4KHBhcnNlTWF4VGltZSh0cmFuc2l0aW9uRHVyYXRpb25TdHlsZSksIHRyYW5zaXRpb25EdXJhdGlvbik7XHJcblxyXG4gICAgICAgICAgICAgIHZhciB0cmFuc2l0aW9uRGVsYXlTdHlsZSA9IGVsZW1lbnRTdHlsZXNbVFJBTlNJVElPTl9QUk9QICsgREVMQVlfS0VZXTtcclxuICAgICAgICAgICAgICB0cmFuc2l0aW9uRGVsYXkgID0gTWF0aC5tYXgocGFyc2VNYXhUaW1lKHRyYW5zaXRpb25EZWxheVN0eWxlKSwgdHJhbnNpdGlvbkRlbGF5KTtcclxuXHJcbiAgICAgICAgICAgICAgdmFyIGFuaW1hdGlvbkRlbGF5U3R5bGUgPSBlbGVtZW50U3R5bGVzW0FOSU1BVElPTl9QUk9QICsgREVMQVlfS0VZXTtcclxuICAgICAgICAgICAgICBhbmltYXRpb25EZWxheSAgID0gTWF0aC5tYXgocGFyc2VNYXhUaW1lKGVsZW1lbnRTdHlsZXNbQU5JTUFUSU9OX1BST1AgKyBERUxBWV9LRVldKSwgYW5pbWF0aW9uRGVsYXkpO1xyXG5cclxuICAgICAgICAgICAgICB2YXIgYUR1cmF0aW9uICA9IHBhcnNlTWF4VGltZShlbGVtZW50U3R5bGVzW0FOSU1BVElPTl9QUk9QICsgRFVSQVRJT05fS0VZXSk7XHJcblxyXG4gICAgICAgICAgICAgIGlmIChhRHVyYXRpb24gPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBhRHVyYXRpb24gKj0gcGFyc2VJbnQoZWxlbWVudFN0eWxlc1tBTklNQVRJT05fUFJPUCArIEFOSU1BVElPTl9JVEVSQVRJT05fQ09VTlRfS0VZXSwgMTApIHx8IDE7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGFuaW1hdGlvbkR1cmF0aW9uID0gTWF0aC5tYXgoYUR1cmF0aW9uLCBhbmltYXRpb25EdXJhdGlvbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgZGF0YSA9IHtcclxuICAgICAgICAgICAgdG90YWw6IDAsXHJcbiAgICAgICAgICAgIHRyYW5zaXRpb25EZWxheTogdHJhbnNpdGlvbkRlbGF5LFxyXG4gICAgICAgICAgICB0cmFuc2l0aW9uRHVyYXRpb246IHRyYW5zaXRpb25EdXJhdGlvbixcclxuICAgICAgICAgICAgYW5pbWF0aW9uRGVsYXk6IGFuaW1hdGlvbkRlbGF5LFxyXG4gICAgICAgICAgICBhbmltYXRpb25EdXJhdGlvbjogYW5pbWF0aW9uRHVyYXRpb25cclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICBpZiAoY2FjaGVLZXkpIHtcclxuICAgICAgICAgICAgbG9va3VwQ2FjaGVbY2FjaGVLZXldID0gZGF0YTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIHBhcnNlTWF4VGltZShzdHIpIHtcclxuICAgICAgICB2YXIgbWF4VmFsdWUgPSAwO1xyXG4gICAgICAgIHZhciB2YWx1ZXMgPSBpc1N0cmluZyhzdHIpID9cclxuICAgICAgICAgIHN0ci5zcGxpdCgvXFxzKixcXHMqLykgOlxyXG4gICAgICAgICAgW107XHJcbiAgICAgICAgZm9yRWFjaCh2YWx1ZXMsIGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgICBtYXhWYWx1ZSA9IE1hdGgubWF4KHBhcnNlRmxvYXQodmFsdWUpIHx8IDAsIG1heFZhbHVlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gbWF4VmFsdWU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGdldENhY2hlS2V5KGVsZW1lbnQpIHtcclxuICAgICAgICB2YXIgcGFyZW50RWxlbWVudCA9IGVsZW1lbnQucGFyZW50KCk7XHJcbiAgICAgICAgdmFyIHBhcmVudElEID0gcGFyZW50RWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfUEFSRU5UX0tFWSk7XHJcbiAgICAgICAgaWYgKCFwYXJlbnRJRCkge1xyXG4gICAgICAgICAgcGFyZW50RWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfUEFSRU5UX0tFWSwgKytwYXJlbnRDb3VudGVyKTtcclxuICAgICAgICAgIHBhcmVudElEID0gcGFyZW50Q291bnRlcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHBhcmVudElEICsgJy0nICsgZXh0cmFjdEVsZW1lbnROb2RlKGVsZW1lbnQpLmdldEF0dHJpYnV0ZSgnY2xhc3MnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gYW5pbWF0ZVNldHVwKGFuaW1hdGlvbkV2ZW50LCBlbGVtZW50LCBjbGFzc05hbWUsIHN0eWxlcykge1xyXG4gICAgICAgIHZhciBzdHJ1Y3R1cmFsID0gWyduZy1lbnRlcicsJ25nLWxlYXZlJywnbmctbW92ZSddLmluZGV4T2YoY2xhc3NOYW1lKSA+PSAwO1xyXG5cclxuICAgICAgICB2YXIgY2FjaGVLZXkgPSBnZXRDYWNoZUtleShlbGVtZW50KTtcclxuICAgICAgICB2YXIgZXZlbnRDYWNoZUtleSA9IGNhY2hlS2V5ICsgJyAnICsgY2xhc3NOYW1lO1xyXG4gICAgICAgIHZhciBpdGVtSW5kZXggPSBsb29rdXBDYWNoZVtldmVudENhY2hlS2V5XSA/ICsrbG9va3VwQ2FjaGVbZXZlbnRDYWNoZUtleV0udG90YWwgOiAwO1xyXG5cclxuICAgICAgICB2YXIgc3RhZ2dlciA9IHt9O1xyXG4gICAgICAgIGlmIChpdGVtSW5kZXggPiAwKSB7XHJcbiAgICAgICAgICB2YXIgc3RhZ2dlckNsYXNzTmFtZSA9IGNsYXNzTmFtZSArICctc3RhZ2dlcic7XHJcbiAgICAgICAgICB2YXIgc3RhZ2dlckNhY2hlS2V5ID0gY2FjaGVLZXkgKyAnICcgKyBzdGFnZ2VyQ2xhc3NOYW1lO1xyXG4gICAgICAgICAgdmFyIGFwcGx5Q2xhc3NlcyA9ICFsb29rdXBDYWNoZVtzdGFnZ2VyQ2FjaGVLZXldO1xyXG5cclxuICAgICAgICAgIGFwcGx5Q2xhc3NlcyAmJiAkJGpxTGl0ZS5hZGRDbGFzcyhlbGVtZW50LCBzdGFnZ2VyQ2xhc3NOYW1lKTtcclxuXHJcbiAgICAgICAgICBzdGFnZ2VyID0gZ2V0RWxlbWVudEFuaW1hdGlvbkRldGFpbHMoZWxlbWVudCwgc3RhZ2dlckNhY2hlS2V5KTtcclxuXHJcbiAgICAgICAgICBhcHBseUNsYXNzZXMgJiYgJCRqcUxpdGUucmVtb3ZlQ2xhc3MoZWxlbWVudCwgc3RhZ2dlckNsYXNzTmFtZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkJGpxTGl0ZS5hZGRDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUpO1xyXG5cclxuICAgICAgICB2YXIgZm9ybWVyRGF0YSA9IGVsZW1lbnQuZGF0YShOR19BTklNQVRFX0NTU19EQVRBX0tFWSkgfHwge307XHJcbiAgICAgICAgdmFyIHRpbWluZ3MgPSBnZXRFbGVtZW50QW5pbWF0aW9uRGV0YWlscyhlbGVtZW50LCBldmVudENhY2hlS2V5KTtcclxuICAgICAgICB2YXIgdHJhbnNpdGlvbkR1cmF0aW9uID0gdGltaW5ncy50cmFuc2l0aW9uRHVyYXRpb247XHJcbiAgICAgICAgdmFyIGFuaW1hdGlvbkR1cmF0aW9uID0gdGltaW5ncy5hbmltYXRpb25EdXJhdGlvbjtcclxuXHJcbiAgICAgICAgaWYgKHN0cnVjdHVyYWwgJiYgdHJhbnNpdGlvbkR1cmF0aW9uID09PSAwICYmIGFuaW1hdGlvbkR1cmF0aW9uID09PSAwKSB7XHJcbiAgICAgICAgICAkJGpxTGl0ZS5yZW1vdmVDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUpO1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGJsb2NrVHJhbnNpdGlvbiA9IHN0eWxlcyB8fCAoc3RydWN0dXJhbCAmJiB0cmFuc2l0aW9uRHVyYXRpb24gPiAwKTtcclxuICAgICAgICB2YXIgYmxvY2tBbmltYXRpb24gPSBhbmltYXRpb25EdXJhdGlvbiA+IDAgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFnZ2VyLmFuaW1hdGlvbkRlbGF5ID4gMCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWdnZXIuYW5pbWF0aW9uRHVyYXRpb24gPT09IDA7XHJcblxyXG4gICAgICAgIHZhciBjbG9zZUFuaW1hdGlvbkZucyA9IGZvcm1lckRhdGEuY2xvc2VBbmltYXRpb25GbnMgfHwgW107XHJcbiAgICAgICAgZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfQ1NTX0RBVEFfS0VZLCB7XHJcbiAgICAgICAgICBzdGFnZ2VyOiBzdGFnZ2VyLFxyXG4gICAgICAgICAgY2FjaGVLZXk6IGV2ZW50Q2FjaGVLZXksXHJcbiAgICAgICAgICBydW5uaW5nOiBmb3JtZXJEYXRhLnJ1bm5pbmcgfHwgMCxcclxuICAgICAgICAgIGl0ZW1JbmRleDogaXRlbUluZGV4LFxyXG4gICAgICAgICAgYmxvY2tUcmFuc2l0aW9uOiBibG9ja1RyYW5zaXRpb24sXHJcbiAgICAgICAgICBjbG9zZUFuaW1hdGlvbkZuczogY2xvc2VBbmltYXRpb25GbnNcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdmFyIG5vZGUgPSBleHRyYWN0RWxlbWVudE5vZGUoZWxlbWVudCk7XHJcblxyXG4gICAgICAgIGlmIChibG9ja1RyYW5zaXRpb24pIHtcclxuICAgICAgICAgIGJsb2NrVHJhbnNpdGlvbnMobm9kZSwgdHJ1ZSk7XHJcbiAgICAgICAgICBpZiAoc3R5bGVzKSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuY3NzKHN0eWxlcyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoYmxvY2tBbmltYXRpb24pIHtcclxuICAgICAgICAgIGJsb2NrQW5pbWF0aW9ucyhub2RlLCB0cnVlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBhbmltYXRlUnVuKGFuaW1hdGlvbkV2ZW50LCBlbGVtZW50LCBjbGFzc05hbWUsIGFjdGl2ZUFuaW1hdGlvbkNvbXBsZXRlLCBzdHlsZXMpIHtcclxuICAgICAgICB2YXIgbm9kZSA9IGV4dHJhY3RFbGVtZW50Tm9kZShlbGVtZW50KTtcclxuICAgICAgICB2YXIgZWxlbWVudERhdGEgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9DU1NfREFUQV9LRVkpO1xyXG4gICAgICAgIGlmIChub2RlLmdldEF0dHJpYnV0ZSgnY2xhc3MnKS5pbmRleE9mKGNsYXNzTmFtZSkgPT0gLTEgfHwgIWVsZW1lbnREYXRhKSB7XHJcbiAgICAgICAgICBhY3RpdmVBbmltYXRpb25Db21wbGV0ZSgpO1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGFjdGl2ZUNsYXNzTmFtZSA9ICcnO1xyXG4gICAgICAgIHZhciBwZW5kaW5nQ2xhc3NOYW1lID0gJyc7XHJcbiAgICAgICAgZm9yRWFjaChjbGFzc05hbWUuc3BsaXQoJyAnKSwgZnVuY3Rpb24oa2xhc3MsIGkpIHtcclxuICAgICAgICAgIHZhciBwcmVmaXggPSAoaSA+IDAgPyAnICcgOiAnJykgKyBrbGFzcztcclxuICAgICAgICAgIGFjdGl2ZUNsYXNzTmFtZSArPSBwcmVmaXggKyAnLWFjdGl2ZSc7XHJcbiAgICAgICAgICBwZW5kaW5nQ2xhc3NOYW1lICs9IHByZWZpeCArICctcGVuZGluZyc7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHZhciBzdHlsZSA9ICcnO1xyXG4gICAgICAgIHZhciBhcHBsaWVkU3R5bGVzID0gW107XHJcbiAgICAgICAgdmFyIGl0ZW1JbmRleCA9IGVsZW1lbnREYXRhLml0ZW1JbmRleDtcclxuICAgICAgICB2YXIgc3RhZ2dlciA9IGVsZW1lbnREYXRhLnN0YWdnZXI7XHJcbiAgICAgICAgdmFyIHN0YWdnZXJUaW1lID0gMDtcclxuICAgICAgICBpZiAoaXRlbUluZGV4ID4gMCkge1xyXG4gICAgICAgICAgdmFyIHRyYW5zaXRpb25TdGFnZ2VyRGVsYXkgPSAwO1xyXG4gICAgICAgICAgaWYgKHN0YWdnZXIudHJhbnNpdGlvbkRlbGF5ID4gMCAmJiBzdGFnZ2VyLnRyYW5zaXRpb25EdXJhdGlvbiA9PT0gMCkge1xyXG4gICAgICAgICAgICB0cmFuc2l0aW9uU3RhZ2dlckRlbGF5ID0gc3RhZ2dlci50cmFuc2l0aW9uRGVsYXkgKiBpdGVtSW5kZXg7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgdmFyIGFuaW1hdGlvblN0YWdnZXJEZWxheSA9IDA7XHJcbiAgICAgICAgICBpZiAoc3RhZ2dlci5hbmltYXRpb25EZWxheSA+IDAgJiYgc3RhZ2dlci5hbmltYXRpb25EdXJhdGlvbiA9PT0gMCkge1xyXG4gICAgICAgICAgICBhbmltYXRpb25TdGFnZ2VyRGVsYXkgPSBzdGFnZ2VyLmFuaW1hdGlvbkRlbGF5ICogaXRlbUluZGV4O1xyXG4gICAgICAgICAgICBhcHBsaWVkU3R5bGVzLnB1c2goQ1NTX1BSRUZJWCArICdhbmltYXRpb24tcGxheS1zdGF0ZScpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIHN0YWdnZXJUaW1lID0gTWF0aC5yb3VuZChNYXRoLm1heCh0cmFuc2l0aW9uU3RhZ2dlckRlbGF5LCBhbmltYXRpb25TdGFnZ2VyRGVsYXkpICogMTAwKSAvIDEwMDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghc3RhZ2dlclRpbWUpIHtcclxuICAgICAgICAgICQkanFMaXRlLmFkZENsYXNzKGVsZW1lbnQsIGFjdGl2ZUNsYXNzTmFtZSk7XHJcbiAgICAgICAgICBpZiAoZWxlbWVudERhdGEuYmxvY2tUcmFuc2l0aW9uKSB7XHJcbiAgICAgICAgICAgIGJsb2NrVHJhbnNpdGlvbnMobm9kZSwgZmFsc2UpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGV2ZW50Q2FjaGVLZXkgPSBlbGVtZW50RGF0YS5jYWNoZUtleSArICcgJyArIGFjdGl2ZUNsYXNzTmFtZTtcclxuICAgICAgICB2YXIgdGltaW5ncyA9IGdldEVsZW1lbnRBbmltYXRpb25EZXRhaWxzKGVsZW1lbnQsIGV2ZW50Q2FjaGVLZXkpO1xyXG4gICAgICAgIHZhciBtYXhEdXJhdGlvbiA9IE1hdGgubWF4KHRpbWluZ3MudHJhbnNpdGlvbkR1cmF0aW9uLCB0aW1pbmdzLmFuaW1hdGlvbkR1cmF0aW9uKTtcclxuICAgICAgICBpZiAobWF4RHVyYXRpb24gPT09IDApIHtcclxuICAgICAgICAgICQkanFMaXRlLnJlbW92ZUNsYXNzKGVsZW1lbnQsIGFjdGl2ZUNsYXNzTmFtZSk7XHJcbiAgICAgICAgICBhbmltYXRlQ2xvc2UoZWxlbWVudCwgY2xhc3NOYW1lKTtcclxuICAgICAgICAgIGFjdGl2ZUFuaW1hdGlvbkNvbXBsZXRlKCk7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXN0YWdnZXJUaW1lICYmIHN0eWxlcyAmJiBPYmplY3Qua2V5cyhzdHlsZXMpLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIGlmICghdGltaW5ncy50cmFuc2l0aW9uRHVyYXRpb24pIHtcclxuICAgICAgICAgICAgZWxlbWVudC5jc3MoJ3RyYW5zaXRpb24nLCB0aW1pbmdzLmFuaW1hdGlvbkR1cmF0aW9uICsgJ3MgbGluZWFyIGFsbCcpO1xyXG4gICAgICAgICAgICBhcHBsaWVkU3R5bGVzLnB1c2goJ3RyYW5zaXRpb24nKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsZW1lbnQuY3NzKHN0eWxlcyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgbWF4RGVsYXkgPSBNYXRoLm1heCh0aW1pbmdzLnRyYW5zaXRpb25EZWxheSwgdGltaW5ncy5hbmltYXRpb25EZWxheSk7XHJcbiAgICAgICAgdmFyIG1heERlbGF5VGltZSA9IG1heERlbGF5ICogT05FX1NFQ09ORDtcclxuXHJcbiAgICAgICAgaWYgKGFwcGxpZWRTdHlsZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgLy90aGUgZWxlbWVudCBiZWluZyBhbmltYXRlZCBtYXkgc29tZXRpbWVzIGNvbnRhaW4gY29tbWVudCBub2RlcyBpblxyXG4gICAgICAgICAgLy90aGUganFMaXRlIG9iamVjdCwgc28gd2UncmUgc2FmZSB0byB1c2UgYSBzaW5nbGUgdmFyaWFibGUgdG8gaG91c2VcclxuICAgICAgICAgIC8vdGhlIHN0eWxlcyBzaW5jZSB0aGVyZSBpcyBhbHdheXMgb25seSBvbmUgZWxlbWVudCBiZWluZyBhbmltYXRlZFxyXG4gICAgICAgICAgdmFyIG9sZFN0eWxlID0gbm9kZS5nZXRBdHRyaWJ1dGUoJ3N0eWxlJykgfHwgJyc7XHJcbiAgICAgICAgICBpZiAob2xkU3R5bGUuY2hhckF0KG9sZFN0eWxlLmxlbmd0aCAtIDEpICE9PSAnOycpIHtcclxuICAgICAgICAgICAgb2xkU3R5bGUgKz0gJzsnO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgb2xkU3R5bGUgKyAnICcgKyBzdHlsZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICB2YXIgY3NzM0FuaW1hdGlvbkV2ZW50cyA9IEFOSU1BVElPTkVORF9FVkVOVCArICcgJyArIFRSQU5TSVRJT05FTkRfRVZFTlQ7XHJcbiAgICAgICAgdmFyIGFuaW1hdGlvblRpbWUgICAgID0gKG1heERlbGF5ICsgbWF4RHVyYXRpb24pICogQ0xPU0lOR19USU1FX0JVRkZFUjtcclxuICAgICAgICB2YXIgdG90YWxUaW1lICAgICAgICAgPSAoc3RhZ2dlclRpbWUgKyBhbmltYXRpb25UaW1lKSAqIE9ORV9TRUNPTkQ7XHJcblxyXG4gICAgICAgIHZhciBzdGFnZ2VyVGltZW91dDtcclxuICAgICAgICBpZiAoc3RhZ2dlclRpbWUgPiAwKSB7XHJcbiAgICAgICAgICAkJGpxTGl0ZS5hZGRDbGFzcyhlbGVtZW50LCBwZW5kaW5nQ2xhc3NOYW1lKTtcclxuICAgICAgICAgIHN0YWdnZXJUaW1lb3V0ID0gJHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHN0YWdnZXJUaW1lb3V0ID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aW1pbmdzLnRyYW5zaXRpb25EdXJhdGlvbiA+IDApIHtcclxuICAgICAgICAgICAgICBibG9ja1RyYW5zaXRpb25zKG5vZGUsIGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGltaW5ncy5hbmltYXRpb25EdXJhdGlvbiA+IDApIHtcclxuICAgICAgICAgICAgICBibG9ja0FuaW1hdGlvbnMobm9kZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAkJGpxTGl0ZS5hZGRDbGFzcyhlbGVtZW50LCBhY3RpdmVDbGFzc05hbWUpO1xyXG4gICAgICAgICAgICAkJGpxTGl0ZS5yZW1vdmVDbGFzcyhlbGVtZW50LCBwZW5kaW5nQ2xhc3NOYW1lKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChzdHlsZXMpIHtcclxuICAgICAgICAgICAgICBpZiAodGltaW5ncy50cmFuc2l0aW9uRHVyYXRpb24gPT09IDApIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuY3NzKCd0cmFuc2l0aW9uJywgdGltaW5ncy5hbmltYXRpb25EdXJhdGlvbiArICdzIGxpbmVhciBhbGwnKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgZWxlbWVudC5jc3Moc3R5bGVzKTtcclxuICAgICAgICAgICAgICBhcHBsaWVkU3R5bGVzLnB1c2goJ3RyYW5zaXRpb24nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSwgc3RhZ2dlclRpbWUgKiBPTkVfU0VDT05ELCBmYWxzZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBlbGVtZW50Lm9uKGNzczNBbmltYXRpb25FdmVudHMsIG9uQW5pbWF0aW9uUHJvZ3Jlc3MpO1xyXG4gICAgICAgIGVsZW1lbnREYXRhLmNsb3NlQW5pbWF0aW9uRm5zLnB1c2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICBvbkVuZCgpO1xyXG4gICAgICAgICAgYWN0aXZlQW5pbWF0aW9uQ29tcGxldGUoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgZWxlbWVudERhdGEucnVubmluZysrO1xyXG4gICAgICAgIGFuaW1hdGlvbkNsb3NlSGFuZGxlcihlbGVtZW50LCB0b3RhbFRpbWUpO1xyXG4gICAgICAgIHJldHVybiBvbkVuZDtcclxuXHJcbiAgICAgICAgLy8gVGhpcyB3aWxsIGF1dG9tYXRpY2FsbHkgYmUgY2FsbGVkIGJ5ICRhbmltYXRlIHNvXHJcbiAgICAgICAgLy8gdGhlcmUgaXMgbm8gbmVlZCB0byBhdHRhY2ggdGhpcyBpbnRlcm5hbGx5IHRvIHRoZVxyXG4gICAgICAgIC8vIHRpbWVvdXQgZG9uZSBtZXRob2QuXHJcbiAgICAgICAgZnVuY3Rpb24gb25FbmQoKSB7XHJcbiAgICAgICAgICBlbGVtZW50Lm9mZihjc3MzQW5pbWF0aW9uRXZlbnRzLCBvbkFuaW1hdGlvblByb2dyZXNzKTtcclxuICAgICAgICAgICQkanFMaXRlLnJlbW92ZUNsYXNzKGVsZW1lbnQsIGFjdGl2ZUNsYXNzTmFtZSk7XHJcbiAgICAgICAgICAkJGpxTGl0ZS5yZW1vdmVDbGFzcyhlbGVtZW50LCBwZW5kaW5nQ2xhc3NOYW1lKTtcclxuICAgICAgICAgIGlmIChzdGFnZ2VyVGltZW91dCkge1xyXG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwoc3RhZ2dlclRpbWVvdXQpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgYW5pbWF0ZUNsb3NlKGVsZW1lbnQsIGNsYXNzTmFtZSk7XHJcbiAgICAgICAgICB2YXIgbm9kZSA9IGV4dHJhY3RFbGVtZW50Tm9kZShlbGVtZW50KTtcclxuICAgICAgICAgIGZvciAodmFyIGkgaW4gYXBwbGllZFN0eWxlcykge1xyXG4gICAgICAgICAgICBub2RlLnN0eWxlLnJlbW92ZVByb3BlcnR5KGFwcGxpZWRTdHlsZXNbaV0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gb25BbmltYXRpb25Qcm9ncmVzcyhldmVudCkge1xyXG4gICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICB2YXIgZXYgPSBldmVudC5vcmlnaW5hbEV2ZW50IHx8IGV2ZW50O1xyXG4gICAgICAgICAgdmFyIHRpbWVTdGFtcCA9IGV2LiRtYW51YWxUaW1lU3RhbXAgfHwgZXYudGltZVN0YW1wIHx8IERhdGUubm93KCk7XHJcblxyXG4gICAgICAgICAgLyogRmlyZWZveCAob3IgcG9zc2libHkganVzdCBHZWNrbykgbGlrZXMgdG8gbm90IHJvdW5kIHZhbHVlcyB1cFxyXG4gICAgICAgICAgICogd2hlbiBhIG1zIG1lYXN1cmVtZW50IGlzIHVzZWQgZm9yIHRoZSBhbmltYXRpb24gKi9cclxuICAgICAgICAgIHZhciBlbGFwc2VkVGltZSA9IHBhcnNlRmxvYXQoZXYuZWxhcHNlZFRpbWUudG9GaXhlZChFTEFQU0VEX1RJTUVfTUFYX0RFQ0lNQUxfUExBQ0VTKSk7XHJcblxyXG4gICAgICAgICAgLyogJG1hbnVhbFRpbWVTdGFtcCBpcyBhIG1vY2tlZCB0aW1lU3RhbXAgdmFsdWUgd2hpY2ggaXMgc2V0XHJcbiAgICAgICAgICAgKiB3aXRoaW4gYnJvd3NlclRyaWdnZXIoKS4gVGhpcyBpcyBvbmx5IGhlcmUgc28gdGhhdCB0ZXN0cyBjYW5cclxuICAgICAgICAgICAqIG1vY2sgYW5pbWF0aW9ucyBwcm9wZXJseS4gUmVhbCBldmVudHMgZmFsbGJhY2sgdG8gZXZlbnQudGltZVN0YW1wLFxyXG4gICAgICAgICAgICogb3IsIGlmIHRoZXkgZG9uJ3QsIHRoZW4gYSB0aW1lU3RhbXAgaXMgYXV0b21hdGljYWxseSBjcmVhdGVkIGZvciB0aGVtLlxyXG4gICAgICAgICAgICogV2UncmUgY2hlY2tpbmcgdG8gc2VlIGlmIHRoZSB0aW1lU3RhbXAgc3VycGFzc2VzIHRoZSBleHBlY3RlZCBkZWxheSxcclxuICAgICAgICAgICAqIGJ1dCB3ZSdyZSB1c2luZyBlbGFwc2VkVGltZSBpbnN0ZWFkIG9mIHRoZSB0aW1lU3RhbXAgb24gdGhlIDJuZFxyXG4gICAgICAgICAgICogcHJlLWNvbmRpdGlvbiBzaW5jZSBhbmltYXRpb25zIHNvbWV0aW1lcyBjbG9zZSBvZmYgZWFybHkgKi9cclxuICAgICAgICAgIGlmIChNYXRoLm1heCh0aW1lU3RhbXAgLSBzdGFydFRpbWUsIDApID49IG1heERlbGF5VGltZSAmJiBlbGFwc2VkVGltZSA+PSBtYXhEdXJhdGlvbikge1xyXG4gICAgICAgICAgICBhY3RpdmVBbmltYXRpb25Db21wbGV0ZSgpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gYmxvY2tUcmFuc2l0aW9ucyhub2RlLCBib29sKSB7XHJcbiAgICAgICAgbm9kZS5zdHlsZVtUUkFOU0lUSU9OX1BST1AgKyBQUk9QRVJUWV9LRVldID0gYm9vbCA/ICdub25lJyA6ICcnO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBibG9ja0FuaW1hdGlvbnMobm9kZSwgYm9vbCkge1xyXG4gICAgICAgIG5vZGUuc3R5bGVbQU5JTUFUSU9OX1BST1AgKyBBTklNQVRJT05fUExBWVNUQVRFX0tFWV0gPSBib29sID8gJ3BhdXNlZCcgOiAnJztcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gYW5pbWF0ZUJlZm9yZShhbmltYXRpb25FdmVudCwgZWxlbWVudCwgY2xhc3NOYW1lLCBzdHlsZXMpIHtcclxuICAgICAgICBpZiAoYW5pbWF0ZVNldHVwKGFuaW1hdGlvbkV2ZW50LCBlbGVtZW50LCBjbGFzc05hbWUsIHN0eWxlcykpIHtcclxuICAgICAgICAgIHJldHVybiBmdW5jdGlvbihjYW5jZWxsZWQpIHtcclxuICAgICAgICAgICAgY2FuY2VsbGVkICYmIGFuaW1hdGVDbG9zZShlbGVtZW50LCBjbGFzc05hbWUpO1xyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGFuaW1hdGVBZnRlcihhbmltYXRpb25FdmVudCwgZWxlbWVudCwgY2xhc3NOYW1lLCBhZnRlckFuaW1hdGlvbkNvbXBsZXRlLCBzdHlsZXMpIHtcclxuICAgICAgICBpZiAoZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfQ1NTX0RBVEFfS0VZKSkge1xyXG4gICAgICAgICAgcmV0dXJuIGFuaW1hdGVSdW4oYW5pbWF0aW9uRXZlbnQsIGVsZW1lbnQsIGNsYXNzTmFtZSwgYWZ0ZXJBbmltYXRpb25Db21wbGV0ZSwgc3R5bGVzKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgYW5pbWF0ZUNsb3NlKGVsZW1lbnQsIGNsYXNzTmFtZSk7XHJcbiAgICAgICAgICBhZnRlckFuaW1hdGlvbkNvbXBsZXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBhbmltYXRlKGFuaW1hdGlvbkV2ZW50LCBlbGVtZW50LCBjbGFzc05hbWUsIGFuaW1hdGlvbkNvbXBsZXRlLCBvcHRpb25zKSB7XHJcbiAgICAgICAgLy9JZiB0aGUgYW5pbWF0ZVNldHVwIGZ1bmN0aW9uIGRvZXNuJ3QgYm90aGVyIHJldHVybmluZyBhXHJcbiAgICAgICAgLy9jYW5jZWxsYXRpb24gZnVuY3Rpb24gdGhlbiBpdCBtZWFucyB0aGF0IHRoZXJlIGlzIG5vIGFuaW1hdGlvblxyXG4gICAgICAgIC8vdG8gcGVyZm9ybSBhdCBhbGxcclxuICAgICAgICB2YXIgcHJlUmVmbG93Q2FuY2VsbGF0aW9uID0gYW5pbWF0ZUJlZm9yZShhbmltYXRpb25FdmVudCwgZWxlbWVudCwgY2xhc3NOYW1lLCBvcHRpb25zLmZyb20pO1xyXG4gICAgICAgIGlmICghcHJlUmVmbG93Q2FuY2VsbGF0aW9uKSB7XHJcbiAgICAgICAgICBjbGVhckNhY2hlQWZ0ZXJSZWZsb3coKTtcclxuICAgICAgICAgIGFuaW1hdGlvbkNvbXBsZXRlKCk7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvL1RoZXJlIGFyZSB0d28gY2FuY2VsbGF0aW9uIGZ1bmN0aW9uczogb25lIGlzIGJlZm9yZSB0aGUgZmlyc3RcclxuICAgICAgICAvL3JlZmxvdyBhbmltYXRpb24gYW5kIHRoZSBzZWNvbmQgaXMgZHVyaW5nIHRoZSBhY3RpdmUgc3RhdGVcclxuICAgICAgICAvL2FuaW1hdGlvbi4gVGhlIGZpcnN0IGZ1bmN0aW9uIHdpbGwgdGFrZSBjYXJlIG9mIHJlbW92aW5nIHRoZVxyXG4gICAgICAgIC8vZGF0YSBmcm9tIHRoZSBlbGVtZW50IHdoaWNoIHdpbGwgbm90IG1ha2UgdGhlIDJuZCBhbmltYXRpb25cclxuICAgICAgICAvL2hhcHBlbiBpbiB0aGUgZmlyc3QgcGxhY2VcclxuICAgICAgICB2YXIgY2FuY2VsID0gcHJlUmVmbG93Q2FuY2VsbGF0aW9uO1xyXG4gICAgICAgIGFmdGVyUmVmbG93KGVsZW1lbnQsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgLy9vbmNlIHRoZSByZWZsb3cgaXMgY29tcGxldGUgdGhlbiB3ZSBwb2ludCBjYW5jZWwgdG9cclxuICAgICAgICAgIC8vdGhlIG5ldyBjYW5jZWxsYXRpb24gZnVuY3Rpb24gd2hpY2ggd2lsbCByZW1vdmUgYWxsIG9mIHRoZVxyXG4gICAgICAgICAgLy9hbmltYXRpb24gcHJvcGVydGllcyBmcm9tIHRoZSBhY3RpdmUgYW5pbWF0aW9uXHJcbiAgICAgICAgICBjYW5jZWwgPSBhbmltYXRlQWZ0ZXIoYW5pbWF0aW9uRXZlbnQsIGVsZW1lbnQsIGNsYXNzTmFtZSwgYW5pbWF0aW9uQ29tcGxldGUsIG9wdGlvbnMudG8pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oY2FuY2VsbGVkKSB7XHJcbiAgICAgICAgICAoY2FuY2VsIHx8IG5vb3ApKGNhbmNlbGxlZCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gYW5pbWF0ZUNsb3NlKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xyXG4gICAgICAgICQkanFMaXRlLnJlbW92ZUNsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSk7XHJcbiAgICAgICAgdmFyIGRhdGEgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9DU1NfREFUQV9LRVkpO1xyXG4gICAgICAgIGlmIChkYXRhKSB7XHJcbiAgICAgICAgICBpZiAoZGF0YS5ydW5uaW5nKSB7XHJcbiAgICAgICAgICAgIGRhdGEucnVubmluZy0tO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKCFkYXRhLnJ1bm5pbmcgfHwgZGF0YS5ydW5uaW5nID09PSAwKSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlRGF0YShOR19BTklNQVRFX0NTU19EQVRBX0tFWSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGFuaW1hdGU6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgZnJvbSwgdG8sIGFuaW1hdGlvbkNvbXBsZXRlZCwgb3B0aW9ucykge1xyXG4gICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcbiAgICAgICAgICBvcHRpb25zLmZyb20gPSBmcm9tO1xyXG4gICAgICAgICAgb3B0aW9ucy50byA9IHRvO1xyXG4gICAgICAgICAgcmV0dXJuIGFuaW1hdGUoJ2FuaW1hdGUnLCBlbGVtZW50LCBjbGFzc05hbWUsIGFuaW1hdGlvbkNvbXBsZXRlZCwgb3B0aW9ucyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZW50ZXI6IGZ1bmN0aW9uKGVsZW1lbnQsIGFuaW1hdGlvbkNvbXBsZXRlZCwgb3B0aW9ucykge1xyXG4gICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcbiAgICAgICAgICByZXR1cm4gYW5pbWF0ZSgnZW50ZXInLCBlbGVtZW50LCAnbmctZW50ZXInLCBhbmltYXRpb25Db21wbGV0ZWQsIG9wdGlvbnMpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGxlYXZlOiBmdW5jdGlvbihlbGVtZW50LCBhbmltYXRpb25Db21wbGV0ZWQsIG9wdGlvbnMpIHtcclxuICAgICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xyXG4gICAgICAgICAgcmV0dXJuIGFuaW1hdGUoJ2xlYXZlJywgZWxlbWVudCwgJ25nLWxlYXZlJywgYW5pbWF0aW9uQ29tcGxldGVkLCBvcHRpb25zKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBtb3ZlOiBmdW5jdGlvbihlbGVtZW50LCBhbmltYXRpb25Db21wbGV0ZWQsIG9wdGlvbnMpIHtcclxuICAgICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xyXG4gICAgICAgICAgcmV0dXJuIGFuaW1hdGUoJ21vdmUnLCBlbGVtZW50LCAnbmctbW92ZScsIGFuaW1hdGlvbkNvbXBsZXRlZCwgb3B0aW9ucyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgYmVmb3JlU2V0Q2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGFkZCwgcmVtb3ZlLCBhbmltYXRpb25Db21wbGV0ZWQsIG9wdGlvbnMpIHtcclxuICAgICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xyXG4gICAgICAgICAgdmFyIGNsYXNzTmFtZSA9IHN1ZmZpeENsYXNzZXMocmVtb3ZlLCAnLXJlbW92ZScpICsgJyAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBzdWZmaXhDbGFzc2VzKGFkZCwgJy1hZGQnKTtcclxuICAgICAgICAgIHZhciBjYW5jZWxsYXRpb25NZXRob2QgPSBhbmltYXRlQmVmb3JlKCdzZXRDbGFzcycsIGVsZW1lbnQsIGNsYXNzTmFtZSwgb3B0aW9ucy5mcm9tKTtcclxuICAgICAgICAgIGlmIChjYW5jZWxsYXRpb25NZXRob2QpIHtcclxuICAgICAgICAgICAgYWZ0ZXJSZWZsb3coZWxlbWVudCwgYW5pbWF0aW9uQ29tcGxldGVkKTtcclxuICAgICAgICAgICAgcmV0dXJuIGNhbmNlbGxhdGlvbk1ldGhvZDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGNsZWFyQ2FjaGVBZnRlclJlZmxvdygpO1xyXG4gICAgICAgICAgYW5pbWF0aW9uQ29tcGxldGVkKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgYmVmb3JlQWRkQ2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgYW5pbWF0aW9uQ29tcGxldGVkLCBvcHRpb25zKSB7XHJcbiAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuICAgICAgICAgIHZhciBjYW5jZWxsYXRpb25NZXRob2QgPSBhbmltYXRlQmVmb3JlKCdhZGRDbGFzcycsIGVsZW1lbnQsIHN1ZmZpeENsYXNzZXMoY2xhc3NOYW1lLCAnLWFkZCcpLCBvcHRpb25zLmZyb20pO1xyXG4gICAgICAgICAgaWYgKGNhbmNlbGxhdGlvbk1ldGhvZCkge1xyXG4gICAgICAgICAgICBhZnRlclJlZmxvdyhlbGVtZW50LCBhbmltYXRpb25Db21wbGV0ZWQpO1xyXG4gICAgICAgICAgICByZXR1cm4gY2FuY2VsbGF0aW9uTWV0aG9kO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgY2xlYXJDYWNoZUFmdGVyUmVmbG93KCk7XHJcbiAgICAgICAgICBhbmltYXRpb25Db21wbGV0ZWQoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBiZWZvcmVSZW1vdmVDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBhbmltYXRpb25Db21wbGV0ZWQsIG9wdGlvbnMpIHtcclxuICAgICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xyXG4gICAgICAgICAgdmFyIGNhbmNlbGxhdGlvbk1ldGhvZCA9IGFuaW1hdGVCZWZvcmUoJ3JlbW92ZUNsYXNzJywgZWxlbWVudCwgc3VmZml4Q2xhc3NlcyhjbGFzc05hbWUsICctcmVtb3ZlJyksIG9wdGlvbnMuZnJvbSk7XHJcbiAgICAgICAgICBpZiAoY2FuY2VsbGF0aW9uTWV0aG9kKSB7XHJcbiAgICAgICAgICAgIGFmdGVyUmVmbG93KGVsZW1lbnQsIGFuaW1hdGlvbkNvbXBsZXRlZCk7XHJcbiAgICAgICAgICAgIHJldHVybiBjYW5jZWxsYXRpb25NZXRob2Q7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBjbGVhckNhY2hlQWZ0ZXJSZWZsb3coKTtcclxuICAgICAgICAgIGFuaW1hdGlvbkNvbXBsZXRlZCgpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHNldENsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBhZGQsIHJlbW92ZSwgYW5pbWF0aW9uQ29tcGxldGVkLCBvcHRpb25zKSB7XHJcbiAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuICAgICAgICAgIHJlbW92ZSA9IHN1ZmZpeENsYXNzZXMocmVtb3ZlLCAnLXJlbW92ZScpO1xyXG4gICAgICAgICAgYWRkID0gc3VmZml4Q2xhc3NlcyhhZGQsICctYWRkJyk7XHJcbiAgICAgICAgICB2YXIgY2xhc3NOYW1lID0gcmVtb3ZlICsgJyAnICsgYWRkO1xyXG4gICAgICAgICAgcmV0dXJuIGFuaW1hdGVBZnRlcignc2V0Q2xhc3MnLCBlbGVtZW50LCBjbGFzc05hbWUsIGFuaW1hdGlvbkNvbXBsZXRlZCwgb3B0aW9ucy50byk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgYWRkQ2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgYW5pbWF0aW9uQ29tcGxldGVkLCBvcHRpb25zKSB7XHJcbiAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuICAgICAgICAgIHJldHVybiBhbmltYXRlQWZ0ZXIoJ2FkZENsYXNzJywgZWxlbWVudCwgc3VmZml4Q2xhc3NlcyhjbGFzc05hbWUsICctYWRkJyksIGFuaW1hdGlvbkNvbXBsZXRlZCwgb3B0aW9ucy50byk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgcmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgYW5pbWF0aW9uQ29tcGxldGVkLCBvcHRpb25zKSB7XHJcbiAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuICAgICAgICAgIHJldHVybiBhbmltYXRlQWZ0ZXIoJ3JlbW92ZUNsYXNzJywgZWxlbWVudCwgc3VmZml4Q2xhc3NlcyhjbGFzc05hbWUsICctcmVtb3ZlJyksIGFuaW1hdGlvbkNvbXBsZXRlZCwgb3B0aW9ucy50byk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgZnVuY3Rpb24gc3VmZml4Q2xhc3NlcyhjbGFzc2VzLCBzdWZmaXgpIHtcclxuICAgICAgICB2YXIgY2xhc3NOYW1lID0gJyc7XHJcbiAgICAgICAgY2xhc3NlcyA9IGlzQXJyYXkoY2xhc3NlcykgPyBjbGFzc2VzIDogY2xhc3Nlcy5zcGxpdCgvXFxzKy8pO1xyXG4gICAgICAgIGZvckVhY2goY2xhc3NlcywgZnVuY3Rpb24oa2xhc3MsIGkpIHtcclxuICAgICAgICAgIGlmIChrbGFzcyAmJiBrbGFzcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNsYXNzTmFtZSArPSAoaSA+IDAgPyAnICcgOiAnJykgKyBrbGFzcyArIHN1ZmZpeDtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gY2xhc3NOYW1lO1xyXG4gICAgICB9XHJcbiAgICB9XSk7XHJcbiAgfV0pO1xyXG5cclxuXHJcbn0pKHdpbmRvdywgd2luZG93LmFuZ3VsYXIpO1xyXG4iLCIvKipcclxuICogQGxpY2Vuc2UgQW5ndWxhckpTIHYxLjMuMTFcclxuICogKGMpIDIwMTAtMjAxNCBHb29nbGUsIEluYy4gaHR0cDovL2FuZ3VsYXJqcy5vcmdcclxuICogTGljZW5zZTogTUlUXHJcbiAqL1xyXG4oZnVuY3Rpb24od2luZG93LCBhbmd1bGFyLCB1bmRlZmluZWQpIHsndXNlIHN0cmljdCc7XHJcblxyXG4vKipcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBuZ0FyaWFcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqXHJcbiAqIFRoZSBgbmdBcmlhYCBtb2R1bGUgcHJvdmlkZXMgc3VwcG9ydCBmb3IgY29tbW9uXHJcbiAqIFs8YWJiciB0aXRsZT1cIkFjY2Vzc2libGUgUmljaCBJbnRlcm5ldCBBcHBsaWNhdGlvbnNcIj5BUklBPC9hYmJyPl0oaHR0cDovL3d3dy53My5vcmcvVFIvd2FpLWFyaWEvKVxyXG4gKiBhdHRyaWJ1dGVzIHRoYXQgY29udmV5IHN0YXRlIG9yIHNlbWFudGljIGluZm9ybWF0aW9uIGFib3V0IHRoZSBhcHBsaWNhdGlvbiBmb3IgdXNlcnNcclxuICogb2YgYXNzaXN0aXZlIHRlY2hub2xvZ2llcywgc3VjaCBhcyBzY3JlZW4gcmVhZGVycy5cclxuICpcclxuICogPGRpdiBkb2MtbW9kdWxlLWNvbXBvbmVudHM9XCJuZ0FyaWFcIj48L2Rpdj5cclxuICpcclxuICogIyMgVXNhZ2VcclxuICpcclxuICogRm9yIG5nQXJpYSB0byBkbyBpdHMgbWFnaWMsIHNpbXBseSBpbmNsdWRlIHRoZSBtb2R1bGUgYXMgYSBkZXBlbmRlbmN5LiBUaGUgZGlyZWN0aXZlcyBzdXBwb3J0ZWRcclxuICogYnkgbmdBcmlhIGFyZTpcclxuICogYG5nTW9kZWxgLCBgbmdEaXNhYmxlZGAsIGBuZ1Nob3dgLCBgbmdIaWRlYCwgYG5nQ2xpY2tgLCBgbmdEYmxDbGlja2AsIGFuZCBgbmdNZXNzYWdlc2AuXHJcbiAqXHJcbiAqIEJlbG93IGlzIGEgbW9yZSBkZXRhaWxlZCBicmVha2Rvd24gb2YgdGhlIGF0dHJpYnV0ZXMgaGFuZGxlZCBieSBuZ0FyaWE6XHJcbiAqXHJcbiAqIHwgRGlyZWN0aXZlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IFN1cHBvcnRlZCBBdHRyaWJ1dGVzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICogfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxyXG4gKiB8IHtAbGluayBuZy5kaXJlY3RpdmU6bmdNb2RlbCBuZ01vZGVsfSAgICAgICAgfCBhcmlhLWNoZWNrZWQsIGFyaWEtdmFsdWVtaW4sIGFyaWEtdmFsdWVtYXgsIGFyaWEtdmFsdWVub3csIGFyaWEtaW52YWxpZCwgYXJpYS1yZXF1aXJlZCB8XHJcbiAqIHwge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0Rpc2FibGVkIG5nRGlzYWJsZWR9ICB8IGFyaWEtZGlzYWJsZWQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICogfCB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nU2hvdyBuZ1Nob3d9ICAgICAgICAgIHwgYXJpYS1oaWRkZW4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gKiB8IHtAbGluayBuZy5kaXJlY3RpdmU6bmdIaWRlIG5nSGlkZX0gICAgICAgICAgfCBhcmlhLWhpZGRlbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAqIHwge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0NsaWNrIG5nQ2xpY2t9ICAgICAgICB8IHRhYmluZGV4LCBrZXlwcmVzcyBldmVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICogfCB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nRGJsY2xpY2sgbmdEYmxjbGlja30gIHwgdGFiaW5kZXggICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gKiB8IHtAbGluayBtb2R1bGU6bmdNZXNzYWdlcyBuZ01lc3NhZ2VzfSAgICAgICAgfCBhcmlhLWxpdmUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAqXHJcbiAqIEZpbmQgb3V0IG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgZWFjaCBkaXJlY3RpdmUgYnkgcmVhZGluZyB0aGVcclxuICoge0BsaW5rIGd1aWRlL2FjY2Vzc2liaWxpdHkgbmdBcmlhIERldmVsb3BlciBHdWlkZX0uXHJcbiAqXHJcbiAqICMjRXhhbXBsZVxyXG4gKiBVc2luZyBuZ0Rpc2FibGVkIHdpdGggbmdBcmlhOlxyXG4gKiBgYGBodG1sXHJcbiAqIDxtZC1jaGVja2JveCBuZy1kaXNhYmxlZD1cImRpc2FibGVkXCI+XHJcbiAqIGBgYFxyXG4gKiBCZWNvbWVzOlxyXG4gKiBgYGBodG1sXHJcbiAqIDxtZC1jaGVja2JveCBuZy1kaXNhYmxlZD1cImRpc2FibGVkXCIgYXJpYS1kaXNhYmxlZD1cInRydWVcIj5cclxuICogYGBgXHJcbiAqXHJcbiAqICMjRGlzYWJsaW5nIEF0dHJpYnV0ZXNcclxuICogSXQncyBwb3NzaWJsZSB0byBkaXNhYmxlIGluZGl2aWR1YWwgYXR0cmlidXRlcyBhZGRlZCBieSBuZ0FyaWEgd2l0aCB0aGVcclxuICoge0BsaW5rIG5nQXJpYS4kYXJpYVByb3ZpZGVyI2NvbmZpZyBjb25maWd9IG1ldGhvZC4gRm9yIG1vcmUgZGV0YWlscywgc2VlIHRoZVxyXG4gKiB7QGxpbmsgZ3VpZGUvYWNjZXNzaWJpbGl0eSBEZXZlbG9wZXIgR3VpZGV9LlxyXG4gKi9cclxuIC8qIGdsb2JhbCAtbmdBcmlhTW9kdWxlICovXHJcbnZhciBuZ0FyaWFNb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdBcmlhJywgWyduZyddKS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXIoJyRhcmlhJywgJEFyaWFQcm92aWRlcik7XHJcblxyXG4vKipcclxuICogQG5nZG9jIHByb3ZpZGVyXHJcbiAqIEBuYW1lICRhcmlhUHJvdmlkZXJcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqXHJcbiAqIFVzZWQgZm9yIGNvbmZpZ3VyaW5nIHRoZSBBUklBIGF0dHJpYnV0ZXMgaW5qZWN0ZWQgYW5kIG1hbmFnZWQgYnkgbmdBcmlhLlxyXG4gKlxyXG4gKiBgYGBqc1xyXG4gKiBhbmd1bGFyLm1vZHVsZSgnbXlBcHAnLCBbJ25nQXJpYSddLCBmdW5jdGlvbiBjb25maWcoJGFyaWFQcm92aWRlcikge1xyXG4gKiAgICRhcmlhUHJvdmlkZXIuY29uZmlnKHtcclxuICogICAgIGFyaWFWYWx1ZTogdHJ1ZSxcclxuICogICAgIHRhYmluZGV4OiBmYWxzZVxyXG4gKiAgIH0pO1xyXG4gKiB9KTtcclxuICpgYGBcclxuICpcclxuICogIyMgRGVwZW5kZW5jaWVzXHJcbiAqIFJlcXVpcmVzIHRoZSB7QGxpbmsgbmdBcmlhfSBtb2R1bGUgdG8gYmUgaW5zdGFsbGVkLlxyXG4gKlxyXG4gKi9cclxuZnVuY3Rpb24gJEFyaWFQcm92aWRlcigpIHtcclxuICB2YXIgY29uZmlnID0ge1xyXG4gICAgYXJpYUhpZGRlbjogdHJ1ZSxcclxuICAgIGFyaWFDaGVja2VkOiB0cnVlLFxyXG4gICAgYXJpYURpc2FibGVkOiB0cnVlLFxyXG4gICAgYXJpYVJlcXVpcmVkOiB0cnVlLFxyXG4gICAgYXJpYUludmFsaWQ6IHRydWUsXHJcbiAgICBhcmlhTXVsdGlsaW5lOiB0cnVlLFxyXG4gICAgYXJpYVZhbHVlOiB0cnVlLFxyXG4gICAgdGFiaW5kZXg6IHRydWUsXHJcbiAgICBiaW5kS2V5cHJlc3M6IHRydWVcclxuICB9O1xyXG5cclxuICAvKipcclxuICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICogQG5hbWUgJGFyaWFQcm92aWRlciNjb25maWdcclxuICAgKlxyXG4gICAqIEBwYXJhbSB7b2JqZWN0fSBjb25maWcgb2JqZWN0IHRvIGVuYWJsZS9kaXNhYmxlIHNwZWNpZmljIEFSSUEgYXR0cmlidXRlc1xyXG4gICAqXHJcbiAgICogIC0gKiphcmlhSGlkZGVuKiog4oCTIGB7Ym9vbGVhbn1gIOKAkyBFbmFibGVzL2Rpc2FibGVzIGFyaWEtaGlkZGVuIHRhZ3NcclxuICAgKiAgLSAqKmFyaWFDaGVja2VkKiog4oCTIGB7Ym9vbGVhbn1gIOKAkyBFbmFibGVzL2Rpc2FibGVzIGFyaWEtY2hlY2tlZCB0YWdzXHJcbiAgICogIC0gKiphcmlhRGlzYWJsZWQqKiDigJMgYHtib29sZWFufWAg4oCTIEVuYWJsZXMvZGlzYWJsZXMgYXJpYS1kaXNhYmxlZCB0YWdzXHJcbiAgICogIC0gKiphcmlhUmVxdWlyZWQqKiDigJMgYHtib29sZWFufWAg4oCTIEVuYWJsZXMvZGlzYWJsZXMgYXJpYS1yZXF1aXJlZCB0YWdzXHJcbiAgICogIC0gKiphcmlhSW52YWxpZCoqIOKAkyBge2Jvb2xlYW59YCDigJMgRW5hYmxlcy9kaXNhYmxlcyBhcmlhLWludmFsaWQgdGFnc1xyXG4gICAqICAtICoqYXJpYU11bHRpbGluZSoqIOKAkyBge2Jvb2xlYW59YCDigJMgRW5hYmxlcy9kaXNhYmxlcyBhcmlhLW11bHRpbGluZSB0YWdzXHJcbiAgICogIC0gKiphcmlhVmFsdWUqKiDigJMgYHtib29sZWFufWAg4oCTIEVuYWJsZXMvZGlzYWJsZXMgYXJpYS12YWx1ZW1pbiwgYXJpYS12YWx1ZW1heCBhbmQgYXJpYS12YWx1ZW5vdyB0YWdzXHJcbiAgICogIC0gKip0YWJpbmRleCoqIOKAkyBge2Jvb2xlYW59YCDigJMgRW5hYmxlcy9kaXNhYmxlcyB0YWJpbmRleCB0YWdzXHJcbiAgICogIC0gKipiaW5kS2V5cHJlc3MqKiDigJMgYHtib29sZWFufWAg4oCTIEVuYWJsZXMvZGlzYWJsZXMga2V5cHJlc3MgZXZlbnQgYmluZGluZyBvbiBuZy1jbGlja1xyXG4gICAqXHJcbiAgICogQGRlc2NyaXB0aW9uXHJcbiAgICogRW5hYmxlcy9kaXNhYmxlcyB2YXJpb3VzIEFSSUEgYXR0cmlidXRlc1xyXG4gICAqL1xyXG4gIHRoaXMuY29uZmlnID0gZnVuY3Rpb24obmV3Q29uZmlnKSB7XHJcbiAgICBjb25maWcgPSBhbmd1bGFyLmV4dGVuZChjb25maWcsIG5ld0NvbmZpZyk7XHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb24gd2F0Y2hFeHByKGF0dHJOYW1lLCBhcmlhQXR0ciwgbmVnYXRlKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW0sIGF0dHIpIHtcclxuICAgICAgdmFyIGFyaWFDYW1lbE5hbWUgPSBhdHRyLiRub3JtYWxpemUoYXJpYUF0dHIpO1xyXG4gICAgICBpZiAoY29uZmlnW2FyaWFDYW1lbE5hbWVdICYmICFhdHRyW2FyaWFDYW1lbE5hbWVdKSB7XHJcbiAgICAgICAgc2NvcGUuJHdhdGNoKGF0dHJbYXR0ck5hbWVdLCBmdW5jdGlvbihib29sVmFsKSB7XHJcbiAgICAgICAgICBpZiAobmVnYXRlKSB7XHJcbiAgICAgICAgICAgIGJvb2xWYWwgPSAhYm9vbFZhbDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsZW0uYXR0cihhcmlhQXR0ciwgYm9vbFZhbCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAbmdkb2Mgc2VydmljZVxyXG4gICAqIEBuYW1lICRhcmlhXHJcbiAgICpcclxuICAgKiBAZGVzY3JpcHRpb25cclxuICAgKlxyXG4gICAqIFRoZSAkYXJpYSBzZXJ2aWNlIGNvbnRhaW5zIGhlbHBlciBtZXRob2RzIGZvciBhcHBseWluZyBjb21tb25cclxuICAgKiBbQVJJQV0oaHR0cDovL3d3dy53My5vcmcvVFIvd2FpLWFyaWEvKSBhdHRyaWJ1dGVzIHRvIEhUTUwgZGlyZWN0aXZlcy5cclxuICAgKlxyXG4gICAqIG5nQXJpYSBpbmplY3RzIGNvbW1vbiBhY2Nlc3NpYmlsaXR5IGF0dHJpYnV0ZXMgdGhhdCB0ZWxsIGFzc2lzdGl2ZSB0ZWNobm9sb2dpZXMgd2hlbiBIVE1MXHJcbiAgICogZWxlbWVudHMgYXJlIGVuYWJsZWQsIHNlbGVjdGVkLCBoaWRkZW4sIGFuZCBtb3JlLiBUbyBzZWUgaG93IHRoaXMgaXMgcGVyZm9ybWVkIHdpdGggbmdBcmlhLFxyXG4gICAqIGxldCdzIHJldmlldyBhIGNvZGUgc25pcHBldCBmcm9tIG5nQXJpYSBpdHNlbGY6XHJcbiAgICpcclxuICAgKmBgYGpzXHJcbiAgICogbmdBcmlhTW9kdWxlLmRpcmVjdGl2ZSgnbmdEaXNhYmxlZCcsIFsnJGFyaWEnLCBmdW5jdGlvbigkYXJpYSkge1xyXG4gICAqICAgcmV0dXJuICRhcmlhLiQkd2F0Y2hFeHByKCduZ0Rpc2FibGVkJywgJ2FyaWEtZGlzYWJsZWQnKTtcclxuICAgKiB9XSlcclxuICAgKmBgYFxyXG4gICAqIFNob3duIGFib3ZlLCB0aGUgbmdBcmlhIG1vZHVsZSBjcmVhdGVzIGEgZGlyZWN0aXZlIHdpdGggdGhlIHNhbWUgc2lnbmF0dXJlIGFzIHRoZVxyXG4gICAqIHRyYWRpdGlvbmFsIGBuZy1kaXNhYmxlZGAgZGlyZWN0aXZlLiBCdXQgdGhpcyBuZ0FyaWEgdmVyc2lvbiBpcyBkZWRpY2F0ZWQgdG9cclxuICAgKiBzb2xlbHkgbWFuYWdpbmcgYWNjZXNzaWJpbGl0eSBhdHRyaWJ1dGVzLiBUaGUgaW50ZXJuYWwgYCRhcmlhYCBzZXJ2aWNlIGlzIHVzZWQgdG8gd2F0Y2ggdGhlXHJcbiAgICogYm9vbGVhbiBhdHRyaWJ1dGUgYG5nRGlzYWJsZWRgLiBJZiBpdCBoYXMgbm90IGJlZW4gZXhwbGljaXRseSBzZXQgYnkgdGhlIGRldmVsb3BlcixcclxuICAgKiBgYXJpYS1kaXNhYmxlZGAgaXMgaW5qZWN0ZWQgYXMgYW4gYXR0cmlidXRlIHdpdGggaXRzIHZhbHVlIHN5bmNocm9uaXplZCB0byB0aGUgdmFsdWUgaW5cclxuICAgKiBgbmdEaXNhYmxlZGAuXHJcbiAgICpcclxuICAgKiBCZWNhdXNlIG5nQXJpYSBob29rcyBpbnRvIHRoZSBgbmctZGlzYWJsZWRgIGRpcmVjdGl2ZSwgZGV2ZWxvcGVycyBkbyBub3QgaGF2ZSB0byBkb1xyXG4gICAqIGFueXRoaW5nIHRvIGVuYWJsZSB0aGlzIGZlYXR1cmUuIFRoZSBgYXJpYS1kaXNhYmxlZGAgYXR0cmlidXRlIGlzIGF1dG9tYXRpY2FsbHkgbWFuYWdlZFxyXG4gICAqIHNpbXBseSBhcyBhIHNpbGVudCBzaWRlLWVmZmVjdCBvZiB1c2luZyBgbmctZGlzYWJsZWRgIHdpdGggdGhlIG5nQXJpYSBtb2R1bGUuXHJcbiAgICpcclxuICAgKiBUaGUgZnVsbCBsaXN0IG9mIGRpcmVjdGl2ZXMgdGhhdCBpbnRlcmZhY2Ugd2l0aCBuZ0FyaWE6XHJcbiAgICogKiAqKm5nTW9kZWwqKlxyXG4gICAqICogKipuZ1Nob3cqKlxyXG4gICAqICogKipuZ0hpZGUqKlxyXG4gICAqICogKipuZ0NsaWNrKipcclxuICAgKiAqICoqbmdEYmxjbGljayoqXHJcbiAgICogKiAqKm5nTWVzc2FnZXMqKlxyXG4gICAqICogKipuZ0Rpc2FibGVkKipcclxuICAgKlxyXG4gICAqIFJlYWQgdGhlIHtAbGluayBndWlkZS9hY2Nlc3NpYmlsaXR5IG5nQXJpYSBEZXZlbG9wZXIgR3VpZGV9IGZvciBhIHRob3JvdWdoIGV4cGxhbmF0aW9uIG9mIGVhY2hcclxuICAgKiBkaXJlY3RpdmUuXHJcbiAgICpcclxuICAgKlxyXG4gICAqICMjIERlcGVuZGVuY2llc1xyXG4gICAqIFJlcXVpcmVzIHRoZSB7QGxpbmsgbmdBcmlhfSBtb2R1bGUgdG8gYmUgaW5zdGFsbGVkLlxyXG4gICAqL1xyXG4gIHRoaXMuJGdldCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgY29uZmlnOiBmdW5jdGlvbihrZXkpIHtcclxuICAgICAgICByZXR1cm4gY29uZmlnW2tleV07XHJcbiAgICAgIH0sXHJcbiAgICAgICQkd2F0Y2hFeHByOiB3YXRjaEV4cHJcclxuICAgIH07XHJcbiAgfTtcclxufVxyXG5cclxuXHJcbm5nQXJpYU1vZHVsZS5kaXJlY3RpdmUoJ25nU2hvdycsIFsnJGFyaWEnLCBmdW5jdGlvbigkYXJpYSkge1xyXG4gIHJldHVybiAkYXJpYS4kJHdhdGNoRXhwcignbmdTaG93JywgJ2FyaWEtaGlkZGVuJywgdHJ1ZSk7XHJcbn1dKVxyXG4uZGlyZWN0aXZlKCduZ0hpZGUnLCBbJyRhcmlhJywgZnVuY3Rpb24oJGFyaWEpIHtcclxuICByZXR1cm4gJGFyaWEuJCR3YXRjaEV4cHIoJ25nSGlkZScsICdhcmlhLWhpZGRlbicsIGZhbHNlKTtcclxufV0pXHJcbi5kaXJlY3RpdmUoJ25nTW9kZWwnLCBbJyRhcmlhJywgZnVuY3Rpb24oJGFyaWEpIHtcclxuXHJcbiAgZnVuY3Rpb24gc2hvdWxkQXR0YWNoQXR0cihhdHRyLCBub3JtYWxpemVkQXR0ciwgZWxlbSkge1xyXG4gICAgcmV0dXJuICRhcmlhLmNvbmZpZyhub3JtYWxpemVkQXR0cikgJiYgIWVsZW0uYXR0cihhdHRyKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGdldFNoYXBlKGF0dHIsIGVsZW0pIHtcclxuICAgIHZhciB0eXBlID0gYXR0ci50eXBlLFxyXG4gICAgICAgIHJvbGUgPSBhdHRyLnJvbGU7XHJcblxyXG4gICAgcmV0dXJuICgodHlwZSB8fCByb2xlKSA9PT0gJ2NoZWNrYm94JyB8fCByb2xlID09PSAnbWVudWl0ZW1jaGVja2JveCcpID8gJ2NoZWNrYm94JyA6XHJcbiAgICAgICAgICAgKCh0eXBlIHx8IHJvbGUpID09PSAncmFkaW8nICAgIHx8IHJvbGUgPT09ICdtZW51aXRlbXJhZGlvJykgPyAncmFkaW8nIDpcclxuICAgICAgICAgICAodHlwZSA9PT0gJ3JhbmdlJyAgICAgICAgICAgICAgfHwgcm9sZSA9PT0gJ3Byb2dyZXNzYmFyJyB8fCByb2xlID09PSAnc2xpZGVyJykgPyAncmFuZ2UnIDpcclxuICAgICAgICAgICAodHlwZSB8fCByb2xlKSA9PT0gJ3RleHRib3gnICAgfHwgZWxlbVswXS5ub2RlTmFtZSA9PT0gJ1RFWFRBUkVBJyA/ICdtdWx0aWxpbmUnIDogJyc7XHJcbiAgfVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgIHJlcXVpcmU6ICc/bmdNb2RlbCcsXHJcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbSwgYXR0ciwgbmdNb2RlbCkge1xyXG4gICAgICB2YXIgc2hhcGUgPSBnZXRTaGFwZShhdHRyLCBlbGVtKTtcclxuICAgICAgdmFyIG5lZWRzVGFiSW5kZXggPSBzaG91bGRBdHRhY2hBdHRyKCd0YWJpbmRleCcsICd0YWJpbmRleCcsIGVsZW0pO1xyXG5cclxuICAgICAgZnVuY3Rpb24gbmdBcmlhV2F0Y2hNb2RlbFZhbHVlKCkge1xyXG4gICAgICAgIHJldHVybiBuZ01vZGVsLiRtb2RlbFZhbHVlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBnZXRSYWRpb1JlYWN0aW9uKCkge1xyXG4gICAgICAgIGlmIChuZWVkc1RhYkluZGV4KSB7XHJcbiAgICAgICAgICBuZWVkc1RhYkluZGV4ID0gZmFsc2U7XHJcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gbmdBcmlhUmFkaW9SZWFjdGlvbihuZXdWYWwpIHtcclxuICAgICAgICAgICAgdmFyIGJvb2xWYWwgPSBuZXdWYWwgPT09IGF0dHIudmFsdWU7XHJcbiAgICAgICAgICAgIGVsZW0uYXR0cignYXJpYS1jaGVja2VkJywgYm9vbFZhbCk7XHJcbiAgICAgICAgICAgIGVsZW0uYXR0cigndGFiaW5kZXgnLCAwIC0gIWJvb2xWYWwpO1xyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIG5nQXJpYVJhZGlvUmVhY3Rpb24obmV3VmFsKSB7XHJcbiAgICAgICAgICAgIGVsZW0uYXR0cignYXJpYS1jaGVja2VkJywgbmV3VmFsID09PSBhdHRyLnZhbHVlKTtcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBuZ0FyaWFDaGVja2JveFJlYWN0aW9uKG5ld1ZhbCkge1xyXG4gICAgICAgIGVsZW0uYXR0cignYXJpYS1jaGVja2VkJywgISFuZXdWYWwpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBzd2l0Y2ggKHNoYXBlKSB7XHJcbiAgICAgICAgY2FzZSAncmFkaW8nOlxyXG4gICAgICAgIGNhc2UgJ2NoZWNrYm94JzpcclxuICAgICAgICAgIGlmIChzaG91bGRBdHRhY2hBdHRyKCdhcmlhLWNoZWNrZWQnLCAnYXJpYUNoZWNrZWQnLCBlbGVtKSkge1xyXG4gICAgICAgICAgICBzY29wZS4kd2F0Y2gobmdBcmlhV2F0Y2hNb2RlbFZhbHVlLCBzaGFwZSA9PT0gJ3JhZGlvJyA/XHJcbiAgICAgICAgICAgICAgICBnZXRSYWRpb1JlYWN0aW9uKCkgOiBuZ0FyaWFDaGVja2JveFJlYWN0aW9uKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3JhbmdlJzpcclxuICAgICAgICAgIGlmICgkYXJpYS5jb25maWcoJ2FyaWFWYWx1ZScpKSB7XHJcbiAgICAgICAgICAgIGlmIChhdHRyLm1pbiAmJiAhZWxlbS5hdHRyKCdhcmlhLXZhbHVlbWluJykpIHtcclxuICAgICAgICAgICAgICBlbGVtLmF0dHIoJ2FyaWEtdmFsdWVtaW4nLCBhdHRyLm1pbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGF0dHIubWF4ICYmICFlbGVtLmF0dHIoJ2FyaWEtdmFsdWVtYXgnKSkge1xyXG4gICAgICAgICAgICAgIGVsZW0uYXR0cignYXJpYS12YWx1ZW1heCcsIGF0dHIubWF4KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIWVsZW0uYXR0cignYXJpYS12YWx1ZW5vdycpKSB7XHJcbiAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoKG5nQXJpYVdhdGNoTW9kZWxWYWx1ZSwgZnVuY3Rpb24gbmdBcmlhVmFsdWVOb3dSZWFjdGlvbihuZXdWYWwpIHtcclxuICAgICAgICAgICAgICAgIGVsZW0uYXR0cignYXJpYS12YWx1ZW5vdycsIG5ld1ZhbCk7XHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ211bHRpbGluZSc6XHJcbiAgICAgICAgICBpZiAoc2hvdWxkQXR0YWNoQXR0cignYXJpYS1tdWx0aWxpbmUnLCAnYXJpYU11bHRpbGluZScsIGVsZW0pKSB7XHJcbiAgICAgICAgICAgIGVsZW0uYXR0cignYXJpYS1tdWx0aWxpbmUnLCB0cnVlKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAobmVlZHNUYWJJbmRleCkge1xyXG4gICAgICAgIGVsZW0uYXR0cigndGFiaW5kZXgnLCAwKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKG5nTW9kZWwuJHZhbGlkYXRvcnMucmVxdWlyZWQgJiYgc2hvdWxkQXR0YWNoQXR0cignYXJpYS1yZXF1aXJlZCcsICdhcmlhUmVxdWlyZWQnLCBlbGVtKSkge1xyXG4gICAgICAgIHNjb3BlLiR3YXRjaChmdW5jdGlvbiBuZ0FyaWFSZXF1aXJlZFdhdGNoKCkge1xyXG4gICAgICAgICAgcmV0dXJuIG5nTW9kZWwuJGVycm9yLnJlcXVpcmVkO1xyXG4gICAgICAgIH0sIGZ1bmN0aW9uIG5nQXJpYVJlcXVpcmVkUmVhY3Rpb24obmV3VmFsKSB7XHJcbiAgICAgICAgICBlbGVtLmF0dHIoJ2FyaWEtcmVxdWlyZWQnLCAhIW5ld1ZhbCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChzaG91bGRBdHRhY2hBdHRyKCdhcmlhLWludmFsaWQnLCAnYXJpYUludmFsaWQnLCBlbGVtKSkge1xyXG4gICAgICAgIHNjb3BlLiR3YXRjaChmdW5jdGlvbiBuZ0FyaWFJbnZhbGlkV2F0Y2goKSB7XHJcbiAgICAgICAgICByZXR1cm4gbmdNb2RlbC4kaW52YWxpZDtcclxuICAgICAgICB9LCBmdW5jdGlvbiBuZ0FyaWFJbnZhbGlkUmVhY3Rpb24obmV3VmFsKSB7XHJcbiAgICAgICAgICBlbGVtLmF0dHIoJ2FyaWEtaW52YWxpZCcsICEhbmV3VmFsKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH07XHJcbn1dKVxyXG4uZGlyZWN0aXZlKCduZ0Rpc2FibGVkJywgWyckYXJpYScsIGZ1bmN0aW9uKCRhcmlhKSB7XHJcbiAgcmV0dXJuICRhcmlhLiQkd2F0Y2hFeHByKCduZ0Rpc2FibGVkJywgJ2FyaWEtZGlzYWJsZWQnKTtcclxufV0pXHJcbi5kaXJlY3RpdmUoJ25nTWVzc2FnZXMnLCBmdW5jdGlvbigpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgIHJlcXVpcmU6ICc/bmdNZXNzYWdlcycsXHJcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbSwgYXR0ciwgbmdNZXNzYWdlcykge1xyXG4gICAgICBpZiAoIWVsZW0uYXR0cignYXJpYS1saXZlJykpIHtcclxuICAgICAgICBlbGVtLmF0dHIoJ2FyaWEtbGl2ZScsICdhc3NlcnRpdmUnKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH07XHJcbn0pXHJcbi5kaXJlY3RpdmUoJ25nQ2xpY2snLFsnJGFyaWEnLCAnJHBhcnNlJywgZnVuY3Rpb24oJGFyaWEsICRwYXJzZSkge1xyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgY29tcGlsZTogZnVuY3Rpb24oZWxlbSwgYXR0cikge1xyXG4gICAgICB2YXIgZm4gPSAkcGFyc2UoYXR0ci5uZ0NsaWNrLCAvKiBpbnRlcmNlcHRvckZuICovIG51bGwsIC8qIGV4cGVuc2l2ZUNoZWNrcyAqLyB0cnVlKTtcclxuICAgICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBlbGVtLCBhdHRyKSB7XHJcbiAgICAgICAgaWYgKCRhcmlhLmNvbmZpZygndGFiaW5kZXgnKSAmJiAhZWxlbS5hdHRyKCd0YWJpbmRleCcpKSB7XHJcbiAgICAgICAgICBlbGVtLmF0dHIoJ3RhYmluZGV4JywgMCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoJGFyaWEuY29uZmlnKCdiaW5kS2V5cHJlc3MnKSAmJiAhYXR0ci5uZ0tleXByZXNzKSB7XHJcbiAgICAgICAgICBlbGVtLm9uKCdrZXlwcmVzcycsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAzMiB8fCBldmVudC5rZXlDb2RlID09PSAxMykge1xyXG4gICAgICAgICAgICAgIHNjb3BlLiRhcHBseShjYWxsYmFjayk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGNhbGxiYWNrKCkge1xyXG4gICAgICAgICAgICAgIGZuKHNjb3BlLCB7ICRldmVudDogZXZlbnQgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgIH1cclxuICB9O1xyXG59XSlcclxuLmRpcmVjdGl2ZSgnbmdEYmxjbGljaycsIFsnJGFyaWEnLCBmdW5jdGlvbigkYXJpYSkge1xyXG4gIHJldHVybiBmdW5jdGlvbihzY29wZSwgZWxlbSwgYXR0cikge1xyXG4gICAgaWYgKCRhcmlhLmNvbmZpZygndGFiaW5kZXgnKSAmJiAhZWxlbS5hdHRyKCd0YWJpbmRleCcpKSB7XHJcbiAgICAgIGVsZW0uYXR0cigndGFiaW5kZXgnLCAwKTtcclxuICAgIH1cclxuICB9O1xyXG59XSk7XHJcblxyXG5cclxufSkod2luZG93LCB3aW5kb3cuYW5ndWxhcik7XHJcbiIsIi8qIVxyXG4gKiBBbmd1bGFyIE1hdGVyaWFsIERlc2lnblxyXG4gKiBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9tYXRlcmlhbFxyXG4gKiBAbGljZW5zZSBNSVRcclxuICogdjAuMTAuMC1tYXN0ZXItNmU5YWJkZFxyXG4gKi9cclxuKGZ1bmN0aW9uKCB3aW5kb3csIGFuZ3VsYXIsIHVuZGVmaW5lZCApe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCduZ01hdGVyaWFsJywgW1wibmdcIixcIm5nQW5pbWF0ZVwiLFwibmdBcmlhXCIsXCJtYXRlcmlhbC5jb3JlXCIsXCJtYXRlcmlhbC5jb3JlLmdlc3R1cmVzXCIsXCJtYXRlcmlhbC5jb3JlLnRoZW1pbmcucGFsZXR0ZVwiLFwibWF0ZXJpYWwuY29yZS50aGVtaW5nXCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLmF1dG9jb21wbGV0ZVwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5iYWNrZHJvcFwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5ib3R0b21TaGVldFwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5idXR0b25cIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuY2FyZFwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5jaGVja2JveFwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5jaGlwc1wiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5jb250ZW50XCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLmRpYWxvZ1wiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5kaXZpZGVyXCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLmZhYkFjdGlvbnNcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuZmFiU3BlZWREaWFsXCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLmZhYlRvb2xiYXJcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuZmFiVHJpZ2dlclwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5ncmlkTGlzdFwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5pY29uXCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLmlucHV0XCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLmxpc3RcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMubWVudVwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5wcm9ncmVzc0NpcmN1bGFyXCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLnByb2dyZXNzTGluZWFyXCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLnJhZGlvQnV0dG9uXCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLnNlbGVjdFwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5zaWRlbmF2XCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLnNsaWRlclwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5zdGlja3lcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuc3ViaGVhZGVyXCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLnN3aXBlXCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLnN3aXRjaFwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy50YWJzXCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLnRvYXN0XCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLnRvb2xiYXJcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMudG9vbHRpcFwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy53aGl0ZWZyYW1lXCJdKTtcclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXphdGlvbiBmdW5jdGlvbiB0aGF0IHZhbGlkYXRlcyBlbnZpcm9ubWVudFxyXG4gKiByZXF1aXJlbWVudHMuXHJcbiAqL1xyXG5hbmd1bGFyXHJcbiAgLm1vZHVsZSgnbWF0ZXJpYWwuY29yZScsIFsgJ21hdGVyaWFsLmNvcmUuZ2VzdHVyZXMnLCAnbWF0ZXJpYWwuY29yZS50aGVtaW5nJyBdKVxyXG4gIC5jb25maWcoIE1kQ29yZUNvbmZpZ3VyZSApO1xyXG5cclxuXHJcbmZ1bmN0aW9uIE1kQ29yZUNvbmZpZ3VyZSgkcHJvdmlkZSwgJG1kVGhlbWluZ1Byb3ZpZGVyKSB7XHJcblxyXG4gICRwcm92aWRlLmRlY29yYXRvcignJCRyQUYnLCBbXCIkZGVsZWdhdGVcIiwgckFGRGVjb3JhdG9yXSk7XHJcblxyXG4gICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnZGVmYXVsdCcpXHJcbiAgICAucHJpbWFyeVBhbGV0dGUoJ2luZGlnbycpXHJcbiAgICAuYWNjZW50UGFsZXR0ZSgncGluaycpXHJcbiAgICAud2FyblBhbGV0dGUoJ3JlZCcpXHJcbiAgICAuYmFja2dyb3VuZFBhbGV0dGUoJ2dyZXknKTtcclxufVxyXG5NZENvcmVDb25maWd1cmUuJGluamVjdCA9IFtcIiRwcm92aWRlXCIsIFwiJG1kVGhlbWluZ1Byb3ZpZGVyXCJdO1xyXG5cclxuZnVuY3Rpb24gckFGRGVjb3JhdG9yKCAkZGVsZWdhdGUgKSB7XHJcbiAgLyoqXHJcbiAgICogVXNlIHRoaXMgdG8gdGhyb3R0bGUgZXZlbnRzIHRoYXQgY29tZSBpbiBvZnRlbi5cclxuICAgKiBUaGUgdGhyb3R0bGVkIGZ1bmN0aW9uIHdpbGwgYWx3YXlzIHVzZSB0aGUgKmxhc3QqIGludm9jYXRpb24gYmVmb3JlIHRoZVxyXG4gICAqIGNvbWluZyBmcmFtZS5cclxuICAgKlxyXG4gICAqIEZvciBleGFtcGxlLCB3aW5kb3cgcmVzaXplIGV2ZW50cyB0aGF0IGZpcmUgbWFueSB0aW1lcyBhIHNlY29uZDpcclxuICAgKiBJZiB3ZSBzZXQgdG8gdXNlIGFuIHJhZi10aHJvdHRsZWQgY2FsbGJhY2sgb24gd2luZG93IHJlc2l6ZSwgdGhlblxyXG4gICAqIG91ciBjYWxsYmFjayB3aWxsIG9ubHkgYmUgZmlyZWQgb25jZSBwZXIgZnJhbWUsIHdpdGggdGhlIGxhc3QgcmVzaXplXHJcbiAgICogZXZlbnQgdGhhdCBoYXBwZW5lZCBiZWZvcmUgdGhhdCBmcmFtZS5cclxuICAgKlxyXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIGZ1bmN0aW9uIHRvIGRlYm91bmNlXHJcbiAgICovXHJcbiAgJGRlbGVnYXRlLnRocm90dGxlID0gZnVuY3Rpb24oY2IpIHtcclxuICAgIHZhciBxdWV1ZUFyZ3MsIGFscmVhZHlRdWV1ZWQsIHF1ZXVlQ2IsIGNvbnRleHQ7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gZGVib3VuY2VkKCkge1xyXG4gICAgICBxdWV1ZUFyZ3MgPSBhcmd1bWVudHM7XHJcbiAgICAgIGNvbnRleHQgPSB0aGlzO1xyXG4gICAgICBxdWV1ZUNiID0gY2I7XHJcbiAgICAgIGlmICghYWxyZWFkeVF1ZXVlZCkge1xyXG4gICAgICAgIGFscmVhZHlRdWV1ZWQgPSB0cnVlO1xyXG4gICAgICAgICRkZWxlZ2F0ZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgIHF1ZXVlQ2IuYXBwbHkoY29udGV4dCwgcXVldWVBcmdzKTtcclxuICAgICAgICAgIGFscmVhZHlRdWV1ZWQgPSBmYWxzZTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9O1xyXG4gIHJldHVybiAkZGVsZWdhdGU7XHJcbn1cclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb3JlJylcclxuLmZhY3RvcnkoJyRtZENvbnN0YW50JywgTWRDb25zdGFudEZhY3RvcnkpO1xyXG5cclxuZnVuY3Rpb24gTWRDb25zdGFudEZhY3RvcnkoJCRyQUYsICRzbmlmZmVyKSB7XHJcblxyXG4gIHZhciB3ZWJraXQgPSAvd2Via2l0L2kudGVzdCgkc25pZmZlci52ZW5kb3JQcmVmaXgpO1xyXG4gIGZ1bmN0aW9uIHZlbmRvclByb3BlcnR5KG5hbWUpIHtcclxuICAgIHJldHVybiB3ZWJraXQgPyAgKCd3ZWJraXQnICsgbmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIG5hbWUuc3Vic3RyaW5nKDEpKSA6IG5hbWU7XHJcbiAgfVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgS0VZX0NPREU6IHtcclxuICAgICAgRU5URVI6IDEzLFxyXG4gICAgICBFU0NBUEU6IDI3LFxyXG4gICAgICBTUEFDRTogMzIsXHJcbiAgICAgIExFRlRfQVJST1cgOiAzNyxcclxuICAgICAgVVBfQVJST1cgOiAzOCxcclxuICAgICAgUklHSFRfQVJST1cgOiAzOSxcclxuICAgICAgRE9XTl9BUlJPVyA6IDQwLFxyXG4gICAgICBUQUIgOiA5LFxyXG4gICAgICBCQUNLU1BBQ0U6IDgsXHJcbiAgICAgIERFTEVURTogNDZcclxuICAgIH0sXHJcbiAgICBDU1M6IHtcclxuICAgICAgLyogQ29uc3RhbnRzICovXHJcbiAgICAgIFRSQU5TSVRJT05FTkQ6ICd0cmFuc2l0aW9uZW5kJyArICh3ZWJraXQgPyAnIHdlYmtpdFRyYW5zaXRpb25FbmQnIDogJycpLFxyXG4gICAgICBBTklNQVRJT05FTkQ6ICdhbmltYXRpb25lbmQnICsgKHdlYmtpdCA/ICcgd2Via2l0QW5pbWF0aW9uRW5kJyA6ICcnKSxcclxuXHJcbiAgICAgIFRSQU5TRk9STTogdmVuZG9yUHJvcGVydHkoJ3RyYW5zZm9ybScpLFxyXG4gICAgICBUUkFOU0ZPUk1fT1JJR0lOOiB2ZW5kb3JQcm9wZXJ0eSgndHJhbnNmb3JtT3JpZ2luJyksXHJcbiAgICAgIFRSQU5TSVRJT046IHZlbmRvclByb3BlcnR5KCd0cmFuc2l0aW9uJyksXHJcbiAgICAgIFRSQU5TSVRJT05fRFVSQVRJT046IHZlbmRvclByb3BlcnR5KCd0cmFuc2l0aW9uRHVyYXRpb24nKSxcclxuICAgICAgQU5JTUFUSU9OX1BMQVlfU1RBVEU6IHZlbmRvclByb3BlcnR5KCdhbmltYXRpb25QbGF5U3RhdGUnKSxcclxuICAgICAgQU5JTUFUSU9OX0RVUkFUSU9OOiB2ZW5kb3JQcm9wZXJ0eSgnYW5pbWF0aW9uRHVyYXRpb24nKSxcclxuICAgICAgQU5JTUFUSU9OX05BTUU6IHZlbmRvclByb3BlcnR5KCdhbmltYXRpb25OYW1lJyksXHJcbiAgICAgIEFOSU1BVElPTl9USU1JTkc6IHZlbmRvclByb3BlcnR5KCdhbmltYXRpb25UaW1pbmdGdW5jdGlvbicpLFxyXG4gICAgICBBTklNQVRJT05fRElSRUNUSU9OOiB2ZW5kb3JQcm9wZXJ0eSgnYW5pbWF0aW9uRGlyZWN0aW9uJylcclxuICAgIH0sXHJcbiAgICBNRURJQToge1xyXG4gICAgICAnc20nOiAnKG1heC13aWR0aDogNjAwcHgpJyxcclxuICAgICAgJ2d0LXNtJzogJyhtaW4td2lkdGg6IDYwMHB4KScsXHJcbiAgICAgICdtZCc6ICcobWluLXdpZHRoOiA2MDBweCkgYW5kIChtYXgtd2lkdGg6IDk2MHB4KScsXHJcbiAgICAgICdndC1tZCc6ICcobWluLXdpZHRoOiA5NjBweCknLFxyXG4gICAgICAnbGcnOiAnKG1pbi13aWR0aDogOTYwcHgpIGFuZCAobWF4LXdpZHRoOiAxMjAwcHgpJyxcclxuICAgICAgJ2d0LWxnJzogJyhtaW4td2lkdGg6IDEyMDBweCknXHJcbiAgICB9LFxyXG4gICAgTUVESUFfUFJJT1JJVFk6IFtcclxuICAgICAgJ2d0LWxnJyxcclxuICAgICAgJ2xnJyxcclxuICAgICAgJ2d0LW1kJyxcclxuICAgICAgJ21kJyxcclxuICAgICAgJ2d0LXNtJyxcclxuICAgICAgJ3NtJ1xyXG4gICAgXVxyXG4gIH07XHJcbn1cclxuTWRDb25zdGFudEZhY3RvcnkuJGluamVjdCA9IFtcIiQkckFGXCIsIFwiJHNuaWZmZXJcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gIGFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvcmUnKVxyXG4gICAgLmNvbmZpZyggW1wiJHByb3ZpZGVcIiwgZnVuY3Rpb24oJHByb3ZpZGUpe1xyXG4gICAgICAgJHByb3ZpZGUuZGVjb3JhdG9yKCckbWRVdGlsJywgWyckZGVsZWdhdGUnLCBmdW5jdGlvbiAoJGRlbGVnYXRlKXtcclxuICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgKiBJbmplY3QgdGhlIGl0ZXJhdG9yIGZhY2FkZSB0byBlYXNpbHkgc3VwcG9ydCBpdGVyYXRpb24gYW5kIGFjY2Vzc29yc1xyXG4gICAgICAgICAgICAqIEBzZWUgaXRlcmF0b3IgYmVsb3dcclxuICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAkZGVsZWdhdGUuaXRlcmF0b3IgPSBNZEl0ZXJhdG9yO1xyXG5cclxuICAgICAgICAgICByZXR1cm4gJGRlbGVnYXRlO1xyXG4gICAgICAgICB9XHJcbiAgICAgICBdKTtcclxuICAgICB9XSk7XHJcblxyXG4gIC8qKlxyXG4gICAqIGl0ZXJhdG9yIGlzIGEgbGlzdCBmYWNhZGUgdG8gZWFzaWx5IHN1cHBvcnQgaXRlcmF0aW9uIGFuZCBhY2Nlc3NvcnNcclxuICAgKlxyXG4gICAqIEBwYXJhbSBpdGVtcyBBcnJheSBsaXN0IHdoaWNoIHRoaXMgaXRlcmF0b3Igd2lsbCBlbnVtZXJhdGVcclxuICAgKiBAcGFyYW0gcmVsb29wIEJvb2xlYW4gZW5hYmxlcyBpdGVyYXRvciB0byBjb25zaWRlciB0aGUgbGlzdCBhcyBhbiBlbmRsZXNzIHJlbG9vcFxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIE1kSXRlcmF0b3IoaXRlbXMsIHJlbG9vcCkge1xyXG4gICAgdmFyIHRydWVGbiA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdHJ1ZTsgfTtcclxuXHJcbiAgICBpZiAoaXRlbXMgJiYgIWFuZ3VsYXIuaXNBcnJheShpdGVtcykpIHtcclxuICAgICAgaXRlbXMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChpdGVtcyk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVsb29wID0gISFyZWxvb3A7XHJcbiAgICB2YXIgX2l0ZW1zID0gaXRlbXMgfHwgWyBdO1xyXG5cclxuICAgIC8vIFB1Ymxpc2hlZCBBUElcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGl0ZW1zOiBnZXRJdGVtcyxcclxuICAgICAgY291bnQ6IGNvdW50LFxyXG5cclxuICAgICAgaW5SYW5nZTogaW5SYW5nZSxcclxuICAgICAgY29udGFpbnM6IGNvbnRhaW5zLFxyXG4gICAgICBpbmRleE9mOiBpbmRleE9mLFxyXG4gICAgICBpdGVtQXQ6IGl0ZW1BdCxcclxuXHJcbiAgICAgIGZpbmRCeTogZmluZEJ5LFxyXG5cclxuICAgICAgYWRkOiBhZGQsXHJcbiAgICAgIHJlbW92ZTogcmVtb3ZlLFxyXG5cclxuICAgICAgZmlyc3Q6IGZpcnN0LFxyXG4gICAgICBsYXN0OiBsYXN0LFxyXG4gICAgICBuZXh0OiBhbmd1bGFyLmJpbmQobnVsbCwgZmluZFN1YnNlcXVlbnRJdGVtLCBmYWxzZSksXHJcbiAgICAgIHByZXZpb3VzOiBhbmd1bGFyLmJpbmQobnVsbCwgZmluZFN1YnNlcXVlbnRJdGVtLCB0cnVlKSxcclxuXHJcbiAgICAgIGhhc1ByZXZpb3VzOiBoYXNQcmV2aW91cyxcclxuICAgICAgaGFzTmV4dDogaGFzTmV4dFxyXG5cclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQdWJsaXNoIGNvcHkgb2YgdGhlIGVudW1lcmFibGUgc2V0XHJcbiAgICAgKiBAcmV0dXJucyB7QXJyYXl8Kn1cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZ2V0SXRlbXMoKSB7XHJcbiAgICAgIHJldHVybiBbXS5jb25jYXQoX2l0ZW1zKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIERldGVybWluZSBsZW5ndGggb2YgdGhlIGxpc3RcclxuICAgICAqIEByZXR1cm5zIHtBcnJheS5sZW5ndGh8KnxudW1iZXJ9XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGNvdW50KCkge1xyXG4gICAgICByZXR1cm4gX2l0ZW1zLmxlbmd0aDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIElzIHRoZSBpbmRleCBzcGVjaWZpZWQgdmFsaWRcclxuICAgICAqIEBwYXJhbSBpbmRleFxyXG4gICAgICogQHJldHVybnMge0FycmF5Lmxlbmd0aHwqfG51bWJlcnxib29sZWFufVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBpblJhbmdlKGluZGV4KSB7XHJcbiAgICAgIHJldHVybiBfaXRlbXMubGVuZ3RoICYmICggaW5kZXggPiAtMSApICYmIChpbmRleCA8IF9pdGVtcy5sZW5ndGggKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENhbiB0aGUgaXRlcmF0b3IgcHJvY2VlZCB0byB0aGUgbmV4dCBpdGVtIGluIHRoZSBsaXN0OyByZWxhdGl2ZSB0b1xyXG4gICAgICogdGhlIHNwZWNpZmllZCBpdGVtLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBpdGVtXHJcbiAgICAgKiBAcmV0dXJucyB7QXJyYXkubGVuZ3RofCp8bnVtYmVyfGJvb2xlYW59XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGhhc05leHQoaXRlbSkge1xyXG4gICAgICByZXR1cm4gaXRlbSA/IGluUmFuZ2UoaW5kZXhPZihpdGVtKSArIDEpIDogZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDYW4gdGhlIGl0ZXJhdG9yIHByb2NlZWQgdG8gdGhlIHByZXZpb3VzIGl0ZW0gaW4gdGhlIGxpc3Q7IHJlbGF0aXZlIHRvXHJcbiAgICAgKiB0aGUgc3BlY2lmaWVkIGl0ZW0uXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGl0ZW1cclxuICAgICAqIEByZXR1cm5zIHtBcnJheS5sZW5ndGh8KnxudW1iZXJ8Ym9vbGVhbn1cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gaGFzUHJldmlvdXMoaXRlbSkge1xyXG4gICAgICByZXR1cm4gaXRlbSA/IGluUmFuZ2UoaW5kZXhPZihpdGVtKSAtIDEpIDogZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgaXRlbSBhdCBzcGVjaWZpZWQgaW5kZXgvcG9zaXRpb25cclxuICAgICAqIEBwYXJhbSBpbmRleFxyXG4gICAgICogQHJldHVybnMgeyp9XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGl0ZW1BdChpbmRleCkge1xyXG4gICAgICByZXR1cm4gaW5SYW5nZShpbmRleCkgPyBfaXRlbXNbaW5kZXhdIDogbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEZpbmQgYWxsIGVsZW1lbnRzIG1hdGNoaW5nIHRoZSBrZXkvdmFsdWUgcGFpclxyXG4gICAgICogb3RoZXJ3aXNlIHJldHVybiBudWxsXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHZhbFxyXG4gICAgICogQHBhcmFtIGtleVxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm4gYXJyYXlcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZmluZEJ5KGtleSwgdmFsKSB7XHJcbiAgICAgIHJldHVybiBfaXRlbXMuZmlsdGVyKGZ1bmN0aW9uKGl0ZW0pIHtcclxuICAgICAgICByZXR1cm4gaXRlbVtrZXldID09PSB2YWw7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQWRkIGl0ZW0gdG8gbGlzdFxyXG4gICAgICogQHBhcmFtIGl0ZW1cclxuICAgICAqIEBwYXJhbSBpbmRleFxyXG4gICAgICogQHJldHVybnMgeyp9XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGFkZChpdGVtLCBpbmRleCkge1xyXG4gICAgICBpZiAoICFpdGVtICkgcmV0dXJuIC0xO1xyXG5cclxuICAgICAgaWYgKCFhbmd1bGFyLmlzTnVtYmVyKGluZGV4KSkge1xyXG4gICAgICAgIGluZGV4ID0gX2l0ZW1zLmxlbmd0aDtcclxuICAgICAgfVxyXG5cclxuICAgICAgX2l0ZW1zLnNwbGljZShpbmRleCwgMCwgaXRlbSk7XHJcblxyXG4gICAgICByZXR1cm4gaW5kZXhPZihpdGVtKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlbW92ZSBpdGVtIGZyb20gbGlzdC4uLlxyXG4gICAgICogQHBhcmFtIGl0ZW1cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gcmVtb3ZlKGl0ZW0pIHtcclxuICAgICAgaWYgKCBjb250YWlucyhpdGVtKSApe1xyXG4gICAgICAgIF9pdGVtcy5zcGxpY2UoaW5kZXhPZihpdGVtKSwgMSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCB0aGUgemVyby1iYXNlZCBpbmRleCBvZiB0aGUgdGFyZ2V0IGl0ZW1cclxuICAgICAqIEBwYXJhbSBpdGVtXHJcbiAgICAgKiBAcmV0dXJucyB7Kn1cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gaW5kZXhPZihpdGVtKSB7XHJcbiAgICAgIHJldHVybiBfaXRlbXMuaW5kZXhPZihpdGVtKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEJvb2xlYW4gZXhpc3RlbmNlIGNoZWNrXHJcbiAgICAgKiBAcGFyYW0gaXRlbVxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGNvbnRhaW5zKGl0ZW0pIHtcclxuICAgICAgcmV0dXJuIGl0ZW0gJiYgKGluZGV4T2YoaXRlbSkgPiAtMSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gZmlyc3QgaXRlbSBpbiB0aGUgbGlzdFxyXG4gICAgICogQHJldHVybnMgeyp9XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGZpcnN0KCkge1xyXG4gICAgICByZXR1cm4gX2l0ZW1zLmxlbmd0aCA/IF9pdGVtc1swXSA6IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gbGFzdCBpdGVtIGluIHRoZSBsaXN0Li4uXHJcbiAgICAgKiBAcmV0dXJucyB7Kn1cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gbGFzdCgpIHtcclxuICAgICAgcmV0dXJuIF9pdGVtcy5sZW5ndGggPyBfaXRlbXNbX2l0ZW1zLmxlbmd0aCAtIDFdIDogbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEZpbmQgdGhlIG5leHQgaXRlbS4gSWYgcmVsb29wIGlzIHRydWUgYW5kIGF0IHRoZSBlbmQgb2YgdGhlIGxpc3QsIGl0IHdpbGwgZ28gYmFjayB0byB0aGVcclxuICAgICAqIGZpcnN0IGl0ZW0uIElmIGdpdmVuLCB0aGUgYHZhbGlkYXRlYCBjYWxsYmFjayB3aWxsIGJlIHVzZWQgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIG5leHQgaXRlbVxyXG4gICAgICogaXMgdmFsaWQuIElmIG5vdCB2YWxpZCwgaXQgd2lsbCB0cnkgdG8gZmluZCB0aGUgbmV4dCBpdGVtIGFnYWluLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gYmFja3dhcmRzIFNwZWNpZmllcyB0aGUgZGlyZWN0aW9uIG9mIHNlYXJjaGluZyAoZm9yd2FyZHMvYmFja3dhcmRzKVxyXG4gICAgICogQHBhcmFtIHsqfSBpdGVtIFRoZSBpdGVtIHdob3NlIHN1YnNlcXVlbnQgaXRlbSB3ZSBhcmUgbG9va2luZyBmb3JcclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb249fSB2YWxpZGF0ZSBUaGUgYHZhbGlkYXRlYCBmdW5jdGlvblxyXG4gICAgICogQHBhcmFtIHtpbnRlZ2VyPX0gbGltaXQgVGhlIHJlY3Vyc2lvbiBsaW1pdFxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm5zIHsqfSBUaGUgc3Vic2VxdWVudCBpdGVtIG9yIG51bGxcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZmluZFN1YnNlcXVlbnRJdGVtKGJhY2t3YXJkcywgaXRlbSwgdmFsaWRhdGUsIGxpbWl0KSB7XHJcbiAgICAgIHZhbGlkYXRlID0gdmFsaWRhdGUgfHwgdHJ1ZUZuO1xyXG5cclxuICAgICAgdmFyIGN1ckluZGV4ID0gaW5kZXhPZihpdGVtKTtcclxuICAgICAgd2hpbGUgKHRydWUpIHtcclxuICAgICAgICBpZiAoIWluUmFuZ2UoY3VySW5kZXgpKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgdmFyIG5leHRJbmRleCA9IGN1ckluZGV4ICsgKGJhY2t3YXJkcyA/IC0xIDogMSk7XHJcbiAgICAgICAgdmFyIGZvdW5kSXRlbSA9IG51bGw7XHJcbiAgICAgICAgaWYgKGluUmFuZ2UobmV4dEluZGV4KSkge1xyXG4gICAgICAgICAgZm91bmRJdGVtID0gX2l0ZW1zW25leHRJbmRleF07XHJcbiAgICAgICAgfSBlbHNlIGlmIChyZWxvb3ApIHtcclxuICAgICAgICAgIGZvdW5kSXRlbSA9IGJhY2t3YXJkcyA/IGxhc3QoKSA6IGZpcnN0KCk7XHJcbiAgICAgICAgICBuZXh0SW5kZXggPSBpbmRleE9mKGZvdW5kSXRlbSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoKGZvdW5kSXRlbSA9PT0gbnVsbCkgfHwgKG5leHRJbmRleCA9PT0gbGltaXQpKSByZXR1cm4gbnVsbDtcclxuICAgICAgICBpZiAodmFsaWRhdGUoZm91bmRJdGVtKSkgcmV0dXJuIGZvdW5kSXRlbTtcclxuXHJcbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQobGltaXQpKSBsaW1pdCA9IG5leHRJbmRleDtcclxuXHJcbiAgICAgICAgY3VySW5kZXggPSBuZXh0SW5kZXg7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvcmUnKVxyXG4uZmFjdG9yeSgnJG1kTWVkaWEnLCBtZE1lZGlhRmFjdG9yeSk7XHJcblxyXG4vKipcclxuICogQG5nZG9jIHNlcnZpY2VcclxuICogQG5hbWUgJG1kTWVkaWFcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb3JlXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBgJG1kTWVkaWFgIGlzIHVzZWQgdG8gZXZhbHVhdGUgd2hldGhlciBhIGdpdmVuIG1lZGlhIHF1ZXJ5IGlzIHRydWUgb3IgZmFsc2UgZ2l2ZW4gdGhlXHJcbiAqIGN1cnJlbnQgZGV2aWNlJ3Mgc2NyZWVuIC8gd2luZG93IHNpemUuIFRoZSBtZWRpYSBxdWVyeSB3aWxsIGJlIHJlLWV2YWx1YXRlZCBvbiByZXNpemUsIGFsbG93aW5nXHJcbiAqIHlvdSB0byByZWdpc3RlciBhIHdhdGNoLlxyXG4gKlxyXG4gKiBgJG1kTWVkaWFgIGFsc28gaGFzIHByZS1wcm9ncmFtbWVkIHN1cHBvcnQgZm9yIG1lZGlhIHF1ZXJpZXMgdGhhdCBtYXRjaCB0aGUgbGF5b3V0IGJyZWFrcG9pbnRzLlxyXG4gKiAgKGBzbWAsIGBndC1zbWAsIGBtZGAsIGBndC1tZGAsIGBsZ2AsIGBndC1sZ2ApLlxyXG4gKlxyXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gYSBib29sZWFuIHJlcHJlc2VudGluZyB3aGV0aGVyIG9yIG5vdCB0aGUgZ2l2ZW4gbWVkaWEgcXVlcnkgaXMgdHJ1ZSBvciBmYWxzZS5cclxuICpcclxuICogQHVzYWdlXHJcbiAqIDxobGpzIGxhbmc9XCJqc1wiPlxyXG4gKiBhcHAuY29udHJvbGxlcignTXlDb250cm9sbGVyJywgZnVuY3Rpb24oJG1kTWVkaWEsICRzY29wZSkge1xyXG4gKiAgICRzY29wZS4kd2F0Y2goZnVuY3Rpb24oKSB7IHJldHVybiAkbWRNZWRpYSgnbGcnKTsgfSwgZnVuY3Rpb24oYmlnKSB7XHJcbiAqICAgICAkc2NvcGUuYmlnU2NyZWVuID0gYmlnO1xyXG4gKiAgIH0pO1xyXG4gKlxyXG4gKiAgICRzY29wZS5zY3JlZW5Jc1NtYWxsID0gJG1kTWVkaWEoJ3NtJyk7XHJcbiAqICAgJHNjb3BlLmN1c3RvbVF1ZXJ5ID0gJG1kTWVkaWEoJyhtaW4td2lkdGg6IDEyMzRweCknKTtcclxuICogICAkc2NvcGUuYW5vdGhlckN1c3RvbSA9ICRtZE1lZGlhKCdtYXgtd2lkdGg6IDMwMHB4Jyk7XHJcbiAqIH0pO1xyXG4gKiA8L2hsanM+XHJcbiAqL1xyXG5cclxuZnVuY3Rpb24gbWRNZWRpYUZhY3RvcnkoJG1kQ29uc3RhbnQsICRyb290U2NvcGUsICR3aW5kb3cpIHtcclxuICB2YXIgcXVlcmllcyA9IHt9O1xyXG4gIHZhciBtcWxzID0ge307XHJcbiAgdmFyIHJlc3VsdHMgPSB7fTtcclxuICB2YXIgbm9ybWFsaXplQ2FjaGUgPSB7fTtcclxuXHJcbiAgJG1kTWVkaWEuZ2V0UmVzcG9uc2l2ZUF0dHJpYnV0ZSA9IGdldFJlc3BvbnNpdmVBdHRyaWJ1dGU7XHJcbiAgJG1kTWVkaWEuZ2V0UXVlcnkgPSBnZXRRdWVyeTtcclxuICAkbWRNZWRpYS53YXRjaFJlc3BvbnNpdmVBdHRyaWJ1dGVzID0gd2F0Y2hSZXNwb25zaXZlQXR0cmlidXRlcztcclxuXHJcbiAgcmV0dXJuICRtZE1lZGlhO1xyXG5cclxuICBmdW5jdGlvbiAkbWRNZWRpYShxdWVyeSkge1xyXG4gICAgdmFyIHZhbGlkYXRlZCA9IHF1ZXJpZXNbcXVlcnldO1xyXG4gICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQodmFsaWRhdGVkKSkge1xyXG4gICAgICB2YWxpZGF0ZWQgPSBxdWVyaWVzW3F1ZXJ5XSA9IHZhbGlkYXRlKHF1ZXJ5KTtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgcmVzdWx0ID0gcmVzdWx0c1t2YWxpZGF0ZWRdO1xyXG4gICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQocmVzdWx0KSkge1xyXG4gICAgICByZXN1bHQgPSBhZGQodmFsaWRhdGVkKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gdmFsaWRhdGUocXVlcnkpIHtcclxuICAgIHJldHVybiAkbWRDb25zdGFudC5NRURJQVtxdWVyeV0gfHxcclxuICAgICAgICAgICAoKHF1ZXJ5LmNoYXJBdCgwKSAhPT0gJygnKSA/ICgnKCcgKyBxdWVyeSArICcpJykgOiBxdWVyeSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBhZGQocXVlcnkpIHtcclxuICAgIHZhciByZXN1bHQgPSBtcWxzW3F1ZXJ5XSA9ICR3aW5kb3cubWF0Y2hNZWRpYShxdWVyeSk7XHJcbiAgICByZXN1bHQuYWRkTGlzdGVuZXIob25RdWVyeUNoYW5nZSk7XHJcbiAgICByZXR1cm4gKHJlc3VsdHNbcmVzdWx0Lm1lZGlhXSA9ICEhcmVzdWx0Lm1hdGNoZXMpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gb25RdWVyeUNoYW5nZShxdWVyeSkge1xyXG4gICAgJHJvb3RTY29wZS4kZXZhbEFzeW5jKGZ1bmN0aW9uKCkge1xyXG4gICAgICByZXN1bHRzW3F1ZXJ5Lm1lZGlhXSA9ICEhcXVlcnkubWF0Y2hlcztcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZ2V0UXVlcnkobmFtZSkge1xyXG4gICAgcmV0dXJuIG1xbHNbbmFtZV07XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBnZXRSZXNwb25zaXZlQXR0cmlidXRlKGF0dHJzLCBhdHRyTmFtZSkge1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCAkbWRDb25zdGFudC5NRURJQV9QUklPUklUWS5sZW5ndGg7IGkrKykge1xyXG4gICAgICB2YXIgbWVkaWFOYW1lID0gJG1kQ29uc3RhbnQuTUVESUFfUFJJT1JJVFlbaV07XHJcbiAgICAgIGlmICghbXFsc1txdWVyaWVzW21lZGlhTmFtZV1dLm1hdGNoZXMpIHtcclxuICAgICAgICBjb250aW51ZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIG5vcm1hbGl6ZWROYW1lID0gZ2V0Tm9ybWFsaXplZE5hbWUoYXR0cnMsIGF0dHJOYW1lICsgJy0nICsgbWVkaWFOYW1lKTtcclxuICAgICAgaWYgKGF0dHJzW25vcm1hbGl6ZWROYW1lXSkge1xyXG4gICAgICAgIHJldHVybiBhdHRyc1tub3JtYWxpemVkTmFtZV07XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBmYWxsYmFjayBvbiB1bnByZWZpeGVkXHJcbiAgICByZXR1cm4gYXR0cnNbZ2V0Tm9ybWFsaXplZE5hbWUoYXR0cnMsIGF0dHJOYW1lKV07XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiB3YXRjaFJlc3BvbnNpdmVBdHRyaWJ1dGVzKGF0dHJOYW1lcywgYXR0cnMsIHdhdGNoRm4pIHtcclxuICAgIHZhciB1bndhdGNoRm5zID0gW107XHJcbiAgICBhdHRyTmFtZXMuZm9yRWFjaChmdW5jdGlvbihhdHRyTmFtZSkge1xyXG4gICAgICB2YXIgbm9ybWFsaXplZE5hbWUgPSBnZXROb3JtYWxpemVkTmFtZShhdHRycywgYXR0ck5hbWUpO1xyXG4gICAgICBpZiAoYXR0cnNbbm9ybWFsaXplZE5hbWVdKSB7XHJcbiAgICAgICAgdW53YXRjaEZucy5wdXNoKFxyXG4gICAgICAgICAgICBhdHRycy4kb2JzZXJ2ZShub3JtYWxpemVkTmFtZSwgYW5ndWxhci5iaW5kKHZvaWQgMCwgd2F0Y2hGbiwgbnVsbCkpKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZm9yICh2YXIgbWVkaWFOYW1lIGluICRtZENvbnN0YW50Lk1FRElBKSB7XHJcbiAgICAgICAgbm9ybWFsaXplZE5hbWUgPSBnZXROb3JtYWxpemVkTmFtZShhdHRycywgYXR0ck5hbWUgKyAnLScgKyBtZWRpYU5hbWUpO1xyXG4gICAgICAgIGlmICghYXR0cnNbbm9ybWFsaXplZE5hbWVdKSB7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB1bndhdGNoRm5zLnB1c2goYXR0cnMuJG9ic2VydmUobm9ybWFsaXplZE5hbWUsIGFuZ3VsYXIuYmluZCh2b2lkIDAsIHdhdGNoRm4sIG1lZGlhTmFtZSkpKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIHVud2F0Y2goKSB7XHJcbiAgICAgIHVud2F0Y2hGbnMuZm9yRWFjaChmdW5jdGlvbihmbikgeyBmbigpOyB9KVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8vIEltcHJvdmVzIHBlcmZvcm1hbmNlIGRyYW1hdGljYWxseVxyXG4gIGZ1bmN0aW9uIGdldE5vcm1hbGl6ZWROYW1lKGF0dHJzLCBhdHRyTmFtZSkge1xyXG4gICAgcmV0dXJuIG5vcm1hbGl6ZUNhY2hlW2F0dHJOYW1lXSB8fFxyXG4gICAgICAgIChub3JtYWxpemVDYWNoZVthdHRyTmFtZV0gPSBhdHRycy4kbm9ybWFsaXplKGF0dHJOYW1lKSk7XHJcbiAgfVxyXG59XHJcbm1kTWVkaWFGYWN0b3J5LiRpbmplY3QgPSBbXCIkbWRDb25zdGFudFwiLCBcIiRyb290U2NvcGVcIiwgXCIkd2luZG93XCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuLypcclxuICogVGhpcyB2YXIgaGFzIHRvIGJlIG91dHNpZGUgdGhlIGFuZ3VsYXIgZmFjdG9yeSwgb3RoZXJ3aXNlIHdoZW5cclxuICogdGhlcmUgYXJlIG11bHRpcGxlIG1hdGVyaWFsIGFwcHMgb24gdGhlIHNhbWUgcGFnZSwgZWFjaCBhcHBcclxuICogd2lsbCBjcmVhdGUgaXRzIG93biBpbnN0YW5jZSBvZiB0aGlzIGFycmF5IGFuZCB0aGUgYXBwJ3MgSURzXHJcbiAqIHdpbGwgbm90IGJlIHVuaXF1ZS5cclxuICovXHJcbnZhciBuZXh0VW5pcXVlSWQgPSAwO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvcmUnKVxyXG4gIC5mYWN0b3J5KCckbWRVdGlsJywgW1wiJGNhY2hlRmFjdG9yeVwiLCBcIiRkb2N1bWVudFwiLCBcIiR0aW1lb3V0XCIsIFwiJHFcIiwgXCIkd2luZG93XCIsIFwiJG1kQ29uc3RhbnRcIiwgZnVuY3Rpb24gKCRjYWNoZUZhY3RvcnksICRkb2N1bWVudCwgJHRpbWVvdXQsICRxLCAkd2luZG93LCAkbWRDb25zdGFudCkge1xyXG4gICAgdmFyIFV0aWw7XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0Tm9kZShlbCkge1xyXG4gICAgICByZXR1cm4gZWxbMF0gfHwgZWw7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIFV0aWwgPSB7XHJcbiAgICAgIG5vdzogd2luZG93LnBlcmZvcm1hbmNlID9cclxuICAgICAgICBhbmd1bGFyLmJpbmQod2luZG93LnBlcmZvcm1hbmNlLCB3aW5kb3cucGVyZm9ybWFuY2Uubm93KSA6XHJcbiAgICAgICAgRGF0ZS5ub3csXHJcblxyXG4gICAgICBjbGllbnRSZWN0OiBmdW5jdGlvbiAoZWxlbWVudCwgb2Zmc2V0UGFyZW50LCBpc09mZnNldFJlY3QpIHtcclxuICAgICAgICB2YXIgbm9kZSA9IGdldE5vZGUoZWxlbWVudCk7XHJcbiAgICAgICAgb2Zmc2V0UGFyZW50ID0gZ2V0Tm9kZShvZmZzZXRQYXJlbnQgfHwgbm9kZS5vZmZzZXRQYXJlbnQgfHwgZG9jdW1lbnQuYm9keSk7XHJcbiAgICAgICAgdmFyIG5vZGVSZWN0ID0gbm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcbiAgICAgICAgLy8gVGhlIHVzZXIgY2FuIGFzayBmb3IgYW4gb2Zmc2V0UmVjdDogYSByZWN0IHJlbGF0aXZlIHRvIHRoZSBvZmZzZXRQYXJlbnQsXHJcbiAgICAgICAgLy8gb3IgYSBjbGllbnRSZWN0OiBhIHJlY3QgcmVsYXRpdmUgdG8gdGhlIHBhZ2VcclxuICAgICAgICB2YXIgb2Zmc2V0UmVjdCA9IGlzT2Zmc2V0UmVjdCA/XHJcbiAgICAgICAgICBvZmZzZXRQYXJlbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgOlxyXG4gICAgICAgIHtsZWZ0OiAwLCB0b3A6IDAsIHdpZHRoOiAwLCBoZWlnaHQ6IDB9O1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBsZWZ0OiBub2RlUmVjdC5sZWZ0IC0gb2Zmc2V0UmVjdC5sZWZ0LFxyXG4gICAgICAgICAgdG9wOiBub2RlUmVjdC50b3AgLSBvZmZzZXRSZWN0LnRvcCxcclxuICAgICAgICAgIHdpZHRoOiBub2RlUmVjdC53aWR0aCxcclxuICAgICAgICAgIGhlaWdodDogbm9kZVJlY3QuaGVpZ2h0XHJcbiAgICAgICAgfTtcclxuICAgICAgfSxcclxuICAgICAgb2Zmc2V0UmVjdDogZnVuY3Rpb24gKGVsZW1lbnQsIG9mZnNldFBhcmVudCkge1xyXG4gICAgICAgIHJldHVybiBVdGlsLmNsaWVudFJlY3QoZWxlbWVudCwgb2Zmc2V0UGFyZW50LCB0cnVlKTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8vIEFubm95aW5nIG1ldGhvZCB0byBjb3B5IG5vZGVzIHRvIGFuIGFycmF5LCB0aGFua3MgdG8gSUVcclxuICAgICAgbm9kZXNUb0FycmF5OiBmdW5jdGlvbiAobm9kZXMpIHtcclxuICAgICAgICB2YXIgcmVzdWx0cyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgIHJlc3VsdHMucHVzaChub2Rlcy5pdGVtKGkpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAvLyBEaXNhYmxlcyBzY3JvbGwgYXJvdW5kIHRoZSBwYXNzZWQgZWxlbWVudC5cclxuICAgICAgZGlzYWJsZVNjcm9sbEFyb3VuZDogZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICBpZiAoVXRpbC5kaXNhYmxlU2Nyb2xsQXJvdW5kLl9lbmFibGVTY3JvbGxpbmcpIHJldHVybiBVdGlsLmRpc2FibGVTY3JvbGxBcm91bmQuX2VuYWJsZVNjcm9sbGluZztcclxuICAgICAgICBlbGVtZW50ID0gYW5ndWxhci5lbGVtZW50KGVsZW1lbnQpO1xyXG4gICAgICAgIHZhciBib2R5ID0gJGRvY3VtZW50WzBdLmJvZHksXHJcbiAgICAgICAgICByZXN0b3JlQm9keSA9IGRpc2FibGVCb2R5U2Nyb2xsKCksXHJcbiAgICAgICAgICByZXN0b3JlRWxlbWVudCA9IGRpc2FibGVFbGVtZW50U2Nyb2xsKCk7XHJcblxyXG4gICAgICAgIHJldHVybiBVdGlsLmRpc2FibGVTY3JvbGxBcm91bmQuX2VuYWJsZVNjcm9sbGluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgIHJlc3RvcmVCb2R5KCk7XHJcbiAgICAgICAgICByZXN0b3JlRWxlbWVudCgpO1xyXG4gICAgICAgICAgZGVsZXRlIFV0aWwuZGlzYWJsZVNjcm9sbEFyb3VuZC5fZW5hYmxlU2Nyb2xsaW5nO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIENyZWF0ZXMgYSB2aXJ0dWFsIHNjcm9sbGluZyBtYXNrIHRvIGFic29yYiB0b3VjaG1vdmUsIGtleWJvYXJkLCBzY3JvbGxiYXIgY2xpY2tpbmcsIGFuZCB3aGVlbCBldmVudHNcclxuICAgICAgICBmdW5jdGlvbiBkaXNhYmxlRWxlbWVudFNjcm9sbCgpIHtcclxuICAgICAgICAgIHZhciB6SW5kZXggPSAkd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxlbWVudFswXSkuekluZGV4IC0gMTtcclxuICAgICAgICAgIGlmIChpc05hTih6SW5kZXgpKSB6SW5kZXggPSA5OTtcclxuICAgICAgICAgIHZhciBzY3JvbGxNYXNrID0gYW5ndWxhci5lbGVtZW50KFxyXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cIm1kLXNjcm9sbC1tYXNrXCIgc3R5bGU9XCJ6LWluZGV4OiAnICsgekluZGV4ICsgJ1wiPicgK1xyXG4gICAgICAgICAgICAnICA8ZGl2IGNsYXNzPVwibWQtc2Nyb2xsLW1hc2stYmFyXCI+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICc8L2Rpdj4nKTtcclxuICAgICAgICAgIGJvZHkuYXBwZW5kQ2hpbGQoc2Nyb2xsTWFza1swXSk7XHJcblxyXG4gICAgICAgICAgc2Nyb2xsTWFzay5vbignd2hlZWwnLCBwcmV2ZW50RGVmYXVsdCk7XHJcbiAgICAgICAgICBzY3JvbGxNYXNrLm9uKCd0b3VjaG1vdmUnLCBwcmV2ZW50RGVmYXVsdCk7XHJcbiAgICAgICAgICAkZG9jdW1lbnQub24oJ2tleWRvd24nLCBkaXNhYmxlS2V5TmF2KTtcclxuXHJcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gcmVzdG9yZVNjcm9sbCgpIHtcclxuICAgICAgICAgICAgc2Nyb2xsTWFzay5vZmYoJ3doZWVsJyk7XHJcbiAgICAgICAgICAgIHNjcm9sbE1hc2sub2ZmKCd0b3VjaG1vdmUnKTtcclxuICAgICAgICAgICAgc2Nyb2xsTWFza1swXS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHNjcm9sbE1hc2tbMF0pO1xyXG4gICAgICAgICAgICAkZG9jdW1lbnQub2ZmKCdrZXlkb3duJywgZGlzYWJsZUtleU5hdik7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBVdGlsLmRpc2FibGVTY3JvbGxBcm91bmQuX2VuYWJsZVNjcm9sbGluZztcclxuICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgLy8gUHJldmVudCBrZXlwcmVzc2VzIGZyb20gZWxlbWVudHMgaW5zaWRlIHRoZSBib2R5XHJcbiAgICAgICAgICAvLyB1c2VkIHRvIHN0b3AgdGhlIGtleXByZXNzZXMgdGhhdCBjb3VsZCBjYXVzZSB0aGUgcGFnZSB0byBzY3JvbGxcclxuICAgICAgICAgIC8vIChhcnJvdyBrZXlzLCBzcGFjZWJhciwgdGFiLCBldGMpLlxyXG4gICAgICAgICAgZnVuY3Rpb24gZGlzYWJsZUtleU5hdihlKSB7XHJcbiAgICAgICAgICAgIC8vLS0gdGVtcG9yYXJpbHkgcmVtb3ZlZCB0aGlzIGxvZ2ljLCB3aWxsIHBvc3NpYmx5IHJlLWFkZCBhdCBhIGxhdGVyIGRhdGVcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICBpZiAoIWVsZW1lbnRbMF0uY29udGFpbnMoZS50YXJnZXQpKSB7XHJcbiAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBmdW5jdGlvbiBwcmV2ZW50RGVmYXVsdChlKSB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENvbnZlcnRzIHRoZSBib2R5IHRvIGEgcG9zaXRpb24gZml4ZWQgYmxvY2sgYW5kIHRyYW5zbGF0ZSBpdCB0byB0aGUgcHJvcGVyIHNjcm9sbFxyXG4gICAgICAgIC8vIHBvc2l0aW9uXHJcbiAgICAgICAgZnVuY3Rpb24gZGlzYWJsZUJvZHlTY3JvbGwoKSB7XHJcbiAgICAgICAgICB2YXIgcmVzdG9yZVN0eWxlID0gYm9keS5nZXRBdHRyaWJ1dGUoJ3N0eWxlJykgfHwgJyc7XHJcbiAgICAgICAgICB2YXIgc2Nyb2xsT2Zmc2V0ID0gYm9keS5zY3JvbGxUb3AgKyBib2R5LnBhcmVudEVsZW1lbnQuc2Nyb2xsVG9wO1xyXG4gICAgICAgICAgdmFyIGNsaWVudFdpZHRoID0gYm9keS5jbGllbnRXaWR0aDtcclxuXHJcbiAgICAgICAgICBhcHBseVN0eWxlcyhib2R5LCB7XHJcbiAgICAgICAgICAgIHBvc2l0aW9uOiAnZml4ZWQnLFxyXG4gICAgICAgICAgICB3aWR0aDogJzEwMCUnLFxyXG4gICAgICAgICAgICBvdmVyZmxvd1k6ICdzY3JvbGwnLFxyXG4gICAgICAgICAgICB0b3A6IC1zY3JvbGxPZmZzZXQgKyAncHgnXHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICBpZiAoYm9keS5jbGllbnRXaWR0aCA8IGNsaWVudFdpZHRoKSBhcHBseVN0eWxlcyhib2R5LCB7b3ZlcmZsb3c6ICdoaWRkZW4nfSk7XHJcblxyXG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIHJlc3RvcmVTY3JvbGwoKSB7XHJcbiAgICAgICAgICAgIGJvZHkuc2V0QXR0cmlidXRlKCdzdHlsZScsIHJlc3RvcmVTdHlsZSk7XHJcbiAgICAgICAgICAgIGJvZHkuc2Nyb2xsVG9wID0gc2Nyb2xsT2Zmc2V0O1xyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFwcGx5U3R5bGVzKGVsLCBzdHlsZXMpIHtcclxuICAgICAgICAgIGZvciAodmFyIGtleSBpbiBzdHlsZXMpIHtcclxuICAgICAgICAgICAgZWwuc3R5bGVba2V5XSA9IHN0eWxlc1trZXldO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgZW5hYmxlU2Nyb2xsaW5nOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIG1ldGhvZCA9IHRoaXMuZGlzYWJsZVNjcm9sbEFyb3VuZC5fZW5hYmxlU2Nyb2xsaW5nO1xyXG4gICAgICAgIG1ldGhvZCAmJiBtZXRob2QoKTtcclxuICAgICAgfSxcclxuICAgICAgZmxvYXRpbmdTY3JvbGxiYXJzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZmxvYXRpbmdTY3JvbGxiYXJzLmNhY2hlZCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICB2YXIgdGVtcE5vZGUgPSBhbmd1bGFyLmVsZW1lbnQoJzxkaXYgc3R5bGU9XCJ3aWR0aDogMTAwJTsgei1pbmRleDogLTE7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgaGVpZ2h0OiAzNXB4OyBvdmVyZmxvdy15OiBzY3JvbGxcIj48ZGl2IHN0eWxlPVwiaGVpZ2h0OiA2MDtcIj48L2Rpdj48L2Rpdj4nKTtcclxuICAgICAgICAgICRkb2N1bWVudFswXS5ib2R5LmFwcGVuZENoaWxkKHRlbXBOb2RlWzBdKTtcclxuICAgICAgICAgIHRoaXMuZmxvYXRpbmdTY3JvbGxiYXJzLmNhY2hlZCA9ICh0ZW1wTm9kZVswXS5vZmZzZXRXaWR0aCA9PSB0ZW1wTm9kZVswXS5jaGlsZE5vZGVzWzBdLm9mZnNldFdpZHRoKTtcclxuICAgICAgICAgIHRlbXBOb2RlLnJlbW92ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5mbG9hdGluZ1Njcm9sbGJhcnMuY2FjaGVkO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy8gTW9iaWxlIHNhZmFyaSBvbmx5IGFsbG93cyB5b3UgdG8gc2V0IGZvY3VzIGluIGNsaWNrIGV2ZW50IGxpc3RlbmVycy4uLlxyXG4gICAgICBmb3JjZUZvY3VzOiBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgIHZhciBub2RlID0gZWxlbWVudFswXSB8fCBlbGVtZW50O1xyXG5cclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIGZvY3VzT25DbGljayhldikge1xyXG4gICAgICAgICAgaWYgKGV2LnRhcmdldCA9PT0gbm9kZSAmJiBldi4kZm9jdXMpIHtcclxuICAgICAgICAgICAgbm9kZS5mb2N1cygpO1xyXG4gICAgICAgICAgICBldi5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgbm9kZS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGZvY3VzT25DbGljayk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSwgdHJ1ZSk7XHJcblxyXG4gICAgICAgIHZhciBuZXdFdmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdNb3VzZUV2ZW50cycpO1xyXG4gICAgICAgIG5ld0V2ZW50LmluaXRNb3VzZUV2ZW50KCdjbGljaycsIGZhbHNlLCB0cnVlLCB3aW5kb3csIHt9LCAwLCAwLCAwLCAwLFxyXG4gICAgICAgICAgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIDAsIG51bGwpO1xyXG4gICAgICAgIG5ld0V2ZW50LiRtYXRlcmlhbCA9IHRydWU7XHJcbiAgICAgICAgbmV3RXZlbnQuJGZvY3VzID0gdHJ1ZTtcclxuICAgICAgICBub2RlLmRpc3BhdGNoRXZlbnQobmV3RXZlbnQpO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgdHJhbnNpdGlvbkVuZFByb21pc2U6IGZ1bmN0aW9uIChlbGVtZW50LCBvcHRzKSB7XHJcbiAgICAgICAgb3B0cyA9IG9wdHMgfHwge307XHJcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcclxuICAgICAgICBlbGVtZW50Lm9uKCRtZENvbnN0YW50LkNTUy5UUkFOU0lUSU9ORU5ELCBmaW5pc2hlZCk7XHJcbiAgICAgICAgZnVuY3Rpb24gZmluaXNoZWQoZXYpIHtcclxuICAgICAgICAgIC8vIE1ha2Ugc3VyZSB0aGlzIHRyYW5zaXRpb25lbmQgZGlkbid0IGJ1YmJsZSB1cCBmcm9tIGEgY2hpbGRcclxuICAgICAgICAgIGlmICghZXYgfHwgZXYudGFyZ2V0ID09PSBlbGVtZW50WzBdKSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQub2ZmKCRtZENvbnN0YW50LkNTUy5UUkFOU0lUSU9ORU5ELCBmaW5pc2hlZCk7XHJcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChvcHRzLnRpbWVvdXQpICR0aW1lb3V0KGZpbmlzaGVkLCBvcHRzLnRpbWVvdXQpO1xyXG4gICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgZmFrZU5nTW9kZWw6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgJGZha2U6IHRydWUsXHJcbiAgICAgICAgICAkc2V0VG91Y2hlZDogYW5ndWxhci5ub29wLFxyXG4gICAgICAgICAgJHNldFZpZXdWYWx1ZTogZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuJHZpZXdWYWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICB0aGlzLiRyZW5kZXIodmFsdWUpO1xyXG4gICAgICAgICAgICB0aGlzLiR2aWV3Q2hhbmdlTGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24gKGNiKSB7XHJcbiAgICAgICAgICAgICAgY2IoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgJGlzRW1wdHk6IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gKCcnICsgdmFsdWUpLmxlbmd0aCA9PT0gMDtcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICAkcGFyc2VyczogW10sXHJcbiAgICAgICAgICAkZm9ybWF0dGVyczogW10sXHJcbiAgICAgICAgICAkdmlld0NoYW5nZUxpc3RlbmVyczogW10sXHJcbiAgICAgICAgICAkcmVuZGVyOiBhbmd1bGFyLm5vb3BcclxuICAgICAgICB9O1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uLCB0aGF0LCBhcyBsb25nIGFzIGl0IGNvbnRpbnVlcyB0byBiZSBpbnZva2VkLCB3aWxsIG5vdFxyXG4gICAgICAvLyBiZSB0cmlnZ2VyZWQuIFRoZSBmdW5jdGlvbiB3aWxsIGJlIGNhbGxlZCBhZnRlciBpdCBzdG9wcyBiZWluZyBjYWxsZWQgZm9yXHJcbiAgICAgIC8vIE4gbWlsbGlzZWNvbmRzLlxyXG4gICAgICAvLyBAcGFyYW0gd2FpdCBJbnRlZ2VyIHZhbHVlIG9mIG1zZWNzIHRvIGRlbGF5IChzaW5jZSBsYXN0IGRlYm91bmNlIHJlc2V0KTsgZGVmYXVsdCB2YWx1ZSAxMCBtc2Vjc1xyXG4gICAgICAvLyBAcGFyYW0gaW52b2tlQXBwbHkgc2hvdWxkIHRoZSAkdGltZW91dCB0cmlnZ2VyICRkaWdlc3QoKSBkaXJ0eSBjaGVja2luZ1xyXG4gICAgICBkZWJvdW5jZTogZnVuY3Rpb24gKGZ1bmMsIHdhaXQsIHNjb3BlLCBpbnZva2VBcHBseSkge1xyXG4gICAgICAgIHZhciB0aW1lcjtcclxuXHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGRlYm91bmNlZCgpIHtcclxuICAgICAgICAgIHZhciBjb250ZXh0ID0gc2NvcGUsXHJcbiAgICAgICAgICAgIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO1xyXG5cclxuICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aW1lcik7XHJcbiAgICAgICAgICB0aW1lciA9ICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgIHRpbWVyID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xyXG5cclxuICAgICAgICAgIH0sIHdhaXQgfHwgMTAsIGludm9rZUFwcGx5KTtcclxuICAgICAgICB9O1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgY2FuIG9ubHkgYmUgdHJpZ2dlcmVkIGV2ZXJ5IGBkZWxheWAgbWlsbGlzZWNvbmRzLlxyXG4gICAgICAvLyBJbiBvdGhlciB3b3JkcywgdGhlIGZ1bmN0aW9uIHdpbGwgbm90IGJlIGNhbGxlZCB1bmxlc3MgaXQgaGFzIGJlZW4gbW9yZVxyXG4gICAgICAvLyB0aGFuIGBkZWxheWAgbWlsbGlzZWNvbmRzIHNpbmNlIHRoZSBsYXN0IGNhbGwuXHJcbiAgICAgIHRocm90dGxlOiBmdW5jdGlvbiB0aHJvdHRsZShmdW5jLCBkZWxheSkge1xyXG4gICAgICAgIHZhciByZWNlbnQ7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIHRocm90dGxlZCgpIHtcclxuICAgICAgICAgIHZhciBjb250ZXh0ID0gdGhpcztcclxuICAgICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xyXG4gICAgICAgICAgdmFyIG5vdyA9IFV0aWwubm93KCk7XHJcblxyXG4gICAgICAgICAgaWYgKCFyZWNlbnQgfHwgKG5vdyAtIHJlY2VudCA+IGRlbGF5KSkge1xyXG4gICAgICAgICAgICBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xyXG4gICAgICAgICAgICByZWNlbnQgPSBub3c7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiBNZWFzdXJlcyB0aGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0YWtlbiB0byBydW4gdGhlIHByb3ZpZGVkIGNhbGxiYWNrXHJcbiAgICAgICAqIGZ1bmN0aW9uLiBVc2VzIGEgaGlnaC1wcmVjaXNpb24gdGltZXIgaWYgYXZhaWxhYmxlLlxyXG4gICAgICAgKi9cclxuICAgICAgdGltZTogZnVuY3Rpb24gdGltZShjYikge1xyXG4gICAgICAgIHZhciBzdGFydCA9IFV0aWwubm93KCk7XHJcbiAgICAgICAgY2IoKTtcclxuICAgICAgICByZXR1cm4gVXRpbC5ub3coKSAtIHN0YXJ0O1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgLyoqXHJcbiAgICAgICAqIEdldCBhIHVuaXF1ZSBJRC5cclxuICAgICAgICpcclxuICAgICAgICogQHJldHVybnMge3N0cmluZ30gYW4gdW5pcXVlIG51bWVyaWMgc3RyaW5nXHJcbiAgICAgICAqL1xyXG4gICAgICBuZXh0VWlkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuICcnICsgbmV4dFVuaXF1ZUlkKys7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAvLyBTdG9wIHdhdGNoZXJzIGFuZCBldmVudHMgZnJvbSBmaXJpbmcgb24gYSBzY29wZSB3aXRob3V0IGRlc3Ryb3lpbmcgaXQsXHJcbiAgICAgIC8vIGJ5IGRpc2Nvbm5lY3RpbmcgaXQgZnJvbSBpdHMgcGFyZW50IGFuZCBpdHMgc2libGluZ3MnIGxpbmtlZCBsaXN0cy5cclxuICAgICAgZGlzY29ubmVjdFNjb3BlOiBmdW5jdGlvbiBkaXNjb25uZWN0U2NvcGUoc2NvcGUpIHtcclxuICAgICAgICBpZiAoIXNjb3BlKSByZXR1cm47XHJcblxyXG4gICAgICAgIC8vIHdlIGNhbid0IGRlc3Ryb3kgdGhlIHJvb3Qgc2NvcGUgb3IgYSBzY29wZSB0aGF0IGhhcyBiZWVuIGFscmVhZHkgZGVzdHJveWVkXHJcbiAgICAgICAgaWYgKHNjb3BlLiRyb290ID09PSBzY29wZSkgcmV0dXJuO1xyXG4gICAgICAgIGlmIChzY29wZS4kJGRlc3Ryb3llZCkgcmV0dXJuO1xyXG5cclxuICAgICAgICB2YXIgcGFyZW50ID0gc2NvcGUuJHBhcmVudDtcclxuICAgICAgICBzY29wZS4kJGRpc2Nvbm5lY3RlZCA9IHRydWU7XHJcblxyXG4gICAgICAgIC8vIFNlZSBTY29wZS4kZGVzdHJveVxyXG4gICAgICAgIGlmIChwYXJlbnQuJCRjaGlsZEhlYWQgPT09IHNjb3BlKSBwYXJlbnQuJCRjaGlsZEhlYWQgPSBzY29wZS4kJG5leHRTaWJsaW5nO1xyXG4gICAgICAgIGlmIChwYXJlbnQuJCRjaGlsZFRhaWwgPT09IHNjb3BlKSBwYXJlbnQuJCRjaGlsZFRhaWwgPSBzY29wZS4kJHByZXZTaWJsaW5nO1xyXG4gICAgICAgIGlmIChzY29wZS4kJHByZXZTaWJsaW5nKSBzY29wZS4kJHByZXZTaWJsaW5nLiQkbmV4dFNpYmxpbmcgPSBzY29wZS4kJG5leHRTaWJsaW5nO1xyXG4gICAgICAgIGlmIChzY29wZS4kJG5leHRTaWJsaW5nKSBzY29wZS4kJG5leHRTaWJsaW5nLiQkcHJldlNpYmxpbmcgPSBzY29wZS4kJHByZXZTaWJsaW5nO1xyXG5cclxuICAgICAgICBzY29wZS4kJG5leHRTaWJsaW5nID0gc2NvcGUuJCRwcmV2U2libGluZyA9IG51bGw7XHJcblxyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy8gVW5kbyB0aGUgZWZmZWN0cyBvZiBkaXNjb25uZWN0U2NvcGUgYWJvdmUuXHJcbiAgICAgIHJlY29ubmVjdFNjb3BlOiBmdW5jdGlvbiByZWNvbm5lY3RTY29wZShzY29wZSkge1xyXG4gICAgICAgIGlmICghc2NvcGUpIHJldHVybjtcclxuXHJcbiAgICAgICAgLy8gd2UgY2FuJ3QgZGlzY29ubmVjdCB0aGUgcm9vdCBub2RlIG9yIHNjb3BlIGFscmVhZHkgZGlzY29ubmVjdGVkXHJcbiAgICAgICAgaWYgKHNjb3BlLiRyb290ID09PSBzY29wZSkgcmV0dXJuO1xyXG4gICAgICAgIGlmICghc2NvcGUuJCRkaXNjb25uZWN0ZWQpIHJldHVybjtcclxuXHJcbiAgICAgICAgdmFyIGNoaWxkID0gc2NvcGU7XHJcblxyXG4gICAgICAgIHZhciBwYXJlbnQgPSBjaGlsZC4kcGFyZW50O1xyXG4gICAgICAgIGNoaWxkLiQkZGlzY29ubmVjdGVkID0gZmFsc2U7XHJcbiAgICAgICAgLy8gU2VlIFNjb3BlLiRuZXcgZm9yIHRoaXMgbG9naWMuLi5cclxuICAgICAgICBjaGlsZC4kJHByZXZTaWJsaW5nID0gcGFyZW50LiQkY2hpbGRUYWlsO1xyXG4gICAgICAgIGlmIChwYXJlbnQuJCRjaGlsZEhlYWQpIHtcclxuICAgICAgICAgIHBhcmVudC4kJGNoaWxkVGFpbC4kJG5leHRTaWJsaW5nID0gY2hpbGQ7XHJcbiAgICAgICAgICBwYXJlbnQuJCRjaGlsZFRhaWwgPSBjaGlsZDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcGFyZW50LiQkY2hpbGRIZWFkID0gcGFyZW50LiQkY2hpbGRUYWlsID0gY2hpbGQ7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgLypcclxuICAgICAgICogZ2V0Q2xvc2VzdCByZXBsaWNhdGVzIGpRdWVyeS5jbG9zZXN0KCkgdG8gd2FsayB1cCB0aGUgRE9NIHRyZWUgdW50aWwgaXQgZmluZHMgYSBtYXRjaGluZyBub2RlTmFtZVxyXG4gICAgICAgKlxyXG4gICAgICAgKiBAcGFyYW0gZWwgRWxlbWVudCB0byBzdGFydCB3YWxraW5nIHRoZSBET00gZnJvbVxyXG4gICAgICAgKiBAcGFyYW0gdGFnTmFtZSBUYWcgbmFtZSB0byBmaW5kIGNsb3Nlc3QgdG8gZWwsIHN1Y2ggYXMgJ2Zvcm0nXHJcbiAgICAgICAqL1xyXG4gICAgICBnZXRDbG9zZXN0OiBmdW5jdGlvbiBnZXRDbG9zZXN0KGVsLCB0YWdOYW1lLCBvbmx5UGFyZW50KSB7XHJcbiAgICAgICAgaWYgKGVsIGluc3RhbmNlb2YgYW5ndWxhci5lbGVtZW50KSBlbCA9IGVsWzBdO1xyXG4gICAgICAgIHRhZ05hbWUgPSB0YWdOYW1lLnRvVXBwZXJDYXNlKCk7XHJcbiAgICAgICAgaWYgKG9ubHlQYXJlbnQpIGVsID0gZWwucGFyZW50Tm9kZTtcclxuICAgICAgICBpZiAoIWVsKSByZXR1cm4gbnVsbDtcclxuICAgICAgICBkbyB7XHJcbiAgICAgICAgICBpZiAoZWwubm9kZU5hbWUgPT09IHRhZ05hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGVsO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gd2hpbGUgKGVsID0gZWwucGFyZW50Tm9kZSk7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAvKipcclxuICAgICAgICogRnVuY3Rpb25hbCBlcXVpdmFsZW50IGZvciAkZWxlbWVudC5maWx0ZXIo4oCYbWQtYm90dG9tLXNoZWV04oCZKVxyXG4gICAgICAgKiB1c2VmdWwgd2l0aCBpbnRlcmltRWxlbWVudHMgd2hlcmUgdGhlIGVsZW1lbnQgYW5kIGl0cyBjb250YWluZXIgYXJlIGltcG9ydGFudC4uLlxyXG4gICAgICAgKi9cclxuICAgICAgZXh0cmFjdEVsZW1lbnRCeU5hbWU6IGZ1bmN0aW9uIChlbGVtZW50LCBub2RlTmFtZSkge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBlbGVtZW50Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICBpZiAoZWxlbWVudFtpXS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBub2RlTmFtZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gYW5ndWxhci5lbGVtZW50KGVsZW1lbnRbaV0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZWxlbWVudDtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiBHaXZlIG9wdGlvbmFsIHByb3BlcnRpZXMgd2l0aCBubyB2YWx1ZSBhIGJvb2xlYW4gdHJ1ZSBpZiBhdHRyIHByb3ZpZGVkIG9yIGZhbHNlIG90aGVyd2lzZVxyXG4gICAgICAgKi9cclxuICAgICAgaW5pdE9wdGlvbmFsUHJvcGVydGllczogZnVuY3Rpb24gKHNjb3BlLCBhdHRyLCBkZWZhdWx0cykge1xyXG4gICAgICAgIGRlZmF1bHRzID0gZGVmYXVsdHMgfHwge307XHJcbiAgICAgICAgYW5ndWxhci5mb3JFYWNoKHNjb3BlLiQkaXNvbGF0ZUJpbmRpbmdzLCBmdW5jdGlvbiAoYmluZGluZywga2V5KSB7XHJcbiAgICAgICAgICBpZiAoYmluZGluZy5vcHRpb25hbCAmJiBhbmd1bGFyLmlzVW5kZWZpbmVkKHNjb3BlW2tleV0pKSB7XHJcbiAgICAgICAgICAgIHZhciBhdHRySXNEZWZpbmVkID0gYW5ndWxhci5pc0RlZmluZWQoYXR0cltiaW5kaW5nLmF0dHJOYW1lXSk7XHJcbiAgICAgICAgICAgIHNjb3BlW2tleV0gPSBhbmd1bGFyLmlzRGVmaW5lZChkZWZhdWx0c1trZXldKSA/IGRlZmF1bHRzW2tleV0gOiBhdHRySXNEZWZpbmVkO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgfTtcclxuXHJcbiAgfV0pO1xyXG5cclxuLypcclxuICogU2luY2UgcmVtb3ZpbmcgalF1ZXJ5IGZyb20gdGhlIGRlbW9zLCBzb21lIGNvZGUgdGhhdCB1c2VzIGBlbGVtZW50LmZvY3VzKClgIGlzIGJyb2tlbi5cclxuICpcclxuICogV2UgbmVlZCB0byBhZGQgYGVsZW1lbnQuZm9jdXMoKWAsIGJlY2F1c2UgaXQncyB0ZXN0YWJsZSB1bmxpa2UgYGVsZW1lbnRbMF0uZm9jdXNgLlxyXG4gKlxyXG4gKiBUT0RPKGFqb3NsaW4pOiBUaGlzIHNob3VsZCBiZSBhZGRlZCBpbiBhIGJldHRlciBwbGFjZSBsYXRlci5cclxuICovXHJcblxyXG5hbmd1bGFyLmVsZW1lbnQucHJvdG90eXBlLmZvY3VzID0gYW5ndWxhci5lbGVtZW50LnByb3RvdHlwZS5mb2N1cyB8fCBmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAodGhpcy5sZW5ndGgpIHtcclxuICAgICAgdGhpc1swXS5mb2N1cygpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXM7XHJcbiAgfTtcclxuYW5ndWxhci5lbGVtZW50LnByb3RvdHlwZS5ibHVyID0gYW5ndWxhci5lbGVtZW50LnByb3RvdHlwZS5ibHVyIHx8IGZ1bmN0aW9uICgpIHtcclxuICAgIGlmICh0aGlzLmxlbmd0aCkge1xyXG4gICAgICB0aGlzWzBdLmJsdXIoKTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzO1xyXG4gIH07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvcmUnKVxyXG4gIC5zZXJ2aWNlKCckbWRBcmlhJywgQXJpYVNlcnZpY2UpO1xyXG5cclxuLypcclxuICogQG5nSW5qZWN0XHJcbiAqL1xyXG5mdW5jdGlvbiBBcmlhU2VydmljZSgkJHJBRiwgJGxvZywgJHdpbmRvdykge1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgZXhwZWN0OiBleHBlY3QsXHJcbiAgICBleHBlY3RBc3luYzogZXhwZWN0QXN5bmMsXHJcbiAgICBleHBlY3RXaXRoVGV4dDogZXhwZWN0V2l0aFRleHRcclxuICB9O1xyXG5cclxuICAvKipcclxuICAgKiBDaGVjayBpZiBleHBlY3RlZCBhdHRyaWJ1dGUgaGFzIGJlZW4gc3BlY2lmaWVkIG9uIHRoZSB0YXJnZXQgZWxlbWVudCBvciBjaGlsZFxyXG4gICAqIEBwYXJhbSBlbGVtZW50XHJcbiAgICogQHBhcmFtIGF0dHJOYW1lXHJcbiAgICogQHBhcmFtIHtvcHRpb25hbH0gZGVmYXVsdFZhbHVlIFdoYXQgdG8gc2V0IHRoZSBhdHRyIHRvIGlmIG5vIHZhbHVlIGlzIGZvdW5kXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gZXhwZWN0KGVsZW1lbnQsIGF0dHJOYW1lLCBkZWZhdWx0VmFsdWUpIHtcclxuICAgIHZhciBub2RlID0gZWxlbWVudFswXSB8fCBlbGVtZW50O1xyXG5cclxuICAgIC8vIGlmIG5vZGUgZXhpc3RzIGFuZCBuZWl0aGVyIGl0IG5vciBpdHMgY2hpbGRyZW4gaGF2ZSB0aGUgYXR0cmlidXRlXHJcbiAgICBpZiAobm9kZSAmJlxyXG4gICAgICAgKCghbm9kZS5oYXNBdHRyaWJ1dGUoYXR0ck5hbWUpIHx8XHJcbiAgICAgICAgbm9kZS5nZXRBdHRyaWJ1dGUoYXR0ck5hbWUpLmxlbmd0aCA9PT0gMCkgJiZcclxuICAgICAgICAhY2hpbGRIYXNBdHRyaWJ1dGUobm9kZSwgYXR0ck5hbWUpKSkge1xyXG5cclxuICAgICAgZGVmYXVsdFZhbHVlID0gYW5ndWxhci5pc1N0cmluZyhkZWZhdWx0VmFsdWUpID8gZGVmYXVsdFZhbHVlLnRyaW0oKSA6ICcnO1xyXG4gICAgICBpZiAoZGVmYXVsdFZhbHVlLmxlbmd0aCkge1xyXG4gICAgICAgIGVsZW1lbnQuYXR0cihhdHRyTmFtZSwgZGVmYXVsdFZhbHVlKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkbG9nLndhcm4oJ0FSSUE6IEF0dHJpYnV0ZSBcIicsIGF0dHJOYW1lLCAnXCIsIHJlcXVpcmVkIGZvciBhY2Nlc3NpYmlsaXR5LCBpcyBtaXNzaW5nIG9uIG5vZGU6Jywgbm9kZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBleHBlY3RBc3luYyhlbGVtZW50LCBhdHRyTmFtZSwgZGVmYXVsdFZhbHVlR2V0dGVyKSB7XHJcbiAgICAvLyBQcm9ibGVtOiB3aGVuIHJldHJpZXZpbmcgdGhlIGVsZW1lbnQncyBjb250ZW50cyBzeW5jaHJvbm91c2x5IHRvIGZpbmQgdGhlIGxhYmVsLFxyXG4gICAgLy8gdGhlIHRleHQgbWF5IG5vdCBiZSBkZWZpbmVkIHlldCBpbiB0aGUgY2FzZSBvZiBhIGJpbmRpbmcuXHJcbiAgICAvLyBUaGVyZSBpcyBhIGhpZ2hlciBjaGFuY2UgdGhhdCBhIGJpbmRpbmcgd2lsbCBiZSBkZWZpbmVkIGlmIHdlIHdhaXQgb25lIGZyYW1lLlxyXG4gICAgJCRyQUYoZnVuY3Rpb24oKSB7XHJcbiAgICAgIGV4cGVjdChlbGVtZW50LCBhdHRyTmFtZSwgZGVmYXVsdFZhbHVlR2V0dGVyKCkpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBleHBlY3RXaXRoVGV4dChlbGVtZW50LCBhdHRyTmFtZSkge1xyXG4gICAgZXhwZWN0QXN5bmMoZWxlbWVudCwgYXR0ck5hbWUsIGZ1bmN0aW9uKCkge1xyXG4gICAgICByZXR1cm4gZ2V0VGV4dChlbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZ2V0VGV4dChlbGVtZW50KSB7XHJcbiAgICByZXR1cm4gZWxlbWVudC50ZXh0KCkudHJpbSgpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gY2hpbGRIYXNBdHRyaWJ1dGUobm9kZSwgYXR0ck5hbWUpIHtcclxuICAgIHZhciBoYXNDaGlsZHJlbiA9IG5vZGUuaGFzQ2hpbGROb2RlcygpLFxyXG4gICAgICAgIGhhc0F0dHIgPSBmYWxzZTtcclxuXHJcbiAgICBmdW5jdGlvbiBpc0hpZGRlbihlbCkge1xyXG4gICAgICB2YXIgc3R5bGUgPSBlbC5jdXJyZW50U3R5bGUgPyBlbC5jdXJyZW50U3R5bGUgOiAkd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWwpO1xyXG4gICAgICByZXR1cm4gKHN0eWxlLmRpc3BsYXkgPT09ICdub25lJyk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYoaGFzQ2hpbGRyZW4pIHtcclxuICAgICAgdmFyIGNoaWxkcmVuID0gbm9kZS5jaGlsZE5vZGVzO1xyXG4gICAgICBmb3IodmFyIGk9MDsgaTxjaGlsZHJlbi5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgdmFyIGNoaWxkID0gY2hpbGRyZW5baV07XHJcbiAgICAgICAgaWYoY2hpbGQubm9kZVR5cGUgPT09IDEgJiYgY2hpbGQuaGFzQXR0cmlidXRlKGF0dHJOYW1lKSkge1xyXG4gICAgICAgICAgaWYoIWlzSGlkZGVuKGNoaWxkKSl7XHJcbiAgICAgICAgICAgIGhhc0F0dHIgPSB0cnVlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGhhc0F0dHI7XHJcbiAgfVxyXG59XHJcbkFyaWFTZXJ2aWNlLiRpbmplY3QgPSBbXCIkJHJBRlwiLCBcIiRsb2dcIiwgXCIkd2luZG93XCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvcmUnKVxyXG4gIC5zZXJ2aWNlKCckbWRDb21waWxlcicsIG1kQ29tcGlsZXJTZXJ2aWNlKTtcclxuXHJcbmZ1bmN0aW9uIG1kQ29tcGlsZXJTZXJ2aWNlKCRxLCAkaHR0cCwgJGluamVjdG9yLCAkY29tcGlsZSwgJGNvbnRyb2xsZXIsICR0ZW1wbGF0ZUNhY2hlKSB7XHJcbiAgLyoganNoaW50IHZhbGlkdGhpczogdHJ1ZSAqL1xyXG5cclxuICAvKlxyXG4gICAqIEBuZ2RvYyBzZXJ2aWNlXHJcbiAgICogQG5hbWUgJG1kQ29tcGlsZXJcclxuICAgKiBAbW9kdWxlIG1hdGVyaWFsLmNvcmVcclxuICAgKiBAZGVzY3JpcHRpb25cclxuICAgKiBUaGUgJG1kQ29tcGlsZXIgc2VydmljZSBpcyBhbiBhYnN0cmFjdGlvbiBvZiBhbmd1bGFyJ3MgY29tcGlsZXIsIHRoYXQgYWxsb3dzIHRoZSBkZXZlbG9wZXJcclxuICAgKiB0byBlYXNpbHkgY29tcGlsZSBhbiBlbGVtZW50IHdpdGggYSB0ZW1wbGF0ZVVybCwgY29udHJvbGxlciwgYW5kIGxvY2Fscy5cclxuICAgKlxyXG4gICAqIEB1c2FnZVxyXG4gICAqIDxobGpzIGxhbmc9XCJqc1wiPlxyXG4gICAqICRtZENvbXBpbGVyLmNvbXBpbGUoe1xyXG4gICAqICAgdGVtcGxhdGVVcmw6ICdtb2RhbC5odG1sJyxcclxuICAgKiAgIGNvbnRyb2xsZXI6ICdNb2RhbEN0cmwnLFxyXG4gICAqICAgbG9jYWxzOiB7XHJcbiAgICogICAgIG1vZGFsOiBteU1vZGFsSW5zdGFuY2U7XHJcbiAgICogICB9XHJcbiAgICogfSkudGhlbihmdW5jdGlvbihjb21waWxlRGF0YSkge1xyXG4gICAqICAgY29tcGlsZURhdGEuZWxlbWVudDsgLy8gbW9kYWwuaHRtbCdzIHRlbXBsYXRlIGluIGFuIGVsZW1lbnRcclxuICAgKiAgIGNvbXBpbGVEYXRhLmxpbmsobXlTY29wZSk7IC8vYXR0YWNoIGNvbnRyb2xsZXIgJiBzY29wZSB0byBlbGVtZW50XHJcbiAgICogfSk7XHJcbiAgICogPC9obGpzPlxyXG4gICAqL1xyXG5cclxuICAgLypcclxuICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgKiBAbmFtZSAkbWRDb21waWxlciNjb21waWxlXHJcbiAgICAqIEBkZXNjcmlwdGlvbiBBIGhlbHBlciB0byBjb21waWxlIGFuIEhUTUwgdGVtcGxhdGUvdGVtcGxhdGVVcmwgd2l0aCBhIGdpdmVuIGNvbnRyb2xsZXIsXHJcbiAgICAqIGxvY2FscywgYW5kIHNjb3BlLlxyXG4gICAgKiBAcGFyYW0ge29iamVjdH0gb3B0aW9ucyBBbiBvcHRpb25zIG9iamVjdCwgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XHJcbiAgICAqXHJcbiAgICAqICAgIC0gYGNvbnRyb2xsZXJgIC0gYHsoc3RyaW5nPXxmdW5jdGlvbigpPX1gIENvbnRyb2xsZXIgZm4gdGhhdCBzaG91bGQgYmUgYXNzb2NpYXRlZCB3aXRoXHJcbiAgICAqICAgICAgbmV3bHkgY3JlYXRlZCBzY29wZSBvciB0aGUgbmFtZSBvZiBhIHJlZ2lzdGVyZWQgY29udHJvbGxlciBpZiBwYXNzZWQgYXMgYSBzdHJpbmcuXHJcbiAgICAqICAgIC0gYGNvbnRyb2xsZXJBc2AgLSBge3N0cmluZz19YCBBIGNvbnRyb2xsZXIgYWxpYXMgbmFtZS4gSWYgcHJlc2VudCB0aGUgY29udHJvbGxlciB3aWxsIGJlXHJcbiAgICAqICAgICAgcHVibGlzaGVkIHRvIHNjb3BlIHVuZGVyIHRoZSBgY29udHJvbGxlckFzYCBuYW1lLlxyXG4gICAgKiAgICAtIGB0ZW1wbGF0ZWAgLSBge3N0cmluZz19YCBBbiBodG1sIHRlbXBsYXRlIGFzIGEgc3RyaW5nLlxyXG4gICAgKiAgICAtIGB0ZW1wbGF0ZVVybGAgLSBge3N0cmluZz19YCBBIHBhdGggdG8gYW4gaHRtbCB0ZW1wbGF0ZS5cclxuICAgICogICAgLSBgdHJhbnNmb3JtVGVtcGxhdGVgIC0gYHtmdW5jdGlvbih0ZW1wbGF0ZSk9fWAgQSBmdW5jdGlvbiB3aGljaCB0cmFuc2Zvcm1zIHRoZSB0ZW1wbGF0ZSBhZnRlclxyXG4gICAgKiAgICAgIGl0IGlzIGxvYWRlZC4gSXQgd2lsbCBiZSBnaXZlbiB0aGUgdGVtcGxhdGUgc3RyaW5nIGFzIGEgcGFyYW1ldGVyLCBhbmQgc2hvdWxkXHJcbiAgICAqICAgICAgcmV0dXJuIGEgYSBuZXcgc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgdHJhbnNmb3JtZWQgdGVtcGxhdGUuXHJcbiAgICAqICAgIC0gYHJlc29sdmVgIC0gYHtPYmplY3QuPHN0cmluZywgZnVuY3Rpb24+PX1gIC0gQW4gb3B0aW9uYWwgbWFwIG9mIGRlcGVuZGVuY2llcyB3aGljaCBzaG91bGRcclxuICAgICogICAgICBiZSBpbmplY3RlZCBpbnRvIHRoZSBjb250cm9sbGVyLiBJZiBhbnkgb2YgdGhlc2UgZGVwZW5kZW5jaWVzIGFyZSBwcm9taXNlcywgdGhlIGNvbXBpbGVyXHJcbiAgICAqICAgICAgd2lsbCB3YWl0IGZvciB0aGVtIGFsbCB0byBiZSByZXNvbHZlZCwgb3IgaWYgb25lIGlzIHJlamVjdGVkIGJlZm9yZSB0aGUgY29udHJvbGxlciBpc1xyXG4gICAgKiAgICAgIGluc3RhbnRpYXRlZCBgY29tcGlsZSgpYCB3aWxsIGZhaWwuLlxyXG4gICAgKiAgICAgICogYGtleWAgLSBge3N0cmluZ31gOiBhIG5hbWUgb2YgYSBkZXBlbmRlbmN5IHRvIGJlIGluamVjdGVkIGludG8gdGhlIGNvbnRyb2xsZXIuXHJcbiAgICAqICAgICAgKiBgZmFjdG9yeWAgLSBge3N0cmluZ3xmdW5jdGlvbn1gOiBJZiBgc3RyaW5nYCB0aGVuIGl0IGlzIGFuIGFsaWFzIGZvciBhIHNlcnZpY2UuXHJcbiAgICAqICAgICAgICBPdGhlcndpc2UgaWYgZnVuY3Rpb24sIHRoZW4gaXQgaXMgaW5qZWN0ZWQgYW5kIHRoZSByZXR1cm4gdmFsdWUgaXMgdHJlYXRlZCBhcyB0aGVcclxuICAgICogICAgICAgIGRlcGVuZGVuY3kuIElmIHRoZSByZXN1bHQgaXMgYSBwcm9taXNlLCBpdCBpcyByZXNvbHZlZCBiZWZvcmUgaXRzIHZhbHVlIGlzIFxyXG4gICAgKiAgICAgICAgaW5qZWN0ZWQgaW50byB0aGUgY29udHJvbGxlci5cclxuICAgICpcclxuICAgICogQHJldHVybnMge29iamVjdD19IHByb21pc2UgQSBwcm9taXNlLCB3aGljaCB3aWxsIGJlIHJlc29sdmVkIHdpdGggYSBgY29tcGlsZURhdGFgIG9iamVjdC5cclxuICAgICogYGNvbXBpbGVEYXRhYCBoYXMgdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOiBcclxuICAgICpcclxuICAgICogICAtIGBlbGVtZW50YCAtIGB7ZWxlbWVudH1gOiBhbiB1bmNvbXBpbGVkIGVsZW1lbnQgbWF0Y2hpbmcgdGhlIHByb3ZpZGVkIHRlbXBsYXRlLlxyXG4gICAgKiAgIC0gYGxpbmtgIC0gYHtmdW5jdGlvbihzY29wZSl9YDogQSBsaW5rIGZ1bmN0aW9uLCB3aGljaCwgd2hlbiBjYWxsZWQsIHdpbGwgY29tcGlsZVxyXG4gICAgKiAgICAgdGhlIGVsZW1lbnQgYW5kIGluc3RhbnRpYXRlIHRoZSBwcm92aWRlZCBjb250cm9sbGVyIChpZiBnaXZlbikuXHJcbiAgICAqICAgLSBgbG9jYWxzYCAtIGB7b2JqZWN0fWA6IFRoZSBsb2NhbHMgd2hpY2ggd2lsbCBiZSBwYXNzZWQgaW50byB0aGUgY29udHJvbGxlciBvbmNlIGBsaW5rYCBpc1xyXG4gICAgKiAgICAgY2FsbGVkLiBJZiBgYmluZFRvQ29udHJvbGxlcmAgaXMgdHJ1ZSwgdGhleSB3aWxsIGJlIGNvcHBpZWQgdG8gdGhlIGN0cmwgaW5zdGVhZFxyXG4gICAgKiAgIC0gYGJpbmRUb0NvbnRyb2xsZXJgIC0gYGJvb2xgOiBiaW5kIHRoZSBsb2NhbHMgdG8gdGhlIGNvbnRyb2xsZXIsIGluc3RlYWQgb2YgcGFzc2luZyB0aGVtIGluLlxyXG4gICAgKi9cclxuICB0aGlzLmNvbXBpbGUgPSBmdW5jdGlvbihvcHRpb25zKSB7XHJcbiAgICB2YXIgdGVtcGxhdGVVcmwgPSBvcHRpb25zLnRlbXBsYXRlVXJsO1xyXG4gICAgdmFyIHRlbXBsYXRlID0gb3B0aW9ucy50ZW1wbGF0ZSB8fCAnJztcclxuICAgIHZhciBjb250cm9sbGVyID0gb3B0aW9ucy5jb250cm9sbGVyO1xyXG4gICAgdmFyIGNvbnRyb2xsZXJBcyA9IG9wdGlvbnMuY29udHJvbGxlckFzO1xyXG4gICAgdmFyIHJlc29sdmUgPSBvcHRpb25zLnJlc29sdmUgfHwge307XHJcbiAgICB2YXIgbG9jYWxzID0gb3B0aW9ucy5sb2NhbHMgfHwge307XHJcbiAgICB2YXIgdHJhbnNmb3JtVGVtcGxhdGUgPSBvcHRpb25zLnRyYW5zZm9ybVRlbXBsYXRlIHx8IGFuZ3VsYXIuaWRlbnRpdHk7XHJcbiAgICB2YXIgYmluZFRvQ29udHJvbGxlciA9IG9wdGlvbnMuYmluZFRvQ29udHJvbGxlcjtcclxuXHJcbiAgICAvLyBUYWtlIHJlc29sdmUgdmFsdWVzIGFuZCBpbnZva2UgdGhlbS4gIFxyXG4gICAgLy8gUmVzb2x2ZXMgY2FuIGVpdGhlciBiZSBhIHN0cmluZyAodmFsdWU6ICdNeVJlZ2lzdGVyZWRBbmd1bGFyQ29uc3QnKSxcclxuICAgIC8vIG9yIGFuIGludm9rYWJsZSAnZmFjdG9yeScgb2Ygc29ydHM6ICh2YWx1ZTogZnVuY3Rpb24gVmFsdWVHZXR0ZXIoJGRlcGVuZGVuY3kpIHt9KVxyXG4gICAgYW5ndWxhci5mb3JFYWNoKHJlc29sdmUsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcclxuICAgICAgaWYgKGFuZ3VsYXIuaXNTdHJpbmcodmFsdWUpKSB7XHJcbiAgICAgICAgcmVzb2x2ZVtrZXldID0gJGluamVjdG9yLmdldCh2YWx1ZSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVzb2x2ZVtrZXldID0gJGluamVjdG9yLmludm9rZSh2YWx1ZSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgLy9BZGQgdGhlIGxvY2Fscywgd2hpY2ggYXJlIGp1c3Qgc3RyYWlnaHQgdmFsdWVzIHRvIGluamVjdFxyXG4gICAgLy9lZyBsb2NhbHM6IHsgdGhyZWU6IDMgfSwgd2lsbCBpbmplY3QgdGhyZWUgaW50byB0aGUgY29udHJvbGxlclxyXG4gICAgYW5ndWxhci5leHRlbmQocmVzb2x2ZSwgbG9jYWxzKTtcclxuXHJcbiAgICBpZiAodGVtcGxhdGVVcmwpIHtcclxuICAgICAgcmVzb2x2ZS4kdGVtcGxhdGUgPSAkaHR0cC5nZXQodGVtcGxhdGVVcmwsIHtjYWNoZTogJHRlbXBsYXRlQ2FjaGV9KVxyXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlc29sdmUuJHRlbXBsYXRlID0gJHEud2hlbih0ZW1wbGF0ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gV2FpdCBmb3IgYWxsIHRoZSByZXNvbHZlcyB0byBmaW5pc2ggaWYgdGhleSBhcmUgcHJvbWlzZXNcclxuICAgIHJldHVybiAkcS5hbGwocmVzb2x2ZSkudGhlbihmdW5jdGlvbihsb2NhbHMpIHtcclxuXHJcbiAgICAgIHZhciB0ZW1wbGF0ZSA9IHRyYW5zZm9ybVRlbXBsYXRlKGxvY2Fscy4kdGVtcGxhdGUpO1xyXG4gICAgICB2YXIgZWxlbWVudCA9IG9wdGlvbnMuZWxlbWVudCB8fCBhbmd1bGFyLmVsZW1lbnQoJzxkaXY+JykuaHRtbCh0ZW1wbGF0ZS50cmltKCkpLmNvbnRlbnRzKCk7XHJcbiAgICAgIHZhciBsaW5rRm4gPSAkY29tcGlsZShlbGVtZW50KTtcclxuXHJcbiAgICAgIC8vUmV0dXJuIGEgbGlua2luZyBmdW5jdGlvbiB0aGF0IGNhbiBiZSB1c2VkIGxhdGVyIHdoZW4gdGhlIGVsZW1lbnQgaXMgcmVhZHlcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBsb2NhbHM6IGxvY2FscyxcclxuICAgICAgICBlbGVtZW50OiBlbGVtZW50LFxyXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIGxpbmsoc2NvcGUpIHtcclxuICAgICAgICAgIGxvY2Fscy4kc2NvcGUgPSBzY29wZTtcclxuXHJcbiAgICAgICAgICAvL0luc3RhbnRpYXRlIGNvbnRyb2xsZXIgaWYgaXQgZXhpc3RzLCBiZWNhdXNlIHdlIGhhdmUgc2NvcGVcclxuICAgICAgICAgIGlmIChjb250cm9sbGVyKSB7XHJcbiAgICAgICAgICAgIHZhciBpbnZva2VDdHJsID0gJGNvbnRyb2xsZXIoY29udHJvbGxlciwgbG9jYWxzLCB0cnVlKTtcclxuICAgICAgICAgICAgaWYgKGJpbmRUb0NvbnRyb2xsZXIpIHtcclxuICAgICAgICAgICAgICBhbmd1bGFyLmV4dGVuZChpbnZva2VDdHJsLmluc3RhbmNlLCBsb2NhbHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBjdHJsID0gaW52b2tlQ3RybCgpO1xyXG4gICAgICAgICAgICAvL1NlZSBhbmd1bGFyLXJvdXRlIHNvdXJjZSBmb3IgdGhpcyBsb2dpY1xyXG4gICAgICAgICAgICBlbGVtZW50LmRhdGEoJyRuZ0NvbnRyb2xsZXJDb250cm9sbGVyJywgY3RybCk7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuY2hpbGRyZW4oKS5kYXRhKCckbmdDb250cm9sbGVyQ29udHJvbGxlcicsIGN0cmwpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGNvbnRyb2xsZXJBcykge1xyXG4gICAgICAgICAgICAgIHNjb3BlW2NvbnRyb2xsZXJBc10gPSBjdHJsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICByZXR1cm4gbGlua0ZuKHNjb3BlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICB9KTtcclxuXHJcbiAgfTtcclxufVxyXG5tZENvbXBpbGVyU2VydmljZS4kaW5qZWN0ID0gW1wiJHFcIiwgXCIkaHR0cFwiLCBcIiRpbmplY3RvclwiLCBcIiRjb21waWxlXCIsIFwiJGNvbnRyb2xsZXJcIiwgXCIkdGVtcGxhdGVDYWNoZVwiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgdmFyIEhBTkRMRVJTID0ge307XHJcbiAgLyogVGhlIHN0YXRlIG9mIHRoZSBjdXJyZW50ICdwb2ludGVyJ1xyXG4gICAqIFRoZSBwb2ludGVyIHJlcHJlc2VudHMgdGhlIHN0YXRlIG9mIHRoZSBjdXJyZW50IHRvdWNoLlxyXG4gICAqIEl0IGNvbnRhaW5zIG5vcm1hbGl6ZWQgeCBhbmQgeSBjb29yZGluYXRlcyBmcm9tIERPTSBldmVudHMsXHJcbiAgICogYXMgd2VsbCBhcyBvdGhlciBpbmZvcm1hdGlvbiBhYnN0cmFjdGVkIGZyb20gdGhlIERPTS5cclxuICAgKi9cclxuICB2YXIgcG9pbnRlciwgbGFzdFBvaW50ZXIsIGZvcmNlU2tpcENsaWNrSGlqYWNrID0gZmFsc2U7XHJcblxyXG4gIC8vIFVzZWQgdG8gYXR0YWNoIGV2ZW50IGxpc3RlbmVycyBvbmNlIHdoZW4gbXVsdGlwbGUgbmctYXBwcyBhcmUgcnVubmluZy5cclxuICB2YXIgaXNJbml0aWFsaXplZCA9IGZhbHNlO1xyXG4gIFxyXG4gIGFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvcmUuZ2VzdHVyZXMnLCBbIF0pXHJcbiAgICAucHJvdmlkZXIoJyRtZEdlc3R1cmUnLCBNZEdlc3R1cmVQcm92aWRlcilcclxuICAgIC5mYWN0b3J5KCckJE1kR2VzdHVyZUhhbmRsZXInLCBNZEdlc3R1cmVIYW5kbGVyKVxyXG4gICAgLnJ1biggYXR0YWNoVG9Eb2N1bWVudCApO1xyXG5cclxuICAvKipcclxuICAgICAqIEBuZ2RvYyBzZXJ2aWNlXHJcbiAgICAgKiBAbmFtZSAkbWRHZXN0dXJlUHJvdmlkZXJcclxuICAgICAqIEBtb2R1bGUgbWF0ZXJpYWwuY29yZS5nZXN0dXJlc1xyXG4gICAgICpcclxuICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICogSW4gc29tZSBzY2VuYXJpb3Mgb24gTW9iaWxlIGRldmljZXMgKHdpdGhvdXQgalF1ZXJ5KSwgdGhlIGNsaWNrIGV2ZW50cyBzaG91bGQgTk9UIGJlIGhpamFja2VkLlxyXG4gICAgICogYCRtZEdlc3R1cmVQcm92aWRlcmAgaXMgdXNlZCB0byBjb25maWd1cmUgdGhlIEdlc3R1cmUgbW9kdWxlIHRvIGlnbm9yZSBvciBza2lwIGNsaWNrIGhpamFja2luZyBvbiBtb2JpbGVcclxuICAgICAqIGRldmljZXMuXHJcbiAgICAgKlxyXG4gICAgICogPGhsanMgbGFuZz1cImpzXCI+XHJcbiAgICAgKiAgIGFwcC5jb25maWcoZnVuY3Rpb24oJG1kR2VzdHVyZVByb3ZpZGVyKSB7XHJcbiAgICAgKlxyXG4gICAgICogICAgIC8vIEZvciBtb2JpbGUgZGV2aWNlcyB3aXRob3V0IGpRdWVyeSBsb2FkZWQsIGRvIG5vdFxyXG4gICAgICogICAgIC8vIGludGVyY2VwdCBjbGljayBldmVudHMgZHVyaW5nIHRoZSBjYXB0dXJlIHBoYXNlLlxyXG4gICAgICogICAgICRtZEdlc3R1cmVQcm92aWRlci5za2lwQ2xpY2tIaWphY2soKTtcclxuICAgICAqXHJcbiAgICAgKiAgIH0pO1xyXG4gICAgICogPC9obGpzPlxyXG4gICAgICpcclxuICAgICAqL1xyXG4gIGZ1bmN0aW9uIE1kR2VzdHVyZVByb3ZpZGVyKCkgeyB9XHJcblxyXG4gIE1kR2VzdHVyZVByb3ZpZGVyLnByb3RvdHlwZSA9IHtcclxuXHJcbiAgICAvLyBQdWJsaXNoIGFjY2VzcyB0byBzZXR0ZXIgdG8gY29uZmlndXJlIGEgdmFyaWFibGUgIEJFRk9SRSB0aGVcclxuICAgIC8vICRtZEdlc3R1cmUgc2VydmljZSBpcyBpbnN0YW50aWF0ZWQuLi5cclxuICAgIHNraXBDbGlja0hpamFjazogZnVuY3Rpb24oKSB7XHJcbiAgICAgIHJldHVybiBmb3JjZVNraXBDbGlja0hpamFjayA9IHRydWU7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogJGdldCBpcyB1c2VkIHRvIGJ1aWxkIGFuIGluc3RhbmNlIG9mICRtZEdlc3R1cmVcclxuICAgICAqIEBuZ0luamVjdFxyXG4gICAgICovXHJcbiAgICAkZ2V0IDogW1wiJCRNZEdlc3R1cmVIYW5kbGVyXCIsIFwiJCRyQUZcIiwgXCIkdGltZW91dFwiLCBmdW5jdGlvbigkJE1kR2VzdHVyZUhhbmRsZXIsICQkckFGLCAkdGltZW91dCkge1xyXG4gICAgICAgICByZXR1cm4gbmV3IE1kR2VzdHVyZSgkJE1kR2VzdHVyZUhhbmRsZXIsICQkckFGLCAkdGltZW91dCk7XHJcbiAgICB9XVxyXG4gIH07XHJcblxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogTWRHZXN0dXJlIGZhY3RvcnkgY29uc3RydWN0aW9uIGZ1bmN0aW9uXHJcbiAgICogQG5nSW5qZWN0XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gTWRHZXN0dXJlKCQkTWRHZXN0dXJlSGFuZGxlciwgJCRyQUYsICR0aW1lb3V0KSB7XHJcbiAgICB2YXIgdXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudCB8fCBuYXZpZ2F0b3IudmVuZG9yIHx8IHdpbmRvdy5vcGVyYTtcclxuICAgIHZhciBpc0lvcyA9IHVzZXJBZ2VudC5tYXRjaCgvaXBhZHxpcGhvbmV8aXBvZC9pKTtcclxuICAgIHZhciBpc0FuZHJvaWQgPSB1c2VyQWdlbnQubWF0Y2goL2FuZHJvaWQvaSk7XHJcbiAgICB2YXIgaGFzSlF1ZXJ5ID0gICh0eXBlb2Ygd2luZG93LmpRdWVyeSAhPT0gJ3VuZGVmaW5lZCcpICYmIChhbmd1bGFyLmVsZW1lbnQgPT09IHdpbmRvdy5qUXVlcnkpO1xyXG5cclxuICAgIHZhciBzZWxmID0ge1xyXG4gICAgICBoYW5kbGVyOiBhZGRIYW5kbGVyLFxyXG4gICAgICByZWdpc3RlcjogcmVnaXN0ZXIsXHJcbiAgICAgIC8vIE9uIG1vYmlsZSB3L291dCBqUXVlcnksIHdlIG5vcm1hbGx5IGludGVyY2VwdCBjbGlja3MuIFNob3VsZCB3ZSBza2lwIHRoYXQ/XHJcbiAgICAgIGlzSGlqYWNraW5nQ2xpY2tzOiAoaXNJb3MgfHwgaXNBbmRyb2lkKSAmJiAhaGFzSlF1ZXJ5ICYmICFmb3JjZVNraXBDbGlja0hpamFja1xyXG4gICAgfTtcclxuXHJcbiAgICBpZiAoc2VsZi5pc0hpamFja2luZ0NsaWNrcykge1xyXG4gICAgICBzZWxmLmhhbmRsZXIoJ2NsaWNrJywge1xyXG4gICAgICAgIG9wdGlvbnM6IHtcclxuICAgICAgICAgIG1heERpc3RhbmNlOiA2XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvbkVuZDogZnVuY3Rpb24gKGV2LCBwb2ludGVyKSB7XHJcbiAgICAgICAgICBpZiAocG9pbnRlci5kaXN0YW5jZSA8IHRoaXMuc3RhdGUub3B0aW9ucy5tYXhEaXN0YW5jZSkge1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXYsICdjbGljaycpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLypcclxuICAgICAqIFJlZ2lzdGVyIGFuIGVsZW1lbnQgdG8gbGlzdGVuIGZvciBhIGhhbmRsZXIuXHJcbiAgICAgKiBUaGlzIGFsbG93cyBhbiBlbGVtZW50IHRvIG92ZXJyaWRlIHRoZSBkZWZhdWx0IG9wdGlvbnMgZm9yIGEgaGFuZGxlci5cclxuICAgICAqIEFkZGl0aW9uYWxseSwgc29tZSBoYW5kbGVycyBsaWtlIGRyYWcgYW5kIGhvbGQgb25seSBkaXNwYXRjaCBldmVudHMgaWZcclxuICAgICAqIHRoZSBkb21FdmVudCBoYXBwZW5zIGluc2lkZSBhbiBlbGVtZW50IHRoYXQncyByZWdpc3RlcmVkIHRvIGxpc3RlbiBmb3IgdGhlc2UgZXZlbnRzLlxyXG4gICAgICpcclxuICAgICAqIEBzZWUgR2VzdHVyZUhhbmRsZXIgZm9yIGhvdyBvdmVycmlkaW5nIG9mIGRlZmF1bHQgb3B0aW9ucyB3b3Jrcy5cclxuICAgICAqIEBleGFtcGxlICRtZEdlc3R1cmUucmVnaXN0ZXIobXlFbGVtZW50LCAnZHJhZycsIHsgbWluRGlzdGFuY2U6IDIwLCBob3J6aW9udGFsOiBmYWxzZSB9KVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiByZWdpc3RlcihlbGVtZW50LCBoYW5kbGVyTmFtZSwgb3B0aW9ucykge1xyXG4gICAgICB2YXIgaGFuZGxlciA9IEhBTkRMRVJTW2hhbmRsZXJOYW1lLnJlcGxhY2UoL15cXCRtZC4vLCAnJyldO1xyXG4gICAgICBpZiAoIWhhbmRsZXIpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byByZWdpc3RlciBlbGVtZW50IHdpdGggaGFuZGxlciAnICsgaGFuZGxlck5hbWUgKyAnLiAnICtcclxuICAgICAgICAnQXZhaWxhYmxlIGhhbmRsZXJzOiAnICsgT2JqZWN0LmtleXMoSEFORExFUlMpLmpvaW4oJywgJykpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBoYW5kbGVyLnJlZ2lzdGVyRWxlbWVudChlbGVtZW50LCBvcHRpb25zKTtcclxuICAgIH1cclxuXHJcbiAgICAvKlxyXG4gICAgICogYWRkIGEgaGFuZGxlciB0byAkbWRHZXN0dXJlLiBzZWUgYmVsb3cuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGFkZEhhbmRsZXIobmFtZSwgZGVmaW5pdGlvbikge1xyXG4gICAgICB2YXIgaGFuZGxlciA9IG5ldyAkJE1kR2VzdHVyZUhhbmRsZXIobmFtZSk7XHJcbiAgICAgIGFuZ3VsYXIuZXh0ZW5kKGhhbmRsZXIsIGRlZmluaXRpb24pO1xyXG4gICAgICBIQU5ETEVSU1tuYW1lXSA9IGhhbmRsZXI7XHJcblxyXG4gICAgICByZXR1cm4gc2VsZjtcclxuICAgIH1cclxuXHJcbiAgICAvKlxyXG4gICAgICogUmVnaXN0ZXIgaGFuZGxlcnMuIFRoZXNlIGxpc3RlbiB0byB0b3VjaC9zdGFydC9tb3ZlIGV2ZW50cywgaW50ZXJwcmV0IHRoZW0sXHJcbiAgICAgKiBhbmQgZGlzcGF0Y2ggZ2VzdHVyZSBldmVudHMgZGVwZW5kaW5nIG9uIG9wdGlvbnMgJiBjb25kaXRpb25zLiBUaGVzZSBhcmUgYWxsXHJcbiAgICAgKiBpbnN0YW5jZXMgb2YgR2VzdHVyZUhhbmRsZXIuXHJcbiAgICAgKiBAc2VlIEdlc3R1cmVIYW5kbGVyIFxyXG4gICAgICovXHJcbiAgICByZXR1cm4gc2VsZlxyXG4gICAgICAvKlxyXG4gICAgICAgKiBUaGUgcHJlc3MgaGFuZGxlciBkaXNwYXRjaGVzIGFuIGV2ZW50IG9uIHRvdWNoZG93bi90b3VjaGVuZC5cclxuICAgICAgICogSXQncyBhIHNpbXBsZSBhYnN0cmFjdGlvbiBvZiB0b3VjaC9tb3VzZS9wb2ludGVyIHN0YXJ0IGFuZCBlbmQuXHJcbiAgICAgICAqL1xyXG4gICAgICAuaGFuZGxlcigncHJlc3MnLCB7XHJcbiAgICAgICAgb25TdGFydDogZnVuY3Rpb24gKGV2LCBwb2ludGVyKSB7XHJcbiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXYsICckbWQucHJlc3Nkb3duJyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvbkVuZDogZnVuY3Rpb24gKGV2LCBwb2ludGVyKSB7XHJcbiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXYsICckbWQucHJlc3N1cCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuXHJcbiAgICAgIC8qXHJcbiAgICAgICAqIFRoZSBob2xkIGhhbmRsZXIgZGlzcGF0Y2hlcyBhbiBldmVudCBpZiB0aGUgdXNlciBrZWVwcyB0aGVpciBmaW5nZXIgd2l0aGluXHJcbiAgICAgICAqIHRoZSBzYW1lIDxtYXhEaXN0YW5jZT4gYXJlYSBmb3IgPGRlbGF5PiBtcy5cclxuICAgICAgICogVGhlIGhvbGQgaGFuZGxlciB3aWxsIG9ubHkgcnVuIGlmIGEgcGFyZW50IG9mIHRoZSB0b3VjaCB0YXJnZXQgaXMgcmVnaXN0ZXJlZFxyXG4gICAgICAgKiB0byBsaXN0ZW4gZm9yIGhvbGQgZXZlbnRzIHRocm91Z2ggJG1kR2VzdHVyZS5yZWdpc3RlcigpXHJcbiAgICAgICAqL1xyXG4gICAgICAuaGFuZGxlcignaG9sZCcsIHtcclxuICAgICAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgICBtYXhEaXN0YW5jZTogNixcclxuICAgICAgICAgIGRlbGF5OiA1MDBcclxuICAgICAgICB9LFxyXG4gICAgICAgIG9uQ2FuY2VsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGhpcy5zdGF0ZS50aW1lb3V0KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIG9uU3RhcnQ6IGZ1bmN0aW9uIChldiwgcG9pbnRlcikge1xyXG4gICAgICAgICAgLy8gRm9yIGhvbGQsIHJlcXVpcmUgYSBwYXJlbnQgdG8gYmUgcmVnaXN0ZXJlZCB3aXRoICRtZEdlc3R1cmUucmVnaXN0ZXIoKVxyXG4gICAgICAgICAgLy8gQmVjYXVzZSB3ZSBwcmV2ZW50IHNjcm9sbCBldmVudHMsIHRoaXMgaXMgbmVjZXNzYXJ5LlxyXG4gICAgICAgICAgaWYgKCF0aGlzLnN0YXRlLnJlZ2lzdGVyZWRQYXJlbnQpIHJldHVybiB0aGlzLmNhbmNlbCgpO1xyXG5cclxuICAgICAgICAgIHRoaXMuc3RhdGUucG9zID0ge3g6IHBvaW50ZXIueCwgeTogcG9pbnRlci55fTtcclxuICAgICAgICAgIHRoaXMuc3RhdGUudGltZW91dCA9ICR0aW1lb3V0KGFuZ3VsYXIuYmluZCh0aGlzLCBmdW5jdGlvbiBob2xkRGVsYXlGbigpIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2LCAnJG1kLmhvbGQnKTtcclxuICAgICAgICAgICAgdGhpcy5jYW5jZWwoKTsgLy93ZSdyZSBkb25lIVxyXG4gICAgICAgICAgfSksIHRoaXMuc3RhdGUub3B0aW9ucy5kZWxheSwgZmFsc2UpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25Nb3ZlOiBmdW5jdGlvbiAoZXYsIHBvaW50ZXIpIHtcclxuICAgICAgICAgIC8vIERvbid0IHNjcm9sbCB3aGlsZSB3YWl0aW5nIGZvciBob2xkLlxyXG4gICAgICAgICAgLy8gSWYgd2UgZG9uJ3QgcHJldmVudERlZmF1bHQgdG91Y2htb3ZlIGV2ZW50cyBoZXJlLCBBbmRyb2lkIHdpbGwgYXNzdW1lIHdlIGRvbid0XHJcbiAgICAgICAgICAvLyB3YW50IHRvIGxpc3RlbiB0byBhbnltb3JlIHRvdWNoIGV2ZW50cy4gSXQgd2lsbCBzdGFydCBzY3JvbGxpbmcgYW5kIHN0b3Agc2VuZGluZ1xyXG4gICAgICAgICAgLy8gdG91Y2htb3ZlIGV2ZW50cy5cclxuICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgICAgLy8gSWYgdGhlIHVzZXIgbW92ZXMgZ3JlYXRlciB0aGFuIDxtYXhEaXN0YW5jZT4gcGl4ZWxzLCBzdG9wIHRoZSBob2xkIHRpbWVyXHJcbiAgICAgICAgICAvLyBzZXQgaW4gb25TdGFydFxyXG4gICAgICAgICAgdmFyIGR4ID0gdGhpcy5zdGF0ZS5wb3MueCAtIHBvaW50ZXIueDtcclxuICAgICAgICAgIHZhciBkeSA9IHRoaXMuc3RhdGUucG9zLnkgLSBwb2ludGVyLnk7XHJcbiAgICAgICAgICBpZiAoTWF0aC5zcXJ0KGR4ICogZHggKyBkeSAqIGR5KSA+IHRoaXMub3B0aW9ucy5tYXhEaXN0YW5jZSkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbmNlbCgpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25FbmQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgIHRoaXMub25DYW5jZWwoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcblxyXG4gICAgICAvKlxyXG4gICAgICAgKiBUaGUgZHJhZyBoYW5kbGVyIGRpc3BhdGNoZXMgYSBkcmFnIGV2ZW50IGlmIHRoZSB1c2VyIGhvbGRzIGFuZCBtb3ZlcyBoaXMgZmluZ2VyIGdyZWF0ZXIgdGhhblxyXG4gICAgICAgKiA8bWluRGlzdGFuY2U+IHB4IGluIHRoZSB4IG9yIHkgZGlyZWN0aW9uLCBkZXBlbmRpbmcgb24gb3B0aW9ucy5ob3Jpem9udGFsLlxyXG4gICAgICAgKiBUaGUgZHJhZyB3aWxsIGJlIGNhbmNlbGxlZCBpZiB0aGUgdXNlciBtb3ZlcyBoaXMgZmluZ2VyIGdyZWF0ZXIgdGhhbiA8bWluRGlzdGFuY2U+KjxjYW5jZWxNdWx0aXBsaWVyPiBpblxyXG4gICAgICAgKiB0aGUgcGVycGluZGljdWxhciBkaXJlY3Rpb24uIEVnIGlmIHRoZSBkcmFnIGlzIGhvcml6b250YWwgYW5kIHRoZSB1c2VyIG1vdmVzIGhpcyBmaW5nZXIgPG1pbkRpc3RhbmNlPio8Y2FuY2VsTXVsdGlwbGllcj5cclxuICAgICAgICogcGl4ZWxzIHZlcnRpY2FsbHksIHRoaXMgaGFuZGxlciB3b24ndCBjb25zaWRlciB0aGUgbW92ZSBwYXJ0IG9mIGEgZHJhZy5cclxuICAgICAgICovXHJcbiAgICAgIC5oYW5kbGVyKCdkcmFnJywge1xyXG4gICAgICAgIG9wdGlvbnM6IHtcclxuICAgICAgICAgIG1pbkRpc3RhbmNlOiA2LFxyXG4gICAgICAgICAgaG9yaXpvbnRhbDogdHJ1ZSxcclxuICAgICAgICAgIGNhbmNlbE11bHRpcGxpZXI6IDEuNVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25TdGFydDogZnVuY3Rpb24gKGV2KSB7XHJcbiAgICAgICAgICAvLyBGb3IgZHJhZywgcmVxdWlyZSBhIHBhcmVudCB0byBiZSByZWdpc3RlcmVkIHdpdGggJG1kR2VzdHVyZS5yZWdpc3RlcigpXHJcbiAgICAgICAgICBpZiAoIXRoaXMuc3RhdGUucmVnaXN0ZXJlZFBhcmVudCkgdGhpcy5jYW5jZWwoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIG9uTW92ZTogZnVuY3Rpb24gKGV2LCBwb2ludGVyKSB7XHJcbiAgICAgICAgICB2YXIgc2hvdWxkU3RhcnREcmFnLCBzaG91bGRDYW5jZWw7XHJcbiAgICAgICAgICAvLyBEb24ndCBzY3JvbGwgd2hpbGUgZGVjaWRpbmcgaWYgdGhpcyB0b3VjaG1vdmUgcXVhbGlmaWVzIGFzIGEgZHJhZyBldmVudC5cclxuICAgICAgICAgIC8vIElmIHdlIGRvbid0IHByZXZlbnREZWZhdWx0IHRvdWNobW92ZSBldmVudHMgaGVyZSwgQW5kcm9pZCB3aWxsIGFzc3VtZSB3ZSBkb24ndFxyXG4gICAgICAgICAgLy8gd2FudCB0byBsaXN0ZW4gdG8gYW55bW9yZSB0b3VjaCBldmVudHMuIEl0IHdpbGwgc3RhcnQgc2Nyb2xsaW5nIGFuZCBzdG9wIHNlbmRpbmdcclxuICAgICAgICAgIC8vIHRvdWNobW92ZSBldmVudHMuXHJcbiAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgIGlmICghdGhpcy5zdGF0ZS5kcmFnUG9pbnRlcikge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zdGF0ZS5vcHRpb25zLmhvcml6b250YWwpIHtcclxuICAgICAgICAgICAgICBzaG91bGRTdGFydERyYWcgPSBNYXRoLmFicyhwb2ludGVyLmRpc3RhbmNlWCkgPiB0aGlzLnN0YXRlLm9wdGlvbnMubWluRGlzdGFuY2U7XHJcbiAgICAgICAgICAgICAgc2hvdWxkQ2FuY2VsID0gTWF0aC5hYnMocG9pbnRlci5kaXN0YW5jZVkpID4gdGhpcy5zdGF0ZS5vcHRpb25zLm1pbkRpc3RhbmNlICogdGhpcy5zdGF0ZS5vcHRpb25zLmNhbmNlbE11bHRpcGxpZXI7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgc2hvdWxkU3RhcnREcmFnID0gTWF0aC5hYnMocG9pbnRlci5kaXN0YW5jZVkpID4gdGhpcy5zdGF0ZS5vcHRpb25zLm1pbkRpc3RhbmNlO1xyXG4gICAgICAgICAgICAgIHNob3VsZENhbmNlbCA9IE1hdGguYWJzKHBvaW50ZXIuZGlzdGFuY2VYKSA+IHRoaXMuc3RhdGUub3B0aW9ucy5taW5EaXN0YW5jZSAqIHRoaXMuc3RhdGUub3B0aW9ucy5jYW5jZWxNdWx0aXBsaWVyO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkU3RhcnREcmFnKSB7XHJcbiAgICAgICAgICAgICAgLy8gQ3JlYXRlIGEgbmV3IHBvaW50ZXIgcmVwcmVzZW50aW5nIHRoaXMgZHJhZywgc3RhcnRpbmcgYXQgdGhpcyBwb2ludCB3aGVyZSB0aGUgZHJhZyBzdGFydGVkLlxyXG4gICAgICAgICAgICAgIHRoaXMuc3RhdGUuZHJhZ1BvaW50ZXIgPSBtYWtlU3RhcnRQb2ludGVyKGV2KTtcclxuICAgICAgICAgICAgICB1cGRhdGVQb2ludGVyU3RhdGUoZXYsIHRoaXMuc3RhdGUuZHJhZ1BvaW50ZXIpO1xyXG4gICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldiwgJyRtZC5kcmFnc3RhcnQnLCB0aGlzLnN0YXRlLmRyYWdQb2ludGVyKTtcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hvdWxkQ2FuY2VsKSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5jYW5jZWwoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaERyYWdNb3ZlKGV2KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIC8vIE9ubHkgZGlzcGF0Y2ggZHJhZ21vdmUgZXZlbnRzIGV2ZXJ5IGZyYW1lOyBhbnkgbW9yZSBpcyB1bm5lY2Vzc3JheVxyXG4gICAgICAgIGRpc3BhdGNoRHJhZ01vdmU6ICQkckFGLnRocm90dGxlKGZ1bmN0aW9uIChldikge1xyXG4gICAgICAgICAgLy8gTWFrZSBzdXJlIHRoZSBkcmFnIGRpZG4ndCBzdG9wIHdoaWxlIHdhaXRpbmcgZm9yIHRoZSBuZXh0IGZyYW1lXHJcbiAgICAgICAgICBpZiAodGhpcy5zdGF0ZS5pc1J1bm5pbmcpIHtcclxuICAgICAgICAgICAgdXBkYXRlUG9pbnRlclN0YXRlKGV2LCB0aGlzLnN0YXRlLmRyYWdQb2ludGVyKTtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2LCAnJG1kLmRyYWcnLCB0aGlzLnN0YXRlLmRyYWdQb2ludGVyKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KSxcclxuICAgICAgICBvbkVuZDogZnVuY3Rpb24gKGV2LCBwb2ludGVyKSB7XHJcbiAgICAgICAgICBpZiAodGhpcy5zdGF0ZS5kcmFnUG9pbnRlcikge1xyXG4gICAgICAgICAgICB1cGRhdGVQb2ludGVyU3RhdGUoZXYsIHRoaXMuc3RhdGUuZHJhZ1BvaW50ZXIpO1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXYsICckbWQuZHJhZ2VuZCcsIHRoaXMuc3RhdGUuZHJhZ1BvaW50ZXIpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuXHJcbiAgICAgIC8qXHJcbiAgICAgICAqIFRoZSBzd2lwZSBoYW5kbGVyIHdpbGwgZGlzcGF0Y2ggYSBzd2lwZSBldmVudCBpZiwgb24gdGhlIGVuZCBvZiBhIHRvdWNoLFxyXG4gICAgICAgKiB0aGUgdmVsb2NpdHkgYW5kIGRpc3RhbmNlIHdlcmUgaGlnaCBlbm91Z2guXHJcbiAgICAgICAqIFRPRE86IGFkZCB2ZXJ0aWNhbCBzd2lwaW5nIHdpdGggYSBgaG9yaXpvbnRhbGAgb3B0aW9uIHNpbWlsYXIgdG8gdGhlIGRyYWcgaGFuZGxlci5cclxuICAgICAgICovXHJcbiAgICAgIC5oYW5kbGVyKCdzd2lwZScsIHtcclxuICAgICAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgICBtaW5WZWxvY2l0eTogMC42NSxcclxuICAgICAgICAgIG1pbkRpc3RhbmNlOiAxMFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25FbmQ6IGZ1bmN0aW9uIChldiwgcG9pbnRlcikge1xyXG4gICAgICAgICAgaWYgKE1hdGguYWJzKHBvaW50ZXIudmVsb2NpdHlYKSA+IHRoaXMuc3RhdGUub3B0aW9ucy5taW5WZWxvY2l0eSAmJlxyXG4gICAgICAgICAgICBNYXRoLmFicyhwb2ludGVyLmRpc3RhbmNlWCkgPiB0aGlzLnN0YXRlLm9wdGlvbnMubWluRGlzdGFuY2UpIHtcclxuICAgICAgICAgICAgdmFyIGV2ZW50VHlwZSA9IHBvaW50ZXIuZGlyZWN0aW9uWCA9PSAnbGVmdCcgPyAnJG1kLnN3aXBlbGVmdCcgOiAnJG1kLnN3aXBlcmlnaHQnO1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXYsIGV2ZW50VHlwZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgfVxyXG4gIE1kR2VzdHVyZS4kaW5qZWN0ID0gW1wiJCRNZEdlc3R1cmVIYW5kbGVyXCIsIFwiJCRyQUZcIiwgXCIkdGltZW91dFwiXTtcclxuXHJcbiAgLyoqXHJcbiAgICogTWRHZXN0dXJlSGFuZGxlclxyXG4gICAqIEEgR2VzdHVyZUhhbmRsZXIgaXMgYW4gb2JqZWN0IHdoaWNoIGlzIGFibGUgdG8gZGlzcGF0Y2ggY3VzdG9tIGRvbSBldmVudHNcclxuICAgKiBiYXNlZCBvbiBuYXRpdmUgZG9tIHt0b3VjaCxwb2ludGVyLG1vdXNlfXtzdGFydCxtb3ZlLGVuZH0gZXZlbnRzLlxyXG4gICAqXHJcbiAgICogQSBnZXN0dXJlIHdpbGwgbWFuYWdlIGl0cyBsaWZlY3ljbGUgdGhyb3VnaCB0aGUgc3RhcnQsbW92ZSxlbmQsIGFuZCBjYW5jZWxcclxuICAgKiBmdW5jdGlvbnMsIHdoaWNoIGFyZSBjYWxsZWQgYnkgbmF0aXZlIGRvbSBldmVudHMuXHJcbiAgICpcclxuICAgKiBBIGdlc3R1cmUgaGFzIHRoZSBjb25jZXB0IG9mICdvcHRpb25zJyAoZWcgYSBzd2lwZSdzIHJlcXVpcmVkIHZlbG9jaXR5KSwgd2hpY2ggY2FuIGJlXHJcbiAgICogb3ZlcnJpZGRlbiBieSBlbGVtZW50cyByZWdpc3RlcmluZyB0aHJvdWdoICRtZEdlc3R1cmUucmVnaXN0ZXIoKVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIEdlc3R1cmVIYW5kbGVyIChuYW1lKSB7XHJcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgdGhpcy5zdGF0ZSA9IHt9O1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gTWRHZXN0dXJlSGFuZGxlcigpIHtcclxuICAgIHZhciBoYXNKUXVlcnkgPSAgKHR5cGVvZiB3aW5kb3cualF1ZXJ5ICE9PSAndW5kZWZpbmVkJykgJiYgKGFuZ3VsYXIuZWxlbWVudCA9PT0gd2luZG93LmpRdWVyeSk7XHJcblxyXG4gICAgR2VzdHVyZUhhbmRsZXIucHJvdG90eXBlID0ge1xyXG4gICAgICBvcHRpb25zOiB7fSxcclxuICAgICAgLy8galF1ZXJ5IGxpc3RlbmVycyBkb24ndCB3b3JrIHdpdGggY3VzdG9tIERPTUV2ZW50cywgc28gd2UgaGF2ZSB0byBkaXNwYXRjaCBldmVudHNcclxuICAgICAgLy8gZGlmZmVyZW50bHkgd2hlbiBqUXVlcnkgaXMgbG9hZGVkXHJcbiAgICAgIGRpc3BhdGNoRXZlbnQ6IGhhc0pRdWVyeSA/ICBqUXVlcnlEaXNwYXRjaEV2ZW50IDogbmF0aXZlRGlzcGF0Y2hFdmVudCxcclxuXHJcbiAgICAgIC8vIFRoZXNlIGFyZSBvdmVycmlkZGVuIGJ5IHRoZSByZWdpc3RlcmVkIGhhbmRsZXJcclxuICAgICAgb25TdGFydDogYW5ndWxhci5ub29wLFxyXG4gICAgICBvbk1vdmU6IGFuZ3VsYXIubm9vcCxcclxuICAgICAgb25FbmQ6IGFuZ3VsYXIubm9vcCxcclxuICAgICAgb25DYW5jZWw6IGFuZ3VsYXIubm9vcCxcclxuXHJcbiAgICAgIC8vIG9uU3RhcnQgc2V0cyB1cCBhIG5ldyBzdGF0ZSBmb3IgdGhlIGhhbmRsZXIsIHdoaWNoIGluY2x1ZGVzIG9wdGlvbnMgZnJvbSB0aGVcclxuICAgICAgLy8gbmVhcmVzdCByZWdpc3RlcmVkIHBhcmVudCBlbGVtZW50IG9mIGV2LnRhcmdldC5cclxuICAgICAgc3RhcnQ6IGZ1bmN0aW9uIChldiwgcG9pbnRlcikge1xyXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmlzUnVubmluZykgcmV0dXJuO1xyXG4gICAgICAgIHZhciBwYXJlbnRUYXJnZXQgPSB0aGlzLmdldE5lYXJlc3RQYXJlbnQoZXYudGFyZ2V0KTtcclxuICAgICAgICAvLyBHZXQgdGhlIG9wdGlvbnMgZnJvbSB0aGUgbmVhcmVzdCByZWdpc3RlcmVkIHBhcmVudFxyXG4gICAgICAgIHZhciBwYXJlbnRUYXJnZXRPcHRpb25zID0gcGFyZW50VGFyZ2V0ICYmIHBhcmVudFRhcmdldC4kbWRHZXN0dXJlW3RoaXMubmFtZV0gfHwge307XHJcblxyXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgICAgICBpc1J1bm5pbmc6IHRydWUsXHJcbiAgICAgICAgICAvLyBPdmVycmlkZSB0aGUgZGVmYXVsdCBvcHRpb25zIHdpdGggdGhlIG5lYXJlc3QgcmVnaXN0ZXJlZCBwYXJlbnQncyBvcHRpb25zXHJcbiAgICAgICAgICBvcHRpb25zOiBhbmd1bGFyLmV4dGVuZCh7fSwgdGhpcy5vcHRpb25zLCBwYXJlbnRUYXJnZXRPcHRpb25zKSxcclxuICAgICAgICAgIC8vIFBhc3MgaW4gdGhlIHJlZ2lzdGVyZWQgcGFyZW50IG5vZGUgdG8gdGhlIHN0YXRlIHNvIHRoZSBvblN0YXJ0IGxpc3RlbmVyIGNhbiB1c2VcclxuICAgICAgICAgIHJlZ2lzdGVyZWRQYXJlbnQ6IHBhcmVudFRhcmdldFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5vblN0YXJ0KGV2LCBwb2ludGVyKTtcclxuICAgICAgfSxcclxuICAgICAgbW92ZTogZnVuY3Rpb24gKGV2LCBwb2ludGVyKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLnN0YXRlLmlzUnVubmluZykgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMub25Nb3ZlKGV2LCBwb2ludGVyKTtcclxuICAgICAgfSxcclxuICAgICAgZW5kOiBmdW5jdGlvbiAoZXYsIHBvaW50ZXIpIHtcclxuICAgICAgICBpZiAoIXRoaXMuc3RhdGUuaXNSdW5uaW5nKSByZXR1cm47XHJcbiAgICAgICAgdGhpcy5vbkVuZChldiwgcG9pbnRlcik7XHJcbiAgICAgICAgdGhpcy5zdGF0ZS5pc1J1bm5pbmcgPSBmYWxzZTtcclxuICAgICAgfSxcclxuICAgICAgY2FuY2VsOiBmdW5jdGlvbiAoZXYsIHBvaW50ZXIpIHtcclxuICAgICAgICB0aGlzLm9uQ2FuY2VsKGV2LCBwb2ludGVyKTtcclxuICAgICAgICB0aGlzLnN0YXRlID0ge307XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAvLyBGaW5kIGFuZCByZXR1cm4gdGhlIG5lYXJlc3QgcGFyZW50IGVsZW1lbnQgdGhhdCBoYXMgYmVlbiByZWdpc3RlcmVkIHRvXHJcbiAgICAgIC8vIGxpc3RlbiBmb3IgdGhpcyBoYW5kbGVyIHZpYSAkbWRHZXN0dXJlLnJlZ2lzdGVyKGVsZW1lbnQsICdoYW5kbGVyTmFtZScpLlxyXG4gICAgICBnZXROZWFyZXN0UGFyZW50OiBmdW5jdGlvbiAobm9kZSkge1xyXG4gICAgICAgIHZhciBjdXJyZW50ID0gbm9kZTtcclxuICAgICAgICB3aGlsZSAoY3VycmVudCkge1xyXG4gICAgICAgICAgaWYgKChjdXJyZW50LiRtZEdlc3R1cmUgfHwge30pW3RoaXMubmFtZV0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnQ7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC5wYXJlbnROb2RlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8vIENhbGxlZCBmcm9tICRtZEdlc3R1cmUucmVnaXN0ZXIgd2hlbiBhbiBlbGVtZW50IHJlaWdzdGVycyBpdHNlbGYgd2l0aCBhIGhhbmRsZXIuXHJcbiAgICAgIC8vIFN0b3JlIHRoZSBvcHRpb25zIHRoZSB1c2VyIGdhdmUgb24gdGhlIERPTUVsZW1lbnQgaXRzZWxmLiBUaGVzZSBvcHRpb25zIHdpbGxcclxuICAgICAgLy8gYmUgcmV0cmlldmVkIHdpdGggZ2V0TmVhcmVzdFBhcmVudCB3aGVuIHRoZSBoYW5kbGVyIHN0YXJ0cy5cclxuICAgICAgcmVnaXN0ZXJFbGVtZW50OiBmdW5jdGlvbiAoZWxlbWVudCwgb3B0aW9ucykge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBlbGVtZW50WzBdLiRtZEdlc3R1cmUgPSBlbGVtZW50WzBdLiRtZEdlc3R1cmUgfHwge307XHJcbiAgICAgICAgZWxlbWVudFswXS4kbWRHZXN0dXJlW3RoaXMubmFtZV0gPSBvcHRpb25zIHx8IHt9O1xyXG4gICAgICAgIGVsZW1lbnQub24oJyRkZXN0cm95Jywgb25EZXN0cm95KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIG9uRGVzdHJveTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gb25EZXN0cm95KCkge1xyXG4gICAgICAgICAgZGVsZXRlIGVsZW1lbnRbMF0uJG1kR2VzdHVyZVtzZWxmLm5hbWVdO1xyXG4gICAgICAgICAgZWxlbWVudC5vZmYoJyRkZXN0cm95Jywgb25EZXN0cm95KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIEdlc3R1cmVIYW5kbGVyO1xyXG5cclxuICAgIC8qXHJcbiAgICAgKiBEaXNwYXRjaCBhbiBldmVudCB3aXRoIGpRdWVyeVxyXG4gICAgICogVE9ETzogTWFrZSBzdXJlIHRoaXMgc2VuZHMgYnViYmxpbmcgZXZlbnRzXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHNyY0V2ZW50IHRoZSBvcmlnaW5hbCBET00gdG91Y2ggZXZlbnQgdGhhdCBzdGFydGVkIHRoaXMuXHJcbiAgICAgKiBAcGFyYW0gZXZlbnRUeXBlIHRoZSBuYW1lIG9mIHRoZSBjdXN0b20gZXZlbnQgdG8gc2VuZCAoZWcgJ2NsaWNrJyBvciAnJG1kLmRyYWcnKVxyXG4gICAgICogQHBhcmFtIGV2ZW50UG9pbnRlciB0aGUgcG9pbnRlciBvYmplY3QgdGhhdCBtYXRjaGVzIHRoaXMgZXZlbnQuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGpRdWVyeURpc3BhdGNoRXZlbnQoc3JjRXZlbnQsIGV2ZW50VHlwZSwgZXZlbnRQb2ludGVyKSB7XHJcbiAgICAgIGV2ZW50UG9pbnRlciA9IGV2ZW50UG9pbnRlciB8fCBwb2ludGVyO1xyXG4gICAgICB2YXIgZXZlbnRPYmogPSBuZXcgYW5ndWxhci5lbGVtZW50LkV2ZW50KGV2ZW50VHlwZSk7XHJcblxyXG4gICAgICBldmVudE9iai4kbWF0ZXJpYWwgPSB0cnVlO1xyXG4gICAgICBldmVudE9iai5wb2ludGVyID0gZXZlbnRQb2ludGVyO1xyXG4gICAgICBldmVudE9iai5zcmNFdmVudCA9IHNyY0V2ZW50O1xyXG5cclxuICAgICAgYW5ndWxhci5leHRlbmQoZXZlbnRPYmosIHtcclxuICAgICAgICBjbGllbnRYOiBldmVudFBvaW50ZXIueCxcclxuICAgICAgICBjbGllbnRZOiBldmVudFBvaW50ZXIueSxcclxuICAgICAgICBzY3JlZW5YOiBldmVudFBvaW50ZXIueCxcclxuICAgICAgICBzY3JlZW5ZOiBldmVudFBvaW50ZXIueSxcclxuICAgICAgICBwYWdlWDogZXZlbnRQb2ludGVyLngsXHJcbiAgICAgICAgcGFnZVk6IGV2ZW50UG9pbnRlci55LFxyXG4gICAgICAgIGN0cmxLZXk6IHNyY0V2ZW50LmN0cmxLZXksXHJcbiAgICAgICAgYWx0S2V5OiBzcmNFdmVudC5hbHRLZXksXHJcbiAgICAgICAgc2hpZnRLZXk6IHNyY0V2ZW50LnNoaWZ0S2V5LFxyXG4gICAgICAgIG1ldGFLZXk6IHNyY0V2ZW50Lm1ldGFLZXlcclxuICAgICAgfSk7XHJcbiAgICAgIGFuZ3VsYXIuZWxlbWVudChldmVudFBvaW50ZXIudGFyZ2V0KS50cmlnZ2VyKGV2ZW50T2JqKTtcclxuICAgIH1cclxuXHJcbiAgICAvKlxyXG4gICAgICogTk9URTogbmF0aXZlRGlzcGF0Y2hFdmVudCBpcyB2ZXJ5IHBlcmZvcm1hbmNlIHNlbnNpdGl2ZS5cclxuICAgICAqIEBwYXJhbSBzcmNFdmVudCB0aGUgb3JpZ2luYWwgRE9NIHRvdWNoIGV2ZW50IHRoYXQgc3RhcnRlZCB0aGlzLlxyXG4gICAgICogQHBhcmFtIGV2ZW50VHlwZSB0aGUgbmFtZSBvZiB0aGUgY3VzdG9tIGV2ZW50IHRvIHNlbmQgKGVnICdjbGljaycgb3IgJyRtZC5kcmFnJylcclxuICAgICAqIEBwYXJhbSBldmVudFBvaW50ZXIgdGhlIHBvaW50ZXIgb2JqZWN0IHRoYXQgbWF0Y2hlcyB0aGlzIGV2ZW50LlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBuYXRpdmVEaXNwYXRjaEV2ZW50KHNyY0V2ZW50LCBldmVudFR5cGUsIGV2ZW50UG9pbnRlcikge1xyXG4gICAgICBldmVudFBvaW50ZXIgPSBldmVudFBvaW50ZXIgfHwgcG9pbnRlcjtcclxuICAgICAgdmFyIGV2ZW50T2JqO1xyXG5cclxuICAgICAgaWYgKGV2ZW50VHlwZSA9PT0gJ2NsaWNrJykge1xyXG4gICAgICAgIGV2ZW50T2JqID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ01vdXNlRXZlbnRzJyk7XHJcbiAgICAgICAgZXZlbnRPYmouaW5pdE1vdXNlRXZlbnQoXHJcbiAgICAgICAgICAnY2xpY2snLCB0cnVlLCB0cnVlLCB3aW5kb3csIHNyY0V2ZW50LmRldGFpbCxcclxuICAgICAgICAgIGV2ZW50UG9pbnRlci54LCBldmVudFBvaW50ZXIueSwgZXZlbnRQb2ludGVyLngsIGV2ZW50UG9pbnRlci55LFxyXG4gICAgICAgICAgc3JjRXZlbnQuY3RybEtleSwgc3JjRXZlbnQuYWx0S2V5LCBzcmNFdmVudC5zaGlmdEtleSwgc3JjRXZlbnQubWV0YUtleSxcclxuICAgICAgICAgIHNyY0V2ZW50LmJ1dHRvbiwgc3JjRXZlbnQucmVsYXRlZFRhcmdldCB8fCBudWxsXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZXZlbnRPYmogPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnQ3VzdG9tRXZlbnQnKTtcclxuICAgICAgICBldmVudE9iai5pbml0Q3VzdG9tRXZlbnQoZXZlbnRUeXBlLCB0cnVlLCB0cnVlLCB7fSk7XHJcbiAgICAgIH1cclxuICAgICAgZXZlbnRPYmouJG1hdGVyaWFsID0gdHJ1ZTtcclxuICAgICAgZXZlbnRPYmoucG9pbnRlciA9IGV2ZW50UG9pbnRlcjtcclxuICAgICAgZXZlbnRPYmouc3JjRXZlbnQgPSBzcmNFdmVudDtcclxuICAgICAgZXZlbnRQb2ludGVyLnRhcmdldC5kaXNwYXRjaEV2ZW50KGV2ZW50T2JqKTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBBdHRhY2ggR2VzdHVyZXM6IGhvb2sgZG9jdW1lbnQgYW5kIGNoZWNrIHNob3VsZEhpamFjayBjbGlja3NcclxuICAgKiBAbmdJbmplY3RcclxuICAgKi9cclxuICBmdW5jdGlvbiBhdHRhY2hUb0RvY3VtZW50KCAkbWRHZXN0dXJlLCAkJE1kR2VzdHVyZUhhbmRsZXIgKSB7XHJcblxyXG4gICAgLy8gUG9seWZpbGwgZG9jdW1lbnQuY29udGFpbnMgZm9yIElFMTEuXHJcbiAgICAvLyBUT0RPOiBtb3ZlIHRvIHV0aWxcclxuICAgIGRvY3VtZW50LmNvbnRhaW5zIHx8IChkb2N1bWVudC5jb250YWlucyA9IGZ1bmN0aW9uIChub2RlKSB7XHJcbiAgICAgIHJldHVybiBkb2N1bWVudC5ib2R5LmNvbnRhaW5zKG5vZGUpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKCFpc0luaXRpYWxpemVkICYmICRtZEdlc3R1cmUuaXNIaWphY2tpbmdDbGlja3MgKSB7XHJcbiAgICAgIC8qXHJcbiAgICAgICAqIElmIGhpamFjayBjbGlja3MgaXMgdHJ1ZSwgd2UgcHJldmVudERlZmF1bHQgYW55IGNsaWNrIHRoYXQgd2Fzbid0XHJcbiAgICAgICAqIHNlbnQgYnkgbmdNYXRlcmlhbC4gVGhpcyBpcyBiZWNhdXNlIG9uIG9sZGVyIEFuZHJvaWQgJiBpT1MsIGEgZmFsc2UsIG9yICdnaG9zdCcsXHJcbiAgICAgICAqIGNsaWNrIGV2ZW50IHdpbGwgYmUgc2VudCB+NDAwbXMgYWZ0ZXIgYSB0b3VjaGVuZCBldmVudCBoYXBwZW5zLlxyXG4gICAgICAgKiBUaGUgb25seSB3YXkgdG8ga25vdyBpZiB0aGlzIGNsaWNrIGlzIHJlYWwgaXMgdG8gcHJldmVudCBhbnkgbm9ybWFsXHJcbiAgICAgICAqIGNsaWNrIGV2ZW50cywgYW5kIGFkZCBhIGZsYWcgdG8gZXZlbnRzIHNlbnQgYnkgbWF0ZXJpYWwgc28gd2Uga25vdyBub3QgdG8gcHJldmVudCB0aG9zZS5cclxuICAgICAgICogXHJcbiAgICAgICAqIFR3byBleGNlcHRpb25zIHRvIGNsaWNrIGV2ZW50cyB0aGF0IHNob3VsZCBiZSBwcmV2ZW50ZWQgYXJlOlxyXG4gICAgICAgKiAgLSBjbGljayBldmVudHMgc2VudCBieSB0aGUga2V5Ym9hcmQgKGVnIGZvcm0gc3VibWl0KVxyXG4gICAgICAgKiAgLSBldmVudHMgdGhhdCBvcmlnaW5hdGUgZnJvbSBhbiBJb25pYyBhcHBcclxuICAgICAgICovXHJcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gY2xpY2tIaWphY2tlcihldikge1xyXG4gICAgICAgIHZhciBpc0tleUNsaWNrID0gZXYuY2xpZW50WCA9PT0gMCAmJiBldi5jbGllbnRZID09PSAwO1xyXG4gICAgICAgIGlmICghaXNLZXlDbGljayAmJiAhZXYuJG1hdGVyaWFsICYmICFldi5pc0lvbmljVGFwKSB7XHJcbiAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LCB0cnVlKTtcclxuICAgICAgXHJcbiAgICAgIGlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIExpc3RlbiB0byBhbGwgZXZlbnRzIHRvIGNvdmVyIGFsbCBwbGF0Zm9ybXMuXHJcbiAgICB2YXIgU1RBUlRfRVZFTlRTID0gJ21vdXNlZG93biB0b3VjaHN0YXJ0IHBvaW50ZXJkb3duJztcclxuICAgIHZhciBNT1ZFX0VWRU5UUyA9ICdtb3VzZW1vdmUgdG91Y2htb3ZlIHBvaW50ZXJtb3ZlJztcclxuICAgIHZhciBFTkRfRVZFTlRTID0gJ21vdXNldXAgbW91c2VsZWF2ZSB0b3VjaGVuZCB0b3VjaGNhbmNlbCBwb2ludGVydXAgcG9pbnRlcmNhbmNlbCc7XHJcblxyXG4gICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KVxyXG4gICAgICAub24oU1RBUlRfRVZFTlRTLCBnZXN0dXJlU3RhcnQpXHJcbiAgICAgIC5vbihNT1ZFX0VWRU5UUywgZ2VzdHVyZU1vdmUpXHJcbiAgICAgIC5vbihFTkRfRVZFTlRTLCBnZXN0dXJlRW5kKVxyXG4gICAgICAvLyBGb3IgdGVzdGluZ1xyXG4gICAgICAub24oJyQkbWRHZXN0dXJlUmVzZXQnLCBmdW5jdGlvbiBnZXN0dXJlQ2xlYXJDYWNoZSAoKSB7XHJcbiAgICAgICAgbGFzdFBvaW50ZXIgPSBwb2ludGVyID0gbnVsbDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgLypcclxuICAgICAqIFdoZW4gYSBET00gZXZlbnQgaGFwcGVucywgcnVuIGFsbCByZWdpc3RlcmVkIGdlc3R1cmUgaGFuZGxlcnMnIGxpZmVjeWNsZVxyXG4gICAgICogbWV0aG9kcyB3aGljaCBtYXRjaCB0aGUgRE9NIGV2ZW50LlxyXG4gICAgICogRWcgd2hlbiBhICd0b3VjaHN0YXJ0JyBldmVudCBoYXBwZW5zLCBydW5IYW5kbGVycygnc3RhcnQnKSB3aWxsIGNhbGwgYW5kXHJcbiAgICAgKiBydW4gYGhhbmRsZXIuY2FuY2VsKClgIGFuZCBgaGFuZGxlci5zdGFydCgpYCBvbiBhbGwgcmVnaXN0ZXJlZCBoYW5kbGVycy5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gcnVuSGFuZGxlcnMoaGFuZGxlckV2ZW50LCBldmVudCkge1xyXG4gICAgICB2YXIgaGFuZGxlcjtcclxuICAgICAgZm9yICh2YXIgbmFtZSBpbiBIQU5ETEVSUykge1xyXG4gICAgICAgIGhhbmRsZXIgPSBIQU5ETEVSU1tuYW1lXTtcclxuICAgICAgICBpZiggaGFuZGxlciBpbnN0YW5jZW9mICQkTWRHZXN0dXJlSGFuZGxlciApIHtcclxuXHJcbiAgICAgICAgICBpZiAoaGFuZGxlckV2ZW50ID09PSAnc3RhcnQnKSB7XHJcbiAgICAgICAgICAgIC8vIFJ1biBjYW5jZWwgdG8gcmVzZXQgYW55IGhhbmRsZXJzJyBzdGF0ZVxyXG4gICAgICAgICAgICBoYW5kbGVyLmNhbmNlbCgpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaGFuZGxlcltoYW5kbGVyRXZlbnRdKGV2ZW50LCBwb2ludGVyKTtcclxuXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLypcclxuICAgICAqIGdlc3R1cmVTdGFydCB2ZXRzIGlmIGEgc3RhcnQgZXZlbnQgaXMgbGVnaXRpbWF0ZSAoYW5kIG5vdCBwYXJ0IG9mIGEgJ2dob3N0IGNsaWNrJyBmcm9tIGlPUy9BbmRyb2lkKVxyXG4gICAgICogSWYgaXQgaXMgbGVnaXRpbWF0ZSwgd2UgaW5pdGlhdGUgdGhlIHBvaW50ZXIgc3RhdGUgYW5kIG1hcmsgdGhlIGN1cnJlbnQgcG9pbnRlcidzIHR5cGVcclxuICAgICAqIEZvciBleGFtcGxlLCBmb3IgYSB0b3VjaHN0YXJ0IGV2ZW50LCBtYXJrIHRoZSBjdXJyZW50IHBvaW50ZXIgYXMgYSAndG91Y2gnIHBvaW50ZXIsIHNvIG1vdXNlIGV2ZW50c1xyXG4gICAgICogd29uJ3QgZWZmZWN0IGl0LlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBnZXN0dXJlU3RhcnQoZXYpIHtcclxuICAgICAgLy8gSWYgd2UncmUgYWxyZWFkeSB0b3VjaGVkIGRvd24sIGFib3J0XHJcbiAgICAgIGlmIChwb2ludGVyKSByZXR1cm47XHJcblxyXG4gICAgICB2YXIgbm93ID0gK0RhdGUubm93KCk7XHJcblxyXG4gICAgICAvLyBpT1MgJiBvbGQgYW5kcm9pZCBidWc6IGFmdGVyIGEgdG91Y2ggZXZlbnQsIGEgY2xpY2sgZXZlbnQgaXMgc2VudCAzNTAgbXMgbGF0ZXIuXHJcbiAgICAgIC8vIElmIDw0MDBtcyBoYXZlIHBhc3NlZCwgZG9uJ3QgYWxsb3cgYW4gZXZlbnQgb2YgYSBkaWZmZXJlbnQgdHlwZSB0aGFuIHRoZSBwcmV2aW91cyBldmVudFxyXG4gICAgICBpZiAobGFzdFBvaW50ZXIgJiYgIXR5cGVzTWF0Y2goZXYsIGxhc3RQb2ludGVyKSAmJiAobm93IC0gbGFzdFBvaW50ZXIuZW5kVGltZSA8IDE1MDApKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBwb2ludGVyID0gbWFrZVN0YXJ0UG9pbnRlcihldik7XHJcblxyXG4gICAgICBydW5IYW5kbGVycygnc3RhcnQnLCBldik7XHJcbiAgICB9XHJcbiAgICAvKlxyXG4gICAgICogSWYgYSBtb3ZlIGV2ZW50IGhhcHBlbnMgb2YgdGhlIHJpZ2h0IHR5cGUsIHVwZGF0ZSB0aGUgcG9pbnRlciBhbmQgcnVuIGFsbCB0aGUgbW92ZSBoYW5kbGVycy5cclxuICAgICAqIFwib2YgdGhlIHJpZ2h0IHR5cGVcIjogaWYgYSBtb3VzZW1vdmUgaGFwcGVucyBidXQgb3VyIHBvaW50ZXIgc3RhcnRlZCB3aXRoIGEgdG91Y2ggZXZlbnQsIGRvIG5vdGhpbmcuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGdlc3R1cmVNb3ZlKGV2KSB7XHJcbiAgICAgIGlmICghcG9pbnRlciB8fCAhdHlwZXNNYXRjaChldiwgcG9pbnRlcikpIHJldHVybjtcclxuXHJcbiAgICAgIHVwZGF0ZVBvaW50ZXJTdGF0ZShldiwgcG9pbnRlcik7XHJcbiAgICAgIHJ1bkhhbmRsZXJzKCdtb3ZlJywgZXYpO1xyXG4gICAgfVxyXG4gICAgLypcclxuICAgICAqIElmIGFuIGVuZCBldmVudCBoYXBwZW5zIG9mIHRoZSByaWdodCB0eXBlLCB1cGRhdGUgdGhlIHBvaW50ZXIsIHJ1biBlbmRIYW5kbGVycywgYW5kIHNhdmUgdGhlIHBvaW50ZXIgYXMgJ2xhc3RQb2ludGVyJ1xyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBnZXN0dXJlRW5kKGV2KSB7XHJcbiAgICAgIGlmICghcG9pbnRlciB8fCAhdHlwZXNNYXRjaChldiwgcG9pbnRlcikpIHJldHVybjtcclxuXHJcbiAgICAgIHVwZGF0ZVBvaW50ZXJTdGF0ZShldiwgcG9pbnRlcik7XHJcbiAgICAgIHBvaW50ZXIuZW5kVGltZSA9ICtEYXRlLm5vdygpO1xyXG5cclxuICAgICAgcnVuSGFuZGxlcnMoJ2VuZCcsIGV2KTtcclxuXHJcbiAgICAgIGxhc3RQb2ludGVyID0gcG9pbnRlcjtcclxuICAgICAgcG9pbnRlciA9IG51bGw7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuICBhdHRhY2hUb0RvY3VtZW50LiRpbmplY3QgPSBbXCIkbWRHZXN0dXJlXCIsIFwiJCRNZEdlc3R1cmVIYW5kbGVyXCJdO1xyXG5cclxuICAvLyAqKioqKioqKioqKioqKioqKioqKlxyXG4gIC8vIE1vZHVsZSBGdW5jdGlvbnNcclxuICAvLyAqKioqKioqKioqKioqKioqKioqKlxyXG5cclxuICAvKlxyXG4gICAqIEluaXRpYXRlIHRoZSBwb2ludGVyLiB4LCB5LCBhbmQgdGhlIHBvaW50ZXIncyB0eXBlLlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIG1ha2VTdGFydFBvaW50ZXIoZXYpIHtcclxuICAgIHZhciBwb2ludCA9IGdldEV2ZW50UG9pbnQoZXYpO1xyXG4gICAgdmFyIHN0YXJ0UG9pbnRlciA9IHtcclxuICAgICAgc3RhcnRUaW1lOiArRGF0ZS5ub3coKSxcclxuICAgICAgdGFyZ2V0OiBldi50YXJnZXQsXHJcbiAgICAgIC8vICdwJyBmb3IgcG9pbnRlciBldmVudHMsICdtJyBmb3IgbW91c2UsICd0JyBmb3IgdG91Y2hcclxuICAgICAgdHlwZTogZXYudHlwZS5jaGFyQXQoMClcclxuICAgIH07XHJcbiAgICBzdGFydFBvaW50ZXIuc3RhcnRYID0gc3RhcnRQb2ludGVyLnggPSBwb2ludC5wYWdlWDtcclxuICAgIHN0YXJ0UG9pbnRlci5zdGFydFkgPSBzdGFydFBvaW50ZXIueSA9IHBvaW50LnBhZ2VZO1xyXG4gICAgcmV0dXJuIHN0YXJ0UG9pbnRlcjtcclxuICB9XHJcblxyXG4gIC8qXHJcbiAgICogcmV0dXJuIHdoZXRoZXIgdGhlIHBvaW50ZXIncyB0eXBlIG1hdGNoZXMgdGhlIGV2ZW50J3MgdHlwZS5cclxuICAgKiBFZyBpZiBhIHRvdWNoIGV2ZW50IGhhcHBlbnMgYnV0IHRoZSBwb2ludGVyIGhhcyBhIG1vdXNlIHR5cGUsIHJldHVybiBmYWxzZS5cclxuICAgKi9cclxuICBmdW5jdGlvbiB0eXBlc01hdGNoKGV2LCBwb2ludGVyKSB7XHJcbiAgICByZXR1cm4gZXYgJiYgcG9pbnRlciAmJiBldi50eXBlLmNoYXJBdCgwKSA9PT0gcG9pbnRlci50eXBlO1xyXG4gIH1cclxuXHJcbiAgLypcclxuICAgKiBVcGRhdGUgdGhlIGdpdmVuIHBvaW50ZXIgYmFzZWQgdXBvbiB0aGUgZ2l2ZW4gRE9NRXZlbnQuXHJcbiAgICogRGlzdGFuY2UsIHZlbG9jaXR5LCBkaXJlY3Rpb24sIGR1cmF0aW9uLCBldGNcclxuICAgKi9cclxuICBmdW5jdGlvbiB1cGRhdGVQb2ludGVyU3RhdGUoZXYsIHBvaW50ZXIpIHtcclxuICAgIHZhciBwb2ludCA9IGdldEV2ZW50UG9pbnQoZXYpO1xyXG4gICAgdmFyIHggPSBwb2ludGVyLnggPSBwb2ludC5wYWdlWDtcclxuICAgIHZhciB5ID0gcG9pbnRlci55ID0gcG9pbnQucGFnZVk7XHJcblxyXG4gICAgcG9pbnRlci5kaXN0YW5jZVggPSB4IC0gcG9pbnRlci5zdGFydFg7XHJcbiAgICBwb2ludGVyLmRpc3RhbmNlWSA9IHkgLSBwb2ludGVyLnN0YXJ0WTtcclxuICAgIHBvaW50ZXIuZGlzdGFuY2UgPSBNYXRoLnNxcnQoXHJcbiAgICAgIHBvaW50ZXIuZGlzdGFuY2VYICogcG9pbnRlci5kaXN0YW5jZVggKyBwb2ludGVyLmRpc3RhbmNlWSAqIHBvaW50ZXIuZGlzdGFuY2VZXHJcbiAgICApO1xyXG5cclxuICAgIHBvaW50ZXIuZGlyZWN0aW9uWCA9IHBvaW50ZXIuZGlzdGFuY2VYID4gMCA/ICdyaWdodCcgOiBwb2ludGVyLmRpc3RhbmNlWCA8IDAgPyAnbGVmdCcgOiAnJztcclxuICAgIHBvaW50ZXIuZGlyZWN0aW9uWSA9IHBvaW50ZXIuZGlzdGFuY2VZID4gMCA/ICd1cCcgOiBwb2ludGVyLmRpc3RhbmNlWSA8IDAgPyAnZG93bicgOiAnJztcclxuXHJcbiAgICBwb2ludGVyLmR1cmF0aW9uID0gK0RhdGUubm93KCkgLSBwb2ludGVyLnN0YXJ0VGltZTtcclxuICAgIHBvaW50ZXIudmVsb2NpdHlYID0gcG9pbnRlci5kaXN0YW5jZVggLyBwb2ludGVyLmR1cmF0aW9uO1xyXG4gICAgcG9pbnRlci52ZWxvY2l0eVkgPSBwb2ludGVyLmRpc3RhbmNlWSAvIHBvaW50ZXIuZHVyYXRpb247XHJcbiAgfVxyXG5cclxuICAvKlxyXG4gICAqIE5vcm1hbGl6ZSB0aGUgcG9pbnQgd2hlcmUgdGhlIERPTSBldmVudCBoYXBwZW5lZCB3aGV0aGVyIGl0J3MgdG91Y2ggb3IgbW91c2UuXHJcbiAgICogQHJldHVybnMgcG9pbnQgZXZlbnQgb2JqIHdpdGggcGFnZVggYW5kIHBhZ2VZIG9uIGl0LlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGdldEV2ZW50UG9pbnQoZXYpIHtcclxuICAgIGV2ID0gZXYub3JpZ2luYWxFdmVudCB8fCBldjsgLy8gc3VwcG9ydCBqUXVlcnkgZXZlbnRzXHJcbiAgICByZXR1cm4gKGV2LnRvdWNoZXMgJiYgZXYudG91Y2hlc1swXSkgfHxcclxuICAgICAgKGV2LmNoYW5nZWRUb3VjaGVzICYmIGV2LmNoYW5nZWRUb3VjaGVzWzBdKSB8fFxyXG4gICAgICBldjtcclxuICB9XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29yZScpXHJcbiAgLnByb3ZpZGVyKCckJGludGVyaW1FbGVtZW50JywgSW50ZXJpbUVsZW1lbnRQcm92aWRlcik7XHJcblxyXG4vKlxyXG4gKiBAbmdkb2Mgc2VydmljZVxyXG4gKiBAbmFtZSAkJGludGVyaW1FbGVtZW50XHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29yZVxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICpcclxuICogRmFjdG9yeSB0aGF0IGNvbnRydWN0cyBgJCRpbnRlcmltRWxlbWVudC4kc2VydmljZWAgc2VydmljZXMuXHJcbiAqIFVzZWQgaW50ZXJuYWxseSBpbiBtYXRlcmlhbCBkZXNpZ24gZm9yIGVsZW1lbnRzIHRoYXQgYXBwZWFyIG9uIHNjcmVlbiB0ZW1wb3JhcmlseS5cclxuICogVGhlIHNlcnZpY2UgcHJvdmlkZXMgYSBwcm9taXNlLWxpa2UgQVBJIGZvciBpbnRlcmFjdGluZyB3aXRoIHRoZSB0ZW1wb3JhcnlcclxuICogZWxlbWVudHMuXHJcbiAqXHJcbiAqIGBgYGpzXHJcbiAqIGFwcC5zZXJ2aWNlKCckbWRUb2FzdCcsIGZ1bmN0aW9uKCQkaW50ZXJpbUVsZW1lbnQpIHtcclxuICogICB2YXIgJG1kVG9hc3QgPSAkJGludGVyaW1FbGVtZW50KHRvYXN0RGVmYXVsdE9wdGlvbnMpO1xyXG4gKiAgIHJldHVybiAkbWRUb2FzdDtcclxuICogfSk7XHJcbiAqIGBgYFxyXG4gKiBAcGFyYW0ge29iamVjdD19IGRlZmF1bHRPcHRpb25zIE9wdGlvbnMgdXNlZCBieSBkZWZhdWx0IGZvciB0aGUgYHNob3dgIG1ldGhvZCBvbiB0aGUgc2VydmljZS5cclxuICpcclxuICogQHJldHVybnMgeyQkaW50ZXJpbUVsZW1lbnQuJHNlcnZpY2V9XHJcbiAqXHJcbiAqL1xyXG5cclxuZnVuY3Rpb24gSW50ZXJpbUVsZW1lbnRQcm92aWRlcigpIHtcclxuICBjcmVhdGVJbnRlcmltRWxlbWVudFByb3ZpZGVyLiRnZXQgPSBJbnRlcmltRWxlbWVudEZhY3Rvcnk7XHJcbiAgSW50ZXJpbUVsZW1lbnRGYWN0b3J5LiRpbmplY3QgPSBbXCIkZG9jdW1lbnRcIiwgXCIkcVwiLCBcIiRyb290U2NvcGVcIiwgXCIkdGltZW91dFwiLCBcIiRyb290RWxlbWVudFwiLCBcIiRhbmltYXRlXCIsIFwiJGludGVycG9sYXRlXCIsIFwiJG1kQ29tcGlsZXJcIiwgXCIkbWRUaGVtaW5nXCJdO1xyXG4gIHJldHVybiBjcmVhdGVJbnRlcmltRWxlbWVudFByb3ZpZGVyO1xyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIGEgbmV3IHByb3ZpZGVyIHdoaWNoIGFsbG93cyBjb25maWd1cmF0aW9uIG9mIGEgbmV3IGludGVyaW1FbGVtZW50XHJcbiAgICogc2VydmljZS4gQWxsb3dzIGNvbmZpZ3VyYXRpb24gb2YgZGVmYXVsdCBvcHRpb25zICYgbWV0aG9kcyBmb3Igb3B0aW9ucyxcclxuICAgKiBhcyB3ZWxsIGFzIGNvbmZpZ3VyYXRpb24gb2YgJ3ByZXNldCcgbWV0aG9kcyAoZWcgZGlhbG9nLmJhc2ljKCk6IGJhc2ljIGlzIGEgcHJlc2V0IG1ldGhvZClcclxuICAgKi9cclxuICBmdW5jdGlvbiBjcmVhdGVJbnRlcmltRWxlbWVudFByb3ZpZGVyKGludGVyaW1GYWN0b3J5TmFtZSkge1xyXG4gICAgdmFyIEVYUE9TRURfTUVUSE9EUyA9IFsnb25IaWRlJywgJ29uU2hvdycsICdvblJlbW92ZSddO1xyXG5cclxuICAgIHZhciBjdXN0b21NZXRob2RzID0ge307XHJcbiAgICB2YXIgcHJvdmlkZXJDb25maWcgPSB7XHJcbiAgICAgIHByZXNldHM6IHt9XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBwcm92aWRlciA9IHtcclxuICAgICAgc2V0RGVmYXVsdHM6IHNldERlZmF1bHRzLFxyXG4gICAgICBhZGRQcmVzZXQ6IGFkZFByZXNldCxcclxuICAgICAgYWRkTWV0aG9kOiBhZGRNZXRob2QsXHJcbiAgICAgICRnZXQ6IGZhY3RvcnlcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBhbGwgaW50ZXJpbSBlbGVtZW50cyB3aWxsIGNvbWUgd2l0aCB0aGUgJ2J1aWxkJyBwcmVzZXRcclxuICAgICAqL1xyXG4gICAgcHJvdmlkZXIuYWRkUHJlc2V0KCdidWlsZCcsIHtcclxuICAgICAgbWV0aG9kczogWydjb250cm9sbGVyJywgJ2NvbnRyb2xsZXJBcycsICdyZXNvbHZlJyxcclxuICAgICAgICAndGVtcGxhdGUnLCAndGVtcGxhdGVVcmwnLCAndGhlbWFibGUnLCAndHJhbnNmb3JtVGVtcGxhdGUnLCAncGFyZW50J11cclxuICAgIH0pO1xyXG5cclxuICAgIGZhY3RvcnkuJGluamVjdCA9IFtcIiQkaW50ZXJpbUVsZW1lbnRcIiwgXCIkYW5pbWF0ZVwiLCBcIiRpbmplY3RvclwiXTtcclxuICAgIHJldHVybiBwcm92aWRlcjtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFNhdmUgdGhlIGNvbmZpZ3VyZWQgZGVmYXVsdHMgdG8gYmUgdXNlZCB3aGVuIHRoZSBmYWN0b3J5IGlzIGluc3RhbnRpYXRlZFxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBzZXREZWZhdWx0cyhkZWZpbml0aW9uKSB7XHJcbiAgICAgIHByb3ZpZGVyQ29uZmlnLm9wdGlvbnNGYWN0b3J5ID0gZGVmaW5pdGlvbi5vcHRpb25zO1xyXG4gICAgICBwcm92aWRlckNvbmZpZy5tZXRob2RzID0gKGRlZmluaXRpb24ubWV0aG9kcyB8fCBbXSkuY29uY2F0KEVYUE9TRURfTUVUSE9EUyk7XHJcbiAgICAgIHJldHVybiBwcm92aWRlcjtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEFkZCBhIG1ldGhvZCB0byB0aGUgZmFjdG9yeSB0aGF0IGlzbid0IHNwZWNpZmljIHRvIGFueSBpbnRlcmltIGVsZW1lbnQgb3BlcmF0aW9uc1xyXG4gICAgICovXHJcblxyXG4gICAgZnVuY3Rpb24gYWRkTWV0aG9kKG5hbWUsIGZuKSB7XHJcbiAgICAgIGN1c3RvbU1ldGhvZHNbbmFtZV0gPSBmbjtcclxuICAgICAgcmV0dXJuIHByb3ZpZGVyO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU2F2ZSB0aGUgY29uZmlndXJlZCBwcmVzZXQgdG8gYmUgdXNlZCB3aGVuIHRoZSBmYWN0b3J5IGlzIGluc3RhbnRpYXRlZFxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBhZGRQcmVzZXQobmFtZSwgZGVmaW5pdGlvbikge1xyXG4gICAgICBkZWZpbml0aW9uID0gZGVmaW5pdGlvbiB8fCB7fTtcclxuICAgICAgZGVmaW5pdGlvbi5tZXRob2RzID0gZGVmaW5pdGlvbi5tZXRob2RzIHx8IFtdO1xyXG4gICAgICBkZWZpbml0aW9uLm9wdGlvbnMgPSBkZWZpbml0aW9uLm9wdGlvbnMgfHwgZnVuY3Rpb24oKSB7IHJldHVybiB7fTsgfTtcclxuXHJcbiAgICAgIGlmICgvXmNhbmNlbHxoaWRlfHNob3ckLy50ZXN0KG5hbWUpKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUHJlc2V0ICdcIiArIG5hbWUgKyBcIicgaW4gXCIgKyBpbnRlcmltRmFjdG9yeU5hbWUgKyBcIiBpcyByZXNlcnZlZCFcIik7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGRlZmluaXRpb24ubWV0aG9kcy5pbmRleE9mKCdfb3B0aW9ucycpID4gLTEpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJNZXRob2QgJ19vcHRpb25zJyBpbiBcIiArIGludGVyaW1GYWN0b3J5TmFtZSArIFwiIGlzIHJlc2VydmVkIVwiKTtcclxuICAgICAgfVxyXG4gICAgICBwcm92aWRlckNvbmZpZy5wcmVzZXRzW25hbWVdID0ge1xyXG4gICAgICAgIG1ldGhvZHM6IGRlZmluaXRpb24ubWV0aG9kcy5jb25jYXQoRVhQT1NFRF9NRVRIT0RTKSxcclxuICAgICAgICBvcHRpb25zRmFjdG9yeTogZGVmaW5pdGlvbi5vcHRpb25zLFxyXG4gICAgICAgIGFyZ09wdGlvbjogZGVmaW5pdGlvbi5hcmdPcHRpb25cclxuICAgICAgfTtcclxuICAgICAgcmV0dXJuIHByb3ZpZGVyO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlIGEgZmFjdG9yeSB0aGF0IGhhcyB0aGUgZ2l2ZW4gbWV0aG9kcyAmIGRlZmF1bHRzIGltcGxlbWVudGluZyBpbnRlcmltRWxlbWVudFxyXG4gICAgICovXHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIGZhY3RvcnkoJCRpbnRlcmltRWxlbWVudCwgJGFuaW1hdGUsICRpbmplY3Rvcikge1xyXG4gICAgICB2YXIgZGVmYXVsdE1ldGhvZHM7XHJcbiAgICAgIHZhciBkZWZhdWx0T3B0aW9ucztcclxuICAgICAgdmFyIGludGVyaW1FbGVtZW50U2VydmljZSA9ICQkaW50ZXJpbUVsZW1lbnQoKTtcclxuXHJcbiAgICAgIC8qXHJcbiAgICAgICAqIHB1YmxpY1NlcnZpY2UgaXMgd2hhdCB0aGUgZGV2ZWxvcGVyIHdpbGwgYmUgdXNpbmcuXHJcbiAgICAgICAqIEl0IGhhcyBtZXRob2RzIGhpZGUoKSwgY2FuY2VsKCksIHNob3coKSwgYnVpbGQoKSwgYW5kIGFueSBvdGhlclxyXG4gICAgICAgKiBwcmVzZXRzIHdoaWNoIHdlcmUgc2V0IGR1cmluZyB0aGUgY29uZmlnIHBoYXNlLlxyXG4gICAgICAgKi9cclxuICAgICAgdmFyIHB1YmxpY1NlcnZpY2UgPSB7XHJcbiAgICAgICAgaGlkZTogaW50ZXJpbUVsZW1lbnRTZXJ2aWNlLmhpZGUsXHJcbiAgICAgICAgY2FuY2VsOiBpbnRlcmltRWxlbWVudFNlcnZpY2UuY2FuY2VsLFxyXG4gICAgICAgIHNob3c6IHNob3dJbnRlcmltRWxlbWVudFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgZGVmYXVsdE1ldGhvZHMgPSBwcm92aWRlckNvbmZpZy5tZXRob2RzIHx8IFtdO1xyXG4gICAgICAvLyBUaGlzIG11c3QgYmUgaW52b2tlZCBhZnRlciB0aGUgcHVibGljU2VydmljZSBpcyBpbml0aWFsaXplZFxyXG4gICAgICBkZWZhdWx0T3B0aW9ucyA9IGludm9rZUZhY3RvcnkocHJvdmlkZXJDb25maWcub3B0aW9uc0ZhY3RvcnksIHt9KTtcclxuXHJcbiAgICAgIC8vIENvcHkgb3ZlciB0aGUgc2ltcGxlIGN1c3RvbSBtZXRob2RzXHJcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChjdXN0b21NZXRob2RzLCBmdW5jdGlvbihmbiwgbmFtZSkge1xyXG4gICAgICAgIHB1YmxpY1NlcnZpY2VbbmFtZV0gPSBmbjtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBhbmd1bGFyLmZvckVhY2gocHJvdmlkZXJDb25maWcucHJlc2V0cywgZnVuY3Rpb24oZGVmaW5pdGlvbiwgbmFtZSkge1xyXG4gICAgICAgIHZhciBwcmVzZXREZWZhdWx0cyA9IGludm9rZUZhY3RvcnkoZGVmaW5pdGlvbi5vcHRpb25zRmFjdG9yeSwge30pO1xyXG4gICAgICAgIHZhciBwcmVzZXRNZXRob2RzID0gKGRlZmluaXRpb24ubWV0aG9kcyB8fCBbXSkuY29uY2F0KGRlZmF1bHRNZXRob2RzKTtcclxuXHJcbiAgICAgICAgLy8gRXZlcnkgaW50ZXJpbUVsZW1lbnQgYnVpbHQgd2l0aCBhIHByZXNldCBoYXMgYSBmaWVsZCBjYWxsZWQgYCR0eXBlYCxcclxuICAgICAgICAvLyB3aGljaCBtYXRjaGVzIHRoZSBuYW1lIG9mIHRoZSBwcmVzZXQuXHJcbiAgICAgICAgLy8gRWcgaW4gcHJlc2V0ICdjb25maXJtJywgb3B0aW9ucy4kdHlwZSA9PT0gJ2NvbmZpcm0nXHJcbiAgICAgICAgYW5ndWxhci5leHRlbmQocHJlc2V0RGVmYXVsdHMsIHsgJHR5cGU6IG5hbWUgfSk7XHJcblxyXG4gICAgICAgIC8vIFRoaXMgY3JlYXRlcyBhIHByZXNldCBjbGFzcyB3aGljaCBoYXMgc2V0dGVyIG1ldGhvZHMgZm9yIGV2ZXJ5XHJcbiAgICAgICAgLy8gbWV0aG9kIGdpdmVuIGluIHRoZSBgLmFkZFByZXNldCgpYCBmdW5jdGlvbiwgYXMgd2VsbCBhcyBldmVyeVxyXG4gICAgICAgIC8vIG1ldGhvZCBnaXZlbiBpbiB0aGUgYC5zZXREZWZhdWx0cygpYCBmdW5jdGlvbi5cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vIEBleGFtcGxlXHJcbiAgICAgICAgLy8gLnNldERlZmF1bHRzKHtcclxuICAgICAgICAvLyAgIG1ldGhvZHM6IFsnaGFzQmFja2Ryb3AnLCAnY2xpY2tPdXRzaWRlVG9DbG9zZScsICdlc2NhcGVUb0Nsb3NlJywgJ3RhcmdldEV2ZW50J10sXHJcbiAgICAgICAgLy8gICBvcHRpb25zOiBkaWFsb2dEZWZhdWx0T3B0aW9uc1xyXG4gICAgICAgIC8vIH0pXHJcbiAgICAgICAgLy8gLmFkZFByZXNldCgnYWxlcnQnLCB7XHJcbiAgICAgICAgLy8gICBtZXRob2RzOiBbJ3RpdGxlJywgJ29rJ10sXHJcbiAgICAgICAgLy8gICBvcHRpb25zOiBhbGVydERpYWxvZ09wdGlvbnNcclxuICAgICAgICAvLyB9KVxyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gU2V0IHZhbHVlcyB3aWxsIGJlIHBhc3NlZCB0byB0aGUgb3B0aW9ucyB3aGVuIGludGVyaW1FbGVtbnQuc2hvdygpIGlzIGNhbGxlZC5cclxuICAgICAgICBmdW5jdGlvbiBQcmVzZXQob3B0cykge1xyXG4gICAgICAgICAgdGhpcy5fb3B0aW9ucyA9IGFuZ3VsYXIuZXh0ZW5kKHt9LCBwcmVzZXREZWZhdWx0cywgb3B0cyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGFuZ3VsYXIuZm9yRWFjaChwcmVzZXRNZXRob2RzLCBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgICBQcmVzZXQucHJvdG90eXBlW25hbWVdID0gZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5fb3B0aW9uc1tuYW1lXSA9IHZhbHVlO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIENyZWF0ZSBzaG9ydGN1dCBtZXRob2QgZm9yIG9uZS1saW5lYXIgbWV0aG9kc1xyXG4gICAgICAgIGlmIChkZWZpbml0aW9uLmFyZ09wdGlvbikge1xyXG4gICAgICAgICAgdmFyIG1ldGhvZE5hbWUgPSAnc2hvdycgKyBuYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmFtZS5zbGljZSgxKTtcclxuICAgICAgICAgIHB1YmxpY1NlcnZpY2VbbWV0aG9kTmFtZV0gPSBmdW5jdGlvbihhcmcpIHtcclxuICAgICAgICAgICAgdmFyIGNvbmZpZyA9IHB1YmxpY1NlcnZpY2VbbmFtZV0oYXJnKTtcclxuICAgICAgICAgICAgcmV0dXJuIHB1YmxpY1NlcnZpY2Uuc2hvdyhjb25maWcpO1xyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGVnICRtZERpYWxvZy5hbGVydCgpIHdpbGwgcmV0dXJuIGEgbmV3IGFsZXJ0IHByZXNldFxyXG4gICAgICAgIHB1YmxpY1NlcnZpY2VbbmFtZV0gPSBmdW5jdGlvbihhcmcpIHtcclxuICAgICAgICAgIC8vIElmIGFyZ09wdGlvbiBpcyBzdXBwbGllZCwgZWcgYGFyZ09wdGlvbjogJ2NvbnRlbnQnYCwgdGhlbiB3ZSBhc3N1bWVcclxuICAgICAgICAgIC8vIGlmIHRoZSBhcmd1bWVudCBpcyBub3QgYW4gb3B0aW9ucyBvYmplY3QgdGhlbiBpdCBpcyB0aGUgYGFyZ09wdGlvbmAgb3B0aW9uLlxyXG4gICAgICAgICAgLy9cclxuICAgICAgICAgIC8vIEBleGFtcGxlIGAkbWRUb2FzdC5zaW1wbGUoJ2hlbGxvJylgIC8vIHNldHMgb3B0aW9ucy5jb250ZW50IHRvIGhlbGxvXHJcbiAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBiZWNhdXNlIGFyZ09wdGlvbiA9PT0gJ2NvbnRlbnQnXHJcbiAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCAmJiBkZWZpbml0aW9uLmFyZ09wdGlvbiAmJiAhYW5ndWxhci5pc09iamVjdChhcmcpICYmXHJcbiAgICAgICAgICAgICAgIWFuZ3VsYXIuaXNBcnJheShhcmcpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAobmV3IFByZXNldCgpKVtkZWZpbml0aW9uLmFyZ09wdGlvbl0oYXJnKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJlc2V0KGFyZyk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH07XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHB1YmxpY1NlcnZpY2U7XHJcblxyXG4gICAgICBmdW5jdGlvbiBzaG93SW50ZXJpbUVsZW1lbnQob3B0cykge1xyXG4gICAgICAgIC8vIG9wdHMgaXMgZWl0aGVyIGEgcHJlc2V0IHdoaWNoIHN0b3JlcyBpdHMgb3B0aW9ucyBvbiBhbiBfb3B0aW9ucyBmaWVsZCxcclxuICAgICAgICAvLyBvciBqdXN0IGFuIG9iamVjdCBtYWRlIHVwIG9mIG9wdGlvbnNcclxuICAgICAgICBpZiAob3B0cyAmJiBvcHRzLl9vcHRpb25zKSBvcHRzID0gb3B0cy5fb3B0aW9ucztcclxuICAgICAgICByZXR1cm4gaW50ZXJpbUVsZW1lbnRTZXJ2aWNlLnNob3coXHJcbiAgICAgICAgICBhbmd1bGFyLmV4dGVuZCh7fSwgZGVmYXVsdE9wdGlvbnMsIG9wdHMpXHJcbiAgICAgICAgKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLyoqXHJcbiAgICAgICAqIEhlbHBlciB0byBjYWxsICRpbmplY3Rvci5pbnZva2Ugd2l0aCBhIGxvY2FsIG9mIHRoZSBmYWN0b3J5IG5hbWUgZm9yXHJcbiAgICAgICAqIHRoaXMgcHJvdmlkZXIuXHJcbiAgICAgICAqIElmIGFuICRtZERpYWxvZyBpcyBwcm92aWRpbmcgb3B0aW9ucyBmb3IgYSBkaWFsb2cgYW5kIHRyaWVzIHRvIGluamVjdFxyXG4gICAgICAgKiAkbWREaWFsb2csIGEgY2lyY3VsYXIgZGVwZW5kZW5jeSBlcnJvciB3aWxsIGhhcHBlbi5cclxuICAgICAgICogV2UgZ2V0IGFyb3VuZCB0aGF0IGJ5IG1hbnVhbGx5IGluamVjdGluZyAkbWREaWFsb2cgYXMgYSBsb2NhbC5cclxuICAgICAgICovXHJcbiAgICAgIGZ1bmN0aW9uIGludm9rZUZhY3RvcnkoZmFjdG9yeSwgZGVmYXVsdFZhbCkge1xyXG4gICAgICAgIHZhciBsb2NhbHMgPSB7fTtcclxuICAgICAgICBsb2NhbHNbaW50ZXJpbUZhY3RvcnlOYW1lXSA9IHB1YmxpY1NlcnZpY2U7XHJcbiAgICAgICAgcmV0dXJuICRpbmplY3Rvci5pbnZva2UoZmFjdG9yeSB8fCBmdW5jdGlvbigpIHsgcmV0dXJuIGRlZmF1bHRWYWw7IH0sIHt9LCBsb2NhbHMpO1xyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG4gIC8qIEBuZ0luamVjdCAqL1xyXG4gIGZ1bmN0aW9uIEludGVyaW1FbGVtZW50RmFjdG9yeSgkZG9jdW1lbnQsICRxLCAkcm9vdFNjb3BlLCAkdGltZW91dCwgJHJvb3RFbGVtZW50LCAkYW5pbWF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGludGVycG9sYXRlLCAkbWRDb21waWxlciwgJG1kVGhlbWluZyApIHtcclxuICAgIHZhciBzdGFydFN5bWJvbCA9ICRpbnRlcnBvbGF0ZS5zdGFydFN5bWJvbCgpLFxyXG4gICAgICAgIGVuZFN5bWJvbCA9ICRpbnRlcnBvbGF0ZS5lbmRTeW1ib2woKSxcclxuICAgICAgICB1c2VzU3RhbmRhcmRTeW1ib2xzID0gKChzdGFydFN5bWJvbCA9PT0gJ3t7JykgJiYgKGVuZFN5bWJvbCA9PT0gJ319JykpLFxyXG4gICAgICAgIHByb2Nlc3NUZW1wbGF0ZSAgPSB1c2VzU3RhbmRhcmRTeW1ib2xzID8gYW5ndWxhci5pZGVudGl0eSA6IHJlcGxhY2VJbnRlcnBvbGF0aW9uU3ltYm9scztcclxuXHJcbiAgICByZXR1cm4gZnVuY3Rpb24gY3JlYXRlSW50ZXJpbUVsZW1lbnRTZXJ2aWNlKCkge1xyXG4gICAgICAvKlxyXG4gICAgICAgKiBAbmdkb2Mgc2VydmljZVxyXG4gICAgICAgKiBAbmFtZSAkJGludGVyaW1FbGVtZW50LiRzZXJ2aWNlXHJcbiAgICAgICAqXHJcbiAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgKiBBIHNlcnZpY2UgdXNlZCB0byBjb250cm9sIGluc2VydGluZyBhbmQgcmVtb3ZpbmcgYW4gZWxlbWVudCBpbnRvIHRoZSBET00uXHJcbiAgICAgICAqXHJcbiAgICAgICAqL1xyXG4gICAgICB2YXIgc3RhY2sgPSBbXTtcclxuICAgICAgdmFyIHNlcnZpY2U7XHJcbiAgICAgIHJldHVybiBzZXJ2aWNlID0ge1xyXG4gICAgICAgIHNob3c6IHNob3csXHJcbiAgICAgICAgaGlkZTogaGlkZSxcclxuICAgICAgICBjYW5jZWw6IGNhbmNlbFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgLypcclxuICAgICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgICAgKiBAbmFtZSAkJGludGVyaW1FbGVtZW50LiRzZXJ2aWNlI3Nob3dcclxuICAgICAgICogQGtpbmQgZnVuY3Rpb25cclxuICAgICAgICpcclxuICAgICAgICogQGRlc2NyaXB0aW9uXHJcbiAgICAgICAqIEFkZHMgdGhlIGAkaW50ZXJpbUVsZW1lbnRgIHRvIHRoZSBET00gYW5kIHJldHVybnMgYSBwcm9taXNlIHRoYXQgd2lsbCBiZSByZXNvbHZlZCBvciByZWplY3RlZFxyXG4gICAgICAgKiB3aXRoIGhpZGUgb3IgY2FuY2VsLCByZXNwZWN0aXZlbHkuXHJcbiAgICAgICAqXHJcbiAgICAgICAqIEBwYXJhbSB7Kn0gb3B0aW9ucyBpcyBoYXNoTWFwIG9mIHNldHRpbmdzXHJcbiAgICAgICAqIEByZXR1cm5zIGEgUHJvbWlzZVxyXG4gICAgICAgKlxyXG4gICAgICAgKi9cclxuICAgICAgZnVuY3Rpb24gc2hvdyhvcHRpb25zKSB7XHJcbiAgICAgICAgaWYgKHN0YWNrLmxlbmd0aCkge1xyXG4gICAgICAgICAgcmV0dXJuIHNlcnZpY2UuY2FuY2VsKCkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHNob3cob3B0aW9ucyk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdmFyIGludGVyaW1FbGVtZW50ID0gbmV3IEludGVyaW1FbGVtZW50KG9wdGlvbnMpO1xyXG4gICAgICAgICAgc3RhY2sucHVzaChpbnRlcmltRWxlbWVudCk7XHJcbiAgICAgICAgICByZXR1cm4gaW50ZXJpbUVsZW1lbnQuc2hvdygpLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbnRlcmltRWxlbWVudC5kZWZlcnJlZC5wcm9taXNlO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvKlxyXG4gICAgICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAgICAqIEBuYW1lICQkaW50ZXJpbUVsZW1lbnQuJHNlcnZpY2UjaGlkZVxyXG4gICAgICAgKiBAa2luZCBmdW5jdGlvblxyXG4gICAgICAgKlxyXG4gICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICogUmVtb3ZlcyB0aGUgYCRpbnRlcmltRWxlbWVudGAgZnJvbSB0aGUgRE9NIGFuZCByZXNvbHZlcyB0aGUgcHJvbWlzZSByZXR1cm5lZCBmcm9tIGBzaG93YFxyXG4gICAgICAgKlxyXG4gICAgICAgKiBAcGFyYW0geyp9IHJlc29sdmVQYXJhbSBEYXRhIHRvIHJlc29sdmUgdGhlIHByb21pc2Ugd2l0aFxyXG4gICAgICAgKiBAcmV0dXJucyBhIFByb21pc2UgdGhhdCB3aWxsIGJlIHJlc29sdmVkIGFmdGVyIHRoZSBlbGVtZW50IGhhcyBiZWVuIHJlbW92ZWQuXHJcbiAgICAgICAqXHJcbiAgICAgICAqL1xyXG4gICAgICBmdW5jdGlvbiBoaWRlKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgdmFyIGludGVyaW1FbGVtZW50ID0gc3RhY2suc2hpZnQoKTtcclxuICAgICAgICByZXR1cm4gaW50ZXJpbUVsZW1lbnQgJiYgaW50ZXJpbUVsZW1lbnQucmVtb3ZlKCkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgIGludGVyaW1FbGVtZW50LmRlZmVycmVkLnJlc29sdmUocmVzcG9uc2UpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvKlxyXG4gICAgICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAgICAqIEBuYW1lICQkaW50ZXJpbUVsZW1lbnQuJHNlcnZpY2UjY2FuY2VsXHJcbiAgICAgICAqIEBraW5kIGZ1bmN0aW9uXHJcbiAgICAgICAqXHJcbiAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgKiBSZW1vdmVzIHRoZSBgJGludGVyaW1FbGVtZW50YCBmcm9tIHRoZSBET00gYW5kIHJlamVjdHMgdGhlIHByb21pc2UgcmV0dXJuZWQgZnJvbSBgc2hvd2BcclxuICAgICAgICpcclxuICAgICAgICogQHBhcmFtIHsqfSByZWFzb24gRGF0YSB0byByZWplY3QgdGhlIHByb21pc2Ugd2l0aFxyXG4gICAgICAgKiBAcmV0dXJucyBQcm9taXNlIHRoYXQgd2lsbCBiZSByZXNvbHZlZCBhZnRlciB0aGUgZWxlbWVudCBoYXMgYmVlbiByZW1vdmVkLlxyXG4gICAgICAgKlxyXG4gICAgICAgKi9cclxuICAgICAgZnVuY3Rpb24gY2FuY2VsKHJlYXNvbikge1xyXG4gICAgICAgIHZhciBpbnRlcmltRWxlbWVudCA9IHN0YWNrLnNoaWZ0KCk7XHJcbiAgICAgICAgcmV0dXJuICRxLndoZW4oaW50ZXJpbUVsZW1lbnQgJiYgaW50ZXJpbUVsZW1lbnQucmVtb3ZlKCkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgIGludGVyaW1FbGVtZW50LmRlZmVycmVkLnJlamVjdChyZWFzb24pO1xyXG4gICAgICAgIH0pKTtcclxuICAgICAgfVxyXG5cclxuXHJcbiAgICAgIC8qXHJcbiAgICAgICAqIEludGVybmFsIEludGVyaW0gRWxlbWVudCBPYmplY3RcclxuICAgICAgICogVXNlZCBpbnRlcm5hbGx5IHRvIG1hbmFnZSB0aGUgRE9NIGVsZW1lbnQgYW5kIHJlbGF0ZWQgZGF0YVxyXG4gICAgICAgKi9cclxuICAgICAgZnVuY3Rpb24gSW50ZXJpbUVsZW1lbnQob3B0aW9ucykge1xyXG4gICAgICAgIHZhciBzZWxmO1xyXG4gICAgICAgIHZhciBoaWRlVGltZW91dCwgZWxlbWVudCwgc2hvd0RvbmUsIHJlbW92ZURvbmU7XHJcblxyXG4gICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xyXG4gICAgICAgIG9wdGlvbnMgPSBhbmd1bGFyLmV4dGVuZCh7XHJcbiAgICAgICAgICBwcmVzZXJ2ZVNjb3BlOiBmYWxzZSxcclxuICAgICAgICAgIHNjb3BlOiBvcHRpb25zLnNjb3BlIHx8ICRyb290U2NvcGUuJG5ldyhvcHRpb25zLmlzb2xhdGVTY29wZSksXHJcbiAgICAgICAgICBvblNob3c6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBvcHRpb25zKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkYW5pbWF0ZS5lbnRlcihlbGVtZW50LCBvcHRpb25zLnBhcmVudCk7XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgb25SZW1vdmU6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBvcHRpb25zKSB7XHJcbiAgICAgICAgICAgIC8vIEVsZW1lbnQgY291bGQgYmUgdW5kZWZpbmVkIGlmIGEgbmV3IGVsZW1lbnQgaXMgc2hvd24gYmVmb3JlXHJcbiAgICAgICAgICAgIC8vIHRoZSBvbGQgb25lIGZpbmlzaGVzIGNvbXBpbGluZy5cclxuICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQgJiYgJGFuaW1hdGUubGVhdmUoZWxlbWVudCkgfHwgJHEud2hlbigpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sIG9wdGlvbnMpO1xyXG5cclxuICAgICAgICBpZiAob3B0aW9ucy50ZW1wbGF0ZSkge1xyXG4gICAgICAgICAgb3B0aW9ucy50ZW1wbGF0ZSA9IHByb2Nlc3NUZW1wbGF0ZShvcHRpb25zLnRlbXBsYXRlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBzZWxmID0ge1xyXG4gICAgICAgICAgb3B0aW9uczogb3B0aW9ucyxcclxuICAgICAgICAgIGRlZmVycmVkOiAkcS5kZWZlcigpLFxyXG4gICAgICAgICAgc2hvdzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBjb21waWxlUHJvbWlzZTtcclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuc2tpcENvbXBpbGUpIHtcclxuICAgICAgICAgICAgICBjb21waWxlUHJvbWlzZSA9ICRxKGZ1bmN0aW9uKHJlc29sdmUpIHsgXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKHtcclxuICAgICAgICAgICAgICAgICAgbG9jYWxzOiB7fSxcclxuICAgICAgICAgICAgICAgICAgbGluazogZnVuY3Rpb24oKSB7IHJldHVybiBvcHRpb25zLmVsZW1lbnQ7IH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIGNvbXBpbGVQcm9taXNlID0gJG1kQ29tcGlsZXIuY29tcGlsZShvcHRpb25zKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHNob3dEb25lID0gY29tcGlsZVByb21pc2UudGhlbihmdW5jdGlvbihjb21waWxlRGF0YSkge1xyXG4gICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKGNvbXBpbGVEYXRhLmxvY2Fscywgc2VsZi5vcHRpb25zKTtcclxuXHJcbiAgICAgICAgICAgICAgZWxlbWVudCA9IGNvbXBpbGVEYXRhLmxpbmsob3B0aW9ucy5zY29wZSk7XHJcblxyXG4gICAgICAgICAgICAgIC8vIFNlYXJjaCBmb3IgcGFyZW50IGF0IGluc2VydGlvbiB0aW1lLCBpZiBub3Qgc3BlY2lmaWVkXHJcbiAgICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNGdW5jdGlvbihvcHRpb25zLnBhcmVudCkpIHtcclxuICAgICAgICAgICAgICAgIG9wdGlvbnMucGFyZW50ID0gb3B0aW9ucy5wYXJlbnQob3B0aW9ucy5zY29wZSwgZWxlbWVudCwgb3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChhbmd1bGFyLmlzU3RyaW5nKG9wdGlvbnMucGFyZW50KSkge1xyXG4gICAgICAgICAgICAgICAgb3B0aW9ucy5wYXJlbnQgPSBhbmd1bGFyLmVsZW1lbnQoJGRvY3VtZW50WzBdLnF1ZXJ5U2VsZWN0b3Iob3B0aW9ucy5wYXJlbnQpKTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIC8vIElmIHBhcmVudCBxdWVyeVNlbGVjdG9yL2dldHRlciBmdW5jdGlvbiBmYWlscywgb3IgaXQncyBqdXN0IG51bGwsXHJcbiAgICAgICAgICAgICAgLy8gZmluZCBhIGRlZmF1bHQuXHJcbiAgICAgICAgICAgICAgaWYgKCEob3B0aW9ucy5wYXJlbnQgfHwge30pLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGVsO1xyXG4gICAgICAgICAgICAgICAgaWYgKCRyb290RWxlbWVudFswXSAmJiAkcm9vdEVsZW1lbnRbMF0ucXVlcnlTZWxlY3Rvcikge1xyXG4gICAgICAgICAgICAgICAgICBlbCA9ICRyb290RWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCc6bm90KHN2ZykgPiBib2R5Jyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIWVsKSBlbCA9ICRyb290RWxlbWVudFswXTtcclxuICAgICAgICAgICAgICAgIGlmIChlbC5ub2RlTmFtZSA9PSAnI2NvbW1lbnQnKSB7XHJcbiAgICAgICAgICAgICAgICAgIGVsID0gJGRvY3VtZW50WzBdLmJvZHk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBvcHRpb25zLnBhcmVudCA9IGFuZ3VsYXIuZWxlbWVudChlbCk7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICBpZiAob3B0aW9ucy50aGVtYWJsZSkgJG1kVGhlbWluZyhlbGVtZW50KTtcclxuICAgICAgICAgICAgICB2YXIgcmV0ID0gb3B0aW9ucy5vblNob3cob3B0aW9ucy5zY29wZSwgZWxlbWVudCwgb3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgcmV0dXJuICRxLndoZW4ocmV0KVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgLy8gSXNzdWUgb25Db21wbGV0ZSBjYWxsYmFjayB3aGVuIHRoZSBgc2hvdygpYCBmaW5pc2hlc1xyXG4gICAgICAgICAgICAgICAgICAob3B0aW9ucy5vbkNvbXBsZXRlIHx8IGFuZ3VsYXIubm9vcCkob3B0aW9ucy5zY29wZSwgZWxlbWVudCwgb3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgIHN0YXJ0SGlkZVRpbWVvdXQoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICBmdW5jdGlvbiBzdGFydEhpZGVUaW1lb3V0KCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuaGlkZURlbGF5KSB7XHJcbiAgICAgICAgICAgICAgICAgIGhpZGVUaW1lb3V0ID0gJHRpbWVvdXQoc2VydmljZS5jYW5jZWwsIG9wdGlvbnMuaGlkZURlbGF5KSA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbihyZWFzb24pIHsgc2hvd0RvbmUgPSB0cnVlOyBzZWxmLmRlZmVycmVkLnJlamVjdChyZWFzb24pOyB9KTtcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBjYW5jZWxUaW1lb3V0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKGhpZGVUaW1lb3V0KSB7XHJcbiAgICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKGhpZGVUaW1lb3V0KTtcclxuICAgICAgICAgICAgICBoaWRlVGltZW91dCA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHJlbW92ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHNlbGYuY2FuY2VsVGltZW91dCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVtb3ZlRG9uZSA9ICRxLndoZW4oc2hvd0RvbmUpLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgdmFyIHJldCA9IGVsZW1lbnQgPyBvcHRpb25zLm9uUmVtb3ZlKG9wdGlvbnMuc2NvcGUsIGVsZW1lbnQsIG9wdGlvbnMpIDogdHJ1ZTtcclxuICAgICAgICAgICAgICByZXR1cm4gJHEud2hlbihyZXQpLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIW9wdGlvbnMucHJlc2VydmVTY29wZSkgb3B0aW9ucy5zY29wZS4kZGVzdHJveSgpO1xyXG4gICAgICAgICAgICAgICAgcmVtb3ZlRG9uZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLypcclxuICAgICAqIFJlcGxhY2UgYHt7YCBhbmQgYH19YCBpbiBhIHN0cmluZyAodXN1YWxseSBhIHRlbXBsYXRlKSB3aXRoIHRoZSBhY3R1YWwgc3RhcnQtL2VuZFN5bWJvbHMgdXNlZFxyXG4gICAgICogZm9yIGludGVycG9sYXRpb24uIFRoaXMgYWxsb3dzIHByZS1kZWZpbmVkIHRlbXBsYXRlcyAoZm9yIGNvbXBvbmVudHMgc3VjaCBhcyBkaWFsb2csIHRvYXN0IGV0YylcclxuICAgICAqIHRvIGNvbnRpbnVlIHRvIHdvcmsgaW4gYXBwcyB0aGF0IHVzZSBjdXN0b20gaW50ZXJwb2xhdGlvbiBzdGFydC0vZW5kU3ltYm9scy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dCBUaGUgdGV4dCBpbiB3aGljaCB0byByZXBsYWNlIGB7e2AgLyBgfX1gXHJcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgbW9kaWZpZWQgc3RyaW5nIHVzaW5nIHRoZSBhY3R1YWwgaW50ZXJwb2xhdGlvbiBzdGFydC0vZW5kU3ltYm9sc1xyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiByZXBsYWNlSW50ZXJwb2xhdGlvblN5bWJvbHModGV4dCkge1xyXG4gICAgICBpZiAoIXRleHQgfHwgIWFuZ3VsYXIuaXNTdHJpbmcodGV4dCkpIHJldHVybiB0ZXh0O1xyXG4gICAgICByZXR1cm4gdGV4dC5yZXBsYWNlKC9cXHtcXHsvZywgc3RhcnRTeW1ib2wpLnJlcGxhY2UoL319L2csIGVuZFN5bWJvbCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxufVxyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuICAvKipcclxuICAgKiBAbmdkb2MgbW9kdWxlXHJcbiAgICogQG5hbWUgbWF0ZXJpYWwuY29yZS5jb21wb25lbnRSZWdpc3RyeVxyXG4gICAqXHJcbiAgICogQGRlc2NyaXB0aW9uXHJcbiAgICogQSBjb21wb25lbnQgaW5zdGFuY2UgcmVnaXN0cmF0aW9uIHNlcnZpY2UuXHJcbiAgICogTm90ZTogY3VycmVudGx5IHRoaXMgYXMgYSBwcml2YXRlIHNlcnZpY2UgaW4gdGhlIFNpZGVOYXYgY29tcG9uZW50LlxyXG4gICAqL1xyXG4gIGFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb3JlJylcclxuICAgIC5mYWN0b3J5KCckbWRDb21wb25lbnRSZWdpc3RyeScsIENvbXBvbmVudFJlZ2lzdHJ5KTtcclxuXHJcbiAgLypcclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqIEBuZ2RvYyBmYWN0b3J5XHJcbiAgICogQG5hbWUgQ29tcG9uZW50UmVnaXN0cnlcclxuICAgKiBAbW9kdWxlIG1hdGVyaWFsLmNvcmUuY29tcG9uZW50UmVnaXN0cnlcclxuICAgKlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIENvbXBvbmVudFJlZ2lzdHJ5KCRsb2csICRxKSB7XHJcblxyXG4gICAgdmFyIHNlbGY7XHJcbiAgICB2YXIgaW5zdGFuY2VzID0gWyBdO1xyXG4gICAgdmFyIHBlbmRpbmdzID0geyB9O1xyXG5cclxuICAgIHJldHVybiBzZWxmID0ge1xyXG4gICAgICAvKipcclxuICAgICAgICogVXNlZCB0byBwcmludCBhbiBlcnJvciB3aGVuIGFuIGluc3RhbmNlIGZvciBhIGhhbmRsZSBpc24ndCBmb3VuZC5cclxuICAgICAgICovXHJcbiAgICAgIG5vdEZvdW5kRXJyb3I6IGZ1bmN0aW9uKGhhbmRsZSkge1xyXG4gICAgICAgICRsb2cuZXJyb3IoJ05vIGluc3RhbmNlIGZvdW5kIGZvciBoYW5kbGUnLCBoYW5kbGUpO1xyXG4gICAgICB9LFxyXG4gICAgICAvKipcclxuICAgICAgICogUmV0dXJuIGFsbCByZWdpc3RlcmVkIGluc3RhbmNlcyBhcyBhbiBhcnJheS5cclxuICAgICAgICovXHJcbiAgICAgIGdldEluc3RhbmNlczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlcztcclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiBHZXQgYSByZWdpc3RlcmVkIGluc3RhbmNlLlxyXG4gICAgICAgKiBAcGFyYW0gaGFuZGxlIHRoZSBTdHJpbmcgaGFuZGxlIHRvIGxvb2sgdXAgZm9yIGEgcmVnaXN0ZXJlZCBpbnN0YW5jZS5cclxuICAgICAgICovXHJcbiAgICAgIGdldDogZnVuY3Rpb24oaGFuZGxlKSB7XHJcbiAgICAgICAgaWYgKCAhaXNWYWxpZElEKGhhbmRsZSkgKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgdmFyIGksIGosIGluc3RhbmNlO1xyXG4gICAgICAgIGZvcihpID0gMCwgaiA9IGluc3RhbmNlcy5sZW5ndGg7IGkgPCBqOyBpKyspIHtcclxuICAgICAgICAgIGluc3RhbmNlID0gaW5zdGFuY2VzW2ldO1xyXG4gICAgICAgICAgaWYoaW5zdGFuY2UuJCRtZEhhbmRsZSA9PT0gaGFuZGxlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbnN0YW5jZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAvKipcclxuICAgICAgICogUmVnaXN0ZXIgYW4gaW5zdGFuY2UuXHJcbiAgICAgICAqIEBwYXJhbSBpbnN0YW5jZSB0aGUgaW5zdGFuY2UgdG8gcmVnaXN0ZXJcclxuICAgICAgICogQHBhcmFtIGhhbmRsZSB0aGUgaGFuZGxlIHRvIGlkZW50aWZ5IHRoZSBpbnN0YW5jZSB1bmRlci5cclxuICAgICAgICovXHJcbiAgICAgIHJlZ2lzdGVyOiBmdW5jdGlvbihpbnN0YW5jZSwgaGFuZGxlKSB7XHJcbiAgICAgICAgaWYgKCAhaGFuZGxlICkgcmV0dXJuIGFuZ3VsYXIubm9vcDtcclxuXHJcbiAgICAgICAgaW5zdGFuY2UuJCRtZEhhbmRsZSA9IGhhbmRsZTtcclxuICAgICAgICBpbnN0YW5jZXMucHVzaChpbnN0YW5jZSk7XHJcbiAgICAgICAgcmVzb2x2ZVdoZW4oKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGRlcmVnaXN0ZXI7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFJlbW92ZSByZWdpc3RyYXRpb24gZm9yIGFuIGluc3RhbmNlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gZGVyZWdpc3RlcigpIHtcclxuICAgICAgICAgIHZhciBpbmRleCA9IGluc3RhbmNlcy5pbmRleE9mKGluc3RhbmNlKTtcclxuICAgICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcclxuICAgICAgICAgICAgaW5zdGFuY2VzLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZXNvbHZlIGFueSBwZW5kaW5nIHByb21pc2VzIGZvciB0aGlzIGluc3RhbmNlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZVdoZW4oKSB7XHJcbiAgICAgICAgICB2YXIgZGZkID0gcGVuZGluZ3NbaGFuZGxlXTtcclxuICAgICAgICAgIGlmICggZGZkICkge1xyXG4gICAgICAgICAgICBkZmQucmVzb2x2ZSggaW5zdGFuY2UgKTtcclxuICAgICAgICAgICAgZGVsZXRlIHBlbmRpbmdzW2hhbmRsZV07XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgLyoqXHJcbiAgICAgICAqIEFzeW5jIGFjY2Vzc29yIHRvIHJlZ2lzdGVyZWQgY29tcG9uZW50IGluc3RhbmNlXHJcbiAgICAgICAqIElmIG5vdCBhdmFpbGFibGUgdGhlbiBhIHByb21pc2UgaXMgY3JlYXRlZCB0byBub3RpZnlcclxuICAgICAgICogYWxsIGxpc3RlbmVycyB3aGVuIHRoZSBpbnN0YW5jZSBpcyByZWdpc3RlcmVkLlxyXG4gICAgICAgKi9cclxuICAgICAgd2hlbiA6IGZ1bmN0aW9uKGhhbmRsZSkge1xyXG4gICAgICAgIGlmICggaXNWYWxpZElEKGhhbmRsZSkgKSB7XHJcbiAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgdmFyIGluc3RhbmNlID0gc2VsZi5nZXQoaGFuZGxlKTtcclxuXHJcbiAgICAgICAgICBpZiAoIGluc3RhbmNlICkgIHtcclxuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSggaW5zdGFuY2UgKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHBlbmRpbmdzW2hhbmRsZV0gPSBkZWZlcnJlZDtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuICRxLnJlamVjdChcIkludmFsaWQgYG1kLWNvbXBvbmVudC1pZGAgdmFsdWUuXCIpO1xyXG4gICAgICB9XHJcblxyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiBpc1ZhbGlkSUQoaGFuZGxlKXtcclxuICAgICAgcmV0dXJuIGhhbmRsZSAmJiAoaGFuZGxlICE9PSBcIlwiKTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG4gIENvbXBvbmVudFJlZ2lzdHJ5LiRpbmplY3QgPSBbXCIkbG9nXCIsIFwiJHFcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAvKipcclxuICAgKiBAbmdkb2Mgc2VydmljZVxyXG4gICAqIEBuYW1lICRtZEJ1dHRvbklua1JpcHBsZVxyXG4gICAqIEBtb2R1bGUgbWF0ZXJpYWwuY29yZVxyXG4gICAqXHJcbiAgICogQGRlc2NyaXB0aW9uXHJcbiAgICogUHJvdmlkZXMgcmlwcGxlIGVmZmVjdHMgZm9yIG1kLWJ1dHRvbi4gIFNlZSAkbWRJbmtSaXBwbGUgc2VydmljZSBmb3IgYWxsIHBvc3NpYmxlIGNvbmZpZ3VyYXRpb24gb3B0aW9ucy5cclxuICAgKlxyXG4gICAqIEBwYXJhbSB7b2JqZWN0PX0gc2NvcGUgU2NvcGUgd2l0aGluIHRoZSBjdXJyZW50IGNvbnRleHRcclxuICAgKiBAcGFyYW0ge29iamVjdD19IGVsZW1lbnQgVGhlIGVsZW1lbnQgdGhlIHJpcHBsZSBlZmZlY3Qgc2hvdWxkIGJlIGFwcGxpZWQgdG9cclxuICAgKiBAcGFyYW0ge29iamVjdD19IG9wdGlvbnMgKE9wdGlvbmFsKSBDb25maWd1cmF0aW9uIG9wdGlvbnMgdG8gb3ZlcnJpZGUgdGhlIGRlZmF1bHRyaXBwbGUgY29uZmlndXJhdGlvblxyXG4gICAqL1xyXG5cclxuICBhbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29yZScpXHJcbiAgICAuZmFjdG9yeSgnJG1kQnV0dG9uSW5rUmlwcGxlJywgTWRCdXR0b25JbmtSaXBwbGUpO1xyXG5cclxuICBmdW5jdGlvbiBNZEJ1dHRvbklua1JpcHBsZSgkbWRJbmtSaXBwbGUpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGF0dGFjaDogYXR0YWNoXHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIGF0dGFjaChzY29wZSwgZWxlbWVudCwgb3B0aW9ucykge1xyXG4gICAgICB2YXIgZWxlbWVudE9wdGlvbnMgPSBvcHRpb25zRm9yRWxlbWVudChlbGVtZW50KTtcclxuICAgICAgcmV0dXJuICRtZElua1JpcHBsZS5hdHRhY2goc2NvcGUsIGVsZW1lbnQsIGFuZ3VsYXIuZXh0ZW5kKGVsZW1lbnRPcHRpb25zLCBvcHRpb25zKSk7XHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIG9wdGlvbnNGb3JFbGVtZW50KGVsZW1lbnQpIHtcclxuICAgICAgaWYgKGVsZW1lbnQuaGFzQ2xhc3MoJ21kLWljb24tYnV0dG9uJykpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgaXNNZW51SXRlbTogZWxlbWVudC5oYXNDbGFzcygnbWQtbWVudS1pdGVtJyksXHJcbiAgICAgICAgICBmaXRSaXBwbGU6IHRydWUsXHJcbiAgICAgICAgICBjZW50ZXI6IHRydWVcclxuICAgICAgICB9O1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBpc01lbnVJdGVtOiBlbGVtZW50Lmhhc0NsYXNzKCdtZC1tZW51LWl0ZW0nKSxcclxuICAgICAgICAgIGRpbUJhY2tncm91bmQ6IHRydWVcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfVxyXG4gIE1kQnV0dG9uSW5rUmlwcGxlLiRpbmplY3QgPSBbXCIkbWRJbmtSaXBwbGVcIl07O1xyXG59KSgpO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICAvKipcclxuICAgKiBAbmdkb2Mgc2VydmljZVxyXG4gICAqIEBuYW1lICRtZENoZWNrYm94SW5rUmlwcGxlXHJcbiAgICogQG1vZHVsZSBtYXRlcmlhbC5jb3JlXHJcbiAgICpcclxuICAgKiBAZGVzY3JpcHRpb25cclxuICAgKiBQcm92aWRlcyByaXBwbGUgZWZmZWN0cyBmb3IgbWQtY2hlY2tib3guICBTZWUgJG1kSW5rUmlwcGxlIHNlcnZpY2UgZm9yIGFsbCBwb3NzaWJsZSBjb25maWd1cmF0aW9uIG9wdGlvbnMuXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge29iamVjdD19IHNjb3BlIFNjb3BlIHdpdGhpbiB0aGUgY3VycmVudCBjb250ZXh0XHJcbiAgICogQHBhcmFtIHtvYmplY3Q9fSBlbGVtZW50IFRoZSBlbGVtZW50IHRoZSByaXBwbGUgZWZmZWN0IHNob3VsZCBiZSBhcHBsaWVkIHRvXHJcbiAgICogQHBhcmFtIHtvYmplY3Q9fSBvcHRpb25zIChPcHRpb25hbCkgQ29uZmlndXJhdGlvbiBvcHRpb25zIHRvIG92ZXJyaWRlIHRoZSBkZWZhdWx0cmlwcGxlIGNvbmZpZ3VyYXRpb25cclxuICAgKi9cclxuXHJcbiAgYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvcmUnKVxyXG4gICAgLmZhY3RvcnkoJyRtZENoZWNrYm94SW5rUmlwcGxlJywgTWRDaGVja2JveElua1JpcHBsZSk7XHJcblxyXG4gIGZ1bmN0aW9uIE1kQ2hlY2tib3hJbmtSaXBwbGUoJG1kSW5rUmlwcGxlKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBhdHRhY2g6IGF0dGFjaFxyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiBhdHRhY2goc2NvcGUsIGVsZW1lbnQsIG9wdGlvbnMpIHtcclxuICAgICAgcmV0dXJuICRtZElua1JpcHBsZS5hdHRhY2goc2NvcGUsIGVsZW1lbnQsIGFuZ3VsYXIuZXh0ZW5kKHtcclxuICAgICAgICBjZW50ZXI6IHRydWUsXHJcbiAgICAgICAgZGltQmFja2dyb3VuZDogZmFsc2UsXHJcbiAgICAgICAgZml0UmlwcGxlOiB0cnVlXHJcbiAgICAgIH0sIG9wdGlvbnMpKTtcclxuICAgIH07XHJcbiAgfVxyXG4gIE1kQ2hlY2tib3hJbmtSaXBwbGUuJGluamVjdCA9IFtcIiRtZElua1JpcHBsZVwiXTs7XHJcbn0pKCk7XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAvKipcclxuICAgKiBAbmdkb2Mgc2VydmljZVxyXG4gICAqIEBuYW1lICRtZExpc3RJbmtSaXBwbGVcclxuICAgKiBAbW9kdWxlIG1hdGVyaWFsLmNvcmVcclxuICAgKlxyXG4gICAqIEBkZXNjcmlwdGlvblxyXG4gICAqIFByb3ZpZGVzIHJpcHBsZSBlZmZlY3RzIGZvciBtZC1saXN0LiAgU2VlICRtZElua1JpcHBsZSBzZXJ2aWNlIGZvciBhbGwgcG9zc2libGUgY29uZmlndXJhdGlvbiBvcHRpb25zLlxyXG4gICAqXHJcbiAgICogQHBhcmFtIHtvYmplY3Q9fSBzY29wZSBTY29wZSB3aXRoaW4gdGhlIGN1cnJlbnQgY29udGV4dFxyXG4gICAqIEBwYXJhbSB7b2JqZWN0PX0gZWxlbWVudCBUaGUgZWxlbWVudCB0aGUgcmlwcGxlIGVmZmVjdCBzaG91bGQgYmUgYXBwbGllZCB0b1xyXG4gICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyAoT3B0aW9uYWwpIENvbmZpZ3VyYXRpb24gb3B0aW9ucyB0byBvdmVycmlkZSB0aGUgZGVmYXVsdHJpcHBsZSBjb25maWd1cmF0aW9uXHJcbiAgICovXHJcblxyXG4gIGFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb3JlJylcclxuICAgIC5mYWN0b3J5KCckbWRMaXN0SW5rUmlwcGxlJywgTWRMaXN0SW5rUmlwcGxlKTtcclxuXHJcbiAgZnVuY3Rpb24gTWRMaXN0SW5rUmlwcGxlKCRtZElua1JpcHBsZSkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgYXR0YWNoOiBhdHRhY2hcclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gYXR0YWNoKHNjb3BlLCBlbGVtZW50LCBvcHRpb25zKSB7XHJcbiAgICAgIHJldHVybiAkbWRJbmtSaXBwbGUuYXR0YWNoKHNjb3BlLCBlbGVtZW50LCBhbmd1bGFyLmV4dGVuZCh7XHJcbiAgICAgICAgY2VudGVyOiBmYWxzZSxcclxuICAgICAgICBkaW1CYWNrZ3JvdW5kOiB0cnVlLFxyXG4gICAgICAgIG91dGxpbmU6IGZhbHNlLFxyXG4gICAgICAgIHJpcHBsZVNpemU6ICdmdWxsJ1xyXG4gICAgICB9LCBvcHRpb25zKSk7XHJcbiAgICB9O1xyXG4gIH1cclxuICBNZExpc3RJbmtSaXBwbGUuJGluamVjdCA9IFtcIiRtZElua1JpcHBsZVwiXTs7XHJcbn0pKCk7XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29yZScpXHJcbiAgLmZhY3RvcnkoJyRtZElua1JpcHBsZScsIElua1JpcHBsZVNlcnZpY2UpXHJcbiAgLmRpcmVjdGl2ZSgnbWRJbmtSaXBwbGUnLCBJbmtSaXBwbGVEaXJlY3RpdmUpXHJcbiAgLmRpcmVjdGl2ZSgnbWROb0luaycsIGF0dHJOb0RpcmVjdGl2ZSgpKVxyXG4gIC5kaXJlY3RpdmUoJ21kTm9CYXInLCBhdHRyTm9EaXJlY3RpdmUoKSlcclxuICAuZGlyZWN0aXZlKCdtZE5vU3RyZXRjaCcsIGF0dHJOb0RpcmVjdGl2ZSgpKTtcclxuXHJcbmZ1bmN0aW9uIElua1JpcHBsZURpcmVjdGl2ZSgkbWRCdXR0b25JbmtSaXBwbGUsICRtZENoZWNrYm94SW5rUmlwcGxlKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIGNvbnRyb2xsZXI6IGFuZ3VsYXIubm9vcCxcclxuICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cikge1xyXG4gICAgICBpZiAoYXR0ci5oYXNPd25Qcm9wZXJ0eSgnbWRJbmtSaXBwbGVDaGVja2JveCcpKSB7XHJcbiAgICAgICAgJG1kQ2hlY2tib3hJbmtSaXBwbGUuYXR0YWNoKHNjb3BlLCBlbGVtZW50KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkbWRCdXR0b25JbmtSaXBwbGUuYXR0YWNoKHNjb3BlLCBlbGVtZW50KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuSW5rUmlwcGxlRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkbWRCdXR0b25JbmtSaXBwbGVcIiwgXCIkbWRDaGVja2JveElua1JpcHBsZVwiXTtcclxuXHJcbmZ1bmN0aW9uIElua1JpcHBsZVNlcnZpY2UoJHdpbmRvdywgJHRpbWVvdXQpIHtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGF0dGFjaDogYXR0YWNoXHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb24gYXR0YWNoKHNjb3BlLCBlbGVtZW50LCBvcHRpb25zKSB7XHJcbiAgICBpZiAoZWxlbWVudC5jb250cm9sbGVyKCdtZE5vSW5rJykpIHJldHVybiBhbmd1bGFyLm5vb3A7XHJcblxyXG4gICAgb3B0aW9ucyA9IGFuZ3VsYXIuZXh0ZW5kKHtcclxuICAgICAgY29sb3JFbGVtZW50OiBlbGVtZW50LFxyXG4gICAgICBtb3VzZWRvd246IHRydWUsXHJcbiAgICAgIGhvdmVyOiB0cnVlLFxyXG4gICAgICBmb2N1czogdHJ1ZSxcclxuICAgICAgY2VudGVyOiBmYWxzZSxcclxuICAgICAgbW91c2Vkb3duUGF1c2VUaW1lOiAxNTAsXHJcbiAgICAgIGRpbUJhY2tncm91bmQ6IGZhbHNlLFxyXG4gICAgICBvdXRsaW5lOiBmYWxzZSxcclxuICAgICAgZnVsbFJpcHBsZTogdHJ1ZSxcclxuICAgICAgaXNNZW51SXRlbTogZmFsc2UsXHJcbiAgICAgIGZpdFJpcHBsZTogZmFsc2VcclxuICAgIH0sIG9wdGlvbnMpO1xyXG5cclxuICAgIHZhciByaXBwbGVTaXplLFxyXG4gICAgICAgIGNvbnRyb2xsZXIgPSBlbGVtZW50LmNvbnRyb2xsZXIoJ21kSW5rUmlwcGxlJykgfHwge30sXHJcbiAgICAgICAgY291bnRlciA9IDAsXHJcbiAgICAgICAgcmlwcGxlcyA9IFtdLFxyXG4gICAgICAgIHN0YXRlcyA9IFtdLFxyXG4gICAgICAgIGlzQWN0aXZlRXhwciA9IGVsZW1lbnQuYXR0cignbWQtaGlnaGxpZ2h0JyksXHJcbiAgICAgICAgaXNBY3RpdmUgPSBmYWxzZSxcclxuICAgICAgICBpc0hlbGQgPSBmYWxzZSxcclxuICAgICAgICBub2RlID0gZWxlbWVudFswXSxcclxuICAgICAgICByaXBwbGVTaXplU2V0dGluZyA9IGVsZW1lbnQuYXR0cignbWQtcmlwcGxlLXNpemUnKSxcclxuICAgICAgICBjb2xvciA9IHBhcnNlQ29sb3IoZWxlbWVudC5hdHRyKCdtZC1pbmstcmlwcGxlJykpIHx8IHBhcnNlQ29sb3Iob3B0aW9ucy5jb2xvckVsZW1lbnQubGVuZ3RoICYmICR3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShvcHRpb25zLmNvbG9yRWxlbWVudFswXSkuY29sb3IgfHwgJ3JnYigwLCAwLCAwKScpO1xyXG5cclxuICAgIHN3aXRjaCAocmlwcGxlU2l6ZVNldHRpbmcpIHtcclxuICAgICAgY2FzZSAnZnVsbCc6XHJcbiAgICAgICAgb3B0aW9ucy5mdWxsUmlwcGxlID0gdHJ1ZTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAncGFydGlhbCc6XHJcbiAgICAgICAgb3B0aW9ucy5mdWxsUmlwcGxlID0gZmFsc2U7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gZXhwb3NlIG9uSW5wdXQgZm9yIHJpcHBsZSB0ZXN0aW5nXHJcbiAgICBpZiAob3B0aW9ucy5tb3VzZWRvd24pIHtcclxuICAgICAgZWxlbWVudC5vbignJG1kLnByZXNzZG93bicsIG9uUHJlc3NEb3duKVxyXG4gICAgICAgIC5vbignJG1kLnByZXNzdXAnLCBvblByZXNzVXApO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnRyb2xsZXIuY3JlYXRlUmlwcGxlID0gY3JlYXRlUmlwcGxlO1xyXG5cclxuICAgIGlmIChpc0FjdGl2ZUV4cHIpIHtcclxuICAgICAgc2NvcGUuJHdhdGNoKGlzQWN0aXZlRXhwciwgZnVuY3Rpb24gd2F0Y2hBY3RpdmUobmV3VmFsdWUpIHtcclxuICAgICAgICBpc0FjdGl2ZSA9IG5ld1ZhbHVlO1xyXG4gICAgICAgIGlmIChpc0FjdGl2ZSAmJiAhcmlwcGxlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHsgY3JlYXRlUmlwcGxlKDAsIDApOyB9LCAwLCBmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGFuZ3VsYXIuZm9yRWFjaChyaXBwbGVzLCB1cGRhdGVFbGVtZW50KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUHVibGlzaCBzZWxmLWRldGFjaCBtZXRob2QgaWYgZGVzaXJlZC4uLlxyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIGRldGFjaCgpIHtcclxuICAgICAgZWxlbWVudC5vZmYoJyRtZC5wcmVzc2Rvd24nLCBvblByZXNzRG93bilcclxuICAgICAgICAub2ZmKCckbWQucHJlc3N1cCcsIG9uUHJlc3NVcCk7XHJcbiAgICAgIGdldFJpcHBsZUNvbnRhaW5lcigpLnJlbW92ZSgpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldHMgdGhlIGN1cnJlbnQgcmlwcGxlIGNvbnRhaW5lclxyXG4gICAgICogSWYgdGhlcmUgaXMgbm8gcmlwcGxlIGNvbnRhaW5lciwgaXQgY3JlYXRlcyBvbmUgYW5kIHJldHVybnMgaXRcclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyB7YW5ndWxhci5lbGVtZW50fSByaXBwbGUgY29udGFpbmVyIGVsZW1lbnRcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZ2V0UmlwcGxlQ29udGFpbmVyKCkge1xyXG4gICAgICB2YXIgY29udGFpbmVyID0gZWxlbWVudC5kYXRhKCckbWRSaXBwbGVDb250YWluZXInKTtcclxuICAgICAgaWYgKGNvbnRhaW5lcikgcmV0dXJuIGNvbnRhaW5lcjtcclxuICAgICAgY29udGFpbmVyID0gYW5ndWxhci5lbGVtZW50KCc8ZGl2IGNsYXNzPVwibWQtcmlwcGxlLWNvbnRhaW5lclwiPicpO1xyXG4gICAgICBlbGVtZW50LmFwcGVuZChjb250YWluZXIpO1xyXG4gICAgICBlbGVtZW50LmRhdGEoJyRtZFJpcHBsZUNvbnRhaW5lcicsIGNvbnRhaW5lcik7XHJcbiAgICAgIHJldHVybiBjb250YWluZXI7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcGFyc2VDb2xvcihjb2xvcikge1xyXG4gICAgICBpZiAoIWNvbG9yKSByZXR1cm47XHJcbiAgICAgIGlmIChjb2xvci5pbmRleE9mKCdyZ2JhJykgPT09IDApIHJldHVybiBjb2xvci5yZXBsYWNlKC9cXGQ/XFwuP1xcZCpcXHMqXFwpXFxzKiQvLCAnMC4xKScpO1xyXG4gICAgICBpZiAoY29sb3IuaW5kZXhPZigncmdiJykgID09PSAwKSByZXR1cm4gcmdiVG9SR0JBKGNvbG9yKTtcclxuICAgICAgaWYgKGNvbG9yLmluZGV4T2YoJyMnKSAgICA9PT0gMCkgcmV0dXJuIGhleFRvUkdCQShjb2xvcik7XHJcblxyXG4gICAgICAvKipcclxuICAgICAgICogQ29udmVydHMgYSBoZXggdmFsdWUgdG8gYW4gcmdiYSBzdHJpbmdcclxuICAgICAgICpcclxuICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGhleCB2YWx1ZSAoMyBvciA2IGRpZ2l0cykgdG8gYmUgY29udmVydGVkXHJcbiAgICAgICAqXHJcbiAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHJnYmEgY29sb3Igd2l0aCAwLjEgYWxwaGFcclxuICAgICAgICovXHJcbiAgICAgIGZ1bmN0aW9uIGhleFRvUkdCQShjb2xvcikge1xyXG4gICAgICAgIHZhciBoZXggPSBjb2xvci5jaGFyQXQoMCkgPT09ICcjJyA/IGNvbG9yLnN1YnN0cigxKSA6IGNvbG9yLFxyXG4gICAgICAgICAgZGlnID0gaGV4Lmxlbmd0aCAvIDMsXHJcbiAgICAgICAgICByZWQgPSBoZXguc3Vic3RyKDAsIGRpZyksXHJcbiAgICAgICAgICBncm4gPSBoZXguc3Vic3RyKGRpZywgZGlnKSxcclxuICAgICAgICAgIGJsdSA9IGhleC5zdWJzdHIoZGlnICogMik7XHJcbiAgICAgICAgaWYgKGRpZyA9PT0gMSkge1xyXG4gICAgICAgICAgcmVkICs9IHJlZDtcclxuICAgICAgICAgIGdybiArPSBncm47XHJcbiAgICAgICAgICBibHUgKz0gYmx1O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gJ3JnYmEoJyArIHBhcnNlSW50KHJlZCwgMTYpICsgJywnICsgcGFyc2VJbnQoZ3JuLCAxNikgKyAnLCcgKyBwYXJzZUludChibHUsIDE2KSArICcsMC4xKSc7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiBDb252ZXJ0cyByZ2IgdmFsdWUgdG8gcmdiYSBzdHJpbmdcclxuICAgICAgICpcclxuICAgICAgICogQHBhcmFtIHtzdHJpbmd9IHJnYiBjb2xvciBzdHJpbmdcclxuICAgICAgICpcclxuICAgICAgICogQHJldHVybnMge3N0cmluZ30gcmdiYSBjb2xvciB3aXRoIDAuMSBhbHBoYVxyXG4gICAgICAgKi9cclxuICAgICAgZnVuY3Rpb24gcmdiVG9SR0JBKGNvbG9yKSB7XHJcbiAgICAgICAgcmV0dXJuIGNvbG9yLnJlcGxhY2UoJyknLCAnLCAwLjEpJykucmVwbGFjZSgnKCcsICdhKCcpO1xyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHJlbW92ZUVsZW1lbnQoZWxlbSwgd2FpdCkge1xyXG4gICAgICByaXBwbGVzLnNwbGljZShyaXBwbGVzLmluZGV4T2YoZWxlbSksIDEpO1xyXG4gICAgICBpZiAocmlwcGxlcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICBnZXRSaXBwbGVDb250YWluZXIoKS5jc3MoeyBiYWNrZ3JvdW5kQ29sb3I6ICcnIH0pO1xyXG4gICAgICB9XHJcbiAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHsgZWxlbS5yZW1vdmUoKTsgfSwgd2FpdCwgZmFsc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHVwZGF0ZUVsZW1lbnQoZWxlbSkge1xyXG4gICAgICB2YXIgaW5kZXggPSByaXBwbGVzLmluZGV4T2YoZWxlbSksXHJcbiAgICAgICAgICBzdGF0ZSA9IHN0YXRlc1tpbmRleF0gfHwge30sXHJcbiAgICAgICAgICBlbGVtSXNBY3RpdmUgPSByaXBwbGVzLmxlbmd0aCA+IDEgPyBmYWxzZSA6IGlzQWN0aXZlLFxyXG4gICAgICAgICAgZWxlbUlzSGVsZCAgID0gcmlwcGxlcy5sZW5ndGggPiAxID8gZmFsc2UgOiBpc0hlbGQ7XHJcbiAgICAgIGlmIChlbGVtSXNBY3RpdmUgfHwgc3RhdGUuYW5pbWF0aW5nIHx8IGVsZW1Jc0hlbGQpIHtcclxuICAgICAgICBlbGVtLmFkZENsYXNzKCdtZC1yaXBwbGUtdmlzaWJsZScpO1xyXG4gICAgICB9IGVsc2UgaWYgKGVsZW0pIHtcclxuICAgICAgICBlbGVtLnJlbW92ZUNsYXNzKCdtZC1yaXBwbGUtdmlzaWJsZScpO1xyXG4gICAgICAgIGlmIChvcHRpb25zLm91dGxpbmUpIHtcclxuICAgICAgICAgIGVsZW0uY3NzKHtcclxuICAgICAgICAgICAgd2lkdGg6IHJpcHBsZVNpemUgKyAncHgnLFxyXG4gICAgICAgICAgICBoZWlnaHQ6IHJpcHBsZVNpemUgKyAncHgnLFxyXG4gICAgICAgICAgICBtYXJnaW5MZWZ0OiAocmlwcGxlU2l6ZSAqIC0xKSArICdweCcsXHJcbiAgICAgICAgICAgIG1hcmdpblRvcDogKHJpcHBsZVNpemUgKiAtMSkgKyAncHgnXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmVtb3ZlRWxlbWVudChlbGVtLCBvcHRpb25zLm91dGxpbmUgPyA0NTAgOiA2NTApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgcmlwcGxlIGF0IHRoZSBwcm92aWRlZCBjb29yZGluYXRlc1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBsZWZ0IGN1cnNvciBwb3NpdGlvblxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHRvcCBjdXJzb3IgcG9zaXRpb25cclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyB7YW5ndWxhci5lbGVtZW50fSB0aGUgZ2VuZXJhdGVkIHJpcHBsZSBlbGVtZW50XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGNyZWF0ZVJpcHBsZShsZWZ0LCB0b3ApIHtcclxuXHJcbiAgICAgIGNvbG9yID0gcGFyc2VDb2xvcihlbGVtZW50LmF0dHIoJ21kLWluay1yaXBwbGUnKSkgfHwgcGFyc2VDb2xvcigkd2luZG93LmdldENvbXB1dGVkU3R5bGUob3B0aW9ucy5jb2xvckVsZW1lbnRbMF0pLmNvbG9yIHx8ICdyZ2IoMCwgMCwgMCknKTtcclxuXHJcbiAgICAgIHZhciBjb250YWluZXIgPSBnZXRSaXBwbGVDb250YWluZXIoKSxcclxuICAgICAgICAgIHNpemUgPSBnZXRSaXBwbGVTaXplKGxlZnQsIHRvcCksXHJcbiAgICAgICAgICBjc3MgPSBnZXRSaXBwbGVDc3Moc2l6ZSwgbGVmdCwgdG9wKSxcclxuICAgICAgICAgIGVsZW0gPSBnZXRSaXBwbGVFbGVtZW50KGNzcyksXHJcbiAgICAgICAgICBpbmRleCA9IHJpcHBsZXMuaW5kZXhPZihlbGVtKSxcclxuICAgICAgICAgIHN0YXRlID0gc3RhdGVzW2luZGV4XSB8fCB7fTtcclxuXHJcbiAgICAgIHJpcHBsZVNpemUgPSBzaXplO1xyXG5cclxuICAgICAgc3RhdGUuYW5pbWF0aW5nID0gdHJ1ZTtcclxuXHJcbiAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAob3B0aW9ucy5kaW1CYWNrZ3JvdW5kKSB7XHJcbiAgICAgICAgICBjb250YWluZXIuY3NzKHsgYmFja2dyb3VuZENvbG9yOiBjb2xvciB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxlbS5hZGRDbGFzcygnbWQtcmlwcGxlLXBsYWNlZCBtZC1yaXBwbGUtc2NhbGVkJyk7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMub3V0bGluZSkge1xyXG4gICAgICAgICAgZWxlbS5jc3Moe1xyXG4gICAgICAgICAgICBib3JkZXJXaWR0aDogKHNpemUgKiAwLjUpICsgJ3B4JyxcclxuICAgICAgICAgICAgbWFyZ2luTGVmdDogKHNpemUgKiAtMC41KSArICdweCcsXHJcbiAgICAgICAgICAgIG1hcmdpblRvcDogKHNpemUgKiAtMC41KSArICdweCdcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBlbGVtLmNzcyh7IGxlZnQ6ICc1MCUnLCB0b3A6ICc1MCUnIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB1cGRhdGVFbGVtZW50KGVsZW0pO1xyXG4gICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgIHN0YXRlLmFuaW1hdGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgdXBkYXRlRWxlbWVudChlbGVtKTtcclxuICAgICAgICB9LCAob3B0aW9ucy5vdXRsaW5lID8gNDUwIDogMjI1KSwgZmFsc2UpO1xyXG4gICAgICB9LCAwLCBmYWxzZSk7XHJcblxyXG4gICAgICByZXR1cm4gZWxlbTtcclxuXHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiBDcmVhdGVzIHRoZSByaXBwbGUgZWxlbWVudCB3aXRoIHRoZSBwcm92aWRlZCBjc3NcclxuICAgICAgICpcclxuICAgICAgICogQHBhcmFtIHtvYmplY3R9IGNzcyBwcm9wZXJ0aWVzIHRvIGJlIGFwcGxpZWRcclxuICAgICAgICpcclxuICAgICAgICogQHJldHVybnMge2FuZ3VsYXIuZWxlbWVudH0gdGhlIGdlbmVyYXRlZCByaXBwbGUgZWxlbWVudFxyXG4gICAgICAgKi9cclxuICAgICAgZnVuY3Rpb24gZ2V0UmlwcGxlRWxlbWVudChjc3MpIHtcclxuICAgICAgICB2YXIgZWxlbSA9IGFuZ3VsYXIuZWxlbWVudCgnPGRpdiBjbGFzcz1cIm1kLXJpcHBsZVwiIGRhdGEtY291bnRlcj1cIicgKyBjb3VudGVyKysgKyAnXCI+Jyk7XHJcbiAgICAgICAgcmlwcGxlcy51bnNoaWZ0KGVsZW0pO1xyXG4gICAgICAgIHN0YXRlcy51bnNoaWZ0KHsgYW5pbWF0aW5nOiB0cnVlIH0pO1xyXG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmQoZWxlbSk7XHJcbiAgICAgICAgY3NzICYmIGVsZW0uY3NzKGNzcyk7XHJcbiAgICAgICAgcmV0dXJuIGVsZW07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiBDYWxjdWxhdGUgdGhlIHJpcHBsZSBzaXplXHJcbiAgICAgICAqXHJcbiAgICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IGNhbGN1bGF0ZWQgcmlwcGxlIGRpYW1ldGVyXHJcbiAgICAgICAqL1xyXG4gICAgICBmdW5jdGlvbiBnZXRSaXBwbGVTaXplKGxlZnQsIHRvcCkge1xyXG4gICAgICAgIHZhciB3aWR0aCA9IGNvbnRhaW5lci5wcm9wKCdvZmZzZXRXaWR0aCcpLFxyXG4gICAgICAgICAgICBoZWlnaHQgPSBjb250YWluZXIucHJvcCgnb2Zmc2V0SGVpZ2h0JyksXHJcbiAgICAgICAgICAgIG11bHRpcGxpZXIsIHNpemUsIHJlY3Q7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMuaXNNZW51SXRlbSkge1xyXG4gICAgICAgICAgc2l6ZSA9IE1hdGguc3FydChNYXRoLnBvdyh3aWR0aCwgMikgKyBNYXRoLnBvdyhoZWlnaHQsIDIpKTtcclxuICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbnMub3V0bGluZSkge1xyXG4gICAgICAgICAgcmVjdCA9IG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICBsZWZ0IC09IHJlY3QubGVmdDtcclxuICAgICAgICAgIHRvcCAtPSByZWN0LnRvcDtcclxuICAgICAgICAgIHdpZHRoID0gTWF0aC5tYXgobGVmdCwgd2lkdGggLSBsZWZ0KTtcclxuICAgICAgICAgIGhlaWdodCA9IE1hdGgubWF4KHRvcCwgaGVpZ2h0IC0gdG9wKTtcclxuICAgICAgICAgIHNpemUgPSAyICogTWF0aC5zcXJ0KE1hdGgucG93KHdpZHRoLCAyKSArIE1hdGgucG93KGhlaWdodCwgMikpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBtdWx0aXBsaWVyID0gb3B0aW9ucy5mdWxsUmlwcGxlID8gMS4xIDogMC44O1xyXG4gICAgICAgICAgc2l6ZSA9IE1hdGguc3FydChNYXRoLnBvdyh3aWR0aCwgMikgKyBNYXRoLnBvdyhoZWlnaHQsIDIpKSAqIG11bHRpcGxpZXI7XHJcbiAgICAgICAgICBpZiAob3B0aW9ucy5maXRSaXBwbGUpIHtcclxuICAgICAgICAgICAgc2l6ZSA9IE1hdGgubWluKGhlaWdodCwgd2lkdGgsIHNpemUpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc2l6ZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLyoqXHJcbiAgICAgICAqIEdlbmVyYXRlcyB0aGUgcmlwcGxlIGNzc1xyXG4gICAgICAgKlxyXG4gICAgICAgKiBAcGFyYW0ge251bWJlcn0gdGhlIGRpYW1ldGVyIG9mIHRoZSByaXBwbGVcclxuICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHRoZSBsZWZ0IGN1cnNvciBvZmZzZXRcclxuICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHRoZSB0b3AgY3Vyc29yIG9mZnNldFxyXG4gICAgICAgKlxyXG4gICAgICAgKiBAcmV0dXJucyB7e2JhY2tncm91bmRDb2xvcjogc3RyaW5nLCBib3JkZXJDb2xvcjogc3RyaW5nLCB3aWR0aDogc3RyaW5nLCBoZWlnaHQ6IHN0cmluZ319XHJcbiAgICAgICAqL1xyXG4gICAgICBmdW5jdGlvbiBnZXRSaXBwbGVDc3Moc2l6ZSwgbGVmdCwgdG9wKSB7XHJcbiAgICAgICAgdmFyIHJlY3QgPSBub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxyXG4gICAgICAgICAgICBjc3MgID0ge1xyXG4gICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogcmdiYVRvUkdCKGNvbG9yKSxcclxuICAgICAgICAgICAgICBib3JkZXJDb2xvcjogcmdiYVRvUkdCKGNvbG9yKSxcclxuICAgICAgICAgICAgICB3aWR0aDogc2l6ZSArICdweCcsXHJcbiAgICAgICAgICAgICAgaGVpZ2h0OiBzaXplICsgJ3B4J1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICBpZiAob3B0aW9ucy5vdXRsaW5lKSB7XHJcbiAgICAgICAgICBjc3Mud2lkdGggPSAwO1xyXG4gICAgICAgICAgY3NzLmhlaWdodCA9IDA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNzcy5tYXJnaW5MZWZ0ID0gY3NzLm1hcmdpblRvcCA9IChzaXplICogLTAuNSkgKyAncHgnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKG9wdGlvbnMuY2VudGVyKSB7XHJcbiAgICAgICAgICBjc3MubGVmdCA9IGNzcy50b3AgPSAnNTAlJztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgY3NzLmxlZnQgPSBNYXRoLnJvdW5kKChsZWZ0IC0gcmVjdC5sZWZ0KSAvIGNvbnRhaW5lci5wcm9wKCdvZmZzZXRXaWR0aCcpICogMTAwKSArICclJztcclxuICAgICAgICAgIGNzcy50b3AgPSBNYXRoLnJvdW5kKCh0b3AgLSByZWN0LnRvcCkgLyBjb250YWluZXIucHJvcCgnb2Zmc2V0SGVpZ2h0JykgKiAxMDApICsgJyUnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGNzcztcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ29udmVydHMgcmdiYSBzdHJpbmcgdG8gcmdiLCByZW1vdmluZyB0aGUgYWxwaGEgdmFsdWVcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSByZ2JhIGNvbG9yXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSByZ2IgY29sb3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiByZ2JhVG9SR0IoY29sb3IpIHtcclxuICAgICAgICAgIHJldHVybiBjb2xvci5yZXBsYWNlKCdyZ2JhJywgJ3JnYicpLnJlcGxhY2UoLyxbXlxcKSxdK1xcKS8sICcpJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBIYW5kbGVzIHVzZXIgaW5wdXQgc3RhcnQgYW5kIHN0b3AgZXZlbnRzXHJcbiAgICAgKlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBvblByZXNzRG93bihldikge1xyXG4gICAgICBpZiAoIWlzUmlwcGxlQWxsb3dlZCgpKSByZXR1cm47XHJcblxyXG4gICAgICBjcmVhdGVSaXBwbGUoZXYucG9pbnRlci54LCBldi5wb2ludGVyLnkpO1xyXG4gICAgICBpc0hlbGQgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gb25QcmVzc1VwKCkge1xyXG4gICAgICBpc0hlbGQgPSBmYWxzZTtcclxuICAgICAgdmFyIHJpcHBsZSA9IHJpcHBsZXNbIHJpcHBsZXMubGVuZ3RoIC0gMSBdO1xyXG4gICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7IHVwZGF0ZUVsZW1lbnQocmlwcGxlKTsgfSwgMCwgZmFsc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRGV0ZXJtaW5lcyBpZiB0aGUgcmlwcGxlIGlzIGFsbG93ZWRcclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gdHJ1ZSBpZiB0aGUgcmlwcGxlIGlzIGFsbG93ZWQsIGZhbHNlIGlmIG5vdFxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBpc1JpcHBsZUFsbG93ZWQoKSB7XHJcbiAgICAgIHZhciBwYXJlbnQgPSBub2RlLnBhcmVudE5vZGU7XHJcbiAgICAgIHZhciBncmFuZHBhcmVudCA9IHBhcmVudCAmJiBwYXJlbnQucGFyZW50Tm9kZTtcclxuICAgICAgdmFyIGFuY2VzdG9yID0gZ3JhbmRwYXJlbnQgJiYgZ3JhbmRwYXJlbnQucGFyZW50Tm9kZTtcclxuICAgICAgcmV0dXJuICFpc0Rpc2FibGVkKG5vZGUpICYmICFpc0Rpc2FibGVkKHBhcmVudCkgJiYgIWlzRGlzYWJsZWQoZ3JhbmRwYXJlbnQpICYmICFpc0Rpc2FibGVkKGFuY2VzdG9yKTtcclxuICAgICAgZnVuY3Rpb24gaXNEaXNhYmxlZCAoZWxlbSkge1xyXG4gICAgICAgIHJldHVybiBlbGVtICYmIGVsZW0uaGFzQXR0cmlidXRlICYmIGVsZW0uaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gIH1cclxufVxyXG5JbmtSaXBwbGVTZXJ2aWNlLiRpbmplY3QgPSBbXCIkd2luZG93XCIsIFwiJHRpbWVvdXRcIl07XHJcblxyXG4vKipcclxuICogbm9pbmsvbm9iYXIvbm9zdHJldGNoIGRpcmVjdGl2ZTogbWFrZSBhbnkgZWxlbWVudCB0aGF0IGhhcyBvbmUgb2ZcclxuICogdGhlc2UgYXR0cmlidXRlcyBiZSBnaXZlbiBhIGNvbnRyb2xsZXIsIHNvIHRoYXQgb3RoZXIgZGlyZWN0aXZlcyBjYW5cclxuICogYHJlcXVpcmU6YCB0aGVzZSBhbmQgc2VlIGlmIHRoZXJlIGlzIGEgYG5vPHh4eD5gIHBhcmVudCBhdHRyaWJ1dGUuXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8cGFyZW50IG1kLW5vLWluaz5cclxuICogICA8Y2hpbGQgZGV0ZWN0LW5vPlxyXG4gKiAgIDwvY2hpbGQ+XHJcbiAqIDwvcGFyZW50PlxyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqIDxobGpzIGxhbmc9XCJqc1wiPlxyXG4gKiBteUFwcC5kaXJlY3RpdmUoJ2RldGVjdE5vJywgZnVuY3Rpb24oKSB7XHJcbiAqICAgcmV0dXJuIHtcclxuICogICAgIHJlcXVpcmU6IFsnXj9tZE5vSW5rJywgXj9tZE5vQmFyJ10sXHJcbiAqICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybHMpIHtcclxuICogICAgICAgdmFyIG5vaW5rQ3RybCA9IGN0cmxzWzBdO1xyXG4gKiAgICAgICB2YXIgbm9iYXJDdHJsID0gY3RybHNbMV07XHJcbiAqICAgICAgIGlmIChub0lua0N0cmwpIHtcclxuICogICAgICAgICBhbGVydChcInRoZSBtZC1uby1pbmsgZmxhZyBoYXMgYmVlbiBzcGVjaWZpZWQgb24gYW4gYW5jZXN0b3IhXCIpO1xyXG4gKiAgICAgICB9XHJcbiAqICAgICAgIGlmIChub2JhckN0cmwpIHtcclxuICogICAgICAgICBhbGVydChcInRoZSBtZC1uby1iYXIgZmxhZyBoYXMgYmVlbiBzcGVjaWZpZWQgb24gYW4gYW5jZXN0b3IhXCIpO1xyXG4gKiAgICAgICB9XHJcbiAqICAgICB9XHJcbiAqICAgfTtcclxuICogfSk7XHJcbiAqIDwvaGxqcz5cclxuICovXHJcbmZ1bmN0aW9uIGF0dHJOb0RpcmVjdGl2ZSgpIHtcclxuICByZXR1cm4gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBjb250cm9sbGVyOiBhbmd1bGFyLm5vb3BcclxuICAgIH07XHJcbiAgfTtcclxufVxyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICAvKipcclxuICAgKiBAbmdkb2Mgc2VydmljZVxyXG4gICAqIEBuYW1lICRtZFRhYklua1JpcHBsZVxyXG4gICAqIEBtb2R1bGUgbWF0ZXJpYWwuY29yZVxyXG4gICAqXHJcbiAgICogQGRlc2NyaXB0aW9uXHJcbiAgICogUHJvdmlkZXMgcmlwcGxlIGVmZmVjdHMgZm9yIG1kLXRhYnMuICBTZWUgJG1kSW5rUmlwcGxlIHNlcnZpY2UgZm9yIGFsbCBwb3NzaWJsZSBjb25maWd1cmF0aW9uIG9wdGlvbnMuXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge29iamVjdD19IHNjb3BlIFNjb3BlIHdpdGhpbiB0aGUgY3VycmVudCBjb250ZXh0XHJcbiAgICogQHBhcmFtIHtvYmplY3Q9fSBlbGVtZW50IFRoZSBlbGVtZW50IHRoZSByaXBwbGUgZWZmZWN0IHNob3VsZCBiZSBhcHBsaWVkIHRvXHJcbiAgICogQHBhcmFtIHtvYmplY3Q9fSBvcHRpb25zIChPcHRpb25hbCkgQ29uZmlndXJhdGlvbiBvcHRpb25zIHRvIG92ZXJyaWRlIHRoZSBkZWZhdWx0cmlwcGxlIGNvbmZpZ3VyYXRpb25cclxuICAgKi9cclxuXHJcbiAgYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvcmUnKVxyXG4gICAgLmZhY3RvcnkoJyRtZFRhYklua1JpcHBsZScsIE1kVGFiSW5rUmlwcGxlKTtcclxuXHJcbiAgZnVuY3Rpb24gTWRUYWJJbmtSaXBwbGUoJG1kSW5rUmlwcGxlKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBhdHRhY2g6IGF0dGFjaFxyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiBhdHRhY2goc2NvcGUsIGVsZW1lbnQsIG9wdGlvbnMpIHtcclxuICAgICAgcmV0dXJuICRtZElua1JpcHBsZS5hdHRhY2goc2NvcGUsIGVsZW1lbnQsIGFuZ3VsYXIuZXh0ZW5kKHtcclxuICAgICAgICBjZW50ZXI6IGZhbHNlLFxyXG4gICAgICAgIGRpbUJhY2tncm91bmQ6IHRydWUsXHJcbiAgICAgICAgb3V0bGluZTogZmFsc2UsXHJcbiAgICAgICAgcmlwcGxlU2l6ZTogJ2Z1bGwnXHJcbiAgICAgIH0sIG9wdGlvbnMpKTtcclxuICAgIH07XHJcbiAgfVxyXG4gIE1kVGFiSW5rUmlwcGxlLiRpbmplY3QgPSBbXCIkbWRJbmtSaXBwbGVcIl07O1xyXG59KSgpO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvcmUudGhlbWluZy5wYWxldHRlJywgW10pXHJcbi5jb25zdGFudCgnJG1kQ29sb3JQYWxldHRlJywge1xyXG4gICdyZWQnOiB7XHJcbiAgICAnNTAnOiAnI2ZmZWJlZScsXHJcbiAgICAnMTAwJzogJyNmZmNkZDInLFxyXG4gICAgJzIwMCc6ICcjZWY5YTlhJyxcclxuICAgICczMDAnOiAnI2U1NzM3MycsXHJcbiAgICAnNDAwJzogJyNlZjUzNTAnLFxyXG4gICAgJzUwMCc6ICcjZjQ0MzM2JyxcclxuICAgICc2MDAnOiAnI2U1MzkzNScsXHJcbiAgICAnNzAwJzogJyNkMzJmMmYnLFxyXG4gICAgJzgwMCc6ICcjYzYyODI4JyxcclxuICAgICc5MDAnOiAnI2I3MWMxYycsXHJcbiAgICAnQTEwMCc6ICcjZmY4YTgwJyxcclxuICAgICdBMjAwJzogJyNmZjUyNTInLFxyXG4gICAgJ0E0MDAnOiAnI2ZmMTc0NCcsXHJcbiAgICAnQTcwMCc6ICcjZDUwMDAwJyxcclxuICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdsaWdodCcsXHJcbiAgICAnY29udHJhc3REYXJrQ29sb3JzJzogJzUwIDEwMCAyMDAgMzAwIDQwMCBBMTAwJyxcclxuICAgICdjb250cmFzdFN0cm9uZ0xpZ2h0Q29sb3JzJzogJzUwMCA2MDAgNzAwIEEyMDAgQTQwMCBBNzAwJ1xyXG4gIH0sXHJcbiAgJ3BpbmsnOiB7XHJcbiAgICAnNTAnOiAnI2ZjZTRlYycsXHJcbiAgICAnMTAwJzogJyNmOGJiZDAnLFxyXG4gICAgJzIwMCc6ICcjZjQ4ZmIxJyxcclxuICAgICczMDAnOiAnI2YwNjI5MicsXHJcbiAgICAnNDAwJzogJyNlYzQwN2EnLFxyXG4gICAgJzUwMCc6ICcjZTkxZTYzJyxcclxuICAgICc2MDAnOiAnI2Q4MWI2MCcsXHJcbiAgICAnNzAwJzogJyNjMjE4NWInLFxyXG4gICAgJzgwMCc6ICcjYWQxNDU3JyxcclxuICAgICc5MDAnOiAnIzg4MGU0ZicsXHJcbiAgICAnQTEwMCc6ICcjZmY4MGFiJyxcclxuICAgICdBMjAwJzogJyNmZjQwODEnLFxyXG4gICAgJ0E0MDAnOiAnI2Y1MDA1NycsXHJcbiAgICAnQTcwMCc6ICcjYzUxMTYyJyxcclxuICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdsaWdodCcsXHJcbiAgICAnY29udHJhc3REYXJrQ29sb3JzJzogJzUwIDEwMCAyMDAgMzAwIDQwMCBBMTAwJyxcclxuICAgICdjb250cmFzdFN0cm9uZ0xpZ2h0Q29sb3JzJzogJzUwMCA2MDAgQTIwMCBBNDAwIEE3MDAnXHJcbiAgfSxcclxuICAncHVycGxlJzoge1xyXG4gICAgJzUwJzogJyNmM2U1ZjUnLFxyXG4gICAgJzEwMCc6ICcjZTFiZWU3JyxcclxuICAgICcyMDAnOiAnI2NlOTNkOCcsXHJcbiAgICAnMzAwJzogJyNiYTY4YzgnLFxyXG4gICAgJzQwMCc6ICcjYWI0N2JjJyxcclxuICAgICc1MDAnOiAnIzljMjdiMCcsXHJcbiAgICAnNjAwJzogJyM4ZTI0YWEnLFxyXG4gICAgJzcwMCc6ICcjN2IxZmEyJyxcclxuICAgICc4MDAnOiAnIzZhMWI5YScsXHJcbiAgICAnOTAwJzogJyM0YTE0OGMnLFxyXG4gICAgJ0ExMDAnOiAnI2VhODBmYycsXHJcbiAgICAnQTIwMCc6ICcjZTA0MGZiJyxcclxuICAgICdBNDAwJzogJyNkNTAwZjknLFxyXG4gICAgJ0E3MDAnOiAnI2FhMDBmZicsXHJcbiAgICAnY29udHJhc3REZWZhdWx0Q29sb3InOiAnbGlnaHQnLFxyXG4gICAgJ2NvbnRyYXN0RGFya0NvbG9ycyc6ICc1MCAxMDAgMjAwIEExMDAnLFxyXG4gICAgJ2NvbnRyYXN0U3Ryb25nTGlnaHRDb2xvcnMnOiAnMzAwIDQwMCBBMjAwIEE0MDAgQTcwMCdcclxuICB9LFxyXG4gICdkZWVwLXB1cnBsZSc6IHtcclxuICAgICc1MCc6ICcjZWRlN2Y2JyxcclxuICAgICcxMDAnOiAnI2QxYzRlOScsXHJcbiAgICAnMjAwJzogJyNiMzlkZGInLFxyXG4gICAgJzMwMCc6ICcjOTU3NWNkJyxcclxuICAgICc0MDAnOiAnIzdlNTdjMicsXHJcbiAgICAnNTAwJzogJyM2NzNhYjcnLFxyXG4gICAgJzYwMCc6ICcjNWUzNWIxJyxcclxuICAgICc3MDAnOiAnIzUxMmRhOCcsXHJcbiAgICAnODAwJzogJyM0NTI3YTAnLFxyXG4gICAgJzkwMCc6ICcjMzExYjkyJyxcclxuICAgICdBMTAwJzogJyNiMzg4ZmYnLFxyXG4gICAgJ0EyMDAnOiAnIzdjNGRmZicsXHJcbiAgICAnQTQwMCc6ICcjNjUxZmZmJyxcclxuICAgICdBNzAwJzogJyM2MjAwZWEnLFxyXG4gICAgJ2NvbnRyYXN0RGVmYXVsdENvbG9yJzogJ2xpZ2h0JyxcclxuICAgICdjb250cmFzdERhcmtDb2xvcnMnOiAnNTAgMTAwIDIwMCBBMTAwJyxcclxuICAgICdjb250cmFzdFN0cm9uZ0xpZ2h0Q29sb3JzJzogJzMwMCA0MDAgQTIwMCdcclxuICB9LFxyXG4gICdpbmRpZ28nOiB7XHJcbiAgICAnNTAnOiAnI2U4ZWFmNicsXHJcbiAgICAnMTAwJzogJyNjNWNhZTknLFxyXG4gICAgJzIwMCc6ICcjOWZhOGRhJyxcclxuICAgICczMDAnOiAnIzc5ODZjYicsXHJcbiAgICAnNDAwJzogJyM1YzZiYzAnLFxyXG4gICAgJzUwMCc6ICcjM2Y1MWI1JyxcclxuICAgICc2MDAnOiAnIzM5NDlhYicsXHJcbiAgICAnNzAwJzogJyMzMDNmOWYnLFxyXG4gICAgJzgwMCc6ICcjMjgzNTkzJyxcclxuICAgICc5MDAnOiAnIzFhMjM3ZScsXHJcbiAgICAnQTEwMCc6ICcjOGM5ZWZmJyxcclxuICAgICdBMjAwJzogJyM1MzZkZmUnLFxyXG4gICAgJ0E0MDAnOiAnIzNkNWFmZScsXHJcbiAgICAnQTcwMCc6ICcjMzA0ZmZlJyxcclxuICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdsaWdodCcsXHJcbiAgICAnY29udHJhc3REYXJrQ29sb3JzJzogJzUwIDEwMCAyMDAgQTEwMCcsXHJcbiAgICAnY29udHJhc3RTdHJvbmdMaWdodENvbG9ycyc6ICczMDAgNDAwIEEyMDAgQTQwMCdcclxuICB9LFxyXG4gICdibHVlJzoge1xyXG4gICAgJzUwJzogJyNlM2YyZmQnLFxyXG4gICAgJzEwMCc6ICcjYmJkZWZiJyxcclxuICAgICcyMDAnOiAnIzkwY2FmOScsXHJcbiAgICAnMzAwJzogJyM2NGI1ZjYnLFxyXG4gICAgJzQwMCc6ICcjNDJhNWY1JyxcclxuICAgICc1MDAnOiAnIzIxOTZmMycsXHJcbiAgICAnNjAwJzogJyMxZTg4ZTUnLFxyXG4gICAgJzcwMCc6ICcjMTk3NmQyJyxcclxuICAgICc4MDAnOiAnIzE1NjVjMCcsXHJcbiAgICAnOTAwJzogJyMwZDQ3YTEnLFxyXG4gICAgJ0ExMDAnOiAnIzgyYjFmZicsXHJcbiAgICAnQTIwMCc6ICcjNDQ4YWZmJyxcclxuICAgICdBNDAwJzogJyMyOTc5ZmYnLFxyXG4gICAgJ0E3MDAnOiAnIzI5NjJmZicsXHJcbiAgICAnY29udHJhc3REZWZhdWx0Q29sb3InOiAnbGlnaHQnLFxyXG4gICAgJ2NvbnRyYXN0RGFya0NvbG9ycyc6ICcxMDAgMjAwIDMwMCA0MDAgQTEwMCcsXHJcbiAgICAnY29udHJhc3RTdHJvbmdMaWdodENvbG9ycyc6ICc1MDAgNjAwIDcwMCBBMjAwIEE0MDAgQTcwMCdcclxuICB9LFxyXG4gICdsaWdodC1ibHVlJzoge1xyXG4gICAgJzUwJzogJyNlMWY1ZmUnLFxyXG4gICAgJzEwMCc6ICcjYjNlNWZjJyxcclxuICAgICcyMDAnOiAnIzgxZDRmYScsXHJcbiAgICAnMzAwJzogJyM0ZmMzZjcnLFxyXG4gICAgJzQwMCc6ICcjMjliNmY2JyxcclxuICAgICc1MDAnOiAnIzAzYTlmNCcsXHJcbiAgICAnNjAwJzogJyMwMzliZTUnLFxyXG4gICAgJzcwMCc6ICcjMDI4OGQxJyxcclxuICAgICc4MDAnOiAnIzAyNzdiZCcsXHJcbiAgICAnOTAwJzogJyMwMTU3OWInLFxyXG4gICAgJ0ExMDAnOiAnIzgwZDhmZicsXHJcbiAgICAnQTIwMCc6ICcjNDBjNGZmJyxcclxuICAgICdBNDAwJzogJyMwMGIwZmYnLFxyXG4gICAgJ0E3MDAnOiAnIzAwOTFlYScsXHJcbiAgICAnY29udHJhc3REZWZhdWx0Q29sb3InOiAnZGFyaycsXHJcbiAgICAnY29udHJhc3RMaWdodENvbG9ycyc6ICc1MDAgNjAwIDcwMCA4MDAgOTAwIEE3MDAnLFxyXG4gICAgJ2NvbnRyYXN0U3Ryb25nTGlnaHRDb2xvcnMnOiAnNTAwIDYwMCA3MDAgODAwIEE3MDAnXHJcbiAgfSxcclxuICAnY3lhbic6IHtcclxuICAgICc1MCc6ICcjZTBmN2ZhJyxcclxuICAgICcxMDAnOiAnI2IyZWJmMicsXHJcbiAgICAnMjAwJzogJyM4MGRlZWEnLFxyXG4gICAgJzMwMCc6ICcjNGRkMGUxJyxcclxuICAgICc0MDAnOiAnIzI2YzZkYScsXHJcbiAgICAnNTAwJzogJyMwMGJjZDQnLFxyXG4gICAgJzYwMCc6ICcjMDBhY2MxJyxcclxuICAgICc3MDAnOiAnIzAwOTdhNycsXHJcbiAgICAnODAwJzogJyMwMDgzOGYnLFxyXG4gICAgJzkwMCc6ICcjMDA2MDY0JyxcclxuICAgICdBMTAwJzogJyM4NGZmZmYnLFxyXG4gICAgJ0EyMDAnOiAnIzE4ZmZmZicsXHJcbiAgICAnQTQwMCc6ICcjMDBlNWZmJyxcclxuICAgICdBNzAwJzogJyMwMGI4ZDQnLFxyXG4gICAgJ2NvbnRyYXN0RGVmYXVsdENvbG9yJzogJ2RhcmsnLFxyXG4gICAgJ2NvbnRyYXN0TGlnaHRDb2xvcnMnOiAnNTAwIDYwMCA3MDAgODAwIDkwMCcsXHJcbiAgICAnY29udHJhc3RTdHJvbmdMaWdodENvbG9ycyc6ICc1MDAgNjAwIDcwMCA4MDAnXHJcbiAgfSxcclxuICAndGVhbCc6IHtcclxuICAgICc1MCc6ICcjZTBmMmYxJyxcclxuICAgICcxMDAnOiAnI2IyZGZkYicsXHJcbiAgICAnMjAwJzogJyM4MGNiYzQnLFxyXG4gICAgJzMwMCc6ICcjNGRiNmFjJyxcclxuICAgICc0MDAnOiAnIzI2YTY5YScsXHJcbiAgICAnNTAwJzogJyMwMDk2ODgnLFxyXG4gICAgJzYwMCc6ICcjMDA4OTdiJyxcclxuICAgICc3MDAnOiAnIzAwNzk2YicsXHJcbiAgICAnODAwJzogJyMwMDY5NWMnLFxyXG4gICAgJzkwMCc6ICcjMDA0ZDQwJyxcclxuICAgICdBMTAwJzogJyNhN2ZmZWInLFxyXG4gICAgJ0EyMDAnOiAnIzY0ZmZkYScsXHJcbiAgICAnQTQwMCc6ICcjMWRlOWI2JyxcclxuICAgICdBNzAwJzogJyMwMGJmYTUnLFxyXG4gICAgJ2NvbnRyYXN0RGVmYXVsdENvbG9yJzogJ2RhcmsnLFxyXG4gICAgJ2NvbnRyYXN0TGlnaHRDb2xvcnMnOiAnNTAwIDYwMCA3MDAgODAwIDkwMCcsXHJcbiAgICAnY29udHJhc3RTdHJvbmdMaWdodENvbG9ycyc6ICc1MDAgNjAwIDcwMCdcclxuICB9LFxyXG4gICdncmVlbic6IHtcclxuICAgICc1MCc6ICcjZThmNWU5JyxcclxuICAgICcxMDAnOiAnI2M4ZTZjOScsXHJcbiAgICAnMjAwJzogJyNhNWQ2YTcnLFxyXG4gICAgJzMwMCc6ICcjODFjNzg0JyxcclxuICAgICc0MDAnOiAnIzY2YmI2YScsXHJcbiAgICAnNTAwJzogJyM0Y2FmNTAnLFxyXG4gICAgJzYwMCc6ICcjNDNhMDQ3JyxcclxuICAgICc3MDAnOiAnIzM4OGUzYycsXHJcbiAgICAnODAwJzogJyMyZTdkMzInLFxyXG4gICAgJzkwMCc6ICcjMWI1ZTIwJyxcclxuICAgICdBMTAwJzogJyNiOWY2Y2EnLFxyXG4gICAgJ0EyMDAnOiAnIzY5ZjBhZScsXHJcbiAgICAnQTQwMCc6ICcjMDBlNjc2JyxcclxuICAgICdBNzAwJzogJyMwMGM4NTMnLFxyXG4gICAgJ2NvbnRyYXN0RGVmYXVsdENvbG9yJzogJ2RhcmsnLFxyXG4gICAgJ2NvbnRyYXN0TGlnaHRDb2xvcnMnOiAnNTAwIDYwMCA3MDAgODAwIDkwMCcsXHJcbiAgICAnY29udHJhc3RTdHJvbmdMaWdodENvbG9ycyc6ICc1MDAgNjAwIDcwMCdcclxuICB9LFxyXG4gICdsaWdodC1ncmVlbic6IHtcclxuICAgICc1MCc6ICcjZjFmOGU5JyxcclxuICAgICcxMDAnOiAnI2RjZWRjOCcsXHJcbiAgICAnMjAwJzogJyNjNWUxYTUnLFxyXG4gICAgJzMwMCc6ICcjYWVkNTgxJyxcclxuICAgICc0MDAnOiAnIzljY2M2NScsXHJcbiAgICAnNTAwJzogJyM4YmMzNGEnLFxyXG4gICAgJzYwMCc6ICcjN2NiMzQyJyxcclxuICAgICc3MDAnOiAnIzY4OWYzOCcsXHJcbiAgICAnODAwJzogJyM1NThiMmYnLFxyXG4gICAgJzkwMCc6ICcjMzM2OTFlJyxcclxuICAgICdBMTAwJzogJyNjY2ZmOTAnLFxyXG4gICAgJ0EyMDAnOiAnI2IyZmY1OScsXHJcbiAgICAnQTQwMCc6ICcjNzZmZjAzJyxcclxuICAgICdBNzAwJzogJyM2NGRkMTcnLFxyXG4gICAgJ2NvbnRyYXN0RGVmYXVsdENvbG9yJzogJ2RhcmsnLFxyXG4gICAgJ2NvbnRyYXN0TGlnaHRDb2xvcnMnOiAnODAwIDkwMCcsXHJcbiAgICAnY29udHJhc3RTdHJvbmdMaWdodENvbG9ycyc6ICc4MDAgOTAwJ1xyXG4gIH0sXHJcbiAgJ2xpbWUnOiB7XHJcbiAgICAnNTAnOiAnI2Y5ZmJlNycsXHJcbiAgICAnMTAwJzogJyNmMGY0YzMnLFxyXG4gICAgJzIwMCc6ICcjZTZlZTljJyxcclxuICAgICczMDAnOiAnI2RjZTc3NScsXHJcbiAgICAnNDAwJzogJyNkNGUxNTcnLFxyXG4gICAgJzUwMCc6ICcjY2RkYzM5JyxcclxuICAgICc2MDAnOiAnI2MwY2EzMycsXHJcbiAgICAnNzAwJzogJyNhZmI0MmInLFxyXG4gICAgJzgwMCc6ICcjOWU5ZDI0JyxcclxuICAgICc5MDAnOiAnIzgyNzcxNycsXHJcbiAgICAnQTEwMCc6ICcjZjRmZjgxJyxcclxuICAgICdBMjAwJzogJyNlZWZmNDEnLFxyXG4gICAgJ0E0MDAnOiAnI2M2ZmYwMCcsXHJcbiAgICAnQTcwMCc6ICcjYWVlYTAwJyxcclxuICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdkYXJrJyxcclxuICAgICdjb250cmFzdExpZ2h0Q29sb3JzJzogJzkwMCcsXHJcbiAgICAnY29udHJhc3RTdHJvbmdMaWdodENvbG9ycyc6ICc5MDAnXHJcbiAgfSxcclxuICAneWVsbG93Jzoge1xyXG4gICAgJzUwJzogJyNmZmZkZTcnLFxyXG4gICAgJzEwMCc6ICcjZmZmOWM0JyxcclxuICAgICcyMDAnOiAnI2ZmZjU5ZCcsXHJcbiAgICAnMzAwJzogJyNmZmYxNzYnLFxyXG4gICAgJzQwMCc6ICcjZmZlZTU4JyxcclxuICAgICc1MDAnOiAnI2ZmZWIzYicsXHJcbiAgICAnNjAwJzogJyNmZGQ4MzUnLFxyXG4gICAgJzcwMCc6ICcjZmJjMDJkJyxcclxuICAgICc4MDAnOiAnI2Y5YTgyNScsXHJcbiAgICAnOTAwJzogJyNmNTdmMTcnLFxyXG4gICAgJ0ExMDAnOiAnI2ZmZmY4ZCcsXHJcbiAgICAnQTIwMCc6ICcjZmZmZjAwJyxcclxuICAgICdBNDAwJzogJyNmZmVhMDAnLFxyXG4gICAgJ0E3MDAnOiAnI2ZmZDYwMCcsXHJcbiAgICAnY29udHJhc3REZWZhdWx0Q29sb3InOiAnZGFyaydcclxuICB9LFxyXG4gICdhbWJlcic6IHtcclxuICAgICc1MCc6ICcjZmZmOGUxJyxcclxuICAgICcxMDAnOiAnI2ZmZWNiMycsXHJcbiAgICAnMjAwJzogJyNmZmUwODInLFxyXG4gICAgJzMwMCc6ICcjZmZkNTRmJyxcclxuICAgICc0MDAnOiAnI2ZmY2EyOCcsXHJcbiAgICAnNTAwJzogJyNmZmMxMDcnLFxyXG4gICAgJzYwMCc6ICcjZmZiMzAwJyxcclxuICAgICc3MDAnOiAnI2ZmYTAwMCcsXHJcbiAgICAnODAwJzogJyNmZjhmMDAnLFxyXG4gICAgJzkwMCc6ICcjZmY2ZjAwJyxcclxuICAgICdBMTAwJzogJyNmZmU1N2YnLFxyXG4gICAgJ0EyMDAnOiAnI2ZmZDc0MCcsXHJcbiAgICAnQTQwMCc6ICcjZmZjNDAwJyxcclxuICAgICdBNzAwJzogJyNmZmFiMDAnLFxyXG4gICAgJ2NvbnRyYXN0RGVmYXVsdENvbG9yJzogJ2RhcmsnXHJcbiAgfSxcclxuICAnb3JhbmdlJzoge1xyXG4gICAgJzUwJzogJyNmZmYzZTAnLFxyXG4gICAgJzEwMCc6ICcjZmZlMGIyJyxcclxuICAgICcyMDAnOiAnI2ZmY2M4MCcsXHJcbiAgICAnMzAwJzogJyNmZmI3NGQnLFxyXG4gICAgJzQwMCc6ICcjZmZhNzI2JyxcclxuICAgICc1MDAnOiAnI2ZmOTgwMCcsXHJcbiAgICAnNjAwJzogJyNmYjhjMDAnLFxyXG4gICAgJzcwMCc6ICcjZjU3YzAwJyxcclxuICAgICc4MDAnOiAnI2VmNmMwMCcsXHJcbiAgICAnOTAwJzogJyNlNjUxMDAnLFxyXG4gICAgJ0ExMDAnOiAnI2ZmZDE4MCcsXHJcbiAgICAnQTIwMCc6ICcjZmZhYjQwJyxcclxuICAgICdBNDAwJzogJyNmZjkxMDAnLFxyXG4gICAgJ0E3MDAnOiAnI2ZmNmQwMCcsXHJcbiAgICAnY29udHJhc3REZWZhdWx0Q29sb3InOiAnZGFyaycsXHJcbiAgICAnY29udHJhc3RMaWdodENvbG9ycyc6ICc4MDAgOTAwJyxcclxuICAgICdjb250cmFzdFN0cm9uZ0xpZ2h0Q29sb3JzJzogJzgwMCA5MDAnXHJcbiAgfSxcclxuICAnZGVlcC1vcmFuZ2UnOiB7XHJcbiAgICAnNTAnOiAnI2ZiZTllNycsXHJcbiAgICAnMTAwJzogJyNmZmNjYmMnLFxyXG4gICAgJzIwMCc6ICcjZmZhYjkxJyxcclxuICAgICczMDAnOiAnI2ZmOGE2NScsXHJcbiAgICAnNDAwJzogJyNmZjcwNDMnLFxyXG4gICAgJzUwMCc6ICcjZmY1NzIyJyxcclxuICAgICc2MDAnOiAnI2Y0NTExZScsXHJcbiAgICAnNzAwJzogJyNlNjRhMTknLFxyXG4gICAgJzgwMCc6ICcjZDg0MzE1JyxcclxuICAgICc5MDAnOiAnI2JmMzYwYycsXHJcbiAgICAnQTEwMCc6ICcjZmY5ZTgwJyxcclxuICAgICdBMjAwJzogJyNmZjZlNDAnLFxyXG4gICAgJ0E0MDAnOiAnI2ZmM2QwMCcsXHJcbiAgICAnQTcwMCc6ICcjZGQyYzAwJyxcclxuICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdsaWdodCcsXHJcbiAgICAnY29udHJhc3REYXJrQ29sb3JzJzogJzUwIDEwMCAyMDAgMzAwIDQwMCBBMTAwIEEyMDAnLFxyXG4gICAgJ2NvbnRyYXN0U3Ryb25nTGlnaHRDb2xvcnMnOiAnNTAwIDYwMCA3MDAgODAwIDkwMCBBNDAwIEE3MDAnXHJcbiAgfSxcclxuICAnYnJvd24nOiB7XHJcbiAgICAnNTAnOiAnI2VmZWJlOScsXHJcbiAgICAnMTAwJzogJyNkN2NjYzgnLFxyXG4gICAgJzIwMCc6ICcjYmNhYWE0JyxcclxuICAgICczMDAnOiAnI2ExODg3ZicsXHJcbiAgICAnNDAwJzogJyM4ZDZlNjMnLFxyXG4gICAgJzUwMCc6ICcjNzk1NTQ4JyxcclxuICAgICc2MDAnOiAnIzZkNGM0MScsXHJcbiAgICAnNzAwJzogJyM1ZDQwMzcnLFxyXG4gICAgJzgwMCc6ICcjNGUzNDJlJyxcclxuICAgICc5MDAnOiAnIzNlMjcyMycsXHJcbiAgICAnQTEwMCc6ICcjZDdjY2M4JyxcclxuICAgICdBMjAwJzogJyNiY2FhYTQnLFxyXG4gICAgJ0E0MDAnOiAnIzhkNmU2MycsXHJcbiAgICAnQTcwMCc6ICcjNWQ0MDM3JyxcclxuICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdsaWdodCcsXHJcbiAgICAnY29udHJhc3REYXJrQ29sb3JzJzogJzUwIDEwMCAyMDAnLFxyXG4gICAgJ2NvbnRyYXN0U3Ryb25nTGlnaHRDb2xvcnMnOiAnMzAwIDQwMCdcclxuICB9LFxyXG4gICdncmV5Jzoge1xyXG4gICAgJzUwJzogJyNmYWZhZmEnLFxyXG4gICAgJzEwMCc6ICcjZjVmNWY1JyxcclxuICAgICcyMDAnOiAnI2VlZWVlZScsXHJcbiAgICAnMzAwJzogJyNlMGUwZTAnLFxyXG4gICAgJzQwMCc6ICcjYmRiZGJkJyxcclxuICAgICc1MDAnOiAnIzllOWU5ZScsXHJcbiAgICAnNjAwJzogJyM3NTc1NzUnLFxyXG4gICAgJzcwMCc6ICcjNjE2MTYxJyxcclxuICAgICc4MDAnOiAnIzQyNDI0MicsXHJcbiAgICAnOTAwJzogJyMyMTIxMjEnLFxyXG4gICAgJzEwMDAnOiAnIzAwMDAwMCcsXHJcbiAgICAnQTEwMCc6ICcjZmZmZmZmJyxcclxuICAgICdBMjAwJzogJyNlZWVlZWUnLFxyXG4gICAgJ0E0MDAnOiAnI2JkYmRiZCcsXHJcbiAgICAnQTcwMCc6ICcjNjE2MTYxJyxcclxuICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdkYXJrJyxcclxuICAgICdjb250cmFzdExpZ2h0Q29sb3JzJzogJzYwMCA3MDAgODAwIDkwMCdcclxuICB9LFxyXG4gICdibHVlLWdyZXknOiB7XHJcbiAgICAnNTAnOiAnI2VjZWZmMScsXHJcbiAgICAnMTAwJzogJyNjZmQ4ZGMnLFxyXG4gICAgJzIwMCc6ICcjYjBiZWM1JyxcclxuICAgICczMDAnOiAnIzkwYTRhZScsXHJcbiAgICAnNDAwJzogJyM3ODkwOWMnLFxyXG4gICAgJzUwMCc6ICcjNjA3ZDhiJyxcclxuICAgICc2MDAnOiAnIzU0NmU3YScsXHJcbiAgICAnNzAwJzogJyM0NTVhNjQnLFxyXG4gICAgJzgwMCc6ICcjMzc0NzRmJyxcclxuICAgICc5MDAnOiAnIzI2MzIzOCcsXHJcbiAgICAnQTEwMCc6ICcjY2ZkOGRjJyxcclxuICAgICdBMjAwJzogJyNiMGJlYzUnLFxyXG4gICAgJ0E0MDAnOiAnIzc4OTA5YycsXHJcbiAgICAnQTcwMCc6ICcjNDU1YTY0JyxcclxuICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdsaWdodCcsXHJcbiAgICAnY29udHJhc3REYXJrQ29sb3JzJzogJzUwIDEwMCAyMDAgMzAwJyxcclxuICAgICdjb250cmFzdFN0cm9uZ0xpZ2h0Q29sb3JzJzogJzQwMCA1MDAnXHJcbiAgfVxyXG59KTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb3JlLnRoZW1pbmcnLCBbJ21hdGVyaWFsLmNvcmUudGhlbWluZy5wYWxldHRlJ10pXHJcbiAgLmRpcmVjdGl2ZSgnbWRUaGVtZScsIFRoZW1pbmdEaXJlY3RpdmUpXHJcbiAgLmRpcmVjdGl2ZSgnbWRUaGVtYWJsZScsIFRoZW1hYmxlRGlyZWN0aXZlKVxyXG4gIC5wcm92aWRlcignJG1kVGhlbWluZycsIFRoZW1pbmdQcm92aWRlcilcclxuICAucnVuKGdlbmVyYXRlVGhlbWVzKTtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgcHJvdmlkZXJcclxuICogQG5hbWUgJG1kVGhlbWluZ1Byb3ZpZGVyXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29yZVxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb24gUHJvdmlkZXIgdG8gY29uZmlndXJlIHRoZSBgJG1kVGhlbWluZ2Agc2VydmljZS5cclxuICovXHJcblxyXG4vKipcclxuICogQG5nZG9jIG1ldGhvZFxyXG4gKiBAbmFtZSAkbWRUaGVtaW5nUHJvdmlkZXIjc2V0RGVmYXVsdFRoZW1lXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSB0aGVtZU5hbWUgRGVmYXVsdCB0aGVtZSBuYW1lIHRvIGJlIGFwcGxpZWQgdG8gZWxlbWVudHMuIERlZmF1bHQgdmFsdWUgaXMgYGRlZmF1bHRgLlxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbWV0aG9kXHJcbiAqIEBuYW1lICRtZFRoZW1pbmdQcm92aWRlciNhbHdheXNXYXRjaFRoZW1lXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gd2F0Y2ggV2hldGhlciBvciBub3QgdG8gYWx3YXlzIHdhdGNoIHRoZW1lcyBmb3IgY2hhbmdlcyBhbmQgcmUtYXBwbHlcclxuICogY2xhc3NlcyB3aGVuIHRoZXkgY2hhbmdlLiBEZWZhdWx0IGlzIGBmYWxzZWAuIEVuYWJsaW5nIGNhbiByZWR1Y2UgcGVyZm9ybWFuY2UuXHJcbiAqL1xyXG5cclxuLyogU29tZSBFeGFtcGxlIFZhbGlkIFRoZW1pbmcgRXhwcmVzc2lvbnNcclxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAqXHJcbiAqIEludGVudGlvbiBncm91cCBleHBhbnNpb246ICh2YWxpZCBmb3IgcHJpbWFyeSwgYWNjZW50LCB3YXJuLCBiYWNrZ3JvdW5kKVxyXG4gKlxyXG4gKiB7e3ByaW1hcnktMTAwfX0gLSBncmFiIHNoYWRlIDEwMCBmcm9tIHRoZSBwcmltYXJ5IHBhbGV0dGVcclxuICoge3twcmltYXJ5LTEwMC0wLjd9fSAtIGdyYWIgc2hhZGUgMTAwLCBhcHBseSBvcGFjaXR5IG9mIDAuN1xyXG4gKiB7e3ByaW1hcnktaHVlLTF9fSAtIGdyYWIgdGhlIHNoYWRlIGFzc2lnbmVkIHRvIGh1ZS0xIGZyb20gdGhlIHByaW1hcnkgcGFsZXR0ZVxyXG4gKiB7e3ByaW1hcnktaHVlLTEtMC43fX0gLSBhcHBseSAwLjcgb3BhY2l0eSB0byBwcmltYXJ5LWh1ZS0xXHJcbiAqIHt7cHJpbWFyeS1jb2xvcn19IC0gR2VuZXJhdGVzIC5tZC1odWUtMSwgLm1kLWh1ZS0yLCAubWQtaHVlLTMgd2l0aCBjb25maWd1cmVkIHNoYWRlcyBzZXQgZm9yIGVhY2ggaHVlXHJcbiAqIHt7cHJpbWFyeS1jb2xvci0wLjd9fSAtIEFwcGx5IDAuNyBvcGFjaXR5IHRvIGVhY2ggb2YgdGhlIGFib3ZlIHJ1bGVzXHJcbiAqIHt7cHJpbWFyeS1jb250cmFzdH19IC0gR2VuZXJhdGVzIC5tZC1odWUtMSwgLm1kLWh1ZS0yLCAubWQtaHVlLTMgd2l0aCBjb25maWd1cmVkIGNvbnRyYXN0IChpZS4gdGV4dCkgY29sb3Igc2hhZGVzIHNldCBmb3IgZWFjaCBodWVcclxuICoge3twcmltYXJ5LWNvbnRyYXN0LTAuN319IC0gQXBwbHkgMC43IG9wYWNpdHkgdG8gZWFjaCBvZiB0aGUgYWJvdmUgcnVsZXNcclxuICpcclxuICogRm9yZWdyb3VuZCBleHBhbnNpb246IEFwcGxpZXMgcmdiYSB0byBibGFjay93aGl0ZSBmb3JlZ3JvdW5kIHRleHRcclxuICpcclxuICoge3tmb3JlZ3JvdW5kLTF9fSAtIHVzZWQgZm9yIHByaW1hcnkgdGV4dFxyXG4gKiB7e2ZvcmVncm91bmQtMn19IC0gdXNlZCBmb3Igc2Vjb25kYXJ5IHRleHQvZGl2aWRlclxyXG4gKiB7e2ZvcmVncm91bmQtM319IC0gdXNlZCBmb3IgZGlzYWJsZWQgdGV4dFxyXG4gKiB7e2ZvcmVncm91bmQtNH19IC0gdXNlZCBmb3IgZGl2aWRlcnNcclxuICpcclxuICovXHJcblxyXG4vLyBJbiBtZW1vcnkgZ2VuZXJhdGVkIENTUyBydWxlczsgcmVnaXN0ZXJlZCBieSB0aGVtZS5uYW1lXHJcbnZhciBHRU5FUkFURUQgPSB7IH07XHJcblxyXG4vLyBJbiBtZW1vcnkgc3RvcmFnZSBvZiBkZWZpbmVkIHRoZW1lcyBhbmQgY29sb3IgcGFsZXR0ZXMgKGJvdGggbG9hZGVkIGJ5IENTUywgYW5kIHVzZXIgc3BlY2lmaWVkKVxyXG52YXIgUEFMRVRURVM7XHJcbnZhciBUSEVNRVM7XHJcblxyXG52YXIgREFSS19GT1JFR1JPVU5EID0ge1xyXG4gIG5hbWU6ICdkYXJrJyxcclxuICAnMSc6ICdyZ2JhKDAsMCwwLDAuODcpJyxcclxuICAnMic6ICdyZ2JhKDAsMCwwLDAuNTQpJyxcclxuICAnMyc6ICdyZ2JhKDAsMCwwLDAuMjYpJyxcclxuICAnNCc6ICdyZ2JhKDAsMCwwLDAuMTIpJ1xyXG59O1xyXG52YXIgTElHSFRfRk9SRUdST1VORCA9IHtcclxuICBuYW1lOiAnbGlnaHQnLFxyXG4gICcxJzogJ3JnYmEoMjU1LDI1NSwyNTUsMS4wKScsXHJcbiAgJzInOiAncmdiYSgyNTUsMjU1LDI1NSwwLjcpJyxcclxuICAnMyc6ICdyZ2JhKDI1NSwyNTUsMjU1LDAuMyknLFxyXG4gICc0JzogJ3JnYmEoMjU1LDI1NSwyNTUsMC4xMiknXHJcbn07XHJcblxyXG52YXIgREFSS19TSEFET1cgPSAnMXB4IDFweCAwcHggcmdiYSgwLDAsMCwwLjQpLCAtMXB4IC0xcHggMHB4IHJnYmEoMCwwLDAsMC40KSc7XHJcbnZhciBMSUdIVF9TSEFET1cgPSAnJztcclxuXHJcbnZhciBEQVJLX0NPTlRSQVNUX0NPTE9SID0gY29sb3JUb1JnYmFBcnJheSgncmdiYSgwLDAsMCwwLjg3KScpO1xyXG52YXIgTElHSFRfQ09OVFJBU1RfQ09MT1IgPSBjb2xvclRvUmdiYUFycmF5KCdyZ2JhKDI1NSwyNTUsMjU1LDAuODcnKTtcclxudmFyIFNUUk9OR19MSUdIVF9DT05UUkFTVF9DT0xPUiA9IGNvbG9yVG9SZ2JhQXJyYXkoJ3JnYigyNTUsMjU1LDI1NSknKTtcclxuXHJcbnZhciBUSEVNRV9DT0xPUl9UWVBFUyA9IFsncHJpbWFyeScsICdhY2NlbnQnLCAnd2FybicsICdiYWNrZ3JvdW5kJ107XHJcbnZhciBERUZBVUxUX0NPTE9SX1RZUEUgPSAncHJpbWFyeSc7XHJcblxyXG4vLyBBIGNvbG9yIGluIGEgdGhlbWUgd2lsbCB1c2UgdGhlc2UgaHVlcyBieSBkZWZhdWx0LCBpZiBub3Qgc3BlY2lmaWVkIGJ5IHVzZXIuXHJcbnZhciBMSUdIVF9ERUZBVUxUX0hVRVMgPSB7XHJcbiAgJ2FjY2VudCc6IHtcclxuICAgICdkZWZhdWx0JzogJ0EyMDAnLFxyXG4gICAgJ2h1ZS0xJzogJ0ExMDAnLFxyXG4gICAgJ2h1ZS0yJzogJ0E0MDAnLFxyXG4gICAgJ2h1ZS0zJzogJ0E3MDAnXHJcbiAgfSxcclxuICAnYmFja2dyb3VuZCc6IHtcclxuICAgICdkZWZhdWx0JzogJ0ExMDAnLFxyXG4gICAgJ2h1ZS0xJzogJzMwMCcsXHJcbiAgICAnaHVlLTInOiAnODAwJyxcclxuICAgICdodWUtMyc6ICc5MDAnXHJcbiAgfVxyXG59O1xyXG5cclxudmFyIERBUktfREVGQVVMVF9IVUVTID0ge1xyXG4gICdiYWNrZ3JvdW5kJzoge1xyXG4gICAgJ2RlZmF1bHQnOiAnODAwJyxcclxuICAgICdodWUtMSc6ICczMDAnLFxyXG4gICAgJ2h1ZS0yJzogJzYwMCcsXHJcbiAgICAnaHVlLTMnOiAnOTAwJ1xyXG4gIH1cclxufTtcclxuVEhFTUVfQ09MT1JfVFlQRVMuZm9yRWFjaChmdW5jdGlvbihjb2xvclR5cGUpIHtcclxuICAvLyBDb2xvciB0eXBlcyB3aXRoIHVuc3BlY2lmaWVkIGRlZmF1bHQgaHVlcyB3aWxsIHVzZSB0aGVzZSBkZWZhdWx0IGh1ZSB2YWx1ZXNcclxuICB2YXIgZGVmYXVsdERlZmF1bHRIdWVzID0ge1xyXG4gICAgJ2RlZmF1bHQnOiAnNTAwJyxcclxuICAgICdodWUtMSc6ICczMDAnLFxyXG4gICAgJ2h1ZS0yJzogJzgwMCcsXHJcbiAgICAnaHVlLTMnOiAnQTEwMCdcclxuICB9O1xyXG4gIGlmICghTElHSFRfREVGQVVMVF9IVUVTW2NvbG9yVHlwZV0pIExJR0hUX0RFRkFVTFRfSFVFU1tjb2xvclR5cGVdID0gZGVmYXVsdERlZmF1bHRIdWVzO1xyXG4gIGlmICghREFSS19ERUZBVUxUX0hVRVNbY29sb3JUeXBlXSkgREFSS19ERUZBVUxUX0hVRVNbY29sb3JUeXBlXSA9IGRlZmF1bHREZWZhdWx0SHVlcztcclxufSk7XHJcblxyXG52YXIgVkFMSURfSFVFX1ZBTFVFUyA9IFtcclxuICAnNTAnLCAnMTAwJywgJzIwMCcsICczMDAnLCAnNDAwJywgJzUwMCcsICc2MDAnLFxyXG4gICc3MDAnLCAnODAwJywgJzkwMCcsICdBMTAwJywgJ0EyMDAnLCAnQTQwMCcsICdBNzAwJ1xyXG5dO1xyXG5cclxuZnVuY3Rpb24gVGhlbWluZ1Byb3ZpZGVyKCRtZENvbG9yUGFsZXR0ZSkge1xyXG4gIFBBTEVUVEVTID0geyB9O1xyXG4gIFRIRU1FUyA9IHsgfTtcclxuXHJcbiAgdmFyIHRoZW1pbmdQcm92aWRlcjtcclxuICB2YXIgZGVmYXVsdFRoZW1lID0gJ2RlZmF1bHQnO1xyXG4gIHZhciBhbHdheXNXYXRjaFRoZW1lID0gZmFsc2U7XHJcblxyXG4gIC8vIExvYWQgSlMgRGVmaW5lZCBQYWxldHRlc1xyXG4gIGFuZ3VsYXIuZXh0ZW5kKFBBTEVUVEVTLCAkbWRDb2xvclBhbGV0dGUpO1xyXG5cclxuICAvLyBEZWZhdWx0IHRoZW1lIGRlZmluZWQgaW4gY29yZS5qc1xyXG5cclxuICBUaGVtaW5nU2VydmljZS4kaW5qZWN0ID0gW1wiJHJvb3RTY29wZVwiLCBcIiRsb2dcIl07XHJcbiAgcmV0dXJuIHRoZW1pbmdQcm92aWRlciA9IHtcclxuICAgIGRlZmluZVBhbGV0dGU6IGRlZmluZVBhbGV0dGUsXHJcbiAgICBleHRlbmRQYWxldHRlOiBleHRlbmRQYWxldHRlLFxyXG4gICAgdGhlbWU6IHJlZ2lzdGVyVGhlbWUsXHJcblxyXG4gICAgc2V0RGVmYXVsdFRoZW1lOiBmdW5jdGlvbih0aGVtZSkge1xyXG4gICAgICBkZWZhdWx0VGhlbWUgPSB0aGVtZTtcclxuICAgIH0sXHJcbiAgICBhbHdheXNXYXRjaFRoZW1lOiBmdW5jdGlvbihhbHdheXNXYXRjaCkge1xyXG4gICAgICBhbHdheXNXYXRjaFRoZW1lID0gYWx3YXlzV2F0Y2g7XHJcbiAgICB9LFxyXG4gICAgJGdldDogVGhlbWluZ1NlcnZpY2UsXHJcbiAgICBfTElHSFRfREVGQVVMVF9IVUVTOiBMSUdIVF9ERUZBVUxUX0hVRVMsXHJcbiAgICBfREFSS19ERUZBVUxUX0hVRVM6IERBUktfREVGQVVMVF9IVUVTLFxyXG4gICAgX1BBTEVUVEVTOiBQQUxFVFRFUyxcclxuICAgIF9USEVNRVM6IFRIRU1FUyxcclxuICAgIF9wYXJzZVJ1bGVzOiBwYXJzZVJ1bGVzLFxyXG4gICAgX3JnYmE6IHJnYmFcclxuICB9O1xyXG5cclxuICAvLyBFeGFtcGxlOiAkbWRUaGVtaW5nUHJvdmlkZXIuZGVmaW5lUGFsZXR0ZSgnbmVvblJlZCcsIHsgNTA6ICcjZjVmYWZhJywgLi4uIH0pO1xyXG4gIGZ1bmN0aW9uIGRlZmluZVBhbGV0dGUobmFtZSwgbWFwKSB7XHJcbiAgICBtYXAgPSBtYXAgfHwge307XHJcbiAgICBQQUxFVFRFU1tuYW1lXSA9IGNoZWNrUGFsZXR0ZVZhbGlkKG5hbWUsIG1hcCk7XHJcbiAgICByZXR1cm4gdGhlbWluZ1Byb3ZpZGVyO1xyXG4gIH1cclxuXHJcbiAgLy8gUmV0dXJucyBhbiBuZXcgb2JqZWN0IHdoaWNoIGlzIGEgY29weSBvZiBhIGdpdmVuIHBhbGV0dGUgYG5hbWVgIHdpdGggdmFyaWFibGVzIGZyb21cclxuICAvLyBgbWFwYCBvdmVyd3JpdHRlblxyXG4gIC8vIEV4YW1wbGU6IHZhciBuZW9uUmVkTWFwID0gJG1kVGhlbWluZ1Byb3ZpZGVyLmV4dGVuZFBhbGV0dGUoJ3JlZCcsIHsgNTA6ICcjZjVmYWZhZmEnIH0pO1xyXG4gIGZ1bmN0aW9uIGV4dGVuZFBhbGV0dGUobmFtZSwgbWFwKSB7XHJcbiAgICByZXR1cm4gY2hlY2tQYWxldHRlVmFsaWQobmFtZSwgIGFuZ3VsYXIuZXh0ZW5kKHt9LCBQQUxFVFRFU1tuYW1lXSB8fCB7fSwgbWFwKSApO1xyXG4gIH1cclxuXHJcbiAgLy8gTWFrZSBzdXJlIHRoYXQgcGFsZXR0ZSBoYXMgYWxsIHJlcXVpcmVkIGh1ZXNcclxuICBmdW5jdGlvbiBjaGVja1BhbGV0dGVWYWxpZChuYW1lLCBtYXApIHtcclxuICAgIHZhciBtaXNzaW5nQ29sb3JzID0gVkFMSURfSFVFX1ZBTFVFUy5maWx0ZXIoZnVuY3Rpb24oZmllbGQpIHtcclxuICAgICAgcmV0dXJuICFtYXBbZmllbGRdO1xyXG4gICAgfSk7XHJcbiAgICBpZiAobWlzc2luZ0NvbG9ycy5sZW5ndGgpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWlzc2luZyBjb2xvcnMgJTEgaW4gcGFsZXR0ZSAlMiFcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoJyUxJywgbWlzc2luZ0NvbG9ycy5qb2luKCcsICcpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoJyUyJywgbmFtZSkpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBtYXA7XHJcbiAgfVxyXG5cclxuICAvLyBSZWdpc3RlciBhIHRoZW1lICh3aGljaCBpcyBhIGNvbGxlY3Rpb24gb2YgY29sb3IgcGFsZXR0ZXMgdG8gdXNlIHdpdGggdmFyaW91cyBzdGF0ZXNcclxuICAvLyBpZS4gd2FybiwgYWNjZW50LCBwcmltYXJ5IClcclxuICAvLyBPcHRpb25hbGx5IGluaGVyaXQgZnJvbSBhbiBleGlzdGluZyB0aGVtZVxyXG4gIC8vICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnY3VzdG9tLXRoZW1lJykucHJpbWFyeVBhbGV0dGUoJ3JlZCcpO1xyXG4gIGZ1bmN0aW9uIHJlZ2lzdGVyVGhlbWUobmFtZSwgaW5oZXJpdEZyb20pIHtcclxuICAgIGlmIChUSEVNRVNbbmFtZV0pIHJldHVybiBUSEVNRVNbbmFtZV07XHJcblxyXG4gICAgaW5oZXJpdEZyb20gPSBpbmhlcml0RnJvbSB8fCAnZGVmYXVsdCc7XHJcblxyXG4gICAgdmFyIHBhcmVudFRoZW1lID0gdHlwZW9mIGluaGVyaXRGcm9tID09PSAnc3RyaW5nJyA/IFRIRU1FU1tpbmhlcml0RnJvbV0gOiBpbmhlcml0RnJvbTtcclxuICAgIHZhciB0aGVtZSA9IG5ldyBUaGVtZShuYW1lKTtcclxuXHJcbiAgICBpZiAocGFyZW50VGhlbWUpIHtcclxuICAgICAgYW5ndWxhci5mb3JFYWNoKHBhcmVudFRoZW1lLmNvbG9ycywgZnVuY3Rpb24oY29sb3IsIGNvbG9yVHlwZSkge1xyXG4gICAgICAgIHRoZW1lLmNvbG9yc1tjb2xvclR5cGVdID0ge1xyXG4gICAgICAgICAgbmFtZTogY29sb3IubmFtZSxcclxuICAgICAgICAgIC8vIE1ha2Ugc3VyZSBhIENPUFkgb2YgdGhlIGh1ZXMgaXMgZ2l2ZW4gdG8gdGhlIGNoaWxkIGNvbG9yLFxyXG4gICAgICAgICAgLy8gbm90IHRoZSBzYW1lIHJlZmVyZW5jZS5cclxuICAgICAgICAgIGh1ZXM6IGFuZ3VsYXIuZXh0ZW5kKHt9LCBjb2xvci5odWVzKVxyXG4gICAgICAgIH07XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgVEhFTUVTW25hbWVdID0gdGhlbWU7XHJcblxyXG4gICAgcmV0dXJuIHRoZW1lO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gVGhlbWUobmFtZSkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5uYW1lID0gbmFtZTtcclxuICAgIHNlbGYuY29sb3JzID0ge307XHJcblxyXG4gICAgc2VsZi5kYXJrID0gc2V0RGFyaztcclxuICAgIHNldERhcmsoZmFsc2UpO1xyXG5cclxuICAgIGZ1bmN0aW9uIHNldERhcmsoaXNEYXJrKSB7XHJcbiAgICAgIGlzRGFyayA9IGFyZ3VtZW50cy5sZW5ndGggPT09IDAgPyB0cnVlIDogISFpc0Rhcms7XHJcblxyXG4gICAgICAvLyBJZiBubyBjaGFuZ2UsIGFib3J0XHJcbiAgICAgIGlmIChpc0RhcmsgPT09IHNlbGYuaXNEYXJrKSByZXR1cm47XHJcblxyXG4gICAgICBzZWxmLmlzRGFyayA9IGlzRGFyaztcclxuXHJcbiAgICAgIHNlbGYuZm9yZWdyb3VuZFBhbGV0dGUgPSBzZWxmLmlzRGFyayA/IExJR0hUX0ZPUkVHUk9VTkQgOiBEQVJLX0ZPUkVHUk9VTkQ7XHJcbiAgICAgIHNlbGYuZm9yZWdyb3VuZFNoYWRvdyA9IHNlbGYuaXNEYXJrID8gREFSS19TSEFET1cgOiBMSUdIVF9TSEFET1c7XHJcblxyXG4gICAgICAvLyBMaWdodCBhbmQgZGFyayB0aGVtZXMgaGF2ZSBkaWZmZXJlbnQgZGVmYXVsdCBodWVzLlxyXG4gICAgICAvLyBHbyB0aHJvdWdoIGVhY2ggZXhpc3RpbmcgY29sb3IgdHlwZSBmb3IgdGhpcyB0aGVtZSwgYW5kIGZvciBldmVyeVxyXG4gICAgICAvLyBodWUgdmFsdWUgdGhhdCBpcyBzdGlsbCB0aGUgZGVmYXVsdCBodWUgdmFsdWUgZnJvbSB0aGUgcHJldmlvdXMgbGlnaHQvZGFyayBzZXR0aW5nLFxyXG4gICAgICAvLyBzZXQgaXQgdG8gdGhlIGRlZmF1bHQgaHVlIHZhbHVlIGZyb20gdGhlIG5ldyBsaWdodC9kYXJrIHNldHRpbmcuXHJcbiAgICAgIHZhciBuZXdEZWZhdWx0SHVlcyA9IHNlbGYuaXNEYXJrID8gREFSS19ERUZBVUxUX0hVRVMgOiBMSUdIVF9ERUZBVUxUX0hVRVM7XHJcbiAgICAgIHZhciBvbGREZWZhdWx0SHVlcyA9IHNlbGYuaXNEYXJrID8gTElHSFRfREVGQVVMVF9IVUVTIDogREFSS19ERUZBVUxUX0hVRVM7XHJcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChuZXdEZWZhdWx0SHVlcywgZnVuY3Rpb24obmV3RGVmYXVsdHMsIGNvbG9yVHlwZSkge1xyXG4gICAgICAgIHZhciBjb2xvciA9IHNlbGYuY29sb3JzW2NvbG9yVHlwZV07XHJcbiAgICAgICAgdmFyIG9sZERlZmF1bHRzID0gb2xkRGVmYXVsdEh1ZXNbY29sb3JUeXBlXTtcclxuICAgICAgICBpZiAoY29sb3IpIHtcclxuICAgICAgICAgIGZvciAodmFyIGh1ZU5hbWUgaW4gY29sb3IuaHVlcykge1xyXG4gICAgICAgICAgICBpZiAoY29sb3IuaHVlc1todWVOYW1lXSA9PT0gb2xkRGVmYXVsdHNbaHVlTmFtZV0pIHtcclxuICAgICAgICAgICAgICBjb2xvci5odWVzW2h1ZU5hbWVdID0gbmV3RGVmYXVsdHNbaHVlTmFtZV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHNlbGY7XHJcbiAgICB9XHJcblxyXG4gICAgVEhFTUVfQ09MT1JfVFlQRVMuZm9yRWFjaChmdW5jdGlvbihjb2xvclR5cGUpIHtcclxuICAgICAgdmFyIGRlZmF1bHRIdWVzID0gKHNlbGYuaXNEYXJrID8gREFSS19ERUZBVUxUX0hVRVMgOiBMSUdIVF9ERUZBVUxUX0hVRVMpW2NvbG9yVHlwZV07XHJcbiAgICAgIHNlbGZbY29sb3JUeXBlICsgJ1BhbGV0dGUnXSA9IGZ1bmN0aW9uIHNldFBhbGV0dGVUeXBlKHBhbGV0dGVOYW1lLCBodWVzKSB7XHJcbiAgICAgICAgdmFyIGNvbG9yID0gc2VsZi5jb2xvcnNbY29sb3JUeXBlXSA9IHtcclxuICAgICAgICAgIG5hbWU6IHBhbGV0dGVOYW1lLFxyXG4gICAgICAgICAgaHVlczogYW5ndWxhci5leHRlbmQoe30sIGRlZmF1bHRIdWVzLCBodWVzKVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIE9iamVjdC5rZXlzKGNvbG9yLmh1ZXMpLmZvckVhY2goZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgICAgaWYgKCFkZWZhdWx0SHVlc1tuYW1lXSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGh1ZSBuYW1lICclMScgaW4gdGhlbWUgJTIncyAlMyBjb2xvciAlNC4gQXZhaWxhYmxlIGh1ZSBuYW1lczogJTRcIlxyXG4gICAgICAgICAgICAgIC5yZXBsYWNlKCclMScsIG5hbWUpXHJcbiAgICAgICAgICAgICAgLnJlcGxhY2UoJyUyJywgc2VsZi5uYW1lKVxyXG4gICAgICAgICAgICAgIC5yZXBsYWNlKCclMycsIHBhbGV0dGVOYW1lKVxyXG4gICAgICAgICAgICAgIC5yZXBsYWNlKCclNCcsIE9iamVjdC5rZXlzKGRlZmF1bHRIdWVzKS5qb2luKCcsICcpKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIE9iamVjdC5rZXlzKGNvbG9yLmh1ZXMpLm1hcChmdW5jdGlvbihrZXkpIHtcclxuICAgICAgICAgIHJldHVybiBjb2xvci5odWVzW2tleV07XHJcbiAgICAgICAgfSkuZm9yRWFjaChmdW5jdGlvbihodWVWYWx1ZSkge1xyXG4gICAgICAgICAgaWYgKFZBTElEX0hVRV9WQUxVRVMuaW5kZXhPZihodWVWYWx1ZSkgPT0gLTEpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBodWUgdmFsdWUgJyUxJyBpbiB0aGVtZSAlMidzICUzIGNvbG9yICU0LiBBdmFpbGFibGUgaHVlIHZhbHVlczogJTVcIlxyXG4gICAgICAgICAgICAgIC5yZXBsYWNlKCclMScsIGh1ZVZhbHVlKVxyXG4gICAgICAgICAgICAgIC5yZXBsYWNlKCclMicsIHNlbGYubmFtZSlcclxuICAgICAgICAgICAgICAucmVwbGFjZSgnJTMnLCBjb2xvclR5cGUpXHJcbiAgICAgICAgICAgICAgLnJlcGxhY2UoJyU0JywgcGFsZXR0ZU5hbWUpXHJcbiAgICAgICAgICAgICAgLnJlcGxhY2UoJyU1JywgVkFMSURfSFVFX1ZBTFVFUy5qb2luKCcsICcpKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBzZWxmO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgc2VsZltjb2xvclR5cGUgKyAnQ29sb3InXSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtcclxuICAgICAgICBjb25zb2xlLndhcm4oJyRtZFRoZW1pbmdQcm92aWRlclRoZW1lLicgKyBjb2xvclR5cGUgKyAnQ29sb3IoKSBoYXMgYmVlbiBkZXByZWNhdGVkLiAnICtcclxuICAgICAgICAgICAgICAgICAgICAgJ1VzZSAkbWRUaGVtaW5nUHJvdmlkZXJUaGVtZS4nICsgY29sb3JUeXBlICsgJ1BhbGV0dGUoKSBpbnN0ZWFkLicpO1xyXG4gICAgICAgIHJldHVybiBzZWxmW2NvbG9yVHlwZSArICdQYWxldHRlJ10uYXBwbHkoc2VsZiwgYXJncyk7XHJcbiAgICAgIH07XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBuZ2RvYyBzZXJ2aWNlXHJcbiAgICogQG5hbWUgJG1kVGhlbWluZ1xyXG4gICAqXHJcbiAgICogQGRlc2NyaXB0aW9uXHJcbiAgICpcclxuICAgKiBTZXJ2aWNlIHRoYXQgbWFrZXMgYW4gZWxlbWVudCBhcHBseSB0aGVtaW5nIHJlbGF0ZWQgY2xhc3NlcyB0byBpdHNlbGYuXHJcbiAgICpcclxuICAgKiBgYGBqc1xyXG4gICAqIGFwcC5kaXJlY3RpdmUoJ215RmFuY3lEaXJlY3RpdmUnLCBmdW5jdGlvbigkbWRUaGVtaW5nKSB7XHJcbiAgICogICByZXR1cm4ge1xyXG4gICAqICAgICByZXN0cmljdDogJ2UnLFxyXG4gICAqICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWwsIGF0dHJzKSB7XHJcbiAgICogICAgICAgJG1kVGhlbWluZyhlbCk7XHJcbiAgICogICAgIH1cclxuICAgKiAgIH07XHJcbiAgICogfSk7XHJcbiAgICogYGBgXHJcbiAgICogQHBhcmFtIHtlbD19IGVsZW1lbnQgdG8gYXBwbHkgdGhlbWluZyB0b1xyXG4gICAqL1xyXG4gIC8qIEBuZ0luamVjdCAqL1xyXG4gIGZ1bmN0aW9uIFRoZW1pbmdTZXJ2aWNlKCRyb290U2NvcGUsICRsb2cpIHtcclxuXHJcbiAgICBhcHBseVRoZW1lLmluaGVyaXQgPSBmdW5jdGlvbihlbCwgcGFyZW50KSB7XHJcbiAgICAgIHZhciBjdHJsID0gcGFyZW50LmNvbnRyb2xsZXIoJ21kVGhlbWUnKTtcclxuXHJcbiAgICAgIHZhciBhdHRyVGhlbWVWYWx1ZSA9IGVsLmF0dHIoJ21kLXRoZW1lLXdhdGNoJyk7XHJcbiAgICAgIGlmICggKGFsd2F5c1dhdGNoVGhlbWUgfHwgYW5ndWxhci5pc0RlZmluZWQoYXR0clRoZW1lVmFsdWUpKSAmJiBhdHRyVGhlbWVWYWx1ZSAhPSAnZmFsc2UnKSB7XHJcbiAgICAgICAgdmFyIGRlcmVnaXN0ZXJXYXRjaCA9ICRyb290U2NvcGUuJHdhdGNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgcmV0dXJuIGN0cmwgJiYgY3RybC4kbWRUaGVtZSB8fCBkZWZhdWx0VGhlbWU7XHJcbiAgICAgICAgfSwgY2hhbmdlVGhlbWUpO1xyXG4gICAgICAgIGVsLm9uKCckZGVzdHJveScsIGRlcmVnaXN0ZXJXYXRjaCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdmFyIHRoZW1lID0gY3RybCAmJiBjdHJsLiRtZFRoZW1lIHx8IGRlZmF1bHRUaGVtZTtcclxuICAgICAgICBjaGFuZ2VUaGVtZSh0aGVtZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGNoYW5nZVRoZW1lKHRoZW1lKSB7XHJcbiAgICAgICAgaWYgKCFyZWdpc3RlcmVkKHRoZW1lKSkge1xyXG4gICAgICAgICAgJGxvZy53YXJuKCdBdHRlbXB0ZWQgdG8gdXNlIHVucmVnaXN0ZXJlZCB0aGVtZSBcXCcnICsgdGhlbWUgKyAnXFwnLiAnICtcclxuICAgICAgICAgICAgICAgICAgICAnUmVnaXN0ZXIgaXQgd2l0aCAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoKS4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG9sZFRoZW1lID0gZWwuZGF0YSgnJG1kVGhlbWVOYW1lJyk7XHJcbiAgICAgICAgaWYgKG9sZFRoZW1lKSBlbC5yZW1vdmVDbGFzcygnbWQtJyArIG9sZFRoZW1lICsnLXRoZW1lJyk7XHJcbiAgICAgICAgZWwuYWRkQ2xhc3MoJ21kLScgKyB0aGVtZSArICctdGhlbWUnKTtcclxuICAgICAgICBlbC5kYXRhKCckbWRUaGVtZU5hbWUnLCB0aGVtZSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgYXBwbHlUaGVtZS5USEVNRVMgPSBhbmd1bGFyLmV4dGVuZCh7fSwgVEhFTUVTKTtcclxuICAgIGFwcGx5VGhlbWUuZGVmYXVsdFRoZW1lID0gZnVuY3Rpb24oKSB7IHJldHVybiBkZWZhdWx0VGhlbWU7IH07XHJcbiAgICBhcHBseVRoZW1lLnJlZ2lzdGVyZWQgPSByZWdpc3RlcmVkO1xyXG5cclxuICAgIHJldHVybiBhcHBseVRoZW1lO1xyXG5cclxuICAgIGZ1bmN0aW9uIHJlZ2lzdGVyZWQodGhlbWVOYW1lKSB7XHJcbiAgICAgIGlmICh0aGVtZU5hbWUgPT09IHVuZGVmaW5lZCB8fCB0aGVtZU5hbWUgPT09ICcnKSByZXR1cm4gdHJ1ZTtcclxuICAgICAgcmV0dXJuIGFwcGx5VGhlbWUuVEhFTUVTW3RoZW1lTmFtZV0gIT09IHVuZGVmaW5lZDtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBhcHBseVRoZW1lKHNjb3BlLCBlbCkge1xyXG4gICAgICAvLyBBbGxvdyB1cyB0byBiZSBpbnZva2VkIHZpYSBhIGxpbmtpbmcgZnVuY3Rpb24gc2lnbmF0dXJlLlxyXG4gICAgICBpZiAoZWwgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGVsID0gc2NvcGU7XHJcbiAgICAgICAgc2NvcGUgPSB1bmRlZmluZWQ7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHNjb3BlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBzY29wZSA9ICRyb290U2NvcGU7XHJcbiAgICAgIH1cclxuICAgICAgYXBwbHlUaGVtZS5pbmhlcml0KGVsLCBlbCk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblRoZW1pbmdQcm92aWRlci4kaW5qZWN0ID0gW1wiJG1kQ29sb3JQYWxldHRlXCJdO1xyXG5cclxuZnVuY3Rpb24gVGhlbWluZ0RpcmVjdGl2ZSgkbWRUaGVtaW5nLCAkaW50ZXJwb2xhdGUsICRsb2cpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcHJpb3JpdHk6IDEwMCxcclxuICAgIGxpbms6IHtcclxuICAgICAgcHJlOiBmdW5jdGlvbihzY29wZSwgZWwsIGF0dHJzKSB7XHJcbiAgICAgICAgdmFyIGN0cmwgPSB7XHJcbiAgICAgICAgICAkc2V0VGhlbWU6IGZ1bmN0aW9uKHRoZW1lKSB7XHJcbiAgICAgICAgICAgIGlmICghJG1kVGhlbWluZy5yZWdpc3RlcmVkKHRoZW1lKSkge1xyXG4gICAgICAgICAgICAgICRsb2cud2FybignYXR0ZW1wdGVkIHRvIHVzZSB1bnJlZ2lzdGVyZWQgdGhlbWUgXFwnJyArIHRoZW1lICsgJ1xcJycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGN0cmwuJG1kVGhlbWUgPSB0aGVtZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGVsLmRhdGEoJyRtZFRoZW1lQ29udHJvbGxlcicsIGN0cmwpO1xyXG4gICAgICAgIGN0cmwuJHNldFRoZW1lKCRpbnRlcnBvbGF0ZShhdHRycy5tZFRoZW1lKShzY29wZSkpO1xyXG4gICAgICAgIGF0dHJzLiRvYnNlcnZlKCdtZFRoZW1lJywgY3RybC4kc2V0VGhlbWUpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG5UaGVtaW5nRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkbWRUaGVtaW5nXCIsIFwiJGludGVycG9sYXRlXCIsIFwiJGxvZ1wiXTtcclxuXHJcbmZ1bmN0aW9uIFRoZW1hYmxlRGlyZWN0aXZlKCRtZFRoZW1pbmcpIHtcclxuICByZXR1cm4gJG1kVGhlbWluZztcclxufVxyXG5UaGVtYWJsZURpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kVGhlbWluZ1wiXTtcclxuXHJcbmZ1bmN0aW9uIHBhcnNlUnVsZXModGhlbWUsIGNvbG9yVHlwZSwgcnVsZXMpIHtcclxuICBjaGVja1ZhbGlkUGFsZXR0ZSh0aGVtZSwgY29sb3JUeXBlKTtcclxuXHJcbiAgcnVsZXMgPSBydWxlcy5yZXBsYWNlKC9USEVNRV9OQU1FL2csIHRoZW1lLm5hbWUpO1xyXG4gIHZhciBnZW5lcmF0ZWRSdWxlcyA9IFtdO1xyXG4gIHZhciBjb2xvciA9IHRoZW1lLmNvbG9yc1tjb2xvclR5cGVdO1xyXG5cclxuICB2YXIgdGhlbWVOYW1lUmVnZXggPSBuZXcgUmVnRXhwKCcubWQtJyArIHRoZW1lLm5hbWUgKyAnLXRoZW1lJywgJ2cnKTtcclxuICAvLyBNYXRjaGVzICd7eyBwcmltYXJ5LWNvbG9yIH19JywgZXRjXHJcbiAgdmFyIGh1ZVJlZ2V4ID0gbmV3IFJlZ0V4cCgnKFxcJ3xcIik/e3tcXFxccyooJyArIGNvbG9yVHlwZSArICcpLShjb2xvcnxjb250cmFzdCktPyhcXFxcZFxcXFwuP1xcXFxkKik/XFxcXHMqfX0oXFxcInxcXCcpPycsJ2cnKTtcclxuICB2YXIgc2ltcGxlVmFyaWFibGVSZWdleCA9IC8nP1wiP1xce1xce1xccyooW2EtekEtWl0rKS0oQT9cXGQrfGh1ZVxcLVswLTNdfHNoYWRvdyktPyhcXGRcXC4/XFxkKik/XFxzKlxcfVxcfSc/XCI/L2c7XHJcbiAgdmFyIHBhbGV0dGUgPSBQQUxFVFRFU1tjb2xvci5uYW1lXTtcclxuXHJcbiAgLy8gZmluZCBhbmQgcmVwbGFjZSBzaW1wbGUgdmFyaWFibGVzIHdoZXJlIHdlIHVzZSBhIHNwZWNpZmljIGh1ZSwgbm90IGFuIGVudGlyZSBwYWxldHRlXHJcbiAgLy8gZWcuIFwie3twcmltYXJ5LTEwMH19XCJcclxuICAvL1xcKCcgKyBUSEVNRV9DT0xPUl9UWVBFUy5qb2luKCdcXHwnKSArICdcXCknXHJcbiAgcnVsZXMgPSBydWxlcy5yZXBsYWNlKHNpbXBsZVZhcmlhYmxlUmVnZXgsIGZ1bmN0aW9uKG1hdGNoLCBjb2xvclR5cGUsIGh1ZSwgb3BhY2l0eSkge1xyXG4gICAgaWYgKGNvbG9yVHlwZSA9PT0gJ2ZvcmVncm91bmQnKSB7XHJcbiAgICAgIGlmIChodWUgPT0gJ3NoYWRvdycpIHtcclxuICAgICAgICByZXR1cm4gdGhlbWUuZm9yZWdyb3VuZFNoYWRvdztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gdGhlbWUuZm9yZWdyb3VuZFBhbGV0dGVbaHVlXSB8fCB0aGVtZS5mb3JlZ3JvdW5kUGFsZXR0ZVsnMSddO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoaHVlLmluZGV4T2YoJ2h1ZScpID09PSAwKSB7XHJcbiAgICAgIGh1ZSA9IHRoZW1lLmNvbG9yc1tjb2xvclR5cGVdLmh1ZXNbaHVlXTtcclxuICAgIH1cclxuICAgIHJldHVybiByZ2JhKCAoUEFMRVRURVNbIHRoZW1lLmNvbG9yc1tjb2xvclR5cGVdLm5hbWUgXVtodWVdIHx8ICcnKS52YWx1ZSwgb3BhY2l0eSApO1xyXG4gIH0pO1xyXG5cclxuICAvLyBGb3IgZWFjaCB0eXBlLCBnZW5lcmF0ZSBydWxlcyBmb3IgZWFjaCBodWUgKGllLiBkZWZhdWx0LCBtZC1odWUtMSwgbWQtaHVlLTIsIG1kLWh1ZS0zKVxyXG4gIGFuZ3VsYXIuZm9yRWFjaChjb2xvci5odWVzLCBmdW5jdGlvbihodWVWYWx1ZSwgaHVlTmFtZSkge1xyXG4gICAgdmFyIG5ld1J1bGUgPSBydWxlc1xyXG4gICAgICAucmVwbGFjZShodWVSZWdleCwgZnVuY3Rpb24obWF0Y2gsIF8sIGNvbG9yVHlwZSwgaHVlVHlwZSwgb3BhY2l0eSkge1xyXG4gICAgICAgIHJldHVybiByZ2JhKHBhbGV0dGVbaHVlVmFsdWVdW2h1ZVR5cGUgPT09ICdjb2xvcicgPyAndmFsdWUnIDogJ2NvbnRyYXN0J10sIG9wYWNpdHkpO1xyXG4gICAgICB9KTtcclxuICAgIGlmIChodWVOYW1lICE9PSAnZGVmYXVsdCcpIHtcclxuICAgICAgbmV3UnVsZSA9IG5ld1J1bGUucmVwbGFjZSh0aGVtZU5hbWVSZWdleCwgJy5tZC0nICsgdGhlbWUubmFtZSArICctdGhlbWUubWQtJyArIGh1ZU5hbWUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIERvbid0IGFwcGx5IGEgc2VsZWN0b3IgcnVsZSB0byB0aGUgZGVmYXVsdCB0aGVtZSwgbWFraW5nIGl0IGVhc2llciB0byBvdmVycmlkZVxyXG4gICAgLy8gc3R5bGVzIG9mIHRoZSBiYXNlLWNvbXBvbmVudFxyXG4gICAgaWYgKHRoZW1lLm5hbWUgPT0gJ2RlZmF1bHQnKSB7XHJcbiAgICAgIG5ld1J1bGUgPSBuZXdSdWxlLnJlcGxhY2UoL1xcLm1kLWRlZmF1bHQtdGhlbWUvZywgJycpO1xyXG4gICAgfVxyXG4gICAgZ2VuZXJhdGVkUnVsZXMucHVzaChuZXdSdWxlKTtcclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIGdlbmVyYXRlZFJ1bGVzO1xyXG59XHJcblxyXG4vLyBHZW5lcmF0ZSBvdXIgdGhlbWVzIGF0IHJ1biB0aW1lIGdpdmVuIHRoZSBzdGF0ZSBvZiBUSEVNRVMgYW5kIFBBTEVUVEVTXHJcbmZ1bmN0aW9uIGdlbmVyYXRlVGhlbWVzKCRpbmplY3Rvcikge1xyXG5cclxuICB2YXIgaGVhZCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF07XHJcbiAgdmFyIGZpcnN0Q2hpbGQgPSBoZWFkID8gaGVhZC5maXJzdEVsZW1lbnRDaGlsZCA6IG51bGw7XHJcbiAgdmFyIHRoZW1lQ3NzID0gJGluamVjdG9yLmhhcygnJE1EX1RIRU1FX0NTUycpID8gJGluamVjdG9yLmdldCgnJE1EX1RIRU1FX0NTUycpIDogJyc7XHJcblxyXG4gIGlmICggIWZpcnN0Q2hpbGQgKSByZXR1cm47XHJcbiAgaWYgKHRoZW1lQ3NzLmxlbmd0aCA9PT0gMCkgcmV0dXJuOyAvLyBubyBydWxlcywgc28gbm8gcG9pbnQgaW4gcnVubmluZyB0aGlzIGV4cGVuc2l2ZSB0YXNrXHJcblxyXG4gIC8vIEV4cG9zZSBjb250cmFzdCBjb2xvcnMgZm9yIHBhbGV0dGVzIHRvIGVuc3VyZSB0aGF0IHRleHQgaXMgYWx3YXlzIHJlYWRhYmxlXHJcbiAgYW5ndWxhci5mb3JFYWNoKFBBTEVUVEVTLCBzYW5pdGl6ZVBhbGV0dGUpO1xyXG5cclxuICAvLyBNRF9USEVNRV9DU1MgaXMgYSBzdHJpbmcgZ2VuZXJhdGVkIGJ5IHRoZSBidWlsZCBwcm9jZXNzIHRoYXQgaW5jbHVkZXMgYWxsIHRoZSB0aGVtYWJsZVxyXG4gIC8vIGNvbXBvbmVudHMgYXMgdGVtcGxhdGVzXHJcblxyXG4gIC8vIEJyZWFrIHRoZSBDU1MgaW50byBpbmRpdmlkdWFsIHJ1bGVzXHJcbiAgdmFyIHJ1bGVzQnlUeXBlID0ge307XHJcbiAgdmFyIHJ1bGVzID0gdGhlbWVDc3NcclxuICAgICAgICAgICAgICAgICAgLnNwbGl0KC9cXH0oPyEoXFx9fCd8XCJ8OykpLylcclxuICAgICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbihydWxlKSB7IHJldHVybiBydWxlICYmIHJ1bGUubGVuZ3RoOyB9KVxyXG4gICAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uKHJ1bGUpIHsgcmV0dXJuIHJ1bGUudHJpbSgpICsgJ30nOyB9KTtcclxuXHJcblxyXG4gIHZhciBydWxlTWF0Y2hSZWdleCA9IG5ldyBSZWdFeHAoJ21kLSgnICsgVEhFTUVfQ09MT1JfVFlQRVMuam9pbignfCcpICsgJyknLCAnZycpO1xyXG5cclxuICBUSEVNRV9DT0xPUl9UWVBFUy5mb3JFYWNoKGZ1bmN0aW9uKHR5cGUpIHtcclxuICAgIHJ1bGVzQnlUeXBlW3R5cGVdID0gJyc7XHJcbiAgfSk7XHJcblxyXG5cclxuICAvLyBTb3J0IHRoZSBydWxlcyBiYXNlZCBvbiB0eXBlLCBhbGxvd2luZyB1cyB0byBkbyBjb2xvciBzdWJzdGl0dXRpb24gb24gYSBwZXItdHlwZSBiYXNpc1xyXG4gIHJ1bGVzLmZvckVhY2goZnVuY3Rpb24ocnVsZSkge1xyXG4gICAgdmFyIG1hdGNoID0gcnVsZS5tYXRjaChydWxlTWF0Y2hSZWdleCk7XHJcbiAgICAvLyBGaXJzdDogdGVzdCB0aGF0IGlmIHRoZSBydWxlIGhhcyAnLm1kLWFjY2VudCcsIGl0IGdvZXMgaW50byB0aGUgYWNjZW50IHNldCBvZiBydWxlc1xyXG4gICAgZm9yICh2YXIgaSA9IDAsIHR5cGU7IHR5cGUgPSBUSEVNRV9DT0xPUl9UWVBFU1tpXTsgaSsrKSB7XHJcbiAgICAgIGlmIChydWxlLmluZGV4T2YoJy5tZC0nICsgdHlwZSkgPiAtMSkge1xyXG4gICAgICAgIHJldHVybiBydWxlc0J5VHlwZVt0eXBlXSArPSBydWxlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSWYgbm8gZWcgJ21kLWFjY2VudCcgY2xhc3MgaXMgZm91bmQsIHRyeSB0byBqdXN0IGZpbmQgJ2FjY2VudCcgaW4gdGhlIHJ1bGUgYW5kIGd1ZXNzIGZyb21cclxuICAgIC8vIHRoZXJlXHJcbiAgICBmb3IgKGkgPSAwOyB0eXBlID0gVEhFTUVfQ09MT1JfVFlQRVNbaV07IGkrKykge1xyXG4gICAgICBpZiAocnVsZS5pbmRleE9mKHR5cGUpID4gLTEpIHtcclxuICAgICAgICByZXR1cm4gcnVsZXNCeVR5cGVbdHlwZV0gKz0gcnVsZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIERlZmF1bHQgdG8gdGhlIHByaW1hcnkgYXJyYXlcclxuICAgIHJldHVybiBydWxlc0J5VHlwZVtERUZBVUxUX0NPTE9SX1RZUEVdICs9IHJ1bGU7XHJcbiAgfSk7XHJcblxyXG4gICAgLy8gRm9yIGVhY2ggdGhlbWUsIHVzZSB0aGUgY29sb3IgcGFsZXR0ZXMgc3BlY2lmaWVkIGZvclxyXG4gICAgLy8gYHByaW1hcnlgLCBgd2FybmAgYW5kIGBhY2NlbnRgIHRvIGdlbmVyYXRlIENTUyBydWxlcy5cclxuXHJcbiAgICBhbmd1bGFyLmZvckVhY2goVEhFTUVTLCBmdW5jdGlvbih0aGVtZSkge1xyXG4gICAgICBpZiAoICFHRU5FUkFURURbdGhlbWUubmFtZV0gKSB7XHJcblxyXG5cclxuICAgICAgICBUSEVNRV9DT0xPUl9UWVBFUy5mb3JFYWNoKGZ1bmN0aW9uKGNvbG9yVHlwZSkge1xyXG4gICAgICAgICAgdmFyIHN0eWxlU3RyaW5ncyA9IHBhcnNlUnVsZXModGhlbWUsIGNvbG9yVHlwZSwgcnVsZXNCeVR5cGVbY29sb3JUeXBlXSk7XHJcbiAgICAgICAgICB3aGlsZSAoc3R5bGVTdHJpbmdzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB2YXIgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xyXG4gICAgICAgICAgICAgICAgc3R5bGUuc2V0QXR0cmlidXRlKCd0eXBlJywgJ3RleHQvY3NzJyk7XHJcbiAgICAgICAgICAgIHN0eWxlLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHN0eWxlU3RyaW5ncy5zaGlmdCgpKSk7XHJcbiAgICAgICAgICAgIGhlYWQuaW5zZXJ0QmVmb3JlKHN0eWxlLCBmaXJzdENoaWxkKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgICAgIGlmICh0aGVtZS5jb2xvcnMucHJpbWFyeS5uYW1lID09IHRoZW1lLmNvbG9ycy5hY2NlbnQubmFtZSkge1xyXG4gICAgICAgICAgY29uc29sZS53YXJuKFwiJG1kVGhlbWluZ1Byb3ZpZGVyOiBVc2luZyB0aGUgc2FtZSBwYWxldHRlIGZvciBwcmltYXJ5IGFuZFwiICtcclxuICAgICAgICAgICAgICAgICAgICAgICBcIiBhY2NlbnQuIFRoaXMgdmlvbGF0ZXMgdGhlIG1hdGVyaWFsIGRlc2lnbiBzcGVjLlwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIEdFTkVSQVRFRFt0aGVtZS5uYW1lXSA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuXHJcbiAgLy8gKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG4gIC8vIEludGVybmFsIGZ1bmN0aW9uc1xyXG4gIC8vICoqKioqKioqKioqKioqKioqKioqKioqKipcclxuXHJcbiAgLy8gVGhlIHVzZXIgc3BlY2lmaWVzIGEgJ2RlZmF1bHQnIGNvbnRyYXN0IGNvbG9yIGFzIGVpdGhlciBsaWdodCBvciBkYXJrLFxyXG4gIC8vIHRoZW4gZXhwbGljaXRseSBsaXN0cyB3aGljaCBodWVzIGFyZSB0aGUgb3Bwb3NpdGUgY29udHJhc3QgKGVnLiBBMTAwIGhhcyBkYXJrLCBBMjAwIGhhcyBsaWdodClcclxuICBmdW5jdGlvbiBzYW5pdGl6ZVBhbGV0dGUocGFsZXR0ZSkge1xyXG4gICAgdmFyIGRlZmF1bHRDb250cmFzdCA9IHBhbGV0dGUuY29udHJhc3REZWZhdWx0Q29sb3I7XHJcbiAgICB2YXIgbGlnaHRDb2xvcnMgPSBwYWxldHRlLmNvbnRyYXN0TGlnaHRDb2xvcnMgfHwgW107XHJcbiAgICB2YXIgc3Ryb25nTGlnaHRDb2xvcnMgPSBwYWxldHRlLmNvbnRyYXN0U3Ryb25nTGlnaHRDb2xvcnMgfHwgW107XHJcbiAgICB2YXIgZGFya0NvbG9ycyA9IHBhbGV0dGUuY29udHJhc3REYXJrQ29sb3JzIHx8IFtdO1xyXG5cclxuICAgIC8vIFRoZXNlIGNvbG9ycyBhcmUgcHJvdmlkZWQgYXMgc3BhY2Utc2VwYXJhdGVkIGxpc3RzXHJcbiAgICBpZiAodHlwZW9mIGxpZ2h0Q29sb3JzID09PSAnc3RyaW5nJykgbGlnaHRDb2xvcnMgPSBsaWdodENvbG9ycy5zcGxpdCgnICcpO1xyXG4gICAgaWYgKHR5cGVvZiBzdHJvbmdMaWdodENvbG9ycyA9PT0gJ3N0cmluZycpIHN0cm9uZ0xpZ2h0Q29sb3JzID0gc3Ryb25nTGlnaHRDb2xvcnMuc3BsaXQoJyAnKTtcclxuICAgIGlmICh0eXBlb2YgZGFya0NvbG9ycyA9PT0gJ3N0cmluZycpIGRhcmtDb2xvcnMgPSBkYXJrQ29sb3JzLnNwbGl0KCcgJyk7XHJcblxyXG4gICAgLy8gQ2xlYW51cCBhZnRlciBvdXJzZWx2ZXNcclxuICAgIGRlbGV0ZSBwYWxldHRlLmNvbnRyYXN0RGVmYXVsdENvbG9yO1xyXG4gICAgZGVsZXRlIHBhbGV0dGUuY29udHJhc3RMaWdodENvbG9ycztcclxuICAgIGRlbGV0ZSBwYWxldHRlLmNvbnRyYXN0U3Ryb25nTGlnaHRDb2xvcnM7XHJcbiAgICBkZWxldGUgcGFsZXR0ZS5jb250cmFzdERhcmtDb2xvcnM7XHJcblxyXG4gICAgLy8gQ2hhbmdlIHsgJ0ExMDAnOiAnI2ZmZmVlZScgfSB0byB7ICdBMTAwJzogeyB2YWx1ZTogJyNmZmZlZWUnLCBjb250cmFzdDpEQVJLX0NPTlRSQVNUX0NPTE9SIH1cclxuICAgIGFuZ3VsYXIuZm9yRWFjaChwYWxldHRlLCBmdW5jdGlvbihodWVWYWx1ZSwgaHVlTmFtZSkge1xyXG4gICAgICBpZiAoYW5ndWxhci5pc09iamVjdChodWVWYWx1ZSkpIHJldHVybjsgLy8gQWxyZWFkeSBjb252ZXJ0ZWRcclxuICAgICAgLy8gTWFwIGV2ZXJ5dGhpbmcgdG8gcmdiIGNvbG9yc1xyXG4gICAgICB2YXIgcmdiVmFsdWUgPSBjb2xvclRvUmdiYUFycmF5KGh1ZVZhbHVlKTtcclxuICAgICAgaWYgKCFyZ2JWYWx1ZSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNvbG9yICUxLCBpbiBwYWxldHRlICUyJ3MgaHVlICUzLCBpcyBpbnZhbGlkLiBIZXggb3IgcmdiKGEpIGNvbG9yIGV4cGVjdGVkLlwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKCclMScsIGh1ZVZhbHVlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgnJTInLCBwYWxldHRlLm5hbWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKCclMycsIGh1ZU5hbWUpKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcGFsZXR0ZVtodWVOYW1lXSA9IHtcclxuICAgICAgICB2YWx1ZTogcmdiVmFsdWUsXHJcbiAgICAgICAgY29udHJhc3Q6IGdldENvbnRyYXN0Q29sb3IoKVxyXG4gICAgICB9O1xyXG4gICAgICBmdW5jdGlvbiBnZXRDb250cmFzdENvbG9yKCkge1xyXG4gICAgICAgIGlmIChkZWZhdWx0Q29udHJhc3QgPT09ICdsaWdodCcpIHtcclxuICAgICAgICAgIGlmIChkYXJrQ29sb3JzLmluZGV4T2YoaHVlTmFtZSkgPiAtMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gREFSS19DT05UUkFTVF9DT0xPUjtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzdHJvbmdMaWdodENvbG9ycy5pbmRleE9mKGh1ZU5hbWUpID4gLTEgPyBTVFJPTkdfTElHSFRfQ09OVFJBU1RfQ09MT1JcclxuICAgICAgICAgICAgICA6IExJR0hUX0NPTlRSQVNUX0NPTE9SO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAobGlnaHRDb2xvcnMuaW5kZXhPZihodWVOYW1lKSA+IC0xKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzdHJvbmdMaWdodENvbG9ycy5pbmRleE9mKGh1ZU5hbWUpID4gLTEgPyBTVFJPTkdfTElHSFRfQ09OVFJBU1RfQ09MT1JcclxuICAgICAgICAgICAgICA6IExJR0hUX0NPTlRSQVNUX0NPTE9SO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIERBUktfQ09OVFJBU1RfQ09MT1I7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG5cclxufVxyXG5nZW5lcmF0ZVRoZW1lcy4kaW5qZWN0ID0gW1wiJGluamVjdG9yXCJdO1xyXG5cclxuZnVuY3Rpb24gY2hlY2tWYWxpZFBhbGV0dGUodGhlbWUsIGNvbG9yVHlwZSkge1xyXG4gIC8vIElmIHRoZW1lIGF0dGVtcHRzIHRvIHVzZSBhIHBhbGV0dGUgdGhhdCBkb2VzbnQgZXhpc3QsIHRocm93IGVycm9yXHJcbiAgaWYgKCFQQUxFVFRFU1sgKHRoZW1lLmNvbG9yc1tjb2xvclR5cGVdIHx8IHt9KS5uYW1lIF0pIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgXCJZb3Ugc3VwcGxpZWQgYW4gaW52YWxpZCBjb2xvciBwYWxldHRlIGZvciB0aGVtZSAlMSdzICUyIHBhbGV0dGUuIEF2YWlsYWJsZSBwYWxldHRlczogJTNcIlxyXG4gICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKCclMScsIHRoZW1lLm5hbWUpXHJcbiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoJyUyJywgY29sb3JUeXBlKVxyXG4gICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKCclMycsIE9iamVjdC5rZXlzKFBBTEVUVEVTKS5qb2luKCcsICcpKVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNvbG9yVG9SZ2JhQXJyYXkoY2xyKSB7XHJcbiAgaWYgKGFuZ3VsYXIuaXNBcnJheShjbHIpICYmIGNsci5sZW5ndGggPT0gMykgcmV0dXJuIGNscjtcclxuICBpZiAoL15yZ2IvLnRlc3QoY2xyKSkge1xyXG4gICAgcmV0dXJuIGNsci5yZXBsYWNlKC8oXlxccypyZ2JhP1xcKHxcXClcXHMqJCkvZywgJycpLnNwbGl0KCcsJykubWFwKGZ1bmN0aW9uKHZhbHVlLCBpKSB7XHJcbiAgICAgIHJldHVybiBpID09IDMgPyBwYXJzZUZsb2F0KHZhbHVlLCAxMCkgOiBwYXJzZUludCh2YWx1ZSwgMTApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIGlmIChjbHIuY2hhckF0KDApID09ICcjJykgY2xyID0gY2xyLnN1YnN0cmluZygxKTtcclxuICBpZiAoIS9eKFthLWZBLUYwLTldezN9KXsxLDJ9JC9nLnRlc3QoY2xyKSkgcmV0dXJuO1xyXG5cclxuICB2YXIgZGlnID0gY2xyLmxlbmd0aCAvIDM7XHJcbiAgdmFyIHJlZCA9IGNsci5zdWJzdHIoMCwgZGlnKTtcclxuICB2YXIgZ3JuID0gY2xyLnN1YnN0cihkaWcsIGRpZyk7XHJcbiAgdmFyIGJsdSA9IGNsci5zdWJzdHIoZGlnICogMik7XHJcbiAgaWYgKGRpZyA9PT0gMSkge1xyXG4gICAgcmVkICs9IHJlZDtcclxuICAgIGdybiArPSBncm47XHJcbiAgICBibHUgKz0gYmx1O1xyXG4gIH1cclxuICByZXR1cm4gW3BhcnNlSW50KHJlZCwgMTYpLCBwYXJzZUludChncm4sIDE2KSwgcGFyc2VJbnQoYmx1LCAxNildO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZ2JhKHJnYkFycmF5LCBvcGFjaXR5KSB7XHJcbiAgaWYgKCAhcmdiQXJyYXkgKSByZXR1cm4gXCJyZ2IoJzAsMCwwJylcIjtcclxuXHJcbiAgaWYgKHJnYkFycmF5Lmxlbmd0aCA9PSA0KSB7XHJcbiAgICByZ2JBcnJheSA9IGFuZ3VsYXIuY29weShyZ2JBcnJheSk7XHJcbiAgICBvcGFjaXR5ID8gcmdiQXJyYXkucG9wKCkgOiBvcGFjaXR5ID0gcmdiQXJyYXkucG9wKCk7XHJcbiAgfVxyXG4gIHJldHVybiBvcGFjaXR5ICYmICh0eXBlb2Ygb3BhY2l0eSA9PSAnbnVtYmVyJyB8fCAodHlwZW9mIG9wYWNpdHkgPT0gJ3N0cmluZycgJiYgb3BhY2l0eS5sZW5ndGgpKSA/XHJcbiAgICAncmdiYSgnICsgcmdiQXJyYXkuam9pbignLCcpICsgJywnICsgb3BhY2l0eSArICcpJyA6XHJcbiAgICAncmdiKCcgKyByZ2JBcnJheS5qb2luKCcsJykgKyAnKSc7XHJcbn1cclxuXHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKipcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLmF1dG9jb21wbGV0ZVxyXG4gKi9cclxuLypcclxuICogQHNlZSBqcyBmb2xkZXIgZm9yIGF1dG9jb21wbGV0ZSBpbXBsZW1lbnRhdGlvblxyXG4gKi9cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuYXV0b2NvbXBsZXRlJywgW1xyXG4gICdtYXRlcmlhbC5jb3JlJyxcclxuICAnbWF0ZXJpYWwuY29tcG9uZW50cy5pY29uJ1xyXG5dKTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qXHJcbiAqIEBuZ2RvYyBtb2R1bGVcclxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5iYWNrZHJvcFxyXG4gKiBAZGVzY3JpcHRpb24gQmFja2Ryb3BcclxuICovXHJcblxyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbmFtZSBtZEJhY2tkcm9wXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5iYWNrZHJvcFxyXG4gKlxyXG4gKiBAcmVzdHJpY3QgRVxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogYDxtZC1iYWNrZHJvcD5gIGlzIGEgYmFja2Ryb3AgZWxlbWVudCB1c2VkIGJ5IG90aGVyIGNvbXBvbmVudHMsIHN1Y2ggYXMgZGlhbG9nIGFuZCBib3R0b20gc2hlZXQuXHJcbiAqIEFwcGx5IGNsYXNzIGBvcGFxdWVgIHRvIG1ha2UgdGhlIGJhY2tkcm9wIHVzZSB0aGUgdGhlbWUgYmFja2Ryb3AgY29sb3IuXHJcbiAqXHJcbiAqL1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuYmFja2Ryb3AnLCBbXHJcbiAgJ21hdGVyaWFsLmNvcmUnXHJcbl0pXHJcbiAgLmRpcmVjdGl2ZSgnbWRCYWNrZHJvcCcsIEJhY2tkcm9wRGlyZWN0aXZlKTtcclxuXHJcbmZ1bmN0aW9uIEJhY2tkcm9wRGlyZWN0aXZlKCRtZFRoZW1pbmcpIHtcclxuICByZXR1cm4gJG1kVGhlbWluZztcclxufVxyXG5CYWNrZHJvcERpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kVGhlbWluZ1wiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbW9kdWxlXHJcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuYm90dG9tU2hlZXRcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIEJvdHRvbVNoZWV0XHJcbiAqL1xyXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5ib3R0b21TaGVldCcsIFtcclxuICAnbWF0ZXJpYWwuY29yZScsXHJcbiAgJ21hdGVyaWFsLmNvbXBvbmVudHMuYmFja2Ryb3AnXHJcbl0pXHJcbiAgLmRpcmVjdGl2ZSgnbWRCb3R0b21TaGVldCcsIE1kQm90dG9tU2hlZXREaXJlY3RpdmUpXHJcbiAgLnByb3ZpZGVyKCckbWRCb3R0b21TaGVldCcsIE1kQm90dG9tU2hlZXRQcm92aWRlcik7XHJcblxyXG5mdW5jdGlvbiBNZEJvdHRvbVNoZWV0RGlyZWN0aXZlKCkge1xyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0UnXHJcbiAgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBzZXJ2aWNlXHJcbiAqIEBuYW1lICRtZEJvdHRvbVNoZWV0XHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5ib3R0b21TaGVldFxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogYCRtZEJvdHRvbVNoZWV0YCBvcGVucyBhIGJvdHRvbSBzaGVldCBvdmVyIHRoZSBhcHAgYW5kIHByb3ZpZGVzIGEgc2ltcGxlIHByb21pc2UgQVBJLlxyXG4gKlxyXG4gKiAjIyBSZXN0cmljdGlvbnNcclxuICpcclxuICogLSBUaGUgYm90dG9tIHNoZWV0J3MgdGVtcGxhdGUgbXVzdCBoYXZlIGFuIG91dGVyIGA8bWQtYm90dG9tLXNoZWV0PmAgZWxlbWVudC5cclxuICogLSBBZGQgdGhlIGBtZC1ncmlkYCBjbGFzcyB0byB0aGUgYm90dG9tIHNoZWV0IGZvciBhIGdyaWQgbGF5b3V0LlxyXG4gKiAtIEFkZCB0aGUgYG1kLWxpc3RgIGNsYXNzIHRvIHRoZSBib3R0b20gc2hlZXQgZm9yIGEgbGlzdCBsYXlvdXQuXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJNeUNvbnRyb2xsZXJcIj5cclxuICogICA8bWQtYnV0dG9uIG5nLWNsaWNrPVwib3BlbkJvdHRvbVNoZWV0KClcIj5cclxuICogICAgIE9wZW4gYSBCb3R0b20gU2hlZXQhXHJcbiAqICAgPC9tZC1idXR0b24+XHJcbiAqIDwvZGl2PlxyXG4gKiA8L2hsanM+XHJcbiAqIDxobGpzIGxhbmc9XCJqc1wiPlxyXG4gKiB2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFsnbmdNYXRlcmlhbCddKTtcclxuICogYXBwLmNvbnRyb2xsZXIoJ015Q29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJG1kQm90dG9tU2hlZXQpIHtcclxuICogICAkc2NvcGUub3BlbkJvdHRvbVNoZWV0ID0gZnVuY3Rpb24oKSB7XHJcbiAqICAgICAkbWRCb3R0b21TaGVldC5zaG93KHtcclxuICogICAgICAgdGVtcGxhdGU6ICc8bWQtYm90dG9tLXNoZWV0PkhlbGxvITwvbWQtYm90dG9tLXNoZWV0PidcclxuICogICAgIH0pO1xyXG4gKiAgIH07XHJcbiAqIH0pO1xyXG4gKiA8L2hsanM+XHJcbiAqL1xyXG5cclxuIC8qKlxyXG4gKiBAbmdkb2MgbWV0aG9kXHJcbiAqIEBuYW1lICRtZEJvdHRvbVNoZWV0I3Nob3dcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIFNob3cgYSBib3R0b20gc2hlZXQgd2l0aCB0aGUgc3BlY2lmaWVkIG9wdGlvbnMuXHJcbiAqXHJcbiAqIEBwYXJhbSB7b2JqZWN0fSBvcHRpb25zIEFuIG9wdGlvbnMgb2JqZWN0LCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcclxuICpcclxuICogICAtIGB0ZW1wbGF0ZVVybGAgLSBge3N0cmluZz19YDogVGhlIHVybCBvZiBhbiBodG1sIHRlbXBsYXRlIGZpbGUgdGhhdCB3aWxsXHJcbiAqICAgYmUgdXNlZCBhcyB0aGUgY29udGVudCBvZiB0aGUgYm90dG9tIHNoZWV0LiBSZXN0cmljdGlvbnM6IHRoZSB0ZW1wbGF0ZSBtdXN0XHJcbiAqICAgaGF2ZSBhbiBvdXRlciBgbWQtYm90dG9tLXNoZWV0YCBlbGVtZW50LlxyXG4gKiAgIC0gYHRlbXBsYXRlYCAtIGB7c3RyaW5nPX1gOiBTYW1lIGFzIHRlbXBsYXRlVXJsLCBleGNlcHQgdGhpcyBpcyBhbiBhY3R1YWxcclxuICogICB0ZW1wbGF0ZSBzdHJpbmcuXHJcbiAqICAgLSBgc2NvcGVgIC0gYHtvYmplY3Q9fWA6IHRoZSBzY29wZSB0byBsaW5rIHRoZSB0ZW1wbGF0ZSAvIGNvbnRyb2xsZXIgdG8uIElmIG5vbmUgaXMgc3BlY2lmaWVkLCBpdCB3aWxsIGNyZWF0ZSBhIG5ldyBjaGlsZCBzY29wZS5cclxuICogICAgIFRoaXMgc2NvcGUgd2lsbCBiZSBkZXN0cm95ZWQgd2hlbiB0aGUgYm90dG9tIHNoZWV0IGlzIHJlbW92ZWQgdW5sZXNzIGBwcmVzZXJ2ZVNjb3BlYCBpcyBzZXQgdG8gdHJ1ZS5cclxuICogICAtIGBwcmVzZXJ2ZVNjb3BlYCAtIGB7Ym9vbGVhbj19YDogd2hldGhlciB0byBwcmVzZXJ2ZSB0aGUgc2NvcGUgd2hlbiB0aGUgZWxlbWVudCBpcyByZW1vdmVkLiBEZWZhdWx0IGlzIGZhbHNlXHJcbiAqICAgLSBgY29udHJvbGxlcmAgLSBge3N0cmluZz19YDogVGhlIGNvbnRyb2xsZXIgdG8gYXNzb2NpYXRlIHdpdGggdGhpcyBib3R0b20gc2hlZXQuXHJcbiAqICAgLSBgbG9jYWxzYCAtIGB7c3RyaW5nPX1gOiBBbiBvYmplY3QgY29udGFpbmluZyBrZXkvdmFsdWUgcGFpcnMuIFRoZSBrZXlzIHdpbGxcclxuICogICBiZSB1c2VkIGFzIG5hbWVzIG9mIHZhbHVlcyB0byBpbmplY3QgaW50byB0aGUgY29udHJvbGxlci4gRm9yIGV4YW1wbGUsXHJcbiAqICAgYGxvY2Fsczoge3RocmVlOiAzfWAgd291bGQgaW5qZWN0IGB0aHJlZWAgaW50byB0aGUgY29udHJvbGxlciB3aXRoIHRoZSB2YWx1ZVxyXG4gKiAgIG9mIDMuXHJcbiAqICAgLSBgdGFyZ2V0RXZlbnRgIC0gYHtET01DbGlja0V2ZW50PX1gOiBBIGNsaWNrJ3MgZXZlbnQgb2JqZWN0LiBXaGVuIHBhc3NlZCBpbiBhcyBhbiBvcHRpb24sXHJcbiAqICAgdGhlIGxvY2F0aW9uIG9mIHRoZSBjbGljayB3aWxsIGJlIHVzZWQgYXMgdGhlIHN0YXJ0aW5nIHBvaW50IGZvciB0aGUgb3BlbmluZyBhbmltYXRpb25cclxuICogICBvZiB0aGUgdGhlIGRpYWxvZy5cclxuICogICAtIGByZXNvbHZlYCAtIGB7b2JqZWN0PX1gOiBTaW1pbGFyIHRvIGxvY2FscywgZXhjZXB0IGl0IHRha2VzIHByb21pc2VzIGFzIHZhbHVlc1xyXG4gKiAgIGFuZCB0aGUgYm90dG9tIHNoZWV0IHdpbGwgbm90IG9wZW4gdW50aWwgdGhlIHByb21pc2VzIHJlc29sdmUuXHJcbiAqICAgLSBgY29udHJvbGxlckFzYCAtIGB7c3RyaW5nPX1gOiBBbiBhbGlhcyB0byBhc3NpZ24gdGhlIGNvbnRyb2xsZXIgdG8gb24gdGhlIHNjb3BlLlxyXG4gKiAgIC0gYHBhcmVudGAgLSBge2VsZW1lbnQ9fWA6IFRoZSBlbGVtZW50IHRvIGFwcGVuZCB0aGUgYm90dG9tIHNoZWV0IHRvLiBUaGUgYHBhcmVudGAgbWF5IGJlIGEgYGZ1bmN0aW9uYCwgYHN0cmluZ2AsXHJcbiAqICAgYG9iamVjdGAsIG9yIG51bGwuIERlZmF1bHRzIHRvIGFwcGVuZGluZyB0byB0aGUgYm9keSBvZiB0aGUgcm9vdCBlbGVtZW50IChvciB0aGUgcm9vdCBlbGVtZW50KSBvZiB0aGUgYXBwbGljYXRpb24uXHJcbiAqICAgZS5nLiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRlbnQnKSkgb3IgXCIjY29udGVudFwiXHJcbiAqICAgLSBgZGlzYWJsZVBhcmVudFNjcm9sbGAgLSBge2Jvb2xlYW49fWA6IFdoZXRoZXIgdG8gZGlzYWJsZSBzY3JvbGxpbmcgd2hpbGUgdGhlIGJvdHRvbSBzaGVldCBpcyBvcGVuLlxyXG4gKiAgICAgRGVmYXVsdCB0cnVlLlxyXG4gKlxyXG4gKiBAcmV0dXJucyB7cHJvbWlzZX0gQSBwcm9taXNlIHRoYXQgY2FuIGJlIHJlc29sdmVkIHdpdGggYCRtZEJvdHRvbVNoZWV0LmhpZGUoKWAgb3JcclxuICogcmVqZWN0ZWQgd2l0aCBgJG1kQm90dG9tU2hlZXQuY2FuY2VsKClgLlxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbWV0aG9kXHJcbiAqIEBuYW1lICRtZEJvdHRvbVNoZWV0I2hpZGVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIEhpZGUgdGhlIGV4aXN0aW5nIGJvdHRvbSBzaGVldCBhbmQgcmVzb2x2ZSB0aGUgcHJvbWlzZSByZXR1cm5lZCBmcm9tXHJcbiAqIGAkbWRCb3R0b21TaGVldC5zaG93KClgLiBUaGlzIGNhbGwgd2lsbCBjbG9zZSB0aGUgbW9zdCByZWNlbnRseSBvcGVuZWQvY3VycmVudCBib3R0b21zaGVldCAoaWYgYW55KS5cclxuICpcclxuICogQHBhcmFtIHsqPX0gcmVzcG9uc2UgQW4gYXJndW1lbnQgZm9yIHRoZSByZXNvbHZlZCBwcm9taXNlLlxyXG4gKlxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbWV0aG9kXHJcbiAqIEBuYW1lICRtZEJvdHRvbVNoZWV0I2NhbmNlbFxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogSGlkZSB0aGUgZXhpc3RpbmcgYm90dG9tIHNoZWV0IGFuZCByZWplY3QgdGhlIHByb21pc2UgcmV0dXJuZWQgZnJvbVxyXG4gKiBgJG1kQm90dG9tU2hlZXQuc2hvdygpYC5cclxuICpcclxuICogQHBhcmFtIHsqPX0gcmVzcG9uc2UgQW4gYXJndW1lbnQgZm9yIHRoZSByZWplY3RlZCBwcm9taXNlLlxyXG4gKlxyXG4gKi9cclxuXHJcbmZ1bmN0aW9uIE1kQm90dG9tU2hlZXRQcm92aWRlcigkJGludGVyaW1FbGVtZW50UHJvdmlkZXIpIHtcclxuICAvLyBob3cgZmFzdCB3ZSBuZWVkIHRvIGZsaWNrIGRvd24gdG8gY2xvc2UgdGhlIHNoZWV0LCBwaXhlbHMvbXNcclxuICB2YXIgQ0xPU0lOR19WRUxPQ0lUWSA9IDAuNTtcclxuICB2YXIgUEFERElORyA9IDgwOyAvLyBzYW1lIGFzIGNzc1xyXG5cclxuICBib3R0b21TaGVldERlZmF1bHRzLiRpbmplY3QgPSBbXCIkYW5pbWF0ZVwiLCBcIiRtZENvbnN0YW50XCIsIFwiJG1kVXRpbFwiLCBcIiR0aW1lb3V0XCIsIFwiJGNvbXBpbGVcIiwgXCIkbWRUaGVtaW5nXCIsIFwiJG1kQm90dG9tU2hlZXRcIiwgXCIkcm9vdEVsZW1lbnRcIiwgXCIkbWRHZXN0dXJlXCJdO1xyXG4gIHJldHVybiAkJGludGVyaW1FbGVtZW50UHJvdmlkZXIoJyRtZEJvdHRvbVNoZWV0JylcclxuICAgIC5zZXREZWZhdWx0cyh7XHJcbiAgICAgIG1ldGhvZHM6IFsnZGlzYWJsZVBhcmVudFNjcm9sbCcsICdlc2NhcGVUb0Nsb3NlJywgJ3RhcmdldEV2ZW50J10sXHJcbiAgICAgIG9wdGlvbnM6IGJvdHRvbVNoZWV0RGVmYXVsdHNcclxuICAgIH0pO1xyXG5cclxuICAvKiBAbmdJbmplY3QgKi9cclxuICBmdW5jdGlvbiBib3R0b21TaGVldERlZmF1bHRzKCRhbmltYXRlLCAkbWRDb25zdGFudCwgJG1kVXRpbCwgJHRpbWVvdXQsICRjb21waWxlLCAkbWRUaGVtaW5nLCAkbWRCb3R0b21TaGVldCwgJHJvb3RFbGVtZW50LCAkbWRHZXN0dXJlKSB7XHJcbiAgICB2YXIgYmFja2Ryb3A7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdGhlbWFibGU6IHRydWUsXHJcbiAgICAgIHRhcmdldEV2ZW50OiBudWxsLFxyXG4gICAgICBvblNob3c6IG9uU2hvdyxcclxuICAgICAgb25SZW1vdmU6IG9uUmVtb3ZlLFxyXG4gICAgICBlc2NhcGVUb0Nsb3NlOiB0cnVlLFxyXG4gICAgICBkaXNhYmxlUGFyZW50U2Nyb2xsOiB0cnVlXHJcbiAgICB9O1xyXG5cclxuXHJcbiAgICBmdW5jdGlvbiBvblNob3coc2NvcGUsIGVsZW1lbnQsIG9wdGlvbnMpIHtcclxuXHJcbiAgICAgIGVsZW1lbnQgPSAkbWRVdGlsLmV4dHJhY3RFbGVtZW50QnlOYW1lKGVsZW1lbnQsICdtZC1ib3R0b20tc2hlZXQnKTtcclxuXHJcbiAgICAgIC8vIEFkZCBhIGJhY2tkcm9wIHRoYXQgd2lsbCBjbG9zZSBvbiBjbGlja1xyXG4gICAgICBiYWNrZHJvcCA9ICRjb21waWxlKCc8bWQtYmFja2Ryb3AgY2xhc3M9XCJtZC1vcGFxdWUgbWQtYm90dG9tLXNoZWV0LWJhY2tkcm9wXCI+Jykoc2NvcGUpO1xyXG4gICAgICBiYWNrZHJvcC5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkdGltZW91dCgkbWRCb3R0b21TaGVldC5jYW5jZWwpO1xyXG4gICAgICB9KTtcclxuICAgICAgJG1kVGhlbWluZy5pbmhlcml0KGJhY2tkcm9wLCBvcHRpb25zLnBhcmVudCk7XHJcblxyXG4gICAgICAkYW5pbWF0ZS5lbnRlcihiYWNrZHJvcCwgb3B0aW9ucy5wYXJlbnQsIG51bGwpO1xyXG5cclxuICAgICAgdmFyIGJvdHRvbVNoZWV0ID0gbmV3IEJvdHRvbVNoZWV0KGVsZW1lbnQsIG9wdGlvbnMucGFyZW50KTtcclxuICAgICAgb3B0aW9ucy5ib3R0b21TaGVldCA9IGJvdHRvbVNoZWV0O1xyXG5cclxuICAgICAgLy8gR2l2ZSB1cCBmb2N1cyBvbiBjYWxsaW5nIGl0ZW1cclxuICAgICAgb3B0aW9ucy50YXJnZXRFdmVudCAmJiBhbmd1bGFyLmVsZW1lbnQob3B0aW9ucy50YXJnZXRFdmVudC50YXJnZXQpLmJsdXIoKTtcclxuICAgICAgJG1kVGhlbWluZy5pbmhlcml0KGJvdHRvbVNoZWV0LmVsZW1lbnQsIG9wdGlvbnMucGFyZW50KTtcclxuXHJcbiAgICAgIGlmIChvcHRpb25zLmRpc2FibGVQYXJlbnRTY3JvbGwpIHtcclxuICAgICAgICBvcHRpb25zLmxhc3RPdmVyZmxvdyA9IG9wdGlvbnMucGFyZW50LmNzcygnb3ZlcmZsb3cnKTtcclxuICAgICAgICBvcHRpb25zLnBhcmVudC5jc3MoJ292ZXJmbG93JywgJ2hpZGRlbicpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gJGFuaW1hdGUuZW50ZXIoYm90dG9tU2hlZXQuZWxlbWVudCwgb3B0aW9ucy5wYXJlbnQpXHJcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICB2YXIgZm9jdXNhYmxlID0gYW5ndWxhci5lbGVtZW50KFxyXG4gICAgICAgICAgICBlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbicpIHx8XHJcbiAgICAgICAgICAgIGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignYScpIHx8XHJcbiAgICAgICAgICAgIGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignW25nLWNsaWNrXScpXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgICAgZm9jdXNhYmxlLmZvY3VzKCk7XHJcblxyXG4gICAgICAgICAgaWYgKG9wdGlvbnMuZXNjYXBlVG9DbG9zZSkge1xyXG4gICAgICAgICAgICBvcHRpb25zLnJvb3RFbGVtZW50S2V5dXBDYWxsYmFjayA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09PSAkbWRDb25zdGFudC5LRVlfQ09ERS5FU0NBUEUpIHtcclxuICAgICAgICAgICAgICAgICR0aW1lb3V0KCRtZEJvdHRvbVNoZWV0LmNhbmNlbCk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAkcm9vdEVsZW1lbnQub24oJ2tleXVwJywgb3B0aW9ucy5yb290RWxlbWVudEtleXVwQ2FsbGJhY2spO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBvblJlbW92ZShzY29wZSwgZWxlbWVudCwgb3B0aW9ucykge1xyXG5cclxuICAgICAgdmFyIGJvdHRvbVNoZWV0ID0gb3B0aW9ucy5ib3R0b21TaGVldDtcclxuXHJcbiAgICAgICRhbmltYXRlLmxlYXZlKGJhY2tkcm9wKTtcclxuICAgICAgcmV0dXJuICRhbmltYXRlLmxlYXZlKGJvdHRvbVNoZWV0LmVsZW1lbnQpLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMuZGlzYWJsZVBhcmVudFNjcm9sbCkge1xyXG4gICAgICAgICAgb3B0aW9ucy5wYXJlbnQuY3NzKCdvdmVyZmxvdycsIG9wdGlvbnMubGFzdE92ZXJmbG93KTtcclxuICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmxhc3RPdmVyZmxvdztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGJvdHRvbVNoZWV0LmNsZWFudXAoKTtcclxuXHJcbiAgICAgICAgLy8gUmVzdG9yZSBmb2N1c1xyXG4gICAgICAgIG9wdGlvbnMudGFyZ2V0RXZlbnQgJiYgYW5ndWxhci5lbGVtZW50KG9wdGlvbnMudGFyZ2V0RXZlbnQudGFyZ2V0KS5mb2N1cygpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEJvdHRvbVNoZWV0IGNsYXNzIHRvIGFwcGx5IGJvdHRvbS1zaGVldCBiZWhhdmlvciB0byBhbiBlbGVtZW50XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIEJvdHRvbVNoZWV0KGVsZW1lbnQsIHBhcmVudCkge1xyXG4gICAgICB2YXIgZGVyZWdpc3RlciA9ICRtZEdlc3R1cmUucmVnaXN0ZXIocGFyZW50LCAnZHJhZycsIHsgaG9yaXpvbnRhbDogZmFsc2UgfSk7XHJcbiAgICAgIHBhcmVudC5vbignJG1kLmRyYWdzdGFydCcsIG9uRHJhZ1N0YXJ0KVxyXG4gICAgICAgIC5vbignJG1kLmRyYWcnLCBvbkRyYWcpXHJcbiAgICAgICAgLm9uKCckbWQuZHJhZ2VuZCcsIG9uRHJhZ0VuZCk7XHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGVsZW1lbnQ6IGVsZW1lbnQsXHJcbiAgICAgICAgY2xlYW51cDogZnVuY3Rpb24gY2xlYW51cCgpIHtcclxuICAgICAgICAgIGRlcmVnaXN0ZXIoKTtcclxuICAgICAgICAgIHBhcmVudC5vZmYoJyRtZC5kcmFnc3RhcnQnLCBvbkRyYWdTdGFydClcclxuICAgICAgICAgICAgLm9mZignJG1kLmRyYWcnLCBvbkRyYWcpXHJcbiAgICAgICAgICAgIC5vZmYoJyRtZC5kcmFnZW5kJywgb25EcmFnRW5kKTtcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBmdW5jdGlvbiBvbkRyYWdTdGFydChldikge1xyXG4gICAgICAgIC8vIERpc2FibGUgdHJhbnNpdGlvbnMgb24gdHJhbnNmb3JtIHNvIHRoYXQgaXQgZmVlbHMgZmFzdFxyXG4gICAgICAgIGVsZW1lbnQuY3NzKCRtZENvbnN0YW50LkNTUy5UUkFOU0lUSU9OX0RVUkFUSU9OLCAnMG1zJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIG9uRHJhZyhldikge1xyXG4gICAgICAgIHZhciB0cmFuc2Zvcm0gPSBldi5wb2ludGVyLmRpc3RhbmNlWTtcclxuICAgICAgICBpZiAodHJhbnNmb3JtIDwgNSkge1xyXG4gICAgICAgICAgLy8gU2xvdyBkb3duIGRyYWcgd2hlbiB0cnlpbmcgdG8gZHJhZyB1cCwgYW5kIHN0b3AgYWZ0ZXIgUEFERElOR1xyXG4gICAgICAgICAgdHJhbnNmb3JtID0gTWF0aC5tYXgoLVBBRERJTkcsIHRyYW5zZm9ybSAvIDIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbGVtZW50LmNzcygkbWRDb25zdGFudC5DU1MuVFJBTlNGT1JNLCAndHJhbnNsYXRlM2QoMCwnICsgKFBBRERJTkcgKyB0cmFuc2Zvcm0pICsgJ3B4LDApJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIG9uRHJhZ0VuZChldikge1xyXG4gICAgICAgIGlmIChldi5wb2ludGVyLmRpc3RhbmNlWSA+IDAgJiZcclxuICAgICAgICAgICAgKGV2LnBvaW50ZXIuZGlzdGFuY2VZID4gMjAgfHwgTWF0aC5hYnMoZXYucG9pbnRlci52ZWxvY2l0eVkpID4gQ0xPU0lOR19WRUxPQ0lUWSkpIHtcclxuICAgICAgICAgIHZhciBkaXN0YW5jZVJlbWFpbmluZyA9IGVsZW1lbnQucHJvcCgnb2Zmc2V0SGVpZ2h0JykgLSBldi5wb2ludGVyLmRpc3RhbmNlWTtcclxuICAgICAgICAgIHZhciB0cmFuc2l0aW9uRHVyYXRpb24gPSBNYXRoLm1pbihkaXN0YW5jZVJlbWFpbmluZyAvIGV2LnBvaW50ZXIudmVsb2NpdHlZICogMC43NSwgNTAwKTtcclxuICAgICAgICAgIGVsZW1lbnQuY3NzKCRtZENvbnN0YW50LkNTUy5UUkFOU0lUSU9OX0RVUkFUSU9OLCB0cmFuc2l0aW9uRHVyYXRpb24gKyAnbXMnKTtcclxuICAgICAgICAgICR0aW1lb3V0KCRtZEJvdHRvbVNoZWV0LmNhbmNlbCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGVsZW1lbnQuY3NzKCRtZENvbnN0YW50LkNTUy5UUkFOU0lUSU9OX0RVUkFUSU9OLCAnJyk7XHJcbiAgICAgICAgICBlbGVtZW50LmNzcygkbWRDb25zdGFudC5DU1MuVFJBTlNGT1JNLCAnJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbn1cclxuTWRCb3R0b21TaGVldFByb3ZpZGVyLiRpbmplY3QgPSBbXCIkJGludGVyaW1FbGVtZW50UHJvdmlkZXJcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKipcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLmJ1dHRvblxyXG4gKiBAZGVzY3JpcHRpb25cclxuICpcclxuICogQnV0dG9uXHJcbiAqL1xyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmJ1dHRvbicsIFsgJ21hdGVyaWFsLmNvcmUnIF0pXHJcbiAgICAuZGlyZWN0aXZlKCdtZEJ1dHRvbicsIE1kQnV0dG9uRGlyZWN0aXZlKTtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAqIEBuYW1lIG1kQnV0dG9uXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5idXR0b25cclxuICpcclxuICogQHJlc3RyaWN0IEVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIGA8bWQtYnV0dG9uPmAgaXMgYSBidXR0b24gZGlyZWN0aXZlIHdpdGggb3B0aW9uYWwgaW5rIHJpcHBsZXMgKGRlZmF1bHQgZW5hYmxlZCkuXHJcbiAqXHJcbiAqIElmIHlvdSBzdXBwbHkgYSBgaHJlZmAgb3IgYG5nLWhyZWZgIGF0dHJpYnV0ZSwgaXQgd2lsbCBiZWNvbWUgYW4gYDxhPmAgZWxlbWVudC4gT3RoZXJ3aXNlLCBpdCB3aWxsXHJcbiAqIGJlY29tZSBhIGA8YnV0dG9uPmAgZWxlbWVudC4gQXMgcGVyIHRoZSBbTWF0ZXJpYWwgRGVzaWduIHNwZWNpZmljYXRpb25zXShodHRwOi8vd3d3Lmdvb2dsZS5jb20vZGVzaWduL3NwZWMvc3R5bGUvY29sb3IuaHRtbCNjb2xvci11aS1jb2xvci1hcHBsaWNhdGlvbilcclxuICogdGhlIEZBQiBidXR0b24gYmFja2dyb3VuZCBpcyBmaWxsZWQgd2l0aCB0aGUgYWNjZW50IGNvbG9yIFtieSBkZWZhdWx0XS4gVGhlIHByaW1hcnkgY29sb3IgcGFsZXR0ZSBtYXkgYmUgdXNlZCB3aXRoXHJcbiAqIHRoZSBgbWQtcHJpbWFyeWAgY2xhc3MuXHJcbiAqXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG1kLW5vLWluayBJZiBwcmVzZW50LCBkaXNhYmxlIHJpcHBsZSBpbmsgZWZmZWN0cy5cclxuICogQHBhcmFtIHtleHByZXNzaW9uPX0gbmctZGlzYWJsZWQgRW4vRGlzYWJsZSBiYXNlZCBvbiB0aGUgZXhwcmVzc2lvblxyXG4gKiBAcGFyYW0ge3N0cmluZz19IG1kLXJpcHBsZS1zaXplIE92ZXJyaWRlcyB0aGUgZGVmYXVsdCByaXBwbGUgc2l6ZSBsb2dpYy4gT3B0aW9uczogYGZ1bGxgLCBgcGFydGlhbGAsIGBhdXRvYFxyXG4gKiBAcGFyYW0ge3N0cmluZz19IGFyaWEtbGFiZWwgQWRkcyBhbHRlcm5hdGl2ZSB0ZXh0IHRvIGJ1dHRvbiBmb3IgYWNjZXNzaWJpbGl0eSwgdXNlZnVsIGZvciBpY29uIGJ1dHRvbnMuXHJcbiAqIElmIG5vIGRlZmF1bHQgdGV4dCBpcyBmb3VuZCwgYSB3YXJuaW5nIHdpbGwgYmUgbG9nZ2VkLlxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICpcclxuICogUmVndWxhciBidXR0b25zOlxyXG4gKlxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiAgPG1kLWJ1dHRvbj4gRmxhdCBCdXR0b24gPC9tZC1idXR0b24+XHJcbiAqICA8bWQtYnV0dG9uIGhyZWY9XCJodHRwOi8vZ29vZ2xlLmNvbVwiPiBGbGF0IGxpbmsgPC9tZC1idXR0b24+XHJcbiAqICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtcmFpc2VkXCI+IFJhaXNlZCBCdXR0b24gPC9tZC1idXR0b24+XHJcbiAqICA8bWQtYnV0dG9uIG5nLWRpc2FibGVkPVwidHJ1ZVwiPiBEaXNhYmxlZCBCdXR0b24gPC9tZC1idXR0b24+XHJcbiAqICA8bWQtYnV0dG9uPlxyXG4gKiAgICA8bWQtaWNvbiBtZC1zdmctc3JjPVwieW91ci9pY29uLnN2Z1wiPjwvbWQtaWNvbj5cclxuICogICAgUmVnaXN0ZXIgTm93XHJcbiAqICA8L21kLWJ1dHRvbj5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiBGQUIgYnV0dG9uczpcclxuICpcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogIDxtZC1idXR0b24gY2xhc3M9XCJtZC1mYWJcIiBhcmlhLWxhYmVsPVwiRkFCXCI+XHJcbiAqICAgIDxtZC1pY29uIG1kLXN2Zy1zcmM9XCJ5b3VyL2ljb24uc3ZnXCI+PC9tZC1pY29uPlxyXG4gKiAgPC9tZC1idXR0b24+XHJcbiAqICA8IS0tIG1pbmktRkFCIC0tPlxyXG4gKiAgPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLWZhYiBtZC1taW5pXCIgYXJpYS1sYWJlbD1cIk1pbmkgRkFCXCI+XHJcbiAqICAgIDxtZC1pY29uIG1kLXN2Zy1zcmM9XCJ5b3VyL2ljb24uc3ZnXCI+PC9tZC1pY29uPlxyXG4gKiAgPC9tZC1idXR0b24+XHJcbiAqICA8IS0tIEJ1dHRvbiB3aXRoIFNWRyBJY29uIC0tPlxyXG4gKiAgPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLWljb24tYnV0dG9uXCIgYXJpYS1sYWJlbD1cIkN1c3RvbSBJY29uIEJ1dHRvblwiPlxyXG4gKiAgICA8bWQtaWNvbiBtZC1zdmctaWNvbj1cInBhdGgvdG8veW91ci5zdmdcIj48L21kLWljb24+XHJcbiAqICA8L21kLWJ1dHRvbj5cclxuICogPC9obGpzPlxyXG4gKi9cclxuZnVuY3Rpb24gTWRCdXR0b25EaXJlY3RpdmUoJG1kQnV0dG9uSW5rUmlwcGxlLCAkbWRUaGVtaW5nLCAkbWRBcmlhLCAkdGltZW91dCkge1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdFQScsXHJcbiAgICByZXBsYWNlOiB0cnVlLFxyXG4gICAgdHJhbnNjbHVkZTogdHJ1ZSxcclxuICAgIHRlbXBsYXRlOiBnZXRUZW1wbGF0ZSxcclxuICAgIGxpbms6IHBvc3RMaW5rXHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb24gaXNBbmNob3IoYXR0cikge1xyXG4gICAgcmV0dXJuIGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHIuaHJlZikgfHwgYW5ndWxhci5pc0RlZmluZWQoYXR0ci5uZ0hyZWYpIHx8IGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHIubmdMaW5rKSB8fCBhbmd1bGFyLmlzRGVmaW5lZChhdHRyLnVpU3JlZik7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBnZXRUZW1wbGF0ZShlbGVtZW50LCBhdHRyKSB7XHJcbiAgICByZXR1cm4gaXNBbmNob3IoYXR0cikgP1xyXG4gICAgICAgICAgICc8YSBjbGFzcz1cIm1kLWJ1dHRvblwiIG5nLXRyYW5zY2x1ZGU+PC9hPicgOlxyXG4gICAgICAgICAgICc8YnV0dG9uIGNsYXNzPVwibWQtYnV0dG9uXCIgbmctdHJhbnNjbHVkZT48L2J1dHRvbj4nO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcclxuICAgIHZhciBub2RlID0gZWxlbWVudFswXTtcclxuICAgICRtZFRoZW1pbmcoZWxlbWVudCk7XHJcbiAgICAkbWRCdXR0b25JbmtSaXBwbGUuYXR0YWNoKHNjb3BlLCBlbGVtZW50KTtcclxuXHJcbiAgICB2YXIgZWxlbWVudEhhc1RleHQgPSBub2RlLnRleHRDb250ZW50LnRyaW0oKTtcclxuICAgIGlmICghZWxlbWVudEhhc1RleHQpIHtcclxuICAgICAgJG1kQXJpYS5leHBlY3QoZWxlbWVudCwgJ2FyaWEtbGFiZWwnKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBGb3IgYW5jaG9yIGVsZW1lbnRzLCB3ZSBoYXZlIHRvIHNldCB0YWJpbmRleCBtYW51YWxseSB3aGVuIHRoZVxyXG4gICAgLy8gZWxlbWVudCBpcyBkaXNhYmxlZFxyXG4gICAgaWYgKGlzQW5jaG9yKGF0dHIpICYmIGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHIubmdEaXNhYmxlZCkgKSB7XHJcbiAgICAgIHNjb3BlLiR3YXRjaChhdHRyLm5nRGlzYWJsZWQsIGZ1bmN0aW9uKGlzRGlzYWJsZWQpIHtcclxuICAgICAgICBlbGVtZW50LmF0dHIoJ3RhYmluZGV4JywgaXNEaXNhYmxlZCA/IC0xIDogMCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGRpc2FibGluZyBjbGljayBldmVudCB3aGVuIGRpc2FibGVkIGlzIHRydWVcclxuICAgIGVsZW1lbnQub24oJ2NsaWNrJywgZnVuY3Rpb24oZSl7XHJcbiAgICAgIGlmIChhdHRyLmRpc2FibGVkID09PSB0cnVlKSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIHJlc3RyaWN0IGZvY3VzIHN0eWxlcyB0byB0aGUga2V5Ym9hcmRcclxuICAgIHNjb3BlLm1vdXNlQWN0aXZlID0gZmFsc2U7XHJcbiAgICBlbGVtZW50Lm9uKCdtb3VzZWRvd24nLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBzY29wZS5tb3VzZUFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgIHNjb3BlLm1vdXNlQWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfSwgMTAwKTtcclxuICAgICAgfSlcclxuICAgICAgLm9uKCdmb2N1cycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmKHNjb3BlLm1vdXNlQWN0aXZlID09PSBmYWxzZSkgeyBlbGVtZW50LmFkZENsYXNzKCdtZC1mb2N1c2VkJyk7IH1cclxuICAgICAgfSlcclxuICAgICAgLm9uKCdibHVyJywgZnVuY3Rpb24oKSB7IGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21kLWZvY3VzZWQnKTsgfSk7XHJcbiAgfVxyXG5cclxufVxyXG5NZEJ1dHRvbkRpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kQnV0dG9uSW5rUmlwcGxlXCIsIFwiJG1kVGhlbWluZ1wiLCBcIiRtZEFyaWFcIiwgXCIkdGltZW91dFwiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbW9kdWxlXHJcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuY2FyZFxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogQ2FyZCBjb21wb25lbnRzLlxyXG4gKi9cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuY2FyZCcsIFtcclxuICAnbWF0ZXJpYWwuY29yZSdcclxuXSlcclxuICAuZGlyZWN0aXZlKCdtZENhcmQnLCBtZENhcmREaXJlY3RpdmUpO1xyXG5cclxuXHJcblxyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbmFtZSBtZENhcmRcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmNhcmRcclxuICpcclxuICogQHJlc3RyaWN0IEVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIFRoZSBgPG1kLWNhcmQ+YCBkaXJlY3RpdmUgaXMgYSBjb250YWluZXIgZWxlbWVudCB1c2VkIHdpdGhpbiBgPG1kLWNvbnRlbnQ+YCBjb250YWluZXJzLlxyXG4gKlxyXG4gKiBBbiBpbWFnZSBpbmNsdWRlZCBhcyBhIGRpcmVjdCBkZXNjZW5kYW50IHdpbGwgZmlsbCB0aGUgY2FyZCdzIHdpZHRoLCB3aGlsZSB0aGUgYDxtZC1jYXJkLWNvbnRlbnQ+YFxyXG4gKiBjb250YWluZXIgd2lsbCB3cmFwIHRleHQgY29udGVudCBhbmQgcHJvdmlkZSBwYWRkaW5nLiBBbiBgPG1kLWNhcmQtZm9vdGVyPmAgZWxlbWVudCBjYW4gYmVcclxuICogb3B0aW9uYWxseSBpbmNsdWRlZCB0byBwdXQgY29udGVudCBmbHVzaCBhZ2FpbnN0IHRoZSBib3R0b20gZWRnZSBvZiB0aGUgY2FyZC5cclxuICpcclxuICogQWN0aW9uIGJ1dHRvbnMgY2FuIGJlIGluY2x1ZGVkIGluIGFuIGVsZW1lbnQgd2l0aCB0aGUgYC5tZC1hY3Rpb25zYCBjbGFzcywgYWxzbyB1c2VkIGluIGBtZC1kaWFsb2dgLlxyXG4gKiBZb3UgY2FuIHRoZW4gcG9zaXRpb24gYnV0dG9ucyB1c2luZyBsYXlvdXQgYXR0cmlidXRlcy5cclxuICpcclxuICogQ2FyZHMgaGF2ZSBjb25zdGFudCB3aWR0aCBhbmQgdmFyaWFibGUgaGVpZ2h0czsgd2hlcmUgdGhlIG1heGltdW0gaGVpZ2h0IGlzIGxpbWl0ZWQgdG8gd2hhdCBjYW5cclxuICogZml0IHdpdGhpbiBhIHNpbmdsZSB2aWV3IG9uIGEgcGxhdGZvcm0sIGJ1dCBpdCBjYW4gdGVtcG9yYXJpbHkgZXhwYW5kIGFzIG5lZWRlZC5cclxuICpcclxuICogQHVzYWdlXHJcbiAqICMjI0NhcmQgd2l0aCBvcHRpb25hbCBmb290ZXJcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPG1kLWNhcmQ+XHJcbiAqICA8aW1nIHNyYz1cImNhcmQtaW1hZ2UucG5nXCIgY2xhc3M9XCJtZC1jYXJkLWltYWdlXCIgYWx0PVwiaW1hZ2UgY2FwdGlvblwiPlxyXG4gKiAgPG1kLWNhcmQtY29udGVudD5cclxuICogICAgPGgyPkNhcmQgaGVhZGxpbmU8L2gyPlxyXG4gKiAgICA8cD5DYXJkIGNvbnRlbnQ8L3A+XHJcbiAqICA8L21kLWNhcmQtY29udGVudD5cclxuICogIDxtZC1jYXJkLWZvb3Rlcj5cclxuICogICAgQ2FyZCBmb290ZXJcclxuICogIDwvbWQtY2FyZC1mb290ZXI+XHJcbiAqIDwvbWQtY2FyZD5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiAjIyNDYXJkIHdpdGggYWN0aW9uc1xyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtY2FyZD5cclxuICogIDxpbWcgc3JjPVwiY2FyZC1pbWFnZS5wbmdcIiBjbGFzcz1cIm1kLWNhcmQtaW1hZ2VcIiBhbHQ9XCJpbWFnZSBjYXB0aW9uXCI+XHJcbiAqICA8bWQtY2FyZC1jb250ZW50PlxyXG4gKiAgICA8aDI+Q2FyZCBoZWFkbGluZTwvaDI+XHJcbiAqICAgIDxwPkNhcmQgY29udGVudDwvcD5cclxuICogIDwvbWQtY2FyZC1jb250ZW50PlxyXG4gKiAgPGRpdiBjbGFzcz1cIm1kLWFjdGlvbnNcIiBsYXlvdXQ9XCJyb3dcIiBsYXlvdXQtYWxpZ249XCJlbmQgY2VudGVyXCI+XHJcbiAqICAgIDxtZC1idXR0b24+QWN0aW9uIDE8L21kLWJ1dHRvbj5cclxuICogICAgPG1kLWJ1dHRvbj5BY3Rpb24gMjwvbWQtYnV0dG9uPlxyXG4gKiAgPC9kaXY+XHJcbiAqIDwvbWQtY2FyZD5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKi9cclxuZnVuY3Rpb24gbWRDYXJkRGlyZWN0aXZlKCRtZFRoZW1pbmcpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRyKSB7XHJcbiAgICAgICRtZFRoZW1pbmcoJGVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH07XHJcbn1cclxubWRDYXJkRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkbWRUaGVtaW5nXCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtb2R1bGVcclxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5jaGVja2JveFxyXG4gKiBAZGVzY3JpcHRpb24gQ2hlY2tib3ggbW9kdWxlIVxyXG4gKi9cclxuYW5ndWxhclxyXG4gIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuY2hlY2tib3gnLCBbJ21hdGVyaWFsLmNvcmUnXSlcclxuICAuZGlyZWN0aXZlKCdtZENoZWNrYm94JywgTWRDaGVja2JveERpcmVjdGl2ZSk7XHJcblxyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbmFtZSBtZENoZWNrYm94XHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5jaGVja2JveFxyXG4gKiBAcmVzdHJpY3QgRVxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogVGhlIGNoZWNrYm94IGRpcmVjdGl2ZSBpcyB1c2VkIGxpa2UgdGhlIG5vcm1hbCBbYW5ndWxhciBjaGVja2JveF0oaHR0cHM6Ly9kb2NzLmFuZ3VsYXJqcy5vcmcvYXBpL25nL2lucHV0L2lucHV0JTVCY2hlY2tib3glNUQpLlxyXG4gKlxyXG4gKiBBcyBwZXIgdGhlIFttYXRlcmlhbCBkZXNpZ24gc3BlY10oaHR0cDovL3d3dy5nb29nbGUuY29tL2Rlc2lnbi9zcGVjL3N0eWxlL2NvbG9yLmh0bWwjY29sb3ItdWktY29sb3ItYXBwbGljYXRpb24pXHJcbiAqIHRoZSBjaGVja2JveCBpcyBpbiB0aGUgYWNjZW50IGNvbG9yIGJ5IGRlZmF1bHQuIFRoZSBwcmltYXJ5IGNvbG9yIHBhbGV0dGUgbWF5IGJlIHVzZWQgd2l0aFxyXG4gKiB0aGUgYG1kLXByaW1hcnlgIGNsYXNzLlxyXG4gKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gbmctbW9kZWwgQXNzaWduYWJsZSBhbmd1bGFyIGV4cHJlc3Npb24gdG8gZGF0YS1iaW5kIHRvLlxyXG4gKiBAcGFyYW0ge3N0cmluZz19IG5hbWUgUHJvcGVydHkgbmFtZSBvZiB0aGUgZm9ybSB1bmRlciB3aGljaCB0aGUgY29udHJvbCBpcyBwdWJsaXNoZWQuXHJcbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbj19IG5nLXRydWUtdmFsdWUgVGhlIHZhbHVlIHRvIHdoaWNoIHRoZSBleHByZXNzaW9uIHNob3VsZCBiZSBzZXQgd2hlbiBzZWxlY3RlZC5cclxuICogQHBhcmFtIHtleHByZXNzaW9uPX0gbmctZmFsc2UtdmFsdWUgVGhlIHZhbHVlIHRvIHdoaWNoIHRoZSBleHByZXNzaW9uIHNob3VsZCBiZSBzZXQgd2hlbiBub3Qgc2VsZWN0ZWQuXHJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gbmctY2hhbmdlIEFuZ3VsYXIgZXhwcmVzc2lvbiB0byBiZSBleGVjdXRlZCB3aGVuIGlucHV0IGNoYW5nZXMgZHVlIHRvIHVzZXIgaW50ZXJhY3Rpb24gd2l0aCB0aGUgaW5wdXQgZWxlbWVudC5cclxuICogQHBhcmFtIHtib29sZWFuPX0gbWQtbm8taW5rIFVzZSBvZiBhdHRyaWJ1dGUgaW5kaWNhdGVzIHVzZSBvZiByaXBwbGUgaW5rIGVmZmVjdHNcclxuICogQHBhcmFtIHtzdHJpbmc9fSBhcmlhLWxhYmVsIEFkZHMgbGFiZWwgdG8gY2hlY2tib3ggZm9yIGFjY2Vzc2liaWxpdHkuXHJcbiAqIERlZmF1bHRzIHRvIGNoZWNrYm94J3MgdGV4dC4gSWYgbm8gZGVmYXVsdCB0ZXh0IGlzIGZvdW5kLCBhIHdhcm5pbmcgd2lsbCBiZSBsb2dnZWQuXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtY2hlY2tib3ggbmctbW9kZWw9XCJpc0NoZWNrZWRcIiBhcmlhLWxhYmVsPVwiRmluaXNoZWQ/XCI+XHJcbiAqICAgRmluaXNoZWQgP1xyXG4gKiA8L21kLWNoZWNrYm94PlxyXG4gKlxyXG4gKiA8bWQtY2hlY2tib3ggbWQtbm8taW5rIG5nLW1vZGVsPVwiaGFzSW5rXCIgYXJpYS1sYWJlbD1cIk5vIEluayBFZmZlY3RzXCI+XHJcbiAqICAgTm8gSW5rIEVmZmVjdHNcclxuICogPC9tZC1jaGVja2JveD5cclxuICpcclxuICogPG1kLWNoZWNrYm94IG5nLWRpc2FibGVkPVwidHJ1ZVwiIG5nLW1vZGVsPVwiaXNEaXNhYmxlZFwiIGFyaWEtbGFiZWw9XCJEaXNhYmxlZFwiPlxyXG4gKiAgIERpc2FibGVkXHJcbiAqIDwvbWQtY2hlY2tib3g+XHJcbiAqXHJcbiAqIDwvaGxqcz5cclxuICpcclxuICovXHJcbmZ1bmN0aW9uIE1kQ2hlY2tib3hEaXJlY3RpdmUoaW5wdXREaXJlY3RpdmUsICRtZElua1JpcHBsZSwgJG1kQXJpYSwgJG1kQ29uc3RhbnQsICRtZFRoZW1pbmcsICRtZFV0aWwsICR0aW1lb3V0KSB7XHJcbiAgaW5wdXREaXJlY3RpdmUgPSBpbnB1dERpcmVjdGl2ZVswXTtcclxuICB2YXIgQ0hFQ0tFRF9DU1MgPSAnbWQtY2hlY2tlZCc7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgdHJhbnNjbHVkZTogdHJ1ZSxcclxuICAgIHJlcXVpcmU6ICc/bmdNb2RlbCcsXHJcbiAgICBwcmlvcml0eToyMTAsIC8vIFJ1biBiZWZvcmUgbmdBcmlhXHJcbiAgICB0ZW1wbGF0ZTogXHJcbiAgICAgICc8ZGl2IGNsYXNzPVwibWQtY29udGFpbmVyXCIgbWQtaW5rLXJpcHBsZSBtZC1pbmstcmlwcGxlLWNoZWNrYm94PicgK1xyXG4gICAgICAgICc8ZGl2IGNsYXNzPVwibWQtaWNvblwiPjwvZGl2PicgK1xyXG4gICAgICAnPC9kaXY+JyArXHJcbiAgICAgICc8ZGl2IG5nLXRyYW5zY2x1ZGUgY2xhc3M9XCJtZC1sYWJlbFwiPjwvZGl2PicsXHJcbiAgICBjb21waWxlOiBjb21waWxlXHJcbiAgfTtcclxuXHJcbiAgLy8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG4gIC8vIFByaXZhdGUgTWV0aG9kc1xyXG4gIC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuXHJcbiAgZnVuY3Rpb24gY29tcGlsZSAodEVsZW1lbnQsIHRBdHRycykge1xyXG5cclxuICAgIHRBdHRycy50eXBlID0gJ2NoZWNrYm94JztcclxuICAgIHRBdHRycy50YWJpbmRleCA9IHRBdHRycy50YWJpbmRleCB8fCAnMCc7XHJcbiAgICB0RWxlbWVudC5hdHRyKCdyb2xlJywgdEF0dHJzLnR5cGUpO1xyXG5cclxuICAgIHJldHVybiBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0ciwgbmdNb2RlbEN0cmwpIHtcclxuICAgICAgbmdNb2RlbEN0cmwgPSBuZ01vZGVsQ3RybCB8fCAkbWRVdGlsLmZha2VOZ01vZGVsKCk7XHJcbiAgICAgICRtZFRoZW1pbmcoZWxlbWVudCk7XHJcblxyXG4gICAgICBpZiAoYXR0ci5uZ0NoZWNrZWQpIHtcclxuICAgICAgICBzY29wZS4kd2F0Y2goXHJcbiAgICAgICAgICAgIHNjb3BlLiRldmFsLmJpbmQoc2NvcGUsIGF0dHIubmdDaGVja2VkKSxcclxuICAgICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZpZXdWYWx1ZS5iaW5kKG5nTW9kZWxDdHJsKVxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuICAgICAgJCR3YXRjaEV4cHIoJ25nRGlzYWJsZWQnLCAndGFiaW5kZXgnLCB7XHJcbiAgICAgICAgdHJ1ZTogJy0xJyxcclxuICAgICAgICBmYWxzZTogYXR0ci50YWJpbmRleFxyXG4gICAgICB9KTtcclxuICAgICAgJG1kQXJpYS5leHBlY3RXaXRoVGV4dChlbGVtZW50LCAnYXJpYS1sYWJlbCcpO1xyXG5cclxuICAgICAgLy8gUmV1c2UgdGhlIG9yaWdpbmFsIGlucHV0W3R5cGU9Y2hlY2tib3hdIGRpcmVjdGl2ZSBmcm9tIEFuZ3VsYXIgY29yZS5cclxuICAgICAgLy8gVGhpcyBpcyBhIGJpdCBoYWNreSBhcyB3ZSBuZWVkIG91ciBvd24gZXZlbnQgbGlzdGVuZXIgYW5kIG93biByZW5kZXJcclxuICAgICAgLy8gZnVuY3Rpb24uXHJcbiAgICAgIGlucHV0RGlyZWN0aXZlLmxpbmsucHJlKHNjb3BlLCB7XHJcbiAgICAgICAgb246IGFuZ3VsYXIubm9vcCxcclxuICAgICAgICAwOiB7fVxyXG4gICAgICB9LCBhdHRyLCBbbmdNb2RlbEN0cmxdKTtcclxuXHJcbiAgICAgIHNjb3BlLm1vdXNlQWN0aXZlID0gZmFsc2U7XHJcbiAgICAgIGVsZW1lbnQub24oJ2NsaWNrJywgbGlzdGVuZXIpXHJcbiAgICAgICAgLm9uKCdrZXlwcmVzcycsIGtleXByZXNzSGFuZGxlcilcclxuICAgICAgICAub24oJ21vdXNlZG93bicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgc2NvcGUubW91c2VBY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgc2NvcGUubW91c2VBY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgIH0sIDEwMCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oJ2ZvY3VzJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICBpZihzY29wZS5tb3VzZUFjdGl2ZSA9PT0gZmFsc2UpIHsgZWxlbWVudC5hZGRDbGFzcygnbWQtZm9jdXNlZCcpOyB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oJ2JsdXInLCBmdW5jdGlvbigpIHsgZWxlbWVudC5yZW1vdmVDbGFzcygnbWQtZm9jdXNlZCcpOyB9KTtcclxuXHJcbiAgICAgIG5nTW9kZWxDdHJsLiRyZW5kZXIgPSByZW5kZXI7XHJcblxyXG4gICAgICBmdW5jdGlvbiAkJHdhdGNoRXhwcihleHByLCBodG1sQXR0ciwgdmFsdWVPcHRzKSB7XHJcbiAgICAgICAgaWYgKGF0dHJbZXhwcl0pIHtcclxuICAgICAgICAgIHNjb3BlLiR3YXRjaChhdHRyW2V4cHJdLCBmdW5jdGlvbih2YWwpIHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlT3B0c1t2YWxdKSB7XHJcbiAgICAgICAgICAgICAgZWxlbWVudC5hdHRyKGh0bWxBdHRyLCB2YWx1ZU9wdHNbdmFsXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24ga2V5cHJlc3NIYW5kbGVyKGV2KSB7XHJcbiAgICAgICAgdmFyIGtleUNvZGUgPSBldi53aGljaCB8fCBldi5rZXlDb2RlO1xyXG4gICAgICAgIGlmIChrZXlDb2RlID09PSAkbWRDb25zdGFudC5LRVlfQ09ERS5TUEFDRSB8fCBrZXlDb2RlID09PSAkbWRDb25zdGFudC5LRVlfQ09ERS5FTlRFUikge1xyXG4gICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgIGlmICghZWxlbWVudC5oYXNDbGFzcygnbWQtZm9jdXNlZCcpKSB7IGVsZW1lbnQuYWRkQ2xhc3MoJ21kLWZvY3VzZWQnKTsgfVxyXG4gICAgICAgICAgbGlzdGVuZXIoZXYpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBmdW5jdGlvbiBsaXN0ZW5lcihldikge1xyXG4gICAgICAgIGlmIChlbGVtZW50WzBdLmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkgcmV0dXJuO1xyXG5cclxuICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAvLyBUb2dnbGUgdGhlIGNoZWNrYm94IHZhbHVlLi4uXHJcbiAgICAgICAgICB2YXIgdmlld1ZhbHVlID0gYXR0ci5uZ0NoZWNrZWQgPyBhdHRyLmNoZWNrZWQgOiAhbmdNb2RlbEN0cmwuJHZpZXdWYWx1ZTtcclxuXHJcbiAgICAgICAgICBuZ01vZGVsQ3RybC4kc2V0Vmlld1ZhbHVlKCB2aWV3VmFsdWUsIGV2ICYmIGV2LnR5cGUpO1xyXG4gICAgICAgICAgbmdNb2RlbEN0cmwuJHJlbmRlcigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiByZW5kZXIoKSB7XHJcbiAgICAgICAgaWYobmdNb2RlbEN0cmwuJHZpZXdWYWx1ZSkge1xyXG4gICAgICAgICAgZWxlbWVudC5hZGRDbGFzcyhDSEVDS0VEX0NTUyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoQ0hFQ0tFRF9DU1MpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuTWRDaGVja2JveERpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiaW5wdXREaXJlY3RpdmVcIiwgXCIkbWRJbmtSaXBwbGVcIiwgXCIkbWRBcmlhXCIsIFwiJG1kQ29uc3RhbnRcIiwgXCIkbWRUaGVtaW5nXCIsIFwiJG1kVXRpbFwiLCBcIiR0aW1lb3V0XCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtb2R1bGVcclxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5jaGlwc1xyXG4gKi9cclxuLypcclxuICogQHNlZSBqcyBmb2xkZXIgZm9yIGNoaXBzIGltcGxlbWVudGF0aW9uXHJcbiAqL1xyXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5jaGlwcycsIFtcclxuICAnbWF0ZXJpYWwuY29yZScsXHJcbiAgJ21hdGVyaWFsLmNvbXBvbmVudHMuYXV0b2NvbXBsZXRlJ1xyXG5dKTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbW9kdWxlXHJcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuY29udGVudFxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogU2Nyb2xsYWJsZSBjb250ZW50XHJcbiAqL1xyXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5jb250ZW50JywgW1xyXG4gICdtYXRlcmlhbC5jb3JlJ1xyXG5dKVxyXG4gIC5kaXJlY3RpdmUoJ21kQ29udGVudCcsIG1kQ29udGVudERpcmVjdGl2ZSk7XHJcblxyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbmFtZSBtZENvbnRlbnRcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmNvbnRlbnRcclxuICpcclxuICogQHJlc3RyaWN0IEVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIFRoZSBgPG1kLWNvbnRlbnQ+YCBkaXJlY3RpdmUgaXMgYSBjb250YWluZXIgZWxlbWVudCB1c2VmdWwgZm9yIHNjcm9sbGFibGUgY29udGVudFxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICpcclxuICogLSBBZGQgdGhlIGBbbGF5b3V0LXBhZGRpbmddYCBhdHRyaWJ1dGUgdG8gbWFrZSB0aGUgY29udGVudCBwYWRkZWQuXHJcbiAqXHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqICA8bWQtY29udGVudCBsYXlvdXQtcGFkZGluZz5cclxuICogICAgICBMb3JlbSBpcHN1bSBkb2xvciBzaXQgYW1ldCwgbmUgcXVvZCBub3Z1bSBtZWkuXHJcbiAqICA8L21kLWNvbnRlbnQ+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICovXHJcblxyXG5mdW5jdGlvbiBtZENvbnRlbnREaXJlY3RpdmUoJG1kVGhlbWluZykge1xyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgY29udHJvbGxlcjogWyckc2NvcGUnLCAnJGVsZW1lbnQnLCBDb250ZW50Q29udHJvbGxlcl0sXHJcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cikge1xyXG4gICAgICB2YXIgbm9kZSA9IGVsZW1lbnRbMF07XHJcblxyXG4gICAgICAkbWRUaGVtaW5nKGVsZW1lbnQpO1xyXG4gICAgICBzY29wZS4kYnJvYWRjYXN0KCckbWRDb250ZW50TG9hZGVkJywgZWxlbWVudCk7XHJcblxyXG4gICAgICBpb3NTY3JvbGxGaXgoZWxlbWVudFswXSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb24gQ29udGVudENvbnRyb2xsZXIoJHNjb3BlLCAkZWxlbWVudCkge1xyXG4gICAgdGhpcy4kc2NvcGUgPSAkc2NvcGU7XHJcbiAgICB0aGlzLiRlbGVtZW50ID0gJGVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbm1kQ29udGVudERpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kVGhlbWluZ1wiXTtcclxuXHJcbmZ1bmN0aW9uIGlvc1Njcm9sbEZpeChub2RlKSB7XHJcbiAgLy8gSU9TIEZJWDpcclxuICAvLyBJZiB3ZSBzY3JvbGwgd2hlcmUgdGhlcmUgaXMgbm8gbW9yZSByb29tIGZvciB0aGUgd2VidmlldyB0byBzY3JvbGwsXHJcbiAgLy8gYnkgZGVmYXVsdCB0aGUgd2VidmlldyBpdHNlbGYgd2lsbCBzY3JvbGwgdXAgYW5kIGRvd24sIHRoaXMgbG9va3MgcmVhbGx5XHJcbiAgLy8gYmFkLiAgU28gaWYgd2UgYXJlIHNjcm9sbGluZyB0byB0aGUgdmVyeSB0b3Agb3IgYm90dG9tLCBhZGQvc3VidHJhY3Qgb25lXHJcbiAgYW5ndWxhci5lbGVtZW50KG5vZGUpLm9uKCckbWQucHJlc3Nkb3duJywgZnVuY3Rpb24oZXYpIHtcclxuICAgIC8vIE9ubHkgdG91Y2ggZXZlbnRzXHJcbiAgICBpZiAoZXYucG9pbnRlci50eXBlICE9PSAndCcpIHJldHVybjtcclxuICAgIC8vIERvbid0IGxldCBhIGNoaWxkIGNvbnRlbnQncyB0b3VjaHN0YXJ0IHJ1aW4gaXQgZm9yIHVzLlxyXG4gICAgaWYgKGV2LiRtYXRlcmlhbFNjcm9sbEZpeGVkKSByZXR1cm47XHJcbiAgICBldi4kbWF0ZXJpYWxTY3JvbGxGaXhlZCA9IHRydWU7XHJcblxyXG4gICAgaWYgKG5vZGUuc2Nyb2xsVG9wID09PSAwKSB7XHJcbiAgICAgIG5vZGUuc2Nyb2xsVG9wID0gMTtcclxuICAgIH0gZWxzZSBpZiAobm9kZS5zY3JvbGxIZWlnaHQgPT09IG5vZGUuc2Nyb2xsVG9wICsgbm9kZS5vZmZzZXRIZWlnaHQpIHtcclxuICAgICAgbm9kZS5zY3JvbGxUb3AgLT0gMTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtb2R1bGVcclxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5kaWFsb2dcclxuICovXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmRpYWxvZycsIFtcclxuICAnbWF0ZXJpYWwuY29yZScsXHJcbiAgJ21hdGVyaWFsLmNvbXBvbmVudHMuYmFja2Ryb3AnXHJcbl0pXHJcbiAgLmRpcmVjdGl2ZSgnbWREaWFsb2cnLCBNZERpYWxvZ0RpcmVjdGl2ZSlcclxuICAucHJvdmlkZXIoJyRtZERpYWxvZycsIE1kRGlhbG9nUHJvdmlkZXIpO1xyXG5cclxuZnVuY3Rpb24gTWREaWFsb2dEaXJlY3RpdmUoJCRyQUYsICRtZFRoZW1pbmcpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XHJcbiAgICAgICRtZFRoZW1pbmcoZWxlbWVudCk7XHJcbiAgICAgICQkckFGKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBjb250ZW50ID0gZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCdtZC1kaWFsb2ctY29udGVudCcpO1xyXG4gICAgICAgIGlmIChjb250ZW50ICYmIGNvbnRlbnQuc2Nyb2xsSGVpZ2h0ID4gY29udGVudC5jbGllbnRIZWlnaHQpIHtcclxuICAgICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ21kLWNvbnRlbnQtb3ZlcmZsb3cnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuTWREaWFsb2dEaXJlY3RpdmUuJGluamVjdCA9IFtcIiQkckFGXCIsIFwiJG1kVGhlbWluZ1wiXTtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2Mgc2VydmljZVxyXG4gKiBAbmFtZSAkbWREaWFsb2dcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmRpYWxvZ1xyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogYCRtZERpYWxvZ2Agb3BlbnMgYSBkaWFsb2cgb3ZlciB0aGUgYXBwIHRvIGluZm9ybSB1c2VycyBhYm91dCBjcml0aWNhbCBpbmZvcm1hdGlvbiBvciByZXF1aXJlXHJcbiAqICB0aGVtIHRvIG1ha2UgZGVjaXNpb25zLiBUaGVyZSBhcmUgdHdvIGFwcHJvYWNoZXMgZm9yIHNldHVwOiBhIHNpbXBsZSBwcm9taXNlIEFQSVxyXG4gKiAgYW5kIHJlZ3VsYXIgb2JqZWN0IHN5bnRheC5cclxuICpcclxuICogIyMgUmVzdHJpY3Rpb25zXHJcbiAqXHJcbiAqIC0gVGhlIGRpYWxvZyBpcyBhbHdheXMgZ2l2ZW4gYW4gaXNvbGF0ZSBzY29wZS5cclxuICogLSBUaGUgZGlhbG9nJ3MgdGVtcGxhdGUgbXVzdCBoYXZlIGFuIG91dGVyIGA8bWQtZGlhbG9nPmAgZWxlbWVudC5cclxuICogICBJbnNpZGUsIHVzZSBhbiBgPG1kLWRpYWxvZy1jb250ZW50PmAgZWxlbWVudCBmb3IgdGhlIGRpYWxvZydzIGNvbnRlbnQsIGFuZCB1c2VcclxuICogICBhbiBlbGVtZW50IHdpdGggY2xhc3MgYG1kLWFjdGlvbnNgIGZvciB0aGUgZGlhbG9nJ3MgYWN0aW9ucy5cclxuICogLSBEaWFsb2dzIG11c3QgY292ZXIgdGhlIGVudGlyZSBhcHBsaWNhdGlvbiB0byBrZWVwIGludGVyYWN0aW9ucyBpbnNpZGUgb2YgdGhlbS5cclxuICogVXNlIHRoZSBgcGFyZW50YCBvcHRpb24gdG8gY2hhbmdlIHdoZXJlIGRpYWxvZ3MgYXJlIGFwcGVuZGVkLlxyXG4gKlxyXG4gKiAjIyBTaXppbmdcclxuICogLSBDb21wbGV4IGRpYWxvZ3MgY2FuIGJlIHNpemVkIHdpdGggYGZsZXg9XCJwZXJjZW50YWdlXCJgLCBpLmUuIGBmbGV4PVwiNjZcImAuXHJcbiAqIC0gRGVmYXVsdCBtYXgtd2lkdGggaXMgODAlIG9mIHRoZSBgcm9vdEVsZW1lbnRgIG9yIGBwYXJlbnRgLlxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPGRpdiAgbmctYXBwPVwiZGVtb0FwcFwiIG5nLWNvbnRyb2xsZXI9XCJFbXBsb3llZUNvbnRyb2xsZXJcIj5cclxuICogICA8ZGl2PlxyXG4gKiAgICAgPG1kLWJ1dHRvbiBuZy1jbGljaz1cInNob3dBbGVydCgpXCIgY2xhc3M9XCJtZC1yYWlzZWQgbWQtd2FyblwiPlxyXG4gKiAgICAgICBFbXBsb3llZSBBbGVydCFcclxuICogICAgICAgPC9tZC1idXR0b24+XHJcbiAqICAgPC9kaXY+XHJcbiAqICAgPGRpdj5cclxuICogICAgIDxtZC1idXR0b24gbmctY2xpY2s9XCJzaG93RGlhbG9nKCRldmVudClcIiBjbGFzcz1cIm1kLXJhaXNlZFwiPlxyXG4gKiAgICAgICBDdXN0b20gRGlhbG9nXHJcbiAqICAgICAgIDwvbWQtYnV0dG9uPlxyXG4gKiAgIDwvZGl2PlxyXG4gKiAgIDxkaXY+XHJcbiAqICAgICA8bWQtYnV0dG9uIG5nLWNsaWNrPVwiY2xvc2VBbGVydCgpXCIgbmctZGlzYWJsZWQ9XCIhaGFzQWxlcnQoKVwiIGNsYXNzPVwibWQtcmFpc2VkXCI+XHJcbiAqICAgICAgIENsb3NlIEFsZXJ0XHJcbiAqICAgICA8L21kLWJ1dHRvbj5cclxuICogICA8L2Rpdj5cclxuICogICA8ZGl2PlxyXG4gKiAgICAgPG1kLWJ1dHRvbiBuZy1jbGljaz1cInNob3dHcmVldGluZygkZXZlbnQpXCIgY2xhc3M9XCJtZC1yYWlzZWQgbWQtcHJpbWFyeVwiID5cclxuICogICAgICAgR3JlZXQgRW1wbG95ZWVcclxuICogICAgICAgPC9tZC1idXR0b24+XHJcbiAqICAgPC9kaXY+XHJcbiAqIDwvZGl2PlxyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqICMjIyBKYXZhU2NyaXB0OiBvYmplY3Qgc3ludGF4XHJcbiAqIDxobGpzIGxhbmc9XCJqc1wiPlxyXG4gKiAoZnVuY3Rpb24oYW5ndWxhciwgdW5kZWZpbmVkKXtcclxuICogICBcInVzZSBzdHJpY3RcIjtcclxuICpcclxuICogICBhbmd1bGFyXHJcbiAqICAgIC5tb2R1bGUoJ2RlbW9BcHAnLCBbJ25nTWF0ZXJpYWwnXSlcclxuICogICAgLmNvbnRyb2xsZXIoJ0FwcEN0cmwnLCBBcHBDb250cm9sbGVyKTtcclxuICpcclxuICogICBmdW5jdGlvbiBBcHBDb250cm9sbGVyKCRzY29wZSwgJG1kRGlhbG9nKSB7XHJcbiAqICAgICB2YXIgYWxlcnQ7XHJcbiAqICAgICAkc2NvcGUuc2hvd0FsZXJ0ID0gc2hvd0FsZXJ0O1xyXG4gKiAgICAgJHNjb3BlLnNob3dEaWFsb2cgPSBzaG93RGlhbG9nO1xyXG4gKiAgICAgJHNjb3BlLml0ZW1zID0gWzEsIDIsIDNdO1xyXG4gKlxyXG4gKiAgICAgLy8gSW50ZXJuYWwgbWV0aG9kXHJcbiAqICAgICBmdW5jdGlvbiBzaG93QWxlcnQoKSB7XHJcbiAqICAgICAgIGFsZXJ0ID0gJG1kRGlhbG9nLmFsZXJ0KHtcclxuICogICAgICAgICB0aXRsZTogJ0F0dGVudGlvbicsXHJcbiAqICAgICAgICAgY29udGVudDogJ1RoaXMgaXMgYW4gZXhhbXBsZSBvZiBob3cgZWFzeSBkaWFsb2dzIGNhbiBiZSEnLFxyXG4gKiAgICAgICAgIG9rOiAnQ2xvc2UnXHJcbiAqICAgICAgIH0pO1xyXG4gKlxyXG4gKiAgICAgICAkbWREaWFsb2dcclxuICogICAgICAgICAuc2hvdyggYWxlcnQgKVxyXG4gKiAgICAgICAgIC5maW5hbGx5KGZ1bmN0aW9uKCkge1xyXG4gKiAgICAgICAgICAgYWxlcnQgPSB1bmRlZmluZWQ7XHJcbiAqICAgICAgICAgfSk7XHJcbiAqICAgICB9XHJcbiAqXHJcbiAqICAgICBmdW5jdGlvbiBzaG93RGlhbG9nKCRldmVudCkge1xyXG4gKiAgICAgICAgdmFyIHBhcmVudEVsID0gYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpO1xyXG4gKiAgICAgICAgJG1kRGlhbG9nLnNob3coe1xyXG4gKiAgICAgICAgICBwYXJlbnQ6IHBhcmVudEVsLFxyXG4gKiAgICAgICAgICB0YXJnZXRFdmVudDogJGV2ZW50LFxyXG4gKiAgICAgICAgICB0ZW1wbGF0ZTpcclxuICogICAgICAgICAgICAnPG1kLWRpYWxvZyBhcmlhLWxhYmVsPVwiTGlzdCBkaWFsb2dcIj4nICtcclxuICogICAgICAgICAgICAnICA8bWQtZGlhbG9nLWNvbnRlbnQ+JytcclxuICogICAgICAgICAgICAnICAgIDxtZC1saXN0PicrXHJcbiAqICAgICAgICAgICAgJyAgICAgIDxtZC1saXN0LWl0ZW0gbmctcmVwZWF0PVwiaXRlbSBpbiBpdGVtc1wiPicrXHJcbiAqICAgICAgICAgICAgJyAgICAgICA8cD5OdW1iZXIge3tpdGVtfX08L3A+JyArXHJcbiAqICAgICAgICAgICAgJyAgICAgIDwvbWQtaXRlbT4nK1xyXG4gKiAgICAgICAgICAgICcgICAgPC9tZC1saXN0PicrXHJcbiAqICAgICAgICAgICAgJyAgPC9tZC1kaWFsb2ctY29udGVudD4nICtcclxuICogICAgICAgICAgICAnICA8ZGl2IGNsYXNzPVwibWQtYWN0aW9uc1wiPicgK1xyXG4gKiAgICAgICAgICAgICcgICAgPG1kLWJ1dHRvbiBuZy1jbGljaz1cImNsb3NlRGlhbG9nKClcIiBjbGFzcz1cIm1kLXByaW1hcnlcIj4nICtcclxuICogICAgICAgICAgICAnICAgICAgQ2xvc2UgRGlhbG9nJyArXHJcbiAqICAgICAgICAgICAgJyAgICA8L21kLWJ1dHRvbj4nICtcclxuICogICAgICAgICAgICAnICA8L2Rpdj4nICtcclxuICogICAgICAgICAgICAnPC9tZC1kaWFsb2c+JyxcclxuICogICAgICAgICAgbG9jYWxzOiB7XHJcbiAqICAgICAgICAgICAgaXRlbXM6ICRzY29wZS5pdGVtc1xyXG4gKiAgICAgICAgICB9LFxyXG4gKiAgICAgICAgICBjb250cm9sbGVyOiBEaWFsb2dDb250cm9sbGVyXHJcbiAqICAgICAgIH0pO1xyXG4gKiAgICAgICBmdW5jdGlvbiBEaWFsb2dDb250cm9sbGVyKCRzY29wZSwgJG1kRGlhbG9nLCBpdGVtcykge1xyXG4gKiAgICAgICAgICRzY29wZS5pdGVtcyA9IGl0ZW1zO1xyXG4gKiAgICAgICAgICRzY29wZS5jbG9zZURpYWxvZyA9IGZ1bmN0aW9uKCkge1xyXG4gKiAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcclxuICogICAgICAgICB9XHJcbiAqICAgICAgIH1cclxuICogICAgIH1cclxuICogICB9XHJcbiAqIH0pKGFuZ3VsYXIpO1xyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqICMjIyBKYXZhU2NyaXB0OiBwcm9taXNlIEFQSSBzeW50YXgsIGN1c3RvbSBkaWFsb2cgdGVtcGxhdGVcclxuICogPGhsanMgbGFuZz1cImpzXCI+XHJcbiAqIChmdW5jdGlvbihhbmd1bGFyLCB1bmRlZmluZWQpe1xyXG4gKiAgIFwidXNlIHN0cmljdFwiO1xyXG4gKlxyXG4gKiAgIGFuZ3VsYXJcclxuICogICAgIC5tb2R1bGUoJ2RlbW9BcHAnLCBbJ25nTWF0ZXJpYWwnXSlcclxuICogICAgIC5jb250cm9sbGVyKCdFbXBsb3llZUNvbnRyb2xsZXInLCBFbXBsb3llZUVkaXRvcilcclxuICogICAgIC5jb250cm9sbGVyKCdHcmVldGluZ0NvbnRyb2xsZXInLCBHcmVldGluZ0NvbnRyb2xsZXIpO1xyXG4gKlxyXG4gKiAgIC8vIEZpY3RpdGlvdXMgRW1wbG95ZWUgRWRpdG9yIHRvIHNob3cgaG93IHRvIHVzZSBzaW1wbGUgYW5kIGNvbXBsZXggZGlhbG9ncy5cclxuICpcclxuICogICBmdW5jdGlvbiBFbXBsb3llZUVkaXRvcigkc2NvcGUsICRtZERpYWxvZykge1xyXG4gKiAgICAgdmFyIGFsZXJ0O1xyXG4gKlxyXG4gKiAgICAgJHNjb3BlLnNob3dBbGVydCA9IHNob3dBbGVydDtcclxuICogICAgICRzY29wZS5jbG9zZUFsZXJ0ID0gY2xvc2VBbGVydDtcclxuICogICAgICRzY29wZS5zaG93R3JlZXRpbmcgPSBzaG93Q3VzdG9tR3JlZXRpbmc7XHJcbiAqXHJcbiAqICAgICAkc2NvcGUuaGFzQWxlcnQgPSBmdW5jdGlvbigpIHsgcmV0dXJuICEhYWxlcnQgfTtcclxuICogICAgICRzY29wZS51c2VyTmFtZSA9ICRzY29wZS51c2VyTmFtZSB8fCAnQm9iYnknO1xyXG4gKlxyXG4gKiAgICAgLy8gRGlhbG9nICMxIC0gU2hvdyBzaW1wbGUgYWxlcnQgZGlhbG9nIGFuZCBjYWNoZVxyXG4gKiAgICAgLy8gcmVmZXJlbmNlIHRvIGRpYWxvZyBpbnN0YW5jZVxyXG4gKlxyXG4gKiAgICAgZnVuY3Rpb24gc2hvd0FsZXJ0KCkge1xyXG4gKiAgICAgICBhbGVydCA9ICRtZERpYWxvZy5hbGVydCgpXHJcbiAqICAgICAgICAgLnRpdGxlKCdBdHRlbnRpb24sICcgKyAkc2NvcGUudXNlck5hbWUpXHJcbiAqICAgICAgICAgLmNvbnRlbnQoJ1RoaXMgaXMgYW4gZXhhbXBsZSBvZiBob3cgZWFzeSBkaWFsb2dzIGNhbiBiZSEnKVxyXG4gKiAgICAgICAgIC5vaygnQ2xvc2UnKTtcclxuICpcclxuICogICAgICAgJG1kRGlhbG9nXHJcbiAqICAgICAgICAgICAuc2hvdyggYWxlcnQgKVxyXG4gKiAgICAgICAgICAgLmZpbmFsbHkoZnVuY3Rpb24oKSB7XHJcbiAqICAgICAgICAgICAgIGFsZXJ0ID0gdW5kZWZpbmVkO1xyXG4gKiAgICAgICAgICAgfSk7XHJcbiAqICAgICB9XHJcbiAqXHJcbiAqICAgICAvLyBDbG9zZSB0aGUgc3BlY2lmaWVkIGRpYWxvZyBpbnN0YW5jZSBhbmQgcmVzb2x2ZSB3aXRoICdmaW5pc2hlZCcgZmxhZ1xyXG4gKiAgICAgLy8gTm9ybWFsbHkgdGhpcyBpcyBub3QgbmVlZGVkLCBqdXN0IHVzZSAnJG1kRGlhbG9nLmhpZGUoKScgdG8gY2xvc2VcclxuICogICAgIC8vIHRoZSBtb3N0IHJlY2VudCBkaWFsb2cgcG9wdXAuXHJcbiAqXHJcbiAqICAgICBmdW5jdGlvbiBjbG9zZUFsZXJ0KCkge1xyXG4gKiAgICAgICAkbWREaWFsb2cuaGlkZSggYWxlcnQsIFwiZmluaXNoZWRcIiApO1xyXG4gKiAgICAgICBhbGVydCA9IHVuZGVmaW5lZDtcclxuICogICAgIH1cclxuICpcclxuICogICAgIC8vIERpYWxvZyAjMiAtIERlbW9uc3RyYXRlIG1vcmUgY29tcGxleCBkaWFsb2dzIGNvbnN0cnVjdGlvbiBhbmQgcG9wdXAuXHJcbiAqXHJcbiAqICAgICBmdW5jdGlvbiBzaG93Q3VzdG9tR3JlZXRpbmcoJGV2ZW50KSB7XHJcbiAqICAgICAgICAgJG1kRGlhbG9nLnNob3coe1xyXG4gKiAgICAgICAgICAgdGFyZ2V0RXZlbnQ6ICRldmVudCxcclxuICogICAgICAgICAgIHRlbXBsYXRlOlxyXG4gKiAgICAgICAgICAgICAnPG1kLWRpYWxvZz4nICtcclxuICpcclxuICogICAgICAgICAgICAgJyAgPG1kLWRpYWxvZy1jb250ZW50PkhlbGxvIHt7IGVtcGxveWVlIH19ITwvbWQtZGlhbG9nLWNvbnRlbnQ+JyArXHJcbiAqXHJcbiAqICAgICAgICAgICAgICcgIDxkaXYgY2xhc3M9XCJtZC1hY3Rpb25zXCI+JyArXHJcbiAqICAgICAgICAgICAgICcgICAgPG1kLWJ1dHRvbiBuZy1jbGljaz1cImNsb3NlRGlhbG9nKClcIiBjbGFzcz1cIm1kLXByaW1hcnlcIj4nICtcclxuICogICAgICAgICAgICAgJyAgICAgIENsb3NlIEdyZWV0aW5nJyArXHJcbiAqICAgICAgICAgICAgICcgICAgPC9tZC1idXR0b24+JyArXHJcbiAqICAgICAgICAgICAgICcgIDwvZGl2PicgK1xyXG4gKiAgICAgICAgICAgICAnPC9tZC1kaWFsb2c+JyxcclxuICogICAgICAgICAgIGNvbnRyb2xsZXI6ICdHcmVldGluZ0NvbnRyb2xsZXInLFxyXG4gKiAgICAgICAgICAgb25Db21wbGV0ZTogYWZ0ZXJTaG93QW5pbWF0aW9uLFxyXG4gKiAgICAgICAgICAgbG9jYWxzOiB7IGVtcGxveWVlOiAkc2NvcGUudXNlck5hbWUgfVxyXG4gKiAgICAgICAgIH0pO1xyXG4gKlxyXG4gKiAgICAgICAgIC8vIFdoZW4gdGhlICdlbnRlcicgYW5pbWF0aW9uIGZpbmlzaGVzLi4uXHJcbiAqXHJcbiAqICAgICAgICAgZnVuY3Rpb24gYWZ0ZXJTaG93QW5pbWF0aW9uKHNjb3BlLCBlbGVtZW50LCBvcHRpb25zKSB7XHJcbiAqICAgICAgICAgICAgLy8gcG9zdC1zaG93IGNvZGUgaGVyZTogRE9NIGVsZW1lbnQgZm9jdXMsIGV0Yy5cclxuICogICAgICAgICB9XHJcbiAqICAgICB9XHJcbiAqXHJcbiAqICAgICAvLyBEaWFsb2cgIzMgLSBEZW1vbnN0cmF0ZSB1c2Ugb2YgQ29udHJvbGxlckFzIGFuZCBwYXNzaW5nICRzY29wZSB0byBkaWFsb2dcclxuICogICAgIC8vICAgICAgICAgICAgIEhlcmUgd2UgdXNlZCBuZy1jb250cm9sbGVyPVwiR3JlZXRpbmdDb250cm9sbGVyIGFzIHZtXCIgYW5kXHJcbiAqICAgICAvLyAgICAgICAgICAgICAkc2NvcGUudm0gPT09IDxjb250cm9sbGVyIGluc3RhbmNlPlxyXG4gKlxyXG4gKiAgICAgZnVuY3Rpb24gc2hvd0N1c3RvbUdyZWV0aW5nKCkge1xyXG4gKlxyXG4gKiAgICAgICAgJG1kRGlhbG9nLnNob3coe1xyXG4gKiAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcclxuICpcclxuICogICAgICAgICAgIHNjb3BlOiAkc2NvcGUsICAgICAgICAvLyB1c2UgcGFyZW50IHNjb3BlIGluIHRlbXBsYXRlXHJcbiAqICAgICAgICAgICBwcmVzZXJ2ZVNjb3BlOiB0cnVlLCAgLy8gZG8gbm90IGZvcmdldCB0aGlzIGlmIHVzZSBwYXJlbnQgc2NvcGVcclxuXHJcbiAqICAgICAgICAgICAvLyBTaW5jZSBHcmVldGluZ0NvbnRyb2xsZXIgaXMgaW5zdGFudGlhdGVkIHdpdGggQ29udHJvbGxlckFzIHN5bnRheFxyXG4gKiAgICAgICAgICAgLy8gQU5EIHdlIGFyZSBwYXNzaW5nIHRoZSBwYXJlbnQgJyRzY29wZScgdG8gdGhlIGRpYWxvZywgd2UgTVVTVFxyXG4gKiAgICAgICAgICAgLy8gdXNlICd2bS48eHh4PicgaW4gdGhlIHRlbXBsYXRlIG1hcmt1cFxyXG4gKlxyXG4gKiAgICAgICAgICAgdGVtcGxhdGU6ICc8bWQtZGlhbG9nPicgK1xyXG4gKiAgICAgICAgICAgICAgICAgICAgICcgIDxtZC1kaWFsb2ctY29udGVudD4nICtcclxuICogICAgICAgICAgICAgICAgICAgICAnICAgICBIaSBUaGVyZSB7e3ZtLmVtcGxveWVlfX0nICtcclxuICogICAgICAgICAgICAgICAgICAgICAnICA8L21kLWRpYWxvZy1jb250ZW50PicgK1xyXG4gKiAgICAgICAgICAgICAgICAgICAgICc8L21kLWRpYWxvZz4nLFxyXG4gKlxyXG4gKiAgICAgICAgICAgY29udHJvbGxlcjogZnVuY3Rpb24gRGlhbG9nQ29udHJvbGxlcigkc2NvcGUsICRtZERpYWxvZykge1xyXG4gKiAgICAgICAgICAgICAkc2NvcGUuY2xvc2VEaWFsb2cgPSBmdW5jdGlvbigpIHtcclxuICogICAgICAgICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xyXG4gKiAgICAgICAgICAgICB9XHJcbiAqICAgICAgICAgICB9XHJcbiAqICAgICAgICB9KTtcclxuICogICAgIH1cclxuICpcclxuICogICB9XHJcbiAqXHJcbiAqICAgLy8gR3JlZXRpbmcgY29udHJvbGxlciB1c2VkIHdpdGggdGhlIG1vcmUgY29tcGxleCAnc2hvd0N1c3RvbUdyZWV0aW5nKCknIGN1c3RvbSBkaWFsb2dcclxuICpcclxuICogICBmdW5jdGlvbiBHcmVldGluZ0NvbnRyb2xsZXIoJHNjb3BlLCAkbWREaWFsb2csIGVtcGxveWVlKSB7XHJcbiAqICAgICAvLyBBc3NpZ25lZCBmcm9tIGNvbnN0cnVjdGlvbiA8Y29kZT5sb2NhbHM8L2NvZGU+IG9wdGlvbnMuLi5cclxuICogICAgICRzY29wZS5lbXBsb3llZSA9IGVtcGxveWVlO1xyXG4gKlxyXG4gKiAgICAgJHNjb3BlLmNsb3NlRGlhbG9nID0gZnVuY3Rpb24oKSB7XHJcbiAqICAgICAgIC8vIEVhc2lseSBoaWRlcyBtb3N0IHJlY2VudCBkaWFsb2cgc2hvd24uLi5cclxuICogICAgICAgLy8gbm8gc3BlY2lmaWMgaW5zdGFuY2UgcmVmZXJlbmNlIGlzIG5lZWRlZC5cclxuICogICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcclxuICogICAgIH07XHJcbiAqICAgfVxyXG4gKlxyXG4gKiB9KShhbmd1bGFyKTtcclxuICogPC9obGpzPlxyXG4gKi9cclxuXHJcbiAvKipcclxuICogQG5nZG9jIG1ldGhvZFxyXG4gKiBAbmFtZSAkbWREaWFsb2cjYWxlcnRcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIEJ1aWxkcyBhIHByZWNvbmZpZ3VyZWQgZGlhbG9nIHdpdGggdGhlIHNwZWNpZmllZCBtZXNzYWdlLlxyXG4gKlxyXG4gKiBAcmV0dXJucyB7b2JqfSBhbiBgJG1kRGlhbG9nUHJlc2V0YCB3aXRoIHRoZSBjaGFpbmFibGUgY29uZmlndXJhdGlvbiBtZXRob2RzOlxyXG4gKlxyXG4gKiAtICRtZERpYWxvZ1ByZXNldCN0aXRsZShzdHJpbmcpIC0gc2V0cyB0aXRsZSB0byBzdHJpbmdcclxuICogLSAkbWREaWFsb2dQcmVzZXQjY29udGVudChzdHJpbmcpIC0gc2V0cyBjb250ZW50IC8gbWVzc2FnZSB0byBzdHJpbmdcclxuICogLSAkbWREaWFsb2dQcmVzZXQjb2soc3RyaW5nKSAtIHNldHMgb2theSBidXR0b24gdGV4dCB0byBzdHJpbmdcclxuICogLSAkbWREaWFsb2dQcmVzZXQjdGhlbWUoc3RyaW5nKSAtIHNldHMgdGhlIHRoZW1lIG9mIHRoZSBkaWFsb2dcclxuICpcclxuICovXHJcblxyXG4gLyoqXHJcbiAqIEBuZ2RvYyBtZXRob2RcclxuICogQG5hbWUgJG1kRGlhbG9nI2NvbmZpcm1cclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIEJ1aWxkcyBhIHByZWNvbmZpZ3VyZWQgZGlhbG9nIHdpdGggdGhlIHNwZWNpZmllZCBtZXNzYWdlLiBZb3UgY2FuIGNhbGwgc2hvdyBhbmQgdGhlIHByb21pc2UgcmV0dXJuZWRcclxuICogd2lsbCBiZSByZXNvbHZlZCBvbmx5IGlmIHRoZSB1c2VyIGNsaWNrcyB0aGUgY29uZmlybSBhY3Rpb24gb24gdGhlIGRpYWxvZy5cclxuICpcclxuICogQHJldHVybnMge29ian0gYW4gYCRtZERpYWxvZ1ByZXNldGAgd2l0aCB0aGUgY2hhaW5hYmxlIGNvbmZpZ3VyYXRpb24gbWV0aG9kczpcclxuICpcclxuICogQWRkaXRpb25hbGx5LCBpdCBzdXBwb3J0cyB0aGUgZm9sbG93aW5nIG1ldGhvZHM6XHJcbiAqXHJcbiAqIC0gJG1kRGlhbG9nUHJlc2V0I3RpdGxlKHN0cmluZykgLSBzZXRzIHRpdGxlIHRvIHN0cmluZ1xyXG4gKiAtICRtZERpYWxvZ1ByZXNldCNjb250ZW50KHN0cmluZykgLSBzZXRzIGNvbnRlbnQgLyBtZXNzYWdlIHRvIHN0cmluZ1xyXG4gKiAtICRtZERpYWxvZ1ByZXNldCNvayhzdHJpbmcpIC0gc2V0cyBva2F5IGJ1dHRvbiB0ZXh0IHRvIHN0cmluZ1xyXG4gKiAtICRtZERpYWxvZ1ByZXNldCNjYW5jZWwoc3RyaW5nKSAtIHNldHMgY2FuY2VsIGJ1dHRvbiB0ZXh0IHRvIHN0cmluZ1xyXG4gKiAtICRtZERpYWxvZ1ByZXNldCN0aGVtZShzdHJpbmcpIC0gc2V0cyB0aGUgdGhlbWUgb2YgdGhlIGRpYWxvZ1xyXG4gKlxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbWV0aG9kXHJcbiAqIEBuYW1lICRtZERpYWxvZyNzaG93XHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBTaG93IGEgZGlhbG9nIHdpdGggdGhlIHNwZWNpZmllZCBvcHRpb25zLlxyXG4gKlxyXG4gKiBAcGFyYW0ge29iamVjdH0gb3B0aW9uc09yUHJlc2V0IEVpdGhlciBwcm92aWRlIGFuIGAkbWREaWFsb2dQcmVzZXRgIHJldHVybmVkIGZyb20gYGFsZXJ0KClgLCBhbmRcclxuICogYGNvbmZpcm0oKWAsIG9yIGFuIG9wdGlvbnMgb2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOlxyXG4gKiAgIC0gYHRlbXBsYXRlVXJsYCAtIGB7c3RyaW5nPX1gOiBUaGUgdXJsIG9mIGEgdGVtcGxhdGUgdGhhdCB3aWxsIGJlIHVzZWQgYXMgdGhlIGNvbnRlbnRcclxuICogICBvZiB0aGUgZGlhbG9nLlxyXG4gKiAgIC0gYHRlbXBsYXRlYCAtIGB7c3RyaW5nPX1gOiBTYW1lIGFzIHRlbXBsYXRlVXJsLCBleGNlcHQgdGhpcyBpcyBhbiBhY3R1YWwgdGVtcGxhdGUgc3RyaW5nLlxyXG4gKiAgIC0gYHRhcmdldEV2ZW50YCAtIGB7RE9NQ2xpY2tFdmVudD19YDogQSBjbGljaydzIGV2ZW50IG9iamVjdC4gV2hlbiBwYXNzZWQgaW4gYXMgYW4gb3B0aW9uLFxyXG4gKiAgICAgdGhlIGxvY2F0aW9uIG9mIHRoZSBjbGljayB3aWxsIGJlIHVzZWQgYXMgdGhlIHN0YXJ0aW5nIHBvaW50IGZvciB0aGUgb3BlbmluZyBhbmltYXRpb25cclxuICogICAgIG9mIHRoZSB0aGUgZGlhbG9nLlxyXG4gKiAgIC0gYHNjb3BlYCAtIGB7b2JqZWN0PX1gOiB0aGUgc2NvcGUgdG8gbGluayB0aGUgdGVtcGxhdGUgLyBjb250cm9sbGVyIHRvLiBJZiBub25lIGlzIHNwZWNpZmllZCxcclxuICogICAgIGl0IHdpbGwgY3JlYXRlIGEgbmV3IGlzb2xhdGUgc2NvcGUuXHJcbiAqICAgICBUaGlzIHNjb3BlIHdpbGwgYmUgZGVzdHJveWVkIHdoZW4gdGhlIGRpYWxvZyBpcyByZW1vdmVkIHVubGVzcyBgcHJlc2VydmVTY29wZWAgaXMgc2V0IHRvIHRydWUuXHJcbiAqICAgLSBgcHJlc2VydmVTY29wZWAgLSBge2Jvb2xlYW49fWA6IHdoZXRoZXIgdG8gcHJlc2VydmUgdGhlIHNjb3BlIHdoZW4gdGhlIGVsZW1lbnQgaXMgcmVtb3ZlZC4gRGVmYXVsdCBpcyBmYWxzZVxyXG4gKiAgIC0gYGRpc2FibGVQYXJlbnRTY3JvbGxgIC0gYHtib29sZWFuPX1gOiBXaGV0aGVyIHRvIGRpc2FibGUgc2Nyb2xsaW5nIHdoaWxlIHRoZSBkaWFsb2cgaXMgb3Blbi5cclxuICogICAgIERlZmF1bHQgdHJ1ZS5cclxuICogICAtIGBoYXNCYWNrZHJvcGAgLSBge2Jvb2xlYW49fWA6IFdoZXRoZXIgdGhlcmUgc2hvdWxkIGJlIGFuIG9wYXF1ZSBiYWNrZHJvcCBiZWhpbmQgdGhlIGRpYWxvZy5cclxuICogICAgIERlZmF1bHQgdHJ1ZS5cclxuICogICAtIGBjbGlja091dHNpZGVUb0Nsb3NlYCAtIGB7Ym9vbGVhbj19YDogV2hldGhlciB0aGUgdXNlciBjYW4gY2xpY2sgb3V0c2lkZSB0aGUgZGlhbG9nIHRvXHJcbiAqICAgICBjbG9zZSBpdC4gRGVmYXVsdCBmYWxzZS5cclxuICogICAtIGBlc2NhcGVUb0Nsb3NlYCAtIGB7Ym9vbGVhbj19YDogV2hldGhlciB0aGUgdXNlciBjYW4gcHJlc3MgZXNjYXBlIHRvIGNsb3NlIHRoZSBkaWFsb2cuXHJcbiAqICAgICBEZWZhdWx0IHRydWUuXHJcbiAqICAgLSBgZm9jdXNPbk9wZW5gIC0gYHtib29sZWFuPX1gOiBBbiBvcHRpb24gdG8gb3ZlcnJpZGUgZm9jdXMgYmVoYXZpb3Igb24gb3Blbi4gT25seSBkaXNhYmxlIGlmXHJcbiAqICAgICBmb2N1c2luZyBzb21lIG90aGVyIHdheSwgYXMgZm9jdXMgbWFuYWdlbWVudCBpcyByZXF1aXJlZCBmb3IgZGlhbG9ncyB0byBiZSBhY2Nlc3NpYmxlLlxyXG4gKiAgICAgRGVmYXVsdHMgdG8gdHJ1ZS5cclxuICogICAtIGBjb250cm9sbGVyYCAtIGB7c3RyaW5nPX1gOiBUaGUgY29udHJvbGxlciB0byBhc3NvY2lhdGUgd2l0aCB0aGUgZGlhbG9nLiBUaGUgY29udHJvbGxlclxyXG4gKiAgICAgd2lsbCBiZSBpbmplY3RlZCB3aXRoIHRoZSBsb2NhbCBgJG1kRGlhbG9nYCwgd2hpY2ggcGFzc2VzIGFsb25nIGEgc2NvcGUgZm9yIHRoZSBkaWFsb2cuXHJcbiAqICAgLSBgbG9jYWxzYCAtIGB7b2JqZWN0PX1gOiBBbiBvYmplY3QgY29udGFpbmluZyBrZXkvdmFsdWUgcGFpcnMuIFRoZSBrZXlzIHdpbGwgYmUgdXNlZCBhcyBuYW1lc1xyXG4gKiAgICAgb2YgdmFsdWVzIHRvIGluamVjdCBpbnRvIHRoZSBjb250cm9sbGVyLiBGb3IgZXhhbXBsZSwgYGxvY2Fsczoge3RocmVlOiAzfWAgd291bGQgaW5qZWN0XHJcbiAqICAgICBgdGhyZWVgIGludG8gdGhlIGNvbnRyb2xsZXIsIHdpdGggdGhlIHZhbHVlIDMuIElmIGBiaW5kVG9Db250cm9sbGVyYCBpcyB0cnVlLCB0aGV5IHdpbGwgYmVcclxuICogICAgIGNvcGllZCB0byB0aGUgY29udHJvbGxlciBpbnN0ZWFkLlxyXG4gKiAgIC0gYGJpbmRUb0NvbnRyb2xsZXJgIC0gYGJvb2xgOiBiaW5kIHRoZSBsb2NhbHMgdG8gdGhlIGNvbnRyb2xsZXIsIGluc3RlYWQgb2YgcGFzc2luZyB0aGVtIGluLlxyXG4gKiAgICAgVGhlc2UgdmFsdWVzIHdpbGwgbm90IGJlIGF2YWlsYWJsZSB1bnRpbCBhZnRlciBpbml0aWFsaXphdGlvbi5cclxuICogICAtIGByZXNvbHZlYCAtIGB7b2JqZWN0PX1gOiBTaW1pbGFyIHRvIGxvY2FscywgZXhjZXB0IGl0IHRha2VzIHByb21pc2VzIGFzIHZhbHVlcywgYW5kIHRoZVxyXG4gKiAgICAgZGlhbG9nIHdpbGwgbm90IG9wZW4gdW50aWwgYWxsIG9mIHRoZSBwcm9taXNlcyByZXNvbHZlLlxyXG4gKiAgIC0gYGNvbnRyb2xsZXJBc2AgLSBge3N0cmluZz19YDogQW4gYWxpYXMgdG8gYXNzaWduIHRoZSBjb250cm9sbGVyIHRvIG9uIHRoZSBzY29wZS5cclxuICogICAtIGBwYXJlbnRgIC0gYHtlbGVtZW50PX1gOiBUaGUgZWxlbWVudCB0byBhcHBlbmQgdGhlIGRpYWxvZyB0by4gRGVmYXVsdHMgdG8gYXBwZW5kaW5nXHJcbiAqICAgICB0byB0aGUgcm9vdCBlbGVtZW50IG9mIHRoZSBhcHBsaWNhdGlvbi5cclxuICogICAtIGBvbkNvbXBsZXRlYCBge2Z1bmN0aW9uPX1gOiBDYWxsYmFjayBmdW5jdGlvbiB1c2VkIHRvIGFubm91bmNlIHdoZW4gdGhlIHNob3coKSBhY3Rpb24gaXNcclxuICogICAgIGZpbmlzaGVkLlxyXG4gKlxyXG4gKiBAcmV0dXJucyB7cHJvbWlzZX0gQSBwcm9taXNlIHRoYXQgY2FuIGJlIHJlc29sdmVkIHdpdGggYCRtZERpYWxvZy5oaWRlKClgIG9yXHJcbiAqIHJlamVjdGVkIHdpdGggYCRtZERpYWxvZy5jYW5jZWwoKWAuXHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtZXRob2RcclxuICogQG5hbWUgJG1kRGlhbG9nI2hpZGVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIEhpZGUgYW4gZXhpc3RpbmcgZGlhbG9nIGFuZCByZXNvbHZlIHRoZSBwcm9taXNlIHJldHVybmVkIGZyb20gYCRtZERpYWxvZy5zaG93KClgLlxyXG4gKlxyXG4gKiBAcGFyYW0geyo9fSByZXNwb25zZSBBbiBhcmd1bWVudCBmb3IgdGhlIHJlc29sdmVkIHByb21pc2UuXHJcbiAqXHJcbiAqIEByZXR1cm5zIHtwcm9taXNlfSBBIHByb21pc2UgdGhhdCBpcyByZXNvbHZlZCB3aGVuIHRoZSBkaWFsb2cgaGFzIGJlZW4gY2xvc2VkLlxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbWV0aG9kXHJcbiAqIEBuYW1lICRtZERpYWxvZyNjYW5jZWxcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIEhpZGUgYW4gZXhpc3RpbmcgZGlhbG9nIGFuZCByZWplY3QgdGhlIHByb21pc2UgcmV0dXJuZWQgZnJvbSBgJG1kRGlhbG9nLnNob3coKWAuXHJcbiAqXHJcbiAqIEBwYXJhbSB7Kj19IHJlc3BvbnNlIEFuIGFyZ3VtZW50IGZvciB0aGUgcmVqZWN0ZWQgcHJvbWlzZS5cclxuICpcclxuICogQHJldHVybnMge3Byb21pc2V9IEEgcHJvbWlzZSB0aGF0IGlzIHJlc29sdmVkIHdoZW4gdGhlIGRpYWxvZyBoYXMgYmVlbiBjbG9zZWQuXHJcbiAqL1xyXG5cclxuZnVuY3Rpb24gTWREaWFsb2dQcm92aWRlcigkJGludGVyaW1FbGVtZW50UHJvdmlkZXIpIHtcclxuXHJcbiAgdmFyIGFsZXJ0RGlhbG9nTWV0aG9kcyA9IFsndGl0bGUnLCAnY29udGVudCcsICdhcmlhTGFiZWwnLCAnb2snXTtcclxuXHJcbiAgYWR2YW5jZWREaWFsb2dPcHRpb25zLiRpbmplY3QgPSBbXCIkbWREaWFsb2dcIiwgXCIkbWRUaGVtaW5nXCJdO1xyXG4gIGRpYWxvZ0RlZmF1bHRPcHRpb25zLiRpbmplY3QgPSBbXCIkbWRBcmlhXCIsIFwiJGRvY3VtZW50XCIsIFwiJG1kVXRpbFwiLCBcIiRtZENvbnN0YW50XCIsIFwiJG1kVGhlbWluZ1wiLCBcIiRtZERpYWxvZ1wiLCBcIiR0aW1lb3V0XCIsIFwiJHJvb3RFbGVtZW50XCIsIFwiJGFuaW1hdGVcIiwgXCIkJHJBRlwiLCBcIiRxXCJdO1xyXG4gIHJldHVybiAkJGludGVyaW1FbGVtZW50UHJvdmlkZXIoJyRtZERpYWxvZycpXHJcbiAgICAuc2V0RGVmYXVsdHMoe1xyXG4gICAgICBtZXRob2RzOiBbJ2Rpc2FibGVQYXJlbnRTY3JvbGwnLCAnaGFzQmFja2Ryb3AnLCAnY2xpY2tPdXRzaWRlVG9DbG9zZScsICdlc2NhcGVUb0Nsb3NlJywgJ3RhcmdldEV2ZW50JywgJ3BhcmVudCddLFxyXG4gICAgICBvcHRpb25zOiBkaWFsb2dEZWZhdWx0T3B0aW9uc1xyXG4gICAgfSlcclxuICAgIC5hZGRQcmVzZXQoJ2FsZXJ0Jywge1xyXG4gICAgICBtZXRob2RzOiBbJ3RpdGxlJywgJ2NvbnRlbnQnLCAnYXJpYUxhYmVsJywgJ29rJywgJ3RoZW1lJ10sXHJcbiAgICAgIG9wdGlvbnM6IGFkdmFuY2VkRGlhbG9nT3B0aW9uc1xyXG4gICAgfSlcclxuICAgIC5hZGRQcmVzZXQoJ2NvbmZpcm0nLCB7XHJcbiAgICAgIG1ldGhvZHM6IFsndGl0bGUnLCAnY29udGVudCcsICdhcmlhTGFiZWwnLCAnb2snLCAnY2FuY2VsJywgJ3RoZW1lJ10sXHJcbiAgICAgIG9wdGlvbnM6IGFkdmFuY2VkRGlhbG9nT3B0aW9uc1xyXG4gICAgfSk7XHJcblxyXG4gIC8qIEBuZ0luamVjdCAqL1xyXG4gIGZ1bmN0aW9uIGFkdmFuY2VkRGlhbG9nT3B0aW9ucygkbWREaWFsb2csICRtZFRoZW1pbmcpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHRlbXBsYXRlOiBbXHJcbiAgICAgICAgJzxtZC1kaWFsb2cgbWQtdGhlbWU9XCJ7eyBkaWFsb2cudGhlbWUgfX1cIiBhcmlhLWxhYmVsPVwie3sgZGlhbG9nLmFyaWFMYWJlbCB9fVwiPicsXHJcbiAgICAgICAgICAnPG1kLWRpYWxvZy1jb250ZW50IHJvbGU9XCJkb2N1bWVudFwiIHRhYkluZGV4PVwiLTFcIj4nLFxyXG4gICAgICAgICAgICAnPGgyIGNsYXNzPVwibWQtdGl0bGVcIj57eyBkaWFsb2cudGl0bGUgfX08L2gyPicsXHJcbiAgICAgICAgICAgICc8cD57eyBkaWFsb2cuY29udGVudCB9fTwvcD4nLFxyXG4gICAgICAgICAgJzwvbWQtZGlhbG9nLWNvbnRlbnQ+JyxcclxuICAgICAgICAgICc8ZGl2IGNsYXNzPVwibWQtYWN0aW9uc1wiPicsXHJcbiAgICAgICAgICAgICc8bWQtYnV0dG9uIG5nLWlmPVwiZGlhbG9nLiR0eXBlID09IFxcJ2NvbmZpcm1cXCdcIicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgJyBuZy1jbGljaz1cImRpYWxvZy5hYm9ydCgpXCIgY2xhc3M9XCJtZC1wcmltYXJ5XCI+JyxcclxuICAgICAgICAgICAgICAne3sgZGlhbG9nLmNhbmNlbCB9fScsXHJcbiAgICAgICAgICAgICc8L21kLWJ1dHRvbj4nLFxyXG4gICAgICAgICAgICAnPG1kLWJ1dHRvbiBuZy1jbGljaz1cImRpYWxvZy5oaWRlKClcIiBjbGFzcz1cIm1kLXByaW1hcnlcIj4nLFxyXG4gICAgICAgICAgICAgICd7eyBkaWFsb2cub2sgfX0nLFxyXG4gICAgICAgICAgICAnPC9tZC1idXR0b24+JyxcclxuICAgICAgICAgICc8L2Rpdj4nLFxyXG4gICAgICAgICc8L21kLWRpYWxvZz4nXHJcbiAgICAgIF0uam9pbignJyksXHJcbiAgICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uIG1kRGlhbG9nQ3RybCgpIHtcclxuICAgICAgICB0aGlzLmhpZGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICRtZERpYWxvZy5oaWRlKHRydWUpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5hYm9ydCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgIH0sXHJcbiAgICAgIGNvbnRyb2xsZXJBczogJ2RpYWxvZycsXHJcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXHJcbiAgICAgIHRoZW1lOiAkbWRUaGVtaW5nLmRlZmF1bHRUaGVtZSgpXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyogQG5nSW5qZWN0ICovXHJcbiAgZnVuY3Rpb24gZGlhbG9nRGVmYXVsdE9wdGlvbnMoJG1kQXJpYSwgJGRvY3VtZW50LCAkbWRVdGlsLCAkbWRDb25zdGFudCwgJG1kVGhlbWluZywgJG1kRGlhbG9nLCAkdGltZW91dCwgJHJvb3RFbGVtZW50LCAkYW5pbWF0ZSwgJCRyQUYsICRxKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBoYXNCYWNrZHJvcDogdHJ1ZSxcclxuICAgICAgaXNvbGF0ZVNjb3BlOiB0cnVlLFxyXG4gICAgICBvblNob3c6IG9uU2hvdyxcclxuICAgICAgb25SZW1vdmU6IG9uUmVtb3ZlLFxyXG4gICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiBmYWxzZSxcclxuICAgICAgZXNjYXBlVG9DbG9zZTogdHJ1ZSxcclxuICAgICAgdGFyZ2V0RXZlbnQ6IG51bGwsXHJcbiAgICAgIGZvY3VzT25PcGVuOiB0cnVlLFxyXG4gICAgICBkaXNhYmxlUGFyZW50U2Nyb2xsOiB0cnVlLFxyXG4gICAgICB0cmFuc2Zvcm1UZW1wbGF0ZTogZnVuY3Rpb24odGVtcGxhdGUpIHtcclxuICAgICAgICByZXR1cm4gJzxkaXYgY2xhc3M9XCJtZC1kaWFsb2ctY29udGFpbmVyXCI+JyArIHRlbXBsYXRlICsgJzwvZGl2Pic7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gdHJhcEZvY3VzKGV2KSB7XHJcbiAgICAgIHZhciBkaWFsb2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtZC1kaWFsb2cnKTtcclxuXHJcbiAgICAgIGlmIChkaWFsb2cgJiYgIWRpYWxvZy5jb250YWlucyhldi50YXJnZXQpKSB7XHJcbiAgICAgICAgZXYuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgZGlhbG9nLmZvY3VzKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBPbiBzaG93IG1ldGhvZCBmb3IgZGlhbG9nc1xyXG4gICAgZnVuY3Rpb24gb25TaG93KHNjb3BlLCBlbGVtZW50LCBvcHRpb25zKSB7XHJcbiAgICAgIGFuZ3VsYXIuZWxlbWVudCgkZG9jdW1lbnRbMF0uYm9keSkuYWRkQ2xhc3MoJ21kLWRpYWxvZy1pcy1zaG93aW5nJyk7XHJcbiAgICAgIGVsZW1lbnQgPSAkbWRVdGlsLmV4dHJhY3RFbGVtZW50QnlOYW1lKGVsZW1lbnQsICdtZC1kaWFsb2cnKTtcclxuXHJcbiAgICAgIC8vIEluY2FzZSB0aGUgdXNlciBwcm92aWRlcyBhIHJhdyBkb20gZWxlbWVudCwgYWx3YXlzIHdyYXAgaXQgaW4ganFMaXRlXHJcbiAgICAgIG9wdGlvbnMucGFyZW50ID0gYW5ndWxhci5lbGVtZW50KG9wdGlvbnMucGFyZW50KTtcclxuXHJcbiAgICAgIG9wdGlvbnMucG9wSW5UYXJnZXQgPSBhbmd1bGFyLmVsZW1lbnQoKG9wdGlvbnMudGFyZ2V0RXZlbnQgfHwge30pLnRhcmdldCk7XHJcbiAgICAgIHZhciBjbG9zZUJ1dHRvbiA9IGZpbmRDbG9zZUJ1dHRvbigpO1xyXG5cclxuICAgICAgaWYgKG9wdGlvbnMuaGFzQmFja2Ryb3ApIHtcclxuICAgICAgICAvLyBGaXggZm9yIElFIDEwXHJcbiAgICAgICAgdmFyIGNvbXB1dGVGcm9tID0gKG9wdGlvbnMucGFyZW50WzBdID09ICRkb2N1bWVudFswXS5ib2R5ICYmICRkb2N1bWVudFswXS5kb2N1bWVudEVsZW1lbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgJGRvY3VtZW50WzBdLmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3ApID8gYW5ndWxhci5lbGVtZW50KCRkb2N1bWVudFswXS5kb2N1bWVudEVsZW1lbnQpIDogb3B0aW9ucy5wYXJlbnQ7XHJcbiAgICAgICAgdmFyIHBhcmVudE9mZnNldCA9IGNvbXB1dGVGcm9tLnByb3AoJ3Njcm9sbFRvcCcpO1xyXG4gICAgICAgIG9wdGlvbnMuYmFja2Ryb3AgPSBhbmd1bGFyLmVsZW1lbnQoJzxtZC1iYWNrZHJvcCBjbGFzcz1cIm1kLWRpYWxvZy1iYWNrZHJvcCBtZC1vcGFxdWVcIj4nKTtcclxuICAgICAgICBvcHRpb25zLmJhY2tkcm9wLmNzcygndG9wJywgcGFyZW50T2Zmc2V0ICsncHgnKTtcclxuICAgICAgICAkbWRUaGVtaW5nLmluaGVyaXQob3B0aW9ucy5iYWNrZHJvcCwgb3B0aW9ucy5wYXJlbnQpO1xyXG4gICAgICAgICRhbmltYXRlLmVudGVyKG9wdGlvbnMuYmFja2Ryb3AsIG9wdGlvbnMucGFyZW50KTtcclxuICAgICAgICBlbGVtZW50LmNzcygndG9wJywgcGFyZW50T2Zmc2V0ICsncHgnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIHJvbGUgPSAnZGlhbG9nJyxcclxuICAgICAgICAgIGVsZW1lbnRUb0ZvY3VzID0gY2xvc2VCdXR0b247XHJcblxyXG4gICAgICBpZiAob3B0aW9ucy4kdHlwZSA9PT0gJ2FsZXJ0Jykge1xyXG4gICAgICAgIHJvbGUgPSAnYWxlcnRkaWFsb2cnO1xyXG4gICAgICAgIGVsZW1lbnRUb0ZvY3VzID0gZWxlbWVudC5maW5kKCdtZC1kaWFsb2ctY29udGVudCcpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25maWd1cmVBcmlhKGVsZW1lbnQuZmluZCgnbWQtZGlhbG9nJyksIHJvbGUsIG9wdGlvbnMpO1xyXG5cclxuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCB0cmFwRm9jdXMsIHRydWUpO1xyXG5cclxuICAgICAgaWYgKG9wdGlvbnMuZGlzYWJsZVBhcmVudFNjcm9sbCkge1xyXG4gICAgICAgIG9wdGlvbnMubGFzdE92ZXJmbG93ID0gb3B0aW9ucy5wYXJlbnQuY3NzKCdvdmVyZmxvdycpO1xyXG4gICAgICAgIG9wdGlvbnMucGFyZW50LmNzcygnb3ZlcmZsb3cnLCAnaGlkZGVuJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBkaWFsb2dQb3BJbihcclxuICAgICAgICBlbGVtZW50LFxyXG4gICAgICAgIG9wdGlvbnMucGFyZW50LFxyXG4gICAgICAgIG9wdGlvbnMucG9wSW5UYXJnZXQgJiYgb3B0aW9ucy5wb3BJblRhcmdldC5sZW5ndGggJiYgb3B0aW9ucy5wb3BJblRhcmdldFxyXG4gICAgICApXHJcbiAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICBhcHBseUFyaWFUb1NpYmxpbmdzKGVsZW1lbnQsIHRydWUpO1xyXG5cclxuICAgICAgICBpZiAob3B0aW9ucy5lc2NhcGVUb0Nsb3NlKSB7XHJcbiAgICAgICAgICBvcHRpb25zLnJvb3RFbGVtZW50S2V5dXBDYWxsYmFjayA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gJG1kQ29uc3RhbnQuS0VZX0NPREUuRVNDQVBFKSB7XHJcbiAgICAgICAgICAgICAgJHRpbWVvdXQoJG1kRGlhbG9nLmNhbmNlbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICAkcm9vdEVsZW1lbnQub24oJ2tleXVwJywgb3B0aW9ucy5yb290RWxlbWVudEtleXVwQ2FsbGJhY2spO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKG9wdGlvbnMuY2xpY2tPdXRzaWRlVG9DbG9zZSkge1xyXG4gICAgICAgICAgb3B0aW9ucy5kaWFsb2dDbGlja091dHNpZGVDYWxsYmFjayA9IGZ1bmN0aW9uKGV2KSB7XHJcbiAgICAgICAgICAgIC8vIE9ubHkgY2xvc2UgaWYgd2UgY2xpY2sgdGhlIGZsZXggY29udGFpbmVyIG91dHNpZGUgdGhlIGJhY2tkcm9wXHJcbiAgICAgICAgICAgIGlmIChldi50YXJnZXQgPT09IGVsZW1lbnRbMF0pIHtcclxuICAgICAgICAgICAgICAkdGltZW91dCgkbWREaWFsb2cuY2FuY2VsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIGVsZW1lbnQub24oJ2NsaWNrJywgb3B0aW9ucy5kaWFsb2dDbGlja091dHNpZGVDYWxsYmFjayk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAob3B0aW9ucy5mb2N1c09uT3Blbikge1xyXG4gICAgICAgICAgZWxlbWVudFRvRm9jdXMuZm9jdXMoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGZpbmRDbG9zZUJ1dHRvbigpIHtcclxuICAgICAgICAvL0lmIG5vIGVsZW1lbnQgd2l0aCBjbGFzcyBkaWFsb2ctY2xvc2UsIHRyeSB0byBmaW5kIHRoZSBsYXN0XHJcbiAgICAgICAgLy9idXR0b24gY2hpbGQgaW4gbWQtYWN0aW9ucyBhbmQgYXNzdW1lIGl0IGlzIGEgY2xvc2UgYnV0dG9uXHJcbiAgICAgICAgdmFyIGNsb3NlQnV0dG9uID0gZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCcuZGlhbG9nLWNsb3NlJyk7XHJcbiAgICAgICAgaWYgKCFjbG9zZUJ1dHRvbikge1xyXG4gICAgICAgICAgdmFyIGFjdGlvbkJ1dHRvbnMgPSBlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3JBbGwoJy5tZC1hY3Rpb25zIGJ1dHRvbicpO1xyXG4gICAgICAgICAgY2xvc2VCdXR0b24gPSBhY3Rpb25CdXR0b25zWyBhY3Rpb25CdXR0b25zLmxlbmd0aCAtIDEgXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFuZ3VsYXIuZWxlbWVudChjbG9zZUJ1dHRvbik7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gT24gcmVtb3ZlIGZ1bmN0aW9uIGZvciBhbGwgZGlhbG9nc1xyXG4gICAgZnVuY3Rpb24gb25SZW1vdmUoc2NvcGUsIGVsZW1lbnQsIG9wdGlvbnMpIHtcclxuICAgICAgYW5ndWxhci5lbGVtZW50KCRkb2N1bWVudFswXS5ib2R5KS5yZW1vdmVDbGFzcygnbWQtZGlhbG9nLWlzLXNob3dpbmcnKTtcclxuXHJcbiAgICAgIGlmIChvcHRpb25zLmJhY2tkcm9wKSB7XHJcbiAgICAgICAgJGFuaW1hdGUubGVhdmUob3B0aW9ucy5iYWNrZHJvcCk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKG9wdGlvbnMuZGlzYWJsZVBhcmVudFNjcm9sbCkge1xyXG4gICAgICAgIG9wdGlvbnMucGFyZW50LmNzcygnb3ZlcmZsb3cnLCBvcHRpb25zLmxhc3RPdmVyZmxvdyk7XHJcbiAgICAgICAgZGVsZXRlIG9wdGlvbnMubGFzdE92ZXJmbG93O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChvcHRpb25zLmVzY2FwZVRvQ2xvc2UpIHtcclxuICAgICAgICAkcm9vdEVsZW1lbnQub2ZmKCdrZXl1cCcsIG9wdGlvbnMucm9vdEVsZW1lbnRLZXl1cENhbGxiYWNrKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAob3B0aW9ucy5jbGlja091dHNpZGVUb0Nsb3NlKSB7XHJcbiAgICAgICAgZWxlbWVudC5vZmYoJ2NsaWNrJywgb3B0aW9ucy5kaWFsb2dDbGlja091dHNpZGVDYWxsYmFjayk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGFwcGx5QXJpYVRvU2libGluZ3MoZWxlbWVudCwgZmFsc2UpO1xyXG5cclxuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignZm9jdXMnLCB0cmFwRm9jdXMsIHRydWUpO1xyXG5cclxuICAgICAgcmV0dXJuIGRpYWxvZ1BvcE91dChcclxuICAgICAgICBlbGVtZW50LFxyXG4gICAgICAgIG9wdGlvbnMucGFyZW50LFxyXG4gICAgICAgIG9wdGlvbnMucG9wSW5UYXJnZXQgJiYgb3B0aW9ucy5wb3BJblRhcmdldC5sZW5ndGggJiYgb3B0aW9ucy5wb3BJblRhcmdldFxyXG4gICAgICApLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgZWxlbWVudC5yZW1vdmUoKTtcclxuICAgICAgICBvcHRpb25zLnBvcEluVGFyZ2V0ICYmIG9wdGlvbnMucG9wSW5UYXJnZXQuZm9jdXMoKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSW5qZWN0IEFSSUEtc3BlY2lmaWMgYXR0cmlidXRlcyBhcHByb3ByaWF0ZSBmb3IgRGlhbG9nc1xyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBjb25maWd1cmVBcmlhKGVsZW1lbnQsIHJvbGUsIG9wdGlvbnMpIHtcclxuXHJcbiAgICAgIGVsZW1lbnQuYXR0cih7XHJcbiAgICAgICAgJ3JvbGUnOiByb2xlLFxyXG4gICAgICAgICd0YWJJbmRleCc6ICctMSdcclxuICAgICAgfSk7XHJcblxyXG4gICAgICB2YXIgZGlhbG9nQ29udGVudCA9IGVsZW1lbnQuZmluZCgnbWQtZGlhbG9nLWNvbnRlbnQnKTtcclxuICAgICAgaWYgKGRpYWxvZ0NvbnRlbnQubGVuZ3RoID09PSAwKXtcclxuICAgICAgICBkaWFsb2dDb250ZW50ID0gZWxlbWVudDtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIGRpYWxvZ0lkID0gZWxlbWVudC5hdHRyKCdpZCcpIHx8ICgnZGlhbG9nXycgKyAkbWRVdGlsLm5leHRVaWQoKSk7XHJcbiAgICAgIGRpYWxvZ0NvbnRlbnQuYXR0cignaWQnLCBkaWFsb2dJZCk7XHJcbiAgICAgIGVsZW1lbnQuYXR0cignYXJpYS1kZXNjcmliZWRieScsIGRpYWxvZ0lkKTtcclxuXHJcbiAgICAgIGlmIChvcHRpb25zLmFyaWFMYWJlbCkge1xyXG4gICAgICAgICRtZEFyaWEuZXhwZWN0KGVsZW1lbnQsICdhcmlhLWxhYmVsJywgb3B0aW9ucy5hcmlhTGFiZWwpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICRtZEFyaWEuZXhwZWN0QXN5bmMoZWxlbWVudCwgJ2FyaWEtbGFiZWwnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgIHZhciB3b3JkcyA9IGRpYWxvZ0NvbnRlbnQudGV4dCgpLnNwbGl0KC9cXHMrLyk7XHJcbiAgICAgICAgICBpZiAod29yZHMubGVuZ3RoID4gMykgd29yZHMgPSB3b3Jkcy5zbGljZSgwLDMpLmNvbmNhdCgnLi4uJyk7XHJcbiAgICAgICAgICByZXR1cm4gd29yZHMuam9pbignICcpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFV0aWxpdHkgZnVuY3Rpb24gdG8gZmlsdGVyIG91dCByYXcgRE9NIG5vZGVzXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGlzTm9kZU9uZU9mKGVsZW0sIG5vZGVUeXBlQXJyYXkpIHtcclxuICAgICAgaWYgKG5vZGVUeXBlQXJyYXkuaW5kZXhPZihlbGVtLm5vZGVOYW1lKSAhPT0gLTEpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBXYWxrIERPTSB0byBhcHBseSBvciByZW1vdmUgYXJpYS1oaWRkZW4gb24gc2libGluZyBub2Rlc1xyXG4gICAgICogYW5kIHBhcmVudCBzaWJsaW5nIG5vZGVzXHJcbiAgICAgKlxyXG4gICAgICogUHJldmVudHMgc2NyZWVuIHJlYWRlciBpbnRlcmFjdGlvbiBiZWhpbmQgbW9kYWwgd2luZG93XHJcbiAgICAgKiBvbiBzd2lwZSBpbnRlcmZhY2VzXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGFwcGx5QXJpYVRvU2libGluZ3MoZWxlbWVudCwgdmFsdWUpIHtcclxuICAgICAgdmFyIGF0dHJpYnV0ZSA9ICdhcmlhLWhpZGRlbic7XHJcblxyXG4gICAgICAvLyBnZXQgcmF3IERPTSBub2RlXHJcbiAgICAgIGVsZW1lbnQgPSBlbGVtZW50WzBdO1xyXG5cclxuICAgICAgZnVuY3Rpb24gd2Fsa0RPTShlbGVtZW50KSB7XHJcbiAgICAgICAgd2hpbGUgKGVsZW1lbnQucGFyZW50Tm9kZSkge1xyXG4gICAgICAgICAgaWYgKGVsZW1lbnQgPT09IGRvY3VtZW50LmJvZHkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdmFyIGNoaWxkcmVuID0gZWxlbWVudC5wYXJlbnROb2RlLmNoaWxkcmVuO1xyXG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAvLyBza2lwIG92ZXIgY2hpbGQgaWYgaXQgaXMgYW4gYXNjZW5kYW50IG9mIHRoZSBkaWFsb2dcclxuICAgICAgICAgICAgLy8gb3IgYSBzY3JpcHQgb3Igc3R5bGUgdGFnXHJcbiAgICAgICAgICAgIGlmIChlbGVtZW50ICE9PSBjaGlsZHJlbltpXSAmJiAhaXNOb2RlT25lT2YoY2hpbGRyZW5baV0sIFsnU0NSSVBUJywgJ1NUWUxFJ10pKSB7XHJcbiAgICAgICAgICAgICAgY2hpbGRyZW5baV0uc2V0QXR0cmlidXRlKGF0dHJpYnV0ZSwgdmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgd2Fsa0RPTShlbGVtZW50ID0gZWxlbWVudC5wYXJlbnROb2RlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgd2Fsa0RPTShlbGVtZW50KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBkaWFsb2dQb3BJbihjb250YWluZXIsIHBhcmVudEVsZW1lbnQsIGNsaWNrRWxlbWVudCkge1xyXG4gICAgICB2YXIgZGlhbG9nRWwgPSBjb250YWluZXIuZmluZCgnbWQtZGlhbG9nJyk7XHJcblxyXG4gICAgICBwYXJlbnRFbGVtZW50LmFwcGVuZChjb250YWluZXIpO1xyXG4gICAgICB0cmFuc2Zvcm1Ub0NsaWNrRWxlbWVudChkaWFsb2dFbCwgY2xpY2tFbGVtZW50KTtcclxuXHJcbiAgICAgICQkckFGKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGRpYWxvZ0VsLmFkZENsYXNzKCd0cmFuc2l0aW9uLWluJylcclxuICAgICAgICAgIC5jc3MoJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STSwgJycpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJldHVybiAkbWRVdGlsLnRyYW5zaXRpb25FbmRQcm9taXNlKGRpYWxvZ0VsKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBkaWFsb2dQb3BPdXQoY29udGFpbmVyLCBwYXJlbnRFbGVtZW50LCBjbGlja0VsZW1lbnQpIHtcclxuICAgICAgdmFyIGRpYWxvZ0VsID0gY29udGFpbmVyLmZpbmQoJ21kLWRpYWxvZycpO1xyXG5cclxuICAgICAgZGlhbG9nRWwuYWRkQ2xhc3MoJ3RyYW5zaXRpb24tb3V0JykucmVtb3ZlQ2xhc3MoJ3RyYW5zaXRpb24taW4nKTtcclxuICAgICAgdHJhbnNmb3JtVG9DbGlja0VsZW1lbnQoZGlhbG9nRWwsIGNsaWNrRWxlbWVudCk7XHJcblxyXG4gICAgICByZXR1cm4gJG1kVXRpbC50cmFuc2l0aW9uRW5kUHJvbWlzZShkaWFsb2dFbCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gdHJhbnNmb3JtVG9DbGlja0VsZW1lbnQoZGlhbG9nRWwsIGNsaWNrRWxlbWVudCkge1xyXG4gICAgICBpZiAoY2xpY2tFbGVtZW50KSB7XHJcbiAgICAgICAgdmFyIGNsaWNrUmVjdCA9IGNsaWNrRWxlbWVudFswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICB2YXIgZGlhbG9nUmVjdCA9IGRpYWxvZ0VsWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuICAgICAgICB2YXIgc2NhbGVYID0gTWF0aC5taW4oMC41LCBjbGlja1JlY3Qud2lkdGggLyBkaWFsb2dSZWN0LndpZHRoKTtcclxuICAgICAgICB2YXIgc2NhbGVZID0gTWF0aC5taW4oMC41LCBjbGlja1JlY3QuaGVpZ2h0IC8gZGlhbG9nUmVjdC5oZWlnaHQpO1xyXG5cclxuICAgICAgICBkaWFsb2dFbC5jc3MoJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STSwgJ3RyYW5zbGF0ZTNkKCcgK1xyXG4gICAgICAgICAgKC1kaWFsb2dSZWN0LmxlZnQgKyBjbGlja1JlY3QubGVmdCArIGNsaWNrUmVjdC53aWR0aC8yIC0gZGlhbG9nUmVjdC53aWR0aC8yKSArICdweCwnICtcclxuICAgICAgICAgICgtZGlhbG9nUmVjdC50b3AgKyBjbGlja1JlY3QudG9wICsgY2xpY2tSZWN0LmhlaWdodC8yIC0gZGlhbG9nUmVjdC5oZWlnaHQvMikgKyAncHgsJyArXHJcbiAgICAgICAgICAnMCkgc2NhbGUoJyArIHNjYWxlWCArICcsJyArIHNjYWxlWSArICcpJ1xyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBkaWFsb2dUcmFuc2l0aW9uRW5kKGRpYWxvZ0VsKSB7XHJcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XHJcbiAgICAgIGRpYWxvZ0VsLm9uKCRtZENvbnN0YW50LkNTUy5UUkFOU0lUSU9ORU5ELCBmaW5pc2hlZCk7XHJcbiAgICAgIGZ1bmN0aW9uIGZpbmlzaGVkKGV2KSB7XHJcbiAgICAgICAgLy9NYWtlIHN1cmUgdGhpcyB0cmFuc2l0aW9uZW5kIGRpZG4ndCBidWJibGUgdXAgZnJvbSBhIGNoaWxkXHJcbiAgICAgICAgaWYgKGV2LnRhcmdldCA9PT0gZGlhbG9nRWxbMF0pIHtcclxuICAgICAgICAgIGRpYWxvZ0VsLm9mZigkbWRDb25zdGFudC5DU1MuVFJBTlNJVElPTkVORCwgZmluaXNoZWQpO1xyXG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG59XHJcbk1kRGlhbG9nUHJvdmlkZXIuJGluamVjdCA9IFtcIiQkaW50ZXJpbUVsZW1lbnRQcm92aWRlclwiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbW9kdWxlXHJcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuZGl2aWRlclxyXG4gKiBAZGVzY3JpcHRpb24gRGl2aWRlciBtb2R1bGUhXHJcbiAqL1xyXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5kaXZpZGVyJywgW1xyXG4gICdtYXRlcmlhbC5jb3JlJ1xyXG5dKVxyXG4gIC5kaXJlY3RpdmUoJ21kRGl2aWRlcicsIE1kRGl2aWRlckRpcmVjdGl2ZSk7XHJcblxyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbmFtZSBtZERpdmlkZXJcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmRpdmlkZXJcclxuICogQHJlc3RyaWN0IEVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIERpdmlkZXJzIGdyb3VwIGFuZCBzZXBhcmF0ZSBjb250ZW50IHdpdGhpbiBsaXN0cyBhbmQgcGFnZSBsYXlvdXRzIHVzaW5nIHN0cm9uZyB2aXN1YWwgYW5kIHNwYXRpYWwgZGlzdGluY3Rpb25zLiBUaGlzIGRpdmlkZXIgaXMgYSB0aGluIHJ1bGUsIGxpZ2h0d2VpZ2h0IGVub3VnaCB0byBub3QgZGlzdHJhY3QgdGhlIHVzZXIgZnJvbSBjb250ZW50LlxyXG4gKlxyXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBtZC1pbnNldCBBZGQgdGhpcyBhdHRyaWJ1dGUgdG8gYWN0aXZhdGUgdGhlIGluc2V0IGRpdmlkZXIgc3R5bGUuXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtZGl2aWRlcj48L21kLWRpdmlkZXI+XHJcbiAqXHJcbiAqIDxtZC1kaXZpZGVyIG1kLWluc2V0PjwvbWQtZGl2aWRlcj5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKi9cclxuZnVuY3Rpb24gTWREaXZpZGVyRGlyZWN0aXZlKCRtZFRoZW1pbmcpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgIGxpbms6ICRtZFRoZW1pbmdcclxuICB9O1xyXG59XHJcbk1kRGl2aWRlckRpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kVGhlbWluZ1wiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAndXNlIHN0cmljdCc7XHJcblxyXG4gIGFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuZmFiQWN0aW9ucycsIFsnbWF0ZXJpYWwuY29yZSddKVxyXG4gICAgLmRpcmVjdGl2ZSgnbWRGYWJBY3Rpb25zJywgTWRGYWJBY3Rpb25zRGlyZWN0aXZlKTtcclxuXHJcbiAgLyoqXHJcbiAgICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gICAqIEBuYW1lIG1kRmFiQWN0aW9uc1xyXG4gICAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5mYWJTcGVlZERpYWxcclxuICAgKlxyXG4gICAqIEByZXN0cmljdCBFXHJcbiAgICpcclxuICAgKiBAZGVzY3JpcHRpb25cclxuICAgKiBUaGUgYDxtZC1mYWItYWN0aW9ucz5gIGRpcmVjdGl2ZSBpcyB1c2VkIGluc2lkZSBvZiBhIGA8bWQtZmFiLXNwZWVkLWRpYWw+YCBvclxyXG4gICAqIGA8bWQtZmFiLXRvb2xiYXI+YCBkaXJlY3RpdmUgdG8gbWFyayB0aGUgYW4gZWxlbWVudCAob3IgZWxlbWVudHMpIGFzIHRoZSBhY3Rpb25zIGFuZCBzZXR1cCB0aGVcclxuICAgKiBwcm9wZXIgZXZlbnQgbGlzdGVuZXJzLlxyXG4gICAqXHJcbiAgICogQHVzYWdlXHJcbiAgICogU2VlIHRoZSBgPG1kLWZhYi1zcGVlZC1kaWFsPmAgb3IgYDxtZC1mYWItdG9vbGJhcj5gIGRpcmVjdGl2ZXMgZm9yIGV4YW1wbGUgdXNhZ2UuXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gTWRGYWJBY3Rpb25zRGlyZWN0aXZlKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgcmVzdHJpY3Q6ICdFJyxcclxuXHJcbiAgICAgIHJlcXVpcmU6IFsnXj9tZEZhYlNwZWVkRGlhbCcsICdeP21kRmFiVG9vbGJhciddLFxyXG5cclxuICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJpYnV0ZXMsIGNvbnRyb2xsZXJzKSB7XHJcbiAgICAgICAgLy8gR3JhYiB3aGljaGV2ZXIgcGFyZW50IGNvbnRyb2xsZXIgaXMgdXNlZFxyXG4gICAgICAgIHZhciBjb250cm9sbGVyID0gY29udHJvbGxlcnNbMF0gfHwgY29udHJvbGxlcnNbMV07XHJcblxyXG4gICAgICAgIC8vIE1ha2UgdGhlIGNoaWxkcmVuIG9wZW4vY2xvc2UgdGhlaXIgcGFyZW50IGRpcmVjdGl2ZVxyXG4gICAgICAgIGlmIChjb250cm9sbGVyKSB7XHJcbiAgICAgICAgICBhbmd1bGFyLmZvckVhY2goZWxlbWVudC5jaGlsZHJlbigpLCBmdW5jdGlvbihjaGlsZCkge1xyXG4gICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoY2hpbGQpLm9uKCdmb2N1cycsIGNvbnRyb2xsZXIub3Blbik7XHJcbiAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChjaGlsZCkub24oJ2JsdXInLCBjb250cm9sbGVyLmNsb3NlKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQWZ0ZXIgc2V0dGluZyB1cCB0aGUgbGlzdGVuZXJzLCB3cmFwIGV2ZXJ5IGNoaWxkIGluIGEgbmV3IGRpdiBhbmQgYWRkIGEgY2xhc3MgdGhhdCB3ZSBjYW5cclxuICAgICAgICAvLyBzY2FsZS9mbGluZyBpbmRlcGVuZGVudGx5XHJcbiAgICAgICAgZWxlbWVudC5jaGlsZHJlbigpLndyYXAoJzxkaXYgY2xhc3M9XCJtZC1mYWItYWN0aW9uLWl0ZW1cIj4nKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbn0pKCk7XHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAndXNlIHN0cmljdCc7XHJcblxyXG4gIGFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuZmFiU3BlZWREaWFsJywgW1xyXG4gICAgICAnbWF0ZXJpYWwuY29yZScsXHJcbiAgICAgICdtYXRlcmlhbC5jb21wb25lbnRzLmZhYlRyaWdnZXInLFxyXG4gICAgICAnbWF0ZXJpYWwuY29tcG9uZW50cy5mYWJBY3Rpb25zJ1xyXG4gICAgXSlcclxuICAgIC5kaXJlY3RpdmUoJ21kRmFiU3BlZWREaWFsJywgTWRGYWJTcGVlZERpYWxEaXJlY3RpdmUpXHJcbiAgICAuYW5pbWF0aW9uKCcubWQtZmxpbmcnLCBNZEZhYlNwZWVkRGlhbEZsaW5nQW5pbWF0aW9uKVxyXG4gICAgLmFuaW1hdGlvbignLm1kLXNjYWxlJywgTWRGYWJTcGVlZERpYWxTY2FsZUFuaW1hdGlvbik7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICAgKiBAbmFtZSBtZEZhYlNwZWVkRGlhbFxyXG4gICAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5mYWJTcGVlZERpYWxcclxuICAgKlxyXG4gICAqIEByZXN0cmljdCBFXHJcbiAgICpcclxuICAgKiBAZGVzY3JpcHRpb25cclxuICAgKiBUaGUgYDxtZC1mYWItc3BlZWQtZGlhbD5gIGRpcmVjdGl2ZSBpcyB1c2VkIHRvIHByZXNlbnQgYSBzZXJpZXMgb2YgcG9wdXAgZWxlbWVudHMgKHVzdWFsbHlcclxuICAgKiBgPG1kLWJ1dHRvbj5gcykgZm9yIHF1aWNrIGFjY2VzcyB0byBjb21tb24gYWN0aW9ucy5cclxuICAgKlxyXG4gICAqIFRoZXJlIGFyZSBjdXJyZW50bHkgdHdvIGFuaW1hdGlvbnMgYXZhaWxhYmxlIGJ5IGFwcGx5aW5nIG9uZSBvZiB0aGUgZm9sbG93aW5nIGNsYXNzZXMgdG9cclxuICAgKiB0aGUgY29tcG9uZW50OlxyXG4gICAqXHJcbiAgICogIC0gYG1kLWZsaW5nYCAtIFRoZSBzcGVlZCBkaWFsIGl0ZW1zIGFwcGVhciBmcm9tIHVuZGVybmVhdGggdGhlIHRyaWdnZXIgYW5kIG1vdmUgaW50byB0aGVpclxyXG4gICAqICAgIGFwcHJvcHJpYXRlIHBvc2l0aW9ucy5cclxuICAgKiAgLSBgbWQtc2NhbGVgIC0gVGhlIHNwZWVkIGRpYWwgaXRlbXMgYXBwZWFyIGluIHRoZWlyIHByb3BlciBwbGFjZXMgYnkgc2NhbGluZyBmcm9tIDAlIHRvIDEwMCUuXHJcbiAgICpcclxuICAgKiBAdXNhZ2VcclxuICAgKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gICAqIDxtZC1mYWItc3BlZWQtZGlhbCBkaXJlY3Rpb249XCJ1cFwiIGNsYXNzPVwibWQtZmxpbmdcIj5cclxuICAgKiAgIDxtZC1mYWItdHJpZ2dlcj5cclxuICAgKiAgICAgPG1kLWJ1dHRvbiBhcmlhLWxhYmVsPVwiQWRkLi4uXCI+PG1kLWljb24gaWNvbj1cIi9pbWcvaWNvbnMvcGx1cy5zdmdcIj48L21kLWljb24+PC9tZC1idXR0b24+XHJcbiAgICogICA8L21kLWZhYi10cmlnZ2VyPlxyXG4gICAqXHJcbiAgICogICA8bWQtZmFiLWFjdGlvbnM+XHJcbiAgICogICAgIDxtZC1idXR0b24gYXJpYS1sYWJlbD1cIkFkZCBVc2VyXCI+XHJcbiAgICogICAgICAgPG1kLWljb24gaWNvbj1cIi9pbWcvaWNvbnMvdXNlci5zdmdcIj48L21kLWljb24+XHJcbiAgICogICAgIDwvbWQtYnV0dG9uPlxyXG4gICAqXHJcbiAgICogICAgIDxtZC1idXR0b24gYXJpYS1sYWJlbD1cIkFkZCBHcm91cFwiPlxyXG4gICAqICAgICAgIDxtZC1pY29uIGljb249XCIvaW1nL2ljb25zL2dyb3VwLnN2Z1wiPjwvbWQtaWNvbj5cclxuICAgKiAgICAgPC9tZC1idXR0b24+XHJcbiAgICogICA8L21kLWZhYi1hY3Rpb25zPlxyXG4gICAqIDwvbWQtZmFiLXNwZWVkLWRpYWw+XHJcbiAgICogPC9obGpzPlxyXG4gICAqXHJcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBtZC1kaXJlY3Rpb24gRnJvbSB3aGljaCBkaXJlY3Rpb24geW91IHdvdWxkIGxpa2UgdGhlIHNwZWVkIGRpYWwgdG8gYXBwZWFyXHJcbiAgICogcmVsYXRpdmUgdG8gdGhlIHRyaWdnZXIgZWxlbWVudC5cclxuICAgKiBAcGFyYW0ge2V4cHJlc3Npb249fSBtZC1vcGVuIFByb2dyYW1tYXRpY2FsbHkgY29udHJvbCB3aGV0aGVyIG9yIG5vdCB0aGUgc3BlZWQtZGlhbCBpcyB2aXNpYmxlLlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIE1kRmFiU3BlZWREaWFsRGlyZWN0aXZlKCkge1xyXG4gICAgRmFiU3BlZWREaWFsQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiJGVsZW1lbnRcIiwgXCIkYW5pbWF0ZVwiXTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHJlc3RyaWN0OiAnRScsXHJcblxyXG4gICAgICBzY29wZToge1xyXG4gICAgICAgIGRpcmVjdGlvbjogJ0A/bWREaXJlY3Rpb24nLFxyXG4gICAgICAgIGlzT3BlbjogJz0/bWRPcGVuJ1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcclxuICAgICAgY29udHJvbGxlcjogRmFiU3BlZWREaWFsQ29udHJvbGxlcixcclxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxyXG5cclxuICAgICAgbGluazogRmFiU3BlZWREaWFsTGlua1xyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiBGYWJTcGVlZERpYWxMaW5rKHNjb3BlLCBlbGVtZW50KSB7XHJcbiAgICAgIC8vIFByZXBlbmQgYW4gZWxlbWVudCB0byBob2xkIG91ciBDU1MgdmFyaWFibGVzIHNvIHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgYW5pbWF0aW9ucyBiZWxvd1xyXG4gICAgICBlbGVtZW50LnByZXBlbmQoJzxkaXYgY2xhc3M9XCJtZC1jc3MtdmFyaWFibGVzXCI+PC9kaXY+Jyk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gRmFiU3BlZWREaWFsQ29udHJvbGxlcigkc2NvcGUsICRlbGVtZW50LCAkYW5pbWF0ZSkge1xyXG4gICAgICB2YXIgdm0gPSB0aGlzO1xyXG5cclxuICAgICAgLy8gRGVmaW5lIG91ciBvcGVuL2Nsb3NlIGZ1bmN0aW9uc1xyXG4gICAgICAvLyBOb3RlOiBVc2VkIGJ5IGZhYlRyaWdnZXIgYW5kIGZhYkFjdGlvbnMgZGlyZWN0aXZlc1xyXG4gICAgICB2bS5vcGVuID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJHNjb3BlLiRhcHBseSgndm0uaXNPcGVuID0gdHJ1ZScpO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgdm0uY2xvc2UgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAkc2NvcGUuJGFwcGx5KCd2bS5pc09wZW4gPSBmYWxzZScpO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgc2V0dXBEZWZhdWx0cygpO1xyXG4gICAgICBzZXR1cExpc3RlbmVycygpO1xyXG4gICAgICBzZXR1cFdhdGNoZXJzKCk7XHJcblxyXG4gICAgICAvLyBTZXQgb3VyIGRlZmF1bHQgdmFyaWFibGVzXHJcbiAgICAgIGZ1bmN0aW9uIHNldHVwRGVmYXVsdHMoKSB7XHJcbiAgICAgICAgLy8gU2V0IHRoZSBkZWZhdWx0IGRpcmVjdGlvbiB0byAnZG93bicgaWYgbm9uZSBpcyBzcGVjaWZpZWRcclxuICAgICAgICB2bS5kaXJlY3Rpb24gPSB2bS5kaXJlY3Rpb24gfHwgJ2Rvd24nO1xyXG5cclxuICAgICAgICAvLyBTZXQgdGhlIGRlZmF1bHQgdG8gYmUgY2xvc2VkXHJcbiAgICAgICAgdm0uaXNPcGVuID0gdm0uaXNPcGVuIHx8IGZhbHNlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBTZXR1cCBvdXIgZXZlbnQgbGlzdGVuZXJzXHJcbiAgICAgIGZ1bmN0aW9uIHNldHVwTGlzdGVuZXJzKCkge1xyXG4gICAgICAgICRlbGVtZW50Lm9uKCdtb3VzZWVudGVyJywgdm0ub3Blbik7XHJcbiAgICAgICAgJGVsZW1lbnQub24oJ21vdXNlbGVhdmUnLCB2bS5jbG9zZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFNldHVwIG91ciB3YXRjaGVyc1xyXG4gICAgICBmdW5jdGlvbiBzZXR1cFdhdGNoZXJzKCkge1xyXG4gICAgICAgIC8vIFdhdGNoIGZvciBjaGFuZ2VzIHRvIHRoZSBkaXJlY3Rpb24gYW5kIHVwZGF0ZSBjbGFzc2VzL2F0dHJpYnV0ZXNcclxuICAgICAgICAkc2NvcGUuJHdhdGNoKCd2bS5kaXJlY3Rpb24nLCBmdW5jdGlvbihuZXdEaXIsIG9sZERpcikge1xyXG4gICAgICAgICAgLy8gQWRkIHRoZSBhcHByb3ByaWF0ZSBjbGFzc2VzIHNvIHdlIGNhbiB0YXJnZXQgdGhlIGRpcmVjdGlvbiBpbiB0aGUgQ1NTXHJcbiAgICAgICAgICAkYW5pbWF0ZS5yZW1vdmVDbGFzcygkZWxlbWVudCwgJ21kLScgKyBvbGREaXIpO1xyXG4gICAgICAgICAgJGFuaW1hdGUuYWRkQ2xhc3MoJGVsZW1lbnQsICdtZC0nICsgbmV3RGlyKTtcclxuICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgICAgIC8vIFdhdGNoIGZvciBjaGFuZ2VzIHRvIG1kLW9wZW5cclxuICAgICAgICAkc2NvcGUuJHdhdGNoKCd2bS5pc09wZW4nLCBmdW5jdGlvbihpc09wZW4pIHtcclxuICAgICAgICAgIHZhciB0b0FkZCA9IGlzT3BlbiA/ICdtZC1pcy1vcGVuJyA6ICcnO1xyXG4gICAgICAgICAgdmFyIHRvUmVtb3ZlID0gaXNPcGVuID8gJycgOiAnbWQtaXMtb3Blbic7XHJcblxyXG4gICAgICAgICAgJGFuaW1hdGUuc2V0Q2xhc3MoJGVsZW1lbnQsIHRvQWRkLCB0b1JlbW92ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIE1kRmFiU3BlZWREaWFsRmxpbmdBbmltYXRpb24oKSB7XHJcbiAgICBmdW5jdGlvbiBydW5BbmltYXRpb24oZWxlbWVudCkge1xyXG4gICAgICB2YXIgZWwgPSBlbGVtZW50WzBdO1xyXG4gICAgICB2YXIgY3RybCA9IGVsZW1lbnQuY29udHJvbGxlcignbWRGYWJTcGVlZERpYWwnKTtcclxuICAgICAgdmFyIGl0ZW1zID0gZWwucXVlcnlTZWxlY3RvckFsbCgnLm1kLWZhYi1hY3Rpb24taXRlbScpO1xyXG5cclxuICAgICAgLy8gR3JhYiBvdXIgZWxlbWVudCB3aGljaCBzdG9yZXMgQ1NTIHZhcmlhYmxlc1xyXG4gICAgICB2YXIgdmFyaWFibGVzRWxlbWVudCA9IGVsLnF1ZXJ5U2VsZWN0b3IoJy5tZC1jc3MtdmFyaWFibGVzJyk7XHJcblxyXG4gICAgICAvLyBTZXR1cCBKUyB2YXJpYWJsZXMgYmFzZWQgb24gb3VyIENTUyB2YXJpYWJsZXNcclxuICAgICAgdmFyIHN0YXJ0WkluZGV4ID0gdmFyaWFibGVzRWxlbWVudC5zdHlsZS56SW5kZXg7XHJcblxyXG4gICAgICAvLyBBbHdheXMgcmVzZXQgdGhlIGl0ZW1zIHRvIHRoZWlyIG5hdHVyYWwgcG9zaXRpb24vc3RhdGVcclxuICAgICAgYW5ndWxhci5mb3JFYWNoKGl0ZW1zLCBmdW5jdGlvbihpdGVtLCBpbmRleCkge1xyXG4gICAgICAgIHZhciBzdHlsZXMgPSBpdGVtLnN0eWxlO1xyXG5cclxuICAgICAgICBzdHlsZXMudHJhbnNmb3JtID0gJyc7XHJcbiAgICAgICAgc3R5bGVzLnRyYW5zaXRpb25EZWxheSA9ICcnO1xyXG4gICAgICAgIHN0eWxlcy5vcGFjaXR5ID0gMTtcclxuXHJcbiAgICAgICAgLy8gTWFrZSB0aGUgaXRlbXMgY2xvc2VzdCB0byB0aGUgdHJpZ2dlciBoYXZlIHRoZSBoaWdoZXN0IHotaW5kZXhcclxuICAgICAgICBpdGVtLnN0eWxlLnpJbmRleCA9IChpdGVtcy5sZW5ndGggLSBpbmRleCkgKyBzdGFydFpJbmRleDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBJZiB0aGUgY29udHJvbCBpcyBjbG9zZWQsIGhpZGUgdGhlIGl0ZW1zIGJlaGluZCB0aGUgdHJpZ2dlclxyXG4gICAgICBpZiAoIWN0cmwuaXNPcGVuKSB7XHJcbiAgICAgICAgYW5ndWxhci5mb3JFYWNoKGl0ZW1zLCBmdW5jdGlvbihpdGVtLCBpbmRleCkge1xyXG4gICAgICAgICAgdmFyIG5ld1Bvc2l0aW9uLCBheGlzO1xyXG5cclxuICAgICAgICAgIHN3aXRjaCAoY3RybC5kaXJlY3Rpb24pIHtcclxuICAgICAgICAgICAgY2FzZSAndXAnOlxyXG4gICAgICAgICAgICAgIG5ld1Bvc2l0aW9uID0gaXRlbS5zY3JvbGxIZWlnaHQgKiAoaW5kZXggKyAxKTtcclxuICAgICAgICAgICAgICBheGlzID0gJ1knO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdkb3duJzpcclxuICAgICAgICAgICAgICBuZXdQb3NpdGlvbiA9IC1pdGVtLnNjcm9sbEhlaWdodCAqIChpbmRleCArIDEpO1xyXG4gICAgICAgICAgICAgIGF4aXMgPSAnWSc7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2xlZnQnOlxyXG4gICAgICAgICAgICAgIG5ld1Bvc2l0aW9uID0gaXRlbS5zY3JvbGxXaWR0aCAqIChpbmRleCArIDEpO1xyXG4gICAgICAgICAgICAgIGF4aXMgPSAnWCc7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3JpZ2h0JzpcclxuICAgICAgICAgICAgICBuZXdQb3NpdGlvbiA9IC1pdGVtLnNjcm9sbFdpZHRoICogKGluZGV4ICsgMSk7XHJcbiAgICAgICAgICAgICAgYXhpcyA9ICdYJztcclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBpdGVtLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGUnICsgYXhpcyArICcoJyArIG5ld1Bvc2l0aW9uICsgJ3B4KSc7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBhZGRDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lKSB7XHJcbiAgICAgICAgaWYgKGVsZW1lbnQuaGFzQ2xhc3MoJ21kLWZsaW5nJykpIHtcclxuICAgICAgICAgIHJ1bkFuaW1hdGlvbihlbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIHJlbW92ZUNsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGRvbmUpIHtcclxuICAgICAgICBydW5BbmltYXRpb24oZWxlbWVudCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIE1kRmFiU3BlZWREaWFsU2NhbGVBbmltYXRpb24oKSB7XHJcbiAgICB2YXIgZGVsYXkgPSA2NTtcclxuXHJcbiAgICBmdW5jdGlvbiBydW5BbmltYXRpb24oZWxlbWVudCkge1xyXG4gICAgICB2YXIgZWwgPSBlbGVtZW50WzBdO1xyXG4gICAgICB2YXIgY3RybCA9IGVsZW1lbnQuY29udHJvbGxlcignbWRGYWJTcGVlZERpYWwnKTtcclxuICAgICAgdmFyIGl0ZW1zID0gZWwucXVlcnlTZWxlY3RvckFsbCgnLm1kLWZhYi1hY3Rpb24taXRlbScpO1xyXG5cclxuICAgICAgLy8gQWx3YXlzIHJlc2V0IHRoZSBpdGVtcyB0byB0aGVpciBuYXR1cmFsIHBvc2l0aW9uL3N0YXRlXHJcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChpdGVtcywgZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHtcclxuICAgICAgICB2YXIgc3R5bGVzID0gaXRlbS5zdHlsZSxcclxuICAgICAgICAgIG9mZnNldERlbGF5ID0gaW5kZXggKiBkZWxheTtcclxuXHJcbiAgICAgICAgc3R5bGVzLm9wYWNpdHkgPSBjdHJsLmlzT3BlbiA/IDEgOiAwO1xyXG4gICAgICAgIHN0eWxlcy50cmFuc2Zvcm0gPSBjdHJsLmlzT3BlbiA/ICdzY2FsZSgxKScgOiAnc2NhbGUoMCknO1xyXG4gICAgICAgIHN0eWxlcy50cmFuc2l0aW9uRGVsYXkgPSAoY3RybC5pc09wZW4gPyAgb2Zmc2V0RGVsYXkgOiAoaXRlbXMubGVuZ3RoIC0gb2Zmc2V0RGVsYXkpKSArICdtcyc7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGFkZENsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGRvbmUpIHtcclxuICAgICAgICBydW5BbmltYXRpb24oZWxlbWVudCk7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICByZW1vdmVDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lKSB7XHJcbiAgICAgICAgcnVuQW5pbWF0aW9uKGVsZW1lbnQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG59KSgpO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5mYWJUb29sYmFyJywgW1xyXG4gICAgICAnbWF0ZXJpYWwuY29yZScsXHJcbiAgICAgICdtYXRlcmlhbC5jb21wb25lbnRzLmZhYlRyaWdnZXInLFxyXG4gICAgICAnbWF0ZXJpYWwuY29tcG9uZW50cy5mYWJBY3Rpb25zJ1xyXG4gICAgXSlcclxuICAgIC5kaXJlY3RpdmUoJ21kRmFiVG9vbGJhcicsIE1kRmFiVG9vbGJhckRpcmVjdGl2ZSlcclxuICAgIC5hbmltYXRpb24oJy5tZC1mYWItdG9vbGJhcicsIE1kRmFiVG9vbGJhckFuaW1hdGlvbik7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICAgKiBAbmFtZSBtZEZhYlRvb2xiYXJcclxuICAgKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuZmFiVG9vbGJhclxyXG4gICAqXHJcbiAgICogQHJlc3RyaWN0IEVcclxuICAgKlxyXG4gICAqIEBkZXNjcmlwdGlvblxyXG4gICAqXHJcbiAgICogVGhlIGA8bWQtZmFiLXRvb2xiYXI+YCBkaXJlY3RpdmUgaXMgdXNlZCBwcmVzZW50IGEgdG9vbGJhciBvZiBlbGVtZW50cyAodXN1YWxseSBgPG1kLWJ1dHRvbj5gcylcclxuICAgKiBmb3IgcXVpY2sgYWNjZXNzIHRvIGNvbW1vbiBhY3Rpb25zIHdoZW4gYSBmbG9hdGluZyBhY3Rpb24gYnV0dG9uIGlzIGFjdGl2YXRlZCAodmlhIGhvdmVyIG9yXHJcbiAgICoga2V5Ym9hcmQgbmF2aWdhdGlvbikuXHJcbiAgICpcclxuICAgKiBAdXNhZ2VcclxuICAgKlxyXG4gICAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAgICogPG1kLWZhYi10b29sYmFyPlxyXG4gICAqICAgPG1kLWZhYi10cmlnZ2VyPlxyXG4gICAqICAgICA8bWQtYnV0dG9uIGFyaWEtbGFiZWw9XCJBZGQuLi5cIj48bWQtaWNvbiBpY29uPVwiL2ltZy9pY29ucy9wbHVzLnN2Z1wiPjwvbWQtaWNvbj48L21kLWJ1dHRvbj5cclxuICAgKiAgIDwvbWQtZmFiLXRyaWdnZXI+XHJcbiAgICpcclxuICAgKiAgIDxtZC1mYWItYWN0aW9ucz5cclxuICAgKiAgICAgPG1kLWJ1dHRvbiBhcmlhLWxhYmVsPVwiQWRkIFVzZXJcIj5cclxuICAgKiAgICAgICA8bWQtaWNvbiBpY29uPVwiL2ltZy9pY29ucy91c2VyLnN2Z1wiPjwvbWQtaWNvbj5cclxuICAgKiAgICAgPC9tZC1idXR0b24+XHJcbiAgICpcclxuICAgKiAgICAgPG1kLWJ1dHRvbiBhcmlhLWxhYmVsPVwiQWRkIEdyb3VwXCI+XHJcbiAgICogICAgICAgPG1kLWljb24gaWNvbj1cIi9pbWcvaWNvbnMvZ3JvdXAuc3ZnXCI+PC9tZC1pY29uPlxyXG4gICAqICAgICA8L21kLWJ1dHRvbj5cclxuICAgKiAgIDwvbWQtZmFiLWFjdGlvbnM+XHJcbiAgICogPC9tZC1mYWItdG9vbGJhcj5cclxuICAgKiA8L2hsanM+XHJcbiAgICpcclxuICAgKiBAcGFyYW0ge2V4cHJlc3Npb249fSBtZC1vcGVuIFByb2dyYW1tYXRpY2FsbHkgY29udHJvbCB3aGV0aGVyIG9yIG5vdCB0aGUgdG9vbGJhciBpcyB2aXNpYmxlLlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIE1kRmFiVG9vbGJhckRpcmVjdGl2ZSgpIHtcclxuICAgIEZhYlRvb2xiYXJDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkZWxlbWVudFwiLCBcIiRhbmltYXRlXCJdO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcclxuICAgICAgdGVtcGxhdGU6XHJcbiAgICAgICAgJzxkaXYgY2xhc3M9XCJtZC1mYWItdG9vbGJhci13cmFwcGVyXCI+JyArXHJcbiAgICAgICAgJyAgPGRpdiBjbGFzcz1cIm1kLWZhYi10b29sYmFyLWNvbnRlbnRcIiBuZy10cmFuc2NsdWRlPjwvZGl2PicgK1xyXG4gICAgICAgICc8L2Rpdj4nLFxyXG5cclxuICAgICAgc2NvcGU6IHtcclxuICAgICAgICBpc09wZW46ICc9P21kT3BlbidcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXHJcbiAgICAgIGNvbnRyb2xsZXI6IEZhYlRvb2xiYXJDb250cm9sbGVyLFxyXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXHJcblxyXG4gICAgICBsaW5rOiBsaW5rXHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIEZhYlRvb2xiYXJDb250cm9sbGVyKCRzY29wZSwgJGVsZW1lbnQsICRhbmltYXRlKSB7XHJcbiAgICAgIHZhciB2bSA9IHRoaXM7XHJcblxyXG4gICAgICAvLyBTZXQgdGhlIGRlZmF1bHQgdG8gYmUgY2xvc2VkXHJcbiAgICAgIHZtLmlzT3BlbiA9IHZtLmlzT3BlbiB8fCBmYWxzZTtcclxuXHJcbiAgICAgIHZtLm9wZW4gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2bS5pc09wZW4gPSB0cnVlO1xyXG4gICAgICAgICRzY29wZS4kYXBwbHkoKTtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIHZtLmNsb3NlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdm0uaXNPcGVuID0gZmFsc2U7XHJcbiAgICAgICAgJHNjb3BlLiRhcHBseSgpO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgLy8gQWRkIG91ciBjbGFzcyBzbyB3ZSBjYW4gdHJpZ2dlciB0aGUgYW5pbWF0aW9uIG9uIHN0YXJ0XHJcbiAgICAgICRlbGVtZW50LmFkZENsYXNzKCdtZC1mYWItdG9vbGJhcicpO1xyXG5cclxuICAgICAgLy8gU2V0dXAgc29tZSBtb3VzZSBldmVudHMgc28gdGhlIGhvdmVyIGVmZmVjdCBjYW4gYmUgdHJpZ2dlcmVkXHJcbiAgICAgIC8vIGFueXdoZXJlIG92ZXIgdGhlIHRvb2xiYXJcclxuICAgICAgJGVsZW1lbnQub24oJ21vdXNlZW50ZXInLCB2bS5vcGVuKTtcclxuICAgICAgJGVsZW1lbnQub24oJ21vdXNlbGVhdmUnLCB2bS5jbG9zZSk7XHJcblxyXG4gICAgICAvLyBXYXRjaCBmb3IgY2hhbmdlcyB0byBtZC1vcGVuIGFuZCB0b2dnbGUgb3VyIGNsYXNzXHJcbiAgICAgICRzY29wZS4kd2F0Y2goJ3ZtLmlzT3BlbicsIGZ1bmN0aW9uKGlzT3Blbikge1xyXG4gICAgICAgIHZhciB0b0FkZCA9IGlzT3BlbiA/ICdtZC1pcy1vcGVuJyA6ICcnO1xyXG4gICAgICAgIHZhciB0b1JlbW92ZSA9IGlzT3BlbiA/ICcnIDogJ21kLWlzLW9wZW4nO1xyXG5cclxuICAgICAgICAkYW5pbWF0ZS5zZXRDbGFzcygkZWxlbWVudCwgdG9BZGQsIHRvUmVtb3ZlKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0cmlidXRlcykge1xyXG4gICAgICAvLyBEb24ndCBhbGxvdyBmb2N1cyBvbiB0aGUgdHJpZ2dlclxyXG4gICAgICBlbGVtZW50LmZpbmQoJ21kLWZhYi10cmlnZ2VyJykuZmluZCgnYnV0dG9uJykuYXR0cigndGFiaW5kZXgnLCAnLTEnKTtcclxuXHJcbiAgICAgIC8vIFByZXBlbmQgdGhlIGJhY2tncm91bmQgZWxlbWVudCB0byB0aGUgdHJpZ2dlcidzIGJ1dHRvblxyXG4gICAgICBlbGVtZW50LmZpbmQoJ21kLWZhYi10cmlnZ2VyJykuZmluZCgnYnV0dG9uJylcclxuICAgICAgICAucHJlcGVuZCgnPGRpdiBjbGFzcz1cIm1kLWZhYi10b29sYmFyLWJhY2tncm91bmRcIj48L2Rpdj4nKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIE1kRmFiVG9vbGJhckFuaW1hdGlvbigpIHtcclxuICAgIHZhciBvcmlnaW5hbEljb25EZWxheTtcclxuXHJcbiAgICBmdW5jdGlvbiBydW5BbmltYXRpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lKSB7XHJcbiAgICAgIHZhciBlbCA9IGVsZW1lbnRbMF07XHJcbiAgICAgIHZhciBjdHJsID0gZWxlbWVudC5jb250cm9sbGVyKCdtZEZhYlRvb2xiYXInKTtcclxuXHJcbiAgICAgIC8vIEdyYWIgdGhlIHJlbGV2YW50IGNoaWxkIGVsZW1lbnRzXHJcbiAgICAgIHZhciBiYWNrZ3JvdW5kRWxlbWVudCA9IGVsLnF1ZXJ5U2VsZWN0b3IoJy5tZC1mYWItdG9vbGJhci1iYWNrZ3JvdW5kJyk7XHJcbiAgICAgIHZhciB0cmlnZ2VyRWxlbWVudCA9IGVsLnF1ZXJ5U2VsZWN0b3IoJ21kLWZhYi10cmlnZ2VyIGJ1dHRvbicpO1xyXG4gICAgICB2YXIgaWNvbkVsZW1lbnQgPSBlbC5xdWVyeVNlbGVjdG9yKCdtZC1mYWItdHJpZ2dlciBidXR0b24gbWQtaWNvbicpO1xyXG4gICAgICB2YXIgYWN0aW9ucyA9IGVsZW1lbnQuZmluZCgnbWQtZmFiLWFjdGlvbnMnKS5jaGlsZHJlbigpO1xyXG5cclxuICAgICAgLy8gSWYgd2UgaGF2ZSBib3RoIGVsZW1lbnRzLCB1c2UgdGhlbSB0byBwb3NpdGlvbiB0aGUgbmV3IGJhY2tncm91bmRcclxuICAgICAgaWYgKHRyaWdnZXJFbGVtZW50ICYmIGJhY2tncm91bmRFbGVtZW50KSB7XHJcbiAgICAgICAgLy8gR2V0IG91ciB2YXJpYWJsZXNcclxuICAgICAgICB2YXIgY29sb3IgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0cmlnZ2VyRWxlbWVudCkuZ2V0UHJvcGVydHlWYWx1ZSgnYmFja2dyb3VuZC1jb2xvcicpO1xyXG4gICAgICAgIHZhciB3aWR0aCA9IGVsLm9mZnNldFdpZHRoO1xyXG4gICAgICAgIHZhciBoZWlnaHQgPSBlbC5vZmZzZXRIZWlnaHQ7XHJcblxyXG4gICAgICAgIC8vIE1ha2UgYSBzcXVhcmVcclxuICAgICAgICB2YXIgc2NhbGUgPSB3aWR0aCAqIDI7XHJcblxyXG4gICAgICAgIC8vIFNldCBzb21lIGJhc2ljIHN0eWxlcyBubyBtYXR0ZXIgd2hhdCBhbmltYXRpb24gd2UncmUgZG9pbmdcclxuICAgICAgICBiYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvcjtcclxuICAgICAgICBiYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS5ib3JkZXJSYWRpdXMgPSB3aWR0aCArICdweCc7XHJcblxyXG4gICAgICAgIC8vIElmIHdlJ3JlIG9wZW5cclxuICAgICAgICBpZiAoY3RybC5pc09wZW4pIHtcclxuXHJcbiAgICAgICAgICAvLyBTZXQgdGhlIHdpZHRoL2hlaWdodCB0byB0YWtlIHVwIHRoZSBmdWxsIHRvb2xiYXIgd2lkdGhcclxuICAgICAgICAgIGJhY2tncm91bmRFbGVtZW50LnN0eWxlLndpZHRoID0gc2NhbGUgKyAncHgnO1xyXG4gICAgICAgICAgYmFja2dyb3VuZEVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gc2NhbGUgKyAncHgnO1xyXG5cclxuICAgICAgICAgIC8vIFNldCB0aGUgdG9wL2xlZnQgdG8gbW92ZSB1cC9sZWZ0IChvciByaWdodCkgYnkgdGhlIHNjYWxlIHdpZHRoL2hlaWdodFxyXG4gICAgICAgICAgYmFja2dyb3VuZEVsZW1lbnQuc3R5bGUudG9wID0gLShzY2FsZSAvIDIpICsgJ3B4JztcclxuXHJcbiAgICAgICAgICBpZiAoZWxlbWVudC5oYXNDbGFzcygnbWQtbGVmdCcpKSB7XHJcbiAgICAgICAgICAgIGJhY2tncm91bmRFbGVtZW50LnN0eWxlLmxlZnQgPSAtKHNjYWxlIC8gMikgKyAncHgnO1xyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS5yaWdodCA9IG51bGw7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgaWYgKGVsZW1lbnQuaGFzQ2xhc3MoJ21kLXJpZ2h0JykpIHtcclxuICAgICAgICAgICAgYmFja2dyb3VuZEVsZW1lbnQuc3R5bGUucmlnaHQgPSAtKHNjYWxlIC8gMikgKyAncHgnO1xyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS5sZWZ0ID0gbnVsbDtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvLyBTZXQgdGhlIG5leHQgY2xvc2UgYW5pbWF0aW9uIHRvIGhhdmUgdGhlIHByb3BlciBkZWxheXNcclxuICAgICAgICAgIGJhY2tncm91bmRFbGVtZW50LnN0eWxlLnRyYW5zaXRpb25EZWxheSA9ICcwbXMnO1xyXG4gICAgICAgICAgaWNvbkVsZW1lbnQuc3R5bGUudHJhbnNpdGlvbkRlbGF5ID0gJy4zcyc7XHJcblxyXG4gICAgICAgICAgLy8gQXBwbHkgYSB0cmFuc2l0aW9uIGRlbGF5IHRvIGFjdGlvbnNcclxuICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChhY3Rpb25zLCBmdW5jdGlvbihhY3Rpb24sIGluZGV4KSB7XHJcbiAgICAgICAgICAgIGFjdGlvbi5zdHlsZS50cmFuc2l0aW9uRGVsYXkgPSAoYWN0aW9ucy5sZW5ndGggLSBpbmRleCkgKiAyNSArICdtcyc7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgLy8gT3RoZXJ3aXNlLCBzZXQgdGhlIHdpZHRoL2hlaWdodCB0byB0aGUgdHJpZ2dlcidzIHdpZHRoL2hlaWdodFxyXG4gICAgICAgICAgYmFja2dyb3VuZEVsZW1lbnQuc3R5bGUud2lkdGggPSB0cmlnZ2VyRWxlbWVudC5vZmZzZXRXaWR0aCArICdweCc7XHJcbiAgICAgICAgICBiYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS5oZWlnaHQgPSB0cmlnZ2VyRWxlbWVudC5vZmZzZXRIZWlnaHQgKyAncHgnO1xyXG5cclxuICAgICAgICAgIC8vIFJlc2V0IHRoZSBwb3NpdGlvblxyXG4gICAgICAgICAgYmFja2dyb3VuZEVsZW1lbnQuc3R5bGUudG9wID0gJzBweCc7XHJcblxyXG4gICAgICAgICAgaWYgKGVsZW1lbnQuaGFzQ2xhc3MoJ21kLWxlZnQnKSkge1xyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS5sZWZ0ID0gJzBweCc7XHJcbiAgICAgICAgICAgIGJhY2tncm91bmRFbGVtZW50LnN0eWxlLnJpZ2h0ID0gbnVsbDtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBpZiAoZWxlbWVudC5oYXNDbGFzcygnbWQtcmlnaHQnKSkge1xyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS5yaWdodCA9ICcwcHgnO1xyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS5sZWZ0ID0gbnVsbDtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvLyBTZXQgdGhlIG5leHQgb3BlbiBhbmltYXRpb24gdG8gaGF2ZSB0aGUgcHJvcGVyIGRlbGF5c1xyXG4gICAgICAgICAgYmFja2dyb3VuZEVsZW1lbnQuc3R5bGUudHJhbnNpdGlvbkRlbGF5ID0gJzIwMG1zJztcclxuICAgICAgICAgIGljb25FbGVtZW50LnN0eWxlLnRyYW5zaXRpb25EZWxheSA9ICcwbXMnO1xyXG5cclxuICAgICAgICAgIC8vIEFwcGx5IGEgdHJhbnNpdGlvbiBkZWxheSB0byBhY3Rpb25zXHJcbiAgICAgICAgICBhbmd1bGFyLmZvckVhY2goYWN0aW9ucywgZnVuY3Rpb24oYWN0aW9uLCBpbmRleCkge1xyXG4gICAgICAgICAgICBhY3Rpb24uc3R5bGUudHJhbnNpdGlvbkRlbGF5ID0gKGluZGV4ICogMjUpICsgJ21zJztcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGFkZENsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGRvbmUpIHtcclxuICAgICAgICBydW5BbmltYXRpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lKTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHJlbW92ZUNsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGRvbmUpIHtcclxuICAgICAgICBydW5BbmltYXRpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufSkoKTtcclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5mYWJUcmlnZ2VyJywgWyAnbWF0ZXJpYWwuY29yZScgXSlcclxuICAgIC5kaXJlY3RpdmUoJ21kRmFiVHJpZ2dlcicsIE1kRmFiVHJpZ2dlckRpcmVjdGl2ZSk7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICAgKiBAbmFtZSBtZEZhYlRyaWdnZXJcclxuICAgKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuZmFiU3BlZWREaWFsXHJcbiAgICpcclxuICAgKiBAcmVzdHJpY3QgRVxyXG4gICAqXHJcbiAgICogQGRlc2NyaXB0aW9uXHJcbiAgICogVGhlIGA8bWQtZmFiLXRyaWdnZXI+YCBkaXJlY3RpdmUgaXMgdXNlZCBpbnNpZGUgb2YgYSBgPG1kLWZhYi1zcGVlZC1kaWFsPmAgb3JcclxuICAgKiBgPG1kLWZhYi10b29sYmFyPmAgZGlyZWN0aXZlIHRvIG1hcmsgdGhlIGFuIGVsZW1lbnQgKG9yIGVsZW1lbnRzKSBhcyB0aGUgdHJpZ2dlciBhbmQgc2V0dXAgdGhlXHJcbiAgICogcHJvcGVyIGV2ZW50IGxpc3RlbmVycy5cclxuICAgKlxyXG4gICAqIEB1c2FnZVxyXG4gICAqIFNlZSB0aGUgYDxtZC1mYWItc3BlZWQtZGlhbD5gIG9yIGA8bWQtZmFiLXRvb2xiYXI+YCBkaXJlY3RpdmVzIGZvciBleGFtcGxlIHVzYWdlLlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIE1kRmFiVHJpZ2dlckRpcmVjdGl2ZSgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHJlc3RyaWN0OiAnRScsXHJcblxyXG4gICAgICByZXF1aXJlOiBbJ14/bWRGYWJTcGVlZERpYWwnLCAnXj9tZEZhYlRvb2xiYXInXSxcclxuXHJcbiAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyaWJ1dGVzLCBjb250cm9sbGVycykge1xyXG4gICAgICAgIC8vIEdyYWIgd2hpY2hldmVyIHBhcmVudCBjb250cm9sbGVyIGlzIHVzZWRcclxuICAgICAgICB2YXIgY29udHJvbGxlciA9IGNvbnRyb2xsZXJzWzBdIHx8IGNvbnRyb2xsZXJzWzFdO1xyXG5cclxuICAgICAgICAvLyBNYWtlIHRoZSBjaGlsZHJlbiBvcGVuL2Nsb3NlIHRoZWlyIHBhcmVudCBkaXJlY3RpdmVcclxuICAgICAgICBpZiAoY29udHJvbGxlcikge1xyXG4gICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGVsZW1lbnQuY2hpbGRyZW4oKSwgZnVuY3Rpb24oY2hpbGQpIHtcclxuICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGNoaWxkKS5vbignZm9jdXMnLCBjb250cm9sbGVyLm9wZW4pO1xyXG4gICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoY2hpbGQpLm9uKCdibHVyJywgY29udHJvbGxlci5jbG9zZSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn0pKCk7XHJcblxyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtb2R1bGVcclxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5ncmlkTGlzdFxyXG4gKi9cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuZ3JpZExpc3QnLCBbJ21hdGVyaWFsLmNvcmUnXSlcclxuICAgICAgIC5kaXJlY3RpdmUoJ21kR3JpZExpc3QnLCBHcmlkTGlzdERpcmVjdGl2ZSlcclxuICAgICAgIC5kaXJlY3RpdmUoJ21kR3JpZFRpbGUnLCBHcmlkVGlsZURpcmVjdGl2ZSlcclxuICAgICAgIC5kaXJlY3RpdmUoJ21kR3JpZFRpbGVGb290ZXInLCBHcmlkVGlsZUNhcHRpb25EaXJlY3RpdmUpXHJcbiAgICAgICAuZGlyZWN0aXZlKCdtZEdyaWRUaWxlSGVhZGVyJywgR3JpZFRpbGVDYXB0aW9uRGlyZWN0aXZlKVxyXG4gICAgICAgLmZhY3RvcnkoJyRtZEdyaWRMYXlvdXQnLCBHcmlkTGF5b3V0RmFjdG9yeSk7XHJcblxyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbmFtZSBtZEdyaWRMaXN0XHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5ncmlkTGlzdFxyXG4gKiBAcmVzdHJpY3QgRVxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogR3JpZCBsaXN0cyBhcmUgYW4gYWx0ZXJuYXRpdmUgdG8gc3RhbmRhcmQgbGlzdCB2aWV3cy4gR3JpZCBsaXN0cyBhcmUgZGlzdGluY3RcclxuICogZnJvbSBncmlkcyB1c2VkIGZvciBsYXlvdXRzIGFuZCBvdGhlciB2aXN1YWwgcHJlc2VudGF0aW9ucy5cclxuICpcclxuICogQSBncmlkIGxpc3QgaXMgYmVzdCBzdWl0ZWQgdG8gcHJlc2VudGluZyBhIGhvbW9nZW5vdXMgZGF0YSB0eXBlLCB0eXBpY2FsbHlcclxuICogaW1hZ2VzLCBhbmQgaXMgb3B0aW1pemVkIGZvciB2aXN1YWwgY29tcHJlaGVuc2lvbiBhbmQgZGlmZmVyZW50aWF0aW5nIGJldHdlZW5cclxuICogbGlrZSBkYXRhIHR5cGVzLlxyXG4gKlxyXG4gKiBBIGdyaWQgbGlzdCBpcyBhIGNvbnRpbnVvdXMgZWxlbWVudCBjb25zaXN0aW5nIG9mIHRlc3NlbGxhdGVkLCByZWd1bGFyXHJcbiAqIHN1YmRpdmlzaW9ucyBjYWxsZWQgY2VsbHMgdGhhdCBjb250YWluIHRpbGVzIChgbWQtZ3JpZC10aWxlYCkuXHJcbiAqXHJcbiAqIDxpbWcgc3JjPVwiLy9tYXRlcmlhbC1kZXNpZ24uc3RvcmFnZS5nb29nbGVhcGlzLmNvbS9wdWJsaXNoL3ZfMi9tYXRlcmlhbF9leHRfcHVibGlzaC8wQng0QlN0NmpuaUQ3T1ZsRWFYWjVZbVUxWHpnL2NvbXBvbmVudHNfZ3JpZHNfdXNhZ2UyLnBuZ1wiXHJcbiAqICAgIHN0eWxlPVwid2lkdGg6IDMwMHB4OyBoZWlnaHQ6IGF1dG87IG1hcmdpbi1yaWdodDogMTZweDtcIiBhbHQ9XCJDb25jZXB0IG9mIGdyaWQgZXhwbGFpbmVkIHZpc3VhbGx5XCI+XHJcbiAqIDxpbWcgc3JjPVwiLy9tYXRlcmlhbC1kZXNpZ24uc3RvcmFnZS5nb29nbGVhcGlzLmNvbS9wdWJsaXNoL3ZfMi9tYXRlcmlhbF9leHRfcHVibGlzaC8wQng0QlN0NmpuaUQ3Vkdoc09FNWlkV2xKV1hNL2NvbXBvbmVudHNfZ3JpZHNfdXNhZ2UzLnBuZ1wiXHJcbiAqICAgIHN0eWxlPVwid2lkdGg6IDMwMHB4OyBoZWlnaHQ6IGF1dG87XCIgYWx0PVwiR3JpZCBjb25jZXB0cyBsZWdlbmRcIj5cclxuICpcclxuICogQ2VsbHMgYXJlIGFycmF5ZWQgdmVydGljYWxseSBhbmQgaG9yaXpvbnRhbGx5IHdpdGhpbiB0aGUgZ3JpZC5cclxuICpcclxuICogVGlsZXMgaG9sZCBjb250ZW50IGFuZCBjYW4gc3BhbiBvbmUgb3IgbW9yZSBjZWxscyB2ZXJ0aWNhbGx5IG9yIGhvcml6b250YWxseS5cclxuICpcclxuICogIyMjIFJlc3BvbnNpdmUgQXR0cmlidXRlc1xyXG4gKlxyXG4gKiBUaGUgYG1kLWdyaWQtbGlzdGAgZGlyZWN0aXZlIHN1cHBvcnRzIFwicmVzcG9uc2l2ZVwiIGF0dHJpYnV0ZXMsIHdoaWNoIGFsbG93XHJcbiAqIGRpZmZlcmVudCBgbWQtY29sc2AsIGBtZC1ndXR0ZXJgIGFuZCBgbWQtcm93LWhlaWdodGAgdmFsdWVzIGRlcGVuZGluZyBvbiB0aGVcclxuICogY3VycmVudGx5IG1hdGNoaW5nIG1lZGlhIHF1ZXJ5IChhcyBkZWZpbmVkIGluIGAkbWRDb25zdGFudC5NRURJQWApLlxyXG4gKlxyXG4gKiBJbiBvcmRlciB0byBzZXQgYSByZXNwb25zaXZlIGF0dHJpYnV0ZSwgZmlyc3QgZGVmaW5lIHRoZSBmYWxsYmFjayB2YWx1ZSB3aXRoXHJcbiAqIHRoZSBzdGFuZGFyZCBhdHRyaWJ1dGUgbmFtZSwgdGhlbiBhZGQgYWRkaXRpb25hbCBhdHRyaWJ1dGVzIHdpdGggdGhlXHJcbiAqIGZvbGxvd2luZyBjb252ZW50aW9uOiBge2Jhc2UtYXR0cmlidXRlLW5hbWV9LXttZWRpYS1xdWVyeS1uYW1lfT1cInt2YWx1ZX1cImBcclxuICogKGllLiBgbWQtY29scy1sZz1cIjhcImApXHJcbiAqXHJcbiAqIEBwYXJhbSB7bnVtYmVyfSBtZC1jb2xzIE51bWJlciBvZiBjb2x1bW5zIGluIHRoZSBncmlkLlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gbWQtcm93LWhlaWdodCBPbmUgb2ZcclxuICogPHVsPlxyXG4gKiAgIDxsaT5DU1MgbGVuZ3RoIC0gRml4ZWQgaGVpZ2h0IHJvd3MgKGVnLiBgOHB4YCBvciBgMXJlbWApPC9saT5cclxuICogICA8bGk+YHt3aWR0aH06e2hlaWdodH1gIC0gUmF0aW8gb2Ygd2lkdGggdG8gaGVpZ2h0IChlZy5cclxuICogICBgbWQtcm93LWhlaWdodD1cIjE2OjlcImApPC9saT5cclxuICogICA8bGk+YFwiZml0XCJgIC0gSGVpZ2h0IHdpbGwgYmUgZGV0ZXJtaW5lZCBieSBzdWJkaXZpZGluZyB0aGUgYXZhaWxhYmxlXHJcbiAqICAgaGVpZ2h0IGJ5IHRoZSBudW1iZXIgb2Ygcm93czwvbGk+XHJcbiAqIDwvdWw+XHJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gbWQtZ3V0dGVyIFRoZSBhbW91bnQgb2Ygc3BhY2UgYmV0d2VlbiB0aWxlcyBpbiBDU1MgdW5pdHNcclxuICogICAgIChkZWZhdWx0IDFweClcclxuICogQHBhcmFtIHtleHByZXNzaW9uPX0gbWQtb24tbGF5b3V0IEV4cHJlc3Npb24gdG8gZXZhbHVhdGUgYWZ0ZXIgbGF5b3V0LiBFdmVudFxyXG4gKiAgICAgb2JqZWN0IGlzIGF2YWlsYWJsZSBhcyBgJGV2ZW50YCwgYW5kIGNvbnRhaW5zIHBlcmZvcm1hbmNlIGluZm9ybWF0aW9uLlxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogQmFzaWM6XHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqIDxtZC1ncmlkLWxpc3QgbWQtY29scz1cIjVcIiBtZC1ndXR0ZXI9XCIxZW1cIiBtZC1yb3ctaGVpZ2h0PVwiNDozXCI+XHJcbiAqICAgPG1kLWdyaWQtdGlsZT48L21kLWdyaWQtdGlsZT5cclxuICogPC9tZC1ncmlkLWxpc3Q+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICogRml4ZWQtaGVpZ2h0IHJvd3M6XHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqIDxtZC1ncmlkLWxpc3QgbWQtY29scz1cIjRcIiBtZC1yb3ctaGVpZ2h0PVwiMjAwcHhcIiAuLi4+XHJcbiAqICAgPG1kLWdyaWQtdGlsZT48L21kLWdyaWQtdGlsZT5cclxuICogPC9tZC1ncmlkLWxpc3Q+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICogRml0IHJvd3M6XHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqIDxtZC1ncmlkLWxpc3QgbWQtY29scz1cIjRcIiBtZC1yb3ctaGVpZ2h0PVwiZml0XCIgc3R5bGU9XCJoZWlnaHQ6IDQwMHB4O1wiIC4uLj5cclxuICogICA8bWQtZ3JpZC10aWxlPjwvbWQtZ3JpZC10aWxlPlxyXG4gKiA8L21kLWdyaWQtbGlzdD5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiBVc2luZyByZXNwb25zaXZlIGF0dHJpYnV0ZXM6XHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqIDxtZC1ncmlkLWxpc3RcclxuICogICAgIG1kLWNvbHMtc209XCIyXCJcclxuICogICAgIG1kLWNvbHMtbWQ9XCI0XCJcclxuICogICAgIG1kLWNvbHMtbGc9XCI4XCJcclxuICogICAgIG1kLWNvbHMtZ3QtbGc9XCIxMlwiXHJcbiAqICAgICAuLi4+XHJcbiAqICAgPG1kLWdyaWQtdGlsZT48L21kLWdyaWQtdGlsZT5cclxuICogPC9tZC1ncmlkLWxpc3Q+XHJcbiAqIDwvaGxqcz5cclxuICovXHJcbmZ1bmN0aW9uIEdyaWRMaXN0RGlyZWN0aXZlKCRpbnRlcnBvbGF0ZSwgJG1kQ29uc3RhbnQsICRtZEdyaWRMYXlvdXQsICRtZE1lZGlhKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICBjb250cm9sbGVyOiBHcmlkTGlzdENvbnRyb2xsZXIsXHJcbiAgICBzY29wZToge1xyXG4gICAgICBtZE9uTGF5b3V0OiAnJidcclxuICAgIH0sXHJcbiAgICBsaW5rOiBwb3N0TGlua1xyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRycywgY3RybCkge1xyXG4gICAgLy8gQXBwbHkgc2VtYW50aWNzXHJcbiAgICBlbGVtZW50LmF0dHIoJ3JvbGUnLCAnbGlzdCcpO1xyXG5cclxuICAgIC8vIFByb3ZpZGUgdGhlIGNvbnRyb2xsZXIgd2l0aCBhIHdheSB0byB0cmlnZ2VyIGxheW91dHMuXHJcbiAgICBjdHJsLmxheW91dERlbGVnYXRlID0gbGF5b3V0RGVsZWdhdGU7XHJcblxyXG4gICAgdmFyIGludmFsaWRhdGVMYXlvdXQgPSBhbmd1bGFyLmJpbmQoY3RybCwgY3RybC5pbnZhbGlkYXRlTGF5b3V0KSxcclxuICAgICAgICB1bndhdGNoQXR0cnMgPSB3YXRjaE1lZGlhKCk7XHJcbiAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCB1bndhdGNoTWVkaWEpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogV2F0Y2hlcyBmb3IgY2hhbmdlcyBpbiBtZWRpYSwgaW52YWxpZGF0aW5nIGxheW91dCBhcyBuZWNlc3NhcnkuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHdhdGNoTWVkaWEoKSB7XHJcbiAgICAgIGZvciAodmFyIG1lZGlhTmFtZSBpbiAkbWRDb25zdGFudC5NRURJQSkge1xyXG4gICAgICAgICRtZE1lZGlhKG1lZGlhTmFtZSk7IC8vIGluaXRpYWxpemVcclxuICAgICAgICAkbWRNZWRpYS5nZXRRdWVyeSgkbWRDb25zdGFudC5NRURJQVttZWRpYU5hbWVdKVxyXG4gICAgICAgICAgICAuYWRkTGlzdGVuZXIoaW52YWxpZGF0ZUxheW91dCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuICRtZE1lZGlhLndhdGNoUmVzcG9uc2l2ZUF0dHJpYnV0ZXMoXHJcbiAgICAgICAgICBbJ21kLWNvbHMnLCAnbWQtcm93LWhlaWdodCddLCBhdHRycywgbGF5b3V0SWZNZWRpYU1hdGNoKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiB1bndhdGNoTWVkaWEoKSB7XHJcbiAgICAgIGN0cmwubGF5b3V0RGVsZWdhdGUgPSBhbmd1bGFyLm5vb3A7XHJcblxyXG4gICAgICB1bndhdGNoQXR0cnMoKTtcclxuICAgICAgZm9yICh2YXIgbWVkaWFOYW1lIGluICRtZENvbnN0YW50Lk1FRElBKSB7XHJcbiAgICAgICAgJG1kTWVkaWEuZ2V0UXVlcnkoJG1kQ29uc3RhbnQuTUVESUFbbWVkaWFOYW1lXSlcclxuICAgICAgICAgICAgLnJlbW92ZUxpc3RlbmVyKGludmFsaWRhdGVMYXlvdXQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQZXJmb3JtcyBncmlkIGxheW91dCBpZiB0aGUgcHJvdmlkZWQgbWVkaWFOYW1lIG1hdGNoZXMgdGhlIGN1cnJlbnRseVxyXG4gICAgICogYWN0aXZlIG1lZGlhIHR5cGUuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGxheW91dElmTWVkaWFNYXRjaChtZWRpYU5hbWUpIHtcclxuICAgICAgaWYgKG1lZGlhTmFtZSA9PSBudWxsKSB7XHJcbiAgICAgICAgLy8gVE9ETyhzaHluZG1hbik6IEl0IHdvdWxkIGJlIG5pY2UgdG8gb25seSBsYXlvdXQgaWYgd2UgaGF2ZVxyXG4gICAgICAgIC8vIGluc3RhbmNlcyBvZiBhdHRyaWJ1dGVzIHVzaW5nIHRoaXMgbWVkaWEgdHlwZVxyXG4gICAgICAgIGN0cmwuaW52YWxpZGF0ZUxheW91dCgpO1xyXG4gICAgICB9IGVsc2UgaWYgKCRtZE1lZGlhKG1lZGlhTmFtZSkpIHtcclxuICAgICAgICBjdHJsLmludmFsaWRhdGVMYXlvdXQoKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHZhciBsYXN0TGF5b3V0UHJvcHM7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBJbnZva2VzIHRoZSBsYXlvdXQgZW5naW5lLCBhbmQgdXNlcyBpdHMgcmVzdWx0cyB0byBsYXkgb3V0IG91clxyXG4gICAgICogdGlsZSBlbGVtZW50cy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IHRpbGVzSW52YWxpZGF0ZWQgV2hldGhlciB0aWxlcyBoYXZlIGJlZW5cclxuICAgICAqICAgIGFkZGVkL3JlbW92ZWQvbW92ZWQgc2luY2UgdGhlIGxhc3QgbGF5b3V0LiBUaGlzIGlzIHRvIGF2b2lkIHNpdHVhdGlvbnNcclxuICAgICAqICAgIHdoZXJlIHRpbGVzIGFyZSByZXBsYWNlZCB3aXRoIHByb3BlcnRpZXMgaWRlbnRpY2FsIHRvIHRoZWlyIHJlbW92ZWRcclxuICAgICAqICAgIGNvdW50ZXJwYXJ0cy5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gbGF5b3V0RGVsZWdhdGUodGlsZXNJbnZhbGlkYXRlZCkge1xyXG4gICAgICB2YXIgdGlsZXMgPSBnZXRUaWxlRWxlbWVudHMoKTtcclxuICAgICAgdmFyIHByb3BzID0ge1xyXG4gICAgICAgIHRpbGVTcGFuczogZ2V0VGlsZVNwYW5zKHRpbGVzKSxcclxuICAgICAgICBjb2xDb3VudDogZ2V0Q29sdW1uQ291bnQoKSxcclxuICAgICAgICByb3dNb2RlOiBnZXRSb3dNb2RlKCksXHJcbiAgICAgICAgcm93SGVpZ2h0OiBnZXRSb3dIZWlnaHQoKSxcclxuICAgICAgICBndXR0ZXI6IGdldEd1dHRlcigpXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBpZiAoIXRpbGVzSW52YWxpZGF0ZWQgJiYgYW5ndWxhci5lcXVhbHMocHJvcHMsIGxhc3RMYXlvdXRQcm9wcykpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciBwZXJmb3JtYW5jZSA9XHJcbiAgICAgICAgJG1kR3JpZExheW91dChwcm9wcy5jb2xDb3VudCwgcHJvcHMudGlsZVNwYW5zLCB0aWxlcylcclxuICAgICAgICAgIC5tYXAoZnVuY3Rpb24odGlsZVBvc2l0aW9ucywgcm93Q291bnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICBncmlkOiB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50OiBlbGVtZW50LFxyXG4gICAgICAgICAgICAgICAgc3R5bGU6IGdldEdyaWRTdHlsZShwcm9wcy5jb2xDb3VudCwgcm93Q291bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcHMuZ3V0dGVyLCBwcm9wcy5yb3dNb2RlLCBwcm9wcy5yb3dIZWlnaHQpXHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICB0aWxlczogdGlsZVBvc2l0aW9ucy5tYXAoZnVuY3Rpb24ocHMsIGkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGFuZ3VsYXIuZWxlbWVudCh0aWxlc1tpXSksXHJcbiAgICAgICAgICAgICAgICAgIHN0eWxlOiBnZXRUaWxlU3R5bGUocHMucG9zaXRpb24sIHBzLnNwYW5zLFxyXG4gICAgICAgICAgICAgICAgICAgICAgcHJvcHMuY29sQ291bnQsIHByb3BzLnJvd0NvdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgcHJvcHMuZ3V0dGVyLCBwcm9wcy5yb3dNb2RlLCBwcm9wcy5yb3dIZWlnaHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5yZWZsb3coKVxyXG4gICAgICAgICAgLnBlcmZvcm1hbmNlKCk7XHJcblxyXG4gICAgICAvLyBSZXBvcnQgbGF5b3V0XHJcbiAgICAgIHNjb3BlLm1kT25MYXlvdXQoe1xyXG4gICAgICAgICRldmVudDoge1xyXG4gICAgICAgICAgcGVyZm9ybWFuY2U6IHBlcmZvcm1hbmNlXHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGxhc3RMYXlvdXRQcm9wcyA9IHByb3BzO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFVzZSAkaW50ZXJwb2xhdGUgdG8gZG8gc29tZSBzaW1wbGUgc3RyaW5nIGludGVycG9sYXRpb24gYXMgYSBjb252ZW5pZW5jZS5cclxuXHJcbiAgICB2YXIgc3RhcnRTeW1ib2wgPSAkaW50ZXJwb2xhdGUuc3RhcnRTeW1ib2woKTtcclxuICAgIHZhciBlbmRTeW1ib2wgPSAkaW50ZXJwb2xhdGUuZW5kU3ltYm9sKCk7XHJcblxyXG4gICAgLy8gUmV0dXJucyBhbiBleHByZXNzaW9uIHdyYXBwZWQgaW4gdGhlIGludGVycG9sYXRvcidzIHN0YXJ0IGFuZCBlbmQgc3ltYm9scy5cclxuICAgIGZ1bmN0aW9uIGV4cHIoZXhwclN0cikge1xyXG4gICAgICByZXR1cm4gc3RhcnRTeW1ib2wgKyBleHByU3RyICsgZW5kU3ltYm9sO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFRoZSBhbW91bnQgb2Ygc3BhY2UgYSBzaW5nbGUgMXgxIHRpbGUgd291bGQgdGFrZSB1cCAoZWl0aGVyIHdpZHRoIG9yIGhlaWdodCksIHVzZWQgYXNcclxuICAgIC8vIGEgYmFzaXMgZm9yIG90aGVyIGNhbGN1bGF0aW9ucy4gVGhpcyBjb25zaXN0cyBvZiB0YWtpbmcgdGhlIGJhc2Ugc2l6ZSBwZXJjZW50IChhcyB3b3VsZCBiZVxyXG4gICAgLy8gaWYgZXZlbmx5IGRpdmlkaW5nIHRoZSBzaXplIGJldHdlZW4gY2VsbHMpLCBhbmQgdGhlbiBzdWJ0cmFjdGluZyB0aGUgc2l6ZSBvZiBvbmUgZ3V0dGVyLlxyXG4gICAgLy8gSG93ZXZlciwgc2luY2UgdGhlcmUgYXJlIG5vIGd1dHRlcnMgb24gdGhlIGVkZ2VzLCBlYWNoIHRpbGUgb25seSB1c2VzIGEgZnJhdGlvblxyXG4gICAgLy8gKGd1dHRlclNoYXJlID0gbnVtR3V0dGVycyAvIG51bUNlbGxzKSBvZiB0aGUgZ3V0dGVyIHNpemUuIChJbWFnaW5lIGhhdmluZyBvbmUgZ3V0dGVyIHBlclxyXG4gICAgLy8gdGlsZSwgYW5kIHRoZW4gYnJlYWtpbmcgdXAgdGhlIGV4dHJhIGd1dHRlciBvbiB0aGUgZWRnZSBldmVubHkgYW1vbmcgdGhlIGNlbGxzKS5cclxuICAgIHZhciBVTklUID0gJGludGVycG9sYXRlKGV4cHIoJ3NoYXJlJykgKyAnJSAtICgnICsgZXhwcignZ3V0dGVyJykgKyAnICogJyArIGV4cHIoJ2d1dHRlclNoYXJlJykgKyAnKScpO1xyXG5cclxuICAgIC8vIFRoZSBob3Jpem9udGFsIG9yIHZlcnRpY2FsIHBvc2l0aW9uIG9mIGEgdGlsZSwgZS5nLiwgdGhlICd0b3AnIG9yICdsZWZ0JyBwcm9wZXJ0eSB2YWx1ZS5cclxuICAgIC8vIFRoZSBwb3NpdGlvbiBjb21lcyB0aGUgc2l6ZSBvZiBhIDF4MSB0aWxlIHBsdXMgZ3V0dGVyIGZvciBlYWNoIHByZXZpb3VzIHRpbGUgaW4gdGhlXHJcbiAgICAvLyByb3cvY29sdW1uIChvZmZzZXQpLlxyXG4gICAgdmFyIFBPU0lUSU9OICA9ICRpbnRlcnBvbGF0ZSgnY2FsYygoJyArIGV4cHIoJ3VuaXQnKSArICcgKyAnICsgZXhwcignZ3V0dGVyJykgKyAnKSAqICcgKyBleHByKCdvZmZzZXQnKSArICcpJyk7XHJcblxyXG4gICAgLy8gVGhlIGFjdHVhbCBzaXplIG9mIGEgdGlsZSwgZS5nLiwgd2lkdGggb3IgaGVpZ2h0LCB0YWtpbmcgcm93U3BhbiBvciBjb2xTcGFuIGludG8gYWNjb3VudC5cclxuICAgIC8vIFRoaXMgaXMgY29tcHV0ZWQgYnkgbXVsdGlwbHlpbmcgdGhlIGJhc2UgdW5pdCBieSB0aGUgcm93U3Bhbi9jb2xTcGFuLCBhbmQgdGhlbiBhZGRpbmcgYmFja1xyXG4gICAgLy8gaW4gdGhlIHNwYWNlIHRoYXQgdGhlIGd1dHRlciB3b3VsZCBub3JtYWxseSBoYXZlIHVzZWQgKHdoaWNoIHdhcyBhbHJlYWR5IGFjY291bnRlZCBmb3IgaW5cclxuICAgIC8vIHRoZSBiYXNlIHVuaXQgY2FsY3VsYXRpb24pLlxyXG4gICAgdmFyIERJTUVOU0lPTiA9ICRpbnRlcnBvbGF0ZSgnY2FsYygoJyArIGV4cHIoJ3VuaXQnKSArICcpICogJyArIGV4cHIoJ3NwYW4nKSArICcgKyAoJyArIGV4cHIoJ3NwYW4nKSArICcgLSAxKSAqICcgKyBleHByKCdndXR0ZXInKSArICcpJyk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXRzIHRoZSBzdHlsZXMgYXBwbGllZCB0byBhIHRpbGUgZWxlbWVudCBkZXNjcmliZWQgYnkgdGhlIGdpdmVuIHBhcmFtZXRlcnMuXHJcbiAgICAgKiBAcGFyYW0ge3tyb3c6IG51bWJlciwgY29sOiBudW1iZXJ9fSBwb3NpdGlvbiBUaGUgcm93IGFuZCBjb2x1bW4gaW5kaWNlcyBvZiB0aGUgdGlsZS5cclxuICAgICAqIEBwYXJhbSB7e3JvdzogbnVtYmVyLCBjb2w6IG51bWJlcn19IHNwYW5zIFRoZSByb3dTcGFuIGFuZCBjb2xTcGFuIG9mIHRoZSB0aWxlLlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGNvbENvdW50IFRoZSBudW1iZXIgb2YgY29sdW1ucy5cclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSByb3dDb3VudCBUaGUgbnVtYmVyIG9mIHJvd3MuXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZ3V0dGVyIFRoZSBhbW91bnQgb2Ygc3BhY2UgYmV0d2VlbiB0aWxlcy4gVGhpcyB3aWxsIGJlIHNvbWV0aGluZyBsaWtlXHJcbiAgICAgKiAgICAgJzVweCcgb3IgJzJlbScuXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcm93TW9kZSBUaGUgcm93IGhlaWdodCBtb2RlLiBDYW4gYmUgb25lIG9mOlxyXG4gICAgICogICAgICdmaXhlZCc6IGFsbCByb3dzIGhhdmUgYSBmaXhlZCBzaXplLCBnaXZlbiBieSByb3dIZWlnaHQsXHJcbiAgICAgKiAgICAgJ3JhdGlvJzogcm93IGhlaWdodCBkZWZpbmVkIGFzIGEgcmF0aW8gdG8gd2lkdGgsIG9yXHJcbiAgICAgKiAgICAgJ2ZpdCc6IGZpdCB0byB0aGUgZ3JpZC1saXN0IGVsZW1lbnQgaGVpZ2h0LCBkaXZpbmRpbmcgZXZlbmx5IGFtb25nIHJvd3MuXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xudW1iZXJ9IHJvd0hlaWdodCBUaGUgaGVpZ2h0IG9mIGEgcm93LiBUaGlzIGlzIG9ubHkgdXNlZCBmb3IgJ2ZpeGVkJyBtb2RlIGFuZFxyXG4gICAgICogICAgIGZvciAncmF0aW8nIG1vZGUuIEZvciAncmF0aW8nIG1vZGUsIHRoaXMgaXMgdGhlICpyYXRpbyogb2Ygd2lkdGgtdG8taGVpZ2h0IChlLmcuLCAwLjc1KS5cclxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IE1hcCBvZiBDU1MgcHJvcGVydGllcyB0byBiZSBhcHBsaWVkIHRvIHRoZSBzdHlsZSBlbGVtZW50LiBXaWxsIGRlZmluZVxyXG4gICAgICogICAgIHZhbHVlcyBmb3IgdG9wLCBsZWZ0LCB3aWR0aCwgaGVpZ2h0LCBtYXJnaW5Ub3AsIGFuZCBwYWRkaW5nVG9wLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBnZXRUaWxlU3R5bGUocG9zaXRpb24sIHNwYW5zLCBjb2xDb3VudCwgcm93Q291bnQsIGd1dHRlciwgcm93TW9kZSwgcm93SGVpZ2h0KSB7XHJcbiAgICAgIC8vIFRPRE8oc2h5bmRtYW4pOiBUaGVyZSBhcmUgc3R5bGUgY2FjaGluZyBvcHBvcnR1bml0aWVzIGhlcmUuXHJcblxyXG4gICAgICAvLyBQZXJjZW50IG9mIHRoZSBhdmFpbGFibGUgaG9yaXpvbnRhbCBzcGFjZSB0aGF0IG9uZSBjb2x1bW4gdGFrZXMgdXAuXHJcbiAgICAgIHZhciBoU2hhcmUgPSAoMSAvIGNvbENvdW50KSAqIDEwMDtcclxuXHJcbiAgICAgIC8vIEZyYWN0aW9uIG9mIHRoZSBndXR0ZXIgc2l6ZSB0aGF0IGVhY2ggY29sdW1uIHRha2VzIHVwLlxyXG4gICAgICB2YXIgaEd1dHRlclNoYXJlID0gKGNvbENvdW50IC0gMSkgLyBjb2xDb3VudDtcclxuXHJcbiAgICAgIC8vIEJhc2UgaG9yaXpvbnRhbCBzaXplIG9mIGEgY29sdW1uLlxyXG4gICAgICB2YXIgaFVuaXQgPSBVTklUKHtzaGFyZTogaFNoYXJlLCBndXR0ZXJTaGFyZTogaEd1dHRlclNoYXJlLCBndXR0ZXI6IGd1dHRlcn0pO1xyXG5cclxuICAgICAgLy8gVGhlIHdpZHRoIGFuZCBob3Jpem9udGFsIHBvc2l0aW9uIG9mIGVhY2ggdGlsZSBpcyBhbHdheXMgY2FsY3VsYXRlZCB0aGUgc2FtZSB3YXksIGJ1dCB0aGVcclxuICAgICAgLy8gaGVpZ2h0IGFuZCB2ZXJ0aWNhbCBwb3NpdGlvbiBkZXBlbmRzIG9uIHRoZSByb3dNb2RlLlxyXG4gICAgICB2YXIgc3R5bGUgPSB7XHJcbiAgICAgICAgbGVmdDogUE9TSVRJT04oeyB1bml0OiBoVW5pdCwgb2Zmc2V0OiBwb3NpdGlvbi5jb2wsIGd1dHRlcjogZ3V0dGVyIH0pLFxyXG4gICAgICAgIHdpZHRoOiBESU1FTlNJT04oeyB1bml0OiBoVW5pdCwgc3Bhbjogc3BhbnMuY29sLCBndXR0ZXI6IGd1dHRlciB9KSxcclxuICAgICAgICAvLyByZXNldHNcclxuICAgICAgICBwYWRkaW5nVG9wOiAnJyxcclxuICAgICAgICBtYXJnaW5Ub3A6ICcnLFxyXG4gICAgICAgIHRvcDogJycsXHJcbiAgICAgICAgaGVpZ2h0OiAnJ1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgc3dpdGNoIChyb3dNb2RlKSB7XHJcbiAgICAgICAgY2FzZSAnZml4ZWQnOlxyXG4gICAgICAgICAgLy8gSW4gZml4ZWQgbW9kZSwgc2ltcGx5IHVzZSB0aGUgZ2l2ZW4gcm93SGVpZ2h0LlxyXG4gICAgICAgICAgc3R5bGUudG9wID0gUE9TSVRJT04oeyB1bml0OiByb3dIZWlnaHQsIG9mZnNldDogcG9zaXRpb24ucm93LCBndXR0ZXI6IGd1dHRlciB9KTtcclxuICAgICAgICAgIHN0eWxlLmhlaWdodCA9IERJTUVOU0lPTih7IHVuaXQ6IHJvd0hlaWdodCwgc3Bhbjogc3BhbnMucm93LCBndXR0ZXI6IGd1dHRlciB9KTtcclxuICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICBjYXNlICdyYXRpbyc6XHJcbiAgICAgICAgICAvLyBQZXJjZW50IG9mIHRoZSBhdmFpbGFibGUgdmVydGljYWwgc3BhY2UgdGhhdCBvbmUgcm93IHRha2VzIHVwLiBIZXJlLCByb3dIZWlnaHQgaG9sZHNcclxuICAgICAgICAgIC8vIHRoZSByYXRpbyB2YWx1ZS4gRm9yIGV4YW1wbGUsIGlmIHRoZSB3aWR0aDpoZWlnaHQgcmF0aW8gaXMgNDozLCByb3dIZWlnaHQgPSAxLjMzMy5cclxuICAgICAgICAgIHZhciB2U2hhcmUgPSBoU2hhcmUgLyByb3dIZWlnaHQ7XHJcblxyXG4gICAgICAgICAgLy8gQmFzZSB2ZXJpdGNhbCBzaXplIG9mIGEgcm93LlxyXG4gICAgICAgICAgdmFyIHZVbml0ID0gVU5JVCh7IHNoYXJlOiB2U2hhcmUsIGd1dHRlclNoYXJlOiBoR3V0dGVyU2hhcmUsIGd1dHRlcjogZ3V0dGVyIH0pO1xyXG5cclxuICAgICAgICAgIC8vIHBhZGlkbmdUb3AgYW5kIG1hcmdpblRvcCBhcmUgdXNlZCB0byBtYWludGFpbiB0aGUgZ2l2ZW4gYXNwZWN0IHJhdGlvLCBhc1xyXG4gICAgICAgICAgLy8gYSBwZXJjZW50YWdlLWJhc2VkIHZhbHVlIGZvciB0aGVzZSBwcm9wZXJ0aWVzIGlzIGFwcGxpZWQgdG8gdGhlICp3aWR0aCogb2YgdGhlXHJcbiAgICAgICAgICAvLyBjb250YWluaW5nIGJsb2NrLiBTZWUgaHR0cDovL3d3dy53My5vcmcvVFIvQ1NTMi9ib3guaHRtbCNtYXJnaW4tcHJvcGVydGllc1xyXG4gICAgICAgICAgc3R5bGUucGFkZGluZ1RvcCA9IERJTUVOU0lPTih7IHVuaXQ6IHZVbml0LCBzcGFuOiBzcGFucy5yb3csIGd1dHRlcjogZ3V0dGVyfSk7XHJcbiAgICAgICAgICBzdHlsZS5tYXJnaW5Ub3AgPSBQT1NJVElPTih7IHVuaXQ6IHZVbml0LCBvZmZzZXQ6IHBvc2l0aW9uLnJvdywgZ3V0dGVyOiBndXR0ZXIgfSk7XHJcbiAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgY2FzZSAnZml0JzpcclxuICAgICAgICAgIC8vIEZyYWN0aW9uIG9mIHRoZSBndXR0ZXIgc2l6ZSB0aGF0IGVhY2ggY29sdW1uIHRha2VzIHVwLlxyXG4gICAgICAgICAgdmFyIHZHdXR0ZXJTaGFyZSA9IChyb3dDb3VudCAtIDEpIC8gcm93Q291bnQ7XHJcblxyXG4gICAgICAgICAgLy8gUGVyY2VudCBvZiB0aGUgYXZhaWxhYmxlIHZlcnRpY2FsIHNwYWNlIHRoYXQgb25lIHJvdyB0YWtlcyB1cC5cclxuICAgICAgICAgIHZhciB2U2hhcmUgPSAoMSAvIHJvd0NvdW50KSAqIDEwMDtcclxuXHJcbiAgICAgICAgICAvLyBCYXNlIHZlcnRpY2FsIHNpemUgb2YgYSByb3cuXHJcbiAgICAgICAgICB2YXIgdlVuaXQgPSBVTklUKHtzaGFyZTogdlNoYXJlLCBndXR0ZXJTaGFyZTogdkd1dHRlclNoYXJlLCBndXR0ZXI6IGd1dHRlcn0pO1xyXG5cclxuICAgICAgICAgIHN0eWxlLnRvcCA9IFBPU0lUSU9OKHt1bml0OiB2VW5pdCwgb2Zmc2V0OiBwb3NpdGlvbi5yb3csIGd1dHRlcjogZ3V0dGVyfSk7XHJcbiAgICAgICAgICBzdHlsZS5oZWlnaHQgPSBESU1FTlNJT04oe3VuaXQ6IHZVbml0LCBzcGFuOiBzcGFucy5yb3csIGd1dHRlcjogZ3V0dGVyfSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHN0eWxlO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldEdyaWRTdHlsZShjb2xDb3VudCwgcm93Q291bnQsIGd1dHRlciwgcm93TW9kZSwgcm93SGVpZ2h0KSB7XHJcbiAgICAgIHZhciBzdHlsZSA9IHtcclxuICAgICAgICBoZWlnaHQ6ICcnLFxyXG4gICAgICAgIHBhZGRpbmdCb3R0b206ICcnXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBzd2l0Y2gocm93TW9kZSkge1xyXG4gICAgICAgIGNhc2UgJ2ZpeGVkJzpcclxuICAgICAgICAgIHN0eWxlLmhlaWdodCA9IERJTUVOU0lPTih7IHVuaXQ6IHJvd0hlaWdodCwgc3Bhbjogcm93Q291bnQsIGd1dHRlcjogZ3V0dGVyIH0pO1xyXG4gICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIGNhc2UgJ3JhdGlvJzpcclxuICAgICAgICAgIC8vIHJvd0hlaWdodCBpcyB3aWR0aCAvIGhlaWdodFxyXG4gICAgICAgICAgdmFyIGhHdXR0ZXJTaGFyZSA9IGNvbENvdW50ID09PSAxID8gMCA6IChjb2xDb3VudCAtIDEpIC8gY29sQ291bnQsXHJcbiAgICAgICAgICAgICAgaFNoYXJlID0gKDEgLyBjb2xDb3VudCkgKiAxMDAsXHJcbiAgICAgICAgICAgICAgdlNoYXJlID0gaFNoYXJlICogKDEgLyByb3dIZWlnaHQpLFxyXG4gICAgICAgICAgICAgIHZVbml0ID0gVU5JVCh7IHNoYXJlOiB2U2hhcmUsIGd1dHRlclNoYXJlOiBoR3V0dGVyU2hhcmUsIGd1dHRlcjogZ3V0dGVyIH0pO1xyXG5cclxuICAgICAgICAgIHN0eWxlLnBhZGRpbmdCb3R0b20gPSBESU1FTlNJT04oeyB1bml0OiB2VW5pdCwgc3Bhbjogcm93Q291bnQsIGd1dHRlcjogZ3V0dGVyfSk7XHJcbiAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgY2FzZSAnZml0JzpcclxuICAgICAgICAgIC8vIG5vb3AsIGFzIHRoZSBoZWlnaHQgaXMgdXNlciBzZXRcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gc3R5bGU7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0VGlsZUVsZW1lbnRzKCkge1xyXG4gICAgICByZXR1cm4gW10uZmlsdGVyLmNhbGwoZWxlbWVudC5jaGlsZHJlbigpLCBmdW5jdGlvbihlbGUpIHtcclxuICAgICAgICByZXR1cm4gZWxlLnRhZ05hbWUgPT0gJ01ELUdSSUQtVElMRSc7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0cyBhbiBhcnJheSBvZiBvYmplY3RzIGNvbnRhaW5pbmcgdGhlIHJvd3NwYW4gYW5kIGNvbHNwYW4gZm9yIGVhY2ggdGlsZS5cclxuICAgICAqIEByZXR1cm5zIHtBcnJheTx7cm93OiBudW1iZXIsIGNvbDogbnVtYmVyfT59XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGdldFRpbGVTcGFucyh0aWxlRWxlbWVudHMpIHtcclxuICAgICAgcmV0dXJuIFtdLm1hcC5jYWxsKHRpbGVFbGVtZW50cywgZnVuY3Rpb24oZWxlKSB7XHJcbiAgICAgICAgdmFyIGN0cmwgPSBhbmd1bGFyLmVsZW1lbnQoZWxlKS5jb250cm9sbGVyKCdtZEdyaWRUaWxlJyk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIHJvdzogcGFyc2VJbnQoXHJcbiAgICAgICAgICAgICAgJG1kTWVkaWEuZ2V0UmVzcG9uc2l2ZUF0dHJpYnV0ZShjdHJsLiRhdHRycywgJ21kLXJvd3NwYW4nKSwgMTApIHx8IDEsXHJcbiAgICAgICAgICBjb2w6IHBhcnNlSW50KFxyXG4gICAgICAgICAgICAgICRtZE1lZGlhLmdldFJlc3BvbnNpdmVBdHRyaWJ1dGUoY3RybC4kYXR0cnMsICdtZC1jb2xzcGFuJyksIDEwKSB8fCAxXHJcbiAgICAgICAgfTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0Q29sdW1uQ291bnQoKSB7XHJcbiAgICAgIHZhciBjb2xDb3VudCA9IHBhcnNlSW50KCRtZE1lZGlhLmdldFJlc3BvbnNpdmVBdHRyaWJ1dGUoYXR0cnMsICdtZC1jb2xzJyksIDEwKTtcclxuICAgICAgaWYgKGlzTmFOKGNvbENvdW50KSkge1xyXG4gICAgICAgIHRocm93ICdtZC1ncmlkLWxpc3Q6IG1kLWNvbHMgYXR0cmlidXRlIHdhcyBub3QgZm91bmQsIG9yIGNvbnRhaW5lZCBhIG5vbi1udW1lcmljIHZhbHVlJztcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gY29sQ291bnQ7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0R3V0dGVyKCkge1xyXG4gICAgICByZXR1cm4gYXBwbHlEZWZhdWx0VW5pdCgkbWRNZWRpYS5nZXRSZXNwb25zaXZlQXR0cmlidXRlKGF0dHJzLCAnbWQtZ3V0dGVyJykgfHwgMSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0Um93SGVpZ2h0KCkge1xyXG4gICAgICB2YXIgcm93SGVpZ2h0ID0gJG1kTWVkaWEuZ2V0UmVzcG9uc2l2ZUF0dHJpYnV0ZShhdHRycywgJ21kLXJvdy1oZWlnaHQnKTtcclxuICAgICAgc3dpdGNoIChnZXRSb3dNb2RlKCkpIHtcclxuICAgICAgICBjYXNlICdmaXhlZCc6XHJcbiAgICAgICAgICByZXR1cm4gYXBwbHlEZWZhdWx0VW5pdChyb3dIZWlnaHQpO1xyXG4gICAgICAgIGNhc2UgJ3JhdGlvJzpcclxuICAgICAgICAgIHZhciB3aFJhdGlvID0gcm93SGVpZ2h0LnNwbGl0KCc6Jyk7XHJcbiAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdCh3aFJhdGlvWzBdKSAvIHBhcnNlRmxvYXQod2hSYXRpb1sxXSk7XHJcbiAgICAgICAgY2FzZSAnZml0JzpcclxuICAgICAgICAgIHJldHVybiAwOyAvLyBOL0FcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldFJvd01vZGUoKSB7XHJcbiAgICAgIHZhciByb3dIZWlnaHQgPSAkbWRNZWRpYS5nZXRSZXNwb25zaXZlQXR0cmlidXRlKGF0dHJzLCAnbWQtcm93LWhlaWdodCcpO1xyXG4gICAgICBpZiAocm93SGVpZ2h0ID09ICdmaXQnKSB7XHJcbiAgICAgICAgcmV0dXJuICdmaXQnO1xyXG4gICAgICB9IGVsc2UgaWYgKHJvd0hlaWdodC5pbmRleE9mKCc6JykgIT09IC0xKSB7XHJcbiAgICAgICAgcmV0dXJuICdyYXRpbyc7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuICdmaXhlZCc7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBhcHBseURlZmF1bHRVbml0KHZhbCkge1xyXG4gICAgICByZXR1cm4gL1xcRCQvLnRlc3QodmFsKSA/IHZhbCA6IHZhbCArICdweCc7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbkdyaWRMaXN0RGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkaW50ZXJwb2xhdGVcIiwgXCIkbWRDb25zdGFudFwiLCBcIiRtZEdyaWRMYXlvdXRcIiwgXCIkbWRNZWRpYVwiXTtcclxuXHJcbi8qIEBuZ0luamVjdCAqL1xyXG5mdW5jdGlvbiBHcmlkTGlzdENvbnRyb2xsZXIoJHRpbWVvdXQpIHtcclxuICB0aGlzLmxheW91dEludmFsaWRhdGVkID0gZmFsc2U7XHJcbiAgdGhpcy50aWxlc0ludmFsaWRhdGVkID0gZmFsc2U7XHJcbiAgdGhpcy4kdGltZW91dF8gPSAkdGltZW91dDtcclxuICB0aGlzLmxheW91dERlbGVnYXRlID0gYW5ndWxhci5ub29wO1xyXG59XHJcbkdyaWRMaXN0Q29udHJvbGxlci4kaW5qZWN0ID0gW1wiJHRpbWVvdXRcIl07XHJcblxyXG5HcmlkTGlzdENvbnRyb2xsZXIucHJvdG90eXBlID0ge1xyXG4gIGludmFsaWRhdGVUaWxlczogZnVuY3Rpb24oKSB7XHJcbiAgICB0aGlzLnRpbGVzSW52YWxpZGF0ZWQgPSB0cnVlO1xyXG4gICAgdGhpcy5pbnZhbGlkYXRlTGF5b3V0KCk7XHJcbiAgfSxcclxuXHJcbiAgaW52YWxpZGF0ZUxheW91dDogZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAodGhpcy5sYXlvdXRJbnZhbGlkYXRlZCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLmxheW91dEludmFsaWRhdGVkID0gdHJ1ZTtcclxuICAgIHRoaXMuJHRpbWVvdXRfKGFuZ3VsYXIuYmluZCh0aGlzLCB0aGlzLmxheW91dCkpO1xyXG4gIH0sXHJcblxyXG4gIGxheW91dDogZnVuY3Rpb24oKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICB0aGlzLmxheW91dERlbGVnYXRlKHRoaXMudGlsZXNJbnZhbGlkYXRlZCk7XHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICB0aGlzLmxheW91dEludmFsaWRhdGVkID0gZmFsc2U7XHJcbiAgICAgIHRoaXMudGlsZXNJbnZhbGlkYXRlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxufTtcclxuXHJcblxyXG4vKiBAbmdJbmplY3QgKi9cclxuZnVuY3Rpb24gR3JpZExheW91dEZhY3RvcnkoJG1kVXRpbCkge1xyXG4gIHZhciBkZWZhdWx0QW5pbWF0b3IgPSBHcmlkVGlsZUFuaW1hdG9yO1xyXG5cclxuICAvKipcclxuICAgKiBTZXQgdGhlIHJlZmxvdyBhbmltYXRvciBjYWxsYmFja1xyXG4gICAqL1xyXG4gIEdyaWRMYXlvdXQuYW5pbWF0ZVdpdGggPSBmdW5jdGlvbihjdXN0b21BbmltYXRvcikge1xyXG4gICAgZGVmYXVsdEFuaW1hdG9yID0gIWFuZ3VsYXIuaXNGdW5jdGlvbihjdXN0b21BbmltYXRvcikgPyBHcmlkVGlsZUFuaW1hdG9yIDogY3VzdG9tQW5pbWF0b3I7XHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIEdyaWRMYXlvdXQ7XHJcblxyXG4gIC8qKlxyXG4gICAqIFB1Ymxpc2ggbGF5b3V0IGZ1bmN0aW9uXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gR3JpZExheW91dChjb2xDb3VudCwgdGlsZVNwYW5zKSB7XHJcbiAgICAgIHZhciBzZWxmLCBsYXlvdXRJbmZvLCBncmlkU3R5bGVzLCBsYXlvdXRUaW1lLCBtYXBUaW1lLCByZWZsb3dUaW1lO1xyXG5cclxuICAgICAgbGF5b3V0VGltZSA9ICRtZFV0aWwudGltZShmdW5jdGlvbigpIHtcclxuICAgICAgICBsYXlvdXRJbmZvID0gY2FsY3VsYXRlR3JpZEZvcihjb2xDb3VudCwgdGlsZVNwYW5zKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZXR1cm4gc2VsZiA9IHtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQW4gYXJyYXkgb2Ygb2JqZWN0cyBkZXNjcmliaW5nIGVhY2ggdGlsZSdzIHBvc2l0aW9uIGluIHRoZSBncmlkLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGxheW91dEluZm86IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgcmV0dXJuIGxheW91dEluZm87XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogTWFwcyBncmlkIHBvc2l0aW9uaW5nIHRvIGFuIGVsZW1lbnQgYW5kIGEgc2V0IG9mIHN0eWxlcyB1c2luZyB0aGVcclxuICAgICAgICAgKiBwcm92aWRlZCB1cGRhdGVGbi5cclxuICAgICAgICAgKi9cclxuICAgICAgICBtYXA6IGZ1bmN0aW9uKHVwZGF0ZUZuKSB7XHJcbiAgICAgICAgICBtYXBUaW1lID0gJG1kVXRpbC50aW1lKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgaW5mbyA9IHNlbGYubGF5b3V0SW5mbygpO1xyXG4gICAgICAgICAgICBncmlkU3R5bGVzID0gdXBkYXRlRm4oaW5mby5wb3NpdGlvbmluZywgaW5mby5yb3dDb3VudCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIHJldHVybiBzZWxmO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIERlZmF1bHQgYW5pbWF0b3Igc2ltcGx5IHNldHMgdGhlIGVsZW1lbnQuY3NzKCA8c3R5bGVzPiApLiBBbiBhbHRlcm5hdGVcclxuICAgICAgICAgKiBhbmltYXRvciBjYW4gYmUgcHJvdmlkZWQgYXMgYW4gYXJndW1lbnQuIFRoZSBmdW5jdGlvbiBoYXMgdGhlIGZvbGxvd2luZ1xyXG4gICAgICAgICAqIHNpZ25hdHVyZTpcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgIGZ1bmN0aW9uKHtncmlkOiB7ZWxlbWVudDogSlFMaXRlLCBzdHlsZTogT2JqZWN0fSwgdGlsZXM6IEFycmF5PHtlbGVtZW50OiBKUUxpdGUsIHN0eWxlOiBPYmplY3R9PilcclxuICAgICAgICAgKi9cclxuICAgICAgICByZWZsb3c6IGZ1bmN0aW9uKGFuaW1hdG9yRm4pIHtcclxuICAgICAgICAgIHJlZmxvd1RpbWUgPSAkbWRVdGlsLnRpbWUoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBhbmltYXRvciA9IGFuaW1hdG9yRm4gfHwgZGVmYXVsdEFuaW1hdG9yO1xyXG4gICAgICAgICAgICBhbmltYXRvcihncmlkU3R5bGVzLmdyaWQsIGdyaWRTdHlsZXMudGlsZXMpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICByZXR1cm4gc2VsZjtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaW1pbmcgZm9yIHRoZSBtb3N0IHJlY2VudCBsYXlvdXQgcnVuLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHBlcmZvcm1hbmNlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHRpbGVDb3VudDogdGlsZVNwYW5zLmxlbmd0aCxcclxuICAgICAgICAgICAgbGF5b3V0VGltZTogbGF5b3V0VGltZSxcclxuICAgICAgICAgICAgbWFwVGltZTogbWFwVGltZSxcclxuICAgICAgICAgICAgcmVmbG93VGltZTogcmVmbG93VGltZSxcclxuICAgICAgICAgICAgdG90YWxUaW1lOiBsYXlvdXRUaW1lICsgbWFwVGltZSArIHJlZmxvd1RpbWVcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAvKipcclxuICAgKiBEZWZhdWx0IEdyaWRsaXN0IGFuaW1hdG9yIHNpbXBsZSBzZXRzIHRoZSBjc3MgZm9yIGVhY2ggZWxlbWVudDtcclxuICAgKiBOT1RFOiBhbnkgdHJhbnNpdGlvbnMgZWZmZWN0cyBtdXN0IGJlIG1hbnVhbGx5IHNldCBpbiB0aGUgQ1NTLlxyXG4gICAqIGUuZy5cclxuICAgKlxyXG4gICAqICBtZC1ncmlkLXRpbGUge1xyXG4gICAqICAgIHRyYW5zaXRpb246IGFsbCA3MDBtcyBlYXNlLW91dCA1MG1zO1xyXG4gICAqICB9XHJcbiAgICpcclxuICAgKi9cclxuICBmdW5jdGlvbiBHcmlkVGlsZUFuaW1hdG9yKGdyaWQsIHRpbGVzKSB7XHJcbiAgICBncmlkLmVsZW1lbnQuY3NzKGdyaWQuc3R5bGUpO1xyXG4gICAgdGlsZXMuZm9yRWFjaChmdW5jdGlvbih0KSB7XHJcbiAgICAgIHQuZWxlbWVudC5jc3ModC5zdHlsZSk7XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2FsY3VsYXRlcyB0aGUgcG9zaXRpb25zIG9mIHRpbGVzLlxyXG4gICAqXHJcbiAgICogVGhlIGFsZ29yaXRobSB3b3JrcyBhcyBmb2xsb3dzOlxyXG4gICAqICAgIEFuIEFycmF5PE51bWJlcj4gd2l0aCBsZW5ndGggY29sQ291bnQgKHNwYWNlVHJhY2tlcikga2VlcHMgdHJhY2sgb2ZcclxuICAgKiAgICBhdmFpbGFibGUgdGlsaW5nIHBvc2l0aW9ucywgd2hlcmUgZWxlbWVudHMgb2YgdmFsdWUgMCByZXByZXNlbnRzIGFuXHJcbiAgICogICAgZW1wdHkgcG9zaXRpb24uIFNwYWNlIGZvciBhIHRpbGUgaXMgcmVzZXJ2ZWQgYnkgZmluZGluZyBhIHNlcXVlbmNlIG9mXHJcbiAgICogICAgMHMgd2l0aCBsZW5ndGggPD0gdGhhbiB0aGUgdGlsZSdzIGNvbHNwYW4uIFdoZW4gc3VjaCBhIHNwYWNlIGhhcyBiZWVuXHJcbiAgICogICAgZm91bmQsIHRoZSBvY2N1cGllZCB0aWxlIHBvc2l0aW9ucyBhcmUgaW5jcmVtZW50ZWQgYnkgdGhlIHRpbGUnc1xyXG4gICAqICAgIHJvd3NwYW4gdmFsdWUsIGFzIHRoZXNlIHBvc2l0aW9ucyBoYXZlIGJlY29tZSB1bmF2YWlsYWJsZSBmb3IgdGhhdFxyXG4gICAqICAgIG1hbnkgcm93cy5cclxuICAgKlxyXG4gICAqICAgIElmIHRoZSBlbmQgb2YgYSByb3cgaGFzIGJlZW4gcmVhY2hlZCB3aXRob3V0IGZpbmRpbmcgc3BhY2UgZm9yIHRoZVxyXG4gICAqICAgIHRpbGUsIHNwYWNlVHJhY2tlcidzIGVsZW1lbnRzIGFyZSBlYWNoIGRlY3JlbWVudGVkIGJ5IDEgdG8gYSBtaW5pbXVtXHJcbiAgICogICAgb2YgMC4gUm93cyBhcmUgc2VhcmNoZWQgaW4gdGhpcyBmYXNoaW9uIHVudGlsIHNwYWNlIGlzIGZvdW5kLlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGNhbGN1bGF0ZUdyaWRGb3IoY29sQ291bnQsIHRpbGVTcGFucykge1xyXG4gICAgdmFyIGN1ckNvbCA9IDAsXHJcbiAgICAgICAgY3VyUm93ID0gMCxcclxuICAgICAgICBzcGFjZVRyYWNrZXIgPSBuZXdTcGFjZVRyYWNrZXIoKTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBwb3NpdGlvbmluZzogdGlsZVNwYW5zLm1hcChmdW5jdGlvbihzcGFucywgaSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBzcGFuczogc3BhbnMsXHJcbiAgICAgICAgICBwb3NpdGlvbjogcmVzZXJ2ZVNwYWNlKHNwYW5zLCBpKVxyXG4gICAgICAgIH07XHJcbiAgICAgIH0pLFxyXG4gICAgICByb3dDb3VudDogY3VyUm93ICsgTWF0aC5tYXguYXBwbHkoTWF0aCwgc3BhY2VUcmFja2VyKVxyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiByZXNlcnZlU3BhY2Uoc3BhbnMsIGkpIHtcclxuICAgICAgaWYgKHNwYW5zLmNvbCA+IGNvbENvdW50KSB7XHJcbiAgICAgICAgdGhyb3cgJ21kLWdyaWQtbGlzdDogVGlsZSBhdCBwb3NpdGlvbiAnICsgaSArICcgaGFzIGEgY29sc3BhbiAnICtcclxuICAgICAgICAgICAgJygnICsgc3BhbnMuY29sICsgJykgdGhhdCBleGNlZWRzIHRoZSBjb2x1bW4gY291bnQgJyArXHJcbiAgICAgICAgICAgICcoJyArIGNvbENvdW50ICsgJyknO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB2YXIgc3RhcnQgPSAwLFxyXG4gICAgICAgICAgZW5kID0gMDtcclxuXHJcbiAgICAgIC8vIFRPRE8oc2h5bmRtYW4pOiBUaGlzIGxvb3AgaXNuJ3Qgc3RyaWN0bHkgbmVjZXNzYXJ5IGlmIHlvdSBjYW5cclxuICAgICAgLy8gZGV0ZXJtaW5lIHRoZSBtaW5pbXVtIG51bWJlciBvZiByb3dzIGJlZm9yZSBhIHNwYWNlIG9wZW5zIHVwLiBUbyBkb1xyXG4gICAgICAvLyB0aGlzLCByZWNvZ25pemUgdGhhdCB5b3UndmUgaXRlcmF0ZWQgYWNyb3NzIGFuIGVudGlyZSByb3cgbG9va2luZyBmb3JcclxuICAgICAgLy8gc3BhY2UsIGFuZCBpZiBzbyBmYXN0LWZvcndhcmQgYnkgdGhlIG1pbmltdW0gcm93U3BhbiBjb3VudC4gUmVwZWF0XHJcbiAgICAgIC8vIHVudGlsIHRoZSByZXF1aXJlZCBzcGFjZSBvcGVucyB1cC5cclxuICAgICAgd2hpbGUgKGVuZCAtIHN0YXJ0IDwgc3BhbnMuY29sKSB7XHJcbiAgICAgICAgaWYgKGN1ckNvbCA+PSBjb2xDb3VudCkge1xyXG4gICAgICAgICAgbmV4dFJvdygpO1xyXG4gICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBzdGFydCA9IHNwYWNlVHJhY2tlci5pbmRleE9mKDAsIGN1ckNvbCk7XHJcbiAgICAgICAgaWYgKHN0YXJ0ID09PSAtMSB8fCAoZW5kID0gZmluZEVuZChzdGFydCArIDEpKSA9PT0gLTEpIHtcclxuICAgICAgICAgIHN0YXJ0ID0gZW5kID0gMDtcclxuICAgICAgICAgIG5leHRSb3coKTtcclxuICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY3VyQ29sID0gZW5kICsgMTtcclxuICAgICAgfVxyXG5cclxuICAgICAgYWRqdXN0Um93KHN0YXJ0LCBzcGFucy5jb2wsIHNwYW5zLnJvdyk7XHJcbiAgICAgIGN1ckNvbCA9IHN0YXJ0ICsgc3BhbnMuY29sO1xyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBjb2w6IHN0YXJ0LFxyXG4gICAgICAgIHJvdzogY3VyUm93XHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbmV4dFJvdygpIHtcclxuICAgICAgY3VyQ29sID0gMDtcclxuICAgICAgY3VyUm93Kys7XHJcbiAgICAgIGFkanVzdFJvdygwLCBjb2xDb3VudCwgLTEpOyAvLyBEZWNyZW1lbnQgcm93IHNwYW5zIGJ5IG9uZVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGFkanVzdFJvdyhmcm9tLCBjb2xzLCBieSkge1xyXG4gICAgICBmb3IgKHZhciBpID0gZnJvbTsgaSA8IGZyb20gKyBjb2xzOyBpKyspIHtcclxuICAgICAgICBzcGFjZVRyYWNrZXJbaV0gPSBNYXRoLm1heChzcGFjZVRyYWNrZXJbaV0gKyBieSwgMCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBmaW5kRW5kKHN0YXJ0KSB7XHJcbiAgICAgIHZhciBpO1xyXG4gICAgICBmb3IgKGkgPSBzdGFydDsgaSA8IHNwYWNlVHJhY2tlci5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGlmIChzcGFjZVRyYWNrZXJbaV0gIT09IDApIHtcclxuICAgICAgICAgIHJldHVybiBpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKGkgPT09IHNwYWNlVHJhY2tlci5sZW5ndGgpIHtcclxuICAgICAgICByZXR1cm4gaTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG5ld1NwYWNlVHJhY2tlcigpIHtcclxuICAgICAgdmFyIHRyYWNrZXIgPSBbXTtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb2xDb3VudDsgaSsrKSB7XHJcbiAgICAgICAgdHJhY2tlci5wdXNoKDApO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0cmFja2VyO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5HcmlkTGF5b3V0RmFjdG9yeS4kaW5qZWN0ID0gW1wiJG1kVXRpbFwiXTtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAqIEBuYW1lIG1kR3JpZFRpbGVcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmdyaWRMaXN0XHJcbiAqIEByZXN0cmljdCBFXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBUaWxlcyBjb250YWluIHRoZSBjb250ZW50IG9mIGFuIGBtZC1ncmlkLWxpc3RgLiBUaGV5IHNwYW4gb25lIG9yIG1vcmUgZ3JpZFxyXG4gKiBjZWxscyB2ZXJ0aWNhbGx5IG9yIGhvcml6b250YWxseSwgYW5kIHVzZSBgbWQtZ3JpZC10aWxlLXtmb290ZXIsaGVhZGVyfWAgdG9cclxuICogZGlzcGxheSBzZWNvbmRhcnkgY29udGVudC5cclxuICpcclxuICogIyMjIFJlc3BvbnNpdmUgQXR0cmlidXRlc1xyXG4gKlxyXG4gKiBUaGUgYG1kLWdyaWQtdGlsZWAgZGlyZWN0aXZlIHN1cHBvcnRzIFwicmVzcG9uc2l2ZVwiIGF0dHJpYnV0ZXMsIHdoaWNoIGFsbG93XHJcbiAqIGRpZmZlcmVudCBgbWQtcm93c3BhbmAgYW5kIGBtZC1jb2xzcGFuYCB2YWx1ZXMgZGVwZW5kaW5nIG9uIHRoZSBjdXJyZW50bHlcclxuICogbWF0Y2hpbmcgbWVkaWEgcXVlcnkgKGFzIGRlZmluZWQgaW4gYCRtZENvbnN0YW50Lk1FRElBYCkuXHJcbiAqXHJcbiAqIEluIG9yZGVyIHRvIHNldCBhIHJlc3BvbnNpdmUgYXR0cmlidXRlLCBmaXJzdCBkZWZpbmUgdGhlIGZhbGxiYWNrIHZhbHVlIHdpdGhcclxuICogdGhlIHN0YW5kYXJkIGF0dHJpYnV0ZSBuYW1lLCB0aGVuIGFkZCBhZGRpdGlvbmFsIGF0dHJpYnV0ZXMgd2l0aCB0aGVcclxuICogZm9sbG93aW5nIGNvbnZlbnRpb246IGB7YmFzZS1hdHRyaWJ1dGUtbmFtZX0te21lZGlhLXF1ZXJ5LW5hbWV9PVwie3ZhbHVlfVwiYFxyXG4gKiAoaWUuIGBtZC1jb2xzcGFuLXNtPVwiNFwiYClcclxuICpcclxuICogQHBhcmFtIHtudW1iZXI9fSBtZC1jb2xzcGFuIFRoZSBudW1iZXIgb2YgY29sdW1ucyB0byBzcGFuIChkZWZhdWx0IDEpLiBDYW5ub3RcclxuICogICAgZXhjZWVkIHRoZSBudW1iZXIgb2YgY29sdW1ucyBpbiB0aGUgZ3JpZC4gU3VwcG9ydHMgaW50ZXJwb2xhdGlvbi5cclxuICogQHBhcmFtIHtudW1iZXI9fSBtZC1yb3dzcGFuIFRoZSBudW1iZXIgb2Ygcm93cyB0byBzcGFuIChkZWZhdWx0IDEpLiBTdXBwb3J0c1xyXG4gKiAgICAgaW50ZXJwb2xhdGlvbi5cclxuICpcclxuICogQHVzYWdlXHJcbiAqIFdpdGggaGVhZGVyOlxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtZ3JpZC10aWxlPlxyXG4gKiAgIDxtZC1ncmlkLXRpbGUtaGVhZGVyPlxyXG4gKiAgICAgPGgzPlRoaXMgaXMgYSBoZWFkZXI8L2gzPlxyXG4gKiAgIDwvbWQtZ3JpZC10aWxlLWhlYWRlcj5cclxuICogPC9tZC1ncmlkLXRpbGU+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICogV2l0aCBmb290ZXI6XHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqIDxtZC1ncmlkLXRpbGU+XHJcbiAqICAgPG1kLWdyaWQtdGlsZS1mb290ZXI+XHJcbiAqICAgICA8aDM+VGhpcyBpcyBhIGZvb3RlcjwvaDM+XHJcbiAqICAgPC9tZC1ncmlkLXRpbGUtZm9vdGVyPlxyXG4gKiA8L21kLWdyaWQtdGlsZT5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiBTcGFubmluZyBtdWx0aXBsZSByb3dzL2NvbHVtbnM6XHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqIDxtZC1ncmlkLXRpbGUgbWQtY29sc3Bhbj1cIjJcIiBtZC1yb3dzcGFuPVwiM1wiPlxyXG4gKiA8L21kLWdyaWQtdGlsZT5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiBSZXNwb25zaXZlIGF0dHJpYnV0ZXM6XHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqIDxtZC1ncmlkLXRpbGUgbWQtY29sc3Bhbj1cIjFcIiBtZC1jb2xzcGFuLXNtPVwiM1wiIG1kLWNvbHNwYW4tbWQ9XCI1XCI+XHJcbiAqIDwvbWQtZ3JpZC10aWxlPlxyXG4gKiA8L2hsanM+XHJcbiAqL1xyXG5mdW5jdGlvbiBHcmlkVGlsZURpcmVjdGl2ZSgkbWRNZWRpYSkge1xyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgcmVxdWlyZTogJ15tZEdyaWRMaXN0JyxcclxuICAgIHRlbXBsYXRlOiAnPGZpZ3VyZSBuZy10cmFuc2NsdWRlPjwvZmlndXJlPicsXHJcbiAgICB0cmFuc2NsdWRlOiB0cnVlLFxyXG4gICAgc2NvcGU6IHt9LFxyXG4gICAgLy8gU2ltcGxlIGNvbnRyb2xsZXIgdGhhdCBleHBvc2VzIGF0dHJpYnV0ZXMgdG8gdGhlIGdyaWQgZGlyZWN0aXZlXHJcbiAgICBjb250cm9sbGVyOiBbXCIkYXR0cnNcIiwgZnVuY3Rpb24oJGF0dHJzKSB7XHJcbiAgICAgIHRoaXMuJGF0dHJzID0gJGF0dHJzO1xyXG4gICAgfV0sXHJcbiAgICBsaW5rOiBwb3N0TGlua1xyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRycywgZ3JpZEN0cmwpIHtcclxuICAgIC8vIEFwcGx5IHNlbWFudGljc1xyXG4gICAgZWxlbWVudC5hdHRyKCdyb2xlJywgJ2xpc3RpdGVtJyk7XHJcblxyXG4gICAgLy8gSWYgb3VyIGNvbHNwYW4gb3Igcm93c3BhbiBjaGFuZ2VzLCB0cmlnZ2VyIGEgbGF5b3V0XHJcbiAgICB2YXIgdW53YXRjaEF0dHJzID0gJG1kTWVkaWEud2F0Y2hSZXNwb25zaXZlQXR0cmlidXRlcyhbJ21kLWNvbHNwYW4nLCAnbWQtcm93c3BhbiddLFxyXG4gICAgICAgIGF0dHJzLCBhbmd1bGFyLmJpbmQoZ3JpZEN0cmwsIGdyaWRDdHJsLmludmFsaWRhdGVMYXlvdXQpKTtcclxuXHJcbiAgICAvLyBUaWxlIHJlZ2lzdHJhdGlvbi9kZXJlZ2lzdHJhdGlvblxyXG4gICAgZ3JpZEN0cmwuaW52YWxpZGF0ZVRpbGVzKCk7XHJcbiAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHVud2F0Y2hBdHRycygpO1xyXG4gICAgICBncmlkQ3RybC5pbnZhbGlkYXRlTGF5b3V0KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoc2NvcGUuJHBhcmVudC4kaW5kZXgpKSB7XHJcbiAgICAgIHNjb3BlLiR3YXRjaChmdW5jdGlvbigpIHsgcmV0dXJuIHNjb3BlLiRwYXJlbnQuJGluZGV4OyB9LFxyXG4gICAgICAgIGZ1bmN0aW9uIGluZGV4Q2hhbmdlZChuZXdJZHgsIG9sZElkeCkge1xyXG4gICAgICAgICAgaWYgKG5ld0lkeCA9PT0gb2xkSWR4KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGdyaWRDdHJsLmludmFsaWRhdGVUaWxlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5HcmlkVGlsZURpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kTWVkaWFcIl07XHJcblxyXG5cclxuZnVuY3Rpb24gR3JpZFRpbGVDYXB0aW9uRGlyZWN0aXZlKCkge1xyXG4gIHJldHVybiB7XHJcbiAgICB0ZW1wbGF0ZTogJzxmaWdjYXB0aW9uIG5nLXRyYW5zY2x1ZGU+PC9maWdjYXB0aW9uPicsXHJcbiAgICB0cmFuc2NsdWRlOiB0cnVlXHJcbiAgfTtcclxufVxyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtb2R1bGVcclxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5pY29uXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBJY29uXHJcbiAqL1xyXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5pY29uJywgW1xyXG4gICAgJ21hdGVyaWFsLmNvcmUnXHJcbiAgXSlcclxuICAuZGlyZWN0aXZlKCdtZEljb24nLCBtZEljb25EaXJlY3RpdmUpO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRJY29uXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5pY29uXHJcbiAqXHJcbiAqIEByZXN0cmljdCBFXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBUaGUgYDxtZC1pY29uPmAgZGlyZWN0aXZlIGlzIGFuIG1hcmt1cCBlbGVtZW50IHVzZWZ1bCBmb3Igc2hvd2luZyBhbiBpY29uIGJhc2VkIG9uIGEgZm9udC1pY29uXHJcbiAqIG9yIGEgU1ZHLiBJY29ucyBhcmUgdmlldy1vbmx5IGVsZW1lbnRzIHRoYXQgc2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGFzIGJ1dHRvbnM7IGluc3RlYWQgbmVzdCBhIGA8bWQtaWNvbj5gXHJcbiAqIGluc2lkZSBhIGBtZC1idXR0b25gIHRvIGFkZCBob3ZlciBhbmQgY2xpY2sgZmVhdHVyZXMuXHJcbiAqXHJcbiAqIFdoZW4gdXNpbmcgU1ZHcywgYm90aCBleHRlcm5hbCBTVkdzICh2aWEgVVJMcykgb3Igc2V0cyBvZiBTVkdzIFtmcm9tIGljb24gc2V0c10gY2FuIGJlXHJcbiAqIGVhc2lseSBsb2FkZWQgYW5kIHVzZWQuV2hlbiB1c2UgZm9udC1pY29ucywgZGV2ZWxvcGVycyBtdXN0IGZvbGxvd2luZyB0aHJlZSAoMykgc2ltcGxlIHN0ZXBzOlxyXG4gKlxyXG4gKiA8b2w+XHJcbiAqIDxsaT5Mb2FkIHRoZSBmb250IGxpYnJhcnkuIGUuZy48YnIvPlxyXG4gKiAgICAmbHQ7bGluayBocmVmPVwiaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9pY29uP2ZhbWlseT1NYXRlcmlhbCtJY29uc1wiXHJcbiAqICAgIHJlbD1cInN0eWxlc2hlZXRcIiZndDtcclxuICogPC9saT5cclxuICogPGxpPiBVc2UgZWl0aGVyIChhKSBmb250LWljb24gY2xhc3MgbmFtZXMgb3IgKGIpIGZvbnQgbGlnYXR1cmVzIHRvIHJlbmRlciB0aGUgZm9udCBnbHlwaCBieSB1c2luZyBpdHMgdGV4dHVhbCBuYW1lPC9saT5cclxuICogPGxpPiBVc2UgJmx0O21kLWljb24gbWQtZm9udC1pY29uPVwiY2xhc3NuYW1lXCIgLyZndDsgb3IgPGJyLz5cclxuICogICAgIHVzZSAmbHQ7bWQtaWNvbiBtZC1mb250LXNldD1cImZvbnQgbGlicmFyeSBjbGFzc25hbWUgb3IgYWxpYXNcIiZndDsgdGV4dHVhbF9uYW1lICZsdDsvbWQtaWNvbiZndDsgb3IgPGJyLz5cclxuICogICAgIHVzZSAmbHQ7bWQtaWNvbiBtZC1mb250LXNldD1cImZvbnQgbGlicmFyeSBjbGFzc25hbWUgb3IgYWxpYXNcIiZndDsgbnVtZXJpY2FsX2NoYXJhY3Rlcl9yZWZlcmVuY2UgJmx0Oy9tZC1pY29uJmd0O1xyXG4gKiA8L2xpPlxyXG4gKiA8L29sPlxyXG4gKlxyXG4gKiBGdWxsIGRldGFpbHMgZm9yIHRoZXNlIHN0ZXBzIGNhbiBiZSBmb3VuZDpcclxuICpcclxuICogPHVsPlxyXG4gKiA8bGk+aHR0cDovL2dvb2dsZS5naXRodWIuaW8vbWF0ZXJpYWwtZGVzaWduLWljb25zLzwvbGk+XHJcbiAqIDxsaT5odHRwOi8vZ29vZ2xlLmdpdGh1Yi5pby9tYXRlcmlhbC1kZXNpZ24taWNvbnMvI2ljb24tZm9udC1mb3ItdGhlLXdlYjwvbGk+XHJcbiAqIDwvdWw+XHJcbiAqXHJcbiAqIFRoZSBNYXRlcmlhbCBEZXNpZ24gaWNvbiBzdHlsZSA8Y29kZT4ubWF0ZXJpYWwtaWNvbnM8L2NvZGU+IGFuZCB0aGUgaWNvbiBmb250IHJlZmVyZW5jZXMgYXJlIHB1Ymxpc2hlZCBpblxyXG4gKiBNYXRlcmlhbCBEZXNpZ24gSWNvbnM6XHJcbiAqXHJcbiAqIDx1bD5cclxuICogPGxpPmh0dHA6Ly93d3cuZ29vZ2xlLmNvbS9kZXNpZ24vaWNvbnMvPC9saT5cclxuICogPGxpPmh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vZGVzaWduL2ljb25zLyNpY19hY2Nlc3NpYmlsaXR5PC9saT5cclxuICogPC91bD5cclxuICpcclxuICogPGgyIGlkPVwibWF0ZXJpYWxfZGVzaWduX2ljb25zXCI+TWF0ZXJpYWwgRGVzaWduIEljb25zPC9oMj5cclxuICogVXNpbmcgdGhlIE1hdGVyaWFsIERlc2lnbiBJY29uLVNlbGVjdG9yLCBkZXZlbG9wZXJzIGNhbiBlYXNpbHkgYW5kIHF1aWNrbHkgc2VhcmNoIGZvciBhIE1hdGVyaWFsIERlc2lnbiBmb250LWljb24gYW5kXHJcbiAqIGRldGVybWluZSBpdHMgdGV4dHVhbCBuYW1lIGFuZCBjaGFyYWN0ZXIgcmVmZXJlbmNlIGNvZGUuIENsaWNrIG9uIGFueSBpY29uIHRvIHNlZSB0aGUgc2xpZGUtdXAgaW5mb3JtYXRpb25cclxuICogcGFuZWwgd2l0aCBkZXRhaWxzIHJlZ2FyZGluZyBhIFNWRyBkb3dubG9hZCBvciBpbmZvcm1hdGlvbiBvbiB0aGUgZm9udC1pY29uIHVzYWdlLlxyXG4gKlxyXG4gKiA8YSBocmVmPVwiaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9kZXNpZ24vaWNvbnMvI2ljX2FjY2Vzc2liaWxpdHlcIiB0YXJnZXQ9XCJfYmxhbmtcIiBzdHlsZT1cImJvcmRlci1ib3R0b206bm9uZTtcIj5cclxuICogPGltZyBzcmM9XCJodHRwczovL2Nsb3VkLmdpdGh1YnVzZXJjb250ZW50LmNvbS9hc3NldHMvMjEwNDEzLzc5MDI0OTAvZmU4ZGQxNGMtMDc4MC0xMWU1LTk4ZmItYzgyMWNjNjQ3NWU2LnBuZ1wiXHJcbiAqICAgICAgYXJpYS1sYWJlbD1cIk1hdGVyaWFsIERlc2lnbiBJY29uLVNlbGVjdG9yXCIgc3R5bGU9XCJtYXgtd2lkdGg6NzUlO3BhZGRpbmctbGVmdDoxMCVcIj5cclxuICogPC9hPlxyXG4gKlxyXG4gKiA8c3BhbiBjbGFzcz1cImltYWdlX2NhcHRpb25cIj5cclxuICogIENsaWNrIG9uIHRoZSBpbWFnZSBhYm92ZSB0byBsaW5rIHRvIHRoZVxyXG4gKiAgPGEgaHJlZj1cImh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vZGVzaWduL2ljb25zLyNpY19hY2Nlc3NpYmlsaXR5XCIgdGFyZ2V0PVwiX2JsYW5rXCI+TWF0ZXJpYWwgRGVzaWduIEljb24tU2VsZWN0b3I8L2E+LlxyXG4gKiA8L3NwYW4+XHJcbiAqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZC1mb250LWljb24gTmFtZSBvZiBDU1MgaWNvbiBhc3NvY2lhdGVkIHdpdGggdGhlIGZvbnQtZmFjZSB3aWxsIGJlIHVzZWRcclxuICogdG8gcmVuZGVyIHRoZSBpY29uLiBSZXF1aXJlcyB0aGUgZm9udHMgYW5kIHRoZSBuYW1lZCBDU1Mgc3R5bGVzIHRvIGJlIHByZWxvYWRlZC5cclxuICogQHBhcmFtIHtzdHJpbmd9IG1kLWZvbnQtc2V0IENTUyBzdHlsZSBuYW1lIGFzc29jaWF0ZWQgd2l0aCB0aGUgZm9udCBsaWJyYXJ5OyB3aGljaCB3aWxsIGJlIGFzc2lnbmVkIGFzXHJcbiAqIHRoZSBjbGFzcyBmb3IgdGhlIGZvbnQtaWNvbiBsaWdhdHVyZS4gVGhpcyB2YWx1ZSBtYXkgYWxzbyBiZSBhbiBhbGlhcyB0aGF0IGlzIHVzZWQgdG8gbG9va3VwIHRoZSBjbGFzc25hbWU7XHJcbiAqIGludGVybmFsbHkgdXNlIGAkbWRJY29uUHJvdmlkZXIuZm9udFNldCg8YWxpYXM+KWAgdG8gZGV0ZXJtaW5lIHRoZSBzdHlsZSBuYW1lLlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gbWQtc3ZnLXNyYyBVUkwgW29yIGV4cHJlc3Npb24gXSB1c2VkIHRvIGxvYWQsIGNhY2hlLCBhbmQgZGlzcGxheSBhbiBleHRlcm5hbCBTVkcuXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZC1zdmctaWNvbiBOYW1lIHVzZWQgZm9yIGxvb2t1cCBvZiB0aGUgaWNvbiBmcm9tIHRoZSBpbnRlcm5hbCBjYWNoZTsgaW50ZXJwb2xhdGVkIHN0cmluZ3Mgb3JcclxuICogZXhwcmVzc2lvbnMgbWF5IGFsc28gYmUgdXNlZC4gU3BlY2lmaWMgc2V0IG5hbWVzIGNhbiBiZSB1c2VkIHdpdGggdGhlIHN5bnRheCBgPHNldCBuYW1lPjo8aWNvbiBuYW1lPmAuPGJyLz48YnIvPlxyXG4gKiBUbyB1c2UgaWNvbiBzZXRzLCBkZXZlbG9wZXJzIGFyZSByZXF1aXJlZCB0byBwcmUtcmVnaXN0ZXIgdGhlIHNldHMgdXNpbmcgdGhlIGAkbWRJY29uUHJvdmlkZXJgIHNlcnZpY2UuXHJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gYXJpYS1sYWJlbCBMYWJlbHMgaWNvbiBmb3IgYWNjZXNzaWJpbGl0eS4gSWYgYW4gZW1wdHkgc3RyaW5nIGlzIHByb3ZpZGVkLCBpY29uXHJcbiAqIHdpbGwgYmUgaGlkZGVuIGZyb20gYWNjZXNzaWJpbGl0eSBsYXllciB3aXRoIGBhcmlhLWhpZGRlbj1cInRydWVcImAuIElmIHRoZXJlJ3Mgbm8gYXJpYS1sYWJlbCBvbiB0aGUgaWNvblxyXG4gKiBub3IgYSBsYWJlbCBvbiB0aGUgcGFyZW50IGVsZW1lbnQsIGEgd2FybmluZyB3aWxsIGJlIGxvZ2dlZCB0byB0aGUgY29uc29sZS5cclxuICpcclxuICogQHVzYWdlXHJcbiAqIFdoZW4gdXNpbmcgU1ZHczpcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICpcclxuICogIDwhLS0gSWNvbiBJRDsgbWF5IGNvbnRhaW4gb3B0aW9uYWwgaWNvbiBzZXQgcHJlZml4OyBpY29ucyBtdXN0IHJlZ2lzdGVyZWQgdXNpbmcgJG1kSWNvblByb3ZpZGVyIC0tPlxyXG4gKiAgPG1kLWljb24gbWQtc3ZnLWljb249XCJzb2NpYWw6YW5kcm9pZFwiICAgIGFyaWEtbGFiZWw9XCJhbmRyb2lkIFwiID48L21kLWljb24+XHJcbiAqXHJcbiAqICA8IS0tIEljb24gdXJsczsgbWF5IGJlIHByZWxvYWRlZCBpbiB0ZW1wbGF0ZUNhY2hlIC0tPlxyXG4gKiAgPG1kLWljb24gbWQtc3ZnLXNyYz1cIi9hbmRyb2lkLnN2Z1wiICAgICAgIGFyaWEtbGFiZWw9XCJhbmRyb2lkIFwiID48L21kLWljb24+XHJcbiAqICA8bWQtaWNvbiBtZC1zdmctc3JjPVwie3sgZ2V0QW5kcm9pZCgpIH19XCIgYXJpYS1sYWJlbD1cImFuZHJvaWQgXCIgPjwvbWQtaWNvbj5cclxuICpcclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiBVc2UgdGhlIDxjb2RlPiRtZEljb25Qcm92aWRlcjwvY29kZT4gdG8gY29uZmlndXJlIHlvdXIgYXBwbGljYXRpb24gd2l0aFxyXG4gKiBzdmcgaWNvbnNldHMuXHJcbiAqXHJcbiAqIDxobGpzIGxhbmc9XCJqc1wiPlxyXG4gKiAgYW5ndWxhci5tb2R1bGUoJ2FwcFN2Z0ljb25TZXRzJywgWyduZ01hdGVyaWFsJ10pXHJcbiAqICAgIC5jb250cm9sbGVyKCdEZW1vQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSkge30pXHJcbiAqICAgIC5jb25maWcoZnVuY3Rpb24oJG1kSWNvblByb3ZpZGVyKSB7XHJcbiAqICAgICAgJG1kSWNvblByb3ZpZGVyXHJcbiAqICAgICAgICAgLmljb25TZXQoJ3NvY2lhbCcsICdpbWcvaWNvbnMvc2V0cy9zb2NpYWwtaWNvbnMuc3ZnJywgMjQpXHJcbiAqICAgICAgICAgLmRlZmF1bHRJY29uU2V0KCdpbWcvaWNvbnMvc2V0cy9jb3JlLWljb25zLnN2ZycsIDI0KTtcclxuICogICAgIH0pO1xyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqXHJcbiAqIFdoZW4gdXNpbmcgRm9udCBJY29ucyB3aXRoIGNsYXNzbmFtZXM6XHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqXHJcbiAqICA8bWQtaWNvbiBtZC1mb250LWljb249XCJhbmRyb2lkXCIgYXJpYS1sYWJlbD1cImFuZHJvaWRcIiA+PC9tZC1pY29uPlxyXG4gKiAgPG1kLWljb24gY2xhc3M9XCJpY29uX2hvbWVcIiAgICAgIGFyaWEtbGFiZWw9XCJIb21lXCIgICAgPjwvbWQtaWNvbj5cclxuICpcclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiBXaGVuIHVzaW5nIE1hdGVyaWFsIEZvbnQgSWNvbnMgd2l0aCBsaWdhdHVyZXM6XHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqICA8IS0tIEZvciBNYXRlcmlhbCBEZXNpZ24gSWNvbnMgLS0+XHJcbiAqICA8IS0tIFRoZSBjbGFzcyAnLm1hdGVyaWFsLWljb25zJyBpcyBhdXRvLWFkZGVkIGlmIGEgc3R5bGUgaGFzIE5PVCBiZWVuIHNwZWNpZmllZCAtLT5cclxuICogIDxtZC1pY29uPiBmYWNlIDwvbWQtaWNvbj5cclxuICogIDxtZC1pY29uIG1kLWZvbnQtc2V0PVwibWF0ZXJpYWwtaWNvbnNcIj4gZmFjZSA8L21kLWljb24+XHJcbiAqICA8bWQtaWNvbj4gI3hFODdDOyA8L21kLWljb24+XHJcbiAqICA8IS0tIFRoZSBjbGFzcyAnLm1hdGVyaWFsLWljb25zJyBtdXN0IGJlIG1hbnVhbGx5IGFkZGVkIGlmIG90aGVyIHN0eWxlcyBhcmUgYWxzbyBzcGVjaWZpZWQtLT5cclxuICogIDxtZC1pY29uIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnMgbWQtbGlnaHQgbWQtNDhcIj4gZmFjZSA8L21kLWljb24+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICogV2hlbiB1c2luZyBvdGhlciBGb250LUljb24gbGlicmFyaWVzOlxyXG4gKlxyXG4gKiA8aGxqcyBsYW5nPVwianNcIj5cclxuICogIC8vIFNwZWNpZnkgYSBmb250LWljb24gc3R5bGUgYWxpYXNcclxuICogIGFuZ3VsYXIuY29uZmlnKGZ1bmN0aW9uKCRtZEljb25Qcm92aWRlcikge1xyXG4gKiAgICAkbWRJY29uUHJvdmlkZXIuZm9udFNldCgnZmEnLCAnZm9udGF3ZXNvbWUnKTtcclxuICogIH0pO1xyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqICA8bWQtaWNvbiBtZC1mb250LXNldD1cImZhXCI+ZW1haWw8L21kLWljb24+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICovXHJcbmZ1bmN0aW9uIG1kSWNvbkRpcmVjdGl2ZSgkbWRJY29uLCAkbWRUaGVtaW5nLCAkbWRBcmlhLCAkaW50ZXJwb2xhdGUgKSB7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBzY29wZToge1xyXG4gICAgICBmb250U2V0IDogJ0BtZEZvbnRTZXQnLFxyXG4gICAgICBmb250SWNvbjogJ0BtZEZvbnRJY29uJyxcclxuICAgICAgc3ZnSWNvbiA6ICdAbWRTdmdJY29uJyxcclxuICAgICAgc3ZnU3JjICA6ICdAbWRTdmdTcmMnXHJcbiAgICB9LFxyXG4gICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgIGxpbmsgOiBwb3N0TGlua1xyXG4gIH07XHJcblxyXG5cclxuICAvKipcclxuICAgKiBEaXJlY3RpdmUgcG9zdExpbmtcclxuICAgKiBTdXBwb3J0cyBlbWJlZGRlZCBTVkdzLCBmb250LWljb25zLCAmIGV4dGVybmFsIFNWR3NcclxuICAgKi9cclxuICBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0cikge1xyXG4gICAgJG1kVGhlbWluZyhlbGVtZW50KTtcclxuXHJcbiAgICBwcmVwYXJlRm9yRm9udEljb24oKTtcclxuXHJcbiAgICAvLyBJZiB1c2luZyBhIGZvbnQtaWNvbiwgdGhlbiB0aGUgdGV4dHVhbCBuYW1lIG9mIHRoZSBpY29uIGl0c2VsZlxyXG4gICAgLy8gcHJvdmlkZXMgdGhlIGFyaWEtbGFiZWwuXHJcblxyXG4gICAgdmFyIGxhYmVsID0gYXR0ci5hbHQgfHwgc2NvcGUuZm9udEljb24gfHwgc2NvcGUuc3ZnSWNvbiB8fCBlbGVtZW50LnRleHQoKTtcclxuICAgIHZhciBhdHRyTmFtZSA9IGF0dHIuJG5vcm1hbGl6ZShhdHRyLiRhdHRyLm1kU3ZnSWNvbiB8fCBhdHRyLiRhdHRyLm1kU3ZnU3JjIHx8ICcnKTtcclxuXHJcbiAgICBpZiAoICFhdHRyWydhcmlhLWxhYmVsJ10gKSB7XHJcblxyXG4gICAgICBpZiAobGFiZWwgIT0gJycgJiYgIXBhcmVudHNIYXZlVGV4dCgpICkge1xyXG5cclxuICAgICAgICAkbWRBcmlhLmV4cGVjdChlbGVtZW50LCAnYXJpYS1sYWJlbCcsIGxhYmVsKTtcclxuICAgICAgICAkbWRBcmlhLmV4cGVjdChlbGVtZW50LCAncm9sZScsICdpbWcnKTtcclxuXHJcbiAgICAgIH0gZWxzZSBpZiAoICFlbGVtZW50LnRleHQoKSApIHtcclxuICAgICAgICAvLyBJZiBub3QgYSBmb250LWljb24gd2l0aCBsaWdhdHVyZSwgdGhlblxyXG4gICAgICAgIC8vIGhpZGUgZnJvbSB0aGUgYWNjZXNzaWJpbGl0eSBsYXllci5cclxuXHJcbiAgICAgICAgJG1kQXJpYS5leHBlY3QoZWxlbWVudCwgJ2FyaWEtaGlkZGVuJywgJ3RydWUnKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChhdHRyTmFtZSkge1xyXG4gICAgICAvLyBVc2UgZWl0aGVyIHByZS1jb25maWd1cmVkIFNWRyBvciBVUkwgc291cmNlLCByZXNwZWN0aXZlbHkuXHJcbiAgICAgIGF0dHIuJG9ic2VydmUoYXR0ck5hbWUsIGZ1bmN0aW9uKGF0dHJWYWwpIHtcclxuXHJcbiAgICAgICAgZWxlbWVudC5lbXB0eSgpO1xyXG4gICAgICAgIGlmIChhdHRyVmFsKSB7XHJcbiAgICAgICAgICAkbWRJY29uKGF0dHJWYWwpLnRoZW4oZnVuY3Rpb24oc3ZnKSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kKHN2Zyk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBwYXJlbnRzSGF2ZVRleHQoKSB7XHJcbiAgICAgIHZhciBwYXJlbnQgPSBlbGVtZW50LnBhcmVudCgpO1xyXG4gICAgICBpZiAocGFyZW50LmF0dHIoJ2FyaWEtbGFiZWwnKSB8fCBwYXJlbnQudGV4dCgpKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZihwYXJlbnQucGFyZW50KCkuYXR0cignYXJpYS1sYWJlbCcpIHx8IHBhcmVudC5wYXJlbnQoKS50ZXh0KCkpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcHJlcGFyZUZvckZvbnRJY29uICgpIHtcclxuICAgICAgaWYgKCFzY29wZS5zdmdJY29uICYmICFzY29wZS5zdmdTcmMpIHtcclxuXHJcbiAgICAgICAgaWYgKHNjb3BlLmZvbnRJY29uKSB7XHJcbiAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdtZC1mb250Jyk7XHJcbiAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKHNjb3BlLmZvbnRJY29uKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChzY29wZS5mb250U2V0KSB7XHJcbiAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKCRtZEljb24uZm9udFNldChzY29wZS5mb250U2V0KSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBGb3IgTWF0ZXJpYWwgRGVzaWduIGZvbnQgaWNvbnMsIHRoZSBjbGFzcyAnLm1hdGVyaWFsLWljb25zJ1xyXG4gICAgICAgIC8vIGlzIGF1dG8tYWRkZWQgSUYgYSBzdHlsZSBoYXMgbm90IGJlZW4gc3BlY2lmaWVkXHJcblxyXG4gICAgICAgIGlmICghc2NvcGUuZm9udEljb24gJiYgIXNjb3BlLmZvbnRTZXQgJiYgIWFuZ3VsYXIuaXNEZWZpbmVkKGF0dHIuY2xhc3MpKSB7XHJcblxyXG4gICAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdtYXRlcmlhbC1pY29ucycpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgIH1cclxuICB9XHJcbn1cclxubWRJY29uRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkbWRJY29uXCIsIFwiJG1kVGhlbWluZ1wiLCBcIiRtZEFyaWFcIiwgXCIkaW50ZXJwb2xhdGVcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gIGFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuaWNvbicgKVxyXG4gICAgLnByb3ZpZGVyKCckbWRJY29uJywgTWRJY29uUHJvdmlkZXIpO1xyXG5cclxuICAvKipcclxuICAgICogQG5nZG9jIHNlcnZpY2VcclxuICAgICogQG5hbWUgJG1kSWNvblByb3ZpZGVyXHJcbiAgICAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5pY29uXHJcbiAgICAqXHJcbiAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgKiBgJG1kSWNvblByb3ZpZGVyYCBpcyB1c2VkIG9ubHkgdG8gcmVnaXN0ZXIgaWNvbiBJRHMgd2l0aCBVUkxzLiBUaGVzZSBjb25maWd1cmF0aW9uIGZlYXR1cmVzIGFsbG93XHJcbiAgICAqIGljb25zIGFuZCBpY29uIHNldHMgdG8gYmUgcHJlLXJlZ2lzdGVyZWQgYW5kIGFzc29jaWF0ZWQgd2l0aCBzb3VyY2UgVVJMcyAqKmJlZm9yZSoqIHRoZSBgPG1kLWljb24gLz5gXHJcbiAgICAqIGRpcmVjdGl2ZXMgYXJlIGNvbXBpbGVkLlxyXG4gICAgKlxyXG4gICAgKiBJZiB1c2luZyBmb250LWljb25zLCB0aGUgZGV2ZWxvcGVyIGlzIHJlcHNvbnNpYmxlIGZvciBsb2FkaW5nIHRoZSBmb250cy5cclxuICAgICpcclxuICAgICogSWYgdXNpbmcgU1ZHcywgbG9hZGluZyBvZiB0aGUgYWN0dWFsIHN2ZyBmaWxlcyBhcmUgZGVmZXJyZWQgdG8gb24tZGVtYW5kIHJlcXVlc3RzIGFuZCBhcmUgbG9hZGVkXHJcbiAgICAqIGludGVybmFsbHkgYnkgdGhlIGAkbWRJY29uYCBzZXJ2aWNlIHVzaW5nIHRoZSBgJGh0dHBgIHNlcnZpY2UuIFdoZW4gYW4gU1ZHIGlzIHJlcXVlc3RlZCBieSBuYW1lL0lELFxyXG4gICAgKiB0aGUgYCRtZEljb25gIHNlcnZpY2Ugc2VhcmNoZXMgaXRzIHJlZ2lzdHJ5IGZvciB0aGUgYXNzb2NpYXRlZCBzb3VyY2UgVVJMO1xyXG4gICAgKiB0aGF0IFVSTCBpcyB1c2VkIHRvIG9uLWRlbWFuZCBsb2FkIGFuZCBwYXJzZSB0aGUgU1ZHIGR5bmFtaWNhbGx5LlxyXG4gICAgKlxyXG4gICAgKiBAdXNhZ2VcclxuICAgICogPGhsanMgbGFuZz1cImpzXCI+XHJcbiAgICAqICAgYXBwLmNvbmZpZyhmdW5jdGlvbigkbWRJY29uUHJvdmlkZXIpIHtcclxuICAgICpcclxuICAgICogICAgIC8vIENvbmZpZ3VyZSBVUkxzIGZvciBpY29ucyBzcGVjaWZpZWQgYnkgW3NldDpdaWQuXHJcbiAgICAqXHJcbiAgICAqICAgICAkbWRJY29uUHJvdmlkZXJcclxuICAgICogICAgICAgICAgLmRlZmF1bHRGb250U2V0KCAnZm9udGF3ZXNvbWUnIClcclxuICAgICogICAgICAgICAgLmRlZmF1bHRJY29uU2V0KCdteS9hcHAvaWNvbnMuc3ZnJykgICAgICAgLy8gUmVnaXN0ZXIgYSBkZWZhdWx0IHNldCBvZiBTVkcgaWNvbnNcclxuICAgICogICAgICAgICAgLmljb25TZXQoJ3NvY2lhbCcsICdteS9hcHAvc29jaWFsLnN2ZycpICAgLy8gUmVnaXN0ZXIgYSBuYW1lZCBpY29uIHNldCBvZiBTVkdzXHJcbiAgICAqICAgICAgICAgIC5pY29uKCdhbmRyb2lkJywgJ215L2FwcC9hbmRyb2lkLnN2ZycpICAgIC8vIFJlZ2lzdGVyIGEgc3BlY2lmaWMgaWNvbiAoYnkgbmFtZSlcclxuICAgICogICAgICAgICAgLmljb24oJ3dvcms6Y2hhaXInLCAnbXkvYXBwL2NoYWlyLnN2ZycpOyAgLy8gUmVnaXN0ZXIgaWNvbiBpbiBhIHNwZWNpZmljIHNldFxyXG4gICAgKiAgIH0pO1xyXG4gICAgKiA8L2hsanM+XHJcbiAgICAqXHJcbiAgICAqIFNWRyBpY29ucyBhbmQgaWNvbiBzZXRzIGNhbiBiZSBlYXNpbHkgcHJlLWxvYWRlZCBhbmQgY2FjaGVkIHVzaW5nIGVpdGhlciAoYSkgYSBidWlsZCBwcm9jZXNzIG9yIChiKSBhIHJ1bnRpbWVcclxuICAgICogKipzdGFydHVwKiogcHJvY2VzcyAoc2hvd24gYmVsb3cpOlxyXG4gICAgKlxyXG4gICAgKiA8aGxqcyBsYW5nPVwianNcIj5cclxuICAgICogICBhcHAuY29uZmlnKGZ1bmN0aW9uKCRtZEljb25Qcm92aWRlcikge1xyXG4gICAgKlxyXG4gICAgKiAgICAgLy8gUmVnaXN0ZXIgYSBkZWZhdWx0IHNldCBvZiBTVkcgaWNvbiBkZWZpbml0aW9uc1xyXG4gICAgKiAgICAgJG1kSWNvblByb3ZpZGVyLmRlZmF1bHRJY29uU2V0KCdteS9hcHAvaWNvbnMuc3ZnJylcclxuICAgICpcclxuICAgICogICB9KVxyXG4gICAgKiAgIC5ydW4oZnVuY3Rpb24oJGh0dHAsICR0ZW1wbGF0ZUNhY2hlKXtcclxuICAgICpcclxuICAgICogICAgIC8vIFByZS1mZXRjaCBpY29ucyBzb3VyY2VzIGJ5IFVSTCBhbmQgY2FjaGUgaW4gdGhlICR0ZW1wbGF0ZUNhY2hlLi4uXHJcbiAgICAqICAgICAvLyBzdWJzZXF1ZW50ICRodHRwIGNhbGxzIHdpbGwgbG9vayB0aGVyZSBmaXJzdC5cclxuICAgICpcclxuICAgICogICAgIHZhciB1cmxzID0gWyAnaW15L2FwcC9pY29ucy5zdmcnLCAnaW1nL2ljb25zL2FuZHJvaWQuc3ZnJ107XHJcbiAgICAqXHJcbiAgICAqICAgICBhbmd1bGFyLmZvckVhY2godXJscywgZnVuY3Rpb24odXJsKSB7XHJcbiAgICAqICAgICAgICRodHRwLmdldCh1cmwsIHtjYWNoZTogJHRlbXBsYXRlQ2FjaGV9KTtcclxuICAgICogICAgIH0pO1xyXG4gICAgKlxyXG4gICAgKiAgIH0pO1xyXG4gICAgKlxyXG4gICAgKiA8L2hsanM+XHJcbiAgICAqXHJcbiAgICAqIE5PVEU6IHRoZSBsb2FkZWQgU1ZHIGRhdGEgaXMgc3Vic2VxdWVudGx5IGNhY2hlZCBpbnRlcm5hbGx5IGZvciBmdXR1cmUgcmVxdWVzdHMuXHJcbiAgICAqXHJcbiAgICAqL1xyXG5cclxuICAgLyoqXHJcbiAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICogQG5hbWUgJG1kSWNvblByb3ZpZGVyI2ljb25cclxuICAgICpcclxuICAgICogQGRlc2NyaXB0aW9uXHJcbiAgICAqIFJlZ2lzdGVyIGEgc291cmNlIFVSTCBmb3IgYSBzcGVjaWZpYyBpY29uIG5hbWU7IHRoZSBuYW1lIG1heSBpbmNsdWRlIG9wdGlvbmFsICdpY29uIHNldCcgbmFtZSBwcmVmaXguXHJcbiAgICAqIFRoZXNlIGljb25zICB3aWxsIGxhdGVyIGJlIHJldHJpZXZlZCBmcm9tIHRoZSBjYWNoZSB1c2luZyBgJG1kSWNvbiggPGljb24gbmFtZT4gKWBcclxuICAgICpcclxuICAgICogQHBhcmFtIHtzdHJpbmd9IGlkIEljb24gbmFtZS9pZCB1c2VkIHRvIHJlZ2lzdGVyIHRoZSBpY29uXHJcbiAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgc3BlY2lmaWVzIHRoZSBleHRlcm5hbCBsb2NhdGlvbiBmb3IgdGhlIGRhdGEgZmlsZS4gVXNlZCBpbnRlcm5hbGx5IGJ5IGAkaHR0cGAgdG8gbG9hZCB0aGVcclxuICAgICogZGF0YSBvciBhcyBwYXJ0IG9mIHRoZSBsb29rdXAgaW4gYCR0ZW1wbGF0ZUNhY2hlYCBpZiBwcmUtbG9hZGluZyB3YXMgY29uZmlndXJlZC5cclxuICAgICogQHBhcmFtIHtudW1iZXI9fSB2aWV3Qm94U2l6ZSBTZXRzIHRoZSB3aWR0aCBhbmQgaGVpZ2h0IHRoZSBpY29uJ3Mgdmlld0JveC5cclxuICAgICogSXQgaXMgaWdub3JlZCBmb3IgaWNvbnMgd2l0aCBhbiBleGlzdGluZyB2aWV3Qm94LiBEZWZhdWx0IHNpemUgaXMgMjQuXHJcbiAgICAqXHJcbiAgICAqIEByZXR1cm5zIHtvYmp9IGFuIGAkbWRJY29uUHJvdmlkZXJgIHJlZmVyZW5jZTsgdXNlZCB0byBzdXBwb3J0IG1ldGhvZCBjYWxsIGNoYWlucyBmb3IgdGhlIEFQSVxyXG4gICAgKlxyXG4gICAgKiBAdXNhZ2VcclxuICAgICogPGhsanMgbGFuZz1cImpzXCI+XHJcbiAgICAqICAgYXBwLmNvbmZpZyhmdW5jdGlvbigkbWRJY29uUHJvdmlkZXIpIHtcclxuICAgICpcclxuICAgICogICAgIC8vIENvbmZpZ3VyZSBVUkxzIGZvciBpY29ucyBzcGVjaWZpZWQgYnkgW3NldDpdaWQuXHJcbiAgICAqXHJcbiAgICAqICAgICAkbWRJY29uUHJvdmlkZXJcclxuICAgICogICAgICAgICAgLmljb24oJ2FuZHJvaWQnLCAnbXkvYXBwL2FuZHJvaWQuc3ZnJykgICAgLy8gUmVnaXN0ZXIgYSBzcGVjaWZpYyBpY29uIChieSBuYW1lKVxyXG4gICAgKiAgICAgICAgICAuaWNvbignd29yazpjaGFpcicsICdteS9hcHAvY2hhaXIuc3ZnJyk7ICAvLyBSZWdpc3RlciBpY29uIGluIGEgc3BlY2lmaWMgc2V0XHJcbiAgICAqICAgfSk7XHJcbiAgICAqIDwvaGxqcz5cclxuICAgICpcclxuICAgICovXHJcbiAgIC8qKlxyXG4gICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAqIEBuYW1lICRtZEljb25Qcm92aWRlciNpY29uU2V0XHJcbiAgICAqXHJcbiAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgKiBSZWdpc3RlciBhIHNvdXJjZSBVUkwgZm9yIGEgJ25hbWVkJyBzZXQgb2YgaWNvbnM7IGdyb3VwIG9mIFNWRyBkZWZpbml0aW9ucyB3aGVyZSBlYWNoIGRlZmluaXRpb25cclxuICAgICogaGFzIGFuIGljb24gaWQuIEluZGl2aWR1YWwgaWNvbnMgY2FuIGJlIHN1YnNlcXVlbnRseSByZXRyaWV2ZWQgZnJvbSB0aGlzIGNhY2hlZCBzZXQgdXNpbmdcclxuICAgICogYCRtZEljb24oPGljb24gc2V0IG5hbWU+OjxpY29uIG5hbWU+KWBcclxuICAgICpcclxuICAgICogQHBhcmFtIHtzdHJpbmd9IGlkIEljb24gbmFtZS9pZCB1c2VkIHRvIHJlZ2lzdGVyIHRoZSBpY29uc2V0XHJcbiAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgc3BlY2lmaWVzIHRoZSBleHRlcm5hbCBsb2NhdGlvbiBmb3IgdGhlIGRhdGEgZmlsZS4gVXNlZCBpbnRlcm5hbGx5IGJ5IGAkaHR0cGAgdG8gbG9hZCB0aGVcclxuICAgICogZGF0YSBvciBhcyBwYXJ0IG9mIHRoZSBsb29rdXAgaW4gYCR0ZW1wbGF0ZUNhY2hlYCBpZiBwcmUtbG9hZGluZyB3YXMgY29uZmlndXJlZC5cclxuICAgICogQHBhcmFtIHtudW1iZXI9fSB2aWV3Qm94U2l6ZSBTZXRzIHRoZSB3aWR0aCBhbmQgaGVpZ2h0IG9mIHRoZSB2aWV3Qm94IG9mIGFsbCBpY29ucyBpbiB0aGUgc2V0LiBcclxuICAgICogSXQgaXMgaWdub3JlZCBmb3IgaWNvbnMgd2l0aCBhbiBleGlzdGluZyB2aWV3Qm94LiBBbGwgaWNvbnMgaW4gdGhlIGljb24gc2V0IHNob3VsZCBiZSB0aGUgc2FtZSBzaXplLlxyXG4gICAgKiBEZWZhdWx0IHZhbHVlIGlzIDI0LlxyXG4gICAgKlxyXG4gICAgKiBAcmV0dXJucyB7b2JqfSBhbiBgJG1kSWNvblByb3ZpZGVyYCByZWZlcmVuY2U7IHVzZWQgdG8gc3VwcG9ydCBtZXRob2QgY2FsbCBjaGFpbnMgZm9yIHRoZSBBUElcclxuICAgICpcclxuICAgICpcclxuICAgICogQHVzYWdlXHJcbiAgICAqIDxobGpzIGxhbmc9XCJqc1wiPlxyXG4gICAgKiAgIGFwcC5jb25maWcoZnVuY3Rpb24oJG1kSWNvblByb3ZpZGVyKSB7XHJcbiAgICAqXHJcbiAgICAqICAgICAvLyBDb25maWd1cmUgVVJMcyBmb3IgaWNvbnMgc3BlY2lmaWVkIGJ5IFtzZXQ6XWlkLlxyXG4gICAgKlxyXG4gICAgKiAgICAgJG1kSWNvblByb3ZpZGVyXHJcbiAgICAqICAgICAgICAgIC5pY29uU2V0KCdzb2NpYWwnLCAnbXkvYXBwL3NvY2lhbC5zdmcnKSAgIC8vIFJlZ2lzdGVyIGEgbmFtZWQgaWNvbiBzZXRcclxuICAgICogICB9KTtcclxuICAgICogPC9obGpzPlxyXG4gICAgKlxyXG4gICAgKi9cclxuICAgLyoqXHJcbiAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICogQG5hbWUgJG1kSWNvblByb3ZpZGVyI2RlZmF1bHRJY29uU2V0XHJcbiAgICAqXHJcbiAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgKiBSZWdpc3RlciBhIHNvdXJjZSBVUkwgZm9yIHRoZSBkZWZhdWx0ICduYW1lZCcgc2V0IG9mIGljb25zLiBVbmxlc3MgZXhwbGljaXRseSByZWdpc3RlcmVkLFxyXG4gICAgKiBzdWJzZXF1ZW50IGxvb2t1cHMgb2YgaWNvbnMgd2lsbCBmYWlsb3ZlciB0byBzZWFyY2ggdGhpcyAnZGVmYXVsdCcgaWNvbiBzZXQuXHJcbiAgICAqIEljb24gY2FuIGJlIHJldHJpZXZlZCBmcm9tIHRoaXMgY2FjaGVkLCBkZWZhdWx0IHNldCB1c2luZyBgJG1kSWNvbig8bmFtZT4pYFxyXG4gICAgKlxyXG4gICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIHNwZWNpZmllcyB0aGUgZXh0ZXJuYWwgbG9jYXRpb24gZm9yIHRoZSBkYXRhIGZpbGUuIFVzZWQgaW50ZXJuYWxseSBieSBgJGh0dHBgIHRvIGxvYWQgdGhlXHJcbiAgICAqIGRhdGEgb3IgYXMgcGFydCBvZiB0aGUgbG9va3VwIGluIGAkdGVtcGxhdGVDYWNoZWAgaWYgcHJlLWxvYWRpbmcgd2FzIGNvbmZpZ3VyZWQuXHJcbiAgICAqIEBwYXJhbSB7bnVtYmVyPX0gdmlld0JveFNpemUgU2V0cyB0aGUgd2lkdGggYW5kIGhlaWdodCBvZiB0aGUgdmlld0JveCBvZiBhbGwgaWNvbnMgaW4gdGhlIHNldC4gXHJcbiAgICAqIEl0IGlzIGlnbm9yZWQgZm9yIGljb25zIHdpdGggYW4gZXhpc3Rpbmcgdmlld0JveC4gQWxsIGljb25zIGluIHRoZSBpY29uIHNldCBzaG91bGQgYmUgdGhlIHNhbWUgc2l6ZS5cclxuICAgICogRGVmYXVsdCB2YWx1ZSBpcyAyNC5cclxuICAgICpcclxuICAgICogQHJldHVybnMge29ian0gYW4gYCRtZEljb25Qcm92aWRlcmAgcmVmZXJlbmNlOyB1c2VkIHRvIHN1cHBvcnQgbWV0aG9kIGNhbGwgY2hhaW5zIGZvciB0aGUgQVBJXHJcbiAgICAqXHJcbiAgICAqIEB1c2FnZVxyXG4gICAgKiA8aGxqcyBsYW5nPVwianNcIj5cclxuICAgICogICBhcHAuY29uZmlnKGZ1bmN0aW9uKCRtZEljb25Qcm92aWRlcikge1xyXG4gICAgKlxyXG4gICAgKiAgICAgLy8gQ29uZmlndXJlIFVSTHMgZm9yIGljb25zIHNwZWNpZmllZCBieSBbc2V0Ol1pZC5cclxuICAgICpcclxuICAgICogICAgICRtZEljb25Qcm92aWRlclxyXG4gICAgKiAgICAgICAgICAuZGVmYXVsdEljb25TZXQoICdteS9hcHAvc29jaWFsLnN2ZycgKSAgIC8vIFJlZ2lzdGVyIGEgZGVmYXVsdCBpY29uIHNldFxyXG4gICAgKiAgIH0pO1xyXG4gICAgKiA8L2hsanM+XHJcbiAgICAqXHJcbiAgICAqL1xyXG4gIC8qKlxyXG4gICAqIEBuZ2RvYyBtZXRob2RcclxuICAgKiBAbmFtZSAkbWRJY29uUHJvdmlkZXIjZGVmYXVsdEZvbnRTZXRcclxuICAgKlxyXG4gICAqIEBkZXNjcmlwdGlvblxyXG4gICAqIFdoZW4gdXNpbmcgRm9udC1JY29ucywgQW5ndWxhciBNYXRlcmlhbCBhc3N1bWVzIHRoZSB0aGUgTWF0ZXJpYWwgRGVzaWduIGljb25zIHdpbGwgYmUgdXNlZCBhbmQgYXV0b21hdGljYWxseVxyXG4gICAqIGNvbmZpZ3VyZXMgdGhlIGRlZmF1bHQgZm9udC1zZXQgPT0gJ21hdGVyaWFsLWljb25zJy4gTm90ZSB0aGF0IHRoZSBmb250LXNldCByZWZlcmVuY2VzIHRoZSBmb250LWljb24gbGlicmFyeVxyXG4gICAqIGNsYXNzIHN0eWxlIHRoYXQgc2hvdWxkIGJlIGFwcGxpZWQgdG8gdGhlIGA8bWQtaWNvbj5gLlxyXG4gICAqXHJcbiAgICogQ29uZmlndXJpbmcgdGhlIGRlZmF1bHQgbWVhbnMgdGhhdCB0aGUgYXR0cmlidXRlc1xyXG4gICAqIGBtZC1mb250LXNldD1cIm1hdGVyaWFsLWljb25zXCJgIG9yIGBjbGFzcz1cIm1hdGVyaWFsLWljb25zXCJgIGRvIG5vdCBuZWVkIHRvIGJlIGV4cGxpY2l0bHkgZGVjbGFyZWQgb24gdGhlXHJcbiAgICogYDxtZC1pY29uPmAgbWFya3VwLiBGb3IgZXhhbXBsZTpcclxuICAgKlxyXG4gICAqICBgPG1kLWljb24+IGZhY2UgPC9tZC1pY29uPmBcclxuICAgKiAgd2lsbCByZW5kZXIgYXNcclxuICAgKiAgYDxzcGFuIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnNcIj4gZmFjZSA8L3NwYW4+YCwgYW5kXHJcbiAgICpcclxuICAgKiAgYDxtZC1pY29uIG1kLWZvbnQtc2V0PVwiZmFcIj4gZmFjZSA8L21kLWljb24+YFxyXG4gICAqICB3aWxsIHJlbmRlciBhc1xyXG4gICAqICBgPHNwYW4gY2xhc3M9XCJmYVwiPiBmYWNlIDwvc3Bhbj5gXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBvZiB0aGUgZm9udC1saWJyYXJ5IHN0eWxlIHRoYXQgc2hvdWxkIGJlIGFwcGxpZWQgdG8gdGhlIG1kLWljb24gRE9NIGVsZW1lbnRcclxuICAgKlxyXG4gICAqIEB1c2FnZVxyXG4gICAqIDxobGpzIGxhbmc9XCJqc1wiPlxyXG4gICAqICAgYXBwLmNvbmZpZyhmdW5jdGlvbigkbWRJY29uUHJvdmlkZXIpIHtcclxuICAgKiAgICAgJG1kSWNvblByb3ZpZGVyLmRlZmF1bHRGb250U2V0KCAnZm9udGF3ZXNvbWUnICk7XHJcbiAgICogICB9KTtcclxuICAgKiA8L2hsanM+XHJcbiAgICpcclxuICAgKi9cclxuXHJcbiAgIC8qKlxyXG4gICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAqIEBuYW1lICRtZEljb25Qcm92aWRlciNkZWZhdWx0Vmlld0JveFNpemVcclxuICAgICpcclxuICAgICogQGRlc2NyaXB0aW9uXHJcbiAgICAqIFdoaWxlIGA8bWQtaWNvbiAvPmAgbWFya3VwIGNhbiBhbHNvIGJlIHN0eWxlIHdpdGggc2l6aW5nIENTUywgdGhpcyBtZXRob2QgY29uZmlndXJlc1xyXG4gICAgKiB0aGUgZGVmYXVsdCB3aWR0aCAqKmFuZCoqIGhlaWdodCB1c2VkIGZvciBhbGwgaWNvbnM7IHVubGVzcyBvdmVycmlkZGVuIGJ5IHNwZWNpZmljIENTUy5cclxuICAgICogVGhlIGRlZmF1bHQgc2l6aW5nIGlzICgyNHB4LCAyNHB4KS5cclxuICAgICogQHBhcmFtIHtudW1iZXI9fSB2aWV3Qm94U2l6ZSBTZXRzIHRoZSB3aWR0aCBhbmQgaGVpZ2h0IG9mIHRoZSB2aWV3Qm94IGZvciBhbiBpY29uIG9yIGFuIGljb24gc2V0LlxyXG4gICAgKiBBbGwgaWNvbnMgaW4gYSBzZXQgc2hvdWxkIGJlIHRoZSBzYW1lIHNpemUuIFRoZSBkZWZhdWx0IHZhbHVlIGlzIDI0LlxyXG4gICAgKlxyXG4gICAgKiBAcmV0dXJucyB7b2JqfSBhbiBgJG1kSWNvblByb3ZpZGVyYCByZWZlcmVuY2U7IHVzZWQgdG8gc3VwcG9ydCBtZXRob2QgY2FsbCBjaGFpbnMgZm9yIHRoZSBBUElcclxuICAgICpcclxuICAgICogQHVzYWdlXHJcbiAgICAqIDxobGpzIGxhbmc9XCJqc1wiPlxyXG4gICAgKiAgIGFwcC5jb25maWcoZnVuY3Rpb24oJG1kSWNvblByb3ZpZGVyKSB7XHJcbiAgICAqXHJcbiAgICAqICAgICAvLyBDb25maWd1cmUgVVJMcyBmb3IgaWNvbnMgc3BlY2lmaWVkIGJ5IFtzZXQ6XWlkLlxyXG4gICAgKlxyXG4gICAgKiAgICAgJG1kSWNvblByb3ZpZGVyXHJcbiAgICAqICAgICAgICAgIC5kZWZhdWx0Vmlld0JveFNpemUoMzYpICAgLy8gUmVnaXN0ZXIgYSBkZWZhdWx0IGljb24gc2l6ZSAod2lkdGggPT0gaGVpZ2h0KVxyXG4gICAgKiAgIH0pO1xyXG4gICAgKiA8L2hsanM+XHJcbiAgICAqXHJcbiAgICAqL1xyXG5cclxuIHZhciBjb25maWcgPSB7XHJcbiAgIGRlZmF1bHRWaWV3Qm94U2l6ZTogMjQsXHJcbiAgIGRlZmF1bHRGb250U2V0OiAnbWF0ZXJpYWwtaWNvbnMnLFxyXG4gICBmb250U2V0cyA6IFsgXVxyXG4gfTtcclxuXHJcbiBmdW5jdGlvbiBNZEljb25Qcm92aWRlcigpIHsgfVxyXG5cclxuIE1kSWNvblByb3ZpZGVyLnByb3RvdHlwZSA9IHtcclxuICAgaWNvbiA6IGZ1bmN0aW9uIChpZCwgdXJsLCB2aWV3Qm94U2l6ZSkge1xyXG4gICAgIGlmICggaWQuaW5kZXhPZignOicpID09IC0xICkgaWQgPSAnJGRlZmF1bHQ6JyArIGlkO1xyXG5cclxuICAgICBjb25maWdbaWRdID0gbmV3IENvbmZpZ3VyYXRpb25JdGVtKHVybCwgdmlld0JveFNpemUgKTtcclxuICAgICByZXR1cm4gdGhpcztcclxuICAgfSxcclxuXHJcbiAgIGljb25TZXQgOiBmdW5jdGlvbiAoaWQsIHVybCwgdmlld0JveFNpemUpIHtcclxuICAgICBjb25maWdbaWRdID0gbmV3IENvbmZpZ3VyYXRpb25JdGVtKHVybCwgdmlld0JveFNpemUgKTtcclxuICAgICByZXR1cm4gdGhpcztcclxuICAgfSxcclxuXHJcbiAgIGRlZmF1bHRJY29uU2V0IDogZnVuY3Rpb24gKHVybCwgdmlld0JveFNpemUpIHtcclxuICAgICB2YXIgc2V0TmFtZSA9ICckZGVmYXVsdCc7XHJcblxyXG4gICAgIGlmICggIWNvbmZpZ1tzZXROYW1lXSApIHtcclxuICAgICAgIGNvbmZpZ1tzZXROYW1lXSA9IG5ldyBDb25maWd1cmF0aW9uSXRlbSh1cmwsIHZpZXdCb3hTaXplICk7XHJcbiAgICAgfVxyXG5cclxuICAgICBjb25maWdbc2V0TmFtZV0udmlld0JveFNpemUgPSB2aWV3Qm94U2l6ZSB8fCBjb25maWcuZGVmYXVsdFZpZXdCb3hTaXplO1xyXG5cclxuICAgICByZXR1cm4gdGhpcztcclxuICAgfSxcclxuXHJcbiAgIGRlZmF1bHRWaWV3Qm94U2l6ZSA6IGZ1bmN0aW9uICh2aWV3Qm94U2l6ZSkge1xyXG4gICAgIGNvbmZpZy5kZWZhdWx0Vmlld0JveFNpemUgPSB2aWV3Qm94U2l6ZTtcclxuICAgICByZXR1cm4gdGhpcztcclxuICAgfSxcclxuICAgXHJcbiAgIC8qKlxyXG4gICAgKiBSZWdpc3RlciBhbiBhbGlhcyBuYW1lIGFzc29jaWF0ZWQgd2l0aCBhIGZvbnQtaWNvbiBsaWJyYXJ5IHN0eWxlIDtcclxuICAgICovXHJcbiAgIGZvbnRTZXQgOiBmdW5jdGlvbiBmb250U2V0KGFsaWFzLCBjbGFzc05hbWUpIHtcclxuICAgIGNvbmZpZy5mb250U2V0cy5wdXNoKHtcclxuICAgICAgYWxpYXMgOiBhbGlhcyxcclxuICAgICAgZm9udFNldCA6IGNsYXNzTmFtZSB8fCBhbGlhc1xyXG4gICAgfSk7XHJcbiAgIH0sXHJcblxyXG4gICAvKipcclxuICAgICogU3BlY2lmeSBhIGRlZmF1bHQgc3R5bGUgbmFtZSBhc3NvY2lhdGVkIHdpdGggYSBmb250LWljb24gbGlicmFyeVxyXG4gICAgKiBmYWxsYmFjayB0byBNYXRlcmlhbCBJY29ucy5cclxuICAgICpcclxuICAgICovXHJcbiAgIGRlZmF1bHRGb250U2V0IDogZnVuY3Rpb24gZGVmYXVsdEZvbnRTZXQoY2xhc3NOYW1lKSB7XHJcbiAgICBjb25maWcuZGVmYXVsdEZvbnRTZXQgPSAhY2xhc3NOYW1lID8gJycgOiBjbGFzc05hbWU7XHJcbiAgICByZXR1cm4gdGhpcztcclxuICAgfSxcclxuXHJcbiAgIGRlZmF1bHRJY29uU2l6ZSA6IGZ1bmN0aW9uIGRlZmF1bHRJY29uU2l6ZShpY29uU2l6ZSkge1xyXG4gICAgIGNvbmZpZy5kZWZhdWx0SWNvblNpemUgPSBpY29uU2l6ZTtcclxuICAgICByZXR1cm4gdGhpcztcclxuICAgfSxcclxuXHJcbiAgIHByZWxvYWRJY29uczogZnVuY3Rpb24gKCR0ZW1wbGF0ZUNhY2hlKSB7XHJcbiAgICAgdmFyIGljb25Qcm92aWRlciA9IHRoaXM7XHJcbiAgICAgdmFyIHN2Z1JlZ2lzdHJ5ID0gW1xyXG4gICAgICAge1xyXG4gICAgICAgICBpZCA6ICdtZC10YWJzLWFycm93JyxcclxuICAgICAgICAgdXJsOiAnbWQtdGFicy1hcnJvdy5zdmcnLFxyXG4gICAgICAgICBzdmc6ICc8c3ZnIHZlcnNpb249XCIxLjFcIiB4PVwiMHB4XCIgeT1cIjBweFwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIj48Zz48cG9seWdvbiBwb2ludHM9XCIxNS40LDcuNCAxNCw2IDgsMTIgMTQsMTggMTUuNCwxNi42IDEwLjgsMTIgXCIvPjwvZz48L3N2Zz4nXHJcbiAgICAgICB9LFxyXG4gICAgICAge1xyXG4gICAgICAgICBpZCA6ICdtZC1jbG9zZScsXHJcbiAgICAgICAgIHVybDogJ21kLWNsb3NlLnN2ZycsXHJcbiAgICAgICAgIHN2ZzogJzxzdmcgdmVyc2lvbj1cIjEuMVwiIHg9XCIwcHhcIiB5PVwiMHB4XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiPjxnPjxwYXRoIGQ9XCJNMTkgNi40MWwtMS40MS0xLjQxLTUuNTkgNS41OS01LjU5LTUuNTktMS40MSAxLjQxIDUuNTkgNS41OS01LjU5IDUuNTkgMS40MSAxLjQxIDUuNTktNS41OSA1LjU5IDUuNTkgMS40MS0xLjQxLTUuNTktNS41OXpcIi8+PC9nPjwvc3ZnPidcclxuICAgICAgIH0sXHJcbiAgICAgICB7XHJcbiAgICAgICAgIGlkOiAgJ21kLWNhbmNlbCcsXHJcbiAgICAgICAgIHVybDogJ21kLWNhbmNlbC5zdmcnLFxyXG4gICAgICAgICBzdmc6ICc8c3ZnIHZlcnNpb249XCIxLjFcIiB4PVwiMHB4XCIgeT1cIjBweFwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIj48Zz48cGF0aCBkPVwiTTEyIDJjLTUuNTMgMC0xMCA0LjQ3LTEwIDEwczQuNDcgMTAgMTAgMTAgMTAtNC40NyAxMC0xMC00LjQ3LTEwLTEwLTEwem01IDEzLjU5bC0xLjQxIDEuNDEtMy41OS0zLjU5LTMuNTkgMy41OS0xLjQxLTEuNDEgMy41OS0zLjU5LTMuNTktMy41OSAxLjQxLTEuNDEgMy41OSAzLjU5IDMuNTktMy41OSAxLjQxIDEuNDEtMy41OSAzLjU5IDMuNTkgMy41OXpcIi8+PC9nPjwvc3ZnPidcclxuICAgICAgIH0sXHJcbiAgICAgICB7XHJcbiAgICAgICAgIGlkOiAgJ21kLW1lbnUnLFxyXG4gICAgICAgICB1cmw6ICdtZC1tZW51LnN2ZycsXHJcbiAgICAgICAgIHN2ZzogJzxzdmcgdmVyc2lvbj1cIjEuMVwiIHg9XCIwcHhcIiB5PVwiMHB4XCIgdmlld0JveD1cIjAgMCAxMDAgMTAwXCI+PHBhdGggZD1cIk0gNTAgMCBMIDEwMCAxNCBMIDkyIDgwIEwgNTAgMTAwIEwgOCA4MCBMIDAgMTQgWlwiIGZpbGw9XCIjYjJiMmIyXCI+PC9wYXRoPjxwYXRoIGQ9XCJNIDUwIDUgTCA2IDE4IEwgMTMuNSA3NyBMIDUwIDk0IFpcIiBmaWxsPVwiI0U0MjkzOVwiPjwvcGF0aD48cGF0aCBkPVwiTSA1MCA1IEwgOTQgMTggTCA4Ni41IDc3IEwgNTAgOTQgWlwiIGZpbGw9XCIjQjcyODMzXCI+PC9wYXRoPjxwYXRoIGQ9XCJNIDUwIDcgTCA4MyA3NSBMIDcyIDc1IEwgNjUgNTkgTCA1MCA1OSBMIDUwIDUwIEwgNjEgNTAgTCA1MCAyNiBaXCIgZmlsbD1cIiNiMmIyYjJcIj48L3BhdGg+PHBhdGggZD1cIk0gNTAgNyBMIDE3IDc1IEwgMjggNzUgTCAzNSA1OSBMIDUwIDU5IEwgNTAgNTAgTCAzOSA1MCBMIDUwIDI2IFpcIiBmaWxsPVwiI2ZmZlwiPjwvcGF0aD48L3N2Zz4nXHJcbiAgICAgICB9LFxyXG4gICAgICAge1xyXG4gICAgICAgICBpZDogICdtZC10b2dnbGUtYXJyb3cnLFxyXG4gICAgICAgICB1cmw6ICdtZC10b2dnbGUtYXJyb3ctc3ZnJyxcclxuICAgICAgICAgc3ZnOiAnPHN2ZyB2ZXJzaW9uPVwiMS4xXCIgeD1cIjBweFwiIHk9XCIwcHhcIiB2aWV3Qm94PVwiMCAwIDQ4IDQ4XCI+PHBhdGggZD1cIk0yNCAxNmwtMTIgMTIgMi44MyAyLjgzIDkuMTctOS4xNyA5LjE3IDkuMTcgMi44My0yLjgzelwiLz48cGF0aCBkPVwiTTAgMGg0OHY0OGgtNDh6XCIgZmlsbD1cIm5vbmVcIi8+PC9zdmc+J1xyXG4gICAgICAgfVxyXG4gICAgIF07XHJcblxyXG4gICAgIHN2Z1JlZ2lzdHJ5LmZvckVhY2goZnVuY3Rpb24oYXNzZXQpe1xyXG4gICAgICAgaWNvblByb3ZpZGVyLmljb24oYXNzZXQuaWQsICBhc3NldC51cmwpO1xyXG4gICAgICAgJHRlbXBsYXRlQ2FjaGUucHV0KGFzc2V0LnVybCwgYXNzZXQuc3ZnKTtcclxuICAgICB9KTtcclxuXHJcbiAgIH0sXHJcblxyXG4gICAkZ2V0IDogWyckaHR0cCcsICckcScsICckbG9nJywgJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24oJGh0dHAsICRxLCAkbG9nLCAkdGVtcGxhdGVDYWNoZSkge1xyXG4gICAgIHRoaXMucHJlbG9hZEljb25zKCR0ZW1wbGF0ZUNhY2hlKTtcclxuICAgICByZXR1cm4gTWRJY29uU2VydmljZShjb25maWcsICRodHRwLCAkcSwgJGxvZywgJHRlbXBsYXRlQ2FjaGUpO1xyXG4gICB9XVxyXG4gfTtcclxuXHJcbiAgIC8qKlxyXG4gICAgKiAgQ29uZmlndXJhdGlvbiBpdGVtIHN0b3JlZCBpbiB0aGUgSWNvbiByZWdpc3RyeTsgdXNlZCBmb3IgbG9va3Vwc1xyXG4gICAgKiAgdG8gbG9hZCBpZiBub3QgYWxyZWFkeSBjYWNoZWQgaW4gdGhlIGBsb2FkZWRgIGNhY2hlXHJcbiAgICAqL1xyXG4gICBmdW5jdGlvbiBDb25maWd1cmF0aW9uSXRlbSh1cmwsIHZpZXdCb3hTaXplKSB7XHJcbiAgICAgdGhpcy51cmwgPSB1cmw7XHJcbiAgICAgdGhpcy52aWV3Qm94U2l6ZSA9IHZpZXdCb3hTaXplIHx8IGNvbmZpZy5kZWZhdWx0Vmlld0JveFNpemU7XHJcbiAgIH1cclxuXHJcbiAvKipcclxuICAqIEBuZ2RvYyBzZXJ2aWNlXHJcbiAgKiBAbmFtZSAkbWRJY29uXHJcbiAgKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuaWNvblxyXG4gICpcclxuICAqIEBkZXNjcmlwdGlvblxyXG4gICogVGhlIGAkbWRJY29uYCBzZXJ2aWNlIGlzIGEgZnVuY3Rpb24gdXNlZCB0byBsb29rdXAgU1ZHIGljb25zLlxyXG4gICpcclxuICAqIEBwYXJhbSB7c3RyaW5nfSBpZCBRdWVyeSB2YWx1ZSBmb3IgYSB1bmlxdWUgSWQgb3IgVVJMLiBJZiB0aGUgYXJndW1lbnQgaXMgYSBVUkwsIHRoZW4gdGhlIHNlcnZpY2Ugd2lsbCByZXRyaWV2ZSB0aGUgaWNvbiBlbGVtZW50XHJcbiAgKiBmcm9tIGl0cyBpbnRlcm5hbCBjYWNoZSBvciBsb2FkIHRoZSBpY29uIGFuZCBjYWNoZSBpdCBmaXJzdC4gSWYgdGhlIHZhbHVlIGlzIG5vdCBhIFVSTC10eXBlIHN0cmluZywgdGhlbiBhbiBJRCBsb29rdXAgaXNcclxuICAqIHBlcmZvcm1lZC4gVGhlIElkIG1heSBiZSBhIHVuaXF1ZSBpY29uIElEIG9yIG1heSBpbmNsdWRlIGFuIGljb25TZXQgSUQgcHJlZml4LlxyXG4gICpcclxuICAqIEZvciB0aGUgKippZCoqIHF1ZXJ5IHRvIHdvcmsgcHJvcGVybHksIHRoaXMgbWVhbnMgdGhhdCBhbGwgaWQtdG8tVVJMIG1hcHBpbmdzIG11c3QgaGF2ZSBiZWVuIHByZXZpb3VzbHkgY29uZmlndXJlZFxyXG4gICogdXNpbmcgdGhlIGAkbWRJY29uUHJvdmlkZXJgLlxyXG4gICpcclxuICAqIEByZXR1cm5zIHtvYmp9IENsb25lIG9mIHRoZSBpbml0aWFsIFNWRyBET00gZWxlbWVudDsgd2hpY2ggd2FzIGNyZWF0ZWQgZnJvbSB0aGUgU1ZHIG1hcmt1cCBpbiB0aGUgU1ZHIGRhdGEgZmlsZS5cclxuICAqXHJcbiAgKiBAdXNhZ2VcclxuICAqIDxobGpzIGxhbmc9XCJqc1wiPlxyXG4gICogZnVuY3Rpb24gU29tZURpcmVjdGl2ZSgkbWRJY29uKSB7XHJcbiAgKlxyXG4gICogICAvLyBTZWUgaWYgdGhlIGljb24gaGFzIGFscmVhZHkgYmVlbiBsb2FkZWQsIGlmIG5vdFxyXG4gICogICAvLyB0aGVuIGxvb2t1cCB0aGUgaWNvbiBmcm9tIHRoZSByZWdpc3RyeSBjYWNoZSwgbG9hZCBhbmQgY2FjaGVcclxuICAqICAgLy8gaXQgZm9yIGZ1dHVyZSByZXF1ZXN0cy5cclxuICAqICAgLy8gTk9URTogSUQgcXVlcmllcyByZXF1aXJlIGNvbmZpZ3VyYXRpb24gd2l0aCAkbWRJY29uUHJvdmlkZXJcclxuICAqXHJcbiAgKiAgICRtZEljb24oJ2FuZHJvaWQnKS50aGVuKGZ1bmN0aW9uKGljb25FbCkgICAgeyBlbGVtZW50LmFwcGVuZChpY29uRWwpOyB9KTtcclxuICAqICAgJG1kSWNvbignd29yazpjaGFpcicpLnRoZW4oZnVuY3Rpb24oaWNvbkVsKSB7IGVsZW1lbnQuYXBwZW5kKGljb25FbCk7IH0pO1xyXG4gICpcclxuICAqICAgLy8gTG9hZCBhbmQgY2FjaGUgdGhlIGV4dGVybmFsIFNWRyB1c2luZyBhIFVSTFxyXG4gICpcclxuICAqICAgJG1kSWNvbignaW1nL2ljb25zL2FuZHJvaWQuc3ZnJykudGhlbihmdW5jdGlvbihpY29uRWwpIHtcclxuICAqICAgICBlbGVtZW50LmFwcGVuZChpY29uRWwpO1xyXG4gICogICB9KTtcclxuICAqIH07XHJcbiAgKiA8L2hsanM+XHJcbiAgKlxyXG4gICogTk9URTogVGhlIGA8bWQtaWNvbiAvPiAgYCBkaXJlY3RpdmUgaW50ZXJuYWxseSB1c2VzIHRoZSBgJG1kSWNvbmAgc2VydmljZSB0byBxdWVyeSwgbG9hZGVkLCBhbmQgaW5zdGFudGlhdGVcclxuICAqIFNWRyBET00gZWxlbWVudHMuXHJcbiAgKi9cclxuIGZ1bmN0aW9uIE1kSWNvblNlcnZpY2UoY29uZmlnLCAkaHR0cCwgJHEsICRsb2csICR0ZW1wbGF0ZUNhY2hlKSB7XHJcbiAgIHZhciBpY29uQ2FjaGUgPSB7fTtcclxuICAgdmFyIHVybFJlZ2V4ID0gL1stYS16QS1aMC05QDolX1xcKy5+Iz8mLy89XXsyLDI1Nn1cXC5bYS16XXsyLDR9XFxiKFxcL1stYS16QS1aMC05QDolX1xcKy5+Iz8mLy89XSopPy9pO1xyXG5cclxuICAgSWNvbi5wcm90b3R5cGUgPSB7IGNsb25lIDogY2xvbmVTVkcsIHByZXBhcmU6IHByZXBhcmVBbmRTdHlsZSB9O1xyXG4gICBnZXRJY29uLmZvbnRTZXQgPSBmaW5kUmVnaXN0ZXJlZEZvbnRTZXQ7XHJcblxyXG4gICAvLyBQdWJsaXNoIHNlcnZpY2UuLi5cclxuICAgcmV0dXJuIGdldEljb247XHJcblxyXG4gICAvKipcclxuICAgICogQWN0dWFsICRtZEljb24gc2VydmljZSBpcyBlc3NlbnRpYWxseSBhIGxvb2t1cCBmdW5jdGlvblxyXG4gICAgKi9cclxuICAgZnVuY3Rpb24gZ2V0SWNvbihpZCkge1xyXG4gICAgIGlkID0gaWQgfHwgJyc7XHJcblxyXG4gICAgIC8vIElmIGFscmVhZHkgbG9hZGVkIGFuZCBjYWNoZWQsIHVzZSBhIGNsb25lIG9mIHRoZSBjYWNoZWQgaWNvbi5cclxuICAgICAvLyBPdGhlcndpc2UgZWl0aGVyIGxvYWQgYnkgVVJMLCBvciBsb29rdXAgaW4gdGhlIHJlZ2lzdHJ5IGFuZCB0aGVuIGxvYWQgYnkgVVJMLCBhbmQgY2FjaGUuXHJcblxyXG4gICAgIGlmICggaWNvbkNhY2hlW2lkXSAgICAgICAgICkgcmV0dXJuICRxLndoZW4oIGljb25DYWNoZVtpZF0uY2xvbmUoKSApO1xyXG4gICAgIGlmICggdXJsUmVnZXgudGVzdChpZCkgICAgICkgcmV0dXJuIGxvYWRCeVVSTChpZCkudGhlbiggY2FjaGVJY29uKGlkKSApO1xyXG4gICAgIGlmICggaWQuaW5kZXhPZignOicpID09IC0xICkgaWQgPSAnJGRlZmF1bHQ6JyArIGlkO1xyXG5cclxuICAgICByZXR1cm4gbG9hZEJ5SUQoaWQpXHJcbiAgICAgICAgIC5jYXRjaChsb2FkRnJvbUljb25TZXQpXHJcbiAgICAgICAgIC5jYXRjaChhbm5vdW5jZUlkTm90Rm91bmQpXHJcbiAgICAgICAgIC5jYXRjaChhbm5vdW5jZU5vdEZvdW5kKVxyXG4gICAgICAgICAudGhlbiggY2FjaGVJY29uKGlkKSApO1xyXG4gICB9XHJcblxyXG4gICAvKipcclxuICAgICogTG9va3VwIHJlZ2lzdGVyZWQgZm9udFNldCBzdHlsZSB1c2luZyBpdHMgYWxpYXMuLi5cclxuICAgICogSWYgbm90IGZvdW5kLFxyXG4gICAgKi9cclxuICAgZnVuY3Rpb24gZmluZFJlZ2lzdGVyZWRGb250U2V0KGFsaWFzKSB7XHJcbiAgICAgIHZhciB1c2VEZWZhdWx0ID0gYW5ndWxhci5pc1VuZGVmaW5lZChhbGlhcykgfHwgIShhbGlhcyAmJiBhbGlhcy5sZW5ndGgpO1xyXG4gICAgICBpZiAoIHVzZURlZmF1bHQgKSByZXR1cm4gY29uZmlnLmRlZmF1bHRGb250U2V0O1xyXG5cclxuICAgICAgdmFyIHJlc3VsdCA9IGFsaWFzO1xyXG4gICAgICBhbmd1bGFyLmZvckVhY2goY29uZmlnLmZvbnRTZXRzLCBmdW5jdGlvbihpdCl7XHJcbiAgICAgICAgaWYgKCBpdC5hbGlhcyA9PSBhbGlhcyApIHJlc3VsdCA9IGl0LmZvbnRTZXQgfHwgcmVzdWx0O1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgIH1cclxuXHJcbiAgIC8qKlxyXG4gICAgKiBQcmVwYXJlIGFuZCBjYWNoZSB0aGUgbG9hZGVkIGljb24gZm9yIHRoZSBzcGVjaWZpZWQgYGlkYFxyXG4gICAgKi9cclxuICAgZnVuY3Rpb24gY2FjaGVJY29uKCBpZCApIHtcclxuXHJcbiAgICAgcmV0dXJuIGZ1bmN0aW9uIHVwZGF0ZUNhY2hlKCBpY29uICkge1xyXG4gICAgICAgaWNvbkNhY2hlW2lkXSA9IGlzSWNvbihpY29uKSA/IGljb24gOiBuZXcgSWNvbihpY29uLCBjb25maWdbaWRdKTtcclxuXHJcbiAgICAgICByZXR1cm4gaWNvbkNhY2hlW2lkXS5jbG9uZSgpO1xyXG4gICAgIH07XHJcbiAgIH1cclxuXHJcbiAgIC8qKlxyXG4gICAgKiBMb29rdXAgdGhlIGNvbmZpZ3VyYXRpb24gaW4gdGhlIHJlZ2lzdHJ5LCBpZiAhcmVnaXN0ZXJlZCB0aHJvdyBhbiBlcnJvclxyXG4gICAgKiBvdGhlcndpc2UgbG9hZCB0aGUgaWNvbiBbb24tZGVtYW5kXSB1c2luZyB0aGUgcmVnaXN0ZXJlZCBVUkwuXHJcbiAgICAqXHJcbiAgICAqL1xyXG4gICBmdW5jdGlvbiBsb2FkQnlJRChpZCkge1xyXG4gICAgIHZhciBpY29uQ29uZmlnID0gY29uZmlnW2lkXTtcclxuXHJcbiAgICAgcmV0dXJuICFpY29uQ29uZmlnID8gJHEucmVqZWN0KGlkKSA6IGxvYWRCeVVSTChpY29uQ29uZmlnLnVybCkudGhlbihmdW5jdGlvbihpY29uKSB7XHJcbiAgICAgICByZXR1cm4gbmV3IEljb24oaWNvbiwgaWNvbkNvbmZpZyk7XHJcbiAgICAgfSk7XHJcbiAgIH1cclxuXHJcbiAgIC8qKlxyXG4gICAgKiAgICBMb2FkcyB0aGUgZmlsZSBhcyBYTUwgYW5kIHVzZXMgcXVlcnlTZWxlY3RvciggPGlkPiApIHRvIGZpbmRcclxuICAgICogICAgdGhlIGRlc2lyZWQgbm9kZS4uLlxyXG4gICAgKi9cclxuICAgZnVuY3Rpb24gbG9hZEZyb21JY29uU2V0KGlkKSB7XHJcbiAgICAgdmFyIHNldE5hbWUgPSBpZC5zdWJzdHJpbmcoMCwgaWQubGFzdEluZGV4T2YoJzonKSkgfHwgJyRkZWZhdWx0JztcclxuICAgICB2YXIgaWNvblNldENvbmZpZyA9IGNvbmZpZ1tzZXROYW1lXTtcclxuXHJcbiAgICAgcmV0dXJuICFpY29uU2V0Q29uZmlnID8gJHEucmVqZWN0KGlkKSA6IGxvYWRCeVVSTChpY29uU2V0Q29uZmlnLnVybCkudGhlbihleHRyYWN0RnJvbVNldCk7XHJcblxyXG4gICAgIGZ1bmN0aW9uIGV4dHJhY3RGcm9tU2V0KHNldCkge1xyXG4gICAgICAgdmFyIGljb25OYW1lID0gaWQuc2xpY2UoaWQubGFzdEluZGV4T2YoJzonKSArIDEpO1xyXG4gICAgICAgdmFyIGljb24gPSBzZXQucXVlcnlTZWxlY3RvcignIycgKyBpY29uTmFtZSk7XHJcbiAgICAgICByZXR1cm4gIWljb24gPyAkcS5yZWplY3QoaWQpIDogbmV3IEljb24oaWNvbiwgaWNvblNldENvbmZpZyk7XHJcbiAgICAgfVxyXG4gICB9XHJcblxyXG4gICAvKipcclxuICAgICogTG9hZCB0aGUgaWNvbiBieSBVUkwgKG1heSB1c2UgdGhlICR0ZW1wbGF0ZUNhY2hlKS5cclxuICAgICogRXh0cmFjdCB0aGUgZGF0YSBmb3IgbGF0ZXIgY29udmVyc2lvbiB0byBJY29uXHJcbiAgICAqL1xyXG4gICBmdW5jdGlvbiBsb2FkQnlVUkwodXJsKSB7XHJcbiAgICAgcmV0dXJuICRodHRwXHJcbiAgICAgICAuZ2V0KHVybCwgeyBjYWNoZTogJHRlbXBsYXRlQ2FjaGUgfSlcclxuICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgIHJldHVybiBhbmd1bGFyLmVsZW1lbnQoJzxkaXY+JykuYXBwZW5kKHJlc3BvbnNlLmRhdGEpLmZpbmQoJ3N2ZycpWzBdO1xyXG4gICAgICAgfSk7XHJcbiAgIH1cclxuXHJcbiAgIC8qKlxyXG4gICAgKiBVc2VyIGRpZCBub3Qgc3BlY2lmeSBhIFVSTCBhbmQgdGhlIElEIGhhcyBub3QgYmVlbiByZWdpc3RlcmVkIHdpdGggdGhlICRtZEljb25cclxuICAgICogcmVnaXN0cnlcclxuICAgICovXHJcbiAgIGZ1bmN0aW9uIGFubm91bmNlSWROb3RGb3VuZChpZCkge1xyXG4gICAgIHZhciBtc2c7XHJcblxyXG4gICAgIGlmIChhbmd1bGFyLmlzU3RyaW5nKGlkKSkge1xyXG4gICAgICAgbXNnID0gJ2ljb24gJyArIGlkICsgJyBub3QgZm91bmQnO1xyXG4gICAgICAgJGxvZy53YXJuKG1zZyk7XHJcbiAgICAgfVxyXG5cclxuICAgICByZXR1cm4gJHEucmVqZWN0KG1zZyB8fCBpZCk7XHJcbiAgIH1cclxuXHJcbiAgIC8qKlxyXG4gICAgKiBDYXRjaCBIVFRQIG9yIGdlbmVyaWMgZXJyb3JzIG5vdCByZWxhdGVkIHRvIGluY29ycmVjdCBpY29uIElEcy5cclxuICAgICovXHJcbiAgIGZ1bmN0aW9uIGFubm91bmNlTm90Rm91bmQoZXJyKSB7XHJcbiAgICAgdmFyIG1zZyA9IGFuZ3VsYXIuaXNTdHJpbmcoZXJyKSA/IGVyciA6IChlcnIubWVzc2FnZSB8fCBlcnIuZGF0YSB8fCBlcnIuc3RhdHVzVGV4dCk7XHJcbiAgICAgJGxvZy53YXJuKG1zZyk7XHJcblxyXG4gICAgIHJldHVybiAkcS5yZWplY3QobXNnKTtcclxuICAgfVxyXG5cclxuICAgLyoqXHJcbiAgICAqIENoZWNrIHRhcmdldCBzaWduYXR1cmUgdG8gc2VlIGlmIGl0IGlzIGFuIEljb24gaW5zdGFuY2UuXHJcbiAgICAqL1xyXG4gICBmdW5jdGlvbiBpc0ljb24odGFyZ2V0KSB7XHJcbiAgICAgcmV0dXJuIGFuZ3VsYXIuaXNEZWZpbmVkKHRhcmdldC5lbGVtZW50KSAmJiBhbmd1bGFyLmlzRGVmaW5lZCh0YXJnZXQuY29uZmlnKTtcclxuICAgfVxyXG5cclxuICAgLyoqXHJcbiAgICAqICBEZWZpbmUgdGhlIEljb24gY2xhc3NcclxuICAgICovXHJcbiAgIGZ1bmN0aW9uIEljb24oZWwsIGNvbmZpZykge1xyXG4gICAgIGlmIChlbC50YWdOYW1lICE9ICdzdmcnKSB7XHJcbiAgICAgICBlbCA9IGFuZ3VsYXIuZWxlbWVudCgnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+JykuYXBwZW5kKGVsKVswXTtcclxuICAgICB9XHJcblxyXG4gICAgIC8vIEluamVjdCB0aGUgbmFtZXNwYWNlIGlmIG5vdCBhdmFpbGFibGUuLi5cclxuICAgICBpZiAoICFlbC5nZXRBdHRyaWJ1dGUoJ3htbG5zJykgKSB7XHJcbiAgICAgICBlbC5zZXRBdHRyaWJ1dGUoJ3htbG5zJywgXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiKTtcclxuICAgICB9XHJcblxyXG4gICAgIHRoaXMuZWxlbWVudCA9IGVsO1xyXG4gICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xyXG4gICAgIHRoaXMucHJlcGFyZSgpO1xyXG4gICB9XHJcblxyXG4gICAvKipcclxuICAgICogIFByZXBhcmUgdGhlIERPTSBlbGVtZW50IHRoYXQgd2lsbCBiZSBjYWNoZWQgaW4gdGhlXHJcbiAgICAqICBsb2FkZWQgaWNvbkNhY2hlIHN0b3JlLlxyXG4gICAgKi9cclxuICAgZnVuY3Rpb24gcHJlcGFyZUFuZFN0eWxlKCkge1xyXG4gICAgIHZhciB2aWV3Qm94U2l6ZSA9IHRoaXMuY29uZmlnID8gdGhpcy5jb25maWcudmlld0JveFNpemUgOiBjb25maWcuZGVmYXVsdFZpZXdCb3hTaXplO1xyXG4gICAgICAgICBhbmd1bGFyLmZvckVhY2goe1xyXG4gICAgICAgICAgICdmaXQnICAgOiAnJyxcclxuICAgICAgICAgICAnaGVpZ2h0JzogJzEwMCUnLFxyXG4gICAgICAgICAgICd3aWR0aCcgOiAnMTAwJScsXHJcbiAgICAgICAgICAgJ3ByZXNlcnZlQXNwZWN0UmF0aW8nOiAneE1pZFlNaWQgbWVldCcsXHJcbiAgICAgICAgICAgJ3ZpZXdCb3gnIDogdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgndmlld0JveCcpIHx8ICgnMCAwICcgKyB2aWV3Qm94U2l6ZSArICcgJyArIHZpZXdCb3hTaXplKVxyXG4gICAgICAgICB9LCBmdW5jdGlvbih2YWwsIGF0dHIpIHtcclxuICAgICAgICAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKGF0dHIsIHZhbCk7XHJcbiAgICAgICAgIH0sIHRoaXMpO1xyXG5cclxuICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHtcclxuICAgICAgICAgICAncG9pbnRlci1ldmVudHMnIDogJ25vbmUnLFxyXG4gICAgICAgICAgICdkaXNwbGF5JyA6ICdibG9jaydcclxuICAgICAgICAgfSwgZnVuY3Rpb24odmFsLCBzdHlsZSkge1xyXG4gICAgICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZVtzdHlsZV0gPSB2YWw7XHJcbiAgICAgICAgIH0sIHRoaXMpO1xyXG4gICB9XHJcblxyXG4gICAvKipcclxuICAgICogQ2xvbmUgdGhlIEljb24gRE9NIGVsZW1lbnQuXHJcbiAgICAqL1xyXG4gICBmdW5jdGlvbiBjbG9uZVNWRygpe1xyXG4gICAgIHJldHVybiB0aGlzLmVsZW1lbnQuY2xvbmVOb2RlKHRydWUpO1xyXG4gICB9XHJcblxyXG4gfVxyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtb2R1bGVcclxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5pbnB1dFxyXG4gKi9cclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmlucHV0JywgW1xyXG4gICdtYXRlcmlhbC5jb3JlJ1xyXG5dKVxyXG4gIC5kaXJlY3RpdmUoJ21kSW5wdXRDb250YWluZXInLCBtZElucHV0Q29udGFpbmVyRGlyZWN0aXZlKVxyXG4gIC5kaXJlY3RpdmUoJ2xhYmVsJywgbGFiZWxEaXJlY3RpdmUpXHJcbiAgLmRpcmVjdGl2ZSgnaW5wdXQnLCBpbnB1dFRleHRhcmVhRGlyZWN0aXZlKVxyXG4gIC5kaXJlY3RpdmUoJ3RleHRhcmVhJywgaW5wdXRUZXh0YXJlYURpcmVjdGl2ZSlcclxuICAuZGlyZWN0aXZlKCdtZE1heGxlbmd0aCcsIG1kTWF4bGVuZ3RoRGlyZWN0aXZlKVxyXG4gIC5kaXJlY3RpdmUoJ3BsYWNlaG9sZGVyJywgcGxhY2Vob2xkZXJEaXJlY3RpdmUpO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRJbnB1dENvbnRhaW5lclxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuaW5wdXRcclxuICpcclxuICogQHJlc3RyaWN0IEVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIGA8bWQtaW5wdXQtY29udGFpbmVyPmAgaXMgdGhlIHBhcmVudCBvZiBhbnkgaW5wdXQgb3IgdGV4dGFyZWEgZWxlbWVudC5cclxuICpcclxuICogSW5wdXQgYW5kIHRleHRhcmVhIGVsZW1lbnRzIHdpbGwgbm90IGJlaGF2ZSBwcm9wZXJseSB1bmxlc3MgdGhlIG1kLWlucHV0LWNvbnRhaW5lclxyXG4gKiBwYXJlbnQgaXMgcHJvdmlkZWQuXHJcbiAqXHJcbiAqIEBwYXJhbSBtZC1pcy1lcnJvciB7ZXhwcmVzc2lvbj19IFdoZW4gdGhlIGdpdmVuIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIHRydWUsIHRoZSBpbnB1dCBjb250YWluZXIgd2lsbCBnbyBpbnRvIGVycm9yIHN0YXRlLiBEZWZhdWx0cyB0byBlcnJvcmluZyBpZiB0aGUgaW5wdXQgaGFzIGJlZW4gdG91Y2hlZCBhbmQgaXMgaW52YWxpZC5cclxuICogQHBhcmFtIG1kLW5vLWZsb2F0IHtib29sZWFuPX0gV2hlbiBwcmVzZW50LCBwbGFjZWhvbGRlcnMgd2lsbCBub3QgYmUgY29udmVydGVkIHRvIGZsb2F0aW5nIGxhYmVsc1xyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICpcclxuICogPG1kLWlucHV0LWNvbnRhaW5lcj5cclxuICogICA8bGFiZWw+VXNlcm5hbWU8L2xhYmVsPlxyXG4gKiAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5nLW1vZGVsPVwidXNlci5uYW1lXCI+XHJcbiAqIDwvbWQtaW5wdXQtY29udGFpbmVyPlxyXG4gKlxyXG4gKiA8bWQtaW5wdXQtY29udGFpbmVyPlxyXG4gKiAgIDxsYWJlbD5EZXNjcmlwdGlvbjwvbGFiZWw+XHJcbiAqICAgPHRleHRhcmVhIG5nLW1vZGVsPVwidXNlci5kZXNjcmlwdGlvblwiPjwvdGV4dGFyZWE+XHJcbiAqIDwvbWQtaW5wdXQtY29udGFpbmVyPlxyXG4gKlxyXG4gKiA8L2hsanM+XHJcbiAqL1xyXG5mdW5jdGlvbiBtZElucHV0Q29udGFpbmVyRGlyZWN0aXZlKCRtZFRoZW1pbmcsICRwYXJzZSkge1xyXG4gIENvbnRhaW5lckN0cmwuJGluamVjdCA9IFtcIiRzY29wZVwiLCBcIiRlbGVtZW50XCIsIFwiJGF0dHJzXCJdO1xyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgbGluazogcG9zdExpbmssXHJcbiAgICBjb250cm9sbGVyOiBDb250YWluZXJDdHJsXHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcclxuICAgICRtZFRoZW1pbmcoZWxlbWVudCk7XHJcbiAgfVxyXG4gIGZ1bmN0aW9uIENvbnRhaW5lckN0cmwoJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgc2VsZi5pc0Vycm9yR2V0dGVyID0gJGF0dHJzLm1kSXNFcnJvciAmJiAkcGFyc2UoJGF0dHJzLm1kSXNFcnJvcik7XHJcblxyXG4gICAgc2VsZi5kZWxlZ2F0ZUNsaWNrID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIHNlbGYuaW5wdXQuZm9jdXMoKTtcclxuICAgIH07XHJcbiAgICBzZWxmLmVsZW1lbnQgPSAkZWxlbWVudDtcclxuICAgIHNlbGYuc2V0Rm9jdXNlZCA9IGZ1bmN0aW9uKGlzRm9jdXNlZCkge1xyXG4gICAgICAkZWxlbWVudC50b2dnbGVDbGFzcygnbWQtaW5wdXQtZm9jdXNlZCcsICEhaXNGb2N1c2VkKTtcclxuICAgIH07XHJcbiAgICBzZWxmLnNldEhhc1ZhbHVlID0gZnVuY3Rpb24oaGFzVmFsdWUpIHtcclxuICAgICAgJGVsZW1lbnQudG9nZ2xlQ2xhc3MoJ21kLWlucHV0LWhhcy12YWx1ZScsICEhaGFzVmFsdWUpO1xyXG4gICAgfTtcclxuICAgIHNlbGYuc2V0SW52YWxpZCA9IGZ1bmN0aW9uKGlzSW52YWxpZCkge1xyXG4gICAgICAkZWxlbWVudC50b2dnbGVDbGFzcygnbWQtaW5wdXQtaW52YWxpZCcsICEhaXNJbnZhbGlkKTtcclxuICAgIH07XHJcbiAgICAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICByZXR1cm4gc2VsZi5sYWJlbCAmJiBzZWxmLmlucHV0O1xyXG4gICAgfSwgZnVuY3Rpb24oaGFzTGFiZWxBbmRJbnB1dCkge1xyXG4gICAgICBpZiAoaGFzTGFiZWxBbmRJbnB1dCAmJiAhc2VsZi5sYWJlbC5hdHRyKCdmb3InKSkge1xyXG4gICAgICAgIHNlbGYubGFiZWwuYXR0cignZm9yJywgc2VsZi5pbnB1dC5hdHRyKCdpZCcpKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbm1kSW5wdXRDb250YWluZXJEaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZFRoZW1pbmdcIiwgXCIkcGFyc2VcIl07XHJcblxyXG5mdW5jdGlvbiBsYWJlbERpcmVjdGl2ZSgpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgIHJlcXVpcmU6ICdeP21kSW5wdXRDb250YWluZXInLFxyXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGNvbnRhaW5lckN0cmwpIHtcclxuICAgICAgaWYgKCFjb250YWluZXJDdHJsIHx8IGF0dHIubWROb0Zsb2F0KSByZXR1cm47XHJcblxyXG4gICAgICBjb250YWluZXJDdHJsLmxhYmVsID0gZWxlbWVudDtcclxuICAgICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNvbnRhaW5lckN0cmwubGFiZWwgPSBudWxsO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9O1xyXG59XHJcblxyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbmFtZSBtZElucHV0XHJcbiAqIEByZXN0cmljdCBFXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5pbnB1dFxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogVXNlIHRoZSBgPGlucHV0PmAgb3IgdGhlICBgPHRleHRhcmVhPmAgYXMgYSBjaGlsZCBvZiBhbiBgPG1kLWlucHV0LWNvbnRhaW5lcj5gLlxyXG4gKlxyXG4gKiBAcGFyYW0ge251bWJlcj19IG1kLW1heGxlbmd0aCBUaGUgbWF4aW11bSBudW1iZXIgb2YgY2hhcmFjdGVycyBhbGxvd2VkIGluIHRoaXMgaW5wdXQuIElmIHRoaXMgaXMgc3BlY2lmaWVkLCBhIGNoYXJhY3RlciBjb3VudGVyIHdpbGwgYmUgc2hvd24gdW5kZXJuZWF0aCB0aGUgaW5wdXQuPGJyLz48YnIvPlxyXG4gKiBUaGUgcHVycG9zZSBvZiAqKmBtZC1tYXhsZW5ndGhgKiogaXMgZXhhY3RseSB0byBzaG93IHRoZSBtYXggbGVuZ3RoIGNvdW50ZXIgdGV4dC4gSWYgeW91IGRvbid0IHdhbnQgdGhlIGNvdW50ZXIgdGV4dCBhbmQgb25seSBuZWVkIFwicGxhaW5cIiB2YWxpZGF0aW9uLCB5b3UgY2FuIHVzZSB0aGUgXCJzaW1wbGVcIiBgbmctbWF4bGVuZ3RoYCBvciBtYXhsZW5ndGggYXR0cmlidXRlcy5cclxuICogQHBhcmFtIHtzdHJpbmc9fSBhcmlhLWxhYmVsIEFyaWEtbGFiZWwgaXMgcmVxdWlyZWQgd2hlbiBubyBsYWJlbCBpcyBwcmVzZW50LiAgQSB3YXJuaW5nIG1lc3NhZ2Ugd2lsbCBiZSBsb2dnZWQgaW4gdGhlIGNvbnNvbGUgaWYgbm90IHByZXNlbnQuXHJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gcGxhY2Vob2xkZXIgQW4gYWx0ZXJuYXRpdmUgYXBwcm9hY2ggdG8gdXNpbmcgYXJpYS1sYWJlbCB3aGVuIHRoZSBsYWJlbCBpcyBub3QgcHJlc2VudC4gIFRoZSBwbGFjZWhvbGRlciB0ZXh0IGlzIGNvcGllZCB0byB0aGUgYXJpYS1sYWJlbCBhdHRyaWJ1dGUuXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtaW5wdXQtY29udGFpbmVyPlxyXG4gKiAgIDxsYWJlbD5Db2xvcjwvbGFiZWw+XHJcbiAqICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmctbW9kZWw9XCJjb2xvclwiIHJlcXVpcmVkIG1kLW1heGxlbmd0aD1cIjEwXCI+XHJcbiAqIDwvbWQtaW5wdXQtY29udGFpbmVyPlxyXG4gKiA8L2hsanM+XHJcbiAqIDxoMz5XaXRoIEVycm9yczwvaDM+XHJcbiAqXHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqIDxmb3JtIG5hbWU9XCJ1c2VyRm9ybVwiPlxyXG4gKiAgIDxtZC1pbnB1dC1jb250YWluZXI+XHJcbiAqICAgICA8bGFiZWw+TGFzdCBOYW1lPC9sYWJlbD5cclxuICogICAgIDxpbnB1dCBuYW1lPVwibGFzdE5hbWVcIiBuZy1tb2RlbD1cImxhc3ROYW1lXCIgcmVxdWlyZWQgbWQtbWF4bGVuZ3RoPVwiMTBcIiBtaW5sZW5ndGg9XCI0XCI+XHJcbiAqICAgICA8ZGl2IG5nLW1lc3NhZ2VzPVwidXNlckZvcm0ubGFzdE5hbWUuJGVycm9yXCIgbmctc2hvdz1cInVzZXJGb3JtLmxhc3ROYW1lLiRkaXJ0eVwiPlxyXG4gKiAgICAgICA8ZGl2IG5nLW1lc3NhZ2U9XCJyZXF1aXJlZFwiPlRoaXMgaXMgcmVxdWlyZWQhPC9kaXY+XHJcbiAqICAgICAgIDxkaXYgbmctbWVzc2FnZT1cIm1kLW1heGxlbmd0aFwiPlRoYXQncyB0b28gbG9uZyE8L2Rpdj5cclxuICogICAgICAgPGRpdiBuZy1tZXNzYWdlPVwibWlubGVuZ3RoXCI+VGhhdCdzIHRvbyBzaG9ydCE8L2Rpdj5cclxuICogICAgIDwvZGl2PlxyXG4gKiAgIDwvbWQtaW5wdXQtY29udGFpbmVyPlxyXG4gKiAgIDxtZC1pbnB1dC1jb250YWluZXI+XHJcbiAqICAgICA8bGFiZWw+QmlvZ3JhcGh5PC9sYWJlbD5cclxuICogICAgIDx0ZXh0YXJlYSBuYW1lPVwiYmlvXCIgbmctbW9kZWw9XCJiaW9ncmFwaHlcIiByZXF1aXJlZCBtZC1tYXhsZW5ndGg9XCIxNTBcIj48L3RleHRhcmVhPlxyXG4gKiAgICAgPGRpdiBuZy1tZXNzYWdlcz1cInVzZXJGb3JtLmJpby4kZXJyb3JcIiBuZy1zaG93PVwidXNlckZvcm0uYmlvLiRkaXJ0eVwiPlxyXG4gKiAgICAgICA8ZGl2IG5nLW1lc3NhZ2U9XCJyZXF1aXJlZFwiPlRoaXMgaXMgcmVxdWlyZWQhPC9kaXY+XHJcbiAqICAgICAgIDxkaXYgbmctbWVzc2FnZT1cIm1kLW1heGxlbmd0aFwiPlRoYXQncyB0b28gbG9uZyE8L2Rpdj5cclxuICogICAgIDwvZGl2PlxyXG4gKiAgIDwvbWQtaW5wdXQtY29udGFpbmVyPlxyXG4gKiAgIDxtZC1pbnB1dC1jb250YWluZXI+XHJcbiAqICAgICA8aW5wdXQgYXJpYS1sYWJlbD0ndGl0bGUnIG5nLW1vZGVsPSd0aXRsZSc+XHJcbiAqICAgPC9tZC1pbnB1dC1jb250YWluZXI+XHJcbiAqICAgPG1kLWlucHV0LWNvbnRhaW5lcj5cclxuICogICAgIDxpbnB1dCBwbGFjZWhvbGRlcj0ndGl0bGUnIG5nLW1vZGVsPSd0aXRsZSc+XHJcbiAqICAgPC9tZC1pbnB1dC1jb250YWluZXI+XHJcbiAqIDwvZm9ybT5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiBSZXF1aXJlcyBbbmdNZXNzYWdlc10oaHR0cHM6Ly9kb2NzLmFuZ3VsYXJqcy5vcmcvYXBpL25nTWVzc2FnZXMpLlxyXG4gKiBCZWhhdmVzIGxpa2UgdGhlIFtBbmd1bGFySlMgaW5wdXQgZGlyZWN0aXZlXShodHRwczovL2RvY3MuYW5ndWxhcmpzLm9yZy9hcGkvbmcvZGlyZWN0aXZlL2lucHV0KS5cclxuICpcclxuICovXHJcblxyXG5mdW5jdGlvbiBpbnB1dFRleHRhcmVhRGlyZWN0aXZlKCRtZFV0aWwsICR3aW5kb3csICRtZEFyaWEpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgIHJlcXVpcmU6IFsnXj9tZElucHV0Q29udGFpbmVyJywgJz9uZ01vZGVsJ10sXHJcbiAgICBsaW5rOiBwb3N0TGlua1xyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJscykge1xyXG5cclxuICAgIHZhciBjb250YWluZXJDdHJsID0gY3RybHNbMF07XHJcbiAgICB2YXIgbmdNb2RlbEN0cmwgPSBjdHJsc1sxXSB8fCAkbWRVdGlsLmZha2VOZ01vZGVsKCk7XHJcbiAgICB2YXIgaXNSZWFkb25seSA9IGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHIucmVhZG9ubHkpO1xyXG5cclxuICAgIGlmICggIWNvbnRhaW5lckN0cmwgKSByZXR1cm47XHJcbiAgICBpZiAoY29udGFpbmVyQ3RybC5pbnB1dCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCI8bWQtaW5wdXQtY29udGFpbmVyPiBjYW4gb25seSBoYXZlICpvbmUqIDxpbnB1dD4gb3IgPHRleHRhcmVhPiBjaGlsZCBlbGVtZW50IVwiKTtcclxuICAgIH1cclxuICAgIGNvbnRhaW5lckN0cmwuaW5wdXQgPSBlbGVtZW50O1xyXG5cclxuICAgIGlmKCFjb250YWluZXJDdHJsLmxhYmVsKSB7XHJcbiAgICAgICRtZEFyaWEuZXhwZWN0KGVsZW1lbnQsICdhcmlhLWxhYmVsJywgZWxlbWVudC5hdHRyKCdwbGFjZWhvbGRlcicpKTtcclxuICAgIH1cclxuXHJcbiAgICBlbGVtZW50LmFkZENsYXNzKCdtZC1pbnB1dCcpO1xyXG4gICAgaWYgKCFlbGVtZW50LmF0dHIoJ2lkJykpIHtcclxuICAgICAgZWxlbWVudC5hdHRyKCdpZCcsICdpbnB1dF8nICsgJG1kVXRpbC5uZXh0VWlkKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChlbGVtZW50WzBdLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ3RleHRhcmVhJykge1xyXG4gICAgICBzZXR1cFRleHRhcmVhKCk7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGlzRXJyb3JHZXR0ZXIgPSBjb250YWluZXJDdHJsLmlzRXJyb3JHZXR0ZXIgfHwgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHJldHVybiBuZ01vZGVsQ3RybC4kaW52YWxpZCAmJiBuZ01vZGVsQ3RybC4kdG91Y2hlZDtcclxuICAgIH07XHJcbiAgICBzY29wZS4kd2F0Y2goaXNFcnJvckdldHRlciwgY29udGFpbmVyQ3RybC5zZXRJbnZhbGlkKTtcclxuXHJcbiAgICBuZ01vZGVsQ3RybC4kcGFyc2Vycy5wdXNoKG5nTW9kZWxQaXBlbGluZUNoZWNrVmFsdWUpO1xyXG4gICAgbmdNb2RlbEN0cmwuJGZvcm1hdHRlcnMucHVzaChuZ01vZGVsUGlwZWxpbmVDaGVja1ZhbHVlKTtcclxuXHJcbiAgICBlbGVtZW50Lm9uKCdpbnB1dCcsIGlucHV0Q2hlY2tWYWx1ZSk7XHJcblxyXG4gICAgaWYgKCFpc1JlYWRvbmx5KSB7XHJcbiAgICAgIGVsZW1lbnRcclxuICAgICAgICAub24oJ2ZvY3VzJywgZnVuY3Rpb24oZXYpIHtcclxuICAgICAgICAgIGNvbnRhaW5lckN0cmwuc2V0Rm9jdXNlZCh0cnVlKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5vbignYmx1cicsIGZ1bmN0aW9uKGV2KSB7XHJcbiAgICAgICAgICBjb250YWluZXJDdHJsLnNldEZvY3VzZWQoZmFsc2UpO1xyXG4gICAgICAgICAgaW5wdXRDaGVja1ZhbHVlKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vbmdNb2RlbEN0cmwuJHNldFRvdWNoZWQoKTtcclxuICAgIC8vaWYoIG5nTW9kZWxDdHJsLiRpbnZhbGlkICkgY29udGFpbmVyQ3RybC5zZXRJbnZhbGlkKCk7XHJcblxyXG4gICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICBjb250YWluZXJDdHJsLnNldEZvY3VzZWQoZmFsc2UpO1xyXG4gICAgICBjb250YWluZXJDdHJsLnNldEhhc1ZhbHVlKGZhbHNlKTtcclxuICAgICAgY29udGFpbmVyQ3RybC5pbnB1dCA9IG51bGw7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIG5nTW9kZWxQaXBlbGluZUNoZWNrVmFsdWUoYXJnKSB7XHJcbiAgICAgIGNvbnRhaW5lckN0cmwuc2V0SGFzVmFsdWUoIW5nTW9kZWxDdHJsLiRpc0VtcHR5KGFyZykpO1xyXG4gICAgICByZXR1cm4gYXJnO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gaW5wdXRDaGVja1ZhbHVlKCkge1xyXG4gICAgICAvLyBBbiBpbnB1dCdzIHZhbHVlIGNvdW50cyBpZiBpdHMgbGVuZ3RoID4gMCxcclxuICAgICAgLy8gb3IgaWYgdGhlIGlucHV0J3MgdmFsaWRpdHkgc3RhdGUgc2F5cyBpdCBoYXMgYmFkIGlucHV0IChlZyBzdHJpbmcgaW4gYSBudW1iZXIgaW5wdXQpXHJcbiAgICAgIGNvbnRhaW5lckN0cmwuc2V0SGFzVmFsdWUoZWxlbWVudC52YWwoKS5sZW5ndGggPiAwIHx8IChlbGVtZW50WzBdLnZhbGlkaXR5fHx7fSkuYmFkSW5wdXQpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNldHVwVGV4dGFyZWEoKSB7XHJcbiAgICAgIHZhciBub2RlID0gZWxlbWVudFswXTtcclxuICAgICAgdmFyIG9uQ2hhbmdlVGV4dGFyZWEgPSAkbWRVdGlsLmRlYm91bmNlKGdyb3dUZXh0YXJlYSwgMSk7XHJcblxyXG4gICAgICBmdW5jdGlvbiBwaXBlbGluZUxpc3RlbmVyKHZhbHVlKSB7XHJcbiAgICAgICAgb25DaGFuZ2VUZXh0YXJlYSgpO1xyXG4gICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKG5nTW9kZWxDdHJsKSB7XHJcbiAgICAgICAgbmdNb2RlbEN0cmwuJGZvcm1hdHRlcnMucHVzaChwaXBlbGluZUxpc3RlbmVyKTtcclxuICAgICAgICBuZ01vZGVsQ3RybC4kdmlld0NoYW5nZUxpc3RlbmVycy5wdXNoKHBpcGVsaW5lTGlzdGVuZXIpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIG9uQ2hhbmdlVGV4dGFyZWEoKTtcclxuICAgICAgfVxyXG4gICAgICBlbGVtZW50Lm9uKCdrZXlkb3duIGlucHV0Jywgb25DaGFuZ2VUZXh0YXJlYSk7XHJcbiAgICAgIGVsZW1lbnQub24oJ3Njcm9sbCcsIG9uU2Nyb2xsKTtcclxuICAgICAgYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpLm9uKCdyZXNpemUnLCBvbkNoYW5nZVRleHRhcmVhKTtcclxuXHJcbiAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdykub2ZmKCdyZXNpemUnLCBvbkNoYW5nZVRleHRhcmVhKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBmdW5jdGlvbiBncm93VGV4dGFyZWEoKSB7XHJcbiAgICAgICAgbm9kZS5zdHlsZS5oZWlnaHQgPSBcImF1dG9cIjtcclxuICAgICAgICBub2RlLnNjcm9sbFRvcCA9IDA7XHJcbiAgICAgICAgdmFyIGhlaWdodCA9IGdldEhlaWdodCgpO1xyXG4gICAgICAgIGlmIChoZWlnaHQpIG5vZGUuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgJ3B4JztcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gZ2V0SGVpZ2h0ICgpIHtcclxuICAgICAgICB2YXIgbGluZSA9IG5vZGUuc2Nyb2xsSGVpZ2h0IC0gbm9kZS5vZmZzZXRIZWlnaHQ7XHJcbiAgICAgICAgcmV0dXJuIG5vZGUub2Zmc2V0SGVpZ2h0ICsgKGxpbmUgPiAwID8gbGluZSA6IDApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBvblNjcm9sbChlKSB7XHJcbiAgICAgICAgbm9kZS5zY3JvbGxUb3AgPSAwO1xyXG4gICAgICAgIC8vIGZvciBzbW9vdGggbmV3IGxpbmUgYWRkaW5nXHJcbiAgICAgICAgdmFyIGxpbmUgPSBub2RlLnNjcm9sbEhlaWdodCAtIG5vZGUub2Zmc2V0SGVpZ2h0O1xyXG4gICAgICAgIHZhciBoZWlnaHQgPSBub2RlLm9mZnNldEhlaWdodCArIGxpbmU7XHJcbiAgICAgICAgbm9kZS5zdHlsZS5oZWlnaHQgPSBoZWlnaHQgKyAncHgnO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbmlucHV0VGV4dGFyZWFEaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZFV0aWxcIiwgXCIkd2luZG93XCIsIFwiJG1kQXJpYVwiXTtcclxuXHJcbmZ1bmN0aW9uIG1kTWF4bGVuZ3RoRGlyZWN0aXZlKCRhbmltYXRlKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICByZXF1aXJlOiBbJ25nTW9kZWwnLCAnXm1kSW5wdXRDb250YWluZXInXSxcclxuICAgIGxpbms6IHBvc3RMaW5rXHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmxzKSB7XHJcbiAgICB2YXIgbWF4bGVuZ3RoO1xyXG4gICAgdmFyIG5nTW9kZWxDdHJsID0gY3RybHNbMF07XHJcbiAgICB2YXIgY29udGFpbmVyQ3RybCA9IGN0cmxzWzFdO1xyXG4gICAgdmFyIGNoYXJDb3VudEVsID0gYW5ndWxhci5lbGVtZW50KCc8ZGl2IGNsYXNzPVwibWQtY2hhci1jb3VudGVyXCI+Jyk7XHJcblxyXG4gICAgLy8gU3RvcCBtb2RlbCBmcm9tIHRyaW1taW5nLiBUaGlzIG1ha2VzIGl0IHNvIHdoaXRlc3BhY2VcclxuICAgIC8vIG92ZXIgdGhlIG1heGxlbmd0aCBzdGlsbCBjb3VudHMgYXMgaW52YWxpZC5cclxuICAgIGF0dHIuJHNldCgnbmdUcmltJywgJ2ZhbHNlJyk7XHJcbiAgICBjb250YWluZXJDdHJsLmVsZW1lbnQuYXBwZW5kKGNoYXJDb3VudEVsKTtcclxuXHJcbiAgICBuZ01vZGVsQ3RybC4kZm9ybWF0dGVycy5wdXNoKHJlbmRlckNoYXJDb3VudCk7XHJcbiAgICBuZ01vZGVsQ3RybC4kdmlld0NoYW5nZUxpc3RlbmVycy5wdXNoKHJlbmRlckNoYXJDb3VudCk7XHJcbiAgICBlbGVtZW50Lm9uKCdpbnB1dCBrZXlkb3duJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHJlbmRlckNoYXJDb3VudCgpOyAvL21ha2Ugc3VyZSBpdCdzIGNhbGxlZCB3aXRoIG5vIGFyZ3NcclxuICAgIH0pO1xyXG5cclxuICAgIHNjb3BlLiR3YXRjaChhdHRyLm1kTWF4bGVuZ3RoLCBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICBtYXhsZW5ndGggPSB2YWx1ZTtcclxuICAgICAgaWYgKGFuZ3VsYXIuaXNOdW1iZXIodmFsdWUpICYmIHZhbHVlID4gMCkge1xyXG4gICAgICAgIGlmICghY2hhckNvdW50RWwucGFyZW50KCkubGVuZ3RoKSB7XHJcbiAgICAgICAgICAkYW5pbWF0ZS5lbnRlcihjaGFyQ291bnRFbCwgY29udGFpbmVyQ3RybC5lbGVtZW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGNvbnRhaW5lckN0cmwuZWxlbWVudFswXS5sYXN0RWxlbWVudENoaWxkKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJlbmRlckNoYXJDb3VudCgpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgICRhbmltYXRlLmxlYXZlKGNoYXJDb3VudEVsKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgbmdNb2RlbEN0cmwuJHZhbGlkYXRvcnNbJ21kLW1heGxlbmd0aCddID0gZnVuY3Rpb24obW9kZWxWYWx1ZSwgdmlld1ZhbHVlKSB7XHJcbiAgICAgIGlmICghYW5ndWxhci5pc051bWJlcihtYXhsZW5ndGgpIHx8IG1heGxlbmd0aCA8IDApIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gKCBtb2RlbFZhbHVlIHx8IGVsZW1lbnQudmFsKCkgfHwgdmlld1ZhbHVlIHx8ICcnICkubGVuZ3RoIDw9IG1heGxlbmd0aDtcclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gcmVuZGVyQ2hhckNvdW50KHZhbHVlKSB7XHJcbiAgICAgIGNoYXJDb3VudEVsLnRleHQoICggZWxlbWVudC52YWwoKSB8fCB2YWx1ZSB8fCAnJyApLmxlbmd0aCArICcvJyArIG1heGxlbmd0aCApO1xyXG4gICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbm1kTWF4bGVuZ3RoRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkYW5pbWF0ZVwiXTtcclxuXHJcbmZ1bmN0aW9uIHBsYWNlaG9sZGVyRGlyZWN0aXZlKCRsb2cpIHtcclxuICB2YXIgYmxhY2tMaXN0RWxlbWVudHMgPSBbJ01ELVNFTEVDVCddO1xyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgcmVxdWlyZTogJ15eP21kSW5wdXRDb250YWluZXInLFxyXG4gICAgcHJpb3JpdHk6IDIwMCxcclxuICAgIGxpbms6IHBvc3RMaW5rXHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGlucHV0Q29udGFpbmVyKSB7XHJcbiAgICBpZiAoIWlucHV0Q29udGFpbmVyKSByZXR1cm47XHJcbiAgICBpZiAoYmxhY2tMaXN0RWxlbWVudHMuaW5kZXhPZihlbGVtZW50WzBdLm5vZGVOYW1lKSAhPSAtMSkgcmV0dXJuO1xyXG4gICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKGlucHV0Q29udGFpbmVyLmVsZW1lbnQuYXR0cignbWQtbm8tZmxvYXQnKSkpIHJldHVybjtcclxuXHJcbiAgICB2YXIgcGxhY2Vob2xkZXJUZXh0ID0gYXR0ci5wbGFjZWhvbGRlcjtcclxuICAgIGVsZW1lbnQucmVtb3ZlQXR0cigncGxhY2Vob2xkZXInKTtcclxuXHJcbiAgICBpZiAoIGlucHV0Q29udGFpbmVyLmVsZW1lbnQuZmluZCgnbGFiZWwnKS5sZW5ndGggPT0gMCApIHtcclxuICAgICAgdmFyIHBsYWNlaG9sZGVyID0gJzxsYWJlbCBuZy1jbGljaz1cImRlbGVnYXRlQ2xpY2soKVwiPicgKyBwbGFjZWhvbGRlclRleHQgKyAnPC9sYWJlbD4nO1xyXG5cclxuICAgICAgaW5wdXRDb250YWluZXIuZWxlbWVudC5hZGRDbGFzcygnbWQtaWNvbi1mbG9hdCcpO1xyXG4gICAgICBpbnB1dENvbnRhaW5lci5lbGVtZW50LnByZXBlbmQocGxhY2Vob2xkZXIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgJGxvZy53YXJuKFwiVGhlIHBsYWNlaG9sZGVyPSdcIiArIHBsYWNlaG9sZGVyVGV4dCArIFwiJyB3aWxsIGJlIGlnbm9yZWQgc2luY2UgdGhpcyBtZC1pbnB1dC1jb250YWluZXIgaGFzIGEgY2hpbGQgbGFiZWwgZWxlbWVudC5cIik7XHJcbiAgICB9XHJcblxyXG4gIH1cclxufVxyXG5wbGFjZWhvbGRlckRpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJGxvZ1wiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbW9kdWxlXHJcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMubGlzdFxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogTGlzdCBtb2R1bGVcclxuICovXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmxpc3QnLCBbXHJcbiAgJ21hdGVyaWFsLmNvcmUnXHJcbl0pXHJcbiAgLmNvbnRyb2xsZXIoJ01kTGlzdENvbnRyb2xsZXInLCBNZExpc3RDb250cm9sbGVyKVxyXG4gIC5kaXJlY3RpdmUoJ21kTGlzdCcsIG1kTGlzdERpcmVjdGl2ZSlcclxuICAuZGlyZWN0aXZlKCdtZExpc3RJdGVtJywgbWRMaXN0SXRlbURpcmVjdGl2ZSk7XHJcblxyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbmFtZSBtZExpc3RcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmxpc3RcclxuICpcclxuICogQHJlc3RyaWN0IEVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIFRoZSBgPG1kLWxpc3Q+YCBkaXJlY3RpdmUgaXMgYSBsaXN0IGNvbnRhaW5lciBmb3IgMS4ubiBgPG1kLWxpc3QtaXRlbT5gIHRhZ3MuXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtbGlzdD5cclxuICogICA8bWQtbGlzdC1pdGVtIGNsYXNzPVwibWQtMi1saW5lXCIgbmctcmVwZWF0PVwiaXRlbSBpbiB0b2Rvc1wiPlxyXG4gKiAgICAgPG1kLWNoZWNrYm94IG5nLW1vZGVsPVwiaXRlbS5kb25lXCI+PC9tZC1jaGVja2JveD5cclxuICogICAgIDxkaXYgY2xhc3M9XCJtZC1saXN0LWl0ZW0tdGV4dFwiPlxyXG4gKiAgICAgICA8aDM+e3tpdGVtLnRpdGxlfX08L2gzPlxyXG4gKiAgICAgICA8cD57e2l0ZW0uZGVzY3JpcHRpb259fTwvcD5cclxuICogICAgIDwvZGl2PlxyXG4gKiAgIDwvbWQtbGlzdC1pdGVtPlxyXG4gKiA8L21kLWxpc3Q+XHJcbiAqIDwvaGxqcz5cclxuICovXHJcblxyXG5mdW5jdGlvbiBtZExpc3REaXJlY3RpdmUoJG1kVGhlbWluZykge1xyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgY29tcGlsZTogZnVuY3Rpb24odEVsKSB7XHJcbiAgICAgIHRFbFswXS5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnbGlzdCcpO1xyXG4gICAgICByZXR1cm4gJG1kVGhlbWluZztcclxuICAgIH1cclxuICB9O1xyXG59XHJcbm1kTGlzdERpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kVGhlbWluZ1wiXTtcclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRMaXN0SXRlbVxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMubGlzdFxyXG4gKlxyXG4gKiBAcmVzdHJpY3QgRVxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogVGhlIGA8bWQtbGlzdC1pdGVtPmAgZGlyZWN0aXZlIGlzIGEgY29udGFpbmVyIGludGVuZGVkIGZvciByb3cgaXRlbXMgaW4gYSBgPG1kLWxpc3Q+YCBjb250YWluZXIuXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiAgPG1kLWxpc3Q+XHJcbiAqICAgIDxtZC1saXN0LWl0ZW0+XHJcbiAqICAgICAgICAgICAgSXRlbSBjb250ZW50IGluIGxpc3RcclxuICogICAgPC9tZC1saXN0LWl0ZW0+XHJcbiAqICA8L21kLWxpc3Q+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICovXHJcbmZ1bmN0aW9uIG1kTGlzdEl0ZW1EaXJlY3RpdmUoJG1kQXJpYSwgJG1kQ29uc3RhbnQsICR0aW1lb3V0KSB7XHJcbiAgdmFyIHByb3hpZWRUeXBlcyA9IFsnbWQtY2hlY2tib3gnLCAnbWQtc3dpdGNoJ107XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICBjb250cm9sbGVyOiAnTWRMaXN0Q29udHJvbGxlcicsXHJcbiAgICBjb21waWxlOiBmdW5jdGlvbih0RWwsIHRBdHRycykge1xyXG4gICAgICAvLyBDaGVjayBmb3IgcHJveHkgY29udHJvbHMgKG5vIG5nLWNsaWNrIG9uIHBhcmVudCwgYW5kIGEgY29udHJvbCBpbnNpZGUpXHJcbiAgICAgIHZhciBzZWNvbmRhcnlJdGVtID0gdEVsWzBdLnF1ZXJ5U2VsZWN0b3IoJy5tZC1zZWNvbmRhcnknKTtcclxuICAgICAgdmFyIGhhc1Byb3hpZWRFbGVtZW50O1xyXG4gICAgICB2YXIgcHJveHlFbGVtZW50O1xyXG5cclxuICAgICAgdEVsWzBdLnNldEF0dHJpYnV0ZSgncm9sZScsICdsaXN0aXRlbScpO1xyXG5cclxuICAgICAgaWYgKCF0QXR0cnMubmdDbGljaykge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCB0eXBlOyB0eXBlID0gcHJveGllZFR5cGVzW2ldOyArK2kpIHtcclxuICAgICAgICAgIGlmIChwcm94eUVsZW1lbnQgPSB0RWxbMF0ucXVlcnlTZWxlY3Rvcih0eXBlKSkge1xyXG4gICAgICAgICAgICBoYXNQcm94aWVkRWxlbWVudCA9IHRydWU7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaGFzUHJveGllZEVsZW1lbnQpIHtcclxuICAgICAgICAgIHdyYXBJbignZGl2Jyk7XHJcbiAgICAgICAgfSBlbHNlIGlmICghdEVsWzBdLnF1ZXJ5U2VsZWN0b3IoJ21kLWJ1dHRvbicpKSB7XHJcbiAgICAgICAgICB0RWwuYWRkQ2xhc3MoJ21kLW5vLXByb3h5Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHdyYXBJbignYnV0dG9uJyk7XHJcbiAgICAgIH1cclxuICAgICAgc2V0dXBUb2dnbGVBcmlhKCk7XHJcblxyXG5cclxuICAgICAgZnVuY3Rpb24gc2V0dXBUb2dnbGVBcmlhKCkge1xyXG4gICAgICAgIHZhciB0b2dnbGVUeXBlcyA9IFsnbWQtc3dpdGNoJywgJ21kLWNoZWNrYm94J107XHJcbiAgICAgICAgdmFyIHRvZ2dsZTtcclxuXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHRvZ2dsZVR5cGU7IHRvZ2dsZVR5cGUgPSB0b2dnbGVUeXBlc1tpXTsgKytpKSB7XHJcbiAgICAgICAgICBpZiAodG9nZ2xlID0gdEVsLmZpbmQodG9nZ2xlVHlwZSlbMF0pIHtcclxuICAgICAgICAgICAgaWYgKCF0b2dnbGUuaGFzQXR0cmlidXRlKCdhcmlhLWxhYmVsJykpIHtcclxuICAgICAgICAgICAgICB2YXIgcCA9IHRFbC5maW5kKCdwJylbMF07XHJcbiAgICAgICAgICAgICAgaWYgKCFwKSByZXR1cm47XHJcbiAgICAgICAgICAgICAgdG9nZ2xlLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdUb2dnbGUgJyArIHAudGV4dENvbnRlbnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiB3cmFwSW4odHlwZSkge1xyXG4gICAgICAgIHZhciBjb250YWluZXI7XHJcbiAgICAgICAgaWYgKHR5cGUgPT0gJ2RpdicpIHtcclxuICAgICAgICAgIGNvbnRhaW5lciA9IGFuZ3VsYXIuZWxlbWVudCgnPGRpdiBjbGFzcz1cIm1kLW5vLXN0eWxlIG1kLWxpc3QtaXRlbS1pbm5lclwiPicpO1xyXG4gICAgICAgICAgY29udGFpbmVyLmFwcGVuZCh0RWwuY29udGVudHMoKSk7XHJcbiAgICAgICAgICB0RWwuYWRkQ2xhc3MoJ21kLXByb3h5LWZvY3VzJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNvbnRhaW5lciA9IGFuZ3VsYXIuZWxlbWVudCgnPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLW5vLXN0eWxlXCI+PGRpdiBjbGFzcz1cIm1kLWxpc3QtaXRlbS1pbm5lclwiPjwvZGl2PjwvbWQtYnV0dG9uPicpO1xyXG4gICAgICAgICAgdmFyIGNvcGllZEF0dHJzID0gWyduZy1jbGljaycsICdhcmlhLWxhYmVsJywgJ25nLWRpc2FibGVkJ107XHJcbiAgICAgICAgICBhbmd1bGFyLmZvckVhY2goY29waWVkQXR0cnMsIGZ1bmN0aW9uKGF0dHIpIHtcclxuICAgICAgICAgICAgaWYgKHRFbFswXS5oYXNBdHRyaWJ1dGUoYXR0cikpIHtcclxuICAgICAgICAgICAgICBjb250YWluZXJbMF0uc2V0QXR0cmlidXRlKGF0dHIsIHRFbFswXS5nZXRBdHRyaWJ1dGUoYXR0cikpO1xyXG4gICAgICAgICAgICAgIHRFbFswXS5yZW1vdmVBdHRyaWJ1dGUoYXR0cik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgY29udGFpbmVyLmNoaWxkcmVuKCkuZXEoMCkuYXBwZW5kKHRFbC5jb250ZW50cygpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRFbFswXS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XHJcbiAgICAgICAgdEVsLmFwcGVuZChjb250YWluZXIpO1xyXG5cclxuICAgICAgICBpZiAoc2Vjb25kYXJ5SXRlbSAmJiBzZWNvbmRhcnlJdGVtLmhhc0F0dHJpYnV0ZSgnbmctY2xpY2snKSkge1xyXG4gICAgICAgICAgJG1kQXJpYS5leHBlY3Qoc2Vjb25kYXJ5SXRlbSwgJ2FyaWEtbGFiZWwnKTtcclxuICAgICAgICAgIHZhciBidXR0b25XcmFwcGVyID0gYW5ndWxhci5lbGVtZW50KCc8bWQtYnV0dG9uIGNsYXNzPVwibWQtc2Vjb25kYXJ5LWNvbnRhaW5lciBtZC1pY29uLWJ1dHRvblwiPicpO1xyXG4gICAgICAgICAgYnV0dG9uV3JhcHBlci5hdHRyKCduZy1jbGljaycsIHNlY29uZGFyeUl0ZW0uZ2V0QXR0cmlidXRlKCduZy1jbGljaycpKTtcclxuICAgICAgICAgIHNlY29uZGFyeUl0ZW0ucmVtb3ZlQXR0cmlidXRlKCduZy1jbGljaycpO1xyXG4gICAgICAgICAgc2Vjb25kYXJ5SXRlbS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XHJcbiAgICAgICAgICBzZWNvbmRhcnlJdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ21kLXNlY29uZGFyeScpO1xyXG4gICAgICAgICAgYnV0dG9uV3JhcHBlci5hcHBlbmQoc2Vjb25kYXJ5SXRlbSk7XHJcbiAgICAgICAgICBzZWNvbmRhcnlJdGVtID0gYnV0dG9uV3JhcHBlclswXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENoZWNrIGZvciBhIHNlY29uZGFyeSBpdGVtIGFuZCBtb3ZlIGl0IG91dHNpZGVcclxuICAgICAgICBpZiAoIHNlY29uZGFyeUl0ZW0gJiYgKFxyXG4gICAgICAgICAgc2Vjb25kYXJ5SXRlbS5oYXNBdHRyaWJ1dGUoJ25nLWNsaWNrJykgfHxcclxuICAgICAgICAgICAgKCB0QXR0cnMubmdDbGljayAmJlxyXG4gICAgICAgICAgICAgaXNQcm94aWVkRWxlbWVudChzZWNvbmRhcnlJdGVtKSApXHJcbiAgICAgICAgKSkge1xyXG4gICAgICAgICAgdEVsLmFkZENsYXNzKCdtZC13aXRoLXNlY29uZGFyeScpO1xyXG4gICAgICAgICAgdEVsLmFwcGVuZChzZWNvbmRhcnlJdGVtKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGlzUHJveGllZEVsZW1lbnQoZWwpIHtcclxuICAgICAgICByZXR1cm4gcHJveGllZFR5cGVzLmluZGV4T2YoZWwubm9kZU5hbWUudG9Mb3dlckNhc2UoKSkgIT0gLTE7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBwb3N0TGluaztcclxuXHJcbiAgICAgIGZ1bmN0aW9uIHBvc3RMaW5rKCRzY29wZSwgJGVsZW1lbnQsICRhdHRyLCBjdHJsKSB7XHJcblxyXG4gICAgICAgIHZhciBwcm94aWVzICAgID0gW10sXHJcbiAgICAgICAgICAgIGZpcnN0Q2hpbGQgPSAkZWxlbWVudFswXS5maXJzdEVsZW1lbnRDaGlsZCxcclxuICAgICAgICAgICAgaGFzQ2xpY2sgICA9IGZpcnN0Q2hpbGQgJiYgZmlyc3RDaGlsZC5oYXNBdHRyaWJ1dGUoJ25nLWNsaWNrJyk7XHJcblxyXG4gICAgICAgIGNvbXB1dGVQcm94aWVzKCk7XHJcbiAgICAgICAgY29tcHV0ZUNsaWNrYWJsZSgpO1xyXG5cclxuICAgICAgICBpZiAoJGVsZW1lbnQuaGFzQ2xhc3MoJ21kLXByb3h5LWZvY3VzJykgJiYgcHJveGllcy5sZW5ndGgpIHtcclxuICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChwcm94aWVzLCBmdW5jdGlvbihwcm94eSkge1xyXG4gICAgICAgICAgICBwcm94eSA9IGFuZ3VsYXIuZWxlbWVudChwcm94eSk7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUubW91c2VBY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgcHJveHkub24oJ21vdXNlZG93bicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICRzY29wZS5tb3VzZUFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICRzY29wZS5tb3VzZUFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIH0sIDEwMCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5vbignZm9jdXMnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICBpZiAoJHNjb3BlLm1vdXNlQWN0aXZlID09PSBmYWxzZSkgeyAkZWxlbWVudC5hZGRDbGFzcygnbWQtZm9jdXNlZCcpOyB9XHJcbiAgICAgICAgICAgICAgcHJveHkub24oJ2JsdXInLCBmdW5jdGlvbiBwcm94eU9uQmx1cigpIHtcclxuICAgICAgICAgICAgICAgICRlbGVtZW50LnJlbW92ZUNsYXNzKCdtZC1mb2N1c2VkJyk7XHJcbiAgICAgICAgICAgICAgICBwcm94eS5vZmYoJ2JsdXInLCBwcm94eU9uQmx1cik7XHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBjb21wdXRlUHJveGllcygpIHtcclxuICAgICAgICAgIHZhciBjaGlsZHJlbiA9ICRlbGVtZW50LmNoaWxkcmVuKCk7XHJcbiAgICAgICAgICBpZiAoY2hpbGRyZW4ubGVuZ3RoICYmICFjaGlsZHJlblswXS5oYXNBdHRyaWJ1dGUoJ25nLWNsaWNrJykpIHtcclxuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHByb3hpZWRUeXBlcywgZnVuY3Rpb24odHlwZSkge1xyXG4gICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChmaXJzdENoaWxkLnF1ZXJ5U2VsZWN0b3JBbGwodHlwZSksIGZ1bmN0aW9uKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICBwcm94aWVzLnB1c2goY2hpbGQpO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gY29tcHV0ZUNsaWNrYWJsZSgpIHtcclxuICAgICAgICAgIGlmIChwcm94aWVzLmxlbmd0aCB8fCBoYXNDbGljaykge1xyXG4gICAgICAgICAgICAkZWxlbWVudC5hZGRDbGFzcygnbWQtY2xpY2thYmxlJyk7XHJcblxyXG4gICAgICAgICAgICBjdHJsLmF0dGFjaFJpcHBsZSgkc2NvcGUsIGFuZ3VsYXIuZWxlbWVudCgkZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCcubWQtbm8tc3R5bGUnKSkpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCFoYXNDbGljayAmJiAhcHJveGllcy5sZW5ndGgpIHtcclxuICAgICAgICAgIGZpcnN0Q2hpbGQgJiYgZmlyc3RDaGlsZC5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgaWYgKGUudGFyZ2V0Lm5vZGVOYW1lICE9ICdJTlBVVCcgJiYgZS50YXJnZXQubm9kZU5hbWUgIT0gJ1RFWFRBUkVBJykge1xyXG4gICAgICAgICAgICAgIHZhciBrZXlDb2RlID0gZS53aGljaCB8fCBlLmtleUNvZGU7XHJcbiAgICAgICAgICAgICAgaWYgKGtleUNvZGUgPT0gJG1kQ29uc3RhbnQuS0VZX0NPREUuU1BBQ0UpIHtcclxuICAgICAgICAgICAgICAgIGlmIChmaXJzdENoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICAgIGZpcnN0Q2hpbGQuY2xpY2soKTtcclxuICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkZWxlbWVudC5vZmYoJ2NsaWNrJyk7XHJcbiAgICAgICAgJGVsZW1lbnQub2ZmKCdrZXlwcmVzcycpO1xyXG5cclxuICAgICAgICBpZiAocHJveGllcy5sZW5ndGggJiYgZmlyc3RDaGlsZCkge1xyXG4gICAgICAgICAgJGVsZW1lbnQuY2hpbGRyZW4oKS5lcSgwKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIGlmIChmaXJzdENoaWxkLmNvbnRhaW5zKGUudGFyZ2V0KSkge1xyXG4gICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChwcm94aWVzLCBmdW5jdGlvbihwcm94eSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUudGFyZ2V0ICE9PSBwcm94eSAmJiAhcHJveHkuY29udGFpbnMoZS50YXJnZXQpKSB7XHJcbiAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChwcm94eSkudHJpZ2dlckhhbmRsZXIoJ2NsaWNrJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH07XHJcbn1cclxubWRMaXN0SXRlbURpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kQXJpYVwiLCBcIiRtZENvbnN0YW50XCIsIFwiJHRpbWVvdXRcIl07XHJcblxyXG4vKlxyXG4gKiBAcHJpdmF0ZVxyXG4gKiBAbmdkb2MgY29udHJvbGxlclxyXG4gKiBAbmFtZSBNZExpc3RDb250cm9sbGVyXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5saXN0XHJcbiAqXHJcbiAqL1xyXG5mdW5jdGlvbiBNZExpc3RDb250cm9sbGVyKCRzY29wZSwgJGVsZW1lbnQsICRtZExpc3RJbmtSaXBwbGUpIHtcclxuICB2YXIgY3RybCA9IHRoaXM7XHJcbiAgY3RybC5hdHRhY2hSaXBwbGUgPSBhdHRhY2hSaXBwbGU7XHJcblxyXG4gIGZ1bmN0aW9uIGF0dGFjaFJpcHBsZSAoc2NvcGUsIGVsZW1lbnQpIHtcclxuICAgIHZhciBvcHRpb25zID0ge307XHJcbiAgICAkbWRMaXN0SW5rUmlwcGxlLmF0dGFjaChzY29wZSwgZWxlbWVudCwgb3B0aW9ucyk7XHJcbiAgfVxyXG59XHJcbk1kTGlzdENvbnRyb2xsZXIuJGluamVjdCA9IFtcIiRzY29wZVwiLCBcIiRlbGVtZW50XCIsIFwiJG1kTGlzdElua1JpcHBsZVwiXTtcclxuXHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKipcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLm1lbnVcclxuICovXHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5tZW51JywgW1xyXG4gICdtYXRlcmlhbC5jb3JlJyxcclxuICAnbWF0ZXJpYWwuY29tcG9uZW50cy5iYWNrZHJvcCdcclxuXSlcclxuLmRpcmVjdGl2ZSgnbWRNZW51JywgTWVudURpcmVjdGl2ZSlcclxuLmNvbnRyb2xsZXIoJ21kTWVudUN0cmwnLCBNZW51Q29udHJvbGxlcik7XHJcblxyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbmFtZSBtZE1lbnVcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLm1lbnVcclxuICogQHJlc3RyaWN0IEVcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqXHJcbiAqIE1lbnVzIGFyZSBlbGVtZW50cyB0aGF0IG9wZW4gd2hlbiBjbGlja2VkLiBUaGV5IGFyZSB1c2VmdWwgZm9yIGRpc3BsYXlpbmdcclxuICogYWRkaXRpb25hbCBvcHRpb25zIHdpdGhpbiB0aGUgY29udGV4dCBvZiBhbiBhY3Rpb24uXHJcbiAqXHJcbiAqIEV2ZXJ5IGBtZC1tZW51YCBtdXN0IHNwZWNpZnkgZXhhY3RseSB0d28gY2hpbGQgZWxlbWVudHMuIFRoZSBmaXJzdCBlbGVtZW50IGlzIHdoYXQgaXNcclxuICogbGVmdCBpbiB0aGUgRE9NIGFuZCBpcyB1c2VkIHRvIG9wZW4gdGhlIG1lbnUuIFRoaXMgZWxlbWVudCBpcyBjYWxsZWQgdGhlIHRyaWdnZXIgZWxlbWVudC5cclxuICogVGhlIHRyaWdnZXIgZWxlbWVudCdzIHNjb3BlIGhhcyBhY2Nlc3MgdG8gYCRtZE9wZW5NZW51KCRldmVudClgXHJcbiAqIHdoaWNoIGl0IG1heSBjYWxsIHRvIG9wZW4gdGhlIG1lbnUuIEJ5IHBhc3NpbmcgJGV2ZW50IGFzIGFyZ3VtZW50LCB0aGVcclxuICogY29ycmVzcG9uZGluZyBldmVudCBpcyBzdG9wcGVkIGZyb20gcHJvcGFnYXRpbmcgdXAgdGhlIERPTS10cmVlLlxyXG4gKlxyXG4gKiBUaGUgc2Vjb25kIGVsZW1lbnQgaXMgdGhlIGBtZC1tZW51LWNvbnRlbnRgIGVsZW1lbnQgd2hpY2ggcmVwcmVzZW50cyB0aGVcclxuICogY29udGVudHMgb2YgdGhlIG1lbnUgd2hlbiBpdCBpcyBvcGVuLiBUeXBpY2FsbHkgdGhpcyB3aWxsIGNvbnRhaW4gYG1kLW1lbnUtaXRlbWBzLFxyXG4gKiBidXQgeW91IGNhbiBkbyBjdXN0b20gY29udGVudCBhcyB3ZWxsLlxyXG4gKlxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtbWVudT5cclxuICogIDwhLS0gVHJpZ2dlciBlbGVtZW50IGlzIGEgbWQtYnV0dG9uIHdpdGggYW4gaWNvbiAtLT5cclxuICogIDxtZC1idXR0b24gbmctY2xpY2s9XCIkbWRPcGVuTWVudSgkZXZlbnQpXCIgY2xhc3M9XCJtZC1pY29uLWJ1dHRvblwiIGFyaWEtbGFiZWw9XCJPcGVuIHNhbXBsZSBtZW51XCI+XHJcbiAqICAgIDxtZC1pY29uIG1kLXN2Zy1pY29uPVwiY2FsbDpwaG9uZVwiPjwvbWQtaWNvbj5cclxuICogIDwvbWQtYnV0dG9uPlxyXG4gKiAgPG1kLW1lbnUtY29udGVudD5cclxuICogICAgPG1kLW1lbnUtaXRlbT48bWQtYnV0dG9uIG5nLWNsaWNrPVwiZG9Tb21ldGhpbmcoKVwiPkRvIFNvbWV0aGluZzwvbWQtYnV0dG9uPjwvbWQtbWVudS1pdGVtPlxyXG4gKiAgPC9tZC1tZW51LWNvbnRlbnQ+XHJcbiAqIDwvbWQtbWVudT5cclxuICogPC9obGpzPlxyXG5cclxuICogIyMgU2l6aW5nIE1lbnVzXHJcbiAqXHJcbiAqIFRoZSB3aWR0aCBvZiB0aGUgbWVudSB3aGVuIGl0IGlzIG9wZW4gbWF5IGJlIHNwZWNpZmllZCBieSBzcGVjaWZ5aW5nIGEgYHdpZHRoYFxyXG4gKiBhdHRyaWJ1dGUgb24gdGhlIGBtZC1tZW51LWNvbnRlbnRgIGVsZW1lbnQuXHJcbiAqIFNlZSB0aGUgW01hdGVyaWFsIERlc2lnbiBTcGVjXShodHRwOi8vd3d3Lmdvb2dsZS5jb20vZGVzaWduL3NwZWMvY29tcG9uZW50cy9tZW51cy5odG1sI21lbnVzLXNwZWNzKVxyXG4gKiBmb3IgbW9yZSBpbmZvcm1hdGlvbi5cclxuICpcclxuICpcclxuICogIyMgQWxpZ25pbmcgTWVudXNcclxuICpcclxuICogV2hlbiBhIG1lbnUgb3BlbnMsIGl0IGlzIGltcG9ydGFudCB0aGF0IHRoZSBjb250ZW50IGFsaWducyB3aXRoIHRoZSB0cmlnZ2VyIGVsZW1lbnQuXHJcbiAqIEZhaWx1cmUgdG8gYWxpZ24gbWVudXMgY2FuIHJlc3VsdCBpbiBqYXJyaW5nIGV4cGVyaWVuY2VzIGZvciB1c2VycyBhcyBjb250ZW50XHJcbiAqIHN1ZGRlbmx5IHNoaWZ0cy4gVG8gaGVscCB3aXRoIHRoaXMsIGBtZC1tZW51YCBwcm92aWRlcyBzZXJ2ZXJhbCBBUElzIHRvIGhlbHBcclxuICogd2l0aCBhbGlnbm1lbnQuXHJcbiAqXHJcbiAqICMjIyBUYXJnZXQgTW9kZVxyXG4gKlxyXG4gKiBCeSBkZWZhdWx0LCBgbWQtbWVudWAgd2lsbCBhdHRlbXB0IHRvIGFsaWduIHRoZSBgbWQtbWVudS1jb250ZW50YCBieSBhbGlnbmluZ1xyXG4gKiBkZXNpZ25hdGVkIGNoaWxkIGVsZW1lbnRzIGluIGJvdGggdGhlIHRyaWdnZXIgYW5kIHRoZSBtZW51IGNvbnRlbnQuXHJcbiAqXHJcbiAqIFRvIHNwZWNpZnkgdGhlIGFsaWdubWVudCBlbGVtZW50IGluIHRoZSBgdHJpZ2dlcmAgeW91IGNhbiB1c2UgdGhlIGBtZC1tZW51LW9yaWdpbmBcclxuICogYXR0cmlidXRlIG9uIGEgY2hpbGQgZWxlbWVudC4gSWYgbm8gYG1kLW1lbnUtb3JpZ2luYCBpcyBzcGVjaWZpZWQsIHRoZSBgbWQtbWVudWBcclxuICogd2lsbCBiZSB1c2VkIGFzIHRoZSBvcmlnaW4gZWxlbWVudC5cclxuICpcclxuICogU2ltaWxhcmx5LCB0aGUgYG1kLW1lbnUtY29udGVudGAgbWF5IHNwZWNpZnkgYSBgbWQtbWVudS1hbGlnbi10YXJnZXRgIGZvciBhXHJcbiAqIGBtZC1tZW51LWl0ZW1gIHRvIHNwZWNpZnkgdGhlIG5vZGUgdGhhdCBpdCBzaG91bGQgdHJ5IGFuZCBhbGlnbiB3aXRoLlxyXG4gKlxyXG4gKiBJbiB0aGlzIGV4YW1wbGUgY29kZSwgd2Ugc3BlY2lmeSBhbiBpY29uIHRvIGJlIG91ciBvcmlnaW4gZWxlbWVudCwgYW5kIGFuXHJcbiAqIGljb24gaW4gb3VyIG1lbnUgY29udGVudCB0byBiZSBvdXIgYWxpZ25tZW50IHRhcmdldC4gVGhpcyBlbnN1cmVzIHRoYXQgYm90aFxyXG4gKiBpY29ucyBhcmUgYWxpZ25lZCB3aGVuIHRoZSBtZW51IG9wZW5zLlxyXG4gKlxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtbWVudT5cclxuICogIDxtZC1idXR0b24gbmctY2xpY2s9XCIkbWRPcGVuTWVudSgkZXZlbnQpXCIgY2xhc3M9XCJtZC1pY29uLWJ1dHRvblwiIGFyaWEtbGFiZWw9XCJPcGVuIHNvbWUgbWVudVwiPlxyXG4gKiAgICA8bWQtaWNvbiBtZC1tZW51LW9yaWdpbiBtZC1zdmctaWNvbj1cImNhbGw6cGhvbmVcIj48L21kLWljb24+XHJcbiAqICA8L21kLWJ1dHRvbj5cclxuICogIDxtZC1tZW51LWNvbnRlbnQ+XHJcbiAqICAgIDxtZC1tZW51LWl0ZW0+XHJcbiAqICAgICAgPG1kLWJ1dHRvbiBuZy1jbGljaz1cImRvU29tZXRoaW5nKClcIiBhcmlhLWxhYmVsPVwiRG8gc29tZXRoaW5nXCI+XHJcbiAqICAgICAgICA8bWQtaWNvbiBtZC1tZW51LWFsaWduLXRhcmdldCBtZC1zdmctaWNvbj1cImNhbGw6cGhvbmVcIj48L21kLWljb24+XHJcbiAqICAgICAgICBEbyBTb21ldGhpbmdcclxuICogICAgICA8L21kLWJ1dHRvbj5cclxuICogICAgPC9tZC1tZW51LWl0ZW0+XHJcbiAqICA8L21kLW1lbnUtY29udGVudD5cclxuICogPC9tZC1tZW51PlxyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqIFNvbWV0aW1lcyB3ZSB3YW50IHRvIHNwZWNpZnkgYWxpZ25tZW50IG9uIHRoZSByaWdodCBzaWRlIG9mIGFuIGVsZW1lbnQsIGZvciBleGFtcGxlXHJcbiAqIGlmIHdlIGhhdmUgYSBtZW51IG9uIHRoZSByaWdodCBzaWRlIGEgdG9vbGJhciwgd2Ugd2FudCB0byByaWdodCBhbGlnbiBvdXIgbWVudSBjb250ZW50LlxyXG4gKlxyXG4gKiBXZSBjYW4gc3BlY2lmeSB0aGUgb3JpZ2luIGJ5IHVzaW5nIHRoZSBgbWQtcG9zaXRpb24tbW9kZWAgYXR0cmlidXRlIG9uIGJvdGhcclxuICogdGhlIGB4YCBhbmQgYHlgIGF4aXMuIFJpZ2h0IG5vdyBvbmx5IHRoZSBgeC1heGlzYCBoYXMgbW9yZSB0aGFuIG9uZSBvcHRpb24uXHJcbiAqIFlvdSBtYXkgc3BlY2lmeSB0aGUgZGVmYXVsdCBtb2RlIG9mIGB0YXJnZXQgdGFyZ2V0YCBvclxyXG4gKiBgdGFyZ2V0LXJpZ2h0IHRhcmdldGAgdG8gc3BlY2lmeSBhIHJpZ2h0LW9yaWVudGVkIGFsaWdubWVudCB0YXJnZXQuIFNlZSB0aGVcclxuICogcG9zaXRpb24gc2VjdGlvbiBvZiB0aGUgZGVtb3MgZm9yIG1vcmUgZXhhbXBsZXMuXHJcbiAqXHJcbiAqICMjIyBNZW51IE9mZnNldHNcclxuICpcclxuICogSXQgaXMgc29tZXRpbWVzIHVuYXZvaWRhYmxlIHRvIG5lZWQgdG8gaGF2ZSBhIGRlZXBlciBsZXZlbCBvZiBjb250cm9sIGZvclxyXG4gKiB0aGUgcG9zaXRpb25pbmcgb2YgYSBtZW51IHRvIGVuc3VyZSBwZXJmZWN0IGFsaWdubWVudC4gYG1kLW1lbnVgIHByb3ZpZGVzXHJcbiAqIHRoZSBgbWQtb2Zmc2V0YCBhdHRyaWJ1dGUgdG8gYWxsb3cgcGl4ZWwgbGV2ZWwgc3BlY2lmaWN0eSBvZiBhZGp1c3RpbmcgdGhlXHJcbiAqIGV4YWN0IHBvc2l0aW9uaW5nLlxyXG4gKlxyXG4gKiBUaGlzIG9mZnNldCBpcyBwcm92aWRlZCBpbiB0aGUgZm9ybWF0IG9mIGB4IHlgIG9yIGBuYCB3aGVyZSBgbmAgd2lsbCBiZSB1c2VkXHJcbiAqIGluIGJvdGggdGhlIGB4YCBhbmQgYHlgIGF4aXMuXHJcbiAqXHJcbiAqIEZvciBleGFtcGxlLCB0byBtb3ZlIGEgbWVudSBieSBgMnB4YCBmcm9tIHRoZSB0b3AsIHdlIGNhbiB1c2U6XHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqIDxtZC1tZW51IG1kLW9mZnNldD1cIjIgMFwiPlxyXG4gKiAgIDwhLS0gbWVudS1jb250ZW50IC0tPlxyXG4gKiA8L21kLW1lbnU+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICogQHVzYWdlXHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqIDxtZC1tZW51PlxyXG4gKiAgPG1kLWJ1dHRvbiBuZy1jbGljaz1cIiRtZE9wZW5NZW51KCRldmVudClcIiBjbGFzcz1cIm1kLWljb24tYnV0dG9uXCI+XHJcbiAqICAgIDxtZC1pY29uIG1kLXN2Zy1pY29uPVwiY2FsbDpwaG9uZVwiPjwvbWQtaWNvbj5cclxuICogIDwvbWQtYnV0dG9uPlxyXG4gKiAgPG1kLW1lbnUtY29udGVudD5cclxuICogICAgPG1kLW1lbnUtaXRlbT48bWQtYnV0dG9uIG5nLWNsaWNrPVwiZG9Tb21ldGhpbmcoKVwiPkRvIFNvbWV0aGluZzwvbWQtYnV0dG9uPjwvbWQtbWVudS1pdGVtPlxyXG4gKiAgPC9tZC1tZW51LWNvbnRlbnQ+XHJcbiAqIDwvbWQtbWVudT5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gbWQtcG9zaXRpb24tbW9kZSBUaGUgcG9zaXRpb24gbW9kZSBpbiB0aGUgZm9ybSBvZlxyXG4gICAgICAgICAgICAgYHhgLCBgeWAuIERlZmF1bHQgdmFsdWUgaXMgYHRhcmdldGAsYHRhcmdldGAuIFJpZ2h0IG5vdyB0aGUgYHhgIGF4aXNcclxuICAgICAgICAgICAgIGFsc28gc3VwcHBvcnRzIGB0YXJnZXQtcmlnaHRgLlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gbWQtb2Zmc2V0IEFuIG9mZnNldCB0byBhcHBseSB0byB0aGUgZHJvcGRvd24gYWZ0ZXIgcG9zaXRpb25pbmdcclxuICAgICAgICAgICAgIGB4YCwgYHlgLiBEZWZhdWx0IHZhbHVlIGlzIGAwYCxgMGAuXHJcbiAqXHJcbiAqL1xyXG5cclxuZnVuY3Rpb24gTWVudURpcmVjdGl2ZSgkbWRNZW51KSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICByZXF1aXJlOiAnbWRNZW51JyxcclxuICAgIGNvbnRyb2xsZXI6ICdtZE1lbnVDdHJsJywgLy8gZW1wdHkgZnVuY3Rpb24gdG8gYmUgYnVpbHQgYnkgbGlua1xyXG4gICAgc2NvcGU6IHRydWUsXHJcbiAgICBjb21waWxlOiBjb21waWxlXHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb24gY29tcGlsZSh0ZW1wbGF0ZUVsZW1lbnQpIHtcclxuICAgIHRlbXBsYXRlRWxlbWVudC5hZGRDbGFzcygnbWQtbWVudScpO1xyXG4gICAgdmFyIHRyaWdnZXJFbGVtZW50ID0gdGVtcGxhdGVFbGVtZW50LmNoaWxkcmVuKClbMF07XHJcbiAgICBpZiAoIXRyaWdnZXJFbGVtZW50Lmhhc0F0dHJpYnV0ZSgnbmctY2xpY2snKSkge1xyXG4gICAgICB0cmlnZ2VyRWxlbWVudCA9IHRyaWdnZXJFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tuZy1jbGlja10nKTtcclxuICAgIH1cclxuICAgIHRyaWdnZXJFbGVtZW50ICYmIHRyaWdnZXJFbGVtZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1oYXNwb3B1cCcsICd0cnVlJyk7XHJcbiAgICBpZiAodGVtcGxhdGVFbGVtZW50LmNoaWxkcmVuKCkubGVuZ3RoICE9IDIpIHtcclxuICAgICAgdGhyb3cgRXJyb3IoJ0ludmFsaWQgSFRNTCBmb3IgbWQtbWVudS4gRXhwZWN0ZWQgdHdvIGNoaWxkcmVuIGVsZW1lbnRzLicpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGxpbms7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRycywgbWRNZW51Q3RybCkge1xyXG5cclxuICAgIC8vIE1vdmUgZXZlcnl0aGluZyBpbnRvIGEgbWQtbWVudS1jb250YWluZXIgYW5kIHBhc3MgaXQgdG8gdGhlIGNvbnRyb2xsZXJcclxuICAgIHZhciBtZW51Q29udGFpbmVyID0gYW5ndWxhci5lbGVtZW50KFxyXG4gICAgICAnPGRpdiBjbGFzcz1cIm1kLW9wZW4tbWVudS1jb250YWluZXIgbWQtd2hpdGVmcmFtZS16MlwiPjwvZGl2PidcclxuICAgICk7XHJcbiAgICB2YXIgbWVudUNvbnRlbnRzID0gZWxlbWVudC5jaGlsZHJlbigpWzFdO1xyXG4gICAgbWVudUNvbnRhaW5lci5hcHBlbmQobWVudUNvbnRlbnRzKTtcclxuICAgIG1kTWVudUN0cmwuaW5pdChtZW51Q29udGFpbmVyKTtcclxuXHJcbiAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIGlmIChtZE1lbnVDdHJsLmlzT3Blbikge1xyXG4gICAgICAgIG1lbnVDb250YWluZXIucmVtb3ZlKCk7XHJcbiAgICAgICAgbWRNZW51Q3RybC5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG59XHJcbk1lbnVEaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZE1lbnVcIl07XHJcblxyXG5mdW5jdGlvbiBNZW51Q29udHJvbGxlcigkbWRNZW51LCAkYXR0cnMsICRlbGVtZW50LCAkc2NvcGUpIHtcclxuXHJcbiAgdmFyIG1lbnVDb250YWluZXI7XHJcbiAgdmFyIGN0cmwgPSB0aGlzO1xyXG4gIHZhciB0cmlnZ2VyRWxlbWVudDtcclxuXHJcbiAgLy8gQ2FsbGVkIGJ5IG91ciBsaW5raW5nIGZuIHRvIHByb3ZpZGUgYWNjZXNzIHRvIHRoZSBtZW51LWNvbnRlbnRcclxuICAvLyBlbGVtZW50IHJlbW92ZWQgZHVyaW5nIGxpbmtcclxuICB0aGlzLmluaXQgPSBmdW5jdGlvbihzZXRNZW51Q29udGFpbmVyKSB7XHJcbiAgICBtZW51Q29udGFpbmVyID0gc2V0TWVudUNvbnRhaW5lcjtcclxuICAgIHRyaWdnZXJFbGVtZW50ID0gJGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignW25nLWNsaWNrXScpO1xyXG4gIH07XHJcblxyXG4gIC8vIFVzZXMgdGhlICRtZE1lbnUgaW50ZXJpbSBlbGVtZW50IHNlcnZpY2UgdG8gb3BlbiB0aGUgbWVudSBjb250ZW50c1xyXG4gIHRoaXMub3BlbiA9IGZ1bmN0aW9uIG9wZW5NZW51KGV2KSB7XHJcbiAgICBldiAmJiBldi5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcbiAgICBjdHJsLmlzT3BlbiA9IHRydWU7XHJcbiAgICB0cmlnZ2VyRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAndHJ1ZScpO1xyXG4gICAgJG1kTWVudS5zaG93KHtcclxuICAgICAgbWRNZW51Q3RybDogY3RybCxcclxuICAgICAgZWxlbWVudDogbWVudUNvbnRhaW5lcixcclxuICAgICAgdGFyZ2V0OiAkZWxlbWVudFswXVxyXG4gICAgfSk7XHJcbiAgfTtcclxuICAvLyBFeHBvc2UgYSBvcGVuIGZ1bmN0aW9uIHRvIHRoZSBjaGlsZCBzY29wZSBmb3IgaHRtbCB0byB1c2VcclxuICAkc2NvcGUuJG1kT3Blbk1lbnUgPSB0aGlzLm9wZW47XHJcblxyXG4gIC8vIFVzZSB0aGUgJG1kTWVudSBpbnRlcmltIGVsZW1lbnQgc2VydmljZSB0byBjbG9zZSB0aGUgbWVudSBjb250ZW50c1xyXG4gIHRoaXMuY2xvc2UgPSBmdW5jdGlvbiBjbG9zZU1lbnUoc2tpcEZvY3VzKSB7XHJcbiAgICBjdHJsLmlzT3BlbiA9IGZhbHNlO1xyXG4gICAgdHJpZ2dlckVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XHJcbiAgICAkbWRNZW51LmhpZGUoKTtcclxuXHJcbiAgICBpZiAoIXNraXBGb2N1cykge1xyXG4gICAgICAkZWxlbWVudC5jaGlsZHJlbigpWzBdLmZvY3VzKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgLy8gQnVpbGQgYSBuaWNlIG9iamVjdCBvdXQgb2Ygb3VyIHN0cmluZyBhdHRyaWJ1dGUgd2hpY2ggc3BlY2lmaWVzIHRoZVxyXG4gIC8vIHRhcmdldCBtb2RlIGZvciBsZWZ0IGFuZCB0b3AgcG9zaXRpb25pbmdcclxuICB0aGlzLnBvc2l0aW9uTW9kZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIGF0dGFjaG1lbnQgPSAoJGF0dHJzLm1kUG9zaXRpb25Nb2RlIHx8ICd0YXJnZXQnKS5zcGxpdCgnICcpO1xyXG5cclxuICAgIC8vIElmIGF0dGFjaG1lbnQgaXMgYSBzaW5nbGUgaXRlbSwgZHVwbGljYXRlIGl0IGZvciBvdXIgc2Vjb25kIHZhbHVlLlxyXG4gICAgLy8gaWUuICd0YXJnZXQnIC0+ICd0YXJnZXQgdGFyZ2V0J1xyXG4gICAgaWYgKGF0dGFjaG1lbnQubGVuZ3RoID09IDEpIHtcclxuICAgICAgYXR0YWNobWVudC5wdXNoKGF0dGFjaG1lbnRbMF0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGxlZnQ6IGF0dGFjaG1lbnRbMF0sXHJcbiAgICAgIHRvcDogYXR0YWNobWVudFsxXVxyXG4gICAgfTtcclxuICB9O1xyXG5cclxuICAvLyBCdWlsZCBhIG5pY2Ugb2JqZWN0IG91dCBvZiBvdXIgc3RyaW5nIGF0dHJpYnV0ZSB3aGljaCBzcGVjaWZpZXNcclxuICAvLyB0aGUgb2Zmc2V0IG9mIHRvcCBhbmQgbGVmdCBpbiBwaXhlbHMuXHJcbiAgdGhpcy5vZmZzZXRzID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgb2Zmc2V0cyA9ICgkYXR0cnMubWRPZmZzZXQgfHwgJzAgMCcpLnNwbGl0KCcgJykubWFwKHBhcnNlRmxvYXQpO1xyXG4gICAgaWYgKG9mZnNldHMubGVuZ3RoID09IDIpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBsZWZ0OiBvZmZzZXRzWzBdLFxyXG4gICAgICAgIHRvcDogb2Zmc2V0c1sxXVxyXG4gICAgICB9O1xyXG4gICAgfSBlbHNlIGlmIChvZmZzZXRzLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgdG9wOiBvZmZzZXRzWzBdLFxyXG4gICAgICAgIGxlZnQ6IG9mZnNldHNbMF1cclxuICAgICAgfTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRocm93IEVycm9yKCdJbnZhbGlkIG9mZnNldHMgc3BlY2lmaWVkLiBQbGVhc2UgZm9sbG93IGZvcm1hdCA8eCwgeT4gb3IgPG4+Jyk7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG5NZW51Q29udHJvbGxlci4kaW5qZWN0ID0gW1wiJG1kTWVudVwiLCBcIiRhdHRyc1wiLCBcIiRlbGVtZW50XCIsIFwiJHNjb3BlXCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMubWVudScpXHJcbi5wcm92aWRlcignJG1kTWVudScsIE1lbnVQcm92aWRlcik7XHJcblxyXG4vKlxyXG4gKiBJbnRlcmltIGVsZW1lbnQgcHJvdmlkZXIgZm9yIHRoZSBtZW51LlxyXG4gKiBIYW5kbGVzIGJlaGF2aW9yIGZvciBhIG1lbnUgd2hpbGUgaXQgaXMgb3BlbiwgaW5jbHVkaW5nOlxyXG4gKiAgICAtIGhhbmRsaW5nIGFuaW1hdGluZyB0aGUgbWVudSBvcGVuaW5nL2Nsb3NpbmdcclxuICogICAgLSBoYW5kbGluZyBrZXkvbW91c2UgZXZlbnRzIG9uIHRoZSBtZW51IGVsZW1lbnRcclxuICogICAgLSBoYW5kbGluZyBlbmFibGluZy9kaXNhYmxpbmcgc2Nyb2xsIHdoaWxlIHRoZSBtZW51IGlzIG9wZW5cclxuICogICAgLSBoYW5kbGluZyByZWRyYXdpbmcgZHVyaW5nIHJlc2l6ZXMgYW5kIG9yaWVudGF0aW9uIGNoYW5nZXNcclxuICpcclxuICovXHJcblxyXG5mdW5jdGlvbiBNZW51UHJvdmlkZXIoJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyKSB7XHJcbiAgdmFyIE1FTlVfRURHRV9NQVJHSU4gPSA4O1xyXG5cclxuICBtZW51RGVmYXVsdE9wdGlvbnMuJGluamVjdCA9IFtcIiQkckFGXCIsIFwiJHdpbmRvd1wiLCBcIiRtZFV0aWxcIiwgXCIkbWRUaGVtaW5nXCIsIFwiJHRpbWVvdXRcIiwgXCIkbWRDb25zdGFudFwiLCBcIiRkb2N1bWVudFwiXTtcclxuICByZXR1cm4gJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyKCckbWRNZW51JylcclxuICAgIC5zZXREZWZhdWx0cyh7XHJcbiAgICAgIG1ldGhvZHM6IFsndGFyZ2V0J10sXHJcbiAgICAgIG9wdGlvbnM6IG1lbnVEZWZhdWx0T3B0aW9uc1xyXG4gICAgfSk7XHJcblxyXG4gIC8qIEBuZ0luamVjdCAqL1xyXG4gIGZ1bmN0aW9uIG1lbnVEZWZhdWx0T3B0aW9ucygkJHJBRiwgJHdpbmRvdywgJG1kVXRpbCwgJG1kVGhlbWluZywgJHRpbWVvdXQsICRtZENvbnN0YW50LCAkZG9jdW1lbnQpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHBhcmVudDogJ2JvZHknLFxyXG4gICAgICBvblNob3c6IG9uU2hvdyxcclxuICAgICAgb25SZW1vdmU6IG9uUmVtb3ZlLFxyXG4gICAgICBoYXNCYWNrZHJvcDogdHJ1ZSxcclxuICAgICAgZGlzYWJsZVBhcmVudFNjcm9sbDogdHJ1ZSxcclxuICAgICAgc2tpcENvbXBpbGU6IHRydWUsXHJcbiAgICAgIHRoZW1hYmxlOiB0cnVlXHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQm9pbGVycGxhdGUgaW50ZXJpbUVsZW1lbnQgb25TaG93IGZ1bmN0aW9uXHJcbiAgICAgKiBIYW5kbGVzIGluc2VydGluZyB0aGUgbWVudSBpbnRvIHRoZSBET00sIHBvc2l0aW9uaW5nIGl0LCBhbmQgd2lyaW5nIHVwXHJcbiAgICAgKiB2YXJpb3VzIGludGVyYWN0aW9uIGV2ZW50c1xyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBvblNob3coc2NvcGUsIGVsZW1lbnQsIG9wdHMpIHtcclxuXHJcbiAgICAgIC8vIFNhbml0aXplIGFuZCBzZXQgZGVmYXVsdHMgb24gb3B0c1xyXG4gICAgICBidWlsZE9wdHMob3B0cyk7XHJcblxyXG4gICAgICAvLyBXaXJlIHVwIHRoZW1pbmcgb24gb3VyIG1lbnUgZWxlbWVudFxyXG4gICAgICAkbWRUaGVtaW5nLmluaGVyaXQob3B0cy5tZW51Q29udGVudEVsLCBvcHRzLnRhcmdldCk7XHJcblxyXG4gICAgICAvLyBSZWdpc3RlciB2YXJpb3VzIGxpc3RlbmVycyB0byBtb3ZlIG1lbnUgb24gcmVzaXplL29yaWVudGF0aW9uIGNoYW5nZVxyXG4gICAgICBoYW5kbGVSZXNpemluZygpO1xyXG5cclxuICAgICAgLy8gRGlzYWJsZSBzY3JvbGxpbmdcclxuICAgICAgaWYgKG9wdHMuZGlzYWJsZVBhcmVudFNjcm9sbCkge1xyXG4gICAgICAgIG9wdHMucmVzdG9yZVNjcm9sbCA9ICRtZFV0aWwuZGlzYWJsZVNjcm9sbEFyb3VuZChvcHRzLmVsZW1lbnQpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBPbmx5IGFjdGl2YXRlIGNsaWNrIGxpc3RlbmVycyBhZnRlciBhIHNob3J0IHRpbWUgdG8gc3RvcCBhY2NpZGVudGFsIGRvdWJsZSB0YXBzL2NsaWNrc1xyXG4gICAgICAvLyBmcm9tIGNsaWNraW5nIHRoZSB3cm9uZyBpdGVtXHJcbiAgICAgICR0aW1lb3V0KGFjdGl2YXRlSW50ZXJhY3Rpb24sIDc1LCBmYWxzZSk7XHJcblxyXG4gICAgICBpZiAob3B0cy5iYWNrZHJvcCkge1xyXG4gICAgICAgICRtZFRoZW1pbmcuaW5oZXJpdChvcHRzLmJhY2tkcm9wLCBvcHRzLnBhcmVudCk7XHJcbiAgICAgICAgb3B0cy5wYXJlbnQuYXBwZW5kKG9wdHMuYmFja2Ryb3ApO1xyXG4gICAgICB9XHJcbiAgICAgIHNob3dNZW51KCk7XHJcblxyXG4gICAgICAvLyBSZXR1cm4gdGhlIHByb21pc2UgZm9yIHdoZW4gb3VyIG1lbnUgaXMgZG9uZSBhbmltYXRpbmcgaW5cclxuICAgICAgcmV0dXJuICRtZFV0aWwudHJhbnNpdGlvbkVuZFByb21pc2UoZWxlbWVudCwge3RpbWVvdXQ6IDM1MH0pO1xyXG5cclxuICAgICAgLyoqIENoZWNrIGZvciB2YWxpZCBvcHRzIGFuZCBzZXQgc29tZSBzYW5lIGRlZmF1bHRzICovXHJcbiAgICAgIGZ1bmN0aW9uIGJ1aWxkT3B0cygpIHtcclxuICAgICAgICBpZiAoIW9wdHMudGFyZ2V0KSB7XHJcbiAgICAgICAgICB0aHJvdyBFcnJvcihcclxuICAgICAgICAgICAgJyRtZE1lbnUuc2hvdygpIGV4cGVjdGVkIGEgdGFyZ2V0IHRvIGFuaW1hdGUgZnJvbSBpbiBvcHRpb25zLnRhcmdldCdcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGFuZ3VsYXIuZXh0ZW5kKG9wdHMsIHtcclxuICAgICAgICAgIGFscmVhZHlPcGVuOiBmYWxzZSxcclxuICAgICAgICAgIGlzUmVtb3ZlZDogZmFsc2UsXHJcbiAgICAgICAgICB0YXJnZXQ6IGFuZ3VsYXIuZWxlbWVudChvcHRzLnRhcmdldCksIC8vbWFrZSBzdXJlIGl0J3Mgbm90IGEgbmFrZWQgZG9tIG5vZGVcclxuICAgICAgICAgIHBhcmVudDogYW5ndWxhci5lbGVtZW50KG9wdHMucGFyZW50KSxcclxuICAgICAgICAgIG1lbnVDb250ZW50RWw6IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJ21kLW1lbnUtY29udGVudCcpKSxcclxuICAgICAgICAgIGJhY2tkcm9wOiBvcHRzLmhhc0JhY2tkcm9wICYmIGFuZ3VsYXIuZWxlbWVudCgnPG1kLWJhY2tkcm9wIGNsYXNzPVwibWQtbWVudS1iYWNrZHJvcCBtZC1jbGljay1jYXRjaGVyXCI+JylcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLyoqIFdpcmV1cCB2YXJpb3VzIHJlc2l6ZSBsaXN0ZW5lcnMgZm9yIHNjcmVlbiBjaGFuZ2VzICovXHJcbiAgICAgIGZ1bmN0aW9uIGhhbmRsZVJlc2l6aW5nKCkge1xyXG4gICAgICAgIG9wdHMucmVzaXplRm4gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgIHBvc2l0aW9uTWVudShlbGVtZW50LCBvcHRzKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vbigncmVzaXplJywgb3B0cy5yZXNpemVGbik7XHJcbiAgICAgICAgYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpLm9uKCdvcmllbnRhdGlvbmNoYW5nZScsIG9wdHMucmVzaXplRm4pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvKipcclxuICAgICAgICogUGxhY2UgdGhlIG1lbnUgaW50byB0aGUgRE9NIGFuZCBjYWxsIHBvc2l0aW9uaW5nIHJlbGF0ZWQgZnVuY3Rpb25zXHJcbiAgICAgICAqL1xyXG4gICAgICBmdW5jdGlvbiBzaG93TWVudSgpIHtcclxuICAgICAgICBvcHRzLnBhcmVudC5hcHBlbmQoZWxlbWVudCk7XHJcblxyXG4gICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21kLWxlYXZlJyk7XHJcbiAgICAgICAgLy8gS2ljayBvZmYgb3VyIGFuaW1hdGlvbi9wb3NpdGlvbmluZyBidXQgZmlyc3QsIHdhaXQgYSBmZXcgZnJhbWVzXHJcbiAgICAgICAgLy8gc28gYWxsIG9mIG91ciBjb21wdXRlZCBwb3NpdGlvbnMvc2l6ZXMgYXJlIGFjY3VyYXRlXHJcbiAgICAgICAgJCRyQUYoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAkJHJBRihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcG9zaXRpb25NZW51KGVsZW1lbnQsIG9wdHMpO1xyXG4gICAgICAgICAgICAvLyBXYWl0IGEgZnJhbWUgYmVmb3JlIGZhZGluZyBpbiBtZW51IChtZC1hY3RpdmUpIHNvIHRoYXQgd2UgZG9uJ3QgdHJpZ2dlclxyXG4gICAgICAgICAgICAvLyB0cmFuc2l0aW9ucyBvbiB0aGUgbWVudSBwb3NpdGlvbiBjaGFuZ2luZ1xyXG4gICAgICAgICAgICAkJHJBRihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdtZC1hY3RpdmUnKTtcclxuICAgICAgICAgICAgICBvcHRzLmFscmVhZHlPcGVuID0gdHJ1ZTtcclxuICAgICAgICAgICAgICBlbGVtZW50WzBdLnN0eWxlWyRtZENvbnN0YW50LkNTUy5UUkFOU0ZPUk1dID0gJyc7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcblxyXG4gICAgICAvKipcclxuICAgICAgICogQWN0aXZhdGUgaW50ZXJhY3Rpb24gb24gdGhlIG1lbnUuIFdpcmUgdXAga2V5Ym9hcmQgbGlzdGVybnMgZm9yXHJcbiAgICAgICAqIGNsaWNrcywga2V5cHJlc3NlcywgYmFja2Ryb3AgY2xvc2luZywgZXRjLlxyXG4gICAgICAgKi9cclxuICAgICAgZnVuY3Rpb24gYWN0aXZhdGVJbnRlcmFjdGlvbigpIHtcclxuICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdtZC1jbGlja2FibGUnKTtcclxuXHJcbiAgICAgICAgLy8gY2xvc2Ugb24gYmFja2Ryb3AgY2xpY2tcclxuICAgICAgICBvcHRzLmJhY2tkcm9wICYmIG9wdHMuYmFja2Ryb3Aub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgIG9wdHMubWRNZW51Q3RybC5jbG9zZSh0cnVlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gV2lyZSB1cCBrZXlib2FyZCBsaXN0ZW5lcnMuXHJcbiAgICAgICAgLy8gQ2xvc2Ugb24gZXNjYXBlLCBmb2N1cyBuZXh0IGl0ZW0gb24gZG93biBhcnJvdywgZm9jdXMgcHJldiBpdGVtIG9uIHVwXHJcbiAgICAgICAgb3B0cy5tZW51Q29udGVudEVsLm9uKCdrZXlkb3duJywgZnVuY3Rpb24oZXYpIHtcclxuICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgc3dpdGNoIChldi5rZXlDb2RlKSB7XHJcbiAgICAgICAgICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5FU0NBUEU6IG9wdHMubWRNZW51Q3RybC5jbG9zZSgpOyBicmVhaztcclxuICAgICAgICAgICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLlVQX0FSUk9XOiBmb2N1c01lbnVJdGVtKGV2LCBvcHRzLm1lbnVDb250ZW50RWwsIG9wdHMsIC0xKTsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5ET1dOX0FSUk9XOiBmb2N1c01lbnVJdGVtKGV2LCBvcHRzLm1lbnVDb250ZW50RWwsIG9wdHMsIDEpOyBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIENsb3NlIG1lbnUgb24gbWVudSBpdGVtIGNsaWNrLCBpZiBzYWlkIG1lbnUtaXRlbSBpcyBub3QgZGlzYWJsZWRcclxuICAgICAgICBvcHRzLm1lbnVDb250ZW50RWwub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0O1xyXG4gICAgICAgICAgLy8gVHJhdmVyc2UgdXAgdGhlIGV2ZW50IHVudGlsIHdlIGdldCB0byB0aGUgbWVudUNvbnRlbnRFbCB0byBzZWUgaWZcclxuICAgICAgICAgIC8vIHRoZXJlIGlzIGFuIG5nLWNsaWNrIGFuZCB0aGF0IHRoZSBuZy1jbGljayBpcyBub3QgZGlzYWJsZWRcclxuICAgICAgICAgIGRvIHtcclxuICAgICAgICAgICAgaWYgKHRhcmdldCAmJiB0YXJnZXQuaGFzQXR0cmlidXRlKCduZy1jbGljaycpKSB7XHJcbiAgICAgICAgICAgICAgaWYgKCF0YXJnZXQuaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpKSB7XHJcbiAgICAgICAgICAgICAgICBjbG9zZSgpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSB3aGlsZSAoKHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2RlKSAmJiB0YXJnZXQgIT0gb3B0cy5tZW51Q29udGVudEVsKVxyXG5cclxuICAgICAgICAgIGZ1bmN0aW9uIGNsb3NlKCkge1xyXG4gICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgb3B0cy5tZE1lbnVDdHJsLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBraWNrIG9mZiBpbml0aWFsIGZvY3VzIGluIHRoZSBtZW51IG9uIHRoZSBmaXJzdCBlbGVtZW50XHJcbiAgICAgICAgdmFyIGZvY3VzVGFyZ2V0ID0gb3B0cy5tZW51Q29udGVudEVsWzBdLnF1ZXJ5U2VsZWN0b3IoJ1ttZC1tZW51LWZvY3VzLXRhcmdldF0nKTtcclxuICAgICAgICBpZiAoIWZvY3VzVGFyZ2V0KSBmb2N1c1RhcmdldCA9IG9wdHMubWVudUNvbnRlbnRFbFswXS5maXJzdEVsZW1lbnRDaGlsZC5maXJzdEVsZW1lbnRDaGlsZDtcclxuICAgICAgICBmb2N1c1RhcmdldC5mb2N1cygpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgICogVGFrZXMgYSBrZXlwcmVzcyBldmVudCBhbmQgZm9jdXNlcyB0aGUgbmV4dC9wcmV2aW91cyBtZW51XHJcbiAgICAgICogaXRlbSBmcm9tIHRoZSBlbWl0dGluZyBlbGVtZW50XHJcbiAgICAgICogQHBhcmFtIHtldmVudH0gZSAtIFRoZSBvcmlnaW4ga2V5cHJlc3MgZXZlbnRcclxuICAgICAgKiBAcGFyYW0ge2FuZ3VsYXIuZWxlbWVudH0gbWVudUVsIC0gVGhlIG1lbnUgZWxlbWVudFxyXG4gICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvcHRzIC0gVGhlIGludGVyaW0gZWxlbWVudCBvcHRpb25zIGZvciB0aGUgbWRNZW51XHJcbiAgICAgICogQHBhcmFtIHtudW1iZXJ9IGRpcmVjdGlvbiAtIFRoZSBkaXJlY3Rpb24gdG8gbW92ZSBpbiAoKzEgPSBuZXh0LCAtMSA9IHByZXYpXHJcbiAgICAgICovXHJcbiAgICBmdW5jdGlvbiBmb2N1c01lbnVJdGVtKGUsIG1lbnVFbCwgb3B0cywgZGlyZWN0aW9uKSB7XHJcbiAgICAgIHZhciBjdXJyZW50SXRlbSA9ICRtZFV0aWwuZ2V0Q2xvc2VzdChlLnRhcmdldCwgJ01ELU1FTlUtSVRFTScpO1xyXG5cclxuICAgICAgdmFyIGl0ZW1zID0gJG1kVXRpbC5ub2Rlc1RvQXJyYXkobWVudUVsWzBdLmNoaWxkcmVuKTtcclxuICAgICAgdmFyIGN1cnJlbnRJbmRleCA9IGl0ZW1zLmluZGV4T2YoY3VycmVudEl0ZW0pO1xyXG5cclxuICAgICAgLy8gVHJhdmVyc2UgdGhyb3VnaCBvdXIgZWxlbWVudHMgaW4gdGhlIHNwZWNpZmllZCBkaXJlY3Rpb24gKCsvLTEpIGFuZCB0cnkgdG9cclxuICAgICAgLy8gZm9jdXMgdGhlbSB1bnRpbCB3ZSBmaW5kIG9uZSB0aGF0IGFjY2VwdHMgZm9jdXNcclxuICAgICAgZm9yICh2YXIgaSA9IGN1cnJlbnRJbmRleCArIGRpcmVjdGlvbjsgaSA+PSAwICYmIGkgPCBpdGVtcy5sZW5ndGg7IGkgPSBpICsgZGlyZWN0aW9uKSB7XHJcbiAgICAgICAgdmFyIGZvY3VzVGFyZ2V0ID0gaXRlbXNbaV0uZmlyc3RFbGVtZW50Q2hpbGQgfHwgaXRlbXNbaV07XHJcbiAgICAgICAgdmFyIGRpZEZvY3VzID0gYXR0ZW1wdEZvY3VzKGZvY3VzVGFyZ2V0KTtcclxuICAgICAgICBpZiAoZGlkRm9jdXMpIHtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQXR0ZW1wdHMgdG8gZm9jdXMgYW4gZWxlbWVudC4gQ2hlY2tzIHdoZXRoZXIgdGhhdCBlbGVtZW50IGlzIHRoZSBjdXJyZW50bHlcclxuICAgICAqIGZvY3VzZWQgZWxlbWVudCBhZnRlciBhdHRlbXB0aW5nLlxyXG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZWwgLSB0aGUgZWxlbWVudCB0byBhdHRlbXB0IGZvY3VzIG9uXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbH0gLSB3aGV0aGVyIHRoZSBlbGVtZW50IHdhcyBzdWNjZXNzZnVsbHkgZm9jdXNlZFxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBhdHRlbXB0Rm9jdXMoZWwpIHtcclxuICAgICAgaWYgKGVsICYmIGVsLmdldEF0dHJpYnV0ZSgndGFiaW5kZXgnKSAhPSAtMSkge1xyXG4gICAgICAgIGVsLmZvY3VzKCk7XHJcbiAgICAgICAgaWYgKCRkb2N1bWVudFswXS5hY3RpdmVFbGVtZW50ID09IGVsKSB7XHJcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQm9pbGVycGxhdGUgaW50ZXJpbUVsZW1lbnQgb25SZW1vdmUgZnVuY3Rpb25cclxuICAgICAqIEhhbmRsZXMgcmVtb3ZpbmcgdGhlIG1lbnUgZnJvbSB0aGUgRE9NLCBjbGVhbmluZyB1cCB0aGUgZWxlbWVudFxyXG4gICAgICogYW5kIHJlbW92aW5nIHZhcmlvdXMgbGlzdGVuZXJzXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIG9uUmVtb3ZlKHNjb3BlLCBlbGVtZW50LCBvcHRzKSB7XHJcbiAgICAgIG9wdHMuaXNSZW1vdmVkID0gdHJ1ZTtcclxuICAgICAgZWxlbWVudC5hZGRDbGFzcygnbWQtbGVhdmUnKVxyXG4gICAgICAgIC5yZW1vdmVDbGFzcygnbWQtY2xpY2thYmxlJyk7XHJcblxyXG4gICAgICAvLyBEaXNhYmxlIHJlc2l6aW5nIGhhbmRsZXJzXHJcbiAgICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vZmYoJ3Jlc2l6ZScsIG9wdHMucmVzaXplRm4pO1xyXG4gICAgICBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdykub2ZmKCdvcmllbnRhdGlvbmNoYW5nZScsIG9wdHMucmVzaXplRm4pO1xyXG4gICAgICBvcHRzLnJlc2l6ZUZuID0gdW5kZWZpbmVkO1xyXG5cclxuICAgICAgLy8gV2FpdCBmb3IgYW5pbWF0ZSBvdXQsIHRoZW4gcmVtb3ZlIGZyb20gdGhlIERPTVxyXG4gICAgICByZXR1cm4gJG1kVXRpbC50cmFuc2l0aW9uRW5kUHJvbWlzZShlbGVtZW50LCB7IHRpbWVvdXQ6IDM1MCB9KS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21kLWFjdGl2ZScpO1xyXG4gICAgICAgIG9wdHMuYmFja2Ryb3AgJiYgb3B0cy5iYWNrZHJvcC5yZW1vdmUoKTtcclxuICAgICAgICBpZiAoZWxlbWVudFswXS5wYXJlbnROb2RlID09PSBvcHRzLnBhcmVudFswXSkge1xyXG4gICAgICAgICAgb3B0cy5wYXJlbnRbMF0ucmVtb3ZlQ2hpbGQoZWxlbWVudFswXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG9wdHMucmVzdG9yZVNjcm9sbCAmJiBvcHRzLnJlc3RvcmVTY3JvbGwoKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb21wdXRlcyBtZW51IHBvc2l0aW9uIGFuZCBzZXRzIHRoZSBzdHlsZSBvbiB0aGUgbWVudSBjb250YWluZXJcclxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsIC0gdGhlIG1lbnUgY29udGFpbmVyIGVsZW1lbnRcclxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvcHRzIC0gdGhlIGludGVyaW0gZWxlbWVudCBvcHRpb25zIG9iamVjdFxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBwb3NpdGlvbk1lbnUoZWwsIG9wdHMpIHtcclxuICAgICAgaWYgKG9wdHMuaXNSZW1vdmVkKSByZXR1cm47XHJcblxyXG4gICAgICB2YXIgY29udGFpbmVyTm9kZSA9IGVsWzBdLFxyXG4gICAgICAgICAgb3Blbk1lbnVOb2RlID0gZWxbMF0uZmlyc3RFbGVtZW50Q2hpbGQsXHJcbiAgICAgICAgICBvcGVuTWVudU5vZGVSZWN0ID0gb3Blbk1lbnVOb2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxyXG4gICAgICAgICAgYm91bmRyeU5vZGUgPSBvcHRzLnBhcmVudFswXSxcclxuICAgICAgICAgIGJvdW5kcnlOb2RlUmVjdCA9IGJvdW5kcnlOb2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuICAgICAgdmFyIG9yaWdpbk5vZGUgPSBvcHRzLnRhcmdldFswXS5xdWVyeVNlbGVjdG9yKCdbbWQtbWVudS1vcmlnaW5dJykgfHwgb3B0cy50YXJnZXRbMF0sXHJcbiAgICAgICAgICBvcmlnaW5Ob2RlUmVjdCA9IG9yaWdpbk5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcblxyXG5cclxuICAgICAgdmFyIGJvdW5kcyA9IHtcclxuICAgICAgICBsZWZ0OiBib3VuZHJ5Tm9kZVJlY3QubGVmdCArIE1FTlVfRURHRV9NQVJHSU4sXHJcbiAgICAgICAgdG9wOiBib3VuZHJ5Tm9kZVJlY3QudG9wICsgTUVOVV9FREdFX01BUkdJTixcclxuICAgICAgICBib3R0b206IGJvdW5kcnlOb2RlUmVjdC5ib3R0b20gLSBNRU5VX0VER0VfTUFSR0lOLFxyXG4gICAgICAgIHJpZ2h0OiBib3VuZHJ5Tm9kZVJlY3QucmlnaHQgLSBNRU5VX0VER0VfTUFSR0lOXHJcbiAgICAgIH07XHJcblxyXG5cclxuICAgICAgdmFyIGFsaWduVGFyZ2V0LCBhbGlnblRhcmdldFJlY3QsIGV4aXN0aW5nT2Zmc2V0cztcclxuICAgICAgdmFyIHBvc2l0aW9uTW9kZSA9IG9wdHMubWRNZW51Q3RybC5wb3NpdGlvbk1vZGUoKTtcclxuXHJcbiAgICAgIGlmIChwb3NpdGlvbk1vZGUudG9wID09ICd0YXJnZXQnIHx8IHBvc2l0aW9uTW9kZS5sZWZ0ID09ICd0YXJnZXQnIHx8IHBvc2l0aW9uTW9kZS5sZWZ0ID09ICd0YXJnZXQtcmlnaHQnKSB7XHJcbiAgICAgICAgLy8gVE9ETzogQWxsb3cgY2VudGVyaW5nIG9uIGFuIGFyYml0cmFyeSBub2RlLCBmb3Igbm93IGNlbnRlciBvbiBmaXJzdCBtZW51LWl0ZW0ncyBjaGlsZFxyXG4gICAgICAgIGFsaWduVGFyZ2V0ID0gb3Blbk1lbnVOb2RlLmZpcnN0RWxlbWVudENoaWxkLmZpcnN0RWxlbWVudENoaWxkIHx8IG9wZW5NZW51Tm9kZS5maXJzdEVsZW1lbnRDaGlsZDtcclxuICAgICAgICBhbGlnblRhcmdldCA9IGFsaWduVGFyZ2V0LnF1ZXJ5U2VsZWN0b3IoJ1ttZC1tZW51LWFsaWduLXRhcmdldF0nKSB8fCBhbGlnblRhcmdldDtcclxuICAgICAgICBhbGlnblRhcmdldFJlY3QgPSBhbGlnblRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcbiAgICAgICAgZXhpc3RpbmdPZmZzZXRzID0ge1xyXG4gICAgICAgICAgdG9wOiBwYXJzZUZsb2F0KGNvbnRhaW5lck5vZGUuc3R5bGUudG9wIHx8IDApLFxyXG4gICAgICAgICAgbGVmdDogcGFyc2VGbG9hdChjb250YWluZXJOb2RlLnN0eWxlLmxlZnQgfHwgMClcclxuICAgICAgICB9O1xyXG4gICAgICB9XHJcblxyXG4gICAgICB2YXIgcG9zaXRpb24gPSB7IH07XHJcbiAgICAgIHZhciB0cmFuc2Zvcm1PcmlnaW4gPSAndG9wICc7XHJcblxyXG4gICAgICBzd2l0Y2ggKHBvc2l0aW9uTW9kZS50b3ApIHtcclxuICAgICAgICBjYXNlICd0YXJnZXQnOlxyXG4gICAgICAgICAgcG9zaXRpb24udG9wID0gZXhpc3RpbmdPZmZzZXRzLnRvcCArIG9yaWdpbk5vZGVSZWN0LnRvcCAtIGFsaWduVGFyZ2V0UmVjdC50b3A7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICAvLyBGdXR1cmUgc3VwcG9ydCBmb3IgbWRNZW51QmFyXHJcbiAgICAgICAgLy8gY2FzZSAndG9wJzpcclxuICAgICAgICAvLyAgIHBvc2l0aW9uLnRvcCA9IG9yaWdpbk5vZGVSZWN0LnRvcDtcclxuICAgICAgICAvLyAgIGJyZWFrO1xyXG4gICAgICAgIC8vIGNhc2UgJ2JvdHRvbSc6XHJcbiAgICAgICAgLy8gICBwb3NpdGlvbi50b3AgPSBvcmlnaW5Ob2RlUmVjdC50b3AgKyBvcmlnaW5Ob2RlUmVjdC5oZWlnaHQ7XHJcbiAgICAgICAgLy8gICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHRhcmdldCBtb2RlIFwiJyArIHBvc2l0aW9uTW9kZS50b3AgKyAnXCIgc3BlY2lmaWVkIGZvciBtZC1tZW51IG9uIFkgYXhpcy4nKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgc3dpdGNoIChwb3NpdGlvbk1vZGUubGVmdCkge1xyXG4gICAgICAgIGNhc2UgJ3RhcmdldCc6XHJcbiAgICAgICAgICBwb3NpdGlvbi5sZWZ0ID0gZXhpc3RpbmdPZmZzZXRzLmxlZnQgKyBvcmlnaW5Ob2RlUmVjdC5sZWZ0IC0gYWxpZ25UYXJnZXRSZWN0LmxlZnQ7XHJcbiAgICAgICAgICB0cmFuc2Zvcm1PcmlnaW4gKz0gJ2xlZnQnO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAndGFyZ2V0LXJpZ2h0JzpcclxuICAgICAgICAgIHBvc2l0aW9uLmxlZnQgPSBvcmlnaW5Ob2RlUmVjdC5yaWdodCAtIG9wZW5NZW51Tm9kZVJlY3Qud2lkdGggKyAob3Blbk1lbnVOb2RlUmVjdC5yaWdodCAtIGFsaWduVGFyZ2V0UmVjdC5yaWdodCk7XHJcbiAgICAgICAgICB0cmFuc2Zvcm1PcmlnaW4gKz0gJ3JpZ2h0JztcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIC8vIEZ1dHVyZSBzdXBwb3J0IGZvciBtZE1lbnVCYXJcclxuICAgICAgICAvLyBjYXNlICdsZWZ0JzpcclxuICAgICAgICAvLyAgIHBvc2l0aW9uLmxlZnQgPSBvcmlnaW5Ob2RlUmVjdC5sZWZ0O1xyXG4gICAgICAgIC8vICAgdHJhbnNmb3JtT3JpZ2luICs9ICdsZWZ0JztcclxuICAgICAgICAvLyAgIGJyZWFrO1xyXG4gICAgICAgIC8vIGNhc2UgJ3JpZ2h0JzpcclxuICAgICAgICAvLyAgIHBvc2l0aW9uLmxlZnQgPSBvcmlnaW5Ob2RlUmVjdC5yaWdodCAtIGNvbnRhaW5lck5vZGUub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgLy8gICB0cmFuc2Zvcm1PcmlnaW4gKz0gJ3JpZ2h0JztcclxuICAgICAgICAvLyAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgdGFyZ2V0IG1vZGUgXCInICsgcG9zaXRpb25Nb2RlLmxlZnQgKyAnXCIgc3BlY2lmaWVkIGZvciBtZC1tZW51IG9uIFggYXhpcy4nKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIG9mZnNldHMgPSBvcHRzLm1kTWVudUN0cmwub2Zmc2V0cygpO1xyXG4gICAgICBwb3NpdGlvbi50b3AgKz0gb2Zmc2V0cy50b3A7XHJcbiAgICAgIHBvc2l0aW9uLmxlZnQgKz0gb2Zmc2V0cy5sZWZ0O1xyXG5cclxuICAgICAgY2xhbXAocG9zaXRpb24pO1xyXG5cclxuICAgICAgZWwuY3NzKHtcclxuICAgICAgICB0b3A6IHBvc2l0aW9uLnRvcCArICdweCcsXHJcbiAgICAgICAgbGVmdDogcG9zaXRpb24ubGVmdCArICdweCdcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBjb250YWluZXJOb2RlLnN0eWxlWyRtZENvbnN0YW50LkNTUy5UUkFOU0ZPUk1fT1JJR0lOXSA9IHRyYW5zZm9ybU9yaWdpbjtcclxuXHJcbiAgICAgIC8vIEFuaW1hdGUgYSBzY2FsZSBvdXQgaWYgd2UgYXJlbid0IGp1c3QgcmVwb3NpdGlvbmluZ1xyXG4gICAgICBpZiAoIW9wdHMuYWxyZWFkeU9wZW4pIHtcclxuICAgICAgICBjb250YWluZXJOb2RlLnN0eWxlWyRtZENvbnN0YW50LkNTUy5UUkFOU0ZPUk1dID0gJ3NjYWxlKCcgK1xyXG4gICAgICAgICAgTWF0aC5taW4ob3JpZ2luTm9kZVJlY3Qud2lkdGggLyBjb250YWluZXJOb2RlLm9mZnNldFdpZHRoLCAxLjApICsgJywnICtcclxuICAgICAgICAgIE1hdGgubWluKG9yaWdpbk5vZGVSZWN0LmhlaWdodCAvIGNvbnRhaW5lck5vZGUub2Zmc2V0SGVpZ2h0LCAxLjApICtcclxuICAgICAgICAnKSc7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiBDbGFtcHMgdGhlIHJlcG9zaXRpb25pbmcgb2YgdGhlIG1lbnUgd2l0aGluIHRoZSBjb25maW5lcyBvZlxyXG4gICAgICAgKiBib3VuZGluZyBlbGVtZW50IChvZnRlbiB0aGUgc2NyZWVuL2JvZHkpXHJcbiAgICAgICAqL1xyXG4gICAgICBmdW5jdGlvbiBjbGFtcChwb3MpIHtcclxuICAgICAgICBwb3MudG9wID0gTWF0aC5tYXgoTWF0aC5taW4ocG9zLnRvcCwgYm91bmRzLmJvdHRvbSAtIGNvbnRhaW5lck5vZGUub2Zmc2V0SGVpZ2h0KSwgYm91bmRzLnRvcCk7XHJcbiAgICAgICAgcG9zLmxlZnQgPSBNYXRoLm1heChNYXRoLm1pbihwb3MubGVmdCwgYm91bmRzLnJpZ2h0IC0gY29udGFpbmVyTm9kZS5vZmZzZXRXaWR0aCksIGJvdW5kcy5sZWZ0KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5NZW51UHJvdmlkZXIuJGluamVjdCA9IFtcIiQkaW50ZXJpbUVsZW1lbnRQcm92aWRlclwiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbW9kdWxlXHJcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMucHJvZ3Jlc3NDaXJjdWxhclxyXG4gKiBAZGVzY3JpcHRpb24gQ2lyY3VsYXIgUHJvZ3Jlc3MgbW9kdWxlIVxyXG4gKi9cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMucHJvZ3Jlc3NDaXJjdWxhcicsIFtcclxuICAnbWF0ZXJpYWwuY29yZSdcclxuXSlcclxuICAuZGlyZWN0aXZlKCdtZFByb2dyZXNzQ2lyY3VsYXInLCBNZFByb2dyZXNzQ2lyY3VsYXJEaXJlY3RpdmUpO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRQcm9ncmVzc0NpcmN1bGFyXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5wcm9ncmVzc0NpcmN1bGFyXHJcbiAqIEByZXN0cmljdCBFXHJcbiAqXHJcbiogQGRlc2NyaXB0aW9uXHJcbiAqIFRoZSBjaXJjdWxhciBwcm9ncmVzcyBkaXJlY3RpdmUgaXMgdXNlZCB0byBtYWtlIGxvYWRpbmcgY29udGVudCBpbiB5b3VyIGFwcCBhcyBkZWxpZ2h0ZnVsIGFuZFxyXG4gKiBwYWlubGVzcyBhcyBwb3NzaWJsZSBieSBtaW5pbWl6aW5nIHRoZSBhbW91bnQgb2YgdmlzdWFsIGNoYW5nZSBhIHVzZXIgc2VlcyBiZWZvcmUgdGhleSBjYW4gdmlld1xyXG4gKiBhbmQgaW50ZXJhY3Qgd2l0aCBjb250ZW50LlxyXG4gKlxyXG4gKiBGb3Igb3BlcmF0aW9ucyB3aGVyZSB0aGUgcGVyY2VudGFnZSBvZiB0aGUgb3BlcmF0aW9uIGNvbXBsZXRlZCBjYW4gYmUgZGV0ZXJtaW5lZCwgdXNlIGFcclxuICogZGV0ZXJtaW5hdGUgaW5kaWNhdG9yLiBUaGV5IGdpdmUgdXNlcnMgYSBxdWljayBzZW5zZSBvZiBob3cgbG9uZyBhbiBvcGVyYXRpb24gd2lsbCB0YWtlLlxyXG4gKlxyXG4gKiBGb3Igb3BlcmF0aW9ucyB3aGVyZSB0aGUgdXNlciBpcyBhc2tlZCB0byB3YWl0IGEgbW9tZW50IHdoaWxlIHNvbWV0aGluZyBmaW5pc2hlcyB1cCwgYW5kIGl04oCZc1xyXG4gKiBub3QgbmVjZXNzYXJ5IHRvIGV4cG9zZSB3aGF0J3MgaGFwcGVuaW5nIGJlaGluZCB0aGUgc2NlbmVzIGFuZCBob3cgbG9uZyBpdCB3aWxsIHRha2UsIHVzZSBhblxyXG4gKiBpbmRldGVybWluYXRlIGluZGljYXRvci5cclxuICpcclxuICogQHBhcmFtIHtzdHJpbmd9IG1kLW1vZGUgU2VsZWN0IGZyb20gb25lIG9mIHR3byBtb2RlczogZGV0ZXJtaW5hdGUgYW5kIGluZGV0ZXJtaW5hdGUuXHJcbiAqIEBwYXJhbSB7bnVtYmVyPX0gdmFsdWUgSW4gZGV0ZXJtaW5hdGUgbW9kZSwgdGhpcyBudW1iZXIgcmVwcmVzZW50cyB0aGUgcGVyY2VudGFnZSBvZiB0aGVcclxuICogICAgIGNpcmN1bGFyIHByb2dyZXNzLiBEZWZhdWx0OiAwXHJcbiAqIEBwYXJhbSB7bnVtYmVyPX0gbWQtZGlhbWV0ZXIgVGhpcyBzcGVjaWZpZXMgdGhlIGRpYW10ZXIgb2YgdGhlIGNpcmN1bGFyIHByb2dyZXNzLiBEZWZhdWx0OiA0OFxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPG1kLXByb2dyZXNzLWNpcmN1bGFyIG1kLW1vZGU9XCJkZXRlcm1pbmF0ZVwiIHZhbHVlPVwiLi4uXCI+PC9tZC1wcm9ncmVzcy1jaXJjdWxhcj5cclxuICpcclxuICogPG1kLXByb2dyZXNzLWNpcmN1bGFyIG1kLW1vZGU9XCJkZXRlcm1pbmF0ZVwiIG5nLXZhbHVlPVwiLi4uXCI+PC9tZC1wcm9ncmVzcy1jaXJjdWxhcj5cclxuICpcclxuICogPG1kLXByb2dyZXNzLWNpcmN1bGFyIG1kLW1vZGU9XCJkZXRlcm1pbmF0ZVwiIHZhbHVlPVwiLi4uXCIgbWQtZGlhbWV0ZXI9XCIxMDBcIj48L21kLXByb2dyZXNzLWNpcmN1bGFyPlxyXG4gKlxyXG4gKiA8bWQtcHJvZ3Jlc3MtY2lyY3VsYXIgbWQtbW9kZT1cImluZGV0ZXJtaW5hdGVcIj48L21kLXByb2dyZXNzLWNpcmN1bGFyPlxyXG4gKiA8L2hsanM+XHJcbiAqL1xyXG5mdW5jdGlvbiBNZFByb2dyZXNzQ2lyY3VsYXJEaXJlY3RpdmUoJG1kQ29uc3RhbnQsICRtZFRoZW1pbmcpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgIHRlbXBsYXRlOlxyXG4gICAgICAgIC8vIFRoZSBwcm9ncmVzcyAnY2lyY2xlJyBpcyBjb21wb3NlZCBvZiB0d28gaGFsZi1jaXJjbGVzOiB0aGUgbGVmdCBzaWRlIGFuZCB0aGUgcmlnaHRcclxuICAgICAgICAvLyBzaWRlLiBFYWNoIHNpZGUgaGFzIENTUyBhcHBsaWVkIHRvICdmaWxsLWluJyB0aGUgaGFsZi1jaXJjbGUgdG8gdGhlIGFwcHJvcHJpYXRlIHByb2dyZXNzLlxyXG4gICAgICAgICc8ZGl2IGNsYXNzPVwibWQtc3Bpbm5lci13cmFwcGVyXCI+JyArXHJcbiAgICAgICAgICAnPGRpdiBjbGFzcz1cIm1kLWlubmVyXCI+JyArXHJcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwibWQtZ2FwXCI+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwibWQtbGVmdFwiPicgK1xyXG4gICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwibWQtaGFsZi1jaXJjbGVcIj48L2Rpdj4nICtcclxuICAgICAgICAgICAgJzwvZGl2PicgK1xyXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cIm1kLXJpZ2h0XCI+JyArXHJcbiAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJtZC1oYWxmLWNpcmNsZVwiPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAnPC9kaXY+JyArXHJcbiAgICAgICAgICAnPC9kaXY+JyArXHJcbiAgICAgICAgJzwvZGl2PicsXHJcbiAgICBjb21waWxlOiBjb21waWxlXHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb24gY29tcGlsZSh0RWxlbWVudCkge1xyXG4gICAgLy8gVGhlIGphdmFzY3JpcHQgaW4gdGhpcyBmaWxlIGlzIG1haW5seSByZXNwb25zaWJsZSBmb3Igc2V0dGluZyB0aGUgY29ycmVjdCBhcmlhIGF0dHJpYnV0ZXMuXHJcbiAgICAvLyBUaGUgYW5pbWF0aW9uIG9mIHRoZSBwcm9ncmVzcyBzcGlubmVyIGlzIGRvbmUgZW50aXJlbHkgd2l0aCBqdXN0IENTUy5cclxuICAgIHRFbGVtZW50LmF0dHIoJ2FyaWEtdmFsdWVtaW4nLCAwKTtcclxuICAgIHRFbGVtZW50LmF0dHIoJ2FyaWEtdmFsdWVtYXgnLCAxMDApO1xyXG4gICAgdEVsZW1lbnQuYXR0cigncm9sZScsICdwcm9ncmVzc2JhcicpO1xyXG5cclxuICAgIHJldHVybiBwb3N0TGluaztcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XHJcbiAgICAkbWRUaGVtaW5nKGVsZW1lbnQpO1xyXG4gICAgdmFyIGNpcmNsZSA9IGVsZW1lbnRbMF07XHJcblxyXG4gICAgLy8gU2NhbGUgdGhlIHByb2dyZXNzIGNpcmNsZSBiYXNlZCBvbiB0aGUgZGVmYXVsdCBkaWFtZXRlci5cclxuICAgIHZhciBkaWFtZXRlciA9IGF0dHIubWREaWFtZXRlciB8fCA0ODtcclxuICAgIHZhciBzY2FsZSA9IGRpYW1ldGVyIC8gNDg7XHJcbiAgICBjaXJjbGUuc3R5bGVbJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STV0gPSAnc2NhbGUoJyArIHNjYWxlICsgJyknO1xyXG5cclxuICAgIGF0dHIuJG9ic2VydmUoJ3ZhbHVlJywgZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgdmFyIHBlcmNlbnRWYWx1ZSA9IGNsYW1wKHZhbHVlKTtcclxuICAgICAgZWxlbWVudC5hdHRyKCdhcmlhLXZhbHVlbm93JywgcGVyY2VudFZhbHVlKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2xhbXBzIHRoZSB2YWx1ZSB0byBiZSBiZXR3ZWVuIDAgYW5kIDEwMC5cclxuICAgKiBAcGFyYW0ge251bWJlcn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNsYW1wLlxyXG4gICAqIEByZXR1cm5zIHtudW1iZXJ9XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gY2xhbXAodmFsdWUpIHtcclxuICAgIHJldHVybiBNYXRoLm1heCgwLCBNYXRoLm1pbih2YWx1ZSB8fCAwLCAxMDApKTtcclxuICB9XHJcbn1cclxuTWRQcm9ncmVzc0NpcmN1bGFyRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkbWRDb25zdGFudFwiLCBcIiRtZFRoZW1pbmdcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKipcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLnByb2dyZXNzTGluZWFyXHJcbiAqIEBkZXNjcmlwdGlvbiBMaW5lYXIgUHJvZ3Jlc3MgbW9kdWxlIVxyXG4gKi9cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMucHJvZ3Jlc3NMaW5lYXInLCBbXHJcbiAgJ21hdGVyaWFsLmNvcmUnXHJcbl0pXHJcbiAgLmRpcmVjdGl2ZSgnbWRQcm9ncmVzc0xpbmVhcicsIE1kUHJvZ3Jlc3NMaW5lYXJEaXJlY3RpdmUpO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRQcm9ncmVzc0xpbmVhclxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMucHJvZ3Jlc3NMaW5lYXJcclxuICogQHJlc3RyaWN0IEVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIFRoZSBsaW5lYXIgcHJvZ3Jlc3MgZGlyZWN0aXZlIGlzIHVzZWQgdG8gbWFrZSBsb2FkaW5nIGNvbnRlbnQgaW4geW91ciBhcHAgYXMgZGVsaWdodGZ1bCBhbmQgcGFpbmxlc3MgYXMgcG9zc2libGUgYnkgbWluaW1pemluZyB0aGUgYW1vdW50IG9mIHZpc3VhbCBjaGFuZ2UgYSB1c2VyIHNlZXMgYmVmb3JlIHRoZXkgY2FuIHZpZXcgYW5kIGludGVyYWN0IHdpdGggY29udGVudC4gRWFjaCBvcGVyYXRpb24gc2hvdWxkIG9ubHkgYmUgcmVwcmVzZW50ZWQgYnkgb25lIGFjdGl2aXR5IGluZGljYXRvcuKAlGZvciBleGFtcGxlLCBvbmUgcmVmcmVzaCBvcGVyYXRpb24gc2hvdWxkIG5vdCBkaXNwbGF5IGJvdGggYSByZWZyZXNoIGJhciBhbmQgYW4gYWN0aXZpdHkgY2lyY2xlLlxyXG4gKlxyXG4gKiBGb3Igb3BlcmF0aW9ucyB3aGVyZSB0aGUgcGVyY2VudGFnZSBvZiB0aGUgb3BlcmF0aW9uIGNvbXBsZXRlZCBjYW4gYmUgZGV0ZXJtaW5lZCwgdXNlIGEgZGV0ZXJtaW5hdGUgaW5kaWNhdG9yLiBUaGV5IGdpdmUgdXNlcnMgYSBxdWljayBzZW5zZSBvZiBob3cgbG9uZyBhbiBvcGVyYXRpb24gd2lsbCB0YWtlLlxyXG4gKlxyXG4gKiBGb3Igb3BlcmF0aW9ucyB3aGVyZSB0aGUgdXNlciBpcyBhc2tlZCB0byB3YWl0IGEgbW9tZW50IHdoaWxlIHNvbWV0aGluZyBmaW5pc2hlcyB1cCwgYW5kIGl04oCZcyBub3QgbmVjZXNzYXJ5IHRvIGV4cG9zZSB3aGF0J3MgaGFwcGVuaW5nIGJlaGluZCB0aGUgc2NlbmVzIGFuZCBob3cgbG9uZyBpdCB3aWxsIHRha2UsIHVzZSBhbiBpbmRldGVybWluYXRlIGluZGljYXRvci5cclxuICpcclxuICogQHBhcmFtIHtzdHJpbmd9IG1kLW1vZGUgU2VsZWN0IGZyb20gb25lIG9mIGZvdXIgbW9kZXM6IGRldGVybWluYXRlLCBpbmRldGVybWluYXRlLCBidWZmZXIgb3IgcXVlcnkuXHJcbiAqIEBwYXJhbSB7bnVtYmVyPX0gdmFsdWUgSW4gZGV0ZXJtaW5hdGUgYW5kIGJ1ZmZlciBtb2RlcywgdGhpcyBudW1iZXIgcmVwcmVzZW50cyB0aGUgcGVyY2VudGFnZSBvZiB0aGUgcHJpbWFyeSBwcm9ncmVzcyBiYXIuIERlZmF1bHQ6IDBcclxuICogQHBhcmFtIHtudW1iZXI9fSBtZC1idWZmZXItdmFsdWUgSW4gdGhlIGJ1ZmZlciBtb2RlLCB0aGlzIG51bWJlciByZXByZXNlbnRzIHRoZSBwcmVjZW50YWdlIG9mIHRoZSBzZWNvbmRhcnkgcHJvZ3Jlc3MgYmFyLiBEZWZhdWx0OiAwXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtcHJvZ3Jlc3MtbGluZWFyIG1kLW1vZGU9XCJkZXRlcm1pbmF0ZVwiIHZhbHVlPVwiLi4uXCI+PC9tZC1wcm9ncmVzcy1saW5lYXI+XHJcbiAqXHJcbiAqIDxtZC1wcm9ncmVzcy1saW5lYXIgbWQtbW9kZT1cImRldGVybWluYXRlXCIgbmctdmFsdWU9XCIuLi5cIj48L21kLXByb2dyZXNzLWxpbmVhcj5cclxuICpcclxuICogPG1kLXByb2dyZXNzLWxpbmVhciBtZC1tb2RlPVwiaW5kZXRlcm1pbmF0ZVwiPjwvbWQtcHJvZ3Jlc3MtbGluZWFyPlxyXG4gKlxyXG4gKiA8bWQtcHJvZ3Jlc3MtbGluZWFyIG1kLW1vZGU9XCJidWZmZXJcIiB2YWx1ZT1cIi4uLlwiIG1kLWJ1ZmZlci12YWx1ZT1cIi4uLlwiPjwvbWQtcHJvZ3Jlc3MtbGluZWFyPlxyXG4gKlxyXG4gKiA8bWQtcHJvZ3Jlc3MtbGluZWFyIG1kLW1vZGU9XCJxdWVyeVwiPjwvbWQtcHJvZ3Jlc3MtbGluZWFyPlxyXG4gKiA8L2hsanM+XHJcbiAqL1xyXG5mdW5jdGlvbiBNZFByb2dyZXNzTGluZWFyRGlyZWN0aXZlKCQkckFGLCAkbWRDb25zdGFudCwgJG1kVGhlbWluZykge1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgIHRlbXBsYXRlOiAnPGRpdiBjbGFzcz1cIm1kLWNvbnRhaW5lclwiPicgK1xyXG4gICAgICAnPGRpdiBjbGFzcz1cIm1kLWRhc2hlZFwiPjwvZGl2PicgK1xyXG4gICAgICAnPGRpdiBjbGFzcz1cIm1kLWJhciBtZC1iYXIxXCI+PC9kaXY+JyArXHJcbiAgICAgICc8ZGl2IGNsYXNzPVwibWQtYmFyIG1kLWJhcjJcIj48L2Rpdj4nICtcclxuICAgICAgJzwvZGl2PicsXHJcbiAgICBjb21waWxlOiBjb21waWxlXHJcbiAgfTtcclxuICBcclxuICBmdW5jdGlvbiBjb21waWxlKHRFbGVtZW50LCB0QXR0cnMsIHRyYW5zY2x1ZGUpIHtcclxuICAgIHRFbGVtZW50LmF0dHIoJ2FyaWEtdmFsdWVtaW4nLCAwKTtcclxuICAgIHRFbGVtZW50LmF0dHIoJ2FyaWEtdmFsdWVtYXgnLCAxMDApO1xyXG4gICAgdEVsZW1lbnQuYXR0cigncm9sZScsICdwcm9ncmVzc2JhcicpO1xyXG5cclxuICAgIHJldHVybiBwb3N0TGluaztcclxuICB9XHJcbiAgZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcclxuICAgICRtZFRoZW1pbmcoZWxlbWVudCk7XHJcbiAgICB2YXIgYmFyMVN0eWxlID0gZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCcubWQtYmFyMScpLnN0eWxlLFxyXG4gICAgICBiYXIyU3R5bGUgPSBlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJy5tZC1iYXIyJykuc3R5bGUsXHJcbiAgICAgIGNvbnRhaW5lciA9IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJy5tZC1jb250YWluZXInKSk7XHJcblxyXG4gICAgYXR0ci4kb2JzZXJ2ZSgndmFsdWUnLCBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICBpZiAoYXR0ci5tZE1vZGUgPT0gJ3F1ZXJ5Jykge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIGNsYW1wZWQgPSBjbGFtcCh2YWx1ZSk7XHJcbiAgICAgIGVsZW1lbnQuYXR0cignYXJpYS12YWx1ZW5vdycsIGNsYW1wZWQpO1xyXG4gICAgICBiYXIyU3R5bGVbJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STV0gPSB0cmFuc2Zvcm1zW2NsYW1wZWRdO1xyXG4gICAgfSk7XHJcblxyXG4gICAgYXR0ci4kb2JzZXJ2ZSgnbWRCdWZmZXJWYWx1ZScsIGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgIGJhcjFTdHlsZVskbWRDb25zdGFudC5DU1MuVFJBTlNGT1JNXSA9IHRyYW5zZm9ybXNbY2xhbXAodmFsdWUpXTtcclxuICAgIH0pO1xyXG5cclxuICAgICQkckFGKGZ1bmN0aW9uKCkge1xyXG4gICAgICBjb250YWluZXIuYWRkQ2xhc3MoJ21kLXJlYWR5Jyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNsYW1wKHZhbHVlKSB7XHJcbiAgICBpZiAodmFsdWUgPiAxMDApIHtcclxuICAgICAgcmV0dXJuIDEwMDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodmFsdWUgPCAwKSB7XHJcbiAgICAgIHJldHVybiAwO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBNYXRoLmNlaWwodmFsdWUgfHwgMCk7XHJcbiAgfVxyXG59XHJcbk1kUHJvZ3Jlc3NMaW5lYXJEaXJlY3RpdmUuJGluamVjdCA9IFtcIiQkckFGXCIsIFwiJG1kQ29uc3RhbnRcIiwgXCIkbWRUaGVtaW5nXCJdO1xyXG5cclxuXHJcbi8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuLy8gUHJpdmF0ZSBNZXRob2RzXHJcbi8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxudmFyIHRyYW5zZm9ybXMgPSAoZnVuY3Rpb24oKSB7XHJcbiAgdmFyIHZhbHVlcyA9IG5ldyBBcnJheSgxMDEpO1xyXG4gIGZvcih2YXIgaSA9IDA7IGkgPCAxMDE7IGkrKyl7XHJcbiAgICB2YWx1ZXNbaV0gPSBtYWtlVHJhbnNmb3JtKGkpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHZhbHVlcztcclxuXHJcbiAgZnVuY3Rpb24gbWFrZVRyYW5zZm9ybSh2YWx1ZSl7XHJcbiAgICB2YXIgc2NhbGUgPSB2YWx1ZS8xMDA7XHJcbiAgICB2YXIgdHJhbnNsYXRlWCA9ICh2YWx1ZS0xMDApLzI7XHJcbiAgICByZXR1cm4gJ3RyYW5zbGF0ZVgoJyArIHRyYW5zbGF0ZVgudG9TdHJpbmcoKSArICclKSBzY2FsZSgnICsgc2NhbGUudG9TdHJpbmcoKSArICcsIDEpJztcclxuICB9XHJcbn0pKCk7XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKipcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLnJhZGlvQnV0dG9uXHJcbiAqIEBkZXNjcmlwdGlvbiByYWRpb0J1dHRvbiBtb2R1bGUhXHJcbiAqL1xyXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5yYWRpb0J1dHRvbicsIFtcclxuICAnbWF0ZXJpYWwuY29yZSdcclxuXSlcclxuICAuZGlyZWN0aXZlKCdtZFJhZGlvR3JvdXAnLCBtZFJhZGlvR3JvdXBEaXJlY3RpdmUpXHJcbiAgLmRpcmVjdGl2ZSgnbWRSYWRpb0J1dHRvbicsIG1kUmFkaW9CdXR0b25EaXJlY3RpdmUpO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnJhZGlvQnV0dG9uXHJcbiAqIEBuYW1lIG1kUmFkaW9Hcm91cFxyXG4gKlxyXG4gKiBAcmVzdHJpY3QgRVxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogVGhlIGA8bWQtcmFkaW8tZ3JvdXA+YCBkaXJlY3RpdmUgaWRlbnRpZmllcyBhIGdyb3VwaW5nXHJcbiAqIGNvbnRhaW5lciBmb3IgdGhlIDEuLm4gZ3JvdXBlZCByYWRpbyBidXR0b25zOyBzcGVjaWZpZWQgdXNpbmcgbmVzdGVkXHJcbiAqIGA8bWQtcmFkaW8tYnV0dG9uPmAgdGFncy5cclxuICpcclxuICogQXMgcGVyIHRoZSBbbWF0ZXJpYWwgZGVzaWduIHNwZWNdKGh0dHA6Ly93d3cuZ29vZ2xlLmNvbS9kZXNpZ24vc3BlYy9zdHlsZS9jb2xvci5odG1sI2NvbG9yLXVpLWNvbG9yLWFwcGxpY2F0aW9uKVxyXG4gKiB0aGUgcmFkaW8gYnV0dG9uIGlzIGluIHRoZSBhY2NlbnQgY29sb3IgYnkgZGVmYXVsdC4gVGhlIHByaW1hcnkgY29sb3IgcGFsZXR0ZSBtYXkgYmUgdXNlZCB3aXRoXHJcbiAqIHRoZSBgbWQtcHJpbWFyeWAgY2xhc3MuXHJcbiAqXHJcbiAqIE5vdGU6IGA8bWQtcmFkaW8tZ3JvdXA+YCBhbmQgYDxtZC1yYWRpby1idXR0b24+YCBoYW5kbGUgdGFiaW5kZXggZGlmZmVyZW50bHlcclxuICogdGhhbiB0aGUgbmF0aXZlIGA8aW5wdXQgdHlwZT0ncmFkaW8nPmAgY29udHJvbHMuIFdoZXJlYXMgdGhlIG5hdGl2ZSBjb250cm9sc1xyXG4gKiBmb3JjZSB0aGUgdXNlciB0byB0YWIgdGhyb3VnaCBhbGwgdGhlIHJhZGlvIGJ1dHRvbnMsIGA8bWQtcmFkaW8tZ3JvdXA+YFxyXG4gKiBpcyBmb2N1c2FibGUsIGFuZCBieSBkZWZhdWx0IHRoZSBgPG1kLXJhZGlvLWJ1dHRvbj5gcyBhcmUgbm90LlxyXG4gKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gbmctbW9kZWwgQXNzaWduYWJsZSBhbmd1bGFyIGV4cHJlc3Npb24gdG8gZGF0YS1iaW5kIHRvLlxyXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBtZC1uby1pbmsgVXNlIG9mIGF0dHJpYnV0ZSBpbmRpY2F0ZXMgZmxhZyB0byBkaXNhYmxlIGluayByaXBwbGUgZWZmZWN0cy5cclxuICpcclxuICogQHVzYWdlXHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqIDxtZC1yYWRpby1ncm91cCBuZy1tb2RlbD1cInNlbGVjdGVkXCI+XHJcbiAqXHJcbiAqICAgPG1kLXJhZGlvLWJ1dHRvblxyXG4gKiAgICAgICAgbmctcmVwZWF0PVwiZCBpbiBjb2xvck9wdGlvbnNcIlxyXG4gKiAgICAgICAgbmctdmFsdWU9XCJkLnZhbHVlXCIgYXJpYS1sYWJlbD1cInt7IGQubGFiZWwgfX1cIj5cclxuICpcclxuICogICAgICAgICAge3sgZC5sYWJlbCB9fVxyXG4gKlxyXG4gKiAgIDwvbWQtcmFkaW8tYnV0dG9uPlxyXG4gKlxyXG4gKiA8L21kLXJhZGlvLWdyb3VwPlxyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqL1xyXG5mdW5jdGlvbiBtZFJhZGlvR3JvdXBEaXJlY3RpdmUoJG1kVXRpbCwgJG1kQ29uc3RhbnQsICRtZFRoZW1pbmcsICR0aW1lb3V0KSB7XHJcbiAgUmFkaW9Hcm91cENvbnRyb2xsZXIucHJvdG90eXBlID0gY3JlYXRlUmFkaW9Hcm91cENvbnRyb2xsZXJQcm90bygpO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgIGNvbnRyb2xsZXI6IFsnJGVsZW1lbnQnLCBSYWRpb0dyb3VwQ29udHJvbGxlcl0sXHJcbiAgICByZXF1aXJlOiBbJ21kUmFkaW9Hcm91cCcsICc/bmdNb2RlbCddLFxyXG4gICAgbGluazogeyBwcmU6IGxpbmtSYWRpb0dyb3VwIH1cclxuICB9O1xyXG5cclxuICBmdW5jdGlvbiBsaW5rUmFkaW9Hcm91cChzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybHMpIHtcclxuICAgICRtZFRoZW1pbmcoZWxlbWVudCk7XHJcbiAgICB2YXIgcmdDdHJsID0gY3RybHNbMF07XHJcbiAgICB2YXIgbmdNb2RlbEN0cmwgPSBjdHJsc1sxXSB8fCAkbWRVdGlsLmZha2VOZ01vZGVsKCk7XHJcblxyXG4gICAgZnVuY3Rpb24gc2V0Rm9jdXMoKSB7XHJcbiAgICAgIGlmICghZWxlbWVudC5oYXNDbGFzcygnbWQtZm9jdXNlZCcpKSB7IGVsZW1lbnQuYWRkQ2xhc3MoJ21kLWZvY3VzZWQnKTsgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGtleWRvd25MaXN0ZW5lcihldikge1xyXG4gICAgICB2YXIga2V5Q29kZSA9IGV2LndoaWNoIHx8IGV2LmtleUNvZGU7XHJcbiAgICAgIHN3aXRjaChrZXlDb2RlKSB7XHJcbiAgICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5MRUZUX0FSUk9XOlxyXG4gICAgICAgIGNhc2UgJG1kQ29uc3RhbnQuS0VZX0NPREUuVVBfQVJST1c6XHJcbiAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgcmdDdHJsLnNlbGVjdFByZXZpb3VzKCk7XHJcbiAgICAgICAgICBzZXRGb2N1cygpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIGNhc2UgJG1kQ29uc3RhbnQuS0VZX0NPREUuUklHSFRfQVJST1c6XHJcbiAgICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5ET1dOX0FSUk9XOlxyXG4gICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgIHJnQ3RybC5zZWxlY3ROZXh0KCk7XHJcbiAgICAgICAgICBzZXRGb2N1cygpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIGNhc2UgJG1kQ29uc3RhbnQuS0VZX0NPREUuRU5URVI6XHJcbiAgICAgICAgICB2YXIgZm9ybSA9IGFuZ3VsYXIuZWxlbWVudCgkbWRVdGlsLmdldENsb3Nlc3QoZWxlbWVudFswXSwgJ2Zvcm0nKSk7XHJcbiAgICAgICAgICBpZiAoZm9ybS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGZvcm0udHJpZ2dlckhhbmRsZXIoJ3N1Ym1pdCcpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZ0N0cmwuaW5pdChuZ01vZGVsQ3RybCk7XHJcblxyXG4gICAgc2NvcGUubW91c2VBY3RpdmUgPSBmYWxzZTtcclxuICAgIGVsZW1lbnQuYXR0cih7XHJcbiAgICAgICAgICAgICAgJ3JvbGUnOiAncmFkaW9ncm91cCcsXHJcbiAgICAgICAgICAgICAgJ3RhYkluZGV4JzogZWxlbWVudC5hdHRyKCd0YWJpbmRleCcpIHx8ICcwJ1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAub24oJ2tleWRvd24nLCBrZXlkb3duTGlzdGVuZXIpXHJcbiAgICAgICAgICAgIC5vbignbW91c2Vkb3duJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgICBzY29wZS5tb3VzZUFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBzY29wZS5tb3VzZUFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIH0sIDEwMCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5vbignZm9jdXMnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICBpZihzY29wZS5tb3VzZUFjdGl2ZSA9PT0gZmFsc2UpIHsgcmdDdHJsLiRlbGVtZW50LmFkZENsYXNzKCdtZC1mb2N1c2VkJyk7IH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLm9uKCdibHVyJywgZnVuY3Rpb24oKSB7IHJnQ3RybC4kZWxlbWVudC5yZW1vdmVDbGFzcygnbWQtZm9jdXNlZCcpOyB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIFJhZGlvR3JvdXBDb250cm9sbGVyKCRlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9yYWRpb0J1dHRvblJlbmRlckZucyA9IFtdO1xyXG4gICAgdGhpcy4kZWxlbWVudCA9ICRlbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gY3JlYXRlUmFkaW9Hcm91cENvbnRyb2xsZXJQcm90bygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGluaXQ6IGZ1bmN0aW9uKG5nTW9kZWxDdHJsKSB7XHJcbiAgICAgICAgdGhpcy5fbmdNb2RlbEN0cmwgPSBuZ01vZGVsQ3RybDtcclxuICAgICAgICB0aGlzLl9uZ01vZGVsQ3RybC4kcmVuZGVyID0gYW5ndWxhci5iaW5kKHRoaXMsIHRoaXMucmVuZGVyKTtcclxuICAgICAgfSxcclxuICAgICAgYWRkOiBmdW5jdGlvbihyYlJlbmRlcikge1xyXG4gICAgICAgIHRoaXMuX3JhZGlvQnV0dG9uUmVuZGVyRm5zLnB1c2gocmJSZW5kZXIpO1xyXG4gICAgICB9LFxyXG4gICAgICByZW1vdmU6IGZ1bmN0aW9uKHJiUmVuZGVyKSB7XHJcbiAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5fcmFkaW9CdXR0b25SZW5kZXJGbnMuaW5kZXhPZihyYlJlbmRlcik7XHJcbiAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xyXG4gICAgICAgICAgdGhpcy5fcmFkaW9CdXR0b25SZW5kZXJGbnMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fcmFkaW9CdXR0b25SZW5kZXJGbnMuZm9yRWFjaChmdW5jdGlvbihyYlJlbmRlcikge1xyXG4gICAgICAgICAgcmJSZW5kZXIoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSxcclxuICAgICAgc2V0Vmlld1ZhbHVlOiBmdW5jdGlvbih2YWx1ZSwgZXZlbnRUeXBlKSB7XHJcbiAgICAgICAgdGhpcy5fbmdNb2RlbEN0cmwuJHNldFZpZXdWYWx1ZSh2YWx1ZSwgZXZlbnRUeXBlKTtcclxuICAgICAgICAvLyB1cGRhdGUgdGhlIG90aGVyIHJhZGlvIGJ1dHRvbnMgYXMgd2VsbFxyXG4gICAgICAgIHRoaXMucmVuZGVyKCk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGdldFZpZXdWYWx1ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX25nTW9kZWxDdHJsLiR2aWV3VmFsdWU7XHJcbiAgICAgIH0sXHJcbiAgICAgIHNlbGVjdE5leHQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBjaGFuZ2VTZWxlY3RlZEJ1dHRvbih0aGlzLiRlbGVtZW50LCAxKTtcclxuICAgICAgfSxcclxuICAgICAgc2VsZWN0UHJldmlvdXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBjaGFuZ2VTZWxlY3RlZEJ1dHRvbih0aGlzLiRlbGVtZW50LCAtMSk7XHJcbiAgICAgIH0sXHJcbiAgICAgIHNldEFjdGl2ZURlc2NlbmRhbnQ6IGZ1bmN0aW9uIChyYWRpb0lkKSB7XHJcbiAgICAgICAgdGhpcy4kZWxlbWVudC5hdHRyKCdhcmlhLWFjdGl2ZWRlc2NlbmRhbnQnLCByYWRpb0lkKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICogQ2hhbmdlIHRoZSByYWRpbyBncm91cCdzIHNlbGVjdGVkIGJ1dHRvbiBieSBhIGdpdmVuIGluY3JlbWVudC5cclxuICAgKiBJZiBubyBidXR0b24gaXMgc2VsZWN0ZWQsIHNlbGVjdCB0aGUgZmlyc3QgYnV0dG9uLlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGNoYW5nZVNlbGVjdGVkQnV0dG9uKHBhcmVudCwgaW5jcmVtZW50KSB7XHJcbiAgICAvLyBDb2VyY2UgYWxsIGNoaWxkIHJhZGlvIGJ1dHRvbnMgaW50byBhbiBhcnJheSwgdGhlbiB3cmFwIHRoZW4gaW4gYW4gaXRlcmF0b3JcclxuICAgIHZhciBidXR0b25zID0gJG1kVXRpbC5pdGVyYXRvcihwYXJlbnRbMF0ucXVlcnlTZWxlY3RvckFsbCgnbWQtcmFkaW8tYnV0dG9uJyksIHRydWUpO1xyXG5cclxuICAgIGlmIChidXR0b25zLmNvdW50KCkpIHtcclxuICAgICAgdmFyIHZhbGlkYXRlID0gZnVuY3Rpb24gKGJ1dHRvbikge1xyXG4gICAgICAgIC8vIElmIGRpc2FibGVkLCB0aGVuIE5PVCB2YWxpZFxyXG4gICAgICAgIHJldHVybiAhYW5ndWxhci5lbGVtZW50KGJ1dHRvbikuYXR0cihcImRpc2FibGVkXCIpO1xyXG4gICAgICB9O1xyXG4gICAgICB2YXIgc2VsZWN0ZWQgPSBwYXJlbnRbMF0ucXVlcnlTZWxlY3RvcignbWQtcmFkaW8tYnV0dG9uLm1kLWNoZWNrZWQnKTtcclxuICAgICAgdmFyIHRhcmdldCA9IGJ1dHRvbnNbaW5jcmVtZW50IDwgMCA/ICdwcmV2aW91cycgOiAnbmV4dCddKHNlbGVjdGVkLCB2YWxpZGF0ZSkgfHwgYnV0dG9ucy5maXJzdCgpO1xyXG4gICAgICAvLyBBY3RpdmF0ZSByYWRpb0J1dHRvbidzIGNsaWNrIGxpc3RlbmVyICh0cmlnZ2VySGFuZGxlciB3b24ndCBjcmVhdGUgYSByZWFsIGNsaWNrIGV2ZW50KVxyXG4gICAgICBhbmd1bGFyLmVsZW1lbnQodGFyZ2V0KS50cmlnZ2VySGFuZGxlcignY2xpY2snKTtcclxuXHJcblxyXG4gICAgfVxyXG4gIH1cclxuXHJcbn1cclxubWRSYWRpb0dyb3VwRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkbWRVdGlsXCIsIFwiJG1kQ29uc3RhbnRcIiwgXCIkbWRUaGVtaW5nXCIsIFwiJHRpbWVvdXRcIl07XHJcblxyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMucmFkaW9CdXR0b25cclxuICogQG5hbWUgbWRSYWRpb0J1dHRvblxyXG4gKlxyXG4gKiBAcmVzdHJpY3QgRVxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogVGhlIGA8bWQtcmFkaW8tYnV0dG9uPmBkaXJlY3RpdmUgaXMgdGhlIGNoaWxkIGRpcmVjdGl2ZSByZXF1aXJlZCB0byBiZSB1c2VkIHdpdGhpbiBgPG1kLXJhZGlvLWdyb3VwPmAgZWxlbWVudHMuXHJcbiAqXHJcbiAqIFdoaWxlIHNpbWlsYXIgdG8gdGhlIGA8aW5wdXQgdHlwZT1cInJhZGlvXCIgbmctbW9kZWw9XCJcIiB2YWx1ZT1cIlwiPmAgZGlyZWN0aXZlLFxyXG4gKiB0aGUgYDxtZC1yYWRpby1idXR0b24+YCBkaXJlY3RpdmUgcHJvdmlkZXMgaW5rIGVmZmVjdHMsIEFSSUEgc3VwcG9ydCwgYW5kXHJcbiAqIHN1cHBvcnRzIHVzZSB3aXRoaW4gbmFtZWQgcmFkaW8gZ3JvdXBzLlxyXG4gKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gbmdNb2RlbCBBc3NpZ25hYmxlIGFuZ3VsYXIgZXhwcmVzc2lvbiB0byBkYXRhLWJpbmQgdG8uXHJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gbmdDaGFuZ2UgQW5ndWxhciBleHByZXNzaW9uIHRvIGJlIGV4ZWN1dGVkIHdoZW4gaW5wdXQgY2hhbmdlcyBkdWUgdG8gdXNlclxyXG4gKiAgICBpbnRlcmFjdGlvbiB3aXRoIHRoZSBpbnB1dCBlbGVtZW50LlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gbmdWYWx1ZSBBbmd1bGFyIGV4cHJlc3Npb24gd2hpY2ggc2V0cyB0aGUgdmFsdWUgdG8gd2hpY2ggdGhlIGV4cHJlc3Npb24gc2hvdWxkXHJcbiAqICAgIGJlIHNldCB3aGVuIHNlbGVjdGVkLipcclxuICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlIFRoZSB2YWx1ZSB0byB3aGljaCB0aGUgZXhwcmVzc2lvbiBzaG91bGQgYmUgc2V0IHdoZW4gc2VsZWN0ZWQuXHJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gbmFtZSBQcm9wZXJ0eSBuYW1lIG9mIHRoZSBmb3JtIHVuZGVyIHdoaWNoIHRoZSBjb250cm9sIGlzIHB1Ymxpc2hlZC5cclxuICogQHBhcmFtIHtzdHJpbmc9fSBhcmlhLWxhYmVsIEFkZHMgbGFiZWwgdG8gcmFkaW8gYnV0dG9uIGZvciBhY2Nlc3NpYmlsaXR5LlxyXG4gKiBEZWZhdWx0cyB0byByYWRpbyBidXR0b24ncyB0ZXh0LiBJZiBubyB0ZXh0IGNvbnRlbnQgaXMgYXZhaWxhYmxlLCBhIHdhcm5pbmcgd2lsbCBiZSBsb2dnZWQuXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKlxyXG4gKiA8bWQtcmFkaW8tYnV0dG9uIHZhbHVlPVwiMVwiIGFyaWEtbGFiZWw9XCJMYWJlbCAxXCI+XHJcbiAqICAgTGFiZWwgMVxyXG4gKiA8L21kLXJhZGlvLWJ1dHRvbj5cclxuICpcclxuICogPG1kLXJhZGlvLWJ1dHRvbiBuZy1tb2RlbD1cImNvbG9yXCIgbmctdmFsdWU9XCJzcGVjaWFsVmFsdWVcIiBhcmlhLWxhYmVsPVwiR3JlZW5cIj5cclxuICogICBHcmVlblxyXG4gKiA8L21kLXJhZGlvLWJ1dHRvbj5cclxuICpcclxuICogPC9obGpzPlxyXG4gKlxyXG4gKi9cclxuZnVuY3Rpb24gbWRSYWRpb0J1dHRvbkRpcmVjdGl2ZSgkbWRBcmlhLCAkbWRVdGlsLCAkbWRUaGVtaW5nKSB7XHJcblxyXG4gIHZhciBDSEVDS0VEX0NTUyA9ICdtZC1jaGVja2VkJztcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICByZXF1aXJlOiAnXm1kUmFkaW9Hcm91cCcsXHJcbiAgICB0cmFuc2NsdWRlOiB0cnVlLFxyXG4gICAgdGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwibWQtY29udGFpbmVyXCIgbWQtaW5rLXJpcHBsZSBtZC1pbmstcmlwcGxlLWNoZWNrYm94PicgK1xyXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJtZC1vZmZcIj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwibWQtb25cIj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAnPC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgJzxkaXYgbmctdHJhbnNjbHVkZSBjbGFzcz1cIm1kLWxhYmVsXCI+PC9kaXY+JyxcclxuICAgIGxpbms6IGxpbmtcclxuICB9O1xyXG5cclxuICBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyLCByZ0N0cmwpIHtcclxuICAgIHZhciBsYXN0Q2hlY2tlZDtcclxuXHJcbiAgICAkbWRUaGVtaW5nKGVsZW1lbnQpO1xyXG4gICAgY29uZmlndXJlQXJpYShlbGVtZW50LCBzY29wZSk7XHJcblxyXG4gICAgcmdDdHJsLmFkZChyZW5kZXIpO1xyXG4gICAgYXR0ci4kb2JzZXJ2ZSgndmFsdWUnLCByZW5kZXIpO1xyXG5cclxuICAgIGVsZW1lbnRcclxuICAgICAgLm9uKCdjbGljaycsIGxpc3RlbmVyKVxyXG4gICAgICAub24oJyRkZXN0cm95JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmdDdHJsLnJlbW92ZShyZW5kZXIpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICBmdW5jdGlvbiBsaXN0ZW5lcihldikge1xyXG4gICAgICBpZiAoZWxlbWVudFswXS5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHJldHVybjtcclxuXHJcbiAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICByZ0N0cmwuc2V0Vmlld1ZhbHVlKGF0dHIudmFsdWUsIGV2ICYmIGV2LnR5cGUpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiByZW5kZXIoKSB7XHJcbiAgICAgIHZhciBjaGVja2VkID0gKHJnQ3RybC5nZXRWaWV3VmFsdWUoKSA9PSBhdHRyLnZhbHVlKTtcclxuICAgICAgaWYgKGNoZWNrZWQgPT09IGxhc3RDaGVja2VkKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGxhc3RDaGVja2VkID0gY2hlY2tlZDtcclxuICAgICAgZWxlbWVudC5hdHRyKCdhcmlhLWNoZWNrZWQnLCBjaGVja2VkKTtcclxuICAgICAgaWYgKGNoZWNrZWQpIHtcclxuICAgICAgICBlbGVtZW50LmFkZENsYXNzKENIRUNLRURfQ1NTKTtcclxuICAgICAgICByZ0N0cmwuc2V0QWN0aXZlRGVzY2VuZGFudChlbGVtZW50LmF0dHIoJ2lkJykpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoQ0hFQ0tFRF9DU1MpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEluamVjdCBBUklBLXNwZWNpZmljIGF0dHJpYnV0ZXMgYXBwcm9wcmlhdGUgZm9yIGVhY2ggcmFkaW8gYnV0dG9uXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGNvbmZpZ3VyZUFyaWEoIGVsZW1lbnQsIHNjb3BlICl7XHJcbiAgICAgIHNjb3BlLmFyaWFJZCA9IGJ1aWxkQXJpYUlEKCk7XHJcblxyXG4gICAgICBlbGVtZW50LmF0dHIoe1xyXG4gICAgICAgICdpZCcgOiAgc2NvcGUuYXJpYUlkLFxyXG4gICAgICAgICdyb2xlJyA6ICdyYWRpbycsXHJcbiAgICAgICAgJ2FyaWEtY2hlY2tlZCcgOiAnZmFsc2UnXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgJG1kQXJpYS5leHBlY3RXaXRoVGV4dChlbGVtZW50LCAnYXJpYS1sYWJlbCcpO1xyXG5cclxuICAgICAgLyoqXHJcbiAgICAgICAqIEJ1aWxkIGEgdW5pcXVlIElEIGZvciBlYWNoIHJhZGlvIGJ1dHRvbiB0aGF0IHdpbGwgYmUgdXNlZCB3aXRoIGFyaWEtYWN0aXZlZGVzY2VuZGFudC5cclxuICAgICAgICogUHJlc2VydmUgZXhpc3RpbmcgSUQgaWYgYWxyZWFkeSBzcGVjaWZpZWQuXHJcbiAgICAgICAqIEByZXR1cm5zIHsqfHN0cmluZ31cclxuICAgICAgICovXHJcbiAgICAgIGZ1bmN0aW9uIGJ1aWxkQXJpYUlEKCkge1xyXG4gICAgICAgIHJldHVybiBhdHRyLmlkIHx8ICggJ3JhZGlvJyArIFwiX1wiICsgJG1kVXRpbC5uZXh0VWlkKCkgKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5tZFJhZGlvQnV0dG9uRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkbWRBcmlhXCIsIFwiJG1kVXRpbFwiLCBcIiRtZFRoZW1pbmdcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKipcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLnNlbGVjdFxyXG4gKi9cclxuXHJcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuXHJcbiMjIyBUT0RPICMjI1xyXG4qKkRPQ1VNRU5UQVRJT04gQU5EIERFTU9TKipcclxuXHJcbi0gWyBdIG5nLW1vZGVsIHdpdGggY2hpbGQgbWRPcHRpb25zIChiYXNpYylcclxuLSBbIF0gbmctbW9kZWw9XCJmb29cIiBuZy1tb2RlbC1vcHRpb25zPVwieyB0cmFja0J5OiAnJHZhbHVlLmlkJyB9XCIgZm9yIG9iamVjdHNcclxuLSBbIF0gbWRPcHRpb24gd2l0aCB2YWx1ZVxyXG4tIFsgXSBVc2FnZSB3aXRoIGlucHV0IGluc2lkZVxyXG5cclxuIyMjIFRPRE8gLSBQT1NUIFJDMSAjIyNcclxuLSBbIF0gQWJzdHJhY3QgcGxhY2VtZW50IGxvZ2ljIGluICRtZFNlbGVjdCBzZXJ2aWNlIHRvICRtZE1lbnUgc2VydmljZVxyXG5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xyXG5cclxudmFyIFNFTEVDVF9FREdFX01BUkdJTiA9IDg7XHJcbnZhciBzZWxlY3ROZXh0SWQgPSAwO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuc2VsZWN0JywgW1xyXG4gICdtYXRlcmlhbC5jb3JlJyxcclxuICAnbWF0ZXJpYWwuY29tcG9uZW50cy5iYWNrZHJvcCdcclxuXSlcclxuLmRpcmVjdGl2ZSgnbWRTZWxlY3QnLCBTZWxlY3REaXJlY3RpdmUpXHJcbi5kaXJlY3RpdmUoJ21kU2VsZWN0TWVudScsIFNlbGVjdE1lbnVEaXJlY3RpdmUpXHJcbi5kaXJlY3RpdmUoJ21kT3B0aW9uJywgT3B0aW9uRGlyZWN0aXZlKVxyXG4uZGlyZWN0aXZlKCdtZE9wdGdyb3VwJywgT3B0Z3JvdXBEaXJlY3RpdmUpXHJcbi5wcm92aWRlcignJG1kU2VsZWN0JywgU2VsZWN0UHJvdmlkZXIpO1xyXG5cclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAqIEBuYW1lIG1kU2VsZWN0XHJcbiAqIEByZXN0cmljdCBFXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5zZWxlY3RcclxuICpcclxuICogQGRlc2NyaXB0aW9uIERpc3BsYXlzIGEgc2VsZWN0IGJveCwgYm91bmQgdG8gYW4gbmctbW9kZWwuXHJcbiAqXHJcbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmctbW9kZWwgVGhlIG1vZGVsIVxyXG4gKiBAcGFyYW0ge2V4cHJlc3Npb249fSBtZC1vbi1jbG9zZSBleHByZXNzaW9uIHRvIGJlIGV2YWx1YXRlZCB3aGVuIHRoZSBzZWxlY3QgaXMgY2xvc2VkXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG11bHRpcGxlIFdoZXRoZXIgaXQncyBtdWx0aXBsZS5cclxuICogQHBhcmFtIHtzdHJpbmc9fSBwbGFjZWhvbGRlciBQbGFjZWhvbGRlciBoaW50IHRleHQuXHJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gYXJpYS1sYWJlbCBPcHRpb25hbCBsYWJlbCBmb3IgYWNjZXNzaWJpbGl0eS4gT25seSBuZWNlc3NhcnkgaWYgbm8gcGxhY2Vob2xkZXIgb3JcclxuICogZXhwbGljaXQgbGFiZWwgaXMgcHJlc2VudC5cclxuICpcclxuICogQHVzYWdlXHJcbiAqIFdpdGggYSBwbGFjZWhvbGRlciAobGFiZWwgYW5kIGFyaWEtbGFiZWwgYXJlIGFkZGVkIGR5bmFtaWNhbGx5KVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiAgIDxtZC1zZWxlY3RcclxuICogICAgIG5nLW1vZGVsPVwic29tZU1vZGVsXCJcclxuICogICAgIHBsYWNlaG9sZGVyPVwiU2VsZWN0IGEgc3RhdGVcIj5cclxuICogICAgIDxtZC1vcHRpb24gbmctdmFsdWU9XCJvcHRcIiBuZy1yZXBlYXQ9XCJvcHQgaW4gbmVpZ2hib3Job29kczJcIj57eyBvcHQgfX08L21kLW9wdGlvbj5cclxuICogICA8L21kLXNlbGVjdD5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiBXaXRoIGFuIGV4cGxpY2l0IGxhYmVsXHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqICAgPG1kLXNlbGVjdFxyXG4gKiAgICAgbmctbW9kZWw9XCJzb21lTW9kZWxcIj5cclxuICogICAgIDxtZC1zZWxlY3QtbGFiZWw+U2VsZWN0IGEgc3RhdGU8L21kLXNlbGVjdC1sYWJlbD5cclxuICogICAgIDxtZC1vcHRpb24gbmctdmFsdWU9XCJvcHRcIiBuZy1yZXBlYXQ9XCJvcHQgaW4gbmVpZ2hib3Job29kczJcIj57eyBvcHQgfX08L21kLW9wdGlvbj5cclxuICogICA8L21kLXNlbGVjdD5cclxuICogPC9obGpzPlxyXG4gKi9cclxuZnVuY3Rpb24gU2VsZWN0RGlyZWN0aXZlKCRtZFNlbGVjdCwgJG1kVXRpbCwgJG1kVGhlbWluZywgJG1kQXJpYSwgJGludGVycG9sYXRlLCAkY29tcGlsZSwgJHBhcnNlKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICByZXF1aXJlOiBbJ21kU2VsZWN0JywgJ25nTW9kZWwnLCAnP15mb3JtJ10sXHJcbiAgICBjb21waWxlOiBjb21waWxlLFxyXG4gICAgY29udHJvbGxlcjogZnVuY3Rpb24oKSB7IH0gLy8gZW1wdHkgcGxhY2Vob2xkZXIgY29udHJvbGxlciB0byBiZSBpbml0aWFsaXplZCBpbiBsaW5rXHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb24gY29tcGlsZShlbGVtZW50LCBhdHRyKSB7XHJcbiAgICAvLyBUaGUgdXNlciBpcyBhbGxvd2VkIHRvIHByb3ZpZGUgYSBsYWJlbCBmb3IgdGhlIHNlbGVjdCBhcyBtZC1zZWxlY3QtbGFiZWwgY2hpbGRcclxuICAgIHZhciBsYWJlbEVsID0gZWxlbWVudC5maW5kKCdtZC1zZWxlY3QtbGFiZWwnKS5yZW1vdmUoKTtcclxuXHJcbiAgICAvLyBJZiBub3QgcHJvdmlkZWQsIHdlIGF1dG9tYXRpY2FsbHkgbWFrZSBvbmVcclxuICAgIGlmICghbGFiZWxFbC5sZW5ndGgpIHtcclxuICAgICAgbGFiZWxFbCA9IGFuZ3VsYXIuZWxlbWVudCgnPG1kLXNlbGVjdC1sYWJlbD48c3Bhbj48L3NwYW4+PC9tZC1zZWxlY3QtbGFiZWw+Jyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpZiAoIWxhYmVsRWxbMF0uZmlyc3RFbGVtZW50Q2hpbGQpIHtcclxuICAgICAgICB2YXIgc3BhbldyYXBwZXIgPSBhbmd1bGFyLmVsZW1lbnQoJzxzcGFuPicpO1xyXG4gICAgICAgIHNwYW5XcmFwcGVyLmFwcGVuZChsYWJlbEVsLmNvbnRlbnRzKCkpO1xyXG4gICAgICAgIGxhYmVsRWwuYXBwZW5kKHNwYW5XcmFwcGVyKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgbGFiZWxFbC5hcHBlbmQoJzxzcGFuIGNsYXNzPVwibWQtc2VsZWN0LWljb25cIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L3NwYW4+Jyk7XHJcbiAgICBsYWJlbEVsLmFkZENsYXNzKCdtZC1zZWxlY3QtbGFiZWwnKTtcclxuICAgIGlmICghbGFiZWxFbFswXS5oYXNBdHRyaWJ1dGUoJ2lkJykpIHtcclxuICAgICAgbGFiZWxFbC5hdHRyKCdpZCcsICdzZWxlY3RfbGFiZWxfJyArICRtZFV0aWwubmV4dFVpZCgpKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBUaGVyZSdzIGdvdCB0byBiZSBhbiBtZC1jb250ZW50IGluc2lkZS4gSWYgdGhlcmUncyBub3Qgb25lLCBsZXQncyBhZGQgaXQuXHJcbiAgICBpZiAoIWVsZW1lbnQuZmluZCgnbWQtY29udGVudCcpLmxlbmd0aCkge1xyXG4gICAgICBlbGVtZW50LmFwcGVuZCggYW5ndWxhci5lbGVtZW50KCc8bWQtY29udGVudD4nKS5hcHBlbmQoZWxlbWVudC5jb250ZW50cygpKSApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZCBwcm9ncmVzcyBzcGlubmVyIGZvciBtZC1vcHRpb25zLWxvYWRpbmdcclxuICAgIGlmIChhdHRyLm1kT25PcGVuKSB7XHJcbiAgICAgIGVsZW1lbnQuZmluZCgnbWQtY29udGVudCcpLnByZXBlbmQoXHJcbiAgICAgICAgYW5ndWxhci5lbGVtZW50KCc8bWQtcHJvZ3Jlc3MtY2lyY3VsYXI+JylcclxuICAgICAgICAgICAgICAgLmF0dHIoJ21kLW1vZGUnLCAnaW5kZXRlcm1pbmF0ZScpXHJcbiAgICAgICAgICAgICAgIC5hdHRyKCduZy1oaWRlJywgJyQkbG9hZGluZ0FzeW5jRG9uZScpXHJcbiAgICAgICAgICAgICAgIC53cmFwKCc8ZGl2PicpXHJcbiAgICAgICAgICAgICAgIC5wYXJlbnQoKVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChhdHRyLm5hbWUpIHtcclxuICAgICAgdmFyIGF1dG9maWxsQ2xvbmUgPSBhbmd1bGFyLmVsZW1lbnQoJzxzZWxlY3QgY2xhc3M9XCJtZC12aXN1YWxseS1oaWRkZW5cIj4nKTtcclxuICAgICAgYXV0b2ZpbGxDbG9uZS5hdHRyKHtcclxuICAgICAgICAnbmFtZSc6ICcuJyArIGF0dHIubmFtZSxcclxuICAgICAgICAnbmctbW9kZWwnOiBhdHRyLm5nTW9kZWwsXHJcbiAgICAgICAgJ2FyaWEtaGlkZGVuJzogJ3RydWUnLFxyXG4gICAgICAgICd0YWJpbmRleCc6ICctMSdcclxuICAgICAgfSk7XHJcbiAgICAgIHZhciBvcHRzID0gZWxlbWVudC5maW5kKCdtZC1vcHRpb24nKTtcclxuICAgICAgYW5ndWxhci5mb3JFYWNoKG9wdHMsIGZ1bmN0aW9uKGVsKSB7XHJcbiAgICAgICAgdmFyIG5ld0VsID0gYW5ndWxhci5lbGVtZW50KCc8b3B0aW9uPicgKyBlbC5pbm5lckhUTUwgKyAnPC9vcHRpb24+Jyk7XHJcbiAgICAgICAgaWYgKGVsLmhhc0F0dHJpYnV0ZSgnbmctdmFsdWUnKSkgbmV3RWwuYXR0cignbmctdmFsdWUnLCBlbC5nZXRBdHRyaWJ1dGUoJ25nLXZhbHVlJykpO1xyXG4gICAgICAgIGVsc2UgaWYgKGVsLmhhc0F0dHJpYnV0ZSgndmFsdWUnKSkgbmV3RWwuYXR0cigndmFsdWUnLCBlbC5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykpO1xyXG4gICAgICAgIGF1dG9maWxsQ2xvbmUuYXBwZW5kKG5ld0VsKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBlbGVtZW50LnBhcmVudCgpLmFwcGVuZChhdXRvZmlsbENsb25lKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBVc2UgZXZlcnl0aGluZyB0aGF0J3MgbGVmdCBpbnNpZGUgZWxlbWVudC5jb250ZW50cygpIGFzIHRoZSBjb250ZW50cyBvZiB0aGUgbWVudVxyXG4gICAgdmFyIHNlbGVjdFRlbXBsYXRlID0gJzxkaXYgY2xhc3M9XCJtZC1zZWxlY3QtbWVudS1jb250YWluZXJcIj4nICtcclxuICAgICAgICAnPG1kLXNlbGVjdC1tZW51ICcgK1xyXG4gICAgICAgIChhbmd1bGFyLmlzRGVmaW5lZChhdHRyLm11bHRpcGxlKSA/ICdtdWx0aXBsZScgOiAnJykgKyAnPicgK1xyXG4gICAgICAgICAgZWxlbWVudC5odG1sKCkgK1xyXG4gICAgICAgICc8L21kLXNlbGVjdC1tZW51PjwvZGl2Pic7XHJcblxyXG4gICAgZWxlbWVudC5lbXB0eSgpLmFwcGVuZChsYWJlbEVsKTtcclxuXHJcbiAgICBhdHRyLnRhYmluZGV4ID0gYXR0ci50YWJpbmRleCB8fCAnMCc7XHJcblxyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJscykge1xyXG4gICAgICB2YXIgaXNPcGVuO1xyXG4gICAgICB2YXIgaXNEaXNhYmxlZDtcclxuXHJcbiAgICAgIHZhciBtZFNlbGVjdEN0cmwgPSBjdHJsc1swXTtcclxuICAgICAgdmFyIG5nTW9kZWwgPSBjdHJsc1sxXTtcclxuICAgICAgdmFyIGZvcm1DdHJsID0gY3RybHNbMl07XHJcblxyXG4gICAgICB2YXIgbGFiZWxFbCA9IGVsZW1lbnQuZmluZCgnbWQtc2VsZWN0LWxhYmVsJyk7XHJcbiAgICAgIHZhciBjdXN0b21MYWJlbCA9IGxhYmVsRWwudGV4dCgpLmxlbmd0aCAhPT0gMDtcclxuICAgICAgdmFyIHNlbGVjdENvbnRhaW5lciwgc2VsZWN0U2NvcGUsIHNlbGVjdE1lbnVDdHJsO1xyXG4gICAgICBjcmVhdGVTZWxlY3QoKTtcclxuXHJcbiAgICAgICRtZFRoZW1pbmcoZWxlbWVudCk7XHJcblxyXG4gICAgICBpZiAoYXR0ci5uYW1lICYmIGZvcm1DdHJsKSB7XHJcbiAgICAgICAgdmFyIHNlbGVjdEVsID0gZWxlbWVudC5wYXJlbnQoKVswXS5xdWVyeVNlbGVjdG9yKCdzZWxlY3RbbmFtZT1cIi4nICsgYXR0ci5uYW1lICsgJ1wiXScpO1xyXG4gICAgICAgIGZvcm1DdHJsLiRyZW1vdmVDb250cm9sKGFuZ3VsYXIuZWxlbWVudChzZWxlY3RFbCkuY29udHJvbGxlcigpKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIG9yaWdpbmFsUmVuZGVyID0gbmdNb2RlbC4kcmVuZGVyO1xyXG4gICAgICBuZ01vZGVsLiRyZW5kZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBvcmlnaW5hbFJlbmRlcigpO1xyXG4gICAgICAgIHN5bmNMYWJlbFRleHQoKTtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIG1kU2VsZWN0Q3RybC5zZXRMYWJlbFRleHQgPSBmdW5jdGlvbih0ZXh0KSB7XHJcbiAgICAgICAgaWYgKGN1c3RvbUxhYmVsKSByZXR1cm47IC8vIEFzc3VtZSB0aGF0IHVzZXIgaXMgaGFuZGxpbmcgaXQgb24gdGhlaXIgb3duXHJcbiAgICAgICAgbWRTZWxlY3RDdHJsLnNldElzUGxhY2Vob2xkZXIoIXRleHQpO1xyXG4gICAgICAgIHRleHQgPSB0ZXh0IHx8IGF0dHIucGxhY2Vob2xkZXIgfHwgJyc7XHJcbiAgICAgICAgdmFyIHRhcmdldCA9IGN1c3RvbUxhYmVsID8gbGFiZWxFbCA6IGxhYmVsRWwuY2hpbGRyZW4oKS5lcSgwKTtcclxuICAgICAgICB0YXJnZXQudGV4dCh0ZXh0KTtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIG1kU2VsZWN0Q3RybC5zZXRJc1BsYWNlaG9sZGVyID0gZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgdmFsID8gbGFiZWxFbC5hZGRDbGFzcygnbWQtcGxhY2Vob2xkZXInKSA6IGxhYmVsRWwucmVtb3ZlQ2xhc3MoJ21kLXBsYWNlaG9sZGVyJyk7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBtZFNlbGVjdEN0cmwudHJpZ2dlckNsb3NlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJHBhcnNlKGF0dHIubWRPbkNsb3NlKShzY29wZSk7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBzY29wZS4kJHBvc3REaWdlc3QoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgc2V0QXJpYUxhYmVsKCk7XHJcbiAgICAgICAgc3luY0xhYmVsVGV4dCgpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGZ1bmN0aW9uIHNldEFyaWFMYWJlbCgpIHtcclxuICAgICAgICB2YXIgbGFiZWxUZXh0ID0gZWxlbWVudC5hdHRyKCdwbGFjZWhvbGRlcicpO1xyXG4gICAgICAgIGlmICghbGFiZWxUZXh0KSB7XHJcbiAgICAgICAgICBsYWJlbFRleHQgPSBlbGVtZW50LmZpbmQoJ21kLXNlbGVjdC1sYWJlbCcpLnRleHQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgJG1kQXJpYS5leHBlY3QoZWxlbWVudCwgJ2FyaWEtbGFiZWwnLCBsYWJlbFRleHQpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBzeW5jTGFiZWxUZXh0KCkge1xyXG4gICAgICAgIGlmIChzZWxlY3RDb250YWluZXIpIHtcclxuICAgICAgICAgIHNlbGVjdE1lbnVDdHJsID0gc2VsZWN0TWVudUN0cmwgfHwgc2VsZWN0Q29udGFpbmVyLmZpbmQoJ21kLXNlbGVjdC1tZW51JykuY29udHJvbGxlcignbWRTZWxlY3RNZW51Jyk7XHJcbiAgICAgICAgICBtZFNlbGVjdEN0cmwuc2V0TGFiZWxUZXh0KHNlbGVjdE1lbnVDdHJsLnNlbGVjdGVkTGFiZWxzKCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIGRlcmVnaXN0ZXJXYXRjaGVyO1xyXG4gICAgICBhdHRyLiRvYnNlcnZlKCduZ011bHRpcGxlJywgZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgaWYgKGRlcmVnaXN0ZXJXYXRjaGVyKSBkZXJlZ2lzdGVyV2F0Y2hlcigpO1xyXG4gICAgICAgIHZhciBwYXJzZXIgPSAkcGFyc2UodmFsKTtcclxuICAgICAgICBkZXJlZ2lzdGVyV2F0Y2hlciA9IHNjb3BlLiR3YXRjaChmdW5jdGlvbigpIHsgcmV0dXJuIHBhcnNlcihzY29wZSk7IH0sIGZ1bmN0aW9uKG11bHRpcGxlLCBwcmV2VmFsKSB7XHJcbiAgICAgICAgICBpZiAobXVsdGlwbGUgPT09IHVuZGVmaW5lZCAmJiBwcmV2VmFsID09PSB1bmRlZmluZWQpIHJldHVybjsgLy8gYXNzdW1lIGNvbXBpbGVyIGRpZCBhIGdvb2Qgam9iXHJcbiAgICAgICAgICBpZiAobXVsdGlwbGUpIHtcclxuICAgICAgICAgICAgZWxlbWVudC5hdHRyKCdtdWx0aXBsZScsICdtdWx0aXBsZScpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVBdHRyKCdtdWx0aXBsZScpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKHNlbGVjdENvbnRhaW5lcikge1xyXG4gICAgICAgICAgICBzZWxlY3RNZW51Q3RybC5zZXRNdWx0aXBsZShtdWx0aXBsZSk7XHJcbiAgICAgICAgICAgIG9yaWdpbmFsUmVuZGVyID0gbmdNb2RlbC4kcmVuZGVyO1xyXG4gICAgICAgICAgICBuZ01vZGVsLiRyZW5kZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICBvcmlnaW5hbFJlbmRlcigpO1xyXG4gICAgICAgICAgICAgIHN5bmNMYWJlbFRleHQoKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgc2VsZWN0TWVudUN0cmwucmVmcmVzaFZpZXdWYWx1ZSgpO1xyXG4gICAgICAgICAgICBuZ01vZGVsLiRyZW5kZXIoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBhdHRyLiRvYnNlcnZlKCdkaXNhYmxlZCcsIGZ1bmN0aW9uKGRpc2FibGVkKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBkaXNhYmxlZCA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICBkaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFByZXZlbnQgY2xpY2sgZXZlbnQgYmVpbmcgcmVnaXN0ZXJlZCB0d2ljZVxyXG4gICAgICAgIGlmIChpc0Rpc2FibGVkICE9PSB1bmRlZmluZWQgJiYgaXNEaXNhYmxlZCA9PT0gZGlzYWJsZWQpIHtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaXNEaXNhYmxlZCA9IGRpc2FibGVkO1xyXG4gICAgICAgIGlmIChkaXNhYmxlZCkge1xyXG4gICAgICAgICAgZWxlbWVudC5hdHRyKHsndGFiaW5kZXgnOiAtMSwgJ2FyaWEtZGlzYWJsZWQnOiAndHJ1ZSd9KTtcclxuICAgICAgICAgIGVsZW1lbnQub2ZmKCdjbGljaycsIG9wZW5TZWxlY3QpO1xyXG4gICAgICAgICAgZWxlbWVudC5vZmYoJ2tleWRvd24nLCBoYW5kbGVLZXlwcmVzcyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGVsZW1lbnQuYXR0cih7J3RhYmluZGV4JzogYXR0ci50YWJpbmRleCwgJ2FyaWEtZGlzYWJsZWQnOiAnZmFsc2UnfSk7XHJcbiAgICAgICAgICBlbGVtZW50Lm9uKCdjbGljaycsIG9wZW5TZWxlY3QpO1xyXG4gICAgICAgICAgZWxlbWVudC5vbigna2V5ZG93bicsIGhhbmRsZUtleXByZXNzKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKCFhdHRyLmRpc2FibGVkICYmICFhdHRyLm5nRGlzYWJsZWQpIHtcclxuICAgICAgICBlbGVtZW50LmF0dHIoeyd0YWJpbmRleCc6IGF0dHIudGFiaW5kZXgsICdhcmlhLWRpc2FibGVkJzogJ2ZhbHNlJ30pO1xyXG4gICAgICAgIGVsZW1lbnQub24oJ2NsaWNrJywgb3BlblNlbGVjdCk7XHJcbiAgICAgICAgZWxlbWVudC5vbigna2V5ZG93bicsIGhhbmRsZUtleXByZXNzKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIGFyaWFBdHRycyA9IHtcclxuICAgICAgICByb2xlOiAnY29tYm9ib3gnLFxyXG4gICAgICAgICdhcmlhLWV4cGFuZGVkJzogJ2ZhbHNlJ1xyXG4gICAgICB9O1xyXG4gICAgICBpZiAoIWVsZW1lbnRbMF0uaGFzQXR0cmlidXRlKCdpZCcpKSB7XHJcbiAgICAgICAgYXJpYUF0dHJzLmlkID0gJ3NlbGVjdF8nICsgJG1kVXRpbC5uZXh0VWlkKCk7XHJcbiAgICAgIH1cclxuICAgICAgZWxlbWVudC5hdHRyKGFyaWFBdHRycyk7XHJcblxyXG4gICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKGlzT3Blbikge1xyXG4gICAgICAgICAgJG1kU2VsZWN0LmNhbmNlbCgpLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHNlbGVjdENvbnRhaW5lci5yZW1vdmUoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBzZWxlY3RDb250YWluZXIucmVtb3ZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcblxyXG4gICAgICAvLyBDcmVhdGUgYSBmYWtlIHNlbGVjdCB0byBmaW5kIG91dCB0aGUgbGFiZWwgdmFsdWVcclxuICAgICAgZnVuY3Rpb24gY3JlYXRlU2VsZWN0KCkge1xyXG4gICAgICAgIHNlbGVjdENvbnRhaW5lciA9IGFuZ3VsYXIuZWxlbWVudChzZWxlY3RUZW1wbGF0ZSk7XHJcbiAgICAgICAgdmFyIHNlbGVjdEVsID0gc2VsZWN0Q29udGFpbmVyLmZpbmQoJ21kLXNlbGVjdC1tZW51Jyk7XHJcbiAgICAgICAgc2VsZWN0RWwuZGF0YSgnJG5nTW9kZWxDb250cm9sbGVyJywgbmdNb2RlbCk7XHJcbiAgICAgICAgc2VsZWN0RWwuZGF0YSgnJG1kU2VsZWN0Q29udHJvbGxlcicsIG1kU2VsZWN0Q3RybCk7XHJcbiAgICAgICAgc2VsZWN0U2NvcGUgPSBzY29wZS4kbmV3KCk7XHJcbiAgICAgICAgc2VsZWN0Q29udGFpbmVyID0gJGNvbXBpbGUoc2VsZWN0Q29udGFpbmVyKShzZWxlY3RTY29wZSk7XHJcbiAgICAgICAgc2VsZWN0TWVudUN0cmwgPSBzZWxlY3RDb250YWluZXIuZmluZCgnbWQtc2VsZWN0LW1lbnUnKS5jb250cm9sbGVyKCdtZFNlbGVjdE1lbnUnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gaGFuZGxlS2V5cHJlc3MoZSkge1xyXG4gICAgICAgIHZhciBhbGxvd2VkQ29kZXMgPSBbMzIsIDEzLCAzOCwgNDBdO1xyXG4gICAgICAgIGlmIChhbGxvd2VkQ29kZXMuaW5kZXhPZihlLmtleUNvZGUpICE9IC0xICkge1xyXG4gICAgICAgICAgLy8gcHJldmVudCBwYWdlIHNjcm9sbGluZyBvbiBpbnRlcmFjdGlvblxyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgb3BlblNlbGVjdChlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKGUua2V5Q29kZSA8PSA5MCAmJiBlLmtleUNvZGUgPj0gMzEpIHtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB2YXIgbm9kZSA9IHNlbGVjdE1lbnVDdHJsLm9wdE5vZGVGb3JLZXlib2FyZFNlYXJjaChlKTtcclxuICAgICAgICAgICAgaWYgKCFub2RlKSByZXR1cm47XHJcbiAgICAgICAgICAgIHZhciBvcHRpb25DdHJsID0gYW5ndWxhci5lbGVtZW50KG5vZGUpLmNvbnRyb2xsZXIoJ21kT3B0aW9uJyk7XHJcbiAgICAgICAgICAgIGlmICghc2VsZWN0TWVudUN0cmwuaXNNdWx0aXBsZSkge1xyXG4gICAgICAgICAgICAgIHNlbGVjdE1lbnVDdHJsLmRlc2VsZWN0KCBPYmplY3Qua2V5cyhzZWxlY3RNZW51Q3RybC5zZWxlY3RlZClbMF0gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZWxlY3RNZW51Q3RybC5zZWxlY3Qob3B0aW9uQ3RybC5oYXNoS2V5LCBvcHRpb25DdHJsLnZhbHVlKTtcclxuICAgICAgICAgICAgc2VsZWN0TWVudUN0cmwucmVmcmVzaFZpZXdWYWx1ZSgpO1xyXG4gICAgICAgICAgICBuZ01vZGVsLiRyZW5kZXIoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIG9wZW5TZWxlY3QoKSB7XHJcbiAgICAgICAgc2NvcGUuJGV2YWxBc3luYyhmdW5jdGlvbigpIHtcclxuICAgICAgICAgIGlzT3BlbiA9IHRydWU7XHJcbiAgICAgICAgICAkbWRTZWxlY3Quc2hvdyh7XHJcbiAgICAgICAgICAgIHNjb3BlOiBzZWxlY3RTY29wZSxcclxuICAgICAgICAgICAgcHJlc2VydmVTY29wZTogdHJ1ZSxcclxuICAgICAgICAgICAgc2tpcENvbXBpbGU6IHRydWUsXHJcbiAgICAgICAgICAgIGVsZW1lbnQ6IHNlbGVjdENvbnRhaW5lcixcclxuICAgICAgICAgICAgdGFyZ2V0OiBlbGVtZW50WzBdLFxyXG4gICAgICAgICAgICBoYXNCYWNrZHJvcDogdHJ1ZSxcclxuICAgICAgICAgICAgbG9hZGluZ0FzeW5jOiBhdHRyLm1kT25PcGVuID8gc2NvcGUuJGV2YWwoYXR0ci5tZE9uT3BlbikgfHwgdHJ1ZSA6IGZhbHNlLFxyXG4gICAgICAgICAgfSkudGhlbihmdW5jdGlvbihzZWxlY3RlZFRleHQpIHtcclxuICAgICAgICAgICAgaXNPcGVuID0gZmFsc2U7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuU2VsZWN0RGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkbWRTZWxlY3RcIiwgXCIkbWRVdGlsXCIsIFwiJG1kVGhlbWluZ1wiLCBcIiRtZEFyaWFcIiwgXCIkaW50ZXJwb2xhdGVcIiwgXCIkY29tcGlsZVwiLCBcIiRwYXJzZVwiXTtcclxuXHJcbmZ1bmN0aW9uIFNlbGVjdE1lbnVEaXJlY3RpdmUoJHBhcnNlLCAkbWRVdGlsLCAkbWRUaGVtaW5nKSB7XHJcblxyXG4gIFNlbGVjdE1lbnVDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkYXR0cnNcIiwgXCIkZWxlbWVudFwiXTtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgIHJlcXVpcmU6IFsnbWRTZWxlY3RNZW51JywgJz9uZ01vZGVsJ10sXHJcbiAgICBjb250cm9sbGVyOiBTZWxlY3RNZW51Q29udHJvbGxlcixcclxuICAgIGxpbms6IHsgcHJlOiBwcmVMaW5rIH1cclxuICB9O1xyXG5cclxuICAvLyBXZSB1c2UgcHJlTGluayBpbnN0ZWFkIG9mIHBvc3RMaW5rIHRvIGVuc3VyZSB0aGF0IHRoZSBzZWxlY3QgaXMgaW5pdGlhbGl6ZWQgYmVmb3JlXHJcbiAgLy8gaXRzIGNoaWxkIG9wdGlvbnMgcnVuIHBvc3RMaW5rLlxyXG4gIGZ1bmN0aW9uIHByZUxpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmxzKSB7XHJcbiAgICB2YXIgc2VsZWN0Q3RybCA9IGN0cmxzWzBdO1xyXG4gICAgdmFyIG5nTW9kZWwgPSBjdHJsc1sxXTtcclxuXHJcbiAgICAkbWRUaGVtaW5nKGVsZW1lbnQpO1xyXG4gICAgZWxlbWVudC5vbignY2xpY2snLCBjbGlja0xpc3RlbmVyKTtcclxuICAgIGVsZW1lbnQub24oJ2tleXByZXNzJywga2V5TGlzdGVuZXIpO1xyXG4gICAgaWYgKG5nTW9kZWwpIHNlbGVjdEN0cmwuaW5pdChuZ01vZGVsKTtcclxuICAgIGNvbmZpZ3VyZUFyaWEoKTtcclxuXHJcbiAgICBmdW5jdGlvbiBjb25maWd1cmVBcmlhKCkge1xyXG4gICAgICBlbGVtZW50LmF0dHIoe1xyXG4gICAgICAgICdpZCc6ICdzZWxlY3RfbWVudV8nICsgJG1kVXRpbC5uZXh0VWlkKCksXHJcbiAgICAgICAgJ3JvbGUnOiAnbGlzdGJveCcsXHJcbiAgICAgICAgJ2FyaWEtbXVsdGlzZWxlY3RhYmxlJzogKHNlbGVjdEN0cmwuaXNNdWx0aXBsZSA/ICd0cnVlJyA6ICdmYWxzZScpXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGtleUxpc3RlbmVyKGUpIHtcclxuICAgICAgaWYgKGUua2V5Q29kZSA9PSAxMyB8fCBlLmtleUNvZGUgPT0gMzIpIHtcclxuICAgICAgICBjbGlja0xpc3RlbmVyKGUpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gY2xpY2tMaXN0ZW5lcihldikge1xyXG4gICAgICB2YXIgb3B0aW9uID0gJG1kVXRpbC5nZXRDbG9zZXN0KGV2LnRhcmdldCwgJ21kLW9wdGlvbicpO1xyXG4gICAgICB2YXIgb3B0aW9uQ3RybCA9IG9wdGlvbiAmJiBhbmd1bGFyLmVsZW1lbnQob3B0aW9uKS5kYXRhKCckbWRPcHRpb25Db250cm9sbGVyJyk7XHJcbiAgICAgIGlmICghb3B0aW9uIHx8ICFvcHRpb25DdHJsKSByZXR1cm47XHJcblxyXG4gICAgICB2YXIgb3B0aW9uSGFzaEtleSA9IHNlbGVjdEN0cmwuaGFzaEdldHRlcihvcHRpb25DdHJsLnZhbHVlKTtcclxuICAgICAgdmFyIGlzU2VsZWN0ZWQgPSBhbmd1bGFyLmlzRGVmaW5lZChzZWxlY3RDdHJsLnNlbGVjdGVkW29wdGlvbkhhc2hLZXldKTtcclxuXHJcbiAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoc2VsZWN0Q3RybC5pc011bHRpcGxlKSB7XHJcbiAgICAgICAgICBpZiAoaXNTZWxlY3RlZCkge1xyXG4gICAgICAgICAgICBzZWxlY3RDdHJsLmRlc2VsZWN0KG9wdGlvbkhhc2hLZXkpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc2VsZWN0Q3RybC5zZWxlY3Qob3B0aW9uSGFzaEtleSwgb3B0aW9uQ3RybC52YWx1ZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGlmICghaXNTZWxlY3RlZCkge1xyXG4gICAgICAgICAgICBzZWxlY3RDdHJsLmRlc2VsZWN0KCBPYmplY3Qua2V5cyhzZWxlY3RDdHJsLnNlbGVjdGVkKVswXSApO1xyXG4gICAgICAgICAgICBzZWxlY3RDdHJsLnNlbGVjdCggb3B0aW9uSGFzaEtleSwgb3B0aW9uQ3RybC52YWx1ZSApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBzZWxlY3RDdHJsLnJlZnJlc2hWaWV3VmFsdWUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuXHJcblxyXG4gIGZ1bmN0aW9uIFNlbGVjdE1lbnVDb250cm9sbGVyKCRzY29wZSwgJGF0dHJzLCAkZWxlbWVudCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5pc011bHRpcGxlID0gYW5ndWxhci5pc0RlZmluZWQoJGF0dHJzLm11bHRpcGxlKTtcclxuICAgIC8vIHNlbGVjdGVkIGlzIGFuIG9iamVjdCB3aXRoIGtleXMgbWF0Y2hpbmcgYWxsIG9mIHRoZSBzZWxlY3RlZCBvcHRpb25zJyBoYXNoZWQgdmFsdWVzXHJcbiAgICBzZWxmLnNlbGVjdGVkID0ge307XHJcbiAgICAvLyBvcHRpb25zIGlzIGFuIG9iamVjdCB3aXRoIGtleXMgbWF0Y2hpbmcgZXZlcnkgb3B0aW9uJ3MgaGFzaCB2YWx1ZSxcclxuICAgIC8vIGFuZCB2YWx1ZXMgbWF0Y2hpbmcgZXZlcnkgb3B0aW9uJ3MgY29udHJvbGxlci5cclxuICAgIHNlbGYub3B0aW9ucyA9IHt9O1xyXG5cclxuICAgICRzY29wZS4kd2F0Y2goZnVuY3Rpb24oKSB7IHJldHVybiBzZWxmLm9wdGlvbnM7IH0sIGZ1bmN0aW9uKCkge1xyXG4gICAgICBzZWxmLm5nTW9kZWwuJHJlbmRlcigpO1xyXG4gICAgfSwgdHJ1ZSk7XHJcblxyXG4gICAgdmFyIGRlcmVnaXN0ZXJDb2xsZWN0aW9uV2F0Y2g7XHJcbiAgICBzZWxmLnNldE11bHRpcGxlID0gZnVuY3Rpb24oaXNNdWx0aXBsZSkge1xyXG4gICAgICB2YXIgbmdNb2RlbCA9IHNlbGYubmdNb2RlbDtcclxuICAgICAgc2VsZi5pc011bHRpcGxlID0gaXNNdWx0aXBsZTtcclxuICAgICAgaWYgKGRlcmVnaXN0ZXJDb2xsZWN0aW9uV2F0Y2gpIGRlcmVnaXN0ZXJDb2xsZWN0aW9uV2F0Y2goKTtcclxuXHJcbiAgICAgIGlmIChzZWxmLmlzTXVsdGlwbGUpIHtcclxuICAgICAgICBuZ01vZGVsLiR2YWxpZGF0b3JzWydtZC1tdWx0aXBsZSddID0gdmFsaWRhdGVBcnJheTtcclxuICAgICAgICBuZ01vZGVsLiRyZW5kZXIgPSByZW5kZXJNdWx0aXBsZTtcclxuXHJcbiAgICAgICAgLy8gd2F0Y2hDb2xsZWN0aW9uIG9uIHRoZSBtb2RlbCBiZWNhdXNlIGJ5IGRlZmF1bHQgbmdNb2RlbCBvbmx5IHdhdGNoZXMgdGhlIG1vZGVsJ3NcclxuICAgICAgICAvLyByZWZlcmVuY2UuIFRoaXMgYWxsb3dlZCB0aGUgZGV2ZWxvcGVyIHRvIGFsc28gcHVzaCBhbmQgcG9wIGZyb20gdGhlaXIgYXJyYXkuXHJcbiAgICAgICAgJHNjb3BlLiR3YXRjaENvbGxlY3Rpb24oJGF0dHJzLm5nTW9kZWwsIGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgICBpZiAodmFsaWRhdGVBcnJheSh2YWx1ZSkpIHJlbmRlck11bHRpcGxlKHZhbHVlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBkZWxldGUgbmdNb2RlbC4kdmFsaWRhdG9yc1snbWQtbXVsdGlwbGUnXTtcclxuICAgICAgICBuZ01vZGVsLiRyZW5kZXIgPSByZW5kZXJTaW5ndWxhcjtcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gdmFsaWRhdGVBcnJheShtb2RlbFZhbHVlLCB2aWV3VmFsdWUpIHtcclxuICAgICAgICAvLyBJZiBhIHZhbHVlIGlzIHRydXRoeSBidXQgbm90IGFuIGFycmF5LCByZWplY3QgaXQuXHJcbiAgICAgICAgLy8gSWYgdmFsdWUgaXMgdW5kZWZpbmVkL2ZhbHN5LCBhY2NlcHQgdGhhdCBpdCdzIGFuIGVtcHR5IGFycmF5LlxyXG4gICAgICAgIHJldHVybiBhbmd1bGFyLmlzQXJyYXkobW9kZWxWYWx1ZSB8fCB2aWV3VmFsdWUgfHwgW10pO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBzZWFyY2hTdHIgPSAnJztcclxuICAgIHZhciBjbGVhclNlYXJjaFRpbWVvdXQsIG9wdE5vZGVzLCBvcHRUZXh0O1xyXG4gICAgdmFyIENMRUFSX1NFQVJDSF9BRlRFUiA9IDMwMDtcclxuICAgIHNlbGYub3B0Tm9kZUZvcktleWJvYXJkU2VhcmNoID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICBjbGVhclNlYXJjaFRpbWVvdXQgJiYgY2xlYXJUaW1lb3V0KGNsZWFyU2VhcmNoVGltZW91dCk7XHJcbiAgICAgIGNsZWFyU2VhcmNoVGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2xlYXJTZWFyY2hUaW1lb3V0ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIHNlYXJjaFN0ciA9ICcnO1xyXG4gICAgICAgIG9wdFRleHQgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgb3B0Tm9kZXMgPSB1bmRlZmluZWQ7XHJcbiAgICAgIH0sIENMRUFSX1NFQVJDSF9BRlRFUik7XHJcbiAgICAgIHNlYXJjaFN0ciArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGUua2V5Q29kZSk7XHJcbiAgICAgIHZhciBzZWFyY2ggPSBuZXcgUmVnRXhwKCdeJyArIHNlYXJjaFN0ciwgJ2knKTtcclxuICAgICAgaWYgKCFvcHROb2Rlcykge1xyXG4gICAgICAgIG9wdE5vZGVzID0gJGVsZW1lbnQuZmluZCgnbWQtb3B0aW9uJyk7XHJcbiAgICAgICAgb3B0VGV4dCA9IG5ldyBBcnJheShvcHROb2Rlcy5sZW5ndGgpO1xyXG4gICAgICAgIGFuZ3VsYXIuZm9yRWFjaChvcHROb2RlcywgZnVuY3Rpb24oZWwsIGkpIHtcclxuICAgICAgICAgIG9wdFRleHRbaV0gPSBlbC50ZXh0Q29udGVudC50cmltKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvcHRUZXh0Lmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgaWYgKHNlYXJjaC50ZXN0KG9wdFRleHRbaV0pKSB7XHJcbiAgICAgICAgICByZXR1cm4gb3B0Tm9kZXNbaV07XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuXHJcbiAgICBzZWxmLmluaXQgPSBmdW5jdGlvbihuZ01vZGVsKSB7XHJcbiAgICAgIHNlbGYubmdNb2RlbCA9IG5nTW9kZWw7XHJcblxyXG4gICAgICAvLyBBbGxvdyB1c2VycyB0byBwcm92aWRlIGBuZy1tb2RlbD1cImZvb1wiIG5nLW1vZGVsLW9wdGlvbnM9XCJ7dHJhY2tCeTogJ2Zvby5pZCd9XCJgIHNvXHJcbiAgICAgIC8vIHRoYXQgd2UgY2FuIHByb3Blcmx5IGNvbXBhcmUgb2JqZWN0cyBzZXQgb24gdGhlIG1vZGVsIHRvIHRoZSBhdmFpbGFibGUgb3B0aW9uc1xyXG4gICAgICBpZiAobmdNb2RlbC4kb3B0aW9ucyAmJiBuZ01vZGVsLiRvcHRpb25zLnRyYWNrQnkpIHtcclxuICAgICAgICB2YXIgdHJhY2tCeUxvY2FscyA9IHt9O1xyXG4gICAgICAgIHZhciB0cmFja0J5UGFyc2VkID0gJHBhcnNlKG5nTW9kZWwuJG9wdGlvbnMudHJhY2tCeSk7XHJcbiAgICAgICAgc2VsZi5oYXNoR2V0dGVyID0gZnVuY3Rpb24odmFsdWUsIHZhbHVlU2NvcGUpIHtcclxuICAgICAgICAgIHRyYWNrQnlMb2NhbHMuJHZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgICByZXR1cm4gdHJhY2tCeVBhcnNlZCh2YWx1ZVNjb3BlIHx8ICRzY29wZSwgdHJhY2tCeUxvY2Fscyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgLy8gSWYgdGhlIHVzZXIgZG9lc24ndCBwcm92aWRlIGEgdHJhY2tCeSwgd2UgYXV0b21hdGljYWxseSBnZW5lcmF0ZSBhbiBpZCBmb3IgZXZlcnlcclxuICAgICAgLy8gdmFsdWUgcGFzc2VkIGluXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgc2VsZi5oYXNoR2V0dGVyID0gZnVuY3Rpb24gZ2V0SGFzaFZhbHVlKHZhbHVlKSB7XHJcbiAgICAgICAgICBpZiAoYW5ndWxhci5pc09iamVjdCh2YWx1ZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuICdvYmplY3RfJyArICh2YWx1ZS4kJG1kU2VsZWN0SWQgfHwgKHZhbHVlLiQkbWRTZWxlY3RJZCA9ICsrc2VsZWN0TmV4dElkKSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG4gICAgICBzZWxmLnNldE11bHRpcGxlKHNlbGYuaXNNdWx0aXBsZSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHNlbGYuc2VsZWN0ZWRMYWJlbHMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIHNlbGVjdGVkT3B0aW9uRWxzID0gJG1kVXRpbC5ub2Rlc1RvQXJyYXkoJGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvckFsbCgnbWQtb3B0aW9uW3NlbGVjdGVkXScpKTtcclxuICAgICAgaWYgKHNlbGVjdGVkT3B0aW9uRWxzLmxlbmd0aCkge1xyXG4gICAgICAgIHJldHVybiBzZWxlY3RlZE9wdGlvbkVscy5tYXAoZnVuY3Rpb24oZWwpIHsgcmV0dXJuIGVsLnRleHRDb250ZW50OyB9KS5qb2luKCcsICcpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiAnJztcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBzZWxmLnNlbGVjdCA9IGZ1bmN0aW9uKGhhc2hLZXksIGhhc2hlZFZhbHVlKSB7XHJcbiAgICAgIHZhciBvcHRpb24gPSBzZWxmLm9wdGlvbnNbaGFzaEtleV07XHJcbiAgICAgIG9wdGlvbiAmJiBvcHRpb24uc2V0U2VsZWN0ZWQodHJ1ZSk7XHJcbiAgICAgIHNlbGYuc2VsZWN0ZWRbaGFzaEtleV0gPSBoYXNoZWRWYWx1ZTtcclxuICAgIH07XHJcbiAgICBzZWxmLmRlc2VsZWN0ID0gZnVuY3Rpb24oaGFzaEtleSkge1xyXG4gICAgICB2YXIgb3B0aW9uID0gc2VsZi5vcHRpb25zW2hhc2hLZXldO1xyXG4gICAgICBvcHRpb24gJiYgb3B0aW9uLnNldFNlbGVjdGVkKGZhbHNlKTtcclxuICAgICAgZGVsZXRlIHNlbGYuc2VsZWN0ZWRbaGFzaEtleV07XHJcbiAgICB9O1xyXG5cclxuICAgIHNlbGYuYWRkT3B0aW9uID0gZnVuY3Rpb24oaGFzaEtleSwgb3B0aW9uQ3RybCkge1xyXG4gICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoc2VsZi5vcHRpb25zW2hhc2hLZXldKSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRHVwbGljYXRlIG1kLW9wdGlvbiB2YWx1ZXMgYXJlIG5vdCBhbGxvd2VkIGluIGEgc2VsZWN0LiAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ0R1cGxpY2F0ZSB2YWx1ZSBcIicgKyBvcHRpb25DdHJsLnZhbHVlICsgJ1wiIGZvdW5kLicpO1xyXG4gICAgICB9XHJcbiAgICAgIHNlbGYub3B0aW9uc1toYXNoS2V5XSA9IG9wdGlvbkN0cmw7XHJcblxyXG4gICAgICAvLyBJZiB0aGlzIG9wdGlvbidzIHZhbHVlIHdhcyBhbHJlYWR5IGluIG91ciBuZ01vZGVsLCBnbyBhaGVhZCBhbmQgc2VsZWN0IGl0LlxyXG4gICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoc2VsZi5zZWxlY3RlZFtoYXNoS2V5XSkpIHtcclxuICAgICAgICBzZWxmLnNlbGVjdChoYXNoS2V5LCBvcHRpb25DdHJsLnZhbHVlKTtcclxuICAgICAgICBzZWxmLnJlZnJlc2hWaWV3VmFsdWUoKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIHNlbGYucmVtb3ZlT3B0aW9uID0gZnVuY3Rpb24oaGFzaEtleSkge1xyXG4gICAgICBkZWxldGUgc2VsZi5vcHRpb25zW2hhc2hLZXldO1xyXG4gICAgICAvLyBEb24ndCBkZXNlbGVjdCBhbiBvcHRpb24gd2hlbiBpdCdzIHJlbW92ZWQgLSB0aGUgdXNlcidzIG5nTW9kZWwgc2hvdWxkIGJlIGFsbG93ZWRcclxuICAgICAgLy8gdG8gaGF2ZSB2YWx1ZXMgdGhhdCBkbyBub3QgbWF0Y2ggYSBjdXJyZW50bHkgYXZhaWxhYmxlIG9wdGlvbi5cclxuICAgIH07XHJcblxyXG4gICAgc2VsZi5yZWZyZXNoVmlld1ZhbHVlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciB2YWx1ZXMgPSBbXTtcclxuICAgICAgdmFyIG9wdGlvbjtcclxuICAgICAgZm9yICh2YXIgaGFzaEtleSBpbiBzZWxmLnNlbGVjdGVkKSB7XHJcbiAgICAgICAgIC8vIElmIHRoaXMgaGFzaEtleSBoYXMgYW4gYXNzb2NpYXRlZCBvcHRpb24sIHB1c2ggdGhhdCBvcHRpb24ncyB2YWx1ZSB0byB0aGUgbW9kZWwuXHJcbiAgICAgICAgIGlmICgob3B0aW9uID0gc2VsZi5vcHRpb25zW2hhc2hLZXldKSkge1xyXG4gICAgICAgICAgIHZhbHVlcy5wdXNoKG9wdGlvbi52YWx1ZSk7XHJcbiAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgLy8gT3RoZXJ3aXNlLCB0aGUgZ2l2ZW4gaGFzaEtleSBoYXMgbm8gYXNzb2NpYXRlZCBvcHRpb24sIGFuZCB3ZSBnb3QgaXRcclxuICAgICAgICAgICAvLyBmcm9tIGFuIG5nTW9kZWwgdmFsdWUgYXQgYW4gZWFybGllciB0aW1lLiBQdXNoIHRoZSB1bmhhc2hlZCB2YWx1ZSBvZlxyXG4gICAgICAgICAgIC8vIHRoaXMgaGFzaEtleSB0byB0aGUgbW9kZWwuXHJcbiAgICAgICAgICAgLy8gVGhpcyBhbGxvd3MgdGhlIGRldmVsb3BlciB0byBwdXQgYSB2YWx1ZSBpbiB0aGUgbW9kZWwgdGhhdCBkb2Vzbid0IHlldCBoYXZlXHJcbiAgICAgICAgICAgLy8gYW4gYXNzb2NpYXRlZCBvcHRpb24uXHJcbiAgICAgICAgICAgdmFsdWVzLnB1c2goc2VsZi5zZWxlY3RlZFtoYXNoS2V5XSk7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBzZWxmLm5nTW9kZWwuJHNldFZpZXdWYWx1ZShzZWxmLmlzTXVsdGlwbGUgPyB2YWx1ZXMgOiB2YWx1ZXNbMF0pO1xyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiByZW5kZXJNdWx0aXBsZSgpIHtcclxuICAgICAgdmFyIG5ld1NlbGVjdGVkVmFsdWVzID0gc2VsZi5uZ01vZGVsLiRtb2RlbFZhbHVlIHx8IHNlbGYubmdNb2RlbC4kdmlld1ZhbHVlO1xyXG4gICAgICBpZiAoIWFuZ3VsYXIuaXNBcnJheShuZXdTZWxlY3RlZFZhbHVlcykpIHJldHVybjtcclxuXHJcbiAgICAgIHZhciBvbGRTZWxlY3RlZCA9IE9iamVjdC5rZXlzKHNlbGYuc2VsZWN0ZWQpO1xyXG5cclxuICAgICAgdmFyIG5ld1NlbGVjdGVkSGFzaGVzID0gbmV3U2VsZWN0ZWRWYWx1ZXMubWFwKHNlbGYuaGFzaEdldHRlcik7XHJcbiAgICAgIHZhciBkZXNlbGVjdGVkID0gb2xkU2VsZWN0ZWQuZmlsdGVyKGZ1bmN0aW9uKGhhc2gpIHtcclxuICAgICAgICByZXR1cm4gbmV3U2VsZWN0ZWRIYXNoZXMuaW5kZXhPZihoYXNoKSA9PT0gLTE7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgZGVzZWxlY3RlZC5mb3JFYWNoKHNlbGYuZGVzZWxlY3QpO1xyXG4gICAgICBuZXdTZWxlY3RlZEhhc2hlcy5mb3JFYWNoKGZ1bmN0aW9uKGhhc2hLZXksIGkpIHtcclxuICAgICAgICBzZWxmLnNlbGVjdChoYXNoS2V5LCBuZXdTZWxlY3RlZFZhbHVlc1tpXSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gcmVuZGVyU2luZ3VsYXIoKSB7XHJcbiAgICAgIHZhciB2YWx1ZSA9IHNlbGYubmdNb2RlbC4kdmlld1ZhbHVlIHx8IHNlbGYubmdNb2RlbC4kbW9kZWxWYWx1ZTtcclxuICAgICAgT2JqZWN0LmtleXMoc2VsZi5zZWxlY3RlZCkuZm9yRWFjaChzZWxmLmRlc2VsZWN0KTtcclxuICAgICAgc2VsZi5zZWxlY3QoIHNlbGYuaGFzaEdldHRlcih2YWx1ZSksIHZhbHVlICk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxufVxyXG5TZWxlY3RNZW51RGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkcGFyc2VcIiwgXCIkbWRVdGlsXCIsIFwiJG1kVGhlbWluZ1wiXTtcclxuXHJcbmZ1bmN0aW9uIE9wdGlvbkRpcmVjdGl2ZSgkbWRCdXR0b25JbmtSaXBwbGUsICRtZFV0aWwpIHtcclxuXHJcbiAgT3B0aW9uQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiJGVsZW1lbnRcIl07XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICByZXF1aXJlOiBbJ21kT3B0aW9uJywgJ15ebWRTZWxlY3RNZW51J10sXHJcbiAgICBjb250cm9sbGVyOiBPcHRpb25Db250cm9sbGVyLFxyXG4gICAgY29tcGlsZTogY29tcGlsZVxyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIGNvbXBpbGUoZWxlbWVudCwgYXR0cikge1xyXG4gICAgLy8gTWFudWFsIHRyYW5zY2x1c2lvbiB0byBhdm9pZCB0aGUgZXh0cmEgaW5uZXIgPHNwYW4+IHRoYXQgbmctdHJhbnNjbHVkZSBnZW5lcmF0ZXNcclxuICAgIGVsZW1lbnQuYXBwZW5kKCBhbmd1bGFyLmVsZW1lbnQoJzxkaXYgY2xhc3M9XCJtZC10ZXh0XCI+JykuYXBwZW5kKGVsZW1lbnQuY29udGVudHMoKSkgKTtcclxuXHJcbiAgICBlbGVtZW50LmF0dHIoJ3RhYmluZGV4JywgYXR0ci50YWJpbmRleCB8fCAnMCcpO1xyXG4gICAgcmV0dXJuIHBvc3RMaW5rO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmxzKSB7XHJcbiAgICB2YXIgb3B0aW9uQ3RybCA9IGN0cmxzWzBdO1xyXG4gICAgdmFyIHNlbGVjdEN0cmwgPSBjdHJsc1sxXTtcclxuXHJcbiAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoYXR0ci5uZ1ZhbHVlKSkge1xyXG4gICAgICBzY29wZS4kd2F0Y2goYXR0ci5uZ1ZhbHVlLCBzZXRPcHRpb25WYWx1ZSk7XHJcbiAgICB9IGVsc2UgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHIudmFsdWUpKSB7XHJcbiAgICAgIHNldE9wdGlvblZhbHVlKGF0dHIudmFsdWUpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2NvcGUuJHdhdGNoKGZ1bmN0aW9uKCkgeyByZXR1cm4gZWxlbWVudC50ZXh0KCk7IH0sIHNldE9wdGlvblZhbHVlKTtcclxuICAgIH1cclxuXHJcbiAgICBzY29wZS4kJHBvc3REaWdlc3QoZnVuY3Rpb24oKSB7XHJcbiAgICAgIGF0dHIuJG9ic2VydmUoJ3NlbGVjdGVkJywgZnVuY3Rpb24oc2VsZWN0ZWQpIHtcclxuICAgICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKHNlbGVjdGVkKSkgcmV0dXJuO1xyXG4gICAgICAgIGlmIChzZWxlY3RlZCkge1xyXG4gICAgICAgICAgaWYgKCFzZWxlY3RDdHJsLmlzTXVsdGlwbGUpIHtcclxuICAgICAgICAgICAgc2VsZWN0Q3RybC5kZXNlbGVjdCggT2JqZWN0LmtleXMoc2VsZWN0Q3RybC5zZWxlY3RlZClbMF0gKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHNlbGVjdEN0cmwuc2VsZWN0KG9wdGlvbkN0cmwuaGFzaEtleSwgb3B0aW9uQ3RybC52YWx1ZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHNlbGVjdEN0cmwuZGVzZWxlY3Qob3B0aW9uQ3RybC5oYXNoS2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc2VsZWN0Q3RybC5yZWZyZXNoVmlld1ZhbHVlKCk7XHJcbiAgICAgICAgc2VsZWN0Q3RybC5uZ01vZGVsLiRyZW5kZXIoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkbWRCdXR0b25JbmtSaXBwbGUuYXR0YWNoKHNjb3BlLCBlbGVtZW50KTtcclxuICAgIGNvbmZpZ3VyZUFyaWEoKTtcclxuXHJcbiAgICBmdW5jdGlvbiBzZXRPcHRpb25WYWx1ZShuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcclxuICAgICAgdmFyIG9sZEhhc2hLZXkgPSBzZWxlY3RDdHJsLmhhc2hHZXR0ZXIob2xkVmFsdWUsIHNjb3BlKTtcclxuICAgICAgdmFyIG5ld0hhc2hLZXkgPSBzZWxlY3RDdHJsLmhhc2hHZXR0ZXIobmV3VmFsdWUsIHNjb3BlKTtcclxuXHJcbiAgICAgIG9wdGlvbkN0cmwuaGFzaEtleSA9IG5ld0hhc2hLZXk7XHJcbiAgICAgIG9wdGlvbkN0cmwudmFsdWUgPSBuZXdWYWx1ZTtcclxuXHJcbiAgICAgIHNlbGVjdEN0cmwucmVtb3ZlT3B0aW9uKG9sZEhhc2hLZXksIG9wdGlvbkN0cmwpO1xyXG4gICAgICBzZWxlY3RDdHJsLmFkZE9wdGlvbihuZXdIYXNoS2V5LCBvcHRpb25DdHJsKTtcclxuICAgIH1cclxuXHJcbiAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIHNlbGVjdEN0cmwucmVtb3ZlT3B0aW9uKG9wdGlvbkN0cmwuaGFzaEtleSwgb3B0aW9uQ3RybCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBmdW5jdGlvbiBjb25maWd1cmVBcmlhKCkge1xyXG4gICAgICB2YXIgYXJpYUF0dHJzID0ge1xyXG4gICAgICAgICdyb2xlJzogJ29wdGlvbicsXHJcbiAgICAgICAgJ2FyaWEtc2VsZWN0ZWQnOiAnZmFsc2UnXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBpZiAoIWVsZW1lbnRbMF0uaGFzQXR0cmlidXRlKCdpZCcpKSB7XHJcbiAgICAgICAgYXJpYUF0dHJzLmlkID0gJ3NlbGVjdF9vcHRpb25fJyArICRtZFV0aWwubmV4dFVpZCgpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsZW1lbnQuYXR0cihhcmlhQXR0cnMpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gT3B0aW9uQ29udHJvbGxlcigkZWxlbWVudCkge1xyXG4gICAgdGhpcy5zZWxlY3RlZCA9IGZhbHNlO1xyXG4gICAgdGhpcy5zZXRTZWxlY3RlZCA9IGZ1bmN0aW9uKGlzU2VsZWN0ZWQpIHtcclxuICAgICAgaWYgKGlzU2VsZWN0ZWQgJiYgIXRoaXMuc2VsZWN0ZWQpIHtcclxuICAgICAgICAkZWxlbWVudC5hdHRyKHtcclxuICAgICAgICAgICdzZWxlY3RlZCc6ICdzZWxlY3RlZCcsXHJcbiAgICAgICAgICAnYXJpYS1zZWxlY3RlZCc6ICd0cnVlJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2UgaWYgKCFpc1NlbGVjdGVkICYmIHRoaXMuc2VsZWN0ZWQpIHtcclxuICAgICAgICAkZWxlbWVudC5yZW1vdmVBdHRyKCdzZWxlY3RlZCcpO1xyXG4gICAgICAgICRlbGVtZW50LmF0dHIoJ2FyaWEtc2VsZWN0ZWQnLCAnZmFsc2UnKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLnNlbGVjdGVkID0gaXNTZWxlY3RlZDtcclxuICAgIH07XHJcbiAgfVxyXG5cclxufVxyXG5PcHRpb25EaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZEJ1dHRvbklua1JpcHBsZVwiLCBcIiRtZFV0aWxcIl07XHJcblxyXG5mdW5jdGlvbiBPcHRncm91cERpcmVjdGl2ZSgpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgIGNvbXBpbGU6IGNvbXBpbGVcclxuICB9O1xyXG4gIGZ1bmN0aW9uIGNvbXBpbGUoZWwsIGF0dHJzKSB7XHJcbiAgICB2YXIgbGFiZWxFbGVtZW50ID0gZWwuZmluZCgnbGFiZWwnKTtcclxuICAgIGlmICghbGFiZWxFbGVtZW50Lmxlbmd0aCkge1xyXG4gICAgICBsYWJlbEVsZW1lbnQgPSBhbmd1bGFyLmVsZW1lbnQoJzxsYWJlbD4nKTtcclxuICAgICAgZWwucHJlcGVuZChsYWJlbEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gICAgaWYgKGF0dHJzLmxhYmVsKSBsYWJlbEVsZW1lbnQudGV4dChhdHRycy5sYWJlbCk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBTZWxlY3RQcm92aWRlcigkJGludGVyaW1FbGVtZW50UHJvdmlkZXIpIHtcclxuICBzZWxlY3REZWZhdWx0T3B0aW9ucy4kaW5qZWN0ID0gW1wiJG1kU2VsZWN0XCIsIFwiJG1kQ29uc3RhbnRcIiwgXCIkJHJBRlwiLCBcIiRtZFV0aWxcIiwgXCIkbWRUaGVtaW5nXCIsIFwiJHRpbWVvdXRcIiwgXCIkd2luZG93XCJdO1xyXG4gIHJldHVybiAkJGludGVyaW1FbGVtZW50UHJvdmlkZXIoJyRtZFNlbGVjdCcpXHJcbiAgICAuc2V0RGVmYXVsdHMoe1xyXG4gICAgICBtZXRob2RzOiBbJ3RhcmdldCddLFxyXG4gICAgICBvcHRpb25zOiBzZWxlY3REZWZhdWx0T3B0aW9uc1xyXG4gICAgfSk7XHJcblxyXG4gIC8qIEBuZ0luamVjdCAqL1xyXG4gIGZ1bmN0aW9uIHNlbGVjdERlZmF1bHRPcHRpb25zKCRtZFNlbGVjdCwgJG1kQ29uc3RhbnQsICQkckFGLCAkbWRVdGlsLCAkbWRUaGVtaW5nLCAkdGltZW91dCwgJHdpbmRvdyApIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHBhcmVudDogJ2JvZHknLFxyXG4gICAgICBvblNob3c6IG9uU2hvdyxcclxuICAgICAgb25SZW1vdmU6IG9uUmVtb3ZlLFxyXG4gICAgICBoYXNCYWNrZHJvcDogdHJ1ZSxcclxuICAgICAgZGlzYWJsZVBhcmVudFNjcm9sbDogdHJ1ZSxcclxuICAgICAgdGhlbWFibGU6IHRydWVcclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gb25TaG93KHNjb3BlLCBlbGVtZW50LCBvcHRzKSB7XHJcbiAgICAgIGlmICghb3B0cy50YXJnZXQpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJyRtZFNlbGVjdC5zaG93KCkgZXhwZWN0ZWQgYSB0YXJnZXQgZWxlbWVudCBpbiBvcHRpb25zLnRhcmdldCBidXQgZ290ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnXCInICsgb3B0cy50YXJnZXQgKyAnXCIhJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGFuZ3VsYXIuZXh0ZW5kKG9wdHMsIHtcclxuICAgICAgICBpc1JlbW92ZWQ6IGZhbHNlLFxyXG4gICAgICAgIHRhcmdldDogYW5ndWxhci5lbGVtZW50KG9wdHMudGFyZ2V0KSwgLy9tYWtlIHN1cmUgaXQncyBub3QgYSBuYWtlZCBkb20gbm9kZVxyXG4gICAgICAgIHBhcmVudDogYW5ndWxhci5lbGVtZW50KG9wdHMucGFyZW50KSxcclxuICAgICAgICBzZWxlY3RFbDogZWxlbWVudC5maW5kKCdtZC1zZWxlY3QtbWVudScpLFxyXG4gICAgICAgIGNvbnRlbnRFbDogZWxlbWVudC5maW5kKCdtZC1jb250ZW50JyksXHJcbiAgICAgICAgYmFja2Ryb3A6IG9wdHMuaGFzQmFja2Ryb3AgJiYgYW5ndWxhci5lbGVtZW50KCc8bWQtYmFja2Ryb3AgY2xhc3M9XCJtZC1zZWxlY3QtYmFja2Ryb3AgbWQtY2xpY2stY2F0Y2hlclwiPicpXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgb3B0cy5yZXNpemVGbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICQkckFGKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgJCRyQUYoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGFuaW1hdGVTZWxlY3Qoc2NvcGUsIGVsZW1lbnQsIG9wdHMpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdykub24oJ3Jlc2l6ZScsIG9wdHMucmVzaXplRm4pO1xyXG4gICAgICBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdykub24oJ29yaWVudGF0aW9uY2hhbmdlJywgb3B0cy5yZXNpemVGbik7XHJcblxyXG5cclxuICAgICAgY29uZmlndXJlQXJpYSgpO1xyXG5cclxuICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcygnbWQtbGVhdmUnKTtcclxuXHJcbiAgICAgIHZhciBvcHRpb25Ob2RlcyA9IG9wdHMuc2VsZWN0RWxbMF0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ21kLW9wdGlvbicpO1xyXG5cclxuICAgICAgaWYgKG9wdHMubG9hZGluZ0FzeW5jICYmIG9wdHMubG9hZGluZ0FzeW5jLnRoZW4pIHtcclxuICAgICAgICBvcHRzLmxvYWRpbmdBc3luYy50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgc2NvcGUuJCRsb2FkaW5nQXN5bmNEb25lID0gdHJ1ZTtcclxuICAgICAgICAgIC8vIEdpdmUgb3Vyc2VsdmVzIHR3byBmcmFtZXMgZm9yIHRoZSBwcm9ncmVzcyBsb2FkZXIgdG8gY2xlYXIgb3V0LlxyXG4gICAgICAgICAgJCRyQUYoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICQkckFGKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIC8vIERvbid0IGdvIGZvcndhcmQgaWYgdGhlIHNlbGVjdCBoYXMgYmVlbiByZW1vdmVkIGluIHRoaXMgdGltZS4uLlxyXG4gICAgICAgICAgICAgIGlmIChvcHRzLmlzUmVtb3ZlZCkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgIGFuaW1hdGVTZWxlY3Qoc2NvcGUsIGVsZW1lbnQsIG9wdHMpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2UgaWYgKG9wdHMubG9hZGluZ0FzeW5jKSB7XHJcbiAgICAgICAgc2NvcGUuJCRsb2FkaW5nQXN5bmNEb25lID0gdHJ1ZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKG9wdHMuZGlzYWJsZVBhcmVudFNjcm9sbCAmJiAhJG1kVXRpbC5nZXRDbG9zZXN0KG9wdHMudGFyZ2V0LCAnTUQtRElBTE9HJykpIHtcclxuICAgICAgICBvcHRzLnJlc3RvcmVTY3JvbGwgPSAkbWRVdGlsLmRpc2FibGVTY3JvbGxBcm91bmQob3B0cy5lbGVtZW50KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBvcHRzLmRpc2FibGVQYXJlbnRTY3JvbGwgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICAvLyBPbmx5IGFjdGl2YXRlIGNsaWNrIGxpc3RlbmVycyBhZnRlciBhIHNob3J0IHRpbWUgdG8gc3RvcCBhY2NpZGVudGFsIGRvdWJsZSB0YXBzL2NsaWNrc1xyXG4gICAgICAvLyBmcm9tIGNsaWNraW5nIHRoZSB3cm9uZyBpdGVtXHJcbiAgICAgICR0aW1lb3V0KGFjdGl2YXRlSW50ZXJhY3Rpb24sIDc1LCBmYWxzZSk7XHJcblxyXG4gICAgICBpZiAob3B0cy5iYWNrZHJvcCkge1xyXG4gICAgICAgICRtZFRoZW1pbmcuaW5oZXJpdChvcHRzLmJhY2tkcm9wLCBvcHRzLnBhcmVudCk7XHJcbiAgICAgICAgb3B0cy5wYXJlbnQuYXBwZW5kKG9wdHMuYmFja2Ryb3ApO1xyXG4gICAgICB9XHJcbiAgICAgIG9wdHMucGFyZW50LmFwcGVuZChlbGVtZW50KTtcclxuXHJcbiAgICAgIC8vIEdpdmUgdGhlIHNlbGVjdCBhIGZyYW1lIHRvICdpbml0aWFsaXplJyBpbiB0aGUgRE9NLFxyXG4gICAgICAvLyBzbyB3ZSBjYW4gcmVhZCBpdHMgaGVpZ2h0L3dpZHRoL3Bvc2l0aW9uXHJcbiAgICAgICQkckFGKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICQkckFGKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgaWYgKG9wdHMuaXNSZW1vdmVkKSByZXR1cm47XHJcbiAgICAgICAgICBhbmltYXRlU2VsZWN0KHNjb3BlLCBlbGVtZW50LCBvcHRzKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZXR1cm4gJG1kVXRpbC50cmFuc2l0aW9uRW5kUHJvbWlzZShvcHRzLnNlbGVjdEVsLCB7dGltZW91dDogMzUwfSk7XHJcblxyXG4gICAgICBmdW5jdGlvbiBjb25maWd1cmVBcmlhKCkge1xyXG4gICAgICAgIG9wdHMudGFyZ2V0LmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCAndHJ1ZScpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBhY3RpdmF0ZUludGVyYWN0aW9uKCkge1xyXG4gICAgICAgIGlmIChvcHRzLmlzUmVtb3ZlZCkgcmV0dXJuO1xyXG4gICAgICAgIHZhciBzZWxlY3RDdHJsID0gb3B0cy5zZWxlY3RFbC5jb250cm9sbGVyKCdtZFNlbGVjdE1lbnUnKSB8fCB7fTtcclxuICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdtZC1jbGlja2FibGUnKTtcclxuXHJcbiAgICAgICAgb3B0cy5iYWNrZHJvcCAmJiBvcHRzLmJhY2tkcm9wLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICBvcHRzLnJlc3RvcmVGb2N1cyA9IGZhbHNlO1xyXG4gICAgICAgICAgc2NvcGUuJGFwcGx5KCRtZFNlbGVjdC5jYW5jZWwpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBFc2NhcGUgdG8gY2xvc2VcclxuICAgICAgICBvcHRzLnNlbGVjdEVsLm9uKCdrZXlkb3duJywgZnVuY3Rpb24oZXYpIHtcclxuICAgICAgICAgIHN3aXRjaCAoZXYua2V5Q29kZSkge1xyXG4gICAgICAgICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLlNQQUNFOlxyXG4gICAgICAgICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLkVOVEVSOlxyXG4gICAgICAgICAgICAgIHZhciBvcHRpb24gPSAkbWRVdGlsLmdldENsb3Nlc3QoZXYudGFyZ2V0LCAnbWQtb3B0aW9uJyk7XHJcbiAgICAgICAgICAgICAgaWYgKG9wdGlvbikge1xyXG4gICAgICAgICAgICAgICAgb3B0cy5zZWxlY3RFbC50cmlnZ2VySGFuZGxlcih7XHJcbiAgICAgICAgICAgICAgICAgIHR5cGU6ICdjbGljaycsXHJcbiAgICAgICAgICAgICAgICAgIHRhcmdldDogb3B0aW9uXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLlRBQjpcclxuICAgICAgICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5FU0NBUEU6XHJcbiAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICBvcHRzLnJlc3RvcmVGb2N1cyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KCRtZFNlbGVjdC5jYW5jZWwpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBDeWNsaW5nIG9mIG9wdGlvbnMsIGFuZCBjbG9zaW5nIG9uIGVudGVyXHJcbiAgICAgICAgb3B0cy5zZWxlY3RFbC5vbigna2V5ZG93bicsIGZ1bmN0aW9uKGV2KSB7XHJcbiAgICAgICAgICBzd2l0Y2ggKGV2LmtleUNvZGUpIHtcclxuICAgICAgICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5VUF9BUlJPVzogcmV0dXJuIGZvY3VzUHJldk9wdGlvbigpO1xyXG4gICAgICAgICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLkRPV05fQVJST1c6IHJldHVybiBmb2N1c05leHRPcHRpb24oKTtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICBpZiAoZXYua2V5Q29kZSA+PSAzMSAmJiBldi5rZXlDb2RlIDw9IDkwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgb3B0Tm9kZSA9IG9wdHMuc2VsZWN0RWwuY29udHJvbGxlcignbWRTZWxlY3RNZW51Jykub3B0Tm9kZUZvcktleWJvYXJkU2VhcmNoKGV2KTtcclxuICAgICAgICAgICAgICAgIG9wdE5vZGUgJiYgb3B0Tm9kZS5mb2N1cygpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGZvY3VzT3B0aW9uKGRpcmVjdGlvbikge1xyXG4gICAgICAgICAgdmFyIG9wdGlvbnNBcnJheSA9ICRtZFV0aWwubm9kZXNUb0FycmF5KG9wdGlvbk5vZGVzKTtcclxuICAgICAgICAgIHZhciBpbmRleCA9IG9wdGlvbnNBcnJheS5pbmRleE9mKG9wdHMuZm9jdXNlZE5vZGUpO1xyXG4gICAgICAgICAgaWYgKGluZGV4ID09PSAtMSkge1xyXG4gICAgICAgICAgICAvLyBXZSBsb3N0IHRoZSBwcmV2aW91c2x5IGZvY3VzZWQgZWxlbWVudCwgcmVzZXQgdG8gZmlyc3Qgb3B0aW9uXHJcbiAgICAgICAgICAgIGluZGV4ID0gMDtcclxuICAgICAgICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSAnbmV4dCcgJiYgaW5kZXggPCBvcHRpb25zQXJyYXkubGVuZ3RoIC0gMSkge1xyXG4gICAgICAgICAgICBpbmRleCsrO1xyXG4gICAgICAgICAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT09ICdwcmV2JyAmJiBpbmRleCA+IDApIHtcclxuICAgICAgICAgICAgaW5kZXgtLTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHZhciBuZXdPcHRpb24gPSBvcHRzLmZvY3VzZWROb2RlID0gb3B0aW9uc0FycmF5W2luZGV4XTtcclxuICAgICAgICAgIG5ld09wdGlvbiAmJiBuZXdPcHRpb24uZm9jdXMoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gZm9jdXNOZXh0T3B0aW9uKCkge1xyXG4gICAgICAgICAgZm9jdXNPcHRpb24oJ25leHQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gZm9jdXNQcmV2T3B0aW9uKCkge1xyXG4gICAgICAgICAgZm9jdXNPcHRpb24oJ3ByZXYnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG9wdHMuc2VsZWN0RWwub24oJ2NsaWNrJywgY2hlY2tDbG9zZU1lbnUpO1xyXG4gICAgICAgIG9wdHMuc2VsZWN0RWwub24oJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICBpZiAoZS5rZXlDb2RlID09IDMyIHx8IGUua2V5Q29kZSA9PSAxMykge1xyXG4gICAgICAgICAgICBjaGVja0Nsb3NlTWVudSgpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBjaGVja0Nsb3NlTWVudSgpIHtcclxuICAgICAgICAgIGlmICghc2VsZWN0Q3RybC5pc011bHRpcGxlKSB7XHJcbiAgICAgICAgICAgIG9wdHMucmVzdG9yZUZvY3VzID0gdHJ1ZTtcclxuICAgICAgICAgICAgc2NvcGUuJGV2YWxBc3luYyhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAkbWRTZWxlY3QuaGlkZShzZWxlY3RDdHJsLm5nTW9kZWwuJHZpZXdWYWx1ZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBvblJlbW92ZShzY29wZSwgZWxlbWVudCwgb3B0cykge1xyXG4gICAgICBvcHRzLmlzUmVtb3ZlZCA9IHRydWU7XHJcbiAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ21kLWxlYXZlJylcclxuICAgICAgICAucmVtb3ZlQ2xhc3MoJ21kLWNsaWNrYWJsZScpO1xyXG4gICAgICBvcHRzLnRhcmdldC5hdHRyKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XHJcblxyXG5cclxuICAgICAgYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpLm9mZigncmVzaXplJywgb3B0cy5yZXNpemVGbik7XHJcbiAgICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vZmYoJ29yaWVudGF0aW9uY2hhbmdlJywgb3B0cy5yZXNpemVmbik7XHJcbiAgICAgIG9wdHMucmVzaXplRm4gPSB1bmRlZmluZWQ7XHJcblxyXG4gICAgICB2YXIgbWRTZWxlY3QgPSBvcHRzLnNlbGVjdEVsLmNvbnRyb2xsZXIoJ21kU2VsZWN0Jyk7XHJcbiAgICAgIGlmIChtZFNlbGVjdCkge1xyXG4gICAgICAgIG1kU2VsZWN0LnNldExhYmVsVGV4dChvcHRzLnNlbGVjdEVsLmNvbnRyb2xsZXIoJ21kU2VsZWN0TWVudScpLnNlbGVjdGVkTGFiZWxzKCkpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gJG1kVXRpbC50cmFuc2l0aW9uRW5kUHJvbWlzZShlbGVtZW50LCB7IHRpbWVvdXQ6IDM1MCB9KS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21kLWFjdGl2ZScpO1xyXG4gICAgICAgIG9wdHMuYmFja2Ryb3AgJiYgb3B0cy5iYWNrZHJvcC5yZW1vdmUoKTtcclxuICAgICAgICBpZiAoZWxlbWVudFswXS5wYXJlbnROb2RlID09PSBvcHRzLnBhcmVudFswXSkge1xyXG4gICAgICAgICAgb3B0cy5wYXJlbnRbMF0ucmVtb3ZlQ2hpbGQoZWxlbWVudFswXSk7IC8vIHVzZSBicm93c2VyIHRvIGF2b2lkICRkZXN0cm95IGV2ZW50XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChvcHRzLmRpc2FibGVQYXJlbnRTY3JvbGwpIHtcclxuICAgICAgICAgIG9wdHMucmVzdG9yZVNjcm9sbCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob3B0cy5yZXN0b3JlRm9jdXMpIG9wdHMudGFyZ2V0LmZvY3VzKCk7XHJcbiAgICAgICAgbWRTZWxlY3QgJiYgbWRTZWxlY3QudHJpZ2dlckNsb3NlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGFuaW1hdGVTZWxlY3Qoc2NvcGUsIGVsZW1lbnQsIG9wdHMpIHtcclxuICAgICAgdmFyIGNvbnRhaW5lck5vZGUgPSBlbGVtZW50WzBdLFxyXG4gICAgICAgICAgdGFyZ2V0Tm9kZSA9IG9wdHMudGFyZ2V0WzBdLmZpcnN0RWxlbWVudENoaWxkLmZpcnN0RWxlbWVudENoaWxkLCAvLyB0YXJnZXQgdGhlIGZpcnN0IHNwYW4sIGZ1bmN0aW9uaW5nIGFzIHRoZSBsYWJlbFxyXG4gICAgICAgICAgcGFyZW50Tm9kZSA9IG9wdHMucGFyZW50WzBdLFxyXG4gICAgICAgICAgc2VsZWN0Tm9kZSA9IG9wdHMuc2VsZWN0RWxbMF0sXHJcbiAgICAgICAgICBjb250ZW50Tm9kZSA9IG9wdHMuY29udGVudEVsWzBdLFxyXG4gICAgICAgICAgcGFyZW50UmVjdCA9IHBhcmVudE5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXHJcbiAgICAgICAgICB0YXJnZXRSZWN0ID0gdGFyZ2V0Tm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcclxuICAgICAgICAgIHNob3VsZE9wZW5Bcm91bmRUYXJnZXQgPSBmYWxzZSxcclxuICAgICAgICAgIGJvdW5kcyA9IHtcclxuICAgICAgICAgICAgbGVmdDogcGFyZW50UmVjdC5sZWZ0ICsgU0VMRUNUX0VER0VfTUFSR0lOLFxyXG4gICAgICAgICAgICB0b3A6IFNFTEVDVF9FREdFX01BUkdJTixcclxuICAgICAgICAgICAgYm90dG9tOiBwYXJlbnRSZWN0LmhlaWdodCAtIFNFTEVDVF9FREdFX01BUkdJTixcclxuICAgICAgICAgICAgcmlnaHQ6IHBhcmVudFJlY3Qud2lkdGggLSBTRUxFQ1RfRURHRV9NQVJHSU4gLSAoJG1kVXRpbC5mbG9hdGluZ1Njcm9sbGJhcnMoKSA/IDE2IDogMClcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBzcGFjZUF2YWlsYWJsZSA9IHtcclxuICAgICAgICAgICAgdG9wOiB0YXJnZXRSZWN0LnRvcCAtIGJvdW5kcy50b3AsXHJcbiAgICAgICAgICAgIGxlZnQ6IHRhcmdldFJlY3QubGVmdCAtIGJvdW5kcy5sZWZ0LFxyXG4gICAgICAgICAgICByaWdodDogYm91bmRzLnJpZ2h0IC0gKHRhcmdldFJlY3QubGVmdCArIHRhcmdldFJlY3Qud2lkdGgpLFxyXG4gICAgICAgICAgICBib3R0b206IGJvdW5kcy5ib3R0b20gLSAodGFyZ2V0UmVjdC50b3AgKyB0YXJnZXRSZWN0LmhlaWdodClcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBtYXhXaWR0aCA9IHBhcmVudFJlY3Qud2lkdGggLSBTRUxFQ1RfRURHRV9NQVJHSU4gKiAyLFxyXG4gICAgICAgICAgaXNTY3JvbGxhYmxlID0gY29udGVudE5vZGUuc2Nyb2xsSGVpZ2h0ID4gY29udGVudE5vZGUub2Zmc2V0SGVpZ2h0LFxyXG4gICAgICAgICAgc2VsZWN0ZWROb2RlID0gc2VsZWN0Tm9kZS5xdWVyeVNlbGVjdG9yKCdtZC1vcHRpb25bc2VsZWN0ZWRdJyksXHJcbiAgICAgICAgICBvcHRpb25Ob2RlcyA9IHNlbGVjdE5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ21kLW9wdGlvbicpLFxyXG4gICAgICAgICAgb3B0Z3JvdXBOb2RlcyA9IHNlbGVjdE5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ21kLW9wdGdyb3VwJyk7XHJcblxyXG5cclxuICAgICAgdmFyIGNlbnRlcmVkTm9kZTtcclxuICAgICAgLy8gSWYgYSBzZWxlY3RlZCBub2RlLCBjZW50ZXIgYXJvdW5kIHRoYXRcclxuICAgICAgaWYgKHNlbGVjdGVkTm9kZSkge1xyXG4gICAgICAgIGNlbnRlcmVkTm9kZSA9IHNlbGVjdGVkTm9kZTtcclxuICAgICAgLy8gSWYgdGhlcmUgYXJlIG9wdGlvbiBncm91cHMsIGNlbnRlciBhcm91bmQgdGhlIGZpcnN0IG9wdGlvbiBncm91cFxyXG4gICAgICB9IGVsc2UgaWYgKG9wdGdyb3VwTm9kZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgY2VudGVyZWROb2RlID0gb3B0Z3JvdXBOb2Rlc1swXTtcclxuICAgICAgLy8gT3RoZXJ3aXNlLCBjZW50ZXIgYXJvdW5kIHRoZSBmaXJzdCBvcHRpb25Ob2RlXHJcbiAgICAgIH0gZWxzZSBpZiAob3B0aW9uTm9kZXMubGVuZ3RoKXtcclxuICAgICAgICBjZW50ZXJlZE5vZGUgPSBvcHRpb25Ob2Rlc1swXTtcclxuICAgICAgLy8gSW4gY2FzZSB0aGVyZSBhcmUgbm8gb3B0aW9ucywgY2VudGVyIG9uIHdoYXRldmVyJ3MgaW4gdGhlcmUuLi4gKGVnIHByb2dyZXNzIGluZGljYXRvcilcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjZW50ZXJlZE5vZGUgPSBjb250ZW50Tm9kZS5maXJzdEVsZW1lbnRDaGlsZCB8fCBjb250ZW50Tm9kZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKGNvbnRlbnROb2RlLm9mZnNldFdpZHRoID4gbWF4V2lkdGgpIHtcclxuICAgICAgICBjb250ZW50Tm9kZS5zdHlsZVsnbWF4LXdpZHRoJ10gPSBtYXhXaWR0aCArICdweCc7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHNob3VsZE9wZW5Bcm91bmRUYXJnZXQpIHtcclxuICAgICAgICBjb250ZW50Tm9kZS5zdHlsZVsnbWluLXdpZHRoJ10gPSB0YXJnZXRSZWN0LndpZHRoICsgJ3B4JztcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gUmVtb3ZlIHBhZGRpbmcgYmVmb3JlIHdlIGNvbXB1dGUgdGhlIHBvc2l0aW9uIG9mIHRoZSBtZW51XHJcbiAgICAgIGlmIChpc1Njcm9sbGFibGUpIHtcclxuICAgICAgICBzZWxlY3ROb2RlLmNsYXNzTGlzdC5hZGQoJ21kLW92ZXJmbG93Jyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEdldCB0aGUgc2VsZWN0TWVudVJlY3QgKmFmdGVyKiBtYXgtd2lkdGggaXMgcG9zc2libHkgc2V0IGFib3ZlXHJcbiAgICAgIHZhciBzZWxlY3RNZW51UmVjdCA9IHNlbGVjdE5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgIHZhciBjZW50ZXJlZFJlY3QgPSBnZXRPZmZzZXRSZWN0KGNlbnRlcmVkTm9kZSk7XHJcblxyXG4gICAgICBpZiAoY2VudGVyZWROb2RlKSB7XHJcbiAgICAgICAgdmFyIGNlbnRlcmVkU3R5bGUgPSAkd2luZG93LmdldENvbXB1dGVkU3R5bGUoY2VudGVyZWROb2RlKTtcclxuICAgICAgICBjZW50ZXJlZFJlY3QucGFkZGluZ0xlZnQgPSBwYXJzZUludChjZW50ZXJlZFN0eWxlLnBhZGRpbmdMZWZ0LCAxMCkgfHwgMDtcclxuICAgICAgICBjZW50ZXJlZFJlY3QucGFkZGluZ1JpZ2h0ID0gcGFyc2VJbnQoY2VudGVyZWRTdHlsZS5wYWRkaW5nUmlnaHQsIDEwKSB8fCAwO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB2YXIgZm9jdXNlZE5vZGUgPSBjZW50ZXJlZE5vZGU7XHJcbiAgICAgIGlmICgoZm9jdXNlZE5vZGUudGFnTmFtZSB8fCAnJykudG9VcHBlckNhc2UoKSA9PT0gJ01ELU9QVEdST1VQJykge1xyXG4gICAgICAgIGZvY3VzZWROb2RlID0gb3B0aW9uTm9kZXNbMF0gfHwgY29udGVudE5vZGUuZmlyc3RFbGVtZW50Q2hpbGQgfHwgY29udGVudE5vZGU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChpc1Njcm9sbGFibGUpIHtcclxuICAgICAgICB2YXIgc2Nyb2xsQnVmZmVyID0gY29udGVudE5vZGUub2Zmc2V0SGVpZ2h0IC8gMjtcclxuICAgICAgICBjb250ZW50Tm9kZS5zY3JvbGxUb3AgPSBjZW50ZXJlZFJlY3QudG9wICsgY2VudGVyZWRSZWN0LmhlaWdodCAvIDIgLSBzY3JvbGxCdWZmZXI7XHJcblxyXG4gICAgICAgIGlmIChzcGFjZUF2YWlsYWJsZS50b3AgPCBzY3JvbGxCdWZmZXIpIHtcclxuICAgICAgICAgIGNvbnRlbnROb2RlLnNjcm9sbFRvcCA9IE1hdGgubWluKFxyXG4gICAgICAgICAgICBjZW50ZXJlZFJlY3QudG9wLFxyXG4gICAgICAgICAgICBjb250ZW50Tm9kZS5zY3JvbGxUb3AgKyBzY3JvbGxCdWZmZXIgLSBzcGFjZUF2YWlsYWJsZS50b3BcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChzcGFjZUF2YWlsYWJsZS5ib3R0b20gPCBzY3JvbGxCdWZmZXIpIHtcclxuICAgICAgICAgIGNvbnRlbnROb2RlLnNjcm9sbFRvcCA9IE1hdGgubWF4KFxyXG4gICAgICAgICAgICBjZW50ZXJlZFJlY3QudG9wICsgY2VudGVyZWRSZWN0LmhlaWdodCAtIHNlbGVjdE1lbnVSZWN0LmhlaWdodCxcclxuICAgICAgICAgICAgY29udGVudE5vZGUuc2Nyb2xsVG9wIC0gc2Nyb2xsQnVmZmVyICsgc3BhY2VBdmFpbGFibGUuYm90dG9tXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIGxlZnQsIHRvcCwgdHJhbnNmb3JtT3JpZ2luO1xyXG4gICAgICBpZiAoc2hvdWxkT3BlbkFyb3VuZFRhcmdldCkge1xyXG4gICAgICAgIGxlZnQgPSB0YXJnZXRSZWN0LmxlZnQ7XHJcbiAgICAgICAgdG9wID0gdGFyZ2V0UmVjdC50b3AgKyB0YXJnZXRSZWN0LmhlaWdodDtcclxuICAgICAgICB0cmFuc2Zvcm1PcmlnaW4gPSAnNTAlIDAnO1xyXG4gICAgICAgIGlmICh0b3AgKyBzZWxlY3RNZW51UmVjdC5oZWlnaHQgPiBib3VuZHMuYm90dG9tKSB7XHJcbiAgICAgICAgICB0b3AgPSB0YXJnZXRSZWN0LnRvcCAtIHNlbGVjdE1lbnVSZWN0LmhlaWdodDtcclxuICAgICAgICAgIHRyYW5zZm9ybU9yaWdpbiA9ICc1MCUgMTAwJSc7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGxlZnQgPSB0YXJnZXRSZWN0LmxlZnQgKyBjZW50ZXJlZFJlY3QubGVmdCAtIGNlbnRlcmVkUmVjdC5wYWRkaW5nTGVmdDtcclxuICAgICAgICB0b3AgPSBNYXRoLmZsb29yKHRhcmdldFJlY3QudG9wICsgdGFyZ2V0UmVjdC5oZWlnaHQgLyAyIC0gY2VudGVyZWRSZWN0LmhlaWdodCAvIDIgLVxyXG4gICAgICAgICAgY2VudGVyZWRSZWN0LnRvcCArIGNvbnRlbnROb2RlLnNjcm9sbFRvcCk7XHJcblxyXG5cclxuICAgICAgICB0cmFuc2Zvcm1PcmlnaW4gPSAoY2VudGVyZWRSZWN0LmxlZnQgKyB0YXJnZXRSZWN0LndpZHRoIC8gMikgKyAncHggJyArXHJcbiAgICAgICAgKGNlbnRlcmVkUmVjdC50b3AgKyBjZW50ZXJlZFJlY3QuaGVpZ2h0IC8gMiAtIGNvbnRlbnROb2RlLnNjcm9sbFRvcCkgKyAncHggMHB4JztcclxuXHJcbiAgICAgICAgY29udGFpbmVyTm9kZS5zdHlsZS5taW5XaWR0aCA9IHRhcmdldFJlY3Qud2lkdGggKyBjZW50ZXJlZFJlY3QucGFkZGluZ0xlZnQgK1xyXG4gICAgICAgICAgY2VudGVyZWRSZWN0LnBhZGRpbmdSaWdodCArICdweCc7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEtlZXAgbGVmdCBhbmQgdG9wIHdpdGhpbiB0aGUgd2luZG93XHJcbiAgICAgIHZhciBjb250YWluZXJSZWN0ID0gY29udGFpbmVyTm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgY29udGFpbmVyTm9kZS5zdHlsZS5sZWZ0ID0gY2xhbXAoYm91bmRzLmxlZnQsIGxlZnQsIGJvdW5kcy5yaWdodCAtIGNvbnRhaW5lclJlY3Qud2lkdGgpICsgJ3B4JztcclxuICAgICAgY29udGFpbmVyTm9kZS5zdHlsZS50b3AgPSBjbGFtcChib3VuZHMudG9wLCB0b3AsIGJvdW5kcy5ib3R0b20gLSBjb250YWluZXJSZWN0LmhlaWdodCkgKyAncHgnO1xyXG4gICAgICBzZWxlY3ROb2RlLnN0eWxlWyRtZENvbnN0YW50LkNTUy5UUkFOU0ZPUk1fT1JJR0lOXSA9IHRyYW5zZm9ybU9yaWdpbjtcclxuXHJcbiAgICAgIHNlbGVjdE5vZGUuc3R5bGVbJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STV0gPSAnc2NhbGUoJyArXHJcbiAgICAgICAgTWF0aC5taW4odGFyZ2V0UmVjdC53aWR0aCAvIHNlbGVjdE1lbnVSZWN0LndpZHRoLCAxLjApICsgJywnICtcclxuICAgICAgICBNYXRoLm1pbih0YXJnZXRSZWN0LmhlaWdodCAvIHNlbGVjdE1lbnVSZWN0LmhlaWdodCwgMS4wKSArXHJcbiAgICAgICcpJztcclxuXHJcblxyXG4gICAgICAkJHJBRihmdW5jdGlvbigpIHtcclxuICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdtZC1hY3RpdmUnKTtcclxuICAgICAgICBzZWxlY3ROb2RlLnN0eWxlWyRtZENvbnN0YW50LkNTUy5UUkFOU0ZPUk1dID0gJyc7XHJcbiAgICAgICAgaWYgKGZvY3VzZWROb2RlKSB7XHJcbiAgICAgICAgICBvcHRzLmZvY3VzZWROb2RlID0gZm9jdXNlZE5vZGU7XHJcbiAgICAgICAgICBmb2N1c2VkTm9kZS5mb2N1cygpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gY2xhbXAobWluLCBuLCBtYXgpIHtcclxuICAgIHJldHVybiBNYXRoLm1heChtaW4sIE1hdGgubWluKG4sIG1heCkpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZ2V0T2Zmc2V0UmVjdChub2RlKSB7XHJcbiAgICByZXR1cm4gbm9kZSA/IHtcclxuICAgICAgbGVmdDogbm9kZS5vZmZzZXRMZWZ0LFxyXG4gICAgICB0b3A6IG5vZGUub2Zmc2V0VG9wLFxyXG4gICAgICB3aWR0aDogbm9kZS5vZmZzZXRXaWR0aCxcclxuICAgICAgaGVpZ2h0OiBub2RlLm9mZnNldEhlaWdodFxyXG4gICAgfSA6IHsgbGVmdDogMCwgdG9wOiAwLCB3aWR0aDogMCwgaGVpZ2h0OiAwIH07XHJcbiAgfVxyXG59XHJcblNlbGVjdFByb3ZpZGVyLiRpbmplY3QgPSBbXCIkJGludGVyaW1FbGVtZW50UHJvdmlkZXJcIl07XHJcblxyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtb2R1bGVcclxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5zaWRlbmF2XHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBBIFNpZGVuYXYgUVAgY29tcG9uZW50LlxyXG4gKi9cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuc2lkZW5hdicsIFtcclxuICAgICdtYXRlcmlhbC5jb3JlJyxcclxuICAgICdtYXRlcmlhbC5jb21wb25lbnRzLmJhY2tkcm9wJ1xyXG4gIF0pXHJcbiAgLmZhY3RvcnkoJyRtZFNpZGVuYXYnLCBTaWRlbmF2U2VydmljZSApXHJcbiAgLmRpcmVjdGl2ZSgnbWRTaWRlbmF2JywgU2lkZW5hdkRpcmVjdGl2ZSlcclxuICAuZGlyZWN0aXZlKCdtZFNpZGVuYXZGb2N1cycsIFNpZGVuYXZGb2N1c0RpcmVjdGl2ZSlcclxuICAuY29udHJvbGxlcignJG1kU2lkZW5hdkNvbnRyb2xsZXInLCBTaWRlbmF2Q29udHJvbGxlcik7XHJcblxyXG5cclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqIEBuZ2RvYyBzZXJ2aWNlXHJcbiAqIEBuYW1lICRtZFNpZGVuYXZcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnNpZGVuYXZcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIGAkbWRTaWRlbmF2YCBtYWtlcyBpdCBlYXN5IHRvIGludGVyYWN0IHdpdGggbXVsdGlwbGUgc2lkZW5hdnNcclxuICogaW4gYW4gYXBwLlxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImpzXCI+XHJcbiAqIC8vIEFzeW5jIGxvb2t1cCBmb3Igc2lkZW5hdiBpbnN0YW5jZTsgd2lsbCByZXNvbHZlIHdoZW4gdGhlIGluc3RhbmNlIGlzIGF2YWlsYWJsZVxyXG4gKiAkbWRTaWRlbmF2KGNvbXBvbmVudElkKS50aGVuKGZ1bmN0aW9uKGluc3RhbmNlKSB7XHJcbiAqICAgJGxvZy5kZWJ1ZyggY29tcG9uZW50SWQgKyBcImlzIG5vdyByZWFkeVwiICk7XHJcbiAqIH0pO1xyXG4gKiAvLyBBc3luYyB0b2dnbGUgdGhlIGdpdmVuIHNpZGVuYXY7XHJcbiAqIC8vIHdoZW4gaW5zdGFuY2UgaXMga25vd24gcmVhZHkgYW5kIGxhenkgbG9va3VwIGlzIG5vdCBuZWVkZWQuXHJcbiAqICRtZFNpZGVuYXYoY29tcG9uZW50SWQpXHJcbiAqICAgIC50b2dnbGUoKVxyXG4gKiAgICAudGhlbihmdW5jdGlvbigpe1xyXG4gKiAgICAgICRsb2cuZGVidWcoJ3RvZ2dsZWQnKTtcclxuICogICAgfSk7XHJcbiAqIC8vIEFzeW5jIG9wZW4gdGhlIGdpdmVuIHNpZGVuYXZcclxuICogJG1kU2lkZW5hdihjb21wb25lbnRJZClcclxuICogICAgLm9wZW4oKVxyXG4gKiAgICAudGhlbihmdW5jdGlvbigpe1xyXG4gKiAgICAgICRsb2cuZGVidWcoJ29wZW5lZCcpO1xyXG4gKiAgICB9KTtcclxuICogLy8gQXN5bmMgY2xvc2UgdGhlIGdpdmVuIHNpZGVuYXZcclxuICogJG1kU2lkZW5hdihjb21wb25lbnRJZClcclxuICogICAgLmNsb3NlKClcclxuICogICAgLnRoZW4oZnVuY3Rpb24oKXtcclxuICogICAgICAkbG9nLmRlYnVnKCdjbG9zZWQnKTtcclxuICogICAgfSk7XHJcbiAqIC8vIFN5bmMgY2hlY2sgdG8gc2VlIGlmIHRoZSBzcGVjaWZpZWQgc2lkZW5hdiBpcyBzZXQgdG8gYmUgb3BlblxyXG4gKiAkbWRTaWRlbmF2KGNvbXBvbmVudElkKS5pc09wZW4oKTtcclxuICogLy8gU3luYyBjaGVjayB0byB3aGV0aGVyIGdpdmVuIHNpZGVuYXYgaXMgbG9ja2VkIG9wZW5cclxuICogLy8gSWYgdGhpcyBpcyB0cnVlLCB0aGUgc2lkZW5hdiB3aWxsIGJlIG9wZW4gcmVnYXJkbGVzcyBvZiBjbG9zZSgpXHJcbiAqICRtZFNpZGVuYXYoY29tcG9uZW50SWQpLmlzTG9ja2VkT3BlbigpO1xyXG4gKiA8L2hsanM+XHJcbiAqL1xyXG5mdW5jdGlvbiBTaWRlbmF2U2VydmljZSgkbWRDb21wb25lbnRSZWdpc3RyeSwgJHEpIHtcclxuICByZXR1cm4gZnVuY3Rpb24oaGFuZGxlKSB7XHJcblxyXG4gICAgLy8gTG9va3VwIHRoZSBjb250cm9sbGVyIGluc3RhbmNlIGZvciB0aGUgc3BlY2lmaWVkIHNpZE5hdiBpbnN0YW5jZVxyXG4gICAgdmFyIHNlbGY7XHJcbiAgICB2YXIgZXJyb3JNc2cgPSBcIlNpZGVOYXYgJ1wiICsgaGFuZGxlICsgXCInIGlzIG5vdCBhdmFpbGFibGUhXCI7XHJcbiAgICB2YXIgaW5zdGFuY2UgPSAkbWRDb21wb25lbnRSZWdpc3RyeS5nZXQoaGFuZGxlKTtcclxuXHJcbiAgICBpZighaW5zdGFuY2UpIHtcclxuICAgICAgJG1kQ29tcG9uZW50UmVnaXN0cnkubm90Rm91bmRFcnJvcihoYW5kbGUpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBzZWxmID0ge1xyXG4gICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAvLyBTeW5jIG1ldGhvZHNcclxuICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgaXNPcGVuOiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gaW5zdGFuY2UgJiYgaW5zdGFuY2UuaXNPcGVuKCk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGlzTG9ja2VkT3BlbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlICYmIGluc3RhbmNlLmlzTG9ja2VkT3BlbigpO1xyXG4gICAgICB9LFxyXG4gICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAvLyBBc3luYyBtZXRob2RzXHJcbiAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgIHRvZ2dsZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlID8gaW5zdGFuY2UudG9nZ2xlKCkgOiAkcS5yZWplY3QoZXJyb3JNc2cpO1xyXG4gICAgICB9LFxyXG4gICAgICBvcGVuOiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gaW5zdGFuY2UgPyBpbnN0YW5jZS5vcGVuKCkgOiAkcS5yZWplY3QoZXJyb3JNc2cpO1xyXG4gICAgICB9LFxyXG4gICAgICBjbG9zZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlID8gaW5zdGFuY2UuY2xvc2UoKSA6ICRxLnJlamVjdChlcnJvck1zZyk7XHJcbiAgICAgIH0sXHJcbiAgICAgIHRoZW4gOiBmdW5jdGlvbiggY2FsbGJhY2tGbiApIHtcclxuICAgICAgICB2YXIgcHJvbWlzZSA9IGluc3RhbmNlID8gJHEud2hlbihpbnN0YW5jZSkgOiB3YWl0Rm9ySW5zdGFuY2UoKTtcclxuICAgICAgICByZXR1cm4gcHJvbWlzZS50aGVuKCBjYWxsYmFja0ZuIHx8IGFuZ3VsYXIubm9vcCApO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogRGVmZXJyZWQgbG9va3VwIG9mIGNvbXBvbmVudCBpbnN0YW5jZSB1c2luZyAkY29tcG9uZW50IHJlZ2lzdHJ5XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHdhaXRGb3JJbnN0YW5jZSgpIHtcclxuICAgICAgcmV0dXJuICRtZENvbXBvbmVudFJlZ2lzdHJ5XHJcbiAgICAgICAgICAgICAgICAud2hlbihoYW5kbGUpXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiggaXQgKXtcclxuICAgICAgICAgICAgICAgICAgaW5zdGFuY2UgPSBpdDtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0O1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG5TaWRlbmF2U2VydmljZS4kaW5qZWN0ID0gW1wiJG1kQ29tcG9uZW50UmVnaXN0cnlcIiwgXCIkcVwiXTtcclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRTaWRlbmF2Rm9jdXNcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnNpZGVuYXZcclxuICpcclxuICogQHJlc3RyaWN0IEFcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIGAkbWRTaWRlbmF2Rm9jdXNgIHByb3ZpZGVzIGEgd2F5IHRvIHNwZWNpZnkgdGhlIGZvY3VzZWQgZWxlbWVudCB3aGVuIGEgc2lkZW5hdiBvcGVucy5cclxuICogVGhpcyBpcyBjb21wbGV0ZWx5IG9wdGlvbmFsLCBhcyB0aGUgc2lkZW5hdiBpdHNlbGYgaXMgZm9jdXNlZCBieSBkZWZhdWx0LlxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPG1kLXNpZGVuYXY+XHJcbiAqICAgPGZvcm0+XHJcbiAqICAgICA8bWQtaW5wdXQtY29udGFpbmVyPlxyXG4gKiAgICAgICA8bGFiZWwgZm9yPVwidGVzdElucHV0XCI+TGFiZWw8L2xhYmVsPlxyXG4gKiAgICAgICA8aW5wdXQgaWQ9XCJ0ZXN0SW5wdXRcIiB0eXBlPVwidGV4dFwiIG1kLXNpZGVuYXYtZm9jdXM+XHJcbiAqICAgICA8L21kLWlucHV0LWNvbnRhaW5lcj5cclxuICogICA8L2Zvcm0+XHJcbiAqIDwvbWQtc2lkZW5hdj5cclxuICogPC9obGpzPlxyXG4gKiovXHJcbmZ1bmN0aW9uIFNpZGVuYXZGb2N1c0RpcmVjdGl2ZSgpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgIHJlcXVpcmU6ICdebWRTaWRlbmF2JyxcclxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBzaWRlbmF2Q3RybCkge1xyXG4gICAgICBzaWRlbmF2Q3RybC5mb2N1c0VsZW1lbnQoZWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbmFtZSBtZFNpZGVuYXZcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnNpZGVuYXZcclxuICogQHJlc3RyaWN0IEVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqXHJcbiAqIEEgU2lkZW5hdiBjb21wb25lbnQgdGhhdCBjYW4gYmUgb3BlbmVkIGFuZCBjbG9zZWQgcHJvZ3JhbWF0aWNhbGx5LlxyXG4gKlxyXG4gKiBCeSBkZWZhdWx0LCB1cG9uIG9wZW5pbmcgaXQgd2lsbCBzbGlkZSBvdXQgb24gdG9wIG9mIHRoZSBtYWluIGNvbnRlbnQgYXJlYS5cclxuICpcclxuICogRm9yIGtleWJvYXJkIGFuZCBzY3JlZW4gcmVhZGVyIGFjY2Vzc2liaWxpdHksIGZvY3VzIGlzIHNlbnQgdG8gdGhlIHNpZGVuYXYgd3JhcHBlciBieSBkZWZhdWx0LlxyXG4gKiBJdCBjYW4gYmUgb3ZlcnJpZGRlbiB3aXRoIHRoZSBgbWQtc2lkZW5hdi1mb2N1c2AgZGlyZWN0aXZlIG9uIHRoZSBjaGlsZCBlbGVtZW50IHlvdSB3YW50IGZvY3VzZWQuXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8ZGl2IGxheW91dD1cInJvd1wiIG5nLWNvbnRyb2xsZXI9XCJNeUNvbnRyb2xsZXJcIj5cclxuICogICA8bWQtc2lkZW5hdiBtZC1jb21wb25lbnQtaWQ9XCJsZWZ0XCIgY2xhc3M9XCJtZC1zaWRlbmF2LWxlZnRcIj5cclxuICogICAgIExlZnQgTmF2IVxyXG4gKiAgIDwvbWQtc2lkZW5hdj5cclxuICpcclxuICogICA8bWQtY29udGVudD5cclxuICogICAgIENlbnRlciBDb250ZW50XHJcbiAqICAgICA8bWQtYnV0dG9uIG5nLWNsaWNrPVwib3BlbkxlZnRNZW51KClcIj5cclxuICogICAgICAgT3BlbiBMZWZ0IE1lbnVcclxuICogICAgIDwvbWQtYnV0dG9uPlxyXG4gKiAgIDwvbWQtY29udGVudD5cclxuICpcclxuICogICA8bWQtc2lkZW5hdiBtZC1jb21wb25lbnQtaWQ9XCJyaWdodFwiXHJcbiAqICAgICBtZC1pcy1sb2NrZWQtb3Blbj1cIiRtZE1lZGlhKCdtaW4td2lkdGg6IDMzM3B4JylcIlxyXG4gKiAgICAgY2xhc3M9XCJtZC1zaWRlbmF2LXJpZ2h0XCI+XHJcbiAqICAgICA8Zm9ybT5cclxuICogICAgICAgPG1kLWlucHV0LWNvbnRhaW5lcj5cclxuICogICAgICAgICA8bGFiZWwgZm9yPVwidGVzdElucHV0XCI+VGVzdCBpbnB1dDwvbGFiZWw+XHJcbiAqICAgICAgICAgPGlucHV0IGlkPVwidGVzdElucHV0XCIgdHlwZT1cInRleHRcIlxyXG4gKiAgICAgICAgICAgICAgICBuZy1tb2RlbD1cImRhdGFcIiBtZC1zaWRlbmF2LWZvY3VzPlxyXG4gKiAgICAgICA8L21kLWlucHV0LWNvbnRhaW5lcj5cclxuICogICAgIDwvZm9ybT5cclxuICogICA8L21kLXNpZGVuYXY+XHJcbiAqIDwvZGl2PlxyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqIDxobGpzIGxhbmc9XCJqc1wiPlxyXG4gKiB2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJywgWyduZ01hdGVyaWFsJ10pO1xyXG4gKiBhcHAuY29udHJvbGxlcignTXlDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkbWRTaWRlbmF2KSB7XHJcbiAqICAgJHNjb3BlLm9wZW5MZWZ0TWVudSA9IGZ1bmN0aW9uKCkge1xyXG4gKiAgICAgJG1kU2lkZW5hdignbGVmdCcpLnRvZ2dsZSgpO1xyXG4gKiAgIH07XHJcbiAqIH0pO1xyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbj19IG1kLWlzLW9wZW4gQSBtb2RlbCBib3VuZCB0byB3aGV0aGVyIHRoZSBzaWRlbmF2IGlzIG9wZW5lZC5cclxuICogQHBhcmFtIHtzdHJpbmc9fSBtZC1jb21wb25lbnQtaWQgY29tcG9uZW50SWQgdG8gdXNlIHdpdGggJG1kU2lkZW5hdiBzZXJ2aWNlLlxyXG4gKiBAcGFyYW0ge2V4cHJlc3Npb249fSBtZC1pcy1sb2NrZWQtb3BlbiBXaGVuIHRoaXMgZXhwcmVzc2lvbiBldmFsdXRlcyB0byB0cnVlLFxyXG4gKiB0aGUgc2lkZW5hdiAnbG9ja3Mgb3Blbic6IGl0IGZhbGxzIGludG8gdGhlIGNvbnRlbnQncyBmbG93IGluc3RlYWRcclxuICogb2YgYXBwZWFyaW5nIG92ZXIgaXQuIFRoaXMgb3ZlcnJpZGVzIHRoZSBgaXMtb3BlbmAgYXR0cmlidXRlLlxyXG4gKlxyXG4gKiBUaGUgJG1kTWVkaWEoKSBzZXJ2aWNlIGlzIGV4cG9zZWQgdG8gdGhlIGlzLWxvY2tlZC1vcGVuIGF0dHJpYnV0ZSwgd2hpY2hcclxuICogY2FuIGJlIGdpdmVuIGEgbWVkaWEgcXVlcnkgb3Igb25lIG9mIHRoZSBgc21gLCBgZ3Qtc21gLCBgbWRgLCBgZ3QtbWRgLCBgbGdgIG9yIGBndC1sZ2AgcHJlc2V0cy5cclxuICogRXhhbXBsZXM6XHJcbiAqXHJcbiAqICAgLSBgPG1kLXNpZGVuYXYgbWQtaXMtbG9ja2VkLW9wZW49XCJzaG91bGRMb2NrT3BlblwiPjwvbWQtc2lkZW5hdj5gXHJcbiAqICAgLSBgPG1kLXNpZGVuYXYgbWQtaXMtbG9ja2VkLW9wZW49XCIkbWRNZWRpYSgnbWluLXdpZHRoOiAxMDAwcHgnKVwiPjwvbWQtc2lkZW5hdj5gXHJcbiAqICAgLSBgPG1kLXNpZGVuYXYgbWQtaXMtbG9ja2VkLW9wZW49XCIkbWRNZWRpYSgnc20nKVwiPjwvbWQtc2lkZW5hdj5gIChsb2NrcyBvcGVuIG9uIHNtYWxsIHNjcmVlbnMpXHJcbiAqL1xyXG5mdW5jdGlvbiBTaWRlbmF2RGlyZWN0aXZlKCR0aW1lb3V0LCAkYW5pbWF0ZSwgJHBhcnNlLCAkbG9nLCAkbWRNZWRpYSwgJG1kQ29uc3RhbnQsICRjb21waWxlLCAkbWRUaGVtaW5nLCAkcSwgJGRvY3VtZW50KSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICBzY29wZToge1xyXG4gICAgICBpc09wZW46ICc9P21kSXNPcGVuJ1xyXG4gICAgfSxcclxuICAgIGNvbnRyb2xsZXI6ICckbWRTaWRlbmF2Q29udHJvbGxlcicsXHJcbiAgICBjb21waWxlOiBmdW5jdGlvbihlbGVtZW50KSB7XHJcbiAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ21kLWNsb3NlZCcpO1xyXG4gICAgICBlbGVtZW50LmF0dHIoJ3RhYkluZGV4JywgJy0xJyk7XHJcbiAgICAgIHJldHVybiBwb3N0TGluaztcclxuICAgIH1cclxuICB9O1xyXG5cclxuICAvKipcclxuICAgKiBEaXJlY3RpdmUgUG9zdCBMaW5rIGZ1bmN0aW9uLi4uXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIHNpZGVuYXZDdHJsKSB7XHJcbiAgICB2YXIgbGFzdFBhcmVudE92ZXJGbG93O1xyXG4gICAgdmFyIHRyaWdnZXJpbmdFbGVtZW50ID0gbnVsbDtcclxuICAgIHZhciBwcm9taXNlID0gJHEud2hlbih0cnVlKTtcclxuXHJcbiAgICB2YXIgaXNMb2NrZWRPcGVuUGFyc2VkID0gJHBhcnNlKGF0dHIubWRJc0xvY2tlZE9wZW4pO1xyXG4gICAgdmFyIGlzTG9ja2VkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIHJldHVybiBpc0xvY2tlZE9wZW5QYXJzZWQoc2NvcGUuJHBhcmVudCwge1xyXG4gICAgICAgICRtZWRpYTogZnVuY3Rpb24oYXJnKSB7XHJcbiAgICAgICAgICAkbG9nLndhcm4oXCIkbWVkaWEgaXMgZGVwcmVjYXRlZCBmb3IgaXMtbG9ja2VkLW9wZW4uIFVzZSAkbWRNZWRpYSBpbnN0ZWFkLlwiKTtcclxuICAgICAgICAgIHJldHVybiAkbWRNZWRpYShhcmcpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgJG1kTWVkaWE6ICRtZE1lZGlhXHJcbiAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHZhciBiYWNrZHJvcCA9ICRjb21waWxlKFxyXG4gICAgICAnPG1kLWJhY2tkcm9wIGNsYXNzPVwibWQtc2lkZW5hdi1iYWNrZHJvcCBtZC1vcGFxdWUgbmctZW50ZXJcIj4nXHJcbiAgICApKHNjb3BlKTtcclxuXHJcbiAgICBlbGVtZW50Lm9uKCckZGVzdHJveScsIHNpZGVuYXZDdHJsLmRlc3Ryb3kpO1xyXG4gICAgJG1kVGhlbWluZy5pbmhlcml0KGJhY2tkcm9wLCBlbGVtZW50KTtcclxuXHJcbiAgICBzY29wZS4kd2F0Y2goaXNMb2NrZWQsIHVwZGF0ZUlzTG9ja2VkKTtcclxuICAgIHNjb3BlLiR3YXRjaCgnaXNPcGVuJywgdXBkYXRlSXNPcGVuKTtcclxuXHJcblxyXG4gICAgLy8gUHVibGlzaCBzcGVjaWFsIGFjY2Vzc29yIGZvciB0aGUgQ29udHJvbGxlciBpbnN0YW5jZVxyXG4gICAgc2lkZW5hdkN0cmwuJHRvZ2dsZU9wZW4gPSB0b2dnbGVPcGVuO1xyXG4gICAgc2lkZW5hdkN0cmwuZm9jdXNFbGVtZW50KCBzaWRlbmF2Q3RybC5mb2N1c0VsZW1lbnQoKSB8fCBlbGVtZW50ICk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUb2dnbGUgdGhlIERPTSBjbGFzc2VzIHRvIGluZGljYXRlIGBsb2NrZWRgXHJcbiAgICAgKiBAcGFyYW0gaXNMb2NrZWRcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gdXBkYXRlSXNMb2NrZWQoaXNMb2NrZWQsIG9sZFZhbHVlKSB7XHJcbiAgICAgIHNjb3BlLmlzTG9ja2VkT3BlbiA9IGlzTG9ja2VkO1xyXG4gICAgICBpZiAoaXNMb2NrZWQgPT09IG9sZFZhbHVlKSB7XHJcbiAgICAgICAgZWxlbWVudC50b2dnbGVDbGFzcygnbWQtbG9ja2VkLW9wZW4nLCAhIWlzTG9ja2VkKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkYW5pbWF0ZVtpc0xvY2tlZCA/ICdhZGRDbGFzcycgOiAncmVtb3ZlQ2xhc3MnXShlbGVtZW50LCAnbWQtbG9ja2VkLW9wZW4nKTtcclxuICAgICAgfVxyXG4gICAgICBiYWNrZHJvcC50b2dnbGVDbGFzcygnbWQtbG9ja2VkLW9wZW4nLCAhIWlzTG9ja2VkKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFRvZ2dsZSB0aGUgU2lkZU5hdiB2aWV3IGFuZCBhdHRhY2gvZGV0YWNoIGxpc3RlbmVyc1xyXG4gICAgICogQHBhcmFtIGlzT3BlblxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiB1cGRhdGVJc09wZW4oaXNPcGVuKSB7XHJcbiAgICAgIHZhciBwYXJlbnQgPSBlbGVtZW50LnBhcmVudCgpO1xyXG5cclxuICAgICAgcGFyZW50W2lzT3BlbiA/ICdvbicgOiAnb2ZmJ10oJ2tleWRvd24nLCBvbktleURvd24pO1xyXG4gICAgICBiYWNrZHJvcFtpc09wZW4gPyAnb24nIDogJ29mZiddKCdjbGljaycsIGNsb3NlKTtcclxuXHJcbiAgICAgIGlmICggaXNPcGVuICkge1xyXG4gICAgICAgIC8vIENhcHR1cmUgdXBvbiBvcGVuaW5nLi5cclxuICAgICAgICB0cmlnZ2VyaW5nRWxlbWVudCA9ICRkb2N1bWVudFswXS5hY3RpdmVFbGVtZW50O1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBmb2N1c0VsID0gc2lkZW5hdkN0cmwuZm9jdXNFbGVtZW50KCk7XHJcblxyXG4gICAgICBkaXNhYmxlUGFyZW50U2Nyb2xsKGlzT3Blbik7XHJcblxyXG4gICAgICByZXR1cm4gcHJvbWlzZSA9ICRxLmFsbChbXHJcbiAgICAgICAgICAgICAgICBpc09wZW4gPyAkYW5pbWF0ZS5lbnRlcihiYWNrZHJvcCwgcGFyZW50KSA6ICRhbmltYXRlLmxlYXZlKGJhY2tkcm9wKSxcclxuICAgICAgICAgICAgICAgICRhbmltYXRlW2lzT3BlbiA/ICdyZW1vdmVDbGFzcycgOiAnYWRkQ2xhc3MnXShlbGVtZW50LCAnbWQtY2xvc2VkJylcclxuICAgICAgICAgICAgICBdKVxyXG4gICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgLy8gUGVyZm9ybSBmb2N1cyB3aGVuIGFuaW1hdGlvbnMgYXJlIEFMTCBkb25lLi4uXHJcbiAgICAgICAgICAgICAgICBpZiAoc2NvcGUuaXNPcGVuKSB7XHJcbiAgICAgICAgICAgICAgICAgIGZvY3VzRWwgJiYgZm9jdXNFbC5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJldmVudCBwYXJlbnQgc2Nyb2xsaW5nICh3aGVuIHRoZSBTaWRlTmF2IGlzIG9wZW4pXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGRpc2FibGVQYXJlbnRTY3JvbGwoZGlzYWJsZWQpIHtcclxuICAgICAgdmFyIHBhcmVudCA9IGVsZW1lbnQucGFyZW50KCk7XHJcbiAgICAgIGlmICggZGlzYWJsZWQgKSB7XHJcbiAgICAgICAgbGFzdFBhcmVudE92ZXJGbG93ID0gcGFyZW50LmNzcygnb3ZlcmZsb3cnKTtcclxuICAgICAgICBwYXJlbnQuY3NzKCdvdmVyZmxvdycsICdoaWRkZW4nKTtcclxuICAgICAgfSBlbHNlIGlmIChhbmd1bGFyLmlzRGVmaW5lZChsYXN0UGFyZW50T3ZlckZsb3cpKSB7XHJcbiAgICAgICAgcGFyZW50LmNzcygnb3ZlcmZsb3cnLCBsYXN0UGFyZW50T3ZlckZsb3cpO1xyXG4gICAgICAgIGxhc3RQYXJlbnRPdmVyRmxvdyA9IHVuZGVmaW5lZDtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVG9nZ2xlIHRoZSBzaWRlTmF2IHZpZXcgYW5kIHB1Ymxpc2ggYSBwcm9taXNlIHRvIGJlIHJlc29sdmVkIHdoZW5cclxuICAgICAqIHRoZSB2aWV3IGFuaW1hdGlvbiBmaW5pc2hlcy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaXNPcGVuXHJcbiAgICAgKiBAcmV0dXJucyB7Kn1cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gdG9nZ2xlT3BlbiggaXNPcGVuICkge1xyXG4gICAgICBpZiAoc2NvcGUuaXNPcGVuID09IGlzT3BlbiApIHtcclxuXHJcbiAgICAgICAgcmV0dXJuICRxLndoZW4odHJ1ZSk7XHJcblxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XHJcblxyXG4gICAgICAgIC8vIFRvZ2dsZSB2YWx1ZSB0byBmb3JjZSBhbiBhc3luYyBgdXBkYXRlSXNPcGVuKClgIHRvIHJ1blxyXG4gICAgICAgIHNjb3BlLmlzT3BlbiA9IGlzT3BlbjtcclxuXHJcbiAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgLy8gV2hlbiB0aGUgY3VycmVudCBgdXBkYXRlSXNPcGVuKClgIGFuaW1hdGlvbiBmaW5pc2hlc1xyXG4gICAgICAgICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xyXG5cclxuICAgICAgICAgICAgaWYgKCAhc2NvcGUuaXNPcGVuICkge1xyXG4gICAgICAgICAgICAgIC8vIHJlc2V0IGZvY3VzIHRvIG9yaWdpbmF0aW5nIGVsZW1lbnQgKGlmIGF2YWlsYWJsZSkgdXBvbiBjbG9zZVxyXG4gICAgICAgICAgICAgIHRyaWdnZXJpbmdFbGVtZW50ICYmIHRyaWdnZXJpbmdFbGVtZW50LmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgdHJpZ2dlcmluZ0VsZW1lbnQgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfSwwLGZhbHNlKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEF1dG8tY2xvc2Ugc2lkZU5hdiB3aGVuIHRoZSBgZXNjYXBlYCBrZXkgaXMgcHJlc3NlZC5cclxuICAgICAqIEBwYXJhbSBldnRcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gb25LZXlEb3duKGV2KSB7XHJcbiAgICAgIHZhciBpc0VzY2FwZSA9IChldi5rZXlDb2RlID09PSAkbWRDb25zdGFudC5LRVlfQ09ERS5FU0NBUEUpO1xyXG4gICAgICByZXR1cm4gaXNFc2NhcGUgPyBjbG9zZShldikgOiAkcS53aGVuKHRydWUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogV2l0aCBiYWNrZHJvcCBgY2xpY2tzYCBvciBgZXNjYXBlYCBrZXktcHJlc3MsIGltbWVkaWF0ZWx5XHJcbiAgICAgKiBhcHBseSB0aGUgQ1NTIGNsb3NlIHRyYW5zaXRpb24uLi4gVGhlbiBub3RpZnkgdGhlIGNvbnRyb2xsZXJcclxuICAgICAqIHRvIGNsb3NlKCkgYW5kIHBlcmZvcm0gaXRzIG93biBhY3Rpb25zLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBjbG9zZShldikge1xyXG4gICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcbiAgICAgIHJldHVybiBzaWRlbmF2Q3RybC5jbG9zZSgpO1xyXG4gICAgfVxyXG5cclxuICB9XHJcbn1cclxuU2lkZW5hdkRpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJHRpbWVvdXRcIiwgXCIkYW5pbWF0ZVwiLCBcIiRwYXJzZVwiLCBcIiRsb2dcIiwgXCIkbWRNZWRpYVwiLCBcIiRtZENvbnN0YW50XCIsIFwiJGNvbXBpbGVcIiwgXCIkbWRUaGVtaW5nXCIsIFwiJHFcIiwgXCIkZG9jdW1lbnRcIl07XHJcblxyXG4vKlxyXG4gKiBAcHJpdmF0ZVxyXG4gKiBAbmdkb2MgY29udHJvbGxlclxyXG4gKiBAbmFtZSBTaWRlbmF2Q29udHJvbGxlclxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuc2lkZW5hdlxyXG4gKlxyXG4gKi9cclxuZnVuY3Rpb24gU2lkZW5hdkNvbnRyb2xsZXIoJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCAkbWRDb21wb25lbnRSZWdpc3RyeSwgJHEpIHtcclxuXHJcbiAgdmFyIHNlbGYgPSB0aGlzLFxyXG4gICAgICBmb2N1c0VsZW1lbnQ7XHJcblxyXG4gIC8vIFVzZSBEZWZhdWx0IGludGVybmFsIG1ldGhvZCB1bnRpbCBvdmVycmlkZGVuIGJ5IGRpcmVjdGl2ZSBwb3N0TGlua1xyXG5cclxuICAvLyBTeW5jaHJvbm91cyBnZXR0ZXJzXHJcbiAgc2VsZi5pc09wZW4gPSBmdW5jdGlvbigpIHsgcmV0dXJuICEhJHNjb3BlLmlzT3BlbjsgfTtcclxuICBzZWxmLmlzTG9ja2VkT3BlbiA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gISEkc2NvcGUuaXNMb2NrZWRPcGVuOyB9O1xyXG5cclxuICAvLyBBc3luYyBhY3Rpb25zXHJcbiAgc2VsZi5vcGVuICAgPSBmdW5jdGlvbigpIHsgcmV0dXJuIHNlbGYuJHRvZ2dsZU9wZW4oIHRydWUgKTsgIH07XHJcbiAgc2VsZi5jbG9zZSAgPSBmdW5jdGlvbigpIHsgcmV0dXJuIHNlbGYuJHRvZ2dsZU9wZW4oIGZhbHNlICk7IH07XHJcbiAgc2VsZi50b2dnbGUgPSBmdW5jdGlvbigpIHsgcmV0dXJuIHNlbGYuJHRvZ2dsZU9wZW4oICEkc2NvcGUuaXNPcGVuICk7ICB9O1xyXG4gIHNlbGYuZm9jdXNFbGVtZW50ID0gZnVuY3Rpb24oZWwpIHtcclxuICAgIGlmICggYW5ndWxhci5pc0RlZmluZWQoZWwpICkge1xyXG4gICAgICBmb2N1c0VsZW1lbnQgPSBlbDtcclxuICAgIH1cclxuICAgIHJldHVybiBmb2N1c0VsZW1lbnQ7XHJcbiAgfTtcclxuXHJcbiAgc2VsZi4kdG9nZ2xlT3BlbiA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gJHEud2hlbigkc2NvcGUuaXNPcGVuKTsgfTtcclxuXHJcbiAgc2VsZi5kZXN0cm95ID0gJG1kQ29tcG9uZW50UmVnaXN0cnkucmVnaXN0ZXIoc2VsZiwgJGF0dHJzLm1kQ29tcG9uZW50SWQpO1xyXG59XHJcblNpZGVuYXZDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkZWxlbWVudFwiLCBcIiRhdHRyc1wiLCBcIiRtZENvbXBvbmVudFJlZ2lzdHJ5XCIsIFwiJHFcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBuZ2RvYyBtb2R1bGVcclxuICAgKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLnNsaWRlclxyXG4gICAqL1xyXG4gIGFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnNsaWRlcicsIFtcclxuICAgICdtYXRlcmlhbC5jb3JlJ1xyXG4gIF0pXHJcbiAgLmRpcmVjdGl2ZSgnbWRTbGlkZXInLCBTbGlkZXJEaXJlY3RpdmUpO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRTbGlkZXJcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnNsaWRlclxyXG4gKiBAcmVzdHJpY3QgRVxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogVGhlIGA8bWQtc2xpZGVyPmAgY29tcG9uZW50IGFsbG93cyB0aGUgdXNlciB0byBjaG9vc2UgZnJvbSBhIHJhbmdlIG9mXHJcbiAqIHZhbHVlcy5cclxuICpcclxuICogQXMgcGVyIHRoZSBbbWF0ZXJpYWwgZGVzaWduIHNwZWNdKGh0dHA6Ly93d3cuZ29vZ2xlLmNvbS9kZXNpZ24vc3BlYy9zdHlsZS9jb2xvci5odG1sI2NvbG9yLXVpLWNvbG9yLWFwcGxpY2F0aW9uKVxyXG4gKiB0aGUgc2xpZGVyIGlzIGluIHRoZSBhY2NlbnQgY29sb3IgYnkgZGVmYXVsdC4gVGhlIHByaW1hcnkgY29sb3IgcGFsZXR0ZSBtYXkgYmUgdXNlZCB3aXRoXHJcbiAqIHRoZSBgbWQtcHJpbWFyeWAgY2xhc3MuXHJcbiAqXHJcbiAqIEl0IGhhcyB0d28gbW9kZXM6ICdub3JtYWwnIG1vZGUsIHdoZXJlIHRoZSB1c2VyIHNsaWRlcyBiZXR3ZWVuIGEgd2lkZSByYW5nZVxyXG4gKiBvZiB2YWx1ZXMsIGFuZCAnZGlzY3JldGUnIG1vZGUsIHdoZXJlIHRoZSB1c2VyIHNsaWRlcyBiZXR3ZWVuIG9ubHkgYSBmZXdcclxuICogc2VsZWN0IHZhbHVlcy5cclxuICpcclxuICogVG8gZW5hYmxlIGRpc2NyZXRlIG1vZGUsIGFkZCB0aGUgYG1kLWRpc2NyZXRlYCBhdHRyaWJ1dGUgdG8gYSBzbGlkZXIsXHJcbiAqIGFuZCB1c2UgdGhlIGBzdGVwYCBhdHRyaWJ1dGUgdG8gY2hhbmdlIHRoZSBkaXN0YW5jZSBiZXR3ZWVuXHJcbiAqIHZhbHVlcyB0aGUgdXNlciBpcyBhbGxvd2VkIHRvIHBpY2suXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aDQ+Tm9ybWFsIE1vZGU8L2g0PlxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtc2xpZGVyIG5nLW1vZGVsPVwibXlWYWx1ZVwiIG1pbj1cIjVcIiBtYXg9XCI1MDBcIj5cclxuICogPC9tZC1zbGlkZXI+XHJcbiAqIDwvaGxqcz5cclxuICogPGg0PkRpc2NyZXRlIE1vZGU8L2g0PlxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtc2xpZGVyIG1kLWRpc2NyZXRlIG5nLW1vZGVsPVwibXlEaXNjcmV0ZVZhbHVlXCIgc3RlcD1cIjEwXCIgbWluPVwiMTBcIiBtYXg9XCIxMzBcIj5cclxuICogPC9tZC1zbGlkZXI+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICogQHBhcmFtIHtib29sZWFuPX0gbWQtZGlzY3JldGUgV2hldGhlciB0byBlbmFibGUgZGlzY3JldGUgbW9kZS5cclxuICogQHBhcmFtIHtudW1iZXI9fSBzdGVwIFRoZSBkaXN0YW5jZSBiZXR3ZWVuIHZhbHVlcyB0aGUgdXNlciBpcyBhbGxvd2VkIHRvIHBpY2suIERlZmF1bHQgMS5cclxuICogQHBhcmFtIHtudW1iZXI9fSBtaW4gVGhlIG1pbmltdW0gdmFsdWUgdGhlIHVzZXIgaXMgYWxsb3dlZCB0byBwaWNrLiBEZWZhdWx0IDAuXHJcbiAqIEBwYXJhbSB7bnVtYmVyPX0gbWF4IFRoZSBtYXhpbXVtIHZhbHVlIHRoZSB1c2VyIGlzIGFsbG93ZWQgdG8gcGljay4gRGVmYXVsdCAxMDAuXHJcbiAqL1xyXG5mdW5jdGlvbiBTbGlkZXJEaXJlY3RpdmUoJCRyQUYsICR3aW5kb3csICRtZEFyaWEsICRtZFV0aWwsICRtZENvbnN0YW50LCAkbWRUaGVtaW5nLCAkbWRHZXN0dXJlLCAkcGFyc2UpIHtcclxuICByZXR1cm4ge1xyXG4gICAgc2NvcGU6IHt9LFxyXG4gICAgcmVxdWlyZTogJz9uZ01vZGVsJyxcclxuICAgIHRlbXBsYXRlOlxyXG4gICAgICAnPGRpdiBjbGFzcz1cIm1kLXNsaWRlci13cmFwcGVyXCI+XFxcclxuICAgICAgICA8ZGl2IGNsYXNzPVwibWQtdHJhY2stY29udGFpbmVyXCI+XFxcclxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZC10cmFja1wiPjwvZGl2PlxcXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwibWQtdHJhY2sgbWQtdHJhY2stZmlsbFwiPjwvZGl2PlxcXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwibWQtdHJhY2stdGlja3NcIj48L2Rpdj5cXFxyXG4gICAgICAgIDwvZGl2PlxcXHJcbiAgICAgICAgPGRpdiBjbGFzcz1cIm1kLXRodW1iLWNvbnRhaW5lclwiPlxcXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwibWQtdGh1bWJcIj48L2Rpdj5cXFxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cIm1kLWZvY3VzLXRodW1iXCI+PC9kaXY+XFxcclxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZC1mb2N1cy1yaW5nXCI+PC9kaXY+XFxcclxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZC1zaWduXCI+XFxcclxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJtZC10aHVtYi10ZXh0XCI+PC9zcGFuPlxcXHJcbiAgICAgICAgICA8L2Rpdj5cXFxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cIm1kLWRpc2FibGVkLXRodW1iXCI+PC9kaXY+XFxcclxuICAgICAgICA8L2Rpdj5cXFxyXG4gICAgICA8L2Rpdj4nLFxyXG4gICAgY29tcGlsZTogY29tcGlsZVxyXG4gIH07XHJcblxyXG4gIC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuICAvLyBQcml2YXRlIE1ldGhvZHNcclxuICAvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcblxyXG4gIGZ1bmN0aW9uIGNvbXBpbGUgKHRFbGVtZW50LCB0QXR0cnMpIHtcclxuICAgIHRFbGVtZW50LmF0dHIoe1xyXG4gICAgICB0YWJJbmRleDogMCxcclxuICAgICAgcm9sZTogJ3NsaWRlcidcclxuICAgIH0pO1xyXG5cclxuICAgICRtZEFyaWEuZXhwZWN0KHRFbGVtZW50LCAnYXJpYS1sYWJlbCcpO1xyXG5cclxuICAgIHJldHVybiBwb3N0TGluaztcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBuZ01vZGVsQ3RybCkge1xyXG4gICAgJG1kVGhlbWluZyhlbGVtZW50KTtcclxuICAgIG5nTW9kZWxDdHJsID0gbmdNb2RlbEN0cmwgfHwge1xyXG4gICAgICAvLyBNb2NrIG5nTW9kZWxDb250cm9sbGVyIGlmIGl0IGRvZXNuJ3QgZXhpc3QgdG8gZ2l2ZSB1c1xyXG4gICAgICAvLyB0aGUgbWluaW11bSBmdW5jdGlvbmFsaXR5IG5lZWRlZFxyXG4gICAgICAkc2V0Vmlld1ZhbHVlOiBmdW5jdGlvbih2YWwpIHtcclxuICAgICAgICB0aGlzLiR2aWV3VmFsdWUgPSB2YWw7XHJcbiAgICAgICAgdGhpcy4kdmlld0NoYW5nZUxpc3RlbmVycy5mb3JFYWNoKGZ1bmN0aW9uKGNiKSB7IGNiKCk7IH0pO1xyXG4gICAgICB9LFxyXG4gICAgICAkcGFyc2VyczogW10sXHJcbiAgICAgICRmb3JtYXR0ZXJzOiBbXSxcclxuICAgICAgJHZpZXdDaGFuZ2VMaXN0ZW5lcnM6IFtdXHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBpc0Rpc2FibGVkUGFyc2VkID0gYXR0ci5uZ0Rpc2FibGVkICYmICRwYXJzZShhdHRyLm5nRGlzYWJsZWQpO1xyXG4gICAgdmFyIGlzRGlzYWJsZWRHZXR0ZXIgPSBpc0Rpc2FibGVkUGFyc2VkID9cclxuICAgICAgZnVuY3Rpb24oKSB7IHJldHVybiBpc0Rpc2FibGVkUGFyc2VkKHNjb3BlLiRwYXJlbnQpOyB9IDpcclxuICAgICAgYW5ndWxhci5ub29wO1xyXG4gICAgdmFyIHRodW1iID0gYW5ndWxhci5lbGVtZW50KGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignLm1kLXRodW1iJykpO1xyXG4gICAgdmFyIHRodW1iVGV4dCA9IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJy5tZC10aHVtYi10ZXh0JykpO1xyXG4gICAgdmFyIHRodW1iQ29udGFpbmVyID0gdGh1bWIucGFyZW50KCk7XHJcbiAgICB2YXIgdHJhY2tDb250YWluZXIgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCcubWQtdHJhY2stY29udGFpbmVyJykpO1xyXG4gICAgdmFyIGFjdGl2ZVRyYWNrID0gYW5ndWxhci5lbGVtZW50KGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignLm1kLXRyYWNrLWZpbGwnKSk7XHJcbiAgICB2YXIgdGlja0NvbnRhaW5lciA9IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJy5tZC10cmFjay10aWNrcycpKTtcclxuICAgIHZhciB0aHJvdHRsZWRSZWZyZXNoRGltZW5zaW9ucyA9ICRtZFV0aWwudGhyb3R0bGUocmVmcmVzaFNsaWRlckRpbWVuc2lvbnMsIDUwMDApO1xyXG5cclxuICAgIC8vIERlZmF1bHQgdmFsdWVzLCBvdmVycmlkYWJsZSBieSBhdHRyc1xyXG4gICAgYW5ndWxhci5pc0RlZmluZWQoYXR0ci5taW4pID8gYXR0ci4kb2JzZXJ2ZSgnbWluJywgdXBkYXRlTWluKSA6IHVwZGF0ZU1pbigwKTtcclxuICAgIGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHIubWF4KSA/IGF0dHIuJG9ic2VydmUoJ21heCcsIHVwZGF0ZU1heCkgOiB1cGRhdGVNYXgoMTAwKTtcclxuICAgIGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHIuc3RlcCk/IGF0dHIuJG9ic2VydmUoJ3N0ZXAnLCB1cGRhdGVTdGVwKSA6IHVwZGF0ZVN0ZXAoMSk7XHJcblxyXG4gICAgLy8gV2UgaGF2ZSB0byBtYW51YWxseSBzdG9wIHRoZSAkd2F0Y2ggb24gbmdEaXNhYmxlZCBiZWNhdXNlIGl0IGV4aXN0c1xyXG4gICAgLy8gb24gdGhlIHBhcmVudCBzY29wZSwgYW5kIHdvbid0IGJlIGF1dG9tYXRpY2FsbHkgZGVzdHJveWVkIHdoZW5cclxuICAgIC8vIHRoZSBjb21wb25lbnQgaXMgZGVzdHJveWVkLlxyXG4gICAgdmFyIHN0b3BEaXNhYmxlZFdhdGNoID0gYW5ndWxhci5ub29wO1xyXG4gICAgaWYgKGF0dHIubmdEaXNhYmxlZCkge1xyXG4gICAgICBzdG9wRGlzYWJsZWRXYXRjaCA9IHNjb3BlLiRwYXJlbnQuJHdhdGNoKGF0dHIubmdEaXNhYmxlZCwgdXBkYXRlQXJpYURpc2FibGVkKTtcclxuICAgIH1cclxuXHJcbiAgICAkbWRHZXN0dXJlLnJlZ2lzdGVyKGVsZW1lbnQsICdkcmFnJyk7XHJcblxyXG4gICAgZWxlbWVudFxyXG4gICAgICAub24oJ2tleWRvd24nLCBrZXlkb3duTGlzdGVuZXIpXHJcbiAgICAgIC5vbignJG1kLnByZXNzZG93bicsIG9uUHJlc3NEb3duKVxyXG4gICAgICAub24oJyRtZC5wcmVzc3VwJywgb25QcmVzc1VwKVxyXG4gICAgICAub24oJyRtZC5kcmFnc3RhcnQnLCBvbkRyYWdTdGFydClcclxuICAgICAgLm9uKCckbWQuZHJhZycsIG9uRHJhZylcclxuICAgICAgLm9uKCckbWQuZHJhZ2VuZCcsIG9uRHJhZ0VuZCk7XHJcblxyXG4gICAgLy8gT24gcmVzaXplLCByZWNhbGN1bGF0ZSB0aGUgc2xpZGVyJ3MgZGltZW5zaW9ucyBhbmQgcmUtcmVuZGVyXHJcbiAgICBmdW5jdGlvbiB1cGRhdGVBbGwoKSB7XHJcbiAgICAgIHJlZnJlc2hTbGlkZXJEaW1lbnNpb25zKCk7XHJcbiAgICAgIG5nTW9kZWxSZW5kZXIoKTtcclxuICAgICAgcmVkcmF3VGlja3MoKTtcclxuICAgIH1cclxuICAgIHNldFRpbWVvdXQodXBkYXRlQWxsKTtcclxuXHJcbiAgICB2YXIgZGVib3VuY2VkVXBkYXRlQWxsID0gJCRyQUYudGhyb3R0bGUodXBkYXRlQWxsKTtcclxuICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vbigncmVzaXplJywgZGVib3VuY2VkVXBkYXRlQWxsKTtcclxuXHJcbiAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vZmYoJ3Jlc2l6ZScsIGRlYm91bmNlZFVwZGF0ZUFsbCk7XHJcbiAgICAgIHN0b3BEaXNhYmxlZFdhdGNoKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBuZ01vZGVsQ3RybC4kcmVuZGVyID0gbmdNb2RlbFJlbmRlcjtcclxuICAgIG5nTW9kZWxDdHJsLiR2aWV3Q2hhbmdlTGlzdGVuZXJzLnB1c2gobmdNb2RlbFJlbmRlcik7XHJcbiAgICBuZ01vZGVsQ3RybC4kZm9ybWF0dGVycy5wdXNoKG1pbk1heFZhbGlkYXRvcik7XHJcbiAgICBuZ01vZGVsQ3RybC4kZm9ybWF0dGVycy5wdXNoKHN0ZXBWYWxpZGF0b3IpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQXR0cmlidXRlc1xyXG4gICAgICovXHJcbiAgICB2YXIgbWluO1xyXG4gICAgdmFyIG1heDtcclxuICAgIHZhciBzdGVwO1xyXG4gICAgZnVuY3Rpb24gdXBkYXRlTWluKHZhbHVlKSB7XHJcbiAgICAgIG1pbiA9IHBhcnNlRmxvYXQodmFsdWUpO1xyXG4gICAgICBlbGVtZW50LmF0dHIoJ2FyaWEtdmFsdWVtaW4nLCB2YWx1ZSk7XHJcbiAgICAgIHVwZGF0ZUFsbCgpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gdXBkYXRlTWF4KHZhbHVlKSB7XHJcbiAgICAgIG1heCA9IHBhcnNlRmxvYXQodmFsdWUpO1xyXG4gICAgICBlbGVtZW50LmF0dHIoJ2FyaWEtdmFsdWVtYXgnLCB2YWx1ZSk7XHJcbiAgICAgIHVwZGF0ZUFsbCgpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gdXBkYXRlU3RlcCh2YWx1ZSkge1xyXG4gICAgICBzdGVwID0gcGFyc2VGbG9hdCh2YWx1ZSk7XHJcbiAgICAgIHJlZHJhd1RpY2tzKCk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiB1cGRhdGVBcmlhRGlzYWJsZWQoaXNEaXNhYmxlZCkge1xyXG4gICAgICBlbGVtZW50LmF0dHIoJ2FyaWEtZGlzYWJsZWQnLCAhIWlzRGlzYWJsZWQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIERyYXcgdGhlIHRpY2tzIHdpdGggY2FudmFzLlxyXG4gICAgLy8gVGhlIGFsdGVybmF0aXZlIHRvIGRyYXdpbmcgdGlja3Mgd2l0aCBjYW52YXMgaXMgdG8gZHJhdyBvbmUgZWxlbWVudCBmb3IgZWFjaCB0aWNrLFxyXG4gICAgLy8gd2hpY2ggY291bGQgcXVpY2tseSBiZWNvbWUgYSBwZXJmb3JtYW5jZSBib3R0bGVuZWNrLlxyXG4gICAgdmFyIHRpY2tDYW52YXMsIHRpY2tDdHg7XHJcbiAgICBmdW5jdGlvbiByZWRyYXdUaWNrcygpIHtcclxuICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChhdHRyLm1kRGlzY3JldGUpKSByZXR1cm47XHJcblxyXG4gICAgICB2YXIgbnVtU3RlcHMgPSBNYXRoLmZsb29yKCAobWF4IC0gbWluKSAvIHN0ZXAgKTtcclxuICAgICAgaWYgKCF0aWNrQ2FudmFzKSB7XHJcbiAgICAgICAgdmFyIHRyYWNrVGlja3NTdHlsZSA9ICR3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aWNrQ29udGFpbmVyWzBdKTtcclxuICAgICAgICB0aWNrQ2FudmFzID0gYW5ndWxhci5lbGVtZW50KCc8Y2FudmFzIHN0eWxlPVwicG9zaXRpb246YWJzb2x1dGU7XCI+Jyk7XHJcbiAgICAgICAgdGlja0N0eCA9IHRpY2tDYW52YXNbMF0uZ2V0Q29udGV4dCgnMmQnKTtcclxuICAgICAgICB0aWNrQ3R4LmZpbGxTdHlsZSA9IHRyYWNrVGlja3NTdHlsZS5iYWNrZ3JvdW5kQ29sb3IgfHwgJ2JsYWNrJztcclxuICAgICAgICB0aWNrQ29udGFpbmVyLmFwcGVuZCh0aWNrQ2FudmFzKTtcclxuICAgICAgfVxyXG4gICAgICB2YXIgZGltZW5zaW9ucyA9IGdldFNsaWRlckRpbWVuc2lvbnMoKTtcclxuICAgICAgdGlja0NhbnZhc1swXS53aWR0aCA9IGRpbWVuc2lvbnMud2lkdGg7XHJcbiAgICAgIHRpY2tDYW52YXNbMF0uaGVpZ2h0ID0gZGltZW5zaW9ucy5oZWlnaHQ7XHJcblxyXG4gICAgICB2YXIgZGlzdGFuY2U7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDw9IG51bVN0ZXBzOyBpKyspIHtcclxuICAgICAgICBkaXN0YW5jZSA9IE1hdGguZmxvb3IoZGltZW5zaW9ucy53aWR0aCAqIChpIC8gbnVtU3RlcHMpKTtcclxuICAgICAgICB0aWNrQ3R4LmZpbGxSZWN0KGRpc3RhbmNlIC0gMSwgMCwgMiwgZGltZW5zaW9ucy5oZWlnaHQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVmcmVzaGluZyBEaW1lbnNpb25zXHJcbiAgICAgKi9cclxuICAgIHZhciBzbGlkZXJEaW1lbnNpb25zID0ge307XHJcbiAgICByZWZyZXNoU2xpZGVyRGltZW5zaW9ucygpO1xyXG4gICAgZnVuY3Rpb24gcmVmcmVzaFNsaWRlckRpbWVuc2lvbnMoKSB7XHJcbiAgICAgIHNsaWRlckRpbWVuc2lvbnMgPSB0cmFja0NvbnRhaW5lclswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGdldFNsaWRlckRpbWVuc2lvbnMoKSB7XHJcbiAgICAgIHRocm90dGxlZFJlZnJlc2hEaW1lbnNpb25zKCk7XHJcbiAgICAgIHJldHVybiBzbGlkZXJEaW1lbnNpb25zO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogbGVmdC9yaWdodCBhcnJvdyBsaXN0ZW5lclxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBrZXlkb3duTGlzdGVuZXIoZXYpIHtcclxuICAgICAgaWYoZWxlbWVudFswXS5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciBjaGFuZ2VBbW91bnQ7XHJcbiAgICAgIGlmIChldi5rZXlDb2RlID09PSAkbWRDb25zdGFudC5LRVlfQ09ERS5MRUZUX0FSUk9XKSB7XHJcbiAgICAgICAgY2hhbmdlQW1vdW50ID0gLXN0ZXA7XHJcbiAgICAgIH0gZWxzZSBpZiAoZXYua2V5Q29kZSA9PT0gJG1kQ29uc3RhbnQuS0VZX0NPREUuUklHSFRfQVJST1cpIHtcclxuICAgICAgICBjaGFuZ2VBbW91bnQgPSBzdGVwO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChjaGFuZ2VBbW91bnQpIHtcclxuICAgICAgICBpZiAoZXYubWV0YUtleSB8fCBldi5jdHJsS2V5IHx8IGV2LmFsdEtleSkge1xyXG4gICAgICAgICAgY2hhbmdlQW1vdW50ICo9IDQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgc2NvcGUuJGV2YWxBc3luYyhmdW5jdGlvbigpIHtcclxuICAgICAgICAgIHNldE1vZGVsVmFsdWUobmdNb2RlbEN0cmwuJHZpZXdWYWx1ZSArIGNoYW5nZUFtb3VudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIG5nTW9kZWwgc2V0dGVycyBhbmQgdmFsaWRhdG9yc1xyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBzZXRNb2RlbFZhbHVlKHZhbHVlKSB7XHJcbiAgICAgIG5nTW9kZWxDdHJsLiRzZXRWaWV3VmFsdWUoIG1pbk1heFZhbGlkYXRvcihzdGVwVmFsaWRhdG9yKHZhbHVlKSkgKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIG5nTW9kZWxSZW5kZXIoKSB7XHJcbiAgICAgIGlmIChpc05hTihuZ01vZGVsQ3RybC4kdmlld1ZhbHVlKSkge1xyXG4gICAgICAgIG5nTW9kZWxDdHJsLiR2aWV3VmFsdWUgPSBuZ01vZGVsQ3RybC4kbW9kZWxWYWx1ZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIHBlcmNlbnQgPSAobmdNb2RlbEN0cmwuJHZpZXdWYWx1ZSAtIG1pbikgLyAobWF4IC0gbWluKTtcclxuICAgICAgc2NvcGUubW9kZWxWYWx1ZSA9IG5nTW9kZWxDdHJsLiR2aWV3VmFsdWU7XHJcbiAgICAgIGVsZW1lbnQuYXR0cignYXJpYS12YWx1ZW5vdycsIG5nTW9kZWxDdHJsLiR2aWV3VmFsdWUpO1xyXG4gICAgICBzZXRTbGlkZXJQZXJjZW50KHBlcmNlbnQpO1xyXG4gICAgICB0aHVtYlRleHQudGV4dCggbmdNb2RlbEN0cmwuJHZpZXdWYWx1ZSApO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG1pbk1heFZhbGlkYXRvcih2YWx1ZSkge1xyXG4gICAgICBpZiAoYW5ndWxhci5pc051bWJlcih2YWx1ZSkpIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5tYXgobWluLCBNYXRoLm1pbihtYXgsIHZhbHVlKSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHN0ZXBWYWxpZGF0b3IodmFsdWUpIHtcclxuICAgICAgaWYgKGFuZ3VsYXIuaXNOdW1iZXIodmFsdWUpKSB7XHJcbiAgICAgICAgdmFyIGZvcm1hdHRlZFZhbHVlID0gKE1hdGgucm91bmQodmFsdWUgLyBzdGVwKSAqIHN0ZXApO1xyXG4gICAgICAgIC8vIEZvcm1hdCB0byAzIGRpZ2l0cyBhZnRlciB0aGUgZGVjaW1hbCBwb2ludCAtIGZpeGVzICMyMDE1LlxyXG4gICAgICAgIHJldHVybiAoTWF0aC5yb3VuZChmb3JtYXR0ZWRWYWx1ZSAqIDEwMDApIC8gMTAwMCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSBwZXJjZW50IDAtMVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBzZXRTbGlkZXJQZXJjZW50KHBlcmNlbnQpIHtcclxuICAgICAgYWN0aXZlVHJhY2suY3NzKCd3aWR0aCcsIChwZXJjZW50ICogMTAwKSArICclJyk7XHJcbiAgICAgIHRodW1iQ29udGFpbmVyLmNzcyhcclxuICAgICAgICAnbGVmdCcsXHJcbiAgICAgICAgKHBlcmNlbnQgKiAxMDApICsgJyUnXHJcbiAgICAgICk7XHJcbiAgICAgIGVsZW1lbnQudG9nZ2xlQ2xhc3MoJ21kLW1pbicsIHBlcmNlbnQgPT09IDApO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNsaWRlIGxpc3RlbmVyc1xyXG4gICAgICovXHJcbiAgICB2YXIgaXNEcmFnZ2luZyA9IGZhbHNlO1xyXG4gICAgdmFyIGlzRGlzY3JldGUgPSBhbmd1bGFyLmlzRGVmaW5lZChhdHRyLm1kRGlzY3JldGUpO1xyXG5cclxuICAgIGZ1bmN0aW9uIG9uUHJlc3NEb3duKGV2KSB7XHJcbiAgICAgIGlmIChpc0Rpc2FibGVkR2V0dGVyKCkpIHJldHVybjtcclxuXHJcbiAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICBlbGVtZW50WzBdLmZvY3VzKCk7XHJcbiAgICAgIHJlZnJlc2hTbGlkZXJEaW1lbnNpb25zKCk7XHJcblxyXG4gICAgICB2YXIgZXhhY3RWYWwgPSBwZXJjZW50VG9WYWx1ZSggcG9zaXRpb25Ub1BlcmNlbnQoIGV2LnBvaW50ZXIueCApKTtcclxuICAgICAgdmFyIGNsb3Nlc3RWYWwgPSBtaW5NYXhWYWxpZGF0b3IoIHN0ZXBWYWxpZGF0b3IoZXhhY3RWYWwpICk7XHJcbiAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICBzZXRNb2RlbFZhbHVlKCBjbG9zZXN0VmFsICk7XHJcbiAgICAgICAgc2V0U2xpZGVyUGVyY2VudCggdmFsdWVUb1BlcmNlbnQoY2xvc2VzdFZhbCkpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIG9uUHJlc3NVcChldikge1xyXG4gICAgICBpZiAoaXNEaXNhYmxlZEdldHRlcigpKSByZXR1cm47XHJcblxyXG4gICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdkcmFnZ2luZyBhY3RpdmUnKTtcclxuXHJcbiAgICAgIHZhciBleGFjdFZhbCA9IHBlcmNlbnRUb1ZhbHVlKCBwb3NpdGlvblRvUGVyY2VudCggZXYucG9pbnRlci54ICkpO1xyXG4gICAgICB2YXIgY2xvc2VzdFZhbCA9IG1pbk1heFZhbGlkYXRvciggc3RlcFZhbGlkYXRvcihleGFjdFZhbCkgKTtcclxuICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHNldE1vZGVsVmFsdWUoY2xvc2VzdFZhbCk7XHJcbiAgICAgICAgbmdNb2RlbFJlbmRlcigpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIG9uRHJhZ1N0YXJ0KGV2KSB7XHJcbiAgICAgIGlmIChpc0Rpc2FibGVkR2V0dGVyKCkpIHJldHVybjtcclxuICAgICAgaXNEcmFnZ2luZyA9IHRydWU7XHJcbiAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cclxuICAgICAgZWxlbWVudC5hZGRDbGFzcygnZHJhZ2dpbmcnKTtcclxuICAgICAgc2V0U2xpZGVyRnJvbUV2ZW50KGV2KTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIG9uRHJhZyhldikge1xyXG4gICAgICBpZiAoIWlzRHJhZ2dpbmcpIHJldHVybjtcclxuICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgIHNldFNsaWRlckZyb21FdmVudChldik7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBvbkRyYWdFbmQoZXYpIHtcclxuICAgICAgaWYgKCFpc0RyYWdnaW5nKSByZXR1cm47XHJcbiAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICBpc0RyYWdnaW5nID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gc2V0U2xpZGVyRnJvbUV2ZW50KGV2KSB7XHJcbiAgICAgIC8vIFdoaWxlIHBhbm5pbmcgZGlzY3JldGUsIHVwZGF0ZSBvbmx5IHRoZVxyXG4gICAgICAvLyB2aXN1YWwgcG9zaXRpb25pbmcgYnV0IG5vdCB0aGUgbW9kZWwgdmFsdWUuXHJcbiAgICAgIGlmICggaXNEaXNjcmV0ZSApIGFkanVzdFRodW1iUG9zaXRpb24oIGV2LnBvaW50ZXIueCApO1xyXG4gICAgICBlbHNlICAgICAgICAgICAgICBkb1NsaWRlKCBldi5wb2ludGVyLnggKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNsaWRlIHRoZSBVSSBieSBjaGFuZ2luZyB0aGUgbW9kZWwgdmFsdWVcclxuICAgICAqIEBwYXJhbSB4XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGRvU2xpZGUoIHggKSB7XHJcbiAgICAgIHNjb3BlLiRldmFsQXN5bmMoIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHNldE1vZGVsVmFsdWUoIHBlcmNlbnRUb1ZhbHVlKCBwb3NpdGlvblRvUGVyY2VudCh4KSApKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTbGlkZSB0aGUgVUkgd2l0aG91dCBjaGFuZ2luZyB0aGUgbW9kZWwgKHdoaWxlIGRyYWdnaW5nL3Bhbm5pbmcpXHJcbiAgICAgKiBAcGFyYW0geFxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBhZGp1c3RUaHVtYlBvc2l0aW9uKCB4ICkge1xyXG4gICAgICB2YXIgZXhhY3RWYWwgPSBwZXJjZW50VG9WYWx1ZSggcG9zaXRpb25Ub1BlcmNlbnQoIHggKSk7XHJcbiAgICAgIHZhciBjbG9zZXN0VmFsID0gbWluTWF4VmFsaWRhdG9yKCBzdGVwVmFsaWRhdG9yKGV4YWN0VmFsKSApO1xyXG4gICAgICBzZXRTbGlkZXJQZXJjZW50KCBwb3NpdGlvblRvUGVyY2VudCh4KSApO1xyXG4gICAgICB0aHVtYlRleHQudGV4dCggY2xvc2VzdFZhbCApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ29udmVydCBob3Jpem9udGFsIHBvc2l0aW9uIG9uIHNsaWRlciB0byBwZXJjZW50YWdlIHZhbHVlIG9mIG9mZnNldCBmcm9tIGJlZ2lubmluZy4uLlxyXG4gICAgICogQHBhcmFtIHhcclxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHBvc2l0aW9uVG9QZXJjZW50KCB4ICkge1xyXG4gICAgICByZXR1cm4gTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgKHggLSBzbGlkZXJEaW1lbnNpb25zLmxlZnQpIC8gKHNsaWRlckRpbWVuc2lvbnMud2lkdGgpKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb252ZXJ0IHBlcmNlbnRhZ2Ugb2Zmc2V0IG9uIHNsaWRlIHRvIGVxdWl2YWxlbnQgbW9kZWwgdmFsdWVcclxuICAgICAqIEBwYXJhbSBwZXJjZW50XHJcbiAgICAgKiBAcmV0dXJucyB7Kn1cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gcGVyY2VudFRvVmFsdWUoIHBlcmNlbnQgKSB7XHJcbiAgICAgIHJldHVybiAobWluICsgcGVyY2VudCAqIChtYXggLSBtaW4pKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiB2YWx1ZVRvUGVyY2VudCggdmFsICkge1xyXG4gICAgICByZXR1cm4gKHZhbCAtIG1pbikvKG1heCAtIG1pbik7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblNsaWRlckRpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJCRyQUZcIiwgXCIkd2luZG93XCIsIFwiJG1kQXJpYVwiLCBcIiRtZFV0aWxcIiwgXCIkbWRDb25zdGFudFwiLCBcIiRtZFRoZW1pbmdcIiwgXCIkbWRHZXN0dXJlXCIsIFwiJHBhcnNlXCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuLypcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLnN0aWNreVxyXG4gKiBAZGVzY3JpcHRpb25cclxuICpcclxuICogU3RpY2t5IGVmZmVjdHMgZm9yIG1kXHJcbiAqL1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuc3RpY2t5JywgW1xyXG4gICdtYXRlcmlhbC5jb3JlJyxcclxuICAnbWF0ZXJpYWwuY29tcG9uZW50cy5jb250ZW50J1xyXG5dKVxyXG4gIC5mYWN0b3J5KCckbWRTdGlja3knLCBNZFN0aWNreSk7XHJcblxyXG4vKlxyXG4gKiBAbmdkb2Mgc2VydmljZVxyXG4gKiBAbmFtZSAkbWRTdGlja3lcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnN0aWNreVxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogVGhlIGAkbWRTdGlja3lgc2VydmljZSBwcm92aWRlcyBhIG1peGluIHRvIG1ha2UgZWxlbWVudHMgc3RpY2t5LlxyXG4gKlxyXG4gKiBAcmV0dXJucyBBIGAkbWRTdGlja3lgIGZ1bmN0aW9uIHRoYXQgdGFrZXMgdGhyZWUgYXJndW1lbnRzOlxyXG4gKiAgIC0gYHNjb3BlYFxyXG4gKiAgIC0gYGVsZW1lbnRgOiBUaGUgZWxlbWVudCB0aGF0IHdpbGwgYmUgJ3N0aWNreSdcclxuICogICAtIGBlbGVtZW50Q2xvbmVgOiBBIGNsb25lIG9mIHRoZSBlbGVtZW50LCB0aGF0IHdpbGwgYmUgc2hvd25cclxuICogICAgIHdoZW4gdGhlIHVzZXIgc3RhcnRzIHNjcm9sbGluZyBwYXN0IHRoZSBvcmlnaW5hbCBlbGVtZW50LlxyXG4gKiAgICAgSWYgbm90IHByb3ZpZGVkLCBpdCB3aWxsIHVzZSB0aGUgcmVzdWx0IG9mIGBlbGVtZW50LmNsb25lKClgLlxyXG4gKi9cclxuXHJcbmZ1bmN0aW9uIE1kU3RpY2t5KCRkb2N1bWVudCwgJG1kQ29uc3RhbnQsICRjb21waWxlLCAkJHJBRiwgJG1kVXRpbCkge1xyXG5cclxuICB2YXIgYnJvd3NlclN0aWNreVN1cHBvcnQgPSBjaGVja1N0aWNreVN1cHBvcnQoKTtcclxuXHJcbiAgLyoqXHJcbiAgICogUmVnaXN0ZXJzIGFuIGVsZW1lbnQgYXMgc3RpY2t5LCB1c2VkIGludGVybmFsbHkgYnkgZGlyZWN0aXZlcyB0byByZWdpc3RlciB0aGVtc2VsdmVzXHJcbiAgICovXHJcbiAgcmV0dXJuIGZ1bmN0aW9uIHJlZ2lzdGVyU3RpY2t5RWxlbWVudChzY29wZSwgZWxlbWVudCwgc3RpY2t5Q2xvbmUpIHtcclxuICAgIHZhciBjb250ZW50Q3RybCA9IGVsZW1lbnQuY29udHJvbGxlcignbWRDb250ZW50Jyk7XHJcbiAgICBpZiAoIWNvbnRlbnRDdHJsKSByZXR1cm47XHJcblxyXG4gICAgaWYgKGJyb3dzZXJTdGlja3lTdXBwb3J0KSB7XHJcbiAgICAgIGVsZW1lbnQuY3NzKHtcclxuICAgICAgICBwb3NpdGlvbjogYnJvd3NlclN0aWNreVN1cHBvcnQsXHJcbiAgICAgICAgdG9wOiAwLFxyXG4gICAgICAgICd6LWluZGV4JzogMlxyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHZhciAkJHN0aWNreSA9IGNvbnRlbnRDdHJsLiRlbGVtZW50LmRhdGEoJyQkc3RpY2t5Jyk7XHJcbiAgICAgIGlmICghJCRzdGlja3kpIHtcclxuICAgICAgICAkJHN0aWNreSA9IHNldHVwU3RpY2t5KGNvbnRlbnRDdHJsKTtcclxuICAgICAgICBjb250ZW50Q3RybC4kZWxlbWVudC5kYXRhKCckJHN0aWNreScsICQkc3RpY2t5KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIGRlcmVnaXN0ZXIgPSAkJHN0aWNreS5hZGQoZWxlbWVudCwgc3RpY2t5Q2xvbmUgfHwgZWxlbWVudC5jbG9uZSgpKTtcclxuICAgICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGRlcmVnaXN0ZXIpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIHNldHVwU3RpY2t5KGNvbnRlbnRDdHJsKSB7XHJcbiAgICB2YXIgY29udGVudEVsID0gY29udGVudEN0cmwuJGVsZW1lbnQ7XHJcblxyXG4gICAgLy8gUmVmcmVzaCBlbGVtZW50cyBpcyB2ZXJ5IGV4cGVuc2l2ZSwgc28gd2UgdXNlIHRoZSBkZWJvdW5jZWRcclxuICAgIC8vIHZlcnNpb24gd2hlbiBwb3NzaWJsZS5cclxuICAgIHZhciBkZWJvdW5jZWRSZWZyZXNoRWxlbWVudHMgPSAkJHJBRi50aHJvdHRsZShyZWZyZXNoRWxlbWVudHMpO1xyXG5cclxuICAgIC8vIHNldHVwQXVnbWVudGVkU2Nyb2xsRXZlbnRzIGdpdmVzIHVzIGAkc2Nyb2xsc3RhcnRgIGFuZCBgJHNjcm9sbGAsXHJcbiAgICAvLyBtb3JlIHJlbGlhYmxlIHRoYW4gYHNjcm9sbGAgb24gYW5kcm9pZC5cclxuICAgIHNldHVwQXVnbWVudGVkU2Nyb2xsRXZlbnRzKGNvbnRlbnRFbCk7XHJcbiAgICBjb250ZW50RWwub24oJyRzY3JvbGxzdGFydCcsIGRlYm91bmNlZFJlZnJlc2hFbGVtZW50cyk7XHJcbiAgICBjb250ZW50RWwub24oJyRzY3JvbGwnLCBvblNjcm9sbCk7XHJcblxyXG4gICAgdmFyIHNlbGY7XHJcbiAgICB2YXIgc3RpY2t5QmFzZW9mZnNldCA9IGNvbnRlbnRFbC5wcm9wKCdvZmZzZXRUb3AnKTtcclxuICAgIHJldHVybiBzZWxmID0ge1xyXG4gICAgICBwcmV2OiBudWxsLFxyXG4gICAgICBjdXJyZW50OiBudWxsLCAvL3RoZSBjdXJyZW50bHkgc3RpY2tpZWQgaXRlbVxyXG4gICAgICBuZXh0OiBudWxsLFxyXG4gICAgICBpdGVtczogW10sXHJcbiAgICAgIGFkZDogYWRkLFxyXG4gICAgICByZWZyZXNoRWxlbWVudHM6IHJlZnJlc2hFbGVtZW50c1xyXG4gICAgfTtcclxuXHJcbiAgICAvKioqKioqKioqKioqKioqXHJcbiAgICAgKiBQdWJsaWNcclxuICAgICAqKioqKioqKioqKioqKiovXHJcbiAgICAvLyBBZGQgYW4gZWxlbWVudCBhbmQgaXRzIHN0aWNreSBjbG9uZSB0byB0aGlzIGNvbnRlbnQncyBzdGlja3kgY29sbGVjdGlvblxyXG4gICAgZnVuY3Rpb24gYWRkKGVsZW1lbnQsIHN0aWNreUNsb25lKSB7XHJcbiAgICAgIHN0aWNreUNsb25lLmFkZENsYXNzKCdtZC1zdGlja3ktY2xvbmUnKTtcclxuICAgICAgc3RpY2t5Q2xvbmUuY3NzKCd0b3AnLCBzdGlja3lCYXNlb2Zmc2V0ICsgJ3B4Jyk7XHJcblxyXG4gICAgICB2YXIgaXRlbSA9IHtcclxuICAgICAgICBlbGVtZW50OiBlbGVtZW50LFxyXG4gICAgICAgIGNsb25lOiBzdGlja3lDbG9uZVxyXG4gICAgICB9O1xyXG4gICAgICBzZWxmLml0ZW1zLnB1c2goaXRlbSk7XHJcblxyXG4gICAgICBjb250ZW50RWwucGFyZW50KCkucHJlcGVuZChpdGVtLmNsb25lKTtcclxuXHJcbiAgICAgIGRlYm91bmNlZFJlZnJlc2hFbGVtZW50cygpO1xyXG5cclxuICAgICAgcmV0dXJuIGZ1bmN0aW9uIHJlbW92ZSgpIHtcclxuICAgICAgICBzZWxmLml0ZW1zLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHtcclxuICAgICAgICAgIGlmIChpdGVtLmVsZW1lbnRbMF0gPT09IGVsZW1lbnRbMF0pIHtcclxuICAgICAgICAgICAgc2VsZi5pdGVtcy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICBpdGVtLmNsb25lLnJlbW92ZSgpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGRlYm91bmNlZFJlZnJlc2hFbGVtZW50cygpO1xyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHJlZnJlc2hFbGVtZW50cygpIHtcclxuICAgICAgLy8gU29ydCBvdXIgY29sbGVjdGlvbiBvZiBlbGVtZW50cyBieSB0aGVpciBjdXJyZW50IHBvc2l0aW9uIGluIHRoZSBET00uXHJcbiAgICAgIC8vIFdlIG5lZWQgdG8gZG8gdGhpcyBiZWNhdXNlIG91ciBlbGVtZW50cycgb3JkZXIgb2YgYmVpbmcgYWRkZWQgbWF5IG5vdFxyXG4gICAgICAvLyBiZSB0aGUgc2FtZSBhcyB0aGVpciBvcmRlciBvZiBkaXNwbGF5LlxyXG4gICAgICBzZWxmLml0ZW1zLmZvckVhY2gocmVmcmVzaFBvc2l0aW9uKTtcclxuICAgICAgc2VsZi5pdGVtcyA9IHNlbGYuaXRlbXMuc29ydChmdW5jdGlvbihhLCBiKSB7XHJcbiAgICAgICAgcmV0dXJuIGEudG9wIDwgYi50b3AgPyAtMSA6IDE7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gRmluZCB3aGljaCBpdGVtIGluIHRoZSBsaXN0IHNob3VsZCBiZSBhY3RpdmUsIFxyXG4gICAgICAvLyBiYXNlZCB1cG9uIHRoZSBjb250ZW50J3MgY3VycmVudCBzY3JvbGwgcG9zaXRpb25cclxuICAgICAgdmFyIGl0ZW07XHJcbiAgICAgIHZhciBjdXJyZW50U2Nyb2xsVG9wID0gY29udGVudEVsLnByb3AoJ3Njcm9sbFRvcCcpO1xyXG4gICAgICBmb3IgKHZhciBpID0gc2VsZi5pdGVtcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgICAgIGlmIChjdXJyZW50U2Nyb2xsVG9wID4gc2VsZi5pdGVtc1tpXS50b3ApIHtcclxuICAgICAgICAgIGl0ZW0gPSBzZWxmLml0ZW1zW2ldO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHNldEN1cnJlbnRJdGVtKGl0ZW0pO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKioqKioqKioqKioqKioqXHJcbiAgICAgKiBQcml2YXRlXHJcbiAgICAgKioqKioqKioqKioqKioqL1xyXG5cclxuICAgIC8vIEZpbmQgdGhlIGB0b3BgIG9mIGFuIGl0ZW0gcmVsYXRpdmUgdG8gdGhlIGNvbnRlbnQgZWxlbWVudCxcclxuICAgIC8vIGFuZCBhbHNvIHRoZSBoZWlnaHQuXHJcbiAgICBmdW5jdGlvbiByZWZyZXNoUG9zaXRpb24oaXRlbSkge1xyXG4gICAgICAvLyBGaW5kIHRoZSB0b3Agb2YgYW4gaXRlbSBieSBhZGRpbmcgdG8gdGhlIG9mZnNldEhlaWdodCB1bnRpbCB3ZSByZWFjaCB0aGUgXHJcbiAgICAgIC8vIGNvbnRlbnQgZWxlbWVudC5cclxuICAgICAgdmFyIGN1cnJlbnQgPSBpdGVtLmVsZW1lbnRbMF07XHJcbiAgICAgIGl0ZW0udG9wID0gMDtcclxuICAgICAgaXRlbS5sZWZ0ID0gMDtcclxuICAgICAgd2hpbGUgKGN1cnJlbnQgJiYgY3VycmVudCAhPT0gY29udGVudEVsWzBdKSB7XHJcbiAgICAgICAgaXRlbS50b3AgKz0gY3VycmVudC5vZmZzZXRUb3A7XHJcbiAgICAgICAgaXRlbS5sZWZ0ICs9IGN1cnJlbnQub2Zmc2V0TGVmdDtcclxuICAgICAgICBjdXJyZW50ID0gY3VycmVudC5vZmZzZXRQYXJlbnQ7XHJcbiAgICAgIH1cclxuICAgICAgaXRlbS5oZWlnaHQgPSBpdGVtLmVsZW1lbnQucHJvcCgnb2Zmc2V0SGVpZ2h0Jyk7XHJcbiAgICAgIGl0ZW0uY2xvbmUuY3NzKCdtYXJnaW4tbGVmdCcsIGl0ZW0ubGVmdCArICdweCcpO1xyXG4gICAgICBpZiAoJG1kVXRpbC5mbG9hdGluZ1Njcm9sbGJhcnMoKSkge1xyXG4gICAgICAgIGl0ZW0uY2xvbmUuY3NzKCdtYXJnaW4tcmlnaHQnLCAnMCcpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8vIEFzIHdlIHNjcm9sbCwgcHVzaCBpbiBhbmQgc2VsZWN0IHRoZSBjb3JyZWN0IHN0aWNreSBlbGVtZW50LlxyXG4gICAgZnVuY3Rpb24gb25TY3JvbGwoKSB7XHJcbiAgICAgIHZhciBzY3JvbGxUb3AgPSBjb250ZW50RWwucHJvcCgnc2Nyb2xsVG9wJyk7XHJcbiAgICAgIHZhciBpc1Njcm9sbGluZ0Rvd24gPSBzY3JvbGxUb3AgPiAob25TY3JvbGwucHJldlNjcm9sbFRvcCB8fCAwKTtcclxuICAgICAgb25TY3JvbGwucHJldlNjcm9sbFRvcCA9IHNjcm9sbFRvcDtcclxuXHJcbiAgICAgIC8vIEF0IHRoZSB0b3A/XHJcbiAgICAgIGlmIChzY3JvbGxUb3AgPT09IDApIHtcclxuICAgICAgICBzZXRDdXJyZW50SXRlbShudWxsKTtcclxuXHJcbiAgICAgIC8vIEdvaW5nIHRvIG5leHQgaXRlbT9cclxuICAgICAgfSBlbHNlIGlmIChpc1Njcm9sbGluZ0Rvd24gJiYgc2VsZi5uZXh0KSB7XHJcbiAgICAgICAgaWYgKHNlbGYubmV4dC50b3AgLSBzY3JvbGxUb3AgPD0gMCkge1xyXG4gICAgICAgICAgLy8gU3RpY2t5IHRoZSBuZXh0IGl0ZW0gaWYgd2UndmUgc2Nyb2xsZWQgcGFzdCBpdHMgcG9zaXRpb24uXHJcbiAgICAgICAgICBzZXRDdXJyZW50SXRlbShzZWxmLm5leHQpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoc2VsZi5jdXJyZW50KSB7XHJcbiAgICAgICAgICAvLyBQdXNoIHRoZSBjdXJyZW50IGl0ZW0gdXAgd2hlbiB3ZSdyZSBhbG1vc3QgYXQgdGhlIG5leHQgaXRlbS5cclxuICAgICAgICAgIGlmIChzZWxmLm5leHQudG9wIC0gc2Nyb2xsVG9wIDw9IHNlbGYubmV4dC5oZWlnaHQpIHtcclxuICAgICAgICAgICAgdHJhbnNsYXRlKHNlbGYuY3VycmVudCwgc2VsZi5uZXh0LnRvcCAtIHNlbGYubmV4dC5oZWlnaHQgLSBzY3JvbGxUb3ApO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdHJhbnNsYXRlKHNlbGYuY3VycmVudCwgbnVsbCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAvLyBTY3JvbGxpbmcgdXAgd2l0aCBhIGN1cnJlbnQgc3RpY2t5IGl0ZW0/XHJcbiAgICAgIH0gZWxzZSBpZiAoIWlzU2Nyb2xsaW5nRG93biAmJiBzZWxmLmN1cnJlbnQpIHtcclxuICAgICAgICBpZiAoc2Nyb2xsVG9wIDwgc2VsZi5jdXJyZW50LnRvcCkge1xyXG4gICAgICAgICAgLy8gU3RpY2t5IHRoZSBwcmV2aW91cyBpdGVtIGlmIHdlJ3ZlIHNjcm9sbGVkIHVwIHBhc3RcclxuICAgICAgICAgIC8vIHRoZSBvcmlnaW5hbCBwb3NpdGlvbiBvZiB0aGUgY3VycmVudGx5IHN0aWNraWVkIGl0ZW0uXHJcbiAgICAgICAgICBzZXRDdXJyZW50SXRlbShzZWxmLnByZXYpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBTY3JvbGxpbmcgdXAsIGFuZCBqdXN0IGJ1bXBpbmcgaW50byB0aGUgaXRlbSBhYm92ZSAoanVzdCBzZXQgdG8gY3VycmVudCk/XHJcbiAgICAgICAgLy8gSWYgd2UgaGF2ZSBhIG5leHQgaXRlbSBidW1waW5nIGludG8gdGhlIGN1cnJlbnQgaXRlbSwgdHJhbnNsYXRlXHJcbiAgICAgICAgLy8gdGhlIGN1cnJlbnQgaXRlbSB1cCBmcm9tIHRoZSB0b3AgYXMgaXQgc2Nyb2xscyBpbnRvIHZpZXcuXHJcbiAgICAgICAgaWYgKHNlbGYuY3VycmVudCAmJiBzZWxmLm5leHQpIHtcclxuICAgICAgICAgIGlmIChzY3JvbGxUb3AgPj0gc2VsZi5uZXh0LnRvcCAtIHNlbGYuY3VycmVudC5oZWlnaHQpIHtcclxuICAgICAgICAgICAgdHJhbnNsYXRlKHNlbGYuY3VycmVudCwgc2VsZi5uZXh0LnRvcCAtIHNjcm9sbFRvcCAtIHNlbGYuY3VycmVudC5oZWlnaHQpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdHJhbnNsYXRlKHNlbGYuY3VycmVudCwgbnVsbCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICAgXHJcbiAgIGZ1bmN0aW9uIHNldEN1cnJlbnRJdGVtKGl0ZW0pIHtcclxuICAgICBpZiAoc2VsZi5jdXJyZW50ID09PSBpdGVtKSByZXR1cm47XHJcbiAgICAgLy8gRGVhY3RpdmF0ZSBjdXJyZW50bHkgYWN0aXZlIGl0ZW1cclxuICAgICBpZiAoc2VsZi5jdXJyZW50KSB7XHJcbiAgICAgICB0cmFuc2xhdGUoc2VsZi5jdXJyZW50LCBudWxsKTtcclxuICAgICAgIHNldFN0aWNreVN0YXRlKHNlbGYuY3VycmVudCwgbnVsbCk7XHJcbiAgICAgfVxyXG5cclxuICAgICAvLyBBY3RpdmF0ZSBuZXcgaXRlbSBpZiBnaXZlblxyXG4gICAgIGlmIChpdGVtKSB7XHJcbiAgICAgICBzZXRTdGlja3lTdGF0ZShpdGVtLCAnYWN0aXZlJyk7XHJcbiAgICAgfVxyXG5cclxuICAgICBzZWxmLmN1cnJlbnQgPSBpdGVtO1xyXG4gICAgIHZhciBpbmRleCA9IHNlbGYuaXRlbXMuaW5kZXhPZihpdGVtKTtcclxuICAgICAvLyBJZiBpbmRleCA9PT0gLTEsIGluZGV4ICsgMSA9IDAuIEl0IHdvcmtzIG91dC5cclxuICAgICBzZWxmLm5leHQgPSBzZWxmLml0ZW1zW2luZGV4ICsgMV07XHJcbiAgICAgc2VsZi5wcmV2ID0gc2VsZi5pdGVtc1tpbmRleCAtIDFdO1xyXG4gICAgIHNldFN0aWNreVN0YXRlKHNlbGYubmV4dCwgJ25leHQnKTtcclxuICAgICBzZXRTdGlja3lTdGF0ZShzZWxmLnByZXYsICdwcmV2Jyk7XHJcbiAgIH1cclxuXHJcbiAgIGZ1bmN0aW9uIHNldFN0aWNreVN0YXRlKGl0ZW0sIHN0YXRlKSB7XHJcbiAgICAgaWYgKCFpdGVtIHx8IGl0ZW0uc3RhdGUgPT09IHN0YXRlKSByZXR1cm47XHJcbiAgICAgaWYgKGl0ZW0uc3RhdGUpIHtcclxuICAgICAgIGl0ZW0uY2xvbmUuYXR0cignc3RpY2t5LXByZXYtc3RhdGUnLCBpdGVtLnN0YXRlKTtcclxuICAgICAgIGl0ZW0uZWxlbWVudC5hdHRyKCdzdGlja3ktcHJldi1zdGF0ZScsIGl0ZW0uc3RhdGUpO1xyXG4gICAgIH1cclxuICAgICBpdGVtLmNsb25lLmF0dHIoJ3N0aWNreS1zdGF0ZScsIHN0YXRlKTtcclxuICAgICBpdGVtLmVsZW1lbnQuYXR0cignc3RpY2t5LXN0YXRlJywgc3RhdGUpO1xyXG4gICAgIGl0ZW0uc3RhdGUgPSBzdGF0ZTtcclxuICAgfVxyXG5cclxuICAgZnVuY3Rpb24gdHJhbnNsYXRlKGl0ZW0sIGFtb3VudCkge1xyXG4gICAgIGlmICghaXRlbSkgcmV0dXJuO1xyXG4gICAgIGlmIChhbW91bnQgPT09IG51bGwgfHwgYW1vdW50ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgIGlmIChpdGVtLnRyYW5zbGF0ZVkpIHtcclxuICAgICAgICAgaXRlbS50cmFuc2xhdGVZID0gbnVsbDtcclxuICAgICAgICAgaXRlbS5jbG9uZS5jc3MoJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STSwgJycpO1xyXG4gICAgICAgfVxyXG4gICAgIH0gZWxzZSB7XHJcbiAgICAgICBpdGVtLnRyYW5zbGF0ZVkgPSBhbW91bnQ7XHJcbiAgICAgICBpdGVtLmNsb25lLmNzcyhcclxuICAgICAgICAgJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STSwgXHJcbiAgICAgICAgICd0cmFuc2xhdGUzZCgnICsgaXRlbS5sZWZ0ICsgJ3B4LCcgKyBhbW91bnQgKyAncHgsMCknXHJcbiAgICAgICApO1xyXG4gICAgIH1cclxuICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gRnVuY3Rpb24gdG8gY2hlY2sgZm9yIGJyb3dzZXIgc3RpY2t5IHN1cHBvcnRcclxuICBmdW5jdGlvbiBjaGVja1N0aWNreVN1cHBvcnQoJGVsKSB7XHJcbiAgICB2YXIgc3RpY2t5UHJvcDtcclxuICAgIHZhciB0ZXN0RWwgPSBhbmd1bGFyLmVsZW1lbnQoJzxkaXY+Jyk7XHJcbiAgICAkZG9jdW1lbnRbMF0uYm9keS5hcHBlbmRDaGlsZCh0ZXN0RWxbMF0pO1xyXG5cclxuICAgIHZhciBzdGlja3lQcm9wcyA9IFsnc3RpY2t5JywgJy13ZWJraXQtc3RpY2t5J107XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0aWNreVByb3BzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgIHRlc3RFbC5jc3Moe3Bvc2l0aW9uOiBzdGlja3lQcm9wc1tpXSwgdG9wOiAwLCAnei1pbmRleCc6IDJ9KTtcclxuICAgICAgaWYgKHRlc3RFbC5jc3MoJ3Bvc2l0aW9uJykgPT0gc3RpY2t5UHJvcHNbaV0pIHtcclxuICAgICAgICBzdGlja3lQcm9wID0gc3RpY2t5UHJvcHNbaV07XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHRlc3RFbC5yZW1vdmUoKTtcclxuICAgIHJldHVybiBzdGlja3lQcm9wO1xyXG4gIH1cclxuXHJcbiAgLy8gQW5kcm9pZCA0LjQgZG9uJ3QgYWNjdXJhdGVseSBnaXZlIHNjcm9sbCBldmVudHMuXHJcbiAgLy8gVG8gZml4IHRoaXMgcHJvYmxlbSwgd2Ugc2V0dXAgYSBmYWtlIHNjcm9sbCBldmVudC4gV2Ugc2F5OlxyXG4gIC8vID4gSWYgYSBzY3JvbGwgb3IgdG91Y2htb3ZlIGV2ZW50IGhhcyBoYXBwZW5lZCBpbiB0aGUgbGFzdCBERUxBWSBtaWxsaXNlY29uZHMsIFxyXG4gIC8vICAgdGhlbiBzZW5kIGEgYCRzY3JvbGxgIGV2ZW50IGV2ZXJ5IGFuaW1hdGlvbkZyYW1lLlxyXG4gIC8vIEFkZGl0aW9uYWxseSwgd2UgYWRkICRzY3JvbGxzdGFydCBhbmQgJHNjcm9sbGVuZCBldmVudHMuXHJcbiAgZnVuY3Rpb24gc2V0dXBBdWdtZW50ZWRTY3JvbGxFdmVudHMoZWxlbWVudCkge1xyXG4gICAgdmFyIFNDUk9MTF9FTkRfREVMQVkgPSAyMDA7XHJcbiAgICB2YXIgaXNTY3JvbGxpbmc7XHJcbiAgICB2YXIgbGFzdFNjcm9sbFRpbWU7XHJcbiAgICBlbGVtZW50Lm9uKCdzY3JvbGwgdG91Y2htb3ZlJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIGlmICghaXNTY3JvbGxpbmcpIHtcclxuICAgICAgICBpc1Njcm9sbGluZyA9IHRydWU7XHJcbiAgICAgICAgJCRyQUYobG9vcFNjcm9sbEV2ZW50KTtcclxuICAgICAgICBlbGVtZW50LnRyaWdnZXJIYW5kbGVyKCckc2Nyb2xsc3RhcnQnKTtcclxuICAgICAgfVxyXG4gICAgICBlbGVtZW50LnRyaWdnZXJIYW5kbGVyKCckc2Nyb2xsJyk7XHJcbiAgICAgIGxhc3RTY3JvbGxUaW1lID0gKyRtZFV0aWwubm93KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBmdW5jdGlvbiBsb29wU2Nyb2xsRXZlbnQoKSB7XHJcbiAgICAgIGlmICgrJG1kVXRpbC5ub3coKSAtIGxhc3RTY3JvbGxUaW1lID4gU0NST0xMX0VORF9ERUxBWSkge1xyXG4gICAgICAgIGlzU2Nyb2xsaW5nID0gZmFsc2U7XHJcbiAgICAgICAgZWxlbWVudC50cmlnZ2VySGFuZGxlcignJHNjcm9sbGVuZCcpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGVsZW1lbnQudHJpZ2dlckhhbmRsZXIoJyRzY3JvbGwnKTtcclxuICAgICAgICAkJHJBRihsb29wU2Nyb2xsRXZlbnQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxufVxyXG5NZFN0aWNreS4kaW5qZWN0ID0gW1wiJGRvY3VtZW50XCIsIFwiJG1kQ29uc3RhbnRcIiwgXCIkY29tcGlsZVwiLCBcIiQkckFGXCIsIFwiJG1kVXRpbFwiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbW9kdWxlXHJcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuc3ViaGVhZGVyXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBTdWJIZWFkZXIgbW9kdWxlXHJcbiAqXHJcbiAqICBTdWJoZWFkZXJzIGFyZSBzcGVjaWFsIGxpc3QgdGlsZXMgdGhhdCBkZWxpbmVhdGUgZGlzdGluY3Qgc2VjdGlvbnMgb2YgYVxyXG4gKiAgbGlzdCBvciBncmlkIGxpc3QgYW5kIGFyZSB0eXBpY2FsbHkgcmVsYXRlZCB0byB0aGUgY3VycmVudCBmaWx0ZXJpbmcgb3JcclxuICogIHNvcnRpbmcgY3JpdGVyaWEuIFN1YmhlYWRlciB0aWxlcyBhcmUgZWl0aGVyIGRpc3BsYXllZCBpbmxpbmUgd2l0aCB0aWxlcyBvclxyXG4gKiAgY2FuIGJlIGFzc29jaWF0ZWQgd2l0aCBjb250ZW50LCBmb3IgZXhhbXBsZSwgaW4gYW4gYWRqYWNlbnQgY29sdW1uLlxyXG4gKlxyXG4gKiAgVXBvbiBzY3JvbGxpbmcsIHN1YmhlYWRlcnMgcmVtYWluIHBpbm5lZCB0byB0aGUgdG9wIG9mIHRoZSBzY3JlZW4gYW5kIHJlbWFpblxyXG4gKiAgcGlubmVkIHVudGlsIHB1c2hlZCBvbiBvciBvZmYgc2NyZWVuIGJ5IHRoZSBuZXh0IHN1YmhlYWRlci4gQHNlZSBbTWF0ZXJpYWxcclxuICogIERlc2lnbiBTcGVjaWZpY2F0aW9uc10oaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9kZXNpZ24vc3BlYy9jb21wb25lbnRzL3N1YmhlYWRlcnMuaHRtbClcclxuICpcclxuICogID4gVG8gaW1wcm92ZSB0aGUgdmlzdWFsIGdyb3VwaW5nIG9mIGNvbnRlbnQsIHVzZSB0aGUgc3lzdGVtIGNvbG9yIGZvciB5b3VyIHN1YmhlYWRlcnMuXHJcbiAqXHJcbiAqL1xyXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5zdWJoZWFkZXInLCBbXHJcbiAgJ21hdGVyaWFsLmNvcmUnLFxyXG4gICdtYXRlcmlhbC5jb21wb25lbnRzLnN0aWNreSdcclxuXSlcclxuICAuZGlyZWN0aXZlKCdtZFN1YmhlYWRlcicsIE1kU3ViaGVhZGVyRGlyZWN0aXZlKTtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAqIEBuYW1lIG1kU3ViaGVhZGVyXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5zdWJoZWFkZXJcclxuICpcclxuICogQHJlc3RyaWN0IEVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIFRoZSBgPG1kLXN1YmhlYWRlcj5gIGRpcmVjdGl2ZSBpcyBhIHN1YmhlYWRlciBmb3IgYSBzZWN0aW9uLiBCeSBkZWZhdWx0IGl0IGlzIHN0aWNreS5cclxuICogWW91IGNhbiBtYWtlIGl0IG5vdCBzdGlja3kgYnkgYXBwbHlpbmcgdGhlIGBtZC1uby1zdGlja3lgIGNsYXNzIHRvIHRoZSBzdWJoZWFkZXIuXHJcbiAqXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtc3ViaGVhZGVyPk9ubGluZSBGcmllbmRzPC9tZC1zdWJoZWFkZXI+XHJcbiAqIDwvaGxqcz5cclxuICovXHJcblxyXG5mdW5jdGlvbiBNZFN1YmhlYWRlckRpcmVjdGl2ZSgkbWRTdGlja3ksICRjb21waWxlLCAkbWRUaGVtaW5nKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICByZXBsYWNlOiB0cnVlLFxyXG4gICAgdHJhbnNjbHVkZTogdHJ1ZSxcclxuICAgIHRlbXBsYXRlOiBcclxuICAgICAgJzxoMiBjbGFzcz1cIm1kLXN1YmhlYWRlclwiPicgK1xyXG4gICAgICAgICc8ZGl2IGNsYXNzPVwibWQtc3ViaGVhZGVyLWlubmVyXCI+JyArXHJcbiAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJtZC1zdWJoZWFkZXItY29udGVudFwiPjwvc3Bhbj4nICtcclxuICAgICAgICAnPC9kaXY+JyArXHJcbiAgICAgICc8L2gyPicsXHJcbiAgICBjb21waWxlOiBmdW5jdGlvbihlbGVtZW50LCBhdHRyLCB0cmFuc2NsdWRlKSB7XHJcbiAgICAgIHJldHVybiBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0cikge1xyXG4gICAgICAgICRtZFRoZW1pbmcoZWxlbWVudCk7XHJcbiAgICAgICAgdmFyIG91dGVySFRNTCA9IGVsZW1lbnRbMF0ub3V0ZXJIVE1MO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRDb250ZW50KGVsKSB7XHJcbiAgICAgICAgICByZXR1cm4gYW5ndWxhci5lbGVtZW50KGVsWzBdLnF1ZXJ5U2VsZWN0b3IoJy5tZC1zdWJoZWFkZXItY29udGVudCcpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFRyYW5zY2x1ZGUgdGhlIHVzZXItZ2l2ZW4gY29udGVudHMgb2YgdGhlIHN1YmhlYWRlclxyXG4gICAgICAgIC8vIHRoZSBjb252ZW50aW9uYWwgd2F5LlxyXG4gICAgICAgIHRyYW5zY2x1ZGUoc2NvcGUsIGZ1bmN0aW9uKGNsb25lKSB7XHJcbiAgICAgICAgICBnZXRDb250ZW50KGVsZW1lbnQpLmFwcGVuZChjbG9uZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIENyZWF0ZSBhbm90aGVyIGNsb25lLCB0aGF0IHVzZXMgdGhlIG91dGVyIGFuZCBpbm5lciBjb250ZW50c1xyXG4gICAgICAgIC8vIG9mIHRoZSBlbGVtZW50LCB0aGF0IHdpbGwgYmUgJ3N0aWNraWVkJyBhcyB0aGUgdXNlciBzY3JvbGxzLlxyXG4gICAgICAgIGlmICghZWxlbWVudC5oYXNDbGFzcygnbWQtbm8tc3RpY2t5JykpIHtcclxuICAgICAgICAgIHRyYW5zY2x1ZGUoc2NvcGUsIGZ1bmN0aW9uKGNsb25lKSB7XHJcbiAgICAgICAgICAgIHZhciBzdGlja3lDbG9uZSA9ICRjb21waWxlKGFuZ3VsYXIuZWxlbWVudChvdXRlckhUTUwpKShzY29wZSk7XHJcbiAgICAgICAgICAgIGdldENvbnRlbnQoc3RpY2t5Q2xvbmUpLmFwcGVuZChjbG9uZSk7XHJcbiAgICAgICAgICAgICRtZFN0aWNreShzY29wZSwgZWxlbWVudCwgc3RpY2t5Q2xvbmUpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuTWRTdWJoZWFkZXJEaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZFN0aWNreVwiLCBcIiRjb21waWxlXCIsIFwiJG1kVGhlbWluZ1wiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbW9kdWxlXHJcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuc3dpcGVcclxuICogQGRlc2NyaXB0aW9uIFN3aXBlIG1vZHVsZSFcclxuICovXHJcbi8qKlxyXG4gKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5zd2lwZVxyXG4gKiBAbmFtZSBtZFN3aXBlTGVmdFxyXG4gKlxyXG4gKiBAcmVzdHJpY3QgQVxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogVGhlIG1kLXN3aXBlLWxlZnQgZGlyZWN0aXZlcyBhbGxvd3MgeW91IHRvIHNwZWNpZnkgY3VzdG9tIGJlaGF2aW9yIHdoZW4gYW4gZWxlbWVudCBpcyBzd2lwZWRcclxuICogbGVmdC5cclxuICpcclxuICogQHVzYWdlXHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqIDxkaXYgbWQtc3dpcGUtbGVmdD1cIm9uU3dpcGVMZWZ0KClcIj5Td2lwZSBtZSBsZWZ0ITwvZGl2PlxyXG4gKiA8L2hsanM+XHJcbiAqL1xyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuc3dpcGVcclxuICogQG5hbWUgbWRTd2lwZVJpZ2h0XHJcbiAqXHJcbiAqIEByZXN0cmljdCBBXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBUaGUgbWQtc3dpcGUtcmlnaHQgZGlyZWN0aXZlcyBhbGxvd3MgeW91IHRvIHNwZWNpZnkgY3VzdG9tIGJlaGF2aW9yIHdoZW4gYW4gZWxlbWVudCBpcyBzd2lwZWRcclxuICogcmlnaHQuXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8ZGl2IG1kLXN3aXBlLXJpZ2h0PVwib25Td2lwZVJpZ2h0KClcIj5Td2lwZSBtZSByaWdodCE8L2Rpdj5cclxuICogPC9obGpzPlxyXG4gKi9cclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnN3aXBlJywgWydtYXRlcmlhbC5jb3JlJ10pXHJcbiAgICAuZGlyZWN0aXZlKCdtZFN3aXBlTGVmdCcsIGdldERpcmVjdGl2ZSgnU3dpcGVMZWZ0JykpXHJcbiAgICAuZGlyZWN0aXZlKCdtZFN3aXBlUmlnaHQnLCBnZXREaXJlY3RpdmUoJ1N3aXBlUmlnaHQnKSk7XHJcblxyXG5mdW5jdGlvbiBnZXREaXJlY3RpdmUobmFtZSkge1xyXG4gIHZhciBkaXJlY3RpdmVOYW1lID0gJ21kJyArIG5hbWU7XHJcbiAgdmFyIGV2ZW50TmFtZSA9ICckbWQuJyArIG5hbWUudG9Mb3dlckNhc2UoKTtcclxuXHJcbiAgICBEaXJlY3RpdmVGYWN0b3J5LiRpbmplY3QgPSBbXCIkcGFyc2VcIl07XHJcbiAgcmV0dXJuIERpcmVjdGl2ZUZhY3Rvcnk7XHJcblxyXG4gIC8qIEBuZ0luamVjdCAqL1xyXG4gIGZ1bmN0aW9uIERpcmVjdGl2ZUZhY3RvcnkoJHBhcnNlKSB7XHJcbiAgICAgIHJldHVybiB7IHJlc3RyaWN0OiAnQScsIGxpbms6IHBvc3RMaW5rIH07XHJcbiAgICAgIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XHJcbiAgICAgICAgdmFyIGZuID0gJHBhcnNlKGF0dHJbZGlyZWN0aXZlTmFtZV0pO1xyXG4gICAgICAgIGVsZW1lbnQub24oZXZlbnROYW1lLCBmdW5jdGlvbihldikge1xyXG4gICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkgeyBmbihzY29wZSwgeyAkZXZlbnQ6IGV2IH0pOyB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5cclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qKlxyXG4gKiBAcHJpdmF0ZVxyXG4gKiBAbmdkb2MgbW9kdWxlXHJcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuc3dpdGNoXHJcbiAqL1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuc3dpdGNoJywgW1xyXG4gICdtYXRlcmlhbC5jb3JlJyxcclxuICAnbWF0ZXJpYWwuY29tcG9uZW50cy5jaGVja2JveCdcclxuXSlcclxuICAuZGlyZWN0aXZlKCdtZFN3aXRjaCcsIE1kU3dpdGNoKTtcclxuXHJcbi8qKlxyXG4gKiBAcHJpdmF0ZVxyXG4gKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5zd2l0Y2hcclxuICogQG5hbWUgbWRTd2l0Y2hcclxuICogQHJlc3RyaWN0IEVcclxuICpcclxuICogVGhlIHN3aXRjaCBkaXJlY3RpdmUgaXMgdXNlZCB2ZXJ5IG11Y2ggbGlrZSB0aGUgbm9ybWFsIFthbmd1bGFyIGNoZWNrYm94XShodHRwczovL2RvY3MuYW5ndWxhcmpzLm9yZy9hcGkvbmcvaW5wdXQvaW5wdXQlNUJjaGVja2JveCU1RCkuXHJcbiAqXHJcbiAqIEFzIHBlciB0aGUgW21hdGVyaWFsIGRlc2lnbiBzcGVjXShodHRwOi8vd3d3Lmdvb2dsZS5jb20vZGVzaWduL3NwZWMvc3R5bGUvY29sb3IuaHRtbCNjb2xvci11aS1jb2xvci1hcHBsaWNhdGlvbilcclxuICogdGhlIHN3aXRjaCBpcyBpbiB0aGUgYWNjZW50IGNvbG9yIGJ5IGRlZmF1bHQuIFRoZSBwcmltYXJ5IGNvbG9yIHBhbGV0dGUgbWF5IGJlIHVzZWQgd2l0aFxyXG4gKiB0aGUgYG1kLXByaW1hcnlgIGNsYXNzLlxyXG4gKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gbmctbW9kZWwgQXNzaWduYWJsZSBhbmd1bGFyIGV4cHJlc3Npb24gdG8gZGF0YS1iaW5kIHRvLlxyXG4gKiBAcGFyYW0ge3N0cmluZz19IG5hbWUgUHJvcGVydHkgbmFtZSBvZiB0aGUgZm9ybSB1bmRlciB3aGljaCB0aGUgY29udHJvbCBpcyBwdWJsaXNoZWQuXHJcbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbj19IG5nLXRydWUtdmFsdWUgVGhlIHZhbHVlIHRvIHdoaWNoIHRoZSBleHByZXNzaW9uIHNob3VsZCBiZSBzZXQgd2hlbiBzZWxlY3RlZC5cclxuICogQHBhcmFtIHtleHByZXNzaW9uPX0gbmctZmFsc2UtdmFsdWUgVGhlIHZhbHVlIHRvIHdoaWNoIHRoZSBleHByZXNzaW9uIHNob3VsZCBiZSBzZXQgd2hlbiBub3Qgc2VsZWN0ZWQuXHJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gbmctY2hhbmdlIEFuZ3VsYXIgZXhwcmVzc2lvbiB0byBiZSBleGVjdXRlZCB3aGVuIGlucHV0IGNoYW5nZXMgZHVlIHRvIHVzZXIgaW50ZXJhY3Rpb24gd2l0aCB0aGUgaW5wdXQgZWxlbWVudC5cclxuICogQHBhcmFtIHtib29sZWFuPX0gbWQtbm8taW5rIFVzZSBvZiBhdHRyaWJ1dGUgaW5kaWNhdGVzIHVzZSBvZiByaXBwbGUgaW5rIGVmZmVjdHMuXHJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gYXJpYS1sYWJlbCBQdWJsaXNoIHRoZSBidXR0b24gbGFiZWwgdXNlZCBieSBzY3JlZW4tcmVhZGVycyBmb3IgYWNjZXNzaWJpbGl0eS4gRGVmYXVsdHMgdG8gdGhlIHN3aXRjaCdzIHRleHQuXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtc3dpdGNoIG5nLW1vZGVsPVwiaXNBY3RpdmVcIiBhcmlhLWxhYmVsPVwiRmluaXNoZWQ/XCI+XHJcbiAqICAgRmluaXNoZWQgP1xyXG4gKiA8L21kLXN3aXRjaD5cclxuICpcclxuICogPG1kLXN3aXRjaCBtZC1uby1pbmsgbmctbW9kZWw9XCJoYXNJbmtcIiBhcmlhLWxhYmVsPVwiTm8gSW5rIEVmZmVjdHNcIj5cclxuICogICBObyBJbmsgRWZmZWN0c1xyXG4gKiA8L21kLXN3aXRjaD5cclxuICpcclxuICogPG1kLXN3aXRjaCBuZy1kaXNhYmxlZD1cInRydWVcIiBuZy1tb2RlbD1cImlzRGlzYWJsZWRcIiBhcmlhLWxhYmVsPVwiRGlzYWJsZWRcIj5cclxuICogICBEaXNhYmxlZFxyXG4gKiA8L21kLXN3aXRjaD5cclxuICpcclxuICogPC9obGpzPlxyXG4gKi9cclxuZnVuY3Rpb24gTWRTd2l0Y2gobWRDaGVja2JveERpcmVjdGl2ZSwgJG1kVGhlbWluZywgJG1kVXRpbCwgJGRvY3VtZW50LCAkbWRDb25zdGFudCwgJHBhcnNlLCAkJHJBRiwgJG1kR2VzdHVyZSkge1xyXG4gIHZhciBjaGVja2JveERpcmVjdGl2ZSA9IG1kQ2hlY2tib3hEaXJlY3RpdmVbMF07XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgcHJpb3JpdHk6MjEwLCAvLyBSdW4gYmVmb3JlIG5nQXJpYVxyXG4gICAgdHJhbnNjbHVkZTogdHJ1ZSxcclxuICAgIHRlbXBsYXRlOlxyXG4gICAgICAnPGRpdiBjbGFzcz1cIm1kLWNvbnRhaW5lclwiPicgK1xyXG4gICAgICAgICc8ZGl2IGNsYXNzPVwibWQtYmFyXCI+PC9kaXY+JyArXHJcbiAgICAgICAgJzxkaXYgY2xhc3M9XCJtZC10aHVtYi1jb250YWluZXJcIj4nICtcclxuICAgICAgICAgICc8ZGl2IGNsYXNzPVwibWQtdGh1bWJcIiBtZC1pbmstcmlwcGxlIG1kLWluay1yaXBwbGUtY2hlY2tib3g+PC9kaXY+JyArXHJcbiAgICAgICAgJzwvZGl2PicrXHJcbiAgICAgICc8L2Rpdj4nICtcclxuICAgICAgJzxkaXYgbmctdHJhbnNjbHVkZSBjbGFzcz1cIm1kLWxhYmVsXCI+JyArXHJcbiAgICAgICc8L2Rpdj4nLFxyXG4gICAgcmVxdWlyZTogJz9uZ01vZGVsJyxcclxuICAgIGNvbXBpbGU6IGNvbXBpbGVcclxuICB9O1xyXG5cclxuICBmdW5jdGlvbiBjb21waWxlKGVsZW1lbnQsIGF0dHIpIHtcclxuICAgIHZhciBjaGVja2JveExpbmsgPSBjaGVja2JveERpcmVjdGl2ZS5jb21waWxlKGVsZW1lbnQsIGF0dHIpO1xyXG4gICAgLy8gbm8gdHJhbnNpdGlvbiBvbiBpbml0aWFsIGxvYWRcclxuICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ21kLWRyYWdnaW5nJyk7XHJcblxyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0ciwgbmdNb2RlbCkge1xyXG4gICAgICBuZ01vZGVsID0gbmdNb2RlbCB8fCAkbWRVdGlsLmZha2VOZ01vZGVsKCk7XHJcbiAgICAgIHZhciBkaXNhYmxlZEdldHRlciA9ICRwYXJzZShhdHRyLm5nRGlzYWJsZWQpO1xyXG4gICAgICB2YXIgdGh1bWJDb250YWluZXIgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCcubWQtdGh1bWItY29udGFpbmVyJykpO1xyXG4gICAgICB2YXIgc3dpdGNoQ29udGFpbmVyID0gYW5ndWxhci5lbGVtZW50KGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignLm1kLWNvbnRhaW5lcicpKTtcclxuXHJcbiAgICAgIC8vIG5vIHRyYW5zaXRpb24gb24gaW5pdGlhbCBsb2FkXHJcbiAgICAgICQkckFGKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21kLWRyYWdnaW5nJyk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY2hlY2tib3hMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBuZ01vZGVsKTtcclxuXHJcbiAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChhdHRyLm5nRGlzYWJsZWQpKSB7XHJcbiAgICAgICAgc2NvcGUuJHdhdGNoKGRpc2FibGVkR2V0dGVyLCBmdW5jdGlvbihpc0Rpc2FibGVkKSB7XHJcbiAgICAgICAgICBlbGVtZW50LmF0dHIoJ3RhYmluZGV4JywgaXNEaXNhYmxlZCA/IC0xIDogMCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFRoZXNlIGV2ZW50cyBhcmUgdHJpZ2dlcmVkIGJ5IHNldHVwIGRyYWdcclxuICAgICAgJG1kR2VzdHVyZS5yZWdpc3Rlcihzd2l0Y2hDb250YWluZXIsICdkcmFnJyk7XHJcbiAgICAgIHN3aXRjaENvbnRhaW5lclxyXG4gICAgICAgIC5vbignJG1kLmRyYWdzdGFydCcsIG9uRHJhZ1N0YXJ0KVxyXG4gICAgICAgIC5vbignJG1kLmRyYWcnLCBvbkRyYWcpXHJcbiAgICAgICAgLm9uKCckbWQuZHJhZ2VuZCcsIG9uRHJhZ0VuZCk7XHJcblxyXG4gICAgICB2YXIgZHJhZztcclxuICAgICAgZnVuY3Rpb24gb25EcmFnU3RhcnQoZXYpIHtcclxuICAgICAgICAvLyBEb24ndCBnbyBpZiBuZy1kaXNhYmxlZD09PXRydWVcclxuICAgICAgICBpZiAoZGlzYWJsZWRHZXR0ZXIoc2NvcGUpKSByZXR1cm47XHJcbiAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG4gICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ21kLWRyYWdnaW5nJyk7XHJcbiAgICAgICAgZHJhZyA9IHtcclxuICAgICAgICAgIHdpZHRoOiB0aHVtYkNvbnRhaW5lci5wcm9wKCdvZmZzZXRXaWR0aCcpXHJcbiAgICAgICAgfTtcclxuICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCd0cmFuc2l0aW9uJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIG9uRHJhZyhldikge1xyXG4gICAgICAgIGlmICghZHJhZykgcmV0dXJuO1xyXG4gICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIGV2LnNyY0V2ZW50ICYmIGV2LnNyY0V2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgIHZhciBwZXJjZW50ID0gZXYucG9pbnRlci5kaXN0YW5jZVggLyBkcmFnLndpZHRoO1xyXG5cclxuICAgICAgICAvL2lmIGNoZWNrZWQsIHN0YXJ0IGZyb20gcmlnaHQuIGVsc2UsIHN0YXJ0IGZyb20gbGVmdFxyXG4gICAgICAgIHZhciB0cmFuc2xhdGUgPSBuZ01vZGVsLiR2aWV3VmFsdWUgPyAgMSArIHBlcmNlbnQgOiBwZXJjZW50O1xyXG4gICAgICAgIC8vIE1ha2Ugc3VyZSB0aGUgc3dpdGNoIHN0YXlzIGluc2lkZSBpdHMgYm91bmRzLCAwLTElXHJcbiAgICAgICAgdHJhbnNsYXRlID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgdHJhbnNsYXRlKSk7XHJcblxyXG4gICAgICAgIHRodW1iQ29udGFpbmVyLmNzcygkbWRDb25zdGFudC5DU1MuVFJBTlNGT1JNLCAndHJhbnNsYXRlM2QoJyArICgxMDAqdHJhbnNsYXRlKSArICclLDAsMCknKTtcclxuICAgICAgICBkcmFnLnRyYW5zbGF0ZSA9IHRyYW5zbGF0ZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gb25EcmFnRW5kKGV2KSB7XHJcbiAgICAgICAgaWYgKCFkcmFnKSByZXR1cm47XHJcbiAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG4gICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21kLWRyYWdnaW5nJyk7XHJcbiAgICAgICAgdGh1bWJDb250YWluZXIuY3NzKCRtZENvbnN0YW50LkNTUy5UUkFOU0ZPUk0sICcnKTtcclxuXHJcbiAgICAgICAgLy8gV2UgY2hhbmdlZCBpZiB0aGVyZSBpcyBubyBkaXN0YW5jZSAodGhpcyBpcyBhIGNsaWNrIGEgY2xpY2spLFxyXG4gICAgICAgIC8vIG9yIGlmIHRoZSBkcmFnIGRpc3RhbmNlIGlzID41MCUgb2YgdGhlIHRvdGFsLlxyXG4gICAgICAgIHZhciBpc0NoYW5nZWQgPSBuZ01vZGVsLiR2aWV3VmFsdWUgPyBkcmFnLnRyYW5zbGF0ZSA8IDAuNSA6IGRyYWcudHJhbnNsYXRlID4gMC41O1xyXG4gICAgICAgIGlmIChpc0NoYW5nZWQpIHtcclxuICAgICAgICAgIGFwcGx5TW9kZWxWYWx1ZSghbmdNb2RlbC4kdmlld1ZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZHJhZyA9IG51bGw7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGFwcGx5TW9kZWxWYWx1ZShuZXdWYWx1ZSkge1xyXG4gICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgIG5nTW9kZWwuJHNldFZpZXdWYWx1ZShuZXdWYWx1ZSk7XHJcbiAgICAgICAgICBuZ01vZGVsLiRyZW5kZXIoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgIH07XHJcbiAgfVxyXG5cclxuXHJcbn1cclxuTWRTd2l0Y2guJGluamVjdCA9IFtcIm1kQ2hlY2tib3hEaXJlY3RpdmVcIiwgXCIkbWRUaGVtaW5nXCIsIFwiJG1kVXRpbFwiLCBcIiRkb2N1bWVudFwiLCBcIiRtZENvbnN0YW50XCIsIFwiJHBhcnNlXCIsIFwiJCRyQUZcIiwgXCIkbWRHZXN0dXJlXCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtb2R1bGVcclxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy50YWJzXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKlxyXG4gKiAgVGFicywgY3JlYXRlZCB3aXRoIHRoZSBgPG1kLXRhYnM+YCBkaXJlY3RpdmUgcHJvdmlkZSAqdGFiYmVkKiBuYXZpZ2F0aW9uIHdpdGggZGlmZmVyZW50IHN0eWxlcy5cclxuICogIFRoZSBUYWJzIGNvbXBvbmVudCBjb25zaXN0cyBvZiBjbGlja2FibGUgdGFicyB0aGF0IGFyZSBhbGlnbmVkIGhvcml6b250YWxseSBzaWRlLWJ5LXNpZGUuXHJcbiAqXHJcbiAqICBGZWF0dXJlcyBpbmNsdWRlIHN1cHBvcnQgZm9yOlxyXG4gKlxyXG4gKiAgLSBzdGF0aWMgb3IgZHluYW1pYyB0YWJzLFxyXG4gKiAgLSByZXNwb25zaXZlIGRlc2lnbnMsXHJcbiAqICAtIGFjY2Vzc2liaWxpdHkgc3VwcG9ydCAoQVJJQSksXHJcbiAqICAtIHRhYiBwYWdpbmF0aW9uLFxyXG4gKiAgLSBleHRlcm5hbCBvciBpbnRlcm5hbCB0YWIgY29udGVudCxcclxuICogIC0gZm9jdXMgaW5kaWNhdG9ycyBhbmQgYXJyb3cta2V5IG5hdmlnYXRpb25zLFxyXG4gKiAgLSBwcm9ncmFtbWF0aWMgbG9va3VwIGFuZCBhY2Nlc3MgdG8gdGFiIGNvbnRyb2xsZXJzLCBhbmRcclxuICogIC0gZHluYW1pYyB0cmFuc2l0aW9ucyB0aHJvdWdoIGRpZmZlcmVudCB0YWIgY29udGVudHMuXHJcbiAqXHJcbiAqL1xyXG4vKlxyXG4gKiBAc2VlIGpzIGZvbGRlciBmb3IgdGFicyBpbXBsZW1lbnRhdGlvblxyXG4gKi9cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMudGFicycsIFtcclxuICAnbWF0ZXJpYWwuY29yZScsXHJcbiAgJ21hdGVyaWFsLmNvbXBvbmVudHMuaWNvbidcclxuXSk7XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKipcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLnRvYXN0XHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBUb2FzdFxyXG4gKi9cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMudG9hc3QnLCBbXHJcbiAgJ21hdGVyaWFsLmNvcmUnLFxyXG4gICdtYXRlcmlhbC5jb21wb25lbnRzLmJ1dHRvbidcclxuXSlcclxuICAuZGlyZWN0aXZlKCdtZFRvYXN0JywgTWRUb2FzdERpcmVjdGl2ZSlcclxuICAucHJvdmlkZXIoJyRtZFRvYXN0JywgTWRUb2FzdFByb3ZpZGVyKTtcclxuXHJcbmZ1bmN0aW9uIE1kVG9hc3REaXJlY3RpdmUoKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRSdcclxuICB9O1xyXG59XHJcblxyXG4vKipcclxuICogQG5nZG9jIHNlcnZpY2VcclxuICogQG5hbWUgJG1kVG9hc3RcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnRvYXN0XHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBgJG1kVG9hc3RgIGlzIGEgc2VydmljZSB0byBidWlsZCBhIHRvYXN0IG5vdGlmaWNhdGlvbiBvbiBhbnkgcG9zaXRpb25cclxuICogb24gdGhlIHNjcmVlbiB3aXRoIGFuIG9wdGlvbmFsIGR1cmF0aW9uLCBhbmQgcHJvdmlkZXMgYSBzaW1wbGUgcHJvbWlzZSBBUEkuXHJcbiAqXHJcbiAqXHJcbiAqICMjIFJlc3RyaWN0aW9ucyBvbiBjdXN0b20gdG9hc3RzXHJcbiAqIC0gVGhlIHRvYXN0J3MgdGVtcGxhdGUgbXVzdCBoYXZlIGFuIG91dGVyIGA8bWQtdG9hc3Q+YCBlbGVtZW50LlxyXG4gKiAtIEZvciBhIHRvYXN0IGFjdGlvbiwgdXNlIGVsZW1lbnQgd2l0aCBjbGFzcyBgbWQtYWN0aW9uYC5cclxuICogLSBBZGQgdGhlIGNsYXNzIGBtZC1jYXBzdWxlYCBmb3IgY3VydmVkIGNvcm5lcnMuXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJNeUNvbnRyb2xsZXJcIj5cclxuICogICA8bWQtYnV0dG9uIG5nLWNsaWNrPVwib3BlblRvYXN0KClcIj5cclxuICogICAgIE9wZW4gYSBUb2FzdCFcclxuICogICA8L21kLWJ1dHRvbj5cclxuICogPC9kaXY+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICogPGhsanMgbGFuZz1cImpzXCI+XHJcbiAqIHZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJywgWyduZ01hdGVyaWFsJ10pO1xyXG4gKiBhcHAuY29udHJvbGxlcignTXlDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkbWRUb2FzdCkge1xyXG4gKiAgICRzY29wZS5vcGVuVG9hc3QgPSBmdW5jdGlvbigkZXZlbnQpIHtcclxuICogICAgICRtZFRvYXN0LnNob3coJG1kVG9hc3Quc2ltcGxlKCkuY29udGVudCgnSGVsbG8hJykpO1xyXG4gKiAgICAgLy8gQ291bGQgYWxzbyBkbyAkbWRUb2FzdC5zaG93U2ltcGxlKCdIZWxsbycpO1xyXG4gKiAgIH07XHJcbiAqIH0pO1xyXG4gKiA8L2hsanM+XHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtZXRob2RcclxuICogQG5hbWUgJG1kVG9hc3Qjc2hvd1NpbXBsZVxyXG4gKiBcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIENvbnZlbmllbmNlIG1ldGhvZCB3aGljaCBidWlsZHMgYW5kIHNob3dzIGEgc2ltcGxlIHRvYXN0LlxyXG4gKlxyXG4gKiBAcmV0dXJucyB7cHJvbWlzZX0gQSBwcm9taXNlIHRoYXQgY2FuIGJlIHJlc29sdmVkIHdpdGggYCRtZFRvYXN0LmhpZGUoKWAgb3JcclxuICogcmVqZWN0ZWQgd2l0aCBgJG1kVG9hc3QuY2FuY2VsKClgLlxyXG4gKlxyXG4gKi9cclxuXHJcbiAvKipcclxuICogQG5nZG9jIG1ldGhvZFxyXG4gKiBAbmFtZSAkbWRUb2FzdCNzaW1wbGVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIEJ1aWxkcyBhIHByZWNvbmZpZ3VyZWQgdG9hc3QuXHJcbiAqXHJcbiAqIEByZXR1cm5zIHtvYmp9IGEgYCRtZFRvYXN0UHJlc2V0YCB3aXRoIHRoZSBjaGFpbmFibGUgY29uZmlndXJhdGlvbiBtZXRob2RzOlxyXG4gKlxyXG4gKiAtICRtZFRvYXN0UHJlc2V0I2NvbnRlbnQoc3RyaW5nKSAtIHNldHMgdG9hc3QgY29udGVudCB0byBzdHJpbmdcclxuICogLSAkbWRUb2FzdFByZXNldCNhY3Rpb24oc3RyaW5nKSAtIGFkZHMgYW4gYWN0aW9uIGJ1dHRvbiwgd2hpY2ggcmVzb2x2ZXMgdGhlIHByb21pc2UgcmV0dXJuZWQgZnJvbSBgc2hvdygpYCBpZiBjbGlja2VkLlxyXG4gKiAtICRtZFRvYXN0UHJlc2V0I2hpZ2hsaWdodEFjdGlvbihib29sZWFuKSAtIHNldHMgYWN0aW9uIGJ1dHRvbiB0byBiZSBoaWdobGlnaHRlZFxyXG4gKiAtICRtZFRvYXN0UHJlc2V0I2NhcHN1bGUoYm9vbGVhbikgLSBhZGRzICdtZC1jYXBzdWxlJyBjbGFzcyB0byB0aGUgdG9hc3QgKGN1cnZlZCBjb3JuZXJzKVxyXG4gKiAtICRtZFRvYXN0UHJlc2V0I3RoZW1lKHN0cmluZykgLSBzZXRzIHRoZSB0aGVtZSBvbiB0aGUgdG9hc3QgdG8gdGhlbWUgKGRlZmF1bHQgaXMgYCRtZFRoZW1pbmdQcm92aWRlcmAncyBkZWZhdWx0IHRoZW1lKVxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbWV0aG9kXHJcbiAqIEBuYW1lICRtZFRvYXN0I3VwZGF0ZUNvbnRlbnRcclxuICogXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBVcGRhdGVzIHRoZSBjb250ZW50IG9mIGFuIGV4aXN0aW5nIHRvYXN0LiBVc2VmdWwgZm9yIHVwZGF0aW5nIHRoaW5ncyBsaWtlIGNvdW50cywgZXRjLlxyXG4gKlxyXG4gKi9cclxuXHJcbiAvKipcclxuICogQG5nZG9jIG1ldGhvZFxyXG4gKiBAbmFtZSAkbWRUb2FzdCNidWlsZFxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogQ3JlYXRlcyBhIGN1c3RvbSBgJG1kVG9hc3RQcmVzZXRgIHRoYXQgeW91IGNhbiBjb25maWd1cmUuXHJcbiAqXHJcbiAqIEByZXR1cm5zIHtvYmp9IGEgYCRtZFRvYXN0UHJlc2V0YCB3aXRoIHRoZSBjaGFpbmFibGUgY29uZmlndXJhdGlvbiBtZXRob2RzIGZvciBzaG93cycgb3B0aW9ucyAoc2VlIGJlbG93KS5cclxuICovXHJcblxyXG4gLyoqXHJcbiAqIEBuZ2RvYyBtZXRob2RcclxuICogQG5hbWUgJG1kVG9hc3Qjc2hvd1xyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb24gU2hvd3MgdGhlIHRvYXN0LlxyXG4gKlxyXG4gKiBAcGFyYW0ge29iamVjdH0gb3B0aW9uc09yUHJlc2V0IEVpdGhlciBwcm92aWRlIGFuIGAkbWRUb2FzdFByZXNldGAgcmV0dXJuZWQgZnJvbSBgc2ltcGxlKClgXHJcbiAqIGFuZCBgYnVpbGQoKWAsIG9yIGFuIG9wdGlvbnMgb2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOlxyXG4gKlxyXG4gKiAgIC0gYHRlbXBsYXRlVXJsYCAtIGB7c3RyaW5nPX1gOiBUaGUgdXJsIG9mIGFuIGh0bWwgdGVtcGxhdGUgZmlsZSB0aGF0IHdpbGxcclxuICogICAgIGJlIHVzZWQgYXMgdGhlIGNvbnRlbnQgb2YgdGhlIHRvYXN0LiBSZXN0cmljdGlvbnM6IHRoZSB0ZW1wbGF0ZSBtdXN0XHJcbiAqICAgICBoYXZlIGFuIG91dGVyIGBtZC10b2FzdGAgZWxlbWVudC5cclxuICogICAtIGB0ZW1wbGF0ZWAgLSBge3N0cmluZz19YDogU2FtZSBhcyB0ZW1wbGF0ZVVybCwgZXhjZXB0IHRoaXMgaXMgYW4gYWN0dWFsXHJcbiAqICAgICB0ZW1wbGF0ZSBzdHJpbmcuXHJcbiAqICAgLSBgc2NvcGVgIC0gYHtvYmplY3Q9fWA6IHRoZSBzY29wZSB0byBsaW5rIHRoZSB0ZW1wbGF0ZSAvIGNvbnRyb2xsZXIgdG8uIElmIG5vbmUgaXMgc3BlY2lmaWVkLCBpdCB3aWxsIGNyZWF0ZSBhIG5ldyBjaGlsZCBzY29wZS5cclxuICogICAgIFRoaXMgc2NvcGUgd2lsbCBiZSBkZXN0cm95ZWQgd2hlbiB0aGUgdG9hc3QgaXMgcmVtb3ZlZCB1bmxlc3MgYHByZXNlcnZlU2NvcGVgIGlzIHNldCB0byB0cnVlLlxyXG4gKiAgIC0gYHByZXNlcnZlU2NvcGVgIC0gYHtib29sZWFuPX1gOiB3aGV0aGVyIHRvIHByZXNlcnZlIHRoZSBzY29wZSB3aGVuIHRoZSBlbGVtZW50IGlzIHJlbW92ZWQuIERlZmF1bHQgaXMgZmFsc2VcclxuICogICAtIGBoaWRlRGVsYXlgIC0gYHtudW1iZXI9fWA6IEhvdyBtYW55IG1pbGxpc2Vjb25kcyB0aGUgdG9hc3Qgc2hvdWxkIHN0YXlcclxuICogICAgIGFjdGl2ZSBiZWZvcmUgYXV0b21hdGljYWxseSBjbG9zaW5nLiAgU2V0IHRvIDAgb3IgZmFsc2UgdG8gaGF2ZSB0aGUgdG9hc3Qgc3RheSBvcGVuIHVudGlsXHJcbiAqICAgICBjbG9zZWQgbWFudWFsbHkuIERlZmF1bHQ6IDMwMDAuXHJcbiAqICAgLSBgcG9zaXRpb25gIC0gYHtzdHJpbmc9fWA6IFdoZXJlIHRvIHBsYWNlIHRoZSB0b2FzdC4gQXZhaWxhYmxlOiBhbnkgY29tYmluYXRpb25cclxuICogICAgIG9mICdib3R0b20nLCAnbGVmdCcsICd0b3AnLCAncmlnaHQnLCAnZml0Jy4gRGVmYXVsdDogJ2JvdHRvbSBsZWZ0Jy5cclxuICogICAtIGBjb250cm9sbGVyYCAtIGB7c3RyaW5nPX1gOiBUaGUgY29udHJvbGxlciB0byBhc3NvY2lhdGUgd2l0aCB0aGlzIHRvYXN0LlxyXG4gKiAgICAgVGhlIGNvbnRyb2xsZXIgd2lsbCBiZSBpbmplY3RlZCB0aGUgbG9jYWwgYCRoaWRlVG9hc3RgLCB3aGljaCBpcyBhIGZ1bmN0aW9uXHJcbiAqICAgICB1c2VkIHRvIGhpZGUgdGhlIHRvYXN0LlxyXG4gKiAgIC0gYGxvY2Fsc2AgLSBge3N0cmluZz19YDogQW4gb2JqZWN0IGNvbnRhaW5pbmcga2V5L3ZhbHVlIHBhaXJzLiBUaGUga2V5cyB3aWxsXHJcbiAqICAgICBiZSB1c2VkIGFzIG5hbWVzIG9mIHZhbHVlcyB0byBpbmplY3QgaW50byB0aGUgY29udHJvbGxlci4gRm9yIGV4YW1wbGUsXHJcbiAqICAgICBgbG9jYWxzOiB7dGhyZWU6IDN9YCB3b3VsZCBpbmplY3QgYHRocmVlYCBpbnRvIHRoZSBjb250cm9sbGVyIHdpdGggdGhlIHZhbHVlXHJcbiAqICAgICBvZiAzLlxyXG4gKiAgIC0gYGJpbmRUb0NvbnRyb2xsZXJgIC0gYGJvb2xgOiBiaW5kIHRoZSBsb2NhbHMgdG8gdGhlIGNvbnRyb2xsZXIsIGluc3RlYWQgb2YgcGFzc2luZyB0aGVtIGluLiBUaGVzZSB2YWx1ZXMgd2lsbCBub3QgYmUgYXZhaWxhYmxlIHVudGlsIGFmdGVyIGluaXRpYWxpemF0aW9uLlxyXG4gKiAgIC0gYHJlc29sdmVgIC0gYHtvYmplY3Q9fWA6IFNpbWlsYXIgdG8gbG9jYWxzLCBleGNlcHQgaXQgdGFrZXMgcHJvbWlzZXMgYXMgdmFsdWVzXHJcbiAqICAgICBhbmQgdGhlIHRvYXN0IHdpbGwgbm90IG9wZW4gdW50aWwgdGhlIHByb21pc2VzIHJlc29sdmUuXHJcbiAqICAgLSBgY29udHJvbGxlckFzYCAtIGB7c3RyaW5nPX1gOiBBbiBhbGlhcyB0byBhc3NpZ24gdGhlIGNvbnRyb2xsZXIgdG8gb24gdGhlIHNjb3BlLlxyXG4gKiAgIC0gYHBhcmVudGAgLSBge2VsZW1lbnQ9fWA6IFRoZSBlbGVtZW50IHRvIGFwcGVuZCB0aGUgdG9hc3QgdG8uIERlZmF1bHRzIHRvIGFwcGVuZGluZ1xyXG4gKiAgICAgdG8gdGhlIHJvb3QgZWxlbWVudCBvZiB0aGUgYXBwbGljYXRpb24uXHJcbiAqXHJcbiAqIEByZXR1cm5zIHtwcm9taXNlfSBBIHByb21pc2UgdGhhdCBjYW4gYmUgcmVzb2x2ZWQgd2l0aCBgJG1kVG9hc3QuaGlkZSgpYCBvclxyXG4gKiByZWplY3RlZCB3aXRoIGAkbWRUb2FzdC5jYW5jZWwoKWAuXHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtZXRob2RcclxuICogQG5hbWUgJG1kVG9hc3QjaGlkZVxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogSGlkZSBhbiBleGlzdGluZyB0b2FzdCBhbmQgcmVzb2x2ZSB0aGUgcHJvbWlzZSByZXR1cm5lZCBmcm9tIGAkbWRUb2FzdC5zaG93KClgLlxyXG4gKlxyXG4gKiBAcGFyYW0geyo9fSByZXNwb25zZSBBbiBhcmd1bWVudCBmb3IgdGhlIHJlc29sdmVkIHByb21pc2UuXHJcbiAqXHJcbiAqIEByZXR1cm5zIHtwcm9taXNlfSBhIHByb21pc2UgdGhhdCBpcyBjYWxsZWQgd2hlbiB0aGUgZXhpc3RpbmcgZWxlbWVudCBpcyByZW1vdmVkIGZyb20gdGhlIERPTVxyXG4gKlxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbWV0aG9kXHJcbiAqIEBuYW1lICRtZFRvYXN0I2NhbmNlbFxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogSGlkZSB0aGUgZXhpc3RpbmcgdG9hc3QgYW5kIHJlamVjdCB0aGUgcHJvbWlzZSByZXR1cm5lZCBmcm9tXHJcbiAqIGAkbWRUb2FzdC5zaG93KClgLlxyXG4gKlxyXG4gKiBAcGFyYW0geyo9fSByZXNwb25zZSBBbiBhcmd1bWVudCBmb3IgdGhlIHJlamVjdGVkIHByb21pc2UuXHJcbiAqXHJcbiAqIEByZXR1cm5zIHtwcm9taXNlfSBhIHByb21pc2UgdGhhdCBpcyBjYWxsZWQgd2hlbiB0aGUgZXhpc3RpbmcgZWxlbWVudCBpcyByZW1vdmVkIGZyb20gdGhlIERPTVxyXG4gKlxyXG4gKi9cclxuXHJcbmZ1bmN0aW9uIE1kVG9hc3RQcm92aWRlcigkJGludGVyaW1FbGVtZW50UHJvdmlkZXIpIHtcclxuICB2YXIgYWN0aXZlVG9hc3RDb250ZW50O1xyXG4gIHZhciAkbWRUb2FzdCA9ICQkaW50ZXJpbUVsZW1lbnRQcm92aWRlcignJG1kVG9hc3QnKVxyXG4gICAgLnNldERlZmF1bHRzKHtcclxuICAgICAgbWV0aG9kczogWydwb3NpdGlvbicsICdoaWRlRGVsYXknLCAnY2Fwc3VsZScgXSxcclxuICAgICAgb3B0aW9uczogdG9hc3REZWZhdWx0T3B0aW9uc1xyXG4gICAgfSlcclxuICAgIC5hZGRQcmVzZXQoJ3NpbXBsZScsIHtcclxuICAgICAgYXJnT3B0aW9uOiAnY29udGVudCcsXHJcbiAgICAgIG1ldGhvZHM6IFsnY29udGVudCcsICdhY3Rpb24nLCAnaGlnaGxpZ2h0QWN0aW9uJywgJ3RoZW1lJywgJ3BhcmVudCddLFxyXG4gICAgICBvcHRpb25zOiAvKiBAbmdJbmplY3QgKi8gW1wiJG1kVG9hc3RcIiwgXCIkbWRUaGVtaW5nXCIsIGZ1bmN0aW9uKCRtZFRvYXN0LCAkbWRUaGVtaW5nKSB7XHJcbiAgICAgICAgdmFyIG9wdHMgPSB7XHJcbiAgICAgICAgICB0ZW1wbGF0ZTogW1xyXG4gICAgICAgICAgICAnPG1kLXRvYXN0IG1kLXRoZW1lPVwie3sgdG9hc3QudGhlbWUgfX1cIiBuZy1jbGFzcz1cIntcXCdtZC1jYXBzdWxlXFwnOiB0b2FzdC5jYXBzdWxlfVwiPicsXHJcbiAgICAgICAgICAgICAgJzxzcGFuIGZsZXg+e3sgdG9hc3QuY29udGVudCB9fTwvc3Bhbj4nLFxyXG4gICAgICAgICAgICAgICc8bWQtYnV0dG9uIGNsYXNzPVwibWQtYWN0aW9uXCIgbmctaWY9XCJ0b2FzdC5hY3Rpb25cIiBuZy1jbGljaz1cInRvYXN0LnJlc29sdmUoKVwiIG5nLWNsYXNzPVwie1xcJ21kLWhpZ2hsaWdodFxcJzogdG9hc3QuaGlnaGxpZ2h0QWN0aW9ufVwiPicsXHJcbiAgICAgICAgICAgICAgICAne3sgdG9hc3QuYWN0aW9uIH19JyxcclxuICAgICAgICAgICAgICAnPC9tZC1idXR0b24+JyxcclxuICAgICAgICAgICAgJzwvbWQtdG9hc3Q+J1xyXG4gICAgICAgICAgXS5qb2luKCcnKSxcclxuICAgICAgICAgIGNvbnRyb2xsZXI6IC8qIEBuZ0luamVjdCAqLyBbXCIkc2NvcGVcIiwgZnVuY3Rpb24gbWRUb2FzdEN0cmwoJHNjb3BlKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgJHNjb3BlLiR3YXRjaChmdW5jdGlvbigpIHsgcmV0dXJuIGFjdGl2ZVRvYXN0Q29udGVudDsgfSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgc2VsZi5jb250ZW50ID0gYWN0aXZlVG9hc3RDb250ZW50O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5yZXNvbHZlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgJG1kVG9hc3QuaGlkZSgpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgfV0sXHJcbiAgICAgICAgICB0aGVtZTogJG1kVGhlbWluZy5kZWZhdWx0VGhlbWUoKSxcclxuICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3RvYXN0JyxcclxuICAgICAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWVcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBvcHRzO1xyXG4gICAgICB9XVxyXG4gICAgfSlcclxuICAgIC5hZGRNZXRob2QoJ3VwZGF0ZUNvbnRlbnQnLCBmdW5jdGlvbihuZXdDb250ZW50KSB7XHJcbiAgICAgIGFjdGl2ZVRvYXN0Q29udGVudCA9IG5ld0NvbnRlbnQ7XHJcbiAgICB9KTtcclxuXHJcbiAgdG9hc3REZWZhdWx0T3B0aW9ucy4kaW5qZWN0ID0gW1wiJHRpbWVvdXRcIiwgXCIkYW5pbWF0ZVwiLCBcIiRtZFRvYXN0XCIsIFwiJG1kVXRpbFwiXTtcclxuICAgIHJldHVybiAkbWRUb2FzdDtcclxuXHJcbiAgLyogQG5nSW5qZWN0ICovXHJcbiAgZnVuY3Rpb24gdG9hc3REZWZhdWx0T3B0aW9ucygkdGltZW91dCwgJGFuaW1hdGUsICRtZFRvYXN0LCAkbWRVdGlsKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBvblNob3c6IG9uU2hvdyxcclxuICAgICAgb25SZW1vdmU6IG9uUmVtb3ZlLFxyXG4gICAgICBwb3NpdGlvbjogJ2JvdHRvbSBsZWZ0JyxcclxuICAgICAgdGhlbWFibGU6IHRydWUsXHJcbiAgICAgIGhpZGVEZWxheTogMzAwMFxyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiBvblNob3coc2NvcGUsIGVsZW1lbnQsIG9wdGlvbnMpIHtcclxuICAgICAgZWxlbWVudCA9ICRtZFV0aWwuZXh0cmFjdEVsZW1lbnRCeU5hbWUoZWxlbWVudCwgJ21kLXRvYXN0Jyk7XHJcblxyXG4gICAgICAvLyAndG9wIGxlZnQnIC0+ICdtZC10b3AgbWQtbGVmdCdcclxuICAgICAgYWN0aXZlVG9hc3RDb250ZW50ID0gb3B0aW9ucy5jb250ZW50O1xyXG4gICAgICBlbGVtZW50LmFkZENsYXNzKG9wdGlvbnMucG9zaXRpb24uc3BsaXQoJyAnKS5tYXAoZnVuY3Rpb24ocG9zKSB7XHJcbiAgICAgICAgcmV0dXJuICdtZC0nICsgcG9zO1xyXG4gICAgICB9KS5qb2luKCcgJykpO1xyXG4gICAgICBvcHRpb25zLnBhcmVudC5hZGRDbGFzcyh0b2FzdE9wZW5DbGFzcyhvcHRpb25zLnBvc2l0aW9uKSk7XHJcblxyXG4gICAgICBvcHRpb25zLm9uU3dpcGUgPSBmdW5jdGlvbihldiwgZ2VzdHVyZSkge1xyXG4gICAgICAgIC8vQWRkIHN3aXBlbGVmdC9zd2lwZXJpZ2h0IGNsYXNzIHRvIGVsZW1lbnQgc28gaXQgY2FuIGFuaW1hdGUgY29ycmVjdGx5XHJcbiAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnbWQtJyArIGV2LnR5cGUucmVwbGFjZSgnJG1kLicsJycpKTtcclxuICAgICAgICAkdGltZW91dCgkbWRUb2FzdC5jYW5jZWwpO1xyXG4gICAgICB9O1xyXG4gICAgICBlbGVtZW50Lm9uKCckbWQuc3dpcGVsZWZ0ICRtZC5zd2lwZXJpZ2h0Jywgb3B0aW9ucy5vblN3aXBlKTtcclxuICAgICAgcmV0dXJuICRhbmltYXRlLmVudGVyKGVsZW1lbnQsIG9wdGlvbnMucGFyZW50KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBvblJlbW92ZShzY29wZSwgZWxlbWVudCwgb3B0aW9ucykge1xyXG4gICAgICBlbGVtZW50Lm9mZignJG1kLnN3aXBlbGVmdCAkbWQuc3dpcGVyaWdodCcsIG9wdGlvbnMub25Td2lwZSk7XHJcbiAgICAgIG9wdGlvbnMucGFyZW50LnJlbW92ZUNsYXNzKHRvYXN0T3BlbkNsYXNzKG9wdGlvbnMucG9zaXRpb24pKTtcclxuICAgICAgcmV0dXJuICRhbmltYXRlLmxlYXZlKGVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHRvYXN0T3BlbkNsYXNzKHBvc2l0aW9uKSB7XHJcbiAgICAgIHJldHVybiAnbWQtdG9hc3Qtb3Blbi0nICtcclxuICAgICAgICAocG9zaXRpb24uaW5kZXhPZigndG9wJykgPiAtMSA/ICd0b3AnIDogJ2JvdHRvbScpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbn1cclxuTWRUb2FzdFByb3ZpZGVyLiRpbmplY3QgPSBbXCIkJGludGVyaW1FbGVtZW50UHJvdmlkZXJcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKipcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLnRvb2xiYXJcclxuICovXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnRvb2xiYXInLCBbXHJcbiAgJ21hdGVyaWFsLmNvcmUnLFxyXG4gICdtYXRlcmlhbC5jb21wb25lbnRzLmNvbnRlbnQnXHJcbl0pXHJcbiAgLmRpcmVjdGl2ZSgnbWRUb29sYmFyJywgbWRUb29sYmFyRGlyZWN0aXZlKTtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAqIEBuYW1lIG1kVG9vbGJhclxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMudG9vbGJhclxyXG4gKiBAcmVzdHJpY3QgRVxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogYG1kLXRvb2xiYXJgIGlzIHVzZWQgdG8gcGxhY2UgYSB0b29sYmFyIGluIHlvdXIgYXBwLlxyXG4gKlxyXG4gKiBUb29sYmFycyBhcmUgdXN1YWxseSB1c2VkIGFib3ZlIGEgY29udGVudCBhcmVhIHRvIGRpc3BsYXkgdGhlIHRpdGxlIG9mIHRoZVxyXG4gKiBjdXJyZW50IHBhZ2UsIGFuZCBzaG93IHJlbGV2YW50IGFjdGlvbiBidXR0b25zIGZvciB0aGF0IHBhZ2UuXHJcbiAqXHJcbiAqIFlvdSBjYW4gY2hhbmdlIHRoZSBoZWlnaHQgb2YgdGhlIHRvb2xiYXIgYnkgYWRkaW5nIGVpdGhlciB0aGVcclxuICogYG1kLW1lZGl1bS10YWxsYCBvciBgbWQtdGFsbGAgY2xhc3MgdG8gdGhlIHRvb2xiYXIuXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8ZGl2IGxheW91dD1cImNvbHVtblwiIGxheW91dC1maWxsPlxyXG4gKiAgIDxtZC10b29sYmFyPlxyXG4gKlxyXG4gKiAgICAgPGRpdiBjbGFzcz1cIm1kLXRvb2xiYXItdG9vbHNcIj5cclxuICogICAgICAgPHNwYW4+TXkgQXBwJ3MgVGl0bGU8L3NwYW4+XHJcbiAqXHJcbiAqICAgICAgIDwhLS0gZmlsbCB1cCB0aGUgc3BhY2UgYmV0d2VlbiBsZWZ0IGFuZCByaWdodCBhcmVhIC0tPlxyXG4gKiAgICAgICA8c3BhbiBmbGV4Pjwvc3Bhbj5cclxuICpcclxuICogICAgICAgPG1kLWJ1dHRvbj5cclxuICogICAgICAgICBSaWdodCBCYXIgQnV0dG9uXHJcbiAqICAgICAgIDwvbWQtYnV0dG9uPlxyXG4gKiAgICAgPC9kaXY+XHJcbiAqXHJcbiAqICAgPC9tZC10b29sYmFyPlxyXG4gKiAgIDxtZC1jb250ZW50PlxyXG4gKiAgICAgSGVsbG8hXHJcbiAqICAgPC9tZC1jb250ZW50PlxyXG4gKiA8L2Rpdj5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBtZC1zY3JvbGwtc2hyaW5rIFdoZXRoZXIgdGhlIGhlYWRlciBzaG91bGQgc2hyaW5rIGF3YXkgYXNcclxuICogdGhlIHVzZXIgc2Nyb2xscyBkb3duLCBhbmQgcmV2ZWFsIGl0c2VsZiBhcyB0aGUgdXNlciBzY3JvbGxzIHVwLlxyXG4gKiBOb3RlOiBmb3Igc2Nyb2xsU2hyaW5rIHRvIHdvcmssIHRoZSB0b29sYmFyIG11c3QgYmUgYSBzaWJsaW5nIG9mIGFcclxuICogYG1kLWNvbnRlbnRgIGVsZW1lbnQsIHBsYWNlZCBiZWZvcmUgaXQuIFNlZSB0aGUgc2Nyb2xsIHNocmluayBkZW1vLlxyXG4gKlxyXG4gKlxyXG4gKiBAcGFyYW0ge251bWJlcj19IG1kLXNocmluay1zcGVlZC1mYWN0b3IgSG93IG11Y2ggdG8gY2hhbmdlIHRoZSBzcGVlZCBvZiB0aGUgdG9vbGJhcidzXHJcbiAqIHNocmlua2luZyBieS4gRm9yIGV4YW1wbGUsIGlmIDAuMjUgaXMgZ2l2ZW4gdGhlbiB0aGUgdG9vbGJhciB3aWxsIHNocmlua1xyXG4gKiBhdCBvbmUgZm91cnRoIHRoZSByYXRlIGF0IHdoaWNoIHRoZSB1c2VyIHNjcm9sbHMgZG93bi4gRGVmYXVsdCAwLjUuXHJcbiAqL1xyXG5mdW5jdGlvbiBtZFRvb2xiYXJEaXJlY3RpdmUoJCRyQUYsICRtZENvbnN0YW50LCAkbWRVdGlsLCAkbWRUaGVtaW5nLCAkYW5pbWF0ZSwgJHRpbWVvdXQpIHtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICBjb250cm9sbGVyOiBhbmd1bGFyLm5vb3AsXHJcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cikge1xyXG4gICAgICAkbWRUaGVtaW5nKGVsZW1lbnQpO1xyXG5cclxuICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHIubWRTY3JvbGxTaHJpbmspKSB7XHJcbiAgICAgICAgc2V0dXBTY3JvbGxTaHJpbmsoKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gc2V0dXBTY3JvbGxTaHJpbmsoKSB7XHJcbiAgICAgICAgLy8gQ3VycmVudCBcInlcIiBwb3NpdGlvbiBvZiBzY3JvbGxcclxuICAgICAgICB2YXIgeSA9IDA7XHJcbiAgICAgICAgLy8gU3RvcmUgdGhlIGxhc3Qgc2Nyb2xsIHRvcCBwb3NpdGlvblxyXG4gICAgICAgIHZhciBwcmV2U2Nyb2xsVG9wID0gMDtcclxuXHJcbiAgICAgICAgdmFyIHNocmlua1NwZWVkRmFjdG9yID0gYXR0ci5tZFNocmlua1NwZWVkRmFjdG9yIHx8IDAuNTtcclxuXHJcbiAgICAgICAgdmFyIHRvb2xiYXJIZWlnaHQ7XHJcbiAgICAgICAgdmFyIGNvbnRlbnRFbGVtZW50O1xyXG5cclxuICAgICAgICB2YXIgZGVib3VuY2VkQ29udGVudFNjcm9sbCA9ICQkckFGLnRocm90dGxlKG9uQ29udGVudFNjcm9sbCk7XHJcbiAgICAgICAgdmFyIGRlYm91bmNlZFVwZGF0ZUhlaWdodCA9ICRtZFV0aWwuZGVib3VuY2UodXBkYXRlVG9vbGJhckhlaWdodCwgNSAqIDEwMDApO1xyXG5cclxuICAgICAgICAvLyBXYWl0IGZvciAkbWRDb250ZW50TG9hZGVkIGV2ZW50IGZyb20gbWRDb250ZW50IGRpcmVjdGl2ZS5cclxuICAgICAgICAvLyBJZiB0aGUgbWRDb250ZW50IGVsZW1lbnQgaXMgYSBzaWJsaW5nIG9mIG91ciB0b29sYmFyLCBob29rIGl0IHVwXHJcbiAgICAgICAgLy8gdG8gc2Nyb2xsIGV2ZW50cy5cclxuICAgICAgICBzY29wZS4kb24oJyRtZENvbnRlbnRMb2FkZWQnLCBvbk1kQ29udGVudExvYWQpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBvbk1kQ29udGVudExvYWQoJGV2ZW50LCBuZXdDb250ZW50RWwpIHtcclxuICAgICAgICAgIC8vIFRvb2xiYXIgYW5kIGNvbnRlbnQgbXVzdCBiZSBzaWJsaW5nc1xyXG4gICAgICAgICAgaWYgKGVsZW1lbnQucGFyZW50KClbMF0gPT09IG5ld0NvbnRlbnRFbC5wYXJlbnQoKVswXSkge1xyXG4gICAgICAgICAgICAvLyB1bmhvb2sgb2xkIGNvbnRlbnQgZXZlbnQgbGlzdGVuZXIgaWYgZXhpc3RzXHJcbiAgICAgICAgICAgIGlmIChjb250ZW50RWxlbWVudCkge1xyXG4gICAgICAgICAgICAgIGNvbnRlbnRFbGVtZW50Lm9mZignc2Nyb2xsJywgZGVib3VuY2VkQ29udGVudFNjcm9sbCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG5ld0NvbnRlbnRFbC5vbignc2Nyb2xsJywgZGVib3VuY2VkQ29udGVudFNjcm9sbCk7XHJcbiAgICAgICAgICAgIG5ld0NvbnRlbnRFbC5hdHRyKCdzY3JvbGwtc2hyaW5rJywgJ3RydWUnKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnRlbnRFbGVtZW50ID0gbmV3Q29udGVudEVsO1xyXG4gICAgICAgICAgICAkJHJBRih1cGRhdGVUb29sYmFySGVpZ2h0KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVRvb2xiYXJIZWlnaHQoKSB7XHJcbiAgICAgICAgICB0b29sYmFySGVpZ2h0ID0gZWxlbWVudC5wcm9wKCdvZmZzZXRIZWlnaHQnKTtcclxuICAgICAgICAgIC8vIEFkZCBhIG5lZ2F0aXZlIG1hcmdpbi10b3AgdGhlIHNpemUgb2YgdGhlIHRvb2xiYXIgdG8gdGhlIGNvbnRlbnQgZWwuXHJcbiAgICAgICAgICAvLyBUaGUgY29udGVudCB3aWxsIHN0YXJ0IHRyYW5zZm9ybWVkIGRvd24gdGhlIHRvb2xiYXJIZWlnaHQgYW1vdW50LFxyXG4gICAgICAgICAgLy8gc28gZXZlcnl0aGluZyBsb29rcyBub3JtYWwuXHJcbiAgICAgICAgICAvL1xyXG4gICAgICAgICAgLy8gQXMgdGhlIHVzZXIgc2Nyb2xscyBkb3duLCB0aGUgY29udGVudCB3aWxsIGJlIHRyYW5zZm9ybWVkIHVwIHNsb3dseVxyXG4gICAgICAgICAgLy8gdG8gcHV0IHRoZSBjb250ZW50IHVuZGVybmVhdGggd2hlcmUgdGhlIHRvb2xiYXIgd2FzLlxyXG4gICAgICAgICAgdmFyIG1hcmdpbiA9ICAoLXRvb2xiYXJIZWlnaHQgKiBzaHJpbmtTcGVlZEZhY3RvcikgKyAncHgnO1xyXG4gICAgICAgICAgY29udGVudEVsZW1lbnQuY3NzKCdtYXJnaW4tdG9wJywgbWFyZ2luKTtcclxuICAgICAgICAgIGNvbnRlbnRFbGVtZW50LmNzcygnbWFyZ2luLWJvdHRvbScsIG1hcmdpbik7XHJcblxyXG4gICAgICAgICAgb25Db250ZW50U2Nyb2xsKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBvbkNvbnRlbnRTY3JvbGwoZSkge1xyXG4gICAgICAgICAgdmFyIHNjcm9sbFRvcCA9IGUgPyBlLnRhcmdldC5zY3JvbGxUb3AgOiBwcmV2U2Nyb2xsVG9wO1xyXG5cclxuICAgICAgICAgIGRlYm91bmNlZFVwZGF0ZUhlaWdodCgpO1xyXG5cclxuICAgICAgICAgIHkgPSBNYXRoLm1pbihcclxuICAgICAgICAgICAgdG9vbGJhckhlaWdodCAvIHNocmlua1NwZWVkRmFjdG9yLFxyXG4gICAgICAgICAgICBNYXRoLm1heCgwLCB5ICsgc2Nyb2xsVG9wIC0gcHJldlNjcm9sbFRvcClcclxuICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgZWxlbWVudC5jc3MoXHJcbiAgICAgICAgICAgICRtZENvbnN0YW50LkNTUy5UUkFOU0ZPUk0sXHJcbiAgICAgICAgICAgICd0cmFuc2xhdGUzZCgwLCcgKyAoLXkgKiBzaHJpbmtTcGVlZEZhY3RvcikgKyAncHgsMCknXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgICAgY29udGVudEVsZW1lbnQuY3NzKFxyXG4gICAgICAgICAgICAkbWRDb25zdGFudC5DU1MuVFJBTlNGT1JNLFxyXG4gICAgICAgICAgICAndHJhbnNsYXRlM2QoMCwnICsgKCh0b29sYmFySGVpZ2h0IC0geSkgKiBzaHJpbmtTcGVlZEZhY3RvcikgKyAncHgsMCknXHJcbiAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgIHByZXZTY3JvbGxUb3AgPSBzY3JvbGxUb3A7XHJcblxyXG4gICAgICAgICAgICBpZiAoZWxlbWVudC5oYXNDbGFzcygnbWQtd2hpdGVmcmFtZS16MScpKSB7XHJcbiAgICAgICAgICAgICAgaWYgKCF5KSB7XHJcbiAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7ICRhbmltYXRlLnJlbW92ZUNsYXNzKGVsZW1lbnQsICdtZC13aGl0ZWZyYW1lLXoxJyk7IH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBpZiAoeSkge1xyXG4gICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkgeyAkYW5pbWF0ZS5hZGRDbGFzcyhlbGVtZW50LCAnbWQtd2hpdGVmcmFtZS16MScpOyB9KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG4gIH07XHJcblxyXG59XHJcbm1kVG9vbGJhckRpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJCRyQUZcIiwgXCIkbWRDb25zdGFudFwiLCBcIiRtZFV0aWxcIiwgXCIkbWRUaGVtaW5nXCIsIFwiJGFuaW1hdGVcIiwgXCIkdGltZW91dFwiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbW9kdWxlXHJcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMudG9vbHRpcFxyXG4gKi9cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy50b29sdGlwJywgWyAnbWF0ZXJpYWwuY29yZScgXSlcclxuICAgIC5kaXJlY3RpdmUoJ21kVG9vbHRpcCcsIE1kVG9vbHRpcERpcmVjdGl2ZSk7XHJcblxyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbmFtZSBtZFRvb2x0aXBcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnRvb2x0aXBcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIFRvb2x0aXBzIGFyZSB1c2VkIHRvIGRlc2NyaWJlIGVsZW1lbnRzIHRoYXQgYXJlIGludGVyYWN0aXZlIGFuZCBwcmltYXJpbHkgZ3JhcGhpY2FsIChub3QgdGV4dHVhbCkuXHJcbiAqXHJcbiAqIFBsYWNlIGEgYDxtZC10b29sdGlwPmAgYXMgYSBjaGlsZCBvZiB0aGUgZWxlbWVudCBpdCBkZXNjcmliZXMuXHJcbiAqXHJcbiAqIEEgdG9vbHRpcCB3aWxsIGFjdGl2YXRlIHdoZW4gdGhlIHVzZXIgZm9jdXNlcywgaG92ZXJzIG92ZXIsIG9yIHRvdWNoZXMgdGhlIHBhcmVudC5cclxuICpcclxuICogQHVzYWdlXHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqIDxtZC1idXR0b24gY2xhc3M9XCJtZC1mYWIgbWQtYWNjZW50XCIgYXJpYS1sYWJlbD1cIlBsYXlcIj5cclxuICogICA8bWQtdG9vbHRpcD5cclxuICogICAgIFBsYXkgTXVzaWNcclxuICogICA8L21kLXRvb2x0aXA+XHJcbiAqICAgPG1kLWljb24gaWNvbj1cImltZy9pY29ucy9pY19wbGF5X2Fycm93XzI0cHguc3ZnXCI+PC9tZC1pY29uPlxyXG4gKiA8L21kLWJ1dHRvbj5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiBAcGFyYW0ge2V4cHJlc3Npb249fSBtZC12aXNpYmxlIEJvb2xlYW4gYm91bmQgdG8gd2hldGhlciB0aGUgdG9vbHRpcCBpc1xyXG4gKiBjdXJyZW50bHkgdmlzaWJsZS5cclxuICogQHBhcmFtIHtudW1iZXI9fSBtZC1kZWxheSBIb3cgbWFueSBtaWxsaXNlY29uZHMgdG8gd2FpdCB0byBzaG93IHRoZSB0b29sdGlwIGFmdGVyIHRoZSB1c2VyIGZvY3VzZXMsIGhvdmVycywgb3IgdG91Y2hlcyB0aGUgcGFyZW50LiBEZWZhdWx0cyB0byA0MDBtcy5cclxuICogQHBhcmFtIHtzdHJpbmc9fSBtZC1kaXJlY3Rpb24gV2hpY2ggZGlyZWN0aW9uIHdvdWxkIHlvdSBsaWtlIHRoZSB0b29sdGlwIHRvIGdvPyAgU3VwcG9ydHMgbGVmdCwgcmlnaHQsIHRvcCwgYW5kIGJvdHRvbS4gIERlZmF1bHRzIHRvIGJvdHRvbS5cclxuICogQHBhcmFtIHtib29sZWFuPX0gbWQtYXV0b2hpZGUgSWYgcHJlc2VudCBvciBwcm92aWRlZCB3aXRoIGEgYm9vbGVhbiB2YWx1ZSwgdGhlIHRvb2x0aXAgd2lsbCBoaWRlIG9uIG1vdXNlIGxlYXZlLCByZWdhcmRsZXNzIG9mIGZvY3VzXHJcbiAqL1xyXG5mdW5jdGlvbiBNZFRvb2x0aXBEaXJlY3RpdmUoJHRpbWVvdXQsICR3aW5kb3csICQkckFGLCAkZG9jdW1lbnQsICRtZFV0aWwsICRtZFRoZW1pbmcsICRyb290RWxlbWVudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhbmltYXRlLCAkcSkge1xyXG5cclxuICB2YXIgVE9PTFRJUF9TSE9XX0RFTEFZID0gMzAwO1xyXG4gIHZhciBUT09MVElQX1dJTkRPV19FREdFX1NQQUNFID0gODtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICB0cmFuc2NsdWRlOiB0cnVlLFxyXG4gICAgcHJpb3JpdHk6MjEwLCAvLyBCZWZvcmUgbmdBcmlhXHJcbiAgICB0ZW1wbGF0ZTogJ1xcXHJcbiAgICAgICAgPGRpdiBjbGFzcz1cIm1kLWJhY2tncm91bmRcIj48L2Rpdj5cXFxyXG4gICAgICAgIDxkaXYgY2xhc3M9XCJtZC1jb250ZW50XCIgbmctdHJhbnNjbHVkZT48L2Rpdj4nLFxyXG4gICAgc2NvcGU6IHtcclxuICAgICAgdmlzaWJsZTogJz0/bWRWaXNpYmxlJyxcclxuICAgICAgZGVsYXk6ICc9P21kRGVsYXknLFxyXG4gICAgICBhdXRvaGlkZTogJz0/bWRBdXRvaGlkZSdcclxuICAgIH0sXHJcbiAgICBsaW5rOiBwb3N0TGlua1xyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XHJcblxyXG4gICAgJG1kVGhlbWluZyhlbGVtZW50KTtcclxuXHJcbiAgICB2YXIgcGFyZW50ICAgICAgICA9IGdldFBhcmVudFdpdGhQb2ludGVyRXZlbnRzKCksXHJcbiAgICAgICAgYmFja2dyb3VuZCAgICA9IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50WzBdLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ21kLWJhY2tncm91bmQnKVswXSksXHJcbiAgICAgICAgY29udGVudCAgICAgICA9IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50WzBdLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ21kLWNvbnRlbnQnKVswXSksXHJcbiAgICAgICAgZGlyZWN0aW9uICAgICA9IGF0dHIubWREaXJlY3Rpb24sXHJcbiAgICAgICAgY3VycmVudCAgICAgICA9IGdldE5lYXJlc3RDb250ZW50RWxlbWVudCgpLFxyXG4gICAgICAgIHRvb2x0aXBQYXJlbnQgPSBhbmd1bGFyLmVsZW1lbnQoY3VycmVudCB8fCBkb2N1bWVudC5ib2R5KSxcclxuICAgICAgICBkZWJvdW5jZWRPblJlc2l6ZSA9ICQkckFGLnRocm90dGxlKGZ1bmN0aW9uICgpIHsgaWYgKHNjb3BlLnZpc2libGUpIHBvc2l0aW9uVG9vbHRpcCgpOyB9KTtcclxuXHJcbiAgICByZXR1cm4gaW5pdCgpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGluaXQgKCkge1xyXG4gICAgICBzZXREZWZhdWx0cygpO1xyXG4gICAgICBtYW5pcHVsYXRlRWxlbWVudCgpO1xyXG4gICAgICBiaW5kRXZlbnRzKCk7XHJcbiAgICAgIGNvbmZpZ3VyZVdhdGNoZXJzKCk7XHJcbiAgICAgIGFkZEFyaWFMYWJlbCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNldERlZmF1bHRzICgpIHtcclxuICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChhdHRyLm1kRGVsYXkpKSBzY29wZS5kZWxheSA9IFRPT0xUSVBfU0hPV19ERUxBWTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjb25maWd1cmVXYXRjaGVycyAoKSB7XHJcbiAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBzY29wZS52aXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgZWxlbWVudC5yZW1vdmUoKTtcclxuICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdykub2ZmKCdyZXNpemUnLCBkZWJvdW5jZWRPblJlc2l6ZSk7XHJcbiAgICAgIH0pO1xyXG4gICAgICBzY29wZS4kd2F0Y2goJ3Zpc2libGUnLCBmdW5jdGlvbiAoaXNWaXNpYmxlKSB7XHJcbiAgICAgICAgaWYgKGlzVmlzaWJsZSkgc2hvd1Rvb2x0aXAoKTtcclxuICAgICAgICBlbHNlIGhpZGVUb29sdGlwKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGFkZEFyaWFMYWJlbCAoKSB7XHJcbiAgICAgIGlmICghcGFyZW50LmF0dHIoJ2FyaWEtbGFiZWwnKSAmJiAhcGFyZW50LnRleHQoKS50cmltKCkpIHtcclxuICAgICAgICBwYXJlbnQuYXR0cignYXJpYS1sYWJlbCcsIGVsZW1lbnQudGV4dCgpLnRyaW0oKSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBtYW5pcHVsYXRlRWxlbWVudCAoKSB7XHJcbiAgICAgIGVsZW1lbnQuZGV0YWNoKCk7XHJcbiAgICAgIGVsZW1lbnQuYXR0cigncm9sZScsICd0b29sdGlwJyk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0UGFyZW50V2l0aFBvaW50ZXJFdmVudHMgKCkge1xyXG4gICAgICB2YXIgcGFyZW50ID0gZWxlbWVudC5wYXJlbnQoKTtcclxuICAgICAgd2hpbGUgKHBhcmVudCAmJiAkd2luZG93LmdldENvbXB1dGVkU3R5bGUocGFyZW50WzBdKVsncG9pbnRlci1ldmVudHMnXSA9PSAnbm9uZScpIHtcclxuICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50KCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHBhcmVudDtcclxuICAgIH1cclxuXHJcbiAgICAgZnVuY3Rpb24gZ2V0TmVhcmVzdENvbnRlbnRFbGVtZW50ICgpIHtcclxuICAgICAgIHZhciBjdXJyZW50ID0gZWxlbWVudC5wYXJlbnQoKVswXTtcclxuICAgICAgIC8vIExvb2sgZm9yIHRoZSBuZWFyZXN0IHBhcmVudCBtZC1jb250ZW50LCBzdG9wcGluZyBhdCB0aGUgcm9vdEVsZW1lbnQuXHJcbiAgICAgICB3aGlsZSAoY3VycmVudCAmJiBjdXJyZW50ICE9PSAkcm9vdEVsZW1lbnRbMF0gJiYgY3VycmVudCAhPT0gZG9jdW1lbnQuYm9keSkge1xyXG4gICAgICAgICBjdXJyZW50ID0gY3VycmVudC5wYXJlbnROb2RlO1xyXG4gICAgICAgfVxyXG4gICAgICAgcmV0dXJuIGN1cnJlbnQ7XHJcbiAgICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGhhc0NvbXB1dGVkU3R5bGVWYWx1ZShrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgd2Ugc2hvdWxkIHNob3cgaXQgb3Igbm90Li4uXHJcbiAgICAgICAgdmFyIGNvbXB1dGVkU3R5bGVzID0gJHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsZW1lbnRbMF0pO1xyXG4gICAgICAgIHJldHVybiBhbmd1bGFyLmlzRGVmaW5lZChjb21wdXRlZFN0eWxlc1trZXldKSAmJiAoY29tcHV0ZWRTdHlsZXNba2V5XSA9PSB2YWx1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gYmluZEV2ZW50cyAoKSB7XHJcbiAgICAgIHZhciBtb3VzZUFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICB2YXIgZW50ZXJIYW5kbGVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKCFoYXNDb21wdXRlZFN0eWxlVmFsdWUoJ3BvaW50ZXItZXZlbnRzJywnbm9uZScpKSB7XHJcbiAgICAgICAgICBzZXRWaXNpYmxlKHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgICAgdmFyIGxlYXZlSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgYXV0b2hpZGUgPSBzY29wZS5oYXNPd25Qcm9wZXJ0eSgnYXV0b2hpZGUnKSA/IHNjb3BlLmF1dG9oaWRlIDogYXR0ci5oYXNPd25Qcm9wZXJ0eSgnbWRBdXRvaGlkZScpO1xyXG4gICAgICAgIGlmIChhdXRvaGlkZSB8fCBtb3VzZUFjdGl2ZSB8fCAoJGRvY3VtZW50WzBdLmFjdGl2ZUVsZW1lbnQgIT09IHBhcmVudFswXSkgKSB7XHJcbiAgICAgICAgICBzZXRWaXNpYmxlKGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbW91c2VBY3RpdmUgPSBmYWxzZTtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIHRvIGF2b2lkIGBzeW50aGV0aWMgY2xpY2tzYCB3ZSBsaXN0ZW4gdG8gbW91c2Vkb3duIGluc3RlYWQgb2YgYGNsaWNrYFxyXG4gICAgICBwYXJlbnQub24oJ21vdXNlZG93bicsIGZ1bmN0aW9uKCkgeyBtb3VzZUFjdGl2ZSA9IHRydWU7IH0pO1xyXG4gICAgICBwYXJlbnQub24oJ2ZvY3VzIG1vdXNlZW50ZXIgdG91Y2hzdGFydCcsIGVudGVySGFuZGxlciApO1xyXG4gICAgICBwYXJlbnQub24oJ2JsdXIgbW91c2VsZWF2ZSB0b3VjaGVuZCB0b3VjaGNhbmNlbCcsIGxlYXZlSGFuZGxlciApO1xyXG5cclxuXHJcbiAgICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vbigncmVzaXplJywgZGVib3VuY2VkT25SZXNpemUpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNldFZpc2libGUgKHZhbHVlKSB7XHJcbiAgICAgIHNldFZpc2libGUudmFsdWUgPSAhIXZhbHVlO1xyXG4gICAgICBpZiAoIXNldFZpc2libGUucXVldWVkKSB7XHJcbiAgICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICBzZXRWaXNpYmxlLnF1ZXVlZCA9IHRydWU7XHJcbiAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgc2NvcGUudmlzaWJsZSA9IHNldFZpc2libGUudmFsdWU7XHJcbiAgICAgICAgICAgIHNldFZpc2libGUucXVldWVkID0gZmFsc2U7XHJcbiAgICAgICAgICB9LCBzY29wZS5kZWxheSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkgeyBzY29wZS52aXNpYmxlID0gZmFsc2U7IH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNob3dUb29sdGlwKCkge1xyXG4gICAgICAvLyBJbnNlcnQgdGhlIGVsZW1lbnQgYmVmb3JlIHBvc2l0aW9uaW5nIGl0LCBzbyB3ZSBjYW4gZ2V0IHRoZSBwb3NpdGlvblxyXG4gICAgICAvLyBhbmQgY2hlY2sgaWYgd2Ugc2hvdWxkIGRpc3BsYXkgaXRcclxuICAgICAgdG9vbHRpcFBhcmVudC5hcHBlbmQoZWxlbWVudCk7XHJcblxyXG4gICAgICAvLyBDaGVjayBpZiB3ZSBzaG91bGQgZGlzcGxheSBpdCBvciBub3QuXHJcbiAgICAgIC8vIFRoaXMgaGFuZGxlcyBoaWRlLSogYW5kIHNob3ctKiBhbG9uZyB3aXRoIGFueSB1c2VyIGRlZmluZWQgY3NzXHJcbiAgICAgIGlmICggaGFzQ29tcHV0ZWRTdHlsZVZhbHVlKCdkaXNwbGF5Jywnbm9uZScpICkge1xyXG4gICAgICAgIHNjb3BlLnZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICBlbGVtZW50LmRldGFjaCgpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgcG9zaXRpb25Ub29sdGlwKCk7XHJcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChbZWxlbWVudCwgYmFja2dyb3VuZCwgY29udGVudF0sIGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgJGFuaW1hdGUuYWRkQ2xhc3MoZWxlbWVudCwgJ21kLXNob3cnKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaGlkZVRvb2x0aXAoKSB7XHJcbiAgICAgICRxLmFsbChbXHJcbiAgICAgICAgJGFuaW1hdGUucmVtb3ZlQ2xhc3MoY29udGVudCwgJ21kLXNob3cnKSxcclxuICAgICAgICAkYW5pbWF0ZS5yZW1vdmVDbGFzcyhiYWNrZ3JvdW5kLCAnbWQtc2hvdycpLFxyXG4gICAgICAgICRhbmltYXRlLnJlbW92ZUNsYXNzKGVsZW1lbnQsICdtZC1zaG93JylcclxuICAgICAgXSkudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCFzY29wZS52aXNpYmxlKSBlbGVtZW50LmRldGFjaCgpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBwb3NpdGlvblRvb2x0aXAoKSB7XHJcbiAgICAgIHZhciB0aXBSZWN0ID0gJG1kVXRpbC5vZmZzZXRSZWN0KGVsZW1lbnQsIHRvb2x0aXBQYXJlbnQpO1xyXG4gICAgICB2YXIgcGFyZW50UmVjdCA9ICRtZFV0aWwub2Zmc2V0UmVjdChwYXJlbnQsIHRvb2x0aXBQYXJlbnQpO1xyXG4gICAgICB2YXIgbmV3UG9zaXRpb24gPSBnZXRQb3NpdGlvbihkaXJlY3Rpb24pO1xyXG5cclxuICAgICAgLy8gSWYgdGhlIHVzZXIgcHJvdmlkZWQgYSBkaXJlY3Rpb24sIGp1c3QgbnVkZ2UgdGhlIHRvb2x0aXAgb250byB0aGUgc2NyZWVuXHJcbiAgICAgIC8vIE90aGVyd2lzZSwgcmVjYWxjdWxhdGUgYmFzZWQgb24gJ3RvcCcgc2luY2UgZGVmYXVsdCBpcyAnYm90dG9tJ1xyXG4gICAgICBpZiAoZGlyZWN0aW9uKSB7XHJcbiAgICAgICAgbmV3UG9zaXRpb24gPSBmaXRJblBhcmVudChuZXdQb3NpdGlvbik7XHJcbiAgICAgIH0gZWxzZSBpZiAobmV3UG9zaXRpb24udG9wID4gZWxlbWVudC5wcm9wKCdvZmZzZXRQYXJlbnQnKS5zY3JvbGxIZWlnaHQgLSB0aXBSZWN0LmhlaWdodCAtIFRPT0xUSVBfV0lORE9XX0VER0VfU1BBQ0UpIHtcclxuICAgICAgICBuZXdQb3NpdGlvbiA9IGZpdEluUGFyZW50KGdldFBvc2l0aW9uKCd0b3AnKSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGVsZW1lbnQuY3NzKHt0b3A6IG5ld1Bvc2l0aW9uLnRvcCArICdweCcsIGxlZnQ6IG5ld1Bvc2l0aW9uLmxlZnQgKyAncHgnfSk7XHJcblxyXG4gICAgICBwb3NpdGlvbkJhY2tncm91bmQoKTtcclxuXHJcbiAgICAgIGZ1bmN0aW9uIHBvc2l0aW9uQmFja2dyb3VuZCAoKSB7XHJcbiAgICAgICAgdmFyIHNpemUgPSBkaXJlY3Rpb24gPT09ICdsZWZ0JyB8fCBkaXJlY3Rpb24gPT09ICdyaWdodCdcclxuICAgICAgICAgICAgICA/IE1hdGguc3FydChNYXRoLnBvdyh0aXBSZWN0LndpZHRoLCAyKSArIE1hdGgucG93KHRpcFJlY3QuaGVpZ2h0IC8gMiwgMikpICogMlxyXG4gICAgICAgICAgICAgIDogTWF0aC5zcXJ0KE1hdGgucG93KHRpcFJlY3Qud2lkdGggLyAyLCAyKSArIE1hdGgucG93KHRpcFJlY3QuaGVpZ2h0LCAyKSkgKiAyLFxyXG4gICAgICAgICAgICBwb3NpdGlvbiA9IGRpcmVjdGlvbiA9PT0gJ2xlZnQnID8geyBsZWZ0OiAxMDAsIHRvcDogNTAgfVxyXG4gICAgICAgICAgICAgIDogZGlyZWN0aW9uID09PSAncmlnaHQnID8geyBsZWZ0OiAwLCB0b3A6IDUwIH1cclxuICAgICAgICAgICAgICA6IGRpcmVjdGlvbiA9PT0gJ3RvcCcgPyB7IGxlZnQ6IDUwLCB0b3A6IDEwMCB9XHJcbiAgICAgICAgICAgICAgOiB7IGxlZnQ6IDUwLCB0b3A6IDAgfTtcclxuICAgICAgICBiYWNrZ3JvdW5kLmNzcyh7XHJcbiAgICAgICAgICB3aWR0aDogc2l6ZSArICdweCcsXHJcbiAgICAgICAgICBoZWlnaHQ6IHNpemUgKyAncHgnLFxyXG4gICAgICAgICAgbGVmdDogcG9zaXRpb24ubGVmdCArICclJyxcclxuICAgICAgICAgIHRvcDogcG9zaXRpb24udG9wICsgJyUnXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGZpdEluUGFyZW50IChwb3MpIHtcclxuICAgICAgICB2YXIgbmV3UG9zaXRpb24gPSB7IGxlZnQ6IHBvcy5sZWZ0LCB0b3A6IHBvcy50b3AgfTtcclxuICAgICAgICBuZXdQb3NpdGlvbi5sZWZ0ID0gTWF0aC5taW4oIG5ld1Bvc2l0aW9uLmxlZnQsIHRvb2x0aXBQYXJlbnQucHJvcCgnc2Nyb2xsV2lkdGgnKSAtIHRpcFJlY3Qud2lkdGggLSBUT09MVElQX1dJTkRPV19FREdFX1NQQUNFICk7XHJcbiAgICAgICAgbmV3UG9zaXRpb24ubGVmdCA9IE1hdGgubWF4KCBuZXdQb3NpdGlvbi5sZWZ0LCBUT09MVElQX1dJTkRPV19FREdFX1NQQUNFICk7XHJcbiAgICAgICAgbmV3UG9zaXRpb24udG9wICA9IE1hdGgubWluKCBuZXdQb3NpdGlvbi50b3AsICB0b29sdGlwUGFyZW50LnByb3AoJ3Njcm9sbEhlaWdodCcpIC0gdGlwUmVjdC5oZWlnaHQgLSBUT09MVElQX1dJTkRPV19FREdFX1NQQUNFICk7XHJcbiAgICAgICAgbmV3UG9zaXRpb24udG9wICA9IE1hdGgubWF4KCBuZXdQb3NpdGlvbi50b3AsICBUT09MVElQX1dJTkRPV19FREdFX1NQQUNFICk7XHJcbiAgICAgICAgcmV0dXJuIG5ld1Bvc2l0aW9uO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBnZXRQb3NpdGlvbiAoZGlyKSB7XHJcbiAgICAgICAgcmV0dXJuIGRpciA9PT0gJ2xlZnQnXHJcbiAgICAgICAgICA/IHsgbGVmdDogcGFyZW50UmVjdC5sZWZ0IC0gdGlwUmVjdC53aWR0aCAtIFRPT0xUSVBfV0lORE9XX0VER0VfU1BBQ0UsXHJcbiAgICAgICAgICAgICAgdG9wOiBwYXJlbnRSZWN0LnRvcCArIHBhcmVudFJlY3QuaGVpZ2h0IC8gMiAtIHRpcFJlY3QuaGVpZ2h0IC8gMiB9XHJcbiAgICAgICAgICA6IGRpciA9PT0gJ3JpZ2h0J1xyXG4gICAgICAgICAgPyB7IGxlZnQ6IHBhcmVudFJlY3QubGVmdCArIHBhcmVudFJlY3Qud2lkdGggKyBUT09MVElQX1dJTkRPV19FREdFX1NQQUNFLFxyXG4gICAgICAgICAgICAgIHRvcDogcGFyZW50UmVjdC50b3AgKyBwYXJlbnRSZWN0LmhlaWdodCAvIDIgLSB0aXBSZWN0LmhlaWdodCAvIDIgfVxyXG4gICAgICAgICAgOiBkaXIgPT09ICd0b3AnXHJcbiAgICAgICAgICA/IHsgbGVmdDogcGFyZW50UmVjdC5sZWZ0ICsgcGFyZW50UmVjdC53aWR0aCAvIDIgLSB0aXBSZWN0LndpZHRoIC8gMixcclxuICAgICAgICAgICAgICB0b3A6IHBhcmVudFJlY3QudG9wIC0gdGlwUmVjdC5oZWlnaHQgLSBUT09MVElQX1dJTkRPV19FREdFX1NQQUNFIH1cclxuICAgICAgICAgIDogeyBsZWZ0OiBwYXJlbnRSZWN0LmxlZnQgKyBwYXJlbnRSZWN0LndpZHRoIC8gMiAtIHRpcFJlY3Qud2lkdGggLyAyLFxyXG4gICAgICAgICAgICAgIHRvcDogcGFyZW50UmVjdC50b3AgKyBwYXJlbnRSZWN0LmhlaWdodCArIFRPT0xUSVBfV0lORE9XX0VER0VfU1BBQ0UgfTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG59XHJcbk1kVG9vbHRpcERpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJHRpbWVvdXRcIiwgXCIkd2luZG93XCIsIFwiJCRyQUZcIiwgXCIkZG9jdW1lbnRcIiwgXCIkbWRVdGlsXCIsIFwiJG1kVGhlbWluZ1wiLCBcIiRyb290RWxlbWVudFwiLCBcIiRhbmltYXRlXCIsIFwiJHFcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKipcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLndoaXRlZnJhbWVcclxuICovXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLndoaXRlZnJhbWUnLCBbXSk7XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmF1dG9jb21wbGV0ZScpXHJcbiAgICAuY29udHJvbGxlcignTWRBdXRvY29tcGxldGVDdHJsJywgTWRBdXRvY29tcGxldGVDdHJsKTtcclxuXHJcbnZhciBJVEVNX0hFSUdIVCA9IDQxLFxyXG4gICAgTUFYX0hFSUdIVCA9IDUuNSAqIElURU1fSEVJR0hULFxyXG4gICAgTUVOVV9QQURESU5HID0gODtcclxuXHJcbmZ1bmN0aW9uIE1kQXV0b2NvbXBsZXRlQ3RybCAoJHNjb3BlLCAkZWxlbWVudCwgJG1kVXRpbCwgJG1kQ29uc3RhbnQsICR0aW1lb3V0LCAkbWRUaGVtaW5nLCAkd2luZG93LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhbmltYXRlLCAkcm9vdEVsZW1lbnQsICRhdHRycykge1xyXG4gIC8vLS0gcHJpdmF0ZSB2YXJpYWJsZXNcclxuICB2YXIgY3RybCAgICAgID0gdGhpcyxcclxuICAgICAgaXRlbVBhcnRzID0gJHNjb3BlLml0ZW1zRXhwci5zcGxpdCgvIGluIC9pKSxcclxuICAgICAgaXRlbUV4cHIgID0gaXRlbVBhcnRzWzFdLFxyXG4gICAgICBlbGVtZW50cyAgPSBudWxsLFxyXG4gICAgICBwcm9taXNlICAgPSBudWxsLFxyXG4gICAgICBjYWNoZSAgICAgPSB7fSxcclxuICAgICAgbm9CbHVyICAgID0gZmFsc2UsXHJcbiAgICAgIHNlbGVjdGVkSXRlbVdhdGNoZXJzID0gW10sXHJcbiAgICAgIGhhc0ZvY3VzICA9IGZhbHNlLFxyXG4gICAgICBsYXN0Q291bnQgPSAwO1xyXG5cclxuICAvLy0tIHB1YmxpYyB2YXJpYWJsZXMgd2l0aCBoYW5kbGVyc1xyXG4gIGRlZmluZVByb3BlcnR5KCdoaWRkZW4nLCBoYW5kbGVIaWRkZW5DaGFuZ2UsIHRydWUpO1xyXG5cclxuICAvLy0tIHB1YmxpYyB2YXJpYWJsZXNcclxuICBjdHJsLnNjb3BlICAgICAgPSAkc2NvcGU7XHJcbiAgY3RybC5wYXJlbnQgICAgID0gJHNjb3BlLiRwYXJlbnQ7XHJcbiAgY3RybC5pdGVtTmFtZSAgID0gaXRlbVBhcnRzWzBdO1xyXG4gIGN0cmwubWF0Y2hlcyAgICA9IFtdO1xyXG4gIGN0cmwubG9hZGluZyAgICA9IGZhbHNlO1xyXG4gIGN0cmwuaGlkZGVuICAgICA9IHRydWU7XHJcbiAgY3RybC5pbmRleCAgICAgID0gbnVsbDtcclxuICBjdHJsLm1lc3NhZ2VzICAgPSBbXTtcclxuICBjdHJsLmlkICAgICAgICAgPSAkbWRVdGlsLm5leHRVaWQoKTtcclxuICBjdHJsLmlzRGlzYWJsZWQgPSBudWxsO1xyXG4gIGN0cmwuaXNSZXF1aXJlZCA9IG51bGw7XHJcblxyXG4gIC8vLS0gcHVibGljIG1ldGhvZHNcclxuICBjdHJsLmtleWRvd24gICAgPSBrZXlkb3duO1xyXG4gIGN0cmwuYmx1ciAgICAgICA9IGJsdXI7XHJcbiAgY3RybC5mb2N1cyAgICAgID0gZm9jdXM7XHJcbiAgY3RybC5jbGVhciAgICAgID0gY2xlYXJWYWx1ZTtcclxuICBjdHJsLnNlbGVjdCAgICAgPSBzZWxlY3Q7XHJcbiAgY3RybC5saXN0RW50ZXIgID0gb25MaXN0RW50ZXI7XHJcbiAgY3RybC5saXN0TGVhdmUgID0gb25MaXN0TGVhdmU7XHJcbiAgY3RybC5tb3VzZVVwICAgID0gb25Nb3VzZXVwO1xyXG4gIGN0cmwuZ2V0Q3VycmVudERpc3BsYXlWYWx1ZSAgICAgICAgID0gZ2V0Q3VycmVudERpc3BsYXlWYWx1ZTtcclxuICBjdHJsLnJlZ2lzdGVyU2VsZWN0ZWRJdGVtV2F0Y2hlciAgICA9IHJlZ2lzdGVyU2VsZWN0ZWRJdGVtV2F0Y2hlcjtcclxuICBjdHJsLnVucmVnaXN0ZXJTZWxlY3RlZEl0ZW1XYXRjaGVyICA9IHVucmVnaXN0ZXJTZWxlY3RlZEl0ZW1XYXRjaGVyO1xyXG5cclxuICByZXR1cm4gaW5pdCgpO1xyXG5cclxuICAvLy0tIGluaXRpYWxpemF0aW9uIG1ldGhvZHNcclxuXHJcbiAgLyoqXHJcbiAgICogSW5pdGlhbGl6ZSB0aGUgY29udHJvbGxlciwgc2V0dXAgd2F0Y2hlcnMsIGdhdGhlciBlbGVtZW50c1xyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGluaXQgKCkge1xyXG4gICAgJG1kVXRpbC5pbml0T3B0aW9uYWxQcm9wZXJ0aWVzKCRzY29wZSwgJGF0dHJzLCB7IHNlYXJjaFRleHQ6IG51bGwsIHNlbGVjdGVkSXRlbTogbnVsbCB9ICk7XHJcbiAgICAkbWRUaGVtaW5nKCRlbGVtZW50KTtcclxuICAgIGNvbmZpZ3VyZVdhdGNoZXJzKCk7XHJcbiAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGdhdGhlckVsZW1lbnRzKCk7XHJcbiAgICAgIGZvY3VzRWxlbWVudCgpO1xyXG4gICAgICBtb3ZlRHJvcGRvd24oKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2FsY3VsYXRlcyB0aGUgZHJvcGRvd24ncyBwb3NpdGlvbiBhbmQgYXBwbGllcyB0aGUgbmV3IHN0eWxlcyB0byB0aGUgbWVudSBlbGVtZW50XHJcbiAgICogQHJldHVybnMgeyp9XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gcG9zaXRpb25Ecm9wZG93biAoKSB7XHJcbiAgICBpZiAoIWVsZW1lbnRzKSByZXR1cm4gJHRpbWVvdXQocG9zaXRpb25Ecm9wZG93biwgMCwgZmFsc2UpO1xyXG4gICAgdmFyIGhyZWN0ICA9IGVsZW1lbnRzLndyYXAuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXHJcbiAgICAgICAgdnJlY3QgID0gZWxlbWVudHMuc25hcC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcclxuICAgICAgICByb290ICAgPSBlbGVtZW50cy5yb290LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxyXG4gICAgICAgIHRvcCAgICA9IHZyZWN0LmJvdHRvbSAtIHJvb3QudG9wLFxyXG4gICAgICAgIGJvdCAgICA9IHJvb3QuYm90dG9tIC0gdnJlY3QudG9wLFxyXG4gICAgICAgIGxlZnQgICA9IGhyZWN0LmxlZnQgLSByb290LmxlZnQsXHJcbiAgICAgICAgd2lkdGggID0gaHJlY3Qud2lkdGgsXHJcbiAgICAgICAgc3R5bGVzID0ge1xyXG4gICAgICAgICAgbGVmdDogICAgIGxlZnQgKyAncHgnLFxyXG4gICAgICAgICAgbWluV2lkdGg6IHdpZHRoICsgJ3B4JyxcclxuICAgICAgICAgIG1heFdpZHRoOiBNYXRoLm1heChocmVjdC5yaWdodCAtIHJvb3QubGVmdCwgcm9vdC5yaWdodCAtIGhyZWN0LmxlZnQpIC0gTUVOVV9QQURESU5HICsgJ3B4J1xyXG4gICAgICAgIH07XHJcbiAgICBpZiAodG9wID4gYm90ICYmIHJvb3QuaGVpZ2h0IC0gaHJlY3QuYm90dG9tIC0gTUVOVV9QQURESU5HIDwgTUFYX0hFSUdIVCkge1xyXG4gICAgICBzdHlsZXMudG9wID0gJ2F1dG8nO1xyXG4gICAgICBzdHlsZXMuYm90dG9tID0gYm90ICsgJ3B4JztcclxuICAgICAgc3R5bGVzLm1heEhlaWdodCA9IE1hdGgubWluKE1BWF9IRUlHSFQsIGhyZWN0LnRvcCAtIHJvb3QudG9wIC0gTUVOVV9QQURESU5HKSArICdweCc7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzdHlsZXMudG9wID0gdG9wICsgJ3B4JztcclxuICAgICAgc3R5bGVzLmJvdHRvbSA9ICdhdXRvJztcclxuICAgICAgc3R5bGVzLm1heEhlaWdodCA9IE1hdGgubWluKE1BWF9IRUlHSFQsIHJvb3QuYm90dG9tIC0gaHJlY3QuYm90dG9tIC0gTUVOVV9QQURESU5HKSArICdweCc7XHJcbiAgICB9XHJcbiAgICBlbGVtZW50cy4kLnVsLmNzcyhzdHlsZXMpO1xyXG4gICAgJHRpbWVvdXQoY29ycmVjdEhvcml6b250YWxBbGlnbm1lbnQsIDAsIGZhbHNlKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIE1ha2VzIHN1cmUgdGhhdCB0aGUgbWVudSBkb2Vzbid0IGdvIG9mZiBvZiB0aGUgc2NyZWVuIG9uIGVpdGhlciBzaWRlLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBjb3JyZWN0SG9yaXpvbnRhbEFsaWdubWVudCAoKSB7XHJcbiAgICAgIHZhciBkcm9wZG93biA9IGVsZW1lbnRzLnVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxyXG4gICAgICAgICAgc3R5bGVzICAgPSB7fTtcclxuICAgICAgaWYgKGRyb3Bkb3duLnJpZ2h0ID4gcm9vdC5yaWdodCAtIE1FTlVfUEFERElORykge1xyXG4gICAgICAgIHN0eWxlcy5sZWZ0ID0gKGhyZWN0LnJpZ2h0IC0gZHJvcGRvd24ud2lkdGgpICsgJ3B4JztcclxuICAgICAgfVxyXG4gICAgICBlbGVtZW50cy4kLnVsLmNzcyhzdHlsZXMpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTW92ZXMgdGhlIGRyb3Bkb3duIG1lbnUgdG8gdGhlIGJvZHkgdGFnIGluIG9yZGVyIHRvIGF2b2lkIHotaW5kZXggYW5kIG92ZXJmbG93IGlzc3Vlcy5cclxuICAgKi9cclxuICBmdW5jdGlvbiBtb3ZlRHJvcGRvd24gKCkge1xyXG4gICAgaWYgKCFlbGVtZW50cy4kLnJvb3QubGVuZ3RoKSByZXR1cm47XHJcbiAgICAkbWRUaGVtaW5nKGVsZW1lbnRzLiQudWwpO1xyXG4gICAgZWxlbWVudHMuJC51bC5kZXRhY2goKTtcclxuICAgIGVsZW1lbnRzLiQucm9vdC5hcHBlbmQoZWxlbWVudHMuJC51bCk7XHJcbiAgICBpZiAoJGFuaW1hdGUucGluKSAkYW5pbWF0ZS5waW4oZWxlbWVudHMuJC51bCwgJHJvb3RFbGVtZW50KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNlbmRzIGZvY3VzIHRvIHRoZSBpbnB1dCBlbGVtZW50LlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGZvY3VzRWxlbWVudCAoKSB7XHJcbiAgICBpZiAoJHNjb3BlLmF1dG9mb2N1cykgZWxlbWVudHMuaW5wdXQuZm9jdXMoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNldHMgdXAgYW55IHdhdGNoZXJzIHVzZWQgYnkgYXV0b2NvbXBsZXRlXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gY29uZmlndXJlV2F0Y2hlcnMgKCkge1xyXG4gICAgdmFyIHdhaXQgPSBwYXJzZUludCgkc2NvcGUuZGVsYXksIDEwKSB8fCAwO1xyXG4gICAgJGF0dHJzLiRvYnNlcnZlKCdkaXNhYmxlZCcsIGZ1bmN0aW9uICh2YWx1ZSkgeyBjdHJsLmlzRGlzYWJsZWQgPSB2YWx1ZTsgfSk7XHJcbiAgICAkYXR0cnMuJG9ic2VydmUoJ3JlcXVpcmVkJywgZnVuY3Rpb24gKHZhbHVlKSB7IGN0cmwuaXNSZXF1aXJlZCA9IHZhbHVlICE9PSBudWxsOyB9KTtcclxuICAgICRzY29wZS4kd2F0Y2goJ3NlYXJjaFRleHQnLCB3YWl0ID8gJG1kVXRpbC5kZWJvdW5jZShoYW5kbGVTZWFyY2hUZXh0LCB3YWl0KSA6IGhhbmRsZVNlYXJjaFRleHQpO1xyXG4gICAgcmVnaXN0ZXJTZWxlY3RlZEl0ZW1XYXRjaGVyKHNlbGVjdGVkSXRlbUNoYW5nZSk7XHJcbiAgICAkc2NvcGUuJHdhdGNoKCdzZWxlY3RlZEl0ZW0nLCBoYW5kbGVTZWxlY3RlZEl0ZW1DaGFuZ2UpO1xyXG4gICAgYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpLm9uKCdyZXNpemUnLCBwb3NpdGlvbkRyb3Bkb3duKTtcclxuICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgY2xlYW51cCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZW1vdmVzIGFueSBldmVudHMgb3IgbGVmdG92ZXIgZWxlbWVudHMgY3JlYXRlZCBieSB0aGlzIGNvbnRyb2xsZXJcclxuICAgKi9cclxuICBmdW5jdGlvbiBjbGVhbnVwICgpIHtcclxuICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vZmYoJ3Jlc2l6ZScsIHBvc2l0aW9uRHJvcGRvd24pO1xyXG4gICAgZWxlbWVudHMuJC51bC5yZW1vdmUoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdhdGhlcnMgYWxsIG9mIHRoZSBlbGVtZW50cyBuZWVkZWQgZm9yIHRoaXMgY29udHJvbGxlclxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGdhdGhlckVsZW1lbnRzICgpIHtcclxuICAgIGVsZW1lbnRzID0ge1xyXG4gICAgICBtYWluOiAgJGVsZW1lbnRbMF0sXHJcbiAgICAgIHVsOiAgICAkZWxlbWVudC5maW5kKCd1bCcpWzBdLFxyXG4gICAgICBpbnB1dDogJGVsZW1lbnQuZmluZCgnaW5wdXQnKVswXSxcclxuICAgICAgd3JhcDogICRlbGVtZW50LmZpbmQoJ21kLWF1dG9jb21wbGV0ZS13cmFwJylbMF0sXHJcbiAgICAgIHJvb3Q6ICBkb2N1bWVudC5ib2R5XHJcbiAgICB9O1xyXG4gICAgZWxlbWVudHMubGkgPSBlbGVtZW50cy51bC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbGknKTtcclxuICAgIGVsZW1lbnRzLnNuYXAgPSBnZXRTbmFwVGFyZ2V0KCk7XHJcbiAgICBlbGVtZW50cy4kID0gZ2V0QW5ndWxhckVsZW1lbnRzKGVsZW1lbnRzKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZpbmRzIHRoZSBlbGVtZW50IHRoYXQgdGhlIG1lbnUgd2lsbCBiYXNlIGl0cyBwb3NpdGlvbiBvblxyXG4gICAqIEByZXR1cm5zIHsqfVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGdldFNuYXBUYXJnZXQgKCkge1xyXG4gICAgZm9yICh2YXIgZWxlbWVudCA9ICRlbGVtZW50OyBlbGVtZW50Lmxlbmd0aDsgZWxlbWVudCA9IGVsZW1lbnQucGFyZW50KCkpIHtcclxuICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKGVsZW1lbnQuYXR0cignbWQtYXV0b2NvbXBsZXRlLXNuYXAnKSkpIHJldHVybiBlbGVtZW50WzBdO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGVsZW1lbnRzLndyYXA7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHYXRoZXJzIGFuZ3VsYXItd3JhcHBlZCB2ZXJzaW9ucyBvZiBlYWNoIGVsZW1lbnRcclxuICAgKiBAcGFyYW0gZWxlbWVudHNcclxuICAgKiBAcmV0dXJucyB7e319XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gZ2V0QW5ndWxhckVsZW1lbnRzIChlbGVtZW50cykge1xyXG4gICAgdmFyIG9iaiA9IHt9O1xyXG4gICAgZm9yICh2YXIga2V5IGluIGVsZW1lbnRzKSB7XHJcbiAgICAgIG9ialtrZXldID0gYW5ndWxhci5lbGVtZW50KGVsZW1lbnRzW2tleV0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG9iajtcclxuICB9XHJcblxyXG4gIC8vLS0gZXZlbnQvY2hhbmdlIGhhbmRsZXJzXHJcblxyXG4gIC8qKlxyXG4gICAqIEhhbmRsZXMgY2hhbmdlcyB0byB0aGUgYGhpZGRlbmAgcHJvcGVydHkuXHJcbiAgICogQHBhcmFtIGhpZGRlblxyXG4gICAqIEBwYXJhbSBvbGRIaWRkZW5cclxuICAgKi9cclxuICBmdW5jdGlvbiBoYW5kbGVIaWRkZW5DaGFuZ2UgKGhpZGRlbiwgb2xkSGlkZGVuKSB7XHJcbiAgICBpZiAoIWhpZGRlbiAmJiBvbGRIaWRkZW4pIHBvc2l0aW9uRHJvcGRvd24oKTtcclxuICAgIGlmICghaGlkZGVuKSB7XHJcbiAgICAgIGlmIChlbGVtZW50cykgJHRpbWVvdXQoZnVuY3Rpb24gKCkgeyAkbWRVdGlsLmRpc2FibGVTY3JvbGxBcm91bmQoZWxlbWVudHMudWwpOyB9LCAwLCBmYWxzZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAkbWRVdGlsLmVuYWJsZVNjcm9sbGluZygpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogV2hlbiB0aGUgdXNlciBtb3VzZXMgb3ZlciB0aGUgZHJvcGRvd24gbWVudSwgaWdub3JlIGJsdXIgZXZlbnRzLlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIG9uTGlzdEVudGVyICgpIHtcclxuICAgIG5vQmx1ciA9IHRydWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBXaGVuIHRoZSB1c2VyJ3MgbW91c2UgbGVhdmVzIHRoZSBtZW51LCBibHVyIGV2ZW50cyBtYXkgaGlkZSB0aGUgbWVudSBhZ2Fpbi5cclxuICAgKi9cclxuICBmdW5jdGlvbiBvbkxpc3RMZWF2ZSAoKSB7XHJcbiAgICBub0JsdXIgPSBmYWxzZTtcclxuICAgIGlmICghaGFzRm9jdXMpIGN0cmwuaGlkZGVuID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFdoZW4gdGhlIG1vdXNlIGJ1dHRvbiBpcyByZWxlYXNlZCwgc2VuZCBmb2N1cyBiYWNrIHRvIHRoZSBpbnB1dCBmaWVsZC5cclxuICAgKi9cclxuICBmdW5jdGlvbiBvbk1vdXNldXAgKCkge1xyXG4gICAgZWxlbWVudHMuaW5wdXQuZm9jdXMoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEhhbmRsZXMgY2hhbmdlcyB0byB0aGUgc2VsZWN0ZWQgaXRlbS5cclxuICAgKiBAcGFyYW0gc2VsZWN0ZWRJdGVtXHJcbiAgICogQHBhcmFtIHByZXZpb3VzU2VsZWN0ZWRJdGVtXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gc2VsZWN0ZWRJdGVtQ2hhbmdlIChzZWxlY3RlZEl0ZW0sIHByZXZpb3VzU2VsZWN0ZWRJdGVtKSB7XHJcbiAgICBpZiAoc2VsZWN0ZWRJdGVtKSB7XHJcbiAgICAgICRzY29wZS5zZWFyY2hUZXh0ID0gZ2V0RGlzcGxheVZhbHVlKHNlbGVjdGVkSXRlbSk7XHJcbiAgICB9XHJcbiAgICBpZiAoYW5ndWxhci5pc0Z1bmN0aW9uKCRzY29wZS5pdGVtQ2hhbmdlKSAmJiBzZWxlY3RlZEl0ZW0gIT09IHByZXZpb3VzU2VsZWN0ZWRJdGVtKVxyXG4gICAgICAkc2NvcGUuaXRlbUNoYW5nZShnZXRJdGVtU2NvcGUoc2VsZWN0ZWRJdGVtKSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDYWxscyBhbnkgZXh0ZXJuYWwgd2F0Y2hlcnMgbGlzdGVuaW5nIGZvciB0aGUgc2VsZWN0ZWQgaXRlbS4gIFVzZWQgaW4gY29uanVuY3Rpb24gd2l0aFxyXG4gICAqIGByZWdpc3RlclNlbGVjdGVkSXRlbVdhdGNoZXJgLlxyXG4gICAqIEBwYXJhbSBzZWxlY3RlZEl0ZW1cclxuICAgKiBAcGFyYW0gcHJldmlvdXNTZWxlY3RlZEl0ZW1cclxuICAgKi9cclxuICBmdW5jdGlvbiBoYW5kbGVTZWxlY3RlZEl0ZW1DaGFuZ2Uoc2VsZWN0ZWRJdGVtLCBwcmV2aW91c1NlbGVjdGVkSXRlbSkge1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxlY3RlZEl0ZW1XYXRjaGVycy5sZW5ndGg7ICsraSkge1xyXG4gICAgICBzZWxlY3RlZEl0ZW1XYXRjaGVyc1tpXShzZWxlY3RlZEl0ZW0sIHByZXZpb3VzU2VsZWN0ZWRJdGVtKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlZ2lzdGVyIGEgZnVuY3Rpb24gdG8gYmUgY2FsbGVkIHdoZW4gdGhlIHNlbGVjdGVkIGl0ZW0gY2hhbmdlcy5cclxuICAgKiBAcGFyYW0gY2JcclxuICAgKi9cclxuICBmdW5jdGlvbiByZWdpc3RlclNlbGVjdGVkSXRlbVdhdGNoZXIoY2IpIHtcclxuICAgIGlmIChzZWxlY3RlZEl0ZW1XYXRjaGVycy5pbmRleE9mKGNiKSA9PSAtMSkge1xyXG4gICAgICBzZWxlY3RlZEl0ZW1XYXRjaGVycy5wdXNoKGNiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVucmVnaXN0ZXIgYSBmdW5jdGlvbiBwcmV2aW91c2x5IHJlZ2lzdGVyZWQgZm9yIHNlbGVjdGVkIGl0ZW0gY2hhbmdlcy5cclxuICAgKiBAcGFyYW0gY2JcclxuICAgKi9cclxuICBmdW5jdGlvbiB1bnJlZ2lzdGVyU2VsZWN0ZWRJdGVtV2F0Y2hlcihjYikge1xyXG4gICAgdmFyIGkgPSBzZWxlY3RlZEl0ZW1XYXRjaGVycy5pbmRleE9mKGNiKTtcclxuICAgIGlmIChpICE9IC0xKSB7XHJcbiAgICAgIHNlbGVjdGVkSXRlbVdhdGNoZXJzLnNwbGljZShpLCAxKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEhhbmRsZXMgY2hhbmdlcyB0byB0aGUgc2VhcmNoVGV4dCBwcm9wZXJ0eS5cclxuICAgKiBAcGFyYW0gc2VhcmNoVGV4dFxyXG4gICAqIEBwYXJhbSBwcmV2aW91c1NlYXJjaFRleHRcclxuICAgKi9cclxuICBmdW5jdGlvbiBoYW5kbGVTZWFyY2hUZXh0IChzZWFyY2hUZXh0LCBwcmV2aW91c1NlYXJjaFRleHQpIHtcclxuICAgIGN0cmwuaW5kZXggPSBnZXREZWZhdWx0SW5kZXgoKTtcclxuICAgIC8vLS0gZG8gbm90aGluZyBvbiBpbml0XHJcbiAgICBpZiAoc2VhcmNoVGV4dCA9PT0gcHJldmlvdXNTZWFyY2hUZXh0KSByZXR1cm47XHJcbiAgICAvLy0tIGNsZWFyIHNlbGVjdGVkIGl0ZW0gaWYgc2VhcmNoIHRleHQgbm8gbG9uZ2VyIG1hdGNoZXMgaXRcclxuICAgIGlmIChzZWFyY2hUZXh0ICE9PSBnZXREaXNwbGF5VmFsdWUoJHNjb3BlLnNlbGVjdGVkSXRlbSkpICRzY29wZS5zZWxlY3RlZEl0ZW0gPSBudWxsO1xyXG4gICAgZWxzZSByZXR1cm47XHJcbiAgICAvLy0tIHRyaWdnZXIgY2hhbmdlIGV2ZW50IGlmIGF2YWlsYWJsZVxyXG4gICAgaWYgKGFuZ3VsYXIuaXNGdW5jdGlvbigkc2NvcGUudGV4dENoYW5nZSkgJiYgc2VhcmNoVGV4dCAhPT0gcHJldmlvdXNTZWFyY2hUZXh0KVxyXG4gICAgICAkc2NvcGUudGV4dENoYW5nZShnZXRJdGVtU2NvcGUoJHNjb3BlLnNlbGVjdGVkSXRlbSkpO1xyXG4gICAgLy8tLSBjYW5jZWwgcmVzdWx0cyBpZiBzZWFyY2ggdGV4dCBpcyBub3QgbG9uZyBlbm91Z2hcclxuICAgIGlmICghaXNNaW5MZW5ndGhNZXQoKSkge1xyXG4gICAgICBjdHJsLmxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgY3RybC5tYXRjaGVzID0gW107XHJcbiAgICAgIGN0cmwuaGlkZGVuID0gc2hvdWxkSGlkZSgpO1xyXG4gICAgICB1cGRhdGVNZXNzYWdlcygpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaGFuZGxlUXVlcnkoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEhhbmRsZXMgaW5wdXQgYmx1ciBldmVudCwgZGV0ZXJtaW5lcyBpZiB0aGUgZHJvcGRvd24gc2hvdWxkIGhpZGUuXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gYmx1ciAoKSB7XHJcbiAgICBoYXNGb2N1cyA9IGZhbHNlO1xyXG4gICAgaWYgKCFub0JsdXIpIGN0cmwuaGlkZGVuID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEhhbmRsZXMgaW5wdXQgZm9jdXMgZXZlbnQsIGRldGVybWluZXMgaWYgdGhlIGRyb3Bkb3duIHNob3VsZCBzaG93LlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGZvY3VzICgpIHtcclxuICAgIGhhc0ZvY3VzID0gdHJ1ZTtcclxuICAgIC8vLS0gaWYgc2VhcmNoVGV4dCBpcyBudWxsLCBsZXQncyBmb3JjZSBpdCB0byBiZSBhIHN0cmluZ1xyXG4gICAgaWYgKCFhbmd1bGFyLmlzU3RyaW5nKCRzY29wZS5zZWFyY2hUZXh0KSkgJHNjb3BlLnNlYXJjaFRleHQgPSAnJztcclxuICAgIGlmICgkc2NvcGUubWluTGVuZ3RoID4gMCkgcmV0dXJuO1xyXG4gICAgY3RybC5oaWRkZW4gPSBzaG91bGRIaWRlKCk7XHJcbiAgICBpZiAoIWN0cmwuaGlkZGVuKSBoYW5kbGVRdWVyeSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSGFuZGxlcyBrZXlib2FyZCBpbnB1dC5cclxuICAgKiBAcGFyYW0gZXZlbnRcclxuICAgKi9cclxuICBmdW5jdGlvbiBrZXlkb3duIChldmVudCkge1xyXG4gICAgc3dpdGNoIChldmVudC5rZXlDb2RlKSB7XHJcbiAgICAgIGNhc2UgJG1kQ29uc3RhbnQuS0VZX0NPREUuRE9XTl9BUlJPVzpcclxuICAgICAgICBpZiAoY3RybC5sb2FkaW5nKSByZXR1cm47XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBjdHJsLmluZGV4ID0gTWF0aC5taW4oY3RybC5pbmRleCArIDEsIGN0cmwubWF0Y2hlcy5sZW5ndGggLSAxKTtcclxuICAgICAgICB1cGRhdGVTY3JvbGwoKTtcclxuICAgICAgICB1cGRhdGVNZXNzYWdlcygpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLlVQX0FSUk9XOlxyXG4gICAgICAgIGlmIChjdHJsLmxvYWRpbmcpIHJldHVybjtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGN0cmwuaW5kZXggPSBjdHJsLmluZGV4IDwgMCA/IGN0cmwubWF0Y2hlcy5sZW5ndGggLSAxIDogTWF0aC5tYXgoMCwgY3RybC5pbmRleCAtIDEpO1xyXG4gICAgICAgIHVwZGF0ZVNjcm9sbCgpO1xyXG4gICAgICAgIHVwZGF0ZU1lc3NhZ2VzKCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJG1kQ29uc3RhbnQuS0VZX0NPREUuVEFCOlxyXG4gICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLkVOVEVSOlxyXG4gICAgICAgIGlmIChjdHJsLmhpZGRlbiB8fCBjdHJsLmxvYWRpbmcgfHwgY3RybC5pbmRleCA8IDAgfHwgY3RybC5tYXRjaGVzLmxlbmd0aCA8IDEpIHJldHVybjtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHNlbGVjdChjdHJsLmluZGV4KTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5FU0NBUEU6XHJcbiAgICAgICAgY3RybC5tYXRjaGVzID0gW107XHJcbiAgICAgICAgY3RybC5oaWRkZW4gPSB0cnVlO1xyXG4gICAgICAgIGN0cmwuaW5kZXggPSBnZXREZWZhdWx0SW5kZXgoKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgZGVmYXVsdDpcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vLS0gZ2V0dGVyc1xyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHRoZSBtaW5pbXVtIGxlbmd0aCBuZWVkZWQgdG8gZGlzcGxheSB0aGUgZHJvcGRvd24uXHJcbiAgICogQHJldHVybnMgeyp9XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gZ2V0TWluTGVuZ3RoICgpIHtcclxuICAgIHJldHVybiBhbmd1bGFyLmlzTnVtYmVyKCRzY29wZS5taW5MZW5ndGgpID8gJHNjb3BlLm1pbkxlbmd0aCA6IDE7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHRoZSBkaXNwbGF5IHZhbHVlIGZvciBhbiBpdGVtLlxyXG4gICAqIEBwYXJhbSBpdGVtXHJcbiAgICogQHJldHVybnMgeyp9XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gZ2V0RGlzcGxheVZhbHVlIChpdGVtKSB7XHJcbiAgICByZXR1cm4gKGl0ZW0gJiYgJHNjb3BlLml0ZW1UZXh0KSA/ICRzY29wZS5pdGVtVGV4dChnZXRJdGVtU2NvcGUoaXRlbSkpIDogaXRlbTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgdGhlIGxvY2FscyBvYmplY3QgZm9yIGNvbXBpbGluZyBpdGVtIHRlbXBsYXRlcy5cclxuICAgKiBAcGFyYW0gaXRlbVxyXG4gICAqIEByZXR1cm5zIHt7fX1cclxuICAgKi9cclxuICBmdW5jdGlvbiBnZXRJdGVtU2NvcGUgKGl0ZW0pIHtcclxuICAgIGlmICghaXRlbSkgcmV0dXJuO1xyXG4gICAgdmFyIGxvY2FscyA9IHt9O1xyXG4gICAgaWYgKGN0cmwuaXRlbU5hbWUpIGxvY2Fsc1tjdHJsLml0ZW1OYW1lXSA9IGl0ZW07XHJcbiAgICByZXR1cm4gbG9jYWxzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyB0aGUgZGVmYXVsdCBpbmRleCBiYXNlZCBvbiB3aGV0aGVyIG9yIG5vdCBhdXRvc2VsZWN0IGlzIGVuYWJsZWQuXHJcbiAgICogQHJldHVybnMge251bWJlcn1cclxuICAgKi9cclxuICBmdW5jdGlvbiBnZXREZWZhdWx0SW5kZXggKCkge1xyXG4gICAgcmV0dXJuICRzY29wZS5hdXRvc2VsZWN0ID8gMCA6IC0xO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRGV0ZXJtaW5lcyBpZiB0aGUgbWVudSBzaG91bGQgYmUgaGlkZGVuLlxyXG4gICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIHNob3VsZEhpZGUgKCkge1xyXG4gICAgaWYgKCFpc01pbkxlbmd0aE1ldCgpKSByZXR1cm4gdHJ1ZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgdGhlIGRpc3BsYXkgdmFsdWUgb2YgdGhlIGN1cnJlbnQgaXRlbS5cclxuICAgKiBAcmV0dXJucyB7Kn1cclxuICAgKi9cclxuICBmdW5jdGlvbiBnZXRDdXJyZW50RGlzcGxheVZhbHVlICgpIHtcclxuICAgIHJldHVybiBnZXREaXNwbGF5VmFsdWUoY3RybC5tYXRjaGVzW2N0cmwuaW5kZXhdKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIERldGVybWluZXMgaWYgdGhlIG1pbmltdW0gbGVuZ3RoIGlzIG1ldCBieSB0aGUgc2VhcmNoIHRleHQuXHJcbiAgICogQHJldHVybnMgeyp9XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gaXNNaW5MZW5ndGhNZXQgKCkge1xyXG4gICAgcmV0dXJuIGFuZ3VsYXIuaXNEZWZpbmVkKCRzY29wZS5zZWFyY2hUZXh0KSAmJiAkc2NvcGUuc2VhcmNoVGV4dC5sZW5ndGggPj0gZ2V0TWluTGVuZ3RoKCk7XHJcbiAgfVxyXG5cclxuICAvLy0tIGFjdGlvbnNcclxuXHJcbiAgLyoqXHJcbiAgICogRGVmaW5lcyBhIHB1YmxpYyBwcm9wZXJ0eSB3aXRoIGEgaGFuZGxlciBhbmQgYSBkZWZhdWx0IHZhbHVlLlxyXG4gICAqIEBwYXJhbSBrZXlcclxuICAgKiBAcGFyYW0gaGFuZGxlclxyXG4gICAqIEBwYXJhbSB2YWx1ZVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5IChrZXksIGhhbmRsZXIsIHZhbHVlKSB7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY3RybCwga2V5LCB7XHJcbiAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdmFsdWU7IH0sXHJcbiAgICAgIHNldDogZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XHJcbiAgICAgICAgdmFyIG9sZFZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgdmFsdWUgPSBuZXdWYWx1ZTtcclxuICAgICAgICBoYW5kbGVyKG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2VsZWN0cyB0aGUgaXRlbSBhdCB0aGUgZ2l2ZW4gaW5kZXguXHJcbiAgICogQHBhcmFtIGluZGV4XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gc2VsZWN0IChpbmRleCkge1xyXG4gICAgJHNjb3BlLnNlbGVjdGVkSXRlbSA9IGN0cmwubWF0Y2hlc1tpbmRleF07XHJcbiAgICBjdHJsLmhpZGRlbiA9IHRydWU7XHJcbiAgICBjdHJsLmluZGV4ID0gMDtcclxuICAgIGN0cmwubWF0Y2hlcyA9IFtdO1xyXG4gICAgLy8tLSBmb3JjZSBmb3JtIHRvIHVwZGF0ZSBzdGF0ZSBmb3IgdmFsaWRhdGlvblxyXG4gICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICBlbGVtZW50cy4kLmlucHV0LmNvbnRyb2xsZXIoJ25nTW9kZWwnKS4kc2V0Vmlld1ZhbHVlKGdldERpc3BsYXlWYWx1ZSgkc2NvcGUuc2VsZWN0ZWRJdGVtKSB8fFxyXG4gICAgICAgICAgJHNjb3BlLnNlYXJjaFRleHQpO1xyXG4gICAgICBjdHJsLmhpZGRlbiA9IHRydWU7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENsZWFycyB0aGUgc2VhcmNoVGV4dCB2YWx1ZSBhbmQgc2VsZWN0ZWQgaXRlbS5cclxuICAgKi9cclxuICBmdW5jdGlvbiBjbGVhclZhbHVlICgpIHtcclxuICAgICRzY29wZS5zZWFyY2hUZXh0ID0gJyc7XHJcbiAgICBzZWxlY3QoLTEpO1xyXG5cclxuICAgIC8vIFBlciBodHRwOi8vd3d3Lnczc2Nob29scy5jb20vanNyZWYvZXZlbnRfb25pbnB1dC5hc3BcclxuICAgIHZhciBldmVudE9iaiA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xyXG4gICAgZXZlbnRPYmouaW5pdEN1c3RvbUV2ZW50KCdpbnB1dCcsIHRydWUsIHRydWUsIHt2YWx1ZTogJHNjb3BlLnNlYXJjaFRleHR9KTtcclxuICAgIGVsZW1lbnRzLmlucHV0LmRpc3BhdGNoRXZlbnQoZXZlbnRPYmopO1xyXG5cclxuICAgIGVsZW1lbnRzLmlucHV0LmZvY3VzKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaGVzIHRoZSByZXN1bHRzIGZvciB0aGUgcHJvdmlkZWQgc2VhcmNoIHRleHQuXHJcbiAgICogQHBhcmFtIHNlYXJjaFRleHRcclxuICAgKi9cclxuICBmdW5jdGlvbiBmZXRjaFJlc3VsdHMgKHNlYXJjaFRleHQpIHtcclxuICAgIHZhciBpdGVtcyA9ICRzY29wZS4kcGFyZW50LiRldmFsKGl0ZW1FeHByKSxcclxuICAgICAgICB0ZXJtID0gc2VhcmNoVGV4dC50b0xvd2VyQ2FzZSgpO1xyXG4gICAgaWYgKGFuZ3VsYXIuaXNBcnJheShpdGVtcykpIHtcclxuICAgICAgaGFuZGxlUmVzdWx0cyhpdGVtcyk7XHJcbiAgICB9IGVsc2UgaWYgKGl0ZW1zKSB7XHJcbiAgICAgIGN0cmwubG9hZGluZyA9IHRydWU7XHJcbiAgICAgIGlmIChpdGVtcy5zdWNjZXNzKSBpdGVtcy5zdWNjZXNzKGhhbmRsZVJlc3VsdHMpO1xyXG4gICAgICBpZiAoaXRlbXMudGhlbikgICAgaXRlbXMudGhlbihoYW5kbGVSZXN1bHRzKTtcclxuICAgICAgaWYgKGl0ZW1zLmVycm9yKSAgIGl0ZW1zLmVycm9yKGZ1bmN0aW9uICgpIHsgY3RybC5sb2FkaW5nID0gZmFsc2U7IH0pO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gaGFuZGxlUmVzdWx0cyAobWF0Y2hlcykge1xyXG4gICAgICBjYWNoZVt0ZXJtXSA9IG1hdGNoZXM7XHJcbiAgICAgIGlmIChzZWFyY2hUZXh0ICE9PSAkc2NvcGUuc2VhcmNoVGV4dCkgcmV0dXJuOyAvLy0tIGp1c3QgY2FjaGUgdGhlIHJlc3VsdHMgaWYgb2xkIHJlcXVlc3RcclxuICAgICAgY3RybC5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgIHByb21pc2UgPSBudWxsO1xyXG4gICAgICBjdHJsLm1hdGNoZXMgPSBtYXRjaGVzO1xyXG4gICAgICBjdHJsLmhpZGRlbiA9IHNob3VsZEhpZGUoKTtcclxuICAgICAgdXBkYXRlTWVzc2FnZXMoKTtcclxuICAgICAgcG9zaXRpb25Ecm9wZG93bigpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlcyB0aGUgQVJJQSBtZXNzYWdlc1xyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIHVwZGF0ZU1lc3NhZ2VzICgpIHtcclxuICAgIGN0cmwubWVzc2FnZXMgPSBbIGdldENvdW50TWVzc2FnZSgpLCBnZXRDdXJyZW50RGlzcGxheVZhbHVlKCkgXTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgdGhlIEFSSUEgbWVzc2FnZSBmb3IgaG93IG1hbnkgcmVzdWx0cyBtYXRjaCB0aGUgY3VycmVudCBxdWVyeS5cclxuICAgKiBAcmV0dXJucyB7Kn1cclxuICAgKi9cclxuICBmdW5jdGlvbiBnZXRDb3VudE1lc3NhZ2UgKCkge1xyXG4gICAgaWYgKGxhc3RDb3VudCA9PT0gY3RybC5tYXRjaGVzLmxlbmd0aCkgcmV0dXJuICcnO1xyXG4gICAgbGFzdENvdW50ID0gY3RybC5tYXRjaGVzLmxlbmd0aDtcclxuICAgIHN3aXRjaCAoY3RybC5tYXRjaGVzLmxlbmd0aCkge1xyXG4gICAgICBjYXNlIDA6ICByZXR1cm4gJ1RoZXJlIGFyZSBubyBtYXRjaGVzIGF2YWlsYWJsZS4nO1xyXG4gICAgICBjYXNlIDE6ICByZXR1cm4gJ1RoZXJlIGlzIDEgbWF0Y2ggYXZhaWxhYmxlLic7XHJcbiAgICAgIGRlZmF1bHQ6IHJldHVybiAnVGhlcmUgYXJlICcgKyBjdHJsLm1hdGNoZXMubGVuZ3RoICsgJyBtYXRjaGVzIGF2YWlsYWJsZS4nO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTWFrZXMgc3VyZSB0aGF0IHRoZSBmb2N1c2VkIGVsZW1lbnQgaXMgd2l0aGluIHZpZXcuXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gdXBkYXRlU2Nyb2xsICgpIHtcclxuICAgIGlmICghZWxlbWVudHMubGlbY3RybC5pbmRleF0pIHJldHVybjtcclxuICAgIHZhciBsaSAgPSBlbGVtZW50cy5saVtjdHJsLmluZGV4XSxcclxuICAgICAgICB0b3AgPSBsaS5vZmZzZXRUb3AsXHJcbiAgICAgICAgYm90ID0gdG9wICsgbGkub2Zmc2V0SGVpZ2h0LFxyXG4gICAgICAgIGhndCA9IGVsZW1lbnRzLnVsLmNsaWVudEhlaWdodDtcclxuICAgIGlmICh0b3AgPCBlbGVtZW50cy51bC5zY3JvbGxUb3ApIHtcclxuICAgICAgZWxlbWVudHMudWwuc2Nyb2xsVG9wID0gdG9wO1xyXG4gICAgfSBlbHNlIGlmIChib3QgPiBlbGVtZW50cy51bC5zY3JvbGxUb3AgKyBoZ3QpIHtcclxuICAgICAgZWxlbWVudHMudWwuc2Nyb2xsVG9wID0gYm90IC0gaGd0O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU3RhcnRzIHRoZSBxdWVyeSB0byBnYXRoZXIgdGhlIHJlc3VsdHMgZm9yIHRoZSBjdXJyZW50IHNlYXJjaFRleHQuICBBdHRlbXB0cyB0byByZXR1cm4gY2FjaGVkXHJcbiAgICogcmVzdWx0cyBmaXJzdCwgdGhlbiBmb3J3YXJkcyB0aGUgcHJvY2VzcyB0byBgZmV0Y2hSZXN1bHRzYCBpZiBuZWNlc3NhcnkuXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gaGFuZGxlUXVlcnkgKCkge1xyXG4gICAgdmFyIHNlYXJjaFRleHQgPSAkc2NvcGUuc2VhcmNoVGV4dCxcclxuICAgICAgICB0ZXJtID0gc2VhcmNoVGV4dC50b0xvd2VyQ2FzZSgpO1xyXG4gICAgLy8tLSBjYW5jZWwgcHJvbWlzZSBpZiBhIHByb21pc2UgaXMgaW4gcHJvZ3Jlc3NcclxuICAgIGlmIChwcm9taXNlICYmIHByb21pc2UuY2FuY2VsKSB7XHJcbiAgICAgIHByb21pc2UuY2FuY2VsKCk7XHJcbiAgICAgIHByb21pc2UgPSBudWxsO1xyXG4gICAgfVxyXG4gICAgLy8tLSBpZiByZXN1bHRzIGFyZSBjYWNoZWQsIHB1bGwgaW4gY2FjaGVkIHJlc3VsdHNcclxuICAgIGlmICghJHNjb3BlLm5vQ2FjaGUgJiYgY2FjaGVbdGVybV0pIHtcclxuICAgICAgY3RybC5tYXRjaGVzID0gY2FjaGVbdGVybV07XHJcbiAgICAgIHVwZGF0ZU1lc3NhZ2VzKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBmZXRjaFJlc3VsdHMoc2VhcmNoVGV4dCk7XHJcbiAgICB9XHJcbiAgICBpZiAoaGFzRm9jdXMpIGN0cmwuaGlkZGVuID0gc2hvdWxkSGlkZSgpO1xyXG4gIH1cclxuXHJcbn1cclxuTWRBdXRvY29tcGxldGVDdHJsLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkZWxlbWVudFwiLCBcIiRtZFV0aWxcIiwgXCIkbWRDb25zdGFudFwiLCBcIiR0aW1lb3V0XCIsIFwiJG1kVGhlbWluZ1wiLCBcIiR3aW5kb3dcIiwgXCIkYW5pbWF0ZVwiLCBcIiRyb290RWxlbWVudFwiLCBcIiRhdHRyc1wiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuYXV0b2NvbXBsZXRlJylcclxuICAgIC5kaXJlY3RpdmUoJ21kQXV0b2NvbXBsZXRlJywgTWRBdXRvY29tcGxldGUpO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRBdXRvY29tcGxldGVcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmF1dG9jb21wbGV0ZVxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogYDxtZC1hdXRvY29tcGxldGU+YCBpcyBhIHNwZWNpYWwgaW5wdXQgY29tcG9uZW50IHdpdGggYSBkcm9wLWRvd24gb2YgYWxsIHBvc3NpYmxlIG1hdGNoZXMgdG8gYSBjdXN0b20gcXVlcnkuXHJcbiAqIFRoaXMgY29tcG9uZW50IGFsbG93cyB5b3UgdG8gcHJvdmlkZSByZWFsLXRpbWUgc3VnZ2VzdGlvbnMgYXMgdGhlIHVzZXIgdHlwZXMgaW4gdGhlIGlucHV0IGFyZWEuXHJcbiAqXHJcbiAqIFRvIHN0YXJ0LCB5b3Ugd2lsbCBuZWVkIHRvIHNwZWNpZnkgdGhlIHJlcXVpcmVkIHBhcmFtZXRlcnMgYW5kIHByb3ZpZGUgYSB0ZW1wbGF0ZSBmb3IgeW91ciByZXN1bHRzLlxyXG4gKiBUaGUgY29udGVudCBpbnNpZGUgYG1kLWF1dG9jb21wbGV0ZWAgd2lsbCBiZSB0cmVhdGVkIGFzIGEgdGVtcGxhdGUuXHJcbiAqXHJcbiAqIEluIG1vcmUgY29tcGxleCBjYXNlcywgeW91IG1heSB3YW50IHRvIGluY2x1ZGUgb3RoZXIgY29udGVudCBzdWNoIGFzIGEgbWVzc2FnZSB0byBkaXNwbGF5IHdoZW5cclxuICogbm8gbWF0Y2hlcyB3ZXJlIGZvdW5kLiAgWW91IGNhbiBkbyB0aGlzIGJ5IHdyYXBwaW5nIHlvdXIgdGVtcGxhdGUgaW4gYG1kLWl0ZW0tdGVtcGxhdGVgIGFuZCBhZGRpbmdcclxuICogYSB0YWcgZm9yIGBtZC1ub3QtZm91bmRgLiAgQW4gZXhhbXBsZSBvZiB0aGlzIGlzIHNob3duIGJlbG93LlxyXG4gKiAjIyMgVmFsaWRhdGlvblxyXG4gKlxyXG4gKiBZb3UgY2FuIHVzZSBgbmctbWVzc2FnZXNgIHRvIGluY2x1ZGUgdmFsaWRhdGlvbiB0aGUgc2FtZSB3YXkgdGhhdCB5b3Ugd291bGQgbm9ybWFsbHkgdmFsaWRhdGU7XHJcbiAqIGhvd2V2ZXIsIGlmIHlvdSB3YW50IHRvIHJlcGxpY2F0ZSBhIHN0YW5kYXJkIGlucHV0IHdpdGggYSBmbG9hdGluZyBsYWJlbCwgeW91IHdpbGwgaGF2ZSB0byBkbyB0aGVcclxuICogZm9sbG93aW5nOlxyXG4gKlxyXG4gKiAtIE1ha2Ugc3VyZSB0aGF0IHlvdXIgdGVtcGxhdGUgaXMgd3JhcHBlZCBpbiBgbWQtaXRlbS10ZW1wbGF0ZWBcclxuICogLSBBZGQgeW91ciBgbmctbWVzc2FnZXNgIGNvZGUgaW5zaWRlIG9mIGBtZC1hdXRvY29tcGxldGVgXHJcbiAqIC0gQWRkIHlvdXIgdmFsaWRhdGlvbiBwcm9wZXJ0aWVzIHRvIGBtZC1hdXRvY29tcGxldGVgIChpZS4gYHJlcXVpcmVkYClcclxuICogLSBBZGQgYSBgbmFtZWAgdG8gYG1kLWF1dG9jb21wbGV0ZWAgKHRvIGJlIHVzZWQgb24gdGhlIGdlbmVyYXRlZCBgaW5wdXRgKVxyXG4gKlxyXG4gKiBUaGVyZSBpcyBhbiBleGFtcGxlIGJlbG93IG9mIGhvdyB0aGlzIHNob3VsZCBsb29rLlxyXG4gKlxyXG4gKlxyXG4gKiBAcGFyYW0ge2V4cHJlc3Npb259IG1kLWl0ZW1zIEFuIGV4cHJlc3Npb24gaW4gdGhlIGZvcm1hdCBvZiBgaXRlbSBpbiBpdGVtc2AgdG8gaXRlcmF0ZSBvdmVyIG1hdGNoZXMgZm9yIHlvdXIgc2VhcmNoLlxyXG4gKiBAcGFyYW0ge2V4cHJlc3Npb249fSBtZC1zZWxlY3RlZC1pdGVtLWNoYW5nZSBBbiBleHByZXNzaW9uIHRvIGJlIHJ1biBlYWNoIHRpbWUgYSBuZXcgaXRlbSBpcyBzZWxlY3RlZFxyXG4gKiBAcGFyYW0ge2V4cHJlc3Npb249fSBtZC1zZWFyY2gtdGV4dC1jaGFuZ2UgQW4gZXhwcmVzc2lvbiB0byBiZSBydW4gZWFjaCB0aW1lIHRoZSBzZWFyY2ggdGV4dCB1cGRhdGVzXHJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gbWQtc2VhcmNoLXRleHQgQSBtb2RlbCB0byBiaW5kIHRoZSBzZWFyY2ggcXVlcnkgdGV4dCB0b1xyXG4gKiBAcGFyYW0ge29iamVjdD19IG1kLXNlbGVjdGVkLWl0ZW0gQSBtb2RlbCB0byBiaW5kIHRoZSBzZWxlY3RlZCBpdGVtIHRvXHJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gbWQtaXRlbS10ZXh0IEFuIGV4cHJlc3Npb24gdGhhdCB3aWxsIGNvbnZlcnQgeW91ciBvYmplY3QgdG8gYSBzaW5nbGUgc3RyaW5nLlxyXG4gKiBAcGFyYW0ge3N0cmluZz19IHBsYWNlaG9sZGVyIFBsYWNlaG9sZGVyIHRleHQgdGhhdCB3aWxsIGJlIGZvcndhcmRlZCB0byB0aGUgaW5wdXQuXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG1kLW5vLWNhY2hlIERpc2FibGVzIHRoZSBpbnRlcm5hbCBjYWNoaW5nIHRoYXQgaGFwcGVucyBpbiBhdXRvY29tcGxldGVcclxuICogQHBhcmFtIHtib29sZWFuPX0gbmctZGlzYWJsZWQgRGV0ZXJtaW5lcyB3aGV0aGVyIG9yIG5vdCB0byBkaXNhYmxlIHRoZSBpbnB1dCBmaWVsZFxyXG4gKiBAcGFyYW0ge251bWJlcj19IG1kLW1pbi1sZW5ndGggU3BlY2lmaWVzIHRoZSBtaW5pbXVtIGxlbmd0aCBvZiB0ZXh0IGJlZm9yZSBhdXRvY29tcGxldGUgd2lsbCBtYWtlIHN1Z2dlc3Rpb25zXHJcbiAqIEBwYXJhbSB7bnVtYmVyPX0gbWQtZGVsYXkgU3BlY2lmaWVzIHRoZSBhbW91bnQgb2YgdGltZSAoaW4gbWlsbGlzZWNvbmRzKSB0byB3YWl0IGJlZm9yZSBsb29raW5nIGZvciByZXN1bHRzXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG1kLWF1dG9mb2N1cyBJZiB0cnVlLCB3aWxsIGltbWVkaWF0ZWx5IGZvY3VzIHRoZSBpbnB1dCBlbGVtZW50XHJcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG1kLWF1dG9zZWxlY3QgSWYgdHJ1ZSwgdGhlIGZpcnN0IGl0ZW0gd2lsbCBiZSBzZWxlY3RlZCBieSBkZWZhdWx0XHJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gbWQtbWVudS1jbGFzcyBUaGlzIHdpbGwgYmUgYXBwbGllZCB0byB0aGUgZHJvcGRvd24gbWVudSBmb3Igc3R5bGluZ1xyXG4gKiBAcGFyYW0ge3N0cmluZz19IG1kLWZsb2F0aW5nLWxhYmVsIFRoaXMgd2lsbCBhZGQgYSBmbG9hdGluZyBsYWJlbCB0byBhdXRvY29tcGxldGUgYW5kIHdyYXAgaXQgaW4gYG1kLWlucHV0LWNvbnRhaW5lcmBcclxuICpcclxuICogQHVzYWdlXHJcbiAqICMjI0Jhc2ljIEV4YW1wbGVcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogICA8bWQtYXV0b2NvbXBsZXRlXHJcbiAqICAgICAgIG1kLXNlbGVjdGVkLWl0ZW09XCJzZWxlY3RlZEl0ZW1cIlxyXG4gKiAgICAgICBtZC1zZWFyY2gtdGV4dD1cInNlYXJjaFRleHRcIlxyXG4gKiAgICAgICBtZC1pdGVtcz1cIml0ZW0gaW4gZ2V0TWF0Y2hlcyhzZWFyY2hUZXh0KVwiXHJcbiAqICAgICAgIG1kLWl0ZW0tdGV4dD1cIml0ZW0uZGlzcGxheVwiPlxyXG4gKiAgICAgPHNwYW4gbWQtaGlnaGxpZ2h0LXRleHQ9XCJzZWFyY2hUZXh0XCI+e3tpdGVtLmRpc3BsYXl9fTwvc3Bhbj5cclxuICogICA8L21kLWF1dG9jb21wbGV0ZT5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiAjIyNFeGFtcGxlIHdpdGggXCJub3QgZm91bmRcIiBtZXNzYWdlXHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqIDxtZC1hdXRvY29tcGxldGVcclxuICogICAgIG1kLXNlbGVjdGVkLWl0ZW09XCJzZWxlY3RlZEl0ZW1cIlxyXG4gKiAgICAgbWQtc2VhcmNoLXRleHQ9XCJzZWFyY2hUZXh0XCJcclxuICogICAgIG1kLWl0ZW1zPVwiaXRlbSBpbiBnZXRNYXRjaGVzKHNlYXJjaFRleHQpXCJcclxuICogICAgIG1kLWl0ZW0tdGV4dD1cIml0ZW0uZGlzcGxheVwiPlxyXG4gKiAgIDxtZC1pdGVtLXRlbXBsYXRlPlxyXG4gKiAgICAgPHNwYW4gbWQtaGlnaGxpZ2h0LXRleHQ9XCJzZWFyY2hUZXh0XCI+e3tpdGVtLmRpc3BsYXl9fTwvc3Bhbj5cclxuICogICA8L21kLWl0ZW0tdGVtcGxhdGU+XHJcbiAqICAgPG1kLW5vdC1mb3VuZD5cclxuICogICAgIE5vIG1hdGNoZXMgZm91bmQuXHJcbiAqICAgPC9tZC1ub3QtZm91bmQ+XHJcbiAqIDwvbWQtYXV0b2NvbXBsZXRlPlxyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqIEluIHRoaXMgZXhhbXBsZSwgb3VyIGNvZGUgdXRpbGl6ZXMgYG1kLWl0ZW0tdGVtcGxhdGVgIGFuZCBgbWQtbm90LWZvdW5kYCB0byBzcGVjaWZ5IHRoZSBkaWZmZXJlbnRcclxuICogcGFydHMgdGhhdCBtYWtlIHVwIG91ciBjb21wb25lbnQuXHJcbiAqXHJcbiAqICMjIyBFeGFtcGxlIHdpdGggdmFsaWRhdGlvblxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8Zm9ybSBuYW1lPVwiYXV0b2NvbXBsZXRlRm9ybVwiPlxyXG4gKiAgIDxtZC1hdXRvY29tcGxldGVcclxuICogICAgICAgcmVxdWlyZWRcclxuICogICAgICAgaW5wdXQtbmFtZT1cImF1dG9jb21wbGV0ZVwiXHJcbiAqICAgICAgIG1kLXNlbGVjdGVkLWl0ZW09XCJzZWxlY3RlZEl0ZW1cIlxyXG4gKiAgICAgICBtZC1zZWFyY2gtdGV4dD1cInNlYXJjaFRleHRcIlxyXG4gKiAgICAgICBtZC1pdGVtcz1cIml0ZW0gaW4gZ2V0TWF0Y2hlcyhzZWFyY2hUZXh0KVwiXHJcbiAqICAgICAgIG1kLWl0ZW0tdGV4dD1cIml0ZW0uZGlzcGxheVwiPlxyXG4gKiAgICAgPG1kLWl0ZW0tdGVtcGxhdGU+XHJcbiAqICAgICAgIDxzcGFuIG1kLWhpZ2hsaWdodC10ZXh0PVwic2VhcmNoVGV4dFwiPnt7aXRlbS5kaXNwbGF5fX08L3NwYW4+XHJcbiAqICAgICA8L21kLWl0ZW0tdGVtcGxhdGU+XHJcbiAqICAgICA8ZGl2IG5nLW1lc3NhZ2VzPVwiYXV0b2NvbXBsZXRlRm9ybS5hdXRvY29tcGxldGUuJGVycm9yXCI+XHJcbiAqICAgICAgIDxkaXYgbmctbWVzc2FnZT1cInJlcXVpcmVkXCI+VGhpcyBmaWVsZCBpcyByZXF1aXJlZDwvZGl2PlxyXG4gKiAgICAgPC9kaXY+XHJcbiAqICAgPC9tZC1hdXRvY29tcGxldGU+XHJcbiAqIDwvZm9ybT5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiBJbiB0aGlzIGV4YW1wbGUsIG91ciBjb2RlIHV0aWxpemVzIGBtZC1pdGVtLXRlbXBsYXRlYCBhbmQgYG1kLW5vdC1mb3VuZGAgdG8gc3BlY2lmeSB0aGUgZGlmZmVyZW50XHJcbiAqIHBhcnRzIHRoYXQgbWFrZSB1cCBvdXIgY29tcG9uZW50LlxyXG4gKi9cclxuXHJcbmZ1bmN0aW9uIE1kQXV0b2NvbXBsZXRlICgkbWRUaGVtaW5nLCAkbWRVdGlsKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIGNvbnRyb2xsZXI6ICAgJ01kQXV0b2NvbXBsZXRlQ3RybCcsXHJcbiAgICBjb250cm9sbGVyQXM6ICckbWRBdXRvY29tcGxldGVDdHJsJyxcclxuICAgIHNjb3BlOiAgICAgICAge1xyXG4gICAgICBpbnB1dE5hbWU6ICAgICAgJ0BtZElucHV0TmFtZScsXHJcbiAgICAgIGlucHV0TWlubGVuZ3RoOiAnQG1kSW5wdXRNaW5sZW5ndGgnLFxyXG4gICAgICBpbnB1dE1heGxlbmd0aDogJ0BtZElucHV0TWF4bGVuZ3RoJyxcclxuICAgICAgc2VhcmNoVGV4dDogICAgICc9P21kU2VhcmNoVGV4dCcsXHJcbiAgICAgIHNlbGVjdGVkSXRlbTogICAnPT9tZFNlbGVjdGVkSXRlbScsXHJcbiAgICAgIGl0ZW1zRXhwcjogICAgICAnQG1kSXRlbXMnLFxyXG4gICAgICBpdGVtVGV4dDogICAgICAgJyZtZEl0ZW1UZXh0JyxcclxuICAgICAgcGxhY2Vob2xkZXI6ICAgICdAcGxhY2Vob2xkZXInLFxyXG4gICAgICBub0NhY2hlOiAgICAgICAgJz0/bWROb0NhY2hlJyxcclxuICAgICAgaXRlbUNoYW5nZTogICAgICcmP21kU2VsZWN0ZWRJdGVtQ2hhbmdlJyxcclxuICAgICAgdGV4dENoYW5nZTogICAgICcmP21kU2VhcmNoVGV4dENoYW5nZScsXHJcbiAgICAgIG1pbkxlbmd0aDogICAgICAnPT9tZE1pbkxlbmd0aCcsXHJcbiAgICAgIGRlbGF5OiAgICAgICAgICAnPT9tZERlbGF5JyxcclxuICAgICAgYXV0b2ZvY3VzOiAgICAgICc9P21kQXV0b2ZvY3VzJyxcclxuICAgICAgZmxvYXRpbmdMYWJlbDogICdAP21kRmxvYXRpbmdMYWJlbCcsXHJcbiAgICAgIGF1dG9zZWxlY3Q6ICAgICAnPT9tZEF1dG9zZWxlY3QnLFxyXG4gICAgICBtZW51Q2xhc3M6ICAgICAgJ0A/bWRNZW51Q2xhc3MnXHJcbiAgICB9LFxyXG4gICAgdGVtcGxhdGU6IGZ1bmN0aW9uIChlbGVtZW50LCBhdHRyKSB7XHJcbiAgICAgIHZhciBub0l0ZW1zVGVtcGxhdGUgPSBnZXROb0l0ZW1zVGVtcGxhdGUoKSxcclxuICAgICAgICAgIGl0ZW1UZW1wbGF0ZSA9IGdldEl0ZW1UZW1wbGF0ZSgpLFxyXG4gICAgICAgICAgbGVmdG92ZXIgPSBlbGVtZW50Lmh0bWwoKTtcclxuICAgICAgcmV0dXJuICdcXFxyXG4gICAgICAgIDxtZC1hdXRvY29tcGxldGUtd3JhcFxcXHJcbiAgICAgICAgICAgIGxheW91dD1cInJvd1wiXFxcclxuICAgICAgICAgICAgbmctY2xhc3M9XCJ7IFxcJ21kLXdoaXRlZnJhbWUtejFcXCc6ICFmbG9hdGluZ0xhYmVsIH1cIlxcXHJcbiAgICAgICAgICAgIHJvbGU9XCJsaXN0Ym94XCI+XFxcclxuICAgICAgICAgICcgKyBnZXRJbnB1dEVsZW1lbnQoKSArICdcXFxyXG4gICAgICAgICAgPG1kLXByb2dyZXNzLWxpbmVhclxcXHJcbiAgICAgICAgICAgICAgbmctaWY9XCIkbWRBdXRvY29tcGxldGVDdHJsLmxvYWRpbmdcIlxcXHJcbiAgICAgICAgICAgICAgbWQtbW9kZT1cImluZGV0ZXJtaW5hdGVcIj48L21kLXByb2dyZXNzLWxpbmVhcj5cXFxyXG4gICAgICAgICAgPHVsIHJvbGU9XCJwcmVzZW50YXRpb25cIlxcXHJcbiAgICAgICAgICAgICAgY2xhc3M9XCJtZC1hdXRvY29tcGxldGUtc3VnZ2VzdGlvbnMgbWQtd2hpdGVmcmFtZS16MSB7e21lbnVDbGFzcyB8fCBcXCdcXCd9fVwiXFxcclxuICAgICAgICAgICAgICBpZD1cInVsLXt7JG1kQXV0b2NvbXBsZXRlQ3RybC5pZH19XCJcXFxyXG4gICAgICAgICAgICAgIG5nLWhpZGU9XCIkbWRBdXRvY29tcGxldGVDdHJsLmhpZGRlblwiXFxcclxuICAgICAgICAgICAgICBuZy1tb3VzZWVudGVyPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5saXN0RW50ZXIoKVwiXFxcclxuICAgICAgICAgICAgICBuZy1tb3VzZWxlYXZlPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5saXN0TGVhdmUoKVwiXFxcclxuICAgICAgICAgICAgICBuZy1tb3VzZXVwPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5tb3VzZVVwKClcIj5cXFxyXG4gICAgICAgICAgICA8bGkgbmctcmVwZWF0PVwiKGluZGV4LCBpdGVtKSBpbiAkbWRBdXRvY29tcGxldGVDdHJsLm1hdGNoZXNcIlxcXHJcbiAgICAgICAgICAgICAgICBuZy1jbGFzcz1cInsgc2VsZWN0ZWQ6IGluZGV4ID09PSAkbWRBdXRvY29tcGxldGVDdHJsLmluZGV4IH1cIlxcXHJcbiAgICAgICAgICAgICAgICBuZy1jbGljaz1cIiRtZEF1dG9jb21wbGV0ZUN0cmwuc2VsZWN0KGluZGV4KVwiXFxcclxuICAgICAgICAgICAgICAgIG1kLWF1dG9jb21wbGV0ZS1saXN0LWl0ZW09XCIkbWRBdXRvY29tcGxldGVDdHJsLml0ZW1OYW1lXCI+XFxcclxuICAgICAgICAgICAgICAgICcgKyBpdGVtVGVtcGxhdGUgKyAnXFxcclxuICAgICAgICAgICAgPC9saT5cXFxyXG4gICAgICAgICAgICAnICsgbm9JdGVtc1RlbXBsYXRlICsgJ1xcXHJcbiAgICAgICAgICA8L3VsPlxcXHJcbiAgICAgICAgPC9tZC1hdXRvY29tcGxldGUtd3JhcD5cXFxyXG4gICAgICAgIDxhcmlhLXN0YXR1c1xcXHJcbiAgICAgICAgICAgIGNsYXNzPVwibWQtdmlzdWFsbHktaGlkZGVuXCJcXFxyXG4gICAgICAgICAgICByb2xlPVwic3RhdHVzXCJcXFxyXG4gICAgICAgICAgICBhcmlhLWxpdmU9XCJhc3NlcnRpdmVcIj5cXFxyXG4gICAgICAgICAgPHAgbmctcmVwZWF0PVwibWVzc2FnZSBpbiAkbWRBdXRvY29tcGxldGVDdHJsLm1lc3NhZ2VzXCIgbmctaWY9XCJtZXNzYWdlXCI+e3ttZXNzYWdlfX08L3A+XFxcclxuICAgICAgICA8L2FyaWEtc3RhdHVzPic7XHJcblxyXG4gICAgICBmdW5jdGlvbiBnZXRJdGVtVGVtcGxhdGUoKSB7XHJcbiAgICAgICAgdmFyIHRlbXBsYXRlVGFnID0gZWxlbWVudC5maW5kKCdtZC1pdGVtLXRlbXBsYXRlJykucmVtb3ZlKCksXHJcbiAgICAgICAgICAgIGh0bWwgPSB0ZW1wbGF0ZVRhZy5sZW5ndGggPyB0ZW1wbGF0ZVRhZy5odG1sKCkgOiBlbGVtZW50Lmh0bWwoKTtcclxuICAgICAgICBpZiAoIXRlbXBsYXRlVGFnLmxlbmd0aCkgZWxlbWVudC5lbXB0eSgpO1xyXG4gICAgICAgIHJldHVybiBodG1sO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBnZXROb0l0ZW1zVGVtcGxhdGUoKSB7XHJcbiAgICAgICAgdmFyIHRlbXBsYXRlVGFnID0gZWxlbWVudC5maW5kKCdtZC1ub3QtZm91bmQnKS5yZW1vdmUoKSxcclxuICAgICAgICAgICAgdGVtcGxhdGUgPSB0ZW1wbGF0ZVRhZy5sZW5ndGggPyB0ZW1wbGF0ZVRhZy5odG1sKCkgOiAnJztcclxuICAgICAgICByZXR1cm4gdGVtcGxhdGVcclxuICAgICAgICAgICAgPyAnPGxpIG5nLWlmPVwiISRtZEF1dG9jb21wbGV0ZUN0cmwubWF0Y2hlcy5sZW5ndGggJiYgISRtZEF1dG9jb21wbGV0ZUN0cmwubG9hZGluZ1xcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAmJiAhJG1kQXV0b2NvbXBsZXRlQ3RybC5oaWRkZW5cIlxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICBuZy1oaWRlPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5oaWRkZW5cIlxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICBtZC1hdXRvY29tcGxldGUtcGFyZW50LXNjb3BlPicgKyB0ZW1wbGF0ZSArICc8L2xpPidcclxuICAgICAgICAgICAgOiAnJztcclxuXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGdldElucHV0RWxlbWVudCgpIHtcclxuICAgICAgICBpZiAoYXR0ci5tZEZsb2F0aW5nTGFiZWwpIHtcclxuICAgICAgICAgIHJldHVybiAnXFxcclxuICAgICAgICAgICAgPG1kLWlucHV0LWNvbnRhaW5lciBmbGV4IG5nLWlmPVwiZmxvYXRpbmdMYWJlbFwiPlxcXHJcbiAgICAgICAgICAgICAgPGxhYmVsPnt7ZmxvYXRpbmdMYWJlbH19PC9sYWJlbD5cXFxyXG4gICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwic2VhcmNoXCJcXFxyXG4gICAgICAgICAgICAgICAgICBpZD1cImZsLWlucHV0LXt7JG1kQXV0b2NvbXBsZXRlQ3RybC5pZH19XCJcXFxyXG4gICAgICAgICAgICAgICAgICBuYW1lPVwie3tpbnB1dE5hbWV9fVwiXFxcclxuICAgICAgICAgICAgICAgICAgYXV0b2NvbXBsZXRlPVwib2ZmXCJcXFxyXG4gICAgICAgICAgICAgICAgICBuZy1yZXF1aXJlZD1cImlzUmVxdWlyZWRcIlxcXHJcbiAgICAgICAgICAgICAgICAgIG5nLW1pbmxlbmd0aD1cImlucHV0TWlubGVuZ3RoXCJcXFxyXG4gICAgICAgICAgICAgICAgICBuZy1tYXhsZW5ndGg9XCJpbnB1dE1heGxlbmd0aFwiXFxcclxuICAgICAgICAgICAgICAgICAgbmctZGlzYWJsZWQ9XCIkbWRBdXRvY29tcGxldGVDdHJsLmlzRGlzYWJsZWRcIlxcXHJcbiAgICAgICAgICAgICAgICAgIG5nLW1vZGVsPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5zY29wZS5zZWFyY2hUZXh0XCJcXFxyXG4gICAgICAgICAgICAgICAgICBuZy1rZXlkb3duPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5rZXlkb3duKCRldmVudClcIlxcXHJcbiAgICAgICAgICAgICAgICAgIG5nLWJsdXI9XCIkbWRBdXRvY29tcGxldGVDdHJsLmJsdXIoKVwiXFxcclxuICAgICAgICAgICAgICAgICAgbmctZm9jdXM9XCIkbWRBdXRvY29tcGxldGVDdHJsLmZvY3VzKClcIlxcXHJcbiAgICAgICAgICAgICAgICAgIGFyaWEtb3ducz1cInVsLXt7JG1kQXV0b2NvbXBsZXRlQ3RybC5pZH19XCJcXFxyXG4gICAgICAgICAgICAgICAgICBhcmlhLWxhYmVsPVwie3tmbG9hdGluZ0xhYmVsfX1cIlxcXHJcbiAgICAgICAgICAgICAgICAgIGFyaWEtYXV0b2NvbXBsZXRlPVwibGlzdFwiXFxcclxuICAgICAgICAgICAgICAgICAgYXJpYS1oYXNwb3B1cD1cInRydWVcIlxcXHJcbiAgICAgICAgICAgICAgICAgIGFyaWEtYWN0aXZlZGVzY2VuZGFudD1cIlwiXFxcclxuICAgICAgICAgICAgICAgICAgYXJpYS1leHBhbmRlZD1cInt7ISRtZEF1dG9jb21wbGV0ZUN0cmwuaGlkZGVufX1cIi8+XFxcclxuICAgICAgICAgICAgICA8ZGl2IG1kLWF1dG9jb21wbGV0ZS1wYXJlbnQtc2NvcGUgbWQtYXV0b2NvbXBsZXRlLXJlcGxhY2U+JyArIGxlZnRvdmVyICsgJzwvZGl2PlxcXHJcbiAgICAgICAgICAgIDwvbWQtaW5wdXQtY29udGFpbmVyPic7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiAnXFxcclxuICAgICAgICAgICAgPGlucHV0IGZsZXggdHlwZT1cInNlYXJjaFwiXFxcclxuICAgICAgICAgICAgICAgIGlkPVwiaW5wdXQte3skbWRBdXRvY29tcGxldGVDdHJsLmlkfX1cIlxcXHJcbiAgICAgICAgICAgICAgICBuYW1lPVwie3tpbnB1dE5hbWV9fVwiXFxcclxuICAgICAgICAgICAgICAgIG5nLWlmPVwiIWZsb2F0aW5nTGFiZWxcIlxcXHJcbiAgICAgICAgICAgICAgICBhdXRvY29tcGxldGU9XCJvZmZcIlxcXHJcbiAgICAgICAgICAgICAgICBuZy1yZXF1aXJlZD1cImlzUmVxdWlyZWRcIlxcXHJcbiAgICAgICAgICAgICAgICBuZy1kaXNhYmxlZD1cIiRtZEF1dG9jb21wbGV0ZUN0cmwuaXNEaXNhYmxlZFwiXFxcclxuICAgICAgICAgICAgICAgIG5nLW1vZGVsPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5zY29wZS5zZWFyY2hUZXh0XCJcXFxyXG4gICAgICAgICAgICAgICAgbmcta2V5ZG93bj1cIiRtZEF1dG9jb21wbGV0ZUN0cmwua2V5ZG93bigkZXZlbnQpXCJcXFxyXG4gICAgICAgICAgICAgICAgbmctYmx1cj1cIiRtZEF1dG9jb21wbGV0ZUN0cmwuYmx1cigpXCJcXFxyXG4gICAgICAgICAgICAgICAgbmctZm9jdXM9XCIkbWRBdXRvY29tcGxldGVDdHJsLmZvY3VzKClcIlxcXHJcbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cInt7cGxhY2Vob2xkZXJ9fVwiXFxcclxuICAgICAgICAgICAgICAgIGFyaWEtb3ducz1cInVsLXt7JG1kQXV0b2NvbXBsZXRlQ3RybC5pZH19XCJcXFxyXG4gICAgICAgICAgICAgICAgYXJpYS1sYWJlbD1cInt7cGxhY2Vob2xkZXJ9fVwiXFxcclxuICAgICAgICAgICAgICAgIGFyaWEtYXV0b2NvbXBsZXRlPVwibGlzdFwiXFxcclxuICAgICAgICAgICAgICAgIGFyaWEtaGFzcG9wdXA9XCJ0cnVlXCJcXFxyXG4gICAgICAgICAgICAgICAgYXJpYS1hY3RpdmVkZXNjZW5kYW50PVwiXCJcXFxyXG4gICAgICAgICAgICAgICAgYXJpYS1leHBhbmRlZD1cInt7ISRtZEF1dG9jb21wbGV0ZUN0cmwuaGlkZGVufX1cIi8+XFxcclxuICAgICAgICAgICAgPGJ1dHRvblxcXHJcbiAgICAgICAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcXFxyXG4gICAgICAgICAgICAgICAgdGFiaW5kZXg9XCItMVwiXFxcclxuICAgICAgICAgICAgICAgIG5nLWlmPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5zY29wZS5zZWFyY2hUZXh0ICYmICEkbWRBdXRvY29tcGxldGVDdHJsLmlzRGlzYWJsZWRcIlxcXHJcbiAgICAgICAgICAgICAgICBuZy1jbGljaz1cIiRtZEF1dG9jb21wbGV0ZUN0cmwuY2xlYXIoKVwiPlxcXHJcbiAgICAgICAgICAgICAgPG1kLWljb24gbWQtc3ZnLWljb249XCJtZC1jbG9zZVwiPjwvbWQtaWNvbj5cXFxyXG4gICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibWQtdmlzdWFsbHktaGlkZGVuXCI+Q2xlYXI8L3NwYW4+XFxcclxuICAgICAgICAgICAgPC9idXR0b24+XFxcclxuICAgICAgICAgICAgICAgICc7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG5NZEF1dG9jb21wbGV0ZS4kaW5qZWN0ID0gW1wiJG1kVGhlbWluZ1wiLCBcIiRtZFV0aWxcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmF1dG9jb21wbGV0ZScpXHJcbiAgICAuY29udHJvbGxlcignTWRIaWdobGlnaHRDdHJsJywgTWRIaWdobGlnaHRDdHJsKTtcclxuXHJcbmZ1bmN0aW9uIE1kSGlnaGxpZ2h0Q3RybCAoJHNjb3BlLCAkZWxlbWVudCwgJGludGVycG9sYXRlKSB7XHJcbiAgdGhpcy5pbml0ID0gaW5pdDtcclxuXHJcbiAgcmV0dXJuIGluaXQoKTtcclxuXHJcbiAgZnVuY3Rpb24gaW5pdCAodGVybSkge1xyXG4gICAgdmFyIHVuc2FmZVRleHQgPSAkaW50ZXJwb2xhdGUoJGVsZW1lbnQuaHRtbCgpKSgkc2NvcGUpLFxyXG4gICAgICAgIHRleHQgPSBhbmd1bGFyLmVsZW1lbnQoJzxkaXY+JykudGV4dCh1bnNhZmVUZXh0KS5odG1sKCksXHJcbiAgICAgICAgZmxhZ3MgPSAkZWxlbWVudC5hdHRyKCdtZC1oaWdobGlnaHQtZmxhZ3MnKSB8fCAnJyxcclxuICAgICAgICB3YXRjaGVyID0gJHNjb3BlLiR3YXRjaCh0ZXJtLCBmdW5jdGlvbiAodGVybSkge1xyXG4gICAgICAgICAgdmFyIHJlZ2V4ID0gZ2V0UmVnRXhwKHRlcm0sIGZsYWdzKSxcclxuICAgICAgICAgICAgICBodG1sID0gdGV4dC5yZXBsYWNlKHJlZ2V4LCAnPHNwYW4gY2xhc3M9XCJoaWdobGlnaHRcIj4kJjwvc3Bhbj4nKTtcclxuICAgICAgICAgICRlbGVtZW50Lmh0bWwoaHRtbCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAkZWxlbWVudC5vbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7IHdhdGNoZXIoKTsgfSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBzYW5pdGl6ZSAodGVybSkge1xyXG4gICAgaWYgKCF0ZXJtKSByZXR1cm4gdGVybTtcclxuICAgIHJldHVybiB0ZXJtLnJlcGxhY2UoL1tcXFxcXFxeXFwkXFwqXFwrXFw/XFwuXFwoXFwpXFx8XFx7XFx9XFxbXFxdXS9nLCAnXFxcXCQmJyk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBnZXRSZWdFeHAgKHRleHQsIGZsYWdzKSB7XHJcbiAgICB2YXIgc3RyID0gJyc7XHJcbiAgICBpZiAoZmxhZ3MuaW5kZXhPZignXicpID49IDEpIHN0ciArPSAnXic7XHJcbiAgICBzdHIgKz0gdGV4dDtcclxuICAgIGlmIChmbGFncy5pbmRleE9mKCckJykgPj0gMSkgc3RyICs9ICckJztcclxuICAgIHJldHVybiBuZXcgUmVnRXhwKHNhbml0aXplKHN0ciksIGZsYWdzLnJlcGxhY2UoL1tcXCRcXF5dL2csICcnKSk7XHJcbiAgfVxyXG59XHJcbk1kSGlnaGxpZ2h0Q3RybC4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiJGVsZW1lbnRcIiwgXCIkaW50ZXJwb2xhdGVcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmF1dG9jb21wbGV0ZScpXHJcbiAgICAuZGlyZWN0aXZlKCdtZEhpZ2hsaWdodFRleHQnLCBNZEhpZ2hsaWdodCk7XHJcblxyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbmFtZSBtZEhpZ2hsaWdodFRleHRcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmF1dG9jb21wbGV0ZVxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogVGhlIGBtZC1oaWdobGlnaHQtdGV4dGAgZGlyZWN0aXZlIGFsbG93cyB5b3UgdG8gc3BlY2lmeSB0ZXh0IHRoYXQgc2hvdWxkIGJlIGhpZ2hsaWdodGVkIHdpdGhpblxyXG4gKiBhbiBlbGVtZW50LiAgSGlnaGxpZ2h0ZWQgdGV4dCB3aWxsIGJlIHdyYXBwZWQgaW4gYDxzcGFuIGNsYXNzPVwiaGlnaGxpZ2h0XCI+PC9zcGFuPmAgd2hpY2ggY2FuXHJcbiAqIGJlIHN0eWxlZCB0aHJvdWdoIENTUy4gIFBsZWFzZSBub3RlIHRoYXQgY2hpbGQgZWxlbWVudHMgbWF5IG5vdCBiZSB1c2VkIHdpdGggdGhpcyBkaXJlY3RpdmUuXHJcbiAqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZC1oaWdobGlnaHQtdGV4dCBBIG1vZGVsIHRvIGJlIHNlYXJjaGVkIGZvclxyXG4gKiBAcGFyYW0ge3N0cmluZz19IG1kLWhpZ2hsaWdodC1mbGFncyBBIGxpc3Qgb2YgZmxhZ3MgKGxvb3NlbHkgYmFzZWQgb24gSmF2YVNjcmlwdCBSZXhFeHAgZmxhZ3MpLlxyXG4gKiAgICAjIyMjICoqU3VwcG9ydGVkIGZsYWdzKio6XHJcbiAqICAgIC0gYGdgOiBGaW5kIGFsbCBtYXRjaGVzIHdpdGhpbiB0aGUgcHJvdmlkZWQgdGV4dFxyXG4gKiAgICAtIGBpYDogSWdub3JlIGNhc2Ugd2hlbiBzZWFyY2hpbmcgZm9yIG1hdGNoZXNcclxuICogICAgLSBgJGA6IE9ubHkgbWF0Y2ggaWYgdGhlIHRleHQgZW5kcyB3aXRoIHRoZSBzZWFyY2ggdGVybVxyXG4gKiAgICAtIGBeYDogT25seSBtYXRjaCBpZiB0aGUgdGV4dCBiZWdpbnMgd2l0aCB0aGUgc2VhcmNoIHRlcm1cclxuICpcclxuICogQHVzYWdlXHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqIDxpbnB1dCBwbGFjZWhvbGRlcj1cIkVudGVyIGEgc2VhcmNoIHRlcm0uLi5cIiBuZy1tb2RlbD1cInNlYXJjaFRlcm1cIiB0eXBlPVwidGV4dFwiIC8+XHJcbiAqIDx1bD5cclxuICogICA8bGkgbmctcmVwZWF0PVwicmVzdWx0IGluIHJlc3VsdHNcIiBtZC1oaWdobGlnaHQtdGV4dD1cInNlYXJjaFRlcm1cIj5cclxuICogICAgIHt7cmVzdWx0LnRleHR9fVxyXG4gKiAgIDwvbGk+XHJcbiAqIDwvdWw+XHJcbiAqIDwvaGxqcz5cclxuICovXHJcblxyXG5mdW5jdGlvbiBNZEhpZ2hsaWdodCAoKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHRlcm1pbmFsOiB0cnVlLFxyXG4gICAgc2NvcGU6IGZhbHNlLFxyXG4gICAgY29udHJvbGxlcjogJ01kSGlnaGxpZ2h0Q3RybCcsXHJcbiAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmwpIHtcclxuICAgICAgY3RybC5pbml0KGF0dHIubWRIaWdobGlnaHRUZXh0KTtcclxuICAgIH1cclxuICB9O1xyXG59XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmF1dG9jb21wbGV0ZScpXHJcbiAgICAuZGlyZWN0aXZlKCdtZEF1dG9jb21wbGV0ZUxpc3RJdGVtJywgTWRBdXRvY29tcGxldGVMaXN0SXRlbSk7XHJcblxyXG5mdW5jdGlvbiBNZEF1dG9jb21wbGV0ZUxpc3RJdGVtICgkY29tcGlsZSwgJG1kVXRpbCkge1xyXG4gIHJldHVybiB7XHJcbiAgICB0ZXJtaW5hbDogdHJ1ZSxcclxuICAgIGxpbms6IHBvc3RMaW5rLFxyXG4gICAgc2NvcGU6IGZhbHNlXHJcbiAgfTtcclxuICBmdW5jdGlvbiBwb3N0TGluayAoc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcclxuICAgIHZhciBjdHJsICAgICA9IHNjb3BlLiRwYXJlbnQuJG1kQXV0b2NvbXBsZXRlQ3RybCxcclxuICAgICAgICBuZXdTY29wZSA9IGN0cmwucGFyZW50LiRuZXcoZmFsc2UsIGN0cmwucGFyZW50KSxcclxuICAgICAgICBpdGVtTmFtZSA9IGN0cmwuc2NvcGUuJGV2YWwoYXR0ci5tZEF1dG9jb21wbGV0ZUxpc3RJdGVtKTtcclxuICAgIG5ld1Njb3BlW2l0ZW1OYW1lXSA9IHNjb3BlLml0ZW07XHJcbiAgICAkY29tcGlsZShlbGVtZW50LmNvbnRlbnRzKCkpKG5ld1Njb3BlKTtcclxuICAgIGVsZW1lbnQuYXR0cih7XHJcbiAgICAgIHJvbGU6ICdvcHRpb24nLFxyXG4gICAgICBpZDogJ2l0ZW1fJyArICRtZFV0aWwubmV4dFVpZCgpXHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuTWRBdXRvY29tcGxldGVMaXN0SXRlbS4kaW5qZWN0ID0gW1wiJGNvbXBpbGVcIiwgXCIkbWRVdGlsXCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5hdXRvY29tcGxldGUnKVxyXG4gICAgLmRpcmVjdGl2ZSgnbWRBdXRvY29tcGxldGVQYXJlbnRTY29wZScsIE1kQXV0b2NvbXBsZXRlUGFyZW50U2NvcGUpO1xyXG5cclxuZnVuY3Rpb24gTWRBdXRvY29tcGxldGVQYXJlbnRTY29wZSAoJGNvbXBpbGUsICRtZFV0aWwpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgIHRlcm1pbmFsOiB0cnVlLFxyXG4gICAgbGluazogcG9zdExpbmssXHJcbiAgICBzY29wZTogZmFsc2VcclxuICB9O1xyXG4gIGZ1bmN0aW9uIHBvc3RMaW5rIChzY29wZSwgZWxlbWVudCwgYXR0cikge1xyXG4gICAgdmFyIGN0cmwgICAgID0gc2NvcGUuJHBhcmVudC4kbWRBdXRvY29tcGxldGVDdHJsO1xyXG4gICAgJGNvbXBpbGUoZWxlbWVudC5jb250ZW50cygpKShjdHJsLnBhcmVudCk7XHJcbiAgICBpZiAoYXR0ci5oYXNPd25Qcm9wZXJ0eSgnbWRBdXRvY29tcGxldGVSZXBsYWNlJykpIHtcclxuICAgICAgZWxlbWVudC5hZnRlcihlbGVtZW50LmNvbnRlbnRzKCkpO1xyXG4gICAgICBlbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5NZEF1dG9jb21wbGV0ZVBhcmVudFNjb3BlLiRpbmplY3QgPSBbXCIkY29tcGlsZVwiLCBcIiRtZFV0aWxcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmNoaXBzJylcclxuICAgIC5kaXJlY3RpdmUoJ21kQ2hpcCcsIE1kQ2hpcCk7XHJcblxyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbmFtZSBtZENoaXBcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmNoaXBzXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBgPG1kLWNoaXA+YCBpcyBhIGNvbXBvbmVudCB1c2VkIHdpdGhpbiBgPG1kLWNoaXBzPmAgYW5kIGlzIHJlc3BvbnNpYmxlIGZvciByZW5kZXJpbmcgaW5kaXZpZHVhbFxyXG4gKiBjaGlwcy5cclxuICpcclxuICpcclxuICogQHVzYWdlXHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqICAgPG1kLWNoaXA+e3skY2hpcH19PC9tZC1jaGlwPlxyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqL1xyXG5cclxuLy8gVGhpcyBoaW50IHRleHQgaXMgaGlkZGVuIHdpdGhpbiBhIGNoaXAgYnV0IHVzZWQgYnkgc2NyZWVuIHJlYWRlcnMgdG9cclxuLy8gaW5mb3JtIHRoZSB1c2VyIGhvdyB0aGV5IGNhbiBpbnRlcmFjdCB3aXRoIGEgY2hpcC5cclxudmFyIERFTEVURV9ISU5UX1RFTVBMQVRFID0gJ1xcXHJcbiAgICA8c3BhbiBuZy1pZj1cIiEkbWRDaGlwc0N0cmwucmVhZG9ubHlcIiBjbGFzcz1cIm1kLXZpc3VhbGx5LWhpZGRlblwiPlxcXHJcbiAgICAgIHt7JG1kQ2hpcHNDdHJsLmRlbGV0ZUhpbnR9fVxcXHJcbiAgICA8L3NwYW4+JztcclxuXHJcbi8qKlxyXG4gKiBNRENoaXAgRGlyZWN0aXZlIERlZmluaXRpb25cclxuICpcclxuICogQHBhcmFtICRtZFRoZW1pbmdcclxuICogQHBhcmFtICRtZElua1JpcHBsZVxyXG4gKiBAbmdJbmplY3RcclxuICovXHJcbmZ1bmN0aW9uIE1kQ2hpcCgkbWRUaGVtaW5nKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICByZXF1aXJlOiAnXj9tZENoaXBzJyxcclxuICAgIGNvbXBpbGU6ICBjb21waWxlXHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb24gY29tcGlsZShlbGVtZW50LCBhdHRyKSB7XHJcbiAgICBlbGVtZW50LmFwcGVuZChERUxFVEVfSElOVF9URU1QTEFURSk7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmwpIHtcclxuICAgICAgZWxlbWVudC5hZGRDbGFzcygnbWQtY2hpcCcpO1xyXG4gICAgICAkbWRUaGVtaW5nKGVsZW1lbnQpO1xyXG5cclxuICAgICAgaWYgKGN0cmwpIGFuZ3VsYXIuZWxlbWVudChlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJy5tZC1jaGlwLWNvbnRlbnQnKSlcclxuICAgICAgICAgIC5vbignYmx1cicsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY3RybC5zZWxlY3RlZENoaXAgPSAtMTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgfTtcclxuICB9XHJcbn1cclxuTWRDaGlwLiRpbmplY3QgPSBbXCIkbWRUaGVtaW5nXCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5jaGlwcycpXHJcbiAgICAuZGlyZWN0aXZlKCdtZENoaXBSZW1vdmUnLCBNZENoaXBSZW1vdmUpO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRDaGlwUmVtb3ZlXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5jaGlwc1xyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogYDxtZC1jaGlwLXJlbW92ZT5gXHJcbiAqIERlc2lnbmF0ZXMgYW4gZWxlbWVudCB0byBiZSB1c2VkIGFzIHRoZSBkZWxldGUgYnV0dG9uIGZvciBhIGNoaXAuIFRoaXNcclxuICogZWxlbWVudCBpcyBwYXNzZWQgYXMgYSBjaGlsZCBvZiB0aGUgYG1kLWNoaXBzYCBlbGVtZW50LlxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogICA8bWQtY2hpcHM+PGJ1dHRvbiBtZC1jaGlwLXJlbW92ZT5ERUw8L2J1dHRvbj48L21kLWNoaXBzPlxyXG4gKiA8L2hsanM+XHJcbiAqL1xyXG5cclxuXHJcbi8qKlxyXG4gKiBNZENoaXBSZW1vdmUgRGlyZWN0aXZlIERlZmluaXRpb24uXHJcbiAqIFxyXG4gKiBAcGFyYW0gJGNvbXBpbGVcclxuICogQHBhcmFtICR0aW1lb3V0XHJcbiAqIEByZXR1cm5zIHt7cmVzdHJpY3Q6IHN0cmluZywgcmVxdWlyZTogc3RyaW5nW10sIGxpbms6IEZ1bmN0aW9uLCBzY29wZTogYm9vbGVhbn19XHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gTWRDaGlwUmVtb3ZlICgkdGltZW91dCkge1xyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgcmVxdWlyZTogJ15tZENoaXBzJyxcclxuICAgIHNjb3BlOiBmYWxzZSxcclxuICAgIGxpbms6IHBvc3RMaW5rXHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmwpIHtcclxuICAgIGVsZW1lbnQub24oJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGN0cmwucmVtb3ZlQ2hpcChzY29wZS4kJHJlcGxhY2VkU2NvcGUuJGluZGV4KTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBDaGlsZCBlbGVtZW50cyBhcmVuJ3QgYXZhaWxhYmxlIHVudGlsIGFmdGVyIGEgJHRpbWVvdXQgdGljayBhcyB0aGV5IGFyZSBoaWRkZW4gYnkgYW5cclxuICAgIC8vIGBuZy1pZmAuIHNlZSBodHRwOi8vZ29vLmdsL3pJV2Z1d1xyXG4gICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgIGVsZW1lbnQuYXR0cih7IHRhYmluZGV4OiAtMSwgYXJpYUhpZGRlbjogdHJ1ZSB9KTtcclxuICAgICAgZWxlbWVudC5maW5kKCdidXR0b24nKS5hdHRyKCd0YWJpbmRleCcsICctMScpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbk1kQ2hpcFJlbW92ZS4kaW5qZWN0ID0gW1wiJHRpbWVvdXRcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmNoaXBzJylcclxuICAgIC5kaXJlY3RpdmUoJ21kQ2hpcFRyYW5zY2x1ZGUnLCBNZENoaXBUcmFuc2NsdWRlKTtcclxuXHJcbmZ1bmN0aW9uIE1kQ2hpcFRyYW5zY2x1ZGUgKCRjb21waWxlLCAkbWRVdGlsKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRUEnLFxyXG4gICAgdGVybWluYWw6IHRydWUsXHJcbiAgICBsaW5rOiBsaW5rLFxyXG4gICAgc2NvcGU6IGZhbHNlXHJcbiAgfTtcclxuICBmdW5jdGlvbiBsaW5rIChzY29wZSwgZWxlbWVudCwgYXR0cikge1xyXG4gICAgdmFyIGN0cmwgPSBzY29wZS4kcGFyZW50LiRtZENoaXBzQ3RybCxcclxuICAgICAgICBuZXdTY29wZSA9IGN0cmwucGFyZW50LiRuZXcoZmFsc2UsIGN0cmwucGFyZW50KTtcclxuICAgIG5ld1Njb3BlLiQkcmVwbGFjZWRTY29wZSA9IHNjb3BlO1xyXG4gICAgbmV3U2NvcGUuJGNoaXAgPSBzY29wZS4kY2hpcDtcclxuICAgIG5ld1Njb3BlLiRtZENoaXBzQ3RybCA9IGN0cmw7XHJcbiAgICBlbGVtZW50Lmh0bWwoY3RybC4kc2NvcGUuJGV2YWwoYXR0ci5tZENoaXBUcmFuc2NsdWRlKSk7XHJcbiAgICAkY29tcGlsZShlbGVtZW50LmNvbnRlbnRzKCkpKG5ld1Njb3BlKTtcclxuICB9XHJcbn1cclxuTWRDaGlwVHJhbnNjbHVkZS4kaW5qZWN0ID0gW1wiJGNvbXBpbGVcIiwgXCIkbWRVdGlsXCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5jaGlwcycpXHJcbiAgICAuY29udHJvbGxlcignTWRDaGlwc0N0cmwnLCBNZENoaXBzQ3RybCk7XHJcblxyXG4vKipcclxuICogQ29udHJvbGxlciBmb3IgdGhlIE1kQ2hpcHMgY29tcG9uZW50LiBSZXNwb25zaWJsZSBmb3IgYWRkaW5nIHRvIGFuZFxyXG4gKiByZW1vdmluZyBmcm9tIHRoZSBsaXN0IG9mIGNoaXBzLCBtYXJraW5nIGNoaXBzIGFzIHNlbGVjdGVkLCBhbmQgYmluZGluZyB0b1xyXG4gKiB0aGUgbW9kZWxzIG9mIHZhcmlvdXMgaW5wdXQgY29tcG9uZW50cy5cclxuICpcclxuICogQHBhcmFtICRzY29wZVxyXG4gKiBAcGFyYW0gJG1kQ29uc3RhbnRcclxuICogQHBhcmFtICRsb2dcclxuICogQHBhcmFtICRlbGVtZW50XHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gTWRDaGlwc0N0cmwgKCRzY29wZSwgJG1kQ29uc3RhbnQsICRsb2csICRlbGVtZW50LCAkdGltZW91dCkge1xyXG4gIC8qKiBAdHlwZSB7JHRpbWVvdXR9ICoqL1xyXG4gIHRoaXMuJHRpbWVvdXQgPSAkdGltZW91dDtcclxuXHJcbiAgLyoqIEB0eXBlIHtPYmplY3R9ICovXHJcbiAgdGhpcy4kbWRDb25zdGFudCA9ICRtZENvbnN0YW50O1xyXG5cclxuICAvKiogQHR5cGUge2FuZ3VsYXIuJHNjb3BlfSAqL1xyXG4gIHRoaXMuJHNjb3BlID0gJHNjb3BlO1xyXG5cclxuICAvKiogQHR5cGUge2FuZ3VsYXIuJHNjb3BlfSAqL1xyXG4gIHRoaXMucGFyZW50ID0gJHNjb3BlLiRwYXJlbnQ7XHJcblxyXG4gIC8qKiBAdHlwZSB7JGxvZ30gKi9cclxuICB0aGlzLiRsb2cgPSAkbG9nO1xyXG5cclxuICAvKiogQHR5cGUgeyRlbGVtZW50fSAqL1xyXG4gIHRoaXMuJGVsZW1lbnQgPSAkZWxlbWVudDtcclxuXHJcbiAgLyoqIEB0eXBlIHthbmd1bGFyLk5nTW9kZWxDb250cm9sbGVyfSAqL1xyXG4gIHRoaXMubmdNb2RlbEN0cmwgPSBudWxsO1xyXG5cclxuICAvKiogQHR5cGUge2FuZ3VsYXIuTmdNb2RlbENvbnRyb2xsZXJ9ICovXHJcbiAgdGhpcy51c2VySW5wdXROZ01vZGVsQ3RybCA9IG51bGw7XHJcblxyXG4gIC8qKiBAdHlwZSB7RWxlbWVudH0gKi9cclxuICB0aGlzLnVzZXJJbnB1dEVsZW1lbnQgPSBudWxsO1xyXG5cclxuICAvKiogQHR5cGUge0FycmF5LjxPYmplY3Q+fSAqL1xyXG4gIHRoaXMuaXRlbXMgPSBbXTtcclxuXHJcbiAgLyoqIEB0eXBlIHtudW1iZXJ9ICovXHJcbiAgdGhpcy5zZWxlY3RlZENoaXAgPSAtMTtcclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEhpZGRlbiBoaW50IHRleHQgZm9yIGhvdyB0byBkZWxldGUgYSBjaGlwLiBVc2VkIHRvIGdpdmUgY29udGV4dCB0byBzY3JlZW4gcmVhZGVycy5cclxuICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAqL1xyXG4gIHRoaXMuZGVsZXRlSGludCA9ICdQcmVzcyBkZWxldGUgdG8gcmVtb3ZlIHRoaXMgY2hpcC4nO1xyXG5cclxuICAvKipcclxuICAgKiBIaWRkZW4gbGFiZWwgZm9yIHRoZSBkZWxldGUgYnV0dG9uLiBVc2VkIHRvIGdpdmUgY29udGV4dCB0byBzY3JlZW4gcmVhZGVycy5cclxuICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAqL1xyXG4gIHRoaXMuZGVsZXRlQnV0dG9uTGFiZWwgPSAnUmVtb3ZlJztcclxuXHJcbiAgLyoqXHJcbiAgICogTW9kZWwgdXNlZCBieSB0aGUgaW5wdXQgZWxlbWVudC5cclxuICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAqL1xyXG4gIHRoaXMuY2hpcEJ1ZmZlciA9ICcnO1xyXG5cclxuICAvKipcclxuICAgKiBXaGV0aGVyIHRvIHVzZSB0aGUgbWRPbkFwcGVuZCBleHByZXNzaW9uIHRvIHRyYW5zZm9ybSB0aGUgY2hpcCBidWZmZXJcclxuICAgKiBiZWZvcmUgYXBwZW5kaW5nIGl0IHRvIHRoZSBsaXN0LlxyXG4gICAqIEB0eXBlIHtib29sZWFufVxyXG4gICAqL1xyXG4gIHRoaXMudXNlTWRPbkFwcGVuZCA9IGZhbHNlO1xyXG59XHJcbk1kQ2hpcHNDdHJsLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkbWRDb25zdGFudFwiLCBcIiRsb2dcIiwgXCIkZWxlbWVudFwiLCBcIiR0aW1lb3V0XCJdO1xyXG5cclxuLyoqXHJcbiAqIEhhbmRsZXMgdGhlIGtleWRvd24gZXZlbnQgb24gdGhlIGlucHV0IGVsZW1lbnQ6IDxlbnRlcj4gYXBwZW5kcyB0aGVcclxuICogYnVmZmVyIHRvIHRoZSBjaGlwIGxpc3QsIHdoaWxlIGJhY2tzcGFjZSByZW1vdmVzIHRoZSBsYXN0IGNoaXAgaW4gdGhlIGxpc3RcclxuICogaWYgdGhlIGN1cnJlbnQgYnVmZmVyIGlzIGVtcHR5LlxyXG4gKiBAcGFyYW0gZXZlbnRcclxuICovXHJcbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS5pbnB1dEtleWRvd24gPSBmdW5jdGlvbihldmVudCkge1xyXG4gIHZhciBjaGlwQnVmZmVyID0gdGhpcy5nZXRDaGlwQnVmZmVyKCk7XHJcbiAgc3dpdGNoIChldmVudC5rZXlDb2RlKSB7XHJcbiAgICBjYXNlIHRoaXMuJG1kQ29uc3RhbnQuS0VZX0NPREUuRU5URVI6XHJcbiAgICAgIGlmICh0aGlzLiRzY29wZS5yZXF1aXJlTWF0Y2ggfHwgIWNoaXBCdWZmZXIpIGJyZWFrO1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLmFwcGVuZENoaXAoY2hpcEJ1ZmZlcik7XHJcbiAgICAgIHRoaXMucmVzZXRDaGlwQnVmZmVyKCk7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSB0aGlzLiRtZENvbnN0YW50LktFWV9DT0RFLkJBQ0tTUEFDRTpcclxuICAgICAgaWYgKGNoaXBCdWZmZXIpIGJyZWFrO1xyXG4gICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgaWYgKHRoaXMuaXRlbXMubGVuZ3RoKSB0aGlzLnNlbGVjdEFuZEZvY3VzQ2hpcFNhZmUodGhpcy5pdGVtcy5sZW5ndGggLSAxKTtcclxuICAgICAgYnJlYWs7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEhhbmRsZXMgdGhlIGtleWRvd24gZXZlbnQgb24gdGhlIGNoaXAgZWxlbWVudHM6IGJhY2tzcGFjZSByZW1vdmVzIHRoZSBzZWxlY3RlZCBjaGlwLCBhcnJvd1xyXG4gKiBrZXlzIHN3aXRjaCB3aGljaCBjaGlwcyBpcyBhY3RpdmVcclxuICogQHBhcmFtIGV2ZW50XHJcbiAqL1xyXG5NZENoaXBzQ3RybC5wcm90b3R5cGUuY2hpcEtleWRvd24gPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICBpZiAodGhpcy5nZXRDaGlwQnVmZmVyKCkpIHJldHVybjtcclxuICBzd2l0Y2ggKGV2ZW50LmtleUNvZGUpIHtcclxuICAgIGNhc2UgdGhpcy4kbWRDb25zdGFudC5LRVlfQ09ERS5CQUNLU1BBQ0U6XHJcbiAgICBjYXNlIHRoaXMuJG1kQ29uc3RhbnQuS0VZX0NPREUuREVMRVRFOlxyXG4gICAgICBpZiAodGhpcy5zZWxlY3RlZENoaXAgPCAwKSByZXR1cm47XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMucmVtb3ZlQW5kU2VsZWN0QWRqYWNlbnRDaGlwKHRoaXMuc2VsZWN0ZWRDaGlwKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlIHRoaXMuJG1kQ29uc3RhbnQuS0VZX0NPREUuTEVGVF9BUlJPVzpcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRDaGlwIDwgMCkgdGhpcy5zZWxlY3RlZENoaXAgPSB0aGlzLml0ZW1zLmxlbmd0aDtcclxuICAgICAgaWYgKHRoaXMuaXRlbXMubGVuZ3RoKSB0aGlzLnNlbGVjdEFuZEZvY3VzQ2hpcFNhZmUodGhpcy5zZWxlY3RlZENoaXAgLSAxKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlIHRoaXMuJG1kQ29uc3RhbnQuS0VZX0NPREUuUklHSFRfQVJST1c6XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuc2VsZWN0QW5kRm9jdXNDaGlwU2FmZSh0aGlzLnNlbGVjdGVkQ2hpcCArIDEpO1xyXG4gICAgICBicmVhaztcclxuICAgIGNhc2UgdGhpcy4kbWRDb25zdGFudC5LRVlfQ09ERS5FU0NBUEU6XHJcbiAgICBjYXNlIHRoaXMuJG1kQ29uc3RhbnQuS0VZX0NPREUuVEFCOlxyXG4gICAgICBpZiAodGhpcy5zZWxlY3RlZENoaXAgPCAwKSByZXR1cm47XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMub25Gb2N1cygpO1xyXG4gICAgICBicmVhaztcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogR2V0IHRoZSBpbnB1dCdzIHBsYWNlaG9sZGVyIC0gdXNlcyBgcGxhY2Vob2xkZXJgIHdoZW4gbGlzdCBpcyBlbXB0eSBhbmQgYHNlY29uZGFyeS1wbGFjZWhvbGRlcmBcclxuICogd2hlbiB0aGUgbGlzdCBpcyBub24tZW1wdHkuIElmIGBzZWNvbmRhcnktcGxhY2Vob2xkZXJgIGlzIG5vdCBwcm92aWRlZCwgYHBsYWNlaG9sZGVyYCBpcyB1c2VkXHJcbiAqIGFsd2F5cy5cclxuICovXHJcbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS5nZXRQbGFjZWhvbGRlciA9IGZ1bmN0aW9uKCkge1xyXG4gIC8vIEFsbG93IGBzZWNvbmRhcnktcGxhY2Vob2xkZXJgIHRvIGJlIGJsYW5rLlxyXG4gIHZhciB1c2VTZWNvbmRhcnkgPSAodGhpcy5pdGVtcy5sZW5ndGggJiZcclxuICAgICAgKHRoaXMuc2Vjb25kYXJ5UGxhY2Vob2xkZXIgPT0gJycgfHwgdGhpcy5zZWNvbmRhcnlQbGFjZWhvbGRlcikpO1xyXG4gIHJldHVybiB1c2VTZWNvbmRhcnkgPyB0aGlzLnBsYWNlaG9sZGVyIDogdGhpcy5zZWNvbmRhcnlQbGFjZWhvbGRlcjtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBSZW1vdmVzIGNoaXAgYXQge0Bjb2RlIGluZGV4fSBhbmQgc2VsZWN0cyB0aGUgYWRqYWNlbnQgY2hpcC5cclxuICogQHBhcmFtIGluZGV4XHJcbiAqL1xyXG5NZENoaXBzQ3RybC5wcm90b3R5cGUucmVtb3ZlQW5kU2VsZWN0QWRqYWNlbnRDaGlwID0gZnVuY3Rpb24oaW5kZXgpIHtcclxuICB2YXIgc2VsSW5kZXggPSB0aGlzLmdldEFkamFjZW50Q2hpcEluZGV4KGluZGV4KTtcclxuICB0aGlzLnJlbW92ZUNoaXAoaW5kZXgpO1xyXG4gIHRoaXMuJHRpbWVvdXQoYW5ndWxhci5iaW5kKHRoaXMsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5zZWxlY3RBbmRGb2N1c0NoaXBTYWZlKHNlbEluZGV4KTtcclxuICB9KSk7XHJcbn07XHJcblxyXG4vKipcclxuICogU2V0cyB0aGUgc2VsZWN0ZWQgY2hpcCBpbmRleCB0byAtMS5cclxuICovXHJcbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS5yZXNldFNlbGVjdGVkQ2hpcCA9IGZ1bmN0aW9uKCkge1xyXG4gIHRoaXMuc2VsZWN0ZWRDaGlwID0gLTE7XHJcbn07XHJcblxyXG4vKipcclxuICogR2V0cyB0aGUgaW5kZXggb2YgYW4gYWRqYWNlbnQgY2hpcCB0byBzZWxlY3QgYWZ0ZXIgZGVsZXRpb24uIEFkamFjZW5jeSBpc1xyXG4gKiBkZXRlcm1pbmVkIGFzIHRoZSBuZXh0IGNoaXAgaW4gdGhlIGxpc3QsIHVubGVzcyB0aGUgdGFyZ2V0IGNoaXAgaXMgdGhlXHJcbiAqIGxhc3QgaW4gdGhlIGxpc3QsIHRoZW4gaXQgaXMgdGhlIGNoaXAgaW1tZWRpYXRlbHkgcHJlY2VkaW5nIHRoZSB0YXJnZXQuIElmXHJcbiAqIHRoZXJlIGlzIG9ubHkgb25lIGl0ZW0gaW4gdGhlIGxpc3QsIC0xIGlzIHJldHVybmVkIChzZWxlY3Qgbm9uZSkuXHJcbiAqIFRoZSBudW1iZXIgcmV0dXJuZWQgaXMgdGhlIGluZGV4IHRvIHNlbGVjdCBBRlRFUiB0aGUgdGFyZ2V0IGhhcyBiZWVuXHJcbiAqIHJlbW92ZWQuXHJcbiAqIElmIHRoZSBjdXJyZW50IGNoaXAgaXMgbm90IHNlbGVjdGVkLCB0aGVuIC0xIGlzIHJldHVybmVkIHRvIHNlbGVjdCBub25lLlxyXG4gKi9cclxuTWRDaGlwc0N0cmwucHJvdG90eXBlLmdldEFkamFjZW50Q2hpcEluZGV4ID0gZnVuY3Rpb24oaW5kZXgpIHtcclxuICB2YXIgbGVuID0gdGhpcy5pdGVtcy5sZW5ndGggLSAxO1xyXG4gIHJldHVybiAobGVuID09IDApID8gLTEgOlxyXG4gICAgICAoaW5kZXggPT0gbGVuKSA/IGluZGV4IC0xIDogaW5kZXg7XHJcbn07XHJcblxyXG4vKipcclxuICogQXBwZW5kIHRoZSBjb250ZW50cyBvZiB0aGUgYnVmZmVyIHRvIHRoZSBjaGlwIGxpc3QuIFRoaXMgbWV0aG9kIHdpbGwgZmlyc3RcclxuICogY2FsbCBvdXQgdG8gdGhlIG1kLW9uLWFwcGVuZCBtZXRob2QsIGlmIHByb3ZpZGVkXHJcbiAqIEBwYXJhbSBuZXdDaGlwXHJcbiAqL1xyXG5NZENoaXBzQ3RybC5wcm90b3R5cGUuYXBwZW5kQ2hpcCA9IGZ1bmN0aW9uKG5ld0NoaXApIHtcclxuICBpZiAodGhpcy5pdGVtcy5pbmRleE9mKG5ld0NoaXApICsgMSkgcmV0dXJuO1xyXG4gIGlmICh0aGlzLnVzZU1kT25BcHBlbmQgJiYgdGhpcy5tZE9uQXBwZW5kKSB7XHJcbiAgICBuZXdDaGlwID0gdGhpcy5tZE9uQXBwZW5kKHsnJGNoaXAnOiBuZXdDaGlwfSk7XHJcbiAgfVxyXG4gIHRoaXMuaXRlbXMucHVzaChuZXdDaGlwKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBTZXRzIHdoZXRoZXIgdG8gdXNlIHRoZSBtZC1vbi1hcHBlbmQgZXhwcmVzc2lvbi4gVGhpcyBleHByZXNzaW9uIGlzXHJcbiAqIGJvdW5kIHRvIHNjb3BlIGFuZCBjb250cm9sbGVyIGluIHtAY29kZSBNZENoaXBzRGlyZWN0aXZlfSBhc1xyXG4gKiB7QGNvZGUgbWRPbkFwcGVuZH0uIER1ZSB0byB0aGUgbmF0dXJlIG9mIGRpcmVjdGl2ZSBzY29wZSBiaW5kaW5ncywgdGhlXHJcbiAqIGNvbnRyb2xsZXIgY2Fubm90IGtub3cgb24gaXRzIG93bi9mcm9tIHRoZSBzY29wZSB3aGV0aGVyIGFuIGV4cHJlc3Npb24gd2FzXHJcbiAqIGFjdHVhbGx5IHByb3ZpZGVkLlxyXG4gKi9cclxuTWRDaGlwc0N0cmwucHJvdG90eXBlLnVzZU1kT25BcHBlbmRFeHByZXNzaW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgdGhpcy51c2VNZE9uQXBwZW5kID0gdHJ1ZTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBHZXRzIHRoZSBpbnB1dCBidWZmZXIuIFRoZSBpbnB1dCBidWZmZXIgY2FuIGJlIHRoZSBtb2RlbCBib3VuZCB0byB0aGVcclxuICogZGVmYXVsdCBpbnB1dCBpdGVtIHtAY29kZSB0aGlzLmNoaXBCdWZmZXJ9LCB0aGUge0Bjb2RlIHNlbGVjdGVkSXRlbX1cclxuICogbW9kZWwgb2YgYW4ge0Bjb2RlIG1kLWF1dG9jb21wbGV0ZX0sIG9yLCB0aHJvdWdoIHNvbWUgbWFnaWMsIHRoZSBtb2RlbFxyXG4gKiBib3VuZCB0byBhbnkgaW5wcHV0IG9yIHRleHQgYXJlYSBlbGVtZW50IGZvdW5kIHdpdGhpbiBhXHJcbiAqIHtAY29kZSBtZC1pbnB1dC1jb250YWluZXJ9IGVsZW1lbnQuXHJcbiAqIEByZXR1cm4ge09iamVjdHxzdHJpbmd9XHJcbiAqL1xyXG5NZENoaXBzQ3RybC5wcm90b3R5cGUuZ2V0Q2hpcEJ1ZmZlciA9IGZ1bmN0aW9uKCkge1xyXG4gIHJldHVybiAhdGhpcy51c2VySW5wdXRFbGVtZW50ID8gdGhpcy5jaGlwQnVmZmVyIDpcclxuICAgICAgdGhpcy51c2VySW5wdXROZ01vZGVsQ3RybCA/IHRoaXMudXNlcklucHV0TmdNb2RlbEN0cmwuJHZpZXdWYWx1ZSA6XHJcbiAgICAgICAgICB0aGlzLnVzZXJJbnB1dEVsZW1lbnRbMF0udmFsdWU7XHJcbn07XHJcblxyXG4vKipcclxuICogUmVzZXRzIHRoZSBpbnB1dCBidWZmZXIgZm9yIGVpdGhlciB0aGUgaW50ZXJuYWwgaW5wdXQgb3IgdXNlciBwcm92aWRlZCBpbnB1dCBlbGVtZW50LlxyXG4gKi9cclxuTWRDaGlwc0N0cmwucHJvdG90eXBlLnJlc2V0Q2hpcEJ1ZmZlciA9IGZ1bmN0aW9uKCkge1xyXG4gIGlmICh0aGlzLnVzZXJJbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICh0aGlzLnVzZXJJbnB1dE5nTW9kZWxDdHJsKSB7XHJcbiAgICAgIHRoaXMudXNlcklucHV0TmdNb2RlbEN0cmwuJHNldFZpZXdWYWx1ZSgnJyk7XHJcbiAgICAgIHRoaXMudXNlcklucHV0TmdNb2RlbEN0cmwuJHJlbmRlcigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy51c2VySW5wdXRFbGVtZW50WzBdLnZhbHVlID0gJyc7XHJcbiAgICB9XHJcbiAgfSBlbHNlIHtcclxuICAgIHRoaXMuY2hpcEJ1ZmZlciA9ICcnO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBSZW1vdmVzIHRoZSBjaGlwIGF0IHRoZSBnaXZlbiBpbmRleC5cclxuICogQHBhcmFtIGluZGV4XHJcbiAqL1xyXG5NZENoaXBzQ3RybC5wcm90b3R5cGUucmVtb3ZlQ2hpcCA9IGZ1bmN0aW9uKGluZGV4KSB7XHJcbiAgdGhpcy5pdGVtcy5zcGxpY2UoaW5kZXgsIDEpO1xyXG59O1xyXG5cclxuTWRDaGlwc0N0cmwucHJvdG90eXBlLnJlbW92ZUNoaXBBbmRGb2N1c0lucHV0ID0gZnVuY3Rpb24gKGluZGV4KSB7XHJcbiAgdGhpcy5yZW1vdmVDaGlwKGluZGV4KTtcclxuICB0aGlzLm9uRm9jdXMoKTtcclxufTtcclxuLyoqXHJcbiAqIFNlbGVjdHMgdGhlIGNoaXAgYXQgYGluZGV4YCxcclxuICogQHBhcmFtIGluZGV4XHJcbiAqL1xyXG5NZENoaXBzQ3RybC5wcm90b3R5cGUuc2VsZWN0QW5kRm9jdXNDaGlwU2FmZSA9IGZ1bmN0aW9uKGluZGV4KSB7XHJcbiAgaWYgKCF0aGlzLml0ZW1zLmxlbmd0aCkge1xyXG4gICAgdGhpcy5zZWxlY3RDaGlwKC0xKTtcclxuICAgIHRoaXMub25Gb2N1cygpO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBpZiAoaW5kZXggPT09IHRoaXMuaXRlbXMubGVuZ3RoKSByZXR1cm4gdGhpcy5vbkZvY3VzKCk7XHJcbiAgaW5kZXggPSBNYXRoLm1heChpbmRleCwgMCk7XHJcbiAgaW5kZXggPSBNYXRoLm1pbihpbmRleCwgdGhpcy5pdGVtcy5sZW5ndGggLSAxKTtcclxuICB0aGlzLnNlbGVjdENoaXAoaW5kZXgpO1xyXG4gIHRoaXMuZm9jdXNDaGlwKGluZGV4KTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBNYXJrcyB0aGUgY2hpcCBhdCB0aGUgZ2l2ZW4gaW5kZXggYXMgc2VsZWN0ZWQuXHJcbiAqIEBwYXJhbSBpbmRleFxyXG4gKi9cclxuTWRDaGlwc0N0cmwucHJvdG90eXBlLnNlbGVjdENoaXAgPSBmdW5jdGlvbihpbmRleCkge1xyXG4gIGlmIChpbmRleCA+PSAtMSAmJiBpbmRleCA8PSB0aGlzLml0ZW1zLmxlbmd0aCkge1xyXG4gICAgdGhpcy5zZWxlY3RlZENoaXAgPSBpbmRleDtcclxuICB9IGVsc2Uge1xyXG4gICAgdGhpcy4kbG9nLndhcm4oJ1NlbGVjdGVkIENoaXAgaW5kZXggb3V0IG9mIGJvdW5kczsgaWdub3JpbmcuJyk7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIFNlbGVjdHMgdGhlIGNoaXAgYXQgYGluZGV4YCBhbmQgZ2l2ZXMgaXQgZm9jdXMuXHJcbiAqIEBwYXJhbSBpbmRleFxyXG4gKi9cclxuTWRDaGlwc0N0cmwucHJvdG90eXBlLnNlbGVjdEFuZEZvY3VzQ2hpcCA9IGZ1bmN0aW9uKGluZGV4KSB7XHJcbiAgdGhpcy5zZWxlY3RDaGlwKGluZGV4KTtcclxuICBpZiAoaW5kZXggIT0gLTEpIHtcclxuICAgIHRoaXMuZm9jdXNDaGlwKGluZGV4KTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogQ2FsbCBgZm9jdXMoKWAgb24gdGhlIGNoaXAgYXQgYGluZGV4YFxyXG4gKi9cclxuTWRDaGlwc0N0cmwucHJvdG90eXBlLmZvY3VzQ2hpcCA9IGZ1bmN0aW9uKGluZGV4KSB7XHJcbiAgdGhpcy4kZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCdtZC1jaGlwW2luZGV4PVwiJyArIGluZGV4ICsgJ1wiXSAubWQtY2hpcC1jb250ZW50JykuZm9jdXMoKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBDb25maWd1cmVzIHRoZSByZXF1aXJlZCBpbnRlcmFjdGlvbnMgd2l0aCB0aGUgbmdNb2RlbCBDb250cm9sbGVyLlxyXG4gKiBTcGVjaWZpY2FsbHksIHNldCB7QGNvZGUgdGhpcy5pdGVtc30gdG8gdGhlIHtAY29kZSBOZ01vZGVsQ3RybCMkdmlld1ZhbGV9LlxyXG4gKiBAcGFyYW0gbmdNb2RlbEN0cmxcclxuICovXHJcbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS5jb25maWd1cmVOZ01vZGVsID0gZnVuY3Rpb24obmdNb2RlbEN0cmwpIHtcclxuICB0aGlzLm5nTW9kZWxDdHJsID0gbmdNb2RlbEN0cmw7XHJcblxyXG4gIHZhciBzZWxmID0gdGhpcztcclxuICBuZ01vZGVsQ3RybC4kcmVuZGVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAvLyBtb2RlbCBpcyB1cGRhdGVkLiBkbyBzb21ldGhpbmcuXHJcbiAgICBzZWxmLml0ZW1zID0gc2VsZi5uZ01vZGVsQ3RybC4kdmlld1ZhbHVlO1xyXG4gIH07XHJcbn07XHJcblxyXG5NZENoaXBzQ3RybC5wcm90b3R5cGUub25Gb2N1cyA9IGZ1bmN0aW9uICgpIHtcclxuICB2YXIgaW5wdXQgPSB0aGlzLiRlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0Jyk7XHJcbiAgaW5wdXQgJiYgaW5wdXQuZm9jdXMoKTtcclxuICB0aGlzLnJlc2V0U2VsZWN0ZWRDaGlwKCk7XHJcbn07XHJcblxyXG5NZENoaXBzQ3RybC5wcm90b3R5cGUub25JbnB1dEZvY3VzID0gZnVuY3Rpb24gKCkge1xyXG4gIHRoaXMuaW5wdXRIYXNGb2N1cyA9IHRydWU7XHJcbiAgdGhpcy5yZXNldFNlbGVjdGVkQ2hpcCgpO1xyXG59O1xyXG5cclxuTWRDaGlwc0N0cmwucHJvdG90eXBlLm9uSW5wdXRCbHVyID0gZnVuY3Rpb24gKCkge1xyXG4gIHRoaXMuaW5wdXRIYXNGb2N1cyA9IGZhbHNlO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIENvbmZpZ3VyZSBldmVudCBiaW5kaW5ncyBvbiBhIHVzZXItcHJvdmlkZWQgaW5wdXQgZWxlbWVudC5cclxuICogQHBhcmFtIGlucHV0RWxlbWVudFxyXG4gKi9cclxuTWRDaGlwc0N0cmwucHJvdG90eXBlLmNvbmZpZ3VyZVVzZXJJbnB1dCA9IGZ1bmN0aW9uKGlucHV0RWxlbWVudCkge1xyXG4gIHRoaXMudXNlcklucHV0RWxlbWVudCA9IGlucHV0RWxlbWVudDtcclxuXHJcbiAgLy8gRmluZCB0aGUgTmdNb2RlbEN0cmwgZm9yIHRoZSBpbnB1dCBlbGVtZW50XHJcbiAgdmFyIG5nTW9kZWxDdHJsID0gaW5wdXRFbGVtZW50LmNvbnRyb2xsZXIoJ25nTW9kZWwnKTtcclxuICAvLyBgLmNvbnRyb2xsZXJgIHdpbGwgbG9vayBpbiB0aGUgcGFyZW50IGFzIHdlbGwuXHJcbiAgaWYgKG5nTW9kZWxDdHJsICE9IHRoaXMubmdNb2RlbEN0cmwpIHtcclxuICAgIHRoaXMudXNlcklucHV0TmdNb2RlbEN0cmwgPSBuZ01vZGVsQ3RybDtcclxuICB9XHJcblxyXG4gIC8vIEJpbmQgdG8ga2V5ZG93biBhbmQgZm9jdXMgZXZlbnRzIG9mIGlucHV0XHJcbiAgdmFyIHNjb3BlID0gdGhpcy4kc2NvcGU7XHJcbiAgdmFyIGN0cmwgPSB0aGlzO1xyXG4gIGlucHV0RWxlbWVudFxyXG4gICAgICAuYXR0cih7IHRhYmluZGV4OiAwIH0pXHJcbiAgICAgIC5vbigna2V5ZG93bicsIGZ1bmN0aW9uKGV2ZW50KSB7IHNjb3BlLiRhcHBseSggYW5ndWxhci5iaW5kKGN0cmwsIGZ1bmN0aW9uKCkgeyBjdHJsLmlucHV0S2V5ZG93bihldmVudCk7IH0pKSB9KVxyXG4gICAgICAub24oJ2ZvY3VzJywgYW5ndWxhci5iaW5kKGN0cmwsIGN0cmwub25JbnB1dEZvY3VzKSlcclxuICAgICAgLm9uKCdibHVyJywgYW5ndWxhci5iaW5kKGN0cmwsIGN0cmwub25JbnB1dEJsdXIpKTtcclxufTtcclxuXHJcbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS5jb25maWd1cmVBdXRvY29tcGxldGUgPSBmdW5jdGlvbihjdHJsKSB7XHJcblxyXG4gIGN0cmwucmVnaXN0ZXJTZWxlY3RlZEl0ZW1XYXRjaGVyKGFuZ3VsYXIuYmluZCh0aGlzLCBmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgaWYgKGl0ZW0pIHtcclxuICAgICAgdGhpcy5hcHBlbmRDaGlwKGl0ZW0pO1xyXG4gICAgICB0aGlzLnJlc2V0Q2hpcEJ1ZmZlcigpO1xyXG4gICAgfVxyXG4gIH0pKTtcclxuXHJcbiAgdGhpcy4kZWxlbWVudC5maW5kKCdpbnB1dCcpXHJcbiAgICAgIC5vbignZm9jdXMnLGFuZ3VsYXIuYmluZCh0aGlzLCB0aGlzLm9uSW5wdXRGb2N1cykgKVxyXG4gICAgICAub24oJ2JsdXInLCBhbmd1bGFyLmJpbmQodGhpcywgdGhpcy5vbklucHV0Qmx1cikgKTtcclxufTtcclxuXHJcbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS5oYXNGb2N1cyA9IGZ1bmN0aW9uICgpIHtcclxuICByZXR1cm4gdGhpcy5pbnB1dEhhc0ZvY3VzIHx8IHRoaXMuc2VsZWN0ZWRDaGlwID49IDA7XHJcbn07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gIGFuZ3VsYXJcclxuICAgICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5jaGlwcycpXHJcbiAgICAgIC5kaXJlY3RpdmUoJ21kQ2hpcHMnLCBNZENoaXBzKTtcclxuXHJcbiAgLyoqXHJcbiAgICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gICAqIEBuYW1lIG1kQ2hpcHNcclxuICAgKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuY2hpcHNcclxuICAgKlxyXG4gICAqIEBkZXNjcmlwdGlvblxyXG4gICAqIGA8bWQtY2hpcHM+YCBpcyBhbiBpbnB1dCBjb21wb25lbnQgZm9yIGJ1aWxkaW5nIGxpc3RzIG9mIHN0cmluZ3Mgb3Igb2JqZWN0cy4gVGhlIGxpc3QgaXRlbXMgYXJlXHJcbiAgICogZGlzcGxheWVkIGFzICdjaGlwcycuIFRoaXMgY29tcG9uZW50IGNhbiBtYWtlIHVzZSBvZiBhbiBgPGlucHV0PmAgZWxlbWVudCBvciBhblxyXG4gICAqIGA8bWQtYXV0b2NvbXBsZXRlPmAgZWxlbWVudC5cclxuICAgKlxyXG4gICAqIDxzdHJvbmc+Q3VzdG9tIGA8bWQtY2hpcC10ZW1wbGF0ZT5gIHRlbXBsYXRlPC9zdHJvbmc+XHJcbiAgICogQSBjdXN0b20gdGVtcGxhdGUgbWF5IGJlIHByb3ZpZGVkIHRvIHJlbmRlciB0aGUgY29udGVudCBvZiBlYWNoIGNoaXAuIFRoaXMgaXMgYWNoaWV2ZWQgYnlcclxuICAgKiBzcGVjaWZ5aW5nIGFuIGA8bWQtY2hpcC10ZW1wbGF0ZT5gIGVsZW1lbnQgYXMgYSBjaGlsZCBvZiBgPG1kLWNoaXBzPmAuIE5vdGU6IEFueSBhdHRyaWJ1dGVzIG9uXHJcbiAgICogYDxtZC1jaGlwLXRlbXBsYXRlPmAgd2lsbCBiZSBkcm9wcGVkIGFzIG9ubHkgdGhlIGlubmVySFRNTCBpcyB1c2VkIGZvciB0aGUgY2hpcCB0ZW1wbGF0ZS4gVGhlXHJcbiAgICogdmFyaWFibGVzIGAkY2hpcGAgYW5kIGAkaW5kZXhgIGFyZSBhdmFpbGFibGUgaW4gdGhlIHNjb3BlIG9mIGA8bWQtY2hpcC10ZW1wbGF0ZT5gLCByZXByZXNlbnRpbmdcclxuICAgKiB0aGUgY2hpcCBvYmplY3QgYW5kIGl0cyBpbmRleCBpbiB0aGUgbGlzdCBvZiBjaGlwcywgcmVzcGVjdGl2ZWx5LlxyXG4gICAqIFRvIG92ZXJyaWRlIHRoZSBjaGlwIGRlbGV0ZSBjb250cm9sLCBpbmNsdWRlIGFuIGVsZW1lbnQgKGlkZWFsbHkgYSBidXR0b24pIHdpdGggdGhlIGF0dHJpYnV0ZVxyXG4gICAqIGBtZC1jaGlwLXJlbW92ZWAuIEEgY2xpY2sgbGlzdGVuZXIgdG8gcmVtb3ZlIHRoZSBjaGlwIHdpbGwgYmUgYWRkZWQgYXV0b21hdGljYWxseS4gVGhlIGVsZW1lbnRcclxuICAgKiBpcyBhbHNvIHBsYWNlZCBhcyBhIHNpYmxpbmcgdG8gdGhlIGNoaXAgY29udGVudCAob24gd2hpY2ggdGhlcmUgYXJlIGFsc28gY2xpY2sgbGlzdGVuZXJzKSB0b1xyXG4gICAqIGF2b2lkIGEgbmVzdGVkIG5nLWNsaWNrIHNpdHVhdGlvbi5cclxuICAgKlxyXG4gICAqIDxoMz4gUGVuZGluZyBGZWF0dXJlcyA8L2gzPlxyXG4gICAqIDx1bCBzdHlsZT1cInBhZGRpbmctbGVmdDoyMHB4O1wiPlxyXG4gICAqXHJcbiAgICogICA8dWw+U3R5bGVcclxuICAgKiAgICAgPGxpPkNvbG91cnMgZm9yIGhvdmVyLCBwcmVzcyBzdGF0ZXMgKHJpcHBsZT8pLjwvbGk+XHJcbiAgICogICA8L3VsPlxyXG4gICAqXHJcbiAgICogICA8dWw+TGlzdCBNYW5pcHVsYXRpb25cclxuICAgKiAgICAgPGxpPmRlbGV0ZSBpdGVtIHZpYSBERUwgb3IgYmFja3NwYWNlIGtleXMgd2hlbiBzZWxlY3RlZDwvbGk+XHJcbiAgICogICA8L3VsPlxyXG4gICAqXHJcbiAgICogICA8dWw+VmFsaWRhdGlvblxyXG4gICAqICAgICA8bGk+ZGUtZHVwZSB2YWx1ZXMgKG9yIHN1cHBvcnQgZHVwbGljYXRlcywgYnV0IGZpeCB0aGUgbmctcmVwZWF0IGR1cGxpY2F0ZSBrZXkgaXNzdWUpPC9saT5cclxuICAgKiAgICAgPGxpPmFsbG93IGEgdmFsaWRhdGlvbiBjYWxsYmFjazwvbGk+XHJcbiAgICogICAgIDxsaT5oaWxpZ2h0aW5nIHN0eWxlIGZvciBpbnZhbGlkIGNoaXBzPC9saT5cclxuICAgKiAgIDwvdWw+XHJcbiAgICpcclxuICAgKiAgIDx1bD5JdGVtIG11dGF0aW9uXHJcbiAgICogICAgIDxsaT5TdXBwb3J0IGBcclxuICAgKiAgICAgICA8bWQtY2hpcC1lZGl0PmAgdGVtcGxhdGUsIHNob3cvaGlkZSB0aGUgZWRpdCBlbGVtZW50IG9uIHRhcC9jbGljaz8gZG91YmxlIHRhcC9kb3VibGVcclxuICAgKiAgICAgICBjbGljaz9cclxuICAgKiAgICAgPC9saT5cclxuICAgKiAgIDwvdWw+XHJcbiAgICpcclxuICAgKiAgIDx1bD5UcnVuY2F0aW9uIGFuZCBEaXNhbWJpZ3VhdGlvbiAoPylcclxuICAgKiAgICAgPGxpPlRydW5jYXRlIGNoaXAgdGV4dCB3aGVyZSBwb3NzaWJsZSwgYnV0IGRvIG5vdCB0cnVuY2F0ZSBlbnRyaWVzIHN1Y2ggdGhhdCB0d28gYXJlXHJcbiAgICogICAgIGluZGlzdGluZ3Vpc2hhYmxlLjwvbGk+XHJcbiAgICogICA8L3VsPlxyXG4gICAqXHJcbiAgICogICA8dWw+RHJhZyBhbmQgRHJvcFxyXG4gICAqICAgICA8bGk+RHJhZyBhbmQgZHJvcCBjaGlwcyBiZXR3ZWVuIHJlbGF0ZWQgYDxtZC1jaGlwcz5gIGVsZW1lbnRzLlxyXG4gICAqICAgICA8L2xpPlxyXG4gICAqICAgPC91bD5cclxuICAgKiA8L3VsPlxyXG4gICAqXHJcbiAgICogIDxzcGFuIHN0eWxlPVwiZm9udC1zaXplOi44ZW07dGV4dC1hbGlnbjpjZW50ZXJcIj5cclxuICAgKiAgICBXYXJuaW5nOiBUaGlzIGNvbXBvbmVudCBpcyBhIFdPUksgSU4gUFJPR1JFU1MuIElmIHlvdSB1c2UgaXQgbm93LFxyXG4gICAqICAgIGl0IHdpbGwgcHJvYmFibHkgYnJlYWsgb24geW91IGluIHRoZSBmdXR1cmUuXHJcbiAgICogIDwvc3Bhbj5cclxuICAgKlxyXG4gICAqIEBwYXJhbSB7c3RyaW5nPXxvYmplY3Q9fSBuZy1tb2RlbCBBIG1vZGVsIHRvIGJpbmQgdGhlIGxpc3Qgb2YgaXRlbXMgdG9cclxuICAgKiBAcGFyYW0ge3N0cmluZz19IHBsYWNlaG9sZGVyIFBsYWNlaG9sZGVyIHRleHQgdGhhdCB3aWxsIGJlIGZvcndhcmRlZCB0byB0aGUgaW5wdXQuXHJcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBzZWNvbmRhcnktcGxhY2Vob2xkZXIgUGxhY2Vob2xkZXIgdGV4dCB0aGF0IHdpbGwgYmUgZm9yd2FyZGVkIHRvIHRoZSBpbnB1dCxcclxuICAgKiAgICBkaXNwbGF5ZWQgd2hlbiB0aGVyZSBpcyBhdCBsZWFzdCBvbiBpdGVtIGluIHRoZSBsaXN0XHJcbiAgICogQHBhcmFtIHtib29sZWFuPX0gcmVhZG9ubHkgRGlzYWJsZXMgbGlzdCBtYW5pcHVsYXRpb24gKGRlbGV0aW5nIG9yIGFkZGluZyBsaXN0IGl0ZW1zKSwgaGlkaW5nXHJcbiAgICogICAgdGhlIGlucHV0IGFuZCBkZWxldGUgYnV0dG9uc1xyXG4gICAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbWQtb24tYXBwZW5kIEFuIGV4cHJlc3Npb24gZXhwZWN0ZWQgdG8gY29udmVydCB0aGUgaW5wdXQgc3RyaW5nIGludG8gYW5cclxuICAgKiAgICBvYmplY3Qgd2hlbiBhZGRpbmcgYSBjaGlwLlxyXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gZGVsZXRlLWhpbnQgQSBzdHJpbmcgcmVhZCBieSBzY3JlZW4gcmVhZGVycyBpbnN0cnVjdGluZyB1c2VycyB0aGF0IHByZXNzaW5nXHJcbiAgICogICAgdGhlIGRlbGV0ZSBrZXkgd2lsbCByZW1vdmUgdGhlIGNoaXAuXHJcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBkZWxldGUtYnV0dG9uLWxhYmVsIEEgbGFiZWwgZm9yIHRoZSBkZWxldGUgYnV0dG9uLiBBbHNvIGhpZGRlbiBhbmQgcmVhZCBieVxyXG4gICAqICAgIHNjcmVlbiByZWFkZXJzLlxyXG4gICAqXHJcbiAgICogQHVzYWdlXHJcbiAgICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICAgKiAgIDxtZC1jaGlwc1xyXG4gICAqICAgICAgIG5nLW1vZGVsPVwibXlJdGVtc1wiXHJcbiAgICogICAgICAgcGxhY2Vob2xkZXI9XCJBZGQgYW4gaXRlbVwiXHJcbiAgICogICAgICAgcmVhZG9ubHk9XCJpc1JlYWRPbmx5XCI+XHJcbiAgICogICA8L21kLWNoaXBzPlxyXG4gICAqIDwvaGxqcz5cclxuICAgKlxyXG4gICAqL1xyXG5cclxuXHJcbiAgdmFyIE1EX0NISVBTX1RFTVBMQVRFID0gJ1xcXHJcbiAgICAgIDxtZC1jaGlwcy13cmFwXFxcclxuICAgICAgICAgIG5nLWlmPVwiISRtZENoaXBzQ3RybC5yZWFkb25seSB8fCAkbWRDaGlwc0N0cmwuaXRlbXMubGVuZ3RoID4gMFwiXFxcclxuICAgICAgICAgIG5nLWtleWRvd249XCIkbWRDaGlwc0N0cmwuY2hpcEtleWRvd24oJGV2ZW50KVwiXFxcclxuICAgICAgICAgIG5nLWNsYXNzPVwieyBcXCdtZC1mb2N1c2VkXFwnOiAkbWRDaGlwc0N0cmwuaGFzRm9jdXMoKSB9XCJcXFxyXG4gICAgICAgICAgY2xhc3M9XCJtZC1jaGlwc1wiPlxcXHJcbiAgICAgICAgPG1kLWNoaXAgbmctcmVwZWF0PVwiJGNoaXAgaW4gJG1kQ2hpcHNDdHJsLml0ZW1zXCJcXFxyXG4gICAgICAgICAgICBpbmRleD1cInt7JGluZGV4fX1cIlxcXHJcbiAgICAgICAgICAgIG5nLWNsYXNzPVwie1xcJ21kLWZvY3VzZWRcXCc6ICRtZENoaXBzQ3RybC5zZWxlY3RlZENoaXAgPT0gJGluZGV4fVwiPlxcXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwibWQtY2hpcC1jb250ZW50XCJcXFxyXG4gICAgICAgICAgICAgIHRhYmluZGV4PVwiLTFcIlxcXHJcbiAgICAgICAgICAgICAgYXJpYS1oaWRkZW49XCJ0cnVlXCJcXFxyXG4gICAgICAgICAgICAgIG5nLWZvY3VzPVwiISRtZENoaXBzQ3RybC5yZWFkb25seSAmJiAkbWRDaGlwc0N0cmwuc2VsZWN0Q2hpcCgkaW5kZXgpXCJcXFxyXG4gICAgICAgICAgICAgIG1kLWNoaXAtdHJhbnNjbHVkZT1cIiRtZENoaXBzQ3RybC5jaGlwQ29udGVudHNUZW1wbGF0ZVwiPjwvZGl2PlxcXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwibWQtY2hpcC1yZW1vdmUtY29udGFpbmVyXCJcXFxyXG4gICAgICAgICAgICAgIG1kLWNoaXAtdHJhbnNjbHVkZT1cIiRtZENoaXBzQ3RybC5jaGlwUmVtb3ZlVGVtcGxhdGVcIj48L2Rpdj5cXFxyXG4gICAgICAgIDwvbWQtY2hpcD5cXFxyXG4gICAgICAgIDxkaXYgbmctaWY9XCIhJG1kQ2hpcHNDdHJsLnJlYWRvbmx5ICYmICRtZENoaXBzQ3RybC5uZ01vZGVsQ3RybFwiXFxcclxuICAgICAgICAgICAgY2xhc3M9XCJtZC1jaGlwLWlucHV0LWNvbnRhaW5lclwiXFxcclxuICAgICAgICAgICAgbWQtY2hpcC10cmFuc2NsdWRlPVwiJG1kQ2hpcHNDdHJsLmNoaXBJbnB1dFRlbXBsYXRlXCI+PC9kaXY+XFxcclxuICAgICAgICA8L2Rpdj5cXFxyXG4gICAgICA8L21kLWNoaXBzLXdyYXA+JztcclxuXHJcbiAgdmFyIENISVBfSU5QVVRfVEVNUExBVEUgPSAnXFxcclxuICAgICAgICA8aW5wdXRcXFxyXG4gICAgICAgICAgICB0YWJpbmRleD1cIjBcIlxcXHJcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwie3skbWRDaGlwc0N0cmwuZ2V0UGxhY2Vob2xkZXIoKX19XCJcXFxyXG4gICAgICAgICAgICBhcmlhLWxhYmVsPVwie3skbWRDaGlwc0N0cmwuZ2V0UGxhY2Vob2xkZXIoKX19XCJcXFxyXG4gICAgICAgICAgICBuZy1tb2RlbD1cIiRtZENoaXBzQ3RybC5jaGlwQnVmZmVyXCJcXFxyXG4gICAgICAgICAgICBuZy1mb2N1cz1cIiRtZENoaXBzQ3RybC5vbklucHV0Rm9jdXMoKVwiXFxcclxuICAgICAgICAgICAgbmctYmx1cj1cIiRtZENoaXBzQ3RybC5vbklucHV0Qmx1cigpXCJcXFxyXG4gICAgICAgICAgICBuZy1rZXlkb3duPVwiJG1kQ2hpcHNDdHJsLmlucHV0S2V5ZG93bigkZXZlbnQpXCI+JztcclxuXHJcbiAgdmFyIENISVBfREVGQVVMVF9URU1QTEFURSA9ICdcXFxyXG4gICAgICA8c3Bhbj57eyRjaGlwfX08L3NwYW4+JztcclxuXHJcbiAgdmFyIENISVBfUkVNT1ZFX1RFTVBMQVRFID0gJ1xcXHJcbiAgICAgIDxidXR0b25cXFxyXG4gICAgICAgICAgY2xhc3M9XCJtZC1jaGlwLXJlbW92ZVwiXFxcclxuICAgICAgICAgIG5nLWlmPVwiISRtZENoaXBzQ3RybC5yZWFkb25seVwiXFxcclxuICAgICAgICAgIG5nLWNsaWNrPVwiJG1kQ2hpcHNDdHJsLnJlbW92ZUNoaXBBbmRGb2N1c0lucHV0KCQkcmVwbGFjZWRTY29wZS4kaW5kZXgpXCJcXFxyXG4gICAgICAgICAgdHlwZT1cImJ1dHRvblwiXFxcclxuICAgICAgICAgIGFyaWEtaGlkZGVuPVwidHJ1ZVwiXFxcclxuICAgICAgICAgIHRhYmluZGV4PVwiLTFcIj5cXFxyXG4gICAgICAgIDxtZC1pY29uIG1kLXN2Zy1pY29uPVwibWQtY2xvc2VcIj48L21kLWljb24+XFxcclxuICAgICAgICA8c3BhbiBjbGFzcz1cIm1kLXZpc3VhbGx5LWhpZGRlblwiPlxcXHJcbiAgICAgICAgICB7eyRtZENoaXBzQ3RybC5kZWxldGVCdXR0b25MYWJlbH19XFxcclxuICAgICAgICA8L3NwYW4+XFxcclxuICAgICAgPC9idXR0b24+JztcclxuXHJcbiAgLyoqXHJcbiAgICogTURDaGlwcyBEaXJlY3RpdmUgRGVmaW5pdGlvblxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIE1kQ2hpcHMgKCRtZFRoZW1pbmcsICRtZFV0aWwsICRjb21waWxlLCAkbG9nLCAkdGltZW91dCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdGVtcGxhdGU6IGZ1bmN0aW9uKGVsZW1lbnQsIGF0dHJzKSB7XHJcbiAgICAgICAgLy8gQ2xvbmUgdGhlIGVsZW1lbnQgaW50byBhbiBhdHRyaWJ1dGUuIEJ5IHByZXBlbmRpbmcgdGhlIGF0dHJpYnV0ZVxyXG4gICAgICAgIC8vIG5hbWUgd2l0aCAnJCcsIEFuZ3VsYXIgd29uJ3Qgd3JpdGUgaXQgaW50byB0aGUgRE9NLiBUaGUgY2xvbmVkXHJcbiAgICAgICAgLy8gZWxlbWVudCBwcm9wYWdhdGVzIHRvIHRoZSBsaW5rIGZ1bmN0aW9uIHZpYSB0aGUgYXR0cnMgYXJndW1lbnQsXHJcbiAgICAgICAgLy8gd2hlcmUgdmFyaW91cyBjb250YWluZWQtZWxlbWVudHMgY2FuIGJlIGNvbnN1bWVkLlxyXG4gICAgICAgIHZhciBjb250ZW50ID0gYXR0cnNbJyRtZFVzZXJUZW1wbGF0ZSddID0gZWxlbWVudC5jbG9uZSgpO1xyXG4gICAgICAgIHJldHVybiBNRF9DSElQU19URU1QTEFURTtcclxuICAgICAgfSxcclxuICAgICAgcmVxdWlyZTogWydtZENoaXBzJ10sXHJcbiAgICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICAgIGNvbnRyb2xsZXI6ICdNZENoaXBzQ3RybCcsXHJcbiAgICAgIGNvbnRyb2xsZXJBczogJyRtZENoaXBzQ3RybCcsXHJcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXHJcbiAgICAgIGNvbXBpbGU6IGNvbXBpbGUsXHJcbiAgICAgIHNjb3BlOiB7XHJcbiAgICAgICAgcmVhZG9ubHk6ICc9cmVhZG9ubHknLFxyXG4gICAgICAgIHBsYWNlaG9sZGVyOiAnQCcsXHJcbiAgICAgICAgc2Vjb25kYXJ5UGxhY2Vob2xkZXI6ICdAJyxcclxuICAgICAgICBtZE9uQXBwZW5kOiAnJicsXHJcbiAgICAgICAgZGVsZXRlSGludDogJ0AnLFxyXG4gICAgICAgIGRlbGV0ZUJ1dHRvbkxhYmVsOiAnQCcsXHJcbiAgICAgICAgcmVxdWlyZU1hdGNoOiAnPT9tZFJlcXVpcmVNYXRjaCdcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEJ1aWxkcyB0aGUgZmluYWwgdGVtcGxhdGUgZm9yIGBtZC1jaGlwc2AgYW5kIHJldHVybnMgdGhlIHBvc3RMaW5rIGZ1bmN0aW9uLlxyXG4gICAgICpcclxuICAgICAqIEJ1aWxkaW5nIHRoZSB0ZW1wbGF0ZSBpbnZvbHZlcyAzIGtleSBjb21wb25lbnRzOlxyXG4gICAgICogc3RhdGljIGNoaXBzXHJcbiAgICAgKiBjaGlwIHRlbXBsYXRlXHJcbiAgICAgKiBpbnB1dCBjb250cm9sXHJcbiAgICAgKlxyXG4gICAgICogSWYgbm8gYG5nLW1vZGVsYCBpcyBwcm92aWRlZCwgb25seSB0aGUgc3RhdGljIGNoaXAgd29yayBuZWVkcyB0byBiZSBkb25lLlxyXG4gICAgICpcclxuICAgICAqIElmIG5vIHVzZXItcGFzc2VkIGBtZC1jaGlwLXRlbXBsYXRlYCBleGlzdHMsIHRoZSBkZWZhdWx0IHRlbXBsYXRlIGlzIHVzZWQuIFRoaXMgcmVzdWx0aW5nXHJcbiAgICAgKiB0ZW1wbGF0ZSBpcyBhcHBlbmRlZCB0byB0aGUgY2hpcCBjb250ZW50IGVsZW1lbnQuXHJcbiAgICAgKlxyXG4gICAgICogVGhlIHJlbW92ZSBidXR0b24gbWF5IGJlIG92ZXJyaWRkZW4gYnkgcGFzc2luZyBhbiBlbGVtZW50IHdpdGggYW4gbWQtY2hpcC1yZW1vdmUgYXR0cmlidXRlLlxyXG4gICAgICpcclxuICAgICAqIElmIGFuIGBpbnB1dGAgb3IgYG1kLWF1dG9jb21wbGV0ZWAgZWxlbWVudCBpcyBwcm92aWRlZCBieSB0aGUgY2FsbGVyLCBpdCBpcyBzZXQgYXNpZGUgZm9yXHJcbiAgICAgKiB0cmFuc2NsdXNpb24gbGF0ZXIuIFRoZSB0cmFuc2NsdXNpb24gaGFwcGVucyBpbiBgcG9zdExpbmtgIGFzIHRoZSBwYXJlbnQgc2NvcGUgaXMgcmVxdWlyZWQuXHJcbiAgICAgKiBJZiBubyB1c2VyIGlucHV0IGlzIHByb3ZpZGVkLCBhIGRlZmF1bHQgb25lIGlzIGFwcGVuZGVkIHRvIHRoZSBpbnB1dCBjb250YWluZXIgbm9kZSBpbiB0aGVcclxuICAgICAqIHRlbXBsYXRlLlxyXG4gICAgICpcclxuICAgICAqIFN0YXRpYyBDaGlwcyAoaS5lLiBgbWQtY2hpcGAgZWxlbWVudHMgcGFzc2VkIGZyb20gdGhlIGNhbGxlcikgYXJlIGdhdGhlcmVkIGFuZCBzZXQgYXNpZGUgZm9yXHJcbiAgICAgKiB0cmFuc2NsdXNpb24gaW4gdGhlIGBwb3N0TGlua2AgZnVuY3Rpb24uXHJcbiAgICAgKlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBlbGVtZW50XHJcbiAgICAgKiBAcGFyYW0gYXR0clxyXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBjb21waWxlKGVsZW1lbnQsIGF0dHIpIHtcclxuICAgICAgLy8gR3JhYiB0aGUgdXNlciB0ZW1wbGF0ZSBmcm9tIGF0dHIgYW5kIHJlc2V0IHRoZSBhdHRyaWJ1dGUgdG8gbnVsbC5cclxuICAgICAgdmFyIHVzZXJUZW1wbGF0ZSA9IGF0dHJbJyRtZFVzZXJUZW1wbGF0ZSddO1xyXG4gICAgICBhdHRyWyckbWRVc2VyVGVtcGxhdGUnXSA9IG51bGw7XHJcblxyXG4gICAgICAvLyBTZXQgdGhlIGNoaXAgcmVtb3ZlLCBjaGlwIGNvbnRlbnRzIGFuZCBjaGlwIGlucHV0IHRlbXBsYXRlcy4gVGhlIGxpbmsgZnVuY3Rpb24gd2lsbCBwdXRcclxuICAgICAgLy8gdGhlbSBvbiB0aGUgc2NvcGUgZm9yIHRyYW5zY2x1c2lvbiBsYXRlci5cclxuICAgICAgdmFyIGNoaXBSZW1vdmVUZW1wbGF0ZSAgID0gZ2V0VGVtcGxhdGVCeVF1ZXJ5KCdtZC1jaGlwcz4qW21kLWNoaXAtcmVtb3ZlXScpIHx8IENISVBfUkVNT1ZFX1RFTVBMQVRFLFxyXG4gICAgICAgICAgY2hpcENvbnRlbnRzVGVtcGxhdGUgPSBnZXRUZW1wbGF0ZUJ5UXVlcnkoJ21kLWNoaXBzPm1kLWNoaXAtdGVtcGxhdGUnKSB8fCBDSElQX0RFRkFVTFRfVEVNUExBVEUsXHJcbiAgICAgICAgICBjaGlwSW5wdXRUZW1wbGF0ZSAgICA9IGdldFRlbXBsYXRlQnlRdWVyeSgnbWQtY2hpcHM+bWQtYXV0b2NvbXBsZXRlJylcclxuICAgICAgICAgICAgICB8fCBnZXRUZW1wbGF0ZUJ5UXVlcnkoJ21kLWNoaXBzPmlucHV0JylcclxuICAgICAgICAgICAgICB8fCBDSElQX0lOUFVUX1RFTVBMQVRFLFxyXG4gICAgICAgICAgc3RhdGljQ2hpcHMgPSB1c2VyVGVtcGxhdGUuZmluZCgnbWQtY2hpcCcpO1xyXG5cclxuICAgICAgLy8gV2FybiBvZiBtYWxmb3JtZWQgdGVtcGxhdGUuIFNlZSAjMjU0NVxyXG4gICAgICBpZiAodXNlclRlbXBsYXRlWzBdLnF1ZXJ5U2VsZWN0b3IoJ21kLWNoaXAtdGVtcGxhdGU+KlttZC1jaGlwLXJlbW92ZV0nKSkge1xyXG4gICAgICAgICRsb2cud2FybignaW52YWxpZCBwbGFjZW1lbnQgb2YgbWQtY2hpcC1yZW1vdmUgd2l0aGluIG1kLWNoaXAtdGVtcGxhdGUuJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGdldFRlbXBsYXRlQnlRdWVyeSAocXVlcnkpIHtcclxuICAgICAgICBpZiAoIWF0dHIubmdNb2RlbCkgcmV0dXJuO1xyXG4gICAgICAgIHZhciBlbGVtZW50ID0gdXNlclRlbXBsYXRlWzBdLnF1ZXJ5U2VsZWN0b3IocXVlcnkpO1xyXG4gICAgICAgIHJldHVybiBlbGVtZW50ICYmIGVsZW1lbnQub3V0ZXJIVE1MO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvKipcclxuICAgICAgICogQ29uZmlndXJlcyBjb250cm9sbGVyIGFuZCB0cmFuc2NsdWRlcy5cclxuICAgICAgICovXHJcbiAgICAgIHJldHVybiBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMsIGNvbnRyb2xsZXJzKSB7XHJcblxyXG4gICAgICAgICRtZFV0aWwuaW5pdE9wdGlvbmFsUHJvcGVydGllcyhzY29wZSwgYXR0cik7XHJcblxyXG4gICAgICAgICRtZFRoZW1pbmcoZWxlbWVudCk7XHJcbiAgICAgICAgdmFyIG1kQ2hpcHNDdHJsID0gY29udHJvbGxlcnNbMF07XHJcbiAgICAgICAgbWRDaGlwc0N0cmwuY2hpcENvbnRlbnRzVGVtcGxhdGUgPSBjaGlwQ29udGVudHNUZW1wbGF0ZTtcclxuICAgICAgICBtZENoaXBzQ3RybC5jaGlwUmVtb3ZlVGVtcGxhdGUgICA9IGNoaXBSZW1vdmVUZW1wbGF0ZTtcclxuICAgICAgICBtZENoaXBzQ3RybC5jaGlwSW5wdXRUZW1wbGF0ZSAgICA9IGNoaXBJbnB1dFRlbXBsYXRlO1xyXG5cclxuICAgICAgICBlbGVtZW50XHJcbiAgICAgICAgICAgIC5hdHRyKHsgYXJpYUhpZGRlbjogdHJ1ZSwgdGFiaW5kZXg6IC0xIH0pXHJcbiAgICAgICAgICAgIC5vbignZm9jdXMnLCBmdW5jdGlvbiAoKSB7IG1kQ2hpcHNDdHJsLm9uRm9jdXMoKTsgfSk7XHJcblxyXG4gICAgICAgIGlmIChhdHRyLm5nTW9kZWwpIHtcclxuICAgICAgICAgIG1kQ2hpcHNDdHJsLmNvbmZpZ3VyZU5nTW9kZWwoZWxlbWVudC5jb250cm9sbGVyKCduZ01vZGVsJykpO1xyXG5cclxuICAgICAgICAgIC8vIElmIGFuIGBtZC1vbi1hcHBlbmRgIGF0dHJpYnV0ZSB3YXMgc2V0LCB0ZWxsIHRoZSBjb250cm9sbGVyIHRvIHVzZSB0aGUgZXhwcmVzc2lvblxyXG4gICAgICAgICAgLy8gd2hlbiBhcHBlbmRpbmcgY2hpcHMuXHJcbiAgICAgICAgICBpZiAoYXR0cnMubWRPbkFwcGVuZCkgbWRDaGlwc0N0cmwudXNlTWRPbkFwcGVuZEV4cHJlc3Npb24oKTtcclxuXHJcbiAgICAgICAgICAvLyBUaGUgbWQtYXV0b2NvbXBsZXRlIGFuZCBpbnB1dCBlbGVtZW50cyB3b24ndCBiZSBjb21waWxlZCB1bnRpbCBhZnRlciB0aGlzIGRpcmVjdGl2ZVxyXG4gICAgICAgICAgLy8gaXMgY29tcGxldGUgKGR1ZSB0byB0aGVpciBuZXN0ZWQgbmF0dXJlKS4gV2FpdCBhIHRpY2sgYmVmb3JlIGxvb2tpbmcgZm9yIHRoZW0gdG9cclxuICAgICAgICAgIC8vIGNvbmZpZ3VyZSB0aGUgY29udHJvbGxlci5cclxuICAgICAgICAgIGlmIChjaGlwSW5wdXRUZW1wbGF0ZSAhPSBDSElQX0lOUFVUX1RFTVBMQVRFKSB7XHJcbiAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIGlmIChjaGlwSW5wdXRUZW1wbGF0ZS5pbmRleE9mKCc8bWQtYXV0b2NvbXBsZXRlJykgPT09IDApXHJcbiAgICAgICAgICAgICAgICBtZENoaXBzQ3RybFxyXG4gICAgICAgICAgICAgICAgICAgIC5jb25maWd1cmVBdXRvY29tcGxldGUoZWxlbWVudC5maW5kKCdtZC1hdXRvY29tcGxldGUnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY29udHJvbGxlcignbWRBdXRvY29tcGxldGUnKSk7XHJcbiAgICAgICAgICAgICAgbWRDaGlwc0N0cmwuY29uZmlndXJlVXNlcklucHV0KGVsZW1lbnQuZmluZCgnaW5wdXQnKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ29tcGlsZSB3aXRoIHRoZSBwYXJlbnQncyBzY29wZSBhbmQgcHJlcGVuZCBhbnkgc3RhdGljIGNoaXBzIHRvIHRoZSB3cmFwcGVyLlxyXG4gICAgICAgIGlmIChzdGF0aWNDaGlwcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICB2YXIgY29tcGlsZWRTdGF0aWNDaGlwcyA9ICRjb21waWxlKHN0YXRpY0NoaXBzKShzY29wZS4kcGFyZW50KTtcclxuICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkgeyBlbGVtZW50LmZpbmQoJ21kLWNoaXBzLXdyYXAnKS5wcmVwZW5kKGNvbXBpbGVkU3RhdGljQ2hpcHMpOyB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgfVxyXG4gIE1kQ2hpcHMuJGluamVjdCA9IFtcIiRtZFRoZW1pbmdcIiwgXCIkbWRVdGlsXCIsIFwiJGNvbXBpbGVcIiwgXCIkbG9nXCIsIFwiJHRpbWVvdXRcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmNoaXBzJylcclxuICAgIC5jb250cm9sbGVyKCdNZENvbnRhY3RDaGlwc0N0cmwnLCBNZENvbnRhY3RDaGlwc0N0cmwpO1xyXG5cclxuXHJcblxyXG4vKipcclxuICogQ29udHJvbGxlciBmb3IgdGhlIE1kQ29udGFjdENoaXBzIGNvbXBvbmVudFxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIE1kQ29udGFjdENoaXBzQ3RybCAoKSB7XHJcbiAgLyoqIEB0eXBlIHtPYmplY3R9ICovXHJcbiAgdGhpcy5zZWxlY3RlZEl0ZW0gPSBudWxsO1xyXG5cclxuICAvKiogQHR5cGUge3N0cmluZ30gKi9cclxuICB0aGlzLnNlYXJjaFRleHQgPSAnJztcclxufVxyXG5cclxuXHJcbk1kQ29udGFjdENoaXBzQ3RybC5wcm90b3R5cGUucXVlcnlDb250YWN0ID0gZnVuY3Rpb24oc2VhcmNoVGV4dCkge1xyXG4gIHZhciByZXN1bHRzID0gdGhpcy5jb250YWN0UXVlcnkoeyckcXVlcnknOiBzZWFyY2hUZXh0fSk7XHJcbiAgcmV0dXJuIHRoaXMuZmlsdGVyU2VsZWN0ZWQgP1xyXG4gICAgICByZXN1bHRzLmZpbHRlcihhbmd1bGFyLmJpbmQodGhpcywgdGhpcy5maWx0ZXJTZWxlY3RlZENvbnRhY3RzKSkgOiByZXN1bHRzO1xyXG59O1xyXG5cclxuXHJcbk1kQ29udGFjdENoaXBzQ3RybC5wcm90b3R5cGUuZmlsdGVyU2VsZWN0ZWRDb250YWN0cyA9IGZ1bmN0aW9uKGNvbnRhY3QpIHtcclxuICByZXR1cm4gdGhpcy5jb250YWN0cy5pbmRleE9mKGNvbnRhY3QpID09IC0xO1xyXG59O1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuICBhbmd1bGFyXHJcbiAgICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuY2hpcHMnKVxyXG4gICAgICAuZGlyZWN0aXZlKCdtZENvbnRhY3RDaGlwcycsIE1kQ29udGFjdENoaXBzKTtcclxuXHJcbiAgLyoqXHJcbiAgICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gICAqIEBuYW1lIG1kQ29udGFjdENoaXBzXHJcbiAgICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmNoaXBzXHJcbiAgICpcclxuICAgKiBAZGVzY3JpcHRpb25cclxuICAgKiBgPG1kLWNvbnRhY3QtY2hpcHM+YCBpcyBhbiBpbnB1dCBjb21wb25lbnQgYmFzZWQgb24gYG1kLWNoaXBzYCBhbmQgbWFrZXMgdXNlIG9mIGFuXHJcbiAgICogICAgYG1kLWF1dG9jb21wbGV0ZWAgZWxlbWVudC4gVGhlIGNvbXBvbmVudCBhbGxvd3MgdGhlIGNhbGxlciB0byBzdXBwbHkgYSBxdWVyeSBleHByZXNzaW9uXHJcbiAgICogICAgd2hpY2ggcmV0dXJucyAgYSBsaXN0IG9mIHBvc3NpYmxlIGNvbnRhY3RzLiBUaGUgdXNlciBjYW4gc2VsZWN0IG9uZSBvZiB0aGVzZSBhbmQgYWRkIGl0IHRvXHJcbiAgICogICAgdGhlIGxpc3Qgb2YgY2hpcHMuXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge3N0cmluZz18b2JqZWN0PX0gbmctbW9kZWwgQSBtb2RlbCB0byBiaW5kIHRoZSBsaXN0IG9mIGl0ZW1zIHRvXHJcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBwbGFjZWhvbGRlciBQbGFjZWhvbGRlciB0ZXh0IHRoYXQgd2lsbCBiZSBmb3J3YXJkZWQgdG8gdGhlIGlucHV0LlxyXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gc2Vjb25kYXJ5LXBsYWNlaG9sZGVyIFBsYWNlaG9sZGVyIHRleHQgdGhhdCB3aWxsIGJlIGZvcndhcmRlZCB0byB0aGUgaW5wdXQsXHJcbiAgICogICAgZGlzcGxheWVkIHdoZW4gdGhlcmUgaXMgYXQgbGVhc3Qgb24gaXRlbSBpbiB0aGUgbGlzdFxyXG4gICAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbWQtY29udGFjdHMgQW4gZXhwcmVzc2lvbiBleHBlY3RlZCB0byByZXR1cm4gY29udGFjdHMgbWF0Y2hpbmcgdGhlIHNlYXJjaFxyXG4gICAqICAgIHRlc3QsIGAkcXVlcnlgLlxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBtZC1jb250YWN0LW5hbWUgVGhlIGZpZWxkIG5hbWUgb2YgdGhlIGNvbnRhY3Qgb2JqZWN0IHJlcHJlc2VudGluZyB0aGVcclxuICAgKiAgICBjb250YWN0J3MgbmFtZS5cclxuICAgKiBAcGFyYW0ge3N0cmluZ30gbWQtY29udGFjdC1lbWFpbCBUaGUgZmllbGQgbmFtZSBvZiB0aGUgY29udGFjdCBvYmplY3QgcmVwcmVzZW50aW5nIHRoZVxyXG4gICAqICAgIGNvbnRhY3QncyBlbWFpbCBhZGRyZXNzLlxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBtZC1jb250YWN0LWltYWdlIFRoZSBmaWVsZCBuYW1lIG9mIHRoZSBjb250YWN0IG9iamVjdCByZXByZXNlbnRpbmcgdGhlXHJcbiAgICogICAgY29udGFjdCdzIGltYWdlLlxyXG4gICAqXHJcbiAgICpcclxuICAgKiAvLyBUaGUgZm9sbG93aW5nIGF0dHJpYnV0ZSBoYXMgYmVlbiByZW1vdmVkIGJ1dCBtYXkgY29tZSBiYWNrLlxyXG4gICAqIEBwYXJhbSB7ZXhwcmVzc2lvbj19IGZpbHRlci1zZWxlY3RlZCBXaGV0aGVyIHRvIGZpbHRlciBzZWxlY3RlZCBjb250YWN0cyBmcm9tIHRoZSBsaXN0IG9mXHJcbiAgICogICAgc3VnZ2VzdGlvbnMgc2hvd24gaW4gdGhlIGF1dG9jb21wbGV0ZS5cclxuICAgKlxyXG4gICAqXHJcbiAgICpcclxuICAgKiBAdXNhZ2VcclxuICAgKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gICAqICAgPG1kLWNvbnRhY3QtY2hpcHNcclxuICAgKiAgICAgICBuZy1tb2RlbD1cImN0cmwuY29udGFjdHNcIlxyXG4gICAqICAgICAgIG1kLWNvbnRhY3RzPVwiY3RybC5xdWVyeVNlYXJjaCgkcXVlcnkpXCJcclxuICAgKiAgICAgICBtZC1jb250YWN0LW5hbWU9XCJuYW1lXCJcclxuICAgKiAgICAgICBtZC1jb250YWN0LWltYWdlPVwiaW1hZ2VcIlxyXG4gICAqICAgICAgIG1kLWNvbnRhY3QtZW1haWw9XCJlbWFpbFwiXHJcbiAgICogICAgICAgcGxhY2Vob2xkZXI9XCJUb1wiPlxyXG4gICAqICAgPC9tZC1jb250YWN0LWNoaXBzPlxyXG4gICAqIDwvaGxqcz5cclxuICAgKlxyXG4gICAqL1xyXG5cclxuXHJcbiAgdmFyIE1EX0NPTlRBQ1RfQ0hJUFNfVEVNUExBVEUgPSAnXFxcclxuICAgICAgPG1kLWNoaXBzIGNsYXNzPVwibWQtY29udGFjdC1jaGlwc1wiXFxcclxuICAgICAgICAgIG5nLW1vZGVsPVwiJG1kQ29udGFjdENoaXBzQ3RybC5jb250YWN0c1wiXFxcclxuICAgICAgICAgIG1kLXJlcXVpcmUtbWF0Y2g9XCIkbWRDb250YWN0Q2hpcHNDdHJsLnJlcXVpcmVNYXRjaFwiXFxcclxuICAgICAgICAgIG1kLWF1dG9jb21wbGV0ZS1zbmFwPlxcXHJcbiAgICAgICAgICA8bWQtYXV0b2NvbXBsZXRlXFxcclxuICAgICAgICAgICAgICBtZC1tZW51LWNsYXNzPVwibWQtY29udGFjdC1jaGlwcy1zdWdnZXN0aW9uc1wiXFxcclxuICAgICAgICAgICAgICBtZC1zZWxlY3RlZC1pdGVtPVwiJG1kQ29udGFjdENoaXBzQ3RybC5zZWxlY3RlZEl0ZW1cIlxcXHJcbiAgICAgICAgICAgICAgbWQtc2VhcmNoLXRleHQ9XCIkbWRDb250YWN0Q2hpcHNDdHJsLnNlYXJjaFRleHRcIlxcXHJcbiAgICAgICAgICAgICAgbWQtaXRlbXM9XCJpdGVtIGluICRtZENvbnRhY3RDaGlwc0N0cmwucXVlcnlDb250YWN0KCRtZENvbnRhY3RDaGlwc0N0cmwuc2VhcmNoVGV4dClcIlxcXHJcbiAgICAgICAgICAgICAgbWQtaXRlbS10ZXh0PVwiJG1kQ29udGFjdENoaXBzQ3RybC5tZENvbnRhY3ROYW1lXCJcXFxyXG4gICAgICAgICAgICAgIG1kLW5vLWNhY2hlPVwidHJ1ZVwiXFxcclxuICAgICAgICAgICAgICBtZC1hdXRvc2VsZWN0XFxcclxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cInt7JG1kQ29udGFjdENoaXBzQ3RybC5jb250YWN0cy5sZW5ndGggPT0gMCA/XFxcclxuICAgICAgICAgICAgICAgICAgJG1kQ29udGFjdENoaXBzQ3RybC5wbGFjZWhvbGRlciA6ICRtZENvbnRhY3RDaGlwc0N0cmwuc2Vjb25kYXJ5UGxhY2Vob2xkZXJ9fVwiPlxcXHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZC1jb250YWN0LXN1Z2dlc3Rpb25cIj5cXFxyXG4gICAgICAgICAgICAgIDxpbWcgXFxcclxuICAgICAgICAgICAgICAgICAgbmctc3JjPVwie3tpdGVtWyRtZENvbnRhY3RDaGlwc0N0cmwuY29udGFjdEltYWdlXX19XCJcXFxyXG4gICAgICAgICAgICAgICAgICBhbHQ9XCJ7e2l0ZW1bJG1kQ29udGFjdENoaXBzQ3RybC5jb250YWN0TmFtZV19fVwiIC8+XFxcclxuICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1kLWNvbnRhY3QtbmFtZVwiIG1kLWhpZ2hsaWdodC10ZXh0PVwiJG1kQ29udGFjdENoaXBzQ3RybC5zZWFyY2hUZXh0XCI+XFxcclxuICAgICAgICAgICAgICAgIHt7aXRlbVskbWRDb250YWN0Q2hpcHNDdHJsLmNvbnRhY3ROYW1lXX19XFxcclxuICAgICAgICAgICAgICA8L3NwYW4+XFxcclxuICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1kLWNvbnRhY3QtZW1haWxcIiA+e3tpdGVtWyRtZENvbnRhY3RDaGlwc0N0cmwuY29udGFjdEVtYWlsXX19PC9zcGFuPlxcXHJcbiAgICAgICAgICAgIDwvZGl2PlxcXHJcbiAgICAgICAgICA8L21kLWF1dG9jb21wbGV0ZT5cXFxyXG4gICAgICAgICAgPG1kLWNoaXAtdGVtcGxhdGU+XFxcclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1kLWNvbnRhY3QtYXZhdGFyXCI+XFxcclxuICAgICAgICAgICAgICA8aW1nIFxcXHJcbiAgICAgICAgICAgICAgICAgIG5nLXNyYz1cInt7JGNoaXBbJG1kQ29udGFjdENoaXBzQ3RybC5jb250YWN0SW1hZ2VdfX1cIlxcXHJcbiAgICAgICAgICAgICAgICAgIGFsdD1cInt7JGNoaXBbJG1kQ29udGFjdENoaXBzQ3RybC5jb250YWN0TmFtZV19fVwiIC8+XFxcclxuICAgICAgICAgICAgPC9kaXY+XFxcclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1kLWNvbnRhY3QtbmFtZVwiPlxcXHJcbiAgICAgICAgICAgICAge3skY2hpcFskbWRDb250YWN0Q2hpcHNDdHJsLmNvbnRhY3ROYW1lXX19XFxcclxuICAgICAgICAgICAgPC9kaXY+XFxcclxuICAgICAgICAgIDwvbWQtY2hpcC10ZW1wbGF0ZT5cXFxyXG4gICAgICA8L21kLWNoaXBzPic7XHJcblxyXG5cclxuICAvKipcclxuICAgKiBNRENvbnRhY3RDaGlwcyBEaXJlY3RpdmUgRGVmaW5pdGlvblxyXG4gICAqXHJcbiAgICogQHBhcmFtICRtZFRoZW1pbmdcclxuICAgKiBAcmV0dXJucyB7Kn1cclxuICAgKiBAbmdJbmplY3RcclxuICAgKi9cclxuICBmdW5jdGlvbiBNZENvbnRhY3RDaGlwcyAoJG1kVGhlbWluZywgJG1kVXRpbCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdGVtcGxhdGU6IGZ1bmN0aW9uKGVsZW1lbnQsIGF0dHJzKSB7XHJcbiAgICAgICAgcmV0dXJuIE1EX0NPTlRBQ1RfQ0hJUFNfVEVNUExBVEU7XHJcbiAgICAgIH0sXHJcbiAgICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICAgIGNvbnRyb2xsZXI6ICdNZENvbnRhY3RDaGlwc0N0cmwnLFxyXG4gICAgICBjb250cm9sbGVyQXM6ICckbWRDb250YWN0Q2hpcHNDdHJsJyxcclxuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcclxuICAgICAgY29tcGlsZTogY29tcGlsZSxcclxuICAgICAgc2NvcGU6IHtcclxuICAgICAgICBjb250YWN0UXVlcnk6ICcmbWRDb250YWN0cycsXHJcbiAgICAgICAgcGxhY2Vob2xkZXI6ICdAJyxcclxuICAgICAgICBzZWNvbmRhcnlQbGFjZWhvbGRlcjogJ0AnLFxyXG4gICAgICAgIGNvbnRhY3ROYW1lOiAnQG1kQ29udGFjdE5hbWUnLFxyXG4gICAgICAgIGNvbnRhY3RJbWFnZTogJ0BtZENvbnRhY3RJbWFnZScsXHJcbiAgICAgICAgY29udGFjdEVtYWlsOiAnQG1kQ29udGFjdEVtYWlsJyxcclxuICAgICAgICBjb250YWN0czogJz1uZ01vZGVsJyxcclxuICAgICAgICByZXF1aXJlTWF0Y2g6ICc9P21kUmVxdWlyZU1hdGNoJ1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbXBpbGUoZWxlbWVudCwgYXR0cikge1xyXG4gICAgICByZXR1cm4gZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBjb250cm9sbGVycykge1xyXG5cclxuICAgICAgICAkbWRVdGlsLmluaXRPcHRpb25hbFByb3BlcnRpZXMoc2NvcGUsIGF0dHIpO1xyXG4gICAgICAgICRtZFRoZW1pbmcoZWxlbWVudCk7XHJcblxyXG4gICAgICAgIGVsZW1lbnQuYXR0cigndGFiaW5kZXgnLCAnLTEnKTtcclxuICAgICAgfTtcclxuICAgIH1cclxuICB9XHJcbiAgTWRDb250YWN0Q2hpcHMuJGluamVjdCA9IFtcIiRtZFRoZW1pbmdcIiwgXCIkbWRVdGlsXCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRUYWJcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnRhYnNcclxuICpcclxuICogQHJlc3RyaWN0IEVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIFVzZSB0aGUgYDxtZC10YWI+YCBhIG5lc3RlZCBkaXJlY3RpdmUgdXNlZCB3aXRoaW4gYDxtZC10YWJzPmAgdG8gc3BlY2lmeSBhIHRhYiB3aXRoIGEgKipsYWJlbCoqIGFuZCBvcHRpb25hbCAqdmlldyBjb250ZW50Ki5cclxuICpcclxuICogSWYgdGhlIGBsYWJlbGAgYXR0cmlidXRlIGlzIG5vdCBzcGVjaWZpZWQsIHRoZW4gYW4gb3B0aW9uYWwgYDxtZC10YWItbGFiZWw+YCB0YWcgY2FuIGJlIHVzZWQgdG8gc3BlY2lmeSBtb3JlXHJcbiAqIGNvbXBsZXggdGFiIGhlYWRlciBtYXJrdXAuIElmIG5laXRoZXIgdGhlICoqbGFiZWwqKiBub3IgdGhlICoqbWQtdGFiLWxhYmVsKiogYXJlIHNwZWNpZmllZCwgdGhlbiB0aGUgbmVzdGVkXHJcbiAqIG1hcmt1cCBvZiB0aGUgYDxtZC10YWI+YCBpcyB1c2VkIGFzIHRoZSB0YWIgaGVhZGVyIG1hcmt1cC5cclxuICpcclxuICogUGxlYXNlIG5vdGUgdGhhdCBpZiB5b3UgdXNlIGA8bWQtdGFiLWxhYmVsPmAsIHlvdXIgY29udGVudCAqKk1VU1QqKiBiZSB3cmFwcGVkIGluIHRoZSBgPG1kLXRhYi1ib2R5PmAgdGFnLiAgVGhpc1xyXG4gKiBpcyB0byBkZWZpbmUgYSBjbGVhciBzZXBhcmF0aW9uIGJldHdlZW4gdGhlIHRhYiBjb250ZW50IGFuZCB0aGUgdGFiIGxhYmVsLlxyXG4gKlxyXG4gKiBJZiBhIHRhYiAqKmxhYmVsKiogaGFzIGJlZW4gaWRlbnRpZmllZCwgdGhlbiBhbnkgKipub24tKipgPG1kLXRhYi1sYWJlbD5gIG1hcmt1cFxyXG4gKiB3aWxsIGJlIGNvbnNpZGVyZWQgdGFiIGNvbnRlbnQgYW5kIHdpbGwgYmUgdHJhbnNjbHVkZWQgdG8gdGhlIGludGVybmFsIGA8ZGl2IGNsYXNzPVwibWQtdGFicy1jb250ZW50XCI+YCBjb250YWluZXIuXHJcbiAqXHJcbiAqIFRoaXMgY29udGFpbmVyIGlzIHVzZWQgYnkgdGhlIFRhYnNDb250cm9sbGVyIHRvIHNob3cvaGlkZSB0aGUgYWN0aXZlIHRhYidzIGNvbnRlbnQgdmlldy4gVGhpcyBzeW5jaHJvbml6YXRpb24gaXNcclxuICogYXV0b21hdGljYWxseSBtYW5hZ2VkIGJ5IHRoZSBpbnRlcm5hbCBUYWJzQ29udHJvbGxlciB3aGVuZXZlciB0aGUgdGFiIHNlbGVjdGlvbiBjaGFuZ2VzLiBTZWxlY3Rpb24gY2hhbmdlcyBjYW5cclxuICogYmUgaW5pdGlhdGVkIHZpYSBkYXRhIGJpbmRpbmcgY2hhbmdlcywgcHJvZ3JhbW1hdGljIGludm9jYXRpb24sIG9yIHVzZXIgZ2VzdHVyZXMuXHJcbiAqXHJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gbGFiZWwgT3B0aW9uYWwgYXR0cmlidXRlIHRvIHNwZWNpZnkgYSBzaW1wbGUgc3RyaW5nIGFzIHRoZSB0YWIgbGFiZWxcclxuICogQHBhcmFtIHtib29sZWFuPX0gZGlzYWJsZWQgSWYgcHJlc2VudCwgZGlzYWJsZWQgdGFiIHNlbGVjdGlvbi5cclxuICogQHBhcmFtIHtleHByZXNzaW9uPX0gbWQtb24tZGVzZWxlY3QgRXhwcmVzc2lvbiB0byBiZSBldmFsdWF0ZWQgYWZ0ZXIgdGhlIHRhYiBoYXMgYmVlbiBkZS1zZWxlY3RlZC5cclxuICogQHBhcmFtIHtleHByZXNzaW9uPX0gbWQtb24tc2VsZWN0IEV4cHJlc3Npb24gdG8gYmUgZXZhbHVhdGVkIGFmdGVyIHRoZSB0YWIgaGFzIGJlZW4gc2VsZWN0ZWQuXHJcbiAqXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKlxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtdGFiIGxhYmVsPVwiXCIgZGlzYWJsZWQ9XCJcIiBtZC1vbi1zZWxlY3Q9XCJcIiBtZC1vbi1kZXNlbGVjdD1cIlwiID5cclxuICogICA8aDM+TXkgVGFiIGNvbnRlbnQ8L2gzPlxyXG4gKiA8L21kLXRhYj5cclxuICpcclxuICogPG1kLXRhYiA+XHJcbiAqICAgPG1kLXRhYi1sYWJlbD5cclxuICogICAgIDxoMz5NeSBUYWIgY29udGVudDwvaDM+XHJcbiAqICAgPC9tZC10YWItbGFiZWw+XHJcbiAqICAgPG1kLXRhYi1ib2R5PlxyXG4gKiAgICAgPHA+XHJcbiAqICAgICAgIFNlZCB1dCBwZXJzcGljaWF0aXMgdW5kZSBvbW5pcyBpc3RlIG5hdHVzIGVycm9yIHNpdCB2b2x1cHRhdGVtIGFjY3VzYW50aXVtIGRvbG9yZW1xdWUgbGF1ZGFudGl1bSxcclxuICogICAgICAgdG90YW0gcmVtIGFwZXJpYW0sIGVhcXVlIGlwc2EgcXVhZSBhYiBpbGxvIGludmVudG9yZSB2ZXJpdGF0aXMgZXQgcXVhc2kgYXJjaGl0ZWN0byBiZWF0YWUgdml0YWVcclxuICogICAgICAgZGljdGEgc3VudCBleHBsaWNhYm8uIE5lbW8gZW5pbSBpcHNhbSB2b2x1cHRhdGVtIHF1aWEgdm9sdXB0YXMgc2l0IGFzcGVybmF0dXIgYXV0IG9kaXQgYXV0IGZ1Z2l0LFxyXG4gKiAgICAgICBzZWQgcXVpYSBjb25zZXF1dW50dXIgbWFnbmkgZG9sb3JlcyBlb3MgcXVpIHJhdGlvbmUgdm9sdXB0YXRlbSBzZXF1aSBuZXNjaXVudC5cclxuICogICAgIDwvcD5cclxuICogICA8L21kLXRhYi1ib2R5PlxyXG4gKiA8L21kLXRhYj5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKi9cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy50YWJzJylcclxuICAgIC5kaXJlY3RpdmUoJ21kVGFiJywgTWRUYWIpO1xyXG5cclxuZnVuY3Rpb24gTWRUYWIgKCkge1xyXG4gIHJldHVybiB7XHJcbiAgICByZXF1aXJlOiAnXj9tZFRhYnMnLFxyXG4gICAgdGVybWluYWw6IHRydWUsXHJcbiAgICB0ZW1wbGF0ZTogZnVuY3Rpb24gKGVsZW1lbnQsIGF0dHIpIHtcclxuICAgICAgdmFyIGxhYmVsID0gZ2V0TGFiZWwoKSxcclxuICAgICAgICAgIGJvZHkgID0gZ2V0VGVtcGxhdGUoKTtcclxuICAgICAgcmV0dXJuICcnICtcclxuICAgICAgICAgICc8bWQtdGFiLWxhYmVsPicgKyBsYWJlbCArICc8L21kLXRhYi1sYWJlbD4nICtcclxuICAgICAgICAgICc8bWQtdGFiLWJvZHk+JyArIGJvZHkgKyAnPC9tZC10YWItYm9keT4nO1xyXG4gICAgICBmdW5jdGlvbiBnZXRMYWJlbCAoKSB7XHJcbiAgICAgICAgcmV0dXJuIGdldExhYmVsRWxlbWVudCgpIHx8IGdldExhYmVsQXR0cmlidXRlKCkgfHwgZ2V0RWxlbWVudENvbnRlbnRzKCk7XHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0TGFiZWxBdHRyaWJ1dGUgKCkgeyByZXR1cm4gYXR0ci5sYWJlbDsgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGdldExhYmVsRWxlbWVudCAoKSB7XHJcbiAgICAgICAgICB2YXIgbGFiZWwgPSBlbGVtZW50LmZpbmQoJ21kLXRhYi1sYWJlbCcpLmVxKDApO1xyXG4gICAgICAgICAgaWYgKGxhYmVsLmxlbmd0aCkgcmV0dXJuIGxhYmVsLnJlbW92ZSgpLmh0bWwoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0RWxlbWVudENvbnRlbnRzICgpIHtcclxuICAgICAgICAgIHZhciBodG1sID0gZWxlbWVudC5odG1sKCk7XHJcbiAgICAgICAgICBlbGVtZW50LmVtcHR5KCk7XHJcbiAgICAgICAgICByZXR1cm4gaHRtbDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZnVuY3Rpb24gZ2V0VGVtcGxhdGUgKCkge1xyXG4gICAgICAgIHZhciBjb250ZW50ID0gZWxlbWVudC5maW5kKCdtZC10YWItYm9keScpLmVxKDApLFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZSA9IGNvbnRlbnQubGVuZ3RoID8gY29udGVudC5odG1sKCkgOiBhdHRyLmxhYmVsID8gZWxlbWVudC5odG1sKCkgOiAnJztcclxuICAgICAgICBpZiAoY29udGVudC5sZW5ndGgpIGNvbnRlbnQucmVtb3ZlKCk7XHJcbiAgICAgICAgZWxzZSBpZiAoYXR0ci5sYWJlbCkgZWxlbWVudC5lbXB0eSgpO1xyXG4gICAgICAgIHJldHVybiB0ZW1wbGF0ZTtcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNjb3BlOiB7XHJcbiAgICAgIGFjdGl2ZTogICAnPT9tZEFjdGl2ZScsXHJcbiAgICAgIGRpc2FibGVkOiAnPT9uZ0Rpc2FibGVkJyxcclxuICAgICAgc2VsZWN0OiAgICcmP21kT25TZWxlY3QnLFxyXG4gICAgICBkZXNlbGVjdDogJyY/bWRPbkRlc2VsZWN0J1xyXG4gICAgfSxcclxuICAgIGxpbms6IHBvc3RMaW5rXHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb24gcG9zdExpbmsgKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsKSB7XHJcbiAgICBpZiAoIWN0cmwpIHJldHVybjtcclxuICAgIHZhciB0YWJzID0gZWxlbWVudC5wYXJlbnQoKVswXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbWQtdGFiJyksXHJcbiAgICAgICAgaW5kZXggPSBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKHRhYnMsIGVsZW1lbnRbMF0pLFxyXG4gICAgICAgIGJvZHkgPSBlbGVtZW50LmZpbmQoJ21kLXRhYi1ib2R5JykuZXEoMCkucmVtb3ZlKCksXHJcbiAgICAgICAgbGFiZWwgPSBlbGVtZW50LmZpbmQoJ21kLXRhYi1sYWJlbCcpLmVxKDApLnJlbW92ZSgpLFxyXG4gICAgICAgIGRhdGEgPSBjdHJsLmluc2VydFRhYih7XHJcbiAgICAgICAgICBzY29wZTogICAgc2NvcGUsXHJcbiAgICAgICAgICBwYXJlbnQ6ICAgc2NvcGUuJHBhcmVudCxcclxuICAgICAgICAgIGluZGV4OiAgICBpbmRleCxcclxuICAgICAgICAgIGVsZW1lbnQ6ICBlbGVtZW50LFxyXG4gICAgICAgICAgdGVtcGxhdGU6IGJvZHkuaHRtbCgpLFxyXG4gICAgICAgICAgbGFiZWw6ICAgIGxhYmVsLmh0bWwoKVxyXG4gICAgICAgIH0sIGluZGV4KTtcclxuXHJcbiAgICBzY29wZS5zZWxlY3QgICA9IHNjb3BlLnNlbGVjdCAgIHx8IGFuZ3VsYXIubm9vcDtcclxuICAgIHNjb3BlLmRlc2VsZWN0ID0gc2NvcGUuZGVzZWxlY3QgfHwgYW5ndWxhci5ub29wO1xyXG5cclxuICAgIHNjb3BlLiR3YXRjaCgnYWN0aXZlJywgZnVuY3Rpb24gKGFjdGl2ZSkgeyBpZiAoYWN0aXZlKSBjdHJsLnNlbGVjdChkYXRhLmdldEluZGV4KCkpOyB9KTtcclxuICAgIHNjb3BlLiR3YXRjaCgnZGlzYWJsZWQnLCBmdW5jdGlvbiAoKSB7IGN0cmwucmVmcmVzaEluZGV4KCk7IH0pO1xyXG4gICAgc2NvcGUuJHdhdGNoKFxyXG4gICAgICAgIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKHRhYnMsIGVsZW1lbnRbMF0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZnVuY3Rpb24gKG5ld0luZGV4KSB7XHJcbiAgICAgICAgICBkYXRhLmluZGV4ID0gbmV3SW5kZXg7XHJcbiAgICAgICAgICBjdHJsLnVwZGF0ZVRhYk9yZGVyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgKTtcclxuICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7IGN0cmwucmVtb3ZlVGFiKGRhdGEpOyB9KTtcclxuXHJcbiAgfVxyXG59XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnRhYnMnKVxyXG4gICAgLmRpcmVjdGl2ZSgnbWRUYWJJdGVtJywgTWRUYWJJdGVtKTtcclxuXHJcbmZ1bmN0aW9uIE1kVGFiSXRlbSAoKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlcXVpcmU6ICdeP21kVGFicycsXHJcbiAgICBsaW5rOiBmdW5jdGlvbiBsaW5rIChzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCkge1xyXG4gICAgICBpZiAoIWN0cmwpIHJldHVybjtcclxuICAgICAgY3RybC5hdHRhY2hSaXBwbGUoc2NvcGUsIGVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMudGFicycpXHJcbiAgICAuZGlyZWN0aXZlKCdtZFRhYkxhYmVsJywgTWRUYWJMYWJlbCk7XHJcblxyXG5mdW5jdGlvbiBNZFRhYkxhYmVsICgpIHtcclxuICByZXR1cm4geyB0ZXJtaW5hbDogdHJ1ZSB9O1xyXG59XHJcblxyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMudGFicycpXHJcbiAgICAuZGlyZWN0aXZlKCdtZFRhYlNjcm9sbCcsIE1kVGFiU2Nyb2xsKTtcclxuXHJcbmZ1bmN0aW9uIE1kVGFiU2Nyb2xsICgkcGFyc2UpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgIGNvbXBpbGU6IGZ1bmN0aW9uICgkZWxlbWVudCwgYXR0cikge1xyXG4gICAgICB2YXIgZm4gPSAkcGFyc2UoYXR0ci5tZFRhYlNjcm9sbCwgbnVsbCwgdHJ1ZSk7XHJcbiAgICAgIHJldHVybiBmdW5jdGlvbiBuZ0V2ZW50SGFuZGxlciAoc2NvcGUsIGVsZW1lbnQpIHtcclxuICAgICAgICBlbGVtZW50Lm9uKCdtb3VzZXdoZWVsJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkgeyBmbihzY29wZSwgeyAkZXZlbnQ6IGV2ZW50IH0pOyB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgfTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuTWRUYWJTY3JvbGwuJGluamVjdCA9IFtcIiRwYXJzZVwiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMudGFicycpXHJcbiAgICAuY29udHJvbGxlcignTWRUYWJzQ29udHJvbGxlcicsIE1kVGFic0NvbnRyb2xsZXIpO1xyXG5cclxuLyoqXHJcbiAqIEBuZ0luamVjdFxyXG4gKi9cclxuZnVuY3Rpb24gTWRUYWJzQ29udHJvbGxlciAoJHNjb3BlLCAkZWxlbWVudCwgJHdpbmRvdywgJHRpbWVvdXQsICRtZENvbnN0YW50LCAkbWRUYWJJbmtSaXBwbGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZFV0aWwsICRhbmltYXRlLCAkYXR0cnMsICRjb21waWxlLCAkbWRUaGVtaW5nKSB7XHJcbiAgLy8tLSBkZWZpbmUgcHJpdmF0ZSBwcm9wZXJ0aWVzXHJcbiAgdmFyIGN0cmwgICAgICAgPSB0aGlzLFxyXG4gICAgICBsb2NrZWQgICAgID0gZmFsc2UsXHJcbiAgICAgIGVsZW1lbnRzICAgPSBnZXRFbGVtZW50cygpLFxyXG4gICAgICBxdWV1ZSAgICAgID0gW10sXHJcbiAgICAgIGRlc3Ryb3llZCAgPSBmYWxzZSxcclxuICAgICAgbG9hZGVkICAgICA9IGZhbHNlO1xyXG5cclxuICAvLy0tIGRlZmluZSBwdWJsaWMgcHJvcGVydGllcyB3aXRoIGNoYW5nZSBoYW5kbGVyc1xyXG4gIGRlZmluZVByb3BlcnR5KCdmb2N1c0luZGV4JywgaGFuZGxlRm9jdXNJbmRleENoYW5nZSwgJHNjb3BlLnNlbGVjdGVkSW5kZXggfHwgMCk7XHJcbiAgZGVmaW5lUHJvcGVydHkoJ29mZnNldExlZnQnLCBoYW5kbGVPZmZzZXRDaGFuZ2UsIDApO1xyXG4gIGRlZmluZVByb3BlcnR5KCdoYXNDb250ZW50JywgaGFuZGxlSGFzQ29udGVudCwgZmFsc2UpO1xyXG5cclxuICAvLy0tIGRlZmluZSBwdWJsaWMgcHJvcGVydGllc1xyXG4gIGN0cmwuc2NvcGUgPSAkc2NvcGU7XHJcbiAgY3RybC5wYXJlbnQgPSAkc2NvcGUuJHBhcmVudDtcclxuICBjdHJsLnRhYnMgPSBbXTtcclxuICBjdHJsLmxhc3RTZWxlY3RlZEluZGV4ID0gbnVsbDtcclxuICBjdHJsLmhhc0ZvY3VzID0gZmFsc2U7XHJcbiAgY3RybC5sYXN0Q2xpY2sgPSB0cnVlO1xyXG4gIGN0cmwuc2hvdWxkUGFnaW5hdGUgPSBmYWxzZTtcclxuICBjdHJsLnNob3VsZENlbnRlclRhYnMgPSBzaG91bGRDZW50ZXJUYWJzKCk7XHJcblxyXG4gIC8vLS0gZGVmaW5lIHB1YmxpYyBtZXRob2RzXHJcbiAgY3RybC5yZWRpcmVjdEZvY3VzID0gcmVkaXJlY3RGb2N1cztcclxuICBjdHJsLmF0dGFjaFJpcHBsZSA9IGF0dGFjaFJpcHBsZTtcclxuICBjdHJsLnNob3VsZFN0cmV0Y2hUYWJzID0gc2hvdWxkU3RyZXRjaFRhYnM7XHJcbiAgY3RybC5pbnNlcnRUYWIgPSBpbnNlcnRUYWI7XHJcbiAgY3RybC5yZW1vdmVUYWIgPSByZW1vdmVUYWI7XHJcbiAgY3RybC5zZWxlY3QgPSBzZWxlY3Q7XHJcbiAgY3RybC5zY3JvbGwgPSBzY3JvbGw7XHJcbiAgY3RybC5uZXh0UGFnZSA9IG5leHRQYWdlO1xyXG4gIGN0cmwucHJldmlvdXNQYWdlID0gcHJldmlvdXNQYWdlO1xyXG4gIGN0cmwua2V5ZG93biA9IGtleWRvd247XHJcbiAgY3RybC5jYW5QYWdlRm9yd2FyZCA9IGNhblBhZ2VGb3J3YXJkO1xyXG4gIGN0cmwuY2FuUGFnZUJhY2sgPSBjYW5QYWdlQmFjaztcclxuICBjdHJsLnJlZnJlc2hJbmRleCA9IHJlZnJlc2hJbmRleDtcclxuICBjdHJsLmluY3JlbWVudFNlbGVjdGVkSW5kZXggPSBpbmNyZW1lbnRTZWxlY3RlZEluZGV4O1xyXG4gIGN0cmwudXBkYXRlSW5rQmFyU3R5bGVzID0gJG1kVXRpbC5kZWJvdW5jZSh1cGRhdGVJbmtCYXJTdHlsZXMsIDEwMCk7XHJcbiAgY3RybC51cGRhdGVUYWJPcmRlciA9ICRtZFV0aWwuZGVib3VuY2UodXBkYXRlVGFiT3JkZXIsIDEwMCk7XHJcblxyXG4gIGluaXQoKTtcclxuXHJcbiAgLyoqXHJcbiAgICogUGVyZm9ybSBpbml0aWFsaXphdGlvbiBmb3IgdGhlIGNvbnRyb2xsZXIsIHNldHVwIGV2ZW50cyBhbmQgd2F0Y2hlcihzKVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGluaXQgKCkge1xyXG4gICAgJHNjb3BlLnNlbGVjdGVkSW5kZXggPSAkc2NvcGUuc2VsZWN0ZWRJbmRleCB8fCAwO1xyXG4gICAgY29tcGlsZVRlbXBsYXRlKCk7XHJcbiAgICBjb25maWd1cmVXYXRjaGVycygpO1xyXG4gICAgYmluZEV2ZW50cygpO1xyXG4gICAgJG1kVGhlbWluZygkZWxlbWVudCk7XHJcbiAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHVwZGF0ZUhlaWdodEZyb21Db250ZW50KCk7XHJcbiAgICAgIGFkanVzdE9mZnNldCgpO1xyXG4gICAgICB1cGRhdGVQYWdpbmF0aW9uKCk7XHJcbiAgICAgIGN0cmwudGFic1skc2NvcGUuc2VsZWN0ZWRJbmRleF0gJiYgY3RybC50YWJzWyRzY29wZS5zZWxlY3RlZEluZGV4XS5zY29wZS5zZWxlY3QoKTtcclxuICAgICAgbG9hZGVkID0gdHJ1ZTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gY29tcGlsZVRlbXBsYXRlICgpIHtcclxuICAgIHZhciB0ZW1wbGF0ZSA9ICRhdHRycy4kbWRUYWJzVGVtcGxhdGUsXHJcbiAgICAgICAgZWxlbWVudCAgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudHMuZGF0YSk7XHJcbiAgICBlbGVtZW50Lmh0bWwodGVtcGxhdGUpO1xyXG4gICAgJGNvbXBpbGUoZWxlbWVudC5jb250ZW50cygpKShjdHJsLnBhcmVudCk7XHJcbiAgICBkZWxldGUgJGF0dHJzLiRtZFRhYnNUZW1wbGF0ZTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGJpbmRFdmVudHMgKCkge1xyXG4gICAgYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpLm9uKCdyZXNpemUnLCBoYW5kbGVXaW5kb3dSZXNpemUpO1xyXG4gICAgYW5ndWxhci5lbGVtZW50KGVsZW1lbnRzLnBhZ2luZykub24oJ0RPTVN1YnRyZWVNb2RpZmllZCcsIGN0cmwudXBkYXRlSW5rQmFyU3R5bGVzKTtcclxuICAgIGFuZ3VsYXIuZWxlbWVudChlbGVtZW50cy5wYWdpbmcpLm9uKCdET01TdWJ0cmVlTW9kaWZpZWQnLCB1cGRhdGVQYWdpbmF0aW9uKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNvbmZpZ3VyZVdhdGNoZXJzICgpIHtcclxuICAgICRtZFV0aWwuaW5pdE9wdGlvbmFsUHJvcGVydGllcygkc2NvcGUsICRhdHRycyk7XHJcbiAgICAkYXR0cnMuJG9ic2VydmUoJ21kTm9CYXInLCBmdW5jdGlvbiAodmFsdWUpIHsgJHNjb3BlLm5vSW5rQmFyID0gYW5ndWxhci5pc0RlZmluZWQodmFsdWUpOyB9KTtcclxuICAgICRzY29wZS4kd2F0Y2goJ3NlbGVjdGVkSW5kZXgnLCBoYW5kbGVTZWxlY3RlZEluZGV4Q2hhbmdlKTtcclxuICAgICRzY29wZS4kd2F0Y2goJ2R5bmFtaWNIZWlnaHQnLCBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgaWYgKHZhbHVlKSAkZWxlbWVudC5hZGRDbGFzcygnbWQtZHluYW1pYy1oZWlnaHQnKTtcclxuICAgICAgZWxzZSAkZWxlbWVudC5yZW1vdmVDbGFzcygnbWQtZHluYW1pYy1oZWlnaHQnKTtcclxuICAgIH0pO1xyXG4gICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBjbGVhbnVwKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlbW92ZSBhbnkgZXZlbnRzIGRlZmluZWQgYnkgdGhpcyBjb250cm9sbGVyXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gY2xlYW51cCAoKSB7XHJcbiAgICBkZXN0cm95ZWQgPSB0cnVlO1xyXG4gICAgYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpLm9mZigncmVzaXplJywgaGFuZGxlV2luZG93UmVzaXplKTtcclxuICAgIGFuZ3VsYXIuZWxlbWVudChlbGVtZW50cy5wYWdpbmcpLm9mZignRE9NU3VidHJlZU1vZGlmaWVkJywgY3RybC51cGRhdGVJbmtCYXJTdHlsZXMpO1xyXG4gICAgYW5ndWxhci5lbGVtZW50KGVsZW1lbnRzLnBhZ2luZykub2ZmKCdET01TdWJ0cmVlTW9kaWZpZWQnLCB1cGRhdGVQYWdpbmF0aW9uKTtcclxuICB9XHJcblxyXG4gIC8vLS0gQ2hhbmdlIGhhbmRsZXJzXHJcblxyXG4gIC8qKlxyXG4gICAqIEFkZC9yZW1vdmUgdGhlIGBtZC1uby10YWItY29udGVudGAgY2xhc3MgZGVwZW5kaW5nIG9uIGBjdHJsLmhhc0NvbnRlbnRgXHJcbiAgICogQHBhcmFtIGhhc0NvbnRlbnRcclxuICAgKi9cclxuICBmdW5jdGlvbiBoYW5kbGVIYXNDb250ZW50IChoYXNDb250ZW50KSB7XHJcbiAgICAkZWxlbWVudFtoYXNDb250ZW50ID8gJ3JlbW92ZUNsYXNzJyA6ICdhZGRDbGFzcyddKCdtZC1uby10YWItY29udGVudCcpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQXBwbHkgY3RybC5vZmZzZXRMZWZ0IHRvIHRoZSBwYWdpbmcgZWxlbWVudCB3aGVuIGl0IGNoYW5nZXNcclxuICAgKiBAcGFyYW0gbGVmdFxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGhhbmRsZU9mZnNldENoYW5nZSAobGVmdCkge1xyXG4gICAgdmFyIG5ld1ZhbHVlID0gY3RybC5zaG91bGRDZW50ZXJUYWJzID8gJycgOiAnLScgKyBsZWZ0ICsgJ3B4JztcclxuICAgIGFuZ3VsYXIuZWxlbWVudChlbGVtZW50cy5wYWdpbmcpLmNzcygkbWRDb25zdGFudC5DU1MuVFJBTlNGT1JNLCAndHJhbnNsYXRlM2QoJyArIG5ld1ZhbHVlICsgJywgMCwgMCknKTtcclxuICAgICRzY29wZS4kYnJvYWRjYXN0KCckbWRUYWJzUGFnaW5hdGlvbkNoYW5nZWQnKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVwZGF0ZSB0aGUgVUkgd2hlbmV2ZXIgYGN0cmwuZm9jdXNJbmRleGAgaXMgdXBkYXRlZFxyXG4gICAqIEBwYXJhbSBuZXdJbmRleFxyXG4gICAqIEBwYXJhbSBvbGRJbmRleFxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGhhbmRsZUZvY3VzSW5kZXhDaGFuZ2UgKG5ld0luZGV4LCBvbGRJbmRleCkge1xyXG4gICAgaWYgKG5ld0luZGV4ID09PSBvbGRJbmRleCkgcmV0dXJuO1xyXG4gICAgaWYgKCFlbGVtZW50cy50YWJzW25ld0luZGV4XSkgcmV0dXJuO1xyXG4gICAgYWRqdXN0T2Zmc2V0KCk7XHJcbiAgICByZWRpcmVjdEZvY3VzKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgdGhlIFVJIHdoZW5ldmVyIHRoZSBzZWxlY3RlZCBpbmRleCBjaGFuZ2VzLiBDYWxscyB1c2VyLWRlZmluZWQgc2VsZWN0L2Rlc2VsZWN0IG1ldGhvZHMuXHJcbiAgICogQHBhcmFtIG5ld1ZhbHVlXHJcbiAgICogQHBhcmFtIG9sZFZhbHVlXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gaGFuZGxlU2VsZWN0ZWRJbmRleENoYW5nZSAobmV3VmFsdWUsIG9sZFZhbHVlKSB7XHJcbiAgICBpZiAobmV3VmFsdWUgPT09IG9sZFZhbHVlKSByZXR1cm47XHJcblxyXG4gICAgJHNjb3BlLnNlbGVjdGVkSW5kZXggPSBnZXROZWFyZXN0U2FmZUluZGV4KG5ld1ZhbHVlKTtcclxuICAgIGN0cmwubGFzdFNlbGVjdGVkSW5kZXggPSBvbGRWYWx1ZTtcclxuICAgIGN0cmwudXBkYXRlSW5rQmFyU3R5bGVzKCk7XHJcbiAgICB1cGRhdGVIZWlnaHRGcm9tQ29udGVudCgpO1xyXG4gICAgYWRqdXN0T2Zmc2V0KG5ld1ZhbHVlKTtcclxuICAgICRzY29wZS4kYnJvYWRjYXN0KCckbWRUYWJzQ2hhbmdlZCcpO1xyXG4gICAgY3RybC50YWJzW29sZFZhbHVlXSAmJiBjdHJsLnRhYnNbb2xkVmFsdWVdLnNjb3BlLmRlc2VsZWN0KCk7XHJcbiAgICBjdHJsLnRhYnNbbmV3VmFsdWVdICYmIGN0cmwudGFic1tuZXdWYWx1ZV0uc2NvcGUuc2VsZWN0KCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBRdWV1ZXMgdXAgYSBjYWxsIHRvIGBoYW5kbGVXaW5kb3dSZXNpemVgIHdoZW4gYSByZXNpemUgb2NjdXJzIHdoaWxlIHRoZSB0YWJzIGNvbXBvbmVudCBpc1xyXG4gICAqIGhpZGRlbi5cclxuICAgKi9cclxuICBmdW5jdGlvbiBoYW5kbGVSZXNpemVXaGVuVmlzaWJsZSAoKSB7XHJcbiAgICAvLy0tIGlmIHRoZXJlIGlzIGFscmVhZHkgYSB3YXRjaGVyIHdhaXRpbmcgZm9yIHJlc2l6ZSwgZG8gbm90aGluZ1xyXG4gICAgaWYgKGhhbmRsZVJlc2l6ZVdoZW5WaXNpYmxlLndhdGNoZXIpIHJldHVybjtcclxuICAgIC8vLS0gb3RoZXJ3aXNlLCB3ZSB3aWxsIGFidXNlIHRoZSAkd2F0Y2ggZnVuY3Rpb24gdG8gY2hlY2sgZm9yIHZpc2libGVcclxuICAgIGhhbmRsZVJlc2l6ZVdoZW5WaXNpYmxlLndhdGNoZXIgPSAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgLy8tLSBzaW5jZSB3ZSBhcmUgY2hlY2tpbmcgZm9yIERPTSBzaXplLCB3ZSB1c2UgJHRpbWVvdXQgdG8gd2FpdCBmb3IgYWZ0ZXIgdGhlIERPTSB1cGRhdGVzXHJcbiAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLy0tIGlmIHRoZSB3YXRjaGVyIGhhcyBhbHJlYWR5IHJ1biAoaWUuIG11bHRpcGxlIGRpZ2VzdHMgaW4gb25lIGN5Y2xlKSwgZG8gbm90aGluZ1xyXG4gICAgICAgIGlmICghaGFuZGxlUmVzaXplV2hlblZpc2libGUud2F0Y2hlcikgcmV0dXJuO1xyXG5cclxuICAgICAgICBpZiAoJGVsZW1lbnQucHJvcCgnb2Zmc2V0UGFyZW50JykpIHtcclxuICAgICAgICAgIGhhbmRsZVJlc2l6ZVdoZW5WaXNpYmxlLndhdGNoZXIoKTtcclxuICAgICAgICAgIGhhbmRsZVJlc2l6ZVdoZW5WaXNpYmxlLndhdGNoZXIgPSBudWxsO1xyXG5cclxuICAgICAgICAgIC8vLS0gd2UgaGF2ZSB0byB0cmlnZ2VyIG91ciBvd24gJGFwcGx5IHNvIHRoYXQgdGhlIERPTSBiaW5kaW5ncyB3aWxsIHVwZGF0ZVxyXG4gICAgICAgICAgaGFuZGxlV2luZG93UmVzaXplKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LCAwLCBmYWxzZSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vLS0gRXZlbnQgaGFuZGxlcnMgLyBhY3Rpb25zXHJcblxyXG4gIC8qKlxyXG4gICAqIEhhbmRsZSB1c2VyIGtleWJvYXJkIGludGVyYWN0aW9uc1xyXG4gICAqIEBwYXJhbSBldmVudFxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGtleWRvd24gKGV2ZW50KSB7XHJcbiAgICBzd2l0Y2ggKGV2ZW50LmtleUNvZGUpIHtcclxuICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5MRUZUX0FSUk9XOlxyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgaW5jcmVtZW50U2VsZWN0ZWRJbmRleCgtMSwgdHJ1ZSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJG1kQ29uc3RhbnQuS0VZX0NPREUuUklHSFRfQVJST1c6XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBpbmNyZW1lbnRTZWxlY3RlZEluZGV4KDEsIHRydWUpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLlNQQUNFOlxyXG4gICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLkVOVEVSOlxyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgaWYgKCFsb2NrZWQpICRzY29wZS5zZWxlY3RlZEluZGV4ID0gY3RybC5mb2N1c0luZGV4O1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gICAgY3RybC5sYXN0Q2xpY2sgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVwZGF0ZSB0aGUgc2VsZWN0ZWQgaW5kZXggYW5kIHRyaWdnZXIgYSBjbGljayBldmVudCBvbiB0aGUgb3JpZ2luYWwgYG1kLXRhYmAgZWxlbWVudCBpbiBvcmRlclxyXG4gICAqIHRvIGZpcmUgdXNlci1hZGRlZCBjbGljayBldmVudHMuXHJcbiAgICogQHBhcmFtIGluZGV4XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gc2VsZWN0IChpbmRleCkge1xyXG4gICAgaWYgKCFsb2NrZWQpIGN0cmwuZm9jdXNJbmRleCA9ICRzY29wZS5zZWxlY3RlZEluZGV4ID0gaW5kZXg7XHJcbiAgICBjdHJsLmxhc3RDbGljayA9IHRydWU7XHJcbiAgICBjdHJsLnRhYnNbaW5kZXhdLmVsZW1lbnQudHJpZ2dlckhhbmRsZXIoJ2NsaWNrJyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBXaGVuIHBhZ2luYXRpb24gaXMgb24sIHRoaXMgbWFrZXMgc3VyZSB0aGUgc2VsZWN0ZWQgaW5kZXggaXMgaW4gdmlldy5cclxuICAgKiBAcGFyYW0gZXZlbnRcclxuICAgKi9cclxuICBmdW5jdGlvbiBzY3JvbGwgKGV2ZW50KSB7XHJcbiAgICBpZiAoIWN0cmwuc2hvdWxkUGFnaW5hdGUpIHJldHVybjtcclxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBjdHJsLm9mZnNldExlZnQgPSBmaXhPZmZzZXQoY3RybC5vZmZzZXRMZWZ0IC0gZXZlbnQud2hlZWxEZWx0YSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTbGlkZXMgdGhlIHRhYnMgb3ZlciBhcHByb3hpbWF0ZWx5IG9uZSBwYWdlIGZvcndhcmQuXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gbmV4dFBhZ2UgKCkge1xyXG4gICAgdmFyIHZpZXdwb3J0V2lkdGggPSBlbGVtZW50cy5jYW52YXMuY2xpZW50V2lkdGgsXHJcbiAgICAgICAgdG90YWxXaWR0aCA9IHZpZXdwb3J0V2lkdGggKyBjdHJsLm9mZnNldExlZnQsXHJcbiAgICAgICAgaSwgdGFiO1xyXG4gICAgZm9yIChpID0gMDsgaSA8IGVsZW1lbnRzLnRhYnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgdGFiID0gZWxlbWVudHMudGFic1tpXTtcclxuICAgICAgaWYgKHRhYi5vZmZzZXRMZWZ0ICsgdGFiLm9mZnNldFdpZHRoID4gdG90YWxXaWR0aCkgYnJlYWs7XHJcbiAgICB9XHJcbiAgICBjdHJsLm9mZnNldExlZnQgPSBmaXhPZmZzZXQodGFiLm9mZnNldExlZnQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2xpZGVzIHRoZSB0YWJzIG92ZXIgYXBwcm94aW1hdGVseSBvbmUgcGFnZSBiYWNrd2FyZC5cclxuICAgKi9cclxuICBmdW5jdGlvbiBwcmV2aW91c1BhZ2UgKCkge1xyXG4gICAgdmFyIGksIHRhYjtcclxuICAgIGZvciAoaSA9IDA7IGkgPCBlbGVtZW50cy50YWJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIHRhYiA9IGVsZW1lbnRzLnRhYnNbaV07XHJcbiAgICAgIGlmICh0YWIub2Zmc2V0TGVmdCArIHRhYi5vZmZzZXRXaWR0aCA+PSBjdHJsLm9mZnNldExlZnQpIGJyZWFrO1xyXG4gICAgfVxyXG4gICAgY3RybC5vZmZzZXRMZWZ0ID0gZml4T2Zmc2V0KHRhYi5vZmZzZXRMZWZ0ICsgdGFiLm9mZnNldFdpZHRoIC0gZWxlbWVudHMuY2FudmFzLmNsaWVudFdpZHRoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVwZGF0ZSBzaXplIGNhbGN1bGF0aW9ucyB3aGVuIHRoZSB3aW5kb3cgaXMgcmVzaXplZC5cclxuICAgKi9cclxuICBmdW5jdGlvbiBoYW5kbGVXaW5kb3dSZXNpemUgKCkge1xyXG4gICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGN0cmwubGFzdFNlbGVjdGVkSW5kZXggPSAkc2NvcGUuc2VsZWN0ZWRJbmRleDtcclxuICAgICAgY3RybC5vZmZzZXRMZWZ0ID0gZml4T2Zmc2V0KGN0cmwub2Zmc2V0TGVmdCk7XHJcbiAgICAgICR0aW1lb3V0KGN0cmwudXBkYXRlSW5rQmFyU3R5bGVzLCAwLCBmYWxzZSk7XHJcbiAgICAgICR0aW1lb3V0KHVwZGF0ZVBhZ2luYXRpb24pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZW1vdmUgYSB0YWIgZnJvbSB0aGUgZGF0YSBhbmQgc2VsZWN0IHRoZSBuZWFyZXN0IHZhbGlkIHRhYi5cclxuICAgKiBAcGFyYW0gdGFiRGF0YVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIHJlbW92ZVRhYiAodGFiRGF0YSkge1xyXG4gICAgdmFyIHNlbGVjdGVkSW5kZXggPSAkc2NvcGUuc2VsZWN0ZWRJbmRleCxcclxuICAgICAgICB0YWIgPSBjdHJsLnRhYnMuc3BsaWNlKHRhYkRhdGEuZ2V0SW5kZXgoKSwgMSlbMF07XHJcbiAgICByZWZyZXNoSW5kZXgoKTtcclxuICAgIC8vLS0gd2hlbiByZW1vdmluZyBhIHRhYiwgaWYgdGhlIHNlbGVjdGVkIGluZGV4IGRpZCBub3QgY2hhbmdlLCB3ZSBoYXZlIHRvIG1hbnVhbGx5IHRyaWdnZXIgdGhlXHJcbiAgICAvLyAgIHRhYiBzZWxlY3QvZGVzZWxlY3QgZXZlbnRzXHJcbiAgICBpZiAoJHNjb3BlLnNlbGVjdGVkSW5kZXggPT09IHNlbGVjdGVkSW5kZXggJiYgIWRlc3Ryb3llZCkge1xyXG4gICAgICB0YWIuc2NvcGUuZGVzZWxlY3QoKTtcclxuICAgICAgY3RybC50YWJzWyRzY29wZS5zZWxlY3RlZEluZGV4XSAmJiBjdHJsLnRhYnNbJHNjb3BlLnNlbGVjdGVkSW5kZXhdLnNjb3BlLnNlbGVjdCgpO1xyXG4gICAgfVxyXG4gICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICB1cGRhdGVQYWdpbmF0aW9uKCk7XHJcbiAgICAgIGN0cmwub2Zmc2V0TGVmdCA9IGZpeE9mZnNldChjdHJsLm9mZnNldExlZnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDcmVhdGUgYW4gZW50cnkgaW4gdGhlIHRhYnMgYXJyYXkgZm9yIGEgbmV3IHRhYiBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LlxyXG4gICAqIEBwYXJhbSB0YWJEYXRhXHJcbiAgICogQHBhcmFtIGluZGV4XHJcbiAgICogQHJldHVybnMgeyp9XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gaW5zZXJ0VGFiICh0YWJEYXRhLCBpbmRleCkge1xyXG4gICAgdmFyIHByb3RvID0ge1xyXG4gICAgICAgICAgZ2V0SW5kZXg6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGN0cmwudGFicy5pbmRleE9mKHRhYik7IH0sXHJcbiAgICAgICAgICBpc0FjdGl2ZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5nZXRJbmRleCgpID09PSAkc2NvcGUuc2VsZWN0ZWRJbmRleDsgfSxcclxuICAgICAgICAgIGlzTGVmdDogICBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLmdldEluZGV4KCkgPCAkc2NvcGUuc2VsZWN0ZWRJbmRleDsgfSxcclxuICAgICAgICAgIGlzUmlnaHQ6ICBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLmdldEluZGV4KCkgPiAkc2NvcGUuc2VsZWN0ZWRJbmRleDsgfSxcclxuICAgICAgICAgIHNob3VsZFJlbmRlcjogZnVuY3Rpb24gKCkgeyByZXR1cm4gISRzY29wZS5ub0Rpc2Nvbm5lY3QgfHwgdGhpcy5pc0FjdGl2ZSgpOyB9LFxyXG4gICAgICAgICAgaGFzRm9jdXM6IGZ1bmN0aW9uICgpIHsgcmV0dXJuICFjdHJsLmxhc3RDbGlja1xyXG4gICAgICAgICAgICAgICYmIGN0cmwuaGFzRm9jdXMgJiYgdGhpcy5nZXRJbmRleCgpID09PSBjdHJsLmZvY3VzSW5kZXg7IH0sXHJcbiAgICAgICAgICBpZDogICAgICAgJG1kVXRpbC5uZXh0VWlkKClcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRhYiA9IGFuZ3VsYXIuZXh0ZW5kKHByb3RvLCB0YWJEYXRhKTtcclxuICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChpbmRleCkpIHtcclxuICAgICAgY3RybC50YWJzLnNwbGljZShpbmRleCwgMCwgdGFiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGN0cmwudGFicy5wdXNoKHRhYik7XHJcbiAgICB9XHJcbiAgICBwcm9jZXNzUXVldWUoKTtcclxuICAgIHVwZGF0ZUhhc0NvbnRlbnQoKTtcclxuICAgIC8vLS0gaWYgYXV0b3NlbGVjdCBpcyBlbmFibGVkLCBzZWxlY3QgdGhlIG5ld2x5IGFkZGVkIHRhYlxyXG4gICAgaWYgKGxvYWRlZCAmJiAkc2NvcGUuYXV0b3NlbGVjdCkgJHRpbWVvdXQoZnVuY3Rpb24gKCkgeyBzZWxlY3QoY3RybC50YWJzLmluZGV4T2YodGFiKSk7IH0pO1xyXG4gICAgJHRpbWVvdXQodXBkYXRlUGFnaW5hdGlvbik7XHJcbiAgICByZXR1cm4gdGFiO1xyXG4gIH1cclxuXHJcbiAgLy8tLSBHZXR0ZXIgbWV0aG9kc1xyXG5cclxuICAvKipcclxuICAgKiBHYXRoZXJzIHJlZmVyZW5jZXMgdG8gYWxsIG9mIHRoZSBET00gZWxlbWVudHMgdXNlZCBieSB0aGlzIGNvbnRyb2xsZXIuXHJcbiAgICogQHJldHVybnMge3t9fVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGdldEVsZW1lbnRzICgpIHtcclxuICAgIHZhciBlbGVtZW50cyAgICAgID0ge307XHJcblxyXG4gICAgLy8tLSBnYXRoZXIgdGFiIGJhciBlbGVtZW50c1xyXG4gICAgZWxlbWVudHMud3JhcHBlciAgPSAkZWxlbWVudFswXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbWQtdGFicy13cmFwcGVyJylbMF07XHJcbiAgICBlbGVtZW50cy5kYXRhICAgICA9ICRlbGVtZW50WzBdLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdtZC10YWItZGF0YScpWzBdO1xyXG4gICAgZWxlbWVudHMuY2FudmFzICAgPSBlbGVtZW50cy53cmFwcGVyLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdtZC10YWJzLWNhbnZhcycpWzBdO1xyXG4gICAgZWxlbWVudHMucGFnaW5nICAgPSBlbGVtZW50cy5jYW52YXMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ21kLXBhZ2luYXRpb24td3JhcHBlcicpWzBdO1xyXG4gICAgZWxlbWVudHMudGFicyAgICAgPSBlbGVtZW50cy5wYWdpbmcuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ21kLXRhYi1pdGVtJyk7XHJcbiAgICBlbGVtZW50cy5kdW1taWVzICA9IGVsZW1lbnRzLmNhbnZhcy5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbWQtZHVtbXktdGFiJyk7XHJcbiAgICBlbGVtZW50cy5pbmtCYXIgICA9IGVsZW1lbnRzLnBhZ2luZy5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbWQtaW5rLWJhcicpWzBdO1xyXG5cclxuICAgIC8vLS0gZ2F0aGVyIHRhYiBjb250ZW50IGVsZW1lbnRzXHJcbiAgICBlbGVtZW50cy5jb250ZW50c1dyYXBwZXIgPSAkZWxlbWVudFswXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbWQtdGFicy1jb250ZW50LXdyYXBwZXInKVswXTtcclxuICAgIGVsZW1lbnRzLmNvbnRlbnRzID0gZWxlbWVudHMuY29udGVudHNXcmFwcGVyLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdtZC10YWItY29udGVudCcpO1xyXG5cclxuICAgIHJldHVybiBlbGVtZW50cztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIERldGVybWluZXMgd2hldGhlciBvciBub3QgdGhlIGxlZnQgcGFnaW5hdGlvbiBhcnJvdyBzaG91bGQgYmUgZW5hYmxlZC5cclxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgKi9cclxuICBmdW5jdGlvbiBjYW5QYWdlQmFjayAoKSB7XHJcbiAgICByZXR1cm4gY3RybC5vZmZzZXRMZWZ0ID4gMDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIERldGVybWluZXMgd2hldGhlciBvciBub3QgdGhlIHJpZ2h0IHBhZ2luYXRpb24gYXJyb3cgc2hvdWxkIGJlIGVuYWJsZWQuXHJcbiAgICogQHJldHVybnMgeyp8Ym9vbGVhbn1cclxuICAgKi9cclxuICBmdW5jdGlvbiBjYW5QYWdlRm9yd2FyZCAoKSB7XHJcbiAgICB2YXIgbGFzdFRhYiA9IGVsZW1lbnRzLnRhYnNbZWxlbWVudHMudGFicy5sZW5ndGggLSAxXTtcclxuICAgIHJldHVybiBsYXN0VGFiICYmIGxhc3RUYWIub2Zmc2V0TGVmdCArIGxhc3RUYWIub2Zmc2V0V2lkdGggPiBlbGVtZW50cy5jYW52YXMuY2xpZW50V2lkdGggK1xyXG4gICAgICAgIGN0cmwub2Zmc2V0TGVmdDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIERldGVybWluZXMgaWYgdGhlIFVJIHNob3VsZCBzdHJldGNoIHRoZSB0YWJzIHRvIGZpbGwgdGhlIGF2YWlsYWJsZSBzcGFjZS5cclxuICAgKiBAcmV0dXJucyB7Kn1cclxuICAgKi9cclxuICBmdW5jdGlvbiBzaG91bGRTdHJldGNoVGFicyAoKSB7XHJcbiAgICBzd2l0Y2ggKCRzY29wZS5zdHJldGNoVGFicykge1xyXG4gICAgICBjYXNlICdhbHdheXMnOiByZXR1cm4gdHJ1ZTtcclxuICAgICAgY2FzZSAnbmV2ZXInOiAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICBkZWZhdWx0OiAgICAgICByZXR1cm4gIWN0cmwuc2hvdWxkUGFnaW5hdGVcclxuICAgICAgICAgICYmICR3aW5kb3cubWF0Y2hNZWRpYSgnKG1heC13aWR0aDogNjAwcHgpJykubWF0Y2hlcztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIERldGVybWluZXMgaWYgdGhlIHRhYnMgc2hvdWxkIGFwcGVhciBjZW50ZXJlZC5cclxuICAgKiBAcmV0dXJucyB7c3RyaW5nfGJvb2xlYW59XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gc2hvdWxkQ2VudGVyVGFicyAoKSB7XHJcbiAgICByZXR1cm4gJHNjb3BlLmNlbnRlclRhYnMgJiYgIWN0cmwuc2hvdWxkUGFnaW5hdGU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEZXRlcm1pbmVzIGlmIHBhZ2luYXRpb24gaXMgbmVjZXNzYXJ5IHRvIGRpc3BsYXkgdGhlIHRhYnMgd2l0aGluIHRoZSBhdmFpbGFibGUgc3BhY2UuXHJcbiAgICogQHJldHVybnMge2Jvb2xlYW59XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gc2hvdWxkUGFnaW5hdGUgKCkge1xyXG4gICAgaWYgKCRzY29wZS5ub1BhZ2luYXRpb24gfHwgIWxvYWRlZCkgcmV0dXJuIGZhbHNlO1xyXG4gICAgdmFyIGNhbnZhc1dpZHRoID0gJGVsZW1lbnQucHJvcCgnY2xpZW50V2lkdGgnKTtcclxuICAgIGFuZ3VsYXIuZm9yRWFjaChlbGVtZW50cy5kdW1taWVzLCBmdW5jdGlvbiAodGFiKSB7IGNhbnZhc1dpZHRoIC09IHRhYi5vZmZzZXRXaWR0aDsgfSk7XHJcbiAgICByZXR1cm4gY2FudmFzV2lkdGggPCAwO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmluZHMgdGhlIG5lYXJlc3QgdGFiIGluZGV4IHRoYXQgaXMgYXZhaWxhYmxlLiAgVGhpcyBpcyBwcmltYXJpbHkgdXNlZCBmb3Igd2hlbiB0aGUgYWN0aXZlXHJcbiAgICogdGFiIGlzIHJlbW92ZWQuXHJcbiAgICogQHBhcmFtIG5ld0luZGV4XHJcbiAgICogQHJldHVybnMgeyp9XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gZ2V0TmVhcmVzdFNhZmVJbmRleChuZXdJbmRleCkge1xyXG4gICAgdmFyIG1heE9mZnNldCA9IE1hdGgubWF4KGN0cmwudGFicy5sZW5ndGggLSBuZXdJbmRleCwgbmV3SW5kZXgpLFxyXG4gICAgICAgIGksIHRhYjtcclxuICAgIGZvciAoaSA9IDA7IGkgPD0gbWF4T2Zmc2V0OyBpKyspIHtcclxuICAgICAgdGFiID0gY3RybC50YWJzW25ld0luZGV4ICsgaV07XHJcbiAgICAgIGlmICh0YWIgJiYgKHRhYi5zY29wZS5kaXNhYmxlZCAhPT0gdHJ1ZSkpIHJldHVybiB0YWIuZ2V0SW5kZXgoKTtcclxuICAgICAgdGFiID0gY3RybC50YWJzW25ld0luZGV4IC0gaV07XHJcbiAgICAgIGlmICh0YWIgJiYgKHRhYi5zY29wZS5kaXNhYmxlZCAhPT0gdHJ1ZSkpIHJldHVybiB0YWIuZ2V0SW5kZXgoKTtcclxuICAgIH1cclxuICAgIHJldHVybiBuZXdJbmRleDtcclxuICB9XHJcblxyXG4gIC8vLS0gVXRpbGl0eSBtZXRob2RzXHJcblxyXG4gIC8qKlxyXG4gICAqIERlZmluZXMgYSBwcm9wZXJ0eSB1c2luZyBhIGdldHRlciBhbmQgc2V0dGVyIGluIG9yZGVyIHRvIHRyaWdnZXIgYSBjaGFuZ2UgaGFuZGxlciB3aXRob3V0XHJcbiAgICogdXNpbmcgYCR3YXRjaGAgdG8gb2JzZXJ2ZSBjaGFuZ2VzLlxyXG4gICAqIEBwYXJhbSBrZXlcclxuICAgKiBAcGFyYW0gaGFuZGxlclxyXG4gICAqIEBwYXJhbSB2YWx1ZVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5IChrZXksIGhhbmRsZXIsIHZhbHVlKSB7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY3RybCwga2V5LCB7XHJcbiAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdmFsdWU7IH0sXHJcbiAgICAgIHNldDogZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XHJcbiAgICAgICAgdmFyIG9sZFZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgdmFsdWUgPSBuZXdWYWx1ZTtcclxuICAgICAgICBoYW5kbGVyKG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlcyB3aGV0aGVyIG9yIG5vdCBwYWdpbmF0aW9uIHNob3VsZCBiZSBkaXNwbGF5ZWQuXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gdXBkYXRlUGFnaW5hdGlvbiAoKSB7XHJcbiAgICBjdHJsLnNob3VsZFBhZ2luYXRlID0gc2hvdWxkUGFnaW5hdGUoKTtcclxuICAgIGN0cmwuc2hvdWxkQ2VudGVyVGFicyA9IHNob3VsZENlbnRlclRhYnMoKTtcclxuICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgYWRqdXN0T2Zmc2V0KCRzY29wZS5zZWxlY3RlZEluZGV4KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmUtb3JkZXJzIHRoZSB0YWJzIGFuZCB1cGRhdGVzIHRoZSBzZWxlY3RlZCBhbmQgZm9jdXMgaW5kZXhlcyB0byB0aGVpciBuZXcgcG9zaXRpb25zLlxyXG4gICAqIFRoaXMgaXMgdHJpZ2dlcmVkIGJ5IGB0YWJEaXJlY3RpdmUuanNgIHdoZW4gdGhlIHVzZXIncyB0YWJzIGhhdmUgYmVlbiByZS1vcmRlcmVkLlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIHVwZGF0ZVRhYk9yZGVyICgpIHtcclxuICAgIHZhciBzZWxlY3RlZEl0ZW0gPSBjdHJsLnRhYnNbJHNjb3BlLnNlbGVjdGVkSW5kZXhdLFxyXG4gICAgICAgIGZvY3VzSXRlbSA9IGN0cmwudGFic1tjdHJsLmZvY3VzSW5kZXhdO1xyXG4gICAgY3RybC50YWJzID0gY3RybC50YWJzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgcmV0dXJuIGEuaW5kZXggLSBiLmluZGV4O1xyXG4gICAgfSk7XHJcbiAgICAkc2NvcGUuc2VsZWN0ZWRJbmRleCA9IGN0cmwudGFicy5pbmRleE9mKHNlbGVjdGVkSXRlbSk7XHJcbiAgICBjdHJsLmZvY3VzSW5kZXggPSBjdHJsLnRhYnMuaW5kZXhPZihmb2N1c0l0ZW0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBtb3ZlcyB0aGUgc2VsZWN0ZWQgb3IgZm9jdXMgaW5kZXggbGVmdCBvciByaWdodC4gIFRoaXMgaXMgdXNlZCBieSB0aGUga2V5ZG93biBoYW5kbGVyLlxyXG4gICAqIEBwYXJhbSBpbmNcclxuICAgKi9cclxuICBmdW5jdGlvbiBpbmNyZW1lbnRTZWxlY3RlZEluZGV4IChpbmMpIHtcclxuICAgIHZhciBuZXdJbmRleCxcclxuICAgICAgICBpbmRleCA9IGN0cmwuZm9jdXNJbmRleDtcclxuICAgIGZvciAobmV3SW5kZXggPSBpbmRleCArIGluYztcclxuICAgICAgICAgY3RybC50YWJzW25ld0luZGV4XSAmJiBjdHJsLnRhYnNbbmV3SW5kZXhdLnNjb3BlLmRpc2FibGVkO1xyXG4gICAgICAgICBuZXdJbmRleCArPSBpbmMpIHt9XHJcbiAgICBpZiAoY3RybC50YWJzW25ld0luZGV4XSkge1xyXG4gICAgICBjdHJsLmZvY3VzSW5kZXggPSBuZXdJbmRleDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgaXMgdXNlZCB0byBmb3J3YXJkIGZvY3VzIHRvIGR1bW15IGVsZW1lbnRzLiAgVGhpcyBtZXRob2QgaXMgbmVjZXNzYXJ5IHRvIGF2b2lkIGFuaWF0aW9uXHJcbiAgICogaXNzdWVzIHdoZW4gYXR0ZW1wdGluZyB0byBmb2N1cyBhbiBpdGVtIHRoYXQgaXMgb3V0IG9mIHZpZXcuXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gcmVkaXJlY3RGb2N1cyAoKSB7XHJcbiAgICBlbGVtZW50cy5kdW1taWVzW2N0cmwuZm9jdXNJbmRleF0uZm9jdXMoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZvcmNlcyB0aGUgcGFnaW5hdGlvbiB0byBtb3ZlIHRoZSBmb2N1c2VkIHRhYiBpbnRvIHZpZXcuXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gYWRqdXN0T2Zmc2V0IChpbmRleCkge1xyXG4gICAgaWYgKCFlbGVtZW50cy50YWJzW2luZGV4XSkgcmV0dXJuO1xyXG4gICAgaWYgKGN0cmwuc2hvdWxkQ2VudGVyVGFicykgcmV0dXJuO1xyXG4gICAgaWYgKGluZGV4ID09IG51bGwpIGluZGV4ID0gY3RybC5mb2N1c0luZGV4O1xyXG4gICAgdmFyIHRhYiA9IGVsZW1lbnRzLnRhYnNbaW5kZXhdLFxyXG4gICAgICAgIGxlZnQgPSB0YWIub2Zmc2V0TGVmdCxcclxuICAgICAgICByaWdodCA9IHRhYi5vZmZzZXRXaWR0aCArIGxlZnQ7XHJcbiAgICBjdHJsLm9mZnNldExlZnQgPSBNYXRoLm1heChjdHJsLm9mZnNldExlZnQsIGZpeE9mZnNldChyaWdodCAtIGVsZW1lbnRzLmNhbnZhcy5jbGllbnRXaWR0aCkpO1xyXG4gICAgY3RybC5vZmZzZXRMZWZ0ID0gTWF0aC5taW4oY3RybC5vZmZzZXRMZWZ0LCBmaXhPZmZzZXQobGVmdCkpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSXRlcmF0ZXMgdGhyb3VnaCBhbGwgcXVldWVkIGZ1bmN0aW9ucyBhbmQgY2xlYXJzIHRoZSBxdWV1ZS4gIFRoaXMgaXMgdXNlZCBmb3IgZnVuY3Rpb25zIHRoYXRcclxuICAgKiBhcmUgY2FsbGVkIGJlZm9yZSB0aGUgVUkgaXMgcmVhZHksIHN1Y2ggYXMgc2l6ZSBjYWxjdWxhdGlvbnMuXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gcHJvY2Vzc1F1ZXVlICgpIHtcclxuICAgIHF1ZXVlLmZvckVhY2goZnVuY3Rpb24gKGZ1bmMpIHsgJHRpbWVvdXQoZnVuYyk7IH0pO1xyXG4gICAgcXVldWUgPSBbXTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIERldGVybWluZXMgaWYgdGhlIHRhYiBjb250ZW50IGFyZWEgaXMgbmVlZGVkLlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIHVwZGF0ZUhhc0NvbnRlbnQgKCkge1xyXG4gICAgdmFyIGhhc0NvbnRlbnQgPSBmYWxzZTtcclxuICAgIGFuZ3VsYXIuZm9yRWFjaChjdHJsLnRhYnMsIGZ1bmN0aW9uICh0YWIpIHtcclxuICAgICAgaWYgKHRhYi50ZW1wbGF0ZSkgaGFzQ29udGVudCA9IHRydWU7XHJcbiAgICB9KTtcclxuICAgIGN0cmwuaGFzQ29udGVudCA9IGhhc0NvbnRlbnQ7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBNb3ZlcyB0aGUgaW5kZXhlcyB0byB0aGVpciBuZWFyZXN0IHZhbGlkIHZhbHVlcy5cclxuICAgKi9cclxuICBmdW5jdGlvbiByZWZyZXNoSW5kZXggKCkge1xyXG4gICAgJHNjb3BlLnNlbGVjdGVkSW5kZXggPSBnZXROZWFyZXN0U2FmZUluZGV4KCRzY29wZS5zZWxlY3RlZEluZGV4KTtcclxuICAgIGN0cmwuZm9jdXNJbmRleCA9IGdldE5lYXJlc3RTYWZlSW5kZXgoY3RybC5mb2N1c0luZGV4KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENhbGN1bGF0ZXMgdGhlIGNvbnRlbnQgaGVpZ2h0IG9mIHRoZSBjdXJyZW50IHRhYi5cclxuICAgKiBAcmV0dXJucyB7Kn1cclxuICAgKi9cclxuICBmdW5jdGlvbiB1cGRhdGVIZWlnaHRGcm9tQ29udGVudCAoKSB7XHJcbiAgICBpZiAoISRzY29wZS5keW5hbWljSGVpZ2h0KSByZXR1cm4gJGVsZW1lbnQuY3NzKCdoZWlnaHQnLCAnJyk7XHJcbiAgICBpZiAoIWN0cmwudGFicy5sZW5ndGgpIHJldHVybiBxdWV1ZS5wdXNoKHVwZGF0ZUhlaWdodEZyb21Db250ZW50KTtcclxuICAgIHZhciB0YWJDb250ZW50ICAgID0gZWxlbWVudHMuY29udGVudHNbJHNjb3BlLnNlbGVjdGVkSW5kZXhdLFxyXG4gICAgICAgIGNvbnRlbnRIZWlnaHQgPSB0YWJDb250ZW50ID8gdGFiQ29udGVudC5vZmZzZXRIZWlnaHQgOiAwLFxyXG4gICAgICAgIHRhYnNIZWlnaHQgICAgPSBlbGVtZW50cy53cmFwcGVyLm9mZnNldEhlaWdodCxcclxuICAgICAgICBuZXdIZWlnaHQgICAgID0gY29udGVudEhlaWdodCArIHRhYnNIZWlnaHQsXHJcbiAgICAgICAgY3VycmVudEhlaWdodCA9ICRlbGVtZW50LnByb3AoJ2NsaWVudEhlaWdodCcpO1xyXG4gICAgaWYgKGN1cnJlbnRIZWlnaHQgPT09IG5ld0hlaWdodCkgcmV0dXJuO1xyXG4gICAgbG9ja2VkID0gdHJ1ZTtcclxuICAgICRhbmltYXRlXHJcbiAgICAgICAgLmFuaW1hdGUoXHJcbiAgICAgICAgICAkZWxlbWVudCxcclxuICAgICAgICAgIHsgaGVpZ2h0OiBjdXJyZW50SGVpZ2h0ICsgJ3B4JyB9LFxyXG4gICAgICAgICAgeyBoZWlnaHQ6IG5ld0hlaWdodCArICdweCd9XHJcbiAgICAgICAgKVxyXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICRlbGVtZW50LmNzcygnaGVpZ2h0JywgJycpO1xyXG4gICAgICAgICAgbG9ja2VkID0gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXBvc2l0aW9ucyB0aGUgaW5rIGJhciB0byB0aGUgc2VsZWN0ZWQgdGFiLlxyXG4gICAqIEByZXR1cm5zIHsqfVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIHVwZGF0ZUlua0JhclN0eWxlcyAoKSB7XHJcbiAgICBpZiAoIWVsZW1lbnRzLnRhYnNbJHNjb3BlLnNlbGVjdGVkSW5kZXhdKSByZXR1cm47XHJcbiAgICBpZiAoIWN0cmwudGFicy5sZW5ndGgpIHJldHVybiBxdWV1ZS5wdXNoKGN0cmwudXBkYXRlSW5rQmFyU3R5bGVzKTtcclxuICAgIC8vLS0gaWYgdGhlIGVsZW1lbnQgaXMgbm90IHZpc2libGUsIHdlIHdpbGwgbm90IGJlIGFibGUgdG8gY2FsY3VsYXRlIHNpemVzIHVudGlsIGl0IGlzXHJcbiAgICAvLy0tIHdlIHNob3VsZCB0cmVhdCB0aGF0IGFzIGEgcmVzaXplIGV2ZW50IHJhdGhlciB0aGFuIGp1c3QgdXBkYXRpbmcgdGhlIGluayBiYXJcclxuICAgIGlmICghJGVsZW1lbnQucHJvcCgnb2Zmc2V0UGFyZW50JykpIHJldHVybiBoYW5kbGVSZXNpemVXaGVuVmlzaWJsZSgpO1xyXG4gICAgdmFyIGluZGV4ID0gJHNjb3BlLnNlbGVjdGVkSW5kZXgsXHJcbiAgICAgICAgdG90YWxXaWR0aCA9IGVsZW1lbnRzLnBhZ2luZy5vZmZzZXRXaWR0aCxcclxuICAgICAgICB0YWIgPSBlbGVtZW50cy50YWJzW2luZGV4XSxcclxuICAgICAgICBsZWZ0ID0gdGFiLm9mZnNldExlZnQsXHJcbiAgICAgICAgcmlnaHQgPSB0b3RhbFdpZHRoIC0gbGVmdCAtIHRhYi5vZmZzZXRXaWR0aDtcclxuICAgIHVwZGF0ZUlua0JhckNsYXNzTmFtZSgpO1xyXG4gICAgYW5ndWxhci5lbGVtZW50KGVsZW1lbnRzLmlua0JhcikuY3NzKHsgbGVmdDogbGVmdCArICdweCcsIHJpZ2h0OiByaWdodCArICdweCcgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBBZGRzIGxlZnQvcmlnaHQgY2xhc3NlcyBzbyB0aGF0IHRoZSBpbmsgYmFyIHdpbGwgYW5pbWF0ZSBwcm9wZXJseS5cclxuICAgKi9cclxuICBmdW5jdGlvbiB1cGRhdGVJbmtCYXJDbGFzc05hbWUgKCkge1xyXG4gICAgdmFyIG5ld0luZGV4ID0gJHNjb3BlLnNlbGVjdGVkSW5kZXgsXHJcbiAgICAgICAgb2xkSW5kZXggPSBjdHJsLmxhc3RTZWxlY3RlZEluZGV4LFxyXG4gICAgICAgIGluayA9IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50cy5pbmtCYXIpO1xyXG4gICAgaWYgKCFhbmd1bGFyLmlzTnVtYmVyKG9sZEluZGV4KSkgcmV0dXJuO1xyXG4gICAgaWYgKG5ld0luZGV4IDwgb2xkSW5kZXgpIHtcclxuICAgICAgaW5rLmFkZENsYXNzKCdtZC1sZWZ0JykucmVtb3ZlQ2xhc3MoJ21kLXJpZ2h0Jyk7XHJcbiAgICB9IGVsc2UgaWYgKG5ld0luZGV4ID4gb2xkSW5kZXgpIHtcclxuICAgICAgaW5rLmFkZENsYXNzKCdtZC1yaWdodCcpLnJlbW92ZUNsYXNzKCdtZC1sZWZ0Jyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUYWtlcyBhbiBvZmZzZXQgdmFsdWUgYW5kIG1ha2VzIHN1cmUgdGhhdCBpdCBpcyB3aXRoaW4gdGhlIG1pbi9tYXggYWxsb3dlZCB2YWx1ZXMuXHJcbiAgICogQHBhcmFtIHZhbHVlXHJcbiAgICogQHJldHVybnMgeyp9XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gZml4T2Zmc2V0ICh2YWx1ZSkge1xyXG4gICAgaWYgKCFlbGVtZW50cy50YWJzLmxlbmd0aCB8fCAhY3RybC5zaG91bGRQYWdpbmF0ZSkgcmV0dXJuIDA7XHJcbiAgICB2YXIgbGFzdFRhYiA9IGVsZW1lbnRzLnRhYnNbZWxlbWVudHMudGFicy5sZW5ndGggLSAxXSxcclxuICAgICAgICB0b3RhbFdpZHRoID0gbGFzdFRhYi5vZmZzZXRMZWZ0ICsgbGFzdFRhYi5vZmZzZXRXaWR0aDtcclxuICAgIHZhbHVlID0gTWF0aC5tYXgoMCwgdmFsdWUpO1xyXG4gICAgdmFsdWUgPSBNYXRoLm1pbih0b3RhbFdpZHRoIC0gZWxlbWVudHMuY2FudmFzLmNsaWVudFdpZHRoLCB2YWx1ZSk7XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBBdHRhY2hlcyBhIHJpcHBsZSB0byB0aGUgdGFiIGl0ZW0gZWxlbWVudC5cclxuICAgKiBAcGFyYW0gc2NvcGVcclxuICAgKiBAcGFyYW0gZWxlbWVudFxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGF0dGFjaFJpcHBsZSAoc2NvcGUsIGVsZW1lbnQpIHtcclxuICAgIHZhciBvcHRpb25zID0geyBjb2xvckVsZW1lbnQ6IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50cy5pbmtCYXIpIH07XHJcbiAgICAkbWRUYWJJbmtSaXBwbGUuYXR0YWNoKHNjb3BlLCBlbGVtZW50LCBvcHRpb25zKTtcclxuICB9XHJcbn1cclxuTWRUYWJzQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiJGVsZW1lbnRcIiwgXCIkd2luZG93XCIsIFwiJHRpbWVvdXRcIiwgXCIkbWRDb25zdGFudFwiLCBcIiRtZFRhYklua1JpcHBsZVwiLCBcIiRtZFV0aWxcIiwgXCIkYW5pbWF0ZVwiLCBcIiRhdHRyc1wiLCBcIiRjb21waWxlXCIsIFwiJG1kVGhlbWluZ1wiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAqIEBuYW1lIG1kVGFic1xyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMudGFic1xyXG4gKlxyXG4gKiBAcmVzdHJpY3QgRVxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogVGhlIGA8bWQtdGFicz5gIGRpcmVjdGl2ZSBzZXJ2ZXMgYXMgdGhlIGNvbnRhaW5lciBmb3IgMS4ubiBgPG1kLXRhYj5gIGNoaWxkIGRpcmVjdGl2ZXMgdG8gcHJvZHVjZXMgYSBUYWJzIGNvbXBvbmVudHMuXHJcbiAqIEluIHR1cm4sIHRoZSBuZXN0ZWQgYDxtZC10YWI+YCBkaXJlY3RpdmUgaXMgdXNlZCB0byBzcGVjaWZ5IGEgdGFiIGxhYmVsIGZvciB0aGUgKipoZWFkZXIgYnV0dG9uKiogYW5kIGEgW29wdGlvbmFsXSB0YWIgdmlld1xyXG4gKiBjb250ZW50IHRoYXQgd2lsbCBiZSBhc3NvY2lhdGVkIHdpdGggZWFjaCB0YWIgYnV0dG9uLlxyXG4gKlxyXG4gKiBCZWxvdyBpcyB0aGUgbWFya3VwIGZvciBpdHMgc2ltcGxlc3QgdXNhZ2U6XHJcbiAqXHJcbiAqICA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiAgPG1kLXRhYnM+XHJcbiAqICAgIDxtZC10YWIgbGFiZWw9XCJUYWIgIzFcIj48L21kLXRhYj5cclxuICogICAgPG1kLXRhYiBsYWJlbD1cIlRhYiAjMlwiPjwvbWQtdGFiPlxyXG4gKiAgICA8bWQtdGFiIGxhYmVsPVwiVGFiICMzXCI+PC9tZC10YWI+XHJcbiAqICA8L21kLXRhYnM+XHJcbiAqICA8L2hsanM+XHJcbiAqXHJcbiAqIFRhYnMgc3VwcG9ydHMgdGhyZWUgKDMpIHVzYWdlIHNjZW5hcmlvczpcclxuICpcclxuICogIDEuIFRhYnMgKGJ1dHRvbnMgb25seSlcclxuICogIDIuIFRhYnMgd2l0aCBpbnRlcm5hbCB2aWV3IGNvbnRlbnRcclxuICogIDMuIFRhYnMgd2l0aCBleHRlcm5hbCB2aWV3IGNvbnRlbnRcclxuICpcclxuICogKipUYWItb25seSoqIHN1cHBvcnQgaXMgdXNlZnVsIHdoZW4gdGFiIGJ1dHRvbnMgYXJlIHVzZWQgZm9yIGN1c3RvbSBuYXZpZ2F0aW9uIHJlZ2FyZGxlc3Mgb2YgYW55IG90aGVyIGNvbXBvbmVudHMsIGNvbnRlbnQsIG9yIHZpZXdzLlxyXG4gKiAqKlRhYnMgd2l0aCBpbnRlcm5hbCB2aWV3cyoqIGFyZSB0aGUgdHJhZGl0aW9uYWwgdXNhZ2VzIHdoZXJlIGVhY2ggdGFiIGhhcyBhc3NvY2lhdGVkIHZpZXcgY29udGVudCBhbmQgdGhlIHZpZXcgc3dpdGNoaW5nIGlzIG1hbmFnZWQgaW50ZXJuYWxseSBieSB0aGUgVGFicyBjb21wb25lbnQuXHJcbiAqICoqVGFicyB3aXRoIGV4dGVybmFsIHZpZXcgY29udGVudCoqIGlzIG9mdGVuIHVzZWZ1bCB3aGVuIGNvbnRlbnQgYXNzb2NpYXRlZCB3aXRoIGVhY2ggdGFiIGlzIGluZGVwZW5kZW50bHkgbWFuYWdlZCBhbmQgZGF0YS1iaW5kaW5nIG5vdGlmaWNhdGlvbnMgYW5ub3VuY2UgdGFiIHNlbGVjdGlvbiBjaGFuZ2VzLlxyXG4gKlxyXG4gKiBBZGRpdGlvbmFsIGZlYXR1cmVzIGFsc28gaW5jbHVkZTpcclxuICpcclxuICogKiAgQ29udGVudCBjYW4gaW5jbHVkZSBhbnkgbWFya3VwLlxyXG4gKiAqICBJZiBhIHRhYiBpcyBkaXNhYmxlZCB3aGlsZSBhY3RpdmUvc2VsZWN0ZWQsIHRoZW4gdGhlIG5leHQgdGFiIHdpbGwgYmUgYXV0by1zZWxlY3RlZC5cclxuICpcclxuICogIyMjIEV4cGxhbmF0aW9uIG9mIHRhYiBzdHJldGNoaW5nXHJcbiAqXHJcbiAqIEluaXRpYWxseSwgdGFicyB3aWxsIGhhdmUgYW4gaW5oZXJlbnQgc2l6ZS4gIFRoaXMgc2l6ZSB3aWxsIGVpdGhlciBiZSBkZWZpbmVkIGJ5IGhvdyBtdWNoIHNwYWNlIGlzIG5lZWRlZCB0byBhY2NvbW1vZGF0ZSB0aGVpciB0ZXh0IG9yIHNldCBieSB0aGUgdXNlciB0aHJvdWdoIENTUy4gIENhbGN1bGF0aW9ucyB3aWxsIGJlIGJhc2VkIG9uIHRoaXMgc2l6ZS5cclxuICpcclxuICogT24gbW9iaWxlIGRldmljZXMsIHRhYnMgd2lsbCBiZSBleHBhbmRlZCB0byBmaWxsIHRoZSBhdmFpbGFibGUgaG9yaXpvbnRhbCBzcGFjZS4gIFdoZW4gdGhpcyBoYXBwZW5zLCBhbGwgdGFicyB3aWxsIGJlY29tZSB0aGUgc2FtZSBzaXplLlxyXG4gKlxyXG4gKiBPbiBkZXNrdG9wcywgYnkgZGVmYXVsdCwgc3RyZXRjaGluZyB3aWxsIG5ldmVyIG9jY3VyLlxyXG4gKlxyXG4gKiBUaGlzIGRlZmF1bHQgYmVoYXZpb3IgY2FuIGJlIG92ZXJyaWRkZW4gdGhyb3VnaCB0aGUgYG1kLXN0cmV0Y2gtdGFic2AgYXR0cmlidXRlLiAgSGVyZSBpcyBhIHRhYmxlIHNob3dpbmcgd2hlbiBzdHJldGNoaW5nIHdpbGwgb2NjdXI6XHJcbiAqXHJcbiAqIGBtZC1zdHJldGNoLXRhYnNgIHwgbW9iaWxlICAgIHwgZGVza3RvcFxyXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS18LS0tLS0tLS1cclxuICogYGF1dG9gICAgICAgICAgICAgfCBzdHJldGNoZWQgfCAtLS1cclxuICogYGFsd2F5c2AgICAgICAgICAgfCBzdHJldGNoZWQgfCBzdHJldGNoZWRcclxuICogYG5ldmVyYCAgICAgICAgICAgfCAtLS0gICAgICAgfCAtLS1cclxuICpcclxuICogQHBhcmFtIHtpbnRlZ2VyPX0gbWQtc2VsZWN0ZWQgSW5kZXggb2YgdGhlIGFjdGl2ZS9zZWxlY3RlZCB0YWJcclxuICogQHBhcmFtIHtib29sZWFuPX0gbWQtbm8taW5rIElmIHByZXNlbnQsIGRpc2FibGVzIGluayByaXBwbGUgZWZmZWN0cy5cclxuICogQHBhcmFtIHtib29sZWFuPX0gbWQtbm8tYmFyIElmIHByZXNlbnQsIGRpc2FibGVzIHRoZSBzZWxlY3Rpb24gaW5rIGJhci5cclxuICogQHBhcmFtIHtzdHJpbmc9fSAgbWQtYWxpZ24tdGFicyBBdHRyaWJ1dGUgdG8gaW5kaWNhdGUgcG9zaXRpb24gb2YgdGFiIGJ1dHRvbnM6IGBib3R0b21gIG9yIGB0b3BgOyBkZWZhdWx0IGlzIGB0b3BgXHJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gbWQtc3RyZXRjaC10YWJzIEF0dHJpYnV0ZSB0byBpbmRpY2F0ZSB3aGV0aGVyIG9yIG5vdCB0byBzdHJldGNoIHRhYnM6IGBhdXRvYCwgYGFsd2F5c2AsIG9yIGBuZXZlcmA7IGRlZmF1bHQgaXMgYGF1dG9gXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG1kLWR5bmFtaWMtaGVpZ2h0IFdoZW4gZW5hYmxlZCwgdGhlIHRhYiB3cmFwcGVyIHdpbGwgcmVzaXplIGJhc2VkIG9uIHRoZSBjb250ZW50cyBvZiB0aGUgc2VsZWN0ZWQgdGFiXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG1kLWNlbnRlci10YWJzIFdoZW4gZW5hYmxlZCwgdGFicyB3aWxsIGJlIGNlbnRlcmVkIHByb3ZpZGVkIHRoZXJlIGlzIG5vIG5lZWQgZm9yIHBhZ2luYXRpb25cclxuICogQHBhcmFtIHtib29sZWFuPX0gbWQtbm8tcGFnaW5hdGlvbiBXaGVuIGVuYWJsZWQsIHBhZ2luYXRpb24gd2lsbCByZW1haW4gb2ZmXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG1kLXN3aXBlLWNvbnRlbnQgV2hlbiBlbmFibGVkLCBzd2lwZSBnZXN0dXJlcyB3aWxsIGJlIGVuYWJsZWQgZm9yIHRoZSBjb250ZW50IGFyZWEgdG8ganVtcCBiZXR3ZWVuIHRhYnNcclxuICogQHBhcmFtIHtib29sZWFuPX0gbWQtbm8tZGlzY29ubmVjdCBJZiB5b3VyIHRhYiBjb250ZW50IGhhcyBiYWNrZ3JvdW5kIHRhc2tzIChpZS4gZXZlbnQgbGlzdGVuZXJzKSwgeW91IHdpbGwgd2FudCB0byBpbmNsdWRlIHRoaXMgdG8gcHJldmVudCB0aGUgc2NvcGUgZnJvbSBiZWluZyBkaXNjb25uZWN0ZWRcclxuICogQHBhcmFtIHtib29sZWFuPX0gbWQtYXV0b3NlbGVjdCBXaGVuIHByZXNlbnQsIGFueSB0YWJzIGFkZGVkIGFmdGVyIHRoZSBpbml0aWFsIGxvYWQgd2lsbCBiZSBhdXRvbWF0aWNhbGx5IHNlbGVjdGVkXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtdGFicyBtZC1zZWxlY3RlZD1cInNlbGVjdGVkSW5kZXhcIiA+XHJcbiAqICAgPGltZyBuZy1zcmM9XCJpbWcvYW5ndWxhci5wbmdcIiBjbGFzcz1cImNlbnRlcmVkXCI+XHJcbiAqICAgPG1kLXRhYlxyXG4gKiAgICAgICBuZy1yZXBlYXQ9XCJ0YWIgaW4gdGFicyB8IG9yZGVyQnk6cHJlZGljYXRlOnJldmVyc2VkXCJcclxuICogICAgICAgbWQtb24tc2VsZWN0PVwib25UYWJTZWxlY3RlZCh0YWIpXCJcclxuICogICAgICAgbWQtb24tZGVzZWxlY3Q9XCJhbm5vdW5jZURlc2VsZWN0ZWQodGFiKVwiXHJcbiAqICAgICAgIG5nLWRpc2FibGVkPVwidGFiLmRpc2FibGVkXCI+XHJcbiAqICAgICA8bWQtdGFiLWxhYmVsPlxyXG4gKiAgICAgICB7e3RhYi50aXRsZX19XHJcbiAqICAgICAgIDxpbWcgc3JjPVwiaW1nL3JlbW92ZVRhYi5wbmdcIiBuZy1jbGljaz1cInJlbW92ZVRhYih0YWIpXCIgY2xhc3M9XCJkZWxldGVcIj5cclxuICogICAgIDwvbWQtdGFiLWxhYmVsPlxyXG4gKiAgICAgPG1kLXRhYi1ib2R5PlxyXG4gKiAgICAgICB7e3RhYi5jb250ZW50fX1cclxuICogICAgIDwvbWQtdGFiLWJvZHk+XHJcbiAqICAgPC9tZC10YWI+XHJcbiAqIDwvbWQtdGFicz5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKi9cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy50YWJzJylcclxuICAgIC5kaXJlY3RpdmUoJ21kVGFicycsIE1kVGFicyk7XHJcblxyXG5mdW5jdGlvbiBNZFRhYnMgKCRtZFRoZW1pbmcsICRtZFV0aWwsICRjb21waWxlKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHNjb3BlOiB7XHJcbiAgICAgIG5vUGFnaW5hdGlvbjogICc9P21kTm9QYWdpbmF0aW9uJyxcclxuICAgICAgZHluYW1pY0hlaWdodDogJz0/bWREeW5hbWljSGVpZ2h0JyxcclxuICAgICAgY2VudGVyVGFiczogICAgJz0/bWRDZW50ZXJUYWJzJyxcclxuICAgICAgc2VsZWN0ZWRJbmRleDogJz0/bWRTZWxlY3RlZCcsXHJcbiAgICAgIHN0cmV0Y2hUYWJzOiAgICdAP21kU3RyZXRjaFRhYnMnLFxyXG4gICAgICBzd2lwZUNvbnRlbnQ6ICAnPT9tZFN3aXBlQ29udGVudCcsXHJcbiAgICAgIG5vRGlzY29ubmVjdDogICc9P21kTm9EaXNjb25uZWN0JyxcclxuICAgICAgYXV0b3NlbGVjdDogICAgJz0/bWRBdXRvc2VsZWN0J1xyXG4gICAgfSxcclxuICAgIHRlbXBsYXRlOiBmdW5jdGlvbiAoZWxlbWVudCwgYXR0cikge1xyXG4gICAgICBhdHRyW1wiJG1kVGFic1RlbXBsYXRlXCJdID0gZWxlbWVudC5odG1sKCk7XHJcbiAgICAgIHJldHVybiAnXFxcclxuICAgICAgICA8bWQtdGFicy13cmFwcGVyIG5nLWNsYXNzPVwieyBcXCdtZC1zdHJldGNoLXRhYnNcXCc6ICRtZFRhYnNDdHJsLnNob3VsZFN0cmV0Y2hUYWJzKCkgfVwiPlxcXHJcbiAgICAgICAgICA8bWQtdGFiLWRhdGE+PC9tZC10YWItZGF0YT5cXFxyXG4gICAgICAgICAgPG1kLXByZXYtYnV0dG9uXFxcclxuICAgICAgICAgICAgICB0YWJpbmRleD1cIi0xXCJcXFxyXG4gICAgICAgICAgICAgIHJvbGU9XCJidXR0b25cIlxcXHJcbiAgICAgICAgICAgICAgYXJpYS1sYWJlbD1cIlByZXZpb3VzIFBhZ2VcIlxcXHJcbiAgICAgICAgICAgICAgYXJpYS1kaXNhYmxlZD1cInt7ISRtZFRhYnNDdHJsLmNhblBhZ2VCYWNrKCl9fVwiXFxcclxuICAgICAgICAgICAgICBuZy1jbGFzcz1cInsgXFwnbWQtZGlzYWJsZWRcXCc6ICEkbWRUYWJzQ3RybC5jYW5QYWdlQmFjaygpIH1cIlxcXHJcbiAgICAgICAgICAgICAgbmctaWY9XCIkbWRUYWJzQ3RybC5zaG91bGRQYWdpbmF0ZVwiXFxcclxuICAgICAgICAgICAgICBuZy1jbGljaz1cIiRtZFRhYnNDdHJsLnByZXZpb3VzUGFnZSgpXCI+XFxcclxuICAgICAgICAgICAgPG1kLWljb24gbWQtc3ZnLWljb249XCJtZC10YWJzLWFycm93XCI+PC9tZC1pY29uPlxcXHJcbiAgICAgICAgICA8L21kLXByZXYtYnV0dG9uPlxcXHJcbiAgICAgICAgICA8bWQtbmV4dC1idXR0b25cXFxyXG4gICAgICAgICAgICAgIHRhYmluZGV4PVwiLTFcIlxcXHJcbiAgICAgICAgICAgICAgcm9sZT1cImJ1dHRvblwiXFxcclxuICAgICAgICAgICAgICBhcmlhLWxhYmVsPVwiTmV4dCBQYWdlXCJcXFxyXG4gICAgICAgICAgICAgIGFyaWEtZGlzYWJsZWQ9XCJ7eyEkbWRUYWJzQ3RybC5jYW5QYWdlRm9yd2FyZCgpfX1cIlxcXHJcbiAgICAgICAgICAgICAgbmctY2xhc3M9XCJ7IFxcJ21kLWRpc2FibGVkXFwnOiAhJG1kVGFic0N0cmwuY2FuUGFnZUZvcndhcmQoKSB9XCJcXFxyXG4gICAgICAgICAgICAgIG5nLWlmPVwiJG1kVGFic0N0cmwuc2hvdWxkUGFnaW5hdGVcIlxcXHJcbiAgICAgICAgICAgICAgbmctY2xpY2s9XCIkbWRUYWJzQ3RybC5uZXh0UGFnZSgpXCI+XFxcclxuICAgICAgICAgICAgPG1kLWljb24gbWQtc3ZnLWljb249XCJtZC10YWJzLWFycm93XCI+PC9tZC1pY29uPlxcXHJcbiAgICAgICAgICA8L21kLW5leHQtYnV0dG9uPlxcXHJcbiAgICAgICAgICA8bWQtdGFicy1jYW52YXNcXFxyXG4gICAgICAgICAgICAgIHRhYmluZGV4PVwiMFwiXFxcclxuICAgICAgICAgICAgICBhcmlhLWFjdGl2ZWRlc2NlbmRhbnQ9XCJ0YWItaXRlbS17eyRtZFRhYnNDdHJsLnRhYnNbJG1kVGFic0N0cmwuZm9jdXNJbmRleF0uaWR9fVwiXFxcclxuICAgICAgICAgICAgICBuZy1mb2N1cz1cIiRtZFRhYnNDdHJsLnJlZGlyZWN0Rm9jdXMoKVwiXFxcclxuICAgICAgICAgICAgICBuZy1jbGFzcz1cIntcXFxyXG4gICAgICAgICAgICAgICAgICBcXCdtZC1wYWdpbmF0ZWRcXCc6ICRtZFRhYnNDdHJsLnNob3VsZFBhZ2luYXRlLFxcXHJcbiAgICAgICAgICAgICAgICAgIFxcJ21kLWNlbnRlci10YWJzXFwnOiAkbWRUYWJzQ3RybC5zaG91bGRDZW50ZXJUYWJzXFxcclxuICAgICAgICAgICAgICB9XCJcXFxyXG4gICAgICAgICAgICAgIG5nLWtleWRvd249XCIkbWRUYWJzQ3RybC5rZXlkb3duKCRldmVudClcIlxcXHJcbiAgICAgICAgICAgICAgcm9sZT1cInRhYmxpc3RcIj5cXFxyXG4gICAgICAgICAgICA8bWQtcGFnaW5hdGlvbi13cmFwcGVyXFxcclxuICAgICAgICAgICAgICAgIG5nLWNsYXNzPVwieyBcXCdtZC1jZW50ZXItdGFic1xcJzogJG1kVGFic0N0cmwuc2hvdWxkQ2VudGVyVGFicyB9XCJcXFxyXG4gICAgICAgICAgICAgICAgbWQtdGFiLXNjcm9sbD1cIiRtZFRhYnNDdHJsLnNjcm9sbCgkZXZlbnQpXCI+XFxcclxuICAgICAgICAgICAgICA8bWQtdGFiLWl0ZW1cXFxyXG4gICAgICAgICAgICAgICAgICB0YWJpbmRleD1cIi0xXCJcXFxyXG4gICAgICAgICAgICAgICAgICBjbGFzcz1cIm1kLXRhYlwiXFxcclxuICAgICAgICAgICAgICAgICAgc3R5bGU9XCJtYXgtd2lkdGg6IHt7IHRhYldpZHRoID8gdGFiV2lkdGggKyBcXCdweFxcJyA6IFxcJ25vbmVcXCcgfX1cIlxcXHJcbiAgICAgICAgICAgICAgICAgIG5nLXJlcGVhdD1cInRhYiBpbiAkbWRUYWJzQ3RybC50YWJzXCJcXFxyXG4gICAgICAgICAgICAgICAgICByb2xlPVwidGFiXCJcXFxyXG4gICAgICAgICAgICAgICAgICBhcmlhLWNvbnRyb2xzPVwidGFiLWNvbnRlbnQte3t0YWIuaWR9fVwiXFxcclxuICAgICAgICAgICAgICAgICAgYXJpYS1zZWxlY3RlZD1cInt7dGFiLmlzQWN0aXZlKCl9fVwiXFxcclxuICAgICAgICAgICAgICAgICAgYXJpYS1kaXNhYmxlZD1cInt7dGFiLnNjb3BlLmRpc2FibGVkIHx8IFxcJ2ZhbHNlXFwnfX1cIlxcXHJcbiAgICAgICAgICAgICAgICAgIG5nLWNsaWNrPVwiJG1kVGFic0N0cmwuc2VsZWN0KHRhYi5nZXRJbmRleCgpKVwiXFxcclxuICAgICAgICAgICAgICAgICAgbmctY2xhc3M9XCJ7XFxcclxuICAgICAgICAgICAgICAgICAgICAgIFxcJ21kLWFjdGl2ZVxcJzogICAgdGFiLmlzQWN0aXZlKCksXFxcclxuICAgICAgICAgICAgICAgICAgICAgIFxcJ21kLWZvY3VzZWRcXCc6ICAgdGFiLmhhc0ZvY3VzKCksXFxcclxuICAgICAgICAgICAgICAgICAgICAgIFxcJ21kLWRpc2FibGVkXFwnOiAgdGFiLnNjb3BlLmRpc2FibGVkXFxcclxuICAgICAgICAgICAgICAgICAgfVwiXFxcclxuICAgICAgICAgICAgICAgICAgbmctZGlzYWJsZWQ9XCJ0YWIuc2NvcGUuZGlzYWJsZWRcIlxcXHJcbiAgICAgICAgICAgICAgICAgIG1kLXN3aXBlLWxlZnQ9XCIkbWRUYWJzQ3RybC5uZXh0UGFnZSgpXCJcXFxyXG4gICAgICAgICAgICAgICAgICBtZC1zd2lwZS1yaWdodD1cIiRtZFRhYnNDdHJsLnByZXZpb3VzUGFnZSgpXCJcXFxyXG4gICAgICAgICAgICAgICAgICBtZC10ZW1wbGF0ZT1cInRhYi5sYWJlbFwiXFxcclxuICAgICAgICAgICAgICAgICAgbWQtc2NvcGU9XCJ0YWIucGFyZW50XCI+PC9tZC10YWItaXRlbT5cXFxyXG4gICAgICAgICAgICAgIDxtZC1pbmstYmFyIG5nLWhpZGU9XCJub0lua0JhclwiPjwvbWQtaW5rLWJhcj5cXFxyXG4gICAgICAgICAgICA8L21kLXBhZ2luYXRpb24td3JhcHBlcj5cXFxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwibWQtdmlzdWFsbHktaGlkZGVuIG1kLWR1bW15LXdyYXBwZXJcIj5cXFxyXG4gICAgICAgICAgICAgIDxtZC1kdW1teS10YWJcXFxyXG4gICAgICAgICAgICAgICAgICBjbGFzcz1cIm1kLXRhYlwiXFxcclxuICAgICAgICAgICAgICAgICAgdGFiaW5kZXg9XCItMVwiXFxcclxuICAgICAgICAgICAgICAgICAgaWQ9XCJ0YWItaXRlbS17e3RhYi5pZH19XCJcXFxyXG4gICAgICAgICAgICAgICAgICByb2xlPVwidGFiXCJcXFxyXG4gICAgICAgICAgICAgICAgICBhcmlhLWNvbnRyb2xzPVwidGFiLWNvbnRlbnQte3t0YWIuaWR9fVwiXFxcclxuICAgICAgICAgICAgICAgICAgYXJpYS1zZWxlY3RlZD1cInt7dGFiLmlzQWN0aXZlKCl9fVwiXFxcclxuICAgICAgICAgICAgICAgICAgYXJpYS1kaXNhYmxlZD1cInt7dGFiLnNjb3BlLmRpc2FibGVkIHx8IFxcJ2ZhbHNlXFwnfX1cIlxcXHJcbiAgICAgICAgICAgICAgICAgIG5nLWZvY3VzPVwiJG1kVGFic0N0cmwuaGFzRm9jdXMgPSB0cnVlXCJcXFxyXG4gICAgICAgICAgICAgICAgICBuZy1ibHVyPVwiJG1kVGFic0N0cmwuaGFzRm9jdXMgPSBmYWxzZVwiXFxcclxuICAgICAgICAgICAgICAgICAgbmctcmVwZWF0PVwidGFiIGluICRtZFRhYnNDdHJsLnRhYnNcIlxcXHJcbiAgICAgICAgICAgICAgICAgIG1kLXRlbXBsYXRlPVwidGFiLmxhYmVsXCJcXFxyXG4gICAgICAgICAgICAgICAgICBtZC1zY29wZT1cInRhYi5wYXJlbnRcIj48L21kLWR1bW15LXRhYj5cXFxyXG4gICAgICAgICAgICA8L2Rpdj5cXFxyXG4gICAgICAgICAgPC9tZC10YWJzLWNhbnZhcz5cXFxyXG4gICAgICAgIDwvbWQtdGFicy13cmFwcGVyPlxcXHJcbiAgICAgICAgPG1kLXRhYnMtY29udGVudC13cmFwcGVyIG5nLXNob3c9XCIkbWRUYWJzQ3RybC5oYXNDb250ZW50XCI+XFxcclxuICAgICAgICAgIDxtZC10YWItY29udGVudFxcXHJcbiAgICAgICAgICAgICAgaWQ9XCJ0YWItY29udGVudC17e3RhYi5pZH19XCJcXFxyXG4gICAgICAgICAgICAgIHJvbGU9XCJ0YWJwYW5lbFwiXFxcclxuICAgICAgICAgICAgICBhcmlhLWxhYmVsbGVkYnk9XCJ0YWItaXRlbS17e3RhYi5pZH19XCJcXFxyXG4gICAgICAgICAgICAgIG1kLXN3aXBlLWxlZnQ9XCJzd2lwZUNvbnRlbnQgJiYgJG1kVGFic0N0cmwuaW5jcmVtZW50U2VsZWN0ZWRJbmRleCgxKVwiXFxcclxuICAgICAgICAgICAgICBtZC1zd2lwZS1yaWdodD1cInN3aXBlQ29udGVudCAmJiAkbWRUYWJzQ3RybC5pbmNyZW1lbnRTZWxlY3RlZEluZGV4KC0xKVwiXFxcclxuICAgICAgICAgICAgICBuZy1pZj1cIiRtZFRhYnNDdHJsLmhhc0NvbnRlbnRcIlxcXHJcbiAgICAgICAgICAgICAgbmctcmVwZWF0PVwiKGluZGV4LCB0YWIpIGluICRtZFRhYnNDdHJsLnRhYnNcIlxcXHJcbiAgICAgICAgICAgICAgbWQtY29ubmVjdGVkLWlmPVwidGFiLmlzQWN0aXZlKClcIlxcXHJcbiAgICAgICAgICAgICAgbmctY2xhc3M9XCJ7XFxcclxuICAgICAgICAgICAgICAgIFxcJ21kLW5vLXRyYW5zaXRpb25cXCc6ICRtZFRhYnNDdHJsLmxhc3RTZWxlY3RlZEluZGV4ID09IG51bGwsXFxcclxuICAgICAgICAgICAgICAgIFxcJ21kLWFjdGl2ZVxcJzogICAgICAgIHRhYi5pc0FjdGl2ZSgpLFxcXHJcbiAgICAgICAgICAgICAgICBcXCdtZC1sZWZ0XFwnOiAgICAgICAgICB0YWIuaXNMZWZ0KCksXFxcclxuICAgICAgICAgICAgICAgIFxcJ21kLXJpZ2h0XFwnOiAgICAgICAgIHRhYi5pc1JpZ2h0KCksXFxcclxuICAgICAgICAgICAgICAgIFxcJ21kLW5vLXNjcm9sbFxcJzogICAgIGR5bmFtaWNIZWlnaHRcXFxyXG4gICAgICAgICAgICAgIH1cIj5cXFxyXG4gICAgICAgICAgICA8ZGl2XFxcclxuICAgICAgICAgICAgICAgIG1kLXRlbXBsYXRlPVwidGFiLnRlbXBsYXRlXCJcXFxyXG4gICAgICAgICAgICAgICAgbWQtc2NvcGU9XCJ0YWIucGFyZW50XCJcXFxyXG4gICAgICAgICAgICAgICAgbmctaWY9XCJ0YWIuc2hvdWxkUmVuZGVyKClcIj48L2Rpdj5cXFxyXG4gICAgICAgICAgPC9tZC10YWItY29udGVudD5cXFxyXG4gICAgICAgIDwvbWQtdGFicy1jb250ZW50LXdyYXBwZXI+XFxcclxuICAgICAgJztcclxuICAgIH0sXHJcbiAgICBjb250cm9sbGVyOiAnTWRUYWJzQ29udHJvbGxlcicsXHJcbiAgICBjb250cm9sbGVyQXM6ICckbWRUYWJzQ3RybCdcclxuICB9O1xyXG59XHJcbk1kVGFicy4kaW5qZWN0ID0gW1wiJG1kVGhlbWluZ1wiLCBcIiRtZFV0aWxcIiwgXCIkY29tcGlsZVwiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMudGFicycpXHJcbiAgICAuZGlyZWN0aXZlKCdtZFRlbXBsYXRlJywgTWRUZW1wbGF0ZSk7XHJcblxyXG5mdW5jdGlvbiBNZFRlbXBsYXRlICgkY29tcGlsZSwgJG1kVXRpbCwgJHRpbWVvdXQpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgIGxpbms6IGxpbmssXHJcbiAgICBzY29wZToge1xyXG4gICAgICB0ZW1wbGF0ZTogJz1tZFRlbXBsYXRlJyxcclxuICAgICAgY29tcGlsZVNjb3BlOiAnPW1kU2NvcGUnLFxyXG4gICAgICBjb25uZWN0ZWQ6ICc9P21kQ29ubmVjdGVkSWYnXHJcbiAgICB9LFxyXG4gICAgcmVxdWlyZTogJ14/bWRUYWJzJ1xyXG4gIH07XHJcbiAgZnVuY3Rpb24gbGluayAoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmwpIHtcclxuICAgIGlmICghY3RybCkgcmV0dXJuO1xyXG4gICAgdmFyIGNvbXBpbGVTY29wZSA9IHNjb3BlLmNvbXBpbGVTY29wZS4kbmV3KCk7XHJcbiAgICBlbGVtZW50Lmh0bWwoc2NvcGUudGVtcGxhdGUpO1xyXG4gICAgJGNvbXBpbGUoZWxlbWVudC5jb250ZW50cygpKShjb21waWxlU2NvcGUpO1xyXG4gICAgcmV0dXJuICR0aW1lb3V0KGhhbmRsZVNjb3BlKTtcclxuICAgIGZ1bmN0aW9uIGhhbmRsZVNjb3BlICgpIHtcclxuICAgICAgc2NvcGUuJHdhdGNoKCdjb25uZWN0ZWQnLCBmdW5jdGlvbiAodmFsdWUpIHsgdmFsdWUgPT09IGZhbHNlID8gZGlzY29ubmVjdCgpIDogcmVjb25uZWN0KCk7IH0pO1xyXG4gICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgcmVjb25uZWN0KTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGRpc2Nvbm5lY3QgKCkge1xyXG4gICAgICBpZiAoY3RybC5zY29wZS5ub0Rpc2Nvbm5lY3QpIHJldHVybjtcclxuICAgICAgJG1kVXRpbC5kaXNjb25uZWN0U2NvcGUoY29tcGlsZVNjb3BlKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHJlY29ubmVjdCAoKSB7XHJcbiAgICAgIGlmIChjdHJsLnNjb3BlLm5vRGlzY29ubmVjdCkgcmV0dXJuO1xyXG4gICAgICAkbWRVdGlsLnJlY29ubmVjdFNjb3BlKGNvbXBpbGVTY29wZSk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbk1kVGVtcGxhdGUuJGluamVjdCA9IFtcIiRjb21waWxlXCIsIFwiJG1kVXRpbFwiLCBcIiR0aW1lb3V0XCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7IFxyXG5hbmd1bGFyLm1vZHVsZShcIm1hdGVyaWFsLmNvcmVcIikuY29uc3RhbnQoXCIkTURfVEhFTUVfQ1NTXCIsIFwiLyogbWl4aW4gZGVmaW5pdGlvbiA7IHNldHMgTFRSIGFuZCBSVEwgd2l0aGluIHRoZSBzYW1lIHN0eWxlIGNhbGwgKi9tZC1hdXRvY29tcGxldGUubWQtVEhFTUVfTkFNRS10aGVtZSB7ICBiYWNrZ3JvdW5kOiAne3tiYWNrZ3JvdW5kLTUwfX0nOyB9ICBtZC1hdXRvY29tcGxldGUubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0geyAgICBiYWNrZ3JvdW5kOiAne3tiYWNrZ3JvdW5kLTEwMH19JzsgfSAgbWQtYXV0b2NvbXBsZXRlLm1kLVRIRU1FX05BTUUtdGhlbWUgYnV0dG9uIG1kLWljb24gcGF0aCB7ICAgIGZpbGw6ICd7e2JhY2tncm91bmQtNjAwfX0nOyB9ICBtZC1hdXRvY29tcGxldGUubWQtVEhFTUVfTkFNRS10aGVtZSBidXR0b246YWZ0ZXIgeyAgICBiYWNrZ3JvdW5kOiAne3tiYWNrZ3JvdW5kLTYwMC0wLjN9fSc7IH0ubWQtYXV0b2NvbXBsZXRlLXN1Z2dlc3Rpb25zLm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgYmFja2dyb3VuZDogJ3t7YmFja2dyb3VuZC01MH19JzsgfSAgLm1kLWF1dG9jb21wbGV0ZS1zdWdnZXN0aW9ucy5tZC1USEVNRV9OQU1FLXRoZW1lIGxpIHsgICAgY29sb3I6ICd7e2JhY2tncm91bmQtOTAwfX0nOyB9ICAgIC5tZC1hdXRvY29tcGxldGUtc3VnZ2VzdGlvbnMubWQtVEhFTUVfTkFNRS10aGVtZSBsaSAuaGlnaGxpZ2h0IHsgICAgICBjb2xvcjogJ3t7YmFja2dyb3VuZC02MDB9fSc7IH0gICAgLm1kLWF1dG9jb21wbGV0ZS1zdWdnZXN0aW9ucy5tZC1USEVNRV9OQU1FLXRoZW1lIGxpOmhvdmVyLCAubWQtYXV0b2NvbXBsZXRlLXN1Z2dlc3Rpb25zLm1kLVRIRU1FX05BTUUtdGhlbWUgbGkuc2VsZWN0ZWQgeyAgICAgIGJhY2tncm91bmQ6ICd7e2JhY2tncm91bmQtMjAwfX0nOyB9bWQtYmFja2Ryb3AubWQtb3BhcXVlLm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7Zm9yZWdyb3VuZC00LTAuNX19JzsgfW1kLWJvdHRvbS1zaGVldC5tZC1USEVNRV9OQU1FLXRoZW1lIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2JhY2tncm91bmQtNTB9fSc7ICBib3JkZXItdG9wLWNvbG9yOiAne3tiYWNrZ3JvdW5kLTMwMH19JzsgfSAgbWQtYm90dG9tLXNoZWV0Lm1kLVRIRU1FX05BTUUtdGhlbWUubWQtbGlzdCBtZC1saXN0LWl0ZW0geyAgICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0xfX0nOyB9ICBtZC1ib3R0b20tc2hlZXQubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtc3ViaGVhZGVyIHsgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC01MH19JzsgfSAgbWQtYm90dG9tLXNoZWV0Lm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXN1YmhlYWRlciB7ICAgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTF9fSc7IH1hLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgYm9yZGVyLXJhZGl1czogM3B4OyB9ICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKTpob3ZlciwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKTpob3ZlciB7ICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2JhY2tncm91bmQtNTAwLTAuMn19JzsgfSAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkIHsgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC01MDAtMC4yfX0nOyB9ICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1pY29uLWJ1dHRvbjpob3ZlciwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1pY29uLWJ1dHRvbjpob3ZlciB7ICAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50OyB9ICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYiB7ICAgIGJvcmRlci1yYWRpdXM6IDUwJTsgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyAgICBjb2xvcjogJ3t7YWNjZW50LWNvbnRyYXN0fX0nOyB9ICAgIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtZmFiIG1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWIgbWQtaWNvbiB7ICAgICAgY29sb3I6ICd7e2FjY2VudC1jb250cmFzdH19JzsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYjpub3QoW2Rpc2FibGVkXSk6aG92ZXIsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWI6bm90KFtkaXNhYmxlZF0pOmhvdmVyIHsgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH0gICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWI6bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWI6bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQgeyAgICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC1BNzAwfX0nOyB9ICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWljb24tYnV0dG9uLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtaWNvbi1idXR0b24geyAgICBib3JkZXItcmFkaXVzOiA1MCU7IH0gIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeSwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkgeyAgICBjb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkubWQtcmFpc2VkLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkubWQtZmFiLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeS5tZC1yYWlzZWQsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5Lm1kLWZhYiB7ICAgICAgY29sb3I6ICd7e3ByaW1hcnktY29udHJhc3R9fSc7ICAgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfSAgICAgIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeS5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pIG1kLWljb24sIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeS5tZC1mYWI6bm90KFtkaXNhYmxlZF0pIG1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5Lm1kLXJhaXNlZDpub3QoW2Rpc2FibGVkXSkgbWQtaWNvbiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkubWQtZmFiOm5vdChbZGlzYWJsZWRdKSBtZC1pY29uIHsgICAgICAgIGNvbG9yOiAne3twcmltYXJ5LWNvbnRyYXN0fX0nOyB9ICAgICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5Lm1kLXJhaXNlZDpub3QoW2Rpc2FibGVkXSk6aG92ZXIsIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeS5tZC1mYWI6bm90KFtkaXNhYmxlZF0pOmhvdmVyLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeS5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pOmhvdmVyLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeS5tZC1mYWI6bm90KFtkaXNhYmxlZF0pOmhvdmVyIHsgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3J9fSc7IH0gICAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkubWQtZmFiOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeS5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5Lm1kLWZhYjpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAne3twcmltYXJ5LTYwMH19JzsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnk6bm90KFtkaXNhYmxlZF0pIG1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5Om5vdChbZGlzYWJsZWRdKSBtZC1pY29uIHsgICAgICBjb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfSAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWIsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWIgeyAgICBib3JkZXItcmFkaXVzOiA1MCU7ICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgICAgY29sb3I6ICd7e2FjY2VudC1jb250cmFzdH19JzsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYjpub3QoW2Rpc2FibGVkXSkgLm1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWI6bm90KFtkaXNhYmxlZF0pIC5tZC1pY29uIHsgICAgICBjb2xvcjogJ3t7YWNjZW50LWNvbnRyYXN0fX0nOyB9ICAgIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtZmFiOm5vdChbZGlzYWJsZWRdKTpob3ZlciwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYjpub3QoW2Rpc2FibGVkXSk6aG92ZXIgeyAgICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYjpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYjpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LUE3MDB9fSc7IH0gIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcmFpc2VkLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcmFpc2VkIHsgICAgY29sb3I6ICd7e2JhY2tncm91bmQtY29udHJhc3R9fSc7ICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2JhY2tncm91bmQtNTB9fSc7IH0gICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pIC5tZC1pY29uLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKSAubWQtaWNvbiB7ICAgICAgY29sb3I6ICd7e2JhY2tncm91bmQtY29udHJhc3R9fSc7IH0gICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pOmhvdmVyLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKTpob3ZlciB7ICAgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC01MH19JzsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXJhaXNlZDpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXJhaXNlZDpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC0yMDB9fSc7IH0gIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4geyAgICBjb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4ubWQtcmFpc2VkLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4ubWQtZmFiLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2Fybi5tZC1yYWlzZWQsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuLm1kLWZhYiB7ICAgICAgY29sb3I6ICd7e3dhcm4tY29udHJhc3R9fSc7ICAgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgfSAgICAgIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2Fybi5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pIG1kLWljb24sIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2Fybi5tZC1mYWI6bm90KFtkaXNhYmxlZF0pIG1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuLm1kLXJhaXNlZDpub3QoW2Rpc2FibGVkXSkgbWQtaWNvbiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4ubWQtZmFiOm5vdChbZGlzYWJsZWRdKSBtZC1pY29uIHsgICAgICAgIGNvbG9yOiAne3t3YXJuLWNvbnRyYXN0fX0nOyB9ICAgICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuLm1kLXJhaXNlZDpub3QoW2Rpc2FibGVkXSk6aG92ZXIsIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2Fybi5tZC1mYWI6bm90KFtkaXNhYmxlZF0pOmhvdmVyLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2Fybi5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pOmhvdmVyLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2Fybi5tZC1mYWI6bm90KFtkaXNhYmxlZF0pOmhvdmVyIHsgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH0gICAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4ubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4ubWQtZmFiOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2Fybi5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuLm1kLWZhYjpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAne3t3YXJuLTcwMH19JzsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm46bm90KFtkaXNhYmxlZF0pIG1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuOm5vdChbZGlzYWJsZWRdKSBtZC1pY29uIHsgICAgICBjb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgfSAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQgeyAgICBjb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9ICAgIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50Lm1kLXJhaXNlZCwgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQubWQtZmFiLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50Lm1kLXJhaXNlZCwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudC5tZC1mYWIgeyAgICAgIGNvbG9yOiAne3thY2NlbnQtY29udHJhc3R9fSc7ICAgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9ICAgICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKSBtZC1pY29uLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudC5tZC1mYWI6bm90KFtkaXNhYmxlZF0pIG1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKSBtZC1pY29uLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50Lm1kLWZhYjpub3QoW2Rpc2FibGVkXSkgbWQtaWNvbiB7ICAgICAgICBjb2xvcjogJ3t7YWNjZW50LWNvbnRyYXN0fX0nOyB9ICAgICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKTpob3ZlciwgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQubWQtZmFiOm5vdChbZGlzYWJsZWRdKTpob3ZlciwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudC5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pOmhvdmVyLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50Lm1kLWZhYjpub3QoW2Rpc2FibGVkXSk6aG92ZXIgeyAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9ICAgICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudC5tZC1mYWI6bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50Lm1kLWZhYjpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtNzAwfX0nOyB9ICAgIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50Om5vdChbZGlzYWJsZWRdKSBtZC1pY29uLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50Om5vdChbZGlzYWJsZWRdKSBtZC1pY29uIHsgICAgICBjb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9ICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXSwgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1yYWlzZWRbZGlzYWJsZWRdLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYltkaXNhYmxlZF0sIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50W2Rpc2FibGVkXSwgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuW2Rpc2FibGVkXSwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXSwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXJhaXNlZFtkaXNhYmxlZF0sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWJbZGlzYWJsZWRdLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50W2Rpc2FibGVkXSwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm5bZGlzYWJsZWRdIHsgICAgY29sb3I6ICd7e2ZvcmVncm91bmQtM319JzsgICAgY3Vyc29yOiBub3QtYWxsb3dlZDsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXSBtZC1pY29uLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXJhaXNlZFtkaXNhYmxlZF0gbWQtaWNvbiwgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWJbZGlzYWJsZWRdIG1kLWljb24sIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50W2Rpc2FibGVkXSBtZC1pY29uLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm5bZGlzYWJsZWRdIG1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0gbWQtaWNvbiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXJhaXNlZFtkaXNhYmxlZF0gbWQtaWNvbiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYltkaXNhYmxlZF0gbWQtaWNvbiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudFtkaXNhYmxlZF0gbWQtaWNvbiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm5bZGlzYWJsZWRdIG1kLWljb24geyAgICAgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTN9fSc7IH0gIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcmFpc2VkW2Rpc2FibGVkXSwgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWJbZGlzYWJsZWRdLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcmFpc2VkW2Rpc2FibGVkXSwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYltkaXNhYmxlZF0geyAgICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTR9fSc7IH0gIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWVbZGlzYWJsZWRdLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWVbZGlzYWJsZWRdIHsgICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7IH1tZC1jYXJkLm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC1jb2xvcn19JzsgIGJvcmRlci1yYWRpdXM6IDJweDsgfSAgbWQtY2FyZC5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1jYXJkLWltYWdlIHsgICAgYm9yZGVyLXJhZGl1czogMnB4IDJweCAwIDA7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1yaXBwbGUgeyAgY29sb3I6ICd7e2FjY2VudC02MDB9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWNoZWNrZWQgLm1kLXJpcHBsZSB7ICBjb2xvcjogJ3t7YmFja2dyb3VuZC02MDB9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWNoZWNrZWQubWQtZm9jdXNlZCAubWQtY29udGFpbmVyOmJlZm9yZSB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtY29sb3ItMC4yNn19JzsgfW1kLWNoZWNrYm94Lm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWljb24geyAgYm9yZGVyLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTJ9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWNoZWNrZWQgLm1kLWljb24geyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yLTAuODd9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWNoZWNrZWQgLm1kLWljb246YWZ0ZXIgeyAgYm9yZGVyLWNvbG9yOiAne3tiYWNrZ3JvdW5kLTIwMH19JzsgfW1kLWNoZWNrYm94Lm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXByaW1hcnkgLm1kLXJpcHBsZSB7ICBjb2xvcjogJ3t7cHJpbWFyeS02MDB9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5Lm1kLWNoZWNrZWQgLm1kLXJpcHBsZSB7ICBjb2xvcjogJ3t7YmFja2dyb3VuZC02MDB9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5IC5tZC1pY29uIHsgIGJvcmRlci1jb2xvcjogJ3t7Zm9yZWdyb3VuZC0yfX0nOyB9bWQtY2hlY2tib3gubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtcHJpbWFyeS5tZC1jaGVja2VkIC5tZC1pY29uIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3ItMC44N319JzsgfW1kLWNoZWNrYm94Lm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXByaW1hcnkubWQtY2hlY2tlZC5tZC1mb2N1c2VkIC5tZC1jb250YWluZXI6YmVmb3JlIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3ItMC4yNn19JzsgfW1kLWNoZWNrYm94Lm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXByaW1hcnkubWQtY2hlY2tlZCAubWQtaWNvbjphZnRlciB7ICBib3JkZXItY29sb3I6ICd7e2JhY2tncm91bmQtMjAwfX0nOyB9bWQtY2hlY2tib3gubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtd2FybiAubWQtcmlwcGxlIHsgIGNvbG9yOiAne3t3YXJuLTYwMH19JzsgfW1kLWNoZWNrYm94Lm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXdhcm4gLm1kLWljb24geyAgYm9yZGVyLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTJ9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC13YXJuLm1kLWNoZWNrZWQgLm1kLWljb24geyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7d2Fybi1jb2xvci0wLjg3fX0nOyB9bWQtY2hlY2tib3gubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtd2Fybi5tZC1jaGVja2VkLm1kLWZvY3VzZWQ6bm90KFtkaXNhYmxlZF0pIC5tZC1jb250YWluZXI6YmVmb3JlIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3ItMC4yNn19JzsgfW1kLWNoZWNrYm94Lm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXdhcm4ubWQtY2hlY2tlZCAubWQtaWNvbjphZnRlciB7ICBib3JkZXItY29sb3I6ICd7e2JhY2tncm91bmQtMjAwfX0nOyB9bWQtY2hlY2tib3gubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0gLm1kLWljb24geyAgYm9yZGVyLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTN9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXS5tZC1jaGVja2VkIC5tZC1pY29uIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2ZvcmVncm91bmQtM319JzsgfW1kLWNoZWNrYm94Lm1kLVRIRU1FX05BTUUtdGhlbWVbZGlzYWJsZWRdIC5tZC1sYWJlbCB7ICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0zfX0nOyB9bWQtY2hpcHMubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtY2hpcHMgeyAgYm94LXNoYWRvdzogMCAxcHggJ3t7YmFja2dyb3VuZC0zMDB9fSc7IH0gIG1kLWNoaXBzLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWNoaXBzLm1kLWZvY3VzZWQgeyAgICBib3gtc2hhZG93OiAwIDJweCAne3twcmltYXJ5LWNvbG9yfX0nOyB9bWQtY2hpcHMubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtY2hpcCB7ICBiYWNrZ3JvdW5kOiAne3tiYWNrZ3JvdW5kLTMwMH19JzsgIGNvbG9yOiAne3tiYWNrZ3JvdW5kLTgwMH19JzsgfSAgbWQtY2hpcHMubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtY2hpcC5tZC1mb2N1c2VkIHsgICAgYmFja2dyb3VuZDogJ3t7cHJpbWFyeS1jb2xvcn19JzsgICAgY29sb3I6ICd7e3ByaW1hcnktY29udHJhc3R9fSc7IH0gICAgbWQtY2hpcHMubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtY2hpcC5tZC1mb2N1c2VkIG1kLWljb24geyAgICAgIGNvbG9yOiAne3twcmltYXJ5LWNvbnRyYXN0fX0nOyB9bWQtY2hpcHMubWQtVEhFTUVfTkFNRS10aGVtZSBtZC1jaGlwLXJlbW92ZSAubWQtYnV0dG9uIG1kLWljb24gcGF0aCB7ICBmaWxsOiAne3tiYWNrZ3JvdW5kLTUwMH19JzsgfS5tZC1jb250YWN0LXN1Z2dlc3Rpb24gc3Bhbi5tZC1jb250YWN0LWVtYWlsIHsgIGNvbG9yOiAne3tiYWNrZ3JvdW5kLTQwMH19JzsgfW1kLWNvbnRlbnQubWQtVEhFTUVfTkFNRS10aGVtZSB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tiYWNrZ3JvdW5kLWNvbG9yfX0nOyB9bWQtZGlhbG9nLm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgYm9yZGVyLXJhZGl1czogNHB4OyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC1jb2xvcn19JzsgfSAgbWQtZGlhbG9nLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtY29udGVudC1vdmVyZmxvdyAubWQtYWN0aW9ucyB7ICAgIGJvcmRlci10b3AtY29sb3I6ICd7e2ZvcmVncm91bmQtNH19JzsgfW1kLWRpdmlkZXIubWQtVEhFTUVfTkFNRS10aGVtZSB7ICBib3JkZXItdG9wLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTR9fSc7IH1tZC1pY29uLm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgY29sb3I6ICd7e2ZvcmVncm91bmQtMn19JzsgfSAgbWQtaWNvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkgeyAgICBjb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfSAgbWQtaWNvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudCB7ICAgIGNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH0gIG1kLWljb24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuIHsgICAgY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH1tZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtaW5wdXQgeyAgY29sb3I6ICd7e2ZvcmVncm91bmQtMX19JzsgIGJvcmRlci1jb2xvcjogJ3t7Zm9yZWdyb3VuZC00fX0nOyAgdGV4dC1zaGFkb3c6ICd7e2ZvcmVncm91bmQtc2hhZG93fX0nOyB9ICBtZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtaW5wdXQ6Oi13ZWJraXQtaW5wdXQtcGxhY2Vob2xkZXIsIG1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1pbnB1dDo6LW1vei1wbGFjZWhvbGRlciwgbWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWlucHV0Oi1tb3otcGxhY2Vob2xkZXIsIG1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1pbnB1dDotbXMtaW5wdXQtcGxhY2Vob2xkZXIgeyAgICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0zfX0nOyB9bWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUgPiBtZC1pY29uIHsgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTF9fSc7IH1tZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZSBsYWJlbCwgbWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXBsYWNlaG9sZGVyIHsgIHRleHQtc2hhZG93OiAne3tmb3JlZ3JvdW5kLXNoYWRvd319JzsgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTN9fSc7IH1tZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZSBuZy1tZXNzYWdlcywgbWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUgW25nLW1lc3NhZ2VdLCBtZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZSBbZGF0YS1uZy1tZXNzYWdlXSwgbWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUgW3gtbmctbWVzc2FnZV0geyAgY29sb3I6ICd7e3dhcm4tNTAwfX0nOyB9bWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KC5tZC1pbnB1dC1pbnZhbGlkKS5tZC1pbnB1dC1oYXMtdmFsdWUgbGFiZWwgeyAgY29sb3I6ICd7e2ZvcmVncm91bmQtMn19JzsgfW1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdCgubWQtaW5wdXQtaW52YWxpZCkubWQtaW5wdXQtZm9jdXNlZCAubWQtaW5wdXQgeyAgYm9yZGVyLWNvbG9yOiAne3twcmltYXJ5LTUwMH19JzsgfW1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdCgubWQtaW5wdXQtaW52YWxpZCkubWQtaW5wdXQtZm9jdXNlZCBsYWJlbCB7ICBjb2xvcjogJ3t7cHJpbWFyeS01MDB9fSc7IH1tZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoLm1kLWlucHV0LWludmFsaWQpLm1kLWlucHV0LWZvY3VzZWQgbWQtaWNvbiB7ICBjb2xvcjogJ3t7cHJpbWFyeS01MDB9fSc7IH1tZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoLm1kLWlucHV0LWludmFsaWQpLm1kLWlucHV0LWZvY3VzZWQubWQtYWNjZW50IC5tZC1pbnB1dCB7ICBib3JkZXItY29sb3I6ICd7e2FjY2VudC01MDB9fSc7IH1tZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoLm1kLWlucHV0LWludmFsaWQpLm1kLWlucHV0LWZvY3VzZWQubWQtYWNjZW50IGxhYmVsIHsgIGNvbG9yOiAne3thY2NlbnQtNTAwfX0nOyB9bWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KC5tZC1pbnB1dC1pbnZhbGlkKS5tZC1pbnB1dC1mb2N1c2VkLm1kLXdhcm4gLm1kLWlucHV0IHsgIGJvcmRlci1jb2xvcjogJ3t7d2Fybi01MDB9fSc7IH1tZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoLm1kLWlucHV0LWludmFsaWQpLm1kLWlucHV0LWZvY3VzZWQubWQtd2FybiBsYWJlbCB7ICBjb2xvcjogJ3t7d2Fybi01MDB9fSc7IH1tZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1pbnB1dC1pbnZhbGlkIC5tZC1pbnB1dCB7ICBib3JkZXItY29sb3I6ICd7e3dhcm4tNTAwfX0nOyB9bWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtaW5wdXQtaW52YWxpZC5tZC1pbnB1dC1mb2N1c2VkIGxhYmVsIHsgIGNvbG9yOiAne3t3YXJuLTUwMH19JzsgfW1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWlucHV0LWludmFsaWQgbmctbWVzc2FnZSwgbWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtaW5wdXQtaW52YWxpZCBkYXRhLW5nLW1lc3NhZ2UsIG1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWlucHV0LWludmFsaWQgeC1uZy1tZXNzYWdlLCBtZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1pbnB1dC1pbnZhbGlkIFtuZy1tZXNzYWdlXSwgbWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtaW5wdXQtaW52YWxpZCBbZGF0YS1uZy1tZXNzYWdlXSwgbWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtaW5wdXQtaW52YWxpZCBbeC1uZy1tZXNzYWdlXSwgbWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtaW5wdXQtaW52YWxpZCAubWQtY2hhci1jb3VudGVyIHsgIGNvbG9yOiAne3t3YXJuLTUwMH19JzsgfW1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1pbnB1dFtkaXNhYmxlZF0sIFtkaXNhYmxlZF0gbWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWlucHV0IHsgIGJvcmRlci1ib3R0b20tY29sb3I6IHRyYW5zcGFyZW50OyAgY29sb3I6ICd7e2ZvcmVncm91bmQtM319JzsgIGJhY2tncm91bmQtaW1hZ2U6IGxpbmVhci1ncmFkaWVudCh0byByaWdodCwgJ3t7Zm9yZWdyb3VuZC0zfX0nIDAlLCAne3tmb3JlZ3JvdW5kLTN9fScgMzMlLCB0cmFuc3BhcmVudCAwJSk7ICBiYWNrZ3JvdW5kLWltYWdlOiAtbXMtbGluZWFyLWdyYWRpZW50KGxlZnQsIHRyYW5zcGFyZW50IDAlLCAne3tmb3JlZ3JvdW5kLTN9fScgMTAwJSk7IH1tZC1saXN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtbGlzdC1pdGVtLm1kLTItbGluZSAubWQtbGlzdC1pdGVtLXRleHQgaDMsIG1kLWxpc3QubWQtVEhFTUVfTkFNRS10aGVtZSBtZC1saXN0LWl0ZW0ubWQtMi1saW5lIC5tZC1saXN0LWl0ZW0tdGV4dCBoNCwgbWQtbGlzdC5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLWxpc3QtaXRlbS5tZC0zLWxpbmUgLm1kLWxpc3QtaXRlbS10ZXh0IGgzLCBtZC1saXN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtbGlzdC1pdGVtLm1kLTMtbGluZSAubWQtbGlzdC1pdGVtLXRleHQgaDQgeyAgY29sb3I6ICd7e2ZvcmVncm91bmQtMX19JzsgfW1kLWxpc3QubWQtVEhFTUVfTkFNRS10aGVtZSBtZC1saXN0LWl0ZW0ubWQtMi1saW5lIC5tZC1saXN0LWl0ZW0tdGV4dCBwLCBtZC1saXN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtbGlzdC1pdGVtLm1kLTMtbGluZSAubWQtbGlzdC1pdGVtLXRleHQgcCB7ICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0yfX0nOyB9bWQtbGlzdC5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1wcm94eS1mb2N1cy5tZC1mb2N1c2VkIGRpdi5tZC1uby1zdHlsZSB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tiYWNrZ3JvdW5kLTEwMH19JzsgfW1kLWxpc3QubWQtVEhFTUVfTkFNRS10aGVtZSBtZC1saXN0LWl0ZW0gPiBtZC1pY29uIHsgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTJ9fSc7IH0gIG1kLWxpc3QubWQtVEhFTUVfTkFNRS10aGVtZSBtZC1saXN0LWl0ZW0gPiBtZC1pY29uLm1kLWhpZ2hsaWdodCB7ICAgIGNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyB9ICAgIG1kLWxpc3QubWQtVEhFTUVfTkFNRS10aGVtZSBtZC1saXN0LWl0ZW0gPiBtZC1pY29uLm1kLWhpZ2hsaWdodC5tZC1hY2NlbnQgeyAgICAgIGNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH1tZC1saXN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtbGlzdC1pdGVtIGJ1dHRvbiB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tiYWNrZ3JvdW5kLWNvbG9yfX0nOyB9ICBtZC1saXN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtbGlzdC1pdGVtIGJ1dHRvbi5tZC1idXR0b246bm90KFtkaXNhYmxlZF0pOmhvdmVyIHsgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC1jb2xvcn19JzsgfW1kLW1lbnUtY29udGVudC5tZC1USEVNRV9OQU1FLXRoZW1lIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2JhY2tncm91bmQtY29sb3J9fSc7IH0gIG1kLW1lbnUtY29udGVudC5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLW1lbnUtZGl2aWRlciB7ICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2ZvcmVncm91bmQtNH19JzsgfW1kLXByb2dyZXNzLWNpcmN1bGFyLm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7IH0gIG1kLXByb2dyZXNzLWNpcmN1bGFyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWlubmVyIC5tZC1nYXAgeyAgICBib3JkZXItdG9wLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyAgICBib3JkZXItYm90dG9tLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyB9ICBtZC1wcm9ncmVzcy1jaXJjdWxhci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1pbm5lciAubWQtbGVmdCAubWQtaGFsZi1jaXJjbGUsIG1kLXByb2dyZXNzLWNpcmN1bGFyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWlubmVyIC5tZC1yaWdodCAubWQtaGFsZi1jaXJjbGUgeyAgICBib3JkZXItdG9wLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyB9ICBtZC1wcm9ncmVzcy1jaXJjdWxhci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1pbm5lciAubWQtcmlnaHQgLm1kLWhhbGYtY2lyY2xlIHsgICAgYm9yZGVyLXJpZ2h0LWNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyB9ICBtZC1wcm9ncmVzcy1jaXJjdWxhci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1pbm5lciAubWQtbGVmdCAubWQtaGFsZi1jaXJjbGUgeyAgICBib3JkZXItbGVmdC1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfSAgbWQtcHJvZ3Jlc3MtY2lyY3VsYXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuIC5tZC1pbm5lciAubWQtZ2FwIHsgICAgYm9yZGVyLXRvcC1jb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgICAgYm9yZGVyLWJvdHRvbS1jb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgfSAgbWQtcHJvZ3Jlc3MtY2lyY3VsYXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuIC5tZC1pbm5lciAubWQtbGVmdCAubWQtaGFsZi1jaXJjbGUsIG1kLXByb2dyZXNzLWNpcmN1bGFyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiAubWQtaW5uZXIgLm1kLXJpZ2h0IC5tZC1oYWxmLWNpcmNsZSB7ICAgIGJvcmRlci10b3AtY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH0gIG1kLXByb2dyZXNzLWNpcmN1bGFyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiAubWQtaW5uZXIgLm1kLXJpZ2h0IC5tZC1oYWxmLWNpcmNsZSB7ICAgIGJvcmRlci1yaWdodC1jb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgfSAgbWQtcHJvZ3Jlc3MtY2lyY3VsYXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuIC5tZC1pbm5lciAubWQtbGVmdCAubWQtaGFsZi1jaXJjbGUgeyAgICBib3JkZXItbGVmdC1jb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgfSAgbWQtcHJvZ3Jlc3MtY2lyY3VsYXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQgLm1kLWlubmVyIC5tZC1nYXAgeyAgICBib3JkZXItdG9wLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7ICAgIGJvcmRlci1ib3R0b20tY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgfSAgbWQtcHJvZ3Jlc3MtY2lyY3VsYXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQgLm1kLWlubmVyIC5tZC1sZWZ0IC5tZC1oYWxmLWNpcmNsZSwgbWQtcHJvZ3Jlc3MtY2lyY3VsYXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQgLm1kLWlubmVyIC5tZC1yaWdodCAubWQtaGFsZi1jaXJjbGUgeyAgICBib3JkZXItdG9wLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH0gIG1kLXByb2dyZXNzLWNpcmN1bGFyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IC5tZC1pbm5lciAubWQtcmlnaHQgLm1kLWhhbGYtY2lyY2xlIHsgICAgYm9yZGVyLXJpZ2h0LWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH0gIG1kLXByb2dyZXNzLWNpcmN1bGFyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IC5tZC1pbm5lciAubWQtbGVmdCAubWQtaGFsZi1jaXJjbGUgeyAgICBib3JkZXItbGVmdC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9bWQtcHJvZ3Jlc3MtbGluZWFyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWNvbnRhaW5lciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3twcmltYXJ5LTEwMH19JzsgfW1kLXByb2dyZXNzLWxpbmVhci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1iYXIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfW1kLXByb2dyZXNzLWxpbmVhci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4gLm1kLWNvbnRhaW5lciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3t3YXJuLTEwMH19JzsgfW1kLXByb2dyZXNzLWxpbmVhci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4gLm1kLWJhciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3t3YXJuLWNvbG9yfX0nOyB9bWQtcHJvZ3Jlc3MtbGluZWFyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IC5tZC1jb250YWluZXIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LTEwMH19JzsgfW1kLXByb2dyZXNzLWxpbmVhci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudCAubWQtYmFyIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgfW1kLXByb2dyZXNzLWxpbmVhci5tZC1USEVNRV9OQU1FLXRoZW1lW21kLW1vZGU9YnVmZmVyXS5tZC13YXJuIC5tZC1iYXIxIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tMTAwfX0nOyB9bWQtcHJvZ3Jlc3MtbGluZWFyLm1kLVRIRU1FX05BTUUtdGhlbWVbbWQtbW9kZT1idWZmZXJdLm1kLXdhcm4gLm1kLWRhc2hlZDpiZWZvcmUgeyAgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KCd7e3dhcm4tMTAwfX0nIDAlLCAne3t3YXJuLTEwMH19JyAxNiUsIHRyYW5zcGFyZW50IDQyJSk7IH1tZC1wcm9ncmVzcy1saW5lYXIubWQtVEhFTUVfTkFNRS10aGVtZVttZC1tb2RlPWJ1ZmZlcl0ubWQtYWNjZW50IC5tZC1iYXIxIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC0xMDB9fSc7IH1tZC1wcm9ncmVzcy1saW5lYXIubWQtVEhFTUVfTkFNRS10aGVtZVttZC1tb2RlPWJ1ZmZlcl0ubWQtYWNjZW50IC5tZC1kYXNoZWQ6YmVmb3JlIHsgIGJhY2tncm91bmQ6IHJhZGlhbC1ncmFkaWVudCgne3thY2NlbnQtMTAwfX0nIDAlLCAne3thY2NlbnQtMTAwfX0nIDE2JSwgdHJhbnNwYXJlbnQgNDIlKTsgfW1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1vZmYgeyAgYm9yZGVyLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTJ9fSc7IH1tZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtb24geyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yLTAuODd9fSc7IH1tZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1jaGVja2VkIC5tZC1vZmYgeyAgYm9yZGVyLWNvbG9yOiAne3thY2NlbnQtY29sb3ItMC44N319JzsgfW1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWNoZWNrZWQgLm1kLWluay1yaXBwbGUgeyAgY29sb3I6ICd7e2FjY2VudC1jb2xvci0wLjg3fX0nOyB9bWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWNvbnRhaW5lciAubWQtcmlwcGxlIHsgIGNvbG9yOiAne3thY2NlbnQtNjAwfX0nOyB9bWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkgLm1kLXByaW1hcnkgLm1kLW9uLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5IC5tZC1vbiwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC1wcmltYXJ5IC5tZC1vbiwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXByaW1hcnkgLm1kLW9uIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3ItMC44N319JzsgfW1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC1wcmltYXJ5IC5tZC1jaGVja2VkIC5tZC1vZmYsIG1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC1wcmltYXJ5Lm1kLWNoZWNrZWQgLm1kLW9mZiwgbWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtcHJpbWFyeSAubWQtY2hlY2tlZCAubWQtb2ZmLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5Lm1kLWNoZWNrZWQgLm1kLW9mZiwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC1wcmltYXJ5IC5tZC1jaGVja2VkIC5tZC1vZmYsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtcHJpbWFyeS5tZC1jaGVja2VkIC5tZC1vZmYsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5IC5tZC1jaGVja2VkIC5tZC1vZmYsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5Lm1kLWNoZWNrZWQgLm1kLW9mZiB7ICBib3JkZXItY29sb3I6ICd7e3ByaW1hcnktY29sb3ItMC44N319JzsgfW1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC1wcmltYXJ5IC5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtcHJpbWFyeS5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5IC5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5Lm1kLWNoZWNrZWQgLm1kLWluay1yaXBwbGUsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtcHJpbWFyeSAubWQtY2hlY2tlZCAubWQtaW5rLXJpcHBsZSwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC1wcmltYXJ5Lm1kLWNoZWNrZWQgLm1kLWluay1yaXBwbGUsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5IC5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtcHJpbWFyeS5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlIHsgIGNvbG9yOiAne3twcmltYXJ5LWNvbG9yLTAuODd9fSc7IH1tZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtcHJpbWFyeSAubWQtY29udGFpbmVyIC5tZC1yaXBwbGUsIG1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXByaW1hcnkgLm1kLWNvbnRhaW5lciAubWQtcmlwcGxlLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkgLm1kLXByaW1hcnkgLm1kLWNvbnRhaW5lciAubWQtcmlwcGxlLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtcHJpbWFyeSAubWQtY29udGFpbmVyIC5tZC1yaXBwbGUgeyAgY29sb3I6ICd7e3ByaW1hcnktNjAwfX0nOyB9bWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkgLm1kLXdhcm4gLm1kLW9uLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC13YXJuIC5tZC1vbiwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC13YXJuIC5tZC1vbiwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXdhcm4gLm1kLW9uIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3ItMC44N319JzsgfW1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC13YXJuIC5tZC1jaGVja2VkIC5tZC1vZmYsIG1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC13YXJuLm1kLWNoZWNrZWQgLm1kLW9mZiwgbWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtd2FybiAubWQtY2hlY2tlZCAubWQtb2ZmLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC13YXJuLm1kLWNoZWNrZWQgLm1kLW9mZiwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC13YXJuIC5tZC1jaGVja2VkIC5tZC1vZmYsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtd2Fybi5tZC1jaGVja2VkIC5tZC1vZmYsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC13YXJuIC5tZC1jaGVja2VkIC5tZC1vZmYsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC13YXJuLm1kLWNoZWNrZWQgLm1kLW9mZiB7ICBib3JkZXItY29sb3I6ICd7e3dhcm4tY29sb3ItMC44N319JzsgfW1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC13YXJuIC5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtd2Fybi5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC13YXJuIC5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC13YXJuLm1kLWNoZWNrZWQgLm1kLWluay1yaXBwbGUsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtd2FybiAubWQtY2hlY2tlZCAubWQtaW5rLXJpcHBsZSwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC13YXJuLm1kLWNoZWNrZWQgLm1kLWluay1yaXBwbGUsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC13YXJuIC5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtd2Fybi5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlIHsgIGNvbG9yOiAne3t3YXJuLWNvbG9yLTAuODd9fSc7IH1tZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtd2FybiAubWQtY29udGFpbmVyIC5tZC1yaXBwbGUsIG1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXdhcm4gLm1kLWNvbnRhaW5lciAubWQtcmlwcGxlLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkgLm1kLXdhcm4gLm1kLWNvbnRhaW5lciAubWQtcmlwcGxlLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtd2FybiAubWQtY29udGFpbmVyIC5tZC1yaXBwbGUgeyAgY29sb3I6ICd7e3dhcm4tNjAwfX0nOyB9bWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0sIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXSB7ICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0zfX0nOyB9ICBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXSAubWQtY29udGFpbmVyIC5tZC1vZmYsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXSAubWQtY29udGFpbmVyIC5tZC1vZmYgeyAgICBib3JkZXItY29sb3I6ICd7e2ZvcmVncm91bmQtM319JzsgfSAgbWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0gLm1kLWNvbnRhaW5lciAubWQtb24sIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXSAubWQtY29udGFpbmVyIC5tZC1vbiB7ICAgIGJvcmRlci1jb2xvcjogJ3t7Zm9yZWdyb3VuZC0zfX0nOyB9bWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mb2N1c2VkOm5vdCg6ZW1wdHkpIC5tZC1jaGVja2VkIC5tZC1jb250YWluZXI6YmVmb3JlIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC1jb2xvci0wLjI2fX0nOyB9bWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mb2N1c2VkOm5vdCg6ZW1wdHkpIC5tZC1jaGVja2VkOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5IC5tZC1jb250YWluZXI6YmVmb3JlIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3ItMC4yNn19JzsgfW1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtZm9jdXNlZDpub3QoOmVtcHR5KSAubWQtY2hlY2tlZC5tZC1wcmltYXJ5IC5tZC1jb250YWluZXI6YmVmb3JlIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3ItMC4yNn19JzsgfW1kLXNlbGVjdC5tZC1USEVNRV9OQU1FLXRoZW1lLm5nLWludmFsaWQubmctZGlydHkgLm1kLXNlbGVjdC1sYWJlbCB7ICBjb2xvcjogJ3t7d2Fybi01MDB9fScgIWltcG9ydGFudDsgIGJvcmRlci1ib3R0b20tY29sb3I6ICd7e3dhcm4tNTAwfX0nICFpbXBvcnRhbnQ7IH1tZC1zZWxlY3QubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSk6Zm9jdXMgLm1kLXNlbGVjdC1sYWJlbCB7ICBib3JkZXItYm90dG9tLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyAgY29sb3I6ICd7eyBmb3JlZ3JvdW5kLTEgfX0nOyB9ICBtZC1zZWxlY3QubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSk6Zm9jdXMgLm1kLXNlbGVjdC1sYWJlbC5tZC1wbGFjZWhvbGRlciB7ICAgIGNvbG9yOiAne3sgZm9yZWdyb3VuZC0xIH19JzsgfW1kLXNlbGVjdC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKTpmb2N1cy5tZC1hY2NlbnQgLm1kLXNlbGVjdC1sYWJlbCB7ICBib3JkZXItYm90dG9tLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH1tZC1zZWxlY3QubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSk6Zm9jdXMubWQtd2FybiAubWQtc2VsZWN0LWxhYmVsIHsgIGJvcmRlci1ib3R0b20tY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH1tZC1zZWxlY3QubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0gLm1kLXNlbGVjdC1sYWJlbCB7ICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0zfX0nOyB9ICBtZC1zZWxlY3QubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0gLm1kLXNlbGVjdC1sYWJlbC5tZC1wbGFjZWhvbGRlciB7ICAgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTN9fSc7IH1tZC1zZWxlY3QubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtc2VsZWN0LWxhYmVsIHsgIGJvcmRlci1ib3R0b20tY29sb3I6ICd7e2ZvcmVncm91bmQtNH19JzsgfSAgbWQtc2VsZWN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXNlbGVjdC1sYWJlbC5tZC1wbGFjZWhvbGRlciB7ICAgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTJ9fSc7IH1tZC1zZWxlY3QtbWVudS5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLW9wdGdyb3VwIHsgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTJ9fSc7IH0gIG1kLXNlbGVjdC1tZW51Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtb3B0Z3JvdXAgbWQtb3B0aW9uIHsgICAgY29sb3I6ICd7e2ZvcmVncm91bmQtMX19JzsgfW1kLXNlbGVjdC1tZW51Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtb3B0aW9uW3NlbGVjdGVkXSB7ICBjb2xvcjogJ3t7cHJpbWFyeS01MDB9fSc7IH0gIG1kLXNlbGVjdC1tZW51Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtb3B0aW9uW3NlbGVjdGVkXTpmb2N1cyB7ICAgIGNvbG9yOiAne3twcmltYXJ5LTYwMH19JzsgfSAgbWQtc2VsZWN0LW1lbnUubWQtVEhFTUVfTkFNRS10aGVtZSBtZC1vcHRpb25bc2VsZWN0ZWRdLm1kLWFjY2VudCB7ICAgIGNvbG9yOiAne3thY2NlbnQtNTAwfX0nOyB9ICAgIG1kLXNlbGVjdC1tZW51Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtb3B0aW9uW3NlbGVjdGVkXS5tZC1hY2NlbnQ6Zm9jdXMgeyAgICAgIGNvbG9yOiAne3thY2NlbnQtNjAwfX0nOyB9bWQtc2VsZWN0LW1lbnUubWQtVEhFTUVfTkFNRS10aGVtZSBtZC1vcHRpb246Zm9jdXM6bm90KFtzZWxlY3RlZF0pIHsgIGJhY2tncm91bmQ6ICd7e2JhY2tncm91bmQtMjAwfX0nOyB9bWQtc2lkZW5hdi5tZC1USEVNRV9OQU1FLXRoZW1lIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2JhY2tncm91bmQtY29sb3J9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtdHJhY2sgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7Zm9yZWdyb3VuZC0zfX0nOyB9bWQtc2xpZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXRyYWNrLXRpY2tzIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2ZvcmVncm91bmQtNH19JzsgfW1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1mb2N1cy10aHVtYiB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTJ9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtZm9jdXMtcmluZyB7ICBib3JkZXItY29sb3I6ICd7e2ZvcmVncm91bmQtNH19JzsgfW1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1kaXNhYmxlZC10aHVtYiB7ICBib3JkZXItY29sb3I6ICd7e2JhY2tncm91bmQtY29sb3J9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1taW4gLm1kLXRodW1iOmFmdGVyIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2JhY2tncm91bmQtY29sb3J9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtdHJhY2subWQtdHJhY2stZmlsbCB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtdGh1bWI6YWZ0ZXIgeyAgYm9yZGVyLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtc2lnbiB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH0gIG1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1zaWduOmFmdGVyIHsgICAgYm9yZGVyLXRvcC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9bWQtc2xpZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXRodW1iLXRleHQgeyAgY29sb3I6ICd7e2FjY2VudC1jb250cmFzdH19JzsgfW1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4gLm1kLXRyYWNrLm1kLXRyYWNrLWZpbGwgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgfW1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4gLm1kLXRodW1iOmFmdGVyIHsgIGJvcmRlci1jb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuIC5tZC1zaWduIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH0gIG1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4gLm1kLXNpZ246YWZ0ZXIgeyAgICBib3JkZXItdG9wLWNvbG9yOiAne3t3YXJuLWNvbG9yfX0nOyB9bWQtc2xpZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiAubWQtdGh1bWItdGV4dCB7ICBjb2xvcjogJ3t7d2Fybi1jb250cmFzdH19JzsgfW1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkgLm1kLXRyYWNrLm1kLXRyYWNrLWZpbGwgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfW1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkgLm1kLXRodW1iOmFmdGVyIHsgIGJvcmRlci1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3J9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5IC5tZC1zaWduIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3J9fSc7IH0gIG1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkgLm1kLXNpZ246YWZ0ZXIgeyAgICBib3JkZXItdG9wLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyB9bWQtc2xpZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeSAubWQtdGh1bWItdGV4dCB7ICBjb2xvcjogJ3t7cHJpbWFyeS1jb250cmFzdH19JzsgfW1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXSAubWQtdGh1bWI6YWZ0ZXIgeyAgYm9yZGVyLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTN9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF06bm90KC5tZC1taW4pIC5tZC10aHVtYjphZnRlciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTN9fSc7IH0ubWQtc3ViaGVhZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgY29sb3I6ICd7eyBmb3JlZ3JvdW5kLTItMC4yMyB9fSc7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tiYWNrZ3JvdW5kLWNvbG9yfX0nOyB9ICAubWQtc3ViaGVhZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeSB7ICAgIGNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyB9ICAubWQtc3ViaGVhZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IHsgICAgY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgfSAgLm1kLXN1YmhlYWRlci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4geyAgICBjb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgfW1kLXN3aXRjaC5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC10aHVtYiB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tiYWNrZ3JvdW5kLTUwfX0nOyB9bWQtc3dpdGNoLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWJhciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tiYWNrZ3JvdW5kLTUwMH19JzsgfW1kLXN3aXRjaC5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWNoZWNrZWQgLm1kLXRodW1iIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgfW1kLXN3aXRjaC5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWNoZWNrZWQgLm1kLWJhciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtY29sb3ItMC41fX0nOyB9bWQtc3dpdGNoLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtY2hlY2tlZC5tZC1mb2N1c2VkIC5tZC10aHVtYjpiZWZvcmUgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yLTAuMjZ9fSc7IH1tZC1zd2l0Y2gubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1jaGVja2VkLm1kLXByaW1hcnkgLm1kLXRodW1iIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3J9fSc7IH1tZC1zd2l0Y2gubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1jaGVja2VkLm1kLXByaW1hcnkgLm1kLWJhciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yLTAuNX19JzsgfW1kLXN3aXRjaC5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWNoZWNrZWQubWQtcHJpbWFyeS5tZC1mb2N1c2VkIC5tZC10aHVtYjpiZWZvcmUgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvci0wLjI2fX0nOyB9bWQtc3dpdGNoLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtY2hlY2tlZC5tZC13YXJuIC5tZC10aHVtYiB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3t3YXJuLWNvbG9yfX0nOyB9bWQtc3dpdGNoLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtY2hlY2tlZC5tZC13YXJuIC5tZC1iYXIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7d2Fybi1jb2xvci0wLjV9fSc7IH1tZC1zd2l0Y2gubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1jaGVja2VkLm1kLXdhcm4ubWQtZm9jdXNlZCAubWQtdGh1bWI6YmVmb3JlIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3ItMC4yNn19JzsgfW1kLXN3aXRjaC5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXSAubWQtdGh1bWIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC00MDB9fSc7IH1tZC1zd2l0Y2gubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0gLm1kLWJhciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTR9fSc7IH1tZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtdGFicy13cmFwcGVyIHsgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50OyAgYm9yZGVyLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTR9fSc7IH1tZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXBhZ2luYXRvciBtZC1pY29uIHsgIGNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyB9bWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLWluay1iYXIgeyAgY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgIGJhY2tncm91bmQ6ICd7e2FjY2VudC1jb2xvcn19JzsgfW1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtdGFiIHsgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTJ9fSc7IH0gIG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtdGFiW2Rpc2FibGVkXSB7ICAgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTN9fSc7IH0gIG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtdGFiLm1kLWFjdGl2ZSwgbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC10YWIubWQtZm9jdXNlZCB7ICAgIGNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyB9ICBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXRhYi5tZC1mb2N1c2VkIHsgICAgYmFja2dyb3VuZDogJ3t7cHJpbWFyeS1jb2xvci0wLjF9fSc7IH0gIG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtdGFiIC5tZC1yaXBwbGUtY29udGFpbmVyIHsgICAgY29sb3I6ICd7e2FjY2VudC0xMDB9fSc7IH1tZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IG1kLXRhYnMtd3JhcHBlciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH1tZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IG1kLXRhYi1pdGVtOm5vdChbZGlzYWJsZWRdKSB7ICBjb2xvcjogJ3t7YWNjZW50LTEwMH19JzsgfSAgbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudCBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtYWN0aXZlLCBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IG1kLXRhYi1pdGVtOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkIHsgICAgY29sb3I6ICd7e2FjY2VudC1jb250cmFzdH19JzsgfSAgbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudCBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgIGJhY2tncm91bmQ6ICd7e2FjY2VudC1jb250cmFzdC0wLjF9fSc7IH1tZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IG1kLWluay1iYXIgeyAgY29sb3I6ICd7e3ByaW1hcnktNjAwLTF9fSc7ICBiYWNrZ3JvdW5kOiAne3twcmltYXJ5LTYwMC0xfX0nOyB9bWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkgbWQtdGFicy13cmFwcGVyIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3J9fSc7IH1tZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeSBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkgeyAgY29sb3I6ICd7e3ByaW1hcnktMTAwfX0nOyB9ICBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeSBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtYWN0aXZlLCBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeSBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgIGNvbG9yOiAne3twcmltYXJ5LWNvbnRyYXN0fX0nOyB9ICBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeSBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgIGJhY2tncm91bmQ6ICd7e3ByaW1hcnktY29udHJhc3QtMC4xfX0nOyB9bWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4gbWQtdGFicy13cmFwcGVyIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH1tZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkgeyAgY29sb3I6ICd7e3dhcm4tMTAwfX0nOyB9ICBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtYWN0aXZlLCBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgIGNvbG9yOiAne3t3YXJuLWNvbnRyYXN0fX0nOyB9ICBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgIGJhY2tncm91bmQ6ICd7e3dhcm4tY29udHJhc3QtMC4xfX0nOyB9bWQtdG9vbGJhciA+IG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSBtZC10YWJzLXdyYXBwZXIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfW1kLXRvb2xiYXIgPiBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pIHsgIGNvbG9yOiAne3twcmltYXJ5LTEwMH19JzsgfSAgbWQtdG9vbGJhciA+IG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtYWN0aXZlLCBtZC10b29sYmFyID4gbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLXRhYi1pdGVtOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkIHsgICAgY29sb3I6ICd7e3ByaW1hcnktY29udHJhc3R9fSc7IH0gIG1kLXRvb2xiYXIgPiBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQgeyAgICBiYWNrZ3JvdW5kOiAne3twcmltYXJ5LWNvbnRyYXN0LTAuMX19JzsgfW1kLXRvb2xiYXIubWQtYWNjZW50ID4gbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLXRhYnMtd3JhcHBlciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH1tZC10b29sYmFyLm1kLWFjY2VudCA+IG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkgeyAgY29sb3I6ICd7e2FjY2VudC0xMDB9fSc7IH0gIG1kLXRvb2xiYXIubWQtYWNjZW50ID4gbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLXRhYi1pdGVtOm5vdChbZGlzYWJsZWRdKS5tZC1hY3RpdmUsIG1kLXRvb2xiYXIubWQtYWNjZW50ID4gbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLXRhYi1pdGVtOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkIHsgICAgY29sb3I6ICd7e2FjY2VudC1jb250cmFzdH19JzsgfSAgbWQtdG9vbGJhci5tZC1hY2NlbnQgPiBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQgeyAgICBiYWNrZ3JvdW5kOiAne3thY2NlbnQtY29udHJhc3QtMC4xfX0nOyB9bWQtdG9vbGJhci5tZC1hY2NlbnQgPiBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtaW5rLWJhciB7ICBjb2xvcjogJ3t7cHJpbWFyeS02MDAtMX19JzsgIGJhY2tncm91bmQ6ICd7e3ByaW1hcnktNjAwLTF9fSc7IH1tZC10b29sYmFyLm1kLXdhcm4gPiBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtdGFicy13cmFwcGVyIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH1tZC10b29sYmFyLm1kLXdhcm4gPiBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pIHsgIGNvbG9yOiAne3t3YXJuLTEwMH19JzsgfSAgbWQtdG9vbGJhci5tZC13YXJuID4gbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLXRhYi1pdGVtOm5vdChbZGlzYWJsZWRdKS5tZC1hY3RpdmUsIG1kLXRvb2xiYXIubWQtd2FybiA+IG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgIGNvbG9yOiAne3t3YXJuLWNvbnRyYXN0fX0nOyB9ICBtZC10b29sYmFyLm1kLXdhcm4gPiBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQgeyAgICBiYWNrZ3JvdW5kOiAne3t3YXJuLWNvbnRyYXN0LTAuMX19JzsgfW1kLXRvYXN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgYmFja2dyb3VuZC1jb2xvcjogIzMyMzIzMjsgIGNvbG9yOiAne3tiYWNrZ3JvdW5kLTUwfX0nOyB9ICBtZC10b2FzdC5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1idXR0b24geyAgICBjb2xvcjogJ3t7YmFja2dyb3VuZC01MH19JzsgfSAgICBtZC10b2FzdC5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1idXR0b24ubWQtaGlnaGxpZ2h0IHsgICAgICBjb2xvcjogJ3t7cHJpbWFyeS1BMjAwfX0nOyB9ICAgICAgbWQtdG9hc3QubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtYnV0dG9uLm1kLWhpZ2hsaWdodC5tZC1hY2NlbnQgeyAgICAgICAgY29sb3I6ICd7e2FjY2VudC1BMjAwfX0nOyB9ICAgICAgbWQtdG9hc3QubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtYnV0dG9uLm1kLWhpZ2hsaWdodC5tZC13YXJuIHsgICAgICAgIGNvbG9yOiAne3t3YXJuLUEyMDB9fSc7IH1tZC10b29sYmFyLm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgIGNvbG9yOiAne3twcmltYXJ5LWNvbnRyYXN0fX0nOyB9ICBtZC10b29sYmFyLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtaWNvbiB7ICAgIGNvbG9yOiAne3twcmltYXJ5LWNvbnRyYXN0fX0nOyB9ICBtZC10b29sYmFyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWJ1dHRvbiB7ICAgIGNvbG9yOiAne3twcmltYXJ5LWNvbnRyYXN0fX0nOyB9ICBtZC10b29sYmFyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IHsgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyAgICBjb2xvcjogJ3t7YWNjZW50LWNvbnRyYXN0fX0nOyB9ICBtZC10b29sYmFyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiB7ICAgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7ICAgIGNvbG9yOiAne3t3YXJuLWNvbnRyYXN0fX0nOyB9bWQtdG9vbHRpcC5tZC1USEVNRV9OQU1FLXRoZW1lIHsgIGNvbG9yOiAne3tiYWNrZ3JvdW5kLUExMDB9fSc7IH0gIG1kLXRvb2x0aXAubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtYmFja2dyb3VuZCB7ICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2ZvcmVncm91bmQtMn19JzsgfVwiKTsgXHJcbn0pKCk7XHJcblxyXG5cclxufSkod2luZG93LCB3aW5kb3cuYW5ndWxhcik7IiwiLypcclxuIGpRdWVyeSBVSSBTb3J0YWJsZSBwbHVnaW4gd3JhcHBlclxyXG5cclxuIEBwYXJhbSBbdWktc29ydGFibGVdIHtvYmplY3R9IE9wdGlvbnMgdG8gcGFzcyB0byAkLmZuLnNvcnRhYmxlKCkgbWVyZ2VkIG9udG8gdWkuY29uZmlnXHJcbiAqL1xyXG5hbmd1bGFyLm1vZHVsZSgndWkuc29ydGFibGUnLCBbXSlcclxuICAudmFsdWUoJ3VpU29ydGFibGVDb25maWcnLHt9KVxyXG4gIC5kaXJlY3RpdmUoJ3VpU29ydGFibGUnLCBbXHJcbiAgICAndWlTb3J0YWJsZUNvbmZpZycsICckdGltZW91dCcsICckbG9nJyxcclxuICAgIGZ1bmN0aW9uKHVpU29ydGFibGVDb25maWcsICR0aW1lb3V0LCAkbG9nKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVxdWlyZTogJz9uZ01vZGVsJyxcclxuICAgICAgICBzY29wZToge1xyXG4gICAgICAgICAgbmdNb2RlbDogJz0nLFxyXG4gICAgICAgICAgdWlTb3J0YWJsZTogJz0nXHJcbiAgICAgICAgfSxcclxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIG5nTW9kZWwpIHtcclxuICAgICAgICAgIHZhciBzYXZlZE5vZGVzO1xyXG5cclxuICAgICAgICAgIGZ1bmN0aW9uIGNvbWJpbmVDYWxsYmFja3MoZmlyc3Qsc2Vjb25kKXtcclxuICAgICAgICAgICAgaWYoc2Vjb25kICYmICh0eXBlb2Ygc2Vjb25kID09PSAnZnVuY3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGZpcnN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgICAgICBzZWNvbmQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmaXJzdDtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBmdW5jdGlvbiBnZXRTb3J0YWJsZVdpZGdldEluc3RhbmNlKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgLy8gdGhpcyBpcyBhIGZpeCB0byBzdXBwb3J0IGpxdWVyeS11aSBwcmlvciB0byB2MS4xMS54XHJcbiAgICAgICAgICAgIC8vIG90aGVyd2lzZSB3ZSBzaG91bGQgYmUgdXNpbmcgYGVsZW1lbnQuc29ydGFibGUoJ2luc3RhbmNlJylgXHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gZWxlbWVudC5kYXRhKCd1aS1zb3J0YWJsZScpO1xyXG4gICAgICAgICAgICBpZiAoZGF0YSAmJiB0eXBlb2YgZGF0YSA9PT0gJ29iamVjdCcgJiYgZGF0YS53aWRnZXRGdWxsTmFtZSA9PT0gJ3VpLXNvcnRhYmxlJykge1xyXG4gICAgICAgICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGZ1bmN0aW9uIGhhc1NvcnRpbmdIZWxwZXIgKGVsZW1lbnQsIHVpKSB7XHJcbiAgICAgICAgICAgIHZhciBoZWxwZXJPcHRpb24gPSBlbGVtZW50LnNvcnRhYmxlKCdvcHRpb24nLCdoZWxwZXInKTtcclxuICAgICAgICAgICAgcmV0dXJuIGhlbHBlck9wdGlvbiA9PT0gJ2Nsb25lJyB8fCAodHlwZW9mIGhlbHBlck9wdGlvbiA9PT0gJ2Z1bmN0aW9uJyAmJiB1aS5pdGVtLnNvcnRhYmxlLmlzQ3VzdG9tSGVscGVyVXNlZCgpKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvLyB0aGFua3MganF1ZXJ5LXVpXHJcbiAgICAgICAgICBmdW5jdGlvbiBpc0Zsb2F0aW5nIChpdGVtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoL2xlZnR8cmlnaHQvKS50ZXN0KGl0ZW0uY3NzKCdmbG9hdCcpKSB8fCAoL2lubGluZXx0YWJsZS1jZWxsLykudGVzdChpdGVtLmNzcygnZGlzcGxheScpKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBmdW5jdGlvbiBnZXRFbGVtZW50U2NvcGUoZWxlbWVudFNjb3BlcywgZWxlbWVudCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gbnVsbDtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50U2NvcGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgdmFyIHggPSBlbGVtZW50U2NvcGVzW2ldO1xyXG4gICAgICAgICAgICAgIGlmICh4LmVsZW1lbnRbMF0gPT09IGVsZW1lbnRbMF0pIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHguc2NvcGU7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBmdW5jdGlvbiBhZnRlclN0b3AoZSwgdWkpIHtcclxuICAgICAgICAgICAgdWkuaXRlbS5zb3J0YWJsZS5fZGVzdHJveSgpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIHZhciBvcHRzID0ge307XHJcblxyXG4gICAgICAgICAgLy8gZGlyZWN0aXZlIHNwZWNpZmljIG9wdGlvbnNcclxuICAgICAgICAgIHZhciBkaXJlY3RpdmVPcHRzID0ge1xyXG4gICAgICAgICAgICAndWktZmxvYXRpbmcnOiB1bmRlZmluZWRcclxuICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgdmFyIGNhbGxiYWNrcyA9IHtcclxuICAgICAgICAgICAgcmVjZWl2ZTogbnVsbCxcclxuICAgICAgICAgICAgcmVtb3ZlOm51bGwsXHJcbiAgICAgICAgICAgIHN0YXJ0Om51bGwsXHJcbiAgICAgICAgICAgIHN0b3A6bnVsbCxcclxuICAgICAgICAgICAgdXBkYXRlOm51bGxcclxuICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgdmFyIHdyYXBwZXJzID0ge1xyXG4gICAgICAgICAgICBoZWxwZXI6IG51bGxcclxuICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgYW5ndWxhci5leHRlbmQob3B0cywgZGlyZWN0aXZlT3B0cywgdWlTb3J0YWJsZUNvbmZpZywgc2NvcGUudWlTb3J0YWJsZSk7XHJcblxyXG4gICAgICAgICAgaWYgKCFhbmd1bGFyLmVsZW1lbnQuZm4gfHwgIWFuZ3VsYXIuZWxlbWVudC5mbi5qcXVlcnkpIHtcclxuICAgICAgICAgICAgJGxvZy5lcnJvcigndWkuc29ydGFibGU6IGpRdWVyeSBzaG91bGQgYmUgaW5jbHVkZWQgYmVmb3JlIEFuZ3VsYXJKUyEnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGlmIChuZ01vZGVsKSB7XHJcblxyXG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFkZCBvciByZW1vdmUgZWxlbWVudHMsIHdlIG5lZWQgdGhlIHNvcnRhYmxlIHRvICdyZWZyZXNoJ1xyXG4gICAgICAgICAgICAvLyBzbyBpdCBjYW4gZmluZCB0aGUgbmV3L3JlbW92ZWQgZWxlbWVudHMuXHJcbiAgICAgICAgICAgIHNjb3BlLiR3YXRjaCgnbmdNb2RlbC5sZW5ndGgnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAvLyBUaW1lb3V0IHRvIGxldCBuZy1yZXBlYXQgbW9kaWZ5IHRoZSBET01cclxuICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIC8vIGVuc3VyZSB0aGF0IHRoZSBqcXVlcnktdWktc29ydGFibGUgd2lkZ2V0IGluc3RhbmNlXHJcbiAgICAgICAgICAgICAgICAvLyBpcyBzdGlsbCBib3VuZCB0byB0aGUgZGlyZWN0aXZlJ3MgZWxlbWVudFxyXG4gICAgICAgICAgICAgICAgaWYgKCEhZ2V0U29ydGFibGVXaWRnZXRJbnN0YW5jZShlbGVtZW50KSkge1xyXG4gICAgICAgICAgICAgICAgICBlbGVtZW50LnNvcnRhYmxlKCdyZWZyZXNoJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSwgMCwgZmFsc2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNhbGxiYWNrcy5zdGFydCA9IGZ1bmN0aW9uKGUsIHVpKSB7XHJcbiAgICAgICAgICAgICAgaWYgKG9wdHNbJ3VpLWZsb2F0aW5nJ10gPT09ICdhdXRvJykge1xyXG4gICAgICAgICAgICAgICAgLy8gc2luY2UgdGhlIGRyYWcgaGFzIHN0YXJ0ZWQsIHRoZSBlbGVtZW50IHdpbGwgYmVcclxuICAgICAgICAgICAgICAgIC8vIGFic29sdXRlbHkgcG9zaXRpb25lZCwgc28gd2UgY2hlY2sgaXRzIHNpYmxpbmdzXHJcbiAgICAgICAgICAgICAgICB2YXIgc2libGluZ3MgPSB1aS5pdGVtLnNpYmxpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgc29ydGFibGVXaWRnZXRJbnN0YW5jZSA9IGdldFNvcnRhYmxlV2lkZ2V0SW5zdGFuY2UoYW5ndWxhci5lbGVtZW50KGUudGFyZ2V0KSk7XHJcbiAgICAgICAgICAgICAgICBzb3J0YWJsZVdpZGdldEluc3RhbmNlLmZsb2F0aW5nID0gaXNGbG9hdGluZyhzaWJsaW5ncyk7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAvLyBTYXZlIHRoZSBzdGFydGluZyBwb3NpdGlvbiBvZiBkcmFnZ2VkIGl0ZW1cclxuICAgICAgICAgICAgICB1aS5pdGVtLnNvcnRhYmxlID0ge1xyXG4gICAgICAgICAgICAgICAgbW9kZWw6IG5nTW9kZWwuJG1vZGVsVmFsdWVbdWkuaXRlbS5pbmRleCgpXSxcclxuICAgICAgICAgICAgICAgIGluZGV4OiB1aS5pdGVtLmluZGV4KCksXHJcbiAgICAgICAgICAgICAgICBzb3VyY2U6IHVpLml0ZW0ucGFyZW50KCksXHJcbiAgICAgICAgICAgICAgICBzb3VyY2VNb2RlbDogbmdNb2RlbC4kbW9kZWxWYWx1ZSxcclxuICAgICAgICAgICAgICAgIGNhbmNlbDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICB1aS5pdGVtLnNvcnRhYmxlLl9pc0NhbmNlbGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBpc0NhbmNlbGVkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgIHJldHVybiB1aS5pdGVtLnNvcnRhYmxlLl9pc0NhbmNlbGVkO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGlzQ3VzdG9tSGVscGVyVXNlZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gISF1aS5pdGVtLnNvcnRhYmxlLl9pc0N1c3RvbUhlbHBlclVzZWQ7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgX2lzQ2FuY2VsZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgX2lzQ3VzdG9tSGVscGVyVXNlZDogdWkuaXRlbS5zb3J0YWJsZS5faXNDdXN0b21IZWxwZXJVc2VkLFxyXG4gICAgICAgICAgICAgICAgX2Rlc3Ryb3k6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHVpLml0ZW0uc29ydGFibGUsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICB1aS5pdGVtLnNvcnRhYmxlW2tleV0gPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBjYWxsYmFja3MuYWN0aXZhdGUgPSBmdW5jdGlvbihlLCB1aSkge1xyXG4gICAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gbWFrZSBhIGNvcHkgb2YgdGhlIGN1cnJlbnQgZWxlbWVudCdzIGNvbnRlbnRzIHNvXHJcbiAgICAgICAgICAgICAgLy8gd2UgY2FuIHJlc3RvcmUgaXQgYWZ0ZXIgc29ydGFibGUgaGFzIG1lc3NlZCBpdCB1cC5cclxuICAgICAgICAgICAgICAvLyBUaGlzIGlzIGluc2lkZSBhY3RpdmF0ZSAoaW5zdGVhZCBvZiBzdGFydCkgaW4gb3JkZXIgdG8gc2F2ZVxyXG4gICAgICAgICAgICAgIC8vIGJvdGggbGlzdHMgd2hlbiBkcmFnZ2luZyBiZXR3ZWVuIGNvbm5lY3RlZCBsaXN0cy5cclxuICAgICAgICAgICAgICBzYXZlZE5vZGVzID0gZWxlbWVudC5jb250ZW50cygpO1xyXG5cclxuICAgICAgICAgICAgICAvLyBJZiB0aGlzIGxpc3QgaGFzIGEgcGxhY2Vob2xkZXIgKHRoZSBjb25uZWN0ZWQgbGlzdHMgd29uJ3QpLFxyXG4gICAgICAgICAgICAgIC8vIGRvbid0IGlubGN1ZGUgaXQgaW4gc2F2ZWQgbm9kZXMuXHJcbiAgICAgICAgICAgICAgdmFyIHBsYWNlaG9sZGVyID0gZWxlbWVudC5zb3J0YWJsZSgnb3B0aW9uJywncGxhY2Vob2xkZXInKTtcclxuXHJcbiAgICAgICAgICAgICAgLy8gcGxhY2Vob2xkZXIuZWxlbWVudCB3aWxsIGJlIGEgZnVuY3Rpb24gaWYgdGhlIHBsYWNlaG9sZGVyLCBoYXNcclxuICAgICAgICAgICAgICAvLyBiZWVuIGNyZWF0ZWQgKHBsYWNlaG9sZGVyIHdpbGwgYmUgYW4gb2JqZWN0KS4gIElmIGl0IGhhc24ndFxyXG4gICAgICAgICAgICAgIC8vIGJlZW4gY3JlYXRlZCwgZWl0aGVyIHBsYWNlaG9sZGVyIHdpbGwgYmUgZmFsc2UgaWYgbm9cclxuICAgICAgICAgICAgICAvLyBwbGFjZWhvbGRlciBjbGFzcyB3YXMgZ2l2ZW4gb3IgcGxhY2Vob2xkZXIuZWxlbWVudCB3aWxsIGJlXHJcbiAgICAgICAgICAgICAgLy8gdW5kZWZpbmVkIGlmIGEgY2xhc3Mgd2FzIGdpdmVuIChwbGFjZWhvbGRlciB3aWxsIGJlIGEgc3RyaW5nKVxyXG4gICAgICAgICAgICAgIGlmIChwbGFjZWhvbGRlciAmJiBwbGFjZWhvbGRlci5lbGVtZW50ICYmIHR5cGVvZiBwbGFjZWhvbGRlci5lbGVtZW50ID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGhFbGVtZW50ID0gcGxhY2Vob2xkZXIuZWxlbWVudCgpO1xyXG4gICAgICAgICAgICAgICAgLy8gd29ya2Fyb3VuZCBmb3IganF1ZXJ5IHVpIDEuOS54LFxyXG4gICAgICAgICAgICAgICAgLy8gbm90IHJldHVybmluZyBqcXVlcnkgY29sbGVjdGlvblxyXG4gICAgICAgICAgICAgICAgcGhFbGVtZW50ID0gYW5ndWxhci5lbGVtZW50KHBoRWxlbWVudCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gZXhhY3QgbWF0Y2ggd2l0aCB0aGUgcGxhY2Vob2xkZXIncyBjbGFzcyBhdHRyaWJ1dGUgdG8gaGFuZGxlXHJcbiAgICAgICAgICAgICAgICAvLyB0aGUgY2FzZSB0aGF0IG11bHRpcGxlIGNvbm5lY3RlZCBzb3J0YWJsZXMgZXhpc3QgYW5kXHJcbiAgICAgICAgICAgICAgICAvLyB0aGUgcGxhY2Vob2lsZGVyIG9wdGlvbiBlcXVhbHMgdGhlIGNsYXNzIG9mIHNvcnRhYmxlIGl0ZW1zXHJcbiAgICAgICAgICAgICAgICB2YXIgZXhjbHVkZXMgPSBlbGVtZW50LmZpbmQoJ1tjbGFzcz1cIicgKyBwaEVsZW1lbnQuYXR0cignY2xhc3MnKSArICdcIl06bm90KFtuZy1yZXBlYXRdLCBbZGF0YS1uZy1yZXBlYXRdKScpO1xyXG5cclxuICAgICAgICAgICAgICAgIHNhdmVkTm9kZXMgPSBzYXZlZE5vZGVzLm5vdChleGNsdWRlcyk7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAvLyBzYXZlIHRoZSBkaXJlY3RpdmUncyBzY29wZSBzbyB0aGF0IGl0IGlzIGFjY2Vzc2libGUgZnJvbSB1aS5pdGVtLnNvcnRhYmxlXHJcbiAgICAgICAgICAgICAgdmFyIGNvbm5lY3RlZFNvcnRhYmxlcyA9IHVpLml0ZW0uc29ydGFibGUuX2Nvbm5lY3RlZFNvcnRhYmxlcyB8fCBbXTtcclxuXHJcbiAgICAgICAgICAgICAgY29ubmVjdGVkU29ydGFibGVzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudDogZWxlbWVudCxcclxuICAgICAgICAgICAgICAgIHNjb3BlOiBzY29wZVxyXG4gICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICB1aS5pdGVtLnNvcnRhYmxlLl9jb25uZWN0ZWRTb3J0YWJsZXMgPSBjb25uZWN0ZWRTb3J0YWJsZXM7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBjYWxsYmFja3MudXBkYXRlID0gZnVuY3Rpb24oZSwgdWkpIHtcclxuICAgICAgICAgICAgICAvLyBTYXZlIGN1cnJlbnQgZHJvcCBwb3NpdGlvbiBidXQgb25seSBpZiB0aGlzIGlzIG5vdCBhIHNlY29uZFxyXG4gICAgICAgICAgICAgIC8vIHVwZGF0ZSB0aGF0IGhhcHBlbnMgd2hlbiBtb3ZpbmcgYmV0d2VlbiBsaXN0cyBiZWNhdXNlIHRoZW5cclxuICAgICAgICAgICAgICAvLyB0aGUgdmFsdWUgd2lsbCBiZSBvdmVyd3JpdHRlbiB3aXRoIHRoZSBvbGQgdmFsdWVcclxuICAgICAgICAgICAgICBpZighdWkuaXRlbS5zb3J0YWJsZS5yZWNlaXZlZCkge1xyXG4gICAgICAgICAgICAgICAgdWkuaXRlbS5zb3J0YWJsZS5kcm9waW5kZXggPSB1aS5pdGVtLmluZGV4KCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZHJvcHRhcmdldCA9IHVpLml0ZW0ucGFyZW50KCk7XHJcbiAgICAgICAgICAgICAgICB1aS5pdGVtLnNvcnRhYmxlLmRyb3B0YXJnZXQgPSBkcm9wdGFyZ2V0O1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBkcm9wdGFyZ2V0U2NvcGUgPSBnZXRFbGVtZW50U2NvcGUodWkuaXRlbS5zb3J0YWJsZS5fY29ubmVjdGVkU29ydGFibGVzLCBkcm9wdGFyZ2V0KTtcclxuICAgICAgICAgICAgICAgIHVpLml0ZW0uc29ydGFibGUuZHJvcHRhcmdldE1vZGVsID0gZHJvcHRhcmdldFNjb3BlLm5nTW9kZWw7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gQ2FuY2VsIHRoZSBzb3J0IChsZXQgbmctcmVwZWF0IGRvIHRoZSBzb3J0IGZvciB1cylcclxuICAgICAgICAgICAgICAgIC8vIERvbid0IGNhbmNlbCBpZiB0aGlzIGlzIHRoZSByZWNlaXZlZCBsaXN0IGJlY2F1c2UgaXQgaGFzXHJcbiAgICAgICAgICAgICAgICAvLyBhbHJlYWR5IGJlZW4gY2FuY2VsZWQgaW4gdGhlIG90aGVyIGxpc3QsIGFuZCB0cnlpbmcgdG8gY2FuY2VsXHJcbiAgICAgICAgICAgICAgICAvLyBoZXJlIHdpbGwgbWVzcyB1cCB0aGUgRE9NLlxyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5zb3J0YWJsZSgnY2FuY2VsJyk7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAvLyBQdXQgdGhlIG5vZGVzIGJhY2sgZXhhY3RseSB0aGUgd2F5IHRoZXkgc3RhcnRlZCAodGhpcyBpcyB2ZXJ5XHJcbiAgICAgICAgICAgICAgLy8gaW1wb3J0YW50IGJlY2F1c2UgbmctcmVwZWF0IHVzZXMgY29tbWVudCBlbGVtZW50cyB0byBkZWxpbmVhdGVcclxuICAgICAgICAgICAgICAvLyB0aGUgc3RhcnQgYW5kIHN0b3Agb2YgcmVwZWF0IHNlY3Rpb25zIGFuZCBzb3J0YWJsZSBkb2Vzbid0XHJcbiAgICAgICAgICAgICAgLy8gcmVzcGVjdCB0aGVpciBvcmRlciAoZXZlbiBpZiB3ZSBjYW5jZWwsIHRoZSBvcmRlciBvZiB0aGVcclxuICAgICAgICAgICAgICAvLyBjb21tZW50cyBhcmUgc3RpbGwgbWVzc2VkIHVwKS5cclxuICAgICAgICAgICAgICBpZiAoaGFzU29ydGluZ0hlbHBlcihlbGVtZW50LCB1aSkgJiYgIXVpLml0ZW0uc29ydGFibGUucmVjZWl2ZWQgJiZcclxuICAgICAgICAgICAgICAgICAgZWxlbWVudC5zb3J0YWJsZSggJ29wdGlvbicsICdhcHBlbmRUbycgKSA9PT0gJ3BhcmVudCcpIHtcclxuICAgICAgICAgICAgICAgIC8vIHJlc3RvcmUgYWxsIHRoZSBzYXZlZE5vZGVzIGV4Y2VwdCAudWktc29ydGFibGUtaGVscGVyIGVsZW1lbnRcclxuICAgICAgICAgICAgICAgIC8vICh3aGljaCBpcyBwbGFjZWQgbGFzdCkuIFRoYXQgd2F5IGl0IHdpbGwgYmUgZ2FyYmFnZSBjb2xsZWN0ZWQuXHJcbiAgICAgICAgICAgICAgICBzYXZlZE5vZGVzID0gc2F2ZWROb2Rlcy5ub3Qoc2F2ZWROb2Rlcy5sYXN0KCkpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBzYXZlZE5vZGVzLmFwcGVuZFRvKGVsZW1lbnQpO1xyXG5cclxuICAgICAgICAgICAgICAvLyBJZiB0aGlzIGlzIHRoZSB0YXJnZXQgY29ubmVjdGVkIGxpc3QgdGhlblxyXG4gICAgICAgICAgICAgIC8vIGl0J3Mgc2FmZSB0byBjbGVhciB0aGUgcmVzdG9yZWQgbm9kZXMgc2luY2U6XHJcbiAgICAgICAgICAgICAgLy8gdXBkYXRlIGlzIGN1cnJlbnRseSBydW5uaW5nIGFuZFxyXG4gICAgICAgICAgICAgIC8vIHN0b3AgaXMgbm90IGNhbGxlZCBmb3IgdGhlIHRhcmdldCBsaXN0LlxyXG4gICAgICAgICAgICAgIGlmKHVpLml0ZW0uc29ydGFibGUucmVjZWl2ZWQpIHtcclxuICAgICAgICAgICAgICAgIHNhdmVkTm9kZXMgPSBudWxsO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgLy8gSWYgcmVjZWl2ZWQgaXMgdHJ1ZSAoYW4gaXRlbSB3YXMgZHJvcHBlZCBpbiBmcm9tIGFub3RoZXIgbGlzdClcclxuICAgICAgICAgICAgICAvLyB0aGVuIHdlIGFkZCB0aGUgbmV3IGl0ZW0gdG8gdGhpcyBsaXN0IG90aGVyd2lzZSB3YWl0IHVudGlsIHRoZVxyXG4gICAgICAgICAgICAgIC8vIHN0b3AgZXZlbnQgd2hlcmUgd2Ugd2lsbCBrbm93IGlmIGl0IHdhcyBhIHNvcnQgb3IgaXRlbSB3YXNcclxuICAgICAgICAgICAgICAvLyBtb3ZlZCBoZXJlIGZyb20gYW5vdGhlciBsaXN0XHJcbiAgICAgICAgICAgICAgaWYodWkuaXRlbS5zb3J0YWJsZS5yZWNlaXZlZCAmJiAhdWkuaXRlbS5zb3J0YWJsZS5pc0NhbmNlbGVkKCkpIHtcclxuICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgIG5nTW9kZWwuJG1vZGVsVmFsdWUuc3BsaWNlKHVpLml0ZW0uc29ydGFibGUuZHJvcGluZGV4LCAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5pdGVtLnNvcnRhYmxlLm1vdmVkKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGNhbGxiYWNrcy5zdG9wID0gZnVuY3Rpb24oZSwgdWkpIHtcclxuICAgICAgICAgICAgICAvLyBJZiB0aGUgcmVjZWl2ZWQgZmxhZyBoYXNuJ3QgYmUgc2V0IG9uIHRoZSBpdGVtLCB0aGlzIGlzIGFcclxuICAgICAgICAgICAgICAvLyBub3JtYWwgc29ydCwgaWYgZHJvcGluZGV4IGlzIHNldCwgdGhlIGl0ZW0gd2FzIG1vdmVkLCBzbyBtb3ZlXHJcbiAgICAgICAgICAgICAgLy8gdGhlIGl0ZW1zIGluIHRoZSBsaXN0LlxyXG4gICAgICAgICAgICAgIGlmKCF1aS5pdGVtLnNvcnRhYmxlLnJlY2VpdmVkICYmXHJcbiAgICAgICAgICAgICAgICAgKCdkcm9waW5kZXgnIGluIHVpLml0ZW0uc29ydGFibGUpICYmXHJcbiAgICAgICAgICAgICAgICAgIXVpLml0ZW0uc29ydGFibGUuaXNDYW5jZWxlZCgpKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgbmdNb2RlbC4kbW9kZWxWYWx1ZS5zcGxpY2UoXHJcbiAgICAgICAgICAgICAgICAgICAgdWkuaXRlbS5zb3J0YWJsZS5kcm9waW5kZXgsIDAsXHJcbiAgICAgICAgICAgICAgICAgICAgbmdNb2RlbC4kbW9kZWxWYWx1ZS5zcGxpY2UodWkuaXRlbS5zb3J0YWJsZS5pbmRleCwgMSlbMF0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIGlmIHRoZSBpdGVtIHdhcyBub3QgbW92ZWQsIHRoZW4gcmVzdG9yZSB0aGUgZWxlbWVudHNcclxuICAgICAgICAgICAgICAgIC8vIHNvIHRoYXQgdGhlIG5nUmVwZWF0J3MgY29tbWVudCBhcmUgY29ycmVjdC5cclxuICAgICAgICAgICAgICAgIGlmICgoISgnZHJvcGluZGV4JyBpbiB1aS5pdGVtLnNvcnRhYmxlKSB8fCB1aS5pdGVtLnNvcnRhYmxlLmlzQ2FuY2VsZWQoKSkgJiZcclxuICAgICAgICAgICAgICAgICAgICAhaGFzU29ydGluZ0hlbHBlcihlbGVtZW50LCB1aSkpIHtcclxuICAgICAgICAgICAgICAgICAgc2F2ZWROb2Rlcy5hcHBlbmRUbyhlbGVtZW50KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIC8vIEl0J3Mgbm93IHNhZmUgdG8gY2xlYXIgdGhlIHNhdmVkTm9kZXNcclxuICAgICAgICAgICAgICAvLyBzaW5jZSBzdG9wIGlzIHRoZSBsYXN0IGNhbGxiYWNrLlxyXG4gICAgICAgICAgICAgIHNhdmVkTm9kZXMgPSBudWxsO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgY2FsbGJhY2tzLnJlY2VpdmUgPSBmdW5jdGlvbihlLCB1aSkge1xyXG4gICAgICAgICAgICAgIC8vIEFuIGl0ZW0gd2FzIGRyb3BwZWQgaGVyZSBmcm9tIGFub3RoZXIgbGlzdCwgc2V0IGEgZmxhZyBvbiB0aGVcclxuICAgICAgICAgICAgICAvLyBpdGVtLlxyXG4gICAgICAgICAgICAgIHVpLml0ZW0uc29ydGFibGUucmVjZWl2ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgY2FsbGJhY2tzLnJlbW92ZSA9IGZ1bmN0aW9uKGUsIHVpKSB7XHJcbiAgICAgICAgICAgICAgLy8gV29ya2Fyb3VuZCBmb3IgYSBwcm9ibGVtIG9ic2VydmVkIGluIG5lc3RlZCBjb25uZWN0ZWQgbGlzdHMuXHJcbiAgICAgICAgICAgICAgLy8gVGhlcmUgc2hvdWxkIGJlIGFuICd1cGRhdGUnIGV2ZW50IGJlZm9yZSAncmVtb3ZlJyB3aGVuIG1vdmluZ1xyXG4gICAgICAgICAgICAgIC8vIGVsZW1lbnRzLiBJZiB0aGUgZXZlbnQgZGlkIG5vdCBmaXJlLCBjYW5jZWwgc29ydGluZy5cclxuICAgICAgICAgICAgICBpZiAoISgnZHJvcGluZGV4JyBpbiB1aS5pdGVtLnNvcnRhYmxlKSkge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5zb3J0YWJsZSgnY2FuY2VsJyk7XHJcbiAgICAgICAgICAgICAgICB1aS5pdGVtLnNvcnRhYmxlLmNhbmNlbCgpO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBpdGVtIGZyb20gdGhpcyBsaXN0J3MgbW9kZWwgYW5kIGNvcHkgZGF0YSBpbnRvIGl0ZW0sXHJcbiAgICAgICAgICAgICAgLy8gc28gdGhlIG5leHQgbGlzdCBjYW4gcmV0cml2ZSBpdFxyXG4gICAgICAgICAgICAgIGlmICghdWkuaXRlbS5zb3J0YWJsZS5pc0NhbmNlbGVkKCkpIHtcclxuICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgIHVpLml0ZW0uc29ydGFibGUubW92ZWQgPSBuZ01vZGVsLiRtb2RlbFZhbHVlLnNwbGljZShcclxuICAgICAgICAgICAgICAgICAgICB1aS5pdGVtLnNvcnRhYmxlLmluZGV4LCAxKVswXTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHdyYXBwZXJzLmhlbHBlciA9IGZ1bmN0aW9uIChpbm5lcikge1xyXG4gICAgICAgICAgICAgIGlmIChpbm5lciAmJiB0eXBlb2YgaW5uZXIgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZSwgaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICB2YXIgaW5uZXJSZXN1bHQgPSBpbm5lci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICAgICAgICBpdGVtLnNvcnRhYmxlLl9pc0N1c3RvbUhlbHBlclVzZWQgPSBpdGVtICE9PSBpbm5lclJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuIGlubmVyUmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGlubmVyO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgc2NvcGUuJHdhdGNoKCd1aVNvcnRhYmxlJywgZnVuY3Rpb24obmV3VmFsIC8qLCBvbGRWYWwqLykge1xyXG4gICAgICAgICAgICAgIC8vIGVuc3VyZSB0aGF0IHRoZSBqcXVlcnktdWktc29ydGFibGUgd2lkZ2V0IGluc3RhbmNlXHJcbiAgICAgICAgICAgICAgLy8gaXMgc3RpbGwgYm91bmQgdG8gdGhlIGRpcmVjdGl2ZSdzIGVsZW1lbnRcclxuICAgICAgICAgICAgICB2YXIgc29ydGFibGVXaWRnZXRJbnN0YW5jZSA9IGdldFNvcnRhYmxlV2lkZ2V0SW5zdGFuY2UoZWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgaWYgKCEhc29ydGFibGVXaWRnZXRJbnN0YW5jZSkge1xyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKG5ld1ZhbCwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAvLyBpZiBpdCdzIGEgY3VzdG9tIG9wdGlvbiBvZiB0aGUgZGlyZWN0aXZlLFxyXG4gICAgICAgICAgICAgICAgICAvLyBoYW5kbGUgaXQgYXBwcm9wcmlldGx5XHJcbiAgICAgICAgICAgICAgICAgIGlmIChrZXkgaW4gZGlyZWN0aXZlT3B0cykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChrZXkgPT09ICd1aS1mbG9hdGluZycgJiYgKHZhbHVlID09PSBmYWxzZSB8fCB2YWx1ZSA9PT0gdHJ1ZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIHNvcnRhYmxlV2lkZ2V0SW5zdGFuY2UuZmxvYXRpbmcgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIG9wdHNba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrc1trZXldKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIGtleSA9PT0gJ3N0b3AnICl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAvLyBjYWxsIGFwcGx5IGFmdGVyIHN0b3BcclxuICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gY29tYmluZUNhbGxiYWNrcyhcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUsIGZ1bmN0aW9uKCkgeyBzY29wZS4kYXBwbHkoKTsgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBjb21iaW5lQ2FsbGJhY2tzKHZhbHVlLCBhZnRlclN0b3ApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyB3cmFwIHRoZSBjYWxsYmFja1xyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gY29tYmluZUNhbGxiYWNrcyhjYWxsYmFja3Nba2V5XSwgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHdyYXBwZXJzW2tleV0pIHtcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHdyYXBwZXJzW2tleV0odmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICBvcHRzW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgZWxlbWVudC5zb3J0YWJsZSgnb3B0aW9uJywga2V5LCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIHRydWUpO1xyXG5cclxuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGNhbGxiYWNrcywgZnVuY3Rpb24odmFsdWUsIGtleSkge1xyXG4gICAgICAgICAgICAgIG9wdHNba2V5XSA9IGNvbWJpbmVDYWxsYmFja3ModmFsdWUsIG9wdHNba2V5XSk7XHJcbiAgICAgICAgICAgICAgaWYoIGtleSA9PT0gJ3N0b3AnICl7XHJcbiAgICAgICAgICAgICAgICBvcHRzW2tleV0gPSBjb21iaW5lQ2FsbGJhY2tzKG9wdHNba2V5XSwgYWZ0ZXJTdG9wKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICRsb2cuaW5mbygndWkuc29ydGFibGU6IG5nTW9kZWwgbm90IHByb3ZpZGVkIScsIGVsZW1lbnQpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC8vIENyZWF0ZSBzb3J0YWJsZVxyXG4gICAgICAgICAgZWxlbWVudC5zb3J0YWJsZShvcHRzKTtcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgXSk7XHJcbiIsInZhciBmYWJyaWM9ZmFicmljfHx7dmVyc2lvbjpcIjEuNS4wXCJ9O1widW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzJiYoZXhwb3J0cy5mYWJyaWM9ZmFicmljKSxcInVuZGVmaW5lZFwiIT10eXBlb2YgZG9jdW1lbnQmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiB3aW5kb3c/KGZhYnJpYy5kb2N1bWVudD1kb2N1bWVudCxmYWJyaWMud2luZG93PXdpbmRvdyx3aW5kb3cuZmFicmljPWZhYnJpYyk6KGZhYnJpYy5kb2N1bWVudD1yZXF1aXJlKFwianNkb21cIikuanNkb20oXCI8IURPQ1RZUEUgaHRtbD48aHRtbD48aGVhZD48L2hlYWQ+PGJvZHk+PC9ib2R5PjwvaHRtbD5cIiksZmFicmljLmRvY3VtZW50LmNyZWF0ZVdpbmRvdz9mYWJyaWMud2luZG93PWZhYnJpYy5kb2N1bWVudC5jcmVhdGVXaW5kb3coKTpmYWJyaWMud2luZG93PWZhYnJpYy5kb2N1bWVudC5wYXJlbnRXaW5kb3cpLGZhYnJpYy5pc1RvdWNoU3VwcG9ydGVkPVwib250b3VjaHN0YXJ0XCJpbiBmYWJyaWMuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LGZhYnJpYy5pc0xpa2VseU5vZGU9XCJ1bmRlZmluZWRcIiE9dHlwZW9mIEJ1ZmZlciYmXCJ1bmRlZmluZWRcIj09dHlwZW9mIHdpbmRvdyxmYWJyaWMuU0hBUkVEX0FUVFJJQlVURVM9W1wiZGlzcGxheVwiLFwidHJhbnNmb3JtXCIsXCJmaWxsXCIsXCJmaWxsLW9wYWNpdHlcIixcImZpbGwtcnVsZVwiLFwib3BhY2l0eVwiLFwic3Ryb2tlXCIsXCJzdHJva2UtZGFzaGFycmF5XCIsXCJzdHJva2UtbGluZWNhcFwiLFwic3Ryb2tlLWxpbmVqb2luXCIsXCJzdHJva2UtbWl0ZXJsaW1pdFwiLFwic3Ryb2tlLW9wYWNpdHlcIixcInN0cm9rZS13aWR0aFwiXSxmYWJyaWMuRFBJPTk2LGZhYnJpYy5yZU51bT1cIig/OlstK10/KD86XFxcXGQrfFxcXFxkKlxcXFwuXFxcXGQrKSg/OmVbLStdP1xcXFxkKyk/KVwiLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3RoaXMuX19ldmVudExpc3RlbmVyc1t0XSYmKGU/ZmFicmljLnV0aWwucmVtb3ZlRnJvbUFycmF5KHRoaXMuX19ldmVudExpc3RlbmVyc1t0XSxlKTp0aGlzLl9fZXZlbnRMaXN0ZW5lcnNbdF0ubGVuZ3RoPTApfWZ1bmN0aW9uIGUodCxlKXtpZih0aGlzLl9fZXZlbnRMaXN0ZW5lcnN8fCh0aGlzLl9fZXZlbnRMaXN0ZW5lcnM9e30pLDE9PT1hcmd1bWVudHMubGVuZ3RoKWZvcih2YXIgaSBpbiB0KXRoaXMub24oaSx0W2ldKTtlbHNlIHRoaXMuX19ldmVudExpc3RlbmVyc1t0XXx8KHRoaXMuX19ldmVudExpc3RlbmVyc1t0XT1bXSksdGhpcy5fX2V2ZW50TGlzdGVuZXJzW3RdLnB1c2goZSk7cmV0dXJuIHRoaXN9ZnVuY3Rpb24gaShlLGkpe2lmKHRoaXMuX19ldmVudExpc3RlbmVycyl7aWYoMD09PWFyZ3VtZW50cy5sZW5ndGgpdGhpcy5fX2V2ZW50TGlzdGVuZXJzPXt9O2Vsc2UgaWYoMT09PWFyZ3VtZW50cy5sZW5ndGgmJlwib2JqZWN0XCI9PXR5cGVvZiBhcmd1bWVudHNbMF0pZm9yKHZhciByIGluIGUpdC5jYWxsKHRoaXMscixlW3JdKTtlbHNlIHQuY2FsbCh0aGlzLGUsaSk7cmV0dXJuIHRoaXN9fWZ1bmN0aW9uIHIodCxlKXtpZih0aGlzLl9fZXZlbnRMaXN0ZW5lcnMpe3ZhciBpPXRoaXMuX19ldmVudExpc3RlbmVyc1t0XTtpZihpKXtmb3IodmFyIHI9MCxzPWkubGVuZ3RoO3M+cjtyKyspaVtyXS5jYWxsKHRoaXMsZXx8e30pO3JldHVybiB0aGlzfX19ZmFicmljLk9ic2VydmFibGU9e29ic2VydmU6ZSxzdG9wT2JzZXJ2aW5nOmksZmlyZTpyLG9uOmUsb2ZmOmksdHJpZ2dlcjpyfX0oKSxmYWJyaWMuQ29sbGVjdGlvbj17YWRkOmZ1bmN0aW9uKCl7dGhpcy5fb2JqZWN0cy5wdXNoLmFwcGx5KHRoaXMuX29iamVjdHMsYXJndW1lbnRzKTtmb3IodmFyIHQ9MCxlPWFyZ3VtZW50cy5sZW5ndGg7ZT50O3QrKyl0aGlzLl9vbk9iamVjdEFkZGVkKGFyZ3VtZW50c1t0XSk7cmV0dXJuIHRoaXMucmVuZGVyT25BZGRSZW1vdmUmJnRoaXMucmVuZGVyQWxsKCksdGhpc30saW5zZXJ0QXQ6ZnVuY3Rpb24odCxlLGkpe3ZhciByPXRoaXMuZ2V0T2JqZWN0cygpO3JldHVybiBpP3JbZV09dDpyLnNwbGljZShlLDAsdCksdGhpcy5fb25PYmplY3RBZGRlZCh0KSx0aGlzLnJlbmRlck9uQWRkUmVtb3ZlJiZ0aGlzLnJlbmRlckFsbCgpLHRoaXN9LHJlbW92ZTpmdW5jdGlvbigpe2Zvcih2YXIgdCxlPXRoaXMuZ2V0T2JqZWN0cygpLGk9MCxyPWFyZ3VtZW50cy5sZW5ndGg7cj5pO2krKyl0PWUuaW5kZXhPZihhcmd1bWVudHNbaV0pLC0xIT09dCYmKGUuc3BsaWNlKHQsMSksdGhpcy5fb25PYmplY3RSZW1vdmVkKGFyZ3VtZW50c1tpXSkpO3JldHVybiB0aGlzLnJlbmRlck9uQWRkUmVtb3ZlJiZ0aGlzLnJlbmRlckFsbCgpLHRoaXN9LGZvckVhY2hPYmplY3Q6ZnVuY3Rpb24odCxlKXtmb3IodmFyIGk9dGhpcy5nZXRPYmplY3RzKCkscj1pLmxlbmd0aDtyLS07KXQuY2FsbChlLGlbcl0scixpKTtyZXR1cm4gdGhpc30sZ2V0T2JqZWN0czpmdW5jdGlvbih0KXtyZXR1cm5cInVuZGVmaW5lZFwiPT10eXBlb2YgdD90aGlzLl9vYmplY3RzOnRoaXMuX29iamVjdHMuZmlsdGVyKGZ1bmN0aW9uKGUpe3JldHVybiBlLnR5cGU9PT10fSl9LGl0ZW06ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZ2V0T2JqZWN0cygpW3RdfSxpc0VtcHR5OmZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLmdldE9iamVjdHMoKS5sZW5ndGh9LHNpemU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRPYmplY3RzKCkubGVuZ3RofSxjb250YWluczpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5nZXRPYmplY3RzKCkuaW5kZXhPZih0KT4tMX0sY29tcGxleGl0eTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldE9iamVjdHMoKS5yZWR1Y2UoZnVuY3Rpb24odCxlKXtyZXR1cm4gdCs9ZS5jb21wbGV4aXR5P2UuY29tcGxleGl0eSgpOjB9LDApfX0sZnVuY3Rpb24odCl7dmFyIGU9TWF0aC5zcXJ0LGk9TWF0aC5hdGFuMixyPU1hdGguUEkvMTgwO2ZhYnJpYy51dGlsPXtyZW1vdmVGcm9tQXJyYXk6ZnVuY3Rpb24odCxlKXt2YXIgaT10LmluZGV4T2YoZSk7cmV0dXJuLTEhPT1pJiZ0LnNwbGljZShpLDEpLHR9LGdldFJhbmRvbUludDpmdW5jdGlvbih0LGUpe3JldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqKGUtdCsxKSkrdH0sZGVncmVlc1RvUmFkaWFuczpmdW5jdGlvbih0KXtyZXR1cm4gdCpyfSxyYWRpYW5zVG9EZWdyZWVzOmZ1bmN0aW9uKHQpe3JldHVybiB0L3J9LHJvdGF0ZVBvaW50OmZ1bmN0aW9uKHQsZSxpKXt2YXIgcj1NYXRoLnNpbihpKSxzPU1hdGguY29zKGkpO3Quc3VidHJhY3RFcXVhbHMoZSk7dmFyIG49dC54KnMtdC55KnIsbz10Lngqcit0LnkqcztyZXR1cm4gbmV3IGZhYnJpYy5Qb2ludChuLG8pLmFkZEVxdWFscyhlKX0sdHJhbnNmb3JtUG9pbnQ6ZnVuY3Rpb24odCxlLGkpe3JldHVybiBpP25ldyBmYWJyaWMuUG9pbnQoZVswXSp0LngrZVsyXSp0LnksZVsxXSp0LngrZVszXSp0LnkpOm5ldyBmYWJyaWMuUG9pbnQoZVswXSp0LngrZVsyXSp0LnkrZVs0XSxlWzFdKnQueCtlWzNdKnQueStlWzVdKX0saW52ZXJ0VHJhbnNmb3JtOmZ1bmN0aW9uKHQpe3ZhciBlPXQuc2xpY2UoKSxpPTEvKHRbMF0qdFszXS10WzFdKnRbMl0pO2U9W2kqdFszXSwtaSp0WzFdLC1pKnRbMl0saSp0WzBdLDAsMF07dmFyIHI9ZmFicmljLnV0aWwudHJhbnNmb3JtUG9pbnQoe3g6dFs0XSx5OnRbNV19LGUpO3JldHVybiBlWzRdPS1yLngsZVs1XT0tci55LGV9LHRvRml4ZWQ6ZnVuY3Rpb24odCxlKXtyZXR1cm4gcGFyc2VGbG9hdChOdW1iZXIodCkudG9GaXhlZChlKSl9LHBhcnNlVW5pdDpmdW5jdGlvbih0LGUpe3ZhciBpPS9cXER7MCwyfSQvLmV4ZWModCkscj1wYXJzZUZsb2F0KHQpO3N3aXRjaChlfHwoZT1mYWJyaWMuVGV4dC5ERUZBVUxUX1NWR19GT05UX1NJWkUpLGlbMF0pe2Nhc2VcIm1tXCI6cmV0dXJuIHIqZmFicmljLkRQSS8yNS40O2Nhc2VcImNtXCI6cmV0dXJuIHIqZmFicmljLkRQSS8yLjU0O2Nhc2VcImluXCI6cmV0dXJuIHIqZmFicmljLkRQSTtjYXNlXCJwdFwiOnJldHVybiByKmZhYnJpYy5EUEkvNzI7Y2FzZVwicGNcIjpyZXR1cm4gcipmYWJyaWMuRFBJLzcyKjEyO2Nhc2VcImVtXCI6cmV0dXJuIHIqZTtkZWZhdWx0OnJldHVybiByfX0sZmFsc2VGdW5jdGlvbjpmdW5jdGlvbigpe3JldHVybiExfSxnZXRLbGFzczpmdW5jdGlvbih0LGUpe3JldHVybiB0PWZhYnJpYy51dGlsLnN0cmluZy5jYW1lbGl6ZSh0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK3Quc2xpY2UoMSkpLGZhYnJpYy51dGlsLnJlc29sdmVOYW1lc3BhY2UoZSlbdF19LHJlc29sdmVOYW1lc3BhY2U6ZnVuY3Rpb24oZSl7aWYoIWUpcmV0dXJuIGZhYnJpYztmb3IodmFyIGk9ZS5zcGxpdChcIi5cIikscj1pLmxlbmd0aCxzPXR8fGZhYnJpYy53aW5kb3csbj0wO3I+bjsrK24pcz1zW2lbbl1dO3JldHVybiBzfSxsb2FkSW1hZ2U6ZnVuY3Rpb24odCxlLGkscil7aWYoIXQpcmV0dXJuIHZvaWQoZSYmZS5jYWxsKGksdCkpO3ZhciBzPWZhYnJpYy51dGlsLmNyZWF0ZUltYWdlKCk7cy5vbmxvYWQ9ZnVuY3Rpb24oKXtlJiZlLmNhbGwoaSxzKSxzPXMub25sb2FkPXMub25lcnJvcj1udWxsfSxzLm9uZXJyb3I9ZnVuY3Rpb24oKXtmYWJyaWMubG9nKFwiRXJyb3IgbG9hZGluZyBcIitzLnNyYyksZSYmZS5jYWxsKGksbnVsbCwhMCkscz1zLm9ubG9hZD1zLm9uZXJyb3I9bnVsbH0sMCE9PXQuaW5kZXhPZihcImRhdGFcIikmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiByJiYocy5jcm9zc09yaWdpbj1yKSxzLnNyYz10fSxlbmxpdmVuT2JqZWN0czpmdW5jdGlvbih0LGUsaSxyKXtmdW5jdGlvbiBzKCl7KytvPT09YSYmZSYmZShuKX10PXR8fFtdO3ZhciBuPVtdLG89MCxhPXQubGVuZ3RoO3JldHVybiBhP3ZvaWQgdC5mb3JFYWNoKGZ1bmN0aW9uKHQsZSl7aWYoIXR8fCF0LnR5cGUpcmV0dXJuIHZvaWQgcygpO3ZhciBvPWZhYnJpYy51dGlsLmdldEtsYXNzKHQudHlwZSxpKTtvLmFzeW5jP28uZnJvbU9iamVjdCh0LGZ1bmN0aW9uKGksbyl7b3x8KG5bZV09aSxyJiZyKHQsbltlXSkpLHMoKX0pOihuW2VdPW8uZnJvbU9iamVjdCh0KSxyJiZyKHQsbltlXSkscygpKX0pOnZvaWQoZSYmZShuKSl9LGdyb3VwU1ZHRWxlbWVudHM6ZnVuY3Rpb24odCxlLGkpe3ZhciByO3JldHVybiByPW5ldyBmYWJyaWMuUGF0aEdyb3VwKHQsZSksXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGkmJnIuc2V0U291cmNlUGF0aChpKSxyfSxwb3B1bGF0ZVdpdGhQcm9wZXJ0aWVzOmZ1bmN0aW9uKHQsZSxpKXtpZihpJiZcIltvYmplY3QgQXJyYXldXCI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaSkpZm9yKHZhciByPTAscz1pLmxlbmd0aDtzPnI7cisrKWlbcl1pbiB0JiYoZVtpW3JdXT10W2lbcl1dKX0sZHJhd0Rhc2hlZExpbmU6ZnVuY3Rpb24odCxyLHMsbixvLGEpe3ZhciBoPW4tcixjPW8tcyxsPWUoaCpoK2MqYyksdT1pKGMsaCksZj1hLmxlbmd0aCxkPTAsZz0hMDtmb3IodC5zYXZlKCksdC50cmFuc2xhdGUocixzKSx0Lm1vdmVUbygwLDApLHQucm90YXRlKHUpLHI9MDtsPnI7KXIrPWFbZCsrJWZdLHI+bCYmKHI9bCksdFtnP1wibGluZVRvXCI6XCJtb3ZlVG9cIl0ociwwKSxnPSFnO3QucmVzdG9yZSgpfSxjcmVhdGVDYW52YXNFbGVtZW50OmZ1bmN0aW9uKHQpe3JldHVybiB0fHwodD1mYWJyaWMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKSksdC5nZXRDb250ZXh0fHxcInVuZGVmaW5lZFwiPT10eXBlb2YgR192bWxDYW52YXNNYW5hZ2VyfHxHX3ZtbENhbnZhc01hbmFnZXIuaW5pdEVsZW1lbnQodCksdH0sY3JlYXRlSW1hZ2U6ZnVuY3Rpb24oKXtyZXR1cm4gZmFicmljLmlzTGlrZWx5Tm9kZT9uZXcocmVxdWlyZShcImNhbnZhc1wiKS5JbWFnZSk6ZmFicmljLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbWdcIil9LGNyZWF0ZUFjY2Vzc29yczpmdW5jdGlvbih0KXtmb3IodmFyIGU9dC5wcm90b3R5cGUsaT1lLnN0YXRlUHJvcGVydGllcy5sZW5ndGg7aS0tOyl7dmFyIHI9ZS5zdGF0ZVByb3BlcnRpZXNbaV0scz1yLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK3Iuc2xpY2UoMSksbj1cInNldFwiK3Msbz1cImdldFwiK3M7ZVtvXXx8KGVbb109ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBGdW5jdGlvbigncmV0dXJuIHRoaXMuZ2V0KFwiJyt0KydcIiknKX0ocikpLGVbbl18fChlW25dPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgRnVuY3Rpb24oXCJ2YWx1ZVwiLCdyZXR1cm4gdGhpcy5zZXQoXCInK3QrJ1wiLCB2YWx1ZSknKX0ocikpfX0sY2xpcENvbnRleHQ6ZnVuY3Rpb24odCxlKXtlLnNhdmUoKSxlLmJlZ2luUGF0aCgpLHQuY2xpcFRvKGUpLGUuY2xpcCgpfSxtdWx0aXBseVRyYW5zZm9ybU1hdHJpY2VzOmZ1bmN0aW9uKHQsZSl7cmV0dXJuW3RbMF0qZVswXSt0WzJdKmVbMV0sdFsxXSplWzBdK3RbM10qZVsxXSx0WzBdKmVbMl0rdFsyXSplWzNdLHRbMV0qZVsyXSt0WzNdKmVbM10sdFswXSplWzRdK3RbMl0qZVs1XSt0WzRdLHRbMV0qZVs0XSt0WzNdKmVbNV0rdFs1XV19LGdldEZ1bmN0aW9uQm9keTpmdW5jdGlvbih0KXtyZXR1cm4oU3RyaW5nKHQpLm1hdGNoKC9mdW5jdGlvbltee10qXFx7KFtcXHNcXFNdKilcXH0vKXx8e30pWzFdfSxpc1RyYW5zcGFyZW50OmZ1bmN0aW9uKHQsZSxpLHIpe3I+MCYmKGU+cj9lLT1yOmU9MCxpPnI/aS09cjppPTApO2Zvcih2YXIgcz0hMCxuPXQuZ2V0SW1hZ2VEYXRhKGUsaSwyKnJ8fDEsMipyfHwxKSxvPTMsYT1uLmRhdGEubGVuZ3RoO2E+bztvKz00KXt2YXIgaD1uLmRhdGFbb107aWYocz0wPj1oLHM9PT0hMSlicmVha31yZXR1cm4gbj1udWxsLHN9fX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxyLG4sbyxoLGMsbCl7dmFyIHU9YS5jYWxsKGFyZ3VtZW50cyk7aWYoc1t1XSlyZXR1cm4gc1t1XTt2YXIgZj1NYXRoLlBJLGQ9bCpmLzE4MCxnPU1hdGguc2luKGQpLHA9TWF0aC5jb3MoZCksdj0wLGI9MDtuPU1hdGguYWJzKG4pLG89TWF0aC5hYnMobyk7dmFyIG09LXAqdCouNS1nKnIqLjUseT0tcCpyKi41K2cqdCouNSxfPW4qbix4PW8qbyxDPXkqeSxTPW0qbSx3PV8qeC1fKkMteCpTLE89MDtpZigwPncpe3ZhciBUPU1hdGguc3FydCgxLXcvKF8qeCkpO24qPVQsbyo9VH1lbHNlIE89KGg9PT1jPy0xOjEpKk1hdGguc3FydCh3LyhfKkMreCpTKSk7dmFyIGs9TypuKnkvbyxqPS1PKm8qbS9uLEE9cCprLWcqaisuNSp0LFA9ZyprK3AqaisuNSpyLEU9aSgxLDAsKG0taykvbiwoeS1qKS9vKSxNPWkoKG0taykvbiwoeS1qKS9vLCgtbS1rKS9uLCgteS1qKS9vKTswPT09YyYmTT4wP00tPTIqZjoxPT09YyYmMD5NJiYoTSs9MipmKTtmb3IodmFyIEk9TWF0aC5jZWlsKE1hdGguYWJzKE0vZioyKSksRD1bXSxMPU0vSSxGPTgvMypNYXRoLnNpbihMLzQpKk1hdGguc2luKEwvNCkvTWF0aC5zaW4oTC8yKSxSPUUrTCxCPTA7ST5CO0IrKylEW0JdPWUoRSxSLHAsZyxuLG8sQSxQLEYsdixiKSx2PURbQl1bNF0sYj1EW0JdWzVdLEU9UixSKz1MO3JldHVybiBzW3VdPUQsRH1mdW5jdGlvbiBlKHQsZSxpLHIscyxvLGgsYyxsLHUsZil7dmFyIGQ9YS5jYWxsKGFyZ3VtZW50cyk7aWYobltkXSlyZXR1cm4gbltkXTt2YXIgZz1NYXRoLmNvcyh0KSxwPU1hdGguc2luKHQpLHY9TWF0aC5jb3MoZSksYj1NYXRoLnNpbihlKSxtPWkqcyp2LXIqbypiK2gseT1yKnMqditpKm8qYitjLF89dStsKigtaSpzKnAtcipvKmcpLHg9ZitsKigtcipzKnAraSpvKmcpLEM9bStsKihpKnMqYityKm8qdiksUz15K2wqKHIqcypiLWkqbyp2KTtyZXR1cm4gbltkXT1bXyx4LEMsUyxtLHldLG5bZF19ZnVuY3Rpb24gaSh0LGUsaSxyKXt2YXIgcz1NYXRoLmF0YW4yKGUsdCksbj1NYXRoLmF0YW4yKHIsaSk7cmV0dXJuIG4+PXM/bi1zOjIqTWF0aC5QSS0ocy1uKX1mdW5jdGlvbiByKHQsZSxpLHIscyxuLGgsYyl7dmFyIGw9YS5jYWxsKGFyZ3VtZW50cyk7aWYob1tsXSlyZXR1cm4gb1tsXTt2YXIgdSxmLGQsZyxwLHYsYixtLHk9TWF0aC5zcXJ0LF89TWF0aC5taW4seD1NYXRoLm1heCxDPU1hdGguYWJzLFM9W10sdz1bW10sW11dO2Y9Nip0LTEyKmkrNipzLHU9LTMqdCs5KmktOSpzKzMqaCxkPTMqaS0zKnQ7Zm9yKHZhciBPPTA7Mj5POysrTylpZihPPjAmJihmPTYqZS0xMipyKzYqbix1PS0zKmUrOSpyLTkqbiszKmMsZD0zKnItMyplKSxDKHUpPDFlLTEyKXtpZihDKGYpPDFlLTEyKWNvbnRpbnVlO2c9LWQvZixnPjAmJjE+ZyYmUy5wdXNoKGcpfWVsc2UgYj1mKmYtNCpkKnUsMD5ifHwobT15KGIpLHA9KC1mK20pLygyKnUpLHA+MCYmMT5wJiZTLnB1c2gocCksdj0oLWYtbSkvKDIqdSksdj4wJiYxPnYmJlMucHVzaCh2KSk7Zm9yKHZhciBULGssaixBPVMubGVuZ3RoLFA9QTtBLS07KWc9U1tBXSxqPTEtZyxUPWoqaipqKnQrMypqKmoqZyppKzMqaipnKmcqcytnKmcqZypoLHdbMF1bQV09VCxrPWoqaipqKmUrMypqKmoqZypyKzMqaipnKmcqbitnKmcqZypjLHdbMV1bQV09azt3WzBdW1BdPXQsd1sxXVtQXT1lLHdbMF1bUCsxXT1oLHdbMV1bUCsxXT1jO3ZhciBFPVt7eDpfLmFwcGx5KG51bGwsd1swXSkseTpfLmFwcGx5KG51bGwsd1sxXSl9LHt4OnguYXBwbHkobnVsbCx3WzBdKSx5OnguYXBwbHkobnVsbCx3WzFdKX1dO3JldHVybiBvW2xdPUUsRX12YXIgcz17fSxuPXt9LG89e30sYT1BcnJheS5wcm90b3R5cGUuam9pbjtmYWJyaWMudXRpbC5kcmF3QXJjPWZ1bmN0aW9uKGUsaSxyLHMpe2Zvcih2YXIgbj1zWzBdLG89c1sxXSxhPXNbMl0saD1zWzNdLGM9c1s0XSxsPXNbNV0sdT1zWzZdLGY9W1tdLFtdLFtdLFtdXSxkPXQobC1pLHUtcixuLG8saCxjLGEpLGc9MCxwPWQubGVuZ3RoO3A+ZztnKyspZltnXVswXT1kW2ddWzBdK2ksZltnXVsxXT1kW2ddWzFdK3IsZltnXVsyXT1kW2ddWzJdK2ksZltnXVszXT1kW2ddWzNdK3IsZltnXVs0XT1kW2ddWzRdK2ksZltnXVs1XT1kW2ddWzVdK3IsZS5iZXppZXJDdXJ2ZVRvLmFwcGx5KGUsZltnXSl9LGZhYnJpYy51dGlsLmdldEJvdW5kc09mQXJjPWZ1bmN0aW9uKGUsaSxzLG4sbyxhLGgsYyxsKXtmb3IodmFyIHU9MCxmPTAsZD1bXSxnPVtdLHA9dChjLWUsbC1pLHMsbixhLGgsbyksdj1bW10sW11dLGI9MCxtPXAubGVuZ3RoO20+YjtiKyspZD1yKHUsZixwW2JdWzBdLHBbYl1bMV0scFtiXVsyXSxwW2JdWzNdLHBbYl1bNF0scFtiXVs1XSksdlswXS54PWRbMF0ueCtlLHZbMF0ueT1kWzBdLnkraSx2WzFdLng9ZFsxXS54K2UsdlsxXS55PWRbMV0ueStpLGcucHVzaCh2WzBdKSxnLnB1c2godlsxXSksdT1wW2JdWzRdLGY9cFtiXVs1XTtyZXR1cm4gZ30sZmFicmljLnV0aWwuZ2V0Qm91bmRzT2ZDdXJ2ZT1yfSgpLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe2Zvcih2YXIgaT1zLmNhbGwoYXJndW1lbnRzLDIpLHI9W10sbj0wLG89dC5sZW5ndGg7bz5uO24rKylyW25dPWkubGVuZ3RoP3Rbbl1bZV0uYXBwbHkodFtuXSxpKTp0W25dW2VdLmNhbGwodFtuXSk7cmV0dXJuIHJ9ZnVuY3Rpb24gZSh0LGUpe3JldHVybiByKHQsZSxmdW5jdGlvbih0LGUpe3JldHVybiB0Pj1lfSl9ZnVuY3Rpb24gaSh0LGUpe3JldHVybiByKHQsZSxmdW5jdGlvbih0LGUpe3JldHVybiBlPnR9KX1mdW5jdGlvbiByKHQsZSxpKXtpZih0JiYwIT09dC5sZW5ndGgpe3ZhciByPXQubGVuZ3RoLTEscz1lP3Rbcl1bZV06dFtyXTtpZihlKWZvcig7ci0tOylpKHRbcl1bZV0scykmJihzPXRbcl1bZV0pO2Vsc2UgZm9yKDtyLS07KWkodFtyXSxzKSYmKHM9dFtyXSk7cmV0dXJuIHN9fXZhciBzPUFycmF5LnByb3RvdHlwZS5zbGljZTtBcnJheS5wcm90b3R5cGUuaW5kZXhPZnx8KEFycmF5LnByb3RvdHlwZS5pbmRleE9mPWZ1bmN0aW9uKHQpe2lmKHZvaWQgMD09PXRoaXN8fG51bGw9PT10aGlzKXRocm93IG5ldyBUeXBlRXJyb3I7dmFyIGU9T2JqZWN0KHRoaXMpLGk9ZS5sZW5ndGg+Pj4wO2lmKDA9PT1pKXJldHVybi0xO3ZhciByPTA7aWYoYXJndW1lbnRzLmxlbmd0aD4wJiYocj1OdW1iZXIoYXJndW1lbnRzWzFdKSxyIT09cj9yPTA6MCE9PXImJnIhPT1OdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkmJnIhPT1OdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFkmJihyPShyPjB8fC0xKSpNYXRoLmZsb29yKE1hdGguYWJzKHIpKSkpLHI+PWkpcmV0dXJuLTE7Zm9yKHZhciBzPXI+PTA/cjpNYXRoLm1heChpLU1hdGguYWJzKHIpLDApO2k+cztzKyspaWYocyBpbiBlJiZlW3NdPT09dClyZXR1cm4gcztyZXR1cm4tMX0pLEFycmF5LnByb3RvdHlwZS5mb3JFYWNofHwoQXJyYXkucHJvdG90eXBlLmZvckVhY2g9ZnVuY3Rpb24odCxlKXtmb3IodmFyIGk9MCxyPXRoaXMubGVuZ3RoPj4+MDtyPmk7aSsrKWkgaW4gdGhpcyYmdC5jYWxsKGUsdGhpc1tpXSxpLHRoaXMpfSksQXJyYXkucHJvdG90eXBlLm1hcHx8KEFycmF5LnByb3RvdHlwZS5tYXA9ZnVuY3Rpb24odCxlKXtmb3IodmFyIGk9W10scj0wLHM9dGhpcy5sZW5ndGg+Pj4wO3M+cjtyKyspciBpbiB0aGlzJiYoaVtyXT10LmNhbGwoZSx0aGlzW3JdLHIsdGhpcykpO3JldHVybiBpfSksQXJyYXkucHJvdG90eXBlLmV2ZXJ5fHwoQXJyYXkucHJvdG90eXBlLmV2ZXJ5PWZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpPTAscj10aGlzLmxlbmd0aD4+PjA7cj5pO2krKylpZihpIGluIHRoaXMmJiF0LmNhbGwoZSx0aGlzW2ldLGksdGhpcykpcmV0dXJuITE7cmV0dXJuITB9KSxBcnJheS5wcm90b3R5cGUuc29tZXx8KEFycmF5LnByb3RvdHlwZS5zb21lPWZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpPTAscj10aGlzLmxlbmd0aD4+PjA7cj5pO2krKylpZihpIGluIHRoaXMmJnQuY2FsbChlLHRoaXNbaV0saSx0aGlzKSlyZXR1cm4hMDtyZXR1cm4hMX0pLEFycmF5LnByb3RvdHlwZS5maWx0ZXJ8fChBcnJheS5wcm90b3R5cGUuZmlsdGVyPWZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpLHI9W10scz0wLG49dGhpcy5sZW5ndGg+Pj4wO24+cztzKyspcyBpbiB0aGlzJiYoaT10aGlzW3NdLHQuY2FsbChlLGkscyx0aGlzKSYmci5wdXNoKGkpKTtyZXR1cm4gcn0pLEFycmF5LnByb3RvdHlwZS5yZWR1Y2V8fChBcnJheS5wcm90b3R5cGUucmVkdWNlPWZ1bmN0aW9uKHQpe3ZhciBlLGk9dGhpcy5sZW5ndGg+Pj4wLHI9MDtpZihhcmd1bWVudHMubGVuZ3RoPjEpZT1hcmd1bWVudHNbMV07ZWxzZSBmb3IoOzspe2lmKHIgaW4gdGhpcyl7ZT10aGlzW3IrK107YnJlYWt9aWYoKytyPj1pKXRocm93IG5ldyBUeXBlRXJyb3J9Zm9yKDtpPnI7cisrKXIgaW4gdGhpcyYmKGU9dC5jYWxsKG51bGwsZSx0aGlzW3JdLHIsdGhpcykpO3JldHVybiBlfSksZmFicmljLnV0aWwuYXJyYXk9e2ludm9rZTp0LG1pbjppLG1heDplfX0oKSxmdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxlKXtmb3IodmFyIGkgaW4gZSl0W2ldPWVbaV07cmV0dXJuIHR9ZnVuY3Rpb24gZShlKXtyZXR1cm4gdCh7fSxlKX1mYWJyaWMudXRpbC5vYmplY3Q9e2V4dGVuZDp0LGNsb25lOmV9fSgpLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXtyZXR1cm4gdC5yZXBsYWNlKC8tKyguKT8vZyxmdW5jdGlvbih0LGUpe3JldHVybiBlP2UudG9VcHBlckNhc2UoKTpcIlwifSl9ZnVuY3Rpb24gZSh0LGUpe3JldHVybiB0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpKyhlP3Quc2xpY2UoMSk6dC5zbGljZSgxKS50b0xvd2VyQ2FzZSgpKX1mdW5jdGlvbiBpKHQpe3JldHVybiB0LnJlcGxhY2UoLyYvZyxcIiZhbXA7XCIpLnJlcGxhY2UoL1wiL2csXCImcXVvdDtcIikucmVwbGFjZSgvJy9nLFwiJmFwb3M7XCIpLnJlcGxhY2UoLzwvZyxcIiZsdDtcIikucmVwbGFjZSgvPi9nLFwiJmd0O1wiKX1TdHJpbmcucHJvdG90eXBlLnRyaW18fChTdHJpbmcucHJvdG90eXBlLnRyaW09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXBsYWNlKC9eW1xcc1xceEEwXSsvLFwiXCIpLnJlcGxhY2UoL1tcXHNcXHhBMF0rJC8sXCJcIil9KSxmYWJyaWMudXRpbC5zdHJpbmc9e2NhbWVsaXplOnQsY2FwaXRhbGl6ZTplLGVzY2FwZVhtbDppfX0oKSxmdW5jdGlvbigpe3ZhciB0PUFycmF5LnByb3RvdHlwZS5zbGljZSxlPUZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseSxpPWZ1bmN0aW9uKCl7fTtGdW5jdGlvbi5wcm90b3R5cGUuYmluZHx8KEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kPWZ1bmN0aW9uKHIpe3ZhciBzLG49dGhpcyxvPXQuY2FsbChhcmd1bWVudHMsMSk7cmV0dXJuIHM9by5sZW5ndGg/ZnVuY3Rpb24oKXtyZXR1cm4gZS5jYWxsKG4sdGhpcyBpbnN0YW5jZW9mIGk/dGhpczpyLG8uY29uY2F0KHQuY2FsbChhcmd1bWVudHMpKSl9OmZ1bmN0aW9uKCl7cmV0dXJuIGUuY2FsbChuLHRoaXMgaW5zdGFuY2VvZiBpP3RoaXM6cixhcmd1bWVudHMpfSxpLnByb3RvdHlwZT10aGlzLnByb3RvdHlwZSxzLnByb3RvdHlwZT1uZXcgaSxzfSl9KCksZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7fWZ1bmN0aW9uIGUodCl7dmFyIGU9dGhpcy5jb25zdHJ1Y3Rvci5zdXBlcmNsYXNzLnByb3RvdHlwZVt0XTtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD4xP2UuYXBwbHkodGhpcyxyLmNhbGwoYXJndW1lbnRzLDEpKTplLmNhbGwodGhpcyl9ZnVuY3Rpb24gaSgpe2Z1bmN0aW9uIGkoKXt0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpfXZhciBuPW51bGwsYT1yLmNhbGwoYXJndW1lbnRzLDApO1wiZnVuY3Rpb25cIj09dHlwZW9mIGFbMF0mJihuPWEuc2hpZnQoKSksaS5zdXBlcmNsYXNzPW4saS5zdWJjbGFzc2VzPVtdLG4mJih0LnByb3RvdHlwZT1uLnByb3RvdHlwZSxpLnByb3RvdHlwZT1uZXcgdCxuLnN1YmNsYXNzZXMucHVzaChpKSk7Zm9yKHZhciBoPTAsYz1hLmxlbmd0aDtjPmg7aCsrKW8oaSxhW2hdLG4pO3JldHVybiBpLnByb3RvdHlwZS5pbml0aWFsaXplfHwoaS5wcm90b3R5cGUuaW5pdGlhbGl6ZT1zKSxpLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1pLGkucHJvdG90eXBlLmNhbGxTdXBlcj1lLGl9dmFyIHI9QXJyYXkucHJvdG90eXBlLnNsaWNlLHM9ZnVuY3Rpb24oKXt9LG49ZnVuY3Rpb24oKXtmb3IodmFyIHQgaW57dG9TdHJpbmc6MX0paWYoXCJ0b1N0cmluZ1wiPT09dClyZXR1cm4hMTtyZXR1cm4hMH0oKSxvPWZ1bmN0aW9uKHQsZSxpKXtmb3IodmFyIHIgaW4gZSlyIGluIHQucHJvdG90eXBlJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiB0LnByb3RvdHlwZVtyXSYmKGVbcl0rXCJcIikuaW5kZXhPZihcImNhbGxTdXBlclwiKT4tMT90LnByb3RvdHlwZVtyXT1mdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgcj10aGlzLmNvbnN0cnVjdG9yLnN1cGVyY2xhc3M7dGhpcy5jb25zdHJ1Y3Rvci5zdXBlcmNsYXNzPWk7dmFyIHM9ZVt0XS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIHRoaXMuY29uc3RydWN0b3Iuc3VwZXJjbGFzcz1yLFwiaW5pdGlhbGl6ZVwiIT09dD9zOnZvaWQgMH19KHIpOnQucHJvdG90eXBlW3JdPWVbcl0sbiYmKGUudG9TdHJpbmchPT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nJiYodC5wcm90b3R5cGUudG9TdHJpbmc9ZS50b1N0cmluZyksZS52YWx1ZU9mIT09T2JqZWN0LnByb3RvdHlwZS52YWx1ZU9mJiYodC5wcm90b3R5cGUudmFsdWVPZj1lLnZhbHVlT2YpKX07ZmFicmljLnV0aWwuY3JlYXRlQ2xhc3M9aX0oKSxmdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dmFyIGUsaSxyPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSxzPXIubGVuZ3RoO2ZvcihpPTA7cz5pO2krKylpZihlPXR5cGVvZiB0W3JbaV1dLCEvXig/OmZ1bmN0aW9ufG9iamVjdHx1bmtub3duKSQvLnRlc3QoZSkpcmV0dXJuITE7cmV0dXJuITB9ZnVuY3Rpb24gZSh0LGUpe3JldHVybntoYW5kbGVyOmUsd3JhcHBlZEhhbmRsZXI6aSh0LGUpfX1mdW5jdGlvbiBpKHQsZSl7cmV0dXJuIGZ1bmN0aW9uKGkpe2UuY2FsbChvKHQpLGl8fGZhYnJpYy53aW5kb3cuZXZlbnQpfX1mdW5jdGlvbiByKHQsZSl7cmV0dXJuIGZ1bmN0aW9uKGkpe2lmKHBbdF0mJnBbdF1bZV0pZm9yKHZhciByPXBbdF1bZV0scz0wLG49ci5sZW5ndGg7bj5zO3MrKylyW3NdLmNhbGwodGhpcyxpfHxmYWJyaWMud2luZG93LmV2ZW50KX19ZnVuY3Rpb24gcyh0LGUpe3R8fCh0PWZhYnJpYy53aW5kb3cuZXZlbnQpO3ZhciBpPXQudGFyZ2V0fHwodHlwZW9mIHQuc3JjRWxlbWVudCE9PWg/dC5zcmNFbGVtZW50Om51bGwpLHI9ZmFicmljLnV0aWwuZ2V0U2Nyb2xsTGVmdFRvcChpLGUpO3JldHVybnt4OnYodCkrci5sZWZ0LHk6Yih0KStyLnRvcH19ZnVuY3Rpb24gbih0LGUsaSl7dmFyIHI9XCJ0b3VjaGVuZFwiPT09dC50eXBlP1wiY2hhbmdlZFRvdWNoZXNcIjpcInRvdWNoZXNcIjtyZXR1cm4gdFtyXSYmdFtyXVswXT90W3JdWzBdW2VdLSh0W3JdWzBdW2VdLXRbcl1bMF1baV0pfHx0W2ldOnRbaV19dmFyIG8sYSxoPVwidW5rbm93blwiLGM9ZnVuY3Rpb24oKXt2YXIgdD0wO3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gZS5fX3VuaXF1ZUlEfHwoZS5fX3VuaXF1ZUlEPVwidW5pcXVlSURfX1wiK3QrKyl9fSgpOyFmdW5jdGlvbigpe3ZhciB0PXt9O289ZnVuY3Rpb24oZSl7cmV0dXJuIHRbZV19LGE9ZnVuY3Rpb24oZSxpKXt0W2VdPWl9fSgpO3ZhciBsLHUsZj10KGZhYnJpYy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsXCJhZGRFdmVudExpc3RlbmVyXCIsXCJyZW1vdmVFdmVudExpc3RlbmVyXCIpJiZ0KGZhYnJpYy53aW5kb3csXCJhZGRFdmVudExpc3RlbmVyXCIsXCJyZW1vdmVFdmVudExpc3RlbmVyXCIpLGQ9dChmYWJyaWMuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LFwiYXR0YWNoRXZlbnRcIixcImRldGFjaEV2ZW50XCIpJiZ0KGZhYnJpYy53aW5kb3csXCJhdHRhY2hFdmVudFwiLFwiZGV0YWNoRXZlbnRcIiksZz17fSxwPXt9O2Y/KGw9ZnVuY3Rpb24odCxlLGkpe3QuYWRkRXZlbnRMaXN0ZW5lcihlLGksITEpfSx1PWZ1bmN0aW9uKHQsZSxpKXt0LnJlbW92ZUV2ZW50TGlzdGVuZXIoZSxpLCExKX0pOmQ/KGw9ZnVuY3Rpb24odCxpLHIpe3ZhciBzPWModCk7YShzLHQpLGdbc118fChnW3NdPXt9KSxnW3NdW2ldfHwoZ1tzXVtpXT1bXSk7dmFyIG49ZShzLHIpO2dbc11baV0ucHVzaChuKSx0LmF0dGFjaEV2ZW50KFwib25cIitpLG4ud3JhcHBlZEhhbmRsZXIpfSx1PWZ1bmN0aW9uKHQsZSxpKXt2YXIgcixzPWModCk7aWYoZ1tzXSYmZ1tzXVtlXSlmb3IodmFyIG49MCxvPWdbc11bZV0ubGVuZ3RoO28+bjtuKyspcj1nW3NdW2VdW25dLHImJnIuaGFuZGxlcj09PWkmJih0LmRldGFjaEV2ZW50KFwib25cIitlLHIud3JhcHBlZEhhbmRsZXIpLGdbc11bZV1bbl09bnVsbCl9KToobD1mdW5jdGlvbih0LGUsaSl7dmFyIHM9Yyh0KTtpZihwW3NdfHwocFtzXT17fSksIXBbc11bZV0pe3Bbc11bZV09W107dmFyIG49dFtcIm9uXCIrZV07biYmcFtzXVtlXS5wdXNoKG4pLHRbXCJvblwiK2VdPXIocyxlKX1wW3NdW2VdLnB1c2goaSl9LHU9ZnVuY3Rpb24odCxlLGkpe3ZhciByPWModCk7aWYocFtyXSYmcFtyXVtlXSlmb3IodmFyIHM9cFtyXVtlXSxuPTAsbz1zLmxlbmd0aDtvPm47bisrKXNbbl09PT1pJiZzLnNwbGljZShuLDEpfSksZmFicmljLnV0aWwuYWRkTGlzdGVuZXI9bCxmYWJyaWMudXRpbC5yZW1vdmVMaXN0ZW5lcj11O3ZhciB2PWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdC5jbGllbnRYIT09aD90LmNsaWVudFg6MH0sYj1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQuY2xpZW50WSE9PWg/dC5jbGllbnRZOjB9O2ZhYnJpYy5pc1RvdWNoU3VwcG9ydGVkJiYodj1mdW5jdGlvbih0KXtyZXR1cm4gbih0LFwicGFnZVhcIixcImNsaWVudFhcIil9LGI9ZnVuY3Rpb24odCl7cmV0dXJuIG4odCxcInBhZ2VZXCIsXCJjbGllbnRZXCIpfSksZmFicmljLnV0aWwuZ2V0UG9pbnRlcj1zLGZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQoZmFicmljLnV0aWwsZmFicmljLk9ic2VydmFibGUpfSgpLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3ZhciBpPXQuc3R5bGU7aWYoIWkpcmV0dXJuIHQ7aWYoXCJzdHJpbmdcIj09dHlwZW9mIGUpcmV0dXJuIHQuc3R5bGUuY3NzVGV4dCs9XCI7XCIrZSxlLmluZGV4T2YoXCJvcGFjaXR5XCIpPi0xP24odCxlLm1hdGNoKC9vcGFjaXR5OlxccyooXFxkP1xcLj9cXGQqKS8pWzFdKTp0O2Zvcih2YXIgciBpbiBlKWlmKFwib3BhY2l0eVwiPT09ciluKHQsZVtyXSk7ZWxzZXt2YXIgcz1cImZsb2F0XCI9PT1yfHxcImNzc0Zsb2F0XCI9PT1yP1widW5kZWZpbmVkXCI9PXR5cGVvZiBpLnN0eWxlRmxvYXQ/XCJjc3NGbG9hdFwiOlwic3R5bGVGbG9hdFwiOnI7aVtzXT1lW3JdfXJldHVybiB0fXZhciBlPWZhYnJpYy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLGk9XCJzdHJpbmdcIj09dHlwZW9mIGUuc3R5bGUub3BhY2l0eSxyPVwic3RyaW5nXCI9PXR5cGVvZiBlLnN0eWxlLmZpbHRlcixzPS9hbHBoYVxccypcXChcXHMqb3BhY2l0eVxccyo9XFxzKihbXlxcKV0rKVxcKS8sbj1mdW5jdGlvbih0KXtyZXR1cm4gdH07aT9uPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQuc3R5bGUub3BhY2l0eT1lLHR9OnImJihuPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dC5zdHlsZTtyZXR1cm4gdC5jdXJyZW50U3R5bGUmJiF0LmN1cnJlbnRTdHlsZS5oYXNMYXlvdXQmJihpLnpvb209MSkscy50ZXN0KGkuZmlsdGVyKT8oZT1lPj0uOTk5OT9cIlwiOlwiYWxwaGEob3BhY2l0eT1cIisxMDAqZStcIilcIixpLmZpbHRlcj1pLmZpbHRlci5yZXBsYWNlKHMsZSkpOmkuZmlsdGVyKz1cIiBhbHBoYShvcGFjaXR5PVwiKzEwMCplK1wiKVwiLHR9KSxmYWJyaWMudXRpbC5zZXRTdHlsZT10fSgpLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXtyZXR1cm5cInN0cmluZ1wiPT10eXBlb2YgdD9mYWJyaWMuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodCk6dH1mdW5jdGlvbiBlKHQsZSl7dmFyIGk9ZmFicmljLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodCk7Zm9yKHZhciByIGluIGUpXCJjbGFzc1wiPT09cj9pLmNsYXNzTmFtZT1lW3JdOlwiZm9yXCI9PT1yP2kuaHRtbEZvcj1lW3JdOmkuc2V0QXR0cmlidXRlKHIsZVtyXSk7cmV0dXJuIGl9ZnVuY3Rpb24gaSh0LGUpe3QmJi0xPT09KFwiIFwiK3QuY2xhc3NOYW1lK1wiIFwiKS5pbmRleE9mKFwiIFwiK2UrXCIgXCIpJiYodC5jbGFzc05hbWUrPSh0LmNsYXNzTmFtZT9cIiBcIjpcIlwiKStlKX1mdW5jdGlvbiByKHQsaSxyKXtyZXR1cm5cInN0cmluZ1wiPT10eXBlb2YgaSYmKGk9ZShpLHIpKSx0LnBhcmVudE5vZGUmJnQucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQoaSx0KSxpLmFwcGVuZENoaWxkKHQpLGl9ZnVuY3Rpb24gcyh0LGUpe3ZhciBpLHIscz0wLG49MCxvPWZhYnJpYy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsYT1mYWJyaWMuZG9jdW1lbnQuYm9keXx8e3Njcm9sbExlZnQ6MCxzY3JvbGxUb3A6MH07Zm9yKHI9dDt0JiZ0LnBhcmVudE5vZGUmJiFpOyl0PXQucGFyZW50Tm9kZSwxPT09dC5ub2RlVHlwZSYmXCJmaXhlZFwiPT09ZmFicmljLnV0aWwuZ2V0RWxlbWVudFN0eWxlKHQsXCJwb3NpdGlvblwiKSYmKGk9dCksMT09PXQubm9kZVR5cGUmJnIhPT1lJiZcImFic29sdXRlXCI9PT1mYWJyaWMudXRpbC5nZXRFbGVtZW50U3R5bGUodCxcInBvc2l0aW9uXCIpPyhzPTAsbj0wKTp0PT09ZmFicmljLmRvY3VtZW50PyhzPWEuc2Nyb2xsTGVmdHx8by5zY3JvbGxMZWZ0fHwwLG49YS5zY3JvbGxUb3B8fG8uc2Nyb2xsVG9wfHwwKToocys9dC5zY3JvbGxMZWZ0fHwwLG4rPXQuc2Nyb2xsVG9wfHwwKTtyZXR1cm57bGVmdDpzLHRvcDpufX1mdW5jdGlvbiBuKHQpe3ZhciBlLGkscj10JiZ0Lm93bmVyRG9jdW1lbnQscz17bGVmdDowLHRvcDowfSxuPXtsZWZ0OjAsdG9wOjB9LG89e2JvcmRlckxlZnRXaWR0aDpcImxlZnRcIixib3JkZXJUb3BXaWR0aDpcInRvcFwiLHBhZGRpbmdMZWZ0OlwibGVmdFwiLHBhZGRpbmdUb3A6XCJ0b3BcIn07aWYoIXIpcmV0dXJue2xlZnQ6MCx0b3A6MH07Zm9yKHZhciBhIGluIG8pbltvW2FdXSs9cGFyc2VJbnQobCh0LGEpLDEwKXx8MDtyZXR1cm4gZT1yLmRvY3VtZW50RWxlbWVudCxcInVuZGVmaW5lZFwiIT10eXBlb2YgdC5nZXRCb3VuZGluZ0NsaWVudFJlY3QmJihzPXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkpLGk9ZmFicmljLnV0aWwuZ2V0U2Nyb2xsTGVmdFRvcCh0LG51bGwpLHtsZWZ0OnMubGVmdCtpLmxlZnQtKGUuY2xpZW50TGVmdHx8MCkrbi5sZWZ0LHRvcDpzLnRvcCtpLnRvcC0oZS5jbGllbnRUb3B8fDApK24udG9wfX12YXIgbyxhPUFycmF5LnByb3RvdHlwZS5zbGljZSxoPWZ1bmN0aW9uKHQpe3JldHVybiBhLmNhbGwodCwwKX07dHJ5e289aChmYWJyaWMuZG9jdW1lbnQuY2hpbGROb2RlcylpbnN0YW5jZW9mIEFycmF5fWNhdGNoKGMpe31vfHwoaD1mdW5jdGlvbih0KXtmb3IodmFyIGU9bmV3IEFycmF5KHQubGVuZ3RoKSxpPXQubGVuZ3RoO2ktLTspZVtpXT10W2ldO3JldHVybiBlfSk7dmFyIGw7bD1mYWJyaWMuZG9jdW1lbnQuZGVmYXVsdFZpZXcmJmZhYnJpYy5kb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlP2Z1bmN0aW9uKHQsZSl7dmFyIGk9ZmFicmljLmRvY3VtZW50LmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUodCxudWxsKTtyZXR1cm4gaT9pW2VdOnZvaWQgMH06ZnVuY3Rpb24odCxlKXt2YXIgaT10LnN0eWxlW2VdO3JldHVybiFpJiZ0LmN1cnJlbnRTdHlsZSYmKGk9dC5jdXJyZW50U3R5bGVbZV0pLGl9LGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXtyZXR1cm5cInVuZGVmaW5lZFwiIT10eXBlb2YgdC5vbnNlbGVjdHN0YXJ0JiYodC5vbnNlbGVjdHN0YXJ0PWZhYnJpYy51dGlsLmZhbHNlRnVuY3Rpb24pLHI/dC5zdHlsZVtyXT1cIm5vbmVcIjpcInN0cmluZ1wiPT10eXBlb2YgdC51bnNlbGVjdGFibGUmJih0LnVuc2VsZWN0YWJsZT1cIm9uXCIpLHR9ZnVuY3Rpb24gZSh0KXtyZXR1cm5cInVuZGVmaW5lZFwiIT10eXBlb2YgdC5vbnNlbGVjdHN0YXJ0JiYodC5vbnNlbGVjdHN0YXJ0PW51bGwpLHI/dC5zdHlsZVtyXT1cIlwiOlwic3RyaW5nXCI9PXR5cGVvZiB0LnVuc2VsZWN0YWJsZSYmKHQudW5zZWxlY3RhYmxlPVwiXCIpLHR9dmFyIGk9ZmFicmljLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZSxyPVwidXNlclNlbGVjdFwiaW4gaT9cInVzZXJTZWxlY3RcIjpcIk1velVzZXJTZWxlY3RcImluIGk/XCJNb3pVc2VyU2VsZWN0XCI6XCJXZWJraXRVc2VyU2VsZWN0XCJpbiBpP1wiV2Via2l0VXNlclNlbGVjdFwiOlwiS2h0bWxVc2VyU2VsZWN0XCJpbiBpP1wiS2h0bWxVc2VyU2VsZWN0XCI6XCJcIjtmYWJyaWMudXRpbC5tYWtlRWxlbWVudFVuc2VsZWN0YWJsZT10LGZhYnJpYy51dGlsLm1ha2VFbGVtZW50U2VsZWN0YWJsZT1lfSgpLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3ZhciBpPWZhYnJpYy5kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImhlYWRcIilbMF0scj1mYWJyaWMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKSxzPSEwO3Iub25sb2FkPXIub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKHQpe2lmKHMpe2lmKFwic3RyaW5nXCI9PXR5cGVvZiB0aGlzLnJlYWR5U3RhdGUmJlwibG9hZGVkXCIhPT10aGlzLnJlYWR5U3RhdGUmJlwiY29tcGxldGVcIiE9PXRoaXMucmVhZHlTdGF0ZSlyZXR1cm47cz0hMSxlKHR8fGZhYnJpYy53aW5kb3cuZXZlbnQpLHI9ci5vbmxvYWQ9ci5vbnJlYWR5c3RhdGVjaGFuZ2U9bnVsbH19LHIuc3JjPXQsaS5hcHBlbmRDaGlsZChyKX1mYWJyaWMudXRpbC5nZXRTY3JpcHQ9dH0oKSxmYWJyaWMudXRpbC5nZXRCeUlkPXQsZmFicmljLnV0aWwudG9BcnJheT1oLGZhYnJpYy51dGlsLm1ha2VFbGVtZW50PWUsZmFicmljLnV0aWwuYWRkQ2xhc3M9aSxmYWJyaWMudXRpbC53cmFwRWxlbWVudD1yLGZhYnJpYy51dGlsLmdldFNjcm9sbExlZnRUb3A9cyxmYWJyaWMudXRpbC5nZXRFbGVtZW50T2Zmc2V0PW4sZmFicmljLnV0aWwuZ2V0RWxlbWVudFN0eWxlPWx9KCksZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSl7cmV0dXJuIHQrKC9cXD8vLnRlc3QodCk/XCImXCI6XCI/XCIpK2V9ZnVuY3Rpb24gZSgpe31mdW5jdGlvbiBpKGkscyl7c3x8KHM9e30pO3ZhciBuLG89cy5tZXRob2Q/cy5tZXRob2QudG9VcHBlckNhc2UoKTpcIkdFVFwiLGE9cy5vbkNvbXBsZXRlfHxmdW5jdGlvbigpe30saD1yKCk7cmV0dXJuIGgub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7ND09PWgucmVhZHlTdGF0ZSYmKGEoaCksaC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZSl9LFwiR0VUXCI9PT1vJiYobj1udWxsLFwic3RyaW5nXCI9PXR5cGVvZiBzLnBhcmFtZXRlcnMmJihpPXQoaSxzLnBhcmFtZXRlcnMpKSksaC5vcGVuKG8saSwhMCksKFwiUE9TVFwiPT09b3x8XCJQVVRcIj09PW8pJiZoLnNldFJlcXVlc3RIZWFkZXIoXCJDb250ZW50LVR5cGVcIixcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiKSxoLnNlbmQobiksaH12YXIgcj1mdW5jdGlvbigpe2Zvcih2YXIgdD1bZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoXCJNaWNyb3NvZnQuWE1MSFRUUFwiKX0sZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoXCJNc3htbDIuWE1MSFRUUFwiKX0sZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoXCJNc3htbDIuWE1MSFRUUC4zLjBcIil9LGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBYTUxIdHRwUmVxdWVzdH1dLGU9dC5sZW5ndGg7ZS0tOyl0cnl7dmFyIGk9dFtlXSgpO2lmKGkpcmV0dXJuIHRbZV19Y2F0Y2gocil7fX0oKTtmYWJyaWMudXRpbC5yZXF1ZXN0PWl9KCksZmFicmljLmxvZz1mdW5jdGlvbigpe30sZmFicmljLndhcm49ZnVuY3Rpb24oKXt9LFwidW5kZWZpbmVkXCIhPXR5cGVvZiBjb25zb2xlJiZbXCJsb2dcIixcIndhcm5cIl0uZm9yRWFjaChmdW5jdGlvbih0KXtcInVuZGVmaW5lZFwiIT10eXBlb2YgY29uc29sZVt0XSYmXCJmdW5jdGlvblwiPT10eXBlb2YgY29uc29sZVt0XS5hcHBseSYmKGZhYnJpY1t0XT1mdW5jdGlvbigpe3JldHVybiBjb25zb2xlW3RdLmFwcGx5KGNvbnNvbGUsYXJndW1lbnRzKX0pfSksZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQpe2UoZnVuY3Rpb24oaSl7dHx8KHQ9e30pO3ZhciByLHM9aXx8K25ldyBEYXRlLG49dC5kdXJhdGlvbnx8NTAwLG89cytuLGE9dC5vbkNoYW5nZXx8ZnVuY3Rpb24oKXt9LGg9dC5hYm9ydHx8ZnVuY3Rpb24oKXtyZXR1cm4hMX0sYz10LmVhc2luZ3x8ZnVuY3Rpb24odCxlLGkscil7cmV0dXJuLWkqTWF0aC5jb3ModC9yKihNYXRoLlBJLzIpKStpK2V9LGw9XCJzdGFydFZhbHVlXCJpbiB0P3Quc3RhcnRWYWx1ZTowLHU9XCJlbmRWYWx1ZVwiaW4gdD90LmVuZFZhbHVlOjEwMCxmPXQuYnlWYWx1ZXx8dS1sO3Qub25TdGFydCYmdC5vblN0YXJ0KCksZnVuY3Rpb24gZChpKXtyPWl8fCtuZXcgRGF0ZTt2YXIgdT1yPm8/bjpyLXM7cmV0dXJuIGgoKT92b2lkKHQub25Db21wbGV0ZSYmdC5vbkNvbXBsZXRlKCkpOihhKGModSxsLGYsbikpLHI+bz92b2lkKHQub25Db21wbGV0ZSYmdC5vbkNvbXBsZXRlKCkpOnZvaWQgZShkKSl9KHMpfSl9ZnVuY3Rpb24gZSgpe3JldHVybiBpLmFwcGx5KGZhYnJpYy53aW5kb3csYXJndW1lbnRzKX12YXIgaT1mYWJyaWMud2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZXx8ZmFicmljLndpbmRvdy53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGZhYnJpYy53aW5kb3cubW96UmVxdWVzdEFuaW1hdGlvbkZyYW1lfHxmYWJyaWMud2luZG93Lm9SZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGZhYnJpYy53aW5kb3cubXNSZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGZ1bmN0aW9uKHQpe2ZhYnJpYy53aW5kb3cuc2V0VGltZW91dCh0LDFlMy82MCl9O2ZhYnJpYy51dGlsLmFuaW1hdGU9dCxmYWJyaWMudXRpbC5yZXF1ZXN0QW5pbUZyYW1lPWV9KCksZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSxpLHIpe3JldHVybiB0PE1hdGguYWJzKGUpPyh0PWUscj1pLzQpOnI9aS8oMipNYXRoLlBJKSpNYXRoLmFzaW4oZS90KSx7YTp0LGM6ZSxwOmksczpyfX1mdW5jdGlvbiBlKHQsZSxpKXtyZXR1cm4gdC5hKk1hdGgucG93KDIsMTAqKGUtPTEpKSpNYXRoLnNpbigyKihlKmktdC5zKSpNYXRoLlBJL3QucCl9ZnVuY3Rpb24gaSh0LGUsaSxyKXtyZXR1cm4gaSooKHQ9dC9yLTEpKnQqdCsxKStlfWZ1bmN0aW9uIHIodCxlLGkscil7cmV0dXJuIHQvPXIvMiwxPnQ/aS8yKnQqdCp0K2U6aS8yKigodC09MikqdCp0KzIpK2V9ZnVuY3Rpb24gcyh0LGUsaSxyKXtyZXR1cm4gaSoodC89cikqdCp0KnQrZX1mdW5jdGlvbiBuKHQsZSxpLHIpe3JldHVybi1pKigodD10L3ItMSkqdCp0KnQtMSkrZX1mdW5jdGlvbiBvKHQsZSxpLHIpe3JldHVybiB0Lz1yLzIsMT50P2kvMip0KnQqdCp0K2U6LWkvMiooKHQtPTIpKnQqdCp0LTIpK2V9ZnVuY3Rpb24gYSh0LGUsaSxyKXtyZXR1cm4gaSoodC89cikqdCp0KnQqdCtlfWZ1bmN0aW9uIGgodCxlLGkscil7cmV0dXJuIGkqKCh0PXQvci0xKSp0KnQqdCp0KzEpK2V9ZnVuY3Rpb24gYyh0LGUsaSxyKXtyZXR1cm4gdC89ci8yLDE+dD9pLzIqdCp0KnQqdCp0K2U6aS8yKigodC09MikqdCp0KnQqdCsyKStlfWZ1bmN0aW9uIGwodCxlLGkscil7cmV0dXJuLWkqTWF0aC5jb3ModC9yKihNYXRoLlBJLzIpKStpK2V9ZnVuY3Rpb24gdSh0LGUsaSxyKXtyZXR1cm4gaSpNYXRoLnNpbih0L3IqKE1hdGguUEkvMikpK2V9ZnVuY3Rpb24gZih0LGUsaSxyKXtyZXR1cm4taS8yKihNYXRoLmNvcyhNYXRoLlBJKnQvciktMSkrZX1mdW5jdGlvbiBkKHQsZSxpLHIpe3JldHVybiAwPT09dD9lOmkqTWF0aC5wb3coMiwxMCoodC9yLTEpKStlfWZ1bmN0aW9uIGcodCxlLGkscil7cmV0dXJuIHQ9PT1yP2UraTppKigtTWF0aC5wb3coMiwtMTAqdC9yKSsxKStlfWZ1bmN0aW9uIHAodCxlLGkscil7cmV0dXJuIDA9PT10P2U6dD09PXI/ZStpOih0Lz1yLzIsMT50P2kvMipNYXRoLnBvdygyLDEwKih0LTEpKStlOmkvMiooLU1hdGgucG93KDIsLTEwKi0tdCkrMikrZSl9ZnVuY3Rpb24gdih0LGUsaSxyKXtyZXR1cm4taSooTWF0aC5zcXJ0KDEtKHQvPXIpKnQpLTEpK2V9ZnVuY3Rpb24gYih0LGUsaSxyKXtyZXR1cm4gaSpNYXRoLnNxcnQoMS0odD10L3ItMSkqdCkrZX1mdW5jdGlvbiBtKHQsZSxpLHIpe3JldHVybiB0Lz1yLzIsMT50Py1pLzIqKE1hdGguc3FydCgxLXQqdCktMSkrZTppLzIqKE1hdGguc3FydCgxLSh0LT0yKSp0KSsxKStlfWZ1bmN0aW9uIHkoaSxyLHMsbil7dmFyIG89MS43MDE1OCxhPTAsaD1zO2lmKDA9PT1pKXJldHVybiByO2lmKGkvPW4sMT09PWkpcmV0dXJuIHIrczthfHwoYT0uMypuKTt2YXIgYz10KGgscyxhLG8pO3JldHVybi1lKGMsaSxuKStyfWZ1bmN0aW9uIF8oZSxpLHIscyl7dmFyIG49MS43MDE1OCxvPTAsYT1yO2lmKDA9PT1lKXJldHVybiBpO2lmKGUvPXMsMT09PWUpcmV0dXJuIGkrcjtvfHwobz0uMypzKTt2YXIgaD10KGEscixvLG4pO3JldHVybiBoLmEqTWF0aC5wb3coMiwtMTAqZSkqTWF0aC5zaW4oMiooZSpzLWgucykqTWF0aC5QSS9oLnApK2guYytpfWZ1bmN0aW9uIHgoaSxyLHMsbil7dmFyIG89MS43MDE1OCxhPTAsaD1zO2lmKDA9PT1pKXJldHVybiByO2lmKGkvPW4vMiwyPT09aSlyZXR1cm4gcitzO2F8fChhPS4zKm4qMS41KTt2YXIgYz10KGgscyxhLG8pO3JldHVybiAxPmk/LS41KmUoYyxpLG4pK3I6Yy5hKk1hdGgucG93KDIsLTEwKihpLT0xKSkqTWF0aC5zaW4oMiooaSpuLWMucykqTWF0aC5QSS9jLnApKi41K2MuYytyfWZ1bmN0aW9uIEModCxlLGkscixzKXtyZXR1cm4gdm9pZCAwPT09cyYmKHM9MS43MDE1OCksaSoodC89cikqdCooKHMrMSkqdC1zKStlfWZ1bmN0aW9uIFModCxlLGkscixzKXtyZXR1cm4gdm9pZCAwPT09cyYmKHM9MS43MDE1OCksaSooKHQ9dC9yLTEpKnQqKChzKzEpKnQrcykrMSkrZX1mdW5jdGlvbiB3KHQsZSxpLHIscyl7cmV0dXJuIHZvaWQgMD09PXMmJihzPTEuNzAxNTgpLHQvPXIvMiwxPnQ/aS8yKnQqdCooKChzKj0xLjUyNSkrMSkqdC1zKStlOmkvMiooKHQtPTIpKnQqKCgocyo9MS41MjUpKzEpKnQrcykrMikrZX1mdW5jdGlvbiBPKHQsZSxpLHIpe3JldHVybiBpLVQoci10LDAsaSxyKStlfWZ1bmN0aW9uIFQodCxlLGkscil7cmV0dXJuKHQvPXIpPDEvMi43NT83LjU2MjUqaSp0KnQrZToyLzIuNzU+dD9pKig3LjU2MjUqKHQtPTEuNS8yLjc1KSp0Ky43NSkrZToyLjUvMi43NT50P2kqKDcuNTYyNSoodC09Mi4yNS8yLjc1KSp0Ky45Mzc1KStlOmkqKDcuNTYyNSoodC09Mi42MjUvMi43NSkqdCsuOTg0Mzc1KStlfWZ1bmN0aW9uIGsodCxlLGkscil7cmV0dXJuIHIvMj50Py41Kk8oMip0LDAsaSxyKStlOi41KlQoMip0LXIsMCxpLHIpKy41KmkrZX1mYWJyaWMudXRpbC5lYXNlPXtlYXNlSW5RdWFkOmZ1bmN0aW9uKHQsZSxpLHIpe3JldHVybiBpKih0Lz1yKSp0K2V9LGVhc2VPdXRRdWFkOmZ1bmN0aW9uKHQsZSxpLHIpe3JldHVybi1pKih0Lz1yKSoodC0yKStlfSxlYXNlSW5PdXRRdWFkOmZ1bmN0aW9uKHQsZSxpLHIpe3JldHVybiB0Lz1yLzIsMT50P2kvMip0KnQrZTotaS8yKigtLXQqKHQtMiktMSkrZX0sZWFzZUluQ3ViaWM6ZnVuY3Rpb24odCxlLGkscil7cmV0dXJuIGkqKHQvPXIpKnQqdCtlfSxlYXNlT3V0Q3ViaWM6aSxlYXNlSW5PdXRDdWJpYzpyLGVhc2VJblF1YXJ0OnMsZWFzZU91dFF1YXJ0Om4sZWFzZUluT3V0UXVhcnQ6byxlYXNlSW5RdWludDphLGVhc2VPdXRRdWludDpoLGVhc2VJbk91dFF1aW50OmMsZWFzZUluU2luZTpsLGVhc2VPdXRTaW5lOnUsZWFzZUluT3V0U2luZTpmLGVhc2VJbkV4cG86ZCxlYXNlT3V0RXhwbzpnLGVhc2VJbk91dEV4cG86cCxlYXNlSW5DaXJjOnYsZWFzZU91dENpcmM6YixlYXNlSW5PdXRDaXJjOm0sZWFzZUluRWxhc3RpYzp5LGVhc2VPdXRFbGFzdGljOl8sZWFzZUluT3V0RWxhc3RpYzp4LGVhc2VJbkJhY2s6QyxlYXNlT3V0QmFjazpTLGVhc2VJbk91dEJhY2s6dyxlYXNlSW5Cb3VuY2U6TyxlYXNlT3V0Qm91bmNlOlQsZWFzZUluT3V0Qm91bmNlOmt9fSgpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGUodCl7cmV0dXJuIHQgaW4gQz9DW3RdOnR9ZnVuY3Rpb24gaSh0LGUsaSxyKXt2YXIgcyxuPVwiW29iamVjdCBBcnJheV1cIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlKTtyZXR1cm5cImZpbGxcIiE9PXQmJlwic3Ryb2tlXCIhPT10fHxcIm5vbmVcIiE9PWU/XCJzdHJva2VEYXNoQXJyYXlcIj09PXQ/ZT1lLnJlcGxhY2UoLywvZyxcIiBcIikuc3BsaXQoL1xccysvKS5tYXAoZnVuY3Rpb24odCl7cmV0dXJuIHBhcnNlRmxvYXQodCl9KTpcInRyYW5zZm9ybU1hdHJpeFwiPT09dD9lPWkmJmkudHJhbnNmb3JtTWF0cml4P3goaS50cmFuc2Zvcm1NYXRyaXgscC5wYXJzZVRyYW5zZm9ybUF0dHJpYnV0ZShlKSk6cC5wYXJzZVRyYW5zZm9ybUF0dHJpYnV0ZShlKTpcInZpc2libGVcIj09PXQ/KGU9XCJub25lXCI9PT1lfHxcImhpZGRlblwiPT09ZT8hMTohMCxpJiZpLnZpc2libGU9PT0hMSYmKGU9ITEpKTpcIm9yaWdpblhcIj09PXQ/ZT1cInN0YXJ0XCI9PT1lP1wibGVmdFwiOlwiZW5kXCI9PT1lP1wicmlnaHRcIjpcImNlbnRlclwiOnM9bj9lLm1hcChfKTpfKGUscik6ZT1cIlwiLCFuJiZpc05hTihzKT9lOnN9ZnVuY3Rpb24gcih0KXtmb3IodmFyIGUgaW4gUylpZih0W2VdJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgdFtTW2VdXSYmMCE9PXRbZV0uaW5kZXhPZihcInVybChcIikpe3ZhciBpPW5ldyBwLkNvbG9yKHRbZV0pO3RbZV09aS5zZXRBbHBoYSh5KGkuZ2V0QWxwaGEoKSp0W1NbZV1dLDIpKS50b1JnYmEoKX1yZXR1cm4gdH1mdW5jdGlvbiBzKHQscil7dmFyIHMsbjt0LnJlcGxhY2UoLzskLyxcIlwiKS5zcGxpdChcIjtcIikuZm9yRWFjaChmdW5jdGlvbih0KXt2YXIgbz10LnNwbGl0KFwiOlwiKTtzPWUob1swXS50cmltKCkudG9Mb3dlckNhc2UoKSksbj1pKHMsb1sxXS50cmltKCkpLHJbc109bn0pfWZ1bmN0aW9uIG4odCxyKXt2YXIgcyxuO2Zvcih2YXIgbyBpbiB0KVwidW5kZWZpbmVkXCIhPXR5cGVvZiB0W29dJiYocz1lKG8udG9Mb3dlckNhc2UoKSksbj1pKHMsdFtvXSkscltzXT1uKX1mdW5jdGlvbiBvKHQsZSl7dmFyIGk9e307Zm9yKHZhciByIGluIHAuY3NzUnVsZXNbZV0paWYoYSh0LHIuc3BsaXQoXCIgXCIpKSlmb3IodmFyIHMgaW4gcC5jc3NSdWxlc1tlXVtyXSlpW3NdPXAuY3NzUnVsZXNbZV1bcl1bc107cmV0dXJuIGl9ZnVuY3Rpb24gYSh0LGUpe3ZhciBpLHI9ITA7cmV0dXJuIGk9Yyh0LGUucG9wKCkpLGkmJmUubGVuZ3RoJiYocj1oKHQsZSkpLGkmJnImJjA9PT1lLmxlbmd0aH1mdW5jdGlvbiBoKHQsZSl7Zm9yKHZhciBpLHI9ITA7dC5wYXJlbnROb2RlJiYxPT09dC5wYXJlbnROb2RlLm5vZGVUeXBlJiZlLmxlbmd0aDspciYmKGk9ZS5wb3AoKSksdD10LnBhcmVudE5vZGUscj1jKHQsaSk7cmV0dXJuIDA9PT1lLmxlbmd0aH1mdW5jdGlvbiBjKHQsZSl7dmFyIGkscj10Lm5vZGVOYW1lLHM9dC5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKSxuPXQuZ2V0QXR0cmlidXRlKFwiaWRcIik7aWYoaT1uZXcgUmVnRXhwKFwiXlwiK3IsXCJpXCIpLGU9ZS5yZXBsYWNlKGksXCJcIiksbiYmZS5sZW5ndGgmJihpPW5ldyBSZWdFeHAoXCIjXCIrbitcIig/IVthLXpBLVpcXFxcLV0rKVwiLFwiaVwiKSxlPWUucmVwbGFjZShpLFwiXCIpKSxzJiZlLmxlbmd0aCl7cz1zLnNwbGl0KFwiIFwiKTtmb3IodmFyIG89cy5sZW5ndGg7by0tOylpPW5ldyBSZWdFeHAoXCJcXFxcLlwiK3Nbb10rXCIoPyFbYS16QS1aXFxcXC1dKylcIixcImlcIiksZT1lLnJlcGxhY2UoaSxcIlwiKX1yZXR1cm4gMD09PWUubGVuZ3RofWZ1bmN0aW9uIGwodCxlKXt2YXIgaTtpZih0LmdldEVsZW1lbnRCeUlkJiYoaT10LmdldEVsZW1lbnRCeUlkKGUpKSxpKXJldHVybiBpO3ZhciByLHMsbixvPXQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCIqXCIpO2ZvcihzPTA7czxvLmxlbmd0aDtzKyspaWYocj1vW3NdLG49PT1yLmdldEF0dHJpYnV0ZShcImlkXCIpKXJldHVybiByfWZ1bmN0aW9uIHUodCl7Zm9yKHZhciBlPXQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ1c2VcIiksaT0wO2UubGVuZ3RoJiZpPGUubGVuZ3RoOyl7Zm9yKHZhciByLHM9ZVtpXSxuPXMuZ2V0QXR0cmlidXRlKFwieGxpbms6aHJlZlwiKS5zdWJzdHIoMSksbz1zLmdldEF0dHJpYnV0ZShcInhcIil8fDAsYT1zLmdldEF0dHJpYnV0ZShcInlcIil8fDAsaD1sKHQsbikuY2xvbmVOb2RlKCEwKSxjPShoLmdldEF0dHJpYnV0ZShcInRyYW5zZm9ybVwiKXx8XCJcIikrXCIgdHJhbnNsYXRlKFwiK28rXCIsIFwiK2ErXCIpXCIsdT1lLmxlbmd0aCxmPTAsZD1zLmF0dHJpYnV0ZXMsZz1kLmxlbmd0aDtnPmY7ZisrKXt2YXIgcD1kLml0ZW0oZik7XCJ4XCIhPT1wLm5vZGVOYW1lJiZcInlcIiE9PXAubm9kZU5hbWUmJlwieGxpbms6aHJlZlwiIT09cC5ub2RlTmFtZSYmKFwidHJhbnNmb3JtXCI9PT1wLm5vZGVOYW1lP2M9cC5ub2RlVmFsdWUrXCIgXCIrYzpoLnNldEF0dHJpYnV0ZShwLm5vZGVOYW1lLHAubm9kZVZhbHVlKSl9aC5zZXRBdHRyaWJ1dGUoXCJ0cmFuc2Zvcm1cIixjKSxoLnNldEF0dHJpYnV0ZShcImluc3RhbnRpYXRlZF9ieV91c2VcIixcIjFcIiksaC5yZW1vdmVBdHRyaWJ1dGUoXCJpZFwiKSxyPXMucGFyZW50Tm9kZSxyLnJlcGxhY2VDaGlsZChoLHMpLGUubGVuZ3RoPT09dSYmaSsrfX1mdW5jdGlvbiBmKHQsZSxpKXt2YXIgcixzLG4sbyxhPXQuZ2V0QXR0cmlidXRlKFwidmlld0JveFwiKSxoPTEsYz0xLGw9MCx1PTA7aWYoYSYmKGE9YS5tYXRjaCh3KSkmJihsPS1wYXJzZUZsb2F0KGFbMV0pLHU9LXBhcnNlRmxvYXQoYVsyXSkscj1wYXJzZUZsb2F0KGFbM10pLHM9cGFyc2VGbG9hdChhWzRdKSxlJiZlIT09ciYmKGg9ZS9yKSxpJiZpIT09cyYmKGM9aS9zKSxjPWg9aD5jP2M6aCwxIT09aHx8MSE9PWN8fDAhPT1sfHwwIT09dSkpe2lmKG49XCIgbWF0cml4KFwiK2grXCIgMCAwIFwiK2MrXCIgXCIrbCpoK1wiIFwiK3UqYytcIikgXCIsXCJzdmdcIj09PXQudGFnTmFtZSl7Zm9yKG89dC5vd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJnXCIpO251bGwhPXQuZmlyc3RDaGlsZDspby5hcHBlbmRDaGlsZCh0LmZpcnN0Q2hpbGQpO3QuYXBwZW5kQ2hpbGQobyl9ZWxzZSBvPXQsbj1vLmdldEF0dHJpYnV0ZShcInRyYW5zZm9ybVwiKStuO28uc2V0QXR0cmlidXRlKFwidHJhbnNmb3JtXCIsbil9fWZ1bmN0aW9uIGQodCl7dmFyIGU9dC5vYmplY3RzLGk9dC5vcHRpb25zO3JldHVybiBlPWUubWFwKGZ1bmN0aW9uKHQpe3JldHVybiBwW2IodC50eXBlKV0uZnJvbU9iamVjdCh0KX0pLHtvYmplY3RzOmUsb3B0aW9uczppfX1mdW5jdGlvbiBnKHQsZSxpKXtlW2ldJiZlW2ldLnRvU1ZHJiZ0LnB1c2goJzxwYXR0ZXJuIHg9XCIwXCIgeT1cIjBcIiBpZD1cIicsaSwnUGF0dGVyblwiICcsJ3dpZHRoPVwiJyxlW2ldLnNvdXJjZS53aWR0aCwnXCIgaGVpZ2h0PVwiJyxlW2ldLnNvdXJjZS5oZWlnaHQsJ1wiIHBhdHRlcm5Vbml0cz1cInVzZXJTcGFjZU9uVXNlXCI+JywnPGltYWdlIHg9XCIwXCIgeT1cIjBcIiAnLCd3aWR0aD1cIicsZVtpXS5zb3VyY2Uud2lkdGgsJ1wiIGhlaWdodD1cIicsZVtpXS5zb3VyY2UuaGVpZ2h0LCdcIiB4bGluazpocmVmPVwiJyxlW2ldLnNvdXJjZS5zcmMsJ1wiPjwvaW1hZ2U+PC9wYXR0ZXJuPicpfXZhciBwPXQuZmFicmljfHwodC5mYWJyaWM9e30pLHY9cC51dGlsLm9iamVjdC5leHRlbmQsYj1wLnV0aWwuc3RyaW5nLmNhcGl0YWxpemUsbT1wLnV0aWwub2JqZWN0LmNsb25lLHk9cC51dGlsLnRvRml4ZWQsXz1wLnV0aWwucGFyc2VVbml0LHg9cC51dGlsLm11bHRpcGx5VHJhbnNmb3JtTWF0cmljZXMsQz17Y3g6XCJsZWZ0XCIseDpcImxlZnRcIixyOlwicmFkaXVzXCIsY3k6XCJ0b3BcIix5OlwidG9wXCIsZGlzcGxheTpcInZpc2libGVcIix2aXNpYmlsaXR5OlwidmlzaWJsZVwiLHRyYW5zZm9ybTpcInRyYW5zZm9ybU1hdHJpeFwiLFwiZmlsbC1vcGFjaXR5XCI6XCJmaWxsT3BhY2l0eVwiLFwiZmlsbC1ydWxlXCI6XCJmaWxsUnVsZVwiLFwiZm9udC1mYW1pbHlcIjpcImZvbnRGYW1pbHlcIixcImZvbnQtc2l6ZVwiOlwiZm9udFNpemVcIixcImZvbnQtc3R5bGVcIjpcImZvbnRTdHlsZVwiLFwiZm9udC13ZWlnaHRcIjpcImZvbnRXZWlnaHRcIixcInN0cm9rZS1kYXNoYXJyYXlcIjpcInN0cm9rZURhc2hBcnJheVwiLFwic3Ryb2tlLWxpbmVjYXBcIjpcInN0cm9rZUxpbmVDYXBcIixcInN0cm9rZS1saW5lam9pblwiOlwic3Ryb2tlTGluZUpvaW5cIixcInN0cm9rZS1taXRlcmxpbWl0XCI6XCJzdHJva2VNaXRlckxpbWl0XCIsXCJzdHJva2Utb3BhY2l0eVwiOlwic3Ryb2tlT3BhY2l0eVwiLFwic3Ryb2tlLXdpZHRoXCI6XCJzdHJva2VXaWR0aFwiLFwidGV4dC1kZWNvcmF0aW9uXCI6XCJ0ZXh0RGVjb3JhdGlvblwiLFwidGV4dC1hbmNob3JcIjpcIm9yaWdpblhcIn0sUz17c3Ryb2tlOlwic3Ryb2tlT3BhY2l0eVwiLGZpbGw6XCJmaWxsT3BhY2l0eVwifTtwLmNzc1J1bGVzPXt9LHAuZ3JhZGllbnREZWZzPXt9LHAucGFyc2VUcmFuc2Zvcm1BdHRyaWJ1dGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSl7dmFyIGk9ZVswXTt0WzBdPU1hdGguY29zKGkpLHRbMV09TWF0aC5zaW4oaSksdFsyXT0tTWF0aC5zaW4oaSksdFszXT1NYXRoLmNvcyhpKX1mdW5jdGlvbiBlKHQsZSl7dmFyIGk9ZVswXSxyPTI9PT1lLmxlbmd0aD9lWzFdOmVbMF07dFswXT1pLHRbM109cn1mdW5jdGlvbiBpKHQsZSl7dFsyXT1NYXRoLnRhbihwLnV0aWwuZGVncmVlc1RvUmFkaWFucyhlWzBdKSl9ZnVuY3Rpb24gcih0LGUpe3RbMV09TWF0aC50YW4ocC51dGlsLmRlZ3JlZXNUb1JhZGlhbnMoZVswXSkpfWZ1bmN0aW9uIHModCxlKXt0WzRdPWVbMF0sMj09PWUubGVuZ3RoJiYodFs1XT1lWzFdKX12YXIgbj1bMSwwLDAsMSwwLDBdLG89cC5yZU51bSxhPVwiKD86XFxcXHMrLD9cXFxccyp8LFxcXFxzKilcIixoPVwiKD86KHNrZXdYKVxcXFxzKlxcXFwoXFxcXHMqKFwiK28rXCIpXFxcXHMqXFxcXCkpXCIsYz1cIig/Oihza2V3WSlcXFxccypcXFxcKFxcXFxzKihcIitvK1wiKVxcXFxzKlxcXFwpKVwiLGw9XCIoPzoocm90YXRlKVxcXFxzKlxcXFwoXFxcXHMqKFwiK28rXCIpKD86XCIrYStcIihcIitvK1wiKVwiK2ErXCIoXCIrbytcIikpP1xcXFxzKlxcXFwpKVwiLHU9XCIoPzooc2NhbGUpXFxcXHMqXFxcXChcXFxccyooXCIrbytcIikoPzpcIithK1wiKFwiK28rXCIpKT9cXFxccypcXFxcKSlcIixmPVwiKD86KHRyYW5zbGF0ZSlcXFxccypcXFxcKFxcXFxzKihcIitvK1wiKSg/OlwiK2ErXCIoXCIrbytcIikpP1xcXFxzKlxcXFwpKVwiLGQ9XCIoPzoobWF0cml4KVxcXFxzKlxcXFwoXFxcXHMqKFwiK28rXCIpXCIrYStcIihcIitvK1wiKVwiK2ErXCIoXCIrbytcIilcIithK1wiKFwiK28rXCIpXCIrYStcIihcIitvK1wiKVwiK2ErXCIoXCIrbytcIilcXFxccypcXFxcKSlcIixnPVwiKD86XCIrZCtcInxcIitmK1wifFwiK3UrXCJ8XCIrbCtcInxcIitoK1wifFwiK2MrXCIpXCIsdj1cIig/OlwiK2crXCIoPzpcIithK2crXCIpKilcIixiPVwiXlxcXFxzKig/OlwiK3YrXCI/KVxcXFxzKiRcIixtPW5ldyBSZWdFeHAoYikseT1uZXcgUmVnRXhwKGcsXCJnXCIpO3JldHVybiBmdW5jdGlvbihvKXt2YXIgYT1uLmNvbmNhdCgpLGg9W107aWYoIW98fG8mJiFtLnRlc3QobykpcmV0dXJuIGE7by5yZXBsYWNlKHksZnVuY3Rpb24obyl7dmFyIGM9bmV3IFJlZ0V4cChnKS5leGVjKG8pLmZpbHRlcihmdW5jdGlvbih0KXtyZXR1cm5cIlwiIT09dCYmbnVsbCE9dH0pLGw9Y1sxXSx1PWMuc2xpY2UoMikubWFwKHBhcnNlRmxvYXQpO3N3aXRjaChsKXtjYXNlXCJ0cmFuc2xhdGVcIjpzKGEsdSk7YnJlYWs7Y2FzZVwicm90YXRlXCI6dVswXT1wLnV0aWwuZGVncmVlc1RvUmFkaWFucyh1WzBdKSx0KGEsdSk7YnJlYWs7Y2FzZVwic2NhbGVcIjplKGEsdSk7YnJlYWs7Y2FzZVwic2tld1hcIjppKGEsdSk7YnJlYWs7Y2FzZVwic2tld1lcIjpyKGEsdSk7YnJlYWs7Y2FzZVwibWF0cml4XCI6YT11fWgucHVzaChhLmNvbmNhdCgpKSxhPW4uY29uY2F0KCl9KTtmb3IodmFyIGM9aFswXTtoLmxlbmd0aD4xOyloLnNoaWZ0KCksYz1wLnV0aWwubXVsdGlwbHlUcmFuc2Zvcm1NYXRyaWNlcyhjLGhbMF0pO3JldHVybiBjfX0oKTt2YXIgdz1uZXcgUmVnRXhwKFwiXlxcXFxzKihcIitwLnJlTnVtK1wiKylcXFxccyosP1xcXFxzKihcIitwLnJlTnVtK1wiKylcXFxccyosP1xcXFxzKihcIitwLnJlTnVtK1wiKylcXFxccyosP1xcXFxzKihcIitwLnJlTnVtK1wiKylcXFxccyokXCIpO3AucGFyc2VTVkdEb2N1bWVudD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxlKXtmb3IoO3QmJih0PXQucGFyZW50Tm9kZSk7KWlmKGUudGVzdCh0Lm5vZGVOYW1lKSYmIXQuZ2V0QXR0cmlidXRlKFwiaW5zdGFudGlhdGVkX2J5X3VzZVwiKSlyZXR1cm4hMDtyZXR1cm4hMX12YXIgZT0vXihwYXRofGNpcmNsZXxwb2x5Z29ufHBvbHlsaW5lfGVsbGlwc2V8cmVjdHxsaW5lfGltYWdlfHRleHQpJC8saT0vXihzeW1ib2x8aW1hZ2V8bWFya2VyfHBhdHRlcm58dmlldykkLztyZXR1cm4gZnVuY3Rpb24ocixzLG4pe2lmKHIpe3Uocik7dmFyIG8sYSxoPW5ldyBEYXRlLGM9cC5PYmplY3QuX191aWQrKyxsPSExO2lmKHIuZ2V0QXR0cmlidXRlKFwid2lkdGhcIikmJlwiMTAwJVwiIT09ci5nZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiKSYmKG89XyhyLmdldEF0dHJpYnV0ZShcIndpZHRoXCIpKSksci5nZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIikmJlwiMTAwJVwiIT09ci5nZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIikmJihhPV8oci5nZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIikpKSwhb3x8IWEpe3ZhciBkPXIuZ2V0QXR0cmlidXRlKFwidmlld0JveFwiKTtkJiYoZD1kLm1hdGNoKHcpKT8obz1wYXJzZUZsb2F0KGRbM10pLGE9cGFyc2VGbG9hdChkWzRdKSk6bD0hMH1mKHIsbyxhKTt2YXIgZz1wLnV0aWwudG9BcnJheShyLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiKlwiKSk7aWYoMD09PWcubGVuZ3RoJiZwLmlzTGlrZWx5Tm9kZSl7Zz1yLnNlbGVjdE5vZGVzKCcvLypbbmFtZSguKSE9XCJzdmdcIl0nKTtmb3IodmFyIHY9W10sYj0wLHk9Zy5sZW5ndGg7eT5iO2IrKyl2W2JdPWdbYl07Zz12fXZhciB4PWcuZmlsdGVyKGZ1bmN0aW9uKHIpe3JldHVybiBpLnRlc3Qoci50YWdOYW1lKSYmZihyLDAsMCksZS50ZXN0KHIudGFnTmFtZSkmJiF0KHIsL14oPzpwYXR0ZXJufGRlZnN8c3ltYm9sfG1ldGFkYXRhKSQvKX0pO2lmKCF4fHx4JiYheC5sZW5ndGgpcmV0dXJuIHZvaWQocyYmcyhbXSx7fSkpO3ZhciBDPXt3aWR0aDpvLGhlaWdodDphLHN2Z1VpZDpjLHRvQmVQYXJzZWQ6bH07cC5ncmFkaWVudERlZnNbY109cC5nZXRHcmFkaWVudERlZnMocikscC5jc3NSdWxlc1tjXT1wLmdldENTU1J1bGVzKHIpLHAucGFyc2VFbGVtZW50cyh4LGZ1bmN0aW9uKHQpe3AuZG9jdW1lbnRQYXJzaW5nVGltZT1uZXcgRGF0ZS1oLHMmJnModCxDKX0sbShDKSxuKX19fSgpO3ZhciBPPXtoYXM6ZnVuY3Rpb24odCxlKXtlKCExKX0sZ2V0OmZ1bmN0aW9uKCl7fSxzZXQ6ZnVuY3Rpb24oKXt9fSxUPW5ldyBSZWdFeHAoXCIobm9ybWFsfGl0YWxpYyk/XFxcXHMqKG5vcm1hbHxzbWFsbC1jYXBzKT9cXFxccyoobm9ybWFsfGJvbGR8Ym9sZGVyfGxpZ2h0ZXJ8MTAwfDIwMHwzMDB8NDAwfDUwMHw2MDB8NzAwfDgwMHw5MDApP1xcXFxzKihcIitwLnJlTnVtK1wiKD86cHh8Y218bW18ZW18cHR8cGN8aW4pKikoPzpcXFxcLyhub3JtYWx8XCIrcC5yZU51bStcIikpP1xcXFxzKyguKilcIik7dihwLHtwYXJzZUZvbnREZWNsYXJhdGlvbjpmdW5jdGlvbih0LGUpe3ZhciBpPXQubWF0Y2goVCk7aWYoaSl7dmFyIHI9aVsxXSxzPWlbM10sbj1pWzRdLG89aVs1XSxhPWlbNl07ciYmKGUuZm9udFN0eWxlPXIpLHMmJihlLmZvbnRXZWlnaHQ9aXNOYU4ocGFyc2VGbG9hdChzKSk/czpwYXJzZUZsb2F0KHMpKSxuJiYoZS5mb250U2l6ZT1fKG4pKSxcclxuYSYmKGUuZm9udEZhbWlseT1hKSxvJiYoZS5saW5lSGVpZ2h0PVwibm9ybWFsXCI9PT1vPzE6byl9fSxnZXRHcmFkaWVudERlZnM6ZnVuY3Rpb24odCl7dmFyIGUsaSxyLHMsbj10LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwibGluZWFyR3JhZGllbnRcIiksbz10LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwicmFkaWFsR3JhZGllbnRcIiksYT0wLGg9W10sYz17fSxsPXt9O2ZvcihoLmxlbmd0aD1uLmxlbmd0aCtvLmxlbmd0aCxpPW4ubGVuZ3RoO2ktLTspaFthKytdPW5baV07Zm9yKGk9by5sZW5ndGg7aS0tOyloW2ErK109b1tpXTtmb3IoO2EtLTspZT1oW2FdLHM9ZS5nZXRBdHRyaWJ1dGUoXCJ4bGluazpocmVmXCIpLHI9ZS5nZXRBdHRyaWJ1dGUoXCJpZFwiKSxzJiYobFtyXT1zLnN1YnN0cigxKSksY1tyXT1lO2ZvcihyIGluIGwpe3ZhciB1PWNbbFtyXV0uY2xvbmVOb2RlKCEwKTtmb3IoZT1jW3JdO3UuZmlyc3RDaGlsZDspZS5hcHBlbmRDaGlsZCh1LmZpcnN0Q2hpbGQpfXJldHVybiBjfSxwYXJzZUF0dHJpYnV0ZXM6ZnVuY3Rpb24odCxzLG4pe2lmKHQpe3ZhciBhLGgsYz17fTtcInVuZGVmaW5lZFwiPT10eXBlb2YgbiYmKG49dC5nZXRBdHRyaWJ1dGUoXCJzdmdVaWRcIikpLHQucGFyZW50Tm9kZSYmL15zeW1ib2x8W2d8YV0kL2kudGVzdCh0LnBhcmVudE5vZGUubm9kZU5hbWUpJiYoYz1wLnBhcnNlQXR0cmlidXRlcyh0LnBhcmVudE5vZGUscyxuKSksaD1jJiZjLmZvbnRTaXplfHx0LmdldEF0dHJpYnV0ZShcImZvbnQtc2l6ZVwiKXx8cC5UZXh0LkRFRkFVTFRfU1ZHX0ZPTlRfU0laRTt2YXIgbD1zLnJlZHVjZShmdW5jdGlvbihyLHMpe3JldHVybiBhPXQuZ2V0QXR0cmlidXRlKHMpLGEmJihzPWUocyksYT1pKHMsYSxjLGgpLHJbc109YSkscn0se30pO3JldHVybiBsPXYobCx2KG8odCxuKSxwLnBhcnNlU3R5bGVBdHRyaWJ1dGUodCkpKSxsLmZvbnQmJnAucGFyc2VGb250RGVjbGFyYXRpb24obC5mb250LGwpLHIodihjLGwpKX19LHBhcnNlRWxlbWVudHM6ZnVuY3Rpb24odCxlLGkscil7bmV3IHAuRWxlbWVudHNQYXJzZXIodCxlLGkscikucGFyc2UoKX0scGFyc2VTdHlsZUF0dHJpYnV0ZTpmdW5jdGlvbih0KXt2YXIgZT17fSxpPXQuZ2V0QXR0cmlidXRlKFwic3R5bGVcIik7cmV0dXJuIGk/KFwic3RyaW5nXCI9PXR5cGVvZiBpP3MoaSxlKTpuKGksZSksZSk6ZX0scGFyc2VQb2ludHNBdHRyaWJ1dGU6ZnVuY3Rpb24odCl7aWYoIXQpcmV0dXJuIG51bGw7dD10LnJlcGxhY2UoLywvZyxcIiBcIikudHJpbSgpLHQ9dC5zcGxpdCgvXFxzKy8pO3ZhciBlLGkscj1bXTtmb3IoZT0wLGk9dC5sZW5ndGg7aT5lO2UrPTIpci5wdXNoKHt4OnBhcnNlRmxvYXQodFtlXSkseTpwYXJzZUZsb2F0KHRbZSsxXSl9KTtyZXR1cm4gcn0sZ2V0Q1NTUnVsZXM6ZnVuY3Rpb24odCl7Zm9yKHZhciByLHM9dC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInN0eWxlXCIpLG49e30sbz0wLGE9cy5sZW5ndGg7YT5vO28rKyl7dmFyIGg9c1tvXS50ZXh0Q29udGVudDtoPWgucmVwbGFjZSgvXFwvXFwqW1xcc1xcU10qP1xcKlxcLy9nLFwiXCIpLFwiXCIhPT1oLnRyaW0oKSYmKHI9aC5tYXRjaCgvW157XSpcXHtbXFxzXFxTXSo/XFx9L2cpLHI9ci5tYXAoZnVuY3Rpb24odCl7cmV0dXJuIHQudHJpbSgpfSksci5mb3JFYWNoKGZ1bmN0aW9uKHQpe2Zvcih2YXIgcj10Lm1hdGNoKC8oW1xcc1xcU10qPylcXHMqXFx7KFtefV0qKVxcfS8pLHM9e30sbz1yWzJdLnRyaW0oKSxhPW8ucmVwbGFjZSgvOyQvLFwiXCIpLnNwbGl0KC9cXHMqO1xccyovKSxoPTAsYz1hLmxlbmd0aDtjPmg7aCsrKXt2YXIgbD1hW2hdLnNwbGl0KC9cXHMqOlxccyovKSx1PWUobFswXSksZj1pKHUsbFsxXSxsWzBdKTtzW3VdPWZ9dD1yWzFdLHQuc3BsaXQoXCIsXCIpLmZvckVhY2goZnVuY3Rpb24odCl7dD10LnJlcGxhY2UoL15zdmcvaSxcIlwiKS50cmltKCksXCJcIiE9PXQmJihuW3RdPXAudXRpbC5vYmplY3QuY2xvbmUocykpfSl9KSl9cmV0dXJuIG59LGxvYWRTVkdGcm9tVVJMOmZ1bmN0aW9uKHQsZSxpKXtmdW5jdGlvbiByKHIpe3ZhciBzPXIucmVzcG9uc2VYTUw7cyYmIXMuZG9jdW1lbnRFbGVtZW50JiZwLndpbmRvdy5BY3RpdmVYT2JqZWN0JiZyLnJlc3BvbnNlVGV4dCYmKHM9bmV3IEFjdGl2ZVhPYmplY3QoXCJNaWNyb3NvZnQuWE1MRE9NXCIpLHMuYXN5bmM9XCJmYWxzZVwiLHMubG9hZFhNTChyLnJlc3BvbnNlVGV4dC5yZXBsYWNlKC88IURPQ1RZUEVbXFxzXFxTXSo/KFxcW1tcXHNcXFNdKlxcXSkqPz4vaSxcIlwiKSkpLHMmJnMuZG9jdW1lbnRFbGVtZW50JiZwLnBhcnNlU1ZHRG9jdW1lbnQocy5kb2N1bWVudEVsZW1lbnQsZnVuY3Rpb24oaSxyKXtPLnNldCh0LHtvYmplY3RzOnAudXRpbC5hcnJheS5pbnZva2UoaSxcInRvT2JqZWN0XCIpLG9wdGlvbnM6cn0pLGUoaSxyKX0saSl9dD10LnJlcGxhY2UoL15cXG5cXHMqLyxcIlwiKS50cmltKCksTy5oYXModCxmdW5jdGlvbihpKXtpP08uZ2V0KHQsZnVuY3Rpb24odCl7dmFyIGk9ZCh0KTtlKGkub2JqZWN0cyxpLm9wdGlvbnMpfSk6bmV3IHAudXRpbC5yZXF1ZXN0KHQse21ldGhvZDpcImdldFwiLG9uQ29tcGxldGU6cn0pfSl9LGxvYWRTVkdGcm9tU3RyaW5nOmZ1bmN0aW9uKHQsZSxpKXt0PXQudHJpbSgpO3ZhciByO2lmKFwidW5kZWZpbmVkXCIhPXR5cGVvZiBET01QYXJzZXIpe3ZhciBzPW5ldyBET01QYXJzZXI7cyYmcy5wYXJzZUZyb21TdHJpbmcmJihyPXMucGFyc2VGcm9tU3RyaW5nKHQsXCJ0ZXh0L3htbFwiKSl9ZWxzZSBwLndpbmRvdy5BY3RpdmVYT2JqZWN0JiYocj1uZXcgQWN0aXZlWE9iamVjdChcIk1pY3Jvc29mdC5YTUxET01cIiksci5hc3luYz1cImZhbHNlXCIsci5sb2FkWE1MKHQucmVwbGFjZSgvPCFET0NUWVBFW1xcc1xcU10qPyhcXFtbXFxzXFxTXSpcXF0pKj8+L2ksXCJcIikpKTtwLnBhcnNlU1ZHRG9jdW1lbnQoci5kb2N1bWVudEVsZW1lbnQsZnVuY3Rpb24odCxpKXtlKHQsaSl9LGkpfSxjcmVhdGVTVkdGb250RmFjZXNNYXJrdXA6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPVwiXCIsaT0wLHI9dC5sZW5ndGg7cj5pO2krKylcInRleHRcIj09PXRbaV0udHlwZSYmdFtpXS5wYXRoJiYoZSs9W1wiQGZvbnQtZmFjZSB7XCIsXCJmb250LWZhbWlseTogXCIsdFtpXS5mb250RmFtaWx5LFwiOyBcIixcInNyYzogdXJsKCdcIix0W2ldLnBhdGgsXCInKVwiLFwifVwiXS5qb2luKFwiXCIpKTtyZXR1cm4gZSYmKGU9Wyc8c3R5bGUgdHlwZT1cInRleHQvY3NzXCI+JyxcIjwhW0NEQVRBW1wiLGUsXCJdXT5cIixcIjwvc3R5bGU+XCJdLmpvaW4oXCJcIikpLGV9LGNyZWF0ZVNWR1JlZkVsZW1lbnRzTWFya3VwOmZ1bmN0aW9uKHQpe3ZhciBlPVtdO3JldHVybiBnKGUsdCxcImJhY2tncm91bmRDb2xvclwiKSxnKGUsdCxcIm92ZXJsYXlDb2xvclwiKSxlLmpvaW4oXCJcIil9fSl9KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZmFicmljLkVsZW1lbnRzUGFyc2VyPWZ1bmN0aW9uKHQsZSxpLHIpe3RoaXMuZWxlbWVudHM9dCx0aGlzLmNhbGxiYWNrPWUsdGhpcy5vcHRpb25zPWksdGhpcy5yZXZpdmVyPXIsdGhpcy5zdmdVaWQ9aSYmaS5zdmdVaWR8fDB9LGZhYnJpYy5FbGVtZW50c1BhcnNlci5wcm90b3R5cGUucGFyc2U9ZnVuY3Rpb24oKXt0aGlzLmluc3RhbmNlcz1uZXcgQXJyYXkodGhpcy5lbGVtZW50cy5sZW5ndGgpLHRoaXMubnVtRWxlbWVudHM9dGhpcy5lbGVtZW50cy5sZW5ndGgsdGhpcy5jcmVhdGVPYmplY3RzKCl9LGZhYnJpYy5FbGVtZW50c1BhcnNlci5wcm90b3R5cGUuY3JlYXRlT2JqZWN0cz1mdW5jdGlvbigpe2Zvcih2YXIgdD0wLGU9dGhpcy5lbGVtZW50cy5sZW5ndGg7ZT50O3QrKyl0aGlzLmVsZW1lbnRzW3RdLnNldEF0dHJpYnV0ZShcInN2Z1VpZFwiLHRoaXMuc3ZnVWlkKSxmdW5jdGlvbih0LGUpe3NldFRpbWVvdXQoZnVuY3Rpb24oKXt0LmNyZWF0ZU9iamVjdCh0LmVsZW1lbnRzW2VdLGUpfSwwKX0odGhpcyx0KX0sZmFicmljLkVsZW1lbnRzUGFyc2VyLnByb3RvdHlwZS5jcmVhdGVPYmplY3Q9ZnVuY3Rpb24odCxlKXt2YXIgaT1mYWJyaWNbZmFicmljLnV0aWwuc3RyaW5nLmNhcGl0YWxpemUodC50YWdOYW1lKV07aWYoaSYmaS5mcm9tRWxlbWVudCl0cnl7dGhpcy5fY3JlYXRlT2JqZWN0KGksdCxlKX1jYXRjaChyKXtmYWJyaWMubG9nKHIpfWVsc2UgdGhpcy5jaGVja0lmRG9uZSgpfSxmYWJyaWMuRWxlbWVudHNQYXJzZXIucHJvdG90eXBlLl9jcmVhdGVPYmplY3Q9ZnVuY3Rpb24odCxlLGkpe2lmKHQuYXN5bmMpdC5mcm9tRWxlbWVudChlLHRoaXMuY3JlYXRlQ2FsbGJhY2soaSxlKSx0aGlzLm9wdGlvbnMpO2Vsc2V7dmFyIHI9dC5mcm9tRWxlbWVudChlLHRoaXMub3B0aW9ucyk7dGhpcy5yZXNvbHZlR3JhZGllbnQocixcImZpbGxcIiksdGhpcy5yZXNvbHZlR3JhZGllbnQocixcInN0cm9rZVwiKSx0aGlzLnJldml2ZXImJnRoaXMucmV2aXZlcihlLHIpLHRoaXMuaW5zdGFuY2VzW2ldPXIsdGhpcy5jaGVja0lmRG9uZSgpfX0sZmFicmljLkVsZW1lbnRzUGFyc2VyLnByb3RvdHlwZS5jcmVhdGVDYWxsYmFjaz1mdW5jdGlvbih0LGUpe3ZhciBpPXRoaXM7cmV0dXJuIGZ1bmN0aW9uKHIpe2kucmVzb2x2ZUdyYWRpZW50KHIsXCJmaWxsXCIpLGkucmVzb2x2ZUdyYWRpZW50KHIsXCJzdHJva2VcIiksaS5yZXZpdmVyJiZpLnJldml2ZXIoZSxyKSxpLmluc3RhbmNlc1t0XT1yLGkuY2hlY2tJZkRvbmUoKX19LGZhYnJpYy5FbGVtZW50c1BhcnNlci5wcm90b3R5cGUucmVzb2x2ZUdyYWRpZW50PWZ1bmN0aW9uKHQsZSl7dmFyIGk9dC5nZXQoZSk7aWYoL151cmxcXCgvLnRlc3QoaSkpe3ZhciByPWkuc2xpY2UoNSxpLmxlbmd0aC0xKTtmYWJyaWMuZ3JhZGllbnREZWZzW3RoaXMuc3ZnVWlkXVtyXSYmdC5zZXQoZSxmYWJyaWMuR3JhZGllbnQuZnJvbUVsZW1lbnQoZmFicmljLmdyYWRpZW50RGVmc1t0aGlzLnN2Z1VpZF1bcl0sdCkpfX0sZmFicmljLkVsZW1lbnRzUGFyc2VyLnByb3RvdHlwZS5jaGVja0lmRG9uZT1mdW5jdGlvbigpezA9PT0tLXRoaXMubnVtRWxlbWVudHMmJih0aGlzLmluc3RhbmNlcz10aGlzLmluc3RhbmNlcy5maWx0ZXIoZnVuY3Rpb24odCl7cmV0dXJuIG51bGwhPXR9KSx0aGlzLmNhbGxiYWNrKHRoaXMuaW5zdGFuY2VzKSl9LGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGUodCxlKXt0aGlzLng9dCx0aGlzLnk9ZX12YXIgaT10LmZhYnJpY3x8KHQuZmFicmljPXt9KTtyZXR1cm4gaS5Qb2ludD92b2lkIGkud2FybihcImZhYnJpYy5Qb2ludCBpcyBhbHJlYWR5IGRlZmluZWRcIik6KGkuUG9pbnQ9ZSx2b2lkKGUucHJvdG90eXBlPXtjb25zdHJ1Y3RvcjplLGFkZDpmdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodGhpcy54K3QueCx0aGlzLnkrdC55KX0sYWRkRXF1YWxzOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLngrPXQueCx0aGlzLnkrPXQueSx0aGlzfSxzY2FsYXJBZGQ6ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHRoaXMueCt0LHRoaXMueSt0KX0sc2NhbGFyQWRkRXF1YWxzOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLngrPXQsdGhpcy55Kz10LHRoaXN9LHN1YnRyYWN0OmZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0aGlzLngtdC54LHRoaXMueS10LnkpfSxzdWJ0cmFjdEVxdWFsczpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy54LT10LngsdGhpcy55LT10LnksdGhpc30sc2NhbGFyU3VidHJhY3Q6ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHRoaXMueC10LHRoaXMueS10KX0sc2NhbGFyU3VidHJhY3RFcXVhbHM6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMueC09dCx0aGlzLnktPXQsdGhpc30sbXVsdGlwbHk6ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHRoaXMueCp0LHRoaXMueSp0KX0sbXVsdGlwbHlFcXVhbHM6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMueCo9dCx0aGlzLnkqPXQsdGhpc30sZGl2aWRlOmZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0aGlzLngvdCx0aGlzLnkvdCl9LGRpdmlkZUVxdWFsczpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy54Lz10LHRoaXMueS89dCx0aGlzfSxlcTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy54PT09dC54JiZ0aGlzLnk9PT10Lnl9LGx0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLng8dC54JiZ0aGlzLnk8dC55fSxsdGU6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMueDw9dC54JiZ0aGlzLnk8PXQueX0sZ3Q6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMueD50LngmJnRoaXMueT50Lnl9LGd0ZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy54Pj10LngmJnRoaXMueT49dC55fSxsZXJwOmZ1bmN0aW9uKHQsaSl7cmV0dXJuIG5ldyBlKHRoaXMueCsodC54LXRoaXMueCkqaSx0aGlzLnkrKHQueS10aGlzLnkpKmkpfSxkaXN0YW5jZUZyb206ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy54LXQueCxpPXRoaXMueS10Lnk7cmV0dXJuIE1hdGguc3FydChlKmUraSppKX0sbWlkUG9pbnRGcm9tOmZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0aGlzLngrKHQueC10aGlzLngpLzIsdGhpcy55Kyh0LnktdGhpcy55KS8yKX0sbWluOmZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZShNYXRoLm1pbih0aGlzLngsdC54KSxNYXRoLm1pbih0aGlzLnksdC55KSl9LG1heDpmdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUoTWF0aC5tYXgodGhpcy54LHQueCksTWF0aC5tYXgodGhpcy55LHQueSkpfSx0b1N0cmluZzpmdW5jdGlvbigpe3JldHVybiB0aGlzLngrXCIsXCIrdGhpcy55fSxzZXRYWTpmdW5jdGlvbih0LGUpe3RoaXMueD10LHRoaXMueT1lfSxzZXRGcm9tUG9pbnQ6ZnVuY3Rpb24odCl7dGhpcy54PXQueCx0aGlzLnk9dC55fSxzd2FwOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMueCxpPXRoaXMueTt0aGlzLng9dC54LHRoaXMueT10LnksdC54PWUsdC55PWl9fSkpfShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGUodCl7dGhpcy5zdGF0dXM9dCx0aGlzLnBvaW50cz1bXX12YXIgaT10LmZhYnJpY3x8KHQuZmFicmljPXt9KTtyZXR1cm4gaS5JbnRlcnNlY3Rpb24/dm9pZCBpLndhcm4oXCJmYWJyaWMuSW50ZXJzZWN0aW9uIGlzIGFscmVhZHkgZGVmaW5lZFwiKTooaS5JbnRlcnNlY3Rpb249ZSxpLkludGVyc2VjdGlvbi5wcm90b3R5cGU9e2FwcGVuZFBvaW50OmZ1bmN0aW9uKHQpe3RoaXMucG9pbnRzLnB1c2godCl9LGFwcGVuZFBvaW50czpmdW5jdGlvbih0KXt0aGlzLnBvaW50cz10aGlzLnBvaW50cy5jb25jYXQodCl9fSxpLkludGVyc2VjdGlvbi5pbnRlcnNlY3RMaW5lTGluZT1mdW5jdGlvbih0LHIscyxuKXt2YXIgbyxhPShuLngtcy54KSoodC55LXMueSktKG4ueS1zLnkpKih0Lngtcy54KSxoPShyLngtdC54KSoodC55LXMueSktKHIueS10LnkpKih0Lngtcy54KSxjPShuLnktcy55KSooci54LXQueCktKG4ueC1zLngpKihyLnktdC55KTtpZigwIT09Yyl7dmFyIGw9YS9jLHU9aC9jO2w+PTAmJjE+PWwmJnU+PTAmJjE+PXU/KG89bmV3IGUoXCJJbnRlcnNlY3Rpb25cIiksby5wb2ludHMucHVzaChuZXcgaS5Qb2ludCh0LngrbCooci54LXQueCksdC55K2wqKHIueS10LnkpKSkpOm89bmV3IGV9ZWxzZSBvPW5ldyBlKDA9PT1hfHwwPT09aD9cIkNvaW5jaWRlbnRcIjpcIlBhcmFsbGVsXCIpO3JldHVybiBvfSxpLkludGVyc2VjdGlvbi5pbnRlcnNlY3RMaW5lUG9seWdvbj1mdW5jdGlvbih0LGkscil7Zm9yKHZhciBzPW5ldyBlLG49ci5sZW5ndGgsbz0wO24+bztvKyspe3ZhciBhPXJbb10saD1yWyhvKzEpJW5dLGM9ZS5pbnRlcnNlY3RMaW5lTGluZSh0LGksYSxoKTtzLmFwcGVuZFBvaW50cyhjLnBvaW50cyl9cmV0dXJuIHMucG9pbnRzLmxlbmd0aD4wJiYocy5zdGF0dXM9XCJJbnRlcnNlY3Rpb25cIiksc30saS5JbnRlcnNlY3Rpb24uaW50ZXJzZWN0UG9seWdvblBvbHlnb249ZnVuY3Rpb24odCxpKXtmb3IodmFyIHI9bmV3IGUscz10Lmxlbmd0aCxuPTA7cz5uO24rKyl7dmFyIG89dFtuXSxhPXRbKG4rMSklc10saD1lLmludGVyc2VjdExpbmVQb2x5Z29uKG8sYSxpKTtyLmFwcGVuZFBvaW50cyhoLnBvaW50cyl9cmV0dXJuIHIucG9pbnRzLmxlbmd0aD4wJiYoci5zdGF0dXM9XCJJbnRlcnNlY3Rpb25cIikscn0sdm9pZChpLkludGVyc2VjdGlvbi5pbnRlcnNlY3RQb2x5Z29uUmVjdGFuZ2xlPWZ1bmN0aW9uKHQscixzKXt2YXIgbj1yLm1pbihzKSxvPXIubWF4KHMpLGE9bmV3IGkuUG9pbnQoby54LG4ueSksaD1uZXcgaS5Qb2ludChuLngsby55KSxjPWUuaW50ZXJzZWN0TGluZVBvbHlnb24obixhLHQpLGw9ZS5pbnRlcnNlY3RMaW5lUG9seWdvbihhLG8sdCksdT1lLmludGVyc2VjdExpbmVQb2x5Z29uKG8saCx0KSxmPWUuaW50ZXJzZWN0TGluZVBvbHlnb24oaCxuLHQpLGQ9bmV3IGU7cmV0dXJuIGQuYXBwZW5kUG9pbnRzKGMucG9pbnRzKSxkLmFwcGVuZFBvaW50cyhsLnBvaW50cyksZC5hcHBlbmRQb2ludHModS5wb2ludHMpLGQuYXBwZW5kUG9pbnRzKGYucG9pbnRzKSxkLnBvaW50cy5sZW5ndGg+MCYmKGQuc3RhdHVzPVwiSW50ZXJzZWN0aW9uXCIpLGR9KSl9KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gZSh0KXt0P3RoaXMuX3RyeVBhcnNpbmdDb2xvcih0KTp0aGlzLnNldFNvdXJjZShbMCwwLDAsMV0pfWZ1bmN0aW9uIGkodCxlLGkpe3JldHVybiAwPmkmJihpKz0xKSxpPjEmJihpLT0xKSwxLzY+aT90KzYqKGUtdCkqaTouNT5pP2U6Mi8zPmk/dCsoZS10KSooMi8zLWkpKjY6dH12YXIgcj10LmZhYnJpY3x8KHQuZmFicmljPXt9KTtyZXR1cm4gci5Db2xvcj92b2lkIHIud2FybihcImZhYnJpYy5Db2xvciBpcyBhbHJlYWR5IGRlZmluZWQuXCIpOihyLkNvbG9yPWUsci5Db2xvci5wcm90b3R5cGU9e190cnlQYXJzaW5nQ29sb3I6ZnVuY3Rpb24odCl7dmFyIGk7cmV0dXJuIHQgaW4gZS5jb2xvck5hbWVNYXAmJih0PWUuY29sb3JOYW1lTWFwW3RdKSxcInRyYW5zcGFyZW50XCI9PT10P3ZvaWQgdGhpcy5zZXRTb3VyY2UoWzI1NSwyNTUsMjU1LDBdKTooaT1lLnNvdXJjZUZyb21IZXgodCksaXx8KGk9ZS5zb3VyY2VGcm9tUmdiKHQpKSxpfHwoaT1lLnNvdXJjZUZyb21Ic2wodCkpLHZvaWQoaSYmdGhpcy5zZXRTb3VyY2UoaSkpKX0sX3JnYlRvSHNsOmZ1bmN0aW9uKHQsZSxpKXt0Lz0yNTUsZS89MjU1LGkvPTI1NTt2YXIgcyxuLG8sYT1yLnV0aWwuYXJyYXkubWF4KFt0LGUsaV0pLGg9ci51dGlsLmFycmF5Lm1pbihbdCxlLGldKTtpZihvPShhK2gpLzIsYT09PWgpcz1uPTA7ZWxzZXt2YXIgYz1hLWg7c3dpdGNoKG49bz4uNT9jLygyLWEtaCk6Yy8oYStoKSxhKXtjYXNlIHQ6cz0oZS1pKS9jKyhpPmU/NjowKTticmVhaztjYXNlIGU6cz0oaS10KS9jKzI7YnJlYWs7Y2FzZSBpOnM9KHQtZSkvYys0fXMvPTZ9cmV0dXJuW01hdGgucm91bmQoMzYwKnMpLE1hdGgucm91bmQoMTAwKm4pLE1hdGgucm91bmQoMTAwKm8pXX0sZ2V0U291cmNlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NvdXJjZX0sc2V0U291cmNlOmZ1bmN0aW9uKHQpe3RoaXMuX3NvdXJjZT10fSx0b1JnYjpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0U291cmNlKCk7cmV0dXJuXCJyZ2IoXCIrdFswXStcIixcIit0WzFdK1wiLFwiK3RbMl0rXCIpXCJ9LHRvUmdiYTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0U291cmNlKCk7cmV0dXJuXCJyZ2JhKFwiK3RbMF0rXCIsXCIrdFsxXStcIixcIit0WzJdK1wiLFwiK3RbM10rXCIpXCJ9LHRvSHNsOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXRTb3VyY2UoKSxlPXRoaXMuX3JnYlRvSHNsKHRbMF0sdFsxXSx0WzJdKTtyZXR1cm5cImhzbChcIitlWzBdK1wiLFwiK2VbMV0rXCIlLFwiK2VbMl0rXCIlKVwifSx0b0hzbGE6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmdldFNvdXJjZSgpLGU9dGhpcy5fcmdiVG9Ic2wodFswXSx0WzFdLHRbMl0pO3JldHVyblwiaHNsYShcIitlWzBdK1wiLFwiK2VbMV0rXCIlLFwiK2VbMl0rXCIlLFwiK3RbM10rXCIpXCJ9LHRvSGV4OmZ1bmN0aW9uKCl7dmFyIHQsZSxpLHI9dGhpcy5nZXRTb3VyY2UoKTtyZXR1cm4gdD1yWzBdLnRvU3RyaW5nKDE2KSx0PTE9PT10Lmxlbmd0aD9cIjBcIit0OnQsZT1yWzFdLnRvU3RyaW5nKDE2KSxlPTE9PT1lLmxlbmd0aD9cIjBcIitlOmUsaT1yWzJdLnRvU3RyaW5nKDE2KSxpPTE9PT1pLmxlbmd0aD9cIjBcIitpOmksdC50b1VwcGVyQ2FzZSgpK2UudG9VcHBlckNhc2UoKStpLnRvVXBwZXJDYXNlKCl9LGdldEFscGhhOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0U291cmNlKClbM119LHNldEFscGhhOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0U291cmNlKCk7cmV0dXJuIGVbM109dCx0aGlzLnNldFNvdXJjZShlKSx0aGlzfSx0b0dyYXlzY2FsZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0U291cmNlKCksZT1wYXJzZUludCgoLjMqdFswXSsuNTkqdFsxXSsuMTEqdFsyXSkudG9GaXhlZCgwKSwxMCksaT10WzNdO3JldHVybiB0aGlzLnNldFNvdXJjZShbZSxlLGUsaV0pLHRoaXN9LHRvQmxhY2tXaGl0ZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldFNvdXJjZSgpLGk9KC4zKmVbMF0rLjU5KmVbMV0rLjExKmVbMl0pLnRvRml4ZWQoMCkscj1lWzNdO3JldHVybiB0PXR8fDEyNyxpPU51bWJlcihpKTxOdW1iZXIodCk/MDoyNTUsdGhpcy5zZXRTb3VyY2UoW2ksaSxpLHJdKSx0aGlzfSxvdmVybGF5V2l0aDpmdW5jdGlvbih0KXt0IGluc3RhbmNlb2YgZXx8KHQ9bmV3IGUodCkpO2Zvcih2YXIgaT1bXSxyPXRoaXMuZ2V0QWxwaGEoKSxzPS41LG49dGhpcy5nZXRTb3VyY2UoKSxvPXQuZ2V0U291cmNlKCksYT0wOzM+YTthKyspaS5wdXNoKE1hdGgucm91bmQoblthXSooMS1zKStvW2FdKnMpKTtyZXR1cm4gaVszXT1yLHRoaXMuc2V0U291cmNlKGkpLHRoaXN9fSxyLkNvbG9yLnJlUkdCYT0vXnJnYmE/XFwoXFxzKihcXGR7MSwzfSg/OlxcLlxcZCspP1xcJT8pXFxzKixcXHMqKFxcZHsxLDN9KD86XFwuXFxkKyk/XFwlPylcXHMqLFxccyooXFxkezEsM30oPzpcXC5cXGQrKT9cXCU/KVxccyooPzpcXHMqLFxccyooXFxkKyg/OlxcLlxcZCspPylcXHMqKT9cXCkkLyxyLkNvbG9yLnJlSFNMYT0vXmhzbGE/XFwoXFxzKihcXGR7MSwzfSlcXHMqLFxccyooXFxkezEsM31cXCUpXFxzKixcXHMqKFxcZHsxLDN9XFwlKVxccyooPzpcXHMqLFxccyooXFxkKyg/OlxcLlxcZCspPylcXHMqKT9cXCkkLyxyLkNvbG9yLnJlSGV4PS9eIz8oWzAtOWEtZl17Nn18WzAtOWEtZl17M30pJC9pLHIuQ29sb3IuY29sb3JOYW1lTWFwPXthcXVhOlwiIzAwRkZGRlwiLGJsYWNrOlwiIzAwMDAwMFwiLGJsdWU6XCIjMDAwMEZGXCIsZnVjaHNpYTpcIiNGRjAwRkZcIixncmF5OlwiIzgwODA4MFwiLGdyZWVuOlwiIzAwODAwMFwiLGxpbWU6XCIjMDBGRjAwXCIsbWFyb29uOlwiIzgwMDAwMFwiLG5hdnk6XCIjMDAwMDgwXCIsb2xpdmU6XCIjODA4MDAwXCIsb3JhbmdlOlwiI0ZGQTUwMFwiLHB1cnBsZTpcIiM4MDAwODBcIixyZWQ6XCIjRkYwMDAwXCIsc2lsdmVyOlwiI0MwQzBDMFwiLHRlYWw6XCIjMDA4MDgwXCIsd2hpdGU6XCIjRkZGRkZGXCIseWVsbG93OlwiI0ZGRkYwMFwifSxyLkNvbG9yLmZyb21SZ2I9ZnVuY3Rpb24odCl7cmV0dXJuIGUuZnJvbVNvdXJjZShlLnNvdXJjZUZyb21SZ2IodCkpfSxyLkNvbG9yLnNvdXJjZUZyb21SZ2I9ZnVuY3Rpb24odCl7dmFyIGk9dC5tYXRjaChlLnJlUkdCYSk7aWYoaSl7dmFyIHI9cGFyc2VJbnQoaVsxXSwxMCkvKC8lJC8udGVzdChpWzFdKT8xMDA6MSkqKC8lJC8udGVzdChpWzFdKT8yNTU6MSkscz1wYXJzZUludChpWzJdLDEwKS8oLyUkLy50ZXN0KGlbMl0pPzEwMDoxKSooLyUkLy50ZXN0KGlbMl0pPzI1NToxKSxuPXBhcnNlSW50KGlbM10sMTApLygvJSQvLnRlc3QoaVszXSk/MTAwOjEpKigvJSQvLnRlc3QoaVszXSk/MjU1OjEpO3JldHVybltwYXJzZUludChyLDEwKSxwYXJzZUludChzLDEwKSxwYXJzZUludChuLDEwKSxpWzRdP3BhcnNlRmxvYXQoaVs0XSk6MV19fSxyLkNvbG9yLmZyb21SZ2JhPWUuZnJvbVJnYixyLkNvbG9yLmZyb21Ic2w9ZnVuY3Rpb24odCl7cmV0dXJuIGUuZnJvbVNvdXJjZShlLnNvdXJjZUZyb21Ic2wodCkpfSxyLkNvbG9yLnNvdXJjZUZyb21Ic2w9ZnVuY3Rpb24odCl7dmFyIHI9dC5tYXRjaChlLnJlSFNMYSk7aWYocil7dmFyIHMsbixvLGE9KHBhcnNlRmxvYXQoclsxXSklMzYwKzM2MCklMzYwLzM2MCxoPXBhcnNlRmxvYXQoclsyXSkvKC8lJC8udGVzdChyWzJdKT8xMDA6MSksYz1wYXJzZUZsb2F0KHJbM10pLygvJSQvLnRlc3QoclszXSk/MTAwOjEpO2lmKDA9PT1oKXM9bj1vPWM7ZWxzZXt2YXIgbD0uNT49Yz9jKihoKzEpOmMraC1jKmgsdT0yKmMtbDtzPWkodSxsLGErMS8zKSxuPWkodSxsLGEpLG89aSh1LGwsYS0xLzMpfXJldHVybltNYXRoLnJvdW5kKDI1NSpzKSxNYXRoLnJvdW5kKDI1NSpuKSxNYXRoLnJvdW5kKDI1NSpvKSxyWzRdP3BhcnNlRmxvYXQocls0XSk6MV19fSxyLkNvbG9yLmZyb21Ic2xhPWUuZnJvbUhzbCxyLkNvbG9yLmZyb21IZXg9ZnVuY3Rpb24odCl7cmV0dXJuIGUuZnJvbVNvdXJjZShlLnNvdXJjZUZyb21IZXgodCkpfSxyLkNvbG9yLnNvdXJjZUZyb21IZXg9ZnVuY3Rpb24odCl7aWYodC5tYXRjaChlLnJlSGV4KSl7dmFyIGk9dC5zbGljZSh0LmluZGV4T2YoXCIjXCIpKzEpLHI9Mz09PWkubGVuZ3RoLHM9cj9pLmNoYXJBdCgwKStpLmNoYXJBdCgwKTppLnN1YnN0cmluZygwLDIpLG49cj9pLmNoYXJBdCgxKStpLmNoYXJBdCgxKTppLnN1YnN0cmluZygyLDQpLG89cj9pLmNoYXJBdCgyKStpLmNoYXJBdCgyKTppLnN1YnN0cmluZyg0LDYpO3JldHVybltwYXJzZUludChzLDE2KSxwYXJzZUludChuLDE2KSxwYXJzZUludChvLDE2KSwxXX19LHZvaWQoci5Db2xvci5mcm9tU291cmNlPWZ1bmN0aW9uKHQpe3ZhciBpPW5ldyBlO3JldHVybiBpLnNldFNvdXJjZSh0KSxpfSkpfShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXt2YXIgZSxpLHIscz10LmdldEF0dHJpYnV0ZShcInN0eWxlXCIpLG49dC5nZXRBdHRyaWJ1dGUoXCJvZmZzZXRcIik7aWYobj1wYXJzZUZsb2F0KG4pLygvJSQvLnRlc3Qobik/MTAwOjEpLG49MD5uPzA6bj4xPzE6bixzKXt2YXIgbz1zLnNwbGl0KC9cXHMqO1xccyovKTtcIlwiPT09b1tvLmxlbmd0aC0xXSYmby5wb3AoKTtmb3IodmFyIGE9by5sZW5ndGg7YS0tOyl7dmFyIGg9b1thXS5zcGxpdCgvXFxzKjpcXHMqLyksYz1oWzBdLnRyaW0oKSxsPWhbMV0udHJpbSgpO1wic3RvcC1jb2xvclwiPT09Yz9lPWw6XCJzdG9wLW9wYWNpdHlcIj09PWMmJihyPWwpfX1yZXR1cm4gZXx8KGU9dC5nZXRBdHRyaWJ1dGUoXCJzdG9wLWNvbG9yXCIpfHxcInJnYigwLDAsMClcIikscnx8KHI9dC5nZXRBdHRyaWJ1dGUoXCJzdG9wLW9wYWNpdHlcIikpLGU9bmV3IGZhYnJpYy5Db2xvcihlKSxpPWUuZ2V0QWxwaGEoKSxyPWlzTmFOKHBhcnNlRmxvYXQocikpPzE6cGFyc2VGbG9hdChyKSxyKj1pLHtvZmZzZXQ6bixjb2xvcjplLnRvUmdiKCksb3BhY2l0eTpyfX1mdW5jdGlvbiBlKHQpe3JldHVybnt4MTp0LmdldEF0dHJpYnV0ZShcIngxXCIpfHwwLHkxOnQuZ2V0QXR0cmlidXRlKFwieTFcIil8fDAseDI6dC5nZXRBdHRyaWJ1dGUoXCJ4MlwiKXx8XCIxMDAlXCIseTI6dC5nZXRBdHRyaWJ1dGUoXCJ5MlwiKXx8MH19ZnVuY3Rpb24gaSh0KXtyZXR1cm57eDE6dC5nZXRBdHRyaWJ1dGUoXCJmeFwiKXx8dC5nZXRBdHRyaWJ1dGUoXCJjeFwiKXx8XCI1MCVcIix5MTp0LmdldEF0dHJpYnV0ZShcImZ5XCIpfHx0LmdldEF0dHJpYnV0ZShcImN5XCIpfHxcIjUwJVwiLHIxOjAseDI6dC5nZXRBdHRyaWJ1dGUoXCJjeFwiKXx8XCI1MCVcIix5Mjp0LmdldEF0dHJpYnV0ZShcImN5XCIpfHxcIjUwJVwiLHIyOnQuZ2V0QXR0cmlidXRlKFwiclwiKXx8XCI1MCVcIn19ZnVuY3Rpb24gcih0LGUsaSl7dmFyIHIscz0wLG49MSxvPVwiXCI7Zm9yKHZhciBhIGluIGUpcj1wYXJzZUZsb2F0KGVbYV0sMTApLG49XCJzdHJpbmdcIj09dHlwZW9mIGVbYV0mJi9eXFxkKyUkLy50ZXN0KGVbYV0pPy4wMToxLFwieDFcIj09PWF8fFwieDJcIj09PWF8fFwicjJcIj09PWE/KG4qPVwib2JqZWN0Qm91bmRpbmdCb3hcIj09PWk/dC53aWR0aDoxLHM9XCJvYmplY3RCb3VuZGluZ0JveFwiPT09aT90LmxlZnR8fDA6MCk6KFwieTFcIj09PWF8fFwieTJcIj09PWEpJiYobio9XCJvYmplY3RCb3VuZGluZ0JveFwiPT09aT90LmhlaWdodDoxLHM9XCJvYmplY3RCb3VuZGluZ0JveFwiPT09aT90LnRvcHx8MDowKSxlW2FdPXIqbitzO2lmKFwiZWxsaXBzZVwiPT09dC50eXBlJiZudWxsIT09ZS5yMiYmXCJvYmplY3RCb3VuZGluZ0JveFwiPT09aSYmdC5yeCE9PXQucnkpe3ZhciBoPXQucnkvdC5yeDtvPVwiIHNjYWxlKDEsIFwiK2grXCIpXCIsZS55MSYmKGUueTEvPWgpLGUueTImJihlLnkyLz1oKX1yZXR1cm4gb31mYWJyaWMuR3JhZGllbnQ9ZmFicmljLnV0aWwuY3JlYXRlQ2xhc3Moe29mZnNldFg6MCxvZmZzZXRZOjAsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0fHwodD17fSk7dmFyIGU9e307dGhpcy5pZD1mYWJyaWMuT2JqZWN0Ll9fdWlkKyssdGhpcy50eXBlPXQudHlwZXx8XCJsaW5lYXJcIixlPXt4MTp0LmNvb3Jkcy54MXx8MCx5MTp0LmNvb3Jkcy55MXx8MCx4Mjp0LmNvb3Jkcy54Mnx8MCx5Mjp0LmNvb3Jkcy55Mnx8MH0sXCJyYWRpYWxcIj09PXRoaXMudHlwZSYmKGUucjE9dC5jb29yZHMucjF8fDAsZS5yMj10LmNvb3Jkcy5yMnx8MCksdGhpcy5jb29yZHM9ZSx0aGlzLmNvbG9yU3RvcHM9dC5jb2xvclN0b3BzLnNsaWNlKCksdC5ncmFkaWVudFRyYW5zZm9ybSYmKHRoaXMuZ3JhZGllbnRUcmFuc2Zvcm09dC5ncmFkaWVudFRyYW5zZm9ybSksdGhpcy5vZmZzZXRYPXQub2Zmc2V0WHx8dGhpcy5vZmZzZXRYLHRoaXMub2Zmc2V0WT10Lm9mZnNldFl8fHRoaXMub2Zmc2V0WX0sYWRkQ29sb3JTdG9wOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZSBpbiB0KXt2YXIgaT1uZXcgZmFicmljLkNvbG9yKHRbZV0pO3RoaXMuY29sb3JTdG9wcy5wdXNoKHtvZmZzZXQ6ZSxjb2xvcjppLnRvUmdiKCksb3BhY2l0eTppLmdldEFscGhhKCl9KX1yZXR1cm4gdGhpc30sdG9PYmplY3Q6ZnVuY3Rpb24oKXtyZXR1cm57dHlwZTp0aGlzLnR5cGUsY29vcmRzOnRoaXMuY29vcmRzLGNvbG9yU3RvcHM6dGhpcy5jb2xvclN0b3BzLG9mZnNldFg6dGhpcy5vZmZzZXRYLG9mZnNldFk6dGhpcy5vZmZzZXRZfX0sdG9TVkc6ZnVuY3Rpb24odCl7dmFyIGUsaSxyPWZhYnJpYy51dGlsLm9iamVjdC5jbG9uZSh0aGlzLmNvb3Jkcyk7aWYodGhpcy5jb2xvclN0b3BzLnNvcnQoZnVuY3Rpb24odCxlKXtyZXR1cm4gdC5vZmZzZXQtZS5vZmZzZXR9KSwhdC5ncm91cHx8XCJwYXRoLWdyb3VwXCIhPT10Lmdyb3VwLnR5cGUpZm9yKHZhciBzIGluIHIpXCJ4MVwiPT09c3x8XCJ4MlwiPT09c3x8XCJyMlwiPT09cz9yW3NdKz10aGlzLm9mZnNldFgtdC53aWR0aC8yOihcInkxXCI9PT1zfHxcInkyXCI9PT1zKSYmKHJbc10rPXRoaXMub2Zmc2V0WS10LmhlaWdodC8yKTtpPSdpZD1cIlNWR0lEXycrdGhpcy5pZCsnXCIgZ3JhZGllbnRVbml0cz1cInVzZXJTcGFjZU9uVXNlXCInLHRoaXMuZ3JhZGllbnRUcmFuc2Zvcm0mJihpKz0nIGdyYWRpZW50VHJhbnNmb3JtPVwibWF0cml4KCcrdGhpcy5ncmFkaWVudFRyYW5zZm9ybS5qb2luKFwiIFwiKSsnKVwiICcpLFwibGluZWFyXCI9PT10aGlzLnR5cGU/ZT1bXCI8bGluZWFyR3JhZGllbnQgXCIsaSwnIHgxPVwiJyxyLngxLCdcIiB5MT1cIicsci55MSwnXCIgeDI9XCInLHIueDIsJ1wiIHkyPVwiJyxyLnkyLCdcIj5cXG4nXTpcInJhZGlhbFwiPT09dGhpcy50eXBlJiYoZT1bXCI8cmFkaWFsR3JhZGllbnQgXCIsaSwnIGN4PVwiJyxyLngyLCdcIiBjeT1cIicsci55MiwnXCIgcj1cIicsci5yMiwnXCIgZng9XCInLHIueDEsJ1wiIGZ5PVwiJyxyLnkxLCdcIj5cXG4nXSk7Zm9yKHZhciBuPTA7bjx0aGlzLmNvbG9yU3RvcHMubGVuZ3RoO24rKyllLnB1c2goXCI8c3RvcCBcIiwnb2Zmc2V0PVwiJywxMDAqdGhpcy5jb2xvclN0b3BzW25dLm9mZnNldCtcIiVcIiwnXCIgc3R5bGU9XCJzdG9wLWNvbG9yOicsdGhpcy5jb2xvclN0b3BzW25dLmNvbG9yLG51bGwhPXRoaXMuY29sb3JTdG9wc1tuXS5vcGFjaXR5P1wiO3N0b3Atb3BhY2l0eTogXCIrdGhpcy5jb2xvclN0b3BzW25dLm9wYWNpdHk6XCI7XCIsJ1wiLz5cXG4nKTtyZXR1cm4gZS5wdXNoKFwibGluZWFyXCI9PT10aGlzLnR5cGU/XCI8L2xpbmVhckdyYWRpZW50PlxcblwiOlwiPC9yYWRpYWxHcmFkaWVudD5cXG5cIiksZS5qb2luKFwiXCIpfSx0b0xpdmU6ZnVuY3Rpb24odCxlKXt2YXIgaSxyLHM9ZmFicmljLnV0aWwub2JqZWN0LmNsb25lKHRoaXMuY29vcmRzKTtpZih0aGlzLnR5cGUpe2lmKGUuZ3JvdXAmJlwicGF0aC1ncm91cFwiPT09ZS5ncm91cC50eXBlKWZvcihyIGluIHMpXCJ4MVwiPT09cnx8XCJ4MlwiPT09cj9zW3JdKz0tdGhpcy5vZmZzZXRYK2Uud2lkdGgvMjooXCJ5MVwiPT09cnx8XCJ5MlwiPT09cikmJihzW3JdKz0tdGhpcy5vZmZzZXRZK2UuaGVpZ2h0LzIpO1wibGluZWFyXCI9PT10aGlzLnR5cGU/aT10LmNyZWF0ZUxpbmVhckdyYWRpZW50KHMueDEscy55MSxzLngyLHMueTIpOlwicmFkaWFsXCI9PT10aGlzLnR5cGUmJihpPXQuY3JlYXRlUmFkaWFsR3JhZGllbnQocy54MSxzLnkxLHMucjEscy54MixzLnkyLHMucjIpKTtmb3IodmFyIG49MCxvPXRoaXMuY29sb3JTdG9wcy5sZW5ndGg7bz5uO24rKyl7dmFyIGE9dGhpcy5jb2xvclN0b3BzW25dLmNvbG9yLGg9dGhpcy5jb2xvclN0b3BzW25dLm9wYWNpdHksYz10aGlzLmNvbG9yU3RvcHNbbl0ub2Zmc2V0O1widW5kZWZpbmVkXCIhPXR5cGVvZiBoJiYoYT1uZXcgZmFicmljLkNvbG9yKGEpLnNldEFscGhhKGgpLnRvUmdiYSgpKSxpLmFkZENvbG9yU3RvcChwYXJzZUZsb2F0KGMpLGEpfXJldHVybiBpfX19KSxmYWJyaWMudXRpbC5vYmplY3QuZXh0ZW5kKGZhYnJpYy5HcmFkaWVudCx7ZnJvbUVsZW1lbnQ6ZnVuY3Rpb24ocyxuKXt2YXIgbyxhPXMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzdG9wXCIpLGg9XCJsaW5lYXJHcmFkaWVudFwiPT09cy5ub2RlTmFtZT9cImxpbmVhclwiOlwicmFkaWFsXCIsYz1zLmdldEF0dHJpYnV0ZShcImdyYWRpZW50VW5pdHNcIil8fFwib2JqZWN0Qm91bmRpbmdCb3hcIixsPXMuZ2V0QXR0cmlidXRlKFwiZ3JhZGllbnRUcmFuc2Zvcm1cIiksdT1bXSxmPXt9O1wibGluZWFyXCI9PT1oP2Y9ZShzKTpcInJhZGlhbFwiPT09aCYmKGY9aShzKSk7Zm9yKHZhciBkPWEubGVuZ3RoO2QtLTspdS5wdXNoKHQoYVtkXSkpO289cihuLGYsYyk7dmFyIGc9bmV3IGZhYnJpYy5HcmFkaWVudCh7dHlwZTpoLGNvb3JkczpmLGNvbG9yU3RvcHM6dSxvZmZzZXRYOi1uLmxlZnQsb2Zmc2V0WTotbi50b3B9KTtyZXR1cm4obHx8XCJcIiE9PW8pJiYoZy5ncmFkaWVudFRyYW5zZm9ybT1mYWJyaWMucGFyc2VUcmFuc2Zvcm1BdHRyaWJ1dGUoKGx8fFwiXCIpK28pKSxnfSxmb3JPYmplY3Q6ZnVuY3Rpb24odCxlKXtyZXR1cm4gZXx8KGU9e30pLHIodCxlLmNvb3JkcyxcInVzZXJTcGFjZU9uVXNlXCIpLG5ldyBmYWJyaWMuR3JhZGllbnQoZSl9fSl9KCksZmFicmljLlBhdHRlcm49ZmFicmljLnV0aWwuY3JlYXRlQ2xhc3Moe3JlcGVhdDpcInJlcGVhdFwiLG9mZnNldFg6MCxvZmZzZXRZOjAsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXtpZih0fHwodD17fSksdGhpcy5pZD1mYWJyaWMuT2JqZWN0Ll9fdWlkKyssdC5zb3VyY2UpaWYoXCJzdHJpbmdcIj09dHlwZW9mIHQuc291cmNlKWlmKFwidW5kZWZpbmVkXCIhPXR5cGVvZiBmYWJyaWMudXRpbC5nZXRGdW5jdGlvbkJvZHkodC5zb3VyY2UpKXRoaXMuc291cmNlPW5ldyBGdW5jdGlvbihmYWJyaWMudXRpbC5nZXRGdW5jdGlvbkJvZHkodC5zb3VyY2UpKTtlbHNle3ZhciBlPXRoaXM7dGhpcy5zb3VyY2U9ZmFicmljLnV0aWwuY3JlYXRlSW1hZ2UoKSxmYWJyaWMudXRpbC5sb2FkSW1hZ2UodC5zb3VyY2UsZnVuY3Rpb24odCl7ZS5zb3VyY2U9dH0pfWVsc2UgdGhpcy5zb3VyY2U9dC5zb3VyY2U7dC5yZXBlYXQmJih0aGlzLnJlcGVhdD10LnJlcGVhdCksdC5vZmZzZXRYJiYodGhpcy5vZmZzZXRYPXQub2Zmc2V0WCksdC5vZmZzZXRZJiYodGhpcy5vZmZzZXRZPXQub2Zmc2V0WSl9LHRvT2JqZWN0OmZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuXCJmdW5jdGlvblwiPT10eXBlb2YgdGhpcy5zb3VyY2U/dD1TdHJpbmcodGhpcy5zb3VyY2UpOlwic3RyaW5nXCI9PXR5cGVvZiB0aGlzLnNvdXJjZS5zcmMmJih0PXRoaXMuc291cmNlLnNyYykse3NvdXJjZTp0LHJlcGVhdDp0aGlzLnJlcGVhdCxvZmZzZXRYOnRoaXMub2Zmc2V0WCxvZmZzZXRZOnRoaXMub2Zmc2V0WX19LHRvU1ZHOmZ1bmN0aW9uKHQpe3ZhciBlPVwiZnVuY3Rpb25cIj09dHlwZW9mIHRoaXMuc291cmNlP3RoaXMuc291cmNlKCk6dGhpcy5zb3VyY2UsaT1lLndpZHRoL3QuZ2V0V2lkdGgoKSxyPWUuaGVpZ2h0L3QuZ2V0SGVpZ2h0KCkscz10aGlzLm9mZnNldFgvdC5nZXRXaWR0aCgpLG49dGhpcy5vZmZzZXRZL3QuZ2V0SGVpZ2h0KCksbz1cIlwiO3JldHVybihcInJlcGVhdC14XCI9PT10aGlzLnJlcGVhdHx8XCJuby1yZXBlYXRcIj09PXRoaXMucmVwZWF0KSYmKHI9MSksKFwicmVwZWF0LXlcIj09PXRoaXMucmVwZWF0fHxcIm5vLXJlcGVhdFwiPT09dGhpcy5yZXBlYXQpJiYoaT0xKSxlLnNyYz9vPWUuc3JjOmUudG9EYXRhVVJMJiYobz1lLnRvRGF0YVVSTCgpKSwnPHBhdHRlcm4gaWQ9XCJTVkdJRF8nK3RoaXMuaWQrJ1wiIHg9XCInK3MrJ1wiIHk9XCInK24rJ1wiIHdpZHRoPVwiJytpKydcIiBoZWlnaHQ9XCInK3IrJ1wiPlxcbjxpbWFnZSB4PVwiMFwiIHk9XCIwXCIgd2lkdGg9XCInK2Uud2lkdGgrJ1wiIGhlaWdodD1cIicrZS5oZWlnaHQrJ1wiIHhsaW5rOmhyZWY9XCInK28rJ1wiPjwvaW1hZ2U+XFxuPC9wYXR0ZXJuPlxcbid9LHRvTGl2ZTpmdW5jdGlvbih0KXt2YXIgZT1cImZ1bmN0aW9uXCI9PXR5cGVvZiB0aGlzLnNvdXJjZT90aGlzLnNvdXJjZSgpOnRoaXMuc291cmNlO2lmKCFlKXJldHVyblwiXCI7aWYoXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGUuc3JjKXtpZighZS5jb21wbGV0ZSlyZXR1cm5cIlwiO2lmKDA9PT1lLm5hdHVyYWxXaWR0aHx8MD09PWUubmF0dXJhbEhlaWdodClyZXR1cm5cIlwifXJldHVybiB0LmNyZWF0ZVBhdHRlcm4oZSx0aGlzLnJlcGVhdCl9fSksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSksaT1lLnV0aWwudG9GaXhlZDtyZXR1cm4gZS5TaGFkb3c/dm9pZCBlLndhcm4oXCJmYWJyaWMuU2hhZG93IGlzIGFscmVhZHkgZGVmaW5lZC5cIik6KGUuU2hhZG93PWUudXRpbC5jcmVhdGVDbGFzcyh7Y29sb3I6XCJyZ2IoMCwwLDApXCIsYmx1cjowLG9mZnNldFg6MCxvZmZzZXRZOjAsYWZmZWN0U3Ryb2tlOiExLGluY2x1ZGVEZWZhdWx0VmFsdWVzOiEwLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7XCJzdHJpbmdcIj09dHlwZW9mIHQmJih0PXRoaXMuX3BhcnNlU2hhZG93KHQpKTtmb3IodmFyIGkgaW4gdCl0aGlzW2ldPXRbaV07dGhpcy5pZD1lLk9iamVjdC5fX3VpZCsrfSxfcGFyc2VTaGFkb3c6ZnVuY3Rpb24odCl7dmFyIGk9dC50cmltKCkscj1lLlNoYWRvdy5yZU9mZnNldHNBbmRCbHVyLmV4ZWMoaSl8fFtdLHM9aS5yZXBsYWNlKGUuU2hhZG93LnJlT2Zmc2V0c0FuZEJsdXIsXCJcIil8fFwicmdiKDAsMCwwKVwiO3JldHVybntjb2xvcjpzLnRyaW0oKSxvZmZzZXRYOnBhcnNlSW50KHJbMV0sMTApfHwwLG9mZnNldFk6cGFyc2VJbnQoclsyXSwxMCl8fDAsYmx1cjpwYXJzZUludChyWzNdLDEwKXx8MH19LHRvU3RyaW5nOmZ1bmN0aW9uKCl7cmV0dXJuW3RoaXMub2Zmc2V0WCx0aGlzLm9mZnNldFksdGhpcy5ibHVyLHRoaXMuY29sb3JdLmpvaW4oXCJweCBcIil9LHRvU1ZHOmZ1bmN0aW9uKHQpe3ZhciBlPVwiU291cmNlQWxwaGFcIixyPTQwLHM9NDA7cmV0dXJuIXR8fHQuZmlsbCE9PXRoaXMuY29sb3ImJnQuc3Ryb2tlIT09dGhpcy5jb2xvcnx8KGU9XCJTb3VyY2VHcmFwaGljXCIpLHQud2lkdGgmJnQuaGVpZ2h0JiYocj0xMDAqaShNYXRoLmFicyh0aGlzLm9mZnNldFgvdC5nZXRXaWR0aCgpKSwyKSsyMCxzPTEwMCppKE1hdGguYWJzKHRoaXMub2Zmc2V0WS90LmdldEhlaWdodCgpKSwyKSsyMCksJzxmaWx0ZXIgaWQ9XCJTVkdJRF8nK3RoaXMuaWQrJ1wiIHk9XCItJytzKyclXCIgaGVpZ2h0PVwiJysoMTAwKzIqcykrJyVcIiB4PVwiLScrcisnJVwiIHdpZHRoPVwiJysoMTAwKzIqcikrJyVcIiA+XFxuXHQ8ZmVHYXVzc2lhbkJsdXIgaW49XCInK2UrJ1wiIHN0ZERldmlhdGlvbj1cIicraSh0aGlzLmJsdXI/dGhpcy5ibHVyLzI6MCwzKSsnXCIgcmVzdWx0PVwiYmx1ck91dFwiPjwvZmVHYXVzc2lhbkJsdXI+XFxuXHQ8ZmVDb2xvck1hdHJpeCByZXN1bHQ9XCJtYXRyaXhPdXRcIiBpbj1cImJsdXJPdXRcIiB0eXBlPVwibWF0cml4XCIgdmFsdWVzPVwiMSAwIDAgMCAwIDAgMSAwIDAgMCAwIDAgMSAwIDAgMCAwIDAgMC4zMCAwXCIgPjwvZmVDb2xvck1hdHJpeCA+XFxuXHQ8ZmVPZmZzZXQgZHg9XCInK3RoaXMub2Zmc2V0WCsnXCIgZHk9XCInK3RoaXMub2Zmc2V0WSsnXCI+PC9mZU9mZnNldD5cXG5cdDxmZU1lcmdlPlxcblx0XHQ8ZmVNZXJnZU5vZGU+PC9mZU1lcmdlTm9kZT5cXG5cdFx0PGZlTWVyZ2VOb2RlIGluPVwiU291cmNlR3JhcGhpY1wiPjwvZmVNZXJnZU5vZGU+XFxuXHQ8L2ZlTWVyZ2U+XFxuPC9maWx0ZXI+XFxuJ30sdG9PYmplY3Q6ZnVuY3Rpb24oKXtpZih0aGlzLmluY2x1ZGVEZWZhdWx0VmFsdWVzKXJldHVybntjb2xvcjp0aGlzLmNvbG9yLGJsdXI6dGhpcy5ibHVyLG9mZnNldFg6dGhpcy5vZmZzZXRYLG9mZnNldFk6dGhpcy5vZmZzZXRZfTt2YXIgdD17fSxpPWUuU2hhZG93LnByb3RvdHlwZTtyZXR1cm4gdGhpcy5jb2xvciE9PWkuY29sb3ImJih0LmNvbG9yPXRoaXMuY29sb3IpLHRoaXMuYmx1ciE9PWkuYmx1ciYmKHQuYmx1cj10aGlzLmJsdXIpLHRoaXMub2Zmc2V0WCE9PWkub2Zmc2V0WCYmKHQub2Zmc2V0WD10aGlzLm9mZnNldFgpLHRoaXMub2Zmc2V0WSE9PWkub2Zmc2V0WSYmKHQub2Zmc2V0WT10aGlzLm9mZnNldFkpLHR9fSksdm9pZChlLlNoYWRvdy5yZU9mZnNldHNBbmRCbHVyPS8oPzpcXHN8XikoLT9cXGQrKD86cHgpPyg/Olxccz98JCkpPygtP1xcZCsoPzpweCk/KD86XFxzP3wkKSk/KFxcZCsoPzpweCk/KT8oPzpcXHM/fCQpKD86JHxcXHMpLykpfShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKCl7XCJ1c2Ugc3RyaWN0XCI7aWYoZmFicmljLlN0YXRpY0NhbnZhcylyZXR1cm4gdm9pZCBmYWJyaWMud2FybihcImZhYnJpYy5TdGF0aWNDYW52YXMgaXMgYWxyZWFkeSBkZWZpbmVkLlwiKTt2YXIgdD1mYWJyaWMudXRpbC5vYmplY3QuZXh0ZW5kLGU9ZmFicmljLnV0aWwuZ2V0RWxlbWVudE9mZnNldCxpPWZhYnJpYy51dGlsLnJlbW92ZUZyb21BcnJheSxyPW5ldyBFcnJvcihcIkNvdWxkIG5vdCBpbml0aWFsaXplIGBjYW52YXNgIGVsZW1lbnRcIik7ZmFicmljLlN0YXRpY0NhbnZhcz1mYWJyaWMudXRpbC5jcmVhdGVDbGFzcyh7aW5pdGlhbGl6ZTpmdW5jdGlvbih0LGUpe2V8fChlPXt9KSx0aGlzLl9pbml0U3RhdGljKHQsZSksZmFicmljLlN0YXRpY0NhbnZhcy5hY3RpdmVJbnN0YW5jZT10aGlzfSxiYWNrZ3JvdW5kQ29sb3I6XCJcIixiYWNrZ3JvdW5kSW1hZ2U6bnVsbCxvdmVybGF5Q29sb3I6XCJcIixvdmVybGF5SW1hZ2U6bnVsbCxpbmNsdWRlRGVmYXVsdFZhbHVlczohMCxzdGF0ZWZ1bDohMCxyZW5kZXJPbkFkZFJlbW92ZTohMCxjbGlwVG86bnVsbCxjb250cm9sc0Fib3ZlT3ZlcmxheTohMSxhbGxvd1RvdWNoU2Nyb2xsaW5nOiExLGltYWdlU21vb3RoaW5nRW5hYmxlZDohMCxwcmVzZXJ2ZU9iamVjdFN0YWNraW5nOiExLHZpZXdwb3J0VHJhbnNmb3JtOlsxLDAsMCwxLDAsMF0sb25CZWZvcmVTY2FsZVJvdGF0ZTpmdW5jdGlvbigpe30sX2luaXRTdGF0aWM6ZnVuY3Rpb24odCxlKXt0aGlzLl9vYmplY3RzPVtdLHRoaXMuX2NyZWF0ZUxvd2VyQ2FudmFzKHQpLHRoaXMuX2luaXRPcHRpb25zKGUpLHRoaXMuX3NldEltYWdlU21vb3RoaW5nKCksZS5vdmVybGF5SW1hZ2UmJnRoaXMuc2V0T3ZlcmxheUltYWdlKGUub3ZlcmxheUltYWdlLHRoaXMucmVuZGVyQWxsLmJpbmQodGhpcykpLGUuYmFja2dyb3VuZEltYWdlJiZ0aGlzLnNldEJhY2tncm91bmRJbWFnZShlLmJhY2tncm91bmRJbWFnZSx0aGlzLnJlbmRlckFsbC5iaW5kKHRoaXMpKSxlLmJhY2tncm91bmRDb2xvciYmdGhpcy5zZXRCYWNrZ3JvdW5kQ29sb3IoZS5iYWNrZ3JvdW5kQ29sb3IsdGhpcy5yZW5kZXJBbGwuYmluZCh0aGlzKSksZS5vdmVybGF5Q29sb3ImJnRoaXMuc2V0T3ZlcmxheUNvbG9yKGUub3ZlcmxheUNvbG9yLHRoaXMucmVuZGVyQWxsLmJpbmQodGhpcykpLHRoaXMuY2FsY09mZnNldCgpfSxjYWxjT2Zmc2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29mZnNldD1lKHRoaXMubG93ZXJDYW52YXNFbCksdGhpc30sc2V0T3ZlcmxheUltYWdlOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdGhpcy5fX3NldEJnT3ZlcmxheUltYWdlKFwib3ZlcmxheUltYWdlXCIsdCxlLGkpfSxzZXRCYWNrZ3JvdW5kSW1hZ2U6ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0aGlzLl9fc2V0QmdPdmVybGF5SW1hZ2UoXCJiYWNrZ3JvdW5kSW1hZ2VcIix0LGUsaSl9LHNldE92ZXJsYXlDb2xvcjpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLl9fc2V0QmdPdmVybGF5Q29sb3IoXCJvdmVybGF5Q29sb3JcIix0LGUpfSxzZXRCYWNrZ3JvdW5kQ29sb3I6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5fX3NldEJnT3ZlcmxheUNvbG9yKFwiYmFja2dyb3VuZENvbG9yXCIsdCxlKX0sX3NldEltYWdlU21vb3RoaW5nOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXRDb250ZXh0KCk7dC5pbWFnZVNtb290aGluZ0VuYWJsZWQ9dGhpcy5pbWFnZVNtb290aGluZ0VuYWJsZWQsdC53ZWJraXRJbWFnZVNtb290aGluZ0VuYWJsZWQ9dGhpcy5pbWFnZVNtb290aGluZ0VuYWJsZWQsdC5tb3pJbWFnZVNtb290aGluZ0VuYWJsZWQ9dGhpcy5pbWFnZVNtb290aGluZ0VuYWJsZWQsdC5tc0ltYWdlU21vb3RoaW5nRW5hYmxlZD10aGlzLmltYWdlU21vb3RoaW5nRW5hYmxlZCx0Lm9JbWFnZVNtb290aGluZ0VuYWJsZWQ9dGhpcy5pbWFnZVNtb290aGluZ0VuYWJsZWR9LF9fc2V0QmdPdmVybGF5SW1hZ2U6ZnVuY3Rpb24odCxlLGkscil7cmV0dXJuXCJzdHJpbmdcIj09dHlwZW9mIGU/ZmFicmljLnV0aWwubG9hZEltYWdlKGUsZnVuY3Rpb24oZSl7dGhpc1t0XT1uZXcgZmFicmljLkltYWdlKGUsciksaSYmaSgpfSx0aGlzLHImJnIuY3Jvc3NPcmlnaW4pOihyJiZlLnNldE9wdGlvbnMociksdGhpc1t0XT1lLGkmJmkoKSksdGhpc30sX19zZXRCZ092ZXJsYXlDb2xvcjpmdW5jdGlvbih0LGUsaSl7aWYoZSYmZS5zb3VyY2Upe3ZhciByPXRoaXM7ZmFicmljLnV0aWwubG9hZEltYWdlKGUuc291cmNlLGZ1bmN0aW9uKHMpe3JbdF09bmV3IGZhYnJpYy5QYXR0ZXJuKHtzb3VyY2U6cyxyZXBlYXQ6ZS5yZXBlYXQsb2Zmc2V0WDplLm9mZnNldFgsb2Zmc2V0WTplLm9mZnNldFl9KSxpJiZpKCl9KX1lbHNlIHRoaXNbdF09ZSxpJiZpKCk7cmV0dXJuIHRoaXN9LF9jcmVhdGVDYW52YXNFbGVtZW50OmZ1bmN0aW9uKCl7dmFyIHQ9ZmFicmljLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7aWYodC5zdHlsZXx8KHQuc3R5bGU9e30pLCF0KXRocm93IHI7cmV0dXJuIHRoaXMuX2luaXRDYW52YXNFbGVtZW50KHQpLHR9LF9pbml0Q2FudmFzRWxlbWVudDpmdW5jdGlvbih0KXtpZihmYWJyaWMudXRpbC5jcmVhdGVDYW52YXNFbGVtZW50KHQpLFwidW5kZWZpbmVkXCI9PXR5cGVvZiB0LmdldENvbnRleHQpdGhyb3cgcn0sX2luaXRPcHRpb25zOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZSBpbiB0KXRoaXNbZV09dFtlXTt0aGlzLndpZHRoPXRoaXMud2lkdGh8fHBhcnNlSW50KHRoaXMubG93ZXJDYW52YXNFbC53aWR0aCwxMCl8fDAsdGhpcy5oZWlnaHQ9dGhpcy5oZWlnaHR8fHBhcnNlSW50KHRoaXMubG93ZXJDYW52YXNFbC5oZWlnaHQsMTApfHwwLHRoaXMubG93ZXJDYW52YXNFbC5zdHlsZSYmKHRoaXMubG93ZXJDYW52YXNFbC53aWR0aD10aGlzLndpZHRoLHRoaXMubG93ZXJDYW52YXNFbC5oZWlnaHQ9dGhpcy5oZWlnaHQsdGhpcy5sb3dlckNhbnZhc0VsLnN0eWxlLndpZHRoPXRoaXMud2lkdGgrXCJweFwiLHRoaXMubG93ZXJDYW52YXNFbC5zdHlsZS5oZWlnaHQ9dGhpcy5oZWlnaHQrXCJweFwiLHRoaXMudmlld3BvcnRUcmFuc2Zvcm09dGhpcy52aWV3cG9ydFRyYW5zZm9ybS5zbGljZSgpKX0sX2NyZWF0ZUxvd2VyQ2FudmFzOmZ1bmN0aW9uKHQpe3RoaXMubG93ZXJDYW52YXNFbD1mYWJyaWMudXRpbC5nZXRCeUlkKHQpfHx0aGlzLl9jcmVhdGVDYW52YXNFbGVtZW50KCksdGhpcy5faW5pdENhbnZhc0VsZW1lbnQodGhpcy5sb3dlckNhbnZhc0VsKSxmYWJyaWMudXRpbC5hZGRDbGFzcyh0aGlzLmxvd2VyQ2FudmFzRWwsXCJsb3dlci1jYW52YXNcIiksdGhpcy5pbnRlcmFjdGl2ZSYmdGhpcy5fYXBwbHlDYW52YXNTdHlsZSh0aGlzLmxvd2VyQ2FudmFzRWwpLHRoaXMuY29udGV4dENvbnRhaW5lcj10aGlzLmxvd2VyQ2FudmFzRWwuZ2V0Q29udGV4dChcIjJkXCIpfSxnZXRXaWR0aDpmdW5jdGlvbigpe3JldHVybiB0aGlzLndpZHRofSxnZXRIZWlnaHQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oZWlnaHR9LHNldFdpZHRoOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuc2V0RGltZW5zaW9ucyh7d2lkdGg6dH0sZSl9LHNldEhlaWdodDpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLnNldERpbWVuc2lvbnMoe2hlaWdodDp0fSxlKX0sc2V0RGltZW5zaW9uczpmdW5jdGlvbih0LGUpe3ZhciBpO2U9ZXx8e307Zm9yKHZhciByIGluIHQpaT10W3JdLGUuY3NzT25seXx8KHRoaXMuX3NldEJhY2tzdG9yZURpbWVuc2lvbihyLHRbcl0pLGkrPVwicHhcIiksZS5iYWNrc3RvcmVPbmx5fHx0aGlzLl9zZXRDc3NEaW1lbnNpb24ocixpKTtyZXR1cm4gZS5jc3NPbmx5fHx0aGlzLnJlbmRlckFsbCgpLHRoaXMuY2FsY09mZnNldCgpLHRoaXN9LF9zZXRCYWNrc3RvcmVEaW1lbnNpb246ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5sb3dlckNhbnZhc0VsW3RdPWUsdGhpcy51cHBlckNhbnZhc0VsJiYodGhpcy51cHBlckNhbnZhc0VsW3RdPWUpLHRoaXMuY2FjaGVDYW52YXNFbCYmKHRoaXMuY2FjaGVDYW52YXNFbFt0XT1lKSx0aGlzW3RdPWUsdGhpc30sX3NldENzc0RpbWVuc2lvbjpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLmxvd2VyQ2FudmFzRWwuc3R5bGVbdF09ZSx0aGlzLnVwcGVyQ2FudmFzRWwmJih0aGlzLnVwcGVyQ2FudmFzRWwuc3R5bGVbdF09ZSksdGhpcy53cmFwcGVyRWwmJih0aGlzLndyYXBwZXJFbC5zdHlsZVt0XT1lKSx0aGlzfSxnZXRab29tOmZ1bmN0aW9uKCl7cmV0dXJuIE1hdGguc3FydCh0aGlzLnZpZXdwb3J0VHJhbnNmb3JtWzBdKnRoaXMudmlld3BvcnRUcmFuc2Zvcm1bM10pfSxzZXRWaWV3cG9ydFRyYW5zZm9ybTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldEFjdGl2ZUdyb3VwKCk7dGhpcy52aWV3cG9ydFRyYW5zZm9ybT10LHRoaXMucmVuZGVyQWxsKCk7Zm9yKHZhciBpPTAscj10aGlzLl9vYmplY3RzLmxlbmd0aDtyPmk7aSsrKXRoaXMuX29iamVjdHNbaV0uc2V0Q29vcmRzKCk7cmV0dXJuIGUmJmUuc2V0Q29vcmRzKCksdGhpc30sem9vbVRvUG9pbnQ6ZnVuY3Rpb24odCxlKXt2YXIgaT10O3Q9ZmFicmljLnV0aWwudHJhbnNmb3JtUG9pbnQodCxmYWJyaWMudXRpbC5pbnZlcnRUcmFuc2Zvcm0odGhpcy52aWV3cG9ydFRyYW5zZm9ybSkpLHRoaXMudmlld3BvcnRUcmFuc2Zvcm1bMF09ZSx0aGlzLnZpZXdwb3J0VHJhbnNmb3JtWzNdPWU7dmFyIHI9ZmFicmljLnV0aWwudHJhbnNmb3JtUG9pbnQodCx0aGlzLnZpZXdwb3J0VHJhbnNmb3JtKTt0aGlzLnZpZXdwb3J0VHJhbnNmb3JtWzRdKz1pLngtci54LHRoaXMudmlld3BvcnRUcmFuc2Zvcm1bNV0rPWkueS1yLnksdGhpcy5yZW5kZXJBbGwoKTtmb3IodmFyIHM9MCxuPXRoaXMuX29iamVjdHMubGVuZ3RoO24+cztzKyspdGhpcy5fb2JqZWN0c1tzXS5zZXRDb29yZHMoKTtyZXR1cm4gdGhpc30sc2V0Wm9vbTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy56b29tVG9Qb2ludChuZXcgZmFicmljLlBvaW50KDAsMCksdCksdGhpc30sYWJzb2x1dGVQYW46ZnVuY3Rpb24odCl7dGhpcy52aWV3cG9ydFRyYW5zZm9ybVs0XT0tdC54LHRoaXMudmlld3BvcnRUcmFuc2Zvcm1bNV09LXQueSx0aGlzLnJlbmRlckFsbCgpO2Zvcih2YXIgZT0wLGk9dGhpcy5fb2JqZWN0cy5sZW5ndGg7aT5lO2UrKyl0aGlzLl9vYmplY3RzW2VdLnNldENvb3JkcygpO3JldHVybiB0aGlzfSxyZWxhdGl2ZVBhbjpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5hYnNvbHV0ZVBhbihuZXcgZmFicmljLlBvaW50KC10LngtdGhpcy52aWV3cG9ydFRyYW5zZm9ybVs0XSwtdC55LXRoaXMudmlld3BvcnRUcmFuc2Zvcm1bNV0pKX0sZ2V0RWxlbWVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmxvd2VyQ2FudmFzRWx9LGdldEFjdGl2ZU9iamVjdDpmdW5jdGlvbigpe3JldHVybiBudWxsfSxnZXRBY3RpdmVHcm91cDpmdW5jdGlvbigpe3JldHVybiBudWxsfSxfZHJhdzpmdW5jdGlvbih0LGUpe2lmKGUpe3Quc2F2ZSgpO3ZhciBpPXRoaXMudmlld3BvcnRUcmFuc2Zvcm07dC50cmFuc2Zvcm0oaVswXSxpWzFdLGlbMl0saVszXSxpWzRdLGlbNV0pLHRoaXMuX3Nob3VsZFJlbmRlck9iamVjdChlKSYmZS5yZW5kZXIodCksdC5yZXN0b3JlKCksdGhpcy5jb250cm9sc0Fib3ZlT3ZlcmxheXx8ZS5fcmVuZGVyQ29udHJvbHModCl9fSxfc2hvdWxkUmVuZGVyT2JqZWN0OmZ1bmN0aW9uKHQpe3JldHVybiB0P3QhPT10aGlzLmdldEFjdGl2ZUdyb3VwKCl8fCF0aGlzLnByZXNlcnZlT2JqZWN0U3RhY2tpbmc6ITF9LF9vbk9iamVjdEFkZGVkOmZ1bmN0aW9uKHQpe3RoaXMuc3RhdGVmdWwmJnQuc2V0dXBTdGF0ZSgpLHQuX3NldChcImNhbnZhc1wiLHRoaXMpLHQuc2V0Q29vcmRzKCksdGhpcy5maXJlKFwib2JqZWN0OmFkZGVkXCIse3RhcmdldDp0fSksdC5maXJlKFwiYWRkZWRcIil9LF9vbk9iamVjdFJlbW92ZWQ6ZnVuY3Rpb24odCl7dGhpcy5nZXRBY3RpdmVPYmplY3QoKT09PXQmJih0aGlzLmZpcmUoXCJiZWZvcmU6c2VsZWN0aW9uOmNsZWFyZWRcIix7dGFyZ2V0OnR9KSx0aGlzLl9kaXNjYXJkQWN0aXZlT2JqZWN0KCksdGhpcy5maXJlKFwic2VsZWN0aW9uOmNsZWFyZWRcIikpLHRoaXMuZmlyZShcIm9iamVjdDpyZW1vdmVkXCIse3RhcmdldDp0fSksdC5maXJlKFwicmVtb3ZlZFwiKX0sY2xlYXJDb250ZXh0OmZ1bmN0aW9uKHQpe3JldHVybiB0LmNsZWFyUmVjdCgwLDAsdGhpcy53aWR0aCx0aGlzLmhlaWdodCksdGhpc30sZ2V0Q29udGV4dDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnRleHRDb250YWluZXJ9LGNsZWFyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29iamVjdHMubGVuZ3RoPTAsdGhpcy5kaXNjYXJkQWN0aXZlR3JvdXAmJnRoaXMuZGlzY2FyZEFjdGl2ZUdyb3VwKCksdGhpcy5kaXNjYXJkQWN0aXZlT2JqZWN0JiZ0aGlzLmRpc2NhcmRBY3RpdmVPYmplY3QoKSx0aGlzLmNsZWFyQ29udGV4dCh0aGlzLmNvbnRleHRDb250YWluZXIpLHRoaXMuY29udGV4dFRvcCYmdGhpcy5jbGVhckNvbnRleHQodGhpcy5jb250ZXh0VG9wKSx0aGlzLmZpcmUoXCJjYW52YXM6Y2xlYXJlZFwiKSx0aGlzLnJlbmRlckFsbCgpLHRoaXN9LHJlbmRlckFsbDpmdW5jdGlvbih0KXt2YXIgZT10aGlzW3Q9PT0hMCYmdGhpcy5pbnRlcmFjdGl2ZT9cImNvbnRleHRUb3BcIjpcImNvbnRleHRDb250YWluZXJcIl0saT10aGlzLmdldEFjdGl2ZUdyb3VwKCk7cmV0dXJuIHRoaXMuY29udGV4dFRvcCYmdGhpcy5zZWxlY3Rpb24mJiF0aGlzLl9ncm91cFNlbGVjdG9yJiZ0aGlzLmNsZWFyQ29udGV4dCh0aGlzLmNvbnRleHRUb3ApLHR8fHRoaXMuY2xlYXJDb250ZXh0KGUpLHRoaXMuZmlyZShcImJlZm9yZTpyZW5kZXJcIiksdGhpcy5jbGlwVG8mJmZhYnJpYy51dGlsLmNsaXBDb250ZXh0KHRoaXMsZSksdGhpcy5fcmVuZGVyQmFja2dyb3VuZChlKSx0aGlzLl9yZW5kZXJPYmplY3RzKGUsaSksdGhpcy5fcmVuZGVyQWN0aXZlR3JvdXAoZSxpKSx0aGlzLmNsaXBUbyYmZS5yZXN0b3JlKCksdGhpcy5fcmVuZGVyT3ZlcmxheShlKSx0aGlzLmNvbnRyb2xzQWJvdmVPdmVybGF5JiZ0aGlzLmludGVyYWN0aXZlJiZ0aGlzLmRyYXdDb250cm9scyhlKSx0aGlzLmZpcmUoXCJhZnRlcjpyZW5kZXJcIiksdGhpc30sX3JlbmRlck9iamVjdHM6ZnVuY3Rpb24odCxlKXt2YXIgaSxyO2lmKCFlfHx0aGlzLnByZXNlcnZlT2JqZWN0U3RhY2tpbmcpZm9yKGk9MCxyPXRoaXMuX29iamVjdHMubGVuZ3RoO3I+aTsrK2kpdGhpcy5fZHJhdyh0LHRoaXMuX29iamVjdHNbaV0pO2Vsc2UgZm9yKGk9MCxyPXRoaXMuX29iamVjdHMubGVuZ3RoO3I+aTsrK2kpdGhpcy5fb2JqZWN0c1tpXSYmIWUuY29udGFpbnModGhpcy5fb2JqZWN0c1tpXSkmJnRoaXMuX2RyYXcodCx0aGlzLl9vYmplY3RzW2ldKX0sX3JlbmRlckFjdGl2ZUdyb3VwOmZ1bmN0aW9uKHQsZSl7aWYoZSl7dmFyIGk9W107dGhpcy5mb3JFYWNoT2JqZWN0KGZ1bmN0aW9uKHQpe2UuY29udGFpbnModCkmJmkucHVzaCh0KX0pLGUuX3NldChcIl9vYmplY3RzXCIsaS5yZXZlcnNlKCkpLHRoaXMuX2RyYXcodCxlKX19LF9yZW5kZXJCYWNrZ3JvdW5kOmZ1bmN0aW9uKHQpe3RoaXMuYmFja2dyb3VuZENvbG9yJiYodC5maWxsU3R5bGU9dGhpcy5iYWNrZ3JvdW5kQ29sb3IudG9MaXZlP3RoaXMuYmFja2dyb3VuZENvbG9yLnRvTGl2ZSh0KTp0aGlzLmJhY2tncm91bmRDb2xvcix0LmZpbGxSZWN0KHRoaXMuYmFja2dyb3VuZENvbG9yLm9mZnNldFh8fDAsdGhpcy5iYWNrZ3JvdW5kQ29sb3Iub2Zmc2V0WXx8MCx0aGlzLndpZHRoLHRoaXMuaGVpZ2h0KSksdGhpcy5iYWNrZ3JvdW5kSW1hZ2UmJnRoaXMuX2RyYXcodCx0aGlzLmJhY2tncm91bmRJbWFnZSl9LF9yZW5kZXJPdmVybGF5OmZ1bmN0aW9uKHQpe3RoaXMub3ZlcmxheUNvbG9yJiYodC5maWxsU3R5bGU9dGhpcy5vdmVybGF5Q29sb3IudG9MaXZlP3RoaXMub3ZlcmxheUNvbG9yLnRvTGl2ZSh0KTp0aGlzLm92ZXJsYXlDb2xvcix0LmZpbGxSZWN0KHRoaXMub3ZlcmxheUNvbG9yLm9mZnNldFh8fDAsdGhpcy5vdmVybGF5Q29sb3Iub2Zmc2V0WXx8MCx0aGlzLndpZHRoLHRoaXMuaGVpZ2h0KSksdGhpcy5vdmVybGF5SW1hZ2UmJnRoaXMuX2RyYXcodCx0aGlzLm92ZXJsYXlJbWFnZSl9LHJlbmRlclRvcDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuY29udGV4dFRvcHx8dGhpcy5jb250ZXh0Q29udGFpbmVyO3RoaXMuY2xlYXJDb250ZXh0KHQpLHRoaXMuc2VsZWN0aW9uJiZ0aGlzLl9ncm91cFNlbGVjdG9yJiZ0aGlzLl9kcmF3U2VsZWN0aW9uKCk7dmFyIGU9dGhpcy5nZXRBY3RpdmVHcm91cCgpO3JldHVybiBlJiZlLnJlbmRlcih0KSx0aGlzLl9yZW5kZXJPdmVybGF5KHQpLHRoaXMuZmlyZShcImFmdGVyOnJlbmRlclwiKSx0aGlzfSxnZXRDZW50ZXI6ZnVuY3Rpb24oKXtyZXR1cm57dG9wOnRoaXMuZ2V0SGVpZ2h0KCkvMixsZWZ0OnRoaXMuZ2V0V2lkdGgoKS8yfX0sY2VudGVyT2JqZWN0SDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fY2VudGVyT2JqZWN0KHQsbmV3IGZhYnJpYy5Qb2ludCh0aGlzLmdldENlbnRlcigpLmxlZnQsdC5nZXRDZW50ZXJQb2ludCgpLnkpKSx0aGlzLnJlbmRlckFsbCgpLHRoaXN9LGNlbnRlck9iamVjdFY6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2NlbnRlck9iamVjdCh0LG5ldyBmYWJyaWMuUG9pbnQodC5nZXRDZW50ZXJQb2ludCgpLngsdGhpcy5nZXRDZW50ZXIoKS50b3ApKSx0aGlzLnJlbmRlckFsbCgpLHRoaXN9LGNlbnRlck9iamVjdDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldENlbnRlcigpO3JldHVybiB0aGlzLl9jZW50ZXJPYmplY3QodCxuZXcgZmFicmljLlBvaW50KGUubGVmdCxlLnRvcCkpLHRoaXMucmVuZGVyQWxsKCksdGhpc30sX2NlbnRlck9iamVjdDpmdW5jdGlvbih0LGUpe3JldHVybiB0LnNldFBvc2l0aW9uQnlPcmlnaW4oZSxcImNlbnRlclwiLFwiY2VudGVyXCIpLHRoaXN9LHRvRGF0YWxlc3NKU09OOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnRvRGF0YWxlc3NPYmplY3QodCl9LHRvT2JqZWN0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl90b09iamVjdE1ldGhvZChcInRvT2JqZWN0XCIsdCl9LHRvRGF0YWxlc3NPYmplY3Q6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX3RvT2JqZWN0TWV0aG9kKFwidG9EYXRhbGVzc09iamVjdFwiLHQpfSxfdG9PYmplY3RNZXRob2Q6ZnVuY3Rpb24oZSxpKXt2YXIgcj17b2JqZWN0czp0aGlzLl90b09iamVjdHMoZSxpKX07cmV0dXJuIHQocix0aGlzLl9fc2VyaWFsaXplQmdPdmVybGF5KCkpLGZhYnJpYy51dGlsLnBvcHVsYXRlV2l0aFByb3BlcnRpZXModGhpcyxyLGkpLHJ9LF90b09iamVjdHM6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5nZXRPYmplY3RzKCkubWFwKGZ1bmN0aW9uKGkpe3JldHVybiB0aGlzLl90b09iamVjdChpLHQsZSl9LHRoaXMpfSxfdG9PYmplY3Q6ZnVuY3Rpb24odCxlLGkpe3ZhciByO3RoaXMuaW5jbHVkZURlZmF1bHRWYWx1ZXN8fChyPXQuaW5jbHVkZURlZmF1bHRWYWx1ZXMsdC5pbmNsdWRlRGVmYXVsdFZhbHVlcz0hMSk7dmFyIHM9dGhpcy5fcmVhbGl6ZUdyb3VwVHJhbnNmb3JtT25PYmplY3QodCksbj10W2VdKGkpO3JldHVybiB0aGlzLmluY2x1ZGVEZWZhdWx0VmFsdWVzfHwodC5pbmNsdWRlRGVmYXVsdFZhbHVlcz1yKSx0aGlzLl91bndpbmRHcm91cFRyYW5zZm9ybU9uT2JqZWN0KHQscyksbn0sX3JlYWxpemVHcm91cFRyYW5zZm9ybU9uT2JqZWN0OmZ1bmN0aW9uKHQpe3ZhciBlPVtcImFuZ2xlXCIsXCJmbGlwWFwiLFwiZmxpcFlcIixcImhlaWdodFwiLFwibGVmdFwiLFwic2NhbGVYXCIsXCJzY2FsZVlcIixcInRvcFwiLFwid2lkdGhcIl07aWYodC5ncm91cCYmdC5ncm91cD09PXRoaXMuZ2V0QWN0aXZlR3JvdXAoKSl7dmFyIGk9e307cmV0dXJuIGUuZm9yRWFjaChmdW5jdGlvbihlKXtpW2VdPXRbZV19KSx0aGlzLmdldEFjdGl2ZUdyb3VwKCkucmVhbGl6ZVRyYW5zZm9ybSh0KSxpfXJldHVybiBudWxsfSxfdW53aW5kR3JvdXBUcmFuc2Zvcm1Pbk9iamVjdDpmdW5jdGlvbih0LGUpe2UmJnQuc2V0KGUpfSxfX3NlcmlhbGl6ZUJnT3ZlcmxheTpmdW5jdGlvbigpe3ZhciB0PXtiYWNrZ3JvdW5kOnRoaXMuYmFja2dyb3VuZENvbG9yJiZ0aGlzLmJhY2tncm91bmRDb2xvci50b09iamVjdD90aGlzLmJhY2tncm91bmRDb2xvci50b09iamVjdCgpOnRoaXMuYmFja2dyb3VuZENvbG9yfTtyZXR1cm4gdGhpcy5vdmVybGF5Q29sb3ImJih0Lm92ZXJsYXk9dGhpcy5vdmVybGF5Q29sb3IudG9PYmplY3Q/dGhpcy5vdmVybGF5Q29sb3IudG9PYmplY3QoKTp0aGlzLm92ZXJsYXlDb2xvciksdGhpcy5iYWNrZ3JvdW5kSW1hZ2UmJih0LmJhY2tncm91bmRJbWFnZT10aGlzLmJhY2tncm91bmRJbWFnZS50b09iamVjdCgpKSx0aGlzLm92ZXJsYXlJbWFnZSYmKHQub3ZlcmxheUltYWdlPXRoaXMub3ZlcmxheUltYWdlLnRvT2JqZWN0KCkpLHR9LHN2Z1ZpZXdwb3J0VHJhbnNmb3JtYXRpb246ITAsdG9TVkc6ZnVuY3Rpb24odCxlKXt0fHwodD17fSk7dmFyIGk9W107cmV0dXJuIHRoaXMuX3NldFNWR1ByZWFtYmxlKGksdCksdGhpcy5fc2V0U1ZHSGVhZGVyKGksdCksdGhpcy5fc2V0U1ZHQmdPdmVybGF5Q29sb3IoaSxcImJhY2tncm91bmRDb2xvclwiKSx0aGlzLl9zZXRTVkdCZ092ZXJsYXlJbWFnZShpLFwiYmFja2dyb3VuZEltYWdlXCIpLHRoaXMuX3NldFNWR09iamVjdHMoaSxlKSx0aGlzLl9zZXRTVkdCZ092ZXJsYXlDb2xvcihpLFwib3ZlcmxheUNvbG9yXCIpLHRoaXMuX3NldFNWR0JnT3ZlcmxheUltYWdlKGksXCJvdmVybGF5SW1hZ2VcIiksaS5wdXNoKFwiPC9zdmc+XCIpLGkuam9pbihcIlwiKX0sX3NldFNWR1ByZWFtYmxlOmZ1bmN0aW9uKHQsZSl7ZS5zdXBwcmVzc1ByZWFtYmxlfHx0LnB1c2goJzw/eG1sIHZlcnNpb249XCIxLjBcIiBlbmNvZGluZz1cIicsZS5lbmNvZGluZ3x8XCJVVEYtOFwiLCdcIiBzdGFuZGFsb25lPVwibm9cIiA/PicsJzwhRE9DVFlQRSBzdmcgUFVCTElDIFwiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU5cIiAnLCdcImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZFwiPlxcbicpfSxfc2V0U1ZHSGVhZGVyOmZ1bmN0aW9uKHQsZSl7dmFyIGkscixzO2Uudmlld0JveD8oaT1lLnZpZXdCb3gud2lkdGgscj1lLnZpZXdCb3guaGVpZ2h0KTooaT10aGlzLndpZHRoLHI9dGhpcy5oZWlnaHQsdGhpcy5zdmdWaWV3cG9ydFRyYW5zZm9ybWF0aW9ufHwocz10aGlzLnZpZXdwb3J0VHJhbnNmb3JtLGkvPXNbMF0sci89c1szXSkpLHQucHVzaChcIjxzdmcgXCIsJ3htbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiAnLCd4bWxuczp4bGluaz1cImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIiAnLCd2ZXJzaW9uPVwiMS4xXCIgJywnd2lkdGg9XCInLGksJ1wiICcsJ2hlaWdodD1cIicsciwnXCIgJyx0aGlzLmJhY2tncm91bmRDb2xvciYmIXRoaXMuYmFja2dyb3VuZENvbG9yLnRvTGl2ZT8nc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiAnK3RoaXMuYmFja2dyb3VuZENvbG9yKydcIiAnOm51bGwsZS52aWV3Qm94Pyd2aWV3Qm94PVwiJytlLnZpZXdCb3gueCtcIiBcIitlLnZpZXdCb3gueStcIiBcIitlLnZpZXdCb3gud2lkdGgrXCIgXCIrZS52aWV3Qm94LmhlaWdodCsnXCIgJzpudWxsLCd4bWw6c3BhY2U9XCJwcmVzZXJ2ZVwiPicsXCI8ZGVzYz5DcmVhdGVkIHdpdGggRmFicmljLmpzIFwiLGZhYnJpYy52ZXJzaW9uLFwiPC9kZXNjPlwiLFwiPGRlZnM+XCIsZmFicmljLmNyZWF0ZVNWR0ZvbnRGYWNlc01hcmt1cCh0aGlzLmdldE9iamVjdHMoKSksZmFicmljLmNyZWF0ZVNWR1JlZkVsZW1lbnRzTWFya3VwKHRoaXMpLFwiPC9kZWZzPlwiKTtcclxuXHJcbn0sX3NldFNWR09iamVjdHM6ZnVuY3Rpb24odCxlKXtmb3IodmFyIGk9MCxyPXRoaXMuZ2V0T2JqZWN0cygpLHM9ci5sZW5ndGg7cz5pO2krKyl7dmFyIG49cltpXSxvPXRoaXMuX3JlYWxpemVHcm91cFRyYW5zZm9ybU9uT2JqZWN0KG4pO3QucHVzaChuLnRvU1ZHKGUpKSx0aGlzLl91bndpbmRHcm91cFRyYW5zZm9ybU9uT2JqZWN0KG4sbyl9fSxfc2V0U1ZHQmdPdmVybGF5SW1hZ2U6ZnVuY3Rpb24odCxlKXt0aGlzW2VdJiZ0aGlzW2VdLnRvU1ZHJiZ0LnB1c2godGhpc1tlXS50b1NWRygpKX0sX3NldFNWR0JnT3ZlcmxheUNvbG9yOmZ1bmN0aW9uKHQsZSl7dGhpc1tlXSYmdGhpc1tlXS5zb3VyY2U/dC5wdXNoKCc8cmVjdCB4PVwiJyx0aGlzW2VdLm9mZnNldFgsJ1wiIHk9XCInLHRoaXNbZV0ub2Zmc2V0WSwnXCIgJywnd2lkdGg9XCInLFwicmVwZWF0LXlcIj09PXRoaXNbZV0ucmVwZWF0fHxcIm5vLXJlcGVhdFwiPT09dGhpc1tlXS5yZXBlYXQ/dGhpc1tlXS5zb3VyY2Uud2lkdGg6dGhpcy53aWR0aCwnXCIgaGVpZ2h0PVwiJyxcInJlcGVhdC14XCI9PT10aGlzW2VdLnJlcGVhdHx8XCJuby1yZXBlYXRcIj09PXRoaXNbZV0ucmVwZWF0P3RoaXNbZV0uc291cmNlLmhlaWdodDp0aGlzLmhlaWdodCwnXCIgZmlsbD1cInVybCgjJytlKydQYXR0ZXJuKVwiJyxcIj48L3JlY3Q+XCIpOnRoaXNbZV0mJlwib3ZlcmxheUNvbG9yXCI9PT1lJiZ0LnB1c2goJzxyZWN0IHg9XCIwXCIgeT1cIjBcIiAnLCd3aWR0aD1cIicsdGhpcy53aWR0aCwnXCIgaGVpZ2h0PVwiJyx0aGlzLmhlaWdodCwnXCIgZmlsbD1cIicsdGhpc1tlXSwnXCInLFwiPjwvcmVjdD5cIil9LHNlbmRUb0JhY2s6ZnVuY3Rpb24odCl7cmV0dXJuIGkodGhpcy5fb2JqZWN0cyx0KSx0aGlzLl9vYmplY3RzLnVuc2hpZnQodCksdGhpcy5yZW5kZXJBbGwmJnRoaXMucmVuZGVyQWxsKCl9LGJyaW5nVG9Gcm9udDpmdW5jdGlvbih0KXtyZXR1cm4gaSh0aGlzLl9vYmplY3RzLHQpLHRoaXMuX29iamVjdHMucHVzaCh0KSx0aGlzLnJlbmRlckFsbCYmdGhpcy5yZW5kZXJBbGwoKX0sc2VuZEJhY2t3YXJkczpmdW5jdGlvbih0LGUpe3ZhciByPXRoaXMuX29iamVjdHMuaW5kZXhPZih0KTtpZigwIT09cil7dmFyIHM9dGhpcy5fZmluZE5ld0xvd2VySW5kZXgodCxyLGUpO2kodGhpcy5fb2JqZWN0cyx0KSx0aGlzLl9vYmplY3RzLnNwbGljZShzLDAsdCksdGhpcy5yZW5kZXJBbGwmJnRoaXMucmVuZGVyQWxsKCl9cmV0dXJuIHRoaXN9LF9maW5kTmV3TG93ZXJJbmRleDpmdW5jdGlvbih0LGUsaSl7dmFyIHI7aWYoaSl7cj1lO2Zvcih2YXIgcz1lLTE7cz49MDstLXMpe3ZhciBuPXQuaW50ZXJzZWN0c1dpdGhPYmplY3QodGhpcy5fb2JqZWN0c1tzXSl8fHQuaXNDb250YWluZWRXaXRoaW5PYmplY3QodGhpcy5fb2JqZWN0c1tzXSl8fHRoaXMuX29iamVjdHNbc10uaXNDb250YWluZWRXaXRoaW5PYmplY3QodCk7aWYobil7cj1zO2JyZWFrfX19ZWxzZSByPWUtMTtyZXR1cm4gcn0sYnJpbmdGb3J3YXJkOmZ1bmN0aW9uKHQsZSl7dmFyIHI9dGhpcy5fb2JqZWN0cy5pbmRleE9mKHQpO2lmKHIhPT10aGlzLl9vYmplY3RzLmxlbmd0aC0xKXt2YXIgcz10aGlzLl9maW5kTmV3VXBwZXJJbmRleCh0LHIsZSk7aSh0aGlzLl9vYmplY3RzLHQpLHRoaXMuX29iamVjdHMuc3BsaWNlKHMsMCx0KSx0aGlzLnJlbmRlckFsbCYmdGhpcy5yZW5kZXJBbGwoKX1yZXR1cm4gdGhpc30sX2ZpbmROZXdVcHBlckluZGV4OmZ1bmN0aW9uKHQsZSxpKXt2YXIgcjtpZihpKXtyPWU7Zm9yKHZhciBzPWUrMTtzPHRoaXMuX29iamVjdHMubGVuZ3RoOysrcyl7dmFyIG49dC5pbnRlcnNlY3RzV2l0aE9iamVjdCh0aGlzLl9vYmplY3RzW3NdKXx8dC5pc0NvbnRhaW5lZFdpdGhpbk9iamVjdCh0aGlzLl9vYmplY3RzW3NdKXx8dGhpcy5fb2JqZWN0c1tzXS5pc0NvbnRhaW5lZFdpdGhpbk9iamVjdCh0KTtpZihuKXtyPXM7YnJlYWt9fX1lbHNlIHI9ZSsxO3JldHVybiByfSxtb3ZlVG86ZnVuY3Rpb24odCxlKXtyZXR1cm4gaSh0aGlzLl9vYmplY3RzLHQpLHRoaXMuX29iamVjdHMuc3BsaWNlKGUsMCx0KSx0aGlzLnJlbmRlckFsbCYmdGhpcy5yZW5kZXJBbGwoKX0sZGlzcG9zZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNsZWFyKCksdGhpcy5pbnRlcmFjdGl2ZSYmdGhpcy5yZW1vdmVMaXN0ZW5lcnMoKSx0aGlzfSx0b1N0cmluZzpmdW5jdGlvbigpe3JldHVyblwiIzxmYWJyaWMuQ2FudmFzIChcIit0aGlzLmNvbXBsZXhpdHkoKStcIik6IHsgb2JqZWN0czogXCIrdGhpcy5nZXRPYmplY3RzKCkubGVuZ3RoK1wiIH0+XCJ9fSksdChmYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZSxmYWJyaWMuT2JzZXJ2YWJsZSksdChmYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZSxmYWJyaWMuQ29sbGVjdGlvbiksdChmYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZSxmYWJyaWMuRGF0YVVSTEV4cG9ydGVyKSx0KGZhYnJpYy5TdGF0aWNDYW52YXMse0VNUFRZX0pTT046J3tcIm9iamVjdHNcIjogW10sIFwiYmFja2dyb3VuZFwiOiBcIndoaXRlXCJ9JyxzdXBwb3J0czpmdW5jdGlvbih0KXt2YXIgZT1mYWJyaWMudXRpbC5jcmVhdGVDYW52YXNFbGVtZW50KCk7aWYoIWV8fCFlLmdldENvbnRleHQpcmV0dXJuIG51bGw7dmFyIGk9ZS5nZXRDb250ZXh0KFwiMmRcIik7aWYoIWkpcmV0dXJuIG51bGw7c3dpdGNoKHQpe2Nhc2VcImdldEltYWdlRGF0YVwiOnJldHVyblwidW5kZWZpbmVkXCIhPXR5cGVvZiBpLmdldEltYWdlRGF0YTtjYXNlXCJzZXRMaW5lRGFzaFwiOnJldHVyblwidW5kZWZpbmVkXCIhPXR5cGVvZiBpLnNldExpbmVEYXNoO2Nhc2VcInRvRGF0YVVSTFwiOnJldHVyblwidW5kZWZpbmVkXCIhPXR5cGVvZiBlLnRvRGF0YVVSTDtjYXNlXCJ0b0RhdGFVUkxXaXRoUXVhbGl0eVwiOnRyeXtyZXR1cm4gZS50b0RhdGFVUkwoXCJpbWFnZS9qcGVnXCIsMCksITB9Y2F0Y2gocil7fXJldHVybiExO2RlZmF1bHQ6cmV0dXJuIG51bGx9fX0pLGZhYnJpYy5TdGF0aWNDYW52YXMucHJvdG90eXBlLnRvSlNPTj1mYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZS50b09iamVjdH0oKSxmYWJyaWMuQmFzZUJydXNoPWZhYnJpYy51dGlsLmNyZWF0ZUNsYXNzKHtjb2xvcjpcInJnYigwLCAwLCAwKVwiLHdpZHRoOjEsc2hhZG93Om51bGwsc3Ryb2tlTGluZUNhcDpcInJvdW5kXCIsc3Ryb2tlTGluZUpvaW46XCJyb3VuZFwiLHN0cm9rZURhc2hBcnJheTpudWxsLHNldFNoYWRvdzpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5zaGFkb3c9bmV3IGZhYnJpYy5TaGFkb3codCksdGhpc30sX3NldEJydXNoU3R5bGVzOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5jYW52YXMuY29udGV4dFRvcDt0LnN0cm9rZVN0eWxlPXRoaXMuY29sb3IsdC5saW5lV2lkdGg9dGhpcy53aWR0aCx0LmxpbmVDYXA9dGhpcy5zdHJva2VMaW5lQ2FwLHQubGluZUpvaW49dGhpcy5zdHJva2VMaW5lSm9pbix0aGlzLnN0cm9rZURhc2hBcnJheSYmZmFicmljLlN0YXRpY0NhbnZhcy5zdXBwb3J0cyhcInNldExpbmVEYXNoXCIpJiZ0LnNldExpbmVEYXNoKHRoaXMuc3Ryb2tlRGFzaEFycmF5KX0sX3NldFNoYWRvdzpmdW5jdGlvbigpe2lmKHRoaXMuc2hhZG93KXt2YXIgdD10aGlzLmNhbnZhcy5jb250ZXh0VG9wO3Quc2hhZG93Q29sb3I9dGhpcy5zaGFkb3cuY29sb3IsdC5zaGFkb3dCbHVyPXRoaXMuc2hhZG93LmJsdXIsdC5zaGFkb3dPZmZzZXRYPXRoaXMuc2hhZG93Lm9mZnNldFgsdC5zaGFkb3dPZmZzZXRZPXRoaXMuc2hhZG93Lm9mZnNldFl9fSxfcmVzZXRTaGFkb3c6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmNhbnZhcy5jb250ZXh0VG9wO3Quc2hhZG93Q29sb3I9XCJcIix0LnNoYWRvd0JsdXI9dC5zaGFkb3dPZmZzZXRYPXQuc2hhZG93T2Zmc2V0WT0wfX0pLGZ1bmN0aW9uKCl7ZmFicmljLlBlbmNpbEJydXNoPWZhYnJpYy51dGlsLmNyZWF0ZUNsYXNzKGZhYnJpYy5CYXNlQnJ1c2gse2luaXRpYWxpemU6ZnVuY3Rpb24odCl7dGhpcy5jYW52YXM9dCx0aGlzLl9wb2ludHM9W119LG9uTW91c2VEb3duOmZ1bmN0aW9uKHQpe3RoaXMuX3ByZXBhcmVGb3JEcmF3aW5nKHQpLHRoaXMuX2NhcHR1cmVEcmF3aW5nUGF0aCh0KSx0aGlzLl9yZW5kZXIoKX0sb25Nb3VzZU1vdmU6ZnVuY3Rpb24odCl7dGhpcy5fY2FwdHVyZURyYXdpbmdQYXRoKHQpLHRoaXMuY2FudmFzLmNsZWFyQ29udGV4dCh0aGlzLmNhbnZhcy5jb250ZXh0VG9wKSx0aGlzLl9yZW5kZXIoKX0sb25Nb3VzZVVwOmZ1bmN0aW9uKCl7dGhpcy5fZmluYWxpemVBbmRBZGRQYXRoKCl9LF9wcmVwYXJlRm9yRHJhd2luZzpmdW5jdGlvbih0KXt2YXIgZT1uZXcgZmFicmljLlBvaW50KHQueCx0LnkpO3RoaXMuX3Jlc2V0KCksdGhpcy5fYWRkUG9pbnQoZSksdGhpcy5jYW52YXMuY29udGV4dFRvcC5tb3ZlVG8oZS54LGUueSl9LF9hZGRQb2ludDpmdW5jdGlvbih0KXt0aGlzLl9wb2ludHMucHVzaCh0KX0sX3Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5fcG9pbnRzLmxlbmd0aD0wLHRoaXMuX3NldEJydXNoU3R5bGVzKCksdGhpcy5fc2V0U2hhZG93KCl9LF9jYXB0dXJlRHJhd2luZ1BhdGg6ZnVuY3Rpb24odCl7dmFyIGU9bmV3IGZhYnJpYy5Qb2ludCh0LngsdC55KTt0aGlzLl9hZGRQb2ludChlKX0sX3JlbmRlcjpmdW5jdGlvbigpe3ZhciB0PXRoaXMuY2FudmFzLmNvbnRleHRUb3AsZT10aGlzLmNhbnZhcy52aWV3cG9ydFRyYW5zZm9ybSxpPXRoaXMuX3BvaW50c1swXSxyPXRoaXMuX3BvaW50c1sxXTt0LnNhdmUoKSx0LnRyYW5zZm9ybShlWzBdLGVbMV0sZVsyXSxlWzNdLGVbNF0sZVs1XSksdC5iZWdpblBhdGgoKSwyPT09dGhpcy5fcG9pbnRzLmxlbmd0aCYmaS54PT09ci54JiZpLnk9PT1yLnkmJihpLngtPS41LHIueCs9LjUpLHQubW92ZVRvKGkueCxpLnkpO2Zvcih2YXIgcz0xLG49dGhpcy5fcG9pbnRzLmxlbmd0aDtuPnM7cysrKXt2YXIgbz1pLm1pZFBvaW50RnJvbShyKTt0LnF1YWRyYXRpY0N1cnZlVG8oaS54LGkueSxvLngsby55KSxpPXRoaXMuX3BvaW50c1tzXSxyPXRoaXMuX3BvaW50c1tzKzFdfXQubGluZVRvKGkueCxpLnkpLHQuc3Ryb2tlKCksdC5yZXN0b3JlKCl9LGNvbnZlcnRQb2ludHNUb1NWR1BhdGg6ZnVuY3Rpb24odCl7dmFyIGU9W10saT1uZXcgZmFicmljLlBvaW50KHRbMF0ueCx0WzBdLnkpLHI9bmV3IGZhYnJpYy5Qb2ludCh0WzFdLngsdFsxXS55KTtlLnB1c2goXCJNIFwiLHRbMF0ueCxcIiBcIix0WzBdLnksXCIgXCIpO2Zvcih2YXIgcz0xLG49dC5sZW5ndGg7bj5zO3MrKyl7dmFyIG89aS5taWRQb2ludEZyb20ocik7ZS5wdXNoKFwiUSBcIixpLngsXCIgXCIsaS55LFwiIFwiLG8ueCxcIiBcIixvLnksXCIgXCIpLGk9bmV3IGZhYnJpYy5Qb2ludCh0W3NdLngsdFtzXS55KSxzKzE8dC5sZW5ndGgmJihyPW5ldyBmYWJyaWMuUG9pbnQodFtzKzFdLngsdFtzKzFdLnkpKX1yZXR1cm4gZS5wdXNoKFwiTCBcIixpLngsXCIgXCIsaS55LFwiIFwiKSxlfSxjcmVhdGVQYXRoOmZ1bmN0aW9uKHQpe3ZhciBlPW5ldyBmYWJyaWMuUGF0aCh0LHtmaWxsOm51bGwsc3Ryb2tlOnRoaXMuY29sb3Isc3Ryb2tlV2lkdGg6dGhpcy53aWR0aCxzdHJva2VMaW5lQ2FwOnRoaXMuc3Ryb2tlTGluZUNhcCxzdHJva2VMaW5lSm9pbjp0aGlzLnN0cm9rZUxpbmVKb2luLHN0cm9rZURhc2hBcnJheTp0aGlzLnN0cm9rZURhc2hBcnJheSxvcmlnaW5YOlwiY2VudGVyXCIsb3JpZ2luWTpcImNlbnRlclwifSk7cmV0dXJuIHRoaXMuc2hhZG93JiYodGhpcy5zaGFkb3cuYWZmZWN0U3Ryb2tlPSEwLGUuc2V0U2hhZG93KHRoaXMuc2hhZG93KSksZX0sX2ZpbmFsaXplQW5kQWRkUGF0aDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuY2FudmFzLmNvbnRleHRUb3A7dC5jbG9zZVBhdGgoKTt2YXIgZT10aGlzLmNvbnZlcnRQb2ludHNUb1NWR1BhdGgodGhpcy5fcG9pbnRzKS5qb2luKFwiXCIpO2lmKFwiTSAwIDAgUSAwIDAgMCAwIEwgMCAwXCI9PT1lKXJldHVybiB2b2lkIHRoaXMuY2FudmFzLnJlbmRlckFsbCgpO3ZhciBpPXRoaXMuY3JlYXRlUGF0aChlKTt0aGlzLmNhbnZhcy5hZGQoaSksaS5zZXRDb29yZHMoKSx0aGlzLmNhbnZhcy5jbGVhckNvbnRleHQodGhpcy5jYW52YXMuY29udGV4dFRvcCksdGhpcy5fcmVzZXRTaGFkb3coKSx0aGlzLmNhbnZhcy5yZW5kZXJBbGwoKSx0aGlzLmNhbnZhcy5maXJlKFwicGF0aDpjcmVhdGVkXCIse3BhdGg6aX0pfX0pfSgpLGZhYnJpYy5DaXJjbGVCcnVzaD1mYWJyaWMudXRpbC5jcmVhdGVDbGFzcyhmYWJyaWMuQmFzZUJydXNoLHt3aWR0aDoxMCxpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3RoaXMuY2FudmFzPXQsdGhpcy5wb2ludHM9W119LGRyYXdEb3Q6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5hZGRQb2ludCh0KSxpPXRoaXMuY2FudmFzLmNvbnRleHRUb3Ascj10aGlzLmNhbnZhcy52aWV3cG9ydFRyYW5zZm9ybTtpLnNhdmUoKSxpLnRyYW5zZm9ybShyWzBdLHJbMV0sclsyXSxyWzNdLHJbNF0scls1XSksaS5maWxsU3R5bGU9ZS5maWxsLGkuYmVnaW5QYXRoKCksaS5hcmMoZS54LGUueSxlLnJhZGl1cywwLDIqTWF0aC5QSSwhMSksaS5jbG9zZVBhdGgoKSxpLmZpbGwoKSxpLnJlc3RvcmUoKX0sb25Nb3VzZURvd246ZnVuY3Rpb24odCl7dGhpcy5wb2ludHMubGVuZ3RoPTAsdGhpcy5jYW52YXMuY2xlYXJDb250ZXh0KHRoaXMuY2FudmFzLmNvbnRleHRUb3ApLHRoaXMuX3NldFNoYWRvdygpLHRoaXMuZHJhd0RvdCh0KX0sb25Nb3VzZU1vdmU6ZnVuY3Rpb24odCl7dGhpcy5kcmF3RG90KHQpfSxvbk1vdXNlVXA6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmNhbnZhcy5yZW5kZXJPbkFkZFJlbW92ZTt0aGlzLmNhbnZhcy5yZW5kZXJPbkFkZFJlbW92ZT0hMTtmb3IodmFyIGU9W10saT0wLHI9dGhpcy5wb2ludHMubGVuZ3RoO3I+aTtpKyspe3ZhciBzPXRoaXMucG9pbnRzW2ldLG49bmV3IGZhYnJpYy5DaXJjbGUoe3JhZGl1czpzLnJhZGl1cyxsZWZ0OnMueCx0b3A6cy55LG9yaWdpblg6XCJjZW50ZXJcIixvcmlnaW5ZOlwiY2VudGVyXCIsZmlsbDpzLmZpbGx9KTt0aGlzLnNoYWRvdyYmbi5zZXRTaGFkb3codGhpcy5zaGFkb3cpLGUucHVzaChuKX12YXIgbz1uZXcgZmFicmljLkdyb3VwKGUse29yaWdpblg6XCJjZW50ZXJcIixvcmlnaW5ZOlwiY2VudGVyXCJ9KTtvLmNhbnZhcz10aGlzLmNhbnZhcyx0aGlzLmNhbnZhcy5hZGQobyksdGhpcy5jYW52YXMuZmlyZShcInBhdGg6Y3JlYXRlZFwiLHtwYXRoOm99KSx0aGlzLmNhbnZhcy5jbGVhckNvbnRleHQodGhpcy5jYW52YXMuY29udGV4dFRvcCksdGhpcy5fcmVzZXRTaGFkb3coKSx0aGlzLmNhbnZhcy5yZW5kZXJPbkFkZFJlbW92ZT10LHRoaXMuY2FudmFzLnJlbmRlckFsbCgpfSxhZGRQb2ludDpmdW5jdGlvbih0KXt2YXIgZT1uZXcgZmFicmljLlBvaW50KHQueCx0LnkpLGk9ZmFicmljLnV0aWwuZ2V0UmFuZG9tSW50KE1hdGgubWF4KDAsdGhpcy53aWR0aC0yMCksdGhpcy53aWR0aCsyMCkvMixyPW5ldyBmYWJyaWMuQ29sb3IodGhpcy5jb2xvcikuc2V0QWxwaGEoZmFicmljLnV0aWwuZ2V0UmFuZG9tSW50KDAsMTAwKS8xMDApLnRvUmdiYSgpO3JldHVybiBlLnJhZGl1cz1pLGUuZmlsbD1yLHRoaXMucG9pbnRzLnB1c2goZSksZX19KSxmYWJyaWMuU3ByYXlCcnVzaD1mYWJyaWMudXRpbC5jcmVhdGVDbGFzcyhmYWJyaWMuQmFzZUJydXNoLHt3aWR0aDoxMCxkZW5zaXR5OjIwLGRvdFdpZHRoOjEsZG90V2lkdGhWYXJpYW5jZToxLHJhbmRvbU9wYWNpdHk6ITEsb3B0aW1pemVPdmVybGFwcGluZzohMCxpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3RoaXMuY2FudmFzPXQsdGhpcy5zcHJheUNodW5rcz1bXX0sb25Nb3VzZURvd246ZnVuY3Rpb24odCl7dGhpcy5zcHJheUNodW5rcy5sZW5ndGg9MCx0aGlzLmNhbnZhcy5jbGVhckNvbnRleHQodGhpcy5jYW52YXMuY29udGV4dFRvcCksdGhpcy5fc2V0U2hhZG93KCksdGhpcy5hZGRTcHJheUNodW5rKHQpLHRoaXMucmVuZGVyKCl9LG9uTW91c2VNb3ZlOmZ1bmN0aW9uKHQpe3RoaXMuYWRkU3ByYXlDaHVuayh0KSx0aGlzLnJlbmRlcigpfSxvbk1vdXNlVXA6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmNhbnZhcy5yZW5kZXJPbkFkZFJlbW92ZTt0aGlzLmNhbnZhcy5yZW5kZXJPbkFkZFJlbW92ZT0hMTtmb3IodmFyIGU9W10saT0wLHI9dGhpcy5zcHJheUNodW5rcy5sZW5ndGg7cj5pO2krKylmb3IodmFyIHM9dGhpcy5zcHJheUNodW5rc1tpXSxuPTAsbz1zLmxlbmd0aDtvPm47bisrKXt2YXIgYT1uZXcgZmFicmljLlJlY3Qoe3dpZHRoOnNbbl0ud2lkdGgsaGVpZ2h0OnNbbl0ud2lkdGgsbGVmdDpzW25dLngrMSx0b3A6c1tuXS55KzEsb3JpZ2luWDpcImNlbnRlclwiLG9yaWdpblk6XCJjZW50ZXJcIixmaWxsOnRoaXMuY29sb3J9KTt0aGlzLnNoYWRvdyYmYS5zZXRTaGFkb3codGhpcy5zaGFkb3cpLGUucHVzaChhKX10aGlzLm9wdGltaXplT3ZlcmxhcHBpbmcmJihlPXRoaXMuX2dldE9wdGltaXplZFJlY3RzKGUpKTt2YXIgaD1uZXcgZmFicmljLkdyb3VwKGUse29yaWdpblg6XCJjZW50ZXJcIixvcmlnaW5ZOlwiY2VudGVyXCJ9KTtoLmNhbnZhcz10aGlzLmNhbnZhcyx0aGlzLmNhbnZhcy5hZGQoaCksdGhpcy5jYW52YXMuZmlyZShcInBhdGg6Y3JlYXRlZFwiLHtwYXRoOmh9KSx0aGlzLmNhbnZhcy5jbGVhckNvbnRleHQodGhpcy5jYW52YXMuY29udGV4dFRvcCksdGhpcy5fcmVzZXRTaGFkb3coKSx0aGlzLmNhbnZhcy5yZW5kZXJPbkFkZFJlbW92ZT10LHRoaXMuY2FudmFzLnJlbmRlckFsbCgpfSxfZ2V0T3B0aW1pemVkUmVjdHM6ZnVuY3Rpb24odCl7Zm9yKHZhciBlLGk9e30scj0wLHM9dC5sZW5ndGg7cz5yO3IrKyllPXRbcl0ubGVmdCtcIlwiK3Rbcl0udG9wLGlbZV18fChpW2VdPXRbcl0pO3ZhciBuPVtdO2ZvcihlIGluIGkpbi5wdXNoKGlbZV0pO3JldHVybiBufSxyZW5kZXI6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmNhbnZhcy5jb250ZXh0VG9wO3QuZmlsbFN0eWxlPXRoaXMuY29sb3I7dmFyIGU9dGhpcy5jYW52YXMudmlld3BvcnRUcmFuc2Zvcm07dC5zYXZlKCksdC50cmFuc2Zvcm0oZVswXSxlWzFdLGVbMl0sZVszXSxlWzRdLGVbNV0pO2Zvcih2YXIgaT0wLHI9dGhpcy5zcHJheUNodW5rUG9pbnRzLmxlbmd0aDtyPmk7aSsrKXt2YXIgcz10aGlzLnNwcmF5Q2h1bmtQb2ludHNbaV07XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHMub3BhY2l0eSYmKHQuZ2xvYmFsQWxwaGE9cy5vcGFjaXR5KSx0LmZpbGxSZWN0KHMueCxzLnkscy53aWR0aCxzLndpZHRoKX10LnJlc3RvcmUoKX0sYWRkU3ByYXlDaHVuazpmdW5jdGlvbih0KXt0aGlzLnNwcmF5Q2h1bmtQb2ludHM9W107Zm9yKHZhciBlLGkscixzPXRoaXMud2lkdGgvMixuPTA7bjx0aGlzLmRlbnNpdHk7bisrKXtlPWZhYnJpYy51dGlsLmdldFJhbmRvbUludCh0Lngtcyx0LngrcyksaT1mYWJyaWMudXRpbC5nZXRSYW5kb21JbnQodC55LXMsdC55K3MpLHI9dGhpcy5kb3RXaWR0aFZhcmlhbmNlP2ZhYnJpYy51dGlsLmdldFJhbmRvbUludChNYXRoLm1heCgxLHRoaXMuZG90V2lkdGgtdGhpcy5kb3RXaWR0aFZhcmlhbmNlKSx0aGlzLmRvdFdpZHRoK3RoaXMuZG90V2lkdGhWYXJpYW5jZSk6dGhpcy5kb3RXaWR0aDt2YXIgbz1uZXcgZmFicmljLlBvaW50KGUsaSk7by53aWR0aD1yLHRoaXMucmFuZG9tT3BhY2l0eSYmKG8ub3BhY2l0eT1mYWJyaWMudXRpbC5nZXRSYW5kb21JbnQoMCwxMDApLzEwMCksdGhpcy5zcHJheUNodW5rUG9pbnRzLnB1c2gobyl9dGhpcy5zcHJheUNodW5rcy5wdXNoKHRoaXMuc3ByYXlDaHVua1BvaW50cyl9fSksZmFicmljLlBhdHRlcm5CcnVzaD1mYWJyaWMudXRpbC5jcmVhdGVDbGFzcyhmYWJyaWMuUGVuY2lsQnJ1c2gse2dldFBhdHRlcm5TcmM6ZnVuY3Rpb24oKXt2YXIgdD0yMCxlPTUsaT1mYWJyaWMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKSxyPWkuZ2V0Q29udGV4dChcIjJkXCIpO3JldHVybiBpLndpZHRoPWkuaGVpZ2h0PXQrZSxyLmZpbGxTdHlsZT10aGlzLmNvbG9yLHIuYmVnaW5QYXRoKCksci5hcmModC8yLHQvMix0LzIsMCwyKk1hdGguUEksITEpLHIuY2xvc2VQYXRoKCksci5maWxsKCksaX0sZ2V0UGF0dGVyblNyY0Z1bmN0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIFN0cmluZyh0aGlzLmdldFBhdHRlcm5TcmMpLnJlcGxhY2UoXCJ0aGlzLmNvbG9yXCIsJ1wiJyt0aGlzLmNvbG9yKydcIicpfSxnZXRQYXR0ZXJuOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2FudmFzLmNvbnRleHRUb3AuY3JlYXRlUGF0dGVybih0aGlzLnNvdXJjZXx8dGhpcy5nZXRQYXR0ZXJuU3JjKCksXCJyZXBlYXRcIil9LF9zZXRCcnVzaFN0eWxlczpmdW5jdGlvbigpe3RoaXMuY2FsbFN1cGVyKFwiX3NldEJydXNoU3R5bGVzXCIpLHRoaXMuY2FudmFzLmNvbnRleHRUb3Auc3Ryb2tlU3R5bGU9dGhpcy5nZXRQYXR0ZXJuKCl9LGNyZWF0ZVBhdGg6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5jYWxsU3VwZXIoXCJjcmVhdGVQYXRoXCIsdCk7cmV0dXJuIGUuc3Ryb2tlPW5ldyBmYWJyaWMuUGF0dGVybih7c291cmNlOnRoaXMuc291cmNlfHx0aGlzLmdldFBhdHRlcm5TcmNGdW5jdGlvbigpfSksZX19KSxmdW5jdGlvbigpe3ZhciB0PWZhYnJpYy51dGlsLmdldFBvaW50ZXIsZT1mYWJyaWMudXRpbC5kZWdyZWVzVG9SYWRpYW5zLGk9ZmFicmljLnV0aWwucmFkaWFuc1RvRGVncmVlcyxyPU1hdGguYXRhbjIscz1NYXRoLmFicyxuPS41O2ZhYnJpYy5DYW52YXM9ZmFicmljLnV0aWwuY3JlYXRlQ2xhc3MoZmFicmljLlN0YXRpY0NhbnZhcyx7aW5pdGlhbGl6ZTpmdW5jdGlvbih0LGUpe2V8fChlPXt9KSx0aGlzLl9pbml0U3RhdGljKHQsZSksdGhpcy5faW5pdEludGVyYWN0aXZlKCksdGhpcy5fY3JlYXRlQ2FjaGVDYW52YXMoKSxmYWJyaWMuQ2FudmFzLmFjdGl2ZUluc3RhbmNlPXRoaXN9LHVuaVNjYWxlVHJhbnNmb3JtOiExLGNlbnRlcmVkU2NhbGluZzohMSxjZW50ZXJlZFJvdGF0aW9uOiExLGludGVyYWN0aXZlOiEwLHNlbGVjdGlvbjohMCxzZWxlY3Rpb25Db2xvcjpcInJnYmEoMTAwLCAxMDAsIDI1NSwgMC4zKVwiLHNlbGVjdGlvbkRhc2hBcnJheTpbXSxzZWxlY3Rpb25Cb3JkZXJDb2xvcjpcInJnYmEoMjU1LCAyNTUsIDI1NSwgMC4zKVwiLHNlbGVjdGlvbkxpbmVXaWR0aDoxLGhvdmVyQ3Vyc29yOlwibW92ZVwiLG1vdmVDdXJzb3I6XCJtb3ZlXCIsZGVmYXVsdEN1cnNvcjpcImRlZmF1bHRcIixmcmVlRHJhd2luZ0N1cnNvcjpcImNyb3NzaGFpclwiLHJvdGF0aW9uQ3Vyc29yOlwiY3Jvc3NoYWlyXCIsY29udGFpbmVyQ2xhc3M6XCJjYW52YXMtY29udGFpbmVyXCIscGVyUGl4ZWxUYXJnZXRGaW5kOiExLHRhcmdldEZpbmRUb2xlcmFuY2U6MCxza2lwVGFyZ2V0RmluZDohMSxpc0RyYXdpbmdNb2RlOiExLF9pbml0SW50ZXJhY3RpdmU6ZnVuY3Rpb24oKXt0aGlzLl9jdXJyZW50VHJhbnNmb3JtPW51bGwsdGhpcy5fZ3JvdXBTZWxlY3Rvcj1udWxsLHRoaXMuX2luaXRXcmFwcGVyRWxlbWVudCgpLHRoaXMuX2NyZWF0ZVVwcGVyQ2FudmFzKCksdGhpcy5faW5pdEV2ZW50TGlzdGVuZXJzKCksdGhpcy5mcmVlRHJhd2luZ0JydXNoPWZhYnJpYy5QZW5jaWxCcnVzaCYmbmV3IGZhYnJpYy5QZW5jaWxCcnVzaCh0aGlzKSx0aGlzLmNhbGNPZmZzZXQoKX0sX3Jlc2V0Q3VycmVudFRyYW5zZm9ybTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl9jdXJyZW50VHJhbnNmb3JtO2UudGFyZ2V0LnNldCh7c2NhbGVYOmUub3JpZ2luYWwuc2NhbGVYLHNjYWxlWTplLm9yaWdpbmFsLnNjYWxlWSxsZWZ0OmUub3JpZ2luYWwubGVmdCx0b3A6ZS5vcmlnaW5hbC50b3B9KSx0aGlzLl9zaG91bGRDZW50ZXJUcmFuc2Zvcm0odCxlLnRhcmdldCk/XCJyb3RhdGVcIj09PWUuYWN0aW9uP3RoaXMuX3NldE9yaWdpblRvQ2VudGVyKGUudGFyZ2V0KTooXCJjZW50ZXJcIiE9PWUub3JpZ2luWCYmKFwicmlnaHRcIj09PWUub3JpZ2luWD9lLm1vdXNlWFNpZ249LTE6ZS5tb3VzZVhTaWduPTEpLFwiY2VudGVyXCIhPT1lLm9yaWdpblkmJihcImJvdHRvbVwiPT09ZS5vcmlnaW5ZP2UubW91c2VZU2lnbj0tMTplLm1vdXNlWVNpZ249MSksZS5vcmlnaW5YPVwiY2VudGVyXCIsZS5vcmlnaW5ZPVwiY2VudGVyXCIpOihlLm9yaWdpblg9ZS5vcmlnaW5hbC5vcmlnaW5YLGUub3JpZ2luWT1lLm9yaWdpbmFsLm9yaWdpblkpfSxjb250YWluc1BvaW50OmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5nZXRQb2ludGVyKHQsITApLHI9dGhpcy5fbm9ybWFsaXplUG9pbnRlcihlLGkpO3JldHVybiBlLmNvbnRhaW5zUG9pbnQocil8fGUuX2ZpbmRUYXJnZXRDb3JuZXIoaSl9LF9ub3JtYWxpemVQb2ludGVyOmZ1bmN0aW9uKHQsZSl7dmFyIGkscj10aGlzLmdldEFjdGl2ZUdyb3VwKCkscz1lLngsbj1lLnksbz1yJiZcImdyb3VwXCIhPT10LnR5cGUmJnIuY29udGFpbnModCk7cmV0dXJuIG8mJihpPW5ldyBmYWJyaWMuUG9pbnQoci5sZWZ0LHIudG9wKSxpPWZhYnJpYy51dGlsLnRyYW5zZm9ybVBvaW50KGksdGhpcy52aWV3cG9ydFRyYW5zZm9ybSwhMCkscy09aS54LG4tPWkueSkse3g6cyx5Om59fSxpc1RhcmdldFRyYW5zcGFyZW50OmZ1bmN0aW9uKHQsZSxpKXt2YXIgcj10Lmhhc0JvcmRlcnMscz10LnRyYW5zcGFyZW50Q29ybmVyczt0Lmhhc0JvcmRlcnM9dC50cmFuc3BhcmVudENvcm5lcnM9ITEsdGhpcy5fZHJhdyh0aGlzLmNvbnRleHRDYWNoZSx0KSx0Lmhhc0JvcmRlcnM9cix0LnRyYW5zcGFyZW50Q29ybmVycz1zO3ZhciBuPWZhYnJpYy51dGlsLmlzVHJhbnNwYXJlbnQodGhpcy5jb250ZXh0Q2FjaGUsZSxpLHRoaXMudGFyZ2V0RmluZFRvbGVyYW5jZSk7cmV0dXJuIHRoaXMuY2xlYXJDb250ZXh0KHRoaXMuY29udGV4dENhY2hlKSxufSxfc2hvdWxkQ2xlYXJTZWxlY3Rpb246ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLmdldEFjdGl2ZUdyb3VwKCkscj10aGlzLmdldEFjdGl2ZU9iamVjdCgpO3JldHVybiFlfHxlJiZpJiYhaS5jb250YWlucyhlKSYmaSE9PWUmJiF0LnNoaWZ0S2V5fHxlJiYhZS5ldmVudGVkfHxlJiYhZS5zZWxlY3RhYmxlJiZyJiZyIT09ZX0sX3Nob3VsZENlbnRlclRyYW5zZm9ybTpmdW5jdGlvbih0LGUpe2lmKGUpe3ZhciBpLHI9dGhpcy5fY3VycmVudFRyYW5zZm9ybTtyZXR1cm5cInNjYWxlXCI9PT1yLmFjdGlvbnx8XCJzY2FsZVhcIj09PXIuYWN0aW9ufHxcInNjYWxlWVwiPT09ci5hY3Rpb24/aT10aGlzLmNlbnRlcmVkU2NhbGluZ3x8ZS5jZW50ZXJlZFNjYWxpbmc6XCJyb3RhdGVcIj09PXIuYWN0aW9uJiYoaT10aGlzLmNlbnRlcmVkUm90YXRpb258fGUuY2VudGVyZWRSb3RhdGlvbiksaT8hdC5hbHRLZXk6dC5hbHRLZXl9fSxfZ2V0T3JpZ2luRnJvbUNvcm5lcjpmdW5jdGlvbih0LGUpe3ZhciBpPXt4OnQub3JpZ2luWCx5OnQub3JpZ2luWX07cmV0dXJuXCJtbFwiPT09ZXx8XCJ0bFwiPT09ZXx8XCJibFwiPT09ZT9pLng9XCJyaWdodFwiOihcIm1yXCI9PT1lfHxcInRyXCI9PT1lfHxcImJyXCI9PT1lKSYmKGkueD1cImxlZnRcIiksXCJ0bFwiPT09ZXx8XCJtdFwiPT09ZXx8XCJ0clwiPT09ZT9pLnk9XCJib3R0b21cIjooXCJibFwiPT09ZXx8XCJtYlwiPT09ZXx8XCJiclwiPT09ZSkmJihpLnk9XCJ0b3BcIiksaX0sX2dldEFjdGlvbkZyb21Db3JuZXI6ZnVuY3Rpb24odCxlKXt2YXIgaT1cImRyYWdcIjtyZXR1cm4gZSYmKGk9XCJtbFwiPT09ZXx8XCJtclwiPT09ZT9cInNjYWxlWFwiOlwibXRcIj09PWV8fFwibWJcIj09PWU/XCJzY2FsZVlcIjpcIm10clwiPT09ZT9cInJvdGF0ZVwiOlwic2NhbGVcIiksaX0sX3NldHVwQ3VycmVudFRyYW5zZm9ybTpmdW5jdGlvbih0LGkpe2lmKGkpe3ZhciByPXRoaXMuZ2V0UG9pbnRlcih0KSxzPWkuX2ZpbmRUYXJnZXRDb3JuZXIodGhpcy5nZXRQb2ludGVyKHQsITApKSxuPXRoaXMuX2dldEFjdGlvbkZyb21Db3JuZXIoaSxzKSxvPXRoaXMuX2dldE9yaWdpbkZyb21Db3JuZXIoaSxzKTt0aGlzLl9jdXJyZW50VHJhbnNmb3JtPXt0YXJnZXQ6aSxhY3Rpb246bixzY2FsZVg6aS5zY2FsZVgsc2NhbGVZOmkuc2NhbGVZLG9mZnNldFg6ci54LWkubGVmdCxvZmZzZXRZOnIueS1pLnRvcCxvcmlnaW5YOm8ueCxvcmlnaW5ZOm8ueSxleDpyLngsZXk6ci55LGxlZnQ6aS5sZWZ0LHRvcDppLnRvcCx0aGV0YTplKGkuYW5nbGUpLHdpZHRoOmkud2lkdGgqaS5zY2FsZVgsbW91c2VYU2lnbjoxLG1vdXNlWVNpZ246MX0sdGhpcy5fY3VycmVudFRyYW5zZm9ybS5vcmlnaW5hbD17bGVmdDppLmxlZnQsdG9wOmkudG9wLHNjYWxlWDppLnNjYWxlWCxzY2FsZVk6aS5zY2FsZVksb3JpZ2luWDpvLngsb3JpZ2luWTpvLnl9LHRoaXMuX3Jlc2V0Q3VycmVudFRyYW5zZm9ybSh0KX19LF90cmFuc2xhdGVPYmplY3Q6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLl9jdXJyZW50VHJhbnNmb3JtLnRhcmdldDtpLmdldChcImxvY2tNb3ZlbWVudFhcIil8fGkuc2V0KFwibGVmdFwiLHQtdGhpcy5fY3VycmVudFRyYW5zZm9ybS5vZmZzZXRYKSxpLmdldChcImxvY2tNb3ZlbWVudFlcIil8fGkuc2V0KFwidG9wXCIsZS10aGlzLl9jdXJyZW50VHJhbnNmb3JtLm9mZnNldFkpfSxfc2NhbGVPYmplY3Q6ZnVuY3Rpb24odCxlLGkpe3ZhciByPXRoaXMuX2N1cnJlbnRUcmFuc2Zvcm0scz1yLnRhcmdldCxuPXMuZ2V0KFwibG9ja1NjYWxpbmdYXCIpLG89cy5nZXQoXCJsb2NrU2NhbGluZ1lcIiksYT1zLmdldChcImxvY2tTY2FsaW5nRmxpcFwiKTtpZighbnx8IW8pe3ZhciBoPXMudHJhbnNsYXRlVG9PcmlnaW5Qb2ludChzLmdldENlbnRlclBvaW50KCksci5vcmlnaW5YLHIub3JpZ2luWSksYz1zLnRvTG9jYWxQb2ludChuZXcgZmFicmljLlBvaW50KHQsZSksci5vcmlnaW5YLHIub3JpZ2luWSk7dGhpcy5fc2V0TG9jYWxNb3VzZShjLHIpLHRoaXMuX3NldE9iamVjdFNjYWxlKGMscixuLG8saSxhKSxzLnNldFBvc2l0aW9uQnlPcmlnaW4oaCxyLm9yaWdpblgsci5vcmlnaW5ZKX19LF9zZXRPYmplY3RTY2FsZTpmdW5jdGlvbih0LGUsaSxyLHMsbil7dmFyIG89ZS50YXJnZXQsYT0hMSxoPSExLGM9XCJsaW5lXCI9PT1vLnR5cGUmJjA9PT1vLndpZHRoLGw9XCJsaW5lXCI9PT1vLnR5cGUmJjA9PT1vLmhlaWdodCx1PWw/MDpvLnN0cm9rZVdpZHRoLGY9Yz8wOm8uc3Ryb2tlV2lkdGg7ZS5uZXdTY2FsZVg9dC54LyhvLndpZHRoK3UpLGUubmV3U2NhbGVZPXQueS8oby5oZWlnaHQrZiksbiYmZS5uZXdTY2FsZVg8PTAmJmUubmV3U2NhbGVYPG8uc2NhbGVYJiYoYT0hMCksbiYmZS5uZXdTY2FsZVk8PTAmJmUubmV3U2NhbGVZPG8uc2NhbGVZJiYoaD0hMCksXCJlcXVhbGx5XCIhPT1zfHxpfHxyP3M/XCJ4XCIhPT1zfHxvLmdldChcImxvY2tVbmlTY2FsaW5nXCIpP1wieVwiIT09c3x8by5nZXQoXCJsb2NrVW5pU2NhbGluZ1wiKXx8aHx8cnx8by5zZXQoXCJzY2FsZVlcIixlLm5ld1NjYWxlWSk6YXx8aXx8by5zZXQoXCJzY2FsZVhcIixlLm5ld1NjYWxlWCk6KGF8fGl8fG8uc2V0KFwic2NhbGVYXCIsZS5uZXdTY2FsZVgpLGh8fHJ8fG8uc2V0KFwic2NhbGVZXCIsZS5uZXdTY2FsZVkpKTphfHxofHx0aGlzLl9zY2FsZU9iamVjdEVxdWFsbHkodCxvLGUpLGF8fGh8fHRoaXMuX2ZsaXBPYmplY3QoZSxzKX0sX3NjYWxlT2JqZWN0RXF1YWxseTpmdW5jdGlvbih0LGUsaSl7dmFyIHI9dC55K3QueCxzPVwibGluZVwiPT09ZS50eXBlJiYwPT09ZS53aWR0aCxuPVwibGluZVwiPT09ZS50eXBlJiYwPT09ZS5oZWlnaHQsbz1uPzA6ZS5zdHJva2VXaWR0aCxhPXM/MDplLnN0cm9rZVdpZHRoLGg9KGUuaGVpZ2h0K2EpKmkub3JpZ2luYWwuc2NhbGVZKyhlLndpZHRoK28pKmkub3JpZ2luYWwuc2NhbGVYO2kubmV3U2NhbGVYPWkub3JpZ2luYWwuc2NhbGVYKnIvaCxpLm5ld1NjYWxlWT1pLm9yaWdpbmFsLnNjYWxlWSpyL2gsZS5zZXQoXCJzY2FsZVhcIixpLm5ld1NjYWxlWCksZS5zZXQoXCJzY2FsZVlcIixpLm5ld1NjYWxlWSl9LF9mbGlwT2JqZWN0OmZ1bmN0aW9uKHQsZSl7dC5uZXdTY2FsZVg8MCYmXCJ5XCIhPT1lJiYoXCJsZWZ0XCI9PT10Lm9yaWdpblg/dC5vcmlnaW5YPVwicmlnaHRcIjpcInJpZ2h0XCI9PT10Lm9yaWdpblgmJih0Lm9yaWdpblg9XCJsZWZ0XCIpKSx0Lm5ld1NjYWxlWTwwJiZcInhcIiE9PWUmJihcInRvcFwiPT09dC5vcmlnaW5ZP3Qub3JpZ2luWT1cImJvdHRvbVwiOlwiYm90dG9tXCI9PT10Lm9yaWdpblkmJih0Lm9yaWdpblk9XCJ0b3BcIikpfSxfc2V0TG9jYWxNb3VzZTpmdW5jdGlvbih0LGUpe3ZhciBpPWUudGFyZ2V0O1wicmlnaHRcIj09PWUub3JpZ2luWD90LngqPS0xOlwiY2VudGVyXCI9PT1lLm9yaWdpblgmJih0LngqPTIqZS5tb3VzZVhTaWduLHQueDwwJiYoZS5tb3VzZVhTaWduPS1lLm1vdXNlWFNpZ24pKSxcImJvdHRvbVwiPT09ZS5vcmlnaW5ZP3QueSo9LTE6XCJjZW50ZXJcIj09PWUub3JpZ2luWSYmKHQueSo9MiplLm1vdXNlWVNpZ24sdC55PDAmJihlLm1vdXNlWVNpZ249LWUubW91c2VZU2lnbikpLHModC54KT5pLnBhZGRpbmc/dC54PDA/dC54Kz1pLnBhZGRpbmc6dC54LT1pLnBhZGRpbmc6dC54PTAscyh0LnkpPmkucGFkZGluZz90Lnk8MD90LnkrPWkucGFkZGluZzp0LnktPWkucGFkZGluZzp0Lnk9MH0sX3JvdGF0ZU9iamVjdDpmdW5jdGlvbih0LGUpe3ZhciBzPXRoaXMuX2N1cnJlbnRUcmFuc2Zvcm07aWYoIXMudGFyZ2V0LmdldChcImxvY2tSb3RhdGlvblwiKSl7dmFyIG49cihzLmV5LXMudG9wLHMuZXgtcy5sZWZ0KSxvPXIoZS1zLnRvcCx0LXMubGVmdCksYT1pKG8tbitzLnRoZXRhKTswPmEmJihhPTM2MCthKSxzLnRhcmdldC5hbmdsZT1hJTM2MH19LHNldEN1cnNvcjpmdW5jdGlvbih0KXt0aGlzLnVwcGVyQ2FudmFzRWwuc3R5bGUuY3Vyc29yPXR9LF9yZXNldE9iamVjdFRyYW5zZm9ybTpmdW5jdGlvbih0KXt0LnNjYWxlWD0xLHQuc2NhbGVZPTEsdC5zZXRBbmdsZSgwKX0sX2RyYXdTZWxlY3Rpb246ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmNvbnRleHRUb3AsZT10aGlzLl9ncm91cFNlbGVjdG9yLGk9ZS5sZWZ0LHI9ZS50b3Asbz1zKGkpLGE9cyhyKTtpZih0LmZpbGxTdHlsZT10aGlzLnNlbGVjdGlvbkNvbG9yLHQuZmlsbFJlY3QoZS5leC0oaT4wPzA6LWkpLGUuZXktKHI+MD8wOi1yKSxvLGEpLHQubGluZVdpZHRoPXRoaXMuc2VsZWN0aW9uTGluZVdpZHRoLHQuc3Ryb2tlU3R5bGU9dGhpcy5zZWxlY3Rpb25Cb3JkZXJDb2xvcix0aGlzLnNlbGVjdGlvbkRhc2hBcnJheS5sZW5ndGg+MSl7dmFyIGg9ZS5leCtuLShpPjA/MDpvKSxjPWUuZXkrbi0ocj4wPzA6YSk7dC5iZWdpblBhdGgoKSxmYWJyaWMudXRpbC5kcmF3RGFzaGVkTGluZSh0LGgsYyxoK28sYyx0aGlzLnNlbGVjdGlvbkRhc2hBcnJheSksZmFicmljLnV0aWwuZHJhd0Rhc2hlZExpbmUodCxoLGMrYS0xLGgrbyxjK2EtMSx0aGlzLnNlbGVjdGlvbkRhc2hBcnJheSksZmFicmljLnV0aWwuZHJhd0Rhc2hlZExpbmUodCxoLGMsaCxjK2EsdGhpcy5zZWxlY3Rpb25EYXNoQXJyYXkpLGZhYnJpYy51dGlsLmRyYXdEYXNoZWRMaW5lKHQsaCtvLTEsYyxoK28tMSxjK2EsdGhpcy5zZWxlY3Rpb25EYXNoQXJyYXkpLHQuY2xvc2VQYXRoKCksdC5zdHJva2UoKX1lbHNlIHQuc3Ryb2tlUmVjdChlLmV4K24tKGk+MD8wOm8pLGUuZXkrbi0ocj4wPzA6YSksbyxhKX0sX2lzTGFzdFJlbmRlcmVkT2JqZWN0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmNvbnRyb2xzQWJvdmVPdmVybGF5JiZ0aGlzLmxhc3RSZW5kZXJlZE9iamVjdFdpdGhDb250cm9sc0Fib3ZlT3ZlcmxheSYmdGhpcy5sYXN0UmVuZGVyZWRPYmplY3RXaXRoQ29udHJvbHNBYm92ZU92ZXJsYXkudmlzaWJsZSYmdGhpcy5jb250YWluc1BvaW50KHQsdGhpcy5sYXN0UmVuZGVyZWRPYmplY3RXaXRoQ29udHJvbHNBYm92ZU92ZXJsYXkpJiZ0aGlzLmxhc3RSZW5kZXJlZE9iamVjdFdpdGhDb250cm9sc0Fib3ZlT3ZlcmxheS5fZmluZFRhcmdldENvcm5lcih0aGlzLmdldFBvaW50ZXIodCwhMCkpfSxmaW5kVGFyZ2V0OmZ1bmN0aW9uKHQsZSl7aWYoIXRoaXMuc2tpcFRhcmdldEZpbmQpe2lmKHRoaXMuX2lzTGFzdFJlbmRlcmVkT2JqZWN0KHQpKXJldHVybiB0aGlzLmxhc3RSZW5kZXJlZE9iamVjdFdpdGhDb250cm9sc0Fib3ZlT3ZlcmxheTt2YXIgaT10aGlzLmdldEFjdGl2ZUdyb3VwKCk7aWYoaSYmIWUmJnRoaXMuY29udGFpbnNQb2ludCh0LGkpKXJldHVybiBpO3ZhciByPXRoaXMuX3NlYXJjaFBvc3NpYmxlVGFyZ2V0cyh0KTtyZXR1cm4gdGhpcy5fZmlyZU92ZXJPdXRFdmVudHMocix0KSxyfX0sX2ZpcmVPdmVyT3V0RXZlbnRzOmZ1bmN0aW9uKHQsZSl7dD90aGlzLl9ob3ZlcmVkVGFyZ2V0IT09dCYmKHRoaXMuX2hvdmVyZWRUYXJnZXQmJih0aGlzLmZpcmUoXCJtb3VzZTpvdXRcIix7dGFyZ2V0OnRoaXMuX2hvdmVyZWRUYXJnZXQsZTplfSksdGhpcy5faG92ZXJlZFRhcmdldC5maXJlKFwibW91c2VvdXRcIikpLHRoaXMuZmlyZShcIm1vdXNlOm92ZXJcIix7dGFyZ2V0OnQsZTplfSksdC5maXJlKFwibW91c2VvdmVyXCIpLHRoaXMuX2hvdmVyZWRUYXJnZXQ9dCk6dGhpcy5faG92ZXJlZFRhcmdldCYmKHRoaXMuZmlyZShcIm1vdXNlOm91dFwiLHt0YXJnZXQ6dGhpcy5faG92ZXJlZFRhcmdldCxlOmV9KSx0aGlzLl9ob3ZlcmVkVGFyZ2V0LmZpcmUoXCJtb3VzZW91dFwiKSx0aGlzLl9ob3ZlcmVkVGFyZ2V0PW51bGwpfSxfY2hlY2tUYXJnZXQ6ZnVuY3Rpb24odCxlLGkpe2lmKGUmJmUudmlzaWJsZSYmZS5ldmVudGVkJiZ0aGlzLmNvbnRhaW5zUG9pbnQodCxlKSl7aWYoIXRoaXMucGVyUGl4ZWxUYXJnZXRGaW5kJiYhZS5wZXJQaXhlbFRhcmdldEZpbmR8fGUuaXNFZGl0aW5nKXJldHVybiEwO3ZhciByPXRoaXMuaXNUYXJnZXRUcmFuc3BhcmVudChlLGkueCxpLnkpO2lmKCFyKXJldHVybiEwfX0sX3NlYXJjaFBvc3NpYmxlVGFyZ2V0czpmdW5jdGlvbih0KXtmb3IodmFyIGUsaT10aGlzLmdldFBvaW50ZXIodCwhMCkscj10aGlzLl9vYmplY3RzLmxlbmd0aDtyLS07KWlmKCF0aGlzLl9vYmplY3RzW3JdLmdyb3VwJiZ0aGlzLl9jaGVja1RhcmdldCh0LHRoaXMuX29iamVjdHNbcl0saSkpe3RoaXMucmVsYXRlZFRhcmdldD10aGlzLl9vYmplY3RzW3JdLGU9dGhpcy5fb2JqZWN0c1tyXTticmVha31yZXR1cm4gZX0sZ2V0UG9pbnRlcjpmdW5jdGlvbihlLGkscil7cnx8KHI9dGhpcy51cHBlckNhbnZhc0VsKTt2YXIgcyxuPXQoZSxyKSxvPXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksYT1vLndpZHRofHwwLGg9by5oZWlnaHR8fDA7cmV0dXJuIGEmJmh8fChcInRvcFwiaW4gbyYmXCJib3R0b21cImluIG8mJihoPU1hdGguYWJzKG8udG9wLW8uYm90dG9tKSksXCJyaWdodFwiaW4gbyYmXCJsZWZ0XCJpbiBvJiYoYT1NYXRoLmFicyhvLnJpZ2h0LW8ubGVmdCkpKSx0aGlzLmNhbGNPZmZzZXQoKSxuLng9bi54LXRoaXMuX29mZnNldC5sZWZ0LG4ueT1uLnktdGhpcy5fb2Zmc2V0LnRvcCxpfHwobj1mYWJyaWMudXRpbC50cmFuc2Zvcm1Qb2ludChuLGZhYnJpYy51dGlsLmludmVydFRyYW5zZm9ybSh0aGlzLnZpZXdwb3J0VHJhbnNmb3JtKSkpLHM9MD09PWF8fDA9PT1oP3t3aWR0aDoxLGhlaWdodDoxfTp7d2lkdGg6ci53aWR0aC9hLGhlaWdodDpyLmhlaWdodC9ofSx7eDpuLngqcy53aWR0aCx5Om4ueSpzLmhlaWdodH19LF9jcmVhdGVVcHBlckNhbnZhczpmdW5jdGlvbigpe3ZhciB0PXRoaXMubG93ZXJDYW52YXNFbC5jbGFzc05hbWUucmVwbGFjZSgvXFxzKmxvd2VyLWNhbnZhc1xccyovLFwiXCIpO3RoaXMudXBwZXJDYW52YXNFbD10aGlzLl9jcmVhdGVDYW52YXNFbGVtZW50KCksZmFicmljLnV0aWwuYWRkQ2xhc3ModGhpcy51cHBlckNhbnZhc0VsLFwidXBwZXItY2FudmFzIFwiK3QpLHRoaXMud3JhcHBlckVsLmFwcGVuZENoaWxkKHRoaXMudXBwZXJDYW52YXNFbCksdGhpcy5fY29weUNhbnZhc1N0eWxlKHRoaXMubG93ZXJDYW52YXNFbCx0aGlzLnVwcGVyQ2FudmFzRWwpLHRoaXMuX2FwcGx5Q2FudmFzU3R5bGUodGhpcy51cHBlckNhbnZhc0VsKSx0aGlzLmNvbnRleHRUb3A9dGhpcy51cHBlckNhbnZhc0VsLmdldENvbnRleHQoXCIyZFwiKX0sX2NyZWF0ZUNhY2hlQ2FudmFzOmZ1bmN0aW9uKCl7dGhpcy5jYWNoZUNhbnZhc0VsPXRoaXMuX2NyZWF0ZUNhbnZhc0VsZW1lbnQoKSx0aGlzLmNhY2hlQ2FudmFzRWwuc2V0QXR0cmlidXRlKFwid2lkdGhcIix0aGlzLndpZHRoKSx0aGlzLmNhY2hlQ2FudmFzRWwuc2V0QXR0cmlidXRlKFwiaGVpZ2h0XCIsdGhpcy5oZWlnaHQpLHRoaXMuY29udGV4dENhY2hlPXRoaXMuY2FjaGVDYW52YXNFbC5nZXRDb250ZXh0KFwiMmRcIil9LF9pbml0V3JhcHBlckVsZW1lbnQ6ZnVuY3Rpb24oKXt0aGlzLndyYXBwZXJFbD1mYWJyaWMudXRpbC53cmFwRWxlbWVudCh0aGlzLmxvd2VyQ2FudmFzRWwsXCJkaXZcIix7XCJjbGFzc1wiOnRoaXMuY29udGFpbmVyQ2xhc3N9KSxmYWJyaWMudXRpbC5zZXRTdHlsZSh0aGlzLndyYXBwZXJFbCx7d2lkdGg6dGhpcy5nZXRXaWR0aCgpK1wicHhcIixoZWlnaHQ6dGhpcy5nZXRIZWlnaHQoKStcInB4XCIscG9zaXRpb246XCJyZWxhdGl2ZVwifSksZmFicmljLnV0aWwubWFrZUVsZW1lbnRVbnNlbGVjdGFibGUodGhpcy53cmFwcGVyRWwpfSxfYXBwbHlDYW52YXNTdHlsZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldFdpZHRoKCl8fHQud2lkdGgsaT10aGlzLmdldEhlaWdodCgpfHx0LmhlaWdodDtmYWJyaWMudXRpbC5zZXRTdHlsZSh0LHtwb3NpdGlvbjpcImFic29sdXRlXCIsd2lkdGg6ZStcInB4XCIsaGVpZ2h0OmkrXCJweFwiLGxlZnQ6MCx0b3A6MH0pLHQud2lkdGg9ZSx0LmhlaWdodD1pLGZhYnJpYy51dGlsLm1ha2VFbGVtZW50VW5zZWxlY3RhYmxlKHQpfSxfY29weUNhbnZhc1N0eWxlOmZ1bmN0aW9uKHQsZSl7ZS5zdHlsZS5jc3NUZXh0PXQuc3R5bGUuY3NzVGV4dH0sZ2V0U2VsZWN0aW9uQ29udGV4dDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnRleHRUb3B9LGdldFNlbGVjdGlvbkVsZW1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy51cHBlckNhbnZhc0VsfSxfc2V0QWN0aXZlT2JqZWN0OmZ1bmN0aW9uKHQpe3RoaXMuX2FjdGl2ZU9iamVjdCYmdGhpcy5fYWN0aXZlT2JqZWN0LnNldChcImFjdGl2ZVwiLCExKSx0aGlzLl9hY3RpdmVPYmplY3Q9dCx0LnNldChcImFjdGl2ZVwiLCEwKX0sc2V0QWN0aXZlT2JqZWN0OmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuX3NldEFjdGl2ZU9iamVjdCh0KSx0aGlzLnJlbmRlckFsbCgpLHRoaXMuZmlyZShcIm9iamVjdDpzZWxlY3RlZFwiLHt0YXJnZXQ6dCxlOmV9KSx0LmZpcmUoXCJzZWxlY3RlZFwiLHtlOmV9KSx0aGlzfSxnZXRBY3RpdmVPYmplY3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYWN0aXZlT2JqZWN0fSxfZGlzY2FyZEFjdGl2ZU9iamVjdDpmdW5jdGlvbigpe3RoaXMuX2FjdGl2ZU9iamVjdCYmdGhpcy5fYWN0aXZlT2JqZWN0LnNldChcImFjdGl2ZVwiLCExKSx0aGlzLl9hY3RpdmVPYmplY3Q9bnVsbH0sZGlzY2FyZEFjdGl2ZU9iamVjdDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fZGlzY2FyZEFjdGl2ZU9iamVjdCgpLHRoaXMucmVuZGVyQWxsKCksdGhpcy5maXJlKFwic2VsZWN0aW9uOmNsZWFyZWRcIix7ZTp0fSksdGhpc30sX3NldEFjdGl2ZUdyb3VwOmZ1bmN0aW9uKHQpe3RoaXMuX2FjdGl2ZUdyb3VwPXQsdCYmdC5zZXQoXCJhY3RpdmVcIiwhMCl9LHNldEFjdGl2ZUdyb3VwOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuX3NldEFjdGl2ZUdyb3VwKHQpLHQmJih0aGlzLmZpcmUoXCJvYmplY3Q6c2VsZWN0ZWRcIix7dGFyZ2V0OnQsZTplfSksdC5maXJlKFwic2VsZWN0ZWRcIix7ZTplfSkpLHRoaXN9LGdldEFjdGl2ZUdyb3VwOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZUdyb3VwfSxfZGlzY2FyZEFjdGl2ZUdyb3VwOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXRBY3RpdmVHcm91cCgpO3QmJnQuZGVzdHJveSgpLHRoaXMuc2V0QWN0aXZlR3JvdXAobnVsbCl9LGRpc2NhcmRBY3RpdmVHcm91cDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fZGlzY2FyZEFjdGl2ZUdyb3VwKCksdGhpcy5maXJlKFwic2VsZWN0aW9uOmNsZWFyZWRcIix7ZTp0fSksdGhpc30sZGVhY3RpdmF0ZUFsbDpmdW5jdGlvbigpe2Zvcih2YXIgdD10aGlzLmdldE9iamVjdHMoKSxlPTAsaT10Lmxlbmd0aDtpPmU7ZSsrKXRbZV0uc2V0KFwiYWN0aXZlXCIsITEpO3JldHVybiB0aGlzLl9kaXNjYXJkQWN0aXZlR3JvdXAoKSx0aGlzLl9kaXNjYXJkQWN0aXZlT2JqZWN0KCksdGhpc30sZGVhY3RpdmF0ZUFsbFdpdGhEaXNwYXRjaDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldEFjdGl2ZUdyb3VwKCl8fHRoaXMuZ2V0QWN0aXZlT2JqZWN0KCk7cmV0dXJuIGUmJnRoaXMuZmlyZShcImJlZm9yZTpzZWxlY3Rpb246Y2xlYXJlZFwiLHt0YXJnZXQ6ZSxlOnR9KSx0aGlzLmRlYWN0aXZhdGVBbGwoKSxlJiZ0aGlzLmZpcmUoXCJzZWxlY3Rpb246Y2xlYXJlZFwiLHtlOnR9KSx0aGlzfSxkcmF3Q29udHJvbHM6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXRBY3RpdmVHcm91cCgpO2U/dGhpcy5fZHJhd0dyb3VwQ29udHJvbHModCxlKTp0aGlzLl9kcmF3T2JqZWN0c0NvbnRyb2xzKHQpfSxfZHJhd0dyb3VwQ29udHJvbHM6ZnVuY3Rpb24odCxlKXtlLl9yZW5kZXJDb250cm9scyh0KX0sX2RyYXdPYmplY3RzQ29udHJvbHM6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTAsaT10aGlzLl9vYmplY3RzLmxlbmd0aDtpPmU7KytlKXRoaXMuX29iamVjdHNbZV0mJnRoaXMuX29iamVjdHNbZV0uYWN0aXZlJiYodGhpcy5fb2JqZWN0c1tlXS5fcmVuZGVyQ29udHJvbHModCksdGhpcy5sYXN0UmVuZGVyZWRPYmplY3RXaXRoQ29udHJvbHNBYm92ZU92ZXJsYXk9dGhpcy5fb2JqZWN0c1tlXSl9fSk7Zm9yKHZhciBvIGluIGZhYnJpYy5TdGF0aWNDYW52YXMpXCJwcm90b3R5cGVcIiE9PW8mJihmYWJyaWMuQ2FudmFzW29dPWZhYnJpYy5TdGF0aWNDYW52YXNbb10pO2ZhYnJpYy5pc1RvdWNoU3VwcG9ydGVkJiYoZmFicmljLkNhbnZhcy5wcm90b3R5cGUuX3NldEN1cnNvckZyb21FdmVudD1mdW5jdGlvbigpe30pLGZhYnJpYy5FbGVtZW50PWZhYnJpYy5DYW52YXN9KCksZnVuY3Rpb24oKXt2YXIgdD17bXQ6MCx0cjoxLG1yOjIsYnI6MyxtYjo0LGJsOjUsbWw6Nix0bDo3fSxlPWZhYnJpYy51dGlsLmFkZExpc3RlbmVyLGk9ZmFicmljLnV0aWwucmVtb3ZlTGlzdGVuZXI7ZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuQ2FudmFzLnByb3RvdHlwZSx7Y3Vyc29yTWFwOltcIm4tcmVzaXplXCIsXCJuZS1yZXNpemVcIixcImUtcmVzaXplXCIsXCJzZS1yZXNpemVcIixcInMtcmVzaXplXCIsXCJzdy1yZXNpemVcIixcInctcmVzaXplXCIsXCJudy1yZXNpemVcIl0sX2luaXRFdmVudExpc3RlbmVyczpmdW5jdGlvbigpe3RoaXMuX2JpbmRFdmVudHMoKSxlKGZhYnJpYy53aW5kb3csXCJyZXNpemVcIix0aGlzLl9vblJlc2l6ZSksZSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJtb3VzZWRvd25cIix0aGlzLl9vbk1vdXNlRG93biksZSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJtb3VzZW1vdmVcIix0aGlzLl9vbk1vdXNlTW92ZSksZSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJtb3VzZXdoZWVsXCIsdGhpcy5fb25Nb3VzZVdoZWVsKSxlKHRoaXMudXBwZXJDYW52YXNFbCxcInRvdWNoc3RhcnRcIix0aGlzLl9vbk1vdXNlRG93biksZSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJ0b3VjaG1vdmVcIix0aGlzLl9vbk1vdXNlTW92ZSksXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV2ZW50anMmJlwiYWRkXCJpbiBldmVudGpzJiYoZXZlbnRqcy5hZGQodGhpcy51cHBlckNhbnZhc0VsLFwiZ2VzdHVyZVwiLHRoaXMuX29uR2VzdHVyZSksZXZlbnRqcy5hZGQodGhpcy51cHBlckNhbnZhc0VsLFwiZHJhZ1wiLHRoaXMuX29uRHJhZyksZXZlbnRqcy5hZGQodGhpcy51cHBlckNhbnZhc0VsLFwib3JpZW50YXRpb25cIix0aGlzLl9vbk9yaWVudGF0aW9uQ2hhbmdlKSxldmVudGpzLmFkZCh0aGlzLnVwcGVyQ2FudmFzRWwsXCJzaGFrZVwiLHRoaXMuX29uU2hha2UpLGV2ZW50anMuYWRkKHRoaXMudXBwZXJDYW52YXNFbCxcImxvbmdwcmVzc1wiLHRoaXMuX29uTG9uZ1ByZXNzKSl9LF9iaW5kRXZlbnRzOmZ1bmN0aW9uKCl7dGhpcy5fb25Nb3VzZURvd249dGhpcy5fb25Nb3VzZURvd24uYmluZCh0aGlzKSx0aGlzLl9vbk1vdXNlTW92ZT10aGlzLl9vbk1vdXNlTW92ZS5iaW5kKHRoaXMpLHRoaXMuX29uTW91c2VVcD10aGlzLl9vbk1vdXNlVXAuYmluZCh0aGlzKSx0aGlzLl9vblJlc2l6ZT10aGlzLl9vblJlc2l6ZS5iaW5kKHRoaXMpLHRoaXMuX29uR2VzdHVyZT10aGlzLl9vbkdlc3R1cmUuYmluZCh0aGlzKSx0aGlzLl9vbkRyYWc9dGhpcy5fb25EcmFnLmJpbmQodGhpcyksdGhpcy5fb25TaGFrZT10aGlzLl9vblNoYWtlLmJpbmQodGhpcyksdGhpcy5fb25Mb25nUHJlc3M9dGhpcy5fb25Mb25nUHJlc3MuYmluZCh0aGlzKSx0aGlzLl9vbk9yaWVudGF0aW9uQ2hhbmdlPXRoaXMuX29uT3JpZW50YXRpb25DaGFuZ2UuYmluZCh0aGlzKSx0aGlzLl9vbk1vdXNlV2hlZWw9dGhpcy5fb25Nb3VzZVdoZWVsLmJpbmQodGhpcyl9LHJlbW92ZUxpc3RlbmVyczpmdW5jdGlvbigpe2koZmFicmljLndpbmRvdyxcInJlc2l6ZVwiLHRoaXMuX29uUmVzaXplKSxpKHRoaXMudXBwZXJDYW52YXNFbCxcIm1vdXNlZG93blwiLHRoaXMuX29uTW91c2VEb3duKSxpKHRoaXMudXBwZXJDYW52YXNFbCxcIm1vdXNlbW92ZVwiLHRoaXMuX29uTW91c2VNb3ZlKSxpKHRoaXMudXBwZXJDYW52YXNFbCxcIm1vdXNld2hlZWxcIix0aGlzLl9vbk1vdXNlV2hlZWwpLGkodGhpcy51cHBlckNhbnZhc0VsLFwidG91Y2hzdGFydFwiLHRoaXMuX29uTW91c2VEb3duKSxpKHRoaXMudXBwZXJDYW52YXNFbCxcInRvdWNobW92ZVwiLHRoaXMuX29uTW91c2VNb3ZlKSxcInVuZGVmaW5lZFwiIT10eXBlb2YgZXZlbnRqcyYmXCJyZW1vdmVcImluIGV2ZW50anMmJihldmVudGpzLnJlbW92ZSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJnZXN0dXJlXCIsdGhpcy5fb25HZXN0dXJlKSxldmVudGpzLnJlbW92ZSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJkcmFnXCIsdGhpcy5fb25EcmFnKSxldmVudGpzLnJlbW92ZSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJvcmllbnRhdGlvblwiLHRoaXMuX29uT3JpZW50YXRpb25DaGFuZ2UpLGV2ZW50anMucmVtb3ZlKHRoaXMudXBwZXJDYW52YXNFbCxcInNoYWtlXCIsdGhpcy5fb25TaGFrZSksZXZlbnRqcy5yZW1vdmUodGhpcy51cHBlckNhbnZhc0VsLFwibG9uZ3ByZXNzXCIsdGhpcy5fb25Mb25nUHJlc3MpKX0sX29uR2VzdHVyZTpmdW5jdGlvbih0LGUpe3RoaXMuX19vblRyYW5zZm9ybUdlc3R1cmUmJnRoaXMuX19vblRyYW5zZm9ybUdlc3R1cmUodCxlKX0sX29uRHJhZzpmdW5jdGlvbih0LGUpe3RoaXMuX19vbkRyYWcmJnRoaXMuX19vbkRyYWcodCxlKX0sX29uTW91c2VXaGVlbDpmdW5jdGlvbih0LGUpe3RoaXMuX19vbk1vdXNlV2hlZWwmJnRoaXMuX19vbk1vdXNlV2hlZWwodCxlKX0sX29uT3JpZW50YXRpb25DaGFuZ2U6ZnVuY3Rpb24odCxlKXt0aGlzLl9fb25PcmllbnRhdGlvbkNoYW5nZSYmdGhpcy5fX29uT3JpZW50YXRpb25DaGFuZ2UodCxlKX0sX29uU2hha2U6ZnVuY3Rpb24odCxlKXt0aGlzLl9fb25TaGFrZSYmdGhpcy5fX29uU2hha2UodCxlKX0sX29uTG9uZ1ByZXNzOmZ1bmN0aW9uKHQsZSl7dGhpcy5fX29uTG9uZ1ByZXNzJiZ0aGlzLl9fb25Mb25nUHJlc3ModCxlKX0sX29uTW91c2VEb3duOmZ1bmN0aW9uKHQpe3RoaXMuX19vbk1vdXNlRG93bih0KSxlKGZhYnJpYy5kb2N1bWVudCxcInRvdWNoZW5kXCIsdGhpcy5fb25Nb3VzZVVwKSxlKGZhYnJpYy5kb2N1bWVudCxcInRvdWNobW92ZVwiLHRoaXMuX29uTW91c2VNb3ZlKSxpKHRoaXMudXBwZXJDYW52YXNFbCxcIm1vdXNlbW92ZVwiLHRoaXMuX29uTW91c2VNb3ZlKSxpKHRoaXMudXBwZXJDYW52YXNFbCxcInRvdWNobW92ZVwiLHRoaXMuX29uTW91c2VNb3ZlKSxcInRvdWNoc3RhcnRcIj09PXQudHlwZT9pKHRoaXMudXBwZXJDYW52YXNFbCxcIm1vdXNlZG93blwiLHRoaXMuX29uTW91c2VEb3duKTooZShmYWJyaWMuZG9jdW1lbnQsXCJtb3VzZXVwXCIsdGhpcy5fb25Nb3VzZVVwKSxlKGZhYnJpYy5kb2N1bWVudCxcIm1vdXNlbW92ZVwiLHRoaXMuX29uTW91c2VNb3ZlKSl9LF9vbk1vdXNlVXA6ZnVuY3Rpb24odCl7aWYodGhpcy5fX29uTW91c2VVcCh0KSxpKGZhYnJpYy5kb2N1bWVudCxcIm1vdXNldXBcIix0aGlzLl9vbk1vdXNlVXApLGkoZmFicmljLmRvY3VtZW50LFwidG91Y2hlbmRcIix0aGlzLl9vbk1vdXNlVXApLGkoZmFicmljLmRvY3VtZW50LFwibW91c2Vtb3ZlXCIsdGhpcy5fb25Nb3VzZU1vdmUpLGkoZmFicmljLmRvY3VtZW50LFwidG91Y2htb3ZlXCIsdGhpcy5fb25Nb3VzZU1vdmUpLGUodGhpcy51cHBlckNhbnZhc0VsLFwibW91c2Vtb3ZlXCIsdGhpcy5fb25Nb3VzZU1vdmUpLGUodGhpcy51cHBlckNhbnZhc0VsLFwidG91Y2htb3ZlXCIsdGhpcy5fb25Nb3VzZU1vdmUpLFwidG91Y2hlbmRcIj09PXQudHlwZSl7dmFyIHI9dGhpcztzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZShyLnVwcGVyQ2FudmFzRWwsXCJtb3VzZWRvd25cIixyLl9vbk1vdXNlRG93bil9LDQwMCl9fSxfb25Nb3VzZU1vdmU6ZnVuY3Rpb24odCl7IXRoaXMuYWxsb3dUb3VjaFNjcm9sbGluZyYmdC5wcmV2ZW50RGVmYXVsdCYmdC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuX19vbk1vdXNlTW92ZSh0KX0sX29uUmVzaXplOmZ1bmN0aW9uKCl7dGhpcy5jYWxjT2Zmc2V0KCl9LF9zaG91bGRSZW5kZXI6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLmdldEFjdGl2ZUdyb3VwKCl8fHRoaXMuZ2V0QWN0aXZlT2JqZWN0KCk7cmV0dXJuISEodCYmKHQuaXNNb3Zpbmd8fHQhPT1pKXx8IXQmJml8fCF0JiYhaSYmIXRoaXMuX2dyb3VwU2VsZWN0b3J8fGUmJnRoaXMuX3ByZXZpb3VzUG9pbnRlciYmdGhpcy5zZWxlY3Rpb24mJihlLnghPT10aGlzLl9wcmV2aW91c1BvaW50ZXIueHx8ZS55IT09dGhpcy5fcHJldmlvdXNQb2ludGVyLnkpKX0sX19vbk1vdXNlVXA6ZnVuY3Rpb24odCl7dmFyIGU7aWYodGhpcy5pc0RyYXdpbmdNb2RlJiZ0aGlzLl9pc0N1cnJlbnRseURyYXdpbmcpcmV0dXJuIHZvaWQgdGhpcy5fb25Nb3VzZVVwSW5EcmF3aW5nTW9kZSh0KTt0aGlzLl9jdXJyZW50VHJhbnNmb3JtPyh0aGlzLl9maW5hbGl6ZUN1cnJlbnRUcmFuc2Zvcm0oKSxlPXRoaXMuX2N1cnJlbnRUcmFuc2Zvcm0udGFyZ2V0KTplPXRoaXMuZmluZFRhcmdldCh0LCEwKTt2YXIgaT10aGlzLl9zaG91bGRSZW5kZXIoZSx0aGlzLmdldFBvaW50ZXIodCkpO3RoaXMuX21heWJlR3JvdXBPYmplY3RzKHQpLGUmJihlLmlzTW92aW5nPSExKSxpJiZ0aGlzLnJlbmRlckFsbCgpLHRoaXMuX2hhbmRsZUN1cnNvckFuZEV2ZW50KHQsZSl9LF9oYW5kbGVDdXJzb3JBbmRFdmVudDpmdW5jdGlvbih0LGUpe3RoaXMuX3NldEN1cnNvckZyb21FdmVudCh0LGUpO3ZhciBpPXRoaXM7c2V0VGltZW91dChmdW5jdGlvbigpe2kuX3NldEN1cnNvckZyb21FdmVudCh0LGUpfSw1MCksdGhpcy5maXJlKFwibW91c2U6dXBcIix7dGFyZ2V0OmUsZTp0fSksZSYmZS5maXJlKFwibW91c2V1cFwiLHtlOnR9KX0sX2ZpbmFsaXplQ3VycmVudFRyYW5zZm9ybTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX2N1cnJlbnRUcmFuc2Zvcm0sZT10LnRhcmdldDtlLl9zY2FsaW5nJiYoZS5fc2NhbGluZz0hMSksZS5zZXRDb29yZHMoKSx0aGlzLnN0YXRlZnVsJiZlLmhhc1N0YXRlQ2hhbmdlZCgpJiYodGhpcy5maXJlKFwib2JqZWN0Om1vZGlmaWVkXCIse3RhcmdldDplfSksZS5maXJlKFwibW9kaWZpZWRcIikpLHRoaXMuX3Jlc3RvcmVPcmlnaW5YWShlKX0sX3Jlc3RvcmVPcmlnaW5YWTpmdW5jdGlvbih0KXtpZih0aGlzLl9wcmV2aW91c09yaWdpblgmJnRoaXMuX3ByZXZpb3VzT3JpZ2luWSl7dmFyIGU9dC50cmFuc2xhdGVUb09yaWdpblBvaW50KHQuZ2V0Q2VudGVyUG9pbnQoKSx0aGlzLl9wcmV2aW91c09yaWdpblgsdGhpcy5fcHJldmlvdXNPcmlnaW5ZKTt0Lm9yaWdpblg9dGhpcy5fcHJldmlvdXNPcmlnaW5YLHQub3JpZ2luWT10aGlzLl9wcmV2aW91c09yaWdpblksdC5sZWZ0PWUueCx0LnRvcD1lLnksdGhpcy5fcHJldmlvdXNPcmlnaW5YPW51bGwsdGhpcy5fcHJldmlvdXNPcmlnaW5ZPW51bGx9fSxfb25Nb3VzZURvd25JbkRyYXdpbmdNb2RlOmZ1bmN0aW9uKHQpe3RoaXMuX2lzQ3VycmVudGx5RHJhd2luZz0hMCx0aGlzLmRpc2NhcmRBY3RpdmVPYmplY3QodCkucmVuZGVyQWxsKCksdGhpcy5jbGlwVG8mJmZhYnJpYy51dGlsLmNsaXBDb250ZXh0KHRoaXMsdGhpcy5jb250ZXh0VG9wKTt2YXIgZT1mYWJyaWMudXRpbC5pbnZlcnRUcmFuc2Zvcm0odGhpcy52aWV3cG9ydFRyYW5zZm9ybSksaT1mYWJyaWMudXRpbC50cmFuc2Zvcm1Qb2ludCh0aGlzLmdldFBvaW50ZXIodCwhMCksZSk7dGhpcy5mcmVlRHJhd2luZ0JydXNoLm9uTW91c2VEb3duKGkpLHRoaXMuZmlyZShcIm1vdXNlOmRvd25cIix7ZTp0fSk7dmFyIHI9dGhpcy5maW5kVGFyZ2V0KHQpO1widW5kZWZpbmVkXCIhPXR5cGVvZiByJiZyLmZpcmUoXCJtb3VzZWRvd25cIix7ZTp0LHRhcmdldDpyfSl9LF9vbk1vdXNlTW92ZUluRHJhd2luZ01vZGU6ZnVuY3Rpb24odCl7aWYodGhpcy5faXNDdXJyZW50bHlEcmF3aW5nKXt2YXIgZT1mYWJyaWMudXRpbC5pbnZlcnRUcmFuc2Zvcm0odGhpcy52aWV3cG9ydFRyYW5zZm9ybSksaT1mYWJyaWMudXRpbC50cmFuc2Zvcm1Qb2ludCh0aGlzLmdldFBvaW50ZXIodCwhMCksZSk7dGhpcy5mcmVlRHJhd2luZ0JydXNoLm9uTW91c2VNb3ZlKGkpfXRoaXMuc2V0Q3Vyc29yKHRoaXMuZnJlZURyYXdpbmdDdXJzb3IpLHRoaXMuZmlyZShcIm1vdXNlOm1vdmVcIix7ZTp0fSk7dmFyIHI9dGhpcy5maW5kVGFyZ2V0KHQpO1widW5kZWZpbmVkXCIhPXR5cGVvZiByJiZyLmZpcmUoXCJtb3VzZW1vdmVcIix7ZTp0LHRhcmdldDpyfSl9LF9vbk1vdXNlVXBJbkRyYXdpbmdNb2RlOmZ1bmN0aW9uKHQpe3RoaXMuX2lzQ3VycmVudGx5RHJhd2luZz0hMSx0aGlzLmNsaXBUbyYmdGhpcy5jb250ZXh0VG9wLnJlc3RvcmUoKSx0aGlzLmZyZWVEcmF3aW5nQnJ1c2gub25Nb3VzZVVwKCksdGhpcy5maXJlKFwibW91c2U6dXBcIix7ZTp0fSk7dmFyIGU9dGhpcy5maW5kVGFyZ2V0KHQpO1widW5kZWZpbmVkXCIhPXR5cGVvZiBlJiZlLmZpcmUoXCJtb3VzZXVwXCIse2U6dCx0YXJnZXQ6ZX0pfSxfX29uTW91c2VEb3duOmZ1bmN0aW9uKHQpe3ZhciBlPVwid2hpY2hcImluIHQ/MT09PXQud2hpY2g6MT09PXQuYnV0dG9uO2lmKGV8fGZhYnJpYy5pc1RvdWNoU3VwcG9ydGVkKXtpZih0aGlzLmlzRHJhd2luZ01vZGUpcmV0dXJuIHZvaWQgdGhpcy5fb25Nb3VzZURvd25JbkRyYXdpbmdNb2RlKHQpO2lmKCF0aGlzLl9jdXJyZW50VHJhbnNmb3JtKXt2YXIgaT10aGlzLmZpbmRUYXJnZXQodCkscj10aGlzLmdldFBvaW50ZXIodCwhMCk7dGhpcy5fcHJldmlvdXNQb2ludGVyPXI7dmFyIHM9dGhpcy5fc2hvdWxkUmVuZGVyKGksciksbj10aGlzLl9zaG91bGRHcm91cCh0LGkpO3RoaXMuX3Nob3VsZENsZWFyU2VsZWN0aW9uKHQsaSk/dGhpcy5fY2xlYXJTZWxlY3Rpb24odCxpLHIpOm4mJih0aGlzLl9oYW5kbGVHcm91cGluZyh0LGkpLGk9dGhpcy5nZXRBY3RpdmVHcm91cCgpKSxpJiZpLnNlbGVjdGFibGUmJiFuJiYodGhpcy5fYmVmb3JlVHJhbnNmb3JtKHQsaSksdGhpcy5fc2V0dXBDdXJyZW50VHJhbnNmb3JtKHQsaSkpLHMmJnRoaXMucmVuZGVyQWxsKCksdGhpcy5maXJlKFwibW91c2U6ZG93blwiLHt0YXJnZXQ6aSxlOnR9KSxpJiZpLmZpcmUoXCJtb3VzZWRvd25cIix7ZTp0fSl9fX0sX2JlZm9yZVRyYW5zZm9ybTpmdW5jdGlvbih0LGUpe3RoaXMuc3RhdGVmdWwmJmUuc2F2ZVN0YXRlKCksZS5fZmluZFRhcmdldENvcm5lcih0aGlzLmdldFBvaW50ZXIodCkpJiZ0aGlzLm9uQmVmb3JlU2NhbGVSb3RhdGUoZSksZSE9PXRoaXMuZ2V0QWN0aXZlR3JvdXAoKSYmZSE9PXRoaXMuZ2V0QWN0aXZlT2JqZWN0KCkmJih0aGlzLmRlYWN0aXZhdGVBbGwoKSx0aGlzLnNldEFjdGl2ZU9iamVjdChlLHQpKX0sX2NsZWFyU2VsZWN0aW9uOmZ1bmN0aW9uKHQsZSxpKXt0aGlzLmRlYWN0aXZhdGVBbGxXaXRoRGlzcGF0Y2godCksZSYmZS5zZWxlY3RhYmxlP3RoaXMuc2V0QWN0aXZlT2JqZWN0KGUsdCk6dGhpcy5zZWxlY3Rpb24mJih0aGlzLl9ncm91cFNlbGVjdG9yPXtleDppLngsZXk6aS55LHRvcDowLGxlZnQ6MH0pfSxfc2V0T3JpZ2luVG9DZW50ZXI6ZnVuY3Rpb24odCl7dGhpcy5fcHJldmlvdXNPcmlnaW5YPXRoaXMuX2N1cnJlbnRUcmFuc2Zvcm0udGFyZ2V0Lm9yaWdpblgsdGhpcy5fcHJldmlvdXNPcmlnaW5ZPXRoaXMuX2N1cnJlbnRUcmFuc2Zvcm0udGFyZ2V0Lm9yaWdpblk7dmFyIGU9dC5nZXRDZW50ZXJQb2ludCgpO3Qub3JpZ2luWD1cImNlbnRlclwiLHQub3JpZ2luWT1cImNlbnRlclwiLHQubGVmdD1lLngsdC50b3A9ZS55LHRoaXMuX2N1cnJlbnRUcmFuc2Zvcm0ubGVmdD10LmxlZnQsdGhpcy5fY3VycmVudFRyYW5zZm9ybS50b3A9dC50b3B9LF9zZXRDZW50ZXJUb09yaWdpbjpmdW5jdGlvbih0KXt2YXIgZT10LnRyYW5zbGF0ZVRvT3JpZ2luUG9pbnQodC5nZXRDZW50ZXJQb2ludCgpLHRoaXMuX3ByZXZpb3VzT3JpZ2luWCx0aGlzLl9wcmV2aW91c09yaWdpblkpO3Qub3JpZ2luWD10aGlzLl9wcmV2aW91c09yaWdpblgsdC5vcmlnaW5ZPXRoaXMuX3ByZXZpb3VzT3JpZ2luWSx0LmxlZnQ9ZS54LHQudG9wPWUueSx0aGlzLl9wcmV2aW91c09yaWdpblg9bnVsbCx0aGlzLl9wcmV2aW91c09yaWdpblk9bnVsbH0sX19vbk1vdXNlTW92ZTpmdW5jdGlvbih0KXt2YXIgZSxpO2lmKHRoaXMuaXNEcmF3aW5nTW9kZSlyZXR1cm4gdm9pZCB0aGlzLl9vbk1vdXNlTW92ZUluRHJhd2luZ01vZGUodCk7aWYoIShcInVuZGVmaW5lZFwiIT10eXBlb2YgdC50b3VjaGVzJiZ0LnRvdWNoZXMubGVuZ3RoPjEpKXt2YXIgcj10aGlzLl9ncm91cFNlbGVjdG9yO3I/KGk9dGhpcy5nZXRQb2ludGVyKHQsITApLHIubGVmdD1pLngtci5leCxyLnRvcD1pLnktci5leSx0aGlzLnJlbmRlclRvcCgpKTp0aGlzLl9jdXJyZW50VHJhbnNmb3JtP3RoaXMuX3RyYW5zZm9ybU9iamVjdCh0KTooZT10aGlzLmZpbmRUYXJnZXQodCksIWV8fGUmJiFlLnNlbGVjdGFibGU/dGhpcy5zZXRDdXJzb3IodGhpcy5kZWZhdWx0Q3Vyc29yKTp0aGlzLl9zZXRDdXJzb3JGcm9tRXZlbnQodCxlKSksdGhpcy5maXJlKFwibW91c2U6bW92ZVwiLHt0YXJnZXQ6ZSxlOnR9KSxlJiZlLmZpcmUoXCJtb3VzZW1vdmVcIix7ZTp0fSl9fSxfdHJhbnNmb3JtT2JqZWN0OmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0UG9pbnRlcih0KSxpPXRoaXMuX2N1cnJlbnRUcmFuc2Zvcm07aS5yZXNldD0hMSxpLnRhcmdldC5pc01vdmluZz0hMCx0aGlzLl9iZWZvcmVTY2FsZVRyYW5zZm9ybSh0LGkpLHRoaXMuX3BlcmZvcm1UcmFuc2Zvcm1BY3Rpb24odCxpLGUpLHRoaXMucmVuZGVyQWxsKCl9LF9wZXJmb3JtVHJhbnNmb3JtQWN0aW9uOmZ1bmN0aW9uKHQsZSxpKXt2YXIgcj1pLngscz1pLnksbj1lLnRhcmdldCxvPWUuYWN0aW9uO1wicm90YXRlXCI9PT1vPyh0aGlzLl9yb3RhdGVPYmplY3QocixzKSx0aGlzLl9maXJlKFwicm90YXRpbmdcIixuLHQpKTpcInNjYWxlXCI9PT1vPyh0aGlzLl9vblNjYWxlKHQsZSxyLHMpLHRoaXMuX2ZpcmUoXCJzY2FsaW5nXCIsbix0KSk6XCJzY2FsZVhcIj09PW8/KHRoaXMuX3NjYWxlT2JqZWN0KHIscyxcInhcIiksdGhpcy5fZmlyZShcInNjYWxpbmdcIixuLHQpKTpcInNjYWxlWVwiPT09bz8odGhpcy5fc2NhbGVPYmplY3QocixzLFwieVwiKSx0aGlzLl9maXJlKFwic2NhbGluZ1wiLG4sdCkpOih0aGlzLl90cmFuc2xhdGVPYmplY3QocixzKSx0aGlzLl9maXJlKFwibW92aW5nXCIsbix0KSx0aGlzLnNldEN1cnNvcih0aGlzLm1vdmVDdXJzb3IpKX0sX2ZpcmU6ZnVuY3Rpb24odCxlLGkpe3RoaXMuZmlyZShcIm9iamVjdDpcIit0LHt0YXJnZXQ6ZSxlOml9KSxlLmZpcmUodCx7ZTppfSl9LF9iZWZvcmVTY2FsZVRyYW5zZm9ybTpmdW5jdGlvbih0LGUpe2lmKFwic2NhbGVcIj09PWUuYWN0aW9ufHxcInNjYWxlWFwiPT09ZS5hY3Rpb258fFwic2NhbGVZXCI9PT1lLmFjdGlvbil7dmFyIGk9dGhpcy5fc2hvdWxkQ2VudGVyVHJhbnNmb3JtKHQsZS50YXJnZXQpOyhpJiYoXCJjZW50ZXJcIiE9PWUub3JpZ2luWHx8XCJjZW50ZXJcIiE9PWUub3JpZ2luWSl8fCFpJiZcImNlbnRlclwiPT09ZS5vcmlnaW5YJiZcImNlbnRlclwiPT09ZS5vcmlnaW5ZKSYmKHRoaXMuX3Jlc2V0Q3VycmVudFRyYW5zZm9ybSh0KSxlLnJlc2V0PSEwKX19LF9vblNjYWxlOmZ1bmN0aW9uKHQsZSxpLHIpeyF0LnNoaWZ0S2V5JiYhdGhpcy51bmlTY2FsZVRyYW5zZm9ybXx8ZS50YXJnZXQuZ2V0KFwibG9ja1VuaVNjYWxpbmdcIik/KGUucmVzZXR8fFwic2NhbGVcIiE9PWUuY3VycmVudEFjdGlvbnx8dGhpcy5fcmVzZXRDdXJyZW50VHJhbnNmb3JtKHQsZS50YXJnZXQpLGUuY3VycmVudEFjdGlvbj1cInNjYWxlRXF1YWxseVwiLHRoaXMuX3NjYWxlT2JqZWN0KGkscixcImVxdWFsbHlcIikpOihlLmN1cnJlbnRBY3Rpb249XCJzY2FsZVwiLHRoaXMuX3NjYWxlT2JqZWN0KGkscikpO1xyXG5cclxufSxfc2V0Q3Vyc29yRnJvbUV2ZW50OmZ1bmN0aW9uKHQsZSl7aWYoIWV8fCFlLnNlbGVjdGFibGUpcmV0dXJuIHRoaXMuc2V0Q3Vyc29yKHRoaXMuZGVmYXVsdEN1cnNvciksITE7dmFyIGk9dGhpcy5nZXRBY3RpdmVHcm91cCgpLHI9ZS5fZmluZFRhcmdldENvcm5lciYmKCFpfHwhaS5jb250YWlucyhlKSkmJmUuX2ZpbmRUYXJnZXRDb3JuZXIodGhpcy5nZXRQb2ludGVyKHQsITApKTtyZXR1cm4gcj90aGlzLl9zZXRDb3JuZXJDdXJzb3IocixlKTp0aGlzLnNldEN1cnNvcihlLmhvdmVyQ3Vyc29yfHx0aGlzLmhvdmVyQ3Vyc29yKSwhMH0sX3NldENvcm5lckN1cnNvcjpmdW5jdGlvbihlLGkpe2lmKGUgaW4gdCl0aGlzLnNldEN1cnNvcih0aGlzLl9nZXRSb3RhdGVkQ29ybmVyQ3Vyc29yKGUsaSkpO2Vsc2V7aWYoXCJtdHJcIiE9PWV8fCFpLmhhc1JvdGF0aW5nUG9pbnQpcmV0dXJuIHRoaXMuc2V0Q3Vyc29yKHRoaXMuZGVmYXVsdEN1cnNvciksITE7dGhpcy5zZXRDdXJzb3IodGhpcy5yb3RhdGlvbkN1cnNvcil9fSxfZ2V0Um90YXRlZENvcm5lckN1cnNvcjpmdW5jdGlvbihlLGkpe3ZhciByPU1hdGgucm91bmQoaS5nZXRBbmdsZSgpJTM2MC80NSk7cmV0dXJuIDA+ciYmKHIrPTgpLHIrPXRbZV0sciU9OCx0aGlzLmN1cnNvck1hcFtyXX19KX0oKSxmdW5jdGlvbigpe3ZhciB0PU1hdGgubWluLGU9TWF0aC5tYXg7ZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuQ2FudmFzLnByb3RvdHlwZSx7X3Nob3VsZEdyb3VwOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5nZXRBY3RpdmVPYmplY3QoKTtyZXR1cm4gdC5zaGlmdEtleSYmKHRoaXMuZ2V0QWN0aXZlR3JvdXAoKXx8aSYmaSE9PWUpJiZ0aGlzLnNlbGVjdGlvbn0sX2hhbmRsZUdyb3VwaW5nOmZ1bmN0aW9uKHQsZSl7KGUhPT10aGlzLmdldEFjdGl2ZUdyb3VwKCl8fChlPXRoaXMuZmluZFRhcmdldCh0LCEwKSxlJiYhZS5pc1R5cGUoXCJncm91cFwiKSkpJiYodGhpcy5nZXRBY3RpdmVHcm91cCgpP3RoaXMuX3VwZGF0ZUFjdGl2ZUdyb3VwKGUsdCk6dGhpcy5fY3JlYXRlQWN0aXZlR3JvdXAoZSx0KSx0aGlzLl9hY3RpdmVHcm91cCYmdGhpcy5fYWN0aXZlR3JvdXAuc2F2ZUNvb3JkcygpKX0sX3VwZGF0ZUFjdGl2ZUdyb3VwOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5nZXRBY3RpdmVHcm91cCgpO2lmKGkuY29udGFpbnModCkpe2lmKGkucmVtb3ZlV2l0aFVwZGF0ZSh0KSx0aGlzLl9yZXNldE9iamVjdFRyYW5zZm9ybShpKSx0LnNldChcImFjdGl2ZVwiLCExKSwxPT09aS5zaXplKCkpcmV0dXJuIHRoaXMuZGlzY2FyZEFjdGl2ZUdyb3VwKGUpLHZvaWQgdGhpcy5zZXRBY3RpdmVPYmplY3QoaS5pdGVtKDApKX1lbHNlIGkuYWRkV2l0aFVwZGF0ZSh0KSx0aGlzLl9yZXNldE9iamVjdFRyYW5zZm9ybShpKTt0aGlzLmZpcmUoXCJzZWxlY3Rpb246Y3JlYXRlZFwiLHt0YXJnZXQ6aSxlOmV9KSxpLnNldChcImFjdGl2ZVwiLCEwKX0sX2NyZWF0ZUFjdGl2ZUdyb3VwOmZ1bmN0aW9uKHQsZSl7aWYodGhpcy5fYWN0aXZlT2JqZWN0JiZ0IT09dGhpcy5fYWN0aXZlT2JqZWN0KXt2YXIgaT10aGlzLl9jcmVhdGVHcm91cCh0KTtpLmFkZFdpdGhVcGRhdGUoKSx0aGlzLnNldEFjdGl2ZUdyb3VwKGkpLHRoaXMuX2FjdGl2ZU9iamVjdD1udWxsLHRoaXMuZmlyZShcInNlbGVjdGlvbjpjcmVhdGVkXCIse3RhcmdldDppLGU6ZX0pfXQuc2V0KFwiYWN0aXZlXCIsITApfSxfY3JlYXRlR3JvdXA6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXRPYmplY3RzKCksaT1lLmluZGV4T2YodGhpcy5fYWN0aXZlT2JqZWN0KTxlLmluZGV4T2YodCkscj1pP1t0aGlzLl9hY3RpdmVPYmplY3QsdF06W3QsdGhpcy5fYWN0aXZlT2JqZWN0XTtyZXR1cm4gbmV3IGZhYnJpYy5Hcm91cChyLHtjYW52YXM6dGhpc30pfSxfZ3JvdXBTZWxlY3RlZE9iamVjdHM6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fY29sbGVjdE9iamVjdHMoKTsxPT09ZS5sZW5ndGg/dGhpcy5zZXRBY3RpdmVPYmplY3QoZVswXSx0KTplLmxlbmd0aD4xJiYoZT1uZXcgZmFicmljLkdyb3VwKGUucmV2ZXJzZSgpLHtjYW52YXM6dGhpc30pLGUuYWRkV2l0aFVwZGF0ZSgpLHRoaXMuc2V0QWN0aXZlR3JvdXAoZSx0KSxlLnNhdmVDb29yZHMoKSx0aGlzLmZpcmUoXCJzZWxlY3Rpb246Y3JlYXRlZFwiLHt0YXJnZXQ6ZX0pLHRoaXMucmVuZGVyQWxsKCkpfSxfY29sbGVjdE9iamVjdHM6ZnVuY3Rpb24oKXtmb3IodmFyIGkscj1bXSxzPXRoaXMuX2dyb3VwU2VsZWN0b3IuZXgsbj10aGlzLl9ncm91cFNlbGVjdG9yLmV5LG89cyt0aGlzLl9ncm91cFNlbGVjdG9yLmxlZnQsYT1uK3RoaXMuX2dyb3VwU2VsZWN0b3IudG9wLGg9bmV3IGZhYnJpYy5Qb2ludCh0KHMsbyksdChuLGEpKSxjPW5ldyBmYWJyaWMuUG9pbnQoZShzLG8pLGUobixhKSksbD1zPT09byYmbj09PWEsdT10aGlzLl9vYmplY3RzLmxlbmd0aDt1LS0mJihpPXRoaXMuX29iamVjdHNbdV0sIShpJiZpLnNlbGVjdGFibGUmJmkudmlzaWJsZSYmKGkuaW50ZXJzZWN0c1dpdGhSZWN0KGgsYyl8fGkuaXNDb250YWluZWRXaXRoaW5SZWN0KGgsYyl8fGkuY29udGFpbnNQb2ludChoKXx8aS5jb250YWluc1BvaW50KGMpKSYmKGkuc2V0KFwiYWN0aXZlXCIsITApLHIucHVzaChpKSxsKSkpOyk7cmV0dXJuIHJ9LF9tYXliZUdyb3VwT2JqZWN0czpmdW5jdGlvbih0KXt0aGlzLnNlbGVjdGlvbiYmdGhpcy5fZ3JvdXBTZWxlY3RvciYmdGhpcy5fZ3JvdXBTZWxlY3RlZE9iamVjdHModCk7dmFyIGU9dGhpcy5nZXRBY3RpdmVHcm91cCgpO2UmJihlLnNldE9iamVjdHNDb29yZHMoKS5zZXRDb29yZHMoKSxlLmlzTW92aW5nPSExLHRoaXMuc2V0Q3Vyc29yKHRoaXMuZGVmYXVsdEN1cnNvcikpLHRoaXMuX2dyb3VwU2VsZWN0b3I9bnVsbCx0aGlzLl9jdXJyZW50VHJhbnNmb3JtPW51bGx9fSl9KCksZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZSx7dG9EYXRhVVJMOmZ1bmN0aW9uKHQpe3R8fCh0PXt9KTt2YXIgZT10LmZvcm1hdHx8XCJwbmdcIixpPXQucXVhbGl0eXx8MSxyPXQubXVsdGlwbGllcnx8MSxzPXtsZWZ0OnQubGVmdCx0b3A6dC50b3Asd2lkdGg6dC53aWR0aCxoZWlnaHQ6dC5oZWlnaHR9O3JldHVybiAxIT09cj90aGlzLl9fdG9EYXRhVVJMV2l0aE11bHRpcGxpZXIoZSxpLHMscik6dGhpcy5fX3RvRGF0YVVSTChlLGkscyl9LF9fdG9EYXRhVVJMOmZ1bmN0aW9uKHQsZSxpKXt0aGlzLnJlbmRlckFsbCghMCk7dmFyIHI9dGhpcy51cHBlckNhbnZhc0VsfHx0aGlzLmxvd2VyQ2FudmFzRWwscz10aGlzLl9fZ2V0Q3JvcHBlZENhbnZhcyhyLGkpO1wianBnXCI9PT10JiYodD1cImpwZWdcIik7dmFyIG49ZmFicmljLlN0YXRpY0NhbnZhcy5zdXBwb3J0cyhcInRvRGF0YVVSTFdpdGhRdWFsaXR5XCIpPyhzfHxyKS50b0RhdGFVUkwoXCJpbWFnZS9cIit0LGUpOihzfHxyKS50b0RhdGFVUkwoXCJpbWFnZS9cIit0KTtyZXR1cm4gdGhpcy5jb250ZXh0VG9wJiZ0aGlzLmNsZWFyQ29udGV4dCh0aGlzLmNvbnRleHRUb3ApLHRoaXMucmVuZGVyQWxsKCkscyYmKHM9bnVsbCksbn0sX19nZXRDcm9wcGVkQ2FudmFzOmZ1bmN0aW9uKHQsZSl7dmFyIGkscixzPVwibGVmdFwiaW4gZXx8XCJ0b3BcImluIGV8fFwid2lkdGhcImluIGV8fFwiaGVpZ2h0XCJpbiBlO3JldHVybiBzJiYoaT1mYWJyaWMudXRpbC5jcmVhdGVDYW52YXNFbGVtZW50KCkscj1pLmdldENvbnRleHQoXCIyZFwiKSxpLndpZHRoPWUud2lkdGh8fHRoaXMud2lkdGgsaS5oZWlnaHQ9ZS5oZWlnaHR8fHRoaXMuaGVpZ2h0LHIuZHJhd0ltYWdlKHQsLWUubGVmdHx8MCwtZS50b3B8fDApKSxpfSxfX3RvRGF0YVVSTFdpdGhNdWx0aXBsaWVyOmZ1bmN0aW9uKHQsZSxpLHIpe3ZhciBzPXRoaXMuZ2V0V2lkdGgoKSxuPXRoaXMuZ2V0SGVpZ2h0KCksbz1zKnIsYT1uKnIsaD10aGlzLmdldEFjdGl2ZU9iamVjdCgpLGM9dGhpcy5nZXRBY3RpdmVHcm91cCgpLGw9dGhpcy5jb250ZXh0VG9wfHx0aGlzLmNvbnRleHRDb250YWluZXI7cj4xJiZ0aGlzLnNldFdpZHRoKG8pLnNldEhlaWdodChhKSxsLnNjYWxlKHIsciksaS5sZWZ0JiYoaS5sZWZ0Kj1yKSxpLnRvcCYmKGkudG9wKj1yKSxpLndpZHRoP2kud2lkdGgqPXI6MT5yJiYoaS53aWR0aD1vKSxpLmhlaWdodD9pLmhlaWdodCo9cjoxPnImJihpLmhlaWdodD1hKSxjP3RoaXMuX3RlbXBSZW1vdmVCb3JkZXJzQ29udHJvbHNGcm9tR3JvdXAoYyk6aCYmdGhpcy5kZWFjdGl2YXRlQWxsJiZ0aGlzLmRlYWN0aXZhdGVBbGwoKSx0aGlzLnJlbmRlckFsbCghMCk7dmFyIHU9dGhpcy5fX3RvRGF0YVVSTCh0LGUsaSk7cmV0dXJuIHRoaXMud2lkdGg9cyx0aGlzLmhlaWdodD1uLGwuc2NhbGUoMS9yLDEvciksdGhpcy5zZXRXaWR0aChzKS5zZXRIZWlnaHQobiksYz90aGlzLl9yZXN0b3JlQm9yZGVyc0NvbnRyb2xzT25Hcm91cChjKTpoJiZ0aGlzLnNldEFjdGl2ZU9iamVjdCYmdGhpcy5zZXRBY3RpdmVPYmplY3QoaCksdGhpcy5jb250ZXh0VG9wJiZ0aGlzLmNsZWFyQ29udGV4dCh0aGlzLmNvbnRleHRUb3ApLHRoaXMucmVuZGVyQWxsKCksdX0sdG9EYXRhVVJMV2l0aE11bHRpcGxpZXI6ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0aGlzLnRvRGF0YVVSTCh7Zm9ybWF0OnQsbXVsdGlwbGllcjplLHF1YWxpdHk6aX0pfSxfdGVtcFJlbW92ZUJvcmRlcnNDb250cm9sc0Zyb21Hcm91cDpmdW5jdGlvbih0KXt0Lm9yaWdIYXNDb250cm9scz10Lmhhc0NvbnRyb2xzLHQub3JpZ0JvcmRlckNvbG9yPXQuYm9yZGVyQ29sb3IsdC5oYXNDb250cm9scz0hMCx0LmJvcmRlckNvbG9yPVwicmdiYSgwLDAsMCwwKVwiLHQuZm9yRWFjaE9iamVjdChmdW5jdGlvbih0KXt0Lm9yaWdCb3JkZXJDb2xvcj10LmJvcmRlckNvbG9yLHQuYm9yZGVyQ29sb3I9XCJyZ2JhKDAsMCwwLDApXCJ9KX0sX3Jlc3RvcmVCb3JkZXJzQ29udHJvbHNPbkdyb3VwOmZ1bmN0aW9uKHQpe3QuaGlkZUNvbnRyb2xzPXQub3JpZ0hpZGVDb250cm9scyx0LmJvcmRlckNvbG9yPXQub3JpZ0JvcmRlckNvbG9yLHQuZm9yRWFjaE9iamVjdChmdW5jdGlvbih0KXt0LmJvcmRlckNvbG9yPXQub3JpZ0JvcmRlckNvbG9yLGRlbGV0ZSB0Lm9yaWdCb3JkZXJDb2xvcn0pfX0pLGZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQoZmFicmljLlN0YXRpY0NhbnZhcy5wcm90b3R5cGUse2xvYWRGcm9tRGF0YWxlc3NKU09OOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdGhpcy5sb2FkRnJvbUpTT04odCxlLGkpfSxsb2FkRnJvbUpTT046ZnVuY3Rpb24odCxlLGkpe2lmKHQpe3ZhciByPVwic3RyaW5nXCI9PXR5cGVvZiB0P0pTT04ucGFyc2UodCk6dDt0aGlzLmNsZWFyKCk7dmFyIHM9dGhpcztyZXR1cm4gdGhpcy5fZW5saXZlbk9iamVjdHMoci5vYmplY3RzLGZ1bmN0aW9uKCl7cy5fc2V0QmdPdmVybGF5KHIsZSl9LGkpLHRoaXN9fSxfc2V0QmdPdmVybGF5OmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcyxyPXtiYWNrZ3JvdW5kQ29sb3I6ITEsb3ZlcmxheUNvbG9yOiExLGJhY2tncm91bmRJbWFnZTohMSxvdmVybGF5SW1hZ2U6ITF9O2lmKCEodC5iYWNrZ3JvdW5kSW1hZ2V8fHQub3ZlcmxheUltYWdlfHx0LmJhY2tncm91bmR8fHQub3ZlcmxheSkpcmV0dXJuIHZvaWQoZSYmZSgpKTt2YXIgcz1mdW5jdGlvbigpe3IuYmFja2dyb3VuZEltYWdlJiZyLm92ZXJsYXlJbWFnZSYmci5iYWNrZ3JvdW5kQ29sb3ImJnIub3ZlcmxheUNvbG9yJiYoaS5yZW5kZXJBbGwoKSxlJiZlKCkpfTt0aGlzLl9fc2V0QmdPdmVybGF5KFwiYmFja2dyb3VuZEltYWdlXCIsdC5iYWNrZ3JvdW5kSW1hZ2UscixzKSx0aGlzLl9fc2V0QmdPdmVybGF5KFwib3ZlcmxheUltYWdlXCIsdC5vdmVybGF5SW1hZ2UscixzKSx0aGlzLl9fc2V0QmdPdmVybGF5KFwiYmFja2dyb3VuZENvbG9yXCIsdC5iYWNrZ3JvdW5kLHIscyksdGhpcy5fX3NldEJnT3ZlcmxheShcIm92ZXJsYXlDb2xvclwiLHQub3ZlcmxheSxyLHMpLHMoKX0sX19zZXRCZ092ZXJsYXk6ZnVuY3Rpb24odCxlLGkscil7dmFyIHM9dGhpcztyZXR1cm4gZT92b2lkKFwiYmFja2dyb3VuZEltYWdlXCI9PT10fHxcIm92ZXJsYXlJbWFnZVwiPT09dD9mYWJyaWMuSW1hZ2UuZnJvbU9iamVjdChlLGZ1bmN0aW9uKGUpe3NbdF09ZSxpW3RdPSEwLHImJnIoKX0pOnRoaXNbXCJzZXRcIitmYWJyaWMudXRpbC5zdHJpbmcuY2FwaXRhbGl6ZSh0LCEwKV0oZSxmdW5jdGlvbigpe2lbdF09ITAsciYmcigpfSkpOnZvaWQoaVt0XT0hMCl9LF9lbmxpdmVuT2JqZWN0czpmdW5jdGlvbih0LGUsaSl7dmFyIHI9dGhpcztpZighdHx8MD09PXQubGVuZ3RoKXJldHVybiB2b2lkKGUmJmUoKSk7dmFyIHM9dGhpcy5yZW5kZXJPbkFkZFJlbW92ZTt0aGlzLnJlbmRlck9uQWRkUmVtb3ZlPSExLGZhYnJpYy51dGlsLmVubGl2ZW5PYmplY3RzKHQsZnVuY3Rpb24odCl7dC5mb3JFYWNoKGZ1bmN0aW9uKHQsZSl7ci5pbnNlcnRBdCh0LGUsITApfSksci5yZW5kZXJPbkFkZFJlbW92ZT1zLGUmJmUoKX0sbnVsbCxpKX0sX3RvRGF0YVVSTDpmdW5jdGlvbih0LGUpe3RoaXMuY2xvbmUoZnVuY3Rpb24oaSl7ZShpLnRvRGF0YVVSTCh0KSl9KX0sX3RvRGF0YVVSTFdpdGhNdWx0aXBsaWVyOmZ1bmN0aW9uKHQsZSxpKXt0aGlzLmNsb25lKGZ1bmN0aW9uKHIpe2koci50b0RhdGFVUkxXaXRoTXVsdGlwbGllcih0LGUpKX0pfSxjbG9uZTpmdW5jdGlvbih0LGUpe3ZhciBpPUpTT04uc3RyaW5naWZ5KHRoaXMudG9KU09OKGUpKTt0aGlzLmNsb25lV2l0aG91dERhdGEoZnVuY3Rpb24oZSl7ZS5sb2FkRnJvbUpTT04oaSxmdW5jdGlvbigpe3QmJnQoZSl9KX0pfSxjbG9uZVdpdGhvdXREYXRhOmZ1bmN0aW9uKHQpe3ZhciBlPWZhYnJpYy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO2Uud2lkdGg9dGhpcy5nZXRXaWR0aCgpLGUuaGVpZ2h0PXRoaXMuZ2V0SGVpZ2h0KCk7dmFyIGk9bmV3IGZhYnJpYy5DYW52YXMoZSk7aS5jbGlwVG89dGhpcy5jbGlwVG8sdGhpcy5iYWNrZ3JvdW5kSW1hZ2U/KGkuc2V0QmFja2dyb3VuZEltYWdlKHRoaXMuYmFja2dyb3VuZEltYWdlLnNyYyxmdW5jdGlvbigpe2kucmVuZGVyQWxsKCksdCYmdChpKX0pLGkuYmFja2dyb3VuZEltYWdlT3BhY2l0eT10aGlzLmJhY2tncm91bmRJbWFnZU9wYWNpdHksaS5iYWNrZ3JvdW5kSW1hZ2VTdHJldGNoPXRoaXMuYmFja2dyb3VuZEltYWdlU3RyZXRjaCk6dCYmdChpKX19KSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPWUudXRpbC5vYmplY3QuZXh0ZW5kLHI9ZS51dGlsLnRvRml4ZWQscz1lLnV0aWwuc3RyaW5nLmNhcGl0YWxpemUsbj1lLnV0aWwuZGVncmVlc1RvUmFkaWFucyxvPWUuU3RhdGljQ2FudmFzLnN1cHBvcnRzKFwic2V0TGluZURhc2hcIik7ZS5PYmplY3R8fChlLk9iamVjdD1lLnV0aWwuY3JlYXRlQ2xhc3Moe3R5cGU6XCJvYmplY3RcIixvcmlnaW5YOlwibGVmdFwiLG9yaWdpblk6XCJ0b3BcIix0b3A6MCxsZWZ0OjAsd2lkdGg6MCxoZWlnaHQ6MCxzY2FsZVg6MSxzY2FsZVk6MSxmbGlwWDohMSxmbGlwWTohMSxvcGFjaXR5OjEsYW5nbGU6MCxjb3JuZXJTaXplOjEyLHRyYW5zcGFyZW50Q29ybmVyczohMCxob3ZlckN1cnNvcjpudWxsLHBhZGRpbmc6MCxib3JkZXJDb2xvcjpcInJnYmEoMTAyLDE1MywyNTUsMC43NSlcIixjb3JuZXJDb2xvcjpcInJnYmEoMTAyLDE1MywyNTUsMC41KVwiLGNlbnRlcmVkU2NhbGluZzohMSxjZW50ZXJlZFJvdGF0aW9uOiEwLGZpbGw6XCJyZ2IoMCwwLDApXCIsZmlsbFJ1bGU6XCJub256ZXJvXCIsZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uOlwic291cmNlLW92ZXJcIixiYWNrZ3JvdW5kQ29sb3I6XCJcIixzdHJva2U6bnVsbCxzdHJva2VXaWR0aDoxLHN0cm9rZURhc2hBcnJheTpudWxsLHN0cm9rZUxpbmVDYXA6XCJidXR0XCIsc3Ryb2tlTGluZUpvaW46XCJtaXRlclwiLHN0cm9rZU1pdGVyTGltaXQ6MTAsc2hhZG93Om51bGwsYm9yZGVyT3BhY2l0eVdoZW5Nb3Zpbmc6LjQsYm9yZGVyU2NhbGVGYWN0b3I6MSx0cmFuc2Zvcm1NYXRyaXg6bnVsbCxtaW5TY2FsZUxpbWl0Oi4wMSxzZWxlY3RhYmxlOiEwLGV2ZW50ZWQ6ITAsdmlzaWJsZTohMCxoYXNDb250cm9sczohMCxoYXNCb3JkZXJzOiEwLGhhc1JvdGF0aW5nUG9pbnQ6ITAscm90YXRpbmdQb2ludE9mZnNldDo0MCxwZXJQaXhlbFRhcmdldEZpbmQ6ITEsaW5jbHVkZURlZmF1bHRWYWx1ZXM6ITAsY2xpcFRvOm51bGwsbG9ja01vdmVtZW50WDohMSxsb2NrTW92ZW1lbnRZOiExLGxvY2tSb3RhdGlvbjohMSxsb2NrU2NhbGluZ1g6ITEsbG9ja1NjYWxpbmdZOiExLGxvY2tVbmlTY2FsaW5nOiExLGxvY2tTY2FsaW5nRmxpcDohMSxzdGF0ZVByb3BlcnRpZXM6XCJ0b3AgbGVmdCB3aWR0aCBoZWlnaHQgc2NhbGVYIHNjYWxlWSBmbGlwWCBmbGlwWSBvcmlnaW5YIG9yaWdpblkgdHJhbnNmb3JtTWF0cml4IHN0cm9rZSBzdHJva2VXaWR0aCBzdHJva2VEYXNoQXJyYXkgc3Ryb2tlTGluZUNhcCBzdHJva2VMaW5lSm9pbiBzdHJva2VNaXRlckxpbWl0IGFuZ2xlIG9wYWNpdHkgZmlsbCBmaWxsUnVsZSBnbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gc2hhZG93IGNsaXBUbyB2aXNpYmxlIGJhY2tncm91bmRDb2xvclwiLnNwbGl0KFwiIFwiKSxpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3QmJnRoaXMuc2V0T3B0aW9ucyh0KX0sX2luaXRHcmFkaWVudDpmdW5jdGlvbih0KXshdC5maWxsfHwhdC5maWxsLmNvbG9yU3RvcHN8fHQuZmlsbCBpbnN0YW5jZW9mIGUuR3JhZGllbnR8fHRoaXMuc2V0KFwiZmlsbFwiLG5ldyBlLkdyYWRpZW50KHQuZmlsbCkpLCF0LnN0cm9rZXx8IXQuc3Ryb2tlLmNvbG9yU3RvcHN8fHQuc3Ryb2tlIGluc3RhbmNlb2YgZS5HcmFkaWVudHx8dGhpcy5zZXQoXCJzdHJva2VcIixuZXcgZS5HcmFkaWVudCh0LnN0cm9rZSkpfSxfaW5pdFBhdHRlcm46ZnVuY3Rpb24odCl7IXQuZmlsbHx8IXQuZmlsbC5zb3VyY2V8fHQuZmlsbCBpbnN0YW5jZW9mIGUuUGF0dGVybnx8dGhpcy5zZXQoXCJmaWxsXCIsbmV3IGUuUGF0dGVybih0LmZpbGwpKSwhdC5zdHJva2V8fCF0LnN0cm9rZS5zb3VyY2V8fHQuc3Ryb2tlIGluc3RhbmNlb2YgZS5QYXR0ZXJufHx0aGlzLnNldChcInN0cm9rZVwiLG5ldyBlLlBhdHRlcm4odC5zdHJva2UpKX0sX2luaXRDbGlwcGluZzpmdW5jdGlvbih0KXtpZih0LmNsaXBUbyYmXCJzdHJpbmdcIj09dHlwZW9mIHQuY2xpcFRvKXt2YXIgaT1lLnV0aWwuZ2V0RnVuY3Rpb25Cb2R5KHQuY2xpcFRvKTtcInVuZGVmaW5lZFwiIT10eXBlb2YgaSYmKHRoaXMuY2xpcFRvPW5ldyBGdW5jdGlvbihcImN0eFwiLGkpKX19LHNldE9wdGlvbnM6ZnVuY3Rpb24odCl7Zm9yKHZhciBlIGluIHQpdGhpcy5zZXQoZSx0W2VdKTt0aGlzLl9pbml0R3JhZGllbnQodCksdGhpcy5faW5pdFBhdHRlcm4odCksdGhpcy5faW5pdENsaXBwaW5nKHQpfSx0cmFuc2Zvcm06ZnVuY3Rpb24odCxlKXt0aGlzLmdyb3VwJiZ0aGlzLmNhbnZhcy5wcmVzZXJ2ZU9iamVjdFN0YWNraW5nJiZ0aGlzLmdyb3VwPT09dGhpcy5jYW52YXMuX2FjdGl2ZUdyb3VwJiZ0aGlzLmdyb3VwLnRyYW5zZm9ybSh0KTt2YXIgaT1lP3RoaXMuX2dldExlZnRUb3BDb29yZHMoKTp0aGlzLmdldENlbnRlclBvaW50KCk7dC50cmFuc2xhdGUoaS54LGkueSksdC5yb3RhdGUobih0aGlzLmFuZ2xlKSksdC5zY2FsZSh0aGlzLnNjYWxlWCoodGhpcy5mbGlwWD8tMToxKSx0aGlzLnNjYWxlWSoodGhpcy5mbGlwWT8tMToxKSl9LHRvT2JqZWN0OmZ1bmN0aW9uKHQpe3ZhciBpPWUuT2JqZWN0Lk5VTV9GUkFDVElPTl9ESUdJVFMscz17dHlwZTp0aGlzLnR5cGUsb3JpZ2luWDp0aGlzLm9yaWdpblgsb3JpZ2luWTp0aGlzLm9yaWdpblksbGVmdDpyKHRoaXMubGVmdCxpKSx0b3A6cih0aGlzLnRvcCxpKSx3aWR0aDpyKHRoaXMud2lkdGgsaSksaGVpZ2h0OnIodGhpcy5oZWlnaHQsaSksZmlsbDp0aGlzLmZpbGwmJnRoaXMuZmlsbC50b09iamVjdD90aGlzLmZpbGwudG9PYmplY3QoKTp0aGlzLmZpbGwsc3Ryb2tlOnRoaXMuc3Ryb2tlJiZ0aGlzLnN0cm9rZS50b09iamVjdD90aGlzLnN0cm9rZS50b09iamVjdCgpOnRoaXMuc3Ryb2tlLHN0cm9rZVdpZHRoOnIodGhpcy5zdHJva2VXaWR0aCxpKSxzdHJva2VEYXNoQXJyYXk6dGhpcy5zdHJva2VEYXNoQXJyYXksc3Ryb2tlTGluZUNhcDp0aGlzLnN0cm9rZUxpbmVDYXAsc3Ryb2tlTGluZUpvaW46dGhpcy5zdHJva2VMaW5lSm9pbixzdHJva2VNaXRlckxpbWl0OnIodGhpcy5zdHJva2VNaXRlckxpbWl0LGkpLHNjYWxlWDpyKHRoaXMuc2NhbGVYLGkpLHNjYWxlWTpyKHRoaXMuc2NhbGVZLGkpLGFuZ2xlOnIodGhpcy5nZXRBbmdsZSgpLGkpLGZsaXBYOnRoaXMuZmxpcFgsZmxpcFk6dGhpcy5mbGlwWSxvcGFjaXR5OnIodGhpcy5vcGFjaXR5LGkpLHNoYWRvdzp0aGlzLnNoYWRvdyYmdGhpcy5zaGFkb3cudG9PYmplY3Q/dGhpcy5zaGFkb3cudG9PYmplY3QoKTp0aGlzLnNoYWRvdyx2aXNpYmxlOnRoaXMudmlzaWJsZSxjbGlwVG86dGhpcy5jbGlwVG8mJlN0cmluZyh0aGlzLmNsaXBUbyksYmFja2dyb3VuZENvbG9yOnRoaXMuYmFja2dyb3VuZENvbG9yLGZpbGxSdWxlOnRoaXMuZmlsbFJ1bGUsZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uOnRoaXMuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9ufTtyZXR1cm4gdGhpcy5pbmNsdWRlRGVmYXVsdFZhbHVlc3x8KHM9dGhpcy5fcmVtb3ZlRGVmYXVsdFZhbHVlcyhzKSksZS51dGlsLnBvcHVsYXRlV2l0aFByb3BlcnRpZXModGhpcyxzLHQpLHN9LHRvRGF0YWxlc3NPYmplY3Q6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMudG9PYmplY3QodCl9LF9yZW1vdmVEZWZhdWx0VmFsdWVzOmZ1bmN0aW9uKHQpe3ZhciBpPWUudXRpbC5nZXRLbGFzcyh0LnR5cGUpLnByb3RvdHlwZSxyPWkuc3RhdGVQcm9wZXJ0aWVzO3JldHVybiByLmZvckVhY2goZnVuY3Rpb24oZSl7dFtlXT09PWlbZV0mJmRlbGV0ZSB0W2VdfSksdH0sdG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm5cIiM8ZmFicmljLlwiK3ModGhpcy50eXBlKStcIj5cIn0sZ2V0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzW3RdfSxfc2V0T2JqZWN0OmZ1bmN0aW9uKHQpe2Zvcih2YXIgZSBpbiB0KXRoaXMuX3NldChlLHRbZV0pfSxzZXQ6ZnVuY3Rpb24odCxlKXtyZXR1cm5cIm9iamVjdFwiPT10eXBlb2YgdD90aGlzLl9zZXRPYmplY3QodCk6XCJmdW5jdGlvblwiPT10eXBlb2YgZSYmXCJjbGlwVG9cIiE9PXQ/dGhpcy5fc2V0KHQsZSh0aGlzLmdldCh0KSkpOnRoaXMuX3NldCh0LGUpLHRoaXN9LF9zZXQ6ZnVuY3Rpb24odCxpKXt2YXIgcz1cInNjYWxlWFwiPT09dHx8XCJzY2FsZVlcIj09PXQ7cmV0dXJuIHMmJihpPXRoaXMuX2NvbnN0cmFpblNjYWxlKGkpKSxcInNjYWxlWFwiPT09dCYmMD5pPyh0aGlzLmZsaXBYPSF0aGlzLmZsaXBYLGkqPS0xKTpcInNjYWxlWVwiPT09dCYmMD5pPyh0aGlzLmZsaXBZPSF0aGlzLmZsaXBZLGkqPS0xKTpcIndpZHRoXCI9PT10fHxcImhlaWdodFwiPT09dD90aGlzLm1pblNjYWxlTGltaXQ9cihNYXRoLm1pbiguMSwxL01hdGgubWF4KHRoaXMud2lkdGgsdGhpcy5oZWlnaHQpKSwyKTpcInNoYWRvd1wiIT09dHx8IWl8fGkgaW5zdGFuY2VvZiBlLlNoYWRvd3x8KGk9bmV3IGUuU2hhZG93KGkpKSx0aGlzW3RdPWksdGhpc30sdG9nZ2xlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0KHQpO3JldHVyblwiYm9vbGVhblwiPT10eXBlb2YgZSYmdGhpcy5zZXQodCwhZSksdGhpc30sc2V0U291cmNlUGF0aDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5zb3VyY2VQYXRoPXQsdGhpc30sZ2V0Vmlld3BvcnRUcmFuc2Zvcm06ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jYW52YXMmJnRoaXMuY2FudmFzLnZpZXdwb3J0VHJhbnNmb3JtP3RoaXMuY2FudmFzLnZpZXdwb3J0VHJhbnNmb3JtOlsxLDAsMCwxLDAsMF19LHJlbmRlcjpmdW5jdGlvbih0LGkpezA9PT10aGlzLndpZHRoJiYwPT09dGhpcy5oZWlnaHR8fCF0aGlzLnZpc2libGV8fCh0LnNhdmUoKSx0aGlzLl9zZXR1cENvbXBvc2l0ZU9wZXJhdGlvbih0KSxpfHx0aGlzLnRyYW5zZm9ybSh0KSx0aGlzLl9zZXRTdHJva2VTdHlsZXModCksdGhpcy5fc2V0RmlsbFN0eWxlcyh0KSx0aGlzLnRyYW5zZm9ybU1hdHJpeCYmdC50cmFuc2Zvcm0uYXBwbHkodCx0aGlzLnRyYW5zZm9ybU1hdHJpeCksdGhpcy5fc2V0T3BhY2l0eSh0KSx0aGlzLl9zZXRTaGFkb3codCksdGhpcy5jbGlwVG8mJmUudXRpbC5jbGlwQ29udGV4dCh0aGlzLHQpLHRoaXMuX3JlbmRlcih0LGkpLHRoaXMuY2xpcFRvJiZ0LnJlc3RvcmUoKSx0LnJlc3RvcmUoKSl9LF9zZXRPcGFjaXR5OmZ1bmN0aW9uKHQpe3RoaXMuZ3JvdXAmJnRoaXMuZ3JvdXAuX3NldE9wYWNpdHkodCksdC5nbG9iYWxBbHBoYSo9dGhpcy5vcGFjaXR5fSxfc2V0U3Ryb2tlU3R5bGVzOmZ1bmN0aW9uKHQpe3RoaXMuc3Ryb2tlJiYodC5saW5lV2lkdGg9dGhpcy5zdHJva2VXaWR0aCx0LmxpbmVDYXA9dGhpcy5zdHJva2VMaW5lQ2FwLHQubGluZUpvaW49dGhpcy5zdHJva2VMaW5lSm9pbix0Lm1pdGVyTGltaXQ9dGhpcy5zdHJva2VNaXRlckxpbWl0LHQuc3Ryb2tlU3R5bGU9dGhpcy5zdHJva2UudG9MaXZlP3RoaXMuc3Ryb2tlLnRvTGl2ZSh0LHRoaXMpOnRoaXMuc3Ryb2tlKX0sX3NldEZpbGxTdHlsZXM6ZnVuY3Rpb24odCl7dGhpcy5maWxsJiYodC5maWxsU3R5bGU9dGhpcy5maWxsLnRvTGl2ZT90aGlzLmZpbGwudG9MaXZlKHQsdGhpcyk6dGhpcy5maWxsKX0sX3JlbmRlckNvbnRyb2xzOmZ1bmN0aW9uKHQsaSl7aWYodGhpcy5hY3RpdmUmJiFpKXt2YXIgcj10aGlzLmdldFZpZXdwb3J0VHJhbnNmb3JtKCk7dC5zYXZlKCk7dmFyIHM7dGhpcy5ncm91cCYmKHM9ZS51dGlsLnRyYW5zZm9ybVBvaW50KHRoaXMuZ3JvdXAuZ2V0Q2VudGVyUG9pbnQoKSxyKSx0LnRyYW5zbGF0ZShzLngscy55KSx0LnJvdGF0ZShuKHRoaXMuZ3JvdXAuYW5nbGUpKSkscz1lLnV0aWwudHJhbnNmb3JtUG9pbnQodGhpcy5nZXRDZW50ZXJQb2ludCgpLHIsbnVsbCE9dGhpcy5ncm91cCksdGhpcy5ncm91cCYmKHMueCo9dGhpcy5ncm91cC5zY2FsZVgscy55Kj10aGlzLmdyb3VwLnNjYWxlWSksdC50cmFuc2xhdGUocy54LHMueSksdC5yb3RhdGUobih0aGlzLmFuZ2xlKSksdGhpcy5kcmF3Qm9yZGVycyh0KSx0aGlzLmRyYXdDb250cm9scyh0KSx0LnJlc3RvcmUoKX19LF9zZXRTaGFkb3c6ZnVuY3Rpb24odCl7aWYodGhpcy5zaGFkb3cpe3ZhciBlPXRoaXMuY2FudmFzJiZ0aGlzLmNhbnZhcy52aWV3cG9ydFRyYW5zZm9ybVswXXx8MSxpPXRoaXMuY2FudmFzJiZ0aGlzLmNhbnZhcy52aWV3cG9ydFRyYW5zZm9ybVszXXx8MTt0LnNoYWRvd0NvbG9yPXRoaXMuc2hhZG93LmNvbG9yLHQuc2hhZG93Qmx1cj10aGlzLnNoYWRvdy5ibHVyKihlK2kpKih0aGlzLnNjYWxlWCt0aGlzLnNjYWxlWSkvNCx0LnNoYWRvd09mZnNldFg9dGhpcy5zaGFkb3cub2Zmc2V0WCplKnRoaXMuc2NhbGVYLHQuc2hhZG93T2Zmc2V0WT10aGlzLnNoYWRvdy5vZmZzZXRZKmkqdGhpcy5zY2FsZVl9fSxfcmVtb3ZlU2hhZG93OmZ1bmN0aW9uKHQpe3RoaXMuc2hhZG93JiYodC5zaGFkb3dDb2xvcj1cIlwiLHQuc2hhZG93Qmx1cj10LnNoYWRvd09mZnNldFg9dC5zaGFkb3dPZmZzZXRZPTApfSxfcmVuZGVyRmlsbDpmdW5jdGlvbih0KXtpZih0aGlzLmZpbGwpe2lmKHQuc2F2ZSgpLHRoaXMuZmlsbC5ncmFkaWVudFRyYW5zZm9ybSl7dmFyIGU9dGhpcy5maWxsLmdyYWRpZW50VHJhbnNmb3JtO3QudHJhbnNmb3JtLmFwcGx5KHQsZSl9dGhpcy5maWxsLnRvTGl2ZSYmdC50cmFuc2xhdGUoLXRoaXMud2lkdGgvMit0aGlzLmZpbGwub2Zmc2V0WHx8MCwtdGhpcy5oZWlnaHQvMit0aGlzLmZpbGwub2Zmc2V0WXx8MCksXCJldmVub2RkXCI9PT10aGlzLmZpbGxSdWxlP3QuZmlsbChcImV2ZW5vZGRcIik6dC5maWxsKCksdC5yZXN0b3JlKCl9fSxfcmVuZGVyU3Ryb2tlOmZ1bmN0aW9uKHQpe2lmKHRoaXMuc3Ryb2tlJiYwIT09dGhpcy5zdHJva2VXaWR0aCl7aWYodGhpcy5zaGFkb3cmJiF0aGlzLnNoYWRvdy5hZmZlY3RTdHJva2UmJnRoaXMuX3JlbW92ZVNoYWRvdyh0KSx0LnNhdmUoKSx0aGlzLnN0cm9rZURhc2hBcnJheSkxJnRoaXMuc3Ryb2tlRGFzaEFycmF5Lmxlbmd0aCYmdGhpcy5zdHJva2VEYXNoQXJyYXkucHVzaC5hcHBseSh0aGlzLnN0cm9rZURhc2hBcnJheSx0aGlzLnN0cm9rZURhc2hBcnJheSksbz8odC5zZXRMaW5lRGFzaCh0aGlzLnN0cm9rZURhc2hBcnJheSksdGhpcy5fc3Ryb2tlJiZ0aGlzLl9zdHJva2UodCkpOnRoaXMuX3JlbmRlckRhc2hlZFN0cm9rZSYmdGhpcy5fcmVuZGVyRGFzaGVkU3Ryb2tlKHQpLHQuc3Ryb2tlKCk7ZWxzZXtpZih0aGlzLnN0cm9rZS5ncmFkaWVudFRyYW5zZm9ybSl7dmFyIGU9dGhpcy5zdHJva2UuZ3JhZGllbnRUcmFuc2Zvcm07dC50cmFuc2Zvcm0uYXBwbHkodCxlKX10aGlzLl9zdHJva2U/dGhpcy5fc3Ryb2tlKHQpOnQuc3Ryb2tlKCl9dC5yZXN0b3JlKCl9fSxjbG9uZTpmdW5jdGlvbih0LGkpe3JldHVybiB0aGlzLmNvbnN0cnVjdG9yLmZyb21PYmplY3Q/dGhpcy5jb25zdHJ1Y3Rvci5mcm9tT2JqZWN0KHRoaXMudG9PYmplY3QoaSksdCk6bmV3IGUuT2JqZWN0KHRoaXMudG9PYmplY3QoaSkpfSxjbG9uZUFzSW1hZ2U6ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy50b0RhdGFVUkwoKTtyZXR1cm4gZS51dGlsLmxvYWRJbWFnZShpLGZ1bmN0aW9uKGkpe3QmJnQobmV3IGUuSW1hZ2UoaSkpfSksdGhpc30sdG9EYXRhVVJMOmZ1bmN0aW9uKHQpe3R8fCh0PXt9KTt2YXIgaT1lLnV0aWwuY3JlYXRlQ2FudmFzRWxlbWVudCgpLHI9dGhpcy5nZXRCb3VuZGluZ1JlY3QoKTtpLndpZHRoPXIud2lkdGgsaS5oZWlnaHQ9ci5oZWlnaHQsZS51dGlsLndyYXBFbGVtZW50KGksXCJkaXZcIik7dmFyIHM9bmV3IGUuU3RhdGljQ2FudmFzKGkpO1wianBnXCI9PT10LmZvcm1hdCYmKHQuZm9ybWF0PVwianBlZ1wiKSxcImpwZWdcIj09PXQuZm9ybWF0JiYocy5iYWNrZ3JvdW5kQ29sb3I9XCIjZmZmXCIpO3ZhciBuPXthY3RpdmU6dGhpcy5nZXQoXCJhY3RpdmVcIiksbGVmdDp0aGlzLmdldExlZnQoKSx0b3A6dGhpcy5nZXRUb3AoKX07dGhpcy5zZXQoXCJhY3RpdmVcIiwhMSksdGhpcy5zZXRQb3NpdGlvbkJ5T3JpZ2luKG5ldyBlLlBvaW50KGkud2lkdGgvMixpLmhlaWdodC8yKSxcImNlbnRlclwiLFwiY2VudGVyXCIpO3ZhciBvPXRoaXMuY2FudmFzO3MuYWRkKHRoaXMpO3ZhciBhPXMudG9EYXRhVVJMKHQpO3JldHVybiB0aGlzLnNldChuKS5zZXRDb29yZHMoKSx0aGlzLmNhbnZhcz1vLHMuZGlzcG9zZSgpLHM9bnVsbCxhfSxpc1R5cGU6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMudHlwZT09PXR9LGNvbXBsZXhpdHk6ZnVuY3Rpb24oKXtyZXR1cm4gMH0sdG9KU09OOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnRvT2JqZWN0KHQpfSxzZXRHcmFkaWVudDpmdW5jdGlvbih0LGkpe2l8fChpPXt9KTt2YXIgcj17Y29sb3JTdG9wczpbXX07ci50eXBlPWkudHlwZXx8KGkucjF8fGkucjI/XCJyYWRpYWxcIjpcImxpbmVhclwiKSxyLmNvb3Jkcz17eDE6aS54MSx5MTppLnkxLHgyOmkueDIseTI6aS55Mn0sKGkucjF8fGkucjIpJiYoci5jb29yZHMucjE9aS5yMSxyLmNvb3Jkcy5yMj1pLnIyKTtmb3IodmFyIHMgaW4gaS5jb2xvclN0b3BzKXt2YXIgbj1uZXcgZS5Db2xvcihpLmNvbG9yU3RvcHNbc10pO3IuY29sb3JTdG9wcy5wdXNoKHtvZmZzZXQ6cyxjb2xvcjpuLnRvUmdiKCksb3BhY2l0eTpuLmdldEFscGhhKCl9KX1yZXR1cm4gdGhpcy5zZXQodCxlLkdyYWRpZW50LmZvck9iamVjdCh0aGlzLHIpKX0sc2V0UGF0dGVybkZpbGw6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc2V0KFwiZmlsbFwiLG5ldyBlLlBhdHRlcm4odCkpfSxzZXRTaGFkb3c6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc2V0KFwic2hhZG93XCIsdD9uZXcgZS5TaGFkb3codCk6bnVsbCl9LHNldENvbG9yOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnNldChcImZpbGxcIix0KSx0aGlzfSxzZXRBbmdsZTpmdW5jdGlvbih0KXt2YXIgZT0oXCJjZW50ZXJcIiE9PXRoaXMub3JpZ2luWHx8XCJjZW50ZXJcIiE9PXRoaXMub3JpZ2luWSkmJnRoaXMuY2VudGVyZWRSb3RhdGlvbjtyZXR1cm4gZSYmdGhpcy5fc2V0T3JpZ2luVG9DZW50ZXIoKSx0aGlzLnNldChcImFuZ2xlXCIsdCksZSYmdGhpcy5fcmVzZXRPcmlnaW4oKSx0aGlzfSxjZW50ZXJIOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2FudmFzLmNlbnRlck9iamVjdEgodGhpcyksdGhpc30sY2VudGVyVjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNhbnZhcy5jZW50ZXJPYmplY3RWKHRoaXMpLHRoaXN9LGNlbnRlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNhbnZhcy5jZW50ZXJPYmplY3QodGhpcyksdGhpc30scmVtb3ZlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2FudmFzLnJlbW92ZSh0aGlzKSx0aGlzfSxnZXRMb2NhbFBvaW50ZXI6ZnVuY3Rpb24odCxlKXtlPWV8fHRoaXMuY2FudmFzLmdldFBvaW50ZXIodCk7dmFyIGk9dGhpcy50cmFuc2xhdGVUb09yaWdpblBvaW50KHRoaXMuZ2V0Q2VudGVyUG9pbnQoKSxcImxlZnRcIixcInRvcFwiKTtyZXR1cm57eDplLngtaS54LHk6ZS55LWkueX19LF9zZXR1cENvbXBvc2l0ZU9wZXJhdGlvbjpmdW5jdGlvbih0KXt0aGlzLmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiYmKHQuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uPXRoaXMuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uKX19KSxlLnV0aWwuY3JlYXRlQWNjZXNzb3JzKGUuT2JqZWN0KSxlLk9iamVjdC5wcm90b3R5cGUucm90YXRlPWUuT2JqZWN0LnByb3RvdHlwZS5zZXRBbmdsZSxpKGUuT2JqZWN0LnByb3RvdHlwZSxlLk9ic2VydmFibGUpLGUuT2JqZWN0Lk5VTV9GUkFDVElPTl9ESUdJVFM9MixlLk9iamVjdC5fX3VpZD0wKX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbigpe3ZhciB0PWZhYnJpYy51dGlsLmRlZ3JlZXNUb1JhZGlhbnM7ZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuT2JqZWN0LnByb3RvdHlwZSx7dHJhbnNsYXRlVG9DZW50ZXJQb2ludDpmdW5jdGlvbihlLGkscil7dmFyIHM9ZS54LG49ZS55O3JldHVyblwibGVmdFwiPT09aT9zPWUueCsodGhpcy5nZXRXaWR0aCgpK3RoaXMuc3Ryb2tlV2lkdGgqdGhpcy5zY2FsZVgpLzI6XCJyaWdodFwiPT09aSYmKHM9ZS54LSh0aGlzLmdldFdpZHRoKCkrdGhpcy5zdHJva2VXaWR0aCp0aGlzLnNjYWxlWCkvMiksXCJ0b3BcIj09PXI/bj1lLnkrKHRoaXMuZ2V0SGVpZ2h0KCkrdGhpcy5zdHJva2VXaWR0aCp0aGlzLnNjYWxlWSkvMjpcImJvdHRvbVwiPT09ciYmKG49ZS55LSh0aGlzLmdldEhlaWdodCgpK3RoaXMuc3Ryb2tlV2lkdGgqdGhpcy5zY2FsZVkpLzIpLGZhYnJpYy51dGlsLnJvdGF0ZVBvaW50KG5ldyBmYWJyaWMuUG9pbnQocyxuKSxlLHQodGhpcy5hbmdsZSkpfSx0cmFuc2xhdGVUb09yaWdpblBvaW50OmZ1bmN0aW9uKGUsaSxyKXt2YXIgcz1lLngsbj1lLnk7cmV0dXJuXCJsZWZ0XCI9PT1pP3M9ZS54LSh0aGlzLmdldFdpZHRoKCkrdGhpcy5zdHJva2VXaWR0aCp0aGlzLnNjYWxlWCkvMjpcInJpZ2h0XCI9PT1pJiYocz1lLngrKHRoaXMuZ2V0V2lkdGgoKSt0aGlzLnN0cm9rZVdpZHRoKnRoaXMuc2NhbGVYKS8yKSxcInRvcFwiPT09cj9uPWUueS0odGhpcy5nZXRIZWlnaHQoKSt0aGlzLnN0cm9rZVdpZHRoKnRoaXMuc2NhbGVZKS8yOlwiYm90dG9tXCI9PT1yJiYobj1lLnkrKHRoaXMuZ2V0SGVpZ2h0KCkrdGhpcy5zdHJva2VXaWR0aCp0aGlzLnNjYWxlWSkvMiksZmFicmljLnV0aWwucm90YXRlUG9pbnQobmV3IGZhYnJpYy5Qb2ludChzLG4pLGUsdCh0aGlzLmFuZ2xlKSl9LGdldENlbnRlclBvaW50OmZ1bmN0aW9uKCl7dmFyIHQ9bmV3IGZhYnJpYy5Qb2ludCh0aGlzLmxlZnQsdGhpcy50b3ApO3JldHVybiB0aGlzLnRyYW5zbGF0ZVRvQ2VudGVyUG9pbnQodCx0aGlzLm9yaWdpblgsdGhpcy5vcmlnaW5ZKX0sZ2V0UG9pbnRCeU9yaWdpbjpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuZ2V0Q2VudGVyUG9pbnQoKTtyZXR1cm4gdGhpcy50cmFuc2xhdGVUb09yaWdpblBvaW50KGksdCxlKX0sdG9Mb2NhbFBvaW50OmZ1bmN0aW9uKGUsaSxyKXt2YXIgcyxuLG89dGhpcy5nZXRDZW50ZXJQb2ludCgpO3JldHVybiBpJiZyPyhzPVwibGVmdFwiPT09aT9vLngtKHRoaXMuZ2V0V2lkdGgoKSt0aGlzLnN0cm9rZVdpZHRoKnRoaXMuc2NhbGVYKS8yOlwicmlnaHRcIj09PWk/by54Kyh0aGlzLmdldFdpZHRoKCkrdGhpcy5zdHJva2VXaWR0aCp0aGlzLnNjYWxlWCkvMjpvLngsbj1cInRvcFwiPT09cj9vLnktKHRoaXMuZ2V0SGVpZ2h0KCkrdGhpcy5zdHJva2VXaWR0aCp0aGlzLnNjYWxlWSkvMjpcImJvdHRvbVwiPT09cj9vLnkrKHRoaXMuZ2V0SGVpZ2h0KCkrdGhpcy5zdHJva2VXaWR0aCp0aGlzLnNjYWxlWSkvMjpvLnkpOihzPXRoaXMubGVmdCxuPXRoaXMudG9wKSxmYWJyaWMudXRpbC5yb3RhdGVQb2ludChuZXcgZmFicmljLlBvaW50KGUueCxlLnkpLG8sLXQodGhpcy5hbmdsZSkpLnN1YnRyYWN0RXF1YWxzKG5ldyBmYWJyaWMuUG9pbnQocyxuKSl9LHNldFBvc2l0aW9uQnlPcmlnaW46ZnVuY3Rpb24odCxlLGkpe3ZhciByPXRoaXMudHJhbnNsYXRlVG9DZW50ZXJQb2ludCh0LGUsaSkscz10aGlzLnRyYW5zbGF0ZVRvT3JpZ2luUG9pbnQocix0aGlzLm9yaWdpblgsdGhpcy5vcmlnaW5ZKTt0aGlzLnNldChcImxlZnRcIixzLngpLHRoaXMuc2V0KFwidG9wXCIscy55KX0sYWRqdXN0UG9zaXRpb246ZnVuY3Rpb24oZSl7dmFyIGk9dCh0aGlzLmFuZ2xlKSxyPXRoaXMuZ2V0V2lkdGgoKS8yLHM9TWF0aC5jb3MoaSkqcixuPU1hdGguc2luKGkpKnIsbz10aGlzLmdldFdpZHRoKCksYT1NYXRoLmNvcyhpKSpvLGg9TWF0aC5zaW4oaSkqbztcImNlbnRlclwiPT09dGhpcy5vcmlnaW5YJiZcImxlZnRcIj09PWV8fFwicmlnaHRcIj09PXRoaXMub3JpZ2luWCYmXCJjZW50ZXJcIj09PWU/KHRoaXMubGVmdC09cyx0aGlzLnRvcC09bik6XCJsZWZ0XCI9PT10aGlzLm9yaWdpblgmJlwiY2VudGVyXCI9PT1lfHxcImNlbnRlclwiPT09dGhpcy5vcmlnaW5YJiZcInJpZ2h0XCI9PT1lPyh0aGlzLmxlZnQrPXMsdGhpcy50b3ArPW4pOlwibGVmdFwiPT09dGhpcy5vcmlnaW5YJiZcInJpZ2h0XCI9PT1lPyh0aGlzLmxlZnQrPWEsdGhpcy50b3ArPWgpOlwicmlnaHRcIj09PXRoaXMub3JpZ2luWCYmXCJsZWZ0XCI9PT1lJiYodGhpcy5sZWZ0LT1hLHRoaXMudG9wLT1oKSx0aGlzLnNldENvb3JkcygpLHRoaXMub3JpZ2luWD1lfSxfc2V0T3JpZ2luVG9DZW50ZXI6ZnVuY3Rpb24oKXt0aGlzLl9vcmlnaW5hbE9yaWdpblg9dGhpcy5vcmlnaW5YLHRoaXMuX29yaWdpbmFsT3JpZ2luWT10aGlzLm9yaWdpblk7dmFyIHQ9dGhpcy5nZXRDZW50ZXJQb2ludCgpO3RoaXMub3JpZ2luWD1cImNlbnRlclwiLHRoaXMub3JpZ2luWT1cImNlbnRlclwiLHRoaXMubGVmdD10LngsdGhpcy50b3A9dC55fSxfcmVzZXRPcmlnaW46ZnVuY3Rpb24oKXt2YXIgdD10aGlzLnRyYW5zbGF0ZVRvT3JpZ2luUG9pbnQodGhpcy5nZXRDZW50ZXJQb2ludCgpLHRoaXMuX29yaWdpbmFsT3JpZ2luWCx0aGlzLl9vcmlnaW5hbE9yaWdpblkpO3RoaXMub3JpZ2luWD10aGlzLl9vcmlnaW5hbE9yaWdpblgsdGhpcy5vcmlnaW5ZPXRoaXMuX29yaWdpbmFsT3JpZ2luWSx0aGlzLmxlZnQ9dC54LHRoaXMudG9wPXQueSx0aGlzLl9vcmlnaW5hbE9yaWdpblg9bnVsbCx0aGlzLl9vcmlnaW5hbE9yaWdpblk9bnVsbH0sX2dldExlZnRUb3BDb29yZHM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50cmFuc2xhdGVUb09yaWdpblBvaW50KHRoaXMuZ2V0Q2VudGVyUG9pbnQoKSxcImxlZnRcIixcInRvcFwiKX19KX0oKSxmdW5jdGlvbigpe3ZhciB0PWZhYnJpYy51dGlsLmRlZ3JlZXNUb1JhZGlhbnM7ZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuT2JqZWN0LnByb3RvdHlwZSx7b0Nvb3JkczpudWxsLGludGVyc2VjdHNXaXRoUmVjdDpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMub0Nvb3JkcyxyPW5ldyBmYWJyaWMuUG9pbnQoaS50bC54LGkudGwueSkscz1uZXcgZmFicmljLlBvaW50KGkudHIueCxpLnRyLnkpLG49bmV3IGZhYnJpYy5Qb2ludChpLmJsLngsaS5ibC55KSxvPW5ldyBmYWJyaWMuUG9pbnQoaS5ici54LGkuYnIueSksYT1mYWJyaWMuSW50ZXJzZWN0aW9uLmludGVyc2VjdFBvbHlnb25SZWN0YW5nbGUoW3IscyxvLG5dLHQsZSk7cmV0dXJuXCJJbnRlcnNlY3Rpb25cIj09PWEuc3RhdHVzfSxpbnRlcnNlY3RzV2l0aE9iamVjdDpmdW5jdGlvbih0KXtmdW5jdGlvbiBlKHQpe3JldHVybnt0bDpuZXcgZmFicmljLlBvaW50KHQudGwueCx0LnRsLnkpLHRyOm5ldyBmYWJyaWMuUG9pbnQodC50ci54LHQudHIueSksYmw6bmV3IGZhYnJpYy5Qb2ludCh0LmJsLngsdC5ibC55KSxicjpuZXcgZmFicmljLlBvaW50KHQuYnIueCx0LmJyLnkpfX12YXIgaT1lKHRoaXMub0Nvb3Jkcykscj1lKHQub0Nvb3Jkcykscz1mYWJyaWMuSW50ZXJzZWN0aW9uLmludGVyc2VjdFBvbHlnb25Qb2x5Z29uKFtpLnRsLGkudHIsaS5icixpLmJsXSxbci50bCxyLnRyLHIuYnIsci5ibF0pO3JldHVyblwiSW50ZXJzZWN0aW9uXCI9PT1zLnN0YXR1c30saXNDb250YWluZWRXaXRoaW5PYmplY3Q6ZnVuY3Rpb24odCl7dmFyIGU9dC5nZXRCb3VuZGluZ1JlY3QoKSxpPW5ldyBmYWJyaWMuUG9pbnQoZS5sZWZ0LGUudG9wKSxyPW5ldyBmYWJyaWMuUG9pbnQoZS5sZWZ0K2Uud2lkdGgsZS50b3ArZS5oZWlnaHQpO3JldHVybiB0aGlzLmlzQ29udGFpbmVkV2l0aGluUmVjdChpLHIpfSxpc0NvbnRhaW5lZFdpdGhpblJlY3Q6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLmdldEJvdW5kaW5nUmVjdCgpO3JldHVybiBpLmxlZnQ+PXQueCYmaS5sZWZ0K2kud2lkdGg8PWUueCYmaS50b3A+PXQueSYmaS50b3AraS5oZWlnaHQ8PWUueX0sY29udGFpbnNQb2ludDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl9nZXRJbWFnZUxpbmVzKHRoaXMub0Nvb3JkcyksaT10aGlzLl9maW5kQ3Jvc3NQb2ludHModCxlKTtyZXR1cm4gMCE9PWkmJmklMj09PTF9LF9nZXRJbWFnZUxpbmVzOmZ1bmN0aW9uKHQpe3JldHVybnt0b3BsaW5lOntvOnQudGwsZDp0LnRyfSxyaWdodGxpbmU6e286dC50cixkOnQuYnJ9LGJvdHRvbWxpbmU6e286dC5icixkOnQuYmx9LGxlZnRsaW5lOntvOnQuYmwsZDp0LnRsfX19LF9maW5kQ3Jvc3NQb2ludHM6ZnVuY3Rpb24odCxlKXt2YXIgaSxyLHMsbixvLGEsaCxjPTA7Zm9yKHZhciBsIGluIGUpaWYoaD1lW2xdLCEoaC5vLnk8dC55JiZoLmQueTx0Lnl8fGguby55Pj10LnkmJmguZC55Pj10Lnl8fChoLm8ueD09PWguZC54JiZoLm8ueD49dC54PyhvPWguby54LGE9dC55KTooaT0wLHI9KGguZC55LWguby55KS8oaC5kLngtaC5vLngpLHM9dC55LWkqdC54LG49aC5vLnktcipoLm8ueCxvPS0ocy1uKS8oaS1yKSxhPXMraSpvKSxvPj10LngmJihjKz0xKSwyIT09YykpKWJyZWFrO3JldHVybiBjfSxnZXRCb3VuZGluZ1JlY3RXaWR0aDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldEJvdW5kaW5nUmVjdCgpLndpZHRofSxnZXRCb3VuZGluZ1JlY3RIZWlnaHQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRCb3VuZGluZ1JlY3QoKS5oZWlnaHR9LGdldEJvdW5kaW5nUmVjdDpmdW5jdGlvbigpe3RoaXMub0Nvb3Jkc3x8dGhpcy5zZXRDb29yZHMoKTt2YXIgdD1bdGhpcy5vQ29vcmRzLnRsLngsdGhpcy5vQ29vcmRzLnRyLngsdGhpcy5vQ29vcmRzLmJyLngsdGhpcy5vQ29vcmRzLmJsLnhdLGU9ZmFicmljLnV0aWwuYXJyYXkubWluKHQpLGk9ZmFicmljLnV0aWwuYXJyYXkubWF4KHQpLHI9TWF0aC5hYnMoZS1pKSxzPVt0aGlzLm9Db29yZHMudGwueSx0aGlzLm9Db29yZHMudHIueSx0aGlzLm9Db29yZHMuYnIueSx0aGlzLm9Db29yZHMuYmwueV0sbj1mYWJyaWMudXRpbC5hcnJheS5taW4ocyksbz1mYWJyaWMudXRpbC5hcnJheS5tYXgocyksYT1NYXRoLmFicyhuLW8pO3JldHVybntsZWZ0OmUsdG9wOm4sd2lkdGg6cixoZWlnaHQ6YX19LGdldFdpZHRoOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMud2lkdGgqdGhpcy5zY2FsZVh9LGdldEhlaWdodDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmhlaWdodCp0aGlzLnNjYWxlWX0sX2NvbnN0cmFpblNjYWxlOmZ1bmN0aW9uKHQpe3JldHVybiBNYXRoLmFicyh0KTx0aGlzLm1pblNjYWxlTGltaXQ/MD50Py10aGlzLm1pblNjYWxlTGltaXQ6dGhpcy5taW5TY2FsZUxpbWl0OnR9LHNjYWxlOmZ1bmN0aW9uKHQpe3JldHVybiB0PXRoaXMuX2NvbnN0cmFpblNjYWxlKHQpLDA+dCYmKHRoaXMuZmxpcFg9IXRoaXMuZmxpcFgsdGhpcy5mbGlwWT0hdGhpcy5mbGlwWSx0Kj0tMSksdGhpcy5zY2FsZVg9dCx0aGlzLnNjYWxlWT10LHRoaXMuc2V0Q29vcmRzKCksdGhpc30sc2NhbGVUb1dpZHRoOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0Qm91bmRpbmdSZWN0V2lkdGgoKS90aGlzLmdldFdpZHRoKCk7cmV0dXJuIHRoaXMuc2NhbGUodC90aGlzLndpZHRoL2UpfSxzY2FsZVRvSGVpZ2h0OmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0Qm91bmRpbmdSZWN0SGVpZ2h0KCkvdGhpcy5nZXRIZWlnaHQoKTtyZXR1cm4gdGhpcy5zY2FsZSh0L3RoaXMuaGVpZ2h0L2UpfSxzZXRDb29yZHM6ZnVuY3Rpb24oKXt2YXIgZT10KHRoaXMuYW5nbGUpLGk9dGhpcy5nZXRWaWV3cG9ydFRyYW5zZm9ybSgpLHI9ZnVuY3Rpb24odCl7cmV0dXJuIGZhYnJpYy51dGlsLnRyYW5zZm9ybVBvaW50KHQsaSl9LHM9dGhpcy5fY2FsY3VsYXRlQ3VycmVudERpbWVuc2lvbnMoITEpLG49cy54LG89cy55OzA+biYmKG49TWF0aC5hYnMobikpO3ZhciBhPU1hdGguc3FydChNYXRoLnBvdyhuLzIsMikrTWF0aC5wb3coby8yLDIpKSxoPU1hdGguYXRhbihpc0Zpbml0ZShvL24pP28vbjowKSxjPU1hdGguY29zKGgrZSkqYSxsPU1hdGguc2luKGgrZSkqYSx1PU1hdGguc2luKGUpLGY9TWF0aC5jb3MoZSksZD10aGlzLmdldENlbnRlclBvaW50KCksZz1uZXcgZmFicmljLlBvaW50KG4sbykscD1uZXcgZmFicmljLlBvaW50KGQueC1jLGQueS1sKSx2PW5ldyBmYWJyaWMuUG9pbnQocC54K2cueCpmLHAueStnLngqdSksYj1yKG5ldyBmYWJyaWMuUG9pbnQocC54LWcueSp1LHAueStnLnkqZikpLG09cihuZXcgZmFicmljLlBvaW50KHYueC1nLnkqdSx2LnkrZy55KmYpKSx5PXIocCksXz1yKHYpLHg9bmV3IGZhYnJpYy5Qb2ludCgoeS54K2IueCkvMiwoeS55K2IueSkvMiksQz1uZXcgZmFicmljLlBvaW50KChfLngreS54KS8yLChfLnkreS55KS8yKSxTPW5ldyBmYWJyaWMuUG9pbnQoKG0ueCtfLngpLzIsKG0ueStfLnkpLzIpLHc9bmV3IGZhYnJpYy5Qb2ludCgobS54K2IueCkvMiwobS55K2IueSkvMiksTz1uZXcgZmFicmljLlBvaW50KEMueCt1KnRoaXMucm90YXRpbmdQb2ludE9mZnNldCxDLnktZip0aGlzLnJvdGF0aW5nUG9pbnRPZmZzZXQpO3JldHVybiB0aGlzLm9Db29yZHM9e3RsOnksdHI6XyxicjptLGJsOmIsbWw6eCxtdDpDLG1yOlMsbWI6dyxtdHI6T30sdGhpcy5fc2V0Q29ybmVyQ29vcmRzJiZ0aGlzLl9zZXRDb3JuZXJDb29yZHMoKSx0aGlzfX0pfSgpLGZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQoZmFicmljLk9iamVjdC5wcm90b3R5cGUse3NlbmRUb0JhY2s6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ncm91cD9mYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZS5zZW5kVG9CYWNrLmNhbGwodGhpcy5ncm91cCx0aGlzKTp0aGlzLmNhbnZhcy5zZW5kVG9CYWNrKHRoaXMpLHRoaXN9LGJyaW5nVG9Gcm9udDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdyb3VwP2ZhYnJpYy5TdGF0aWNDYW52YXMucHJvdG90eXBlLmJyaW5nVG9Gcm9udC5jYWxsKHRoaXMuZ3JvdXAsdGhpcyk6dGhpcy5jYW52YXMuYnJpbmdUb0Zyb250KHRoaXMpLHRoaXN9LHNlbmRCYWNrd2FyZHM6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZ3JvdXA/ZmFicmljLlN0YXRpY0NhbnZhcy5wcm90b3R5cGUuc2VuZEJhY2t3YXJkcy5jYWxsKHRoaXMuZ3JvdXAsdGhpcyx0KTp0aGlzLmNhbnZhcy5zZW5kQmFja3dhcmRzKHRoaXMsdCksdGhpc30sYnJpbmdGb3J3YXJkOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmdyb3VwP2ZhYnJpYy5TdGF0aWNDYW52YXMucHJvdG90eXBlLmJyaW5nRm9yd2FyZC5jYWxsKHRoaXMuZ3JvdXAsdGhpcyx0KTp0aGlzLmNhbnZhcy5icmluZ0ZvcndhcmQodGhpcyx0KSx0aGlzfSxtb3ZlVG86ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZ3JvdXA/ZmFicmljLlN0YXRpY0NhbnZhcy5wcm90b3R5cGUubW92ZVRvLmNhbGwodGhpcy5ncm91cCx0aGlzLHQpOnRoaXMuY2FudmFzLm1vdmVUbyh0aGlzLHQpLHRoaXN9fSksZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuT2JqZWN0LnByb3RvdHlwZSx7Z2V0U3ZnU3R5bGVzOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5maWxsP3RoaXMuZmlsbC50b0xpdmU/XCJ1cmwoI1NWR0lEX1wiK3RoaXMuZmlsbC5pZCtcIilcIjp0aGlzLmZpbGw6XCJub25lXCIsZT10aGlzLmZpbGxSdWxlLGk9dGhpcy5zdHJva2U/dGhpcy5zdHJva2UudG9MaXZlP1widXJsKCNTVkdJRF9cIit0aGlzLnN0cm9rZS5pZCtcIilcIjp0aGlzLnN0cm9rZTpcIm5vbmVcIixyPXRoaXMuc3Ryb2tlV2lkdGg/dGhpcy5zdHJva2VXaWR0aDpcIjBcIixzPXRoaXMuc3Ryb2tlRGFzaEFycmF5P3RoaXMuc3Ryb2tlRGFzaEFycmF5LmpvaW4oXCIgXCIpOlwiXCIsbj10aGlzLnN0cm9rZUxpbmVDYXA/dGhpcy5zdHJva2VMaW5lQ2FwOlwiYnV0dFwiLG89dGhpcy5zdHJva2VMaW5lSm9pbj90aGlzLnN0cm9rZUxpbmVKb2luOlwibWl0ZXJcIixhPXRoaXMuc3Ryb2tlTWl0ZXJMaW1pdD90aGlzLnN0cm9rZU1pdGVyTGltaXQ6XCI0XCIsaD1cInVuZGVmaW5lZFwiIT10eXBlb2YgdGhpcy5vcGFjaXR5P3RoaXMub3BhY2l0eTpcIjFcIixjPXRoaXMudmlzaWJsZT9cIlwiOlwiIHZpc2liaWxpdHk6IGhpZGRlbjtcIixsPXRoaXMuc2hhZG93P1wiZmlsdGVyOiB1cmwoI1NWR0lEX1wiK3RoaXMuc2hhZG93LmlkK1wiKTtcIjpcIlwiO3JldHVybltcInN0cm9rZTogXCIsaSxcIjsgXCIsXCJzdHJva2Utd2lkdGg6IFwiLHIsXCI7IFwiLFwic3Ryb2tlLWRhc2hhcnJheTogXCIscyxcIjsgXCIsXCJzdHJva2UtbGluZWNhcDogXCIsbixcIjsgXCIsXCJzdHJva2UtbGluZWpvaW46IFwiLG8sXCI7IFwiLFwic3Ryb2tlLW1pdGVybGltaXQ6IFwiLGEsXCI7IFwiLFwiZmlsbDogXCIsdCxcIjsgXCIsXCJmaWxsLXJ1bGU6IFwiLGUsXCI7IFwiLFwib3BhY2l0eTogXCIsaCxcIjtcIixsLGNdLmpvaW4oXCJcIil9LGdldFN2Z1RyYW5zZm9ybTpmdW5jdGlvbigpe2lmKHRoaXMuZ3JvdXAmJlwicGF0aC1ncm91cFwiPT09dGhpcy5ncm91cC50eXBlKXJldHVyblwiXCI7dmFyIHQ9ZmFicmljLnV0aWwudG9GaXhlZCxlPXRoaXMuZ2V0QW5nbGUoKSxpPSF0aGlzLmNhbnZhc3x8dGhpcy5jYW52YXMuc3ZnVmlld3BvcnRUcmFuc2Zvcm1hdGlvbj90aGlzLmdldFZpZXdwb3J0VHJhbnNmb3JtKCk6WzEsMCwwLDEsMCwwXSxyPWZhYnJpYy51dGlsLnRyYW5zZm9ybVBvaW50KHRoaXMuZ2V0Q2VudGVyUG9pbnQoKSxpKSxzPWZhYnJpYy5PYmplY3QuTlVNX0ZSQUNUSU9OX0RJR0lUUyxuPVwicGF0aC1ncm91cFwiPT09dGhpcy50eXBlP1wiXCI6XCJ0cmFuc2xhdGUoXCIrdChyLngscykrXCIgXCIrdChyLnkscykrXCIpXCIsbz0wIT09ZT9cIiByb3RhdGUoXCIrdChlLHMpK1wiKVwiOlwiXCIsYT0xPT09dGhpcy5zY2FsZVgmJjE9PT10aGlzLnNjYWxlWSYmMT09PWlbMF0mJjE9PT1pWzNdP1wiXCI6XCIgc2NhbGUoXCIrdCh0aGlzLnNjYWxlWCppWzBdLHMpK1wiIFwiK3QodGhpcy5zY2FsZVkqaVszXSxzKStcIilcIixoPVwicGF0aC1ncm91cFwiPT09dGhpcy50eXBlP3RoaXMud2lkdGgqaVswXTowLGM9dGhpcy5mbGlwWD9cIiBtYXRyaXgoLTEgMCAwIDEgXCIraCtcIiAwKSBcIjpcIlwiLGw9XCJwYXRoLWdyb3VwXCI9PT10aGlzLnR5cGU/dGhpcy5oZWlnaHQqaVszXTowLHU9dGhpcy5mbGlwWT9cIiBtYXRyaXgoMSAwIDAgLTEgMCBcIitsK1wiKVwiOlwiXCI7cmV0dXJuW24sbyxhLGMsdV0uam9pbihcIlwiKX0sZ2V0U3ZnVHJhbnNmb3JtTWF0cml4OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudHJhbnNmb3JtTWF0cml4P1wiIG1hdHJpeChcIit0aGlzLnRyYW5zZm9ybU1hdHJpeC5qb2luKFwiIFwiKStcIikgXCI6XCJcIn0sX2NyZWF0ZUJhc2VTVkdNYXJrdXA6ZnVuY3Rpb24oKXt2YXIgdD1bXTtyZXR1cm4gdGhpcy5maWxsJiZ0aGlzLmZpbGwudG9MaXZlJiZ0LnB1c2godGhpcy5maWxsLnRvU1ZHKHRoaXMsITEpKSx0aGlzLnN0cm9rZSYmdGhpcy5zdHJva2UudG9MaXZlJiZ0LnB1c2godGhpcy5zdHJva2UudG9TVkcodGhpcywhMSkpLHRoaXMuc2hhZG93JiZ0LnB1c2godGhpcy5zaGFkb3cudG9TVkcodGhpcykpLHR9fSksZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuT2JqZWN0LnByb3RvdHlwZSx7aGFzU3RhdGVDaGFuZ2VkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhdGVQcm9wZXJ0aWVzLnNvbWUoZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZ2V0KHQpIT09dGhpcy5vcmlnaW5hbFN0YXRlW3RdfSx0aGlzKX0sc2F2ZVN0YXRlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnN0YXRlUHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHQpe3RoaXMub3JpZ2luYWxTdGF0ZVt0XT10aGlzLmdldCh0KX0sdGhpcyksdCYmdC5zdGF0ZVByb3BlcnRpZXMmJnQuc3RhdGVQcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24odCl7dGhpcy5vcmlnaW5hbFN0YXRlW3RdPXRoaXMuZ2V0KHQpfSx0aGlzKSx0aGlzfSxzZXR1cFN0YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3JpZ2luYWxTdGF0ZT17fSx0aGlzLnNhdmVTdGF0ZSgpLHRoaXN9fSksZnVuY3Rpb24oKXt2YXIgdD1mYWJyaWMudXRpbC5kZWdyZWVzVG9SYWRpYW5zLGU9ZnVuY3Rpb24oKXtyZXR1cm5cInVuZGVmaW5lZFwiIT10eXBlb2YgR192bWxDYW52YXNNYW5hZ2VyfTtmYWJyaWMudXRpbC5vYmplY3QuZXh0ZW5kKGZhYnJpYy5PYmplY3QucHJvdG90eXBlLHtfY29udHJvbHNWaXNpYmlsaXR5Om51bGwsX2ZpbmRUYXJnZXRDb3JuZXI6ZnVuY3Rpb24odCl7aWYoIXRoaXMuaGFzQ29udHJvbHN8fCF0aGlzLmFjdGl2ZSlyZXR1cm4hMTt2YXIgZSxpLHI9dC54LHM9dC55O2Zvcih2YXIgbiBpbiB0aGlzLm9Db29yZHMpaWYodGhpcy5pc0NvbnRyb2xWaXNpYmxlKG4pJiYoXCJtdHJcIiE9PW58fHRoaXMuaGFzUm90YXRpbmdQb2ludCkmJighdGhpcy5nZXQoXCJsb2NrVW5pU2NhbGluZ1wiKXx8XCJtdFwiIT09biYmXCJtclwiIT09biYmXCJtYlwiIT09biYmXCJtbFwiIT09bikmJihpPXRoaXMuX2dldEltYWdlTGluZXModGhpcy5vQ29vcmRzW25dLmNvcm5lciksZT10aGlzLl9maW5kQ3Jvc3NQb2ludHMoe3g6cix5OnN9LGkpLDAhPT1lJiZlJTI9PT0xKSlyZXR1cm4gdGhpcy5fX2Nvcm5lcj1uLG47cmV0dXJuITF9LF9zZXRDb3JuZXJDb29yZHM6ZnVuY3Rpb24oKXt2YXIgZSxpLHI9dGhpcy5vQ29vcmRzLHM9dCg0NS10aGlzLmFuZ2xlKSxuPU1hdGguc3FydCgyKk1hdGgucG93KHRoaXMuY29ybmVyU2l6ZSwyKSkvMixvPW4qTWF0aC5jb3MocyksYT1uKk1hdGguc2luKHMpO2Zvcih2YXIgaCBpbiByKWU9cltoXS54LGk9cltoXS55LHJbaF0uY29ybmVyPXt0bDp7eDplLWEseTppLW99LHRyOnt4OmUrbyx5OmktYX0sYmw6e3g6ZS1vLHk6aSthfSxicjp7eDplK2EseTppK299fX0sX2NhbGN1bGF0ZUN1cnJlbnREaW1lbnNpb25zOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0Vmlld3BvcnRUcmFuc2Zvcm0oKSxpPXRoaXMuc3Ryb2tlV2lkdGgscj10aGlzLndpZHRoLHM9dGhpcy5oZWlnaHQsbj1cInJvdW5kXCI9PT10aGlzLnN0cm9rZUxpbmVDYXB8fFwic3F1YXJlXCI9PT10aGlzLnN0cm9rZUxpbmVDYXAsbz1cImxpbmVcIj09PXRoaXMudHlwZSYmMD09PXRoaXMud2lkdGgsYT1cImxpbmVcIj09PXRoaXMudHlwZSYmMD09PXRoaXMuaGVpZ2h0LGg9b3x8YSxjPW4mJmF8fCFoLGw9biYmb3x8IWg7cmV0dXJuIG8/cj1pOmEmJihzPWkpLGMmJihyKz0wPnI/LWk6aSksbCYmKHMrPTA+cz8taTppKSxyPXIqdGhpcy5zY2FsZVgrMip0aGlzLnBhZGRpbmcscz1zKnRoaXMuc2NhbGVZKzIqdGhpcy5wYWRkaW5nLHQ/ZmFicmljLnV0aWwudHJhbnNmb3JtUG9pbnQobmV3IGZhYnJpYy5Qb2ludChyLHMpLGUsITApOnt4OnIseTpzfX0sZHJhd0JvcmRlcnM6ZnVuY3Rpb24odCl7aWYoIXRoaXMuaGFzQm9yZGVycylyZXR1cm4gdGhpczt0LnNhdmUoKSx0Lmdsb2JhbEFscGhhPXRoaXMuaXNNb3Zpbmc/dGhpcy5ib3JkZXJPcGFjaXR5V2hlbk1vdmluZzoxLHQuc3Ryb2tlU3R5bGU9dGhpcy5ib3JkZXJDb2xvcix0LmxpbmVXaWR0aD0xL3RoaXMuYm9yZGVyU2NhbGVGYWN0b3I7dmFyIGU9dGhpcy5fY2FsY3VsYXRlQ3VycmVudERpbWVuc2lvbnMoITApLGk9ZS54LHI9ZS55O2lmKHRoaXMuZ3JvdXAmJihpKj10aGlzLmdyb3VwLnNjYWxlWCxyKj10aGlzLmdyb3VwLnNjYWxlWSksdC5zdHJva2VSZWN0KH5+LShpLzIpLS41LH5+LShyLzIpLS41LH5+aSsxLH5+cisxKSx0aGlzLmhhc1JvdGF0aW5nUG9pbnQmJnRoaXMuaXNDb250cm9sVmlzaWJsZShcIm10clwiKSYmIXRoaXMuZ2V0KFwibG9ja1JvdGF0aW9uXCIpJiZ0aGlzLmhhc0NvbnRyb2xzKXt2YXIgcz0tci8yO3QuYmVnaW5QYXRoKCksdC5tb3ZlVG8oMCxzKSx0LmxpbmVUbygwLHMtdGhpcy5yb3RhdGluZ1BvaW50T2Zmc2V0KSx0LmNsb3NlUGF0aCgpLHQuc3Ryb2tlKCl9cmV0dXJuIHQucmVzdG9yZSgpLHRoaXN9LGRyYXdDb250cm9sczpmdW5jdGlvbih0KXtpZighdGhpcy5oYXNDb250cm9scylyZXR1cm4gdGhpczt2YXIgZT10aGlzLl9jYWxjdWxhdGVDdXJyZW50RGltZW5zaW9ucyghMCksaT1lLngscj1lLnkscz0tKGkvMiksbj0tKHIvMiksbz10aGlzLmNvcm5lclNpemUvMixhPXRoaXMudHJhbnNwYXJlbnRDb3JuZXJzP1wic3Ryb2tlUmVjdFwiOlwiZmlsbFJlY3RcIjtyZXR1cm4gdC5zYXZlKCksdC5saW5lV2lkdGg9MSx0Lmdsb2JhbEFscGhhPXRoaXMuaXNNb3Zpbmc/dGhpcy5ib3JkZXJPcGFjaXR5V2hlbk1vdmluZzoxLHQuc3Ryb2tlU3R5bGU9dC5maWxsU3R5bGU9dGhpcy5jb3JuZXJDb2xvcix0aGlzLl9kcmF3Q29udHJvbChcInRsXCIsdCxhLHMtbyxuLW8pLHRoaXMuX2RyYXdDb250cm9sKFwidHJcIix0LGEscytpLW8sbi1vKSx0aGlzLl9kcmF3Q29udHJvbChcImJsXCIsdCxhLHMtbyxuK3ItbyksdGhpcy5fZHJhd0NvbnRyb2woXCJiclwiLHQsYSxzK2ktbyxuK3ItbyksdGhpcy5nZXQoXCJsb2NrVW5pU2NhbGluZ1wiKXx8KHRoaXMuX2RyYXdDb250cm9sKFwibXRcIix0LGEscytpLzItbyxuLW8pLHRoaXMuX2RyYXdDb250cm9sKFwibWJcIix0LGEscytpLzItbyxuK3ItbyksdGhpcy5fZHJhd0NvbnRyb2woXCJtclwiLHQsYSxzK2ktbyxuK3IvMi1vKSx0aGlzLl9kcmF3Q29udHJvbChcIm1sXCIsdCxhLHMtbyxuK3IvMi1vKSksdGhpcy5oYXNSb3RhdGluZ1BvaW50JiZ0aGlzLl9kcmF3Q29udHJvbChcIm10clwiLHQsYSxzK2kvMi1vLG4tdGhpcy5yb3RhdGluZ1BvaW50T2Zmc2V0LW8pLHQucmVzdG9yZSgpLHRoaXN9LF9kcmF3Q29udHJvbDpmdW5jdGlvbih0LGkscixzLG4pe2lmKHRoaXMuaXNDb250cm9sVmlzaWJsZSh0KSl7dmFyIG89dGhpcy5jb3JuZXJTaXplO2UoKXx8dGhpcy50cmFuc3BhcmVudENvcm5lcnN8fGkuY2xlYXJSZWN0KHMsbixvLG8pLGlbcl0ocyxuLG8sbyl9fSxpc0NvbnRyb2xWaXNpYmxlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9nZXRDb250cm9sc1Zpc2liaWxpdHkoKVt0XX0sc2V0Q29udHJvbFZpc2libGU6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5fZ2V0Q29udHJvbHNWaXNpYmlsaXR5KClbdF09ZSx0aGlzfSxzZXRDb250cm9sc1Zpc2liaWxpdHk6ZnVuY3Rpb24odCl7dHx8KHQ9e30pO2Zvcih2YXIgZSBpbiB0KXRoaXMuc2V0Q29udHJvbFZpc2libGUoZSx0W2VdKTtyZXR1cm4gdGhpc30sX2dldENvbnRyb2xzVmlzaWJpbGl0eTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jb250cm9sc1Zpc2liaWxpdHl8fCh0aGlzLl9jb250cm9sc1Zpc2liaWxpdHk9e3RsOiEwLHRyOiEwLGJyOiEwLGJsOiEwLG1sOiEwLG10OiEwLG1yOiEwLG1iOiEwLG10cjohMH0pLHRoaXMuX2NvbnRyb2xzVmlzaWJpbGl0eX19KX0oKSxmYWJyaWMudXRpbC5vYmplY3QuZXh0ZW5kKGZhYnJpYy5TdGF0aWNDYW52YXMucHJvdG90eXBlLHtGWF9EVVJBVElPTjo1MDAsZnhDZW50ZXJPYmplY3RIOmZ1bmN0aW9uKHQsZSl7ZT1lfHx7fTt2YXIgaT1mdW5jdGlvbigpe30scj1lLm9uQ29tcGxldGV8fGkscz1lLm9uQ2hhbmdlfHxpLG49dGhpcztyZXR1cm4gZmFicmljLnV0aWwuYW5pbWF0ZSh7c3RhcnRWYWx1ZTp0LmdldChcImxlZnRcIiksZW5kVmFsdWU6dGhpcy5nZXRDZW50ZXIoKS5sZWZ0LGR1cmF0aW9uOnRoaXMuRlhfRFVSQVRJT04sb25DaGFuZ2U6ZnVuY3Rpb24oZSl7dC5zZXQoXCJsZWZ0XCIsZSksbi5yZW5kZXJBbGwoKSxzKCl9LG9uQ29tcGxldGU6ZnVuY3Rpb24oKXt0LnNldENvb3JkcygpLHIoKX19KSx0aGlzfSxmeENlbnRlck9iamVjdFY6ZnVuY3Rpb24odCxlKXtlPWV8fHt9O3ZhciBpPWZ1bmN0aW9uKCl7fSxyPWUub25Db21wbGV0ZXx8aSxzPWUub25DaGFuZ2V8fGksbj10aGlzO3JldHVybiBmYWJyaWMudXRpbC5hbmltYXRlKHtzdGFydFZhbHVlOnQuZ2V0KFwidG9wXCIpLGVuZFZhbHVlOnRoaXMuZ2V0Q2VudGVyKCkudG9wLGR1cmF0aW9uOnRoaXMuRlhfRFVSQVRJT04sb25DaGFuZ2U6ZnVuY3Rpb24oZSl7dC5zZXQoXCJ0b3BcIixlKSxuLnJlbmRlckFsbCgpLHMoKX0sb25Db21wbGV0ZTpmdW5jdGlvbigpe3Quc2V0Q29vcmRzKCkscigpfX0pLHRoaXN9LGZ4UmVtb3ZlOmZ1bmN0aW9uKHQsZSl7ZT1lfHx7fTt2YXIgaT1mdW5jdGlvbigpe30scj1lLm9uQ29tcGxldGV8fGkscz1lLm9uQ2hhbmdlfHxpLG49dGhpcztyZXR1cm4gZmFicmljLnV0aWwuYW5pbWF0ZSh7c3RhcnRWYWx1ZTp0LmdldChcIm9wYWNpdHlcIiksZW5kVmFsdWU6MCxkdXJhdGlvbjp0aGlzLkZYX0RVUkFUSU9OLG9uU3RhcnQ6ZnVuY3Rpb24oKXt0LnNldChcImFjdGl2ZVwiLCExKX0sb25DaGFuZ2U6ZnVuY3Rpb24oZSl7dC5zZXQoXCJvcGFjaXR5XCIsZSksbi5yZW5kZXJBbGwoKSxzKCl9LG9uQ29tcGxldGU6ZnVuY3Rpb24oKXtuLnJlbW92ZSh0KSxyKCl9fSksdGhpc319KSxmYWJyaWMudXRpbC5vYmplY3QuZXh0ZW5kKGZhYnJpYy5PYmplY3QucHJvdG90eXBlLHthbmltYXRlOmZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzWzBdJiZcIm9iamVjdFwiPT10eXBlb2YgYXJndW1lbnRzWzBdKXt2YXIgdCxlLGk9W107Zm9yKHQgaW4gYXJndW1lbnRzWzBdKWkucHVzaCh0KTtmb3IodmFyIHI9MCxzPWkubGVuZ3RoO3M+cjtyKyspdD1pW3JdLGU9ciE9PXMtMSx0aGlzLl9hbmltYXRlKHQsYXJndW1lbnRzWzBdW3RdLGFyZ3VtZW50c1sxXSxlKX1lbHNlIHRoaXMuX2FuaW1hdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybiB0aGlzfSxfYW5pbWF0ZTpmdW5jdGlvbih0LGUsaSxyKXt2YXIgcyxuPXRoaXM7ZT1lLnRvU3RyaW5nKCksaT1pP2ZhYnJpYy51dGlsLm9iamVjdC5jbG9uZShpKTp7fSx+dC5pbmRleE9mKFwiLlwiKSYmKHM9dC5zcGxpdChcIi5cIikpO3ZhciBvPXM/dGhpcy5nZXQoc1swXSlbc1sxXV06dGhpcy5nZXQodCk7XCJmcm9tXCJpbiBpfHwoaS5mcm9tPW8pLGU9fmUuaW5kZXhPZihcIj1cIik/bytwYXJzZUZsb2F0KGUucmVwbGFjZShcIj1cIixcIlwiKSk6cGFyc2VGbG9hdChlKSxmYWJyaWMudXRpbC5hbmltYXRlKHtzdGFydFZhbHVlOmkuZnJvbSxlbmRWYWx1ZTplLGJ5VmFsdWU6aS5ieSxlYXNpbmc6aS5lYXNpbmcsZHVyYXRpb246aS5kdXJhdGlvbixhYm9ydDppLmFib3J0JiZmdW5jdGlvbigpe3JldHVybiBpLmFib3J0LmNhbGwobil9LG9uQ2hhbmdlOmZ1bmN0aW9uKGUpe3M/bltzWzBdXVtzWzFdXT1lOm4uc2V0KHQsZSkscnx8aS5vbkNoYW5nZSYmaS5vbkNoYW5nZSgpfSxvbkNvbXBsZXRlOmZ1bmN0aW9uKCl7cnx8KG4uc2V0Q29vcmRzKCksaS5vbkNvbXBsZXRlJiZpLm9uQ29tcGxldGUoKSl9fSl9fSksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gZSh0LGUpe3ZhciBpPXQub3JpZ2luLHI9dC5heGlzMSxzPXQuYXhpczIsbj10LmRpbWVuc2lvbixvPWUubmVhcmVzdCxhPWUuY2VudGVyLGg9ZS5mYXJ0aGVzdDtyZXR1cm4gZnVuY3Rpb24oKXtzd2l0Y2godGhpcy5nZXQoaSkpe2Nhc2UgbzpyZXR1cm4gTWF0aC5taW4odGhpcy5nZXQociksdGhpcy5nZXQocykpO2Nhc2UgYTpyZXR1cm4gTWF0aC5taW4odGhpcy5nZXQociksdGhpcy5nZXQocykpKy41KnRoaXMuZ2V0KG4pO2Nhc2UgaDpyZXR1cm4gTWF0aC5tYXgodGhpcy5nZXQociksdGhpcy5nZXQocykpO1xyXG5cclxufX19dmFyIGk9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSkscj1pLnV0aWwub2JqZWN0LmV4dGVuZCxzPXt4MToxLHgyOjEseTE6MSx5MjoxfSxuPWkuU3RhdGljQ2FudmFzLnN1cHBvcnRzKFwic2V0TGluZURhc2hcIik7cmV0dXJuIGkuTGluZT92b2lkIGkud2FybihcImZhYnJpYy5MaW5lIGlzIGFscmVhZHkgZGVmaW5lZFwiKTooaS5MaW5lPWkudXRpbC5jcmVhdGVDbGFzcyhpLk9iamVjdCx7dHlwZTpcImxpbmVcIix4MTowLHkxOjAseDI6MCx5MjowLGluaXRpYWxpemU6ZnVuY3Rpb24odCxlKXtlPWV8fHt9LHR8fCh0PVswLDAsMCwwXSksdGhpcy5jYWxsU3VwZXIoXCJpbml0aWFsaXplXCIsZSksdGhpcy5zZXQoXCJ4MVwiLHRbMF0pLHRoaXMuc2V0KFwieTFcIix0WzFdKSx0aGlzLnNldChcIngyXCIsdFsyXSksdGhpcy5zZXQoXCJ5MlwiLHRbM10pLHRoaXMuX3NldFdpZHRoSGVpZ2h0KGUpfSxfc2V0V2lkdGhIZWlnaHQ6ZnVuY3Rpb24odCl7dHx8KHQ9e30pLHRoaXMud2lkdGg9TWF0aC5hYnModGhpcy54Mi10aGlzLngxKSx0aGlzLmhlaWdodD1NYXRoLmFicyh0aGlzLnkyLXRoaXMueTEpLHRoaXMubGVmdD1cImxlZnRcImluIHQ/dC5sZWZ0OnRoaXMuX2dldExlZnRUb09yaWdpblgoKSx0aGlzLnRvcD1cInRvcFwiaW4gdD90LnRvcDp0aGlzLl9nZXRUb3BUb09yaWdpblkoKX0sX3NldDpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLmNhbGxTdXBlcihcIl9zZXRcIix0LGUpLFwidW5kZWZpbmVkXCIhPXR5cGVvZiBzW3RdJiZ0aGlzLl9zZXRXaWR0aEhlaWdodCgpLHRoaXN9LF9nZXRMZWZ0VG9PcmlnaW5YOmUoe29yaWdpbjpcIm9yaWdpblhcIixheGlzMTpcIngxXCIsYXhpczI6XCJ4MlwiLGRpbWVuc2lvbjpcIndpZHRoXCJ9LHtuZWFyZXN0OlwibGVmdFwiLGNlbnRlcjpcImNlbnRlclwiLGZhcnRoZXN0OlwicmlnaHRcIn0pLF9nZXRUb3BUb09yaWdpblk6ZSh7b3JpZ2luOlwib3JpZ2luWVwiLGF4aXMxOlwieTFcIixheGlzMjpcInkyXCIsZGltZW5zaW9uOlwiaGVpZ2h0XCJ9LHtuZWFyZXN0OlwidG9wXCIsY2VudGVyOlwiY2VudGVyXCIsZmFydGhlc3Q6XCJib3R0b21cIn0pLF9yZW5kZXI6ZnVuY3Rpb24odCxlKXtpZih0LmJlZ2luUGF0aCgpLGUpe3ZhciBpPXRoaXMuZ2V0Q2VudGVyUG9pbnQoKTt0LnRyYW5zbGF0ZShpLngtdGhpcy5zdHJva2VXaWR0aC8yLGkueS10aGlzLnN0cm9rZVdpZHRoLzIpfWlmKCF0aGlzLnN0cm9rZURhc2hBcnJheXx8dGhpcy5zdHJva2VEYXNoQXJyYXkmJm4pe3ZhciByPXRoaXMuY2FsY0xpbmVQb2ludHMoKTt0Lm1vdmVUbyhyLngxLHIueTEpLHQubGluZVRvKHIueDIsci55Mil9dC5saW5lV2lkdGg9dGhpcy5zdHJva2VXaWR0aDt2YXIgcz10LnN0cm9rZVN0eWxlO3Quc3Ryb2tlU3R5bGU9dGhpcy5zdHJva2V8fHQuZmlsbFN0eWxlLHRoaXMuc3Ryb2tlJiZ0aGlzLl9yZW5kZXJTdHJva2UodCksdC5zdHJva2VTdHlsZT1zfSxfcmVuZGVyRGFzaGVkU3Ryb2tlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuY2FsY0xpbmVQb2ludHMoKTt0LmJlZ2luUGF0aCgpLGkudXRpbC5kcmF3RGFzaGVkTGluZSh0LGUueDEsZS55MSxlLngyLGUueTIsdGhpcy5zdHJva2VEYXNoQXJyYXkpLHQuY2xvc2VQYXRoKCl9LHRvT2JqZWN0OmZ1bmN0aW9uKHQpe3JldHVybiByKHRoaXMuY2FsbFN1cGVyKFwidG9PYmplY3RcIix0KSx0aGlzLmNhbGNMaW5lUG9pbnRzKCkpfSxjYWxjTGluZVBvaW50czpmdW5jdGlvbigpe3ZhciB0PXRoaXMueDE8PXRoaXMueDI/LTE6MSxlPXRoaXMueTE8PXRoaXMueTI/LTE6MSxpPXQqdGhpcy53aWR0aCouNSxyPWUqdGhpcy5oZWlnaHQqLjUscz10KnRoaXMud2lkdGgqLS41LG49ZSp0aGlzLmhlaWdodCotLjU7cmV0dXJue3gxOmkseDI6cyx5MTpyLHkyOm59fSx0b1NWRzpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl9jcmVhdGVCYXNlU1ZHTWFya3VwKCksaT17eDE6dGhpcy54MSx4Mjp0aGlzLngyLHkxOnRoaXMueTEseTI6dGhpcy55Mn07cmV0dXJuIHRoaXMuZ3JvdXAmJlwicGF0aC1ncm91cFwiPT09dGhpcy5ncm91cC50eXBlfHwoaT10aGlzLmNhbGNMaW5lUG9pbnRzKCkpLGUucHVzaChcIjxsaW5lIFwiLCd4MT1cIicsaS54MSwnXCIgeTE9XCInLGkueTEsJ1wiIHgyPVwiJyxpLngyLCdcIiB5Mj1cIicsaS55MiwnXCIgc3R5bGU9XCInLHRoaXMuZ2V0U3ZnU3R5bGVzKCksJ1wiIHRyYW5zZm9ybT1cIicsdGhpcy5nZXRTdmdUcmFuc2Zvcm0oKSx0aGlzLmdldFN2Z1RyYW5zZm9ybU1hdHJpeCgpLCdcIi8+XFxuJyksdD90KGUuam9pbihcIlwiKSk6ZS5qb2luKFwiXCIpfSxjb21wbGV4aXR5OmZ1bmN0aW9uKCl7cmV0dXJuIDF9fSksaS5MaW5lLkFUVFJJQlVURV9OQU1FUz1pLlNIQVJFRF9BVFRSSUJVVEVTLmNvbmNhdChcIngxIHkxIHgyIHkyXCIuc3BsaXQoXCIgXCIpKSxpLkxpbmUuZnJvbUVsZW1lbnQ9ZnVuY3Rpb24odCxlKXt2YXIgcz1pLnBhcnNlQXR0cmlidXRlcyh0LGkuTGluZS5BVFRSSUJVVEVfTkFNRVMpLG49W3MueDF8fDAscy55MXx8MCxzLngyfHwwLHMueTJ8fDBdO3JldHVybiBuZXcgaS5MaW5lKG4scihzLGUpKX0sdm9pZChpLkxpbmUuZnJvbU9iamVjdD1mdW5jdGlvbih0KXt2YXIgZT1bdC54MSx0LnkxLHQueDIsdC55Ml07cmV0dXJuIG5ldyBpLkxpbmUoZSx0KX0pKX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBlKHQpe3JldHVyblwicmFkaXVzXCJpbiB0JiZ0LnJhZGl1cz49MH12YXIgaT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxyPU1hdGguUEkscz1pLnV0aWwub2JqZWN0LmV4dGVuZDtyZXR1cm4gaS5DaXJjbGU/dm9pZCBpLndhcm4oXCJmYWJyaWMuQ2lyY2xlIGlzIGFscmVhZHkgZGVmaW5lZC5cIik6KGkuQ2lyY2xlPWkudXRpbC5jcmVhdGVDbGFzcyhpLk9iamVjdCx7dHlwZTpcImNpcmNsZVwiLHJhZGl1czowLHN0YXJ0QW5nbGU6MCxlbmRBbmdsZToyKnIsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0PXR8fHt9LHRoaXMuY2FsbFN1cGVyKFwiaW5pdGlhbGl6ZVwiLHQpLHRoaXMuc2V0KFwicmFkaXVzXCIsdC5yYWRpdXN8fDApLHRoaXMuc3RhcnRBbmdsZT10LnN0YXJ0QW5nbGV8fHRoaXMuc3RhcnRBbmdsZSx0aGlzLmVuZEFuZ2xlPXQuZW5kQW5nbGV8fHRoaXMuZW5kQW5nbGV9LF9zZXQ6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5jYWxsU3VwZXIoXCJfc2V0XCIsdCxlKSxcInJhZGl1c1wiPT09dCYmdGhpcy5zZXRSYWRpdXMoZSksdGhpc30sdG9PYmplY3Q6ZnVuY3Rpb24odCl7cmV0dXJuIHModGhpcy5jYWxsU3VwZXIoXCJ0b09iamVjdFwiLHQpLHtyYWRpdXM6dGhpcy5nZXQoXCJyYWRpdXNcIiksc3RhcnRBbmdsZTp0aGlzLnN0YXJ0QW5nbGUsZW5kQW5nbGU6dGhpcy5lbmRBbmdsZX0pfSx0b1NWRzpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl9jcmVhdGVCYXNlU1ZHTWFya3VwKCksaT0wLHM9MCxuPSh0aGlzLmVuZEFuZ2xlLXRoaXMuc3RhcnRBbmdsZSklKDIqcik7aWYoMD09PW4pdGhpcy5ncm91cCYmXCJwYXRoLWdyb3VwXCI9PT10aGlzLmdyb3VwLnR5cGUmJihpPXRoaXMubGVmdCt0aGlzLnJhZGl1cyxzPXRoaXMudG9wK3RoaXMucmFkaXVzKSxlLnB1c2goXCI8Y2lyY2xlIFwiLCdjeD1cIicraSsnXCIgY3k9XCInK3MrJ1wiICcsJ3I9XCInLHRoaXMucmFkaXVzLCdcIiBzdHlsZT1cIicsdGhpcy5nZXRTdmdTdHlsZXMoKSwnXCIgdHJhbnNmb3JtPVwiJyx0aGlzLmdldFN2Z1RyYW5zZm9ybSgpLFwiIFwiLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtTWF0cml4KCksJ1wiLz5cXG4nKTtlbHNle3ZhciBvPU1hdGguY29zKHRoaXMuc3RhcnRBbmdsZSkqdGhpcy5yYWRpdXMsYT1NYXRoLnNpbih0aGlzLnN0YXJ0QW5nbGUpKnRoaXMucmFkaXVzLGg9TWF0aC5jb3ModGhpcy5lbmRBbmdsZSkqdGhpcy5yYWRpdXMsYz1NYXRoLnNpbih0aGlzLmVuZEFuZ2xlKSp0aGlzLnJhZGl1cyxsPW4+cj9cIjFcIjpcIjBcIjtlLnB1c2goJzxwYXRoIGQ9XCJNICcrbytcIiBcIithLFwiIEEgXCIrdGhpcy5yYWRpdXMrXCIgXCIrdGhpcy5yYWRpdXMsXCIgMCBcIiwrbCtcIiAxXCIsXCIgXCIraCtcIiBcIitjLCdcIiBzdHlsZT1cIicsdGhpcy5nZXRTdmdTdHlsZXMoKSwnXCIgdHJhbnNmb3JtPVwiJyx0aGlzLmdldFN2Z1RyYW5zZm9ybSgpLFwiIFwiLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtTWF0cml4KCksJ1wiLz5cXG4nKX1yZXR1cm4gdD90KGUuam9pbihcIlwiKSk6ZS5qb2luKFwiXCIpfSxfcmVuZGVyOmZ1bmN0aW9uKHQsZSl7dC5iZWdpblBhdGgoKSx0LmFyYyhlP3RoaXMubGVmdCt0aGlzLnJhZGl1czowLGU/dGhpcy50b3ArdGhpcy5yYWRpdXM6MCx0aGlzLnJhZGl1cyx0aGlzLnN0YXJ0QW5nbGUsdGhpcy5lbmRBbmdsZSwhMSksdGhpcy5fcmVuZGVyRmlsbCh0KSx0aGlzLl9yZW5kZXJTdHJva2UodCl9LGdldFJhZGl1c1g6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXQoXCJyYWRpdXNcIikqdGhpcy5nZXQoXCJzY2FsZVhcIil9LGdldFJhZGl1c1k6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXQoXCJyYWRpdXNcIikqdGhpcy5nZXQoXCJzY2FsZVlcIil9LHNldFJhZGl1czpmdW5jdGlvbih0KXt0aGlzLnJhZGl1cz10LHRoaXMuc2V0KFwid2lkdGhcIiwyKnQpLnNldChcImhlaWdodFwiLDIqdCl9LGNvbXBsZXhpdHk6ZnVuY3Rpb24oKXtyZXR1cm4gMX19KSxpLkNpcmNsZS5BVFRSSUJVVEVfTkFNRVM9aS5TSEFSRURfQVRUUklCVVRFUy5jb25jYXQoXCJjeCBjeSByXCIuc3BsaXQoXCIgXCIpKSxpLkNpcmNsZS5mcm9tRWxlbWVudD1mdW5jdGlvbih0LHIpe3J8fChyPXt9KTt2YXIgbj1pLnBhcnNlQXR0cmlidXRlcyh0LGkuQ2lyY2xlLkFUVFJJQlVURV9OQU1FUyk7aWYoIWUobikpdGhyb3cgbmV3IEVycm9yKFwidmFsdWUgb2YgYHJgIGF0dHJpYnV0ZSBpcyByZXF1aXJlZCBhbmQgY2FuIG5vdCBiZSBuZWdhdGl2ZVwiKTtuLmxlZnQ9bi5sZWZ0fHwwLG4udG9wPW4udG9wfHwwO3ZhciBvPW5ldyBpLkNpcmNsZShzKG4scikpO3JldHVybiBvLmxlZnQtPW8ucmFkaXVzLG8udG9wLT1vLnJhZGl1cyxvfSx2b2lkKGkuQ2lyY2xlLmZyb21PYmplY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBpLkNpcmNsZSh0KX0pKX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KTtyZXR1cm4gZS5UcmlhbmdsZT92b2lkIGUud2FybihcImZhYnJpYy5UcmlhbmdsZSBpcyBhbHJlYWR5IGRlZmluZWRcIik6KGUuVHJpYW5nbGU9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuT2JqZWN0LHt0eXBlOlwidHJpYW5nbGVcIixpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3Q9dHx8e30sdGhpcy5jYWxsU3VwZXIoXCJpbml0aWFsaXplXCIsdCksdGhpcy5zZXQoXCJ3aWR0aFwiLHQud2lkdGh8fDEwMCkuc2V0KFwiaGVpZ2h0XCIsdC5oZWlnaHR8fDEwMCl9LF9yZW5kZXI6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy53aWR0aC8yLGk9dGhpcy5oZWlnaHQvMjt0LmJlZ2luUGF0aCgpLHQubW92ZVRvKC1lLGkpLHQubGluZVRvKDAsLWkpLHQubGluZVRvKGUsaSksdC5jbG9zZVBhdGgoKSx0aGlzLl9yZW5kZXJGaWxsKHQpLHRoaXMuX3JlbmRlclN0cm9rZSh0KX0sX3JlbmRlckRhc2hlZFN0cm9rZTpmdW5jdGlvbih0KXt2YXIgaT10aGlzLndpZHRoLzIscj10aGlzLmhlaWdodC8yO3QuYmVnaW5QYXRoKCksZS51dGlsLmRyYXdEYXNoZWRMaW5lKHQsLWksciwwLC1yLHRoaXMuc3Ryb2tlRGFzaEFycmF5KSxlLnV0aWwuZHJhd0Rhc2hlZExpbmUodCwwLC1yLGkscix0aGlzLnN0cm9rZURhc2hBcnJheSksZS51dGlsLmRyYXdEYXNoZWRMaW5lKHQsaSxyLC1pLHIsdGhpcy5zdHJva2VEYXNoQXJyYXkpLHQuY2xvc2VQYXRoKCl9LHRvU1ZHOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX2NyZWF0ZUJhc2VTVkdNYXJrdXAoKSxpPXRoaXMud2lkdGgvMixyPXRoaXMuaGVpZ2h0LzIscz1bLWkrXCIgXCIrcixcIjAgXCIrLXIsaStcIiBcIityXS5qb2luKFwiLFwiKTtyZXR1cm4gZS5wdXNoKFwiPHBvbHlnb24gXCIsJ3BvaW50cz1cIicscywnXCIgc3R5bGU9XCInLHRoaXMuZ2V0U3ZnU3R5bGVzKCksJ1wiIHRyYW5zZm9ybT1cIicsdGhpcy5nZXRTdmdUcmFuc2Zvcm0oKSwnXCIvPicpLHQ/dChlLmpvaW4oXCJcIikpOmUuam9pbihcIlwiKX0sY29tcGxleGl0eTpmdW5jdGlvbigpe3JldHVybiAxfX0pLHZvaWQoZS5UcmlhbmdsZS5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5UcmlhbmdsZSh0KX0pKX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPTIqTWF0aC5QSSxyPWUudXRpbC5vYmplY3QuZXh0ZW5kO3JldHVybiBlLkVsbGlwc2U/dm9pZCBlLndhcm4oXCJmYWJyaWMuRWxsaXBzZSBpcyBhbHJlYWR5IGRlZmluZWQuXCIpOihlLkVsbGlwc2U9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuT2JqZWN0LHt0eXBlOlwiZWxsaXBzZVwiLHJ4OjAscnk6MCxpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3Q9dHx8e30sdGhpcy5jYWxsU3VwZXIoXCJpbml0aWFsaXplXCIsdCksdGhpcy5zZXQoXCJyeFwiLHQucnh8fDApLHRoaXMuc2V0KFwicnlcIix0LnJ5fHwwKX0sX3NldDpmdW5jdGlvbih0LGUpe3N3aXRjaCh0aGlzLmNhbGxTdXBlcihcIl9zZXRcIix0LGUpLHQpe2Nhc2VcInJ4XCI6dGhpcy5yeD1lLHRoaXMuc2V0KFwid2lkdGhcIiwyKmUpO2JyZWFrO2Nhc2VcInJ5XCI6dGhpcy5yeT1lLHRoaXMuc2V0KFwiaGVpZ2h0XCIsMiplKX1yZXR1cm4gdGhpc30sZ2V0Ung6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXQoXCJyeFwiKSp0aGlzLmdldChcInNjYWxlWFwiKX0sZ2V0Unk6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXQoXCJyeVwiKSp0aGlzLmdldChcInNjYWxlWVwiKX0sdG9PYmplY3Q6ZnVuY3Rpb24odCl7cmV0dXJuIHIodGhpcy5jYWxsU3VwZXIoXCJ0b09iamVjdFwiLHQpLHtyeDp0aGlzLmdldChcInJ4XCIpLHJ5OnRoaXMuZ2V0KFwicnlcIil9KX0sdG9TVkc6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fY3JlYXRlQmFzZVNWR01hcmt1cCgpLGk9MCxyPTA7cmV0dXJuIHRoaXMuZ3JvdXAmJlwicGF0aC1ncm91cFwiPT09dGhpcy5ncm91cC50eXBlJiYoaT10aGlzLmxlZnQrdGhpcy5yeCxyPXRoaXMudG9wK3RoaXMucnkpLGUucHVzaChcIjxlbGxpcHNlIFwiLCdjeD1cIicsaSwnXCIgY3k9XCInLHIsJ1wiICcsJ3J4PVwiJyx0aGlzLnJ4LCdcIiByeT1cIicsdGhpcy5yeSwnXCIgc3R5bGU9XCInLHRoaXMuZ2V0U3ZnU3R5bGVzKCksJ1wiIHRyYW5zZm9ybT1cIicsdGhpcy5nZXRTdmdUcmFuc2Zvcm0oKSx0aGlzLmdldFN2Z1RyYW5zZm9ybU1hdHJpeCgpLCdcIi8+XFxuJyksdD90KGUuam9pbihcIlwiKSk6ZS5qb2luKFwiXCIpfSxfcmVuZGVyOmZ1bmN0aW9uKHQsZSl7dC5iZWdpblBhdGgoKSx0LnNhdmUoKSx0LnRyYW5zZm9ybSgxLDAsMCx0aGlzLnJ5L3RoaXMucngsMCwwKSx0LmFyYyhlP3RoaXMubGVmdCt0aGlzLnJ4OjAsZT8odGhpcy50b3ArdGhpcy5yeSkqdGhpcy5yeC90aGlzLnJ5OjAsdGhpcy5yeCwwLGksITEpLHQucmVzdG9yZSgpLHRoaXMuX3JlbmRlckZpbGwodCksdGhpcy5fcmVuZGVyU3Ryb2tlKHQpfSxjb21wbGV4aXR5OmZ1bmN0aW9uKCl7cmV0dXJuIDF9fSksZS5FbGxpcHNlLkFUVFJJQlVURV9OQU1FUz1lLlNIQVJFRF9BVFRSSUJVVEVTLmNvbmNhdChcImN4IGN5IHJ4IHJ5XCIuc3BsaXQoXCIgXCIpKSxlLkVsbGlwc2UuZnJvbUVsZW1lbnQ9ZnVuY3Rpb24odCxpKXtpfHwoaT17fSk7dmFyIHM9ZS5wYXJzZUF0dHJpYnV0ZXModCxlLkVsbGlwc2UuQVRUUklCVVRFX05BTUVTKTtzLmxlZnQ9cy5sZWZ0fHwwLHMudG9wPXMudG9wfHwwO3ZhciBuPW5ldyBlLkVsbGlwc2UocihzLGkpKTtyZXR1cm4gbi50b3AtPW4ucnksbi5sZWZ0LT1uLnJ4LG59LHZvaWQoZS5FbGxpcHNlLmZyb21PYmplY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlLkVsbGlwc2UodCl9KSl9KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSksaT1lLnV0aWwub2JqZWN0LmV4dGVuZDtpZihlLlJlY3QpcmV0dXJuIHZvaWQgY29uc29sZS53YXJuKFwiZmFicmljLlJlY3QgaXMgYWxyZWFkeSBkZWZpbmVkXCIpO3ZhciByPWUuT2JqZWN0LnByb3RvdHlwZS5zdGF0ZVByb3BlcnRpZXMuY29uY2F0KCk7ci5wdXNoKFwicnhcIixcInJ5XCIsXCJ4XCIsXCJ5XCIpLGUuUmVjdD1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5PYmplY3Qse3N0YXRlUHJvcGVydGllczpyLHR5cGU6XCJyZWN0XCIscng6MCxyeTowLHN0cm9rZURhc2hBcnJheTpudWxsLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dD10fHx7fSx0aGlzLmNhbGxTdXBlcihcImluaXRpYWxpemVcIix0KSx0aGlzLl9pbml0UnhSeSgpfSxfaW5pdFJ4Unk6ZnVuY3Rpb24oKXt0aGlzLnJ4JiYhdGhpcy5yeT90aGlzLnJ5PXRoaXMucng6dGhpcy5yeSYmIXRoaXMucngmJih0aGlzLnJ4PXRoaXMucnkpfSxfcmVuZGVyOmZ1bmN0aW9uKHQsZSl7aWYoMT09PXRoaXMud2lkdGgmJjE9PT10aGlzLmhlaWdodClyZXR1cm4gdm9pZCB0LmZpbGxSZWN0KDAsMCwxLDEpO3ZhciBpPXRoaXMucng/TWF0aC5taW4odGhpcy5yeCx0aGlzLndpZHRoLzIpOjAscj10aGlzLnJ5P01hdGgubWluKHRoaXMucnksdGhpcy5oZWlnaHQvMik6MCxzPXRoaXMud2lkdGgsbj10aGlzLmhlaWdodCxvPWU/dGhpcy5sZWZ0Oi10aGlzLndpZHRoLzIsYT1lP3RoaXMudG9wOi10aGlzLmhlaWdodC8yLGg9MCE9PWl8fDAhPT1yLGM9LjQ0NzcxNTI1MDI7dC5iZWdpblBhdGgoKSx0Lm1vdmVUbyhvK2ksYSksdC5saW5lVG8obytzLWksYSksaCYmdC5iZXppZXJDdXJ2ZVRvKG8rcy1jKmksYSxvK3MsYStjKnIsbytzLGErciksdC5saW5lVG8obytzLGErbi1yKSxoJiZ0LmJlemllckN1cnZlVG8obytzLGErbi1jKnIsbytzLWMqaSxhK24sbytzLWksYStuKSx0LmxpbmVUbyhvK2ksYStuKSxoJiZ0LmJlemllckN1cnZlVG8obytjKmksYStuLG8sYStuLWMqcixvLGErbi1yKSx0LmxpbmVUbyhvLGErciksaCYmdC5iZXppZXJDdXJ2ZVRvKG8sYStjKnIsbytjKmksYSxvK2ksYSksdC5jbG9zZVBhdGgoKSx0aGlzLl9yZW5kZXJGaWxsKHQpLHRoaXMuX3JlbmRlclN0cm9rZSh0KX0sX3JlbmRlckRhc2hlZFN0cm9rZTpmdW5jdGlvbih0KXt2YXIgaT0tdGhpcy53aWR0aC8yLHI9LXRoaXMuaGVpZ2h0LzIscz10aGlzLndpZHRoLG49dGhpcy5oZWlnaHQ7dC5iZWdpblBhdGgoKSxlLnV0aWwuZHJhd0Rhc2hlZExpbmUodCxpLHIsaStzLHIsdGhpcy5zdHJva2VEYXNoQXJyYXkpLGUudXRpbC5kcmF3RGFzaGVkTGluZSh0LGkrcyxyLGkrcyxyK24sdGhpcy5zdHJva2VEYXNoQXJyYXkpLGUudXRpbC5kcmF3RGFzaGVkTGluZSh0LGkrcyxyK24saSxyK24sdGhpcy5zdHJva2VEYXNoQXJyYXkpLGUudXRpbC5kcmF3RGFzaGVkTGluZSh0LGkscituLGkscix0aGlzLnN0cm9rZURhc2hBcnJheSksdC5jbG9zZVBhdGgoKX0sdG9PYmplY3Q6ZnVuY3Rpb24odCl7dmFyIGU9aSh0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIsdCkse3J4OnRoaXMuZ2V0KFwicnhcIil8fDAscnk6dGhpcy5nZXQoXCJyeVwiKXx8MH0pO3JldHVybiB0aGlzLmluY2x1ZGVEZWZhdWx0VmFsdWVzfHx0aGlzLl9yZW1vdmVEZWZhdWx0VmFsdWVzKGUpLGV9LHRvU1ZHOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX2NyZWF0ZUJhc2VTVkdNYXJrdXAoKSxpPXRoaXMubGVmdCxyPXRoaXMudG9wO3JldHVybiB0aGlzLmdyb3VwJiZcInBhdGgtZ3JvdXBcIj09PXRoaXMuZ3JvdXAudHlwZXx8KGk9LXRoaXMud2lkdGgvMixyPS10aGlzLmhlaWdodC8yKSxlLnB1c2goXCI8cmVjdCBcIiwneD1cIicsaSwnXCIgeT1cIicsciwnXCIgcng9XCInLHRoaXMuZ2V0KFwicnhcIiksJ1wiIHJ5PVwiJyx0aGlzLmdldChcInJ5XCIpLCdcIiB3aWR0aD1cIicsdGhpcy53aWR0aCwnXCIgaGVpZ2h0PVwiJyx0aGlzLmhlaWdodCwnXCIgc3R5bGU9XCInLHRoaXMuZ2V0U3ZnU3R5bGVzKCksJ1wiIHRyYW5zZm9ybT1cIicsdGhpcy5nZXRTdmdUcmFuc2Zvcm0oKSx0aGlzLmdldFN2Z1RyYW5zZm9ybU1hdHJpeCgpLCdcIi8+XFxuJyksdD90KGUuam9pbihcIlwiKSk6ZS5qb2luKFwiXCIpfSxjb21wbGV4aXR5OmZ1bmN0aW9uKCl7cmV0dXJuIDF9fSksZS5SZWN0LkFUVFJJQlVURV9OQU1FUz1lLlNIQVJFRF9BVFRSSUJVVEVTLmNvbmNhdChcInggeSByeCByeSB3aWR0aCBoZWlnaHRcIi5zcGxpdChcIiBcIikpLGUuUmVjdC5mcm9tRWxlbWVudD1mdW5jdGlvbih0LHIpe2lmKCF0KXJldHVybiBudWxsO3I9cnx8e307dmFyIHM9ZS5wYXJzZUF0dHJpYnV0ZXModCxlLlJlY3QuQVRUUklCVVRFX05BTUVTKTtzLmxlZnQ9cy5sZWZ0fHwwLHMudG9wPXMudG9wfHwwO3ZhciBuPW5ldyBlLlJlY3QoaShyP2UudXRpbC5vYmplY3QuY2xvbmUocik6e30scykpO3JldHVybiBuLnZpc2libGU9bi53aWR0aD4wJiZuLmhlaWdodD4wLG59LGUuUmVjdC5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5SZWN0KHQpfX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KTtyZXR1cm4gZS5Qb2x5bGluZT92b2lkIGUud2FybihcImZhYnJpYy5Qb2x5bGluZSBpcyBhbHJlYWR5IGRlZmluZWRcIik6KGUuUG9seWxpbmU9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuT2JqZWN0LHt0eXBlOlwicG9seWxpbmVcIixwb2ludHM6bnVsbCxtaW5YOjAsbWluWTowLGluaXRpYWxpemU6ZnVuY3Rpb24odCxpKXtyZXR1cm4gZS5Qb2x5Z29uLnByb3RvdHlwZS5pbml0aWFsaXplLmNhbGwodGhpcyx0LGkpfSxfY2FsY0RpbWVuc2lvbnM6ZnVuY3Rpb24oKXtyZXR1cm4gZS5Qb2x5Z29uLnByb3RvdHlwZS5fY2FsY0RpbWVuc2lvbnMuY2FsbCh0aGlzKX0sX2FwcGx5UG9pbnRPZmZzZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZS5Qb2x5Z29uLnByb3RvdHlwZS5fYXBwbHlQb2ludE9mZnNldC5jYWxsKHRoaXMpfSx0b09iamVjdDpmdW5jdGlvbih0KXtyZXR1cm4gZS5Qb2x5Z29uLnByb3RvdHlwZS50b09iamVjdC5jYWxsKHRoaXMsdCl9LHRvU1ZHOmZ1bmN0aW9uKHQpe3JldHVybiBlLlBvbHlnb24ucHJvdG90eXBlLnRvU1ZHLmNhbGwodGhpcyx0KX0sX3JlbmRlcjpmdW5jdGlvbih0KXtlLlBvbHlnb24ucHJvdG90eXBlLmNvbW1vblJlbmRlci5jYWxsKHRoaXMsdCkmJih0aGlzLl9yZW5kZXJGaWxsKHQpLHRoaXMuX3JlbmRlclN0cm9rZSh0KSl9LF9yZW5kZXJEYXNoZWRTdHJva2U6ZnVuY3Rpb24odCl7dmFyIGkscjt0LmJlZ2luUGF0aCgpO2Zvcih2YXIgcz0wLG49dGhpcy5wb2ludHMubGVuZ3RoO24+cztzKyspaT10aGlzLnBvaW50c1tzXSxyPXRoaXMucG9pbnRzW3MrMV18fGksZS51dGlsLmRyYXdEYXNoZWRMaW5lKHQsaS54LGkueSxyLngsci55LHRoaXMuc3Ryb2tlRGFzaEFycmF5KX0sY29tcGxleGl0eTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldChcInBvaW50c1wiKS5sZW5ndGh9fSksZS5Qb2x5bGluZS5BVFRSSUJVVEVfTkFNRVM9ZS5TSEFSRURfQVRUUklCVVRFUy5jb25jYXQoKSxlLlBvbHlsaW5lLmZyb21FbGVtZW50PWZ1bmN0aW9uKHQsaSl7aWYoIXQpcmV0dXJuIG51bGw7aXx8KGk9e30pO3ZhciByPWUucGFyc2VQb2ludHNBdHRyaWJ1dGUodC5nZXRBdHRyaWJ1dGUoXCJwb2ludHNcIikpLHM9ZS5wYXJzZUF0dHJpYnV0ZXModCxlLlBvbHlsaW5lLkFUVFJJQlVURV9OQU1FUyk7cmV0dXJuIG5ldyBlLlBvbHlsaW5lKHIsZS51dGlsLm9iamVjdC5leHRlbmQocyxpKSl9LHZvaWQoZS5Qb2x5bGluZS5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3ZhciBpPXQucG9pbnRzO3JldHVybiBuZXcgZS5Qb2x5bGluZShpLHQsITApfSkpfShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPXQuZmFicmljfHwodC5mYWJyaWM9e30pLGk9ZS51dGlsLm9iamVjdC5leHRlbmQscj1lLnV0aWwuYXJyYXkubWluLHM9ZS51dGlsLmFycmF5Lm1heCxuPWUudXRpbC50b0ZpeGVkO3JldHVybiBlLlBvbHlnb24/dm9pZCBlLndhcm4oXCJmYWJyaWMuUG9seWdvbiBpcyBhbHJlYWR5IGRlZmluZWRcIik6KGUuUG9seWdvbj1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5PYmplY3Qse3R5cGU6XCJwb2x5Z29uXCIscG9pbnRzOm51bGwsbWluWDowLG1pblk6MCxpbml0aWFsaXplOmZ1bmN0aW9uKHQsZSl7ZT1lfHx7fSx0aGlzLnBvaW50cz10fHxbXSx0aGlzLmNhbGxTdXBlcihcImluaXRpYWxpemVcIixlKSx0aGlzLl9jYWxjRGltZW5zaW9ucygpLFwidG9wXCJpbiBlfHwodGhpcy50b3A9dGhpcy5taW5ZKSxcImxlZnRcImluIGV8fCh0aGlzLmxlZnQ9dGhpcy5taW5YKX0sX2NhbGNEaW1lbnNpb25zOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5wb2ludHMsZT1yKHQsXCJ4XCIpLGk9cih0LFwieVwiKSxuPXModCxcInhcIiksbz1zKHQsXCJ5XCIpO3RoaXMud2lkdGg9bi1lfHwwLHRoaXMuaGVpZ2h0PW8taXx8MCx0aGlzLm1pblg9ZXx8MCx0aGlzLm1pblk9aXx8MH0sX2FwcGx5UG9pbnRPZmZzZXQ6ZnVuY3Rpb24oKXt0aGlzLnBvaW50cy5mb3JFYWNoKGZ1bmN0aW9uKHQpe3QueC09dGhpcy5taW5YK3RoaXMud2lkdGgvMix0LnktPXRoaXMubWluWSt0aGlzLmhlaWdodC8yfSx0aGlzKX0sdG9PYmplY3Q6ZnVuY3Rpb24odCl7cmV0dXJuIGkodGhpcy5jYWxsU3VwZXIoXCJ0b09iamVjdFwiLHQpLHtwb2ludHM6dGhpcy5wb2ludHMuY29uY2F0KCl9KX0sdG9TVkc6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPVtdLGk9dGhpcy5fY3JlYXRlQmFzZVNWR01hcmt1cCgpLHI9MCxzPXRoaXMucG9pbnRzLmxlbmd0aDtzPnI7cisrKWUucHVzaChuKHRoaXMucG9pbnRzW3JdLngsMiksXCIsXCIsbih0aGlzLnBvaW50c1tyXS55LDIpLFwiIFwiKTtyZXR1cm4gaS5wdXNoKFwiPFwiLHRoaXMudHlwZSxcIiBcIiwncG9pbnRzPVwiJyxlLmpvaW4oXCJcIiksJ1wiIHN0eWxlPVwiJyx0aGlzLmdldFN2Z1N0eWxlcygpLCdcIiB0cmFuc2Zvcm09XCInLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtKCksXCIgXCIsdGhpcy5nZXRTdmdUcmFuc2Zvcm1NYXRyaXgoKSwnXCIvPlxcbicpLHQ/dChpLmpvaW4oXCJcIikpOmkuam9pbihcIlwiKX0sX3JlbmRlcjpmdW5jdGlvbih0KXt0aGlzLmNvbW1vblJlbmRlcih0KSYmKHRoaXMuX3JlbmRlckZpbGwodCksKHRoaXMuc3Ryb2tlfHx0aGlzLnN0cm9rZURhc2hBcnJheSkmJih0LmNsb3NlUGF0aCgpLHRoaXMuX3JlbmRlclN0cm9rZSh0KSkpfSxjb21tb25SZW5kZXI6ZnVuY3Rpb24odCl7dmFyIGUsaT10aGlzLnBvaW50cy5sZW5ndGg7aWYoIWl8fGlzTmFOKHRoaXMucG9pbnRzW2ktMV0ueSkpcmV0dXJuITE7dC5iZWdpblBhdGgoKSx0aGlzLl9hcHBseVBvaW50T2Zmc2V0JiYodGhpcy5ncm91cCYmXCJwYXRoLWdyb3VwXCI9PT10aGlzLmdyb3VwLnR5cGV8fHRoaXMuX2FwcGx5UG9pbnRPZmZzZXQoKSx0aGlzLl9hcHBseVBvaW50T2Zmc2V0PW51bGwpLHQubW92ZVRvKHRoaXMucG9pbnRzWzBdLngsdGhpcy5wb2ludHNbMF0ueSk7Zm9yKHZhciByPTA7aT5yO3IrKyllPXRoaXMucG9pbnRzW3JdLHQubGluZVRvKGUueCxlLnkpO3JldHVybiEwfSxfcmVuZGVyRGFzaGVkU3Ryb2tlOmZ1bmN0aW9uKHQpe2UuUG9seWxpbmUucHJvdG90eXBlLl9yZW5kZXJEYXNoZWRTdHJva2UuY2FsbCh0aGlzLHQpLHQuY2xvc2VQYXRoKCl9LGNvbXBsZXhpdHk6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wb2ludHMubGVuZ3RofX0pLGUuUG9seWdvbi5BVFRSSUJVVEVfTkFNRVM9ZS5TSEFSRURfQVRUUklCVVRFUy5jb25jYXQoKSxlLlBvbHlnb24uZnJvbUVsZW1lbnQ9ZnVuY3Rpb24odCxyKXtpZighdClyZXR1cm4gbnVsbDtyfHwocj17fSk7dmFyIHM9ZS5wYXJzZVBvaW50c0F0dHJpYnV0ZSh0LmdldEF0dHJpYnV0ZShcInBvaW50c1wiKSksbj1lLnBhcnNlQXR0cmlidXRlcyh0LGUuUG9seWdvbi5BVFRSSUJVVEVfTkFNRVMpO3JldHVybiBuZXcgZS5Qb2x5Z29uKHMsaShuLHIpKX0sdm9pZChlLlBvbHlnb24uZnJvbU9iamVjdD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUuUG9seWdvbih0LnBvaW50cyx0LCEwKX0pKX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPWUudXRpbC5hcnJheS5taW4scj1lLnV0aWwuYXJyYXkubWF4LHM9ZS51dGlsLm9iamVjdC5leHRlbmQsbj1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLG89ZS51dGlsLmRyYXdBcmMsYT17bToyLGw6MixoOjEsdjoxLGM6NixzOjQscTo0LHQ6MixhOjd9LGg9e206XCJsXCIsTTpcIkxcIn07cmV0dXJuIGUuUGF0aD92b2lkIGUud2FybihcImZhYnJpYy5QYXRoIGlzIGFscmVhZHkgZGVmaW5lZFwiKTooZS5QYXRoPWUudXRpbC5jcmVhdGVDbGFzcyhlLk9iamVjdCx7dHlwZTpcInBhdGhcIixwYXRoOm51bGwsbWluWDowLG1pblk6MCxpbml0aWFsaXplOmZ1bmN0aW9uKHQsZSl7aWYoZT1lfHx7fSx0aGlzLnNldE9wdGlvbnMoZSksIXQpdGhyb3cgbmV3IEVycm9yKFwiYHBhdGhgIGFyZ3VtZW50IGlzIHJlcXVpcmVkXCIpO3ZhciBpPVwiW29iamVjdCBBcnJheV1cIj09PW4uY2FsbCh0KTt0aGlzLnBhdGg9aT90OnQubWF0Y2gmJnQubWF0Y2goL1ttemxodmNzcXRhXVtebXpsaHZjc3F0YV0qL2dpKSx0aGlzLnBhdGgmJihpfHwodGhpcy5wYXRoPXRoaXMuX3BhcnNlUGF0aCgpKSx0aGlzLl9zZXRQb3NpdGlvbkRpbWVuc2lvbnMoZSksZS5zb3VyY2VQYXRoJiZ0aGlzLnNldFNvdXJjZVBhdGgoZS5zb3VyY2VQYXRoKSl9LF9zZXRQb3NpdGlvbkRpbWVuc2lvbnM6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fcGFyc2VEaW1lbnNpb25zKCk7dGhpcy5taW5YPWUubGVmdCx0aGlzLm1pblk9ZS50b3AsdGhpcy53aWR0aD1lLndpZHRoLHRoaXMuaGVpZ2h0PWUuaGVpZ2h0LFwidW5kZWZpbmVkXCI9PXR5cGVvZiB0LmxlZnQmJih0aGlzLmxlZnQ9ZS5sZWZ0KyhcImNlbnRlclwiPT09dGhpcy5vcmlnaW5YP3RoaXMud2lkdGgvMjpcInJpZ2h0XCI9PT10aGlzLm9yaWdpblg/dGhpcy53aWR0aDowKSksXCJ1bmRlZmluZWRcIj09dHlwZW9mIHQudG9wJiYodGhpcy50b3A9ZS50b3ArKFwiY2VudGVyXCI9PT10aGlzLm9yaWdpblk/dGhpcy5oZWlnaHQvMjpcImJvdHRvbVwiPT09dGhpcy5vcmlnaW5ZP3RoaXMuaGVpZ2h0OjApKSx0aGlzLnBhdGhPZmZzZXQ9dGhpcy5wYXRoT2Zmc2V0fHx7eDp0aGlzLm1pblgrdGhpcy53aWR0aC8yLHk6dGhpcy5taW5ZK3RoaXMuaGVpZ2h0LzJ9fSxfcmVuZGVyOmZ1bmN0aW9uKHQpe3ZhciBlLGkscixzPW51bGwsbj0wLGE9MCxoPTAsYz0wLGw9MCx1PTAsZj0tdGhpcy5wYXRoT2Zmc2V0LngsZD0tdGhpcy5wYXRoT2Zmc2V0Lnk7dGhpcy5ncm91cCYmXCJwYXRoLWdyb3VwXCI9PT10aGlzLmdyb3VwLnR5cGUmJihmPTAsZD0wKSx0LmJlZ2luUGF0aCgpO2Zvcih2YXIgZz0wLHA9dGhpcy5wYXRoLmxlbmd0aDtwPmc7KytnKXtzd2l0Y2goZT10aGlzLnBhdGhbZ10sZVswXSl7Y2FzZVwibFwiOmgrPWVbMV0sYys9ZVsyXSx0LmxpbmVUbyhoK2YsYytkKTticmVhaztjYXNlXCJMXCI6aD1lWzFdLGM9ZVsyXSx0LmxpbmVUbyhoK2YsYytkKTticmVhaztjYXNlXCJoXCI6aCs9ZVsxXSx0LmxpbmVUbyhoK2YsYytkKTticmVhaztjYXNlXCJIXCI6aD1lWzFdLHQubGluZVRvKGgrZixjK2QpO2JyZWFrO2Nhc2VcInZcIjpjKz1lWzFdLHQubGluZVRvKGgrZixjK2QpO2JyZWFrO2Nhc2VcIlZcIjpjPWVbMV0sdC5saW5lVG8oaCtmLGMrZCk7YnJlYWs7Y2FzZVwibVwiOmgrPWVbMV0sYys9ZVsyXSxuPWgsYT1jLHQubW92ZVRvKGgrZixjK2QpO2JyZWFrO2Nhc2VcIk1cIjpoPWVbMV0sYz1lWzJdLG49aCxhPWMsdC5tb3ZlVG8oaCtmLGMrZCk7YnJlYWs7Y2FzZVwiY1wiOmk9aCtlWzVdLHI9YytlWzZdLGw9aCtlWzNdLHU9YytlWzRdLHQuYmV6aWVyQ3VydmVUbyhoK2VbMV0rZixjK2VbMl0rZCxsK2YsdStkLGkrZixyK2QpLGg9aSxjPXI7YnJlYWs7Y2FzZVwiQ1wiOmg9ZVs1XSxjPWVbNl0sbD1lWzNdLHU9ZVs0XSx0LmJlemllckN1cnZlVG8oZVsxXStmLGVbMl0rZCxsK2YsdStkLGgrZixjK2QpO2JyZWFrO2Nhc2VcInNcIjppPWgrZVszXSxyPWMrZVs0XSxudWxsPT09c1swXS5tYXRjaCgvW0NjU3NdLyk/KGw9aCx1PWMpOihsPTIqaC1sLHU9MipjLXUpLHQuYmV6aWVyQ3VydmVUbyhsK2YsdStkLGgrZVsxXStmLGMrZVsyXStkLGkrZixyK2QpLGw9aCtlWzFdLHU9YytlWzJdLGg9aSxjPXI7YnJlYWs7Y2FzZVwiU1wiOmk9ZVszXSxyPWVbNF0sbnVsbD09PXNbMF0ubWF0Y2goL1tDY1NzXS8pPyhsPWgsdT1jKToobD0yKmgtbCx1PTIqYy11KSx0LmJlemllckN1cnZlVG8obCtmLHUrZCxlWzFdK2YsZVsyXStkLGkrZixyK2QpLGg9aSxjPXIsbD1lWzFdLHU9ZVsyXTticmVhaztjYXNlXCJxXCI6aT1oK2VbM10scj1jK2VbNF0sbD1oK2VbMV0sdT1jK2VbMl0sdC5xdWFkcmF0aWNDdXJ2ZVRvKGwrZix1K2QsaStmLHIrZCksaD1pLGM9cjticmVhaztjYXNlXCJRXCI6aT1lWzNdLHI9ZVs0XSx0LnF1YWRyYXRpY0N1cnZlVG8oZVsxXStmLGVbMl0rZCxpK2YscitkKSxoPWksYz1yLGw9ZVsxXSx1PWVbMl07YnJlYWs7Y2FzZVwidFwiOmk9aCtlWzFdLHI9YytlWzJdLG51bGw9PT1zWzBdLm1hdGNoKC9bUXFUdF0vKT8obD1oLHU9Yyk6KGw9MipoLWwsdT0yKmMtdSksdC5xdWFkcmF0aWNDdXJ2ZVRvKGwrZix1K2QsaStmLHIrZCksaD1pLGM9cjticmVhaztjYXNlXCJUXCI6aT1lWzFdLHI9ZVsyXSxudWxsPT09c1swXS5tYXRjaCgvW1FxVHRdLyk/KGw9aCx1PWMpOihsPTIqaC1sLHU9MipjLXUpLHQucXVhZHJhdGljQ3VydmVUbyhsK2YsdStkLGkrZixyK2QpLGg9aSxjPXI7YnJlYWs7Y2FzZVwiYVwiOm8odCxoK2YsYytkLFtlWzFdLGVbMl0sZVszXSxlWzRdLGVbNV0sZVs2XStoK2YsZVs3XStjK2RdKSxoKz1lWzZdLGMrPWVbN107YnJlYWs7Y2FzZVwiQVwiOm8odCxoK2YsYytkLFtlWzFdLGVbMl0sZVszXSxlWzRdLGVbNV0sZVs2XStmLGVbN10rZF0pLGg9ZVs2XSxjPWVbN107YnJlYWs7Y2FzZVwielwiOmNhc2VcIlpcIjpoPW4sYz1hLHQuY2xvc2VQYXRoKCl9cz1lfXRoaXMuX3JlbmRlckZpbGwodCksdGhpcy5fcmVuZGVyU3Ryb2tlKHQpfSx0b1N0cmluZzpmdW5jdGlvbigpe3JldHVyblwiIzxmYWJyaWMuUGF0aCAoXCIrdGhpcy5jb21wbGV4aXR5KCkrJyk6IHsgXCJ0b3BcIjogJyt0aGlzLnRvcCsnLCBcImxlZnRcIjogJyt0aGlzLmxlZnQrXCIgfT5cIn0sdG9PYmplY3Q6ZnVuY3Rpb24odCl7dmFyIGU9cyh0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIsdCkse3BhdGg6dGhpcy5wYXRoLm1hcChmdW5jdGlvbih0KXtyZXR1cm4gdC5zbGljZSgpfSkscGF0aE9mZnNldDp0aGlzLnBhdGhPZmZzZXR9KTtyZXR1cm4gdGhpcy5zb3VyY2VQYXRoJiYoZS5zb3VyY2VQYXRoPXRoaXMuc291cmNlUGF0aCksdGhpcy50cmFuc2Zvcm1NYXRyaXgmJihlLnRyYW5zZm9ybU1hdHJpeD10aGlzLnRyYW5zZm9ybU1hdHJpeCksZX0sdG9EYXRhbGVzc09iamVjdDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLnRvT2JqZWN0KHQpO3JldHVybiB0aGlzLnNvdXJjZVBhdGgmJihlLnBhdGg9dGhpcy5zb3VyY2VQYXRoKSxkZWxldGUgZS5zb3VyY2VQYXRoLGV9LHRvU1ZHOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT1bXSxpPXRoaXMuX2NyZWF0ZUJhc2VTVkdNYXJrdXAoKSxyPVwiXCIscz0wLG49dGhpcy5wYXRoLmxlbmd0aDtuPnM7cysrKWUucHVzaCh0aGlzLnBhdGhbc10uam9pbihcIiBcIikpO3ZhciBvPWUuam9pbihcIiBcIik7cmV0dXJuIHRoaXMuZ3JvdXAmJlwicGF0aC1ncm91cFwiPT09dGhpcy5ncm91cC50eXBlfHwocj1cIiB0cmFuc2xhdGUoXCIrLXRoaXMucGF0aE9mZnNldC54K1wiLCBcIistdGhpcy5wYXRoT2Zmc2V0LnkrXCIpIFwiKSxpLnB1c2goXCI8cGF0aCBcIiwnZD1cIicsbywnXCIgc3R5bGU9XCInLHRoaXMuZ2V0U3ZnU3R5bGVzKCksJ1wiIHRyYW5zZm9ybT1cIicsdGhpcy5nZXRTdmdUcmFuc2Zvcm0oKSxyLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtTWF0cml4KCksJ1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiAnLFwiLz5cXG5cIiksdD90KGkuam9pbihcIlwiKSk6aS5qb2luKFwiXCIpfSxjb21wbGV4aXR5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGF0aC5sZW5ndGh9LF9wYXJzZVBhdGg6ZnVuY3Rpb24oKXtmb3IodmFyIHQsZSxpLHIscyxuPVtdLG89W10sYz0vKFstK10/KChcXGQrXFwuXFxkKyl8KChcXGQrKXwoXFwuXFxkKykpKSg/OmVbLStdP1xcZCspPykvZ2ksbD0wLHU9dGhpcy5wYXRoLmxlbmd0aDt1Pmw7bCsrKXtmb3IodD10aGlzLnBhdGhbbF0scj10LnNsaWNlKDEpLnRyaW0oKSxvLmxlbmd0aD0wO2k9Yy5leGVjKHIpOylvLnB1c2goaVswXSk7cz1bdC5jaGFyQXQoMCldO2Zvcih2YXIgZj0wLGQ9by5sZW5ndGg7ZD5mO2YrKyllPXBhcnNlRmxvYXQob1tmXSksaXNOYU4oZSl8fHMucHVzaChlKTt2YXIgZz1zWzBdLHA9YVtnLnRvTG93ZXJDYXNlKCldLHY9aFtnXXx8ZztpZihzLmxlbmd0aC0xPnApZm9yKHZhciBiPTEsbT1zLmxlbmd0aDttPmI7Yis9cCluLnB1c2goW2ddLmNvbmNhdChzLnNsaWNlKGIsYitwKSkpLGc9djtlbHNlIG4ucHVzaChzKX1yZXR1cm4gbn0sX3BhcnNlRGltZW5zaW9uczpmdW5jdGlvbigpe2Zvcih2YXIgdCxzLG4sbyxhPVtdLGg9W10sYz1udWxsLGw9MCx1PTAsZj0wLGQ9MCxnPTAscD0wLHY9MCxiPXRoaXMucGF0aC5sZW5ndGg7Yj52Oysrdil7c3dpdGNoKHQ9dGhpcy5wYXRoW3ZdLHRbMF0pe2Nhc2VcImxcIjpmKz10WzFdLGQrPXRbMl0sbz1bXTticmVhaztjYXNlXCJMXCI6Zj10WzFdLGQ9dFsyXSxvPVtdO2JyZWFrO2Nhc2VcImhcIjpmKz10WzFdLG89W107YnJlYWs7Y2FzZVwiSFwiOmY9dFsxXSxvPVtdO2JyZWFrO2Nhc2VcInZcIjpkKz10WzFdLG89W107YnJlYWs7Y2FzZVwiVlwiOmQ9dFsxXSxvPVtdO2JyZWFrO2Nhc2VcIm1cIjpmKz10WzFdLGQrPXRbMl0sbD1mLHU9ZCxvPVtdO2JyZWFrO2Nhc2VcIk1cIjpmPXRbMV0sZD10WzJdLGw9Zix1PWQsbz1bXTticmVhaztjYXNlXCJjXCI6cz1mK3RbNV0sbj1kK3RbNl0sZz1mK3RbM10scD1kK3RbNF0sbz1lLnV0aWwuZ2V0Qm91bmRzT2ZDdXJ2ZShmLGQsZit0WzFdLGQrdFsyXSxnLHAscyxuKSxmPXMsZD1uO2JyZWFrO2Nhc2VcIkNcIjpmPXRbNV0sZD10WzZdLGc9dFszXSxwPXRbNF0sbz1lLnV0aWwuZ2V0Qm91bmRzT2ZDdXJ2ZShmLGQsdFsxXSx0WzJdLGcscCxmLGQpO2JyZWFrO2Nhc2VcInNcIjpzPWYrdFszXSxuPWQrdFs0XSxudWxsPT09Y1swXS5tYXRjaCgvW0NjU3NdLyk/KGc9ZixwPWQpOihnPTIqZi1nLHA9MipkLXApLG89ZS51dGlsLmdldEJvdW5kc09mQ3VydmUoZixkLGcscCxmK3RbMV0sZCt0WzJdLHMsbiksZz1mK3RbMV0scD1kK3RbMl0sZj1zLGQ9bjticmVhaztjYXNlXCJTXCI6cz10WzNdLG49dFs0XSxudWxsPT09Y1swXS5tYXRjaCgvW0NjU3NdLyk/KGc9ZixwPWQpOihnPTIqZi1nLHA9MipkLXApLG89ZS51dGlsLmdldEJvdW5kc09mQ3VydmUoZixkLGcscCx0WzFdLHRbMl0scyxuKSxmPXMsZD1uLGc9dFsxXSxwPXRbMl07YnJlYWs7Y2FzZVwicVwiOnM9Zit0WzNdLG49ZCt0WzRdLGc9Zit0WzFdLHA9ZCt0WzJdLG89ZS51dGlsLmdldEJvdW5kc09mQ3VydmUoZixkLGcscCxnLHAscyxuKSxmPXMsZD1uO2JyZWFrO2Nhc2VcIlFcIjpnPXRbMV0scD10WzJdLG89ZS51dGlsLmdldEJvdW5kc09mQ3VydmUoZixkLGcscCxnLHAsdFszXSx0WzRdKSxmPXRbM10sZD10WzRdO2JyZWFrO2Nhc2VcInRcIjpzPWYrdFsxXSxuPWQrdFsyXSxudWxsPT09Y1swXS5tYXRjaCgvW1FxVHRdLyk/KGc9ZixwPWQpOihnPTIqZi1nLHA9MipkLXApLG89ZS51dGlsLmdldEJvdW5kc09mQ3VydmUoZixkLGcscCxnLHAscyxuKSxmPXMsZD1uO2JyZWFrO2Nhc2VcIlRcIjpzPXRbMV0sbj10WzJdLG51bGw9PT1jWzBdLm1hdGNoKC9bUXFUdF0vKT8oZz1mLHA9ZCk6KGc9MipmLWcscD0yKmQtcCksbz1lLnV0aWwuZ2V0Qm91bmRzT2ZDdXJ2ZShmLGQsZyxwLGcscCxzLG4pLGY9cyxkPW47YnJlYWs7Y2FzZVwiYVwiOm89ZS51dGlsLmdldEJvdW5kc09mQXJjKGYsZCx0WzFdLHRbMl0sdFszXSx0WzRdLHRbNV0sdFs2XStmLHRbN10rZCksZis9dFs2XSxkKz10WzddO2JyZWFrO2Nhc2VcIkFcIjpvPWUudXRpbC5nZXRCb3VuZHNPZkFyYyhmLGQsdFsxXSx0WzJdLHRbM10sdFs0XSx0WzVdLHRbNl0sdFs3XSksZj10WzZdLGQ9dFs3XTticmVhaztjYXNlXCJ6XCI6Y2FzZVwiWlwiOmY9bCxkPXV9Yz10LG8uZm9yRWFjaChmdW5jdGlvbih0KXthLnB1c2godC54KSxoLnB1c2godC55KX0pLGEucHVzaChmKSxoLnB1c2goZCl9dmFyIG09aShhKSx5PWkoaCksXz1yKGEpLHg9cihoKSxDPV8tbSxTPXgteSx3PXtsZWZ0Om0sdG9wOnksd2lkdGg6QyxoZWlnaHQ6U307cmV0dXJuIHd9fSksZS5QYXRoLmZyb21PYmplY3Q9ZnVuY3Rpb24odCxpKXtcInN0cmluZ1wiPT10eXBlb2YgdC5wYXRoP2UubG9hZFNWR0Zyb21VUkwodC5wYXRoLGZ1bmN0aW9uKHIpe3ZhciBzPXJbMF0sbj10LnBhdGg7ZGVsZXRlIHQucGF0aCxlLnV0aWwub2JqZWN0LmV4dGVuZChzLHQpLHMuc2V0U291cmNlUGF0aChuKSxpKHMpfSk6aShuZXcgZS5QYXRoKHQucGF0aCx0KSl9LGUuUGF0aC5BVFRSSUJVVEVfTkFNRVM9ZS5TSEFSRURfQVRUUklCVVRFUy5jb25jYXQoW1wiZFwiXSksZS5QYXRoLmZyb21FbGVtZW50PWZ1bmN0aW9uKHQsaSxyKXt2YXIgbj1lLnBhcnNlQXR0cmlidXRlcyh0LGUuUGF0aC5BVFRSSUJVVEVfTkFNRVMpO2kmJmkobmV3IGUuUGF0aChuLmQscyhuLHIpKSl9LHZvaWQoZS5QYXRoLmFzeW5jPSEwKSl9KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSksaT1lLnV0aWwub2JqZWN0LmV4dGVuZCxyPWUudXRpbC5hcnJheS5pbnZva2Uscz1lLk9iamVjdC5wcm90b3R5cGUudG9PYmplY3Q7cmV0dXJuIGUuUGF0aEdyb3VwP3ZvaWQgZS53YXJuKFwiZmFicmljLlBhdGhHcm91cCBpcyBhbHJlYWR5IGRlZmluZWRcIik6KGUuUGF0aEdyb3VwPWUudXRpbC5jcmVhdGVDbGFzcyhlLlBhdGgse3R5cGU6XCJwYXRoLWdyb3VwXCIsZmlsbDpcIlwiLGluaXRpYWxpemU6ZnVuY3Rpb24odCxlKXtlPWV8fHt9LHRoaXMucGF0aHM9dHx8W107Zm9yKHZhciBpPXRoaXMucGF0aHMubGVuZ3RoO2ktLTspdGhpcy5wYXRoc1tpXS5ncm91cD10aGlzO2UudG9CZVBhcnNlZCYmKHRoaXMucGFyc2VEaW1lbnNpb25zRnJvbVBhdGhzKGUpLGRlbGV0ZSBlLnRvQmVQYXJzZWQpLHRoaXMuc2V0T3B0aW9ucyhlKSx0aGlzLnNldENvb3JkcygpLGUuc291cmNlUGF0aCYmdGhpcy5zZXRTb3VyY2VQYXRoKGUuc291cmNlUGF0aCl9LHBhcnNlRGltZW5zaW9uc0Zyb21QYXRoczpmdW5jdGlvbih0KXtmb3IodmFyIGkscixzLG4sbyxhPVtdLGg9W10sYz10aGlzLnRyYW5zZm9ybU1hdHJpeCxsPXRoaXMucGF0aHMubGVuZ3RoO2wtLTspe3M9dGhpcy5wYXRoc1tsXSxuPXMuaGVpZ2h0K3Muc3Ryb2tlV2lkdGgsbz1zLndpZHRoK3Muc3Ryb2tlV2lkdGgsaT1be3g6cy5sZWZ0LHk6cy50b3B9LHt4OnMubGVmdCtvLHk6cy50b3B9LHt4OnMubGVmdCx5OnMudG9wK259LHt4OnMubGVmdCtvLHk6cy50b3Arbn1dO2Zvcih2YXIgdT0wO3U8aS5sZW5ndGg7dSsrKXI9aVt1XSxjJiYocj1lLnV0aWwudHJhbnNmb3JtUG9pbnQocixjLCExKSksYS5wdXNoKHIueCksaC5wdXNoKHIueSl9dC53aWR0aD1NYXRoLm1heC5hcHBseShudWxsLGEpLHQuaGVpZ2h0PU1hdGgubWF4LmFwcGx5KG51bGwsaCl9LHJlbmRlcjpmdW5jdGlvbih0KXtpZih0aGlzLnZpc2libGUpe3Quc2F2ZSgpLHRoaXMudHJhbnNmb3JtTWF0cml4JiZ0LnRyYW5zZm9ybS5hcHBseSh0LHRoaXMudHJhbnNmb3JtTWF0cml4KSx0aGlzLnRyYW5zZm9ybSh0KSx0aGlzLl9zZXRTaGFkb3codCksdGhpcy5jbGlwVG8mJmUudXRpbC5jbGlwQ29udGV4dCh0aGlzLHQpLHQudHJhbnNsYXRlKC10aGlzLndpZHRoLzIsLXRoaXMuaGVpZ2h0LzIpO2Zvcih2YXIgaT0wLHI9dGhpcy5wYXRocy5sZW5ndGg7cj5pOysraSl0aGlzLnBhdGhzW2ldLnJlbmRlcih0LCEwKTt0aGlzLmNsaXBUbyYmdC5yZXN0b3JlKCksdC5yZXN0b3JlKCl9fSxfc2V0OmZ1bmN0aW9uKHQsZSl7aWYoXCJmaWxsXCI9PT10JiZlJiZ0aGlzLmlzU2FtZUNvbG9yKCkpZm9yKHZhciBpPXRoaXMucGF0aHMubGVuZ3RoO2ktLTspdGhpcy5wYXRoc1tpXS5fc2V0KHQsZSk7cmV0dXJuIHRoaXMuY2FsbFN1cGVyKFwiX3NldFwiLHQsZSl9LHRvT2JqZWN0OmZ1bmN0aW9uKHQpe3ZhciBlPWkocy5jYWxsKHRoaXMsdCkse3BhdGhzOnIodGhpcy5nZXRPYmplY3RzKCksXCJ0b09iamVjdFwiLHQpfSk7cmV0dXJuIHRoaXMuc291cmNlUGF0aCYmKGUuc291cmNlUGF0aD10aGlzLnNvdXJjZVBhdGgpLGV9LHRvRGF0YWxlc3NPYmplY3Q6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy50b09iamVjdCh0KTtyZXR1cm4gdGhpcy5zb3VyY2VQYXRoJiYoZS5wYXRocz10aGlzLnNvdXJjZVBhdGgpLGV9LHRvU1ZHOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10aGlzLmdldE9iamVjdHMoKSxpPXRoaXMuZ2V0UG9pbnRCeU9yaWdpbihcImxlZnRcIixcInRvcFwiKSxyPVwidHJhbnNsYXRlKFwiK2kueCtcIiBcIitpLnkrXCIpXCIscz1bXCI8ZyBcIiwnc3R5bGU9XCInLHRoaXMuZ2V0U3ZnU3R5bGVzKCksJ1wiICcsJ3RyYW5zZm9ybT1cIicsdGhpcy5nZXRTdmdUcmFuc2Zvcm1NYXRyaXgoKSxyLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtKCksJ1wiICcsXCI+XFxuXCJdLG49MCxvPWUubGVuZ3RoO28+bjtuKyspcy5wdXNoKGVbbl0udG9TVkcodCkpO3JldHVybiBzLnB1c2goXCI8L2c+XFxuXCIpLHQ/dChzLmpvaW4oXCJcIikpOnMuam9pbihcIlwiKX0sdG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm5cIiM8ZmFicmljLlBhdGhHcm91cCAoXCIrdGhpcy5jb21wbGV4aXR5KCkrXCIpOiB7IHRvcDogXCIrdGhpcy50b3ArXCIsIGxlZnQ6IFwiK3RoaXMubGVmdCtcIiB9PlwifSxpc1NhbWVDb2xvcjpmdW5jdGlvbigpe3ZhciB0PSh0aGlzLmdldE9iamVjdHMoKVswXS5nZXQoXCJmaWxsXCIpfHxcIlwiKS50b0xvd2VyQ2FzZSgpO3JldHVybiB0aGlzLmdldE9iamVjdHMoKS5ldmVyeShmdW5jdGlvbihlKXtyZXR1cm4oZS5nZXQoXCJmaWxsXCIpfHxcIlwiKS50b0xvd2VyQ2FzZSgpPT09dH0pfSxjb21wbGV4aXR5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGF0aHMucmVkdWNlKGZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQrKGUmJmUuY29tcGxleGl0eT9lLmNvbXBsZXhpdHkoKTowKX0sMCl9LGdldE9iamVjdHM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wYXRoc319KSxlLlBhdGhHcm91cC5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQsaSl7XCJzdHJpbmdcIj09dHlwZW9mIHQucGF0aHM/ZS5sb2FkU1ZHRnJvbVVSTCh0LnBhdGhzLGZ1bmN0aW9uKHIpe3ZhciBzPXQucGF0aHM7ZGVsZXRlIHQucGF0aHM7dmFyIG49ZS51dGlsLmdyb3VwU1ZHRWxlbWVudHMocix0LHMpO2kobil9KTplLnV0aWwuZW5saXZlbk9iamVjdHModC5wYXRocyxmdW5jdGlvbihyKXtkZWxldGUgdC5wYXRocyxpKG5ldyBlLlBhdGhHcm91cChyLHQpKX0pfSx2b2lkKGUuUGF0aEdyb3VwLmFzeW5jPSEwKSl9KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSksaT1lLnV0aWwub2JqZWN0LmV4dGVuZCxyPWUudXRpbC5hcnJheS5taW4scz1lLnV0aWwuYXJyYXkubWF4LG49ZS51dGlsLmFycmF5Lmludm9rZTtpZighZS5Hcm91cCl7dmFyIG89e2xvY2tNb3ZlbWVudFg6ITAsbG9ja01vdmVtZW50WTohMCxsb2NrUm90YXRpb246ITAsbG9ja1NjYWxpbmdYOiEwLGxvY2tTY2FsaW5nWTohMCxsb2NrVW5pU2NhbGluZzohMH07ZS5Hcm91cD1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5PYmplY3QsZS5Db2xsZWN0aW9uLHt0eXBlOlwiZ3JvdXBcIixzdHJva2VXaWR0aDowLGluaXRpYWxpemU6ZnVuY3Rpb24odCxlKXtlPWV8fHt9LHRoaXMuX29iamVjdHM9dHx8W107Zm9yKHZhciBpPXRoaXMuX29iamVjdHMubGVuZ3RoO2ktLTspdGhpcy5fb2JqZWN0c1tpXS5ncm91cD10aGlzO3RoaXMub3JpZ2luYWxTdGF0ZT17fSxlLm9yaWdpblgmJih0aGlzLm9yaWdpblg9ZS5vcmlnaW5YKSxlLm9yaWdpblkmJih0aGlzLm9yaWdpblk9ZS5vcmlnaW5ZKSx0aGlzLl9jYWxjQm91bmRzKCksdGhpcy5fdXBkYXRlT2JqZWN0c0Nvb3JkcygpLHRoaXMuY2FsbFN1cGVyKFwiaW5pdGlhbGl6ZVwiLGUpLHRoaXMuc2V0Q29vcmRzKCksdGhpcy5zYXZlQ29vcmRzKCl9LF91cGRhdGVPYmplY3RzQ29vcmRzOmZ1bmN0aW9uKCl7dGhpcy5mb3JFYWNoT2JqZWN0KHRoaXMuX3VwZGF0ZU9iamVjdENvb3Jkcyx0aGlzKX0sX3VwZGF0ZU9iamVjdENvb3JkczpmdW5jdGlvbih0KXt2YXIgZT10LmdldExlZnQoKSxpPXQuZ2V0VG9wKCkscj10aGlzLmdldENlbnRlclBvaW50KCk7dC5zZXQoe29yaWdpbmFsTGVmdDplLG9yaWdpbmFsVG9wOmksbGVmdDplLXIueCx0b3A6aS1yLnl9KSx0LnNldENvb3JkcygpLHQuX19vcmlnSGFzQ29udHJvbHM9dC5oYXNDb250cm9scyx0Lmhhc0NvbnRyb2xzPSExfSx0b1N0cmluZzpmdW5jdGlvbigpe3JldHVyblwiIzxmYWJyaWMuR3JvdXA6IChcIit0aGlzLmNvbXBsZXhpdHkoKStcIik+XCJ9LGFkZFdpdGhVcGRhdGU6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX3Jlc3RvcmVPYmplY3RzU3RhdGUoKSx0JiYodGhpcy5fb2JqZWN0cy5wdXNoKHQpLHQuZ3JvdXA9dGhpcyx0Ll9zZXQoXCJjYW52YXNcIix0aGlzLmNhbnZhcykpLHRoaXMuZm9yRWFjaE9iamVjdCh0aGlzLl9zZXRPYmplY3RBY3RpdmUsdGhpcyksdGhpcy5fY2FsY0JvdW5kcygpLHRoaXMuX3VwZGF0ZU9iamVjdHNDb29yZHMoKSx0aGlzfSxfc2V0T2JqZWN0QWN0aXZlOmZ1bmN0aW9uKHQpe3Quc2V0KFwiYWN0aXZlXCIsITApLHQuZ3JvdXA9dGhpc30scmVtb3ZlV2l0aFVwZGF0ZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fbW92ZUZsaXBwZWRPYmplY3QodCksdGhpcy5fcmVzdG9yZU9iamVjdHNTdGF0ZSgpLHRoaXMuZm9yRWFjaE9iamVjdCh0aGlzLl9zZXRPYmplY3RBY3RpdmUsdGhpcyksdGhpcy5yZW1vdmUodCksdGhpcy5fY2FsY0JvdW5kcygpLHRoaXMuX3VwZGF0ZU9iamVjdHNDb29yZHMoKSx0aGlzfSxfb25PYmplY3RBZGRlZDpmdW5jdGlvbih0KXt0Lmdyb3VwPXRoaXMsdC5fc2V0KFwiY2FudmFzXCIsdGhpcy5jYW52YXMpfSxfb25PYmplY3RSZW1vdmVkOmZ1bmN0aW9uKHQpe2RlbGV0ZSB0Lmdyb3VwLHQuc2V0KFwiYWN0aXZlXCIsITEpfSxkZWxlZ2F0ZWRQcm9wZXJ0aWVzOntmaWxsOiEwLG9wYWNpdHk6ITAsZm9udEZhbWlseTohMCxmb250V2VpZ2h0OiEwLGZvbnRTaXplOiEwLGZvbnRTdHlsZTohMCxsaW5lSGVpZ2h0OiEwLHRleHREZWNvcmF0aW9uOiEwLHRleHRBbGlnbjohMCxiYWNrZ3JvdW5kQ29sb3I6ITB9LF9zZXQ6ZnVuY3Rpb24odCxlKXtpZih0IGluIHRoaXMuZGVsZWdhdGVkUHJvcGVydGllc3x8XCJjYW52YXNcIj09PXQpZm9yKHZhciBpPXRoaXMuX29iamVjdHMubGVuZ3RoO2ktLTspdGhpcy5fb2JqZWN0c1tpXS5zZXQodCxlKTt0aGlzLmNhbGxTdXBlcihcIl9zZXRcIix0LGUpfSx0b09iamVjdDpmdW5jdGlvbih0KXtyZXR1cm4gaSh0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIsdCkse29iamVjdHM6bih0aGlzLl9vYmplY3RzLFwidG9PYmplY3RcIix0KX0pfSxyZW5kZXI6ZnVuY3Rpb24odCl7aWYodGhpcy52aXNpYmxlKXt0LnNhdmUoKSx0aGlzLnRyYW5zZm9ybU1hdHJpeCYmdC50cmFuc2Zvcm0uYXBwbHkodCx0aGlzLnRyYW5zZm9ybU1hdHJpeCksdGhpcy50cmFuc2Zvcm0odCksdGhpcy5jbGlwVG8mJmUudXRpbC5jbGlwQ29udGV4dCh0aGlzLHQpO2Zvcih2YXIgaT0wLHI9dGhpcy5fb2JqZWN0cy5sZW5ndGg7cj5pO2krKyl0aGlzLl9yZW5kZXJPYmplY3QodGhpcy5fb2JqZWN0c1tpXSx0KTt0aGlzLmNsaXBUbyYmdC5yZXN0b3JlKCksdC5yZXN0b3JlKCl9fSxfcmVuZGVyQ29udHJvbHM6ZnVuY3Rpb24odCxlKXt0aGlzLmNhbGxTdXBlcihcIl9yZW5kZXJDb250cm9sc1wiLHQsZSk7Zm9yKHZhciBpPTAscj10aGlzLl9vYmplY3RzLmxlbmd0aDtyPmk7aSsrKXRoaXMuX29iamVjdHNbaV0uX3JlbmRlckNvbnRyb2xzKHQpfSxfcmVuZGVyT2JqZWN0OmZ1bmN0aW9uKHQsZSl7aWYodC52aXNpYmxlKXt2YXIgaT10Lmhhc1JvdGF0aW5nUG9pbnQ7dC5oYXNSb3RhdGluZ1BvaW50PSExLHQucmVuZGVyKGUpLHQuaGFzUm90YXRpbmdQb2ludD1pfX0sX3Jlc3RvcmVPYmplY3RzU3RhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb2JqZWN0cy5mb3JFYWNoKHRoaXMuX3Jlc3RvcmVPYmplY3RTdGF0ZSx0aGlzKSx0aGlzfSxyZWFsaXplVHJhbnNmb3JtOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9tb3ZlRmxpcHBlZE9iamVjdCh0KSx0aGlzLl9zZXRPYmplY3RQb3NpdGlvbih0KSx0fSxfbW92ZUZsaXBwZWRPYmplY3Q6ZnVuY3Rpb24odCl7dmFyIGU9dC5nZXQoXCJvcmlnaW5YXCIpLGk9dC5nZXQoXCJvcmlnaW5ZXCIpLHI9dC5nZXRDZW50ZXJQb2ludCgpO3Quc2V0KHtvcmlnaW5YOlwiY2VudGVyXCIsb3JpZ2luWTpcImNlbnRlclwiLGxlZnQ6ci54LHRvcDpyLnl9KSx0aGlzLl90b2dnbGVGbGlwcGluZyh0KTt2YXIgcz10LmdldFBvaW50QnlPcmlnaW4oZSxpKTtyZXR1cm4gdC5zZXQoe29yaWdpblg6ZSxvcmlnaW5ZOmksbGVmdDpzLngsdG9wOnMueX0pLHRoaXN9LF90b2dnbGVGbGlwcGluZzpmdW5jdGlvbih0KXt0aGlzLmZsaXBYJiYodC50b2dnbGUoXCJmbGlwWFwiKSx0LnNldChcImxlZnRcIiwtdC5nZXQoXCJsZWZ0XCIpKSx0LnNldEFuZ2xlKC10LmdldEFuZ2xlKCkpKSx0aGlzLmZsaXBZJiYodC50b2dnbGUoXCJmbGlwWVwiKSx0LnNldChcInRvcFwiLC10LmdldChcInRvcFwiKSksdC5zZXRBbmdsZSgtdC5nZXRBbmdsZSgpKSl9LF9yZXN0b3JlT2JqZWN0U3RhdGU6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX3NldE9iamVjdFBvc2l0aW9uKHQpLHQuc2V0Q29vcmRzKCksdC5oYXNDb250cm9scz10Ll9fb3JpZ0hhc0NvbnRyb2xzLGRlbGV0ZSB0Ll9fb3JpZ0hhc0NvbnRyb2xzLHQuc2V0KFwiYWN0aXZlXCIsITEpLHQuc2V0Q29vcmRzKCksZGVsZXRlIHQuZ3JvdXAsdGhpc30sX3NldE9iamVjdFBvc2l0aW9uOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0Q2VudGVyUG9pbnQoKSxpPXRoaXMuX2dldFJvdGF0ZWRMZWZ0VG9wKHQpO3Quc2V0KHthbmdsZTp0LmdldEFuZ2xlKCkrdGhpcy5nZXRBbmdsZSgpLGxlZnQ6ZS54K2kubGVmdCx0b3A6ZS55K2kudG9wLHNjYWxlWDp0LmdldChcInNjYWxlWFwiKSp0aGlzLmdldChcInNjYWxlWFwiKSxzY2FsZVk6dC5nZXQoXCJzY2FsZVlcIikqdGhpcy5nZXQoXCJzY2FsZVlcIil9KX0sX2dldFJvdGF0ZWRMZWZ0VG9wOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0QW5nbGUoKSooTWF0aC5QSS8xODApO3JldHVybntsZWZ0Oi1NYXRoLnNpbihlKSp0LmdldFRvcCgpKnRoaXMuZ2V0KFwic2NhbGVZXCIpK01hdGguY29zKGUpKnQuZ2V0TGVmdCgpKnRoaXMuZ2V0KFwic2NhbGVYXCIpLHRvcDpNYXRoLmNvcyhlKSp0LmdldFRvcCgpKnRoaXMuZ2V0KFwic2NhbGVZXCIpK01hdGguc2luKGUpKnQuZ2V0TGVmdCgpKnRoaXMuZ2V0KFwic2NhbGVYXCIpfX0sZGVzdHJveTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vYmplY3RzLmZvckVhY2godGhpcy5fbW92ZUZsaXBwZWRPYmplY3QsdGhpcyksdGhpcy5fcmVzdG9yZU9iamVjdHNTdGF0ZSgpfSxzYXZlQ29vcmRzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29yaWdpbmFsTGVmdD10aGlzLmdldChcImxlZnRcIiksdGhpcy5fb3JpZ2luYWxUb3A9dGhpcy5nZXQoXCJ0b3BcIiksdGhpc30saGFzTW92ZWQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb3JpZ2luYWxMZWZ0IT09dGhpcy5nZXQoXCJsZWZ0XCIpfHx0aGlzLl9vcmlnaW5hbFRvcCE9PXRoaXMuZ2V0KFwidG9wXCIpfSxzZXRPYmplY3RzQ29vcmRzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZm9yRWFjaE9iamVjdChmdW5jdGlvbih0KXt0LnNldENvb3JkcygpfSksdGhpc30sX2NhbGNCb3VuZHM6ZnVuY3Rpb24odCl7Zm9yKHZhciBlLGkscj1bXSxzPVtdLG49W1widHJcIixcImJyXCIsXCJibFwiLFwidGxcIl0sbz0wLGE9dGhpcy5fb2JqZWN0cy5sZW5ndGg7YT5vOysrbyl7ZT10aGlzLl9vYmplY3RzW29dLGUuc2V0Q29vcmRzKCk7Zm9yKHZhciBoPTA7aDxuLmxlbmd0aDtoKyspaT1uW2hdLHIucHVzaChlLm9Db29yZHNbaV0ueCkscy5wdXNoKGUub0Nvb3Jkc1tpXS55KX10aGlzLnNldCh0aGlzLl9nZXRCb3VuZHMocixzLHQpKX0sX2dldEJvdW5kczpmdW5jdGlvbih0LGksbil7dmFyIG89ZS51dGlsLmludmVydFRyYW5zZm9ybSh0aGlzLmdldFZpZXdwb3J0VHJhbnNmb3JtKCkpLGE9ZS51dGlsLnRyYW5zZm9ybVBvaW50KG5ldyBlLlBvaW50KHIodCkscihpKSksbyksaD1lLnV0aWwudHJhbnNmb3JtUG9pbnQobmV3IGUuUG9pbnQocyh0KSxzKGkpKSxvKSxjPXt3aWR0aDpoLngtYS54fHwwLGhlaWdodDpoLnktYS55fHwwfTtyZXR1cm4gbnx8KGMubGVmdD1hLnh8fDAsYy50b3A9YS55fHwwLFwiY2VudGVyXCI9PT10aGlzLm9yaWdpblgmJihjLmxlZnQrPWMud2lkdGgvMiksXCJyaWdodFwiPT09dGhpcy5vcmlnaW5YJiYoYy5sZWZ0Kz1jLndpZHRoKSxcImNlbnRlclwiPT09dGhpcy5vcmlnaW5ZJiYoYy50b3ArPWMuaGVpZ2h0LzIpLFwiYm90dG9tXCI9PT10aGlzLm9yaWdpblkmJihjLnRvcCs9Yy5oZWlnaHQpKSxjfSx0b1NWRzpmdW5jdGlvbih0KXtmb3IodmFyIGU9W1wiPGcgXCIsJ3RyYW5zZm9ybT1cIicsdGhpcy5nZXRTdmdUcmFuc2Zvcm0oKSwnXCI+XFxuJ10saT0wLHI9dGhpcy5fb2JqZWN0cy5sZW5ndGg7cj5pO2krKyllLnB1c2godGhpcy5fb2JqZWN0c1tpXS50b1NWRyh0KSk7cmV0dXJuIGUucHVzaChcIjwvZz5cXG5cIiksdD90KGUuam9pbihcIlwiKSk6ZS5qb2luKFwiXCIpfSxnZXQ6ZnVuY3Rpb24odCl7aWYodCBpbiBvKXtpZih0aGlzW3RdKXJldHVybiB0aGlzW3RdO2Zvcih2YXIgZT0wLGk9dGhpcy5fb2JqZWN0cy5sZW5ndGg7aT5lO2UrKylpZih0aGlzLl9vYmplY3RzW2VdW3RdKXJldHVybiEwO3JldHVybiExfXJldHVybiB0IGluIHRoaXMuZGVsZWdhdGVkUHJvcGVydGllcz90aGlzLl9vYmplY3RzWzBdJiZ0aGlzLl9vYmplY3RzWzBdLmdldCh0KTp0aGlzW3RdfX0pLGUuR3JvdXAuZnJvbU9iamVjdD1mdW5jdGlvbih0LGkpe2UudXRpbC5lbmxpdmVuT2JqZWN0cyh0Lm9iamVjdHMsZnVuY3Rpb24ocil7ZGVsZXRlIHQub2JqZWN0cyxpJiZpKG5ldyBlLkdyb3VwKHIsdCkpfSl9LGUuR3JvdXAuYXN5bmM9ITB9fShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPWZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQ7cmV0dXJuIHQuZmFicmljfHwodC5mYWJyaWM9e30pLHQuZmFicmljLkltYWdlP3ZvaWQgZmFicmljLndhcm4oXCJmYWJyaWMuSW1hZ2UgaXMgYWxyZWFkeSBkZWZpbmVkLlwiKTooZmFicmljLkltYWdlPWZhYnJpYy51dGlsLmNyZWF0ZUNsYXNzKGZhYnJpYy5PYmplY3Qse3R5cGU6XCJpbWFnZVwiLGNyb3NzT3JpZ2luOlwiXCIsYWxpZ25YOlwibm9uZVwiLGFsaWduWTpcIm5vbmVcIixtZWV0T3JTbGljZTpcIm1lZXRcIixfbGFzdFNjYWxlWDoxLF9sYXN0U2NhbGVZOjEsaW5pdGlhbGl6ZTpmdW5jdGlvbih0LGUpe2V8fChlPXt9KSx0aGlzLmZpbHRlcnM9W10sdGhpcy5yZXNpemVGaWx0ZXJzPVtdLHRoaXMuY2FsbFN1cGVyKFwiaW5pdGlhbGl6ZVwiLGUpLHRoaXMuX2luaXRFbGVtZW50KHQsZSl9LGdldEVsZW1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZWxlbWVudH0sc2V0RWxlbWVudDpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHRoaXMuX2VsZW1lbnQ9dCx0aGlzLl9vcmlnaW5hbEVsZW1lbnQ9dCx0aGlzLl9pbml0Q29uZmlnKGkpLDAhPT10aGlzLmZpbHRlcnMubGVuZ3RoP3RoaXMuYXBwbHlGaWx0ZXJzKGUpOmUmJmUoKSx0aGlzfSxzZXRDcm9zc09yaWdpbjpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jcm9zc09yaWdpbj10LHRoaXMuX2VsZW1lbnQuY3Jvc3NPcmlnaW49dCx0aGlzfSxnZXRPcmlnaW5hbFNpemU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmdldEVsZW1lbnQoKTtyZXR1cm57d2lkdGg6dC53aWR0aCxoZWlnaHQ6dC5oZWlnaHR9fSxfc3Ryb2tlOmZ1bmN0aW9uKHQpe3Quc2F2ZSgpLHRoaXMuX3NldFN0cm9rZVN0eWxlcyh0KSx0LmJlZ2luUGF0aCgpLHQuc3Ryb2tlUmVjdCgtdGhpcy53aWR0aC8yLC10aGlzLmhlaWdodC8yLHRoaXMud2lkdGgsdGhpcy5oZWlnaHQpLHQuY2xvc2VQYXRoKCksdC5yZXN0b3JlKCl9LF9yZW5kZXJEYXNoZWRTdHJva2U6ZnVuY3Rpb24odCl7dmFyIGU9LXRoaXMud2lkdGgvMixpPS10aGlzLmhlaWdodC8yLHI9dGhpcy53aWR0aCxzPXRoaXMuaGVpZ2h0O3Quc2F2ZSgpLHRoaXMuX3NldFN0cm9rZVN0eWxlcyh0KSx0LmJlZ2luUGF0aCgpLGZhYnJpYy51dGlsLmRyYXdEYXNoZWRMaW5lKHQsZSxpLGUrcixpLHRoaXMuc3Ryb2tlRGFzaEFycmF5KSxmYWJyaWMudXRpbC5kcmF3RGFzaGVkTGluZSh0LGUrcixpLGUrcixpK3MsdGhpcy5zdHJva2VEYXNoQXJyYXkpLGZhYnJpYy51dGlsLmRyYXdEYXNoZWRMaW5lKHQsZStyLGkrcyxlLGkrcyx0aGlzLnN0cm9rZURhc2hBcnJheSksZmFicmljLnV0aWwuZHJhd0Rhc2hlZExpbmUodCxlLGkrcyxlLGksdGhpcy5zdHJva2VEYXNoQXJyYXkpLHQuY2xvc2VQYXRoKCksdC5yZXN0b3JlKCl9LHRvT2JqZWN0OmZ1bmN0aW9uKHQpe3ZhciBpPWUodGhpcy5jYWxsU3VwZXIoXCJ0b09iamVjdFwiLHQpLHtzcmM6dGhpcy5fb3JpZ2luYWxFbGVtZW50LnNyY3x8dGhpcy5fb3JpZ2luYWxFbGVtZW50Ll9zcmMsZmlsdGVyczp0aGlzLmZpbHRlcnMubWFwKGZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0LnRvT2JqZWN0KCl9KSxjcm9zc09yaWdpbjp0aGlzLmNyb3NzT3JpZ2luLGFsaWduWDp0aGlzLmFsaWduWCxhbGlnblk6dGhpcy5hbGlnblksbWVldE9yU2xpY2U6dGhpcy5tZWV0T3JTbGljZX0pO3JldHVybiB0aGlzLnJlc2l6ZUZpbHRlcnMubGVuZ3RoPjAmJihpLnJlc2l6ZUZpbHRlcnM9dGhpcy5yZXNpemVGaWx0ZXJzLm1hcChmdW5jdGlvbih0KXtyZXR1cm4gdCYmdC50b09iamVjdCgpfSkpLGl9LHRvU1ZHOmZ1bmN0aW9uKHQpe3ZhciBlPVtdLGk9LXRoaXMud2lkdGgvMixyPS10aGlzLmhlaWdodC8yLHM9XCJub25lXCI7aWYodGhpcy5ncm91cCYmXCJwYXRoLWdyb3VwXCI9PT10aGlzLmdyb3VwLnR5cGUmJihpPXRoaXMubGVmdCxyPXRoaXMudG9wKSxcIm5vbmVcIiE9PXRoaXMuYWxpZ25YJiZcIm5vbmVcIiE9PXRoaXMuYWxpZ25ZJiYocz1cInhcIit0aGlzLmFsaWduWCtcIllcIit0aGlzLmFsaWduWStcIiBcIit0aGlzLm1lZXRPclNsaWNlKSxlLnB1c2goJzxnIHRyYW5zZm9ybT1cIicsdGhpcy5nZXRTdmdUcmFuc2Zvcm0oKSx0aGlzLmdldFN2Z1RyYW5zZm9ybU1hdHJpeCgpLCdcIj5cXG4nLCc8aW1hZ2UgeGxpbms6aHJlZj1cIicsdGhpcy5nZXRTdmdTcmMoKSwnXCIgeD1cIicsaSwnXCIgeT1cIicsciwnXCIgc3R5bGU9XCInLHRoaXMuZ2V0U3ZnU3R5bGVzKCksJ1wiIHdpZHRoPVwiJyx0aGlzLndpZHRoLCdcIiBoZWlnaHQ9XCInLHRoaXMuaGVpZ2h0LCdcIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPVwiJyxzLCdcIicsXCI+PC9pbWFnZT5cXG5cIiksdGhpcy5zdHJva2V8fHRoaXMuc3Ryb2tlRGFzaEFycmF5KXt2YXIgbj10aGlzLmZpbGw7dGhpcy5maWxsPW51bGwsZS5wdXNoKFwiPHJlY3QgXCIsJ3g9XCInLGksJ1wiIHk9XCInLHIsJ1wiIHdpZHRoPVwiJyx0aGlzLndpZHRoLCdcIiBoZWlnaHQ9XCInLHRoaXMuaGVpZ2h0LCdcIiBzdHlsZT1cIicsdGhpcy5nZXRTdmdTdHlsZXMoKSwnXCIvPlxcbicpLHRoaXMuZmlsbD1ufXJldHVybiBlLnB1c2goXCI8L2c+XFxuXCIpLHQ/dChlLmpvaW4oXCJcIikpOmUuam9pbihcIlwiKX0sZ2V0U3JjOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0RWxlbWVudCgpP3RoaXMuZ2V0RWxlbWVudCgpLnNyY3x8dGhpcy5nZXRFbGVtZW50KCkuX3NyYzp2b2lkIDB9LHNldFNyYzpmdW5jdGlvbih0LGUsaSl7ZmFicmljLnV0aWwubG9hZEltYWdlKHQsZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc2V0RWxlbWVudCh0LGUsaSl9LHRoaXMsaSYmaS5jcm9zc09yaWdpbil9LHRvU3RyaW5nOmZ1bmN0aW9uKCl7cmV0dXJuJyM8ZmFicmljLkltYWdlOiB7IHNyYzogXCInK3RoaXMuZ2V0U3JjKCkrJ1wiIH0+J30sY2xvbmU6ZnVuY3Rpb24odCxlKXt0aGlzLmNvbnN0cnVjdG9yLmZyb21PYmplY3QodGhpcy50b09iamVjdChlKSx0KX0sYXBwbHlGaWx0ZXJzOmZ1bmN0aW9uKHQsZSxpLHIpe2lmKGU9ZXx8dGhpcy5maWx0ZXJzLFxyXG5pPWl8fHRoaXMuX29yaWdpbmFsRWxlbWVudCl7dmFyIHM9aSxuPWZhYnJpYy51dGlsLmNyZWF0ZUNhbnZhc0VsZW1lbnQoKSxvPWZhYnJpYy51dGlsLmNyZWF0ZUltYWdlKCksYT10aGlzO3JldHVybiBuLndpZHRoPXMud2lkdGgsbi5oZWlnaHQ9cy5oZWlnaHQsbi5nZXRDb250ZXh0KFwiMmRcIikuZHJhd0ltYWdlKHMsMCwwLHMud2lkdGgscy5oZWlnaHQpLDA9PT1lLmxlbmd0aD8odGhpcy5fZWxlbWVudD1pLHQmJnQoKSxuKTooZS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3QmJnQuYXBwbHlUbyhuLHQuc2NhbGVYfHxhLnNjYWxlWCx0LnNjYWxlWXx8YS5zY2FsZVkpLCFyJiZ0JiZcIlJlc2l6ZVwiPT09dC50eXBlJiYoYS53aWR0aCo9dC5zY2FsZVgsYS5oZWlnaHQqPXQuc2NhbGVZKX0pLG8ud2lkdGg9bi53aWR0aCxvLmhlaWdodD1uLmhlaWdodCxmYWJyaWMuaXNMaWtlbHlOb2RlPyhvLnNyYz1uLnRvQnVmZmVyKHZvaWQgMCxmYWJyaWMuSW1hZ2UucG5nQ29tcHJlc3Npb24pLGEuX2VsZW1lbnQ9bywhciYmKGEuX2ZpbHRlcmVkRWw9byksdCYmdCgpKTooby5vbmxvYWQ9ZnVuY3Rpb24oKXthLl9lbGVtZW50PW8sIXImJihhLl9maWx0ZXJlZEVsPW8pLHQmJnQoKSxvLm9ubG9hZD1uPXM9bnVsbH0sby5zcmM9bi50b0RhdGFVUkwoXCJpbWFnZS9wbmdcIikpLG4pfX0sX3JlbmRlcjpmdW5jdGlvbih0LGUpe3ZhciBpLHIscyxuPXRoaXMuX2ZpbmRNYXJnaW5zKCk7aT1lP3RoaXMubGVmdDotdGhpcy53aWR0aC8yLHI9ZT90aGlzLnRvcDotdGhpcy5oZWlnaHQvMixcInNsaWNlXCI9PT10aGlzLm1lZXRPclNsaWNlJiYodC5iZWdpblBhdGgoKSx0LnJlY3QoaSxyLHRoaXMud2lkdGgsdGhpcy5oZWlnaHQpLHQuY2xpcCgpKSx0aGlzLmlzTW92aW5nPT09ITEmJnRoaXMucmVzaXplRmlsdGVycy5sZW5ndGgmJnRoaXMuX25lZWRzUmVzaXplKCk/KHRoaXMuX2xhc3RTY2FsZVg9dGhpcy5zY2FsZVgsdGhpcy5fbGFzdFNjYWxlWT10aGlzLnNjYWxlWSxzPXRoaXMuYXBwbHlGaWx0ZXJzKG51bGwsdGhpcy5yZXNpemVGaWx0ZXJzLHRoaXMuX2ZpbHRlcmVkRWx8fHRoaXMuX29yaWdpbmFsRWxlbWVudCwhMCkpOnM9dGhpcy5fZWxlbWVudCxzJiZ0LmRyYXdJbWFnZShzLGkrbi5tYXJnaW5YLHIrbi5tYXJnaW5ZLG4ud2lkdGgsbi5oZWlnaHQpLHRoaXMuX3JlbmRlclN0cm9rZSh0KX0sX25lZWRzUmVzaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2NhbGVYIT09dGhpcy5fbGFzdFNjYWxlWHx8dGhpcy5zY2FsZVkhPT10aGlzLl9sYXN0U2NhbGVZfSxfZmluZE1hcmdpbnM6ZnVuY3Rpb24oKXt2YXIgdCxlLGk9dGhpcy53aWR0aCxyPXRoaXMuaGVpZ2h0LHM9MCxuPTA7cmV0dXJuKFwibm9uZVwiIT09dGhpcy5hbGlnblh8fFwibm9uZVwiIT09dGhpcy5hbGlnblkpJiYodD1bdGhpcy53aWR0aC90aGlzLl9lbGVtZW50LndpZHRoLHRoaXMuaGVpZ2h0L3RoaXMuX2VsZW1lbnQuaGVpZ2h0XSxlPVwibWVldFwiPT09dGhpcy5tZWV0T3JTbGljZT9NYXRoLm1pbi5hcHBseShudWxsLHQpOk1hdGgubWF4LmFwcGx5KG51bGwsdCksaT10aGlzLl9lbGVtZW50LndpZHRoKmUscj10aGlzLl9lbGVtZW50LmhlaWdodCplLFwiTWlkXCI9PT10aGlzLmFsaWduWCYmKHM9KHRoaXMud2lkdGgtaSkvMiksXCJNYXhcIj09PXRoaXMuYWxpZ25YJiYocz10aGlzLndpZHRoLWkpLFwiTWlkXCI9PT10aGlzLmFsaWduWSYmKG49KHRoaXMuaGVpZ2h0LXIpLzIpLFwiTWF4XCI9PT10aGlzLmFsaWduWSYmKG49dGhpcy5oZWlnaHQtcikpLHt3aWR0aDppLGhlaWdodDpyLG1hcmdpblg6cyxtYXJnaW5ZOm59fSxfcmVzZXRXaWR0aEhlaWdodDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0RWxlbWVudCgpO3RoaXMuc2V0KFwid2lkdGhcIix0LndpZHRoKSx0aGlzLnNldChcImhlaWdodFwiLHQuaGVpZ2h0KX0sX2luaXRFbGVtZW50OmZ1bmN0aW9uKHQpe3RoaXMuc2V0RWxlbWVudChmYWJyaWMudXRpbC5nZXRCeUlkKHQpKSxmYWJyaWMudXRpbC5hZGRDbGFzcyh0aGlzLmdldEVsZW1lbnQoKSxmYWJyaWMuSW1hZ2UuQ1NTX0NBTlZBUyl9LF9pbml0Q29uZmlnOmZ1bmN0aW9uKHQpe3R8fCh0PXt9KSx0aGlzLnNldE9wdGlvbnModCksdGhpcy5fc2V0V2lkdGhIZWlnaHQodCksdGhpcy5fZWxlbWVudCYmdGhpcy5jcm9zc09yaWdpbiYmKHRoaXMuX2VsZW1lbnQuY3Jvc3NPcmlnaW49dGhpcy5jcm9zc09yaWdpbil9LF9pbml0RmlsdGVyczpmdW5jdGlvbih0LGUpe3QmJnQubGVuZ3RoP2ZhYnJpYy51dGlsLmVubGl2ZW5PYmplY3RzKHQsZnVuY3Rpb24odCl7ZSYmZSh0KX0sXCJmYWJyaWMuSW1hZ2UuZmlsdGVyc1wiKTplJiZlKCl9LF9zZXRXaWR0aEhlaWdodDpmdW5jdGlvbih0KXt0aGlzLndpZHRoPVwid2lkdGhcImluIHQ/dC53aWR0aDp0aGlzLmdldEVsZW1lbnQoKT90aGlzLmdldEVsZW1lbnQoKS53aWR0aHx8MDowLHRoaXMuaGVpZ2h0PVwiaGVpZ2h0XCJpbiB0P3QuaGVpZ2h0OnRoaXMuZ2V0RWxlbWVudCgpP3RoaXMuZ2V0RWxlbWVudCgpLmhlaWdodHx8MDowfSxjb21wbGV4aXR5OmZ1bmN0aW9uKCl7cmV0dXJuIDF9fSksZmFicmljLkltYWdlLkNTU19DQU5WQVM9XCJjYW52YXMtaW1nXCIsZmFicmljLkltYWdlLnByb3RvdHlwZS5nZXRTdmdTcmM9ZmFicmljLkltYWdlLnByb3RvdHlwZS5nZXRTcmMsZmFicmljLkltYWdlLmZyb21PYmplY3Q9ZnVuY3Rpb24odCxlKXtmYWJyaWMudXRpbC5sb2FkSW1hZ2UodC5zcmMsZnVuY3Rpb24oaSl7ZmFicmljLkltYWdlLnByb3RvdHlwZS5faW5pdEZpbHRlcnMuY2FsbCh0LHQuZmlsdGVycyxmdW5jdGlvbihyKXt0LmZpbHRlcnM9cnx8W10sZmFicmljLkltYWdlLnByb3RvdHlwZS5faW5pdEZpbHRlcnMuY2FsbCh0LHQucmVzaXplRmlsdGVycyxmdW5jdGlvbihyKXt0LnJlc2l6ZUZpbHRlcnM9cnx8W107dmFyIHM9bmV3IGZhYnJpYy5JbWFnZShpLHQpO2UmJmUocyl9KX0pfSxudWxsLHQuY3Jvc3NPcmlnaW4pfSxmYWJyaWMuSW1hZ2UuZnJvbVVSTD1mdW5jdGlvbih0LGUsaSl7ZmFicmljLnV0aWwubG9hZEltYWdlKHQsZnVuY3Rpb24odCl7ZSYmZShuZXcgZmFicmljLkltYWdlKHQsaSkpfSxudWxsLGkmJmkuY3Jvc3NPcmlnaW4pfSxmYWJyaWMuSW1hZ2UuQVRUUklCVVRFX05BTUVTPWZhYnJpYy5TSEFSRURfQVRUUklCVVRFUy5jb25jYXQoXCJ4IHkgd2lkdGggaGVpZ2h0IHByZXNlcnZlQXNwZWN0UmF0aW8geGxpbms6aHJlZlwiLnNwbGl0KFwiIFwiKSksZmFicmljLkltYWdlLmZyb21FbGVtZW50PWZ1bmN0aW9uKHQsaSxyKXt2YXIgcyxuLG8sYT1mYWJyaWMucGFyc2VBdHRyaWJ1dGVzKHQsZmFicmljLkltYWdlLkFUVFJJQlVURV9OQU1FUyksaD1cInhNaWRZTWlkXCIsYz1cIm1lZXRcIjthLnByZXNlcnZlQXNwZWN0UmF0aW8mJihvPWEucHJlc2VydmVBc3BlY3RSYXRpby5zcGxpdChcIiBcIikpLG8mJm8ubGVuZ3RoJiYoYz1vLnBvcCgpLFwibWVldFwiIT09YyYmXCJzbGljZVwiIT09Yz8oaD1jLGM9XCJtZWV0XCIpOm8ubGVuZ3RoJiYoaD1vLnBvcCgpKSkscz1cIm5vbmVcIiE9PWg/aC5zbGljZSgxLDQpOlwibm9uZVwiLG49XCJub25lXCIhPT1oP2guc2xpY2UoNSw4KTpcIm5vbmVcIixhLmFsaWduWD1zLGEuYWxpZ25ZPW4sYS5tZWV0T3JTbGljZT1jLGZhYnJpYy5JbWFnZS5mcm9tVVJMKGFbXCJ4bGluazpocmVmXCJdLGksZShyP2ZhYnJpYy51dGlsLm9iamVjdC5jbG9uZShyKTp7fSxhKSl9LGZhYnJpYy5JbWFnZS5hc3luYz0hMCx2b2lkKGZhYnJpYy5JbWFnZS5wbmdDb21wcmVzc2lvbj0xKSl9KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuT2JqZWN0LnByb3RvdHlwZSx7X2dldEFuZ2xlVmFsdWVGb3JTdHJhaWdodGVuOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXRBbmdsZSgpJTM2MDtyZXR1cm4gdD4wPzkwKk1hdGgucm91bmQoKHQtMSkvOTApOjkwKk1hdGgucm91bmQodC85MCl9LHN0cmFpZ2h0ZW46ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZXRBbmdsZSh0aGlzLl9nZXRBbmdsZVZhbHVlRm9yU3RyYWlnaHRlbigpKSx0aGlzfSxmeFN0cmFpZ2h0ZW46ZnVuY3Rpb24odCl7dD10fHx7fTt2YXIgZT1mdW5jdGlvbigpe30saT10Lm9uQ29tcGxldGV8fGUscj10Lm9uQ2hhbmdlfHxlLHM9dGhpcztyZXR1cm4gZmFicmljLnV0aWwuYW5pbWF0ZSh7c3RhcnRWYWx1ZTp0aGlzLmdldChcImFuZ2xlXCIpLGVuZFZhbHVlOnRoaXMuX2dldEFuZ2xlVmFsdWVGb3JTdHJhaWdodGVuKCksZHVyYXRpb246dGhpcy5GWF9EVVJBVElPTixvbkNoYW5nZTpmdW5jdGlvbih0KXtzLnNldEFuZ2xlKHQpLHIoKX0sb25Db21wbGV0ZTpmdW5jdGlvbigpe3Muc2V0Q29vcmRzKCksaSgpfSxvblN0YXJ0OmZ1bmN0aW9uKCl7cy5zZXQoXCJhY3RpdmVcIiwhMSl9fSksdGhpc319KSxmYWJyaWMudXRpbC5vYmplY3QuZXh0ZW5kKGZhYnJpYy5TdGF0aWNDYW52YXMucHJvdG90eXBlLHtzdHJhaWdodGVuT2JqZWN0OmZ1bmN0aW9uKHQpe3JldHVybiB0LnN0cmFpZ2h0ZW4oKSx0aGlzLnJlbmRlckFsbCgpLHRoaXN9LGZ4U3RyYWlnaHRlbk9iamVjdDpmdW5jdGlvbih0KXtyZXR1cm4gdC5meFN0cmFpZ2h0ZW4oe29uQ2hhbmdlOnRoaXMucmVuZGVyQWxsLmJpbmQodGhpcyl9KSx0aGlzfX0pLGZhYnJpYy5JbWFnZS5maWx0ZXJzPWZhYnJpYy5JbWFnZS5maWx0ZXJzfHx7fSxmYWJyaWMuSW1hZ2UuZmlsdGVycy5CYXNlRmlsdGVyPWZhYnJpYy51dGlsLmNyZWF0ZUNsYXNzKHt0eXBlOlwiQmFzZUZpbHRlclwiLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dCYmdGhpcy5zZXRPcHRpb25zKHQpfSxzZXRPcHRpb25zOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZSBpbiB0KXRoaXNbZV09dFtlXX0sdG9PYmplY3Q6ZnVuY3Rpb24oKXtyZXR1cm57dHlwZTp0aGlzLnR5cGV9fSx0b0pTT046ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b09iamVjdCgpfX0pLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPXQuZmFicmljfHwodC5mYWJyaWM9e30pLGk9ZS51dGlsLm9iamVjdC5leHRlbmQ7ZS5JbWFnZS5maWx0ZXJzLkJyaWdodG5lc3M9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuSW1hZ2UuZmlsdGVycy5CYXNlRmlsdGVyLHt0eXBlOlwiQnJpZ2h0bmVzc1wiLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dD10fHx7fSx0aGlzLmJyaWdodG5lc3M9dC5icmlnaHRuZXNzfHwwfSxhcHBseVRvOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10LmdldENvbnRleHQoXCIyZFwiKSxpPWUuZ2V0SW1hZ2VEYXRhKDAsMCx0LndpZHRoLHQuaGVpZ2h0KSxyPWkuZGF0YSxzPXRoaXMuYnJpZ2h0bmVzcyxuPTAsbz1yLmxlbmd0aDtvPm47bis9NClyW25dKz1zLHJbbisxXSs9cyxyW24rMl0rPXM7ZS5wdXRJbWFnZURhdGEoaSwwLDApfSx0b09iamVjdDpmdW5jdGlvbigpe3JldHVybiBpKHRoaXMuY2FsbFN1cGVyKFwidG9PYmplY3RcIikse2JyaWdodG5lc3M6dGhpcy5icmlnaHRuZXNzfSl9fSksZS5JbWFnZS5maWx0ZXJzLkJyaWdodG5lc3MuZnJvbU9iamVjdD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUuSW1hZ2UuZmlsdGVycy5CcmlnaHRuZXNzKHQpfX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPWUudXRpbC5vYmplY3QuZXh0ZW5kO2UuSW1hZ2UuZmlsdGVycy5Db252b2x1dGU9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuSW1hZ2UuZmlsdGVycy5CYXNlRmlsdGVyLHt0eXBlOlwiQ29udm9sdXRlXCIsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0PXR8fHt9LHRoaXMub3BhcXVlPXQub3BhcXVlLHRoaXMubWF0cml4PXQubWF0cml4fHxbMCwwLDAsMCwxLDAsMCwwLDBdO3ZhciBpPWUudXRpbC5jcmVhdGVDYW52YXNFbGVtZW50KCk7dGhpcy50bXBDdHg9aS5nZXRDb250ZXh0KFwiMmRcIil9LF9jcmVhdGVJbWFnZURhdGE6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy50bXBDdHguY3JlYXRlSW1hZ2VEYXRhKHQsZSl9LGFwcGx5VG86ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXRoaXMubWF0cml4LGk9dC5nZXRDb250ZXh0KFwiMmRcIikscj1pLmdldEltYWdlRGF0YSgwLDAsdC53aWR0aCx0LmhlaWdodCkscz1NYXRoLnJvdW5kKE1hdGguc3FydChlLmxlbmd0aCkpLG49TWF0aC5mbG9vcihzLzIpLG89ci5kYXRhLGE9ci53aWR0aCxoPXIuaGVpZ2h0LGM9YSxsPWgsdT10aGlzLl9jcmVhdGVJbWFnZURhdGEoYyxsKSxmPXUuZGF0YSxkPXRoaXMub3BhcXVlPzE6MCxnPTA7bD5nO2crKylmb3IodmFyIHA9MDtjPnA7cCsrKXtmb3IodmFyIHY9ZyxiPXAsbT00KihnKmMrcCkseT0wLF89MCx4PTAsQz0wLFM9MDtzPlM7UysrKWZvcih2YXIgdz0wO3M+dzt3Kyspe3ZhciBPPXYrUy1uLFQ9Yit3LW47aWYoISgwPk98fE8+aHx8MD5UfHxUPmEpKXt2YXIgaz00KihPKmErVCksaj1lW1Mqcyt3XTt5Kz1vW2tdKmosXys9b1trKzFdKmoseCs9b1trKzJdKmosQys9b1trKzNdKmp9fWZbbV09eSxmW20rMV09XyxmW20rMl09eCxmW20rM109QytkKigyNTUtQyl9aS5wdXRJbWFnZURhdGEodSwwLDApfSx0b09iamVjdDpmdW5jdGlvbigpe3JldHVybiBpKHRoaXMuY2FsbFN1cGVyKFwidG9PYmplY3RcIikse29wYXF1ZTp0aGlzLm9wYXF1ZSxtYXRyaXg6dGhpcy5tYXRyaXh9KX19KSxlLkltYWdlLmZpbHRlcnMuQ29udm9sdXRlLmZyb21PYmplY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlLkltYWdlLmZpbHRlcnMuQ29udm9sdXRlKHQpfX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPWUudXRpbC5vYmplY3QuZXh0ZW5kO2UuSW1hZ2UuZmlsdGVycy5HcmFkaWVudFRyYW5zcGFyZW5jeT1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5JbWFnZS5maWx0ZXJzLkJhc2VGaWx0ZXIse3R5cGU6XCJHcmFkaWVudFRyYW5zcGFyZW5jeVwiLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dD10fHx7fSx0aGlzLnRocmVzaG9sZD10LnRocmVzaG9sZHx8MTAwfSxhcHBseVRvOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10LmdldENvbnRleHQoXCIyZFwiKSxpPWUuZ2V0SW1hZ2VEYXRhKDAsMCx0LndpZHRoLHQuaGVpZ2h0KSxyPWkuZGF0YSxzPXRoaXMudGhyZXNob2xkLG49ci5sZW5ndGgsbz0wLGE9ci5sZW5ndGg7YT5vO28rPTQpcltvKzNdPXMrMjU1KihuLW8pL247ZS5wdXRJbWFnZURhdGEoaSwwLDApfSx0b09iamVjdDpmdW5jdGlvbigpe3JldHVybiBpKHRoaXMuY2FsbFN1cGVyKFwidG9PYmplY3RcIikse3RocmVzaG9sZDp0aGlzLnRocmVzaG9sZH0pfX0pLGUuSW1hZ2UuZmlsdGVycy5HcmFkaWVudFRyYW5zcGFyZW5jeS5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5JbWFnZS5maWx0ZXJzLkdyYWRpZW50VHJhbnNwYXJlbmN5KHQpfX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KTtlLkltYWdlLmZpbHRlcnMuR3JheXNjYWxlPWUudXRpbC5jcmVhdGVDbGFzcyhlLkltYWdlLmZpbHRlcnMuQmFzZUZpbHRlcix7dHlwZTpcIkdyYXlzY2FsZVwiLGFwcGx5VG86ZnVuY3Rpb24odCl7Zm9yKHZhciBlLGk9dC5nZXRDb250ZXh0KFwiMmRcIikscj1pLmdldEltYWdlRGF0YSgwLDAsdC53aWR0aCx0LmhlaWdodCkscz1yLmRhdGEsbj1yLndpZHRoKnIuaGVpZ2h0KjQsbz0wO24+bzspZT0oc1tvXStzW28rMV0rc1tvKzJdKS8zLHNbb109ZSxzW28rMV09ZSxzW28rMl09ZSxvKz00O2kucHV0SW1hZ2VEYXRhKHIsMCwwKX19KSxlLkltYWdlLmZpbHRlcnMuR3JheXNjYWxlLmZyb21PYmplY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUuSW1hZ2UuZmlsdGVycy5HcmF5c2NhbGV9fShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPXQuZmFicmljfHwodC5mYWJyaWM9e30pO2UuSW1hZ2UuZmlsdGVycy5JbnZlcnQ9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuSW1hZ2UuZmlsdGVycy5CYXNlRmlsdGVyLHt0eXBlOlwiSW52ZXJ0XCIsYXBwbHlUbzpmdW5jdGlvbih0KXt2YXIgZSxpPXQuZ2V0Q29udGV4dChcIjJkXCIpLHI9aS5nZXRJbWFnZURhdGEoMCwwLHQud2lkdGgsdC5oZWlnaHQpLHM9ci5kYXRhLG49cy5sZW5ndGg7Zm9yKGU9MDtuPmU7ZSs9NClzW2VdPTI1NS1zW2VdLHNbZSsxXT0yNTUtc1tlKzFdLHNbZSsyXT0yNTUtc1tlKzJdO2kucHV0SW1hZ2VEYXRhKHIsMCwwKX19KSxlLkltYWdlLmZpbHRlcnMuSW52ZXJ0LmZyb21PYmplY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUuSW1hZ2UuZmlsdGVycy5JbnZlcnR9fShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPXQuZmFicmljfHwodC5mYWJyaWM9e30pLGk9ZS51dGlsLm9iamVjdC5leHRlbmQ7ZS5JbWFnZS5maWx0ZXJzLk1hc2s9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuSW1hZ2UuZmlsdGVycy5CYXNlRmlsdGVyLHt0eXBlOlwiTWFza1wiLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dD10fHx7fSx0aGlzLm1hc2s9dC5tYXNrLHRoaXMuY2hhbm5lbD1bMCwxLDIsM10uaW5kZXhPZih0LmNoYW5uZWwpPi0xP3QuY2hhbm5lbDowfSxhcHBseVRvOmZ1bmN0aW9uKHQpe2lmKHRoaXMubWFzayl7dmFyIGkscj10LmdldENvbnRleHQoXCIyZFwiKSxzPXIuZ2V0SW1hZ2VEYXRhKDAsMCx0LndpZHRoLHQuaGVpZ2h0KSxuPXMuZGF0YSxvPXRoaXMubWFzay5nZXRFbGVtZW50KCksYT1lLnV0aWwuY3JlYXRlQ2FudmFzRWxlbWVudCgpLGg9dGhpcy5jaGFubmVsLGM9cy53aWR0aCpzLmhlaWdodCo0O2Eud2lkdGg9by53aWR0aCxhLmhlaWdodD1vLmhlaWdodCxhLmdldENvbnRleHQoXCIyZFwiKS5kcmF3SW1hZ2UobywwLDAsby53aWR0aCxvLmhlaWdodCk7dmFyIGw9YS5nZXRDb250ZXh0KFwiMmRcIikuZ2V0SW1hZ2VEYXRhKDAsMCxvLndpZHRoLG8uaGVpZ2h0KSx1PWwuZGF0YTtmb3IoaT0wO2M+aTtpKz00KW5baSszXT11W2kraF07ci5wdXRJbWFnZURhdGEocywwLDApfX0sdG9PYmplY3Q6ZnVuY3Rpb24oKXtyZXR1cm4gaSh0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIpLHttYXNrOnRoaXMubWFzay50b09iamVjdCgpLGNoYW5uZWw6dGhpcy5jaGFubmVsfSl9fSksZS5JbWFnZS5maWx0ZXJzLk1hc2suZnJvbU9iamVjdD1mdW5jdGlvbih0LGkpe2UudXRpbC5sb2FkSW1hZ2UodC5tYXNrLnNyYyxmdW5jdGlvbihyKXt0Lm1hc2s9bmV3IGUuSW1hZ2Uocix0Lm1hc2spLGkmJmkobmV3IGUuSW1hZ2UuZmlsdGVycy5NYXNrKHQpKX0pfSxlLkltYWdlLmZpbHRlcnMuTWFzay5hc3luYz0hMH0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPWUudXRpbC5vYmplY3QuZXh0ZW5kO2UuSW1hZ2UuZmlsdGVycy5Ob2lzZT1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5JbWFnZS5maWx0ZXJzLkJhc2VGaWx0ZXIse3R5cGU6XCJOb2lzZVwiLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dD10fHx7fSx0aGlzLm5vaXNlPXQubm9pc2V8fDB9LGFwcGx5VG86ZnVuY3Rpb24odCl7Zm9yKHZhciBlLGk9dC5nZXRDb250ZXh0KFwiMmRcIikscj1pLmdldEltYWdlRGF0YSgwLDAsdC53aWR0aCx0LmhlaWdodCkscz1yLmRhdGEsbj10aGlzLm5vaXNlLG89MCxhPXMubGVuZ3RoO2E+bztvKz00KWU9KC41LU1hdGgucmFuZG9tKCkpKm4sc1tvXSs9ZSxzW28rMV0rPWUsc1tvKzJdKz1lO2kucHV0SW1hZ2VEYXRhKHIsMCwwKX0sdG9PYmplY3Q6ZnVuY3Rpb24oKXtyZXR1cm4gaSh0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIpLHtub2lzZTp0aGlzLm5vaXNlfSl9fSksZS5JbWFnZS5maWx0ZXJzLk5vaXNlLmZyb21PYmplY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlLkltYWdlLmZpbHRlcnMuTm9pc2UodCl9fShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPXQuZmFicmljfHwodC5mYWJyaWM9e30pLGk9ZS51dGlsLm9iamVjdC5leHRlbmQ7ZS5JbWFnZS5maWx0ZXJzLlBpeGVsYXRlPWUudXRpbC5jcmVhdGVDbGFzcyhlLkltYWdlLmZpbHRlcnMuQmFzZUZpbHRlcix7dHlwZTpcIlBpeGVsYXRlXCIsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0PXR8fHt9LHRoaXMuYmxvY2tzaXplPXQuYmxvY2tzaXplfHw0fSxhcHBseVRvOmZ1bmN0aW9uKHQpe3ZhciBlLGkscixzLG4sbyxhLGg9dC5nZXRDb250ZXh0KFwiMmRcIiksYz1oLmdldEltYWdlRGF0YSgwLDAsdC53aWR0aCx0LmhlaWdodCksbD1jLmRhdGEsdT1jLmhlaWdodCxmPWMud2lkdGg7Zm9yKGk9MDt1Pmk7aSs9dGhpcy5ibG9ja3NpemUpZm9yKHI9MDtmPnI7cis9dGhpcy5ibG9ja3NpemUpe2U9NCppKmYrNCpyLHM9bFtlXSxuPWxbZSsxXSxvPWxbZSsyXSxhPWxbZSszXTtmb3IodmFyIGQ9aSxnPWkrdGhpcy5ibG9ja3NpemU7Zz5kO2QrKylmb3IodmFyIHA9cix2PXIrdGhpcy5ibG9ja3NpemU7dj5wO3ArKyllPTQqZCpmKzQqcCxsW2VdPXMsbFtlKzFdPW4sbFtlKzJdPW8sbFtlKzNdPWF9aC5wdXRJbWFnZURhdGEoYywwLDApfSx0b09iamVjdDpmdW5jdGlvbigpe3JldHVybiBpKHRoaXMuY2FsbFN1cGVyKFwidG9PYmplY3RcIikse2Jsb2Nrc2l6ZTp0aGlzLmJsb2Nrc2l6ZX0pfX0pLGUuSW1hZ2UuZmlsdGVycy5QaXhlbGF0ZS5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5JbWFnZS5maWx0ZXJzLlBpeGVsYXRlKHQpfX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPWUudXRpbC5vYmplY3QuZXh0ZW5kO2UuSW1hZ2UuZmlsdGVycy5SZW1vdmVXaGl0ZT1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5JbWFnZS5maWx0ZXJzLkJhc2VGaWx0ZXIse3R5cGU6XCJSZW1vdmVXaGl0ZVwiLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dD10fHx7fSx0aGlzLnRocmVzaG9sZD10LnRocmVzaG9sZHx8MzAsdGhpcy5kaXN0YW5jZT10LmRpc3RhbmNlfHwyMH0sYXBwbHlUbzpmdW5jdGlvbih0KXtmb3IodmFyIGUsaSxyLHM9dC5nZXRDb250ZXh0KFwiMmRcIiksbj1zLmdldEltYWdlRGF0YSgwLDAsdC53aWR0aCx0LmhlaWdodCksbz1uLmRhdGEsYT10aGlzLnRocmVzaG9sZCxoPXRoaXMuZGlzdGFuY2UsYz0yNTUtYSxsPU1hdGguYWJzLHU9MCxmPW8ubGVuZ3RoO2Y+dTt1Kz00KWU9b1t1XSxpPW9bdSsxXSxyPW9bdSsyXSxlPmMmJmk+YyYmcj5jJiZsKGUtaSk8aCYmbChlLXIpPGgmJmwoaS1yKTxoJiYob1t1KzNdPTEpO3MucHV0SW1hZ2VEYXRhKG4sMCwwKX0sdG9PYmplY3Q6ZnVuY3Rpb24oKXtyZXR1cm4gaSh0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIpLHt0aHJlc2hvbGQ6dGhpcy50aHJlc2hvbGQsZGlzdGFuY2U6dGhpcy5kaXN0YW5jZX0pfX0pLGUuSW1hZ2UuZmlsdGVycy5SZW1vdmVXaGl0ZS5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5JbWFnZS5maWx0ZXJzLlJlbW92ZVdoaXRlKHQpfX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KTtlLkltYWdlLmZpbHRlcnMuU2VwaWE9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuSW1hZ2UuZmlsdGVycy5CYXNlRmlsdGVyLHt0eXBlOlwiU2VwaWFcIixhcHBseVRvOmZ1bmN0aW9uKHQpe3ZhciBlLGkscj10LmdldENvbnRleHQoXCIyZFwiKSxzPXIuZ2V0SW1hZ2VEYXRhKDAsMCx0LndpZHRoLHQuaGVpZ2h0KSxuPXMuZGF0YSxvPW4ubGVuZ3RoO2ZvcihlPTA7bz5lO2UrPTQpaT0uMypuW2VdKy41OSpuW2UrMV0rLjExKm5bZSsyXSxuW2VdPWkrMTAwLG5bZSsxXT1pKzUwLG5bZSsyXT1pKzI1NTtyLnB1dEltYWdlRGF0YShzLDAsMCl9fSksZS5JbWFnZS5maWx0ZXJzLlNlcGlhLmZyb21PYmplY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUuSW1hZ2UuZmlsdGVycy5TZXBpYX19KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSk7ZS5JbWFnZS5maWx0ZXJzLlNlcGlhMj1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5JbWFnZS5maWx0ZXJzLkJhc2VGaWx0ZXIse3R5cGU6XCJTZXBpYTJcIixhcHBseVRvOmZ1bmN0aW9uKHQpe3ZhciBlLGkscixzLG49dC5nZXRDb250ZXh0KFwiMmRcIiksbz1uLmdldEltYWdlRGF0YSgwLDAsdC53aWR0aCx0LmhlaWdodCksYT1vLmRhdGEsaD1hLmxlbmd0aDtmb3IoZT0wO2g+ZTtlKz00KWk9YVtlXSxyPWFbZSsxXSxzPWFbZSsyXSxhW2VdPSguMzkzKmkrLjc2OSpyKy4xODkqcykvMS4zNTEsYVtlKzFdPSguMzQ5KmkrLjY4NipyKy4xNjgqcykvMS4yMDMsYVtlKzJdPSguMjcyKmkrLjUzNCpyKy4xMzEqcykvMi4xNDtuLnB1dEltYWdlRGF0YShvLDAsMCl9fSksZS5JbWFnZS5maWx0ZXJzLlNlcGlhMi5mcm9tT2JqZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlLkltYWdlLmZpbHRlcnMuU2VwaWEyfX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPWUudXRpbC5vYmplY3QuZXh0ZW5kO2UuSW1hZ2UuZmlsdGVycy5UaW50PWUudXRpbC5jcmVhdGVDbGFzcyhlLkltYWdlLmZpbHRlcnMuQmFzZUZpbHRlcix7dHlwZTpcIlRpbnRcIixpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3Q9dHx8e30sdGhpcy5jb2xvcj10LmNvbG9yfHxcIiMwMDAwMDBcIix0aGlzLm9wYWNpdHk9XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHQub3BhY2l0eT90Lm9wYWNpdHk6bmV3IGUuQ29sb3IodGhpcy5jb2xvcikuZ2V0QWxwaGEoKX0sYXBwbHlUbzpmdW5jdGlvbih0KXt2YXIgaSxyLHMsbixvLGEsaCxjLGwsdT10LmdldENvbnRleHQoXCIyZFwiKSxmPXUuZ2V0SW1hZ2VEYXRhKDAsMCx0LndpZHRoLHQuaGVpZ2h0KSxkPWYuZGF0YSxnPWQubGVuZ3RoO2ZvcihsPW5ldyBlLkNvbG9yKHRoaXMuY29sb3IpLmdldFNvdXJjZSgpLHI9bFswXSp0aGlzLm9wYWNpdHkscz1sWzFdKnRoaXMub3BhY2l0eSxuPWxbMl0qdGhpcy5vcGFjaXR5LGM9MS10aGlzLm9wYWNpdHksaT0wO2c+aTtpKz00KW89ZFtpXSxhPWRbaSsxXSxoPWRbaSsyXSxkW2ldPXIrbypjLGRbaSsxXT1zK2EqYyxkW2krMl09bitoKmM7dS5wdXRJbWFnZURhdGEoZiwwLDApfSx0b09iamVjdDpmdW5jdGlvbigpe3JldHVybiBpKHRoaXMuY2FsbFN1cGVyKFwidG9PYmplY3RcIikse2NvbG9yOnRoaXMuY29sb3Isb3BhY2l0eTp0aGlzLm9wYWNpdHl9KX19KSxlLkltYWdlLmZpbHRlcnMuVGludC5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5JbWFnZS5maWx0ZXJzLlRpbnQodCl9fShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPXQuZmFicmljfHwodC5mYWJyaWM9e30pLGk9ZS51dGlsLm9iamVjdC5leHRlbmQ7ZS5JbWFnZS5maWx0ZXJzLk11bHRpcGx5PWUudXRpbC5jcmVhdGVDbGFzcyhlLkltYWdlLmZpbHRlcnMuQmFzZUZpbHRlcix7dHlwZTpcIk11bHRpcGx5XCIsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0PXR8fHt9LHRoaXMuY29sb3I9dC5jb2xvcnx8XCIjMDAwMDAwXCJ9LGFwcGx5VG86ZnVuY3Rpb24odCl7dmFyIGkscixzPXQuZ2V0Q29udGV4dChcIjJkXCIpLG49cy5nZXRJbWFnZURhdGEoMCwwLHQud2lkdGgsdC5oZWlnaHQpLG89bi5kYXRhLGE9by5sZW5ndGg7Zm9yKHI9bmV3IGUuQ29sb3IodGhpcy5jb2xvcikuZ2V0U291cmNlKCksaT0wO2E+aTtpKz00KW9baV0qPXJbMF0vMjU1LG9baSsxXSo9clsxXS8yNTUsb1tpKzJdKj1yWzJdLzI1NTtzLnB1dEltYWdlRGF0YShuLDAsMCl9LHRvT2JqZWN0OmZ1bmN0aW9uKCl7cmV0dXJuIGkodGhpcy5jYWxsU3VwZXIoXCJ0b09iamVjdFwiKSx7Y29sb3I6dGhpcy5jb2xvcn0pfX0pLGUuSW1hZ2UuZmlsdGVycy5NdWx0aXBseS5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5JbWFnZS5maWx0ZXJzLk11bHRpcGx5KHQpfX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpYztlLkltYWdlLmZpbHRlcnMuQmxlbmQ9ZS51dGlsLmNyZWF0ZUNsYXNzKHt0eXBlOlwiQmxlbmRcIixpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3Q9dHx8e30sdGhpcy5jb2xvcj10LmNvbG9yfHxcIiMwMDBcIix0aGlzLmltYWdlPXQuaW1hZ2V8fCExLHRoaXMubW9kZT10Lm1vZGV8fFwibXVsdGlwbHlcIix0aGlzLmFscGhhPXQuYWxwaGF8fDF9LGFwcGx5VG86ZnVuY3Rpb24odCl7dmFyIGkscixzLG4sbyxhLGgsYyxsLHUsZj10LmdldENvbnRleHQoXCIyZFwiKSxkPWYuZ2V0SW1hZ2VEYXRhKDAsMCx0LndpZHRoLHQuaGVpZ2h0KSxnPWQuZGF0YSxwPSExO2lmKHRoaXMuaW1hZ2Upe3A9ITA7dmFyIHY9ZS51dGlsLmNyZWF0ZUNhbnZhc0VsZW1lbnQoKTt2LndpZHRoPXRoaXMuaW1hZ2Uud2lkdGgsdi5oZWlnaHQ9dGhpcy5pbWFnZS5oZWlnaHQ7dmFyIGI9bmV3IGUuU3RhdGljQ2FudmFzKHYpO2IuYWRkKHRoaXMuaW1hZ2UpO3ZhciBtPWIuZ2V0Q29udGV4dChcIjJkXCIpO3U9bS5nZXRJbWFnZURhdGEoMCwwLGIud2lkdGgsYi5oZWlnaHQpLmRhdGF9ZWxzZSB1PW5ldyBlLkNvbG9yKHRoaXMuY29sb3IpLmdldFNvdXJjZSgpLGk9dVswXSp0aGlzLmFscGhhLHI9dVsxXSp0aGlzLmFscGhhLHM9dVsyXSp0aGlzLmFscGhhO2Zvcih2YXIgeT0wLF89Zy5sZW5ndGg7Xz55O3krPTQpc3dpdGNoKG49Z1t5XSxvPWdbeSsxXSxhPWdbeSsyXSxwJiYoaT11W3ldKnRoaXMuYWxwaGEscj11W3krMV0qdGhpcy5hbHBoYSxzPXVbeSsyXSp0aGlzLmFscGhhKSx0aGlzLm1vZGUpe2Nhc2VcIm11bHRpcGx5XCI6Z1t5XT1uKmkvMjU1LGdbeSsxXT1vKnIvMjU1LGdbeSsyXT1hKnMvMjU1O2JyZWFrO2Nhc2VcInNjcmVlblwiOmdbeV09MS0oMS1uKSooMS1pKSxnW3krMV09MS0oMS1vKSooMS1yKSxnW3krMl09MS0oMS1hKSooMS1zKTticmVhaztjYXNlXCJhZGRcIjpnW3ldPU1hdGgubWluKDI1NSxuK2kpLGdbeSsxXT1NYXRoLm1pbigyNTUsbytyKSxnW3krMl09TWF0aC5taW4oMjU1LGErcyk7YnJlYWs7Y2FzZVwiZGlmZlwiOmNhc2VcImRpZmZlcmVuY2VcIjpnW3ldPU1hdGguYWJzKG4taSksZ1t5KzFdPU1hdGguYWJzKG8tciksZ1t5KzJdPU1hdGguYWJzKGEtcyk7YnJlYWs7Y2FzZVwic3VidHJhY3RcIjpoPW4taSxjPW8tcixsPWEtcyxnW3ldPTA+aD8wOmgsZ1t5KzFdPTA+Yz8wOmMsZ1t5KzJdPTA+bD8wOmw7YnJlYWs7Y2FzZVwiZGFya2VuXCI6Z1t5XT1NYXRoLm1pbihuLGkpLGdbeSsxXT1NYXRoLm1pbihvLHIpLGdbeSsyXT1NYXRoLm1pbihhLHMpO2JyZWFrO2Nhc2VcImxpZ2h0ZW5cIjpnW3ldPU1hdGgubWF4KG4saSksZ1t5KzFdPU1hdGgubWF4KG8sciksZ1t5KzJdPU1hdGgubWF4KGEscyl9Zi5wdXRJbWFnZURhdGEoZCwwLDApfSx0b09iamVjdDpmdW5jdGlvbigpe3JldHVybntjb2xvcjp0aGlzLmNvbG9yLGltYWdlOnRoaXMuaW1hZ2UsbW9kZTp0aGlzLm1vZGUsYWxwaGE6dGhpcy5hbHBoYX19fSksZS5JbWFnZS5maWx0ZXJzLkJsZW5kLmZyb21PYmplY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlLkltYWdlLmZpbHRlcnMuQmxlbmQodCl9fShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPXQuZmFicmljfHwodC5mYWJyaWM9e30pLGk9TWF0aC5wb3cscj1NYXRoLmZsb29yLHM9TWF0aC5zcXJ0LG49TWF0aC5hYnMsbz1NYXRoLm1heCxhPU1hdGgucm91bmQsaD1NYXRoLnNpbixjPU1hdGguY2VpbDtlLkltYWdlLmZpbHRlcnMuUmVzaXplPWUudXRpbC5jcmVhdGVDbGFzcyhlLkltYWdlLmZpbHRlcnMuQmFzZUZpbHRlcix7dHlwZTpcIlJlc2l6ZVwiLHJlc2l6ZVR5cGU6XCJoZXJtaXRlXCIsc2NhbGVYOjAsc2NhbGVZOjAsbGFuY3pvc0xvYmVzOjMsYXBwbHlUbzpmdW5jdGlvbih0LGUsaSl7dGhpcy5yY3BTY2FsZVg9MS9lLHRoaXMucmNwU2NhbGVZPTEvaTt2YXIgcixzPXQud2lkdGgsbj10LmhlaWdodCxvPWEocyplKSxoPWEobippKTtcInNsaWNlSGFja1wiPT09dGhpcy5yZXNpemVUeXBlJiYocj10aGlzLnNsaWNlQnlUd28odCxzLG4sbyxoKSksXCJoZXJtaXRlXCI9PT10aGlzLnJlc2l6ZVR5cGUmJihyPXRoaXMuaGVybWl0ZUZhc3RSZXNpemUodCxzLG4sbyxoKSksXCJiaWxpbmVhclwiPT09dGhpcy5yZXNpemVUeXBlJiYocj10aGlzLmJpbGluZWFyRmlsdGVyaW5nKHQscyxuLG8saCkpLFwibGFuY3pvc1wiPT09dGhpcy5yZXNpemVUeXBlJiYocj10aGlzLmxhbmN6b3NSZXNpemUodCxzLG4sbyxoKSksdC53aWR0aD1vLHQuaGVpZ2h0PWgsdC5nZXRDb250ZXh0KFwiMmRcIikucHV0SW1hZ2VEYXRhKHIsMCwwKX0sc2xpY2VCeVR3bzpmdW5jdGlvbih0LGkscyxuLGEpe3ZhciBoLGM9dC5nZXRDb250ZXh0KFwiMmRcIiksbD0uNSx1PS41LGY9MSxkPTEsZz0hMSxwPSExLHY9aSxiPXMsbT1lLnV0aWwuY3JlYXRlQ2FudmFzRWxlbWVudCgpLHk9bS5nZXRDb250ZXh0KFwiMmRcIik7Zm9yKG49cihuKSxhPXIoYSksbS53aWR0aD1vKG4saSksbS5oZWlnaHQ9byhhLHMpLG4+aSYmKGw9MixmPS0xKSxhPnMmJih1PTIsZD0tMSksaD1jLmdldEltYWdlRGF0YSgwLDAsaSxzKSx0LndpZHRoPW8obixpKSx0LmhlaWdodD1vKGEscyksYy5wdXRJbWFnZURhdGEoaCwwLDApOyFnfHwhcDspaT12LHM9YixuKmY8cih2KmwqZik/dj1yKHYqbCk6KHY9bixnPSEwKSxhKmQ8cihiKnUqZCk/Yj1yKGIqdSk6KGI9YSxwPSEwKSxoPWMuZ2V0SW1hZ2VEYXRhKDAsMCxpLHMpLHkucHV0SW1hZ2VEYXRhKGgsMCwwKSxjLmNsZWFyUmVjdCgwLDAsdixiKSxjLmRyYXdJbWFnZShtLDAsMCxpLHMsMCwwLHYsYik7cmV0dXJuIGMuZ2V0SW1hZ2VEYXRhKDAsMCxuLGEpfSxsYW5jem9zUmVzaXplOmZ1bmN0aW9uKHQsZSxvLGEsbCl7ZnVuY3Rpb24gdSh0KXtyZXR1cm4gZnVuY3Rpb24oZSl7aWYoZT50KXJldHVybiAwO2lmKGUqPU1hdGguUEksbihlKTwxZS0xNilyZXR1cm4gMTt2YXIgaT1lL3Q7cmV0dXJuIGgoZSkqaChpKS9lL2l9fWZ1bmN0aW9uIGYodCl7dmFyIGgsYyx1LGQsZyxqLEEsUCxFLE0sSTtmb3IoVC54PSh0Ky41KSp5LGsueD1yKFQueCksaD0wO2w+aDtoKyspe2ZvcihULnk9KGgrLjUpKl8say55PXIoVC55KSxnPTAsaj0wLEE9MCxQPTAsRT0wLGM9ay54LVM7Yzw9ay54K1M7YysrKWlmKCEoMD5jfHxjPj1lKSl7TT1yKDFlMypuKGMtVC54KSksT1tNXXx8KE9bTV09e30pO2Zvcih2YXIgRD1rLnktdztEPD1rLnkrdztEKyspMD5EfHxEPj1vfHwoST1yKDFlMypuKEQtVC55KSksT1tNXVtJXXx8KE9bTV1bSV09bShzKGkoTSp4LDIpK2koSSpDLDIpKS8xZTMpKSx1PU9bTV1bSV0sdT4wJiYoZD00KihEKmUrYyksZys9dSxqKz11KnZbZF0sQSs9dSp2W2QrMV0sUCs9dSp2W2QrMl0sRSs9dSp2W2QrM10pKX1kPTQqKGgqYSt0KSxiW2RdPWovZyxiW2QrMV09QS9nLGJbZCsyXT1QL2csYltkKzNdPUUvZ31yZXR1cm4rK3Q8YT9mKHQpOnB9dmFyIGQ9dC5nZXRDb250ZXh0KFwiMmRcIiksZz1kLmdldEltYWdlRGF0YSgwLDAsZSxvKSxwPWQuZ2V0SW1hZ2VEYXRhKDAsMCxhLGwpLHY9Zy5kYXRhLGI9cC5kYXRhLG09dSh0aGlzLmxhbmN6b3NMb2JlcykseT10aGlzLnJjcFNjYWxlWCxfPXRoaXMucmNwU2NhbGVZLHg9Mi90aGlzLnJjcFNjYWxlWCxDPTIvdGhpcy5yY3BTY2FsZVksUz1jKHkqdGhpcy5sYW5jem9zTG9iZXMvMiksdz1jKF8qdGhpcy5sYW5jem9zTG9iZXMvMiksTz17fSxUPXt9LGs9e307cmV0dXJuIGYoMCl9LGJpbGluZWFyRmlsdGVyaW5nOmZ1bmN0aW9uKHQsZSxpLHMsbil7dmFyIG8sYSxoLGMsbCx1LGYsZCxnLHAsdixiLG0seT0wLF89dGhpcy5yY3BTY2FsZVgseD10aGlzLnJjcFNjYWxlWSxDPXQuZ2V0Q29udGV4dChcIjJkXCIpLFM9NCooZS0xKSx3PUMuZ2V0SW1hZ2VEYXRhKDAsMCxlLGkpLE89dy5kYXRhLFQ9Qy5nZXRJbWFnZURhdGEoMCwwLHMsbiksaz1ULmRhdGE7Zm9yKGY9MDtuPmY7ZisrKWZvcihkPTA7cz5kO2QrKylmb3IobD1yKF8qZCksdT1yKHgqZiksZz1fKmQtbCxwPXgqZi11LG09NCoodSplK2wpLHY9MDs0PnY7disrKW89T1ttK3ZdLGE9T1ttKzQrdl0saD1PW20rUyt2XSxjPU9bbStTKzQrdl0sYj1vKigxLWcpKigxLXApK2EqZyooMS1wKStoKnAqKDEtZykrYypnKnAsa1t5KytdPWI7cmV0dXJuIFR9LGhlcm1pdGVGYXN0UmVzaXplOmZ1bmN0aW9uKHQsZSxpLG8sYSl7Zm9yKHZhciBoPXRoaXMucmNwU2NhbGVYLGw9dGhpcy5yY3BTY2FsZVksdT1jKGgvMiksZj1jKGwvMiksZD10LmdldENvbnRleHQoXCIyZFwiKSxnPWQuZ2V0SW1hZ2VEYXRhKDAsMCxlLGkpLHA9Zy5kYXRhLHY9ZC5nZXRJbWFnZURhdGEoMCwwLG8sYSksYj12LmRhdGEsbT0wO2E+bTttKyspZm9yKHZhciB5PTA7bz55O3krKyl7Zm9yKHZhciBfPTQqKHkrbSpvKSx4PTAsQz0wLFM9MCx3PTAsTz0wLFQ9MCxrPTAsaj0obSsuNSkqbCxBPXIobSpsKTsobSsxKSpsPkE7QSsrKWZvcih2YXIgUD1uKGotKEErLjUpKS9mLEU9KHkrLjUpKmgsTT1QKlAsST1yKHkqaCk7KHkrMSkqaD5JO0krKyl7dmFyIEQ9bihFLShJKy41KSkvdSxMPXMoTStEKkQpO0w+MSYmLTE+THx8KHg9MipMKkwqTC0zKkwqTCsxLHg+MCYmKEQ9NCooSStBKmUpLGsrPXgqcFtEKzNdLFMrPXgscFtEKzNdPDI1NSYmKHg9eCpwW0QrM10vMjUwKSx3Kz14KnBbRF0sTys9eCpwW0QrMV0sVCs9eCpwW0QrMl0sQys9eCkpfWJbX109dy9DLGJbXysxXT1PL0MsYltfKzJdPVQvQyxiW18rM109ay9TfXJldHVybiB2fSx0b09iamVjdDpmdW5jdGlvbigpe3JldHVybnt0eXBlOnRoaXMudHlwZSxzY2FsZVg6dGhpcy5zY2FsZVgsc2NhbGVZOnRoaXMuc2NhbGVZLHJlc2l6ZVR5cGU6dGhpcy5yZXNpemVUeXBlLGxhbmN6b3NMb2Jlczp0aGlzLmxhbmN6b3NMb2Jlc319fSksZS5JbWFnZS5maWx0ZXJzLlJlc2l6ZS5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5JbWFnZS5maWx0ZXJzLlJlc2l6ZSh0KX19KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSksaT1lLnV0aWwub2JqZWN0LmV4dGVuZCxyPWUudXRpbC5vYmplY3QuY2xvbmUscz1lLnV0aWwudG9GaXhlZCxuPWUuU3RhdGljQ2FudmFzLnN1cHBvcnRzKFwic2V0TGluZURhc2hcIiksbz1lLk9iamVjdC5OVU1fRlJBQ1RJT05fRElHSVRTO2lmKGUuVGV4dClyZXR1cm4gdm9pZCBlLndhcm4oXCJmYWJyaWMuVGV4dCBpcyBhbHJlYWR5IGRlZmluZWRcIik7dmFyIGE9ZS5PYmplY3QucHJvdG90eXBlLnN0YXRlUHJvcGVydGllcy5jb25jYXQoKTthLnB1c2goXCJmb250RmFtaWx5XCIsXCJmb250V2VpZ2h0XCIsXCJmb250U2l6ZVwiLFwidGV4dFwiLFwidGV4dERlY29yYXRpb25cIixcInRleHRBbGlnblwiLFwiZm9udFN0eWxlXCIsXCJsaW5lSGVpZ2h0XCIsXCJ0ZXh0QmFja2dyb3VuZENvbG9yXCIpLGUuVGV4dD1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5PYmplY3Qse19kaW1lbnNpb25BZmZlY3RpbmdQcm9wczp7Zm9udFNpemU6ITAsZm9udFdlaWdodDohMCxmb250RmFtaWx5OiEwLGZvbnRTdHlsZTohMCxsaW5lSGVpZ2h0OiEwLHN0cm9rZTohMCxzdHJva2VXaWR0aDohMCx0ZXh0OiEwLHRleHRBbGlnbjohMH0sX3JlTmV3bGluZTovXFxyP1xcbi8sdHlwZTpcInRleHRcIixmb250U2l6ZTo0MCxmb250V2VpZ2h0Olwibm9ybWFsXCIsZm9udEZhbWlseTpcIlRpbWVzIE5ldyBSb21hblwiLHRleHREZWNvcmF0aW9uOlwiXCIsdGV4dEFsaWduOlwibGVmdFwiLGZvbnRTdHlsZTpcIlwiLGxpbmVIZWlnaHQ6MS4xNix0ZXh0QmFja2dyb3VuZENvbG9yOlwiXCIsc3RhdGVQcm9wZXJ0aWVzOmEsc3Ryb2tlOm51bGwsc2hhZG93Om51bGwsX2ZvbnRTaXplRnJhY3Rpb246LjI1LF9mb250U2l6ZU11bHQ6MS4xMyxpbml0aWFsaXplOmZ1bmN0aW9uKHQsZSl7ZT1lfHx7fSx0aGlzLnRleHQ9dCx0aGlzLl9fc2tpcERpbWVuc2lvbj0hMCx0aGlzLnNldE9wdGlvbnMoZSksdGhpcy5fX3NraXBEaW1lbnNpb249ITEsdGhpcy5faW5pdERpbWVuc2lvbnMoKX0sX2luaXREaW1lbnNpb25zOmZ1bmN0aW9uKHQpe2lmKCF0aGlzLl9fc2tpcERpbWVuc2lvbil7dHx8KHQ9ZS51dGlsLmNyZWF0ZUNhbnZhc0VsZW1lbnQoKS5nZXRDb250ZXh0KFwiMmRcIiksdGhpcy5fc2V0VGV4dFN0eWxlcyh0KSksdGhpcy5fdGV4dExpbmVzPXRoaXMudGV4dC5zcGxpdCh0aGlzLl9yZU5ld2xpbmUpLHRoaXMuX2NsZWFyQ2FjaGUoKTt2YXIgaT10aGlzLnRleHRBbGlnbjt0aGlzLnRleHRBbGlnbj1cImxlZnRcIix0aGlzLndpZHRoPXRoaXMuX2dldFRleHRXaWR0aCh0KSx0aGlzLnRleHRBbGlnbj1pLHRoaXMuaGVpZ2h0PXRoaXMuX2dldFRleHRIZWlnaHQodCl9fSx0b1N0cmluZzpmdW5jdGlvbigpe3JldHVyblwiIzxmYWJyaWMuVGV4dCAoXCIrdGhpcy5jb21wbGV4aXR5KCkrJyk6IHsgXCJ0ZXh0XCI6IFwiJyt0aGlzLnRleHQrJ1wiLCBcImZvbnRGYW1pbHlcIjogXCInK3RoaXMuZm9udEZhbWlseSsnXCIgfT4nfSxfcmVuZGVyOmZ1bmN0aW9uKHQpe3RoaXMuY2xpcFRvJiZlLnV0aWwuY2xpcENvbnRleHQodGhpcyx0KSx0aGlzLl9yZW5kZXJUZXh0QmFja2dyb3VuZCh0KSx0aGlzLl9yZW5kZXJUZXh0KHQpLHRoaXMuX3JlbmRlclRleHREZWNvcmF0aW9uKHQpLHRoaXMuY2xpcFRvJiZ0LnJlc3RvcmUoKX0sX3JlbmRlclRleHQ6ZnVuY3Rpb24odCl7dC5zYXZlKCksdGhpcy5fdHJhbnNsYXRlRm9yVGV4dEFsaWduKHQpLHRoaXMuX3NldE9wYWNpdHkodCksdGhpcy5fc2V0U2hhZG93KHQpLHRoaXMuX3NldHVwQ29tcG9zaXRlT3BlcmF0aW9uKHQpLHRoaXMuX3JlbmRlclRleHRGaWxsKHQpLHRoaXMuX3JlbmRlclRleHRTdHJva2UodCksdC5yZXN0b3JlKCl9LF90cmFuc2xhdGVGb3JUZXh0QWxpZ246ZnVuY3Rpb24odCl7XCJsZWZ0XCIhPT10aGlzLnRleHRBbGlnbiYmXCJqdXN0aWZ5XCIhPT10aGlzLnRleHRBbGlnbiYmdC50cmFuc2xhdGUoXCJjZW50ZXJcIj09PXRoaXMudGV4dEFsaWduP3RoaXMud2lkdGgvMjp0aGlzLndpZHRoLDApfSxfc2V0VGV4dFN0eWxlczpmdW5jdGlvbih0KXt0LnRleHRCYXNlbGluZT1cImFscGhhYmV0aWNcIix0aGlzLnNraXBUZXh0QWxpZ258fCh0LnRleHRBbGlnbj10aGlzLnRleHRBbGlnbiksdC5mb250PXRoaXMuX2dldEZvbnREZWNsYXJhdGlvbigpfSxfZ2V0VGV4dEhlaWdodDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl90ZXh0TGluZXMubGVuZ3RoKnRoaXMuX2dldEhlaWdodE9mTGluZSgpfSxfZ2V0VGV4dFdpZHRoOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10aGlzLl9nZXRMaW5lV2lkdGgodCwwKSxpPTEscj10aGlzLl90ZXh0TGluZXMubGVuZ3RoO3I+aTtpKyspe3ZhciBzPXRoaXMuX2dldExpbmVXaWR0aCh0LGkpO3M+ZSYmKGU9cyl9cmV0dXJuIGV9LF9yZW5kZXJDaGFyczpmdW5jdGlvbih0LGUsaSxyLHMpe3ZhciBuPXQuc2xpY2UoMCwtNCk7aWYodGhpc1tuXS50b0xpdmUpe3ZhciBvPS10aGlzLndpZHRoLzIrdGhpc1tuXS5vZmZzZXRYfHwwLGE9LXRoaXMuaGVpZ2h0LzIrdGhpc1tuXS5vZmZzZXRZfHwwO2Uuc2F2ZSgpLGUudHJhbnNsYXRlKG8sYSksci09byxzLT1hfWVbdF0oaSxyLHMpLHRoaXNbbl0udG9MaXZlJiZlLnJlc3RvcmUoKX0sX3JlbmRlclRleHRMaW5lOmZ1bmN0aW9uKHQsZSxpLHIscyxuKXtpZihzLT10aGlzLmZvbnRTaXplKnRoaXMuX2ZvbnRTaXplRnJhY3Rpb24sXCJqdXN0aWZ5XCIhPT10aGlzLnRleHRBbGlnbilyZXR1cm4gdm9pZCB0aGlzLl9yZW5kZXJDaGFycyh0LGUsaSxyLHMsbik7dmFyIG89dGhpcy5fZ2V0TGluZVdpZHRoKGUsbiksYT10aGlzLndpZHRoO2lmKGE+PW8pZm9yKHZhciBoPWkuc3BsaXQoL1xccysvKSxjPXRoaXMuX2dldFdpZHRoT2ZXb3JkcyhlLGksbiksbD1hLWMsdT1oLmxlbmd0aC0xLGY9bC91LGQ9MCxnPTAscD1oLmxlbmd0aDtwPmc7ZysrKXRoaXMuX3JlbmRlckNoYXJzKHQsZSxoW2ddLHIrZCxzLG4pLGQrPWUubWVhc3VyZVRleHQoaFtnXSkud2lkdGgrZjtlbHNlIHRoaXMuX3JlbmRlckNoYXJzKHQsZSxpLHIscyxuKX0sX2dldFdpZHRoT2ZXb3JkczpmdW5jdGlvbih0LGUpe3JldHVybiB0Lm1lYXN1cmVUZXh0KGUucmVwbGFjZSgvXFxzKy9nLFwiXCIpKS53aWR0aH0sX2dldExlZnRPZmZzZXQ6ZnVuY3Rpb24oKXtyZXR1cm4tdGhpcy53aWR0aC8yfSxfZ2V0VG9wT2Zmc2V0OmZ1bmN0aW9uKCl7cmV0dXJuLXRoaXMuaGVpZ2h0LzJ9LF9yZW5kZXJUZXh0RmlsbDpmdW5jdGlvbih0KXtpZih0aGlzLmZpbGx8fHRoaXMuX3NraXBGaWxsU3Ryb2tlQ2hlY2spZm9yKHZhciBlPTAsaT0wLHI9dGhpcy5fdGV4dExpbmVzLmxlbmd0aDtyPmk7aSsrKXt2YXIgcz10aGlzLl9nZXRIZWlnaHRPZkxpbmUodCxpKSxuPXMvdGhpcy5saW5lSGVpZ2h0O3RoaXMuX3JlbmRlclRleHRMaW5lKFwiZmlsbFRleHRcIix0LHRoaXMuX3RleHRMaW5lc1tpXSx0aGlzLl9nZXRMZWZ0T2Zmc2V0KCksdGhpcy5fZ2V0VG9wT2Zmc2V0KCkrZStuLGkpLGUrPXN9fSxfcmVuZGVyVGV4dFN0cm9rZTpmdW5jdGlvbih0KXtpZih0aGlzLnN0cm9rZSYmMCE9PXRoaXMuc3Ryb2tlV2lkdGh8fHRoaXMuX3NraXBGaWxsU3Ryb2tlQ2hlY2spe3ZhciBlPTA7dGhpcy5zaGFkb3cmJiF0aGlzLnNoYWRvdy5hZmZlY3RTdHJva2UmJnRoaXMuX3JlbW92ZVNoYWRvdyh0KSx0LnNhdmUoKSx0aGlzLnN0cm9rZURhc2hBcnJheSYmKDEmdGhpcy5zdHJva2VEYXNoQXJyYXkubGVuZ3RoJiZ0aGlzLnN0cm9rZURhc2hBcnJheS5wdXNoLmFwcGx5KHRoaXMuc3Ryb2tlRGFzaEFycmF5LHRoaXMuc3Ryb2tlRGFzaEFycmF5KSxuJiZ0LnNldExpbmVEYXNoKHRoaXMuc3Ryb2tlRGFzaEFycmF5KSksdC5iZWdpblBhdGgoKTtmb3IodmFyIGk9MCxyPXRoaXMuX3RleHRMaW5lcy5sZW5ndGg7cj5pO2krKyl7dmFyIHM9dGhpcy5fZ2V0SGVpZ2h0T2ZMaW5lKHQsaSksbz1zL3RoaXMubGluZUhlaWdodDt0aGlzLl9yZW5kZXJUZXh0TGluZShcInN0cm9rZVRleHRcIix0LHRoaXMuX3RleHRMaW5lc1tpXSx0aGlzLl9nZXRMZWZ0T2Zmc2V0KCksdGhpcy5fZ2V0VG9wT2Zmc2V0KCkrZStvLGkpLGUrPXN9dC5jbG9zZVBhdGgoKSx0LnJlc3RvcmUoKX19LF9nZXRIZWlnaHRPZkxpbmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mb250U2l6ZSp0aGlzLl9mb250U2l6ZU11bHQqdGhpcy5saW5lSGVpZ2h0fSxfcmVuZGVyVGV4dEJhY2tncm91bmQ6ZnVuY3Rpb24odCl7dGhpcy5fcmVuZGVyVGV4dEJveEJhY2tncm91bmQodCksdGhpcy5fcmVuZGVyVGV4dExpbmVzQmFja2dyb3VuZCh0KX0sX3JlbmRlclRleHRCb3hCYWNrZ3JvdW5kOmZ1bmN0aW9uKHQpe3RoaXMuYmFja2dyb3VuZENvbG9yJiYodC5zYXZlKCksdC5maWxsU3R5bGU9dGhpcy5iYWNrZ3JvdW5kQ29sb3IsdC5maWxsUmVjdCh0aGlzLl9nZXRMZWZ0T2Zmc2V0KCksdGhpcy5fZ2V0VG9wT2Zmc2V0KCksdGhpcy53aWR0aCx0aGlzLmhlaWdodCksdC5yZXN0b3JlKCkpfSxfcmVuZGVyVGV4dExpbmVzQmFja2dyb3VuZDpmdW5jdGlvbih0KXt2YXIgZT0wLGk9dGhpcy5fZ2V0SGVpZ2h0T2ZMaW5lKCk7aWYodGhpcy50ZXh0QmFja2dyb3VuZENvbG9yKXt0LnNhdmUoKSx0LmZpbGxTdHlsZT10aGlzLnRleHRCYWNrZ3JvdW5kQ29sb3I7Zm9yKHZhciByPTAscz10aGlzLl90ZXh0TGluZXMubGVuZ3RoO3M+cjtyKyspe2lmKFwiXCIhPT10aGlzLl90ZXh0TGluZXNbcl0pe3ZhciBuPXRoaXMuX2dldExpbmVXaWR0aCh0LHIpLG89dGhpcy5fZ2V0TGluZUxlZnRPZmZzZXQobik7dC5maWxsUmVjdCh0aGlzLl9nZXRMZWZ0T2Zmc2V0KCkrbyx0aGlzLl9nZXRUb3BPZmZzZXQoKStlLG4sdGhpcy5mb250U2l6ZSp0aGlzLl9mb250U2l6ZU11bHQpfWUrPWl9dC5yZXN0b3JlKCl9fSxfZ2V0TGluZUxlZnRPZmZzZXQ6ZnVuY3Rpb24odCl7cmV0dXJuXCJjZW50ZXJcIj09PXRoaXMudGV4dEFsaWduPyh0aGlzLndpZHRoLXQpLzI6XCJyaWdodFwiPT09dGhpcy50ZXh0QWxpZ24/dGhpcy53aWR0aC10OjB9LF9jbGVhckNhY2hlOmZ1bmN0aW9uKCl7dGhpcy5fX2xpbmVXaWR0aHM9W10sdGhpcy5fX2xpbmVIZWlnaHRzPVtdLHRoaXMuX19saW5lT2Zmc2V0cz1bXX0sX3Nob3VsZENsZWFyQ2FjaGU6ZnVuY3Rpb24oKXt2YXIgdD0hMTtmb3IodmFyIGUgaW4gdGhpcy5fZGltZW5zaW9uQWZmZWN0aW5nUHJvcHMpdGhpc1tcIl9fXCIrZV0hPT10aGlzW2VdJiYodGhpc1tcIl9fXCIrZV09dGhpc1tlXSx0PSEwKTtyZXR1cm4gdH0sX2dldExpbmVXaWR0aDpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLl9fbGluZVdpZHRoc1tlXT90aGlzLl9fbGluZVdpZHRoc1tlXToodGhpcy5fX2xpbmVXaWR0aHNbZV09dC5tZWFzdXJlVGV4dCh0aGlzLl90ZXh0TGluZXNbZV0pLndpZHRoLHRoaXMuX19saW5lV2lkdGhzW2VdKX0sX3JlbmRlclRleHREZWNvcmF0aW9uOmZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoZSl7dmFyIHMsbixvLGEsaD0wO2ZvcihzPTAsbj1yLl90ZXh0TGluZXMubGVuZ3RoO24+cztzKyspe3ZhciBjPXIuX2dldExpbmVXaWR0aCh0LHMpLGw9ci5fZ2V0TGluZUxlZnRPZmZzZXQoYyksdT1yLl9nZXRIZWlnaHRPZkxpbmUodCxzKTtmb3Iobz0wLGE9ZS5sZW5ndGg7YT5vO28rKyl0LmZpbGxSZWN0KHIuX2dldExlZnRPZmZzZXQoKStsLGgrKHIuX2ZvbnRTaXplTXVsdC0xK2Vbb10pKnIuZm9udFNpemUtaSxjLHIuZm9udFNpemUvMTUpO2grPXV9fWlmKHRoaXMudGV4dERlY29yYXRpb24pe3ZhciBpPXRoaXMuaGVpZ2h0LzIscj10aGlzLHM9W107dGhpcy50ZXh0RGVjb3JhdGlvbi5pbmRleE9mKFwidW5kZXJsaW5lXCIpPi0xJiZzLnB1c2goLjg1KSx0aGlzLnRleHREZWNvcmF0aW9uLmluZGV4T2YoXCJsaW5lLXRocm91Z2hcIik+LTEmJnMucHVzaCguNDMpLHRoaXMudGV4dERlY29yYXRpb24uaW5kZXhPZihcIm92ZXJsaW5lXCIpPi0xJiZzLnB1c2goLS4xMikscy5sZW5ndGg+MCYmZShzKX19LF9nZXRGb250RGVjbGFyYXRpb246ZnVuY3Rpb24oKXtyZXR1cm5bZS5pc0xpa2VseU5vZGU/dGhpcy5mb250V2VpZ2h0OnRoaXMuZm9udFN0eWxlLGUuaXNMaWtlbHlOb2RlP3RoaXMuZm9udFN0eWxlOnRoaXMuZm9udFdlaWdodCx0aGlzLmZvbnRTaXplK1wicHhcIixlLmlzTGlrZWx5Tm9kZT8nXCInK3RoaXMuZm9udEZhbWlseSsnXCInOnRoaXMuZm9udEZhbWlseV0uam9pbihcIiBcIil9LHJlbmRlcjpmdW5jdGlvbih0LGUpe3RoaXMudmlzaWJsZSYmKHQuc2F2ZSgpLHRoaXMuX3NldFRleHRTdHlsZXModCksdGhpcy5fc2hvdWxkQ2xlYXJDYWNoZSgpJiZ0aGlzLl9pbml0RGltZW5zaW9ucyh0KSxlfHx0aGlzLnRyYW5zZm9ybSh0KSx0aGlzLl9zZXRTdHJva2VTdHlsZXModCksdGhpcy5fc2V0RmlsbFN0eWxlcyh0KSx0aGlzLnRyYW5zZm9ybU1hdHJpeCYmdC50cmFuc2Zvcm0uYXBwbHkodCx0aGlzLnRyYW5zZm9ybU1hdHJpeCksdGhpcy5ncm91cCYmXCJwYXRoLWdyb3VwXCI9PT10aGlzLmdyb3VwLnR5cGUmJnQudHJhbnNsYXRlKHRoaXMubGVmdCx0aGlzLnRvcCksdGhpcy5fcmVuZGVyKHQpLHQucmVzdG9yZSgpKX0sdG9PYmplY3Q6ZnVuY3Rpb24odCl7dmFyIGU9aSh0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIsdCkse3RleHQ6dGhpcy50ZXh0LGZvbnRTaXplOnRoaXMuZm9udFNpemUsZm9udFdlaWdodDp0aGlzLmZvbnRXZWlnaHQsZm9udEZhbWlseTp0aGlzLmZvbnRGYW1pbHksZm9udFN0eWxlOnRoaXMuZm9udFN0eWxlLGxpbmVIZWlnaHQ6dGhpcy5saW5lSGVpZ2h0LHRleHREZWNvcmF0aW9uOnRoaXMudGV4dERlY29yYXRpb24sdGV4dEFsaWduOnRoaXMudGV4dEFsaWduLHRleHRCYWNrZ3JvdW5kQ29sb3I6dGhpcy50ZXh0QmFja2dyb3VuZENvbG9yfSk7cmV0dXJuIHRoaXMuaW5jbHVkZURlZmF1bHRWYWx1ZXN8fHRoaXMuX3JlbW92ZURlZmF1bHRWYWx1ZXMoZSksZX0sdG9TVkc6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fY3JlYXRlQmFzZVNWR01hcmt1cCgpLGk9dGhpcy5fZ2V0U1ZHTGVmdFRvcE9mZnNldHModGhpcy5jdHgpLHI9dGhpcy5fZ2V0U1ZHVGV4dEFuZEJnKGkudGV4dFRvcCxpLnRleHRMZWZ0KTtyZXR1cm4gdGhpcy5fd3JhcFNWR1RleHRBbmRCZyhlLHIpLHQ/dChlLmpvaW4oXCJcIikpOmUuam9pbihcIlwiKX0sX2dldFNWR0xlZnRUb3BPZmZzZXRzOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX2dldEhlaWdodE9mTGluZSh0LDApLGk9LXRoaXMud2lkdGgvMixyPTA7cmV0dXJue3RleHRMZWZ0OmkrKHRoaXMuZ3JvdXAmJlwicGF0aC1ncm91cFwiPT09dGhpcy5ncm91cC50eXBlP3RoaXMubGVmdDowKSx0ZXh0VG9wOnIrKHRoaXMuZ3JvdXAmJlwicGF0aC1ncm91cFwiPT09dGhpcy5ncm91cC50eXBlPy10aGlzLnRvcDowKSxsaW5lVG9wOmV9fSxfd3JhcFNWR1RleHRBbmRCZzpmdW5jdGlvbih0LGUpe3QucHVzaCgnXHQ8ZyB0cmFuc2Zvcm09XCInLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtKCksdGhpcy5nZXRTdmdUcmFuc2Zvcm1NYXRyaXgoKSwnXCI+XFxuJyxlLnRleHRCZ1JlY3RzLmpvaW4oXCJcIiksXCJcdFx0PHRleHQgXCIsdGhpcy5mb250RmFtaWx5Pydmb250LWZhbWlseT1cIicrdGhpcy5mb250RmFtaWx5LnJlcGxhY2UoL1wiL2csXCInXCIpKydcIiAnOlwiXCIsdGhpcy5mb250U2l6ZT8nZm9udC1zaXplPVwiJyt0aGlzLmZvbnRTaXplKydcIiAnOlwiXCIsdGhpcy5mb250U3R5bGU/J2ZvbnQtc3R5bGU9XCInK3RoaXMuZm9udFN0eWxlKydcIiAnOlwiXCIsdGhpcy5mb250V2VpZ2h0Pydmb250LXdlaWdodD1cIicrdGhpcy5mb250V2VpZ2h0KydcIiAnOlwiXCIsdGhpcy50ZXh0RGVjb3JhdGlvbj8ndGV4dC1kZWNvcmF0aW9uPVwiJyt0aGlzLnRleHREZWNvcmF0aW9uKydcIiAnOlwiXCIsJ3N0eWxlPVwiJyx0aGlzLmdldFN2Z1N0eWxlcygpLCdcIiA+JyxlLnRleHRTcGFucy5qb2luKFwiXCIpLFwiPC90ZXh0PlxcblwiLFwiXHQ8L2c+XFxuXCIpfSxfZ2V0U1ZHVGV4dEFuZEJnOmZ1bmN0aW9uKHQsZSl7dmFyIGk9W10scj1bXSxzPTA7dGhpcy5fc2V0U1ZHQmcocik7Zm9yKHZhciBuPTAsbz10aGlzLl90ZXh0TGluZXMubGVuZ3RoO28+bjtuKyspdGhpcy50ZXh0QmFja2dyb3VuZENvbG9yJiZ0aGlzLl9zZXRTVkdUZXh0TGluZUJnKHIsbixlLHQscyksdGhpcy5fc2V0U1ZHVGV4dExpbmVUZXh0KG4saSxzLGUsdCxyKSxzKz10aGlzLl9nZXRIZWlnaHRPZkxpbmUodGhpcy5jdHgsbik7cmV0dXJue3RleHRTcGFuczppLHRleHRCZ1JlY3RzOnJ9fSxfc2V0U1ZHVGV4dExpbmVUZXh0OmZ1bmN0aW9uKHQsaSxyLG4sYSl7dmFyIGg9dGhpcy5mb250U2l6ZSoodGhpcy5fZm9udFNpemVNdWx0LXRoaXMuX2ZvbnRTaXplRnJhY3Rpb24pLWErci10aGlzLmhlaWdodC8yO2kucHVzaCgnPHRzcGFuIHg9XCInLHMobit0aGlzLl9nZXRMaW5lTGVmdE9mZnNldCh0aGlzLl9fbGluZVdpZHRoc1t0XSksbyksJ1wiICcsJ3k9XCInLHMoaCxvKSwnXCIgJyx0aGlzLl9nZXRGaWxsQXR0cmlidXRlcyh0aGlzLmZpbGwpLFwiPlwiLGUudXRpbC5zdHJpbmcuZXNjYXBlWG1sKHRoaXMuX3RleHRMaW5lc1t0XSksXCI8L3RzcGFuPlwiKX0sX3NldFNWR1RleHRMaW5lQmc6ZnVuY3Rpb24odCxlLGkscixuKXt0LnB1c2goXCJcdFx0PHJlY3QgXCIsdGhpcy5fZ2V0RmlsbEF0dHJpYnV0ZXModGhpcy50ZXh0QmFja2dyb3VuZENvbG9yKSwnIHg9XCInLHMoaSt0aGlzLl9nZXRMaW5lTGVmdE9mZnNldCh0aGlzLl9fbGluZVdpZHRoc1tlXSksbyksJ1wiIHk9XCInLHMobi10aGlzLmhlaWdodC8yLG8pLCdcIiB3aWR0aD1cIicscyh0aGlzLl9fbGluZVdpZHRoc1tlXSxvKSwnXCIgaGVpZ2h0PVwiJyxzKHRoaXMuX2dldEhlaWdodE9mTGluZSh0aGlzLmN0eCxlKS90aGlzLmxpbmVIZWlnaHQsbyksJ1wiPjwvcmVjdD5cXG4nKX0sX3NldFNWR0JnOmZ1bmN0aW9uKHQpe3RoaXMuYmFja2dyb3VuZENvbG9yJiZ0LnB1c2goXCJcdFx0PHJlY3QgXCIsdGhpcy5fZ2V0RmlsbEF0dHJpYnV0ZXModGhpcy5iYWNrZ3JvdW5kQ29sb3IpLCcgeD1cIicscygtdGhpcy53aWR0aC8yLG8pLCdcIiB5PVwiJyxzKC10aGlzLmhlaWdodC8yLG8pLCdcIiB3aWR0aD1cIicscyh0aGlzLndpZHRoLG8pLCdcIiBoZWlnaHQ9XCInLHModGhpcy5oZWlnaHQsbyksJ1wiPjwvcmVjdD5cXG4nKX0sX2dldEZpbGxBdHRyaWJ1dGVzOmZ1bmN0aW9uKHQpe3ZhciBpPXQmJlwic3RyaW5nXCI9PXR5cGVvZiB0P25ldyBlLkNvbG9yKHQpOlwiXCI7cmV0dXJuIGkmJmkuZ2V0U291cmNlKCkmJjEhPT1pLmdldEFscGhhKCk/J29wYWNpdHk9XCInK2kuZ2V0QWxwaGEoKSsnXCIgZmlsbD1cIicraS5zZXRBbHBoYSgxKS50b1JnYigpKydcIic6J2ZpbGw9XCInK3QrJ1wiJ30sX3NldDpmdW5jdGlvbih0LGUpe3RoaXMuY2FsbFN1cGVyKFwiX3NldFwiLHQsZSksdCBpbiB0aGlzLl9kaW1lbnNpb25BZmZlY3RpbmdQcm9wcyYmKHRoaXMuX2luaXREaW1lbnNpb25zKCksdGhpcy5zZXRDb29yZHMoKSl9LGNvbXBsZXhpdHk6ZnVuY3Rpb24oKXtyZXR1cm4gMX19KSxlLlRleHQuQVRUUklCVVRFX05BTUVTPWUuU0hBUkVEX0FUVFJJQlVURVMuY29uY2F0KFwieCB5IGR4IGR5IGZvbnQtZmFtaWx5IGZvbnQtc3R5bGUgZm9udC13ZWlnaHQgZm9udC1zaXplIHRleHQtZGVjb3JhdGlvbiB0ZXh0LWFuY2hvclwiLnNwbGl0KFwiIFwiKSksZS5UZXh0LkRFRkFVTFRfU1ZHX0ZPTlRfU0laRT0xNixlLlRleHQuZnJvbUVsZW1lbnQ9ZnVuY3Rpb24odCxpKXtpZighdClyZXR1cm4gbnVsbDt2YXIgcj1lLnBhcnNlQXR0cmlidXRlcyh0LGUuVGV4dC5BVFRSSUJVVEVfTkFNRVMpO2k9ZS51dGlsLm9iamVjdC5leHRlbmQoaT9lLnV0aWwub2JqZWN0LmNsb25lKGkpOnt9LHIpLGkudG9wPWkudG9wfHwwLGkubGVmdD1pLmxlZnR8fDAsXCJkeFwiaW4gciYmKGkubGVmdCs9ci5keCksXCJkeVwiaW4gciYmKGkudG9wKz1yLmR5KSxcImZvbnRTaXplXCJpbiBpfHwoaS5mb250U2l6ZT1lLlRleHQuREVGQVVMVF9TVkdfRk9OVF9TSVpFKSxpLm9yaWdpblh8fChpLm9yaWdpblg9XCJsZWZ0XCIpO3ZhciBzPXQudGV4dENvbnRlbnQucmVwbGFjZSgvXlxccyt8XFxzKyR8XFxuKy9nLFwiXCIpLnJlcGxhY2UoL1xccysvZyxcIiBcIiksbj1uZXcgZS5UZXh0KHMsaSksbz0wO3JldHVyblwibGVmdFwiPT09bi5vcmlnaW5YJiYobz1uLmdldFdpZHRoKCkvMiksXCJyaWdodFwiPT09bi5vcmlnaW5YJiYobz0tbi5nZXRXaWR0aCgpLzIpLG4uc2V0KHtsZWZ0Om4uZ2V0TGVmdCgpK28sdG9wOm4uZ2V0VG9wKCktbi5nZXRIZWlnaHQoKS8yK24uZm9udFNpemUqKC4xOCtuLl9mb250U2l6ZUZyYWN0aW9uKX0pLG59LGUuVGV4dC5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5UZXh0KHQudGV4dCxyKHQpKX0sZS51dGlsLmNyZWF0ZUFjY2Vzc29ycyhlLlRleHQpfShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKCl7dmFyIHQ9ZmFicmljLnV0aWwub2JqZWN0LmNsb25lO2ZhYnJpYy5JVGV4dD1mYWJyaWMudXRpbC5jcmVhdGVDbGFzcyhmYWJyaWMuVGV4dCxmYWJyaWMuT2JzZXJ2YWJsZSx7dHlwZTpcImktdGV4dFwiLHNlbGVjdGlvblN0YXJ0OjAsc2VsZWN0aW9uRW5kOjAsc2VsZWN0aW9uQ29sb3I6XCJyZ2JhKDE3LDExOSwyNTUsMC4zKVwiLGlzRWRpdGluZzohMSxlZGl0YWJsZTohMCxlZGl0aW5nQm9yZGVyQ29sb3I6XCJyZ2JhKDEwMiwxNTMsMjU1LDAuMjUpXCIsY3Vyc29yV2lkdGg6MixjdXJzb3JDb2xvcjpcIiMzMzNcIixjdXJzb3JEZWxheToxZTMsY3Vyc29yRHVyYXRpb246NjAwLHN0eWxlczpudWxsLGNhY2hpbmc6ITAsX3NraXBGaWxsU3Ryb2tlQ2hlY2s6ITEsX3JlU3BhY2U6L1xcc3xcXG4vLF9jdXJyZW50Q3Vyc29yT3BhY2l0eTowLF9zZWxlY3Rpb25EaXJlY3Rpb246bnVsbCxfYWJvcnRDdXJzb3JBbmltYXRpb246ITEsX2NoYXJXaWR0aHNDYWNoZTp7fSxpbml0aWFsaXplOmZ1bmN0aW9uKHQsZSl7dGhpcy5zdHlsZXM9ZT9lLnN0eWxlc3x8e306e30sdGhpcy5jYWxsU3VwZXIoXCJpbml0aWFsaXplXCIsdCxlKSx0aGlzLmluaXRCZWhhdmlvcigpfSxfY2xlYXJDYWNoZTpmdW5jdGlvbigpe3RoaXMuY2FsbFN1cGVyKFwiX2NsZWFyQ2FjaGVcIiksdGhpcy5fX21heEZvbnRIZWlnaHRzPVtdLHRoaXMuX193aWR0aE9mU3BhY2U9W119LGlzRW1wdHlTdHlsZXM6ZnVuY3Rpb24oKXtpZighdGhpcy5zdHlsZXMpcmV0dXJuITA7dmFyIHQ9dGhpcy5zdHlsZXM7Zm9yKHZhciBlIGluIHQpZm9yKHZhciBpIGluIHRbZV0pZm9yKHZhciByIGluIHRbZV1baV0pcmV0dXJuITE7cmV0dXJuITB9LHNldFNlbGVjdGlvblN0YXJ0OmZ1bmN0aW9uKHQpe3Q9TWF0aC5tYXgodCwwKSx0aGlzLnNlbGVjdGlvblN0YXJ0IT09dCYmKHRoaXMuZmlyZShcInNlbGVjdGlvbjpjaGFuZ2VkXCIpLHRoaXMuY2FudmFzJiZ0aGlzLmNhbnZhcy5maXJlKFwidGV4dDpzZWxlY3Rpb246Y2hhbmdlZFwiLHt0YXJnZXQ6dGhpc30pLHRoaXMuc2VsZWN0aW9uU3RhcnQ9dCksdGhpcy5fdXBkYXRlVGV4dGFyZWEoKX0sc2V0U2VsZWN0aW9uRW5kOmZ1bmN0aW9uKHQpe3Q9TWF0aC5taW4odCx0aGlzLnRleHQubGVuZ3RoKSx0aGlzLnNlbGVjdGlvbkVuZCE9PXQmJih0aGlzLmZpcmUoXCJzZWxlY3Rpb246Y2hhbmdlZFwiKSx0aGlzLmNhbnZhcyYmdGhpcy5jYW52YXMuZmlyZShcInRleHQ6c2VsZWN0aW9uOmNoYW5nZWRcIix7dGFyZ2V0OnRoaXN9KSx0aGlzLnNlbGVjdGlvbkVuZD10KSx0aGlzLl91cGRhdGVUZXh0YXJlYSgpfSxnZXRTZWxlY3Rpb25TdHlsZXM6ZnVuY3Rpb24odCxlKXtpZigyPT09YXJndW1lbnRzLmxlbmd0aCl7Zm9yKHZhciBpPVtdLHI9dDtlPnI7cisrKWkucHVzaCh0aGlzLmdldFNlbGVjdGlvblN0eWxlcyhyKSk7cmV0dXJuIGl9dmFyIHM9dGhpcy5nZXQyREN1cnNvckxvY2F0aW9uKHQpO3JldHVybiB0aGlzLnN0eWxlc1tzLmxpbmVJbmRleF0/dGhpcy5zdHlsZXNbcy5saW5lSW5kZXhdW3MuY2hhckluZGV4XXx8e306e319LHNldFNlbGVjdGlvblN0eWxlczpmdW5jdGlvbih0KXtpZih0aGlzLnNlbGVjdGlvblN0YXJ0PT09dGhpcy5zZWxlY3Rpb25FbmQpdGhpcy5fZXh0ZW5kU3R5bGVzKHRoaXMuc2VsZWN0aW9uU3RhcnQsdCk7ZWxzZSBmb3IodmFyIGU9dGhpcy5zZWxlY3Rpb25TdGFydDtlPHRoaXMuc2VsZWN0aW9uRW5kO2UrKyl0aGlzLl9leHRlbmRTdHlsZXMoZSx0KTtyZXR1cm4gdGhpcy5fY2xlYXJDYWNoZSgpLHRoaXN9LF9leHRlbmRTdHlsZXM6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLmdldDJEQ3Vyc29yTG9jYXRpb24odCk7dGhpcy5zdHlsZXNbaS5saW5lSW5kZXhdfHwodGhpcy5zdHlsZXNbaS5saW5lSW5kZXhdPXt9KSx0aGlzLnN0eWxlc1tpLmxpbmVJbmRleF1baS5jaGFySW5kZXhdfHwodGhpcy5zdHlsZXNbaS5saW5lSW5kZXhdW2kuY2hhckluZGV4XT17fSksZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZCh0aGlzLnN0eWxlc1tpLmxpbmVJbmRleF1baS5jaGFySW5kZXhdLGUpfSxfcmVuZGVyOmZ1bmN0aW9uKHQpe3RoaXMuY2FsbFN1cGVyKFwiX3JlbmRlclwiLHQpLHRoaXMuY3R4PXQsdGhpcy5pc0VkaXRpbmcmJnRoaXMucmVuZGVyQ3Vyc29yT3JTZWxlY3Rpb24oKX0scmVuZGVyQ3Vyc29yT3JTZWxlY3Rpb246ZnVuY3Rpb24oKXtpZih0aGlzLmFjdGl2ZSl7dmFyIHQsZSxpPXRoaXMudGV4dC5zcGxpdChcIlwiKTt0aGlzLmNhbnZhcy5jb250ZXh0VG9wPyhlPXRoaXMuY2FudmFzLmNvbnRleHRUb3AsZS5zYXZlKCksZS50cmFuc2Zvcm0uYXBwbHkoZSx0aGlzLmNhbnZhcy52aWV3cG9ydFRyYW5zZm9ybSksdGhpcy50cmFuc2Zvcm0oZSksdGhpcy50cmFuc2Zvcm1NYXRyaXgmJmUudHJhbnNmb3JtLmFwcGx5KGUsdGhpcy50cmFuc2Zvcm1NYXRyaXgpKTooZT10aGlzLmN0eCxlLnNhdmUoKSksdGhpcy5zZWxlY3Rpb25TdGFydD09PXRoaXMuc2VsZWN0aW9uRW5kPyh0PXRoaXMuX2dldEN1cnNvckJvdW5kYXJpZXMoaSxcImN1cnNvclwiKSx0aGlzLnJlbmRlckN1cnNvcih0LGUpKToodD10aGlzLl9nZXRDdXJzb3JCb3VuZGFyaWVzKGksXCJzZWxlY3Rpb25cIiksdGhpcy5yZW5kZXJTZWxlY3Rpb24oaSx0LGUpKSxcclxuZS5yZXN0b3JlKCl9fSxnZXQyREN1cnNvckxvY2F0aW9uOmZ1bmN0aW9uKHQpe1widW5kZWZpbmVkXCI9PXR5cGVvZiB0JiYodD10aGlzLnNlbGVjdGlvblN0YXJ0KTtmb3IodmFyIGU9dGhpcy5fdGV4dExpbmVzLmxlbmd0aCxpPTA7ZT5pO2krKyl7aWYodDw9dGhpcy5fdGV4dExpbmVzW2ldLmxlbmd0aClyZXR1cm57bGluZUluZGV4OmksY2hhckluZGV4OnR9O3QtPXRoaXMuX3RleHRMaW5lc1tpXS5sZW5ndGgrMX1yZXR1cm57bGluZUluZGV4OmktMSxjaGFySW5kZXg6dGhpcy5fdGV4dExpbmVzW2ktMV0ubGVuZ3RoPHQ/dGhpcy5fdGV4dExpbmVzW2ktMV0ubGVuZ3RoOnR9fSxnZXRDdXJyZW50Q2hhclN0eWxlOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5zdHlsZXNbdF0mJnRoaXMuc3R5bGVzW3RdWzA9PT1lPzA6ZS0xXTtyZXR1cm57Zm9udFNpemU6aSYmaS5mb250U2l6ZXx8dGhpcy5mb250U2l6ZSxmaWxsOmkmJmkuZmlsbHx8dGhpcy5maWxsLHRleHRCYWNrZ3JvdW5kQ29sb3I6aSYmaS50ZXh0QmFja2dyb3VuZENvbG9yfHx0aGlzLnRleHRCYWNrZ3JvdW5kQ29sb3IsdGV4dERlY29yYXRpb246aSYmaS50ZXh0RGVjb3JhdGlvbnx8dGhpcy50ZXh0RGVjb3JhdGlvbixmb250RmFtaWx5OmkmJmkuZm9udEZhbWlseXx8dGhpcy5mb250RmFtaWx5LGZvbnRXZWlnaHQ6aSYmaS5mb250V2VpZ2h0fHx0aGlzLmZvbnRXZWlnaHQsZm9udFN0eWxlOmkmJmkuZm9udFN0eWxlfHx0aGlzLmZvbnRTdHlsZSxzdHJva2U6aSYmaS5zdHJva2V8fHRoaXMuc3Ryb2tlLHN0cm9rZVdpZHRoOmkmJmkuc3Ryb2tlV2lkdGh8fHRoaXMuc3Ryb2tlV2lkdGh9fSxnZXRDdXJyZW50Q2hhckZvbnRTaXplOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuc3R5bGVzW3RdJiZ0aGlzLnN0eWxlc1t0XVswPT09ZT8wOmUtMV0mJnRoaXMuc3R5bGVzW3RdWzA9PT1lPzA6ZS0xXS5mb250U2l6ZXx8dGhpcy5mb250U2l6ZX0sZ2V0Q3VycmVudENoYXJDb2xvcjpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLnN0eWxlc1t0XSYmdGhpcy5zdHlsZXNbdF1bMD09PWU/MDplLTFdJiZ0aGlzLnN0eWxlc1t0XVswPT09ZT8wOmUtMV0uZmlsbHx8dGhpcy5jdXJzb3JDb2xvcn0sX2dldEN1cnNvckJvdW5kYXJpZXM6ZnVuY3Rpb24odCxlKXt2YXIgaT1NYXRoLnJvdW5kKHRoaXMuX2dldExlZnRPZmZzZXQoKSkscj10aGlzLl9nZXRUb3BPZmZzZXQoKSxzPXRoaXMuX2dldEN1cnNvckJvdW5kYXJpZXNPZmZzZXRzKHQsZSk7cmV0dXJue2xlZnQ6aSx0b3A6cixsZWZ0T2Zmc2V0OnMubGVmdCtzLmxpbmVMZWZ0LHRvcE9mZnNldDpzLnRvcH19LF9nZXRDdXJzb3JCb3VuZGFyaWVzT2Zmc2V0czpmdW5jdGlvbih0LGUpe2Zvcih2YXIgaT0wLHI9MCxzPTAsbj0wLG89MCxhPTA7YTx0aGlzLnNlbGVjdGlvblN0YXJ0O2ErKylcIlxcblwiPT09dFthXT8obz0wLG4rPXRoaXMuX2dldEhlaWdodE9mTGluZSh0aGlzLmN0eCxyKSxyKysscz0wKToobys9dGhpcy5fZ2V0V2lkdGhPZkNoYXIodGhpcy5jdHgsdFthXSxyLHMpLHMrKyksaT10aGlzLl9nZXRDYWNoZWRMaW5lT2Zmc2V0KHIpO3JldHVyblwiY3Vyc29yXCI9PT1lJiYobis9KDEtdGhpcy5fZm9udFNpemVGcmFjdGlvbikqdGhpcy5fZ2V0SGVpZ2h0T2ZMaW5lKHRoaXMuY3R4LHIpL3RoaXMubGluZUhlaWdodC10aGlzLmdldEN1cnJlbnRDaGFyRm9udFNpemUocixzKSooMS10aGlzLl9mb250U2l6ZUZyYWN0aW9uKSkse3RvcDpuLGxlZnQ6byxsaW5lTGVmdDppfX0sX2dldENhY2hlZExpbmVPZmZzZXQ6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fZ2V0TGluZVdpZHRoKHRoaXMuY3R4LHQpO3JldHVybiB0aGlzLl9fbGluZU9mZnNldHNbdF18fCh0aGlzLl9fbGluZU9mZnNldHNbdF09dGhpcy5fZ2V0TGluZUxlZnRPZmZzZXQoZSkpfSxyZW5kZXJDdXJzb3I6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLmdldDJEQ3Vyc29yTG9jYXRpb24oKSxyPWkubGluZUluZGV4LHM9aS5jaGFySW5kZXgsbj10aGlzLmdldEN1cnJlbnRDaGFyRm9udFNpemUocixzKSxvPTA9PT1yJiYwPT09cz90aGlzLl9nZXRDYWNoZWRMaW5lT2Zmc2V0KHIpOnQubGVmdE9mZnNldDtlLmZpbGxTdHlsZT10aGlzLmdldEN1cnJlbnRDaGFyQ29sb3IocixzKSxlLmdsb2JhbEFscGhhPXRoaXMuX19pc01vdXNlZG93bj8xOnRoaXMuX2N1cnJlbnRDdXJzb3JPcGFjaXR5LGUuZmlsbFJlY3QodC5sZWZ0K28sdC50b3ArdC50b3BPZmZzZXQsdGhpcy5jdXJzb3JXaWR0aC90aGlzLnNjYWxlWCxuKX0scmVuZGVyU2VsZWN0aW9uOmZ1bmN0aW9uKHQsZSxpKXtpLmZpbGxTdHlsZT10aGlzLnNlbGVjdGlvbkNvbG9yO2Zvcih2YXIgcj10aGlzLmdldDJEQ3Vyc29yTG9jYXRpb24odGhpcy5zZWxlY3Rpb25TdGFydCkscz10aGlzLmdldDJEQ3Vyc29yTG9jYXRpb24odGhpcy5zZWxlY3Rpb25FbmQpLG49ci5saW5lSW5kZXgsbz1zLmxpbmVJbmRleCxhPW47bz49YTthKyspe3ZhciBoPXRoaXMuX2dldENhY2hlZExpbmVPZmZzZXQoYSl8fDAsYz10aGlzLl9nZXRIZWlnaHRPZkxpbmUodGhpcy5jdHgsYSksbD0wLHU9dGhpcy5fdGV4dExpbmVzW2FdO2lmKGE9PT1uKWZvcih2YXIgZj0wLGQ9dS5sZW5ndGg7ZD5mO2YrKylmPj1yLmNoYXJJbmRleCYmKGEhPT1vfHxmPHMuY2hhckluZGV4KSYmKGwrPXRoaXMuX2dldFdpZHRoT2ZDaGFyKGksdVtmXSxhLGYpKSxmPHIuY2hhckluZGV4JiYoaCs9dGhpcy5fZ2V0V2lkdGhPZkNoYXIoaSx1W2ZdLGEsZikpO2Vsc2UgaWYoYT5uJiZvPmEpbCs9dGhpcy5fZ2V0TGluZVdpZHRoKGksYSl8fDU7ZWxzZSBpZihhPT09bylmb3IodmFyIGc9MCxwPXMuY2hhckluZGV4O3A+ZztnKyspbCs9dGhpcy5fZ2V0V2lkdGhPZkNoYXIoaSx1W2ddLGEsZyk7aS5maWxsUmVjdChlLmxlZnQraCxlLnRvcCtlLnRvcE9mZnNldCxsLGMpLGUudG9wT2Zmc2V0Kz1jfX0sX3JlbmRlckNoYXJzOmZ1bmN0aW9uKHQsZSxpLHIscyxuKXtpZih0aGlzLmlzRW1wdHlTdHlsZXMoKSlyZXR1cm4gdGhpcy5fcmVuZGVyQ2hhcnNGYXN0KHQsZSxpLHIscyk7dGhpcy5za2lwVGV4dEFsaWduPSEwLHItPVwiY2VudGVyXCI9PT10aGlzLnRleHRBbGlnbj90aGlzLndpZHRoLzI6XCJyaWdodFwiPT09dGhpcy50ZXh0QWxpZ24/dGhpcy53aWR0aDowO3ZhciBvLGE9dGhpcy5fZ2V0SGVpZ2h0T2ZMaW5lKGUsbiksaD10aGlzLl9nZXRDYWNoZWRMaW5lT2Zmc2V0KG4pLGM9XCJcIjtyKz1ofHwwLGUuc2F2ZSgpLHMtPWEvdGhpcy5saW5lSGVpZ2h0KnRoaXMuX2ZvbnRTaXplRnJhY3Rpb247Zm9yKHZhciBsPTAsdT1pLmxlbmd0aDt1Pj1sO2wrKyl7bz1vfHx0aGlzLmdldEN1cnJlbnRDaGFyU3R5bGUobixsKTt2YXIgZj10aGlzLmdldEN1cnJlbnRDaGFyU3R5bGUobixsKzEpOyh0aGlzLl9oYXNTdHlsZUNoYW5nZWQobyxmKXx8bD09PXUpJiYodGhpcy5fcmVuZGVyQ2hhcih0LGUsbixsLTEsYyxyLHMsYSksYz1cIlwiLG89ZiksYys9aVtsXX1lLnJlc3RvcmUoKX0sX3JlbmRlckNoYXJzRmFzdDpmdW5jdGlvbih0LGUsaSxyLHMpe3RoaXMuc2tpcFRleHRBbGlnbj0hMSxcImZpbGxUZXh0XCI9PT10JiZ0aGlzLmZpbGwmJnRoaXMuY2FsbFN1cGVyKFwiX3JlbmRlckNoYXJzXCIsdCxlLGkscixzKSxcInN0cm9rZVRleHRcIj09PXQmJih0aGlzLnN0cm9rZSYmdGhpcy5zdHJva2VXaWR0aD4wfHx0aGlzLnNraXBGaWxsU3Ryb2tlQ2hlY2spJiZ0aGlzLmNhbGxTdXBlcihcIl9yZW5kZXJDaGFyc1wiLHQsZSxpLHIscyl9LF9yZW5kZXJDaGFyOmZ1bmN0aW9uKHQsZSxpLHIscyxuLG8sYSl7dmFyIGgsYyxsLHU9dGhpcy5fZm9udFNpemVGcmFjdGlvbiphL3RoaXMubGluZUhlaWdodDtpZih0aGlzLnN0eWxlcyYmdGhpcy5zdHlsZXNbaV0mJihoPXRoaXMuc3R5bGVzW2ldW3JdKSl7dmFyIGY9aC5zdHJva2V8fHRoaXMuc3Ryb2tlLGQ9aC5maWxsfHx0aGlzLmZpbGw7ZS5zYXZlKCksYz10aGlzLl9hcHBseUNoYXJTdHlsZXNHZXRXaWR0aChlLHMsaSxyLGgpLGw9dGhpcy5fZ2V0SGVpZ2h0T2ZDaGFyKGUscyxpLHIpLGQmJmUuZmlsbFRleHQocyxuLG8pLGYmJmUuc3Ryb2tlVGV4dChzLG4sbyksdGhpcy5fcmVuZGVyQ2hhckRlY29yYXRpb24oZSxoLG4sbyx1LGMsbCksZS5yZXN0b3JlKCksZS50cmFuc2xhdGUoYywwKX1lbHNlXCJzdHJva2VUZXh0XCI9PT10JiZ0aGlzLnN0cm9rZSYmZVt0XShzLG4sbyksXCJmaWxsVGV4dFwiPT09dCYmdGhpcy5maWxsJiZlW3RdKHMsbixvKSxjPXRoaXMuX2FwcGx5Q2hhclN0eWxlc0dldFdpZHRoKGUscyxpLHIpLHRoaXMuX3JlbmRlckNoYXJEZWNvcmF0aW9uKGUsbnVsbCxuLG8sdSxjLHRoaXMuZm9udFNpemUpLGUudHJhbnNsYXRlKGUubWVhc3VyZVRleHQocykud2lkdGgsMCl9LF9oYXNTdHlsZUNoYW5nZWQ6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdC5maWxsIT09ZS5maWxsfHx0LmZvbnRTaXplIT09ZS5mb250U2l6ZXx8dC50ZXh0QmFja2dyb3VuZENvbG9yIT09ZS50ZXh0QmFja2dyb3VuZENvbG9yfHx0LnRleHREZWNvcmF0aW9uIT09ZS50ZXh0RGVjb3JhdGlvbnx8dC5mb250RmFtaWx5IT09ZS5mb250RmFtaWx5fHx0LmZvbnRXZWlnaHQhPT1lLmZvbnRXZWlnaHR8fHQuZm9udFN0eWxlIT09ZS5mb250U3R5bGV8fHQuc3Ryb2tlIT09ZS5zdHJva2V8fHQuc3Ryb2tlV2lkdGghPT1lLnN0cm9rZVdpZHRofSxfcmVuZGVyQ2hhckRlY29yYXRpb246ZnVuY3Rpb24odCxlLGkscixzLG4sbyl7dmFyIGE9ZT9lLnRleHREZWNvcmF0aW9ufHx0aGlzLnRleHREZWNvcmF0aW9uOnRoaXMudGV4dERlY29yYXRpb247YSYmKGEuaW5kZXhPZihcInVuZGVybGluZVwiKT4tMSYmdC5maWxsUmVjdChpLHIrby8xMCxuLG8vMTUpLGEuaW5kZXhPZihcImxpbmUtdGhyb3VnaFwiKT4tMSYmdC5maWxsUmVjdChpLHItbyoodGhpcy5fZm9udFNpemVGcmFjdGlvbit0aGlzLl9mb250U2l6ZU11bHQtMSkrby8xNSxuLG8vMTUpLGEuaW5kZXhPZihcIm92ZXJsaW5lXCIpPi0xJiZ0LmZpbGxSZWN0KGksci0odGhpcy5fZm9udFNpemVNdWx0LXRoaXMuX2ZvbnRTaXplRnJhY3Rpb24pKm8sbixvLzE1KSl9LF9yZW5kZXJUZXh0TGluZTpmdW5jdGlvbih0LGUsaSxyLHMsbil7dGhpcy5pc0VtcHR5U3R5bGVzKCl8fChzKz10aGlzLmZvbnRTaXplKih0aGlzLl9mb250U2l6ZUZyYWN0aW9uKy4wMykpLHRoaXMuY2FsbFN1cGVyKFwiX3JlbmRlclRleHRMaW5lXCIsdCxlLGkscixzLG4pfSxfcmVuZGVyVGV4dERlY29yYXRpb246ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuaXNFbXB0eVN0eWxlcygpP3RoaXMuY2FsbFN1cGVyKFwiX3JlbmRlclRleHREZWNvcmF0aW9uXCIsdCk6dm9pZCAwfSxfcmVuZGVyVGV4dExpbmVzQmFja2dyb3VuZDpmdW5jdGlvbih0KXtpZih0aGlzLnRleHRCYWNrZ3JvdW5kQ29sb3J8fHRoaXMuc3R5bGVzKXt0LnNhdmUoKSx0aGlzLnRleHRCYWNrZ3JvdW5kQ29sb3ImJih0LmZpbGxTdHlsZT10aGlzLnRleHRCYWNrZ3JvdW5kQ29sb3IpO2Zvcih2YXIgZT0wLGk9MCxyPXRoaXMuX3RleHRMaW5lcy5sZW5ndGg7cj5pO2krKyl7dmFyIHM9dGhpcy5fZ2V0SGVpZ2h0T2ZMaW5lKHQsaSk7aWYoXCJcIiE9PXRoaXMuX3RleHRMaW5lc1tpXSl7dmFyIG49dGhpcy5fZ2V0TGluZVdpZHRoKHQsaSksbz10aGlzLl9nZXRDYWNoZWRMaW5lT2Zmc2V0KGkpO2lmKHRoaXMudGV4dEJhY2tncm91bmRDb2xvciYmKHQuZmlsbFN0eWxlPXRoaXMudGV4dEJhY2tncm91bmRDb2xvcix0LmZpbGxSZWN0KHRoaXMuX2dldExlZnRPZmZzZXQoKStvLHRoaXMuX2dldFRvcE9mZnNldCgpK2UsbixzL3RoaXMubGluZUhlaWdodCkpLHRoaXMuc3R5bGVzW2ldKWZvcih2YXIgYT0wLGg9dGhpcy5fdGV4dExpbmVzW2ldLmxlbmd0aDtoPmE7YSsrKWlmKHRoaXMuc3R5bGVzW2ldJiZ0aGlzLnN0eWxlc1tpXVthXSYmdGhpcy5zdHlsZXNbaV1bYV0udGV4dEJhY2tncm91bmRDb2xvcil7dmFyIGM9dGhpcy5fdGV4dExpbmVzW2ldW2FdO3QuZmlsbFN0eWxlPXRoaXMuc3R5bGVzW2ldW2FdLnRleHRCYWNrZ3JvdW5kQ29sb3IsdC5maWxsUmVjdCh0aGlzLl9nZXRMZWZ0T2Zmc2V0KCkrbyt0aGlzLl9nZXRXaWR0aE9mQ2hhcnNBdCh0LGksYSksdGhpcy5fZ2V0VG9wT2Zmc2V0KCkrZSx0aGlzLl9nZXRXaWR0aE9mQ2hhcih0LGMsaSxhKSsxLHMvdGhpcy5saW5lSGVpZ2h0KX1lKz1zfWVsc2UgZSs9c310LnJlc3RvcmUoKX19LF9nZXRDYWNoZVByb3A6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdCtlLmZvbnRGYW1pbHkrZS5mb250U2l6ZStlLmZvbnRXZWlnaHQrZS5mb250U3R5bGUrZS5zaGFkb3d9LF9hcHBseUNoYXJTdHlsZXNHZXRXaWR0aDpmdW5jdGlvbihlLGkscixzLG4pe3ZhciBvPW58fHRoaXMuc3R5bGVzW3JdJiZ0aGlzLnN0eWxlc1tyXVtzXTtvPW8/dChvKTp7fSx0aGlzLl9hcHBseUZvbnRTdHlsZXMobyk7dmFyIGE9dGhpcy5fZ2V0Q2FjaGVQcm9wKGksbyk7aWYodGhpcy5pc0VtcHR5U3R5bGVzKCkmJnRoaXMuX2NoYXJXaWR0aHNDYWNoZVthXSYmdGhpcy5jYWNoaW5nKXJldHVybiB0aGlzLl9jaGFyV2lkdGhzQ2FjaGVbYV07XCJzdHJpbmdcIj09dHlwZW9mIG8uc2hhZG93JiYoby5zaGFkb3c9bmV3IGZhYnJpYy5TaGFkb3coby5zaGFkb3cpKTt2YXIgaD1vLmZpbGx8fHRoaXMuZmlsbDtyZXR1cm4gZS5maWxsU3R5bGU9aC50b0xpdmU/aC50b0xpdmUoZSx0aGlzKTpoLG8uc3Ryb2tlJiYoZS5zdHJva2VTdHlsZT1vLnN0cm9rZSYmby5zdHJva2UudG9MaXZlP28uc3Ryb2tlLnRvTGl2ZShlLHRoaXMpOm8uc3Ryb2tlKSxlLmxpbmVXaWR0aD1vLnN0cm9rZVdpZHRofHx0aGlzLnN0cm9rZVdpZHRoLGUuZm9udD10aGlzLl9nZXRGb250RGVjbGFyYXRpb24uY2FsbChvKSx0aGlzLl9zZXRTaGFkb3cuY2FsbChvLGUpLHRoaXMuY2FjaGluZz8odGhpcy5fY2hhcldpZHRoc0NhY2hlW2FdfHwodGhpcy5fY2hhcldpZHRoc0NhY2hlW2FdPWUubWVhc3VyZVRleHQoaSkud2lkdGgpLHRoaXMuX2NoYXJXaWR0aHNDYWNoZVthXSk6ZS5tZWFzdXJlVGV4dChpKS53aWR0aH0sX2FwcGx5Rm9udFN0eWxlczpmdW5jdGlvbih0KXt0LmZvbnRGYW1pbHl8fCh0LmZvbnRGYW1pbHk9dGhpcy5mb250RmFtaWx5KSx0LmZvbnRTaXplfHwodC5mb250U2l6ZT10aGlzLmZvbnRTaXplKSx0LmZvbnRXZWlnaHR8fCh0LmZvbnRXZWlnaHQ9dGhpcy5mb250V2VpZ2h0KSx0LmZvbnRTdHlsZXx8KHQuZm9udFN0eWxlPXRoaXMuZm9udFN0eWxlKX0sX2dldFN0eWxlRGVjbGFyYXRpb246ZnVuY3Rpb24oZSxpKXtyZXR1cm4gdGhpcy5zdHlsZXNbZV0mJnRoaXMuc3R5bGVzW2VdW2ldP3QodGhpcy5zdHlsZXNbZV1baV0pOnt9fSxfZ2V0V2lkdGhPZkNoYXI6ZnVuY3Rpb24odCxlLGkscil7aWYoXCJqdXN0aWZ5XCI9PT10aGlzLnRleHRBbGlnbiYmL1xccy8udGVzdChlKSlyZXR1cm4gdGhpcy5fZ2V0V2lkdGhPZlNwYWNlKHQsaSk7dmFyIHM9dGhpcy5fZ2V0U3R5bGVEZWNsYXJhdGlvbihpLHIpO3RoaXMuX2FwcGx5Rm9udFN0eWxlcyhzKTt2YXIgbj10aGlzLl9nZXRDYWNoZVByb3AoZSxzKTtpZih0aGlzLl9jaGFyV2lkdGhzQ2FjaGVbbl0mJnRoaXMuY2FjaGluZylyZXR1cm4gdGhpcy5fY2hhcldpZHRoc0NhY2hlW25dO2lmKHQpe3Quc2F2ZSgpO3ZhciBvPXRoaXMuX2FwcGx5Q2hhclN0eWxlc0dldFdpZHRoKHQsZSxpLHIpO3JldHVybiB0LnJlc3RvcmUoKSxvfX0sX2dldEhlaWdodE9mQ2hhcjpmdW5jdGlvbih0LGUsaSxyKXtyZXR1cm4gdGhpcy5zdHlsZXNbaV0mJnRoaXMuc3R5bGVzW2ldW3JdP3RoaXMuc3R5bGVzW2ldW3JdLmZvbnRTaXplfHx0aGlzLmZvbnRTaXplOnRoaXMuZm9udFNpemV9LF9nZXRIZWlnaHRPZkNoYXJBdDpmdW5jdGlvbih0LGUsaSl7dmFyIHI9dGhpcy5fdGV4dExpbmVzW2VdW2ldO3JldHVybiB0aGlzLl9nZXRIZWlnaHRPZkNoYXIodCxyLGUsaSl9LF9nZXRXaWR0aE9mQ2hhcnNBdDpmdW5jdGlvbih0LGUsaSl7dmFyIHIscyxuPTA7Zm9yKHI9MDtpPnI7cisrKXM9dGhpcy5fdGV4dExpbmVzW2VdW3JdLG4rPXRoaXMuX2dldFdpZHRoT2ZDaGFyKHQscyxlLHIpO3JldHVybiBufSxfZ2V0TGluZVdpZHRoOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuX19saW5lV2lkdGhzW2VdP3RoaXMuX19saW5lV2lkdGhzW2VdOih0aGlzLl9fbGluZVdpZHRoc1tlXT10aGlzLl9nZXRXaWR0aE9mQ2hhcnNBdCh0LGUsdGhpcy5fdGV4dExpbmVzW2VdLmxlbmd0aCksdGhpcy5fX2xpbmVXaWR0aHNbZV0pfSxfZ2V0V2lkdGhPZlNwYWNlOmZ1bmN0aW9uKHQsZSl7aWYodGhpcy5fX3dpZHRoT2ZTcGFjZVtlXSlyZXR1cm4gdGhpcy5fX3dpZHRoT2ZTcGFjZVtlXTt2YXIgaT10aGlzLl90ZXh0TGluZXNbZV0scj10aGlzLl9nZXRXaWR0aE9mV29yZHModCxpLGUpLHM9dGhpcy53aWR0aC1yLG49aS5sZW5ndGgtaS5yZXBsYWNlKC9cXHMrL2csXCJcIikubGVuZ3RoLG89cy9uO3JldHVybiB0aGlzLl9fd2lkdGhPZlNwYWNlW2VdPW8sb30sX2dldFdpZHRoT2ZXb3JkczpmdW5jdGlvbih0LGUsaSl7Zm9yKHZhciByPTAscz0wO3M8ZS5sZW5ndGg7cysrKXt2YXIgbj1lW3NdO24ubWF0Y2goL1xccy8pfHwocis9dGhpcy5fZ2V0V2lkdGhPZkNoYXIodCxuLGkscykpfXJldHVybiByfSxfZ2V0SGVpZ2h0T2ZMaW5lOmZ1bmN0aW9uKHQsZSl7aWYodGhpcy5fX2xpbmVIZWlnaHRzW2VdKXJldHVybiB0aGlzLl9fbGluZUhlaWdodHNbZV07Zm9yKHZhciBpPXRoaXMuX3RleHRMaW5lc1tlXSxyPXRoaXMuX2dldEhlaWdodE9mQ2hhcih0LGlbMF0sZSwwKSxzPTEsbj1pLmxlbmd0aDtuPnM7cysrKXt2YXIgbz10aGlzLl9nZXRIZWlnaHRPZkNoYXIodCxpW3NdLGUscyk7bz5yJiYocj1vKX1yZXR1cm4gdGhpcy5fX21heEZvbnRIZWlnaHRzW2VdPXIsdGhpcy5fX2xpbmVIZWlnaHRzW2VdPXIqdGhpcy5saW5lSGVpZ2h0KnRoaXMuX2ZvbnRTaXplTXVsdCx0aGlzLl9fbGluZUhlaWdodHNbZV19LF9nZXRUZXh0SGVpZ2h0OmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT0wLGk9MCxyPXRoaXMuX3RleHRMaW5lcy5sZW5ndGg7cj5pO2krKyllKz10aGlzLl9nZXRIZWlnaHRPZkxpbmUodCxpKTtyZXR1cm4gZX0sX3JlbmRlclRleHRCb3hCYWNrZ3JvdW5kOmZ1bmN0aW9uKHQpe3RoaXMuYmFja2dyb3VuZENvbG9yJiYodC5zYXZlKCksdC5maWxsU3R5bGU9dGhpcy5iYWNrZ3JvdW5kQ29sb3IsdC5maWxsUmVjdCh0aGlzLl9nZXRMZWZ0T2Zmc2V0KCksdGhpcy5fZ2V0VG9wT2Zmc2V0KCksdGhpcy53aWR0aCx0aGlzLmhlaWdodCksdC5yZXN0b3JlKCkpfSx0b09iamVjdDpmdW5jdGlvbihlKXtyZXR1cm4gZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZCh0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIsZSkse3N0eWxlczp0KHRoaXMuc3R5bGVzKX0pfX0pLGZhYnJpYy5JVGV4dC5mcm9tT2JqZWN0PWZ1bmN0aW9uKGUpe3JldHVybiBuZXcgZmFicmljLklUZXh0KGUudGV4dCx0KGUpKX19KCksZnVuY3Rpb24oKXt2YXIgdD1mYWJyaWMudXRpbC5vYmplY3QuY2xvbmU7ZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuSVRleHQucHJvdG90eXBlLHtpbml0QmVoYXZpb3I6ZnVuY3Rpb24oKXt0aGlzLmluaXRBZGRlZEhhbmRsZXIoKSx0aGlzLmluaXRSZW1vdmVkSGFuZGxlcigpLHRoaXMuaW5pdEN1cnNvclNlbGVjdGlvbkhhbmRsZXJzKCksdGhpcy5pbml0RG91YmxlQ2xpY2tTaW11bGF0aW9uKCl9LGluaXRTZWxlY3RlZEhhbmRsZXI6ZnVuY3Rpb24oKXt0aGlzLm9uKFwic2VsZWN0ZWRcIixmdW5jdGlvbigpe3ZhciB0PXRoaXM7c2V0VGltZW91dChmdW5jdGlvbigpe3Quc2VsZWN0ZWQ9ITB9LDEwMCl9KX0saW5pdEFkZGVkSGFuZGxlcjpmdW5jdGlvbigpe3ZhciB0PXRoaXM7dGhpcy5vbihcImFkZGVkXCIsZnVuY3Rpb24oKXt0aGlzLmNhbnZhcyYmIXRoaXMuY2FudmFzLl9oYXNJVGV4dEhhbmRsZXJzJiYodGhpcy5jYW52YXMuX2hhc0lUZXh0SGFuZGxlcnM9ITAsdGhpcy5faW5pdENhbnZhc0hhbmRsZXJzKCkpLHQuY2FudmFzJiYodC5jYW52YXMuX2lUZXh0SW5zdGFuY2VzPXQuY2FudmFzLl9pVGV4dEluc3RhbmNlc3x8W10sdC5jYW52YXMuX2lUZXh0SW5zdGFuY2VzLnB1c2godCkpfSl9LGluaXRSZW1vdmVkSGFuZGxlcjpmdW5jdGlvbigpe3ZhciB0PXRoaXM7dGhpcy5vbihcInJlbW92ZWRcIixmdW5jdGlvbigpe3QuY2FudmFzJiYodC5jYW52YXMuX2lUZXh0SW5zdGFuY2VzPXQuY2FudmFzLl9pVGV4dEluc3RhbmNlc3x8W10sZmFicmljLnV0aWwucmVtb3ZlRnJvbUFycmF5KHQuY2FudmFzLl9pVGV4dEluc3RhbmNlcyx0KSl9KX0sX2luaXRDYW52YXNIYW5kbGVyczpmdW5jdGlvbigpe3ZhciB0PXRoaXM7dGhpcy5jYW52YXMub24oXCJzZWxlY3Rpb246Y2xlYXJlZFwiLGZ1bmN0aW9uKCl7ZmFicmljLklUZXh0LnByb3RvdHlwZS5leGl0RWRpdGluZ09uT3RoZXJzKHQuY2FudmFzKX0pLHRoaXMuY2FudmFzLm9uKFwibW91c2U6dXBcIixmdW5jdGlvbigpe3QuY2FudmFzLl9pVGV4dEluc3RhbmNlcyYmdC5jYW52YXMuX2lUZXh0SW5zdGFuY2VzLmZvckVhY2goZnVuY3Rpb24odCl7dC5fX2lzTW91c2Vkb3duPSExfSl9KSx0aGlzLmNhbnZhcy5vbihcIm9iamVjdDpzZWxlY3RlZFwiLGZ1bmN0aW9uKCl7ZmFicmljLklUZXh0LnByb3RvdHlwZS5leGl0RWRpdGluZ09uT3RoZXJzKHQuY2FudmFzKX0pfSxfdGljazpmdW5jdGlvbigpe3RoaXMuX2N1cnJlbnRUaWNrU3RhdGU9dGhpcy5fYW5pbWF0ZUN1cnNvcih0aGlzLDEsdGhpcy5jdXJzb3JEdXJhdGlvbixcIl9vblRpY2tDb21wbGV0ZVwiKX0sX2FuaW1hdGVDdXJzb3I6ZnVuY3Rpb24odCxlLGkscil7dmFyIHM7cmV0dXJuIHM9e2lzQWJvcnRlZDohMSxhYm9ydDpmdW5jdGlvbigpe3RoaXMuaXNBYm9ydGVkPSEwfX0sdC5hbmltYXRlKFwiX2N1cnJlbnRDdXJzb3JPcGFjaXR5XCIsZSx7ZHVyYXRpb246aSxvbkNvbXBsZXRlOmZ1bmN0aW9uKCl7cy5pc0Fib3J0ZWR8fHRbcl0oKX0sb25DaGFuZ2U6ZnVuY3Rpb24oKXt0LmNhbnZhcyYmKHQuY2FudmFzLmNsZWFyQ29udGV4dCh0LmNhbnZhcy5jb250ZXh0VG9wfHx0LmN0eCksdC5yZW5kZXJDdXJzb3JPclNlbGVjdGlvbigpKX0sYWJvcnQ6ZnVuY3Rpb24oKXtyZXR1cm4gcy5pc0Fib3J0ZWR9fSksc30sX29uVGlja0NvbXBsZXRlOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpczt0aGlzLl9jdXJzb3JUaW1lb3V0MSYmY2xlYXJUaW1lb3V0KHRoaXMuX2N1cnNvclRpbWVvdXQxKSx0aGlzLl9jdXJzb3JUaW1lb3V0MT1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dC5fY3VycmVudFRpY2tDb21wbGV0ZVN0YXRlPXQuX2FuaW1hdGVDdXJzb3IodCwwLHRoaXMuY3Vyc29yRHVyYXRpb24vMixcIl90aWNrXCIpfSwxMDApfSxpbml0RGVsYXllZEN1cnNvcjpmdW5jdGlvbih0KXt2YXIgZT10aGlzLGk9dD8wOnRoaXMuY3Vyc29yRGVsYXk7dGhpcy5fY3VycmVudFRpY2tTdGF0ZSYmdGhpcy5fY3VycmVudFRpY2tTdGF0ZS5hYm9ydCgpLHRoaXMuX2N1cnJlbnRUaWNrQ29tcGxldGVTdGF0ZSYmdGhpcy5fY3VycmVudFRpY2tDb21wbGV0ZVN0YXRlLmFib3J0KCksY2xlYXJUaW1lb3V0KHRoaXMuX2N1cnNvclRpbWVvdXQxKSx0aGlzLl9jdXJyZW50Q3Vyc29yT3BhY2l0eT0xLHRoaXMuY2FudmFzJiYodGhpcy5jYW52YXMuY2xlYXJDb250ZXh0KHRoaXMuY2FudmFzLmNvbnRleHRUb3B8fHRoaXMuY3R4KSx0aGlzLnJlbmRlckN1cnNvck9yU2VsZWN0aW9uKCkpLHRoaXMuX2N1cnNvclRpbWVvdXQyJiZjbGVhclRpbWVvdXQodGhpcy5fY3Vyc29yVGltZW91dDIpLHRoaXMuX2N1cnNvclRpbWVvdXQyPXNldFRpbWVvdXQoZnVuY3Rpb24oKXtlLl90aWNrKCl9LGkpfSxhYm9ydEN1cnNvckFuaW1hdGlvbjpmdW5jdGlvbigpe3RoaXMuX2N1cnJlbnRUaWNrU3RhdGUmJnRoaXMuX2N1cnJlbnRUaWNrU3RhdGUuYWJvcnQoKSx0aGlzLl9jdXJyZW50VGlja0NvbXBsZXRlU3RhdGUmJnRoaXMuX2N1cnJlbnRUaWNrQ29tcGxldGVTdGF0ZS5hYm9ydCgpLGNsZWFyVGltZW91dCh0aGlzLl9jdXJzb3JUaW1lb3V0MSksY2xlYXJUaW1lb3V0KHRoaXMuX2N1cnNvclRpbWVvdXQyKSx0aGlzLl9jdXJyZW50Q3Vyc29yT3BhY2l0eT0wLHRoaXMuY2FudmFzJiZ0aGlzLmNhbnZhcy5jbGVhckNvbnRleHQodGhpcy5jYW52YXMuY29udGV4dFRvcHx8dGhpcy5jdHgpfSxzZWxlY3RBbGw6ZnVuY3Rpb24oKXt0aGlzLnNldFNlbGVjdGlvblN0YXJ0KDApLHRoaXMuc2V0U2VsZWN0aW9uRW5kKHRoaXMudGV4dC5sZW5ndGgpfSxnZXRTZWxlY3RlZFRleHQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50ZXh0LnNsaWNlKHRoaXMuc2VsZWN0aW9uU3RhcnQsdGhpcy5zZWxlY3Rpb25FbmQpfSxmaW5kV29yZEJvdW5kYXJ5TGVmdDpmdW5jdGlvbih0KXt2YXIgZT0wLGk9dC0xO2lmKHRoaXMuX3JlU3BhY2UudGVzdCh0aGlzLnRleHQuY2hhckF0KGkpKSlmb3IoO3RoaXMuX3JlU3BhY2UudGVzdCh0aGlzLnRleHQuY2hhckF0KGkpKTspZSsrLGktLTtmb3IoOy9cXFMvLnRlc3QodGhpcy50ZXh0LmNoYXJBdChpKSkmJmk+LTE7KWUrKyxpLS07cmV0dXJuIHQtZX0sZmluZFdvcmRCb3VuZGFyeVJpZ2h0OmZ1bmN0aW9uKHQpe3ZhciBlPTAsaT10O2lmKHRoaXMuX3JlU3BhY2UudGVzdCh0aGlzLnRleHQuY2hhckF0KGkpKSlmb3IoO3RoaXMuX3JlU3BhY2UudGVzdCh0aGlzLnRleHQuY2hhckF0KGkpKTspZSsrLGkrKztmb3IoOy9cXFMvLnRlc3QodGhpcy50ZXh0LmNoYXJBdChpKSkmJmk8dGhpcy50ZXh0Lmxlbmd0aDspZSsrLGkrKztyZXR1cm4gdCtlfSxmaW5kTGluZUJvdW5kYXJ5TGVmdDpmdW5jdGlvbih0KXtmb3IodmFyIGU9MCxpPXQtMTshL1xcbi8udGVzdCh0aGlzLnRleHQuY2hhckF0KGkpKSYmaT4tMTspZSsrLGktLTtyZXR1cm4gdC1lfSxmaW5kTGluZUJvdW5kYXJ5UmlnaHQ6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTAsaT10OyEvXFxuLy50ZXN0KHRoaXMudGV4dC5jaGFyQXQoaSkpJiZpPHRoaXMudGV4dC5sZW5ndGg7KWUrKyxpKys7cmV0dXJuIHQrZX0sZ2V0TnVtTmV3TGluZXNJblNlbGVjdGVkVGV4dDpmdW5jdGlvbigpe2Zvcih2YXIgdD10aGlzLmdldFNlbGVjdGVkVGV4dCgpLGU9MCxpPTAscj10Lmxlbmd0aDtyPmk7aSsrKVwiXFxuXCI9PT10W2ldJiZlKys7cmV0dXJuIGV9LHNlYXJjaFdvcmRCb3VuZGFyeTpmdW5jdGlvbih0LGUpe2Zvcih2YXIgaT10aGlzLl9yZVNwYWNlLnRlc3QodGhpcy50ZXh0LmNoYXJBdCh0KSk/dC0xOnQscj10aGlzLnRleHQuY2hhckF0KGkpLHM9L1sgXFxuXFwuLDshXFw/XFwtXS87IXMudGVzdChyKSYmaT4wJiZpPHRoaXMudGV4dC5sZW5ndGg7KWkrPWUscj10aGlzLnRleHQuY2hhckF0KGkpO3JldHVybiBzLnRlc3QocikmJlwiXFxuXCIhPT1yJiYoaSs9MT09PWU/MDoxKSxpfSxzZWxlY3RXb3JkOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuc2VhcmNoV29yZEJvdW5kYXJ5KHQsLTEpLGk9dGhpcy5zZWFyY2hXb3JkQm91bmRhcnkodCwxKTt0aGlzLnNldFNlbGVjdGlvblN0YXJ0KGUpLHRoaXMuc2V0U2VsZWN0aW9uRW5kKGkpfSxzZWxlY3RMaW5lOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZmluZExpbmVCb3VuZGFyeUxlZnQodCksaT10aGlzLmZpbmRMaW5lQm91bmRhcnlSaWdodCh0KTt0aGlzLnNldFNlbGVjdGlvblN0YXJ0KGUpLHRoaXMuc2V0U2VsZWN0aW9uRW5kKGkpfSxlbnRlckVkaXRpbmc6ZnVuY3Rpb24oKXtyZXR1cm4hdGhpcy5pc0VkaXRpbmcmJnRoaXMuZWRpdGFibGU/KHRoaXMuY2FudmFzJiZ0aGlzLmV4aXRFZGl0aW5nT25PdGhlcnModGhpcy5jYW52YXMpLHRoaXMuaXNFZGl0aW5nPSEwLHRoaXMuaW5pdEhpZGRlblRleHRhcmVhKCksdGhpcy5oaWRkZW5UZXh0YXJlYS5mb2N1cygpLHRoaXMuX3VwZGF0ZVRleHRhcmVhKCksdGhpcy5fc2F2ZUVkaXRpbmdQcm9wcygpLHRoaXMuX3NldEVkaXRpbmdQcm9wcygpLHRoaXMuX3RpY2soKSx0aGlzLmZpcmUoXCJlZGl0aW5nOmVudGVyZWRcIiksdGhpcy5jYW52YXM/KHRoaXMuY2FudmFzLnJlbmRlckFsbCgpLHRoaXMuY2FudmFzLmZpcmUoXCJ0ZXh0OmVkaXRpbmc6ZW50ZXJlZFwiLHt0YXJnZXQ6dGhpc30pLHRoaXMuaW5pdE1vdXNlTW92ZUhhbmRsZXIoKSx0aGlzKTp0aGlzKTp2b2lkIDB9LGV4aXRFZGl0aW5nT25PdGhlcnM6ZnVuY3Rpb24odCl7dC5faVRleHRJbnN0YW5jZXMmJnQuX2lUZXh0SW5zdGFuY2VzLmZvckVhY2goZnVuY3Rpb24odCl7dC5zZWxlY3RlZD0hMSx0LmlzRWRpdGluZyYmdC5leGl0RWRpdGluZygpfSl9LGluaXRNb3VzZU1vdmVIYW5kbGVyOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpczt0aGlzLmNhbnZhcy5vbihcIm1vdXNlOm1vdmVcIixmdW5jdGlvbihlKXtpZih0Ll9faXNNb3VzZWRvd24mJnQuaXNFZGl0aW5nKXt2YXIgaT10LmdldFNlbGVjdGlvblN0YXJ0RnJvbVBvaW50ZXIoZS5lKTtpPj10Ll9fc2VsZWN0aW9uU3RhcnRPbk1vdXNlRG93bj8odC5zZXRTZWxlY3Rpb25TdGFydCh0Ll9fc2VsZWN0aW9uU3RhcnRPbk1vdXNlRG93biksdC5zZXRTZWxlY3Rpb25FbmQoaSkpOih0LnNldFNlbGVjdGlvblN0YXJ0KGkpLHQuc2V0U2VsZWN0aW9uRW5kKHQuX19zZWxlY3Rpb25TdGFydE9uTW91c2VEb3duKSl9fSl9LF9zZXRFZGl0aW5nUHJvcHM6ZnVuY3Rpb24oKXt0aGlzLmhvdmVyQ3Vyc29yPVwidGV4dFwiLHRoaXMuY2FudmFzJiYodGhpcy5jYW52YXMuZGVmYXVsdEN1cnNvcj10aGlzLmNhbnZhcy5tb3ZlQ3Vyc29yPVwidGV4dFwiKSx0aGlzLmJvcmRlckNvbG9yPXRoaXMuZWRpdGluZ0JvcmRlckNvbG9yLHRoaXMuaGFzQ29udHJvbHM9dGhpcy5zZWxlY3RhYmxlPSExLHRoaXMubG9ja01vdmVtZW50WD10aGlzLmxvY2tNb3ZlbWVudFk9ITB9LF91cGRhdGVUZXh0YXJlYTpmdW5jdGlvbigpe3RoaXMuaGlkZGVuVGV4dGFyZWEmJih0aGlzLmhpZGRlblRleHRhcmVhLnZhbHVlPXRoaXMudGV4dCx0aGlzLmhpZGRlblRleHRhcmVhLnNlbGVjdGlvblN0YXJ0PXRoaXMuc2VsZWN0aW9uU3RhcnQsdGhpcy5oaWRkZW5UZXh0YXJlYS5zZWxlY3Rpb25FbmQ9dGhpcy5zZWxlY3Rpb25FbmQpfSxfc2F2ZUVkaXRpbmdQcm9wczpmdW5jdGlvbigpe3RoaXMuX3NhdmVkUHJvcHM9e2hhc0NvbnRyb2xzOnRoaXMuaGFzQ29udHJvbHMsYm9yZGVyQ29sb3I6dGhpcy5ib3JkZXJDb2xvcixsb2NrTW92ZW1lbnRYOnRoaXMubG9ja01vdmVtZW50WCxsb2NrTW92ZW1lbnRZOnRoaXMubG9ja01vdmVtZW50WSxob3ZlckN1cnNvcjp0aGlzLmhvdmVyQ3Vyc29yLGRlZmF1bHRDdXJzb3I6dGhpcy5jYW52YXMmJnRoaXMuY2FudmFzLmRlZmF1bHRDdXJzb3IsbW92ZUN1cnNvcjp0aGlzLmNhbnZhcyYmdGhpcy5jYW52YXMubW92ZUN1cnNvcn19LF9yZXN0b3JlRWRpdGluZ1Byb3BzOmZ1bmN0aW9uKCl7dGhpcy5fc2F2ZWRQcm9wcyYmKHRoaXMuaG92ZXJDdXJzb3I9dGhpcy5fc2F2ZWRQcm9wcy5vdmVyQ3Vyc29yLHRoaXMuaGFzQ29udHJvbHM9dGhpcy5fc2F2ZWRQcm9wcy5oYXNDb250cm9scyx0aGlzLmJvcmRlckNvbG9yPXRoaXMuX3NhdmVkUHJvcHMuYm9yZGVyQ29sb3IsdGhpcy5sb2NrTW92ZW1lbnRYPXRoaXMuX3NhdmVkUHJvcHMubG9ja01vdmVtZW50WCx0aGlzLmxvY2tNb3ZlbWVudFk9dGhpcy5fc2F2ZWRQcm9wcy5sb2NrTW92ZW1lbnRZLHRoaXMuY2FudmFzJiYodGhpcy5jYW52YXMuZGVmYXVsdEN1cnNvcj10aGlzLl9zYXZlZFByb3BzLmRlZmF1bHRDdXJzb3IsdGhpcy5jYW52YXMubW92ZUN1cnNvcj10aGlzLl9zYXZlZFByb3BzLm1vdmVDdXJzb3IpKX0sZXhpdEVkaXRpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZWxlY3RlZD0hMSx0aGlzLmlzRWRpdGluZz0hMSx0aGlzLnNlbGVjdGFibGU9ITAsdGhpcy5zZWxlY3Rpb25FbmQ9dGhpcy5zZWxlY3Rpb25TdGFydCx0aGlzLmhpZGRlblRleHRhcmVhJiZ0aGlzLmNhbnZhcyYmdGhpcy5oaWRkZW5UZXh0YXJlYS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuaGlkZGVuVGV4dGFyZWEpLHRoaXMuaGlkZGVuVGV4dGFyZWE9bnVsbCx0aGlzLmFib3J0Q3Vyc29yQW5pbWF0aW9uKCksdGhpcy5fcmVzdG9yZUVkaXRpbmdQcm9wcygpLHRoaXMuX2N1cnJlbnRDdXJzb3JPcGFjaXR5PTAsdGhpcy5maXJlKFwiZWRpdGluZzpleGl0ZWRcIiksdGhpcy5jYW52YXMmJnRoaXMuY2FudmFzLmZpcmUoXCJ0ZXh0OmVkaXRpbmc6ZXhpdGVkXCIse3RhcmdldDp0aGlzfSksdGhpc30sX3JlbW92ZUV4dHJhbmVvdXNTdHlsZXM6ZnVuY3Rpb24oKXtmb3IodmFyIHQgaW4gdGhpcy5zdHlsZXMpdGhpcy5fdGV4dExpbmVzW3RdfHxkZWxldGUgdGhpcy5zdHlsZXNbdF19LF9yZW1vdmVDaGFyc0Zyb21UbzpmdW5jdGlvbih0LGUpe2Zvcig7ZSE9PXQ7KXRoaXMuX3JlbW92ZVNpbmdsZUNoYXJBbmRTdHlsZSh0KzEpLGUtLTt0aGlzLnNldFNlbGVjdGlvblN0YXJ0KHQpfSxfcmVtb3ZlU2luZ2xlQ2hhckFuZFN0eWxlOmZ1bmN0aW9uKHQpe3ZhciBlPVwiXFxuXCI9PT10aGlzLnRleHRbdC0xXSxpPWU/dDp0LTE7dGhpcy5yZW1vdmVTdHlsZU9iamVjdChlLGkpLHRoaXMudGV4dD10aGlzLnRleHQuc2xpY2UoMCx0LTEpK3RoaXMudGV4dC5zbGljZSh0KSx0aGlzLl90ZXh0TGluZXM9dGhpcy50ZXh0LnNwbGl0KHRoaXMuX3JlTmV3bGluZSl9LGluc2VydENoYXJzOmZ1bmN0aW9uKHQsZSl7dGhpcy5zZWxlY3Rpb25FbmQtdGhpcy5zZWxlY3Rpb25TdGFydD4xJiYodGhpcy5fcmVtb3ZlQ2hhcnNGcm9tVG8odGhpcy5zZWxlY3Rpb25TdGFydCx0aGlzLnNlbGVjdGlvbkVuZCksdGhpcy5zZXRTZWxlY3Rpb25FbmQodGhpcy5zZWxlY3Rpb25TdGFydCkpO3ZhciBpPVwiXFxuXCI9PT10aGlzLnRleHRbdGhpcy5zZWxlY3Rpb25TdGFydF07dGhpcy50ZXh0PXRoaXMudGV4dC5zbGljZSgwLHRoaXMuc2VsZWN0aW9uU3RhcnQpK3QrdGhpcy50ZXh0LnNsaWNlKHRoaXMuc2VsZWN0aW9uRW5kKSx0aGlzLmluc2VydFN0eWxlT2JqZWN0cyh0LGksZSksdGhpcy5zZXRTZWxlY3Rpb25TdGFydCh0aGlzLnNlbGVjdGlvblN0YXJ0K3QubGVuZ3RoKSx0aGlzLnNldFNlbGVjdGlvbkVuZCh0aGlzLnNlbGVjdGlvblN0YXJ0KSx0aGlzLmNhbnZhcyYmdGhpcy5jYW52YXMucmVuZGVyQWxsKCksdGhpcy5zZXRDb29yZHMoKSx0aGlzLmZpcmUoXCJjaGFuZ2VkXCIpLHRoaXMuY2FudmFzJiZ0aGlzLmNhbnZhcy5maXJlKFwidGV4dDpjaGFuZ2VkXCIse3RhcmdldDp0aGlzfSl9LGluc2VydE5ld2xpbmVTdHlsZU9iamVjdDpmdW5jdGlvbihlLGkscil7dGhpcy5zaGlmdExpbmVTdHlsZXMoZSwxKSx0aGlzLnN0eWxlc1tlKzFdfHwodGhpcy5zdHlsZXNbZSsxXT17fSk7dmFyIHM9e30sbj17fTtpZih0aGlzLnN0eWxlc1tlXSYmdGhpcy5zdHlsZXNbZV1baS0xXSYmKHM9dGhpcy5zdHlsZXNbZV1baS0xXSksciluWzBdPXQocyksdGhpcy5zdHlsZXNbZSsxXT1uO2Vsc2V7Zm9yKHZhciBvIGluIHRoaXMuc3R5bGVzW2VdKXBhcnNlSW50KG8sMTApPj1pJiYobltwYXJzZUludChvLDEwKS1pXT10aGlzLnN0eWxlc1tlXVtvXSxkZWxldGUgdGhpcy5zdHlsZXNbZV1bb10pO3RoaXMuc3R5bGVzW2UrMV09bn10aGlzLl9jbGVhckNhY2hlKCl9LGluc2VydENoYXJTdHlsZU9iamVjdDpmdW5jdGlvbihlLGkscil7dmFyIHM9dGhpcy5zdHlsZXNbZV0sbj10KHMpOzAhPT1pfHxyfHwoaT0xKTtmb3IodmFyIG8gaW4gbil7dmFyIGE9cGFyc2VJbnQobywxMCk7YT49aSYmKHNbYSsxXT1uW2FdKX10aGlzLnN0eWxlc1tlXVtpXT1yfHx0KHNbaS0xXSksdGhpcy5fY2xlYXJDYWNoZSgpfSxpbnNlcnRTdHlsZU9iamVjdHM6ZnVuY3Rpb24odCxlLGkpe3ZhciByPXRoaXMuZ2V0MkRDdXJzb3JMb2NhdGlvbigpLHM9ci5saW5lSW5kZXgsbj1yLmNoYXJJbmRleDt0aGlzLnN0eWxlc1tzXXx8KHRoaXMuc3R5bGVzW3NdPXt9KSxcIlxcblwiPT09dD90aGlzLmluc2VydE5ld2xpbmVTdHlsZU9iamVjdChzLG4sZSk6aT90aGlzLl9pbnNlcnRTdHlsZXModGhpcy5jb3BpZWRTdHlsZXMpOnRoaXMuaW5zZXJ0Q2hhclN0eWxlT2JqZWN0KHMsbil9LF9pbnNlcnRTdHlsZXM6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTAsaT10Lmxlbmd0aDtpPmU7ZSsrKXt2YXIgcj10aGlzLmdldDJEQ3Vyc29yTG9jYXRpb24odGhpcy5zZWxlY3Rpb25TdGFydCtlKSxzPXIubGluZUluZGV4LG49ci5jaGFySW5kZXg7dGhpcy5pbnNlcnRDaGFyU3R5bGVPYmplY3QocyxuLHRbZV0pfX0sc2hpZnRMaW5lU3R5bGVzOmZ1bmN0aW9uKGUsaSl7dmFyIHI9dCh0aGlzLnN0eWxlcyk7Zm9yKHZhciBzIGluIHRoaXMuc3R5bGVzKXt2YXIgbj1wYXJzZUludChzLDEwKTtuPmUmJih0aGlzLnN0eWxlc1tuK2ldPXJbbl0scltuLWldfHxkZWxldGUgdGhpcy5zdHlsZXNbbl0pfX0scmVtb3ZlU3R5bGVPYmplY3Q6ZnVuY3Rpb24oZSxpKXt2YXIgcj10aGlzLmdldDJEQ3Vyc29yTG9jYXRpb24oaSkscz1yLmxpbmVJbmRleCxuPXIuY2hhckluZGV4O2lmKGUpe3ZhciBvPXRoaXMuX3RleHRMaW5lc1tzLTFdLGE9bz9vLmxlbmd0aDowO3RoaXMuc3R5bGVzW3MtMV18fCh0aGlzLnN0eWxlc1tzLTFdPXt9KTtmb3IobiBpbiB0aGlzLnN0eWxlc1tzXSl0aGlzLnN0eWxlc1tzLTFdW3BhcnNlSW50KG4sMTApK2FdPXRoaXMuc3R5bGVzW3NdW25dO3RoaXMuc2hpZnRMaW5lU3R5bGVzKHMsLTEpfWVsc2V7dmFyIGg9dGhpcy5zdHlsZXNbc107aCYmZGVsZXRlIGhbbl07dmFyIGM9dChoKTtmb3IodmFyIGwgaW4gYyl7dmFyIHU9cGFyc2VJbnQobCwxMCk7dT49biYmMCE9PXUmJihoW3UtMV09Y1t1XSxkZWxldGUgaFt1XSl9fX0saW5zZXJ0TmV3bGluZTpmdW5jdGlvbigpe3RoaXMuaW5zZXJ0Q2hhcnMoXCJcXG5cIil9fSl9KCksZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuSVRleHQucHJvdG90eXBlLHtpbml0RG91YmxlQ2xpY2tTaW11bGF0aW9uOmZ1bmN0aW9uKCl7dGhpcy5fX2xhc3RDbGlja1RpbWU9K25ldyBEYXRlLHRoaXMuX19sYXN0TGFzdENsaWNrVGltZT0rbmV3IERhdGUsdGhpcy5fX2xhc3RQb2ludGVyPXt9LHRoaXMub24oXCJtb3VzZWRvd25cIix0aGlzLm9uTW91c2VEb3duLmJpbmQodGhpcykpfSxvbk1vdXNlRG93bjpmdW5jdGlvbih0KXt0aGlzLl9fbmV3Q2xpY2tUaW1lPStuZXcgRGF0ZTt2YXIgZT10aGlzLmNhbnZhcy5nZXRQb2ludGVyKHQuZSk7dGhpcy5pc1RyaXBsZUNsaWNrKGUpPyh0aGlzLmZpcmUoXCJ0cmlwbGVjbGlja1wiLHQpLHRoaXMuX3N0b3BFdmVudCh0LmUpKTp0aGlzLmlzRG91YmxlQ2xpY2soZSkmJih0aGlzLmZpcmUoXCJkYmxjbGlja1wiLHQpLHRoaXMuX3N0b3BFdmVudCh0LmUpKSx0aGlzLl9fbGFzdExhc3RDbGlja1RpbWU9dGhpcy5fX2xhc3RDbGlja1RpbWUsdGhpcy5fX2xhc3RDbGlja1RpbWU9dGhpcy5fX25ld0NsaWNrVGltZSx0aGlzLl9fbGFzdFBvaW50ZXI9ZSx0aGlzLl9fbGFzdElzRWRpdGluZz10aGlzLmlzRWRpdGluZyx0aGlzLl9fbGFzdFNlbGVjdGVkPXRoaXMuc2VsZWN0ZWR9LGlzRG91YmxlQ2xpY2s6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX19uZXdDbGlja1RpbWUtdGhpcy5fX2xhc3RDbGlja1RpbWU8NTAwJiZ0aGlzLl9fbGFzdFBvaW50ZXIueD09PXQueCYmdGhpcy5fX2xhc3RQb2ludGVyLnk9PT10LnkmJnRoaXMuX19sYXN0SXNFZGl0aW5nfSxpc1RyaXBsZUNsaWNrOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9fbmV3Q2xpY2tUaW1lLXRoaXMuX19sYXN0Q2xpY2tUaW1lPDUwMCYmdGhpcy5fX2xhc3RDbGlja1RpbWUtdGhpcy5fX2xhc3RMYXN0Q2xpY2tUaW1lPDUwMCYmdGhpcy5fX2xhc3RQb2ludGVyLng9PT10LngmJnRoaXMuX19sYXN0UG9pbnRlci55PT09dC55fSxfc3RvcEV2ZW50OmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQmJnQucHJldmVudERlZmF1bHQoKSx0LnN0b3BQcm9wYWdhdGlvbiYmdC5zdG9wUHJvcGFnYXRpb24oKX0saW5pdEN1cnNvclNlbGVjdGlvbkhhbmRsZXJzOmZ1bmN0aW9uKCl7dGhpcy5pbml0U2VsZWN0ZWRIYW5kbGVyKCksdGhpcy5pbml0TW91c2Vkb3duSGFuZGxlcigpLHRoaXMuaW5pdE1vdXNldXBIYW5kbGVyKCksdGhpcy5pbml0Q2xpY2tzKCl9LGluaXRDbGlja3M6ZnVuY3Rpb24oKXt0aGlzLm9uKFwiZGJsY2xpY2tcIixmdW5jdGlvbih0KXt0aGlzLnNlbGVjdFdvcmQodGhpcy5nZXRTZWxlY3Rpb25TdGFydEZyb21Qb2ludGVyKHQuZSkpfSksdGhpcy5vbihcInRyaXBsZWNsaWNrXCIsZnVuY3Rpb24odCl7dGhpcy5zZWxlY3RMaW5lKHRoaXMuZ2V0U2VsZWN0aW9uU3RhcnRGcm9tUG9pbnRlcih0LmUpKX0pfSxpbml0TW91c2Vkb3duSGFuZGxlcjpmdW5jdGlvbigpe3RoaXMub24oXCJtb3VzZWRvd25cIixmdW5jdGlvbih0KXt2YXIgZT10aGlzLmNhbnZhcy5nZXRQb2ludGVyKHQuZSk7dGhpcy5fX21vdXNlZG93blg9ZS54LHRoaXMuX19tb3VzZWRvd25ZPWUueSx0aGlzLl9faXNNb3VzZWRvd249ITAsdGhpcy5oaWRkZW5UZXh0YXJlYSYmdGhpcy5jYW52YXMmJnRoaXMuY2FudmFzLndyYXBwZXJFbC5hcHBlbmRDaGlsZCh0aGlzLmhpZGRlblRleHRhcmVhKSx0aGlzLnNlbGVjdGVkJiZ0aGlzLnNldEN1cnNvckJ5Q2xpY2sodC5lKSx0aGlzLmlzRWRpdGluZyYmKHRoaXMuX19zZWxlY3Rpb25TdGFydE9uTW91c2VEb3duPXRoaXMuc2VsZWN0aW9uU3RhcnQsdGhpcy5pbml0RGVsYXllZEN1cnNvcighMCkpfSl9LF9pc09iamVjdE1vdmVkOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuY2FudmFzLmdldFBvaW50ZXIodCk7cmV0dXJuIHRoaXMuX19tb3VzZWRvd25YIT09ZS54fHx0aGlzLl9fbW91c2Vkb3duWSE9PWUueX0saW5pdE1vdXNldXBIYW5kbGVyOmZ1bmN0aW9uKCl7dGhpcy5vbihcIm1vdXNldXBcIixmdW5jdGlvbih0KXt0aGlzLl9faXNNb3VzZWRvd249ITEsdGhpcy5faXNPYmplY3RNb3ZlZCh0LmUpfHwodGhpcy5fX2xhc3RTZWxlY3RlZCYmKHRoaXMuZW50ZXJFZGl0aW5nKCksdGhpcy5pbml0RGVsYXllZEN1cnNvcighMCkpLHRoaXMuc2VsZWN0ZWQ9ITApfSl9LHNldEN1cnNvckJ5Q2xpY2s6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXRTZWxlY3Rpb25TdGFydEZyb21Qb2ludGVyKHQpO3Quc2hpZnRLZXk/ZTx0aGlzLnNlbGVjdGlvblN0YXJ0Pyh0aGlzLnNldFNlbGVjdGlvbkVuZCh0aGlzLnNlbGVjdGlvblN0YXJ0KSx0aGlzLnNldFNlbGVjdGlvblN0YXJ0KGUpKTp0aGlzLnNldFNlbGVjdGlvbkVuZChlKToodGhpcy5zZXRTZWxlY3Rpb25TdGFydChlKSx0aGlzLnNldFNlbGVjdGlvbkVuZChlKSl9LF9nZXRMb2NhbFJvdGF0ZWRQb2ludGVyOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuY2FudmFzLmdldFBvaW50ZXIodCksaT1uZXcgZmFicmljLlBvaW50KGUueCxlLnkpLHI9bmV3IGZhYnJpYy5Qb2ludCh0aGlzLmxlZnQsdGhpcy50b3ApLHM9ZmFicmljLnV0aWwucm90YXRlUG9pbnQoaSxyLGZhYnJpYy51dGlsLmRlZ3JlZXNUb1JhZGlhbnMoLXRoaXMuYW5nbGUpKTtyZXR1cm4gdGhpcy5nZXRMb2NhbFBvaW50ZXIodCxzKX0sZ2V0U2VsZWN0aW9uU3RhcnRGcm9tUG9pbnRlcjpmdW5jdGlvbih0KXtmb3IodmFyIGUsaSxyPXRoaXMuX2dldExvY2FsUm90YXRlZFBvaW50ZXIodCkscz0wLG49MCxvPTAsYT0wLGg9MCxjPXRoaXMuX3RleHRMaW5lcy5sZW5ndGg7Yz5oO2grKyl7aT10aGlzLl90ZXh0TGluZXNbaF0sbys9dGhpcy5fZ2V0SGVpZ2h0T2ZMaW5lKHRoaXMuY3R4LGgpKnRoaXMuc2NhbGVZO3ZhciBsPXRoaXMuX2dldExpbmVXaWR0aCh0aGlzLmN0eCxoKSx1PXRoaXMuX2dldExpbmVMZWZ0T2Zmc2V0KGwpO249dSp0aGlzLnNjYWxlWCx0aGlzLmZsaXBYJiYodGhpcy5fdGV4dExpbmVzW2hdPWkucmV2ZXJzZSgpLmpvaW4oXCJcIikpO2Zvcih2YXIgZj0wLGQ9aS5sZW5ndGg7ZD5mO2YrKyl7aWYocz1uLG4rPXRoaXMuX2dldFdpZHRoT2ZDaGFyKHRoaXMuY3R4LGlbZl0saCx0aGlzLmZsaXBYP2QtZjpmKSp0aGlzLnNjYWxlWCwhKG88PXIueXx8bjw9ci54KSlyZXR1cm4gdGhpcy5fZ2V0TmV3U2VsZWN0aW9uU3RhcnRGcm9tT2Zmc2V0KHIscyxuLGEraCxkKTthKyt9aWYoci55PG8pcmV0dXJuIHRoaXMuX2dldE5ld1NlbGVjdGlvblN0YXJ0RnJvbU9mZnNldChyLHMsbixhK2gsZCl9cmV0dXJuXCJ1bmRlZmluZWRcIj09dHlwZW9mIGU/dGhpcy50ZXh0Lmxlbmd0aDp2b2lkIDB9LF9nZXROZXdTZWxlY3Rpb25TdGFydEZyb21PZmZzZXQ6ZnVuY3Rpb24odCxlLGkscixzKXt2YXIgbj10LngtZSxvPWktdC54LGE9bz5uPzA6MSxoPXIrYTtyZXR1cm4gdGhpcy5mbGlwWCYmKGg9cy1oKSxoPnRoaXMudGV4dC5sZW5ndGgmJihoPXRoaXMudGV4dC5sZW5ndGgpLGh9fSksZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuSVRleHQucHJvdG90eXBlLHtpbml0SGlkZGVuVGV4dGFyZWE6ZnVuY3Rpb24oKXt0aGlzLmhpZGRlblRleHRhcmVhPWZhYnJpYy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGV4dGFyZWFcIiksdGhpcy5oaWRkZW5UZXh0YXJlYS5zZXRBdHRyaWJ1dGUoXCJhdXRvY2FwaXRhbGl6ZVwiLFwib2ZmXCIpLHRoaXMuaGlkZGVuVGV4dGFyZWEuc3R5bGUuY3NzVGV4dD1cInBvc2l0aW9uOiBmaXhlZDsgYm90dG9tOiAyMHB4OyBsZWZ0OiAwcHg7IG9wYWNpdHk6IDA7IHdpZHRoOiAwcHg7IGhlaWdodDogMHB4OyB6LWluZGV4OiAtOTk5O1wiLGZhYnJpYy5kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuaGlkZGVuVGV4dGFyZWEpLGZhYnJpYy51dGlsLmFkZExpc3RlbmVyKHRoaXMuaGlkZGVuVGV4dGFyZWEsXCJrZXlkb3duXCIsdGhpcy5vbktleURvd24uYmluZCh0aGlzKSksZmFicmljLnV0aWwuYWRkTGlzdGVuZXIodGhpcy5oaWRkZW5UZXh0YXJlYSxcImtleXByZXNzXCIsdGhpcy5vbktleVByZXNzLmJpbmQodGhpcykpLGZhYnJpYy51dGlsLmFkZExpc3RlbmVyKHRoaXMuaGlkZGVuVGV4dGFyZWEsXCJjb3B5XCIsdGhpcy5jb3B5LmJpbmQodGhpcykpLGZhYnJpYy51dGlsLmFkZExpc3RlbmVyKHRoaXMuaGlkZGVuVGV4dGFyZWEsXCJwYXN0ZVwiLHRoaXMucGFzdGUuYmluZCh0aGlzKSksIXRoaXMuX2NsaWNrSGFuZGxlckluaXRpYWxpemVkJiZ0aGlzLmNhbnZhcyYmKGZhYnJpYy51dGlsLmFkZExpc3RlbmVyKHRoaXMuY2FudmFzLnVwcGVyQ2FudmFzRWwsXCJjbGlja1wiLHRoaXMub25DbGljay5iaW5kKHRoaXMpKSx0aGlzLl9jbGlja0hhbmRsZXJJbml0aWFsaXplZD0hMCl9LF9rZXlzTWFwOns4OlwicmVtb3ZlQ2hhcnNcIiw5OlwiZXhpdEVkaXRpbmdcIiwyNzpcImV4aXRFZGl0aW5nXCIsMTM6XCJpbnNlcnROZXdsaW5lXCIsMzM6XCJtb3ZlQ3Vyc29yVXBcIiwzNDpcIm1vdmVDdXJzb3JEb3duXCIsMzU6XCJtb3ZlQ3Vyc29yUmlnaHRcIiwzNjpcIm1vdmVDdXJzb3JMZWZ0XCIsMzc6XCJtb3ZlQ3Vyc29yTGVmdFwiLDM4OlwibW92ZUN1cnNvclVwXCIsMzk6XCJtb3ZlQ3Vyc29yUmlnaHRcIiw0MDpcIm1vdmVDdXJzb3JEb3duXCIsNDY6XCJmb3J3YXJkRGVsZXRlXCJ9LF9jdHJsS2V5c01hcDp7NjU6XCJzZWxlY3RBbGxcIiw4ODpcImN1dFwifSxvbkNsaWNrOmZ1bmN0aW9uKCl7dGhpcy5oaWRkZW5UZXh0YXJlYSYmdGhpcy5oaWRkZW5UZXh0YXJlYS5mb2N1cygpfSxvbktleURvd246ZnVuY3Rpb24odCl7aWYodGhpcy5pc0VkaXRpbmcpe2lmKHQua2V5Q29kZSBpbiB0aGlzLl9rZXlzTWFwKXRoaXNbdGhpcy5fa2V5c01hcFt0LmtleUNvZGVdXSh0KTtlbHNle2lmKCEodC5rZXlDb2RlIGluIHRoaXMuX2N0cmxLZXlzTWFwJiYodC5jdHJsS2V5fHx0Lm1ldGFLZXkpKSlyZXR1cm47dGhpc1t0aGlzLl9jdHJsS2V5c01hcFt0LmtleUNvZGVdXSh0KX10LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLHQucHJldmVudERlZmF1bHQoKSx0aGlzLmNhbnZhcyYmdGhpcy5jYW52YXMucmVuZGVyQWxsKCl9fSxmb3J3YXJkRGVsZXRlOmZ1bmN0aW9uKHQpe3RoaXMuc2VsZWN0aW9uU3RhcnQ9PT10aGlzLnNlbGVjdGlvbkVuZCYmdGhpcy5tb3ZlQ3Vyc29yUmlnaHQodCksdGhpcy5yZW1vdmVDaGFycyh0KX0sY29weTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldFNlbGVjdGVkVGV4dCgpLGk9dGhpcy5fZ2V0Q2xpcGJvYXJkRGF0YSh0KTtpJiZpLnNldERhdGEoXCJ0ZXh0XCIsZSksdGhpcy5jb3BpZWRUZXh0PWUsdGhpcy5jb3BpZWRTdHlsZXM9dGhpcy5nZXRTZWxlY3Rpb25TdHlsZXModGhpcy5zZWxlY3Rpb25TdGFydCx0aGlzLnNlbGVjdGlvbkVuZCl9LHBhc3RlOmZ1bmN0aW9uKHQpe3ZhciBlPW51bGwsaT10aGlzLl9nZXRDbGlwYm9hcmREYXRhKHQpO2U9aT9pLmdldERhdGEoXCJ0ZXh0XCIpOnRoaXMuY29waWVkVGV4dCxlJiZ0aGlzLmluc2VydENoYXJzKGUsITApfSxjdXQ6ZnVuY3Rpb24odCl7dGhpcy5zZWxlY3Rpb25TdGFydCE9PXRoaXMuc2VsZWN0aW9uRW5kJiYodGhpcy5jb3B5KCksdGhpcy5yZW1vdmVDaGFycyh0KSl9LF9nZXRDbGlwYm9hcmREYXRhOmZ1bmN0aW9uKHQpe3JldHVybiB0JiYodC5jbGlwYm9hcmREYXRhfHxmYWJyaWMud2luZG93LmNsaXBib2FyZERhdGEpfSxvbktleVByZXNzOmZ1bmN0aW9uKHQpeyF0aGlzLmlzRWRpdGluZ3x8dC5tZXRhS2V5fHx0LmN0cmxLZXl8fCgwIT09dC53aGljaCYmdGhpcy5pbnNlcnRDaGFycyhTdHJpbmcuZnJvbUNoYXJDb2RlKHQud2hpY2gpKSx0LnN0b3BQcm9wYWdhdGlvbigpKX0sZ2V0RG93bkN1cnNvck9mZnNldDpmdW5jdGlvbih0LGUpe3ZhciBpLHIscz1lP3RoaXMuc2VsZWN0aW9uRW5kOnRoaXMuc2VsZWN0aW9uU3RhcnQsbj10aGlzLmdldDJEQ3Vyc29yTG9jYXRpb24ocyksbz1uLmxpbmVJbmRleCxhPXRoaXMuX3RleHRMaW5lc1tvXS5zbGljZSgwLG4uY2hhckluZGV4KSxoPXRoaXMuX3RleHRMaW5lc1tvXS5zbGljZShuLmNoYXJJbmRleCksYz10aGlzLl90ZXh0TGluZXNbbysxXXx8XCJcIjtpZihvPT09dGhpcy5fdGV4dExpbmVzLmxlbmd0aC0xfHx0Lm1ldGFLZXl8fDM0PT09dC5rZXlDb2RlKXJldHVybiB0aGlzLnRleHQubGVuZ3RoLXM7dmFyIGw9dGhpcy5fZ2V0TGluZVdpZHRoKHRoaXMuY3R4LG8pO3I9dGhpcy5fZ2V0TGluZUxlZnRPZmZzZXQobCk7Zm9yKHZhciB1PXIsZj0wLGQ9YS5sZW5ndGg7ZD5mO2YrKylpPWFbZl0sdSs9dGhpcy5fZ2V0V2lkdGhPZkNoYXIodGhpcy5jdHgsaSxvLGYpO3ZhciBnPXRoaXMuX2dldEluZGV4T25OZXh0TGluZShuLGMsdSk7cmV0dXJuIGgubGVuZ3RoKzErZ30sX2dldEluZGV4T25OZXh0TGluZTpmdW5jdGlvbih0LGUsaSl7Zm9yKHZhciByLHM9dC5saW5lSW5kZXgrMSxuPXRoaXMuX2dldExpbmVXaWR0aCh0aGlzLmN0eCxzKSxvPXRoaXMuX2dldExpbmVMZWZ0T2Zmc2V0KG4pLGE9byxoPTAsYz0wLGw9ZS5sZW5ndGg7bD5jO2MrKyl7dmFyIHU9ZVtjXSxmPXRoaXMuX2dldFdpZHRoT2ZDaGFyKHRoaXMuY3R4LHUscyxjKTtpZihhKz1mLGE+aSl7cj0hMDt2YXIgZD1hLWYsZz1hLHA9TWF0aC5hYnMoZC1pKSx2PU1hdGguYWJzKGctaSk7aD1wPnY/YysxOmM7YnJlYWt9fXJldHVybiByfHwoaD1lLmxlbmd0aCksaH0sbW92ZUN1cnNvckRvd246ZnVuY3Rpb24odCl7dGhpcy5hYm9ydEN1cnNvckFuaW1hdGlvbigpLHRoaXMuX2N1cnJlbnRDdXJzb3JPcGFjaXR5PTE7dmFyIGU9dGhpcy5nZXREb3duQ3Vyc29yT2Zmc2V0KHQsXCJyaWdodFwiPT09dGhpcy5fc2VsZWN0aW9uRGlyZWN0aW9uKTt0LnNoaWZ0S2V5P3RoaXMubW92ZUN1cnNvckRvd25XaXRoU2hpZnQoZSk6dGhpcy5tb3ZlQ3Vyc29yRG93bldpdGhvdXRTaGlmdChlKSx0aGlzLmluaXREZWxheWVkQ3Vyc29yKCl9LG1vdmVDdXJzb3JEb3duV2l0aG91dFNoaWZ0OmZ1bmN0aW9uKHQpe3RoaXMuX3NlbGVjdGlvbkRpcmVjdGlvbj1cInJpZ2h0XCIsdGhpcy5zZXRTZWxlY3Rpb25TdGFydCh0aGlzLnNlbGVjdGlvblN0YXJ0K3QpLHRoaXMuc2V0U2VsZWN0aW9uRW5kKHRoaXMuc2VsZWN0aW9uU3RhcnQpfSxzd2FwU2VsZWN0aW9uUG9pbnRzOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5zZWxlY3Rpb25FbmQ7dGhpcy5zZXRTZWxlY3Rpb25FbmQodGhpcy5zZWxlY3Rpb25TdGFydCksdGhpcy5zZXRTZWxlY3Rpb25TdGFydCh0KX0sbW92ZUN1cnNvckRvd25XaXRoU2hpZnQ6ZnVuY3Rpb24odCl7dGhpcy5zZWxlY3Rpb25FbmQ9PT10aGlzLnNlbGVjdGlvblN0YXJ0JiYodGhpcy5fc2VsZWN0aW9uRGlyZWN0aW9uPVwicmlnaHRcIiksXCJyaWdodFwiPT09dGhpcy5fc2VsZWN0aW9uRGlyZWN0aW9uP3RoaXMuc2V0U2VsZWN0aW9uRW5kKHRoaXMuc2VsZWN0aW9uRW5kK3QpOnRoaXMuc2V0U2VsZWN0aW9uU3RhcnQodGhpcy5zZWxlY3Rpb25TdGFydCt0KSx0aGlzLnNlbGVjdGlvbkVuZDx0aGlzLnNlbGVjdGlvblN0YXJ0JiZcImxlZnRcIj09PXRoaXMuX3NlbGVjdGlvbkRpcmVjdGlvbiYmKHRoaXMuc3dhcFNlbGVjdGlvblBvaW50cygpLHRoaXMuX3NlbGVjdGlvbkRpcmVjdGlvbj1cInJpZ2h0XCIpLHRoaXMuc2VsZWN0aW9uRW5kPnRoaXMudGV4dC5sZW5ndGgmJnRoaXMuc2V0U2VsZWN0aW9uRW5kKHRoaXMudGV4dC5sZW5ndGgpfSxnZXRVcEN1cnNvck9mZnNldDpmdW5jdGlvbih0LGUpe3ZhciBpPWU/dGhpcy5zZWxlY3Rpb25FbmQ6dGhpcy5zZWxlY3Rpb25TdGFydCxyPXRoaXMuZ2V0MkRDdXJzb3JMb2NhdGlvbihpKSxzPXIubGluZUluZGV4O2lmKDA9PT1zfHx0Lm1ldGFLZXl8fDMzPT09dC5rZXlDb2RlKXJldHVybiBpO2Zvcih2YXIgbixvPXRoaXMuX3RleHRMaW5lc1tzXS5zbGljZSgwLHIuY2hhckluZGV4KSxhPXRoaXMuX3RleHRMaW5lc1tzLTFdfHxcIlwiLGg9dGhpcy5fZ2V0TGluZVdpZHRoKHRoaXMuY3R4LHIubGluZUluZGV4KSxjPXRoaXMuX2dldExpbmVMZWZ0T2Zmc2V0KGgpLGw9Yyx1PTAsZj1vLmxlbmd0aDtmPnU7dSsrKW49b1t1XSxsKz10aGlzLl9nZXRXaWR0aE9mQ2hhcih0aGlzLmN0eCxuLHMsdSk7dmFyIGQ9dGhpcy5fZ2V0SW5kZXhPblByZXZMaW5lKHIsYSxsKTtyZXR1cm4gYS5sZW5ndGgtZCtvLmxlbmd0aH0sX2dldEluZGV4T25QcmV2TGluZTpmdW5jdGlvbih0LGUsaSl7Zm9yKHZhciByLHM9dC5saW5lSW5kZXgtMSxuPXRoaXMuX2dldExpbmVXaWR0aCh0aGlzLmN0eCxzKSxvPXRoaXMuX2dldExpbmVMZWZ0T2Zmc2V0KG4pLGE9byxoPTAsYz0wLGw9ZS5sZW5ndGg7bD5jO2MrKyl7dmFyIHU9ZVtjXSxmPXRoaXMuX2dldFdpZHRoT2ZDaGFyKHRoaXMuY3R4LHUscyxjKTtpZihhKz1mLGE+aSl7cj0hMDt2YXIgZD1hLWYsZz1hLHA9TWF0aC5hYnMoZC1pKSx2PU1hdGguYWJzKGctaSk7aD1wPnY/YzpjLTE7YnJlYWt9fXJldHVybiByfHwoaD1lLmxlbmd0aC0xKSxofSxtb3ZlQ3Vyc29yVXA6ZnVuY3Rpb24odCl7dGhpcy5hYm9ydEN1cnNvckFuaW1hdGlvbigpLHRoaXMuX2N1cnJlbnRDdXJzb3JPcGFjaXR5PTE7dmFyIGU9dGhpcy5nZXRVcEN1cnNvck9mZnNldCh0LFwicmlnaHRcIj09PXRoaXMuX3NlbGVjdGlvbkRpcmVjdGlvbik7dC5zaGlmdEtleT90aGlzLm1vdmVDdXJzb3JVcFdpdGhTaGlmdChlKTp0aGlzLm1vdmVDdXJzb3JVcFdpdGhvdXRTaGlmdChlKSx0aGlzLmluaXREZWxheWVkQ3Vyc29yKCl9LG1vdmVDdXJzb3JVcFdpdGhTaGlmdDpmdW5jdGlvbih0KXt0aGlzLnNlbGVjdGlvbkVuZD09PXRoaXMuc2VsZWN0aW9uU3RhcnQmJih0aGlzLl9zZWxlY3Rpb25EaXJlY3Rpb249XCJsZWZ0XCIpLFwicmlnaHRcIj09PXRoaXMuX3NlbGVjdGlvbkRpcmVjdGlvbj90aGlzLnNldFNlbGVjdGlvbkVuZCh0aGlzLnNlbGVjdGlvbkVuZC10KTp0aGlzLnNldFNlbGVjdGlvblN0YXJ0KHRoaXMuc2VsZWN0aW9uU3RhcnQtdCksdGhpcy5zZWxlY3Rpb25FbmQ8dGhpcy5zZWxlY3Rpb25TdGFydCYmXCJyaWdodFwiPT09dGhpcy5fc2VsZWN0aW9uRGlyZWN0aW9uJiYodGhpcy5zd2FwU2VsZWN0aW9uUG9pbnRzKCksdGhpcy5fc2VsZWN0aW9uRGlyZWN0aW9uPVwibGVmdFwiKX0sbW92ZUN1cnNvclVwV2l0aG91dFNoaWZ0OmZ1bmN0aW9uKHQpe3RoaXMuc2VsZWN0aW9uU3RhcnQ9PT10aGlzLnNlbGVjdGlvbkVuZCYmdGhpcy5zZXRTZWxlY3Rpb25TdGFydCh0aGlzLnNlbGVjdGlvblN0YXJ0LXQpLHRoaXMuc2V0U2VsZWN0aW9uRW5kKHRoaXMuc2VsZWN0aW9uU3RhcnQpLHRoaXMuX3NlbGVjdGlvbkRpcmVjdGlvbj1cImxlZnRcIn0sbW92ZUN1cnNvckxlZnQ6ZnVuY3Rpb24odCl7KDAhPT10aGlzLnNlbGVjdGlvblN0YXJ0fHwwIT09dGhpcy5zZWxlY3Rpb25FbmQpJiYodGhpcy5hYm9ydEN1cnNvckFuaW1hdGlvbigpLHRoaXMuX2N1cnJlbnRDdXJzb3JPcGFjaXR5PTEsdC5zaGlmdEtleT90aGlzLm1vdmVDdXJzb3JMZWZ0V2l0aFNoaWZ0KHQpOnRoaXMubW92ZUN1cnNvckxlZnRXaXRob3V0U2hpZnQodCksdGhpcy5pbml0RGVsYXllZEN1cnNvcigpKX0sX21vdmU6ZnVuY3Rpb24odCxlLGkpe3ZhciByPVwic2VsZWN0aW9uU3RhcnRcIj09PWU/XCJzZXRTZWxlY3Rpb25TdGFydFwiOlwic2V0U2VsZWN0aW9uRW5kXCI7dGhpc1tyXSh0LmFsdEtleT90aGlzW1wiZmluZFdvcmRCb3VuZGFyeVwiK2ldKHRoaXNbZV0pOnQubWV0YUtleXx8MzU9PT10LmtleUNvZGV8fDM2PT09dC5rZXlDb2RlP3RoaXNbXCJmaW5kTGluZUJvdW5kYXJ5XCIraV0odGhpc1tlXSk6dGhpc1tlXSsoXCJMZWZ0XCI9PT1pPy0xOjEpKX0sX21vdmVMZWZ0OmZ1bmN0aW9uKHQsZSl7dGhpcy5fbW92ZSh0LGUsXCJMZWZ0XCIpfSxfbW92ZVJpZ2h0OmZ1bmN0aW9uKHQsZSl7dGhpcy5fbW92ZSh0LGUsXCJSaWdodFwiKX0sbW92ZUN1cnNvckxlZnRXaXRob3V0U2hpZnQ6ZnVuY3Rpb24odCl7dGhpcy5fc2VsZWN0aW9uRGlyZWN0aW9uPVwibGVmdFwiLHRoaXMuc2VsZWN0aW9uRW5kPT09dGhpcy5zZWxlY3Rpb25TdGFydCYmdGhpcy5fbW92ZUxlZnQodCxcInNlbGVjdGlvblN0YXJ0XCIpLHRoaXMuc2V0U2VsZWN0aW9uRW5kKHRoaXMuc2VsZWN0aW9uU3RhcnQpfSxtb3ZlQ3Vyc29yTGVmdFdpdGhTaGlmdDpmdW5jdGlvbih0KXtcInJpZ2h0XCI9PT10aGlzLl9zZWxlY3Rpb25EaXJlY3Rpb24mJnRoaXMuc2VsZWN0aW9uU3RhcnQhPT10aGlzLnNlbGVjdGlvbkVuZD90aGlzLl9tb3ZlTGVmdCh0LFwic2VsZWN0aW9uRW5kXCIpOih0aGlzLl9zZWxlY3Rpb25EaXJlY3Rpb249XCJsZWZ0XCIsdGhpcy5fbW92ZUxlZnQodCxcInNlbGVjdGlvblN0YXJ0XCIpKX0sbW92ZUN1cnNvclJpZ2h0OmZ1bmN0aW9uKHQpe3RoaXMuc2VsZWN0aW9uU3RhcnQ+PXRoaXMudGV4dC5sZW5ndGgmJnRoaXMuc2VsZWN0aW9uRW5kPj10aGlzLnRleHQubGVuZ3RofHwodGhpcy5hYm9ydEN1cnNvckFuaW1hdGlvbigpLHRoaXMuX2N1cnJlbnRDdXJzb3JPcGFjaXR5PTEsdC5zaGlmdEtleT90aGlzLm1vdmVDdXJzb3JSaWdodFdpdGhTaGlmdCh0KTp0aGlzLm1vdmVDdXJzb3JSaWdodFdpdGhvdXRTaGlmdCh0KSx0aGlzLmluaXREZWxheWVkQ3Vyc29yKCkpfSxtb3ZlQ3Vyc29yUmlnaHRXaXRoU2hpZnQ6ZnVuY3Rpb24odCl7XCJsZWZ0XCI9PT10aGlzLl9zZWxlY3Rpb25EaXJlY3Rpb24mJnRoaXMuc2VsZWN0aW9uU3RhcnQhPT10aGlzLnNlbGVjdGlvbkVuZD90aGlzLl9tb3ZlUmlnaHQodCxcInNlbGVjdGlvblN0YXJ0XCIpOih0aGlzLl9zZWxlY3Rpb25EaXJlY3Rpb249XCJyaWdodFwiLHRoaXMuX21vdmVSaWdodCh0LFwic2VsZWN0aW9uRW5kXCIpKX0sbW92ZUN1cnNvclJpZ2h0V2l0aG91dFNoaWZ0OmZ1bmN0aW9uKHQpe3RoaXMuX3NlbGVjdGlvbkRpcmVjdGlvbj1cInJpZ2h0XCIsdGhpcy5zZWxlY3Rpb25TdGFydD09PXRoaXMuc2VsZWN0aW9uRW5kPyh0aGlzLl9tb3ZlUmlnaHQodCxcInNlbGVjdGlvblN0YXJ0XCIpLHRoaXMuc2V0U2VsZWN0aW9uRW5kKHRoaXMuc2VsZWN0aW9uU3RhcnQpKToodGhpcy5zZXRTZWxlY3Rpb25FbmQodGhpcy5zZWxlY3Rpb25FbmQrdGhpcy5nZXROdW1OZXdMaW5lc0luU2VsZWN0ZWRUZXh0KCkpLHRoaXMuc2V0U2VsZWN0aW9uU3RhcnQodGhpcy5zZWxlY3Rpb25FbmQpKX0scmVtb3ZlQ2hhcnM6ZnVuY3Rpb24odCl7dGhpcy5zZWxlY3Rpb25TdGFydD09PXRoaXMuc2VsZWN0aW9uRW5kP3RoaXMuX3JlbW92ZUNoYXJzTmVhckN1cnNvcih0KTp0aGlzLl9yZW1vdmVDaGFyc0Zyb21Ubyh0aGlzLnNlbGVjdGlvblN0YXJ0LHRoaXMuc2VsZWN0aW9uRW5kKSx0aGlzLnNldFNlbGVjdGlvbkVuZCh0aGlzLnNlbGVjdGlvblN0YXJ0KSx0aGlzLl9yZW1vdmVFeHRyYW5lb3VzU3R5bGVzKCksdGhpcy5fY2xlYXJDYWNoZSgpLHRoaXMuY2FudmFzJiZ0aGlzLmNhbnZhcy5yZW5kZXJBbGwoKSx0aGlzLnNldENvb3JkcygpLHRoaXMuZmlyZShcImNoYW5nZWRcIiksdGhpcy5jYW52YXMmJnRoaXMuY2FudmFzLmZpcmUoXCJ0ZXh0OmNoYW5nZWRcIix7dGFyZ2V0OnRoaXN9KX0sX3JlbW92ZUNoYXJzTmVhckN1cnNvcjpmdW5jdGlvbih0KXtpZigwIT09dGhpcy5zZWxlY3Rpb25TdGFydClpZih0Lm1ldGFLZXkpe3ZhciBlPXRoaXMuZmluZExpbmVCb3VuZGFyeUxlZnQodGhpcy5zZWxlY3Rpb25TdGFydCk7dGhpcy5fcmVtb3ZlQ2hhcnNGcm9tVG8oZSx0aGlzLnNlbGVjdGlvblN0YXJ0KSx0aGlzLnNldFNlbGVjdGlvblN0YXJ0KGUpfWVsc2UgaWYodC5hbHRLZXkpe3ZhciBpPXRoaXMuZmluZFdvcmRCb3VuZGFyeUxlZnQodGhpcy5zZWxlY3Rpb25TdGFydCk7dGhpcy5fcmVtb3ZlQ2hhcnNGcm9tVG8oaSx0aGlzLnNlbGVjdGlvblN0YXJ0KSx0aGlzLnNldFNlbGVjdGlvblN0YXJ0KGkpfWVsc2UgdGhpcy5fcmVtb3ZlU2luZ2xlQ2hhckFuZFN0eWxlKHRoaXMuc2VsZWN0aW9uU3RhcnQpLHRoaXMuc2V0U2VsZWN0aW9uU3RhcnQodGhpcy5zZWxlY3Rpb25TdGFydC0xKX19KSxmdW5jdGlvbigpe3ZhciB0PWZhYnJpYy51dGlsLnRvRml4ZWQsZT1mYWJyaWMuT2JqZWN0Lk5VTV9GUkFDVElPTl9ESUdJVFM7ZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuSVRleHQucHJvdG90eXBlLHtfc2V0U1ZHVGV4dExpbmVUZXh0OmZ1bmN0aW9uKHQsZSxpLHIscyxuKXt0aGlzLnN0eWxlc1t0XT90aGlzLl9zZXRTVkdUZXh0TGluZUNoYXJzKHQsZSxpLHIsbik6dGhpcy5jYWxsU3VwZXIoXCJfc2V0U1ZHVGV4dExpbmVUZXh0XCIsdCxlLGkscixzKX0sX3NldFNWR1RleHRMaW5lQ2hhcnM6ZnVuY3Rpb24odCxlLGkscixzKXtmb3IodmFyIG49dGhpcy5fdGV4dExpbmVzW3RdLG89MCxhPXRoaXMuX2dldFNWR0xpbmVMZWZ0T2Zmc2V0KHQpLXRoaXMud2lkdGgvMixoPXRoaXMuX2dldFNWR0xpbmVUb3BPZmZzZXQodCksYz10aGlzLl9nZXRIZWlnaHRPZkxpbmUodGhpcy5jdHgsdCksbD0wLHU9bi5sZW5ndGg7dT5sO2wrKyl7dmFyIGY9dGhpcy5zdHlsZXNbdF1bbF18fHt9O2UucHVzaCh0aGlzLl9jcmVhdGVUZXh0Q2hhclNwYW4obltsXSxmLGEsaC5saW5lVG9wK2gub2Zmc2V0LG8pKTt2YXIgZD10aGlzLl9nZXRXaWR0aE9mQ2hhcih0aGlzLmN0eCxuW2xdLHQsbCk7Zi50ZXh0QmFja2dyb3VuZENvbG9yJiZzLnB1c2godGhpcy5fY3JlYXRlVGV4dENoYXJCZyhmLGEsaC5saW5lVG9wLGMsZCxvKSksbys9ZH19LF9nZXRTVkdMaW5lTGVmdE9mZnNldDpmdW5jdGlvbih0KXtyZXR1cm4gZmFicmljLnV0aWwudG9GaXhlZCh0aGlzLl9nZXRMaW5lTGVmdE9mZnNldCh0aGlzLl9fbGluZVdpZHRoc1t0XSksMil9LF9nZXRTVkdMaW5lVG9wT2Zmc2V0OmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT0wLGk9MCxyPTA7dD5yO3IrKyllKz10aGlzLl9nZXRIZWlnaHRPZkxpbmUodGhpcy5jdHgscik7cmV0dXJuIGk9dGhpcy5fZ2V0SGVpZ2h0T2ZMaW5lKHRoaXMuY3R4LHIpLHtsaW5lVG9wOmUsb2Zmc2V0Oih0aGlzLl9mb250U2l6ZU11bHQtdGhpcy5fZm9udFNpemVGcmFjdGlvbikqaS8odGhpcy5saW5lSGVpZ2h0KnRoaXMuX2ZvbnRTaXplTXVsdCl9fSxfY3JlYXRlVGV4dENoYXJCZzpmdW5jdGlvbihpLHIscyxuLG8sYSl7cmV0dXJuWyc8cmVjdCBmaWxsPVwiJyxpLnRleHRCYWNrZ3JvdW5kQ29sb3IsJ1wiIHg9XCInLHQocithLGUpLCdcIiB5PVwiJyx0KHMtdGhpcy5oZWlnaHQvMixlKSwnXCIgd2lkdGg9XCInLHQobyxlKSwnXCIgaGVpZ2h0PVwiJyx0KG4vdGhpcy5saW5lSGVpZ2h0LGUpLCdcIj48L3JlY3Q+J10uam9pbihcIlwiKX0sX2NyZWF0ZVRleHRDaGFyU3BhbjpmdW5jdGlvbih0LGUsaSxyLHMpe3ZhciBuPXRoaXMuZ2V0U3ZnU3R5bGVzLmNhbGwoZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZCh7dmlzaWJsZTohMCxmaWxsOnRoaXMuZmlsbCxzdHJva2U6dGhpcy5zdHJva2UsdHlwZTpcInRleHRcIn0sZSkpO3JldHVyblsnPHRzcGFuIHg9XCInLGkrcywnXCIgeT1cIicsci10aGlzLmhlaWdodC8yLCdcIiAnLGUuZm9udEZhbWlseT8nZm9udC1mYW1pbHk9XCInK2UuZm9udEZhbWlseS5yZXBsYWNlKC9cIi9nLFwiJ1wiKSsnXCIgJzpcIlwiLGUuZm9udFNpemU/J2ZvbnQtc2l6ZT1cIicrZS5mb250U2l6ZSsnXCIgJzpcIlwiLGUuZm9udFN0eWxlPydmb250LXN0eWxlPVwiJytlLmZvbnRTdHlsZSsnXCIgJzpcIlwiLGUuZm9udFdlaWdodD8nZm9udC13ZWlnaHQ9XCInK2UuZm9udFdlaWdodCsnXCIgJzpcIlwiLGUudGV4dERlY29yYXRpb24/J3RleHQtZGVjb3JhdGlvbj1cIicrZS50ZXh0RGVjb3JhdGlvbisnXCIgJzpcIlwiLCdzdHlsZT1cIicsbiwnXCI+JyxmYWJyaWMudXRpbC5zdHJpbmcuZXNjYXBlWG1sKHQpLFwiPC90c3Bhbj5cIl0uam9pbihcIlwiKTtcclxuXHJcbn19KX0oKSxmdW5jdGlvbigpe2Z1bmN0aW9uIHJlcXVlc3QodCxlLGkpe3ZhciByPVVSTC5wYXJzZSh0KTtyLnBvcnR8fChyLnBvcnQ9MD09PXIucHJvdG9jb2wuaW5kZXhPZihcImh0dHBzOlwiKT80NDM6ODApO3ZhciBzPTA9PT1yLnByb3RvY29sLmluZGV4T2YoXCJodHRwczpcIik/SFRUUFM6SFRUUCxuPXMucmVxdWVzdCh7aG9zdG5hbWU6ci5ob3N0bmFtZSxwb3J0OnIucG9ydCxwYXRoOnIucGF0aCxtZXRob2Q6XCJHRVRcIn0sZnVuY3Rpb24odCl7dmFyIHI9XCJcIjtlJiZ0LnNldEVuY29kaW5nKGUpLHQub24oXCJlbmRcIixmdW5jdGlvbigpe2kocil9KSx0Lm9uKFwiZGF0YVwiLGZ1bmN0aW9uKGUpezIwMD09PXQuc3RhdHVzQ29kZSYmKHIrPWUpfSl9KTtuLm9uKFwiZXJyb3JcIixmdW5jdGlvbih0KXtmYWJyaWMubG9nKHQuZXJybm89PT1wcm9jZXNzLkVDT05OUkVGVVNFRD9cIkVDT05OUkVGVVNFRDogY29ubmVjdGlvbiByZWZ1c2VkIHRvIFwiK3IuaG9zdG5hbWUrXCI6XCIrci5wb3J0OnQubWVzc2FnZSksaShudWxsKX0pLG4uZW5kKCl9ZnVuY3Rpb24gcmVxdWVzdEZzKHQsZSl7dmFyIGk9cmVxdWlyZShcImZzXCIpO2kucmVhZEZpbGUodCxmdW5jdGlvbih0LGkpe2lmKHQpdGhyb3cgZmFicmljLmxvZyh0KSx0O2UoaSl9KX1pZihcInVuZGVmaW5lZFwiPT10eXBlb2YgZG9jdW1lbnR8fFwidW5kZWZpbmVkXCI9PXR5cGVvZiB3aW5kb3cpe3ZhciBET01QYXJzZXI9cmVxdWlyZShcInhtbGRvbVwiKS5ET01QYXJzZXIsVVJMPXJlcXVpcmUoXCJ1cmxcIiksSFRUUD1yZXF1aXJlKFwiaHR0cFwiKSxIVFRQUz1yZXF1aXJlKFwiaHR0cHNcIiksQ2FudmFzPXJlcXVpcmUoXCJjYW52YXNcIiksSW1hZ2U9cmVxdWlyZShcImNhbnZhc1wiKS5JbWFnZTtmYWJyaWMudXRpbC5sb2FkSW1hZ2U9ZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIHIocil7cj8ocy5zcmM9bmV3IEJ1ZmZlcihyLFwiYmluYXJ5XCIpLHMuX3NyYz10LGUmJmUuY2FsbChpLHMpKToocz1udWxsLGUmJmUuY2FsbChpLG51bGwsITApKX12YXIgcz1uZXcgSW1hZ2U7dCYmKHQgaW5zdGFuY2VvZiBCdWZmZXJ8fDA9PT10LmluZGV4T2YoXCJkYXRhXCIpKT8ocy5zcmM9cy5fc3JjPXQsZSYmZS5jYWxsKGkscykpOnQmJjAhPT10LmluZGV4T2YoXCJodHRwXCIpP3JlcXVlc3RGcyh0LHIpOnQ/cmVxdWVzdCh0LFwiYmluYXJ5XCIscik6ZSYmZS5jYWxsKGksdCl9LGZhYnJpYy5sb2FkU1ZHRnJvbVVSTD1mdW5jdGlvbih0LGUsaSl7dD10LnJlcGxhY2UoL15cXG5cXHMqLyxcIlwiKS5yZXBsYWNlKC9cXD8uKiQvLFwiXCIpLnRyaW0oKSwwIT09dC5pbmRleE9mKFwiaHR0cFwiKT9yZXF1ZXN0RnModCxmdW5jdGlvbih0KXtmYWJyaWMubG9hZFNWR0Zyb21TdHJpbmcodC50b1N0cmluZygpLGUsaSl9KTpyZXF1ZXN0KHQsXCJcIixmdW5jdGlvbih0KXtmYWJyaWMubG9hZFNWR0Zyb21TdHJpbmcodCxlLGkpfSl9LGZhYnJpYy5sb2FkU1ZHRnJvbVN0cmluZz1mdW5jdGlvbih0LGUsaSl7dmFyIHI9KG5ldyBET01QYXJzZXIpLnBhcnNlRnJvbVN0cmluZyh0KTtmYWJyaWMucGFyc2VTVkdEb2N1bWVudChyLmRvY3VtZW50RWxlbWVudCxmdW5jdGlvbih0LGkpe2UmJmUodCxpKX0saSl9LGZhYnJpYy51dGlsLmdldFNjcmlwdD1mdW5jdGlvbih1cmwsY2FsbGJhY2spe3JlcXVlc3QodXJsLFwiXCIsZnVuY3Rpb24oYm9keSl7ZXZhbChib2R5KSxjYWxsYmFjayYmY2FsbGJhY2soKX0pfSxmYWJyaWMuSW1hZ2UuZnJvbU9iamVjdD1mdW5jdGlvbih0LGUpe2ZhYnJpYy51dGlsLmxvYWRJbWFnZSh0LnNyYyxmdW5jdGlvbihpKXt2YXIgcj1uZXcgZmFicmljLkltYWdlKGkpO3IuX2luaXRDb25maWcodCksci5faW5pdEZpbHRlcnModC5maWx0ZXJzLGZ1bmN0aW9uKGkpe3IuZmlsdGVycz1pfHxbXSxyLl9pbml0RmlsdGVycyh0LnJlc2l6ZUZpbHRlcnMsZnVuY3Rpb24odCl7ci5yZXNpemVGaWx0ZXJzPXR8fFtdLGUmJmUocil9KX0pfSl9LGZhYnJpYy5jcmVhdGVDYW52YXNGb3JOb2RlPWZ1bmN0aW9uKHQsZSxpLHIpe3I9cnx8aTt2YXIgcz1mYWJyaWMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKSxuPW5ldyBDYW52YXModHx8NjAwLGV8fDYwMCxyKTtzLnN0eWxlPXt9LHMud2lkdGg9bi53aWR0aCxzLmhlaWdodD1uLmhlaWdodDt2YXIgbz1mYWJyaWMuQ2FudmFzfHxmYWJyaWMuU3RhdGljQ2FudmFzLGE9bmV3IG8ocyxpKTtyZXR1cm4gYS5jb250ZXh0Q29udGFpbmVyPW4uZ2V0Q29udGV4dChcIjJkXCIpLGEubm9kZUNhbnZhcz1uLGEuRm9udD1DYW52YXMuRm9udCxhfSxmYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZS5jcmVhdGVQTkdTdHJlYW09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2RlQ2FudmFzLmNyZWF0ZVBOR1N0cmVhbSgpfSxmYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZS5jcmVhdGVKUEVHU3RyZWFtPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm5vZGVDYW52YXMuY3JlYXRlSlBFR1N0cmVhbSh0KX07dmFyIG9yaWdTZXRXaWR0aD1mYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZS5zZXRXaWR0aDtmYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZS5zZXRXaWR0aD1mdW5jdGlvbih0LGUpe3JldHVybiBvcmlnU2V0V2lkdGguY2FsbCh0aGlzLHQsZSksdGhpcy5ub2RlQ2FudmFzLndpZHRoPXQsdGhpc30sZmFicmljLkNhbnZhcyYmKGZhYnJpYy5DYW52YXMucHJvdG90eXBlLnNldFdpZHRoPWZhYnJpYy5TdGF0aWNDYW52YXMucHJvdG90eXBlLnNldFdpZHRoKTt2YXIgb3JpZ1NldEhlaWdodD1mYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZS5zZXRIZWlnaHQ7ZmFicmljLlN0YXRpY0NhbnZhcy5wcm90b3R5cGUuc2V0SGVpZ2h0PWZ1bmN0aW9uKHQsZSl7cmV0dXJuIG9yaWdTZXRIZWlnaHQuY2FsbCh0aGlzLHQsZSksdGhpcy5ub2RlQ2FudmFzLmhlaWdodD10LHRoaXN9LGZhYnJpYy5DYW52YXMmJihmYWJyaWMuQ2FudmFzLnByb3RvdHlwZS5zZXRIZWlnaHQ9ZmFicmljLlN0YXRpY0NhbnZhcy5wcm90b3R5cGUuc2V0SGVpZ2h0KX19KCk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ0ltYWdlRWRpdG9yJywgWyduZ01hdGVyaWFsJywgJ25nQW5pbWF0ZScsICd1aS5zb3J0YWJsZScsICdpbWFnZS5jcm9wJywgJ2ltYWdlLnRleHQnLCAnaW1hZ2UuZHJhd2luZycsICdpbWFnZS5maWx0ZXJzJywgJ2ltYWdlLnNoYXBlcycsICdpbWFnZS5kaXJlY3RpdmVzJywgJ2ltYWdlLmJhc2ljcyddKVxyXG5cclxuLmNvbmZpZyhbJyRtZFRoZW1pbmdQcm92aWRlcicsIGZ1bmN0aW9uKCRtZFRoZW1pbmdQcm92aWRlcikge1xyXG4gICAgJG1kVGhlbWluZ1Byb3ZpZGVyLnRoZW1lKCdkZWZhdWx0JylcclxuICAgICAgICAucHJpbWFyeVBhbGV0dGUoJ2RlZXAtb3JhbmdlJylcclxuICAgICAgICAuYWNjZW50UGFsZXR0ZSgnYnJvd24nKTsgXHJcbn1dKVxyXG5cclxuLmNvbnRyb2xsZXIoJ01haW5Db250cm9sbGVyJywgWyckcm9vdFNjb3BlJywgJyRzY29wZScsICckdGltZW91dCcsICckJHJBRicsICckbWRCb3R0b21TaGVldCcsICdjYW52YXMnLCAnaGlzdG9yeScsICdzaW1wbGVTaGFwZXMnLCAnZmlsdGVycycsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJHRpbWVvdXQsICQkckFGLCAkbWRCb3R0b21TaGVldCwgY2FudmFzLCBoaXN0b3J5LCBzaW1wbGVTaGFwZXMsIGZpbHRlcnMpIHtcclxuXHJcbiAgICAvL3RydWUgYWZ0ZXIgdXNlciB1cGxvYWRzIGFuIGltYWdlIG9yIGNyZWF0ZSBhIG5ldyBjYW52YXNcclxuICAgICRyb290U2NvcGUuc3RhcnRlZCA9IGZhbHNlO1xyXG5cclxuICAgIC8vY2hlY2sgaWYgd2UncmUgb24gYSBkZW1vIHNpdGVcclxuICAgICRyb290U2NvcGUuaXNEZW1vID0gZG9jdW1lbnQuVVJMLmluZGV4T2YoJ3BpeGllLnZlYnRvLmNvbScpID4gLTE7XHJcblxyXG4gICAgJHJvb3RTY29wZS5pc0ludGVncmF0aW9uTW9kZSA9IGZhbHNlOyBcclxuICAgIHZhciBwYXJhbXMgPSBsb2NhdGlvbi5zZWFyY2guc3Vic3RyaW5nKDEpLnNwbGl0KCcmJyk7XHJcbiAgICB2YXIgdmFsdWVzID0ge307XHJcbiAgICBmb3IodmFyIGlkIGluIHBhcmFtcyl7XHJcbiAgICAgICAgdmFyIGtleV92YWx1ZSA9IHBhcmFtc1tpZF0uc3BsaXQoJz0nKTtcclxuICAgICAgICB2YWx1ZXNba2V5X3ZhbHVlWzBdXSA9IGtleV92YWx1ZVsxXTtcclxuICAgIH1cclxuICAgICRyb290U2NvcGUub3JkZXJfaWQgPXZhbHVlc1snb3JkZXJfaWQnXTtcclxuICAgICRyb290U2NvcGUucHJvZHVjdF9pZCA9IHZhbHVlc1sncHJvZHVjdF9pZCddO1xyXG5cclxuICAgIC8vY2hlY2sgaWYgd2UncmUgcnVubmluZyBpbiBpbnRlZ3JhdGlvbiBtb2RlXHJcbiAgICB0cnkge1xyXG4gICAgICAgIGlmICh3aW5kb3cuc2VsZiAhPT0gd2luZG93LnRvcCkgeyBcclxuICAgICAgICAgICAgJCgnc2NyaXB0Jywgd2luZG93LnBhcmVudC5kb2N1bWVudCkuZWFjaChmdW5jdGlvbihpLCBub2RlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobm9kZS5zcmMuaW5kZXhPZigncGl4aWUtaW50ZWdyYXRlJykgPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuaXNJbnRlZ3JhdGlvbk1vZGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICRyb290U2NvcGUuaXNJbnRlZ3JhdGlvbk1vZGUgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvL2dldCBhIHJlZmVyZW5jZSB0byB0b3Agd2luZG93IGlmIHdlJ3JlIGluc2lkZSBpZnJhbWVcclxuICAgIGlmICgkcm9vdFNjb3BlLmlzSW50ZWdyYXRpb25Nb2RlKSB7XHJcbiAgICAgICAgJHJvb3RTY29wZS5waXhpZSA9IHdpbmRvdy5wYXJlbnQuUGl4aWU7XHJcbiAgICB9XHJcblxyXG4gICAgJHJvb3RTY29wZS5nZXRQYXJhbSA9IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICBpZiAoJHJvb3RTY29wZS5waXhpZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJHJvb3RTY29wZS5waXhpZS5nZXRQYXJhbXMoKVtuYW1lXTtcclxuICAgICAgICB9IGVsc2UgaWYgKHdpbmRvdy5QaXhpZVBhcmFtcykge1xyXG4gICAgICAgICAgICByZXR1cm4gd2luZG93LlBpeGllUGFyYW1zW25hbWVdO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgY2FudmFzLnN0YXJ0KCk7XHJcblxyXG4gICAgLy9tYWtlIGFjdGlvbnMgcGFuZWxzIGRyYWdnYWJsZVxyXG4gICAgJCgnLmFjdGlvbnMtbWVudScpLmRyYWdnYWJsZSh7XHJcbiAgICAgICAgaGFuZGxlOiAnLm1lbnUtaGVhZGVyJyxcclxuICAgICAgICBjb250YWlubWVudDogJ2JvZHknXHJcbiAgICB9KTtcclxuXHJcblx0JHJvb3RTY29wZS5jYW52YXMgPSBjYW52YXM7XHJcblx0JHJvb3RTY29wZS5oaXN0b3J5ID0gaGlzdG9yeTtcclxuICAgIGlmKHZhbHVlc1snb3JkZXJfaWQnXSE9JycgJiYgdmFsdWVzWydwcm9kdWN0X2lkJ10hPScnKXtcclxuICAgICAgICAvL1wiL3dwLWNvbnRlbnQvdXBsb2Fkcy93aW5lc2hvcC1sYWJlbHMvXCIrJHJvb3RTY29wZS5vcmRlcl9pZCArIFwiLVwiICsgJHJvb3RTY29wZS5wcm9kdWN0X2lkK1wiLmpzb25cIlxyXG5cclxuICAgICAgICAvLyBUT0RPOiBDb252ZXJ0IHN0cmFpZ2h0IGZpbGUgbG9hZCB0byBhbiBBSkFYIHJlcXVlc3Q/XHJcbiAgICAgICAgalF1ZXJ5LmdldEpTT04oXCIvd3AtYWRtaW4vYWRtaW4tYWpheC5waHBcIiwge1xyXG4gICAgICAgICAgICBhY3Rpb246IFwid2luZXNob3BfbGFiZWxfbG9hZFwiLFxyXG4gICAgICAgICAgICBvcmRlcl9pZDogJHJvb3RTY29wZS5vcmRlcl9pZCxcclxuICAgICAgICAgICAgcHJvZHVjdF9pZDogJHJvb3RTY29wZS5wcm9kdWN0X2lkXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oIGRhdGEgKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggXCJFeGlzdGluZyBKU09OIEZvdW5kIVwiICk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuaGlzdG9yeSA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmhpc3RvcnkgPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgaGlzdG9yeS5sb2FkKGRhdGEpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuZmFpbChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTm8gRXhpc3RpbmcgSlNPTiBGb3VuZFwiKTtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5vcGVuTmV3KDExNTcsIDEyMjgpO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5pc05vdExvYWRpbmcoKTtcclxuICAgICAgICAgICAgICAgIGpRdWVyeShcIi5idG4taGVscFwiKS50cmlnZ2VyKFwiY2xpY2tcIik7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNob3dpbmcgSGVscCBNb2RhbFwiKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8qalF1ZXJ5LmdldEpTT04oXCIvd3AtY29udGVudC91cGxvYWRzL3dpbmVzaG9wLWxhYmVscy9cIiskcm9vdFNjb3BlLm9yZGVyX2lkICsgXCItXCIgKyAkcm9vdFNjb3BlLnByb2R1Y3RfaWQrXCIuanNvblwiLGZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgICAgICAkc2NvcGUuaGlzdG9yeSA9IGRhdGE7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuaGlzdG9yeSA9IGRhdGE7XHJcbiAgICAgICAgICAgIGhpc3RvcnkubG9hZChkYXRhKTtcclxuXHJcbiAgICAgICAgfSkuZmFpbChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBjYW52YXMub3Blbk5ldygxMTU3LCAxMjI4KTtcclxuICAgICAgICB9KTsqL1xyXG5cclxuICAgIH1lbHNle1xyXG4gICAgICAgIGNhbnZhcy5vcGVuTmV3KDExNTcsIDEyMjgpO1xyXG4gICAgfVxyXG4gICAgLy8gY29uc29sZS5sb2coY2FudmFzLmZhYnJpYyk7XHJcblxyXG4gICAgLy8gc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgLy8gICAgIGlmKCFjYW52YXMuZmFicmljLmJhY2tncm91bmRDb2xvciB8fCBjYW52YXMuZmFicmljLmJhY2tncm91bmRDb2xvcj09Jycpe1xyXG4gICAgLy8gICAgICAgICAvL2NhbnZhcy5mYWJyaWMuYmFja2dyb3VuZENvbG9yID0gJyNmZmZmZmYnO1xyXG4gICAgLy8gICAgIH1cclxuICAgIC8vICAgICAkcm9vdFNjb3BlLmJnQ29sb3IgPSBjYW52YXMuZmFicmljLmJhY2tncm91bmRDb2xvcjtcclxuICAgIC8vIH0sIDEwMDApO1xyXG5cclxuICAgICRyb290U2NvcGUuc2hhcGVzID0gc2ltcGxlU2hhcGVzO1xyXG5cdCRyb290U2NvcGUubG9hZGluZyA9IGZhbHNlO1xyXG4gICAgJHJvb3RTY29wZS5hbmltYXRpb25FbmRFdmVudCA9ICd3ZWJraXRBbmltYXRpb25FbmQgbW96QW5pbWF0aW9uRW5kIE1TQW5pbWF0aW9uRW5kIG9hbmltYXRpb25lbmQgYW5pbWF0aW9uZW5kJztcclxuICAgICRyb290U2NvcGUudHJhbnNpdGlvbkVuZEV2ZW50ID0gJ3dlYmtpdFRyYW5zaXRpb25FbmQgbW96VHJhbnNpdGlvbkVuZCBNU1RyYW5zaXRpb25FbmQgb2F0cmFuc2l0aW9uZW5kIGF0cmFuc2l0aW9uZW5kIHRyYW5zaXRpb25lbmQnO1xyXG5cclxuICAgICRyb290U2NvcGUubWF4UGFuZWxIZWlnaHQgPSAkKHdpbmRvdykuaGVpZ2h0KCkgLSAxMjA7XHJcblxyXG4gICAgJHJvb3RTY29wZS5vcGVuUGFuZWwgPSBmdW5jdGlvbihuYW1lLCBlKSB7XHJcbiAgICAgICAgaWYgKCRyb290U2NvcGUuYWN0aXZlUGFuZWwgPT09IG5hbWUpIHJldHVybjtcclxuXHJcbiAgICAgICAgaWYobmFtZT09J2NhbnZhc0NvbG9yJyl7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGNhbnZhcyk7XHJcbiAgICAgICAgICAgIGlmKCFjYW52YXMuZmFicmljLmJhY2tncm91bmRDb2xvciB8fCBjYW52YXMuZmFicmljLmJhY2tncm91bmRDb2xvcj09Jycpe1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRCYWNrZ3JvdW5kQ29sb3IoJyNmZmZmZmYnKTtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJHJvb3RTY29wZS5iZ0NvbG9yID0gY2FudmFzLmZhYnJpYy5iYWNrZ3JvdW5kQ29sb3I7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGNhbnZhcyk7XHJcbiAgICAgICAgICAgICQoXCIjY3ZzLWJnY29sb3JcIikuc3BlY3RydW0oXCJzZXRcIiwgJHJvb3RTY29wZS5iZ0NvbG9yKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRyb290U2NvcGUuYWN0aXZlUGFuZWwgPSBuYW1lO1xyXG5cclxuICAgICAgICB2YXIgcGFuZWwgPSAkKCdbZGF0YS1uYW1lPVwiJytuYW1lKydcIl0nKTtcclxuXHJcbiAgICAgICAgdmFyIGNsaWNrUmVjdCA9IGUudGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgIHZhciBwYW5lbFJlY3QgPSBwYW5lbFswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcbiAgICAgICAgdmFyIHNjYWxlWCA9IE1hdGgubWluKDAuNSwgY2xpY2tSZWN0LndpZHRoIC8gcGFuZWxSZWN0LndpZHRoKTtcclxuICAgICAgICB2YXIgc2NhbGVZID0gTWF0aC5taW4oMC41LCBjbGlja1JlY3QuaGVpZ2h0IC8gcGFuZWxSZWN0LmhlaWdodCk7XHJcblxyXG4gICAgICAgIHBhbmVsLnJlbW92ZUNsYXNzKCd0cmFuc2l0aW9uLWluJykuY3NzKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlM2QoJyArXHJcbiAgICAgICAgICAgICgtcGFuZWxSZWN0LmxlZnQgKyBjbGlja1JlY3QubGVmdCArIGNsaWNrUmVjdC53aWR0aC8yIC0gcGFuZWxSZWN0LndpZHRoLzIpICsgJ3B4LCcgK1xyXG4gICAgICAgICAgICAoLXBhbmVsUmVjdC50b3AgKyBjbGlja1JlY3QudG9wICsgY2xpY2tSZWN0LmhlaWdodC8yIC0gcGFuZWxSZWN0LmhlaWdodC8yKSArICdweCwnICtcclxuICAgICAgICAgICAgJzApIHNjYWxlKCcgKyBzY2FsZVggKyAnLCcgKyBzY2FsZVkgKyAnKSdcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAkJHJBRihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJChwYW5lbCkuYWRkQ2xhc3MoJ3RyYW5zaXRpb24taW4nKS5jc3MoJ3RyYW5zZm9ybScsICcnKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG5cdCRyb290U2NvcGUuaXNMb2FkaW5nID0gZnVuY3Rpb24oKSB7XHJcblx0XHQkdGltZW91dChmdW5jdGlvbigpIHtcclxuXHRcdFx0JHJvb3RTY29wZS5sb2FkaW5nID0gdHJ1ZTtcclxuXHRcdH0pO1xyXG5cdH07XHJcblxyXG5cdCRyb290U2NvcGUuaXNOb3RMb2FkaW5nID0gZnVuY3Rpb24oKSB7XHJcblx0XHQkdGltZW91dChmdW5jdGlvbigpIHtcclxuXHRcdFx0JHJvb3RTY29wZS5sb2FkaW5nID0gZmFsc2U7XHJcblx0XHR9KTtcclxuXHR9O1xyXG5cclxuXHQkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XHJcbiAgICAkcm9vdFNjb3BlLmFjdGl2ZVRhYiAgID0gZmFsc2U7XHJcblxyXG5cdCRyb290U2NvcGUua2V5cyA9IHtcclxuXHRcdGdvb2dsZV9mb250czogJ0FJemFTeURoY184Tkt4WGp0djY5aHRGY1VQZTZBN29HU1E0b20ybycsXHJcblx0fTtcclxuXHJcblx0JHJvb3RTY29wZS4kd2F0Y2goJ2FjdGl2ZVBhbmVsJywgZnVuY3Rpb24oKSB7XHJcblx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0JCh3aW5kb3cpLnJlc2l6ZSgpOyBcclxuXHRcdH0sIDEwMCk7XHJcblx0fSk7XHJcbiAgICBcclxuICAgICRyb290U2NvcGUucmVzZXRVSSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gbnVsbDtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVUYWIgICA9ICdiYXNpY3MnO1xyXG4gICAgICAgICAgICBzaW1wbGVTaGFwZXMuc2VsZWN0ZWQgID0gbnVsbDtcclxuICAgICAgICAgICAgZmlsdGVycy5hcHBsaWVkRmlsdGVycyA9IFtdO1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmhpc3RvcnkuYWxsID0gW107XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vb3BlbiBjb3JyZXNwb25kaW5nIHRhYiBpbiBsZWZ0IHBhbmVsIHdoZW4gdXNlciBzZWxlY3RzIGFuIG9iamVjdFxyXG4gICAgY2FudmFzLmZhYnJpYy5vbignb2JqZWN0OnNlbGVjdGVkJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIGlmIChlLnRhcmdldC5uYW1lID09ICd0ZXh0Jykge1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVRhYiA9ICd0ZXh0JztcclxuICAgICAgICB9IGVsc2UgaWYgKGUudGFyZ2V0Lm5hbWUgPT0gJ3N0aWNrZXInICYmICRyb290U2NvcGUuYWN0aXZlVGFiICE9PSAnc3RpY2tlcnMnKSB7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuYWN0aXZlVGFiID0gJ3N0aWNrZXJzJztcclxuICAgICAgICB9IGVsc2UgaWYgKGUudGFyZ2V0Lm5hbWUgJiYgJHJvb3RTY29wZS5hY3RpdmVUYWIgIT09ICdzaW1wbGUtc2hhcGVzJykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpbXBsZVNoYXBlcy5hdmFpbGFibGUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBzaGFwZSA9IHNpbXBsZVNoYXBlcy5hdmFpbGFibGVbaV07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHNoYXBlLm5hbWUgPT09IGUudGFyZ2V0Lm5hbWUgJiYgJHJvb3RTY29wZS5hY3RpdmVUYWIgIT09ICdzaW1wbGUtc2hhcGVzJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHNpbXBsZVNoYXBlcy5zZWxlY3RlZCA9IHNoYXBlO1xyXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuYWN0aXZlVGFiID0gJ3NpbXBsZS1zaGFwZXMnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkdGltZW91dChhbmd1bGFyLm5vb3ApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy9DbG9zZSBvYmplY3QgcGFuZWwgd2hlbiBvYmplY3QgaXMgZGUtc2VsZWN0ZWRcclxuICAgIGNhbnZhcy5mYWJyaWMub24oJ3NlbGVjdGlvbjpjbGVhcmVkJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJHRpbWVvdXQoYW5ndWxhci5ub29wKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vZGVzZWxlY3QgYWxsIG9iamVjdHMgd2hlbiBjbGlja2luZyBvdXRzaWRlIGNhbnZhc1xyXG4gICAgJCgnI3ZpZXdwb3J0Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIGlmIChlLnRhcmdldC5pZCA9PT0gJ3ZpZXdwb3J0Jykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInZpZXdwb3J0XCIpO1xyXG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuZGVhY3RpdmF0ZUFsbCgpLnJlbmRlckFsbCgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAkc2NvcGUub3BlbkJvdHRvbVNoZWV0ID0gZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgICRtZEJvdHRvbVNoZWV0LnNob3coe1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJCgnIycrbmFtZSsnLXNoZWV0LXRlbXBsYXRlJykuaHRtbCgpLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQm90dG9tU2hlZXRDb250cm9sbGVyJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTsgXHJcblxyXG4gICAgLy9jbGVhbnVwLiByZW1vdmUgY29sb3IgcGlja2VyIGNvbnRhaW5lcnMgb24gc2NvcGUgZGVzdHJveS5cclxuICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJCgnLnNwLWNvbnRhaW5lcicpLnJlbW92ZSgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgICRyb290U2NvcGUuc3BhY2lmeSA9IGZ1bmN0aW9uKHRleHQpIHtcclxuICAgICAgICBpZiAodGV4dCkge1xyXG4gICAgICAgICAgICB2YXIgdGVtcCA9IHRleHQucmVwbGFjZSggLyhbQS1aXSkvZywgXCIgJDFcIiApO1xyXG4gICAgICAgICAgICByZXR1cm4gdGVtcC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHRlbXAuc2xpY2UoMSk7XHJcbiAgICAgICAgfVxyXG4gICAgIH07XHJcblxyXG5cclxufV0pXHJcblxyXG4uY29udHJvbGxlcignQm90dG9tU2hlZXRDb250cm9sbGVyJywgWyckcm9vdFNjb3BlJywgJyRzY29wZScsICckbWRCb3R0b21TaGVldCcsICckbWREaWFsb2cnLCAnc2ltcGxlU2hhcGVzJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlLCAkbWRCb3R0b21TaGVldCwgJG1kRGlhbG9nLCBzaW1wbGVTaGFwZXMpIHtcclxuICAgICRzY29wZS5zaGFwZXMgPSBzaW1wbGVTaGFwZXM7XHJcblxyXG4gICAgJHNjb3BlLnNob3dEaWFsb2cgPSBmdW5jdGlvbigkZXZlbnQpIHtcclxuICAgICAgICAkbWREaWFsb2cuc2hvdyh7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlOiAkKCcjdGV4dHVyZS11cGxvYWQtZGlhbG9nLXRlbXBsYXRlJykuaHRtbCgpLFxyXG4gICAgICAgICAgICB0YXJnZXRFdmVudDogJGV2ZW50LFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQm90dG9tU2hlZXRDb250cm9sbGVyJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ0ltYWdlRWRpdG9yJylcclxuXHJcbi5mYWN0b3J5KCdsb2NhbFN0b3JhZ2UnLCBmdW5jdGlvbigpIHtcclxuXHR2YXIgc3RvcmFnZSA9IHtcclxuXHJcblx0XHQvKipcclxuXHRcdCAqIEhvdyBsb25nIChkYXlzKSBkYXRhIHdpbGwgYmUgY2FjaGVkIGluIGxvY2FsIHN0b3JhZ2UuXHJcblx0XHQgKiBcclxuXHRcdCAqIEB0eXBlIHtOdW1iZXJ9XHJcblx0XHQgKi9cclxuXHRcdGV4cGlyZUFmdGVyOiAyLFxyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogUmV0cmlldmUgdmFsdWUgdW5kZXIgZ2l2ZW4ga2V5IGZyb20gbG9jYWwgc3RvcmFnZS5cclxuXHRcdCAqIFxyXG5cdFx0ICogQHBhcmFtICBzdHJpbmcga2V5XHJcblx0XHQgKiBAcmV0dXJuIG1peGVkXHJcblx0XHQgKi9cclxuXHRcdGdldDogZnVuY3Rpb24oa2V5KSB7XHJcblx0XHRcdHZhciB2YWx1ZSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KSk7XHJcblx0XHRcdFxyXG5cdFx0XHRpZiAoICEgdmFsdWUgfHwgISBzdG9yYWdlLmlzVmFsaWQodmFsdWUudGltZSkpIHtcclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHJldHVybiB2YWx1ZS52YWx1ZTtcclxuXHRcdH0sXHJcblxyXG5cdFx0LyoqXHJcblx0XHQgKiBTdG9yZSB2YWx1ZSBpbnRvIGJyb3dzZXIgbG9jYWwgc3RvcmFnZS5cclxuXHRcdCAqIFxyXG5cdFx0ICogQHBhcmFtIHN0cmluZyBrZXlcclxuXHRcdCAqIEBwYXJhbSBtaXhlZCB2YWx1ZVxyXG5cdFx0ICovXHJcblx0XHRzZXQ6IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcclxuXHRcdFx0dmFyIGRhdGEgPSB7IHZhbHVlOiB2YWx1ZSwgdGltZTogbmV3IERhdGUoKS5nZXRUaW1lKCkgfTtcclxuXHJcblx0XHRcdHJldHVybiBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcclxuXHRcdH0sXHJcblxyXG5cdFx0LyoqXHJcblx0XHQgKiBXaGV0aGVyIG9yIG5vdCBjYWNoZSB3aXRoIGdpdmVuIHRpbWUgaXMgY29uc2lkZXJlZCBleHBpcmVkLlxyXG5cdFx0ICogXHJcblx0XHQgKiBAcGFyYW0gIHN0cmluZyAgdGltZVxyXG5cdFx0ICogQHJldHVybiB7Qm9vbGVhbn1cclxuXHRcdCAqL1xyXG5cdFx0aXNWYWxpZDogZnVuY3Rpb24odGltZSkge1xyXG5cdFx0XHR2YXIgZGF5cyA9IChuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIG5ldyBEYXRlKHRpbWUpLmdldFRpbWUoKSkvKDEwMDAqNjAqNjAqMjQpO1xyXG5cclxuXHRcdFx0cmV0dXJuIGRheXMgPCBzdG9yYWdlLmV4cGlyZUFmdGVyO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdHJldHVybiBzdG9yYWdlO1xyXG59KTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnSW1hZ2VFZGl0b3InKS5mYWN0b3J5KCdzZXR0aW5ncycsIFsnJHJvb3RTY29wZScsICckaHR0cCcsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRodHRwKSB7XHJcblxyXG5cdHZhciBzZXR0aW5ncyA9IHtcclxuICAgICAgICBhbGw6IHt9LFxyXG5cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWxsW25hbWVdO1xyXG4gICAgICAgIH1cclxuXHR9XHJcblxyXG4gICAgJGh0dHAuZ2V0KCcvd3AtYWRtaW4vYWRtaW4tYWpheC5waHA/YWN0aW9uPXdpbmVzaG9wX2xhYmVsX2dldF9waG90b3NfYW5kX3N0aWNrZXJzJykuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgc2V0dGluZ3MuYWxsID0gZGF0YTtcclxuXHJcbiAgICAgICAgJHJvb3RTY29wZS4kZW1pdCgnc2V0dGluZ3MucmVhZHknKTtcclxuICAgIH0pO1xyXG5cclxuXHRyZXR1cm4gc2V0dGluZ3M7XHJcbn1dKTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnSW1hZ2VFZGl0b3InKVxyXG5cclxuLmZhY3RvcnkoJ2tleWJpbmRzJywgWyckcm9vdFNjb3BlJywgZnVuY3Rpb24oJHJvb3RTY29wZSkge1xyXG5cclxuICAgIHZhciBrZXliaW5kcyA9IHtcclxuXHJcbiAgICAgICAgZmFicmljOiBmYWxzZSxcclxuXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oZmFicmljKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmFicmljID0gZmFicmljO1xyXG4gICAgICAgICAgICBpbml0KCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZGVzdHJveTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICQoJy5jYW52YXMtY29udGFpbmVyJykub2ZmKFwia2V5ZG93blwiLCBwcm9jZXNzS2V5cywgZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gaW5pdCgpIHtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbigna2V5ZG93bicsIGhhbmRsZUtleURvd24pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGhhbmRsZUtleURvd24oZSkge1xyXG4gICAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDtcclxuXHJcbiAgICAgICAgaWYgKFszNywgMzgsIDM5LCA0MF0uaW5kZXhPZihlLmtleUNvZGUpID4gLTEpIG1vdmVPYmplY3QoZSk7XHJcbiAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gNDYpIGRlbGV0ZU9iamVjdCgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBkZWxldGVPYmplY3QoKSB7XHJcbiAgICAgICAgdmFyIGFjdGl2ZU9iamVjdCA9IGtleWJpbmRzLmZhYnJpYy5nZXRBY3RpdmVPYmplY3QoKTtcclxuXHJcbiAgICAgICAgaWYgKGFjdGl2ZU9iamVjdCkge1xyXG4gICAgICAgICAgICBrZXliaW5kcy5mYWJyaWMucmVtb3ZlKGFjdGl2ZU9iamVjdCk7XHJcbiAgICAgICAgICAgIGtleWJpbmRzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbW92ZU9iamVjdChlKSB7XHJcbiAgICAgICAgdmFyIG1vdmVtZW50RGVsdGEgPSAyO1xyXG5cclxuICAgICAgICB2YXIgYWN0aXZlT2JqZWN0ID0ga2V5YmluZHMuZmFicmljLmdldEFjdGl2ZU9iamVjdCgpO1xyXG4gICAgICAgIHZhciBhY3RpdmVHcm91cCA9IGtleWJpbmRzLmZhYnJpYy5nZXRBY3RpdmVHcm91cCgpO1xyXG5cclxuICAgICAgICBpZiAoZS5rZXlDb2RlID09PSAzNykge1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGlmIChhY3RpdmVPYmplY3QpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhID0gYWN0aXZlT2JqZWN0LmdldCgnbGVmdCcpIC0gbW92ZW1lbnREZWx0YTtcclxuICAgICAgICAgICAgICAgIGFjdGl2ZU9iamVjdC5zZXQoJ2xlZnQnLCBhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChhY3RpdmVHcm91cCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGEgPSBhY3RpdmVHcm91cC5nZXQoJ2xlZnQnKSAtIG1vdmVtZW50RGVsdGE7XHJcbiAgICAgICAgICAgICAgICBhY3RpdmVHcm91cC5zZXQoJ2xlZnQnLCBhKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PT0gMzkpIHtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBpZiAoYWN0aXZlT2JqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYSA9IGFjdGl2ZU9iamVjdC5nZXQoJ2xlZnQnKSArIG1vdmVtZW50RGVsdGE7XHJcbiAgICAgICAgICAgICAgICBhY3RpdmVPYmplY3Quc2V0KCdsZWZ0JywgYSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoYWN0aXZlR3JvdXApIHtcclxuICAgICAgICAgICAgICAgIHZhciBhID0gYWN0aXZlR3JvdXAuZ2V0KCdsZWZ0JykgKyBtb3ZlbWVudERlbHRhO1xyXG4gICAgICAgICAgICAgICAgYWN0aXZlR3JvdXAuc2V0KCdsZWZ0JywgYSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSBlbHNlIGlmIChlLmtleUNvZGUgPT09IDM4KSB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgaWYgKGFjdGl2ZU9iamVjdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGEgPSBhY3RpdmVPYmplY3QuZ2V0KCd0b3AnKSAtIG1vdmVtZW50RGVsdGE7XHJcbiAgICAgICAgICAgICAgICBhY3RpdmVPYmplY3Quc2V0KCd0b3AnLCBhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChhY3RpdmVHcm91cCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGEgPSBhY3RpdmVHcm91cC5nZXQoJ3RvcCcpIC0gbW92ZW1lbnREZWx0YTtcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUdyb3VwLnNldCgndG9wJywgYSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSBlbHNlIGlmIChlLmtleUNvZGUgPT09IDQwKSB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgaWYgKGFjdGl2ZU9iamVjdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGEgPSBhY3RpdmVPYmplY3QuZ2V0KCd0b3AnKSArIG1vdmVtZW50RGVsdGE7XHJcbiAgICAgICAgICAgICAgICBhY3RpdmVPYmplY3Quc2V0KCd0b3AnLCBhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChhY3RpdmVHcm91cCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGEgPSBhY3RpdmVHcm91cC5nZXQoJ3RvcCcpICsgbW92ZW1lbnREZWx0YTtcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUdyb3VwLnNldCgndG9wJywgYSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChhY3RpdmVPYmplY3QpIHtcclxuICAgICAgICAgICAgYWN0aXZlT2JqZWN0LnNldENvb3JkcygpO1xyXG4gICAgICAgICAgICBrZXliaW5kcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChhY3RpdmVHcm91cCkge1xyXG4gICAgICAgICAgICBhY3RpdmVHcm91cC5zZXRDb29yZHMoKTtcclxuICAgICAgICAgICAga2V5YmluZHMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ga2V5YmluZHM7XHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnSW1hZ2VFZGl0b3InKVxyXG5cclxuLnNlcnZpY2UoJ2NhbnZhcycsIFsnJHJvb3RTY29wZScsICckbWREaWFsb2cnLCAna2V5YmluZHMnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkbWREaWFsb2csIGtleWJpbmRzKSB7XHJcblxyXG5cdHZhciBjYW52YXMgPSB7XHJcblxyXG4gICAgICAgIG9yaWdpbmFsOiB7fSxcclxuXHJcbiAgICAgICAgLy9zdG9yZSB3aW5kb3cgd2lkdGggYW5kIGhlaWdodCBzbyB3ZSBkb24ndCBleGVjdXRlXHJcbiAgICAgICAgLy9mdW5jdGlvbnMgdW5uZWNlc3NhcmlseSBvbiByZXNpemUgZXZlbnQgaWYgdGhleSBkaWRuJ3QgY2hhbmdlXHJcbiAgICAgICAgb2xkV2luZG93RGltZW5zaW9uczoge1xyXG4gICAgICAgICAgICB3aWR0aDogd2luZG93LmlubmVyV2lkdGgsXHJcbiAgICAgICAgICAgIGhlaWdodDogd2luZG93LmlubmVySGVpZ2h0XHJcbiAgICAgICAgfSxcclxuXHJcblx0XHRtYWluSW1hZ2U6IGZhbHNlLFxyXG5cdFx0ZmFicmljOiBmYWxzZSxcclxuXHRcdGN0eDogZmFsc2UsXHJcblx0XHRjb250YWluZXI6IGZhbHNlLFxyXG5cdFx0dmlld3BvcnQ6IGZhbHNlLFxyXG5cdFx0b2Zmc2V0OiBmYWxzZSxcclxuXHRcdGVsZW1lbnQ6IGZhbHNlLFxyXG5cclxuICAgICAgICBtaW5XaWR0aDogNTAsXHJcbiAgICAgICAgbWluSGVpZ2h0OiA1MCxcclxuXHJcblx0XHRpbWFnZVN0YXRpYzoge1xyXG4gICAgICAgICAgICBsb2NrZWQ6IHRydWUsXHJcblx0XHRcdHNlbGVjdGFibGU6IGZhbHNlLFxyXG5cdCAgICAgIFx0ZXZlbnRlZDogZmFsc2UsXHJcblx0ICAgICAgXHRsb2NrTW92ZW1lbnRYOiB0cnVlLFxyXG5cdCAgICAgIFx0bG9ja01vdmVtZW50WTogdHJ1ZSxcclxuXHQgICAgICBcdGxvY2tSb3RhdGlvbjogdHJ1ZSxcclxuXHQgICAgICBcdGxvY2tTY2FsaW5nWDogdHJ1ZSxcclxuXHQgICAgICBcdGxvY2tTY2FsaW5nWTogdHJ1ZSxcclxuXHQgICAgICBcdGxvY2tVbmlTY2FsaW5nOiB0cnVlLFxyXG5cdCAgICAgIFx0aGFzQ29udHJvbHM6IGZhbHNlLFxyXG5cdCAgICAgIFx0aGFzQm9yZGVyczogZmFsc2VcclxuXHRcdH0sXHJcblxyXG4gICAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmZhYnJpYy5kaXNwb3NlKCk7XHJcbiAgICAgICAgICAgIHRoaXMubWFpbkltYWdlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuZmFicmljID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuY3R4ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMudmlld3BvcnQgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5vZmZzZXQgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMub3JpZ2luYWwgPSB7fTtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50Wm9vbSA9IDE7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuZWRpdG9yQ3VzdG9tQWN0aW9ucyA9IHt9O1xyXG4gICAgICAgICAgICAkKHdpbmRvdykub2ZmKCdyZXNpemUnKTtcclxuICAgICAgICAgICAga2V5YmluZHMuZGVzdHJveSgpO1xyXG4gICAgICAgIH0sXHJcblxyXG5cdFx0c3RhcnQ6IGZ1bmN0aW9uKHVybCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJyk7XHJcbiAgICAgICAgICAgIHRoaXMuZmFicmljID0gbmV3IGZhYnJpYy5DYW52YXMoJ2NhbnZhcycpO1xyXG4gICAgICAgICAgICB0aGlzLmN0eCA9IHRoaXMuZmFicmljLmdldENvbnRleHQoJzJkJyk7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyID0gJCgnLmNhbnZhcy1jb250YWluZXInKTtcclxuICAgICAgICAgICAgdGhpcy52aWV3cG9ydCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWV3cG9ydCcpO1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmVkaXRvckN1c3RvbUFjdGlvbnMgPSB7fTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZmFicmljLnNlbGVjdGlvbiA9IGZhbHNlOyBcclxuICAgICAgICAgICAgdGhpcy5mYWJyaWMucmVuZGVyT25BZGRSZW1vdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIGlmKCF0aGlzLmZhYnJpYy5iYWNrZ3JvdW5kQ29sb3IgfHwgdGhpcy5mYWJyaWMuYmFja2dyb3VuZENvbG9yPT0nJyl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZhYnJpYy5zZXRCYWNrZ3JvdW5kQ29sb3IoJyNmZmZmZmYnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmJnQ29sb3IgPSB0aGlzLmZhYnJpYy5iYWNrZ3JvdW5kQ29sb3I7XHJcbiAgICAgICAgICAgIGZhYnJpYy5PYmplY3QucHJvdG90eXBlLmJvcmRlckNvbG9yID0gJyMyMTk2RjMnO1xyXG4gICAgICAgICAgICBmYWJyaWMuT2JqZWN0LnByb3RvdHlwZS5jb3JuZXJDb2xvciA9ICcjMjE5NkYzJztcclxuICAgICAgICAgICAgZmFicmljLk9iamVjdC5wcm90b3R5cGUudHJhbnNwYXJlbnRDb3JuZXJzID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBpZiAoICEgdXJsKSB1cmwgPSAkcm9vdFNjb3BlLmdldFBhcmFtKCd1cmwnKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh1cmwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubG9hZE1haW5JbWFnZSh1cmwpO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zdGFydGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICgkcm9vdFNjb3BlLmdldFBhcmFtKCdibGFua0NhbnZhc1NpemUnKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNpemUgPSAkcm9vdFNjb3BlLmdldFBhcmFtKCdibGFua0NhbnZhc1NpemUnKTtcclxuICAgICAgICAgICAgICAgIHRoaXMub3Blbk5ldyhzaXplLndpZHRoLCBzaXplLmhlaWdodCwgJ25ld0NhbnZhcycpO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zdGFydGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCAhICRyb290U2NvcGUuc3RhcnRlZCAmJiAhICRyb290U2NvcGUuaXNJbnRlZ3JhdGlvbk1vZGUgJiYgISAkcm9vdFNjb3BlLmRlbGF5RWRpdG9yU3RhcnQpIHtcclxuICAgICAgICAgICAgICAgIC8qJG1kRGlhbG9nLnNob3coe1xyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAkKCcjbWFpbi1pbWFnZS11cGxvYWQtZGlhbG9nLXRlbXBsYXRlJykuaHRtbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdUb3BQYW5lbENvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9KTsqL1xyXG5cclxuICAgICAgICAgICAgICAgIC8vJHNjb3BlLmNyZWF0ZU5ld0NhbnZhcyg1MDAsIDUwMClcclxuICAgICAgICAgICAgICAgIC8vY2FudmFzLm9wZW5OZXcoNTAwLDUwMCxcIlVubmFtZWRcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FudmFzLm9wZW5OZXcoMTE1NywgMTIyOCk7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnN0YXJ0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAkKHdpbmRvdykub2ZmKCdyZXNpemUnKS5vbigncmVzaXplJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbnZhcy5vbGRXaW5kb3dEaW1lbnNpb25zLmhlaWdodCAhPT0gZS50YXJnZXQuaW5uZXJIZWlnaHQgfHxcclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMub2xkV2luZG93RGltZW5zaW9ucy53aWR0aCAhPT0gZS50YXJnZXQuaW5uZXJXaWR0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5maXRUb1NjcmVlbigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNhbnZhcy5vbGRXaW5kb3dEaW1lbnNpb25zLndpZHRoID0gZS50YXJnZXQuaW5uZXJXaWR0aDtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5vbGRXaW5kb3dEaW1lbnNpb25zLmhlaWdodCA9IGUudGFyZ2V0LmlubmVySGVpZ2h0O1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICRyb290U2NvcGUuJGVtaXQoJ2NhbnZhcy5pbml0Jyk7XHJcblxyXG4gICAgICAgICAgICBrZXliaW5kcy5pbml0KHRoaXMuZmFicmljKTtcclxuXHJcbiAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLmdldFBhcmFtKCdvbkxvYWQnKSkge1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5nZXRQYXJhbSgnb25Mb2FkJykodGhpcy52aWV3cG9ydCwgJHJvb3RTY29wZSwgd2luZG93KTsgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBoaWRlTW9kYWxzOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBtZXJnZU9iamVjdHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBjYW52YXMuem9vbSgxKTtcclxuICAgICAgICAgICAgdGhpcy5mYWJyaWMuZGVhY3RpdmF0ZUFsbCgpO1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHRoaXMuZmFicmljLnRvRGF0YVVSTCgpO1xyXG4gICAgICAgICAgICB0aGlzLmZhYnJpYy5jbGVhcigpO1xyXG4gICAgICAgICAgICB0aGlzLmxvYWRNYWluSW1hZ2UoZGF0YSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgbG9hZEZyb21KU09OOiBmdW5jdGlvbihkZXNpZ24sIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMubG9hZEZyb21KU09OKGRlc2lnbi5zZXJpYWxpemVkX2VkaXRvcl9zdGF0ZSB8fCBkZXNpZ24uc3RhdGUsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mb3JFYWNoT2JqZWN0KGZ1bmN0aW9uKG9iaikge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvL3JlYXBwbHkgYW55IGZpbHRlcnMgb2JqZWN0IHVzZWQgdG8gaGF2ZVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvYmouYXBwbHlGaWx0ZXJzICYmIG9iai5maWx0ZXJzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmouYXBwbHlGaWx0ZXJzKGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsLmJpbmQoY2FudmFzLmZhYnJpYykpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy9hc3NpZ24gbmV3IHJlZmVyZW5jZSB0byBtYWluSW1hZ2UgcHJvcGVydHlcclxuICAgICAgICAgICAgICAgICAgICBpZiAob2JqLm5hbWUgPT0gJ21haW5JbWFnZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLm1haW5JbWFnZSA9IG9iajtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZighY2FudmFzLmZhYnJpYy5iYWNrZ3JvdW5kQ29sb3IgfHwgY2FudmFzLmZhYnJpYy5iYWNrZ3JvdW5kQ29sb3I9PScnKXtcclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLnNldEJhY2tncm91bmRDb2xvcignI2ZmZmZmZicpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5iZ0NvbG9yID0gY2FudmFzLmZhYnJpYy5iYWNrZ3JvdW5kQ29sb3I7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGRlc2lnbi53aWR0aCAmJiBkZXNpZ24uaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRXaWR0aChkZXNpZ24ud2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuc2V0SGVpZ2h0KGRlc2lnbi5oZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQgPSBkZXNpZ24uaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5vcmlnaW5hbC53aWR0aCA9IGRlc2lnbi53aWR0aDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5jYWxjT2Zmc2V0KCk7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZml0VG9TY3JlZW4oKTtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGVtaXQoJ2hpc3RvcnkubG9hZGVkJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soZGVzaWduKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ3JlYXRlIGEgbmV3IGltYWdlIHdpdGggZ2l2ZW4gZGltZW5zaW9ucy5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7aW50fHN0cmluZ30gd2lkdGhcclxuICAgICAgICAgKiBAcGFyYW0ge2ludHxzdHJpbmd9IGhlaWdodFxyXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfHVuZGVmaW5lZH0gbmFtZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIG9wZW5OZXc6IGZ1bmN0aW9uKHdpZHRoLCBoZWlnaHQsIG5hbWUpIHtcclxuICAgICAgICAgICAgd2lkdGggPSB3aWR0aCA8IHRoaXMubWluV2lkdGggPyB0aGlzLm1pbldpZHRoIDogd2lkdGg7XHJcbiAgICAgICAgICAgIGhlaWdodCA9IGhlaWdodCA8IHRoaXMubWluSGVpZ2h0ID8gdGhpcy5taW5IZWlnaHQgOiBoZWlnaHQ7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmZhYnJpYy5jbGVhcigpO1xyXG4gICAgICAgICAgICB0aGlzLmZhYnJpYy5zZXRCYWNrZ3JvdW5kQ29sb3IoJyNmZmZmZmYnKTtcclxuICAgICAgICAgICAgdGhpcy5mYWJyaWMuc2V0V2lkdGgod2lkdGgpO1xyXG4gICAgICAgICAgICB0aGlzLmZhYnJpYy5zZXRIZWlnaHQoaGVpZ2h0KTtcclxuICAgICAgICAgICAgdGhpcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgICAgIGNhbnZhcy5maXRUb1NjcmVlbigpO1xyXG5cclxuICAgICAgICAgICAgLy9zYXZlIHRoZSBkaW1lbnNpb25zIHNvIHdlIGNhbiBzY2FsZSBpbWFnZXMgb3BlbmVkIGxhdGVyIHRvIHRoZW1cclxuICAgICAgICAgICAgJHJvb3RTY29wZS51c2VyUHJlc2V0ID0ge1xyXG4gICAgICAgICAgICAgICAgd2lkdGg6IHdpZHRoLFxyXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBoZWlnaHQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBjYW52YXMub3JpZ2luYWwuaGVpZ2h0ID0gaGVpZ2h0O1xyXG4gICAgICAgICAgICBjYW52YXMub3JpZ2luYWwud2lkdGggPSB3aWR0aDtcclxuXHJcbiAgICAgICAgICAgICRyb290U2NvcGUuJGVtaXQoJ2NhbnZhcy5vcGVuZWROZXcnKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBjZW50ZXI6IGZ1bmN0aW9uKG9iaikge1xyXG4gICAgICAgICAgICBvYmouY2VudGVyKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoY2FudmFzLnpvb20gPiAxMDApIHtcclxuICAgICAgICAgICAgICAgIG9iai5zZXRMZWZ0KDEwKTtcclxuICAgICAgICAgICAgICAgIG9iai5zZXRUb3AoMzUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBvYmouc2V0Q29vcmRzKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgc2VyaWFsaXplOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmFicmljLnRvSlNPTihbJ3NlbGVjdGFibGUnLCAnbmFtZSddKTtcclxuICAgICAgICB9LFxyXG5cclxuXHRcdGxvYWRNYWluSW1hZ2U6IGZ1bmN0aW9uKHVybCwgaGVpZ2h0LCB3aWR0aCwgZG9udEZpdCwgY2FsbGJhY2spIHtcclxuXHRcdFx0dmFyIG9iamVjdDtcclxuXHJcblx0XHRcdGZhYnJpYy51dGlsLmxvYWRJbWFnZSh1cmwsIGZ1bmN0aW9uIChpbWcpIHtcclxuICAgICAgICAgICAgICAgIC8vaW1nLmNyb3NzT3JpZ2luID0gJ2Fub255bW91cyc7XHJcblxyXG5cdFx0XHQgICAgb2JqZWN0ID0gbmV3IGZhYnJpYy5JbWFnZShpbWcsIGNhbnZhcy5pbWFnZVN0YXRpYyk7XHJcblx0XHRcdCAgICBvYmplY3QubmFtZSA9ICdtYWluSW1hZ2UnO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh3aWR0aCAmJiBoZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBvYmplY3Qud2lkdGggPSB3aWR0aDtcclxuICAgICAgICAgICAgICAgICAgICBvYmplY3QuaGVpZ2h0ID0gaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuXHRcdFx0ICAgIGNhbnZhcy5tYWluSW1hZ2UgPSBvYmplY3Q7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mb3JFYWNoT2JqZWN0KGZ1bmN0aW9uKG9iaikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvYmoubmFtZSA9PSAnbWFpbkltYWdlJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbW92ZShvYmopO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cdFx0XHQgICAgY2FudmFzLmZhYnJpYy5hZGQob2JqZWN0KTtcclxuXHRcdFx0ICAgXHRvYmplY3QudG9wID0gLTAuNTtcclxuXHRcdFx0ICAgXHRvYmplY3QubGVmdCA9IC0wLjU7XHJcblx0XHRcdCAgICBvYmplY3QubW92ZVRvKDApO1xyXG5cclxuXHRcdFx0ICAgIGNhbnZhcy5mYWJyaWMuc2V0SGVpZ2h0KG9iamVjdC5oZWlnaHQpO1xyXG5cdFx0XHQgICAgY2FudmFzLmZhYnJpYy5zZXRXaWR0aChvYmplY3Qud2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBpZighY2FudmFzLmZhYnJpYy5iYWNrZ3JvdW5kQ29sb3IgfHwgY2FudmFzLmZhYnJpYy5iYWNrZ3JvdW5kQ29sb3I9PScnKXtcclxuICAgICAgICAgICAgICAgICAgICAvL2NhbnZhcy5mYWJyaWMuc2V0QmFja2dyb3VuZENvbG9yKCcjZmZmZmZmJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmJnQ29sb3IgPSBjYW52YXMuZmFicmljLmJhY2tncm91bmRDb2xvcjtcclxuXHJcbiAgICAgICAgICAgICAgICBjYW52YXMub3JpZ2luYWwuaGVpZ2h0ID0gb2JqZWN0LmhlaWdodDtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5vcmlnaW5hbC53aWR0aCA9IG9iamVjdC53aWR0aDtcclxuXHJcblx0XHRcdFx0aWYgKCAhIGRvbnRGaXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMuZml0VG9TY3JlZW4oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcblx0XHRcdFx0JHJvb3RTY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQkcm9vdFNjb3BlLiRlbWl0KCdlZGl0b3IubWFpbkltYWdlLmxvYWRlZCcpO1xyXG5cdFx0XHRcdH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblx0XHRcdH0pO1xyXG5cdFx0fSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogT3BlbiBpbWFnZSBhdCBnaXZlbiB1cmwgaW4gY2FudmFzLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IHVybFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIG9wZW5JbWFnZTogZnVuY3Rpb24odXJsKSB7XHJcbiAgICAgICAgICAgIGNhbnZhcy56b29tKDEpO1xyXG4gICAgICAgICAgICBmYWJyaWMudXRpbC5sb2FkSW1hZ2UodXJsLCBmdW5jdGlvbihpbWFnZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCAhIGltYWdlKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIG9iamVjdCA9IG5ldyBmYWJyaWMuSW1hZ2UoaW1hZ2UpO1xyXG4gICAgICAgICAgICAgICAgb2JqZWN0Lm5hbWUgPSAnaW1hZ2UnO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vdXNlIGVpdGhlciBtYWluIGltYWdlIG9yIGNhbnZhcyBkaW1lbnNpb25zIGFzIG91dHRlciBib3VuZGFyaWVzIGZvciBzY2FsaW5nIG5ldyBpbWFnZVxyXG4gICAgICAgICAgICAgICAgdmFyIG1heFdpZHRoICA9IGNhbnZhcy5tYWluSW1hZ2UgPyBjYW52YXMubWFpbkltYWdlLmdldFdpZHRoKCkgOiBjYW52YXMuZmFicmljLmdldFdpZHRoKCksXHJcbiAgICAgICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gY2FudmFzLm1haW5JbWFnZSA/IGNhbnZhcy5tYWluSW1hZ2UuZ2V0SGVpZ2h0KCkgOiBjYW52YXMuZmFicmljLmdldEhlaWdodCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vaWYgaW1hZ2UgaXMgd2lkZXIgb3IgaGVpZ2hlciB0aGVuIHRoZSBjdXJyZW50IGNhbnZhcywgd2UnbGwgc2NhbGUgaWQgZG93blxyXG4gICAgICAgICAgICAgICAgaWYgKG9iamVjdC53aWR0aCA+PSBtYXhXaWR0aCB8fCBvYmplY3QuaGVpZ2h0ID49IG1heEhlaWdodCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvL2NhbGMgbmV3IGltYWdlIGRpbWVuc2lvbnMgKG1haW4gaW1hZ2UgaGVpZ2h0IC0gMTAlIGFuZCB3aWR0aCAtIDEwJSlcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3V2lkdGggID0gbWF4V2lkdGggLSAoMC4xICogbWF4V2lkdGgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdIZWlnaHQgPSBtYXhIZWlnaHQgLSAoMC4xICogbWF4SGVpZ2h0KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGUgICAgID0gMSAvIChNYXRoLm1pbihuZXdIZWlnaHQgLyBvYmplY3QuZ2V0SGVpZ2h0KCksIG5ld1dpZHRoIC8gb2JqZWN0LmdldFdpZHRoKCkpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy9zY2FsZSBuZXdseSB1cGxvYWRlZCBpbWFnZSB0byB0aGUgYWJvdmUgZGltZXNuc2lvbnNcclxuICAgICAgICAgICAgICAgICAgICBvYmplY3Quc2NhbGVYID0gb2JqZWN0LnNjYWxlWCAqICgxIC8gc2NhbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIG9iamVjdC5zY2FsZVkgPSBvYmplY3Quc2NhbGVZICogKDEgLyBzY2FsZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy9jZW50ZXIgYW5kIHJlbmRlciBuZXdseSB1cGxvYWRlZCBpbWFnZSBvbiB0aGUgY2FudmFzXHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmFkZChvYmplY3QpO1xyXG4gICAgICAgICAgICAgICAgb2JqZWN0LmxlZnQgPSAoY2FudmFzLmZhYnJpYy5nZXRXaWR0aCgpIC0gb2JqZWN0LmdldFdpZHRoKCkpIC8gMjtcclxuICAgICAgICAgICAgICAgIG9iamVjdC50b3AgPSAoY2FudmFzLmZhYnJpYy5nZXRIZWlnaHQoKSAtIG9iamVjdC5nZXRIZWlnaHQoKSkgLyAyO1xyXG4gICAgICAgICAgICAgICAgb2JqZWN0LnNldENvb3JkcygpO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3Qob2JqZWN0KTtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZpdFRvU2NyZWVuKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGdldERhdGFVUkw6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcclxuICAgICAgICAgICAgaWYgKCAhIG9wdGlvbnMpIG9wdGlvbnMgPSB7fTtcclxuXHJcbiAgICAgICAgICAgIC8vaWdub3JlIHpvb20gd2hlbiBnZXR0aW5nIGRhdGEgdXJsXHJcbiAgICAgICAgICAgIG9wdGlvbnMubXVsdGlwbGllciA9IDEgLyBjYW52YXMuY3VycmVudFpvb207XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mYWJyaWMudG9EYXRhVVJMKG9wdGlvbnMpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGN1cnJlbnRab29tOiAxLFxyXG5cclxuICAgICAgICB6b29tOiBmdW5jdGlvbihzY2FsZUZhY3Rvcikge1xyXG4gICAgICAgICAgICB0aGlzLmZhYnJpYy5zZXRab29tKHNjYWxlRmFjdG9yKTtcclxuICAgICAgICAgICAgdGhpcy5mYWJyaWMuc2V0SGVpZ2h0KHRoaXMub3JpZ2luYWwuaGVpZ2h0ICogc2NhbGVGYWN0b3IpO1xyXG4gICAgICAgICAgICB0aGlzLmZhYnJpYy5zZXRXaWR0aCh0aGlzLm9yaWdpbmFsLndpZHRoICogc2NhbGVGYWN0b3IpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50Wm9vbSA9IHNjYWxlRmFjdG9yO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGZpdFRvU2NyZWVuOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZml0VG9TY3JlZW5cIik7XHJcbiAgICAgICAgICAgIHZhciBtYXhXaWR0aCAgPSBjYW52YXMudmlld3BvcnQub2Zmc2V0V2lkdGggLSA0MCxcclxuICAgICAgICAgICAgICAgIG1heEhlaWdodCA9IGNhbnZhcy52aWV3cG9ydC5vZmZzZXRIZWlnaHQgLSAxMjAsXHJcbiAgICAgICAgICAgICAgICBvdXR0ZXIgICAgPSBjYW52YXMubWFpbkltYWdlIHx8IGNhbnZhcy5mYWJyaWMsXHJcbiAgICAgICAgICAgIFx0c2NhbGUgICAgID0gTWF0aC5taW4obWF4SGVpZ2h0IC8gb3V0dGVyLmdldEhlaWdodCgpLCBtYXhXaWR0aCAvIG91dHRlci5nZXRXaWR0aCgpKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChvdXR0ZXIuZ2V0SGVpZ2h0KCkgPiBtYXhIZWlnaHQgfHwgb3V0dGVyLmdldFdpZHRoKCkgPiBtYXhXaWR0aCkge1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLnpvb20oc2NhbGUpOyBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHR9O1xyXG5cclxuXHRyZXR1cm4gY2FudmFzO1xyXG5cclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5jcm9wJywgW10pXHJcblxyXG4uc2VydmljZSgnY3JvcHBlcicsIFsnJHJvb3RTY29wZScsICdjcm9wem9uZScsICdjYW52YXMnLCAnaGlzdG9yeScsIGZ1bmN0aW9uKCRyb290U2NvcGUsIGNyb3B6b25lLCBjYW52YXMsIGhpc3RvcnkpIHtcclxuXHRcclxuXHR2YXIgY3JvcHBlciA9IHtcclxuXHJcblx0XHRzdGFydDogZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRpZiAoY3JvcHpvbmUuaW5pdGlhdGVkKSByZXR1cm47XHJcblx0XHRcdFxyXG5cdFx0XHRjcm9wem9uZS5hZGQoKTtcclxuXHRcdFx0JHJvb3RTY29wZS5vcGVuUGFuZWwoJ2Nyb3AnLCBlKTtcclxuXHRcdH0sXHJcblxyXG5cdFx0c3RvcDogZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRjcm9wem9uZS5yZW1vdmUoKTtcclxuXHRcdFx0JHJvb3RTY29wZS5hY3RpdmVQYW5lbCA9IGZhbHNlO1xyXG5cdFx0fSxcclxuXHJcblx0XHRjcm9wOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0aWYgKCAhIGNyb3B6b25lLmluaXRpYXRlZCkgcmV0dXJuIGZhbHNlO1xyXG5cclxuXHRcdFx0Y3JvcHpvbmUuaGlkZSgpO1xyXG5cdFx0ICAgIHZhciBpbWFnZSA9IG5ldyBJbWFnZSgpO1xyXG5cclxuXHRcdCAgICBpbWFnZS5vbmxvYWQgPSBmdW5jdGlvbigpIHtcclxuXHRcdCAgICAgICAgdmFyIGZhYnJpY0ltYWdlID0gbmV3IGZhYnJpYy5JbWFnZSh0aGlzLCBjYW52YXMuaW1hZ2VTdGF0aWMpO1xyXG4gICAgICAgICAgICAgICAgZmFicmljSW1hZ2UubmFtZSA9ICdtYWluSW1hZ2UnO1xyXG5cclxuXHRcdCAgICAgICAgY2FudmFzLm1haW5JbWFnZSAmJiBjYW52YXMubWFpbkltYWdlLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5jbGVhcigpO1xyXG5cdFx0ICAgICAgICBjYW52YXMuZmFicmljLnNldFdpZHRoKE1hdGguY2VpbChjcm9wem9uZS5yZWN0LmdldFdpZHRoKCkpKTtcclxuXHRcdCAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRIZWlnaHQoTWF0aC5jZWlsKGNyb3B6b25lLnJlY3QuZ2V0SGVpZ2h0KCkpKTtcclxuXHJcbiAgICAgICAgXHRcdGNhbnZhcy5mYWJyaWMuYWRkKGZhYnJpY0ltYWdlKTtcclxuICAgICAgICAgICAgICAgIGZhYnJpY0ltYWdlLm1vdmVUbygwKTtcclxuICAgICAgICAgICAgICAgIGZhYnJpY0ltYWdlLmNlbnRlcigpO1xyXG4gICAgICAgIFx0XHRjYW52YXMubWFpbkltYWdlID0gZmFicmljSW1hZ2U7XHJcbiAgICAgICAgXHRcdGNyb3B6b25lLnJlbW92ZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGhpc3RvcnkuYWRkKCdjcm9wJywgJ2Nyb3AnKTtcclxuXHJcblx0XHRcdFx0JHJvb3RTY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XHJcblx0XHRcdFx0fSk7XHJcblx0XHQgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGNhbnZhcy56b29tKDEpO1xyXG5cclxuICAgICAgICAgICAgJHJvb3RTY29wZS5lZGl0b3JDdXN0b21BY3Rpb25zLmNyb3AgPSB7XHJcbiAgICAgICAgICAgICAgICBsZWZ0OiBjcm9wem9uZS5yZWN0LmdldExlZnQoKSxcclxuICAgICAgICAgICAgICAgIHRvcDogY3JvcHpvbmUucmVjdC5nZXRUb3AoKSxcclxuICAgICAgICAgICAgICAgIHdpZHRoOiBNYXRoLmNlaWwoY3JvcHpvbmUucmVjdC5nZXRXaWR0aCgpKSxcclxuICAgICAgICAgICAgICAgIGhlaWdodDogTWF0aC5jZWlsKGNyb3B6b25lLnJlY3QuZ2V0SGVpZ2h0KCkpXHJcbiAgICAgICAgICAgIH07XHJcblxyXG5cdFx0ICAgIGltYWdlLnNyYyA9IGNhbnZhcy5mYWJyaWMudG9EYXRhVVJMKHtcclxuXHRcdCAgICAgICAgbGVmdDogY3JvcHpvbmUucmVjdC5nZXRMZWZ0KCksXHJcblx0XHQgICAgICAgIHRvcDogY3JvcHpvbmUucmVjdC5nZXRUb3AoKSxcclxuXHRcdCAgICAgICAgd2lkdGg6IE1hdGguY2VpbChjcm9wem9uZS5yZWN0LmdldFdpZHRoKCkpLFxyXG5cdFx0ICAgICAgICBoZWlnaHQ6IE1hdGguY2VpbChjcm9wem9uZS5yZWN0LmdldEhlaWdodCgpKVxyXG5cdFx0ICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY2FudmFzLm9yaWdpbmFsLndpZHRoID0gTWF0aC5jZWlsKGNyb3B6b25lLnJlY3QuZ2V0V2lkdGgoKSk7XHJcbiAgICAgICAgICAgIGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQgPSBNYXRoLmNlaWwoY3JvcHpvbmUucmVjdC5nZXRIZWlnaHQoKSk7XHJcblx0XHR9XHJcblxyXG5cdH07XHJcblxyXG5cdHJldHVybiBjcm9wcGVyO1xyXG5cclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5jcm9wJylcclxuXHJcbi5zZXJ2aWNlKCdjcm9wem9uZScsIFsnJHJvb3RTY29wZScsICdjYW52YXMnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCBjYW52YXMpIHtcclxuXHJcblx0dmFyIGNyb3B6b25lID0ge1xyXG5cclxuXHRcdHJlY3Q6IHt9LFxyXG5cclxuXHRcdGRyYWdnaW5nOiBmYWxzZSxcclxuXHJcblx0XHRpbml0aWF0ZWQ6IGZhbHNlLFxyXG5cclxuXHRcdG1pbkhlaWdodDogMjUsXHJcblxyXG5cdFx0bWluV2lkdGg6IDI1LFxyXG5cclxuXHRcdHNldFdpZHRoOiBmdW5jdGlvbih3aWR0aCkge1xyXG4gICAgICAgICAgICBpZiAoICEgd2lkdGgpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIHdpZHRoID0gcGFyc2VJbnQod2lkdGgpO1xyXG5cclxuXHRcdFx0aWYgKHdpZHRoIDwgdGhpcy5taW5XaWR0aCkge1xyXG5cdFx0XHRcdHdpZHRoID0gdGhpcy5taW5XaWR0aDtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKHdpZHRoID4gY2FudmFzLm9yaWdpbmFsLndpZHRoKSB7XHJcblx0XHRcdFx0d2lkdGggPSBjYW52YXMub3JpZ2luYWwud2lkdGggLSAyNTtcclxuXHRcdFx0fVxyXG5cclxuICAgICAgICAgICAgdGhpcy5yZWN0LndpZHRoID0gd2lkdGg7XHJcblx0XHRcdHRoaXMucmVjdC5zZXRUb3AoKGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQgLSB0aGlzLnJlY3QuZ2V0SGVpZ2h0KCkpIC8gMik7XHJcblx0XHRcdHRoaXMucmVjdC5zZXRMZWZ0KChjYW52YXMub3JpZ2luYWwud2lkdGggLSB0aGlzLnJlY3QuZ2V0V2lkdGgoKSkgLyAyKTtcclxuXHRcdFx0dGhpcy5yZWN0LnNldENvb3JkcygpO1xyXG5cdFx0XHR0aGlzLmRyYXdHcmlkKCk7XHJcblx0XHRcdHRoaXMuZHJhd092ZXJsYXkoKTtcclxuXHRcdFx0Y2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuXHRcdH0sXHJcblxyXG5cdFx0c2V0SGVpZ2h0OiBmdW5jdGlvbihoZWlnaHQpIHtcclxuICAgICAgICAgICAgaWYgKCAhIGhlaWdodCkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgaGVpZ2h0ID0gcGFyc2VJbnQoaGVpZ2h0KTtcclxuXHJcblx0XHRcdGlmIChoZWlnaHQgPCB0aGlzLm1pbkhlaWdodCkge1xyXG5cdFx0XHRcdGhlaWdodCA9IHRoaXMubWluSGVpZ2h0O1xyXG5cdFx0XHR9XHJcblxyXG4gICAgICAgICAgICBpZiAoaGVpZ2h0ID4gY2FudmFzLm9yaWdpbmFsLmhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gY2FudmFzLm9yaWdpbmFsLmhlaWdodCAtIDI1O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLnJlY3QuaGVpZ2h0ID0gaGVpZ2h0O1xyXG5cdFx0XHR0aGlzLnJlY3Quc2V0VG9wKChjYW52YXMub3JpZ2luYWwuaGVpZ2h0IC0gdGhpcy5yZWN0LmdldEhlaWdodCgpKSAvIDIpO1xyXG5cdFx0XHR0aGlzLnJlY3Quc2V0TGVmdCgoY2FudmFzLm9yaWdpbmFsLndpZHRoIC0gdGhpcy5yZWN0LmdldFdpZHRoKCkpIC8gMik7XHJcblx0XHRcdHRoaXMucmVjdC5zZXRDb29yZHMoKTtcclxuXHRcdFx0dGhpcy5kcmF3R3JpZCgpO1xyXG5cdFx0XHR0aGlzLmRyYXdPdmVybGF5KCk7XHJcblx0XHRcdGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcblx0XHR9LFxyXG5cclxuXHRcdGFkZDogZnVuY3Rpb24oKSB7XHJcblx0XHRcdHRoaXMuZHJhd01haW5ab25lKCk7XHJcblx0XHRcdHRoaXMuZHJhd092ZXJsYXkoKTtcclxuXHRcdFx0dGhpcy5kcmF3R3JpZCgpO1xyXG5cdFx0XHR0aGlzLmF0dGFjaEV2ZW50cygpO1xyXG5cclxuXHRcdFx0Y2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuXHJcblx0XHRcdHRoaXMuaW5pdGlhdGVkID0gdHJ1ZTtcclxuXHJcblx0XHRcdCRyb290U2NvcGUuJGVtaXQoJ2Nyb3B6b25lLmFkZGVkJyk7XHJcblx0XHR9LFxyXG5cclxuXHRcdGNvbnN0cmFpbldpdGhpbkNhbnZhczogZnVuY3Rpb24ob2JqZWN0KSB7XHJcblx0XHQgICAgdmFyIHggPSBvYmplY3QuZ2V0TGVmdCgpLCB5ID0gb2JqZWN0LmdldFRvcCgpO1xyXG5cdFx0ICAgIHZhciB3ID0gb2JqZWN0LmdldFdpZHRoKCksIGggPSBvYmplY3QuZ2V0SGVpZ2h0KCk7XHJcblx0XHQgICAgdmFyIG1heFggPSBjYW52YXMub3JpZ2luYWwud2lkdGggLSB3O1xyXG5cdFx0ICAgIHZhciBtYXhZID0gY2FudmFzLm9yaWdpbmFsLmhlaWdodCAtIGg7XHJcblxyXG5cdFx0ICAgIGlmICh4IDwgMCkge1xyXG5cdFx0ICAgIFx0b2JqZWN0LnNldCgnbGVmdCcsIDApO1xyXG5cdFx0ICAgIH1cclxuXHRcdCAgICBpZiAoeSA8IDApIHtcclxuXHRcdCAgICAgICAgb2JqZWN0LnNldCgndG9wJywgMCk7XHJcblx0XHRcdH1cclxuXHRcdCAgICBpZiAoeCA+IG1heFgpIHtcclxuXHRcdCAgICAgICAgb2JqZWN0LnNldCgnbGVmdCcsIG1heFgpO1xyXG5cdFx0ICAgIH1cclxuXHRcdCAgICBpZiAoeSA+IG1heFkpIHtcclxuXHRcdCAgICBcdG9iamVjdC5zZXQoJ3RvcCcsIG1heFkpO1xyXG5cdFx0ICAgIH1cclxuXHRcdH0sXHJcblxyXG5cdFx0Y29uc3RyYWluV2l0aGluQ2FudmFzT25TY2FsaW5nOiBmdW5jdGlvbihvYmplY3QpIHtcclxuXHJcblx0XHQgICAgdmFyIG1pblggPSBvYmplY3QuZ2V0TGVmdCgpO1xyXG5cdFx0ICAgIHZhciBtaW5ZID0gb2JqZWN0LmdldFRvcCgpO1xyXG5cdFx0ICAgIHZhciBtYXhYID0gb2JqZWN0LmdldExlZnQoKSArIG9iamVjdC5nZXRXaWR0aCgpO1xyXG5cdFx0ICAgIHZhciBtYXhZID0gb2JqZWN0LmdldFRvcCgpICsgb2JqZWN0LmdldEhlaWdodCgpO1xyXG5cclxuXHRcdCAgICBpZiAobWluWCA8IDAgfHwgbWF4WCA+IGNhbnZhcy5vcmlnaW5hbC53aWR0aCkge1xyXG5cdFx0ICAgICAgICB2YXIgbGFzdFNjYWxlWCA9IHRoaXMubGFzdFNjYWxlWMKgfHwgMTtcclxuXHRcdCAgICAgICAgb2JqZWN0LnNldFNjYWxlWChsYXN0U2NhbGVYKTtcclxuXHRcdCAgICB9XHJcblxyXG5cdFx0ICAgIGlmIChtaW5YIDwgMCkge1xyXG5cdFx0ICAgICAgICBvYmplY3Quc2V0TGVmdCgwKTtcclxuXHRcdCAgICB9XHJcblxyXG5cdFx0ICAgIGlmIChtaW5ZIDwgMCB8fCBtYXhZID4gY2FudmFzLm9yaWdpbmFsLmhlaWdodCkge1xyXG5cdFx0ICAgICAgICB2YXIgbGFzdFNjYWxlWSA9IHRoaXMubGFzdFNjYWxlWcKgfHwgMTtcclxuXHRcdCAgICAgICAgb2JqZWN0LnNldFNjYWxlWShsYXN0U2NhbGVZKTtcclxuXHRcdCAgICB9XHJcblxyXG5cdFx0ICAgIGlmIChtaW5ZIDwgMCkge1xyXG5cdFx0ICAgICAgICBvYmplY3Quc2V0VG9wKDApO1xyXG5cdFx0ICAgIH1cclxuXHJcblx0XHQgICAgaWYgKG9iamVjdC5nZXRXaWR0aCgpIDwgdGhpcy5taW5XaWR0aCkge1xyXG5cdFx0ICAgICAgICBvYmplY3Qud2lkdGggPSB0aGlzLm1pbldpZHRoO1xyXG5cdFx0ICAgICAgICBvYmplY3Quc2V0U2NhbGVYKDEpO1xyXG5cdFx0ICAgIH1cclxuXHJcblx0XHQgICAgaWYgKG9iamVjdC5nZXRIZWlnaHQoKSA8IHRoaXMubWluSGVpZ2h0KSB7XHJcblx0XHQgICAgICAgb2JqZWN0LmhlaWdodCA9IHRoaXMubWluSGVpZ2h0O1xyXG5cdFx0ICAgICAgIG9iamVjdC5zZXRTY2FsZVkoMSk7XHJcblx0XHQgICAgfVxyXG5cclxuXHRcdCAgICB0aGlzLmxhc3RTY2FsZVggPSBvYmplY3QuZ2V0U2NhbGVYKCk7XHJcblx0XHQgICAgdGhpcy5sYXN0U2NhbGVZID0gb2JqZWN0LmdldFNjYWxlWSgpO1xyXG5cdFx0fSxcclxuXHJcblx0XHRvbk1vdXNlRG93bjogZnVuY3Rpb24oZXZlbnQpIHtcclxuXHRcdFx0aWYgKGV2ZW50LnRhcmdldCAmJiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT09ICdjcm9wem9uZScgfHwgZXZlbnQudGFyZ2V0Lm5hbWUgPT09ICdjcm9wLmdyaWQnKSkgcmV0dXJuO1xyXG5cclxuXHRcdFx0Y3JvcHpvbmUuZHJhZ2dpbmcgPSB0cnVlO1xyXG5cclxuXHRcdFx0Ly9oaWRlIGNyb3B6b25lIG9uIHNpbmdsZSBjbGljayBvbiBvdmVybGF5XHJcblx0XHRcdGNyb3B6b25lLm92ZXJsYXkudmlzaWJsZSA9IGZhbHNlO1xyXG5cdFx0XHRjcm9wem9uZS5ncmlkLnZpc2libGUgPSBmYWxzZTtcclxuXHRcdFx0Y3JvcHpvbmUucmVjdC52aXNpYmxlID0gZmFsc2U7XHJcblxyXG5cdFx0XHQvL3N0YXJ0IHBvc2l0aW9uIGZvciBkcmF3aW5nIGEgY3JvcHpvbmVcclxuXHRcdCAgICBjcm9wem9uZS5yZWN0LmxlZnQgPSBldmVudC5lLnBhZ2VYIC0gY2FudmFzLmZhYnJpYy5fb2Zmc2V0LmxlZnQ7XHJcblx0XHQgICAgY3JvcHpvbmUucmVjdC50b3AgPSBldmVudC5lLnBhZ2VZIC0gY2FudmFzLmZhYnJpYy5fb2Zmc2V0LnRvcDtcclxuXHJcblx0XHQgICAgLy9tYWtlIHN1cmUgY3JvcHpvbmUgc2NhbGUgaXMgMSBmb3IgYWNjdXJhdGUgY29vcmRpbmF0ZXNcclxuXHRcdCAgICBjcm9wem9uZS5yZWN0LnNjYWxlKDEpO1xyXG4gICAgICAgICAgICBjcm9wem9uZS5vdmVybGF5LnNjYWxlKDEpO1xyXG4gICAgICAgICAgICBjcm9wem9uZS5ncmlkLnNjYWxlKDEpO1xyXG5cdFx0ICAgIGNyb3B6b25lLm1vdXNleCA9IGV2ZW50LmUucGFnZVg7XHJcblx0XHQgICAgY3JvcHpvbmUubW91c2V5ID0gZXZlbnQuZS5wYWdlWTtcclxuXHJcblx0XHQgICAgLy9wcmV2ZW50IHNlbGVjdGlvbiBvZiBvYmplY3RzIHdoaWxlIGRyYWdnaW5nXHJcblx0XHQgICAgY2FudmFzLmZhYnJpYy5zZWxlY3Rpb24gPSBmYWxzZTtcclxuXHJcblx0XHQgICAgY3JvcHpvbmUuZHJhd092ZXJsYXkoKTtcclxuXHRcdH0sXHJcblxyXG5cdFx0b25Nb3VzZU1vdmU6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcblx0XHRcdGlmICggISBjcm9wem9uZS5kcmFnZ2luZykgcmV0dXJuO1xyXG5cclxuXHRcdFx0dmFyIHdpZHRoICA9IGV2ZW50LmUucGFnZVggLSBjcm9wem9uZS5tb3VzZXgsXHJcblx0XHRcdFx0aGVpZ2h0ID0gZXZlbnQuZS5wYWdlWSAtIGNyb3B6b25lLm1vdXNleTtcclxuXHJcblx0XHRcdC8vcHJldmVudCBjcm9wem9uZSBnb2luZyBvdmVyIHRoZSByaWdodCBlZGdlXHJcblx0XHRcdGlmIChjYW52YXMub2Zmc2V0LmxlZnQgKyBjYW52YXMub3JpZ2luYWwud2lkdGggPCBldmVudC5lLnBhZ2VYKSB7XHJcblx0XHRcdFx0d2lkdGggPSAoY2FudmFzLm9mZnNldC5sZWZ0ICsgY2FudmFzLm9yaWdpbmFsLndpZHRoKSAtIGNyb3B6b25lLm1vdXNleDtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly9sZWZ0IGVkZ2VcclxuXHRcdFx0aWYgKGNhbnZhcy5vZmZzZXQubGVmdCA+IGV2ZW50LmUucGFnZVgpIHtcclxuXHRcdFx0XHR3aWR0aCA9IGNhbnZhcy5vZmZzZXQubGVmdCAtIGNyb3B6b25lLm1vdXNleDtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly9ib3R0b20gZWRnZVxyXG5cdFx0XHRpZiAoY2FudmFzLm9mZnNldC50b3AgKyBjYW52YXMub3JpZ2luYWwuaGVpZ2h0IDwgZXZlbnQuZS5wYWdlWSkge1xyXG5cdFx0XHRcdGhlaWdodCA9IChjYW52YXMub2Zmc2V0LnRvcCArIGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQpIC0gY3JvcHpvbmUubW91c2V5O1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvL3RvcCBlZGdlXHJcblx0XHRcdGlmIChjYW52YXMub2Zmc2V0LnRvcCA+IGV2ZW50LmUucGFnZVkpIHtcclxuXHRcdFx0XHRoZWlnaHQgPSBjYW52YXMub2Zmc2V0LnRvcCAtIGNyb3B6b25lLm1vdXNleTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Y3JvcHpvbmUucmVjdC53aWR0aCA9IHdpZHRoO1xyXG4gICAgICAgIFx0Y3JvcHpvbmUucmVjdC5oZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICAgICAgXHRjcm9wem9uZS5yZWN0Lm1vdmVUbygzKTtcclxuICAgICAgICAgICAgY3JvcHpvbmUucmVjdC5zZXRDb29yZHMoKTtcclxuICAgICAgICBcdGNyb3B6b25lLmRyYXdPdmVybGF5KCk7XHJcblx0ICAgICAgICBjcm9wem9uZS5kcmF3R3JpZCgpO1xyXG5cclxuXHRcdFx0aWYgKCAhIGNyb3B6b25lLnJlY3QudmlzaWJsZSkge1xyXG5cdFx0XHRcdGNyb3B6b25lLnJlY3QudmlzaWJsZSA9IHRydWU7XHJcblx0XHRcdFx0Y3JvcHpvbmUub3ZlcmxheS52aXNpYmxlID0gdHJ1ZTtcclxuXHRcdFx0XHRjcm9wem9uZS5ncmlkLnZpc2libGUgPSB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cclxuXHRcdG9uTW91c2VVcDogZnVuY3Rpb24oKSB7XHJcblx0XHQgICBcdGNyb3B6b25lLmRyYWdnaW5nID0gZmFsc2U7XHJcblx0XHQgICAgY2FudmFzLmZhYnJpYy5zZWxlY3Rpb24gPSB0cnVlO1xyXG5cdFx0ICAgIGNyb3B6b25lLnJlY3Quc2V0Q29vcmRzKCk7XHJcbiAgICAgICAgICAgIGNyb3B6b25lLmdyaWQuc2V0Q29vcmRzKCk7XHJcbiAgICAgICAgICAgIGNyb3B6b25lLm92ZXJsYXkuc2V0Q29vcmRzKCk7XHJcblxyXG5cdFx0ICAgIGlmIChjcm9wem9uZS5yZWN0LnZpc2libGUpIHtcclxuXHRcdCAgICBcdGNhbnZhcy5mYWJyaWMuc2V0QWN0aXZlT2JqZWN0KGNyb3B6b25lLnJlY3QpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cclxuXHRcdGF0dGFjaEV2ZW50czogZnVuY3Rpb24oKSB7XHJcblxyXG5cdFx0XHQvL3JlZHJhdyBjcm9wem9uZSBncmlkIGFuZCBvdmVybGF5IHdoZW4gY3JvcHpvbmUgaXMgcmVzaXplZFxyXG5cdFx0XHR0aGlzLnJlY3Qub24oJ21vdmluZycsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdGNyb3B6b25lLmNvbnN0cmFpbldpdGhpbkNhbnZhcyhjcm9wem9uZS5yZWN0KTtcclxuXHRcdFx0XHRjcm9wem9uZS5kcmF3T3ZlcmxheSgpO1xyXG5cdFx0XHRcdGNyb3B6b25lLmRyYXdHcmlkKCk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0dGhpcy5yZWN0Lm9uKCdzY2FsaW5nJywgZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRcdGNyb3B6b25lLmNvbnN0cmFpbldpdGhpbkNhbnZhc09uU2NhbGluZyhjcm9wem9uZS5yZWN0LCBlKTtcclxuXHRcdFx0XHRjcm9wem9uZS5kcmF3T3ZlcmxheSgpO1xyXG5cdFx0XHRcdGNyb3B6b25lLmRyYXdHcmlkKCk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Y2FudmFzLmZhYnJpYy5vbihcIm1vdXNlOmRvd25cIiwgY3JvcHpvbmUub25Nb3VzZURvd24pO1xyXG5cdFx0XHRjYW52YXMuZmFicmljLm9uKFwibW91c2U6bW92ZVwiLCBjcm9wem9uZS5vbk1vdXNlTW92ZSk7XHJcblx0XHRcdGNhbnZhcy5mYWJyaWMub24oXCJtb3VzZTp1cFwiLCBjcm9wem9uZS5vbk1vdXNlVXApO1xyXG5cdFx0fSxcclxuXHJcblx0XHRyZW1vdmU6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRjYW52YXMuZmFicmljLm9mZihcIm1vdXNlOmRvd25cIiwgY3JvcHpvbmUub25Nb3VzZURvd24pO1xyXG5cdFx0XHRjYW52YXMuZmFicmljLm9mZihcIm1vdXNlOm1vdmVcIiwgY3JvcHpvbmUub25Nb3VzZU1vdmUpO1xyXG5cdFx0XHRjYW52YXMuZmFicmljLm9mZihcIm1vdXNlOnVwXCIsIGNyb3B6b25lLm9uTW91c2VVcCk7XHJcblxyXG5cdFx0XHRjYW52YXMuZmFicmljLnJlbW92ZSh0aGlzLnJlY3QpO1xyXG5cdFx0XHRjYW52YXMuZmFicmljLnJlbW92ZSh0aGlzLmdyaWQpO1xyXG5cdFx0XHRjYW52YXMuZmFicmljLnJlbW92ZSh0aGlzLm92ZXJsYXkpO1xyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG5cdFx0XHR0aGlzLmluaXRpYXRlZCA9IGZhbHNlO1xyXG5cdFx0fSxcclxuXHJcblx0XHRoaWRlOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0dGhpcy5yZWN0LnZpc2libGUgPSBmYWxzZTtcclxuXHRcdFx0dGhpcy5yZWN0Lmhhc0NvbnRyb2xzID0gZmFsc2U7XHJcblx0XHRcdHRoaXMuZ3JpZC52aXNpYmxlID0gZmFsc2U7XHJcblx0XHRcdHRoaXMub3ZlcmxheS52aXNpYmxlID0gZmFsc2U7XHJcblx0XHR9LFxyXG5cclxuXHRcdGdldE9wdGltYWxEaW1lbnNpb25zOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IGNhbnZhcy5vcmlnaW5hbC53aWR0aCAvIDIsXHJcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSBjYW52YXMub3JpZ2luYWwuaGVpZ2h0IC8gMixcclxuICAgICAgICAgICAgICAgIGxlZnQgPSBjYW52YXMub3JpZ2luYWwud2lkdGggLyA0LFxyXG4gICAgICAgICAgICAgICAgdG9wID0gY2FudmFzLm9yaWdpbmFsLmhlaWdodCAvIDQ7XHJcblxyXG5cdFx0XHRpZiAoY2FudmFzLnZpZXdwb3J0Lm9mZnNldFdpZHRoIDwgY2FudmFzLm9yaWdpbmFsLndpZHRoKSB7XHJcblx0XHRcdFx0d2lkdGggPSBjYW52YXMudmlld3BvcnQub2Zmc2V0V2lkdGggLyAyO1xyXG5cdFx0XHRcdGxlZnQgPSBjYW52YXMudmlld3BvcnQub2Zmc2V0V2lkdGggLyA0O1xyXG5cclxuXHRcdFx0fVxyXG5cclxuICAgICAgICAgICAgaWYgKGNhbnZhcy52aWV3cG9ydC5vZmZzZXRIZWlnaHQgPCBjYW52YXMub3JpZ2luYWwuaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSBjYW52YXMudmlld3BvcnQub2Zmc2V0SGVpZ2h0IC8gMjtcclxuICAgICAgICAgICAgICAgIHRvcCA9IGNhbnZhcy52aWV3cG9ydC5vZmZzZXRIZWlnaHQgLyA0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG5cdFx0XHRyZXR1cm4ge3dpZHRoOiB3aWR0aCwgaGVpZ2h0OiBoZWlnaHQsIGxlZnQ6IGxlZnQsIHRvcDogdG9wfTtcclxuXHRcdH0sXHJcblxyXG5cdFx0ZHJhd01haW5ab25lOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0dmFyIGRpbWVuc2lvbnMgPSB0aGlzLmdldE9wdGltYWxEaW1lbnNpb25zKCk7XHJcblxyXG5cdFx0XHR0aGlzLnJlY3QgPSBuZXcgZmFicmljLlJlY3Qoe1xyXG5cdFx0XHQgICAgZmlsbDogJ3RyYW5zcGFyZW50JyxcclxuXHRcdFx0ICAgIHN0cm9rZTogJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC42KScsXHJcblx0XHRcdCAgICBoYXNCb3JkZXJzOiBmYWxzZSxcclxuXHRcdFx0ICAgIHdpZHRoOiBkaW1lbnNpb25zLndpZHRoLFxyXG5cdFx0XHQgICAgaGVpZ2h0OiBkaW1lbnNpb25zLmhlaWdodCxcclxuXHRcdFx0ICAgIGxlZnQ6IGRpbWVuc2lvbnMubGVmdCxcclxuXHRcdFx0ICAgIHRvcDogZGltZW5zaW9ucy50b3AsXHJcblx0XHRcdCAgICBoYXNSb3RhdGluZ1BvaW50OiBmYWxzZSxcclxuXHRcdFx0ICAgIG5hbWU6ICdjcm9wem9uZScsXHJcblx0XHRcdCAgICBjb3JuZXJDb2xvcjogJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC42KScsXHJcblx0XHRcdCAgICB0cmFuc3BhcmVudENvcm5lcnM6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgaWdub3JlOiB0cnVlXHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Y2FudmFzLmZhYnJpYy5hZGQodGhpcy5yZWN0KTtcclxuXHRcdFx0dGhpcy5yZWN0Lm1vdmVUbygzKTtcclxuXHRcdFx0Y2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3QoY3JvcHpvbmUucmVjdCk7XHJcblx0XHR9LFxyXG5cclxuXHRcdGRyYXdHcmlkOiBmdW5jdGlvbigpIHtcclxuXHJcblx0XHRcdGlmICggISB0aGlzLmluaXRpYXRlZCkge1xyXG5cdFx0XHRcdHRoaXMubGluZTEgPSBuZXcgZmFicmljLkxpbmUoW10sIHsgc3Ryb2tlOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjYpJywgc3Ryb2tlV2lkdGg6IDEsIHNlbGVjdGFibGU6IGZhbHNlLCBldmVudGVkOiBmYWxzZSB9KTtcclxuXHRcdFx0XHR0aGlzLmxpbmUyID0gbmV3IGZhYnJpYy5MaW5lKFtdLCB7IHN0cm9rZTogJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC42KScsIHN0cm9rZVdpZHRoOiAxLCBzZWxlY3RhYmxlOiBmYWxzZSwgZXZlbnRlZDogZmFsc2UgfSk7XHJcblx0XHRcdFx0dGhpcy5saW5lMyA9IG5ldyBmYWJyaWMuTGluZShbXSwgeyBzdHJva2U6ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNiknLCBzdHJva2VXaWR0aDogMSwgc2VsZWN0YWJsZTogZmFsc2UsIGV2ZW50ZWQ6IGZhbHNlIH0pO1xyXG5cdFx0XHRcdHRoaXMubGluZTQgPSBuZXcgZmFicmljLkxpbmUoW10sIHsgc3Ryb2tlOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjYpJywgc3Ryb2tlV2lkdGg6IDEsIHNlbGVjdGFibGU6IGZhbHNlLCBldmVudGVkOiBmYWxzZSB9KTtcclxuXHRcdFx0XHR0aGlzLmdyaWQgPSBuZXcgZmFicmljLkdyb3VwKFt0aGlzLmxpbmUxLCB0aGlzLmxpbmUyLCB0aGlzLmxpbmUzLCB0aGlzLmxpbmU0XSk7XHJcblx0XHRcdFx0dGhpcy5ncmlkLm9yaWdpblkgPSAnbGVmdCc7XHJcblx0XHRcdFx0dGhpcy5ncmlkLm9yaWdpblggPSAndG9wJztcclxuICAgICAgICAgICAgICAgIHRoaXMuZ3JpZC5pZ25vcmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ncmlkLnNlbGVjdGFibGUgPSBmYWxzZTtcclxuXHRcdFx0XHRjYW52YXMuZmFicmljLmFkZCh0aGlzLmdyaWQpO1xyXG5cdFx0ICAgIFx0dGhpcy5ncmlkLm1vdmVUbygxMCk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHRoaXMuZ3JpZC53aWR0aCA9IHRoaXMucmVjdC5nZXRXaWR0aCgpO1xyXG5cdFx0XHR0aGlzLmdyaWQuaGVpZ2h0ID0gdGhpcy5yZWN0LmdldEhlaWdodCgpO1xyXG5cdFx0XHR0aGlzLmdyaWQubGVmdCA9IHRoaXMucmVjdC5nZXRMZWZ0KCk7XHJcblx0XHRcdHRoaXMuZ3JpZC50b3AgPSB0aGlzLnJlY3QuZ2V0VG9wKCk7XHJcblxyXG5cdFx0XHR2YXIgd2lkdGggID0gY3JvcHpvbmUucmVjdC5nZXRXaWR0aCgpIC8gMyxcclxuXHRcdFx0XHRoZWlnaHQgPSBjcm9wem9uZS5yZWN0LmdldEhlaWdodCgpIC8gMztcclxuXHJcblx0XHRcdHRoaXMubGluZTEuc2V0KHtcclxuXHRcdFx0XHR4MTogd2lkdGgsXHJcblx0XHRcdFx0eTE6IDAsXHJcblx0XHRcdFx0eDI6IHdpZHRoLFxyXG5cdFx0XHRcdHkyOiBjcm9wem9uZS5ncmlkLmdldEhlaWdodCgpLFxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdHRoaXMubGluZTIuc2V0KHtcclxuXHRcdFx0XHR4MTogd2lkdGggKiAyLFxyXG5cdFx0XHRcdHkxOiAwLFxyXG5cdFx0XHRcdHgyOiB3aWR0aCAqIDIsXHJcblx0XHRcdFx0eTI6IGNyb3B6b25lLmdyaWQuZ2V0SGVpZ2h0KClcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHR0aGlzLmxpbmUzLnNldCh7XHJcblx0XHRcdFx0eDE6IDAsXHJcblx0XHRcdFx0eTE6IGhlaWdodCxcclxuXHRcdFx0XHR4MjogY3JvcHpvbmUuZ3JpZC5nZXRXaWR0aCgpLFxyXG5cdFx0XHRcdHkyOiBoZWlnaHRcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHR0aGlzLmxpbmU0LnNldCh7XHJcblx0XHRcdFx0eDE6IDAsXHJcblx0XHRcdFx0eTE6IGhlaWdodCAqIDIsXHJcblx0XHRcdFx0eDI6IGNyb3B6b25lLmdyaWQuZ2V0V2lkdGgoKSxcclxuXHRcdFx0XHR5MjogaGVpZ2h0ICogMlxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdHRoaXMuY29uc3RyYWluV2l0aGluQ2FudmFzKHRoaXMuZ3JpZCk7XHJcblx0XHR9LFxyXG5cclxuXHRcdGRyYXdPdmVybGF5OiBmdW5jdGlvbigpIHtcclxuXHJcblx0ICAgIFx0aWYgKCAhIHRoaXMuaW5pdGlhdGVkKSB7XHJcblx0ICAgIFx0XHR0aGlzLnRvcFJlY3QgPSBuZXcgZmFicmljLlJlY3Qoe2ZpbGw6ICdyZ2JhKDAsMCwwLDAuNyknLCBzZWxlY3RhYmxlOiB0cnVlLCBldmVudGVkOiBmYWxzZX0pO1xyXG5cdCAgICBcdFx0dGhpcy5yaWdodFJlY3QgPSBuZXcgZmFicmljLlJlY3Qoe2ZpbGw6ICdyZ2JhKDAsMCwwLDAuNyknLCBzZWxlY3RhYmxlOiB0cnVlLCBldmVudGVkOiBmYWxzZX0pO1xyXG5cdCAgICBcdFx0dGhpcy5ib3R0b21SZWN0ID0gbmV3IGZhYnJpYy5SZWN0KHtmaWxsOiAncmdiYSgwLDAsMCwwLjcpJywgc2VsZWN0YWJsZTogdHJ1ZSwgZXZlbnRlZDogZmFsc2V9KTtcclxuXHQgICAgXHRcdHRoaXMubGVmdFJlY3QgPSBuZXcgZmFicmljLlJlY3Qoe2ZpbGw6ICdyZ2JhKDAsMCwwLDAuNyknLCBzZWxlY3RhYmxlOiB0cnVlLCBldmVudGVkOiBmYWxzZX0pO1xyXG5cdCAgICBcdFx0dGhpcy5vdmVybGF5ID0gbmV3IGZhYnJpYy5Hcm91cChbdGhpcy50b3BSZWN0LCB0aGlzLnJpZ2h0UmVjdCwgdGhpcy5ib3R0b21SZWN0LCB0aGlzLmxlZnRSZWN0XSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm92ZXJsYXkuaWdub3JlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMub3ZlcmxheS5uYW1lID0gJ2dyaWQub3ZlcmxheSc7XHJcblx0XHRcdFx0Y2FudmFzLmZhYnJpYy5hZGQodGhpcy5vdmVybGF5KTtcclxuXHRcdFx0XHR0aGlzLm92ZXJsYXkubW92ZVRvKDEpO1xyXG5cdCAgICBcdH1cclxuXHJcbiAgICBcdFx0dGhpcy50b3BSZWN0LnNldCh7XHJcblx0ICAgIFx0XHRsZWZ0OiAwLFxyXG5cdFx0XHRcdHRvcDogMCxcclxuXHRcdFx0XHR3aWR0aDogY2FudmFzLm9yaWdpbmFsLndpZHRoLFxyXG5cdFx0XHRcdGhlaWdodDogdGhpcy5yZWN0LmdldEhlaWdodCgpIDwgMCA/IHRoaXMucmVjdC5nZXRUb3AoKSAtIE1hdGguYWJzKHRoaXMucmVjdC5nZXRIZWlnaHQoKSkgOiB0aGlzLnJlY3QuZ2V0VG9wKCksXHJcblx0ICAgIFx0fSk7XHJcblxyXG5cdCAgICBcdHRoaXMucmlnaHRSZWN0LnNldCh7XHJcblx0ICAgIFx0XHRsZWZ0OiB0aGlzLnJlY3QuZ2V0V2lkdGgoKSA8IDAgPyB0aGlzLnJlY3QuZ2V0TGVmdCgpIDogdGhpcy5yZWN0LmdldExlZnQoKSArIHRoaXMucmVjdC5nZXRXaWR0aCgpLFxyXG5cdFx0XHRcdHRvcDogdGhpcy5yZWN0LmdldFRvcCgpLFxyXG5cdFx0XHRcdHdpZHRoOiB0aGlzLnJlY3QuZ2V0V2lkdGgoKSA8IDAgPyBjYW52YXMub3JpZ2luYWwud2lkdGggLSAodGhpcy5yZWN0LmdldExlZnQoKSArIHRoaXMucmVjdC5nZXRXaWR0aCgpKSAtIE1hdGguYWJzKHRoaXMucmVjdC5nZXRXaWR0aCgpKSA6IGNhbnZhcy5vcmlnaW5hbC53aWR0aCAtICh0aGlzLnJlY3QuZ2V0TGVmdCgpICsgdGhpcy5yZWN0LmdldFdpZHRoKCkpLFxyXG5cdFx0XHRcdGhlaWdodDogdGhpcy5yZWN0LmdldEhlaWdodCgpLFxyXG5cdCAgICBcdH0pO1xyXG5cclxuXHQgICAgXHR0aGlzLmJvdHRvbVJlY3Quc2V0KHtcclxuXHQgICAgXHRcdGxlZnQ6IDAsXHJcblx0XHRcdFx0dG9wOiB0aGlzLnJlY3QuZ2V0SGVpZ2h0KCkgPCAwID8gdGhpcy5yZWN0LmdldFRvcCgpIDogdGhpcy5yZWN0LmdldFRvcCgpICsgdGhpcy5yZWN0LmdldEhlaWdodCgpLFxyXG5cdFx0XHRcdHdpZHRoOiBjYW52YXMub3JpZ2luYWwud2lkdGgsXHJcblx0XHRcdFx0aGVpZ2h0OiB0aGlzLnJlY3QuZ2V0SGVpZ2h0KCkgPCAwID8gY2FudmFzLm9yaWdpbmFsLmhlaWdodCAtICh0aGlzLnJlY3QuZ2V0VG9wKCkpIDogY2FudmFzLm9yaWdpbmFsLmhlaWdodCAtICh0aGlzLnJlY3QuZ2V0VG9wKCkgKyB0aGlzLnJlY3QuZ2V0SGVpZ2h0KCkpLFxyXG5cdCAgICBcdH0pO1xyXG5cclxuXHQgICAgXHR0aGlzLmxlZnRSZWN0LnNldCh7XHJcblx0ICAgIFx0XHRsZWZ0OiAwLFxyXG5cdFx0XHRcdHRvcDogdGhpcy5yZWN0LmdldFRvcCgpLFxyXG5cdFx0XHRcdHdpZHRoOiB0aGlzLnJlY3QuZ2V0V2lkdGgoKSA+IDAgPyB0aGlzLnJlY3QuZ2V0TGVmdCgpIDogdGhpcy5yZWN0LmdldExlZnQoKSAtIE1hdGguYWJzKHRoaXMucmVjdC5nZXRXaWR0aCgpKSxcclxuXHRcdFx0XHRoZWlnaHQ6IHRoaXMucmVjdC5nZXRIZWlnaHQoKSxcclxuXHQgICAgXHR9KTtcclxuXHJcblxyXG5cdCAgICB9XHJcblx0fTtcclxuXHJcblx0cmV0dXJuIGNyb3B6b25lO1xyXG5cclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5jcm9wJylcclxuXHJcbi5jb250cm9sbGVyKCdDcm9wQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnY3JvcHBlcicsICdjcm9wem9uZScsIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgY3JvcHBlciwgY3JvcHpvbmUpIHtcclxuXHJcblx0JHNjb3BlLmNyb3BwZXIgPSBjcm9wcGVyO1xyXG5cdCRzY29wZS5jcm9wem9uZSA9IGNyb3B6b25lO1xyXG5cclxuICAgICRyb290U2NvcGUuJG9uKCd0YWIuY2hhbmdlZCcsIGZ1bmN0aW9uKGUsIG5ld1RhYiwgb2xkVGFiKSB7XHJcbiAgICAgICBpZiAob2xkVGFiID09PSAnYmFzaWNzJyAmJiBuZXdUYWIgIT09ICdiYXNpY3MnKSB7XHJcbiAgICAgICAgICAgY3JvcHBlci5zdG9wKCk7XHJcbiAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAkcm9vdFNjb3BlLiR3YXRjaCgnYWN0aXZlUGFuZWwnLCBmdW5jdGlvbihuZXdQYW5lbCwgb2xkUGFuZWwpIHtcclxuICAgICAgICBpZiAobmV3UGFuZWwgIT09ICdjcm9wJyAmJiBvbGRQYW5lbCA9PT0gJ2Nyb3AnKSB7XHJcbiAgICAgICAgICAgIGNyb3B6b25lLnJlbW92ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuXHQkcm9vdFNjb3BlLiRvbignY3JvcHpvbmUuYWRkZWQnLCBmdW5jdGlvbigpIHtcclxuXHRcdCRzY29wZS53aWR0aCA9IE1hdGgucm91bmQoY3JvcHpvbmUucmVjdC53aWR0aCk7XHJcblx0XHQkc2NvcGUuaGVpZ2h0ID0gTWF0aC5yb3VuZChjcm9wem9uZS5yZWN0LmhlaWdodCk7XHJcblx0fSk7XHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnaW1hZ2UuYmFzaWNzJywgW10pXHJcblxyXG4uY29udHJvbGxlcignUm90YXRlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnY2FudmFzJywgJ2hpc3RvcnknLCBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUsIGNhbnZhcywgaGlzdG9yeSkge1xyXG5cclxuICAgICAgICAkc2NvcGUuYW5nbGUgPSAwO1xyXG5cclxuICAgICAgICAkc2NvcGUuc3RhcnRSb3RhdG9yID0gZnVuY3Rpb24oJGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGhpc3RvcnkuYWRkKCdyb3RhdGUtb3JpZ2luYWwtc3RhdGUnLCAnYmFja3VwJywgdHJ1ZSk7XHJcbiAgICAgICAgICAgICRzY29wZS5vcGVuUGFuZWwoJ3JvdGF0ZScsICRldmVudCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmFwcGx5Um90YXRpb24gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVQYW5lbCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBoaXN0b3J5LmFkZCgncm90YXRpb24nLCAncm90YXRlLXJpZ2h0Jyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBoaXN0b3J5LmxvYWQoJ3JvdGF0ZS1vcmlnaW5hbC1zdGF0ZScpO1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XHJcbiAgICAgICAgICAgICRzY29wZS5hbmdsZSA9IDA7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy9yb3RhdGUgcHJvcGVybHkgYnkgc2NhbGluZyBjYW52YXMgdG8gbmV3IGhlaWdodCBhZnRlciByb3RhdGluZyBtYWluIGltYWdlIGJ5IDkwIGRlZ3JlZXNcclxuICAgICAgICAkc2NvcGUucm90YXRlUHJvcGVyID0gZnVuY3Rpb24ob3JpZ2luYWxBbmdsZSkge1xyXG4gICAgICAgICAgICBjYW52YXMuem9vbSgxKTtcclxuICAgICAgICAgICAgdmFyIGFuZ2xlID0gKGNhbnZhcy5tYWluSW1hZ2UuZ2V0QW5nbGUoKSArIG9yaWdpbmFsQW5nbGUpICUgMzYwO1xyXG5cclxuICAgICAgICAgICAgdmFyIGhlaWdodCA9IE1hdGguYWJzKGNhbnZhcy5tYWluSW1hZ2UuZ2V0V2lkdGgoKSooTWF0aC5zaW4oYW5nbGUqTWF0aC5QSS8xODApKSkrTWF0aC5hYnMoY2FudmFzLm1haW5JbWFnZS5nZXRIZWlnaHQoKSooTWF0aC5jb3MoYW5nbGUqTWF0aC5QSS8xODApKSksXHJcbiAgICAgICAgICAgICAgICB3aWR0aCA9IE1hdGguYWJzKGNhbnZhcy5tYWluSW1hZ2UuZ2V0SGVpZ2h0KCkqKE1hdGguc2luKGFuZ2xlKk1hdGguUEkvMTgwKSkpK01hdGguYWJzKGNhbnZhcy5tYWluSW1hZ2UuZ2V0V2lkdGgoKSooTWF0aC5jb3MoYW5nbGUqTWF0aC5QSS8xODApKSk7XHJcblxyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLnNldFdpZHRoKHdpZHRoICogY2FudmFzLmN1cnJlbnRab29tKTtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRIZWlnaHQoaGVpZ2h0ICogY2FudmFzLmN1cnJlbnRab29tKTtcclxuICAgICAgICAgICAgY2FudmFzLm9yaWdpbmFsLmhlaWdodCA9IGhlaWdodDtcclxuICAgICAgICAgICAgY2FudmFzLm9yaWdpbmFsLndpZHRoICA9IHdpZHRoO1xyXG4gICAgICAgICAgICBjYW52YXMubWFpbkltYWdlLmNlbnRlcigpO1xyXG5cclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mb3JFYWNoT2JqZWN0KGZ1bmN0aW9uKG9iaikge1xyXG4gICAgICAgICAgICAgICAgb2JqLnJvdGF0ZSgob2JqLmdldEFuZ2xlKCkgKyBvcmlnaW5hbEFuZ2xlKSAlIDM2MCk7XHJcbiAgICAgICAgICAgICAgICBvYmouc2V0Q29vcmRzKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgJHJvb3RTY29wZS5lZGl0b3JDdXN0b21BY3Rpb25zLnJvdGF0ZSA9IG9yaWdpbmFsQW5nbGU7XHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgICAgIGNhbnZhcy5maXRUb1NjcmVlbigpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vb25seSByb3RhdGUgdGhlIG9iamVjdHMgb2YgY2FudmFzIHdoaWxlIGxlYXZpbmcgY2FudmFzIHdpZHRoL2hlaWdodCBpbnRhY3RcclxuICAgICAgICAkc2NvcGUucm90YXRlID0gZnVuY3Rpb24oYW5nbGUsIGRpcmVjdGlvbikge1xyXG4gICAgICAgICAgICBpZiAoYW5nbGUgPiAzNjAgfHwgYW5nbGUgPCAwKSByZXR1cm47XHJcbiAgICAgICAgICAgIHZhciByZXNldE9yaWdpbiA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mb3JFYWNoT2JqZWN0KGZ1bmN0aW9uKG9iaikge1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChkaXJlY3Rpb24gJiYgZGlyZWN0aW9uID09PSAnbGVmdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBhbmdsZSA9IG9iai5nZXRBbmdsZSgpIC0gOTA7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiAmJiBkaXJlY3Rpb24gPT09ICdyaWdodCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBhbmdsZSA9IG9iai5nZXRBbmdsZSgpICsgOTA7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKChvYmoub3JpZ2luWCAhPT0gJ2NlbnRlcicgfHwgb2JqLm9yaWdpblkgIT09ICdjZW50ZXInKSAmJiBvYmouY2VudGVyZWRSb3RhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zZXRPcmlnaW5Ub0NlbnRlciAmJiAkc2NvcGUuc2V0T3JpZ2luVG9DZW50ZXIob2JqKTtcclxuICAgICAgICAgICAgICAgICAgICByZXNldE9yaWdpbiA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgYW5nbGUgPSBhbmdsZSA+IDM2MCA/IDkwIDogYW5nbGUgPCAwID8gMjcwIDogYW5nbGU7XHJcblxyXG4gICAgICAgICAgICAgICAgb2JqLnNldEFuZ2xlKGFuZ2xlKS5zZXRDb29yZHMoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAocmVzZXRPcmlnaW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2V0Q2VudGVyVG9PcmlnaW4gJiYgJHNjb3BlLnNldENlbnRlclRvT3JpZ2luKG9iaik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY2FudmFzLmZpdFRvU2NyZWVuKCk7XHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnNldE9yaWdpblRvQ2VudGVyID0gZnVuY3Rpb24gKG9iaikge1xyXG4gICAgICAgICAgICBvYmouX29yaWdpbmFsT3JpZ2luWCA9IG9iai5vcmlnaW5YO1xyXG4gICAgICAgICAgICBvYmouX29yaWdpbmFsT3JpZ2luWSA9IG9iai5vcmlnaW5ZO1xyXG5cclxuICAgICAgICAgICAgdmFyIGNlbnRlciA9IG9iai5nZXRDZW50ZXJQb2ludCgpO1xyXG5cclxuICAgICAgICAgICAgb2JqLnNldCh7XHJcbiAgICAgICAgICAgICAgICBvcmlnaW5YOiAnY2VudGVyJyxcclxuICAgICAgICAgICAgICAgIG9yaWdpblk6ICdjZW50ZXInLFxyXG4gICAgICAgICAgICAgICAgbGVmdDogY2VudGVyLngsXHJcbiAgICAgICAgICAgICAgICB0b3A6IGNlbnRlci55XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS5zZXRDZW50ZXJUb09yaWdpbiA9IGZ1bmN0aW9uIChvYmopIHtcclxuICAgICAgICAgICAgdmFyIG9yaWdpblBvaW50ID0gb2JqLnRyYW5zbGF0ZVRvT3JpZ2luUG9pbnQoXHJcbiAgICAgICAgICAgICAgICBvYmouZ2V0Q2VudGVyUG9pbnQoKSxcclxuICAgICAgICAgICAgICAgIG9iai5fb3JpZ2luYWxPcmlnaW5YLFxyXG4gICAgICAgICAgICAgICAgb2JqLl9vcmlnaW5hbE9yaWdpblkpO1xyXG5cclxuICAgICAgICAgICAgb2JqLnNldCh7XHJcbiAgICAgICAgICAgICAgICBvcmlnaW5YOiBvYmouX29yaWdpbmFsT3JpZ2luWCxcclxuICAgICAgICAgICAgICAgIG9yaWdpblk6IG9iai5fb3JpZ2luYWxPcmlnaW5ZLFxyXG4gICAgICAgICAgICAgICAgbGVmdDogb3JpZ2luUG9pbnQueCxcclxuICAgICAgICAgICAgICAgIHRvcDogb3JpZ2luUG9pbnQueVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ2ltYWdlLmJhc2ljcycpXHJcblxyXG4uY29udHJvbGxlcignQ2FudmFzQmFja2dyb3VuZENvbnRyb2xsZXInLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ2NhbnZhcycsICdoaXN0b3J5JywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCBjYW52YXMsIGhpc3RvcnkpIHtcclxuXHJcbiAgICAvL2NhbnZhcy5mYWJyaWMuc2V0QmFja2dyb3VuZENvbG9yKCcjZmZmZmZmJyk7XHJcbiAgICAvL2NhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAkc2NvcGUuc2V0QmFja2dyb3VuZCA9IGZ1bmN0aW9uKGNvbG9yKSB7XHJcbiAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRCYWNrZ3JvdW5kQ29sb3IoY29sb3IpO1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5hcHBseSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICRyb290U2NvcGUuYWN0aXZlUGFuZWwgPSBmYWxzZTtcclxuICAgICAgICAkcm9vdFNjb3BlLmJnQ29sb3IgPSAkKFwiI2N2cy1iZ2NvbG9yXCIpLnZhbCgpO1xyXG4gICAgICAgIGhpc3RvcnkuYWRkKCdDYW52YXMgQ29sb3InLCAnZm9ybWF0LWNvbG9yLWZpbGwnKTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICRyb290U2NvcGUuYWN0aXZlUGFuZWwgPSBmYWxzZTtcclxuICAgICAgICBjYW52YXMuZmFicmljLnNldEJhY2tncm91bmRDb2xvcigkcm9vdFNjb3BlLmJnQ29sb3IpO1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICB9O1xyXG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ2ltYWdlLmJhc2ljcycpXHJcblxyXG4uY29udHJvbGxlcignUmVzaXplQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnY2FudmFzJywgJ2hpc3RvcnknLCBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUsIGNhbnZhcywgaGlzdG9yeSkge1xyXG5cclxuICAgICRzY29wZS5jb25zdHJhaW5Qcm9wb3J0aW9ucyA9IHRydWU7XHJcblxyXG4gICAgJHNjb3BlLnBlcmNlbnQgPSAxMDA7XHJcblxyXG4gICAgJHNjb3BlLnN0YXJ0UmVzaXplciA9IGZ1bmN0aW9uKCRldmVudCkge1xyXG4gICAgICAgICRzY29wZS53aWR0aCAgPSAkc2NvcGUudXNlUGVyY2VudGFnZXMgPyAxMDAgOiBNYXRoLmNlaWwoY2FudmFzLm9yaWdpbmFsLndpZHRoKTtcclxuICAgICAgICAkc2NvcGUuaGVpZ2h0ID0gJHNjb3BlLnVzZVBlcmNlbnRhZ2VzID8gMTAwIDogTWF0aC5jZWlsKGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQpO1xyXG4gICAgICAgIGhpc3RvcnkuYWRkKCdiZWZvcmVSZXNpemUnLCBmYWxzZSwgdHJ1ZSk7XHJcbiAgICAgICAgY2FudmFzLnpvb20oMSk7XHJcbiAgICAgICAgJHNjb3BlLm9wZW5QYW5lbCgncmVzaXplJywgJGV2ZW50KTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUb2dnbGUgcmVzaXppbmcgbW9kZSBiZXR3ZWVuIHBlcmNlbnRhZ2VzIGFuZCBwaXhsZXMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtib29sZWFufSB1c2VQZXJjZW50YWdlc1xyXG4gICAgICovXHJcbiAgICAkc2NvcGUudG9nZ2xlUGVyY2VudGFnZXMgPSBmdW5jdGlvbih1c2VQZXJjZW50YWdlcykge1xyXG4gICAgICAgIGlmICh1c2VQZXJjZW50YWdlcykge1xyXG4gICAgICAgICAgICAkc2NvcGUud2lkdGggPSAoJHNjb3BlLndpZHRoIC8gY2FudmFzLm9yaWdpbmFsLndpZHRoKSAqIDEwMDtcclxuICAgICAgICAgICAgJHNjb3BlLmhlaWdodCA9ICgkc2NvcGUuaGVpZ2h0IC8gY2FudmFzLm9yaWdpbmFsLmhlaWdodCkgKiAxMDA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJHNjb3BlLndpZHRoID0gKCRzY29wZS53aWR0aCAqIGNhbnZhcy5vcmlnaW5hbC53aWR0aCkgLyAxMDA7XHJcbiAgICAgICAgICAgICRzY29wZS5oZWlnaHQgPSAoJHNjb3BlLmhlaWdodCAqIGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQpIC8gMTAwO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLmFwcGx5ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGN1cnJlbnRXaWR0aCAgPSBNYXRoLmNlaWwoY2FudmFzLm9yaWdpbmFsLndpZHRoKSxcclxuICAgICAgICAgICAgY3VycmVudEhlaWdodCA9IE1hdGguY2VpbChjYW52YXMub3JpZ2luYWwuaGVpZ2h0KSxcclxuICAgICAgICAgICAgbmV3V2lkdGggICAgICA9IE1hdGguY2VpbCgkc2NvcGUud2lkdGgpLFxyXG4gICAgICAgICAgICBuZXdIZWlnaHQgICAgID0gTWF0aC5jZWlsKCRzY29wZS5oZWlnaHQpO1xyXG5cclxuICAgICAgICBpZiAoJHNjb3BlLnVzZVBlcmNlbnRhZ2VzKSB7XHJcbiAgICAgICAgICAgIHZhciB3aWR0aFNjYWxlICAgID0gJHNjb3BlLndpZHRoIC8gMTAwO1xyXG4gICAgICAgICAgICB2YXIgaGVpZ2h0U2NhbGUgICA9ICRzY29wZS5oZWlnaHQgLyAxMDA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIHdpZHRoU2NhbGUgICAgPSAkc2NvcGUud2lkdGggLyBjYW52YXMub3JpZ2luYWwud2lkdGg7XHJcbiAgICAgICAgICAgIHZhciBoZWlnaHRTY2FsZSAgID0gJHNjb3BlLmhlaWdodCAvIGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY3VycmVudFdpZHRoID09PSBuZXdXaWR0aCAmJiBjdXJyZW50SGVpZ2h0ID09PSBuZXdIZWlnaHQpIHJldHVybjtcclxuXHJcbiAgICAgICAgcmVzaXplKHdpZHRoU2NhbGUsIGhlaWdodFNjYWxlKTtcclxuXHJcbiAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVQYW5lbCA9IGZhbHNlO1xyXG4gICAgICAgIGhpc3RvcnkuYWRkKCdyZXNpemUnLCAnb3Blbi13aWR0aCcpO1xyXG4gICAgICAgIGNhbnZhcy5maXRUb1NjcmVlbigpO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuY2xvc2UgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XHJcbiAgICAgICAgY2FudmFzLmZpdFRvU2NyZWVuKCk7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5hc3BlY3RUb0hlaWdodCA9IGZ1bmN0aW9uKG5ld1dpZHRoKSB7XHJcbiAgICAgICAgaWYgKCAhICRzY29wZS5jb25zdHJhaW5Qcm9wb3J0aW9ucykgcmV0dXJuO1xyXG5cclxuICAgICAgICBpZiAoJHNjb3BlLnVzZVBlcmNlbnRhZ2VzKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5oZWlnaHQgPSBuZXdXaWR0aDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgd1JhdGlvID0gcGFyc2VGbG9hdCgoY2FudmFzLm9yaWdpbmFsLndpZHRoIC8gbmV3V2lkdGgpLnRvUHJlY2lzaW9uKDMpKTtcclxuICAgICAgICAgICAgJHNjb3BlLmhlaWdodCA9IE1hdGguY2VpbChjYW52YXMub3JpZ2luYWwuaGVpZ2h0IC8gd1JhdGlvKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5hc3BlY3RUb1dpZHRoID0gZnVuY3Rpb24obmV3SGVpZ2h0KSB7XHJcbiAgICAgICAgaWYgKCAhICRzY29wZS5jb25zdHJhaW5Qcm9wb3J0aW9ucykgcmV0dXJuO1xyXG5cclxuICAgICAgICBpZiAoJHNjb3BlLnVzZVBlcmNlbnRhZ2VzKSB7XHJcbiAgICAgICAgICAgICRzY29wZS53aWR0aCA9IG5ld0hlaWdodDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgaFJhdGlvID0gcGFyc2VGbG9hdCgoY2FudmFzLm9yaWdpbmFsLmhlaWdodCAvIG5ld0hlaWdodCkudG9QcmVjaXNpb24oMykpO1xyXG4gICAgICAgICAgICAkc2NvcGUud2lkdGggPSBNYXRoLmZsb29yKGNhbnZhcy5vcmlnaW5hbC53aWR0aCAvIGhSYXRpbyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiByZXNpemUod2lkdGhTY2FsZSwgaGVpZ2h0U2NhbGUpIHtcclxuICAgICAgICB2YXIgbmV3SGVpZ2h0ID0gTWF0aC5yb3VuZChjYW52YXMub3JpZ2luYWwuaGVpZ2h0ICogaGVpZ2h0U2NhbGUpLFxyXG4gICAgICAgICAgICBuZXdXaWR0aCAgPSBNYXRoLnJvdW5kKGNhbnZhcy5vcmlnaW5hbC53aWR0aCAqIHdpZHRoU2NhbGUpO1xyXG5cclxuICAgICAgICBjYW52YXMuZmFicmljLnNldEhlaWdodChuZXdIZWlnaHQpO1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMuc2V0V2lkdGgobmV3V2lkdGgpO1xyXG4gICAgICAgIGNhbnZhcy5vcmlnaW5hbC53aWR0aCA9IG5ld1dpZHRoO1xyXG4gICAgICAgIGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQgPSBuZXdIZWlnaHQ7XHJcblxyXG4gICAgICAgIHZhciBvYmplY3RzID0gY2FudmFzLmZhYnJpYy5nZXRPYmplY3RzKCk7XHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiBvYmplY3RzKSB7XHJcbiAgICAgICAgICAgIHZhciBzY2FsZVggPSBvYmplY3RzW2ldLnNjYWxlWDtcclxuICAgICAgICAgICAgdmFyIHNjYWxlWSA9IG9iamVjdHNbaV0uc2NhbGVZO1xyXG4gICAgICAgICAgICB2YXIgbGVmdCA9IG9iamVjdHNbaV0ubGVmdDtcclxuICAgICAgICAgICAgdmFyIHRvcCA9IG9iamVjdHNbaV0udG9wO1xyXG5cclxuICAgICAgICAgICAgdmFyIHRlbXBTY2FsZVggPSBzY2FsZVggKiB3aWR0aFNjYWxlO1xyXG4gICAgICAgICAgICB2YXIgdGVtcFNjYWxlWSA9IHNjYWxlWSAqIGhlaWdodFNjYWxlO1xyXG4gICAgICAgICAgICB2YXIgdGVtcExlZnQgPSBsZWZ0ICogd2lkdGhTY2FsZTtcclxuICAgICAgICAgICAgdmFyIHRlbXBUb3AgPSB0b3AgKiBoZWlnaHRTY2FsZTtcclxuXHJcbiAgICAgICAgICAgIG9iamVjdHNbaV0uc2NhbGVYID0gdGVtcFNjYWxlWDtcclxuICAgICAgICAgICAgb2JqZWN0c1tpXS5zY2FsZVkgPSB0ZW1wU2NhbGVZO1xyXG4gICAgICAgICAgICBvYmplY3RzW2ldLmxlZnQgPSB0ZW1wTGVmdDtcclxuICAgICAgICAgICAgb2JqZWN0c1tpXS50b3AgPSB0ZW1wVG9wO1xyXG5cclxuICAgICAgICAgICAgb2JqZWN0c1tpXS5zZXRDb29yZHMoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICB9XHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnaW1hZ2UuYmFzaWNzJylcclxuXHJcbi5jb250cm9sbGVyKCdSb3VuZGVkQ29ybmVyc0NvbnRyb2xsZXInLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ2NhbnZhcycsICdoaXN0b3J5JywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCBjYW52YXMsIGhpc3RvcnkpIHtcclxuXHJcbiAgICAkc2NvcGUucmFkaXVzID0gNTA7XHJcblxyXG4gICAgJHNjb3BlLnN0YXJ0Um91bmRlZENvcm5lcnMgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgaWYgKCRyb290U2NvcGUuYWN0aXZlUGFuZWwgPT09ICdyb3VuZCcpIHJldHVybjtcclxuXHJcbiAgICAgICAgJHJvb3RTY29wZS5vcGVuUGFuZWwoJ3JvdW5kJywgZSk7XHJcblxyXG4gICAgICAgICRzY29wZS5yZWN0ID0gbmV3IGZhYnJpYy5SZWN0KHtcclxuICAgICAgICAgICAgd2lkdGg6IGNhbnZhcy5vcmlnaW5hbC53aWR0aCxcclxuICAgICAgICAgICAgaGVpZ2h0OiBjYW52YXMub3JpZ2luYWwuaGVpZ2h0LFxyXG4gICAgICAgICAgICByeDogJHNjb3BlLnJhZGl1cyxcclxuICAgICAgICAgICAgcnk6ICRzY29wZS5yYWRpdXMsXHJcbiAgICAgICAgICAgIG9wYWNpdHk6IDEsXHJcbiAgICAgICAgICAgIGZpbGw6ICd0cmFuc3BhcmVudCcsXHJcbiAgICAgICAgICAgIG5hbWU6ICdyb3VuZGluZy1yZWN0JyxcclxuICAgICAgICAgICAgc3Ryb2tlOiAnI2ZmZicsXHJcbiAgICAgICAgICAgIHN0cm9rZURhc2hBcnJheTogWzUsIDVdLFxyXG4gICAgICAgICAgICBzZWxlY3RhYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgZXZlbnRlZDogZmFsc2UsXHJcbiAgICAgICAgICAgIGlnbm9yZTogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjYW52YXMuZmFicmljLmFkZCgkc2NvcGUucmVjdCk7XHJcbiAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLmFkanVzdFByZXZpZXcgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoICEgJHNjb3BlLnJlY3QpIHJldHVybjtcclxuXHJcbiAgICAgICAgJHNjb3BlLnJlY3Quc2V0KHtcclxuICAgICAgICAgICAgcng6ICRzY29wZS5yYWRpdXMsIHJ5OiAkc2NvcGUucmFkaXVzXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uKGxlYXZlUGFuZWwpIHtcclxuICAgICAgICBjYW52YXMuZmFicmljLnJlbW92ZSgkc2NvcGUucmVjdCk7XHJcbiAgICAgICAgJHNjb3BlLnJlY3QgID0gZmFsc2U7XHJcbiAgICAgICAgJHNjb3BlLnJhZGl1cyA9IDUwO1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcblxyXG4gICAgICAgIGlmICggIWxlYXZlUGFuZWwpIHtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVQYW5lbCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLmFwcGx5ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJHJvb3RTY29wZS5lZGl0b3JDdXN0b21BY3Rpb25zLnJvdW5kQ29ybmVycyA9IGFuZ3VsYXIuY29weSgkc2NvcGUucmFkaXVzKTtcclxuXHJcbiAgICAgICAgY2FudmFzLmZhYnJpYy5yZW1vdmUoJHNjb3BlLnJlY3QpO1xyXG4gICAgICAgIGNhbnZhcy56b29tKDEpO1xyXG5cclxuICAgICAgICBjYW52YXMuZmFicmljLmNsaXBUbyA9IGZ1bmN0aW9uKGN0eCkge1xyXG4gICAgICAgICAgICAkc2NvcGUucmVjdC5yZW5kZXIoY3R4KTtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5jbGlwVG8gPSBmYWxzZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBkYXRhID0gY2FudmFzLmZhYnJpYy50b0RhdGFVUkwoKTsgLy9jYW52YXMuZ2V0RGF0YVVSTCgpO1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMuY2xlYXIoKTtcclxuICAgICAgICAkc2NvcGUuY2FuY2VsKCk7XHJcblxyXG4gICAgICAgIGNhbnZhcy5sb2FkTWFpbkltYWdlKGRhdGEsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGhpc3RvcnkuYWRkKCdSb3VuZCBDb3JuZXJzJywgJ3Bhbm9yYW1hLXdpZGUtYW5nbGUnKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgICRyb290U2NvcGUuJG9uKCd0YWIuY2hhbmdlZCcsIGZ1bmN0aW9uKGUsIG5ld1RhYiwgb2xkVGFiKSB7XHJcbiAgICAgICAgaWYgKG9sZFRhYiA9PT0gJ2Jhc2ljcycgJiYgJHNjb3BlLnJlY3QgJiYgbmV3VGFiICE9PSAnYmFzaWNzJykge1xyXG4gICAgICAgICAgICAkc2NvcGUuY2FuY2VsKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgJHJvb3RTY29wZS4kd2F0Y2goJ2FjdGl2ZVBhbmVsJywgZnVuY3Rpb24obmV3UGFuZWwsIG9sZFBhbmVsKSB7XHJcbiAgICAgICAgaWYgKG5ld1BhbmVsICE9PSAncm91bmQnICYmIG9sZFBhbmVsID09PSAncm91bmQnKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5jYW5jZWwodHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1dKTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnSW1hZ2VFZGl0b3InKVxyXG5cclxuLmNvbnRyb2xsZXIoJ1pvb21Db250cm9sbGVyJywgWyckcm9vdFNjb3BlJywgJyRzY29wZScsICdjYW52YXMnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsIGNhbnZhcykge1xyXG5cclxuICAgICRzY29wZS5jYW52YXMgPSBjYW52YXM7XHJcbiAgICAkc2NvcGUuem9vbSA9IDE7XHJcbiAgICAkc2NvcGUubWF4U2NhbGUgPSAyMDA7XHJcbiAgICAkc2NvcGUubWluU2NhbGUgPSAzMDtcclxuXHJcbiAgICAkcm9vdFNjb3BlLiRvbignZWRpdG9yLm1haW5JbWFnZS5sb2FkZWQnLCBmdW5jdGlvbigpIHsgJHNjb3BlLmZpdFRvU2NyZWVuKCkgfSk7XHJcbiAgICAkcm9vdFNjb3BlLiRvbignY2FudmFzLm9wZW5lZE5ldycsIGZ1bmN0aW9uKCkgeyAkc2NvcGUuZml0VG9TY3JlZW4oKSB9KTtcclxuXHJcbiAgICAkc2NvcGUuJHdhdGNoKCdjYW52YXMuY3VycmVudFpvb20nLCBmdW5jdGlvbihuZXdWYWx1ZSkge1xyXG4gICAgICAgIHZhciBjYW52YXNab29tID0gbmV3VmFsdWUgKiAxMDA7XHJcblxyXG4gICAgICAgIGlmIChjYW52YXNab29tICE9PSAkc2NvcGUuem9vbSkge1xyXG4gICAgICAgICAgICAkc2NvcGUuem9vbSA9IGNhbnZhc1pvb207XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgJHNjb3BlLmZpdFRvU2NyZWVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICRzY29wZS56b29tID0gY2FudmFzLmN1cnJlbnRab29tICogMTAwO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICBpZiAoY2FudmFzLm1haW5JbWFnZSkge1xyXG4gICAgICAgICAgICB2YXIgb1dpZHRoID0gY2FudmFzLm1haW5JbWFnZS5vcmlnaW5hbFN0YXRlLndpZHRoLFxyXG4gICAgICAgICAgICAgICAgb0hlaWdodCA9IGNhbnZhcy5tYWluSW1hZ2Uub3JpZ2luYWxTdGF0ZS5oZWlnaHQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIG9XaWR0aCA9IGNhbnZhcy5vcmlnaW5hbC53aWR0aCxcclxuICAgICAgICAgICAgICAgIG9IZWlnaHQgPSBjYW52YXMub3JpZ2luYWwuaGVpZ2h0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIG1heFNjYWxlID0gTWF0aC5taW4oMzU4MiAvIG9IZWlnaHQsIDU3MzEgLyBvV2lkdGgpICogMTAwLFxyXG4gICAgICAgICAgICBtaW5TY2FsZSA9IE1hdGgubWluKDE0MSAvIG9IZWlnaHQsIDIxMSAvIG9XaWR0aCkgKiAxMDA7XHJcblxyXG4gICAgICAgICRzY29wZS5tYXhTY2FsZSA9IE1hdGguY2VpbChtYXhTY2FsZSk7XHJcbiAgICAgICAgJHNjb3BlLm1pblNjYWxlID0gTWF0aC5jZWlsKG1pblNjYWxlKTtcclxuXHJcbiAgICAgICAgY2FudmFzLnpvb20oY2FudmFzLmN1cnJlbnRab29tKTtcclxuICAgIH07XHJcblxyXG4gICAgLy9tYWtlIHN1cmUgd2UgYWRqdXN0IHpvb20gc2xpZGVyIHByb3Blcmx5IG9uIGhpc3RvcnkgY2hhbmdlXHJcbiAgICAkcm9vdFNjb3BlLiRvbignaGlzdG9yeS5sb2FkZWQnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkc2NvcGUuem9vbSA9IGNhbnZhcy5jdXJyZW50U2NhbGUgKiAxMDA7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkc2NvcGUuZG9ab29tID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNhbnZhcy56b29tKCRzY29wZS56b29tIC8gMTAwKTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLmdldEN1cnJlbnRab29tID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQoY2FudmFzLmN1cnJlbnRab29tICogMTAwKTtcclxuICAgIH07XHJcbn1dKTtcclxuXHJcblxyXG5cclxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ0ltYWdlRWRpdG9yJylcclxuXHJcbi5jb250cm9sbGVyKCdUb3BQYW5lbENvbnRyb2xsZXInLCBbJyRyb290U2NvcGUnLCAnJHNjb3BlJywgJyRtZERpYWxvZycsICckbWRUb2FzdCcsICckJHJBRicsICckdGltZW91dCcsICckd2luZG93JywgJ2NhbnZhcycsICdoaXN0b3J5JywgJ3NhdmVyJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlLCAkbWREaWFsb2csICRtZFRvYXN0LCAkJHJBRiwgJHRpbWVvdXQsICR3aW5kb3csIGNhbnZhcywgaGlzdG9yeSwgc2F2ZXIpIHtcclxuXHJcbiAgICAkc2NvcGUuaGlzdG9yeSA9IGhpc3Rvcnk7XHJcblxyXG4gICAgJHNjb3BlLmlzRGVtbyA9ICRyb290U2NvcGUuaXNEZW1vO1xyXG4gICAgJHNjb3BlLmNhbk9wZW5JbWFnZSA9IGZhbHNlO1xyXG4gICAgJHNjb3BlLmNhbnZhcyA9IGNhbnZhcztcclxuICAgICRzY29wZS5vcGVuSW1hZ2VNb2RlID0gJ29wZW4nO1xyXG5cclxuICAgICRzY29wZS5jYW52YXNXaWR0aCA9IDgwMDtcclxuICAgICRzY29wZS5jYW52YXNIZWlnaHQgPSA2MDA7XHJcblxyXG4gICAgJHNjb3BlLmltYWdlTmFtZSA9ICdpbWFnZSc7XHJcbiAgICAkc2NvcGUuaW1hZ2VUeXBlID0gJ2pwZWcnO1xyXG4gICAgJHNjb3BlLmltYWdlUXVhbGl0eSA9IDg7XHJcbiAgICBcclxuICAgICRzY29wZS5pbWFnZU5hbWUgPSAkcm9vdFNjb3BlLm9yZGVyX2lkICsgXCItXCIgKyAkcm9vdFNjb3BlLnByb2R1Y3RfaWQ7XHJcbiAgICAkc2NvcGUub2JqZWN0c1BhbmVsT3BlbiA9IHRydWU7XHJcbiAgICAkc2NvcGUuaGlzdG9yeVBhbmVsT3BlbiA9IGZhbHNlO1xyXG5cclxuICAgICRzY29wZS5vcGVuVXBsb2FkRGlhbG9nID0gZnVuY3Rpb24oJGV2ZW50KSB7XHJcbiAgICAgICAgJG1kRGlhbG9nLnNob3coe1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJCgnI21haW4taW1hZ2UtdXBsb2FkLWRpYWxvZy10ZW1wbGF0ZScpLmh0bWwoKSxcclxuICAgICAgICAgICAgdGFyZ2V0RXZlbnQ6ICRldmVudCxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1RvcFBhbmVsQ29udHJvbGxlcicsXHJcbiAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS50b2dnbGVSaWdodFBhbmVsID0gZnVuY3Rpb24obmFtZSwgZSkge1xyXG4gICAgICAgIHZhciBwYW5lbElzT3BlbiA9ICRzY29wZVtuYW1lKydQYW5lbE9wZW4nXTtcclxuXHJcbiAgICAgICAgaWYgKHBhbmVsSXNPcGVuKSB7XHJcbiAgICAgICAgICAgICRzY29wZVtuYW1lKydQYW5lbE9wZW4nXSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAkKCcjJytuYW1lKS5oaWRlKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJHNjb3BlW25hbWUrJ1BhbmVsT3BlbiddID0gdHJ1ZTtcclxuICAgICAgICAgICAgJCgnIycrbmFtZSkuc2hvdygpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLnRyYW5zZm9ybU9wZW4gPSBmdW5jdGlvbihuYW1lLCBlKSB7XHJcbiAgICAgICAgdmFyIHBhbmVsID0gJCgnIycrbmFtZSk7XHJcblxyXG4gICAgICAgIHBhbmVsLnJlbW92ZUNsYXNzKCd0cmFuc2l0aW9uLW91dCB0cmFuc2l0aW9uLWluJykuc2hvdygpO1xyXG4gICAgICAgICRzY29wZS50cmFuc2Zvcm1Ub0NsaWNrRWxlbWVudChwYW5lbCwgZSk7XHJcblxyXG4gICAgICAgICQkckFGKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBwYW5lbC5hZGRDbGFzcygndHJhbnNpdGlvbi1pbicpLmNzcygndHJhbnNmb3JtJywgJycpO1xyXG4gICAgICAgICAgICBlLmN1cnJlbnRUYXJnZXQuYmx1cigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUudHJhbnNmb3JtQ2xvc2UgPSBmdW5jdGlvbihuYW1lLCBlKSB7XHJcbiAgICAgICAgdmFyIHBhbmVsID0gJCgnIycrbmFtZSk7XHJcblxyXG4gICAgICAgIHBhbmVsLmFkZENsYXNzKCd0cmFuc2l0aW9uLW91dCcpLnJlbW92ZUNsYXNzKCd0cmFuc2l0aW9uLWluJyk7XHJcbiAgICAgICAgJHNjb3BlLnRyYW5zZm9ybVRvQ2xpY2tFbGVtZW50KHBhbmVsLCBlKTtcclxuXHJcbiAgICAgICAgcGFuZWwub25lKCRyb290U2NvcGUudHJhbnNpdGlvbkVuZEV2ZW50LCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcGFuZWwuaGlkZSgpLmNzcygndHJhbnNmb3JtJywgJycpLnJlbW92ZUNsYXNzKCd0cmFuc2l0aW9uLW91dCcpO1xyXG4gICAgICAgICAgICBlLmN1cnJlbnRUYXJnZXQuYmx1cigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUudHJhbnNmb3JtVG9DbGlja0VsZW1lbnQgPSBmdW5jdGlvbihwYW5lbCwgZSkge1xyXG4gICAgICAgIHZhciBjbGlja1JlY3QgPSBlLnRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICB2YXIgcGFuZWxSZWN0ID0gcGFuZWxbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcblxyXG4gICAgICAgIHZhciBzY2FsZVggPSBNYXRoLm1pbigwLjUsIGNsaWNrUmVjdC53aWR0aCAvIHBhbmVsUmVjdC53aWR0aCk7XHJcbiAgICAgICAgdmFyIHNjYWxlWSA9IE1hdGgubWluKDAuNSwgY2xpY2tSZWN0LmhlaWdodCAvIHBhbmVsUmVjdC5oZWlnaHQpO1xyXG5cclxuICAgICAgICBwYW5lbC5jc3MoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUzZCgnICtcclxuICAgICAgICAgICAgKC1wYW5lbFJlY3QubGVmdCArIGNsaWNrUmVjdC5sZWZ0ICsgY2xpY2tSZWN0LndpZHRoLzIgLSBwYW5lbFJlY3Qud2lkdGgvMikgKyAncHgsJyArXHJcbiAgICAgICAgICAgICgtcGFuZWxSZWN0LnRvcCArIGNsaWNrUmVjdC50b3AgKyBjbGlja1JlY3QuaGVpZ2h0LzIgLSBwYW5lbFJlY3QuaGVpZ2h0LzIpICsgJ3B4LCcgK1xyXG4gICAgICAgICAgICAnMCkgc2NhbGUoJyArIHNjYWxlWCArICcsJyArIHNjYWxlWSArICcpJ1xyXG4gICAgICAgICk7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5vcGVuU2F2ZURpYWxvZyA9IGZ1bmN0aW9uKCRldmVudCkge1xyXG4gICAgICAgIGlmICgkcm9vdFNjb3BlLmdldFBhcmFtKCdvblNhdmVCdXR0b25DbGljaycpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkcm9vdFNjb3BlLmdldFBhcmFtKCdvblNhdmVCdXR0b25DbGljaycpKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoJHJvb3RTY29wZS5kZWxheUVkaXRvclN0YXJ0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzYXZlci5zYXZlSW1hZ2UoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRtZERpYWxvZy5zaG93KHtcclxuICAgICAgICAgICAgdGVtcGxhdGU6ICQoJyNzYXZlLWltYWdlLWRpYWxvZycpLmh0bWwoKSxcclxuICAgICAgICAgICAgdGFyZ2V0RXZlbnQ6ICRldmVudCxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1RvcFBhbmVsQ29udHJvbGxlcicsXHJcbiAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5vcGVuSGVscCA9IGZ1bmN0aW9uKCRldmVudCkge1xyXG5cclxuICAgICAgICAkbWREaWFsb2cuc2hvdyh7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlOiAkKCcjbW9kYWwtaGVscC10ZXh0JykuaHRtbCgpLFxyXG4gICAgICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbJyRzY29wZScsICckbWREaWFsb2cnLCBmdW5jdGlvbigkc2NvcGUsICRtZERpYWxvZykge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNsb3NlTW9kYWwgPSAkbWREaWFsb2cuaGlkZTtcclxuICAgICAgICAgICAgfV1cclxuICAgICAgICB9KTsgICAgICAgIFxyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuY3JlYXRlTmV3Q2FudmFzID0gZnVuY3Rpb24od2lkdGgsIGhlaWdodCkge1xyXG4gICAgICAgIGNhbnZhcy5vcGVuTmV3KHdpZHRoLCBoZWlnaHQpO1xyXG4gICAgICAgICRzY29wZS5jbG9zZVVwbG9hZERpYWxvZygpO1xyXG4gICAgICAgICRyb290U2NvcGUuc3RhcnRlZCA9IHRydWU7XHJcbiAgICAgICAgJHJvb3RTY29wZS5yZXNldFVJKCk7IFxyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUub3BlblNhbXBsZUltYWdlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2FudmFzLmxvYWRNYWluSW1hZ2UoJ2Fzc2V0cy9pbWFnZXMvbG90dXMuanBnJyk7XHJcbiAgICAgICAgJHNjb3BlLmNsb3NlVXBsb2FkRGlhbG9nKCk7XHJcbiAgICAgICAgJHJvb3RTY29wZS5zdGFydGVkID0gdHJ1ZTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLnNhdmVJbWFnZSA9IGZ1bmN0aW9uKCRldmVudCkge1xyXG4gICAgICAgIHNhdmVyLnNhdmVJbWFnZSgkc2NvcGUuaW1hZ2VUeXBlLCAkc2NvcGUuaW1hZ2VRdWFsaXR5LCAkc2NvcGUuaW1hZ2VOYW1lLCAkZXZlbnQsIGZhbHNlKTtcclxuICAgICAgICAvLyRzY29wZS5zYXZlVG9TZXJ2ZXIoJHNjb3BlLmltYWdlTmFtZSwgZmFsc2UpO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuc2F2ZUltYWdlQ2xvc2UgPSBmdW5jdGlvbigkZXZlbnQpIHtcclxuICAgICAgICBzYXZlci5zYXZlSW1hZ2UoJHNjb3BlLmltYWdlVHlwZSwgJHNjb3BlLmltYWdlUXVhbGl0eSwgJHNjb3BlLmltYWdlTmFtZSwgJGV2ZW50LCB0cnVlKTtcclxuICAgICAgICAvLyAkdGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAvLyAgICAgdG9wLnRiX3JlbW92ZSgpO1xyXG4gICAgICAgIC8vIH0sIDEwMDApO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuc2F2ZVRvU2VydmVyID0gZnVuY3Rpb24obmFtZSwgY2xvc2Upe1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMuZGVhY3RpdmF0ZUFsbCgpO1xyXG4gICAgICAgIC8vY3JvcHBlci5zdG9wKCk7XHJcblxyXG4gICAgICAgIGNhbnZhcy56b29tKDE1MC9jYW52YXMub3JpZ2luYWwuaGVpZ2h0KTtcclxuICAgICAgICB2YXIgZGF0YV9qcGVnID0gc2F2ZXIuZ2V0RGF0YVVybCgnanBlZycsIDgpO1xyXG5cclxuICAgICAgICBjYW52YXMuem9vbSgxKTsgICAgICAgICAgICBcclxuICAgICAgICB2YXIgZGF0YV9wbmcgPSBzYXZlci5nZXREYXRhVXJsKCdwbmcnLCA4KSxcclxuICAgICAgICAgICAgZGF0YV9qc29uID0gc2F2ZXIuZ2V0RGF0YVVybCgnanNvbicsIDgpO1xyXG4gICAgICAgIGNhbnZhcy5maXRUb1NjcmVlbigpOyAgXHJcbiAgICAgICAgJHJvb3RTY29wZS5pc0xvYWRpbmcoKTtcclxuICAgICAgICBqUXVlcnkuYWpheCh7XHJcbiAgICAgICAgICAgIHVybDogXCIvd3AtYWRtaW4vYWRtaW4tYWpheC5waHBcIixcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgYWN0aW9uOiAnd2luZXNob3BfbGFiZWxfc2F2ZScsXHJcbiAgICAgICAgICAgICAgICBvcmRlcl9pZDogJHJvb3RTY29wZS5vcmRlcl9pZCxcclxuICAgICAgICAgICAgICAgIHByb2R1Y3RfaWQ6ICRyb290U2NvcGUucHJvZHVjdF9pZCxcclxuICAgICAgICAgICAgICAgIGpwZWcgOiBkYXRhX2pwZWcsXHJcbiAgICAgICAgICAgICAgICBwbmcgOiBkYXRhX3BuZyxcclxuICAgICAgICAgICAgICAgIGpzb24gOiBkYXRhX2pzb25cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYXN5bmM6IGZhbHNlLFxyXG4gICAgICAgICAgICB0eXBlOiAnUE9TVCcsXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcyl7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkcm9vdFNjb3BlLmxvYWRpbmcpO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5pc05vdExvYWRpbmcoKTtcclxuICAgICAgICAgICAgICAgIGlmKGNsb3NlKXtcclxuICAgICAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdG9wLnRiX3JlbW92ZSA9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3AudGJfcmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBldmVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNsb3NlRXZlbnROYW1lID0gXCJwZXJzb25hbGl6ZWQtd2luZS1kZXNpZ25lci1tb2RhbC1jbG9zZVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuY3JlYXRlRXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJIVE1MRXZlbnRzXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQuaW5pdEV2ZW50KGNsb3NlRXZlbnROYW1lLCB0cnVlLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnRPYmplY3QoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LmV2ZW50VHlwZSA9IGNsb3NlRXZlbnROYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC5ldmVudE5hbWUgPSBjbG9zZUV2ZW50TmFtZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5jcmVhdGVFdmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChldmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cucGFyZW50LmRvY3VtZW50LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZmlyZUV2ZW50KFwib25cIiArIGV2ZW50LmV2ZW50VHlwZSwgZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnBhcmVudC5kb2N1bWVudC5maXJlRXZlbnQoXCJvblwiICsgZXZlbnQuZXZlbnRUeXBlLCBldmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSwgMTAwMCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgICRzY29wZS5zaG93SW1hZ2VQcmV2aWV3ID0gZnVuY3Rpb24odXJsKSB7XHJcbiAgICAgICAgdmFyIGhpc3RvcnlPYmplY3QgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaGlzdG9yeU9iamVjdCA9IEpTT04ucGFyc2UodXJsKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIC8vXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaGlzdG9yeU9iamVjdCAmJiBoaXN0b3J5T2JqZWN0LnN0YXRlKSB7XHJcbiAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2FuT3BlbkltYWdlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5jbGVhcigpO1xyXG4gICAgICAgICAgICBoaXN0b3J5LmxvYWQoaGlzdG9yeU9iamVjdCk7XHJcbiAgICAgICAgICAgICRzY29wZS5jbG9zZVVwbG9hZERpYWxvZygpO1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLnN0YXJ0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmYWJyaWMudXRpbC5sb2FkSW1hZ2UodXJsLCBmdW5jdGlvbihpbWFnZSkge1xyXG4gICAgICAgICAgICBpZiAoaW1hZ2UpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLmltZy1wcmV2aWV3JykuaHRtbCgnJykuYXBwZW5kKGltYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2FuT3BlbkltYWdlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2FuT3BlbkltYWdlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUub3BlbkltYWdlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHVybCA9ICQoJy5pbWctcHJldmlldyBpbWcnKS5hdHRyKCdzcmMnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgaWYgKCAhIHVybCB8fCAhICRzY29wZS5jYW5PcGVuSW1hZ2UpIHJldHVybjtcclxuXHJcbiAgICAgICAgaWYgKCghY2FudmFzLmZhYnJpYy5fb2JqZWN0cy5sZW5ndGggfHwgISBjYW52YXMubWFpbkltYWdlKSAmJiAhICRyb290U2NvcGUudXNlclByZXNldCkge1xyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLmNsZWFyKCk7XHJcbiAgICAgICAgICAgIGNhbnZhcy5sb2FkTWFpbkltYWdlKHVybCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY2FudmFzLm9wZW5JbWFnZSh1cmwpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJHNjb3BlLmNsb3NlVXBsb2FkRGlhbG9nKCk7XHJcbiAgICAgICAgJHJvb3RTY29wZS5zdGFydGVkID0gdHJ1ZTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLmNsb3NlVXBsb2FkRGlhbG9nID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJHNjb3BlLmNhblVwbG9hZEltYWdlID0gZmFsc2U7XHJcbiAgICAgICAgJHNjb3BlLm9wZW5JbWFnZU1vZGUgPSAnb3Blbic7XHJcbiAgICAgICAgJCgnLmltZy1wcmV2aWV3JykuaHRtbCgpO1xyXG4gICAgICAgICRtZERpYWxvZy5oaWRlKCk7XHJcbiAgICB9O1xyXG59XSk7XHJcblxyXG5cclxuXHJcbiIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdpbWFnZS5kaXJlY3RpdmVzJywgW10pXHJcblxyXG4uZGlyZWN0aXZlKCdlZFRhYnMnLCBbJyRyb290U2NvcGUnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoJHNjb3BlLCBlbCwgYXR0cnMpIHtcclxuICAgICAgICAgICAgdmFyIGJsb2NrQ2xpY2tzID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAkKCcjJythdHRycy5lZFRhYnMpLmFkZENsYXNzKCdvcGVuJyk7XHJcbiAgICAgICAgICAgICQoJ1tkYXRhLWFjdGl2YXRlcz1cIicrYXR0cnMuZWRUYWJzKydcIl0nKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcblxyXG4gICAgICAgICAgICBlbC5maW5kKCcjbmF2aWdhdGlvbi1iYXInKS5vbignY2xpY2snLCAnLm5hdi1pdGVtJywgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChibG9ja0NsaWNrcyA9PT0gdHJ1ZSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYmxvY2tDbGlja3MgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuYWN0aXZlVGFiID0gZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuYWN0aXZhdGVzO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgJHJvb3RTY29wZS4kd2F0Y2goJ2FjdGl2ZVRhYicsIGZ1bmN0aW9uKG5ld1RhYiwgb2xkVGFiKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobmV3VGFiICYmIG5ld1RhYiAhPT0gb2xkVGFiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9sZFRhYk5vZGUgPSBvbGRUYWIgPyBlbC5maW5kKCcjJytvbGRUYWIpIDogZWwuZmluZCgnLnRhYi5vcGVuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlVGFiKG5ld1RhYiwgb2xkVGFiTm9kZSwgZWwuZmluZCgnIycrbmV3VGFiKSwgJCgnW2RhdGEtYWN0aXZhdGVzPVwiJytuZXdUYWIrJ1wiXScpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgY2hhbmdlVGFiID0gZnVuY3Rpb24obmFtZSwgb2xkVGFiLCBuZXdUYWIsIHRhYkJ1dHRvbikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGluQW5pbWF0aW9uICA9ICdmYWRlSW5MZWZ0JyxcclxuICAgICAgICAgICAgICAgICAgICBvdXRBbmltYXRpb24gPSAnZmFkZU91dFJpZ2h0JztcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGFiQnV0dG9uLmhhc0NsYXNzKCdhY3RpdmUnKSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vdGFiIG5hdmlnYXRpb25cclxuICAgICAgICAgICAgICAgICQoJy5uYXYtaXRlbS5hY3RpdmUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICB0YWJCdXR0b24uYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vdGFic1xyXG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KG5ld1RhYi5kYXRhKCdpbmRleCcpKSA8IHBhcnNlSW50KG9sZFRhYi5kYXRhKCdpbmRleCcpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG91dEFuaW1hdGlvbiA9ICdmYWRlT3V0TGVmdCc7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5BbmltYXRpb24gID0gJ2ZhZGVJblJpZ2h0JztcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBvbGRUYWIuYWRkQ2xhc3MoJ2FuaW1hdGVkICcrb3V0QW5pbWF0aW9uKS5vbmUoJHJvb3RTY29wZS5hbmltYXRpb25FbmRFdmVudCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld1RhYlswXS5pZCA9PT0gJHNjb3BlLmFjdGl2ZVRhYikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdvcGVuICcrb3V0QW5pbWF0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIG5ld1RhYi5hZGRDbGFzcygnb3BlbiBhbmltYXRlZCAnK2luQW5pbWF0aW9uKS5vbmUoJHJvb3RTY29wZS5hbmltYXRpb25FbmRFdmVudCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcyhpbkFuaW1hdGlvbik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRlbWl0KCd0YWIuY2hhbmdlZCcsIG5hbWUsIG9sZFRhYlswXS5pZCk7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXdUYWIucmVtb3ZlQ2xhc3MoJ2ZhZGVPdXRSaWdodCBmYWRlT3V0TGVmdCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJsb2NrQ2xpY2tzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9LCAyNzApXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5kaXJlY3RpdmVzJylcclxuXHJcbi5kaXJlY3RpdmUoJ2VkUHJldHR5U2Nyb2xsYmFyJywgZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgY29tcGlsZTogZnVuY3Rpb24oZWwsIGF0dHJzKSB7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBlbC5tQ3VzdG9tU2Nyb2xsYmFyKHtcclxuICAgICAgICAgICAgICAgICAgICB0aGVtZTogYXR0cnMuZWRTY3JvbGxUaGVtZSB8fCAnaW5zZXQnLFxyXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbEluZXJ0aWE6IDMwMCxcclxuICAgICAgICAgICAgICAgICAgICBhdXRvRXhwYW5kU2Nyb2xsYmFyOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBheGlzOiBhdHRycy5lZFNjcm9sbEF4aXMgfHwgJ3gnLFxyXG4gICAgICAgICAgICAgICAgICAgIGFkdmFuY2VkOiB7IGF1dG9FeHBhbmRIb3Jpem9udGFsU2Nyb2xsOnRydWUgfSxcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9LCAxKVxyXG4gICAgICAgIH1cclxuICAgXHR9XHJcbn0pXHJcblxyXG4vL2ZpeCBzb21lIGJ1ZyBiZXR3ZWVuIGN1c3RvbSBzY3JvbGxiYXIgYW5kIG1hdGVyaWFsIHNsaWRlclxyXG4uZGlyZWN0aXZlKCdlZEllU2xpZGVyRml4JywgZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwic2xpZGVyLWZpeC1vdXR0ZXJcIiBzdHlsZT1cImhlaWdodDogMnB4OyBwb3NpdGlvbjogYWJzb2x1dGVcIj48ZGl2IGNsYXNzPVwic2xpZGVyLWZpeC1pbm5lclwiIHN0eWxlPVwiaGVpZ2h0OiAxcHg7IG92ZXJmbG93OiBhdXRvO1wiPklFIEZJWDwvZGl2PjwvZGl2PicsXHJcbiAgICAgICAgY29tcGlsZTogZnVuY3Rpb24oZWwpIHtcclxuICAgICAgICAgICAgZWwuZmluZCgnLnNsaWRlci1maXgtaW5uZXInKS5tQ3VzdG9tU2Nyb2xsYmFyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnaW1hZ2UuZGlyZWN0aXZlcycpXHJcblxyXG4uZGlyZWN0aXZlKCdlZENvbG9yUGlja2VyJywgWyckcm9vdFNjb3BlJywgJyRwYXJzZScsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkcGFyc2UpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbGluazogZnVuY3Rpb24gKCRzY29wZSwgZWwsIGF0dHJzKSB7XHJcbiAgICAgICAgICAgIHZhciBmbGF0ID0gJ2VkRmxhdCcgaW4gYXR0cnM7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuJHdhdGNoKGF0dHJzLm5nRGlzYWJsZWQsIGZ1bmN0aW9uKG5ld1ZhbCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5ld1ZhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsLnNwZWN0cnVtKCdkaXNhYmxlJyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsLnNwZWN0cnVtKCdlbmFibGUnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgcGFyYW1zID0ge1xyXG4gICAgICAgICAgICAgICAgY29sb3I6IGF0dHJzLnN0YXJ0Q29sb3IsXHJcbiAgICAgICAgICAgICAgICBjbGlja291dEZpcmVzQ2hhbmdlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgc2hvd1BhbGV0dGU6ICFmbGF0LFxyXG4gICAgICAgICAgICAgICAgcGFsZXR0ZTogY29sb3JzRm9yUGlja2VyLFxyXG4gICAgICAgICAgICAgICAgcHJlZmVycmVkRm9ybWF0OiAnaGV4JyxcclxuICAgICAgICAgICAgICAgIHNob3dBbHBoYTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHNob3dJbnB1dDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGZsYXQ6IGZsYXQsXHJcbiAgICAgICAgICAgICAgICBzaG93QnV0dG9uczogIWZsYXRcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2V0dGVyID0gZnVuY3Rpb24oc2VsZWN0ZWRDb2xvcikge1xyXG4gICAgICAgICAgICAgICAgJHBhcnNlKGF0dHJzLmVkQ29sb3JQaWNrZXIpKCRzY29wZSwge2NvbG9yOiBzZWxlY3RlZENvbG9yLnRvU3RyaW5nKCl9KTtcclxuICAgICAgICAgICAgICAgIGVsLnZhbChzZWxlY3RlZENvbG9yLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKGF0dHJzLmVkRGlzY3JldGUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgZWwub24oJ2RyYWdzdG9wLnNwZWN0cnVtJywgZnVuY3Rpb24oZSwgc2VsZWN0ZWRDb2xvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldHRlcihzZWxlY3RlZENvbG9yKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHBhcmFtcy5jaGFuZ2UgPSBmdW5jdGlvbihzZWxlY3RlZENvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0dGVyKHNlbGVjdGVkQ29sb3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zLm1vdmUgPSBmdW5jdGlvbihzZWxlY3RlZENvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0dGVyKHNlbGVjdGVkQ29sb3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBlbC5zcGVjdHJ1bShwYXJhbXMpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1dKTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2ltYWdlLmRpcmVjdGl2ZXMnKVxyXG5cclxuLmRpcmVjdGl2ZSgnZWRGaWxlVXBsb2FkZXInLCBbJyRwYXJzZScsICckbWREaWFsb2cnLCAnJG1kQm90dG9tU2hlZXQnLCBmdW5jdGlvbigkcGFyc2UsICRtZERpYWxvZywgJG1kQm90dG9tU2hlZXQpIHtcclxuICAgIHZhciB2YWxpZFR5cGVzID0gWydwbmcnLCAnanBnJywgJ2pwZWcnLCAnZ2lmJ107XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSwgZWwsIGF0dHJzKSB7XHJcbiAgICAgICAgICAgIHZhciBzZXR0ZXIgPSAkcGFyc2UoYXR0cnMuZWRGaWxlVXBsb2FkZXIpKCRzY29wZSk7XHJcblxyXG4gICAgICAgICAgICAkKGVsWzBdKS5vbignY2hhbmdlJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1pbWUgPSBldmVudC50YXJnZXQucmVzdWx0LnNwbGl0KFwiLFwiKVswXS5zcGxpdChcIjpcIilbMV0uc3BsaXQoXCI7XCIpWzBdLnNwbGl0KCcvJylbMV07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWxpZFR5cGVzLmluZGV4T2YobWltZSkgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2V0dGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldHRlcihldmVudC50YXJnZXQucmVzdWx0KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgYXR0cnMuZWRDbG9zZUFmdGVyICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZEJvdHRvbVNoZWV0LmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGUudGFyZ2V0LmZpbGVzWzBdLm5hbWUubWF0Y2goJy5qc29uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICByZWFkZXIucmVhZEFzVGV4dChlLnRhcmdldC5maWxlc1swXSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGUudGFyZ2V0LmZpbGVzWzBdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICBcdH1cclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5kaXJlY3RpdmVzJylcclxuXHJcbi5kaXJlY3RpdmUoJ2VkVG9nZ2xlUGFuZWxWaXNpYmlsaXR5JywgZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgY29tcGlsZTogZnVuY3Rpb24oZWwsIGF0dHJzKSB7XHJcbiAgICAgICAgICAgIGVsLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgZWwuZmluZCgnLmljb24nKS50b2dnbGVDbGFzcygndG9nZ2xlZCcpO1xyXG5cclxuICAgICAgICAgICAgICAgICQoJyMnK2F0dHJzLmVkVG9nZ2xlUGFuZWxWaXNpYmlsaXR5KS5maW5kKCd1bCcpLm1DdXN0b21TY3JvbGxiYXIoJ2Rpc2FibGUnKS5zbGlkZVRvZ2dsZSgxNTAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQodGhpcykubUN1c3RvbVNjcm9sbGJhcigndXBkYXRlJyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICBcdH1cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2ltYWdlLmRpcmVjdGl2ZXMnKVxyXG5cclxuLmRpcmVjdGl2ZSgnZWRUb2dnbGVTaWRlYmFyJywgZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgY29tcGlsZTogZnVuY3Rpb24oZWwsIGF0dHJzKSB7XHJcbiAgICAgICAgICAgIHZhciBzaWRlYmFyID0gJCgnI2xlZnQtc2lkZWJhcicpO1xyXG5cclxuICAgICAgICAgICAgZWwub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBzaWRlYmFyLnRvZ2dsZUNsYXNzKCdvcGVuJyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgXHR9XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS50ZXh0JywgW10pXHJcblxyXG4gICAgLnNlcnZpY2UoJ3RleHQnLCBbJyRyb290U2NvcGUnLCAnY2FudmFzJywgZnVuY3Rpb24gKCRyb290U2NvcGUsIGNhbnZhcykge1xyXG5cclxuICAgICAgICB2YXIgdGV4dCA9IHtcclxuXHJcbiAgICAgICAgICAgIHJlbW92ZVRleHRGcm9tQ2FudmFzOiBmdW5jdGlvbih0ZXh0T2JqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgIGlmICggISB0ZXh0T2JqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICB0ZXh0T2JqZWN0ID0gY2FudmFzLmZhYnJpYy5nZXRBY3RpdmVPYmplY3QoKTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgLy9iYWlsIGlmIHdlIGRvbid0IGhhdmUgYSB0ZXh0IG9iamVjdFxyXG4gICAgICAgICAgICAgICAgICBpZiAoICEgdGV4dE9iamVjdC5zZXRGb250U2l6ZSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5yZW1vdmUodGV4dE9iamVjdCk7XHJcbiAgICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICBnZXRUZXh0T2JqZWN0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhY3RpdmUgPSBjYW52YXMuZmFicmljLmdldEFjdGl2ZU9iamVjdCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChhY3RpdmUgJiYgYWN0aXZlLmZvbnRGYW1pbHkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aXZlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vaWYgdGhlcmUgaXMgbm8gYWN0aXZlIG9iamVjdCBvciBhY3RpdmUgb2JqZWN0XHJcbiAgICAgICAgICAgICAgICAvL2lzIG5vdCB0ZXh0LCByZXR1cm4gZmlyc3QgdGV4dCBvYmplY3QgYXZhaWxhYmxlXHJcbiAgICAgICAgICAgICAgICBpZiAoICEgYWN0aXZlIHx8ICEgYWN0aXZlLmZvbnRGYW1pbHkpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgb2JqZWN0cyA9IGNhbnZhcy5mYWJyaWMuZ2V0T2JqZWN0cygpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9iamVjdHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9iamVjdHNbaV0uZm9udEZhbWlseSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iamVjdHNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICB0b2dnbGVUZXh0RGVjb3JhdGlvbjogZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gdGhpcy5nZXRUZXh0T2JqZWN0KCksXHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IHRleHQudGV4dERlY29yYXRpb24udHJpbSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vZm9udCBzdHlsZVxyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlID09ICdpdGFsaWMnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRleHQuZm9udFN0eWxlLmluZGV4T2YoJ2l0YWxpYycpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dC5zZXRGb250U3R5bGUoJ25vcm1hbCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQuc2V0Rm9udFN0eWxlKCdpdGFsaWMnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy90ZXh0IGRlY29yYXRpb25cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50LmluZGV4T2YodmFsdWUpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQucmVwbGFjZSh2YWx1ZSwgJycpLnRyaW0oKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50ICs9ICcgJyt2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ZXh0LnNldFRleHREZWNvcmF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQuc2V0VGV4dERlY29yYXRpb24oY3VycmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGRlY29yYXRpb25zID0gdGV4dC5mb250U3R5bGUrJyAnK3RleHQudGV4dERlY29yYXRpb24udHJpbSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBkZWNvcmF0aW9ucy5zcGxpdCgnICcpO1xyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgc2V0UHJvcGVydHk6IGZ1bmN0aW9uKHByb3BlcnR5LCB2YWx1ZSwgZW5hYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRleHQgICA9IHRoaXMuZ2V0VGV4dE9iamVjdCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIHNldHRlciA9IHRoaXMubWFrZVNldHRlck5hbWUocHJvcGVydHkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgaWYgKHRleHRbc2V0dGVyXSAmJiBlbmFibGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICB0ZXh0W3NldHRlcl0odmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogVG9nZ2xlIGdpdmVuIHByb3BlcnR5IG9uL29mZiBvbiB0ZXh0IG9iamVjdC5cclxuICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9ICBwcm9wZXJ0eVxyXG4gICAgICAgICAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGVuYWJsZWRcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHRvZ2dsZVByb3BlcnR5OiBmdW5jdGlvbihwcm9wZXJ0eSwgZW5hYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRleHQgICA9IHRoaXMuZ2V0VGV4dE9iamVjdCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIHNldHRlciA9IHRoaXMubWFrZVNldHRlck5hbWUocHJvcGVydHkpO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKHRleHRbc2V0dGVyXSkge1xyXG4gICAgICAgICAgICAgICAgICBpZighZW5hYmxlZCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dFtzZXR0ZXJdKGVuYWJsZWQpO1xyXG4gICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICBpZihwcm9wZXJ0eT09J2JhY2tncm91bmRDb2xvcicpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgdGV4dFtzZXR0ZXJdKGpRdWVyeShcIiN0eHRCZ0NvbG9yXCIpLnZhbCgpKTtcclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZSBpZihwcm9wZXJ0eT09J3N0cm9rZScpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgdGV4dFtzZXR0ZXJdKGpRdWVyeShcIiN0eHRPdXRsaW5lQ29sb3JcIikudmFsKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogQ29tcGlsZSBhIGZhYnJpYyBzZXR0ZXIgZnVuY3Rpb24gbmFtZSBmcm9tIGdpdmUgcHJvcGVydHkuXHJcbiAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAqIEBwYXJhbSBuYW1lIChiYWNrZ3JvdW5kQ29sb3IpXHJcbiAgICAgICAgICAgICAqIEByZXR1cm5zIHN0cmluZyAoc2V0QmFja2dyb3VuZENvbG9yKVxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgbWFrZVNldHRlck5hbWU6IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuICdzZXQnK25hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkrbmFtZS5zbGljZSgxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB0ZXh0O1xyXG5cclxuICAgIH1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnaW1hZ2UudGV4dCcpXHJcblxyXG4uY29udHJvbGxlcignVGV4dENvbnRyb2xsZXInLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJyR0aW1lb3V0JywgJ2NhbnZhcycsICd0ZXh0JywgJ2ZvbnRzJywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCAkdGltZW91dCwgY2FudmFzLCB0ZXh0LCBmb250cykge1xyXG5cdCRzY29wZS50ZXh0ICA9IHRleHQ7XHJcblx0JHNjb3BlLmZvbnRzID0gZm9udHM7XHJcblxyXG5cdCRzY29wZS5hY3RpdmVGb250ID0gJyc7XHJcblx0JHNjb3BlLm9wYWNpdHkgPSAxO1xyXG5cdCRzY29wZS5mb250U2l6ZSA9IDI1O1xyXG5cdCRzY29wZS50eHRDb2xvciA9ICcjMDAwMDAwJztcclxuXHQkc2NvcGUuZW5hYmxlQmFja2dyb3VuZCA9IHRydWU7XHJcblx0JHNjb3BlLnR4dEJnQ29sb3IgPSAncmdiYSgwLDAsMCwwKSc7XHJcblx0JHNjb3BlLmVuYWJsZU91dGxpbmUgPSB0cnVlO1xyXG5cdCRzY29wZS50eHRPdXRsaW5lQ29sb3IgPSAncmdiYSgwLDAsMCwwKSc7XHJcblx0JHNjb3BlLnR4dEFsaWduID0gJ2xlZnQnO1xyXG5cdCRzY29wZS50eHRVbmRlcmxpbmUgPSAnJztcclxuXHQkc2NvcGUudHh0U3R5bGUgPSAnJztcclxuXHQkc2NvcGUudHh0TGluZUhlaWdodCA9ICcnO1xyXG5cdCRzY29wZS50eHRPdXRsaW5lV2lkdGggPSAnJztcclxuXHQkc2NvcGUuZmlsdGVycyA9IHtcclxuXHRcdGNhdGVnb3J5OiAnaGFuZHdyaXRpbmcnLFxyXG5cdFx0ZmFtaWx5OiAnJ1xyXG5cdH07XHJcblxyXG5cdGZvbnRzLmdldEFsbCgkc2NvcGUuZmlsdGVycyk7XHJcbiAgICAkc2NvcGUuaXNQYW5lbEVuYWJsZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgb2JqID0gY2FudmFzLmZhYnJpYy5nZXRBY3RpdmVPYmplY3QoKTtcclxuICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZU9iamVjdCA9IG9iajtcclxuICAgICAgICBpZihvYmogJiYgb2JqLm5hbWUgPT09ICd0ZXh0JykgJHNjb3BlLnNldFR4dFZhbHVlKG9iaik7XHJcbiAgICAgICAgcmV0dXJuIG9iaiAmJiBvYmoubmFtZSA9PT0gJ3RleHQnICYmICRyb290U2NvcGUuYWN0aXZlVGFiID09PSAndGV4dCc7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5zZXRUeHRWYWx1ZSA9IGZ1bmN0aW9uKG9iail7XHJcbiAgICBcdGNvbnNvbGUubG9nKG9iaik7XHJcbiAgICBcdCRzY29wZS5hY3RpdmVGb250ID0gb2JqLmZvbnRGYW1pbHk7XHJcblx0ICAgXHQkc2NvcGUub3BhY2l0eSA9IG9iai5vcGFjaXR5O1xyXG5cdFx0JHNjb3BlLmZvbnRTaXplID0gb2JqLmZvbnRTaXplO1xyXG5cdFx0JHNjb3BlLnR4dENvbG9yID0gb2JqLmZpbGw7XHJcblx0XHRpZihvYmouYmFja2dyb3VuZENvbG9yKSB7XHJcblx0XHRcdCRzY29wZS5lbmFibGVCYWNrZ3JvdW5kID0gdHJ1ZTtcclxuXHRcdFx0JHNjb3BlLnR4dEJnQ29sb3IgPSBvYmouYmFja2dyb3VuZENvbG9yO1xyXG5cdFx0fWVsc2V7XHJcblx0XHRcdCRzY29wZS5lbmFibGVCYWNrZ3JvdW5kID0gZmFsc2U7XHJcblx0XHR9XHJcblx0XHRpZihvYmouc3Ryb2tlKSB7XHJcblx0XHRcdCRzY29wZS5lbmFibGVPdXRsaW5lID0gdHJ1ZTtcclxuXHRcdFx0JHNjb3BlLnR4dE91dGxpbmVDb2xvciA9IG9iai5zdHJva2U7IFx0XHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0JHNjb3BlLmVuYWJsZU91dGxpbmUgPSBmYWxzZTtcclxuXHRcdH1cclxuXHRcdCRzY29wZS50eHRBbGlnbiA9IG9iai50ZXh0QWxpZ247XHJcblx0XHRjb25zb2xlLmxvZygkc2NvcGUudHh0QWxpZ24pO1xyXG5cdFx0JHNjb3BlLnR4dFVuZGVybGluZSA9IG9iai50ZXh0RGVjb3JhdGlvbjtcclxuXHRcdCRzY29wZS50eHRTdHlsZSA9IG9iai5mb250U3R5bGU7XHJcblx0XHQkc2NvcGUudHh0TGluZUhlaWdodCA9IG9iai5saW5lSGlnaHQ7XHJcblx0XHQkc2NvcGUudHh0T3V0bGluZVdpZHRoID0gb2JqLnN0cm9rZVdpZHRoO1xyXG5cdFx0alF1ZXJ5KFwiI3R4dENvbG9yXCIpLnNwZWN0cnVtKFwic2V0XCIsIG9iai5maWxsKTtcclxuXHRcdGlmKCRzY29wZS5lbmFibGVCYWNrZ3JvdW5kKSBqUXVlcnkoXCIjdHh0QmdDb2xvclwiKS5zcGVjdHJ1bShcInNldFwiLCAkc2NvcGUudHh0QmdDb2xvcik7XHJcblx0XHRpZigkc2NvcGUuZW5hYmxlT3V0bGluZSkgalF1ZXJ5KFwiI3R4dE91dGxpbmVDb2xvclwiKS5zcGVjdHJ1bShcInNldFwiLCAkc2NvcGUudHh0T3V0bGluZUNvbG9yKTtcclxuICAgIH07XHJcblxyXG5cdCRzY29wZS5jaGFuZ2VGb250ID0gZnVuY3Rpb24oZm9udCwgZSkge1xyXG4gICAgICAgIHZhciBhY3RpdmUgPSBjYW52YXMuZmFicmljLmdldEFjdGl2ZU9iamVjdCgpO1xyXG5cdFx0JHJvb3RTY29wZS5vcGVuUGFuZWwoJ3RleHQnLCBlKTtcclxuXHJcblx0XHRpZiAoICEgYWN0aXZlIHx8IGFjdGl2ZS5uYW1lICE9PSAndGV4dCcpIHtcclxuXHRcdFx0dmFyIG5ld1RleHQgPSBuZXcgZmFicmljLklUZXh0KCdEb3VibGUgY2xpY2sgbWUgdG8gZWRpdCBteSBjb250ZW50cy4nLCB7XHJcblx0XHRcdFx0Zm9udEZhbWlseTogZm9udCxcclxuXHRcdFx0XHRmb250V2VpZ2h0OiA0MDAsXHJcblx0XHRcdFx0Zm9udFNpemU6ICRzY29wZS5mb250U2l6ZSxcclxuXHRcdFx0XHRmaWxsOiAkc2NvcGUudHh0Q29sb3IsXHJcblx0XHRcdFx0cmVtb3ZlT25DYW5jZWw6IHRydWUsXHJcblx0XHRcdFx0bmFtZTogJ3RleHQnXHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Y2FudmFzLmZhYnJpYy5hZGQobmV3VGV4dCk7XHJcbiAgICAgICAgICAgIG5ld1RleHQuc2V0VG9wKDI1KTtcclxuICAgICAgICAgICAgbmV3VGV4dC5zZXRMZWZ0KDI1KTtcclxuXHRcdFx0Y2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3QobmV3VGV4dCk7XHJcblx0XHRcdGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcblx0XHR9XHJcblxyXG4gICAgICAgIHRleHQuc2V0UHJvcGVydHkoJ2ZvbnRGYW1pbHknLCBmb250LCB0cnVlKTtcclxuXHRcdCRzY29wZS5zZXRUeHRWYWx1ZShhY3RpdmUpO1xyXG5cdFx0JHNjb3BlLmFjdGl2ZUZvbnQgPSBmb250O1xyXG5cdH07XHJcblxyXG5cdCRzY29wZS5jYW5jZWxBZGRpbmdUZXh0VG9DYW52YXMgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciB0ZXh0T2JqZWN0ID0gdGV4dC5nZXRUZXh0T2JqZWN0KCk7XHJcblxyXG5cdFx0aWYgKHRleHRPYmplY3QucmVtb3ZlT25DYW5jZWwpIHtcclxuXHRcdFx0dGV4dC5yZW1vdmVUZXh0RnJvbUNhbnZhcyh0ZXh0T2JqZWN0KTtcclxuXHRcdH1cclxuXHJcblx0XHQkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XHJcblx0fTtcclxuXHJcblx0JHNjb3BlLmZpbmlzaEFkZGluZ1RleHRUb0NhbnZhcyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIHRleHRPYmplY3QgPSB0ZXh0LmdldFRleHRPYmplY3QoKTtcclxuXHJcblx0XHQkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XHJcblx0XHQkcm9vdFNjb3BlLiRlbWl0KCd0ZXh0LmFkZGVkJywgdGV4dE9iamVjdCk7XHJcblx0XHRjYW52YXMuZmFicmljLnNldEFjdGl2ZU9iamVjdChjYW52YXMubWFpbkltYWdlKTtcclxuXHRcdGZvbnRzLmNyZWF0ZUxpbmtUb0ZvbnQodGV4dE9iamVjdC5mb250RmFtaWx5KTtcclxuXHRcdCRyb290U2NvcGUuYWN0aXZlT2JqZWN0ID0gY2FudmFzLm1haW5JbWFnZTtcclxuXHR9O1xyXG5cclxuXHQkcm9vdFNjb3BlLiRvbigndGFiLmNoYW5nZWQnLCBmdW5jdGlvbihlLCBuYW1lKSB7XHJcblx0XHRpZiAobmFtZSA9PSAndGV4dCcpIHtcclxuXHRcdFx0dmFyIHRleHRPYmplY3QgPSAkc2NvcGUudGV4dC5nZXRUZXh0T2JqZWN0KCk7XHJcblxyXG5cdFx0XHQvL2lmIHdlIGNhbiBmaW5kIGFuIGV4aXN0aW5nIHRleHQgb2JqZWN0IHNldCBpdCBhcyBhY3RpdmVcclxuXHRcdFx0aWYgKHRleHRPYmplY3QpIHtcclxuXHRcdFx0XHR0ZXh0T2JqZWN0LnJlbW92ZU9uQ2FuY2VsID0gZmFsc2U7XHJcblx0XHRcdFx0Y2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3QodGV4dE9iamVjdCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9KTtcclxuXHJcbn1dKTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnaW1hZ2UudGV4dCcpXHJcblxyXG4uZGlyZWN0aXZlKCdlZFRleHRBbGlnbkJ1dHRvbnMnLCBbJ3RleHQnLCBmdW5jdGlvbiAodGV4dCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBjb21waWxlOiBmdW5jdGlvbiAoZWwpIHtcclxuICAgICAgICAgICAgZWwub24oJ2NsaWNrJywgJ2knLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYWxpZ24gPSBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5hbGlnbjtcclxuICAgICAgICAgICAgICAgIHRleHQuc2V0UHJvcGVydHkoJ3RleHRBbGlnbicsIGFsaWduLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIGVsLmZpbmQoJ2knKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICAkKGUuY3VycmVudFRhcmdldCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufV0pXHJcbiIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdpbWFnZS50ZXh0JylcclxuXHJcbi5kaXJlY3RpdmUoJ2VkVGV4dERlY29yYXRpb25CdXR0b25zJywgWyd0ZXh0JywgZnVuY3Rpb24gKHRleHQpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgY29tcGlsZTogZnVuY3Rpb24gKGVsKSB7XHJcbiAgICAgICAgICAgIGVsLm9uKCdjbGljaycsICcudG9vbGJhci1idG4nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmRlY29yYXRpb247XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGRlY29yYXRpb25zID0gdGV4dC50b2dnbGVUZXh0RGVjb3JhdGlvbihuYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICBlbC5maW5kKCcudG9vbGJhci1idG4nKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkZWNvcmF0aW9ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsLmZpbmQoJ1tkYXRhLWRlY29yYXRpb249XCInK2RlY29yYXRpb25zW2ldLnRyaW0oKSsnXCJdJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XSlcclxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ2ltYWdlLnRleHQnKVxyXG5cclxuLmRpcmVjdGl2ZSgnZWRGb250c1BhZ2luYXRpb24nLCBbJyRyb290U2NvcGUnLCAnZm9udHMnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCBmb250cykge1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgICAgICBsaW5rOiBmdW5jdGlvbigkc2NvcGUsIGVsKSB7XHJcblxyXG4gICAgICAgICAgICAvL2luaXRpYXRlIHBhZ2luYXRpb24gcGx1Z2luXHJcbiAgICAgICAgICAgIGVsLnBhZ2luYXRpb24oe1xyXG4gICAgICAgICAgICAgICAgaXRlbXM6IDAsXHJcbiAgICAgICAgICAgICAgICBpdGVtc09uUGFnZTogZm9udHMucGFnaW5hdG9yLnBlclBhZ2UsXHJcbiAgICAgICAgICAgICAgICBvblBhZ2VDbGljazogZnVuY3Rpb24obnVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9udHMucGFnaW5hdG9yLnNlbGVjdFBhZ2UobnVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vcmVkcmF3IHBhZ2luYXRpb24gYmFyIG9uIHRvdGFsIGl0ZW1zIGNoYW5nZVxyXG4gICAgICAgICAgICAkc2NvcGUuJHdhdGNoKCdmb250cy5wYWdpbmF0b3IudG90YWxJdGVtcycsIGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHsgZWwucGFnaW5hdGlvbigndXBkYXRlSXRlbXMnLCB2YWx1ZSkgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1dKVxyXG5cclxuLmZhY3RvcnkoJ2ZvbnRzJywgWyckcm9vdFNjb3BlJywgJyRodHRwJywgJyR0aW1lb3V0JywgJyRmaWx0ZXInLCAnbG9jYWxTdG9yYWdlJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJGh0dHAsICR0aW1lb3V0LCAkZmlsdGVyLCBsb2NhbFN0b3JhZ2UpIHtcclxuXHJcbiAgICB2YXIgZm9udHMgPSB7XHJcblxyXG4gICAgICAgIGxvYWRpbmc6IGZhbHNlLFxyXG5cclxuICAgICAgICBwYWdpbmF0b3I6IHtcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBBbGwgYXZhaWxhYmxlIGZvbnRzLlxyXG4gICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgKiBAdHlwZSBhcnJheVxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgc291cmNlSXRlbXM6IFtcIlNsYWJvIDI3cHhcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiUm9ib3RvXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlNhaXJhXCIgLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJPcGVuIFNhbnNcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiVGltZXMgTmV3IFJvbWFuXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlBsYXlmYWlyIERpc3BsYXlcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTW9ub3R5cGUgQ29yc2l2YVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJQVCBTZXJpZlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJJTSBGZWxsIERvdWJsZSBQaWNhIFNDXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkNvcm1vcmFudCBVbmljYXNlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkNoZXd5XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkxpbWVsaWdodFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJQb2lyZXQgT25lXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlZvbHRhaXJlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIk9zd2FsZFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJTbmlnbGV0XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkNydXNoZWRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXCJCb29rbWFuIE9sZCBTdHlsZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJBcmlhbFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJIZWx2ZXRpY2FcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTG9ic3RlclwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9cIkRpc25leVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJTdGFyIFRyZWtcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXCJHYXJhbW9uZFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJQVCBTYW5zXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkluZGllIEZsb3dlclwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJGamFsbGEgT25lXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlBhY2lmaWNvXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkFtYXRpYyBTQ1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJHcmVhdCBWaWJlc1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJQZXJtYW5lbnQgTWFya2VyXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkJhZCBTY3JpcHRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTW9ub3RvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJDb21pbmcgU29vblwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJKdXN0IEFub3RoZXIgSGFuZFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJEZWxpdXMgU3dhc2ggQ2Fwc1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJSb2NoZXN0ZXJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiRWxzaWUgU3dhc2ggQ2Fwc1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJJbmNvbnNvbGF0YVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJUcm9jY2hpXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkNyZWVwc3RlclwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJCdW5nZWVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQmxhY2sgT3BzIE9uZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBdLFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIEFsbCBhdmFpbGFibGUgZm9udHMgd2l0aCBmaWx0cnMgYXBwbGllZC5cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIGZpbHRlcmVkSXRlbXM6IFtdLFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIEZvbnRzIGN1cnJlbnRseSBiZWluZyBzaG93bi5cclxuICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICogQHR5cGUgYXJyYXlcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIGN1cnJlbnRJdGVtczogW10sXHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogRm9udHMgdG8gc2hvdyBwZXIgcGFnZS5cclxuICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICogQHR5cGUgaW50XHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICBwZXJQYWdlOiAxMCxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBUb3RhbCBudW1iZXIgb2YgZm9udHMuXHJcbiAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAqIEB0eXBlIGludFxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgdG90YWxJdGVtczogMCxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBTbGljZSBpdGVtcyBmb3IgdGhlIGdpdmVuIHBhZ2UuXHJcbiAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAqIEBwYXJhbSAge2ludH0gcGFnZVxyXG4gICAgICAgICAgICAgKiBAcmV0dXJuIHZvaWRcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHNlbGVjdFBhZ2U6IGZ1bmN0aW9uKHBhZ2UpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEl0ZW1zID0gdGhpcy5maWx0ZXJlZEl0ZW1zLnNsaWNlKFxyXG4gICAgICAgICAgICAgICAgICAgIChwYWdlLTEpKnRoaXMucGVyUGFnZSwgKHBhZ2UtMSkqdGhpcy5wZXJQYWdlK3RoaXMucGVyUGFnZVxyXG4gICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvL2ZvbnRzLmxvYWQoKTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIGZpbHRlcjogZnVuY3Rpb24oZmlsdGVycykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydCgkZmlsdGVyKCdmaWx0ZXInKShmb250cy5wYWdpbmF0b3Iuc291cmNlSXRlbXMsIGZpbHRlcnMpKTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBTdGFydCB0aGUgcGFnaW5hdG9yIHdpdGggZ2l2ZW4gaXRlbXMuXHJcbiAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAqIEBwYXJhbSAge2FycmF5fSBpdGVtc1xyXG4gICAgICAgICAgICAgKiBAcmV0dXJuIHZvaWRcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHN0YXJ0OiBmdW5jdGlvbihpdGVtcykge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coaXRlbXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wZXJQYWdlID0gaXRlbXMubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJlZEl0ZW1zICA9IGl0ZW1zO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b3RhbEl0ZW1zICAgPSBpdGVtcy5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRJdGVtcyA9IGl0ZW1zLnNsaWNlKDAsIHRoaXMucGVyUGFnZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgZm9udHMubG9hZChpdGVtcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBGZXRjaCBhbGwgYXZhaWxhYmxlIGZvbnRzIGZyb20gR29vZ2xlRm9udHMgQVBJLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJldHVybiB2b2lkXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0QWxsOiBmdW5jdGlvbihmaWx0ZXJzKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxmICAgPSB0aGlzLFxyXG4gICAgICAgICAgICAgICAgY2FjaGVkID0gbG9jYWxTdG9yYWdlLmdldCgnZ29vZ2xlRm9udHMnKSxcclxuICAgICAgICAgICAgICAgIGtleSAgICA9ICRyb290U2NvcGUua2V5c1snZ29vZ2xlX2ZvbnRzJ107XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGZvbnRzLnBhZ2luYXRvci5jdXJyZW50SXRlbXMpO1xyXG4gICAgICAgICAgICAvLyBpZiAoY2FjaGVkKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBzZWxmLnBhZ2luYXRvci5zb3VyY2VJdGVtcyA9IGNhY2hlZDtcclxuICAgICAgICAgICAgLy8gICAgIHJldHVybiBmaWx0ZXJzID8gc2VsZi5wYWdpbmF0b3IuZmlsdGVyKGZpbHRlcnMpIDogc2VsZi5wYWdpbmF0b3Iuc3RhcnQoY2FjaGVkKTtcclxuICAgICAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICAgICAgLy8gJGh0dHAuZ2V0KCdodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS93ZWJmb250cy92MS93ZWJmb250cz9zb3J0PXBvcHVsYXJpdHkma2V5PScra2V5KVxyXG4gICAgICAgICAgICAvLyAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXQoJ2dvb2dsZUZvbnRzJywgZGF0YS5pdGVtcyk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgc2VsZi5wYWdpbmF0b3Iuc291cmNlSXRlbXMgPSBkYXRhLml0ZW1zO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIGZpbHRlcnMgPyBzZWxmLnBhZ2luYXRvci5maWx0ZXIoZmlsdGVycykgOiBzZWxmLnBhZ2luYXRvci5zdGFydChkYXRhLml0ZW1zKTtcclxuICAgICAgICAgICAgLy8gICAgIH0pO1xyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKHNlbGYucGFnaW5hdG9yLnNvdXJjZUl0ZW1zKTtcclxuICAgICAgICAgICAgLy9sb2NhbFN0b3JhZ2Uuc2V0KCdnb29nbGVGb250cycsIHNlbGYucGFnaW5hdG9yLnNvdXJjZUl0ZW1zKTtcclxuICAgICAgICAgICAgLy9maWx0ZXJzID8gc2VsZi5wYWdpbmF0b3IuZmlsdGVyKGZpbHRlcnMpIDogc2VsZi5wYWdpbmF0b3Iuc3RhcnQoc2VsZi5wYWdpbmF0b3Iuc291cmNlSXRlbXMpO1xyXG4gICAgICAgICAgICBzZWxmLnBhZ2luYXRvci5zdGFydChzZWxmLnBhZ2luYXRvci5zb3VyY2VJdGVtcyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogTG9hZCBnaXZlbiBnb29nbGUgZm9udHMgaW50byB0aGUgRE9NLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtICB7bWl4ZWR9IG5hbWVzXHJcbiAgICAgICAgICogQHJldHVybiB2b2lkXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbG9hZDogZnVuY3Rpb24obmFtZXMpIHtcclxuICAgICAgICAgICAgdmFyIGhlYWQgPSAkKCdoZWFkJyk7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUubG9hZGluZyA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAvL21ha2UgYW4gYXJyYXkgb2YgZm9udCBuYW1lcyBmcm9tIGN1cnJlbnQgZm9udHNcclxuICAgICAgICAgICAgLy9pbiB0aGUgcGFnaW5hdG9yIGlmIG5vbmUgcGFzc2VkXHJcbiAgICAgICAgICAgIGlmICggISBuYW1lcykge1xyXG4gICAgICAgICAgICAgICAgbmFtZXMgPSAkLm1hcChmb250cy5wYWdpbmF0b3IuY3VycmVudEl0ZW1zLCBmdW5jdGlvbihmb250KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZm9udCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9yZXR1cm4gZm9udC5mYW1pbHk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZvbnQ7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvL25vcm1hbGl6ZSBuYW1lcyB0byBhcnJheSBpZiBzdHJpbmcgcGFzc2VkXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoICEgYW5ndWxhci5pc0FycmF5KG5hbWVzKSkge1xyXG4gICAgICAgICAgICAgICAgbmFtZXMgPSBbbmFtZXNdO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvL3JlbW92ZSBwcmV2aW91cyBwYWdlIGZvbnRzXHJcbiAgICAgICAgICAgIC8vJChoZWFkKS5maW5kKCcjZHluYW1pYy1mb250cycpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICBuYW1lcyA9IG5hbWVzLmZpbHRlcih2YWwgPT4gdmFsICE9PSBcIlRpbWVzIE5ldyBSb21hblwiKTtcclxuICAgICAgICAgICAgbmFtZXMgPSBuYW1lcy5maWx0ZXIodmFsID0+IHZhbCAhPT0gXCJIZWx2ZXRpY2FcIik7XHJcbiAgICAgICAgICAgIG5hbWVzID0gbmFtZXMuZmlsdGVyKHZhbCA9PiB2YWwgIT09IFwiTW9ub3R5cGUgQ29yc2l2YVwiKTtcclxuICAgICAgICAgICAgdmFyIHBlclBhZ2UgPSAxNztcclxuICAgICAgICAgICAgLy9sb2FkIHRoZSBnaXZlbiBmb250c1xyXG4gICAgICAgICAgICBmb3IoIHZhciBpPTA7IGkqcGVyUGFnZSA8IG5hbWVzLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgICAgIHZhciBzdWJmb250cyA9IG5hbWVzLnNsaWNlKGkqcGVyUGFnZSwgKGkrMSkqcGVyUGFnZSk7XHJcbiAgICAgICAgICAgICAgICBoZWFkLmFwcGVuZChcclxuICAgICAgICAgICAgICAgICAgICAnPGxpbmsgcmVsPVwic3R5bGVzaGVldFwiIGlkPVwiZHluYW1pYy1mb250cycraSsnXCIgaHJlZj1cImh0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vY3NzP2ZhbWlseT0nK1xyXG4gICAgICAgICAgICAgICAgICAgIHN1YmZvbnRzLmpvaW4oJ3wnKS5yZXBsYWNlKC8gL2csICcrJykrJ1wiPidcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBjcmVhdGVMaW5rVG9Gb250OiBmdW5jdGlvbihmb250KSB7XHJcbiAgICAgICAgICAgIHZhciBuYW1lID0gZm9udC5yZXBsYWNlKC8gL2csICcrJyksXHJcbiAgICAgICAgICAgICAgICBsaW5rID0gJCgnIycrbmFtZSk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKGxpbmtbMF0pIHtcclxuICAgICAgICAgICAgICAgIGxpbmsuYXR0cignaHJlZicsICdodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2Nzcz9mYW1pbHk9JytuYW1lKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICQoJ2hlYWQnKS5hcHBlbmQoJzxsaW5rIHJlbD1cInN0eWxlc2hlZXRcIiBpZD1cIicrbmFtZSsnXCIgaHJlZj1cImh0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vY3NzP2ZhbWlseT0nK25hbWUrJ1wiPicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gZm9udHM7XHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnaW1hZ2UuZHJhd2luZycsIFtdKVxyXG5cclxuLnNlcnZpY2UoJ2RyYXdpbmcnLCBbJyRyb290U2NvcGUnLCAnY2FudmFzJywgZnVuY3Rpb24gKCRyb290U2NvcGUsIGNhbnZhcykge1xyXG5cclxuICAgIHZhciBkcmF3aW5nID0ge1xyXG5cclxuICAgICAgICBhdmFpbGFibGVCcnVzaGVzOiBbJ3BlbmNpbCcsICd2TGluZScsICdkaWFtb25kJywgJ2hMaW5lJywgJ2NpcmNsZScsICdzcXVhcmUnLCAnc3ByYXknXSxcclxuXHJcbiAgICAgICAgZGVmYXVsdEJydXNoTmFtZTogJ3BlbmNpbCcsXHJcblxyXG4gICAgICAgIGFjdGl2ZUJydXNoTmFtZTogZmFsc2UsXHJcblxyXG4gICAgICAgIGlzRW5hYmxlZDogZmFsc2UsXHJcblxyXG4gICAgICAgIHBhcmFtczoge1xyXG4gICAgICAgICAgICBzaGFkb3dDb2xvcjogJyMxRTg5RTYnLFxyXG4gICAgICAgICAgICBicnVzaFdpZHRoOiA5LFxyXG4gICAgICAgICAgICBicnVzaENvbG9yOiAnIzAwMCcsXHJcbiAgICAgICAgICAgIHNoYWRvd0JsdXI6IDMwLFxyXG4gICAgICAgICAgICBzaGFkb3dPZmZzZXRYOiAxMCxcclxuICAgICAgICAgICAgc2hhZG93T2Zmc2V0WTogMTAsXHJcbiAgICAgICAgICAgIGVuYWJsZVNoYWRvdzogZmFsc2VcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBlbmFibGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLmlzRHJhd2luZ01vZGUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZUJydXNoKHRoaXMuZGVmYXVsdEJydXNoTmFtZSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoICEgdGhpcy5zaGFkb3cpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2hhZG93ID0gbmV3IGZhYnJpYy5TaGFkb3coe1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiB0aGlzLnBhcmFtcy5zaGFkb3dDb2xvcixcclxuICAgICAgICAgICAgICAgICAgICBibHVyOiB0aGlzLnBhcmFtcy5zaGFkb3dCbHVyLFxyXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldFg6IHRoaXMucGFyYW1zLnNoYWRvd09mZnNldFgsXHJcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0WTogdGhpcy5wYXJhbXMuc2hhZG93T2Zmc2V0WVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuaXNFbmFibGVkID0gdHJ1ZTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBkaXNhYmxlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5pc0RyYXdpbmdNb2RlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuaXNFbmFibGVkID0gZmFsc2U7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgc2V0U2hhZG93UHJvcGVydHk6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGlmIChjYW52YXMuZmFicmljLmZyZWVEcmF3aW5nQnJ1c2guc2hhZG93W25hbWVdKSB7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmZyZWVEcmF3aW5nQnJ1c2guc2hhZG93W25hbWVdID0gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBzZXRQcm9wZXJ0eTogZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKGNhbnZhcy5mYWJyaWMuZnJlZURyYXdpbmdCcnVzaFtuYW1lXSkge1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mcmVlRHJhd2luZ0JydXNoW25hbWVdID0gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICB0b2dnbGVTaGFkb3c6IGZ1bmN0aW9uKG9uKSB7XHJcbiAgICAgICAgICAgIGlmIChvbikge1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mcmVlRHJhd2luZ0JydXNoLnNoYWRvdyA9IHRoaXMuc2hhZG93O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zaGFkb3cgPSBjYW52YXMuZmFicmljLmZyZWVEcmF3aW5nQnJ1c2guc2hhZG93O1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mcmVlRHJhd2luZ0JydXNoLnNoYWRvdyA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgY2hhbmdlQnJ1c2g6IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICAgICAgdGhpcy5hY3RpdmVCcnVzaE5hbWUgPSBuYW1lO1xyXG4gICAgICAgICAgICBuYW1lID0gdGhpcy5tYWtlQnJ1c2hOYW1lKG5hbWUpO1xyXG5cclxuICAgICAgICAgICAgLy9jaGVjayBpZiBpdCdzIGEgYmFzZSBmYWJyaWMgYnJ1c2hcclxuICAgICAgICAgICAgaWYgKGZhYnJpY1tuYW1lXSkge1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mcmVlRHJhd2luZ0JydXNoID0gbmV3IGZhYnJpY1tuYW1lXShjYW52YXMuZmFicmljKTtcclxuXHJcbiAgICAgICAgICAgIC8vY2hlY2sgaWYgaXQncyBhIGN1c3RvbSBicnVzaCB0aGF0IHdlIGhhdmUgYWxyZWFkeSBtYWRlXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpc1tuYW1lXSkge1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mcmVlRHJhd2luZ0JydXNoID0gdGhpc1tuYW1lXTtcclxuXHJcbiAgICAgICAgICAgIC8vY2hlY2sgaWYgd2UgY2FuIG1ha2UgYSByZXF1ZXN0IGJydXNoXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpc1snbWFrZScrbmFtZV0pIHtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuZnJlZURyYXdpbmdCcnVzaCA9IHRoaXNbJ21ha2UnK25hbWVdKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuZnJlZURyYXdpbmdCcnVzaC53aWR0aCAgPSB0aGlzLnBhcmFtcy5icnVzaFdpZHRoO1xyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLmZyZWVEcmF3aW5nQnJ1c2guY29sb3IgID0gdGhpcy5wYXJhbXMuYnJ1c2hDb2xvcjtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmFtcy5lbmFibGVTaGFkb3cpIHtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuZnJlZURyYXdpbmdCcnVzaC5zaGFkb3cgPSB0aGlzLnNoYWRvdztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIENvbXBpbGUgYSBmYWJyaWMgYnJ1c2ggZnVuY3Rpb24gbmFtZSBmcm9tIGdpdmVuIG5hbWUuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gbmFtZSAocGVuY2lsKVxyXG4gICAgICAgICAqIEByZXR1cm5zIHN0cmluZyAoUGVuY2lsQnJ1c2gpXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbWFrZUJydXNoTmFtZTogZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKStuYW1lLnNsaWNlKDEpICsgJ0JydXNoJztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBtYWtlVkxpbmVCcnVzaDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuVkxpbmVCcnVzaCA9IG5ldyBmYWJyaWMuUGF0dGVybkJydXNoKGNhbnZhcy5mYWJyaWMpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5WTGluZUJydXNoLmdldFBhdHRlcm5TcmMgPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgcGF0dGVybkNhbnZhcyA9IGZhYnJpYy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcclxuICAgICAgICAgICAgICAgIHBhdHRlcm5DYW52YXMud2lkdGggPSBwYXR0ZXJuQ2FudmFzLmhlaWdodCA9IDEwO1xyXG4gICAgICAgICAgICAgICAgdmFyIGN0eCA9IHBhdHRlcm5DYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSB0aGlzLmNvbG9yO1xyXG4gICAgICAgICAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDU7XHJcbiAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgICAgICBjdHgubW92ZVRvKDAsIDUpO1xyXG4gICAgICAgICAgICAgICAgY3R4LmxpbmVUbygxMCwgNSk7XHJcbiAgICAgICAgICAgICAgICBjdHguY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhdHRlcm5DYW52YXM7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5WTGluZUJydXNoO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIG1ha2VEaWFtb25kQnJ1c2g6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy5EaWFtb25kQnJ1c2ggPSBuZXcgZmFicmljLlBhdHRlcm5CcnVzaChjYW52YXMuZmFicmljKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuRGlhbW9uZEJydXNoLmdldFBhdHRlcm5TcmMgPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgc3F1YXJlV2lkdGggPSAxMCwgc3F1YXJlRGlzdGFuY2UgPSA1O1xyXG4gICAgICAgICAgICAgICAgdmFyIHBhdHRlcm5DYW52YXMgPSBmYWJyaWMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVjdCA9IG5ldyBmYWJyaWMuUmVjdCh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHNxdWFyZVdpZHRoLFxyXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogc3F1YXJlV2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgYW5nbGU6IDQ1LFxyXG4gICAgICAgICAgICAgICAgICAgIGZpbGw6IHRoaXMuY29sb3JcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBjYW52YXNXaWR0aCA9IHJlY3QuZ2V0Qm91bmRpbmdSZWN0V2lkdGgoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBwYXR0ZXJuQ2FudmFzLndpZHRoID0gcGF0dGVybkNhbnZhcy5oZWlnaHQgPSBjYW52YXNXaWR0aCArIHNxdWFyZURpc3RhbmNlO1xyXG4gICAgICAgICAgICAgICAgcmVjdC5zZXQoeyBsZWZ0OiBjYW52YXNXaWR0aCAvIDIsIHRvcDogY2FudmFzV2lkdGggLyAyIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBjdHggPSBwYXR0ZXJuQ2FudmFzLmdldENvbnRleHQoJzJkJyk7XHJcbiAgICAgICAgICAgICAgICByZWN0LnJlbmRlcihjdHgpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBwYXR0ZXJuQ2FudmFzO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuRGlhbW9uZEJydXNoO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIG1ha2VITGluZUJydXNoOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuSExpbmVCcnVzaCA9IG5ldyBmYWJyaWMuUGF0dGVybkJydXNoKGNhbnZhcy5mYWJyaWMpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5ITGluZUJydXNoLmdldFBhdHRlcm5TcmMgPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgcGF0dGVybkNhbnZhcyA9IGZhYnJpYy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcclxuICAgICAgICAgICAgICAgIHBhdHRlcm5DYW52YXMud2lkdGggPSBwYXR0ZXJuQ2FudmFzLmhlaWdodCA9IDEwO1xyXG4gICAgICAgICAgICAgICAgdmFyIGN0eCA9IHBhdHRlcm5DYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSB0aGlzLmNvbG9yO1xyXG4gICAgICAgICAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDU7XHJcbiAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgICAgICBjdHgubW92ZVRvKDUsIDApO1xyXG4gICAgICAgICAgICAgICAgY3R4LmxpbmVUbyg1LCAxMCk7XHJcbiAgICAgICAgICAgICAgICBjdHguY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhdHRlcm5DYW52YXM7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ITGluZUJydXNoO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIG1ha2VTcXVhcmVCcnVzaDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLlNxdWFyZUJydXNoID0gbmV3IGZhYnJpYy5QYXR0ZXJuQnJ1c2goY2FudmFzLmZhYnJpYyk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLlNxdWFyZUJydXNoLmdldFBhdHRlcm5TcmMgPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgc3F1YXJlV2lkdGggPSAxMCwgc3F1YXJlRGlzdGFuY2UgPSAyO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBwYXR0ZXJuQ2FudmFzID0gZmFicmljLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xyXG4gICAgICAgICAgICAgICAgcGF0dGVybkNhbnZhcy53aWR0aCA9IHBhdHRlcm5DYW52YXMuaGVpZ2h0ID0gc3F1YXJlV2lkdGggKyBzcXVhcmVEaXN0YW5jZTtcclxuICAgICAgICAgICAgICAgIHZhciBjdHggPSBwYXR0ZXJuQ2FudmFzLmdldENvbnRleHQoJzJkJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMuY29sb3I7XHJcbiAgICAgICAgICAgICAgICBjdHguZmlsbFJlY3QoMCwgMCwgc3F1YXJlV2lkdGgsIHNxdWFyZVdpZHRoKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGF0dGVybkNhbnZhcztcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLlNxdWFyZUJydXNoO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBkcmF3aW5nO1xyXG5cclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5kcmF3aW5nJylcclxuXHJcbi5jb250cm9sbGVyKCdEcmF3aW5nQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnY2FudmFzJywgJ2RyYXdpbmcnLCAnaGlzdG9yeScsIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgY2FudmFzLCBkcmF3aW5nLCBoaXN0b3J5KSB7XHJcblx0JHNjb3BlLmRyYXdpbmcgPSBkcmF3aW5nO1xyXG4gICAgd2luZG93LmZiID0gY2FudmFzLmZhYnJpYztcclxuXHJcblx0JHNjb3BlLmNoYW5nZUJydXNoID0gZnVuY3Rpb24oYnJ1c2gsICRldmVudCkge1xyXG5cdFx0JHNjb3BlLm9wZW5QYW5lbCgnZHJhd2luZycsICRldmVudCk7XHJcblxyXG5cdFx0aWYgKCAhIGRyYXdpbmcuaXNFbmFibGVkKSB7XHJcblx0XHRcdGRyYXdpbmcuZW5hYmxlKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0ZHJhd2luZy5jaGFuZ2VCcnVzaChicnVzaCk7XHJcblx0fTtcclxuXHJcblx0JHNjb3BlLmZpbmlzaEFkZGluZ0RyYXdpbmdzVG9DYW52YXMgPSBmdW5jdGlvbigpIHtcclxuXHRcdCRyb290U2NvcGUuYWN0aXZlUGFuZWwgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgaWYgKGNhbnZhcy5tYWluSW1hZ2UpIHtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3QoY2FudmFzLm1haW5JbWFnZSk7XHJcbiAgICAgICAgfVxyXG5cclxuXHRcdGNhbnZhcy5mYWJyaWMuZm9yRWFjaE9iamVjdChmdW5jdGlvbihvYmopIHtcclxuXHRcdFx0aWYgKG9iai5uYW1lID09PSAnZnJlZURyYXdpbmcnKSB7XHJcblx0XHRcdFx0b2JqLnJlbW92ZU9uQ2FuY2VsID0gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cclxuICAgICAgICBkcmF3aW5nLmRpc2FibGUoKTtcclxuXHJcblx0XHQkcm9vdFNjb3BlLmFjdGl2ZU9iamVjdCA9IGNhbnZhcy5tYWluSW1hZ2U7XHJcblx0XHRoaXN0b3J5LmFkZCgnYWRkZWQgZHJhd2luZycsICdicnVzaCcpO1xyXG5cdH07XHJcblxyXG5cdCRzY29wZS5jYW5jZWxBZGRpbmdEcmF3aW5nc1RvQ2FudmFzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2FudmFzLmZhYnJpYy5mb3JFYWNoT2JqZWN0KGZ1bmN0aW9uIChvYmopIHtcclxuXHRcdFx0aWYgKG9iai5uYW1lID09PSAnZnJlZURyYXdpbmcnICYmIG9iai5yZW1vdmVPbkNhbmNlbCkge1xyXG5cdFx0XHRcdGNhbnZhcy5mYWJyaWMucmVtb3ZlKG9iaik7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cclxuXHRcdGRyYXdpbmcuZGlzYWJsZSgpO1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcblx0XHQkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XHJcblx0fTtcclxuXHJcblx0JHJvb3RTY29wZS4kb24oJ3RhYi5jaGFuZ2VkJywgZnVuY3Rpb24oZSwgbmFtZSkge1xyXG5cdFx0aWYgKG5hbWUgIT09ICdkcmF3aW5nJykge1xyXG5cdFx0XHRkcmF3aW5nLmRpc2FibGUoKTtcclxuXHRcdFx0JHNjb3BlLmNhbmNlbEFkZGluZ0RyYXdpbmdzVG9DYW52YXMoKTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHJcblx0Y2FudmFzLmZhYnJpYy5vbigncGF0aDpjcmVhdGVkJywgZnVuY3Rpb24oZSkge1xyXG5cdFx0aWYgKGRyYXdpbmcuaXNFbmFibGVkKSB7XHJcblx0XHRcdGUucGF0aC5zZXRPcHRpb25zKGNhbnZhcy5pbWFnZVN0YXRpYyk7XHJcblx0XHRcdGUucGF0aC5uYW1lID0gJ2ZyZWVEcmF3aW5nJztcclxuXHRcdFx0ZS5wYXRoLnJlbW92ZU9uQ2FuY2VsID0gdHJ1ZTtcclxuXHRcdH1cclxuXHR9KTtcclxufV0pOyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdpbWFnZS5kaXJlY3RpdmVzJylcclxuXHJcbi5kaXJlY3RpdmUoJ2VkUmVuZGVyQnJ1c2hlcycsIFsnJHJvb3RTY29wZScsICckY29tcGlsZScsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkY29tcGlsZSkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoJHNjb3BlLCBlbCkge1xyXG4gICAgICAgICAgICB2YXIgdGVtcGxhdGUgPSAnPGRpdiBuZy1yZXBlYXQ9XCJicnVzaCBpbiBkcmF3aW5nLmF2YWlsYWJsZUJydXNoZXNcIiBuZy1jbGFzcz1cInsgYWN0aXZlOiBkcmF3aW5nLmFjdGl2ZUJydXNoTmFtZSA9PSBicnVzaCB9XCIgY2xhc3M9XCJicnVzaCBhbmltYXRlZC1pbi1zZXF1ZW5jZVwiIG5nLWNsaWNrPVwiY2hhbmdlQnJ1c2goYnJ1c2gpXCI+JytcclxuICAgICAgICAgICAgICAgICc8aW1nIGNsYXNzPVwiaW1nLXJlc3BvbnNpdmVcIiBuZy1zcmM9XCJhc3NldHMvaW1hZ2VzL2JydXNoZXMve3ticnVzaH19LnBuZ1wiLz4nK1xyXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJicnVzaC1uYW1lXCI+e3sgYnJ1c2ggfX08L2Rpdj4nK1xyXG4gICAgICAgICAgICAnPC9kaXY+JztcclxuXHJcbiAgICAgICAgICAgIHZhciB1bmJpbmQgPSAkcm9vdFNjb3BlLiRvbigndGFiLmNoYW5nZWQnLCBmdW5jdGlvbihlLCBuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobmFtZSA9PT0gJ2RyYXdpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWwuYXBwZW5kKCRjb21waWxlKHRlbXBsYXRlKSgkc2NvcGUpKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB1bmJpbmQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufV0pO1xyXG4iLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnSW1hZ2VFZGl0b3InKVxyXG5cclxuLmZhY3RvcnkoJ2hpc3RvcnknLCBbJyRyb290U2NvcGUnLCAnY2FudmFzJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgY2FudmFzKSB7XHJcblxyXG5cdHZhciBoaXN0b3J5ID0ge1xyXG5cclxuXHRcdGFsbDogW10sXHJcblxyXG4gICAgICAgIC8vdXNlZCBmb3IgYmFja2luZyB1cCBjYW52YXMgYW5kIG90aGVyIHNlcmlhbGl6YXRpb25zXHJcbiAgICAgICAgLy90aGF0IGFyZSBub3QgdmlzaWJsZSB0byB0aGUgdXNlclxyXG4gICAgICAgIGlnbm9yZWQ6IFtdLCBcclxuXHJcblx0XHRhZGQ6IGZ1bmN0aW9uKG5hbWUsIGljb24sIGlnbm9yZSkge1xyXG4gICAgICAgICAgICB2YXIgcHJvcCA9IGlnbm9yZSA/ICdpZ25vcmVkJyA6ICdhbGwnO1xyXG5cclxuICAgICAgICAgICAgLy9tYWtlIHN1cmUgZG9uJ3QgaGF2ZSBkdXBsaWNhdGVzIGluIGlnbm9yZWQgYXJyYXlcclxuICAgICAgICAgICAgaWYgKHByb3AgPT09ICdpZ25vcmVkJykgeyBcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5pZ25vcmVkLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaWdub3JlZFtpXS5uYW1lID09PSBuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaWdub3JlZC5zcGxpY2UoaSwgMSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcblx0XHRcdHRoaXNbcHJvcF0udW5zaGlmdCh7XHJcblx0XHRcdFx0bmFtZTogbmFtZSxcclxuXHRcdFx0XHRzdGF0ZTogY2FudmFzLmZhYnJpYy50b0pTT04oWydzZWxlY3RhYmxlJywgJ25hbWUnXSksXHJcblx0XHRcdFx0aW5kZXg6IHRoaXMuYWxsLmxlbmd0aCsxLFxyXG5cdFx0XHRcdGljb246IGljb24sXHJcbiAgICAgICAgICAgICAgICB6b29tOiBjYW52YXMuem9vbSxcclxuXHRcdFx0XHRjYW52YXNXaWR0aDogY2FudmFzLm9yaWdpbmFsLndpZHRoIHx8IGNhbnZhcy5mYWJyaWMuZ2V0V2lkdGgoKSxcclxuXHRcdFx0XHRjYW52YXNIZWlnaHQ6IGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQgfHwgY2FudmFzLmZhYnJpYy5nZXRIZWlnaHQoKVxyXG5cdFx0XHR9KTtcclxuXHRcdH0sXHJcblxyXG4gICAgICAgIGdldDogZnVuY3Rpb24obmFtZSwgcHJvcCkge1xyXG4gICAgICAgICAgICBpZiAoICFwcm9wKSBwcm9wID0gJ2lnbm9yZWQnO1xyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoaXN0b3J5W3Byb3BdLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaGlzdG9yeVtwcm9wXVtpXS5uYW1lID09PSBuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGhpc3RvcnlbcHJvcF1baV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBnZXRDdXJyZW50Q2FudmFzU3RhdGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgc3RhdGU6IGNhbnZhcy5mYWJyaWMudG9KU09OKFsnc2VsZWN0YWJsZScsICduYW1lJ10pLFxyXG4gICAgICAgICAgICAgICAgaW5kZXg6IHRoaXMuYWxsLmxlbmd0aCsxLFxyXG4gICAgICAgICAgICAgICAgem9vbTogY2FudmFzLnpvb20sXHJcbiAgICAgICAgICAgICAgICBjYW52YXNXaWR0aDogY2FudmFzLm9yaWdpbmFsLndpZHRoIHx8IGNhbnZhcy5mYWJyaWMuZ2V0V2lkdGgoKSxcclxuICAgICAgICAgICAgICAgIGNhbnZhc0hlaWdodDogY2FudmFzLm9yaWdpbmFsLmhlaWdodCB8fCBjYW52YXMuZmFicmljLmdldEhlaWdodCgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuXHRcdGxvYWQ6IGZ1bmN0aW9uKGl0ZW0pIHtcclxuXHRcdFx0JHJvb3RTY29wZS5pc0xvYWRpbmcoKTtcclxuXHJcbiAgICAgICAgICAgIC8vaWYgd2UgZ2V0IHBhc3NlZCBhIG5hbWUsIGZldGNoIGEgbWF0Y2hpbmcgaGlzdG9yeSBpdGVtXHJcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzU3RyaW5nKGl0ZW0pKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtID0gdGhpcy5nZXQoaXRlbSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICggISBpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJHJvb3RTY29wZS5pc05vdExvYWRpbmcoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuXHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRjYW52YXMuZmFicmljLmxvYWRGcm9tSlNPTihpdGVtLnN0YXRlLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdGNhbnZhcy5mYWJyaWMuZm9yRWFjaE9iamVjdChmdW5jdGlvbihvYmopIHtcclxuXHJcblx0XHRcdFx0XHRcdC8vcmVhcHBseSBhbnkgZmlsdGVycyBvYmplY3QgdXNlZCB0byBoYXZlXHJcblx0XHRcdFx0XHRcdGlmIChvYmouYXBwbHlGaWx0ZXJzICYmIG9iai5maWx0ZXJzLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0XHRcdG9iai5hcHBseUZpbHRlcnMoY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwuYmluZChjYW52YXMuZmFicmljKSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdC8vYXNzaWduIG5ldyByZWZlcmVuY2UgdG8gbWFpbkltYWdlIHByb3BlcnR5XHJcblx0XHRcdFx0XHRcdGlmIChvYmoubmFtZSA9PSAnbWFpbkltYWdlJykge1xyXG5cdFx0XHRcdFx0XHRcdGNhbnZhcy5tYWluSW1hZ2UgPSBvYmo7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMuem9vbSgxKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uY2FudmFzV2lkdGggJiYgaXRlbS5jYW52YXNIZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRXaWR0aChpdGVtLmNhbnZhc1dpZHRoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRIZWlnaHQoaXRlbS5jYW52YXNIZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMub3JpZ2luYWwud2lkdGggPSBpdGVtLmNhbnZhc1dpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMub3JpZ2luYWwuaGVpZ2h0ID0gaXRlbS5jYW52YXNIZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuY2FsY09mZnNldCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuaXNOb3RMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmZpdFRvU2NyZWVuKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGVtaXQoJ2hpc3RvcnkubG9hZGVkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZm9udHMucmVhZHkudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibG9hZGVkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmlzTm90TG9hZGluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9LCAzMCk7XHJcblxyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdHJldHVybiBoaXN0b3J5O1xyXG59XSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ0ltYWdlRWRpdG9yJylcclxuXHJcbi5mYWN0b3J5KCdzYXZlcicsIFsnJHJvb3RTY29wZScsICckbWREaWFsb2cnLCAnJGh0dHAnLCAnJHRpbWVvdXQnLCAnY2FudmFzJywgJ2Nyb3BwZXInLCAnaGlzdG9yeScsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRtZERpYWxvZywgJGh0dHAsICR0aW1lb3V0LCBjYW52YXMsIGNyb3BwZXIsIGhpc3RvcnkpIHtcclxuXHJcblx0dmFyIHNhdmVyID0ge1xyXG5cclxuICAgICAgICBzYXZlSW1hZ2U6IGZ1bmN0aW9uKGZvcm1hdCwgcXVhbGl0eSwgbmFtZSwgZSwgY2xvc2UpIHtcclxuXHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuZGVhY3RpdmF0ZUFsbCgpO1xyXG4gICAgICAgICAgICBjcm9wcGVyLnN0b3AoKTtcclxuXHJcbiAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLmlzRGVtbykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlRGVtb1NpdGVTYXZlKGUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5pc0ludGVncmF0aW9uTW9kZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlSW50ZWdyYXRpb25Nb2RlU2F2ZShmb3JtYXQsIHF1YWxpdHksIG5hbWUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvL3RoaXMuc2F2ZVRvQ29tcHV0ZXIoZm9ybWF0LCBxdWFsaXR5LCBuYW1lKTtcclxuICAgICAgICAgICAgdGhpcy5zYXZlVG9TZXJ2ZXIobmFtZSwgY2xvc2UpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGhhbmRsZUludGVncmF0aW9uTW9kZVNhdmU6IGZ1bmN0aW9uKGZvcm1hdCwgcXVhbGl0eSwgbmFtZSkge1xyXG4gICAgICAgICAgICBjYW52YXMuem9vbSgxNTAvY2FudmFzLm9yaWdpbmFsLmhlaWdodCk7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gdGhpcy5nZXREYXRhVXJsKGZvcm1hdCwgcXVhbGl0eSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmhhbmRsZUNhbGxiYWNrcyhkYXRhLCBuYW1lKTtcclxuXHJcbiAgICAgICAgICAgIC8vZmlyZWZveCBpbnRlZ3JhdGlvbiBtb2RlIGZpeFxyXG4gICAgICAgICAgICAkKCcubWQtZGlhbG9nLWNvbnRhaW5lcicpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5waXhpZS5jbG9zZSgpO1xyXG4gICAgICAgICAgICBjYW52YXMuem9vbSgwLjUpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHNhdmVUb1NlcnZlcjogZnVuY3Rpb24obmFtZSwgY2xvc2UpIHtcclxuXHJcbiAgICAgICAgICAgIGNhbnZhcy56b29tKDE1MC9jYW52YXMub3JpZ2luYWwuaGVpZ2h0KTtcclxuICAgICAgICAgICAgdmFyIGRhdGFfanBlZyA9IHRoaXMuZ2V0RGF0YVVybCgnanBlZycsIDgpO1xyXG5cclxuICAgICAgICAgICAgY2FudmFzLnpvb20oMSk7ICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciBkYXRhX3BuZyA9IHRoaXMuZ2V0RGF0YVVybCgncG5nJywgOCksXHJcbiAgICAgICAgICAgICAgICBkYXRhX2pzb24gPSB0aGlzLmdldERhdGFVcmwoJ2pzb24nLCA4KTtcclxuICAgICAgICAgICAgY2FudmFzLmZpdFRvU2NyZWVuKCk7ICBcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5pc0xvYWRpbmcoKTtcclxuICAgICAgICAgICAgalF1ZXJ5LmFqYXgoe1xyXG4gICAgICAgICAgICAgICAgdXJsOiBcIi93cC1hZG1pbi9hZG1pbi1hamF4LnBocFwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ3dpbmVzaG9wX2xhYmVsX3NhdmUnLFxyXG4gICAgICAgICAgICAgICAgICAgIG9yZGVyX2lkOiAkcm9vdFNjb3BlLm9yZGVyX2lkLFxyXG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RfaWQ6ICRyb290U2NvcGUucHJvZHVjdF9pZCxcclxuICAgICAgICAgICAgICAgICAgICBqcGVnIDogZGF0YV9qcGVnLFxyXG4gICAgICAgICAgICAgICAgICAgIHBuZyA6IGRhdGFfcG5nLFxyXG4gICAgICAgICAgICAgICAgICAgIGpzb24gOiBkYXRhX2pzb25cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB0eXBlOiAnUE9TVCcsXHJcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmlzTm90TG9hZGluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGNsb3NlKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRvcC50Yl9yZW1vdmUgPT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcC50Yl9yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXZlbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2xvc2VFdmVudE5hbWUgPSBcInBlcnNvbmFsaXplZC13aW5lLWRlc2lnbmVyLW1vZGFsLWNsb3NlXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuY3JlYXRlRXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KFwiSFRNTEV2ZW50c1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5pbml0RXZlbnQoY2xvc2VFdmVudE5hbWUsIHRydWUsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50T2JqZWN0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQuZXZlbnRUeXBlID0gY2xvc2VFdmVudE5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQuZXZlbnROYW1lID0gY2xvc2VFdmVudE5hbWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LmNyZWF0ZUV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChldmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnBhcmVudC5kb2N1bWVudC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZmlyZUV2ZW50KFwib25cIiArIGV2ZW50LmV2ZW50VHlwZSwgZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5wYXJlbnQuZG9jdW1lbnQuZmlyZUV2ZW50KFwib25cIiArIGV2ZW50LmV2ZW50VHlwZSwgZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgc2F2ZVRvQ29tcHV0ZXI6IGZ1bmN0aW9uKGZvcm1hdCwgcXVhbGl0eSwgbmFtZSkge1xyXG4gICAgICAgICAgICBjYW52YXMuem9vbSgxKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpLFxyXG4gICAgICAgICAgICAgICAgZGF0YSA9IHRoaXMuZ2V0RGF0YVVybChmb3JtYXQsIHF1YWxpdHkpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5oYW5kbGVDYWxsYmFja3MoZGF0YSwgbmFtZSk7XHJcblxyXG4gICAgICAgICAgICAvL2Jyb3dzZXIgc3VwcG9ydHMgaHRtbDUgZG93bmxvYWQgYXR0cmlidXRlXHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgbGluay5kb3dubG9hZCAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAgICAgICAgIGxpbmsuZG93bmxvYWQgPSAobmFtZSB8fCAnaW1hZ2UnKSsnLicrZm9ybWF0O1xyXG4gICAgICAgICAgICAgICAgbGluay5ocmVmID0gZGF0YTtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGluayk7XHJcbiAgICAgICAgICAgICAgICBsaW5rLmNsaWNrKCk7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGxpbmspO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvL2NhbnZhcyBibG9iIGFuZCBmaWxlIHNhdmVyIHdvcmthcm91bmRcclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmxvd2VyQ2FudmFzRWwudG9CbG9iKGZ1bmN0aW9uKGJsb2IpIHtcclxuICAgICAgICAgICAgICAgICAgICBzYXZlQXMoYmxvYiwgbmFtZSsnLicrZm9ybWF0KTtcclxuICAgICAgICAgICAgICAgIH0sICdpbWFnZS8nK2Zvcm1hdCwgcXVhbGl0eSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgaGFuZGxlQ2FsbGJhY2tzOiBmdW5jdGlvbihkYXRhLCBuYW1lKSB7XHJcbiAgICAgICAgICAgIC8vcmVwbGFjZSBpbWFnZSBzcmMgd2l0aCBuZXcgZGF0YSB1cmwgaW4gb3JpZ2luYWwgd2luZG93XHJcbiAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLmdldFBhcmFtKCdyZXBsYWNlT3JpZ2luYWwnKSAmJiAkcm9vdFNjb3BlLmdldFBhcmFtKCdpbWFnZScpKSB7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmdldFBhcmFtKCdpbWFnZScpLnNyYyA9IGRhdGE7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vc2VuZCBpbWFnZSBkYXRhIHRvIHVzZXIgc3BlY2lmaWVkIHVybFxyXG4gICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5nZXRQYXJhbSgnc2F2ZVVybCcpKSB7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5wb3N0KCRyb290U2NvcGUuZ2V0UGFyYW0oJ3NhdmVVcmwnKSwgeyBkYXRhOiBkYXRhLCBuYW1lOiBuYW1lIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5nZXRQYXJhbSgnb25TYXZlJykpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpbWcgPSAkcm9vdFNjb3BlLmdldFBhcmFtKCdpbWFnZScpIHx8IG5ldyBJbWFnZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuZ2V0UGFyYW0oJ29uU2F2ZScpKGRhdGEsIGltZywgbmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBoYW5kbGVEZW1vU2l0ZVNhdmU6IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgJCgnLmRlbW8tYWxlcnQnKS5vbmUoJHJvb3RTY29wZS5hbmltYXRpb25FbmRFdmVudCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdhbmltYXRlZCBzaGFrZScpOyAgZS50YXJnZXQuYmx1cigpO1xyXG4gICAgICAgICAgICB9KS5hZGRDbGFzcygnYW5pbWF0ZWQgc2hha2UnKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBnZXREYXRhVXJsOiBmdW5jdGlvbihmb3JtYXQsIHF1YWxpdHkpIHtcclxuICAgICAgICAgICAgaWYgKGZvcm1hdCA9PT0gJ2pzb24nKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJkYXRhOnRleHQvanNvbjtjaGFyc2V0PXV0Zi04LFwiICsgZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KGhpc3RvcnkuZ2V0Q3VycmVudENhbnZhc1N0YXRlKCkpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gY2FudmFzLmZhYnJpYy50b0RhdGFVUkwoe1xyXG4gICAgICAgICAgICAgICAgZm9ybWF0OiBmb3JtYXQgfHwgJ3BuZycsXHJcbiAgICAgICAgICAgICAgICBxdWFsaXR5OiAocXVhbGl0eSB8fCA4KSAvIDEwXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGdldFRodW1iRGF0YVVybDogZnVuY3Rpb24oZGF0YXMsIHdhbnRlZFdpZHRoLCB3YW50ZWRIZWlnaHQpe1xyXG4gICAgICAgICAgICAvLyBXZSBjcmVhdGUgYW4gaW1hZ2UgdG8gcmVjZWl2ZSB0aGUgRGF0YSBVUklcclxuICAgICAgICAgICAgdmFyIGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG5cclxuICAgICAgICAgICAgLy8gV2UgcHV0IHRoZSBEYXRhIFVSSSBpbiB0aGUgaW1hZ2UncyBzcmMgYXR0cmlidXRlXHJcbiAgICAgICAgICAgIGltZy5zcmMgPSBkYXRhcztcclxuICAgICAgICAgICAgdmFyIGRhdGFVUkkgPSAnJztcclxuICAgICAgICAgICAgLy8gV2hlbiB0aGUgZXZlbnQgXCJvbmxvYWRcIiBpcyB0cmlnZ2VyZWQgd2UgY2FuIHJlc2l6ZSB0aGUgaW1hZ2UuXHJcbiAgICAgICAgICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbigpXHJcbiAgICAgICAgICAgICAgICB7ICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAvLyBXZSBjcmVhdGUgYSBjYW52YXMgYW5kIGdldCBpdHMgY29udGV4dC5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBXZSBzZXQgdGhlIGRpbWVuc2lvbnMgYXQgdGhlIHdhbnRlZCBzaXplLlxyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy53aWR0aCA9IHdhbnRlZFdpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSB3YW50ZWRIZWlnaHQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIHJlc2l6ZSB0aGUgaW1hZ2Ugd2l0aCB0aGUgY2FudmFzIG1ldGhvZCBkcmF3SW1hZ2UoKTtcclxuICAgICAgICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKHRoaXMsIDAsIDAsIHdhbnRlZFdpZHRoLCB3YW50ZWRIZWlnaHQpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBkYXRhVVJJID0gY2FudmFzLnRvRGF0YVVSTCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVXNlIGFuZCB0cmVhdCB5b3VyIERhdGEgVVJJIGhlcmUgISEgLy9cclxuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgd2hpbGUoZGF0YVVSSSA9PSAnJyl7fTtcclxuICAgICAgICAgICAgcmV0dXJuIGRhdGFVUkk7XHJcbiAgICAgICAgfVxyXG5cdH07XHJcblxyXG5cdHJldHVybiBzYXZlcjtcclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5maWx0ZXJzJywgW10pXHJcblxyXG4uY29udHJvbGxlcignRmlsdGVyc0NvbnRyb2xsZXInLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ2NhbnZhcycsICdmaWx0ZXJzJywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCBjYW52YXMsIGZpbHRlcnMpIHtcclxuXHJcbiAgICAkc2NvcGUuZmlsdGVycyA9IGZpbHRlcnM7XHJcblxyXG4gICAgJHJvb3RTY29wZS4kb24oJ2hpc3RvcnkubG9hZGVkJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICggISBjYW52YXMubWFpbkltYWdlKSByZXR1cm47XHJcblxyXG4gICAgICAgIHZhciBhcHBsaWVkRmlsdGVycyA9IFtdO1xyXG5cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhbnZhcy5tYWluSW1hZ2UuZmlsdGVycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBhcHBsaWVkRmlsdGVycy5wdXNoKGNhbnZhcy5tYWluSW1hZ2UuZmlsdGVyc1tpXS5uYW1lKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGZpbHRlcnMuYXBwbGllZEZpbHRlcnMgPSBhcHBsaWVkRmlsdGVycztcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XSk7XHJcbiIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdpbWFnZS5maWx0ZXJzJylcclxuXHJcbi5zZXJ2aWNlKCdmaWx0ZXJzJywgWyckcm9vdFNjb3BlJywgJ2NhbnZhcycsICdoaXN0b3J5JywgZnVuY3Rpb24gKCRyb290U2NvcGUsIGNhbnZhcywgaGlzdG9yeSkge1xyXG5cclxuICAgIHZhciBmaWx0ZXJzID0ge1xyXG5cclxuICAgICAgICBhbGw6IFtcclxuICAgICAgICAgICAgeyBuYW1lOiAnZ3JheXNjYWxlJyB9LFxyXG4gICAgICAgICAgICB7IG5hbWU6ICdpbnZlcnQnIH0sXHJcbiAgICAgICAgICAgIHsgbmFtZTogJ3NlcGlhJyB9LFxyXG4gICAgICAgICAgICB7IG5hbWU6ICdzZXBpYTInIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdyZW1vdmVXaGl0ZScsXHJcbiAgICAgICAgICAgICAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGlzdGFuY2U6IHsgY3VycmVudDogMTAgfSxcclxuICAgICAgICAgICAgICAgICAgICB0aHJlc2hvbGQ6IHsgY3VycmVudDogNTAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnYnJpZ2h0bmVzcycsXHJcbiAgICAgICAgICAgICAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJpZ2h0bmVzczogeyBjdXJyZW50OiA1MCB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdub2lzZScsXHJcbiAgICAgICAgICAgICAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9pc2U6IHsgY3VycmVudDogNDAsIG1heDogNjAwIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ0dyYWRpZW50VHJhbnNwYXJlbmN5JyxcclxuICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnR3JhZGllbnQnLFxyXG4gICAgICAgICAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocmVzaG9sZDogeyBjdXJyZW50OiA0MCB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdwaXhlbGF0ZScsXHJcbiAgICAgICAgICAgICAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYmxvY2tzaXplOiB7IG1heDogNDAsIGN1cnJlbnQ6IDIgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnc2hhcnBlbicsXHJcbiAgICAgICAgICAgICAgICB1c2VzOiAnQ29udm9sdXRlJyxcclxuICAgICAgICAgICAgICAgIG1hdHJpeDogWyAwLCAtMSwgIDAsIC0xLCAgNSwgLTEsIDAsIC0xLCAgMCBdXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdibHVyJyxcclxuICAgICAgICAgICAgICAgIHVzZXM6ICdDb252b2x1dGUnLFxyXG4gICAgICAgICAgICAgICAgbWF0cml4OiBbIDEvOSwgMS85LCAxLzksIDEvOSwgMS85LCAxLzksIDEvOSwgMS85LCAxLzkgXVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnZW1ib3NzJyxcclxuICAgICAgICAgICAgICAgIHVzZXM6ICdDb252b2x1dGUnLFxyXG4gICAgICAgICAgICAgICAgbWF0cml4OiBbIDEsICAgMSwgIDEsIDEsIDAuNywgLTEsIC0xLCAgLTEsIC0xIF1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ3RpbnQnLFxyXG4gICAgICAgICAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IHsgY3VycmVudDogMC41LCBtaW46IDAuMSwgbWF4OiAxLCBzdGVwOiAwLjEgfSxcclxuICAgICAgICAgICAgICAgICAgICBjb2xvcjogeyBjb2xvcnBpY2tlcjogdHJ1ZSwgY3VycmVudDogJyNGRjQwODEnIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ211bHRpcGx5JyxcclxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IHtcclxuICAgICAgICAgICAgICAgICAgICBjb2xvcjogeyBjb2xvcnBpY2tlcjogdHJ1ZSwgY3VycmVudDogJyNGRjQwODEnIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ2JsZW5kJyxcclxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RlOiB7IGN1cnJlbnQ6ICdhZGQnLCBzZWxlY3Q6IHRydWUsIGF2YWlsYWJsZTogWydhZGQnLCAnbXVsdGlwbHknLCAnc3VidHJhY3QnLCAnZGlmZicsICdzY3JlZW4nLCAnbGlnaHRlbicsICdkYXJrZW4nXSB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGFscGhhOiB7IGN1cnJlbnQ6IDAuNSwgbWluOiAwLjEsIG1heDogMSwgc3RlcDogMC4xIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IHsgY29sb3JwaWNrZXI6IHRydWUsIGN1cnJlbnQ6ICcjRkY0MDgxJyB9XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIF0sXHJcblxyXG4gICAgICAgIGFwcGxpZWRGaWx0ZXJzOiBbXSxcclxuXHJcbiAgICAgICAgYXBwbHlGaWx0ZXI6IGZ1bmN0aW9uKGZpbHRlcikge1xyXG4gICAgICAgICAgICBpZiAoICEgdGhpcy5maWx0ZXJFeGlzdHMoZmlsdGVyKSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuZmlsdGVyQWxyZWFkeUFwcGxpZWQoZmlsdGVyLm5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW1vdmVGaWx0ZXIoZmlsdGVyKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgJHJvb3RTY29wZS5pc0xvYWRpbmcoKTtcclxuICAgICAgICAgICAgZmlsdGVycy5tYXJrQXNBcHBsaWVkKGZpbHRlci5uYW1lKTtcclxuXHJcbiAgICAgICAgICAgIC8vbmVlZCB0byB1c2UgdGltZW91dCB0byBkaXNwbGF5IGxvYWRpbmcgc3Bpbm5lciBwcm9wZXJseVxyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mb3JFYWNoT2JqZWN0KGZ1bmN0aW9uKG9iaikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvYmouYXBwbHlGaWx0ZXJzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iai5maWx0ZXJzLnB1c2goZmlsdGVycy5nZXRGaWx0ZXIoZmlsdGVyKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iai5hcHBseUZpbHRlcnMoY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwuYmluZChjYW52YXMuZmFicmljKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgaGlzdG9yeS5hZGQoJ2ZpbHRlcjogJysoZmlsdGVyLmRpc3BsYXlOYW1lIHx8IGZpbHRlci5uYW1lKSwgJ2JyaWdodG5lc3MtNicpO1xyXG4gICAgICAgICAgICAgICAgZmlsdGVycy5sYXN0QXBwbGllZEZpbHRlciA9IGZpbHRlcjtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuaXNOb3RMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgIH0sIDMwKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICByZW1vdmVGaWx0ZXI6IGZ1bmN0aW9uKGZpbHRlcikge1xyXG4gICAgICAgICAgICBpZiAoICEgdGhpcy5maWx0ZXJFeGlzdHMoZmlsdGVyKSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgJHJvb3RTY29wZS5pc0xvYWRpbmcoKTtcclxuICAgICAgICAgICAgZmlsdGVycy51bm1hcmtBc0FwcGxpZWQoZmlsdGVyLm5hbWUpO1xyXG5cclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuZm9yRWFjaE9iamVjdChmdW5jdGlvbihvYmopIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAob2JqLmFwcGx5RmlsdGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9iai5maWx0ZXJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JqLmZpbHRlcnNbaV0ubmFtZS50b0xvd2VyQ2FzZSgpID09PSBmaWx0ZXIubmFtZS50b0xvd2VyQ2FzZSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqLmZpbHRlcnMuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iai5hcHBseUZpbHRlcnMoY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwuYmluZChjYW52YXMuZmFicmljKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBmaWx0ZXJzLmxhc3RBcHBsaWVkRmlsdGVyID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmlzTm90TG9hZGluZygpO1xyXG4gICAgICAgICAgICB9LCAzMCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgYXBwbHlWYWx1ZTogZnVuY3Rpb24oZmlsdGVyTmFtZSwgb3B0aW9uTmFtZSwgb3B0aW9uVmFsdWUpIHtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5pc0xvYWRpbmcoKTtcclxuXHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmZvckVhY2hPYmplY3QoZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9iai5hcHBseUZpbHRlcnMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvYmouZmlsdGVycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbHRlciA9IG9iai5maWx0ZXJzW2ldO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWx0ZXIudHlwZS50b0xvd2VyQ2FzZSgpID09PSBmaWx0ZXJOYW1lLnRvTG93ZXJDYXNlKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJbb3B0aW9uTmFtZV0gPSBvcHRpb25WYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmouYXBwbHlGaWx0ZXJzKGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsLmJpbmQoY2FudmFzLmZhYnJpYykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5pc05vdExvYWRpbmcoKTtcclxuICAgICAgICAgICAgfSwgMzApO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGZpbHRlckFscmVhZHlBcHBsaWVkOiBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFwcGxpZWRGaWx0ZXJzLmluZGV4T2YobmFtZSkgIT09IC0xXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgbWFya0FzQXBwbGllZDogZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5hcHBsaWVkRmlsdGVycy5pbmRleE9mKG5hbWUpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hcHBsaWVkRmlsdGVycy5wdXNoKG5hbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgdW5tYXJrQXNBcHBsaWVkOiBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5hcHBsaWVkRmlsdGVycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYXBwbGllZEZpbHRlcnNbaV0gPT09IG5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcGxpZWRGaWx0ZXJzLnNwbGljZShpLCAxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGZpbHRlckV4aXN0czogZnVuY3Rpb24oZmlsdGVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWJyaWMuSW1hZ2UuZmlsdGVyc1tmYWJyaWMudXRpbC5zdHJpbmcuY2FwaXRhbGl6ZShmaWx0ZXIudXNlcyB8fCBmaWx0ZXIubmFtZSwgdHJ1ZSldICE9PSB1bmRlZmluZWQ7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZ2V0RmlsdGVyOiBmdW5jdGlvbihmaWx0ZXIpIHtcclxuICAgICAgICAgICAgdmFyIG5ld0ZpbHRlcjtcclxuXHJcbiAgICAgICAgICAgIGlmIChmaWx0ZXIudXNlcykge1xyXG4gICAgICAgICAgICAgICAgbmV3RmlsdGVyID0gbmV3IGZhYnJpYy5JbWFnZS5maWx0ZXJzW2ZhYnJpYy51dGlsLnN0cmluZy5jYXBpdGFsaXplKGZpbHRlci51c2VzLCB0cnVlKV0oeyBtYXRyaXg6IGZpbHRlci5tYXRyaXggfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB7fTtcclxuXHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gZmlsdGVyLm9wdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zW2tleV0gPSBmaWx0ZXIub3B0aW9uc1trZXldLmN1cnJlbnQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgbmV3RmlsdGVyID0gbmV3IGZhYnJpYy5JbWFnZS5maWx0ZXJzW2ZhYnJpYy51dGlsLnN0cmluZy5jYXBpdGFsaXplKGZpbHRlci5uYW1lLCB0cnVlKV0ob3B0aW9ucyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG5ld0ZpbHRlci5uYW1lID0gZmlsdGVyLm5hbWU7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gbmV3RmlsdGVyO1xyXG4gICAgICAgIH0sXHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBmaWx0ZXJzO1xyXG5cclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5zaGFwZXMnLCBbXSlcclxuXHJcbi5jb250cm9sbGVyKCdTaW1wbGVTaGFwZXNDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICckdGltZW91dCcsICdjYW52YXMnLCAnc2ltcGxlU2hhcGVzJywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCAkdGltZW91dCwgY2FudmFzLCBzaW1wbGVTaGFwZXMpIHtcclxuXHQkc2NvcGUuc2hhcGVzID0gc2ltcGxlU2hhcGVzO1xyXG5cclxuICAgICRzY29wZS5hdmFpbGFibGUgPSBbJ3JlY3QnLCAndHJpYW5nbGUnLCAnY2lyY2xlJywgJ2VsbGlwc2UnLCAncG9seWdvbiddO1xyXG5cclxuICAgICRzY29wZS5pc1BhbmVsRW5hYmxlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBvYmogPSBjYW52YXMuZmFicmljLmdldEFjdGl2ZU9iamVjdCgpO1xyXG4gICAgICAgIGlmKG9iaiAmJiAkc2NvcGUuYXZhaWxhYmxlLmluZGV4T2Yob2JqLm5hbWUpID4gLTEpe1xyXG4gICAgICAgICAgICAkc2NvcGUuc2V0U2VsZXRlZFNoYXBlKG9iaik7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuYWN0aXZlT2JqZWN0ID0gb2JqO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gb2JqICYmICRzY29wZS5hdmFpbGFibGUuaW5kZXhPZihvYmoubmFtZSkgPiAtMSAmJiBzaW1wbGVTaGFwZXMuc2VsZWN0ZWQub3B0aW9ucztcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLnNldFNlbGV0ZWRTaGFwZSA9IGZ1bmN0aW9uKG9iail7XHJcblxyXG4gICAgICAgICRzY29wZS5zaGFwZXMuc2VsZWN0U2hhcGUob2JqLm5hbWUpO1xyXG4gICAgICAgICRzY29wZS5zaGFwZXMuc2VsZWN0ZWRTaGFwZSA9IG9iajtcclxuXHJcbiAgICAgICAgdmFyIHNlbGVjdGVkU2hhcGUgPSAkc2NvcGUuc2hhcGVzLnNlbGVjdGVkO1xyXG5cclxuICAgICAgICBzZWxlY3RlZFNoYXBlLm9wdGlvbnMubWFpbi5maWxsLmN1cnJlbnQgPSBvYmouZmlsbDtcclxuICAgICAgICBzZWxlY3RlZFNoYXBlLm9wdGlvbnMubWFpbi5vcGFjaXR5LmN1cnJlbnQgPSBvYmoub3BhY2l0eTtcclxuICAgICAgICBpZihvYmoubmFtZSA9PSAnY2lyY2xlJyl7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkU2hhcGUub3B0aW9ucy5tYWluLnJhZGl1cy5jdXJyZW50ID0gb2JqLnJhZGl1cztcclxuICAgICAgICB9ZWxzZSBpZihvYmoubmFtZSA9PSAnZWxsaXBzZScpe1xyXG4gICAgICAgICAgICBzZWxlY3RlZFNoYXBlLm9wdGlvbnMubWFpbi5yeC5jdXJyZW50ID0gb2JqLnJ4O1xyXG4gICAgICAgICAgICBzZWxlY3RlZFNoYXBlLm9wdGlvbnMubWFpbi5yeS5jdXJyZW50ID0gb2JqLnJ5O1xyXG4gICAgICAgIH1lbHNlIGlmKG9iai5uYW1lICE9ICdwb2x5Z29uJyl7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkU2hhcGUub3B0aW9ucy5tYWluLndpZHRoLmN1cnJlbnQgPSBvYmoud2lkdGg7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkU2hhcGUub3B0aW9ucy5tYWluLmhlaWdodC5jdXJyZW50ID0gb2JqLmhlaWdodDtcclxuICAgICAgICB9XHJcbiAgICAgICAgalF1ZXJ5KFwiI3NoYXBlQmdDb2xvclwiKS5zcGVjdHJ1bShcInNldFwiLCBvYmouZmlsbCk7XHJcbiAgICAgICAgaWYob2JqLnN0cm9rZSl7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkU2hhcGUub3B0aW9ucy5ib3JkZXIuZW5hYmxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkU2hhcGUub3B0aW9ucy5ib3JkZXIuc3Ryb2tlLmN1cnJlbnQgPSBvYmouc3Ryb2tlO1xyXG4gICAgICAgICAgICBzZWxlY3RlZFNoYXBlLm9wdGlvbnMuYm9yZGVyLnN0cm9rZVdpZHRoLmN1cnJlbnQgPSBvYmouc3Ryb2tlV2lkdGg7XHJcbiAgICAgICAgICAgIGpRdWVyeShcIiNib3JkZXJzdHJva2VcIikuc3BlY3RydW0oXCJzZXRcIiwgb2JqLnN0cm9rZSk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkU2hhcGUub3B0aW9ucy5ib3JkZXIuZW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihvYmouc2hhZG93KXtcclxuICAgICAgICAgICAgc2VsZWN0ZWRTaGFwZS5vcHRpb25zLnNoYWRvdy5lbmFibGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgc2VsZWN0ZWRTaGFwZS5vcHRpb25zLnNoYWRvdy5jb2xvci5jdXJyZW50ID0gb2JqLnNoYWRvdy5jb2xvcjtcclxuICAgICAgICAgICAgc2VsZWN0ZWRTaGFwZS5vcHRpb25zLnNoYWRvdy5ibHVyLmN1cnJlbnQgPSBvYmouc2hhZG93LmJsdXI7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkU2hhcGUub3B0aW9ucy5zaGFkb3cub2Zmc2V0WC5jdXJyZW50ID0gb2JqLnNoYWRvdy5vZmZzZXRYO1xyXG4gICAgICAgICAgICBzZWxlY3RlZFNoYXBlLm9wdGlvbnMuc2hhZG93Lm9mZnNldFkuY3VycmVudCA9IG9iai5zaGFkb3cub2Zmc2V0WTtcclxuICAgICAgICAgICAgalF1ZXJ5KFwiI3NoYWRvd2NvbG9yXCIpLnNwZWN0cnVtKFwic2V0XCIsIG9iai5zaGFkb3cuY29sb3IpO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBzZWxlY3RlZFNoYXBlLm9wdGlvbnMuc2hhZG93LmVuYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vICRzY29wZS5zZWxlY3RlZFNoYXBlWydoZWlnaHQnXSA9IG9iai5oZWlnaHQ7XHJcbiAgICAgICAgLy8gJHNjb3BlLnNlbGVjdGVkU2hhcGVbJ29wYWNpdHknXSA9IG9iai5vcGFjaXR5O1xyXG4gICAgICAgIC8vICRzY29wZS5zZWxlY3RlZFNoYXBlWyd3aWR0aCddID0gb2JqLndpZHRoO1xyXG4gICAgICAgIC8vICRzY29wZS5zZWxlY3RlZFNoYXBlWydzdHJva2VXaWR0aCddID0gb2JqLnN0cm9rZVdpZHRoO1xyXG4gICAgICAgIC8vICRzY29wZS5zZWxlY3RlZFNoYXBlWydzdHJva2UnXSA9IG9iai5zdHJva2U7XHJcbiAgICAgICAgLy8gJHNjb3BlLnNlbGVjdGVkU2hhcGVbJ3NoYWRvdyddID0gb2JqLnNoYWRvdztcclxuXHJcbiAgICB9O1xyXG5cclxuICAgIC8vIGNhbnZhcy5mYWJyaWMub24oJ29iamVjdDpzZWxlY3RlZCcsIGZ1bmN0aW9uKG9iamVjdCkge1xyXG4gICAgLy8gICAgIGlmICgkcm9vdFNjb3BlLmFjdGl2ZVRhYiAhPT0gJ3NpbXBsZS1zaGFwZXMnKSByZXR1cm47XHJcbiAgICAvLyAgICAgc2ltcGxlU2hhcGVzLnNlbGVjdFNoYXBlKG9iamVjdC50YXJnZXQubmFtZSk7XHJcbiAgICAvLyB9KTtcclxufV0pOyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdJbWFnZUVkaXRvcicpXHJcblxyXG4uY29udHJvbGxlcignUGhvdG9Db250cm9sbGVyJywgWyckcm9vdFNjb3BlJywgJyRzY29wZScsICckbWREaWFsb2cnLCAnJG1kVG9hc3QnLCAnJCRyQUYnLCAnY2FudmFzJywgJ2hpc3RvcnknLCAnc2V0dGluZ3MnLCAnc2F2ZXInLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsICRtZERpYWxvZywgJG1kVG9hc3QsICQkckFGLCBjYW52YXMsIGhpc3RvcnksIHNldHRpbmdzLCBzYXZlcikge1xyXG5cclxuICAgICRzY29wZS5oaXN0b3J5ID0gaGlzdG9yeTtcclxuXHJcbiAgICAkc2NvcGUuaXNEZW1vID0gJHJvb3RTY29wZS5pc0RlbW87XHJcbiAgICAkc2NvcGUuY2FuT3BlbkltYWdlID0gZmFsc2U7XHJcbiAgICAkc2NvcGUuY2FudmFzID0gY2FudmFzO1xyXG4gICAgJHNjb3BlLm9wZW5JbWFnZU1vZGUgPSAnb3Blbic7XHJcblxyXG4gICAgJHNjb3BlLmNhbnZhc1dpZHRoID0gODAwO1xyXG4gICAgJHNjb3BlLmNhbnZhc0hlaWdodCA9IDYwMDtcclxuXHJcbiAgICAkc2NvcGUuaW1hZ2VOYW1lID0gJ2ltYWdlJztcclxuICAgICRzY29wZS5pbWFnZVR5cGUgPSAnanBlZyc7XHJcbiAgICAkc2NvcGUuaW1hZ2VRdWFsaXR5ID0gODtcclxuICAgICRzY29wZS5waG90b1BhdGggPSAnJztcclxuXHJcbiAgICAkc2NvcGUub2JqZWN0c1BhbmVsT3BlbiA9IHRydWU7XHJcbiAgICAkc2NvcGUuaGlzdG9yeVBhbmVsT3BlbiA9IGZhbHNlO1xyXG5cclxuICAgICRyb290U2NvcGUuJG9uKCdzZXR0aW5ncy5yZWFkeScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBwaG90b3MgPSBzZXR0aW5ncy5nZXQoJ3Bob3RvcycpLnBob3RvcztcclxuICAgICAgICAvL3ZhciBpbWFnZXMgPSBwaG90b3MuaW1hZ2VzLml0ZW1zO1xyXG5cclxuICAgICAgICAvLyBmb3IgKHZhciBjYXQgaW4gcGhvdG9zKSB7XHJcbiAgICAgICAgLy8gICAgIHBob3Rvc1tjYXRdLml0ZW1zID0gbmV3IEFycmF5KHBob3Rvc1tjYXRdLmxlbmd0aCk7XHJcbiAgICAgICAgLy8gfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnBob3RvcyA9IHBob3RvcztcclxuICAgIH0pO1xyXG5cclxuICAgICRzY29wZS5hY3RpdmVQaG90b0NhdGVnb3J5ID0gJ3VzZXInO1xyXG5cclxuICAgICRzY29wZS5zZXRBY3RpdmVQaG90b0NhdGVnb3J5ID0gZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgIGlmICgkc2NvcGUuYWN0aXZlUGhvdG9DYXRlZ29yeSA9PT0gbmFtZSkge1xyXG4gICAgICAgICAgICAkc2NvcGUuYWN0aXZlUGhvdG9DYXRlZ29yeSA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICRzY29wZS5hY3RpdmVQaG90b0NhdGVnb3J5ID0gbmFtZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5vcGVuVXBsb2FkRGlhbG9nID0gZnVuY3Rpb24oJGV2ZW50KSB7XHJcbiAgICAgICAgJG1kRGlhbG9nLnNob3coe1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJCgnI21haW4taW1hZ2UtdXBsb2FkLWRpYWxvZy10ZW1wbGF0ZScpLmh0bWwoKSxcclxuICAgICAgICAgICAgdGFyZ2V0RXZlbnQ6ICRldmVudCxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Bob3RvQ29udHJvbGxlcicsXHJcbiAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS50cmFuc2Zvcm1PcGVuID0gZnVuY3Rpb24obmFtZSwgZSkge1xyXG4gICAgICAgIHZhciBwYW5lbCA9ICQoJyMnK25hbWUpO1xyXG5cclxuICAgICAgICBwYW5lbC5yZW1vdmVDbGFzcygndHJhbnNpdGlvbi1vdXQgdHJhbnNpdGlvbi1pbicpLnNob3coKTtcclxuICAgICAgICAkc2NvcGUudHJhbnNmb3JtVG9DbGlja0VsZW1lbnQocGFuZWwsIGUpO1xyXG5cclxuICAgICAgICAkJHJBRihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcGFuZWwuYWRkQ2xhc3MoJ3RyYW5zaXRpb24taW4nKS5jc3MoJ3RyYW5zZm9ybScsICcnKTtcclxuICAgICAgICAgICAgZS5jdXJyZW50VGFyZ2V0LmJsdXIoKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLnRyYW5zZm9ybUNsb3NlID0gZnVuY3Rpb24obmFtZSwgZSkge1xyXG4gICAgICAgIHZhciBwYW5lbCA9ICQoJyMnK25hbWUpO1xyXG5cclxuICAgICAgICBwYW5lbC5hZGRDbGFzcygndHJhbnNpdGlvbi1vdXQnKS5yZW1vdmVDbGFzcygndHJhbnNpdGlvbi1pbicpO1xyXG4gICAgICAgICRzY29wZS50cmFuc2Zvcm1Ub0NsaWNrRWxlbWVudChwYW5lbCwgZSk7XHJcblxyXG4gICAgICAgIHBhbmVsLm9uZSgkcm9vdFNjb3BlLnRyYW5zaXRpb25FbmRFdmVudCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHBhbmVsLmhpZGUoKS5jc3MoJ3RyYW5zZm9ybScsICcnKS5yZW1vdmVDbGFzcygndHJhbnNpdGlvbi1vdXQnKTtcclxuICAgICAgICAgICAgZS5jdXJyZW50VGFyZ2V0LmJsdXIoKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLnRyYW5zZm9ybVRvQ2xpY2tFbGVtZW50ID0gZnVuY3Rpb24ocGFuZWwsIGUpIHtcclxuICAgICAgICB2YXIgY2xpY2tSZWN0ID0gZS50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgdmFyIHBhbmVsUmVjdCA9IHBhbmVsWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuICAgICAgICB2YXIgc2NhbGVYID0gTWF0aC5taW4oMC41LCBjbGlja1JlY3Qud2lkdGggLyBwYW5lbFJlY3Qud2lkdGgpO1xyXG4gICAgICAgIHZhciBzY2FsZVkgPSBNYXRoLm1pbigwLjUsIGNsaWNrUmVjdC5oZWlnaHQgLyBwYW5lbFJlY3QuaGVpZ2h0KTtcclxuXHJcbiAgICAgICAgcGFuZWwuY3NzKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlM2QoJyArXHJcbiAgICAgICAgICAgICgtcGFuZWxSZWN0LmxlZnQgKyBjbGlja1JlY3QubGVmdCArIGNsaWNrUmVjdC53aWR0aC8yIC0gcGFuZWxSZWN0LndpZHRoLzIpICsgJ3B4LCcgK1xyXG4gICAgICAgICAgICAoLXBhbmVsUmVjdC50b3AgKyBjbGlja1JlY3QudG9wICsgY2xpY2tSZWN0LmhlaWdodC8yIC0gcGFuZWxSZWN0LmhlaWdodC8yKSArICdweCwnICtcclxuICAgICAgICAgICAgJzApIHNjYWxlKCcgKyBzY2FsZVggKyAnLCcgKyBzY2FsZVkgKyAnKSdcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuXHJcblxyXG4gICAgJHNjb3BlLm9wZW5TYW1wbGVJbWFnZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNhbnZhcy5sb2FkTWFpbkltYWdlKCdhc3NldHMvaW1hZ2VzL2xvdHVzLmpwZycpO1xyXG4gICAgICAgICRzY29wZS5jbG9zZVVwbG9hZERpYWxvZygpO1xyXG4gICAgICAgICRyb290U2NvcGUuc3RhcnRlZCA9IHRydWU7XHJcbiAgICB9O1xyXG5cclxuXHJcbiAgICAkc2NvcGUuc2hvd0ltYWdlUHJldmlldyA9IGZ1bmN0aW9uKHVybCkge1xyXG4gICAgICAgIHZhciBoaXN0b3J5T2JqZWN0ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGhpc3RvcnlPYmplY3QgPSBKU09OLnBhcnNlKHVybCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAvL1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGhpc3RvcnlPYmplY3QgJiYgaGlzdG9yeU9iamVjdC5zdGF0ZSkge1xyXG4gICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNhbk9wZW5JbWFnZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuY2xlYXIoKTtcclxuICAgICAgICAgICAgaGlzdG9yeS5sb2FkKGhpc3RvcnlPYmplY3QpO1xyXG4gICAgICAgICAgICAkc2NvcGUuY2xvc2VVcGxvYWREaWFsb2coKTtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5zdGFydGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZmFicmljLnV0aWwubG9hZEltYWdlKHVybCwgZnVuY3Rpb24oaW1hZ2UpIHtcclxuICAgICAgICAgICAgaWYgKGltYWdlKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy5pbWctcHJldmlldycpLmh0bWwoJycpLmFwcGVuZChpbWFnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhbk9wZW5JbWFnZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhbk9wZW5JbWFnZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLm9wZW5JbWFnZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciB1cmwgPSAkKCcuaW1nLXByZXZpZXcgaW1nJykuYXR0cignc3JjJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIGlmICggISB1cmwgfHwgISAkc2NvcGUuY2FuT3BlbkltYWdlKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmICgoIWNhbnZhcy5mYWJyaWMuX29iamVjdHMubGVuZ3RoIHx8ICEgY2FudmFzLm1haW5JbWFnZSkgJiYgISAkcm9vdFNjb3BlLnVzZXJQcmVzZXQpIHtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5jbGVhcigpO1xyXG4gICAgICAgICAgICBjYW52YXMubG9hZE1haW5JbWFnZSh1cmwpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNhbnZhcy5vcGVuSW1hZ2UodXJsKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS5jbG9zZVVwbG9hZERpYWxvZygpO1xyXG4gICAgICAgICRyb290U2NvcGUuc3RhcnRlZCA9IHRydWU7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5jbG9zZVVwbG9hZERpYWxvZyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICRzY29wZS5jYW5VcGxvYWRJbWFnZSA9IGZhbHNlO1xyXG4gICAgICAgICRzY29wZS5vcGVuSW1hZ2VNb2RlID0gJ29wZW4nO1xyXG4gICAgICAgICQoJy5pbWctcHJldmlldycpLmh0bWwoKTtcclxuICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xyXG4gICAgfTtcclxuXHJcblxyXG4gICAgJHNjb3BlLmFkZFRvQ2FudmFzID0gZnVuY3Rpb24oY2F0ZWdvcnksIGluZGV4LCBlKSB7XHJcbiAgICAgICAgaWYgKCRzY29wZS5sb2FkaW5nKSByZXR1cm47XHJcbiAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSB0cnVlO1xyXG4gICAgICAgIC8vJHNjb3BlLm9wZW5QYW5lbCgncGhvdG9zJywgZSk7XHJcbiAgICAgICAgdmFyIGltZ191cmwgPSBjYXRlZ29yeS5wYXRoICsgY2F0ZWdvcnkuaXRlbXNbaW5kZXhdLmltYWdlO1xyXG4gICAgICAgIC8vIHZhciBodHRwID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgICAgICAgLy8gaHR0cC5vcGVuKCdIRUFEJywgaW1nX3VybCwgZmFsc2UpO1xyXG4gICAgICAgIC8vIGh0dHAuc2VuZCgpO1xyXG4gICAgICAgIC8vIGlmKGh0dHAuc3RhdHVzPT00MDQpIGltZ191cmwgPSAnYXNzZXRzL2ltYWdlcy9waG90b3MvJytjYXRlZ29yeS5uYW1lKycvJytpbmRleCsnLicrY2F0ZWdvcnkudHlwZTtcclxuICAgICAgICBmYWJyaWMudXRpbC5sb2FkSW1hZ2UoIGltZ191cmwsIGZ1bmN0aW9uKGltZykge1xyXG4gICAgICAgICAgICB2YXIgaW1hZ2UgPSBuZXcgZmFicmljLkltYWdlKGltZyk7XHJcbiAgICAgICAgICAgIGFmdGVyQWRkUGhvdG9Ub0NhbnZhcyhpbWFnZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2FudmFzLmZpdFRvU2NyZWVuKCk7IFxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGFmdGVyQWRkUGhvdG9Ub0NhbnZhcyhpbWFnZSkge1xyXG4gICAgICAgIGltYWdlLm5hbWUgPSAncGhvdG8nO1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMuYWRkKGltYWdlKTtcclxuICAgICAgICBpbWFnZS5zY2FsZVRvSGVpZ2h0KCg1MCAvIDEwMCkgKiBjYW52YXMub3JpZ2luYWwuaGVpZ2h0KTtcclxuXHJcbiAgICAgICAgaW1hZ2UuY2VudGVyKCk7XHJcbiAgICAgICAgaW1hZ2Uuc2V0Q29vcmRzKCk7XHJcbiAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3QoaW1hZ2UpO1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVPYmplY3QgPSBpbWFnZTtcclxuXHJcbiAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaGlzdG9yeS5hZGQoJ0FkZGVkOiBQaG90bycsICdmYXZvcml0ZScpO1xyXG4gICAgfVxyXG5cclxufV0pO1xyXG5cclxuXHJcblxyXG4iLCJhbmd1bGFyLm1vZHVsZSgnaW1hZ2Uuc2hhcGVzJylcclxuXHJcbi5kaXJlY3RpdmUoJ2VkUGhvdG9zQ2F0ZWdvcmllcycsIGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSwgZWwpIHtcclxuXHJcbiAgICAgICAgICAgIC8vbG9hZCBwaG90byBpbWFnZXMgaW50byBvcGVuIGNhdGVnb3J5IHdoZW4gcGhvdG9zIHRhYiBpcyBvcGVuZWRcclxuICAgICAgICAgICAgdmFyIHVuYmluZCA9ICRzY29wZS4kd2F0Y2goJ2FjdGl2ZVRhYicsIGZ1bmN0aW9uKG5ld1RhYikge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5ld1RhYiAhPT0gJ3Bob3RvcycpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY2F0ID0gJCgnLmNhdGVnb3J5LXBob3Rvcy5vcGVuJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2F0LmZpbmQoJ2ltZycpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zcmMgPSB0aGlzLmRhdGFzZXQuc3JjO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2F0LnBhcmVudCgpLmFkZENsYXNzKCdsb2FkZWQnKTtcclxuXHJcbiAgICAgICAgICAgICAgICB1bmJpbmQoKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvL2xvYWQgcGhvdG8gaW1hZ2VzIGZvciB0aGUgY2F0ZWdvcnkgdGhhdCBqdXN0IGJlZW4gb3BlbmVkXHJcbiAgICAgICAgICAgIGVsLm9uKCdjbGljaycsICcuY2F0ZWdvcnktaGVhZGVyJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2V0QWN0aXZlUGhvdG9DYXRlZ29yeShlLnRhcmdldC5kYXRhc2V0Lm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGNhdGVnb3J5ID0gJChlLmN1cnJlbnRUYXJnZXQpLnBhcmVudCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICggISBjYXRlZ29yeS5oYXNDbGFzcygnbG9hZGVkJykpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeS5hZGRDbGFzcygnbG9hZGVkJykuZmluZCgnaW1nJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcmMgPSB0aGlzLmRhdGFzZXQuc3JjO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgIFx0fVxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnaW1hZ2Uuc2hhcGVzJylcclxuXHJcbi5jb250cm9sbGVyKCdTdGlja2Vyc0NvbnRyb2xsZXInLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ2NhbnZhcycsICdzaW1wbGVTaGFwZXMnLCAnaGlzdG9yeScsICdzZXR0aW5ncycsIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgY2FudmFzLCBzaW1wbGVTaGFwZXMsIGhpc3RvcnksIHNldHRpbmdzKSB7XHJcblx0JHNjb3BlLnNoYXBlcyA9IHNpbXBsZVNoYXBlcztcclxuICAgICRzY29wZS5vcGFjaXR5ID0gMC45O1xyXG5cclxuICAgICRyb290U2NvcGUuJG9uKCdzZXR0aW5ncy5yZWFkeScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzdGlja2VycyA9IHNldHRpbmdzLmdldCgnc3RpY2tlcnMnKS5zdGlja2VycztcclxuXHJcbiAgICAgICAgLy8gZm9yICh2YXIgaSA9IHN0aWNrZXJzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgICAgLy8gICAgIHN0aWNrZXJzW2ldLml0ZW1zID0gbmV3IEFycmF5KHN0aWNrZXJzW2ldLml0ZW1zKTtcclxuICAgICAgICAvLyB9O1xyXG5cclxuICAgICAgICAkc2NvcGUuY2F0ZWdvcmllcyA9IHN0aWNrZXJzO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJHNjb3BlLmFjdGl2ZUNhdGVnb3J5ID0gJ2Rvb2RsZXMnO1xyXG5cclxuICAgICRzY29wZS5hY3RpdmVTdGlja2VySXNTdmcgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgb2JqID0gY2FudmFzLmZhYnJpYy5nZXRBY3RpdmVPYmplY3QoKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIG9iaiAmJiBhbmd1bGFyLmlzRGVmaW5lZChvYmouc3ZnVWlkKTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLmlzUGFuZWxFbmFibGVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIG9iaiA9IGNhbnZhcy5mYWJyaWMuZ2V0QWN0aXZlT2JqZWN0KCk7XHJcbiAgICAgICAgcmV0dXJuIG9iaiAmJiBvYmoubmFtZSA9PT0gJ3N0aWNrZXInICYmICRyb290U2NvcGUuYWN0aXZlVGFiID09PSAnc3RpY2tlcnMnO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuc2V0QWN0aXZlQ2F0ZWdvcnkgPSBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgaWYgKCRzY29wZS5hY3RpdmVDYXRlZ29yeSA9PT0gbmFtZSkge1xyXG4gICAgICAgICAgICAkc2NvcGUuYWN0aXZlQ2F0ZWdvcnkgPSBmYWxzZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkc2NvcGUuYWN0aXZlQ2F0ZWdvcnkgPSBuYW1lO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLnNldE9wYWNpdHkgPSBmdW5jdGlvbihvcGFjaXR5KSB7XHJcbiAgICAgICAgc2ltcGxlU2hhcGVzLmdldFNoYXBlKCdzdGlja2VyJykuc2V0T3BhY2l0eShvcGFjaXR5KTtcclxuICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuc2V0Q29sb3IgPSBmdW5jdGlvbihjb2xvcikge1xyXG4gICAgICAgIHZhciBvYmogPSBzaW1wbGVTaGFwZXMuZ2V0U2hhcGUoJ3N0aWNrZXInKTtcclxuXHJcbiAgICAgICAgaWYgKG9iai5pc1NhbWVDb2xvciAmJiBvYmouaXNTYW1lQ29sb3IoKSB8fCAhIG9iai5wYXRocykge1xyXG4gICAgICAgICAgICBvYmouc2V0RmlsbChjb2xvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG9iai5wYXRocykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9iai5wYXRocy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgb2JqLnBhdGhzW2ldLnNldEZpbGwoY29sb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuYWRkVG9DYW52YXMgPSBmdW5jdGlvbihjYXRlZ29yeSwgaW5kZXgsIGUpIHtcclxuICAgICAgICBpZiAoJHNjb3BlLmxvYWRpbmcpIHJldHVybjtcclxuICAgICAgICAkc2NvcGUubG9hZGluZyA9IHRydWU7XHJcbiAgICAgICAgJHNjb3BlLm9wZW5QYW5lbCgnc3RpY2tlcnMnLCBlKTtcclxuXHJcbiAgICAgICAgaWYgKGNhdGVnb3J5LnR5cGUgPT09ICdzdmcnKSB7XHJcbiAgICAgICAgICAgIGZhYnJpYy5sb2FkU1ZHRnJvbVVSTChjYXRlZ29yeS5wYXRoICsgY2F0ZWdvcnkuaXRlbXNbaW5kZXhdLnRodW1ibmFpbCwgZnVuY3Rpb24gKG9iamVjdHMsIG9wdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpbWFnZSA9IGZhYnJpYy51dGlsLmdyb3VwU1ZHRWxlbWVudHMob2JqZWN0cywgb3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICBhZnRlckFkZFN0aWNrZXJUb0NhbnZhcyhpbWFnZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGZhYnJpYy51dGlsLmxvYWRJbWFnZShjYXRlZ29yeS5wYXRoICsgY2F0ZWdvcnkuaXRlbXNbaW5kZXhdLnRodW1ibmFpbCwgZnVuY3Rpb24oaW1nKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW1hZ2UgPSBuZXcgZmFicmljLkltYWdlKGltZyk7XHJcbiAgICAgICAgICAgICAgICBhZnRlckFkZFN0aWNrZXJUb0NhbnZhcyhpbWFnZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBhZnRlckFkZFN0aWNrZXJUb0NhbnZhcyhpbWFnZSkge1xyXG4gICAgICAgIGltYWdlLm5hbWUgPSAnc3RpY2tlcic7XHJcbiAgICAgICAgY2FudmFzLmZhYnJpYy5hZGQoaW1hZ2UpO1xyXG4gICAgICAgIGltYWdlLnNjYWxlVG9IZWlnaHQoKDQwIC8gMTAwKSAqIGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQpO1xyXG5cclxuICAgICAgICBpbWFnZS5jZW50ZXIoKTtcclxuICAgICAgICBpbWFnZS5zZXRDb29yZHMoKTtcclxuICAgICAgICBjYW52YXMuZmFicmljLnNldEFjdGl2ZU9iamVjdChpbWFnZSk7XHJcbiAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuXHJcbiAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZU9iamVjdCA9IGltYWdlO1xyXG4gICAgICAgIGhpc3RvcnkuYWRkKCdBZGRlZDogU3RpY2tlcicsICdmYXZvcml0ZScpO1xyXG4gICAgfVxyXG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ2ltYWdlLnNoYXBlcycpXHJcblxyXG4uZGlyZWN0aXZlKCdlZFN0aWNrZXJzQ2F0ZWdvcmllcycsIGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSwgZWwpIHtcclxuXHJcbiAgICAgICAgICAgIC8vbG9hZCBzdGlja2VyIGltYWdlcyBpbnRvIG9wZW4gY2F0ZWdvcnkgd2hlbiBzdGlja2VycyB0YWIgaXMgb3BlbmVkXHJcbiAgICAgICAgICAgIHZhciB1bmJpbmQgPSAkc2NvcGUuJHdhdGNoKCdhY3RpdmVUYWInLCBmdW5jdGlvbihuZXdUYWIpIHtcclxuICAgICAgICAgICAgICAgIGlmIChuZXdUYWIgIT09ICdzdGlja2VycycpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY2F0ID0gJCgnLmNhdGVnb3J5LXN0aWNrZXJzLm9wZW4nKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXQuZmluZCgnaW1nJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNyYyA9IHRoaXMuZGF0YXNldC5zcmM7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXQucGFyZW50KCkuYWRkQ2xhc3MoJ2xvYWRlZCcpO1xyXG5cclxuICAgICAgICAgICAgICAgIHVuYmluZCgpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vbG9hZCBzdGlja2VyIGltYWdlcyBmb3IgdGhlIGNhdGVnb3J5IHRoYXQganVzdCBiZWVuIG9wZW5lZFxyXG4gICAgICAgICAgICBlbC5vbignY2xpY2snLCAnLmNhdGVnb3J5LWhlYWRlcicsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNldEFjdGl2ZUNhdGVnb3J5KGUudGFyZ2V0LmRhdGFzZXQubmFtZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY2F0ZWdvcnkgPSAkKGUuY3VycmVudFRhcmdldCkucGFyZW50KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCAhIGNhdGVnb3J5Lmhhc0NsYXNzKCdsb2FkZWQnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5LmFkZENsYXNzKCdsb2FkZWQnKS5maW5kKCdpbWcnKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNyYyA9IHRoaXMuZGF0YXNldC5zcmM7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgXHR9XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5zaGFwZXMnKVxyXG5cclxuLmZpbHRlcignb3JkZXJPcHRpb25zJywgZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24oaXRlbXMsIGZpZWxkLCByZXZlcnNlKSB7XHJcbiAgICAgICAgdmFyIGZpbHRlcmVkID0gW107XHJcbiAgICAgICAgYW5ndWxhci5mb3JFYWNoKGl0ZW1zLCBmdW5jdGlvbihpdGVtLCBrZXkpIHtcclxuICAgICAgICAgICAgaXRlbS5uYW1lID0ga2V5O1xyXG4gICAgICAgICAgICBmaWx0ZXJlZC5wdXNoKGl0ZW0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGZpbHRlcmVkLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChhW2ZpZWxkXSA+IGJbZmllbGRdID8gMSA6IC0xKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZihyZXZlcnNlKSBmaWx0ZXJlZC5yZXZlcnNlKCk7XHJcblxyXG4gICAgICAgIHJldHVybiBmaWx0ZXJlZDtcclxuICAgIH07XHJcbn0pXHJcblxyXG4uc2VydmljZSgnc2ltcGxlU2hhcGVzJywgWyckcm9vdFNjb3BlJywgJ2NhbnZhcycsICdwb2x5Z29uJywgJ2hpc3RvcnknLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgY2FudmFzLCBwb2x5Z29uLCBoaXN0b3J5KSB7XHJcblxyXG4gICAgdmFyIHNoYXBlcyA9IHtcclxuXHJcbiAgICAgICAgZ3JhZGllbnRzOiBlZEdyYWRpZW50cyxcclxuXHJcbiAgICAgICAgdGV4dHVyZXM6IG5ldyBBcnJheSgyOCksXHJcblxyXG4gICAgICAgIGJhc2VPcHRpb25zOiB7XHJcbiAgICAgICAgICAgIG1haW46IHtcclxuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiB7IHR5cGU6ICdzbGlkZXInLCBjdXJyZW50OiAxLCBtaW46IDAuMSwgbWF4OiAxLCBzdGVwOiAwLjEgfSxcclxuICAgICAgICAgICAgICAgIGZpbGw6IHsgdHlwZTogJ2NvbG9ycGlja2VyJywgY3VycmVudDogJyMyNjMyMzgnLCBoaWRkZW46IHRydWUgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBib3JkZXI6IHtcclxuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgb25Ub2dnbGU6ICd0b2dnbGVCb3JkZXInLFxyXG4gICAgICAgICAgICAgICAgc3Ryb2tlOiB7IHR5cGU6ICdjb2xvcnBpY2tlcicsIGN1cnJlbnQ6ICcjMjE5NkYzJywgZGlzcGxheU5hbWU6ICdDb2xvcicgfSxcclxuICAgICAgICAgICAgICAgIHN0cm9rZVdpZHRoOiB7IHR5cGU6ICdzbGlkZXInLCBjdXJyZW50OiA1LCBtYXg6IDQwLCBkaXNwbGF5TmFtZTogJ1dpZHRoJyB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNoYWRvdzoge1xyXG4gICAgICAgICAgICAgICAgZW5hYmxlZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBvblRvZ2dsZTogJ3RvZ2dsZVNoYWRvdycsXHJcbiAgICAgICAgICAgICAgICBjb2xvcjogeyB0eXBlOiAnY29sb3JwaWNrZXInLCBjdXJyZW50OiAncmdiYSgwLDAsMCwwLjUpJ30sXHJcbiAgICAgICAgICAgICAgICBibHVyOiB7IHR5cGU6ICdzbGlkZXInLCBjdXJyZW50OiA1LCBtYXg6IDgwIH0sXHJcbiAgICAgICAgICAgICAgICBvZmZzZXRYOiB7IHR5cGU6ICdzbGlkZXInLCBjdXJyZW50OiA4LCBtYXg6IDMwIH0sXHJcbiAgICAgICAgICAgICAgICBvZmZzZXRZOiB7IHR5cGU6ICdzbGlkZXInLCBjdXJyZW50OiA1LCBtYXg6IDMwIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGF2YWlsYWJsZTogW10sXHJcblxyXG4gICAgICAgIHNlbGVjdGVkOiBmYWxzZSxcclxuICAgICAgICBzZWxlY3RlZFNoYXBlOiBmYWxzZSxcclxuXHJcbiAgICAgICAgZmlsbFdpdGhHcmFkaWVudDogZnVuY3Rpb24oaW5kZXgsIHR5cGUpIHtcclxuICAgICAgICAgICAgdmFyIHNoYXBlID0gY2FudmFzLmZhYnJpYy5nZXRBY3RpdmVPYmplY3QoKTtcclxuXHJcbiAgICAgICAgICAgIHNoYXBlLnNldEdyYWRpZW50KHR5cGV8fCdmaWxsJywgdGhpcy5ncmFkaWVudHNbaW5kZXhdKTtcclxuXHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZmlsbFdpdGhJbWFnZTogZnVuY3Rpb24odXJsKSB7XHJcbiAgICAgICAgICAgIHZhciBzaGFwZSA9IGNhbnZhcy5mYWJyaWMuZ2V0QWN0aXZlT2JqZWN0KCk7XHJcblxyXG4gICAgICAgICAgICBmYWJyaWMudXRpbC5sb2FkSW1hZ2UodXJsLCBmdW5jdGlvbihpbWcpIHtcclxuICAgICAgICAgICAgICAgIHNoYXBlLnNldFBhdHRlcm5GaWxsKHsgc291cmNlOiBpbWcgfSk7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBhZGRUb0NhbnZhczogZnVuY3Rpb24oc2hhcGUpIHtcclxuICAgICAgICAgICAgaWYgKCAhIHRoaXMuc2hhcGVFeGlzdHMoc2hhcGUpKSByZXR1cm47XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWQgPSBzaGFwZTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coc2hhcGUpO1xyXG4gICAgICAgICAgICBqUXVlcnkoXCIjc2hhcGVCZ0NvbG9yXCIpLnNwZWN0cnVtKFwic2V0XCIsIHNoYXBlLmZpbGwpO1xyXG4gICAgICAgICAgICAvLyBpZihzaGFwZS5zdHJva2UpIGpRdWVyeShcIiNib3JkZXJzdHJva2VcIikuc3BlY3RydW0oXCJzZXRcIiwgc2hhcGUuc3Ryb2tlLmNvbG9yKTtcclxuICAgICAgICAgICAgLy8gaWYoc2hhcGUuc2hhZG93KSBqUXVlcnkoXCIjc2hhZG93Y29sb3JcIikuc3BlY3RydW0oXCJzZXRcIiwgc2hhcGUuc2hhZG93LmNvbG9yKTtcclxuXHJcbiAgICAgICAgICAgIC8vd2UgbWlnaHQgbmVlZCB0byBlbmFibGUgYSBkcmF3aW5nIG1vZGUgaW5zdGVhZFxyXG4gICAgICAgICAgICAvL29mIGFkZGVkIGEgc2hhcGUgdG8gY2FudmFzIGlmIHdlIGdldCBwYXNzZWQgcG9seWdvblxyXG4gICAgICAgICAgICBpZiAoc2hhcGUuc2VydmljZSAmJiBzaGFwZS5zZXJ2aWNlLmVuYWJsZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNoYXBlLnNlcnZpY2UuZW5hYmxlKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBmYWJyaWNTaGFwZSA9IHRoaXMuY3JlYXRlTmV3U2hhcGUoc2hhcGUpO1xyXG5cclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5hZGQoZmFicmljU2hhcGUpO1xyXG4gICAgICAgICAgICBjYW52YXMuY2VudGVyKGZhYnJpY1NoYXBlKTtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3QoZmFicmljU2hhcGUpO1xyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkU2hhcGUgPSBmYWJyaWNTaGFwZTtcclxuXHJcbiAgICAgICAgICAgIGhpc3RvcnkuYWRkKCdBZGRlZDogJytzaGFwZS5uYW1lLCAncGFub3JhbWEtdmVydGljYWwnKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBhcHBseVZhbHVlOiBmdW5jdGlvbihncm91cCwgbmFtZSwgb3B0aW9uLCB2YWx1ZSkge1xyXG4gICAgICAgICAgICB2YXIgc2V0dGVyID0gJ3NldCcrZmFicmljLnV0aWwuc3RyaW5nLmNhcGl0YWxpemUob3B0aW9uLCB0cnVlKSxcclxuICAgICAgICAgICAgICAgIHNoYXBlICA9IHRoaXMuZ2V0U2hhcGUobmFtZSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoZ3JvdXAgPT09ICdzaGFkb3cnKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hcHBseVNoYWRvd1ZhbHVlKHNoYXBlLCBvcHRpb24sIHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWQgJiYgdGhpcy5zZWxlY3RlZC5uYW1lID09PSBuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzZXR0ZXIpO1xyXG4gICAgICAgICAgICAgICAgLy91c2Ugc2V0dGVyIGlmIGF2YWlsYWJsZSwgb3RoZXIgc2ltcGx5IGFzc2lnbiB0aGUgdmFsdWVcclxuICAgICAgICAgICAgICAgIHNoYXBlW3NldHRlcl0gPyBzaGFwZVtzZXR0ZXJdKHZhbHVlKSA6IHNoYXBlW29wdGlvbl0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIHNoYXBlLnNldENvb3JkcygpO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3Qoc2hhcGUpO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGFwcGx5U2hhZG93VmFsdWU6IGZ1bmN0aW9uKHNoYXBlLCBvcHRpb24sIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGlmICggISBzaGFwZSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgICBjb2xvcjogdGhpcy5zZWxlY3RlZC5vcHRpb25zLnNoYWRvdy5jb2xvci5jdXJyZW50LFxyXG4gICAgICAgICAgICAgICAgYmx1cjogdGhpcy5zZWxlY3RlZC5vcHRpb25zLnNoYWRvdy5ibHVyLmN1cnJlbnQsXHJcbiAgICAgICAgICAgICAgICBvZmZzZXRYOiB0aGlzLnNlbGVjdGVkLm9wdGlvbnMuc2hhZG93Lm9mZnNldFguY3VycmVudCxcclxuICAgICAgICAgICAgICAgIG9mZnNldFk6IHRoaXMuc2VsZWN0ZWQub3B0aW9ucy5zaGFkb3cub2Zmc2V0WS5jdXJyZW50XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBpZiAob3B0aW9uICYmIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBvcHRpb25zW29wdGlvbl0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2hhcGUuc2V0U2hhZG93KG9wdGlvbnMpO1xyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHRvZ2dsZVNoYWRvdzogZnVuY3Rpb24obmFtZSwgb24pIHtcclxuICAgICAgICAgICAgaWYgKG9uKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFwcGx5U2hhZG93VmFsdWUodGhpcy5nZXRTaGFwZShuYW1lKSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldFNoYXBlKG5hbWUpLnNldFNoYWRvdyhmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVG9nZ2xlIGJvcmRlciBvbi9vZmYgb24gYWN0aXZlIG9iamVjdCBpbiB0aGUgY2FudmFzLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIG5hbWVcclxuICAgICAgICAgKiBAcGFyYW0gb25cclxuICAgICAgICAgKi9cclxuICAgICAgICB0b2dnbGVCb3JkZXI6IGZ1bmN0aW9uKG5hbWUsIG9uKSB7XHJcbiAgICAgICAgICAgIGlmIChvbikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRTaGFwZShuYW1lKS5zZXRTdHJva2UodGhpcy5zZWxlY3RlZC5vcHRpb25zLmJvcmRlci5zdHJva2UpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRTaGFwZShuYW1lKS5zZXRTdHJva2UoZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHNoYXBlRXhpc3RzOiBmdW5jdGlvbihzaGFwZSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuYXZhaWxhYmxlLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hdmFpbGFibGVbaV0ubmFtZSA9PT0gc2hhcGUubmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogUmV0dXJuIGEgZmlyc3QgYXZhaWxhYmxlIGZhYnJpYyBvYmplY3QgdGhhdCBtYXRjaGVzIGdpdmVuIG5hbWUuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gbmFtZVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtmYWJyaWMuT2JqZWN0fCp9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0U2hhcGU6IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICAgICAgdmFyIGFjdGl2ZSA9IGNhbnZhcy5mYWJyaWMuZ2V0QWN0aXZlT2JqZWN0KCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoYWN0aXZlICYmIGFjdGl2ZS5uYW1lID09PSBuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYWN0aXZlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLmZvckVhY2hPYmplY3QoZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAob2JqLm5hbWUgPT09IG5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLnNldEFjdGl2ZU9iamVjdChvYmopO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3RpdmUgPSBvYmo7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGFjdGl2ZTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDcmVhdGUgbmV3IGZhYnJpYyBzaGFwZSBmcm9tIGdpdmVuIGNvbmZpZyBvYmplY3QuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gc2hhcGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBjcmVhdGVOZXdTaGFwZTogZnVuY3Rpb24oc2hhcGUpIHtcclxuICAgICAgICAgICAgdmFyIHNoYXBlTmFtZSA9IGZhYnJpYy51dGlsLnN0cmluZy5jYXBpdGFsaXplKHNoYXBlLm5hbWUsIHRydWUpO1xyXG5cclxuICAgICAgICAgICAgY29uc29sZS5sb2coc2hhcGUpO1xyXG4gICAgICAgICAgICBpZiAoZmFicmljW3NoYXBlTmFtZV0pIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgICAgICAgICBzdHJva2VXaWR0aDogc2hhcGUub3B0aW9ucy5ib3JkZXIuc3Ryb2tlV2lkdGguY3VycmVudCxcclxuICAgICAgICAgICAgICAgICAgICBmaWxsOiBzaGFwZS5vcHRpb25zLm1haW4uZmlsbC5jdXJyZW50XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzaGFwZS5vcHRpb25zLm1haW4sIGZ1bmN0aW9uKHZhbCwga2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWwgIT09ICdib29sZWFuJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnNba2V5XSA9IHZhbC5jdXJyZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzaGFwZS5vcHRpb25zLnBvaW50cykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdTaGFwZSA9IG5ldyBmYWJyaWNbc2hhcGVOYW1lXShzaGFwZS5vcHRpb25zLnBvaW50cy5jdXJyZW50LCBvcHRpb25zKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld1NoYXBlID0gbmV3IGZhYnJpY1tzaGFwZU5hbWVdKG9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIG5ld1NoYXBlLm5hbWUgPSBzaGFwZS5uYW1lO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXdTaGFwZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHNlbGVjdFNoYXBlOiBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgICAgIGlmICggISBuYW1lIHx8IHRoaXMuc2VsZWN0ZWQubmFtZSA9PT0gbmFtZSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmF2YWlsYWJsZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYXZhaWxhYmxlW2ldLm5hbWUgPT09IG5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3RlZCA9IHRoaXMuYXZhaWxhYmxlW2ldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgY2lyY2xlT3B0aW9ucyA9IGFuZ3VsYXIuY29weShzaGFwZXMuYmFzZU9wdGlvbnMpO1xyXG4gICAgY2lyY2xlT3B0aW9ucy5tYWluLnJhZGl1cyA9IHsgdHlwZTogJ3NsaWRlcicsIGN1cnJlbnQ6IDcyLCBtaW46IDIwIH07XHJcblxyXG4gICAgc2hhcGVzLmF2YWlsYWJsZS5wdXNoKHtcclxuICAgICAgICBuYW1lOiAnY2lyY2xlJyxcclxuICAgICAgICBvcHRpb25zOiBjaXJjbGVPcHRpb25zXHJcbiAgICB9KTtcclxuXHJcbiAgICB2YXIgcmVjdE9wdGlvbnMgPSBhbmd1bGFyLmNvcHkoc2hhcGVzLmJhc2VPcHRpb25zKTtcclxuICAgIHJlY3RPcHRpb25zLm1haW4ud2lkdGggPSB7IHR5cGU6ICdzbGlkZXInLCBjdXJyZW50OiAxNDAgfTtcclxuICAgIHJlY3RPcHRpb25zLm1haW4uaGVpZ2h0ID0geyB0eXBlOiAnc2xpZGVyJywgY3VycmVudDogMTQwIH07XHJcblxyXG4gICAgc2hhcGVzLmF2YWlsYWJsZS5wdXNoKHtcclxuICAgICAgICBuYW1lOiAncmVjdCcsXHJcbiAgICAgICAgZGlzcGxheU5hbWU6ICdyZWN0YW5nbGUnLFxyXG4gICAgICAgIG9wdGlvbnM6IHJlY3RPcHRpb25zXHJcbiAgICB9KTtcclxuXHJcbiAgICB2YXIgdHJpYW5nbGVPcHRpb25zID0gYW5ndWxhci5jb3B5KHNoYXBlcy5iYXNlT3B0aW9ucyk7XHJcbiAgICB0cmlhbmdsZU9wdGlvbnMubWFpbi53aWR0aCA9IHsgdHlwZTogJ3NsaWRlcicsIGN1cnJlbnQ6IDE0MCwgbWluOiAyNSB9O1xyXG4gICAgdHJpYW5nbGVPcHRpb25zLm1haW4uaGVpZ2h0ID0geyB0eXBlOiAnc2xpZGVyJywgY3VycmVudDogMTQwLCBtaW46IDI1IH07XHJcblxyXG4gICAgc2hhcGVzLmF2YWlsYWJsZS5wdXNoKHtcclxuICAgICAgICBuYW1lOiAndHJpYW5nbGUnLFxyXG4gICAgICAgIG9wdGlvbnM6IHRyaWFuZ2xlT3B0aW9uc1xyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIGVsbGlwc2UgPSBhbmd1bGFyLmNvcHkoc2hhcGVzLmJhc2VPcHRpb25zKTtcclxuICAgIGVsbGlwc2UubWFpbi5yeCA9IHsgdHlwZTogJ3NsaWRlcicsIGN1cnJlbnQ6IDgwLCBkaXNwbGF5TmFtZTogJ2hvcml6b250YWwgcmFkaXVzJyB9O1xyXG4gICAgZWxsaXBzZS5tYWluLnJ5ID0geyB0eXBlOiAnc2xpZGVyJywgY3VycmVudDogMzAsIGRpc3BsYXlOYW1lOiAndmVydGljYWwgcmFkaXVzJyB9O1xyXG5cclxuICAgIHNoYXBlcy5hdmFpbGFibGUucHVzaCh7XHJcbiAgICAgICAgbmFtZTogJ2VsbGlwc2UnLFxyXG4gICAgICAgIG9wdGlvbnM6IGVsbGlwc2VcclxuICAgIH0pO1xyXG5cclxuICAgIHNoYXBlcy5hdmFpbGFibGUucHVzaCh7XHJcbiAgICAgICAgbmFtZTogJ3BvbHlnb24nLCAgb3B0aW9uczogYW5ndWxhci5jb3B5KHNoYXBlcy5iYXNlT3B0aW9ucyksIHNlcnZpY2U6IHBvbHlnb25cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBzaGFwZXM7XHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnaW1hZ2Uuc2hhcGVzJylcclxuXHJcbi5zZXJ2aWNlKCdwb2x5Z29uJywgWyckcm9vdFNjb3BlJywgJyRtZERpYWxvZycsICdjYW52YXMnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJG1kRGlhbG9nLCBjYW52YXMpIHtcclxuXHJcbiAgICB2YXIgc2VsZiA9IHtcclxuXHJcbiAgICAgICAgbW9kZTogJ2FkZCcsXHJcbiAgICAgICAgY3VycmVudFNoYXBlOiBmYWxzZSxcclxuXHJcbiAgICAgICAgb25Nb3VzZU1vdmU6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBwb3MgPSBjYW52YXMuZmFicmljLmdldFBvaW50ZXIoZXZlbnQuZSk7XHJcbiAgICAgICAgICAgIGlmIChzZWxmLm1vZGUgPT09IFwiZWRpdFwiICYmIHNlbGYuY3VycmVudFNoYXBlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcG9pbnRzID0gc2VsZi5jdXJyZW50U2hhcGUuZ2V0KFwicG9pbnRzXCIpO1xyXG4gICAgICAgICAgICAgICAgcG9pbnRzW3BvaW50cy5sZW5ndGggLSAxXS54ID0gcG9zLnggLSBzZWxmLmN1cnJlbnRTaGFwZS5nZXQoXCJsZWZ0XCIpO1xyXG4gICAgICAgICAgICAgICAgcG9pbnRzW3BvaW50cy5sZW5ndGggLSAxXS55ID0gcG9zLnkgLSBzZWxmLmN1cnJlbnRTaGFwZS5nZXQoXCJ0b3BcIik7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRTaGFwZS5zZXQoe1xyXG4gICAgICAgICAgICAgICAgICAgIHBvaW50czogcG9pbnRzXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBvbk1vdXNlRG93bjogZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgdmFyIHBvcyA9IGNhbnZhcy5mYWJyaWMuZ2V0UG9pbnRlcihldmVudC5lKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChzZWxmLm1vZGUgPT09IFwiYWRkXCIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwb2x5ID0gbmV3IGZhYnJpYy5Qb2x5Z29uKFt7XHJcbiAgICAgICAgICAgICAgICAgICAgeDogcG9zLngsXHJcbiAgICAgICAgICAgICAgICAgICAgeTogcG9zLnlcclxuICAgICAgICAgICAgICAgIH0sIHtcclxuICAgICAgICAgICAgICAgICAgICB4OiBwb3MueCArIDAuNSxcclxuICAgICAgICAgICAgICAgICAgICB5OiBwb3MueSArIDAuNVxyXG4gICAgICAgICAgICAgICAgfV0sIHtcclxuICAgICAgICAgICAgICAgICAgICBmaWxsOiAnYmxhY2snLFxyXG4gICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0YWJsZTogZmFsc2VcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50U2hhcGUgPSBwb2x5O1xyXG4gICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50U2hhcGUubmFtZSA9ICdwb2x5Z29uJztcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuYWRkKHNlbGYuY3VycmVudFNoYXBlKTtcclxuICAgICAgICAgICAgICAgIHNlbGYubW9kZSA9IFwiZWRpdFwiO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHNlbGYubW9kZSA9PT0gXCJlZGl0XCIgJiYgc2VsZi5jdXJyZW50U2hhcGUgJiYgc2VsZi5jdXJyZW50U2hhcGUudHlwZSA9PT0gXCJwb2x5Z29uXCIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwb2ludHMgPSBzZWxmLmN1cnJlbnRTaGFwZS5nZXQoXCJwb2ludHNcIik7XHJcbiAgICAgICAgICAgICAgICBwb2ludHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgeDogcG9zLnggLSBzZWxmLmN1cnJlbnRTaGFwZS5nZXQoXCJsZWZ0XCIpLFxyXG4gICAgICAgICAgICAgICAgICAgIHk6IHBvcy55IC0gc2VsZi5jdXJyZW50U2hhcGUuZ2V0KFwidG9wXCIpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudFNoYXBlLnNldCh7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRzOiBwb2ludHNcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIG9uRXNjYXBlOiBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIGlmICgoIWUgJiYgc2VsZi5jdXJyZW50U2hhcGUpIHx8IGUgJiYgZS5rZXlDb2RlID09PSAyNykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHNlbGYubW9kZSA9PT0gJ2VkaXQnIHx8IHNlbGYubW9kZSA9PT0gJ2FkZCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLm1vZGUgPSAnbm9ybWFsJztcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRTaGFwZS5zZXQoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RhYmxlOiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudFNoYXBlLl9jYWxjRGltZW5zaW9ucygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudFNoYXBlLnNldENvb3JkcygpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLnNldEFjdGl2ZU9iamVjdChzZWxmLmN1cnJlbnRTaGFwZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5tb2RlID0gJ2FkZCc7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50U2hhcGUgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgb25DbGljazogZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICB2YXIgY2xpY2tlZEluTW9kYWwgPSAkKGUudGFyZ2V0KS5jbG9zZXN0KCcubWQtZGlhbG9nLWNvbnRhaW5lcicpWzBdO1xyXG5cclxuICAgICAgICAgICAgaWYgKGUudGFyZ2V0Lm5vZGVOYW1lICE9PSAnQ0FOVkFTJyAmJiAkKGUudGFyZ2V0KS5jbG9zZXN0KCcuc2hhcGUnKS5kYXRhKCduYW1lJykgIT09ICdwb2x5Z29uJyAmJiAhY2xpY2tlZEluTW9kYWwpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuZGlzYWJsZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZW5hYmxlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlZCkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5lbmFibGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5vbignbW91c2U6bW92ZScsIHNlbGYub25Nb3VzZU1vdmUpO1xyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLm9uKCdtb3VzZTpkb3duJywgc2VsZi5vbk1vdXNlRG93bik7XHJcbiAgICAgICAgICAgIGZhYnJpYy51dGlsLmFkZExpc3RlbmVyKHdpbmRvdywgJ2tleXVwJywgc2VsZi5vbkVzY2FwZSk7XHJcblxyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgZmFicmljLnV0aWwuYWRkTGlzdGVuZXIod2luZG93LCAnY2xpY2snLCBzZWxmLm9uQ2xpY2spO1xyXG4gICAgICAgICAgICB9LCAyMCk7XHJcblxyXG4gICAgICAgICAgICAkbWREaWFsb2cuc2hvdyh7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZGFscy9wb2x5Z29uLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgJyRtZERpYWxvZycsIGZ1bmN0aW9uKCRzY29wZSwgJG1kRGlhbG9nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNsb3NlTW9kYWwgPSAkbWREaWFsb2cuaGlkZTtcclxuICAgICAgICAgICAgICAgIH1dXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGRpc2FibGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmVuYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5vZmYoJ21vdXNlOm1vdmUnLCBzZWxmLm9uTW91c2VNb3ZlKTtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5vZmYoJ21vdXNlOmRvd24nLCBzZWxmLm9uTW91c2VEb3duKTtcclxuICAgICAgICAgICAgZmFicmljLnV0aWwucmVtb3ZlTGlzdGVuZXIod2luZG93LCAna2V5dXAnLCBzZWxmLm9uRXNjYXBlKTtcclxuICAgICAgICAgICAgZmFicmljLnV0aWwucmVtb3ZlTGlzdGVuZXIod2luZG93LCAnY2xpY2snLCBzZWxmLm9uQ2xpY2spO1xyXG4gICAgICAgICAgICBzZWxmLm9uRXNjYXBlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gc2VsZjtcclxuXHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnSW1hZ2VFZGl0b3InKVxyXG5cclxuLmNvbnRyb2xsZXIoJ09iamVjdHNQYW5lbENvbnRyb2xsZXInLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJyR0aW1lb3V0JywgJ2NhbnZhcycsIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgJHRpbWVvdXQsIGNhbnZhcykge1xyXG5cdCRzY29wZS5vYmplY3RzID0gY2FudmFzLmZhYnJpYy5fb2JqZWN0cyB8fCBbXTtcclxuICAgICRyb290U2NvcGUuYWN0aXZlT2JqZWN0ID0gZmFsc2U7XHJcbiAgICAkc2NvcGUuc29ydGFibGVPcHRpb25zID0ge1xyXG4gICAgICAgIGl0ZW1zOiAnLm9iamVjdDp2aXNpYmxlJyxcclxuICAgICAgICBzY3JvbGw6IGZhbHNlLFxyXG4gICAgICAgIGNvbnRhaW5tZW50OiAncGFyZW50JyxcclxuICAgICAgICBzdGFydDogZnVuY3Rpb24oZSwgdWkpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJTdGFydFwiKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2codWkuaXRlbS5pbmRleCgpKTtcclxuICAgICAgICAgICAgdWkuaXRlbS5kYXRhKCdzdGFydCcsIHVpLml0ZW0uaW5kZXgoKSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzdG9wOiBmdW5jdGlvbihlLCB1aSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlN0b3BcIik7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHVpLml0ZW0uaW5kZXgoKSk7XHJcblxyXG5cclxuXHJcbiAgICAgICAgfSxcclxuICAgICAgICB1cGRhdGU6IGZ1bmN0aW9uKGUsIHVpKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVXBkYXRlXCIpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyh1aS5pdGVtLmluZGV4KCkpO1xyXG5cclxuICAgICAgICAgICAgdmFyIHN0YXJ0ID0gdWkuaXRlbS5kYXRhKCdzdGFydCcpLFxyXG4gICAgICAgICAgICAgICAgZW5kICAgPSB1aS5pdGVtLmluZGV4KCk7XHJcblxyXG5cclxuICAgICAgICAgICAgb2JqID0gY2FudmFzLmZhYnJpYy5nZXRPYmplY3RzKClbc3RhcnRdO1xyXG5cclxuICAgICAgICAgICAgaWYgKCAhIG9iaikgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgaWYgKGVuZCA+IHN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAvL3NlbmQgb2JqZWN0IGZvcndhcmRzIGJ5IHRoZSBhbW91bnQgb2Ygb2JqZWN0cyBpdCBwYXNzZWRcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgKGVuZCAtIHN0YXJ0KTsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5icmluZ0ZvcndhcmQob2JqKTtcclxuICAgICAgICAgICAgICAgICAgICAvL2NhbnZhcy5mYWJyaWMuc2VuZEJhY2t3YXJkcyhvYmopO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy9zZW5kIG9iamVjdCBiYWNrd2FyZHMgYnkgdGhlIGFtb3VudCBvZiBvYmplY3RzIGl0IHBhc3NlZFxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAoc3RhcnQgLSBlbmQpOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLnNlbmRCYWNrd2FyZHMob2JqKTtcclxuICAgICAgICAgICAgICAgICAgICAvL2NhbnZhcy5mYWJyaWMuYnJpbmdGb3J3YXJkKG9iaik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuICAgICAgICAgICAgICAgIHN0YXJ0ID0gZmFsc2U7IGVuZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgJHNjb3BlLnNldEFzQWN0aXZlID0gZnVuY3Rpb24ob2JqZWN0KSB7XHJcbiAgICAgICAgaWYgKG9iamVjdCkge1xyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLnNldEFjdGl2ZU9iamVjdChvYmplY3QpO1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZU9iamVjdCA9IG9iamVjdDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS50b2dnbGVWaXNpYmlsaXR5ID0gZnVuY3Rpb24ob2JqZWN0KSB7XHJcbiAgICAgICAgaWYgKCAhIG9iamVjdCkgcmV0dXJuO1xyXG5cclxuICAgICAgICBpZiAob2JqZWN0LnZpc2libGUpIHtcclxuICAgICAgICAgICAgb2JqZWN0LnNldCh7IHZpc2libGU6IGZhbHNlLCBldmVudGVkOiBmYWxzZSwgc2VsZWN0YWJsZTogZmFsc2UsIGhhc0JvcmRlcnM6IGZhbHNlLCBoYXNDb3JuZXJzOiBmYWxzZSB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBvYmplY3Quc2V0KHsgdmlzaWJsZTogdHJ1ZSwgZXZlbnRlZDogdHJ1ZSwgc2VsZWN0YWJsZTogdHJ1ZSwgaGFzQm9yZGVyczogdHJ1ZSwgaGFzQ29ybmVyczogdHJ1ZSB9KTtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3Qob2JqZWN0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5kZWxldGVPYmplY3QgPSBmdW5jdGlvbihvYmplY3QpIHtcclxuICAgICAgICBpZiAob2JqZWN0KSB7XHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVtb3ZlKG9iamVjdCk7XHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUudG9nZ2xlTG9jayA9IGZ1bmN0aW9uKG9iamVjdCkge1xyXG4gICAgICAgIGlmICggISBvYmplY3QpIHJldHVybjtcclxuXHJcbiAgICAgICAgaWYgKG9iamVjdC5sb2NrZWQpIHtcclxuICAgICAgICAgICAgb2JqZWN0LnNldCh7XHJcbiAgICAgICAgICAgICAgICBsb2NrZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0YWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGV2ZW50ZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBsb2NrTW92ZW1lbnRYOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGxvY2tNb3ZlbWVudFk6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgbG9ja1JvdGF0aW9uOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGxvY2tTY2FsaW5nWDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBsb2NrU2NhbGluZ1k6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgbG9ja1VuaVNjYWxpbmc6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgaGFzQ29udHJvbHM6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBoYXNCb3JkZXJzOiB0cnVlXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3Qob2JqZWN0KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBvYmplY3Quc2V0KHtcclxuICAgICAgICAgICAgICAgIGxvY2tlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdGFibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgZXZlbnRlZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBsb2NrTW92ZW1lbnRYOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgbG9ja01vdmVtZW50WTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGxvY2tSb3RhdGlvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGxvY2tTY2FsaW5nWDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGxvY2tTY2FsaW5nWTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGxvY2tVbmlTY2FsaW5nOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgaGFzQ29udHJvbHM6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgaGFzQm9yZGVyczogZmFsc2VcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgfVxyXG59XSlcclxuLmZpbHRlcigncmV2ZXJzZScsIGZ1bmN0aW9uKCkge1xyXG4gIHJldHVybiBmdW5jdGlvbihpdGVtcykge1xyXG4gICAgcmV0dXJuIGl0ZW1zLnNsaWNlKCkucmV2ZXJzZSgpO1xyXG4gIH07XHJcbn0pOyJdfQ==
