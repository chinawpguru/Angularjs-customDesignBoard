var colorsForPicker = ['#D24D57', '#F22613', '#D91E18', '#96281B', '#EF4836', '#D64541', '#C0392B', '#CF000F', '#E74C3C', '#DB0A5B', '#F64747', '#F1A9A0', '#D2527F', '#E08283', '#F62459', '#E26A6A', '#DCC6E0', '#663399', '#674172', '#AEA8D3', '#913D88', '#9A12B3', '#BF55EC', '#BE90D4', '#8E44AD', '#9B59B6', '#446CB3', '#E4F1FE', '#4183D7', '#59ABE3', '#81CFE0', '#52B3D9', '#C5EFF7', '#22A7F0', '#3498DB', '#2C3E50', '#19B5FE', '#336E7B', '#22313F', '#6BB9F0', '#1E8BC3', '#3A539B', '#34495E', '#67809F', '#2574A9', '#1F3A93', '#89C4F4', '#4B77BE', '#5C97BF', '#4ECDC4', '#A2DED0', '#87D37C', '#90C695', '#26A65B', '#03C9A9', '#68C3A3', '#65C6BB', '#1BBC9B', '#1BA39C', '#66CC99', '#36D7B7', '#C8F7C5', '#86E2D5', '#2ECC71', '#16a085', '#3FC380', '#019875', '#03A678', '#4DAF7C', '#2ABB9B', '#00B16A', '#1E824C', '#049372', '#26C281', '#FDE3A7', '#F89406', '#EB9532', '#E87E04', '#F4B350', '#F2784B', '#EB974E', '#F5AB35', '#D35400', '#F39C12', '#F9690E', '#F9BF3B', '#F27935', '#E67E22', '#ececec', '#6C7A89', '#D2D7D3', '#EEEEEE', '#BDC3C7', '#ECF0F1', '#95A5A6', '#DADFE1', '#ABB7B7', '#F2F1EF', '#BFBFBF', '#E6E2AF', '#A7A37E', '#EFECCA', '#046380', '#002F2F', '#468966', '#FFF0A5', '#FFB03B', '#B64926', '#8E2800', '#1E1E20'];
var edGradients = {
    1: {
        type: 'linear',
        x1: -80,
        y1: 0,
        x2: 80,
        y2: 0,
        colorStops: {
            0: '#ffe47b',
            1: 'rgb(111,154,211)'
        }
    },

    2:  {
        type: 'linear',
        x1: 0,
        y1: -120,
        x2: 0,
        y2: 120,
        colorStops: {
            0: '#ff4040',
            1: '#e6399b'
        }
    },

    3: {
        type: 'linear',
        x1: -90,
        y1: -90,
        x2: 90,
        y2: 90,
        colorStops: {
            0: 'rgb(166,111,213)',
            0.5: 'rgba(106, 72, 215, 0.5)',
            1: '#200772'
        }
    },

    4: {
        type: 'radial',
        r1: 100,
        r2: 10,
        x1: 0,
        y1: 0,
        x2: 0,
        y2: 0,
        colorStops: {
            0: '#FF4F4F',
            1: 'rgb(255, 239, 64)'
        }
    },

    5: {
        type: 'radial',
        r1: 100,
        r2: 10,
        x1: 0,
        y1: 0,
        x2: 20,
        y2: 20,
        colorStops: {
            0: '#ffe47b',
            0.5: 'rgb(111,154,211)',
            1: 'rgb(166,111,213)'
        }
    },

    6: {
        type: 'radial',
        r1: 50,
        r2: 80,
        x1: 45,
        y1: 45,
        x2: 52,
        y2: 50,
        colorStops: {
            0: 'rgb(155, 237, 0)',
            1: 'rgba(0, 164, 128,0.4)'
        }
    },

    7: {
        type: 'linear',
        x1: -90,
        y1: -90,
        x2: 90,
        y2: 90,
        colorStops: {
            0: '#9ecb2d',
            0.5: '#72aa00',
            1: '#bfd255'
        }
    },

    8: {
        type: 'radial',
        r1: 100,
        r2: 50,
        x1: 30,
        y1: 0,
        x2: 0,
        y2: 0,
        colorStops: {
            0: '#aebcbf',
            1: '#0a0809'
        }
    },

    9: {
        type: 'linear',
        x1: -80,
        y1: 0,
        x2: 80,
        y2: 0,
        colorStops: {
            0: '#ffffff',
            1: '#f6f6f6'
        }
    },
    10:  {
        type: 'linear',
        x1: 0,
        y1: -120,
        x2: 0,
        y2: 120,
        colorStops: {
            0: '#fefcea',
            1: '#f1da36'
        }
    },
    11: {
        type: 'linear',
        x1: -90,
        y1: -90,
        x2: 90,
        y2: 90,
        colorStops: {
            0: 'rgb(166,111,213)',
            0.5: 'rgba(106, 72, 215, 0.5)',
            1: '#ff1a00'
        }
    },
    12:  {
        type: 'linear',
        x1: 0,
        y1: -120,
        x2: 0,
        y2: 120,
        colorStops: {
            0: '#b7deed',
            1: '#21b4e2'
        }
    },
    13: {
        type: 'linear',
        x1: -80,
        y1: 100,
        x2: 80,
        y2: -100,
        colorStops: {
            0: '#ffe47b',
            1: 'rgb(111,154,211)'
        }
    },
};
/*! jQuery v2.1.3 | (c) 2005, 2014 jQuery Foundation, Inc. | jquery.org/license */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k={},l=a.document,m="2.1.3",n=function(a,b){return new n.fn.init(a,b)},o=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,p=/^-ms-/,q=/-([\da-z])/gi,r=function(a,b){return b.toUpperCase()};n.fn=n.prototype={jquery:m,constructor:n,selector:"",length:0,toArray:function(){return d.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:d.call(this)},pushStack:function(a){var b=n.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return n.each(this,a,b)},map:function(a){return this.pushStack(n.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:c.sort,splice:c.splice},n.extend=n.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||n.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(n.isPlainObject(d)||(e=n.isArray(d)))?(e?(e=!1,f=c&&n.isArray(c)?c:[]):f=c&&n.isPlainObject(c)?c:{},g[b]=n.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},n.extend({expando:"jQuery"+(m+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===n.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return!n.isArray(a)&&a-parseFloat(a)+1>=0},isPlainObject:function(a){return"object"!==n.type(a)||a.nodeType||n.isWindow(a)?!1:a.constructor&&!j.call(a.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?h[i.call(a)]||"object":typeof a},globalEval:function(a){var b,c=eval;a=n.trim(a),a&&(1===a.indexOf("use strict")?(b=l.createElement("script"),b.text=a,l.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(a){return a.replace(p,"ms-").replace(q,r)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var d,e=0,f=a.length,g=s(a);if(c){if(g){for(;f>e;e++)if(d=b.apply(a[e],c),d===!1)break}else for(e in a)if(d=b.apply(a[e],c),d===!1)break}else if(g){for(;f>e;e++)if(d=b.call(a[e],e,a[e]),d===!1)break}else for(e in a)if(d=b.call(a[e],e,a[e]),d===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(o,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(s(Object(a))?n.merge(c,"string"==typeof a?[a]:a):f.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:g.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,f=0,g=a.length,h=s(a),i=[];if(h)for(;g>f;f++)d=b(a[f],f,c),null!=d&&i.push(d);else for(f in a)d=b(a[f],f,c),null!=d&&i.push(d);return e.apply([],i)},guid:1,proxy:function(a,b){var c,e,f;return"string"==typeof b&&(c=a[b],b=a,a=c),n.isFunction(a)?(e=d.call(arguments,2),f=function(){return a.apply(b||this,e.concat(d.call(arguments)))},f.guid=a.guid=a.guid||n.guid++,f):void 0},now:Date.now,support:k}),n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){h["[object "+b+"]"]=b.toLowerCase()});function s(a){var b=a.length,c=n.type(a);return"function"===c||n.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}var t=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+1*new Date,v=a.document,w=0,x=0,y=hb(),z=hb(),A=hb(),B=function(a,b){return a===b&&(l=!0),0},C=1<<31,D={}.hasOwnProperty,E=[],F=E.pop,G=E.push,H=E.push,I=E.slice,J=function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1},K="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",N=M.replace("w","w#"),O="\\["+L+"*("+M+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+N+"))|)"+L+"*\\]",P=":("+M+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+O+")*)|.*)\\)|)",Q=new RegExp(L+"+","g"),R=new RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),S=new RegExp("^"+L+"*,"+L+"*"),T=new RegExp("^"+L+"*([>+~]|"+L+")"+L+"*"),U=new RegExp("="+L+"*([^\\]'\"]*?)"+L+"*\\]","g"),V=new RegExp(P),W=new RegExp("^"+N+"$"),X={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+O),PSEUDO:new RegExp("^"+P),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),bool:new RegExp("^(?:"+K+")$","i"),needsContext:new RegExp("^"+L+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+L+"*((?:-\\d)?\\d*)"+L+"*\\)|)(?=[^-]|$)","i")},Y=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,_=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ab=/[+~]/,bb=/'|\\/g,cb=new RegExp("\\\\([\\da-f]{1,6}"+L+"?|("+L+")|.)","ig"),db=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},eb=function(){m()};try{H.apply(E=I.call(v.childNodes),v.childNodes),E[v.childNodes.length].nodeType}catch(fb){H={apply:E.length?function(a,b){G.apply(a,I.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function gb(a,b,d,e){var f,h,j,k,l,o,r,s,w,x;if((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,d=d||[],k=b.nodeType,"string"!=typeof a||!a||1!==k&&9!==k&&11!==k)return d;if(!e&&p){if(11!==k&&(f=_.exec(a)))if(j=f[1]){if(9===k){if(h=b.getElementById(j),!h||!h.parentNode)return d;if(h.id===j)return d.push(h),d}else if(b.ownerDocument&&(h=b.ownerDocument.getElementById(j))&&t(b,h)&&h.id===j)return d.push(h),d}else{if(f[2])return H.apply(d,b.getElementsByTagName(a)),d;if((j=f[3])&&c.getElementsByClassName)return H.apply(d,b.getElementsByClassName(j)),d}if(c.qsa&&(!q||!q.test(a))){if(s=r=u,w=b,x=1!==k&&a,1===k&&"object"!==b.nodeName.toLowerCase()){o=g(a),(r=b.getAttribute("id"))?s=r.replace(bb,"\\$&"):b.setAttribute("id",s),s="[id='"+s+"'] ",l=o.length;while(l--)o[l]=s+rb(o[l]);w=ab.test(a)&&pb(b.parentNode)||b,x=o.join(",")}if(x)try{return H.apply(d,w.querySelectorAll(x)),d}catch(y){}finally{r||b.removeAttribute("id")}}}return i(a.replace(R,"$1"),b,d,e)}function hb(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}return b}function ib(a){return a[u]=!0,a}function jb(a){var b=n.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function kb(a,b){var c=a.split("|"),e=a.length;while(e--)d.attrHandle[c[e]]=b}function lb(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||C)-(~a.sourceIndex||C);if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function mb(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function nb(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function ob(a){return ib(function(b){return b=+b,ib(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function pb(a){return a&&"undefined"!=typeof a.getElementsByTagName&&a}c=gb.support={},f=gb.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},m=gb.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement?(n=g,o=g.documentElement,e=g.defaultView,e&&e!==e.top&&(e.addEventListener?e.addEventListener("unload",eb,!1):e.attachEvent&&e.attachEvent("onunload",eb)),p=!f(g),c.attributes=jb(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=jb(function(a){return a.appendChild(g.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=$.test(g.getElementsByClassName),c.getById=jb(function(a){return o.appendChild(a).id=u,!g.getElementsByName||!g.getElementsByName(u).length}),c.getById?(d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},d.filter.ID=function(a){var b=a.replace(cb,db);return function(a){return a.getAttribute("id")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(cb,db);return function(a){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){return p?b.getElementsByClassName(a):void 0},r=[],q=[],(c.qsa=$.test(g.querySelectorAll))&&(jb(function(a){o.appendChild(a).innerHTML="<a id='"+u+"'></a><select id='"+u+"-\f]' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+L+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+L+"*(?:value|"+K+")"),a.querySelectorAll("[id~="+u+"-]").length||q.push("~="),a.querySelectorAll(":checked").length||q.push(":checked"),a.querySelectorAll("a#"+u+"+*").length||q.push(".#.+[+~]")}),jb(function(a){var b=g.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+L+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=$.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&jb(function(a){c.disconnectedMatch=s.call(a,"div"),s.call(a,"[s!='']:x"),r.push("!=",P)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=$.test(o.compareDocumentPosition),t=b||$.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===g||a.ownerDocument===v&&t(v,a)?-1:b===g||b.ownerDocument===v&&t(v,b)?1:k?J(k,a)-J(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,h=[a],i=[b];if(!e||!f)return a===g?-1:b===g?1:e?-1:f?1:k?J(k,a)-J(k,b):0;if(e===f)return lb(a,b);c=a;while(c=c.parentNode)h.unshift(c);c=b;while(c=c.parentNode)i.unshift(c);while(h[d]===i[d])d++;return d?lb(h[d],i[d]):h[d]===v?-1:i[d]===v?1:0},g):n},gb.matches=function(a,b){return gb(a,null,null,b)},gb.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(U,"='$1']"),!(!c.matchesSelector||!p||r&&r.test(b)||q&&q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return gb(b,n,null,[a]).length>0},gb.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},gb.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&D.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},gb.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},gb.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return k=null,a},e=gb.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=gb.selectors={cacheLength:50,createPseudo:ib,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(cb,db),a[3]=(a[3]||a[4]||a[5]||"").replace(cb,db),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||gb.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&gb.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return X.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&V.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(cb,db).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+L+")"+a+"("+L+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=gb.attr(d,a);return null==e?"!="===b:b?(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e.replace(Q," ")+" ").indexOf(c)>-1:"|="===b?e===c||e.slice(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){while(p){l=b;while(l=l[p])if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){k=q[u]||(q[u]={}),j=k[a]||[],n=j[0]===w&&j[1],m=j[0]===w&&j[2],l=n&&q.childNodes[n];while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if(1===l.nodeType&&++m&&l===b){k[a]=[w,n,m];break}}else if(s&&(j=(b[u]||(b[u]={}))[a])&&j[0]===w)m=j[1];else while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if((h?l.nodeName.toLowerCase()===r:1===l.nodeType)&&++m&&(s&&((l[u]||(l[u]={}))[a]=[w,m]),l===b))break;return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||gb.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ib(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=J(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:ib(function(a){var b=[],c=[],d=h(a.replace(R,"$1"));return d[u]?ib(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop()}}),has:ib(function(a){return function(b){return gb(a,b).length>0}}),contains:ib(function(a){return a=a.replace(cb,db),function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:ib(function(a){return W.test(a||"")||gb.error("unsupported lang: "+a),a=a.replace(cb,db).toLowerCase(),function(b){var c;do if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return Z.test(a.nodeName)},input:function(a){return Y.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:ob(function(){return[0]}),last:ob(function(a,b){return[b-1]}),eq:ob(function(a,b,c){return[0>c?c+b:c]}),even:ob(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:ob(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:ob(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:ob(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=mb(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=nb(b);function qb(){}qb.prototype=d.filters=d.pseudos,d.setFilters=new qb,g=gb.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){(!c||(e=S.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=T.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(R," ")}),h=h.slice(c.length));for(g in d.filter)!(e=X[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?gb.error(a):z(a,i).slice(0)};function rb(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function sb(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=x++;return b.first?function(b,c,f){while(b=b[d])if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[w,f];if(g){while(b=b[d])if((1===b.nodeType||e)&&a(b,c,g))return!0}else while(b=b[d])if(1===b.nodeType||e){if(i=b[u]||(b[u]={}),(h=i[d])&&h[0]===w&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function tb(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function ub(a,b,c){for(var d=0,e=b.length;e>d;d++)gb(a,b[d],c);return c}function vb(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function wb(a,b,c,d,e,f){return d&&!d[u]&&(d=wb(d)),e&&!e[u]&&(e=wb(e,f)),ib(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||ub(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:vb(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=vb(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?J(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=vb(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):H.apply(g,r)})}function xb(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=sb(function(a){return a===b},h,!0),l=sb(function(a){return J(b,a)>-1},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e}];f>i;i++)if(c=d.relative[a[i].type])m=[sb(tb(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;f>e;e++)if(d.relative[a[e].type])break;return wb(i>1&&tb(m),i>1&&rb(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(R,"$1"),c,e>i&&xb(a.slice(i,e)),f>e&&xb(a=a.slice(e)),f>e&&rb(a))}m.push(c)}return tb(m)}function yb(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,m,o,p=0,q="0",r=f&&[],s=[],t=j,u=f||e&&d.find.TAG("*",k),v=w+=null==t?1:Math.random()||.1,x=u.length;for(k&&(j=g!==n&&g);q!==x&&null!=(l=u[q]);q++){if(e&&l){m=0;while(o=a[m++])if(o(l,g,h)){i.push(l);break}k&&(w=v)}c&&((l=!o&&l)&&p--,f&&r.push(l))}if(p+=q,c&&q!==p){m=0;while(o=b[m++])o(r,s,g,h);if(f){if(p>0)while(q--)r[q]||s[q]||(s[q]=F.call(i));s=vb(s)}H.apply(i,s),k&&!f&&s.length>0&&p+b.length>1&&gb.uniqueSort(i)}return k&&(w=v,j=t),r};return c?ib(f):f}return h=gb.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){b||(b=g(a)),c=b.length;while(c--)f=xb(b[c]),f[u]?d.push(f):e.push(f);f=A(a,yb(e,d)),f.selector=a}return f},i=gb.select=function(a,b,e,f){var i,j,k,l,m,n="function"==typeof a&&a,o=!f&&g(a=n.selector||a);if(e=e||[],1===o.length){if(j=o[0]=o[0].slice(0),j.length>2&&"ID"===(k=j[0]).type&&c.getById&&9===b.nodeType&&p&&d.relative[j[1].type]){if(b=(d.find.ID(k.matches[0].replace(cb,db),b)||[])[0],!b)return e;n&&(b=b.parentNode),a=a.slice(j.shift().value.length)}i=X.needsContext.test(a)?0:j.length;while(i--){if(k=j[i],d.relative[l=k.type])break;if((m=d.find[l])&&(f=m(k.matches[0].replace(cb,db),ab.test(j[0].type)&&pb(b.parentNode)||b))){if(j.splice(i,1),a=f.length&&rb(j),!a)return H.apply(e,f),e;break}}}return(n||h(a,o))(f,b,!p,e,ab.test(a)&&pb(b.parentNode)||b),e},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=jb(function(a){return 1&a.compareDocumentPosition(n.createElement("div"))}),jb(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||kb("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&jb(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||kb("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),jb(function(a){return null==a.getAttribute("disabled")})||kb(K,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),gb}(a);n.find=t,n.expr=t.selectors,n.expr[":"]=n.expr.pseudos,n.unique=t.uniqueSort,n.text=t.getText,n.isXMLDoc=t.isXML,n.contains=t.contains;var u=n.expr.match.needsContext,v=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/^.[^:#\[\.,]*$/;function x(a,b,c){if(n.isFunction(b))return n.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return n.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(w.test(b))return n.filter(b,a,c);b=n.filter(b,a)}return n.grep(a,function(a){return g.call(b,a)>=0!==c})}n.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?n.find.matchesSelector(d,a)?[d]:[]:n.find.matches(a,n.grep(b,function(a){return 1===a.nodeType}))},n.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(n(a).filter(function(){for(b=0;c>b;b++)if(n.contains(e[b],this))return!0}));for(b=0;c>b;b++)n.find(a,e[b],d);return d=this.pushStack(c>1?n.unique(d):d),d.selector=this.selector?this.selector+" "+a:a,d},filter:function(a){return this.pushStack(x(this,a||[],!1))},not:function(a){return this.pushStack(x(this,a||[],!0))},is:function(a){return!!x(this,"string"==typeof a&&u.test(a)?n(a):a||[],!1).length}});var y,z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,A=n.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:z.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||y).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof n?b[0]:b,n.merge(this,n.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:l,!0)),v.test(c[1])&&n.isPlainObject(b))for(c in b)n.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}return d=l.getElementById(c[2]),d&&d.parentNode&&(this.length=1,this[0]=d),this.context=l,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):n.isFunction(a)?"undefined"!=typeof y.ready?y.ready(a):a(n):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),n.makeArray(a,this))};A.prototype=n.fn,y=n(l);var B=/^(?:parents|prev(?:Until|All))/,C={children:!0,contents:!0,next:!0,prev:!0};n.extend({dir:function(a,b,c){var d=[],e=void 0!==c;while((a=a[b])&&9!==a.nodeType)if(1===a.nodeType){if(e&&n(a).is(c))break;d.push(a)}return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),n.fn.extend({has:function(a){var b=n(a,this),c=b.length;return this.filter(function(){for(var a=0;c>a;a++)if(n.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=u.test(a)||"string"!=typeof a?n(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&n.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?n.unique(f):f)},index:function(a){return a?"string"==typeof a?g.call(n(a),this[0]):g.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(n.unique(n.merge(this.get(),n(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function D(a,b){while((a=a[b])&&1!==a.nodeType);return a}n.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return n.dir(a,"parentNode")},parentsUntil:function(a,b,c){return n.dir(a,"parentNode",c)},next:function(a){return D(a,"nextSibling")},prev:function(a){return D(a,"previousSibling")},nextAll:function(a){return n.dir(a,"nextSibling")},prevAll:function(a){return n.dir(a,"previousSibling")},nextUntil:function(a,b,c){return n.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return n.dir(a,"previousSibling",c)},siblings:function(a){return n.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return n.sibling(a.firstChild)},contents:function(a){return a.contentDocument||n.merge([],a.childNodes)}},function(a,b){n.fn[a]=function(c,d){var e=n.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=n.filter(d,e)),this.length>1&&(C[a]||n.unique(e),B.test(a)&&e.reverse()),this.pushStack(e)}});var E=/\S+/g,F={};function G(a){var b=F[a]={};return n.each(a.match(E)||[],function(a,c){b[c]=!0}),b}n.Callbacks=function(a){a="string"==typeof a?F[a]||G(a):n.extend({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function(l){for(b=a.memory&&l,c=!0,g=e||0,e=0,f=h.length,d=!0;h&&f>g;g++)if(h[g].apply(l[0],l[1])===!1&&a.stopOnFalse){b=!1;break}d=!1,h&&(i?i.length&&j(i.shift()):b?h=[]:k.disable())},k={add:function(){if(h){var c=h.length;!function g(b){n.each(b,function(b,c){var d=n.type(c);"function"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&"string"!==d&&g(c)})}(arguments),d?f=h.length:b&&(e=c,j(b))}return this},remove:function(){return h&&n.each(arguments,function(a,b){var c;while((c=n.inArray(b,h,c))>-1)h.splice(c,1),d&&(f>=c&&f--,g>=c&&g--)}),this},has:function(a){return a?n.inArray(a,h)>-1:!(!h||!h.length)},empty:function(){return h=[],f=0,this},disable:function(){return h=i=b=void 0,this},disabled:function(){return!h},lock:function(){return i=void 0,b||k.disable(),this},locked:function(){return!i},fireWith:function(a,b){return!h||c&&!i||(b=b||[],b=[a,b.slice?b.slice():b],d?i.push(b):j(b)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!c}};return k},n.extend({Deferred:function(a){var b=[["resolve","done",n.Callbacks("once memory"),"resolved"],["reject","fail",n.Callbacks("once memory"),"rejected"],["notify","progress",n.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return n.Deferred(function(c){n.each(b,function(b,f){var g=n.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&n.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?n.extend(a,d):d}},e={};return d.pipe=d.then,n.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&n.isFunction(a.promise)?e:0,g=1===f?a:n.Deferred(),h=function(a,b,c){return function(e){b[a]=this,c[a]=arguments.length>1?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}},i,j,k;if(e>1)for(i=new Array(e),j=new Array(e),k=new Array(e);e>b;b++)c[b]&&n.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;return f||g.resolveWith(k,c),g.promise()}});var H;n.fn.ready=function(a){return n.ready.promise().done(a),this},n.extend({isReady:!1,readyWait:1,holdReady:function(a){a?n.readyWait++:n.ready(!0)},ready:function(a){(a===!0?--n.readyWait:n.isReady)||(n.isReady=!0,a!==!0&&--n.readyWait>0||(H.resolveWith(l,[n]),n.fn.triggerHandler&&(n(l).triggerHandler("ready"),n(l).off("ready"))))}});function I(){l.removeEventListener("DOMContentLoaded",I,!1),a.removeEventListener("load",I,!1),n.ready()}n.ready.promise=function(b){return H||(H=n.Deferred(),"complete"===l.readyState?setTimeout(n.ready):(l.addEventListener("DOMContentLoaded",I,!1),a.addEventListener("load",I,!1))),H.promise(b)},n.ready.promise();var J=n.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===n.type(c)){e=!0;for(h in c)n.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,n.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(n(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f};n.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};function K(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=n.expando+K.uid++}K.uid=1,K.accepts=n.acceptData,K.prototype={key:function(a){if(!K.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=K.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,b)}catch(d){b[this.expando]=c,n.extend(a,b)}}return this.cache[c]||(this.cache[c]={}),c},set:function(a,b,c){var d,e=this.key(a),f=this.cache[e];if("string"==typeof b)f[b]=c;else if(n.isEmptyObject(f))n.extend(this.cache[e],b);else for(d in b)f[d]=b[d];return f},get:function(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b]},access:function(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?(d=this.get(a,b),void 0!==d?d:this.get(a,n.camelCase(b))):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d,e,f=this.key(a),g=this.cache[f];if(void 0===b)this.cache[f]={};else{n.isArray(b)?d=b.concat(b.map(n.camelCase)):(e=n.camelCase(b),b in g?d=[b,e]:(d=e,d=d in g?[d]:d.match(E)||[])),c=d.length;while(c--)delete g[d[c]]}},hasData:function(a){return!n.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}};var L=new K,M=new K,N=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,O=/([A-Z])/g;function P(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(O,"-$1").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:N.test(c)?n.parseJSON(c):c}catch(e){}M.set(a,b,c)}else c=void 0;return c}n.extend({hasData:function(a){return M.hasData(a)||L.hasData(a)},data:function(a,b,c){return M.access(a,b,c)
},removeData:function(a,b){M.remove(a,b)},_data:function(a,b,c){return L.access(a,b,c)},_removeData:function(a,b){L.remove(a,b)}}),n.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=M.get(f),1===f.nodeType&&!L.get(f,"hasDataAttrs"))){c=g.length;while(c--)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=n.camelCase(d.slice(5)),P(f,d,e[d])));L.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){M.set(this,a)}):J(this,function(b){var c,d=n.camelCase(a);if(f&&void 0===b){if(c=M.get(f,a),void 0!==c)return c;if(c=M.get(f,d),void 0!==c)return c;if(c=P(f,d,void 0),void 0!==c)return c}else this.each(function(){var c=M.get(this,d);M.set(this,d,b),-1!==a.indexOf("-")&&void 0!==c&&M.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){M.remove(this,a)})}}),n.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=L.get(a,b),c&&(!d||n.isArray(c)?d=L.access(a,b,n.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=n.queue(a,b),d=c.length,e=c.shift(),f=n._queueHooks(a,b),g=function(){n.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return L.get(a,c)||L.access(a,c,{empty:n.Callbacks("once memory").add(function(){L.remove(a,[b+"queue",c])})})}}),n.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?n.queue(this[0],a):void 0===b?this:this.each(function(){var c=n.queue(this,a,b);n._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&n.dequeue(this,a)})},dequeue:function(a){return this.each(function(){n.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=n.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--)c=L.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var Q=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,R=["Top","Right","Bottom","Left"],S=function(a,b){return a=b||a,"none"===n.css(a,"display")||!n.contains(a.ownerDocument,a)},T=/^(?:checkbox|radio)$/i;!function(){var a=l.createDocumentFragment(),b=a.appendChild(l.createElement("div")),c=l.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),k.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",k.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var U="undefined";k.focusinBubbles="onfocusin"in a;var V=/^key/,W=/^(?:mouse|pointer|contextmenu)|click/,X=/^(?:focusinfocus|focusoutblur)$/,Y=/^([^.]*)(?:\.(.+)|)$/;function Z(){return!0}function $(){return!1}function _(){try{return l.activeElement}catch(a){}}n.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=L.get(a);if(r){c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=n.guid++),(i=r.events)||(i=r.events={}),(g=r.handle)||(g=r.handle=function(b){return typeof n!==U&&n.event.triggered!==b.type?n.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(E)||[""],j=b.length;while(j--)h=Y.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o&&(l=n.event.special[o]||{},o=(e?l.delegateType:l.bindType)||o,l=n.event.special[o]||{},k=n.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&n.expr.match.needsContext.test(e),namespace:p.join(".")},f),(m=i[o])||(m=i[o]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,p,g)!==!1||a.addEventListener&&a.addEventListener(o,g,!1)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),n.event.global[o]=!0)}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=L.hasData(a)&&L.get(a);if(r&&(i=r.events)){b=(b||"").match(E)||[""],j=b.length;while(j--)if(h=Y.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o){l=n.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,m=i[o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;while(f--)k=m[f],!e&&q!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,p,r.handle)!==!1||n.removeEvent(a,o,r.handle),delete i[o])}else for(o in i)n.event.remove(a,o+b[j],c,d,!0);n.isEmptyObject(i)&&(delete r.handle,L.remove(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,k,m,o,p=[d||l],q=j.call(b,"type")?b.type:b,r=j.call(b,"namespace")?b.namespace.split("."):[];if(g=h=d=d||l,3!==d.nodeType&&8!==d.nodeType&&!X.test(q+n.event.triggered)&&(q.indexOf(".")>=0&&(r=q.split("."),q=r.shift(),r.sort()),k=q.indexOf(":")<0&&"on"+q,b=b[n.expando]?b:new n.Event(q,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=r.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+r.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:n.makeArray(c,[b]),o=n.event.special[q]||{},e||!o.trigger||o.trigger.apply(d,c)!==!1)){if(!e&&!o.noBubble&&!n.isWindow(d)){for(i=o.delegateType||q,X.test(i+q)||(g=g.parentNode);g;g=g.parentNode)p.push(g),h=g;h===(d.ownerDocument||l)&&p.push(h.defaultView||h.parentWindow||a)}f=0;while((g=p[f++])&&!b.isPropagationStopped())b.type=f>1?i:o.bindType||q,m=(L.get(g,"events")||{})[b.type]&&L.get(g,"handle"),m&&m.apply(g,c),m=k&&g[k],m&&m.apply&&n.acceptData(g)&&(b.result=m.apply(g,c),b.result===!1&&b.preventDefault());return b.type=q,e||b.isDefaultPrevented()||o._default&&o._default.apply(p.pop(),c)!==!1||!n.acceptData(d)||k&&n.isFunction(d[q])&&!n.isWindow(d)&&(h=d[k],h&&(d[k]=null),n.event.triggered=q,d[q](),n.event.triggered=void 0,h&&(d[k]=h)),b.result}},dispatch:function(a){a=n.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(L.get(this,"events")||{})[a.type]||[],k=n.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){h=n.event.handlers.call(this,a,j),b=0;while((f=h[b++])&&!a.isPropagationStopped()){a.currentTarget=f.elem,c=0;while((g=f.handlers[c++])&&!a.isImmediatePropagationStopped())(!a.namespace_re||a.namespace_re.test(g.namespace))&&(a.handleObj=g,a.data=g.data,e=((n.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,i),void 0!==e&&(a.result=e)===!1&&(a.preventDefault(),a.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!==this;i=i.parentNode||this)if(i.disabled!==!0||"click"!==a.type){for(d=[],c=0;h>c;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?n(e,this).index(i)>=0:n.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||l,d=c.documentElement,e=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},fix:function(a){if(a[n.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];g||(this.fixHooks[e]=g=W.test(e)?this.mouseHooks:V.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new n.Event(f),b=d.length;while(b--)c=d[b],a[c]=f[c];return a.target||(a.target=l),3===a.target.nodeType&&(a.target=a.target.parentNode),g.filter?g.filter(a,f):a},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==_()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===_()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&n.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(a){return n.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=n.extend(new n.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?n.event.trigger(e,null,b):n.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},n.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)},n.Event=function(a,b){return this instanceof n.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?Z:$):this.type=a,b&&n.extend(this,b),this.timeStamp=a&&a.timeStamp||n.now(),void(this[n.expando]=!0)):new n.Event(a,b)},n.Event.prototype={isDefaultPrevented:$,isPropagationStopped:$,isImmediatePropagationStopped:$,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=Z,a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=Z,a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=Z,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},n.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){n.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!n.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),k.focusinBubbles||n.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){n.event.simulate(b,a.target,n.event.fix(a),!0)};n.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=L.access(d,b);e||d.addEventListener(a,c,!0),L.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=L.access(d,b)-1;e?L.access(d,b,e):(d.removeEventListener(a,c,!0),L.remove(d,b))}}}),n.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(g in a)this.on(g,b,c,a[g],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=$;else if(!d)return this;return 1===e&&(f=d,d=function(a){return n().off(a),f.apply(this,arguments)},d.guid=f.guid||(f.guid=n.guid++)),this.each(function(){n.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,n(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=$),this.each(function(){n.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){n.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?n.event.trigger(a,b,c,!0):void 0}});var ab=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bb=/<([\w:]+)/,cb=/<|&#?\w+;/,db=/<(?:script|style|link)/i,eb=/checked\s*(?:[^=]|=\s*.checked.)/i,fb=/^$|\/(?:java|ecma)script/i,gb=/^true\/(.*)/,hb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ib={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ib.optgroup=ib.option,ib.tbody=ib.tfoot=ib.colgroup=ib.caption=ib.thead,ib.th=ib.td;function jb(a,b){return n.nodeName(a,"table")&&n.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function kb(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function lb(a){var b=gb.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function mb(a,b){for(var c=0,d=a.length;d>c;c++)L.set(a[c],"globalEval",!b||L.get(b[c],"globalEval"))}function nb(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(L.hasData(a)&&(f=L.access(a),g=L.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;d>c;c++)n.event.add(b,e,j[e][c])}M.hasData(a)&&(h=M.access(a),i=n.extend({},h),M.set(b,i))}}function ob(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&n.nodeName(a,b)?n.merge([a],c):c}function pb(a,b){var c=b.nodeName.toLowerCase();"input"===c&&T.test(a.type)?b.checked=a.checked:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}n.extend({clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=n.contains(a.ownerDocument,a);if(!(k.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||n.isXMLDoc(a)))for(g=ob(h),f=ob(a),d=0,e=f.length;e>d;d++)pb(f[d],g[d]);if(b)if(c)for(f=f||ob(a),g=g||ob(h),d=0,e=f.length;e>d;d++)nb(f[d],g[d]);else nb(a,h);return g=ob(h,"script"),g.length>0&&mb(g,!i&&ob(a,"script")),h},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k=b.createDocumentFragment(),l=[],m=0,o=a.length;o>m;m++)if(e=a[m],e||0===e)if("object"===n.type(e))n.merge(l,e.nodeType?[e]:e);else if(cb.test(e)){f=f||k.appendChild(b.createElement("div")),g=(bb.exec(e)||["",""])[1].toLowerCase(),h=ib[g]||ib._default,f.innerHTML=h[1]+e.replace(ab,"<$1></$2>")+h[2],j=h[0];while(j--)f=f.lastChild;n.merge(l,f.childNodes),f=k.firstChild,f.textContent=""}else l.push(b.createTextNode(e));k.textContent="",m=0;while(e=l[m++])if((!d||-1===n.inArray(e,d))&&(i=n.contains(e.ownerDocument,e),f=ob(k.appendChild(e),"script"),i&&mb(f),c)){j=0;while(e=f[j++])fb.test(e.type||"")&&c.push(e)}return k},cleanData:function(a){for(var b,c,d,e,f=n.event.special,g=0;void 0!==(c=a[g]);g++){if(n.acceptData(c)&&(e=c[L.expando],e&&(b=L.cache[e]))){if(b.events)for(d in b.events)f[d]?n.event.remove(c,d):n.removeEvent(c,d,b.handle);L.cache[e]&&delete L.cache[e]}delete M.cache[c[M.expando]]}}}),n.fn.extend({text:function(a){return J(this,function(a){return void 0===a?n.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=a)})},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=jb(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=jb(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?n.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||n.cleanData(ob(c)),c.parentNode&&(b&&n.contains(c.ownerDocument,c)&&mb(ob(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(n.cleanData(ob(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return n.clone(this,a,b)})},html:function(a){return J(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!db.test(a)&&!ib[(bb.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(ab,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(n.cleanData(ob(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,n.cleanData(ob(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,l=this.length,m=this,o=l-1,p=a[0],q=n.isFunction(p);if(q||l>1&&"string"==typeof p&&!k.checkClone&&eb.test(p))return this.each(function(c){var d=m.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b)});if(l&&(c=n.buildFragment(a,this[0].ownerDocument,!1,this),d=c.firstChild,1===c.childNodes.length&&(c=d),d)){for(f=n.map(ob(c,"script"),kb),g=f.length;l>j;j++)h=c,j!==o&&(h=n.clone(h,!0,!0),g&&n.merge(f,ob(h,"script"))),b.call(this[j],h,j);if(g)for(i=f[f.length-1].ownerDocument,n.map(f,lb),j=0;g>j;j++)h=f[j],fb.test(h.type||"")&&!L.access(h,"globalEval")&&n.contains(i,h)&&(h.src?n._evalUrl&&n._evalUrl(h.src):n.globalEval(h.textContent.replace(hb,"")))}return this}}),n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){n.fn[a]=function(a){for(var c,d=[],e=n(a),g=e.length-1,h=0;g>=h;h++)c=h===g?this:this.clone(!0),n(e[h])[b](c),f.apply(d,c.get());return this.pushStack(d)}});var qb,rb={};function sb(b,c){var d,e=n(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:n.css(e[0],"display");return e.detach(),f}function tb(a){var b=l,c=rb[a];return c||(c=sb(a,b),"none"!==c&&c||(qb=(qb||n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=qb[0].contentDocument,b.write(),b.close(),c=sb(a,b),qb.detach()),rb[a]=c),c}var ub=/^margin/,vb=new RegExp("^("+Q+")(?!px)[a-z%]+$","i"),wb=function(b){return b.ownerDocument.defaultView.opener?b.ownerDocument.defaultView.getComputedStyle(b,null):a.getComputedStyle(b,null)};function xb(a,b,c){var d,e,f,g,h=a.style;return c=c||wb(a),c&&(g=c.getPropertyValue(b)||c[b]),c&&(""!==g||n.contains(a.ownerDocument,a)||(g=n.style(a,b)),vb.test(g)&&ub.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function yb(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}!function(){var b,c,d=l.documentElement,e=l.createElement("div"),f=l.createElement("div");if(f.style){f.style.backgroundClip="content-box",f.cloneNode(!0).style.backgroundClip="",k.clearCloneStyle="content-box"===f.style.backgroundClip,e.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",e.appendChild(f);function g(){f.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",f.innerHTML="",d.appendChild(e);var g=a.getComputedStyle(f,null);b="1%"!==g.top,c="4px"===g.width,d.removeChild(e)}a.getComputedStyle&&n.extend(k,{pixelPosition:function(){return g(),b},boxSizingReliable:function(){return null==c&&g(),c},reliableMarginRight:function(){var b,c=f.appendChild(l.createElement("div"));return c.style.cssText=f.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",c.style.marginRight=c.style.width="0",f.style.width="1px",d.appendChild(e),b=!parseFloat(a.getComputedStyle(c,null).marginRight),d.removeChild(e),f.removeChild(c),b}})}}(),n.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var zb=/^(none|table(?!-c[ea]).+)/,Ab=new RegExp("^("+Q+")(.*)$","i"),Bb=new RegExp("^([+-])=("+Q+")","i"),Cb={position:"absolute",visibility:"hidden",display:"block"},Db={letterSpacing:"0",fontWeight:"400"},Eb=["Webkit","O","Moz","ms"];function Fb(a,b){if(b in a)return b;var c=b[0].toUpperCase()+b.slice(1),d=b,e=Eb.length;while(e--)if(b=Eb[e]+c,b in a)return b;return d}function Gb(a,b,c){var d=Ab.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function Hb(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=n.css(a,c+R[f],!0,e)),d?("content"===c&&(g-=n.css(a,"padding"+R[f],!0,e)),"margin"!==c&&(g-=n.css(a,"border"+R[f]+"Width",!0,e))):(g+=n.css(a,"padding"+R[f],!0,e),"padding"!==c&&(g+=n.css(a,"border"+R[f]+"Width",!0,e)));return g}function Ib(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=wb(a),g="border-box"===n.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=xb(a,b,f),(0>e||null==e)&&(e=a.style[b]),vb.test(e))return e;d=g&&(k.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Hb(a,b,c||(g?"border":"content"),d,f)+"px"}function Jb(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=L.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&S(d)&&(f[g]=L.access(d,"olddisplay",tb(d.nodeName)))):(e=S(d),"none"===c&&e||L.set(d,"olddisplay",e?c:n.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}n.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=xb(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=n.camelCase(b),i=a.style;return b=n.cssProps[h]||(n.cssProps[h]=Fb(i,h)),g=n.cssHooks[b]||n.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c,"string"===f&&(e=Bb.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(n.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||n.cssNumber[h]||(c+="px"),k.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c)),void 0)}},css:function(a,b,c,d){var e,f,g,h=n.camelCase(b);return b=n.cssProps[h]||(n.cssProps[h]=Fb(a.style,h)),g=n.cssHooks[b]||n.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=xb(a,b,d)),"normal"===e&&b in Db&&(e=Db[b]),""===c||c?(f=parseFloat(e),c===!0||n.isNumeric(f)?f||0:e):e}}),n.each(["height","width"],function(a,b){n.cssHooks[b]={get:function(a,c,d){return c?zb.test(n.css(a,"display"))&&0===a.offsetWidth?n.swap(a,Cb,function(){return Ib(a,b,d)}):Ib(a,b,d):void 0},set:function(a,c,d){var e=d&&wb(a);return Gb(a,c,d?Hb(a,b,d,"border-box"===n.css(a,"boxSizing",!1,e),e):0)}}}),n.cssHooks.marginRight=yb(k.reliableMarginRight,function(a,b){return b?n.swap(a,{display:"inline-block"},xb,[a,"marginRight"]):void 0}),n.each({margin:"",padding:"",border:"Width"},function(a,b){n.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+R[d]+b]=f[d]||f[d-2]||f[0];return e}},ub.test(a)||(n.cssHooks[a+b].set=Gb)}),n.fn.extend({css:function(a,b){return J(this,function(a,b,c){var d,e,f={},g=0;if(n.isArray(b)){for(d=wb(a),e=b.length;e>g;g++)f[b[g]]=n.css(a,b[g],!1,d);return f}return void 0!==c?n.style(a,b,c):n.css(a,b)},a,b,arguments.length>1)},show:function(){return Jb(this,!0)},hide:function(){return Jb(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){S(this)?n(this).show():n(this).hide()})}});function Kb(a,b,c,d,e){return new Kb.prototype.init(a,b,c,d,e)}n.Tween=Kb,Kb.prototype={constructor:Kb,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(n.cssNumber[c]?"":"px")},cur:function(){var a=Kb.propHooks[this.prop];return a&&a.get?a.get(this):Kb.propHooks._default.get(this)},run:function(a){var b,c=Kb.propHooks[this.prop];return this.pos=b=this.options.duration?n.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Kb.propHooks._default.set(this),this}},Kb.prototype.init.prototype=Kb.prototype,Kb.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=n.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){n.fx.step[a.prop]?n.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[n.cssProps[a.prop]]||n.cssHooks[a.prop])?n.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},Kb.propHooks.scrollTop=Kb.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},n.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},n.fx=Kb.prototype.init,n.fx.step={};var Lb,Mb,Nb=/^(?:toggle|show|hide)$/,Ob=new RegExp("^(?:([+-])=|)("+Q+")([a-z%]*)$","i"),Pb=/queueHooks$/,Qb=[Vb],Rb={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=Ob.exec(b),f=e&&e[3]||(n.cssNumber[a]?"":"px"),g=(n.cssNumber[a]||"px"!==f&&+d)&&Ob.exec(n.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,n.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};function Sb(){return setTimeout(function(){Lb=void 0}),Lb=n.now()}function Tb(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b)c=R[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function Ub(a,b,c){for(var d,e=(Rb[b]||[]).concat(Rb["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function Vb(a,b,c){var d,e,f,g,h,i,j,k,l=this,m={},o=a.style,p=a.nodeType&&S(a),q=L.get(a,"fxshow");c.queue||(h=n._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,l.always(function(){l.always(function(){h.unqueued--,n.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[o.overflow,o.overflowX,o.overflowY],j=n.css(a,"display"),k="none"===j?L.get(a,"olddisplay")||tb(a.nodeName):j,"inline"===k&&"none"===n.css(a,"float")&&(o.display="inline-block")),c.overflow&&(o.overflow="hidden",l.always(function(){o.overflow=c.overflow[0],o.overflowX=c.overflow[1],o.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],Nb.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(p?"hide":"show")){if("show"!==e||!q||void 0===q[d])continue;p=!0}m[d]=q&&q[d]||n.style(a,d)}else j=void 0;if(n.isEmptyObject(m))"inline"===("none"===j?tb(a.nodeName):j)&&(o.display=j);else{q?"hidden"in q&&(p=q.hidden):q=L.access(a,"fxshow",{}),f&&(q.hidden=!p),p?n(a).show():l.done(function(){n(a).hide()}),l.done(function(){var b;L.remove(a,"fxshow");for(b in m)n.style(a,b,m[b])});for(d in m)g=Ub(p?q[d]:0,d,l),d in q||(q[d]=g.start,p&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function Wb(a,b){var c,d,e,f,g;for(c in a)if(d=n.camelCase(c),e=b[d],f=a[c],n.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=n.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function Xb(a,b,c){var d,e,f=0,g=Qb.length,h=n.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Lb||Sb(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:n.extend({},b),opts:n.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Lb||Sb(),duration:c.duration,tweens:[],createTween:function(b,c){var d=n.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(Wb(k,j.opts.specialEasing);g>f;f++)if(d=Qb[f].call(j,a,k,j.opts))return d;return n.map(k,Ub,j),n.isFunction(j.opts.start)&&j.opts.start.call(a,j),n.fx.timer(n.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}n.Animation=n.extend(Xb,{tweener:function(a,b){n.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],Rb[c]=Rb[c]||[],Rb[c].unshift(b)},prefilter:function(a,b){b?Qb.unshift(a):Qb.push(a)}}),n.speed=function(a,b,c){var d=a&&"object"==typeof a?n.extend({},a):{complete:c||!c&&b||n.isFunction(a)&&a,duration:a,easing:c&&b||b&&!n.isFunction(b)&&b};return d.duration=n.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in n.fx.speeds?n.fx.speeds[d.duration]:n.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){n.isFunction(d.old)&&d.old.call(this),d.queue&&n.dequeue(this,d.queue)},d},n.fn.extend({fadeTo:function(a,b,c,d){return this.filter(S).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=n.isEmptyObject(a),f=n.speed(b,c,d),g=function(){var b=Xb(this,n.extend({},a),f);(e||L.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=n.timers,g=L.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&Pb.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&n.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=L.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=n.timers,g=d?d.length:0;for(c.finish=!0,n.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),n.each(["toggle","show","hide"],function(a,b){var c=n.fn[b];n.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(Tb(b,!0),a,d,e)}}),n.each({slideDown:Tb("show"),slideUp:Tb("hide"),slideToggle:Tb("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){n.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),n.timers=[],n.fx.tick=function(){var a,b=0,c=n.timers;for(Lb=n.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||n.fx.stop(),Lb=void 0},n.fx.timer=function(a){n.timers.push(a),a()?n.fx.start():n.timers.pop()},n.fx.interval=13,n.fx.start=function(){Mb||(Mb=setInterval(n.fx.tick,n.fx.interval))},n.fx.stop=function(){clearInterval(Mb),Mb=null},n.fx.speeds={slow:600,fast:200,_default:400},n.fn.delay=function(a,b){return a=n.fx?n.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a=l.createElement("input"),b=l.createElement("select"),c=b.appendChild(l.createElement("option"));a.type="checkbox",k.checkOn=""!==a.value,k.optSelected=c.selected,b.disabled=!0,k.optDisabled=!c.disabled,a=l.createElement("input"),a.value="t",a.type="radio",k.radioValue="t"===a.value}();var Yb,Zb,$b=n.expr.attrHandle;n.fn.extend({attr:function(a,b){return J(this,n.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){n.removeAttr(this,a)})}}),n.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===U?n.prop(a,b,c):(1===f&&n.isXMLDoc(a)||(b=b.toLowerCase(),d=n.attrHooks[b]||(n.expr.match.bool.test(b)?Zb:Yb)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=n.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void n.removeAttr(a,b))
},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(E);if(f&&1===a.nodeType)while(c=f[e++])d=n.propFix[c]||c,n.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)},attrHooks:{type:{set:function(a,b){if(!k.radioValue&&"radio"===b&&n.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),Zb={set:function(a,b,c){return b===!1?n.removeAttr(a,c):a.setAttribute(c,c),c}},n.each(n.expr.match.bool.source.match(/\w+/g),function(a,b){var c=$b[b]||n.find.attr;$b[b]=function(a,b,d){var e,f;return d||(f=$b[b],$b[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,$b[b]=f),e}});var _b=/^(?:input|select|textarea|button)$/i;n.fn.extend({prop:function(a,b){return J(this,n.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[n.propFix[a]||a]})}}),n.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!n.isXMLDoc(a),f&&(b=n.propFix[b]||b,e=n.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||_b.test(a.nodeName)||a.href?a.tabIndex:-1}}}}),k.optSelected||(n.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null}}),n.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){n.propFix[this.toLowerCase()]=this});var ac=/[\t\r\n\f]/g;n.fn.extend({addClass:function(a){var b,c,d,e,f,g,h="string"==typeof a&&a,i=0,j=this.length;if(n.isFunction(a))return this.each(function(b){n(this).addClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(E)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ac," "):" ")){f=0;while(e=b[f++])d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=n.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0===arguments.length||"string"==typeof a&&a,i=0,j=this.length;if(n.isFunction(a))return this.each(function(b){n(this).removeClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(E)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ac," "):"")){f=0;while(e=b[f++])while(d.indexOf(" "+e+" ")>=0)d=d.replace(" "+e+" "," ");g=a?n.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(n.isFunction(a)?function(c){n(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c){var b,d=0,e=n(this),f=a.match(E)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else(c===U||"boolean"===c)&&(this.className&&L.set(this,"__className__",this.className),this.className=this.className||a===!1?"":L.get(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(ac," ").indexOf(b)>=0)return!0;return!1}});var bc=/\r/g;n.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=n.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,n(this).val()):a,null==e?e="":"number"==typeof e?e+="":n.isArray(e)&&(e=n.map(e,function(a){return null==a?"":a+""})),b=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=n.valHooks[e.type]||n.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(bc,""):null==c?"":c)}}}),n.extend({valHooks:{option:{get:function(a){var b=n.find.attr(a,"value");return null!=b?b:n.trim(n.text(a))}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(k.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&n.nodeName(c.parentNode,"optgroup"))){if(b=n(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c,d,e=a.options,f=n.makeArray(b),g=e.length;while(g--)d=e[g],(d.selected=n.inArray(d.value,f)>=0)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),n.each(["radio","checkbox"],function(){n.valHooks[this]={set:function(a,b){return n.isArray(b)?a.checked=n.inArray(n(a).val(),b)>=0:void 0}},k.checkOn||(n.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})}),n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){n.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),n.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var cc=n.now(),dc=/\?/;n.parseJSON=function(a){return JSON.parse(a+"")},n.parseXML=function(a){var b,c;if(!a||"string"!=typeof a)return null;try{c=new DOMParser,b=c.parseFromString(a,"text/xml")}catch(d){b=void 0}return(!b||b.getElementsByTagName("parsererror").length)&&n.error("Invalid XML: "+a),b};var ec=/#.*$/,fc=/([?&])_=[^&]*/,gc=/^(.*?):[ \t]*([^\r\n]*)$/gm,hc=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,ic=/^(?:GET|HEAD)$/,jc=/^\/\//,kc=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,lc={},mc={},nc="*/".concat("*"),oc=a.location.href,pc=kc.exec(oc.toLowerCase())||[];function qc(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(E)||[];if(n.isFunction(c))while(d=f[e++])"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function rc(a,b,c,d){var e={},f=a===mc;function g(h){var i;return e[h]=!0,n.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function sc(a,b){var c,d,e=n.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&n.extend(!0,a,d),a}function tc(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0])i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function uc(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:oc,type:"GET",isLocal:hc.test(pc[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":nc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":n.parseJSON,"text xml":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?sc(sc(a,n.ajaxSettings),b):sc(n.ajaxSettings,a)},ajaxPrefilter:qc(lc),ajaxTransport:qc(mc),ajax:function(a,b){"object"==typeof a&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=n.ajaxSetup({},b),l=k.context||k,m=k.context&&(l.nodeType||l.jquery)?n(l):n.event,o=n.Deferred(),p=n.Callbacks("once memory"),q=k.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!f){f={};while(b=gc.exec(e))f[b[1].toLowerCase()]=b[2]}b=f[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?e:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(k.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return c&&c.abort(b),x(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||oc)+"").replace(ec,"").replace(jc,pc[1]+"//"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=n.trim(k.dataType||"*").toLowerCase().match(E)||[""],null==k.crossDomain&&(h=kc.exec(k.url.toLowerCase()),k.crossDomain=!(!h||h[1]===pc[1]&&h[2]===pc[2]&&(h[3]||("http:"===h[1]?"80":"443"))===(pc[3]||("http:"===pc[1]?"80":"443")))),k.data&&k.processData&&"string"!=typeof k.data&&(k.data=n.param(k.data,k.traditional)),rc(lc,k,b,v),2===t)return v;i=n.event&&k.global,i&&0===n.active++&&n.event.trigger("ajaxStart"),k.type=k.type.toUpperCase(),k.hasContent=!ic.test(k.type),d=k.url,k.hasContent||(k.data&&(d=k.url+=(dc.test(d)?"&":"?")+k.data,delete k.data),k.cache===!1&&(k.url=fc.test(d)?d.replace(fc,"$1_="+cc++):d+(dc.test(d)?"&":"?")+"_="+cc++)),k.ifModified&&(n.lastModified[d]&&v.setRequestHeader("If-Modified-Since",n.lastModified[d]),n.etag[d]&&v.setRequestHeader("If-None-Match",n.etag[d])),(k.data&&k.hasContent&&k.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",k.contentType),v.setRequestHeader("Accept",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+("*"!==k.dataTypes[0]?", "+nc+"; q=0.01":""):k.accepts["*"]);for(j in k.headers)v.setRequestHeader(j,k.headers[j]);if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t))return v.abort();u="abort";for(j in{success:1,error:1,complete:1})v[j](k[j]);if(c=rc(mc,k,b,v)){v.readyState=1,i&&m.trigger("ajaxSend",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){v.abort("timeout")},k.timeout));try{t=1,c.send(r,x)}catch(w){if(!(2>t))throw w;x(-1,w)}}else x(-1,"No Transport");function x(a,b,f,h){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),c=void 0,e=h||"",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,f&&(u=tc(k,v,f)),u=uc(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader("Last-Modified"),w&&(n.lastModified[d]=w),w=v.getResponseHeader("etag"),w&&(n.etag[d]=w)),204===a||"HEAD"===k.type?x="nocontent":304===a?x="notmodified":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+"",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,i&&m.trigger(j?"ajaxSuccess":"ajaxError",[v,k,j?r:s]),p.fireWith(l,[v,x]),i&&(m.trigger("ajaxComplete",[v,k]),--n.active||n.event.trigger("ajaxStop")))}return v},getJSON:function(a,b,c){return n.get(a,b,c,"json")},getScript:function(a,b){return n.get(a,void 0,b,"script")}}),n.each(["get","post"],function(a,b){n[b]=function(a,c,d,e){return n.isFunction(c)&&(e=e||d,d=c,c=void 0),n.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),n._evalUrl=function(a){return n.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},n.fn.extend({wrapAll:function(a){var b;return n.isFunction(a)?this.each(function(b){n(this).wrapAll(a.call(this,b))}):(this[0]&&(b=n(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstElementChild)a=a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return this.each(n.isFunction(a)?function(b){n(this).wrapInner(a.call(this,b))}:function(){var b=n(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=n.isFunction(a);return this.each(function(c){n(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){n.nodeName(this,"body")||n(this).replaceWith(this.childNodes)}).end()}}),n.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0},n.expr.filters.visible=function(a){return!n.expr.filters.hidden(a)};var vc=/%20/g,wc=/\[\]$/,xc=/\r?\n/g,yc=/^(?:submit|button|image|reset|file)$/i,zc=/^(?:input|select|textarea|keygen)/i;function Ac(a,b,c,d){var e;if(n.isArray(b))n.each(b,function(b,e){c||wc.test(a)?d(a,e):Ac(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==n.type(b))d(a,b);else for(e in b)Ac(a+"["+e+"]",b[e],c,d)}n.param=function(a,b){var c,d=[],e=function(a,b){b=n.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(a)||a.jquery&&!n.isPlainObject(a))n.each(a,function(){e(this.name,this.value)});else for(c in a)Ac(c,a[c],b,e);return d.join("&").replace(vc,"+")},n.fn.extend({serialize:function(){return n.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=n.prop(this,"elements");return a?n.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!n(this).is(":disabled")&&zc.test(this.nodeName)&&!yc.test(a)&&(this.checked||!T.test(a))}).map(function(a,b){var c=n(this).val();return null==c?null:n.isArray(c)?n.map(c,function(a){return{name:b.name,value:a.replace(xc,"\r\n")}}):{name:b.name,value:c.replace(xc,"\r\n")}}).get()}}),n.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};var Bc=0,Cc={},Dc={0:200,1223:204},Ec=n.ajaxSettings.xhr();a.attachEvent&&a.attachEvent("onunload",function(){for(var a in Cc)Cc[a]()}),k.cors=!!Ec&&"withCredentials"in Ec,k.ajax=Ec=!!Ec,n.ajaxTransport(function(a){var b;return k.cors||Ec&&!a.crossDomain?{send:function(c,d){var e,f=a.xhr(),g=++Bc;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)f.setRequestHeader(e,c[e]);b=function(a){return function(){b&&(delete Cc[g],b=f.onload=f.onerror=null,"abort"===a?f.abort():"error"===a?d(f.status,f.statusText):d(Dc[f.status]||f.status,f.statusText,"string"==typeof f.responseText?{text:f.responseText}:void 0,f.getAllResponseHeaders()))}},f.onload=b(),f.onerror=b("error"),b=Cc[g]=b("abort");try{f.send(a.hasContent&&a.data||null)}catch(h){if(b)throw h}},abort:function(){b&&b()}}:void 0}),n.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return n.globalEval(a),a}}}),n.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),n.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=n("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&e("error"===a.type?404:200,a.type)}),l.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Fc=[],Gc=/(=)\?(?=&|$)|\?\?/;n.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Fc.pop()||n.expando+"_"+cc++;return this[a]=!0,a}}),n.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Gc.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Gc.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=n.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Gc,"$1"+e):b.jsonp!==!1&&(b.url+=(dc.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||n.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Fc.push(e)),g&&n.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),n.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||l;var d=v.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=n.buildFragment([a],b,e),e&&e.length&&n(e).remove(),n.merge([],d.childNodes))};var Hc=n.fn.load;n.fn.load=function(a,b,c){if("string"!=typeof a&&Hc)return Hc.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=n.trim(a.slice(h)),a=a.slice(0,h)),n.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&n.ajax({url:a,type:e,dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?n("<div>").append(n.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,f||[a.responseText,b,a])}),this},n.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){n.fn[b]=function(a){return this.on(b,a)}}),n.expr.filters.animated=function(a){return n.grep(n.timers,function(b){return a===b.elem}).length};var Ic=a.document.documentElement;function Jc(a){return n.isWindow(a)?a:9===a.nodeType&&a.defaultView}n.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=n.css(a,"position"),l=n(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=n.css(a,"top"),i=n.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),n.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},n.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){n.offset.setOffset(this,a,b)});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;if(f)return b=f.documentElement,n.contains(b,d)?(typeof d.getBoundingClientRect!==U&&(e=d.getBoundingClientRect()),c=Jc(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===n.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),n.nodeName(a[0],"html")||(d=a.offset()),d.top+=n.css(a[0],"borderTopWidth",!0),d.left+=n.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-n.css(c,"marginTop",!0),left:b.left-d.left-n.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||Ic;while(a&&!n.nodeName(a,"html")&&"static"===n.css(a,"position"))a=a.offsetParent;return a||Ic})}}),n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var d="pageYOffset"===c;n.fn[b]=function(e){return J(this,function(b,e,f){var g=Jc(b);return void 0===f?g?g[c]:b[e]:void(g?g.scrollTo(d?a.pageXOffset:f,d?f:a.pageYOffset):b[e]=f)},b,e,arguments.length,null)}}),n.each(["top","left"],function(a,b){n.cssHooks[b]=yb(k.pixelPosition,function(a,c){return c?(c=xb(a,b),vb.test(c)?n(a).position()[b]+"px":c):void 0})}),n.each({Height:"height",Width:"width"},function(a,b){n.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){n.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return J(this,function(b,c,d){var e;return n.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?n.css(b,c,g):n.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),n.fn.size=function(){return this.length},n.fn.andSelf=n.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return n});var Kc=a.jQuery,Lc=a.$;return n.noConflict=function(b){return a.$===n&&(a.$=Lc),b&&a.jQuery===n&&(a.jQuery=Kc),n},typeof b===U&&(a.jQuery=a.$=n),n});

/*! jQuery UI - v1.11.4 - 2015-03-19
* http://jqueryui.com
* Includes: core.js, widget.js, mouse.js, draggable.js, sortable.js
* Copyright 2015 jQuery Foundation and other contributors; Licensed MIT */

(function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define([ "jquery" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}(function( $ ) {
/*!
 * jQuery UI Core 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */


// $.ui might exist from components with no dependencies, e.g., $.ui.position
$.ui = $.ui || {};

$.extend( $.ui, {
	version: "1.11.4",

	keyCode: {
		BACKSPACE: 8,
		COMMA: 188,
		DELETE: 46,
		DOWN: 40,
		END: 35,
		ENTER: 13,
		ESCAPE: 27,
		HOME: 36,
		LEFT: 37,
		PAGE_DOWN: 34,
		PAGE_UP: 33,
		PERIOD: 190,
		RIGHT: 39,
		SPACE: 32,
		TAB: 9,
		UP: 38
	}
});

// plugins
$.fn.extend({
	scrollParent: function( includeHidden ) {
		var position = this.css( "position" ),
			excludeStaticParent = position === "absolute",
			overflowRegex = includeHidden ? /(auto|scroll|hidden)/ : /(auto|scroll)/,
			scrollParent = this.parents().filter( function() {
				var parent = $( this );
				if ( excludeStaticParent && parent.css( "position" ) === "static" ) {
					return false;
				}
				return overflowRegex.test( parent.css( "overflow" ) + parent.css( "overflow-y" ) + parent.css( "overflow-x" ) );
			}).eq( 0 );

		return position === "fixed" || !scrollParent.length ? $( this[ 0 ].ownerDocument || document ) : scrollParent;
	},

	uniqueId: (function() {
		var uuid = 0;

		return function() {
			return this.each(function() {
				if ( !this.id ) {
					this.id = "ui-id-" + ( ++uuid );
				}
			});
		};
	})(),

	removeUniqueId: function() {
		return this.each(function() {
			if ( /^ui-id-\d+$/.test( this.id ) ) {
				$( this ).removeAttr( "id" );
			}
		});
	}
});

// selectors
function focusable( element, isTabIndexNotNaN ) {
	var map, mapName, img,
		nodeName = element.nodeName.toLowerCase();
	if ( "area" === nodeName ) {
		map = element.parentNode;
		mapName = map.name;
		if ( !element.href || !mapName || map.nodeName.toLowerCase() !== "map" ) {
			return false;
		}
		img = $( "img[usemap='#" + mapName + "']" )[ 0 ];
		return !!img && visible( img );
	}
	return ( /^(input|select|textarea|button|object)$/.test( nodeName ) ?
		!element.disabled :
		"a" === nodeName ?
			element.href || isTabIndexNotNaN :
			isTabIndexNotNaN) &&
		// the element and all of its ancestors must be visible
		visible( element );
}

function visible( element ) {
	return $.expr.filters.visible( element ) &&
		!$( element ).parents().addBack().filter(function() {
			return $.css( this, "visibility" ) === "hidden";
		}).length;
}

$.extend( $.expr[ ":" ], {
	data: $.expr.createPseudo ?
		$.expr.createPseudo(function( dataName ) {
			return function( elem ) {
				return !!$.data( elem, dataName );
			};
		}) :
		// support: jQuery <1.8
		function( elem, i, match ) {
			return !!$.data( elem, match[ 3 ] );
		},

	focusable: function( element ) {
		return focusable( element, !isNaN( $.attr( element, "tabindex" ) ) );
	},

	tabbable: function( element ) {
		var tabIndex = $.attr( element, "tabindex" ),
			isTabIndexNaN = isNaN( tabIndex );
		return ( isTabIndexNaN || tabIndex >= 0 ) && focusable( element, !isTabIndexNaN );
	}
});

// support: jQuery <1.8
if ( !$( "<a>" ).outerWidth( 1 ).jquery ) {
	$.each( [ "Width", "Height" ], function( i, name ) {
		var side = name === "Width" ? [ "Left", "Right" ] : [ "Top", "Bottom" ],
			type = name.toLowerCase(),
			orig = {
				innerWidth: $.fn.innerWidth,
				innerHeight: $.fn.innerHeight,
				outerWidth: $.fn.outerWidth,
				outerHeight: $.fn.outerHeight
			};

		function reduce( elem, size, border, margin ) {
			$.each( side, function() {
				size -= parseFloat( $.css( elem, "padding" + this ) ) || 0;
				if ( border ) {
					size -= parseFloat( $.css( elem, "border" + this + "Width" ) ) || 0;
				}
				if ( margin ) {
					size -= parseFloat( $.css( elem, "margin" + this ) ) || 0;
				}
			});
			return size;
		}

		$.fn[ "inner" + name ] = function( size ) {
			if ( size === undefined ) {
				return orig[ "inner" + name ].call( this );
			}

			return this.each(function() {
				$( this ).css( type, reduce( this, size ) + "px" );
			});
		};

		$.fn[ "outer" + name] = function( size, margin ) {
			if ( typeof size !== "number" ) {
				return orig[ "outer" + name ].call( this, size );
			}

			return this.each(function() {
				$( this).css( type, reduce( this, size, true, margin ) + "px" );
			});
		};
	});
}

// support: jQuery <1.8
if ( !$.fn.addBack ) {
	$.fn.addBack = function( selector ) {
		return this.add( selector == null ?
			this.prevObject : this.prevObject.filter( selector )
		);
	};
}

// support: jQuery 1.6.1, 1.6.2 (http://bugs.jquery.com/ticket/9413)
if ( $( "<a>" ).data( "a-b", "a" ).removeData( "a-b" ).data( "a-b" ) ) {
	$.fn.removeData = (function( removeData ) {
		return function( key ) {
			if ( arguments.length ) {
				return removeData.call( this, $.camelCase( key ) );
			} else {
				return removeData.call( this );
			}
		};
	})( $.fn.removeData );
}

// deprecated
$.ui.ie = !!/msie [\w.]+/.exec( navigator.userAgent.toLowerCase() );

$.fn.extend({
	focus: (function( orig ) {
		return function( delay, fn ) {
			return typeof delay === "number" ?
				this.each(function() {
					var elem = this;
					setTimeout(function() {
						$( elem ).focus();
						if ( fn ) {
							fn.call( elem );
						}
					}, delay );
				}) :
				orig.apply( this, arguments );
		};
	})( $.fn.focus ),

	disableSelection: (function() {
		var eventType = "onselectstart" in document.createElement( "div" ) ?
			"selectstart" :
			"mousedown";

		return function() {
			return this.bind( eventType + ".ui-disableSelection", function( event ) {
				event.preventDefault();
			});
		};
	})(),

	enableSelection: function() {
		return this.unbind( ".ui-disableSelection" );
	},

	zIndex: function( zIndex ) {
		if ( zIndex !== undefined ) {
			return this.css( "zIndex", zIndex );
		}

		if ( this.length ) {
			var elem = $( this[ 0 ] ), position, value;
			while ( elem.length && elem[ 0 ] !== document ) {
				// Ignore z-index if position is set to a value where z-index is ignored by the browser
				// This makes behavior of this function consistent across browsers
				// WebKit always returns auto if the element is positioned
				position = elem.css( "position" );
				if ( position === "absolute" || position === "relative" || position === "fixed" ) {
					// IE returns 0 when zIndex is not specified
					// other browsers return a string
					// we ignore the case of nested elements with an explicit value of 0
					// <div style="z-index: -10;"><div style="z-index: 0;"></div></div>
					value = parseInt( elem.css( "zIndex" ), 10 );
					if ( !isNaN( value ) && value !== 0 ) {
						return value;
					}
				}
				elem = elem.parent();
			}
		}

		return 0;
	}
});

// $.ui.plugin is deprecated. Use $.widget() extensions instead.
$.ui.plugin = {
	add: function( module, option, set ) {
		var i,
			proto = $.ui[ module ].prototype;
		for ( i in set ) {
			proto.plugins[ i ] = proto.plugins[ i ] || [];
			proto.plugins[ i ].push( [ option, set[ i ] ] );
		}
	},
	call: function( instance, name, args, allowDisconnected ) {
		var i,
			set = instance.plugins[ name ];

		if ( !set ) {
			return;
		}

		if ( !allowDisconnected && ( !instance.element[ 0 ].parentNode || instance.element[ 0 ].parentNode.nodeType === 11 ) ) {
			return;
		}

		for ( i = 0; i < set.length; i++ ) {
			if ( instance.options[ set[ i ][ 0 ] ] ) {
				set[ i ][ 1 ].apply( instance.element, args );
			}
		}
	}
};


/*!
 * jQuery UI Widget 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */


var widget_uuid = 0,
	widget_slice = Array.prototype.slice;

$.cleanData = (function( orig ) {
	return function( elems ) {
		var events, elem, i;
		for ( i = 0; (elem = elems[i]) != null; i++ ) {
			try {

				// Only trigger remove when necessary to save time
				events = $._data( elem, "events" );
				if ( events && events.remove ) {
					$( elem ).triggerHandler( "remove" );
				}

			// http://bugs.jquery.com/ticket/8235
			} catch ( e ) {}
		}
		orig( elems );
	};
})( $.cleanData );

$.widget = function( name, base, prototype ) {
	var fullName, existingConstructor, constructor, basePrototype,
		// proxiedPrototype allows the provided prototype to remain unmodified
		// so that it can be used as a mixin for multiple widgets (#8876)
		proxiedPrototype = {},
		namespace = name.split( "." )[ 0 ];

	name = name.split( "." )[ 1 ];
	fullName = namespace + "-" + name;

	if ( !prototype ) {
		prototype = base;
		base = $.Widget;
	}

	// create selector for plugin
	$.expr[ ":" ][ fullName.toLowerCase() ] = function( elem ) {
		return !!$.data( elem, fullName );
	};

	$[ namespace ] = $[ namespace ] || {};
	existingConstructor = $[ namespace ][ name ];
	constructor = $[ namespace ][ name ] = function( options, element ) {
		// allow instantiation without "new" keyword
		if ( !this._createWidget ) {
			return new constructor( options, element );
		}

		// allow instantiation without initializing for simple inheritance
		// must use "new" keyword (the code above always passes args)
		if ( arguments.length ) {
			this._createWidget( options, element );
		}
	};
	// extend with the existing constructor to carry over any static properties
	$.extend( constructor, existingConstructor, {
		version: prototype.version,
		// copy the object used to create the prototype in case we need to
		// redefine the widget later
		_proto: $.extend( {}, prototype ),
		// track widgets that inherit from this widget in case this widget is
		// redefined after a widget inherits from it
		_childConstructors: []
	});

	basePrototype = new base();
	// we need to make the options hash a property directly on the new instance
	// otherwise we'll modify the options hash on the prototype that we're
	// inheriting from
	basePrototype.options = $.widget.extend( {}, basePrototype.options );
	$.each( prototype, function( prop, value ) {
		if ( !$.isFunction( value ) ) {
			proxiedPrototype[ prop ] = value;
			return;
		}
		proxiedPrototype[ prop ] = (function() {
			var _super = function() {
					return base.prototype[ prop ].apply( this, arguments );
				},
				_superApply = function( args ) {
					return base.prototype[ prop ].apply( this, args );
				};
			return function() {
				var __super = this._super,
					__superApply = this._superApply,
					returnValue;

				this._super = _super;
				this._superApply = _superApply;

				returnValue = value.apply( this, arguments );

				this._super = __super;
				this._superApply = __superApply;

				return returnValue;
			};
		})();
	});
	constructor.prototype = $.widget.extend( basePrototype, {
		// TODO: remove support for widgetEventPrefix
		// always use the name + a colon as the prefix, e.g., draggable:start
		// don't prefix for widgets that aren't DOM-based
		widgetEventPrefix: existingConstructor ? (basePrototype.widgetEventPrefix || name) : name
	}, proxiedPrototype, {
		constructor: constructor,
		namespace: namespace,
		widgetName: name,
		widgetFullName: fullName
	});

	// If this widget is being redefined then we need to find all widgets that
	// are inheriting from it and redefine all of them so that they inherit from
	// the new version of this widget. We're essentially trying to replace one
	// level in the prototype chain.
	if ( existingConstructor ) {
		$.each( existingConstructor._childConstructors, function( i, child ) {
			var childPrototype = child.prototype;

			// redefine the child widget using the same prototype that was
			// originally used, but inherit from the new version of the base
			$.widget( childPrototype.namespace + "." + childPrototype.widgetName, constructor, child._proto );
		});
		// remove the list of existing child constructors from the old constructor
		// so the old child constructors can be garbage collected
		delete existingConstructor._childConstructors;
	} else {
		base._childConstructors.push( constructor );
	}

	$.widget.bridge( name, constructor );

	return constructor;
};

$.widget.extend = function( target ) {
	var input = widget_slice.call( arguments, 1 ),
		inputIndex = 0,
		inputLength = input.length,
		key,
		value;
	for ( ; inputIndex < inputLength; inputIndex++ ) {
		for ( key in input[ inputIndex ] ) {
			value = input[ inputIndex ][ key ];
			if ( input[ inputIndex ].hasOwnProperty( key ) && value !== undefined ) {
				// Clone objects
				if ( $.isPlainObject( value ) ) {
					target[ key ] = $.isPlainObject( target[ key ] ) ?
						$.widget.extend( {}, target[ key ], value ) :
						// Don't extend strings, arrays, etc. with objects
						$.widget.extend( {}, value );
				// Copy everything else by reference
				} else {
					target[ key ] = value;
				}
			}
		}
	}
	return target;
};

$.widget.bridge = function( name, object ) {
	var fullName = object.prototype.widgetFullName || name;
	$.fn[ name ] = function( options ) {
		var isMethodCall = typeof options === "string",
			args = widget_slice.call( arguments, 1 ),
			returnValue = this;

		if ( isMethodCall ) {
			this.each(function() {
				var methodValue,
					instance = $.data( this, fullName );
				if ( options === "instance" ) {
					returnValue = instance;
					return false;
				}
				if ( !instance ) {
					return $.error( "cannot call methods on " + name + " prior to initialization; " +
						"attempted to call method '" + options + "'" );
				}
				if ( !$.isFunction( instance[options] ) || options.charAt( 0 ) === "_" ) {
					return $.error( "no such method '" + options + "' for " + name + " widget instance" );
				}
				methodValue = instance[ options ].apply( instance, args );
				if ( methodValue !== instance && methodValue !== undefined ) {
					returnValue = methodValue && methodValue.jquery ?
						returnValue.pushStack( methodValue.get() ) :
						methodValue;
					return false;
				}
			});
		} else {

			// Allow multiple hashes to be passed on init
			if ( args.length ) {
				options = $.widget.extend.apply( null, [ options ].concat(args) );
			}

			this.each(function() {
				var instance = $.data( this, fullName );
				if ( instance ) {
					instance.option( options || {} );
					if ( instance._init ) {
						instance._init();
					}
				} else {
					$.data( this, fullName, new object( options, this ) );
				}
			});
		}

		return returnValue;
	};
};

$.Widget = function( /* options, element */ ) {};
$.Widget._childConstructors = [];

$.Widget.prototype = {
	widgetName: "widget",
	widgetEventPrefix: "",
	defaultElement: "<div>",
	options: {
		disabled: false,

		// callbacks
		create: null
	},
	_createWidget: function( options, element ) {
		element = $( element || this.defaultElement || this )[ 0 ];
		this.element = $( element );
		this.uuid = widget_uuid++;
		this.eventNamespace = "." + this.widgetName + this.uuid;

		this.bindings = $();
		this.hoverable = $();
		this.focusable = $();

		if ( element !== this ) {
			$.data( element, this.widgetFullName, this );
			this._on( true, this.element, {
				remove: function( event ) {
					if ( event.target === element ) {
						this.destroy();
					}
				}
			});
			this.document = $( element.style ?
				// element within the document
				element.ownerDocument :
				// element is window or document
				element.document || element );
			this.window = $( this.document[0].defaultView || this.document[0].parentWindow );
		}

		this.options = $.widget.extend( {},
			this.options,
			this._getCreateOptions(),
			options );

		this._create();
		this._trigger( "create", null, this._getCreateEventData() );
		this._init();
	},
	_getCreateOptions: $.noop,
	_getCreateEventData: $.noop,
	_create: $.noop,
	_init: $.noop,

	destroy: function() {
		this._destroy();
		// we can probably remove the unbind calls in 2.0
		// all event bindings should go through this._on()
		this.element
			.unbind( this.eventNamespace )
			.removeData( this.widgetFullName )
			// support: jquery <1.6.3
			// http://bugs.jquery.com/ticket/9413
			.removeData( $.camelCase( this.widgetFullName ) );
		this.widget()
			.unbind( this.eventNamespace )
			.removeAttr( "aria-disabled" )
			.removeClass(
				this.widgetFullName + "-disabled " +
				"ui-state-disabled" );

		// clean up events and states
		this.bindings.unbind( this.eventNamespace );
		this.hoverable.removeClass( "ui-state-hover" );
		this.focusable.removeClass( "ui-state-focus" );
	},
	_destroy: $.noop,

	widget: function() {
		return this.element;
	},

	option: function( key, value ) {
		var options = key,
			parts,
			curOption,
			i;

		if ( arguments.length === 0 ) {
			// don't return a reference to the internal hash
			return $.widget.extend( {}, this.options );
		}

		if ( typeof key === "string" ) {
			// handle nested keys, e.g., "foo.bar" => { foo: { bar: ___ } }
			options = {};
			parts = key.split( "." );
			key = parts.shift();
			if ( parts.length ) {
				curOption = options[ key ] = $.widget.extend( {}, this.options[ key ] );
				for ( i = 0; i < parts.length - 1; i++ ) {
					curOption[ parts[ i ] ] = curOption[ parts[ i ] ] || {};
					curOption = curOption[ parts[ i ] ];
				}
				key = parts.pop();
				if ( arguments.length === 1 ) {
					return curOption[ key ] === undefined ? null : curOption[ key ];
				}
				curOption[ key ] = value;
			} else {
				if ( arguments.length === 1 ) {
					return this.options[ key ] === undefined ? null : this.options[ key ];
				}
				options[ key ] = value;
			}
		}

		this._setOptions( options );

		return this;
	},
	_setOptions: function( options ) {
		var key;

		for ( key in options ) {
			this._setOption( key, options[ key ] );
		}

		return this;
	},
	_setOption: function( key, value ) {
		this.options[ key ] = value;

		if ( key === "disabled" ) {
			this.widget()
				.toggleClass( this.widgetFullName + "-disabled", !!value );

			// If the widget is becoming disabled, then nothing is interactive
			if ( value ) {
				this.hoverable.removeClass( "ui-state-hover" );
				this.focusable.removeClass( "ui-state-focus" );
			}
		}

		return this;
	},

	enable: function() {
		return this._setOptions({ disabled: false });
	},
	disable: function() {
		return this._setOptions({ disabled: true });
	},

	_on: function( suppressDisabledCheck, element, handlers ) {
		var delegateElement,
			instance = this;

		// no suppressDisabledCheck flag, shuffle arguments
		if ( typeof suppressDisabledCheck !== "boolean" ) {
			handlers = element;
			element = suppressDisabledCheck;
			suppressDisabledCheck = false;
		}

		// no element argument, shuffle and use this.element
		if ( !handlers ) {
			handlers = element;
			element = this.element;
			delegateElement = this.widget();
		} else {
			element = delegateElement = $( element );
			this.bindings = this.bindings.add( element );
		}

		$.each( handlers, function( event, handler ) {
			function handlerProxy() {
				// allow widgets to customize the disabled handling
				// - disabled as an array instead of boolean
				// - disabled class as method for disabling individual parts
				if ( !suppressDisabledCheck &&
						( instance.options.disabled === true ||
							$( this ).hasClass( "ui-state-disabled" ) ) ) {
					return;
				}
				return ( typeof handler === "string" ? instance[ handler ] : handler )
					.apply( instance, arguments );
			}

			// copy the guid so direct unbinding works
			if ( typeof handler !== "string" ) {
				handlerProxy.guid = handler.guid =
					handler.guid || handlerProxy.guid || $.guid++;
			}

			var match = event.match( /^([\w:-]*)\s*(.*)$/ ),
				eventName = match[1] + instance.eventNamespace,
				selector = match[2];
			if ( selector ) {
				delegateElement.delegate( selector, eventName, handlerProxy );
			} else {
				element.bind( eventName, handlerProxy );
			}
		});
	},

	_off: function( element, eventName ) {
		eventName = (eventName || "").split( " " ).join( this.eventNamespace + " " ) +
			this.eventNamespace;
		element.unbind( eventName ).undelegate( eventName );

		// Clear the stack to avoid memory leaks (#10056)
		this.bindings = $( this.bindings.not( element ).get() );
		this.focusable = $( this.focusable.not( element ).get() );
		this.hoverable = $( this.hoverable.not( element ).get() );
	},

	_delay: function( handler, delay ) {
		function handlerProxy() {
			return ( typeof handler === "string" ? instance[ handler ] : handler )
				.apply( instance, arguments );
		}
		var instance = this;
		return setTimeout( handlerProxy, delay || 0 );
	},

	_hoverable: function( element ) {
		this.hoverable = this.hoverable.add( element );
		this._on( element, {
			mouseenter: function( event ) {
				$( event.currentTarget ).addClass( "ui-state-hover" );
			},
			mouseleave: function( event ) {
				$( event.currentTarget ).removeClass( "ui-state-hover" );
			}
		});
	},

	_focusable: function( element ) {
		this.focusable = this.focusable.add( element );
		this._on( element, {
			focusin: function( event ) {
				$( event.currentTarget ).addClass( "ui-state-focus" );
			},
			focusout: function( event ) {
				$( event.currentTarget ).removeClass( "ui-state-focus" );
			}
		});
	},

	_trigger: function( type, event, data ) {
		var prop, orig,
			callback = this.options[ type ];

		data = data || {};
		event = $.Event( event );
		event.type = ( type === this.widgetEventPrefix ?
			type :
			this.widgetEventPrefix + type ).toLowerCase();
		// the original event may come from any element
		// so we need to reset the target on the new event
		event.target = this.element[ 0 ];

		// copy original event properties over to the new event
		orig = event.originalEvent;
		if ( orig ) {
			for ( prop in orig ) {
				if ( !( prop in event ) ) {
					event[ prop ] = orig[ prop ];
				}
			}
		}

		this.element.trigger( event, data );
		return !( $.isFunction( callback ) &&
			callback.apply( this.element[0], [ event ].concat( data ) ) === false ||
			event.isDefaultPrevented() );
	}
};

$.each( { show: "fadeIn", hide: "fadeOut" }, function( method, defaultEffect ) {
	$.Widget.prototype[ "_" + method ] = function( element, options, callback ) {
		if ( typeof options === "string" ) {
			options = { effect: options };
		}
		var hasOptions,
			effectName = !options ?
				method :
				options === true || typeof options === "number" ?
					defaultEffect :
					options.effect || defaultEffect;
		options = options || {};
		if ( typeof options === "number" ) {
			options = { duration: options };
		}
		hasOptions = !$.isEmptyObject( options );
		options.complete = callback;
		if ( options.delay ) {
			element.delay( options.delay );
		}
		if ( hasOptions && $.effects && $.effects.effect[ effectName ] ) {
			element[ method ]( options );
		} else if ( effectName !== method && element[ effectName ] ) {
			element[ effectName ]( options.duration, options.easing, callback );
		} else {
			element.queue(function( next ) {
				$( this )[ method ]();
				if ( callback ) {
					callback.call( element[ 0 ] );
				}
				next();
			});
		}
	};
});

var widget = $.widget;


/*!
 * jQuery UI Mouse 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/mouse/
 */


var mouseHandled = false;
$( document ).mouseup( function() {
	mouseHandled = false;
});

var mouse = $.widget("ui.mouse", {
	version: "1.11.4",
	options: {
		cancel: "input,textarea,button,select,option",
		distance: 1,
		delay: 0
	},
	_mouseInit: function() {
		var that = this;

		this.element
			.bind("mousedown." + this.widgetName, function(event) {
				return that._mouseDown(event);
			})
			.bind("click." + this.widgetName, function(event) {
				if (true === $.data(event.target, that.widgetName + ".preventClickEvent")) {
					$.removeData(event.target, that.widgetName + ".preventClickEvent");
					event.stopImmediatePropagation();
					return false;
				}
			});

		this.started = false;
	},

	// TODO: make sure destroying one instance of mouse doesn't mess with
	// other instances of mouse
	_mouseDestroy: function() {
		this.element.unbind("." + this.widgetName);
		if ( this._mouseMoveDelegate ) {
			this.document
				.unbind("mousemove." + this.widgetName, this._mouseMoveDelegate)
				.unbind("mouseup." + this.widgetName, this._mouseUpDelegate);
		}
	},

	_mouseDown: function(event) {
		// don't let more than one widget handle mouseStart
		if ( mouseHandled ) {
			return;
		}

		this._mouseMoved = false;

		// we may have missed mouseup (out of window)
		(this._mouseStarted && this._mouseUp(event));

		this._mouseDownEvent = event;

		var that = this,
			btnIsLeft = (event.which === 1),
			// event.target.nodeName works around a bug in IE 8 with
			// disabled inputs (#7620)
			elIsCancel = (typeof this.options.cancel === "string" && event.target.nodeName ? $(event.target).closest(this.options.cancel).length : false);
		if (!btnIsLeft || elIsCancel || !this._mouseCapture(event)) {
			return true;
		}

		this.mouseDelayMet = !this.options.delay;
		if (!this.mouseDelayMet) {
			this._mouseDelayTimer = setTimeout(function() {
				that.mouseDelayMet = true;
			}, this.options.delay);
		}

		if (this._mouseDistanceMet(event) && this._mouseDelayMet(event)) {
			this._mouseStarted = (this._mouseStart(event) !== false);
			if (!this._mouseStarted) {
				event.preventDefault();
				return true;
			}
		}

		// Click event may never have fired (Gecko & Opera)
		if (true === $.data(event.target, this.widgetName + ".preventClickEvent")) {
			$.removeData(event.target, this.widgetName + ".preventClickEvent");
		}

		// these delegates are required to keep context
		this._mouseMoveDelegate = function(event) {
			return that._mouseMove(event);
		};
		this._mouseUpDelegate = function(event) {
			return that._mouseUp(event);
		};

		this.document
			.bind( "mousemove." + this.widgetName, this._mouseMoveDelegate )
			.bind( "mouseup." + this.widgetName, this._mouseUpDelegate );

		event.preventDefault();

		mouseHandled = true;
		return true;
	},

	_mouseMove: function(event) {
		// Only check for mouseups outside the document if you've moved inside the document
		// at least once. This prevents the firing of mouseup in the case of IE<9, which will
		// fire a mousemove event if content is placed under the cursor. See #7778
		// Support: IE <9
		if ( this._mouseMoved ) {
			// IE mouseup check - mouseup happened when mouse was out of window
			if ($.ui.ie && ( !document.documentMode || document.documentMode < 9 ) && !event.button) {
				return this._mouseUp(event);

			// Iframe mouseup check - mouseup occurred in another document
			} else if ( !event.which ) {
				return this._mouseUp( event );
			}
		}

		if ( event.which || event.button ) {
			this._mouseMoved = true;
		}

		if (this._mouseStarted) {
			this._mouseDrag(event);
			return event.preventDefault();
		}

		if (this._mouseDistanceMet(event) && this._mouseDelayMet(event)) {
			this._mouseStarted =
				(this._mouseStart(this._mouseDownEvent, event) !== false);
			(this._mouseStarted ? this._mouseDrag(event) : this._mouseUp(event));
		}

		return !this._mouseStarted;
	},

	_mouseUp: function(event) {
		this.document
			.unbind( "mousemove." + this.widgetName, this._mouseMoveDelegate )
			.unbind( "mouseup." + this.widgetName, this._mouseUpDelegate );

		if (this._mouseStarted) {
			this._mouseStarted = false;

			if (event.target === this._mouseDownEvent.target) {
				$.data(event.target, this.widgetName + ".preventClickEvent", true);
			}

			this._mouseStop(event);
		}

		mouseHandled = false;
		return false;
	},

	_mouseDistanceMet: function(event) {
		return (Math.max(
				Math.abs(this._mouseDownEvent.pageX - event.pageX),
				Math.abs(this._mouseDownEvent.pageY - event.pageY)
			) >= this.options.distance
		);
	},

	_mouseDelayMet: function(/* event */) {
		return this.mouseDelayMet;
	},

	// These are placeholder methods, to be overriden by extending plugin
	_mouseStart: function(/* event */) {},
	_mouseDrag: function(/* event */) {},
	_mouseStop: function(/* event */) {},
	_mouseCapture: function(/* event */) { return true; }
});


/*!
 * jQuery UI Draggable 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/draggable/
 */


$.widget("ui.draggable", $.ui.mouse, {
	version: "1.11.4",
	widgetEventPrefix: "drag",
	options: {
		addClasses: true,
		appendTo: "parent",
		axis: false,
		connectToSortable: false,
		containment: false,
		cursor: "auto",
		cursorAt: false,
		grid: false,
		handle: false,
		helper: "original",
		iframeFix: false,
		opacity: false,
		refreshPositions: false,
		revert: false,
		revertDuration: 500,
		scope: "default",
		scroll: true,
		scrollSensitivity: 20,
		scrollSpeed: 20,
		snap: false,
		snapMode: "both",
		snapTolerance: 20,
		stack: false,
		zIndex: false,

		// callbacks
		drag: null,
		start: null,
		stop: null
	},
	_create: function() {

		if ( this.options.helper === "original" ) {
			this._setPositionRelative();
		}
		if (this.options.addClasses){
			this.element.addClass("ui-draggable");
		}
		if (this.options.disabled){
			this.element.addClass("ui-draggable-disabled");
		}
		this._setHandleClassName();

		this._mouseInit();
	},

	_setOption: function( key, value ) {
		this._super( key, value );
		if ( key === "handle" ) {
			this._removeHandleClassName();
			this._setHandleClassName();
		}
	},

	_destroy: function() {
		if ( ( this.helper || this.element ).is( ".ui-draggable-dragging" ) ) {
			this.destroyOnClear = true;
			return;
		}
		this.element.removeClass( "ui-draggable ui-draggable-dragging ui-draggable-disabled" );
		this._removeHandleClassName();
		this._mouseDestroy();
	},

	_mouseCapture: function(event) {
		var o = this.options;

		this._blurActiveElement( event );

		// among others, prevent a drag on a resizable-handle
		if (this.helper || o.disabled || $(event.target).closest(".ui-resizable-handle").length > 0) {
			return false;
		}

		//Quit if we're not on a valid handle
		this.handle = this._getHandle(event);
		if (!this.handle) {
			return false;
		}

		this._blockFrames( o.iframeFix === true ? "iframe" : o.iframeFix );

		return true;

	},

	_blockFrames: function( selector ) {
		this.iframeBlocks = this.document.find( selector ).map(function() {
			var iframe = $( this );

			return $( "<div>" )
				.css( "position", "absolute" )
				.appendTo( iframe.parent() )
				.outerWidth( iframe.outerWidth() )
				.outerHeight( iframe.outerHeight() )
				.offset( iframe.offset() )[ 0 ];
		});
	},

	_unblockFrames: function() {
		if ( this.iframeBlocks ) {
			this.iframeBlocks.remove();
			delete this.iframeBlocks;
		}
	},

	_blurActiveElement: function( event ) {
		var document = this.document[ 0 ];

		// Only need to blur if the event occurred on the draggable itself, see #10527
		if ( !this.handleElement.is( event.target ) ) {
			return;
		}

		// support: IE9
		// IE9 throws an "Unspecified error" accessing document.activeElement from an <iframe>
		try {

			// Support: IE9, IE10
			// If the <body> is blurred, IE will switch windows, see #9520
			if ( document.activeElement && document.activeElement.nodeName.toLowerCase() !== "body" ) {

				// Blur any element that currently has focus, see #4261
				$( document.activeElement ).blur();
			}
		} catch ( error ) {}
	},

	_mouseStart: function(event) {

		var o = this.options;

		//Create and append the visible helper
		this.helper = this._createHelper(event);

		this.helper.addClass("ui-draggable-dragging");

		//Cache the helper size
		this._cacheHelperProportions();

		//If ddmanager is used for droppables, set the global draggable
		if ($.ui.ddmanager) {
			$.ui.ddmanager.current = this;
		}

		/*
		 * - Position generation -
		 * This block generates everything position related - it's the core of draggables.
		 */

		//Cache the margins of the original element
		this._cacheMargins();

		//Store the helper's css position
		this.cssPosition = this.helper.css( "position" );
		this.scrollParent = this.helper.scrollParent( true );
		this.offsetParent = this.helper.offsetParent();
		this.hasFixedAncestor = this.helper.parents().filter(function() {
				return $( this ).css( "position" ) === "fixed";
			}).length > 0;

		//The element's absolute position on the page minus margins
		this.positionAbs = this.element.offset();
		this._refreshOffsets( event );

		//Generate the original position
		this.originalPosition = this.position = this._generatePosition( event, false );
		this.originalPageX = event.pageX;
		this.originalPageY = event.pageY;

		//Adjust the mouse offset relative to the helper if "cursorAt" is supplied
		(o.cursorAt && this._adjustOffsetFromHelper(o.cursorAt));

		//Set a containment if given in the options
		this._setContainment();

		//Trigger event + callbacks
		if (this._trigger("start", event) === false) {
			this._clear();
			return false;
		}

		//Recache the helper size
		this._cacheHelperProportions();

		//Prepare the droppable offsets
		if ($.ui.ddmanager && !o.dropBehaviour) {
			$.ui.ddmanager.prepareOffsets(this, event);
		}

		// Reset helper's right/bottom css if they're set and set explicit width/height instead
		// as this prevents resizing of elements with right/bottom set (see #7772)
		this._normalizeRightBottom();

		this._mouseDrag(event, true); //Execute the drag once - this causes the helper not to be visible before getting its correct position

		//If the ddmanager is used for droppables, inform the manager that dragging has started (see #5003)
		if ( $.ui.ddmanager ) {
			$.ui.ddmanager.dragStart(this, event);
		}

		return true;
	},

	_refreshOffsets: function( event ) {
		this.offset = {
			top: this.positionAbs.top - this.margins.top,
			left: this.positionAbs.left - this.margins.left,
			scroll: false,
			parent: this._getParentOffset(),
			relative: this._getRelativeOffset()
		};

		this.offset.click = {
			left: event.pageX - this.offset.left,
			top: event.pageY - this.offset.top
		};
	},

	_mouseDrag: function(event, noPropagation) {
		// reset any necessary cached properties (see #5009)
		if ( this.hasFixedAncestor ) {
			this.offset.parent = this._getParentOffset();
		}

		//Compute the helpers position
		this.position = this._generatePosition( event, true );
		this.positionAbs = this._convertPositionTo("absolute");

		//Call plugins and callbacks and use the resulting position if something is returned
		if (!noPropagation) {
			var ui = this._uiHash();
			if (this._trigger("drag", event, ui) === false) {
				this._mouseUp({});
				return false;
			}
			this.position = ui.position;
		}

		this.helper[ 0 ].style.left = this.position.left + "px";
		this.helper[ 0 ].style.top = this.position.top + "px";

		if ($.ui.ddmanager) {
			$.ui.ddmanager.drag(this, event);
		}

		return false;
	},

	_mouseStop: function(event) {

		//If we are using droppables, inform the manager about the drop
		var that = this,
			dropped = false;
		if ($.ui.ddmanager && !this.options.dropBehaviour) {
			dropped = $.ui.ddmanager.drop(this, event);
		}

		//if a drop comes from outside (a sortable)
		if (this.dropped) {
			dropped = this.dropped;
			this.dropped = false;
		}

		if ((this.options.revert === "invalid" && !dropped) || (this.options.revert === "valid" && dropped) || this.options.revert === true || ($.isFunction(this.options.revert) && this.options.revert.call(this.element, dropped))) {
			$(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function() {
				if (that._trigger("stop", event) !== false) {
					that._clear();
				}
			});
		} else {
			if (this._trigger("stop", event) !== false) {
				this._clear();
			}
		}

		return false;
	},

	_mouseUp: function( event ) {
		this._unblockFrames();

		//If the ddmanager is used for droppables, inform the manager that dragging has stopped (see #5003)
		if ( $.ui.ddmanager ) {
			$.ui.ddmanager.dragStop(this, event);
		}

		// Only need to focus if the event occurred on the draggable itself, see #10527
		if ( this.handleElement.is( event.target ) ) {
			// The interaction is over; whether or not the click resulted in a drag, focus the element
			this.element.focus();
		}

		return $.ui.mouse.prototype._mouseUp.call(this, event);
	},

	cancel: function() {

		if (this.helper.is(".ui-draggable-dragging")) {
			this._mouseUp({});
		} else {
			this._clear();
		}

		return this;

	},

	_getHandle: function(event) {
		return this.options.handle ?
			!!$( event.target ).closest( this.element.find( this.options.handle ) ).length :
			true;
	},

	_setHandleClassName: function() {
		this.handleElement = this.options.handle ?
			this.element.find( this.options.handle ) : this.element;
		this.handleElement.addClass( "ui-draggable-handle" );
	},

	_removeHandleClassName: function() {
		this.handleElement.removeClass( "ui-draggable-handle" );
	},

	_createHelper: function(event) {

		var o = this.options,
			helperIsFunction = $.isFunction( o.helper ),
			helper = helperIsFunction ?
				$( o.helper.apply( this.element[ 0 ], [ event ] ) ) :
				( o.helper === "clone" ?
					this.element.clone().removeAttr( "id" ) :
					this.element );

		if (!helper.parents("body").length) {
			helper.appendTo((o.appendTo === "parent" ? this.element[0].parentNode : o.appendTo));
		}

		// http://bugs.jqueryui.com/ticket/9446
		// a helper function can return the original element
		// which wouldn't have been set to relative in _create
		if ( helperIsFunction && helper[ 0 ] === this.element[ 0 ] ) {
			this._setPositionRelative();
		}

		if (helper[0] !== this.element[0] && !(/(fixed|absolute)/).test(helper.css("position"))) {
			helper.css("position", "absolute");
		}

		return helper;

	},

	_setPositionRelative: function() {
		if ( !( /^(?:r|a|f)/ ).test( this.element.css( "position" ) ) ) {
			this.element[ 0 ].style.position = "relative";
		}
	},

	_adjustOffsetFromHelper: function(obj) {
		if (typeof obj === "string") {
			obj = obj.split(" ");
		}
		if ($.isArray(obj)) {
			obj = { left: +obj[0], top: +obj[1] || 0 };
		}
		if ("left" in obj) {
			this.offset.click.left = obj.left + this.margins.left;
		}
		if ("right" in obj) {
			this.offset.click.left = this.helperProportions.width - obj.right + this.margins.left;
		}
		if ("top" in obj) {
			this.offset.click.top = obj.top + this.margins.top;
		}
		if ("bottom" in obj) {
			this.offset.click.top = this.helperProportions.height - obj.bottom + this.margins.top;
		}
	},

	_isRootNode: function( element ) {
		return ( /(html|body)/i ).test( element.tagName ) || element === this.document[ 0 ];
	},

	_getParentOffset: function() {

		//Get the offsetParent and cache its position
		var po = this.offsetParent.offset(),
			document = this.document[ 0 ];

		// This is a special case where we need to modify a offset calculated on start, since the following happened:
		// 1. The position of the helper is absolute, so it's position is calculated based on the next positioned parent
		// 2. The actual offset parent is a child of the scroll parent, and the scroll parent isn't the document, which means that
		//    the scroll is included in the initial calculation of the offset of the parent, and never recalculated upon drag
		if (this.cssPosition === "absolute" && this.scrollParent[0] !== document && $.contains(this.scrollParent[0], this.offsetParent[0])) {
			po.left += this.scrollParent.scrollLeft();
			po.top += this.scrollParent.scrollTop();
		}

		if ( this._isRootNode( this.offsetParent[ 0 ] ) ) {
			po = { top: 0, left: 0 };
		}

		return {
			top: po.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),
			left: po.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)
		};

	},

	_getRelativeOffset: function() {
		if ( this.cssPosition !== "relative" ) {
			return { top: 0, left: 0 };
		}

		var p = this.element.position(),
			scrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] );

		return {
			top: p.top - ( parseInt(this.helper.css( "top" ), 10) || 0 ) + ( !scrollIsRootNode ? this.scrollParent.scrollTop() : 0 ),
			left: p.left - ( parseInt(this.helper.css( "left" ), 10) || 0 ) + ( !scrollIsRootNode ? this.scrollParent.scrollLeft() : 0 )
		};

	},

	_cacheMargins: function() {
		this.margins = {
			left: (parseInt(this.element.css("marginLeft"), 10) || 0),
			top: (parseInt(this.element.css("marginTop"), 10) || 0),
			right: (parseInt(this.element.css("marginRight"), 10) || 0),
			bottom: (parseInt(this.element.css("marginBottom"), 10) || 0)
		};
	},

	_cacheHelperProportions: function() {
		this.helperProportions = {
			width: this.helper.outerWidth(),
			height: this.helper.outerHeight()
		};
	},

	_setContainment: function() {

		var isUserScrollable, c, ce,
			o = this.options,
			document = this.document[ 0 ];

		this.relativeContainer = null;

		if ( !o.containment ) {
			this.containment = null;
			return;
		}

		if ( o.containment === "window" ) {
			this.containment = [
				$( window ).scrollLeft() - this.offset.relative.left - this.offset.parent.left,
				$( window ).scrollTop() - this.offset.relative.top - this.offset.parent.top,
				$( window ).scrollLeft() + $( window ).width() - this.helperProportions.width - this.margins.left,
				$( window ).scrollTop() + ( $( window ).height() || document.body.parentNode.scrollHeight ) - this.helperProportions.height - this.margins.top
			];
			return;
		}

		if ( o.containment === "document") {
			this.containment = [
				0,
				0,
				$( document ).width() - this.helperProportions.width - this.margins.left,
				( $( document ).height() || document.body.parentNode.scrollHeight ) - this.helperProportions.height - this.margins.top
			];
			return;
		}

		if ( o.containment.constructor === Array ) {
			this.containment = o.containment;
			return;
		}

		if ( o.containment === "parent" ) {
			o.containment = this.helper[ 0 ].parentNode;
		}

		c = $( o.containment );
		ce = c[ 0 ];

		if ( !ce ) {
			return;
		}

		isUserScrollable = /(scroll|auto)/.test( c.css( "overflow" ) );

		this.containment = [
			( parseInt( c.css( "borderLeftWidth" ), 10 ) || 0 ) + ( parseInt( c.css( "paddingLeft" ), 10 ) || 0 ),
			( parseInt( c.css( "borderTopWidth" ), 10 ) || 0 ) + ( parseInt( c.css( "paddingTop" ), 10 ) || 0 ),
			( isUserScrollable ? Math.max( ce.scrollWidth, ce.offsetWidth ) : ce.offsetWidth ) -
				( parseInt( c.css( "borderRightWidth" ), 10 ) || 0 ) -
				( parseInt( c.css( "paddingRight" ), 10 ) || 0 ) -
				this.helperProportions.width -
				this.margins.left -
				this.margins.right,
			( isUserScrollable ? Math.max( ce.scrollHeight, ce.offsetHeight ) : ce.offsetHeight ) -
				( parseInt( c.css( "borderBottomWidth" ), 10 ) || 0 ) -
				( parseInt( c.css( "paddingBottom" ), 10 ) || 0 ) -
				this.helperProportions.height -
				this.margins.top -
				this.margins.bottom
		];
		this.relativeContainer = c;
	},

	_convertPositionTo: function(d, pos) {

		if (!pos) {
			pos = this.position;
		}

		var mod = d === "absolute" ? 1 : -1,
			scrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] );

		return {
			top: (
				pos.top	+																// The absolute mouse position
				this.offset.relative.top * mod +										// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.top * mod -										// The offsetParent's offset without borders (offset + border)
				( ( this.cssPosition === "fixed" ? -this.offset.scroll.top : ( scrollIsRootNode ? 0 : this.offset.scroll.top ) ) * mod)
			),
			left: (
				pos.left +																// The absolute mouse position
				this.offset.relative.left * mod +										// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.left * mod	-										// The offsetParent's offset without borders (offset + border)
				( ( this.cssPosition === "fixed" ? -this.offset.scroll.left : ( scrollIsRootNode ? 0 : this.offset.scroll.left ) ) * mod)
			)
		};

	},

	_generatePosition: function( event, constrainPosition ) {

		var containment, co, top, left,
			o = this.options,
			scrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] ),
			pageX = event.pageX,
			pageY = event.pageY;

		// Cache the scroll
		if ( !scrollIsRootNode || !this.offset.scroll ) {
			this.offset.scroll = {
				top: this.scrollParent.scrollTop(),
				left: this.scrollParent.scrollLeft()
			};
		}

		/*
		 * - Position constraining -
		 * Constrain the position to a mix of grid, containment.
		 */

		// If we are not dragging yet, we won't check for options
		if ( constrainPosition ) {
			if ( this.containment ) {
				if ( this.relativeContainer ){
					co = this.relativeContainer.offset();
					containment = [
						this.containment[ 0 ] + co.left,
						this.containment[ 1 ] + co.top,
						this.containment[ 2 ] + co.left,
						this.containment[ 3 ] + co.top
					];
				} else {
					containment = this.containment;
				}

				if (event.pageX - this.offset.click.left < containment[0]) {
					pageX = containment[0] + this.offset.click.left;
				}
				if (event.pageY - this.offset.click.top < containment[1]) {
					pageY = containment[1] + this.offset.click.top;
				}
				if (event.pageX - this.offset.click.left > containment[2]) {
					pageX = containment[2] + this.offset.click.left;
				}
				if (event.pageY - this.offset.click.top > containment[3]) {
					pageY = containment[3] + this.offset.click.top;
				}
			}

			if (o.grid) {
				//Check for grid elements set to 0 to prevent divide by 0 error causing invalid argument errors in IE (see ticket #6950)
				top = o.grid[1] ? this.originalPageY + Math.round((pageY - this.originalPageY) / o.grid[1]) * o.grid[1] : this.originalPageY;
				pageY = containment ? ((top - this.offset.click.top >= containment[1] || top - this.offset.click.top > containment[3]) ? top : ((top - this.offset.click.top >= containment[1]) ? top - o.grid[1] : top + o.grid[1])) : top;

				left = o.grid[0] ? this.originalPageX + Math.round((pageX - this.originalPageX) / o.grid[0]) * o.grid[0] : this.originalPageX;
				pageX = containment ? ((left - this.offset.click.left >= containment[0] || left - this.offset.click.left > containment[2]) ? left : ((left - this.offset.click.left >= containment[0]) ? left - o.grid[0] : left + o.grid[0])) : left;
			}

			if ( o.axis === "y" ) {
				pageX = this.originalPageX;
			}

			if ( o.axis === "x" ) {
				pageY = this.originalPageY;
			}
		}

		return {
			top: (
				pageY -																	// The absolute mouse position
				this.offset.click.top	-												// Click offset (relative to the element)
				this.offset.relative.top -												// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.top +												// The offsetParent's offset without borders (offset + border)
				( this.cssPosition === "fixed" ? -this.offset.scroll.top : ( scrollIsRootNode ? 0 : this.offset.scroll.top ) )
			),
			left: (
				pageX -																	// The absolute mouse position
				this.offset.click.left -												// Click offset (relative to the element)
				this.offset.relative.left -												// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.left +												// The offsetParent's offset without borders (offset + border)
				( this.cssPosition === "fixed" ? -this.offset.scroll.left : ( scrollIsRootNode ? 0 : this.offset.scroll.left ) )
			)
		};

	},

	_clear: function() {
		this.helper.removeClass("ui-draggable-dragging");
		if (this.helper[0] !== this.element[0] && !this.cancelHelperRemoval) {
			this.helper.remove();
		}
		this.helper = null;
		this.cancelHelperRemoval = false;
		if ( this.destroyOnClear ) {
			this.destroy();
		}
	},

	_normalizeRightBottom: function() {
		if ( this.options.axis !== "y" && this.helper.css( "right" ) !== "auto" ) {
			this.helper.width( this.helper.width() );
			this.helper.css( "right", "auto" );
		}
		if ( this.options.axis !== "x" && this.helper.css( "bottom" ) !== "auto" ) {
			this.helper.height( this.helper.height() );
			this.helper.css( "bottom", "auto" );
		}
	},

	// From now on bulk stuff - mainly helpers

	_trigger: function( type, event, ui ) {
		ui = ui || this._uiHash();
		$.ui.plugin.call( this, type, [ event, ui, this ], true );

		// Absolute position and offset (see #6884 ) have to be recalculated after plugins
		if ( /^(drag|start|stop)/.test( type ) ) {
			this.positionAbs = this._convertPositionTo( "absolute" );
			ui.offset = this.positionAbs;
		}
		return $.Widget.prototype._trigger.call( this, type, event, ui );
	},

	plugins: {},

	_uiHash: function() {
		return {
			helper: this.helper,
			position: this.position,
			originalPosition: this.originalPosition,
			offset: this.positionAbs
		};
	}

});

$.ui.plugin.add( "draggable", "connectToSortable", {
	start: function( event, ui, draggable ) {
		var uiSortable = $.extend( {}, ui, {
			item: draggable.element
		});

		draggable.sortables = [];
		$( draggable.options.connectToSortable ).each(function() {
			var sortable = $( this ).sortable( "instance" );

			if ( sortable && !sortable.options.disabled ) {
				draggable.sortables.push( sortable );

				// refreshPositions is called at drag start to refresh the containerCache
				// which is used in drag. This ensures it's initialized and synchronized
				// with any changes that might have happened on the page since initialization.
				sortable.refreshPositions();
				sortable._trigger("activate", event, uiSortable);
			}
		});
	},
	stop: function( event, ui, draggable ) {
		var uiSortable = $.extend( {}, ui, {
			item: draggable.element
		});

		draggable.cancelHelperRemoval = false;

		$.each( draggable.sortables, function() {
			var sortable = this;

			if ( sortable.isOver ) {
				sortable.isOver = 0;

				// Allow this sortable to handle removing the helper
				draggable.cancelHelperRemoval = true;
				sortable.cancelHelperRemoval = false;

				// Use _storedCSS To restore properties in the sortable,
				// as this also handles revert (#9675) since the draggable
				// may have modified them in unexpected ways (#8809)
				sortable._storedCSS = {
					position: sortable.placeholder.css( "position" ),
					top: sortable.placeholder.css( "top" ),
					left: sortable.placeholder.css( "left" )
				};

				sortable._mouseStop(event);

				// Once drag has ended, the sortable should return to using
				// its original helper, not the shared helper from draggable
				sortable.options.helper = sortable.options._helper;
			} else {
				// Prevent this Sortable from removing the helper.
				// However, don't set the draggable to remove the helper
				// either as another connected Sortable may yet handle the removal.
				sortable.cancelHelperRemoval = true;

				sortable._trigger( "deactivate", event, uiSortable );
			}
		});
	},
	drag: function( event, ui, draggable ) {
		$.each( draggable.sortables, function() {
			var innermostIntersecting = false,
				sortable = this;

			// Copy over variables that sortable's _intersectsWith uses
			sortable.positionAbs = draggable.positionAbs;
			sortable.helperProportions = draggable.helperProportions;
			sortable.offset.click = draggable.offset.click;

			if ( sortable._intersectsWith( sortable.containerCache ) ) {
				innermostIntersecting = true;

				$.each( draggable.sortables, function() {
					// Copy over variables that sortable's _intersectsWith uses
					this.positionAbs = draggable.positionAbs;
					this.helperProportions = draggable.helperProportions;
					this.offset.click = draggable.offset.click;

					if ( this !== sortable &&
							this._intersectsWith( this.containerCache ) &&
							$.contains( sortable.element[ 0 ], this.element[ 0 ] ) ) {
						innermostIntersecting = false;
					}

					return innermostIntersecting;
				});
			}

			if ( innermostIntersecting ) {
				// If it intersects, we use a little isOver variable and set it once,
				// so that the move-in stuff gets fired only once.
				if ( !sortable.isOver ) {
					sortable.isOver = 1;

					// Store draggable's parent in case we need to reappend to it later.
					draggable._parent = ui.helper.parent();

					sortable.currentItem = ui.helper
						.appendTo( sortable.element )
						.data( "ui-sortable-item", true );

					// Store helper option to later restore it
					sortable.options._helper = sortable.options.helper;

					sortable.options.helper = function() {
						return ui.helper[ 0 ];
					};

					// Fire the start events of the sortable with our passed browser event,
					// and our own helper (so it doesn't create a new one)
					event.target = sortable.currentItem[ 0 ];
					sortable._mouseCapture( event, true );
					sortable._mouseStart( event, true, true );

					// Because the browser event is way off the new appended portlet,
					// modify necessary variables to reflect the changes
					sortable.offset.click.top = draggable.offset.click.top;
					sortable.offset.click.left = draggable.offset.click.left;
					sortable.offset.parent.left -= draggable.offset.parent.left -
						sortable.offset.parent.left;
					sortable.offset.parent.top -= draggable.offset.parent.top -
						sortable.offset.parent.top;

					draggable._trigger( "toSortable", event );

					// Inform draggable that the helper is in a valid drop zone,
					// used solely in the revert option to handle "valid/invalid".
					draggable.dropped = sortable.element;

					// Need to refreshPositions of all sortables in the case that
					// adding to one sortable changes the location of the other sortables (#9675)
					$.each( draggable.sortables, function() {
						this.refreshPositions();
					});

					// hack so receive/update callbacks work (mostly)
					draggable.currentItem = draggable.element;
					sortable.fromOutside = draggable;
				}

				if ( sortable.currentItem ) {
					sortable._mouseDrag( event );
					// Copy the sortable's position because the draggable's can potentially reflect
					// a relative position, while sortable is always absolute, which the dragged
					// element has now become. (#8809)
					ui.position = sortable.position;
				}
			} else {
				// If it doesn't intersect with the sortable, and it intersected before,
				// we fake the drag stop of the sortable, but make sure it doesn't remove
				// the helper by using cancelHelperRemoval.
				if ( sortable.isOver ) {

					sortable.isOver = 0;
					sortable.cancelHelperRemoval = true;

					// Calling sortable's mouseStop would trigger a revert,
					// so revert must be temporarily false until after mouseStop is called.
					sortable.options._revert = sortable.options.revert;
					sortable.options.revert = false;

					sortable._trigger( "out", event, sortable._uiHash( sortable ) );
					sortable._mouseStop( event, true );

					// restore sortable behaviors that were modfied
					// when the draggable entered the sortable area (#9481)
					sortable.options.revert = sortable.options._revert;
					sortable.options.helper = sortable.options._helper;

					if ( sortable.placeholder ) {
						sortable.placeholder.remove();
					}

					// Restore and recalculate the draggable's offset considering the sortable
					// may have modified them in unexpected ways. (#8809, #10669)
					ui.helper.appendTo( draggable._parent );
					draggable._refreshOffsets( event );
					ui.position = draggable._generatePosition( event, true );

					draggable._trigger( "fromSortable", event );

					// Inform draggable that the helper is no longer in a valid drop zone
					draggable.dropped = false;

					// Need to refreshPositions of all sortables just in case removing
					// from one sortable changes the location of other sortables (#9675)
					$.each( draggable.sortables, function() {
						this.refreshPositions();
					});
				}
			}
		});
	}
});

$.ui.plugin.add("draggable", "cursor", {
	start: function( event, ui, instance ) {
		var t = $( "body" ),
			o = instance.options;

		if (t.css("cursor")) {
			o._cursor = t.css("cursor");
		}
		t.css("cursor", o.cursor);
	},
	stop: function( event, ui, instance ) {
		var o = instance.options;
		if (o._cursor) {
			$("body").css("cursor", o._cursor);
		}
	}
});

$.ui.plugin.add("draggable", "opacity", {
	start: function( event, ui, instance ) {
		var t = $( ui.helper ),
			o = instance.options;
		if (t.css("opacity")) {
			o._opacity = t.css("opacity");
		}
		t.css("opacity", o.opacity);
	},
	stop: function( event, ui, instance ) {
		var o = instance.options;
		if (o._opacity) {
			$(ui.helper).css("opacity", o._opacity);
		}
	}
});

$.ui.plugin.add("draggable", "scroll", {
	start: function( event, ui, i ) {
		if ( !i.scrollParentNotHidden ) {
			i.scrollParentNotHidden = i.helper.scrollParent( false );
		}

		if ( i.scrollParentNotHidden[ 0 ] !== i.document[ 0 ] && i.scrollParentNotHidden[ 0 ].tagName !== "HTML" ) {
			i.overflowOffset = i.scrollParentNotHidden.offset();
		}
	},
	drag: function( event, ui, i  ) {

		var o = i.options,
			scrolled = false,
			scrollParent = i.scrollParentNotHidden[ 0 ],
			document = i.document[ 0 ];

		if ( scrollParent !== document && scrollParent.tagName !== "HTML" ) {
			if ( !o.axis || o.axis !== "x" ) {
				if ( ( i.overflowOffset.top + scrollParent.offsetHeight ) - event.pageY < o.scrollSensitivity ) {
					scrollParent.scrollTop = scrolled = scrollParent.scrollTop + o.scrollSpeed;
				} else if ( event.pageY - i.overflowOffset.top < o.scrollSensitivity ) {
					scrollParent.scrollTop = scrolled = scrollParent.scrollTop - o.scrollSpeed;
				}
			}

			if ( !o.axis || o.axis !== "y" ) {
				if ( ( i.overflowOffset.left + scrollParent.offsetWidth ) - event.pageX < o.scrollSensitivity ) {
					scrollParent.scrollLeft = scrolled = scrollParent.scrollLeft + o.scrollSpeed;
				} else if ( event.pageX - i.overflowOffset.left < o.scrollSensitivity ) {
					scrollParent.scrollLeft = scrolled = scrollParent.scrollLeft - o.scrollSpeed;
				}
			}

		} else {

			if (!o.axis || o.axis !== "x") {
				if (event.pageY - $(document).scrollTop() < o.scrollSensitivity) {
					scrolled = $(document).scrollTop($(document).scrollTop() - o.scrollSpeed);
				} else if ($(window).height() - (event.pageY - $(document).scrollTop()) < o.scrollSensitivity) {
					scrolled = $(document).scrollTop($(document).scrollTop() + o.scrollSpeed);
				}
			}

			if (!o.axis || o.axis !== "y") {
				if (event.pageX - $(document).scrollLeft() < o.scrollSensitivity) {
					scrolled = $(document).scrollLeft($(document).scrollLeft() - o.scrollSpeed);
				} else if ($(window).width() - (event.pageX - $(document).scrollLeft()) < o.scrollSensitivity) {
					scrolled = $(document).scrollLeft($(document).scrollLeft() + o.scrollSpeed);
				}
			}

		}

		if (scrolled !== false && $.ui.ddmanager && !o.dropBehaviour) {
			$.ui.ddmanager.prepareOffsets(i, event);
		}

	}
});

$.ui.plugin.add("draggable", "snap", {
	start: function( event, ui, i ) {

		var o = i.options;

		i.snapElements = [];

		$(o.snap.constructor !== String ? ( o.snap.items || ":data(ui-draggable)" ) : o.snap).each(function() {
			var $t = $(this),
				$o = $t.offset();
			if (this !== i.element[0]) {
				i.snapElements.push({
					item: this,
					width: $t.outerWidth(), height: $t.outerHeight(),
					top: $o.top, left: $o.left
				});
			}
		});

	},
	drag: function( event, ui, inst ) {

		var ts, bs, ls, rs, l, r, t, b, i, first,
			o = inst.options,
			d = o.snapTolerance,
			x1 = ui.offset.left, x2 = x1 + inst.helperProportions.width,
			y1 = ui.offset.top, y2 = y1 + inst.helperProportions.height;

		for (i = inst.snapElements.length - 1; i >= 0; i--){

			l = inst.snapElements[i].left - inst.margins.left;
			r = l + inst.snapElements[i].width;
			t = inst.snapElements[i].top - inst.margins.top;
			b = t + inst.snapElements[i].height;

			if ( x2 < l - d || x1 > r + d || y2 < t - d || y1 > b + d || !$.contains( inst.snapElements[ i ].item.ownerDocument, inst.snapElements[ i ].item ) ) {
				if (inst.snapElements[i].snapping) {
					(inst.options.snap.release && inst.options.snap.release.call(inst.element, event, $.extend(inst._uiHash(), { snapItem: inst.snapElements[i].item })));
				}
				inst.snapElements[i].snapping = false;
				continue;
			}

			if (o.snapMode !== "inner") {
				ts = Math.abs(t - y2) <= d;
				bs = Math.abs(b - y1) <= d;
				ls = Math.abs(l - x2) <= d;
				rs = Math.abs(r - x1) <= d;
				if (ts) {
					ui.position.top = inst._convertPositionTo("relative", { top: t - inst.helperProportions.height, left: 0 }).top;
				}
				if (bs) {
					ui.position.top = inst._convertPositionTo("relative", { top: b, left: 0 }).top;
				}
				if (ls) {
					ui.position.left = inst._convertPositionTo("relative", { top: 0, left: l - inst.helperProportions.width }).left;
				}
				if (rs) {
					ui.position.left = inst._convertPositionTo("relative", { top: 0, left: r }).left;
				}
			}

			first = (ts || bs || ls || rs);

			if (o.snapMode !== "outer") {
				ts = Math.abs(t - y1) <= d;
				bs = Math.abs(b - y2) <= d;
				ls = Math.abs(l - x1) <= d;
				rs = Math.abs(r - x2) <= d;
				if (ts) {
					ui.position.top = inst._convertPositionTo("relative", { top: t, left: 0 }).top;
				}
				if (bs) {
					ui.position.top = inst._convertPositionTo("relative", { top: b - inst.helperProportions.height, left: 0 }).top;
				}
				if (ls) {
					ui.position.left = inst._convertPositionTo("relative", { top: 0, left: l }).left;
				}
				if (rs) {
					ui.position.left = inst._convertPositionTo("relative", { top: 0, left: r - inst.helperProportions.width }).left;
				}
			}

			if (!inst.snapElements[i].snapping && (ts || bs || ls || rs || first)) {
				(inst.options.snap.snap && inst.options.snap.snap.call(inst.element, event, $.extend(inst._uiHash(), { snapItem: inst.snapElements[i].item })));
			}
			inst.snapElements[i].snapping = (ts || bs || ls || rs || first);

		}

	}
});

$.ui.plugin.add("draggable", "stack", {
	start: function( event, ui, instance ) {
		var min,
			o = instance.options,
			group = $.makeArray($(o.stack)).sort(function(a, b) {
				return (parseInt($(a).css("zIndex"), 10) || 0) - (parseInt($(b).css("zIndex"), 10) || 0);
			});

		if (!group.length) { return; }

		min = parseInt($(group[0]).css("zIndex"), 10) || 0;
		$(group).each(function(i) {
			$(this).css("zIndex", min + i);
		});
		this.css("zIndex", (min + group.length));
	}
});

$.ui.plugin.add("draggable", "zIndex", {
	start: function( event, ui, instance ) {
		var t = $( ui.helper ),
			o = instance.options;

		if (t.css("zIndex")) {
			o._zIndex = t.css("zIndex");
		}
		t.css("zIndex", o.zIndex);
	},
	stop: function( event, ui, instance ) {
		var o = instance.options;

		if (o._zIndex) {
			$(ui.helper).css("zIndex", o._zIndex);
		}
	}
});

var draggable = $.ui.draggable;


/*!
 * jQuery UI Sortable 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/sortable/
 */


var sortable = $.widget("ui.sortable", $.ui.mouse, {
	version: "1.11.4",
	widgetEventPrefix: "sort",
	ready: false,
	options: {
		appendTo: "parent",
		axis: false,
		connectWith: false,
		containment: false,
		cursor: "auto",
		cursorAt: false,
		dropOnEmpty: true,
		forcePlaceholderSize: false,
		forceHelperSize: false,
		grid: false,
		handle: false,
		helper: "original",
		items: "> *",
		opacity: false,
		placeholder: false,
		revert: false,
		scroll: true,
		scrollSensitivity: 20,
		scrollSpeed: 20,
		scope: "default",
		tolerance: "intersect",
		zIndex: 1000,

		// callbacks
		activate: null,
		beforeStop: null,
		change: null,
		deactivate: null,
		out: null,
		over: null,
		receive: null,
		remove: null,
		sort: null,
		start: null,
		stop: null,
		update: null
	},

	_isOverAxis: function( x, reference, size ) {
		return ( x >= reference ) && ( x < ( reference + size ) );
	},

	_isFloating: function( item ) {
		return (/left|right/).test(item.css("float")) || (/inline|table-cell/).test(item.css("display"));
	},

	_create: function() {
		this.containerCache = {};
		this.element.addClass("ui-sortable");

		//Get the items
		this.refresh();

		//Let's determine the parent's offset
		this.offset = this.element.offset();

		//Initialize mouse events for interaction
		this._mouseInit();

		this._setHandleClassName();

		//We're ready to go
		this.ready = true;

	},

	_setOption: function( key, value ) {
		this._super( key, value );

		if ( key === "handle" ) {
			this._setHandleClassName();
		}
	},

	_setHandleClassName: function() {
		this.element.find( ".ui-sortable-handle" ).removeClass( "ui-sortable-handle" );
		$.each( this.items, function() {
			( this.instance.options.handle ?
				this.item.find( this.instance.options.handle ) : this.item )
				.addClass( "ui-sortable-handle" );
		});
	},

	_destroy: function() {
		this.element
			.removeClass( "ui-sortable ui-sortable-disabled" )
			.find( ".ui-sortable-handle" )
				.removeClass( "ui-sortable-handle" );
		this._mouseDestroy();

		for ( var i = this.items.length - 1; i >= 0; i-- ) {
			this.items[i].item.removeData(this.widgetName + "-item");
		}

		return this;
	},

	_mouseCapture: function(event, overrideHandle) {
		var currentItem = null,
			validHandle = false,
			that = this;

		if (this.reverting) {
			return false;
		}

		if(this.options.disabled || this.options.type === "static") {
			return false;
		}

		//We have to refresh the items data once first
		this._refreshItems(event);

		//Find out if the clicked node (or one of its parents) is a actual item in this.items
		$(event.target).parents().each(function() {
			if($.data(this, that.widgetName + "-item") === that) {
				currentItem = $(this);
				return false;
			}
		});
		if($.data(event.target, that.widgetName + "-item") === that) {
			currentItem = $(event.target);
		}

		if(!currentItem) {
			return false;
		}
		if(this.options.handle && !overrideHandle) {
			$(this.options.handle, currentItem).find("*").addBack().each(function() {
				if(this === event.target) {
					validHandle = true;
				}
			});
			if(!validHandle) {
				return false;
			}
		}

		this.currentItem = currentItem;
		this._removeCurrentsFromItems();
		return true;

	},

	_mouseStart: function(event, overrideHandle, noActivation) {

		var i, body,
			o = this.options;

		this.currentContainer = this;

		//We only need to call refreshPositions, because the refreshItems call has been moved to mouseCapture
		this.refreshPositions();

		//Create and append the visible helper
		this.helper = this._createHelper(event);

		//Cache the helper size
		this._cacheHelperProportions();

		/*
		 * - Position generation -
		 * This block generates everything position related - it's the core of draggables.
		 */

		//Cache the margins of the original element
		this._cacheMargins();

		//Get the next scrolling parent
		this.scrollParent = this.helper.scrollParent();

		//The element's absolute position on the page minus margins
		this.offset = this.currentItem.offset();
		this.offset = {
			top: this.offset.top - this.margins.top,
			left: this.offset.left - this.margins.left
		};

		$.extend(this.offset, {
			click: { //Where the click happened, relative to the element
				left: event.pageX - this.offset.left,
				top: event.pageY - this.offset.top
			},
			parent: this._getParentOffset(),
			relative: this._getRelativeOffset() //This is a relative to absolute position minus the actual position calculation - only used for relative positioned helper
		});

		// Only after we got the offset, we can change the helper's position to absolute
		// TODO: Still need to figure out a way to make relative sorting possible
		this.helper.css("position", "absolute");
		this.cssPosition = this.helper.css("position");

		//Generate the original position
		this.originalPosition = this._generatePosition(event);
		this.originalPageX = event.pageX;
		this.originalPageY = event.pageY;

		//Adjust the mouse offset relative to the helper if "cursorAt" is supplied
		(o.cursorAt && this._adjustOffsetFromHelper(o.cursorAt));

		//Cache the former DOM position
		this.domPosition = { prev: this.currentItem.prev()[0], parent: this.currentItem.parent()[0] };

		//If the helper is not the original, hide the original so it's not playing any role during the drag, won't cause anything bad this way
		if(this.helper[0] !== this.currentItem[0]) {
			this.currentItem.hide();
		}

		//Create the placeholder
		this._createPlaceholder();

		//Set a containment if given in the options
		if(o.containment) {
			this._setContainment();
		}

		if( o.cursor && o.cursor !== "auto" ) { // cursor option
			body = this.document.find( "body" );

			// support: IE
			this.storedCursor = body.css( "cursor" );
			body.css( "cursor", o.cursor );

			this.storedStylesheet = $( "<style>*{ cursor: "+o.cursor+" !important; }</style>" ).appendTo( body );
		}

		if(o.opacity) { // opacity option
			if (this.helper.css("opacity")) {
				this._storedOpacity = this.helper.css("opacity");
			}
			this.helper.css("opacity", o.opacity);
		}

		if(o.zIndex) { // zIndex option
			if (this.helper.css("zIndex")) {
				this._storedZIndex = this.helper.css("zIndex");
			}
			this.helper.css("zIndex", o.zIndex);
		}

		//Prepare scrolling
		if(this.scrollParent[0] !== this.document[0] && this.scrollParent[0].tagName !== "HTML") {
			this.overflowOffset = this.scrollParent.offset();
		}

		//Call callbacks
		this._trigger("start", event, this._uiHash());

		//Recache the helper size
		if(!this._preserveHelperProportions) {
			this._cacheHelperProportions();
		}


		//Post "activate" events to possible containers
		if( !noActivation ) {
			for ( i = this.containers.length - 1; i >= 0; i-- ) {
				this.containers[ i ]._trigger( "activate", event, this._uiHash( this ) );
			}
		}

		//Prepare possible droppables
		if($.ui.ddmanager) {
			$.ui.ddmanager.current = this;
		}

		if ($.ui.ddmanager && !o.dropBehaviour) {
			$.ui.ddmanager.prepareOffsets(this, event);
		}

		this.dragging = true;

		this.helper.addClass("ui-sortable-helper");
		this._mouseDrag(event); //Execute the drag once - this causes the helper not to be visible before getting its correct position
		return true;

	},

	_mouseDrag: function(event) {
		var i, item, itemElement, intersection,
			o = this.options,
			scrolled = false;

		//Compute the helpers position
		this.position = this._generatePosition(event);
		this.positionAbs = this._convertPositionTo("absolute");

		if (!this.lastPositionAbs) {
			this.lastPositionAbs = this.positionAbs;
		}

		//Do scrolling
		if(this.options.scroll) {
			if(this.scrollParent[0] !== this.document[0] && this.scrollParent[0].tagName !== "HTML") {

				if((this.overflowOffset.top + this.scrollParent[0].offsetHeight) - event.pageY < o.scrollSensitivity) {
					this.scrollParent[0].scrollTop = scrolled = this.scrollParent[0].scrollTop + o.scrollSpeed;
				} else if(event.pageY - this.overflowOffset.top < o.scrollSensitivity) {
					this.scrollParent[0].scrollTop = scrolled = this.scrollParent[0].scrollTop - o.scrollSpeed;
				}

				if((this.overflowOffset.left + this.scrollParent[0].offsetWidth) - event.pageX < o.scrollSensitivity) {
					this.scrollParent[0].scrollLeft = scrolled = this.scrollParent[0].scrollLeft + o.scrollSpeed;
				} else if(event.pageX - this.overflowOffset.left < o.scrollSensitivity) {
					this.scrollParent[0].scrollLeft = scrolled = this.scrollParent[0].scrollLeft - o.scrollSpeed;
				}

			} else {

				if(event.pageY - this.document.scrollTop() < o.scrollSensitivity) {
					scrolled = this.document.scrollTop(this.document.scrollTop() - o.scrollSpeed);
				} else if(this.window.height() - (event.pageY - this.document.scrollTop()) < o.scrollSensitivity) {
					scrolled = this.document.scrollTop(this.document.scrollTop() + o.scrollSpeed);
				}

				if(event.pageX - this.document.scrollLeft() < o.scrollSensitivity) {
					scrolled = this.document.scrollLeft(this.document.scrollLeft() - o.scrollSpeed);
				} else if(this.window.width() - (event.pageX - this.document.scrollLeft()) < o.scrollSensitivity) {
					scrolled = this.document.scrollLeft(this.document.scrollLeft() + o.scrollSpeed);
				}

			}

			if(scrolled !== false && $.ui.ddmanager && !o.dropBehaviour) {
				$.ui.ddmanager.prepareOffsets(this, event);
			}
		}

		//Regenerate the absolute position used for position checks
		this.positionAbs = this._convertPositionTo("absolute");

		//Set the helper position
		if(!this.options.axis || this.options.axis !== "y") {
			this.helper[0].style.left = this.position.left+"px";
		}
		if(!this.options.axis || this.options.axis !== "x") {
			this.helper[0].style.top = this.position.top+"px";
		}

		//Rearrange
		for (i = this.items.length - 1; i >= 0; i--) {

			//Cache variables and intersection, continue if no intersection
			item = this.items[i];
			itemElement = item.item[0];
			intersection = this._intersectsWithPointer(item);
			if (!intersection) {
				continue;
			}

			// Only put the placeholder inside the current Container, skip all
			// items from other containers. This works because when moving
			// an item from one container to another the
			// currentContainer is switched before the placeholder is moved.
			//
			// Without this, moving items in "sub-sortables" can cause
			// the placeholder to jitter between the outer and inner container.
			if (item.instance !== this.currentContainer) {
				continue;
			}

			// cannot intersect with itself
			// no useless actions that have been done before
			// no action if the item moved is the parent of the item checked
			if (itemElement !== this.currentItem[0] &&
				this.placeholder[intersection === 1 ? "next" : "prev"]()[0] !== itemElement &&
				!$.contains(this.placeholder[0], itemElement) &&
				(this.options.type === "semi-dynamic" ? !$.contains(this.element[0], itemElement) : true)
			) {

				this.direction = intersection === 1 ? "down" : "up";

				if (this.options.tolerance === "pointer" || this._intersectsWithSides(item)) {
					this._rearrange(event, item);
				} else {
					break;
				}

				this._trigger("change", event, this._uiHash());
				break;
			}
		}

		//Post events to containers
		this._contactContainers(event);

		//Interconnect with droppables
		if($.ui.ddmanager) {
			$.ui.ddmanager.drag(this, event);
		}

		//Call callbacks
		this._trigger("sort", event, this._uiHash());

		this.lastPositionAbs = this.positionAbs;
		return false;

	},

	_mouseStop: function(event, noPropagation) {

		if(!event) {
			return;
		}

		//If we are using droppables, inform the manager about the drop
		if ($.ui.ddmanager && !this.options.dropBehaviour) {
			$.ui.ddmanager.drop(this, event);
		}

		if(this.options.revert) {
			var that = this,
				cur = this.placeholder.offset(),
				axis = this.options.axis,
				animation = {};

			if ( !axis || axis === "x" ) {
				animation.left = cur.left - this.offset.parent.left - this.margins.left + (this.offsetParent[0] === this.document[0].body ? 0 : this.offsetParent[0].scrollLeft);
			}
			if ( !axis || axis === "y" ) {
				animation.top = cur.top - this.offset.parent.top - this.margins.top + (this.offsetParent[0] === this.document[0].body ? 0 : this.offsetParent[0].scrollTop);
			}
			this.reverting = true;
			$(this.helper).animate( animation, parseInt(this.options.revert, 10) || 500, function() {
				that._clear(event);
			});
		} else {
			this._clear(event, noPropagation);
		}

		return false;

	},

	cancel: function() {

		if(this.dragging) {

			this._mouseUp({ target: null });

			if(this.options.helper === "original") {
				this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");
			} else {
				this.currentItem.show();
			}

			//Post deactivating events to containers
			for (var i = this.containers.length - 1; i >= 0; i--){
				this.containers[i]._trigger("deactivate", null, this._uiHash(this));
				if(this.containers[i].containerCache.over) {
					this.containers[i]._trigger("out", null, this._uiHash(this));
					this.containers[i].containerCache.over = 0;
				}
			}

		}

		if (this.placeholder) {
			//$(this.placeholder[0]).remove(); would have been the jQuery way - unfortunately, it unbinds ALL events from the original node!
			if(this.placeholder[0].parentNode) {
				this.placeholder[0].parentNode.removeChild(this.placeholder[0]);
			}
			if(this.options.helper !== "original" && this.helper && this.helper[0].parentNode) {
				this.helper.remove();
			}

			$.extend(this, {
				helper: null,
				dragging: false,
				reverting: false,
				_noFinalSort: null
			});

			if(this.domPosition.prev) {
				$(this.domPosition.prev).after(this.currentItem);
			} else {
				$(this.domPosition.parent).prepend(this.currentItem);
			}
		}

		return this;

	},

	serialize: function(o) {

		var items = this._getItemsAsjQuery(o && o.connected),
			str = [];
		o = o || {};

		$(items).each(function() {
			var res = ($(o.item || this).attr(o.attribute || "id") || "").match(o.expression || (/(.+)[\-=_](.+)/));
			if (res) {
				str.push((o.key || res[1]+"[]")+"="+(o.key && o.expression ? res[1] : res[2]));
			}
		});

		if(!str.length && o.key) {
			str.push(o.key + "=");
		}

		return str.join("&");

	},

	toArray: function(o) {

		var items = this._getItemsAsjQuery(o && o.connected),
			ret = [];

		o = o || {};

		items.each(function() { ret.push($(o.item || this).attr(o.attribute || "id") || ""); });
		return ret;

	},

	/* Be careful with the following core functions */
	_intersectsWith: function(item) {

		var x1 = this.positionAbs.left,
			x2 = x1 + this.helperProportions.width,
			y1 = this.positionAbs.top,
			y2 = y1 + this.helperProportions.height,
			l = item.left,
			r = l + item.width,
			t = item.top,
			b = t + item.height,
			dyClick = this.offset.click.top,
			dxClick = this.offset.click.left,
			isOverElementHeight = ( this.options.axis === "x" ) || ( ( y1 + dyClick ) > t && ( y1 + dyClick ) < b ),
			isOverElementWidth = ( this.options.axis === "y" ) || ( ( x1 + dxClick ) > l && ( x1 + dxClick ) < r ),
			isOverElement = isOverElementHeight && isOverElementWidth;

		if ( this.options.tolerance === "pointer" ||
			this.options.forcePointerForContainers ||
			(this.options.tolerance !== "pointer" && this.helperProportions[this.floating ? "width" : "height"] > item[this.floating ? "width" : "height"])
		) {
			return isOverElement;
		} else {

			return (l < x1 + (this.helperProportions.width / 2) && // Right Half
				x2 - (this.helperProportions.width / 2) < r && // Left Half
				t < y1 + (this.helperProportions.height / 2) && // Bottom Half
				y2 - (this.helperProportions.height / 2) < b ); // Top Half

		}
	},

	_intersectsWithPointer: function(item) {

		var isOverElementHeight = (this.options.axis === "x") || this._isOverAxis(this.positionAbs.top + this.offset.click.top, item.top, item.height),
			isOverElementWidth = (this.options.axis === "y") || this._isOverAxis(this.positionAbs.left + this.offset.click.left, item.left, item.width),
			isOverElement = isOverElementHeight && isOverElementWidth,
			verticalDirection = this._getDragVerticalDirection(),
			horizontalDirection = this._getDragHorizontalDirection();

		if (!isOverElement) {
			return false;
		}

		return this.floating ?
			( ((horizontalDirection && horizontalDirection === "right") || verticalDirection === "down") ? 2 : 1 )
			: ( verticalDirection && (verticalDirection === "down" ? 2 : 1) );

	},

	_intersectsWithSides: function(item) {

		var isOverBottomHalf = this._isOverAxis(this.positionAbs.top + this.offset.click.top, item.top + (item.height/2), item.height),
			isOverRightHalf = this._isOverAxis(this.positionAbs.left + this.offset.click.left, item.left + (item.width/2), item.width),
			verticalDirection = this._getDragVerticalDirection(),
			horizontalDirection = this._getDragHorizontalDirection();

		if (this.floating && horizontalDirection) {
			return ((horizontalDirection === "right" && isOverRightHalf) || (horizontalDirection === "left" && !isOverRightHalf));
		} else {
			return verticalDirection && ((verticalDirection === "down" && isOverBottomHalf) || (verticalDirection === "up" && !isOverBottomHalf));
		}

	},

	_getDragVerticalDirection: function() {
		var delta = this.positionAbs.top - this.lastPositionAbs.top;
		return delta !== 0 && (delta > 0 ? "down" : "up");
	},

	_getDragHorizontalDirection: function() {
		var delta = this.positionAbs.left - this.lastPositionAbs.left;
		return delta !== 0 && (delta > 0 ? "right" : "left");
	},

	refresh: function(event) {
		this._refreshItems(event);
		this._setHandleClassName();
		this.refreshPositions();
		return this;
	},

	_connectWith: function() {
		var options = this.options;
		return options.connectWith.constructor === String ? [options.connectWith] : options.connectWith;
	},

	_getItemsAsjQuery: function(connected) {

		var i, j, cur, inst,
			items = [],
			queries = [],
			connectWith = this._connectWith();

		if(connectWith && connected) {
			for (i = connectWith.length - 1; i >= 0; i--){
				cur = $(connectWith[i], this.document[0]);
				for ( j = cur.length - 1; j >= 0; j--){
					inst = $.data(cur[j], this.widgetFullName);
					if(inst && inst !== this && !inst.options.disabled) {
						queries.push([$.isFunction(inst.options.items) ? inst.options.items.call(inst.element) : $(inst.options.items, inst.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), inst]);
					}
				}
			}
		}

		queries.push([$.isFunction(this.options.items) ? this.options.items.call(this.element, null, { options: this.options, item: this.currentItem }) : $(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this]);

		function addItems() {
			items.push( this );
		}
		for (i = queries.length - 1; i >= 0; i--){
			queries[i][0].each( addItems );
		}

		return $(items);

	},

	_removeCurrentsFromItems: function() {

		var list = this.currentItem.find(":data(" + this.widgetName + "-item)");

		this.items = $.grep(this.items, function (item) {
			for (var j=0; j < list.length; j++) {
				if(list[j] === item.item[0]) {
					return false;
				}
			}
			return true;
		});

	},

	_refreshItems: function(event) {

		this.items = [];
		this.containers = [this];

		var i, j, cur, inst, targetData, _queries, item, queriesLength,
			items = this.items,
			queries = [[$.isFunction(this.options.items) ? this.options.items.call(this.element[0], event, { item: this.currentItem }) : $(this.options.items, this.element), this]],
			connectWith = this._connectWith();

		if(connectWith && this.ready) { //Shouldn't be run the first time through due to massive slow-down
			for (i = connectWith.length - 1; i >= 0; i--){
				cur = $(connectWith[i], this.document[0]);
				for (j = cur.length - 1; j >= 0; j--){
					inst = $.data(cur[j], this.widgetFullName);
					if(inst && inst !== this && !inst.options.disabled) {
						queries.push([$.isFunction(inst.options.items) ? inst.options.items.call(inst.element[0], event, { item: this.currentItem }) : $(inst.options.items, inst.element), inst]);
						this.containers.push(inst);
					}
				}
			}
		}

		for (i = queries.length - 1; i >= 0; i--) {
			targetData = queries[i][1];
			_queries = queries[i][0];

			for (j=0, queriesLength = _queries.length; j < queriesLength; j++) {
				item = $(_queries[j]);

				item.data(this.widgetName + "-item", targetData); // Data for target checking (mouse manager)

				items.push({
					item: item,
					instance: targetData,
					width: 0, height: 0,
					left: 0, top: 0
				});
			}
		}

	},

	refreshPositions: function(fast) {

		// Determine whether items are being displayed horizontally
		this.floating = this.items.length ?
			this.options.axis === "x" || this._isFloating( this.items[ 0 ].item ) :
			false;

		//This has to be redone because due to the item being moved out/into the offsetParent, the offsetParent's position will change
		if(this.offsetParent && this.helper) {
			this.offset.parent = this._getParentOffset();
		}

		var i, item, t, p;

		for (i = this.items.length - 1; i >= 0; i--){
			item = this.items[i];

			//We ignore calculating positions of all connected containers when we're not over them
			if(item.instance !== this.currentContainer && this.currentContainer && item.item[0] !== this.currentItem[0]) {
				continue;
			}

			t = this.options.toleranceElement ? $(this.options.toleranceElement, item.item) : item.item;

			if (!fast) {
				item.width = t.outerWidth();
				item.height = t.outerHeight();
			}

			p = t.offset();
			item.left = p.left;
			item.top = p.top;
		}

		if(this.options.custom && this.options.custom.refreshContainers) {
			this.options.custom.refreshContainers.call(this);
		} else {
			for (i = this.containers.length - 1; i >= 0; i--){
				p = this.containers[i].element.offset();
				this.containers[i].containerCache.left = p.left;
				this.containers[i].containerCache.top = p.top;
				this.containers[i].containerCache.width = this.containers[i].element.outerWidth();
				this.containers[i].containerCache.height = this.containers[i].element.outerHeight();
			}
		}

		return this;
	},

	_createPlaceholder: function(that) {
		that = that || this;
		var className,
			o = that.options;

		if(!o.placeholder || o.placeholder.constructor === String) {
			className = o.placeholder;
			o.placeholder = {
				element: function() {

					var nodeName = that.currentItem[0].nodeName.toLowerCase(),
						element = $( "<" + nodeName + ">", that.document[0] )
							.addClass(className || that.currentItem[0].className+" ui-sortable-placeholder")
							.removeClass("ui-sortable-helper");

					if ( nodeName === "tbody" ) {
						that._createTrPlaceholder(
							that.currentItem.find( "tr" ).eq( 0 ),
							$( "<tr>", that.document[ 0 ] ).appendTo( element )
						);
					} else if ( nodeName === "tr" ) {
						that._createTrPlaceholder( that.currentItem, element );
					} else if ( nodeName === "img" ) {
						element.attr( "src", that.currentItem.attr( "src" ) );
					}

					if ( !className ) {
						element.css( "visibility", "hidden" );
					}

					return element;
				},
				update: function(container, p) {

					// 1. If a className is set as 'placeholder option, we don't force sizes - the class is responsible for that
					// 2. The option 'forcePlaceholderSize can be enabled to force it even if a class name is specified
					if(className && !o.forcePlaceholderSize) {
						return;
					}

					//If the element doesn't have a actual height by itself (without styles coming from a stylesheet), it receives the inline height from the dragged item
					if(!p.height()) { p.height(that.currentItem.innerHeight() - parseInt(that.currentItem.css("paddingTop")||0, 10) - parseInt(that.currentItem.css("paddingBottom")||0, 10)); }
					if(!p.width()) { p.width(that.currentItem.innerWidth() - parseInt(that.currentItem.css("paddingLeft")||0, 10) - parseInt(that.currentItem.css("paddingRight")||0, 10)); }
				}
			};
		}

		//Create the placeholder
		that.placeholder = $(o.placeholder.element.call(that.element, that.currentItem));

		//Append it after the actual current item
		that.currentItem.after(that.placeholder);

		//Update the size of the placeholder (TODO: Logic to fuzzy, see line 316/317)
		o.placeholder.update(that, that.placeholder);

	},

	_createTrPlaceholder: function( sourceTr, targetTr ) {
		var that = this;

		sourceTr.children().each(function() {
			$( "<td>&#160;</td>", that.document[ 0 ] )
				.attr( "colspan", $( this ).attr( "colspan" ) || 1 )
				.appendTo( targetTr );
		});
	},

	_contactContainers: function(event) {
		var i, j, dist, itemWithLeastDistance, posProperty, sizeProperty, cur, nearBottom, floating, axis,
			innermostContainer = null,
			innermostIndex = null;

		// get innermost container that intersects with item
		for (i = this.containers.length - 1; i >= 0; i--) {

			// never consider a container that's located within the item itself
			if($.contains(this.currentItem[0], this.containers[i].element[0])) {
				continue;
			}

			if(this._intersectsWith(this.containers[i].containerCache)) {

				// if we've already found a container and it's more "inner" than this, then continue
				if(innermostContainer && $.contains(this.containers[i].element[0], innermostContainer.element[0])) {
					continue;
				}

				innermostContainer = this.containers[i];
				innermostIndex = i;

			} else {
				// container doesn't intersect. trigger "out" event if necessary
				if(this.containers[i].containerCache.over) {
					this.containers[i]._trigger("out", event, this._uiHash(this));
					this.containers[i].containerCache.over = 0;
				}
			}

		}

		// if no intersecting containers found, return
		if(!innermostContainer) {
			return;
		}

		// move the item into the container if it's not there already
		if(this.containers.length === 1) {
			if (!this.containers[innermostIndex].containerCache.over) {
				this.containers[innermostIndex]._trigger("over", event, this._uiHash(this));
				this.containers[innermostIndex].containerCache.over = 1;
			}
		} else {

			//When entering a new container, we will find the item with the least distance and append our item near it
			dist = 10000;
			itemWithLeastDistance = null;
			floating = innermostContainer.floating || this._isFloating(this.currentItem);
			posProperty = floating ? "left" : "top";
			sizeProperty = floating ? "width" : "height";
			axis = floating ? "clientX" : "clientY";

			for (j = this.items.length - 1; j >= 0; j--) {
				if(!$.contains(this.containers[innermostIndex].element[0], this.items[j].item[0])) {
					continue;
				}
				if(this.items[j].item[0] === this.currentItem[0]) {
					continue;
				}

				cur = this.items[j].item.offset()[posProperty];
				nearBottom = false;
				if ( event[ axis ] - cur > this.items[ j ][ sizeProperty ] / 2 ) {
					nearBottom = true;
				}

				if ( Math.abs( event[ axis ] - cur ) < dist ) {
					dist = Math.abs( event[ axis ] - cur );
					itemWithLeastDistance = this.items[ j ];
					this.direction = nearBottom ? "up": "down";
				}
			}

			//Check if dropOnEmpty is enabled
			if(!itemWithLeastDistance && !this.options.dropOnEmpty) {
				return;
			}

			if(this.currentContainer === this.containers[innermostIndex]) {
				if ( !this.currentContainer.containerCache.over ) {
					this.containers[ innermostIndex ]._trigger( "over", event, this._uiHash() );
					this.currentContainer.containerCache.over = 1;
				}
				return;
			}

			itemWithLeastDistance ? this._rearrange(event, itemWithLeastDistance, null, true) : this._rearrange(event, null, this.containers[innermostIndex].element, true);
			this._trigger("change", event, this._uiHash());
			this.containers[innermostIndex]._trigger("change", event, this._uiHash(this));
			this.currentContainer = this.containers[innermostIndex];

			//Update the placeholder
			this.options.placeholder.update(this.currentContainer, this.placeholder);

			this.containers[innermostIndex]._trigger("over", event, this._uiHash(this));
			this.containers[innermostIndex].containerCache.over = 1;
		}


	},

	_createHelper: function(event) {

		var o = this.options,
			helper = $.isFunction(o.helper) ? $(o.helper.apply(this.element[0], [event, this.currentItem])) : (o.helper === "clone" ? this.currentItem.clone() : this.currentItem);

		//Add the helper to the DOM if that didn't happen already
		if(!helper.parents("body").length) {
			$(o.appendTo !== "parent" ? o.appendTo : this.currentItem[0].parentNode)[0].appendChild(helper[0]);
		}

		if(helper[0] === this.currentItem[0]) {
			this._storedCSS = { width: this.currentItem[0].style.width, height: this.currentItem[0].style.height, position: this.currentItem.css("position"), top: this.currentItem.css("top"), left: this.currentItem.css("left") };
		}

		if(!helper[0].style.width || o.forceHelperSize) {
			helper.width(this.currentItem.width());
		}
		if(!helper[0].style.height || o.forceHelperSize) {
			helper.height(this.currentItem.height());
		}

		return helper;

	},

	_adjustOffsetFromHelper: function(obj) {
		if (typeof obj === "string") {
			obj = obj.split(" ");
		}
		if ($.isArray(obj)) {
			obj = {left: +obj[0], top: +obj[1] || 0};
		}
		if ("left" in obj) {
			this.offset.click.left = obj.left + this.margins.left;
		}
		if ("right" in obj) {
			this.offset.click.left = this.helperProportions.width - obj.right + this.margins.left;
		}
		if ("top" in obj) {
			this.offset.click.top = obj.top + this.margins.top;
		}
		if ("bottom" in obj) {
			this.offset.click.top = this.helperProportions.height - obj.bottom + this.margins.top;
		}
	},

	_getParentOffset: function() {


		//Get the offsetParent and cache its position
		this.offsetParent = this.helper.offsetParent();
		var po = this.offsetParent.offset();

		// This is a special case where we need to modify a offset calculated on start, since the following happened:
		// 1. The position of the helper is absolute, so it's position is calculated based on the next positioned parent
		// 2. The actual offset parent is a child of the scroll parent, and the scroll parent isn't the document, which means that
		//    the scroll is included in the initial calculation of the offset of the parent, and never recalculated upon drag
		if(this.cssPosition === "absolute" && this.scrollParent[0] !== this.document[0] && $.contains(this.scrollParent[0], this.offsetParent[0])) {
			po.left += this.scrollParent.scrollLeft();
			po.top += this.scrollParent.scrollTop();
		}

		// This needs to be actually done for all browsers, since pageX/pageY includes this information
		// with an ugly IE fix
		if( this.offsetParent[0] === this.document[0].body || (this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() === "html" && $.ui.ie)) {
			po = { top: 0, left: 0 };
		}

		return {
			top: po.top + (parseInt(this.offsetParent.css("borderTopWidth"),10) || 0),
			left: po.left + (parseInt(this.offsetParent.css("borderLeftWidth"),10) || 0)
		};

	},

	_getRelativeOffset: function() {

		if(this.cssPosition === "relative") {
			var p = this.currentItem.position();
			return {
				top: p.top - (parseInt(this.helper.css("top"),10) || 0) + this.scrollParent.scrollTop(),
				left: p.left - (parseInt(this.helper.css("left"),10) || 0) + this.scrollParent.scrollLeft()
			};
		} else {
			return { top: 0, left: 0 };
		}

	},

	_cacheMargins: function() {
		this.margins = {
			left: (parseInt(this.currentItem.css("marginLeft"),10) || 0),
			top: (parseInt(this.currentItem.css("marginTop"),10) || 0)
		};
	},

	_cacheHelperProportions: function() {
		this.helperProportions = {
			width: this.helper.outerWidth(),
			height: this.helper.outerHeight()
		};
	},

	_setContainment: function() {

		var ce, co, over,
			o = this.options;
		if(o.containment === "parent") {
			o.containment = this.helper[0].parentNode;
		}
		if(o.containment === "document" || o.containment === "window") {
			this.containment = [
				0 - this.offset.relative.left - this.offset.parent.left,
				0 - this.offset.relative.top - this.offset.parent.top,
				o.containment === "document" ? this.document.width() : this.window.width() - this.helperProportions.width - this.margins.left,
				(o.containment === "document" ? this.document.width() : this.window.height() || this.document[0].body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top
			];
		}

		if(!(/^(document|window|parent)$/).test(o.containment)) {
			ce = $(o.containment)[0];
			co = $(o.containment).offset();
			over = ($(ce).css("overflow") !== "hidden");

			this.containment = [
				co.left + (parseInt($(ce).css("borderLeftWidth"),10) || 0) + (parseInt($(ce).css("paddingLeft"),10) || 0) - this.margins.left,
				co.top + (parseInt($(ce).css("borderTopWidth"),10) || 0) + (parseInt($(ce).css("paddingTop"),10) || 0) - this.margins.top,
				co.left+(over ? Math.max(ce.scrollWidth,ce.offsetWidth) : ce.offsetWidth) - (parseInt($(ce).css("borderLeftWidth"),10) || 0) - (parseInt($(ce).css("paddingRight"),10) || 0) - this.helperProportions.width - this.margins.left,
				co.top+(over ? Math.max(ce.scrollHeight,ce.offsetHeight) : ce.offsetHeight) - (parseInt($(ce).css("borderTopWidth"),10) || 0) - (parseInt($(ce).css("paddingBottom"),10) || 0) - this.helperProportions.height - this.margins.top
			];
		}

	},

	_convertPositionTo: function(d, pos) {

		if(!pos) {
			pos = this.position;
		}
		var mod = d === "absolute" ? 1 : -1,
			scroll = this.cssPosition === "absolute" && !(this.scrollParent[0] !== this.document[0] && $.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent,
			scrollIsRootNode = (/(html|body)/i).test(scroll[0].tagName);

		return {
			top: (
				pos.top	+																// The absolute mouse position
				this.offset.relative.top * mod +										// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.top * mod -											// The offsetParent's offset without borders (offset + border)
				( ( this.cssPosition === "fixed" ? -this.scrollParent.scrollTop() : ( scrollIsRootNode ? 0 : scroll.scrollTop() ) ) * mod)
			),
			left: (
				pos.left +																// The absolute mouse position
				this.offset.relative.left * mod +										// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.left * mod	-										// The offsetParent's offset without borders (offset + border)
				( ( this.cssPosition === "fixed" ? -this.scrollParent.scrollLeft() : scrollIsRootNode ? 0 : scroll.scrollLeft() ) * mod)
			)
		};

	},

	_generatePosition: function(event) {

		var top, left,
			o = this.options,
			pageX = event.pageX,
			pageY = event.pageY,
			scroll = this.cssPosition === "absolute" && !(this.scrollParent[0] !== this.document[0] && $.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent, scrollIsRootNode = (/(html|body)/i).test(scroll[0].tagName);

		// This is another very weird special case that only happens for relative elements:
		// 1. If the css position is relative
		// 2. and the scroll parent is the document or similar to the offset parent
		// we have to refresh the relative offset during the scroll so there are no jumps
		if(this.cssPosition === "relative" && !(this.scrollParent[0] !== this.document[0] && this.scrollParent[0] !== this.offsetParent[0])) {
			this.offset.relative = this._getRelativeOffset();
		}

		/*
		 * - Position constraining -
		 * Constrain the position to a mix of grid, containment.
		 */

		if(this.originalPosition) { //If we are not dragging yet, we won't check for options

			if(this.containment) {
				if(event.pageX - this.offset.click.left < this.containment[0]) {
					pageX = this.containment[0] + this.offset.click.left;
				}
				if(event.pageY - this.offset.click.top < this.containment[1]) {
					pageY = this.containment[1] + this.offset.click.top;
				}
				if(event.pageX - this.offset.click.left > this.containment[2]) {
					pageX = this.containment[2] + this.offset.click.left;
				}
				if(event.pageY - this.offset.click.top > this.containment[3]) {
					pageY = this.containment[3] + this.offset.click.top;
				}
			}

			if(o.grid) {
				top = this.originalPageY + Math.round((pageY - this.originalPageY) / o.grid[1]) * o.grid[1];
				pageY = this.containment ? ( (top - this.offset.click.top >= this.containment[1] && top - this.offset.click.top <= this.containment[3]) ? top : ((top - this.offset.click.top >= this.containment[1]) ? top - o.grid[1] : top + o.grid[1])) : top;

				left = this.originalPageX + Math.round((pageX - this.originalPageX) / o.grid[0]) * o.grid[0];
				pageX = this.containment ? ( (left - this.offset.click.left >= this.containment[0] && left - this.offset.click.left <= this.containment[2]) ? left : ((left - this.offset.click.left >= this.containment[0]) ? left - o.grid[0] : left + o.grid[0])) : left;
			}

		}

		return {
			top: (
				pageY -																// The absolute mouse position
				this.offset.click.top -													// Click offset (relative to the element)
				this.offset.relative.top	-											// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.top +												// The offsetParent's offset without borders (offset + border)
				( ( this.cssPosition === "fixed" ? -this.scrollParent.scrollTop() : ( scrollIsRootNode ? 0 : scroll.scrollTop() ) ))
			),
			left: (
				pageX -																// The absolute mouse position
				this.offset.click.left -												// Click offset (relative to the element)
				this.offset.relative.left	-											// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.left +												// The offsetParent's offset without borders (offset + border)
				( ( this.cssPosition === "fixed" ? -this.scrollParent.scrollLeft() : scrollIsRootNode ? 0 : scroll.scrollLeft() ))
			)
		};

	},

	_rearrange: function(event, i, a, hardRefresh) {

		a ? a[0].appendChild(this.placeholder[0]) : i.item[0].parentNode.insertBefore(this.placeholder[0], (this.direction === "down" ? i.item[0] : i.item[0].nextSibling));

		//Various things done here to improve the performance:
		// 1. we create a setTimeout, that calls refreshPositions
		// 2. on the instance, we have a counter variable, that get's higher after every append
		// 3. on the local scope, we copy the counter variable, and check in the timeout, if it's still the same
		// 4. this lets only the last addition to the timeout stack through
		this.counter = this.counter ? ++this.counter : 1;
		var counter = this.counter;

		this._delay(function() {
			if(counter === this.counter) {
				this.refreshPositions(!hardRefresh); //Precompute after each DOM insertion, NOT on mousemove
			}
		});

	},

	_clear: function(event, noPropagation) {

		this.reverting = false;
		// We delay all events that have to be triggered to after the point where the placeholder has been removed and
		// everything else normalized again
		var i,
			delayedTriggers = [];

		// We first have to update the dom position of the actual currentItem
		// Note: don't do it if the current item is already removed (by a user), or it gets reappended (see #4088)
		if(!this._noFinalSort && this.currentItem.parent().length) {
			this.placeholder.before(this.currentItem);
		}
		this._noFinalSort = null;

		if(this.helper[0] === this.currentItem[0]) {
			for(i in this._storedCSS) {
				if(this._storedCSS[i] === "auto" || this._storedCSS[i] === "static") {
					this._storedCSS[i] = "";
				}
			}
			this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");
		} else {
			this.currentItem.show();
		}

		if(this.fromOutside && !noPropagation) {
			delayedTriggers.push(function(event) { this._trigger("receive", event, this._uiHash(this.fromOutside)); });
		}
		if((this.fromOutside || this.domPosition.prev !== this.currentItem.prev().not(".ui-sortable-helper")[0] || this.domPosition.parent !== this.currentItem.parent()[0]) && !noPropagation) {
			delayedTriggers.push(function(event) { this._trigger("update", event, this._uiHash()); }); //Trigger update callback if the DOM position has changed
		}

		// Check if the items Container has Changed and trigger appropriate
		// events.
		if (this !== this.currentContainer) {
			if(!noPropagation) {
				delayedTriggers.push(function(event) { this._trigger("remove", event, this._uiHash()); });
				delayedTriggers.push((function(c) { return function(event) { c._trigger("receive", event, this._uiHash(this)); };  }).call(this, this.currentContainer));
				delayedTriggers.push((function(c) { return function(event) { c._trigger("update", event, this._uiHash(this));  }; }).call(this, this.currentContainer));
			}
		}


		//Post events to containers
		function delayEvent( type, instance, container ) {
			return function( event ) {
				container._trigger( type, event, instance._uiHash( instance ) );
			};
		}
		for (i = this.containers.length - 1; i >= 0; i--){
			if (!noPropagation) {
				delayedTriggers.push( delayEvent( "deactivate", this, this.containers[ i ] ) );
			}
			if(this.containers[i].containerCache.over) {
				delayedTriggers.push( delayEvent( "out", this, this.containers[ i ] ) );
				this.containers[i].containerCache.over = 0;
			}
		}

		//Do what was originally in plugins
		if ( this.storedCursor ) {
			this.document.find( "body" ).css( "cursor", this.storedCursor );
			this.storedStylesheet.remove();
		}
		if(this._storedOpacity) {
			this.helper.css("opacity", this._storedOpacity);
		}
		if(this._storedZIndex) {
			this.helper.css("zIndex", this._storedZIndex === "auto" ? "" : this._storedZIndex);
		}

		this.dragging = false;

		if(!noPropagation) {
			this._trigger("beforeStop", event, this._uiHash());
		}

		//$(this.placeholder[0]).remove(); would have been the jQuery way - unfortunately, it unbinds ALL events from the original node!
		this.placeholder[0].parentNode.removeChild(this.placeholder[0]);

		if ( !this.cancelHelperRemoval ) {
			if ( this.helper[ 0 ] !== this.currentItem[ 0 ] ) {
				this.helper.remove();
			}
			this.helper = null;
		}

		if(!noPropagation) {
			for (i=0; i < delayedTriggers.length; i++) {
				delayedTriggers[i].call(this, event);
			} //Trigger all delayed events
			this._trigger("stop", event, this._uiHash());
		}

		this.fromOutside = false;
		return !this.cancelHelperRemoval;

	},

	_trigger: function() {
		if ($.Widget.prototype._trigger.apply(this, arguments) === false) {
			this.cancel();
		}
	},

	_uiHash: function(_inst) {
		var inst = _inst || this;
		return {
			helper: inst.helper,
			placeholder: inst.placeholder || $([]),
			position: inst.position,
			originalPosition: inst.originalPosition,
			offset: inst.positionAbs,
			item: inst.currentItem,
			sender: _inst ? _inst.element : null
		};
	}

});



}));
/* canvas-toBlob.js
 * A canvas.toBlob() implementation.
 * 2013-12-27
 * 
 * By Eli Grey, http://eligrey.com and Devin Samarin, https://github.com/eboyjr
 * License: X11/MIT
 *   See https://github.com/eligrey/canvas-toBlob.js/blob/master/LICENSE.md
 */

/*global self */
/*jslint bitwise: true, regexp: true, confusion: true, es5: true, vars: true, white: true,
  plusplus: true */

/*! @source http://purl.eligrey.com/github/canvas-toBlob.js/blob/master/canvas-toBlob.js */

(function(view) {
"use strict";
var
	  Uint8Array = view.Uint8Array
	, HTMLCanvasElement = view.HTMLCanvasElement
	, canvas_proto = HTMLCanvasElement && HTMLCanvasElement.prototype
	, is_base64_regex = /\s*;\s*base64\s*(?:;|$)/i
	, to_data_url = "toDataURL"
	, base64_ranks
	, decode_base64 = function(base64) {
		var
			  len = base64.length
			, buffer = new Uint8Array(len / 4 * 3 | 0)
			, i = 0
			, outptr = 0
			, last = [0, 0]
			, state = 0
			, save = 0
			, rank
			, code
			, undef
		;
		while (len--) {
			code = base64.charCodeAt(i++);
			rank = base64_ranks[code-43];
			if (rank !== 255 && rank !== undef) {
				last[1] = last[0];
				last[0] = code;
				save = (save << 6) | rank;
				state++;
				if (state === 4) {
					buffer[outptr++] = save >>> 16;
					if (last[1] !== 61 /* padding character */) {
						buffer[outptr++] = save >>> 8;
					}
					if (last[0] !== 61 /* padding character */) {
						buffer[outptr++] = save;
					}
					state = 0;
				}
			}
		}
		// 2/3 chance there's going to be some null bytes at the end, but that
		// doesn't really matter with most image formats.
		// If it somehow matters for you, truncate the buffer up outptr.
		return buffer;
	}
;
if (Uint8Array) {
	base64_ranks = new Uint8Array([
		  62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1
		, -1, -1,  0, -1, -1, -1,  0,  1,  2,  3,  4,  5,  6,  7,  8,  9
		, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25
		, -1, -1, -1, -1, -1, -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35
		, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51
	]);
}
if (HTMLCanvasElement && !canvas_proto.toBlob) {
	canvas_proto.toBlob = function(callback, type /*, ...args*/) {
		  if (!type) {
			type = "image/png";
		} if (this.mozGetAsFile) {
			callback(this.mozGetAsFile("canvas", type));
			return;
		} if (this.msToBlob && /^\s*image\/png\s*(?:$|;)/i.test(type)) {
			callback(this.msToBlob());
			return;
		}

		var
			  args = Array.prototype.slice.call(arguments, 1)
			, dataURI = this[to_data_url].apply(this, args)
			, header_end = dataURI.indexOf(",")
			, data = dataURI.substring(header_end + 1)
			, is_base64 = is_base64_regex.test(dataURI.substring(0, header_end))
			, blob
		;
		if (Blob.fake) {
			// no reason to decode a data: URI that's just going to become a data URI again
			blob = new Blob
			if (is_base64) {
				blob.encoding = "base64";
			} else {
				blob.encoding = "URI";
			}
			blob.data = data;
			blob.size = data.length;
		} else if (Uint8Array) {
			if (is_base64) {
				blob = new Blob([decode_base64(data)], {type: type});
			} else {
				blob = new Blob([decodeURIComponent(data)], {type: type});
			}
		}
		callback(blob);
	};

	if (canvas_proto.toDataURLHD) {
		canvas_proto.toBlobHD = function() {
			to_data_url = "toDataURLHD";
			var blob = this.toBlob();
			to_data_url = "toDataURL";
			return blob;
		}
	} else {
		canvas_proto.toBlobHD = canvas_proto.toBlob;
	}
}
}(typeof self !== "undefined" && self || typeof window !== "undefined" && window || this.content || this));

/* FileSaver.js
 * A saveAs() FileSaver implementation.
 * 2015-03-04
 *
 * By Eli Grey, http://eligrey.com
 * License: X11/MIT
 *   See https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md
 */

/*global self */
/*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */

/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */

var saveAs = saveAs
  // IE 10+ (native saveAs)
  || (typeof navigator !== "undefined" &&
      navigator.msSaveOrOpenBlob && navigator.msSaveOrOpenBlob.bind(navigator))
  // Everyone else
  || (function(view) {
	"use strict";
	// IE <10 is explicitly unsupported
	if (typeof navigator !== "undefined" &&
	    /MSIE [1-9]\./.test(navigator.userAgent)) {
		return;
	}
	var
		  doc = view.document
		  // only get URL when necessary in case Blob.js hasn't overridden it yet
		, get_URL = function() {
			return view.URL || view.webkitURL || view;
		}
		, save_link = doc.createElementNS("http://www.w3.org/1999/xhtml", "a")
		, can_use_save_link = "download" in save_link
		, click = function(node) {
			var event = doc.createEvent("MouseEvents");
			event.initMouseEvent(
				"click", true, false, view, 0, 0, 0, 0, 0
				, false, false, false, false, 0, null
			);
			node.dispatchEvent(event);
		}
		, webkit_req_fs = view.webkitRequestFileSystem
		, req_fs = view.requestFileSystem || webkit_req_fs || view.mozRequestFileSystem
		, throw_outside = function(ex) {
			(view.setImmediate || view.setTimeout)(function() {
				throw ex;
			}, 0);
		}
		, force_saveable_type = "application/octet-stream"
		, fs_min_size = 0
		// See https://code.google.com/p/chromium/issues/detail?id=375297#c7 and
		// https://github.com/eligrey/FileSaver.js/commit/485930a#commitcomment-8768047
		// for the reasoning behind the timeout and revocation flow
		, arbitrary_revoke_timeout = 500 // in ms
		, revoke = function(file) {
			var revoker = function() {
				if (typeof file === "string") { // file is an object URL
					get_URL().revokeObjectURL(file);
				} else { // file is a File
					file.remove();
				}
			};
			if (view.chrome) {
				revoker();
			} else {
				setTimeout(revoker, arbitrary_revoke_timeout);
			}
		}
		, dispatch = function(filesaver, event_types, event) {
			event_types = [].concat(event_types);
			var i = event_types.length;
			while (i--) {
				var listener = filesaver["on" + event_types[i]];
				if (typeof listener === "function") {
					try {
						listener.call(filesaver, event || filesaver);
					} catch (ex) {
						throw_outside(ex);
					}
				}
			}
		}
		, FileSaver = function(blob, name) {
			// First try a.download, then web filesystem, then object URLs
			var
				  filesaver = this
				, type = blob.type
				, blob_changed = false
				, object_url
				, target_view
				, dispatch_all = function() {
					dispatch(filesaver, "writestart progress write writeend".split(" "));
				}
				// on any filesys errors revert to saving with object URLs
				, fs_error = function() {
					// don't create more object URLs than needed
					if (blob_changed || !object_url) {
						object_url = get_URL().createObjectURL(blob);
					}
					if (target_view) {
						target_view.location.href = object_url;
					} else {
						var new_tab = view.open(object_url, "_blank");
						if (new_tab == undefined && typeof safari !== "undefined") {
							//Apple do not allow window.open, see http://bit.ly/1kZffRI
							view.location.href = object_url
						}
					}
					filesaver.readyState = filesaver.DONE;
					dispatch_all();
					revoke(object_url);
				}
				, abortable = function(func) {
					return function() {
						if (filesaver.readyState !== filesaver.DONE) {
							return func.apply(this, arguments);
						}
					};
				}
				, create_if_not_found = {create: true, exclusive: false}
				, slice
			;
			filesaver.readyState = filesaver.INIT;
			if (!name) {
				name = "download";
			}
			if (can_use_save_link) {
				object_url = get_URL().createObjectURL(blob);
				save_link.href = object_url;
				save_link.download = name;
				click(save_link);
				filesaver.readyState = filesaver.DONE;
				dispatch_all();
				revoke(object_url);
				return;
			}
			// prepend BOM for UTF-8 XML and text/plain types
			if (/^\s*(?:text\/(?:plain|xml)|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(blob.type)) {
				blob = new Blob(["\ufeff", blob], {type: blob.type});
			}
			// Object and web filesystem URLs have a problem saving in Google Chrome when
			// viewed in a tab, so I force save with application/octet-stream
			// http://code.google.com/p/chromium/issues/detail?id=91158
			// Update: Google errantly closed 91158, I submitted it again:
			// https://code.google.com/p/chromium/issues/detail?id=389642
			if (view.chrome && type && type !== force_saveable_type) {
				slice = blob.slice || blob.webkitSlice;
				blob = slice.call(blob, 0, blob.size, force_saveable_type);
				blob_changed = true;
			}
			// Since I can't be sure that the guessed media type will trigger a download
			// in WebKit, I append .download to the filename.
			// https://bugs.webkit.org/show_bug.cgi?id=65440
			if (webkit_req_fs && name !== "download") {
				name += ".download";
			}
			if (type === force_saveable_type || webkit_req_fs) {
				target_view = view;
			}
			if (!req_fs) {
				fs_error();
				return;
			}
			fs_min_size += blob.size;
			req_fs(view.TEMPORARY, fs_min_size, abortable(function(fs) {
				fs.root.getDirectory("saved", create_if_not_found, abortable(function(dir) {
					var save = function() {
						dir.getFile(name, create_if_not_found, abortable(function(file) {
							file.createWriter(abortable(function(writer) {
								writer.onwriteend = function(event) {
									target_view.location.href = file.toURL();
									filesaver.readyState = filesaver.DONE;
									dispatch(filesaver, "writeend", event);
									revoke(file);
								};
								writer.onerror = function() {
									var error = writer.error;
									if (error.code !== error.ABORT_ERR) {
										fs_error();
									}
								};
								"writestart progress write abort".split(" ").forEach(function(event) {
									writer["on" + event] = filesaver["on" + event];
								});
								writer.write(blob);
								filesaver.abort = function() {
									writer.abort();
									filesaver.readyState = filesaver.DONE;
								};
								filesaver.readyState = filesaver.WRITING;
							}), fs_error);
						}), fs_error);
					};
					dir.getFile(name, {create: false}, abortable(function(file) {
						// delete file if it already exists
						file.remove();
						save();
					}), abortable(function(ex) {
						if (ex.code === ex.NOT_FOUND_ERR) {
							save();
						} else {
							fs_error();
						}
					}));
				}), fs_error);
			}), fs_error);
		}
		, FS_proto = FileSaver.prototype
		, saveAs = function(blob, name) {
			return new FileSaver(blob, name);
		}
	;
	FS_proto.abort = function() {
		var filesaver = this;
		filesaver.readyState = filesaver.DONE;
		dispatch(filesaver, "abort");
	};
	FS_proto.readyState = FS_proto.INIT = 0;
	FS_proto.WRITING = 1;
	FS_proto.DONE = 2;

	FS_proto.error =
	FS_proto.onwritestart =
	FS_proto.onprogress =
	FS_proto.onwrite =
	FS_proto.onabort =
	FS_proto.onerror =
	FS_proto.onwriteend =
		null;

	return saveAs;
}(
	   typeof self !== "undefined" && self
	|| typeof window !== "undefined" && window
	|| this.content
));
// `self` is undefined in Firefox for Android content script context
// while `this` is nsIContentFrameMessageManager
// with an attribute `content` that corresponds to the window

if (typeof module !== "undefined" && module.exports) {
  module.exports.saveAs = saveAs;
} else if ((typeof define !== "undefined" && define !== null) && (define.amd != null)) {
  define([], function() {
    return saveAs;
  });
}

/**
* simplePagination.js v1.6
* A simple jQuery pagination plugin.
* http://flaviusmatis.github.com/simplePagination.js/
*
* Copyright 2012, Flavius Matis
* Released under the MIT license.
* http://flaviusmatis.github.com/license.html
*/

(function($){

	var methods = {
		init: function(options) {
			var o = $.extend({
				items: 1,
				itemsOnPage: 1,
				pages: 0,
				displayedPages: 5,
				edges: 2,
				currentPage: 0,
				hrefTextPrefix: '#page-',
				hrefTextSuffix: '',
				prevText: 'Prev',
				nextText: 'Next',
				ellipseText: '&hellip;',
				cssStyle: 'light-theme',
				labelMap: [],
				selectOnClick: true,
				nextAtFront: false,
				invertPageOrder: false,
				onPageClick: function(pageNumber, event) {
					// Callback triggered when a page is clicked
					// Page number is given as an optional parameter
				},
				onInit: function() {
					// Callback triggered immediately after initialization
				}
			}, options || {});

			var self = this;

			o.pages = o.pages ? o.pages : Math.ceil(o.items / o.itemsOnPage) ? Math.ceil(o.items / o.itemsOnPage) : 1;
			if (o.currentPage)
				o.currentPage = o.currentPage - 1;
			else
				o.currentPage = !o.invertPageOrder ? 0 : o.pages - 1;
			o.halfDisplayed = o.displayedPages / 2;

			this.each(function() {
				self.addClass(o.cssStyle + ' simple-pagination').data('pagination', o);
				methods._draw.call(self);
			});

			o.onInit();

			return this;
		},

		selectPage: function(page) {
			methods._selectPage.call(this, page - 1);
			return this;
		},

		prevPage: function() {
			var o = this.data('pagination');
			if (!o.invertPageOrder) {
				if (o.currentPage > 0) {
					methods._selectPage.call(this, o.currentPage - 1);
				}
			} else {
				if (o.currentPage < o.pages - 1) {
					methods._selectPage.call(this, o.currentPage + 1);
				}
			}
			return this;
		},

		nextPage: function() {
			var o = this.data('pagination');
			if (!o.invertPageOrder) {
				if (o.currentPage < o.pages - 1) {
					methods._selectPage.call(this, o.currentPage + 1);
				}
			} else {
				if (o.currentPage > 0) {
					methods._selectPage.call(this, o.currentPage - 1);
				}
			}
			return this;
		},

		getPagesCount: function() {
			return this.data('pagination').pages;
		},

		getCurrentPage: function () {
			return this.data('pagination').currentPage + 1;
		},

		destroy: function(){
			this.empty();
			return this;
		},

		drawPage: function (page) {
			var o = this.data('pagination');
			o.currentPage = page - 1;
			this.data('pagination', o);
			methods._draw.call(this);
			return this;
		},

		redraw: function(){
			methods._draw.call(this);
			return this;
		},

		disable: function(){
			var o = this.data('pagination');
			o.disabled = true;
			this.data('pagination', o);
			methods._draw.call(this);
			return this;
		},

		enable: function(){
			var o = this.data('pagination');
			o.disabled = false;
			this.data('pagination', o);
			methods._draw.call(this);
			return this;
		},

		updateItems: function (newItems) {
			var o = this.data('pagination');
			o.items = newItems;
			o.pages = methods._getPages(o);
			this.data('pagination', o);
			methods._draw.call(this);
		},

		updateItemsOnPage: function (itemsOnPage) {
			var o = this.data('pagination');
			o.itemsOnPage = itemsOnPage;
			o.pages = methods._getPages(o);
			this.data('pagination', o);
			methods._selectPage.call(this, 0);
			return this;
		},

		_draw: function() {
			var	o = this.data('pagination'),
				interval = methods._getInterval(o),
				i,
				tagName;

			methods.destroy.call(this);
			
			tagName = (typeof this.prop === 'function') ? this.prop('tagName') : this.attr('tagName');

			var $panel = tagName === 'UL' ? this : $('<ul></ul>').appendTo(this);

			// Generate Prev link
			if (o.prevText) {
				methods._appendItem.call(this, !o.invertPageOrder ? o.currentPage - 1 : o.currentPage + 1, {text: o.prevText, classes: 'prev'});
			}

			// Generate Next link (if option set for at front)
			if (o.nextText && o.nextAtFront) {
				methods._appendItem.call(this, !o.invertPageOrder ? o.currentPage + 1 : o.currentPage - 1, {text: o.nextText, classes: 'next'});
			}

			// Generate start edges
			if (!o.invertPageOrder) {
				if (interval.start > 0 && o.edges > 0) {
					var end = Math.min(o.edges, interval.start);
					for (i = 0; i < end; i++) {
						methods._appendItem.call(this, i);
					}
					if (o.edges < interval.start && (interval.start - o.edges != 1)) {
						$panel.append('<li class="disabled"><span class="ellipse">' + o.ellipseText + '</span></li>');
					} else if (interval.start - o.edges == 1) {
						methods._appendItem.call(this, o.edges);
					}
				}
			} else {
				if (interval.end < o.pages && o.edges > 0) {
					var begin = Math.max(o.pages - o.edges, interval.end);
					for (i = o.pages - 1; i >= begin; i--) {
						methods._appendItem.call(this, i);
					}
					if (o.pages - o.edges > interval.end && (o.pages - o.edges - interval.end != 1)) {
						$panel.append('<li class="disabled"><span class="ellipse">' + o.ellipseText + '</span></li>');
					} else if (o.pages - o.edges - interval.end == 1) {
						methods._appendItem.call(this, interval.end);
					}
				}
			}

			// Generate interval links
			if (!o.invertPageOrder) {
				for (i = interval.start; i < interval.end; i++) {
					methods._appendItem.call(this, i);
				}
			} else {
				for (i = interval.end - 1; i >= interval.start; i--) {
					methods._appendItem.call(this, i);
				}
			}

			// Generate end edges
			if (!o.invertPageOrder) {
				if (interval.end < o.pages && o.edges > 0) {
					if (o.pages - o.edges > interval.end && (o.pages - o.edges - interval.end != 1)) {
						$panel.append('<li class="disabled"><span class="ellipse">' + o.ellipseText + '</span></li>');
					} else if (o.pages - o.edges - interval.end == 1) {
						methods._appendItem.call(this, interval.end);
					}
					var begin = Math.max(o.pages - o.edges, interval.end);
					for (i = begin; i < o.pages; i++) {
						methods._appendItem.call(this, i);
					}
				}
			} else {
				if (interval.start > 0 && o.edges > 0) {
					if (o.edges < interval.start && (interval.start - o.edges != 1)) {
						$panel.append('<li class="disabled"><span class="ellipse">' + o.ellipseText + '</span></li>');
					} else if (interval.start - o.edges == 1) {
						methods._appendItem.call(this, o.edges);
					}
					var end = Math.min(o.edges, interval.start);
					for (i = end - 1; i >= 0; i--) {
						methods._appendItem.call(this, i);
					}
				}
			}

			// Generate Next link (unless option is set for at front)
			if (o.nextText && !o.nextAtFront) {
				methods._appendItem.call(this, !o.invertPageOrder ? o.currentPage + 1 : o.currentPage - 1, {text: o.nextText, classes: 'next'});
			}
		},

		_getPages: function(o) {
			var pages = Math.ceil(o.items / o.itemsOnPage);
			return pages || 1;
		},

		_getInterval: function(o) {
			return {
				start: Math.ceil(o.currentPage > o.halfDisplayed ? Math.max(Math.min(o.currentPage - o.halfDisplayed, (o.pages - o.displayedPages)), 0) : 0),
				end: Math.ceil(o.currentPage > o.halfDisplayed ? Math.min(o.currentPage + o.halfDisplayed, o.pages) : Math.min(o.displayedPages, o.pages))
			};
		},

		_appendItem: function(pageIndex, opts) {
			var self = this, options, $link, o = self.data('pagination'), $linkWrapper = $('<li></li>'), $ul = self.find('ul');

			pageIndex = pageIndex < 0 ? 0 : (pageIndex < o.pages ? pageIndex : o.pages - 1);

			options = {
				text: pageIndex + 1,
				classes: ''
			};

			if (o.labelMap.length && o.labelMap[pageIndex]) {
				options.text = o.labelMap[pageIndex];
			}

			options = $.extend(options, opts || {});

			if (pageIndex == o.currentPage || o.disabled) {
				if (o.disabled) {
					$linkWrapper.addClass('disabled');
				} else {
					$linkWrapper.addClass('active');
				}
				$link = $('<span class="current">' + (options.text) + '</span>');
			} else {
				$link = $('<a href="' + o.hrefTextPrefix + (pageIndex + 1) + o.hrefTextSuffix + '" class="page-link">' + (options.text) + '</a>');
				$link.click(function(event){
					return methods._selectPage.call(self, pageIndex, event);
				});
			}

			if (options.classes) {
				$link.addClass(options.classes);
			}

			$linkWrapper.append($link);

			if ($ul.length) {
				$ul.append($linkWrapper);
			} else {
				self.append($linkWrapper);
			}
		},

		_selectPage: function(pageIndex, event) {
			var o = this.data('pagination');
			o.currentPage = pageIndex;
			if (o.selectOnClick) {
				methods._draw.call(this);
			}
			return o.onPageClick(pageIndex + 1, event);
		}

	};

	$.fn.pagination = function(method) {

		// Method calling logic
		if (methods[method] && method.charAt(0) != '_') {
			return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
		} else if (typeof method === 'object' || !method) {
			return methods.init.apply(this, arguments);
		} else {
			$.error('Method ' +  method + ' does not exist on jQuery.pagination');
		}

	};

})(jQuery);

// Spectrum Colorpicker v1.6.0
// https://github.com/bgrins/spectrum
// Author: Brian Grinstead
// License: MIT

(function (factory) {
    "use strict";

    if (typeof define === 'function' && define.amd) { // AMD
        define(['jquery'], factory);
    }
    else if (typeof exports == "object" && typeof module == "object") { // CommonJS
        module.exports = factory;
    }
    else { // Browser
        factory(jQuery);
    }
})(function($, undefined) {
    "use strict";

    var defaultOpts = {

        // Callbacks
        beforeShow: noop,
        move: noop,
        change: noop,
        show: noop,
        hide: noop,

        // Options
        color: false,
        flat: false,
        showInput: false,
        allowEmpty: false,
        showButtons: true,
        clickoutFiresChange: false,
        showInitial: false,
        showPalette: false,
        showPaletteOnly: false,
        hideAfterPaletteSelect: false,
        togglePaletteOnly: false,
        showSelectionPalette: true,
        localStorageKey: false,
        appendTo: "body",
        maxSelectionSize: 7,
        cancelText: "cancel",
        chooseText: "choose",
        togglePaletteMoreText: "more",
        togglePaletteLessText: "less",
        clearText: "Clear Color Selection",
        noColorSelectedText: "No Color Selected",
        preferredFormat: false,
        className: "", // Deprecated - use containerClassName and replacerClassName instead.
        containerClassName: "",
        replacerClassName: "",
        showAlpha: false,
        theme: "sp-light",
        palette: [["#ffffff", "#000000", "#ff0000", "#ff8000", "#ffff00", "#008000", "#0000ff", "#4b0082", "#9400d3"]],
        selectionPalette: [],
        disabled: false,
        offset: null
    },
    spectrums = [],
    IE = !!/msie/i.exec( window.navigator.userAgent ),
    rgbaSupport = (function() {
        function contains( str, substr ) {
            return !!~('' + str).indexOf(substr);
        }

        var elem = document.createElement('div');
        var style = elem.style;
        style.cssText = 'background-color:rgba(0,0,0,.5)';
        return contains(style.backgroundColor, 'rgba') || contains(style.backgroundColor, 'hsla');
    })(),
    inputTypeColorSupport = (function() {
        var colorInput = $("<input type='color' value='!' />")[0];
        return colorInput.type === "color" && colorInput.value !== "!";
    })(),
    replaceInput = [
        "<div class='sp-replacer'>",
            "<div class='sp-preview'><div class='sp-preview-inner'></div></div>",
            "<div class='sp-dd'>&#9660;</div>",
        "</div>"
    ].join(''),
    markup = (function () {

        // IE does not support gradients with multiple stops, so we need to simulate
        //  that for the rainbow slider with 8 divs that each have a single gradient
        var gradientFix = "";
        if (IE) {
            for (var i = 1; i <= 6; i++) {
                gradientFix += "<div class='sp-" + i + "'></div>";
            }
        }

        return [
            "<div class='sp-container sp-hidden'>",
                "<div class='sp-palette-container'>",
                    "<div class='sp-palette sp-thumb sp-cf'></div>",
                    "<div class='sp-palette-button-container sp-cf'>",
                        "<button type='button' class='sp-palette-toggle'></button>",
                    "</div>",
                "</div>",
                "<div class='sp-picker-container'>",
                    "<div class='sp-top sp-cf'>",
                        "<div class='sp-fill'></div>",
                        "<div class='sp-top-inner'>",
                            "<div class='sp-color'>",
                                "<div class='sp-sat'>",
                                    "<div class='sp-val'>",
                                        "<div class='sp-dragger'></div>",
                                    "</div>",
                                "</div>",
                            "</div>",
                            "<div class='sp-clear sp-clear-display'>",
                            "</div>",
                            "<div class='sp-hue'>",
                                "<div class='sp-slider'></div>",
                                gradientFix,
                            "</div>",
                        "</div>",
                        "<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>",
                    "</div>",
                    "<div class='sp-input-container sp-cf'>",
                        "<input class='sp-input' type='text' spellcheck='false'  />",
                    "</div>",
                    "<div class='sp-initial sp-thumb sp-cf'></div>",
                    "<div class='sp-button-container sp-cf'>",
                        "<a class='sp-cancel' href='#'></a>",
                        "<button type='button' class='sp-choose'></button>",
                    "</div>",
                "</div>",
            "</div>"
        ].join("");
    })();

    function paletteTemplate (p, color, className, opts) {
        var html = [];
        for (var i = 0; i < p.length; i++) {
            var current = p[i];
            if(current) {
                var tiny = tinycolor(current);
                var c = tiny.toHsl().l < 0.5 ? "sp-thumb-el sp-thumb-dark" : "sp-thumb-el sp-thumb-light";
                c += (tinycolor.equals(color, current)) ? " sp-thumb-active" : "";
                var formattedString = tiny.toString(opts.preferredFormat || "rgb");
                var swatchStyle = rgbaSupport ? ("background-color:" + tiny.toRgbString()) : "filter:" + tiny.toFilter();
                html.push('<span title="' + formattedString + '" data-color="' + tiny.toRgbString() + '" class="' + c + '"><span class="sp-thumb-inner" style="' + swatchStyle + ';" /></span>');
            } else {
                var cls = 'sp-clear-display';
                html.push($('<div />')
                    .append($('<span data-color="" style="background-color:transparent;" class="' + cls + '"></span>')
                        .attr('title', opts.noColorSelectedText)
                    )
                    .html()
                );
            }
        }
        return "<div class='sp-cf " + className + "'>" + html.join('') + "</div>";
    }

    function hideAll() {
        for (var i = 0; i < spectrums.length; i++) {
            if (spectrums[i]) {
                spectrums[i].hide();
            }
        }
    }

    function instanceOptions(o, callbackContext) {
        var opts = $.extend({}, defaultOpts, o);
        opts.callbacks = {
            'move': bind(opts.move, callbackContext),
            'change': bind(opts.change, callbackContext),
            'show': bind(opts.show, callbackContext),
            'hide': bind(opts.hide, callbackContext),
            'beforeShow': bind(opts.beforeShow, callbackContext)
        };

        return opts;
    }

    function spectrum(element, o) {

        var opts = instanceOptions(o, element),
            flat = opts.flat,
            showSelectionPalette = opts.showSelectionPalette,
            localStorageKey = opts.localStorageKey,
            theme = opts.theme,
            callbacks = opts.callbacks,
            resize = throttle(reflow, 10),
            visible = false,
            dragWidth = 0,
            dragHeight = 0,
            dragHelperHeight = 0,
            slideHeight = 0,
            slideWidth = 0,
            alphaWidth = 0,
            alphaSlideHelperWidth = 0,
            slideHelperHeight = 0,
            currentHue = 0,
            currentSaturation = 0,
            currentValue = 0,
            currentAlpha = 1,
            palette = [],
            paletteArray = [],
            paletteLookup = {},
            selectionPalette = opts.selectionPalette.slice(0),
            maxSelectionSize = opts.maxSelectionSize,
            draggingClass = "sp-dragging",
            shiftMovementDirection = null;

        var doc = element.ownerDocument,
            body = doc.body,
            boundElement = $(element),
            disabled = false,
            container = $(markup, doc).addClass(theme),
            pickerContainer = container.find(".sp-picker-container"),
            dragger = container.find(".sp-color"),
            dragHelper = container.find(".sp-dragger"),
            slider = container.find(".sp-hue"),
            slideHelper = container.find(".sp-slider"),
            alphaSliderInner = container.find(".sp-alpha-inner"),
            alphaSlider = container.find(".sp-alpha"),
            alphaSlideHelper = container.find(".sp-alpha-handle"),
            textInput = container.find(".sp-input"),
            paletteContainer = container.find(".sp-palette"),
            initialColorContainer = container.find(".sp-initial"),
            cancelButton = container.find(".sp-cancel"),
            clearButton = container.find(".sp-clear"),
            chooseButton = container.find(".sp-choose"),
            toggleButton = container.find(".sp-palette-toggle"),
            isInput = boundElement.is("input"),
            isInputTypeColor = isInput && inputTypeColorSupport && boundElement.attr("type") === "color",
            shouldReplace = isInput && !flat,
            replacer = (shouldReplace) ? $(replaceInput).addClass(theme).addClass(opts.className).addClass(opts.replacerClassName) : $([]),
            offsetElement = (shouldReplace) ? replacer : boundElement,
            previewElement = replacer.find(".sp-preview-inner"),
            initialColor = opts.color || (isInput && boundElement.val()),
            colorOnShow = false,
            preferredFormat = opts.preferredFormat,
            currentPreferredFormat = preferredFormat,
            clickoutFiresChange = !opts.showButtons || opts.clickoutFiresChange,
            isEmpty = !initialColor,
            allowEmpty = opts.allowEmpty && !isInputTypeColor;

        function applyOptions() {

            if (opts.showPaletteOnly) {
                opts.showPalette = true;
            }

            toggleButton.text(opts.showPaletteOnly ? opts.togglePaletteMoreText : opts.togglePaletteLessText);

            if (opts.palette) {
                palette = opts.palette.slice(0);
                paletteArray = $.isArray(palette[0]) ? palette : [palette];
                paletteLookup = {};
                for (var i = 0; i < paletteArray.length; i++) {
                    for (var j = 0; j < paletteArray[i].length; j++) {
                        var rgb = tinycolor(paletteArray[i][j]).toRgbString();
                        paletteLookup[rgb] = true;
                    }
                }
            }

            container.toggleClass("sp-flat", flat);
            container.toggleClass("sp-input-disabled", !opts.showInput);
            container.toggleClass("sp-alpha-enabled", opts.showAlpha);
            container.toggleClass("sp-clear-enabled", allowEmpty);
            container.toggleClass("sp-buttons-disabled", !opts.showButtons);
            container.toggleClass("sp-palette-buttons-disabled", !opts.togglePaletteOnly);
            container.toggleClass("sp-palette-disabled", !opts.showPalette);
            container.toggleClass("sp-palette-only", opts.showPaletteOnly);
            container.toggleClass("sp-initial-disabled", !opts.showInitial);
            container.addClass(opts.className).addClass(opts.containerClassName);

            reflow();
        }

        function initialize() {

            if (IE) {
                container.find("*:not(input)").attr("unselectable", "on");
            }

            applyOptions();

            if (shouldReplace) {
                boundElement.after(replacer).hide();
            }

            if (!allowEmpty) {
                clearButton.hide();
            }

            if (flat) {
                boundElement.after(container).hide();
            }
            else {

                var appendTo = opts.appendTo === "parent" ? boundElement.parent() : $(opts.appendTo);
                if (appendTo.length !== 1) {
                    appendTo = $("body");
                }

                appendTo.append(container);
            }

            updateSelectionPaletteFromStorage();

            offsetElement.bind("click.spectrum touchstart.spectrum", function (e) {
                if (!disabled) {
                    toggle();
                }

                e.stopPropagation();

                if (!$(e.target).is("input")) {
                    e.preventDefault();
                }
            });

            if(boundElement.is(":disabled") || (opts.disabled === true)) {
                disable();
            }

            // Prevent clicks from bubbling up to document.  This would cause it to be hidden.
            container.click(stopPropagation);

            // Handle user typed input
            textInput.change(setFromTextInput);
            textInput.bind("paste", function () {
                setTimeout(setFromTextInput, 1);
            });
            textInput.keydown(function (e) { if (e.keyCode == 13) { setFromTextInput(); } });

            cancelButton.text(opts.cancelText);
            cancelButton.bind("click.spectrum", function (e) {
                e.stopPropagation();
                e.preventDefault();
                revert();
                hide();
            });

            clearButton.attr("title", opts.clearText);
            clearButton.bind("click.spectrum", function (e) {
                e.stopPropagation();
                e.preventDefault();
                isEmpty = true;
                move();

                if(flat) {
                    //for the flat style, this is a change event
                    updateOriginalInput(true);
                }
            });

            chooseButton.text(opts.chooseText);
            chooseButton.bind("click.spectrum", function (e) {
                e.stopPropagation();
                e.preventDefault();

                if (isValid()) {
                    updateOriginalInput(true);
                    hide();
                }
            });

            toggleButton.text(opts.showPaletteOnly ? opts.togglePaletteMoreText : opts.togglePaletteLessText);
            toggleButton.bind("click.spectrum", function (e) {
                e.stopPropagation();
                e.preventDefault();

                opts.showPaletteOnly = !opts.showPaletteOnly;

                // To make sure the Picker area is drawn on the right, next to the
                // Palette area (and not below the palette), first move the Palette
                // to the left to make space for the picker, plus 5px extra.
                // The 'applyOptions' function puts the whole container back into place
                // and takes care of the button-text and the sp-palette-only CSS class.
                if (!opts.showPaletteOnly && !flat) {
                    container.css('left', '-=' + (pickerContainer.outerWidth(true) + 5));
                }
                applyOptions();
            });

            draggable(alphaSlider, function (dragX, dragY, e) {
                currentAlpha = (dragX / alphaWidth);
                isEmpty = false;
                if (e.shiftKey) {
                    currentAlpha = Math.round(currentAlpha * 10) / 10;
                }

                move();
            }, dragStart, dragStop);

            draggable(slider, function (dragX, dragY) {
                currentHue = parseFloat(dragY / slideHeight);
                isEmpty = false;
                if (!opts.showAlpha) {
                    currentAlpha = 1;
                }
                move();
            }, dragStart, dragStop);

            draggable(dragger, function (dragX, dragY, e) {

                // shift+drag should snap the movement to either the x or y axis.
                if (!e.shiftKey) {
                    shiftMovementDirection = null;
                }
                else if (!shiftMovementDirection) {
                    var oldDragX = currentSaturation * dragWidth;
                    var oldDragY = dragHeight - (currentValue * dragHeight);
                    var furtherFromX = Math.abs(dragX - oldDragX) > Math.abs(dragY - oldDragY);

                    shiftMovementDirection = furtherFromX ? "x" : "y";
                }

                var setSaturation = !shiftMovementDirection || shiftMovementDirection === "x";
                var setValue = !shiftMovementDirection || shiftMovementDirection === "y";

                if (setSaturation) {
                    currentSaturation = parseFloat(dragX / dragWidth);
                }
                if (setValue) {
                    currentValue = parseFloat((dragHeight - dragY) / dragHeight);
                }

                isEmpty = false;
                if (!opts.showAlpha) {
                    currentAlpha = 1;
                }

                move();

            }, dragStart, dragStop);

            if (!!initialColor) {
                set(initialColor);

                // In case color was black - update the preview UI and set the format
                // since the set function will not run (default color is black).
                updateUI();
                currentPreferredFormat = preferredFormat || tinycolor(initialColor).format;

                addColorToSelectionPalette(initialColor);
            }
            else {
                updateUI();
            }

            if (flat) {
                show();
            }

            function paletteElementClick(e) {
                if (e.data && e.data.ignore) {
                    set($(e.target).closest(".sp-thumb-el").data("color"));
                    move();
                }
                else {
                    set($(e.target).closest(".sp-thumb-el").data("color"));
                    move();
                    updateOriginalInput(true);
                    if (opts.hideAfterPaletteSelect) {
                      hide();
                    }
                }

                return false;
            }

            var paletteEvent = IE ? "mousedown.spectrum" : "click.spectrum touchstart.spectrum";
            paletteContainer.delegate(".sp-thumb-el", paletteEvent, paletteElementClick);
            initialColorContainer.delegate(".sp-thumb-el:nth-child(1)", paletteEvent, { ignore: true }, paletteElementClick);
        }

        function updateSelectionPaletteFromStorage() {

            if (localStorageKey && window.localStorage) {

                // Migrate old palettes over to new format.  May want to remove this eventually.
                try {
                    var oldPalette = window.localStorage[localStorageKey].split(",#");
                    if (oldPalette.length > 1) {
                        delete window.localStorage[localStorageKey];
                        $.each(oldPalette, function(i, c) {
                             addColorToSelectionPalette(c);
                        });
                    }
                }
                catch(e) { }

                try {
                    selectionPalette = window.localStorage[localStorageKey].split(";");
                }
                catch (e) { }
            }
        }

        function addColorToSelectionPalette(color) {
            if (showSelectionPalette) {
                var rgb = tinycolor(color).toRgbString();
                if (!paletteLookup[rgb] && $.inArray(rgb, selectionPalette) === -1) {
                    selectionPalette.push(rgb);
                    while(selectionPalette.length > maxSelectionSize) {
                        selectionPalette.shift();
                    }
                }

                if (localStorageKey && window.localStorage) {
                    try {
                        window.localStorage[localStorageKey] = selectionPalette.join(";");
                    }
                    catch(e) { }
                }
            }
        }

        function getUniqueSelectionPalette() {
            var unique = [];
            if (opts.showPalette) {
                for (var i = 0; i < selectionPalette.length; i++) {
                    var rgb = tinycolor(selectionPalette[i]).toRgbString();

                    if (!paletteLookup[rgb]) {
                        unique.push(selectionPalette[i]);
                    }
                }
            }

            return unique.reverse().slice(0, opts.maxSelectionSize);
        }

        function drawPalette() {

            var currentColor = get();

            var html = $.map(paletteArray, function (palette, i) {
                return paletteTemplate(palette, currentColor, "sp-palette-row sp-palette-row-" + i, opts);
            });

            updateSelectionPaletteFromStorage();

            if (selectionPalette) {
                html.push(paletteTemplate(getUniqueSelectionPalette(), currentColor, "sp-palette-row sp-palette-row-selection", opts));
            }

            paletteContainer.html(html.join(""));
        }

        function drawInitial() {
            if (opts.showInitial) {
                var initial = colorOnShow;
                var current = get();
                initialColorContainer.html(paletteTemplate([initial, current], current, "sp-palette-row-initial", opts));
            }
        }

        function dragStart() {
            if (dragHeight <= 0 || dragWidth <= 0 || slideHeight <= 0) {
                reflow();
            }
            container.addClass(draggingClass);
            shiftMovementDirection = null;
            boundElement.trigger('dragstart.spectrum', [ get() ]);
        }

        function dragStop() {
            container.removeClass(draggingClass);
            boundElement.trigger('dragstop.spectrum', [ get() ]);
        }

        function setFromTextInput() {

            var value = textInput.val();

            if ((value === null || value === "") && allowEmpty) {
                set(null);
                updateOriginalInput(true);
            }
            else {
                var tiny = tinycolor(value);
                if (tiny.isValid()) {
                    set(tiny);
                    updateOriginalInput(true);
                }
                else {
                    textInput.addClass("sp-validation-error");
                }
            }
        }

        function toggle() {
            if (visible) {
                hide();
            }
            else {
                show();
            }
        }

        function show() {
            var event = $.Event('beforeShow.spectrum');

            if (visible) {
                reflow();
                return;
            }

            boundElement.trigger(event, [ get() ]);

            if (callbacks.beforeShow(get()) === false || event.isDefaultPrevented()) {
                return;
            }

            hideAll();
            visible = true;

            $(doc).bind("click.spectrum", clickout);
            $(window).bind("resize.spectrum", resize);
            replacer.addClass("sp-active");
            container.removeClass("sp-hidden");

            reflow();
            updateUI();

            colorOnShow = get();

            drawInitial();
            callbacks.show(colorOnShow);
            boundElement.trigger('show.spectrum', [ colorOnShow ]);
        }

        function clickout(e) {
            // Return on right click.
            if (e.button == 2) { return; }

            if (clickoutFiresChange) {
                updateOriginalInput(true);
            }
            else {
                revert();
            }
            hide();
        }

        function hide() {
            // Return if hiding is unnecessary
            if (!visible || flat) { return; }
            visible = false;

            $(doc).unbind("click.spectrum", clickout);
            $(window).unbind("resize.spectrum", resize);

            replacer.removeClass("sp-active");
            container.addClass("sp-hidden");

            callbacks.hide(get());
            boundElement.trigger('hide.spectrum', [ get() ]);
        }

        function revert() {
            set(colorOnShow, true);
        }

        function set(color, ignoreFormatChange) {
            if (tinycolor.equals(color, get())) {
                // Update UI just in case a validation error needs
                // to be cleared.
                updateUI();
                return;
            }

            var newColor, newHsv;
            if (!color && allowEmpty) {
                isEmpty = true;
            } else {
                isEmpty = false;
                newColor = tinycolor(color);
                newHsv = newColor.toHsv();

                currentHue = (newHsv.h % 360) / 360;
                currentSaturation = newHsv.s;
                currentValue = newHsv.v;
                currentAlpha = newHsv.a;
            }
            updateUI();

            if (newColor && newColor.isValid() && !ignoreFormatChange) {
                currentPreferredFormat = preferredFormat || newColor.getFormat();
            }
        }

        function get(opts) {
            opts = opts || { };

            if (allowEmpty && isEmpty) {
                return null;
            }

            return tinycolor.fromRatio({
                h: currentHue,
                s: currentSaturation,
                v: currentValue,
                a: Math.round(currentAlpha * 100) / 100
            }, { format: opts.format || currentPreferredFormat });
        }

        function isValid() {
            return !textInput.hasClass("sp-validation-error");
        }

        function move() {
            updateUI();

            callbacks.move(get());
            boundElement.trigger('move.spectrum', [ get() ]);
        }

        function updateUI() {

            textInput.removeClass("sp-validation-error");

            updateHelperLocations();

            // Update dragger background color (gradients take care of saturation and value).
            var flatColor = tinycolor.fromRatio({ h: currentHue, s: 1, v: 1 });
            dragger.css("background-color", flatColor.toHexString());

            // Get a format that alpha will be included in (hex and names ignore alpha)
            var format = currentPreferredFormat;
            if (currentAlpha < 1 && !(currentAlpha === 0 && format === "name")) {
                if (format === "hex" || format === "hex3" || format === "hex6" || format === "name") {
                    format = "rgb";
                }
            }

            var realColor = get({ format: format }),
                displayColor = '';

             //reset background info for preview element
            previewElement.removeClass("sp-clear-display");
            previewElement.css('background-color', 'transparent');

            if (!realColor && allowEmpty) {
                // Update the replaced elements background with icon indicating no color selection
                previewElement.addClass("sp-clear-display");
            }
            else {
                var realHex = realColor.toHexString(),
                    realRgb = realColor.toRgbString();

                // Update the replaced elements background color (with actual selected color)
                if (rgbaSupport || realColor.alpha === 1) {
                    previewElement.css("background-color", realRgb);
                }
                else {
                    previewElement.css("background-color", "transparent");
                    previewElement.css("filter", realColor.toFilter());
                }

                if (opts.showAlpha) {
                    var rgb = realColor.toRgb();
                    rgb.a = 0;
                    var realAlpha = tinycolor(rgb).toRgbString();
                    var gradient = "linear-gradient(left, " + realAlpha + ", " + realHex + ")";

                    if (IE) {
                        alphaSliderInner.css("filter", tinycolor(realAlpha).toFilter({ gradientType: 1 }, realHex));
                    }
                    else {
                        alphaSliderInner.css("background", "-webkit-" + gradient);
                        alphaSliderInner.css("background", "-moz-" + gradient);
                        alphaSliderInner.css("background", "-ms-" + gradient);
                        // Use current syntax gradient on unprefixed property.
                        alphaSliderInner.css("background",
                            "linear-gradient(to right, " + realAlpha + ", " + realHex + ")");
                    }
                }

                displayColor = realColor.toString(format);
            }

            // Update the text entry input as it changes happen
            if (opts.showInput) {
                textInput.val(displayColor);
            }

            if (opts.showPalette) {
                drawPalette();
            }

            drawInitial();
        }

        function updateHelperLocations() {
            var s = currentSaturation;
            var v = currentValue;

            if(allowEmpty && isEmpty) {
                //if selected color is empty, hide the helpers
                alphaSlideHelper.hide();
                slideHelper.hide();
                dragHelper.hide();
            }
            else {
                //make sure helpers are visible
                alphaSlideHelper.show();
                slideHelper.show();
                dragHelper.show();

                // Where to show the little circle in that displays your current selected color
                var dragX = s * dragWidth;
                var dragY = dragHeight - (v * dragHeight);
                dragX = Math.max(
                    -dragHelperHeight,
                    Math.min(dragWidth - dragHelperHeight, dragX - dragHelperHeight)
                );
                dragY = Math.max(
                    -dragHelperHeight,
                    Math.min(dragHeight - dragHelperHeight, dragY - dragHelperHeight)
                );
                dragHelper.css({
                    "top": dragY + "px",
                    "left": dragX + "px"
                });

                var alphaX = currentAlpha * alphaWidth;
                alphaSlideHelper.css({
                    "left": (alphaX - (alphaSlideHelperWidth / 2)) + "px"
                });

                // Where to show the bar that displays your current selected hue
                var slideY = (currentHue) * slideHeight;
                slideHelper.css({
                    "top": (slideY - slideHelperHeight) + "px"
                });
            }
        }

        function updateOriginalInput(fireCallback) {
            var color = get(),
                displayColor = '',
                hasChanged = !tinycolor.equals(color, colorOnShow);

            if (color) {
                displayColor = color.toString(currentPreferredFormat);
                // Update the selection palette with the current color
                addColorToSelectionPalette(color);
            }

            if (isInput) {
                boundElement.val(displayColor);
            }

            if (fireCallback && hasChanged) {
                callbacks.change(color);
                boundElement.trigger('change', [ color ]);
            }
        }

        function reflow() {
            dragWidth = dragger.width();
            dragHeight = dragger.height();
            dragHelperHeight = dragHelper.height();
            slideWidth = slider.width();
            slideHeight = slider.height();
            slideHelperHeight = slideHelper.height();
            alphaWidth = alphaSlider.width();
            alphaSlideHelperWidth = alphaSlideHelper.width();

            if (!flat) {
                container.css("position", "absolute");
                if (opts.offset) {
                    container.offset(opts.offset);
                } else {
                    container.offset(getOffset(container, offsetElement));
                }
            }

            updateHelperLocations();

            if (opts.showPalette) {
                drawPalette();
            }

            boundElement.trigger('reflow.spectrum');
        }

        function destroy() {
            boundElement.show();
            offsetElement.unbind("click.spectrum touchstart.spectrum");
            container.remove();
            replacer.remove();
            spectrums[spect.id] = null;
        }

        function option(optionName, optionValue) {
            if (optionName === undefined) {
                return $.extend({}, opts);
            }
            if (optionValue === undefined) {
                return opts[optionName];
            }

            opts[optionName] = optionValue;
            applyOptions();
        }

        function enable() {
            disabled = false;
            boundElement.attr("disabled", false);
            offsetElement.removeClass("sp-disabled");
        }

        function disable() {
            hide();
            disabled = true;
            boundElement.attr("disabled", true);
            offsetElement.addClass("sp-disabled");
        }

        function setOffset(coord) {
            opts.offset = coord;
            reflow();
        }

        initialize();

        var spect = {
            show: show,
            hide: hide,
            toggle: toggle,
            reflow: reflow,
            option: option,
            enable: enable,
            disable: disable,
            offset: setOffset,
            set: function (c) {
                set(c);
                updateOriginalInput();
            },
            get: get,
            destroy: destroy,
            container: container
        };

        spect.id = spectrums.push(spect) - 1;

        return spect;
    }

    /**
    * checkOffset - get the offset below/above and left/right element depending on screen position
    * Thanks https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.datepicker.js
    */
    function getOffset(picker, input) {
        var extraY = 0;
        var dpWidth = picker.outerWidth();
        var dpHeight = picker.outerHeight();
        var inputHeight = input.outerHeight();
        var doc = picker[0].ownerDocument;
        var docElem = doc.documentElement;
        var viewWidth = docElem.clientWidth + $(doc).scrollLeft();
        var viewHeight = docElem.clientHeight + $(doc).scrollTop();
        var offset = input.offset();
        offset.top += inputHeight;

        offset.left -=
            Math.min(offset.left, (offset.left + dpWidth > viewWidth && viewWidth > dpWidth) ?
            Math.abs(offset.left + dpWidth - viewWidth) : 0);

        offset.top -=
            Math.min(offset.top, ((offset.top + dpHeight > viewHeight && viewHeight > dpHeight) ?
            Math.abs(dpHeight + inputHeight - extraY) : extraY));

        return offset;
    }

    /**
    * noop - do nothing
    */
    function noop() {

    }

    /**
    * stopPropagation - makes the code only doing this a little easier to read in line
    */
    function stopPropagation(e) {
        e.stopPropagation();
    }

    /**
    * Create a function bound to a given object
    * Thanks to underscore.js
    */
    function bind(func, obj) {
        var slice = Array.prototype.slice;
        var args = slice.call(arguments, 2);
        return function () {
            return func.apply(obj, args.concat(slice.call(arguments)));
        };
    }

    /**
    * Lightweight drag helper.  Handles containment within the element, so that
    * when dragging, the x is within [0,element.width] and y is within [0,element.height]
    */
    function draggable(element, onmove, onstart, onstop) {
        onmove = onmove || function () { };
        onstart = onstart || function () { };
        onstop = onstop || function () { };
        var doc = document;
        var dragging = false;
        var offset = {};
        var maxHeight = 0;
        var maxWidth = 0;
        var hasTouch = ('ontouchstart' in window);

        var duringDragEvents = {};
        duringDragEvents["selectstart"] = prevent;
        duringDragEvents["dragstart"] = prevent;
        duringDragEvents["touchmove mousemove"] = move;
        duringDragEvents["touchend mouseup"] = stop;

        function prevent(e) {
            if (e.stopPropagation) {
                e.stopPropagation();
            }
            if (e.preventDefault) {
                e.preventDefault();
            }
            e.returnValue = false;
        }

        function move(e) {
            if (dragging) {
                // Mouseup happened outside of window
                if (IE && doc.documentMode < 9 && !e.button) {
                    return stop();
                }

                var touches = e.originalEvent && e.originalEvent.touches;
                var pageX = touches ? touches[0].pageX : e.pageX;
                var pageY = touches ? touches[0].pageY : e.pageY;

                var dragX = Math.max(0, Math.min(pageX - offset.left, maxWidth));
                var dragY = Math.max(0, Math.min(pageY - offset.top, maxHeight));

                if (hasTouch) {
                    // Stop scrolling in iOS
                    prevent(e);
                }

                onmove.apply(element, [dragX, dragY, e]);
            }
        }

        function start(e) {
            var rightclick = (e.which) ? (e.which == 3) : (e.button == 2);

            if (!rightclick && !dragging) {
                if (onstart.apply(element, arguments) !== false) {
                    dragging = true;
                    maxHeight = $(element).height();
                    maxWidth = $(element).width();
                    offset = $(element).offset();

                    $(doc).bind(duringDragEvents);
                    $(doc.body).addClass("sp-dragging");

                    if (!hasTouch) {
                        move(e);
                    }

                    prevent(e);
                }
            }
        }

        function stop() {
            if (dragging) {
                $(doc).unbind(duringDragEvents);
                $(doc.body).removeClass("sp-dragging");
                onstop.apply(element, arguments);
            }
            dragging = false;
        }

        $(element).bind("touchstart mousedown", start);
    }

    function throttle(func, wait, debounce) {
        var timeout;
        return function () {
            var context = this, args = arguments;
            var throttler = function () {
                timeout = null;
                func.apply(context, args);
            };
            if (debounce) clearTimeout(timeout);
            if (debounce || !timeout) timeout = setTimeout(throttler, wait);
        };
    }

    /**
    * Define a jQuery plugin
    */
    var dataID = "spectrum.id";
    $.fn.spectrum = function (opts, extra) {

        if (typeof opts == "string") {

            var returnValue = this;
            var args = Array.prototype.slice.call( arguments, 1 );

            this.each(function () {
                var spect = spectrums[$(this).data(dataID)];
                if (spect) {
                    var method = spect[opts];
                    if (!method) {
                        throw new Error( "Spectrum: no such method: '" + opts + "'" );
                    }

                    if (opts == "get") {
                        returnValue = spect.get();
                    }
                    else if (opts == "container") {
                        returnValue = spect.container;
                    }
                    else if (opts == "option") {
                        returnValue = spect.option.apply(spect, args);
                    }
                    else if (opts == "destroy") {
                        spect.destroy();
                        $(this).removeData(dataID);
                    }
                    else {
                        method.apply(spect, args);
                    }
                }
            });

            return returnValue;
        }

        // Initializing a new instance of spectrum
        return this.spectrum("destroy").each(function () {
            var options = $.extend({}, opts, $(this).data());
            var spect = spectrum(this, options);
            $(this).data(dataID, spect.id);
        });
    };

    $.fn.spectrum.load = true;
    $.fn.spectrum.loadOpts = {};
    $.fn.spectrum.draggable = draggable;
    $.fn.spectrum.defaults = defaultOpts;

    $.spectrum = { };
    $.spectrum.localization = { };
    $.spectrum.palettes = { };

    $.fn.spectrum.processNativeColorInputs = function () {
        if (!inputTypeColorSupport) {
            $("input[type=color]").spectrum({
                preferredFormat: "hex6"
            });
        }
    };

    // TinyColor v1.1.1
    // https://github.com/bgrins/TinyColor
    // Brian Grinstead, MIT License

    (function() {

    var trimLeft = /^[\s,#]+/,
        trimRight = /\s+$/,
        tinyCounter = 0,
        math = Math,
        mathRound = math.round,
        mathMin = math.min,
        mathMax = math.max,
        mathRandom = math.random;

    var tinycolor = function tinycolor (color, opts) {

        color = (color) ? color : '';
        opts = opts || { };

        // If input is already a tinycolor, return itself
        if (color instanceof tinycolor) {
           return color;
        }
        // If we are called as a function, call using new instead
        if (!(this instanceof tinycolor)) {
            return new tinycolor(color, opts);
        }

        var rgb = inputToRGB(color);
        this._originalInput = color,
        this._r = rgb.r,
        this._g = rgb.g,
        this._b = rgb.b,
        this._a = rgb.a,
        this._roundA = mathRound(100*this._a) / 100,
        this._format = opts.format || rgb.format;
        this._gradientType = opts.gradientType;

        // Don't let the range of [0,255] come back in [0,1].
        // Potentially lose a little bit of precision here, but will fix issues where
        // .5 gets interpreted as half of the total, instead of half of 1
        // If it was supposed to be 128, this was already taken care of by `inputToRgb`
        if (this._r < 1) { this._r = mathRound(this._r); }
        if (this._g < 1) { this._g = mathRound(this._g); }
        if (this._b < 1) { this._b = mathRound(this._b); }

        this._ok = rgb.ok;
        this._tc_id = tinyCounter++;
    };

    tinycolor.prototype = {
        isDark: function() {
            return this.getBrightness() < 128;
        },
        isLight: function() {
            return !this.isDark();
        },
        isValid: function() {
            return this._ok;
        },
        getOriginalInput: function() {
          return this._originalInput;
        },
        getFormat: function() {
            return this._format;
        },
        getAlpha: function() {
            return this._a;
        },
        getBrightness: function() {
            var rgb = this.toRgb();
            return (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000;
        },
        setAlpha: function(value) {
            this._a = boundAlpha(value);
            this._roundA = mathRound(100*this._a) / 100;
            return this;
        },
        toHsv: function() {
            var hsv = rgbToHsv(this._r, this._g, this._b);
            return { h: hsv.h * 360, s: hsv.s, v: hsv.v, a: this._a };
        },
        toHsvString: function() {
            var hsv = rgbToHsv(this._r, this._g, this._b);
            var h = mathRound(hsv.h * 360), s = mathRound(hsv.s * 100), v = mathRound(hsv.v * 100);
            return (this._a == 1) ?
              "hsv("  + h + ", " + s + "%, " + v + "%)" :
              "hsva(" + h + ", " + s + "%, " + v + "%, "+ this._roundA + ")";
        },
        toHsl: function() {
            var hsl = rgbToHsl(this._r, this._g, this._b);
            return { h: hsl.h * 360, s: hsl.s, l: hsl.l, a: this._a };
        },
        toHslString: function() {
            var hsl = rgbToHsl(this._r, this._g, this._b);
            var h = mathRound(hsl.h * 360), s = mathRound(hsl.s * 100), l = mathRound(hsl.l * 100);
            return (this._a == 1) ?
              "hsl("  + h + ", " + s + "%, " + l + "%)" :
              "hsla(" + h + ", " + s + "%, " + l + "%, "+ this._roundA + ")";
        },
        toHex: function(allow3Char) {
            return rgbToHex(this._r, this._g, this._b, allow3Char);
        },
        toHexString: function(allow3Char) {
            return '#' + this.toHex(allow3Char);
        },
        toHex8: function() {
            return rgbaToHex(this._r, this._g, this._b, this._a);
        },
        toHex8String: function() {
            return '#' + this.toHex8();
        },
        toRgb: function() {
            return { r: mathRound(this._r), g: mathRound(this._g), b: mathRound(this._b), a: this._a };
        },
        toRgbString: function() {
            return (this._a == 1) ?
              "rgb("  + mathRound(this._r) + ", " + mathRound(this._g) + ", " + mathRound(this._b) + ")" :
              "rgba(" + mathRound(this._r) + ", " + mathRound(this._g) + ", " + mathRound(this._b) + ", " + this._roundA + ")";
        },
        toPercentageRgb: function() {
            return { r: mathRound(bound01(this._r, 255) * 100) + "%", g: mathRound(bound01(this._g, 255) * 100) + "%", b: mathRound(bound01(this._b, 255) * 100) + "%", a: this._a };
        },
        toPercentageRgbString: function() {
            return (this._a == 1) ?
              "rgb("  + mathRound(bound01(this._r, 255) * 100) + "%, " + mathRound(bound01(this._g, 255) * 100) + "%, " + mathRound(bound01(this._b, 255) * 100) + "%)" :
              "rgba(" + mathRound(bound01(this._r, 255) * 100) + "%, " + mathRound(bound01(this._g, 255) * 100) + "%, " + mathRound(bound01(this._b, 255) * 100) + "%, " + this._roundA + ")";
        },
        toName: function() {
            if (this._a === 0) {
                return "transparent";
            }

            if (this._a < 1) {
                return false;
            }

            return hexNames[rgbToHex(this._r, this._g, this._b, true)] || false;
        },
        toFilter: function(secondColor) {
            var hex8String = '#' + rgbaToHex(this._r, this._g, this._b, this._a);
            var secondHex8String = hex8String;
            var gradientType = this._gradientType ? "GradientType = 1, " : "";

            if (secondColor) {
                var s = tinycolor(secondColor);
                secondHex8String = s.toHex8String();
            }

            return "progid:DXImageTransform.Microsoft.gradient("+gradientType+"startColorstr="+hex8String+",endColorstr="+secondHex8String+")";
        },
        toString: function(format) {
            var formatSet = !!format;
            format = format || this._format;

            var formattedString = false;
            var hasAlpha = this._a < 1 && this._a >= 0;
            var needsAlphaFormat = !formatSet && hasAlpha && (format === "hex" || format === "hex6" || format === "hex3" || format === "name");

            if (needsAlphaFormat) {
                // Special case for "transparent", all other non-alpha formats
                // will return rgba when there is transparency.
                if (format === "name" && this._a === 0) {
                    return this.toName();
                }
                return this.toRgbString();
            }
            if (format === "rgb") {
                formattedString = this.toRgbString();
            }
            if (format === "prgb") {
                formattedString = this.toPercentageRgbString();
            }
            if (format === "hex" || format === "hex6") {
                formattedString = this.toHexString();
            }
            if (format === "hex3") {
                formattedString = this.toHexString(true);
            }
            if (format === "hex8") {
                formattedString = this.toHex8String();
            }
            if (format === "name") {
                formattedString = this.toName();
            }
            if (format === "hsl") {
                formattedString = this.toHslString();
            }
            if (format === "hsv") {
                formattedString = this.toHsvString();
            }

            return formattedString || this.toHexString();
        },

        _applyModification: function(fn, args) {
            var color = fn.apply(null, [this].concat([].slice.call(args)));
            this._r = color._r;
            this._g = color._g;
            this._b = color._b;
            this.setAlpha(color._a);
            return this;
        },
        lighten: function() {
            return this._applyModification(lighten, arguments);
        },
        brighten: function() {
            return this._applyModification(brighten, arguments);
        },
        darken: function() {
            return this._applyModification(darken, arguments);
        },
        desaturate: function() {
            return this._applyModification(desaturate, arguments);
        },
        saturate: function() {
            return this._applyModification(saturate, arguments);
        },
        greyscale: function() {
            return this._applyModification(greyscale, arguments);
        },
        spin: function() {
            return this._applyModification(spin, arguments);
        },

        _applyCombination: function(fn, args) {
            return fn.apply(null, [this].concat([].slice.call(args)));
        },
        analogous: function() {
            return this._applyCombination(analogous, arguments);
        },
        complement: function() {
            return this._applyCombination(complement, arguments);
        },
        monochromatic: function() {
            return this._applyCombination(monochromatic, arguments);
        },
        splitcomplement: function() {
            return this._applyCombination(splitcomplement, arguments);
        },
        triad: function() {
            return this._applyCombination(triad, arguments);
        },
        tetrad: function() {
            return this._applyCombination(tetrad, arguments);
        }
    };

    // If input is an object, force 1 into "1.0" to handle ratios properly
    // String input requires "1.0" as input, so 1 will be treated as 1
    tinycolor.fromRatio = function(color, opts) {
        if (typeof color == "object") {
            var newColor = {};
            for (var i in color) {
                if (color.hasOwnProperty(i)) {
                    if (i === "a") {
                        newColor[i] = color[i];
                    }
                    else {
                        newColor[i] = convertToPercentage(color[i]);
                    }
                }
            }
            color = newColor;
        }

        return tinycolor(color, opts);
    };

    // Given a string or object, convert that input to RGB
    // Possible string inputs:
    //
    //     "red"
    //     "#f00" or "f00"
    //     "#ff0000" or "ff0000"
    //     "#ff000000" or "ff000000"
    //     "rgb 255 0 0" or "rgb (255, 0, 0)"
    //     "rgb 1.0 0 0" or "rgb (1, 0, 0)"
    //     "rgba (255, 0, 0, 1)" or "rgba 255, 0, 0, 1"
    //     "rgba (1.0, 0, 0, 1)" or "rgba 1.0, 0, 0, 1"
    //     "hsl(0, 100%, 50%)" or "hsl 0 100% 50%"
    //     "hsla(0, 100%, 50%, 1)" or "hsla 0 100% 50%, 1"
    //     "hsv(0, 100%, 100%)" or "hsv 0 100% 100%"
    //
    function inputToRGB(color) {

        var rgb = { r: 0, g: 0, b: 0 };
        var a = 1;
        var ok = false;
        var format = false;

        if (typeof color == "string") {
            color = stringInputToObject(color);
        }

        if (typeof color == "object") {
            if (color.hasOwnProperty("r") && color.hasOwnProperty("g") && color.hasOwnProperty("b")) {
                rgb = rgbToRgb(color.r, color.g, color.b);
                ok = true;
                format = String(color.r).substr(-1) === "%" ? "prgb" : "rgb";
            }
            else if (color.hasOwnProperty("h") && color.hasOwnProperty("s") && color.hasOwnProperty("v")) {
                color.s = convertToPercentage(color.s);
                color.v = convertToPercentage(color.v);
                rgb = hsvToRgb(color.h, color.s, color.v);
                ok = true;
                format = "hsv";
            }
            else if (color.hasOwnProperty("h") && color.hasOwnProperty("s") && color.hasOwnProperty("l")) {
                color.s = convertToPercentage(color.s);
                color.l = convertToPercentage(color.l);
                rgb = hslToRgb(color.h, color.s, color.l);
                ok = true;
                format = "hsl";
            }

            if (color.hasOwnProperty("a")) {
                a = color.a;
            }
        }

        a = boundAlpha(a);

        return {
            ok: ok,
            format: color.format || format,
            r: mathMin(255, mathMax(rgb.r, 0)),
            g: mathMin(255, mathMax(rgb.g, 0)),
            b: mathMin(255, mathMax(rgb.b, 0)),
            a: a
        };
    }


    // Conversion Functions
    // --------------------

    // `rgbToHsl`, `rgbToHsv`, `hslToRgb`, `hsvToRgb` modified from:
    // <http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript>

    // `rgbToRgb`
    // Handle bounds / percentage checking to conform to CSS color spec
    // <http://www.w3.org/TR/css3-color/>
    // *Assumes:* r, g, b in [0, 255] or [0, 1]
    // *Returns:* { r, g, b } in [0, 255]
    function rgbToRgb(r, g, b){
        return {
            r: bound01(r, 255) * 255,
            g: bound01(g, 255) * 255,
            b: bound01(b, 255) * 255
        };
    }

    // `rgbToHsl`
    // Converts an RGB color value to HSL.
    // *Assumes:* r, g, and b are contained in [0, 255] or [0, 1]
    // *Returns:* { h, s, l } in [0,1]
    function rgbToHsl(r, g, b) {

        r = bound01(r, 255);
        g = bound01(g, 255);
        b = bound01(b, 255);

        var max = mathMax(r, g, b), min = mathMin(r, g, b);
        var h, s, l = (max + min) / 2;

        if(max == min) {
            h = s = 0; // achromatic
        }
        else {
            var d = max - min;
            s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
            switch(max) {
                case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                case g: h = (b - r) / d + 2; break;
                case b: h = (r - g) / d + 4; break;
            }

            h /= 6;
        }

        return { h: h, s: s, l: l };
    }

    // `hslToRgb`
    // Converts an HSL color value to RGB.
    // *Assumes:* h is contained in [0, 1] or [0, 360] and s and l are contained [0, 1] or [0, 100]
    // *Returns:* { r, g, b } in the set [0, 255]
    function hslToRgb(h, s, l) {
        var r, g, b;

        h = bound01(h, 360);
        s = bound01(s, 100);
        l = bound01(l, 100);

        function hue2rgb(p, q, t) {
            if(t < 0) t += 1;
            if(t > 1) t -= 1;
            if(t < 1/6) return p + (q - p) * 6 * t;
            if(t < 1/2) return q;
            if(t < 2/3) return p + (q - p) * (2/3 - t) * 6;
            return p;
        }

        if(s === 0) {
            r = g = b = l; // achromatic
        }
        else {
            var q = l < 0.5 ? l * (1 + s) : l + s - l * s;
            var p = 2 * l - q;
            r = hue2rgb(p, q, h + 1/3);
            g = hue2rgb(p, q, h);
            b = hue2rgb(p, q, h - 1/3);
        }

        return { r: r * 255, g: g * 255, b: b * 255 };
    }

    // `rgbToHsv`
    // Converts an RGB color value to HSV
    // *Assumes:* r, g, and b are contained in the set [0, 255] or [0, 1]
    // *Returns:* { h, s, v } in [0,1]
    function rgbToHsv(r, g, b) {

        r = bound01(r, 255);
        g = bound01(g, 255);
        b = bound01(b, 255);

        var max = mathMax(r, g, b), min = mathMin(r, g, b);
        var h, s, v = max;

        var d = max - min;
        s = max === 0 ? 0 : d / max;

        if(max == min) {
            h = 0; // achromatic
        }
        else {
            switch(max) {
                case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                case g: h = (b - r) / d + 2; break;
                case b: h = (r - g) / d + 4; break;
            }
            h /= 6;
        }
        return { h: h, s: s, v: v };
    }

    // `hsvToRgb`
    // Converts an HSV color value to RGB.
    // *Assumes:* h is contained in [0, 1] or [0, 360] and s and v are contained in [0, 1] or [0, 100]
    // *Returns:* { r, g, b } in the set [0, 255]
     function hsvToRgb(h, s, v) {

        h = bound01(h, 360) * 6;
        s = bound01(s, 100);
        v = bound01(v, 100);

        var i = math.floor(h),
            f = h - i,
            p = v * (1 - s),
            q = v * (1 - f * s),
            t = v * (1 - (1 - f) * s),
            mod = i % 6,
            r = [v, q, p, p, t, v][mod],
            g = [t, v, v, q, p, p][mod],
            b = [p, p, t, v, v, q][mod];

        return { r: r * 255, g: g * 255, b: b * 255 };
    }

    // `rgbToHex`
    // Converts an RGB color to hex
    // Assumes r, g, and b are contained in the set [0, 255]
    // Returns a 3 or 6 character hex
    function rgbToHex(r, g, b, allow3Char) {

        var hex = [
            pad2(mathRound(r).toString(16)),
            pad2(mathRound(g).toString(16)),
            pad2(mathRound(b).toString(16))
        ];

        // Return a 3 character hex if possible
        if (allow3Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1)) {
            return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0);
        }

        return hex.join("");
    }
        // `rgbaToHex`
        // Converts an RGBA color plus alpha transparency to hex
        // Assumes r, g, b and a are contained in the set [0, 255]
        // Returns an 8 character hex
        function rgbaToHex(r, g, b, a) {

            var hex = [
                pad2(convertDecimalToHex(a)),
                pad2(mathRound(r).toString(16)),
                pad2(mathRound(g).toString(16)),
                pad2(mathRound(b).toString(16))
            ];

            return hex.join("");
        }

    // `equals`
    // Can be called with any tinycolor input
    tinycolor.equals = function (color1, color2) {
        if (!color1 || !color2) { return false; }
        return tinycolor(color1).toRgbString() == tinycolor(color2).toRgbString();
    };
    tinycolor.random = function() {
        return tinycolor.fromRatio({
            r: mathRandom(),
            g: mathRandom(),
            b: mathRandom()
        });
    };


    // Modification Functions
    // ----------------------
    // Thanks to less.js for some of the basics here
    // <https://github.com/cloudhead/less.js/blob/master/lib/less/functions.js>

    function desaturate(color, amount) {
        amount = (amount === 0) ? 0 : (amount || 10);
        var hsl = tinycolor(color).toHsl();
        hsl.s -= amount / 100;
        hsl.s = clamp01(hsl.s);
        return tinycolor(hsl);
    }

    function saturate(color, amount) {
        amount = (amount === 0) ? 0 : (amount || 10);
        var hsl = tinycolor(color).toHsl();
        hsl.s += amount / 100;
        hsl.s = clamp01(hsl.s);
        return tinycolor(hsl);
    }

    function greyscale(color) {
        return tinycolor(color).desaturate(100);
    }

    function lighten (color, amount) {
        amount = (amount === 0) ? 0 : (amount || 10);
        var hsl = tinycolor(color).toHsl();
        hsl.l += amount / 100;
        hsl.l = clamp01(hsl.l);
        return tinycolor(hsl);
    }

    function brighten(color, amount) {
        amount = (amount === 0) ? 0 : (amount || 10);
        var rgb = tinycolor(color).toRgb();
        rgb.r = mathMax(0, mathMin(255, rgb.r - mathRound(255 * - (amount / 100))));
        rgb.g = mathMax(0, mathMin(255, rgb.g - mathRound(255 * - (amount / 100))));
        rgb.b = mathMax(0, mathMin(255, rgb.b - mathRound(255 * - (amount / 100))));
        return tinycolor(rgb);
    }

    function darken (color, amount) {
        amount = (amount === 0) ? 0 : (amount || 10);
        var hsl = tinycolor(color).toHsl();
        hsl.l -= amount / 100;
        hsl.l = clamp01(hsl.l);
        return tinycolor(hsl);
    }

    // Spin takes a positive or negative amount within [-360, 360] indicating the change of hue.
    // Values outside of this range will be wrapped into this range.
    function spin(color, amount) {
        var hsl = tinycolor(color).toHsl();
        var hue = (mathRound(hsl.h) + amount) % 360;
        hsl.h = hue < 0 ? 360 + hue : hue;
        return tinycolor(hsl);
    }

    // Combination Functions
    // ---------------------
    // Thanks to jQuery xColor for some of the ideas behind these
    // <https://github.com/infusion/jQuery-xcolor/blob/master/jquery.xcolor.js>

    function complement(color) {
        var hsl = tinycolor(color).toHsl();
        hsl.h = (hsl.h + 180) % 360;
        return tinycolor(hsl);
    }

    function triad(color) {
        var hsl = tinycolor(color).toHsl();
        var h = hsl.h;
        return [
            tinycolor(color),
            tinycolor({ h: (h + 120) % 360, s: hsl.s, l: hsl.l }),
            tinycolor({ h: (h + 240) % 360, s: hsl.s, l: hsl.l })
        ];
    }

    function tetrad(color) {
        var hsl = tinycolor(color).toHsl();
        var h = hsl.h;
        return [
            tinycolor(color),
            tinycolor({ h: (h + 90) % 360, s: hsl.s, l: hsl.l }),
            tinycolor({ h: (h + 180) % 360, s: hsl.s, l: hsl.l }),
            tinycolor({ h: (h + 270) % 360, s: hsl.s, l: hsl.l })
        ];
    }

    function splitcomplement(color) {
        var hsl = tinycolor(color).toHsl();
        var h = hsl.h;
        return [
            tinycolor(color),
            tinycolor({ h: (h + 72) % 360, s: hsl.s, l: hsl.l}),
            tinycolor({ h: (h + 216) % 360, s: hsl.s, l: hsl.l})
        ];
    }

    function analogous(color, results, slices) {
        results = results || 6;
        slices = slices || 30;

        var hsl = tinycolor(color).toHsl();
        var part = 360 / slices;
        var ret = [tinycolor(color)];

        for (hsl.h = ((hsl.h - (part * results >> 1)) + 720) % 360; --results; ) {
            hsl.h = (hsl.h + part) % 360;
            ret.push(tinycolor(hsl));
        }
        return ret;
    }

    function monochromatic(color, results) {
        results = results || 6;
        var hsv = tinycolor(color).toHsv();
        var h = hsv.h, s = hsv.s, v = hsv.v;
        var ret = [];
        var modification = 1 / results;

        while (results--) {
            ret.push(tinycolor({ h: h, s: s, v: v}));
            v = (v + modification) % 1;
        }

        return ret;
    }

    // Utility Functions
    // ---------------------

    tinycolor.mix = function(color1, color2, amount) {
        amount = (amount === 0) ? 0 : (amount || 50);

        var rgb1 = tinycolor(color1).toRgb();
        var rgb2 = tinycolor(color2).toRgb();

        var p = amount / 100;
        var w = p * 2 - 1;
        var a = rgb2.a - rgb1.a;

        var w1;

        if (w * a == -1) {
            w1 = w;
        } else {
            w1 = (w + a) / (1 + w * a);
        }

        w1 = (w1 + 1) / 2;

        var w2 = 1 - w1;

        var rgba = {
            r: rgb2.r * w1 + rgb1.r * w2,
            g: rgb2.g * w1 + rgb1.g * w2,
            b: rgb2.b * w1 + rgb1.b * w2,
            a: rgb2.a * p  + rgb1.a * (1 - p)
        };

        return tinycolor(rgba);
    };


    // Readability Functions
    // ---------------------
    // <http://www.w3.org/TR/AERT#color-contrast>

    // `readability`
    // Analyze the 2 colors and returns an object with the following properties:
    //    `brightness`: difference in brightness between the two colors
    //    `color`: difference in color/hue between the two colors
    tinycolor.readability = function(color1, color2) {
        var c1 = tinycolor(color1);
        var c2 = tinycolor(color2);
        var rgb1 = c1.toRgb();
        var rgb2 = c2.toRgb();
        var brightnessA = c1.getBrightness();
        var brightnessB = c2.getBrightness();
        var colorDiff = (
            Math.max(rgb1.r, rgb2.r) - Math.min(rgb1.r, rgb2.r) +
            Math.max(rgb1.g, rgb2.g) - Math.min(rgb1.g, rgb2.g) +
            Math.max(rgb1.b, rgb2.b) - Math.min(rgb1.b, rgb2.b)
        );

        return {
            brightness: Math.abs(brightnessA - brightnessB),
            color: colorDiff
        };
    };

    // `readable`
    // http://www.w3.org/TR/AERT#color-contrast
    // Ensure that foreground and background color combinations provide sufficient contrast.
    // *Example*
    //    tinycolor.isReadable("#000", "#111") => false
    tinycolor.isReadable = function(color1, color2) {
        var readability = tinycolor.readability(color1, color2);
        return readability.brightness > 125 && readability.color > 500;
    };

    // `mostReadable`
    // Given a base color and a list of possible foreground or background
    // colors for that base, returns the most readable color.
    // *Example*
    //    tinycolor.mostReadable("#123", ["#fff", "#000"]) => "#000"
    tinycolor.mostReadable = function(baseColor, colorList) {
        var bestColor = null;
        var bestScore = 0;
        var bestIsReadable = false;
        for (var i=0; i < colorList.length; i++) {

            // We normalize both around the "acceptable" breaking point,
            // but rank brightness constrast higher than hue.

            var readability = tinycolor.readability(baseColor, colorList[i]);
            var readable = readability.brightness > 125 && readability.color > 500;
            var score = 3 * (readability.brightness / 125) + (readability.color / 500);

            if ((readable && ! bestIsReadable) ||
                (readable && bestIsReadable && score > bestScore) ||
                ((! readable) && (! bestIsReadable) && score > bestScore)) {
                bestIsReadable = readable;
                bestScore = score;
                bestColor = tinycolor(colorList[i]);
            }
        }
        return bestColor;
    };


    // Big List of Colors
    // ------------------
    // <http://www.w3.org/TR/css3-color/#svg-color>
    var names = tinycolor.names = {
        aliceblue: "f0f8ff",
        antiquewhite: "faebd7",
        aqua: "0ff",
        aquamarine: "7fffd4",
        azure: "f0ffff",
        beige: "f5f5dc",
        bisque: "ffe4c4",
        black: "000",
        blanchedalmond: "ffebcd",
        blue: "00f",
        blueviolet: "8a2be2",
        brown: "a52a2a",
        burlywood: "deb887",
        burntsienna: "ea7e5d",
        cadetblue: "5f9ea0",
        chartreuse: "7fff00",
        chocolate: "d2691e",
        coral: "ff7f50",
        cornflowerblue: "6495ed",
        cornsilk: "fff8dc",
        crimson: "dc143c",
        cyan: "0ff",
        darkblue: "00008b",
        darkcyan: "008b8b",
        darkgoldenrod: "b8860b",
        darkgray: "a9a9a9",
        darkgreen: "006400",
        darkgrey: "a9a9a9",
        darkkhaki: "bdb76b",
        darkmagenta: "8b008b",
        darkolivegreen: "556b2f",
        darkorange: "ff8c00",
        darkorchid: "9932cc",
        darkred: "8b0000",
        darksalmon: "e9967a",
        darkseagreen: "8fbc8f",
        darkslateblue: "483d8b",
        darkslategray: "2f4f4f",
        darkslategrey: "2f4f4f",
        darkturquoise: "00ced1",
        darkviolet: "9400d3",
        deeppink: "ff1493",
        deepskyblue: "00bfff",
        dimgray: "696969",
        dimgrey: "696969",
        dodgerblue: "1e90ff",
        firebrick: "b22222",
        floralwhite: "fffaf0",
        forestgreen: "228b22",
        fuchsia: "f0f",
        gainsboro: "dcdcdc",
        ghostwhite: "f8f8ff",
        gold: "ffd700",
        goldenrod: "daa520",
        gray: "808080",
        green: "008000",
        greenyellow: "adff2f",
        grey: "808080",
        honeydew: "f0fff0",
        hotpink: "ff69b4",
        indianred: "cd5c5c",
        indigo: "4b0082",
        ivory: "fffff0",
        khaki: "f0e68c",
        lavender: "e6e6fa",
        lavenderblush: "fff0f5",
        lawngreen: "7cfc00",
        lemonchiffon: "fffacd",
        lightblue: "add8e6",
        lightcoral: "f08080",
        lightcyan: "e0ffff",
        lightgoldenrodyellow: "fafad2",
        lightgray: "d3d3d3",
        lightgreen: "90ee90",
        lightgrey: "d3d3d3",
        lightpink: "ffb6c1",
        lightsalmon: "ffa07a",
        lightseagreen: "20b2aa",
        lightskyblue: "87cefa",
        lightslategray: "789",
        lightslategrey: "789",
        lightsteelblue: "b0c4de",
        lightyellow: "ffffe0",
        lime: "0f0",
        limegreen: "32cd32",
        linen: "faf0e6",
        magenta: "f0f",
        maroon: "800000",
        mediumaquamarine: "66cdaa",
        mediumblue: "0000cd",
        mediumorchid: "ba55d3",
        mediumpurple: "9370db",
        mediumseagreen: "3cb371",
        mediumslateblue: "7b68ee",
        mediumspringgreen: "00fa9a",
        mediumturquoise: "48d1cc",
        mediumvioletred: "c71585",
        midnightblue: "191970",
        mintcream: "f5fffa",
        mistyrose: "ffe4e1",
        moccasin: "ffe4b5",
        navajowhite: "ffdead",
        navy: "000080",
        oldlace: "fdf5e6",
        olive: "808000",
        olivedrab: "6b8e23",
        orange: "ffa500",
        orangered: "ff4500",
        orchid: "da70d6",
        palegoldenrod: "eee8aa",
        palegreen: "98fb98",
        paleturquoise: "afeeee",
        palevioletred: "db7093",
        papayawhip: "ffefd5",
        peachpuff: "ffdab9",
        peru: "cd853f",
        pink: "ffc0cb",
        plum: "dda0dd",
        powderblue: "b0e0e6",
        purple: "800080",
        rebeccapurple: "663399",
        red: "f00",
        rosybrown: "bc8f8f",
        royalblue: "4169e1",
        saddlebrown: "8b4513",
        salmon: "fa8072",
        sandybrown: "f4a460",
        seagreen: "2e8b57",
        seashell: "fff5ee",
        sienna: "a0522d",
        silver: "c0c0c0",
        skyblue: "87ceeb",
        slateblue: "6a5acd",
        slategray: "708090",
        slategrey: "708090",
        snow: "fffafa",
        springgreen: "00ff7f",
        steelblue: "4682b4",
        tan: "d2b48c",
        teal: "008080",
        thistle: "d8bfd8",
        tomato: "ff6347",
        turquoise: "40e0d0",
        violet: "ee82ee",
        wheat: "f5deb3",
        white: "fff",
        whitesmoke: "f5f5f5",
        yellow: "ff0",
        yellowgreen: "9acd32"
    };

    // Make it easy to access colors via `hexNames[hex]`
    var hexNames = tinycolor.hexNames = flip(names);


    // Utilities
    // ---------

    // `{ 'name1': 'val1' }` becomes `{ 'val1': 'name1' }`
    function flip(o) {
        var flipped = { };
        for (var i in o) {
            if (o.hasOwnProperty(i)) {
                flipped[o[i]] = i;
            }
        }
        return flipped;
    }

    // Return a valid alpha value [0,1] with all invalid values being set to 1
    function boundAlpha(a) {
        a = parseFloat(a);

        if (isNaN(a) || a < 0 || a > 1) {
            a = 1;
        }

        return a;
    }

    // Take input from [0, n] and return it as [0, 1]
    function bound01(n, max) {
        if (isOnePointZero(n)) { n = "100%"; }

        var processPercent = isPercentage(n);
        n = mathMin(max, mathMax(0, parseFloat(n)));

        // Automatically convert percentage into number
        if (processPercent) {
            n = parseInt(n * max, 10) / 100;
        }

        // Handle floating point rounding errors
        if ((math.abs(n - max) < 0.000001)) {
            return 1;
        }

        // Convert into [0, 1] range if it isn't already
        return (n % max) / parseFloat(max);
    }

    // Force a number between 0 and 1
    function clamp01(val) {
        return mathMin(1, mathMax(0, val));
    }

    // Parse a base-16 hex value into a base-10 integer
    function parseIntFromHex(val) {
        return parseInt(val, 16);
    }

    // Need to handle 1.0 as 100%, since once it is a number, there is no difference between it and 1
    // <http://stackoverflow.com/questions/7422072/javascript-how-to-detect-number-as-a-decimal-including-1-0>
    function isOnePointZero(n) {
        return typeof n == "string" && n.indexOf('.') != -1 && parseFloat(n) === 1;
    }

    // Check to see if string passed in is a percentage
    function isPercentage(n) {
        return typeof n === "string" && n.indexOf('%') != -1;
    }

    // Force a hex value to have 2 characters
    function pad2(c) {
        return c.length == 1 ? '0' + c : '' + c;
    }

    // Replace a decimal with it's percentage value
    function convertToPercentage(n) {
        if (n <= 1) {
            n = (n * 100) + "%";
        }

        return n;
    }

    // Converts a decimal to a hex value
    function convertDecimalToHex(d) {
        return Math.round(parseFloat(d) * 255).toString(16);
    }
    // Converts a hex value to a decimal
    function convertHexToDecimal(h) {
        return (parseIntFromHex(h) / 255);
    }

    var matchers = (function() {

        // <http://www.w3.org/TR/css3-values/#integers>
        var CSS_INTEGER = "[-\\+]?\\d+%?";

        // <http://www.w3.org/TR/css3-values/#number-value>
        var CSS_NUMBER = "[-\\+]?\\d*\\.\\d+%?";

        // Allow positive/negative integer/number.  Don't capture the either/or, just the entire outcome.
        var CSS_UNIT = "(?:" + CSS_NUMBER + ")|(?:" + CSS_INTEGER + ")";

        // Actual matching.
        // Parentheses and commas are optional, but not required.
        // Whitespace can take the place of commas or opening paren
        var PERMISSIVE_MATCH3 = "[\\s|\\(]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")\\s*\\)?";
        var PERMISSIVE_MATCH4 = "[\\s|\\(]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")\\s*\\)?";

        return {
            rgb: new RegExp("rgb" + PERMISSIVE_MATCH3),
            rgba: new RegExp("rgba" + PERMISSIVE_MATCH4),
            hsl: new RegExp("hsl" + PERMISSIVE_MATCH3),
            hsla: new RegExp("hsla" + PERMISSIVE_MATCH4),
            hsv: new RegExp("hsv" + PERMISSIVE_MATCH3),
            hsva: new RegExp("hsva" + PERMISSIVE_MATCH4),
            hex3: /^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,
            hex6: /^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,
            hex8: /^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/
        };
    })();

    // `stringInputToObject`
    // Permissive string parsing.  Take in a number of formats, and output an object
    // based on detected format.  Returns `{ r, g, b }` or `{ h, s, l }` or `{ h, s, v}`
    function stringInputToObject(color) {

        color = color.replace(trimLeft,'').replace(trimRight, '').toLowerCase();
        var named = false;
        if (names[color]) {
            color = names[color];
            named = true;
        }
        else if (color == 'transparent') {
            return { r: 0, g: 0, b: 0, a: 0, format: "name" };
        }

        // Try to match string input using regular expressions.
        // Keep most of the number bounding out of this function - don't worry about [0,1] or [0,100] or [0,360]
        // Just return an object and let the conversion functions handle that.
        // This way the result will be the same whether the tinycolor is initialized with string or object.
        var match;
        if ((match = matchers.rgb.exec(color))) {
            return { r: match[1], g: match[2], b: match[3] };
        }
        if ((match = matchers.rgba.exec(color))) {
            return { r: match[1], g: match[2], b: match[3], a: match[4] };
        }
        if ((match = matchers.hsl.exec(color))) {
            return { h: match[1], s: match[2], l: match[3] };
        }
        if ((match = matchers.hsla.exec(color))) {
            return { h: match[1], s: match[2], l: match[3], a: match[4] };
        }
        if ((match = matchers.hsv.exec(color))) {
            return { h: match[1], s: match[2], v: match[3] };
        }
        if ((match = matchers.hsva.exec(color))) {
            return { h: match[1], s: match[2], v: match[3], a: match[4] };
        }
        if ((match = matchers.hex8.exec(color))) {
            return {
                a: convertHexToDecimal(match[1]),
                r: parseIntFromHex(match[2]),
                g: parseIntFromHex(match[3]),
                b: parseIntFromHex(match[4]),
                format: named ? "name" : "hex8"
            };
        }
        if ((match = matchers.hex6.exec(color))) {
            return {
                r: parseIntFromHex(match[1]),
                g: parseIntFromHex(match[2]),
                b: parseIntFromHex(match[3]),
                format: named ? "name" : "hex"
            };
        }
        if ((match = matchers.hex3.exec(color))) {
            return {
                r: parseIntFromHex(match[1] + '' + match[1]),
                g: parseIntFromHex(match[2] + '' + match[2]),
                b: parseIntFromHex(match[3] + '' + match[3]),
                format: named ? "name" : "hex"
            };
        }

        return false;
    }

    window.tinycolor = tinycolor;
    })();


    $(function () {
        if ($.fn.spectrum.load) {
            $.fn.spectrum.processNativeColorInputs();
        }
    });

});

/*! Hammer.JS - v2.0.4 - 2014-09-28
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2014 Jorik Tangelder;
 * Licensed under the MIT license */
!function(a,b,c,d){"use strict";function e(a,b,c){return setTimeout(k(a,c),b)}function f(a,b,c){return Array.isArray(a)?(g(a,c[b],c),!0):!1}function g(a,b,c){var e;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==d)for(e=0;e<a.length;)b.call(c,a[e],e,a),e++;else for(e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e,a)}function h(a,b,c){for(var e=Object.keys(b),f=0;f<e.length;)(!c||c&&a[e[f]]===d)&&(a[e[f]]=b[e[f]]),f++;return a}function i(a,b){return h(a,b,!0)}function j(a,b,c){var d,e=b.prototype;d=a.prototype=Object.create(e),d.constructor=a,d._super=e,c&&h(d,c)}function k(a,b){return function(){return a.apply(b,arguments)}}function l(a,b){return typeof a==kb?a.apply(b?b[0]||d:d,b):a}function m(a,b){return a===d?b:a}function n(a,b,c){g(r(b),function(b){a.addEventListener(b,c,!1)})}function o(a,b,c){g(r(b),function(b){a.removeEventListener(b,c,!1)})}function p(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function q(a,b){return a.indexOf(b)>-1}function r(a){return a.trim().split(/\s+/g)}function s(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var d=0;d<a.length;){if(c&&a[d][c]==b||!c&&a[d]===b)return d;d++}return-1}function t(a){return Array.prototype.slice.call(a,0)}function u(a,b,c){for(var d=[],e=[],f=0;f<a.length;){var g=b?a[f][b]:a[f];s(e,g)<0&&d.push(a[f]),e[f]=g,f++}return c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort()),d}function v(a,b){for(var c,e,f=b[0].toUpperCase()+b.slice(1),g=0;g<ib.length;){if(c=ib[g],e=c?c+f:b,e in a)return e;g++}return d}function w(){return ob++}function x(a){var b=a.ownerDocument;return b.defaultView||b.parentWindow}function y(a,b){var c=this;this.manager=a,this.callback=b,this.element=a.element,this.target=a.options.inputTarget,this.domHandler=function(b){l(a.options.enable,[a])&&c.handler(b)},this.init()}function z(a){var b,c=a.options.inputClass;return new(b=c?c:rb?N:sb?Q:qb?S:M)(a,A)}function A(a,b,c){var d=c.pointers.length,e=c.changedPointers.length,f=b&yb&&d-e===0,g=b&(Ab|Bb)&&d-e===0;c.isFirst=!!f,c.isFinal=!!g,f&&(a.session={}),c.eventType=b,B(a,c),a.emit("hammer.input",c),a.recognize(c),a.session.prevInput=c}function B(a,b){var c=a.session,d=b.pointers,e=d.length;c.firstInput||(c.firstInput=E(b)),e>1&&!c.firstMultiple?c.firstMultiple=E(b):1===e&&(c.firstMultiple=!1);var f=c.firstInput,g=c.firstMultiple,h=g?g.center:f.center,i=b.center=F(d);b.timeStamp=nb(),b.deltaTime=b.timeStamp-f.timeStamp,b.angle=J(h,i),b.distance=I(h,i),C(c,b),b.offsetDirection=H(b.deltaX,b.deltaY),b.scale=g?L(g.pointers,d):1,b.rotation=g?K(g.pointers,d):0,D(c,b);var j=a.element;p(b.srcEvent.target,j)&&(j=b.srcEvent.target),b.target=j}function C(a,b){var c=b.center,d=a.offsetDelta||{},e=a.prevDelta||{},f=a.prevInput||{};(b.eventType===yb||f.eventType===Ab)&&(e=a.prevDelta={x:f.deltaX||0,y:f.deltaY||0},d=a.offsetDelta={x:c.x,y:c.y}),b.deltaX=e.x+(c.x-d.x),b.deltaY=e.y+(c.y-d.y)}function D(a,b){var c,e,f,g,h=a.lastInterval||b,i=b.timeStamp-h.timeStamp;if(b.eventType!=Bb&&(i>xb||h.velocity===d)){var j=h.deltaX-b.deltaX,k=h.deltaY-b.deltaY,l=G(i,j,k);e=l.x,f=l.y,c=mb(l.x)>mb(l.y)?l.x:l.y,g=H(j,k),a.lastInterval=b}else c=h.velocity,e=h.velocityX,f=h.velocityY,g=h.direction;b.velocity=c,b.velocityX=e,b.velocityY=f,b.direction=g}function E(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:lb(a.pointers[c].clientX),clientY:lb(a.pointers[c].clientY)},c++;return{timeStamp:nb(),pointers:b,center:F(b),deltaX:a.deltaX,deltaY:a.deltaY}}function F(a){var b=a.length;if(1===b)return{x:lb(a[0].clientX),y:lb(a[0].clientY)};for(var c=0,d=0,e=0;b>e;)c+=a[e].clientX,d+=a[e].clientY,e++;return{x:lb(c/b),y:lb(d/b)}}function G(a,b,c){return{x:b/a||0,y:c/a||0}}function H(a,b){return a===b?Cb:mb(a)>=mb(b)?a>0?Db:Eb:b>0?Fb:Gb}function I(a,b,c){c||(c=Kb);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.sqrt(d*d+e*e)}function J(a,b,c){c||(c=Kb);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return 180*Math.atan2(e,d)/Math.PI}function K(a,b){return J(b[1],b[0],Lb)-J(a[1],a[0],Lb)}function L(a,b){return I(b[0],b[1],Lb)/I(a[0],a[1],Lb)}function M(){this.evEl=Nb,this.evWin=Ob,this.allow=!0,this.pressed=!1,y.apply(this,arguments)}function N(){this.evEl=Rb,this.evWin=Sb,y.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function O(){this.evTarget=Ub,this.evWin=Vb,this.started=!1,y.apply(this,arguments)}function P(a,b){var c=t(a.touches),d=t(a.changedTouches);return b&(Ab|Bb)&&(c=u(c.concat(d),"identifier",!0)),[c,d]}function Q(){this.evTarget=Xb,this.targetIds={},y.apply(this,arguments)}function R(a,b){var c=t(a.touches),d=this.targetIds;if(b&(yb|zb)&&1===c.length)return d[c[0].identifier]=!0,[c,c];var e,f,g=t(a.changedTouches),h=[],i=this.target;if(f=c.filter(function(a){return p(a.target,i)}),b===yb)for(e=0;e<f.length;)d[f[e].identifier]=!0,e++;for(e=0;e<g.length;)d[g[e].identifier]&&h.push(g[e]),b&(Ab|Bb)&&delete d[g[e].identifier],e++;return h.length?[u(f.concat(h),"identifier",!0),h]:void 0}function S(){y.apply(this,arguments);var a=k(this.handler,this);this.touch=new Q(this.manager,a),this.mouse=new M(this.manager,a)}function T(a,b){this.manager=a,this.set(b)}function U(a){if(q(a,bc))return bc;var b=q(a,cc),c=q(a,dc);return b&&c?cc+" "+dc:b||c?b?cc:dc:q(a,ac)?ac:_b}function V(a){this.id=w(),this.manager=null,this.options=i(a||{},this.defaults),this.options.enable=m(this.options.enable,!0),this.state=ec,this.simultaneous={},this.requireFail=[]}function W(a){return a&jc?"cancel":a&hc?"end":a&gc?"move":a&fc?"start":""}function X(a){return a==Gb?"down":a==Fb?"up":a==Db?"left":a==Eb?"right":""}function Y(a,b){var c=b.manager;return c?c.get(a):a}function Z(){V.apply(this,arguments)}function $(){Z.apply(this,arguments),this.pX=null,this.pY=null}function _(){Z.apply(this,arguments)}function ab(){V.apply(this,arguments),this._timer=null,this._input=null}function bb(){Z.apply(this,arguments)}function cb(){Z.apply(this,arguments)}function db(){V.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function eb(a,b){return b=b||{},b.recognizers=m(b.recognizers,eb.defaults.preset),new fb(a,b)}function fb(a,b){b=b||{},this.options=i(b,eb.defaults),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.element=a,this.input=z(this),this.touchAction=new T(this,this.options.touchAction),gb(this,!0),g(b.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]),a[3]&&b.requireFailure(a[3])},this)}function gb(a,b){var c=a.element;g(a.options.cssProps,function(a,d){c.style[v(c.style,d)]=b?a:""})}function hb(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0),d.gesture=c,c.target.dispatchEvent(d)}var ib=["","webkit","moz","MS","ms","o"],jb=b.createElement("div"),kb="function",lb=Math.round,mb=Math.abs,nb=Date.now,ob=1,pb=/mobile|tablet|ip(ad|hone|od)|android/i,qb="ontouchstart"in a,rb=v(a,"PointerEvent")!==d,sb=qb&&pb.test(navigator.userAgent),tb="touch",ub="pen",vb="mouse",wb="kinect",xb=25,yb=1,zb=2,Ab=4,Bb=8,Cb=1,Db=2,Eb=4,Fb=8,Gb=16,Hb=Db|Eb,Ib=Fb|Gb,Jb=Hb|Ib,Kb=["x","y"],Lb=["clientX","clientY"];y.prototype={handler:function(){},init:function(){this.evEl&&n(this.element,this.evEl,this.domHandler),this.evTarget&&n(this.target,this.evTarget,this.domHandler),this.evWin&&n(x(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&o(this.element,this.evEl,this.domHandler),this.evTarget&&o(this.target,this.evTarget,this.domHandler),this.evWin&&o(x(this.element),this.evWin,this.domHandler)}};var Mb={mousedown:yb,mousemove:zb,mouseup:Ab},Nb="mousedown",Ob="mousemove mouseup";j(M,y,{handler:function(a){var b=Mb[a.type];b&yb&&0===a.button&&(this.pressed=!0),b&zb&&1!==a.which&&(b=Ab),this.pressed&&this.allow&&(b&Ab&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:vb,srcEvent:a}))}});var Pb={pointerdown:yb,pointermove:zb,pointerup:Ab,pointercancel:Bb,pointerout:Bb},Qb={2:tb,3:ub,4:vb,5:wb},Rb="pointerdown",Sb="pointermove pointerup pointercancel";a.MSPointerEvent&&(Rb="MSPointerDown",Sb="MSPointerMove MSPointerUp MSPointerCancel"),j(N,y,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace("ms",""),e=Pb[d],f=Qb[a.pointerType]||a.pointerType,g=f==tb,h=s(b,a.pointerId,"pointerId");e&yb&&(0===a.button||g)?0>h&&(b.push(a),h=b.length-1):e&(Ab|Bb)&&(c=!0),0>h||(b[h]=a,this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(h,1))}});var Tb={touchstart:yb,touchmove:zb,touchend:Ab,touchcancel:Bb},Ub="touchstart",Vb="touchstart touchmove touchend touchcancel";j(O,y,{handler:function(a){var b=Tb[a.type];if(b===yb&&(this.started=!0),this.started){var c=P.call(this,a,b);b&(Ab|Bb)&&c[0].length-c[1].length===0&&(this.started=!1),this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:tb,srcEvent:a})}}});var Wb={touchstart:yb,touchmove:zb,touchend:Ab,touchcancel:Bb},Xb="touchstart touchmove touchend touchcancel";j(Q,y,{handler:function(a){var b=Wb[a.type],c=R.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:tb,srcEvent:a})}}),j(S,y,{handler:function(a,b,c){var d=c.pointerType==tb,e=c.pointerType==vb;if(d)this.mouse.allow=!1;else if(e&&!this.mouse.allow)return;b&(Ab|Bb)&&(this.mouse.allow=!0),this.callback(a,b,c)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Yb=v(jb.style,"touchAction"),Zb=Yb!==d,$b="compute",_b="auto",ac="manipulation",bc="none",cc="pan-x",dc="pan-y";T.prototype={set:function(a){a==$b&&(a=this.compute()),Zb&&(this.manager.element.style[Yb]=a),this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return g(this.manager.recognizers,function(b){l(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))}),U(a.join(" "))},preventDefaults:function(a){if(!Zb){var b=a.srcEvent,c=a.offsetDirection;if(this.manager.session.prevented)return void b.preventDefault();var d=this.actions,e=q(d,bc),f=q(d,dc),g=q(d,cc);return e||f&&c&Hb||g&&c&Ib?this.preventSrc(b):void 0}},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault()}};var ec=1,fc=2,gc=4,hc=8,ic=hc,jc=16,kc=32;V.prototype={defaults:{},set:function(a){return h(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(f(a,"recognizeWith",this))return this;var b=this.simultaneous;return a=Y(a,this),b[a.id]||(b[a.id]=a,a.recognizeWith(this)),this},dropRecognizeWith:function(a){return f(a,"dropRecognizeWith",this)?this:(a=Y(a,this),delete this.simultaneous[a.id],this)},requireFailure:function(a){if(f(a,"requireFailure",this))return this;var b=this.requireFail;return a=Y(a,this),-1===s(b,a)&&(b.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(f(a,"dropRequireFailure",this))return this;a=Y(a,this);var b=s(this.requireFail,a);return b>-1&&this.requireFail.splice(b,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(b){c.manager.emit(c.options.event+(b?W(d):""),a)}var c=this,d=this.state;hc>d&&b(!0),b(),d>=hc&&b(!0)},tryEmit:function(a){return this.canEmit()?this.emit(a):void(this.state=kc)},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(kc|ec)))return!1;a++}return!0},recognize:function(a){var b=h({},a);return l(this.options.enable,[this,b])?(this.state&(ic|jc|kc)&&(this.state=ec),this.state=this.process(b),void(this.state&(fc|gc|hc|jc)&&this.tryEmit(b))):(this.reset(),void(this.state=kc))},process:function(){},getTouchAction:function(){},reset:function(){}},j(Z,V,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,d=b&(fc|gc),e=this.attrTest(a);return d&&(c&Bb||!e)?b|jc:d||e?c&Ab?b|hc:b&fc?b|gc:fc:kc}}),j($,Z,{defaults:{event:"pan",threshold:10,pointers:1,direction:Jb},getTouchAction:function(){var a=this.options.direction,b=[];return a&Hb&&b.push(dc),a&Ib&&b.push(cc),b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,e=a.direction,f=a.deltaX,g=a.deltaY;return e&b.direction||(b.direction&Hb?(e=0===f?Cb:0>f?Db:Eb,c=f!=this.pX,d=Math.abs(a.deltaX)):(e=0===g?Cb:0>g?Fb:Gb,c=g!=this.pY,d=Math.abs(a.deltaY))),a.direction=e,c&&d>b.threshold&&e&b.direction},attrTest:function(a){return Z.prototype.attrTest.call(this,a)&&(this.state&fc||!(this.state&fc)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var b=X(a.direction);b&&this.manager.emit(this.options.event+b,a),this._super.emit.call(this,a)}}),j(_,Z,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[bc]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&fc)},emit:function(a){if(this._super.emit.call(this,a),1!==a.scale){var b=a.scale<1?"in":"out";this.manager.emit(this.options.event+b,a)}}}),j(ab,V,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[_b]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime>b.time;if(this._input=a,!d||!c||a.eventType&(Ab|Bb)&&!f)this.reset();else if(a.eventType&yb)this.reset(),this._timer=e(function(){this.state=ic,this.tryEmit()},b.time,this);else if(a.eventType&Ab)return ic;return kc},reset:function(){clearTimeout(this._timer)},emit:function(a){this.state===ic&&(a&&a.eventType&Ab?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=nb(),this.manager.emit(this.options.event,this._input)))}}),j(bb,Z,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[bc]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&fc)}}),j(cb,Z,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:Hb|Ib,pointers:1},getTouchAction:function(){return $.prototype.getTouchAction.call(this)},attrTest:function(a){var b,c=this.options.direction;return c&(Hb|Ib)?b=a.velocity:c&Hb?b=a.velocityX:c&Ib&&(b=a.velocityY),this._super.attrTest.call(this,a)&&c&a.direction&&a.distance>this.options.threshold&&mb(b)>this.options.velocity&&a.eventType&Ab},emit:function(a){var b=X(a.direction);b&&this.manager.emit(this.options.event+b,a),this.manager.emit(this.options.event,a)}}),j(db,V,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[ac]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime<b.time;if(this.reset(),a.eventType&yb&&0===this.count)return this.failTimeout();if(d&&f&&c){if(a.eventType!=Ab)return this.failTimeout();var g=this.pTime?a.timeStamp-this.pTime<b.interval:!0,h=!this.pCenter||I(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp,this.pCenter=a.center,h&&g?this.count+=1:this.count=1,this._input=a;var i=this.count%b.taps;if(0===i)return this.hasRequireFailures()?(this._timer=e(function(){this.state=ic,this.tryEmit()},b.interval,this),fc):ic}return kc},failTimeout:function(){return this._timer=e(function(){this.state=kc},this.options.interval,this),kc},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ic&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),eb.VERSION="2.0.4",eb.defaults={domEvents:!1,touchAction:$b,enable:!0,inputTarget:null,inputClass:null,preset:[[bb,{enable:!1}],[_,{enable:!1},["rotate"]],[cb,{direction:Hb}],[$,{direction:Hb},["swipe"]],[db],[db,{event:"doubletap",taps:2},["tap"]],[ab]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var lc=1,mc=2;fb.prototype={set:function(a){return h(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=a?mc:lc},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,e=b.curRecognizer;(!e||e&&e.state&ic)&&(e=b.curRecognizer=null);for(var f=0;f<d.length;)c=d[f],b.stopped===mc||e&&c!=e&&!c.canRecognizeWith(e)?c.reset():c.recognize(a),!e&&c.state&(fc|gc|hc)&&(e=b.curRecognizer=c),f++}},get:function(a){if(a instanceof V)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(f(a,"add",this))return this;var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a},remove:function(a){if(f(a,"remove",this))return this;var b=this.recognizers;return a=this.get(a),b.splice(s(b,a),1),this.touchAction.update(),this},on:function(a,b){var c=this.handlers;return g(r(a),function(a){c[a]=c[a]||[],c[a].push(b)}),this},off:function(a,b){var c=this.handlers;return g(r(a),function(a){b?c[a].splice(s(c[a],b),1):delete c[a]}),this},emit:function(a,b){this.options.domEvents&&hb(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a,b.preventDefault=function(){b.srcEvent.preventDefault()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&gb(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},h(eb,{INPUT_START:yb,INPUT_MOVE:zb,INPUT_END:Ab,INPUT_CANCEL:Bb,STATE_POSSIBLE:ec,STATE_BEGAN:fc,STATE_CHANGED:gc,STATE_ENDED:hc,STATE_RECOGNIZED:ic,STATE_CANCELLED:jc,STATE_FAILED:kc,DIRECTION_NONE:Cb,DIRECTION_LEFT:Db,DIRECTION_RIGHT:Eb,DIRECTION_UP:Fb,DIRECTION_DOWN:Gb,DIRECTION_HORIZONTAL:Hb,DIRECTION_VERTICAL:Ib,DIRECTION_ALL:Jb,Manager:fb,Input:y,TouchAction:T,TouchInput:Q,MouseInput:M,PointerEventInput:N,TouchMouseInput:S,SingleTouchInput:O,Recognizer:V,AttrRecognizer:Z,Tap:db,Pan:$,Swipe:cb,Pinch:_,Rotate:bb,Press:ab,on:n,off:o,each:g,merge:i,extend:h,inherit:j,bindFn:k,prefixed:v}),typeof define==kb&&define.amd?define(function(){return eb}):"undefined"!=typeof module&&module.exports?module.exports=eb:a[c]=eb}(window,document,"Hammer");
//# sourceMappingURL=hammer.min.map
/* == jquery mousewheel plugin == Version: 3.1.12, License: MIT License (MIT) */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(m=-1*g.detail),"wheelDelta"in g&&(m=g.wheelDelta),"wheelDeltaY"in g&&(m=g.wheelDeltaY),"wheelDeltaX"in g&&(l=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,"deltaY"in g&&(m=-1*g.deltaY,j=m),"deltaX"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,"mousewheel-line-height");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,"mousewheel-page-height");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?"floor":"ceil"](j/f),l=Math[l>=1?"floor":"ceil"](l/f),m=Math[m>=1?"floor":"ceil"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&"mousewheel"===a.type&&b%120===0}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,"mousewheel-line-height"),a.removeData(this,"mousewheel-page-height")},getLineHeight:function(b){var c=a(b),d=c["offsetParent"in a.fn?"offsetParent":"parent"]();return d.length||(d=a("body")),parseInt(d.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})});
/* == malihu jquery custom scrollbar plugin == Version: 3.0.7, License: MIT License (MIT) */
!function(e,t,a){!function(t){var o="function"==typeof define&&define.amd,n="https:"==a.location.protocol?"https:":"http:",i="cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.12/jquery.mousewheel.min.js";o||e.event.special.mousewheel||e("head").append(decodeURI("%3Cscript src="+n+"//"+i+"%3E%3C/script%3E")),t()}(function(){var o,n="mCustomScrollbar",i="mCS",r=".mCustomScrollbar",l={setTop:0,setLeft:0,axis:"y",scrollbarPosition:"inside",scrollInertia:950,autoDraggerLength:!0,alwaysShowScrollbar:0,snapOffset:0,mouseWheel:{enable:!0,scrollAmount:"auto",axis:"y",deltaFactor:"auto",disableOver:["select","option","keygen","datalist","textarea"]},scrollButtons:{scrollType:"stepless",scrollAmount:"auto"},keyboard:{enable:!0,scrollType:"stepless",scrollAmount:"auto"},contentTouchScroll:25,advanced:{autoScrollOnFocus:"input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']",updateOnContentResize:!0,updateOnImageLoad:!0},theme:"light",callbacks:{onTotalScrollOffset:0,onTotalScrollBackOffset:0,alwaysTriggerOffsets:!0}},s=0,c={},d=t.attachEvent&&!t.addEventListener?1:0,u=!1,f=["mCSB_dragger_onDrag","mCSB_scrollTools_onDrag","mCS_img_loaded","mCS_disabled","mCS_destroyed","mCS_no_scrollbar","mCS-autoHide","mCS-dir-rtl","mCS_no_scrollbar_y","mCS_no_scrollbar_x","mCS_y_hidden","mCS_x_hidden","mCSB_draggerContainer","mCSB_buttonUp","mCSB_buttonDown","mCSB_buttonLeft","mCSB_buttonRight"],h={init:function(t){var t=e.extend(!0,{},l,t),a=m.call(this);if(t.live){var o=t.liveSelector||this.selector||r,n=e(o);if("off"===t.live)return void g(o);c[o]=setTimeout(function(){n.mCustomScrollbar(t),"once"===t.live&&n.length&&g(o)},500)}else g(o);return t.setWidth=t.set_width?t.set_width:t.setWidth,t.setHeight=t.set_height?t.set_height:t.setHeight,t.axis=t.horizontalScroll?"x":v(t.axis),t.scrollInertia=t.scrollInertia>0&&t.scrollInertia<17?17:t.scrollInertia,"object"!=typeof t.mouseWheel&&1==t.mouseWheel&&(t.mouseWheel={enable:!0,scrollAmount:"auto",axis:"y",preventDefault:!1,deltaFactor:"auto",normalizeDelta:!1,invert:!1}),t.mouseWheel.scrollAmount=t.mouseWheelPixels?t.mouseWheelPixels:t.mouseWheel.scrollAmount,t.mouseWheel.normalizeDelta=t.advanced.normalizeMouseWheelDelta?t.advanced.normalizeMouseWheelDelta:t.mouseWheel.normalizeDelta,t.scrollButtons.scrollType=x(t.scrollButtons.scrollType),p(t),e(a).each(function(){var a=e(this);if(!a.data(i)){a.data(i,{idx:++s,opt:t,scrollRatio:{y:null,x:null},overflowed:null,contentReset:{y:null,x:null},bindEvents:!1,tweenRunning:!1,sequential:{},langDir:a.css("direction"),cbOffsets:null,trigger:null});var o=a.data(i),n=o.opt,r=a.data("mcs-axis"),l=a.data("mcs-scrollbar-position"),c=a.data("mcs-theme");r&&(n.axis=r),l&&(n.scrollbarPosition=l),c&&(n.theme=c,p(n)),_.call(this),e("#mCSB_"+o.idx+"_container img:not(."+f[2]+")").addClass(f[2]),h.update.call(null,a)}})},update:function(t,a){var o=t||m.call(this);return e(o).each(function(){var t=e(this);if(t.data(i)){var o=t.data(i),n=o.opt,r=e("#mCSB_"+o.idx+"_container"),l=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")];if(!r.length)return;o.tweenRunning&&Q(t),t.hasClass(f[3])&&t.removeClass(f[3]),t.hasClass(f[4])&&t.removeClass(f[4]),C.call(this),w.call(this),"y"===n.axis||n.advanced.autoExpandHorizontalScroll||r.css("width",S(r.children())),o.overflowed=k.call(this),R.call(this),n.autoDraggerLength&&y.call(this),B.call(this),O.call(this);var s=[Math.abs(r[0].offsetTop),Math.abs(r[0].offsetLeft)];"x"!==n.axis&&(o.overflowed[0]?l[0].height()>l[0].parent().height()?M.call(this):(G(t,s[0].toString(),{dir:"y",dur:0,overwrite:"none"}),o.contentReset.y=null):(M.call(this),"y"===n.axis?I.call(this):"yx"===n.axis&&o.overflowed[1]&&G(t,s[1].toString(),{dir:"x",dur:0,overwrite:"none"}))),"y"!==n.axis&&(o.overflowed[1]?l[1].width()>l[1].parent().width()?M.call(this):(G(t,s[1].toString(),{dir:"x",dur:0,overwrite:"none"}),o.contentReset.x=null):(M.call(this),"x"===n.axis?I.call(this):"yx"===n.axis&&o.overflowed[0]&&G(t,s[0].toString(),{dir:"y",dur:0,overwrite:"none"}))),a&&o&&(2===a&&n.callbacks.onImageLoad&&"function"==typeof n.callbacks.onImageLoad?n.callbacks.onImageLoad.call(this):3===a&&n.callbacks.onSelectorChange&&"function"==typeof n.callbacks.onSelectorChange?n.callbacks.onSelectorChange.call(this):n.callbacks.onUpdate&&"function"==typeof n.callbacks.onUpdate&&n.callbacks.onUpdate.call(this)),N.call(this)}})},scrollTo:function(t,a){if("undefined"!=typeof t&&null!=t){var o=m.call(this);return e(o).each(function(){var o=e(this);if(o.data(i)){var n=o.data(i),r=n.opt,l={trigger:"external",scrollInertia:r.scrollInertia,scrollEasing:"mcsEaseInOut",moveDragger:!1,timeout:60,callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},s=e.extend(!0,{},l,a),c=Y.call(this,t),d=s.scrollInertia>0&&s.scrollInertia<17?17:s.scrollInertia;c[0]=X.call(this,c[0],"y"),c[1]=X.call(this,c[1],"x"),s.moveDragger&&(c[0]*=n.scrollRatio.y,c[1]*=n.scrollRatio.x),s.dur=d,setTimeout(function(){null!==c[0]&&"undefined"!=typeof c[0]&&"x"!==r.axis&&n.overflowed[0]&&(s.dir="y",s.overwrite="all",G(o,c[0].toString(),s)),null!==c[1]&&"undefined"!=typeof c[1]&&"y"!==r.axis&&n.overflowed[1]&&(s.dir="x",s.overwrite="none",G(o,c[1].toString(),s))},s.timeout)}})}},stop:function(){var t=m.call(this);return e(t).each(function(){var t=e(this);t.data(i)&&Q(t)})},disable:function(t){var a=m.call(this);return e(a).each(function(){var a=e(this);if(a.data(i)){{a.data(i)}N.call(this,"remove"),I.call(this),t&&M.call(this),R.call(this,!0),a.addClass(f[3])}})},destroy:function(){var t=m.call(this);return e(t).each(function(){var a=e(this);if(a.data(i)){var o=a.data(i),r=o.opt,l=e("#mCSB_"+o.idx),s=e("#mCSB_"+o.idx+"_container"),c=e(".mCSB_"+o.idx+"_scrollbar");r.live&&g(r.liveSelector||e(t).selector),N.call(this,"remove"),I.call(this),M.call(this),a.removeData(i),$(this,"mcs"),c.remove(),s.find("img."+f[2]).removeClass(f[2]),l.replaceWith(s.contents()),a.removeClass(n+" _"+i+"_"+o.idx+" "+f[6]+" "+f[7]+" "+f[5]+" "+f[3]).addClass(f[4])}})}},m=function(){return"object"!=typeof e(this)||e(this).length<1?r:this},p=function(t){var a=["rounded","rounded-dark","rounded-dots","rounded-dots-dark"],o=["rounded-dots","rounded-dots-dark","3d","3d-dark","3d-thick","3d-thick-dark","inset","inset-dark","inset-2","inset-2-dark","inset-3","inset-3-dark"],n=["minimal","minimal-dark"],i=["minimal","minimal-dark"],r=["minimal","minimal-dark"];t.autoDraggerLength=e.inArray(t.theme,a)>-1?!1:t.autoDraggerLength,t.autoExpandScrollbar=e.inArray(t.theme,o)>-1?!1:t.autoExpandScrollbar,t.scrollButtons.enable=e.inArray(t.theme,n)>-1?!1:t.scrollButtons.enable,t.autoHideScrollbar=e.inArray(t.theme,i)>-1?!0:t.autoHideScrollbar,t.scrollbarPosition=e.inArray(t.theme,r)>-1?"outside":t.scrollbarPosition},g=function(e){c[e]&&(clearTimeout(c[e]),$(c,e))},v=function(e){return"yx"===e||"xy"===e||"auto"===e?"yx":"x"===e||"horizontal"===e?"x":"y"},x=function(e){return"stepped"===e||"pixels"===e||"step"===e||"click"===e?"stepped":"stepless"},_=function(){var t=e(this),a=t.data(i),o=a.opt,r=o.autoExpandScrollbar?" "+f[1]+"_expand":"",l=["<div id='mCSB_"+a.idx+"_scrollbar_vertical' class='mCSB_scrollTools mCSB_"+a.idx+"_scrollbar mCS-"+o.theme+" mCSB_scrollTools_vertical"+r+"'><div class='"+f[12]+"'><div id='mCSB_"+a.idx+"_dragger_vertical' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>","<div id='mCSB_"+a.idx+"_scrollbar_horizontal' class='mCSB_scrollTools mCSB_"+a.idx+"_scrollbar mCS-"+o.theme+" mCSB_scrollTools_horizontal"+r+"'><div class='"+f[12]+"'><div id='mCSB_"+a.idx+"_dragger_horizontal' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>"],s="yx"===o.axis?"mCSB_vertical_horizontal":"x"===o.axis?"mCSB_horizontal":"mCSB_vertical",c="yx"===o.axis?l[0]+l[1]:"x"===o.axis?l[1]:l[0],d="yx"===o.axis?"<div id='mCSB_"+a.idx+"_container_wrapper' class='mCSB_container_wrapper' />":"",u=o.autoHideScrollbar?" "+f[6]:"",h="x"!==o.axis&&"rtl"===a.langDir?" "+f[7]:"";o.setWidth&&t.css("width",o.setWidth),o.setHeight&&t.css("height",o.setHeight),o.setLeft="y"!==o.axis&&"rtl"===a.langDir?"989999px":o.setLeft,t.addClass(n+" _"+i+"_"+a.idx+u+h).wrapInner("<div id='mCSB_"+a.idx+"' class='mCustomScrollBox mCS-"+o.theme+" "+s+"'><div id='mCSB_"+a.idx+"_container' class='mCSB_container' style='position:relative; top:"+o.setTop+"; left:"+o.setLeft+";' dir="+a.langDir+" /></div>");var m=e("#mCSB_"+a.idx),p=e("#mCSB_"+a.idx+"_container");"y"===o.axis||o.advanced.autoExpandHorizontalScroll||p.css("width",S(p.children())),"outside"===o.scrollbarPosition?("static"===t.css("position")&&t.css("position","relative"),t.css("overflow","visible"),m.addClass("mCSB_outside").after(c)):(m.addClass("mCSB_inside").append(c),p.wrap(d)),b.call(this);var g=[e("#mCSB_"+a.idx+"_dragger_vertical"),e("#mCSB_"+a.idx+"_dragger_horizontal")];g[0].css("min-height",g[0].height()),g[1].css("min-width",g[1].width())},S=function(t){return Math.max.apply(Math,t.map(function(){return e(this).outerWidth(!0)}).get())},w=function(){var t=e(this),a=t.data(i),o=a.opt,n=e("#mCSB_"+a.idx+"_container");o.advanced.autoExpandHorizontalScroll&&"y"!==o.axis&&n.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:Math.ceil(n[0].getBoundingClientRect().right+.4)-Math.floor(n[0].getBoundingClientRect().left),position:"relative"}).unwrap()},b=function(){var t=e(this),a=t.data(i),o=a.opt,n=e(".mCSB_"+a.idx+"_scrollbar:first"),r=at(o.scrollButtons.tabindex)?"tabindex='"+o.scrollButtons.tabindex+"'":"",l=["<a href='#' class='"+f[13]+"' oncontextmenu='return false;' "+r+" />","<a href='#' class='"+f[14]+"' oncontextmenu='return false;' "+r+" />","<a href='#' class='"+f[15]+"' oncontextmenu='return false;' "+r+" />","<a href='#' class='"+f[16]+"' oncontextmenu='return false;' "+r+" />"],s=["x"===o.axis?l[2]:l[0],"x"===o.axis?l[3]:l[1],l[2],l[3]];o.scrollButtons.enable&&n.prepend(s[0]).append(s[1]).next(".mCSB_scrollTools").prepend(s[2]).append(s[3])},C=function(){var t=e(this),a=t.data(i),o=e("#mCSB_"+a.idx),n=t.css("max-height")||"none",r=-1!==n.indexOf("%"),l=t.css("box-sizing");if("none"!==n){var s=r?t.parent().height()*parseInt(n)/100:parseInt(n);"border-box"===l&&(s-=t.innerHeight()-t.height()+(t.outerHeight()-t.innerHeight())),o.css("max-height",Math.round(s))}},y=function(){var t=e(this),a=t.data(i),o=e("#mCSB_"+a.idx),n=e("#mCSB_"+a.idx+"_container"),r=[e("#mCSB_"+a.idx+"_dragger_vertical"),e("#mCSB_"+a.idx+"_dragger_horizontal")],l=[o.height()/n.outerHeight(!1),o.width()/n.outerWidth(!1)],s=[parseInt(r[0].css("min-height")),Math.round(l[0]*r[0].parent().height()),parseInt(r[1].css("min-width")),Math.round(l[1]*r[1].parent().width())],c=d&&s[1]<s[0]?s[0]:s[1],u=d&&s[3]<s[2]?s[2]:s[3];r[0].css({height:c,"max-height":r[0].parent().height()-10}).find(".mCSB_dragger_bar").css({"line-height":s[0]+"px"}),r[1].css({width:u,"max-width":r[1].parent().width()-10})},B=function(){var t=e(this),a=t.data(i),o=e("#mCSB_"+a.idx),n=e("#mCSB_"+a.idx+"_container"),r=[e("#mCSB_"+a.idx+"_dragger_vertical"),e("#mCSB_"+a.idx+"_dragger_horizontal")],l=[n.outerHeight(!1)-o.height(),n.outerWidth(!1)-o.width()],s=[l[0]/(r[0].parent().height()-r[0].height()),l[1]/(r[1].parent().width()-r[1].width())];a.scrollRatio={y:s[0],x:s[1]}},T=function(e,t,a){var o=a?f[0]+"_expanded":"",n=e.closest(".mCSB_scrollTools");"active"===t?(e.toggleClass(f[0]+" "+o),n.toggleClass(f[1]),e[0]._draggable=e[0]._draggable?0:1):e[0]._draggable||("hide"===t?(e.removeClass(f[0]),n.removeClass(f[1])):(e.addClass(f[0]),n.addClass(f[1])))},k=function(){var t=e(this),a=t.data(i),o=e("#mCSB_"+a.idx),n=e("#mCSB_"+a.idx+"_container"),r=null==a.overflowed?n.height():n.outerHeight(!1),l=null==a.overflowed?n.width():n.outerWidth(!1);return[r>o.height(),l>o.width()]},M=function(){var t=e(this),a=t.data(i),o=a.opt,n=e("#mCSB_"+a.idx),r=e("#mCSB_"+a.idx+"_container"),l=[e("#mCSB_"+a.idx+"_dragger_vertical"),e("#mCSB_"+a.idx+"_dragger_horizontal")];if(Q(t),("x"!==o.axis&&!a.overflowed[0]||"y"===o.axis&&a.overflowed[0])&&(l[0].add(r).css("top",0),G(t,"_resetY")),"y"!==o.axis&&!a.overflowed[1]||"x"===o.axis&&a.overflowed[1]){var s=dx=0;"rtl"===a.langDir&&(s=n.width()-r.outerWidth(!1),dx=Math.abs(s/a.scrollRatio.x)),r.css("left",s),l[1].css("left",dx),G(t,"_resetX")}},O=function(){function t(){r=setTimeout(function(){e.event.special.mousewheel?(clearTimeout(r),A.call(a[0])):t()},100)}var a=e(this),o=a.data(i),n=o.opt;if(!o.bindEvents){if(D.call(this),n.contentTouchScroll&&L.call(this),W.call(this),n.mouseWheel.enable){var r;t()}z.call(this),U.call(this),n.advanced.autoScrollOnFocus&&H.call(this),n.scrollButtons.enable&&F.call(this),n.keyboard.enable&&q.call(this),o.bindEvents=!0}},I=function(){var t=e(this),o=t.data(i),n=o.opt,r=i+"_"+o.idx,l=".mCSB_"+o.idx+"_scrollbar",s=e("#mCSB_"+o.idx+",#mCSB_"+o.idx+"_container,#mCSB_"+o.idx+"_container_wrapper,"+l+" ."+f[12]+",#mCSB_"+o.idx+"_dragger_vertical,#mCSB_"+o.idx+"_dragger_horizontal,"+l+">a"),c=e("#mCSB_"+o.idx+"_container");n.advanced.releaseDraggableSelectors&&s.add(e(n.advanced.releaseDraggableSelectors)),o.bindEvents&&(e(a).unbind("."+r),s.each(function(){e(this).unbind("."+r)}),clearTimeout(t[0]._focusTimeout),$(t[0],"_focusTimeout"),clearTimeout(o.sequential.step),$(o.sequential,"step"),clearTimeout(c[0].onCompleteTimeout),$(c[0],"onCompleteTimeout"),o.bindEvents=!1)},R=function(t){var a=e(this),o=a.data(i),n=o.opt,r=e("#mCSB_"+o.idx+"_container_wrapper"),l=r.length?r:e("#mCSB_"+o.idx+"_container"),s=[e("#mCSB_"+o.idx+"_scrollbar_vertical"),e("#mCSB_"+o.idx+"_scrollbar_horizontal")],c=[s[0].find(".mCSB_dragger"),s[1].find(".mCSB_dragger")];"x"!==n.axis&&(o.overflowed[0]&&!t?(s[0].add(c[0]).add(s[0].children("a")).css("display","block"),l.removeClass(f[8]+" "+f[10])):(n.alwaysShowScrollbar?(2!==n.alwaysShowScrollbar&&c[0].css("display","none"),l.removeClass(f[10])):(s[0].css("display","none"),l.addClass(f[10])),l.addClass(f[8]))),"y"!==n.axis&&(o.overflowed[1]&&!t?(s[1].add(c[1]).add(s[1].children("a")).css("display","block"),l.removeClass(f[9]+" "+f[11])):(n.alwaysShowScrollbar?(2!==n.alwaysShowScrollbar&&c[1].css("display","none"),l.removeClass(f[11])):(s[1].css("display","none"),l.addClass(f[11])),l.addClass(f[9]))),o.overflowed[0]||o.overflowed[1]?a.removeClass(f[5]):a.addClass(f[5])},E=function(e){var t=e.type;switch(t){case"pointerdown":case"MSPointerDown":case"pointermove":case"MSPointerMove":case"pointerup":case"MSPointerUp":return[e.originalEvent.pageY,e.originalEvent.pageX,!1];case"touchstart":case"touchmove":case"touchend":var a=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],o=e.originalEvent.touches.length||e.originalEvent.changedTouches.length;return[a.pageY,a.pageX,o>1];default:return[e.pageY,e.pageX,!1]}},D=function(){function t(e){var t=p.find("iframe");if(t.length){var a=e?"auto":"none";t.css("pointer-events",a)}}function o(e,t,a,o){if(p[0].idleTimer=f.scrollInertia<233?250:0,n.attr("id")===m[1])var i="x",r=(n[0].offsetLeft-t+o)*c.scrollRatio.x;else var i="y",r=(n[0].offsetTop-e+a)*c.scrollRatio.y;G(s,r.toString(),{dir:i,drag:!0})}var n,r,l,s=e(this),c=s.data(i),f=c.opt,h=i+"_"+c.idx,m=["mCSB_"+c.idx+"_dragger_vertical","mCSB_"+c.idx+"_dragger_horizontal"],p=e("#mCSB_"+c.idx+"_container"),g=e("#"+m[0]+",#"+m[1]),v=f.advanced.releaseDraggableSelectors?g.add(e(f.advanced.releaseDraggableSelectors)):g;g.bind("mousedown."+h+" touchstart."+h+" pointerdown."+h+" MSPointerDown."+h,function(o){if(o.stopImmediatePropagation(),o.preventDefault(),et(o)){u=!0,d&&(a.onselectstart=function(){return!1}),t(!1),Q(s),n=e(this);var i=n.offset(),c=E(o)[0]-i.top,h=E(o)[1]-i.left,m=n.height()+i.top,p=n.width()+i.left;m>c&&c>0&&p>h&&h>0&&(r=c,l=h),T(n,"active",f.autoExpandScrollbar)}}).bind("touchmove."+h,function(e){e.stopImmediatePropagation(),e.preventDefault();var t=n.offset(),a=E(e)[0]-t.top,i=E(e)[1]-t.left;o(r,l,a,i)}),e(a).bind("mousemove."+h+" pointermove."+h+" MSPointerMove."+h,function(e){if(n){var t=n.offset(),a=E(e)[0]-t.top,i=E(e)[1]-t.left;if(r===a)return;o(r,l,a,i)}}).add(v).bind("mouseup."+h+" touchend."+h+" pointerup."+h+" MSPointerUp."+h,function(){n&&(T(n,"active",f.autoExpandScrollbar),n=null),u=!1,d&&(a.onselectstart=null),t(!0)})},L=function(){function t(e,t){var a=[1.5*t,2*t,t/1.5,t/2];return e>90?t>4?a[0]:a[3]:e>60?t>3?a[3]:a[2]:e>30?t>8?a[1]:t>6?a[0]:t>4?t:a[2]:t>8?t:a[3]}function a(e,t,a,o,n,i){e&&G(_,e.toString(),{dur:t,scrollEasing:a,dir:o,overwrite:n,drag:i})}var n,r,l,s,c,d,f,h,m,p,g,v,x,_=e(this),S=_.data(i),w=S.opt,b=i+"_"+S.idx,C=e("#mCSB_"+S.idx),y=e("#mCSB_"+S.idx+"_container"),B=[e("#mCSB_"+S.idx+"_dragger_vertical"),e("#mCSB_"+S.idx+"_dragger_horizontal")],T=[],k=[],M=0,O="yx"===w.axis?"none":"all",I=[];y.bind("touchstart."+b+" pointerdown."+b+" MSPointerDown."+b,function(e){if(!tt(e)||u||E(e)[2])return void(o=0);o=1,v=0,x=0;var t=y.offset();n=E(e)[0]-t.top,r=E(e)[1]-t.left,I=[E(e)[0],E(e)[1]]}).bind("touchmove."+b+" pointermove."+b+" MSPointerMove."+b,function(e){if(tt(e)&&!u&&!E(e)[2]&&(e.stopImmediatePropagation(),!x||v)){d=K();var t=C.offset(),o=E(e)[0]-t.top,i=E(e)[1]-t.left,l="mcsLinearOut";if(T.push(o),k.push(i),I[2]=Math.abs(E(e)[0]-I[0]),I[3]=Math.abs(E(e)[1]-I[1]),S.overflowed[0])var s=B[0].parent().height()-B[0].height(),c=n-o>0&&o-n>-(s*S.scrollRatio.y)&&(2*I[3]<I[2]||"yx"===w.axis);if(S.overflowed[1])var f=B[1].parent().width()-B[1].width(),h=r-i>0&&i-r>-(f*S.scrollRatio.x)&&(2*I[2]<I[3]||"yx"===w.axis);c||h?(e.preventDefault(),v=1):x=1,p="yx"===w.axis?[n-o,r-i]:"x"===w.axis?[null,r-i]:[n-o,null],y[0].idleTimer=250,S.overflowed[0]&&a(p[0],M,l,"y","all",!0),S.overflowed[1]&&a(p[1],M,l,"x",O,!0)}}),C.bind("touchstart."+b+" pointerdown."+b+" MSPointerDown."+b,function(e){if(!tt(e)||u||E(e)[2])return void(o=0);o=1,e.stopImmediatePropagation(),Q(_),c=K();var t=C.offset();l=E(e)[0]-t.top,s=E(e)[1]-t.left,T=[],k=[]}).bind("touchend."+b+" pointerup."+b+" MSPointerUp."+b,function(e){if(tt(e)&&!u&&!E(e)[2]){e.stopImmediatePropagation(),v=0,x=0,f=K();var o=C.offset(),n=E(e)[0]-o.top,i=E(e)[1]-o.left;if(!(f-d>30)){m=1e3/(f-c);var r="mcsEaseOut",_=2.5>m,b=_?[T[T.length-2],k[k.length-2]]:[0,0];h=_?[n-b[0],i-b[1]]:[n-l,i-s];var B=[Math.abs(h[0]),Math.abs(h[1])];m=_?[Math.abs(h[0]/4),Math.abs(h[1]/4)]:[m,m];var M=[Math.abs(y[0].offsetTop)-h[0]*t(B[0]/m[0],m[0]),Math.abs(y[0].offsetLeft)-h[1]*t(B[1]/m[1],m[1])];p="yx"===w.axis?[M[0],M[1]]:"x"===w.axis?[null,M[1]]:[M[0],null],g=[4*B[0]+w.scrollInertia,4*B[1]+w.scrollInertia];var I=parseInt(w.contentTouchScroll)||0;p[0]=B[0]>I?p[0]:0,p[1]=B[1]>I?p[1]:0,S.overflowed[0]&&a(p[0],g[0],r,"y",O,!1),S.overflowed[1]&&a(p[1],g[1],r,"x",O,!1)}}})},W=function(){function n(){return t.getSelection?t.getSelection().toString():a.selection&&"Control"!=a.selection.type?a.selection.createRange().text:0}function r(e,t,a){f.type=a&&l?"stepped":"stepless",f.scrollAmount=10,j(s,e,t,"mcsLinearOut",a?60:null)}var l,s=e(this),c=s.data(i),d=c.opt,f=c.sequential,h=i+"_"+c.idx,m=e("#mCSB_"+c.idx+"_container"),p=m.parent();m.bind("mousedown."+h,function(){o||l||(l=1,u=!0)}).add(a).bind("mousemove."+h,function(e){if(!o&&l&&n()){var t=m.offset(),a=E(e)[0]-t.top+m[0].offsetTop,i=E(e)[1]-t.left+m[0].offsetLeft;a>0&&a<p.height()&&i>0&&i<p.width()?f.step&&r("off",null,"stepped"):("x"!==d.axis&&c.overflowed[0]&&(0>a?r("on",38):a>p.height()&&r("on",40)),"y"!==d.axis&&c.overflowed[1]&&(0>i?r("on",37):i>p.width()&&r("on",39)))}}).bind("mouseup."+h,function(){o||(l&&(l=0,r("off",null)),u=!1)})},A=function(){function t(e){var t=null;try{var a=e.contentDocument||e.contentWindow.document;t=a.body.innerHTML}catch(o){}return null!==t}var a=e(this),o=a.data(i);if(o){var n=o.opt,r=i+"_"+o.idx,l=e("#mCSB_"+o.idx),s=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")],c=e("#mCSB_"+o.idx+"_container").find("iframe"),u=l;c.length&&c.each(function(){var a=this;t(a)&&(u=u.add(e(a).contents().find("body")))}),u.bind("mousewheel."+r,function(t,i){if(Q(a),!P(a,t.target)){var r="auto"!==n.mouseWheel.deltaFactor?parseInt(n.mouseWheel.deltaFactor):d&&t.deltaFactor<100?100:t.deltaFactor||100;if("x"===n.axis||"x"===n.mouseWheel.axis)var c="x",u=[Math.round(r*o.scrollRatio.x),parseInt(n.mouseWheel.scrollAmount)],f="auto"!==n.mouseWheel.scrollAmount?u[1]:u[0]>=l.width()?.9*l.width():u[0],h=Math.abs(e("#mCSB_"+o.idx+"_container")[0].offsetLeft),m=s[1][0].offsetLeft,p=s[1].parent().width()-s[1].width(),g=t.deltaX||t.deltaY||i;else var c="y",u=[Math.round(r*o.scrollRatio.y),parseInt(n.mouseWheel.scrollAmount)],f="auto"!==n.mouseWheel.scrollAmount?u[1]:u[0]>=l.height()?.9*l.height():u[0],h=Math.abs(e("#mCSB_"+o.idx+"_container")[0].offsetTop),m=s[0][0].offsetTop,p=s[0].parent().height()-s[0].height(),g=t.deltaY||i;"y"===c&&!o.overflowed[0]||"x"===c&&!o.overflowed[1]||(n.mouseWheel.invert&&(g=-g),n.mouseWheel.normalizeDelta&&(g=0>g?-1:1),(g>0&&0!==m||0>g&&m!==p||n.mouseWheel.preventDefault)&&(t.stopImmediatePropagation(),t.preventDefault()),G(a,(h-g*f).toString(),{dir:c}))}})}},P=function(t,a){var o=a.nodeName.toLowerCase(),n=t.data(i).opt.mouseWheel.disableOver,r=["select","textarea"];return e.inArray(o,n)>-1&&!(e.inArray(o,r)>-1&&!e(a).is(":focus"))},z=function(){var t=e(this),a=t.data(i),o=i+"_"+a.idx,n=e("#mCSB_"+a.idx+"_container"),r=n.parent(),l=e(".mCSB_"+a.idx+"_scrollbar ."+f[12]);l.bind("touchstart."+o+" pointerdown."+o+" MSPointerDown."+o,function(){u=!0}).bind("touchend."+o+" pointerup."+o+" MSPointerUp."+o,function(){u=!1}).bind("click."+o,function(o){if(e(o.target).hasClass(f[12])||e(o.target).hasClass("mCSB_draggerRail")){Q(t);var i=e(this),l=i.find(".mCSB_dragger");if(i.parent(".mCSB_scrollTools_horizontal").length>0){if(!a.overflowed[1])return;var s="x",c=o.pageX>l.offset().left?-1:1,d=Math.abs(n[0].offsetLeft)-.9*c*r.width()}else{if(!a.overflowed[0])return;var s="y",c=o.pageY>l.offset().top?-1:1,d=Math.abs(n[0].offsetTop)-.9*c*r.height()}G(t,d.toString(),{dir:s,scrollEasing:"mcsEaseInOut"})}})},H=function(){var t=e(this),o=t.data(i),n=o.opt,r=i+"_"+o.idx,l=e("#mCSB_"+o.idx+"_container"),s=l.parent();l.bind("focusin."+r,function(){var o=e(a.activeElement),i=l.find(".mCustomScrollBox").length,r=0;o.is(n.advanced.autoScrollOnFocus)&&(Q(t),clearTimeout(t[0]._focusTimeout),t[0]._focusTimer=i?(r+17)*i:0,t[0]._focusTimeout=setTimeout(function(){var e=[ot(o)[0],ot(o)[1]],a=[l[0].offsetTop,l[0].offsetLeft],i=[a[0]+e[0]>=0&&a[0]+e[0]<s.height()-o.outerHeight(!1),a[1]+e[1]>=0&&a[0]+e[1]<s.width()-o.outerWidth(!1)],c="yx"!==n.axis||i[0]||i[1]?"all":"none";"x"===n.axis||i[0]||G(t,e[0].toString(),{dir:"y",scrollEasing:"mcsEaseInOut",overwrite:c,dur:r}),"y"===n.axis||i[1]||G(t,e[1].toString(),{dir:"x",scrollEasing:"mcsEaseInOut",overwrite:c,dur:r})},t[0]._focusTimer))})},U=function(){var t=e(this),a=t.data(i),o=i+"_"+a.idx,n=e("#mCSB_"+a.idx+"_container").parent();n.bind("scroll."+o,function(){(0!==n.scrollTop()||0!==n.scrollLeft())&&e(".mCSB_"+a.idx+"_scrollbar").css("visibility","hidden")})},F=function(){var t=e(this),a=t.data(i),o=a.opt,n=a.sequential,r=i+"_"+a.idx,l=".mCSB_"+a.idx+"_scrollbar",s=e(l+">a");s.bind("mousedown."+r+" touchstart."+r+" pointerdown."+r+" MSPointerDown."+r+" mouseup."+r+" touchend."+r+" pointerup."+r+" MSPointerUp."+r+" mouseout."+r+" pointerout."+r+" MSPointerOut."+r+" click."+r,function(i){function r(e,a){n.scrollAmount=o.snapAmount||o.scrollButtons.scrollAmount,j(t,e,a)}if(i.preventDefault(),et(i)){var l=e(this).attr("class");switch(n.type=o.scrollButtons.scrollType,i.type){case"mousedown":case"touchstart":case"pointerdown":case"MSPointerDown":if("stepped"===n.type)return;u=!0,a.tweenRunning=!1,r("on",l);break;case"mouseup":case"touchend":case"pointerup":case"MSPointerUp":case"mouseout":case"pointerout":case"MSPointerOut":if("stepped"===n.type)return;u=!1,n.dir&&r("off",l);break;case"click":if("stepped"!==n.type||a.tweenRunning)return;r("on",l)}}})},q=function(){var t=e(this),o=t.data(i),n=o.opt,r=o.sequential,l=i+"_"+o.idx,s=e("#mCSB_"+o.idx),c=e("#mCSB_"+o.idx+"_container"),d=c.parent(),u="input,textarea,select,datalist,keygen,[contenteditable='true']";s.attr("tabindex","0").bind("blur."+l+" keydown."+l+" keyup."+l,function(i){function l(e,a){r.type=n.keyboard.scrollType,r.scrollAmount=n.snapAmount||n.keyboard.scrollAmount,"stepped"===r.type&&o.tweenRunning||j(t,e,a)}switch(i.type){case"blur":o.tweenRunning&&r.dir&&l("off",null);break;case"keydown":case"keyup":var s=i.keyCode?i.keyCode:i.which,f="on";if("x"!==n.axis&&(38===s||40===s)||"y"!==n.axis&&(37===s||39===s)){if((38===s||40===s)&&!o.overflowed[0]||(37===s||39===s)&&!o.overflowed[1])return;"keyup"===i.type&&(f="off"),e(a.activeElement).is(u)||(i.preventDefault(),i.stopImmediatePropagation(),l(f,s))}else if(33===s||34===s){if((o.overflowed[0]||o.overflowed[1])&&(i.preventDefault(),i.stopImmediatePropagation()),"keyup"===i.type){Q(t);var h=34===s?-1:1;if("x"===n.axis||"yx"===n.axis&&o.overflowed[1]&&!o.overflowed[0])var m="x",p=Math.abs(c[0].offsetLeft)-.9*h*d.width();else var m="y",p=Math.abs(c[0].offsetTop)-.9*h*d.height();G(t,p.toString(),{dir:m,scrollEasing:"mcsEaseInOut"})}}else if((35===s||36===s)&&!e(a.activeElement).is(u)&&((o.overflowed[0]||o.overflowed[1])&&(i.preventDefault(),i.stopImmediatePropagation()),"keyup"===i.type)){if("x"===n.axis||"yx"===n.axis&&o.overflowed[1]&&!o.overflowed[0])var m="x",p=35===s?Math.abs(d.width()-c.outerWidth(!1)):0;else var m="y",p=35===s?Math.abs(d.height()-c.outerHeight(!1)):0;G(t,p.toString(),{dir:m,scrollEasing:"mcsEaseInOut"})}}})},j=function(t,a,o,n,r){function l(e){var a="stepped"!==u.type,o=r?r:e?a?p/1.5:g:1e3/60,i=e?a?7.5:40:2.5,s=[Math.abs(h[0].offsetTop),Math.abs(h[0].offsetLeft)],d=[c.scrollRatio.y>10?10:c.scrollRatio.y,c.scrollRatio.x>10?10:c.scrollRatio.x],f="x"===u.dir[0]?s[1]+u.dir[1]*d[1]*i:s[0]+u.dir[1]*d[0]*i,m="x"===u.dir[0]?s[1]+u.dir[1]*parseInt(u.scrollAmount):s[0]+u.dir[1]*parseInt(u.scrollAmount),v="auto"!==u.scrollAmount?m:f,x=n?n:e?a?"mcsLinearOut":"mcsEaseInOut":"mcsLinear",_=e?!0:!1;return e&&17>o&&(v="x"===u.dir[0]?s[1]:s[0]),G(t,v.toString(),{dir:u.dir[0],scrollEasing:x,dur:o,onComplete:_}),e?void(u.dir=!1):(clearTimeout(u.step),void(u.step=setTimeout(function(){l()},o)))}function s(){clearTimeout(u.step),$(u,"step"),Q(t)}var c=t.data(i),d=c.opt,u=c.sequential,h=e("#mCSB_"+c.idx+"_container"),m="stepped"===u.type?!0:!1,p=d.scrollInertia<26?26:d.scrollInertia,g=d.scrollInertia<1?17:d.scrollInertia;switch(a){case"on":if(u.dir=[o===f[16]||o===f[15]||39===o||37===o?"x":"y",o===f[13]||o===f[15]||38===o||37===o?-1:1],Q(t),at(o)&&"stepped"===u.type)return;l(m);break;case"off":s(),(m||c.tweenRunning&&u.dir)&&l(!0)}},Y=function(t){var a=e(this).data(i).opt,o=[];return"function"==typeof t&&(t=t()),t instanceof Array?o=t.length>1?[t[0],t[1]]:"x"===a.axis?[null,t[0]]:[t[0],null]:(o[0]=t.y?t.y:t.x||"x"===a.axis?null:t,o[1]=t.x?t.x:t.y||"y"===a.axis?null:t),"function"==typeof o[0]&&(o[0]=o[0]()),"function"==typeof o[1]&&(o[1]=o[1]()),o},X=function(t,a){if(null!=t&&"undefined"!=typeof t){var o=e(this),n=o.data(i),r=n.opt,l=e("#mCSB_"+n.idx+"_container"),s=l.parent(),c=typeof t;a||(a="x"===r.axis?"x":"y");var d="x"===a?l.outerWidth(!1):l.outerHeight(!1),u="x"===a?l[0].offsetLeft:l[0].offsetTop,f="x"===a?"left":"top";switch(c){case"function":return t();case"object":var m=t.jquery?t:e(t);if(!m.length)return;return"x"===a?ot(m)[1]:ot(m)[0];case"string":case"number":if(at(t))return Math.abs(t);if(-1!==t.indexOf("%"))return Math.abs(d*parseInt(t)/100);if(-1!==t.indexOf("-="))return Math.abs(u-parseInt(t.split("-=")[1]));if(-1!==t.indexOf("+=")){var p=u+parseInt(t.split("+=")[1]);return p>=0?0:Math.abs(p)}if(-1!==t.indexOf("px")&&at(t.split("px")[0]))return Math.abs(t.split("px")[0]);if("top"===t||"left"===t)return 0;if("bottom"===t)return Math.abs(s.height()-l.outerHeight(!1));if("right"===t)return Math.abs(s.width()-l.outerWidth(!1));if("first"===t||"last"===t){var m=l.find(":"+t);return"x"===a?ot(m)[1]:ot(m)[0]}return e(t).length?"x"===a?ot(e(t))[1]:ot(e(t))[0]:(l.css(f,t),void h.update.call(null,o[0]))}}},N=function(t){function a(){clearTimeout(u[0].autoUpdate),u[0].autoUpdate=setTimeout(function(){return d.advanced.updateOnSelectorChange&&(m=r(),m!==S)?(l(3),void(S=m)):(d.advanced.updateOnContentResize&&(p=[u.outerHeight(!1),u.outerWidth(!1),v.height(),v.width(),_()[0],_()[1]],(p[0]!==w[0]||p[1]!==w[1]||p[2]!==w[2]||p[3]!==w[3]||p[4]!==w[4]||p[5]!==w[5])&&(l(p[0]!==w[0]||p[1]!==w[1]),w=p)),d.advanced.updateOnImageLoad&&(g=o(),g!==b&&(u.find("img").each(function(){n(this)}),b=g)),void((d.advanced.updateOnSelectorChange||d.advanced.updateOnContentResize||d.advanced.updateOnImageLoad)&&a()))},60)}function o(){var e=0;return d.advanced.updateOnImageLoad&&(e=u.find("img").length),e}function n(t){function a(e,t){return function(){return t.apply(e,arguments)}}function o(){this.onload=null,e(t).addClass(f[2]),l(2)}if(e(t).hasClass(f[2]))return void l();var n=new Image;n.onload=a(n,o),n.src=t.src}function r(){d.advanced.updateOnSelectorChange===!0&&(d.advanced.updateOnSelectorChange="*");var t=0,a=u.find(d.advanced.updateOnSelectorChange);return d.advanced.updateOnSelectorChange&&a.length>0&&a.each(function(){t+=e(this).height()+e(this).width()}),t}function l(e){clearTimeout(u[0].autoUpdate),h.update.call(null,s[0],e)}var s=e(this),c=s.data(i),d=c.opt,u=e("#mCSB_"+c.idx+"_container");if(t)return clearTimeout(u[0].autoUpdate),void $(u[0],"autoUpdate");var m,p,g,v=u.parent(),x=[e("#mCSB_"+c.idx+"_scrollbar_vertical"),e("#mCSB_"+c.idx+"_scrollbar_horizontal")],_=function(){return[x[0].is(":visible")?x[0].outerHeight(!0):0,x[1].is(":visible")?x[1].outerWidth(!0):0]},S=r(),w=[u.outerHeight(!1),u.outerWidth(!1),v.height(),v.width(),_()[0],_()[1]],b=o();a()},V=function(e,t,a){return Math.round(e/t)*t-a},Q=function(t){var a=t.data(i),o=e("#mCSB_"+a.idx+"_container,#mCSB_"+a.idx+"_container_wrapper,#mCSB_"+a.idx+"_dragger_vertical,#mCSB_"+a.idx+"_dragger_horizontal");o.each(function(){Z.call(this)})},G=function(t,a,o){function n(e){return s&&c.callbacks[e]&&"function"==typeof c.callbacks[e]}function r(){return[c.callbacks.alwaysTriggerOffsets||_>=S[0]+b,c.callbacks.alwaysTriggerOffsets||-C>=_]}function l(){var e=[h[0].offsetTop,h[0].offsetLeft],a=[v[0].offsetTop,v[0].offsetLeft],n=[h.outerHeight(!1),h.outerWidth(!1)],i=[f.height(),f.width()];t[0].mcs={content:h,top:e[0],left:e[1],draggerTop:a[0],draggerLeft:a[1],topPct:Math.round(100*Math.abs(e[0])/(Math.abs(n[0])-i[0])),leftPct:Math.round(100*Math.abs(e[1])/(Math.abs(n[1])-i[1])),direction:o.dir}}var s=t.data(i),c=s.opt,d={trigger:"internal",dir:"y",scrollEasing:"mcsEaseOut",drag:!1,dur:c.scrollInertia,overwrite:"all",callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},o=e.extend(d,o),u=[o.dur,o.drag?0:o.dur],f=e("#mCSB_"+s.idx),h=e("#mCSB_"+s.idx+"_container"),m=h.parent(),p=c.callbacks.onTotalScrollOffset?Y.call(t,c.callbacks.onTotalScrollOffset):[0,0],g=c.callbacks.onTotalScrollBackOffset?Y.call(t,c.callbacks.onTotalScrollBackOffset):[0,0];if(s.trigger=o.trigger,(0!==m.scrollTop()||0!==m.scrollLeft())&&(e(".mCSB_"+s.idx+"_scrollbar").css("visibility","visible"),m.scrollTop(0).scrollLeft(0)),"_resetY"!==a||s.contentReset.y||(n("onOverflowYNone")&&c.callbacks.onOverflowYNone.call(t[0]),s.contentReset.y=1),"_resetX"!==a||s.contentReset.x||(n("onOverflowXNone")&&c.callbacks.onOverflowXNone.call(t[0]),s.contentReset.x=1),"_resetY"!==a&&"_resetX"!==a){switch(!s.contentReset.y&&t[0].mcs||!s.overflowed[0]||(n("onOverflowY")&&c.callbacks.onOverflowY.call(t[0]),s.contentReset.x=null),!s.contentReset.x&&t[0].mcs||!s.overflowed[1]||(n("onOverflowX")&&c.callbacks.onOverflowX.call(t[0]),s.contentReset.x=null),c.snapAmount&&(a=V(a,c.snapAmount,c.snapOffset)),o.dir){case"x":var v=e("#mCSB_"+s.idx+"_dragger_horizontal"),x="left",_=h[0].offsetLeft,S=[f.width()-h.outerWidth(!1),v.parent().width()-v.width()],w=[a,0===a?0:a/s.scrollRatio.x],b=p[1],C=g[1],y=b>0?b/s.scrollRatio.x:0,B=C>0?C/s.scrollRatio.x:0;
break;case"y":var v=e("#mCSB_"+s.idx+"_dragger_vertical"),x="top",_=h[0].offsetTop,S=[f.height()-h.outerHeight(!1),v.parent().height()-v.height()],w=[a,0===a?0:a/s.scrollRatio.y],b=p[0],C=g[0],y=b>0?b/s.scrollRatio.y:0,B=C>0?C/s.scrollRatio.y:0}w[1]<0||0===w[0]&&0===w[1]?w=[0,0]:w[1]>=S[1]?w=[S[0],S[1]]:w[0]=-w[0],t[0].mcs||(l(),n("onInit")&&c.callbacks.onInit.call(t[0])),clearTimeout(h[0].onCompleteTimeout),(s.tweenRunning||!(0===_&&w[0]>=0||_===S[0]&&w[0]<=S[0]))&&(J(v[0],x,Math.round(w[1]),u[1],o.scrollEasing),J(h[0],x,Math.round(w[0]),u[0],o.scrollEasing,o.overwrite,{onStart:function(){o.callbacks&&o.onStart&&!s.tweenRunning&&(n("onScrollStart")&&(l(),c.callbacks.onScrollStart.call(t[0])),s.tweenRunning=!0,T(v),s.cbOffsets=r())},onUpdate:function(){o.callbacks&&o.onUpdate&&n("whileScrolling")&&(l(),c.callbacks.whileScrolling.call(t[0]))},onComplete:function(){if(o.callbacks&&o.onComplete){"yx"===c.axis&&clearTimeout(h[0].onCompleteTimeout);var e=h[0].idleTimer||0;h[0].onCompleteTimeout=setTimeout(function(){n("onScroll")&&(l(),c.callbacks.onScroll.call(t[0])),n("onTotalScroll")&&w[1]>=S[1]-y&&s.cbOffsets[0]&&(l(),c.callbacks.onTotalScroll.call(t[0])),n("onTotalScrollBack")&&w[1]<=B&&s.cbOffsets[1]&&(l(),c.callbacks.onTotalScrollBack.call(t[0])),s.tweenRunning=!1,h[0].idleTimer=0,T(v,"hide")},e)}}}))}},J=function(e,a,o,n,i,r,l){function s(){b.stop||(_||p.call(),_=K()-x,c(),_>=b.time&&(b.time=_>b.time?_+h-(_-b.time):_+h-1,b.time<_+1&&(b.time=_+1)),b.time<n?b.id=m(s):v.call())}function c(){n>0?(b.currVal=f(b.time,S,C,n,i),w[a]=Math.round(b.currVal)+"px"):w[a]=o+"px",g.call()}function d(){h=1e3/60,b.time=_+h,m=t.requestAnimationFrame?t.requestAnimationFrame:function(e){return c(),setTimeout(e,.01)},b.id=m(s)}function u(){null!=b.id&&(t.requestAnimationFrame?t.cancelAnimationFrame(b.id):clearTimeout(b.id),b.id=null)}function f(e,t,a,o,n){switch(n){case"linear":case"mcsLinear":return a*e/o+t;case"mcsLinearOut":return e/=o,e--,a*Math.sqrt(1-e*e)+t;case"easeInOutSmooth":return e/=o/2,1>e?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t);case"easeInOutStrong":return e/=o/2,1>e?a/2*Math.pow(2,10*(e-1))+t:(e--,a/2*(-Math.pow(2,-10*e)+2)+t);case"easeInOut":case"mcsEaseInOut":return e/=o/2,1>e?a/2*e*e*e+t:(e-=2,a/2*(e*e*e+2)+t);case"easeOutSmooth":return e/=o,e--,-a*(e*e*e*e-1)+t;case"easeOutStrong":return a*(-Math.pow(2,-10*e/o)+1)+t;case"easeOut":case"mcsEaseOut":default:var i=(e/=o)*e,r=i*e;return t+a*(.499999999999997*r*i+-2.5*i*i+5.5*r+-6.5*i+4*e)}}e._mTween||(e._mTween={top:{},left:{}});var h,m,l=l||{},p=l.onStart||function(){},g=l.onUpdate||function(){},v=l.onComplete||function(){},x=K(),_=0,S=e.offsetTop,w=e.style,b=e._mTween[a];"left"===a&&(S=e.offsetLeft);var C=o-S;b.stop=0,"none"!==r&&u(),d()},K=function(){return t.performance&&t.performance.now?t.performance.now():t.performance&&t.performance.webkitNow?t.performance.webkitNow():Date.now?Date.now():(new Date).getTime()},Z=function(){var e=this;e._mTween||(e._mTween={top:{},left:{}});for(var a=["top","left"],o=0;o<a.length;o++){var n=a[o];e._mTween[n].id&&(t.requestAnimationFrame?t.cancelAnimationFrame(e._mTween[n].id):clearTimeout(e._mTween[n].id),e._mTween[n].id=null,e._mTween[n].stop=1)}},$=function(e,t){try{delete e[t]}catch(a){e[t]=null}},et=function(e){return!(e.which&&1!==e.which)},tt=function(e){var t=e.originalEvent.pointerType;return!(t&&"touch"!==t&&2!==t)},at=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},ot=function(e){var t=e.parents(".mCSB_container");return[e.offset().top-t.offset().top,e.offset().left-t.offset().left]};e.fn[n]=function(t){return h[t]?h[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist"):h.init.apply(this,arguments)},e[n]=function(t){return h[t]?h[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist"):h.init.apply(this,arguments)},e[n].defaults=l,t[n]=!0,e(t).load(function(){e(r)[n](),e.extend(e.expr[":"],{mcsInView:e.expr[":"].mcsInView||function(t){var a,o,n=e(t),i=n.parents(".mCSB_container");if(i.length)return a=i.parent(),o=[i[0].offsetTop,i[0].offsetLeft],o[0]+ot(n)[0]>=0&&o[0]+ot(n)[0]<a.height()-n.outerHeight(!1)&&o[1]+ot(n)[1]>=0&&o[1]+ot(n)[1]<a.width()-n.outerWidth(!1)},mcsOverflow:e.expr[":"].mcsOverflow||function(t){var a=e(t).data(i);if(a)return a.overflowed[0]||a.overflowed[1]}})})})}(jQuery,window,document);
/*
 AngularJS v1.3.9
 (c) 2010-2014 Google, Inc. http://angularjs.org
 License: MIT
*/
(function(M,Y,t){'use strict';function T(b){return function(){var a=arguments[0],c;c="["+(b?b+":":"")+a+"] http://errors.angularjs.org/1.3.9/"+(b?b+"/":"")+a;for(a=1;a<arguments.length;a++){c=c+(1==a?"?":"&")+"p"+(a-1)+"=";var d=encodeURIComponent,e;e=arguments[a];e="function"==typeof e?e.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof e?"undefined":"string"!=typeof e?JSON.stringify(e):e;c+=d(e)}return Error(c)}}function Ta(b){if(null==b||Ua(b))return!1;var a=b.length;return b.nodeType===
oa&&a?!0:F(b)||D(b)||0===a||"number"===typeof a&&0<a&&a-1 in b}function s(b,a,c){var d,e;if(b)if(G(b))for(d in b)"prototype"==d||"length"==d||"name"==d||b.hasOwnProperty&&!b.hasOwnProperty(d)||a.call(c,b[d],d,b);else if(D(b)||Ta(b)){var f="object"!==typeof b;d=0;for(e=b.length;d<e;d++)(f||d in b)&&a.call(c,b[d],d,b)}else if(b.forEach&&b.forEach!==s)b.forEach(a,c,b);else for(d in b)b.hasOwnProperty(d)&&a.call(c,b[d],d,b);return b}function Ed(b,a,c){for(var d=Object.keys(b).sort(),e=0;e<d.length;e++)a.call(c,
b[d[e]],d[e]);return d}function kc(b){return function(a,c){b(c,a)}}function Fd(){return++nb}function lc(b,a){a?b.$$hashKey=a:delete b.$$hashKey}function z(b){for(var a=b.$$hashKey,c=1,d=arguments.length;c<d;c++){var e=arguments[c];if(e)for(var f=Object.keys(e),g=0,h=f.length;g<h;g++){var l=f[g];b[l]=e[l]}}lc(b,a);return b}function ba(b){return parseInt(b,10)}function H(){}function pa(b){return b}function da(b){return function(){return b}}function A(b){return"undefined"===typeof b}function y(b){return"undefined"!==
typeof b}function I(b){return null!==b&&"object"===typeof b}function F(b){return"string"===typeof b}function V(b){return"number"===typeof b}function qa(b){return"[object Date]"===Da.call(b)}function G(b){return"function"===typeof b}function ob(b){return"[object RegExp]"===Da.call(b)}function Ua(b){return b&&b.window===b}function Va(b){return b&&b.$evalAsync&&b.$watch}function Wa(b){return"boolean"===typeof b}function mc(b){return!(!b||!(b.nodeName||b.prop&&b.attr&&b.find))}function Gd(b){var a={};
b=b.split(",");var c;for(c=0;c<b.length;c++)a[b[c]]=!0;return a}function ua(b){return Q(b.nodeName||b[0]&&b[0].nodeName)}function Xa(b,a){var c=b.indexOf(a);0<=c&&b.splice(c,1);return a}function Ea(b,a,c,d){if(Ua(b)||Va(b))throw Ka("cpws");if(a){if(b===a)throw Ka("cpi");c=c||[];d=d||[];if(I(b)){var e=c.indexOf(b);if(-1!==e)return d[e];c.push(b);d.push(a)}if(D(b))for(var f=a.length=0;f<b.length;f++)e=Ea(b[f],null,c,d),I(b[f])&&(c.push(b[f]),d.push(e)),a.push(e);else{var g=a.$$hashKey;D(a)?a.length=
0:s(a,function(b,c){delete a[c]});for(f in b)b.hasOwnProperty(f)&&(e=Ea(b[f],null,c,d),I(b[f])&&(c.push(b[f]),d.push(e)),a[f]=e);lc(a,g)}}else if(a=b)D(b)?a=Ea(b,[],c,d):qa(b)?a=new Date(b.getTime()):ob(b)?(a=new RegExp(b.source,b.toString().match(/[^\/]*$/)[0]),a.lastIndex=b.lastIndex):I(b)&&(e=Object.create(Object.getPrototypeOf(b)),a=Ea(b,e,c,d));return a}function ra(b,a){if(D(b)){a=a||[];for(var c=0,d=b.length;c<d;c++)a[c]=b[c]}else if(I(b))for(c in a=a||{},b)if("$"!==c.charAt(0)||"$"!==c.charAt(1))a[c]=
b[c];return a||b}function fa(b,a){if(b===a)return!0;if(null===b||null===a)return!1;if(b!==b&&a!==a)return!0;var c=typeof b,d;if(c==typeof a&&"object"==c)if(D(b)){if(!D(a))return!1;if((c=b.length)==a.length){for(d=0;d<c;d++)if(!fa(b[d],a[d]))return!1;return!0}}else{if(qa(b))return qa(a)?fa(b.getTime(),a.getTime()):!1;if(ob(b)&&ob(a))return b.toString()==a.toString();if(Va(b)||Va(a)||Ua(b)||Ua(a)||D(a))return!1;c={};for(d in b)if("$"!==d.charAt(0)&&!G(b[d])){if(!fa(b[d],a[d]))return!1;c[d]=!0}for(d in a)if(!c.hasOwnProperty(d)&&
"$"!==d.charAt(0)&&a[d]!==t&&!G(a[d]))return!1;return!0}return!1}function Ya(b,a,c){return b.concat(Za.call(a,c))}function nc(b,a){var c=2<arguments.length?Za.call(arguments,2):[];return!G(a)||a instanceof RegExp?a:c.length?function(){return arguments.length?a.apply(b,Ya(c,arguments,0)):a.apply(b,c)}:function(){return arguments.length?a.apply(b,arguments):a.call(b)}}function Hd(b,a){var c=a;"string"===typeof b&&"$"===b.charAt(0)&&"$"===b.charAt(1)?c=t:Ua(a)?c="$WINDOW":a&&Y===a?c="$DOCUMENT":Va(a)&&
(c="$SCOPE");return c}function $a(b,a){if("undefined"===typeof b)return t;V(a)||(a=a?2:null);return JSON.stringify(b,Hd,a)}function oc(b){return F(b)?JSON.parse(b):b}function va(b){b=B(b).clone();try{b.empty()}catch(a){}var c=B("<div>").append(b).html();try{return b[0].nodeType===pb?Q(c):c.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(a,b){return"<"+Q(b)})}catch(d){return Q(c)}}function pc(b){try{return decodeURIComponent(b)}catch(a){}}function qc(b){var a={},c,d;s((b||"").split("&"),function(b){b&&
(c=b.replace(/\+/g,"%20").split("="),d=pc(c[0]),y(d)&&(b=y(c[1])?pc(c[1]):!0,rc.call(a,d)?D(a[d])?a[d].push(b):a[d]=[a[d],b]:a[d]=b))});return a}function Nb(b){var a=[];s(b,function(b,d){D(b)?s(b,function(b){a.push(Fa(d,!0)+(!0===b?"":"="+Fa(b,!0)))}):a.push(Fa(d,!0)+(!0===b?"":"="+Fa(b,!0)))});return a.length?a.join("&"):""}function qb(b){return Fa(b,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function Fa(b,a){return encodeURIComponent(b).replace(/%40/gi,"@").replace(/%3A/gi,
":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,a?"%20":"+")}function Id(b,a){var c,d,e=rb.length;b=B(b);for(d=0;d<e;++d)if(c=rb[d]+a,F(c=b.attr(c)))return c;return null}function Jd(b,a){var c,d,e={};s(rb,function(a){a+="app";!c&&b.hasAttribute&&b.hasAttribute(a)&&(c=b,d=b.getAttribute(a))});s(rb,function(a){a+="app";var e;!c&&(e=b.querySelector("["+a.replace(":","\\:")+"]"))&&(c=e,d=e.getAttribute(a))});c&&(e.strictDi=null!==Id(c,"strict-di"),a(c,d?[d]:[],e))}function sc(b,
a,c){I(c)||(c={});c=z({strictDi:!1},c);var d=function(){b=B(b);if(b.injector()){var d=b[0]===Y?"document":va(b);throw Ka("btstrpd",d.replace(/</,"&lt;").replace(/>/,"&gt;"));}a=a||[];a.unshift(["$provide",function(a){a.value("$rootElement",b)}]);c.debugInfoEnabled&&a.push(["$compileProvider",function(a){a.debugInfoEnabled(!0)}]);a.unshift("ng");d=Ob(a,c.strictDi);d.invoke(["$rootScope","$rootElement","$compile","$injector",function(a,b,c,d){a.$apply(function(){b.data("$injector",d);c(b)(a)})}]);return d},
e=/^NG_ENABLE_DEBUG_INFO!/,f=/^NG_DEFER_BOOTSTRAP!/;M&&e.test(M.name)&&(c.debugInfoEnabled=!0,M.name=M.name.replace(e,""));if(M&&!f.test(M.name))return d();M.name=M.name.replace(f,"");ga.resumeBootstrap=function(b){s(b,function(b){a.push(b)});d()}}function Kd(){M.name="NG_ENABLE_DEBUG_INFO!"+M.name;M.location.reload()}function Ld(b){b=ga.element(b).injector();if(!b)throw Ka("test");return b.get("$$testability")}function tc(b,a){a=a||"_";return b.replace(Md,function(b,d){return(d?a:"")+b.toLowerCase()})}
function Nd(){var b;uc||((sa=M.jQuery)&&sa.fn.on?(B=sa,z(sa.fn,{scope:La.scope,isolateScope:La.isolateScope,controller:La.controller,injector:La.injector,inheritedData:La.inheritedData}),b=sa.cleanData,sa.cleanData=function(a){var c;if(Pb)Pb=!1;else for(var d=0,e;null!=(e=a[d]);d++)(c=sa._data(e,"events"))&&c.$destroy&&sa(e).triggerHandler("$destroy");b(a)}):B=R,ga.element=B,uc=!0)}function Qb(b,a,c){if(!b)throw Ka("areq",a||"?",c||"required");return b}function sb(b,a,c){c&&D(b)&&(b=b[b.length-1]);
Qb(G(b),a,"not a function, got "+(b&&"object"===typeof b?b.constructor.name||"Object":typeof b));return b}function Ma(b,a){if("hasOwnProperty"===b)throw Ka("badname",a);}function vc(b,a,c){if(!a)return b;a=a.split(".");for(var d,e=b,f=a.length,g=0;g<f;g++)d=a[g],b&&(b=(e=b)[d]);return!c&&G(b)?nc(e,b):b}function tb(b){var a=b[0];b=b[b.length-1];var c=[a];do{a=a.nextSibling;if(!a)break;c.push(a)}while(a!==b);return B(c)}function ha(){return Object.create(null)}function Od(b){function a(a,b,c){return a[b]||
(a[b]=c())}var c=T("$injector"),d=T("ng");b=a(b,"angular",Object);b.$$minErr=b.$$minErr||T;return a(b,"module",function(){var b={};return function(f,g,h){if("hasOwnProperty"===f)throw d("badname","module");g&&b.hasOwnProperty(f)&&(b[f]=null);return a(b,f,function(){function a(c,d,e,f){f||(f=b);return function(){f[e||"push"]([c,d,arguments]);return u}}if(!g)throw c("nomod",f);var b=[],d=[],e=[],q=a("$injector","invoke","push",d),u={_invokeQueue:b,_configBlocks:d,_runBlocks:e,requires:g,name:f,provider:a("$provide",
"provider"),factory:a("$provide","factory"),service:a("$provide","service"),value:a("$provide","value"),constant:a("$provide","constant","unshift"),animation:a("$animateProvider","register"),filter:a("$filterProvider","register"),controller:a("$controllerProvider","register"),directive:a("$compileProvider","directive"),config:q,run:function(a){e.push(a);return this}};h&&q(h);return u})}})}function Pd(b){z(b,{bootstrap:sc,copy:Ea,extend:z,equals:fa,element:B,forEach:s,injector:Ob,noop:H,bind:nc,toJson:$a,
fromJson:oc,identity:pa,isUndefined:A,isDefined:y,isString:F,isFunction:G,isObject:I,isNumber:V,isElement:mc,isArray:D,version:Qd,isDate:qa,lowercase:Q,uppercase:ub,callbacks:{counter:0},getTestability:Ld,$$minErr:T,$$csp:ab,reloadWithDebugInfo:Kd});bb=Od(M);try{bb("ngLocale")}catch(a){bb("ngLocale",[]).provider("$locale",Rd)}bb("ng",["ngLocale"],["$provide",function(a){a.provider({$$sanitizeUri:Sd});a.provider("$compile",wc).directive({a:Td,input:xc,textarea:xc,form:Ud,script:Vd,select:Wd,style:Xd,
option:Yd,ngBind:Zd,ngBindHtml:$d,ngBindTemplate:ae,ngClass:be,ngClassEven:ce,ngClassOdd:de,ngCloak:ee,ngController:fe,ngForm:ge,ngHide:he,ngIf:ie,ngInclude:je,ngInit:ke,ngNonBindable:le,ngPluralize:me,ngRepeat:ne,ngShow:oe,ngStyle:pe,ngSwitch:qe,ngSwitchWhen:re,ngSwitchDefault:se,ngOptions:te,ngTransclude:ue,ngModel:ve,ngList:we,ngChange:xe,pattern:yc,ngPattern:yc,required:zc,ngRequired:zc,minlength:Ac,ngMinlength:Ac,maxlength:Bc,ngMaxlength:Bc,ngValue:ye,ngModelOptions:ze}).directive({ngInclude:Ae}).directive(vb).directive(Cc);
a.provider({$anchorScroll:Be,$animate:Ce,$browser:De,$cacheFactory:Ee,$controller:Fe,$document:Ge,$exceptionHandler:He,$filter:Dc,$interpolate:Ie,$interval:Je,$http:Ke,$httpBackend:Le,$location:Me,$log:Ne,$parse:Oe,$rootScope:Pe,$q:Qe,$$q:Re,$sce:Se,$sceDelegate:Te,$sniffer:Ue,$templateCache:Ve,$templateRequest:We,$$testability:Xe,$timeout:Ye,$window:Ze,$$rAF:$e,$$asyncCallback:af,$$jqLite:bf})}])}function cb(b){return b.replace(cf,function(a,b,d,e){return e?d.toUpperCase():d}).replace(df,"Moz$1")}
function Ec(b){b=b.nodeType;return b===oa||!b||9===b}function Fc(b,a){var c,d,e=a.createDocumentFragment(),f=[];if(Rb.test(b)){c=c||e.appendChild(a.createElement("div"));d=(ef.exec(b)||["",""])[1].toLowerCase();d=ia[d]||ia._default;c.innerHTML=d[1]+b.replace(ff,"<$1></$2>")+d[2];for(d=d[0];d--;)c=c.lastChild;f=Ya(f,c.childNodes);c=e.firstChild;c.textContent=""}else f.push(a.createTextNode(b));e.textContent="";e.innerHTML="";s(f,function(a){e.appendChild(a)});return e}function R(b){if(b instanceof
R)return b;var a;F(b)&&(b=U(b),a=!0);if(!(this instanceof R)){if(a&&"<"!=b.charAt(0))throw Sb("nosel");return new R(b)}if(a){a=Y;var c;b=(c=gf.exec(b))?[a.createElement(c[1])]:(c=Fc(b,a))?c.childNodes:[]}Gc(this,b)}function Tb(b){return b.cloneNode(!0)}function wb(b,a){a||xb(b);if(b.querySelectorAll)for(var c=b.querySelectorAll("*"),d=0,e=c.length;d<e;d++)xb(c[d])}function Hc(b,a,c,d){if(y(d))throw Sb("offargs");var e=(d=yb(b))&&d.events,f=d&&d.handle;if(f)if(a)s(a.split(" "),function(a){if(y(c)){var d=
e[a];Xa(d||[],c);if(d&&0<d.length)return}b.removeEventListener(a,f,!1);delete e[a]});else for(a in e)"$destroy"!==a&&b.removeEventListener(a,f,!1),delete e[a]}function xb(b,a){var c=b.ng339,d=c&&zb[c];d&&(a?delete d.data[a]:(d.handle&&(d.events.$destroy&&d.handle({},"$destroy"),Hc(b)),delete zb[c],b.ng339=t))}function yb(b,a){var c=b.ng339,c=c&&zb[c];a&&!c&&(b.ng339=c=++hf,c=zb[c]={events:{},data:{},handle:t});return c}function Ub(b,a,c){if(Ec(b)){var d=y(c),e=!d&&a&&!I(a),f=!a;b=(b=yb(b,!e))&&b.data;
if(d)b[a]=c;else{if(f)return b;if(e)return b&&b[a];z(b,a)}}}function Ab(b,a){return b.getAttribute?-1<(" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+a+" "):!1}function Bb(b,a){a&&b.setAttribute&&s(a.split(" "),function(a){b.setAttribute("class",U((" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+U(a)+" "," ")))})}function Cb(b,a){if(a&&b.setAttribute){var c=(" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");s(a.split(" "),function(a){a=
U(a);-1===c.indexOf(" "+a+" ")&&(c+=a+" ")});b.setAttribute("class",U(c))}}function Gc(b,a){if(a)if(a.nodeType)b[b.length++]=a;else{var c=a.length;if("number"===typeof c&&a.window!==a){if(c)for(var d=0;d<c;d++)b[b.length++]=a[d]}else b[b.length++]=a}}function Ic(b,a){return Db(b,"$"+(a||"ngController")+"Controller")}function Db(b,a,c){9==b.nodeType&&(b=b.documentElement);for(a=D(a)?a:[a];b;){for(var d=0,e=a.length;d<e;d++)if((c=B.data(b,a[d]))!==t)return c;b=b.parentNode||11===b.nodeType&&b.host}}
function Jc(b){for(wb(b,!0);b.firstChild;)b.removeChild(b.firstChild)}function Kc(b,a){a||wb(b);var c=b.parentNode;c&&c.removeChild(b)}function jf(b,a){a=a||M;if("complete"===a.document.readyState)a.setTimeout(b);else B(a).on("load",b)}function Lc(b,a){var c=Eb[a.toLowerCase()];return c&&Mc[ua(b)]&&c}function kf(b,a){var c=b.nodeName;return("INPUT"===c||"TEXTAREA"===c)&&Nc[a]}function lf(b,a){var c=function(c,e){c.isDefaultPrevented=function(){return c.defaultPrevented};var f=a[e||c.type],g=f?f.length:
0;if(g){if(A(c.immediatePropagationStopped)){var h=c.stopImmediatePropagation;c.stopImmediatePropagation=function(){c.immediatePropagationStopped=!0;c.stopPropagation&&c.stopPropagation();h&&h.call(c)}}c.isImmediatePropagationStopped=function(){return!0===c.immediatePropagationStopped};1<g&&(f=ra(f));for(var l=0;l<g;l++)c.isImmediatePropagationStopped()||f[l].call(b,c)}};c.elem=b;return c}function bf(){this.$get=function(){return z(R,{hasClass:function(b,a){b.attr&&(b=b[0]);return Ab(b,a)},addClass:function(b,
a){b.attr&&(b=b[0]);return Cb(b,a)},removeClass:function(b,a){b.attr&&(b=b[0]);return Bb(b,a)}})}}function Na(b,a){var c=b&&b.$$hashKey;if(c)return"function"===typeof c&&(c=b.$$hashKey()),c;c=typeof b;return c="function"==c||"object"==c&&null!==b?b.$$hashKey=c+":"+(a||Fd)():c+":"+b}function db(b,a){if(a){var c=0;this.nextUid=function(){return++c}}s(b,this.put,this)}function mf(b){return(b=b.toString().replace(Oc,"").match(Pc))?"function("+(b[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}function Vb(b,
a,c){var d;if("function"===typeof b){if(!(d=b.$inject)){d=[];if(b.length){if(a)throw F(c)&&c||(c=b.name||mf(b)),Ga("strictdi",c);a=b.toString().replace(Oc,"");a=a.match(Pc);s(a[1].split(nf),function(a){a.replace(of,function(a,b,c){d.push(c)})})}b.$inject=d}}else D(b)?(a=b.length-1,sb(b[a],"fn"),d=b.slice(0,a)):sb(b,"fn",!0);return d}function Ob(b,a){function c(a){return function(b,c){if(I(b))s(b,kc(a));else return a(b,c)}}function d(a,b){Ma(a,"service");if(G(b)||D(b))b=q.instantiate(b);if(!b.$get)throw Ga("pget",
a);return p[a+"Provider"]=b}function e(a,b){return function(){var c=r.invoke(b,this);if(A(c))throw Ga("undef",a);return c}}function f(a,b,c){return d(a,{$get:!1!==c?e(a,b):b})}function g(a){var b=[],c;s(a,function(a){function d(a){var b,c;b=0;for(c=a.length;b<c;b++){var e=a[b],f=q.get(e[0]);f[e[1]].apply(f,e[2])}}if(!m.get(a)){m.put(a,!0);try{F(a)?(c=bb(a),b=b.concat(g(c.requires)).concat(c._runBlocks),d(c._invokeQueue),d(c._configBlocks)):G(a)?b.push(q.invoke(a)):D(a)?b.push(q.invoke(a)):sb(a,"module")}catch(e){throw D(a)&&
(a=a[a.length-1]),e.message&&e.stack&&-1==e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),Ga("modulerr",a,e.stack||e.message||e);}}});return b}function h(b,c){function d(a,e){if(b.hasOwnProperty(a)){if(b[a]===l)throw Ga("cdep",a+" <- "+k.join(" <- "));return b[a]}try{return k.unshift(a),b[a]=l,b[a]=c(a,e)}catch(f){throw b[a]===l&&delete b[a],f;}finally{k.shift()}}function e(b,c,f,g){"string"===typeof f&&(g=f,f=null);var h=[],k=Vb(b,a,g),l,q,p;q=0;for(l=k.length;q<l;q++){p=k[q];if("string"!==
typeof p)throw Ga("itkn",p);h.push(f&&f.hasOwnProperty(p)?f[p]:d(p,g))}D(b)&&(b=b[l]);return b.apply(c,h)}return{invoke:e,instantiate:function(a,b,c){var d=Object.create((D(a)?a[a.length-1]:a).prototype);a=e(a,d,b,c);return I(a)||G(a)?a:d},get:d,annotate:Vb,has:function(a){return p.hasOwnProperty(a+"Provider")||b.hasOwnProperty(a)}}}a=!0===a;var l={},k=[],m=new db([],!0),p={$provide:{provider:c(d),factory:c(f),service:c(function(a,b){return f(a,["$injector",function(a){return a.instantiate(b)}])}),
value:c(function(a,b){return f(a,da(b),!1)}),constant:c(function(a,b){Ma(a,"constant");p[a]=b;u[a]=b}),decorator:function(a,b){var c=q.get(a+"Provider"),d=c.$get;c.$get=function(){var a=r.invoke(d,c);return r.invoke(b,null,{$delegate:a})}}}},q=p.$injector=h(p,function(a,b){ga.isString(b)&&k.push(b);throw Ga("unpr",k.join(" <- "));}),u={},r=u.$injector=h(u,function(a,b){var c=q.get(a+"Provider",b);return r.invoke(c.$get,c,t,a)});s(g(b),function(a){r.invoke(a||H)});return r}function Be(){var b=!0;this.disableAutoScrolling=
function(){b=!1};this.$get=["$window","$location","$rootScope",function(a,c,d){function e(a){var b=null;Array.prototype.some.call(a,function(a){if("a"===ua(a))return b=a,!0});return b}function f(b){if(b){b.scrollIntoView();var c;c=g.yOffset;G(c)?c=c():mc(c)?(c=c[0],c="fixed"!==a.getComputedStyle(c).position?0:c.getBoundingClientRect().bottom):V(c)||(c=0);c&&(b=b.getBoundingClientRect().top,a.scrollBy(0,b-c))}else a.scrollTo(0,0)}function g(){var a=c.hash(),b;a?(b=h.getElementById(a))?f(b):(b=e(h.getElementsByName(a)))?
f(b):"top"===a&&f(null):f(null)}var h=a.document;b&&d.$watch(function(){return c.hash()},function(a,b){a===b&&""===a||jf(function(){d.$evalAsync(g)})});return g}]}function af(){this.$get=["$$rAF","$timeout",function(b,a){return b.supported?function(a){return b(a)}:function(b){return a(b,0,!1)}}]}function pf(b,a,c,d){function e(a){try{a.apply(null,Za.call(arguments,1))}finally{if(v--,0===v)for(;w.length;)try{w.pop()()}catch(b){c.error(b)}}}function f(a,b){(function N(){s(L,function(a){a()});C=b(N,
a)})()}function g(){h();l()}function h(){x=b.history.state;x=A(x)?null:x;fa(x,J)&&(x=J);J=x}function l(){if(E!==m.url()||P!==x)E=m.url(),P=x,s(W,function(a){a(m.url(),x)})}function k(a){try{return decodeURIComponent(a)}catch(b){return a}}var m=this,p=a[0],q=b.location,u=b.history,r=b.setTimeout,O=b.clearTimeout,n={};m.isMock=!1;var v=0,w=[];m.$$completeOutstandingRequest=e;m.$$incOutstandingRequestCount=function(){v++};m.notifyWhenNoOutstandingRequests=function(a){s(L,function(a){a()});0===v?a():
w.push(a)};var L=[],C;m.addPollFn=function(a){A(C)&&f(100,r);L.push(a);return a};var x,P,E=q.href,S=a.find("base"),X=null;h();P=x;m.url=function(a,c,e){A(e)&&(e=null);q!==b.location&&(q=b.location);u!==b.history&&(u=b.history);if(a){var f=P===e;if(E===a&&(!d.history||f))return m;var g=E&&Ha(E)===Ha(a);E=a;P=e;!d.history||g&&f?(g||(X=a),c?q.replace(a):g?(c=q,e=a.indexOf("#"),a=-1===e?"":a.substr(e+1),c.hash=a):q.href=a):(u[c?"replaceState":"pushState"](e,"",a),h(),P=x);return m}return X||q.href.replace(/%27/g,
"'")};m.state=function(){return x};var W=[],wa=!1,J=null;m.onUrlChange=function(a){if(!wa){if(d.history)B(b).on("popstate",g);B(b).on("hashchange",g);wa=!0}W.push(a);return a};m.$$checkUrlChange=l;m.baseHref=function(){var a=S.attr("href");return a?a.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var ea={},y="",ca=m.baseHref();m.cookies=function(a,b){var d,e,f,g;if(a)b===t?p.cookie=encodeURIComponent(a)+"=;path="+ca+";expires=Thu, 01 Jan 1970 00:00:00 GMT":F(b)&&(d=(p.cookie=encodeURIComponent(a)+"="+encodeURIComponent(b)+
";path="+ca).length+1,4096<d&&c.warn("Cookie '"+a+"' possibly not set or overflowed because it was too large ("+d+" > 4096 bytes)!"));else{if(p.cookie!==y)for(y=p.cookie,d=y.split("; "),ea={},f=0;f<d.length;f++)e=d[f],g=e.indexOf("="),0<g&&(a=k(e.substring(0,g)),ea[a]===t&&(ea[a]=k(e.substring(g+1))));return ea}};m.defer=function(a,b){var c;v++;c=r(function(){delete n[c];e(a)},b||0);n[c]=!0;return c};m.defer.cancel=function(a){return n[a]?(delete n[a],O(a),e(H),!0):!1}}function De(){this.$get=["$window",
"$log","$sniffer","$document",function(b,a,c,d){return new pf(b,d,a,c)}]}function Ee(){this.$get=function(){function b(b,d){function e(a){a!=p&&(q?q==a&&(q=a.n):q=a,f(a.n,a.p),f(a,p),p=a,p.n=null)}function f(a,b){a!=b&&(a&&(a.p=b),b&&(b.n=a))}if(b in a)throw T("$cacheFactory")("iid",b);var g=0,h=z({},d,{id:b}),l={},k=d&&d.capacity||Number.MAX_VALUE,m={},p=null,q=null;return a[b]={put:function(a,b){if(k<Number.MAX_VALUE){var c=m[a]||(m[a]={key:a});e(c)}if(!A(b))return a in l||g++,l[a]=b,g>k&&this.remove(q.key),
b},get:function(a){if(k<Number.MAX_VALUE){var b=m[a];if(!b)return;e(b)}return l[a]},remove:function(a){if(k<Number.MAX_VALUE){var b=m[a];if(!b)return;b==p&&(p=b.p);b==q&&(q=b.n);f(b.n,b.p);delete m[a]}delete l[a];g--},removeAll:function(){l={};g=0;m={};p=q=null},destroy:function(){m=h=l=null;delete a[b]},info:function(){return z({},h,{size:g})}}}var a={};b.info=function(){var b={};s(a,function(a,e){b[e]=a.info()});return b};b.get=function(b){return a[b]};return b}}function Ve(){this.$get=["$cacheFactory",
function(b){return b("templates")}]}function wc(b,a){function c(a,b){var c=/^\s*([@&]|=(\*?))(\??)\s*(\w*)\s*$/,d={};s(a,function(a,e){var f=a.match(c);if(!f)throw ja("iscp",b,e,a);d[e]={mode:f[1][0],collection:"*"===f[2],optional:"?"===f[3],attrName:f[4]||e}});return d}var d={},e=/^\s*directive\:\s*([\w\-]+)\s+(.*)$/,f=/(([\w\-]+)(?:\:([^;]+))?;?)/,g=Gd("ngSrc,ngSrcset,src,srcset"),h=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,l=/^(on[a-z]+|formaction)$/;this.directive=function p(a,e){Ma(a,"directive");F(a)?(Qb(e,
"directiveFactory"),d.hasOwnProperty(a)||(d[a]=[],b.factory(a+"Directive",["$injector","$exceptionHandler",function(b,e){var f=[];s(d[a],function(d,g){try{var h=b.invoke(d);G(h)?h={compile:da(h)}:!h.compile&&h.link&&(h.compile=da(h.link));h.priority=h.priority||0;h.index=g;h.name=h.name||a;h.require=h.require||h.controller&&h.name;h.restrict=h.restrict||"EA";I(h.scope)&&(h.$$isolateBindings=c(h.scope,h.name));f.push(h)}catch(l){e(l)}});return f}])),d[a].push(e)):s(a,kc(p));return this};this.aHrefSanitizationWhitelist=
function(b){return y(b)?(a.aHrefSanitizationWhitelist(b),this):a.aHrefSanitizationWhitelist()};this.imgSrcSanitizationWhitelist=function(b){return y(b)?(a.imgSrcSanitizationWhitelist(b),this):a.imgSrcSanitizationWhitelist()};var k=!0;this.debugInfoEnabled=function(a){return y(a)?(k=a,this):k};this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function(a,b,c,r,O,n,v,w,L,C,x){function P(a,b){try{a.addClass(b)}catch(c){}}
function E(a,b,c,d,e){a instanceof B||(a=B(a));s(a,function(b,c){b.nodeType==pb&&b.nodeValue.match(/\S+/)&&(a[c]=B(b).wrap("<span></span>").parent()[0])});var f=S(a,b,a,c,d,e);E.$$addScopeClass(a);var g=null;return function(b,c,d){Qb(b,"scope");d=d||{};var e=d.parentBoundTranscludeFn,h=d.transcludeControllers;d=d.futureParentElement;e&&e.$$boundTransclude&&(e=e.$$boundTransclude);g||(g=(d=d&&d[0])?"foreignobject"!==ua(d)&&d.toString().match(/SVG/)?"svg":"html":"html");d="html"!==g?B(Wb(g,B("<div>").append(a).html())):
c?La.clone.call(a):a;if(h)for(var l in h)d.data("$"+l+"Controller",h[l].instance);E.$$addScopeInfo(d,b);c&&c(d,b);f&&f(b,d,d,e);return d}}function S(a,b,c,d,e,f){function g(a,c,d,e){var f,l,k,q,p,n,w;if(r)for(w=Array(c.length),q=0;q<h.length;q+=3)f=h[q],w[f]=c[f];else w=c;q=0;for(p=h.length;q<p;)l=w[h[q++]],c=h[q++],f=h[q++],c?(c.scope?(k=a.$new(),E.$$addScopeInfo(B(l),k)):k=a,n=c.transcludeOnThisElement?X(a,c.transclude,e,c.elementTranscludeOnThisElement):!c.templateOnThisElement&&e?e:!e&&b?X(a,
b):null,c(f,k,l,d,n)):f&&f(a,l.childNodes,t,e)}for(var h=[],l,k,q,p,r,n=0;n<a.length;n++){l=new Xb;k=W(a[n],[],l,0===n?d:t,e);(f=k.length?ea(k,a[n],l,b,c,null,[],[],f):null)&&f.scope&&E.$$addScopeClass(l.$$element);l=f&&f.terminal||!(q=a[n].childNodes)||!q.length?null:S(q,f?(f.transcludeOnThisElement||!f.templateOnThisElement)&&f.transclude:b);if(f||l)h.push(n,f,l),p=!0,r=r||f;f=null}return p?g:null}function X(a,b,c,d){return function(d,e,f,g,h){d||(d=a.$new(!1,h),d.$$transcluded=!0);return b(d,e,
{parentBoundTranscludeFn:c,transcludeControllers:f,futureParentElement:g})}}function W(a,b,c,d,g){var h=c.$attr,l;switch(a.nodeType){case oa:ca(b,ya(ua(a)),"E",d,g);for(var k,q,p,r=a.attributes,n=0,w=r&&r.length;n<w;n++){var O=!1,L=!1;k=r[n];l=k.name;q=U(k.value);k=ya(l);if(p=fb.test(k))l=l.replace(Rc,"").substr(8).replace(/_(.)/g,function(a,b){return b.toUpperCase()});var u=k.replace(/(Start|End)$/,"");A(u)&&k===u+"Start"&&(O=l,L=l.substr(0,l.length-5)+"end",l=l.substr(0,l.length-6));k=ya(l.toLowerCase());
h[k]=l;if(p||!c.hasOwnProperty(k))c[k]=q,Lc(a,k)&&(c[k]=!0);Pa(a,b,q,k,p);ca(b,k,"A",d,g,O,L)}a=a.className;if(F(a)&&""!==a)for(;l=f.exec(a);)k=ya(l[2]),ca(b,k,"C",d,g)&&(c[k]=U(l[3])),a=a.substr(l.index+l[0].length);break;case pb:M(b,a.nodeValue);break;case 8:try{if(l=e.exec(a.nodeValue))k=ya(l[1]),ca(b,k,"M",d,g)&&(c[k]=U(l[2]))}catch(v){}}b.sort(N);return b}function wa(a,b,c){var d=[],e=0;if(b&&a.hasAttribute&&a.hasAttribute(b)){do{if(!a)throw ja("uterdir",b,c);a.nodeType==oa&&(a.hasAttribute(b)&&
e++,a.hasAttribute(c)&&e--);d.push(a);a=a.nextSibling}while(0<e)}else d.push(a);return B(d)}function J(a,b,c){return function(d,e,f,g,h){e=wa(e[0],b,c);return a(d,e,f,g,h)}}function ea(a,d,e,f,g,l,k,p,r){function w(a,b,c,d){if(a){c&&(a=J(a,c,d));a.require=K.require;a.directiveName=z;if(S===K||K.$$isolateScope)a=Z(a,{isolateScope:!0});k.push(a)}if(b){c&&(b=J(b,c,d));b.require=K.require;b.directiveName=z;if(S===K||K.$$isolateScope)b=Z(b,{isolateScope:!0});p.push(b)}}function L(a,b,c,d){var e,f="data",
g=!1,l=c,k;if(F(b)){k=b.match(h);b=b.substring(k[0].length);k[3]&&(k[1]?k[3]=null:k[1]=k[3]);"^"===k[1]?f="inheritedData":"^^"===k[1]&&(f="inheritedData",l=c.parent());"?"===k[2]&&(g=!0);e=null;d&&"data"===f&&(e=d[b])&&(e=e.instance);e=e||l[f]("$"+b+"Controller");if(!e&&!g)throw ja("ctreq",b,a);return e||null}D(b)&&(e=[],s(b,function(b){e.push(L(a,b,c,d))}));return e}function v(a,c,f,g,h){function l(a,b,c){var d;Va(a)||(c=b,b=a,a=t);H&&(d=P);c||(c=H?W.parent():W);return h(a,b,d,c,wa)}var r,w,u,x,
P,eb,W,J;d===f?(J=e,W=e.$$element):(W=B(f),J=new Xb(W,e));S&&(x=c.$new(!0));h&&(eb=l,eb.$$boundTransclude=h);C&&(X={},P={},s(C,function(a){var b={$scope:a===S||a.$$isolateScope?x:c,$element:W,$attrs:J,$transclude:eb};u=a.controller;"@"==u&&(u=J[a.name]);b=n(u,b,!0,a.controllerAs);P[a.name]=b;H||W.data("$"+a.name+"Controller",b.instance);X[a.name]=b}));if(S){E.$$addScopeInfo(W,x,!0,!(ka&&(ka===S||ka===S.$$originalDirective)));E.$$addScopeClass(W,!0);g=X&&X[S.name];var xa=x;g&&g.identifier&&!0===S.bindToController&&
(xa=g.instance);s(x.$$isolateBindings=S.$$isolateBindings,function(a,d){var e=a.attrName,f=a.optional,g,h,l,k;switch(a.mode){case "@":J.$observe(e,function(a){xa[d]=a});J.$$observers[e].$$scope=c;J[e]&&(xa[d]=b(J[e])(c));break;case "=":if(f&&!J[e])break;h=O(J[e]);k=h.literal?fa:function(a,b){return a===b||a!==a&&b!==b};l=h.assign||function(){g=xa[d]=h(c);throw ja("nonassign",J[e],S.name);};g=xa[d]=h(c);f=function(a){k(a,xa[d])||(k(a,g)?l(c,a=xa[d]):xa[d]=a);return g=a};f.$stateful=!0;f=a.collection?
c.$watchCollection(J[e],f):c.$watch(O(J[e],f),null,h.literal);x.$on("$destroy",f);break;case "&":h=O(J[e]),xa[d]=function(a){return h(c,a)}}})}X&&(s(X,function(a){a()}),X=null);g=0;for(r=k.length;g<r;g++)w=k[g],$(w,w.isolateScope?x:c,W,J,w.require&&L(w.directiveName,w.require,W,P),eb);var wa=c;S&&(S.template||null===S.templateUrl)&&(wa=x);a&&a(wa,f.childNodes,t,h);for(g=p.length-1;0<=g;g--)w=p[g],$(w,w.isolateScope?x:c,W,J,w.require&&L(w.directiveName,w.require,W,P),eb)}r=r||{};for(var x=-Number.MAX_VALUE,
P,C=r.controllerDirectives,X,S=r.newIsolateScopeDirective,ka=r.templateDirective,ea=r.nonTlbTranscludeDirective,ca=!1,A=!1,H=r.hasElementTranscludeDirective,aa=e.$$element=B(d),K,z,N,Aa=f,Q,M=0,R=a.length;M<R;M++){K=a[M];var Pa=K.$$start,fb=K.$$end;Pa&&(aa=wa(d,Pa,fb));N=t;if(x>K.priority)break;if(N=K.scope)K.templateUrl||(I(N)?(Oa("new/isolated scope",S||P,K,aa),S=K):Oa("new/isolated scope",S,K,aa)),P=P||K;z=K.name;!K.templateUrl&&K.controller&&(N=K.controller,C=C||{},Oa("'"+z+"' controller",C[z],
K,aa),C[z]=K);if(N=K.transclude)ca=!0,K.$$tlb||(Oa("transclusion",ea,K,aa),ea=K),"element"==N?(H=!0,x=K.priority,N=aa,aa=e.$$element=B(Y.createComment(" "+z+": "+e[z]+" ")),d=aa[0],V(g,Za.call(N,0),d),Aa=E(N,f,x,l&&l.name,{nonTlbTranscludeDirective:ea})):(N=B(Tb(d)).contents(),aa.empty(),Aa=E(N,f));if(K.template)if(A=!0,Oa("template",ka,K,aa),ka=K,N=G(K.template)?K.template(aa,e):K.template,N=Sc(N),K.replace){l=K;N=Rb.test(N)?Tc(Wb(K.templateNamespace,U(N))):[];d=N[0];if(1!=N.length||d.nodeType!==
oa)throw ja("tplrt",z,"");V(g,aa,d);R={$attr:{}};N=W(d,[],R);var ba=a.splice(M+1,a.length-(M+1));S&&y(N);a=a.concat(N).concat(ba);Qc(e,R);R=a.length}else aa.html(N);if(K.templateUrl)A=!0,Oa("template",ka,K,aa),ka=K,K.replace&&(l=K),v=T(a.splice(M,a.length-M),aa,e,g,ca&&Aa,k,p,{controllerDirectives:C,newIsolateScopeDirective:S,templateDirective:ka,nonTlbTranscludeDirective:ea}),R=a.length;else if(K.compile)try{Q=K.compile(aa,e,Aa),G(Q)?w(null,Q,Pa,fb):Q&&w(Q.pre,Q.post,Pa,fb)}catch(qf){c(qf,va(aa))}K.terminal&&
(v.terminal=!0,x=Math.max(x,K.priority))}v.scope=P&&!0===P.scope;v.transcludeOnThisElement=ca;v.elementTranscludeOnThisElement=H;v.templateOnThisElement=A;v.transclude=Aa;r.hasElementTranscludeDirective=H;return v}function y(a){for(var b=0,c=a.length;b<c;b++){var d=b,e;e=z(Object.create(a[b]),{$$isolateScope:!0});a[d]=e}}function ca(b,e,f,g,h,l,k){if(e===h)return null;h=null;if(d.hasOwnProperty(e)){var q;e=a.get(e+"Directive");for(var r=0,n=e.length;r<n;r++)try{if(q=e[r],(g===t||g>q.priority)&&-1!=
q.restrict.indexOf(f)){if(l){var w={$$start:l,$$end:k};q=z(Object.create(q),w)}b.push(q);h=q}}catch(O){c(O)}}return h}function A(b){if(d.hasOwnProperty(b))for(var c=a.get(b+"Directive"),e=0,f=c.length;e<f;e++)if(b=c[e],b.multiElement)return!0;return!1}function Qc(a,b){var c=b.$attr,d=a.$attr,e=a.$$element;s(a,function(d,e){"$"!=e.charAt(0)&&(b[e]&&b[e]!==d&&(d+=("style"===e?";":" ")+b[e]),a.$set(e,d,!0,c[e]))});s(b,function(b,f){"class"==f?(P(e,b),a["class"]=(a["class"]?a["class"]+" ":"")+b):"style"==
f?(e.attr("style",e.attr("style")+";"+b),a.style=(a.style?a.style+";":"")+b):"$"==f.charAt(0)||a.hasOwnProperty(f)||(a[f]=b,d[f]=c[f])})}function T(a,b,c,d,e,f,g,h){var l=[],k,q,p=b[0],n=a.shift(),w=z({},n,{templateUrl:null,transclude:null,replace:null,$$originalDirective:n}),O=G(n.templateUrl)?n.templateUrl(b,c):n.templateUrl,u=n.templateNamespace;b.empty();r(L.getTrustedResourceUrl(O)).then(function(r){var L,v;r=Sc(r);if(n.replace){r=Rb.test(r)?Tc(Wb(u,U(r))):[];L=r[0];if(1!=r.length||L.nodeType!==
oa)throw ja("tplrt",n.name,O);r={$attr:{}};V(d,b,L);var x=W(L,[],r);I(n.scope)&&y(x);a=x.concat(a);Qc(c,r)}else L=p,b.html(r);a.unshift(w);k=ea(a,L,c,e,b,n,f,g,h);s(d,function(a,c){a==L&&(d[c]=b[0])});for(q=S(b[0].childNodes,e);l.length;){r=l.shift();v=l.shift();var C=l.shift(),E=l.shift(),x=b[0];if(!r.$$destroyed){if(v!==p){var J=v.className;h.hasElementTranscludeDirective&&n.replace||(x=Tb(L));V(C,B(v),x);P(B(x),J)}v=k.transcludeOnThisElement?X(r,k.transclude,E):E;k(q,r,x,d,v)}}l=null});return function(a,
b,c,d,e){a=e;b.$$destroyed||(l?l.push(b,c,d,a):(k.transcludeOnThisElement&&(a=X(b,k.transclude,e)),k(q,b,c,d,a)))}}function N(a,b){var c=b.priority-a.priority;return 0!==c?c:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function Oa(a,b,c,d){if(b)throw ja("multidir",b.name,c.name,a,va(d));}function M(a,c){var d=b(c,!0);d&&a.push({priority:0,compile:function(a){a=a.parent();var b=!!a.length;b&&E.$$addBindingClass(a);return function(a,c){var e=c.parent();b||E.$$addBindingClass(e);E.$$addBindingInfo(e,
d.expressions);a.$watch(d,function(a){c[0].nodeValue=a})}}})}function Wb(a,b){a=Q(a||"html");switch(a){case "svg":case "math":var c=Y.createElement("div");c.innerHTML="<"+a+">"+b+"</"+a+">";return c.childNodes[0].childNodes;default:return b}}function R(a,b){if("srcdoc"==b)return L.HTML;var c=ua(a);if("xlinkHref"==b||"form"==c&&"action"==b||"img"!=c&&("src"==b||"ngSrc"==b))return L.RESOURCE_URL}function Pa(a,c,d,e,f){var h=R(a,e);f=g[e]||f;var k=b(d,!0,h,f);if(k){if("multiple"===e&&"select"===ua(a))throw ja("selmulti",
va(a));c.push({priority:100,compile:function(){return{pre:function(a,c,g){c=g.$$observers||(g.$$observers={});if(l.test(e))throw ja("nodomevents");var p=g[e];p!==d&&(k=p&&b(p,!0,h,f),d=p);k&&(g[e]=k(a),(c[e]||(c[e]=[])).$$inter=!0,(g.$$observers&&g.$$observers[e].$$scope||a).$watch(k,function(a,b){"class"===e&&a!=b?g.$updateClass(a,b):g.$set(e,a)}))}}}})}}function V(a,b,c){var d=b[0],e=b.length,f=d.parentNode,g,h;if(a)for(g=0,h=a.length;g<h;g++)if(a[g]==d){a[g++]=c;h=g+e-1;for(var l=a.length;g<l;g++,
h++)h<l?a[g]=a[h]:delete a[g];a.length-=e-1;a.context===d&&(a.context=c);break}f&&f.replaceChild(c,d);a=Y.createDocumentFragment();a.appendChild(d);B(c).data(B(d).data());sa?(Pb=!0,sa.cleanData([d])):delete B.cache[d[B.expando]];d=1;for(e=b.length;d<e;d++)f=b[d],B(f).remove(),a.appendChild(f),delete b[d];b[0]=c;b.length=1}function Z(a,b){return z(function(){return a.apply(null,arguments)},a,b)}function $(a,b,d,e,f,g){try{a(b,d,e,f,g)}catch(h){c(h,va(d))}}var Xb=function(a,b){if(b){var c=Object.keys(b),
d,e,f;d=0;for(e=c.length;d<e;d++)f=c[d],this[f]=b[f]}else this.$attr={};this.$$element=a};Xb.prototype={$normalize:ya,$addClass:function(a){a&&0<a.length&&C.addClass(this.$$element,a)},$removeClass:function(a){a&&0<a.length&&C.removeClass(this.$$element,a)},$updateClass:function(a,b){var c=Uc(a,b);c&&c.length&&C.addClass(this.$$element,c);(c=Uc(b,a))&&c.length&&C.removeClass(this.$$element,c)},$set:function(a,b,d,e){var f=this.$$element[0],g=Lc(f,a),h=kf(f,a),f=a;g?(this.$$element.prop(a,b),e=g):
h&&(this[h]=b,f=h);this[a]=b;e?this.$attr[a]=e:(e=this.$attr[a])||(this.$attr[a]=e=tc(a,"-"));g=ua(this.$$element);if("a"===g&&"href"===a||"img"===g&&"src"===a)this[a]=b=x(b,"src"===a);else if("img"===g&&"srcset"===a){for(var g="",h=U(b),l=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,l=/\s/.test(h)?l:/(,)/,h=h.split(l),l=Math.floor(h.length/2),k=0;k<l;k++)var q=2*k,g=g+x(U(h[q]),!0),g=g+(" "+U(h[q+1]));h=U(h[2*k]).split(/\s/);g+=x(U(h[0]),!0);2===h.length&&(g+=" "+U(h[1]));this[a]=b=g}!1!==d&&(null===b||
b===t?this.$$element.removeAttr(e):this.$$element.attr(e,b));(a=this.$$observers)&&s(a[f],function(a){try{a(b)}catch(d){c(d)}})},$observe:function(a,b){var c=this,d=c.$$observers||(c.$$observers=ha()),e=d[a]||(d[a]=[]);e.push(b);v.$evalAsync(function(){!e.$$inter&&c.hasOwnProperty(a)&&b(c[a])});return function(){Xa(e,b)}}};var Aa=b.startSymbol(),ka=b.endSymbol(),Sc="{{"==Aa||"}}"==ka?pa:function(a){return a.replace(/\{\{/g,Aa).replace(/}}/g,ka)},fb=/^ngAttr[A-Z]/;E.$$addBindingInfo=k?function(a,b){var c=
a.data("$binding")||[];D(b)?c=c.concat(b):c.push(b);a.data("$binding",c)}:H;E.$$addBindingClass=k?function(a){P(a,"ng-binding")}:H;E.$$addScopeInfo=k?function(a,b,c,d){a.data(c?d?"$isolateScopeNoTemplate":"$isolateScope":"$scope",b)}:H;E.$$addScopeClass=k?function(a,b){P(a,b?"ng-isolate-scope":"ng-scope")}:H;return E}]}function ya(b){return cb(b.replace(Rc,""))}function Uc(b,a){var c="",d=b.split(/\s+/),e=a.split(/\s+/),f=0;a:for(;f<d.length;f++){for(var g=d[f],h=0;h<e.length;h++)if(g==e[h])continue a;
c+=(0<c.length?" ":"")+g}return c}function Tc(b){b=B(b);var a=b.length;if(1>=a)return b;for(;a--;)8===b[a].nodeType&&rf.call(b,a,1);return b}function Fe(){var b={},a=!1,c=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(a,c){Ma(a,"controller");I(a)?z(b,a):b[a]=c};this.allowGlobals=function(){a=!0};this.$get=["$injector","$window",function(d,e){function f(a,b,c,d){if(!a||!I(a.$scope))throw T("$controller")("noscp",d,b);a.$scope[b]=c}return function(g,h,l,k){var m,p,q;l=!0===l;k&&F(k)&&(q=k);F(g)&&
(k=g.match(c),p=k[1],q=q||k[3],g=b.hasOwnProperty(p)?b[p]:vc(h.$scope,p,!0)||(a?vc(e,p,!0):t),sb(g,p,!0));if(l)return l=(D(g)?g[g.length-1]:g).prototype,m=Object.create(l),q&&f(h,q,m,p||g.name),z(function(){d.invoke(g,m,h,p);return m},{instance:m,identifier:q});m=d.instantiate(g,h,p);q&&f(h,q,m,p||g.name);return m}}]}function Ge(){this.$get=["$window",function(b){return B(b.document)}]}function He(){this.$get=["$log",function(b){return function(a,c){b.error.apply(b,arguments)}}]}function Yb(b,a){if(F(b)){var c=
b.replace(sf,"").trim();if(c){var d=a("Content-Type");(d=d&&0===d.indexOf(Vc))||(d=(d=c.match(tf))&&uf[d[0]].test(c));d&&(b=oc(c))}}return b}function Wc(b){var a=ha(),c,d,e;if(!b)return a;s(b.split("\n"),function(b){e=b.indexOf(":");c=Q(U(b.substr(0,e)));d=U(b.substr(e+1));c&&(a[c]=a[c]?a[c]+", "+d:d)});return a}function Xc(b){var a=I(b)?b:t;return function(c){a||(a=Wc(b));return c?(c=a[Q(c)],void 0===c&&(c=null),c):a}}function Yc(b,a,c,d){if(G(d))return d(b,a,c);s(d,function(d){b=d(b,a,c)});return b}
function Ke(){var b=this.defaults={transformResponse:[Yb],transformRequest:[function(a){return I(a)&&"[object File]"!==Da.call(a)&&"[object Blob]"!==Da.call(a)&&"[object FormData]"!==Da.call(a)?$a(a):a}],headers:{common:{Accept:"application/json, text/plain, */*"},post:ra(Zb),put:ra(Zb),patch:ra(Zb)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},a=!1;this.useApplyAsync=function(b){return y(b)?(a=!!b,this):a};var c=this.interceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory",
"$rootScope","$q","$injector",function(d,e,f,g,h,l){function k(a){function c(a){var b=z({},a);b.data=a.data?Yc(a.data,a.headers,a.status,e.transformResponse):a.data;a=a.status;return 200<=a&&300>a?b:h.reject(b)}function d(a){var b,c={};s(a,function(a,d){G(a)?(b=a(),null!=b&&(c[d]=b)):c[d]=a});return c}if(!ga.isObject(a))throw T("$http")("badreq",a);var e=z({method:"get",transformRequest:b.transformRequest,transformResponse:b.transformResponse},a);e.headers=function(a){var c=b.headers,e=z({},a.headers),
f,g,c=z({},c.common,c[Q(a.method)]);a:for(f in c){a=Q(f);for(g in e)if(Q(g)===a)continue a;e[f]=c[f]}return d(e)}(a);e.method=ub(e.method);var f=[function(a){var d=a.headers,e=Yc(a.data,Xc(d),t,a.transformRequest);A(e)&&s(d,function(a,b){"content-type"===Q(b)&&delete d[b]});A(a.withCredentials)&&!A(b.withCredentials)&&(a.withCredentials=b.withCredentials);return m(a,e).then(c,c)},t],g=h.when(e);for(s(u,function(a){(a.request||a.requestError)&&f.unshift(a.request,a.requestError);(a.response||a.responseError)&&
f.push(a.response,a.responseError)});f.length;){a=f.shift();var l=f.shift(),g=g.then(a,l)}g.success=function(a){g.then(function(b){a(b.data,b.status,b.headers,e)});return g};g.error=function(a){g.then(null,function(b){a(b.data,b.status,b.headers,e)});return g};return g}function m(c,f){function l(b,c,d,e){function f(){m(c,b,d,e)}P&&(200<=b&&300>b?P.put(X,[b,c,Wc(d),e]):P.remove(X));a?g.$applyAsync(f):(f(),g.$$phase||g.$apply())}function m(a,b,d,e){b=Math.max(b,0);(200<=b&&300>b?C.resolve:C.reject)({data:a,
status:b,headers:Xc(d),config:c,statusText:e})}function w(a){m(a.data,a.status,ra(a.headers()),a.statusText)}function u(){var a=k.pendingRequests.indexOf(c);-1!==a&&k.pendingRequests.splice(a,1)}var C=h.defer(),x=C.promise,P,E,s=c.headers,X=p(c.url,c.params);k.pendingRequests.push(c);x.then(u,u);!c.cache&&!b.cache||!1===c.cache||"GET"!==c.method&&"JSONP"!==c.method||(P=I(c.cache)?c.cache:I(b.cache)?b.cache:q);P&&(E=P.get(X),y(E)?E&&G(E.then)?E.then(w,w):D(E)?m(E[1],E[0],ra(E[2]),E[3]):m(E,200,{},
"OK"):P.put(X,x));A(E)&&((E=Zc(c.url)?e.cookies()[c.xsrfCookieName||b.xsrfCookieName]:t)&&(s[c.xsrfHeaderName||b.xsrfHeaderName]=E),d(c.method,X,f,l,s,c.timeout,c.withCredentials,c.responseType));return x}function p(a,b){if(!b)return a;var c=[];Ed(b,function(a,b){null===a||A(a)||(D(a)||(a=[a]),s(a,function(a){I(a)&&(a=qa(a)?a.toISOString():$a(a));c.push(Fa(b)+"="+Fa(a))}))});0<c.length&&(a+=(-1==a.indexOf("?")?"?":"&")+c.join("&"));return a}var q=f("$http"),u=[];s(c,function(a){u.unshift(F(a)?l.get(a):
l.invoke(a))});k.pendingRequests=[];(function(a){s(arguments,function(a){k[a]=function(b,c){return k(z(c||{},{method:a,url:b}))}})})("get","delete","head","jsonp");(function(a){s(arguments,function(a){k[a]=function(b,c,d){return k(z(d||{},{method:a,url:b,data:c}))}})})("post","put","patch");k.defaults=b;return k}]}function vf(){return new M.XMLHttpRequest}function Le(){this.$get=["$browser","$window","$document",function(b,a,c){return wf(b,vf,b.defer,a.angular.callbacks,c[0])}]}function wf(b,a,c,
d,e){function f(a,b,c){var f=e.createElement("script"),m=null;f.type="text/javascript";f.src=a;f.async=!0;m=function(a){f.removeEventListener("load",m,!1);f.removeEventListener("error",m,!1);e.body.removeChild(f);f=null;var g=-1,u="unknown";a&&("load"!==a.type||d[b].called||(a={type:"error"}),u=a.type,g="error"===a.type?404:200);c&&c(g,u)};f.addEventListener("load",m,!1);f.addEventListener("error",m,!1);e.body.appendChild(f);return m}return function(e,h,l,k,m,p,q,u){function r(){v&&v();w&&w.abort()}
function O(a,d,e,f,g){C!==t&&c.cancel(C);v=w=null;a(d,e,f,g);b.$$completeOutstandingRequest(H)}b.$$incOutstandingRequestCount();h=h||b.url();if("jsonp"==Q(e)){var n="_"+(d.counter++).toString(36);d[n]=function(a){d[n].data=a;d[n].called=!0};var v=f(h.replace("JSON_CALLBACK","angular.callbacks."+n),n,function(a,b){O(k,a,d[n].data,"",b);d[n]=H})}else{var w=a();w.open(e,h,!0);s(m,function(a,b){y(a)&&w.setRequestHeader(b,a)});w.onload=function(){var a=w.statusText||"",b="response"in w?w.response:w.responseText,
c=1223===w.status?204:w.status;0===c&&(c=b?200:"file"==Ba(h).protocol?404:0);O(k,c,b,w.getAllResponseHeaders(),a)};e=function(){O(k,-1,null,null,"")};w.onerror=e;w.onabort=e;q&&(w.withCredentials=!0);if(u)try{w.responseType=u}catch(L){if("json"!==u)throw L;}w.send(l||null)}if(0<p)var C=c(r,p);else p&&G(p.then)&&p.then(r)}}function Ie(){var b="{{",a="}}";this.startSymbol=function(a){return a?(b=a,this):b};this.endSymbol=function(b){return b?(a=b,this):a};this.$get=["$parse","$exceptionHandler","$sce",
function(c,d,e){function f(a){return"\\\\\\"+a}function g(f,g,u,r){function O(c){return c.replace(k,b).replace(m,a)}function n(a){try{var b=a;a=u?e.getTrusted(u,b):e.valueOf(b);var c;if(r&&!y(a))c=a;else if(null==a)c="";else{switch(typeof a){case "string":break;case "number":a=""+a;break;default:a=$a(a)}c=a}return c}catch(g){c=$b("interr",f,g.toString()),d(c)}}r=!!r;for(var v,w,L=0,C=[],x=[],P=f.length,E=[],s=[];L<P;)if(-1!=(v=f.indexOf(b,L))&&-1!=(w=f.indexOf(a,v+h)))L!==v&&E.push(O(f.substring(L,
v))),L=f.substring(v+h,w),C.push(L),x.push(c(L,n)),L=w+l,s.push(E.length),E.push("");else{L!==P&&E.push(O(f.substring(L)));break}if(u&&1<E.length)throw $b("noconcat",f);if(!g||C.length){var X=function(a){for(var b=0,c=C.length;b<c;b++){if(r&&A(a[b]))return;E[s[b]]=a[b]}return E.join("")};return z(function(a){var b=0,c=C.length,e=Array(c);try{for(;b<c;b++)e[b]=x[b](a);return X(e)}catch(g){a=$b("interr",f,g.toString()),d(a)}},{exp:f,expressions:C,$$watchDelegate:function(a,b,c){var d;return a.$watchGroup(x,
function(c,e){var f=X(c);G(b)&&b.call(this,f,c!==e?d:f,a);d=f},c)}})}}var h=b.length,l=a.length,k=new RegExp(b.replace(/./g,f),"g"),m=new RegExp(a.replace(/./g,f),"g");g.startSymbol=function(){return b};g.endSymbol=function(){return a};return g}]}function Je(){this.$get=["$rootScope","$window","$q","$$q",function(b,a,c,d){function e(e,h,l,k){var m=a.setInterval,p=a.clearInterval,q=0,u=y(k)&&!k,r=(u?d:c).defer(),O=r.promise;l=y(l)?l:0;O.then(null,null,e);O.$$intervalId=m(function(){r.notify(q++);0<
l&&q>=l&&(r.resolve(q),p(O.$$intervalId),delete f[O.$$intervalId]);u||b.$apply()},h);f[O.$$intervalId]=r;return O}var f={};e.cancel=function(b){return b&&b.$$intervalId in f?(f[b.$$intervalId].reject("canceled"),a.clearInterval(b.$$intervalId),delete f[b.$$intervalId],!0):!1};return e}]}function Rd(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,
maxFrac:2,posPre:"\u00a4",posSuf:"",negPre:"(\u00a4",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January February March April May June July August September October November December".split(" "),SHORTMONTH:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),DAY:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),SHORTDAY:"Sun Mon Tue Wed Thu Fri Sat".split(" "),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a","short":"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",
longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(b){return 1===b?"one":"other"}}}}function ac(b){b=b.split("/");for(var a=b.length;a--;)b[a]=qb(b[a]);return b.join("/")}function $c(b,a){var c=Ba(b);a.$$protocol=c.protocol;a.$$host=c.hostname;a.$$port=ba(c.port)||xf[c.protocol]||null}function ad(b,a){var c="/"!==b.charAt(0);c&&(b="/"+b);var d=Ba(b);a.$$path=decodeURIComponent(c&&"/"===d.pathname.charAt(0)?d.pathname.substring(1):
d.pathname);a.$$search=qc(d.search);a.$$hash=decodeURIComponent(d.hash);a.$$path&&"/"!=a.$$path.charAt(0)&&(a.$$path="/"+a.$$path)}function za(b,a){if(0===a.indexOf(b))return a.substr(b.length)}function Ha(b){var a=b.indexOf("#");return-1==a?b:b.substr(0,a)}function bd(b){return b.replace(/(#.+)|#$/,"$1")}function bc(b){return b.substr(0,Ha(b).lastIndexOf("/")+1)}function cc(b,a){this.$$html5=!0;a=a||"";var c=bc(b);$c(b,this);this.$$parse=function(a){var b=za(c,a);if(!F(b))throw Fb("ipthprfx",a,c);
ad(b,this);this.$$path||(this.$$path="/");this.$$compose()};this.$$compose=function(){var a=Nb(this.$$search),b=this.$$hash?"#"+qb(this.$$hash):"";this.$$url=ac(this.$$path)+(a?"?"+a:"")+b;this.$$absUrl=c+this.$$url.substr(1)};this.$$parseLinkUrl=function(d,e){if(e&&"#"===e[0])return this.hash(e.slice(1)),!0;var f,g;(f=za(b,d))!==t?(g=f,g=(f=za(a,f))!==t?c+(za("/",f)||f):b+g):(f=za(c,d))!==t?g=c+f:c==d+"/"&&(g=c);g&&this.$$parse(g);return!!g}}function dc(b,a){var c=bc(b);$c(b,this);this.$$parse=function(d){d=
za(b,d)||za(c,d);var e;"#"===d.charAt(0)?(e=za(a,d),A(e)&&(e=d)):e=this.$$html5?d:"";ad(e,this);d=this.$$path;var f=/^\/[A-Z]:(\/.*)/;0===e.indexOf(b)&&(e=e.replace(b,""));f.exec(e)||(d=(e=f.exec(d))?e[1]:d);this.$$path=d;this.$$compose()};this.$$compose=function(){var c=Nb(this.$$search),e=this.$$hash?"#"+qb(this.$$hash):"";this.$$url=ac(this.$$path)+(c?"?"+c:"")+e;this.$$absUrl=b+(this.$$url?a+this.$$url:"")};this.$$parseLinkUrl=function(a,c){return Ha(b)==Ha(a)?(this.$$parse(a),!0):!1}}function cd(b,
a){this.$$html5=!0;dc.apply(this,arguments);var c=bc(b);this.$$parseLinkUrl=function(d,e){if(e&&"#"===e[0])return this.hash(e.slice(1)),!0;var f,g;b==Ha(d)?f=d:(g=za(c,d))?f=b+a+g:c===d+"/"&&(f=c);f&&this.$$parse(f);return!!f};this.$$compose=function(){var c=Nb(this.$$search),e=this.$$hash?"#"+qb(this.$$hash):"";this.$$url=ac(this.$$path)+(c?"?"+c:"")+e;this.$$absUrl=b+a+this.$$url}}function Gb(b){return function(){return this[b]}}function dd(b,a){return function(c){if(A(c))return this[b];this[b]=
a(c);this.$$compose();return this}}function Me(){var b="",a={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(a){return y(a)?(b=a,this):b};this.html5Mode=function(b){return Wa(b)?(a.enabled=b,this):I(b)?(Wa(b.enabled)&&(a.enabled=b.enabled),Wa(b.requireBase)&&(a.requireBase=b.requireBase),Wa(b.rewriteLinks)&&(a.rewriteLinks=b.rewriteLinks),this):a};this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function(c,d,e,f,g){function h(a,b,c){var e=k.url(),f=k.$$state;
try{d.url(a,b,c),k.$$state=d.state()}catch(g){throw k.url(e),k.$$state=f,g;}}function l(a,b){c.$broadcast("$locationChangeSuccess",k.absUrl(),a,k.$$state,b)}var k,m;m=d.baseHref();var p=d.url(),q;if(a.enabled){if(!m&&a.requireBase)throw Fb("nobase");q=p.substring(0,p.indexOf("/",p.indexOf("//")+2))+(m||"/");m=e.history?cc:cd}else q=Ha(p),m=dc;k=new m(q,"#"+b);k.$$parseLinkUrl(p,p);k.$$state=d.state();var u=/^\s*(javascript|mailto):/i;f.on("click",function(b){if(a.rewriteLinks&&!b.ctrlKey&&!b.metaKey&&
2!=b.which){for(var e=B(b.target);"a"!==ua(e[0]);)if(e[0]===f[0]||!(e=e.parent())[0])return;var h=e.prop("href"),l=e.attr("href")||e.attr("xlink:href");I(h)&&"[object SVGAnimatedString]"===h.toString()&&(h=Ba(h.animVal).href);u.test(h)||!h||e.attr("target")||b.isDefaultPrevented()||!k.$$parseLinkUrl(h,l)||(b.preventDefault(),k.absUrl()!=d.url()&&(c.$apply(),g.angular["ff-684208-preventDefault"]=!0))}});k.absUrl()!=p&&d.url(k.absUrl(),!0);var r=!0;d.onUrlChange(function(a,b){c.$evalAsync(function(){var d=
k.absUrl(),e=k.$$state,f;k.$$parse(a);k.$$state=b;f=c.$broadcast("$locationChangeStart",a,d,b,e).defaultPrevented;k.absUrl()===a&&(f?(k.$$parse(d),k.$$state=e,h(d,!1,e)):(r=!1,l(d,e)))});c.$$phase||c.$digest()});c.$watch(function(){var a=bd(d.url()),b=bd(k.absUrl()),f=d.state(),g=k.$$replace,q=a!==b||k.$$html5&&e.history&&f!==k.$$state;if(r||q)r=!1,c.$evalAsync(function(){var b=k.absUrl(),d=c.$broadcast("$locationChangeStart",b,a,k.$$state,f).defaultPrevented;k.absUrl()===b&&(d?(k.$$parse(a),k.$$state=
f):(q&&h(b,g,f===k.$$state?null:k.$$state),l(a,f)))});k.$$replace=!1});return k}]}function Ne(){var b=!0,a=this;this.debugEnabled=function(a){return y(a)?(b=a,this):b};this.$get=["$window",function(c){function d(a){a instanceof Error&&(a.stack?a=a.message&&-1===a.stack.indexOf(a.message)?"Error: "+a.message+"\n"+a.stack:a.stack:a.sourceURL&&(a=a.message+"\n"+a.sourceURL+":"+a.line));return a}function e(a){var b=c.console||{},e=b[a]||b.log||H;a=!1;try{a=!!e.apply}catch(l){}return a?function(){var a=
[];s(arguments,function(b){a.push(d(b))});return e.apply(b,a)}:function(a,b){e(a,null==b?"":b)}}return{log:e("log"),info:e("info"),warn:e("warn"),error:e("error"),debug:function(){var c=e("debug");return function(){b&&c.apply(a,arguments)}}()}}]}function ta(b,a){if("__defineGetter__"===b||"__defineSetter__"===b||"__lookupGetter__"===b||"__lookupSetter__"===b||"__proto__"===b)throw la("isecfld",a);return b}function ma(b,a){if(b){if(b.constructor===b)throw la("isecfn",a);if(b.window===b)throw la("isecwindow",
a);if(b.children&&(b.nodeName||b.prop&&b.attr&&b.find))throw la("isecdom",a);if(b===Object)throw la("isecobj",a);}return b}function ec(b){return b.constant}function gb(b,a,c,d,e){ma(b,e);ma(a,e);c=c.split(".");for(var f,g=0;1<c.length;g++){f=ta(c.shift(),e);var h=0===g&&a&&a[f]||b[f];h||(h={},b[f]=h);b=ma(h,e)}f=ta(c.shift(),e);ma(b[f],e);return b[f]=d}function Qa(b){return"constructor"==b}function ed(b,a,c,d,e,f,g){ta(b,f);ta(a,f);ta(c,f);ta(d,f);ta(e,f);var h=function(a){return ma(a,f)},l=g||Qa(b)?
h:pa,k=g||Qa(a)?h:pa,m=g||Qa(c)?h:pa,p=g||Qa(d)?h:pa,q=g||Qa(e)?h:pa;return function(f,g){var h=g&&g.hasOwnProperty(b)?g:f;if(null==h)return h;h=l(h[b]);if(!a)return h;if(null==h)return t;h=k(h[a]);if(!c)return h;if(null==h)return t;h=m(h[c]);if(!d)return h;if(null==h)return t;h=p(h[d]);return e?null==h?t:h=q(h[e]):h}}function yf(b,a){return function(c,d){return b(c,d,ma,a)}}function zf(b,a,c){var d=a.expensiveChecks,e=d?Af:Bf,f=e[b];if(f)return f;var g=b.split("."),h=g.length;if(a.csp)f=6>h?ed(g[0],
g[1],g[2],g[3],g[4],c,d):function(a,b){var e=0,f;do f=ed(g[e++],g[e++],g[e++],g[e++],g[e++],c,d)(a,b),b=t,a=f;while(e<h);return f};else{var l="";d&&(l+="s = eso(s, fe);\nl = eso(l, fe);\n");var k=d;s(g,function(a,b){ta(a,c);var e=(b?"s":'((l&&l.hasOwnProperty("'+a+'"))?l:s)')+"."+a;if(d||Qa(a))e="eso("+e+", fe)",k=!0;l+="if(s == null) return undefined;\ns="+e+";\n"});l+="return s;";a=new Function("s","l","eso","fe",l);a.toString=da(l);k&&(a=yf(a,c));f=a}f.sharedGetter=!0;f.assign=function(a,c,d){return gb(a,
d,b,c,b)};return e[b]=f}function fc(b){return G(b.valueOf)?b.valueOf():Cf.call(b)}function Oe(){var b=ha(),a=ha();this.$get=["$filter","$sniffer",function(c,d){function e(a){var b=a;a.sharedGetter&&(b=function(b,c){return a(b,c)},b.literal=a.literal,b.constant=a.constant,b.assign=a.assign);return b}function f(a,b){for(var c=0,d=a.length;c<d;c++){var e=a[c];e.constant||(e.inputs?f(e.inputs,b):-1===b.indexOf(e)&&b.push(e))}return b}function g(a,b){return null==a||null==b?a===b:"object"===typeof a&&
(a=fc(a),"object"===typeof a)?!1:a===b||a!==a&&b!==b}function h(a,b,c,d){var e=d.$$inputs||(d.$$inputs=f(d.inputs,[])),h;if(1===e.length){var l=g,e=e[0];return a.$watch(function(a){var b=e(a);g(b,l)||(h=d(a),l=b&&fc(b));return h},b,c)}for(var k=[],q=0,p=e.length;q<p;q++)k[q]=g;return a.$watch(function(a){for(var b=!1,c=0,f=e.length;c<f;c++){var l=e[c](a);if(b||(b=!g(l,k[c])))k[c]=l&&fc(l)}b&&(h=d(a));return h},b,c)}function l(a,b,c,d){var e,f;return e=a.$watch(function(a){return d(a)},function(a,
c,d){f=a;G(b)&&b.apply(this,arguments);y(a)&&d.$$postDigest(function(){y(f)&&e()})},c)}function k(a,b,c,d){function e(a){var b=!0;s(a,function(a){y(a)||(b=!1)});return b}var f,g;return f=a.$watch(function(a){return d(a)},function(a,c,d){g=a;G(b)&&b.call(this,a,c,d);e(a)&&d.$$postDigest(function(){e(g)&&f()})},c)}function m(a,b,c,d){var e;return e=a.$watch(function(a){return d(a)},function(a,c,d){G(b)&&b.apply(this,arguments);e()},c)}function p(a,b){if(!b)return a;var c=a.$$watchDelegate,c=c!==k&&
c!==l?function(c,d){var e=a(c,d);return b(e,c,d)}:function(c,d){var e=a(c,d),f=b(e,c,d);return y(e)?f:e};a.$$watchDelegate&&a.$$watchDelegate!==h?c.$$watchDelegate=a.$$watchDelegate:b.$stateful||(c.$$watchDelegate=h,c.inputs=[a]);return c}var q={csp:d.csp,expensiveChecks:!1},u={csp:d.csp,expensiveChecks:!0};return function(d,f,g){var v,w,L;switch(typeof d){case "string":L=d=d.trim();var C=g?a:b;v=C[L];v||(":"===d.charAt(0)&&":"===d.charAt(1)&&(w=!0,d=d.substring(2)),g=g?u:q,v=new gc(g),v=(new hb(v,
c,g)).parse(d),v.constant?v.$$watchDelegate=m:w?(v=e(v),v.$$watchDelegate=v.literal?k:l):v.inputs&&(v.$$watchDelegate=h),C[L]=v);return p(v,f);case "function":return p(d,f);default:return p(H,f)}}}]}function Qe(){this.$get=["$rootScope","$exceptionHandler",function(b,a){return fd(function(a){b.$evalAsync(a)},a)}]}function Re(){this.$get=["$browser","$exceptionHandler",function(b,a){return fd(function(a){b.defer(a)},a)}]}function fd(b,a){function c(a,b,c){function d(b){return function(c){e||(e=!0,
b.call(a,c))}}var e=!1;return[d(b),d(c)]}function d(){this.$$state={status:0}}function e(a,b){return function(c){b.call(a,c)}}function f(c){!c.processScheduled&&c.pending&&(c.processScheduled=!0,b(function(){var b,d,e;e=c.pending;c.processScheduled=!1;c.pending=t;for(var f=0,g=e.length;f<g;++f){d=e[f][0];b=e[f][c.status];try{G(b)?d.resolve(b(c.value)):1===c.status?d.resolve(c.value):d.reject(c.value)}catch(h){d.reject(h),a(h)}}}))}function g(){this.promise=new d;this.resolve=e(this,this.resolve);
this.reject=e(this,this.reject);this.notify=e(this,this.notify)}var h=T("$q",TypeError);d.prototype={then:function(a,b,c){var d=new g;this.$$state.pending=this.$$state.pending||[];this.$$state.pending.push([d,a,b,c]);0<this.$$state.status&&f(this.$$state);return d.promise},"catch":function(a){return this.then(null,a)},"finally":function(a,b){return this.then(function(b){return k(b,!0,a)},function(b){return k(b,!1,a)},b)}};g.prototype={resolve:function(a){this.promise.$$state.status||(a===this.promise?
this.$$reject(h("qcycle",a)):this.$$resolve(a))},$$resolve:function(b){var d,e;e=c(this,this.$$resolve,this.$$reject);try{if(I(b)||G(b))d=b&&b.then;G(d)?(this.promise.$$state.status=-1,d.call(b,e[0],e[1],this.notify)):(this.promise.$$state.value=b,this.promise.$$state.status=1,f(this.promise.$$state))}catch(g){e[1](g),a(g)}},reject:function(a){this.promise.$$state.status||this.$$reject(a)},$$reject:function(a){this.promise.$$state.value=a;this.promise.$$state.status=2;f(this.promise.$$state)},notify:function(c){var d=
this.promise.$$state.pending;0>=this.promise.$$state.status&&d&&d.length&&b(function(){for(var b,e,f=0,g=d.length;f<g;f++){e=d[f][0];b=d[f][3];try{e.notify(G(b)?b(c):c)}catch(h){a(h)}}})}};var l=function(a,b){var c=new g;b?c.resolve(a):c.reject(a);return c.promise},k=function(a,b,c){var d=null;try{G(c)&&(d=c())}catch(e){return l(e,!1)}return d&&G(d.then)?d.then(function(){return l(a,b)},function(a){return l(a,!1)}):l(a,b)},m=function(a,b,c,d){var e=new g;e.resolve(a);return e.promise.then(b,c,d)},
p=function u(a){if(!G(a))throw h("norslvr",a);if(!(this instanceof u))return new u(a);var b=new g;a(function(a){b.resolve(a)},function(a){b.reject(a)});return b.promise};p.defer=function(){return new g};p.reject=function(a){var b=new g;b.reject(a);return b.promise};p.when=m;p.all=function(a){var b=new g,c=0,d=D(a)?[]:{};s(a,function(a,e){c++;m(a).then(function(a){d.hasOwnProperty(e)||(d[e]=a,--c||b.resolve(d))},function(a){d.hasOwnProperty(e)||b.reject(a)})});0===c&&b.resolve(d);return b.promise};
return p}function $e(){this.$get=["$window","$timeout",function(b,a){var c=b.requestAnimationFrame||b.webkitRequestAnimationFrame,d=b.cancelAnimationFrame||b.webkitCancelAnimationFrame||b.webkitCancelRequestAnimationFrame,e=!!c,f=e?function(a){var b=c(a);return function(){d(b)}}:function(b){var c=a(b,16.66,!1);return function(){a.cancel(c)}};f.supported=e;return f}]}function Pe(){var b=10,a=T("$rootScope"),c=null,d=null;this.digestTtl=function(a){arguments.length&&(b=a);return b};this.$get=["$injector",
"$exceptionHandler","$parse","$browser",function(e,f,g,h){function l(){this.$id=++nb;this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null;this.$root=this;this.$$destroyed=!1;this.$$listeners={};this.$$listenerCount={};this.$$isolateBindings=null}function k(b){if(r.$$phase)throw a("inprog",r.$$phase);r.$$phase=b}function m(a,b,c){do a.$$listenerCount[c]-=b,0===a.$$listenerCount[c]&&delete a.$$listenerCount[c];while(a=a.$parent)}function p(){}
function q(){for(;v.length;)try{v.shift()()}catch(a){f(a)}d=null}function u(){null===d&&(d=h.defer(function(){r.$apply(q)}))}l.prototype={constructor:l,$new:function(a,b){function c(){d.$$destroyed=!0}var d;b=b||this;a?(d=new l,d.$root=this.$root):(this.$$ChildScope||(this.$$ChildScope=function(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null;this.$$listeners={};this.$$listenerCount={};this.$id=++nb;this.$$ChildScope=null},this.$$ChildScope.prototype=this),d=new this.$$ChildScope);
d.$parent=b;d.$$prevSibling=b.$$childTail;b.$$childHead?(b.$$childTail.$$nextSibling=d,b.$$childTail=d):b.$$childHead=b.$$childTail=d;(a||b!=this)&&d.$on("$destroy",c);return d},$watch:function(a,b,d){var e=g(a);if(e.$$watchDelegate)return e.$$watchDelegate(this,b,d,e);var f=this.$$watchers,h={fn:b,last:p,get:e,exp:a,eq:!!d};c=null;G(b)||(h.fn=H);f||(f=this.$$watchers=[]);f.unshift(h);return function(){Xa(f,h);c=null}},$watchGroup:function(a,b){function c(){h=!1;l?(l=!1,b(e,e,g)):b(e,d,g)}var d=Array(a.length),
e=Array(a.length),f=[],g=this,h=!1,l=!0;if(!a.length){var k=!0;g.$evalAsync(function(){k&&b(e,e,g)});return function(){k=!1}}if(1===a.length)return this.$watch(a[0],function(a,c,f){e[0]=a;d[0]=c;b(e,a===c?e:d,f)});s(a,function(a,b){var l=g.$watch(a,function(a,f){e[b]=a;d[b]=f;h||(h=!0,g.$evalAsync(c))});f.push(l)});return function(){for(;f.length;)f.shift()()}},$watchCollection:function(a,b){function c(a){e=a;var b,d,g,h;if(!A(e)){if(I(e))if(Ta(e))for(f!==q&&(f=q,u=f.length=0,k++),a=e.length,u!==
a&&(k++,f.length=u=a),b=0;b<a;b++)h=f[b],g=e[b],d=h!==h&&g!==g,d||h===g||(k++,f[b]=g);else{f!==m&&(f=m={},u=0,k++);a=0;for(b in e)e.hasOwnProperty(b)&&(a++,g=e[b],h=f[b],b in f?(d=h!==h&&g!==g,d||h===g||(k++,f[b]=g)):(u++,f[b]=g,k++));if(u>a)for(b in k++,f)e.hasOwnProperty(b)||(u--,delete f[b])}else f!==e&&(f=e,k++);return k}}c.$stateful=!0;var d=this,e,f,h,l=1<b.length,k=0,p=g(a,c),q=[],m={},n=!0,u=0;return this.$watch(p,function(){n?(n=!1,b(e,e,d)):b(e,h,d);if(l)if(I(e))if(Ta(e)){h=Array(e.length);
for(var a=0;a<e.length;a++)h[a]=e[a]}else for(a in h={},e)rc.call(e,a)&&(h[a]=e[a]);else h=e})},$digest:function(){var e,g,l,m,u,v,s=b,t,W=[],y,J;k("$digest");h.$$checkUrlChange();this===r&&null!==d&&(h.defer.cancel(d),q());c=null;do{v=!1;for(t=this;O.length;){try{J=O.shift(),J.scope.$eval(J.expression,J.locals)}catch(B){f(B)}c=null}a:do{if(m=t.$$watchers)for(u=m.length;u--;)try{if(e=m[u])if((g=e.get(t))!==(l=e.last)&&!(e.eq?fa(g,l):"number"===typeof g&&"number"===typeof l&&isNaN(g)&&isNaN(l)))v=
!0,c=e,e.last=e.eq?Ea(g,null):g,e.fn(g,l===p?g:l,t),5>s&&(y=4-s,W[y]||(W[y]=[]),W[y].push({msg:G(e.exp)?"fn: "+(e.exp.name||e.exp.toString()):e.exp,newVal:g,oldVal:l}));else if(e===c){v=!1;break a}}catch(A){f(A)}if(!(m=t.$$childHead||t!==this&&t.$$nextSibling))for(;t!==this&&!(m=t.$$nextSibling);)t=t.$parent}while(t=m);if((v||O.length)&&!s--)throw r.$$phase=null,a("infdig",b,W);}while(v||O.length);for(r.$$phase=null;n.length;)try{n.shift()()}catch(ca){f(ca)}},$destroy:function(){if(!this.$$destroyed){var a=
this.$parent;this.$broadcast("$destroy");this.$$destroyed=!0;if(this!==r){for(var b in this.$$listenerCount)m(this,this.$$listenerCount[b],b);a.$$childHead==this&&(a.$$childHead=this.$$nextSibling);a.$$childTail==this&&(a.$$childTail=this.$$prevSibling);this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling);this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling);this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=H;this.$on=this.$watch=this.$watchGroup=
function(){return H};this.$$listeners={};this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=this.$$watchers=null}}},$eval:function(a,b){return g(a)(this,b)},$evalAsync:function(a,b){r.$$phase||O.length||h.defer(function(){O.length&&r.$digest()});O.push({scope:this,expression:a,locals:b})},$$postDigest:function(a){n.push(a)},$apply:function(a){try{return k("$apply"),this.$eval(a)}catch(b){f(b)}finally{r.$$phase=null;try{r.$digest()}catch(c){throw f(c),c;
}}},$applyAsync:function(a){function b(){c.$eval(a)}var c=this;a&&v.push(b);u()},$on:function(a,b){var c=this.$$listeners[a];c||(this.$$listeners[a]=c=[]);c.push(b);var d=this;do d.$$listenerCount[a]||(d.$$listenerCount[a]=0),d.$$listenerCount[a]++;while(d=d.$parent);var e=this;return function(){var d=c.indexOf(b);-1!==d&&(c[d]=null,m(e,1,a))}},$emit:function(a,b){var c=[],d,e=this,g=!1,h={name:a,targetScope:e,stopPropagation:function(){g=!0},preventDefault:function(){h.defaultPrevented=!0},defaultPrevented:!1},
l=Ya([h],arguments,1),k,p;do{d=e.$$listeners[a]||c;h.currentScope=e;k=0;for(p=d.length;k<p;k++)if(d[k])try{d[k].apply(null,l)}catch(m){f(m)}else d.splice(k,1),k--,p--;if(g)return h.currentScope=null,h;e=e.$parent}while(e);h.currentScope=null;return h},$broadcast:function(a,b){var c=this,d=this,e={name:a,targetScope:this,preventDefault:function(){e.defaultPrevented=!0},defaultPrevented:!1};if(!this.$$listenerCount[a])return e;for(var g=Ya([e],arguments,1),h,l;c=d;){e.currentScope=c;d=c.$$listeners[a]||
[];h=0;for(l=d.length;h<l;h++)if(d[h])try{d[h].apply(null,g)}catch(k){f(k)}else d.splice(h,1),h--,l--;if(!(d=c.$$listenerCount[a]&&c.$$childHead||c!==this&&c.$$nextSibling))for(;c!==this&&!(d=c.$$nextSibling);)c=c.$parent}e.currentScope=null;return e}};var r=new l,O=r.$$asyncQueue=[],n=r.$$postDigestQueue=[],v=r.$$applyAsyncQueue=[];return r}]}function Sd(){var b=/^\s*(https?|ftp|mailto|tel|file):/,a=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(a){return y(a)?
(b=a,this):b};this.imgSrcSanitizationWhitelist=function(b){return y(b)?(a=b,this):a};this.$get=function(){return function(c,d){var e=d?a:b,f;f=Ba(c).href;return""===f||f.match(e)?c:"unsafe:"+f}}}function Df(b){if("self"===b)return b;if(F(b)){if(-1<b.indexOf("***"))throw Ca("iwcard",b);b=gd(b).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*");return new RegExp("^"+b+"$")}if(ob(b))return new RegExp("^"+b.source+"$");throw Ca("imatcher");}function hd(b){var a=[];y(b)&&s(b,function(b){a.push(Df(b))});
return a}function Te(){this.SCE_CONTEXTS=na;var b=["self"],a=[];this.resourceUrlWhitelist=function(a){arguments.length&&(b=hd(a));return b};this.resourceUrlBlacklist=function(b){arguments.length&&(a=hd(b));return a};this.$get=["$injector",function(c){function d(a,b){return"self"===a?Zc(b):!!a.exec(b.href)}function e(a){var b=function(a){this.$$unwrapTrustedValue=function(){return a}};a&&(b.prototype=new a);b.prototype.valueOf=function(){return this.$$unwrapTrustedValue()};b.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()};
return b}var f=function(a){throw Ca("unsafe");};c.has("$sanitize")&&(f=c.get("$sanitize"));var g=e(),h={};h[na.HTML]=e(g);h[na.CSS]=e(g);h[na.URL]=e(g);h[na.JS]=e(g);h[na.RESOURCE_URL]=e(h[na.URL]);return{trustAs:function(a,b){var c=h.hasOwnProperty(a)?h[a]:null;if(!c)throw Ca("icontext",a,b);if(null===b||b===t||""===b)return b;if("string"!==typeof b)throw Ca("itype",a);return new c(b)},getTrusted:function(c,e){if(null===e||e===t||""===e)return e;var g=h.hasOwnProperty(c)?h[c]:null;if(g&&e instanceof
g)return e.$$unwrapTrustedValue();if(c===na.RESOURCE_URL){var g=Ba(e.toString()),p,q,u=!1;p=0;for(q=b.length;p<q;p++)if(d(b[p],g)){u=!0;break}if(u)for(p=0,q=a.length;p<q;p++)if(d(a[p],g)){u=!1;break}if(u)return e;throw Ca("insecurl",e.toString());}if(c===na.HTML)return f(e);throw Ca("unsafe");},valueOf:function(a){return a instanceof g?a.$$unwrapTrustedValue():a}}}]}function Se(){var b=!0;this.enabled=function(a){arguments.length&&(b=!!a);return b};this.$get=["$parse","$sceDelegate",function(a,c){if(b&&
8>Ra)throw Ca("iequirks");var d=ra(na);d.isEnabled=function(){return b};d.trustAs=c.trustAs;d.getTrusted=c.getTrusted;d.valueOf=c.valueOf;b||(d.trustAs=d.getTrusted=function(a,b){return b},d.valueOf=pa);d.parseAs=function(b,c){var e=a(c);return e.literal&&e.constant?e:a(c,function(a){return d.getTrusted(b,a)})};var e=d.parseAs,f=d.getTrusted,g=d.trustAs;s(na,function(a,b){var c=Q(b);d[cb("parse_as_"+c)]=function(b){return e(a,b)};d[cb("get_trusted_"+c)]=function(b){return f(a,b)};d[cb("trust_as_"+
c)]=function(b){return g(a,b)}});return d}]}function Ue(){this.$get=["$window","$document",function(b,a){var c={},d=ba((/android (\d+)/.exec(Q((b.navigator||{}).userAgent))||[])[1]),e=/Boxee/i.test((b.navigator||{}).userAgent),f=a[0]||{},g,h=/^(Moz|webkit|ms)(?=[A-Z])/,l=f.body&&f.body.style,k=!1,m=!1;if(l){for(var p in l)if(k=h.exec(p)){g=k[0];g=g.substr(0,1).toUpperCase()+g.substr(1);break}g||(g="WebkitOpacity"in l&&"webkit");k=!!("transition"in l||g+"Transition"in l);m=!!("animation"in l||g+"Animation"in
l);!d||k&&m||(k=F(f.body.style.webkitTransition),m=F(f.body.style.webkitAnimation))}return{history:!(!b.history||!b.history.pushState||4>d||e),hasEvent:function(a){if("input"===a&&11>=Ra)return!1;if(A(c[a])){var b=f.createElement("div");c[a]="on"+a in b}return c[a]},csp:ab(),vendorPrefix:g,transitions:k,animations:m,android:d}}]}function We(){this.$get=["$templateCache","$http","$q",function(b,a,c){function d(e,f){d.totalPendingRequests++;var g=a.defaults&&a.defaults.transformResponse;D(g)?g=g.filter(function(a){return a!==
Yb}):g===Yb&&(g=null);return a.get(e,{cache:b,transformResponse:g}).then(function(a){d.totalPendingRequests--;return a.data},function(a){d.totalPendingRequests--;if(!f)throw ja("tpload",e);return c.reject(a)})}d.totalPendingRequests=0;return d}]}function Xe(){this.$get=["$rootScope","$browser","$location",function(b,a,c){return{findBindings:function(a,b,c){a=a.getElementsByClassName("ng-binding");var g=[];s(a,function(a){var d=ga.element(a).data("$binding");d&&s(d,function(d){c?(new RegExp("(^|\\s)"+
gd(b)+"(\\s|\\||$)")).test(d)&&g.push(a):-1!=d.indexOf(b)&&g.push(a)})});return g},findModels:function(a,b,c){for(var g=["ng-","data-ng-","ng\\:"],h=0;h<g.length;++h){var l=a.querySelectorAll("["+g[h]+"model"+(c?"=":"*=")+'"'+b+'"]');if(l.length)return l}},getLocation:function(){return c.url()},setLocation:function(a){a!==c.url()&&(c.url(a),b.$digest())},whenStable:function(b){a.notifyWhenNoOutstandingRequests(b)}}}]}function Ye(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",
function(b,a,c,d,e){function f(f,l,k){var m=y(k)&&!k,p=(m?d:c).defer(),q=p.promise;l=a.defer(function(){try{p.resolve(f())}catch(a){p.reject(a),e(a)}finally{delete g[q.$$timeoutId]}m||b.$apply()},l);q.$$timeoutId=l;g[l]=p;return q}var g={};f.cancel=function(b){return b&&b.$$timeoutId in g?(g[b.$$timeoutId].reject("canceled"),delete g[b.$$timeoutId],a.defer.cancel(b.$$timeoutId)):!1};return f}]}function Ba(b){Ra&&(Z.setAttribute("href",b),b=Z.href);Z.setAttribute("href",b);return{href:Z.href,protocol:Z.protocol?
Z.protocol.replace(/:$/,""):"",host:Z.host,search:Z.search?Z.search.replace(/^\?/,""):"",hash:Z.hash?Z.hash.replace(/^#/,""):"",hostname:Z.hostname,port:Z.port,pathname:"/"===Z.pathname.charAt(0)?Z.pathname:"/"+Z.pathname}}function Zc(b){b=F(b)?Ba(b):b;return b.protocol===id.protocol&&b.host===id.host}function Ze(){this.$get=da(M)}function Dc(b){function a(c,d){if(I(c)){var e={};s(c,function(b,c){e[c]=a(c,b)});return e}return b.factory(c+"Filter",d)}this.register=a;this.$get=["$injector",function(a){return function(b){return a.get(b+
"Filter")}}];a("currency",jd);a("date",kd);a("filter",Ef);a("json",Ff);a("limitTo",Gf);a("lowercase",Hf);a("number",ld);a("orderBy",md);a("uppercase",If)}function Ef(){return function(b,a,c){if(!D(b))return b;var d;switch(typeof a){case "function":break;case "boolean":case "number":case "string":d=!0;case "object":a=Jf(a,c,d);break;default:return b}return b.filter(a)}}function Jf(b,a,c){var d=I(b)&&"$"in b;!0===a?a=fa:G(a)||(a=function(a,b){if(I(a)||I(b))return!1;a=Q(""+a);b=Q(""+b);return-1!==a.indexOf(b)});
return function(e){return d&&!I(e)?Ia(e,b.$,a,!1):Ia(e,b,a,c)}}function Ia(b,a,c,d,e){var f=typeof b,g=typeof a;if("string"===g&&"!"===a.charAt(0))return!Ia(b,a.substring(1),c,d);if(D(b))return b.some(function(b){return Ia(b,a,c,d)});switch(f){case "object":var h;if(d){for(h in b)if("$"!==h.charAt(0)&&Ia(b[h],a,c,!0))return!0;return e?!1:Ia(b,a,c,!1)}if("object"===g){for(h in a)if(e=a[h],!G(e)&&(f="$"===h,!Ia(f?b:b[h],e,c,f,f)))return!1;return!0}return c(b,a);case "function":return!1;default:return c(b,
a)}}function jd(b){var a=b.NUMBER_FORMATS;return function(b,d,e){A(d)&&(d=a.CURRENCY_SYM);A(e)&&(e=a.PATTERNS[1].maxFrac);return null==b?b:nd(b,a.PATTERNS[1],a.GROUP_SEP,a.DECIMAL_SEP,e).replace(/\u00A4/g,d)}}function ld(b){var a=b.NUMBER_FORMATS;return function(b,d){return null==b?b:nd(b,a.PATTERNS[0],a.GROUP_SEP,a.DECIMAL_SEP,d)}}function nd(b,a,c,d,e){if(!isFinite(b)||I(b))return"";var f=0>b;b=Math.abs(b);var g=b+"",h="",l=[],k=!1;if(-1!==g.indexOf("e")){var m=g.match(/([\d\.]+)e(-?)(\d+)/);m&&
"-"==m[2]&&m[3]>e+1?b=0:(h=g,k=!0)}if(k)0<e&&1>b&&(h=b.toFixed(e),b=parseFloat(h));else{g=(g.split(od)[1]||"").length;A(e)&&(e=Math.min(Math.max(a.minFrac,g),a.maxFrac));b=+(Math.round(+(b.toString()+"e"+e)).toString()+"e"+-e);var g=(""+b).split(od),k=g[0],g=g[1]||"",p=0,q=a.lgSize,u=a.gSize;if(k.length>=q+u)for(p=k.length-q,m=0;m<p;m++)0===(p-m)%u&&0!==m&&(h+=c),h+=k.charAt(m);for(m=p;m<k.length;m++)0===(k.length-m)%q&&0!==m&&(h+=c),h+=k.charAt(m);for(;g.length<e;)g+="0";e&&"0"!==e&&(h+=d+g.substr(0,
e))}0===b&&(f=!1);l.push(f?a.negPre:a.posPre,h,f?a.negSuf:a.posSuf);return l.join("")}function Hb(b,a,c){var d="";0>b&&(d="-",b=-b);for(b=""+b;b.length<a;)b="0"+b;c&&(b=b.substr(b.length-a));return d+b}function $(b,a,c,d){c=c||0;return function(e){e=e["get"+b]();if(0<c||e>-c)e+=c;0===e&&-12==c&&(e=12);return Hb(e,a,d)}}function Ib(b,a){return function(c,d){var e=c["get"+b](),f=ub(a?"SHORT"+b:b);return d[f][e]}}function pd(b){var a=(new Date(b,0,1)).getDay();return new Date(b,0,(4>=a?5:12)-a)}function qd(b){return function(a){var c=
pd(a.getFullYear());a=+new Date(a.getFullYear(),a.getMonth(),a.getDate()+(4-a.getDay()))-+c;a=1+Math.round(a/6048E5);return Hb(a,b)}}function kd(b){function a(a){var b;if(b=a.match(c)){a=new Date(0);var f=0,g=0,h=b[8]?a.setUTCFullYear:a.setFullYear,l=b[8]?a.setUTCHours:a.setHours;b[9]&&(f=ba(b[9]+b[10]),g=ba(b[9]+b[11]));h.call(a,ba(b[1]),ba(b[2])-1,ba(b[3]));f=ba(b[4]||0)-f;g=ba(b[5]||0)-g;h=ba(b[6]||0);b=Math.round(1E3*parseFloat("0."+(b[7]||0)));l.call(a,f,g,h,b)}return a}var c=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;
return function(c,e,f){var g="",h=[],l,k;e=e||"mediumDate";e=b.DATETIME_FORMATS[e]||e;F(c)&&(c=Kf.test(c)?ba(c):a(c));V(c)&&(c=new Date(c));if(!qa(c))return c;for(;e;)(k=Lf.exec(e))?(h=Ya(h,k,1),e=h.pop()):(h.push(e),e=null);f&&"UTC"===f&&(c=new Date(c.getTime()),c.setMinutes(c.getMinutes()+c.getTimezoneOffset()));s(h,function(a){l=Mf[a];g+=l?l(c,b.DATETIME_FORMATS):a.replace(/(^'|'$)/g,"").replace(/''/g,"'")});return g}}function Ff(){return function(b,a){A(a)&&(a=2);return $a(b,a)}}function Gf(){return function(b,
a){V(b)&&(b=b.toString());return D(b)||F(b)?(a=Infinity===Math.abs(Number(a))?Number(a):ba(a))?0<a?b.slice(0,a):b.slice(a):F(b)?"":[]:b}}function md(b){return function(a,c,d){function e(a,b){return b?function(b,c){return a(c,b)}:a}function f(a){switch(typeof a){case "number":case "boolean":case "string":return!0;default:return!1}}function g(a){return null===a?"null":"function"===typeof a.valueOf&&(a=a.valueOf(),f(a))||"function"===typeof a.toString&&(a=a.toString(),f(a))?a:""}function h(a,b){var c=
typeof a,d=typeof b;c===d&&"object"===c&&(a=g(a),b=g(b));return c===d?("string"===c&&(a=a.toLowerCase(),b=b.toLowerCase()),a===b?0:a<b?-1:1):c<d?-1:1}if(!Ta(a))return a;c=D(c)?c:[c];0===c.length&&(c=["+"]);c=c.map(function(a){var c=!1,d=a||pa;if(F(a)){if("+"==a.charAt(0)||"-"==a.charAt(0))c="-"==a.charAt(0),a=a.substring(1);if(""===a)return e(h,c);d=b(a);if(d.constant){var f=d();return e(function(a,b){return h(a[f],b[f])},c)}}return e(function(a,b){return h(d(a),d(b))},c)});return Za.call(a).sort(e(function(a,
b){for(var d=0;d<c.length;d++){var e=c[d](a,b);if(0!==e)return e}return 0},d))}}function Ja(b){G(b)&&(b={link:b});b.restrict=b.restrict||"AC";return da(b)}function rd(b,a,c,d,e){var f=this,g=[],h=f.$$parentForm=b.parent().controller("form")||Jb;f.$error={};f.$$success={};f.$pending=t;f.$name=e(a.name||a.ngForm||"")(c);f.$dirty=!1;f.$pristine=!0;f.$valid=!0;f.$invalid=!1;f.$submitted=!1;h.$addControl(f);f.$rollbackViewValue=function(){s(g,function(a){a.$rollbackViewValue()})};f.$commitViewValue=function(){s(g,
function(a){a.$commitViewValue()})};f.$addControl=function(a){Ma(a.$name,"input");g.push(a);a.$name&&(f[a.$name]=a)};f.$$renameControl=function(a,b){var c=a.$name;f[c]===a&&delete f[c];f[b]=a;a.$name=b};f.$removeControl=function(a){a.$name&&f[a.$name]===a&&delete f[a.$name];s(f.$pending,function(b,c){f.$setValidity(c,null,a)});s(f.$error,function(b,c){f.$setValidity(c,null,a)});Xa(g,a)};sd({ctrl:this,$element:b,set:function(a,b,c){var d=a[b];d?-1===d.indexOf(c)&&d.push(c):a[b]=[c]},unset:function(a,
b,c){var d=a[b];d&&(Xa(d,c),0===d.length&&delete a[b])},parentForm:h,$animate:d});f.$setDirty=function(){d.removeClass(b,Sa);d.addClass(b,Kb);f.$dirty=!0;f.$pristine=!1;h.$setDirty()};f.$setPristine=function(){d.setClass(b,Sa,Kb+" ng-submitted");f.$dirty=!1;f.$pristine=!0;f.$submitted=!1;s(g,function(a){a.$setPristine()})};f.$setUntouched=function(){s(g,function(a){a.$setUntouched()})};f.$setSubmitted=function(){d.addClass(b,"ng-submitted");f.$submitted=!0;h.$setSubmitted()}}function hc(b){b.$formatters.push(function(a){return b.$isEmpty(a)?
a:a.toString()})}function ib(b,a,c,d,e,f){var g=Q(a[0].type);if(!e.android){var h=!1;a.on("compositionstart",function(a){h=!0});a.on("compositionend",function(){h=!1;l()})}var l=function(b){k&&(f.defer.cancel(k),k=null);if(!h){var e=a.val();b=b&&b.type;"password"===g||c.ngTrim&&"false"===c.ngTrim||(e=U(e));(d.$viewValue!==e||""===e&&d.$$hasNativeValidators)&&d.$setViewValue(e,b)}};if(e.hasEvent("input"))a.on("input",l);else{var k,m=function(a,b,c){k||(k=f.defer(function(){k=null;b&&b.value===c||l(a)}))};
a.on("keydown",function(a){var b=a.keyCode;91===b||15<b&&19>b||37<=b&&40>=b||m(a,this,this.value)});if(e.hasEvent("paste"))a.on("paste cut",m)}a.on("change",l);d.$render=function(){a.val(d.$isEmpty(d.$viewValue)?"":d.$viewValue)}}function Lb(b,a){return function(c,d){var e,f;if(qa(c))return c;if(F(c)){'"'==c.charAt(0)&&'"'==c.charAt(c.length-1)&&(c=c.substring(1,c.length-1));if(Nf.test(c))return new Date(c);b.lastIndex=0;if(e=b.exec(c))return e.shift(),f=d?{yyyy:d.getFullYear(),MM:d.getMonth()+1,
dd:d.getDate(),HH:d.getHours(),mm:d.getMinutes(),ss:d.getSeconds(),sss:d.getMilliseconds()/1E3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},s(e,function(b,c){c<a.length&&(f[a[c]]=+b)}),new Date(f.yyyy,f.MM-1,f.dd,f.HH,f.mm,f.ss||0,1E3*f.sss||0)}return NaN}}function jb(b,a,c,d){return function(e,f,g,h,l,k,m){function p(a){return a&&!(a.getTime&&a.getTime()!==a.getTime())}function q(a){return y(a)?qa(a)?a:c(a):t}td(e,f,g,h);ib(e,f,g,h,l,k);var u=h&&h.$options&&h.$options.timezone,r;h.$$parserName=b;
h.$parsers.push(function(b){return h.$isEmpty(b)?null:a.test(b)?(b=c(b,r),"UTC"===u&&b.setMinutes(b.getMinutes()-b.getTimezoneOffset()),b):t});h.$formatters.push(function(a){if(a&&!qa(a))throw Mb("datefmt",a);if(p(a)){if((r=a)&&"UTC"===u){var b=6E4*r.getTimezoneOffset();r=new Date(r.getTime()+b)}return m("date")(a,d,u)}r=null;return""});if(y(g.min)||g.ngMin){var s;h.$validators.min=function(a){return!p(a)||A(s)||c(a)>=s};g.$observe("min",function(a){s=q(a);h.$validate()})}if(y(g.max)||g.ngMax){var n;
h.$validators.max=function(a){return!p(a)||A(n)||c(a)<=n};g.$observe("max",function(a){n=q(a);h.$validate()})}}}function td(b,a,c,d){(d.$$hasNativeValidators=I(a[0].validity))&&d.$parsers.push(function(b){var c=a.prop("validity")||{};return c.badInput&&!c.typeMismatch?t:b})}function ud(b,a,c,d,e){if(y(d)){b=b(d);if(!b.constant)throw T("ngModel")("constexpr",c,d);return b(a)}return e}function ic(b,a){b="ngClass"+b;return["$animate",function(c){function d(a,b){var c=[],d=0;a:for(;d<a.length;d++){for(var e=
a[d],m=0;m<b.length;m++)if(e==b[m])continue a;c.push(e)}return c}function e(a){if(!D(a)){if(F(a))return a.split(" ");if(I(a)){var b=[];s(a,function(a,c){a&&(b=b.concat(c.split(" ")))});return b}}return a}return{restrict:"AC",link:function(f,g,h){function l(a,b){var c=g.data("$classCounts")||{},d=[];s(a,function(a){if(0<b||c[a])c[a]=(c[a]||0)+b,c[a]===+(0<b)&&d.push(a)});g.data("$classCounts",c);return d.join(" ")}function k(b){if(!0===a||f.$index%2===a){var k=e(b||[]);if(!m){var u=l(k,1);h.$addClass(u)}else if(!fa(b,
m)){var r=e(m),u=d(k,r),k=d(r,k),u=l(u,1),k=l(k,-1);u&&u.length&&c.addClass(g,u);k&&k.length&&c.removeClass(g,k)}}m=ra(b)}var m;f.$watch(h[b],k,!0);h.$observe("class",function(a){k(f.$eval(h[b]))});"ngClass"!==b&&f.$watch("$index",function(c,d){var g=c&1;if(g!==(d&1)){var k=e(f.$eval(h[b]));g===a?(g=l(k,1),h.$addClass(g)):(g=l(k,-1),h.$removeClass(g))}})}}}]}function sd(b){function a(a,b){b&&!f[a]?(k.addClass(e,a),f[a]=!0):!b&&f[a]&&(k.removeClass(e,a),f[a]=!1)}function c(b,c){b=b?"-"+tc(b,"-"):"";
a(kb+b,!0===c);a(vd+b,!1===c)}var d=b.ctrl,e=b.$element,f={},g=b.set,h=b.unset,l=b.parentForm,k=b.$animate;f[vd]=!(f[kb]=e.hasClass(kb));d.$setValidity=function(b,e,f){e===t?(d.$pending||(d.$pending={}),g(d.$pending,b,f)):(d.$pending&&h(d.$pending,b,f),wd(d.$pending)&&(d.$pending=t));Wa(e)?e?(h(d.$error,b,f),g(d.$$success,b,f)):(g(d.$error,b,f),h(d.$$success,b,f)):(h(d.$error,b,f),h(d.$$success,b,f));d.$pending?(a(xd,!0),d.$valid=d.$invalid=t,c("",null)):(a(xd,!1),d.$valid=wd(d.$error),d.$invalid=
!d.$valid,c("",d.$valid));e=d.$pending&&d.$pending[b]?t:d.$error[b]?!1:d.$$success[b]?!0:null;c(b,e);l.$setValidity(b,e,d)}}function wd(b){if(b)for(var a in b)return!1;return!0}var Of=/^\/(.+)\/([a-z]*)$/,Q=function(b){return F(b)?b.toLowerCase():b},rc=Object.prototype.hasOwnProperty,ub=function(b){return F(b)?b.toUpperCase():b},Ra,B,sa,Za=[].slice,rf=[].splice,Pf=[].push,Da=Object.prototype.toString,Ka=T("ng"),ga=M.angular||(M.angular={}),bb,nb=0;Ra=Y.documentMode;H.$inject=[];pa.$inject=[];var D=
Array.isArray,U=function(b){return F(b)?b.trim():b},gd=function(b){return b.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},ab=function(){if(y(ab.isActive_))return ab.isActive_;var b=!(!Y.querySelector("[ng-csp]")&&!Y.querySelector("[data-ng-csp]"));if(!b)try{new Function("")}catch(a){b=!0}return ab.isActive_=b},rb=["ng-","data-ng-","ng:","x-ng-"],Md=/[A-Z]/g,uc=!1,Pb,oa=1,pb=3,Qd={full:"1.3.9",major:1,minor:3,dot:9,codeName:"multidimensional-awareness"};R.expando="ng339";
var zb=R.cache={},hf=1;R._data=function(b){return this.cache[b[this.expando]]||{}};var cf=/([\:\-\_]+(.))/g,df=/^moz([A-Z])/,Qf={mouseleave:"mouseout",mouseenter:"mouseover"},Sb=T("jqLite"),gf=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,Rb=/<|&#?\w+;/,ef=/<([\w:]+)/,ff=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ia={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],
td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ia.optgroup=ia.option;ia.tbody=ia.tfoot=ia.colgroup=ia.caption=ia.thead;ia.th=ia.td;var La=R.prototype={ready:function(b){function a(){c||(c=!0,b())}var c=!1;"complete"===Y.readyState?setTimeout(a):(this.on("DOMContentLoaded",a),R(M).on("load",a))},toString:function(){var b=[];s(this,function(a){b.push(""+a)});return"["+b.join(", ")+"]"},eq:function(b){return 0<=b?B(this[b]):B(this[this.length+b])},length:0,push:Pf,sort:[].sort,
splice:[].splice},Eb={};s("multiple selected checked disabled readOnly required open".split(" "),function(b){Eb[Q(b)]=b});var Mc={};s("input select option textarea button form details".split(" "),function(b){Mc[b]=!0});var Nc={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern"};s({data:Ub,removeData:xb},function(b,a){R[a]=b});s({data:Ub,inheritedData:Db,scope:function(b){return B.data(b,"$scope")||Db(b.parentNode||b,["$isolateScope","$scope"])},isolateScope:function(b){return B.data(b,
"$isolateScope")||B.data(b,"$isolateScopeNoTemplate")},controller:Ic,injector:function(b){return Db(b,"$injector")},removeAttr:function(b,a){b.removeAttribute(a)},hasClass:Ab,css:function(b,a,c){a=cb(a);if(y(c))b.style[a]=c;else return b.style[a]},attr:function(b,a,c){var d=Q(a);if(Eb[d])if(y(c))c?(b[a]=!0,b.setAttribute(a,d)):(b[a]=!1,b.removeAttribute(d));else return b[a]||(b.attributes.getNamedItem(a)||H).specified?d:t;else if(y(c))b.setAttribute(a,c);else if(b.getAttribute)return b=b.getAttribute(a,
2),null===b?t:b},prop:function(b,a,c){if(y(c))b[a]=c;else return b[a]},text:function(){function b(a,b){if(A(b)){var d=a.nodeType;return d===oa||d===pb?a.textContent:""}a.textContent=b}b.$dv="";return b}(),val:function(b,a){if(A(a)){if(b.multiple&&"select"===ua(b)){var c=[];s(b.options,function(a){a.selected&&c.push(a.value||a.text)});return 0===c.length?null:c}return b.value}b.value=a},html:function(b,a){if(A(a))return b.innerHTML;wb(b,!0);b.innerHTML=a},empty:Jc},function(b,a){R.prototype[a]=function(a,
d){var e,f,g=this.length;if(b!==Jc&&(2==b.length&&b!==Ab&&b!==Ic?a:d)===t){if(I(a)){for(e=0;e<g;e++)if(b===Ub)b(this[e],a);else for(f in a)b(this[e],f,a[f]);return this}e=b.$dv;g=e===t?Math.min(g,1):g;for(f=0;f<g;f++){var h=b(this[f],a,d);e=e?e+h:h}return e}for(e=0;e<g;e++)b(this[e],a,d);return this}});s({removeData:xb,on:function a(c,d,e,f){if(y(f))throw Sb("onargs");if(Ec(c)){var g=yb(c,!0);f=g.events;var h=g.handle;h||(h=g.handle=lf(c,f));for(var g=0<=d.indexOf(" ")?d.split(" "):[d],l=g.length;l--;){d=
g[l];var k=f[d];k||(f[d]=[],"mouseenter"===d||"mouseleave"===d?a(c,Qf[d],function(a){var c=a.relatedTarget;c&&(c===this||this.contains(c))||h(a,d)}):"$destroy"!==d&&c.addEventListener(d,h,!1),k=f[d]);k.push(e)}}},off:Hc,one:function(a,c,d){a=B(a);a.on(c,function f(){a.off(c,d);a.off(c,f)});a.on(c,d)},replaceWith:function(a,c){var d,e=a.parentNode;wb(a);s(new R(c),function(c){d?e.insertBefore(c,d.nextSibling):e.replaceChild(c,a);d=c})},children:function(a){var c=[];s(a.childNodes,function(a){a.nodeType===
oa&&c.push(a)});return c},contents:function(a){return a.contentDocument||a.childNodes||[]},append:function(a,c){var d=a.nodeType;if(d===oa||11===d){c=new R(c);for(var d=0,e=c.length;d<e;d++)a.appendChild(c[d])}},prepend:function(a,c){if(a.nodeType===oa){var d=a.firstChild;s(new R(c),function(c){a.insertBefore(c,d)})}},wrap:function(a,c){c=B(c).eq(0).clone()[0];var d=a.parentNode;d&&d.replaceChild(c,a);c.appendChild(a)},remove:Kc,detach:function(a){Kc(a,!0)},after:function(a,c){var d=a,e=a.parentNode;
c=new R(c);for(var f=0,g=c.length;f<g;f++){var h=c[f];e.insertBefore(h,d.nextSibling);d=h}},addClass:Cb,removeClass:Bb,toggleClass:function(a,c,d){c&&s(c.split(" "),function(c){var f=d;A(f)&&(f=!Ab(a,c));(f?Cb:Bb)(a,c)})},parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},next:function(a){return a.nextElementSibling},find:function(a,c){return a.getElementsByTagName?a.getElementsByTagName(c):[]},clone:Tb,triggerHandler:function(a,c,d){var e,f,g=c.type||c,h=yb(a);if(h=(h=h&&h.events)&&
h[g])e={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return!0===this.defaultPrevented},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return!0===this.immediatePropagationStopped},stopPropagation:H,type:g,target:a},c.type&&(e=z(e,c)),c=ra(h),f=d?[e].concat(d):[e],s(c,function(c){e.isImmediatePropagationStopped()||c.apply(a,f)})}},function(a,c){R.prototype[c]=function(c,e,f){for(var g,h=0,l=this.length;h<
l;h++)A(g)?(g=a(this[h],c,e,f),y(g)&&(g=B(g))):Gc(g,a(this[h],c,e,f));return y(g)?g:this};R.prototype.bind=R.prototype.on;R.prototype.unbind=R.prototype.off});db.prototype={put:function(a,c){this[Na(a,this.nextUid)]=c},get:function(a){return this[Na(a,this.nextUid)]},remove:function(a){var c=this[a=Na(a,this.nextUid)];delete this[a];return c}};var Pc=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,nf=/,/,of=/^\s*(_?)(\S+?)\1\s*$/,Oc=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg,Ga=T("$injector");Ob.$$annotate=Vb;var Rf=
T("$animate"),Ce=["$provide",function(a){this.$$selectors={};this.register=function(c,d){var e=c+"-animation";if(c&&"."!=c.charAt(0))throw Rf("notcsel",c);this.$$selectors[c.substr(1)]=e;a.factory(e,d)};this.classNameFilter=function(a){1===arguments.length&&(this.$$classNameFilter=a instanceof RegExp?a:null);return this.$$classNameFilter};this.$get=["$$q","$$asyncCallback","$rootScope",function(a,d,e){function f(d){var f,g=a.defer();g.promise.$$cancelFn=function(){f&&f()};e.$$postDigest(function(){f=
d(function(){g.resolve()})});return g.promise}function g(a,c){var d=[],e=[],f=ha();s((a.attr("class")||"").split(/\s+/),function(a){f[a]=!0});s(c,function(a,c){var g=f[c];!1===a&&g?e.push(c):!0!==a||g||d.push(c)});return 0<d.length+e.length&&[d.length?d:null,e.length?e:null]}function h(a,c,d){for(var e=0,f=c.length;e<f;++e)a[c[e]]=d}function l(){m||(m=a.defer(),d(function(){m.resolve();m=null}));return m.promise}function k(a,c){if(ga.isObject(c)){var d=z(c.from||{},c.to||{});a.css(d)}}var m;return{animate:function(a,
c,d){k(a,{from:c,to:d});return l()},enter:function(a,c,d,e){k(a,e);d?d.after(a):c.prepend(a);return l()},leave:function(a,c){a.remove();return l()},move:function(a,c,d,e){return this.enter(a,c,d,e)},addClass:function(a,c,d){return this.setClass(a,c,[],d)},$$addClassImmediately:function(a,c,d){a=B(a);c=F(c)?c:D(c)?c.join(" "):"";s(a,function(a){Cb(a,c)});k(a,d);return l()},removeClass:function(a,c,d){return this.setClass(a,[],c,d)},$$removeClassImmediately:function(a,c,d){a=B(a);c=F(c)?c:D(c)?c.join(" "):
"";s(a,function(a){Bb(a,c)});k(a,d);return l()},setClass:function(a,c,d,e){var k=this,l=!1;a=B(a);var m=a.data("$$animateClasses");m?e&&m.options&&(m.options=ga.extend(m.options||{},e)):(m={classes:{},options:e},l=!0);e=m.classes;c=D(c)?c:c.split(" ");d=D(d)?d:d.split(" ");h(e,c,!0);h(e,d,!1);l&&(m.promise=f(function(c){var d=a.data("$$animateClasses");a.removeData("$$animateClasses");if(d){var e=g(a,d.classes);e&&k.$$setClassImmediately(a,e[0],e[1],d.options)}c()}),a.data("$$animateClasses",m));
return m.promise},$$setClassImmediately:function(a,c,d,e){c&&this.$$addClassImmediately(a,c);d&&this.$$removeClassImmediately(a,d);k(a,e);return l()},enabled:H,cancel:H}}]}],ja=T("$compile");wc.$inject=["$provide","$$sanitizeUriProvider"];var Rc=/^((?:x|data)[\:\-_])/i,Vc="application/json",Zb={"Content-Type":Vc+";charset=utf-8"},tf=/^\[|^\{(?!\{)/,uf={"[":/]$/,"{":/}$/},sf=/^\)\]\}',?\n/,$b=T("$interpolate"),Sf=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,xf={http:80,https:443,ftp:21},Fb=T("$location"),Tf=
{$$html5:!1,$$replace:!1,absUrl:Gb("$$absUrl"),url:function(a){if(A(a))return this.$$url;var c=Sf.exec(a);(c[1]||""===a)&&this.path(decodeURIComponent(c[1]));(c[2]||c[1]||""===a)&&this.search(c[3]||"");this.hash(c[5]||"");return this},protocol:Gb("$$protocol"),host:Gb("$$host"),port:Gb("$$port"),path:dd("$$path",function(a){a=null!==a?a.toString():"";return"/"==a.charAt(0)?a:"/"+a}),search:function(a,c){switch(arguments.length){case 0:return this.$$search;case 1:if(F(a)||V(a))a=a.toString(),this.$$search=
qc(a);else if(I(a))a=Ea(a,{}),s(a,function(c,e){null==c&&delete a[e]}),this.$$search=a;else throw Fb("isrcharg");break;default:A(c)||null===c?delete this.$$search[a]:this.$$search[a]=c}this.$$compose();return this},hash:dd("$$hash",function(a){return null!==a?a.toString():""}),replace:function(){this.$$replace=!0;return this}};s([cd,dc,cc],function(a){a.prototype=Object.create(Tf);a.prototype.state=function(c){if(!arguments.length)return this.$$state;if(a!==cc||!this.$$html5)throw Fb("nostate");this.$$state=
A(c)?null:c;return this}});var la=T("$parse"),Uf=Function.prototype.call,Vf=Function.prototype.apply,Wf=Function.prototype.bind,lb=ha();s({"null":function(){return null},"true":function(){return!0},"false":function(){return!1},undefined:function(){}},function(a,c){a.constant=a.literal=a.sharedGetter=!0;lb[c]=a});lb["this"]=function(a){return a};lb["this"].sharedGetter=!0;var mb=z(ha(),{"+":function(a,c,d,e){d=d(a,c);e=e(a,c);return y(d)?y(e)?d+e:d:y(e)?e:t},"-":function(a,c,d,e){d=d(a,c);e=e(a,c);
return(y(d)?d:0)-(y(e)?e:0)},"*":function(a,c,d,e){return d(a,c)*e(a,c)},"/":function(a,c,d,e){return d(a,c)/e(a,c)},"%":function(a,c,d,e){return d(a,c)%e(a,c)},"===":function(a,c,d,e){return d(a,c)===e(a,c)},"!==":function(a,c,d,e){return d(a,c)!==e(a,c)},"==":function(a,c,d,e){return d(a,c)==e(a,c)},"!=":function(a,c,d,e){return d(a,c)!=e(a,c)},"<":function(a,c,d,e){return d(a,c)<e(a,c)},">":function(a,c,d,e){return d(a,c)>e(a,c)},"<=":function(a,c,d,e){return d(a,c)<=e(a,c)},">=":function(a,c,
d,e){return d(a,c)>=e(a,c)},"&&":function(a,c,d,e){return d(a,c)&&e(a,c)},"||":function(a,c,d,e){return d(a,c)||e(a,c)},"!":function(a,c,d){return!d(a,c)},"=":!0,"|":!0}),Xf={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},gc=function(a){this.options=a};gc.prototype={constructor:gc,lex:function(a){this.text=a;this.index=0;for(this.tokens=[];this.index<this.text.length;)if(a=this.text.charAt(this.index),'"'===a||"'"===a)this.readString(a);else if(this.isNumber(a)||"."===a&&this.isNumber(this.peek()))this.readNumber();
else if(this.isIdent(a))this.readIdent();else if(this.is(a,"(){}[].,;:?"))this.tokens.push({index:this.index,text:a}),this.index++;else if(this.isWhitespace(a))this.index++;else{var c=a+this.peek(),d=c+this.peek(2),e=mb[c],f=mb[d];mb[a]||e||f?(a=f?d:e?c:a,this.tokens.push({index:this.index,text:a,operator:!0}),this.index+=a.length):this.throwError("Unexpected next character ",this.index,this.index+1)}return this.tokens},is:function(a,c){return-1!==c.indexOf(a)},peek:function(a){a=a||1;return this.index+
a<this.text.length?this.text.charAt(this.index+a):!1},isNumber:function(a){return"0"<=a&&"9">=a&&"string"===typeof a},isWhitespace:function(a){return" "===a||"\r"===a||"\t"===a||"\n"===a||"\v"===a||"\u00a0"===a},isIdent:function(a){return"a"<=a&&"z">=a||"A"<=a&&"Z">=a||"_"===a||"$"===a},isExpOperator:function(a){return"-"===a||"+"===a||this.isNumber(a)},throwError:function(a,c,d){d=d||this.index;c=y(c)?"s "+c+"-"+this.index+" ["+this.text.substring(c,d)+"]":" "+d;throw la("lexerr",a,c,this.text);
},readNumber:function(){for(var a="",c=this.index;this.index<this.text.length;){var d=Q(this.text.charAt(this.index));if("."==d||this.isNumber(d))a+=d;else{var e=this.peek();if("e"==d&&this.isExpOperator(e))a+=d;else if(this.isExpOperator(d)&&e&&this.isNumber(e)&&"e"==a.charAt(a.length-1))a+=d;else if(!this.isExpOperator(d)||e&&this.isNumber(e)||"e"!=a.charAt(a.length-1))break;else this.throwError("Invalid exponent")}this.index++}this.tokens.push({index:c,text:a,constant:!0,value:Number(a)})},readIdent:function(){for(var a=
this.index;this.index<this.text.length;){var c=this.text.charAt(this.index);if(!this.isIdent(c)&&!this.isNumber(c))break;this.index++}this.tokens.push({index:a,text:this.text.slice(a,this.index),identifier:!0})},readString:function(a){var c=this.index;this.index++;for(var d="",e=a,f=!1;this.index<this.text.length;){var g=this.text.charAt(this.index),e=e+g;if(f)"u"===g?(f=this.text.substring(this.index+1,this.index+5),f.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+f+"]"),this.index+=
4,d+=String.fromCharCode(parseInt(f,16))):d+=Xf[g]||g,f=!1;else if("\\"===g)f=!0;else{if(g===a){this.index++;this.tokens.push({index:c,text:e,constant:!0,value:d});return}d+=g}this.index++}this.throwError("Unterminated quote",c)}};var hb=function(a,c,d){this.lexer=a;this.$filter=c;this.options=d};hb.ZERO=z(function(){return 0},{sharedGetter:!0,constant:!0});hb.prototype={constructor:hb,parse:function(a){this.text=a;this.tokens=this.lexer.lex(a);a=this.statements();0!==this.tokens.length&&this.throwError("is an unexpected token",
this.tokens[0]);a.literal=!!a.literal;a.constant=!!a.constant;return a},primary:function(){var a;this.expect("(")?(a=this.filterChain(),this.consume(")")):this.expect("[")?a=this.arrayDeclaration():this.expect("{")?a=this.object():this.peek().identifier&&this.peek().text in lb?a=lb[this.consume().text]:this.peek().identifier?a=this.identifier():this.peek().constant?a=this.constant():this.throwError("not a primary expression",this.peek());for(var c,d;c=this.expect("(","[",".");)"("===c.text?(a=this.functionCall(a,
d),d=null):"["===c.text?(d=a,a=this.objectIndex(a)):"."===c.text?(d=a,a=this.fieldAccess(a)):this.throwError("IMPOSSIBLE");return a},throwError:function(a,c){throw la("syntax",c.text,a,c.index+1,this.text,this.text.substring(c.index));},peekToken:function(){if(0===this.tokens.length)throw la("ueoe",this.text);return this.tokens[0]},peek:function(a,c,d,e){return this.peekAhead(0,a,c,d,e)},peekAhead:function(a,c,d,e,f){if(this.tokens.length>a){a=this.tokens[a];var g=a.text;if(g===c||g===d||g===e||g===
f||!(c||d||e||f))return a}return!1},expect:function(a,c,d,e){return(a=this.peek(a,c,d,e))?(this.tokens.shift(),a):!1},consume:function(a){if(0===this.tokens.length)throw la("ueoe",this.text);var c=this.expect(a);c||this.throwError("is unexpected, expecting ["+a+"]",this.peek());return c},unaryFn:function(a,c){var d=mb[a];return z(function(a,f){return d(a,f,c)},{constant:c.constant,inputs:[c]})},binaryFn:function(a,c,d,e){var f=mb[c];return z(function(c,e){return f(c,e,a,d)},{constant:a.constant&&
d.constant,inputs:!e&&[a,d]})},identifier:function(){for(var a=this.consume().text;this.peek(".")&&this.peekAhead(1).identifier&&!this.peekAhead(2,"(");)a+=this.consume().text+this.consume().text;return zf(a,this.options,this.text)},constant:function(){var a=this.consume().value;return z(function(){return a},{constant:!0,literal:!0})},statements:function(){for(var a=[];;)if(0<this.tokens.length&&!this.peek("}",")",";","]")&&a.push(this.filterChain()),!this.expect(";"))return 1===a.length?a[0]:function(c,
d){for(var e,f=0,g=a.length;f<g;f++)e=a[f](c,d);return e}},filterChain:function(){for(var a=this.expression();this.expect("|");)a=this.filter(a);return a},filter:function(a){var c=this.$filter(this.consume().text),d,e;if(this.peek(":"))for(d=[],e=[];this.expect(":");)d.push(this.expression());var f=[a].concat(d||[]);return z(function(f,h){var l=a(f,h);if(e){e[0]=l;for(l=d.length;l--;)e[l+1]=d[l](f,h);return c.apply(t,e)}return c(l)},{constant:!c.$stateful&&f.every(ec),inputs:!c.$stateful&&f})},expression:function(){return this.assignment()},
assignment:function(){var a=this.ternary(),c,d;return(d=this.expect("="))?(a.assign||this.throwError("implies assignment but ["+this.text.substring(0,d.index)+"] can not be assigned to",d),c=this.ternary(),z(function(d,f){return a.assign(d,c(d,f),f)},{inputs:[a,c]})):a},ternary:function(){var a=this.logicalOR(),c;if(this.expect("?")&&(c=this.assignment(),this.consume(":"))){var d=this.assignment();return z(function(e,f){return a(e,f)?c(e,f):d(e,f)},{constant:a.constant&&c.constant&&d.constant})}return a},
logicalOR:function(){for(var a=this.logicalAND(),c;c=this.expect("||");)a=this.binaryFn(a,c.text,this.logicalAND(),!0);return a},logicalAND:function(){for(var a=this.equality(),c;c=this.expect("&&");)a=this.binaryFn(a,c.text,this.equality(),!0);return a},equality:function(){for(var a=this.relational(),c;c=this.expect("==","!=","===","!==");)a=this.binaryFn(a,c.text,this.relational());return a},relational:function(){for(var a=this.additive(),c;c=this.expect("<",">","<=",">=");)a=this.binaryFn(a,c.text,
this.additive());return a},additive:function(){for(var a=this.multiplicative(),c;c=this.expect("+","-");)a=this.binaryFn(a,c.text,this.multiplicative());return a},multiplicative:function(){for(var a=this.unary(),c;c=this.expect("*","/","%");)a=this.binaryFn(a,c.text,this.unary());return a},unary:function(){var a;return this.expect("+")?this.primary():(a=this.expect("-"))?this.binaryFn(hb.ZERO,a.text,this.unary()):(a=this.expect("!"))?this.unaryFn(a.text,this.unary()):this.primary()},fieldAccess:function(a){var c=
this.identifier();return z(function(d,e,f){d=f||a(d,e);return null==d?t:c(d)},{assign:function(d,e,f){var g=a(d,f);g||a.assign(d,g={},f);return c.assign(g,e)}})},objectIndex:function(a){var c=this.text,d=this.expression();this.consume("]");return z(function(e,f){var g=a(e,f),h=d(e,f);ta(h,c);return g?ma(g[h],c):t},{assign:function(e,f,g){var h=ta(d(e,g),c),l=ma(a(e,g),c);l||a.assign(e,l={},g);return l[h]=f}})},functionCall:function(a,c){var d=[];if(")"!==this.peekToken().text){do d.push(this.expression());
while(this.expect(","))}this.consume(")");var e=this.text,f=d.length?[]:null;return function(g,h){var l=c?c(g,h):y(c)?t:g,k=a(g,h,l)||H;if(f)for(var m=d.length;m--;)f[m]=ma(d[m](g,h),e);ma(l,e);if(k){if(k.constructor===k)throw la("isecfn",e);if(k===Uf||k===Vf||k===Wf)throw la("isecff",e);}l=k.apply?k.apply(l,f):k(f[0],f[1],f[2],f[3],f[4]);return ma(l,e)}},arrayDeclaration:function(){var a=[];if("]"!==this.peekToken().text){do{if(this.peek("]"))break;a.push(this.expression())}while(this.expect(","))
}this.consume("]");return z(function(c,d){for(var e=[],f=0,g=a.length;f<g;f++)e.push(a[f](c,d));return e},{literal:!0,constant:a.every(ec),inputs:a})},object:function(){var a=[],c=[];if("}"!==this.peekToken().text){do{if(this.peek("}"))break;var d=this.consume();d.constant?a.push(d.value):d.identifier?a.push(d.text):this.throwError("invalid key",d);this.consume(":");c.push(this.expression())}while(this.expect(","))}this.consume("}");return z(function(d,f){for(var g={},h=0,l=c.length;h<l;h++)g[a[h]]=
c[h](d,f);return g},{literal:!0,constant:c.every(ec),inputs:c})}};var Bf=ha(),Af=ha(),Cf=Object.prototype.valueOf,Ca=T("$sce"),na={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},ja=T("$compile"),Z=Y.createElement("a"),id=Ba(M.location.href);Dc.$inject=["$provide"];jd.$inject=["$locale"];ld.$inject=["$locale"];var od=".",Mf={yyyy:$("FullYear",4),yy:$("FullYear",2,0,!0),y:$("FullYear",1),MMMM:Ib("Month"),MMM:Ib("Month",!0),MM:$("Month",2,1),M:$("Month",1,1),dd:$("Date",2),d:$("Date",
1),HH:$("Hours",2),H:$("Hours",1),hh:$("Hours",2,-12),h:$("Hours",1,-12),mm:$("Minutes",2),m:$("Minutes",1),ss:$("Seconds",2),s:$("Seconds",1),sss:$("Milliseconds",3),EEEE:Ib("Day"),EEE:Ib("Day",!0),a:function(a,c){return 12>a.getHours()?c.AMPMS[0]:c.AMPMS[1]},Z:function(a){a=-1*a.getTimezoneOffset();return a=(0<=a?"+":"")+(Hb(Math[0<a?"floor":"ceil"](a/60),2)+Hb(Math.abs(a%60),2))},ww:qd(2),w:qd(1)},Lf=/((?:[^yMdHhmsaZEw']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z|w+))(.*)/,Kf=/^\-?\d+$/;
kd.$inject=["$locale"];var Hf=da(Q),If=da(ub);md.$inject=["$parse"];var Td=da({restrict:"E",compile:function(a,c){if(!c.href&&!c.xlinkHref&&!c.name)return function(a,c){var f="[object SVGAnimatedString]"===Da.call(c.prop("href"))?"xlink:href":"href";c.on("click",function(a){c.attr(f)||a.preventDefault()})}}}),vb={};s(Eb,function(a,c){if("multiple"!=a){var d=ya("ng-"+c);vb[d]=function(){return{restrict:"A",priority:100,link:function(a,f,g){a.$watch(g[d],function(a){g.$set(c,!!a)})}}}}});s(Nc,function(a,
c){vb[c]=function(){return{priority:100,link:function(a,e,f){if("ngPattern"===c&&"/"==f.ngPattern.charAt(0)&&(e=f.ngPattern.match(Of))){f.$set("ngPattern",new RegExp(e[1],e[2]));return}a.$watch(f[c],function(a){f.$set(c,a)})}}}});s(["src","srcset","href"],function(a){var c=ya("ng-"+a);vb[c]=function(){return{priority:99,link:function(d,e,f){var g=a,h=a;"href"===a&&"[object SVGAnimatedString]"===Da.call(e.prop("href"))&&(h="xlinkHref",f.$attr[h]="xlink:href",g=null);f.$observe(c,function(c){c?(f.$set(h,
c),Ra&&g&&e.prop(g,f[h])):"href"===a&&f.$set(h,null)})}}}});var Jb={$addControl:H,$$renameControl:function(a,c){a.$name=c},$removeControl:H,$setValidity:H,$setDirty:H,$setPristine:H,$setSubmitted:H};rd.$inject=["$element","$attrs","$scope","$animate","$interpolate"];var yd=function(a){return["$timeout",function(c){return{name:"form",restrict:a?"EAC":"E",controller:rd,compile:function(a){a.addClass(Sa).addClass(kb);return{pre:function(a,d,g,h){if(!("action"in g)){var l=function(c){a.$apply(function(){h.$commitViewValue();
h.$setSubmitted()});c.preventDefault()};d[0].addEventListener("submit",l,!1);d.on("$destroy",function(){c(function(){d[0].removeEventListener("submit",l,!1)},0,!1)})}var k=h.$$parentForm,m=h.$name;m&&(gb(a,null,m,h,m),g.$observe(g.name?"name":"ngForm",function(c){m!==c&&(gb(a,null,m,t,m),m=c,gb(a,null,m,h,m),k.$$renameControl(h,m))}));d.on("$destroy",function(){k.$removeControl(h);m&&gb(a,null,m,t,m);z(h,Jb)})}}}}}]},Ud=yd(),ge=yd(!0),Nf=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z)/,
Yf=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,Zf=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,$f=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,zd=/^(\d{4})-(\d{2})-(\d{2})$/,Ad=/^(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,jc=/^(\d{4})-W(\d\d)$/,Bd=/^(\d{4})-(\d\d)$/,Cd=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,Dd={text:function(a,c,d,e,f,g){ib(a,c,d,e,f,g);hc(e)},date:jb("date",zd,Lb(zd,["yyyy",
"MM","dd"]),"yyyy-MM-dd"),"datetime-local":jb("datetimelocal",Ad,Lb(Ad,"yyyy MM dd HH mm ss sss".split(" ")),"yyyy-MM-ddTHH:mm:ss.sss"),time:jb("time",Cd,Lb(Cd,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:jb("week",jc,function(a,c){if(qa(a))return a;if(F(a)){jc.lastIndex=0;var d=jc.exec(a);if(d){var e=+d[1],f=+d[2],g=d=0,h=0,l=0,k=pd(e),f=7*(f-1);c&&(d=c.getHours(),g=c.getMinutes(),h=c.getSeconds(),l=c.getMilliseconds());return new Date(e,0,k.getDate()+f,d,g,h,l)}}return NaN},"yyyy-Www"),month:jb("month",
Bd,Lb(Bd,["yyyy","MM"]),"yyyy-MM"),number:function(a,c,d,e,f,g){td(a,c,d,e);ib(a,c,d,e,f,g);e.$$parserName="number";e.$parsers.push(function(a){return e.$isEmpty(a)?null:$f.test(a)?parseFloat(a):t});e.$formatters.push(function(a){if(!e.$isEmpty(a)){if(!V(a))throw Mb("numfmt",a);a=a.toString()}return a});if(d.min||d.ngMin){var h;e.$validators.min=function(a){return e.$isEmpty(a)||A(h)||a>=h};d.$observe("min",function(a){y(a)&&!V(a)&&(a=parseFloat(a,10));h=V(a)&&!isNaN(a)?a:t;e.$validate()})}if(d.max||
d.ngMax){var l;e.$validators.max=function(a){return e.$isEmpty(a)||A(l)||a<=l};d.$observe("max",function(a){y(a)&&!V(a)&&(a=parseFloat(a,10));l=V(a)&&!isNaN(a)?a:t;e.$validate()})}},url:function(a,c,d,e,f,g){ib(a,c,d,e,f,g);hc(e);e.$$parserName="url";e.$validators.url=function(a,c){var d=a||c;return e.$isEmpty(d)||Yf.test(d)}},email:function(a,c,d,e,f,g){ib(a,c,d,e,f,g);hc(e);e.$$parserName="email";e.$validators.email=function(a,c){var d=a||c;return e.$isEmpty(d)||Zf.test(d)}},radio:function(a,c,
d,e){A(d.name)&&c.attr("name",++nb);c.on("click",function(a){c[0].checked&&e.$setViewValue(d.value,a&&a.type)});e.$render=function(){c[0].checked=d.value==e.$viewValue};d.$observe("value",e.$render)},checkbox:function(a,c,d,e,f,g,h,l){var k=ud(l,a,"ngTrueValue",d.ngTrueValue,!0),m=ud(l,a,"ngFalseValue",d.ngFalseValue,!1);c.on("click",function(a){e.$setViewValue(c[0].checked,a&&a.type)});e.$render=function(){c[0].checked=e.$viewValue};e.$isEmpty=function(a){return!1===a};e.$formatters.push(function(a){return fa(a,
k)});e.$parsers.push(function(a){return a?k:m})},hidden:H,button:H,submit:H,reset:H,file:H},xc=["$browser","$sniffer","$filter","$parse",function(a,c,d,e){return{restrict:"E",require:["?ngModel"],link:{pre:function(f,g,h,l){l[0]&&(Dd[Q(h.type)]||Dd.text)(f,g,h,l[0],c,a,d,e)}}}}],ag=/^(true|false|\d+)$/,ye=function(){return{restrict:"A",priority:100,compile:function(a,c){return ag.test(c.ngValue)?function(a,c,f){f.$set("value",a.$eval(f.ngValue))}:function(a,c,f){a.$watch(f.ngValue,function(a){f.$set("value",
a)})}}}},Zd=["$compile",function(a){return{restrict:"AC",compile:function(c){a.$$addBindingClass(c);return function(c,e,f){a.$$addBindingInfo(e,f.ngBind);e=e[0];c.$watch(f.ngBind,function(a){e.textContent=a===t?"":a})}}}}],ae=["$interpolate","$compile",function(a,c){return{compile:function(d){c.$$addBindingClass(d);return function(d,f,g){d=a(f.attr(g.$attr.ngBindTemplate));c.$$addBindingInfo(f,d.expressions);f=f[0];g.$observe("ngBindTemplate",function(a){f.textContent=a===t?"":a})}}}}],$d=["$sce",
"$parse","$compile",function(a,c,d){return{restrict:"A",compile:function(e,f){var g=c(f.ngBindHtml),h=c(f.ngBindHtml,function(a){return(a||"").toString()});d.$$addBindingClass(e);return function(c,e,f){d.$$addBindingInfo(e,f.ngBindHtml);c.$watch(h,function(){e.html(a.getTrustedHtml(g(c))||"")})}}}}],xe=da({restrict:"A",require:"ngModel",link:function(a,c,d,e){e.$viewChangeListeners.push(function(){a.$eval(d.ngChange)})}}),be=ic("",!0),de=ic("Odd",0),ce=ic("Even",1),ee=Ja({compile:function(a,c){c.$set("ngCloak",
t);a.removeClass("ng-cloak")}}),fe=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],Cc={},bg={blur:!0,focus:!0};s("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(a){var c=ya("ng-"+a);Cc[c]=["$parse","$rootScope",function(d,e){return{restrict:"A",compile:function(f,g){var h=d(g[c],null,!0);return function(c,d){d.on(a,function(d){var f=function(){h(c,{$event:d})};
bg[a]&&e.$$phase?c.$evalAsync(f):c.$apply(f)})}}}}]});var ie=["$animate",function(a){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(c,d,e,f,g){var h,l,k;c.$watch(e.ngIf,function(c){c?l||g(function(c,f){l=f;c[c.length++]=Y.createComment(" end ngIf: "+e.ngIf+" ");h={clone:c};a.enter(c,d.parent(),d)}):(k&&(k.remove(),k=null),l&&(l.$destroy(),l=null),h&&(k=tb(h.clone),a.leave(k).then(function(){k=null}),h=null))})}}}],je=["$templateRequest","$anchorScroll",
"$animate","$sce",function(a,c,d,e){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:ga.noop,compile:function(f,g){var h=g.ngInclude||g.src,l=g.onload||"",k=g.autoscroll;return function(f,g,q,s,r){var t=0,n,v,w,L=function(){v&&(v.remove(),v=null);n&&(n.$destroy(),n=null);w&&(d.leave(w).then(function(){v=null}),v=w,w=null)};f.$watch(e.parseAsResourceUrl(h),function(e){var h=function(){!y(k)||k&&!f.$eval(k)||c()},q=++t;e?(a(e,!0).then(function(a){if(q===t){var c=f.$new();
s.template=a;a=r(c,function(a){L();d.enter(a,null,g).then(h)});n=c;w=a;n.$emit("$includeContentLoaded",e);f.$eval(l)}},function(){q===t&&(L(),f.$emit("$includeContentError",e))}),f.$emit("$includeContentRequested",e)):(L(),s.template=null)})}}}}],Ae=["$compile",function(a){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(c,d,e,f){/SVG/.test(d[0].toString())?(d.empty(),a(Fc(f.template,Y).childNodes)(c,function(a){d.append(a)},{futureParentElement:d})):(d.html(f.template),a(d.contents())(c))}}}],
ke=Ja({priority:450,compile:function(){return{pre:function(a,c,d){a.$eval(d.ngInit)}}}}),we=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(a,c,d,e){var f=c.attr(d.$attr.ngList)||", ",g="false"!==d.ngTrim,h=g?U(f):f;e.$parsers.push(function(a){if(!A(a)){var c=[];a&&s(a.split(h),function(a){a&&c.push(g?U(a):a)});return c}});e.$formatters.push(function(a){return D(a)?a.join(f):t});e.$isEmpty=function(a){return!a||!a.length}}}},kb="ng-valid",vd="ng-invalid",Sa="ng-pristine",
Kb="ng-dirty",xd="ng-pending",Mb=new T("ngModel"),cg=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$rootScope","$q","$interpolate",function(a,c,d,e,f,g,h,l,k,m){this.$modelValue=this.$viewValue=Number.NaN;this.$$rawModelValue=t;this.$validators={};this.$asyncValidators={};this.$parsers=[];this.$formatters=[];this.$viewChangeListeners=[];this.$untouched=!0;this.$touched=!1;this.$pristine=!0;this.$dirty=!1;this.$valid=!0;this.$invalid=!1;this.$error={};this.$$success=
{};this.$pending=t;this.$name=m(d.name||"",!1)(a);var p=f(d.ngModel),q=p.assign,u=p,r=q,O=null,n=this;this.$$setOptions=function(a){if((n.$options=a)&&a.getterSetter){var c=f(d.ngModel+"()"),g=f(d.ngModel+"($$$p)");u=function(a){var d=p(a);G(d)&&(d=c(a));return d};r=function(a,c){G(p(a))?g(a,{$$$p:n.$modelValue}):q(a,n.$modelValue)}}else if(!p.assign)throw Mb("nonassign",d.ngModel,va(e));};this.$render=H;this.$isEmpty=function(a){return A(a)||""===a||null===a||a!==a};var v=e.inheritedData("$formController")||
Jb,w=0;sd({ctrl:this,$element:e,set:function(a,c){a[c]=!0},unset:function(a,c){delete a[c]},parentForm:v,$animate:g});this.$setPristine=function(){n.$dirty=!1;n.$pristine=!0;g.removeClass(e,Kb);g.addClass(e,Sa)};this.$setDirty=function(){n.$dirty=!0;n.$pristine=!1;g.removeClass(e,Sa);g.addClass(e,Kb);v.$setDirty()};this.$setUntouched=function(){n.$touched=!1;n.$untouched=!0;g.setClass(e,"ng-untouched","ng-touched")};this.$setTouched=function(){n.$touched=!0;n.$untouched=!1;g.setClass(e,"ng-touched",
"ng-untouched")};this.$rollbackViewValue=function(){h.cancel(O);n.$viewValue=n.$$lastCommittedViewValue;n.$render()};this.$validate=function(){if(!V(n.$modelValue)||!isNaN(n.$modelValue)){var a=n.$$rawModelValue,c=n.$valid,d=n.$modelValue,e=n.$options&&n.$options.allowInvalid;n.$$runValidators(n.$error[n.$$parserName||"parse"]?!1:t,a,n.$$lastCommittedViewValue,function(f){e||c===f||(n.$modelValue=f?a:t,n.$modelValue!==d&&n.$$writeModelToScope())})}};this.$$runValidators=function(a,c,d,e){function f(){var a=
!0;s(n.$validators,function(e,f){var g=e(c,d);a=a&&g;h(f,g)});return a?!0:(s(n.$asyncValidators,function(a,c){h(c,null)}),!1)}function g(){var a=[],e=!0;s(n.$asyncValidators,function(f,g){var l=f(c,d);if(!l||!G(l.then))throw Mb("$asyncValidators",l);h(g,t);a.push(l.then(function(){h(g,!0)},function(a){e=!1;h(g,!1)}))});a.length?k.all(a).then(function(){l(e)},H):l(!0)}function h(a,c){m===w&&n.$setValidity(a,c)}function l(a){m===w&&e(a)}w++;var m=w;(function(a){var c=n.$$parserName||"parse";if(a===
t)h(c,null);else if(h(c,a),!a)return s(n.$validators,function(a,c){h(c,null)}),s(n.$asyncValidators,function(a,c){h(c,null)}),!1;return!0})(a)?f()?g():l(!1):l(!1)};this.$commitViewValue=function(){var a=n.$viewValue;h.cancel(O);if(n.$$lastCommittedViewValue!==a||""===a&&n.$$hasNativeValidators)n.$$lastCommittedViewValue=a,n.$pristine&&this.$setDirty(),this.$$parseAndValidate()};this.$$parseAndValidate=function(){var c=n.$$lastCommittedViewValue,d=A(c)?t:!0;if(d)for(var e=0;e<n.$parsers.length;e++)if(c=
n.$parsers[e](c),A(c)){d=!1;break}V(n.$modelValue)&&isNaN(n.$modelValue)&&(n.$modelValue=u(a));var f=n.$modelValue,g=n.$options&&n.$options.allowInvalid;n.$$rawModelValue=c;g&&(n.$modelValue=c,n.$modelValue!==f&&n.$$writeModelToScope());n.$$runValidators(d,c,n.$$lastCommittedViewValue,function(a){g||(n.$modelValue=a?c:t,n.$modelValue!==f&&n.$$writeModelToScope())})};this.$$writeModelToScope=function(){r(a,n.$modelValue);s(n.$viewChangeListeners,function(a){try{a()}catch(d){c(d)}})};this.$setViewValue=
function(a,c){n.$viewValue=a;n.$options&&!n.$options.updateOnDefault||n.$$debounceViewValueCommit(c)};this.$$debounceViewValueCommit=function(c){var d=0,e=n.$options;e&&y(e.debounce)&&(e=e.debounce,V(e)?d=e:V(e[c])?d=e[c]:V(e["default"])&&(d=e["default"]));h.cancel(O);d?O=h(function(){n.$commitViewValue()},d):l.$$phase?n.$commitViewValue():a.$apply(function(){n.$commitViewValue()})};a.$watch(function(){var c=u(a);if(c!==n.$modelValue){n.$modelValue=n.$$rawModelValue=c;for(var d=n.$formatters,e=d.length,
f=c;e--;)f=d[e](f);n.$viewValue!==f&&(n.$viewValue=n.$$lastCommittedViewValue=f,n.$render(),n.$$runValidators(t,c,f,H))}return c})}],ve=["$rootScope",function(a){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:cg,priority:1,compile:function(c){c.addClass(Sa).addClass("ng-untouched").addClass(kb);return{pre:function(a,c,f,g){var h=g[0],l=g[1]||Jb;h.$$setOptions(g[2]&&g[2].$options);l.$addControl(h);f.$observe("name",function(a){h.$name!==a&&l.$$renameControl(h,a)});a.$on("$destroy",
function(){l.$removeControl(h)})},post:function(c,e,f,g){var h=g[0];if(h.$options&&h.$options.updateOn)e.on(h.$options.updateOn,function(a){h.$$debounceViewValueCommit(a&&a.type)});e.on("blur",function(e){h.$touched||(a.$$phase?c.$evalAsync(h.$setTouched):c.$apply(h.$setTouched))})}}}}}],dg=/(\s+|^)default(\s+|$)/,ze=function(){return{restrict:"A",controller:["$scope","$attrs",function(a,c){var d=this;this.$options=a.$eval(c.ngModelOptions);this.$options.updateOn!==t?(this.$options.updateOnDefault=
!1,this.$options.updateOn=U(this.$options.updateOn.replace(dg,function(){d.$options.updateOnDefault=!0;return" "}))):this.$options.updateOnDefault=!0}]}},le=Ja({terminal:!0,priority:1E3}),me=["$locale","$interpolate",function(a,c){var d=/{}/g,e=/^when(Minus)?(.+)$/;return{restrict:"EA",link:function(f,g,h){function l(a){g.text(a||"")}var k=h.count,m=h.$attr.when&&g.attr(h.$attr.when),p=h.offset||0,q=f.$eval(m)||{},u={},m=c.startSymbol(),r=c.endSymbol(),t=m+k+"-"+p+r,n=ga.noop,v;s(h,function(a,c){var d=
e.exec(c);d&&(d=(d[1]?"-":"")+Q(d[2]),q[d]=g.attr(h.$attr[c]))});s(q,function(a,e){u[e]=c(a.replace(d,t))});f.$watch(k,function(c){c=parseFloat(c);var d=isNaN(c);d||c in q||(c=a.pluralCat(c-p));c===v||d&&isNaN(v)||(n(),n=f.$watch(u[c],l),v=c)})}}}],ne=["$parse","$animate",function(a,c){var d=T("ngRepeat"),e=function(a,c,d,e,k,m,p){a[d]=e;k&&(a[k]=m);a.$index=c;a.$first=0===c;a.$last=c===p-1;a.$middle=!(a.$first||a.$last);a.$odd=!(a.$even=0===(c&1))};return{restrict:"A",multiElement:!0,transclude:"element",
priority:1E3,terminal:!0,$$tlb:!0,compile:function(f,g){var h=g.ngRepeat,l=Y.createComment(" end ngRepeat: "+h+" "),k=h.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!k)throw d("iexp",h);var m=k[1],p=k[2],q=k[3],u=k[4],k=m.match(/^(?:(\s*[\$\w]+)|\(\s*([\$\w]+)\s*,\s*([\$\w]+)\s*\))$/);if(!k)throw d("iidexp",m);var r=k[3]||k[1],y=k[2];if(q&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(q)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent)$/.test(q)))throw d("badident",
q);var n,v,w,A,z={$id:Na};u?n=a(u):(w=function(a,c){return Na(c)},A=function(a){return a});return function(a,f,g,k,m){n&&(v=function(c,d,e){y&&(z[y]=c);z[r]=d;z.$index=e;return n(a,z)});var u=ha();a.$watchCollection(p,function(g){var k,p,n=f[0],E,z=ha(),H,S,N,D,G,C,I;q&&(a[q]=g);if(Ta(g))G=g,p=v||w;else{p=v||A;G=[];for(I in g)g.hasOwnProperty(I)&&"$"!=I.charAt(0)&&G.push(I);G.sort()}H=G.length;I=Array(H);for(k=0;k<H;k++)if(S=g===G?k:G[k],N=g[S],D=p(S,N,k),u[D])C=u[D],delete u[D],z[D]=C,I[k]=C;else{if(z[D])throw s(I,
function(a){a&&a.scope&&(u[a.id]=a)}),d("dupes",h,D,N);I[k]={id:D,scope:t,clone:t};z[D]=!0}for(E in u){C=u[E];D=tb(C.clone);c.leave(D);if(D[0].parentNode)for(k=0,p=D.length;k<p;k++)D[k].$$NG_REMOVED=!0;C.scope.$destroy()}for(k=0;k<H;k++)if(S=g===G?k:G[k],N=g[S],C=I[k],C.scope){E=n;do E=E.nextSibling;while(E&&E.$$NG_REMOVED);C.clone[0]!=E&&c.move(tb(C.clone),null,B(n));n=C.clone[C.clone.length-1];e(C.scope,k,r,N,y,S,H)}else m(function(a,d){C.scope=d;var f=l.cloneNode(!1);a[a.length++]=f;c.enter(a,
null,B(n));n=f;C.clone=a;z[C.id]=C;e(C.scope,k,r,N,y,S,H)});u=z})}}}}],oe=["$animate",function(a){return{restrict:"A",multiElement:!0,link:function(c,d,e){c.$watch(e.ngShow,function(c){a[c?"removeClass":"addClass"](d,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],he=["$animate",function(a){return{restrict:"A",multiElement:!0,link:function(c,d,e){c.$watch(e.ngHide,function(c){a[c?"addClass":"removeClass"](d,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],pe=Ja(function(a,c,d){a.$watchCollection(d.ngStyle,
function(a,d){d&&a!==d&&s(d,function(a,d){c.css(d,"")});a&&c.css(a)})}),qe=["$animate",function(a){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(c,d,e,f){var g=[],h=[],l=[],k=[],m=function(a,c){return function(){a.splice(c,1)}};c.$watch(e.ngSwitch||e.on,function(c){var d,e;d=0;for(e=l.length;d<e;++d)a.cancel(l[d]);d=l.length=0;for(e=k.length;d<e;++d){var r=tb(h[d].clone);k[d].$destroy();(l[d]=a.leave(r)).then(m(l,d))}h.length=0;k.length=0;(g=
f.cases["!"+c]||f.cases["?"])&&s(g,function(c){c.transclude(function(d,e){k.push(e);var f=c.element;d[d.length++]=Y.createComment(" end ngSwitchWhen: ");h.push({clone:d});a.enter(d,f.parent(),f)})})})}}}],re=Ja({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(a,c,d,e,f){e.cases["!"+d.ngSwitchWhen]=e.cases["!"+d.ngSwitchWhen]||[];e.cases["!"+d.ngSwitchWhen].push({transclude:f,element:c})}}),se=Ja({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,
link:function(a,c,d,e,f){e.cases["?"]=e.cases["?"]||[];e.cases["?"].push({transclude:f,element:c})}}),ue=Ja({restrict:"EAC",link:function(a,c,d,e,f){if(!f)throw T("ngTransclude")("orphan",va(c));f(function(a){c.empty();c.append(a)})}}),Vd=["$templateCache",function(a){return{restrict:"E",terminal:!0,compile:function(c,d){"text/ng-template"==d.type&&a.put(d.id,c[0].text)}}}],eg=T("ngOptions"),te=da({restrict:"A",terminal:!0}),Wd=["$compile","$parse",function(a,c){var d=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,
e={$setViewValue:H};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function(a,c,d){var l=this,k={},m=e,p;l.databound=d.ngModel;l.init=function(a,c,d){m=a;p=d};l.addOption=function(c,d){Ma(c,'"option value"');k[c]=!0;m.$viewValue==c&&(a.val(c),p.parent()&&p.remove());d&&d[0].hasAttribute("selected")&&(d[0].selected=!0)};l.removeOption=function(a){this.hasOption(a)&&(delete k[a],m.$viewValue===a&&this.renderUnknownOption(a))};l.renderUnknownOption=function(c){c=
"? "+Na(c)+" ?";p.val(c);a.prepend(p);a.val(c);p.prop("selected",!0)};l.hasOption=function(a){return k.hasOwnProperty(a)};c.$on("$destroy",function(){l.renderUnknownOption=H})}],link:function(e,g,h,l){function k(a,c,d,e){d.$render=function(){var a=d.$viewValue;e.hasOption(a)?(C.parent()&&C.remove(),c.val(a),""===a&&n.prop("selected",!0)):A(a)&&n?c.val(""):e.renderUnknownOption(a)};c.on("change",function(){a.$apply(function(){C.parent()&&C.remove();d.$setViewValue(c.val())})})}function m(a,c,d){var e;
d.$render=function(){var a=new db(d.$viewValue);s(c.find("option"),function(c){c.selected=y(a.get(c.value))})};a.$watch(function(){fa(e,d.$viewValue)||(e=ra(d.$viewValue),d.$render())});c.on("change",function(){a.$apply(function(){var a=[];s(c.find("option"),function(c){c.selected&&a.push(c.value)});d.$setViewValue(a)})})}function p(e,f,g){function h(a,c,d){T[x]=d;G&&(T[G]=c);return a(e,T)}function k(a){var c;if(u)if(M&&D(a)){c=new db([]);for(var d=0;d<a.length;d++)c.put(h(M,null,a[d]),!0)}else c=
new db(a);else M&&(a=h(M,null,a));return function(d,e){var f;f=M?M:B?B:F;return u?y(c.remove(h(f,d,e))):a===h(f,d,e)}}function l(){v||(e.$$postDigest(p),v=!0)}function m(a,c,d){a[c]=a[c]||0;a[c]+=d?1:-1}function p(){v=!1;var a={"":[]},c=[""],d,l,n,r,t;n=g.$viewValue;r=P(e)||[];var B=G?Object.keys(r).sort():r,x,A,D,F,N={};t=k(n);var J=!1,U,V;Q={};for(F=0;D=B.length,F<D;F++){x=F;if(G&&(x=B[F],"$"===x.charAt(0)))continue;A=r[x];d=h(I,x,A)||"";(l=a[d])||(l=a[d]=[],c.push(d));d=t(x,A);J=J||d;A=h(C,x,A);
A=y(A)?A:"";V=M?M(e,T):G?B[F]:F;M&&(Q[V]=x);l.push({id:V,label:A,selected:d})}u||(z||null===n?a[""].unshift({id:"",label:"",selected:!J}):J||a[""].unshift({id:"?",label:"",selected:!0}));x=0;for(B=c.length;x<B;x++){d=c[x];l=a[d];R.length<=x?(n={element:H.clone().attr("label",d),label:l.label},r=[n],R.push(r),f.append(n.element)):(r=R[x],n=r[0],n.label!=d&&n.element.attr("label",n.label=d));J=null;F=0;for(D=l.length;F<D;F++)d=l[F],(t=r[F+1])?(J=t.element,t.label!==d.label&&(m(N,t.label,!1),m(N,d.label,
!0),J.text(t.label=d.label),J.prop("label",t.label)),t.id!==d.id&&J.val(t.id=d.id),J[0].selected!==d.selected&&(J.prop("selected",t.selected=d.selected),Ra&&J.prop("selected",t.selected))):(""===d.id&&z?U=z:(U=w.clone()).val(d.id).prop("selected",d.selected).attr("selected",d.selected).prop("label",d.label).text(d.label),r.push(t={element:U,label:d.label,id:d.id,selected:d.selected}),m(N,d.label,!0),J?J.after(U):n.element.append(U),J=U);for(F++;r.length>F;)d=r.pop(),m(N,d.label,!1),d.element.remove()}for(;R.length>
x;){l=R.pop();for(F=1;F<l.length;++F)m(N,l[F].label,!1);l[0].element.remove()}s(N,function(a,c){0<a?q.addOption(c):0>a&&q.removeOption(c)})}var n;if(!(n=r.match(d)))throw eg("iexp",r,va(f));var C=c(n[2]||n[1]),x=n[4]||n[6],A=/ as /.test(n[0])&&n[1],B=A?c(A):null,G=n[5],I=c(n[3]||""),F=c(n[2]?n[1]:x),P=c(n[7]),M=n[8]?c(n[8]):null,Q={},R=[[{element:f,label:""}]],T={};z&&(a(z)(e),z.removeClass("ng-scope"),z.remove());f.empty();f.on("change",function(){e.$apply(function(){var a=P(e)||[],c;if(u)c=[],s(f.val(),
function(d){d=M?Q[d]:d;c.push("?"===d?t:""===d?null:h(B?B:F,d,a[d]))});else{var d=M?Q[f.val()]:f.val();c="?"===d?t:""===d?null:h(B?B:F,d,a[d])}g.$setViewValue(c);p()})});g.$render=p;e.$watchCollection(P,l);e.$watchCollection(function(){var a=P(e),c;if(a&&D(a)){c=Array(a.length);for(var d=0,f=a.length;d<f;d++)c[d]=h(C,d,a[d])}else if(a)for(d in c={},a)a.hasOwnProperty(d)&&(c[d]=h(C,d,a[d]));return c},l);u&&e.$watchCollection(function(){return g.$modelValue},l)}if(l[1]){var q=l[0];l=l[1];var u=h.multiple,
r=h.ngOptions,z=!1,n,v=!1,w=B(Y.createElement("option")),H=B(Y.createElement("optgroup")),C=w.clone();h=0;for(var x=g.children(),G=x.length;h<G;h++)if(""===x[h].value){n=z=x.eq(h);break}q.init(l,z,C);u&&(l.$isEmpty=function(a){return!a||0===a.length});r?p(e,g,l):u?m(e,g,l):k(e,g,l,q)}}}}],Yd=["$interpolate",function(a){var c={addOption:H,removeOption:H};return{restrict:"E",priority:100,compile:function(d,e){if(A(e.value)){var f=a(d.text(),!0);f||e.$set("value",d.text())}return function(a,d,e){var k=
d.parent(),m=k.data("$selectController")||k.parent().data("$selectController");m&&m.databound||(m=c);f?a.$watch(f,function(a,c){e.$set("value",a);c!==a&&m.removeOption(c);m.addOption(a,d)}):m.addOption(e.value,d);d.on("$destroy",function(){m.removeOption(e.value)})}}}}],Xd=da({restrict:"E",terminal:!1}),zc=function(){return{restrict:"A",require:"?ngModel",link:function(a,c,d,e){e&&(d.required=!0,e.$validators.required=function(a,c){return!d.required||!e.$isEmpty(c)},d.$observe("required",function(){e.$validate()}))}}},
yc=function(){return{restrict:"A",require:"?ngModel",link:function(a,c,d,e){if(e){var f,g=d.ngPattern||d.pattern;d.$observe("pattern",function(a){F(a)&&0<a.length&&(a=new RegExp("^"+a+"$"));if(a&&!a.test)throw T("ngPattern")("noregexp",g,a,va(c));f=a||t;e.$validate()});e.$validators.pattern=function(a){return e.$isEmpty(a)||A(f)||f.test(a)}}}}},Bc=function(){return{restrict:"A",require:"?ngModel",link:function(a,c,d,e){if(e){var f=-1;d.$observe("maxlength",function(a){a=ba(a);f=isNaN(a)?-1:a;e.$validate()});
e.$validators.maxlength=function(a,c){return 0>f||e.$isEmpty(a)||c.length<=f}}}}},Ac=function(){return{restrict:"A",require:"?ngModel",link:function(a,c,d,e){if(e){var f=0;d.$observe("minlength",function(a){f=ba(a)||0;e.$validate()});e.$validators.minlength=function(a,c){return e.$isEmpty(c)||c.length>=f}}}}};M.angular.bootstrap?console.log("WARNING: Tried to load angular more than once."):(Nd(),Pd(ga),B(Y).ready(function(){Jd(Y,sc)}))})(window,document);!window.angular.$$csp()&&window.angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}</style>');
//# sourceMappingURL=angular.min.js.map

/**
 * @license AngularJS v1.3.11
 * (c) 2010-2014 Google, Inc. http://angularjs.org
 * License: MIT
 */
(function(window, angular, undefined) {'use strict';

/* jshint maxlen: false */

/**
 * @ngdoc module
 * @name ngAnimate
 * @description
 *
 * The `ngAnimate` module provides support for JavaScript, CSS3 transition and CSS3 keyframe animation hooks within existing core and custom directives.
 *
 * <div doc-module-components="ngAnimate"></div>
 *
 * # Usage
 *
 * To see animations in action, all that is required is to define the appropriate CSS classes
 * or to register a JavaScript animation via the `myModule.animation()` function. The directives that support animation automatically are:
 * `ngRepeat`, `ngInclude`, `ngIf`, `ngSwitch`, `ngShow`, `ngHide`, `ngView` and `ngClass`. Custom directives can take advantage of animation
 * by using the `$animate` service.
 *
 * Below is a more detailed breakdown of the supported animation events provided by pre-existing ng directives:
 *
 * | Directive                                                                                                | Supported Animations                                                     |
 * |----------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|
 * | {@link ng.directive:ngRepeat#animations ngRepeat}                                                        | enter, leave and move                                                    |
 * | {@link ngRoute.directive:ngView#animations ngView}                                                       | enter and leave                                                          |
 * | {@link ng.directive:ngInclude#animations ngInclude}                                                      | enter and leave                                                          |
 * | {@link ng.directive:ngSwitch#animations ngSwitch}                                                        | enter and leave                                                          |
 * | {@link ng.directive:ngIf#animations ngIf}                                                                | enter and leave                                                          |
 * | {@link ng.directive:ngClass#animations ngClass}                                                          | add and remove (the CSS class(es) present)                               |
 * | {@link ng.directive:ngShow#animations ngShow} & {@link ng.directive:ngHide#animations ngHide}            | add and remove (the ng-hide class value)                                 |
 * | {@link ng.directive:form#animation-hooks form} & {@link ng.directive:ngModel#animation-hooks ngModel}    | add and remove (dirty, pristine, valid, invalid & all other validations) |
 * | {@link module:ngMessages#animations ngMessages}                                                          | add and remove (ng-active & ng-inactive)                                 |
 * | {@link module:ngMessages#animations ngMessage}                                                           | enter and leave                                                          |
 *
 * You can find out more information about animations upon visiting each directive page.
 *
 * Below is an example of how to apply animations to a directive that supports animation hooks:
 *
 * ```html
 * <style type="text/css">
 * .slide.ng-enter, .slide.ng-leave {
 *   -webkit-transition:0.5s linear all;
 *   transition:0.5s linear all;
 * }
 *
 * .slide.ng-enter { }        /&#42; starting animations for enter &#42;/
 * .slide.ng-enter.ng-enter-active { } /&#42; terminal animations for enter &#42;/
 * .slide.ng-leave { }        /&#42; starting animations for leave &#42;/
 * .slide.ng-leave.ng-leave-active { } /&#42; terminal animations for leave &#42;/
 * </style>
 *
 * <!--
 * the animate service will automatically add .ng-enter and .ng-leave to the element
 * to trigger the CSS transition/animations
 * -->
 * <ANY class="slide" ng-include="..."></ANY>
 * ```
 *
 * Keep in mind that, by default, if an animation is running, any child elements cannot be animated
 * until the parent element's animation has completed. This blocking feature can be overridden by
 * placing the `ng-animate-children` attribute on a parent container tag.
 *
 * ```html
 * <div class="slide-animation" ng-if="on" ng-animate-children>
 *   <div class="fade-animation" ng-if="on">
 *     <div class="explode-animation" ng-if="on">
 *        ...
 *     </div>
 *   </div>
 * </div>
 * ```
 *
 * When the `on` expression value changes and an animation is triggered then each of the elements within
 * will all animate without the block being applied to child elements.
 *
 * ## Are animations run when the application starts?
 * No they are not. When an application is bootstrapped Angular will disable animations from running to avoid
 * a frenzy of animations from being triggered as soon as the browser has rendered the screen. For this to work,
 * Angular will wait for two digest cycles until enabling animations. From there on, any animation-triggering
 * layout changes in the application will trigger animations as normal.
 *
 * In addition, upon bootstrap, if the routing system or any directives or load remote data (via $http) then Angular
 * will automatically extend the wait time to enable animations once **all** of the outbound HTTP requests
 * are complete.
 *
 * ## CSS-defined Animations
 * The animate service will automatically apply two CSS classes to the animated element and these two CSS classes
 * are designed to contain the start and end CSS styling. Both CSS transitions and keyframe animations are supported
 * and can be used to play along with this naming structure.
 *
 * The following code below demonstrates how to perform animations using **CSS transitions** with Angular:
 *
 * ```html
 * <style type="text/css">
 * /&#42;
 *  The animate class is apart of the element and the ng-enter class
 *  is attached to the element once the enter animation event is triggered
 * &#42;/
 * .reveal-animation.ng-enter {
 *  -webkit-transition: 1s linear all; /&#42; Safari/Chrome &#42;/
 *  transition: 1s linear all; /&#42; All other modern browsers and IE10+ &#42;/
 *
 *  /&#42; The animation preparation code &#42;/
 *  opacity: 0;
 * }
 *
 * /&#42;
 *  Keep in mind that you want to combine both CSS
 *  classes together to avoid any CSS-specificity
 *  conflicts
 * &#42;/
 * .reveal-animation.ng-enter.ng-enter-active {
 *  /&#42; The animation code itself &#42;/
 *  opacity: 1;
 * }
 * </style>
 *
 * <div class="view-container">
 *   <div ng-view class="reveal-animation"></div>
 * </div>
 * ```
 *
 * The following code below demonstrates how to perform animations using **CSS animations** with Angular:
 *
 * ```html
 * <style type="text/css">
 * .reveal-animation.ng-enter {
 *   -webkit-animation: enter_sequence 1s linear; /&#42; Safari/Chrome &#42;/
 *   animation: enter_sequence 1s linear; /&#42; IE10+ and Future Browsers &#42;/
 * }
 * @-webkit-keyframes enter_sequence {
 *   from { opacity:0; }
 *   to { opacity:1; }
 * }
 * @keyframes enter_sequence {
 *   from { opacity:0; }
 *   to { opacity:1; }
 * }
 * </style>
 *
 * <div class="view-container">
 *   <div ng-view class="reveal-animation"></div>
 * </div>
 * ```
 *
 * Both CSS3 animations and transitions can be used together and the animate service will figure out the correct duration and delay timing.
 *
 * Upon DOM mutation, the event class is added first (something like `ng-enter`), then the browser prepares itself to add
 * the active class (in this case `ng-enter-active`) which then triggers the animation. The animation module will automatically
 * detect the CSS code to determine when the animation ends. Once the animation is over then both CSS classes will be
 * removed from the DOM. If a browser does not support CSS transitions or CSS animations then the animation will start and end
 * immediately resulting in a DOM element that is at its final state. This final state is when the DOM element
 * has no CSS transition/animation classes applied to it.
 *
 * ### Structural transition animations
 *
 * Structural transitions (such as enter, leave and move) will always apply a `0s none` transition
 * value to force the browser into rendering the styles defined in the setup (`.ng-enter`, `.ng-leave`
 * or `.ng-move`) class. This means that any active transition animations operating on the element
 * will be cut off to make way for the enter, leave or move animation.
 *
 * ### Class-based transition animations
 *
 * Class-based transitions refer to transition animations that are triggered when a CSS class is
 * added to or removed from the element (via `$animate.addClass`, `$animate.removeClass`,
 * `$animate.setClass`, or by directives such as `ngClass`, `ngModel` and `form`).
 * They are different when compared to structural animations since they **do not cancel existing
 * animations** nor do they **block successive transitions** from rendering on the same element.
 * This distinction allows for **multiple class-based transitions** to be performed on the same element.
 *
 * In addition to ngAnimate supporting the default (natural) functionality of class-based transition
 * animations, ngAnimate also decorates the element with starting and ending CSS classes to aid the
 * developer in further styling the element throughout the transition animation. Earlier versions
 * of ngAnimate may have caused natural CSS transitions to break and not render properly due to
 * $animate temporarily blocking transitions using `0s none` in order to allow the setup CSS class
 * (the `-add` or `-remove` class) to be applied without triggering an animation. However, as of
 * **version 1.3**, this workaround has been removed with ngAnimate and all non-ngAnimate CSS
 * class transitions are compatible with ngAnimate.
 *
 * There is, however, one special case when dealing with class-based transitions in ngAnimate.
 * When rendering class-based transitions that make use of the setup and active CSS classes
 * (e.g. `.fade-add` and `.fade-add-active` for when `.fade` is added) be sure to define
 * the transition value **on the active CSS class** and not the setup class.
 *
 * ```css
 * .fade-add {
 *   /&#42; remember to place a 0s transition here
 *      to ensure that the styles are applied instantly
 *      even if the element already has a transition style &#42;/
 *   transition:0s linear all;
 *
 *   /&#42; starting CSS styles &#42;/
 *   opacity:1;
 * }
 * .fade-add.fade-add-active {
 *   /&#42; this will be the length of the animation &#42;/
 *   transition:1s linear all;
 *   opacity:0;
 * }
 * ```
 *
 * The setup CSS class (in this case `.fade-add`) also has a transition style property, however, it
 * has a duration of zero. This may not be required, however, incase the browser is unable to render
 * the styling present in this CSS class instantly then it could be that the browser is attempting
 * to perform an unnecessary transition.
 *
 * This workaround, however, does not apply to  standard class-based transitions that are rendered
 * when a CSS class containing a transition is applied to an element:
 *
 * ```css
 * /&#42; this works as expected &#42;/
 * .fade {
 *   transition:1s linear all;
 *   opacity:0;
 * }
 * ```
 *
 * Please keep this in mind when coding the CSS markup that will be used within class-based transitions.
 * Also, try not to mix the two class-based animation flavors together since the CSS code may become
 * overly complex.
 *
 *
 * ### Preventing Collisions With Third Party Libraries
 *
 * Some third-party frameworks place animation duration defaults across many element or className
 * selectors in order to make their code small and reuseable. This can lead to issues with ngAnimate, which
 * is expecting actual animations on these elements and has to wait for their completion.
 *
 * You can prevent this unwanted behavior by using a prefix on all your animation classes:
 *
 * ```css
 * /&#42; prefixed with animate- &#42;/
 * .animate-fade-add.animate-fade-add-active {
 *   transition:1s linear all;
 *   opacity:0;
 * }
 * ```
 *
 * You then configure `$animate` to enforce this prefix:
 *
 * ```js
 * $animateProvider.classNameFilter(/animate-/);
 * ```
 * </div>
 *
 * ### CSS Staggering Animations
 * A Staggering animation is a collection of animations that are issued with a slight delay in between each successive operation resulting in a
 * curtain-like effect. The ngAnimate module (versions >=1.2) supports staggering animations and the stagger effect can be
 * performed by creating a **ng-EVENT-stagger** CSS class and attaching that class to the base CSS class used for
 * the animation. The style property expected within the stagger class can either be a **transition-delay** or an
 * **animation-delay** property (or both if your animation contains both transitions and keyframe animations).
 *
 * ```css
 * .my-animation.ng-enter {
 *   /&#42; standard transition code &#42;/
 *   -webkit-transition: 1s linear all;
 *   transition: 1s linear all;
 *   opacity:0;
 * }
 * .my-animation.ng-enter-stagger {
 *   /&#42; this will have a 100ms delay between each successive leave animation &#42;/
 *   -webkit-transition-delay: 0.1s;
 *   transition-delay: 0.1s;
 *
 *   /&#42; in case the stagger doesn't work then these two values
 *    must be set to 0 to avoid an accidental CSS inheritance &#42;/
 *   -webkit-transition-duration: 0s;
 *   transition-duration: 0s;
 * }
 * .my-animation.ng-enter.ng-enter-active {
 *   /&#42; standard transition styles &#42;/
 *   opacity:1;
 * }
 * ```
 *
 * Staggering animations work by default in ngRepeat (so long as the CSS class is defined). Outside of ngRepeat, to use staggering animations
 * on your own, they can be triggered by firing multiple calls to the same event on $animate. However, the restrictions surrounding this
 * are that each of the elements must have the same CSS className value as well as the same parent element. A stagger operation
 * will also be reset if more than 10ms has passed after the last animation has been fired.
 *
 * The following code will issue the **ng-leave-stagger** event on the element provided:
 *
 * ```js
 * var kids = parent.children();
 *
 * $animate.leave(kids[0]); //stagger index=0
 * $animate.leave(kids[1]); //stagger index=1
 * $animate.leave(kids[2]); //stagger index=2
 * $animate.leave(kids[3]); //stagger index=3
 * $animate.leave(kids[4]); //stagger index=4
 *
 * $timeout(function() {
 *   //stagger has reset itself
 *   $animate.leave(kids[5]); //stagger index=0
 *   $animate.leave(kids[6]); //stagger index=1
 * }, 100, false);
 * ```
 *
 * Stagger animations are currently only supported within CSS-defined animations.
 *
 * ## JavaScript-defined Animations
 * In the event that you do not want to use CSS3 transitions or CSS3 animations or if you wish to offer animations on browsers that do not
 * yet support CSS transitions/animations, then you can make use of JavaScript animations defined inside of your AngularJS module.
 *
 * ```js
 * //!annotate="YourApp" Your AngularJS Module|Replace this or ngModule with the module that you used to define your application.
 * var ngModule = angular.module('YourApp', ['ngAnimate']);
 * ngModule.animation('.my-crazy-animation', function() {
 *   return {
 *     enter: function(element, done) {
 *       //run the animation here and call done when the animation is complete
 *       return function(cancelled) {
 *         //this (optional) function will be called when the animation
 *         //completes or when the animation is cancelled (the cancelled
 *         //flag will be set to true if cancelled).
 *       };
 *     },
 *     leave: function(element, done) { },
 *     move: function(element, done) { },
 *
 *     //animation that can be triggered before the class is added
 *     beforeAddClass: function(element, className, done) { },
 *
 *     //animation that can be triggered after the class is added
 *     addClass: function(element, className, done) { },
 *
 *     //animation that can be triggered before the class is removed
 *     beforeRemoveClass: function(element, className, done) { },
 *
 *     //animation that can be triggered after the class is removed
 *     removeClass: function(element, className, done) { }
 *   };
 * });
 * ```
 *
 * JavaScript-defined animations are created with a CSS-like class selector and a collection of events which are set to run
 * a javascript callback function. When an animation is triggered, $animate will look for a matching animation which fits
 * the element's CSS class attribute value and then run the matching animation event function (if found).
 * In other words, if the CSS classes present on the animated element match any of the JavaScript animations then the callback function will
 * be executed. It should be also noted that only simple, single class selectors are allowed (compound class selectors are not supported).
 *
 * Within a JavaScript animation, an object containing various event callback animation functions is expected to be returned.
 * As explained above, these callbacks are triggered based on the animation event. Therefore if an enter animation is run,
 * and the JavaScript animation is found, then the enter callback will handle that animation (in addition to the CSS keyframe animation
 * or transition code that is defined via a stylesheet).
 *
 *
 * ### Applying Directive-specific Styles to an Animation
 * In some cases a directive or service may want to provide `$animate` with extra details that the animation will
 * include into its animation. Let's say for example we wanted to render an animation that animates an element
 * towards the mouse coordinates as to where the user clicked last. By collecting the X/Y coordinates of the click
 * (via the event parameter) we can set the `top` and `left` styles into an object and pass that into our function
 * call to `$animate.addClass`.
 *
 * ```js
 * canvas.on('click', function(e) {
 *   $animate.addClass(element, 'on', {
 *     to: {
 *       left : e.client.x + 'px',
 *       top : e.client.y + 'px'
 *     }
 *   }):
 * });
 * ```
 *
 * Now when the animation runs, and a transition or keyframe animation is picked up, then the animation itself will
 * also include and transition the styling of the `left` and `top` properties into its running animation. If we want
 * to provide some starting animation values then we can do so by placing the starting animations styles into an object
 * called `from` in the same object as the `to` animations.
 *
 * ```js
 * canvas.on('click', function(e) {
 *   $animate.addClass(element, 'on', {
 *     from: {
 *        position: 'absolute',
 *        left: '0px',
 *        top: '0px'
 *     },
 *     to: {
 *       left : e.client.x + 'px',
 *       top : e.client.y + 'px'
 *     }
 *   }):
 * });
 * ```
 *
 * Once the animation is complete or cancelled then the union of both the before and after styles are applied to the
 * element. If `ngAnimate` is not present then the styles will be applied immediately.
 *
 */

angular.module('ngAnimate', ['ng'])

  /**
   * @ngdoc provider
   * @name $animateProvider
   * @description
   *
   * The `$animateProvider` allows developers to register JavaScript animation event handlers directly inside of a module.
   * When an animation is triggered, the $animate service will query the $animate service to find any animations that match
   * the provided name value.
   *
   * Requires the {@link ngAnimate `ngAnimate`} module to be installed.
   *
   * Please visit the {@link ngAnimate `ngAnimate`} module overview page learn more about how to use animations in your application.
   *
   */
  .directive('ngAnimateChildren', function() {
    var NG_ANIMATE_CHILDREN = '$$ngAnimateChildren';
    return function(scope, element, attrs) {
      var val = attrs.ngAnimateChildren;
      if (angular.isString(val) && val.length === 0) { //empty attribute
        element.data(NG_ANIMATE_CHILDREN, true);
      } else {
        scope.$watch(val, function(value) {
          element.data(NG_ANIMATE_CHILDREN, !!value);
        });
      }
    };
  })

  //this private service is only used within CSS-enabled animations
  //IE8 + IE9 do not support rAF natively, but that is fine since they
  //also don't support transitions and keyframes which means that the code
  //below will never be used by the two browsers.
  .factory('$$animateReflow', ['$$rAF', '$document', function($$rAF, $document) {
    var bod = $document[0].body;
    return function(fn) {
      //the returned function acts as the cancellation function
      return $$rAF(function() {
        //the line below will force the browser to perform a repaint
        //so that all the animated elements within the animation frame
        //will be properly updated and drawn on screen. This is
        //required to perform multi-class CSS based animations with
        //Firefox. DO NOT REMOVE THIS LINE.
        var a = bod.offsetWidth + 1;
        fn();
      });
    };
  }])

  .config(['$provide', '$animateProvider', function($provide, $animateProvider) {
    var noop = angular.noop;
    var forEach = angular.forEach;
    var selectors = $animateProvider.$$selectors;
    var isArray = angular.isArray;
    var isString = angular.isString;
    var isObject = angular.isObject;

    var ELEMENT_NODE = 1;
    var NG_ANIMATE_STATE = '$$ngAnimateState';
    var NG_ANIMATE_CHILDREN = '$$ngAnimateChildren';
    var NG_ANIMATE_CLASS_NAME = 'ng-animate';
    var rootAnimateState = {running: true};

    function extractElementNode(element) {
      for (var i = 0; i < element.length; i++) {
        var elm = element[i];
        if (elm.nodeType == ELEMENT_NODE) {
          return elm;
        }
      }
    }

    function prepareElement(element) {
      return element && angular.element(element);
    }

    function stripCommentsFromElement(element) {
      return angular.element(extractElementNode(element));
    }

    function isMatchingElement(elm1, elm2) {
      return extractElementNode(elm1) == extractElementNode(elm2);
    }
    var $$jqLite;
    $provide.decorator('$animate',
        ['$delegate', '$$q', '$injector', '$sniffer', '$rootElement', '$$asyncCallback', '$rootScope', '$document', '$templateRequest', '$$jqLite',
 function($delegate,   $$q,   $injector,   $sniffer,   $rootElement,   $$asyncCallback,   $rootScope,   $document,   $templateRequest,   $$$jqLite) {

      $$jqLite = $$$jqLite;
      $rootElement.data(NG_ANIMATE_STATE, rootAnimateState);

      // Wait until all directive and route-related templates are downloaded and
      // compiled. The $templateRequest.totalPendingRequests variable keeps track of
      // all of the remote templates being currently downloaded. If there are no
      // templates currently downloading then the watcher will still fire anyway.
      var deregisterWatch = $rootScope.$watch(
        function() { return $templateRequest.totalPendingRequests; },
        function(val, oldVal) {
          if (val !== 0) return;
          deregisterWatch();

          // Now that all templates have been downloaded, $animate will wait until
          // the post digest queue is empty before enabling animations. By having two
          // calls to $postDigest calls we can ensure that the flag is enabled at the
          // very end of the post digest queue. Since all of the animations in $animate
          // use $postDigest, it's important that the code below executes at the end.
          // This basically means that the page is fully downloaded and compiled before
          // any animations are triggered.
          $rootScope.$$postDigest(function() {
            $rootScope.$$postDigest(function() {
              rootAnimateState.running = false;
            });
          });
        }
      );

      var globalAnimationCounter = 0;
      var classNameFilter = $animateProvider.classNameFilter();
      var isAnimatableClassName = !classNameFilter
              ? function() { return true; }
              : function(className) {
                return classNameFilter.test(className);
              };

      function classBasedAnimationsBlocked(element, setter) {
        var data = element.data(NG_ANIMATE_STATE) || {};
        if (setter) {
          data.running = true;
          data.structural = true;
          element.data(NG_ANIMATE_STATE, data);
        }
        return data.disabled || (data.running && data.structural);
      }

      function runAnimationPostDigest(fn) {
        var cancelFn, defer = $$q.defer();
        defer.promise.$$cancelFn = function() {
          cancelFn && cancelFn();
        };
        $rootScope.$$postDigest(function() {
          cancelFn = fn(function() {
            defer.resolve();
          });
        });
        return defer.promise;
      }

      function parseAnimateOptions(options) {
        // some plugin code may still be passing in the callback
        // function as the last param for the $animate methods so
        // it's best to only allow string or array values for now
        if (isObject(options)) {
          if (options.tempClasses && isString(options.tempClasses)) {
            options.tempClasses = options.tempClasses.split(/\s+/);
          }
          return options;
        }
      }

      function resolveElementClasses(element, cache, runningAnimations) {
        runningAnimations = runningAnimations || {};

        var lookup = {};
        forEach(runningAnimations, function(data, selector) {
          forEach(selector.split(' '), function(s) {
            lookup[s]=data;
          });
        });

        var hasClasses = Object.create(null);
        forEach((element.attr('class') || '').split(/\s+/), function(className) {
          hasClasses[className] = true;
        });

        var toAdd = [], toRemove = [];
        forEach((cache && cache.classes) || [], function(status, className) {
          var hasClass = hasClasses[className];
          var matchingAnimation = lookup[className] || {};

          // When addClass and removeClass is called then $animate will check to
          // see if addClass and removeClass cancel each other out. When there are
          // more calls to removeClass than addClass then the count falls below 0
          // and then the removeClass animation will be allowed. Otherwise if the
          // count is above 0 then that means an addClass animation will commence.
          // Once an animation is allowed then the code will also check to see if
          // there exists any on-going animation that is already adding or remvoing
          // the matching CSS class.
          if (status === false) {
            //does it have the class or will it have the class
            if (hasClass || matchingAnimation.event == 'addClass') {
              toRemove.push(className);
            }
          } else if (status === true) {
            //is the class missing or will it be removed?
            if (!hasClass || matchingAnimation.event == 'removeClass') {
              toAdd.push(className);
            }
          }
        });

        return (toAdd.length + toRemove.length) > 0 && [toAdd.join(' '), toRemove.join(' ')];
      }

      function lookup(name) {
        if (name) {
          var matches = [],
              flagMap = {},
              classes = name.substr(1).split('.');

          //the empty string value is the default animation
          //operation which performs CSS transition and keyframe
          //animations sniffing. This is always included for each
          //element animation procedure if the browser supports
          //transitions and/or keyframe animations. The default
          //animation is added to the top of the list to prevent
          //any previous animations from affecting the element styling
          //prior to the element being animated.
          if ($sniffer.transitions || $sniffer.animations) {
            matches.push($injector.get(selectors['']));
          }

          for (var i=0; i < classes.length; i++) {
            var klass = classes[i],
                selectorFactoryName = selectors[klass];
            if (selectorFactoryName && !flagMap[klass]) {
              matches.push($injector.get(selectorFactoryName));
              flagMap[klass] = true;
            }
          }
          return matches;
        }
      }

      function animationRunner(element, animationEvent, className, options) {
        //transcluded directives may sometimes fire an animation using only comment nodes
        //best to catch this early on to prevent any animation operations from occurring
        var node = element[0];
        if (!node) {
          return;
        }

        if (options) {
          options.to = options.to || {};
          options.from = options.from || {};
        }

        var classNameAdd;
        var classNameRemove;
        if (isArray(className)) {
          classNameAdd = className[0];
          classNameRemove = className[1];
          if (!classNameAdd) {
            className = classNameRemove;
            animationEvent = 'removeClass';
          } else if (!classNameRemove) {
            className = classNameAdd;
            animationEvent = 'addClass';
          } else {
            className = classNameAdd + ' ' + classNameRemove;
          }
        }

        var isSetClassOperation = animationEvent == 'setClass';
        var isClassBased = isSetClassOperation
                           || animationEvent == 'addClass'
                           || animationEvent == 'removeClass'
                           || animationEvent == 'animate';

        var currentClassName = element.attr('class');
        var classes = currentClassName + ' ' + className;
        if (!isAnimatableClassName(classes)) {
          return;
        }

        var beforeComplete = noop,
            beforeCancel = [],
            before = [],
            afterComplete = noop,
            afterCancel = [],
            after = [];

        var animationLookup = (' ' + classes).replace(/\s+/g,'.');
        forEach(lookup(animationLookup), function(animationFactory) {
          var created = registerAnimation(animationFactory, animationEvent);
          if (!created && isSetClassOperation) {
            registerAnimation(animationFactory, 'addClass');
            registerAnimation(animationFactory, 'removeClass');
          }
        });

        function registerAnimation(animationFactory, event) {
          var afterFn = animationFactory[event];
          var beforeFn = animationFactory['before' + event.charAt(0).toUpperCase() + event.substr(1)];
          if (afterFn || beforeFn) {
            if (event == 'leave') {
              beforeFn = afterFn;
              //when set as null then animation knows to skip this phase
              afterFn = null;
            }
            after.push({
              event: event, fn: afterFn
            });
            before.push({
              event: event, fn: beforeFn
            });
            return true;
          }
        }

        function run(fns, cancellations, allCompleteFn) {
          var animations = [];
          forEach(fns, function(animation) {
            animation.fn && animations.push(animation);
          });

          var count = 0;
          function afterAnimationComplete(index) {
            if (cancellations) {
              (cancellations[index] || noop)();
              if (++count < animations.length) return;
              cancellations = null;
            }
            allCompleteFn();
          }

          //The code below adds directly to the array in order to work with
          //both sync and async animations. Sync animations are when the done()
          //operation is called right away. DO NOT REFACTOR!
          forEach(animations, function(animation, index) {
            var progress = function() {
              afterAnimationComplete(index);
            };
            switch (animation.event) {
              case 'setClass':
                cancellations.push(animation.fn(element, classNameAdd, classNameRemove, progress, options));
                break;
              case 'animate':
                cancellations.push(animation.fn(element, className, options.from, options.to, progress));
                break;
              case 'addClass':
                cancellations.push(animation.fn(element, classNameAdd || className,     progress, options));
                break;
              case 'removeClass':
                cancellations.push(animation.fn(element, classNameRemove || className,  progress, options));
                break;
              default:
                cancellations.push(animation.fn(element, progress, options));
                break;
            }
          });

          if (cancellations && cancellations.length === 0) {
            allCompleteFn();
          }
        }

        return {
          node: node,
          event: animationEvent,
          className: className,
          isClassBased: isClassBased,
          isSetClassOperation: isSetClassOperation,
          applyStyles: function() {
            if (options) {
              element.css(angular.extend(options.from || {}, options.to || {}));
            }
          },
          before: function(allCompleteFn) {
            beforeComplete = allCompleteFn;
            run(before, beforeCancel, function() {
              beforeComplete = noop;
              allCompleteFn();
            });
          },
          after: function(allCompleteFn) {
            afterComplete = allCompleteFn;
            run(after, afterCancel, function() {
              afterComplete = noop;
              allCompleteFn();
            });
          },
          cancel: function() {
            if (beforeCancel) {
              forEach(beforeCancel, function(cancelFn) {
                (cancelFn || noop)(true);
              });
              beforeComplete(true);
            }
            if (afterCancel) {
              forEach(afterCancel, function(cancelFn) {
                (cancelFn || noop)(true);
              });
              afterComplete(true);
            }
          }
        };
      }

      /**
       * @ngdoc service
       * @name $animate
       * @kind object
       *
       * @description
       * The `$animate` service provides animation detection support while performing DOM operations (enter, leave and move) as well as during addClass and removeClass operations.
       * When any of these operations are run, the $animate service
       * will examine any JavaScript-defined animations (which are defined by using the $animateProvider provider object)
       * as well as any CSS-defined animations against the CSS classes present on the element once the DOM operation is run.
       *
       * The `$animate` service is used behind the scenes with pre-existing directives and animation with these directives
       * will work out of the box without any extra configuration.
       *
       * Requires the {@link ngAnimate `ngAnimate`} module to be installed.
       *
       * Please visit the {@link ngAnimate `ngAnimate`} module overview page learn more about how to use animations in your application.
       * ## Callback Promises
       * With AngularJS 1.3, each of the animation methods, on the `$animate` service, return a promise when called. The
       * promise itself is then resolved once the animation has completed itself, has been cancelled or has been
       * skipped due to animations being disabled. (Note that even if the animation is cancelled it will still
       * call the resolve function of the animation.)
       *
       * ```js
       * $animate.enter(element, container).then(function() {
       *   //...this is called once the animation is complete...
       * });
       * ```
       *
       * Also note that, due to the nature of the callback promise, if any Angular-specific code (like changing the scope,
       * location of the page, etc...) is executed within the callback promise then be sure to wrap the code using
       * `$scope.$apply(...)`;
       *
       * ```js
       * $animate.leave(element).then(function() {
       *   $scope.$apply(function() {
       *     $location.path('/new-page');
       *   });
       * });
       * ```
       *
       * An animation can also be cancelled by calling the `$animate.cancel(promise)` method with the provided
       * promise that was returned when the animation was started.
       *
       * ```js
       * var promise = $animate.addClass(element, 'super-long-animation');
       * promise.then(function() {
       *   //this will still be called even if cancelled
       * });
       *
       * element.on('click', function() {
       *   //tooo lazy to wait for the animation to end
       *   $animate.cancel(promise);
       * });
       * ```
       *
       * (Keep in mind that the promise cancellation is unique to `$animate` since promises in
       * general cannot be cancelled.)
       *
       */
      return {
        /**
         * @ngdoc method
         * @name $animate#animate
         * @kind function
         *
         * @description
         * Performs an inline animation on the element which applies the provided `to` and `from` CSS styles to the element.
         * If any detected CSS transition, keyframe or JavaScript matches the provided `className` value then the animation
         * will take on the provided styles. For example, if a transition animation is set for the given className then the
         * provided `from` and `to` styles will be applied alongside the given transition. If a JavaScript animation is
         * detected then the provided styles will be given in as function paramters.
         *
         * ```js
         * ngModule.animation('.my-inline-animation', function() {
         *   return {
         *     animate : function(element, className, from, to, done) {
         *       //styles
         *     }
         *   }
         * });
         * ```
         *
         * Below is a breakdown of each step that occurs during the `animate` animation:
         *
         * | Animation Step                                                                                                        | What the element class attribute looks like                  |
         * |-----------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
         * | 1. `$animate.animate(...)` is called                                                                                  | `class="my-animation"`                                       |
         * | 2. `$animate` waits for the next digest to start the animation                                                        | `class="my-animation ng-animate"`                            |
         * | 3. `$animate` runs the JavaScript-defined animations detected on the element                                          | `class="my-animation ng-animate"`                            |
         * | 4. the `className` class value is added to the element                                                                | `class="my-animation ng-animate className"`                  |
         * | 5. `$animate` scans the element styles to get the CSS transition/animation duration and delay                         | `class="my-animation ng-animate className"`                  |
         * | 6. `$animate` blocks all CSS transitions on the element to ensure the `.className` class styling is applied right away| `class="my-animation ng-animate className"`                  |
         * | 7. `$animate` applies the provided collection of `from` CSS styles to the element                                     | `class="my-animation ng-animate className"`                  |
         * | 8. `$animate` waits for a single animation frame (this performs a reflow)                                             | `class="my-animation ng-animate className"`                  |
         * | 9. `$animate` removes the CSS transition block placed on the element                                                  | `class="my-animation ng-animate className"`                  |
         * | 10. the `className-active` class is added (this triggers the CSS transition/animation)                                | `class="my-animation ng-animate className className-active"` |
         * | 11. `$animate` applies the collection of `to` CSS styles to the element which are then handled by the transition      | `class="my-animation ng-animate className className-active"` |
         * | 12. `$animate` waits for the animation to complete (via events and timeout)                                           | `class="my-animation ng-animate className className-active"` |
         * | 13. The animation ends and all generated CSS classes are removed from the element                                     | `class="my-animation"`                                       |
         * | 14. The returned promise is resolved.                                                                                 | `class="my-animation"`                                       |
         *
         * @param {DOMElement} element the element that will be the focus of the enter animation
         * @param {object} from a collection of CSS styles that will be applied to the element at the start of the animation
         * @param {object} to a collection of CSS styles that the element will animate towards
         * @param {string=} className an optional CSS class that will be added to the element for the duration of the animation (the default class is `ng-inline-animate`)
         * @param {object=} options an optional collection of options that will be picked up by the CSS transition/animation
         * @return {Promise} the animation callback promise
        */
        animate: function(element, from, to, className, options) {
          className = className || 'ng-inline-animate';
          options = parseAnimateOptions(options) || {};
          options.from = to ? from : null;
          options.to   = to ? to : from;

          return runAnimationPostDigest(function(done) {
            return performAnimation('animate', className, stripCommentsFromElement(element), null, null, noop, options, done);
          });
        },

        /**
         * @ngdoc method
         * @name $animate#enter
         * @kind function
         *
         * @description
         * Appends the element to the parentElement element that resides in the document and then runs the enter animation. Once
         * the animation is started, the following CSS classes will be present on the element for the duration of the animation:
         *
         * Below is a breakdown of each step that occurs during enter animation:
         *
         * | Animation Step                                                                                                        | What the element class attribute looks like                |
         * |-----------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|
         * | 1. `$animate.enter(...)` is called                                                                                    | `class="my-animation"`                                     |
         * | 2. element is inserted into the `parentElement` element or beside the `afterElement` element                          | `class="my-animation"`                                     |
         * | 3. `$animate` waits for the next digest to start the animation                                                        | `class="my-animation ng-animate"`                          |
         * | 4. `$animate` runs the JavaScript-defined animations detected on the element                                          | `class="my-animation ng-animate"`                          |
         * | 5. the `.ng-enter` class is added to the element                                                                      | `class="my-animation ng-animate ng-enter"`                 |
         * | 6. `$animate` scans the element styles to get the CSS transition/animation duration and delay                         | `class="my-animation ng-animate ng-enter"`                 |
         * | 7. `$animate` blocks all CSS transitions on the element to ensure the `.ng-enter` class styling is applied right away | `class="my-animation ng-animate ng-enter"`                 |
         * | 8. `$animate` waits for a single animation frame (this performs a reflow)                                             | `class="my-animation ng-animate ng-enter"`                 |
         * | 9. `$animate` removes the CSS transition block placed on the element                                                  | `class="my-animation ng-animate ng-enter"`                 |
         * | 10. the `.ng-enter-active` class is added (this triggers the CSS transition/animation)                                | `class="my-animation ng-animate ng-enter ng-enter-active"` |
         * | 11. `$animate` waits for the animation to complete (via events and timeout)                                           | `class="my-animation ng-animate ng-enter ng-enter-active"` |
         * | 12. The animation ends and all generated CSS classes are removed from the element                                     | `class="my-animation"`                                     |
         * | 13. The returned promise is resolved.                                                                                 | `class="my-animation"`                                     |
         *
         * @param {DOMElement} element the element that will be the focus of the enter animation
         * @param {DOMElement} parentElement the parent element of the element that will be the focus of the enter animation
         * @param {DOMElement} afterElement the sibling element (which is the previous element) of the element that will be the focus of the enter animation
         * @param {object=} options an optional collection of options that will be picked up by the CSS transition/animation
         * @return {Promise} the animation callback promise
        */
        enter: function(element, parentElement, afterElement, options) {
          options = parseAnimateOptions(options);
          element = angular.element(element);
          parentElement = prepareElement(parentElement);
          afterElement = prepareElement(afterElement);

          classBasedAnimationsBlocked(element, true);
          $delegate.enter(element, parentElement, afterElement);
          return runAnimationPostDigest(function(done) {
            return performAnimation('enter', 'ng-enter', stripCommentsFromElement(element), parentElement, afterElement, noop, options, done);
          });
        },

        /**
         * @ngdoc method
         * @name $animate#leave
         * @kind function
         *
         * @description
         * Runs the leave animation operation and, upon completion, removes the element from the DOM. Once
         * the animation is started, the following CSS classes will be added for the duration of the animation:
         *
         * Below is a breakdown of each step that occurs during leave animation:
         *
         * | Animation Step                                                                                                        | What the element class attribute looks like                |
         * |-----------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|
         * | 1. `$animate.leave(...)` is called                                                                                    | `class="my-animation"`                                     |
         * | 2. `$animate` runs the JavaScript-defined animations detected on the element                                          | `class="my-animation ng-animate"`                          |
         * | 3. `$animate` waits for the next digest to start the animation                                                        | `class="my-animation ng-animate"`                          |
         * | 4. the `.ng-leave` class is added to the element                                                                      | `class="my-animation ng-animate ng-leave"`                 |
         * | 5. `$animate` scans the element styles to get the CSS transition/animation duration and delay                         | `class="my-animation ng-animate ng-leave"`                 |
         * | 6. `$animate` blocks all CSS transitions on the element to ensure the `.ng-leave` class styling is applied right away | `class="my-animation ng-animate ng-leave"`                 |
         * | 7. `$animate` waits for a single animation frame (this performs a reflow)                                             | `class="my-animation ng-animate ng-leave"`                 |
         * | 8. `$animate` removes the CSS transition block placed on the element                                                  | `class="my-animation ng-animate ng-leave"`                 |
         * | 9. the `.ng-leave-active` class is added (this triggers the CSS transition/animation)                                 | `class="my-animation ng-animate ng-leave ng-leave-active"` |
         * | 10. `$animate` waits for the animation to complete (via events and timeout)                                           | `class="my-animation ng-animate ng-leave ng-leave-active"` |
         * | 11. The animation ends and all generated CSS classes are removed from the element                                     | `class="my-animation"`                                     |
         * | 12. The element is removed from the DOM                                                                               | ...                                                        |
         * | 13. The returned promise is resolved.                                                                                 | ...                                                        |
         *
         * @param {DOMElement} element the element that will be the focus of the leave animation
         * @param {object=} options an optional collection of styles that will be picked up by the CSS transition/animation
         * @return {Promise} the animation callback promise
        */
        leave: function(element, options) {
          options = parseAnimateOptions(options);
          element = angular.element(element);

          cancelChildAnimations(element);
          classBasedAnimationsBlocked(element, true);
          return runAnimationPostDigest(function(done) {
            return performAnimation('leave', 'ng-leave', stripCommentsFromElement(element), null, null, function() {
              $delegate.leave(element);
            }, options, done);
          });
        },

        /**
         * @ngdoc method
         * @name $animate#move
         * @kind function
         *
         * @description
         * Fires the move DOM operation. Just before the animation starts, the animate service will either append it into the parentElement container or
         * add the element directly after the afterElement element if present. Then the move animation will be run. Once
         * the animation is started, the following CSS classes will be added for the duration of the animation:
         *
         * Below is a breakdown of each step that occurs during move animation:
         *
         * | Animation Step                                                                                                       | What the element class attribute looks like              |
         * |----------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|
         * | 1. `$animate.move(...)` is called                                                                                    | `class="my-animation"`                                   |
         * | 2. element is moved into the parentElement element or beside the afterElement element                                | `class="my-animation"`                                   |
         * | 3. `$animate` waits for the next digest to start the animation                                                       | `class="my-animation ng-animate"`                        |
         * | 4. `$animate` runs the JavaScript-defined animations detected on the element                                         | `class="my-animation ng-animate"`                        |
         * | 5. the `.ng-move` class is added to the element                                                                      | `class="my-animation ng-animate ng-move"`                |
         * | 6. `$animate` scans the element styles to get the CSS transition/animation duration and delay                        | `class="my-animation ng-animate ng-move"`                |
         * | 7. `$animate` blocks all CSS transitions on the element to ensure the `.ng-move` class styling is applied right away | `class="my-animation ng-animate ng-move"`                |
         * | 8. `$animate` waits for a single animation frame (this performs a reflow)                                            | `class="my-animation ng-animate ng-move"`                |
         * | 9. `$animate` removes the CSS transition block placed on the element                                                 | `class="my-animation ng-animate ng-move"`                |
         * | 10. the `.ng-move-active` class is added (this triggers the CSS transition/animation)                                | `class="my-animation ng-animate ng-move ng-move-active"` |
         * | 11. `$animate` waits for the animation to complete (via events and timeout)                                          | `class="my-animation ng-animate ng-move ng-move-active"` |
         * | 12. The animation ends and all generated CSS classes are removed from the element                                    | `class="my-animation"`                                   |
         * | 13. The returned promise is resolved.                                                                                | `class="my-animation"`                                   |
         *
         * @param {DOMElement} element the element that will be the focus of the move animation
         * @param {DOMElement} parentElement the parentElement element of the element that will be the focus of the move animation
         * @param {DOMElement} afterElement the sibling element (which is the previous element) of the element that will be the focus of the move animation
         * @param {object=} options an optional collection of styles that will be picked up by the CSS transition/animation
         * @return {Promise} the animation callback promise
        */
        move: function(element, parentElement, afterElement, options) {
          options = parseAnimateOptions(options);
          element = angular.element(element);
          parentElement = prepareElement(parentElement);
          afterElement = prepareElement(afterElement);

          cancelChildAnimations(element);
          classBasedAnimationsBlocked(element, true);
          $delegate.move(element, parentElement, afterElement);
          return runAnimationPostDigest(function(done) {
            return performAnimation('move', 'ng-move', stripCommentsFromElement(element), parentElement, afterElement, noop, options, done);
          });
        },

        /**
         * @ngdoc method
         * @name $animate#addClass
         *
         * @description
         * Triggers a custom animation event based off the className variable and then attaches the className value to the element as a CSS class.
         * Unlike the other animation methods, the animate service will suffix the className value with {@type -add} in order to provide
         * the animate service the setup and active CSS classes in order to trigger the animation (this will be skipped if no CSS transitions
         * or keyframes are defined on the -add-active or base CSS class).
         *
         * Below is a breakdown of each step that occurs during addClass animation:
         *
         * | Animation Step                                                                                         | What the element class attribute looks like                        |
         * |--------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|
         * | 1. `$animate.addClass(element, 'super')` is called                                                     | `class="my-animation"`                                             |
         * | 2. `$animate` runs the JavaScript-defined animations detected on the element                           | `class="my-animation ng-animate"`                                  |
         * | 3. the `.super-add` class is added to the element                                                      | `class="my-animation ng-animate super-add"`                        |
         * | 4. `$animate` waits for a single animation frame (this performs a reflow)                              | `class="my-animation ng-animate super-add"`                        |
         * | 5. the `.super` and `.super-add-active` classes are added (this triggers the CSS transition/animation) | `class="my-animation ng-animate super super-add super-add-active"` |
         * | 6. `$animate` scans the element styles to get the CSS transition/animation duration and delay          | `class="my-animation ng-animate super super-add super-add-active"` |
         * | 7. `$animate` waits for the animation to complete (via events and timeout)                             | `class="my-animation ng-animate super super-add super-add-active"` |
         * | 8. The animation ends and all generated CSS classes are removed from the element                       | `class="my-animation super"`                                       |
         * | 9. The super class is kept on the element                                                              | `class="my-animation super"`                                       |
         * | 10. The returned promise is resolved.                                                                  | `class="my-animation super"`                                       |
         *
         * @param {DOMElement} element the element that will be animated
         * @param {string} className the CSS class that will be added to the element and then animated
         * @param {object=} options an optional collection of styles that will be picked up by the CSS transition/animation
         * @return {Promise} the animation callback promise
        */
        addClass: function(element, className, options) {
          return this.setClass(element, className, [], options);
        },

        /**
         * @ngdoc method
         * @name $animate#removeClass
         *
         * @description
         * Triggers a custom animation event based off the className variable and then removes the CSS class provided by the className value
         * from the element. Unlike the other animation methods, the animate service will suffix the className value with {@type -remove} in
         * order to provide the animate service the setup and active CSS classes in order to trigger the animation (this will be skipped if
         * no CSS transitions or keyframes are defined on the -remove or base CSS classes).
         *
         * Below is a breakdown of each step that occurs during removeClass animation:
         *
         * | Animation Step                                                                                                       | What the element class attribute looks like                        |
         * |----------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|
         * | 1. `$animate.removeClass(element, 'super')` is called                                                                | `class="my-animation super"`                                       |
         * | 2. `$animate` runs the JavaScript-defined animations detected on the element                                         | `class="my-animation super ng-animate"`                            |
         * | 3. the `.super-remove` class is added to the element                                                                 | `class="my-animation super ng-animate super-remove"`               |
         * | 4. `$animate` waits for a single animation frame (this performs a reflow)                                            | `class="my-animation super ng-animate super-remove"`               |
         * | 5. the `.super-remove-active` classes are added and `.super` is removed (this triggers the CSS transition/animation) | `class="my-animation ng-animate super-remove super-remove-active"` |
         * | 6. `$animate` scans the element styles to get the CSS transition/animation duration and delay                        | `class="my-animation ng-animate super-remove super-remove-active"` |
         * | 7. `$animate` waits for the animation to complete (via events and timeout)                                           | `class="my-animation ng-animate super-remove super-remove-active"` |
         * | 8. The animation ends and all generated CSS classes are removed from the element                                     | `class="my-animation"`                                             |
         * | 9. The returned promise is resolved.                                                                                 | `class="my-animation"`                                             |
         *
         *
         * @param {DOMElement} element the element that will be animated
         * @param {string} className the CSS class that will be animated and then removed from the element
         * @param {object=} options an optional collection of styles that will be picked up by the CSS transition/animation
         * @return {Promise} the animation callback promise
        */
        removeClass: function(element, className, options) {
          return this.setClass(element, [], className, options);
        },

        /**
         *
         * @ngdoc method
         * @name $animate#setClass
         *
         * @description Adds and/or removes the given CSS classes to and from the element.
         * Once complete, the `done()` callback will be fired (if provided).
         *
         * | Animation Step                                                                                                                               | What the element class attribute looks like                                            |
         * |----------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------|
         * | 1. `$animate.setClass(element, 'on', 'off')` is called                                                                                       | `class="my-animation off"`                                                             |
         * | 2. `$animate` runs the JavaScript-defined animations detected on the element                                                                 | `class="my-animation ng-animate off"`                                                  |
         * | 3. the `.on-add` and `.off-remove` classes are added to the element                                                                          | `class="my-animation ng-animate on-add off-remove off"`                                |
         * | 4. `$animate` waits for a single animation frame (this performs a reflow)                                                                    | `class="my-animation ng-animate on-add off-remove off"`                                |
         * | 5. the `.on`, `.on-add-active` and `.off-remove-active` classes are added and `.off` is removed (this triggers the CSS transition/animation) | `class="my-animation ng-animate on on-add on-add-active off-remove off-remove-active"` |
         * | 6. `$animate` scans the element styles to get the CSS transition/animation duration and delay                                                | `class="my-animation ng-animate on on-add on-add-active off-remove off-remove-active"` |
         * | 7. `$animate` waits for the animation to complete (via events and timeout)                                                                   | `class="my-animation ng-animate on on-add on-add-active off-remove off-remove-active"` |
         * | 8. The animation ends and all generated CSS classes are removed from the element                                                             | `class="my-animation on"`                                                              |
         * | 9. The returned promise is resolved.                                                                                                         | `class="my-animation on"`                                                              |
         *
         * @param {DOMElement} element the element which will have its CSS classes changed
         *   removed from it
         * @param {string} add the CSS classes which will be added to the element
         * @param {string} remove the CSS class which will be removed from the element
         *   CSS classes have been set on the element
         * @param {object=} options an optional collection of styles that will be picked up by the CSS transition/animation
         * @return {Promise} the animation callback promise
         */
        setClass: function(element, add, remove, options) {
          options = parseAnimateOptions(options);

          var STORAGE_KEY = '$$animateClasses';
          element = angular.element(element);
          element = stripCommentsFromElement(element);

          if (classBasedAnimationsBlocked(element)) {
            return $delegate.$$setClassImmediately(element, add, remove, options);
          }

          // we're using a combined array for both the add and remove
          // operations since the ORDER OF addClass and removeClass matters
          var classes, cache = element.data(STORAGE_KEY);
          var hasCache = !!cache;
          if (!cache) {
            cache = {};
            cache.classes = {};
          }
          classes = cache.classes;

          add = isArray(add) ? add : add.split(' ');
          forEach(add, function(c) {
            if (c && c.length) {
              classes[c] = true;
            }
          });

          remove = isArray(remove) ? remove : remove.split(' ');
          forEach(remove, function(c) {
            if (c && c.length) {
              classes[c] = false;
            }
          });

          if (hasCache) {
            if (options && cache.options) {
              cache.options = angular.extend(cache.options || {}, options);
            }

            //the digest cycle will combine all the animations into one function
            return cache.promise;
          } else {
            element.data(STORAGE_KEY, cache = {
              classes: classes,
              options: options
            });
          }

          return cache.promise = runAnimationPostDigest(function(done) {
            var parentElement = element.parent();
            var elementNode = extractElementNode(element);
            var parentNode = elementNode.parentNode;
            // TODO(matsko): move this code into the animationsDisabled() function once #8092 is fixed
            if (!parentNode || parentNode['$$NG_REMOVED'] || elementNode['$$NG_REMOVED']) {
              done();
              return;
            }

            var cache = element.data(STORAGE_KEY);
            element.removeData(STORAGE_KEY);

            var state = element.data(NG_ANIMATE_STATE) || {};
            var classes = resolveElementClasses(element, cache, state.active);
            return !classes
              ? done()
              : performAnimation('setClass', classes, element, parentElement, null, function() {
                  if (classes[0]) $delegate.$$addClassImmediately(element, classes[0]);
                  if (classes[1]) $delegate.$$removeClassImmediately(element, classes[1]);
                }, cache.options, done);
          });
        },

        /**
         * @ngdoc method
         * @name $animate#cancel
         * @kind function
         *
         * @param {Promise} animationPromise The animation promise that is returned when an animation is started.
         *
         * @description
         * Cancels the provided animation.
        */
        cancel: function(promise) {
          promise.$$cancelFn();
        },

        /**
         * @ngdoc method
         * @name $animate#enabled
         * @kind function
         *
         * @param {boolean=} value If provided then set the animation on or off.
         * @param {DOMElement=} element If provided then the element will be used to represent the enable/disable operation
         * @return {boolean} Current animation state.
         *
         * @description
         * Globally enables/disables animations.
         *
        */
        enabled: function(value, element) {
          switch (arguments.length) {
            case 2:
              if (value) {
                cleanup(element);
              } else {
                var data = element.data(NG_ANIMATE_STATE) || {};
                data.disabled = true;
                element.data(NG_ANIMATE_STATE, data);
              }
            break;

            case 1:
              rootAnimateState.disabled = !value;
            break;

            default:
              value = !rootAnimateState.disabled;
            break;
          }
          return !!value;
         }
      };

      /*
        all animations call this shared animation triggering function internally.
        The animationEvent variable refers to the JavaScript animation event that will be triggered
        and the className value is the name of the animation that will be applied within the
        CSS code. Element, `parentElement` and `afterElement` are provided DOM elements for the animation
        and the onComplete callback will be fired once the animation is fully complete.
      */
      function performAnimation(animationEvent, className, element, parentElement, afterElement, domOperation, options, doneCallback) {
        var noopCancel = noop;
        var runner = animationRunner(element, animationEvent, className, options);
        if (!runner) {
          fireDOMOperation();
          fireBeforeCallbackAsync();
          fireAfterCallbackAsync();
          closeAnimation();
          return noopCancel;
        }

        animationEvent = runner.event;
        className = runner.className;
        var elementEvents = angular.element._data(runner.node);
        elementEvents = elementEvents && elementEvents.events;

        if (!parentElement) {
          parentElement = afterElement ? afterElement.parent() : element.parent();
        }

        //skip the animation if animations are disabled, a parent is already being animated,
        //the element is not currently attached to the document body or then completely close
        //the animation if any matching animations are not found at all.
        //NOTE: IE8 + IE9 should close properly (run closeAnimation()) in case an animation was found.
        if (animationsDisabled(element, parentElement)) {
          fireDOMOperation();
          fireBeforeCallbackAsync();
          fireAfterCallbackAsync();
          closeAnimation();
          return noopCancel;
        }

        var ngAnimateState  = element.data(NG_ANIMATE_STATE) || {};
        var runningAnimations     = ngAnimateState.active || {};
        var totalActiveAnimations = ngAnimateState.totalActive || 0;
        var lastAnimation         = ngAnimateState.last;
        var skipAnimation = false;

        if (totalActiveAnimations > 0) {
          var animationsToCancel = [];
          if (!runner.isClassBased) {
            if (animationEvent == 'leave' && runningAnimations['ng-leave']) {
              skipAnimation = true;
            } else {
              //cancel all animations when a structural animation takes place
              for (var klass in runningAnimations) {
                animationsToCancel.push(runningAnimations[klass]);
              }
              ngAnimateState = {};
              cleanup(element, true);
            }
          } else if (lastAnimation.event == 'setClass') {
            animationsToCancel.push(lastAnimation);
            cleanup(element, className);
          }
          else if (runningAnimations[className]) {
            var current = runningAnimations[className];
            if (current.event == animationEvent) {
              skipAnimation = true;
            } else {
              animationsToCancel.push(current);
              cleanup(element, className);
            }
          }

          if (animationsToCancel.length > 0) {
            forEach(animationsToCancel, function(operation) {
              operation.cancel();
            });
          }
        }

        if (runner.isClassBased
            && !runner.isSetClassOperation
            && animationEvent != 'animate'
            && !skipAnimation) {
          skipAnimation = (animationEvent == 'addClass') == element.hasClass(className); //opposite of XOR
        }

        if (skipAnimation) {
          fireDOMOperation();
          fireBeforeCallbackAsync();
          fireAfterCallbackAsync();
          fireDoneCallbackAsync();
          return noopCancel;
        }

        runningAnimations     = ngAnimateState.active || {};
        totalActiveAnimations = ngAnimateState.totalActive || 0;

        if (animationEvent == 'leave') {
          //there's no need to ever remove the listener since the element
          //will be removed (destroyed) after the leave animation ends or
          //is cancelled midway
          element.one('$destroy', function(e) {
            var element = angular.element(this);
            var state = element.data(NG_ANIMATE_STATE);
            if (state) {
              var activeLeaveAnimation = state.active['ng-leave'];
              if (activeLeaveAnimation) {
                activeLeaveAnimation.cancel();
                cleanup(element, 'ng-leave');
              }
            }
          });
        }

        //the ng-animate class does nothing, but it's here to allow for
        //parent animations to find and cancel child animations when needed
        $$jqLite.addClass(element, NG_ANIMATE_CLASS_NAME);
        if (options && options.tempClasses) {
          forEach(options.tempClasses, function(className) {
            $$jqLite.addClass(element, className);
          });
        }

        var localAnimationCount = globalAnimationCounter++;
        totalActiveAnimations++;
        runningAnimations[className] = runner;

        element.data(NG_ANIMATE_STATE, {
          last: runner,
          active: runningAnimations,
          index: localAnimationCount,
          totalActive: totalActiveAnimations
        });

        //first we run the before animations and when all of those are complete
        //then we perform the DOM operation and run the next set of animations
        fireBeforeCallbackAsync();
        runner.before(function(cancelled) {
          var data = element.data(NG_ANIMATE_STATE);
          cancelled = cancelled ||
                        !data || !data.active[className] ||
                        (runner.isClassBased && data.active[className].event != animationEvent);

          fireDOMOperation();
          if (cancelled === true) {
            closeAnimation();
          } else {
            fireAfterCallbackAsync();
            runner.after(closeAnimation);
          }
        });

        return runner.cancel;

        function fireDOMCallback(animationPhase) {
          var eventName = '$animate:' + animationPhase;
          if (elementEvents && elementEvents[eventName] && elementEvents[eventName].length > 0) {
            $$asyncCallback(function() {
              element.triggerHandler(eventName, {
                event: animationEvent,
                className: className
              });
            });
          }
        }

        function fireBeforeCallbackAsync() {
          fireDOMCallback('before');
        }

        function fireAfterCallbackAsync() {
          fireDOMCallback('after');
        }

        function fireDoneCallbackAsync() {
          fireDOMCallback('close');
          doneCallback();
        }

        //it is less complicated to use a flag than managing and canceling
        //timeouts containing multiple callbacks.
        function fireDOMOperation() {
          if (!fireDOMOperation.hasBeenRun) {
            fireDOMOperation.hasBeenRun = true;
            domOperation();
          }
        }

        function closeAnimation() {
          if (!closeAnimation.hasBeenRun) {
            if (runner) { //the runner doesn't exist if it fails to instantiate
              runner.applyStyles();
            }

            closeAnimation.hasBeenRun = true;
            if (options && options.tempClasses) {
              forEach(options.tempClasses, function(className) {
                $$jqLite.removeClass(element, className);
              });
            }

            var data = element.data(NG_ANIMATE_STATE);
            if (data) {

              /* only structural animations wait for reflow before removing an
                 animation, but class-based animations don't. An example of this
                 failing would be when a parent HTML tag has a ng-class attribute
                 causing ALL directives below to skip animations during the digest */
              if (runner && runner.isClassBased) {
                cleanup(element, className);
              } else {
                $$asyncCallback(function() {
                  var data = element.data(NG_ANIMATE_STATE) || {};
                  if (localAnimationCount == data.index) {
                    cleanup(element, className, animationEvent);
                  }
                });
                element.data(NG_ANIMATE_STATE, data);
              }
            }
            fireDoneCallbackAsync();
          }
        }
      }

      function cancelChildAnimations(element) {
        var node = extractElementNode(element);
        if (node) {
          var nodes = angular.isFunction(node.getElementsByClassName) ?
            node.getElementsByClassName(NG_ANIMATE_CLASS_NAME) :
            node.querySelectorAll('.' + NG_ANIMATE_CLASS_NAME);
          forEach(nodes, function(element) {
            element = angular.element(element);
            var data = element.data(NG_ANIMATE_STATE);
            if (data && data.active) {
              forEach(data.active, function(runner) {
                runner.cancel();
              });
            }
          });
        }
      }

      function cleanup(element, className) {
        if (isMatchingElement(element, $rootElement)) {
          if (!rootAnimateState.disabled) {
            rootAnimateState.running = false;
            rootAnimateState.structural = false;
          }
        } else if (className) {
          var data = element.data(NG_ANIMATE_STATE) || {};

          var removeAnimations = className === true;
          if (!removeAnimations && data.active && data.active[className]) {
            data.totalActive--;
            delete data.active[className];
          }

          if (removeAnimations || !data.totalActive) {
            $$jqLite.removeClass(element, NG_ANIMATE_CLASS_NAME);
            element.removeData(NG_ANIMATE_STATE);
          }
        }
      }

      function animationsDisabled(element, parentElement) {
        if (rootAnimateState.disabled) {
          return true;
        }

        if (isMatchingElement(element, $rootElement)) {
          return rootAnimateState.running;
        }

        var allowChildAnimations, parentRunningAnimation, hasParent;
        do {
          //the element did not reach the root element which means that it
          //is not apart of the DOM. Therefore there is no reason to do
          //any animations on it
          if (parentElement.length === 0) break;

          var isRoot = isMatchingElement(parentElement, $rootElement);
          var state = isRoot ? rootAnimateState : (parentElement.data(NG_ANIMATE_STATE) || {});
          if (state.disabled) {
            return true;
          }

          //no matter what, for an animation to work it must reach the root element
          //this implies that the element is attached to the DOM when the animation is run
          if (isRoot) {
            hasParent = true;
          }

          //once a flag is found that is strictly false then everything before
          //it will be discarded and all child animations will be restricted
          if (allowChildAnimations !== false) {
            var animateChildrenFlag = parentElement.data(NG_ANIMATE_CHILDREN);
            if (angular.isDefined(animateChildrenFlag)) {
              allowChildAnimations = animateChildrenFlag;
            }
          }

          parentRunningAnimation = parentRunningAnimation ||
                                   state.running ||
                                   (state.last && !state.last.isClassBased);
        }
        while (parentElement = parentElement.parent());

        return !hasParent || (!allowChildAnimations && parentRunningAnimation);
      }
    }]);

    $animateProvider.register('', ['$window', '$sniffer', '$timeout', '$$animateReflow',
                           function($window,   $sniffer,   $timeout,   $$animateReflow) {
      // Detect proper transitionend/animationend event names.
      var CSS_PREFIX = '', TRANSITION_PROP, TRANSITIONEND_EVENT, ANIMATION_PROP, ANIMATIONEND_EVENT;

      // If unprefixed events are not supported but webkit-prefixed are, use the latter.
      // Otherwise, just use W3C names, browsers not supporting them at all will just ignore them.
      // Note: Chrome implements `window.onwebkitanimationend` and doesn't implement `window.onanimationend`
      // but at the same time dispatches the `animationend` event and not `webkitAnimationEnd`.
      // Register both events in case `window.onanimationend` is not supported because of that,
      // do the same for `transitionend` as Safari is likely to exhibit similar behavior.
      // Also, the only modern browser that uses vendor prefixes for transitions/keyframes is webkit
      // therefore there is no reason to test anymore for other vendor prefixes: http://caniuse.com/#search=transition
      if (window.ontransitionend === undefined && window.onwebkittransitionend !== undefined) {
        CSS_PREFIX = '-webkit-';
        TRANSITION_PROP = 'WebkitTransition';
        TRANSITIONEND_EVENT = 'webkitTransitionEnd transitionend';
      } else {
        TRANSITION_PROP = 'transition';
        TRANSITIONEND_EVENT = 'transitionend';
      }

      if (window.onanimationend === undefined && window.onwebkitanimationend !== undefined) {
        CSS_PREFIX = '-webkit-';
        ANIMATION_PROP = 'WebkitAnimation';
        ANIMATIONEND_EVENT = 'webkitAnimationEnd animationend';
      } else {
        ANIMATION_PROP = 'animation';
        ANIMATIONEND_EVENT = 'animationend';
      }

      var DURATION_KEY = 'Duration';
      var PROPERTY_KEY = 'Property';
      var DELAY_KEY = 'Delay';
      var ANIMATION_ITERATION_COUNT_KEY = 'IterationCount';
      var ANIMATION_PLAYSTATE_KEY = 'PlayState';
      var NG_ANIMATE_PARENT_KEY = '$$ngAnimateKey';
      var NG_ANIMATE_CSS_DATA_KEY = '$$ngAnimateCSS3Data';
      var ELAPSED_TIME_MAX_DECIMAL_PLACES = 3;
      var CLOSING_TIME_BUFFER = 1.5;
      var ONE_SECOND = 1000;

      var lookupCache = {};
      var parentCounter = 0;
      var animationReflowQueue = [];
      var cancelAnimationReflow;
      function clearCacheAfterReflow() {
        if (!cancelAnimationReflow) {
          cancelAnimationReflow = $$animateReflow(function() {
            animationReflowQueue = [];
            cancelAnimationReflow = null;
            lookupCache = {};
          });
        }
      }

      function afterReflow(element, callback) {
        if (cancelAnimationReflow) {
          cancelAnimationReflow();
        }
        animationReflowQueue.push(callback);
        cancelAnimationReflow = $$animateReflow(function() {
          forEach(animationReflowQueue, function(fn) {
            fn();
          });

          animationReflowQueue = [];
          cancelAnimationReflow = null;
          lookupCache = {};
        });
      }

      var closingTimer = null;
      var closingTimestamp = 0;
      var animationElementQueue = [];
      function animationCloseHandler(element, totalTime) {
        var node = extractElementNode(element);
        element = angular.element(node);

        //this item will be garbage collected by the closing
        //animation timeout
        animationElementQueue.push(element);

        //but it may not need to cancel out the existing timeout
        //if the timestamp is less than the previous one
        var futureTimestamp = Date.now() + totalTime;
        if (futureTimestamp <= closingTimestamp) {
          return;
        }

        $timeout.cancel(closingTimer);

        closingTimestamp = futureTimestamp;
        closingTimer = $timeout(function() {
          closeAllAnimations(animationElementQueue);
          animationElementQueue = [];
        }, totalTime, false);
      }

      function closeAllAnimations(elements) {
        forEach(elements, function(element) {
          var elementData = element.data(NG_ANIMATE_CSS_DATA_KEY);
          if (elementData) {
            forEach(elementData.closeAnimationFns, function(fn) {
              fn();
            });
          }
        });
      }

      function getElementAnimationDetails(element, cacheKey) {
        var data = cacheKey ? lookupCache[cacheKey] : null;
        if (!data) {
          var transitionDuration = 0;
          var transitionDelay = 0;
          var animationDuration = 0;
          var animationDelay = 0;

          //we want all the styles defined before and after
          forEach(element, function(element) {
            if (element.nodeType == ELEMENT_NODE) {
              var elementStyles = $window.getComputedStyle(element) || {};

              var transitionDurationStyle = elementStyles[TRANSITION_PROP + DURATION_KEY];
              transitionDuration = Math.max(parseMaxTime(transitionDurationStyle), transitionDuration);

              var transitionDelayStyle = elementStyles[TRANSITION_PROP + DELAY_KEY];
              transitionDelay  = Math.max(parseMaxTime(transitionDelayStyle), transitionDelay);

              var animationDelayStyle = elementStyles[ANIMATION_PROP + DELAY_KEY];
              animationDelay   = Math.max(parseMaxTime(elementStyles[ANIMATION_PROP + DELAY_KEY]), animationDelay);

              var aDuration  = parseMaxTime(elementStyles[ANIMATION_PROP + DURATION_KEY]);

              if (aDuration > 0) {
                aDuration *= parseInt(elementStyles[ANIMATION_PROP + ANIMATION_ITERATION_COUNT_KEY], 10) || 1;
              }
              animationDuration = Math.max(aDuration, animationDuration);
            }
          });
          data = {
            total: 0,
            transitionDelay: transitionDelay,
            transitionDuration: transitionDuration,
            animationDelay: animationDelay,
            animationDuration: animationDuration
          };
          if (cacheKey) {
            lookupCache[cacheKey] = data;
          }
        }
        return data;
      }

      function parseMaxTime(str) {
        var maxValue = 0;
        var values = isString(str) ?
          str.split(/\s*,\s*/) :
          [];
        forEach(values, function(value) {
          maxValue = Math.max(parseFloat(value) || 0, maxValue);
        });
        return maxValue;
      }

      function getCacheKey(element) {
        var parentElement = element.parent();
        var parentID = parentElement.data(NG_ANIMATE_PARENT_KEY);
        if (!parentID) {
          parentElement.data(NG_ANIMATE_PARENT_KEY, ++parentCounter);
          parentID = parentCounter;
        }
        return parentID + '-' + extractElementNode(element).getAttribute('class');
      }

      function animateSetup(animationEvent, element, className, styles) {
        var structural = ['ng-enter','ng-leave','ng-move'].indexOf(className) >= 0;

        var cacheKey = getCacheKey(element);
        var eventCacheKey = cacheKey + ' ' + className;
        var itemIndex = lookupCache[eventCacheKey] ? ++lookupCache[eventCacheKey].total : 0;

        var stagger = {};
        if (itemIndex > 0) {
          var staggerClassName = className + '-stagger';
          var staggerCacheKey = cacheKey + ' ' + staggerClassName;
          var applyClasses = !lookupCache[staggerCacheKey];

          applyClasses && $$jqLite.addClass(element, staggerClassName);

          stagger = getElementAnimationDetails(element, staggerCacheKey);

          applyClasses && $$jqLite.removeClass(element, staggerClassName);
        }

        $$jqLite.addClass(element, className);

        var formerData = element.data(NG_ANIMATE_CSS_DATA_KEY) || {};
        var timings = getElementAnimationDetails(element, eventCacheKey);
        var transitionDuration = timings.transitionDuration;
        var animationDuration = timings.animationDuration;

        if (structural && transitionDuration === 0 && animationDuration === 0) {
          $$jqLite.removeClass(element, className);
          return false;
        }

        var blockTransition = styles || (structural && transitionDuration > 0);
        var blockAnimation = animationDuration > 0 &&
                             stagger.animationDelay > 0 &&
                             stagger.animationDuration === 0;

        var closeAnimationFns = formerData.closeAnimationFns || [];
        element.data(NG_ANIMATE_CSS_DATA_KEY, {
          stagger: stagger,
          cacheKey: eventCacheKey,
          running: formerData.running || 0,
          itemIndex: itemIndex,
          blockTransition: blockTransition,
          closeAnimationFns: closeAnimationFns
        });

        var node = extractElementNode(element);

        if (blockTransition) {
          blockTransitions(node, true);
          if (styles) {
            element.css(styles);
          }
        }

        if (blockAnimation) {
          blockAnimations(node, true);
        }

        return true;
      }

      function animateRun(animationEvent, element, className, activeAnimationComplete, styles) {
        var node = extractElementNode(element);
        var elementData = element.data(NG_ANIMATE_CSS_DATA_KEY);
        if (node.getAttribute('class').indexOf(className) == -1 || !elementData) {
          activeAnimationComplete();
          return;
        }

        var activeClassName = '';
        var pendingClassName = '';
        forEach(className.split(' '), function(klass, i) {
          var prefix = (i > 0 ? ' ' : '') + klass;
          activeClassName += prefix + '-active';
          pendingClassName += prefix + '-pending';
        });

        var style = '';
        var appliedStyles = [];
        var itemIndex = elementData.itemIndex;
        var stagger = elementData.stagger;
        var staggerTime = 0;
        if (itemIndex > 0) {
          var transitionStaggerDelay = 0;
          if (stagger.transitionDelay > 0 && stagger.transitionDuration === 0) {
            transitionStaggerDelay = stagger.transitionDelay * itemIndex;
          }

          var animationStaggerDelay = 0;
          if (stagger.animationDelay > 0 && stagger.animationDuration === 0) {
            animationStaggerDelay = stagger.animationDelay * itemIndex;
            appliedStyles.push(CSS_PREFIX + 'animation-play-state');
          }

          staggerTime = Math.round(Math.max(transitionStaggerDelay, animationStaggerDelay) * 100) / 100;
        }

        if (!staggerTime) {
          $$jqLite.addClass(element, activeClassName);
          if (elementData.blockTransition) {
            blockTransitions(node, false);
          }
        }

        var eventCacheKey = elementData.cacheKey + ' ' + activeClassName;
        var timings = getElementAnimationDetails(element, eventCacheKey);
        var maxDuration = Math.max(timings.transitionDuration, timings.animationDuration);
        if (maxDuration === 0) {
          $$jqLite.removeClass(element, activeClassName);
          animateClose(element, className);
          activeAnimationComplete();
          return;
        }

        if (!staggerTime && styles && Object.keys(styles).length > 0) {
          if (!timings.transitionDuration) {
            element.css('transition', timings.animationDuration + 's linear all');
            appliedStyles.push('transition');
          }
          element.css(styles);
        }

        var maxDelay = Math.max(timings.transitionDelay, timings.animationDelay);
        var maxDelayTime = maxDelay * ONE_SECOND;

        if (appliedStyles.length > 0) {
          //the element being animated may sometimes contain comment nodes in
          //the jqLite object, so we're safe to use a single variable to house
          //the styles since there is always only one element being animated
          var oldStyle = node.getAttribute('style') || '';
          if (oldStyle.charAt(oldStyle.length - 1) !== ';') {
            oldStyle += ';';
          }
          node.setAttribute('style', oldStyle + ' ' + style);
        }

        var startTime = Date.now();
        var css3AnimationEvents = ANIMATIONEND_EVENT + ' ' + TRANSITIONEND_EVENT;
        var animationTime     = (maxDelay + maxDuration) * CLOSING_TIME_BUFFER;
        var totalTime         = (staggerTime + animationTime) * ONE_SECOND;

        var staggerTimeout;
        if (staggerTime > 0) {
          $$jqLite.addClass(element, pendingClassName);
          staggerTimeout = $timeout(function() {
            staggerTimeout = null;

            if (timings.transitionDuration > 0) {
              blockTransitions(node, false);
            }
            if (timings.animationDuration > 0) {
              blockAnimations(node, false);
            }

            $$jqLite.addClass(element, activeClassName);
            $$jqLite.removeClass(element, pendingClassName);

            if (styles) {
              if (timings.transitionDuration === 0) {
                element.css('transition', timings.animationDuration + 's linear all');
              }
              element.css(styles);
              appliedStyles.push('transition');
            }
          }, staggerTime * ONE_SECOND, false);
        }

        element.on(css3AnimationEvents, onAnimationProgress);
        elementData.closeAnimationFns.push(function() {
          onEnd();
          activeAnimationComplete();
        });

        elementData.running++;
        animationCloseHandler(element, totalTime);
        return onEnd;

        // This will automatically be called by $animate so
        // there is no need to attach this internally to the
        // timeout done method.
        function onEnd() {
          element.off(css3AnimationEvents, onAnimationProgress);
          $$jqLite.removeClass(element, activeClassName);
          $$jqLite.removeClass(element, pendingClassName);
          if (staggerTimeout) {
            $timeout.cancel(staggerTimeout);
          }
          animateClose(element, className);
          var node = extractElementNode(element);
          for (var i in appliedStyles) {
            node.style.removeProperty(appliedStyles[i]);
          }
        }

        function onAnimationProgress(event) {
          event.stopPropagation();
          var ev = event.originalEvent || event;
          var timeStamp = ev.$manualTimeStamp || ev.timeStamp || Date.now();

          /* Firefox (or possibly just Gecko) likes to not round values up
           * when a ms measurement is used for the animation */
          var elapsedTime = parseFloat(ev.elapsedTime.toFixed(ELAPSED_TIME_MAX_DECIMAL_PLACES));

          /* $manualTimeStamp is a mocked timeStamp value which is set
           * within browserTrigger(). This is only here so that tests can
           * mock animations properly. Real events fallback to event.timeStamp,
           * or, if they don't, then a timeStamp is automatically created for them.
           * We're checking to see if the timeStamp surpasses the expected delay,
           * but we're using elapsedTime instead of the timeStamp on the 2nd
           * pre-condition since animations sometimes close off early */
          if (Math.max(timeStamp - startTime, 0) >= maxDelayTime && elapsedTime >= maxDuration) {
            activeAnimationComplete();
          }
        }
      }

      function blockTransitions(node, bool) {
        node.style[TRANSITION_PROP + PROPERTY_KEY] = bool ? 'none' : '';
      }

      function blockAnimations(node, bool) {
        node.style[ANIMATION_PROP + ANIMATION_PLAYSTATE_KEY] = bool ? 'paused' : '';
      }

      function animateBefore(animationEvent, element, className, styles) {
        if (animateSetup(animationEvent, element, className, styles)) {
          return function(cancelled) {
            cancelled && animateClose(element, className);
          };
        }
      }

      function animateAfter(animationEvent, element, className, afterAnimationComplete, styles) {
        if (element.data(NG_ANIMATE_CSS_DATA_KEY)) {
          return animateRun(animationEvent, element, className, afterAnimationComplete, styles);
        } else {
          animateClose(element, className);
          afterAnimationComplete();
        }
      }

      function animate(animationEvent, element, className, animationComplete, options) {
        //If the animateSetup function doesn't bother returning a
        //cancellation function then it means that there is no animation
        //to perform at all
        var preReflowCancellation = animateBefore(animationEvent, element, className, options.from);
        if (!preReflowCancellation) {
          clearCacheAfterReflow();
          animationComplete();
          return;
        }

        //There are two cancellation functions: one is before the first
        //reflow animation and the second is during the active state
        //animation. The first function will take care of removing the
        //data from the element which will not make the 2nd animation
        //happen in the first place
        var cancel = preReflowCancellation;
        afterReflow(element, function() {
          //once the reflow is complete then we point cancel to
          //the new cancellation function which will remove all of the
          //animation properties from the active animation
          cancel = animateAfter(animationEvent, element, className, animationComplete, options.to);
        });

        return function(cancelled) {
          (cancel || noop)(cancelled);
        };
      }

      function animateClose(element, className) {
        $$jqLite.removeClass(element, className);
        var data = element.data(NG_ANIMATE_CSS_DATA_KEY);
        if (data) {
          if (data.running) {
            data.running--;
          }
          if (!data.running || data.running === 0) {
            element.removeData(NG_ANIMATE_CSS_DATA_KEY);
          }
        }
      }

      return {
        animate: function(element, className, from, to, animationCompleted, options) {
          options = options || {};
          options.from = from;
          options.to = to;
          return animate('animate', element, className, animationCompleted, options);
        },

        enter: function(element, animationCompleted, options) {
          options = options || {};
          return animate('enter', element, 'ng-enter', animationCompleted, options);
        },

        leave: function(element, animationCompleted, options) {
          options = options || {};
          return animate('leave', element, 'ng-leave', animationCompleted, options);
        },

        move: function(element, animationCompleted, options) {
          options = options || {};
          return animate('move', element, 'ng-move', animationCompleted, options);
        },

        beforeSetClass: function(element, add, remove, animationCompleted, options) {
          options = options || {};
          var className = suffixClasses(remove, '-remove') + ' ' +
                          suffixClasses(add, '-add');
          var cancellationMethod = animateBefore('setClass', element, className, options.from);
          if (cancellationMethod) {
            afterReflow(element, animationCompleted);
            return cancellationMethod;
          }
          clearCacheAfterReflow();
          animationCompleted();
        },

        beforeAddClass: function(element, className, animationCompleted, options) {
          options = options || {};
          var cancellationMethod = animateBefore('addClass', element, suffixClasses(className, '-add'), options.from);
          if (cancellationMethod) {
            afterReflow(element, animationCompleted);
            return cancellationMethod;
          }
          clearCacheAfterReflow();
          animationCompleted();
        },

        beforeRemoveClass: function(element, className, animationCompleted, options) {
          options = options || {};
          var cancellationMethod = animateBefore('removeClass', element, suffixClasses(className, '-remove'), options.from);
          if (cancellationMethod) {
            afterReflow(element, animationCompleted);
            return cancellationMethod;
          }
          clearCacheAfterReflow();
          animationCompleted();
        },

        setClass: function(element, add, remove, animationCompleted, options) {
          options = options || {};
          remove = suffixClasses(remove, '-remove');
          add = suffixClasses(add, '-add');
          var className = remove + ' ' + add;
          return animateAfter('setClass', element, className, animationCompleted, options.to);
        },

        addClass: function(element, className, animationCompleted, options) {
          options = options || {};
          return animateAfter('addClass', element, suffixClasses(className, '-add'), animationCompleted, options.to);
        },

        removeClass: function(element, className, animationCompleted, options) {
          options = options || {};
          return animateAfter('removeClass', element, suffixClasses(className, '-remove'), animationCompleted, options.to);
        }
      };

      function suffixClasses(classes, suffix) {
        var className = '';
        classes = isArray(classes) ? classes : classes.split(/\s+/);
        forEach(classes, function(klass, i) {
          if (klass && klass.length > 0) {
            className += (i > 0 ? ' ' : '') + klass + suffix;
          }
        });
        return className;
      }
    }]);
  }]);


})(window, window.angular);

/**
 * @license AngularJS v1.3.11
 * (c) 2010-2014 Google, Inc. http://angularjs.org
 * License: MIT
 */
(function(window, angular, undefined) {'use strict';

/**
 * @ngdoc module
 * @name ngAria
 * @description
 *
 * The `ngAria` module provides support for common
 * [<abbr title="Accessible Rich Internet Applications">ARIA</abbr>](http://www.w3.org/TR/wai-aria/)
 * attributes that convey state or semantic information about the application for users
 * of assistive technologies, such as screen readers.
 *
 * <div doc-module-components="ngAria"></div>
 *
 * ## Usage
 *
 * For ngAria to do its magic, simply include the module as a dependency. The directives supported
 * by ngAria are:
 * `ngModel`, `ngDisabled`, `ngShow`, `ngHide`, `ngClick`, `ngDblClick`, and `ngMessages`.
 *
 * Below is a more detailed breakdown of the attributes handled by ngAria:
 *
 * | Directive                                   | Supported Attributes                                                                   |
 * |---------------------------------------------|----------------------------------------------------------------------------------------|
 * | {@link ng.directive:ngModel ngModel}        | aria-checked, aria-valuemin, aria-valuemax, aria-valuenow, aria-invalid, aria-required |
 * | {@link ng.directive:ngDisabled ngDisabled}  | aria-disabled                                                                          |
 * | {@link ng.directive:ngShow ngShow}          | aria-hidden                                                                            |
 * | {@link ng.directive:ngHide ngHide}          | aria-hidden                                                                            |
 * | {@link ng.directive:ngClick ngClick}        | tabindex, keypress event                                                               |
 * | {@link ng.directive:ngDblclick ngDblclick}  | tabindex                                                                               |
 * | {@link module:ngMessages ngMessages}        | aria-live                                                                              |
 *
 * Find out more information about each directive by reading the
 * {@link guide/accessibility ngAria Developer Guide}.
 *
 * ##Example
 * Using ngDisabled with ngAria:
 * ```html
 * <md-checkbox ng-disabled="disabled">
 * ```
 * Becomes:
 * ```html
 * <md-checkbox ng-disabled="disabled" aria-disabled="true">
 * ```
 *
 * ##Disabling Attributes
 * It's possible to disable individual attributes added by ngAria with the
 * {@link ngAria.$ariaProvider#config config} method. For more details, see the
 * {@link guide/accessibility Developer Guide}.
 */
 /* global -ngAriaModule */
var ngAriaModule = angular.module('ngAria', ['ng']).
                        provider('$aria', $AriaProvider);

/**
 * @ngdoc provider
 * @name $ariaProvider
 *
 * @description
 *
 * Used for configuring the ARIA attributes injected and managed by ngAria.
 *
 * ```js
 * angular.module('myApp', ['ngAria'], function config($ariaProvider) {
 *   $ariaProvider.config({
 *     ariaValue: true,
 *     tabindex: false
 *   });
 * });
 *```
 *
 * ## Dependencies
 * Requires the {@link ngAria} module to be installed.
 *
 */
function $AriaProvider() {
  var config = {
    ariaHidden: true,
    ariaChecked: true,
    ariaDisabled: true,
    ariaRequired: true,
    ariaInvalid: true,
    ariaMultiline: true,
    ariaValue: true,
    tabindex: true,
    bindKeypress: true
  };

  /**
   * @ngdoc method
   * @name $ariaProvider#config
   *
   * @param {object} config object to enable/disable specific ARIA attributes
   *
   *  - **ariaHidden** – `{boolean}` – Enables/disables aria-hidden tags
   *  - **ariaChecked** – `{boolean}` – Enables/disables aria-checked tags
   *  - **ariaDisabled** – `{boolean}` – Enables/disables aria-disabled tags
   *  - **ariaRequired** – `{boolean}` – Enables/disables aria-required tags
   *  - **ariaInvalid** – `{boolean}` – Enables/disables aria-invalid tags
   *  - **ariaMultiline** – `{boolean}` – Enables/disables aria-multiline tags
   *  - **ariaValue** – `{boolean}` – Enables/disables aria-valuemin, aria-valuemax and aria-valuenow tags
   *  - **tabindex** – `{boolean}` – Enables/disables tabindex tags
   *  - **bindKeypress** – `{boolean}` – Enables/disables keypress event binding on ng-click
   *
   * @description
   * Enables/disables various ARIA attributes
   */
  this.config = function(newConfig) {
    config = angular.extend(config, newConfig);
  };

  function watchExpr(attrName, ariaAttr, negate) {
    return function(scope, elem, attr) {
      var ariaCamelName = attr.$normalize(ariaAttr);
      if (config[ariaCamelName] && !attr[ariaCamelName]) {
        scope.$watch(attr[attrName], function(boolVal) {
          if (negate) {
            boolVal = !boolVal;
          }
          elem.attr(ariaAttr, boolVal);
        });
      }
    };
  }

  /**
   * @ngdoc service
   * @name $aria
   *
   * @description
   *
   * The $aria service contains helper methods for applying common
   * [ARIA](http://www.w3.org/TR/wai-aria/) attributes to HTML directives.
   *
   * ngAria injects common accessibility attributes that tell assistive technologies when HTML
   * elements are enabled, selected, hidden, and more. To see how this is performed with ngAria,
   * let's review a code snippet from ngAria itself:
   *
   *```js
   * ngAriaModule.directive('ngDisabled', ['$aria', function($aria) {
   *   return $aria.$$watchExpr('ngDisabled', 'aria-disabled');
   * }])
   *```
   * Shown above, the ngAria module creates a directive with the same signature as the
   * traditional `ng-disabled` directive. But this ngAria version is dedicated to
   * solely managing accessibility attributes. The internal `$aria` service is used to watch the
   * boolean attribute `ngDisabled`. If it has not been explicitly set by the developer,
   * `aria-disabled` is injected as an attribute with its value synchronized to the value in
   * `ngDisabled`.
   *
   * Because ngAria hooks into the `ng-disabled` directive, developers do not have to do
   * anything to enable this feature. The `aria-disabled` attribute is automatically managed
   * simply as a silent side-effect of using `ng-disabled` with the ngAria module.
   *
   * The full list of directives that interface with ngAria:
   * * **ngModel**
   * * **ngShow**
   * * **ngHide**
   * * **ngClick**
   * * **ngDblclick**
   * * **ngMessages**
   * * **ngDisabled**
   *
   * Read the {@link guide/accessibility ngAria Developer Guide} for a thorough explanation of each
   * directive.
   *
   *
   * ## Dependencies
   * Requires the {@link ngAria} module to be installed.
   */
  this.$get = function() {
    return {
      config: function(key) {
        return config[key];
      },
      $$watchExpr: watchExpr
    };
  };
}


ngAriaModule.directive('ngShow', ['$aria', function($aria) {
  return $aria.$$watchExpr('ngShow', 'aria-hidden', true);
}])
.directive('ngHide', ['$aria', function($aria) {
  return $aria.$$watchExpr('ngHide', 'aria-hidden', false);
}])
.directive('ngModel', ['$aria', function($aria) {

  function shouldAttachAttr(attr, normalizedAttr, elem) {
    return $aria.config(normalizedAttr) && !elem.attr(attr);
  }

  function getShape(attr, elem) {
    var type = attr.type,
        role = attr.role;

    return ((type || role) === 'checkbox' || role === 'menuitemcheckbox') ? 'checkbox' :
           ((type || role) === 'radio'    || role === 'menuitemradio') ? 'radio' :
           (type === 'range'              || role === 'progressbar' || role === 'slider') ? 'range' :
           (type || role) === 'textbox'   || elem[0].nodeName === 'TEXTAREA' ? 'multiline' : '';
  }

  return {
    restrict: 'A',
    require: '?ngModel',
    link: function(scope, elem, attr, ngModel) {
      var shape = getShape(attr, elem);
      var needsTabIndex = shouldAttachAttr('tabindex', 'tabindex', elem);

      function ngAriaWatchModelValue() {
        return ngModel.$modelValue;
      }

      function getRadioReaction() {
        if (needsTabIndex) {
          needsTabIndex = false;
          return function ngAriaRadioReaction(newVal) {
            var boolVal = newVal === attr.value;
            elem.attr('aria-checked', boolVal);
            elem.attr('tabindex', 0 - !boolVal);
          };
        } else {
          return function ngAriaRadioReaction(newVal) {
            elem.attr('aria-checked', newVal === attr.value);
          };
        }
      }

      function ngAriaCheckboxReaction(newVal) {
        elem.attr('aria-checked', !!newVal);
      }

      switch (shape) {
        case 'radio':
        case 'checkbox':
          if (shouldAttachAttr('aria-checked', 'ariaChecked', elem)) {
            scope.$watch(ngAriaWatchModelValue, shape === 'radio' ?
                getRadioReaction() : ngAriaCheckboxReaction);
          }
          break;
        case 'range':
          if ($aria.config('ariaValue')) {
            if (attr.min && !elem.attr('aria-valuemin')) {
              elem.attr('aria-valuemin', attr.min);
            }
            if (attr.max && !elem.attr('aria-valuemax')) {
              elem.attr('aria-valuemax', attr.max);
            }
            if (!elem.attr('aria-valuenow')) {
              scope.$watch(ngAriaWatchModelValue, function ngAriaValueNowReaction(newVal) {
                elem.attr('aria-valuenow', newVal);
              });
            }
          }
          break;
        case 'multiline':
          if (shouldAttachAttr('aria-multiline', 'ariaMultiline', elem)) {
            elem.attr('aria-multiline', true);
          }
          break;
      }

      if (needsTabIndex) {
        elem.attr('tabindex', 0);
      }

      if (ngModel.$validators.required && shouldAttachAttr('aria-required', 'ariaRequired', elem)) {
        scope.$watch(function ngAriaRequiredWatch() {
          return ngModel.$error.required;
        }, function ngAriaRequiredReaction(newVal) {
          elem.attr('aria-required', !!newVal);
        });
      }

      if (shouldAttachAttr('aria-invalid', 'ariaInvalid', elem)) {
        scope.$watch(function ngAriaInvalidWatch() {
          return ngModel.$invalid;
        }, function ngAriaInvalidReaction(newVal) {
          elem.attr('aria-invalid', !!newVal);
        });
      }
    }
  };
}])
.directive('ngDisabled', ['$aria', function($aria) {
  return $aria.$$watchExpr('ngDisabled', 'aria-disabled');
}])
.directive('ngMessages', function() {
  return {
    restrict: 'A',
    require: '?ngMessages',
    link: function(scope, elem, attr, ngMessages) {
      if (!elem.attr('aria-live')) {
        elem.attr('aria-live', 'assertive');
      }
    }
  };
})
.directive('ngClick',['$aria', '$parse', function($aria, $parse) {
  return {
    restrict: 'A',
    compile: function(elem, attr) {
      var fn = $parse(attr.ngClick, /* interceptorFn */ null, /* expensiveChecks */ true);
      return function(scope, elem, attr) {
        if ($aria.config('tabindex') && !elem.attr('tabindex')) {
          elem.attr('tabindex', 0);
        }

        if ($aria.config('bindKeypress') && !attr.ngKeypress) {
          elem.on('keypress', function(event) {
            if (event.keyCode === 32 || event.keyCode === 13) {
              scope.$apply(callback);
            }

            function callback() {
              fn(scope, { $event: event });
            }
          });
        }
      };
    }
  };
}])
.directive('ngDblclick', ['$aria', function($aria) {
  return function(scope, elem, attr) {
    if ($aria.config('tabindex') && !elem.attr('tabindex')) {
      elem.attr('tabindex', 0);
    }
  };
}]);


})(window, window.angular);

/*!
 * Angular Material Design
 * https://github.com/angular/material
 * @license MIT
 * v0.10.0-master-6e9abdd
 */
(function( window, angular, undefined ){
"use strict";

(function(){
"use strict";

angular.module('ngMaterial', ["ng","ngAnimate","ngAria","material.core","material.core.gestures","material.core.theming.palette","material.core.theming","material.components.autocomplete","material.components.backdrop","material.components.bottomSheet","material.components.button","material.components.card","material.components.checkbox","material.components.chips","material.components.content","material.components.dialog","material.components.divider","material.components.fabActions","material.components.fabSpeedDial","material.components.fabToolbar","material.components.fabTrigger","material.components.gridList","material.components.icon","material.components.input","material.components.list","material.components.menu","material.components.progressCircular","material.components.progressLinear","material.components.radioButton","material.components.select","material.components.sidenav","material.components.slider","material.components.sticky","material.components.subheader","material.components.swipe","material.components.switch","material.components.tabs","material.components.toast","material.components.toolbar","material.components.tooltip","material.components.whiteframe"]);
})();
(function(){
"use strict";


/**
 * Initialization function that validates environment
 * requirements.
 */
angular
  .module('material.core', [ 'material.core.gestures', 'material.core.theming' ])
  .config( MdCoreConfigure );


function MdCoreConfigure($provide, $mdThemingProvider) {

  $provide.decorator('$$rAF', ["$delegate", rAFDecorator]);

  $mdThemingProvider.theme('default')
    .primaryPalette('indigo')
    .accentPalette('pink')
    .warnPalette('red')
    .backgroundPalette('grey');
}
MdCoreConfigure.$inject = ["$provide", "$mdThemingProvider"];

function rAFDecorator( $delegate ) {
  /**
   * Use this to throttle events that come in often.
   * The throttled function will always use the *last* invocation before the
   * coming frame.
   *
   * For example, window resize events that fire many times a second:
   * If we set to use an raf-throttled callback on window resize, then
   * our callback will only be fired once per frame, with the last resize
   * event that happened before that frame.
   *
   * @param {function} callback function to debounce
   */
  $delegate.throttle = function(cb) {
    var queueArgs, alreadyQueued, queueCb, context;
    return function debounced() {
      queueArgs = arguments;
      context = this;
      queueCb = cb;
      if (!alreadyQueued) {
        alreadyQueued = true;
        $delegate(function() {
          queueCb.apply(context, queueArgs);
          alreadyQueued = false;
        });
      }
    };
  };
  return $delegate;
}

})();
(function(){
"use strict";

angular.module('material.core')
.factory('$mdConstant', MdConstantFactory);

function MdConstantFactory($$rAF, $sniffer) {

  var webkit = /webkit/i.test($sniffer.vendorPrefix);
  function vendorProperty(name) {
    return webkit ?  ('webkit' + name.charAt(0).toUpperCase() + name.substring(1)) : name;
  }

  return {
    KEY_CODE: {
      ENTER: 13,
      ESCAPE: 27,
      SPACE: 32,
      LEFT_ARROW : 37,
      UP_ARROW : 38,
      RIGHT_ARROW : 39,
      DOWN_ARROW : 40,
      TAB : 9,
      BACKSPACE: 8,
      DELETE: 46
    },
    CSS: {
      /* Constants */
      TRANSITIONEND: 'transitionend' + (webkit ? ' webkitTransitionEnd' : ''),
      ANIMATIONEND: 'animationend' + (webkit ? ' webkitAnimationEnd' : ''),

      TRANSFORM: vendorProperty('transform'),
      TRANSFORM_ORIGIN: vendorProperty('transformOrigin'),
      TRANSITION: vendorProperty('transition'),
      TRANSITION_DURATION: vendorProperty('transitionDuration'),
      ANIMATION_PLAY_STATE: vendorProperty('animationPlayState'),
      ANIMATION_DURATION: vendorProperty('animationDuration'),
      ANIMATION_NAME: vendorProperty('animationName'),
      ANIMATION_TIMING: vendorProperty('animationTimingFunction'),
      ANIMATION_DIRECTION: vendorProperty('animationDirection')
    },
    MEDIA: {
      'sm': '(max-width: 600px)',
      'gt-sm': '(min-width: 600px)',
      'md': '(min-width: 600px) and (max-width: 960px)',
      'gt-md': '(min-width: 960px)',
      'lg': '(min-width: 960px) and (max-width: 1200px)',
      'gt-lg': '(min-width: 1200px)'
    },
    MEDIA_PRIORITY: [
      'gt-lg',
      'lg',
      'gt-md',
      'md',
      'gt-sm',
      'sm'
    ]
  };
}
MdConstantFactory.$inject = ["$$rAF", "$sniffer"];

})();
(function(){
"use strict";

  angular
    .module('material.core')
    .config( ["$provide", function($provide){
       $provide.decorator('$mdUtil', ['$delegate', function ($delegate){
           /**
            * Inject the iterator facade to easily support iteration and accessors
            * @see iterator below
            */
           $delegate.iterator = MdIterator;

           return $delegate;
         }
       ]);
     }]);

  /**
   * iterator is a list facade to easily support iteration and accessors
   *
   * @param items Array list which this iterator will enumerate
   * @param reloop Boolean enables iterator to consider the list as an endless reloop
   */
  function MdIterator(items, reloop) {
    var trueFn = function() { return true; };

    if (items && !angular.isArray(items)) {
      items = Array.prototype.slice.call(items);
    }

    reloop = !!reloop;
    var _items = items || [ ];

    // Published API
    return {
      items: getItems,
      count: count,

      inRange: inRange,
      contains: contains,
      indexOf: indexOf,
      itemAt: itemAt,

      findBy: findBy,

      add: add,
      remove: remove,

      first: first,
      last: last,
      next: angular.bind(null, findSubsequentItem, false),
      previous: angular.bind(null, findSubsequentItem, true),

      hasPrevious: hasPrevious,
      hasNext: hasNext

    };

    /**
     * Publish copy of the enumerable set
     * @returns {Array|*}
     */
    function getItems() {
      return [].concat(_items);
    }

    /**
     * Determine length of the list
     * @returns {Array.length|*|number}
     */
    function count() {
      return _items.length;
    }

    /**
     * Is the index specified valid
     * @param index
     * @returns {Array.length|*|number|boolean}
     */
    function inRange(index) {
      return _items.length && ( index > -1 ) && (index < _items.length );
    }

    /**
     * Can the iterator proceed to the next item in the list; relative to
     * the specified item.
     *
     * @param item
     * @returns {Array.length|*|number|boolean}
     */
    function hasNext(item) {
      return item ? inRange(indexOf(item) + 1) : false;
    }

    /**
     * Can the iterator proceed to the previous item in the list; relative to
     * the specified item.
     *
     * @param item
     * @returns {Array.length|*|number|boolean}
     */
    function hasPrevious(item) {
      return item ? inRange(indexOf(item) - 1) : false;
    }

    /**
     * Get item at specified index/position
     * @param index
     * @returns {*}
     */
    function itemAt(index) {
      return inRange(index) ? _items[index] : null;
    }

    /**
     * Find all elements matching the key/value pair
     * otherwise return null
     *
     * @param val
     * @param key
     *
     * @return array
     */
    function findBy(key, val) {
      return _items.filter(function(item) {
        return item[key] === val;
      });
    }

    /**
     * Add item to list
     * @param item
     * @param index
     * @returns {*}
     */
    function add(item, index) {
      if ( !item ) return -1;

      if (!angular.isNumber(index)) {
        index = _items.length;
      }

      _items.splice(index, 0, item);

      return indexOf(item);
    }

    /**
     * Remove item from list...
     * @param item
     */
    function remove(item) {
      if ( contains(item) ){
        _items.splice(indexOf(item), 1);
      }
    }

    /**
     * Get the zero-based index of the target item
     * @param item
     * @returns {*}
     */
    function indexOf(item) {
      return _items.indexOf(item);
    }

    /**
     * Boolean existence check
     * @param item
     * @returns {boolean}
     */
    function contains(item) {
      return item && (indexOf(item) > -1);
    }

    /**
     * Return first item in the list
     * @returns {*}
     */
    function first() {
      return _items.length ? _items[0] : null;
    }

    /**
     * Return last item in the list...
     * @returns {*}
     */
    function last() {
      return _items.length ? _items[_items.length - 1] : null;
    }

    /**
     * Find the next item. If reloop is true and at the end of the list, it will go back to the
     * first item. If given, the `validate` callback will be used to determine whether the next item
     * is valid. If not valid, it will try to find the next item again.
     *
     * @param {boolean} backwards Specifies the direction of searching (forwards/backwards)
     * @param {*} item The item whose subsequent item we are looking for
     * @param {Function=} validate The `validate` function
     * @param {integer=} limit The recursion limit
     *
     * @returns {*} The subsequent item or null
     */
    function findSubsequentItem(backwards, item, validate, limit) {
      validate = validate || trueFn;

      var curIndex = indexOf(item);
      while (true) {
        if (!inRange(curIndex)) return null;

        var nextIndex = curIndex + (backwards ? -1 : 1);
        var foundItem = null;
        if (inRange(nextIndex)) {
          foundItem = _items[nextIndex];
        } else if (reloop) {
          foundItem = backwards ? last() : first();
          nextIndex = indexOf(foundItem);
        }

        if ((foundItem === null) || (nextIndex === limit)) return null;
        if (validate(foundItem)) return foundItem;

        if (angular.isUndefined(limit)) limit = nextIndex;

        curIndex = nextIndex;
      }
    }
  }


})();
(function(){
"use strict";

angular.module('material.core')
.factory('$mdMedia', mdMediaFactory);

/**
 * @ngdoc service
 * @name $mdMedia
 * @module material.core
 *
 * @description
 * `$mdMedia` is used to evaluate whether a given media query is true or false given the
 * current device's screen / window size. The media query will be re-evaluated on resize, allowing
 * you to register a watch.
 *
 * `$mdMedia` also has pre-programmed support for media queries that match the layout breakpoints.
 *  (`sm`, `gt-sm`, `md`, `gt-md`, `lg`, `gt-lg`).
 *
 * @returns {boolean} a boolean representing whether or not the given media query is true or false.
 *
 * @usage
 * <hljs lang="js">
 * app.controller('MyController', function($mdMedia, $scope) {
 *   $scope.$watch(function() { return $mdMedia('lg'); }, function(big) {
 *     $scope.bigScreen = big;
 *   });
 *
 *   $scope.screenIsSmall = $mdMedia('sm');
 *   $scope.customQuery = $mdMedia('(min-width: 1234px)');
 *   $scope.anotherCustom = $mdMedia('max-width: 300px');
 * });
 * </hljs>
 */

function mdMediaFactory($mdConstant, $rootScope, $window) {
  var queries = {};
  var mqls = {};
  var results = {};
  var normalizeCache = {};

  $mdMedia.getResponsiveAttribute = getResponsiveAttribute;
  $mdMedia.getQuery = getQuery;
  $mdMedia.watchResponsiveAttributes = watchResponsiveAttributes;

  return $mdMedia;

  function $mdMedia(query) {
    var validated = queries[query];
    if (angular.isUndefined(validated)) {
      validated = queries[query] = validate(query);
    }

    var result = results[validated];
    if (angular.isUndefined(result)) {
      result = add(validated);
    }

    return result;
  }

  function validate(query) {
    return $mdConstant.MEDIA[query] ||
           ((query.charAt(0) !== '(') ? ('(' + query + ')') : query);
  }

  function add(query) {
    var result = mqls[query] = $window.matchMedia(query);
    result.addListener(onQueryChange);
    return (results[result.media] = !!result.matches);
  }

  function onQueryChange(query) {
    $rootScope.$evalAsync(function() {
      results[query.media] = !!query.matches;
    });
  }

  function getQuery(name) {
    return mqls[name];
  }

  function getResponsiveAttribute(attrs, attrName) {
    for (var i = 0; i < $mdConstant.MEDIA_PRIORITY.length; i++) {
      var mediaName = $mdConstant.MEDIA_PRIORITY[i];
      if (!mqls[queries[mediaName]].matches) {
        continue;
      }

      var normalizedName = getNormalizedName(attrs, attrName + '-' + mediaName);
      if (attrs[normalizedName]) {
        return attrs[normalizedName];
      }
    }

    // fallback on unprefixed
    return attrs[getNormalizedName(attrs, attrName)];
  }

  function watchResponsiveAttributes(attrNames, attrs, watchFn) {
    var unwatchFns = [];
    attrNames.forEach(function(attrName) {
      var normalizedName = getNormalizedName(attrs, attrName);
      if (attrs[normalizedName]) {
        unwatchFns.push(
            attrs.$observe(normalizedName, angular.bind(void 0, watchFn, null)));
      }

      for (var mediaName in $mdConstant.MEDIA) {
        normalizedName = getNormalizedName(attrs, attrName + '-' + mediaName);
        if (!attrs[normalizedName]) {
          return;
        }

        unwatchFns.push(attrs.$observe(normalizedName, angular.bind(void 0, watchFn, mediaName)));
      }
    });

    return function unwatch() {
      unwatchFns.forEach(function(fn) { fn(); })
    };
  }

  // Improves performance dramatically
  function getNormalizedName(attrs, attrName) {
    return normalizeCache[attrName] ||
        (normalizeCache[attrName] = attrs.$normalize(attrName));
  }
}
mdMediaFactory.$inject = ["$mdConstant", "$rootScope", "$window"];

})();
(function(){
"use strict";

/*
 * This var has to be outside the angular factory, otherwise when
 * there are multiple material apps on the same page, each app
 * will create its own instance of this array and the app's IDs
 * will not be unique.
 */
var nextUniqueId = 0;

angular.module('material.core')
  .factory('$mdUtil', ["$cacheFactory", "$document", "$timeout", "$q", "$window", "$mdConstant", function ($cacheFactory, $document, $timeout, $q, $window, $mdConstant) {
    var Util;

    function getNode(el) {
      return el[0] || el;
    }

    return Util = {
      now: window.performance ?
        angular.bind(window.performance, window.performance.now) :
        Date.now,

      clientRect: function (element, offsetParent, isOffsetRect) {
        var node = getNode(element);
        offsetParent = getNode(offsetParent || node.offsetParent || document.body);
        var nodeRect = node.getBoundingClientRect();

        // The user can ask for an offsetRect: a rect relative to the offsetParent,
        // or a clientRect: a rect relative to the page
        var offsetRect = isOffsetRect ?
          offsetParent.getBoundingClientRect() :
        {left: 0, top: 0, width: 0, height: 0};
        return {
          left: nodeRect.left - offsetRect.left,
          top: nodeRect.top - offsetRect.top,
          width: nodeRect.width,
          height: nodeRect.height
        };
      },
      offsetRect: function (element, offsetParent) {
        return Util.clientRect(element, offsetParent, true);
      },

      // Annoying method to copy nodes to an array, thanks to IE
      nodesToArray: function (nodes) {
        var results = [];
        for (var i = 0; i < nodes.length; ++i) {
          results.push(nodes.item(i));
        }
        return results;
      },

      // Disables scroll around the passed element.
      disableScrollAround: function (element) {
        if (Util.disableScrollAround._enableScrolling) return Util.disableScrollAround._enableScrolling;
        element = angular.element(element);
        var body = $document[0].body,
          restoreBody = disableBodyScroll(),
          restoreElement = disableElementScroll();

        return Util.disableScrollAround._enableScrolling = function () {
          restoreBody();
          restoreElement();
          delete Util.disableScrollAround._enableScrolling;
        };

        // Creates a virtual scrolling mask to absorb touchmove, keyboard, scrollbar clicking, and wheel events
        function disableElementScroll() {
          var zIndex = $window.getComputedStyle(element[0]).zIndex - 1;
          if (isNaN(zIndex)) zIndex = 99;
          var scrollMask = angular.element(
            '<div class="md-scroll-mask" style="z-index: ' + zIndex + '">' +
            '  <div class="md-scroll-mask-bar"></div>' +
            '</div>');
          body.appendChild(scrollMask[0]);

          scrollMask.on('wheel', preventDefault);
          scrollMask.on('touchmove', preventDefault);
          $document.on('keydown', disableKeyNav);

          return function restoreScroll() {
            scrollMask.off('wheel');
            scrollMask.off('touchmove');
            scrollMask[0].parentNode.removeChild(scrollMask[0]);
            $document.off('keydown', disableKeyNav);
            delete Util.disableScrollAround._enableScrolling;
          };

          // Prevent keypresses from elements inside the body
          // used to stop the keypresses that could cause the page to scroll
          // (arrow keys, spacebar, tab, etc).
          function disableKeyNav(e) {
            //-- temporarily removed this logic, will possibly re-add at a later date
            return;
            if (!element[0].contains(e.target)) {
              e.preventDefault();
              e.stopImmediatePropagation();
            }
          }

          function preventDefault(e) {
            e.preventDefault();
          }
        }

        // Converts the body to a position fixed block and translate it to the proper scroll
        // position
        function disableBodyScroll() {
          var restoreStyle = body.getAttribute('style') || '';
          var scrollOffset = body.scrollTop + body.parentElement.scrollTop;
          var clientWidth = body.clientWidth;

          applyStyles(body, {
            position: 'fixed',
            width: '100%',
            overflowY: 'scroll',
            top: -scrollOffset + 'px'
          });

          if (body.clientWidth < clientWidth) applyStyles(body, {overflow: 'hidden'});

          return function restoreScroll() {
            body.setAttribute('style', restoreStyle);
            body.scrollTop = scrollOffset;
          };
        }

        function applyStyles(el, styles) {
          for (var key in styles) {
            el.style[key] = styles[key];
          }
        }
      },
      enableScrolling: function () {
        var method = this.disableScrollAround._enableScrolling;
        method && method();
      },
      floatingScrollbars: function () {
        if (this.floatingScrollbars.cached === undefined) {
          var tempNode = angular.element('<div style="width: 100%; z-index: -1; position: absolute; height: 35px; overflow-y: scroll"><div style="height: 60;"></div></div>');
          $document[0].body.appendChild(tempNode[0]);
          this.floatingScrollbars.cached = (tempNode[0].offsetWidth == tempNode[0].childNodes[0].offsetWidth);
          tempNode.remove();
        }
        return this.floatingScrollbars.cached;
      },

      // Mobile safari only allows you to set focus in click event listeners...
      forceFocus: function (element) {
        var node = element[0] || element;

        document.addEventListener('click', function focusOnClick(ev) {
          if (ev.target === node && ev.$focus) {
            node.focus();
            ev.stopImmediatePropagation();
            ev.preventDefault();
            node.removeEventListener('click', focusOnClick);
          }
        }, true);

        var newEvent = document.createEvent('MouseEvents');
        newEvent.initMouseEvent('click', false, true, window, {}, 0, 0, 0, 0,
          false, false, false, false, 0, null);
        newEvent.$material = true;
        newEvent.$focus = true;
        node.dispatchEvent(newEvent);
      },

      transitionEndPromise: function (element, opts) {
        opts = opts || {};
        var deferred = $q.defer();
        element.on($mdConstant.CSS.TRANSITIONEND, finished);
        function finished(ev) {
          // Make sure this transitionend didn't bubble up from a child
          if (!ev || ev.target === element[0]) {
            element.off($mdConstant.CSS.TRANSITIONEND, finished);
            deferred.resolve();
          }
        }

        if (opts.timeout) $timeout(finished, opts.timeout);
        return deferred.promise;
      },

      fakeNgModel: function () {
        return {
          $fake: true,
          $setTouched: angular.noop,
          $setViewValue: function (value) {
            this.$viewValue = value;
            this.$render(value);
            this.$viewChangeListeners.forEach(function (cb) {
              cb();
            });
          },
          $isEmpty: function (value) {
            return ('' + value).length === 0;
          },
          $parsers: [],
          $formatters: [],
          $viewChangeListeners: [],
          $render: angular.noop
        };
      },

      // Returns a function, that, as long as it continues to be invoked, will not
      // be triggered. The function will be called after it stops being called for
      // N milliseconds.
      // @param wait Integer value of msecs to delay (since last debounce reset); default value 10 msecs
      // @param invokeApply should the $timeout trigger $digest() dirty checking
      debounce: function (func, wait, scope, invokeApply) {
        var timer;

        return function debounced() {
          var context = scope,
            args = Array.prototype.slice.call(arguments);

          $timeout.cancel(timer);
          timer = $timeout(function () {

            timer = undefined;
            func.apply(context, args);

          }, wait || 10, invokeApply);
        };
      },

      // Returns a function that can only be triggered every `delay` milliseconds.
      // In other words, the function will not be called unless it has been more
      // than `delay` milliseconds since the last call.
      throttle: function throttle(func, delay) {
        var recent;
        return function throttled() {
          var context = this;
          var args = arguments;
          var now = Util.now();

          if (!recent || (now - recent > delay)) {
            func.apply(context, args);
            recent = now;
          }
        };
      },

      /**
       * Measures the number of milliseconds taken to run the provided callback
       * function. Uses a high-precision timer if available.
       */
      time: function time(cb) {
        var start = Util.now();
        cb();
        return Util.now() - start;
      },

      /**
       * Get a unique ID.
       *
       * @returns {string} an unique numeric string
       */
      nextUid: function () {
        return '' + nextUniqueId++;
      },

      // Stop watchers and events from firing on a scope without destroying it,
      // by disconnecting it from its parent and its siblings' linked lists.
      disconnectScope: function disconnectScope(scope) {
        if (!scope) return;

        // we can't destroy the root scope or a scope that has been already destroyed
        if (scope.$root === scope) return;
        if (scope.$$destroyed) return;

        var parent = scope.$parent;
        scope.$$disconnected = true;

        // See Scope.$destroy
        if (parent.$$childHead === scope) parent.$$childHead = scope.$$nextSibling;
        if (parent.$$childTail === scope) parent.$$childTail = scope.$$prevSibling;
        if (scope.$$prevSibling) scope.$$prevSibling.$$nextSibling = scope.$$nextSibling;
        if (scope.$$nextSibling) scope.$$nextSibling.$$prevSibling = scope.$$prevSibling;

        scope.$$nextSibling = scope.$$prevSibling = null;

      },

      // Undo the effects of disconnectScope above.
      reconnectScope: function reconnectScope(scope) {
        if (!scope) return;

        // we can't disconnect the root node or scope already disconnected
        if (scope.$root === scope) return;
        if (!scope.$$disconnected) return;

        var child = scope;

        var parent = child.$parent;
        child.$$disconnected = false;
        // See Scope.$new for this logic...
        child.$$prevSibling = parent.$$childTail;
        if (parent.$$childHead) {
          parent.$$childTail.$$nextSibling = child;
          parent.$$childTail = child;
        } else {
          parent.$$childHead = parent.$$childTail = child;
        }
      },

      /*
       * getClosest replicates jQuery.closest() to walk up the DOM tree until it finds a matching nodeName
       *
       * @param el Element to start walking the DOM from
       * @param tagName Tag name to find closest to el, such as 'form'
       */
      getClosest: function getClosest(el, tagName, onlyParent) {
        if (el instanceof angular.element) el = el[0];
        tagName = tagName.toUpperCase();
        if (onlyParent) el = el.parentNode;
        if (!el) return null;
        do {
          if (el.nodeName === tagName) {
            return el;
          }
        } while (el = el.parentNode);
        return null;
      },

      /**
       * Functional equivalent for $element.filter(‘md-bottom-sheet’)
       * useful with interimElements where the element and its container are important...
       */
      extractElementByName: function (element, nodeName) {
        for (var i = 0, len = element.length; i < len; i++) {
          if (element[i].nodeName.toLowerCase() === nodeName) {
            return angular.element(element[i]);
          }
        }
        return element;
      },

      /**
       * Give optional properties with no value a boolean true if attr provided or false otherwise
       */
      initOptionalProperties: function (scope, attr, defaults) {
        defaults = defaults || {};
        angular.forEach(scope.$$isolateBindings, function (binding, key) {
          if (binding.optional && angular.isUndefined(scope[key])) {
            var attrIsDefined = angular.isDefined(attr[binding.attrName]);
            scope[key] = angular.isDefined(defaults[key]) ? defaults[key] : attrIsDefined;
          }
        });
      }

    };

  }]);

/*
 * Since removing jQuery from the demos, some code that uses `element.focus()` is broken.
 *
 * We need to add `element.focus()`, because it's testable unlike `element[0].focus`.
 *
 * TODO(ajoslin): This should be added in a better place later.
 */

angular.element.prototype.focus = angular.element.prototype.focus || function () {
    if (this.length) {
      this[0].focus();
    }
    return this;
  };
angular.element.prototype.blur = angular.element.prototype.blur || function () {
    if (this.length) {
      this[0].blur();
    }
    return this;
  };

})();
(function(){
"use strict";


angular.module('material.core')
  .service('$mdAria', AriaService);

/*
 * @ngInject
 */
function AriaService($$rAF, $log, $window) {

  return {
    expect: expect,
    expectAsync: expectAsync,
    expectWithText: expectWithText
  };

  /**
   * Check if expected attribute has been specified on the target element or child
   * @param element
   * @param attrName
   * @param {optional} defaultValue What to set the attr to if no value is found
   */
  function expect(element, attrName, defaultValue) {
    var node = element[0] || element;

    // if node exists and neither it nor its children have the attribute
    if (node &&
       ((!node.hasAttribute(attrName) ||
        node.getAttribute(attrName).length === 0) &&
        !childHasAttribute(node, attrName))) {

      defaultValue = angular.isString(defaultValue) ? defaultValue.trim() : '';
      if (defaultValue.length) {
        element.attr(attrName, defaultValue);
      } else {
        $log.warn('ARIA: Attribute "', attrName, '", required for accessibility, is missing on node:', node);
      }

    }
  }

  function expectAsync(element, attrName, defaultValueGetter) {
    // Problem: when retrieving the element's contents synchronously to find the label,
    // the text may not be defined yet in the case of a binding.
    // There is a higher chance that a binding will be defined if we wait one frame.
    $$rAF(function() {
      expect(element, attrName, defaultValueGetter());
    });
  }

  function expectWithText(element, attrName) {
    expectAsync(element, attrName, function() {
      return getText(element);
    });
  }

  function getText(element) {
    return element.text().trim();
  }

  function childHasAttribute(node, attrName) {
    var hasChildren = node.hasChildNodes(),
        hasAttr = false;

    function isHidden(el) {
      var style = el.currentStyle ? el.currentStyle : $window.getComputedStyle(el);
      return (style.display === 'none');
    }

    if(hasChildren) {
      var children = node.childNodes;
      for(var i=0; i<children.length; i++){
        var child = children[i];
        if(child.nodeType === 1 && child.hasAttribute(attrName)) {
          if(!isHidden(child)){
            hasAttr = true;
          }
        }
      }
    }
    return hasAttr;
  }
}
AriaService.$inject = ["$$rAF", "$log", "$window"];

})();
(function(){
"use strict";

angular.module('material.core')
  .service('$mdCompiler', mdCompilerService);

function mdCompilerService($q, $http, $injector, $compile, $controller, $templateCache) {
  /* jshint validthis: true */

  /*
   * @ngdoc service
   * @name $mdCompiler
   * @module material.core
   * @description
   * The $mdCompiler service is an abstraction of angular's compiler, that allows the developer
   * to easily compile an element with a templateUrl, controller, and locals.
   *
   * @usage
   * <hljs lang="js">
   * $mdCompiler.compile({
   *   templateUrl: 'modal.html',
   *   controller: 'ModalCtrl',
   *   locals: {
   *     modal: myModalInstance;
   *   }
   * }).then(function(compileData) {
   *   compileData.element; // modal.html's template in an element
   *   compileData.link(myScope); //attach controller & scope to element
   * });
   * </hljs>
   */

   /*
    * @ngdoc method
    * @name $mdCompiler#compile
    * @description A helper to compile an HTML template/templateUrl with a given controller,
    * locals, and scope.
    * @param {object} options An options object, with the following properties:
    *
    *    - `controller` - `{(string=|function()=}` Controller fn that should be associated with
    *      newly created scope or the name of a registered controller if passed as a string.
    *    - `controllerAs` - `{string=}` A controller alias name. If present the controller will be
    *      published to scope under the `controllerAs` name.
    *    - `template` - `{string=}` An html template as a string.
    *    - `templateUrl` - `{string=}` A path to an html template.
    *    - `transformTemplate` - `{function(template)=}` A function which transforms the template after
    *      it is loaded. It will be given the template string as a parameter, and should
    *      return a a new string representing the transformed template.
    *    - `resolve` - `{Object.<string, function>=}` - An optional map of dependencies which should
    *      be injected into the controller. If any of these dependencies are promises, the compiler
    *      will wait for them all to be resolved, or if one is rejected before the controller is
    *      instantiated `compile()` will fail..
    *      * `key` - `{string}`: a name of a dependency to be injected into the controller.
    *      * `factory` - `{string|function}`: If `string` then it is an alias for a service.
    *        Otherwise if function, then it is injected and the return value is treated as the
    *        dependency. If the result is a promise, it is resolved before its value is 
    *        injected into the controller.
    *
    * @returns {object=} promise A promise, which will be resolved with a `compileData` object.
    * `compileData` has the following properties: 
    *
    *   - `element` - `{element}`: an uncompiled element matching the provided template.
    *   - `link` - `{function(scope)}`: A link function, which, when called, will compile
    *     the element and instantiate the provided controller (if given).
    *   - `locals` - `{object}`: The locals which will be passed into the controller once `link` is
    *     called. If `bindToController` is true, they will be coppied to the ctrl instead
    *   - `bindToController` - `bool`: bind the locals to the controller, instead of passing them in.
    */
  this.compile = function(options) {
    var templateUrl = options.templateUrl;
    var template = options.template || '';
    var controller = options.controller;
    var controllerAs = options.controllerAs;
    var resolve = options.resolve || {};
    var locals = options.locals || {};
    var transformTemplate = options.transformTemplate || angular.identity;
    var bindToController = options.bindToController;

    // Take resolve values and invoke them.  
    // Resolves can either be a string (value: 'MyRegisteredAngularConst'),
    // or an invokable 'factory' of sorts: (value: function ValueGetter($dependency) {})
    angular.forEach(resolve, function(value, key) {
      if (angular.isString(value)) {
        resolve[key] = $injector.get(value);
      } else {
        resolve[key] = $injector.invoke(value);
      }
    });
    //Add the locals, which are just straight values to inject
    //eg locals: { three: 3 }, will inject three into the controller
    angular.extend(resolve, locals);

    if (templateUrl) {
      resolve.$template = $http.get(templateUrl, {cache: $templateCache})
        .then(function(response) {
          return response.data;
        });
    } else {
      resolve.$template = $q.when(template);
    }

    // Wait for all the resolves to finish if they are promises
    return $q.all(resolve).then(function(locals) {

      var template = transformTemplate(locals.$template);
      var element = options.element || angular.element('<div>').html(template.trim()).contents();
      var linkFn = $compile(element);

      //Return a linking function that can be used later when the element is ready
      return {
        locals: locals,
        element: element,
        link: function link(scope) {
          locals.$scope = scope;

          //Instantiate controller if it exists, because we have scope
          if (controller) {
            var invokeCtrl = $controller(controller, locals, true);
            if (bindToController) {
              angular.extend(invokeCtrl.instance, locals);
            }
            var ctrl = invokeCtrl();
            //See angular-route source for this logic
            element.data('$ngControllerController', ctrl);
            element.children().data('$ngControllerController', ctrl);

            if (controllerAs) {
              scope[controllerAs] = ctrl;
            }
          }
          return linkFn(scope);
        }
      };
    });

  };
}
mdCompilerService.$inject = ["$q", "$http", "$injector", "$compile", "$controller", "$templateCache"];

})();
(function(){
"use strict";

  var HANDLERS = {};
  /* The state of the current 'pointer'
   * The pointer represents the state of the current touch.
   * It contains normalized x and y coordinates from DOM events,
   * as well as other information abstracted from the DOM.
   */
  var pointer, lastPointer, forceSkipClickHijack = false;

  // Used to attach event listeners once when multiple ng-apps are running.
  var isInitialized = false;
  
  angular
    .module('material.core.gestures', [ ])
    .provider('$mdGesture', MdGestureProvider)
    .factory('$$MdGestureHandler', MdGestureHandler)
    .run( attachToDocument );

  /**
     * @ngdoc service
     * @name $mdGestureProvider
     * @module material.core.gestures
     *
     * @description
     * In some scenarios on Mobile devices (without jQuery), the click events should NOT be hijacked.
     * `$mdGestureProvider` is used to configure the Gesture module to ignore or skip click hijacking on mobile
     * devices.
     *
     * <hljs lang="js">
     *   app.config(function($mdGestureProvider) {
     *
     *     // For mobile devices without jQuery loaded, do not
     *     // intercept click events during the capture phase.
     *     $mdGestureProvider.skipClickHijack();
     *
     *   });
     * </hljs>
     *
     */
  function MdGestureProvider() { }

  MdGestureProvider.prototype = {

    // Publish access to setter to configure a variable  BEFORE the
    // $mdGesture service is instantiated...
    skipClickHijack: function() {
      return forceSkipClickHijack = true;
    },

    /**
     * $get is used to build an instance of $mdGesture
     * @ngInject
     */
    $get : ["$$MdGestureHandler", "$$rAF", "$timeout", function($$MdGestureHandler, $$rAF, $timeout) {
         return new MdGesture($$MdGestureHandler, $$rAF, $timeout);
    }]
  };



  /**
   * MdGesture factory construction function
   * @ngInject
   */
  function MdGesture($$MdGestureHandler, $$rAF, $timeout) {
    var userAgent = navigator.userAgent || navigator.vendor || window.opera;
    var isIos = userAgent.match(/ipad|iphone|ipod/i);
    var isAndroid = userAgent.match(/android/i);
    var hasJQuery =  (typeof window.jQuery !== 'undefined') && (angular.element === window.jQuery);

    var self = {
      handler: addHandler,
      register: register,
      // On mobile w/out jQuery, we normally intercept clicks. Should we skip that?
      isHijackingClicks: (isIos || isAndroid) && !hasJQuery && !forceSkipClickHijack
    };

    if (self.isHijackingClicks) {
      self.handler('click', {
        options: {
          maxDistance: 6
        },
        onEnd: function (ev, pointer) {
          if (pointer.distance < this.state.options.maxDistance) {
            this.dispatchEvent(ev, 'click');
          }
        }
      });
    }

    /*
     * Register an element to listen for a handler.
     * This allows an element to override the default options for a handler.
     * Additionally, some handlers like drag and hold only dispatch events if
     * the domEvent happens inside an element that's registered to listen for these events.
     *
     * @see GestureHandler for how overriding of default options works.
     * @example $mdGesture.register(myElement, 'drag', { minDistance: 20, horziontal: false })
     */
    function register(element, handlerName, options) {
      var handler = HANDLERS[handlerName.replace(/^\$md./, '')];
      if (!handler) {
        throw new Error('Failed to register element with handler ' + handlerName + '. ' +
        'Available handlers: ' + Object.keys(HANDLERS).join(', '));
      }
      return handler.registerElement(element, options);
    }

    /*
     * add a handler to $mdGesture. see below.
     */
    function addHandler(name, definition) {
      var handler = new $$MdGestureHandler(name);
      angular.extend(handler, definition);
      HANDLERS[name] = handler;

      return self;
    }

    /*
     * Register handlers. These listen to touch/start/move events, interpret them,
     * and dispatch gesture events depending on options & conditions. These are all
     * instances of GestureHandler.
     * @see GestureHandler 
     */
    return self
      /*
       * The press handler dispatches an event on touchdown/touchend.
       * It's a simple abstraction of touch/mouse/pointer start and end.
       */
      .handler('press', {
        onStart: function (ev, pointer) {
          this.dispatchEvent(ev, '$md.pressdown');
        },
        onEnd: function (ev, pointer) {
          this.dispatchEvent(ev, '$md.pressup');
        }
      })

      /*
       * The hold handler dispatches an event if the user keeps their finger within
       * the same <maxDistance> area for <delay> ms.
       * The hold handler will only run if a parent of the touch target is registered
       * to listen for hold events through $mdGesture.register()
       */
      .handler('hold', {
        options: {
          maxDistance: 6,
          delay: 500
        },
        onCancel: function () {
          $timeout.cancel(this.state.timeout);
        },
        onStart: function (ev, pointer) {
          // For hold, require a parent to be registered with $mdGesture.register()
          // Because we prevent scroll events, this is necessary.
          if (!this.state.registeredParent) return this.cancel();

          this.state.pos = {x: pointer.x, y: pointer.y};
          this.state.timeout = $timeout(angular.bind(this, function holdDelayFn() {
            this.dispatchEvent(ev, '$md.hold');
            this.cancel(); //we're done!
          }), this.state.options.delay, false);
        },
        onMove: function (ev, pointer) {
          // Don't scroll while waiting for hold.
          // If we don't preventDefault touchmove events here, Android will assume we don't
          // want to listen to anymore touch events. It will start scrolling and stop sending
          // touchmove events.
          ev.preventDefault();

          // If the user moves greater than <maxDistance> pixels, stop the hold timer
          // set in onStart
          var dx = this.state.pos.x - pointer.x;
          var dy = this.state.pos.y - pointer.y;
          if (Math.sqrt(dx * dx + dy * dy) > this.options.maxDistance) {
            this.cancel();
          }
        },
        onEnd: function () {
          this.onCancel();
        }
      })

      /*
       * The drag handler dispatches a drag event if the user holds and moves his finger greater than
       * <minDistance> px in the x or y direction, depending on options.horizontal.
       * The drag will be cancelled if the user moves his finger greater than <minDistance>*<cancelMultiplier> in
       * the perpindicular direction. Eg if the drag is horizontal and the user moves his finger <minDistance>*<cancelMultiplier>
       * pixels vertically, this handler won't consider the move part of a drag.
       */
      .handler('drag', {
        options: {
          minDistance: 6,
          horizontal: true,
          cancelMultiplier: 1.5
        },
        onStart: function (ev) {
          // For drag, require a parent to be registered with $mdGesture.register()
          if (!this.state.registeredParent) this.cancel();
        },
        onMove: function (ev, pointer) {
          var shouldStartDrag, shouldCancel;
          // Don't scroll while deciding if this touchmove qualifies as a drag event.
          // If we don't preventDefault touchmove events here, Android will assume we don't
          // want to listen to anymore touch events. It will start scrolling and stop sending
          // touchmove events.
          ev.preventDefault();

          if (!this.state.dragPointer) {
            if (this.state.options.horizontal) {
              shouldStartDrag = Math.abs(pointer.distanceX) > this.state.options.minDistance;
              shouldCancel = Math.abs(pointer.distanceY) > this.state.options.minDistance * this.state.options.cancelMultiplier;
            } else {
              shouldStartDrag = Math.abs(pointer.distanceY) > this.state.options.minDistance;
              shouldCancel = Math.abs(pointer.distanceX) > this.state.options.minDistance * this.state.options.cancelMultiplier;
            }

            if (shouldStartDrag) {
              // Create a new pointer representing this drag, starting at this point where the drag started.
              this.state.dragPointer = makeStartPointer(ev);
              updatePointerState(ev, this.state.dragPointer);
              this.dispatchEvent(ev, '$md.dragstart', this.state.dragPointer);

            } else if (shouldCancel) {
              this.cancel();
            }
          } else {
            this.dispatchDragMove(ev);
          }
        },
        // Only dispatch dragmove events every frame; any more is unnecessray
        dispatchDragMove: $$rAF.throttle(function (ev) {
          // Make sure the drag didn't stop while waiting for the next frame
          if (this.state.isRunning) {
            updatePointerState(ev, this.state.dragPointer);
            this.dispatchEvent(ev, '$md.drag', this.state.dragPointer);
          }
        }),
        onEnd: function (ev, pointer) {
          if (this.state.dragPointer) {
            updatePointerState(ev, this.state.dragPointer);
            this.dispatchEvent(ev, '$md.dragend', this.state.dragPointer);
          }
        }
      })

      /*
       * The swipe handler will dispatch a swipe event if, on the end of a touch,
       * the velocity and distance were high enough.
       * TODO: add vertical swiping with a `horizontal` option similar to the drag handler.
       */
      .handler('swipe', {
        options: {
          minVelocity: 0.65,
          minDistance: 10
        },
        onEnd: function (ev, pointer) {
          if (Math.abs(pointer.velocityX) > this.state.options.minVelocity &&
            Math.abs(pointer.distanceX) > this.state.options.minDistance) {
            var eventType = pointer.directionX == 'left' ? '$md.swipeleft' : '$md.swiperight';
            this.dispatchEvent(ev, eventType);
          }
        }
      });

  }
  MdGesture.$inject = ["$$MdGestureHandler", "$$rAF", "$timeout"];

  /**
   * MdGestureHandler
   * A GestureHandler is an object which is able to dispatch custom dom events
   * based on native dom {touch,pointer,mouse}{start,move,end} events.
   *
   * A gesture will manage its lifecycle through the start,move,end, and cancel
   * functions, which are called by native dom events.
   *
   * A gesture has the concept of 'options' (eg a swipe's required velocity), which can be
   * overridden by elements registering through $mdGesture.register()
   */
  function GestureHandler (name) {
    this.name = name;
    this.state = {};
  }

  function MdGestureHandler() {
    var hasJQuery =  (typeof window.jQuery !== 'undefined') && (angular.element === window.jQuery);

    GestureHandler.prototype = {
      options: {},
      // jQuery listeners don't work with custom DOMEvents, so we have to dispatch events
      // differently when jQuery is loaded
      dispatchEvent: hasJQuery ?  jQueryDispatchEvent : nativeDispatchEvent,

      // These are overridden by the registered handler
      onStart: angular.noop,
      onMove: angular.noop,
      onEnd: angular.noop,
      onCancel: angular.noop,

      // onStart sets up a new state for the handler, which includes options from the
      // nearest registered parent element of ev.target.
      start: function (ev, pointer) {
        if (this.state.isRunning) return;
        var parentTarget = this.getNearestParent(ev.target);
        // Get the options from the nearest registered parent
        var parentTargetOptions = parentTarget && parentTarget.$mdGesture[this.name] || {};

        this.state = {
          isRunning: true,
          // Override the default options with the nearest registered parent's options
          options: angular.extend({}, this.options, parentTargetOptions),
          // Pass in the registered parent node to the state so the onStart listener can use
          registeredParent: parentTarget
        };
        this.onStart(ev, pointer);
      },
      move: function (ev, pointer) {
        if (!this.state.isRunning) return;
        this.onMove(ev, pointer);
      },
      end: function (ev, pointer) {
        if (!this.state.isRunning) return;
        this.onEnd(ev, pointer);
        this.state.isRunning = false;
      },
      cancel: function (ev, pointer) {
        this.onCancel(ev, pointer);
        this.state = {};
      },

      // Find and return the nearest parent element that has been registered to
      // listen for this handler via $mdGesture.register(element, 'handlerName').
      getNearestParent: function (node) {
        var current = node;
        while (current) {
          if ((current.$mdGesture || {})[this.name]) {
            return current;
          }
          current = current.parentNode;
        }
        return null;
      },

      // Called from $mdGesture.register when an element reigsters itself with a handler.
      // Store the options the user gave on the DOMElement itself. These options will
      // be retrieved with getNearestParent when the handler starts.
      registerElement: function (element, options) {
        var self = this;
        element[0].$mdGesture = element[0].$mdGesture || {};
        element[0].$mdGesture[this.name] = options || {};
        element.on('$destroy', onDestroy);

        return onDestroy;

        function onDestroy() {
          delete element[0].$mdGesture[self.name];
          element.off('$destroy', onDestroy);
        }
      }
    };

    return GestureHandler;

    /*
     * Dispatch an event with jQuery
     * TODO: Make sure this sends bubbling events
     *
     * @param srcEvent the original DOM touch event that started this.
     * @param eventType the name of the custom event to send (eg 'click' or '$md.drag')
     * @param eventPointer the pointer object that matches this event.
     */
    function jQueryDispatchEvent(srcEvent, eventType, eventPointer) {
      eventPointer = eventPointer || pointer;
      var eventObj = new angular.element.Event(eventType);

      eventObj.$material = true;
      eventObj.pointer = eventPointer;
      eventObj.srcEvent = srcEvent;

      angular.extend(eventObj, {
        clientX: eventPointer.x,
        clientY: eventPointer.y,
        screenX: eventPointer.x,
        screenY: eventPointer.y,
        pageX: eventPointer.x,
        pageY: eventPointer.y,
        ctrlKey: srcEvent.ctrlKey,
        altKey: srcEvent.altKey,
        shiftKey: srcEvent.shiftKey,
        metaKey: srcEvent.metaKey
      });
      angular.element(eventPointer.target).trigger(eventObj);
    }

    /*
     * NOTE: nativeDispatchEvent is very performance sensitive.
     * @param srcEvent the original DOM touch event that started this.
     * @param eventType the name of the custom event to send (eg 'click' or '$md.drag')
     * @param eventPointer the pointer object that matches this event.
     */
    function nativeDispatchEvent(srcEvent, eventType, eventPointer) {
      eventPointer = eventPointer || pointer;
      var eventObj;

      if (eventType === 'click') {
        eventObj = document.createEvent('MouseEvents');
        eventObj.initMouseEvent(
          'click', true, true, window, srcEvent.detail,
          eventPointer.x, eventPointer.y, eventPointer.x, eventPointer.y,
          srcEvent.ctrlKey, srcEvent.altKey, srcEvent.shiftKey, srcEvent.metaKey,
          srcEvent.button, srcEvent.relatedTarget || null
        );

      } else {
        eventObj = document.createEvent('CustomEvent');
        eventObj.initCustomEvent(eventType, true, true, {});
      }
      eventObj.$material = true;
      eventObj.pointer = eventPointer;
      eventObj.srcEvent = srcEvent;
      eventPointer.target.dispatchEvent(eventObj);
    }

  }

  /**
   * Attach Gestures: hook document and check shouldHijack clicks
   * @ngInject
   */
  function attachToDocument( $mdGesture, $$MdGestureHandler ) {

    // Polyfill document.contains for IE11.
    // TODO: move to util
    document.contains || (document.contains = function (node) {
      return document.body.contains(node);
    });

    if (!isInitialized && $mdGesture.isHijackingClicks ) {
      /*
       * If hijack clicks is true, we preventDefault any click that wasn't
       * sent by ngMaterial. This is because on older Android & iOS, a false, or 'ghost',
       * click event will be sent ~400ms after a touchend event happens.
       * The only way to know if this click is real is to prevent any normal
       * click events, and add a flag to events sent by material so we know not to prevent those.
       * 
       * Two exceptions to click events that should be prevented are:
       *  - click events sent by the keyboard (eg form submit)
       *  - events that originate from an Ionic app
       */
      document.addEventListener('click', function clickHijacker(ev) {
        var isKeyClick = ev.clientX === 0 && ev.clientY === 0;
        if (!isKeyClick && !ev.$material && !ev.isIonicTap) {
          ev.preventDefault();
          ev.stopPropagation();
        }
      }, true);
      
      isInitialized = true;
    }

    // Listen to all events to cover all platforms.
    var START_EVENTS = 'mousedown touchstart pointerdown';
    var MOVE_EVENTS = 'mousemove touchmove pointermove';
    var END_EVENTS = 'mouseup mouseleave touchend touchcancel pointerup pointercancel';

    angular.element(document)
      .on(START_EVENTS, gestureStart)
      .on(MOVE_EVENTS, gestureMove)
      .on(END_EVENTS, gestureEnd)
      // For testing
      .on('$$mdGestureReset', function gestureClearCache () {
        lastPointer = pointer = null;
      });

    /*
     * When a DOM event happens, run all registered gesture handlers' lifecycle
     * methods which match the DOM event.
     * Eg when a 'touchstart' event happens, runHandlers('start') will call and
     * run `handler.cancel()` and `handler.start()` on all registered handlers.
     */
    function runHandlers(handlerEvent, event) {
      var handler;
      for (var name in HANDLERS) {
        handler = HANDLERS[name];
        if( handler instanceof $$MdGestureHandler ) {

          if (handlerEvent === 'start') {
            // Run cancel to reset any handlers' state
            handler.cancel();
          }
          handler[handlerEvent](event, pointer);

        }
      }
    }

    /*
     * gestureStart vets if a start event is legitimate (and not part of a 'ghost click' from iOS/Android)
     * If it is legitimate, we initiate the pointer state and mark the current pointer's type
     * For example, for a touchstart event, mark the current pointer as a 'touch' pointer, so mouse events
     * won't effect it.
     */
    function gestureStart(ev) {
      // If we're already touched down, abort
      if (pointer) return;

      var now = +Date.now();

      // iOS & old android bug: after a touch event, a click event is sent 350 ms later.
      // If <400ms have passed, don't allow an event of a different type than the previous event
      if (lastPointer && !typesMatch(ev, lastPointer) && (now - lastPointer.endTime < 1500)) {
        return;
      }

      pointer = makeStartPointer(ev);

      runHandlers('start', ev);
    }
    /*
     * If a move event happens of the right type, update the pointer and run all the move handlers.
     * "of the right type": if a mousemove happens but our pointer started with a touch event, do nothing.
     */
    function gestureMove(ev) {
      if (!pointer || !typesMatch(ev, pointer)) return;

      updatePointerState(ev, pointer);
      runHandlers('move', ev);
    }
    /*
     * If an end event happens of the right type, update the pointer, run endHandlers, and save the pointer as 'lastPointer'
     */
    function gestureEnd(ev) {
      if (!pointer || !typesMatch(ev, pointer)) return;

      updatePointerState(ev, pointer);
      pointer.endTime = +Date.now();

      runHandlers('end', ev);

      lastPointer = pointer;
      pointer = null;
    }

  }
  attachToDocument.$inject = ["$mdGesture", "$$MdGestureHandler"];

  // ********************
  // Module Functions
  // ********************

  /*
   * Initiate the pointer. x, y, and the pointer's type.
   */
  function makeStartPointer(ev) {
    var point = getEventPoint(ev);
    var startPointer = {
      startTime: +Date.now(),
      target: ev.target,
      // 'p' for pointer events, 'm' for mouse, 't' for touch
      type: ev.type.charAt(0)
    };
    startPointer.startX = startPointer.x = point.pageX;
    startPointer.startY = startPointer.y = point.pageY;
    return startPointer;
  }

  /*
   * return whether the pointer's type matches the event's type.
   * Eg if a touch event happens but the pointer has a mouse type, return false.
   */
  function typesMatch(ev, pointer) {
    return ev && pointer && ev.type.charAt(0) === pointer.type;
  }

  /*
   * Update the given pointer based upon the given DOMEvent.
   * Distance, velocity, direction, duration, etc
   */
  function updatePointerState(ev, pointer) {
    var point = getEventPoint(ev);
    var x = pointer.x = point.pageX;
    var y = pointer.y = point.pageY;

    pointer.distanceX = x - pointer.startX;
    pointer.distanceY = y - pointer.startY;
    pointer.distance = Math.sqrt(
      pointer.distanceX * pointer.distanceX + pointer.distanceY * pointer.distanceY
    );

    pointer.directionX = pointer.distanceX > 0 ? 'right' : pointer.distanceX < 0 ? 'left' : '';
    pointer.directionY = pointer.distanceY > 0 ? 'up' : pointer.distanceY < 0 ? 'down' : '';

    pointer.duration = +Date.now() - pointer.startTime;
    pointer.velocityX = pointer.distanceX / pointer.duration;
    pointer.velocityY = pointer.distanceY / pointer.duration;
  }

  /*
   * Normalize the point where the DOM event happened whether it's touch or mouse.
   * @returns point event obj with pageX and pageY on it.
   */
  function getEventPoint(ev) {
    ev = ev.originalEvent || ev; // support jQuery events
    return (ev.touches && ev.touches[0]) ||
      (ev.changedTouches && ev.changedTouches[0]) ||
      ev;
  }

})();
(function(){
"use strict";

angular.module('material.core')
  .provider('$$interimElement', InterimElementProvider);

/*
 * @ngdoc service
 * @name $$interimElement
 * @module material.core
 *
 * @description
 *
 * Factory that contructs `$$interimElement.$service` services.
 * Used internally in material design for elements that appear on screen temporarily.
 * The service provides a promise-like API for interacting with the temporary
 * elements.
 *
 * ```js
 * app.service('$mdToast', function($$interimElement) {
 *   var $mdToast = $$interimElement(toastDefaultOptions);
 *   return $mdToast;
 * });
 * ```
 * @param {object=} defaultOptions Options used by default for the `show` method on the service.
 *
 * @returns {$$interimElement.$service}
 *
 */

function InterimElementProvider() {
  createInterimElementProvider.$get = InterimElementFactory;
  InterimElementFactory.$inject = ["$document", "$q", "$rootScope", "$timeout", "$rootElement", "$animate", "$interpolate", "$mdCompiler", "$mdTheming"];
  return createInterimElementProvider;

  /**
   * Returns a new provider which allows configuration of a new interimElement
   * service. Allows configuration of default options & methods for options,
   * as well as configuration of 'preset' methods (eg dialog.basic(): basic is a preset method)
   */
  function createInterimElementProvider(interimFactoryName) {
    var EXPOSED_METHODS = ['onHide', 'onShow', 'onRemove'];

    var customMethods = {};
    var providerConfig = {
      presets: {}
    };

    var provider = {
      setDefaults: setDefaults,
      addPreset: addPreset,
      addMethod: addMethod,
      $get: factory
    };

    /**
     * all interim elements will come with the 'build' preset
     */
    provider.addPreset('build', {
      methods: ['controller', 'controllerAs', 'resolve',
        'template', 'templateUrl', 'themable', 'transformTemplate', 'parent']
    });

    factory.$inject = ["$$interimElement", "$animate", "$injector"];
    return provider;

    /**
     * Save the configured defaults to be used when the factory is instantiated
     */
    function setDefaults(definition) {
      providerConfig.optionsFactory = definition.options;
      providerConfig.methods = (definition.methods || []).concat(EXPOSED_METHODS);
      return provider;
    }

    /**
     * Add a method to the factory that isn't specific to any interim element operations
     */

    function addMethod(name, fn) {
      customMethods[name] = fn;
      return provider;
    }

    /**
     * Save the configured preset to be used when the factory is instantiated
     */
    function addPreset(name, definition) {
      definition = definition || {};
      definition.methods = definition.methods || [];
      definition.options = definition.options || function() { return {}; };

      if (/^cancel|hide|show$/.test(name)) {
        throw new Error("Preset '" + name + "' in " + interimFactoryName + " is reserved!");
      }
      if (definition.methods.indexOf('_options') > -1) {
        throw new Error("Method '_options' in " + interimFactoryName + " is reserved!");
      }
      providerConfig.presets[name] = {
        methods: definition.methods.concat(EXPOSED_METHODS),
        optionsFactory: definition.options,
        argOption: definition.argOption
      };
      return provider;
    }

    /**
     * Create a factory that has the given methods & defaults implementing interimElement
     */
    /* @ngInject */
    function factory($$interimElement, $animate, $injector) {
      var defaultMethods;
      var defaultOptions;
      var interimElementService = $$interimElement();

      /*
       * publicService is what the developer will be using.
       * It has methods hide(), cancel(), show(), build(), and any other
       * presets which were set during the config phase.
       */
      var publicService = {
        hide: interimElementService.hide,
        cancel: interimElementService.cancel,
        show: showInterimElement
      };

      defaultMethods = providerConfig.methods || [];
      // This must be invoked after the publicService is initialized
      defaultOptions = invokeFactory(providerConfig.optionsFactory, {});

      // Copy over the simple custom methods
      angular.forEach(customMethods, function(fn, name) {
        publicService[name] = fn;
      });

      angular.forEach(providerConfig.presets, function(definition, name) {
        var presetDefaults = invokeFactory(definition.optionsFactory, {});
        var presetMethods = (definition.methods || []).concat(defaultMethods);

        // Every interimElement built with a preset has a field called `$type`,
        // which matches the name of the preset.
        // Eg in preset 'confirm', options.$type === 'confirm'
        angular.extend(presetDefaults, { $type: name });

        // This creates a preset class which has setter methods for every
        // method given in the `.addPreset()` function, as well as every
        // method given in the `.setDefaults()` function.
        //
        // @example
        // .setDefaults({
        //   methods: ['hasBackdrop', 'clickOutsideToClose', 'escapeToClose', 'targetEvent'],
        //   options: dialogDefaultOptions
        // })
        // .addPreset('alert', {
        //   methods: ['title', 'ok'],
        //   options: alertDialogOptions
        // })
        //
        // Set values will be passed to the options when interimElemnt.show() is called.
        function Preset(opts) {
          this._options = angular.extend({}, presetDefaults, opts);
        }
        angular.forEach(presetMethods, function(name) {
          Preset.prototype[name] = function(value) {
            this._options[name] = value;
            return this;
          };
        });

        // Create shortcut method for one-linear methods
        if (definition.argOption) {
          var methodName = 'show' + name.charAt(0).toUpperCase() + name.slice(1);
          publicService[methodName] = function(arg) {
            var config = publicService[name](arg);
            return publicService.show(config);
          };
        }

        // eg $mdDialog.alert() will return a new alert preset
        publicService[name] = function(arg) {
          // If argOption is supplied, eg `argOption: 'content'`, then we assume
          // if the argument is not an options object then it is the `argOption` option.
          //
          // @example `$mdToast.simple('hello')` // sets options.content to hello
          //                                     // because argOption === 'content'
          if (arguments.length && definition.argOption && !angular.isObject(arg) &&
              !angular.isArray(arg)) {
            return (new Preset())[definition.argOption](arg);
          } else {
            return new Preset(arg);
          }

        };
      });

      return publicService;

      function showInterimElement(opts) {
        // opts is either a preset which stores its options on an _options field,
        // or just an object made up of options
        if (opts && opts._options) opts = opts._options;
        return interimElementService.show(
          angular.extend({}, defaultOptions, opts)
        );
      }

      /**
       * Helper to call $injector.invoke with a local of the factory name for
       * this provider.
       * If an $mdDialog is providing options for a dialog and tries to inject
       * $mdDialog, a circular dependency error will happen.
       * We get around that by manually injecting $mdDialog as a local.
       */
      function invokeFactory(factory, defaultVal) {
        var locals = {};
        locals[interimFactoryName] = publicService;
        return $injector.invoke(factory || function() { return defaultVal; }, {}, locals);
      }

    }

  }

  /* @ngInject */
  function InterimElementFactory($document, $q, $rootScope, $timeout, $rootElement, $animate,
                                 $interpolate, $mdCompiler, $mdTheming ) {
    var startSymbol = $interpolate.startSymbol(),
        endSymbol = $interpolate.endSymbol(),
        usesStandardSymbols = ((startSymbol === '{{') && (endSymbol === '}}')),
        processTemplate  = usesStandardSymbols ? angular.identity : replaceInterpolationSymbols;

    return function createInterimElementService() {
      /*
       * @ngdoc service
       * @name $$interimElement.$service
       *
       * @description
       * A service used to control inserting and removing an element into the DOM.
       *
       */
      var stack = [];
      var service;
      return service = {
        show: show,
        hide: hide,
        cancel: cancel
      };

      /*
       * @ngdoc method
       * @name $$interimElement.$service#show
       * @kind function
       *
       * @description
       * Adds the `$interimElement` to the DOM and returns a promise that will be resolved or rejected
       * with hide or cancel, respectively.
       *
       * @param {*} options is hashMap of settings
       * @returns a Promise
       *
       */
      function show(options) {
        if (stack.length) {
          return service.cancel().then(function() {
            return show(options);
          });
        } else {
          var interimElement = new InterimElement(options);
          stack.push(interimElement);
          return interimElement.show().then(function() {
            return interimElement.deferred.promise;
          });
        }
      }

      /*
       * @ngdoc method
       * @name $$interimElement.$service#hide
       * @kind function
       *
       * @description
       * Removes the `$interimElement` from the DOM and resolves the promise returned from `show`
       *
       * @param {*} resolveParam Data to resolve the promise with
       * @returns a Promise that will be resolved after the element has been removed.
       *
       */
      function hide(response) {
        var interimElement = stack.shift();
        return interimElement && interimElement.remove().then(function() {
          interimElement.deferred.resolve(response);
        });
      }

      /*
       * @ngdoc method
       * @name $$interimElement.$service#cancel
       * @kind function
       *
       * @description
       * Removes the `$interimElement` from the DOM and rejects the promise returned from `show`
       *
       * @param {*} reason Data to reject the promise with
       * @returns Promise that will be resolved after the element has been removed.
       *
       */
      function cancel(reason) {
        var interimElement = stack.shift();
        return $q.when(interimElement && interimElement.remove().then(function() {
          interimElement.deferred.reject(reason);
        }));
      }


      /*
       * Internal Interim Element Object
       * Used internally to manage the DOM element and related data
       */
      function InterimElement(options) {
        var self;
        var hideTimeout, element, showDone, removeDone;

        options = options || {};
        options = angular.extend({
          preserveScope: false,
          scope: options.scope || $rootScope.$new(options.isolateScope),
          onShow: function(scope, element, options) {
            return $animate.enter(element, options.parent);
          },
          onRemove: function(scope, element, options) {
            // Element could be undefined if a new element is shown before
            // the old one finishes compiling.
            return element && $animate.leave(element) || $q.when();
          }
        }, options);

        if (options.template) {
          options.template = processTemplate(options.template);
        }

        return self = {
          options: options,
          deferred: $q.defer(),
          show: function() {
            var compilePromise;
            if (options.skipCompile) {
              compilePromise = $q(function(resolve) { 
                resolve({
                  locals: {},
                  link: function() { return options.element; }
                });
              });
            } else {
              compilePromise = $mdCompiler.compile(options);
            }

            return showDone = compilePromise.then(function(compileData) {
              angular.extend(compileData.locals, self.options);

              element = compileData.link(options.scope);

              // Search for parent at insertion time, if not specified
              if (angular.isFunction(options.parent)) {
                options.parent = options.parent(options.scope, element, options);
              } else if (angular.isString(options.parent)) {
                options.parent = angular.element($document[0].querySelector(options.parent));
              }

              // If parent querySelector/getter function fails, or it's just null,
              // find a default.
              if (!(options.parent || {}).length) {
                var el;
                if ($rootElement[0] && $rootElement[0].querySelector) {
                  el = $rootElement[0].querySelector(':not(svg) > body');
                }
                if (!el) el = $rootElement[0];
                if (el.nodeName == '#comment') {
                  el = $document[0].body;
                }
                options.parent = angular.element(el);
              }

              if (options.themable) $mdTheming(element);
              var ret = options.onShow(options.scope, element, options);
              return $q.when(ret)
                .then(function(){
                  // Issue onComplete callback when the `show()` finishes
                  (options.onComplete || angular.noop)(options.scope, element, options);
                  startHideTimeout();
                });

              function startHideTimeout() {
                if (options.hideDelay) {
                  hideTimeout = $timeout(service.cancel, options.hideDelay) ;
                }
              }
            }, function(reason) { showDone = true; self.deferred.reject(reason); });
          },
          cancelTimeout: function() {
            if (hideTimeout) {
              $timeout.cancel(hideTimeout);
              hideTimeout = undefined;
            }
          },
          remove: function() {
            self.cancelTimeout();
            return removeDone = $q.when(showDone).then(function() {
              var ret = element ? options.onRemove(options.scope, element, options) : true;
              return $q.when(ret).then(function() {
                if (!options.preserveScope) options.scope.$destroy();
                removeDone = true;
              });
            });
          }
        };
      }
    };

    /*
     * Replace `{{` and `}}` in a string (usually a template) with the actual start-/endSymbols used
     * for interpolation. This allows pre-defined templates (for components such as dialog, toast etc)
     * to continue to work in apps that use custom interpolation start-/endSymbols.
     *
     * @param {string} text The text in which to replace `{{` / `}}`
     * @returns {string} The modified string using the actual interpolation start-/endSymbols
     */
    function replaceInterpolationSymbols(text) {
      if (!text || !angular.isString(text)) return text;
      return text.replace(/\{\{/g, startSymbol).replace(/}}/g, endSymbol);
    }
  }

}

})();
(function(){
"use strict";

  /**
   * @ngdoc module
   * @name material.core.componentRegistry
   *
   * @description
   * A component instance registration service.
   * Note: currently this as a private service in the SideNav component.
   */
  angular.module('material.core')
    .factory('$mdComponentRegistry', ComponentRegistry);

  /*
   * @private
   * @ngdoc factory
   * @name ComponentRegistry
   * @module material.core.componentRegistry
   *
   */
  function ComponentRegistry($log, $q) {

    var self;
    var instances = [ ];
    var pendings = { };

    return self = {
      /**
       * Used to print an error when an instance for a handle isn't found.
       */
      notFoundError: function(handle) {
        $log.error('No instance found for handle', handle);
      },
      /**
       * Return all registered instances as an array.
       */
      getInstances: function() {
        return instances;
      },

      /**
       * Get a registered instance.
       * @param handle the String handle to look up for a registered instance.
       */
      get: function(handle) {
        if ( !isValidID(handle) ) return null;

        var i, j, instance;
        for(i = 0, j = instances.length; i < j; i++) {
          instance = instances[i];
          if(instance.$$mdHandle === handle) {
            return instance;
          }
        }
        return null;
      },

      /**
       * Register an instance.
       * @param instance the instance to register
       * @param handle the handle to identify the instance under.
       */
      register: function(instance, handle) {
        if ( !handle ) return angular.noop;

        instance.$$mdHandle = handle;
        instances.push(instance);
        resolveWhen();

        return deregister;

        /**
         * Remove registration for an instance
         */
        function deregister() {
          var index = instances.indexOf(instance);
          if (index !== -1) {
            instances.splice(index, 1);
          }
        }

        /**
         * Resolve any pending promises for this instance
         */
        function resolveWhen() {
          var dfd = pendings[handle];
          if ( dfd ) {
            dfd.resolve( instance );
            delete pendings[handle];
          }
        }
      },

      /**
       * Async accessor to registered component instance
       * If not available then a promise is created to notify
       * all listeners when the instance is registered.
       */
      when : function(handle) {
        if ( isValidID(handle) ) {
          var deferred = $q.defer();
          var instance = self.get(handle);

          if ( instance )  {
            deferred.resolve( instance );
          } else {
            pendings[handle] = deferred;
          }

          return deferred.promise;
        }
        return $q.reject("Invalid `md-component-id` value.");
      }

    };

    function isValidID(handle){
      return handle && (handle !== "");
    }

  }
  ComponentRegistry.$inject = ["$log", "$q"];

})();
(function(){
"use strict";

(function() {
  'use strict';

  /**
   * @ngdoc service
   * @name $mdButtonInkRipple
   * @module material.core
   *
   * @description
   * Provides ripple effects for md-button.  See $mdInkRipple service for all possible configuration options.
   *
   * @param {object=} scope Scope within the current context
   * @param {object=} element The element the ripple effect should be applied to
   * @param {object=} options (Optional) Configuration options to override the defaultripple configuration
   */

  angular.module('material.core')
    .factory('$mdButtonInkRipple', MdButtonInkRipple);

  function MdButtonInkRipple($mdInkRipple) {
    return {
      attach: attach
    };

    function attach(scope, element, options) {
      var elementOptions = optionsForElement(element);
      return $mdInkRipple.attach(scope, element, angular.extend(elementOptions, options));
    };

    function optionsForElement(element) {
      if (element.hasClass('md-icon-button')) {
        return {
          isMenuItem: element.hasClass('md-menu-item'),
          fitRipple: true,
          center: true
        };
      } else {
        return {
          isMenuItem: element.hasClass('md-menu-item'),
          dimBackground: true
        }
      }
    };
  }
  MdButtonInkRipple.$inject = ["$mdInkRipple"];;
})();

})();
(function(){
"use strict";

(function() {
  'use strict';

    /**
   * @ngdoc service
   * @name $mdCheckboxInkRipple
   * @module material.core
   *
   * @description
   * Provides ripple effects for md-checkbox.  See $mdInkRipple service for all possible configuration options.
   *
   * @param {object=} scope Scope within the current context
   * @param {object=} element The element the ripple effect should be applied to
   * @param {object=} options (Optional) Configuration options to override the defaultripple configuration
   */

  angular.module('material.core')
    .factory('$mdCheckboxInkRipple', MdCheckboxInkRipple);

  function MdCheckboxInkRipple($mdInkRipple) {
    return {
      attach: attach
    };

    function attach(scope, element, options) {
      return $mdInkRipple.attach(scope, element, angular.extend({
        center: true,
        dimBackground: false,
        fitRipple: true
      }, options));
    };
  }
  MdCheckboxInkRipple.$inject = ["$mdInkRipple"];;
})();

})();
(function(){
"use strict";

(function() {
  'use strict';

  /**
   * @ngdoc service
   * @name $mdListInkRipple
   * @module material.core
   *
   * @description
   * Provides ripple effects for md-list.  See $mdInkRipple service for all possible configuration options.
   *
   * @param {object=} scope Scope within the current context
   * @param {object=} element The element the ripple effect should be applied to
   * @param {object=} options (Optional) Configuration options to override the defaultripple configuration
   */

  angular.module('material.core')
    .factory('$mdListInkRipple', MdListInkRipple);

  function MdListInkRipple($mdInkRipple) {
    return {
      attach: attach
    };

    function attach(scope, element, options) {
      return $mdInkRipple.attach(scope, element, angular.extend({
        center: false,
        dimBackground: true,
        outline: false,
        rippleSize: 'full'
      }, options));
    };
  }
  MdListInkRipple.$inject = ["$mdInkRipple"];;
})();

})();
(function(){
"use strict";

angular.module('material.core')
  .factory('$mdInkRipple', InkRippleService)
  .directive('mdInkRipple', InkRippleDirective)
  .directive('mdNoInk', attrNoDirective())
  .directive('mdNoBar', attrNoDirective())
  .directive('mdNoStretch', attrNoDirective());

function InkRippleDirective($mdButtonInkRipple, $mdCheckboxInkRipple) {
  return {
    controller: angular.noop,
    link: function (scope, element, attr) {
      if (attr.hasOwnProperty('mdInkRippleCheckbox')) {
        $mdCheckboxInkRipple.attach(scope, element);
      } else {
        $mdButtonInkRipple.attach(scope, element);
      }
    }
  };
}
InkRippleDirective.$inject = ["$mdButtonInkRipple", "$mdCheckboxInkRipple"];

function InkRippleService($window, $timeout) {

  return {
    attach: attach
  };

  function attach(scope, element, options) {
    if (element.controller('mdNoInk')) return angular.noop;

    options = angular.extend({
      colorElement: element,
      mousedown: true,
      hover: true,
      focus: true,
      center: false,
      mousedownPauseTime: 150,
      dimBackground: false,
      outline: false,
      fullRipple: true,
      isMenuItem: false,
      fitRipple: false
    }, options);

    var rippleSize,
        controller = element.controller('mdInkRipple') || {},
        counter = 0,
        ripples = [],
        states = [],
        isActiveExpr = element.attr('md-highlight'),
        isActive = false,
        isHeld = false,
        node = element[0],
        rippleSizeSetting = element.attr('md-ripple-size'),
        color = parseColor(element.attr('md-ink-ripple')) || parseColor(options.colorElement.length && $window.getComputedStyle(options.colorElement[0]).color || 'rgb(0, 0, 0)');

    switch (rippleSizeSetting) {
      case 'full':
        options.fullRipple = true;
        break;
      case 'partial':
        options.fullRipple = false;
        break;
    }

    // expose onInput for ripple testing
    if (options.mousedown) {
      element.on('$md.pressdown', onPressDown)
        .on('$md.pressup', onPressUp);
    }

    controller.createRipple = createRipple;

    if (isActiveExpr) {
      scope.$watch(isActiveExpr, function watchActive(newValue) {
        isActive = newValue;
        if (isActive && !ripples.length) {
          $timeout(function () { createRipple(0, 0); }, 0, false);
        }
        angular.forEach(ripples, updateElement);
      });
    }

    // Publish self-detach method if desired...
    return function detach() {
      element.off('$md.pressdown', onPressDown)
        .off('$md.pressup', onPressUp);
      getRippleContainer().remove();
    };

    /**
     * Gets the current ripple container
     * If there is no ripple container, it creates one and returns it
     *
     * @returns {angular.element} ripple container element
     */
    function getRippleContainer() {
      var container = element.data('$mdRippleContainer');
      if (container) return container;
      container = angular.element('<div class="md-ripple-container">');
      element.append(container);
      element.data('$mdRippleContainer', container);
      return container;
    }

    function parseColor(color) {
      if (!color) return;
      if (color.indexOf('rgba') === 0) return color.replace(/\d?\.?\d*\s*\)\s*$/, '0.1)');
      if (color.indexOf('rgb')  === 0) return rgbToRGBA(color);
      if (color.indexOf('#')    === 0) return hexToRGBA(color);

      /**
       * Converts a hex value to an rgba string
       *
       * @param {string} hex value (3 or 6 digits) to be converted
       *
       * @returns {string} rgba color with 0.1 alpha
       */
      function hexToRGBA(color) {
        var hex = color.charAt(0) === '#' ? color.substr(1) : color,
          dig = hex.length / 3,
          red = hex.substr(0, dig),
          grn = hex.substr(dig, dig),
          blu = hex.substr(dig * 2);
        if (dig === 1) {
          red += red;
          grn += grn;
          blu += blu;
        }
        return 'rgba(' + parseInt(red, 16) + ',' + parseInt(grn, 16) + ',' + parseInt(blu, 16) + ',0.1)';
      }

      /**
       * Converts rgb value to rgba string
       *
       * @param {string} rgb color string
       *
       * @returns {string} rgba color with 0.1 alpha
       */
      function rgbToRGBA(color) {
        return color.replace(')', ', 0.1)').replace('(', 'a(');
      }

    }

    function removeElement(elem, wait) {
      ripples.splice(ripples.indexOf(elem), 1);
      if (ripples.length === 0) {
        getRippleContainer().css({ backgroundColor: '' });
      }
      $timeout(function () { elem.remove(); }, wait, false);
    }

    function updateElement(elem) {
      var index = ripples.indexOf(elem),
          state = states[index] || {},
          elemIsActive = ripples.length > 1 ? false : isActive,
          elemIsHeld   = ripples.length > 1 ? false : isHeld;
      if (elemIsActive || state.animating || elemIsHeld) {
        elem.addClass('md-ripple-visible');
      } else if (elem) {
        elem.removeClass('md-ripple-visible');
        if (options.outline) {
          elem.css({
            width: rippleSize + 'px',
            height: rippleSize + 'px',
            marginLeft: (rippleSize * -1) + 'px',
            marginTop: (rippleSize * -1) + 'px'
          });
        }
        removeElement(elem, options.outline ? 450 : 650);
      }
    }

    /**
     * Creates a ripple at the provided coordinates
     *
     * @param {number} left cursor position
     * @param {number} top cursor position
     *
     * @returns {angular.element} the generated ripple element
     */
    function createRipple(left, top) {

      color = parseColor(element.attr('md-ink-ripple')) || parseColor($window.getComputedStyle(options.colorElement[0]).color || 'rgb(0, 0, 0)');

      var container = getRippleContainer(),
          size = getRippleSize(left, top),
          css = getRippleCss(size, left, top),
          elem = getRippleElement(css),
          index = ripples.indexOf(elem),
          state = states[index] || {};

      rippleSize = size;

      state.animating = true;

      $timeout(function () {
        if (options.dimBackground) {
          container.css({ backgroundColor: color });
        }
        elem.addClass('md-ripple-placed md-ripple-scaled');
        if (options.outline) {
          elem.css({
            borderWidth: (size * 0.5) + 'px',
            marginLeft: (size * -0.5) + 'px',
            marginTop: (size * -0.5) + 'px'
          });
        } else {
          elem.css({ left: '50%', top: '50%' });
        }
        updateElement(elem);
        $timeout(function () {
          state.animating = false;
          updateElement(elem);
        }, (options.outline ? 450 : 225), false);
      }, 0, false);

      return elem;

      /**
       * Creates the ripple element with the provided css
       *
       * @param {object} css properties to be applied
       *
       * @returns {angular.element} the generated ripple element
       */
      function getRippleElement(css) {
        var elem = angular.element('<div class="md-ripple" data-counter="' + counter++ + '">');
        ripples.unshift(elem);
        states.unshift({ animating: true });
        container.append(elem);
        css && elem.css(css);
        return elem;
      }

      /**
       * Calculate the ripple size
       *
       * @returns {number} calculated ripple diameter
       */
      function getRippleSize(left, top) {
        var width = container.prop('offsetWidth'),
            height = container.prop('offsetHeight'),
            multiplier, size, rect;
        if (options.isMenuItem) {
          size = Math.sqrt(Math.pow(width, 2) + Math.pow(height, 2));
        } else if (options.outline) {
          rect = node.getBoundingClientRect();
          left -= rect.left;
          top -= rect.top;
          width = Math.max(left, width - left);
          height = Math.max(top, height - top);
          size = 2 * Math.sqrt(Math.pow(width, 2) + Math.pow(height, 2));
        } else {
          multiplier = options.fullRipple ? 1.1 : 0.8;
          size = Math.sqrt(Math.pow(width, 2) + Math.pow(height, 2)) * multiplier;
          if (options.fitRipple) {
            size = Math.min(height, width, size);
          }
        }
        return size;
      }

      /**
       * Generates the ripple css
       *
       * @param {number} the diameter of the ripple
       * @param {number} the left cursor offset
       * @param {number} the top cursor offset
       *
       * @returns {{backgroundColor: string, borderColor: string, width: string, height: string}}
       */
      function getRippleCss(size, left, top) {
        var rect = node.getBoundingClientRect(),
            css  = {
              backgroundColor: rgbaToRGB(color),
              borderColor: rgbaToRGB(color),
              width: size + 'px',
              height: size + 'px'
            };

        if (options.outline) {
          css.width = 0;
          css.height = 0;
        } else {
          css.marginLeft = css.marginTop = (size * -0.5) + 'px';
        }

        if (options.center) {
          css.left = css.top = '50%';
        } else {
          css.left = Math.round((left - rect.left) / container.prop('offsetWidth') * 100) + '%';
          css.top = Math.round((top - rect.top) / container.prop('offsetHeight') * 100) + '%';
        }

        return css;

        /**
         * Converts rgba string to rgb, removing the alpha value
         *
         * @param {string} rgba color
         *
         * @returns {string} rgb color
         */
        function rgbaToRGB(color) {
          return color.replace('rgba', 'rgb').replace(/,[^\),]+\)/, ')');
        }
      }
    }

    /**
     * Handles user input start and stop events
     *
     */
    function onPressDown(ev) {
      if (!isRippleAllowed()) return;

      createRipple(ev.pointer.x, ev.pointer.y);
      isHeld = true;
    }
    function onPressUp() {
      isHeld = false;
      var ripple = ripples[ ripples.length - 1 ];
      $timeout(function () { updateElement(ripple); }, 0, false);
    }

    /**
     * Determines if the ripple is allowed
     *
     * @returns {boolean} true if the ripple is allowed, false if not
     */
    function isRippleAllowed() {
      var parent = node.parentNode;
      var grandparent = parent && parent.parentNode;
      var ancestor = grandparent && grandparent.parentNode;
      return !isDisabled(node) && !isDisabled(parent) && !isDisabled(grandparent) && !isDisabled(ancestor);
      function isDisabled (elem) {
        return elem && elem.hasAttribute && elem.hasAttribute('disabled');
      }
    }

  }
}
InkRippleService.$inject = ["$window", "$timeout"];

/**
 * noink/nobar/nostretch directive: make any element that has one of
 * these attributes be given a controller, so that other directives can
 * `require:` these and see if there is a `no<xxx>` parent attribute.
 *
 * @usage
 * <hljs lang="html">
 * <parent md-no-ink>
 *   <child detect-no>
 *   </child>
 * </parent>
 * </hljs>
 *
 * <hljs lang="js">
 * myApp.directive('detectNo', function() {
 *   return {
 *     require: ['^?mdNoInk', ^?mdNoBar'],
 *     link: function(scope, element, attr, ctrls) {
 *       var noinkCtrl = ctrls[0];
 *       var nobarCtrl = ctrls[1];
 *       if (noInkCtrl) {
 *         alert("the md-no-ink flag has been specified on an ancestor!");
 *       }
 *       if (nobarCtrl) {
 *         alert("the md-no-bar flag has been specified on an ancestor!");
 *       }
 *     }
 *   };
 * });
 * </hljs>
 */
function attrNoDirective() {
  return function() {
    return {
      controller: angular.noop
    };
  };
}

})();
(function(){
"use strict";

(function() {
  'use strict';

    /**
   * @ngdoc service
   * @name $mdTabInkRipple
   * @module material.core
   *
   * @description
   * Provides ripple effects for md-tabs.  See $mdInkRipple service for all possible configuration options.
   *
   * @param {object=} scope Scope within the current context
   * @param {object=} element The element the ripple effect should be applied to
   * @param {object=} options (Optional) Configuration options to override the defaultripple configuration
   */

  angular.module('material.core')
    .factory('$mdTabInkRipple', MdTabInkRipple);

  function MdTabInkRipple($mdInkRipple) {
    return {
      attach: attach
    };

    function attach(scope, element, options) {
      return $mdInkRipple.attach(scope, element, angular.extend({
        center: false,
        dimBackground: true,
        outline: false,
        rippleSize: 'full'
      }, options));
    };
  }
  MdTabInkRipple.$inject = ["$mdInkRipple"];;
})();

})();
(function(){
"use strict";

angular.module('material.core.theming.palette', [])
.constant('$mdColorPalette', {
  'red': {
    '50': '#ffebee',
    '100': '#ffcdd2',
    '200': '#ef9a9a',
    '300': '#e57373',
    '400': '#ef5350',
    '500': '#f44336',
    '600': '#e53935',
    '700': '#d32f2f',
    '800': '#c62828',
    '900': '#b71c1c',
    'A100': '#ff8a80',
    'A200': '#ff5252',
    'A400': '#ff1744',
    'A700': '#d50000',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200 300 400 A100',
    'contrastStrongLightColors': '500 600 700 A200 A400 A700'
  },
  'pink': {
    '50': '#fce4ec',
    '100': '#f8bbd0',
    '200': '#f48fb1',
    '300': '#f06292',
    '400': '#ec407a',
    '500': '#e91e63',
    '600': '#d81b60',
    '700': '#c2185b',
    '800': '#ad1457',
    '900': '#880e4f',
    'A100': '#ff80ab',
    'A200': '#ff4081',
    'A400': '#f50057',
    'A700': '#c51162',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200 300 400 A100',
    'contrastStrongLightColors': '500 600 A200 A400 A700'
  },
  'purple': {
    '50': '#f3e5f5',
    '100': '#e1bee7',
    '200': '#ce93d8',
    '300': '#ba68c8',
    '400': '#ab47bc',
    '500': '#9c27b0',
    '600': '#8e24aa',
    '700': '#7b1fa2',
    '800': '#6a1b9a',
    '900': '#4a148c',
    'A100': '#ea80fc',
    'A200': '#e040fb',
    'A400': '#d500f9',
    'A700': '#aa00ff',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200 A100',
    'contrastStrongLightColors': '300 400 A200 A400 A700'
  },
  'deep-purple': {
    '50': '#ede7f6',
    '100': '#d1c4e9',
    '200': '#b39ddb',
    '300': '#9575cd',
    '400': '#7e57c2',
    '500': '#673ab7',
    '600': '#5e35b1',
    '700': '#512da8',
    '800': '#4527a0',
    '900': '#311b92',
    'A100': '#b388ff',
    'A200': '#7c4dff',
    'A400': '#651fff',
    'A700': '#6200ea',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200 A100',
    'contrastStrongLightColors': '300 400 A200'
  },
  'indigo': {
    '50': '#e8eaf6',
    '100': '#c5cae9',
    '200': '#9fa8da',
    '300': '#7986cb',
    '400': '#5c6bc0',
    '500': '#3f51b5',
    '600': '#3949ab',
    '700': '#303f9f',
    '800': '#283593',
    '900': '#1a237e',
    'A100': '#8c9eff',
    'A200': '#536dfe',
    'A400': '#3d5afe',
    'A700': '#304ffe',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200 A100',
    'contrastStrongLightColors': '300 400 A200 A400'
  },
  'blue': {
    '50': '#e3f2fd',
    '100': '#bbdefb',
    '200': '#90caf9',
    '300': '#64b5f6',
    '400': '#42a5f5',
    '500': '#2196f3',
    '600': '#1e88e5',
    '700': '#1976d2',
    '800': '#1565c0',
    '900': '#0d47a1',
    'A100': '#82b1ff',
    'A200': '#448aff',
    'A400': '#2979ff',
    'A700': '#2962ff',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '100 200 300 400 A100',
    'contrastStrongLightColors': '500 600 700 A200 A400 A700'
  },
  'light-blue': {
    '50': '#e1f5fe',
    '100': '#b3e5fc',
    '200': '#81d4fa',
    '300': '#4fc3f7',
    '400': '#29b6f6',
    '500': '#03a9f4',
    '600': '#039be5',
    '700': '#0288d1',
    '800': '#0277bd',
    '900': '#01579b',
    'A100': '#80d8ff',
    'A200': '#40c4ff',
    'A400': '#00b0ff',
    'A700': '#0091ea',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '500 600 700 800 900 A700',
    'contrastStrongLightColors': '500 600 700 800 A700'
  },
  'cyan': {
    '50': '#e0f7fa',
    '100': '#b2ebf2',
    '200': '#80deea',
    '300': '#4dd0e1',
    '400': '#26c6da',
    '500': '#00bcd4',
    '600': '#00acc1',
    '700': '#0097a7',
    '800': '#00838f',
    '900': '#006064',
    'A100': '#84ffff',
    'A200': '#18ffff',
    'A400': '#00e5ff',
    'A700': '#00b8d4',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '500 600 700 800 900',
    'contrastStrongLightColors': '500 600 700 800'
  },
  'teal': {
    '50': '#e0f2f1',
    '100': '#b2dfdb',
    '200': '#80cbc4',
    '300': '#4db6ac',
    '400': '#26a69a',
    '500': '#009688',
    '600': '#00897b',
    '700': '#00796b',
    '800': '#00695c',
    '900': '#004d40',
    'A100': '#a7ffeb',
    'A200': '#64ffda',
    'A400': '#1de9b6',
    'A700': '#00bfa5',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '500 600 700 800 900',
    'contrastStrongLightColors': '500 600 700'
  },
  'green': {
    '50': '#e8f5e9',
    '100': '#c8e6c9',
    '200': '#a5d6a7',
    '300': '#81c784',
    '400': '#66bb6a',
    '500': '#4caf50',
    '600': '#43a047',
    '700': '#388e3c',
    '800': '#2e7d32',
    '900': '#1b5e20',
    'A100': '#b9f6ca',
    'A200': '#69f0ae',
    'A400': '#00e676',
    'A700': '#00c853',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '500 600 700 800 900',
    'contrastStrongLightColors': '500 600 700'
  },
  'light-green': {
    '50': '#f1f8e9',
    '100': '#dcedc8',
    '200': '#c5e1a5',
    '300': '#aed581',
    '400': '#9ccc65',
    '500': '#8bc34a',
    '600': '#7cb342',
    '700': '#689f38',
    '800': '#558b2f',
    '900': '#33691e',
    'A100': '#ccff90',
    'A200': '#b2ff59',
    'A400': '#76ff03',
    'A700': '#64dd17',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '800 900',
    'contrastStrongLightColors': '800 900'
  },
  'lime': {
    '50': '#f9fbe7',
    '100': '#f0f4c3',
    '200': '#e6ee9c',
    '300': '#dce775',
    '400': '#d4e157',
    '500': '#cddc39',
    '600': '#c0ca33',
    '700': '#afb42b',
    '800': '#9e9d24',
    '900': '#827717',
    'A100': '#f4ff81',
    'A200': '#eeff41',
    'A400': '#c6ff00',
    'A700': '#aeea00',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '900',
    'contrastStrongLightColors': '900'
  },
  'yellow': {
    '50': '#fffde7',
    '100': '#fff9c4',
    '200': '#fff59d',
    '300': '#fff176',
    '400': '#ffee58',
    '500': '#ffeb3b',
    '600': '#fdd835',
    '700': '#fbc02d',
    '800': '#f9a825',
    '900': '#f57f17',
    'A100': '#ffff8d',
    'A200': '#ffff00',
    'A400': '#ffea00',
    'A700': '#ffd600',
    'contrastDefaultColor': 'dark'
  },
  'amber': {
    '50': '#fff8e1',
    '100': '#ffecb3',
    '200': '#ffe082',
    '300': '#ffd54f',
    '400': '#ffca28',
    '500': '#ffc107',
    '600': '#ffb300',
    '700': '#ffa000',
    '800': '#ff8f00',
    '900': '#ff6f00',
    'A100': '#ffe57f',
    'A200': '#ffd740',
    'A400': '#ffc400',
    'A700': '#ffab00',
    'contrastDefaultColor': 'dark'
  },
  'orange': {
    '50': '#fff3e0',
    '100': '#ffe0b2',
    '200': '#ffcc80',
    '300': '#ffb74d',
    '400': '#ffa726',
    '500': '#ff9800',
    '600': '#fb8c00',
    '700': '#f57c00',
    '800': '#ef6c00',
    '900': '#e65100',
    'A100': '#ffd180',
    'A200': '#ffab40',
    'A400': '#ff9100',
    'A700': '#ff6d00',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '800 900',
    'contrastStrongLightColors': '800 900'
  },
  'deep-orange': {
    '50': '#fbe9e7',
    '100': '#ffccbc',
    '200': '#ffab91',
    '300': '#ff8a65',
    '400': '#ff7043',
    '500': '#ff5722',
    '600': '#f4511e',
    '700': '#e64a19',
    '800': '#d84315',
    '900': '#bf360c',
    'A100': '#ff9e80',
    'A200': '#ff6e40',
    'A400': '#ff3d00',
    'A700': '#dd2c00',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200 300 400 A100 A200',
    'contrastStrongLightColors': '500 600 700 800 900 A400 A700'
  },
  'brown': {
    '50': '#efebe9',
    '100': '#d7ccc8',
    '200': '#bcaaa4',
    '300': '#a1887f',
    '400': '#8d6e63',
    '500': '#795548',
    '600': '#6d4c41',
    '700': '#5d4037',
    '800': '#4e342e',
    '900': '#3e2723',
    'A100': '#d7ccc8',
    'A200': '#bcaaa4',
    'A400': '#8d6e63',
    'A700': '#5d4037',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200',
    'contrastStrongLightColors': '300 400'
  },
  'grey': {
    '50': '#fafafa',
    '100': '#f5f5f5',
    '200': '#eeeeee',
    '300': '#e0e0e0',
    '400': '#bdbdbd',
    '500': '#9e9e9e',
    '600': '#757575',
    '700': '#616161',
    '800': '#424242',
    '900': '#212121',
    '1000': '#000000',
    'A100': '#ffffff',
    'A200': '#eeeeee',
    'A400': '#bdbdbd',
    'A700': '#616161',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '600 700 800 900'
  },
  'blue-grey': {
    '50': '#eceff1',
    '100': '#cfd8dc',
    '200': '#b0bec5',
    '300': '#90a4ae',
    '400': '#78909c',
    '500': '#607d8b',
    '600': '#546e7a',
    '700': '#455a64',
    '800': '#37474f',
    '900': '#263238',
    'A100': '#cfd8dc',
    'A200': '#b0bec5',
    'A400': '#78909c',
    'A700': '#455a64',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200 300',
    'contrastStrongLightColors': '400 500'
  }
});

})();
(function(){
"use strict";

angular.module('material.core.theming', ['material.core.theming.palette'])
  .directive('mdTheme', ThemingDirective)
  .directive('mdThemable', ThemableDirective)
  .provider('$mdTheming', ThemingProvider)
  .run(generateThemes);

/**
 * @ngdoc provider
 * @name $mdThemingProvider
 * @module material.core
 *
 * @description Provider to configure the `$mdTheming` service.
 */

/**
 * @ngdoc method
 * @name $mdThemingProvider#setDefaultTheme
 * @param {string} themeName Default theme name to be applied to elements. Default value is `default`.
 */

/**
 * @ngdoc method
 * @name $mdThemingProvider#alwaysWatchTheme
 * @param {boolean} watch Whether or not to always watch themes for changes and re-apply
 * classes when they change. Default is `false`. Enabling can reduce performance.
 */

/* Some Example Valid Theming Expressions
 * =======================================
 *
 * Intention group expansion: (valid for primary, accent, warn, background)
 *
 * {{primary-100}} - grab shade 100 from the primary palette
 * {{primary-100-0.7}} - grab shade 100, apply opacity of 0.7
 * {{primary-hue-1}} - grab the shade assigned to hue-1 from the primary palette
 * {{primary-hue-1-0.7}} - apply 0.7 opacity to primary-hue-1
 * {{primary-color}} - Generates .md-hue-1, .md-hue-2, .md-hue-3 with configured shades set for each hue
 * {{primary-color-0.7}} - Apply 0.7 opacity to each of the above rules
 * {{primary-contrast}} - Generates .md-hue-1, .md-hue-2, .md-hue-3 with configured contrast (ie. text) color shades set for each hue
 * {{primary-contrast-0.7}} - Apply 0.7 opacity to each of the above rules
 *
 * Foreground expansion: Applies rgba to black/white foreground text
 *
 * {{foreground-1}} - used for primary text
 * {{foreground-2}} - used for secondary text/divider
 * {{foreground-3}} - used for disabled text
 * {{foreground-4}} - used for dividers
 *
 */

// In memory generated CSS rules; registered by theme.name
var GENERATED = { };

// In memory storage of defined themes and color palettes (both loaded by CSS, and user specified)
var PALETTES;
var THEMES;

var DARK_FOREGROUND = {
  name: 'dark',
  '1': 'rgba(0,0,0,0.87)',
  '2': 'rgba(0,0,0,0.54)',
  '3': 'rgba(0,0,0,0.26)',
  '4': 'rgba(0,0,0,0.12)'
};
var LIGHT_FOREGROUND = {
  name: 'light',
  '1': 'rgba(255,255,255,1.0)',
  '2': 'rgba(255,255,255,0.7)',
  '3': 'rgba(255,255,255,0.3)',
  '4': 'rgba(255,255,255,0.12)'
};

var DARK_SHADOW = '1px 1px 0px rgba(0,0,0,0.4), -1px -1px 0px rgba(0,0,0,0.4)';
var LIGHT_SHADOW = '';

var DARK_CONTRAST_COLOR = colorToRgbaArray('rgba(0,0,0,0.87)');
var LIGHT_CONTRAST_COLOR = colorToRgbaArray('rgba(255,255,255,0.87');
var STRONG_LIGHT_CONTRAST_COLOR = colorToRgbaArray('rgb(255,255,255)');

var THEME_COLOR_TYPES = ['primary', 'accent', 'warn', 'background'];
var DEFAULT_COLOR_TYPE = 'primary';

// A color in a theme will use these hues by default, if not specified by user.
var LIGHT_DEFAULT_HUES = {
  'accent': {
    'default': 'A200',
    'hue-1': 'A100',
    'hue-2': 'A400',
    'hue-3': 'A700'
  },
  'background': {
    'default': 'A100',
    'hue-1': '300',
    'hue-2': '800',
    'hue-3': '900'
  }
};

var DARK_DEFAULT_HUES = {
  'background': {
    'default': '800',
    'hue-1': '300',
    'hue-2': '600',
    'hue-3': '900'
  }
};
THEME_COLOR_TYPES.forEach(function(colorType) {
  // Color types with unspecified default hues will use these default hue values
  var defaultDefaultHues = {
    'default': '500',
    'hue-1': '300',
    'hue-2': '800',
    'hue-3': 'A100'
  };
  if (!LIGHT_DEFAULT_HUES[colorType]) LIGHT_DEFAULT_HUES[colorType] = defaultDefaultHues;
  if (!DARK_DEFAULT_HUES[colorType]) DARK_DEFAULT_HUES[colorType] = defaultDefaultHues;
});

var VALID_HUE_VALUES = [
  '50', '100', '200', '300', '400', '500', '600',
  '700', '800', '900', 'A100', 'A200', 'A400', 'A700'
];

function ThemingProvider($mdColorPalette) {
  PALETTES = { };
  THEMES = { };

  var themingProvider;
  var defaultTheme = 'default';
  var alwaysWatchTheme = false;

  // Load JS Defined Palettes
  angular.extend(PALETTES, $mdColorPalette);

  // Default theme defined in core.js

  ThemingService.$inject = ["$rootScope", "$log"];
  return themingProvider = {
    definePalette: definePalette,
    extendPalette: extendPalette,
    theme: registerTheme,

    setDefaultTheme: function(theme) {
      defaultTheme = theme;
    },
    alwaysWatchTheme: function(alwaysWatch) {
      alwaysWatchTheme = alwaysWatch;
    },
    $get: ThemingService,
    _LIGHT_DEFAULT_HUES: LIGHT_DEFAULT_HUES,
    _DARK_DEFAULT_HUES: DARK_DEFAULT_HUES,
    _PALETTES: PALETTES,
    _THEMES: THEMES,
    _parseRules: parseRules,
    _rgba: rgba
  };

  // Example: $mdThemingProvider.definePalette('neonRed', { 50: '#f5fafa', ... });
  function definePalette(name, map) {
    map = map || {};
    PALETTES[name] = checkPaletteValid(name, map);
    return themingProvider;
  }

  // Returns an new object which is a copy of a given palette `name` with variables from
  // `map` overwritten
  // Example: var neonRedMap = $mdThemingProvider.extendPalette('red', { 50: '#f5fafafa' });
  function extendPalette(name, map) {
    return checkPaletteValid(name,  angular.extend({}, PALETTES[name] || {}, map) );
  }

  // Make sure that palette has all required hues
  function checkPaletteValid(name, map) {
    var missingColors = VALID_HUE_VALUES.filter(function(field) {
      return !map[field];
    });
    if (missingColors.length) {
      throw new Error("Missing colors %1 in palette %2!"
                      .replace('%1', missingColors.join(', '))
                      .replace('%2', name));
    }

    return map;
  }

  // Register a theme (which is a collection of color palettes to use with various states
  // ie. warn, accent, primary )
  // Optionally inherit from an existing theme
  // $mdThemingProvider.theme('custom-theme').primaryPalette('red');
  function registerTheme(name, inheritFrom) {
    if (THEMES[name]) return THEMES[name];

    inheritFrom = inheritFrom || 'default';

    var parentTheme = typeof inheritFrom === 'string' ? THEMES[inheritFrom] : inheritFrom;
    var theme = new Theme(name);

    if (parentTheme) {
      angular.forEach(parentTheme.colors, function(color, colorType) {
        theme.colors[colorType] = {
          name: color.name,
          // Make sure a COPY of the hues is given to the child color,
          // not the same reference.
          hues: angular.extend({}, color.hues)
        };
      });
    }
    THEMES[name] = theme;

    return theme;
  }

  function Theme(name) {
    var self = this;
    self.name = name;
    self.colors = {};

    self.dark = setDark;
    setDark(false);

    function setDark(isDark) {
      isDark = arguments.length === 0 ? true : !!isDark;

      // If no change, abort
      if (isDark === self.isDark) return;

      self.isDark = isDark;

      self.foregroundPalette = self.isDark ? LIGHT_FOREGROUND : DARK_FOREGROUND;
      self.foregroundShadow = self.isDark ? DARK_SHADOW : LIGHT_SHADOW;

      // Light and dark themes have different default hues.
      // Go through each existing color type for this theme, and for every
      // hue value that is still the default hue value from the previous light/dark setting,
      // set it to the default hue value from the new light/dark setting.
      var newDefaultHues = self.isDark ? DARK_DEFAULT_HUES : LIGHT_DEFAULT_HUES;
      var oldDefaultHues = self.isDark ? LIGHT_DEFAULT_HUES : DARK_DEFAULT_HUES;
      angular.forEach(newDefaultHues, function(newDefaults, colorType) {
        var color = self.colors[colorType];
        var oldDefaults = oldDefaultHues[colorType];
        if (color) {
          for (var hueName in color.hues) {
            if (color.hues[hueName] === oldDefaults[hueName]) {
              color.hues[hueName] = newDefaults[hueName];
            }
          }
        }
      });

      return self;
    }

    THEME_COLOR_TYPES.forEach(function(colorType) {
      var defaultHues = (self.isDark ? DARK_DEFAULT_HUES : LIGHT_DEFAULT_HUES)[colorType];
      self[colorType + 'Palette'] = function setPaletteType(paletteName, hues) {
        var color = self.colors[colorType] = {
          name: paletteName,
          hues: angular.extend({}, defaultHues, hues)
        };

        Object.keys(color.hues).forEach(function(name) {
          if (!defaultHues[name]) {
            throw new Error("Invalid hue name '%1' in theme %2's %3 color %4. Available hue names: %4"
              .replace('%1', name)
              .replace('%2', self.name)
              .replace('%3', paletteName)
              .replace('%4', Object.keys(defaultHues).join(', '))
            );
          }
        });
        Object.keys(color.hues).map(function(key) {
          return color.hues[key];
        }).forEach(function(hueValue) {
          if (VALID_HUE_VALUES.indexOf(hueValue) == -1) {
            throw new Error("Invalid hue value '%1' in theme %2's %3 color %4. Available hue values: %5"
              .replace('%1', hueValue)
              .replace('%2', self.name)
              .replace('%3', colorType)
              .replace('%4', paletteName)
              .replace('%5', VALID_HUE_VALUES.join(', '))
            );
          }
        });
        return self;
      };

      self[colorType + 'Color'] = function() {
        var args = Array.prototype.slice.call(arguments);
        console.warn('$mdThemingProviderTheme.' + colorType + 'Color() has been deprecated. ' +
                     'Use $mdThemingProviderTheme.' + colorType + 'Palette() instead.');
        return self[colorType + 'Palette'].apply(self, args);
      };
    });
  }

  /**
   * @ngdoc service
   * @name $mdTheming
   *
   * @description
   *
   * Service that makes an element apply theming related classes to itself.
   *
   * ```js
   * app.directive('myFancyDirective', function($mdTheming) {
   *   return {
   *     restrict: 'e',
   *     link: function(scope, el, attrs) {
   *       $mdTheming(el);
   *     }
   *   };
   * });
   * ```
   * @param {el=} element to apply theming to
   */
  /* @ngInject */
  function ThemingService($rootScope, $log) {

    applyTheme.inherit = function(el, parent) {
      var ctrl = parent.controller('mdTheme');

      var attrThemeValue = el.attr('md-theme-watch');
      if ( (alwaysWatchTheme || angular.isDefined(attrThemeValue)) && attrThemeValue != 'false') {
        var deregisterWatch = $rootScope.$watch(function() {
          return ctrl && ctrl.$mdTheme || defaultTheme;
        }, changeTheme);
        el.on('$destroy', deregisterWatch);
      } else {
        var theme = ctrl && ctrl.$mdTheme || defaultTheme;
        changeTheme(theme);
      }

      function changeTheme(theme) {
        if (!registered(theme)) {
          $log.warn('Attempted to use unregistered theme \'' + theme + '\'. ' +
                    'Register it with $mdThemingProvider.theme().');
        }
        var oldTheme = el.data('$mdThemeName');
        if (oldTheme) el.removeClass('md-' + oldTheme +'-theme');
        el.addClass('md-' + theme + '-theme');
        el.data('$mdThemeName', theme);
      }
    };

    applyTheme.THEMES = angular.extend({}, THEMES);
    applyTheme.defaultTheme = function() { return defaultTheme; };
    applyTheme.registered = registered;

    return applyTheme;

    function registered(themeName) {
      if (themeName === undefined || themeName === '') return true;
      return applyTheme.THEMES[themeName] !== undefined;
    }

    function applyTheme(scope, el) {
      // Allow us to be invoked via a linking function signature.
      if (el === undefined) {
        el = scope;
        scope = undefined;
      }
      if (scope === undefined) {
        scope = $rootScope;
      }
      applyTheme.inherit(el, el);
    }
  }
}
ThemingProvider.$inject = ["$mdColorPalette"];

function ThemingDirective($mdTheming, $interpolate, $log) {
  return {
    priority: 100,
    link: {
      pre: function(scope, el, attrs) {
        var ctrl = {
          $setTheme: function(theme) {
            if (!$mdTheming.registered(theme)) {
              $log.warn('attempted to use unregistered theme \'' + theme + '\'');
            }
            ctrl.$mdTheme = theme;
          }
        };
        el.data('$mdThemeController', ctrl);
        ctrl.$setTheme($interpolate(attrs.mdTheme)(scope));
        attrs.$observe('mdTheme', ctrl.$setTheme);
      }
    }
  };
}
ThemingDirective.$inject = ["$mdTheming", "$interpolate", "$log"];

function ThemableDirective($mdTheming) {
  return $mdTheming;
}
ThemableDirective.$inject = ["$mdTheming"];

function parseRules(theme, colorType, rules) {
  checkValidPalette(theme, colorType);

  rules = rules.replace(/THEME_NAME/g, theme.name);
  var generatedRules = [];
  var color = theme.colors[colorType];

  var themeNameRegex = new RegExp('.md-' + theme.name + '-theme', 'g');
  // Matches '{{ primary-color }}', etc
  var hueRegex = new RegExp('(\'|")?{{\\s*(' + colorType + ')-(color|contrast)-?(\\d\\.?\\d*)?\\s*}}(\"|\')?','g');
  var simpleVariableRegex = /'?"?\{\{\s*([a-zA-Z]+)-(A?\d+|hue\-[0-3]|shadow)-?(\d\.?\d*)?\s*\}\}'?"?/g;
  var palette = PALETTES[color.name];

  // find and replace simple variables where we use a specific hue, not an entire palette
  // eg. "{{primary-100}}"
  //\(' + THEME_COLOR_TYPES.join('\|') + '\)'
  rules = rules.replace(simpleVariableRegex, function(match, colorType, hue, opacity) {
    if (colorType === 'foreground') {
      if (hue == 'shadow') {
        return theme.foregroundShadow;
      } else {
        return theme.foregroundPalette[hue] || theme.foregroundPalette['1'];
      }
    }
    if (hue.indexOf('hue') === 0) {
      hue = theme.colors[colorType].hues[hue];
    }
    return rgba( (PALETTES[ theme.colors[colorType].name ][hue] || '').value, opacity );
  });

  // For each type, generate rules for each hue (ie. default, md-hue-1, md-hue-2, md-hue-3)
  angular.forEach(color.hues, function(hueValue, hueName) {
    var newRule = rules
      .replace(hueRegex, function(match, _, colorType, hueType, opacity) {
        return rgba(palette[hueValue][hueType === 'color' ? 'value' : 'contrast'], opacity);
      });
    if (hueName !== 'default') {
      newRule = newRule.replace(themeNameRegex, '.md-' + theme.name + '-theme.md-' + hueName);
    }

    // Don't apply a selector rule to the default theme, making it easier to override
    // styles of the base-component
    if (theme.name == 'default') {
      newRule = newRule.replace(/\.md-default-theme/g, '');
    }
    generatedRules.push(newRule);
  });

  return generatedRules;
}

// Generate our themes at run time given the state of THEMES and PALETTES
function generateThemes($injector) {

  var head = document.getElementsByTagName('head')[0];
  var firstChild = head ? head.firstElementChild : null;
  var themeCss = $injector.has('$MD_THEME_CSS') ? $injector.get('$MD_THEME_CSS') : '';

  if ( !firstChild ) return;
  if (themeCss.length === 0) return; // no rules, so no point in running this expensive task

  // Expose contrast colors for palettes to ensure that text is always readable
  angular.forEach(PALETTES, sanitizePalette);

  // MD_THEME_CSS is a string generated by the build process that includes all the themable
  // components as templates

  // Break the CSS into individual rules
  var rulesByType = {};
  var rules = themeCss
                  .split(/\}(?!(\}|'|"|;))/)
                  .filter(function(rule) { return rule && rule.length; })
                  .map(function(rule) { return rule.trim() + '}'; });


  var ruleMatchRegex = new RegExp('md-(' + THEME_COLOR_TYPES.join('|') + ')', 'g');

  THEME_COLOR_TYPES.forEach(function(type) {
    rulesByType[type] = '';
  });


  // Sort the rules based on type, allowing us to do color substitution on a per-type basis
  rules.forEach(function(rule) {
    var match = rule.match(ruleMatchRegex);
    // First: test that if the rule has '.md-accent', it goes into the accent set of rules
    for (var i = 0, type; type = THEME_COLOR_TYPES[i]; i++) {
      if (rule.indexOf('.md-' + type) > -1) {
        return rulesByType[type] += rule;
      }
    }

    // If no eg 'md-accent' class is found, try to just find 'accent' in the rule and guess from
    // there
    for (i = 0; type = THEME_COLOR_TYPES[i]; i++) {
      if (rule.indexOf(type) > -1) {
        return rulesByType[type] += rule;
      }
    }

    // Default to the primary array
    return rulesByType[DEFAULT_COLOR_TYPE] += rule;
  });

    // For each theme, use the color palettes specified for
    // `primary`, `warn` and `accent` to generate CSS rules.

    angular.forEach(THEMES, function(theme) {
      if ( !GENERATED[theme.name] ) {


        THEME_COLOR_TYPES.forEach(function(colorType) {
          var styleStrings = parseRules(theme, colorType, rulesByType[colorType]);
          while (styleStrings.length) {
            var style = document.createElement('style');
                style.setAttribute('type', 'text/css');
            style.appendChild(document.createTextNode(styleStrings.shift()));
            head.insertBefore(style, firstChild);
          }
        });


        if (theme.colors.primary.name == theme.colors.accent.name) {
          console.warn("$mdThemingProvider: Using the same palette for primary and" +
                       " accent. This violates the material design spec.");
        }

        GENERATED[theme.name] = true;
      }
    });


  // *************************
  // Internal functions
  // *************************

  // The user specifies a 'default' contrast color as either light or dark,
  // then explicitly lists which hues are the opposite contrast (eg. A100 has dark, A200 has light)
  function sanitizePalette(palette) {
    var defaultContrast = palette.contrastDefaultColor;
    var lightColors = palette.contrastLightColors || [];
    var strongLightColors = palette.contrastStrongLightColors || [];
    var darkColors = palette.contrastDarkColors || [];

    // These colors are provided as space-separated lists
    if (typeof lightColors === 'string') lightColors = lightColors.split(' ');
    if (typeof strongLightColors === 'string') strongLightColors = strongLightColors.split(' ');
    if (typeof darkColors === 'string') darkColors = darkColors.split(' ');

    // Cleanup after ourselves
    delete palette.contrastDefaultColor;
    delete palette.contrastLightColors;
    delete palette.contrastStrongLightColors;
    delete palette.contrastDarkColors;

    // Change { 'A100': '#fffeee' } to { 'A100': { value: '#fffeee', contrast:DARK_CONTRAST_COLOR }
    angular.forEach(palette, function(hueValue, hueName) {
      if (angular.isObject(hueValue)) return; // Already converted
      // Map everything to rgb colors
      var rgbValue = colorToRgbaArray(hueValue);
      if (!rgbValue) {
        throw new Error("Color %1, in palette %2's hue %3, is invalid. Hex or rgb(a) color expected."
                        .replace('%1', hueValue)
                        .replace('%2', palette.name)
                        .replace('%3', hueName));
      }

      palette[hueName] = {
        value: rgbValue,
        contrast: getContrastColor()
      };
      function getContrastColor() {
        if (defaultContrast === 'light') {
          if (darkColors.indexOf(hueName) > -1) {
            return DARK_CONTRAST_COLOR;
          } else {
            return strongLightColors.indexOf(hueName) > -1 ? STRONG_LIGHT_CONTRAST_COLOR
              : LIGHT_CONTRAST_COLOR;
          }
        } else {
          if (lightColors.indexOf(hueName) > -1) {
            return strongLightColors.indexOf(hueName) > -1 ? STRONG_LIGHT_CONTRAST_COLOR
              : LIGHT_CONTRAST_COLOR;
          } else {
            return DARK_CONTRAST_COLOR;
          }
        }
      }
    });
  }


}
generateThemes.$inject = ["$injector"];

function checkValidPalette(theme, colorType) {
  // If theme attempts to use a palette that doesnt exist, throw error
  if (!PALETTES[ (theme.colors[colorType] || {}).name ]) {
    throw new Error(
      "You supplied an invalid color palette for theme %1's %2 palette. Available palettes: %3"
                    .replace('%1', theme.name)
                    .replace('%2', colorType)
                    .replace('%3', Object.keys(PALETTES).join(', '))
    );
  }
}

function colorToRgbaArray(clr) {
  if (angular.isArray(clr) && clr.length == 3) return clr;
  if (/^rgb/.test(clr)) {
    return clr.replace(/(^\s*rgba?\(|\)\s*$)/g, '').split(',').map(function(value, i) {
      return i == 3 ? parseFloat(value, 10) : parseInt(value, 10);
    });
  }
  if (clr.charAt(0) == '#') clr = clr.substring(1);
  if (!/^([a-fA-F0-9]{3}){1,2}$/g.test(clr)) return;

  var dig = clr.length / 3;
  var red = clr.substr(0, dig);
  var grn = clr.substr(dig, dig);
  var blu = clr.substr(dig * 2);
  if (dig === 1) {
    red += red;
    grn += grn;
    blu += blu;
  }
  return [parseInt(red, 16), parseInt(grn, 16), parseInt(blu, 16)];
}

function rgba(rgbArray, opacity) {
  if ( !rgbArray ) return "rgb('0,0,0')";

  if (rgbArray.length == 4) {
    rgbArray = angular.copy(rgbArray);
    opacity ? rgbArray.pop() : opacity = rgbArray.pop();
  }
  return opacity && (typeof opacity == 'number' || (typeof opacity == 'string' && opacity.length)) ?
    'rgba(' + rgbArray.join(',') + ',' + opacity + ')' :
    'rgb(' + rgbArray.join(',') + ')';
}


})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.autocomplete
 */
/*
 * @see js folder for autocomplete implementation
 */
angular.module('material.components.autocomplete', [
  'material.core',
  'material.components.icon'
]);

})();
(function(){
"use strict";

/*
 * @ngdoc module
 * @name material.components.backdrop
 * @description Backdrop
 */

/**
 * @ngdoc directive
 * @name mdBackdrop
 * @module material.components.backdrop
 *
 * @restrict E
 *
 * @description
 * `<md-backdrop>` is a backdrop element used by other components, such as dialog and bottom sheet.
 * Apply class `opaque` to make the backdrop use the theme backdrop color.
 *
 */

angular.module('material.components.backdrop', [
  'material.core'
])
  .directive('mdBackdrop', BackdropDirective);

function BackdropDirective($mdTheming) {
  return $mdTheming;
}
BackdropDirective.$inject = ["$mdTheming"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.bottomSheet
 * @description
 * BottomSheet
 */
angular.module('material.components.bottomSheet', [
  'material.core',
  'material.components.backdrop'
])
  .directive('mdBottomSheet', MdBottomSheetDirective)
  .provider('$mdBottomSheet', MdBottomSheetProvider);

function MdBottomSheetDirective() {
  return {
    restrict: 'E'
  };
}

/**
 * @ngdoc service
 * @name $mdBottomSheet
 * @module material.components.bottomSheet
 *
 * @description
 * `$mdBottomSheet` opens a bottom sheet over the app and provides a simple promise API.
 *
 * ## Restrictions
 *
 * - The bottom sheet's template must have an outer `<md-bottom-sheet>` element.
 * - Add the `md-grid` class to the bottom sheet for a grid layout.
 * - Add the `md-list` class to the bottom sheet for a list layout.
 *
 * @usage
 * <hljs lang="html">
 * <div ng-controller="MyController">
 *   <md-button ng-click="openBottomSheet()">
 *     Open a Bottom Sheet!
 *   </md-button>
 * </div>
 * </hljs>
 * <hljs lang="js">
 * var app = angular.module('app', ['ngMaterial']);
 * app.controller('MyController', function($scope, $mdBottomSheet) {
 *   $scope.openBottomSheet = function() {
 *     $mdBottomSheet.show({
 *       template: '<md-bottom-sheet>Hello!</md-bottom-sheet>'
 *     });
 *   };
 * });
 * </hljs>
 */

 /**
 * @ngdoc method
 * @name $mdBottomSheet#show
 *
 * @description
 * Show a bottom sheet with the specified options.
 *
 * @param {object} options An options object, with the following properties:
 *
 *   - `templateUrl` - `{string=}`: The url of an html template file that will
 *   be used as the content of the bottom sheet. Restrictions: the template must
 *   have an outer `md-bottom-sheet` element.
 *   - `template` - `{string=}`: Same as templateUrl, except this is an actual
 *   template string.
 *   - `scope` - `{object=}`: the scope to link the template / controller to. If none is specified, it will create a new child scope.
 *     This scope will be destroyed when the bottom sheet is removed unless `preserveScope` is set to true.
 *   - `preserveScope` - `{boolean=}`: whether to preserve the scope when the element is removed. Default is false
 *   - `controller` - `{string=}`: The controller to associate with this bottom sheet.
 *   - `locals` - `{string=}`: An object containing key/value pairs. The keys will
 *   be used as names of values to inject into the controller. For example,
 *   `locals: {three: 3}` would inject `three` into the controller with the value
 *   of 3.
 *   - `targetEvent` - `{DOMClickEvent=}`: A click's event object. When passed in as an option,
 *   the location of the click will be used as the starting point for the opening animation
 *   of the the dialog.
 *   - `resolve` - `{object=}`: Similar to locals, except it takes promises as values
 *   and the bottom sheet will not open until the promises resolve.
 *   - `controllerAs` - `{string=}`: An alias to assign the controller to on the scope.
 *   - `parent` - `{element=}`: The element to append the bottom sheet to. The `parent` may be a `function`, `string`,
 *   `object`, or null. Defaults to appending to the body of the root element (or the root element) of the application.
 *   e.g. angular.element(document.getElementById('content')) or "#content"
 *   - `disableParentScroll` - `{boolean=}`: Whether to disable scrolling while the bottom sheet is open.
 *     Default true.
 *
 * @returns {promise} A promise that can be resolved with `$mdBottomSheet.hide()` or
 * rejected with `$mdBottomSheet.cancel()`.
 */

/**
 * @ngdoc method
 * @name $mdBottomSheet#hide
 *
 * @description
 * Hide the existing bottom sheet and resolve the promise returned from
 * `$mdBottomSheet.show()`. This call will close the most recently opened/current bottomsheet (if any).
 *
 * @param {*=} response An argument for the resolved promise.
 *
 */

/**
 * @ngdoc method
 * @name $mdBottomSheet#cancel
 *
 * @description
 * Hide the existing bottom sheet and reject the promise returned from
 * `$mdBottomSheet.show()`.
 *
 * @param {*=} response An argument for the rejected promise.
 *
 */

function MdBottomSheetProvider($$interimElementProvider) {
  // how fast we need to flick down to close the sheet, pixels/ms
  var CLOSING_VELOCITY = 0.5;
  var PADDING = 80; // same as css

  bottomSheetDefaults.$inject = ["$animate", "$mdConstant", "$mdUtil", "$timeout", "$compile", "$mdTheming", "$mdBottomSheet", "$rootElement", "$mdGesture"];
  return $$interimElementProvider('$mdBottomSheet')
    .setDefaults({
      methods: ['disableParentScroll', 'escapeToClose', 'targetEvent'],
      options: bottomSheetDefaults
    });

  /* @ngInject */
  function bottomSheetDefaults($animate, $mdConstant, $mdUtil, $timeout, $compile, $mdTheming, $mdBottomSheet, $rootElement, $mdGesture) {
    var backdrop;

    return {
      themable: true,
      targetEvent: null,
      onShow: onShow,
      onRemove: onRemove,
      escapeToClose: true,
      disableParentScroll: true
    };


    function onShow(scope, element, options) {

      element = $mdUtil.extractElementByName(element, 'md-bottom-sheet');

      // Add a backdrop that will close on click
      backdrop = $compile('<md-backdrop class="md-opaque md-bottom-sheet-backdrop">')(scope);
      backdrop.on('click', function() {
        $timeout($mdBottomSheet.cancel);
      });
      $mdTheming.inherit(backdrop, options.parent);

      $animate.enter(backdrop, options.parent, null);

      var bottomSheet = new BottomSheet(element, options.parent);
      options.bottomSheet = bottomSheet;

      // Give up focus on calling item
      options.targetEvent && angular.element(options.targetEvent.target).blur();
      $mdTheming.inherit(bottomSheet.element, options.parent);

      if (options.disableParentScroll) {
        options.lastOverflow = options.parent.css('overflow');
        options.parent.css('overflow', 'hidden');
      }

      return $animate.enter(bottomSheet.element, options.parent)
        .then(function() {
          var focusable = angular.element(
            element[0].querySelector('button') ||
            element[0].querySelector('a') ||
            element[0].querySelector('[ng-click]')
          );
          focusable.focus();

          if (options.escapeToClose) {
            options.rootElementKeyupCallback = function(e) {
              if (e.keyCode === $mdConstant.KEY_CODE.ESCAPE) {
                $timeout($mdBottomSheet.cancel);
              }
            };
            $rootElement.on('keyup', options.rootElementKeyupCallback);
          }
        });

    }

    function onRemove(scope, element, options) {

      var bottomSheet = options.bottomSheet;

      $animate.leave(backdrop);
      return $animate.leave(bottomSheet.element).then(function() {
        if (options.disableParentScroll) {
          options.parent.css('overflow', options.lastOverflow);
          delete options.lastOverflow;
        }

        bottomSheet.cleanup();

        // Restore focus
        options.targetEvent && angular.element(options.targetEvent.target).focus();
      });
    }

    /**
     * BottomSheet class to apply bottom-sheet behavior to an element
     */
    function BottomSheet(element, parent) {
      var deregister = $mdGesture.register(parent, 'drag', { horizontal: false });
      parent.on('$md.dragstart', onDragStart)
        .on('$md.drag', onDrag)
        .on('$md.dragend', onDragEnd);

      return {
        element: element,
        cleanup: function cleanup() {
          deregister();
          parent.off('$md.dragstart', onDragStart)
            .off('$md.drag', onDrag)
            .off('$md.dragend', onDragEnd);
        }
      };

      function onDragStart(ev) {
        // Disable transitions on transform so that it feels fast
        element.css($mdConstant.CSS.TRANSITION_DURATION, '0ms');
      }

      function onDrag(ev) {
        var transform = ev.pointer.distanceY;
        if (transform < 5) {
          // Slow down drag when trying to drag up, and stop after PADDING
          transform = Math.max(-PADDING, transform / 2);
        }
        element.css($mdConstant.CSS.TRANSFORM, 'translate3d(0,' + (PADDING + transform) + 'px,0)');
      }

      function onDragEnd(ev) {
        if (ev.pointer.distanceY > 0 &&
            (ev.pointer.distanceY > 20 || Math.abs(ev.pointer.velocityY) > CLOSING_VELOCITY)) {
          var distanceRemaining = element.prop('offsetHeight') - ev.pointer.distanceY;
          var transitionDuration = Math.min(distanceRemaining / ev.pointer.velocityY * 0.75, 500);
          element.css($mdConstant.CSS.TRANSITION_DURATION, transitionDuration + 'ms');
          $timeout($mdBottomSheet.cancel);
        } else {
          element.css($mdConstant.CSS.TRANSITION_DURATION, '');
          element.css($mdConstant.CSS.TRANSFORM, '');
        }
      }
    }

  }

}
MdBottomSheetProvider.$inject = ["$$interimElementProvider"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.button
 * @description
 *
 * Button
 */
angular
    .module('material.components.button', [ 'material.core' ])
    .directive('mdButton', MdButtonDirective);

/**
 * @ngdoc directive
 * @name mdButton
 * @module material.components.button
 *
 * @restrict E
 *
 * @description
 * `<md-button>` is a button directive with optional ink ripples (default enabled).
 *
 * If you supply a `href` or `ng-href` attribute, it will become an `<a>` element. Otherwise, it will
 * become a `<button>` element. As per the [Material Design specifications](http://www.google.com/design/spec/style/color.html#color-ui-color-application)
 * the FAB button background is filled with the accent color [by default]. The primary color palette may be used with
 * the `md-primary` class.
 *
 * @param {boolean=} md-no-ink If present, disable ripple ink effects.
 * @param {expression=} ng-disabled En/Disable based on the expression
 * @param {string=} md-ripple-size Overrides the default ripple size logic. Options: `full`, `partial`, `auto`
 * @param {string=} aria-label Adds alternative text to button for accessibility, useful for icon buttons.
 * If no default text is found, a warning will be logged.
 *
 * @usage
 *
 * Regular buttons:
 *
 * <hljs lang="html">
 *  <md-button> Flat Button </md-button>
 *  <md-button href="http://google.com"> Flat link </md-button>
 *  <md-button class="md-raised"> Raised Button </md-button>
 *  <md-button ng-disabled="true"> Disabled Button </md-button>
 *  <md-button>
 *    <md-icon md-svg-src="your/icon.svg"></md-icon>
 *    Register Now
 *  </md-button>
 * </hljs>
 *
 * FAB buttons:
 *
 * <hljs lang="html">
 *  <md-button class="md-fab" aria-label="FAB">
 *    <md-icon md-svg-src="your/icon.svg"></md-icon>
 *  </md-button>
 *  <!-- mini-FAB -->
 *  <md-button class="md-fab md-mini" aria-label="Mini FAB">
 *    <md-icon md-svg-src="your/icon.svg"></md-icon>
 *  </md-button>
 *  <!-- Button with SVG Icon -->
 *  <md-button class="md-icon-button" aria-label="Custom Icon Button">
 *    <md-icon md-svg-icon="path/to/your.svg"></md-icon>
 *  </md-button>
 * </hljs>
 */
function MdButtonDirective($mdButtonInkRipple, $mdTheming, $mdAria, $timeout) {

  return {
    restrict: 'EA',
    replace: true,
    transclude: true,
    template: getTemplate,
    link: postLink
  };

  function isAnchor(attr) {
    return angular.isDefined(attr.href) || angular.isDefined(attr.ngHref) || angular.isDefined(attr.ngLink) || angular.isDefined(attr.uiSref);
  }

  function getTemplate(element, attr) {
    return isAnchor(attr) ?
           '<a class="md-button" ng-transclude></a>' :
           '<button class="md-button" ng-transclude></button>';
  }

  function postLink(scope, element, attr) {
    var node = element[0];
    $mdTheming(element);
    $mdButtonInkRipple.attach(scope, element);

    var elementHasText = node.textContent.trim();
    if (!elementHasText) {
      $mdAria.expect(element, 'aria-label');
    }

    // For anchor elements, we have to set tabindex manually when the
    // element is disabled
    if (isAnchor(attr) && angular.isDefined(attr.ngDisabled) ) {
      scope.$watch(attr.ngDisabled, function(isDisabled) {
        element.attr('tabindex', isDisabled ? -1 : 0);
      });
    }

    // disabling click event when disabled is true
    element.on('click', function(e){
      if (attr.disabled === true) {
        e.preventDefault();
        e.stopImmediatePropagation();
      }
    });

    // restrict focus styles to the keyboard
    scope.mouseActive = false;
    element.on('mousedown', function() {
        scope.mouseActive = true;
        $timeout(function(){
          scope.mouseActive = false;
        }, 100);
      })
      .on('focus', function() {
        if(scope.mouseActive === false) { element.addClass('md-focused'); }
      })
      .on('blur', function() { element.removeClass('md-focused'); });
  }

}
MdButtonDirective.$inject = ["$mdButtonInkRipple", "$mdTheming", "$mdAria", "$timeout"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.card
 *
 * @description
 * Card components.
 */
angular.module('material.components.card', [
  'material.core'
])
  .directive('mdCard', mdCardDirective);



/**
 * @ngdoc directive
 * @name mdCard
 * @module material.components.card
 *
 * @restrict E
 *
 * @description
 * The `<md-card>` directive is a container element used within `<md-content>` containers.
 *
 * An image included as a direct descendant will fill the card's width, while the `<md-card-content>`
 * container will wrap text content and provide padding. An `<md-card-footer>` element can be
 * optionally included to put content flush against the bottom edge of the card.
 *
 * Action buttons can be included in an element with the `.md-actions` class, also used in `md-dialog`.
 * You can then position buttons using layout attributes.
 *
 * Cards have constant width and variable heights; where the maximum height is limited to what can
 * fit within a single view on a platform, but it can temporarily expand as needed.
 *
 * @usage
 * ###Card with optional footer
 * <hljs lang="html">
 * <md-card>
 *  <img src="card-image.png" class="md-card-image" alt="image caption">
 *  <md-card-content>
 *    <h2>Card headline</h2>
 *    <p>Card content</p>
 *  </md-card-content>
 *  <md-card-footer>
 *    Card footer
 *  </md-card-footer>
 * </md-card>
 * </hljs>
 *
 * ###Card with actions
 * <hljs lang="html">
 * <md-card>
 *  <img src="card-image.png" class="md-card-image" alt="image caption">
 *  <md-card-content>
 *    <h2>Card headline</h2>
 *    <p>Card content</p>
 *  </md-card-content>
 *  <div class="md-actions" layout="row" layout-align="end center">
 *    <md-button>Action 1</md-button>
 *    <md-button>Action 2</md-button>
 *  </div>
 * </md-card>
 * </hljs>
 *
 */
function mdCardDirective($mdTheming) {
  return {
    restrict: 'E',
    link: function($scope, $element, $attr) {
      $mdTheming($element);
    }
  };
}
mdCardDirective.$inject = ["$mdTheming"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.checkbox
 * @description Checkbox module!
 */
angular
  .module('material.components.checkbox', ['material.core'])
  .directive('mdCheckbox', MdCheckboxDirective);

/**
 * @ngdoc directive
 * @name mdCheckbox
 * @module material.components.checkbox
 * @restrict E
 *
 * @description
 * The checkbox directive is used like the normal [angular checkbox](https://docs.angularjs.org/api/ng/input/input%5Bcheckbox%5D).
 *
 * As per the [material design spec](http://www.google.com/design/spec/style/color.html#color-ui-color-application)
 * the checkbox is in the accent color by default. The primary color palette may be used with
 * the `md-primary` class.
 *
 * @param {string} ng-model Assignable angular expression to data-bind to.
 * @param {string=} name Property name of the form under which the control is published.
 * @param {expression=} ng-true-value The value to which the expression should be set when selected.
 * @param {expression=} ng-false-value The value to which the expression should be set when not selected.
 * @param {string=} ng-change Angular expression to be executed when input changes due to user interaction with the input element.
 * @param {boolean=} md-no-ink Use of attribute indicates use of ripple ink effects
 * @param {string=} aria-label Adds label to checkbox for accessibility.
 * Defaults to checkbox's text. If no default text is found, a warning will be logged.
 *
 * @usage
 * <hljs lang="html">
 * <md-checkbox ng-model="isChecked" aria-label="Finished?">
 *   Finished ?
 * </md-checkbox>
 *
 * <md-checkbox md-no-ink ng-model="hasInk" aria-label="No Ink Effects">
 *   No Ink Effects
 * </md-checkbox>
 *
 * <md-checkbox ng-disabled="true" ng-model="isDisabled" aria-label="Disabled">
 *   Disabled
 * </md-checkbox>
 *
 * </hljs>
 *
 */
function MdCheckboxDirective(inputDirective, $mdInkRipple, $mdAria, $mdConstant, $mdTheming, $mdUtil, $timeout) {
  inputDirective = inputDirective[0];
  var CHECKED_CSS = 'md-checked';

  return {
    restrict: 'E',
    transclude: true,
    require: '?ngModel',
    priority:210, // Run before ngAria
    template: 
      '<div class="md-container" md-ink-ripple md-ink-ripple-checkbox>' +
        '<div class="md-icon"></div>' +
      '</div>' +
      '<div ng-transclude class="md-label"></div>',
    compile: compile
  };

  // **********************************************************
  // Private Methods
  // **********************************************************

  function compile (tElement, tAttrs) {

    tAttrs.type = 'checkbox';
    tAttrs.tabindex = tAttrs.tabindex || '0';
    tElement.attr('role', tAttrs.type);

    return function postLink(scope, element, attr, ngModelCtrl) {
      ngModelCtrl = ngModelCtrl || $mdUtil.fakeNgModel();
      $mdTheming(element);

      if (attr.ngChecked) {
        scope.$watch(
            scope.$eval.bind(scope, attr.ngChecked),
            ngModelCtrl.$setViewValue.bind(ngModelCtrl)
        );
      }
      $$watchExpr('ngDisabled', 'tabindex', {
        true: '-1',
        false: attr.tabindex
      });
      $mdAria.expectWithText(element, 'aria-label');

      // Reuse the original input[type=checkbox] directive from Angular core.
      // This is a bit hacky as we need our own event listener and own render
      // function.
      inputDirective.link.pre(scope, {
        on: angular.noop,
        0: {}
      }, attr, [ngModelCtrl]);

      scope.mouseActive = false;
      element.on('click', listener)
        .on('keypress', keypressHandler)
        .on('mousedown', function() {
          scope.mouseActive = true;
          $timeout(function(){
            scope.mouseActive = false;
          }, 100);
        })
        .on('focus', function() {
          if(scope.mouseActive === false) { element.addClass('md-focused'); }
        })
        .on('blur', function() { element.removeClass('md-focused'); });

      ngModelCtrl.$render = render;

      function $$watchExpr(expr, htmlAttr, valueOpts) {
        if (attr[expr]) {
          scope.$watch(attr[expr], function(val) {
            if (valueOpts[val]) {
              element.attr(htmlAttr, valueOpts[val]);
            }
          });
        }
      }

      function keypressHandler(ev) {
        var keyCode = ev.which || ev.keyCode;
        if (keyCode === $mdConstant.KEY_CODE.SPACE || keyCode === $mdConstant.KEY_CODE.ENTER) {
          ev.preventDefault();
          if (!element.hasClass('md-focused')) { element.addClass('md-focused'); }
          listener(ev);
        }
      }
      function listener(ev) {
        if (element[0].hasAttribute('disabled')) return;

        scope.$apply(function() {
          // Toggle the checkbox value...
          var viewValue = attr.ngChecked ? attr.checked : !ngModelCtrl.$viewValue;

          ngModelCtrl.$setViewValue( viewValue, ev && ev.type);
          ngModelCtrl.$render();
        });
      }

      function render() {
        if(ngModelCtrl.$viewValue) {
          element.addClass(CHECKED_CSS);
        } else {
          element.removeClass(CHECKED_CSS);
        }
      }
    };
  }
}
MdCheckboxDirective.$inject = ["inputDirective", "$mdInkRipple", "$mdAria", "$mdConstant", "$mdTheming", "$mdUtil", "$timeout"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.chips
 */
/*
 * @see js folder for chips implementation
 */
angular.module('material.components.chips', [
  'material.core',
  'material.components.autocomplete'
]);

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.content
 *
 * @description
 * Scrollable content
 */
angular.module('material.components.content', [
  'material.core'
])
  .directive('mdContent', mdContentDirective);

/**
 * @ngdoc directive
 * @name mdContent
 * @module material.components.content
 *
 * @restrict E
 *
 * @description
 * The `<md-content>` directive is a container element useful for scrollable content
 *
 * @usage
 *
 * - Add the `[layout-padding]` attribute to make the content padded.
 *
 * <hljs lang="html">
 *  <md-content layout-padding>
 *      Lorem ipsum dolor sit amet, ne quod novum mei.
 *  </md-content>
 * </hljs>
 *
 */

function mdContentDirective($mdTheming) {
  return {
    restrict: 'E',
    controller: ['$scope', '$element', ContentController],
    link: function(scope, element, attr) {
      var node = element[0];

      $mdTheming(element);
      scope.$broadcast('$mdContentLoaded', element);

      iosScrollFix(element[0]);
    }
  };

  function ContentController($scope, $element) {
    this.$scope = $scope;
    this.$element = $element;
  }
}
mdContentDirective.$inject = ["$mdTheming"];

function iosScrollFix(node) {
  // IOS FIX:
  // If we scroll where there is no more room for the webview to scroll,
  // by default the webview itself will scroll up and down, this looks really
  // bad.  So if we are scrolling to the very top or bottom, add/subtract one
  angular.element(node).on('$md.pressdown', function(ev) {
    // Only touch events
    if (ev.pointer.type !== 't') return;
    // Don't let a child content's touchstart ruin it for us.
    if (ev.$materialScrollFixed) return;
    ev.$materialScrollFixed = true;

    if (node.scrollTop === 0) {
      node.scrollTop = 1;
    } else if (node.scrollHeight === node.scrollTop + node.offsetHeight) {
      node.scrollTop -= 1;
    }
  });
}

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.dialog
 */
angular.module('material.components.dialog', [
  'material.core',
  'material.components.backdrop'
])
  .directive('mdDialog', MdDialogDirective)
  .provider('$mdDialog', MdDialogProvider);

function MdDialogDirective($$rAF, $mdTheming) {
  return {
    restrict: 'E',
    link: function(scope, element, attr) {
      $mdTheming(element);
      $$rAF(function() {
        var content = element[0].querySelector('md-dialog-content');
        if (content && content.scrollHeight > content.clientHeight) {
          element.addClass('md-content-overflow');
        }
      });
    }
  };
}
MdDialogDirective.$inject = ["$$rAF", "$mdTheming"];

/**
 * @ngdoc service
 * @name $mdDialog
 * @module material.components.dialog
 *
 * @description
 * `$mdDialog` opens a dialog over the app to inform users about critical information or require
 *  them to make decisions. There are two approaches for setup: a simple promise API
 *  and regular object syntax.
 *
 * ## Restrictions
 *
 * - The dialog is always given an isolate scope.
 * - The dialog's template must have an outer `<md-dialog>` element.
 *   Inside, use an `<md-dialog-content>` element for the dialog's content, and use
 *   an element with class `md-actions` for the dialog's actions.
 * - Dialogs must cover the entire application to keep interactions inside of them.
 * Use the `parent` option to change where dialogs are appended.
 *
 * ## Sizing
 * - Complex dialogs can be sized with `flex="percentage"`, i.e. `flex="66"`.
 * - Default max-width is 80% of the `rootElement` or `parent`.
 *
 * @usage
 * <hljs lang="html">
 * <div  ng-app="demoApp" ng-controller="EmployeeController">
 *   <div>
 *     <md-button ng-click="showAlert()" class="md-raised md-warn">
 *       Employee Alert!
 *       </md-button>
 *   </div>
 *   <div>
 *     <md-button ng-click="showDialog($event)" class="md-raised">
 *       Custom Dialog
 *       </md-button>
 *   </div>
 *   <div>
 *     <md-button ng-click="closeAlert()" ng-disabled="!hasAlert()" class="md-raised">
 *       Close Alert
 *     </md-button>
 *   </div>
 *   <div>
 *     <md-button ng-click="showGreeting($event)" class="md-raised md-primary" >
 *       Greet Employee
 *       </md-button>
 *   </div>
 * </div>
 * </hljs>
 *
 * ### JavaScript: object syntax
 * <hljs lang="js">
 * (function(angular, undefined){
 *   "use strict";
 *
 *   angular
 *    .module('demoApp', ['ngMaterial'])
 *    .controller('AppCtrl', AppController);
 *
 *   function AppController($scope, $mdDialog) {
 *     var alert;
 *     $scope.showAlert = showAlert;
 *     $scope.showDialog = showDialog;
 *     $scope.items = [1, 2, 3];
 *
 *     // Internal method
 *     function showAlert() {
 *       alert = $mdDialog.alert({
 *         title: 'Attention',
 *         content: 'This is an example of how easy dialogs can be!',
 *         ok: 'Close'
 *       });
 *
 *       $mdDialog
 *         .show( alert )
 *         .finally(function() {
 *           alert = undefined;
 *         });
 *     }
 *
 *     function showDialog($event) {
 *        var parentEl = angular.element(document.body);
 *        $mdDialog.show({
 *          parent: parentEl,
 *          targetEvent: $event,
 *          template:
 *            '<md-dialog aria-label="List dialog">' +
 *            '  <md-dialog-content>'+
 *            '    <md-list>'+
 *            '      <md-list-item ng-repeat="item in items">'+
 *            '       <p>Number {{item}}</p>' +
 *            '      </md-item>'+
 *            '    </md-list>'+
 *            '  </md-dialog-content>' +
 *            '  <div class="md-actions">' +
 *            '    <md-button ng-click="closeDialog()" class="md-primary">' +
 *            '      Close Dialog' +
 *            '    </md-button>' +
 *            '  </div>' +
 *            '</md-dialog>',
 *          locals: {
 *            items: $scope.items
 *          },
 *          controller: DialogController
 *       });
 *       function DialogController($scope, $mdDialog, items) {
 *         $scope.items = items;
 *         $scope.closeDialog = function() {
 *           $mdDialog.hide();
 *         }
 *       }
 *     }
 *   }
 * })(angular);
 * </hljs>
 *
 * ### JavaScript: promise API syntax, custom dialog template
 * <hljs lang="js">
 * (function(angular, undefined){
 *   "use strict";
 *
 *   angular
 *     .module('demoApp', ['ngMaterial'])
 *     .controller('EmployeeController', EmployeeEditor)
 *     .controller('GreetingController', GreetingController);
 *
 *   // Fictitious Employee Editor to show how to use simple and complex dialogs.
 *
 *   function EmployeeEditor($scope, $mdDialog) {
 *     var alert;
 *
 *     $scope.showAlert = showAlert;
 *     $scope.closeAlert = closeAlert;
 *     $scope.showGreeting = showCustomGreeting;
 *
 *     $scope.hasAlert = function() { return !!alert };
 *     $scope.userName = $scope.userName || 'Bobby';
 *
 *     // Dialog #1 - Show simple alert dialog and cache
 *     // reference to dialog instance
 *
 *     function showAlert() {
 *       alert = $mdDialog.alert()
 *         .title('Attention, ' + $scope.userName)
 *         .content('This is an example of how easy dialogs can be!')
 *         .ok('Close');
 *
 *       $mdDialog
 *           .show( alert )
 *           .finally(function() {
 *             alert = undefined;
 *           });
 *     }
 *
 *     // Close the specified dialog instance and resolve with 'finished' flag
 *     // Normally this is not needed, just use '$mdDialog.hide()' to close
 *     // the most recent dialog popup.
 *
 *     function closeAlert() {
 *       $mdDialog.hide( alert, "finished" );
 *       alert = undefined;
 *     }
 *
 *     // Dialog #2 - Demonstrate more complex dialogs construction and popup.
 *
 *     function showCustomGreeting($event) {
 *         $mdDialog.show({
 *           targetEvent: $event,
 *           template:
 *             '<md-dialog>' +
 *
 *             '  <md-dialog-content>Hello {{ employee }}!</md-dialog-content>' +
 *
 *             '  <div class="md-actions">' +
 *             '    <md-button ng-click="closeDialog()" class="md-primary">' +
 *             '      Close Greeting' +
 *             '    </md-button>' +
 *             '  </div>' +
 *             '</md-dialog>',
 *           controller: 'GreetingController',
 *           onComplete: afterShowAnimation,
 *           locals: { employee: $scope.userName }
 *         });
 *
 *         // When the 'enter' animation finishes...
 *
 *         function afterShowAnimation(scope, element, options) {
 *            // post-show code here: DOM element focus, etc.
 *         }
 *     }
 *
 *     // Dialog #3 - Demonstrate use of ControllerAs and passing $scope to dialog
 *     //             Here we used ng-controller="GreetingController as vm" and
 *     //             $scope.vm === <controller instance>
 *
 *     function showCustomGreeting() {
 *
 *        $mdDialog.show({
 *           clickOutsideToClose: true,
 *
 *           scope: $scope,        // use parent scope in template
 *           preserveScope: true,  // do not forget this if use parent scope

 *           // Since GreetingController is instantiated with ControllerAs syntax
 *           // AND we are passing the parent '$scope' to the dialog, we MUST
 *           // use 'vm.<xxx>' in the template markup
 *
 *           template: '<md-dialog>' +
 *                     '  <md-dialog-content>' +
 *                     '     Hi There {{vm.employee}}' +
 *                     '  </md-dialog-content>' +
 *                     '</md-dialog>',
 *
 *           controller: function DialogController($scope, $mdDialog) {
 *             $scope.closeDialog = function() {
 *               $mdDialog.hide();
 *             }
 *           }
 *        });
 *     }
 *
 *   }
 *
 *   // Greeting controller used with the more complex 'showCustomGreeting()' custom dialog
 *
 *   function GreetingController($scope, $mdDialog, employee) {
 *     // Assigned from construction <code>locals</code> options...
 *     $scope.employee = employee;
 *
 *     $scope.closeDialog = function() {
 *       // Easily hides most recent dialog shown...
 *       // no specific instance reference is needed.
 *       $mdDialog.hide();
 *     };
 *   }
 *
 * })(angular);
 * </hljs>
 */

 /**
 * @ngdoc method
 * @name $mdDialog#alert
 *
 * @description
 * Builds a preconfigured dialog with the specified message.
 *
 * @returns {obj} an `$mdDialogPreset` with the chainable configuration methods:
 *
 * - $mdDialogPreset#title(string) - sets title to string
 * - $mdDialogPreset#content(string) - sets content / message to string
 * - $mdDialogPreset#ok(string) - sets okay button text to string
 * - $mdDialogPreset#theme(string) - sets the theme of the dialog
 *
 */

 /**
 * @ngdoc method
 * @name $mdDialog#confirm
 *
 * @description
 * Builds a preconfigured dialog with the specified message. You can call show and the promise returned
 * will be resolved only if the user clicks the confirm action on the dialog.
 *
 * @returns {obj} an `$mdDialogPreset` with the chainable configuration methods:
 *
 * Additionally, it supports the following methods:
 *
 * - $mdDialogPreset#title(string) - sets title to string
 * - $mdDialogPreset#content(string) - sets content / message to string
 * - $mdDialogPreset#ok(string) - sets okay button text to string
 * - $mdDialogPreset#cancel(string) - sets cancel button text to string
 * - $mdDialogPreset#theme(string) - sets the theme of the dialog
 *
 */

/**
 * @ngdoc method
 * @name $mdDialog#show
 *
 * @description
 * Show a dialog with the specified options.
 *
 * @param {object} optionsOrPreset Either provide an `$mdDialogPreset` returned from `alert()`, and
 * `confirm()`, or an options object with the following properties:
 *   - `templateUrl` - `{string=}`: The url of a template that will be used as the content
 *   of the dialog.
 *   - `template` - `{string=}`: Same as templateUrl, except this is an actual template string.
 *   - `targetEvent` - `{DOMClickEvent=}`: A click's event object. When passed in as an option,
 *     the location of the click will be used as the starting point for the opening animation
 *     of the the dialog.
 *   - `scope` - `{object=}`: the scope to link the template / controller to. If none is specified,
 *     it will create a new isolate scope.
 *     This scope will be destroyed when the dialog is removed unless `preserveScope` is set to true.
 *   - `preserveScope` - `{boolean=}`: whether to preserve the scope when the element is removed. Default is false
 *   - `disableParentScroll` - `{boolean=}`: Whether to disable scrolling while the dialog is open.
 *     Default true.
 *   - `hasBackdrop` - `{boolean=}`: Whether there should be an opaque backdrop behind the dialog.
 *     Default true.
 *   - `clickOutsideToClose` - `{boolean=}`: Whether the user can click outside the dialog to
 *     close it. Default false.
 *   - `escapeToClose` - `{boolean=}`: Whether the user can press escape to close the dialog.
 *     Default true.
 *   - `focusOnOpen` - `{boolean=}`: An option to override focus behavior on open. Only disable if
 *     focusing some other way, as focus management is required for dialogs to be accessible.
 *     Defaults to true.
 *   - `controller` - `{string=}`: The controller to associate with the dialog. The controller
 *     will be injected with the local `$mdDialog`, which passes along a scope for the dialog.
 *   - `locals` - `{object=}`: An object containing key/value pairs. The keys will be used as names
 *     of values to inject into the controller. For example, `locals: {three: 3}` would inject
 *     `three` into the controller, with the value 3. If `bindToController` is true, they will be
 *     copied to the controller instead.
 *   - `bindToController` - `bool`: bind the locals to the controller, instead of passing them in.
 *     These values will not be available until after initialization.
 *   - `resolve` - `{object=}`: Similar to locals, except it takes promises as values, and the
 *     dialog will not open until all of the promises resolve.
 *   - `controllerAs` - `{string=}`: An alias to assign the controller to on the scope.
 *   - `parent` - `{element=}`: The element to append the dialog to. Defaults to appending
 *     to the root element of the application.
 *   - `onComplete` `{function=}`: Callback function used to announce when the show() action is
 *     finished.
 *
 * @returns {promise} A promise that can be resolved with `$mdDialog.hide()` or
 * rejected with `$mdDialog.cancel()`.
 */

/**
 * @ngdoc method
 * @name $mdDialog#hide
 *
 * @description
 * Hide an existing dialog and resolve the promise returned from `$mdDialog.show()`.
 *
 * @param {*=} response An argument for the resolved promise.
 *
 * @returns {promise} A promise that is resolved when the dialog has been closed.
 */

/**
 * @ngdoc method
 * @name $mdDialog#cancel
 *
 * @description
 * Hide an existing dialog and reject the promise returned from `$mdDialog.show()`.
 *
 * @param {*=} response An argument for the rejected promise.
 *
 * @returns {promise} A promise that is resolved when the dialog has been closed.
 */

function MdDialogProvider($$interimElementProvider) {

  var alertDialogMethods = ['title', 'content', 'ariaLabel', 'ok'];

  advancedDialogOptions.$inject = ["$mdDialog", "$mdTheming"];
  dialogDefaultOptions.$inject = ["$mdAria", "$document", "$mdUtil", "$mdConstant", "$mdTheming", "$mdDialog", "$timeout", "$rootElement", "$animate", "$$rAF", "$q"];
  return $$interimElementProvider('$mdDialog')
    .setDefaults({
      methods: ['disableParentScroll', 'hasBackdrop', 'clickOutsideToClose', 'escapeToClose', 'targetEvent', 'parent'],
      options: dialogDefaultOptions
    })
    .addPreset('alert', {
      methods: ['title', 'content', 'ariaLabel', 'ok', 'theme'],
      options: advancedDialogOptions
    })
    .addPreset('confirm', {
      methods: ['title', 'content', 'ariaLabel', 'ok', 'cancel', 'theme'],
      options: advancedDialogOptions
    });

  /* @ngInject */
  function advancedDialogOptions($mdDialog, $mdTheming) {
    return {
      template: [
        '<md-dialog md-theme="{{ dialog.theme }}" aria-label="{{ dialog.ariaLabel }}">',
          '<md-dialog-content role="document" tabIndex="-1">',
            '<h2 class="md-title">{{ dialog.title }}</h2>',
            '<p>{{ dialog.content }}</p>',
          '</md-dialog-content>',
          '<div class="md-actions">',
            '<md-button ng-if="dialog.$type == \'confirm\'"' +
                      ' ng-click="dialog.abort()" class="md-primary">',
              '{{ dialog.cancel }}',
            '</md-button>',
            '<md-button ng-click="dialog.hide()" class="md-primary">',
              '{{ dialog.ok }}',
            '</md-button>',
          '</div>',
        '</md-dialog>'
      ].join(''),
      controller: function mdDialogCtrl() {
        this.hide = function() {
          $mdDialog.hide(true);
        };
        this.abort = function() {
          $mdDialog.cancel();
        };
      },
      controllerAs: 'dialog',
      bindToController: true,
      theme: $mdTheming.defaultTheme()
    };
  }

  /* @ngInject */
  function dialogDefaultOptions($mdAria, $document, $mdUtil, $mdConstant, $mdTheming, $mdDialog, $timeout, $rootElement, $animate, $$rAF, $q) {
    return {
      hasBackdrop: true,
      isolateScope: true,
      onShow: onShow,
      onRemove: onRemove,
      clickOutsideToClose: false,
      escapeToClose: true,
      targetEvent: null,
      focusOnOpen: true,
      disableParentScroll: true,
      transformTemplate: function(template) {
        return '<div class="md-dialog-container">' + template + '</div>';
      }
    };

    function trapFocus(ev) {
      var dialog = document.querySelector('md-dialog');

      if (dialog && !dialog.contains(ev.target)) {
        ev.stopImmediatePropagation();
        dialog.focus();
      }
    }

    // On show method for dialogs
    function onShow(scope, element, options) {
      angular.element($document[0].body).addClass('md-dialog-is-showing');
      element = $mdUtil.extractElementByName(element, 'md-dialog');

      // Incase the user provides a raw dom element, always wrap it in jqLite
      options.parent = angular.element(options.parent);

      options.popInTarget = angular.element((options.targetEvent || {}).target);
      var closeButton = findCloseButton();

      if (options.hasBackdrop) {
        // Fix for IE 10
        var computeFrom = (options.parent[0] == $document[0].body && $document[0].documentElement
                           && $document[0].documentElement.scrollTop) ? angular.element($document[0].documentElement) : options.parent;
        var parentOffset = computeFrom.prop('scrollTop');
        options.backdrop = angular.element('<md-backdrop class="md-dialog-backdrop md-opaque">');
        options.backdrop.css('top', parentOffset +'px');
        $mdTheming.inherit(options.backdrop, options.parent);
        $animate.enter(options.backdrop, options.parent);
        element.css('top', parentOffset +'px');
      }

      var role = 'dialog',
          elementToFocus = closeButton;

      if (options.$type === 'alert') {
        role = 'alertdialog';
        elementToFocus = element.find('md-dialog-content');
      }

      configureAria(element.find('md-dialog'), role, options);

      document.addEventListener('focus', trapFocus, true);

      if (options.disableParentScroll) {
        options.lastOverflow = options.parent.css('overflow');
        options.parent.css('overflow', 'hidden');
      }

      return dialogPopIn(
        element,
        options.parent,
        options.popInTarget && options.popInTarget.length && options.popInTarget
      )
      .then(function() {

        applyAriaToSiblings(element, true);

        if (options.escapeToClose) {
          options.rootElementKeyupCallback = function(e) {
            if (e.keyCode === $mdConstant.KEY_CODE.ESCAPE) {
              $timeout($mdDialog.cancel);
            }
          };
          $rootElement.on('keyup', options.rootElementKeyupCallback);
        }

        if (options.clickOutsideToClose) {
          options.dialogClickOutsideCallback = function(ev) {
            // Only close if we click the flex container outside the backdrop
            if (ev.target === element[0]) {
              $timeout($mdDialog.cancel);
            }
          };
          element.on('click', options.dialogClickOutsideCallback);
        }

        if (options.focusOnOpen) {
          elementToFocus.focus();
        }
      });


      function findCloseButton() {
        //If no element with class dialog-close, try to find the last
        //button child in md-actions and assume it is a close button
        var closeButton = element[0].querySelector('.dialog-close');
        if (!closeButton) {
          var actionButtons = element[0].querySelectorAll('.md-actions button');
          closeButton = actionButtons[ actionButtons.length - 1 ];
        }
        return angular.element(closeButton);
      }

    }

    // On remove function for all dialogs
    function onRemove(scope, element, options) {
      angular.element($document[0].body).removeClass('md-dialog-is-showing');

      if (options.backdrop) {
        $animate.leave(options.backdrop);
      }
      if (options.disableParentScroll) {
        options.parent.css('overflow', options.lastOverflow);
        delete options.lastOverflow;
      }
      if (options.escapeToClose) {
        $rootElement.off('keyup', options.rootElementKeyupCallback);
      }
      if (options.clickOutsideToClose) {
        element.off('click', options.dialogClickOutsideCallback);
      }

      applyAriaToSiblings(element, false);

      document.removeEventListener('focus', trapFocus, true);

      return dialogPopOut(
        element,
        options.parent,
        options.popInTarget && options.popInTarget.length && options.popInTarget
      ).then(function() {
        element.remove();
        options.popInTarget && options.popInTarget.focus();
      });

    }

    /**
     * Inject ARIA-specific attributes appropriate for Dialogs
     */
    function configureAria(element, role, options) {

      element.attr({
        'role': role,
        'tabIndex': '-1'
      });

      var dialogContent = element.find('md-dialog-content');
      if (dialogContent.length === 0){
        dialogContent = element;
      }

      var dialogId = element.attr('id') || ('dialog_' + $mdUtil.nextUid());
      dialogContent.attr('id', dialogId);
      element.attr('aria-describedby', dialogId);

      if (options.ariaLabel) {
        $mdAria.expect(element, 'aria-label', options.ariaLabel);
      }
      else {
        $mdAria.expectAsync(element, 'aria-label', function() {
          var words = dialogContent.text().split(/\s+/);
          if (words.length > 3) words = words.slice(0,3).concat('...');
          return words.join(' ');
        });
      }
    }
    /**
     * Utility function to filter out raw DOM nodes
     */
    function isNodeOneOf(elem, nodeTypeArray) {
      if (nodeTypeArray.indexOf(elem.nodeName) !== -1) {
        return true;
      }
    }
    /**
     * Walk DOM to apply or remove aria-hidden on sibling nodes
     * and parent sibling nodes
     *
     * Prevents screen reader interaction behind modal window
     * on swipe interfaces
     */
    function applyAriaToSiblings(element, value) {
      var attribute = 'aria-hidden';

      // get raw DOM node
      element = element[0];

      function walkDOM(element) {
        while (element.parentNode) {
          if (element === document.body) {
            return;
          }
          var children = element.parentNode.children;
          for (var i = 0; i < children.length; i++) {
            // skip over child if it is an ascendant of the dialog
            // or a script or style tag
            if (element !== children[i] && !isNodeOneOf(children[i], ['SCRIPT', 'STYLE'])) {
              children[i].setAttribute(attribute, value);
            }
          }

          walkDOM(element = element.parentNode);
        }
      }
      walkDOM(element);
    }

    function dialogPopIn(container, parentElement, clickElement) {
      var dialogEl = container.find('md-dialog');

      parentElement.append(container);
      transformToClickElement(dialogEl, clickElement);

      $$rAF(function() {
        dialogEl.addClass('transition-in')
          .css($mdConstant.CSS.TRANSFORM, '');
      });

      return $mdUtil.transitionEndPromise(dialogEl);
    }

    function dialogPopOut(container, parentElement, clickElement) {
      var dialogEl = container.find('md-dialog');

      dialogEl.addClass('transition-out').removeClass('transition-in');
      transformToClickElement(dialogEl, clickElement);

      return $mdUtil.transitionEndPromise(dialogEl);
    }

    function transformToClickElement(dialogEl, clickElement) {
      if (clickElement) {
        var clickRect = clickElement[0].getBoundingClientRect();
        var dialogRect = dialogEl[0].getBoundingClientRect();

        var scaleX = Math.min(0.5, clickRect.width / dialogRect.width);
        var scaleY = Math.min(0.5, clickRect.height / dialogRect.height);

        dialogEl.css($mdConstant.CSS.TRANSFORM, 'translate3d(' +
          (-dialogRect.left + clickRect.left + clickRect.width/2 - dialogRect.width/2) + 'px,' +
          (-dialogRect.top + clickRect.top + clickRect.height/2 - dialogRect.height/2) + 'px,' +
          '0) scale(' + scaleX + ',' + scaleY + ')'
        );
      }
    }

    function dialogTransitionEnd(dialogEl) {
      var deferred = $q.defer();
      dialogEl.on($mdConstant.CSS.TRANSITIONEND, finished);
      function finished(ev) {
        //Make sure this transitionend didn't bubble up from a child
        if (ev.target === dialogEl[0]) {
          dialogEl.off($mdConstant.CSS.TRANSITIONEND, finished);
          deferred.resolve();
        }
      }
      return deferred.promise;
    }

  }
}
MdDialogProvider.$inject = ["$$interimElementProvider"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.divider
 * @description Divider module!
 */
angular.module('material.components.divider', [
  'material.core'
])
  .directive('mdDivider', MdDividerDirective);

/**
 * @ngdoc directive
 * @name mdDivider
 * @module material.components.divider
 * @restrict E
 *
 * @description
 * Dividers group and separate content within lists and page layouts using strong visual and spatial distinctions. This divider is a thin rule, lightweight enough to not distract the user from content.
 *
 * @param {boolean=} md-inset Add this attribute to activate the inset divider style.
 * @usage
 * <hljs lang="html">
 * <md-divider></md-divider>
 *
 * <md-divider md-inset></md-divider>
 * </hljs>
 *
 */
function MdDividerDirective($mdTheming) {
  return {
    restrict: 'E',
    link: $mdTheming
  };
}
MdDividerDirective.$inject = ["$mdTheming"];

})();
(function(){
"use strict";

(function() {
  'use strict';

  angular
    .module('material.components.fabActions', ['material.core'])
    .directive('mdFabActions', MdFabActionsDirective);

  /**
   * @ngdoc directive
   * @name mdFabActions
   * @module material.components.fabSpeedDial
   *
   * @restrict E
   *
   * @description
   * The `<md-fab-actions>` directive is used inside of a `<md-fab-speed-dial>` or
   * `<md-fab-toolbar>` directive to mark the an element (or elements) as the actions and setup the
   * proper event listeners.
   *
   * @usage
   * See the `<md-fab-speed-dial>` or `<md-fab-toolbar>` directives for example usage.
   */
  function MdFabActionsDirective() {
    return {
      restrict: 'E',

      require: ['^?mdFabSpeedDial', '^?mdFabToolbar'],

      link: function(scope, element, attributes, controllers) {
        // Grab whichever parent controller is used
        var controller = controllers[0] || controllers[1];

        // Make the children open/close their parent directive
        if (controller) {
          angular.forEach(element.children(), function(child) {
            angular.element(child).on('focus', controller.open);
            angular.element(child).on('blur', controller.close);
          });
        }

        // After setting up the listeners, wrap every child in a new div and add a class that we can
        // scale/fling independently
        element.children().wrap('<div class="md-fab-action-item">');
      }
    }
  }

})();
})();
(function(){
"use strict";

(function() {
  'use strict';

  angular
    .module('material.components.fabSpeedDial', [
      'material.core',
      'material.components.fabTrigger',
      'material.components.fabActions'
    ])
    .directive('mdFabSpeedDial', MdFabSpeedDialDirective)
    .animation('.md-fling', MdFabSpeedDialFlingAnimation)
    .animation('.md-scale', MdFabSpeedDialScaleAnimation);

  /**
   * @ngdoc directive
   * @name mdFabSpeedDial
   * @module material.components.fabSpeedDial
   *
   * @restrict E
   *
   * @description
   * The `<md-fab-speed-dial>` directive is used to present a series of popup elements (usually
   * `<md-button>`s) for quick access to common actions.
   *
   * There are currently two animations available by applying one of the following classes to
   * the component:
   *
   *  - `md-fling` - The speed dial items appear from underneath the trigger and move into their
   *    appropriate positions.
   *  - `md-scale` - The speed dial items appear in their proper places by scaling from 0% to 100%.
   *
   * @usage
   * <hljs lang="html">
   * <md-fab-speed-dial direction="up" class="md-fling">
   *   <md-fab-trigger>
   *     <md-button aria-label="Add..."><md-icon icon="/img/icons/plus.svg"></md-icon></md-button>
   *   </md-fab-trigger>
   *
   *   <md-fab-actions>
   *     <md-button aria-label="Add User">
   *       <md-icon icon="/img/icons/user.svg"></md-icon>
   *     </md-button>
   *
   *     <md-button aria-label="Add Group">
   *       <md-icon icon="/img/icons/group.svg"></md-icon>
   *     </md-button>
   *   </md-fab-actions>
   * </md-fab-speed-dial>
   * </hljs>
   *
   * @param {string=} md-direction From which direction you would like the speed dial to appear
   * relative to the trigger element.
   * @param {expression=} md-open Programmatically control whether or not the speed-dial is visible.
   */
  function MdFabSpeedDialDirective() {
    FabSpeedDialController.$inject = ["$scope", "$element", "$animate"];
    return {
      restrict: 'E',

      scope: {
        direction: '@?mdDirection',
        isOpen: '=?mdOpen'
      },

      bindToController: true,
      controller: FabSpeedDialController,
      controllerAs: 'vm',

      link: FabSpeedDialLink
    };

    function FabSpeedDialLink(scope, element) {
      // Prepend an element to hold our CSS variables so we can use them in the animations below
      element.prepend('<div class="md-css-variables"></div>');
    }

    function FabSpeedDialController($scope, $element, $animate) {
      var vm = this;

      // Define our open/close functions
      // Note: Used by fabTrigger and fabActions directives
      vm.open = function() {
        $scope.$apply('vm.isOpen = true');
      };

      vm.close = function() {
        $scope.$apply('vm.isOpen = false');
      };

      setupDefaults();
      setupListeners();
      setupWatchers();

      // Set our default variables
      function setupDefaults() {
        // Set the default direction to 'down' if none is specified
        vm.direction = vm.direction || 'down';

        // Set the default to be closed
        vm.isOpen = vm.isOpen || false;
      }

      // Setup our event listeners
      function setupListeners() {
        $element.on('mouseenter', vm.open);
        $element.on('mouseleave', vm.close);
      }

      // Setup our watchers
      function setupWatchers() {
        // Watch for changes to the direction and update classes/attributes
        $scope.$watch('vm.direction', function(newDir, oldDir) {
          // Add the appropriate classes so we can target the direction in the CSS
          $animate.removeClass($element, 'md-' + oldDir);
          $animate.addClass($element, 'md-' + newDir);
        });


        // Watch for changes to md-open
        $scope.$watch('vm.isOpen', function(isOpen) {
          var toAdd = isOpen ? 'md-is-open' : '';
          var toRemove = isOpen ? '' : 'md-is-open';

          $animate.setClass($element, toAdd, toRemove);
        });
      }
    }
  }

  function MdFabSpeedDialFlingAnimation() {
    function runAnimation(element) {
      var el = element[0];
      var ctrl = element.controller('mdFabSpeedDial');
      var items = el.querySelectorAll('.md-fab-action-item');

      // Grab our element which stores CSS variables
      var variablesElement = el.querySelector('.md-css-variables');

      // Setup JS variables based on our CSS variables
      var startZIndex = variablesElement.style.zIndex;

      // Always reset the items to their natural position/state
      angular.forEach(items, function(item, index) {
        var styles = item.style;

        styles.transform = '';
        styles.transitionDelay = '';
        styles.opacity = 1;

        // Make the items closest to the trigger have the highest z-index
        item.style.zIndex = (items.length - index) + startZIndex;
      });

      // If the control is closed, hide the items behind the trigger
      if (!ctrl.isOpen) {
        angular.forEach(items, function(item, index) {
          var newPosition, axis;

          switch (ctrl.direction) {
            case 'up':
              newPosition = item.scrollHeight * (index + 1);
              axis = 'Y';
              break;
            case 'down':
              newPosition = -item.scrollHeight * (index + 1);
              axis = 'Y';
              break;
            case 'left':
              newPosition = item.scrollWidth * (index + 1);
              axis = 'X';
              break;
            case 'right':
              newPosition = -item.scrollWidth * (index + 1);
              axis = 'X';
              break;
          }

          item.style.transform = 'translate' + axis + '(' + newPosition + 'px)';
        });
      }
    }

    return {
      addClass: function(element, className, done) {
        if (element.hasClass('md-fling')) {
          runAnimation(element);
        }
      },
      removeClass: function(element, className, done) {
        runAnimation(element);
      }
    }
  }

  function MdFabSpeedDialScaleAnimation() {
    var delay = 65;

    function runAnimation(element) {
      var el = element[0];
      var ctrl = element.controller('mdFabSpeedDial');
      var items = el.querySelectorAll('.md-fab-action-item');

      // Always reset the items to their natural position/state
      angular.forEach(items, function(item, index) {
        var styles = item.style,
          offsetDelay = index * delay;

        styles.opacity = ctrl.isOpen ? 1 : 0;
        styles.transform = ctrl.isOpen ? 'scale(1)' : 'scale(0)';
        styles.transitionDelay = (ctrl.isOpen ?  offsetDelay : (items.length - offsetDelay)) + 'ms';
      });
    }

    return {
      addClass: function(element, className, done) {
        runAnimation(element);
      },

      removeClass: function(element, className, done) {
        runAnimation(element);
      }
    }
  }
})();

})();
(function(){
"use strict";

(function() {
  'use strict';

  angular
    .module('material.components.fabToolbar', [
      'material.core',
      'material.components.fabTrigger',
      'material.components.fabActions'
    ])
    .directive('mdFabToolbar', MdFabToolbarDirective)
    .animation('.md-fab-toolbar', MdFabToolbarAnimation);

  /**
   * @ngdoc directive
   * @name mdFabToolbar
   * @module material.components.fabToolbar
   *
   * @restrict E
   *
   * @description
   *
   * The `<md-fab-toolbar>` directive is used present a toolbar of elements (usually `<md-button>`s)
   * for quick access to common actions when a floating action button is activated (via hover or
   * keyboard navigation).
   *
   * @usage
   *
   * <hljs lang="html">
   * <md-fab-toolbar>
   *   <md-fab-trigger>
   *     <md-button aria-label="Add..."><md-icon icon="/img/icons/plus.svg"></md-icon></md-button>
   *   </md-fab-trigger>
   *
   *   <md-fab-actions>
   *     <md-button aria-label="Add User">
   *       <md-icon icon="/img/icons/user.svg"></md-icon>
   *     </md-button>
   *
   *     <md-button aria-label="Add Group">
   *       <md-icon icon="/img/icons/group.svg"></md-icon>
   *     </md-button>
   *   </md-fab-actions>
   * </md-fab-toolbar>
   * </hljs>
   *
   * @param {expression=} md-open Programmatically control whether or not the toolbar is visible.
   */
  function MdFabToolbarDirective() {
    FabToolbarController.$inject = ["$scope", "$element", "$animate"];
    return {
      restrict: 'E',
      transclude: true,
      template:
        '<div class="md-fab-toolbar-wrapper">' +
        '  <div class="md-fab-toolbar-content" ng-transclude></div>' +
        '</div>',

      scope: {
        isOpen: '=?mdOpen'
      },

      bindToController: true,
      controller: FabToolbarController,
      controllerAs: 'vm',

      link: link
    };

    function FabToolbarController($scope, $element, $animate) {
      var vm = this;

      // Set the default to be closed
      vm.isOpen = vm.isOpen || false;

      vm.open = function() {
        vm.isOpen = true;
        $scope.$apply();
      };

      vm.close = function() {
        vm.isOpen = false;
        $scope.$apply();
      };

      // Add our class so we can trigger the animation on start
      $element.addClass('md-fab-toolbar');

      // Setup some mouse events so the hover effect can be triggered
      // anywhere over the toolbar
      $element.on('mouseenter', vm.open);
      $element.on('mouseleave', vm.close);

      // Watch for changes to md-open and toggle our class
      $scope.$watch('vm.isOpen', function(isOpen) {
        var toAdd = isOpen ? 'md-is-open' : '';
        var toRemove = isOpen ? '' : 'md-is-open';

        $animate.setClass($element, toAdd, toRemove);
      });
    }

    function link(scope, element, attributes) {
      // Don't allow focus on the trigger
      element.find('md-fab-trigger').find('button').attr('tabindex', '-1');

      // Prepend the background element to the trigger's button
      element.find('md-fab-trigger').find('button')
        .prepend('<div class="md-fab-toolbar-background"></div>');
    }
  }

  function MdFabToolbarAnimation() {
    var originalIconDelay;

    function runAnimation(element, className, done) {
      var el = element[0];
      var ctrl = element.controller('mdFabToolbar');

      // Grab the relevant child elements
      var backgroundElement = el.querySelector('.md-fab-toolbar-background');
      var triggerElement = el.querySelector('md-fab-trigger button');
      var iconElement = el.querySelector('md-fab-trigger button md-icon');
      var actions = element.find('md-fab-actions').children();

      // If we have both elements, use them to position the new background
      if (triggerElement && backgroundElement) {
        // Get our variables
        var color = window.getComputedStyle(triggerElement).getPropertyValue('background-color');
        var width = el.offsetWidth;
        var height = el.offsetHeight;

        // Make a square
        var scale = width * 2;

        // Set some basic styles no matter what animation we're doing
        backgroundElement.style.backgroundColor = color;
        backgroundElement.style.borderRadius = width + 'px';

        // If we're open
        if (ctrl.isOpen) {

          // Set the width/height to take up the full toolbar width
          backgroundElement.style.width = scale + 'px';
          backgroundElement.style.height = scale + 'px';

          // Set the top/left to move up/left (or right) by the scale width/height
          backgroundElement.style.top = -(scale / 2) + 'px';

          if (element.hasClass('md-left')) {
            backgroundElement.style.left = -(scale / 2) + 'px';
            backgroundElement.style.right = null;
          }

          if (element.hasClass('md-right')) {
            backgroundElement.style.right = -(scale / 2) + 'px';
            backgroundElement.style.left = null;
          }

          // Set the next close animation to have the proper delays
          backgroundElement.style.transitionDelay = '0ms';
          iconElement.style.transitionDelay = '.3s';

          // Apply a transition delay to actions
          angular.forEach(actions, function(action, index) {
            action.style.transitionDelay = (actions.length - index) * 25 + 'ms';
          });
        } else {
          // Otherwise, set the width/height to the trigger's width/height
          backgroundElement.style.width = triggerElement.offsetWidth + 'px';
          backgroundElement.style.height = triggerElement.offsetHeight + 'px';

          // Reset the position
          backgroundElement.style.top = '0px';

          if (element.hasClass('md-left')) {
            backgroundElement.style.left = '0px';
            backgroundElement.style.right = null;
          }

          if (element.hasClass('md-right')) {
            backgroundElement.style.right = '0px';
            backgroundElement.style.left = null;
          }

          // Set the next open animation to have the proper delays
          backgroundElement.style.transitionDelay = '200ms';
          iconElement.style.transitionDelay = '0ms';

          // Apply a transition delay to actions
          angular.forEach(actions, function(action, index) {
            action.style.transitionDelay = (index * 25) + 'ms';
          });
        }
      }
    }

    return {
      addClass: function(element, className, done) {
        runAnimation(element, className, done);
      },

      removeClass: function(element, className, done) {
        runAnimation(element, className, done);
      }
    }
  }
})();
})();
(function(){
"use strict";

(function() {
  'use strict';

  angular
    .module('material.components.fabTrigger', [ 'material.core' ])
    .directive('mdFabTrigger', MdFabTriggerDirective);

  /**
   * @ngdoc directive
   * @name mdFabTrigger
   * @module material.components.fabSpeedDial
   *
   * @restrict E
   *
   * @description
   * The `<md-fab-trigger>` directive is used inside of a `<md-fab-speed-dial>` or
   * `<md-fab-toolbar>` directive to mark the an element (or elements) as the trigger and setup the
   * proper event listeners.
   *
   * @usage
   * See the `<md-fab-speed-dial>` or `<md-fab-toolbar>` directives for example usage.
   */
  function MdFabTriggerDirective() {
    return {
      restrict: 'E',

      require: ['^?mdFabSpeedDial', '^?mdFabToolbar'],

      link: function(scope, element, attributes, controllers) {
        // Grab whichever parent controller is used
        var controller = controllers[0] || controllers[1];

        // Make the children open/close their parent directive
        if (controller) {
          angular.forEach(element.children(), function(child) {
            angular.element(child).on('focus', controller.open);
            angular.element(child).on('blur', controller.close);
          });
        }
      }
    }
  }
})();


})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.gridList
 */
angular.module('material.components.gridList', ['material.core'])
       .directive('mdGridList', GridListDirective)
       .directive('mdGridTile', GridTileDirective)
       .directive('mdGridTileFooter', GridTileCaptionDirective)
       .directive('mdGridTileHeader', GridTileCaptionDirective)
       .factory('$mdGridLayout', GridLayoutFactory);

/**
 * @ngdoc directive
 * @name mdGridList
 * @module material.components.gridList
 * @restrict E
 * @description
 * Grid lists are an alternative to standard list views. Grid lists are distinct
 * from grids used for layouts and other visual presentations.
 *
 * A grid list is best suited to presenting a homogenous data type, typically
 * images, and is optimized for visual comprehension and differentiating between
 * like data types.
 *
 * A grid list is a continuous element consisting of tessellated, regular
 * subdivisions called cells that contain tiles (`md-grid-tile`).
 *
 * <img src="//material-design.storage.googleapis.com/publish/v_2/material_ext_publish/0Bx4BSt6jniD7OVlEaXZ5YmU1Xzg/components_grids_usage2.png"
 *    style="width: 300px; height: auto; margin-right: 16px;" alt="Concept of grid explained visually">
 * <img src="//material-design.storage.googleapis.com/publish/v_2/material_ext_publish/0Bx4BSt6jniD7VGhsOE5idWlJWXM/components_grids_usage3.png"
 *    style="width: 300px; height: auto;" alt="Grid concepts legend">
 *
 * Cells are arrayed vertically and horizontally within the grid.
 *
 * Tiles hold content and can span one or more cells vertically or horizontally.
 *
 * ### Responsive Attributes
 *
 * The `md-grid-list` directive supports "responsive" attributes, which allow
 * different `md-cols`, `md-gutter` and `md-row-height` values depending on the
 * currently matching media query (as defined in `$mdConstant.MEDIA`).
 *
 * In order to set a responsive attribute, first define the fallback value with
 * the standard attribute name, then add additional attributes with the
 * following convention: `{base-attribute-name}-{media-query-name}="{value}"`
 * (ie. `md-cols-lg="8"`)
 *
 * @param {number} md-cols Number of columns in the grid.
 * @param {string} md-row-height One of
 * <ul>
 *   <li>CSS length - Fixed height rows (eg. `8px` or `1rem`)</li>
 *   <li>`{width}:{height}` - Ratio of width to height (eg.
 *   `md-row-height="16:9"`)</li>
 *   <li>`"fit"` - Height will be determined by subdividing the available
 *   height by the number of rows</li>
 * </ul>
 * @param {string=} md-gutter The amount of space between tiles in CSS units
 *     (default 1px)
 * @param {expression=} md-on-layout Expression to evaluate after layout. Event
 *     object is available as `$event`, and contains performance information.
 *
 * @usage
 * Basic:
 * <hljs lang="html">
 * <md-grid-list md-cols="5" md-gutter="1em" md-row-height="4:3">
 *   <md-grid-tile></md-grid-tile>
 * </md-grid-list>
 * </hljs>
 *
 * Fixed-height rows:
 * <hljs lang="html">
 * <md-grid-list md-cols="4" md-row-height="200px" ...>
 *   <md-grid-tile></md-grid-tile>
 * </md-grid-list>
 * </hljs>
 *
 * Fit rows:
 * <hljs lang="html">
 * <md-grid-list md-cols="4" md-row-height="fit" style="height: 400px;" ...>
 *   <md-grid-tile></md-grid-tile>
 * </md-grid-list>
 * </hljs>
 *
 * Using responsive attributes:
 * <hljs lang="html">
 * <md-grid-list
 *     md-cols-sm="2"
 *     md-cols-md="4"
 *     md-cols-lg="8"
 *     md-cols-gt-lg="12"
 *     ...>
 *   <md-grid-tile></md-grid-tile>
 * </md-grid-list>
 * </hljs>
 */
function GridListDirective($interpolate, $mdConstant, $mdGridLayout, $mdMedia) {
  return {
    restrict: 'E',
    controller: GridListController,
    scope: {
      mdOnLayout: '&'
    },
    link: postLink
  };

  function postLink(scope, element, attrs, ctrl) {
    // Apply semantics
    element.attr('role', 'list');

    // Provide the controller with a way to trigger layouts.
    ctrl.layoutDelegate = layoutDelegate;

    var invalidateLayout = angular.bind(ctrl, ctrl.invalidateLayout),
        unwatchAttrs = watchMedia();
      scope.$on('$destroy', unwatchMedia);

    /**
     * Watches for changes in media, invalidating layout as necessary.
     */
    function watchMedia() {
      for (var mediaName in $mdConstant.MEDIA) {
        $mdMedia(mediaName); // initialize
        $mdMedia.getQuery($mdConstant.MEDIA[mediaName])
            .addListener(invalidateLayout);
      }
      return $mdMedia.watchResponsiveAttributes(
          ['md-cols', 'md-row-height'], attrs, layoutIfMediaMatch);
    }

    function unwatchMedia() {
      ctrl.layoutDelegate = angular.noop;

      unwatchAttrs();
      for (var mediaName in $mdConstant.MEDIA) {
        $mdMedia.getQuery($mdConstant.MEDIA[mediaName])
            .removeListener(invalidateLayout);
      }
    }

    /**
     * Performs grid layout if the provided mediaName matches the currently
     * active media type.
     */
    function layoutIfMediaMatch(mediaName) {
      if (mediaName == null) {
        // TODO(shyndman): It would be nice to only layout if we have
        // instances of attributes using this media type
        ctrl.invalidateLayout();
      } else if ($mdMedia(mediaName)) {
        ctrl.invalidateLayout();
      }
    }

    var lastLayoutProps;

    /**
     * Invokes the layout engine, and uses its results to lay out our
     * tile elements.
     *
     * @param {boolean} tilesInvalidated Whether tiles have been
     *    added/removed/moved since the last layout. This is to avoid situations
     *    where tiles are replaced with properties identical to their removed
     *    counterparts.
     */
    function layoutDelegate(tilesInvalidated) {
      var tiles = getTileElements();
      var props = {
        tileSpans: getTileSpans(tiles),
        colCount: getColumnCount(),
        rowMode: getRowMode(),
        rowHeight: getRowHeight(),
        gutter: getGutter()
      };

      if (!tilesInvalidated && angular.equals(props, lastLayoutProps)) {
        return;
      }

      var performance =
        $mdGridLayout(props.colCount, props.tileSpans, tiles)
          .map(function(tilePositions, rowCount) {
            return {
              grid: {
                element: element,
                style: getGridStyle(props.colCount, rowCount,
                    props.gutter, props.rowMode, props.rowHeight)
              },
              tiles: tilePositions.map(function(ps, i) {
                return {
                  element: angular.element(tiles[i]),
                  style: getTileStyle(ps.position, ps.spans,
                      props.colCount, props.rowCount,
                      props.gutter, props.rowMode, props.rowHeight)
                }
              })
            }
          })
          .reflow()
          .performance();

      // Report layout
      scope.mdOnLayout({
        $event: {
          performance: performance
        }
      });

      lastLayoutProps = props;
    }

    // Use $interpolate to do some simple string interpolation as a convenience.

    var startSymbol = $interpolate.startSymbol();
    var endSymbol = $interpolate.endSymbol();

    // Returns an expression wrapped in the interpolator's start and end symbols.
    function expr(exprStr) {
      return startSymbol + exprStr + endSymbol;
    }

    // The amount of space a single 1x1 tile would take up (either width or height), used as
    // a basis for other calculations. This consists of taking the base size percent (as would be
    // if evenly dividing the size between cells), and then subtracting the size of one gutter.
    // However, since there are no gutters on the edges, each tile only uses a fration
    // (gutterShare = numGutters / numCells) of the gutter size. (Imagine having one gutter per
    // tile, and then breaking up the extra gutter on the edge evenly among the cells).
    var UNIT = $interpolate(expr('share') + '% - (' + expr('gutter') + ' * ' + expr('gutterShare') + ')');

    // The horizontal or vertical position of a tile, e.g., the 'top' or 'left' property value.
    // The position comes the size of a 1x1 tile plus gutter for each previous tile in the
    // row/column (offset).
    var POSITION  = $interpolate('calc((' + expr('unit') + ' + ' + expr('gutter') + ') * ' + expr('offset') + ')');

    // The actual size of a tile, e.g., width or height, taking rowSpan or colSpan into account.
    // This is computed by multiplying the base unit by the rowSpan/colSpan, and then adding back
    // in the space that the gutter would normally have used (which was already accounted for in
    // the base unit calculation).
    var DIMENSION = $interpolate('calc((' + expr('unit') + ') * ' + expr('span') + ' + (' + expr('span') + ' - 1) * ' + expr('gutter') + ')');

    /**
     * Gets the styles applied to a tile element described by the given parameters.
     * @param {{row: number, col: number}} position The row and column indices of the tile.
     * @param {{row: number, col: number}} spans The rowSpan and colSpan of the tile.
     * @param {number} colCount The number of columns.
     * @param {number} rowCount The number of rows.
     * @param {string} gutter The amount of space between tiles. This will be something like
     *     '5px' or '2em'.
     * @param {string} rowMode The row height mode. Can be one of:
     *     'fixed': all rows have a fixed size, given by rowHeight,
     *     'ratio': row height defined as a ratio to width, or
     *     'fit': fit to the grid-list element height, divinding evenly among rows.
     * @param {string|number} rowHeight The height of a row. This is only used for 'fixed' mode and
     *     for 'ratio' mode. For 'ratio' mode, this is the *ratio* of width-to-height (e.g., 0.75).
     * @returns {Object} Map of CSS properties to be applied to the style element. Will define
     *     values for top, left, width, height, marginTop, and paddingTop.
     */
    function getTileStyle(position, spans, colCount, rowCount, gutter, rowMode, rowHeight) {
      // TODO(shyndman): There are style caching opportunities here.

      // Percent of the available horizontal space that one column takes up.
      var hShare = (1 / colCount) * 100;

      // Fraction of the gutter size that each column takes up.
      var hGutterShare = (colCount - 1) / colCount;

      // Base horizontal size of a column.
      var hUnit = UNIT({share: hShare, gutterShare: hGutterShare, gutter: gutter});

      // The width and horizontal position of each tile is always calculated the same way, but the
      // height and vertical position depends on the rowMode.
      var style = {
        left: POSITION({ unit: hUnit, offset: position.col, gutter: gutter }),
        width: DIMENSION({ unit: hUnit, span: spans.col, gutter: gutter }),
        // resets
        paddingTop: '',
        marginTop: '',
        top: '',
        height: ''
      };

      switch (rowMode) {
        case 'fixed':
          // In fixed mode, simply use the given rowHeight.
          style.top = POSITION({ unit: rowHeight, offset: position.row, gutter: gutter });
          style.height = DIMENSION({ unit: rowHeight, span: spans.row, gutter: gutter });
          break;

        case 'ratio':
          // Percent of the available vertical space that one row takes up. Here, rowHeight holds
          // the ratio value. For example, if the width:height ratio is 4:3, rowHeight = 1.333.
          var vShare = hShare / rowHeight;

          // Base veritcal size of a row.
          var vUnit = UNIT({ share: vShare, gutterShare: hGutterShare, gutter: gutter });

          // padidngTop and marginTop are used to maintain the given aspect ratio, as
          // a percentage-based value for these properties is applied to the *width* of the
          // containing block. See http://www.w3.org/TR/CSS2/box.html#margin-properties
          style.paddingTop = DIMENSION({ unit: vUnit, span: spans.row, gutter: gutter});
          style.marginTop = POSITION({ unit: vUnit, offset: position.row, gutter: gutter });
          break;

        case 'fit':
          // Fraction of the gutter size that each column takes up.
          var vGutterShare = (rowCount - 1) / rowCount;

          // Percent of the available vertical space that one row takes up.
          var vShare = (1 / rowCount) * 100;

          // Base vertical size of a row.
          var vUnit = UNIT({share: vShare, gutterShare: vGutterShare, gutter: gutter});

          style.top = POSITION({unit: vUnit, offset: position.row, gutter: gutter});
          style.height = DIMENSION({unit: vUnit, span: spans.row, gutter: gutter});
          break;
      }

      return style;
    }

    function getGridStyle(colCount, rowCount, gutter, rowMode, rowHeight) {
      var style = {
        height: '',
        paddingBottom: ''
      };

      switch(rowMode) {
        case 'fixed':
          style.height = DIMENSION({ unit: rowHeight, span: rowCount, gutter: gutter });
          break;

        case 'ratio':
          // rowHeight is width / height
          var hGutterShare = colCount === 1 ? 0 : (colCount - 1) / colCount,
              hShare = (1 / colCount) * 100,
              vShare = hShare * (1 / rowHeight),
              vUnit = UNIT({ share: vShare, gutterShare: hGutterShare, gutter: gutter });

          style.paddingBottom = DIMENSION({ unit: vUnit, span: rowCount, gutter: gutter});
          break;

        case 'fit':
          // noop, as the height is user set
          break;
      }

      return style;
    }

    function getTileElements() {
      return [].filter.call(element.children(), function(ele) {
        return ele.tagName == 'MD-GRID-TILE';
      });
    }

    /**
     * Gets an array of objects containing the rowspan and colspan for each tile.
     * @returns {Array<{row: number, col: number}>}
     */
    function getTileSpans(tileElements) {
      return [].map.call(tileElements, function(ele) {
        var ctrl = angular.element(ele).controller('mdGridTile');
        return {
          row: parseInt(
              $mdMedia.getResponsiveAttribute(ctrl.$attrs, 'md-rowspan'), 10) || 1,
          col: parseInt(
              $mdMedia.getResponsiveAttribute(ctrl.$attrs, 'md-colspan'), 10) || 1
        };
      });
    }

    function getColumnCount() {
      var colCount = parseInt($mdMedia.getResponsiveAttribute(attrs, 'md-cols'), 10);
      if (isNaN(colCount)) {
        throw 'md-grid-list: md-cols attribute was not found, or contained a non-numeric value';
      }
      return colCount;
    }

    function getGutter() {
      return applyDefaultUnit($mdMedia.getResponsiveAttribute(attrs, 'md-gutter') || 1);
    }

    function getRowHeight() {
      var rowHeight = $mdMedia.getResponsiveAttribute(attrs, 'md-row-height');
      switch (getRowMode()) {
        case 'fixed':
          return applyDefaultUnit(rowHeight);
        case 'ratio':
          var whRatio = rowHeight.split(':');
          return parseFloat(whRatio[0]) / parseFloat(whRatio[1]);
        case 'fit':
          return 0; // N/A
      }
    }

    function getRowMode() {
      var rowHeight = $mdMedia.getResponsiveAttribute(attrs, 'md-row-height');
      if (rowHeight == 'fit') {
        return 'fit';
      } else if (rowHeight.indexOf(':') !== -1) {
        return 'ratio';
      } else {
        return 'fixed';
      }
    }

    function applyDefaultUnit(val) {
      return /\D$/.test(val) ? val : val + 'px';
    }
  }
}
GridListDirective.$inject = ["$interpolate", "$mdConstant", "$mdGridLayout", "$mdMedia"];

/* @ngInject */
function GridListController($timeout) {
  this.layoutInvalidated = false;
  this.tilesInvalidated = false;
  this.$timeout_ = $timeout;
  this.layoutDelegate = angular.noop;
}
GridListController.$inject = ["$timeout"];

GridListController.prototype = {
  invalidateTiles: function() {
    this.tilesInvalidated = true;
    this.invalidateLayout();
  },

  invalidateLayout: function() {
    if (this.layoutInvalidated) {
      return;
    }
    this.layoutInvalidated = true;
    this.$timeout_(angular.bind(this, this.layout));
  },

  layout: function() {
    try {
      this.layoutDelegate(this.tilesInvalidated);
    } finally {
      this.layoutInvalidated = false;
      this.tilesInvalidated = false;
    }
  }
};


/* @ngInject */
function GridLayoutFactory($mdUtil) {
  var defaultAnimator = GridTileAnimator;

  /**
   * Set the reflow animator callback
   */
  GridLayout.animateWith = function(customAnimator) {
    defaultAnimator = !angular.isFunction(customAnimator) ? GridTileAnimator : customAnimator;
  };

  return GridLayout;

  /**
   * Publish layout function
   */
  function GridLayout(colCount, tileSpans) {
      var self, layoutInfo, gridStyles, layoutTime, mapTime, reflowTime;

      layoutTime = $mdUtil.time(function() {
        layoutInfo = calculateGridFor(colCount, tileSpans);
      });

      return self = {

        /**
         * An array of objects describing each tile's position in the grid.
         */
        layoutInfo: function() {
          return layoutInfo;
        },

        /**
         * Maps grid positioning to an element and a set of styles using the
         * provided updateFn.
         */
        map: function(updateFn) {
          mapTime = $mdUtil.time(function() {
            var info = self.layoutInfo();
            gridStyles = updateFn(info.positioning, info.rowCount);
          });
          return self;
        },

        /**
         * Default animator simply sets the element.css( <styles> ). An alternate
         * animator can be provided as an argument. The function has the following
         * signature:
         *
         *    function({grid: {element: JQLite, style: Object}, tiles: Array<{element: JQLite, style: Object}>)
         */
        reflow: function(animatorFn) {
          reflowTime = $mdUtil.time(function() {
            var animator = animatorFn || defaultAnimator;
            animator(gridStyles.grid, gridStyles.tiles);
          });
          return self;
        },

        /**
         * Timing for the most recent layout run.
         */
        performance: function() {
          return {
            tileCount: tileSpans.length,
            layoutTime: layoutTime,
            mapTime: mapTime,
            reflowTime: reflowTime,
            totalTime: layoutTime + mapTime + reflowTime
          };
        }
      };
    }

  /**
   * Default Gridlist animator simple sets the css for each element;
   * NOTE: any transitions effects must be manually set in the CSS.
   * e.g.
   *
   *  md-grid-tile {
   *    transition: all 700ms ease-out 50ms;
   *  }
   *
   */
  function GridTileAnimator(grid, tiles) {
    grid.element.css(grid.style);
    tiles.forEach(function(t) {
      t.element.css(t.style);
    })
  }

  /**
   * Calculates the positions of tiles.
   *
   * The algorithm works as follows:
   *    An Array<Number> with length colCount (spaceTracker) keeps track of
   *    available tiling positions, where elements of value 0 represents an
   *    empty position. Space for a tile is reserved by finding a sequence of
   *    0s with length <= than the tile's colspan. When such a space has been
   *    found, the occupied tile positions are incremented by the tile's
   *    rowspan value, as these positions have become unavailable for that
   *    many rows.
   *
   *    If the end of a row has been reached without finding space for the
   *    tile, spaceTracker's elements are each decremented by 1 to a minimum
   *    of 0. Rows are searched in this fashion until space is found.
   */
  function calculateGridFor(colCount, tileSpans) {
    var curCol = 0,
        curRow = 0,
        spaceTracker = newSpaceTracker();

    return {
      positioning: tileSpans.map(function(spans, i) {
        return {
          spans: spans,
          position: reserveSpace(spans, i)
        };
      }),
      rowCount: curRow + Math.max.apply(Math, spaceTracker)
    };

    function reserveSpace(spans, i) {
      if (spans.col > colCount) {
        throw 'md-grid-list: Tile at position ' + i + ' has a colspan ' +
            '(' + spans.col + ') that exceeds the column count ' +
            '(' + colCount + ')';
      }

      var start = 0,
          end = 0;

      // TODO(shyndman): This loop isn't strictly necessary if you can
      // determine the minimum number of rows before a space opens up. To do
      // this, recognize that you've iterated across an entire row looking for
      // space, and if so fast-forward by the minimum rowSpan count. Repeat
      // until the required space opens up.
      while (end - start < spans.col) {
        if (curCol >= colCount) {
          nextRow();
          continue;
        }

        start = spaceTracker.indexOf(0, curCol);
        if (start === -1 || (end = findEnd(start + 1)) === -1) {
          start = end = 0;
          nextRow();
          continue;
        }

        curCol = end + 1;
      }

      adjustRow(start, spans.col, spans.row);
      curCol = start + spans.col;

      return {
        col: start,
        row: curRow
      };
    }

    function nextRow() {
      curCol = 0;
      curRow++;
      adjustRow(0, colCount, -1); // Decrement row spans by one
    }

    function adjustRow(from, cols, by) {
      for (var i = from; i < from + cols; i++) {
        spaceTracker[i] = Math.max(spaceTracker[i] + by, 0);
      }
    }

    function findEnd(start) {
      var i;
      for (i = start; i < spaceTracker.length; i++) {
        if (spaceTracker[i] !== 0) {
          return i;
        }
      }

      if (i === spaceTracker.length) {
        return i;
      }
    }

    function newSpaceTracker() {
      var tracker = [];
      for (var i = 0; i < colCount; i++) {
        tracker.push(0);
      }
      return tracker;
    }
  }
}
GridLayoutFactory.$inject = ["$mdUtil"];

/**
 * @ngdoc directive
 * @name mdGridTile
 * @module material.components.gridList
 * @restrict E
 * @description
 * Tiles contain the content of an `md-grid-list`. They span one or more grid
 * cells vertically or horizontally, and use `md-grid-tile-{footer,header}` to
 * display secondary content.
 *
 * ### Responsive Attributes
 *
 * The `md-grid-tile` directive supports "responsive" attributes, which allow
 * different `md-rowspan` and `md-colspan` values depending on the currently
 * matching media query (as defined in `$mdConstant.MEDIA`).
 *
 * In order to set a responsive attribute, first define the fallback value with
 * the standard attribute name, then add additional attributes with the
 * following convention: `{base-attribute-name}-{media-query-name}="{value}"`
 * (ie. `md-colspan-sm="4"`)
 *
 * @param {number=} md-colspan The number of columns to span (default 1). Cannot
 *    exceed the number of columns in the grid. Supports interpolation.
 * @param {number=} md-rowspan The number of rows to span (default 1). Supports
 *     interpolation.
 *
 * @usage
 * With header:
 * <hljs lang="html">
 * <md-grid-tile>
 *   <md-grid-tile-header>
 *     <h3>This is a header</h3>
 *   </md-grid-tile-header>
 * </md-grid-tile>
 * </hljs>
 *
 * With footer:
 * <hljs lang="html">
 * <md-grid-tile>
 *   <md-grid-tile-footer>
 *     <h3>This is a footer</h3>
 *   </md-grid-tile-footer>
 * </md-grid-tile>
 * </hljs>
 *
 * Spanning multiple rows/columns:
 * <hljs lang="html">
 * <md-grid-tile md-colspan="2" md-rowspan="3">
 * </md-grid-tile>
 * </hljs>
 *
 * Responsive attributes:
 * <hljs lang="html">
 * <md-grid-tile md-colspan="1" md-colspan-sm="3" md-colspan-md="5">
 * </md-grid-tile>
 * </hljs>
 */
function GridTileDirective($mdMedia) {
  return {
    restrict: 'E',
    require: '^mdGridList',
    template: '<figure ng-transclude></figure>',
    transclude: true,
    scope: {},
    // Simple controller that exposes attributes to the grid directive
    controller: ["$attrs", function($attrs) {
      this.$attrs = $attrs;
    }],
    link: postLink
  };

  function postLink(scope, element, attrs, gridCtrl) {
    // Apply semantics
    element.attr('role', 'listitem');

    // If our colspan or rowspan changes, trigger a layout
    var unwatchAttrs = $mdMedia.watchResponsiveAttributes(['md-colspan', 'md-rowspan'],
        attrs, angular.bind(gridCtrl, gridCtrl.invalidateLayout));

    // Tile registration/deregistration
    gridCtrl.invalidateTiles();
    scope.$on('$destroy', function() {
      unwatchAttrs();
      gridCtrl.invalidateLayout();
    });

    if (angular.isDefined(scope.$parent.$index)) {
      scope.$watch(function() { return scope.$parent.$index; },
        function indexChanged(newIdx, oldIdx) {
          if (newIdx === oldIdx) {
            return;
          }
          gridCtrl.invalidateTiles();
        });
    }
  }
}
GridTileDirective.$inject = ["$mdMedia"];


function GridTileCaptionDirective() {
  return {
    template: '<figcaption ng-transclude></figcaption>',
    transclude: true
  };
}

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.icon
 * @description
 * Icon
 */
angular.module('material.components.icon', [
    'material.core'
  ])
  .directive('mdIcon', mdIconDirective);

/**
 * @ngdoc directive
 * @name mdIcon
 * @module material.components.icon
 *
 * @restrict E
 *
 * @description
 * The `<md-icon>` directive is an markup element useful for showing an icon based on a font-icon
 * or a SVG. Icons are view-only elements that should not be used directly as buttons; instead nest a `<md-icon>`
 * inside a `md-button` to add hover and click features.
 *
 * When using SVGs, both external SVGs (via URLs) or sets of SVGs [from icon sets] can be
 * easily loaded and used.When use font-icons, developers must following three (3) simple steps:
 *
 * <ol>
 * <li>Load the font library. e.g.<br/>
 *    &lt;link href="https://fonts.googleapis.com/icon?family=Material+Icons"
 *    rel="stylesheet"&gt;
 * </li>
 * <li> Use either (a) font-icon class names or (b) font ligatures to render the font glyph by using its textual name</li>
 * <li> Use &lt;md-icon md-font-icon="classname" /&gt; or <br/>
 *     use &lt;md-icon md-font-set="font library classname or alias"&gt; textual_name &lt;/md-icon&gt; or <br/>
 *     use &lt;md-icon md-font-set="font library classname or alias"&gt; numerical_character_reference &lt;/md-icon&gt;
 * </li>
 * </ol>
 *
 * Full details for these steps can be found:
 *
 * <ul>
 * <li>http://google.github.io/material-design-icons/</li>
 * <li>http://google.github.io/material-design-icons/#icon-font-for-the-web</li>
 * </ul>
 *
 * The Material Design icon style <code>.material-icons</code> and the icon font references are published in
 * Material Design Icons:
 *
 * <ul>
 * <li>http://www.google.com/design/icons/</li>
 * <li>https://www.google.com/design/icons/#ic_accessibility</li>
 * </ul>
 *
 * <h2 id="material_design_icons">Material Design Icons</h2>
 * Using the Material Design Icon-Selector, developers can easily and quickly search for a Material Design font-icon and
 * determine its textual name and character reference code. Click on any icon to see the slide-up information
 * panel with details regarding a SVG download or information on the font-icon usage.
 *
 * <a href="https://www.google.com/design/icons/#ic_accessibility" target="_blank" style="border-bottom:none;">
 * <img src="https://cloud.githubusercontent.com/assets/210413/7902490/fe8dd14c-0780-11e5-98fb-c821cc6475e6.png"
 *      aria-label="Material Design Icon-Selector" style="max-width:75%;padding-left:10%">
 * </a>
 *
 * <span class="image_caption">
 *  Click on the image above to link to the
 *  <a href="https://www.google.com/design/icons/#ic_accessibility" target="_blank">Material Design Icon-Selector</a>.
 * </span>
 *
 * @param {string} md-font-icon Name of CSS icon associated with the font-face will be used
 * to render the icon. Requires the fonts and the named CSS styles to be preloaded.
 * @param {string} md-font-set CSS style name associated with the font library; which will be assigned as
 * the class for the font-icon ligature. This value may also be an alias that is used to lookup the classname;
 * internally use `$mdIconProvider.fontSet(<alias>)` to determine the style name.
 * @param {string} md-svg-src URL [or expression ] used to load, cache, and display an external SVG.
 * @param {string} md-svg-icon Name used for lookup of the icon from the internal cache; interpolated strings or
 * expressions may also be used. Specific set names can be used with the syntax `<set name>:<icon name>`.<br/><br/>
 * To use icon sets, developers are required to pre-register the sets using the `$mdIconProvider` service.
 * @param {string=} aria-label Labels icon for accessibility. If an empty string is provided, icon
 * will be hidden from accessibility layer with `aria-hidden="true"`. If there's no aria-label on the icon
 * nor a label on the parent element, a warning will be logged to the console.
 *
 * @usage
 * When using SVGs:
 * <hljs lang="html">
 *
 *  <!-- Icon ID; may contain optional icon set prefix; icons must registered using $mdIconProvider -->
 *  <md-icon md-svg-icon="social:android"    aria-label="android " ></md-icon>
 *
 *  <!-- Icon urls; may be preloaded in templateCache -->
 *  <md-icon md-svg-src="/android.svg"       aria-label="android " ></md-icon>
 *  <md-icon md-svg-src="{{ getAndroid() }}" aria-label="android " ></md-icon>
 *
 * </hljs>
 *
 * Use the <code>$mdIconProvider</code> to configure your application with
 * svg iconsets.
 *
 * <hljs lang="js">
 *  angular.module('appSvgIconSets', ['ngMaterial'])
 *    .controller('DemoCtrl', function($scope) {})
 *    .config(function($mdIconProvider) {
 *      $mdIconProvider
 *         .iconSet('social', 'img/icons/sets/social-icons.svg', 24)
 *         .defaultIconSet('img/icons/sets/core-icons.svg', 24);
 *     });
 * </hljs>
 *
 *
 * When using Font Icons with classnames:
 * <hljs lang="html">
 *
 *  <md-icon md-font-icon="android" aria-label="android" ></md-icon>
 *  <md-icon class="icon_home"      aria-label="Home"    ></md-icon>
 *
 * </hljs>
 *
 * When using Material Font Icons with ligatures:
 * <hljs lang="html">
 *  <!-- For Material Design Icons -->
 *  <!-- The class '.material-icons' is auto-added if a style has NOT been specified -->
 *  <md-icon> face </md-icon>
 *  <md-icon md-font-set="material-icons"> face </md-icon>
 *  <md-icon> #xE87C; </md-icon>
 *  <!-- The class '.material-icons' must be manually added if other styles are also specified-->
 *  <md-icon class="material-icons md-light md-48"> face </md-icon>
 * </hljs>
 *
 * When using other Font-Icon libraries:
 *
 * <hljs lang="js">
 *  // Specify a font-icon style alias
 *  angular.config(function($mdIconProvider) {
 *    $mdIconProvider.fontSet('fa', 'fontawesome');
 *  });
 * </hljs>
 *
 * <hljs lang="html">
 *  <md-icon md-font-set="fa">email</md-icon>
 * </hljs>
 *
 */
function mdIconDirective($mdIcon, $mdTheming, $mdAria, $interpolate ) {

  return {
    scope: {
      fontSet : '@mdFontSet',
      fontIcon: '@mdFontIcon',
      svgIcon : '@mdSvgIcon',
      svgSrc  : '@mdSvgSrc'
    },
    restrict: 'E',
    link : postLink
  };


  /**
   * Directive postLink
   * Supports embedded SVGs, font-icons, & external SVGs
   */
  function postLink(scope, element, attr) {
    $mdTheming(element);

    prepareForFontIcon();

    // If using a font-icon, then the textual name of the icon itself
    // provides the aria-label.

    var label = attr.alt || scope.fontIcon || scope.svgIcon || element.text();
    var attrName = attr.$normalize(attr.$attr.mdSvgIcon || attr.$attr.mdSvgSrc || '');

    if ( !attr['aria-label'] ) {

      if (label != '' && !parentsHaveText() ) {

        $mdAria.expect(element, 'aria-label', label);
        $mdAria.expect(element, 'role', 'img');

      } else if ( !element.text() ) {
        // If not a font-icon with ligature, then
        // hide from the accessibility layer.

        $mdAria.expect(element, 'aria-hidden', 'true');
      }
    }

    if (attrName) {
      // Use either pre-configured SVG or URL source, respectively.
      attr.$observe(attrName, function(attrVal) {

        element.empty();
        if (attrVal) {
          $mdIcon(attrVal).then(function(svg) {
            element.append(svg);
          });
        }

      });
    }

    function parentsHaveText() {
      var parent = element.parent();
      if (parent.attr('aria-label') || parent.text()) {
        return true;
      }
      else if(parent.parent().attr('aria-label') || parent.parent().text()) {
        return true;
      }
      return false;
    }

    function prepareForFontIcon () {
      if (!scope.svgIcon && !scope.svgSrc) {

        if (scope.fontIcon) {
          element.addClass('md-font');
          element.addClass(scope.fontIcon);
        }

        if (scope.fontSet) {
          element.addClass($mdIcon.fontSet(scope.fontSet));
        }

        // For Material Design font icons, the class '.material-icons'
        // is auto-added IF a style has not been specified

        if (!scope.fontIcon && !scope.fontSet && !angular.isDefined(attr.class)) {

            element.addClass('material-icons');
        }
      }

    }
  }
}
mdIconDirective.$inject = ["$mdIcon", "$mdTheming", "$mdAria", "$interpolate"];

})();
(function(){
"use strict";

  angular
    .module('material.components.icon' )
    .provider('$mdIcon', MdIconProvider);

  /**
    * @ngdoc service
    * @name $mdIconProvider
    * @module material.components.icon
    *
    * @description
    * `$mdIconProvider` is used only to register icon IDs with URLs. These configuration features allow
    * icons and icon sets to be pre-registered and associated with source URLs **before** the `<md-icon />`
    * directives are compiled.
    *
    * If using font-icons, the developer is repsonsible for loading the fonts.
    *
    * If using SVGs, loading of the actual svg files are deferred to on-demand requests and are loaded
    * internally by the `$mdIcon` service using the `$http` service. When an SVG is requested by name/ID,
    * the `$mdIcon` service searches its registry for the associated source URL;
    * that URL is used to on-demand load and parse the SVG dynamically.
    *
    * @usage
    * <hljs lang="js">
    *   app.config(function($mdIconProvider) {
    *
    *     // Configure URLs for icons specified by [set:]id.
    *
    *     $mdIconProvider
    *          .defaultFontSet( 'fontawesome' )
    *          .defaultIconSet('my/app/icons.svg')       // Register a default set of SVG icons
    *          .iconSet('social', 'my/app/social.svg')   // Register a named icon set of SVGs
    *          .icon('android', 'my/app/android.svg')    // Register a specific icon (by name)
    *          .icon('work:chair', 'my/app/chair.svg');  // Register icon in a specific set
    *   });
    * </hljs>
    *
    * SVG icons and icon sets can be easily pre-loaded and cached using either (a) a build process or (b) a runtime
    * **startup** process (shown below):
    *
    * <hljs lang="js">
    *   app.config(function($mdIconProvider) {
    *
    *     // Register a default set of SVG icon definitions
    *     $mdIconProvider.defaultIconSet('my/app/icons.svg')
    *
    *   })
    *   .run(function($http, $templateCache){
    *
    *     // Pre-fetch icons sources by URL and cache in the $templateCache...
    *     // subsequent $http calls will look there first.
    *
    *     var urls = [ 'imy/app/icons.svg', 'img/icons/android.svg'];
    *
    *     angular.forEach(urls, function(url) {
    *       $http.get(url, {cache: $templateCache});
    *     });
    *
    *   });
    *
    * </hljs>
    *
    * NOTE: the loaded SVG data is subsequently cached internally for future requests.
    *
    */

   /**
    * @ngdoc method
    * @name $mdIconProvider#icon
    *
    * @description
    * Register a source URL for a specific icon name; the name may include optional 'icon set' name prefix.
    * These icons  will later be retrieved from the cache using `$mdIcon( <icon name> )`
    *
    * @param {string} id Icon name/id used to register the icon
    * @param {string} url specifies the external location for the data file. Used internally by `$http` to load the
    * data or as part of the lookup in `$templateCache` if pre-loading was configured.
    * @param {number=} viewBoxSize Sets the width and height the icon's viewBox.
    * It is ignored for icons with an existing viewBox. Default size is 24.
    *
    * @returns {obj} an `$mdIconProvider` reference; used to support method call chains for the API
    *
    * @usage
    * <hljs lang="js">
    *   app.config(function($mdIconProvider) {
    *
    *     // Configure URLs for icons specified by [set:]id.
    *
    *     $mdIconProvider
    *          .icon('android', 'my/app/android.svg')    // Register a specific icon (by name)
    *          .icon('work:chair', 'my/app/chair.svg');  // Register icon in a specific set
    *   });
    * </hljs>
    *
    */
   /**
    * @ngdoc method
    * @name $mdIconProvider#iconSet
    *
    * @description
    * Register a source URL for a 'named' set of icons; group of SVG definitions where each definition
    * has an icon id. Individual icons can be subsequently retrieved from this cached set using
    * `$mdIcon(<icon set name>:<icon name>)`
    *
    * @param {string} id Icon name/id used to register the iconset
    * @param {string} url specifies the external location for the data file. Used internally by `$http` to load the
    * data or as part of the lookup in `$templateCache` if pre-loading was configured.
    * @param {number=} viewBoxSize Sets the width and height of the viewBox of all icons in the set. 
    * It is ignored for icons with an existing viewBox. All icons in the icon set should be the same size.
    * Default value is 24.
    *
    * @returns {obj} an `$mdIconProvider` reference; used to support method call chains for the API
    *
    *
    * @usage
    * <hljs lang="js">
    *   app.config(function($mdIconProvider) {
    *
    *     // Configure URLs for icons specified by [set:]id.
    *
    *     $mdIconProvider
    *          .iconSet('social', 'my/app/social.svg')   // Register a named icon set
    *   });
    * </hljs>
    *
    */
   /**
    * @ngdoc method
    * @name $mdIconProvider#defaultIconSet
    *
    * @description
    * Register a source URL for the default 'named' set of icons. Unless explicitly registered,
    * subsequent lookups of icons will failover to search this 'default' icon set.
    * Icon can be retrieved from this cached, default set using `$mdIcon(<name>)`
    *
    * @param {string} url specifies the external location for the data file. Used internally by `$http` to load the
    * data or as part of the lookup in `$templateCache` if pre-loading was configured.
    * @param {number=} viewBoxSize Sets the width and height of the viewBox of all icons in the set. 
    * It is ignored for icons with an existing viewBox. All icons in the icon set should be the same size.
    * Default value is 24.
    *
    * @returns {obj} an `$mdIconProvider` reference; used to support method call chains for the API
    *
    * @usage
    * <hljs lang="js">
    *   app.config(function($mdIconProvider) {
    *
    *     // Configure URLs for icons specified by [set:]id.
    *
    *     $mdIconProvider
    *          .defaultIconSet( 'my/app/social.svg' )   // Register a default icon set
    *   });
    * </hljs>
    *
    */
  /**
   * @ngdoc method
   * @name $mdIconProvider#defaultFontSet
   *
   * @description
   * When using Font-Icons, Angular Material assumes the the Material Design icons will be used and automatically
   * configures the default font-set == 'material-icons'. Note that the font-set references the font-icon library
   * class style that should be applied to the `<md-icon>`.
   *
   * Configuring the default means that the attributes
   * `md-font-set="material-icons"` or `class="material-icons"` do not need to be explicitly declared on the
   * `<md-icon>` markup. For example:
   *
   *  `<md-icon> face </md-icon>`
   *  will render as
   *  `<span class="material-icons"> face </span>`, and
   *
   *  `<md-icon md-font-set="fa"> face </md-icon>`
   *  will render as
   *  `<span class="fa"> face </span>`
   *
   * @param {string} name of the font-library style that should be applied to the md-icon DOM element
   *
   * @usage
   * <hljs lang="js">
   *   app.config(function($mdIconProvider) {
   *     $mdIconProvider.defaultFontSet( 'fontawesome' );
   *   });
   * </hljs>
   *
   */

   /**
    * @ngdoc method
    * @name $mdIconProvider#defaultViewBoxSize
    *
    * @description
    * While `<md-icon />` markup can also be style with sizing CSS, this method configures
    * the default width **and** height used for all icons; unless overridden by specific CSS.
    * The default sizing is (24px, 24px).
    * @param {number=} viewBoxSize Sets the width and height of the viewBox for an icon or an icon set.
    * All icons in a set should be the same size. The default value is 24.
    *
    * @returns {obj} an `$mdIconProvider` reference; used to support method call chains for the API
    *
    * @usage
    * <hljs lang="js">
    *   app.config(function($mdIconProvider) {
    *
    *     // Configure URLs for icons specified by [set:]id.
    *
    *     $mdIconProvider
    *          .defaultViewBoxSize(36)   // Register a default icon size (width == height)
    *   });
    * </hljs>
    *
    */

 var config = {
   defaultViewBoxSize: 24,
   defaultFontSet: 'material-icons',
   fontSets : [ ]
 };

 function MdIconProvider() { }

 MdIconProvider.prototype = {
   icon : function (id, url, viewBoxSize) {
     if ( id.indexOf(':') == -1 ) id = '$default:' + id;

     config[id] = new ConfigurationItem(url, viewBoxSize );
     return this;
   },

   iconSet : function (id, url, viewBoxSize) {
     config[id] = new ConfigurationItem(url, viewBoxSize );
     return this;
   },

   defaultIconSet : function (url, viewBoxSize) {
     var setName = '$default';

     if ( !config[setName] ) {
       config[setName] = new ConfigurationItem(url, viewBoxSize );
     }

     config[setName].viewBoxSize = viewBoxSize || config.defaultViewBoxSize;

     return this;
   },

   defaultViewBoxSize : function (viewBoxSize) {
     config.defaultViewBoxSize = viewBoxSize;
     return this;
   },
   
   /**
    * Register an alias name associated with a font-icon library style ;
    */
   fontSet : function fontSet(alias, className) {
    config.fontSets.push({
      alias : alias,
      fontSet : className || alias
    });
   },

   /**
    * Specify a default style name associated with a font-icon library
    * fallback to Material Icons.
    *
    */
   defaultFontSet : function defaultFontSet(className) {
    config.defaultFontSet = !className ? '' : className;
    return this;
   },

   defaultIconSize : function defaultIconSize(iconSize) {
     config.defaultIconSize = iconSize;
     return this;
   },

   preloadIcons: function ($templateCache) {
     var iconProvider = this;
     var svgRegistry = [
       {
         id : 'md-tabs-arrow',
         url: 'md-tabs-arrow.svg',
         svg: '<svg version="1.1" x="0px" y="0px" viewBox="0 0 24 24"><g><polygon points="15.4,7.4 14,6 8,12 14,18 15.4,16.6 10.8,12 "/></g></svg>'
       },
       {
         id : 'md-close',
         url: 'md-close.svg',
         svg: '<svg version="1.1" x="0px" y="0px" viewBox="0 0 24 24"><g><path d="M19 6.41l-1.41-1.41-5.59 5.59-5.59-5.59-1.41 1.41 5.59 5.59-5.59 5.59 1.41 1.41 5.59-5.59 5.59 5.59 1.41-1.41-5.59-5.59z"/></g></svg>'
       },
       {
         id:  'md-cancel',
         url: 'md-cancel.svg',
         svg: '<svg version="1.1" x="0px" y="0px" viewBox="0 0 24 24"><g><path d="M12 2c-5.53 0-10 4.47-10 10s4.47 10 10 10 10-4.47 10-10-4.47-10-10-10zm5 13.59l-1.41 1.41-3.59-3.59-3.59 3.59-1.41-1.41 3.59-3.59-3.59-3.59 1.41-1.41 3.59 3.59 3.59-3.59 1.41 1.41-3.59 3.59 3.59 3.59z"/></g></svg>'
       },
       {
         id:  'md-menu',
         url: 'md-menu.svg',
         svg: '<svg version="1.1" x="0px" y="0px" viewBox="0 0 100 100"><path d="M 50 0 L 100 14 L 92 80 L 50 100 L 8 80 L 0 14 Z" fill="#b2b2b2"></path><path d="M 50 5 L 6 18 L 13.5 77 L 50 94 Z" fill="#E42939"></path><path d="M 50 5 L 94 18 L 86.5 77 L 50 94 Z" fill="#B72833"></path><path d="M 50 7 L 83 75 L 72 75 L 65 59 L 50 59 L 50 50 L 61 50 L 50 26 Z" fill="#b2b2b2"></path><path d="M 50 7 L 17 75 L 28 75 L 35 59 L 50 59 L 50 50 L 39 50 L 50 26 Z" fill="#fff"></path></svg>'
       },
       {
         id:  'md-toggle-arrow',
         url: 'md-toggle-arrow-svg',
         svg: '<svg version="1.1" x="0px" y="0px" viewBox="0 0 48 48"><path d="M24 16l-12 12 2.83 2.83 9.17-9.17 9.17 9.17 2.83-2.83z"/><path d="M0 0h48v48h-48z" fill="none"/></svg>'
       }
     ];

     svgRegistry.forEach(function(asset){
       iconProvider.icon(asset.id,  asset.url);
       $templateCache.put(asset.url, asset.svg);
     });

   },

   $get : ['$http', '$q', '$log', '$templateCache', function($http, $q, $log, $templateCache) {
     this.preloadIcons($templateCache);
     return MdIconService(config, $http, $q, $log, $templateCache);
   }]
 };

   /**
    *  Configuration item stored in the Icon registry; used for lookups
    *  to load if not already cached in the `loaded` cache
    */
   function ConfigurationItem(url, viewBoxSize) {
     this.url = url;
     this.viewBoxSize = viewBoxSize || config.defaultViewBoxSize;
   }

 /**
  * @ngdoc service
  * @name $mdIcon
  * @module material.components.icon
  *
  * @description
  * The `$mdIcon` service is a function used to lookup SVG icons.
  *
  * @param {string} id Query value for a unique Id or URL. If the argument is a URL, then the service will retrieve the icon element
  * from its internal cache or load the icon and cache it first. If the value is not a URL-type string, then an ID lookup is
  * performed. The Id may be a unique icon ID or may include an iconSet ID prefix.
  *
  * For the **id** query to work properly, this means that all id-to-URL mappings must have been previously configured
  * using the `$mdIconProvider`.
  *
  * @returns {obj} Clone of the initial SVG DOM element; which was created from the SVG markup in the SVG data file.
  *
  * @usage
  * <hljs lang="js">
  * function SomeDirective($mdIcon) {
  *
  *   // See if the icon has already been loaded, if not
  *   // then lookup the icon from the registry cache, load and cache
  *   // it for future requests.
  *   // NOTE: ID queries require configuration with $mdIconProvider
  *
  *   $mdIcon('android').then(function(iconEl)    { element.append(iconEl); });
  *   $mdIcon('work:chair').then(function(iconEl) { element.append(iconEl); });
  *
  *   // Load and cache the external SVG using a URL
  *
  *   $mdIcon('img/icons/android.svg').then(function(iconEl) {
  *     element.append(iconEl);
  *   });
  * };
  * </hljs>
  *
  * NOTE: The `<md-icon />  ` directive internally uses the `$mdIcon` service to query, loaded, and instantiate
  * SVG DOM elements.
  */
 function MdIconService(config, $http, $q, $log, $templateCache) {
   var iconCache = {};
   var urlRegex = /[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/i;

   Icon.prototype = { clone : cloneSVG, prepare: prepareAndStyle };
   getIcon.fontSet = findRegisteredFontSet;

   // Publish service...
   return getIcon;

   /**
    * Actual $mdIcon service is essentially a lookup function
    */
   function getIcon(id) {
     id = id || '';

     // If already loaded and cached, use a clone of the cached icon.
     // Otherwise either load by URL, or lookup in the registry and then load by URL, and cache.

     if ( iconCache[id]         ) return $q.when( iconCache[id].clone() );
     if ( urlRegex.test(id)     ) return loadByURL(id).then( cacheIcon(id) );
     if ( id.indexOf(':') == -1 ) id = '$default:' + id;

     return loadByID(id)
         .catch(loadFromIconSet)
         .catch(announceIdNotFound)
         .catch(announceNotFound)
         .then( cacheIcon(id) );
   }

   /**
    * Lookup registered fontSet style using its alias...
    * If not found,
    */
   function findRegisteredFontSet(alias) {
      var useDefault = angular.isUndefined(alias) || !(alias && alias.length);
      if ( useDefault ) return config.defaultFontSet;

      var result = alias;
      angular.forEach(config.fontSets, function(it){
        if ( it.alias == alias ) result = it.fontSet || result;
      });

      return result;
   }

   /**
    * Prepare and cache the loaded icon for the specified `id`
    */
   function cacheIcon( id ) {

     return function updateCache( icon ) {
       iconCache[id] = isIcon(icon) ? icon : new Icon(icon, config[id]);

       return iconCache[id].clone();
     };
   }

   /**
    * Lookup the configuration in the registry, if !registered throw an error
    * otherwise load the icon [on-demand] using the registered URL.
    *
    */
   function loadByID(id) {
     var iconConfig = config[id];

     return !iconConfig ? $q.reject(id) : loadByURL(iconConfig.url).then(function(icon) {
       return new Icon(icon, iconConfig);
     });
   }

   /**
    *    Loads the file as XML and uses querySelector( <id> ) to find
    *    the desired node...
    */
   function loadFromIconSet(id) {
     var setName = id.substring(0, id.lastIndexOf(':')) || '$default';
     var iconSetConfig = config[setName];

     return !iconSetConfig ? $q.reject(id) : loadByURL(iconSetConfig.url).then(extractFromSet);

     function extractFromSet(set) {
       var iconName = id.slice(id.lastIndexOf(':') + 1);
       var icon = set.querySelector('#' + iconName);
       return !icon ? $q.reject(id) : new Icon(icon, iconSetConfig);
     }
   }

   /**
    * Load the icon by URL (may use the $templateCache).
    * Extract the data for later conversion to Icon
    */
   function loadByURL(url) {
     return $http
       .get(url, { cache: $templateCache })
       .then(function(response) {
         return angular.element('<div>').append(response.data).find('svg')[0];
       });
   }

   /**
    * User did not specify a URL and the ID has not been registered with the $mdIcon
    * registry
    */
   function announceIdNotFound(id) {
     var msg;

     if (angular.isString(id)) {
       msg = 'icon ' + id + ' not found';
       $log.warn(msg);
     }

     return $q.reject(msg || id);
   }

   /**
    * Catch HTTP or generic errors not related to incorrect icon IDs.
    */
   function announceNotFound(err) {
     var msg = angular.isString(err) ? err : (err.message || err.data || err.statusText);
     $log.warn(msg);

     return $q.reject(msg);
   }

   /**
    * Check target signature to see if it is an Icon instance.
    */
   function isIcon(target) {
     return angular.isDefined(target.element) && angular.isDefined(target.config);
   }

   /**
    *  Define the Icon class
    */
   function Icon(el, config) {
     if (el.tagName != 'svg') {
       el = angular.element('<svg xmlns="http://www.w3.org/2000/svg">').append(el)[0];
     }

     // Inject the namespace if not available...
     if ( !el.getAttribute('xmlns') ) {
       el.setAttribute('xmlns', "http://www.w3.org/2000/svg");
     }

     this.element = el;
     this.config = config;
     this.prepare();
   }

   /**
    *  Prepare the DOM element that will be cached in the
    *  loaded iconCache store.
    */
   function prepareAndStyle() {
     var viewBoxSize = this.config ? this.config.viewBoxSize : config.defaultViewBoxSize;
         angular.forEach({
           'fit'   : '',
           'height': '100%',
           'width' : '100%',
           'preserveAspectRatio': 'xMidYMid meet',
           'viewBox' : this.element.getAttribute('viewBox') || ('0 0 ' + viewBoxSize + ' ' + viewBoxSize)
         }, function(val, attr) {
           this.element.setAttribute(attr, val);
         }, this);

         angular.forEach({
           'pointer-events' : 'none',
           'display' : 'block'
         }, function(val, style) {
           this.element.style[style] = val;
         }, this);
   }

   /**
    * Clone the Icon DOM element.
    */
   function cloneSVG(){
     return this.element.cloneNode(true);
   }

 }

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.input
 */

angular.module('material.components.input', [
  'material.core'
])
  .directive('mdInputContainer', mdInputContainerDirective)
  .directive('label', labelDirective)
  .directive('input', inputTextareaDirective)
  .directive('textarea', inputTextareaDirective)
  .directive('mdMaxlength', mdMaxlengthDirective)
  .directive('placeholder', placeholderDirective);

/**
 * @ngdoc directive
 * @name mdInputContainer
 * @module material.components.input
 *
 * @restrict E
 *
 * @description
 * `<md-input-container>` is the parent of any input or textarea element.
 *
 * Input and textarea elements will not behave properly unless the md-input-container
 * parent is provided.
 *
 * @param md-is-error {expression=} When the given expression evaluates to true, the input container will go into error state. Defaults to erroring if the input has been touched and is invalid.
 * @param md-no-float {boolean=} When present, placeholders will not be converted to floating labels
 *
 * @usage
 * <hljs lang="html">
 *
 * <md-input-container>
 *   <label>Username</label>
 *   <input type="text" ng-model="user.name">
 * </md-input-container>
 *
 * <md-input-container>
 *   <label>Description</label>
 *   <textarea ng-model="user.description"></textarea>
 * </md-input-container>
 *
 * </hljs>
 */
function mdInputContainerDirective($mdTheming, $parse) {
  ContainerCtrl.$inject = ["$scope", "$element", "$attrs"];
  return {
    restrict: 'E',
    link: postLink,
    controller: ContainerCtrl
  };

  function postLink(scope, element, attr) {
    $mdTheming(element);
  }
  function ContainerCtrl($scope, $element, $attrs) {
    var self = this;

    self.isErrorGetter = $attrs.mdIsError && $parse($attrs.mdIsError);

    self.delegateClick = function() {
      self.input.focus();
    };
    self.element = $element;
    self.setFocused = function(isFocused) {
      $element.toggleClass('md-input-focused', !!isFocused);
    };
    self.setHasValue = function(hasValue) {
      $element.toggleClass('md-input-has-value', !!hasValue);
    };
    self.setInvalid = function(isInvalid) {
      $element.toggleClass('md-input-invalid', !!isInvalid);
    };
    $scope.$watch(function() {
      return self.label && self.input;
    }, function(hasLabelAndInput) {
      if (hasLabelAndInput && !self.label.attr('for')) {
        self.label.attr('for', self.input.attr('id'));
      }
    });
  }
}
mdInputContainerDirective.$inject = ["$mdTheming", "$parse"];

function labelDirective() {
  return {
    restrict: 'E',
    require: '^?mdInputContainer',
    link: function(scope, element, attr, containerCtrl) {
      if (!containerCtrl || attr.mdNoFloat) return;

      containerCtrl.label = element;
      scope.$on('$destroy', function() {
        containerCtrl.label = null;
      });
    }
  };
}

/**
 * @ngdoc directive
 * @name mdInput
 * @restrict E
 * @module material.components.input
 *
 * @description
 * Use the `<input>` or the  `<textarea>` as a child of an `<md-input-container>`.
 *
 * @param {number=} md-maxlength The maximum number of characters allowed in this input. If this is specified, a character counter will be shown underneath the input.<br/><br/>
 * The purpose of **`md-maxlength`** is exactly to show the max length counter text. If you don't want the counter text and only need "plain" validation, you can use the "simple" `ng-maxlength` or maxlength attributes.
 * @param {string=} aria-label Aria-label is required when no label is present.  A warning message will be logged in the console if not present.
 * @param {string=} placeholder An alternative approach to using aria-label when the label is not present.  The placeholder text is copied to the aria-label attribute.
 *
 * @usage
 * <hljs lang="html">
 * <md-input-container>
 *   <label>Color</label>
 *   <input type="text" ng-model="color" required md-maxlength="10">
 * </md-input-container>
 * </hljs>
 * <h3>With Errors</h3>
 *
 * <hljs lang="html">
 * <form name="userForm">
 *   <md-input-container>
 *     <label>Last Name</label>
 *     <input name="lastName" ng-model="lastName" required md-maxlength="10" minlength="4">
 *     <div ng-messages="userForm.lastName.$error" ng-show="userForm.lastName.$dirty">
 *       <div ng-message="required">This is required!</div>
 *       <div ng-message="md-maxlength">That's too long!</div>
 *       <div ng-message="minlength">That's too short!</div>
 *     </div>
 *   </md-input-container>
 *   <md-input-container>
 *     <label>Biography</label>
 *     <textarea name="bio" ng-model="biography" required md-maxlength="150"></textarea>
 *     <div ng-messages="userForm.bio.$error" ng-show="userForm.bio.$dirty">
 *       <div ng-message="required">This is required!</div>
 *       <div ng-message="md-maxlength">That's too long!</div>
 *     </div>
 *   </md-input-container>
 *   <md-input-container>
 *     <input aria-label='title' ng-model='title'>
 *   </md-input-container>
 *   <md-input-container>
 *     <input placeholder='title' ng-model='title'>
 *   </md-input-container>
 * </form>
 * </hljs>
 *
 * Requires [ngMessages](https://docs.angularjs.org/api/ngMessages).
 * Behaves like the [AngularJS input directive](https://docs.angularjs.org/api/ng/directive/input).
 *
 */

function inputTextareaDirective($mdUtil, $window, $mdAria) {
  return {
    restrict: 'E',
    require: ['^?mdInputContainer', '?ngModel'],
    link: postLink
  };

  function postLink(scope, element, attr, ctrls) {

    var containerCtrl = ctrls[0];
    var ngModelCtrl = ctrls[1] || $mdUtil.fakeNgModel();
    var isReadonly = angular.isDefined(attr.readonly);

    if ( !containerCtrl ) return;
    if (containerCtrl.input) {
      throw new Error("<md-input-container> can only have *one* <input> or <textarea> child element!");
    }
    containerCtrl.input = element;

    if(!containerCtrl.label) {
      $mdAria.expect(element, 'aria-label', element.attr('placeholder'));
    }

    element.addClass('md-input');
    if (!element.attr('id')) {
      element.attr('id', 'input_' + $mdUtil.nextUid());
    }

    if (element[0].tagName.toLowerCase() === 'textarea') {
      setupTextarea();
    }

    var isErrorGetter = containerCtrl.isErrorGetter || function() {
      return ngModelCtrl.$invalid && ngModelCtrl.$touched;
    };
    scope.$watch(isErrorGetter, containerCtrl.setInvalid);

    ngModelCtrl.$parsers.push(ngModelPipelineCheckValue);
    ngModelCtrl.$formatters.push(ngModelPipelineCheckValue);

    element.on('input', inputCheckValue);

    if (!isReadonly) {
      element
        .on('focus', function(ev) {
          containerCtrl.setFocused(true);
        })
        .on('blur', function(ev) {
          containerCtrl.setFocused(false);
          inputCheckValue();
        });

    }

    //ngModelCtrl.$setTouched();
    //if( ngModelCtrl.$invalid ) containerCtrl.setInvalid();

    scope.$on('$destroy', function() {
      containerCtrl.setFocused(false);
      containerCtrl.setHasValue(false);
      containerCtrl.input = null;
    });

    /**
     *
     */
    function ngModelPipelineCheckValue(arg) {
      containerCtrl.setHasValue(!ngModelCtrl.$isEmpty(arg));
      return arg;
    }
    function inputCheckValue() {
      // An input's value counts if its length > 0,
      // or if the input's validity state says it has bad input (eg string in a number input)
      containerCtrl.setHasValue(element.val().length > 0 || (element[0].validity||{}).badInput);
    }

    function setupTextarea() {
      var node = element[0];
      var onChangeTextarea = $mdUtil.debounce(growTextarea, 1);

      function pipelineListener(value) {
        onChangeTextarea();
        return value;
      }

      if (ngModelCtrl) {
        ngModelCtrl.$formatters.push(pipelineListener);
        ngModelCtrl.$viewChangeListeners.push(pipelineListener);
      } else {
        onChangeTextarea();
      }
      element.on('keydown input', onChangeTextarea);
      element.on('scroll', onScroll);
      angular.element($window).on('resize', onChangeTextarea);

      scope.$on('$destroy', function() {
        angular.element($window).off('resize', onChangeTextarea);
      });

      function growTextarea() {
        node.style.height = "auto";
        node.scrollTop = 0;
        var height = getHeight();
        if (height) node.style.height = height + 'px';
      }

      function getHeight () {
        var line = node.scrollHeight - node.offsetHeight;
        return node.offsetHeight + (line > 0 ? line : 0);
      }

      function onScroll(e) {
        node.scrollTop = 0;
        // for smooth new line adding
        var line = node.scrollHeight - node.offsetHeight;
        var height = node.offsetHeight + line;
        node.style.height = height + 'px';
      }
    }
  }
}
inputTextareaDirective.$inject = ["$mdUtil", "$window", "$mdAria"];

function mdMaxlengthDirective($animate) {
  return {
    restrict: 'A',
    require: ['ngModel', '^mdInputContainer'],
    link: postLink
  };

  function postLink(scope, element, attr, ctrls) {
    var maxlength;
    var ngModelCtrl = ctrls[0];
    var containerCtrl = ctrls[1];
    var charCountEl = angular.element('<div class="md-char-counter">');

    // Stop model from trimming. This makes it so whitespace
    // over the maxlength still counts as invalid.
    attr.$set('ngTrim', 'false');
    containerCtrl.element.append(charCountEl);

    ngModelCtrl.$formatters.push(renderCharCount);
    ngModelCtrl.$viewChangeListeners.push(renderCharCount);
    element.on('input keydown', function() {
      renderCharCount(); //make sure it's called with no args
    });

    scope.$watch(attr.mdMaxlength, function(value) {
      maxlength = value;
      if (angular.isNumber(value) && value > 0) {
        if (!charCountEl.parent().length) {
          $animate.enter(charCountEl, containerCtrl.element,
                         angular.element(containerCtrl.element[0].lastElementChild));
        }
        renderCharCount();
      } else {
        $animate.leave(charCountEl);
      }
    });

    ngModelCtrl.$validators['md-maxlength'] = function(modelValue, viewValue) {
      if (!angular.isNumber(maxlength) || maxlength < 0) {
        return true;
      }
      return ( modelValue || element.val() || viewValue || '' ).length <= maxlength;
    };

    function renderCharCount(value) {
      charCountEl.text( ( element.val() || value || '' ).length + '/' + maxlength );
      return value;
    }
  }
}
mdMaxlengthDirective.$inject = ["$animate"];

function placeholderDirective($log) {
  var blackListElements = ['MD-SELECT'];
  return {
    restrict: 'A',
    require: '^^?mdInputContainer',
    priority: 200,
    link: postLink
  };

  function postLink(scope, element, attr, inputContainer) {
    if (!inputContainer) return;
    if (blackListElements.indexOf(element[0].nodeName) != -1) return;
    if (angular.isDefined(inputContainer.element.attr('md-no-float'))) return;

    var placeholderText = attr.placeholder;
    element.removeAttr('placeholder');

    if ( inputContainer.element.find('label').length == 0 ) {
      var placeholder = '<label ng-click="delegateClick()">' + placeholderText + '</label>';

      inputContainer.element.addClass('md-icon-float');
      inputContainer.element.prepend(placeholder);
    } else {
      $log.warn("The placeholder='" + placeholderText + "' will be ignored since this md-input-container has a child label element.");
    }

  }
}
placeholderDirective.$inject = ["$log"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.list
 * @description
 * List module
 */
angular.module('material.components.list', [
  'material.core'
])
  .controller('MdListController', MdListController)
  .directive('mdList', mdListDirective)
  .directive('mdListItem', mdListItemDirective);

/**
 * @ngdoc directive
 * @name mdList
 * @module material.components.list
 *
 * @restrict E
 *
 * @description
 * The `<md-list>` directive is a list container for 1..n `<md-list-item>` tags.
 *
 * @usage
 * <hljs lang="html">
 * <md-list>
 *   <md-list-item class="md-2-line" ng-repeat="item in todos">
 *     <md-checkbox ng-model="item.done"></md-checkbox>
 *     <div class="md-list-item-text">
 *       <h3>{{item.title}}</h3>
 *       <p>{{item.description}}</p>
 *     </div>
 *   </md-list-item>
 * </md-list>
 * </hljs>
 */

function mdListDirective($mdTheming) {
  return {
    restrict: 'E',
    compile: function(tEl) {
      tEl[0].setAttribute('role', 'list');
      return $mdTheming;
    }
  };
}
mdListDirective.$inject = ["$mdTheming"];
/**
 * @ngdoc directive
 * @name mdListItem
 * @module material.components.list
 *
 * @restrict E
 *
 * @description
 * The `<md-list-item>` directive is a container intended for row items in a `<md-list>` container.
 *
 * @usage
 * <hljs lang="html">
 *  <md-list>
 *    <md-list-item>
 *            Item content in list
 *    </md-list-item>
 *  </md-list>
 * </hljs>
 *
 */
function mdListItemDirective($mdAria, $mdConstant, $timeout) {
  var proxiedTypes = ['md-checkbox', 'md-switch'];
  return {
    restrict: 'E',
    controller: 'MdListController',
    compile: function(tEl, tAttrs) {
      // Check for proxy controls (no ng-click on parent, and a control inside)
      var secondaryItem = tEl[0].querySelector('.md-secondary');
      var hasProxiedElement;
      var proxyElement;

      tEl[0].setAttribute('role', 'listitem');

      if (!tAttrs.ngClick) {
        for (var i = 0, type; type = proxiedTypes[i]; ++i) {
          if (proxyElement = tEl[0].querySelector(type)) {
            hasProxiedElement = true;
            break;
          }
        }
        if (hasProxiedElement) {
          wrapIn('div');
        } else if (!tEl[0].querySelector('md-button')) {
          tEl.addClass('md-no-proxy');
        }
      } else {
        wrapIn('button');
      }
      setupToggleAria();


      function setupToggleAria() {
        var toggleTypes = ['md-switch', 'md-checkbox'];
        var toggle;

        for (var i = 0, toggleType; toggleType = toggleTypes[i]; ++i) {
          if (toggle = tEl.find(toggleType)[0]) {
            if (!toggle.hasAttribute('aria-label')) {
              var p = tEl.find('p')[0];
              if (!p) return;
              toggle.setAttribute('aria-label', 'Toggle ' + p.textContent);
            }
          }
        }
      }

      function wrapIn(type) {
        var container;
        if (type == 'div') {
          container = angular.element('<div class="md-no-style md-list-item-inner">');
          container.append(tEl.contents());
          tEl.addClass('md-proxy-focus');
        } else {
          container = angular.element('<md-button class="md-no-style"><div class="md-list-item-inner"></div></md-button>');
          var copiedAttrs = ['ng-click', 'aria-label', 'ng-disabled'];
          angular.forEach(copiedAttrs, function(attr) {
            if (tEl[0].hasAttribute(attr)) {
              container[0].setAttribute(attr, tEl[0].getAttribute(attr));
              tEl[0].removeAttribute(attr);
            }
          });
          container.children().eq(0).append(tEl.contents());
        }

        tEl[0].setAttribute('tabindex', '-1');
        tEl.append(container);

        if (secondaryItem && secondaryItem.hasAttribute('ng-click')) {
          $mdAria.expect(secondaryItem, 'aria-label');
          var buttonWrapper = angular.element('<md-button class="md-secondary-container md-icon-button">');
          buttonWrapper.attr('ng-click', secondaryItem.getAttribute('ng-click'));
          secondaryItem.removeAttribute('ng-click');
          secondaryItem.setAttribute('tabindex', '-1');
          secondaryItem.classList.remove('md-secondary');
          buttonWrapper.append(secondaryItem);
          secondaryItem = buttonWrapper[0];
        }

        // Check for a secondary item and move it outside
        if ( secondaryItem && (
          secondaryItem.hasAttribute('ng-click') ||
            ( tAttrs.ngClick &&
             isProxiedElement(secondaryItem) )
        )) {
          tEl.addClass('md-with-secondary');
          tEl.append(secondaryItem);
        }
      }

      function isProxiedElement(el) {
        return proxiedTypes.indexOf(el.nodeName.toLowerCase()) != -1;
      }

      return postLink;

      function postLink($scope, $element, $attr, ctrl) {

        var proxies    = [],
            firstChild = $element[0].firstElementChild,
            hasClick   = firstChild && firstChild.hasAttribute('ng-click');

        computeProxies();
        computeClickable();

        if ($element.hasClass('md-proxy-focus') && proxies.length) {
          angular.forEach(proxies, function(proxy) {
            proxy = angular.element(proxy);

            $scope.mouseActive = false;
            proxy.on('mousedown', function() {
              $scope.mouseActive = true;
              $timeout(function(){
                $scope.mouseActive = false;
              }, 100);
            })
            .on('focus', function() {
              if ($scope.mouseActive === false) { $element.addClass('md-focused'); }
              proxy.on('blur', function proxyOnBlur() {
                $element.removeClass('md-focused');
                proxy.off('blur', proxyOnBlur);
              });
            });
          });
        }

        function computeProxies() {
          var children = $element.children();
          if (children.length && !children[0].hasAttribute('ng-click')) {
            angular.forEach(proxiedTypes, function(type) {
              angular.forEach(firstChild.querySelectorAll(type), function(child) {
                proxies.push(child);
              });
            });
          }
        }
        function computeClickable() {
          if (proxies.length || hasClick) {
            $element.addClass('md-clickable');

            ctrl.attachRipple($scope, angular.element($element[0].querySelector('.md-no-style')));
          }
        }

        if (!hasClick && !proxies.length) {
          firstChild && firstChild.addEventListener('keypress', function(e) {
            if (e.target.nodeName != 'INPUT' && e.target.nodeName != 'TEXTAREA') {
              var keyCode = e.which || e.keyCode;
              if (keyCode == $mdConstant.KEY_CODE.SPACE) {
                if (firstChild) {
                  firstChild.click();
                  e.preventDefault();
                  e.stopPropagation();
                }
              }
            }
          });
        }

        $element.off('click');
        $element.off('keypress');

        if (proxies.length && firstChild) {
          $element.children().eq(0).on('click', function(e) {
            if (firstChild.contains(e.target)) {
              angular.forEach(proxies, function(proxy) {
                if (e.target !== proxy && !proxy.contains(e.target)) {
                  angular.element(proxy).triggerHandler('click');
                }
              });
            }
          });
        }
      }
    }
  };
}
mdListItemDirective.$inject = ["$mdAria", "$mdConstant", "$timeout"];

/*
 * @private
 * @ngdoc controller
 * @name MdListController
 * @module material.components.list
 *
 */
function MdListController($scope, $element, $mdListInkRipple) {
  var ctrl = this;
  ctrl.attachRipple = attachRipple;

  function attachRipple (scope, element) {
    var options = {};
    $mdListInkRipple.attach(scope, element, options);
  }
}
MdListController.$inject = ["$scope", "$element", "$mdListInkRipple"];


})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.menu
 */

angular.module('material.components.menu', [
  'material.core',
  'material.components.backdrop'
])
.directive('mdMenu', MenuDirective)
.controller('mdMenuCtrl', MenuController);

/**
 * @ngdoc directive
 * @name mdMenu
 * @module material.components.menu
 * @restrict E
 * @description
 *
 * Menus are elements that open when clicked. They are useful for displaying
 * additional options within the context of an action.
 *
 * Every `md-menu` must specify exactly two child elements. The first element is what is
 * left in the DOM and is used to open the menu. This element is called the trigger element.
 * The trigger element's scope has access to `$mdOpenMenu($event)`
 * which it may call to open the menu. By passing $event as argument, the
 * corresponding event is stopped from propagating up the DOM-tree.
 *
 * The second element is the `md-menu-content` element which represents the
 * contents of the menu when it is open. Typically this will contain `md-menu-item`s,
 * but you can do custom content as well.
 *
 * <hljs lang="html">
 * <md-menu>
 *  <!-- Trigger element is a md-button with an icon -->
 *  <md-button ng-click="$mdOpenMenu($event)" class="md-icon-button" aria-label="Open sample menu">
 *    <md-icon md-svg-icon="call:phone"></md-icon>
 *  </md-button>
 *  <md-menu-content>
 *    <md-menu-item><md-button ng-click="doSomething()">Do Something</md-button></md-menu-item>
 *  </md-menu-content>
 * </md-menu>
 * </hljs>

 * ## Sizing Menus
 *
 * The width of the menu when it is open may be specified by specifying a `width`
 * attribute on the `md-menu-content` element.
 * See the [Material Design Spec](http://www.google.com/design/spec/components/menus.html#menus-specs)
 * for more information.
 *
 *
 * ## Aligning Menus
 *
 * When a menu opens, it is important that the content aligns with the trigger element.
 * Failure to align menus can result in jarring experiences for users as content
 * suddenly shifts. To help with this, `md-menu` provides serveral APIs to help
 * with alignment.
 *
 * ### Target Mode
 *
 * By default, `md-menu` will attempt to align the `md-menu-content` by aligning
 * designated child elements in both the trigger and the menu content.
 *
 * To specify the alignment element in the `trigger` you can use the `md-menu-origin`
 * attribute on a child element. If no `md-menu-origin` is specified, the `md-menu`
 * will be used as the origin element.
 *
 * Similarly, the `md-menu-content` may specify a `md-menu-align-target` for a
 * `md-menu-item` to specify the node that it should try and align with.
 *
 * In this example code, we specify an icon to be our origin element, and an
 * icon in our menu content to be our alignment target. This ensures that both
 * icons are aligned when the menu opens.
 *
 * <hljs lang="html">
 * <md-menu>
 *  <md-button ng-click="$mdOpenMenu($event)" class="md-icon-button" aria-label="Open some menu">
 *    <md-icon md-menu-origin md-svg-icon="call:phone"></md-icon>
 *  </md-button>
 *  <md-menu-content>
 *    <md-menu-item>
 *      <md-button ng-click="doSomething()" aria-label="Do something">
 *        <md-icon md-menu-align-target md-svg-icon="call:phone"></md-icon>
 *        Do Something
 *      </md-button>
 *    </md-menu-item>
 *  </md-menu-content>
 * </md-menu>
 * </hljs>
 *
 * Sometimes we want to specify alignment on the right side of an element, for example
 * if we have a menu on the right side a toolbar, we want to right align our menu content.
 *
 * We can specify the origin by using the `md-position-mode` attribute on both
 * the `x` and `y` axis. Right now only the `x-axis` has more than one option.
 * You may specify the default mode of `target target` or
 * `target-right target` to specify a right-oriented alignment target. See the
 * position section of the demos for more examples.
 *
 * ### Menu Offsets
 *
 * It is sometimes unavoidable to need to have a deeper level of control for
 * the positioning of a menu to ensure perfect alignment. `md-menu` provides
 * the `md-offset` attribute to allow pixel level specificty of adjusting the
 * exact positioning.
 *
 * This offset is provided in the format of `x y` or `n` where `n` will be used
 * in both the `x` and `y` axis.
 *
 * For example, to move a menu by `2px` from the top, we can use:
 * <hljs lang="html">
 * <md-menu md-offset="2 0">
 *   <!-- menu-content -->
 * </md-menu>
 * </hljs>
 *
 * @usage
 * <hljs lang="html">
 * <md-menu>
 *  <md-button ng-click="$mdOpenMenu($event)" class="md-icon-button">
 *    <md-icon md-svg-icon="call:phone"></md-icon>
 *  </md-button>
 *  <md-menu-content>
 *    <md-menu-item><md-button ng-click="doSomething()">Do Something</md-button></md-menu-item>
 *  </md-menu-content>
 * </md-menu>
 * </hljs>
 *
 * @param {string} md-position-mode The position mode in the form of
             `x`, `y`. Default value is `target`,`target`. Right now the `x` axis
             also suppports `target-right`.
 * @param {string} md-offset An offset to apply to the dropdown after positioning
             `x`, `y`. Default value is `0`,`0`.
 *
 */

function MenuDirective($mdMenu) {
  return {
    restrict: 'E',
    require: 'mdMenu',
    controller: 'mdMenuCtrl', // empty function to be built by link
    scope: true,
    compile: compile
  };

  function compile(templateElement) {
    templateElement.addClass('md-menu');
    var triggerElement = templateElement.children()[0];
    if (!triggerElement.hasAttribute('ng-click')) {
      triggerElement = triggerElement.querySelector('[ng-click]');
    }
    triggerElement && triggerElement.setAttribute('aria-haspopup', 'true');
    if (templateElement.children().length != 2) {
      throw Error('Invalid HTML for md-menu. Expected two children elements.');
    }
    return link;
  }

  function link(scope, element, attrs, mdMenuCtrl) {

    // Move everything into a md-menu-container and pass it to the controller
    var menuContainer = angular.element(
      '<div class="md-open-menu-container md-whiteframe-z2"></div>'
    );
    var menuContents = element.children()[1];
    menuContainer.append(menuContents);
    mdMenuCtrl.init(menuContainer);

    scope.$on('$destroy', function() {
      if (mdMenuCtrl.isOpen) {
        menuContainer.remove();
        mdMenuCtrl.close();
      }
    });

  }
}
MenuDirective.$inject = ["$mdMenu"];

function MenuController($mdMenu, $attrs, $element, $scope) {

  var menuContainer;
  var ctrl = this;
  var triggerElement;

  // Called by our linking fn to provide access to the menu-content
  // element removed during link
  this.init = function(setMenuContainer) {
    menuContainer = setMenuContainer;
    triggerElement = $element[0].querySelector('[ng-click]');
  };

  // Uses the $mdMenu interim element service to open the menu contents
  this.open = function openMenu(ev) {
    ev && ev.stopPropagation();

    ctrl.isOpen = true;
    triggerElement.setAttribute('aria-expanded', 'true');
    $mdMenu.show({
      mdMenuCtrl: ctrl,
      element: menuContainer,
      target: $element[0]
    });
  };
  // Expose a open function to the child scope for html to use
  $scope.$mdOpenMenu = this.open;

  // Use the $mdMenu interim element service to close the menu contents
  this.close = function closeMenu(skipFocus) {
    ctrl.isOpen = false;
    triggerElement.setAttribute('aria-expanded', 'false');
    $mdMenu.hide();

    if (!skipFocus) {
      $element.children()[0].focus();
    }
  };

  // Build a nice object out of our string attribute which specifies the
  // target mode for left and top positioning
  this.positionMode = function() {
    var attachment = ($attrs.mdPositionMode || 'target').split(' ');

    // If attachment is a single item, duplicate it for our second value.
    // ie. 'target' -> 'target target'
    if (attachment.length == 1) {
      attachment.push(attachment[0]);
    }

    return {
      left: attachment[0],
      top: attachment[1]
    };
  };

  // Build a nice object out of our string attribute which specifies
  // the offset of top and left in pixels.
  this.offsets = function() {
    var offsets = ($attrs.mdOffset || '0 0').split(' ').map(parseFloat);
    if (offsets.length == 2) {
      return {
        left: offsets[0],
        top: offsets[1]
      };
    } else if (offsets.length == 1) {
      return {
        top: offsets[0],
        left: offsets[0]
      };
    } else {
      throw Error('Invalid offsets specified. Please follow format <x, y> or <n>');
    }
  };
}
MenuController.$inject = ["$mdMenu", "$attrs", "$element", "$scope"];

})();
(function(){
"use strict";

angular.module('material.components.menu')
.provider('$mdMenu', MenuProvider);

/*
 * Interim element provider for the menu.
 * Handles behavior for a menu while it is open, including:
 *    - handling animating the menu opening/closing
 *    - handling key/mouse events on the menu element
 *    - handling enabling/disabling scroll while the menu is open
 *    - handling redrawing during resizes and orientation changes
 *
 */

function MenuProvider($$interimElementProvider) {
  var MENU_EDGE_MARGIN = 8;

  menuDefaultOptions.$inject = ["$$rAF", "$window", "$mdUtil", "$mdTheming", "$timeout", "$mdConstant", "$document"];
  return $$interimElementProvider('$mdMenu')
    .setDefaults({
      methods: ['target'],
      options: menuDefaultOptions
    });

  /* @ngInject */
  function menuDefaultOptions($$rAF, $window, $mdUtil, $mdTheming, $timeout, $mdConstant, $document) {
    return {
      parent: 'body',
      onShow: onShow,
      onRemove: onRemove,
      hasBackdrop: true,
      disableParentScroll: true,
      skipCompile: true,
      themable: true
    };

    /**
     * Boilerplate interimElement onShow function
     * Handles inserting the menu into the DOM, positioning it, and wiring up
     * various interaction events
     */
    function onShow(scope, element, opts) {

      // Sanitize and set defaults on opts
      buildOpts(opts);

      // Wire up theming on our menu element
      $mdTheming.inherit(opts.menuContentEl, opts.target);

      // Register various listeners to move menu on resize/orientation change
      handleResizing();

      // Disable scrolling
      if (opts.disableParentScroll) {
        opts.restoreScroll = $mdUtil.disableScrollAround(opts.element);
      }

      // Only activate click listeners after a short time to stop accidental double taps/clicks
      // from clicking the wrong item
      $timeout(activateInteraction, 75, false);

      if (opts.backdrop) {
        $mdTheming.inherit(opts.backdrop, opts.parent);
        opts.parent.append(opts.backdrop);
      }
      showMenu();

      // Return the promise for when our menu is done animating in
      return $mdUtil.transitionEndPromise(element, {timeout: 350});

      /** Check for valid opts and set some sane defaults */
      function buildOpts() {
        if (!opts.target) {
          throw Error(
            '$mdMenu.show() expected a target to animate from in options.target'
          );
        }
        angular.extend(opts, {
          alreadyOpen: false,
          isRemoved: false,
          target: angular.element(opts.target), //make sure it's not a naked dom node
          parent: angular.element(opts.parent),
          menuContentEl: angular.element(element[0].querySelector('md-menu-content')),
          backdrop: opts.hasBackdrop && angular.element('<md-backdrop class="md-menu-backdrop md-click-catcher">')
        });
      }

      /** Wireup various resize listeners for screen changes */
      function handleResizing() {
        opts.resizeFn = function() {
          positionMenu(element, opts);
        };
        angular.element($window).on('resize', opts.resizeFn);
        angular.element($window).on('orientationchange', opts.resizeFn);
      }

      /**
       * Place the menu into the DOM and call positioning related functions
       */
      function showMenu() {
        opts.parent.append(element);

        element.removeClass('md-leave');
        // Kick off our animation/positioning but first, wait a few frames
        // so all of our computed positions/sizes are accurate
        $$rAF(function() {
          $$rAF(function() {
            positionMenu(element, opts);
            // Wait a frame before fading in menu (md-active) so that we don't trigger
            // transitions on the menu position changing
            $$rAF(function() {
              element.addClass('md-active');
              opts.alreadyOpen = true;
              element[0].style[$mdConstant.CSS.TRANSFORM] = '';
            });
          });
        });
      }


      /**
       * Activate interaction on the menu. Wire up keyboard listerns for
       * clicks, keypresses, backdrop closing, etc.
       */
      function activateInteraction() {
        element.addClass('md-clickable');

        // close on backdrop click
        opts.backdrop && opts.backdrop.on('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          opts.mdMenuCtrl.close(true);
        });

        // Wire up keyboard listeners.
        // Close on escape, focus next item on down arrow, focus prev item on up
        opts.menuContentEl.on('keydown', function(ev) {
          scope.$apply(function() {
            switch (ev.keyCode) {
              case $mdConstant.KEY_CODE.ESCAPE: opts.mdMenuCtrl.close(); break;
              case $mdConstant.KEY_CODE.UP_ARROW: focusMenuItem(ev, opts.menuContentEl, opts, -1); break;
              case $mdConstant.KEY_CODE.DOWN_ARROW: focusMenuItem(ev, opts.menuContentEl, opts, 1); break;
            }
          });
        });

        // Close menu on menu item click, if said menu-item is not disabled
        opts.menuContentEl.on('click', function(e) {
          var target = e.target;
          // Traverse up the event until we get to the menuContentEl to see if
          // there is an ng-click and that the ng-click is not disabled
          do {
            if (target && target.hasAttribute('ng-click')) {
              if (!target.hasAttribute('disabled')) {
                close();
              }
              break;
            }
          } while ((target = target.parentNode) && target != opts.menuContentEl)

          function close() {
            scope.$apply(function() {
              opts.mdMenuCtrl.close();
            });
          }
        });

        // kick off initial focus in the menu on the first element
        var focusTarget = opts.menuContentEl[0].querySelector('[md-menu-focus-target]');
        if (!focusTarget) focusTarget = opts.menuContentEl[0].firstElementChild.firstElementChild;
        focusTarget.focus();
      }
    }

    /**
      * Takes a keypress event and focuses the next/previous menu
      * item from the emitting element
      * @param {event} e - The origin keypress event
      * @param {angular.element} menuEl - The menu element
      * @param {object} opts - The interim element options for the mdMenu
      * @param {number} direction - The direction to move in (+1 = next, -1 = prev)
      */
    function focusMenuItem(e, menuEl, opts, direction) {
      var currentItem = $mdUtil.getClosest(e.target, 'MD-MENU-ITEM');

      var items = $mdUtil.nodesToArray(menuEl[0].children);
      var currentIndex = items.indexOf(currentItem);

      // Traverse through our elements in the specified direction (+/-1) and try to
      // focus them until we find one that accepts focus
      for (var i = currentIndex + direction; i >= 0 && i < items.length; i = i + direction) {
        var focusTarget = items[i].firstElementChild || items[i];
        var didFocus = attemptFocus(focusTarget);
        if (didFocus) {
          break;
        }
      }
    }

    /**
     * Attempts to focus an element. Checks whether that element is the currently
     * focused element after attempting.
     * @param {HTMLElement} el - the element to attempt focus on
     * @returns {bool} - whether the element was successfully focused
     */
    function attemptFocus(el) {
      if (el && el.getAttribute('tabindex') != -1) {
        el.focus();
        if ($document[0].activeElement == el) {
          return true;
        } else {
          return false;
        }
      }
    }

    /**
     * Boilerplate interimElement onRemove function
     * Handles removing the menu from the DOM, cleaning up the element
     * and removing various listeners
     */
    function onRemove(scope, element, opts) {
      opts.isRemoved = true;
      element.addClass('md-leave')
        .removeClass('md-clickable');

      // Disable resizing handlers
      angular.element($window).off('resize', opts.resizeFn);
      angular.element($window).off('orientationchange', opts.resizeFn);
      opts.resizeFn = undefined;

      // Wait for animate out, then remove from the DOM
      return $mdUtil.transitionEndPromise(element, { timeout: 350 }).then(function() {
        element.removeClass('md-active');
        opts.backdrop && opts.backdrop.remove();
        if (element[0].parentNode === opts.parent[0]) {
          opts.parent[0].removeChild(element[0]);
        }
        opts.restoreScroll && opts.restoreScroll();
      });
    }

    /**
     * Computes menu position and sets the style on the menu container
     * @param {HTMLElement} el - the menu container element
     * @param {object} opts - the interim element options object
     */
    function positionMenu(el, opts) {
      if (opts.isRemoved) return;

      var containerNode = el[0],
          openMenuNode = el[0].firstElementChild,
          openMenuNodeRect = openMenuNode.getBoundingClientRect(),
          boundryNode = opts.parent[0],
          boundryNodeRect = boundryNode.getBoundingClientRect();

      var originNode = opts.target[0].querySelector('[md-menu-origin]') || opts.target[0],
          originNodeRect = originNode.getBoundingClientRect();


      var bounds = {
        left: boundryNodeRect.left + MENU_EDGE_MARGIN,
        top: boundryNodeRect.top + MENU_EDGE_MARGIN,
        bottom: boundryNodeRect.bottom - MENU_EDGE_MARGIN,
        right: boundryNodeRect.right - MENU_EDGE_MARGIN
      };


      var alignTarget, alignTargetRect, existingOffsets;
      var positionMode = opts.mdMenuCtrl.positionMode();

      if (positionMode.top == 'target' || positionMode.left == 'target' || positionMode.left == 'target-right') {
        // TODO: Allow centering on an arbitrary node, for now center on first menu-item's child
        alignTarget = openMenuNode.firstElementChild.firstElementChild || openMenuNode.firstElementChild;
        alignTarget = alignTarget.querySelector('[md-menu-align-target]') || alignTarget;
        alignTargetRect = alignTarget.getBoundingClientRect();

        existingOffsets = {
          top: parseFloat(containerNode.style.top || 0),
          left: parseFloat(containerNode.style.left || 0)
        };
      }

      var position = { };
      var transformOrigin = 'top ';

      switch (positionMode.top) {
        case 'target':
          position.top = existingOffsets.top + originNodeRect.top - alignTargetRect.top;
          break;
        // Future support for mdMenuBar
        // case 'top':
        //   position.top = originNodeRect.top;
        //   break;
        // case 'bottom':
        //   position.top = originNodeRect.top + originNodeRect.height;
        //   break;
        default:
          throw new Error('Invalid target mode "' + positionMode.top + '" specified for md-menu on Y axis.');
      }

      switch (positionMode.left) {
        case 'target':
          position.left = existingOffsets.left + originNodeRect.left - alignTargetRect.left;
          transformOrigin += 'left';
          break;
        case 'target-right':
          position.left = originNodeRect.right - openMenuNodeRect.width + (openMenuNodeRect.right - alignTargetRect.right);
          transformOrigin += 'right';
          break;
        // Future support for mdMenuBar
        // case 'left':
        //   position.left = originNodeRect.left;
        //   transformOrigin += 'left';
        //   break;
        // case 'right':
        //   position.left = originNodeRect.right - containerNode.offsetWidth;
        //   transformOrigin += 'right';
        //   break;
        default:
          throw new Error('Invalid target mode "' + positionMode.left + '" specified for md-menu on X axis.');
      }

      var offsets = opts.mdMenuCtrl.offsets();
      position.top += offsets.top;
      position.left += offsets.left;

      clamp(position);

      el.css({
        top: position.top + 'px',
        left: position.left + 'px'
      });

      containerNode.style[$mdConstant.CSS.TRANSFORM_ORIGIN] = transformOrigin;

      // Animate a scale out if we aren't just repositioning
      if (!opts.alreadyOpen) {
        containerNode.style[$mdConstant.CSS.TRANSFORM] = 'scale(' +
          Math.min(originNodeRect.width / containerNode.offsetWidth, 1.0) + ',' +
          Math.min(originNodeRect.height / containerNode.offsetHeight, 1.0) +
        ')';
      }

      /**
       * Clamps the repositioning of the menu within the confines of
       * bounding element (often the screen/body)
       */
      function clamp(pos) {
        pos.top = Math.max(Math.min(pos.top, bounds.bottom - containerNode.offsetHeight), bounds.top);
        pos.left = Math.max(Math.min(pos.left, bounds.right - containerNode.offsetWidth), bounds.left);
      }
    }
  }
}
MenuProvider.$inject = ["$$interimElementProvider"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.progressCircular
 * @description Circular Progress module!
 */
angular.module('material.components.progressCircular', [
  'material.core'
])
  .directive('mdProgressCircular', MdProgressCircularDirective);

/**
 * @ngdoc directive
 * @name mdProgressCircular
 * @module material.components.progressCircular
 * @restrict E
 *
* @description
 * The circular progress directive is used to make loading content in your app as delightful and
 * painless as possible by minimizing the amount of visual change a user sees before they can view
 * and interact with content.
 *
 * For operations where the percentage of the operation completed can be determined, use a
 * determinate indicator. They give users a quick sense of how long an operation will take.
 *
 * For operations where the user is asked to wait a moment while something finishes up, and it’s
 * not necessary to expose what's happening behind the scenes and how long it will take, use an
 * indeterminate indicator.
 *
 * @param {string} md-mode Select from one of two modes: determinate and indeterminate.
 * @param {number=} value In determinate mode, this number represents the percentage of the
 *     circular progress. Default: 0
 * @param {number=} md-diameter This specifies the diamter of the circular progress. Default: 48
 *
 * @usage
 * <hljs lang="html">
 * <md-progress-circular md-mode="determinate" value="..."></md-progress-circular>
 *
 * <md-progress-circular md-mode="determinate" ng-value="..."></md-progress-circular>
 *
 * <md-progress-circular md-mode="determinate" value="..." md-diameter="100"></md-progress-circular>
 *
 * <md-progress-circular md-mode="indeterminate"></md-progress-circular>
 * </hljs>
 */
function MdProgressCircularDirective($mdConstant, $mdTheming) {
  return {
    restrict: 'E',
    template:
        // The progress 'circle' is composed of two half-circles: the left side and the right
        // side. Each side has CSS applied to 'fill-in' the half-circle to the appropriate progress.
        '<div class="md-spinner-wrapper">' +
          '<div class="md-inner">' +
            '<div class="md-gap"></div>' +
            '<div class="md-left">' +
              '<div class="md-half-circle"></div>' +
            '</div>' +
            '<div class="md-right">' +
              '<div class="md-half-circle"></div>' +
            '</div>' +
          '</div>' +
        '</div>',
    compile: compile
  };

  function compile(tElement) {
    // The javascript in this file is mainly responsible for setting the correct aria attributes.
    // The animation of the progress spinner is done entirely with just CSS.
    tElement.attr('aria-valuemin', 0);
    tElement.attr('aria-valuemax', 100);
    tElement.attr('role', 'progressbar');

    return postLink;
  }

  function postLink(scope, element, attr) {
    $mdTheming(element);
    var circle = element[0];

    // Scale the progress circle based on the default diameter.
    var diameter = attr.mdDiameter || 48;
    var scale = diameter / 48;
    circle.style[$mdConstant.CSS.TRANSFORM] = 'scale(' + scale + ')';

    attr.$observe('value', function(value) {
      var percentValue = clamp(value);
      element.attr('aria-valuenow', percentValue);
    });
  }

  /**
   * Clamps the value to be between 0 and 100.
   * @param {number} value The value to clamp.
   * @returns {number}
   */
  function clamp(value) {
    return Math.max(0, Math.min(value || 0, 100));
  }
}
MdProgressCircularDirective.$inject = ["$mdConstant", "$mdTheming"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.progressLinear
 * @description Linear Progress module!
 */
angular.module('material.components.progressLinear', [
  'material.core'
])
  .directive('mdProgressLinear', MdProgressLinearDirective);

/**
 * @ngdoc directive
 * @name mdProgressLinear
 * @module material.components.progressLinear
 * @restrict E
 *
 * @description
 * The linear progress directive is used to make loading content in your app as delightful and painless as possible by minimizing the amount of visual change a user sees before they can view and interact with content. Each operation should only be represented by one activity indicator—for example, one refresh operation should not display both a refresh bar and an activity circle.
 *
 * For operations where the percentage of the operation completed can be determined, use a determinate indicator. They give users a quick sense of how long an operation will take.
 *
 * For operations where the user is asked to wait a moment while something finishes up, and it’s not necessary to expose what's happening behind the scenes and how long it will take, use an indeterminate indicator.
 *
 * @param {string} md-mode Select from one of four modes: determinate, indeterminate, buffer or query.
 * @param {number=} value In determinate and buffer modes, this number represents the percentage of the primary progress bar. Default: 0
 * @param {number=} md-buffer-value In the buffer mode, this number represents the precentage of the secondary progress bar. Default: 0
 *
 * @usage
 * <hljs lang="html">
 * <md-progress-linear md-mode="determinate" value="..."></md-progress-linear>
 *
 * <md-progress-linear md-mode="determinate" ng-value="..."></md-progress-linear>
 *
 * <md-progress-linear md-mode="indeterminate"></md-progress-linear>
 *
 * <md-progress-linear md-mode="buffer" value="..." md-buffer-value="..."></md-progress-linear>
 *
 * <md-progress-linear md-mode="query"></md-progress-linear>
 * </hljs>
 */
function MdProgressLinearDirective($$rAF, $mdConstant, $mdTheming) {

  return {
    restrict: 'E',
    template: '<div class="md-container">' +
      '<div class="md-dashed"></div>' +
      '<div class="md-bar md-bar1"></div>' +
      '<div class="md-bar md-bar2"></div>' +
      '</div>',
    compile: compile
  };
  
  function compile(tElement, tAttrs, transclude) {
    tElement.attr('aria-valuemin', 0);
    tElement.attr('aria-valuemax', 100);
    tElement.attr('role', 'progressbar');

    return postLink;
  }
  function postLink(scope, element, attr) {
    $mdTheming(element);
    var bar1Style = element[0].querySelector('.md-bar1').style,
      bar2Style = element[0].querySelector('.md-bar2').style,
      container = angular.element(element[0].querySelector('.md-container'));

    attr.$observe('value', function(value) {
      if (attr.mdMode == 'query') {
        return;
      }

      var clamped = clamp(value);
      element.attr('aria-valuenow', clamped);
      bar2Style[$mdConstant.CSS.TRANSFORM] = transforms[clamped];
    });

    attr.$observe('mdBufferValue', function(value) {
      bar1Style[$mdConstant.CSS.TRANSFORM] = transforms[clamp(value)];
    });

    $$rAF(function() {
      container.addClass('md-ready');
    });
  }

  function clamp(value) {
    if (value > 100) {
      return 100;
    }

    if (value < 0) {
      return 0;
    }

    return Math.ceil(value || 0);
  }
}
MdProgressLinearDirective.$inject = ["$$rAF", "$mdConstant", "$mdTheming"];


// **********************************************************
// Private Methods
// **********************************************************
var transforms = (function() {
  var values = new Array(101);
  for(var i = 0; i < 101; i++){
    values[i] = makeTransform(i);
  }

  return values;

  function makeTransform(value){
    var scale = value/100;
    var translateX = (value-100)/2;
    return 'translateX(' + translateX.toString() + '%) scale(' + scale.toString() + ', 1)';
  }
})();

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.radioButton
 * @description radioButton module!
 */
angular.module('material.components.radioButton', [
  'material.core'
])
  .directive('mdRadioGroup', mdRadioGroupDirective)
  .directive('mdRadioButton', mdRadioButtonDirective);

/**
 * @ngdoc directive
 * @module material.components.radioButton
 * @name mdRadioGroup
 *
 * @restrict E
 *
 * @description
 * The `<md-radio-group>` directive identifies a grouping
 * container for the 1..n grouped radio buttons; specified using nested
 * `<md-radio-button>` tags.
 *
 * As per the [material design spec](http://www.google.com/design/spec/style/color.html#color-ui-color-application)
 * the radio button is in the accent color by default. The primary color palette may be used with
 * the `md-primary` class.
 *
 * Note: `<md-radio-group>` and `<md-radio-button>` handle tabindex differently
 * than the native `<input type='radio'>` controls. Whereas the native controls
 * force the user to tab through all the radio buttons, `<md-radio-group>`
 * is focusable, and by default the `<md-radio-button>`s are not.
 *
 * @param {string} ng-model Assignable angular expression to data-bind to.
 * @param {boolean=} md-no-ink Use of attribute indicates flag to disable ink ripple effects.
 *
 * @usage
 * <hljs lang="html">
 * <md-radio-group ng-model="selected">
 *
 *   <md-radio-button
 *        ng-repeat="d in colorOptions"
 *        ng-value="d.value" aria-label="{{ d.label }}">
 *
 *          {{ d.label }}
 *
 *   </md-radio-button>
 *
 * </md-radio-group>
 * </hljs>
 *
 */
function mdRadioGroupDirective($mdUtil, $mdConstant, $mdTheming, $timeout) {
  RadioGroupController.prototype = createRadioGroupControllerProto();

  return {
    restrict: 'E',
    controller: ['$element', RadioGroupController],
    require: ['mdRadioGroup', '?ngModel'],
    link: { pre: linkRadioGroup }
  };

  function linkRadioGroup(scope, element, attr, ctrls) {
    $mdTheming(element);
    var rgCtrl = ctrls[0];
    var ngModelCtrl = ctrls[1] || $mdUtil.fakeNgModel();

    function setFocus() {
      if (!element.hasClass('md-focused')) { element.addClass('md-focused'); }
    }

    function keydownListener(ev) {
      var keyCode = ev.which || ev.keyCode;
      switch(keyCode) {
        case $mdConstant.KEY_CODE.LEFT_ARROW:
        case $mdConstant.KEY_CODE.UP_ARROW:
          ev.preventDefault();
          rgCtrl.selectPrevious();
          setFocus();
          break;

        case $mdConstant.KEY_CODE.RIGHT_ARROW:
        case $mdConstant.KEY_CODE.DOWN_ARROW:
          ev.preventDefault();
          rgCtrl.selectNext();
          setFocus();
          break;

        case $mdConstant.KEY_CODE.ENTER:
          var form = angular.element($mdUtil.getClosest(element[0], 'form'));
          if (form.length > 0) {
            form.triggerHandler('submit');
          }
          break;
      }
    }

    rgCtrl.init(ngModelCtrl);

    scope.mouseActive = false;
    element.attr({
              'role': 'radiogroup',
              'tabIndex': element.attr('tabindex') || '0'
            })
            .on('keydown', keydownListener)
            .on('mousedown', function(event) {
              scope.mouseActive = true;
              $timeout(function() {
                scope.mouseActive = false;
              }, 100);
            })
            .on('focus', function() {
              if(scope.mouseActive === false) { rgCtrl.$element.addClass('md-focused'); }
            })
            .on('blur', function() { rgCtrl.$element.removeClass('md-focused'); });
  }

  function RadioGroupController($element) {
    this._radioButtonRenderFns = [];
    this.$element = $element;
  }

  function createRadioGroupControllerProto() {
    return {
      init: function(ngModelCtrl) {
        this._ngModelCtrl = ngModelCtrl;
        this._ngModelCtrl.$render = angular.bind(this, this.render);
      },
      add: function(rbRender) {
        this._radioButtonRenderFns.push(rbRender);
      },
      remove: function(rbRender) {
        var index = this._radioButtonRenderFns.indexOf(rbRender);
        if (index !== -1) {
          this._radioButtonRenderFns.splice(index, 1);
        }
      },
      render: function() {
        this._radioButtonRenderFns.forEach(function(rbRender) {
          rbRender();
        });
      },
      setViewValue: function(value, eventType) {
        this._ngModelCtrl.$setViewValue(value, eventType);
        // update the other radio buttons as well
        this.render();
      },
      getViewValue: function() {
        return this._ngModelCtrl.$viewValue;
      },
      selectNext: function() {
        return changeSelectedButton(this.$element, 1);
      },
      selectPrevious: function() {
        return changeSelectedButton(this.$element, -1);
      },
      setActiveDescendant: function (radioId) {
        this.$element.attr('aria-activedescendant', radioId);
      }
    };
  }
  /**
   * Change the radio group's selected button by a given increment.
   * If no button is selected, select the first button.
   */
  function changeSelectedButton(parent, increment) {
    // Coerce all child radio buttons into an array, then wrap then in an iterator
    var buttons = $mdUtil.iterator(parent[0].querySelectorAll('md-radio-button'), true);

    if (buttons.count()) {
      var validate = function (button) {
        // If disabled, then NOT valid
        return !angular.element(button).attr("disabled");
      };
      var selected = parent[0].querySelector('md-radio-button.md-checked');
      var target = buttons[increment < 0 ? 'previous' : 'next'](selected, validate) || buttons.first();
      // Activate radioButton's click listener (triggerHandler won't create a real click event)
      angular.element(target).triggerHandler('click');


    }
  }

}
mdRadioGroupDirective.$inject = ["$mdUtil", "$mdConstant", "$mdTheming", "$timeout"];

/**
 * @ngdoc directive
 * @module material.components.radioButton
 * @name mdRadioButton
 *
 * @restrict E
 *
 * @description
 * The `<md-radio-button>`directive is the child directive required to be used within `<md-radio-group>` elements.
 *
 * While similar to the `<input type="radio" ng-model="" value="">` directive,
 * the `<md-radio-button>` directive provides ink effects, ARIA support, and
 * supports use within named radio groups.
 *
 * @param {string} ngModel Assignable angular expression to data-bind to.
 * @param {string=} ngChange Angular expression to be executed when input changes due to user
 *    interaction with the input element.
 * @param {string} ngValue Angular expression which sets the value to which the expression should
 *    be set when selected.*
 * @param {string} value The value to which the expression should be set when selected.
 * @param {string=} name Property name of the form under which the control is published.
 * @param {string=} aria-label Adds label to radio button for accessibility.
 * Defaults to radio button's text. If no text content is available, a warning will be logged.
 *
 * @usage
 * <hljs lang="html">
 *
 * <md-radio-button value="1" aria-label="Label 1">
 *   Label 1
 * </md-radio-button>
 *
 * <md-radio-button ng-model="color" ng-value="specialValue" aria-label="Green">
 *   Green
 * </md-radio-button>
 *
 * </hljs>
 *
 */
function mdRadioButtonDirective($mdAria, $mdUtil, $mdTheming) {

  var CHECKED_CSS = 'md-checked';

  return {
    restrict: 'E',
    require: '^mdRadioGroup',
    transclude: true,
    template: '<div class="md-container" md-ink-ripple md-ink-ripple-checkbox>' +
                '<div class="md-off"></div>' +
                '<div class="md-on"></div>' +
              '</div>' +
              '<div ng-transclude class="md-label"></div>',
    link: link
  };

  function link(scope, element, attr, rgCtrl) {
    var lastChecked;

    $mdTheming(element);
    configureAria(element, scope);

    rgCtrl.add(render);
    attr.$observe('value', render);

    element
      .on('click', listener)
      .on('$destroy', function() {
        rgCtrl.remove(render);
      });

    function listener(ev) {
      if (element[0].hasAttribute('disabled')) return;

      scope.$apply(function() {
        rgCtrl.setViewValue(attr.value, ev && ev.type);
      });
    }

    function render() {
      var checked = (rgCtrl.getViewValue() == attr.value);
      if (checked === lastChecked) {
        return;
      }
      lastChecked = checked;
      element.attr('aria-checked', checked);
      if (checked) {
        element.addClass(CHECKED_CSS);
        rgCtrl.setActiveDescendant(element.attr('id'));
      } else {
        element.removeClass(CHECKED_CSS);
      }
    }
    /**
     * Inject ARIA-specific attributes appropriate for each radio button
     */
    function configureAria( element, scope ){
      scope.ariaId = buildAriaID();

      element.attr({
        'id' :  scope.ariaId,
        'role' : 'radio',
        'aria-checked' : 'false'
      });

      $mdAria.expectWithText(element, 'aria-label');

      /**
       * Build a unique ID for each radio button that will be used with aria-activedescendant.
       * Preserve existing ID if already specified.
       * @returns {*|string}
       */
      function buildAriaID() {
        return attr.id || ( 'radio' + "_" + $mdUtil.nextUid() );
      }
    }
  }
}
mdRadioButtonDirective.$inject = ["$mdAria", "$mdUtil", "$mdTheming"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.select
 */

/***************************************************

### TODO ###
**DOCUMENTATION AND DEMOS**

- [ ] ng-model with child mdOptions (basic)
- [ ] ng-model="foo" ng-model-options="{ trackBy: '$value.id' }" for objects
- [ ] mdOption with value
- [ ] Usage with input inside

### TODO - POST RC1 ###
- [ ] Abstract placement logic in $mdSelect service to $mdMenu service

***************************************************/

var SELECT_EDGE_MARGIN = 8;
var selectNextId = 0;

angular.module('material.components.select', [
  'material.core',
  'material.components.backdrop'
])
.directive('mdSelect', SelectDirective)
.directive('mdSelectMenu', SelectMenuDirective)
.directive('mdOption', OptionDirective)
.directive('mdOptgroup', OptgroupDirective)
.provider('$mdSelect', SelectProvider);


/**
 * @ngdoc directive
 * @name mdSelect
 * @restrict E
 * @module material.components.select
 *
 * @description Displays a select box, bound to an ng-model.
 *
 * @param {expression} ng-model The model!
 * @param {expression=} md-on-close expression to be evaluated when the select is closed
 * @param {boolean=} multiple Whether it's multiple.
 * @param {string=} placeholder Placeholder hint text.
 * @param {string=} aria-label Optional label for accessibility. Only necessary if no placeholder or
 * explicit label is present.
 *
 * @usage
 * With a placeholder (label and aria-label are added dynamically)
 * <hljs lang="html">
 *   <md-select
 *     ng-model="someModel"
 *     placeholder="Select a state">
 *     <md-option ng-value="opt" ng-repeat="opt in neighborhoods2">{{ opt }}</md-option>
 *   </md-select>
 * </hljs>
 *
 * With an explicit label
 * <hljs lang="html">
 *   <md-select
 *     ng-model="someModel">
 *     <md-select-label>Select a state</md-select-label>
 *     <md-option ng-value="opt" ng-repeat="opt in neighborhoods2">{{ opt }}</md-option>
 *   </md-select>
 * </hljs>
 */
function SelectDirective($mdSelect, $mdUtil, $mdTheming, $mdAria, $interpolate, $compile, $parse) {
  return {
    restrict: 'E',
    require: ['mdSelect', 'ngModel', '?^form'],
    compile: compile,
    controller: function() { } // empty placeholder controller to be initialized in link
  };

  function compile(element, attr) {
    // The user is allowed to provide a label for the select as md-select-label child
    var labelEl = element.find('md-select-label').remove();

    // If not provided, we automatically make one
    if (!labelEl.length) {
      labelEl = angular.element('<md-select-label><span></span></md-select-label>');
    } else {
      if (!labelEl[0].firstElementChild) {
        var spanWrapper = angular.element('<span>');
        spanWrapper.append(labelEl.contents());
        labelEl.append(spanWrapper);
      }
    }
    labelEl.append('<span class="md-select-icon" aria-hidden="true"></span>');
    labelEl.addClass('md-select-label');
    if (!labelEl[0].hasAttribute('id')) {
      labelEl.attr('id', 'select_label_' + $mdUtil.nextUid());
    }

    // There's got to be an md-content inside. If there's not one, let's add it.
    if (!element.find('md-content').length) {
      element.append( angular.element('<md-content>').append(element.contents()) );
    }

    // Add progress spinner for md-options-loading
    if (attr.mdOnOpen) {
      element.find('md-content').prepend(
        angular.element('<md-progress-circular>')
               .attr('md-mode', 'indeterminate')
               .attr('ng-hide', '$$loadingAsyncDone')
               .wrap('<div>')
               .parent()
      );
    }

    if (attr.name) {
      var autofillClone = angular.element('<select class="md-visually-hidden">');
      autofillClone.attr({
        'name': '.' + attr.name,
        'ng-model': attr.ngModel,
        'aria-hidden': 'true',
        'tabindex': '-1'
      });
      var opts = element.find('md-option');
      angular.forEach(opts, function(el) {
        var newEl = angular.element('<option>' + el.innerHTML + '</option>');
        if (el.hasAttribute('ng-value')) newEl.attr('ng-value', el.getAttribute('ng-value'));
        else if (el.hasAttribute('value')) newEl.attr('value', el.getAttribute('value'));
        autofillClone.append(newEl);
      });

      element.parent().append(autofillClone);
    }

    // Use everything that's left inside element.contents() as the contents of the menu
    var selectTemplate = '<div class="md-select-menu-container">' +
        '<md-select-menu ' +
        (angular.isDefined(attr.multiple) ? 'multiple' : '') + '>' +
          element.html() +
        '</md-select-menu></div>';

    element.empty().append(labelEl);

    attr.tabindex = attr.tabindex || '0';

    return function postLink(scope, element, attr, ctrls) {
      var isOpen;
      var isDisabled;

      var mdSelectCtrl = ctrls[0];
      var ngModel = ctrls[1];
      var formCtrl = ctrls[2];

      var labelEl = element.find('md-select-label');
      var customLabel = labelEl.text().length !== 0;
      var selectContainer, selectScope, selectMenuCtrl;
      createSelect();

      $mdTheming(element);

      if (attr.name && formCtrl) {
        var selectEl = element.parent()[0].querySelector('select[name=".' + attr.name + '"]');
        formCtrl.$removeControl(angular.element(selectEl).controller());
      }

      var originalRender = ngModel.$render;
      ngModel.$render = function() {
        originalRender();
        syncLabelText();
      };

      mdSelectCtrl.setLabelText = function(text) {
        if (customLabel) return; // Assume that user is handling it on their own
        mdSelectCtrl.setIsPlaceholder(!text);
        text = text || attr.placeholder || '';
        var target = customLabel ? labelEl : labelEl.children().eq(0);
        target.text(text);
      };

      mdSelectCtrl.setIsPlaceholder = function(val) {
        val ? labelEl.addClass('md-placeholder') : labelEl.removeClass('md-placeholder');
      };

      mdSelectCtrl.triggerClose = function() {
        $parse(attr.mdOnClose)(scope);
      };

      scope.$$postDigest(function() {
        setAriaLabel();
        syncLabelText();
      });

      function setAriaLabel() {
        var labelText = element.attr('placeholder');
        if (!labelText) {
          labelText = element.find('md-select-label').text();
        }
        $mdAria.expect(element, 'aria-label', labelText);
      }

      function syncLabelText() {
        if (selectContainer) {
          selectMenuCtrl = selectMenuCtrl || selectContainer.find('md-select-menu').controller('mdSelectMenu');
          mdSelectCtrl.setLabelText(selectMenuCtrl.selectedLabels());
        }
      }

      var deregisterWatcher;
      attr.$observe('ngMultiple', function(val) {
        if (deregisterWatcher) deregisterWatcher();
        var parser = $parse(val);
        deregisterWatcher = scope.$watch(function() { return parser(scope); }, function(multiple, prevVal) {
          if (multiple === undefined && prevVal === undefined) return; // assume compiler did a good job
          if (multiple) {
            element.attr('multiple', 'multiple');
          } else {
            element.removeAttr('multiple');
          }
          if (selectContainer) {
            selectMenuCtrl.setMultiple(multiple);
            originalRender = ngModel.$render;
            ngModel.$render = function() {
              originalRender();
              syncLabelText();
            };
            selectMenuCtrl.refreshViewValue();
            ngModel.$render();
          }
        });
      });

      attr.$observe('disabled', function(disabled) {
        if (typeof disabled == "string") {
          disabled = true;
        }
        // Prevent click event being registered twice
        if (isDisabled !== undefined && isDisabled === disabled) {
          return;
        }
        isDisabled = disabled;
        if (disabled) {
          element.attr({'tabindex': -1, 'aria-disabled': 'true'});
          element.off('click', openSelect);
          element.off('keydown', handleKeypress);
        } else {
          element.attr({'tabindex': attr.tabindex, 'aria-disabled': 'false'});
          element.on('click', openSelect);
          element.on('keydown', handleKeypress);
        }
      });

      if (!attr.disabled && !attr.ngDisabled) {
        element.attr({'tabindex': attr.tabindex, 'aria-disabled': 'false'});
        element.on('click', openSelect);
        element.on('keydown', handleKeypress);
      }

      var ariaAttrs = {
        role: 'combobox',
        'aria-expanded': 'false'
      };
      if (!element[0].hasAttribute('id')) {
        ariaAttrs.id = 'select_' + $mdUtil.nextUid();
      }
      element.attr(ariaAttrs);

      scope.$on('$destroy', function() {
        if (isOpen) {
          $mdSelect.cancel().then(function() {
            selectContainer.remove();
          });
        } else {
          selectContainer.remove();
        }
      });


      // Create a fake select to find out the label value
      function createSelect() {
        selectContainer = angular.element(selectTemplate);
        var selectEl = selectContainer.find('md-select-menu');
        selectEl.data('$ngModelController', ngModel);
        selectEl.data('$mdSelectController', mdSelectCtrl);
        selectScope = scope.$new();
        selectContainer = $compile(selectContainer)(selectScope);
        selectMenuCtrl = selectContainer.find('md-select-menu').controller('mdSelectMenu');
      }

      function handleKeypress(e) {
        var allowedCodes = [32, 13, 38, 40];
        if (allowedCodes.indexOf(e.keyCode) != -1 ) {
          // prevent page scrolling on interaction
          e.preventDefault();
          openSelect(e);
        } else {
          if (e.keyCode <= 90 && e.keyCode >= 31) {
            e.preventDefault();
            var node = selectMenuCtrl.optNodeForKeyboardSearch(e);
            if (!node) return;
            var optionCtrl = angular.element(node).controller('mdOption');
            if (!selectMenuCtrl.isMultiple) {
              selectMenuCtrl.deselect( Object.keys(selectMenuCtrl.selected)[0] );
            }
            selectMenuCtrl.select(optionCtrl.hashKey, optionCtrl.value);
            selectMenuCtrl.refreshViewValue();
            ngModel.$render();
          }
        }
      }

      function openSelect() {
        scope.$evalAsync(function() {
          isOpen = true;
          $mdSelect.show({
            scope: selectScope,
            preserveScope: true,
            skipCompile: true,
            element: selectContainer,
            target: element[0],
            hasBackdrop: true,
            loadingAsync: attr.mdOnOpen ? scope.$eval(attr.mdOnOpen) || true : false,
          }).then(function(selectedText) {
            isOpen = false;
          });
        });
      }
    };
  }
}
SelectDirective.$inject = ["$mdSelect", "$mdUtil", "$mdTheming", "$mdAria", "$interpolate", "$compile", "$parse"];

function SelectMenuDirective($parse, $mdUtil, $mdTheming) {

  SelectMenuController.$inject = ["$scope", "$attrs", "$element"];
  return {
    restrict: 'E',
    require: ['mdSelectMenu', '?ngModel'],
    controller: SelectMenuController,
    link: { pre: preLink }
  };

  // We use preLink instead of postLink to ensure that the select is initialized before
  // its child options run postLink.
  function preLink(scope, element, attr, ctrls) {
    var selectCtrl = ctrls[0];
    var ngModel = ctrls[1];

    $mdTheming(element);
    element.on('click', clickListener);
    element.on('keypress', keyListener);
    if (ngModel) selectCtrl.init(ngModel);
    configureAria();

    function configureAria() {
      element.attr({
        'id': 'select_menu_' + $mdUtil.nextUid(),
        'role': 'listbox',
        'aria-multiselectable': (selectCtrl.isMultiple ? 'true' : 'false')
      });
    }

    function keyListener(e) {
      if (e.keyCode == 13 || e.keyCode == 32) {
        clickListener(e);
      }
    }

    function clickListener(ev) {
      var option = $mdUtil.getClosest(ev.target, 'md-option');
      var optionCtrl = option && angular.element(option).data('$mdOptionController');
      if (!option || !optionCtrl) return;

      var optionHashKey = selectCtrl.hashGetter(optionCtrl.value);
      var isSelected = angular.isDefined(selectCtrl.selected[optionHashKey]);

      scope.$apply(function() {
        if (selectCtrl.isMultiple) {
          if (isSelected) {
            selectCtrl.deselect(optionHashKey);
          } else {
            selectCtrl.select(optionHashKey, optionCtrl.value);
          }
        } else {
          if (!isSelected) {
            selectCtrl.deselect( Object.keys(selectCtrl.selected)[0] );
            selectCtrl.select( optionHashKey, optionCtrl.value );
          }
        }
        selectCtrl.refreshViewValue();
      });
    }
  }



  function SelectMenuController($scope, $attrs, $element) {
    var self = this;
    self.isMultiple = angular.isDefined($attrs.multiple);
    // selected is an object with keys matching all of the selected options' hashed values
    self.selected = {};
    // options is an object with keys matching every option's hash value,
    // and values matching every option's controller.
    self.options = {};

    $scope.$watch(function() { return self.options; }, function() {
      self.ngModel.$render();
    }, true);

    var deregisterCollectionWatch;
    self.setMultiple = function(isMultiple) {
      var ngModel = self.ngModel;
      self.isMultiple = isMultiple;
      if (deregisterCollectionWatch) deregisterCollectionWatch();

      if (self.isMultiple) {
        ngModel.$validators['md-multiple'] = validateArray;
        ngModel.$render = renderMultiple;

        // watchCollection on the model because by default ngModel only watches the model's
        // reference. This allowed the developer to also push and pop from their array.
        $scope.$watchCollection($attrs.ngModel, function(value) {
          if (validateArray(value)) renderMultiple(value);
        });
      } else {
        delete ngModel.$validators['md-multiple'];
        ngModel.$render = renderSingular;
      }

      function validateArray(modelValue, viewValue) {
        // If a value is truthy but not an array, reject it.
        // If value is undefined/falsy, accept that it's an empty array.
        return angular.isArray(modelValue || viewValue || []);
      }
    };

    var searchStr = '';
    var clearSearchTimeout, optNodes, optText;
    var CLEAR_SEARCH_AFTER = 300;
    self.optNodeForKeyboardSearch = function(e) {
      clearSearchTimeout && clearTimeout(clearSearchTimeout);
      clearSearchTimeout = setTimeout(function() {
        clearSearchTimeout = undefined;
        searchStr = '';
        optText = undefined;
        optNodes = undefined;
      }, CLEAR_SEARCH_AFTER);
      searchStr += String.fromCharCode(e.keyCode);
      var search = new RegExp('^' + searchStr, 'i');
      if (!optNodes) {
        optNodes = $element.find('md-option');
        optText = new Array(optNodes.length);
        angular.forEach(optNodes, function(el, i) {
          optText[i] = el.textContent.trim();
        });
      }
      for (var i = 0; i < optText.length; ++i) {
        if (search.test(optText[i])) {
          return optNodes[i];
        }
      }
    };


    self.init = function(ngModel) {
      self.ngModel = ngModel;

      // Allow users to provide `ng-model="foo" ng-model-options="{trackBy: 'foo.id'}"` so
      // that we can properly compare objects set on the model to the available options
      if (ngModel.$options && ngModel.$options.trackBy) {
        var trackByLocals = {};
        var trackByParsed = $parse(ngModel.$options.trackBy);
        self.hashGetter = function(value, valueScope) {
          trackByLocals.$value = value;
          return trackByParsed(valueScope || $scope, trackByLocals);
        };
      // If the user doesn't provide a trackBy, we automatically generate an id for every
      // value passed in
      } else {
        self.hashGetter = function getHashValue(value) {
          if (angular.isObject(value)) {
            return 'object_' + (value.$$mdSelectId || (value.$$mdSelectId = ++selectNextId));
          }
          return value;
        };
      }
      self.setMultiple(self.isMultiple);
    };

    self.selectedLabels = function() {
      var selectedOptionEls = $mdUtil.nodesToArray($element[0].querySelectorAll('md-option[selected]'));
      if (selectedOptionEls.length) {
        return selectedOptionEls.map(function(el) { return el.textContent; }).join(', ');
      } else {
        return '';
      }
    };

    self.select = function(hashKey, hashedValue) {
      var option = self.options[hashKey];
      option && option.setSelected(true);
      self.selected[hashKey] = hashedValue;
    };
    self.deselect = function(hashKey) {
      var option = self.options[hashKey];
      option && option.setSelected(false);
      delete self.selected[hashKey];
    };

    self.addOption = function(hashKey, optionCtrl) {
      if (angular.isDefined(self.options[hashKey])) {
        throw new Error('Duplicate md-option values are not allowed in a select. ' +
                        'Duplicate value "' + optionCtrl.value + '" found.');
      }
      self.options[hashKey] = optionCtrl;

      // If this option's value was already in our ngModel, go ahead and select it.
      if (angular.isDefined(self.selected[hashKey])) {
        self.select(hashKey, optionCtrl.value);
        self.refreshViewValue();
      }
    };
    self.removeOption = function(hashKey) {
      delete self.options[hashKey];
      // Don't deselect an option when it's removed - the user's ngModel should be allowed
      // to have values that do not match a currently available option.
    };

    self.refreshViewValue = function() {
      var values = [];
      var option;
      for (var hashKey in self.selected) {
         // If this hashKey has an associated option, push that option's value to the model.
         if ((option = self.options[hashKey])) {
           values.push(option.value);
         } else {
           // Otherwise, the given hashKey has no associated option, and we got it
           // from an ngModel value at an earlier time. Push the unhashed value of
           // this hashKey to the model.
           // This allows the developer to put a value in the model that doesn't yet have
           // an associated option.
           values.push(self.selected[hashKey]);
         }
      }
      self.ngModel.$setViewValue(self.isMultiple ? values : values[0]);
    };

    function renderMultiple() {
      var newSelectedValues = self.ngModel.$modelValue || self.ngModel.$viewValue;
      if (!angular.isArray(newSelectedValues)) return;

      var oldSelected = Object.keys(self.selected);

      var newSelectedHashes = newSelectedValues.map(self.hashGetter);
      var deselected = oldSelected.filter(function(hash) {
        return newSelectedHashes.indexOf(hash) === -1;
      });

      deselected.forEach(self.deselect);
      newSelectedHashes.forEach(function(hashKey, i) {
        self.select(hashKey, newSelectedValues[i]);
      });
    }
    function renderSingular() {
      var value = self.ngModel.$viewValue || self.ngModel.$modelValue;
      Object.keys(self.selected).forEach(self.deselect);
      self.select( self.hashGetter(value), value );
    }
  }

}
SelectMenuDirective.$inject = ["$parse", "$mdUtil", "$mdTheming"];

function OptionDirective($mdButtonInkRipple, $mdUtil) {

  OptionController.$inject = ["$element"];
  return {
    restrict: 'E',
    require: ['mdOption', '^^mdSelectMenu'],
    controller: OptionController,
    compile: compile
  };

  function compile(element, attr) {
    // Manual transclusion to avoid the extra inner <span> that ng-transclude generates
    element.append( angular.element('<div class="md-text">').append(element.contents()) );

    element.attr('tabindex', attr.tabindex || '0');
    return postLink;
  }

  function postLink(scope, element, attr, ctrls) {
    var optionCtrl = ctrls[0];
    var selectCtrl = ctrls[1];

    if (angular.isDefined(attr.ngValue)) {
      scope.$watch(attr.ngValue, setOptionValue);
    } else if (angular.isDefined(attr.value)) {
      setOptionValue(attr.value);
    } else {
      scope.$watch(function() { return element.text(); }, setOptionValue);
    }

    scope.$$postDigest(function() {
      attr.$observe('selected', function(selected) {
        if (!angular.isDefined(selected)) return;
        if (selected) {
          if (!selectCtrl.isMultiple) {
            selectCtrl.deselect( Object.keys(selectCtrl.selected)[0] );
          }
          selectCtrl.select(optionCtrl.hashKey, optionCtrl.value);
        } else {
          selectCtrl.deselect(optionCtrl.hashKey);
        }
        selectCtrl.refreshViewValue();
        selectCtrl.ngModel.$render();
      });
    });

    $mdButtonInkRipple.attach(scope, element);
    configureAria();

    function setOptionValue(newValue, oldValue) {
      var oldHashKey = selectCtrl.hashGetter(oldValue, scope);
      var newHashKey = selectCtrl.hashGetter(newValue, scope);

      optionCtrl.hashKey = newHashKey;
      optionCtrl.value = newValue;

      selectCtrl.removeOption(oldHashKey, optionCtrl);
      selectCtrl.addOption(newHashKey, optionCtrl);
    }

    scope.$on('$destroy', function() {
      selectCtrl.removeOption(optionCtrl.hashKey, optionCtrl);
    });

    function configureAria() {
      var ariaAttrs = {
        'role': 'option',
        'aria-selected': 'false'
      };

      if (!element[0].hasAttribute('id')) {
        ariaAttrs.id = 'select_option_' + $mdUtil.nextUid();
      }
      element.attr(ariaAttrs);
    }
  }

  function OptionController($element) {
    this.selected = false;
    this.setSelected = function(isSelected) {
      if (isSelected && !this.selected) {
        $element.attr({
          'selected': 'selected',
          'aria-selected': 'true'
        });
      } else if (!isSelected && this.selected) {
        $element.removeAttr('selected');
        $element.attr('aria-selected', 'false');
      }
      this.selected = isSelected;
    };
  }

}
OptionDirective.$inject = ["$mdButtonInkRipple", "$mdUtil"];

function OptgroupDirective() {
  return {
    restrict: 'E',
    compile: compile
  };
  function compile(el, attrs) {
    var labelElement = el.find('label');
    if (!labelElement.length) {
      labelElement = angular.element('<label>');
      el.prepend(labelElement);
    }
    if (attrs.label) labelElement.text(attrs.label);
  }
}

function SelectProvider($$interimElementProvider) {
  selectDefaultOptions.$inject = ["$mdSelect", "$mdConstant", "$$rAF", "$mdUtil", "$mdTheming", "$timeout", "$window"];
  return $$interimElementProvider('$mdSelect')
    .setDefaults({
      methods: ['target'],
      options: selectDefaultOptions
    });

  /* @ngInject */
  function selectDefaultOptions($mdSelect, $mdConstant, $$rAF, $mdUtil, $mdTheming, $timeout, $window ) {
    return {
      parent: 'body',
      onShow: onShow,
      onRemove: onRemove,
      hasBackdrop: true,
      disableParentScroll: true,
      themable: true
    };

    function onShow(scope, element, opts) {
      if (!opts.target) {
        throw new Error('$mdSelect.show() expected a target element in options.target but got ' +
                        '"' + opts.target + '"!');
      }

      angular.extend(opts, {
        isRemoved: false,
        target: angular.element(opts.target), //make sure it's not a naked dom node
        parent: angular.element(opts.parent),
        selectEl: element.find('md-select-menu'),
        contentEl: element.find('md-content'),
        backdrop: opts.hasBackdrop && angular.element('<md-backdrop class="md-select-backdrop md-click-catcher">')
      });

      opts.resizeFn = function() {
        $$rAF(function() {
          $$rAF(function() {
            animateSelect(scope, element, opts);
          });
        });
      };

      angular.element($window).on('resize', opts.resizeFn);
      angular.element($window).on('orientationchange', opts.resizeFn);


      configureAria();

      element.removeClass('md-leave');

      var optionNodes = opts.selectEl[0].getElementsByTagName('md-option');

      if (opts.loadingAsync && opts.loadingAsync.then) {
        opts.loadingAsync.then(function() {
          scope.$$loadingAsyncDone = true;
          // Give ourselves two frames for the progress loader to clear out.
          $$rAF(function() {
            $$rAF(function() {
              // Don't go forward if the select has been removed in this time...
              if (opts.isRemoved) return;
              animateSelect(scope, element, opts);
            });
          });
        });
      } else if (opts.loadingAsync) {
        scope.$$loadingAsyncDone = true;
      }

      if (opts.disableParentScroll && !$mdUtil.getClosest(opts.target, 'MD-DIALOG')) {
        opts.restoreScroll = $mdUtil.disableScrollAround(opts.element);
      } else {
        opts.disableParentScroll = false;
      }
      // Only activate click listeners after a short time to stop accidental double taps/clicks
      // from clicking the wrong item
      $timeout(activateInteraction, 75, false);

      if (opts.backdrop) {
        $mdTheming.inherit(opts.backdrop, opts.parent);
        opts.parent.append(opts.backdrop);
      }
      opts.parent.append(element);

      // Give the select a frame to 'initialize' in the DOM,
      // so we can read its height/width/position
      $$rAF(function() {
        $$rAF(function() {
          if (opts.isRemoved) return;
          animateSelect(scope, element, opts);
        });
      });

      return $mdUtil.transitionEndPromise(opts.selectEl, {timeout: 350});

      function configureAria() {
        opts.target.attr('aria-expanded', 'true');
      }

      function activateInteraction() {
        if (opts.isRemoved) return;
        var selectCtrl = opts.selectEl.controller('mdSelectMenu') || {};
        element.addClass('md-clickable');

        opts.backdrop && opts.backdrop.on('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          opts.restoreFocus = false;
          scope.$apply($mdSelect.cancel);
        });

        // Escape to close
        opts.selectEl.on('keydown', function(ev) {
          switch (ev.keyCode) {
            case $mdConstant.KEY_CODE.SPACE:
            case $mdConstant.KEY_CODE.ENTER:
              var option = $mdUtil.getClosest(ev.target, 'md-option');
              if (option) {
                opts.selectEl.triggerHandler({
                  type: 'click',
                  target: option
                });
                ev.preventDefault();
              }
              break;
            case $mdConstant.KEY_CODE.TAB:
            case $mdConstant.KEY_CODE.ESCAPE:
              ev.preventDefault();
              opts.restoreFocus = true;
              scope.$apply($mdSelect.cancel);
          }
        });

        // Cycling of options, and closing on enter
        opts.selectEl.on('keydown', function(ev) {
          switch (ev.keyCode) {
            case $mdConstant.KEY_CODE.UP_ARROW: return focusPrevOption();
            case $mdConstant.KEY_CODE.DOWN_ARROW: return focusNextOption();
            default:
              if (ev.keyCode >= 31 && ev.keyCode <= 90) {
                var optNode = opts.selectEl.controller('mdSelectMenu').optNodeForKeyboardSearch(ev);
                optNode && optNode.focus();
              }
          }
        });


        function focusOption(direction) {
          var optionsArray = $mdUtil.nodesToArray(optionNodes);
          var index = optionsArray.indexOf(opts.focusedNode);
          if (index === -1) {
            // We lost the previously focused element, reset to first option
            index = 0;
          } else if (direction === 'next' && index < optionsArray.length - 1) {
            index++;
          } else if (direction === 'prev' && index > 0) {
            index--;
          }
          var newOption = opts.focusedNode = optionsArray[index];
          newOption && newOption.focus();
        }
        function focusNextOption() {
          focusOption('next');
        }
        function focusPrevOption() {
          focusOption('prev');
        }

        opts.selectEl.on('click', checkCloseMenu);
        opts.selectEl.on('keydown', function(e) {
          if (e.keyCode == 32 || e.keyCode == 13) {
            checkCloseMenu();
          }
        });

        function checkCloseMenu() {
          if (!selectCtrl.isMultiple) {
            opts.restoreFocus = true;
            scope.$evalAsync(function() {
              $mdSelect.hide(selectCtrl.ngModel.$viewValue);
            });
          }
        }
      }

    }

    function onRemove(scope, element, opts) {
      opts.isRemoved = true;
      element.addClass('md-leave')
        .removeClass('md-clickable');
      opts.target.attr('aria-expanded', 'false');


      angular.element($window).off('resize', opts.resizeFn);
      angular.element($window).off('orientationchange', opts.resizefn);
      opts.resizeFn = undefined;

      var mdSelect = opts.selectEl.controller('mdSelect');
      if (mdSelect) {
        mdSelect.setLabelText(opts.selectEl.controller('mdSelectMenu').selectedLabels());
      }

      return $mdUtil.transitionEndPromise(element, { timeout: 350 }).then(function() {
        element.removeClass('md-active');
        opts.backdrop && opts.backdrop.remove();
        if (element[0].parentNode === opts.parent[0]) {
          opts.parent[0].removeChild(element[0]); // use browser to avoid $destroy event
        }
        if (opts.disableParentScroll) {
          opts.restoreScroll();
        }
        if (opts.restoreFocus) opts.target.focus();
        mdSelect && mdSelect.triggerClose();
      });
    }

    function animateSelect(scope, element, opts) {
      var containerNode = element[0],
          targetNode = opts.target[0].firstElementChild.firstElementChild, // target the first span, functioning as the label
          parentNode = opts.parent[0],
          selectNode = opts.selectEl[0],
          contentNode = opts.contentEl[0],
          parentRect = parentNode.getBoundingClientRect(),
          targetRect = targetNode.getBoundingClientRect(),
          shouldOpenAroundTarget = false,
          bounds = {
            left: parentRect.left + SELECT_EDGE_MARGIN,
            top: SELECT_EDGE_MARGIN,
            bottom: parentRect.height - SELECT_EDGE_MARGIN,
            right: parentRect.width - SELECT_EDGE_MARGIN - ($mdUtil.floatingScrollbars() ? 16 : 0)
          },
          spaceAvailable = {
            top: targetRect.top - bounds.top,
            left: targetRect.left - bounds.left,
            right: bounds.right - (targetRect.left + targetRect.width),
            bottom: bounds.bottom - (targetRect.top + targetRect.height)
          },
          maxWidth = parentRect.width - SELECT_EDGE_MARGIN * 2,
          isScrollable = contentNode.scrollHeight > contentNode.offsetHeight,
          selectedNode = selectNode.querySelector('md-option[selected]'),
          optionNodes = selectNode.getElementsByTagName('md-option'),
          optgroupNodes = selectNode.getElementsByTagName('md-optgroup');


      var centeredNode;
      // If a selected node, center around that
      if (selectedNode) {
        centeredNode = selectedNode;
      // If there are option groups, center around the first option group
      } else if (optgroupNodes.length) {
        centeredNode = optgroupNodes[0];
      // Otherwise, center around the first optionNode
      } else if (optionNodes.length){
        centeredNode = optionNodes[0];
      // In case there are no options, center on whatever's in there... (eg progress indicator)
      } else {
        centeredNode = contentNode.firstElementChild || contentNode;
      }

      if (contentNode.offsetWidth > maxWidth) {
        contentNode.style['max-width'] = maxWidth + 'px';
      }
      if (shouldOpenAroundTarget) {
        contentNode.style['min-width'] = targetRect.width + 'px';
      }

      // Remove padding before we compute the position of the menu
      if (isScrollable) {
        selectNode.classList.add('md-overflow');
      }

      // Get the selectMenuRect *after* max-width is possibly set above
      var selectMenuRect = selectNode.getBoundingClientRect();
      var centeredRect = getOffsetRect(centeredNode);

      if (centeredNode) {
        var centeredStyle = $window.getComputedStyle(centeredNode);
        centeredRect.paddingLeft = parseInt(centeredStyle.paddingLeft, 10) || 0;
        centeredRect.paddingRight = parseInt(centeredStyle.paddingRight, 10) || 0;
      }

      var focusedNode = centeredNode;
      if ((focusedNode.tagName || '').toUpperCase() === 'MD-OPTGROUP') {
        focusedNode = optionNodes[0] || contentNode.firstElementChild || contentNode;
      }

      if (isScrollable) {
        var scrollBuffer = contentNode.offsetHeight / 2;
        contentNode.scrollTop = centeredRect.top + centeredRect.height / 2 - scrollBuffer;

        if (spaceAvailable.top < scrollBuffer) {
          contentNode.scrollTop = Math.min(
            centeredRect.top,
            contentNode.scrollTop + scrollBuffer - spaceAvailable.top
          );
        } else if (spaceAvailable.bottom < scrollBuffer) {
          contentNode.scrollTop = Math.max(
            centeredRect.top + centeredRect.height - selectMenuRect.height,
            contentNode.scrollTop - scrollBuffer + spaceAvailable.bottom
          );
        }
      }

      var left, top, transformOrigin;
      if (shouldOpenAroundTarget) {
        left = targetRect.left;
        top = targetRect.top + targetRect.height;
        transformOrigin = '50% 0';
        if (top + selectMenuRect.height > bounds.bottom) {
          top = targetRect.top - selectMenuRect.height;
          transformOrigin = '50% 100%';
        }
      } else {
        left = targetRect.left + centeredRect.left - centeredRect.paddingLeft;
        top = Math.floor(targetRect.top + targetRect.height / 2 - centeredRect.height / 2 -
          centeredRect.top + contentNode.scrollTop);


        transformOrigin = (centeredRect.left + targetRect.width / 2) + 'px ' +
        (centeredRect.top + centeredRect.height / 2 - contentNode.scrollTop) + 'px 0px';

        containerNode.style.minWidth = targetRect.width + centeredRect.paddingLeft +
          centeredRect.paddingRight + 'px';
      }

      // Keep left and top within the window
      var containerRect = containerNode.getBoundingClientRect();
      containerNode.style.left = clamp(bounds.left, left, bounds.right - containerRect.width) + 'px';
      containerNode.style.top = clamp(bounds.top, top, bounds.bottom - containerRect.height) + 'px';
      selectNode.style[$mdConstant.CSS.TRANSFORM_ORIGIN] = transformOrigin;

      selectNode.style[$mdConstant.CSS.TRANSFORM] = 'scale(' +
        Math.min(targetRect.width / selectMenuRect.width, 1.0) + ',' +
        Math.min(targetRect.height / selectMenuRect.height, 1.0) +
      ')';


      $$rAF(function() {
        element.addClass('md-active');
        selectNode.style[$mdConstant.CSS.TRANSFORM] = '';
        if (focusedNode) {
          opts.focusedNode = focusedNode;
          focusedNode.focus();
        }
      });
    }

  }

  function clamp(min, n, max) {
    return Math.max(min, Math.min(n, max));
  }

  function getOffsetRect(node) {
    return node ? {
      left: node.offsetLeft,
      top: node.offsetTop,
      width: node.offsetWidth,
      height: node.offsetHeight
    } : { left: 0, top: 0, width: 0, height: 0 };
  }
}
SelectProvider.$inject = ["$$interimElementProvider"];


})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.sidenav
 *
 * @description
 * A Sidenav QP component.
 */
angular.module('material.components.sidenav', [
    'material.core',
    'material.components.backdrop'
  ])
  .factory('$mdSidenav', SidenavService )
  .directive('mdSidenav', SidenavDirective)
  .directive('mdSidenavFocus', SidenavFocusDirective)
  .controller('$mdSidenavController', SidenavController);


/**
 * @private
 * @ngdoc service
 * @name $mdSidenav
 * @module material.components.sidenav
 *
 * @description
 * `$mdSidenav` makes it easy to interact with multiple sidenavs
 * in an app.
 *
 * @usage
 * <hljs lang="js">
 * // Async lookup for sidenav instance; will resolve when the instance is available
 * $mdSidenav(componentId).then(function(instance) {
 *   $log.debug( componentId + "is now ready" );
 * });
 * // Async toggle the given sidenav;
 * // when instance is known ready and lazy lookup is not needed.
 * $mdSidenav(componentId)
 *    .toggle()
 *    .then(function(){
 *      $log.debug('toggled');
 *    });
 * // Async open the given sidenav
 * $mdSidenav(componentId)
 *    .open()
 *    .then(function(){
 *      $log.debug('opened');
 *    });
 * // Async close the given sidenav
 * $mdSidenav(componentId)
 *    .close()
 *    .then(function(){
 *      $log.debug('closed');
 *    });
 * // Sync check to see if the specified sidenav is set to be open
 * $mdSidenav(componentId).isOpen();
 * // Sync check to whether given sidenav is locked open
 * // If this is true, the sidenav will be open regardless of close()
 * $mdSidenav(componentId).isLockedOpen();
 * </hljs>
 */
function SidenavService($mdComponentRegistry, $q) {
  return function(handle) {

    // Lookup the controller instance for the specified sidNav instance
    var self;
    var errorMsg = "SideNav '" + handle + "' is not available!";
    var instance = $mdComponentRegistry.get(handle);

    if(!instance) {
      $mdComponentRegistry.notFoundError(handle);
    }

    return self = {
      // -----------------
      // Sync methods
      // -----------------
      isOpen: function() {
        return instance && instance.isOpen();
      },
      isLockedOpen: function() {
        return instance && instance.isLockedOpen();
      },
      // -----------------
      // Async methods
      // -----------------
      toggle: function() {
        return instance ? instance.toggle() : $q.reject(errorMsg);
      },
      open: function() {
        return instance ? instance.open() : $q.reject(errorMsg);
      },
      close: function() {
        return instance ? instance.close() : $q.reject(errorMsg);
      },
      then : function( callbackFn ) {
        var promise = instance ? $q.when(instance) : waitForInstance();
        return promise.then( callbackFn || angular.noop );
      }
    };

    /**
     * Deferred lookup of component instance using $component registry
     */
    function waitForInstance() {
      return $mdComponentRegistry
                .when(handle)
                .then(function( it ){
                  instance = it;
                  return it;
                });
    }
  };
}
SidenavService.$inject = ["$mdComponentRegistry", "$q"];
/**
 * @ngdoc directive
 * @name mdSidenavFocus
 * @module material.components.sidenav
 *
 * @restrict A
 *
 * @description
 * `$mdSidenavFocus` provides a way to specify the focused element when a sidenav opens.
 * This is completely optional, as the sidenav itself is focused by default.
 *
 * @usage
 * <hljs lang="html">
 * <md-sidenav>
 *   <form>
 *     <md-input-container>
 *       <label for="testInput">Label</label>
 *       <input id="testInput" type="text" md-sidenav-focus>
 *     </md-input-container>
 *   </form>
 * </md-sidenav>
 * </hljs>
 **/
function SidenavFocusDirective() {
  return {
    restrict: 'A',
    require: '^mdSidenav',
    link: function(scope, element, attr, sidenavCtrl) {
      sidenavCtrl.focusElement(element);
    }
  };
}
/**
 * @ngdoc directive
 * @name mdSidenav
 * @module material.components.sidenav
 * @restrict E
 *
 * @description
 *
 * A Sidenav component that can be opened and closed programatically.
 *
 * By default, upon opening it will slide out on top of the main content area.
 *
 * For keyboard and screen reader accessibility, focus is sent to the sidenav wrapper by default.
 * It can be overridden with the `md-sidenav-focus` directive on the child element you want focused.
 *
 * @usage
 * <hljs lang="html">
 * <div layout="row" ng-controller="MyController">
 *   <md-sidenav md-component-id="left" class="md-sidenav-left">
 *     Left Nav!
 *   </md-sidenav>
 *
 *   <md-content>
 *     Center Content
 *     <md-button ng-click="openLeftMenu()">
 *       Open Left Menu
 *     </md-button>
 *   </md-content>
 *
 *   <md-sidenav md-component-id="right"
 *     md-is-locked-open="$mdMedia('min-width: 333px')"
 *     class="md-sidenav-right">
 *     <form>
 *       <md-input-container>
 *         <label for="testInput">Test input</label>
 *         <input id="testInput" type="text"
 *                ng-model="data" md-sidenav-focus>
 *       </md-input-container>
 *     </form>
 *   </md-sidenav>
 * </div>
 * </hljs>
 *
 * <hljs lang="js">
 * var app = angular.module('myApp', ['ngMaterial']);
 * app.controller('MyController', function($scope, $mdSidenav) {
 *   $scope.openLeftMenu = function() {
 *     $mdSidenav('left').toggle();
 *   };
 * });
 * </hljs>
 *
 * @param {expression=} md-is-open A model bound to whether the sidenav is opened.
 * @param {string=} md-component-id componentId to use with $mdSidenav service.
 * @param {expression=} md-is-locked-open When this expression evalutes to true,
 * the sidenav 'locks open': it falls into the content's flow instead
 * of appearing over it. This overrides the `is-open` attribute.
 *
 * The $mdMedia() service is exposed to the is-locked-open attribute, which
 * can be given a media query or one of the `sm`, `gt-sm`, `md`, `gt-md`, `lg` or `gt-lg` presets.
 * Examples:
 *
 *   - `<md-sidenav md-is-locked-open="shouldLockOpen"></md-sidenav>`
 *   - `<md-sidenav md-is-locked-open="$mdMedia('min-width: 1000px')"></md-sidenav>`
 *   - `<md-sidenav md-is-locked-open="$mdMedia('sm')"></md-sidenav>` (locks open on small screens)
 */
function SidenavDirective($timeout, $animate, $parse, $log, $mdMedia, $mdConstant, $compile, $mdTheming, $q, $document) {
  return {
    restrict: 'E',
    scope: {
      isOpen: '=?mdIsOpen'
    },
    controller: '$mdSidenavController',
    compile: function(element) {
      element.addClass('md-closed');
      element.attr('tabIndex', '-1');
      return postLink;
    }
  };

  /**
   * Directive Post Link function...
   */
  function postLink(scope, element, attr, sidenavCtrl) {
    var lastParentOverFlow;
    var triggeringElement = null;
    var promise = $q.when(true);

    var isLockedOpenParsed = $parse(attr.mdIsLockedOpen);
    var isLocked = function() {
      return isLockedOpenParsed(scope.$parent, {
        $media: function(arg) {
          $log.warn("$media is deprecated for is-locked-open. Use $mdMedia instead.");
          return $mdMedia(arg);
        },
        $mdMedia: $mdMedia
      });
    };
    var backdrop = $compile(
      '<md-backdrop class="md-sidenav-backdrop md-opaque ng-enter">'
    )(scope);

    element.on('$destroy', sidenavCtrl.destroy);
    $mdTheming.inherit(backdrop, element);

    scope.$watch(isLocked, updateIsLocked);
    scope.$watch('isOpen', updateIsOpen);


    // Publish special accessor for the Controller instance
    sidenavCtrl.$toggleOpen = toggleOpen;
    sidenavCtrl.focusElement( sidenavCtrl.focusElement() || element );

    /**
     * Toggle the DOM classes to indicate `locked`
     * @param isLocked
     */
    function updateIsLocked(isLocked, oldValue) {
      scope.isLockedOpen = isLocked;
      if (isLocked === oldValue) {
        element.toggleClass('md-locked-open', !!isLocked);
      } else {
        $animate[isLocked ? 'addClass' : 'removeClass'](element, 'md-locked-open');
      }
      backdrop.toggleClass('md-locked-open', !!isLocked);
    }

    /**
     * Toggle the SideNav view and attach/detach listeners
     * @param isOpen
     */
    function updateIsOpen(isOpen) {
      var parent = element.parent();

      parent[isOpen ? 'on' : 'off']('keydown', onKeyDown);
      backdrop[isOpen ? 'on' : 'off']('click', close);

      if ( isOpen ) {
        // Capture upon opening..
        triggeringElement = $document[0].activeElement;
      }
      var focusEl = sidenavCtrl.focusElement();

      disableParentScroll(isOpen);

      return promise = $q.all([
                isOpen ? $animate.enter(backdrop, parent) : $animate.leave(backdrop),
                $animate[isOpen ? 'removeClass' : 'addClass'](element, 'md-closed')
              ])
              .then(function() {
                // Perform focus when animations are ALL done...
                if (scope.isOpen) {
                  focusEl && focusEl.focus();
                }
              });
    }

    /**
     * Prevent parent scrolling (when the SideNav is open)
     */
    function disableParentScroll(disabled) {
      var parent = element.parent();
      if ( disabled ) {
        lastParentOverFlow = parent.css('overflow');
        parent.css('overflow', 'hidden');
      } else if (angular.isDefined(lastParentOverFlow)) {
        parent.css('overflow', lastParentOverFlow);
        lastParentOverFlow = undefined;
      }
    }

    /**
     * Toggle the sideNav view and publish a promise to be resolved when
     * the view animation finishes.
     *
     * @param isOpen
     * @returns {*}
     */
    function toggleOpen( isOpen ) {
      if (scope.isOpen == isOpen ) {

        return $q.when(true);

      } else {
        var deferred = $q.defer();

        // Toggle value to force an async `updateIsOpen()` to run
        scope.isOpen = isOpen;

        $timeout(function() {

          // When the current `updateIsOpen()` animation finishes
          promise.then(function(result) {

            if ( !scope.isOpen ) {
              // reset focus to originating element (if available) upon close
              triggeringElement && triggeringElement.focus();
              triggeringElement = null;
            }

            deferred.resolve(result);
          });

        },0,false);

        return deferred.promise;
      }
    }

    /**
     * Auto-close sideNav when the `escape` key is pressed.
     * @param evt
     */
    function onKeyDown(ev) {
      var isEscape = (ev.keyCode === $mdConstant.KEY_CODE.ESCAPE);
      return isEscape ? close(ev) : $q.when(true);
    }

    /**
     * With backdrop `clicks` or `escape` key-press, immediately
     * apply the CSS close transition... Then notify the controller
     * to close() and perform its own actions.
     */
    function close(ev) {
      ev.preventDefault();
      ev.stopPropagation();

      return sidenavCtrl.close();
    }

  }
}
SidenavDirective.$inject = ["$timeout", "$animate", "$parse", "$log", "$mdMedia", "$mdConstant", "$compile", "$mdTheming", "$q", "$document"];

/*
 * @private
 * @ngdoc controller
 * @name SidenavController
 * @module material.components.sidenav
 *
 */
function SidenavController($scope, $element, $attrs, $mdComponentRegistry, $q) {

  var self = this,
      focusElement;

  // Use Default internal method until overridden by directive postLink

  // Synchronous getters
  self.isOpen = function() { return !!$scope.isOpen; };
  self.isLockedOpen = function() { return !!$scope.isLockedOpen; };

  // Async actions
  self.open   = function() { return self.$toggleOpen( true );  };
  self.close  = function() { return self.$toggleOpen( false ); };
  self.toggle = function() { return self.$toggleOpen( !$scope.isOpen );  };
  self.focusElement = function(el) {
    if ( angular.isDefined(el) ) {
      focusElement = el;
    }
    return focusElement;
  };

  self.$toggleOpen = function() { return $q.when($scope.isOpen); };

  self.destroy = $mdComponentRegistry.register(self, $attrs.mdComponentId);
}
SidenavController.$inject = ["$scope", "$element", "$attrs", "$mdComponentRegistry", "$q"];

})();
(function(){
"use strict";

  /**
   * @ngdoc module
   * @name material.components.slider
   */
  angular.module('material.components.slider', [
    'material.core'
  ])
  .directive('mdSlider', SliderDirective);

/**
 * @ngdoc directive
 * @name mdSlider
 * @module material.components.slider
 * @restrict E
 * @description
 * The `<md-slider>` component allows the user to choose from a range of
 * values.
 *
 * As per the [material design spec](http://www.google.com/design/spec/style/color.html#color-ui-color-application)
 * the slider is in the accent color by default. The primary color palette may be used with
 * the `md-primary` class.
 *
 * It has two modes: 'normal' mode, where the user slides between a wide range
 * of values, and 'discrete' mode, where the user slides between only a few
 * select values.
 *
 * To enable discrete mode, add the `md-discrete` attribute to a slider,
 * and use the `step` attribute to change the distance between
 * values the user is allowed to pick.
 *
 * @usage
 * <h4>Normal Mode</h4>
 * <hljs lang="html">
 * <md-slider ng-model="myValue" min="5" max="500">
 * </md-slider>
 * </hljs>
 * <h4>Discrete Mode</h4>
 * <hljs lang="html">
 * <md-slider md-discrete ng-model="myDiscreteValue" step="10" min="10" max="130">
 * </md-slider>
 * </hljs>
 *
 * @param {boolean=} md-discrete Whether to enable discrete mode.
 * @param {number=} step The distance between values the user is allowed to pick. Default 1.
 * @param {number=} min The minimum value the user is allowed to pick. Default 0.
 * @param {number=} max The maximum value the user is allowed to pick. Default 100.
 */
function SliderDirective($$rAF, $window, $mdAria, $mdUtil, $mdConstant, $mdTheming, $mdGesture, $parse) {
  return {
    scope: {},
    require: '?ngModel',
    template:
      '<div class="md-slider-wrapper">\
        <div class="md-track-container">\
          <div class="md-track"></div>\
          <div class="md-track md-track-fill"></div>\
          <div class="md-track-ticks"></div>\
        </div>\
        <div class="md-thumb-container">\
          <div class="md-thumb"></div>\
          <div class="md-focus-thumb"></div>\
          <div class="md-focus-ring"></div>\
          <div class="md-sign">\
            <span class="md-thumb-text"></span>\
          </div>\
          <div class="md-disabled-thumb"></div>\
        </div>\
      </div>',
    compile: compile
  };

  // **********************************************************
  // Private Methods
  // **********************************************************

  function compile (tElement, tAttrs) {
    tElement.attr({
      tabIndex: 0,
      role: 'slider'
    });

    $mdAria.expect(tElement, 'aria-label');

    return postLink;
  }

  function postLink(scope, element, attr, ngModelCtrl) {
    $mdTheming(element);
    ngModelCtrl = ngModelCtrl || {
      // Mock ngModelController if it doesn't exist to give us
      // the minimum functionality needed
      $setViewValue: function(val) {
        this.$viewValue = val;
        this.$viewChangeListeners.forEach(function(cb) { cb(); });
      },
      $parsers: [],
      $formatters: [],
      $viewChangeListeners: []
    };

    var isDisabledParsed = attr.ngDisabled && $parse(attr.ngDisabled);
    var isDisabledGetter = isDisabledParsed ?
      function() { return isDisabledParsed(scope.$parent); } :
      angular.noop;
    var thumb = angular.element(element[0].querySelector('.md-thumb'));
    var thumbText = angular.element(element[0].querySelector('.md-thumb-text'));
    var thumbContainer = thumb.parent();
    var trackContainer = angular.element(element[0].querySelector('.md-track-container'));
    var activeTrack = angular.element(element[0].querySelector('.md-track-fill'));
    var tickContainer = angular.element(element[0].querySelector('.md-track-ticks'));
    var throttledRefreshDimensions = $mdUtil.throttle(refreshSliderDimensions, 5000);

    // Default values, overridable by attrs
    angular.isDefined(attr.min) ? attr.$observe('min', updateMin) : updateMin(0);
    angular.isDefined(attr.max) ? attr.$observe('max', updateMax) : updateMax(100);
    angular.isDefined(attr.step)? attr.$observe('step', updateStep) : updateStep(1);

    // We have to manually stop the $watch on ngDisabled because it exists
    // on the parent scope, and won't be automatically destroyed when
    // the component is destroyed.
    var stopDisabledWatch = angular.noop;
    if (attr.ngDisabled) {
      stopDisabledWatch = scope.$parent.$watch(attr.ngDisabled, updateAriaDisabled);
    }

    $mdGesture.register(element, 'drag');

    element
      .on('keydown', keydownListener)
      .on('$md.pressdown', onPressDown)
      .on('$md.pressup', onPressUp)
      .on('$md.dragstart', onDragStart)
      .on('$md.drag', onDrag)
      .on('$md.dragend', onDragEnd);

    // On resize, recalculate the slider's dimensions and re-render
    function updateAll() {
      refreshSliderDimensions();
      ngModelRender();
      redrawTicks();
    }
    setTimeout(updateAll);

    var debouncedUpdateAll = $$rAF.throttle(updateAll);
    angular.element($window).on('resize', debouncedUpdateAll);

    scope.$on('$destroy', function() {
      angular.element($window).off('resize', debouncedUpdateAll);
      stopDisabledWatch();
    });

    ngModelCtrl.$render = ngModelRender;
    ngModelCtrl.$viewChangeListeners.push(ngModelRender);
    ngModelCtrl.$formatters.push(minMaxValidator);
    ngModelCtrl.$formatters.push(stepValidator);

    /**
     * Attributes
     */
    var min;
    var max;
    var step;
    function updateMin(value) {
      min = parseFloat(value);
      element.attr('aria-valuemin', value);
      updateAll();
    }
    function updateMax(value) {
      max = parseFloat(value);
      element.attr('aria-valuemax', value);
      updateAll();
    }
    function updateStep(value) {
      step = parseFloat(value);
      redrawTicks();
    }
    function updateAriaDisabled(isDisabled) {
      element.attr('aria-disabled', !!isDisabled);
    }

    // Draw the ticks with canvas.
    // The alternative to drawing ticks with canvas is to draw one element for each tick,
    // which could quickly become a performance bottleneck.
    var tickCanvas, tickCtx;
    function redrawTicks() {
      if (!angular.isDefined(attr.mdDiscrete)) return;

      var numSteps = Math.floor( (max - min) / step );
      if (!tickCanvas) {
        var trackTicksStyle = $window.getComputedStyle(tickContainer[0]);
        tickCanvas = angular.element('<canvas style="position:absolute;">');
        tickCtx = tickCanvas[0].getContext('2d');
        tickCtx.fillStyle = trackTicksStyle.backgroundColor || 'black';
        tickContainer.append(tickCanvas);
      }
      var dimensions = getSliderDimensions();
      tickCanvas[0].width = dimensions.width;
      tickCanvas[0].height = dimensions.height;

      var distance;
      for (var i = 0; i <= numSteps; i++) {
        distance = Math.floor(dimensions.width * (i / numSteps));
        tickCtx.fillRect(distance - 1, 0, 2, dimensions.height);
      }
    }


    /**
     * Refreshing Dimensions
     */
    var sliderDimensions = {};
    refreshSliderDimensions();
    function refreshSliderDimensions() {
      sliderDimensions = trackContainer[0].getBoundingClientRect();
    }
    function getSliderDimensions() {
      throttledRefreshDimensions();
      return sliderDimensions;
    }

    /**
     * left/right arrow listener
     */
    function keydownListener(ev) {
      if(element[0].hasAttribute('disabled')) {
        return;
      }

      var changeAmount;
      if (ev.keyCode === $mdConstant.KEY_CODE.LEFT_ARROW) {
        changeAmount = -step;
      } else if (ev.keyCode === $mdConstant.KEY_CODE.RIGHT_ARROW) {
        changeAmount = step;
      }
      if (changeAmount) {
        if (ev.metaKey || ev.ctrlKey || ev.altKey) {
          changeAmount *= 4;
        }
        ev.preventDefault();
        ev.stopPropagation();
        scope.$evalAsync(function() {
          setModelValue(ngModelCtrl.$viewValue + changeAmount);
        });
      }
    }

    /**
     * ngModel setters and validators
     */
    function setModelValue(value) {
      ngModelCtrl.$setViewValue( minMaxValidator(stepValidator(value)) );
    }
    function ngModelRender() {
      if (isNaN(ngModelCtrl.$viewValue)) {
        ngModelCtrl.$viewValue = ngModelCtrl.$modelValue;
      }

      var percent = (ngModelCtrl.$viewValue - min) / (max - min);
      scope.modelValue = ngModelCtrl.$viewValue;
      element.attr('aria-valuenow', ngModelCtrl.$viewValue);
      setSliderPercent(percent);
      thumbText.text( ngModelCtrl.$viewValue );
    }

    function minMaxValidator(value) {
      if (angular.isNumber(value)) {
        return Math.max(min, Math.min(max, value));
      }
    }
    function stepValidator(value) {
      if (angular.isNumber(value)) {
        var formattedValue = (Math.round(value / step) * step);
        // Format to 3 digits after the decimal point - fixes #2015.
        return (Math.round(formattedValue * 1000) / 1000);
      }
    }

    /**
     * @param percent 0-1
     */
    function setSliderPercent(percent) {
      activeTrack.css('width', (percent * 100) + '%');
      thumbContainer.css(
        'left',
        (percent * 100) + '%'
      );
      element.toggleClass('md-min', percent === 0);
    }


    /**
     * Slide listeners
     */
    var isDragging = false;
    var isDiscrete = angular.isDefined(attr.mdDiscrete);

    function onPressDown(ev) {
      if (isDisabledGetter()) return;

      element.addClass('active');
      element[0].focus();
      refreshSliderDimensions();

      var exactVal = percentToValue( positionToPercent( ev.pointer.x ));
      var closestVal = minMaxValidator( stepValidator(exactVal) );
      scope.$apply(function() {
        setModelValue( closestVal );
        setSliderPercent( valueToPercent(closestVal));
      });
    }
    function onPressUp(ev) {
      if (isDisabledGetter()) return;

      element.removeClass('dragging active');

      var exactVal = percentToValue( positionToPercent( ev.pointer.x ));
      var closestVal = minMaxValidator( stepValidator(exactVal) );
      scope.$apply(function() {
        setModelValue(closestVal);
        ngModelRender();
      });
    }
    function onDragStart(ev) {
      if (isDisabledGetter()) return;
      isDragging = true;
      ev.stopPropagation();

      element.addClass('dragging');
      setSliderFromEvent(ev);
    }
    function onDrag(ev) {
      if (!isDragging) return;
      ev.stopPropagation();
      setSliderFromEvent(ev);
    }
    function onDragEnd(ev) {
      if (!isDragging) return;
      ev.stopPropagation();
      isDragging = false;
    }

    function setSliderFromEvent(ev) {
      // While panning discrete, update only the
      // visual positioning but not the model value.
      if ( isDiscrete ) adjustThumbPosition( ev.pointer.x );
      else              doSlide( ev.pointer.x );
    }

    /**
     * Slide the UI by changing the model value
     * @param x
     */
    function doSlide( x ) {
      scope.$evalAsync( function() {
        setModelValue( percentToValue( positionToPercent(x) ));
      });
    }

    /**
     * Slide the UI without changing the model (while dragging/panning)
     * @param x
     */
    function adjustThumbPosition( x ) {
      var exactVal = percentToValue( positionToPercent( x ));
      var closestVal = minMaxValidator( stepValidator(exactVal) );
      setSliderPercent( positionToPercent(x) );
      thumbText.text( closestVal );
    }

    /**
     * Convert horizontal position on slider to percentage value of offset from beginning...
     * @param x
     * @returns {number}
     */
    function positionToPercent( x ) {
      return Math.max(0, Math.min(1, (x - sliderDimensions.left) / (sliderDimensions.width)));
    }

    /**
     * Convert percentage offset on slide to equivalent model value
     * @param percent
     * @returns {*}
     */
    function percentToValue( percent ) {
      return (min + percent * (max - min));
    }

    function valueToPercent( val ) {
      return (val - min)/(max - min);
    }
  }
}
SliderDirective.$inject = ["$$rAF", "$window", "$mdAria", "$mdUtil", "$mdConstant", "$mdTheming", "$mdGesture", "$parse"];

})();
(function(){
"use strict";

/*
 * @ngdoc module
 * @name material.components.sticky
 * @description
 *
 * Sticky effects for md
 */

angular.module('material.components.sticky', [
  'material.core',
  'material.components.content'
])
  .factory('$mdSticky', MdSticky);

/*
 * @ngdoc service
 * @name $mdSticky
 * @module material.components.sticky
 *
 * @description
 * The `$mdSticky`service provides a mixin to make elements sticky.
 *
 * @returns A `$mdSticky` function that takes three arguments:
 *   - `scope`
 *   - `element`: The element that will be 'sticky'
 *   - `elementClone`: A clone of the element, that will be shown
 *     when the user starts scrolling past the original element.
 *     If not provided, it will use the result of `element.clone()`.
 */

function MdSticky($document, $mdConstant, $compile, $$rAF, $mdUtil) {

  var browserStickySupport = checkStickySupport();

  /**
   * Registers an element as sticky, used internally by directives to register themselves
   */
  return function registerStickyElement(scope, element, stickyClone) {
    var contentCtrl = element.controller('mdContent');
    if (!contentCtrl) return;

    if (browserStickySupport) {
      element.css({
        position: browserStickySupport,
        top: 0,
        'z-index': 2
      });
    } else {
      var $$sticky = contentCtrl.$element.data('$$sticky');
      if (!$$sticky) {
        $$sticky = setupSticky(contentCtrl);
        contentCtrl.$element.data('$$sticky', $$sticky);
      }

      var deregister = $$sticky.add(element, stickyClone || element.clone());
      scope.$on('$destroy', deregister);
    }
  };

  function setupSticky(contentCtrl) {
    var contentEl = contentCtrl.$element;

    // Refresh elements is very expensive, so we use the debounced
    // version when possible.
    var debouncedRefreshElements = $$rAF.throttle(refreshElements);

    // setupAugmentedScrollEvents gives us `$scrollstart` and `$scroll`,
    // more reliable than `scroll` on android.
    setupAugmentedScrollEvents(contentEl);
    contentEl.on('$scrollstart', debouncedRefreshElements);
    contentEl.on('$scroll', onScroll);

    var self;
    var stickyBaseoffset = contentEl.prop('offsetTop');
    return self = {
      prev: null,
      current: null, //the currently stickied item
      next: null,
      items: [],
      add: add,
      refreshElements: refreshElements
    };

    /***************
     * Public
     ***************/
    // Add an element and its sticky clone to this content's sticky collection
    function add(element, stickyClone) {
      stickyClone.addClass('md-sticky-clone');
      stickyClone.css('top', stickyBaseoffset + 'px');

      var item = {
        element: element,
        clone: stickyClone
      };
      self.items.push(item);

      contentEl.parent().prepend(item.clone);

      debouncedRefreshElements();

      return function remove() {
        self.items.forEach(function(item, index) {
          if (item.element[0] === element[0]) {
            self.items.splice(index, 1);
            item.clone.remove();
          }
        });
        debouncedRefreshElements();
      };
    }

    function refreshElements() {
      // Sort our collection of elements by their current position in the DOM.
      // We need to do this because our elements' order of being added may not
      // be the same as their order of display.
      self.items.forEach(refreshPosition);
      self.items = self.items.sort(function(a, b) {
        return a.top < b.top ? -1 : 1;
      });

      // Find which item in the list should be active, 
      // based upon the content's current scroll position
      var item;
      var currentScrollTop = contentEl.prop('scrollTop');
      for (var i = self.items.length - 1; i >= 0; i--) {
        if (currentScrollTop > self.items[i].top) {
          item = self.items[i];
          break;
        }
      }
      setCurrentItem(item);
    }


    /***************
     * Private
     ***************/

    // Find the `top` of an item relative to the content element,
    // and also the height.
    function refreshPosition(item) {
      // Find the top of an item by adding to the offsetHeight until we reach the 
      // content element.
      var current = item.element[0];
      item.top = 0;
      item.left = 0;
      while (current && current !== contentEl[0]) {
        item.top += current.offsetTop;
        item.left += current.offsetLeft;
        current = current.offsetParent;
      }
      item.height = item.element.prop('offsetHeight');
      item.clone.css('margin-left', item.left + 'px');
      if ($mdUtil.floatingScrollbars()) {
        item.clone.css('margin-right', '0');
      }
    }


    // As we scroll, push in and select the correct sticky element.
    function onScroll() {
      var scrollTop = contentEl.prop('scrollTop');
      var isScrollingDown = scrollTop > (onScroll.prevScrollTop || 0);
      onScroll.prevScrollTop = scrollTop;

      // At the top?
      if (scrollTop === 0) {
        setCurrentItem(null);

      // Going to next item?
      } else if (isScrollingDown && self.next) {
        if (self.next.top - scrollTop <= 0) {
          // Sticky the next item if we've scrolled past its position.
          setCurrentItem(self.next);
        } else if (self.current) {
          // Push the current item up when we're almost at the next item.
          if (self.next.top - scrollTop <= self.next.height) {
            translate(self.current, self.next.top - self.next.height - scrollTop);
          } else {
            translate(self.current, null);
          }
        }
        
      // Scrolling up with a current sticky item?
      } else if (!isScrollingDown && self.current) {
        if (scrollTop < self.current.top) {
          // Sticky the previous item if we've scrolled up past
          // the original position of the currently stickied item.
          setCurrentItem(self.prev);
        }
        // Scrolling up, and just bumping into the item above (just set to current)?
        // If we have a next item bumping into the current item, translate
        // the current item up from the top as it scrolls into view.
        if (self.current && self.next) {
          if (scrollTop >= self.next.top - self.current.height) {
            translate(self.current, self.next.top - scrollTop - self.current.height);
          } else {
            translate(self.current, null);
          }
        }
      }
    }
     
   function setCurrentItem(item) {
     if (self.current === item) return;
     // Deactivate currently active item
     if (self.current) {
       translate(self.current, null);
       setStickyState(self.current, null);
     }

     // Activate new item if given
     if (item) {
       setStickyState(item, 'active');
     }

     self.current = item;
     var index = self.items.indexOf(item);
     // If index === -1, index + 1 = 0. It works out.
     self.next = self.items[index + 1];
     self.prev = self.items[index - 1];
     setStickyState(self.next, 'next');
     setStickyState(self.prev, 'prev');
   }

   function setStickyState(item, state) {
     if (!item || item.state === state) return;
     if (item.state) {
       item.clone.attr('sticky-prev-state', item.state);
       item.element.attr('sticky-prev-state', item.state);
     }
     item.clone.attr('sticky-state', state);
     item.element.attr('sticky-state', state);
     item.state = state;
   }

   function translate(item, amount) {
     if (!item) return;
     if (amount === null || amount === undefined) {
       if (item.translateY) {
         item.translateY = null;
         item.clone.css($mdConstant.CSS.TRANSFORM, '');
       }
     } else {
       item.translateY = amount;
       item.clone.css(
         $mdConstant.CSS.TRANSFORM, 
         'translate3d(' + item.left + 'px,' + amount + 'px,0)'
       );
     }
   }
  }

  // Function to check for browser sticky support
  function checkStickySupport($el) {
    var stickyProp;
    var testEl = angular.element('<div>');
    $document[0].body.appendChild(testEl[0]);

    var stickyProps = ['sticky', '-webkit-sticky'];
    for (var i = 0; i < stickyProps.length; ++i) {
      testEl.css({position: stickyProps[i], top: 0, 'z-index': 2});
      if (testEl.css('position') == stickyProps[i]) {
        stickyProp = stickyProps[i];
        break;
      }
    }
    testEl.remove();
    return stickyProp;
  }

  // Android 4.4 don't accurately give scroll events.
  // To fix this problem, we setup a fake scroll event. We say:
  // > If a scroll or touchmove event has happened in the last DELAY milliseconds, 
  //   then send a `$scroll` event every animationFrame.
  // Additionally, we add $scrollstart and $scrollend events.
  function setupAugmentedScrollEvents(element) {
    var SCROLL_END_DELAY = 200;
    var isScrolling;
    var lastScrollTime;
    element.on('scroll touchmove', function() {
      if (!isScrolling) {
        isScrolling = true;
        $$rAF(loopScrollEvent);
        element.triggerHandler('$scrollstart');
      }
      element.triggerHandler('$scroll');
      lastScrollTime = +$mdUtil.now();
    });

    function loopScrollEvent() {
      if (+$mdUtil.now() - lastScrollTime > SCROLL_END_DELAY) {
        isScrolling = false;
        element.triggerHandler('$scrollend');
      } else {
        element.triggerHandler('$scroll');
        $$rAF(loopScrollEvent);
      }
    }
  }

}
MdSticky.$inject = ["$document", "$mdConstant", "$compile", "$$rAF", "$mdUtil"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.subheader
 * @description
 * SubHeader module
 *
 *  Subheaders are special list tiles that delineate distinct sections of a
 *  list or grid list and are typically related to the current filtering or
 *  sorting criteria. Subheader tiles are either displayed inline with tiles or
 *  can be associated with content, for example, in an adjacent column.
 *
 *  Upon scrolling, subheaders remain pinned to the top of the screen and remain
 *  pinned until pushed on or off screen by the next subheader. @see [Material
 *  Design Specifications](https://www.google.com/design/spec/components/subheaders.html)
 *
 *  > To improve the visual grouping of content, use the system color for your subheaders.
 *
 */
angular.module('material.components.subheader', [
  'material.core',
  'material.components.sticky'
])
  .directive('mdSubheader', MdSubheaderDirective);

/**
 * @ngdoc directive
 * @name mdSubheader
 * @module material.components.subheader
 *
 * @restrict E
 *
 * @description
 * The `<md-subheader>` directive is a subheader for a section. By default it is sticky.
 * You can make it not sticky by applying the `md-no-sticky` class to the subheader.
 *
 *
 * @usage
 * <hljs lang="html">
 * <md-subheader>Online Friends</md-subheader>
 * </hljs>
 */

function MdSubheaderDirective($mdSticky, $compile, $mdTheming) {
  return {
    restrict: 'E',
    replace: true,
    transclude: true,
    template: 
      '<h2 class="md-subheader">' +
        '<div class="md-subheader-inner">' +
          '<span class="md-subheader-content"></span>' +
        '</div>' +
      '</h2>',
    compile: function(element, attr, transclude) {
      return function postLink(scope, element, attr) {
        $mdTheming(element);
        var outerHTML = element[0].outerHTML;

        function getContent(el) {
          return angular.element(el[0].querySelector('.md-subheader-content'));
        }

        // Transclude the user-given contents of the subheader
        // the conventional way.
        transclude(scope, function(clone) {
          getContent(element).append(clone);
        });

        // Create another clone, that uses the outer and inner contents
        // of the element, that will be 'stickied' as the user scrolls.
        if (!element.hasClass('md-no-sticky')) {
          transclude(scope, function(clone) {
            var stickyClone = $compile(angular.element(outerHTML))(scope);
            getContent(stickyClone).append(clone);
            $mdSticky(scope, element, stickyClone);
          });
        }
      };
    }
  };
}
MdSubheaderDirective.$inject = ["$mdSticky", "$compile", "$mdTheming"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.swipe
 * @description Swipe module!
 */
/**
 * @ngdoc directive
 * @module material.components.swipe
 * @name mdSwipeLeft
 *
 * @restrict A
 *
 * @description
 * The md-swipe-left directives allows you to specify custom behavior when an element is swiped
 * left.
 *
 * @usage
 * <hljs lang="html">
 * <div md-swipe-left="onSwipeLeft()">Swipe me left!</div>
 * </hljs>
 */
/**
 * @ngdoc directive
 * @module material.components.swipe
 * @name mdSwipeRight
 *
 * @restrict A
 *
 * @description
 * The md-swipe-right directives allows you to specify custom behavior when an element is swiped
 * right.
 *
 * @usage
 * <hljs lang="html">
 * <div md-swipe-right="onSwipeRight()">Swipe me right!</div>
 * </hljs>
 */

angular.module('material.components.swipe', ['material.core'])
    .directive('mdSwipeLeft', getDirective('SwipeLeft'))
    .directive('mdSwipeRight', getDirective('SwipeRight'));

function getDirective(name) {
  var directiveName = 'md' + name;
  var eventName = '$md.' + name.toLowerCase();

    DirectiveFactory.$inject = ["$parse"];
  return DirectiveFactory;

  /* @ngInject */
  function DirectiveFactory($parse) {
      return { restrict: 'A', link: postLink };
      function postLink(scope, element, attr) {
        var fn = $parse(attr[directiveName]);
        element.on(eventName, function(ev) {
          scope.$apply(function() { fn(scope, { $event: ev }); });
        });
      }
    }
}



})();
(function(){
"use strict";

/**
 * @private
 * @ngdoc module
 * @name material.components.switch
 */

angular.module('material.components.switch', [
  'material.core',
  'material.components.checkbox'
])
  .directive('mdSwitch', MdSwitch);

/**
 * @private
 * @ngdoc directive
 * @module material.components.switch
 * @name mdSwitch
 * @restrict E
 *
 * The switch directive is used very much like the normal [angular checkbox](https://docs.angularjs.org/api/ng/input/input%5Bcheckbox%5D).
 *
 * As per the [material design spec](http://www.google.com/design/spec/style/color.html#color-ui-color-application)
 * the switch is in the accent color by default. The primary color palette may be used with
 * the `md-primary` class.
 *
 * @param {string} ng-model Assignable angular expression to data-bind to.
 * @param {string=} name Property name of the form under which the control is published.
 * @param {expression=} ng-true-value The value to which the expression should be set when selected.
 * @param {expression=} ng-false-value The value to which the expression should be set when not selected.
 * @param {string=} ng-change Angular expression to be executed when input changes due to user interaction with the input element.
 * @param {boolean=} md-no-ink Use of attribute indicates use of ripple ink effects.
 * @param {string=} aria-label Publish the button label used by screen-readers for accessibility. Defaults to the switch's text.
 *
 * @usage
 * <hljs lang="html">
 * <md-switch ng-model="isActive" aria-label="Finished?">
 *   Finished ?
 * </md-switch>
 *
 * <md-switch md-no-ink ng-model="hasInk" aria-label="No Ink Effects">
 *   No Ink Effects
 * </md-switch>
 *
 * <md-switch ng-disabled="true" ng-model="isDisabled" aria-label="Disabled">
 *   Disabled
 * </md-switch>
 *
 * </hljs>
 */
function MdSwitch(mdCheckboxDirective, $mdTheming, $mdUtil, $document, $mdConstant, $parse, $$rAF, $mdGesture) {
  var checkboxDirective = mdCheckboxDirective[0];

  return {
    restrict: 'E',
    priority:210, // Run before ngAria
    transclude: true,
    template:
      '<div class="md-container">' +
        '<div class="md-bar"></div>' +
        '<div class="md-thumb-container">' +
          '<div class="md-thumb" md-ink-ripple md-ink-ripple-checkbox></div>' +
        '</div>'+
      '</div>' +
      '<div ng-transclude class="md-label">' +
      '</div>',
    require: '?ngModel',
    compile: compile
  };

  function compile(element, attr) {
    var checkboxLink = checkboxDirective.compile(element, attr);
    // no transition on initial load
    element.addClass('md-dragging');

    return function (scope, element, attr, ngModel) {
      ngModel = ngModel || $mdUtil.fakeNgModel();
      var disabledGetter = $parse(attr.ngDisabled);
      var thumbContainer = angular.element(element[0].querySelector('.md-thumb-container'));
      var switchContainer = angular.element(element[0].querySelector('.md-container'));

      // no transition on initial load
      $$rAF(function() {
        element.removeClass('md-dragging');
      });

      checkboxLink(scope, element, attr, ngModel);

      if (angular.isDefined(attr.ngDisabled)) {
        scope.$watch(disabledGetter, function(isDisabled) {
          element.attr('tabindex', isDisabled ? -1 : 0);
        });
      }

      // These events are triggered by setup drag
      $mdGesture.register(switchContainer, 'drag');
      switchContainer
        .on('$md.dragstart', onDragStart)
        .on('$md.drag', onDrag)
        .on('$md.dragend', onDragEnd);

      var drag;
      function onDragStart(ev) {
        // Don't go if ng-disabled===true
        if (disabledGetter(scope)) return;
        ev.stopPropagation();

        element.addClass('md-dragging');
        drag = {
          width: thumbContainer.prop('offsetWidth')
        };
        element.removeClass('transition');
      }

      function onDrag(ev) {
        if (!drag) return;
        ev.stopPropagation();
        ev.srcEvent && ev.srcEvent.preventDefault();

        var percent = ev.pointer.distanceX / drag.width;

        //if checked, start from right. else, start from left
        var translate = ngModel.$viewValue ?  1 + percent : percent;
        // Make sure the switch stays inside its bounds, 0-1%
        translate = Math.max(0, Math.min(1, translate));

        thumbContainer.css($mdConstant.CSS.TRANSFORM, 'translate3d(' + (100*translate) + '%,0,0)');
        drag.translate = translate;
      }

      function onDragEnd(ev) {
        if (!drag) return;
        ev.stopPropagation();

        element.removeClass('md-dragging');
        thumbContainer.css($mdConstant.CSS.TRANSFORM, '');

        // We changed if there is no distance (this is a click a click),
        // or if the drag distance is >50% of the total.
        var isChanged = ngModel.$viewValue ? drag.translate < 0.5 : drag.translate > 0.5;
        if (isChanged) {
          applyModelValue(!ngModel.$viewValue);
        }
        drag = null;
      }

      function applyModelValue(newValue) {
        scope.$apply(function() {
          ngModel.$setViewValue(newValue);
          ngModel.$render();
        });
      }

    };
  }


}
MdSwitch.$inject = ["mdCheckboxDirective", "$mdTheming", "$mdUtil", "$document", "$mdConstant", "$parse", "$$rAF", "$mdGesture"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.tabs
 * @description
 *
 *  Tabs, created with the `<md-tabs>` directive provide *tabbed* navigation with different styles.
 *  The Tabs component consists of clickable tabs that are aligned horizontally side-by-side.
 *
 *  Features include support for:
 *
 *  - static or dynamic tabs,
 *  - responsive designs,
 *  - accessibility support (ARIA),
 *  - tab pagination,
 *  - external or internal tab content,
 *  - focus indicators and arrow-key navigations,
 *  - programmatic lookup and access to tab controllers, and
 *  - dynamic transitions through different tab contents.
 *
 */
/*
 * @see js folder for tabs implementation
 */
angular.module('material.components.tabs', [
  'material.core',
  'material.components.icon'
]);

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.toast
 * @description
 * Toast
 */
angular.module('material.components.toast', [
  'material.core',
  'material.components.button'
])
  .directive('mdToast', MdToastDirective)
  .provider('$mdToast', MdToastProvider);

function MdToastDirective() {
  return {
    restrict: 'E'
  };
}

/**
 * @ngdoc service
 * @name $mdToast
 * @module material.components.toast
 *
 * @description
 * `$mdToast` is a service to build a toast notification on any position
 * on the screen with an optional duration, and provides a simple promise API.
 *
 *
 * ## Restrictions on custom toasts
 * - The toast's template must have an outer `<md-toast>` element.
 * - For a toast action, use element with class `md-action`.
 * - Add the class `md-capsule` for curved corners.
 *
 * @usage
 * <hljs lang="html">
 * <div ng-controller="MyController">
 *   <md-button ng-click="openToast()">
 *     Open a Toast!
 *   </md-button>
 * </div>
 * </hljs>
 *
 * <hljs lang="js">
 * var app = angular.module('app', ['ngMaterial']);
 * app.controller('MyController', function($scope, $mdToast) {
 *   $scope.openToast = function($event) {
 *     $mdToast.show($mdToast.simple().content('Hello!'));
 *     // Could also do $mdToast.showSimple('Hello');
 *   };
 * });
 * </hljs>
 */

/**
 * @ngdoc method
 * @name $mdToast#showSimple
 * 
 * @description
 * Convenience method which builds and shows a simple toast.
 *
 * @returns {promise} A promise that can be resolved with `$mdToast.hide()` or
 * rejected with `$mdToast.cancel()`.
 *
 */

 /**
 * @ngdoc method
 * @name $mdToast#simple
 *
 * @description
 * Builds a preconfigured toast.
 *
 * @returns {obj} a `$mdToastPreset` with the chainable configuration methods:
 *
 * - $mdToastPreset#content(string) - sets toast content to string
 * - $mdToastPreset#action(string) - adds an action button, which resolves the promise returned from `show()` if clicked.
 * - $mdToastPreset#highlightAction(boolean) - sets action button to be highlighted
 * - $mdToastPreset#capsule(boolean) - adds 'md-capsule' class to the toast (curved corners)
 * - $mdToastPreset#theme(string) - sets the theme on the toast to theme (default is `$mdThemingProvider`'s default theme)
 */

/**
 * @ngdoc method
 * @name $mdToast#updateContent
 * 
 * @description
 * Updates the content of an existing toast. Useful for updating things like counts, etc.
 *
 */

 /**
 * @ngdoc method
 * @name $mdToast#build
 *
 * @description
 * Creates a custom `$mdToastPreset` that you can configure.
 *
 * @returns {obj} a `$mdToastPreset` with the chainable configuration methods for shows' options (see below).
 */

 /**
 * @ngdoc method
 * @name $mdToast#show
 *
 * @description Shows the toast.
 *
 * @param {object} optionsOrPreset Either provide an `$mdToastPreset` returned from `simple()`
 * and `build()`, or an options object with the following properties:
 *
 *   - `templateUrl` - `{string=}`: The url of an html template file that will
 *     be used as the content of the toast. Restrictions: the template must
 *     have an outer `md-toast` element.
 *   - `template` - `{string=}`: Same as templateUrl, except this is an actual
 *     template string.
 *   - `scope` - `{object=}`: the scope to link the template / controller to. If none is specified, it will create a new child scope.
 *     This scope will be destroyed when the toast is removed unless `preserveScope` is set to true.
 *   - `preserveScope` - `{boolean=}`: whether to preserve the scope when the element is removed. Default is false
 *   - `hideDelay` - `{number=}`: How many milliseconds the toast should stay
 *     active before automatically closing.  Set to 0 or false to have the toast stay open until
 *     closed manually. Default: 3000.
 *   - `position` - `{string=}`: Where to place the toast. Available: any combination
 *     of 'bottom', 'left', 'top', 'right', 'fit'. Default: 'bottom left'.
 *   - `controller` - `{string=}`: The controller to associate with this toast.
 *     The controller will be injected the local `$hideToast`, which is a function
 *     used to hide the toast.
 *   - `locals` - `{string=}`: An object containing key/value pairs. The keys will
 *     be used as names of values to inject into the controller. For example,
 *     `locals: {three: 3}` would inject `three` into the controller with the value
 *     of 3.
 *   - `bindToController` - `bool`: bind the locals to the controller, instead of passing them in. These values will not be available until after initialization.
 *   - `resolve` - `{object=}`: Similar to locals, except it takes promises as values
 *     and the toast will not open until the promises resolve.
 *   - `controllerAs` - `{string=}`: An alias to assign the controller to on the scope.
 *   - `parent` - `{element=}`: The element to append the toast to. Defaults to appending
 *     to the root element of the application.
 *
 * @returns {promise} A promise that can be resolved with `$mdToast.hide()` or
 * rejected with `$mdToast.cancel()`.
 */

/**
 * @ngdoc method
 * @name $mdToast#hide
 *
 * @description
 * Hide an existing toast and resolve the promise returned from `$mdToast.show()`.
 *
 * @param {*=} response An argument for the resolved promise.
 *
 * @returns {promise} a promise that is called when the existing element is removed from the DOM
 *
 */

/**
 * @ngdoc method
 * @name $mdToast#cancel
 *
 * @description
 * Hide the existing toast and reject the promise returned from
 * `$mdToast.show()`.
 *
 * @param {*=} response An argument for the rejected promise.
 *
 * @returns {promise} a promise that is called when the existing element is removed from the DOM
 *
 */

function MdToastProvider($$interimElementProvider) {
  var activeToastContent;
  var $mdToast = $$interimElementProvider('$mdToast')
    .setDefaults({
      methods: ['position', 'hideDelay', 'capsule' ],
      options: toastDefaultOptions
    })
    .addPreset('simple', {
      argOption: 'content',
      methods: ['content', 'action', 'highlightAction', 'theme', 'parent'],
      options: /* @ngInject */ ["$mdToast", "$mdTheming", function($mdToast, $mdTheming) {
        var opts = {
          template: [
            '<md-toast md-theme="{{ toast.theme }}" ng-class="{\'md-capsule\': toast.capsule}">',
              '<span flex>{{ toast.content }}</span>',
              '<md-button class="md-action" ng-if="toast.action" ng-click="toast.resolve()" ng-class="{\'md-highlight\': toast.highlightAction}">',
                '{{ toast.action }}',
              '</md-button>',
            '</md-toast>'
          ].join(''),
          controller: /* @ngInject */ ["$scope", function mdToastCtrl($scope) {
            var self = this;
            $scope.$watch(function() { return activeToastContent; }, function() {
              self.content = activeToastContent;
            });
            this.resolve = function() {
              $mdToast.hide();
            };
          }],
          theme: $mdTheming.defaultTheme(),
          controllerAs: 'toast',
          bindToController: true
        };
        return opts;
      }]
    })
    .addMethod('updateContent', function(newContent) {
      activeToastContent = newContent;
    });

  toastDefaultOptions.$inject = ["$timeout", "$animate", "$mdToast", "$mdUtil"];
    return $mdToast;

  /* @ngInject */
  function toastDefaultOptions($timeout, $animate, $mdToast, $mdUtil) {
    return {
      onShow: onShow,
      onRemove: onRemove,
      position: 'bottom left',
      themable: true,
      hideDelay: 3000
    };

    function onShow(scope, element, options) {
      element = $mdUtil.extractElementByName(element, 'md-toast');

      // 'top left' -> 'md-top md-left'
      activeToastContent = options.content;
      element.addClass(options.position.split(' ').map(function(pos) {
        return 'md-' + pos;
      }).join(' '));
      options.parent.addClass(toastOpenClass(options.position));

      options.onSwipe = function(ev, gesture) {
        //Add swipeleft/swiperight class to element so it can animate correctly
        element.addClass('md-' + ev.type.replace('$md.',''));
        $timeout($mdToast.cancel);
      };
      element.on('$md.swipeleft $md.swiperight', options.onSwipe);
      return $animate.enter(element, options.parent);
    }

    function onRemove(scope, element, options) {
      element.off('$md.swipeleft $md.swiperight', options.onSwipe);
      options.parent.removeClass(toastOpenClass(options.position));
      return $animate.leave(element);
    }

    function toastOpenClass(position) {
      return 'md-toast-open-' +
        (position.indexOf('top') > -1 ? 'top' : 'bottom');
    }
  }

}
MdToastProvider.$inject = ["$$interimElementProvider"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.toolbar
 */
angular.module('material.components.toolbar', [
  'material.core',
  'material.components.content'
])
  .directive('mdToolbar', mdToolbarDirective);

/**
 * @ngdoc directive
 * @name mdToolbar
 * @module material.components.toolbar
 * @restrict E
 * @description
 * `md-toolbar` is used to place a toolbar in your app.
 *
 * Toolbars are usually used above a content area to display the title of the
 * current page, and show relevant action buttons for that page.
 *
 * You can change the height of the toolbar by adding either the
 * `md-medium-tall` or `md-tall` class to the toolbar.
 *
 * @usage
 * <hljs lang="html">
 * <div layout="column" layout-fill>
 *   <md-toolbar>
 *
 *     <div class="md-toolbar-tools">
 *       <span>My App's Title</span>
 *
 *       <!-- fill up the space between left and right area -->
 *       <span flex></span>
 *
 *       <md-button>
 *         Right Bar Button
 *       </md-button>
 *     </div>
 *
 *   </md-toolbar>
 *   <md-content>
 *     Hello!
 *   </md-content>
 * </div>
 * </hljs>
 *
 * @param {boolean=} md-scroll-shrink Whether the header should shrink away as
 * the user scrolls down, and reveal itself as the user scrolls up.
 * Note: for scrollShrink to work, the toolbar must be a sibling of a
 * `md-content` element, placed before it. See the scroll shrink demo.
 *
 *
 * @param {number=} md-shrink-speed-factor How much to change the speed of the toolbar's
 * shrinking by. For example, if 0.25 is given then the toolbar will shrink
 * at one fourth the rate at which the user scrolls down. Default 0.5.
 */
function mdToolbarDirective($$rAF, $mdConstant, $mdUtil, $mdTheming, $animate, $timeout) {

  return {
    restrict: 'E',
    controller: angular.noop,
    link: function(scope, element, attr) {
      $mdTheming(element);

      if (angular.isDefined(attr.mdScrollShrink)) {
        setupScrollShrink();
      }

      function setupScrollShrink() {
        // Current "y" position of scroll
        var y = 0;
        // Store the last scroll top position
        var prevScrollTop = 0;

        var shrinkSpeedFactor = attr.mdShrinkSpeedFactor || 0.5;

        var toolbarHeight;
        var contentElement;

        var debouncedContentScroll = $$rAF.throttle(onContentScroll);
        var debouncedUpdateHeight = $mdUtil.debounce(updateToolbarHeight, 5 * 1000);

        // Wait for $mdContentLoaded event from mdContent directive.
        // If the mdContent element is a sibling of our toolbar, hook it up
        // to scroll events.
        scope.$on('$mdContentLoaded', onMdContentLoad);

        function onMdContentLoad($event, newContentEl) {
          // Toolbar and content must be siblings
          if (element.parent()[0] === newContentEl.parent()[0]) {
            // unhook old content event listener if exists
            if (contentElement) {
              contentElement.off('scroll', debouncedContentScroll);
            }

            newContentEl.on('scroll', debouncedContentScroll);
            newContentEl.attr('scroll-shrink', 'true');

            contentElement = newContentEl;
            $$rAF(updateToolbarHeight);
          }
        }

        function updateToolbarHeight() {
          toolbarHeight = element.prop('offsetHeight');
          // Add a negative margin-top the size of the toolbar to the content el.
          // The content will start transformed down the toolbarHeight amount,
          // so everything looks normal.
          //
          // As the user scrolls down, the content will be transformed up slowly
          // to put the content underneath where the toolbar was.
          var margin =  (-toolbarHeight * shrinkSpeedFactor) + 'px';
          contentElement.css('margin-top', margin);
          contentElement.css('margin-bottom', margin);

          onContentScroll();
        }

        function onContentScroll(e) {
          var scrollTop = e ? e.target.scrollTop : prevScrollTop;

          debouncedUpdateHeight();

          y = Math.min(
            toolbarHeight / shrinkSpeedFactor,
            Math.max(0, y + scrollTop - prevScrollTop)
          );

          element.css(
            $mdConstant.CSS.TRANSFORM,
            'translate3d(0,' + (-y * shrinkSpeedFactor) + 'px,0)'
          );
          contentElement.css(
            $mdConstant.CSS.TRANSFORM,
            'translate3d(0,' + ((toolbarHeight - y) * shrinkSpeedFactor) + 'px,0)'
          );

          prevScrollTop = scrollTop;

            if (element.hasClass('md-whiteframe-z1')) {
              if (!y) {
                $timeout(function () { $animate.removeClass(element, 'md-whiteframe-z1'); });
              }
            } else {
              if (y) {
                $timeout(function () { $animate.addClass(element, 'md-whiteframe-z1'); });
              }
            }
        }

      }

    }
  };

}
mdToolbarDirective.$inject = ["$$rAF", "$mdConstant", "$mdUtil", "$mdTheming", "$animate", "$timeout"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.tooltip
 */
angular
    .module('material.components.tooltip', [ 'material.core' ])
    .directive('mdTooltip', MdTooltipDirective);

/**
 * @ngdoc directive
 * @name mdTooltip
 * @module material.components.tooltip
 * @description
 * Tooltips are used to describe elements that are interactive and primarily graphical (not textual).
 *
 * Place a `<md-tooltip>` as a child of the element it describes.
 *
 * A tooltip will activate when the user focuses, hovers over, or touches the parent.
 *
 * @usage
 * <hljs lang="html">
 * <md-button class="md-fab md-accent" aria-label="Play">
 *   <md-tooltip>
 *     Play Music
 *   </md-tooltip>
 *   <md-icon icon="img/icons/ic_play_arrow_24px.svg"></md-icon>
 * </md-button>
 * </hljs>
 *
 * @param {expression=} md-visible Boolean bound to whether the tooltip is
 * currently visible.
 * @param {number=} md-delay How many milliseconds to wait to show the tooltip after the user focuses, hovers, or touches the parent. Defaults to 400ms.
 * @param {string=} md-direction Which direction would you like the tooltip to go?  Supports left, right, top, and bottom.  Defaults to bottom.
 * @param {boolean=} md-autohide If present or provided with a boolean value, the tooltip will hide on mouse leave, regardless of focus
 */
function MdTooltipDirective($timeout, $window, $$rAF, $document, $mdUtil, $mdTheming, $rootElement,
                            $animate, $q) {

  var TOOLTIP_SHOW_DELAY = 300;
  var TOOLTIP_WINDOW_EDGE_SPACE = 8;

  return {
    restrict: 'E',
    transclude: true,
    priority:210, // Before ngAria
    template: '\
        <div class="md-background"></div>\
        <div class="md-content" ng-transclude></div>',
    scope: {
      visible: '=?mdVisible',
      delay: '=?mdDelay',
      autohide: '=?mdAutohide'
    },
    link: postLink
  };

  function postLink(scope, element, attr) {

    $mdTheming(element);

    var parent        = getParentWithPointerEvents(),
        background    = angular.element(element[0].getElementsByClassName('md-background')[0]),
        content       = angular.element(element[0].getElementsByClassName('md-content')[0]),
        direction     = attr.mdDirection,
        current       = getNearestContentElement(),
        tooltipParent = angular.element(current || document.body),
        debouncedOnResize = $$rAF.throttle(function () { if (scope.visible) positionTooltip(); });

    return init();

    function init () {
      setDefaults();
      manipulateElement();
      bindEvents();
      configureWatchers();
      addAriaLabel();
    }

    function setDefaults () {
      if (!angular.isDefined(attr.mdDelay)) scope.delay = TOOLTIP_SHOW_DELAY;
    }

    function configureWatchers () {
      scope.$on('$destroy', function() {
        scope.visible = false;
        element.remove();
        angular.element($window).off('resize', debouncedOnResize);
      });
      scope.$watch('visible', function (isVisible) {
        if (isVisible) showTooltip();
        else hideTooltip();
      });
    }

    function addAriaLabel () {
      if (!parent.attr('aria-label') && !parent.text().trim()) {
        parent.attr('aria-label', element.text().trim());
      }
    }

    function manipulateElement () {
      element.detach();
      element.attr('role', 'tooltip');
    }

    function getParentWithPointerEvents () {
      var parent = element.parent();
      while (parent && $window.getComputedStyle(parent[0])['pointer-events'] == 'none') {
        parent = parent.parent();
      }
      return parent;
    }

     function getNearestContentElement () {
       var current = element.parent()[0];
       // Look for the nearest parent md-content, stopping at the rootElement.
       while (current && current !== $rootElement[0] && current !== document.body) {
         current = current.parentNode;
       }
       return current;
     }

    function hasComputedStyleValue(key, value) {
        // Check if we should show it or not...
        var computedStyles = $window.getComputedStyle(element[0]);
        return angular.isDefined(computedStyles[key]) && (computedStyles[key] == value);
    }

    function bindEvents () {
      var mouseActive = false;
      var enterHandler = function() {
        if (!hasComputedStyleValue('pointer-events','none')) {
          setVisible(true);
        }
      };
      var leaveHandler = function () {
        var autohide = scope.hasOwnProperty('autohide') ? scope.autohide : attr.hasOwnProperty('mdAutohide');
        if (autohide || mouseActive || ($document[0].activeElement !== parent[0]) ) {
          setVisible(false);
        }
        mouseActive = false;
      };

      // to avoid `synthetic clicks` we listen to mousedown instead of `click`
      parent.on('mousedown', function() { mouseActive = true; });
      parent.on('focus mouseenter touchstart', enterHandler );
      parent.on('blur mouseleave touchend touchcancel', leaveHandler );


      angular.element($window).on('resize', debouncedOnResize);
    }

    function setVisible (value) {
      setVisible.value = !!value;
      if (!setVisible.queued) {
        if (value) {
          setVisible.queued = true;
          $timeout(function() {
            scope.visible = setVisible.value;
            setVisible.queued = false;
          }, scope.delay);
        } else {
          $timeout(function() { scope.visible = false; });
        }
      }
    }

    function showTooltip() {
      // Insert the element before positioning it, so we can get the position
      // and check if we should display it
      tooltipParent.append(element);

      // Check if we should display it or not.
      // This handles hide-* and show-* along with any user defined css
      if ( hasComputedStyleValue('display','none') ) {
        scope.visible = false;
        element.detach();
        return;
      }

      positionTooltip();
      angular.forEach([element, background, content], function (element) {
        $animate.addClass(element, 'md-show');
      });
    }

    function hideTooltip() {
      $q.all([
        $animate.removeClass(content, 'md-show'),
        $animate.removeClass(background, 'md-show'),
        $animate.removeClass(element, 'md-show')
      ]).then(function () {
        if (!scope.visible) element.detach();
      });
    }

    function positionTooltip() {
      var tipRect = $mdUtil.offsetRect(element, tooltipParent);
      var parentRect = $mdUtil.offsetRect(parent, tooltipParent);
      var newPosition = getPosition(direction);

      // If the user provided a direction, just nudge the tooltip onto the screen
      // Otherwise, recalculate based on 'top' since default is 'bottom'
      if (direction) {
        newPosition = fitInParent(newPosition);
      } else if (newPosition.top > element.prop('offsetParent').scrollHeight - tipRect.height - TOOLTIP_WINDOW_EDGE_SPACE) {
        newPosition = fitInParent(getPosition('top'));
      }

      element.css({top: newPosition.top + 'px', left: newPosition.left + 'px'});

      positionBackground();

      function positionBackground () {
        var size = direction === 'left' || direction === 'right'
              ? Math.sqrt(Math.pow(tipRect.width, 2) + Math.pow(tipRect.height / 2, 2)) * 2
              : Math.sqrt(Math.pow(tipRect.width / 2, 2) + Math.pow(tipRect.height, 2)) * 2,
            position = direction === 'left' ? { left: 100, top: 50 }
              : direction === 'right' ? { left: 0, top: 50 }
              : direction === 'top' ? { left: 50, top: 100 }
              : { left: 50, top: 0 };
        background.css({
          width: size + 'px',
          height: size + 'px',
          left: position.left + '%',
          top: position.top + '%'
        });
      }

      function fitInParent (pos) {
        var newPosition = { left: pos.left, top: pos.top };
        newPosition.left = Math.min( newPosition.left, tooltipParent.prop('scrollWidth') - tipRect.width - TOOLTIP_WINDOW_EDGE_SPACE );
        newPosition.left = Math.max( newPosition.left, TOOLTIP_WINDOW_EDGE_SPACE );
        newPosition.top  = Math.min( newPosition.top,  tooltipParent.prop('scrollHeight') - tipRect.height - TOOLTIP_WINDOW_EDGE_SPACE );
        newPosition.top  = Math.max( newPosition.top,  TOOLTIP_WINDOW_EDGE_SPACE );
        return newPosition;
      }

      function getPosition (dir) {
        return dir === 'left'
          ? { left: parentRect.left - tipRect.width - TOOLTIP_WINDOW_EDGE_SPACE,
              top: parentRect.top + parentRect.height / 2 - tipRect.height / 2 }
          : dir === 'right'
          ? { left: parentRect.left + parentRect.width + TOOLTIP_WINDOW_EDGE_SPACE,
              top: parentRect.top + parentRect.height / 2 - tipRect.height / 2 }
          : dir === 'top'
          ? { left: parentRect.left + parentRect.width / 2 - tipRect.width / 2,
              top: parentRect.top - tipRect.height - TOOLTIP_WINDOW_EDGE_SPACE }
          : { left: parentRect.left + parentRect.width / 2 - tipRect.width / 2,
              top: parentRect.top + parentRect.height + TOOLTIP_WINDOW_EDGE_SPACE };
      }
    }

  }

}
MdTooltipDirective.$inject = ["$timeout", "$window", "$$rAF", "$document", "$mdUtil", "$mdTheming", "$rootElement", "$animate", "$q"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.whiteframe
 */
angular.module('material.components.whiteframe', []);

})();
(function(){
"use strict";

angular
    .module('material.components.autocomplete')
    .controller('MdAutocompleteCtrl', MdAutocompleteCtrl);

var ITEM_HEIGHT = 41,
    MAX_HEIGHT = 5.5 * ITEM_HEIGHT,
    MENU_PADDING = 8;

function MdAutocompleteCtrl ($scope, $element, $mdUtil, $mdConstant, $timeout, $mdTheming, $window,
                             $animate, $rootElement, $attrs) {
  //-- private variables
  var ctrl      = this,
      itemParts = $scope.itemsExpr.split(/ in /i),
      itemExpr  = itemParts[1],
      elements  = null,
      promise   = null,
      cache     = {},
      noBlur    = false,
      selectedItemWatchers = [],
      hasFocus  = false,
      lastCount = 0;

  //-- public variables with handlers
  defineProperty('hidden', handleHiddenChange, true);

  //-- public variables
  ctrl.scope      = $scope;
  ctrl.parent     = $scope.$parent;
  ctrl.itemName   = itemParts[0];
  ctrl.matches    = [];
  ctrl.loading    = false;
  ctrl.hidden     = true;
  ctrl.index      = null;
  ctrl.messages   = [];
  ctrl.id         = $mdUtil.nextUid();
  ctrl.isDisabled = null;
  ctrl.isRequired = null;

  //-- public methods
  ctrl.keydown    = keydown;
  ctrl.blur       = blur;
  ctrl.focus      = focus;
  ctrl.clear      = clearValue;
  ctrl.select     = select;
  ctrl.listEnter  = onListEnter;
  ctrl.listLeave  = onListLeave;
  ctrl.mouseUp    = onMouseup;
  ctrl.getCurrentDisplayValue         = getCurrentDisplayValue;
  ctrl.registerSelectedItemWatcher    = registerSelectedItemWatcher;
  ctrl.unregisterSelectedItemWatcher  = unregisterSelectedItemWatcher;

  return init();

  //-- initialization methods

  /**
   * Initialize the controller, setup watchers, gather elements
   */
  function init () {
    $mdUtil.initOptionalProperties($scope, $attrs, { searchText: null, selectedItem: null } );
    $mdTheming($element);
    configureWatchers();
    $timeout(function () {
      gatherElements();
      focusElement();
      moveDropdown();
    });
  }

  /**
   * Calculates the dropdown's position and applies the new styles to the menu element
   * @returns {*}
   */
  function positionDropdown () {
    if (!elements) return $timeout(positionDropdown, 0, false);
    var hrect  = elements.wrap.getBoundingClientRect(),
        vrect  = elements.snap.getBoundingClientRect(),
        root   = elements.root.getBoundingClientRect(),
        top    = vrect.bottom - root.top,
        bot    = root.bottom - vrect.top,
        left   = hrect.left - root.left,
        width  = hrect.width,
        styles = {
          left:     left + 'px',
          minWidth: width + 'px',
          maxWidth: Math.max(hrect.right - root.left, root.right - hrect.left) - MENU_PADDING + 'px'
        };
    if (top > bot && root.height - hrect.bottom - MENU_PADDING < MAX_HEIGHT) {
      styles.top = 'auto';
      styles.bottom = bot + 'px';
      styles.maxHeight = Math.min(MAX_HEIGHT, hrect.top - root.top - MENU_PADDING) + 'px';
    } else {
      styles.top = top + 'px';
      styles.bottom = 'auto';
      styles.maxHeight = Math.min(MAX_HEIGHT, root.bottom - hrect.bottom - MENU_PADDING) + 'px';
    }
    elements.$.ul.css(styles);
    $timeout(correctHorizontalAlignment, 0, false);

    /**
     * Makes sure that the menu doesn't go off of the screen on either side.
     */
    function correctHorizontalAlignment () {
      var dropdown = elements.ul.getBoundingClientRect(),
          styles   = {};
      if (dropdown.right > root.right - MENU_PADDING) {
        styles.left = (hrect.right - dropdown.width) + 'px';
      }
      elements.$.ul.css(styles);
    }
  }

  /**
   * Moves the dropdown menu to the body tag in order to avoid z-index and overflow issues.
   */
  function moveDropdown () {
    if (!elements.$.root.length) return;
    $mdTheming(elements.$.ul);
    elements.$.ul.detach();
    elements.$.root.append(elements.$.ul);
    if ($animate.pin) $animate.pin(elements.$.ul, $rootElement);
  }

  /**
   * Sends focus to the input element.
   */
  function focusElement () {
    if ($scope.autofocus) elements.input.focus();
  }

  /**
   * Sets up any watchers used by autocomplete
   */
  function configureWatchers () {
    var wait = parseInt($scope.delay, 10) || 0;
    $attrs.$observe('disabled', function (value) { ctrl.isDisabled = value; });
    $attrs.$observe('required', function (value) { ctrl.isRequired = value !== null; });
    $scope.$watch('searchText', wait ? $mdUtil.debounce(handleSearchText, wait) : handleSearchText);
    registerSelectedItemWatcher(selectedItemChange);
    $scope.$watch('selectedItem', handleSelectedItemChange);
    angular.element($window).on('resize', positionDropdown);
    $scope.$on('$destroy', cleanup);
  }

  /**
   * Removes any events or leftover elements created by this controller
   */
  function cleanup () {
    angular.element($window).off('resize', positionDropdown);
    elements.$.ul.remove();
  }

  /**
   * Gathers all of the elements needed for this controller
   */
  function gatherElements () {
    elements = {
      main:  $element[0],
      ul:    $element.find('ul')[0],
      input: $element.find('input')[0],
      wrap:  $element.find('md-autocomplete-wrap')[0],
      root:  document.body
    };
    elements.li = elements.ul.getElementsByTagName('li');
    elements.snap = getSnapTarget();
    elements.$ = getAngularElements(elements);
  }

  /**
   * Finds the element that the menu will base its position on
   * @returns {*}
   */
  function getSnapTarget () {
    for (var element = $element; element.length; element = element.parent()) {
      if (angular.isDefined(element.attr('md-autocomplete-snap'))) return element[0];
    }
    return elements.wrap;
  }

  /**
   * Gathers angular-wrapped versions of each element
   * @param elements
   * @returns {{}}
   */
  function getAngularElements (elements) {
    var obj = {};
    for (var key in elements) {
      obj[key] = angular.element(elements[key]);
    }
    return obj;
  }

  //-- event/change handlers

  /**
   * Handles changes to the `hidden` property.
   * @param hidden
   * @param oldHidden
   */
  function handleHiddenChange (hidden, oldHidden) {
    if (!hidden && oldHidden) positionDropdown();
    if (!hidden) {
      if (elements) $timeout(function () { $mdUtil.disableScrollAround(elements.ul); }, 0, false);
    } else {
      $mdUtil.enableScrolling();
    }
  }

  /**
   * When the user mouses over the dropdown menu, ignore blur events.
   */
  function onListEnter () {
    noBlur = true;
  }

  /**
   * When the user's mouse leaves the menu, blur events may hide the menu again.
   */
  function onListLeave () {
    noBlur = false;
    if (!hasFocus) ctrl.hidden = true;
  }

  /**
   * When the mouse button is released, send focus back to the input field.
   */
  function onMouseup () {
    elements.input.focus();
  }

  /**
   * Handles changes to the selected item.
   * @param selectedItem
   * @param previousSelectedItem
   */
  function selectedItemChange (selectedItem, previousSelectedItem) {
    if (selectedItem) {
      $scope.searchText = getDisplayValue(selectedItem);
    }
    if (angular.isFunction($scope.itemChange) && selectedItem !== previousSelectedItem)
      $scope.itemChange(getItemScope(selectedItem));
  }

  /**
   * Calls any external watchers listening for the selected item.  Used in conjunction with
   * `registerSelectedItemWatcher`.
   * @param selectedItem
   * @param previousSelectedItem
   */
  function handleSelectedItemChange(selectedItem, previousSelectedItem) {
    for (var i = 0; i < selectedItemWatchers.length; ++i) {
      selectedItemWatchers[i](selectedItem, previousSelectedItem);
    }
  }

  /**
   * Register a function to be called when the selected item changes.
   * @param cb
   */
  function registerSelectedItemWatcher(cb) {
    if (selectedItemWatchers.indexOf(cb) == -1) {
      selectedItemWatchers.push(cb);
    }
  }

  /**
   * Unregister a function previously registered for selected item changes.
   * @param cb
   */
  function unregisterSelectedItemWatcher(cb) {
    var i = selectedItemWatchers.indexOf(cb);
    if (i != -1) {
      selectedItemWatchers.splice(i, 1);
    }
  }

  /**
   * Handles changes to the searchText property.
   * @param searchText
   * @param previousSearchText
   */
  function handleSearchText (searchText, previousSearchText) {
    ctrl.index = getDefaultIndex();
    //-- do nothing on init
    if (searchText === previousSearchText) return;
    //-- clear selected item if search text no longer matches it
    if (searchText !== getDisplayValue($scope.selectedItem)) $scope.selectedItem = null;
    else return;
    //-- trigger change event if available
    if (angular.isFunction($scope.textChange) && searchText !== previousSearchText)
      $scope.textChange(getItemScope($scope.selectedItem));
    //-- cancel results if search text is not long enough
    if (!isMinLengthMet()) {
      ctrl.loading = false;
      ctrl.matches = [];
      ctrl.hidden = shouldHide();
      updateMessages();
    } else {
      handleQuery();
    }
  }

  /**
   * Handles input blur event, determines if the dropdown should hide.
   */
  function blur () {
    hasFocus = false;
    if (!noBlur) ctrl.hidden = true;
  }

  /**
   * Handles input focus event, determines if the dropdown should show.
   */
  function focus () {
    hasFocus = true;
    //-- if searchText is null, let's force it to be a string
    if (!angular.isString($scope.searchText)) $scope.searchText = '';
    if ($scope.minLength > 0) return;
    ctrl.hidden = shouldHide();
    if (!ctrl.hidden) handleQuery();
  }

  /**
   * Handles keyboard input.
   * @param event
   */
  function keydown (event) {
    switch (event.keyCode) {
      case $mdConstant.KEY_CODE.DOWN_ARROW:
        if (ctrl.loading) return;
        event.preventDefault();
        ctrl.index = Math.min(ctrl.index + 1, ctrl.matches.length - 1);
        updateScroll();
        updateMessages();
        break;
      case $mdConstant.KEY_CODE.UP_ARROW:
        if (ctrl.loading) return;
        event.preventDefault();
        ctrl.index = ctrl.index < 0 ? ctrl.matches.length - 1 : Math.max(0, ctrl.index - 1);
        updateScroll();
        updateMessages();
        break;
      case $mdConstant.KEY_CODE.TAB:
      case $mdConstant.KEY_CODE.ENTER:
        if (ctrl.hidden || ctrl.loading || ctrl.index < 0 || ctrl.matches.length < 1) return;
        event.preventDefault();
        select(ctrl.index);
        break;
      case $mdConstant.KEY_CODE.ESCAPE:
        ctrl.matches = [];
        ctrl.hidden = true;
        ctrl.index = getDefaultIndex();
        break;
      default:
    }
  }

  //-- getters

  /**
   * Returns the minimum length needed to display the dropdown.
   * @returns {*}
   */
  function getMinLength () {
    return angular.isNumber($scope.minLength) ? $scope.minLength : 1;
  }

  /**
   * Returns the display value for an item.
   * @param item
   * @returns {*}
   */
  function getDisplayValue (item) {
    return (item && $scope.itemText) ? $scope.itemText(getItemScope(item)) : item;
  }

  /**
   * Returns the locals object for compiling item templates.
   * @param item
   * @returns {{}}
   */
  function getItemScope (item) {
    if (!item) return;
    var locals = {};
    if (ctrl.itemName) locals[ctrl.itemName] = item;
    return locals;
  }

  /**
   * Returns the default index based on whether or not autoselect is enabled.
   * @returns {number}
   */
  function getDefaultIndex () {
    return $scope.autoselect ? 0 : -1;
  }

  /**
   * Determines if the menu should be hidden.
   * @returns {boolean}
   */
  function shouldHide () {
    if (!isMinLengthMet()) return true;
  }

  /**
   * Returns the display value of the current item.
   * @returns {*}
   */
  function getCurrentDisplayValue () {
    return getDisplayValue(ctrl.matches[ctrl.index]);
  }

  /**
   * Determines if the minimum length is met by the search text.
   * @returns {*}
   */
  function isMinLengthMet () {
    return angular.isDefined($scope.searchText) && $scope.searchText.length >= getMinLength();
  }

  //-- actions

  /**
   * Defines a public property with a handler and a default value.
   * @param key
   * @param handler
   * @param value
   */
  function defineProperty (key, handler, value) {
    Object.defineProperty(ctrl, key, {
      get: function () { return value; },
      set: function (newValue) {
        var oldValue = value;
        value = newValue;
        handler(newValue, oldValue);
      }
    });
  }

  /**
   * Selects the item at the given index.
   * @param index
   */
  function select (index) {
    $scope.selectedItem = ctrl.matches[index];
    ctrl.hidden = true;
    ctrl.index = 0;
    ctrl.matches = [];
    //-- force form to update state for validation
    $timeout(function () {
      elements.$.input.controller('ngModel').$setViewValue(getDisplayValue($scope.selectedItem) ||
          $scope.searchText);
      ctrl.hidden = true;
    });
  }

  /**
   * Clears the searchText value and selected item.
   */
  function clearValue () {
    $scope.searchText = '';
    select(-1);

    // Per http://www.w3schools.com/jsref/event_oninput.asp
    var eventObj = document.createEvent('CustomEvent');
    eventObj.initCustomEvent('input', true, true, {value: $scope.searchText});
    elements.input.dispatchEvent(eventObj);

    elements.input.focus();
  }

  /**
   * Fetches the results for the provided search text.
   * @param searchText
   */
  function fetchResults (searchText) {
    var items = $scope.$parent.$eval(itemExpr),
        term = searchText.toLowerCase();
    if (angular.isArray(items)) {
      handleResults(items);
    } else if (items) {
      ctrl.loading = true;
      if (items.success) items.success(handleResults);
      if (items.then)    items.then(handleResults);
      if (items.error)   items.error(function () { ctrl.loading = false; });
    }
    function handleResults (matches) {
      cache[term] = matches;
      if (searchText !== $scope.searchText) return; //-- just cache the results if old request
      ctrl.loading = false;
      promise = null;
      ctrl.matches = matches;
      ctrl.hidden = shouldHide();
      updateMessages();
      positionDropdown();
    }
  }

  /**
   * Updates the ARIA messages
   */
  function updateMessages () {
    ctrl.messages = [ getCountMessage(), getCurrentDisplayValue() ];
  }

  /**
   * Returns the ARIA message for how many results match the current query.
   * @returns {*}
   */
  function getCountMessage () {
    if (lastCount === ctrl.matches.length) return '';
    lastCount = ctrl.matches.length;
    switch (ctrl.matches.length) {
      case 0:  return 'There are no matches available.';
      case 1:  return 'There is 1 match available.';
      default: return 'There are ' + ctrl.matches.length + ' matches available.';
    }
  }

  /**
   * Makes sure that the focused element is within view.
   */
  function updateScroll () {
    if (!elements.li[ctrl.index]) return;
    var li  = elements.li[ctrl.index],
        top = li.offsetTop,
        bot = top + li.offsetHeight,
        hgt = elements.ul.clientHeight;
    if (top < elements.ul.scrollTop) {
      elements.ul.scrollTop = top;
    } else if (bot > elements.ul.scrollTop + hgt) {
      elements.ul.scrollTop = bot - hgt;
    }
  }

  /**
   * Starts the query to gather the results for the current searchText.  Attempts to return cached
   * results first, then forwards the process to `fetchResults` if necessary.
   */
  function handleQuery () {
    var searchText = $scope.searchText,
        term = searchText.toLowerCase();
    //-- cancel promise if a promise is in progress
    if (promise && promise.cancel) {
      promise.cancel();
      promise = null;
    }
    //-- if results are cached, pull in cached results
    if (!$scope.noCache && cache[term]) {
      ctrl.matches = cache[term];
      updateMessages();
    } else {
      fetchResults(searchText);
    }
    if (hasFocus) ctrl.hidden = shouldHide();
  }

}
MdAutocompleteCtrl.$inject = ["$scope", "$element", "$mdUtil", "$mdConstant", "$timeout", "$mdTheming", "$window", "$animate", "$rootElement", "$attrs"];

})();
(function(){
"use strict";

angular
    .module('material.components.autocomplete')
    .directive('mdAutocomplete', MdAutocomplete);

/**
 * @ngdoc directive
 * @name mdAutocomplete
 * @module material.components.autocomplete
 *
 * @description
 * `<md-autocomplete>` is a special input component with a drop-down of all possible matches to a custom query.
 * This component allows you to provide real-time suggestions as the user types in the input area.
 *
 * To start, you will need to specify the required parameters and provide a template for your results.
 * The content inside `md-autocomplete` will be treated as a template.
 *
 * In more complex cases, you may want to include other content such as a message to display when
 * no matches were found.  You can do this by wrapping your template in `md-item-template` and adding
 * a tag for `md-not-found`.  An example of this is shown below.
 * ### Validation
 *
 * You can use `ng-messages` to include validation the same way that you would normally validate;
 * however, if you want to replicate a standard input with a floating label, you will have to do the
 * following:
 *
 * - Make sure that your template is wrapped in `md-item-template`
 * - Add your `ng-messages` code inside of `md-autocomplete`
 * - Add your validation properties to `md-autocomplete` (ie. `required`)
 * - Add a `name` to `md-autocomplete` (to be used on the generated `input`)
 *
 * There is an example below of how this should look.
 *
 *
 * @param {expression} md-items An expression in the format of `item in items` to iterate over matches for your search.
 * @param {expression=} md-selected-item-change An expression to be run each time a new item is selected
 * @param {expression=} md-search-text-change An expression to be run each time the search text updates
 * @param {string=} md-search-text A model to bind the search query text to
 * @param {object=} md-selected-item A model to bind the selected item to
 * @param {string=} md-item-text An expression that will convert your object to a single string.
 * @param {string=} placeholder Placeholder text that will be forwarded to the input.
 * @param {boolean=} md-no-cache Disables the internal caching that happens in autocomplete
 * @param {boolean=} ng-disabled Determines whether or not to disable the input field
 * @param {number=} md-min-length Specifies the minimum length of text before autocomplete will make suggestions
 * @param {number=} md-delay Specifies the amount of time (in milliseconds) to wait before looking for results
 * @param {boolean=} md-autofocus If true, will immediately focus the input element
 * @param {boolean=} md-autoselect If true, the first item will be selected by default
 * @param {string=} md-menu-class This will be applied to the dropdown menu for styling
 * @param {string=} md-floating-label This will add a floating label to autocomplete and wrap it in `md-input-container`
 *
 * @usage
 * ###Basic Example
 * <hljs lang="html">
 *   <md-autocomplete
 *       md-selected-item="selectedItem"
 *       md-search-text="searchText"
 *       md-items="item in getMatches(searchText)"
 *       md-item-text="item.display">
 *     <span md-highlight-text="searchText">{{item.display}}</span>
 *   </md-autocomplete>
 * </hljs>
 *
 * ###Example with "not found" message
 * <hljs lang="html">
 * <md-autocomplete
 *     md-selected-item="selectedItem"
 *     md-search-text="searchText"
 *     md-items="item in getMatches(searchText)"
 *     md-item-text="item.display">
 *   <md-item-template>
 *     <span md-highlight-text="searchText">{{item.display}}</span>
 *   </md-item-template>
 *   <md-not-found>
 *     No matches found.
 *   </md-not-found>
 * </md-autocomplete>
 * </hljs>
 *
 * In this example, our code utilizes `md-item-template` and `md-not-found` to specify the different
 * parts that make up our component.
 *
 * ### Example with validation
 * <hljs lang="html">
 * <form name="autocompleteForm">
 *   <md-autocomplete
 *       required
 *       input-name="autocomplete"
 *       md-selected-item="selectedItem"
 *       md-search-text="searchText"
 *       md-items="item in getMatches(searchText)"
 *       md-item-text="item.display">
 *     <md-item-template>
 *       <span md-highlight-text="searchText">{{item.display}}</span>
 *     </md-item-template>
 *     <div ng-messages="autocompleteForm.autocomplete.$error">
 *       <div ng-message="required">This field is required</div>
 *     </div>
 *   </md-autocomplete>
 * </form>
 * </hljs>
 *
 * In this example, our code utilizes `md-item-template` and `md-not-found` to specify the different
 * parts that make up our component.
 */

function MdAutocomplete ($mdTheming, $mdUtil) {
  return {
    controller:   'MdAutocompleteCtrl',
    controllerAs: '$mdAutocompleteCtrl',
    scope:        {
      inputName:      '@mdInputName',
      inputMinlength: '@mdInputMinlength',
      inputMaxlength: '@mdInputMaxlength',
      searchText:     '=?mdSearchText',
      selectedItem:   '=?mdSelectedItem',
      itemsExpr:      '@mdItems',
      itemText:       '&mdItemText',
      placeholder:    '@placeholder',
      noCache:        '=?mdNoCache',
      itemChange:     '&?mdSelectedItemChange',
      textChange:     '&?mdSearchTextChange',
      minLength:      '=?mdMinLength',
      delay:          '=?mdDelay',
      autofocus:      '=?mdAutofocus',
      floatingLabel:  '@?mdFloatingLabel',
      autoselect:     '=?mdAutoselect',
      menuClass:      '@?mdMenuClass'
    },
    template: function (element, attr) {
      var noItemsTemplate = getNoItemsTemplate(),
          itemTemplate = getItemTemplate(),
          leftover = element.html();
      return '\
        <md-autocomplete-wrap\
            layout="row"\
            ng-class="{ \'md-whiteframe-z1\': !floatingLabel }"\
            role="listbox">\
          ' + getInputElement() + '\
          <md-progress-linear\
              ng-if="$mdAutocompleteCtrl.loading"\
              md-mode="indeterminate"></md-progress-linear>\
          <ul role="presentation"\
              class="md-autocomplete-suggestions md-whiteframe-z1 {{menuClass || \'\'}}"\
              id="ul-{{$mdAutocompleteCtrl.id}}"\
              ng-hide="$mdAutocompleteCtrl.hidden"\
              ng-mouseenter="$mdAutocompleteCtrl.listEnter()"\
              ng-mouseleave="$mdAutocompleteCtrl.listLeave()"\
              ng-mouseup="$mdAutocompleteCtrl.mouseUp()">\
            <li ng-repeat="(index, item) in $mdAutocompleteCtrl.matches"\
                ng-class="{ selected: index === $mdAutocompleteCtrl.index }"\
                ng-click="$mdAutocompleteCtrl.select(index)"\
                md-autocomplete-list-item="$mdAutocompleteCtrl.itemName">\
                ' + itemTemplate + '\
            </li>\
            ' + noItemsTemplate + '\
          </ul>\
        </md-autocomplete-wrap>\
        <aria-status\
            class="md-visually-hidden"\
            role="status"\
            aria-live="assertive">\
          <p ng-repeat="message in $mdAutocompleteCtrl.messages" ng-if="message">{{message}}</p>\
        </aria-status>';

      function getItemTemplate() {
        var templateTag = element.find('md-item-template').remove(),
            html = templateTag.length ? templateTag.html() : element.html();
        if (!templateTag.length) element.empty();
        return html;
      }

      function getNoItemsTemplate() {
        var templateTag = element.find('md-not-found').remove(),
            template = templateTag.length ? templateTag.html() : '';
        return template
            ? '<li ng-if="!$mdAutocompleteCtrl.matches.length && !$mdAutocompleteCtrl.loading\
                         && !$mdAutocompleteCtrl.hidden"\
                         ng-hide="$mdAutocompleteCtrl.hidden"\
                         md-autocomplete-parent-scope>' + template + '</li>'
            : '';

      }

      function getInputElement() {
        if (attr.mdFloatingLabel) {
          return '\
            <md-input-container flex ng-if="floatingLabel">\
              <label>{{floatingLabel}}</label>\
              <input type="search"\
                  id="fl-input-{{$mdAutocompleteCtrl.id}}"\
                  name="{{inputName}}"\
                  autocomplete="off"\
                  ng-required="isRequired"\
                  ng-minlength="inputMinlength"\
                  ng-maxlength="inputMaxlength"\
                  ng-disabled="$mdAutocompleteCtrl.isDisabled"\
                  ng-model="$mdAutocompleteCtrl.scope.searchText"\
                  ng-keydown="$mdAutocompleteCtrl.keydown($event)"\
                  ng-blur="$mdAutocompleteCtrl.blur()"\
                  ng-focus="$mdAutocompleteCtrl.focus()"\
                  aria-owns="ul-{{$mdAutocompleteCtrl.id}}"\
                  aria-label="{{floatingLabel}}"\
                  aria-autocomplete="list"\
                  aria-haspopup="true"\
                  aria-activedescendant=""\
                  aria-expanded="{{!$mdAutocompleteCtrl.hidden}}"/>\
              <div md-autocomplete-parent-scope md-autocomplete-replace>' + leftover + '</div>\
            </md-input-container>';
        } else {
          return '\
            <input flex type="search"\
                id="input-{{$mdAutocompleteCtrl.id}}"\
                name="{{inputName}}"\
                ng-if="!floatingLabel"\
                autocomplete="off"\
                ng-required="isRequired"\
                ng-disabled="$mdAutocompleteCtrl.isDisabled"\
                ng-model="$mdAutocompleteCtrl.scope.searchText"\
                ng-keydown="$mdAutocompleteCtrl.keydown($event)"\
                ng-blur="$mdAutocompleteCtrl.blur()"\
                ng-focus="$mdAutocompleteCtrl.focus()"\
                placeholder="{{placeholder}}"\
                aria-owns="ul-{{$mdAutocompleteCtrl.id}}"\
                aria-label="{{placeholder}}"\
                aria-autocomplete="list"\
                aria-haspopup="true"\
                aria-activedescendant=""\
                aria-expanded="{{!$mdAutocompleteCtrl.hidden}}"/>\
            <button\
                type="button"\
                tabindex="-1"\
                ng-if="$mdAutocompleteCtrl.scope.searchText && !$mdAutocompleteCtrl.isDisabled"\
                ng-click="$mdAutocompleteCtrl.clear()">\
              <md-icon md-svg-icon="md-close"></md-icon>\
              <span class="md-visually-hidden">Clear</span>\
            </button>\
                ';
        }
      }
    }
  };
}
MdAutocomplete.$inject = ["$mdTheming", "$mdUtil"];

})();
(function(){
"use strict";

angular
    .module('material.components.autocomplete')
    .controller('MdHighlightCtrl', MdHighlightCtrl);

function MdHighlightCtrl ($scope, $element, $interpolate) {
  this.init = init;

  return init();

  function init (term) {
    var unsafeText = $interpolate($element.html())($scope),
        text = angular.element('<div>').text(unsafeText).html(),
        flags = $element.attr('md-highlight-flags') || '',
        watcher = $scope.$watch(term, function (term) {
          var regex = getRegExp(term, flags),
              html = text.replace(regex, '<span class="highlight">$&</span>');
          $element.html(html);
        });
    $element.on('$destroy', function () { watcher(); });
  }

  function sanitize (term) {
    if (!term) return term;
    return term.replace(/[\\\^\$\*\+\?\.\(\)\|\{\}\[\]]/g, '\\$&');
  }

  function getRegExp (text, flags) {
    var str = '';
    if (flags.indexOf('^') >= 1) str += '^';
    str += text;
    if (flags.indexOf('$') >= 1) str += '$';
    return new RegExp(sanitize(str), flags.replace(/[\$\^]/g, ''));
  }
}
MdHighlightCtrl.$inject = ["$scope", "$element", "$interpolate"];

})();
(function(){
"use strict";

angular
    .module('material.components.autocomplete')
    .directive('mdHighlightText', MdHighlight);

/**
 * @ngdoc directive
 * @name mdHighlightText
 * @module material.components.autocomplete
 *
 * @description
 * The `md-highlight-text` directive allows you to specify text that should be highlighted within
 * an element.  Highlighted text will be wrapped in `<span class="highlight"></span>` which can
 * be styled through CSS.  Please note that child elements may not be used with this directive.
 *
 * @param {string} md-highlight-text A model to be searched for
 * @param {string=} md-highlight-flags A list of flags (loosely based on JavaScript RexExp flags).
 *    #### **Supported flags**:
 *    - `g`: Find all matches within the provided text
 *    - `i`: Ignore case when searching for matches
 *    - `$`: Only match if the text ends with the search term
 *    - `^`: Only match if the text begins with the search term
 *
 * @usage
 * <hljs lang="html">
 * <input placeholder="Enter a search term..." ng-model="searchTerm" type="text" />
 * <ul>
 *   <li ng-repeat="result in results" md-highlight-text="searchTerm">
 *     {{result.text}}
 *   </li>
 * </ul>
 * </hljs>
 */

function MdHighlight () {
  return {
    terminal: true,
    scope: false,
    controller: 'MdHighlightCtrl',
    link: function (scope, element, attr, ctrl) {
      ctrl.init(attr.mdHighlightText);
    }
  };
}

})();
(function(){
"use strict";

angular
    .module('material.components.autocomplete')
    .directive('mdAutocompleteListItem', MdAutocompleteListItem);

function MdAutocompleteListItem ($compile, $mdUtil) {
  return {
    terminal: true,
    link: postLink,
    scope: false
  };
  function postLink (scope, element, attr) {
    var ctrl     = scope.$parent.$mdAutocompleteCtrl,
        newScope = ctrl.parent.$new(false, ctrl.parent),
        itemName = ctrl.scope.$eval(attr.mdAutocompleteListItem);
    newScope[itemName] = scope.item;
    $compile(element.contents())(newScope);
    element.attr({
      role: 'option',
      id: 'item_' + $mdUtil.nextUid()
    });
  }
}
MdAutocompleteListItem.$inject = ["$compile", "$mdUtil"];

})();
(function(){
"use strict";

angular
    .module('material.components.autocomplete')
    .directive('mdAutocompleteParentScope', MdAutocompleteParentScope);

function MdAutocompleteParentScope ($compile, $mdUtil) {
  return {
    restrict: 'A',
    terminal: true,
    link: postLink,
    scope: false
  };
  function postLink (scope, element, attr) {
    var ctrl     = scope.$parent.$mdAutocompleteCtrl;
    $compile(element.contents())(ctrl.parent);
    if (attr.hasOwnProperty('mdAutocompleteReplace')) {
      element.after(element.contents());
      element.remove();
    }
  }
}
MdAutocompleteParentScope.$inject = ["$compile", "$mdUtil"];

})();
(function(){
"use strict";

angular
    .module('material.components.chips')
    .directive('mdChip', MdChip);

/**
 * @ngdoc directive
 * @name mdChip
 * @module material.components.chips
 *
 * @description
 * `<md-chip>` is a component used within `<md-chips>` and is responsible for rendering individual
 * chips.
 *
 *
 * @usage
 * <hljs lang="html">
 *   <md-chip>{{$chip}}</md-chip>
 * </hljs>
 *
 */

// This hint text is hidden within a chip but used by screen readers to
// inform the user how they can interact with a chip.
var DELETE_HINT_TEMPLATE = '\
    <span ng-if="!$mdChipsCtrl.readonly" class="md-visually-hidden">\
      {{$mdChipsCtrl.deleteHint}}\
    </span>';

/**
 * MDChip Directive Definition
 *
 * @param $mdTheming
 * @param $mdInkRipple
 * @ngInject
 */
function MdChip($mdTheming) {
  return {
    restrict: 'E',
    require: '^?mdChips',
    compile:  compile
  };

  function compile(element, attr) {
    element.append(DELETE_HINT_TEMPLATE);
    return function postLink(scope, element, attr, ctrl) {
      element.addClass('md-chip');
      $mdTheming(element);

      if (ctrl) angular.element(element[0].querySelector('.md-chip-content'))
          .on('blur', function () {
            ctrl.selectedChip = -1;
          });
    };
  }
}
MdChip.$inject = ["$mdTheming"];

})();
(function(){
"use strict";

angular
    .module('material.components.chips')
    .directive('mdChipRemove', MdChipRemove);

/**
 * @ngdoc directive
 * @name mdChipRemove
 * @module material.components.chips
 *
 * @description
 * `<md-chip-remove>`
 * Designates an element to be used as the delete button for a chip. This
 * element is passed as a child of the `md-chips` element.
 *
 * @usage
 * <hljs lang="html">
 *   <md-chips><button md-chip-remove>DEL</button></md-chips>
 * </hljs>
 */


/**
 * MdChipRemove Directive Definition.
 * 
 * @param $compile
 * @param $timeout
 * @returns {{restrict: string, require: string[], link: Function, scope: boolean}}
 * @constructor
 */
function MdChipRemove ($timeout) {
  return {
    restrict: 'A',
    require: '^mdChips',
    scope: false,
    link: postLink
  };

  function postLink(scope, element, attr, ctrl) {
    element.on('click', function(event) {
      scope.$apply(function() {
        ctrl.removeChip(scope.$$replacedScope.$index);
      });
    });

    // Child elements aren't available until after a $timeout tick as they are hidden by an
    // `ng-if`. see http://goo.gl/zIWfuw
    $timeout(function() {
      element.attr({ tabindex: -1, ariaHidden: true });
      element.find('button').attr('tabindex', '-1');
    });
  }
}
MdChipRemove.$inject = ["$timeout"];

})();
(function(){
"use strict";

angular
    .module('material.components.chips')
    .directive('mdChipTransclude', MdChipTransclude);

function MdChipTransclude ($compile, $mdUtil) {
  return {
    restrict: 'EA',
    terminal: true,
    link: link,
    scope: false
  };
  function link (scope, element, attr) {
    var ctrl = scope.$parent.$mdChipsCtrl,
        newScope = ctrl.parent.$new(false, ctrl.parent);
    newScope.$$replacedScope = scope;
    newScope.$chip = scope.$chip;
    newScope.$mdChipsCtrl = ctrl;
    element.html(ctrl.$scope.$eval(attr.mdChipTransclude));
    $compile(element.contents())(newScope);
  }
}
MdChipTransclude.$inject = ["$compile", "$mdUtil"];

})();
(function(){
"use strict";

angular
    .module('material.components.chips')
    .controller('MdChipsCtrl', MdChipsCtrl);

/**
 * Controller for the MdChips component. Responsible for adding to and
 * removing from the list of chips, marking chips as selected, and binding to
 * the models of various input components.
 *
 * @param $scope
 * @param $mdConstant
 * @param $log
 * @param $element
 * @constructor
 */
function MdChipsCtrl ($scope, $mdConstant, $log, $element, $timeout) {
  /** @type {$timeout} **/
  this.$timeout = $timeout;

  /** @type {Object} */
  this.$mdConstant = $mdConstant;

  /** @type {angular.$scope} */
  this.$scope = $scope;

  /** @type {angular.$scope} */
  this.parent = $scope.$parent;

  /** @type {$log} */
  this.$log = $log;

  /** @type {$element} */
  this.$element = $element;

  /** @type {angular.NgModelController} */
  this.ngModelCtrl = null;

  /** @type {angular.NgModelController} */
  this.userInputNgModelCtrl = null;

  /** @type {Element} */
  this.userInputElement = null;

  /** @type {Array.<Object>} */
  this.items = [];

  /** @type {number} */
  this.selectedChip = -1;


  /**
   * Hidden hint text for how to delete a chip. Used to give context to screen readers.
   * @type {string}
   */
  this.deleteHint = 'Press delete to remove this chip.';

  /**
   * Hidden label for the delete button. Used to give context to screen readers.
   * @type {string}
   */
  this.deleteButtonLabel = 'Remove';

  /**
   * Model used by the input element.
   * @type {string}
   */
  this.chipBuffer = '';

  /**
   * Whether to use the mdOnAppend expression to transform the chip buffer
   * before appending it to the list.
   * @type {boolean}
   */
  this.useMdOnAppend = false;
}
MdChipsCtrl.$inject = ["$scope", "$mdConstant", "$log", "$element", "$timeout"];

/**
 * Handles the keydown event on the input element: <enter> appends the
 * buffer to the chip list, while backspace removes the last chip in the list
 * if the current buffer is empty.
 * @param event
 */
MdChipsCtrl.prototype.inputKeydown = function(event) {
  var chipBuffer = this.getChipBuffer();
  switch (event.keyCode) {
    case this.$mdConstant.KEY_CODE.ENTER:
      if (this.$scope.requireMatch || !chipBuffer) break;
      event.preventDefault();
      this.appendChip(chipBuffer);
      this.resetChipBuffer();
      break;
    case this.$mdConstant.KEY_CODE.BACKSPACE:
      if (chipBuffer) break;
      event.stopPropagation();
      if (this.items.length) this.selectAndFocusChipSafe(this.items.length - 1);
      break;
  }
};

/**
 * Handles the keydown event on the chip elements: backspace removes the selected chip, arrow
 * keys switch which chips is active
 * @param event
 */
MdChipsCtrl.prototype.chipKeydown = function (event) {
  if (this.getChipBuffer()) return;
  switch (event.keyCode) {
    case this.$mdConstant.KEY_CODE.BACKSPACE:
    case this.$mdConstant.KEY_CODE.DELETE:
      if (this.selectedChip < 0) return;
      event.preventDefault();
      this.removeAndSelectAdjacentChip(this.selectedChip);
      break;
    case this.$mdConstant.KEY_CODE.LEFT_ARROW:
      event.preventDefault();
      if (this.selectedChip < 0) this.selectedChip = this.items.length;
      if (this.items.length) this.selectAndFocusChipSafe(this.selectedChip - 1);
      break;
    case this.$mdConstant.KEY_CODE.RIGHT_ARROW:
      event.preventDefault();
      this.selectAndFocusChipSafe(this.selectedChip + 1);
      break;
    case this.$mdConstant.KEY_CODE.ESCAPE:
    case this.$mdConstant.KEY_CODE.TAB:
      if (this.selectedChip < 0) return;
      event.preventDefault();
      this.onFocus();
      break;
  }
};

/**
 * Get the input's placeholder - uses `placeholder` when list is empty and `secondary-placeholder`
 * when the list is non-empty. If `secondary-placeholder` is not provided, `placeholder` is used
 * always.
 */
MdChipsCtrl.prototype.getPlaceholder = function() {
  // Allow `secondary-placeholder` to be blank.
  var useSecondary = (this.items.length &&
      (this.secondaryPlaceholder == '' || this.secondaryPlaceholder));
  return useSecondary ? this.placeholder : this.secondaryPlaceholder;
};

/**
 * Removes chip at {@code index} and selects the adjacent chip.
 * @param index
 */
MdChipsCtrl.prototype.removeAndSelectAdjacentChip = function(index) {
  var selIndex = this.getAdjacentChipIndex(index);
  this.removeChip(index);
  this.$timeout(angular.bind(this, function () {
      this.selectAndFocusChipSafe(selIndex);
  }));
};

/**
 * Sets the selected chip index to -1.
 */
MdChipsCtrl.prototype.resetSelectedChip = function() {
  this.selectedChip = -1;
};

/**
 * Gets the index of an adjacent chip to select after deletion. Adjacency is
 * determined as the next chip in the list, unless the target chip is the
 * last in the list, then it is the chip immediately preceding the target. If
 * there is only one item in the list, -1 is returned (select none).
 * The number returned is the index to select AFTER the target has been
 * removed.
 * If the current chip is not selected, then -1 is returned to select none.
 */
MdChipsCtrl.prototype.getAdjacentChipIndex = function(index) {
  var len = this.items.length - 1;
  return (len == 0) ? -1 :
      (index == len) ? index -1 : index;
};

/**
 * Append the contents of the buffer to the chip list. This method will first
 * call out to the md-on-append method, if provided
 * @param newChip
 */
MdChipsCtrl.prototype.appendChip = function(newChip) {
  if (this.items.indexOf(newChip) + 1) return;
  if (this.useMdOnAppend && this.mdOnAppend) {
    newChip = this.mdOnAppend({'$chip': newChip});
  }
  this.items.push(newChip);
};

/**
 * Sets whether to use the md-on-append expression. This expression is
 * bound to scope and controller in {@code MdChipsDirective} as
 * {@code mdOnAppend}. Due to the nature of directive scope bindings, the
 * controller cannot know on its own/from the scope whether an expression was
 * actually provided.
 */
MdChipsCtrl.prototype.useMdOnAppendExpression = function() {
  this.useMdOnAppend = true;
};

/**
 * Gets the input buffer. The input buffer can be the model bound to the
 * default input item {@code this.chipBuffer}, the {@code selectedItem}
 * model of an {@code md-autocomplete}, or, through some magic, the model
 * bound to any inpput or text area element found within a
 * {@code md-input-container} element.
 * @return {Object|string}
 */
MdChipsCtrl.prototype.getChipBuffer = function() {
  return !this.userInputElement ? this.chipBuffer :
      this.userInputNgModelCtrl ? this.userInputNgModelCtrl.$viewValue :
          this.userInputElement[0].value;
};

/**
 * Resets the input buffer for either the internal input or user provided input element.
 */
MdChipsCtrl.prototype.resetChipBuffer = function() {
  if (this.userInputElement) {
    if (this.userInputNgModelCtrl) {
      this.userInputNgModelCtrl.$setViewValue('');
      this.userInputNgModelCtrl.$render();
    } else {
      this.userInputElement[0].value = '';
    }
  } else {
    this.chipBuffer = '';
  }
};

/**
 * Removes the chip at the given index.
 * @param index
 */
MdChipsCtrl.prototype.removeChip = function(index) {
  this.items.splice(index, 1);
};

MdChipsCtrl.prototype.removeChipAndFocusInput = function (index) {
  this.removeChip(index);
  this.onFocus();
};
/**
 * Selects the chip at `index`,
 * @param index
 */
MdChipsCtrl.prototype.selectAndFocusChipSafe = function(index) {
  if (!this.items.length) {
    this.selectChip(-1);
    this.onFocus();
    return;
  }
  if (index === this.items.length) return this.onFocus();
  index = Math.max(index, 0);
  index = Math.min(index, this.items.length - 1);
  this.selectChip(index);
  this.focusChip(index);
};

/**
 * Marks the chip at the given index as selected.
 * @param index
 */
MdChipsCtrl.prototype.selectChip = function(index) {
  if (index >= -1 && index <= this.items.length) {
    this.selectedChip = index;
  } else {
    this.$log.warn('Selected Chip index out of bounds; ignoring.');
  }
};

/**
 * Selects the chip at `index` and gives it focus.
 * @param index
 */
MdChipsCtrl.prototype.selectAndFocusChip = function(index) {
  this.selectChip(index);
  if (index != -1) {
    this.focusChip(index);
  }
};

/**
 * Call `focus()` on the chip at `index`
 */
MdChipsCtrl.prototype.focusChip = function(index) {
  this.$element[0].querySelector('md-chip[index="' + index + '"] .md-chip-content').focus();
};

/**
 * Configures the required interactions with the ngModel Controller.
 * Specifically, set {@code this.items} to the {@code NgModelCtrl#$viewVale}.
 * @param ngModelCtrl
 */
MdChipsCtrl.prototype.configureNgModel = function(ngModelCtrl) {
  this.ngModelCtrl = ngModelCtrl;

  var self = this;
  ngModelCtrl.$render = function() {
    // model is updated. do something.
    self.items = self.ngModelCtrl.$viewValue;
  };
};

MdChipsCtrl.prototype.onFocus = function () {
  var input = this.$element[0].querySelector('input');
  input && input.focus();
  this.resetSelectedChip();
};

MdChipsCtrl.prototype.onInputFocus = function () {
  this.inputHasFocus = true;
  this.resetSelectedChip();
};

MdChipsCtrl.prototype.onInputBlur = function () {
  this.inputHasFocus = false;
};

/**
 * Configure event bindings on a user-provided input element.
 * @param inputElement
 */
MdChipsCtrl.prototype.configureUserInput = function(inputElement) {
  this.userInputElement = inputElement;

  // Find the NgModelCtrl for the input element
  var ngModelCtrl = inputElement.controller('ngModel');
  // `.controller` will look in the parent as well.
  if (ngModelCtrl != this.ngModelCtrl) {
    this.userInputNgModelCtrl = ngModelCtrl;
  }

  // Bind to keydown and focus events of input
  var scope = this.$scope;
  var ctrl = this;
  inputElement
      .attr({ tabindex: 0 })
      .on('keydown', function(event) { scope.$apply( angular.bind(ctrl, function() { ctrl.inputKeydown(event); })) })
      .on('focus', angular.bind(ctrl, ctrl.onInputFocus))
      .on('blur', angular.bind(ctrl, ctrl.onInputBlur));
};

MdChipsCtrl.prototype.configureAutocomplete = function(ctrl) {

  ctrl.registerSelectedItemWatcher(angular.bind(this, function (item) {
    if (item) {
      this.appendChip(item);
      this.resetChipBuffer();
    }
  }));

  this.$element.find('input')
      .on('focus',angular.bind(this, this.onInputFocus) )
      .on('blur', angular.bind(this, this.onInputBlur) );
};

MdChipsCtrl.prototype.hasFocus = function () {
  return this.inputHasFocus || this.selectedChip >= 0;
};

})();
(function(){
"use strict";

  angular
      .module('material.components.chips')
      .directive('mdChips', MdChips);

  /**
   * @ngdoc directive
   * @name mdChips
   * @module material.components.chips
   *
   * @description
   * `<md-chips>` is an input component for building lists of strings or objects. The list items are
   * displayed as 'chips'. This component can make use of an `<input>` element or an
   * `<md-autocomplete>` element.
   *
   * <strong>Custom `<md-chip-template>` template</strong>
   * A custom template may be provided to render the content of each chip. This is achieved by
   * specifying an `<md-chip-template>` element as a child of `<md-chips>`. Note: Any attributes on
   * `<md-chip-template>` will be dropped as only the innerHTML is used for the chip template. The
   * variables `$chip` and `$index` are available in the scope of `<md-chip-template>`, representing
   * the chip object and its index in the list of chips, respectively.
   * To override the chip delete control, include an element (ideally a button) with the attribute
   * `md-chip-remove`. A click listener to remove the chip will be added automatically. The element
   * is also placed as a sibling to the chip content (on which there are also click listeners) to
   * avoid a nested ng-click situation.
   *
   * <h3> Pending Features </h3>
   * <ul style="padding-left:20px;">
   *
   *   <ul>Style
   *     <li>Colours for hover, press states (ripple?).</li>
   *   </ul>
   *
   *   <ul>List Manipulation
   *     <li>delete item via DEL or backspace keys when selected</li>
   *   </ul>
   *
   *   <ul>Validation
   *     <li>de-dupe values (or support duplicates, but fix the ng-repeat duplicate key issue)</li>
   *     <li>allow a validation callback</li>
   *     <li>hilighting style for invalid chips</li>
   *   </ul>
   *
   *   <ul>Item mutation
   *     <li>Support `
   *       <md-chip-edit>` template, show/hide the edit element on tap/click? double tap/double
   *       click?
   *     </li>
   *   </ul>
   *
   *   <ul>Truncation and Disambiguation (?)
   *     <li>Truncate chip text where possible, but do not truncate entries such that two are
   *     indistinguishable.</li>
   *   </ul>
   *
   *   <ul>Drag and Drop
   *     <li>Drag and drop chips between related `<md-chips>` elements.
   *     </li>
   *   </ul>
   * </ul>
   *
   *  <span style="font-size:.8em;text-align:center">
   *    Warning: This component is a WORK IN PROGRESS. If you use it now,
   *    it will probably break on you in the future.
   *  </span>
   *
   * @param {string=|object=} ng-model A model to bind the list of items to
   * @param {string=} placeholder Placeholder text that will be forwarded to the input.
   * @param {string=} secondary-placeholder Placeholder text that will be forwarded to the input,
   *    displayed when there is at least on item in the list
   * @param {boolean=} readonly Disables list manipulation (deleting or adding list items), hiding
   *    the input and delete buttons
   * @param {expression} md-on-append An expression expected to convert the input string into an
   *    object when adding a chip.
   * @param {string=} delete-hint A string read by screen readers instructing users that pressing
   *    the delete key will remove the chip.
   * @param {string=} delete-button-label A label for the delete button. Also hidden and read by
   *    screen readers.
   *
   * @usage
   * <hljs lang="html">
   *   <md-chips
   *       ng-model="myItems"
   *       placeholder="Add an item"
   *       readonly="isReadOnly">
   *   </md-chips>
   * </hljs>
   *
   */


  var MD_CHIPS_TEMPLATE = '\
      <md-chips-wrap\
          ng-if="!$mdChipsCtrl.readonly || $mdChipsCtrl.items.length > 0"\
          ng-keydown="$mdChipsCtrl.chipKeydown($event)"\
          ng-class="{ \'md-focused\': $mdChipsCtrl.hasFocus() }"\
          class="md-chips">\
        <md-chip ng-repeat="$chip in $mdChipsCtrl.items"\
            index="{{$index}}"\
            ng-class="{\'md-focused\': $mdChipsCtrl.selectedChip == $index}">\
          <div class="md-chip-content"\
              tabindex="-1"\
              aria-hidden="true"\
              ng-focus="!$mdChipsCtrl.readonly && $mdChipsCtrl.selectChip($index)"\
              md-chip-transclude="$mdChipsCtrl.chipContentsTemplate"></div>\
          <div class="md-chip-remove-container"\
              md-chip-transclude="$mdChipsCtrl.chipRemoveTemplate"></div>\
        </md-chip>\
        <div ng-if="!$mdChipsCtrl.readonly && $mdChipsCtrl.ngModelCtrl"\
            class="md-chip-input-container"\
            md-chip-transclude="$mdChipsCtrl.chipInputTemplate"></div>\
        </div>\
      </md-chips-wrap>';

  var CHIP_INPUT_TEMPLATE = '\
        <input\
            tabindex="0"\
            placeholder="{{$mdChipsCtrl.getPlaceholder()}}"\
            aria-label="{{$mdChipsCtrl.getPlaceholder()}}"\
            ng-model="$mdChipsCtrl.chipBuffer"\
            ng-focus="$mdChipsCtrl.onInputFocus()"\
            ng-blur="$mdChipsCtrl.onInputBlur()"\
            ng-keydown="$mdChipsCtrl.inputKeydown($event)">';

  var CHIP_DEFAULT_TEMPLATE = '\
      <span>{{$chip}}</span>';

  var CHIP_REMOVE_TEMPLATE = '\
      <button\
          class="md-chip-remove"\
          ng-if="!$mdChipsCtrl.readonly"\
          ng-click="$mdChipsCtrl.removeChipAndFocusInput($$replacedScope.$index)"\
          type="button"\
          aria-hidden="true"\
          tabindex="-1">\
        <md-icon md-svg-icon="md-close"></md-icon>\
        <span class="md-visually-hidden">\
          {{$mdChipsCtrl.deleteButtonLabel}}\
        </span>\
      </button>';

  /**
   * MDChips Directive Definition
   */
  function MdChips ($mdTheming, $mdUtil, $compile, $log, $timeout) {
    return {
      template: function(element, attrs) {
        // Clone the element into an attribute. By prepending the attribute
        // name with '$', Angular won't write it into the DOM. The cloned
        // element propagates to the link function via the attrs argument,
        // where various contained-elements can be consumed.
        var content = attrs['$mdUserTemplate'] = element.clone();
        return MD_CHIPS_TEMPLATE;
      },
      require: ['mdChips'],
      restrict: 'E',
      controller: 'MdChipsCtrl',
      controllerAs: '$mdChipsCtrl',
      bindToController: true,
      compile: compile,
      scope: {
        readonly: '=readonly',
        placeholder: '@',
        secondaryPlaceholder: '@',
        mdOnAppend: '&',
        deleteHint: '@',
        deleteButtonLabel: '@',
        requireMatch: '=?mdRequireMatch'
      }
    };

    /**
     * Builds the final template for `md-chips` and returns the postLink function.
     *
     * Building the template involves 3 key components:
     * static chips
     * chip template
     * input control
     *
     * If no `ng-model` is provided, only the static chip work needs to be done.
     *
     * If no user-passed `md-chip-template` exists, the default template is used. This resulting
     * template is appended to the chip content element.
     *
     * The remove button may be overridden by passing an element with an md-chip-remove attribute.
     *
     * If an `input` or `md-autocomplete` element is provided by the caller, it is set aside for
     * transclusion later. The transclusion happens in `postLink` as the parent scope is required.
     * If no user input is provided, a default one is appended to the input container node in the
     * template.
     *
     * Static Chips (i.e. `md-chip` elements passed from the caller) are gathered and set aside for
     * transclusion in the `postLink` function.
     *
     *
     * @param element
     * @param attr
     * @returns {Function}
     */
    function compile(element, attr) {
      // Grab the user template from attr and reset the attribute to null.
      var userTemplate = attr['$mdUserTemplate'];
      attr['$mdUserTemplate'] = null;

      // Set the chip remove, chip contents and chip input templates. The link function will put
      // them on the scope for transclusion later.
      var chipRemoveTemplate   = getTemplateByQuery('md-chips>*[md-chip-remove]') || CHIP_REMOVE_TEMPLATE,
          chipContentsTemplate = getTemplateByQuery('md-chips>md-chip-template') || CHIP_DEFAULT_TEMPLATE,
          chipInputTemplate    = getTemplateByQuery('md-chips>md-autocomplete')
              || getTemplateByQuery('md-chips>input')
              || CHIP_INPUT_TEMPLATE,
          staticChips = userTemplate.find('md-chip');

      // Warn of malformed template. See #2545
      if (userTemplate[0].querySelector('md-chip-template>*[md-chip-remove]')) {
        $log.warn('invalid placement of md-chip-remove within md-chip-template.');
      }

      function getTemplateByQuery (query) {
        if (!attr.ngModel) return;
        var element = userTemplate[0].querySelector(query);
        return element && element.outerHTML;
      }

      /**
       * Configures controller and transcludes.
       */
      return function postLink(scope, element, attrs, controllers) {

        $mdUtil.initOptionalProperties(scope, attr);

        $mdTheming(element);
        var mdChipsCtrl = controllers[0];
        mdChipsCtrl.chipContentsTemplate = chipContentsTemplate;
        mdChipsCtrl.chipRemoveTemplate   = chipRemoveTemplate;
        mdChipsCtrl.chipInputTemplate    = chipInputTemplate;

        element
            .attr({ ariaHidden: true, tabindex: -1 })
            .on('focus', function () { mdChipsCtrl.onFocus(); });

        if (attr.ngModel) {
          mdChipsCtrl.configureNgModel(element.controller('ngModel'));

          // If an `md-on-append` attribute was set, tell the controller to use the expression
          // when appending chips.
          if (attrs.mdOnAppend) mdChipsCtrl.useMdOnAppendExpression();

          // The md-autocomplete and input elements won't be compiled until after this directive
          // is complete (due to their nested nature). Wait a tick before looking for them to
          // configure the controller.
          if (chipInputTemplate != CHIP_INPUT_TEMPLATE) {
            $timeout(function() {
              if (chipInputTemplate.indexOf('<md-autocomplete') === 0)
                mdChipsCtrl
                    .configureAutocomplete(element.find('md-autocomplete')
                        .controller('mdAutocomplete'));
              mdChipsCtrl.configureUserInput(element.find('input'));
            });
          }
        }

        // Compile with the parent's scope and prepend any static chips to the wrapper.
        if (staticChips.length > 0) {
          var compiledStaticChips = $compile(staticChips)(scope.$parent);
          $timeout(function() { element.find('md-chips-wrap').prepend(compiledStaticChips); });
        }
      };
    }
  }
  MdChips.$inject = ["$mdTheming", "$mdUtil", "$compile", "$log", "$timeout"];

})();
(function(){
"use strict";

angular
    .module('material.components.chips')
    .controller('MdContactChipsCtrl', MdContactChipsCtrl);



/**
 * Controller for the MdContactChips component
 * @constructor
 */
function MdContactChipsCtrl () {
  /** @type {Object} */
  this.selectedItem = null;

  /** @type {string} */
  this.searchText = '';
}


MdContactChipsCtrl.prototype.queryContact = function(searchText) {
  var results = this.contactQuery({'$query': searchText});
  return this.filterSelected ?
      results.filter(angular.bind(this, this.filterSelectedContacts)) : results;
};


MdContactChipsCtrl.prototype.filterSelectedContacts = function(contact) {
  return this.contacts.indexOf(contact) == -1;
};

})();
(function(){
"use strict";

  angular
      .module('material.components.chips')
      .directive('mdContactChips', MdContactChips);

  /**
   * @ngdoc directive
   * @name mdContactChips
   * @module material.components.chips
   *
   * @description
   * `<md-contact-chips>` is an input component based on `md-chips` and makes use of an
   *    `md-autocomplete` element. The component allows the caller to supply a query expression
   *    which returns  a list of possible contacts. The user can select one of these and add it to
   *    the list of chips.
   *
   * @param {string=|object=} ng-model A model to bind the list of items to
   * @param {string=} placeholder Placeholder text that will be forwarded to the input.
   * @param {string=} secondary-placeholder Placeholder text that will be forwarded to the input,
   *    displayed when there is at least on item in the list
   * @param {expression} md-contacts An expression expected to return contacts matching the search
   *    test, `$query`.
   * @param {string} md-contact-name The field name of the contact object representing the
   *    contact's name.
   * @param {string} md-contact-email The field name of the contact object representing the
   *    contact's email address.
   * @param {string} md-contact-image The field name of the contact object representing the
   *    contact's image.
   *
   *
   * // The following attribute has been removed but may come back.
   * @param {expression=} filter-selected Whether to filter selected contacts from the list of
   *    suggestions shown in the autocomplete.
   *
   *
   *
   * @usage
   * <hljs lang="html">
   *   <md-contact-chips
   *       ng-model="ctrl.contacts"
   *       md-contacts="ctrl.querySearch($query)"
   *       md-contact-name="name"
   *       md-contact-image="image"
   *       md-contact-email="email"
   *       placeholder="To">
   *   </md-contact-chips>
   * </hljs>
   *
   */


  var MD_CONTACT_CHIPS_TEMPLATE = '\
      <md-chips class="md-contact-chips"\
          ng-model="$mdContactChipsCtrl.contacts"\
          md-require-match="$mdContactChipsCtrl.requireMatch"\
          md-autocomplete-snap>\
          <md-autocomplete\
              md-menu-class="md-contact-chips-suggestions"\
              md-selected-item="$mdContactChipsCtrl.selectedItem"\
              md-search-text="$mdContactChipsCtrl.searchText"\
              md-items="item in $mdContactChipsCtrl.queryContact($mdContactChipsCtrl.searchText)"\
              md-item-text="$mdContactChipsCtrl.mdContactName"\
              md-no-cache="true"\
              md-autoselect\
              placeholder="{{$mdContactChipsCtrl.contacts.length == 0 ?\
                  $mdContactChipsCtrl.placeholder : $mdContactChipsCtrl.secondaryPlaceholder}}">\
            <div class="md-contact-suggestion">\
              <img \
                  ng-src="{{item[$mdContactChipsCtrl.contactImage]}}"\
                  alt="{{item[$mdContactChipsCtrl.contactName]}}" />\
              <span class="md-contact-name" md-highlight-text="$mdContactChipsCtrl.searchText">\
                {{item[$mdContactChipsCtrl.contactName]}}\
              </span>\
              <span class="md-contact-email" >{{item[$mdContactChipsCtrl.contactEmail]}}</span>\
            </div>\
          </md-autocomplete>\
          <md-chip-template>\
            <div class="md-contact-avatar">\
              <img \
                  ng-src="{{$chip[$mdContactChipsCtrl.contactImage]}}"\
                  alt="{{$chip[$mdContactChipsCtrl.contactName]}}" />\
            </div>\
            <div class="md-contact-name">\
              {{$chip[$mdContactChipsCtrl.contactName]}}\
            </div>\
          </md-chip-template>\
      </md-chips>';


  /**
   * MDContactChips Directive Definition
   *
   * @param $mdTheming
   * @returns {*}
   * @ngInject
   */
  function MdContactChips ($mdTheming, $mdUtil) {
    return {
      template: function(element, attrs) {
        return MD_CONTACT_CHIPS_TEMPLATE;
      },
      restrict: 'E',
      controller: 'MdContactChipsCtrl',
      controllerAs: '$mdContactChipsCtrl',
      bindToController: true,
      compile: compile,
      scope: {
        contactQuery: '&mdContacts',
        placeholder: '@',
        secondaryPlaceholder: '@',
        contactName: '@mdContactName',
        contactImage: '@mdContactImage',
        contactEmail: '@mdContactEmail',
        contacts: '=ngModel',
        requireMatch: '=?mdRequireMatch'
      }
    };

    function compile(element, attr) {
      return function postLink(scope, element, attrs, controllers) {

        $mdUtil.initOptionalProperties(scope, attr);
        $mdTheming(element);

        element.attr('tabindex', '-1');
      };
    }
  }
  MdContactChips.$inject = ["$mdTheming", "$mdUtil"];

})();
(function(){
"use strict";

/**
 * @ngdoc directive
 * @name mdTab
 * @module material.components.tabs
 *
 * @restrict E
 *
 * @description
 * Use the `<md-tab>` a nested directive used within `<md-tabs>` to specify a tab with a **label** and optional *view content*.
 *
 * If the `label` attribute is not specified, then an optional `<md-tab-label>` tag can be used to specify more
 * complex tab header markup. If neither the **label** nor the **md-tab-label** are specified, then the nested
 * markup of the `<md-tab>` is used as the tab header markup.
 *
 * Please note that if you use `<md-tab-label>`, your content **MUST** be wrapped in the `<md-tab-body>` tag.  This
 * is to define a clear separation between the tab content and the tab label.
 *
 * If a tab **label** has been identified, then any **non-**`<md-tab-label>` markup
 * will be considered tab content and will be transcluded to the internal `<div class="md-tabs-content">` container.
 *
 * This container is used by the TabsController to show/hide the active tab's content view. This synchronization is
 * automatically managed by the internal TabsController whenever the tab selection changes. Selection changes can
 * be initiated via data binding changes, programmatic invocation, or user gestures.
 *
 * @param {string=} label Optional attribute to specify a simple string as the tab label
 * @param {boolean=} disabled If present, disabled tab selection.
 * @param {expression=} md-on-deselect Expression to be evaluated after the tab has been de-selected.
 * @param {expression=} md-on-select Expression to be evaluated after the tab has been selected.
 *
 *
 * @usage
 *
 * <hljs lang="html">
 * <md-tab label="" disabled="" md-on-select="" md-on-deselect="" >
 *   <h3>My Tab content</h3>
 * </md-tab>
 *
 * <md-tab >
 *   <md-tab-label>
 *     <h3>My Tab content</h3>
 *   </md-tab-label>
 *   <md-tab-body>
 *     <p>
 *       Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium,
 *       totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae
 *       dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit,
 *       sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt.
 *     </p>
 *   </md-tab-body>
 * </md-tab>
 * </hljs>
 *
 */
angular
    .module('material.components.tabs')
    .directive('mdTab', MdTab);

function MdTab () {
  return {
    require: '^?mdTabs',
    terminal: true,
    template: function (element, attr) {
      var label = getLabel(),
          body  = getTemplate();
      return '' +
          '<md-tab-label>' + label + '</md-tab-label>' +
          '<md-tab-body>' + body + '</md-tab-body>';
      function getLabel () {
        return getLabelElement() || getLabelAttribute() || getElementContents();
        function getLabelAttribute () { return attr.label; }
        function getLabelElement () {
          var label = element.find('md-tab-label').eq(0);
          if (label.length) return label.remove().html();
        }
        function getElementContents () {
          var html = element.html();
          element.empty();
          return html;
        }
      }
      function getTemplate () {
        var content = element.find('md-tab-body').eq(0),
            template = content.length ? content.html() : attr.label ? element.html() : '';
        if (content.length) content.remove();
        else if (attr.label) element.empty();
        return template;
      }
    },
    scope: {
      active:   '=?mdActive',
      disabled: '=?ngDisabled',
      select:   '&?mdOnSelect',
      deselect: '&?mdOnDeselect'
    },
    link: postLink
  };

  function postLink (scope, element, attr, ctrl) {
    if (!ctrl) return;
    var tabs = element.parent()[0].getElementsByTagName('md-tab'),
        index = Array.prototype.indexOf.call(tabs, element[0]),
        body = element.find('md-tab-body').eq(0).remove(),
        label = element.find('md-tab-label').eq(0).remove(),
        data = ctrl.insertTab({
          scope:    scope,
          parent:   scope.$parent,
          index:    index,
          element:  element,
          template: body.html(),
          label:    label.html()
        }, index);

    scope.select   = scope.select   || angular.noop;
    scope.deselect = scope.deselect || angular.noop;

    scope.$watch('active', function (active) { if (active) ctrl.select(data.getIndex()); });
    scope.$watch('disabled', function () { ctrl.refreshIndex(); });
    scope.$watch(
        function () {
          return Array.prototype.indexOf.call(tabs, element[0]);
        },
        function (newIndex) {
          data.index = newIndex;
          ctrl.updateTabOrder();
        }
    );
    scope.$on('$destroy', function () { ctrl.removeTab(data); });

  }
}

})();
(function(){
"use strict";

angular
    .module('material.components.tabs')
    .directive('mdTabItem', MdTabItem);

function MdTabItem () {
  return {
    require: '^?mdTabs',
    link: function link (scope, element, attr, ctrl) {
      if (!ctrl) return;
      ctrl.attachRipple(scope, element);
    }
  };
}

})();
(function(){
"use strict";

angular
    .module('material.components.tabs')
    .directive('mdTabLabel', MdTabLabel);

function MdTabLabel () {
  return { terminal: true };
}


})();
(function(){
"use strict";

angular.module('material.components.tabs')
    .directive('mdTabScroll', MdTabScroll);

function MdTabScroll ($parse) {
  return {
    restrict: 'A',
    compile: function ($element, attr) {
      var fn = $parse(attr.mdTabScroll, null, true);
      return function ngEventHandler (scope, element) {
        element.on('mousewheel', function (event) {
          scope.$apply(function () { fn(scope, { $event: event }); });
        });
      };
    }
  }
}
MdTabScroll.$inject = ["$parse"];

})();
(function(){
"use strict";

angular
    .module('material.components.tabs')
    .controller('MdTabsController', MdTabsController);

/**
 * @ngInject
 */
function MdTabsController ($scope, $element, $window, $timeout, $mdConstant, $mdTabInkRipple,
                           $mdUtil, $animate, $attrs, $compile, $mdTheming) {
  //-- define private properties
  var ctrl       = this,
      locked     = false,
      elements   = getElements(),
      queue      = [],
      destroyed  = false,
      loaded     = false;

  //-- define public properties with change handlers
  defineProperty('focusIndex', handleFocusIndexChange, $scope.selectedIndex || 0);
  defineProperty('offsetLeft', handleOffsetChange, 0);
  defineProperty('hasContent', handleHasContent, false);

  //-- define public properties
  ctrl.scope = $scope;
  ctrl.parent = $scope.$parent;
  ctrl.tabs = [];
  ctrl.lastSelectedIndex = null;
  ctrl.hasFocus = false;
  ctrl.lastClick = true;
  ctrl.shouldPaginate = false;
  ctrl.shouldCenterTabs = shouldCenterTabs();

  //-- define public methods
  ctrl.redirectFocus = redirectFocus;
  ctrl.attachRipple = attachRipple;
  ctrl.shouldStretchTabs = shouldStretchTabs;
  ctrl.insertTab = insertTab;
  ctrl.removeTab = removeTab;
  ctrl.select = select;
  ctrl.scroll = scroll;
  ctrl.nextPage = nextPage;
  ctrl.previousPage = previousPage;
  ctrl.keydown = keydown;
  ctrl.canPageForward = canPageForward;
  ctrl.canPageBack = canPageBack;
  ctrl.refreshIndex = refreshIndex;
  ctrl.incrementSelectedIndex = incrementSelectedIndex;
  ctrl.updateInkBarStyles = $mdUtil.debounce(updateInkBarStyles, 100);
  ctrl.updateTabOrder = $mdUtil.debounce(updateTabOrder, 100);

  init();

  /**
   * Perform initialization for the controller, setup events and watcher(s)
   */
  function init () {
    $scope.selectedIndex = $scope.selectedIndex || 0;
    compileTemplate();
    configureWatchers();
    bindEvents();
    $mdTheming($element);
    $timeout(function () {
      updateHeightFromContent();
      adjustOffset();
      updatePagination();
      ctrl.tabs[$scope.selectedIndex] && ctrl.tabs[$scope.selectedIndex].scope.select();
      loaded = true;
    });
  }

  function compileTemplate () {
    var template = $attrs.$mdTabsTemplate,
        element  = angular.element(elements.data);
    element.html(template);
    $compile(element.contents())(ctrl.parent);
    delete $attrs.$mdTabsTemplate;
  }

  function bindEvents () {
    angular.element($window).on('resize', handleWindowResize);
    angular.element(elements.paging).on('DOMSubtreeModified', ctrl.updateInkBarStyles);
    angular.element(elements.paging).on('DOMSubtreeModified', updatePagination);
  }

  function configureWatchers () {
    $mdUtil.initOptionalProperties($scope, $attrs);
    $attrs.$observe('mdNoBar', function (value) { $scope.noInkBar = angular.isDefined(value); });
    $scope.$watch('selectedIndex', handleSelectedIndexChange);
    $scope.$watch('dynamicHeight', function (value) {
      if (value) $element.addClass('md-dynamic-height');
      else $element.removeClass('md-dynamic-height');
    });
    $scope.$on('$destroy', cleanup);
  }

  /**
   * Remove any events defined by this controller
   */
  function cleanup () {
    destroyed = true;
    angular.element($window).off('resize', handleWindowResize);
    angular.element(elements.paging).off('DOMSubtreeModified', ctrl.updateInkBarStyles);
    angular.element(elements.paging).off('DOMSubtreeModified', updatePagination);
  }

  //-- Change handlers

  /**
   * Add/remove the `md-no-tab-content` class depending on `ctrl.hasContent`
   * @param hasContent
   */
  function handleHasContent (hasContent) {
    $element[hasContent ? 'removeClass' : 'addClass']('md-no-tab-content');
  }

  /**
   * Apply ctrl.offsetLeft to the paging element when it changes
   * @param left
   */
  function handleOffsetChange (left) {
    var newValue = ctrl.shouldCenterTabs ? '' : '-' + left + 'px';
    angular.element(elements.paging).css($mdConstant.CSS.TRANSFORM, 'translate3d(' + newValue + ', 0, 0)');
    $scope.$broadcast('$mdTabsPaginationChanged');
  }

  /**
   * Update the UI whenever `ctrl.focusIndex` is updated
   * @param newIndex
   * @param oldIndex
   */
  function handleFocusIndexChange (newIndex, oldIndex) {
    if (newIndex === oldIndex) return;
    if (!elements.tabs[newIndex]) return;
    adjustOffset();
    redirectFocus();
  }

  /**
   * Update the UI whenever the selected index changes. Calls user-defined select/deselect methods.
   * @param newValue
   * @param oldValue
   */
  function handleSelectedIndexChange (newValue, oldValue) {
    if (newValue === oldValue) return;

    $scope.selectedIndex = getNearestSafeIndex(newValue);
    ctrl.lastSelectedIndex = oldValue;
    ctrl.updateInkBarStyles();
    updateHeightFromContent();
    adjustOffset(newValue);
    $scope.$broadcast('$mdTabsChanged');
    ctrl.tabs[oldValue] && ctrl.tabs[oldValue].scope.deselect();
    ctrl.tabs[newValue] && ctrl.tabs[newValue].scope.select();
  }

  /**
   * Queues up a call to `handleWindowResize` when a resize occurs while the tabs component is
   * hidden.
   */
  function handleResizeWhenVisible () {
    //-- if there is already a watcher waiting for resize, do nothing
    if (handleResizeWhenVisible.watcher) return;
    //-- otherwise, we will abuse the $watch function to check for visible
    handleResizeWhenVisible.watcher = $scope.$watch(function () {
      //-- since we are checking for DOM size, we use $timeout to wait for after the DOM updates
      $timeout(function () {
        //-- if the watcher has already run (ie. multiple digests in one cycle), do nothing
        if (!handleResizeWhenVisible.watcher) return;

        if ($element.prop('offsetParent')) {
          handleResizeWhenVisible.watcher();
          handleResizeWhenVisible.watcher = null;

          //-- we have to trigger our own $apply so that the DOM bindings will update
          handleWindowResize();
        }
      }, 0, false);
    });
  }

  //-- Event handlers / actions

  /**
   * Handle user keyboard interactions
   * @param event
   */
  function keydown (event) {
    switch (event.keyCode) {
      case $mdConstant.KEY_CODE.LEFT_ARROW:
        event.preventDefault();
        incrementSelectedIndex(-1, true);
        break;
      case $mdConstant.KEY_CODE.RIGHT_ARROW:
        event.preventDefault();
        incrementSelectedIndex(1, true);
        break;
      case $mdConstant.KEY_CODE.SPACE:
      case $mdConstant.KEY_CODE.ENTER:
        event.preventDefault();
        if (!locked) $scope.selectedIndex = ctrl.focusIndex;
        break;
    }
    ctrl.lastClick = false;
  }

  /**
   * Update the selected index and trigger a click event on the original `md-tab` element in order
   * to fire user-added click events.
   * @param index
   */
  function select (index) {
    if (!locked) ctrl.focusIndex = $scope.selectedIndex = index;
    ctrl.lastClick = true;
    ctrl.tabs[index].element.triggerHandler('click');
  }

  /**
   * When pagination is on, this makes sure the selected index is in view.
   * @param event
   */
  function scroll (event) {
    if (!ctrl.shouldPaginate) return;
    event.preventDefault();
    ctrl.offsetLeft = fixOffset(ctrl.offsetLeft - event.wheelDelta);
  }

  /**
   * Slides the tabs over approximately one page forward.
   */
  function nextPage () {
    var viewportWidth = elements.canvas.clientWidth,
        totalWidth = viewportWidth + ctrl.offsetLeft,
        i, tab;
    for (i = 0; i < elements.tabs.length; i++) {
      tab = elements.tabs[i];
      if (tab.offsetLeft + tab.offsetWidth > totalWidth) break;
    }
    ctrl.offsetLeft = fixOffset(tab.offsetLeft);
  }

  /**
   * Slides the tabs over approximately one page backward.
   */
  function previousPage () {
    var i, tab;
    for (i = 0; i < elements.tabs.length; i++) {
      tab = elements.tabs[i];
      if (tab.offsetLeft + tab.offsetWidth >= ctrl.offsetLeft) break;
    }
    ctrl.offsetLeft = fixOffset(tab.offsetLeft + tab.offsetWidth - elements.canvas.clientWidth);
  }

  /**
   * Update size calculations when the window is resized.
   */
  function handleWindowResize () {
    $scope.$apply(function () {
      ctrl.lastSelectedIndex = $scope.selectedIndex;
      ctrl.offsetLeft = fixOffset(ctrl.offsetLeft);
      $timeout(ctrl.updateInkBarStyles, 0, false);
      $timeout(updatePagination);
    });
  }

  /**
   * Remove a tab from the data and select the nearest valid tab.
   * @param tabData
   */
  function removeTab (tabData) {
    var selectedIndex = $scope.selectedIndex,
        tab = ctrl.tabs.splice(tabData.getIndex(), 1)[0];
    refreshIndex();
    //-- when removing a tab, if the selected index did not change, we have to manually trigger the
    //   tab select/deselect events
    if ($scope.selectedIndex === selectedIndex && !destroyed) {
      tab.scope.deselect();
      ctrl.tabs[$scope.selectedIndex] && ctrl.tabs[$scope.selectedIndex].scope.select();
    }
    $timeout(function () {
      updatePagination();
      ctrl.offsetLeft = fixOffset(ctrl.offsetLeft);
    });
  }

  /**
   * Create an entry in the tabs array for a new tab at the specified index.
   * @param tabData
   * @param index
   * @returns {*}
   */
  function insertTab (tabData, index) {
    var proto = {
          getIndex: function () { return ctrl.tabs.indexOf(tab); },
          isActive: function () { return this.getIndex() === $scope.selectedIndex; },
          isLeft:   function () { return this.getIndex() < $scope.selectedIndex; },
          isRight:  function () { return this.getIndex() > $scope.selectedIndex; },
          shouldRender: function () { return !$scope.noDisconnect || this.isActive(); },
          hasFocus: function () { return !ctrl.lastClick
              && ctrl.hasFocus && this.getIndex() === ctrl.focusIndex; },
          id:       $mdUtil.nextUid()
        },
        tab = angular.extend(proto, tabData);
    if (angular.isDefined(index)) {
      ctrl.tabs.splice(index, 0, tab);
    } else {
      ctrl.tabs.push(tab);
    }
    processQueue();
    updateHasContent();
    //-- if autoselect is enabled, select the newly added tab
    if (loaded && $scope.autoselect) $timeout(function () { select(ctrl.tabs.indexOf(tab)); });
    $timeout(updatePagination);
    return tab;
  }

  //-- Getter methods

  /**
   * Gathers references to all of the DOM elements used by this controller.
   * @returns {{}}
   */
  function getElements () {
    var elements      = {};

    //-- gather tab bar elements
    elements.wrapper  = $element[0].getElementsByTagName('md-tabs-wrapper')[0];
    elements.data     = $element[0].getElementsByTagName('md-tab-data')[0];
    elements.canvas   = elements.wrapper.getElementsByTagName('md-tabs-canvas')[0];
    elements.paging   = elements.canvas.getElementsByTagName('md-pagination-wrapper')[0];
    elements.tabs     = elements.paging.getElementsByTagName('md-tab-item');
    elements.dummies  = elements.canvas.getElementsByTagName('md-dummy-tab');
    elements.inkBar   = elements.paging.getElementsByTagName('md-ink-bar')[0];

    //-- gather tab content elements
    elements.contentsWrapper = $element[0].getElementsByTagName('md-tabs-content-wrapper')[0];
    elements.contents = elements.contentsWrapper.getElementsByTagName('md-tab-content');

    return elements;
  }

  /**
   * Determines whether or not the left pagination arrow should be enabled.
   * @returns {boolean}
   */
  function canPageBack () {
    return ctrl.offsetLeft > 0;
  }

  /**
   * Determines whether or not the right pagination arrow should be enabled.
   * @returns {*|boolean}
   */
  function canPageForward () {
    var lastTab = elements.tabs[elements.tabs.length - 1];
    return lastTab && lastTab.offsetLeft + lastTab.offsetWidth > elements.canvas.clientWidth +
        ctrl.offsetLeft;
  }

  /**
   * Determines if the UI should stretch the tabs to fill the available space.
   * @returns {*}
   */
  function shouldStretchTabs () {
    switch ($scope.stretchTabs) {
      case 'always': return true;
      case 'never':  return false;
      default:       return !ctrl.shouldPaginate
          && $window.matchMedia('(max-width: 600px)').matches;
    }
  }

  /**
   * Determines if the tabs should appear centered.
   * @returns {string|boolean}
   */
  function shouldCenterTabs () {
    return $scope.centerTabs && !ctrl.shouldPaginate;
  }

  /**
   * Determines if pagination is necessary to display the tabs within the available space.
   * @returns {boolean}
   */
  function shouldPaginate () {
    if ($scope.noPagination || !loaded) return false;
    var canvasWidth = $element.prop('clientWidth');
    angular.forEach(elements.dummies, function (tab) { canvasWidth -= tab.offsetWidth; });
    return canvasWidth < 0;
  }

  /**
   * Finds the nearest tab index that is available.  This is primarily used for when the active
   * tab is removed.
   * @param newIndex
   * @returns {*}
   */
  function getNearestSafeIndex(newIndex) {
    var maxOffset = Math.max(ctrl.tabs.length - newIndex, newIndex),
        i, tab;
    for (i = 0; i <= maxOffset; i++) {
      tab = ctrl.tabs[newIndex + i];
      if (tab && (tab.scope.disabled !== true)) return tab.getIndex();
      tab = ctrl.tabs[newIndex - i];
      if (tab && (tab.scope.disabled !== true)) return tab.getIndex();
    }
    return newIndex;
  }

  //-- Utility methods

  /**
   * Defines a property using a getter and setter in order to trigger a change handler without
   * using `$watch` to observe changes.
   * @param key
   * @param handler
   * @param value
   */
  function defineProperty (key, handler, value) {
    Object.defineProperty(ctrl, key, {
      get: function () { return value; },
      set: function (newValue) {
        var oldValue = value;
        value = newValue;
        handler(newValue, oldValue);
      }
    });
  }

  /**
   * Updates whether or not pagination should be displayed.
   */
  function updatePagination () {
    ctrl.shouldPaginate = shouldPaginate();
    ctrl.shouldCenterTabs = shouldCenterTabs();
    $timeout(function () {
      adjustOffset($scope.selectedIndex);
    });
  }

  /**
   * Re-orders the tabs and updates the selected and focus indexes to their new positions.
   * This is triggered by `tabDirective.js` when the user's tabs have been re-ordered.
   */
  function updateTabOrder () {
    var selectedItem = ctrl.tabs[$scope.selectedIndex],
        focusItem = ctrl.tabs[ctrl.focusIndex];
    ctrl.tabs = ctrl.tabs.sort(function (a, b) {
      return a.index - b.index;
    });
    $scope.selectedIndex = ctrl.tabs.indexOf(selectedItem);
    ctrl.focusIndex = ctrl.tabs.indexOf(focusItem);
  }

  /**
   * This moves the selected or focus index left or right.  This is used by the keydown handler.
   * @param inc
   */
  function incrementSelectedIndex (inc) {
    var newIndex,
        index = ctrl.focusIndex;
    for (newIndex = index + inc;
         ctrl.tabs[newIndex] && ctrl.tabs[newIndex].scope.disabled;
         newIndex += inc) {}
    if (ctrl.tabs[newIndex]) {
      ctrl.focusIndex = newIndex;
    }
  }

  /**
   * This is used to forward focus to dummy elements.  This method is necessary to avoid aniation
   * issues when attempting to focus an item that is out of view.
   */
  function redirectFocus () {
    elements.dummies[ctrl.focusIndex].focus();
  }

  /**
   * Forces the pagination to move the focused tab into view.
   */
  function adjustOffset (index) {
    if (!elements.tabs[index]) return;
    if (ctrl.shouldCenterTabs) return;
    if (index == null) index = ctrl.focusIndex;
    var tab = elements.tabs[index],
        left = tab.offsetLeft,
        right = tab.offsetWidth + left;
    ctrl.offsetLeft = Math.max(ctrl.offsetLeft, fixOffset(right - elements.canvas.clientWidth));
    ctrl.offsetLeft = Math.min(ctrl.offsetLeft, fixOffset(left));
  }

  /**
   * Iterates through all queued functions and clears the queue.  This is used for functions that
   * are called before the UI is ready, such as size calculations.
   */
  function processQueue () {
    queue.forEach(function (func) { $timeout(func); });
    queue = [];
  }

  /**
   * Determines if the tab content area is needed.
   */
  function updateHasContent () {
    var hasContent = false;
    angular.forEach(ctrl.tabs, function (tab) {
      if (tab.template) hasContent = true;
    });
    ctrl.hasContent = hasContent;
  }

  /**
   * Moves the indexes to their nearest valid values.
   */
  function refreshIndex () {
    $scope.selectedIndex = getNearestSafeIndex($scope.selectedIndex);
    ctrl.focusIndex = getNearestSafeIndex(ctrl.focusIndex);
  }

  /**
   * Calculates the content height of the current tab.
   * @returns {*}
   */
  function updateHeightFromContent () {
    if (!$scope.dynamicHeight) return $element.css('height', '');
    if (!ctrl.tabs.length) return queue.push(updateHeightFromContent);
    var tabContent    = elements.contents[$scope.selectedIndex],
        contentHeight = tabContent ? tabContent.offsetHeight : 0,
        tabsHeight    = elements.wrapper.offsetHeight,
        newHeight     = contentHeight + tabsHeight,
        currentHeight = $element.prop('clientHeight');
    if (currentHeight === newHeight) return;
    locked = true;
    $animate
        .animate(
          $element,
          { height: currentHeight + 'px' },
          { height: newHeight + 'px'}
        )
        .then(function () {
          $element.css('height', '');
          locked = false;
        });
  }

  /**
   * Repositions the ink bar to the selected tab.
   * @returns {*}
   */
  function updateInkBarStyles () {
    if (!elements.tabs[$scope.selectedIndex]) return;
    if (!ctrl.tabs.length) return queue.push(ctrl.updateInkBarStyles);
    //-- if the element is not visible, we will not be able to calculate sizes until it is
    //-- we should treat that as a resize event rather than just updating the ink bar
    if (!$element.prop('offsetParent')) return handleResizeWhenVisible();
    var index = $scope.selectedIndex,
        totalWidth = elements.paging.offsetWidth,
        tab = elements.tabs[index],
        left = tab.offsetLeft,
        right = totalWidth - left - tab.offsetWidth;
    updateInkBarClassName();
    angular.element(elements.inkBar).css({ left: left + 'px', right: right + 'px' });
  }

  /**
   * Adds left/right classes so that the ink bar will animate properly.
   */
  function updateInkBarClassName () {
    var newIndex = $scope.selectedIndex,
        oldIndex = ctrl.lastSelectedIndex,
        ink = angular.element(elements.inkBar);
    if (!angular.isNumber(oldIndex)) return;
    if (newIndex < oldIndex) {
      ink.addClass('md-left').removeClass('md-right');
    } else if (newIndex > oldIndex) {
      ink.addClass('md-right').removeClass('md-left');
    }
  }

  /**
   * Takes an offset value and makes sure that it is within the min/max allowed values.
   * @param value
   * @returns {*}
   */
  function fixOffset (value) {
    if (!elements.tabs.length || !ctrl.shouldPaginate) return 0;
    var lastTab = elements.tabs[elements.tabs.length - 1],
        totalWidth = lastTab.offsetLeft + lastTab.offsetWidth;
    value = Math.max(0, value);
    value = Math.min(totalWidth - elements.canvas.clientWidth, value);
    return value;
  }

  /**
   * Attaches a ripple to the tab item element.
   * @param scope
   * @param element
   */
  function attachRipple (scope, element) {
    var options = { colorElement: angular.element(elements.inkBar) };
    $mdTabInkRipple.attach(scope, element, options);
  }
}
MdTabsController.$inject = ["$scope", "$element", "$window", "$timeout", "$mdConstant", "$mdTabInkRipple", "$mdUtil", "$animate", "$attrs", "$compile", "$mdTheming"];

})();
(function(){
"use strict";

/**
 * @ngdoc directive
 * @name mdTabs
 * @module material.components.tabs
 *
 * @restrict E
 *
 * @description
 * The `<md-tabs>` directive serves as the container for 1..n `<md-tab>` child directives to produces a Tabs components.
 * In turn, the nested `<md-tab>` directive is used to specify a tab label for the **header button** and a [optional] tab view
 * content that will be associated with each tab button.
 *
 * Below is the markup for its simplest usage:
 *
 *  <hljs lang="html">
 *  <md-tabs>
 *    <md-tab label="Tab #1"></md-tab>
 *    <md-tab label="Tab #2"></md-tab>
 *    <md-tab label="Tab #3"></md-tab>
 *  </md-tabs>
 *  </hljs>
 *
 * Tabs supports three (3) usage scenarios:
 *
 *  1. Tabs (buttons only)
 *  2. Tabs with internal view content
 *  3. Tabs with external view content
 *
 * **Tab-only** support is useful when tab buttons are used for custom navigation regardless of any other components, content, or views.
 * **Tabs with internal views** are the traditional usages where each tab has associated view content and the view switching is managed internally by the Tabs component.
 * **Tabs with external view content** is often useful when content associated with each tab is independently managed and data-binding notifications announce tab selection changes.
 *
 * Additional features also include:
 *
 * *  Content can include any markup.
 * *  If a tab is disabled while active/selected, then the next tab will be auto-selected.
 *
 * ### Explanation of tab stretching
 *
 * Initially, tabs will have an inherent size.  This size will either be defined by how much space is needed to accommodate their text or set by the user through CSS.  Calculations will be based on this size.
 *
 * On mobile devices, tabs will be expanded to fill the available horizontal space.  When this happens, all tabs will become the same size.
 *
 * On desktops, by default, stretching will never occur.
 *
 * This default behavior can be overridden through the `md-stretch-tabs` attribute.  Here is a table showing when stretching will occur:
 *
 * `md-stretch-tabs` | mobile    | desktop
 * ------------------|-----------|--------
 * `auto`            | stretched | ---
 * `always`          | stretched | stretched
 * `never`           | ---       | ---
 *
 * @param {integer=} md-selected Index of the active/selected tab
 * @param {boolean=} md-no-ink If present, disables ink ripple effects.
 * @param {boolean=} md-no-bar If present, disables the selection ink bar.
 * @param {string=}  md-align-tabs Attribute to indicate position of tab buttons: `bottom` or `top`; default is `top`
 * @param {string=} md-stretch-tabs Attribute to indicate whether or not to stretch tabs: `auto`, `always`, or `never`; default is `auto`
 * @param {boolean=} md-dynamic-height When enabled, the tab wrapper will resize based on the contents of the selected tab
 * @param {boolean=} md-center-tabs When enabled, tabs will be centered provided there is no need for pagination
 * @param {boolean=} md-no-pagination When enabled, pagination will remain off
 * @param {boolean=} md-swipe-content When enabled, swipe gestures will be enabled for the content area to jump between tabs
 * @param {boolean=} md-no-disconnect If your tab content has background tasks (ie. event listeners), you will want to include this to prevent the scope from being disconnected
 * @param {boolean=} md-autoselect When present, any tabs added after the initial load will be automatically selected
 *
 * @usage
 * <hljs lang="html">
 * <md-tabs md-selected="selectedIndex" >
 *   <img ng-src="img/angular.png" class="centered">
 *   <md-tab
 *       ng-repeat="tab in tabs | orderBy:predicate:reversed"
 *       md-on-select="onTabSelected(tab)"
 *       md-on-deselect="announceDeselected(tab)"
 *       ng-disabled="tab.disabled">
 *     <md-tab-label>
 *       {{tab.title}}
 *       <img src="img/removeTab.png" ng-click="removeTab(tab)" class="delete">
 *     </md-tab-label>
 *     <md-tab-body>
 *       {{tab.content}}
 *     </md-tab-body>
 *   </md-tab>
 * </md-tabs>
 * </hljs>
 *
 */
angular
    .module('material.components.tabs')
    .directive('mdTabs', MdTabs);

function MdTabs ($mdTheming, $mdUtil, $compile) {
  return {
    scope: {
      noPagination:  '=?mdNoPagination',
      dynamicHeight: '=?mdDynamicHeight',
      centerTabs:    '=?mdCenterTabs',
      selectedIndex: '=?mdSelected',
      stretchTabs:   '@?mdStretchTabs',
      swipeContent:  '=?mdSwipeContent',
      noDisconnect:  '=?mdNoDisconnect',
      autoselect:    '=?mdAutoselect'
    },
    template: function (element, attr) {
      attr["$mdTabsTemplate"] = element.html();
      return '\
        <md-tabs-wrapper ng-class="{ \'md-stretch-tabs\': $mdTabsCtrl.shouldStretchTabs() }">\
          <md-tab-data></md-tab-data>\
          <md-prev-button\
              tabindex="-1"\
              role="button"\
              aria-label="Previous Page"\
              aria-disabled="{{!$mdTabsCtrl.canPageBack()}}"\
              ng-class="{ \'md-disabled\': !$mdTabsCtrl.canPageBack() }"\
              ng-if="$mdTabsCtrl.shouldPaginate"\
              ng-click="$mdTabsCtrl.previousPage()">\
            <md-icon md-svg-icon="md-tabs-arrow"></md-icon>\
          </md-prev-button>\
          <md-next-button\
              tabindex="-1"\
              role="button"\
              aria-label="Next Page"\
              aria-disabled="{{!$mdTabsCtrl.canPageForward()}}"\
              ng-class="{ \'md-disabled\': !$mdTabsCtrl.canPageForward() }"\
              ng-if="$mdTabsCtrl.shouldPaginate"\
              ng-click="$mdTabsCtrl.nextPage()">\
            <md-icon md-svg-icon="md-tabs-arrow"></md-icon>\
          </md-next-button>\
          <md-tabs-canvas\
              tabindex="0"\
              aria-activedescendant="tab-item-{{$mdTabsCtrl.tabs[$mdTabsCtrl.focusIndex].id}}"\
              ng-focus="$mdTabsCtrl.redirectFocus()"\
              ng-class="{\
                  \'md-paginated\': $mdTabsCtrl.shouldPaginate,\
                  \'md-center-tabs\': $mdTabsCtrl.shouldCenterTabs\
              }"\
              ng-keydown="$mdTabsCtrl.keydown($event)"\
              role="tablist">\
            <md-pagination-wrapper\
                ng-class="{ \'md-center-tabs\': $mdTabsCtrl.shouldCenterTabs }"\
                md-tab-scroll="$mdTabsCtrl.scroll($event)">\
              <md-tab-item\
                  tabindex="-1"\
                  class="md-tab"\
                  style="max-width: {{ tabWidth ? tabWidth + \'px\' : \'none\' }}"\
                  ng-repeat="tab in $mdTabsCtrl.tabs"\
                  role="tab"\
                  aria-controls="tab-content-{{tab.id}}"\
                  aria-selected="{{tab.isActive()}}"\
                  aria-disabled="{{tab.scope.disabled || \'false\'}}"\
                  ng-click="$mdTabsCtrl.select(tab.getIndex())"\
                  ng-class="{\
                      \'md-active\':    tab.isActive(),\
                      \'md-focused\':   tab.hasFocus(),\
                      \'md-disabled\':  tab.scope.disabled\
                  }"\
                  ng-disabled="tab.scope.disabled"\
                  md-swipe-left="$mdTabsCtrl.nextPage()"\
                  md-swipe-right="$mdTabsCtrl.previousPage()"\
                  md-template="tab.label"\
                  md-scope="tab.parent"></md-tab-item>\
              <md-ink-bar ng-hide="noInkBar"></md-ink-bar>\
            </md-pagination-wrapper>\
            <div class="md-visually-hidden md-dummy-wrapper">\
              <md-dummy-tab\
                  class="md-tab"\
                  tabindex="-1"\
                  id="tab-item-{{tab.id}}"\
                  role="tab"\
                  aria-controls="tab-content-{{tab.id}}"\
                  aria-selected="{{tab.isActive()}}"\
                  aria-disabled="{{tab.scope.disabled || \'false\'}}"\
                  ng-focus="$mdTabsCtrl.hasFocus = true"\
                  ng-blur="$mdTabsCtrl.hasFocus = false"\
                  ng-repeat="tab in $mdTabsCtrl.tabs"\
                  md-template="tab.label"\
                  md-scope="tab.parent"></md-dummy-tab>\
            </div>\
          </md-tabs-canvas>\
        </md-tabs-wrapper>\
        <md-tabs-content-wrapper ng-show="$mdTabsCtrl.hasContent">\
          <md-tab-content\
              id="tab-content-{{tab.id}}"\
              role="tabpanel"\
              aria-labelledby="tab-item-{{tab.id}}"\
              md-swipe-left="swipeContent && $mdTabsCtrl.incrementSelectedIndex(1)"\
              md-swipe-right="swipeContent && $mdTabsCtrl.incrementSelectedIndex(-1)"\
              ng-if="$mdTabsCtrl.hasContent"\
              ng-repeat="(index, tab) in $mdTabsCtrl.tabs"\
              md-connected-if="tab.isActive()"\
              ng-class="{\
                \'md-no-transition\': $mdTabsCtrl.lastSelectedIndex == null,\
                \'md-active\':        tab.isActive(),\
                \'md-left\':          tab.isLeft(),\
                \'md-right\':         tab.isRight(),\
                \'md-no-scroll\':     dynamicHeight\
              }">\
            <div\
                md-template="tab.template"\
                md-scope="tab.parent"\
                ng-if="tab.shouldRender()"></div>\
          </md-tab-content>\
        </md-tabs-content-wrapper>\
      ';
    },
    controller: 'MdTabsController',
    controllerAs: '$mdTabsCtrl'
  };
}
MdTabs.$inject = ["$mdTheming", "$mdUtil", "$compile"];

})();
(function(){
"use strict";

angular
    .module('material.components.tabs')
    .directive('mdTemplate', MdTemplate);

function MdTemplate ($compile, $mdUtil, $timeout) {
  return {
    restrict: 'A',
    link: link,
    scope: {
      template: '=mdTemplate',
      compileScope: '=mdScope',
      connected: '=?mdConnectedIf'
    },
    require: '^?mdTabs'
  };
  function link (scope, element, attr, ctrl) {
    if (!ctrl) return;
    var compileScope = scope.compileScope.$new();
    element.html(scope.template);
    $compile(element.contents())(compileScope);
    return $timeout(handleScope);
    function handleScope () {
      scope.$watch('connected', function (value) { value === false ? disconnect() : reconnect(); });
      scope.$on('$destroy', reconnect);
    }
    function disconnect () {
      if (ctrl.scope.noDisconnect) return;
      $mdUtil.disconnectScope(compileScope);
    }
    function reconnect () {
      if (ctrl.scope.noDisconnect) return;
      $mdUtil.reconnectScope(compileScope);
    }
  }
}
MdTemplate.$inject = ["$compile", "$mdUtil", "$timeout"];

})();
(function(){ 
angular.module("material.core").constant("$MD_THEME_CSS", "/* mixin definition ; sets LTR and RTL within the same style call */md-autocomplete.md-THEME_NAME-theme {  background: '{{background-50}}'; }  md-autocomplete.md-THEME_NAME-theme[disabled] {    background: '{{background-100}}'; }  md-autocomplete.md-THEME_NAME-theme button md-icon path {    fill: '{{background-600}}'; }  md-autocomplete.md-THEME_NAME-theme button:after {    background: '{{background-600-0.3}}'; }.md-autocomplete-suggestions.md-THEME_NAME-theme {  background: '{{background-50}}'; }  .md-autocomplete-suggestions.md-THEME_NAME-theme li {    color: '{{background-900}}'; }    .md-autocomplete-suggestions.md-THEME_NAME-theme li .highlight {      color: '{{background-600}}'; }    .md-autocomplete-suggestions.md-THEME_NAME-theme li:hover, .md-autocomplete-suggestions.md-THEME_NAME-theme li.selected {      background: '{{background-200}}'; }md-backdrop.md-opaque.md-THEME_NAME-theme {  background-color: '{{foreground-4-0.5}}'; }md-bottom-sheet.md-THEME_NAME-theme {  background-color: '{{background-50}}';  border-top-color: '{{background-300}}'; }  md-bottom-sheet.md-THEME_NAME-theme.md-list md-list-item {    color: '{{foreground-1}}'; }  md-bottom-sheet.md-THEME_NAME-theme .md-subheader {    background-color: '{{background-50}}'; }  md-bottom-sheet.md-THEME_NAME-theme .md-subheader {    color: '{{foreground-1}}'; }a.md-button.md-THEME_NAME-theme, .md-button.md-THEME_NAME-theme {  border-radius: 3px; }  a.md-button.md-THEME_NAME-theme:not([disabled]):hover, .md-button.md-THEME_NAME-theme:not([disabled]):hover {    background-color: '{{background-500-0.2}}'; }  a.md-button.md-THEME_NAME-theme:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme:not([disabled]).md-focused {    background-color: '{{background-500-0.2}}'; }  a.md-button.md-THEME_NAME-theme:not([disabled]).md-icon-button:hover, .md-button.md-THEME_NAME-theme:not([disabled]).md-icon-button:hover {    background-color: transparent; }  a.md-button.md-THEME_NAME-theme.md-fab, .md-button.md-THEME_NAME-theme.md-fab {    border-radius: 50%;    background-color: '{{accent-color}}';    color: '{{accent-contrast}}'; }    a.md-button.md-THEME_NAME-theme.md-fab md-icon, .md-button.md-THEME_NAME-theme.md-fab md-icon {      color: '{{accent-contrast}}'; }    a.md-button.md-THEME_NAME-theme.md-fab:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-fab:not([disabled]):hover {      background-color: '{{accent-color}}'; }    a.md-button.md-THEME_NAME-theme.md-fab:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-fab:not([disabled]).md-focused {      background-color: '{{accent-A700}}'; }  a.md-button.md-THEME_NAME-theme.md-icon-button, .md-button.md-THEME_NAME-theme.md-icon-button {    border-radius: 50%; }  a.md-button.md-THEME_NAME-theme.md-primary, .md-button.md-THEME_NAME-theme.md-primary {    color: '{{primary-color}}'; }    a.md-button.md-THEME_NAME-theme.md-primary.md-raised, a.md-button.md-THEME_NAME-theme.md-primary.md-fab, .md-button.md-THEME_NAME-theme.md-primary.md-raised, .md-button.md-THEME_NAME-theme.md-primary.md-fab {      color: '{{primary-contrast}}';      background-color: '{{primary-color}}'; }      a.md-button.md-THEME_NAME-theme.md-primary.md-raised:not([disabled]) md-icon, a.md-button.md-THEME_NAME-theme.md-primary.md-fab:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-primary.md-raised:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-primary.md-fab:not([disabled]) md-icon {        color: '{{primary-contrast}}'; }      a.md-button.md-THEME_NAME-theme.md-primary.md-raised:not([disabled]):hover, a.md-button.md-THEME_NAME-theme.md-primary.md-fab:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-primary.md-raised:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-primary.md-fab:not([disabled]):hover {        background-color: '{{primary-color}}'; }      a.md-button.md-THEME_NAME-theme.md-primary.md-raised:not([disabled]).md-focused, a.md-button.md-THEME_NAME-theme.md-primary.md-fab:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-primary.md-raised:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-primary.md-fab:not([disabled]).md-focused {        background-color: '{{primary-600}}'; }    a.md-button.md-THEME_NAME-theme.md-primary:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-primary:not([disabled]) md-icon {      color: '{{primary-color}}'; }  a.md-button.md-THEME_NAME-theme.md-fab, .md-button.md-THEME_NAME-theme.md-fab {    border-radius: 50%;    background-color: '{{accent-color}}';    color: '{{accent-contrast}}'; }    a.md-button.md-THEME_NAME-theme.md-fab:not([disabled]) .md-icon, .md-button.md-THEME_NAME-theme.md-fab:not([disabled]) .md-icon {      color: '{{accent-contrast}}'; }    a.md-button.md-THEME_NAME-theme.md-fab:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-fab:not([disabled]):hover {      background-color: '{{accent-color}}'; }    a.md-button.md-THEME_NAME-theme.md-fab:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-fab:not([disabled]).md-focused {      background-color: '{{accent-A700}}'; }  a.md-button.md-THEME_NAME-theme.md-raised, .md-button.md-THEME_NAME-theme.md-raised {    color: '{{background-contrast}}';    background-color: '{{background-50}}'; }    a.md-button.md-THEME_NAME-theme.md-raised:not([disabled]) .md-icon, .md-button.md-THEME_NAME-theme.md-raised:not([disabled]) .md-icon {      color: '{{background-contrast}}'; }    a.md-button.md-THEME_NAME-theme.md-raised:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-raised:not([disabled]):hover {      background-color: '{{background-50}}'; }    a.md-button.md-THEME_NAME-theme.md-raised:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-raised:not([disabled]).md-focused {      background-color: '{{background-200}}'; }  a.md-button.md-THEME_NAME-theme.md-warn, .md-button.md-THEME_NAME-theme.md-warn {    color: '{{warn-color}}'; }    a.md-button.md-THEME_NAME-theme.md-warn.md-raised, a.md-button.md-THEME_NAME-theme.md-warn.md-fab, .md-button.md-THEME_NAME-theme.md-warn.md-raised, .md-button.md-THEME_NAME-theme.md-warn.md-fab {      color: '{{warn-contrast}}';      background-color: '{{warn-color}}'; }      a.md-button.md-THEME_NAME-theme.md-warn.md-raised:not([disabled]) md-icon, a.md-button.md-THEME_NAME-theme.md-warn.md-fab:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-warn.md-raised:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-warn.md-fab:not([disabled]) md-icon {        color: '{{warn-contrast}}'; }      a.md-button.md-THEME_NAME-theme.md-warn.md-raised:not([disabled]):hover, a.md-button.md-THEME_NAME-theme.md-warn.md-fab:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-warn.md-raised:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-warn.md-fab:not([disabled]):hover {        background-color: '{{warn-color}}'; }      a.md-button.md-THEME_NAME-theme.md-warn.md-raised:not([disabled]).md-focused, a.md-button.md-THEME_NAME-theme.md-warn.md-fab:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-warn.md-raised:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-warn.md-fab:not([disabled]).md-focused {        background-color: '{{warn-700}}'; }    a.md-button.md-THEME_NAME-theme.md-warn:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-warn:not([disabled]) md-icon {      color: '{{warn-color}}'; }  a.md-button.md-THEME_NAME-theme.md-accent, .md-button.md-THEME_NAME-theme.md-accent {    color: '{{accent-color}}'; }    a.md-button.md-THEME_NAME-theme.md-accent.md-raised, a.md-button.md-THEME_NAME-theme.md-accent.md-fab, .md-button.md-THEME_NAME-theme.md-accent.md-raised, .md-button.md-THEME_NAME-theme.md-accent.md-fab {      color: '{{accent-contrast}}';      background-color: '{{accent-color}}'; }      a.md-button.md-THEME_NAME-theme.md-accent.md-raised:not([disabled]) md-icon, a.md-button.md-THEME_NAME-theme.md-accent.md-fab:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-accent.md-raised:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-accent.md-fab:not([disabled]) md-icon {        color: '{{accent-contrast}}'; }      a.md-button.md-THEME_NAME-theme.md-accent.md-raised:not([disabled]):hover, a.md-button.md-THEME_NAME-theme.md-accent.md-fab:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-accent.md-raised:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-accent.md-fab:not([disabled]):hover {        background-color: '{{accent-color}}'; }      a.md-button.md-THEME_NAME-theme.md-accent.md-raised:not([disabled]).md-focused, a.md-button.md-THEME_NAME-theme.md-accent.md-fab:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-accent.md-raised:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-accent.md-fab:not([disabled]).md-focused {        background-color: '{{accent-700}}'; }    a.md-button.md-THEME_NAME-theme.md-accent:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-accent:not([disabled]) md-icon {      color: '{{accent-color}}'; }  a.md-button.md-THEME_NAME-theme[disabled], a.md-button.md-THEME_NAME-theme.md-raised[disabled], a.md-button.md-THEME_NAME-theme.md-fab[disabled], a.md-button.md-THEME_NAME-theme.md-accent[disabled], a.md-button.md-THEME_NAME-theme.md-warn[disabled], .md-button.md-THEME_NAME-theme[disabled], .md-button.md-THEME_NAME-theme.md-raised[disabled], .md-button.md-THEME_NAME-theme.md-fab[disabled], .md-button.md-THEME_NAME-theme.md-accent[disabled], .md-button.md-THEME_NAME-theme.md-warn[disabled] {    color: '{{foreground-3}}';    cursor: not-allowed; }    a.md-button.md-THEME_NAME-theme[disabled] md-icon, a.md-button.md-THEME_NAME-theme.md-raised[disabled] md-icon, a.md-button.md-THEME_NAME-theme.md-fab[disabled] md-icon, a.md-button.md-THEME_NAME-theme.md-accent[disabled] md-icon, a.md-button.md-THEME_NAME-theme.md-warn[disabled] md-icon, .md-button.md-THEME_NAME-theme[disabled] md-icon, .md-button.md-THEME_NAME-theme.md-raised[disabled] md-icon, .md-button.md-THEME_NAME-theme.md-fab[disabled] md-icon, .md-button.md-THEME_NAME-theme.md-accent[disabled] md-icon, .md-button.md-THEME_NAME-theme.md-warn[disabled] md-icon {      color: '{{foreground-3}}'; }  a.md-button.md-THEME_NAME-theme.md-raised[disabled], a.md-button.md-THEME_NAME-theme.md-fab[disabled], .md-button.md-THEME_NAME-theme.md-raised[disabled], .md-button.md-THEME_NAME-theme.md-fab[disabled] {    background-color: '{{foreground-4}}'; }  a.md-button.md-THEME_NAME-theme[disabled], .md-button.md-THEME_NAME-theme[disabled] {    background-color: transparent; }md-card.md-THEME_NAME-theme {  background-color: '{{background-color}}';  border-radius: 2px; }  md-card.md-THEME_NAME-theme .md-card-image {    border-radius: 2px 2px 0 0; }md-checkbox.md-THEME_NAME-theme .md-ripple {  color: '{{accent-600}}'; }md-checkbox.md-THEME_NAME-theme.md-checked .md-ripple {  color: '{{background-600}}'; }md-checkbox.md-THEME_NAME-theme.md-checked.md-focused .md-container:before {  background-color: '{{accent-color-0.26}}'; }md-checkbox.md-THEME_NAME-theme .md-icon {  border-color: '{{foreground-2}}'; }md-checkbox.md-THEME_NAME-theme.md-checked .md-icon {  background-color: '{{accent-color-0.87}}'; }md-checkbox.md-THEME_NAME-theme.md-checked .md-icon:after {  border-color: '{{background-200}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-primary .md-ripple {  color: '{{primary-600}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked .md-ripple {  color: '{{background-600}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-primary .md-icon {  border-color: '{{foreground-2}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked .md-icon {  background-color: '{{primary-color-0.87}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked.md-focused .md-container:before {  background-color: '{{primary-color-0.26}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked .md-icon:after {  border-color: '{{background-200}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-warn .md-ripple {  color: '{{warn-600}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-warn .md-icon {  border-color: '{{foreground-2}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-warn.md-checked .md-icon {  background-color: '{{warn-color-0.87}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-warn.md-checked.md-focused:not([disabled]) .md-container:before {  background-color: '{{warn-color-0.26}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-warn.md-checked .md-icon:after {  border-color: '{{background-200}}'; }md-checkbox.md-THEME_NAME-theme[disabled] .md-icon {  border-color: '{{foreground-3}}'; }md-checkbox.md-THEME_NAME-theme[disabled].md-checked .md-icon {  background-color: '{{foreground-3}}'; }md-checkbox.md-THEME_NAME-theme[disabled] .md-label {  color: '{{foreground-3}}'; }md-chips.md-THEME_NAME-theme .md-chips {  box-shadow: 0 1px '{{background-300}}'; }  md-chips.md-THEME_NAME-theme .md-chips.md-focused {    box-shadow: 0 2px '{{primary-color}}'; }md-chips.md-THEME_NAME-theme .md-chip {  background: '{{background-300}}';  color: '{{background-800}}'; }  md-chips.md-THEME_NAME-theme .md-chip.md-focused {    background: '{{primary-color}}';    color: '{{primary-contrast}}'; }    md-chips.md-THEME_NAME-theme .md-chip.md-focused md-icon {      color: '{{primary-contrast}}'; }md-chips.md-THEME_NAME-theme md-chip-remove .md-button md-icon path {  fill: '{{background-500}}'; }.md-contact-suggestion span.md-contact-email {  color: '{{background-400}}'; }md-content.md-THEME_NAME-theme {  background-color: '{{background-color}}'; }md-dialog.md-THEME_NAME-theme {  border-radius: 4px;  background-color: '{{background-color}}'; }  md-dialog.md-THEME_NAME-theme.md-content-overflow .md-actions {    border-top-color: '{{foreground-4}}'; }md-divider.md-THEME_NAME-theme {  border-top-color: '{{foreground-4}}'; }md-icon.md-THEME_NAME-theme {  color: '{{foreground-2}}'; }  md-icon.md-THEME_NAME-theme.md-primary {    color: '{{primary-color}}'; }  md-icon.md-THEME_NAME-theme.md-accent {    color: '{{accent-color}}'; }  md-icon.md-THEME_NAME-theme.md-warn {    color: '{{warn-color}}'; }md-input-container.md-THEME_NAME-theme .md-input {  color: '{{foreground-1}}';  border-color: '{{foreground-4}}';  text-shadow: '{{foreground-shadow}}'; }  md-input-container.md-THEME_NAME-theme .md-input::-webkit-input-placeholder, md-input-container.md-THEME_NAME-theme .md-input::-moz-placeholder, md-input-container.md-THEME_NAME-theme .md-input:-moz-placeholder, md-input-container.md-THEME_NAME-theme .md-input:-ms-input-placeholder {    color: '{{foreground-3}}'; }md-input-container.md-THEME_NAME-theme > md-icon {  color: '{{foreground-1}}'; }md-input-container.md-THEME_NAME-theme label, md-input-container.md-THEME_NAME-theme .md-placeholder {  text-shadow: '{{foreground-shadow}}';  color: '{{foreground-3}}'; }md-input-container.md-THEME_NAME-theme ng-messages, md-input-container.md-THEME_NAME-theme [ng-message], md-input-container.md-THEME_NAME-theme [data-ng-message], md-input-container.md-THEME_NAME-theme [x-ng-message] {  color: '{{warn-500}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-has-value label {  color: '{{foreground-2}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-focused .md-input {  border-color: '{{primary-500}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-focused label {  color: '{{primary-500}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-focused md-icon {  color: '{{primary-500}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-focused.md-accent .md-input {  border-color: '{{accent-500}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-focused.md-accent label {  color: '{{accent-500}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-focused.md-warn .md-input {  border-color: '{{warn-500}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-focused.md-warn label {  color: '{{warn-500}}'; }md-input-container.md-THEME_NAME-theme.md-input-invalid .md-input {  border-color: '{{warn-500}}'; }md-input-container.md-THEME_NAME-theme.md-input-invalid.md-input-focused label {  color: '{{warn-500}}'; }md-input-container.md-THEME_NAME-theme.md-input-invalid ng-message, md-input-container.md-THEME_NAME-theme.md-input-invalid data-ng-message, md-input-container.md-THEME_NAME-theme.md-input-invalid x-ng-message, md-input-container.md-THEME_NAME-theme.md-input-invalid [ng-message], md-input-container.md-THEME_NAME-theme.md-input-invalid [data-ng-message], md-input-container.md-THEME_NAME-theme.md-input-invalid [x-ng-message], md-input-container.md-THEME_NAME-theme.md-input-invalid .md-char-counter {  color: '{{warn-500}}'; }md-input-container.md-THEME_NAME-theme .md-input[disabled], [disabled] md-input-container.md-THEME_NAME-theme .md-input {  border-bottom-color: transparent;  color: '{{foreground-3}}';  background-image: linear-gradient(to right, '{{foreground-3}}' 0%, '{{foreground-3}}' 33%, transparent 0%);  background-image: -ms-linear-gradient(left, transparent 0%, '{{foreground-3}}' 100%); }md-list.md-THEME_NAME-theme md-list-item.md-2-line .md-list-item-text h3, md-list.md-THEME_NAME-theme md-list-item.md-2-line .md-list-item-text h4, md-list.md-THEME_NAME-theme md-list-item.md-3-line .md-list-item-text h3, md-list.md-THEME_NAME-theme md-list-item.md-3-line .md-list-item-text h4 {  color: '{{foreground-1}}'; }md-list.md-THEME_NAME-theme md-list-item.md-2-line .md-list-item-text p, md-list.md-THEME_NAME-theme md-list-item.md-3-line .md-list-item-text p {  color: '{{foreground-2}}'; }md-list.md-THEME_NAME-theme .md-proxy-focus.md-focused div.md-no-style {  background-color: '{{background-100}}'; }md-list.md-THEME_NAME-theme md-list-item > md-icon {  color: '{{foreground-2}}'; }  md-list.md-THEME_NAME-theme md-list-item > md-icon.md-highlight {    color: '{{primary-color}}'; }    md-list.md-THEME_NAME-theme md-list-item > md-icon.md-highlight.md-accent {      color: '{{accent-color}}'; }md-list.md-THEME_NAME-theme md-list-item button {  background-color: '{{background-color}}'; }  md-list.md-THEME_NAME-theme md-list-item button.md-button:not([disabled]):hover {    background-color: '{{background-color}}'; }md-menu-content.md-THEME_NAME-theme {  background-color: '{{background-color}}'; }  md-menu-content.md-THEME_NAME-theme md-menu-divider {    background-color: '{{foreground-4}}'; }md-progress-circular.md-THEME_NAME-theme {  background-color: transparent; }  md-progress-circular.md-THEME_NAME-theme .md-inner .md-gap {    border-top-color: '{{primary-color}}';    border-bottom-color: '{{primary-color}}'; }  md-progress-circular.md-THEME_NAME-theme .md-inner .md-left .md-half-circle, md-progress-circular.md-THEME_NAME-theme .md-inner .md-right .md-half-circle {    border-top-color: '{{primary-color}}'; }  md-progress-circular.md-THEME_NAME-theme .md-inner .md-right .md-half-circle {    border-right-color: '{{primary-color}}'; }  md-progress-circular.md-THEME_NAME-theme .md-inner .md-left .md-half-circle {    border-left-color: '{{primary-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-warn .md-inner .md-gap {    border-top-color: '{{warn-color}}';    border-bottom-color: '{{warn-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-warn .md-inner .md-left .md-half-circle, md-progress-circular.md-THEME_NAME-theme.md-warn .md-inner .md-right .md-half-circle {    border-top-color: '{{warn-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-warn .md-inner .md-right .md-half-circle {    border-right-color: '{{warn-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-warn .md-inner .md-left .md-half-circle {    border-left-color: '{{warn-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-accent .md-inner .md-gap {    border-top-color: '{{accent-color}}';    border-bottom-color: '{{accent-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-accent .md-inner .md-left .md-half-circle, md-progress-circular.md-THEME_NAME-theme.md-accent .md-inner .md-right .md-half-circle {    border-top-color: '{{accent-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-accent .md-inner .md-right .md-half-circle {    border-right-color: '{{accent-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-accent .md-inner .md-left .md-half-circle {    border-left-color: '{{accent-color}}'; }md-progress-linear.md-THEME_NAME-theme .md-container {  background-color: '{{primary-100}}'; }md-progress-linear.md-THEME_NAME-theme .md-bar {  background-color: '{{primary-color}}'; }md-progress-linear.md-THEME_NAME-theme.md-warn .md-container {  background-color: '{{warn-100}}'; }md-progress-linear.md-THEME_NAME-theme.md-warn .md-bar {  background-color: '{{warn-color}}'; }md-progress-linear.md-THEME_NAME-theme.md-accent .md-container {  background-color: '{{accent-100}}'; }md-progress-linear.md-THEME_NAME-theme.md-accent .md-bar {  background-color: '{{accent-color}}'; }md-progress-linear.md-THEME_NAME-theme[md-mode=buffer].md-warn .md-bar1 {  background-color: '{{warn-100}}'; }md-progress-linear.md-THEME_NAME-theme[md-mode=buffer].md-warn .md-dashed:before {  background: radial-gradient('{{warn-100}}' 0%, '{{warn-100}}' 16%, transparent 42%); }md-progress-linear.md-THEME_NAME-theme[md-mode=buffer].md-accent .md-bar1 {  background-color: '{{accent-100}}'; }md-progress-linear.md-THEME_NAME-theme[md-mode=buffer].md-accent .md-dashed:before {  background: radial-gradient('{{accent-100}}' 0%, '{{accent-100}}' 16%, transparent 42%); }md-radio-button.md-THEME_NAME-theme .md-off {  border-color: '{{foreground-2}}'; }md-radio-button.md-THEME_NAME-theme .md-on {  background-color: '{{accent-color-0.87}}'; }md-radio-button.md-THEME_NAME-theme.md-checked .md-off {  border-color: '{{accent-color-0.87}}'; }md-radio-button.md-THEME_NAME-theme.md-checked .md-ink-ripple {  color: '{{accent-color-0.87}}'; }md-radio-button.md-THEME_NAME-theme .md-container .md-ripple {  color: '{{accent-600}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-primary .md-on, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-primary .md-on, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-primary .md-on, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-primary .md-on {  background-color: '{{primary-color-0.87}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-primary .md-checked .md-off, md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-primary.md-checked .md-off, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-primary .md-checked .md-off, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-primary .md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-primary.md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-primary .md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked .md-off {  border-color: '{{primary-color-0.87}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-primary .md-checked .md-ink-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-primary.md-checked .md-ink-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-primary .md-checked .md-ink-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-primary .md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-primary.md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-primary .md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked .md-ink-ripple {  color: '{{primary-color-0.87}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-primary .md-container .md-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-primary .md-container .md-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-primary .md-container .md-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-primary .md-container .md-ripple {  color: '{{primary-600}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-warn .md-on, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-warn .md-on, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-warn .md-on, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-warn .md-on {  background-color: '{{warn-color-0.87}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-warn .md-checked .md-off, md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-warn.md-checked .md-off, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-warn .md-checked .md-off, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-warn.md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-warn .md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-warn.md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-warn .md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-warn.md-checked .md-off {  border-color: '{{warn-color-0.87}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-warn .md-checked .md-ink-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-warn.md-checked .md-ink-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-warn .md-checked .md-ink-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-warn.md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-warn .md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-warn.md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-warn .md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-warn.md-checked .md-ink-ripple {  color: '{{warn-color-0.87}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-warn .md-container .md-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-warn .md-container .md-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-warn .md-container .md-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-warn .md-container .md-ripple {  color: '{{warn-600}}'; }md-radio-group.md-THEME_NAME-theme[disabled], md-radio-button.md-THEME_NAME-theme[disabled] {  color: '{{foreground-3}}'; }  md-radio-group.md-THEME_NAME-theme[disabled] .md-container .md-off, md-radio-button.md-THEME_NAME-theme[disabled] .md-container .md-off {    border-color: '{{foreground-3}}'; }  md-radio-group.md-THEME_NAME-theme[disabled] .md-container .md-on, md-radio-button.md-THEME_NAME-theme[disabled] .md-container .md-on {    border-color: '{{foreground-3}}'; }md-radio-group.md-THEME_NAME-theme.md-focused:not(:empty) .md-checked .md-container:before {  background-color: '{{accent-color-0.26}}'; }md-radio-group.md-THEME_NAME-theme.md-focused:not(:empty) .md-checked:not([disabled]).md-primary .md-container:before {  background-color: '{{primary-color-0.26}}'; }md-radio-group.md-THEME_NAME-theme.md-focused:not(:empty) .md-checked.md-primary .md-container:before {  background-color: '{{warn-color-0.26}}'; }md-select.md-THEME_NAME-theme.ng-invalid.ng-dirty .md-select-label {  color: '{{warn-500}}' !important;  border-bottom-color: '{{warn-500}}' !important; }md-select.md-THEME_NAME-theme:not([disabled]):focus .md-select-label {  border-bottom-color: '{{primary-color}}';  color: '{{ foreground-1 }}'; }  md-select.md-THEME_NAME-theme:not([disabled]):focus .md-select-label.md-placeholder {    color: '{{ foreground-1 }}'; }md-select.md-THEME_NAME-theme:not([disabled]):focus.md-accent .md-select-label {  border-bottom-color: '{{accent-color}}'; }md-select.md-THEME_NAME-theme:not([disabled]):focus.md-warn .md-select-label {  border-bottom-color: '{{warn-color}}'; }md-select.md-THEME_NAME-theme[disabled] .md-select-label {  color: '{{foreground-3}}'; }  md-select.md-THEME_NAME-theme[disabled] .md-select-label.md-placeholder {    color: '{{foreground-3}}'; }md-select.md-THEME_NAME-theme .md-select-label {  border-bottom-color: '{{foreground-4}}'; }  md-select.md-THEME_NAME-theme .md-select-label.md-placeholder {    color: '{{foreground-2}}'; }md-select-menu.md-THEME_NAME-theme md-optgroup {  color: '{{foreground-2}}'; }  md-select-menu.md-THEME_NAME-theme md-optgroup md-option {    color: '{{foreground-1}}'; }md-select-menu.md-THEME_NAME-theme md-option[selected] {  color: '{{primary-500}}'; }  md-select-menu.md-THEME_NAME-theme md-option[selected]:focus {    color: '{{primary-600}}'; }  md-select-menu.md-THEME_NAME-theme md-option[selected].md-accent {    color: '{{accent-500}}'; }    md-select-menu.md-THEME_NAME-theme md-option[selected].md-accent:focus {      color: '{{accent-600}}'; }md-select-menu.md-THEME_NAME-theme md-option:focus:not([selected]) {  background: '{{background-200}}'; }md-sidenav.md-THEME_NAME-theme {  background-color: '{{background-color}}'; }md-slider.md-THEME_NAME-theme .md-track {  background-color: '{{foreground-3}}'; }md-slider.md-THEME_NAME-theme .md-track-ticks {  background-color: '{{foreground-4}}'; }md-slider.md-THEME_NAME-theme .md-focus-thumb {  background-color: '{{foreground-2}}'; }md-slider.md-THEME_NAME-theme .md-focus-ring {  border-color: '{{foreground-4}}'; }md-slider.md-THEME_NAME-theme .md-disabled-thumb {  border-color: '{{background-color}}'; }md-slider.md-THEME_NAME-theme.md-min .md-thumb:after {  background-color: '{{background-color}}'; }md-slider.md-THEME_NAME-theme .md-track.md-track-fill {  background-color: '{{accent-color}}'; }md-slider.md-THEME_NAME-theme .md-thumb:after {  border-color: '{{accent-color}}';  background-color: '{{accent-color}}'; }md-slider.md-THEME_NAME-theme .md-sign {  background-color: '{{accent-color}}'; }  md-slider.md-THEME_NAME-theme .md-sign:after {    border-top-color: '{{accent-color}}'; }md-slider.md-THEME_NAME-theme .md-thumb-text {  color: '{{accent-contrast}}'; }md-slider.md-THEME_NAME-theme.md-warn .md-track.md-track-fill {  background-color: '{{warn-color}}'; }md-slider.md-THEME_NAME-theme.md-warn .md-thumb:after {  border-color: '{{warn-color}}';  background-color: '{{warn-color}}'; }md-slider.md-THEME_NAME-theme.md-warn .md-sign {  background-color: '{{warn-color}}'; }  md-slider.md-THEME_NAME-theme.md-warn .md-sign:after {    border-top-color: '{{warn-color}}'; }md-slider.md-THEME_NAME-theme.md-warn .md-thumb-text {  color: '{{warn-contrast}}'; }md-slider.md-THEME_NAME-theme.md-primary .md-track.md-track-fill {  background-color: '{{primary-color}}'; }md-slider.md-THEME_NAME-theme.md-primary .md-thumb:after {  border-color: '{{primary-color}}';  background-color: '{{primary-color}}'; }md-slider.md-THEME_NAME-theme.md-primary .md-sign {  background-color: '{{primary-color}}'; }  md-slider.md-THEME_NAME-theme.md-primary .md-sign:after {    border-top-color: '{{primary-color}}'; }md-slider.md-THEME_NAME-theme.md-primary .md-thumb-text {  color: '{{primary-contrast}}'; }md-slider.md-THEME_NAME-theme[disabled] .md-thumb:after {  border-color: '{{foreground-3}}'; }md-slider.md-THEME_NAME-theme[disabled]:not(.md-min) .md-thumb:after {  background-color: '{{foreground-3}}'; }.md-subheader.md-THEME_NAME-theme {  color: '{{ foreground-2-0.23 }}';  background-color: '{{background-color}}'; }  .md-subheader.md-THEME_NAME-theme.md-primary {    color: '{{primary-color}}'; }  .md-subheader.md-THEME_NAME-theme.md-accent {    color: '{{accent-color}}'; }  .md-subheader.md-THEME_NAME-theme.md-warn {    color: '{{warn-color}}'; }md-switch.md-THEME_NAME-theme .md-thumb {  background-color: '{{background-50}}'; }md-switch.md-THEME_NAME-theme .md-bar {  background-color: '{{background-500}}'; }md-switch.md-THEME_NAME-theme.md-checked .md-thumb {  background-color: '{{accent-color}}'; }md-switch.md-THEME_NAME-theme.md-checked .md-bar {  background-color: '{{accent-color-0.5}}'; }md-switch.md-THEME_NAME-theme.md-checked.md-focused .md-thumb:before {  background-color: '{{accent-color-0.26}}'; }md-switch.md-THEME_NAME-theme.md-checked.md-primary .md-thumb {  background-color: '{{primary-color}}'; }md-switch.md-THEME_NAME-theme.md-checked.md-primary .md-bar {  background-color: '{{primary-color-0.5}}'; }md-switch.md-THEME_NAME-theme.md-checked.md-primary.md-focused .md-thumb:before {  background-color: '{{primary-color-0.26}}'; }md-switch.md-THEME_NAME-theme.md-checked.md-warn .md-thumb {  background-color: '{{warn-color}}'; }md-switch.md-THEME_NAME-theme.md-checked.md-warn .md-bar {  background-color: '{{warn-color-0.5}}'; }md-switch.md-THEME_NAME-theme.md-checked.md-warn.md-focused .md-thumb:before {  background-color: '{{warn-color-0.26}}'; }md-switch.md-THEME_NAME-theme[disabled] .md-thumb {  background-color: '{{background-400}}'; }md-switch.md-THEME_NAME-theme[disabled] .md-bar {  background-color: '{{foreground-4}}'; }md-tabs.md-THEME_NAME-theme md-tabs-wrapper {  background-color: transparent;  border-color: '{{foreground-4}}'; }md-tabs.md-THEME_NAME-theme .md-paginator md-icon {  color: '{{primary-color}}'; }md-tabs.md-THEME_NAME-theme md-ink-bar {  color: '{{accent-color}}';  background: '{{accent-color}}'; }md-tabs.md-THEME_NAME-theme .md-tab {  color: '{{foreground-2}}'; }  md-tabs.md-THEME_NAME-theme .md-tab[disabled] {    color: '{{foreground-3}}'; }  md-tabs.md-THEME_NAME-theme .md-tab.md-active, md-tabs.md-THEME_NAME-theme .md-tab.md-focused {    color: '{{primary-color}}'; }  md-tabs.md-THEME_NAME-theme .md-tab.md-focused {    background: '{{primary-color-0.1}}'; }  md-tabs.md-THEME_NAME-theme .md-tab .md-ripple-container {    color: '{{accent-100}}'; }md-tabs.md-THEME_NAME-theme.md-accent md-tabs-wrapper {  background-color: '{{accent-color}}'; }md-tabs.md-THEME_NAME-theme.md-accent md-tab-item:not([disabled]) {  color: '{{accent-100}}'; }  md-tabs.md-THEME_NAME-theme.md-accent md-tab-item:not([disabled]).md-active, md-tabs.md-THEME_NAME-theme.md-accent md-tab-item:not([disabled]).md-focused {    color: '{{accent-contrast}}'; }  md-tabs.md-THEME_NAME-theme.md-accent md-tab-item:not([disabled]).md-focused {    background: '{{accent-contrast-0.1}}'; }md-tabs.md-THEME_NAME-theme.md-accent md-ink-bar {  color: '{{primary-600-1}}';  background: '{{primary-600-1}}'; }md-tabs.md-THEME_NAME-theme.md-primary md-tabs-wrapper {  background-color: '{{primary-color}}'; }md-tabs.md-THEME_NAME-theme.md-primary md-tab-item:not([disabled]) {  color: '{{primary-100}}'; }  md-tabs.md-THEME_NAME-theme.md-primary md-tab-item:not([disabled]).md-active, md-tabs.md-THEME_NAME-theme.md-primary md-tab-item:not([disabled]).md-focused {    color: '{{primary-contrast}}'; }  md-tabs.md-THEME_NAME-theme.md-primary md-tab-item:not([disabled]).md-focused {    background: '{{primary-contrast-0.1}}'; }md-tabs.md-THEME_NAME-theme.md-warn md-tabs-wrapper {  background-color: '{{warn-color}}'; }md-tabs.md-THEME_NAME-theme.md-warn md-tab-item:not([disabled]) {  color: '{{warn-100}}'; }  md-tabs.md-THEME_NAME-theme.md-warn md-tab-item:not([disabled]).md-active, md-tabs.md-THEME_NAME-theme.md-warn md-tab-item:not([disabled]).md-focused {    color: '{{warn-contrast}}'; }  md-tabs.md-THEME_NAME-theme.md-warn md-tab-item:not([disabled]).md-focused {    background: '{{warn-contrast-0.1}}'; }md-toolbar > md-tabs.md-THEME_NAME-theme md-tabs-wrapper {  background-color: '{{primary-color}}'; }md-toolbar > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]) {  color: '{{primary-100}}'; }  md-toolbar > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-active, md-toolbar > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-focused {    color: '{{primary-contrast}}'; }  md-toolbar > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-focused {    background: '{{primary-contrast-0.1}}'; }md-toolbar.md-accent > md-tabs.md-THEME_NAME-theme md-tabs-wrapper {  background-color: '{{accent-color}}'; }md-toolbar.md-accent > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]) {  color: '{{accent-100}}'; }  md-toolbar.md-accent > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-active, md-toolbar.md-accent > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-focused {    color: '{{accent-contrast}}'; }  md-toolbar.md-accent > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-focused {    background: '{{accent-contrast-0.1}}'; }md-toolbar.md-accent > md-tabs.md-THEME_NAME-theme md-ink-bar {  color: '{{primary-600-1}}';  background: '{{primary-600-1}}'; }md-toolbar.md-warn > md-tabs.md-THEME_NAME-theme md-tabs-wrapper {  background-color: '{{warn-color}}'; }md-toolbar.md-warn > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]) {  color: '{{warn-100}}'; }  md-toolbar.md-warn > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-active, md-toolbar.md-warn > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-focused {    color: '{{warn-contrast}}'; }  md-toolbar.md-warn > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-focused {    background: '{{warn-contrast-0.1}}'; }md-toast.md-THEME_NAME-theme {  background-color: #323232;  color: '{{background-50}}'; }  md-toast.md-THEME_NAME-theme .md-button {    color: '{{background-50}}'; }    md-toast.md-THEME_NAME-theme .md-button.md-highlight {      color: '{{primary-A200}}'; }      md-toast.md-THEME_NAME-theme .md-button.md-highlight.md-accent {        color: '{{accent-A200}}'; }      md-toast.md-THEME_NAME-theme .md-button.md-highlight.md-warn {        color: '{{warn-A200}}'; }md-toolbar.md-THEME_NAME-theme {  background-color: '{{primary-color}}';  color: '{{primary-contrast}}'; }  md-toolbar.md-THEME_NAME-theme md-icon {    color: '{{primary-contrast}}'; }  md-toolbar.md-THEME_NAME-theme .md-button {    color: '{{primary-contrast}}'; }  md-toolbar.md-THEME_NAME-theme.md-accent {    background-color: '{{accent-color}}';    color: '{{accent-contrast}}'; }  md-toolbar.md-THEME_NAME-theme.md-warn {    background-color: '{{warn-color}}';    color: '{{warn-contrast}}'; }md-tooltip.md-THEME_NAME-theme {  color: '{{background-A100}}'; }  md-tooltip.md-THEME_NAME-theme .md-background {    background-color: '{{foreground-2}}'; }"); 
})();


})(window, window.angular);
/*
 jQuery UI Sortable plugin wrapper

 @param [ui-sortable] {object} Options to pass to $.fn.sortable() merged onto ui.config
 */
angular.module('ui.sortable', [])
  .value('uiSortableConfig',{})
  .directive('uiSortable', [
    'uiSortableConfig', '$timeout', '$log',
    function(uiSortableConfig, $timeout, $log) {
      return {
        require: '?ngModel',
        scope: {
          ngModel: '=',
          uiSortable: '='
        },
        link: function(scope, element, attrs, ngModel) {
          var savedNodes;

          function combineCallbacks(first,second){
            if(second && (typeof second === 'function')) {
              return function() {
                first.apply(this, arguments);
                second.apply(this, arguments);
              };
            }
            return first;
          }

          function getSortableWidgetInstance(element) {
            // this is a fix to support jquery-ui prior to v1.11.x
            // otherwise we should be using `element.sortable('instance')`
            var data = element.data('ui-sortable');
            if (data && typeof data === 'object' && data.widgetFullName === 'ui-sortable') {
              return data;
            }
            return null;
          }

          function hasSortingHelper (element, ui) {
            var helperOption = element.sortable('option','helper');
            return helperOption === 'clone' || (typeof helperOption === 'function' && ui.item.sortable.isCustomHelperUsed());
          }

          // thanks jquery-ui
          function isFloating (item) {
            return (/left|right/).test(item.css('float')) || (/inline|table-cell/).test(item.css('display'));
          }

          function getElementScope(elementScopes, element) {
            var result = null;
            for (var i = 0; i < elementScopes.length; i++) {
              var x = elementScopes[i];
              if (x.element[0] === element[0]) {
                result = x.scope;
                break;
              }
            }
            return result;
          }

          function afterStop(e, ui) {
            ui.item.sortable._destroy();
          }

          var opts = {};

          // directive specific options
          var directiveOpts = {
            'ui-floating': undefined
          };

          var callbacks = {
            receive: null,
            remove:null,
            start:null,
            stop:null,
            update:null
          };

          var wrappers = {
            helper: null
          };

          angular.extend(opts, directiveOpts, uiSortableConfig, scope.uiSortable);

          if (!angular.element.fn || !angular.element.fn.jquery) {
            $log.error('ui.sortable: jQuery should be included before AngularJS!');
            return;
          }

          if (ngModel) {

            // When we add or remove elements, we need the sortable to 'refresh'
            // so it can find the new/removed elements.
            scope.$watch('ngModel.length', function() {
              // Timeout to let ng-repeat modify the DOM
              $timeout(function() {
                // ensure that the jquery-ui-sortable widget instance
                // is still bound to the directive's element
                if (!!getSortableWidgetInstance(element)) {
                  element.sortable('refresh');
                }
              }, 0, false);
            });

            callbacks.start = function(e, ui) {
              if (opts['ui-floating'] === 'auto') {
                // since the drag has started, the element will be
                // absolutely positioned, so we check its siblings
                var siblings = ui.item.siblings();
                var sortableWidgetInstance = getSortableWidgetInstance(angular.element(e.target));
                sortableWidgetInstance.floating = isFloating(siblings);
              }

              // Save the starting position of dragged item
              ui.item.sortable = {
                model: ngModel.$modelValue[ui.item.index()],
                index: ui.item.index(),
                source: ui.item.parent(),
                sourceModel: ngModel.$modelValue,
                cancel: function () {
                  ui.item.sortable._isCanceled = true;
                },
                isCanceled: function () {
                  return ui.item.sortable._isCanceled;
                },
                isCustomHelperUsed: function () {
                  return !!ui.item.sortable._isCustomHelperUsed;
                },
                _isCanceled: false,
                _isCustomHelperUsed: ui.item.sortable._isCustomHelperUsed,
                _destroy: function () {
                  angular.forEach(ui.item.sortable, function(value, key) {
                    ui.item.sortable[key] = undefined;
                  });
                }
              };
            };

            callbacks.activate = function(e, ui) {
              // We need to make a copy of the current element's contents so
              // we can restore it after sortable has messed it up.
              // This is inside activate (instead of start) in order to save
              // both lists when dragging between connected lists.
              savedNodes = element.contents();

              // If this list has a placeholder (the connected lists won't),
              // don't inlcude it in saved nodes.
              var placeholder = element.sortable('option','placeholder');

              // placeholder.element will be a function if the placeholder, has
              // been created (placeholder will be an object).  If it hasn't
              // been created, either placeholder will be false if no
              // placeholder class was given or placeholder.element will be
              // undefined if a class was given (placeholder will be a string)
              if (placeholder && placeholder.element && typeof placeholder.element === 'function') {
                var phElement = placeholder.element();
                // workaround for jquery ui 1.9.x,
                // not returning jquery collection
                phElement = angular.element(phElement);

                // exact match with the placeholder's class attribute to handle
                // the case that multiple connected sortables exist and
                // the placehoilder option equals the class of sortable items
                var excludes = element.find('[class="' + phElement.attr('class') + '"]:not([ng-repeat], [data-ng-repeat])');

                savedNodes = savedNodes.not(excludes);
              }

              // save the directive's scope so that it is accessible from ui.item.sortable
              var connectedSortables = ui.item.sortable._connectedSortables || [];

              connectedSortables.push({
                element: element,
                scope: scope
              });

              ui.item.sortable._connectedSortables = connectedSortables;
            };

            callbacks.update = function(e, ui) {
              // Save current drop position but only if this is not a second
              // update that happens when moving between lists because then
              // the value will be overwritten with the old value
              if(!ui.item.sortable.received) {
                ui.item.sortable.dropindex = ui.item.index();
                var droptarget = ui.item.parent();
                ui.item.sortable.droptarget = droptarget;

                var droptargetScope = getElementScope(ui.item.sortable._connectedSortables, droptarget);
                ui.item.sortable.droptargetModel = droptargetScope.ngModel;

                // Cancel the sort (let ng-repeat do the sort for us)
                // Don't cancel if this is the received list because it has
                // already been canceled in the other list, and trying to cancel
                // here will mess up the DOM.
                element.sortable('cancel');
              }

              // Put the nodes back exactly the way they started (this is very
              // important because ng-repeat uses comment elements to delineate
              // the start and stop of repeat sections and sortable doesn't
              // respect their order (even if we cancel, the order of the
              // comments are still messed up).
              if (hasSortingHelper(element, ui) && !ui.item.sortable.received &&
                  element.sortable( 'option', 'appendTo' ) === 'parent') {
                // restore all the savedNodes except .ui-sortable-helper element
                // (which is placed last). That way it will be garbage collected.
                savedNodes = savedNodes.not(savedNodes.last());
              }
              savedNodes.appendTo(element);

              // If this is the target connected list then
              // it's safe to clear the restored nodes since:
              // update is currently running and
              // stop is not called for the target list.
              if(ui.item.sortable.received) {
                savedNodes = null;
              }

              // If received is true (an item was dropped in from another list)
              // then we add the new item to this list otherwise wait until the
              // stop event where we will know if it was a sort or item was
              // moved here from another list
              if(ui.item.sortable.received && !ui.item.sortable.isCanceled()) {
                scope.$apply(function () {
                  ngModel.$modelValue.splice(ui.item.sortable.dropindex, 0,
                                             ui.item.sortable.moved);
                });
              }
            };

            callbacks.stop = function(e, ui) {
              // If the received flag hasn't be set on the item, this is a
              // normal sort, if dropindex is set, the item was moved, so move
              // the items in the list.
              if(!ui.item.sortable.received &&
                 ('dropindex' in ui.item.sortable) &&
                 !ui.item.sortable.isCanceled()) {

                scope.$apply(function () {
                  ngModel.$modelValue.splice(
                    ui.item.sortable.dropindex, 0,
                    ngModel.$modelValue.splice(ui.item.sortable.index, 1)[0]);
                });
              } else {
                // if the item was not moved, then restore the elements
                // so that the ngRepeat's comment are correct.
                if ((!('dropindex' in ui.item.sortable) || ui.item.sortable.isCanceled()) &&
                    !hasSortingHelper(element, ui)) {
                  savedNodes.appendTo(element);
                }
              }

              // It's now safe to clear the savedNodes
              // since stop is the last callback.
              savedNodes = null;
            };

            callbacks.receive = function(e, ui) {
              // An item was dropped here from another list, set a flag on the
              // item.
              ui.item.sortable.received = true;
            };

            callbacks.remove = function(e, ui) {
              // Workaround for a problem observed in nested connected lists.
              // There should be an 'update' event before 'remove' when moving
              // elements. If the event did not fire, cancel sorting.
              if (!('dropindex' in ui.item.sortable)) {
                element.sortable('cancel');
                ui.item.sortable.cancel();
              }

              // Remove the item from this list's model and copy data into item,
              // so the next list can retrive it
              if (!ui.item.sortable.isCanceled()) {
                scope.$apply(function () {
                  ui.item.sortable.moved = ngModel.$modelValue.splice(
                    ui.item.sortable.index, 1)[0];
                });
              }
            };

            wrappers.helper = function (inner) {
              if (inner && typeof inner === 'function') {
                return function (e, item) {
                  var innerResult = inner.apply(this, arguments);
                  item.sortable._isCustomHelperUsed = item !== innerResult;
                  return innerResult;
                };
              }
              return inner;
            };

            scope.$watch('uiSortable', function(newVal /*, oldVal*/) {
              // ensure that the jquery-ui-sortable widget instance
              // is still bound to the directive's element
              var sortableWidgetInstance = getSortableWidgetInstance(element);
              if (!!sortableWidgetInstance) {
                angular.forEach(newVal, function(value, key) {
                  // if it's a custom option of the directive,
                  // handle it approprietly
                  if (key in directiveOpts) {
                    if (key === 'ui-floating' && (value === false || value === true)) {
                      sortableWidgetInstance.floating = value;
                    }

                    opts[key] = value;
                    return;
                  }

                  if (callbacks[key]) {
                    if( key === 'stop' ){
                      // call apply after stop
                      value = combineCallbacks(
                        value, function() { scope.$apply(); });

                      value = combineCallbacks(value, afterStop);
                    }
                    // wrap the callback
                    value = combineCallbacks(callbacks[key], value);
                  } else if (wrappers[key]) {
                    value = wrappers[key](value);
                  }

                  opts[key] = value;
                  element.sortable('option', key, value);
                });
              }
            }, true);

            angular.forEach(callbacks, function(value, key) {
              opts[key] = combineCallbacks(value, opts[key]);
              if( key === 'stop' ){
                opts[key] = combineCallbacks(opts[key], afterStop);
              }
            });

          } else {
            $log.info('ui.sortable: ngModel not provided!', element);
          }

          // Create sortable
          element.sortable(opts);
        }
      };
    }
  ]);

var fabric=fabric||{version:"1.5.0"};"undefined"!=typeof exports&&(exports.fabric=fabric),"undefined"!=typeof document&&"undefined"!=typeof window?(fabric.document=document,fabric.window=window,window.fabric=fabric):(fabric.document=require("jsdom").jsdom("<!DOCTYPE html><html><head></head><body></body></html>"),fabric.document.createWindow?fabric.window=fabric.document.createWindow():fabric.window=fabric.document.parentWindow),fabric.isTouchSupported="ontouchstart"in fabric.document.documentElement,fabric.isLikelyNode="undefined"!=typeof Buffer&&"undefined"==typeof window,fabric.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width"],fabric.DPI=96,fabric.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)",function(){function t(t,e){this.__eventListeners[t]&&(e?fabric.util.removeFromArray(this.__eventListeners[t],e):this.__eventListeners[t].length=0)}function e(t,e){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var i in t)this.on(i,t[i]);else this.__eventListeners[t]||(this.__eventListeners[t]=[]),this.__eventListeners[t].push(e);return this}function i(e,i){if(this.__eventListeners){if(0===arguments.length)this.__eventListeners={};else if(1===arguments.length&&"object"==typeof arguments[0])for(var r in e)t.call(this,r,e[r]);else t.call(this,e,i);return this}}function r(t,e){if(this.__eventListeners){var i=this.__eventListeners[t];if(i){for(var r=0,s=i.length;s>r;r++)i[r].call(this,e||{});return this}}}fabric.Observable={observe:e,stopObserving:i,fire:r,on:e,off:i,trigger:r}}(),fabric.Collection={add:function(){this._objects.push.apply(this._objects,arguments);for(var t=0,e=arguments.length;e>t;t++)this._onObjectAdded(arguments[t]);return this.renderOnAddRemove&&this.renderAll(),this},insertAt:function(t,e,i){var r=this.getObjects();return i?r[e]=t:r.splice(e,0,t),this._onObjectAdded(t),this.renderOnAddRemove&&this.renderAll(),this},remove:function(){for(var t,e=this.getObjects(),i=0,r=arguments.length;r>i;i++)t=e.indexOf(arguments[i]),-1!==t&&(e.splice(t,1),this._onObjectRemoved(arguments[i]));return this.renderOnAddRemove&&this.renderAll(),this},forEachObject:function(t,e){for(var i=this.getObjects(),r=i.length;r--;)t.call(e,i[r],r,i);return this},getObjects:function(t){return"undefined"==typeof t?this._objects:this._objects.filter(function(e){return e.type===t})},item:function(t){return this.getObjects()[t]},isEmpty:function(){return 0===this.getObjects().length},size:function(){return this.getObjects().length},contains:function(t){return this.getObjects().indexOf(t)>-1},complexity:function(){return this.getObjects().reduce(function(t,e){return t+=e.complexity?e.complexity():0},0)}},function(t){var e=Math.sqrt,i=Math.atan2,r=Math.PI/180;fabric.util={removeFromArray:function(t,e){var i=t.indexOf(e);return-1!==i&&t.splice(i,1),t},getRandomInt:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},degreesToRadians:function(t){return t*r},radiansToDegrees:function(t){return t/r},rotatePoint:function(t,e,i){var r=Math.sin(i),s=Math.cos(i);t.subtractEquals(e);var n=t.x*s-t.y*r,o=t.x*r+t.y*s;return new fabric.Point(n,o).addEquals(e)},transformPoint:function(t,e,i){return i?new fabric.Point(e[0]*t.x+e[2]*t.y,e[1]*t.x+e[3]*t.y):new fabric.Point(e[0]*t.x+e[2]*t.y+e[4],e[1]*t.x+e[3]*t.y+e[5])},invertTransform:function(t){var e=t.slice(),i=1/(t[0]*t[3]-t[1]*t[2]);e=[i*t[3],-i*t[1],-i*t[2],i*t[0],0,0];var r=fabric.util.transformPoint({x:t[4],y:t[5]},e);return e[4]=-r.x,e[5]=-r.y,e},toFixed:function(t,e){return parseFloat(Number(t).toFixed(e))},parseUnit:function(t,e){var i=/\D{0,2}$/.exec(t),r=parseFloat(t);switch(e||(e=fabric.Text.DEFAULT_SVG_FONT_SIZE),i[0]){case"mm":return r*fabric.DPI/25.4;case"cm":return r*fabric.DPI/2.54;case"in":return r*fabric.DPI;case"pt":return r*fabric.DPI/72;case"pc":return r*fabric.DPI/72*12;case"em":return r*e;default:return r}},falseFunction:function(){return!1},getKlass:function(t,e){return t=fabric.util.string.camelize(t.charAt(0).toUpperCase()+t.slice(1)),fabric.util.resolveNamespace(e)[t]},resolveNamespace:function(e){if(!e)return fabric;for(var i=e.split("."),r=i.length,s=t||fabric.window,n=0;r>n;++n)s=s[i[n]];return s},loadImage:function(t,e,i,r){if(!t)return void(e&&e.call(i,t));var s=fabric.util.createImage();s.onload=function(){e&&e.call(i,s),s=s.onload=s.onerror=null},s.onerror=function(){fabric.log("Error loading "+s.src),e&&e.call(i,null,!0),s=s.onload=s.onerror=null},0!==t.indexOf("data")&&"undefined"!=typeof r&&(s.crossOrigin=r),s.src=t},enlivenObjects:function(t,e,i,r){function s(){++o===a&&e&&e(n)}t=t||[];var n=[],o=0,a=t.length;return a?void t.forEach(function(t,e){if(!t||!t.type)return void s();var o=fabric.util.getKlass(t.type,i);o.async?o.fromObject(t,function(i,o){o||(n[e]=i,r&&r(t,n[e])),s()}):(n[e]=o.fromObject(t),r&&r(t,n[e]),s())}):void(e&&e(n))},groupSVGElements:function(t,e,i){var r;return r=new fabric.PathGroup(t,e),"undefined"!=typeof i&&r.setSourcePath(i),r},populateWithProperties:function(t,e,i){if(i&&"[object Array]"===Object.prototype.toString.call(i))for(var r=0,s=i.length;s>r;r++)i[r]in t&&(e[i[r]]=t[i[r]])},drawDashedLine:function(t,r,s,n,o,a){var h=n-r,c=o-s,l=e(h*h+c*c),u=i(c,h),f=a.length,d=0,g=!0;for(t.save(),t.translate(r,s),t.moveTo(0,0),t.rotate(u),r=0;l>r;)r+=a[d++%f],r>l&&(r=l),t[g?"lineTo":"moveTo"](r,0),g=!g;t.restore()},createCanvasElement:function(t){return t||(t=fabric.document.createElement("canvas")),t.getContext||"undefined"==typeof G_vmlCanvasManager||G_vmlCanvasManager.initElement(t),t},createImage:function(){return fabric.isLikelyNode?new(require("canvas").Image):fabric.document.createElement("img")},createAccessors:function(t){for(var e=t.prototype,i=e.stateProperties.length;i--;){var r=e.stateProperties[i],s=r.charAt(0).toUpperCase()+r.slice(1),n="set"+s,o="get"+s;e[o]||(e[o]=function(t){return new Function('return this.get("'+t+'")')}(r)),e[n]||(e[n]=function(t){return new Function("value",'return this.set("'+t+'", value)')}(r))}},clipContext:function(t,e){e.save(),e.beginPath(),t.clipTo(e),e.clip()},multiplyTransformMatrices:function(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]},getFunctionBody:function(t){return(String(t).match(/function[^{]*\{([\s\S]*)\}/)||{})[1]},isTransparent:function(t,e,i,r){r>0&&(e>r?e-=r:e=0,i>r?i-=r:i=0);for(var s=!0,n=t.getImageData(e,i,2*r||1,2*r||1),o=3,a=n.data.length;a>o;o+=4){var h=n.data[o];if(s=0>=h,s===!1)break}return n=null,s}}}("undefined"!=typeof exports?exports:this),function(){function t(t,r,n,o,h,c,l){var u=a.call(arguments);if(s[u])return s[u];var f=Math.PI,d=l*f/180,g=Math.sin(d),p=Math.cos(d),v=0,b=0;n=Math.abs(n),o=Math.abs(o);var m=-p*t*.5-g*r*.5,y=-p*r*.5+g*t*.5,_=n*n,x=o*o,C=y*y,S=m*m,w=_*x-_*C-x*S,O=0;if(0>w){var T=Math.sqrt(1-w/(_*x));n*=T,o*=T}else O=(h===c?-1:1)*Math.sqrt(w/(_*C+x*S));var k=O*n*y/o,j=-O*o*m/n,A=p*k-g*j+.5*t,P=g*k+p*j+.5*r,E=i(1,0,(m-k)/n,(y-j)/o),M=i((m-k)/n,(y-j)/o,(-m-k)/n,(-y-j)/o);0===c&&M>0?M-=2*f:1===c&&0>M&&(M+=2*f);for(var I=Math.ceil(Math.abs(M/f*2)),D=[],L=M/I,F=8/3*Math.sin(L/4)*Math.sin(L/4)/Math.sin(L/2),R=E+L,B=0;I>B;B++)D[B]=e(E,R,p,g,n,o,A,P,F,v,b),v=D[B][4],b=D[B][5],E=R,R+=L;return s[u]=D,D}function e(t,e,i,r,s,o,h,c,l,u,f){var d=a.call(arguments);if(n[d])return n[d];var g=Math.cos(t),p=Math.sin(t),v=Math.cos(e),b=Math.sin(e),m=i*s*v-r*o*b+h,y=r*s*v+i*o*b+c,_=u+l*(-i*s*p-r*o*g),x=f+l*(-r*s*p+i*o*g),C=m+l*(i*s*b+r*o*v),S=y+l*(r*s*b-i*o*v);return n[d]=[_,x,C,S,m,y],n[d]}function i(t,e,i,r){var s=Math.atan2(e,t),n=Math.atan2(r,i);return n>=s?n-s:2*Math.PI-(s-n)}function r(t,e,i,r,s,n,h,c){var l=a.call(arguments);if(o[l])return o[l];var u,f,d,g,p,v,b,m,y=Math.sqrt,_=Math.min,x=Math.max,C=Math.abs,S=[],w=[[],[]];f=6*t-12*i+6*s,u=-3*t+9*i-9*s+3*h,d=3*i-3*t;for(var O=0;2>O;++O)if(O>0&&(f=6*e-12*r+6*n,u=-3*e+9*r-9*n+3*c,d=3*r-3*e),C(u)<1e-12){if(C(f)<1e-12)continue;g=-d/f,g>0&&1>g&&S.push(g)}else b=f*f-4*d*u,0>b||(m=y(b),p=(-f+m)/(2*u),p>0&&1>p&&S.push(p),v=(-f-m)/(2*u),v>0&&1>v&&S.push(v));for(var T,k,j,A=S.length,P=A;A--;)g=S[A],j=1-g,T=j*j*j*t+3*j*j*g*i+3*j*g*g*s+g*g*g*h,w[0][A]=T,k=j*j*j*e+3*j*j*g*r+3*j*g*g*n+g*g*g*c,w[1][A]=k;w[0][P]=t,w[1][P]=e,w[0][P+1]=h,w[1][P+1]=c;var E=[{x:_.apply(null,w[0]),y:_.apply(null,w[1])},{x:x.apply(null,w[0]),y:x.apply(null,w[1])}];return o[l]=E,E}var s={},n={},o={},a=Array.prototype.join;fabric.util.drawArc=function(e,i,r,s){for(var n=s[0],o=s[1],a=s[2],h=s[3],c=s[4],l=s[5],u=s[6],f=[[],[],[],[]],d=t(l-i,u-r,n,o,h,c,a),g=0,p=d.length;p>g;g++)f[g][0]=d[g][0]+i,f[g][1]=d[g][1]+r,f[g][2]=d[g][2]+i,f[g][3]=d[g][3]+r,f[g][4]=d[g][4]+i,f[g][5]=d[g][5]+r,e.bezierCurveTo.apply(e,f[g])},fabric.util.getBoundsOfArc=function(e,i,s,n,o,a,h,c,l){for(var u=0,f=0,d=[],g=[],p=t(c-e,l-i,s,n,a,h,o),v=[[],[]],b=0,m=p.length;m>b;b++)d=r(u,f,p[b][0],p[b][1],p[b][2],p[b][3],p[b][4],p[b][5]),v[0].x=d[0].x+e,v[0].y=d[0].y+i,v[1].x=d[1].x+e,v[1].y=d[1].y+i,g.push(v[0]),g.push(v[1]),u=p[b][4],f=p[b][5];return g},fabric.util.getBoundsOfCurve=r}(),function(){function t(t,e){for(var i=s.call(arguments,2),r=[],n=0,o=t.length;o>n;n++)r[n]=i.length?t[n][e].apply(t[n],i):t[n][e].call(t[n]);return r}function e(t,e){return r(t,e,function(t,e){return t>=e})}function i(t,e){return r(t,e,function(t,e){return e>t})}function r(t,e,i){if(t&&0!==t.length){var r=t.length-1,s=e?t[r][e]:t[r];if(e)for(;r--;)i(t[r][e],s)&&(s=t[r][e]);else for(;r--;)i(t[r],s)&&(s=t[r]);return s}}var s=Array.prototype.slice;Array.prototype.indexOf||(Array.prototype.indexOf=function(t){if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if(0===i)return-1;var r=0;if(arguments.length>0&&(r=Number(arguments[1]),r!==r?r=0:0!==r&&r!==Number.POSITIVE_INFINITY&&r!==Number.NEGATIVE_INFINITY&&(r=(r>0||-1)*Math.floor(Math.abs(r)))),r>=i)return-1;for(var s=r>=0?r:Math.max(i-Math.abs(r),0);i>s;s++)if(s in e&&e[s]===t)return s;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){for(var i=0,r=this.length>>>0;r>i;i++)i in this&&t.call(e,this[i],i,this)}),Array.prototype.map||(Array.prototype.map=function(t,e){for(var i=[],r=0,s=this.length>>>0;s>r;r++)r in this&&(i[r]=t.call(e,this[r],r,this));return i}),Array.prototype.every||(Array.prototype.every=function(t,e){for(var i=0,r=this.length>>>0;r>i;i++)if(i in this&&!t.call(e,this[i],i,this))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(t,e){for(var i=0,r=this.length>>>0;r>i;i++)if(i in this&&t.call(e,this[i],i,this))return!0;return!1}),Array.prototype.filter||(Array.prototype.filter=function(t,e){for(var i,r=[],s=0,n=this.length>>>0;n>s;s++)s in this&&(i=this[s],t.call(e,i,s,this)&&r.push(i));return r}),Array.prototype.reduce||(Array.prototype.reduce=function(t){var e,i=this.length>>>0,r=0;if(arguments.length>1)e=arguments[1];else for(;;){if(r in this){e=this[r++];break}if(++r>=i)throw new TypeError}for(;i>r;r++)r in this&&(e=t.call(null,e,this[r],r,this));return e}),fabric.util.array={invoke:t,min:i,max:e}}(),function(){function t(t,e){for(var i in e)t[i]=e[i];return t}function e(e){return t({},e)}fabric.util.object={extend:t,clone:e}}(),function(){function t(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})}function e(t,e){return t.charAt(0).toUpperCase()+(e?t.slice(1):t.slice(1).toLowerCase())}function i(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"")}),fabric.util.string={camelize:t,capitalize:e,escapeXml:i}}(),function(){var t=Array.prototype.slice,e=Function.prototype.apply,i=function(){};Function.prototype.bind||(Function.prototype.bind=function(r){var s,n=this,o=t.call(arguments,1);return s=o.length?function(){return e.call(n,this instanceof i?this:r,o.concat(t.call(arguments)))}:function(){return e.call(n,this instanceof i?this:r,arguments)},i.prototype=this.prototype,s.prototype=new i,s})}(),function(){function t(){}function e(t){var e=this.constructor.superclass.prototype[t];return arguments.length>1?e.apply(this,r.call(arguments,1)):e.call(this)}function i(){function i(){this.initialize.apply(this,arguments)}var n=null,a=r.call(arguments,0);"function"==typeof a[0]&&(n=a.shift()),i.superclass=n,i.subclasses=[],n&&(t.prototype=n.prototype,i.prototype=new t,n.subclasses.push(i));for(var h=0,c=a.length;c>h;h++)o(i,a[h],n);return i.prototype.initialize||(i.prototype.initialize=s),i.prototype.constructor=i,i.prototype.callSuper=e,i}var r=Array.prototype.slice,s=function(){},n=function(){for(var t in{toString:1})if("toString"===t)return!1;return!0}(),o=function(t,e,i){for(var r in e)r in t.prototype&&"function"==typeof t.prototype[r]&&(e[r]+"").indexOf("callSuper")>-1?t.prototype[r]=function(t){return function(){var r=this.constructor.superclass;this.constructor.superclass=i;var s=e[t].apply(this,arguments);return this.constructor.superclass=r,"initialize"!==t?s:void 0}}(r):t.prototype[r]=e[r],n&&(e.toString!==Object.prototype.toString&&(t.prototype.toString=e.toString),e.valueOf!==Object.prototype.valueOf&&(t.prototype.valueOf=e.valueOf))};fabric.util.createClass=i}(),function(){function t(t){var e,i,r=Array.prototype.slice.call(arguments,1),s=r.length;for(i=0;s>i;i++)if(e=typeof t[r[i]],!/^(?:function|object|unknown)$/.test(e))return!1;return!0}function e(t,e){return{handler:e,wrappedHandler:i(t,e)}}function i(t,e){return function(i){e.call(o(t),i||fabric.window.event)}}function r(t,e){return function(i){if(p[t]&&p[t][e])for(var r=p[t][e],s=0,n=r.length;n>s;s++)r[s].call(this,i||fabric.window.event)}}function s(t,e){t||(t=fabric.window.event);var i=t.target||(typeof t.srcElement!==h?t.srcElement:null),r=fabric.util.getScrollLeftTop(i,e);return{x:v(t)+r.left,y:b(t)+r.top}}function n(t,e,i){var r="touchend"===t.type?"changedTouches":"touches";return t[r]&&t[r][0]?t[r][0][e]-(t[r][0][e]-t[r][0][i])||t[i]:t[i]}var o,a,h="unknown",c=function(){var t=0;return function(e){return e.__uniqueID||(e.__uniqueID="uniqueID__"+t++)}}();!function(){var t={};o=function(e){return t[e]},a=function(e,i){t[e]=i}}();var l,u,f=t(fabric.document.documentElement,"addEventListener","removeEventListener")&&t(fabric.window,"addEventListener","removeEventListener"),d=t(fabric.document.documentElement,"attachEvent","detachEvent")&&t(fabric.window,"attachEvent","detachEvent"),g={},p={};f?(l=function(t,e,i){t.addEventListener(e,i,!1)},u=function(t,e,i){t.removeEventListener(e,i,!1)}):d?(l=function(t,i,r){var s=c(t);a(s,t),g[s]||(g[s]={}),g[s][i]||(g[s][i]=[]);var n=e(s,r);g[s][i].push(n),t.attachEvent("on"+i,n.wrappedHandler)},u=function(t,e,i){var r,s=c(t);if(g[s]&&g[s][e])for(var n=0,o=g[s][e].length;o>n;n++)r=g[s][e][n],r&&r.handler===i&&(t.detachEvent("on"+e,r.wrappedHandler),g[s][e][n]=null)}):(l=function(t,e,i){var s=c(t);if(p[s]||(p[s]={}),!p[s][e]){p[s][e]=[];var n=t["on"+e];n&&p[s][e].push(n),t["on"+e]=r(s,e)}p[s][e].push(i)},u=function(t,e,i){var r=c(t);if(p[r]&&p[r][e])for(var s=p[r][e],n=0,o=s.length;o>n;n++)s[n]===i&&s.splice(n,1)}),fabric.util.addListener=l,fabric.util.removeListener=u;var v=function(t){return typeof t.clientX!==h?t.clientX:0},b=function(t){return typeof t.clientY!==h?t.clientY:0};fabric.isTouchSupported&&(v=function(t){return n(t,"pageX","clientX")},b=function(t){return n(t,"pageY","clientY")}),fabric.util.getPointer=s,fabric.util.object.extend(fabric.util,fabric.Observable)}(),function(){function t(t,e){var i=t.style;if(!i)return t;if("string"==typeof e)return t.style.cssText+=";"+e,e.indexOf("opacity")>-1?n(t,e.match(/opacity:\s*(\d?\.?\d*)/)[1]):t;for(var r in e)if("opacity"===r)n(t,e[r]);else{var s="float"===r||"cssFloat"===r?"undefined"==typeof i.styleFloat?"cssFloat":"styleFloat":r;i[s]=e[r]}return t}var e=fabric.document.createElement("div"),i="string"==typeof e.style.opacity,r="string"==typeof e.style.filter,s=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,n=function(t){return t};i?n=function(t,e){return t.style.opacity=e,t}:r&&(n=function(t,e){var i=t.style;return t.currentStyle&&!t.currentStyle.hasLayout&&(i.zoom=1),s.test(i.filter)?(e=e>=.9999?"":"alpha(opacity="+100*e+")",i.filter=i.filter.replace(s,e)):i.filter+=" alpha(opacity="+100*e+")",t}),fabric.util.setStyle=t}(),function(){function t(t){return"string"==typeof t?fabric.document.getElementById(t):t}function e(t,e){var i=fabric.document.createElement(t);for(var r in e)"class"===r?i.className=e[r]:"for"===r?i.htmlFor=e[r]:i.setAttribute(r,e[r]);return i}function i(t,e){t&&-1===(" "+t.className+" ").indexOf(" "+e+" ")&&(t.className+=(t.className?" ":"")+e)}function r(t,i,r){return"string"==typeof i&&(i=e(i,r)),t.parentNode&&t.parentNode.replaceChild(i,t),i.appendChild(t),i}function s(t,e){var i,r,s=0,n=0,o=fabric.document.documentElement,a=fabric.document.body||{scrollLeft:0,scrollTop:0};for(r=t;t&&t.parentNode&&!i;)t=t.parentNode,1===t.nodeType&&"fixed"===fabric.util.getElementStyle(t,"position")&&(i=t),1===t.nodeType&&r!==e&&"absolute"===fabric.util.getElementStyle(t,"position")?(s=0,n=0):t===fabric.document?(s=a.scrollLeft||o.scrollLeft||0,n=a.scrollTop||o.scrollTop||0):(s+=t.scrollLeft||0,n+=t.scrollTop||0);return{left:s,top:n}}function n(t){var e,i,r=t&&t.ownerDocument,s={left:0,top:0},n={left:0,top:0},o={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!r)return{left:0,top:0};for(var a in o)n[o[a]]+=parseInt(l(t,a),10)||0;return e=r.documentElement,"undefined"!=typeof t.getBoundingClientRect&&(s=t.getBoundingClientRect()),i=fabric.util.getScrollLeftTop(t,null),{left:s.left+i.left-(e.clientLeft||0)+n.left,top:s.top+i.top-(e.clientTop||0)+n.top}}var o,a=Array.prototype.slice,h=function(t){return a.call(t,0)};try{o=h(fabric.document.childNodes)instanceof Array}catch(c){}o||(h=function(t){for(var e=new Array(t.length),i=t.length;i--;)e[i]=t[i];return e});var l;l=fabric.document.defaultView&&fabric.document.defaultView.getComputedStyle?function(t,e){var i=fabric.document.defaultView.getComputedStyle(t,null);return i?i[e]:void 0}:function(t,e){var i=t.style[e];return!i&&t.currentStyle&&(i=t.currentStyle[e]),i},function(){function t(t){return"undefined"!=typeof t.onselectstart&&(t.onselectstart=fabric.util.falseFunction),r?t.style[r]="none":"string"==typeof t.unselectable&&(t.unselectable="on"),t}function e(t){return"undefined"!=typeof t.onselectstart&&(t.onselectstart=null),r?t.style[r]="":"string"==typeof t.unselectable&&(t.unselectable=""),t}var i=fabric.document.documentElement.style,r="userSelect"in i?"userSelect":"MozUserSelect"in i?"MozUserSelect":"WebkitUserSelect"in i?"WebkitUserSelect":"KhtmlUserSelect"in i?"KhtmlUserSelect":"";fabric.util.makeElementUnselectable=t,fabric.util.makeElementSelectable=e}(),function(){function t(t,e){var i=fabric.document.getElementsByTagName("head")[0],r=fabric.document.createElement("script"),s=!0;r.onload=r.onreadystatechange=function(t){if(s){if("string"==typeof this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState)return;s=!1,e(t||fabric.window.event),r=r.onload=r.onreadystatechange=null}},r.src=t,i.appendChild(r)}fabric.util.getScript=t}(),fabric.util.getById=t,fabric.util.toArray=h,fabric.util.makeElement=e,fabric.util.addClass=i,fabric.util.wrapElement=r,fabric.util.getScrollLeftTop=s,fabric.util.getElementOffset=n,fabric.util.getElementStyle=l}(),function(){function t(t,e){return t+(/\?/.test(t)?"&":"?")+e}function e(){}function i(i,s){s||(s={});var n,o=s.method?s.method.toUpperCase():"GET",a=s.onComplete||function(){},h=r();return h.onreadystatechange=function(){4===h.readyState&&(a(h),h.onreadystatechange=e)},"GET"===o&&(n=null,"string"==typeof s.parameters&&(i=t(i,s.parameters))),h.open(o,i,!0),("POST"===o||"PUT"===o)&&h.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),h.send(n),h}var r=function(){for(var t=[function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.3.0")},function(){return new XMLHttpRequest}],e=t.length;e--;)try{var i=t[e]();if(i)return t[e]}catch(r){}}();fabric.util.request=i}(),fabric.log=function(){},fabric.warn=function(){},"undefined"!=typeof console&&["log","warn"].forEach(function(t){"undefined"!=typeof console[t]&&"function"==typeof console[t].apply&&(fabric[t]=function(){return console[t].apply(console,arguments)})}),function(){function t(t){e(function(i){t||(t={});var r,s=i||+new Date,n=t.duration||500,o=s+n,a=t.onChange||function(){},h=t.abort||function(){return!1},c=t.easing||function(t,e,i,r){return-i*Math.cos(t/r*(Math.PI/2))+i+e},l="startValue"in t?t.startValue:0,u="endValue"in t?t.endValue:100,f=t.byValue||u-l;t.onStart&&t.onStart(),function d(i){r=i||+new Date;var u=r>o?n:r-s;return h()?void(t.onComplete&&t.onComplete()):(a(c(u,l,f,n)),r>o?void(t.onComplete&&t.onComplete()):void e(d))}(s)})}function e(){return i.apply(fabric.window,arguments)}var i=fabric.window.requestAnimationFrame||fabric.window.webkitRequestAnimationFrame||fabric.window.mozRequestAnimationFrame||fabric.window.oRequestAnimationFrame||fabric.window.msRequestAnimationFrame||function(t){fabric.window.setTimeout(t,1e3/60)};fabric.util.animate=t,fabric.util.requestAnimFrame=e}(),function(){function t(t,e,i,r){return t<Math.abs(e)?(t=e,r=i/4):r=i/(2*Math.PI)*Math.asin(e/t),{a:t,c:e,p:i,s:r}}function e(t,e,i){return t.a*Math.pow(2,10*(e-=1))*Math.sin(2*(e*i-t.s)*Math.PI/t.p)}function i(t,e,i,r){return i*((t=t/r-1)*t*t+1)+e}function r(t,e,i,r){return t/=r/2,1>t?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e}function s(t,e,i,r){return i*(t/=r)*t*t*t+e}function n(t,e,i,r){return-i*((t=t/r-1)*t*t*t-1)+e}function o(t,e,i,r){return t/=r/2,1>t?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e}function a(t,e,i,r){return i*(t/=r)*t*t*t*t+e}function h(t,e,i,r){return i*((t=t/r-1)*t*t*t*t+1)+e}function c(t,e,i,r){return t/=r/2,1>t?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e}function l(t,e,i,r){return-i*Math.cos(t/r*(Math.PI/2))+i+e}function u(t,e,i,r){return i*Math.sin(t/r*(Math.PI/2))+e}function f(t,e,i,r){return-i/2*(Math.cos(Math.PI*t/r)-1)+e}function d(t,e,i,r){return 0===t?e:i*Math.pow(2,10*(t/r-1))+e}function g(t,e,i,r){return t===r?e+i:i*(-Math.pow(2,-10*t/r)+1)+e}function p(t,e,i,r){return 0===t?e:t===r?e+i:(t/=r/2,1>t?i/2*Math.pow(2,10*(t-1))+e:i/2*(-Math.pow(2,-10*--t)+2)+e)}function v(t,e,i,r){return-i*(Math.sqrt(1-(t/=r)*t)-1)+e}function b(t,e,i,r){return i*Math.sqrt(1-(t=t/r-1)*t)+e}function m(t,e,i,r){return t/=r/2,1>t?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e}function y(i,r,s,n){var o=1.70158,a=0,h=s;if(0===i)return r;if(i/=n,1===i)return r+s;a||(a=.3*n);var c=t(h,s,a,o);return-e(c,i,n)+r}function _(e,i,r,s){var n=1.70158,o=0,a=r;if(0===e)return i;if(e/=s,1===e)return i+r;o||(o=.3*s);var h=t(a,r,o,n);return h.a*Math.pow(2,-10*e)*Math.sin(2*(e*s-h.s)*Math.PI/h.p)+h.c+i}function x(i,r,s,n){var o=1.70158,a=0,h=s;if(0===i)return r;if(i/=n/2,2===i)return r+s;a||(a=.3*n*1.5);var c=t(h,s,a,o);return 1>i?-.5*e(c,i,n)+r:c.a*Math.pow(2,-10*(i-=1))*Math.sin(2*(i*n-c.s)*Math.PI/c.p)*.5+c.c+r}function C(t,e,i,r,s){return void 0===s&&(s=1.70158),i*(t/=r)*t*((s+1)*t-s)+e}function S(t,e,i,r,s){return void 0===s&&(s=1.70158),i*((t=t/r-1)*t*((s+1)*t+s)+1)+e}function w(t,e,i,r,s){return void 0===s&&(s=1.70158),t/=r/2,1>t?i/2*t*t*(((s*=1.525)+1)*t-s)+e:i/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+e}function O(t,e,i,r){return i-T(r-t,0,i,r)+e}function T(t,e,i,r){return(t/=r)<1/2.75?7.5625*i*t*t+e:2/2.75>t?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e}function k(t,e,i,r){return r/2>t?.5*O(2*t,0,i,r)+e:.5*T(2*t-r,0,i,r)+.5*i+e}fabric.util.ease={easeInQuad:function(t,e,i,r){return i*(t/=r)*t+e},easeOutQuad:function(t,e,i,r){return-i*(t/=r)*(t-2)+e},easeInOutQuad:function(t,e,i,r){return t/=r/2,1>t?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,i,r){return i*(t/=r)*t*t+e},easeOutCubic:i,easeInOutCubic:r,easeInQuart:s,easeOutQuart:n,easeInOutQuart:o,easeInQuint:a,easeOutQuint:h,easeInOutQuint:c,easeInSine:l,easeOutSine:u,easeInOutSine:f,easeInExpo:d,easeOutExpo:g,easeInOutExpo:p,easeInCirc:v,easeOutCirc:b,easeInOutCirc:m,easeInElastic:y,easeOutElastic:_,easeInOutElastic:x,easeInBack:C,easeOutBack:S,easeInOutBack:w,easeInBounce:O,easeOutBounce:T,easeInOutBounce:k}}(),function(t){"use strict";function e(t){return t in C?C[t]:t}function i(t,e,i,r){var s,n="[object Array]"===Object.prototype.toString.call(e);return"fill"!==t&&"stroke"!==t||"none"!==e?"strokeDashArray"===t?e=e.replace(/,/g," ").split(/\s+/).map(function(t){return parseFloat(t)}):"transformMatrix"===t?e=i&&i.transformMatrix?x(i.transformMatrix,p.parseTransformAttribute(e)):p.parseTransformAttribute(e):"visible"===t?(e="none"===e||"hidden"===e?!1:!0,i&&i.visible===!1&&(e=!1)):"originX"===t?e="start"===e?"left":"end"===e?"right":"center":s=n?e.map(_):_(e,r):e="",!n&&isNaN(s)?e:s}function r(t){for(var e in S)if(t[e]&&"undefined"!=typeof t[S[e]]&&0!==t[e].indexOf("url(")){var i=new p.Color(t[e]);t[e]=i.setAlpha(y(i.getAlpha()*t[S[e]],2)).toRgba()}return t}function s(t,r){var s,n;t.replace(/;$/,"").split(";").forEach(function(t){var o=t.split(":");s=e(o[0].trim().toLowerCase()),n=i(s,o[1].trim()),r[s]=n})}function n(t,r){var s,n;for(var o in t)"undefined"!=typeof t[o]&&(s=e(o.toLowerCase()),n=i(s,t[o]),r[s]=n)}function o(t,e){var i={};for(var r in p.cssRules[e])if(a(t,r.split(" ")))for(var s in p.cssRules[e][r])i[s]=p.cssRules[e][r][s];return i}function a(t,e){var i,r=!0;return i=c(t,e.pop()),i&&e.length&&(r=h(t,e)),i&&r&&0===e.length}function h(t,e){for(var i,r=!0;t.parentNode&&1===t.parentNode.nodeType&&e.length;)r&&(i=e.pop()),t=t.parentNode,r=c(t,i);return 0===e.length}function c(t,e){var i,r=t.nodeName,s=t.getAttribute("class"),n=t.getAttribute("id");if(i=new RegExp("^"+r,"i"),e=e.replace(i,""),n&&e.length&&(i=new RegExp("#"+n+"(?![a-zA-Z\\-]+)","i"),e=e.replace(i,"")),s&&e.length){s=s.split(" ");for(var o=s.length;o--;)i=new RegExp("\\."+s[o]+"(?![a-zA-Z\\-]+)","i"),e=e.replace(i,"")}return 0===e.length}function l(t,e){var i;if(t.getElementById&&(i=t.getElementById(e)),i)return i;var r,s,n,o=t.getElementsByTagName("*");for(s=0;s<o.length;s++)if(r=o[s],n===r.getAttribute("id"))return r}function u(t){for(var e=t.getElementsByTagName("use"),i=0;e.length&&i<e.length;){for(var r,s=e[i],n=s.getAttribute("xlink:href").substr(1),o=s.getAttribute("x")||0,a=s.getAttribute("y")||0,h=l(t,n).cloneNode(!0),c=(h.getAttribute("transform")||"")+" translate("+o+", "+a+")",u=e.length,f=0,d=s.attributes,g=d.length;g>f;f++){var p=d.item(f);"x"!==p.nodeName&&"y"!==p.nodeName&&"xlink:href"!==p.nodeName&&("transform"===p.nodeName?c=p.nodeValue+" "+c:h.setAttribute(p.nodeName,p.nodeValue))}h.setAttribute("transform",c),h.setAttribute("instantiated_by_use","1"),h.removeAttribute("id"),r=s.parentNode,r.replaceChild(h,s),e.length===u&&i++}}function f(t,e,i){var r,s,n,o,a=t.getAttribute("viewBox"),h=1,c=1,l=0,u=0;if(a&&(a=a.match(w))&&(l=-parseFloat(a[1]),u=-parseFloat(a[2]),r=parseFloat(a[3]),s=parseFloat(a[4]),e&&e!==r&&(h=e/r),i&&i!==s&&(c=i/s),c=h=h>c?c:h,1!==h||1!==c||0!==l||0!==u)){if(n=" matrix("+h+" 0 0 "+c+" "+l*h+" "+u*c+") ","svg"===t.tagName){for(o=t.ownerDocument.createElement("g");null!=t.firstChild;)o.appendChild(t.firstChild);t.appendChild(o)}else o=t,n=o.getAttribute("transform")+n;o.setAttribute("transform",n)}}function d(t){var e=t.objects,i=t.options;return e=e.map(function(t){return p[b(t.type)].fromObject(t)}),{objects:e,options:i}}function g(t,e,i){e[i]&&e[i].toSVG&&t.push('<pattern x="0" y="0" id="',i,'Pattern" ','width="',e[i].source.width,'" height="',e[i].source.height,'" patternUnits="userSpaceOnUse">','<image x="0" y="0" ','width="',e[i].source.width,'" height="',e[i].source.height,'" xlink:href="',e[i].source.src,'"></image></pattern>')}var p=t.fabric||(t.fabric={}),v=p.util.object.extend,b=p.util.string.capitalize,m=p.util.object.clone,y=p.util.toFixed,_=p.util.parseUnit,x=p.util.multiplyTransformMatrices,C={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","stroke-dasharray":"strokeDashArray","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"originX"},S={stroke:"strokeOpacity",fill:"fillOpacity"};p.cssRules={},p.gradientDefs={},p.parseTransformAttribute=function(){function t(t,e){var i=e[0];t[0]=Math.cos(i),t[1]=Math.sin(i),t[2]=-Math.sin(i),t[3]=Math.cos(i)}function e(t,e){var i=e[0],r=2===e.length?e[1]:e[0];t[0]=i,t[3]=r}function i(t,e){t[2]=Math.tan(p.util.degreesToRadians(e[0]))}function r(t,e){t[1]=Math.tan(p.util.degreesToRadians(e[0]))}function s(t,e){t[4]=e[0],2===e.length&&(t[5]=e[1])}var n=[1,0,0,1,0,0],o=p.reNum,a="(?:\\s+,?\\s*|,\\s*)",h="(?:(skewX)\\s*\\(\\s*("+o+")\\s*\\))",c="(?:(skewY)\\s*\\(\\s*("+o+")\\s*\\))",l="(?:(rotate)\\s*\\(\\s*("+o+")(?:"+a+"("+o+")"+a+"("+o+"))?\\s*\\))",u="(?:(scale)\\s*\\(\\s*("+o+")(?:"+a+"("+o+"))?\\s*\\))",f="(?:(translate)\\s*\\(\\s*("+o+")(?:"+a+"("+o+"))?\\s*\\))",d="(?:(matrix)\\s*\\(\\s*("+o+")"+a+"("+o+")"+a+"("+o+")"+a+"("+o+")"+a+"("+o+")"+a+"("+o+")\\s*\\))",g="(?:"+d+"|"+f+"|"+u+"|"+l+"|"+h+"|"+c+")",v="(?:"+g+"(?:"+a+g+")*)",b="^\\s*(?:"+v+"?)\\s*$",m=new RegExp(b),y=new RegExp(g,"g");return function(o){var a=n.concat(),h=[];if(!o||o&&!m.test(o))return a;o.replace(y,function(o){var c=new RegExp(g).exec(o).filter(function(t){return""!==t&&null!=t}),l=c[1],u=c.slice(2).map(parseFloat);switch(l){case"translate":s(a,u);break;case"rotate":u[0]=p.util.degreesToRadians(u[0]),t(a,u);break;case"scale":e(a,u);break;case"skewX":i(a,u);break;case"skewY":r(a,u);break;case"matrix":a=u}h.push(a.concat()),a=n.concat()});for(var c=h[0];h.length>1;)h.shift(),c=p.util.multiplyTransformMatrices(c,h[0]);return c}}();var w=new RegExp("^\\s*("+p.reNum+"+)\\s*,?\\s*("+p.reNum+"+)\\s*,?\\s*("+p.reNum+"+)\\s*,?\\s*("+p.reNum+"+)\\s*$");p.parseSVGDocument=function(){function t(t,e){for(;t&&(t=t.parentNode);)if(e.test(t.nodeName)&&!t.getAttribute("instantiated_by_use"))return!0;return!1}var e=/^(path|circle|polygon|polyline|ellipse|rect|line|image|text)$/,i=/^(symbol|image|marker|pattern|view)$/;return function(r,s,n){if(r){u(r);var o,a,h=new Date,c=p.Object.__uid++,l=!1;if(r.getAttribute("width")&&"100%"!==r.getAttribute("width")&&(o=_(r.getAttribute("width"))),r.getAttribute("height")&&"100%"!==r.getAttribute("height")&&(a=_(r.getAttribute("height"))),!o||!a){var d=r.getAttribute("viewBox");d&&(d=d.match(w))?(o=parseFloat(d[3]),a=parseFloat(d[4])):l=!0}f(r,o,a);var g=p.util.toArray(r.getElementsByTagName("*"));if(0===g.length&&p.isLikelyNode){g=r.selectNodes('//*[name(.)!="svg"]');for(var v=[],b=0,y=g.length;y>b;b++)v[b]=g[b];g=v}var x=g.filter(function(r){return i.test(r.tagName)&&f(r,0,0),e.test(r.tagName)&&!t(r,/^(?:pattern|defs|symbol|metadata)$/)});if(!x||x&&!x.length)return void(s&&s([],{}));var C={width:o,height:a,svgUid:c,toBeParsed:l};p.gradientDefs[c]=p.getGradientDefs(r),p.cssRules[c]=p.getCSSRules(r),p.parseElements(x,function(t){p.documentParsingTime=new Date-h,s&&s(t,C)},m(C),n)}}}();var O={has:function(t,e){e(!1)},get:function(){},set:function(){}},T=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+p.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+p.reNum+"))?\\s+(.*)");v(p,{parseFontDeclaration:function(t,e){var i=t.match(T);if(i){var r=i[1],s=i[3],n=i[4],o=i[5],a=i[6];r&&(e.fontStyle=r),s&&(e.fontWeight=isNaN(parseFloat(s))?s:parseFloat(s)),n&&(e.fontSize=_(n)),
a&&(e.fontFamily=a),o&&(e.lineHeight="normal"===o?1:o)}},getGradientDefs:function(t){var e,i,r,s,n=t.getElementsByTagName("linearGradient"),o=t.getElementsByTagName("radialGradient"),a=0,h=[],c={},l={};for(h.length=n.length+o.length,i=n.length;i--;)h[a++]=n[i];for(i=o.length;i--;)h[a++]=o[i];for(;a--;)e=h[a],s=e.getAttribute("xlink:href"),r=e.getAttribute("id"),s&&(l[r]=s.substr(1)),c[r]=e;for(r in l){var u=c[l[r]].cloneNode(!0);for(e=c[r];u.firstChild;)e.appendChild(u.firstChild)}return c},parseAttributes:function(t,s,n){if(t){var a,h,c={};"undefined"==typeof n&&(n=t.getAttribute("svgUid")),t.parentNode&&/^symbol|[g|a]$/i.test(t.parentNode.nodeName)&&(c=p.parseAttributes(t.parentNode,s,n)),h=c&&c.fontSize||t.getAttribute("font-size")||p.Text.DEFAULT_SVG_FONT_SIZE;var l=s.reduce(function(r,s){return a=t.getAttribute(s),a&&(s=e(s),a=i(s,a,c,h),r[s]=a),r},{});return l=v(l,v(o(t,n),p.parseStyleAttribute(t))),l.font&&p.parseFontDeclaration(l.font,l),r(v(c,l))}},parseElements:function(t,e,i,r){new p.ElementsParser(t,e,i,r).parse()},parseStyleAttribute:function(t){var e={},i=t.getAttribute("style");return i?("string"==typeof i?s(i,e):n(i,e),e):e},parsePointsAttribute:function(t){if(!t)return null;t=t.replace(/,/g," ").trim(),t=t.split(/\s+/);var e,i,r=[];for(e=0,i=t.length;i>e;e+=2)r.push({x:parseFloat(t[e]),y:parseFloat(t[e+1])});return r},getCSSRules:function(t){for(var r,s=t.getElementsByTagName("style"),n={},o=0,a=s.length;a>o;o++){var h=s[o].textContent;h=h.replace(/\/\*[\s\S]*?\*\//g,""),""!==h.trim()&&(r=h.match(/[^{]*\{[\s\S]*?\}/g),r=r.map(function(t){return t.trim()}),r.forEach(function(t){for(var r=t.match(/([\s\S]*?)\s*\{([^}]*)\}/),s={},o=r[2].trim(),a=o.replace(/;$/,"").split(/\s*;\s*/),h=0,c=a.length;c>h;h++){var l=a[h].split(/\s*:\s*/),u=e(l[0]),f=i(u,l[1],l[0]);s[u]=f}t=r[1],t.split(",").forEach(function(t){t=t.replace(/^svg/i,"").trim(),""!==t&&(n[t]=p.util.object.clone(s))})}))}return n},loadSVGFromURL:function(t,e,i){function r(r){var s=r.responseXML;s&&!s.documentElement&&p.window.ActiveXObject&&r.responseText&&(s=new ActiveXObject("Microsoft.XMLDOM"),s.async="false",s.loadXML(r.responseText.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,""))),s&&s.documentElement&&p.parseSVGDocument(s.documentElement,function(i,r){O.set(t,{objects:p.util.array.invoke(i,"toObject"),options:r}),e(i,r)},i)}t=t.replace(/^\n\s*/,"").trim(),O.has(t,function(i){i?O.get(t,function(t){var i=d(t);e(i.objects,i.options)}):new p.util.request(t,{method:"get",onComplete:r})})},loadSVGFromString:function(t,e,i){t=t.trim();var r;if("undefined"!=typeof DOMParser){var s=new DOMParser;s&&s.parseFromString&&(r=s.parseFromString(t,"text/xml"))}else p.window.ActiveXObject&&(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(t.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));p.parseSVGDocument(r.documentElement,function(t,i){e(t,i)},i)},createSVGFontFacesMarkup:function(t){for(var e="",i=0,r=t.length;r>i;i++)"text"===t[i].type&&t[i].path&&(e+=["@font-face {","font-family: ",t[i].fontFamily,"; ","src: url('",t[i].path,"')","}"].join(""));return e&&(e=['<style type="text/css">',"<![CDATA[",e,"]]>","</style>"].join("")),e},createSVGRefElementsMarkup:function(t){var e=[];return g(e,t,"backgroundColor"),g(e,t,"overlayColor"),e.join("")}})}("undefined"!=typeof exports?exports:this),fabric.ElementsParser=function(t,e,i,r){this.elements=t,this.callback=e,this.options=i,this.reviver=r,this.svgUid=i&&i.svgUid||0},fabric.ElementsParser.prototype.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},fabric.ElementsParser.prototype.createObjects=function(){for(var t=0,e=this.elements.length;e>t;t++)this.elements[t].setAttribute("svgUid",this.svgUid),function(t,e){setTimeout(function(){t.createObject(t.elements[e],e)},0)}(this,t)},fabric.ElementsParser.prototype.createObject=function(t,e){var i=fabric[fabric.util.string.capitalize(t.tagName)];if(i&&i.fromElement)try{this._createObject(i,t,e)}catch(r){fabric.log(r)}else this.checkIfDone()},fabric.ElementsParser.prototype._createObject=function(t,e,i){if(t.async)t.fromElement(e,this.createCallback(i,e),this.options);else{var r=t.fromElement(e,this.options);this.resolveGradient(r,"fill"),this.resolveGradient(r,"stroke"),this.reviver&&this.reviver(e,r),this.instances[i]=r,this.checkIfDone()}},fabric.ElementsParser.prototype.createCallback=function(t,e){var i=this;return function(r){i.resolveGradient(r,"fill"),i.resolveGradient(r,"stroke"),i.reviver&&i.reviver(e,r),i.instances[t]=r,i.checkIfDone()}},fabric.ElementsParser.prototype.resolveGradient=function(t,e){var i=t.get(e);if(/^url\(/.test(i)){var r=i.slice(5,i.length-1);fabric.gradientDefs[this.svgUid][r]&&t.set(e,fabric.Gradient.fromElement(fabric.gradientDefs[this.svgUid][r],t))}},fabric.ElementsParser.prototype.checkIfDone=function(){0===--this.numElements&&(this.instances=this.instances.filter(function(t){return null!=t}),this.callback(this.instances))},function(t){"use strict";function e(t,e){this.x=t,this.y=e}var i=t.fabric||(t.fabric={});return i.Point?void i.warn("fabric.Point is already defined"):(i.Point=e,void(e.prototype={constructor:e,add:function(t){return new e(this.x+t.x,this.y+t.y)},addEquals:function(t){return this.x+=t.x,this.y+=t.y,this},scalarAdd:function(t){return new e(this.x+t,this.y+t)},scalarAddEquals:function(t){return this.x+=t,this.y+=t,this},subtract:function(t){return new e(this.x-t.x,this.y-t.y)},subtractEquals:function(t){return this.x-=t.x,this.y-=t.y,this},scalarSubtract:function(t){return new e(this.x-t,this.y-t)},scalarSubtractEquals:function(t){return this.x-=t,this.y-=t,this},multiply:function(t){return new e(this.x*t,this.y*t)},multiplyEquals:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return new e(this.x/t,this.y/t)},divideEquals:function(t){return this.x/=t,this.y/=t,this},eq:function(t){return this.x===t.x&&this.y===t.y},lt:function(t){return this.x<t.x&&this.y<t.y},lte:function(t){return this.x<=t.x&&this.y<=t.y},gt:function(t){return this.x>t.x&&this.y>t.y},gte:function(t){return this.x>=t.x&&this.y>=t.y},lerp:function(t,i){return new e(this.x+(t.x-this.x)*i,this.y+(t.y-this.y)*i)},distanceFrom:function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},midPointFrom:function(t){return new e(this.x+(t.x-this.x)/2,this.y+(t.y-this.y)/2)},min:function(t){return new e(Math.min(this.x,t.x),Math.min(this.y,t.y))},max:function(t){return new e(Math.max(this.x,t.x),Math.max(this.y,t.y))},toString:function(){return this.x+","+this.y},setXY:function(t,e){this.x=t,this.y=e},setFromPoint:function(t){this.x=t.x,this.y=t.y},swap:function(t){var e=this.x,i=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=i}}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";function e(t){this.status=t,this.points=[]}var i=t.fabric||(t.fabric={});return i.Intersection?void i.warn("fabric.Intersection is already defined"):(i.Intersection=e,i.Intersection.prototype={appendPoint:function(t){this.points.push(t)},appendPoints:function(t){this.points=this.points.concat(t)}},i.Intersection.intersectLineLine=function(t,r,s,n){var o,a=(n.x-s.x)*(t.y-s.y)-(n.y-s.y)*(t.x-s.x),h=(r.x-t.x)*(t.y-s.y)-(r.y-t.y)*(t.x-s.x),c=(n.y-s.y)*(r.x-t.x)-(n.x-s.x)*(r.y-t.y);if(0!==c){var l=a/c,u=h/c;l>=0&&1>=l&&u>=0&&1>=u?(o=new e("Intersection"),o.points.push(new i.Point(t.x+l*(r.x-t.x),t.y+l*(r.y-t.y)))):o=new e}else o=new e(0===a||0===h?"Coincident":"Parallel");return o},i.Intersection.intersectLinePolygon=function(t,i,r){for(var s=new e,n=r.length,o=0;n>o;o++){var a=r[o],h=r[(o+1)%n],c=e.intersectLineLine(t,i,a,h);s.appendPoints(c.points)}return s.points.length>0&&(s.status="Intersection"),s},i.Intersection.intersectPolygonPolygon=function(t,i){for(var r=new e,s=t.length,n=0;s>n;n++){var o=t[n],a=t[(n+1)%s],h=e.intersectLinePolygon(o,a,i);r.appendPoints(h.points)}return r.points.length>0&&(r.status="Intersection"),r},void(i.Intersection.intersectPolygonRectangle=function(t,r,s){var n=r.min(s),o=r.max(s),a=new i.Point(o.x,n.y),h=new i.Point(n.x,o.y),c=e.intersectLinePolygon(n,a,t),l=e.intersectLinePolygon(a,o,t),u=e.intersectLinePolygon(o,h,t),f=e.intersectLinePolygon(h,n,t),d=new e;return d.appendPoints(c.points),d.appendPoints(l.points),d.appendPoints(u.points),d.appendPoints(f.points),d.points.length>0&&(d.status="Intersection"),d}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";function e(t){t?this._tryParsingColor(t):this.setSource([0,0,0,1])}function i(t,e,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?t+6*(e-t)*i:.5>i?e:2/3>i?t+(e-t)*(2/3-i)*6:t}var r=t.fabric||(t.fabric={});return r.Color?void r.warn("fabric.Color is already defined."):(r.Color=e,r.Color.prototype={_tryParsingColor:function(t){var i;return t in e.colorNameMap&&(t=e.colorNameMap[t]),"transparent"===t?void this.setSource([255,255,255,0]):(i=e.sourceFromHex(t),i||(i=e.sourceFromRgb(t)),i||(i=e.sourceFromHsl(t)),void(i&&this.setSource(i)))},_rgbToHsl:function(t,e,i){t/=255,e/=255,i/=255;var s,n,o,a=r.util.array.max([t,e,i]),h=r.util.array.min([t,e,i]);if(o=(a+h)/2,a===h)s=n=0;else{var c=a-h;switch(n=o>.5?c/(2-a-h):c/(a+h),a){case t:s=(e-i)/c+(i>e?6:0);break;case e:s=(i-t)/c+2;break;case i:s=(t-e)/c+4}s/=6}return[Math.round(360*s),Math.round(100*n),Math.round(100*o)]},getSource:function(){return this._source},setSource:function(t){this._source=t},toRgb:function(){var t=this.getSource();return"rgb("+t[0]+","+t[1]+","+t[2]+")"},toRgba:function(){var t=this.getSource();return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},toHsl:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsl("+e[0]+","+e[1]+"%,"+e[2]+"%)"},toHsla:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsla("+e[0]+","+e[1]+"%,"+e[2]+"%,"+t[3]+")"},toHex:function(){var t,e,i,r=this.getSource();return t=r[0].toString(16),t=1===t.length?"0"+t:t,e=r[1].toString(16),e=1===e.length?"0"+e:e,i=r[2].toString(16),i=1===i.length?"0"+i:i,t.toUpperCase()+e.toUpperCase()+i.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(t){var e=this.getSource();return e[3]=t,this.setSource(e),this},toGrayscale:function(){var t=this.getSource(),e=parseInt((.3*t[0]+.59*t[1]+.11*t[2]).toFixed(0),10),i=t[3];return this.setSource([e,e,e,i]),this},toBlackWhite:function(t){var e=this.getSource(),i=(.3*e[0]+.59*e[1]+.11*e[2]).toFixed(0),r=e[3];return t=t||127,i=Number(i)<Number(t)?0:255,this.setSource([i,i,i,r]),this},overlayWith:function(t){t instanceof e||(t=new e(t));for(var i=[],r=this.getAlpha(),s=.5,n=this.getSource(),o=t.getSource(),a=0;3>a;a++)i.push(Math.round(n[a]*(1-s)+o[a]*s));return i[3]=r,this.setSource(i),this}},r.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,r.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,r.Color.reHex=/^#?([0-9a-f]{6}|[0-9a-f]{3})$/i,r.Color.colorNameMap={aqua:"#00FFFF",black:"#000000",blue:"#0000FF",fuchsia:"#FF00FF",gray:"#808080",green:"#008000",lime:"#00FF00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#FFA500",purple:"#800080",red:"#FF0000",silver:"#C0C0C0",teal:"#008080",white:"#FFFFFF",yellow:"#FFFF00"},r.Color.fromRgb=function(t){return e.fromSource(e.sourceFromRgb(t))},r.Color.sourceFromRgb=function(t){var i=t.match(e.reRGBa);if(i){var r=parseInt(i[1],10)/(/%$/.test(i[1])?100:1)*(/%$/.test(i[1])?255:1),s=parseInt(i[2],10)/(/%$/.test(i[2])?100:1)*(/%$/.test(i[2])?255:1),n=parseInt(i[3],10)/(/%$/.test(i[3])?100:1)*(/%$/.test(i[3])?255:1);return[parseInt(r,10),parseInt(s,10),parseInt(n,10),i[4]?parseFloat(i[4]):1]}},r.Color.fromRgba=e.fromRgb,r.Color.fromHsl=function(t){return e.fromSource(e.sourceFromHsl(t))},r.Color.sourceFromHsl=function(t){var r=t.match(e.reHSLa);if(r){var s,n,o,a=(parseFloat(r[1])%360+360)%360/360,h=parseFloat(r[2])/(/%$/.test(r[2])?100:1),c=parseFloat(r[3])/(/%$/.test(r[3])?100:1);if(0===h)s=n=o=c;else{var l=.5>=c?c*(h+1):c+h-c*h,u=2*c-l;s=i(u,l,a+1/3),n=i(u,l,a),o=i(u,l,a-1/3)}return[Math.round(255*s),Math.round(255*n),Math.round(255*o),r[4]?parseFloat(r[4]):1]}},r.Color.fromHsla=e.fromHsl,r.Color.fromHex=function(t){return e.fromSource(e.sourceFromHex(t))},r.Color.sourceFromHex=function(t){if(t.match(e.reHex)){var i=t.slice(t.indexOf("#")+1),r=3===i.length,s=r?i.charAt(0)+i.charAt(0):i.substring(0,2),n=r?i.charAt(1)+i.charAt(1):i.substring(2,4),o=r?i.charAt(2)+i.charAt(2):i.substring(4,6);return[parseInt(s,16),parseInt(n,16),parseInt(o,16),1]}},void(r.Color.fromSource=function(t){var i=new e;return i.setSource(t),i}))}("undefined"!=typeof exports?exports:this),function(){function t(t){var e,i,r,s=t.getAttribute("style"),n=t.getAttribute("offset");if(n=parseFloat(n)/(/%$/.test(n)?100:1),n=0>n?0:n>1?1:n,s){var o=s.split(/\s*;\s*/);""===o[o.length-1]&&o.pop();for(var a=o.length;a--;){var h=o[a].split(/\s*:\s*/),c=h[0].trim(),l=h[1].trim();"stop-color"===c?e=l:"stop-opacity"===c&&(r=l)}}return e||(e=t.getAttribute("stop-color")||"rgb(0,0,0)"),r||(r=t.getAttribute("stop-opacity")),e=new fabric.Color(e),i=e.getAlpha(),r=isNaN(parseFloat(r))?1:parseFloat(r),r*=i,{offset:n,color:e.toRgb(),opacity:r}}function e(t){return{x1:t.getAttribute("x1")||0,y1:t.getAttribute("y1")||0,x2:t.getAttribute("x2")||"100%",y2:t.getAttribute("y2")||0}}function i(t){return{x1:t.getAttribute("fx")||t.getAttribute("cx")||"50%",y1:t.getAttribute("fy")||t.getAttribute("cy")||"50%",r1:0,x2:t.getAttribute("cx")||"50%",y2:t.getAttribute("cy")||"50%",r2:t.getAttribute("r")||"50%"}}function r(t,e,i){var r,s=0,n=1,o="";for(var a in e)r=parseFloat(e[a],10),n="string"==typeof e[a]&&/^\d+%$/.test(e[a])?.01:1,"x1"===a||"x2"===a||"r2"===a?(n*="objectBoundingBox"===i?t.width:1,s="objectBoundingBox"===i?t.left||0:0):("y1"===a||"y2"===a)&&(n*="objectBoundingBox"===i?t.height:1,s="objectBoundingBox"===i?t.top||0:0),e[a]=r*n+s;if("ellipse"===t.type&&null!==e.r2&&"objectBoundingBox"===i&&t.rx!==t.ry){var h=t.ry/t.rx;o=" scale(1, "+h+")",e.y1&&(e.y1/=h),e.y2&&(e.y2/=h)}return o}fabric.Gradient=fabric.util.createClass({offsetX:0,offsetY:0,initialize:function(t){t||(t={});var e={};this.id=fabric.Object.__uid++,this.type=t.type||"linear",e={x1:t.coords.x1||0,y1:t.coords.y1||0,x2:t.coords.x2||0,y2:t.coords.y2||0},"radial"===this.type&&(e.r1=t.coords.r1||0,e.r2=t.coords.r2||0),this.coords=e,this.colorStops=t.colorStops.slice(),t.gradientTransform&&(this.gradientTransform=t.gradientTransform),this.offsetX=t.offsetX||this.offsetX,this.offsetY=t.offsetY||this.offsetY},addColorStop:function(t){for(var e in t){var i=new fabric.Color(t[e]);this.colorStops.push({offset:e,color:i.toRgb(),opacity:i.getAlpha()})}return this},toObject:function(){return{type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY}},toSVG:function(t){var e,i,r=fabric.util.object.clone(this.coords);if(this.colorStops.sort(function(t,e){return t.offset-e.offset}),!t.group||"path-group"!==t.group.type)for(var s in r)"x1"===s||"x2"===s||"r2"===s?r[s]+=this.offsetX-t.width/2:("y1"===s||"y2"===s)&&(r[s]+=this.offsetY-t.height/2);i='id="SVGID_'+this.id+'" gradientUnits="userSpaceOnUse"',this.gradientTransform&&(i+=' gradientTransform="matrix('+this.gradientTransform.join(" ")+')" '),"linear"===this.type?e=["<linearGradient ",i,' x1="',r.x1,'" y1="',r.y1,'" x2="',r.x2,'" y2="',r.y2,'">\n']:"radial"===this.type&&(e=["<radialGradient ",i,' cx="',r.x2,'" cy="',r.y2,'" r="',r.r2,'" fx="',r.x1,'" fy="',r.y1,'">\n']);for(var n=0;n<this.colorStops.length;n++)e.push("<stop ",'offset="',100*this.colorStops[n].offset+"%",'" style="stop-color:',this.colorStops[n].color,null!=this.colorStops[n].opacity?";stop-opacity: "+this.colorStops[n].opacity:";",'"/>\n');return e.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n"),e.join("")},toLive:function(t,e){var i,r,s=fabric.util.object.clone(this.coords);if(this.type){if(e.group&&"path-group"===e.group.type)for(r in s)"x1"===r||"x2"===r?s[r]+=-this.offsetX+e.width/2:("y1"===r||"y2"===r)&&(s[r]+=-this.offsetY+e.height/2);"linear"===this.type?i=t.createLinearGradient(s.x1,s.y1,s.x2,s.y2):"radial"===this.type&&(i=t.createRadialGradient(s.x1,s.y1,s.r1,s.x2,s.y2,s.r2));for(var n=0,o=this.colorStops.length;o>n;n++){var a=this.colorStops[n].color,h=this.colorStops[n].opacity,c=this.colorStops[n].offset;"undefined"!=typeof h&&(a=new fabric.Color(a).setAlpha(h).toRgba()),i.addColorStop(parseFloat(c),a)}return i}}}),fabric.util.object.extend(fabric.Gradient,{fromElement:function(s,n){var o,a=s.getElementsByTagName("stop"),h="linearGradient"===s.nodeName?"linear":"radial",c=s.getAttribute("gradientUnits")||"objectBoundingBox",l=s.getAttribute("gradientTransform"),u=[],f={};"linear"===h?f=e(s):"radial"===h&&(f=i(s));for(var d=a.length;d--;)u.push(t(a[d]));o=r(n,f,c);var g=new fabric.Gradient({type:h,coords:f,colorStops:u,offsetX:-n.left,offsetY:-n.top});return(l||""!==o)&&(g.gradientTransform=fabric.parseTransformAttribute((l||"")+o)),g},forObject:function(t,e){return e||(e={}),r(t,e.coords,"userSpaceOnUse"),new fabric.Gradient(e)}})}(),fabric.Pattern=fabric.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,initialize:function(t){if(t||(t={}),this.id=fabric.Object.__uid++,t.source)if("string"==typeof t.source)if("undefined"!=typeof fabric.util.getFunctionBody(t.source))this.source=new Function(fabric.util.getFunctionBody(t.source));else{var e=this;this.source=fabric.util.createImage(),fabric.util.loadImage(t.source,function(t){e.source=t})}else this.source=t.source;t.repeat&&(this.repeat=t.repeat),t.offsetX&&(this.offsetX=t.offsetX),t.offsetY&&(this.offsetY=t.offsetY)},toObject:function(){var t;return"function"==typeof this.source?t=String(this.source):"string"==typeof this.source.src&&(t=this.source.src),{source:t,repeat:this.repeat,offsetX:this.offsetX,offsetY:this.offsetY}},toSVG:function(t){var e="function"==typeof this.source?this.source():this.source,i=e.width/t.getWidth(),r=e.height/t.getHeight(),s=this.offsetX/t.getWidth(),n=this.offsetY/t.getHeight(),o="";return("repeat-x"===this.repeat||"no-repeat"===this.repeat)&&(r=1),("repeat-y"===this.repeat||"no-repeat"===this.repeat)&&(i=1),e.src?o=e.src:e.toDataURL&&(o=e.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+s+'" y="'+n+'" width="'+i+'" height="'+r+'">\n<image x="0" y="0" width="'+e.width+'" height="'+e.height+'" xlink:href="'+o+'"></image>\n</pattern>\n'},toLive:function(t){var e="function"==typeof this.source?this.source():this.source;if(!e)return"";if("undefined"!=typeof e.src){if(!e.complete)return"";if(0===e.naturalWidth||0===e.naturalHeight)return""}return t.createPattern(e,this.repeat)}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.toFixed;return e.Shadow?void e.warn("fabric.Shadow is already defined."):(e.Shadow=e.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,initialize:function(t){"string"==typeof t&&(t=this._parseShadow(t));for(var i in t)this[i]=t[i];this.id=e.Object.__uid++},_parseShadow:function(t){var i=t.trim(),r=e.Shadow.reOffsetsAndBlur.exec(i)||[],s=i.replace(e.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:s.trim(),offsetX:parseInt(r[1],10)||0,offsetY:parseInt(r[2],10)||0,blur:parseInt(r[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(t){var e="SourceAlpha",r=40,s=40;return!t||t.fill!==this.color&&t.stroke!==this.color||(e="SourceGraphic"),t.width&&t.height&&(r=100*i(Math.abs(this.offsetX/t.getWidth()),2)+20,s=100*i(Math.abs(this.offsetY/t.getHeight()),2)+20),'<filter id="SVGID_'+this.id+'" y="-'+s+'%" height="'+(100+2*s)+'%" x="-'+r+'%" width="'+(100+2*r)+'%" >\n	<feGaussianBlur in="'+e+'" stdDeviation="'+i(this.blur?this.blur/2:0,3)+'" result="blurOut"></feGaussianBlur>\n	<feColorMatrix result="matrixOut" in="blurOut" type="matrix" values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0.30 0" ></feColorMatrix >\n	<feOffset dx="'+this.offsetX+'" dy="'+this.offsetY+'"></feOffset>\n	<feMerge>\n		<feMergeNode></feMergeNode>\n		<feMergeNode in="SourceGraphic"></feMergeNode>\n	</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY};var t={},i=e.Shadow.prototype;return this.color!==i.color&&(t.color=this.color),this.blur!==i.blur&&(t.blur=this.blur),this.offsetX!==i.offsetX&&(t.offsetX=this.offsetX),this.offsetY!==i.offsetY&&(t.offsetY=this.offsetY),t}}),void(e.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:px)?(?:\s?|$))?(-?\d+(?:px)?(?:\s?|$))?(\d+(?:px)?)?(?:\s?|$)(?:$|\s)/))}("undefined"!=typeof exports?exports:this),function(){"use strict";if(fabric.StaticCanvas)return void fabric.warn("fabric.StaticCanvas is already defined.");var t=fabric.util.object.extend,e=fabric.util.getElementOffset,i=fabric.util.removeFromArray,r=new Error("Could not initialize `canvas` element");fabric.StaticCanvas=fabric.util.createClass({initialize:function(t,e){e||(e={}),this._initStatic(t,e),fabric.StaticCanvas.activeInstance=this},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!0,renderOnAddRemove:!0,clipTo:null,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,preserveObjectStacking:!1,viewportTransform:[1,0,0,1,0,0],onBeforeScaleRotate:function(){},_initStatic:function(t,e){this._objects=[],this._createLowerCanvas(t),this._initOptions(e),this._setImageSmoothing(),e.overlayImage&&this.setOverlayImage(e.overlayImage,this.renderAll.bind(this)),e.backgroundImage&&this.setBackgroundImage(e.backgroundImage,this.renderAll.bind(this)),e.backgroundColor&&this.setBackgroundColor(e.backgroundColor,this.renderAll.bind(this)),e.overlayColor&&this.setOverlayColor(e.overlayColor,this.renderAll.bind(this)),this.calcOffset()},calcOffset:function(){return this._offset=e(this.lowerCanvasEl),this},setOverlayImage:function(t,e,i){return this.__setBgOverlayImage("overlayImage",t,e,i)},setBackgroundImage:function(t,e,i){return this.__setBgOverlayImage("backgroundImage",t,e,i)},setOverlayColor:function(t,e){return this.__setBgOverlayColor("overlayColor",t,e)},setBackgroundColor:function(t,e){return this.__setBgOverlayColor("backgroundColor",t,e)},_setImageSmoothing:function(){var t=this.getContext();t.imageSmoothingEnabled=this.imageSmoothingEnabled,t.webkitImageSmoothingEnabled=this.imageSmoothingEnabled,t.mozImageSmoothingEnabled=this.imageSmoothingEnabled,t.msImageSmoothingEnabled=this.imageSmoothingEnabled,t.oImageSmoothingEnabled=this.imageSmoothingEnabled},__setBgOverlayImage:function(t,e,i,r){return"string"==typeof e?fabric.util.loadImage(e,function(e){this[t]=new fabric.Image(e,r),i&&i()},this,r&&r.crossOrigin):(r&&e.setOptions(r),this[t]=e,i&&i()),this},__setBgOverlayColor:function(t,e,i){if(e&&e.source){var r=this;fabric.util.loadImage(e.source,function(s){r[t]=new fabric.Pattern({source:s,repeat:e.repeat,offsetX:e.offsetX,offsetY:e.offsetY}),i&&i()})}else this[t]=e,i&&i();return this},_createCanvasElement:function(){var t=fabric.document.createElement("canvas");if(t.style||(t.style={}),!t)throw r;return this._initCanvasElement(t),t},_initCanvasElement:function(t){if(fabric.util.createCanvasElement(t),"undefined"==typeof t.getContext)throw r},_initOptions:function(t){for(var e in t)this[e]=t[e];this.width=this.width||parseInt(this.lowerCanvasEl.width,10)||0,this.height=this.height||parseInt(this.lowerCanvasEl.height,10)||0,this.lowerCanvasEl.style&&(this.lowerCanvasEl.width=this.width,this.lowerCanvasEl.height=this.height,this.lowerCanvasEl.style.width=this.width+"px",this.lowerCanvasEl.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(t){this.lowerCanvasEl=fabric.util.getById(t)||this._createCanvasElement(),this._initCanvasElement(this.lowerCanvasEl),fabric.util.addClass(this.lowerCanvasEl,"lower-canvas"),this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(t,e){return this.setDimensions({width:t},e)},setHeight:function(t,e){return this.setDimensions({height:t},e)},setDimensions:function(t,e){var i;e=e||{};for(var r in t)i=t[r],e.cssOnly||(this._setBackstoreDimension(r,t[r]),i+="px"),e.backstoreOnly||this._setCssDimension(r,i);return e.cssOnly||this.renderAll(),this.calcOffset(),this},_setBackstoreDimension:function(t,e){return this.lowerCanvasEl[t]=e,this.upperCanvasEl&&(this.upperCanvasEl[t]=e),this.cacheCanvasEl&&(this.cacheCanvasEl[t]=e),this[t]=e,this},_setCssDimension:function(t,e){return this.lowerCanvasEl.style[t]=e,this.upperCanvasEl&&(this.upperCanvasEl.style[t]=e),this.wrapperEl&&(this.wrapperEl.style[t]=e),this},getZoom:function(){return Math.sqrt(this.viewportTransform[0]*this.viewportTransform[3])},setViewportTransform:function(t){var e=this.getActiveGroup();this.viewportTransform=t,this.renderAll();for(var i=0,r=this._objects.length;r>i;i++)this._objects[i].setCoords();return e&&e.setCoords(),this},zoomToPoint:function(t,e){var i=t;t=fabric.util.transformPoint(t,fabric.util.invertTransform(this.viewportTransform)),this.viewportTransform[0]=e,this.viewportTransform[3]=e;var r=fabric.util.transformPoint(t,this.viewportTransform);this.viewportTransform[4]+=i.x-r.x,this.viewportTransform[5]+=i.y-r.y,this.renderAll();for(var s=0,n=this._objects.length;n>s;s++)this._objects[s].setCoords();return this},setZoom:function(t){return this.zoomToPoint(new fabric.Point(0,0),t),this},absolutePan:function(t){this.viewportTransform[4]=-t.x,this.viewportTransform[5]=-t.y,this.renderAll();for(var e=0,i=this._objects.length;i>e;e++)this._objects[e].setCoords();return this},relativePan:function(t){return this.absolutePan(new fabric.Point(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},getActiveObject:function(){return null},getActiveGroup:function(){return null},_draw:function(t,e){if(e){t.save();var i=this.viewportTransform;t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this._shouldRenderObject(e)&&e.render(t),t.restore(),this.controlsAboveOverlay||e._renderControls(t)}},_shouldRenderObject:function(t){return t?t!==this.getActiveGroup()||!this.preserveObjectStacking:!1},_onObjectAdded:function(t){this.stateful&&t.setupState(),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added")},_onObjectRemoved:function(t){this.getActiveObject()===t&&(this.fire("before:selection:cleared",{target:t}),this._discardActiveObject(),this.fire("selection:cleared")),this.fire("object:removed",{target:t}),t.fire("removed")},clearContext:function(t){return t.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this._objects.length=0,this.discardActiveGroup&&this.discardActiveGroup(),this.discardActiveObject&&this.discardActiveObject(),this.clearContext(this.contextContainer),this.contextTop&&this.clearContext(this.contextTop),this.fire("canvas:cleared"),this.renderAll(),this},renderAll:function(t){var e=this[t===!0&&this.interactive?"contextTop":"contextContainer"],i=this.getActiveGroup();return this.contextTop&&this.selection&&!this._groupSelector&&this.clearContext(this.contextTop),t||this.clearContext(e),this.fire("before:render"),this.clipTo&&fabric.util.clipContext(this,e),this._renderBackground(e),this._renderObjects(e,i),this._renderActiveGroup(e,i),this.clipTo&&e.restore(),this._renderOverlay(e),this.controlsAboveOverlay&&this.interactive&&this.drawControls(e),this.fire("after:render"),this},_renderObjects:function(t,e){var i,r;if(!e||this.preserveObjectStacking)for(i=0,r=this._objects.length;r>i;++i)this._draw(t,this._objects[i]);else for(i=0,r=this._objects.length;r>i;++i)this._objects[i]&&!e.contains(this._objects[i])&&this._draw(t,this._objects[i])},_renderActiveGroup:function(t,e){if(e){var i=[];this.forEachObject(function(t){e.contains(t)&&i.push(t)}),e._set("_objects",i.reverse()),this._draw(t,e)}},_renderBackground:function(t){this.backgroundColor&&(t.fillStyle=this.backgroundColor.toLive?this.backgroundColor.toLive(t):this.backgroundColor,t.fillRect(this.backgroundColor.offsetX||0,this.backgroundColor.offsetY||0,this.width,this.height)),this.backgroundImage&&this._draw(t,this.backgroundImage)},_renderOverlay:function(t){this.overlayColor&&(t.fillStyle=this.overlayColor.toLive?this.overlayColor.toLive(t):this.overlayColor,t.fillRect(this.overlayColor.offsetX||0,this.overlayColor.offsetY||0,this.width,this.height)),this.overlayImage&&this._draw(t,this.overlayImage)},renderTop:function(){var t=this.contextTop||this.contextContainer;this.clearContext(t),this.selection&&this._groupSelector&&this._drawSelection();var e=this.getActiveGroup();return e&&e.render(t),this._renderOverlay(t),this.fire("after:render"),this},getCenter:function(){return{top:this.getHeight()/2,left:this.getWidth()/2}},centerObjectH:function(t){return this._centerObject(t,new fabric.Point(this.getCenter().left,t.getCenterPoint().y)),this.renderAll(),this},centerObjectV:function(t){return this._centerObject(t,new fabric.Point(t.getCenterPoint().x,this.getCenter().top)),this.renderAll(),this},centerObject:function(t){var e=this.getCenter();return this._centerObject(t,new fabric.Point(e.left,e.top)),this.renderAll(),this},_centerObject:function(t,e){return t.setPositionByOrigin(e,"center","center"),this},toDatalessJSON:function(t){return this.toDatalessObject(t)},toObject:function(t){return this._toObjectMethod("toObject",t)},toDatalessObject:function(t){return this._toObjectMethod("toDatalessObject",t)},_toObjectMethod:function(e,i){var r={objects:this._toObjects(e,i)};return t(r,this.__serializeBgOverlay()),fabric.util.populateWithProperties(this,r,i),r},_toObjects:function(t,e){return this.getObjects().map(function(i){return this._toObject(i,t,e)},this)},_toObject:function(t,e,i){var r;this.includeDefaultValues||(r=t.includeDefaultValues,t.includeDefaultValues=!1);var s=this._realizeGroupTransformOnObject(t),n=t[e](i);return this.includeDefaultValues||(t.includeDefaultValues=r),this._unwindGroupTransformOnObject(t,s),n},_realizeGroupTransformOnObject:function(t){var e=["angle","flipX","flipY","height","left","scaleX","scaleY","top","width"];if(t.group&&t.group===this.getActiveGroup()){var i={};return e.forEach(function(e){i[e]=t[e]}),this.getActiveGroup().realizeTransform(t),i}return null},_unwindGroupTransformOnObject:function(t,e){e&&t.set(e)},__serializeBgOverlay:function(){var t={background:this.backgroundColor&&this.backgroundColor.toObject?this.backgroundColor.toObject():this.backgroundColor};return this.overlayColor&&(t.overlay=this.overlayColor.toObject?this.overlayColor.toObject():this.overlayColor),this.backgroundImage&&(t.backgroundImage=this.backgroundImage.toObject()),this.overlayImage&&(t.overlayImage=this.overlayImage.toObject()),t},svgViewportTransformation:!0,toSVG:function(t,e){t||(t={});var i=[];return this._setSVGPreamble(i,t),this._setSVGHeader(i,t),this._setSVGBgOverlayColor(i,"backgroundColor"),this._setSVGBgOverlayImage(i,"backgroundImage"),this._setSVGObjects(i,e),this._setSVGBgOverlayColor(i,"overlayColor"),this._setSVGBgOverlayImage(i,"overlayImage"),i.push("</svg>"),i.join("")},_setSVGPreamble:function(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",'" standalone="no" ?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(t,e){var i,r,s;e.viewBox?(i=e.viewBox.width,r=e.viewBox.height):(i=this.width,r=this.height,this.svgViewportTransformation||(s=this.viewportTransform,i/=s[0],r/=s[3])),t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',i,'" ','height="',r,'" ',this.backgroundColor&&!this.backgroundColor.toLive?'style="background-color: '+this.backgroundColor+'" ':null,e.viewBox?'viewBox="'+e.viewBox.x+" "+e.viewBox.y+" "+e.viewBox.width+" "+e.viewBox.height+'" ':null,'xml:space="preserve">',"<desc>Created with Fabric.js ",fabric.version,"</desc>","<defs>",fabric.createSVGFontFacesMarkup(this.getObjects()),fabric.createSVGRefElementsMarkup(this),"</defs>");

},_setSVGObjects:function(t,e){for(var i=0,r=this.getObjects(),s=r.length;s>i;i++){var n=r[i],o=this._realizeGroupTransformOnObject(n);t.push(n.toSVG(e)),this._unwindGroupTransformOnObject(n,o)}},_setSVGBgOverlayImage:function(t,e){this[e]&&this[e].toSVG&&t.push(this[e].toSVG())},_setSVGBgOverlayColor:function(t,e){this[e]&&this[e].source?t.push('<rect x="',this[e].offsetX,'" y="',this[e].offsetY,'" ','width="',"repeat-y"===this[e].repeat||"no-repeat"===this[e].repeat?this[e].source.width:this.width,'" height="',"repeat-x"===this[e].repeat||"no-repeat"===this[e].repeat?this[e].source.height:this.height,'" fill="url(#'+e+'Pattern)"',"></rect>"):this[e]&&"overlayColor"===e&&t.push('<rect x="0" y="0" ','width="',this.width,'" height="',this.height,'" fill="',this[e],'"',"></rect>")},sendToBack:function(t){return i(this._objects,t),this._objects.unshift(t),this.renderAll&&this.renderAll()},bringToFront:function(t){return i(this._objects,t),this._objects.push(t),this.renderAll&&this.renderAll()},sendBackwards:function(t,e){var r=this._objects.indexOf(t);if(0!==r){var s=this._findNewLowerIndex(t,r,e);i(this._objects,t),this._objects.splice(s,0,t),this.renderAll&&this.renderAll()}return this},_findNewLowerIndex:function(t,e,i){var r;if(i){r=e;for(var s=e-1;s>=0;--s){var n=t.intersectsWithObject(this._objects[s])||t.isContainedWithinObject(this._objects[s])||this._objects[s].isContainedWithinObject(t);if(n){r=s;break}}}else r=e-1;return r},bringForward:function(t,e){var r=this._objects.indexOf(t);if(r!==this._objects.length-1){var s=this._findNewUpperIndex(t,r,e);i(this._objects,t),this._objects.splice(s,0,t),this.renderAll&&this.renderAll()}return this},_findNewUpperIndex:function(t,e,i){var r;if(i){r=e;for(var s=e+1;s<this._objects.length;++s){var n=t.intersectsWithObject(this._objects[s])||t.isContainedWithinObject(this._objects[s])||this._objects[s].isContainedWithinObject(t);if(n){r=s;break}}}else r=e+1;return r},moveTo:function(t,e){return i(this._objects,t),this._objects.splice(e,0,t),this.renderAll&&this.renderAll()},dispose:function(){return this.clear(),this.interactive&&this.removeListeners(),this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this.getObjects().length+" }>"}}),t(fabric.StaticCanvas.prototype,fabric.Observable),t(fabric.StaticCanvas.prototype,fabric.Collection),t(fabric.StaticCanvas.prototype,fabric.DataURLExporter),t(fabric.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(t){var e=fabric.util.createCanvasElement();if(!e||!e.getContext)return null;var i=e.getContext("2d");if(!i)return null;switch(t){case"getImageData":return"undefined"!=typeof i.getImageData;case"setLineDash":return"undefined"!=typeof i.setLineDash;case"toDataURL":return"undefined"!=typeof e.toDataURL;case"toDataURLWithQuality":try{return e.toDataURL("image/jpeg",0),!0}catch(r){}return!1;default:return null}}}),fabric.StaticCanvas.prototype.toJSON=fabric.StaticCanvas.prototype.toObject}(),fabric.BaseBrush=fabric.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeDashArray:null,setShadow:function(t){return this.shadow=new fabric.Shadow(t),this},_setBrushStyles:function(){var t=this.canvas.contextTop;t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.lineJoin=this.strokeLineJoin,this.strokeDashArray&&fabric.StaticCanvas.supports("setLineDash")&&t.setLineDash(this.strokeDashArray)},_setShadow:function(){if(this.shadow){var t=this.canvas.contextTop;t.shadowColor=this.shadow.color,t.shadowBlur=this.shadow.blur,t.shadowOffsetX=this.shadow.offsetX,t.shadowOffsetY=this.shadow.offsetY}},_resetShadow:function(){var t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0}}),function(){fabric.PencilBrush=fabric.util.createClass(fabric.BaseBrush,{initialize:function(t){this.canvas=t,this._points=[]},onMouseDown:function(t){this._prepareForDrawing(t),this._captureDrawingPath(t),this._render()},onMouseMove:function(t){this._captureDrawingPath(t),this.canvas.clearContext(this.canvas.contextTop),this._render()},onMouseUp:function(){this._finalizeAndAddPath()},_prepareForDrawing:function(t){var e=new fabric.Point(t.x,t.y);this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)},_addPoint:function(t){this._points.push(t)},_reset:function(){this._points.length=0,this._setBrushStyles(),this._setShadow()},_captureDrawingPath:function(t){var e=new fabric.Point(t.x,t.y);this._addPoint(e)},_render:function(){var t=this.canvas.contextTop,e=this.canvas.viewportTransform,i=this._points[0],r=this._points[1];t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t.beginPath(),2===this._points.length&&i.x===r.x&&i.y===r.y&&(i.x-=.5,r.x+=.5),t.moveTo(i.x,i.y);for(var s=1,n=this._points.length;n>s;s++){var o=i.midPointFrom(r);t.quadraticCurveTo(i.x,i.y,o.x,o.y),i=this._points[s],r=this._points[s+1]}t.lineTo(i.x,i.y),t.stroke(),t.restore()},convertPointsToSVGPath:function(t){var e=[],i=new fabric.Point(t[0].x,t[0].y),r=new fabric.Point(t[1].x,t[1].y);e.push("M ",t[0].x," ",t[0].y," ");for(var s=1,n=t.length;n>s;s++){var o=i.midPointFrom(r);e.push("Q ",i.x," ",i.y," ",o.x," ",o.y," "),i=new fabric.Point(t[s].x,t[s].y),s+1<t.length&&(r=new fabric.Point(t[s+1].x,t[s+1].y))}return e.push("L ",i.x," ",i.y," "),e},createPath:function(t){var e=new fabric.Path(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray,originX:"center",originY:"center"});return this.shadow&&(this.shadow.affectStroke=!0,e.setShadow(this.shadow)),e},_finalizeAndAddPath:function(){var t=this.canvas.contextTop;t.closePath();var e=this.convertPointsToSVGPath(this._points).join("");if("M 0 0 Q 0 0 0 0 L 0 0"===e)return void this.canvas.renderAll();var i=this.createPath(e);this.canvas.add(i),i.setCoords(),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderAll(),this.canvas.fire("path:created",{path:i})}})}(),fabric.CircleBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,initialize:function(t){this.canvas=t,this.points=[]},drawDot:function(t){var e=this.addPoint(t),i=this.canvas.contextTop,r=this.canvas.viewportTransform;i.save(),i.transform(r[0],r[1],r[2],r[3],r[4],r[5]),i.fillStyle=e.fill,i.beginPath(),i.arc(e.x,e.y,e.radius,0,2*Math.PI,!1),i.closePath(),i.fill(),i.restore()},onMouseDown:function(t){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(t)},onMouseMove:function(t){this.drawDot(t)},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],i=0,r=this.points.length;r>i;i++){var s=this.points[i],n=new fabric.Circle({radius:s.radius,left:s.x,top:s.y,originX:"center",originY:"center",fill:s.fill});this.shadow&&n.setShadow(this.shadow),e.push(n)}var o=new fabric.Group(e,{originX:"center",originY:"center"});o.canvas=this.canvas,this.canvas.add(o),this.canvas.fire("path:created",{path:o}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.renderAll()},addPoint:function(t){var e=new fabric.Point(t.x,t.y),i=fabric.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,r=new fabric.Color(this.color).setAlpha(fabric.util.getRandomInt(0,100)/100).toRgba();return e.radius=i,e.fill=r,this.points.push(e),e}}),fabric.SprayBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(t){this.canvas=t,this.sprayChunks=[]},onMouseDown:function(t){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(t),this.render()},onMouseMove:function(t){this.addSprayChunk(t),this.render()},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],i=0,r=this.sprayChunks.length;r>i;i++)for(var s=this.sprayChunks[i],n=0,o=s.length;o>n;n++){var a=new fabric.Rect({width:s[n].width,height:s[n].width,left:s[n].x+1,top:s[n].y+1,originX:"center",originY:"center",fill:this.color});this.shadow&&a.setShadow(this.shadow),e.push(a)}this.optimizeOverlapping&&(e=this._getOptimizedRects(e));var h=new fabric.Group(e,{originX:"center",originY:"center"});h.canvas=this.canvas,this.canvas.add(h),this.canvas.fire("path:created",{path:h}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.renderAll()},_getOptimizedRects:function(t){for(var e,i={},r=0,s=t.length;s>r;r++)e=t[r].left+""+t[r].top,i[e]||(i[e]=t[r]);var n=[];for(e in i)n.push(i[e]);return n},render:function(){var t=this.canvas.contextTop;t.fillStyle=this.color;var e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5]);for(var i=0,r=this.sprayChunkPoints.length;r>i;i++){var s=this.sprayChunkPoints[i];"undefined"!=typeof s.opacity&&(t.globalAlpha=s.opacity),t.fillRect(s.x,s.y,s.width,s.width)}t.restore()},addSprayChunk:function(t){this.sprayChunkPoints=[];for(var e,i,r,s=this.width/2,n=0;n<this.density;n++){e=fabric.util.getRandomInt(t.x-s,t.x+s),i=fabric.util.getRandomInt(t.y-s,t.y+s),r=this.dotWidthVariance?fabric.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var o=new fabric.Point(e,i);o.width=r,this.randomOpacity&&(o.opacity=fabric.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(o)}this.sprayChunks.push(this.sprayChunkPoints)}}),fabric.PatternBrush=fabric.util.createClass(fabric.PencilBrush,{getPatternSrc:function(){var t=20,e=5,i=fabric.document.createElement("canvas"),r=i.getContext("2d");return i.width=i.height=t+e,r.fillStyle=this.color,r.beginPath(),r.arc(t/2,t/2,t/2,0,2*Math.PI,!1),r.closePath(),r.fill(),i},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(){return this.canvas.contextTop.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(){this.callSuper("_setBrushStyles"),this.canvas.contextTop.strokeStyle=this.getPattern()},createPath:function(t){var e=this.callSuper("createPath",t);return e.stroke=new fabric.Pattern({source:this.source||this.getPatternSrcFunction()}),e}}),function(){var t=fabric.util.getPointer,e=fabric.util.degreesToRadians,i=fabric.util.radiansToDegrees,r=Math.atan2,s=Math.abs,n=.5;fabric.Canvas=fabric.util.createClass(fabric.StaticCanvas,{initialize:function(t,e){e||(e={}),this._initStatic(t,e),this._initInteractive(),this._createCacheCanvas(),fabric.Canvas.activeInstance=this},uniScaleTransform:!1,centeredScaling:!1,centeredRotation:!1,interactive:!0,selection:!0,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this.freeDrawingBrush=fabric.PencilBrush&&new fabric.PencilBrush(this),this.calcOffset()},_resetCurrentTransform:function(t){var e=this._currentTransform;e.target.set({scaleX:e.original.scaleX,scaleY:e.original.scaleY,left:e.original.left,top:e.original.top}),this._shouldCenterTransform(t,e.target)?"rotate"===e.action?this._setOriginToCenter(e.target):("center"!==e.originX&&("right"===e.originX?e.mouseXSign=-1:e.mouseXSign=1),"center"!==e.originY&&("bottom"===e.originY?e.mouseYSign=-1:e.mouseYSign=1),e.originX="center",e.originY="center"):(e.originX=e.original.originX,e.originY=e.original.originY)},containsPoint:function(t,e){var i=this.getPointer(t,!0),r=this._normalizePointer(e,i);return e.containsPoint(r)||e._findTargetCorner(i)},_normalizePointer:function(t,e){var i,r=this.getActiveGroup(),s=e.x,n=e.y,o=r&&"group"!==t.type&&r.contains(t);return o&&(i=new fabric.Point(r.left,r.top),i=fabric.util.transformPoint(i,this.viewportTransform,!0),s-=i.x,n-=i.y),{x:s,y:n}},isTargetTransparent:function(t,e,i){var r=t.hasBorders,s=t.transparentCorners;t.hasBorders=t.transparentCorners=!1,this._draw(this.contextCache,t),t.hasBorders=r,t.transparentCorners=s;var n=fabric.util.isTransparent(this.contextCache,e,i,this.targetFindTolerance);return this.clearContext(this.contextCache),n},_shouldClearSelection:function(t,e){var i=this.getActiveGroup(),r=this.getActiveObject();return!e||e&&i&&!i.contains(e)&&i!==e&&!t.shiftKey||e&&!e.evented||e&&!e.selectable&&r&&r!==e},_shouldCenterTransform:function(t,e){if(e){var i,r=this._currentTransform;return"scale"===r.action||"scaleX"===r.action||"scaleY"===r.action?i=this.centeredScaling||e.centeredScaling:"rotate"===r.action&&(i=this.centeredRotation||e.centeredRotation),i?!t.altKey:t.altKey}},_getOriginFromCorner:function(t,e){var i={x:t.originX,y:t.originY};return"ml"===e||"tl"===e||"bl"===e?i.x="right":("mr"===e||"tr"===e||"br"===e)&&(i.x="left"),"tl"===e||"mt"===e||"tr"===e?i.y="bottom":("bl"===e||"mb"===e||"br"===e)&&(i.y="top"),i},_getActionFromCorner:function(t,e){var i="drag";return e&&(i="ml"===e||"mr"===e?"scaleX":"mt"===e||"mb"===e?"scaleY":"mtr"===e?"rotate":"scale"),i},_setupCurrentTransform:function(t,i){if(i){var r=this.getPointer(t),s=i._findTargetCorner(this.getPointer(t,!0)),n=this._getActionFromCorner(i,s),o=this._getOriginFromCorner(i,s);this._currentTransform={target:i,action:n,scaleX:i.scaleX,scaleY:i.scaleY,offsetX:r.x-i.left,offsetY:r.y-i.top,originX:o.x,originY:o.y,ex:r.x,ey:r.y,left:i.left,top:i.top,theta:e(i.angle),width:i.width*i.scaleX,mouseXSign:1,mouseYSign:1},this._currentTransform.original={left:i.left,top:i.top,scaleX:i.scaleX,scaleY:i.scaleY,originX:o.x,originY:o.y},this._resetCurrentTransform(t)}},_translateObject:function(t,e){var i=this._currentTransform.target;i.get("lockMovementX")||i.set("left",t-this._currentTransform.offsetX),i.get("lockMovementY")||i.set("top",e-this._currentTransform.offsetY)},_scaleObject:function(t,e,i){var r=this._currentTransform,s=r.target,n=s.get("lockScalingX"),o=s.get("lockScalingY"),a=s.get("lockScalingFlip");if(!n||!o){var h=s.translateToOriginPoint(s.getCenterPoint(),r.originX,r.originY),c=s.toLocalPoint(new fabric.Point(t,e),r.originX,r.originY);this._setLocalMouse(c,r),this._setObjectScale(c,r,n,o,i,a),s.setPositionByOrigin(h,r.originX,r.originY)}},_setObjectScale:function(t,e,i,r,s,n){var o=e.target,a=!1,h=!1,c="line"===o.type&&0===o.width,l="line"===o.type&&0===o.height,u=l?0:o.strokeWidth,f=c?0:o.strokeWidth;e.newScaleX=t.x/(o.width+u),e.newScaleY=t.y/(o.height+f),n&&e.newScaleX<=0&&e.newScaleX<o.scaleX&&(a=!0),n&&e.newScaleY<=0&&e.newScaleY<o.scaleY&&(h=!0),"equally"!==s||i||r?s?"x"!==s||o.get("lockUniScaling")?"y"!==s||o.get("lockUniScaling")||h||r||o.set("scaleY",e.newScaleY):a||i||o.set("scaleX",e.newScaleX):(a||i||o.set("scaleX",e.newScaleX),h||r||o.set("scaleY",e.newScaleY)):a||h||this._scaleObjectEqually(t,o,e),a||h||this._flipObject(e,s)},_scaleObjectEqually:function(t,e,i){var r=t.y+t.x,s="line"===e.type&&0===e.width,n="line"===e.type&&0===e.height,o=n?0:e.strokeWidth,a=s?0:e.strokeWidth,h=(e.height+a)*i.original.scaleY+(e.width+o)*i.original.scaleX;i.newScaleX=i.original.scaleX*r/h,i.newScaleY=i.original.scaleY*r/h,e.set("scaleX",i.newScaleX),e.set("scaleY",i.newScaleY)},_flipObject:function(t,e){t.newScaleX<0&&"y"!==e&&("left"===t.originX?t.originX="right":"right"===t.originX&&(t.originX="left")),t.newScaleY<0&&"x"!==e&&("top"===t.originY?t.originY="bottom":"bottom"===t.originY&&(t.originY="top"))},_setLocalMouse:function(t,e){var i=e.target;"right"===e.originX?t.x*=-1:"center"===e.originX&&(t.x*=2*e.mouseXSign,t.x<0&&(e.mouseXSign=-e.mouseXSign)),"bottom"===e.originY?t.y*=-1:"center"===e.originY&&(t.y*=2*e.mouseYSign,t.y<0&&(e.mouseYSign=-e.mouseYSign)),s(t.x)>i.padding?t.x<0?t.x+=i.padding:t.x-=i.padding:t.x=0,s(t.y)>i.padding?t.y<0?t.y+=i.padding:t.y-=i.padding:t.y=0},_rotateObject:function(t,e){var s=this._currentTransform;if(!s.target.get("lockRotation")){var n=r(s.ey-s.top,s.ex-s.left),o=r(e-s.top,t-s.left),a=i(o-n+s.theta);0>a&&(a=360+a),s.target.angle=a%360}},setCursor:function(t){this.upperCanvasEl.style.cursor=t},_resetObjectTransform:function(t){t.scaleX=1,t.scaleY=1,t.setAngle(0)},_drawSelection:function(){var t=this.contextTop,e=this._groupSelector,i=e.left,r=e.top,o=s(i),a=s(r);if(t.fillStyle=this.selectionColor,t.fillRect(e.ex-(i>0?0:-i),e.ey-(r>0?0:-r),o,a),t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,this.selectionDashArray.length>1){var h=e.ex+n-(i>0?0:o),c=e.ey+n-(r>0?0:a);t.beginPath(),fabric.util.drawDashedLine(t,h,c,h+o,c,this.selectionDashArray),fabric.util.drawDashedLine(t,h,c+a-1,h+o,c+a-1,this.selectionDashArray),fabric.util.drawDashedLine(t,h,c,h,c+a,this.selectionDashArray),fabric.util.drawDashedLine(t,h+o-1,c,h+o-1,c+a,this.selectionDashArray),t.closePath(),t.stroke()}else t.strokeRect(e.ex+n-(i>0?0:o),e.ey+n-(r>0?0:a),o,a)},_isLastRenderedObject:function(t){return this.controlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay.visible&&this.containsPoint(t,this.lastRenderedObjectWithControlsAboveOverlay)&&this.lastRenderedObjectWithControlsAboveOverlay._findTargetCorner(this.getPointer(t,!0))},findTarget:function(t,e){if(!this.skipTargetFind){if(this._isLastRenderedObject(t))return this.lastRenderedObjectWithControlsAboveOverlay;var i=this.getActiveGroup();if(i&&!e&&this.containsPoint(t,i))return i;var r=this._searchPossibleTargets(t);return this._fireOverOutEvents(r,t),r}},_fireOverOutEvents:function(t,e){t?this._hoveredTarget!==t&&(this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget,e:e}),this._hoveredTarget.fire("mouseout")),this.fire("mouse:over",{target:t,e:e}),t.fire("mouseover"),this._hoveredTarget=t):this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget,e:e}),this._hoveredTarget.fire("mouseout"),this._hoveredTarget=null)},_checkTarget:function(t,e,i){if(e&&e.visible&&e.evented&&this.containsPoint(t,e)){if(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing)return!0;var r=this.isTargetTransparent(e,i.x,i.y);if(!r)return!0}},_searchPossibleTargets:function(t){for(var e,i=this.getPointer(t,!0),r=this._objects.length;r--;)if(!this._objects[r].group&&this._checkTarget(t,this._objects[r],i)){this.relatedTarget=this._objects[r],e=this._objects[r];break}return e},getPointer:function(e,i,r){r||(r=this.upperCanvasEl);var s,n=t(e,r),o=r.getBoundingClientRect(),a=o.width||0,h=o.height||0;return a&&h||("top"in o&&"bottom"in o&&(h=Math.abs(o.top-o.bottom)),"right"in o&&"left"in o&&(a=Math.abs(o.right-o.left))),this.calcOffset(),n.x=n.x-this._offset.left,n.y=n.y-this._offset.top,i||(n=fabric.util.transformPoint(n,fabric.util.invertTransform(this.viewportTransform))),s=0===a||0===h?{width:1,height:1}:{width:r.width/a,height:r.height/h},{x:n.x*s.width,y:n.y*s.height}},_createUpperCanvas:function(){var t=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,"");this.upperCanvasEl=this._createCanvasElement(),fabric.util.addClass(this.upperCanvasEl,"upper-canvas "+t),this.wrapperEl.appendChild(this.upperCanvasEl),this._copyCanvasStyle(this.lowerCanvasEl,this.upperCanvasEl),this._applyCanvasStyle(this.upperCanvasEl),this.contextTop=this.upperCanvasEl.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=fabric.util.wrapElement(this.lowerCanvasEl,"div",{"class":this.containerClass}),fabric.util.setStyle(this.wrapperEl,{width:this.getWidth()+"px",height:this.getHeight()+"px",position:"relative"}),fabric.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(t){var e=this.getWidth()||t.width,i=this.getHeight()||t.height;fabric.util.setStyle(t,{position:"absolute",width:e+"px",height:i+"px",left:0,top:0}),t.width=e,t.height=i,fabric.util.makeElementUnselectable(t)},_copyCanvasStyle:function(t,e){e.style.cssText=t.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},_setActiveObject:function(t){this._activeObject&&this._activeObject.set("active",!1),this._activeObject=t,t.set("active",!0)},setActiveObject:function(t,e){return this._setActiveObject(t),this.renderAll(),this.fire("object:selected",{target:t,e:e}),t.fire("selected",{e:e}),this},getActiveObject:function(){return this._activeObject},_discardActiveObject:function(){this._activeObject&&this._activeObject.set("active",!1),this._activeObject=null},discardActiveObject:function(t){return this._discardActiveObject(),this.renderAll(),this.fire("selection:cleared",{e:t}),this},_setActiveGroup:function(t){this._activeGroup=t,t&&t.set("active",!0)},setActiveGroup:function(t,e){return this._setActiveGroup(t),t&&(this.fire("object:selected",{target:t,e:e}),t.fire("selected",{e:e})),this},getActiveGroup:function(){return this._activeGroup},_discardActiveGroup:function(){var t=this.getActiveGroup();t&&t.destroy(),this.setActiveGroup(null)},discardActiveGroup:function(t){return this._discardActiveGroup(),this.fire("selection:cleared",{e:t}),this},deactivateAll:function(){for(var t=this.getObjects(),e=0,i=t.length;i>e;e++)t[e].set("active",!1);return this._discardActiveGroup(),this._discardActiveObject(),this},deactivateAllWithDispatch:function(t){var e=this.getActiveGroup()||this.getActiveObject();return e&&this.fire("before:selection:cleared",{target:e,e:t}),this.deactivateAll(),e&&this.fire("selection:cleared",{e:t}),this},drawControls:function(t){var e=this.getActiveGroup();e?this._drawGroupControls(t,e):this._drawObjectsControls(t)},_drawGroupControls:function(t,e){e._renderControls(t)},_drawObjectsControls:function(t){for(var e=0,i=this._objects.length;i>e;++e)this._objects[e]&&this._objects[e].active&&(this._objects[e]._renderControls(t),this.lastRenderedObjectWithControlsAboveOverlay=this._objects[e])}});for(var o in fabric.StaticCanvas)"prototype"!==o&&(fabric.Canvas[o]=fabric.StaticCanvas[o]);fabric.isTouchSupported&&(fabric.Canvas.prototype._setCursorFromEvent=function(){}),fabric.Element=fabric.Canvas}(),function(){var t={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7},e=fabric.util.addListener,i=fabric.util.removeListener;fabric.util.object.extend(fabric.Canvas.prototype,{cursorMap:["n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize"],_initEventListeners:function(){this._bindEvents(),e(fabric.window,"resize",this._onResize),e(this.upperCanvasEl,"mousedown",this._onMouseDown),e(this.upperCanvasEl,"mousemove",this._onMouseMove),e(this.upperCanvasEl,"mousewheel",this._onMouseWheel),e(this.upperCanvasEl,"touchstart",this._onMouseDown),e(this.upperCanvasEl,"touchmove",this._onMouseMove),"undefined"!=typeof eventjs&&"add"in eventjs&&(eventjs.add(this.upperCanvasEl,"gesture",this._onGesture),eventjs.add(this.upperCanvasEl,"drag",this._onDrag),eventjs.add(this.upperCanvasEl,"orientation",this._onOrientationChange),eventjs.add(this.upperCanvasEl,"shake",this._onShake),eventjs.add(this.upperCanvasEl,"longpress",this._onLongPress))},_bindEvents:function(){this._onMouseDown=this._onMouseDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this)},removeListeners:function(){i(fabric.window,"resize",this._onResize),i(this.upperCanvasEl,"mousedown",this._onMouseDown),i(this.upperCanvasEl,"mousemove",this._onMouseMove),i(this.upperCanvasEl,"mousewheel",this._onMouseWheel),i(this.upperCanvasEl,"touchstart",this._onMouseDown),i(this.upperCanvasEl,"touchmove",this._onMouseMove),"undefined"!=typeof eventjs&&"remove"in eventjs&&(eventjs.remove(this.upperCanvasEl,"gesture",this._onGesture),eventjs.remove(this.upperCanvasEl,"drag",this._onDrag),eventjs.remove(this.upperCanvasEl,"orientation",this._onOrientationChange),eventjs.remove(this.upperCanvasEl,"shake",this._onShake),eventjs.remove(this.upperCanvasEl,"longpress",this._onLongPress))},_onGesture:function(t,e){this.__onTransformGesture&&this.__onTransformGesture(t,e)},_onDrag:function(t,e){this.__onDrag&&this.__onDrag(t,e)},_onMouseWheel:function(t,e){this.__onMouseWheel&&this.__onMouseWheel(t,e)},_onOrientationChange:function(t,e){this.__onOrientationChange&&this.__onOrientationChange(t,e)},_onShake:function(t,e){this.__onShake&&this.__onShake(t,e)},_onLongPress:function(t,e){this.__onLongPress&&this.__onLongPress(t,e)},_onMouseDown:function(t){this.__onMouseDown(t),e(fabric.document,"touchend",this._onMouseUp),e(fabric.document,"touchmove",this._onMouseMove),i(this.upperCanvasEl,"mousemove",this._onMouseMove),i(this.upperCanvasEl,"touchmove",this._onMouseMove),"touchstart"===t.type?i(this.upperCanvasEl,"mousedown",this._onMouseDown):(e(fabric.document,"mouseup",this._onMouseUp),e(fabric.document,"mousemove",this._onMouseMove))},_onMouseUp:function(t){if(this.__onMouseUp(t),i(fabric.document,"mouseup",this._onMouseUp),i(fabric.document,"touchend",this._onMouseUp),i(fabric.document,"mousemove",this._onMouseMove),i(fabric.document,"touchmove",this._onMouseMove),e(this.upperCanvasEl,"mousemove",this._onMouseMove),e(this.upperCanvasEl,"touchmove",this._onMouseMove),"touchend"===t.type){var r=this;setTimeout(function(){e(r.upperCanvasEl,"mousedown",r._onMouseDown)},400)}},_onMouseMove:function(t){!this.allowTouchScrolling&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)},_onResize:function(){this.calcOffset()},_shouldRender:function(t,e){var i=this.getActiveGroup()||this.getActiveObject();return!!(t&&(t.isMoving||t!==i)||!t&&i||!t&&!i&&!this._groupSelector||e&&this._previousPointer&&this.selection&&(e.x!==this._previousPointer.x||e.y!==this._previousPointer.y))},__onMouseUp:function(t){var e;if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(t);this._currentTransform?(this._finalizeCurrentTransform(),e=this._currentTransform.target):e=this.findTarget(t,!0);var i=this._shouldRender(e,this.getPointer(t));this._maybeGroupObjects(t),e&&(e.isMoving=!1),i&&this.renderAll(),this._handleCursorAndEvent(t,e)},_handleCursorAndEvent:function(t,e){this._setCursorFromEvent(t,e);var i=this;setTimeout(function(){i._setCursorFromEvent(t,e)},50),this.fire("mouse:up",{target:e,e:t}),e&&e.fire("mouseup",{e:t})},_finalizeCurrentTransform:function(){var t=this._currentTransform,e=t.target;e._scaling&&(e._scaling=!1),e.setCoords(),this.stateful&&e.hasStateChanged()&&(this.fire("object:modified",{target:e}),e.fire("modified")),this._restoreOriginXY(e)},_restoreOriginXY:function(t){if(this._previousOriginX&&this._previousOriginY){var e=t.translateToOriginPoint(t.getCenterPoint(),this._previousOriginX,this._previousOriginY);t.originX=this._previousOriginX,t.originY=this._previousOriginY,t.left=e.x,t.top=e.y,this._previousOriginX=null,this._previousOriginY=null}},_onMouseDownInDrawingMode:function(t){this._isCurrentlyDrawing=!0,this.discardActiveObject(t).renderAll(),this.clipTo&&fabric.util.clipContext(this,this.contextTop);var e=fabric.util.invertTransform(this.viewportTransform),i=fabric.util.transformPoint(this.getPointer(t,!0),e);this.freeDrawingBrush.onMouseDown(i),this.fire("mouse:down",{e:t});var r=this.findTarget(t);"undefined"!=typeof r&&r.fire("mousedown",{e:t,target:r})},_onMouseMoveInDrawingMode:function(t){if(this._isCurrentlyDrawing){var e=fabric.util.invertTransform(this.viewportTransform),i=fabric.util.transformPoint(this.getPointer(t,!0),e);this.freeDrawingBrush.onMouseMove(i)}this.setCursor(this.freeDrawingCursor),this.fire("mouse:move",{e:t});var r=this.findTarget(t);"undefined"!=typeof r&&r.fire("mousemove",{e:t,target:r})},_onMouseUpInDrawingMode:function(t){this._isCurrentlyDrawing=!1,this.clipTo&&this.contextTop.restore(),this.freeDrawingBrush.onMouseUp(),this.fire("mouse:up",{e:t});var e=this.findTarget(t);"undefined"!=typeof e&&e.fire("mouseup",{e:t,target:e})},__onMouseDown:function(t){var e="which"in t?1===t.which:1===t.button;if(e||fabric.isTouchSupported){if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(t);if(!this._currentTransform){var i=this.findTarget(t),r=this.getPointer(t,!0);this._previousPointer=r;var s=this._shouldRender(i,r),n=this._shouldGroup(t,i);this._shouldClearSelection(t,i)?this._clearSelection(t,i,r):n&&(this._handleGrouping(t,i),i=this.getActiveGroup()),i&&i.selectable&&!n&&(this._beforeTransform(t,i),this._setupCurrentTransform(t,i)),s&&this.renderAll(),this.fire("mouse:down",{target:i,e:t}),i&&i.fire("mousedown",{e:t})}}},_beforeTransform:function(t,e){this.stateful&&e.saveState(),e._findTargetCorner(this.getPointer(t))&&this.onBeforeScaleRotate(e),e!==this.getActiveGroup()&&e!==this.getActiveObject()&&(this.deactivateAll(),this.setActiveObject(e,t))},_clearSelection:function(t,e,i){this.deactivateAllWithDispatch(t),e&&e.selectable?this.setActiveObject(e,t):this.selection&&(this._groupSelector={ex:i.x,ey:i.y,top:0,left:0})},_setOriginToCenter:function(t){this._previousOriginX=this._currentTransform.target.originX,this._previousOriginY=this._currentTransform.target.originY;var e=t.getCenterPoint();t.originX="center",t.originY="center",t.left=e.x,t.top=e.y,this._currentTransform.left=t.left,this._currentTransform.top=t.top},_setCenterToOrigin:function(t){var e=t.translateToOriginPoint(t.getCenterPoint(),this._previousOriginX,this._previousOriginY);t.originX=this._previousOriginX,t.originY=this._previousOriginY,t.left=e.x,t.top=e.y,this._previousOriginX=null,this._previousOriginY=null},__onMouseMove:function(t){var e,i;if(this.isDrawingMode)return void this._onMouseMoveInDrawingMode(t);if(!("undefined"!=typeof t.touches&&t.touches.length>1)){var r=this._groupSelector;r?(i=this.getPointer(t,!0),r.left=i.x-r.ex,r.top=i.y-r.ey,this.renderTop()):this._currentTransform?this._transformObject(t):(e=this.findTarget(t),!e||e&&!e.selectable?this.setCursor(this.defaultCursor):this._setCursorFromEvent(t,e)),this.fire("mouse:move",{target:e,e:t}),e&&e.fire("mousemove",{e:t})}},_transformObject:function(t){var e=this.getPointer(t),i=this._currentTransform;i.reset=!1,i.target.isMoving=!0,this._beforeScaleTransform(t,i),this._performTransformAction(t,i,e),this.renderAll()},_performTransformAction:function(t,e,i){var r=i.x,s=i.y,n=e.target,o=e.action;"rotate"===o?(this._rotateObject(r,s),this._fire("rotating",n,t)):"scale"===o?(this._onScale(t,e,r,s),this._fire("scaling",n,t)):"scaleX"===o?(this._scaleObject(r,s,"x"),this._fire("scaling",n,t)):"scaleY"===o?(this._scaleObject(r,s,"y"),this._fire("scaling",n,t)):(this._translateObject(r,s),this._fire("moving",n,t),this.setCursor(this.moveCursor))},_fire:function(t,e,i){this.fire("object:"+t,{target:e,e:i}),e.fire(t,{e:i})},_beforeScaleTransform:function(t,e){if("scale"===e.action||"scaleX"===e.action||"scaleY"===e.action){var i=this._shouldCenterTransform(t,e.target);(i&&("center"!==e.originX||"center"!==e.originY)||!i&&"center"===e.originX&&"center"===e.originY)&&(this._resetCurrentTransform(t),e.reset=!0)}},_onScale:function(t,e,i,r){!t.shiftKey&&!this.uniScaleTransform||e.target.get("lockUniScaling")?(e.reset||"scale"!==e.currentAction||this._resetCurrentTransform(t,e.target),e.currentAction="scaleEqually",this._scaleObject(i,r,"equally")):(e.currentAction="scale",this._scaleObject(i,r));

},_setCursorFromEvent:function(t,e){if(!e||!e.selectable)return this.setCursor(this.defaultCursor),!1;var i=this.getActiveGroup(),r=e._findTargetCorner&&(!i||!i.contains(e))&&e._findTargetCorner(this.getPointer(t,!0));return r?this._setCornerCursor(r,e):this.setCursor(e.hoverCursor||this.hoverCursor),!0},_setCornerCursor:function(e,i){if(e in t)this.setCursor(this._getRotatedCornerCursor(e,i));else{if("mtr"!==e||!i.hasRotatingPoint)return this.setCursor(this.defaultCursor),!1;this.setCursor(this.rotationCursor)}},_getRotatedCornerCursor:function(e,i){var r=Math.round(i.getAngle()%360/45);return 0>r&&(r+=8),r+=t[e],r%=8,this.cursorMap[r]}})}(),function(){var t=Math.min,e=Math.max;fabric.util.object.extend(fabric.Canvas.prototype,{_shouldGroup:function(t,e){var i=this.getActiveObject();return t.shiftKey&&(this.getActiveGroup()||i&&i!==e)&&this.selection},_handleGrouping:function(t,e){(e!==this.getActiveGroup()||(e=this.findTarget(t,!0),e&&!e.isType("group")))&&(this.getActiveGroup()?this._updateActiveGroup(e,t):this._createActiveGroup(e,t),this._activeGroup&&this._activeGroup.saveCoords())},_updateActiveGroup:function(t,e){var i=this.getActiveGroup();if(i.contains(t)){if(i.removeWithUpdate(t),this._resetObjectTransform(i),t.set("active",!1),1===i.size())return this.discardActiveGroup(e),void this.setActiveObject(i.item(0))}else i.addWithUpdate(t),this._resetObjectTransform(i);this.fire("selection:created",{target:i,e:e}),i.set("active",!0)},_createActiveGroup:function(t,e){if(this._activeObject&&t!==this._activeObject){var i=this._createGroup(t);i.addWithUpdate(),this.setActiveGroup(i),this._activeObject=null,this.fire("selection:created",{target:i,e:e})}t.set("active",!0)},_createGroup:function(t){var e=this.getObjects(),i=e.indexOf(this._activeObject)<e.indexOf(t),r=i?[this._activeObject,t]:[t,this._activeObject];return new fabric.Group(r,{canvas:this})},_groupSelectedObjects:function(t){var e=this._collectObjects();1===e.length?this.setActiveObject(e[0],t):e.length>1&&(e=new fabric.Group(e.reverse(),{canvas:this}),e.addWithUpdate(),this.setActiveGroup(e,t),e.saveCoords(),this.fire("selection:created",{target:e}),this.renderAll())},_collectObjects:function(){for(var i,r=[],s=this._groupSelector.ex,n=this._groupSelector.ey,o=s+this._groupSelector.left,a=n+this._groupSelector.top,h=new fabric.Point(t(s,o),t(n,a)),c=new fabric.Point(e(s,o),e(n,a)),l=s===o&&n===a,u=this._objects.length;u--&&(i=this._objects[u],!(i&&i.selectable&&i.visible&&(i.intersectsWithRect(h,c)||i.isContainedWithinRect(h,c)||i.containsPoint(h)||i.containsPoint(c))&&(i.set("active",!0),r.push(i),l))););return r},_maybeGroupObjects:function(t){this.selection&&this._groupSelector&&this._groupSelectedObjects(t);var e=this.getActiveGroup();e&&(e.setObjectsCoords().setCoords(),e.isMoving=!1,this.setCursor(this.defaultCursor)),this._groupSelector=null,this._currentTransform=null}})}(),fabric.util.object.extend(fabric.StaticCanvas.prototype,{toDataURL:function(t){t||(t={});var e=t.format||"png",i=t.quality||1,r=t.multiplier||1,s={left:t.left,top:t.top,width:t.width,height:t.height};return 1!==r?this.__toDataURLWithMultiplier(e,i,s,r):this.__toDataURL(e,i,s)},__toDataURL:function(t,e,i){this.renderAll(!0);var r=this.upperCanvasEl||this.lowerCanvasEl,s=this.__getCroppedCanvas(r,i);"jpg"===t&&(t="jpeg");var n=fabric.StaticCanvas.supports("toDataURLWithQuality")?(s||r).toDataURL("image/"+t,e):(s||r).toDataURL("image/"+t);return this.contextTop&&this.clearContext(this.contextTop),this.renderAll(),s&&(s=null),n},__getCroppedCanvas:function(t,e){var i,r,s="left"in e||"top"in e||"width"in e||"height"in e;return s&&(i=fabric.util.createCanvasElement(),r=i.getContext("2d"),i.width=e.width||this.width,i.height=e.height||this.height,r.drawImage(t,-e.left||0,-e.top||0)),i},__toDataURLWithMultiplier:function(t,e,i,r){var s=this.getWidth(),n=this.getHeight(),o=s*r,a=n*r,h=this.getActiveObject(),c=this.getActiveGroup(),l=this.contextTop||this.contextContainer;r>1&&this.setWidth(o).setHeight(a),l.scale(r,r),i.left&&(i.left*=r),i.top&&(i.top*=r),i.width?i.width*=r:1>r&&(i.width=o),i.height?i.height*=r:1>r&&(i.height=a),c?this._tempRemoveBordersControlsFromGroup(c):h&&this.deactivateAll&&this.deactivateAll(),this.renderAll(!0);var u=this.__toDataURL(t,e,i);return this.width=s,this.height=n,l.scale(1/r,1/r),this.setWidth(s).setHeight(n),c?this._restoreBordersControlsOnGroup(c):h&&this.setActiveObject&&this.setActiveObject(h),this.contextTop&&this.clearContext(this.contextTop),this.renderAll(),u},toDataURLWithMultiplier:function(t,e,i){return this.toDataURL({format:t,multiplier:e,quality:i})},_tempRemoveBordersControlsFromGroup:function(t){t.origHasControls=t.hasControls,t.origBorderColor=t.borderColor,t.hasControls=!0,t.borderColor="rgba(0,0,0,0)",t.forEachObject(function(t){t.origBorderColor=t.borderColor,t.borderColor="rgba(0,0,0,0)"})},_restoreBordersControlsOnGroup:function(t){t.hideControls=t.origHideControls,t.borderColor=t.origBorderColor,t.forEachObject(function(t){t.borderColor=t.origBorderColor,delete t.origBorderColor})}}),fabric.util.object.extend(fabric.StaticCanvas.prototype,{loadFromDatalessJSON:function(t,e,i){return this.loadFromJSON(t,e,i)},loadFromJSON:function(t,e,i){if(t){var r="string"==typeof t?JSON.parse(t):t;this.clear();var s=this;return this._enlivenObjects(r.objects,function(){s._setBgOverlay(r,e)},i),this}},_setBgOverlay:function(t,e){var i=this,r={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!(t.backgroundImage||t.overlayImage||t.background||t.overlay))return void(e&&e());var s=function(){r.backgroundImage&&r.overlayImage&&r.backgroundColor&&r.overlayColor&&(i.renderAll(),e&&e())};this.__setBgOverlay("backgroundImage",t.backgroundImage,r,s),this.__setBgOverlay("overlayImage",t.overlayImage,r,s),this.__setBgOverlay("backgroundColor",t.background,r,s),this.__setBgOverlay("overlayColor",t.overlay,r,s),s()},__setBgOverlay:function(t,e,i,r){var s=this;return e?void("backgroundImage"===t||"overlayImage"===t?fabric.Image.fromObject(e,function(e){s[t]=e,i[t]=!0,r&&r()}):this["set"+fabric.util.string.capitalize(t,!0)](e,function(){i[t]=!0,r&&r()})):void(i[t]=!0)},_enlivenObjects:function(t,e,i){var r=this;if(!t||0===t.length)return void(e&&e());var s=this.renderOnAddRemove;this.renderOnAddRemove=!1,fabric.util.enlivenObjects(t,function(t){t.forEach(function(t,e){r.insertAt(t,e,!0)}),r.renderOnAddRemove=s,e&&e()},null,i)},_toDataURL:function(t,e){this.clone(function(i){e(i.toDataURL(t))})},_toDataURLWithMultiplier:function(t,e,i){this.clone(function(r){i(r.toDataURLWithMultiplier(t,e))})},clone:function(t,e){var i=JSON.stringify(this.toJSON(e));this.cloneWithoutData(function(e){e.loadFromJSON(i,function(){t&&t(e)})})},cloneWithoutData:function(t){var e=fabric.document.createElement("canvas");e.width=this.getWidth(),e.height=this.getHeight();var i=new fabric.Canvas(e);i.clipTo=this.clipTo,this.backgroundImage?(i.setBackgroundImage(this.backgroundImage.src,function(){i.renderAll(),t&&t(i)}),i.backgroundImageOpacity=this.backgroundImageOpacity,i.backgroundImageStretch=this.backgroundImageStretch):t&&t(i)}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.toFixed,s=e.util.string.capitalize,n=e.util.degreesToRadians,o=e.StaticCanvas.supports("setLineDash");e.Object||(e.Object=e.util.createClass({type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,cornerSize:12,transparentCorners:!0,hoverCursor:null,padding:0,borderColor:"rgba(102,153,255,0.75)",cornerColor:"rgba(102,153,255,0.5)",centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:10,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,transformMatrix:null,minScaleLimit:.01,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,hasRotatingPoint:!0,rotatingPointOffset:40,perPixelTargetFind:!1,includeDefaultValues:!0,clipTo:null,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockUniScaling:!1,lockScalingFlip:!1,stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeLineJoin strokeMiterLimit angle opacity fill fillRule globalCompositeOperation shadow clipTo visible backgroundColor".split(" "),initialize:function(t){t&&this.setOptions(t)},_initGradient:function(t){!t.fill||!t.fill.colorStops||t.fill instanceof e.Gradient||this.set("fill",new e.Gradient(t.fill)),!t.stroke||!t.stroke.colorStops||t.stroke instanceof e.Gradient||this.set("stroke",new e.Gradient(t.stroke))},_initPattern:function(t){!t.fill||!t.fill.source||t.fill instanceof e.Pattern||this.set("fill",new e.Pattern(t.fill)),!t.stroke||!t.stroke.source||t.stroke instanceof e.Pattern||this.set("stroke",new e.Pattern(t.stroke))},_initClipping:function(t){if(t.clipTo&&"string"==typeof t.clipTo){var i=e.util.getFunctionBody(t.clipTo);"undefined"!=typeof i&&(this.clipTo=new Function("ctx",i))}},setOptions:function(t){for(var e in t)this.set(e,t[e]);this._initGradient(t),this._initPattern(t),this._initClipping(t)},transform:function(t,e){this.group&&this.canvas.preserveObjectStacking&&this.group===this.canvas._activeGroup&&this.group.transform(t);var i=e?this._getLeftTopCoords():this.getCenterPoint();t.translate(i.x,i.y),t.rotate(n(this.angle)),t.scale(this.scaleX*(this.flipX?-1:1),this.scaleY*(this.flipY?-1:1))},toObject:function(t){var i=e.Object.NUM_FRACTION_DIGITS,s={type:this.type,originX:this.originX,originY:this.originY,left:r(this.left,i),top:r(this.top,i),width:r(this.width,i),height:r(this.height,i),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:r(this.strokeWidth,i),strokeDashArray:this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:r(this.strokeMiterLimit,i),scaleX:r(this.scaleX,i),scaleY:r(this.scaleY,i),angle:r(this.getAngle(),i),flipX:this.flipX,flipY:this.flipY,opacity:r(this.opacity,i),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,clipTo:this.clipTo&&String(this.clipTo),backgroundColor:this.backgroundColor,fillRule:this.fillRule,globalCompositeOperation:this.globalCompositeOperation};return this.includeDefaultValues||(s=this._removeDefaultValues(s)),e.util.populateWithProperties(this,s,t),s},toDatalessObject:function(t){return this.toObject(t)},_removeDefaultValues:function(t){var i=e.util.getKlass(t.type).prototype,r=i.stateProperties;return r.forEach(function(e){t[e]===i[e]&&delete t[e]}),t},toString:function(){return"#<fabric."+s(this.type)+">"},get:function(t){return this[t]},_setObject:function(t){for(var e in t)this._set(e,t[e])},set:function(t,e){return"object"==typeof t?this._setObject(t):"function"==typeof e&&"clipTo"!==t?this._set(t,e(this.get(t))):this._set(t,e),this},_set:function(t,i){var s="scaleX"===t||"scaleY"===t;return s&&(i=this._constrainScale(i)),"scaleX"===t&&0>i?(this.flipX=!this.flipX,i*=-1):"scaleY"===t&&0>i?(this.flipY=!this.flipY,i*=-1):"width"===t||"height"===t?this.minScaleLimit=r(Math.min(.1,1/Math.max(this.width,this.height)),2):"shadow"!==t||!i||i instanceof e.Shadow||(i=new e.Shadow(i)),this[t]=i,this},toggle:function(t){var e=this.get(t);return"boolean"==typeof e&&this.set(t,!e),this},setSourcePath:function(t){return this.sourcePath=t,this},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:[1,0,0,1,0,0]},render:function(t,i){0===this.width&&0===this.height||!this.visible||(t.save(),this._setupCompositeOperation(t),i||this.transform(t),this._setStrokeStyles(t),this._setFillStyles(t),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this._setOpacity(t),this._setShadow(t),this.clipTo&&e.util.clipContext(this,t),this._render(t,i),this.clipTo&&t.restore(),t.restore())},_setOpacity:function(t){this.group&&this.group._setOpacity(t),t.globalAlpha*=this.opacity},_setStrokeStyles:function(t){this.stroke&&(t.lineWidth=this.strokeWidth,t.lineCap=this.strokeLineCap,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,t.strokeStyle=this.stroke.toLive?this.stroke.toLive(t,this):this.stroke)},_setFillStyles:function(t){this.fill&&(t.fillStyle=this.fill.toLive?this.fill.toLive(t,this):this.fill)},_renderControls:function(t,i){if(this.active&&!i){var r=this.getViewportTransform();t.save();var s;this.group&&(s=e.util.transformPoint(this.group.getCenterPoint(),r),t.translate(s.x,s.y),t.rotate(n(this.group.angle))),s=e.util.transformPoint(this.getCenterPoint(),r,null!=this.group),this.group&&(s.x*=this.group.scaleX,s.y*=this.group.scaleY),t.translate(s.x,s.y),t.rotate(n(this.angle)),this.drawBorders(t),this.drawControls(t),t.restore()}},_setShadow:function(t){if(this.shadow){var e=this.canvas&&this.canvas.viewportTransform[0]||1,i=this.canvas&&this.canvas.viewportTransform[3]||1;t.shadowColor=this.shadow.color,t.shadowBlur=this.shadow.blur*(e+i)*(this.scaleX+this.scaleY)/4,t.shadowOffsetX=this.shadow.offsetX*e*this.scaleX,t.shadowOffsetY=this.shadow.offsetY*i*this.scaleY}},_removeShadow:function(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)},_renderFill:function(t){if(this.fill){if(t.save(),this.fill.gradientTransform){var e=this.fill.gradientTransform;t.transform.apply(t,e)}this.fill.toLive&&t.translate(-this.width/2+this.fill.offsetX||0,-this.height/2+this.fill.offsetY||0),"evenodd"===this.fillRule?t.fill("evenodd"):t.fill(),t.restore()}},_renderStroke:function(t){if(this.stroke&&0!==this.strokeWidth){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeDashArray)1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),o?(t.setLineDash(this.strokeDashArray),this._stroke&&this._stroke(t)):this._renderDashedStroke&&this._renderDashedStroke(t),t.stroke();else{if(this.stroke.gradientTransform){var e=this.stroke.gradientTransform;t.transform.apply(t,e)}this._stroke?this._stroke(t):t.stroke()}t.restore()}},clone:function(t,i){return this.constructor.fromObject?this.constructor.fromObject(this.toObject(i),t):new e.Object(this.toObject(i))},cloneAsImage:function(t){var i=this.toDataURL();return e.util.loadImage(i,function(i){t&&t(new e.Image(i))}),this},toDataURL:function(t){t||(t={});var i=e.util.createCanvasElement(),r=this.getBoundingRect();i.width=r.width,i.height=r.height,e.util.wrapElement(i,"div");var s=new e.StaticCanvas(i);"jpg"===t.format&&(t.format="jpeg"),"jpeg"===t.format&&(s.backgroundColor="#fff");var n={active:this.get("active"),left:this.getLeft(),top:this.getTop()};this.set("active",!1),this.setPositionByOrigin(new e.Point(i.width/2,i.height/2),"center","center");var o=this.canvas;s.add(this);var a=s.toDataURL(t);return this.set(n).setCoords(),this.canvas=o,s.dispose(),s=null,a},isType:function(t){return this.type===t},complexity:function(){return 0},toJSON:function(t){return this.toObject(t)},setGradient:function(t,i){i||(i={});var r={colorStops:[]};r.type=i.type||(i.r1||i.r2?"radial":"linear"),r.coords={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},(i.r1||i.r2)&&(r.coords.r1=i.r1,r.coords.r2=i.r2);for(var s in i.colorStops){var n=new e.Color(i.colorStops[s]);r.colorStops.push({offset:s,color:n.toRgb(),opacity:n.getAlpha()})}return this.set(t,e.Gradient.forObject(this,r))},setPatternFill:function(t){return this.set("fill",new e.Pattern(t))},setShadow:function(t){return this.set("shadow",t?new e.Shadow(t):null)},setColor:function(t){return this.set("fill",t),this},setAngle:function(t){var e=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return e&&this._setOriginToCenter(),this.set("angle",t),e&&this._resetOrigin(),this},centerH:function(){return this.canvas.centerObjectH(this),this},centerV:function(){return this.canvas.centerObjectV(this),this},center:function(){return this.canvas.centerObject(this),this},remove:function(){return this.canvas.remove(this),this},getLocalPointer:function(t,e){e=e||this.canvas.getPointer(t);var i=this.translateToOriginPoint(this.getCenterPoint(),"left","top");return{x:e.x-i.x,y:e.y-i.y}},_setupCompositeOperation:function(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)}}),e.util.createAccessors(e.Object),e.Object.prototype.rotate=e.Object.prototype.setAngle,i(e.Object.prototype,e.Observable),e.Object.NUM_FRACTION_DIGITS=2,e.Object.__uid=0)}("undefined"!=typeof exports?exports:this),function(){var t=fabric.util.degreesToRadians;fabric.util.object.extend(fabric.Object.prototype,{translateToCenterPoint:function(e,i,r){var s=e.x,n=e.y;return"left"===i?s=e.x+(this.getWidth()+this.strokeWidth*this.scaleX)/2:"right"===i&&(s=e.x-(this.getWidth()+this.strokeWidth*this.scaleX)/2),"top"===r?n=e.y+(this.getHeight()+this.strokeWidth*this.scaleY)/2:"bottom"===r&&(n=e.y-(this.getHeight()+this.strokeWidth*this.scaleY)/2),fabric.util.rotatePoint(new fabric.Point(s,n),e,t(this.angle))},translateToOriginPoint:function(e,i,r){var s=e.x,n=e.y;return"left"===i?s=e.x-(this.getWidth()+this.strokeWidth*this.scaleX)/2:"right"===i&&(s=e.x+(this.getWidth()+this.strokeWidth*this.scaleX)/2),"top"===r?n=e.y-(this.getHeight()+this.strokeWidth*this.scaleY)/2:"bottom"===r&&(n=e.y+(this.getHeight()+this.strokeWidth*this.scaleY)/2),fabric.util.rotatePoint(new fabric.Point(s,n),e,t(this.angle))},getCenterPoint:function(){var t=new fabric.Point(this.left,this.top);return this.translateToCenterPoint(t,this.originX,this.originY)},getPointByOrigin:function(t,e){var i=this.getCenterPoint();return this.translateToOriginPoint(i,t,e)},toLocalPoint:function(e,i,r){var s,n,o=this.getCenterPoint();return i&&r?(s="left"===i?o.x-(this.getWidth()+this.strokeWidth*this.scaleX)/2:"right"===i?o.x+(this.getWidth()+this.strokeWidth*this.scaleX)/2:o.x,n="top"===r?o.y-(this.getHeight()+this.strokeWidth*this.scaleY)/2:"bottom"===r?o.y+(this.getHeight()+this.strokeWidth*this.scaleY)/2:o.y):(s=this.left,n=this.top),fabric.util.rotatePoint(new fabric.Point(e.x,e.y),o,-t(this.angle)).subtractEquals(new fabric.Point(s,n))},setPositionByOrigin:function(t,e,i){var r=this.translateToCenterPoint(t,e,i),s=this.translateToOriginPoint(r,this.originX,this.originY);this.set("left",s.x),this.set("top",s.y)},adjustPosition:function(e){var i=t(this.angle),r=this.getWidth()/2,s=Math.cos(i)*r,n=Math.sin(i)*r,o=this.getWidth(),a=Math.cos(i)*o,h=Math.sin(i)*o;"center"===this.originX&&"left"===e||"right"===this.originX&&"center"===e?(this.left-=s,this.top-=n):"left"===this.originX&&"center"===e||"center"===this.originX&&"right"===e?(this.left+=s,this.top+=n):"left"===this.originX&&"right"===e?(this.left+=a,this.top+=h):"right"===this.originX&&"left"===e&&(this.left-=a,this.top-=h),this.setCoords(),this.originX=e},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var t=this.getCenterPoint();this.originX="center",this.originY="center",this.left=t.x,this.top=t.y},_resetOrigin:function(){var t=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=t.x,this.top=t.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){var t=fabric.util.degreesToRadians;fabric.util.object.extend(fabric.Object.prototype,{oCoords:null,intersectsWithRect:function(t,e){var i=this.oCoords,r=new fabric.Point(i.tl.x,i.tl.y),s=new fabric.Point(i.tr.x,i.tr.y),n=new fabric.Point(i.bl.x,i.bl.y),o=new fabric.Point(i.br.x,i.br.y),a=fabric.Intersection.intersectPolygonRectangle([r,s,o,n],t,e);return"Intersection"===a.status},intersectsWithObject:function(t){function e(t){return{tl:new fabric.Point(t.tl.x,t.tl.y),tr:new fabric.Point(t.tr.x,t.tr.y),bl:new fabric.Point(t.bl.x,t.bl.y),br:new fabric.Point(t.br.x,t.br.y)}}var i=e(this.oCoords),r=e(t.oCoords),s=fabric.Intersection.intersectPolygonPolygon([i.tl,i.tr,i.br,i.bl],[r.tl,r.tr,r.br,r.bl]);return"Intersection"===s.status},isContainedWithinObject:function(t){var e=t.getBoundingRect(),i=new fabric.Point(e.left,e.top),r=new fabric.Point(e.left+e.width,e.top+e.height);return this.isContainedWithinRect(i,r)},isContainedWithinRect:function(t,e){var i=this.getBoundingRect();return i.left>=t.x&&i.left+i.width<=e.x&&i.top>=t.y&&i.top+i.height<=e.y},containsPoint:function(t){var e=this._getImageLines(this.oCoords),i=this._findCrossPoints(t,e);return 0!==i&&i%2===1},_getImageLines:function(t){return{topline:{o:t.tl,d:t.tr},rightline:{o:t.tr,d:t.br},bottomline:{o:t.br,d:t.bl},leftline:{o:t.bl,d:t.tl}}},_findCrossPoints:function(t,e){var i,r,s,n,o,a,h,c=0;for(var l in e)if(h=e[l],!(h.o.y<t.y&&h.d.y<t.y||h.o.y>=t.y&&h.d.y>=t.y||(h.o.x===h.d.x&&h.o.x>=t.x?(o=h.o.x,a=t.y):(i=0,r=(h.d.y-h.o.y)/(h.d.x-h.o.x),s=t.y-i*t.x,n=h.o.y-r*h.o.x,o=-(s-n)/(i-r),a=s+i*o),o>=t.x&&(c+=1),2!==c)))break;return c},getBoundingRectWidth:function(){return this.getBoundingRect().width},getBoundingRectHeight:function(){return this.getBoundingRect().height},getBoundingRect:function(){this.oCoords||this.setCoords();var t=[this.oCoords.tl.x,this.oCoords.tr.x,this.oCoords.br.x,this.oCoords.bl.x],e=fabric.util.array.min(t),i=fabric.util.array.max(t),r=Math.abs(e-i),s=[this.oCoords.tl.y,this.oCoords.tr.y,this.oCoords.br.y,this.oCoords.bl.y],n=fabric.util.array.min(s),o=fabric.util.array.max(s),a=Math.abs(n-o);return{left:e,top:n,width:r,height:a}},getWidth:function(){return this.width*this.scaleX},getHeight:function(){return this.height*this.scaleY},_constrainScale:function(t){return Math.abs(t)<this.minScaleLimit?0>t?-this.minScaleLimit:this.minScaleLimit:t},scale:function(t){return t=this._constrainScale(t),0>t&&(this.flipX=!this.flipX,this.flipY=!this.flipY,t*=-1),this.scaleX=t,this.scaleY=t,this.setCoords(),this},scaleToWidth:function(t){var e=this.getBoundingRectWidth()/this.getWidth();return this.scale(t/this.width/e)},scaleToHeight:function(t){var e=this.getBoundingRectHeight()/this.getHeight();return this.scale(t/this.height/e)},setCoords:function(){var e=t(this.angle),i=this.getViewportTransform(),r=function(t){return fabric.util.transformPoint(t,i)},s=this._calculateCurrentDimensions(!1),n=s.x,o=s.y;0>n&&(n=Math.abs(n));var a=Math.sqrt(Math.pow(n/2,2)+Math.pow(o/2,2)),h=Math.atan(isFinite(o/n)?o/n:0),c=Math.cos(h+e)*a,l=Math.sin(h+e)*a,u=Math.sin(e),f=Math.cos(e),d=this.getCenterPoint(),g=new fabric.Point(n,o),p=new fabric.Point(d.x-c,d.y-l),v=new fabric.Point(p.x+g.x*f,p.y+g.x*u),b=r(new fabric.Point(p.x-g.y*u,p.y+g.y*f)),m=r(new fabric.Point(v.x-g.y*u,v.y+g.y*f)),y=r(p),_=r(v),x=new fabric.Point((y.x+b.x)/2,(y.y+b.y)/2),C=new fabric.Point((_.x+y.x)/2,(_.y+y.y)/2),S=new fabric.Point((m.x+_.x)/2,(m.y+_.y)/2),w=new fabric.Point((m.x+b.x)/2,(m.y+b.y)/2),O=new fabric.Point(C.x+u*this.rotatingPointOffset,C.y-f*this.rotatingPointOffset);return this.oCoords={tl:y,tr:_,br:m,bl:b,ml:x,mt:C,mr:S,mb:w,mtr:O},this._setCornerCoords&&this._setCornerCoords(),this}})}(),fabric.util.object.extend(fabric.Object.prototype,{sendToBack:function(){return this.group?fabric.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?fabric.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas.bringToFront(this),this},sendBackwards:function(t){return this.group?fabric.StaticCanvas.prototype.sendBackwards.call(this.group,this,t):this.canvas.sendBackwards(this,t),this},bringForward:function(t){return this.group?fabric.StaticCanvas.prototype.bringForward.call(this.group,this,t):this.canvas.bringForward(this,t),this},moveTo:function(t){return this.group?fabric.StaticCanvas.prototype.moveTo.call(this.group,this,t):this.canvas.moveTo(this,t),this}}),fabric.util.object.extend(fabric.Object.prototype,{getSvgStyles:function(){var t=this.fill?this.fill.toLive?"url(#SVGID_"+this.fill.id+")":this.fill:"none",e=this.fillRule,i=this.stroke?this.stroke.toLive?"url(#SVGID_"+this.stroke.id+")":this.stroke:"none",r=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):"",n=this.strokeLineCap?this.strokeLineCap:"butt",o=this.strokeLineJoin?this.strokeLineJoin:"miter",a=this.strokeMiterLimit?this.strokeMiterLimit:"4",h="undefined"!=typeof this.opacity?this.opacity:"1",c=this.visible?"":" visibility: hidden;",l=this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":"";return["stroke: ",i,"; ","stroke-width: ",r,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",n,"; ","stroke-linejoin: ",o,"; ","stroke-miterlimit: ",a,"; ","fill: ",t,"; ","fill-rule: ",e,"; ","opacity: ",h,";",l,c].join("")},getSvgTransform:function(){if(this.group&&"path-group"===this.group.type)return"";var t=fabric.util.toFixed,e=this.getAngle(),i=!this.canvas||this.canvas.svgViewportTransformation?this.getViewportTransform():[1,0,0,1,0,0],r=fabric.util.transformPoint(this.getCenterPoint(),i),s=fabric.Object.NUM_FRACTION_DIGITS,n="path-group"===this.type?"":"translate("+t(r.x,s)+" "+t(r.y,s)+")",o=0!==e?" rotate("+t(e,s)+")":"",a=1===this.scaleX&&1===this.scaleY&&1===i[0]&&1===i[3]?"":" scale("+t(this.scaleX*i[0],s)+" "+t(this.scaleY*i[3],s)+")",h="path-group"===this.type?this.width*i[0]:0,c=this.flipX?" matrix(-1 0 0 1 "+h+" 0) ":"",l="path-group"===this.type?this.height*i[3]:0,u=this.flipY?" matrix(1 0 0 -1 0 "+l+")":"";return[n,o,a,c,u].join("")},getSvgTransformMatrix:function(){return this.transformMatrix?" matrix("+this.transformMatrix.join(" ")+") ":""},_createBaseSVGMarkup:function(){var t=[];return this.fill&&this.fill.toLive&&t.push(this.fill.toSVG(this,!1)),this.stroke&&this.stroke.toLive&&t.push(this.stroke.toSVG(this,!1)),this.shadow&&t.push(this.shadow.toSVG(this)),t}}),fabric.util.object.extend(fabric.Object.prototype,{hasStateChanged:function(){return this.stateProperties.some(function(t){return this.get(t)!==this.originalState[t]},this)},saveState:function(t){return this.stateProperties.forEach(function(t){this.originalState[t]=this.get(t)},this),t&&t.stateProperties&&t.stateProperties.forEach(function(t){this.originalState[t]=this.get(t)},this),this},setupState:function(){return this.originalState={},this.saveState(),this}}),function(){var t=fabric.util.degreesToRadians,e=function(){return"undefined"!=typeof G_vmlCanvasManager};fabric.util.object.extend(fabric.Object.prototype,{_controlsVisibility:null,_findTargetCorner:function(t){if(!this.hasControls||!this.active)return!1;var e,i,r=t.x,s=t.y;for(var n in this.oCoords)if(this.isControlVisible(n)&&("mtr"!==n||this.hasRotatingPoint)&&(!this.get("lockUniScaling")||"mt"!==n&&"mr"!==n&&"mb"!==n&&"ml"!==n)&&(i=this._getImageLines(this.oCoords[n].corner),e=this._findCrossPoints({x:r,y:s},i),0!==e&&e%2===1))return this.__corner=n,n;return!1},_setCornerCoords:function(){var e,i,r=this.oCoords,s=t(45-this.angle),n=Math.sqrt(2*Math.pow(this.cornerSize,2))/2,o=n*Math.cos(s),a=n*Math.sin(s);for(var h in r)e=r[h].x,i=r[h].y,r[h].corner={tl:{x:e-a,y:i-o},tr:{x:e+o,y:i-a},bl:{x:e-o,y:i+a},br:{x:e+a,y:i+o}}},_calculateCurrentDimensions:function(t){var e=this.getViewportTransform(),i=this.strokeWidth,r=this.width,s=this.height,n="round"===this.strokeLineCap||"square"===this.strokeLineCap,o="line"===this.type&&0===this.width,a="line"===this.type&&0===this.height,h=o||a,c=n&&a||!h,l=n&&o||!h;return o?r=i:a&&(s=i),c&&(r+=0>r?-i:i),l&&(s+=0>s?-i:i),r=r*this.scaleX+2*this.padding,s=s*this.scaleY+2*this.padding,t?fabric.util.transformPoint(new fabric.Point(r,s),e,!0):{x:r,y:s}},drawBorders:function(t){if(!this.hasBorders)return this;t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,t.strokeStyle=this.borderColor,t.lineWidth=1/this.borderScaleFactor;var e=this._calculateCurrentDimensions(!0),i=e.x,r=e.y;if(this.group&&(i*=this.group.scaleX,r*=this.group.scaleY),t.strokeRect(~~-(i/2)-.5,~~-(r/2)-.5,~~i+1,~~r+1),this.hasRotatingPoint&&this.isControlVisible("mtr")&&!this.get("lockRotation")&&this.hasControls){var s=-r/2;t.beginPath(),t.moveTo(0,s),t.lineTo(0,s-this.rotatingPointOffset),t.closePath(),t.stroke()}return t.restore(),this},drawControls:function(t){if(!this.hasControls)return this;var e=this._calculateCurrentDimensions(!0),i=e.x,r=e.y,s=-(i/2),n=-(r/2),o=this.cornerSize/2,a=this.transparentCorners?"strokeRect":"fillRect";return t.save(),t.lineWidth=1,t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,t.strokeStyle=t.fillStyle=this.cornerColor,this._drawControl("tl",t,a,s-o,n-o),this._drawControl("tr",t,a,s+i-o,n-o),this._drawControl("bl",t,a,s-o,n+r-o),this._drawControl("br",t,a,s+i-o,n+r-o),this.get("lockUniScaling")||(this._drawControl("mt",t,a,s+i/2-o,n-o),this._drawControl("mb",t,a,s+i/2-o,n+r-o),this._drawControl("mr",t,a,s+i-o,n+r/2-o),this._drawControl("ml",t,a,s-o,n+r/2-o)),this.hasRotatingPoint&&this._drawControl("mtr",t,a,s+i/2-o,n-this.rotatingPointOffset-o),t.restore(),this},_drawControl:function(t,i,r,s,n){if(this.isControlVisible(t)){var o=this.cornerSize;e()||this.transparentCorners||i.clearRect(s,n,o,o),i[r](s,n,o,o)}},isControlVisible:function(t){return this._getControlsVisibility()[t]},setControlVisible:function(t,e){return this._getControlsVisibility()[t]=e,this},setControlsVisibility:function(t){t||(t={});for(var e in t)this.setControlVisible(e,t[e]);return this},_getControlsVisibility:function(){return this._controlsVisibility||(this._controlsVisibility={tl:!0,tr:!0,br:!0,bl:!0,ml:!0,mt:!0,mr:!0,mb:!0,mtr:!0}),this._controlsVisibility}})}(),fabric.util.object.extend(fabric.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(t,e){e=e||{};var i=function(){},r=e.onComplete||i,s=e.onChange||i,n=this;return fabric.util.animate({startValue:t.get("left"),endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(e){t.set("left",e),n.renderAll(),s()},onComplete:function(){t.setCoords(),r()}}),this},fxCenterObjectV:function(t,e){e=e||{};var i=function(){},r=e.onComplete||i,s=e.onChange||i,n=this;return fabric.util.animate({startValue:t.get("top"),endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(e){t.set("top",e),n.renderAll(),s()},onComplete:function(){t.setCoords(),r()}}),this},fxRemove:function(t,e){e=e||{};var i=function(){},r=e.onComplete||i,s=e.onChange||i,n=this;return fabric.util.animate({startValue:t.get("opacity"),endValue:0,duration:this.FX_DURATION,onStart:function(){t.set("active",!1)},onChange:function(e){t.set("opacity",e),n.renderAll(),s()},onComplete:function(){n.remove(t),r()}}),this}}),fabric.util.object.extend(fabric.Object.prototype,{animate:function(){if(arguments[0]&&"object"==typeof arguments[0]){var t,e,i=[];for(t in arguments[0])i.push(t);for(var r=0,s=i.length;s>r;r++)t=i[r],e=r!==s-1,this._animate(t,arguments[0][t],arguments[1],e)}else this._animate.apply(this,arguments);return this},_animate:function(t,e,i,r){var s,n=this;e=e.toString(),i=i?fabric.util.object.clone(i):{},~t.indexOf(".")&&(s=t.split("."));var o=s?this.get(s[0])[s[1]]:this.get(t);"from"in i||(i.from=o),e=~e.indexOf("=")?o+parseFloat(e.replace("=","")):parseFloat(e),fabric.util.animate({startValue:i.from,endValue:e,byValue:i.by,easing:i.easing,duration:i.duration,abort:i.abort&&function(){return i.abort.call(n)},onChange:function(e){s?n[s[0]][s[1]]=e:n.set(t,e),r||i.onChange&&i.onChange()},onComplete:function(){r||(n.setCoords(),i.onComplete&&i.onComplete())}})}}),function(t){"use strict";function e(t,e){var i=t.origin,r=t.axis1,s=t.axis2,n=t.dimension,o=e.nearest,a=e.center,h=e.farthest;return function(){switch(this.get(i)){case o:return Math.min(this.get(r),this.get(s));case a:return Math.min(this.get(r),this.get(s))+.5*this.get(n);case h:return Math.max(this.get(r),this.get(s));

}}}var i=t.fabric||(t.fabric={}),r=i.util.object.extend,s={x1:1,x2:1,y1:1,y2:1},n=i.StaticCanvas.supports("setLineDash");return i.Line?void i.warn("fabric.Line is already defined"):(i.Line=i.util.createClass(i.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,initialize:function(t,e){e=e||{},t||(t=[0,0,0,0]),this.callSuper("initialize",e),this.set("x1",t[0]),this.set("y1",t[1]),this.set("x2",t[2]),this.set("y2",t[3]),this._setWidthHeight(e)},_setWidthHeight:function(t){t||(t={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in t?t.left:this._getLeftToOriginX(),this.top="top"in t?t.top:this._getTopToOriginY()},_set:function(t,e){return this.callSuper("_set",t,e),"undefined"!=typeof s[t]&&this._setWidthHeight(),this},_getLeftToOriginX:e({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:e({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(t,e){if(t.beginPath(),e){var i=this.getCenterPoint();t.translate(i.x-this.strokeWidth/2,i.y-this.strokeWidth/2)}if(!this.strokeDashArray||this.strokeDashArray&&n){var r=this.calcLinePoints();t.moveTo(r.x1,r.y1),t.lineTo(r.x2,r.y2)}t.lineWidth=this.strokeWidth;var s=t.strokeStyle;t.strokeStyle=this.stroke||t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=s},_renderDashedStroke:function(t){var e=this.calcLinePoints();t.beginPath(),i.util.drawDashedLine(t,e.x1,e.y1,e.x2,e.y2,this.strokeDashArray),t.closePath()},toObject:function(t){return r(this.callSuper("toObject",t),this.calcLinePoints())},calcLinePoints:function(){var t=this.x1<=this.x2?-1:1,e=this.y1<=this.y2?-1:1,i=t*this.width*.5,r=e*this.height*.5,s=t*this.width*-.5,n=e*this.height*-.5;return{x1:i,x2:s,y1:r,y2:n}},toSVG:function(t){var e=this._createBaseSVGMarkup(),i={x1:this.x1,x2:this.x2,y1:this.y1,y2:this.y2};return this.group&&"path-group"===this.group.type||(i=this.calcLinePoints()),e.push("<line ",'x1="',i.x1,'" y1="',i.y1,'" x2="',i.x2,'" y2="',i.y2,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),t?t(e.join("")):e.join("")},complexity:function(){return 1}}),i.Line.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),i.Line.fromElement=function(t,e){var s=i.parseAttributes(t,i.Line.ATTRIBUTE_NAMES),n=[s.x1||0,s.y1||0,s.x2||0,s.y2||0];return new i.Line(n,r(s,e))},void(i.Line.fromObject=function(t){var e=[t.x1,t.y1,t.x2,t.y2];return new i.Line(e,t)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";function e(t){return"radius"in t&&t.radius>=0}var i=t.fabric||(t.fabric={}),r=Math.PI,s=i.util.object.extend;return i.Circle?void i.warn("fabric.Circle is already defined."):(i.Circle=i.util.createClass(i.Object,{type:"circle",radius:0,startAngle:0,endAngle:2*r,initialize:function(t){t=t||{},this.callSuper("initialize",t),this.set("radius",t.radius||0),this.startAngle=t.startAngle||this.startAngle,this.endAngle=t.endAngle||this.endAngle},_set:function(t,e){return this.callSuper("_set",t,e),"radius"===t&&this.setRadius(e),this},toObject:function(t){return s(this.callSuper("toObject",t),{radius:this.get("radius"),startAngle:this.startAngle,endAngle:this.endAngle})},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=0,s=0,n=(this.endAngle-this.startAngle)%(2*r);if(0===n)this.group&&"path-group"===this.group.type&&(i=this.left+this.radius,s=this.top+this.radius),e.push("<circle ",'cx="'+i+'" cy="'+s+'" ','r="',this.radius,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n');else{var o=Math.cos(this.startAngle)*this.radius,a=Math.sin(this.startAngle)*this.radius,h=Math.cos(this.endAngle)*this.radius,c=Math.sin(this.endAngle)*this.radius,l=n>r?"1":"0";e.push('<path d="M '+o+" "+a," A "+this.radius+" "+this.radius," 0 ",+l+" 1"," "+h+" "+c,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n')}return t?t(e.join("")):e.join("")},_render:function(t,e){t.beginPath(),t.arc(e?this.left+this.radius:0,e?this.top+this.radius:0,this.radius,this.startAngle,this.endAngle,!1),this._renderFill(t),this._renderStroke(t)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(t){this.radius=t,this.set("width",2*t).set("height",2*t)},complexity:function(){return 1}}),i.Circle.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),i.Circle.fromElement=function(t,r){r||(r={});var n=i.parseAttributes(t,i.Circle.ATTRIBUTE_NAMES);if(!e(n))throw new Error("value of `r` attribute is required and can not be negative");n.left=n.left||0,n.top=n.top||0;var o=new i.Circle(s(n,r));return o.left-=o.radius,o.top-=o.radius,o},void(i.Circle.fromObject=function(t){return new i.Circle(t)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});return e.Triangle?void e.warn("fabric.Triangle is already defined"):(e.Triangle=e.util.createClass(e.Object,{type:"triangle",initialize:function(t){t=t||{},this.callSuper("initialize",t),this.set("width",t.width||100).set("height",t.height||100)},_render:function(t){var e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,i),t.lineTo(0,-i),t.lineTo(e,i),t.closePath(),this._renderFill(t),this._renderStroke(t)},_renderDashedStroke:function(t){var i=this.width/2,r=this.height/2;t.beginPath(),e.util.drawDashedLine(t,-i,r,0,-r,this.strokeDashArray),e.util.drawDashedLine(t,0,-r,i,r,this.strokeDashArray),e.util.drawDashedLine(t,i,r,-i,r,this.strokeDashArray),t.closePath()},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this.width/2,r=this.height/2,s=[-i+" "+r,"0 "+-r,i+" "+r].join(",");return e.push("<polygon ",'points="',s,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>'),t?t(e.join("")):e.join("")},complexity:function(){return 1}}),void(e.Triangle.fromObject=function(t){return new e.Triangle(t)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=2*Math.PI,r=e.util.object.extend;return e.Ellipse?void e.warn("fabric.Ellipse is already defined."):(e.Ellipse=e.util.createClass(e.Object,{type:"ellipse",rx:0,ry:0,initialize:function(t){t=t||{},this.callSuper("initialize",t),this.set("rx",t.rx||0),this.set("ry",t.ry||0)},_set:function(t,e){switch(this.callSuper("_set",t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(t){return r(this.callSuper("toObject",t),{rx:this.get("rx"),ry:this.get("ry")})},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=0,r=0;return this.group&&"path-group"===this.group.type&&(i=this.left+this.rx,r=this.top+this.ry),e.push("<ellipse ",'cx="',i,'" cy="',r,'" ','rx="',this.rx,'" ry="',this.ry,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),t?t(e.join("")):e.join("")},_render:function(t,e){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(e?this.left+this.rx:0,e?(this.top+this.ry)*this.rx/this.ry:0,this.rx,0,i,!1),t.restore(),this._renderFill(t),this._renderStroke(t)},complexity:function(){return 1}}),e.Ellipse.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),e.Ellipse.fromElement=function(t,i){i||(i={});var s=e.parseAttributes(t,e.Ellipse.ATTRIBUTE_NAMES);s.left=s.left||0,s.top=s.top||0;var n=new e.Ellipse(r(s,i));return n.top-=n.ry,n.left-=n.rx,n},void(e.Ellipse.fromObject=function(t){return new e.Ellipse(t)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;if(e.Rect)return void console.warn("fabric.Rect is already defined");var r=e.Object.prototype.stateProperties.concat();r.push("rx","ry","x","y"),e.Rect=e.util.createClass(e.Object,{stateProperties:r,type:"rect",rx:0,ry:0,strokeDashArray:null,initialize:function(t){t=t||{},this.callSuper("initialize",t),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(t,e){if(1===this.width&&1===this.height)return void t.fillRect(0,0,1,1);var i=this.rx?Math.min(this.rx,this.width/2):0,r=this.ry?Math.min(this.ry,this.height/2):0,s=this.width,n=this.height,o=e?this.left:-this.width/2,a=e?this.top:-this.height/2,h=0!==i||0!==r,c=.4477152502;t.beginPath(),t.moveTo(o+i,a),t.lineTo(o+s-i,a),h&&t.bezierCurveTo(o+s-c*i,a,o+s,a+c*r,o+s,a+r),t.lineTo(o+s,a+n-r),h&&t.bezierCurveTo(o+s,a+n-c*r,o+s-c*i,a+n,o+s-i,a+n),t.lineTo(o+i,a+n),h&&t.bezierCurveTo(o+c*i,a+n,o,a+n-c*r,o,a+n-r),t.lineTo(o,a+r),h&&t.bezierCurveTo(o,a+c*r,o+c*i,a,o+i,a),t.closePath(),this._renderFill(t),this._renderStroke(t)},_renderDashedStroke:function(t){var i=-this.width/2,r=-this.height/2,s=this.width,n=this.height;t.beginPath(),e.util.drawDashedLine(t,i,r,i+s,r,this.strokeDashArray),e.util.drawDashedLine(t,i+s,r,i+s,r+n,this.strokeDashArray),e.util.drawDashedLine(t,i+s,r+n,i,r+n,this.strokeDashArray),e.util.drawDashedLine(t,i,r+n,i,r,this.strokeDashArray),t.closePath()},toObject:function(t){var e=i(this.callSuper("toObject",t),{rx:this.get("rx")||0,ry:this.get("ry")||0});return this.includeDefaultValues||this._removeDefaultValues(e),e},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this.left,r=this.top;return this.group&&"path-group"===this.group.type||(i=-this.width/2,r=-this.height/2),e.push("<rect ",'x="',i,'" y="',r,'" rx="',this.get("rx"),'" ry="',this.get("ry"),'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),t?t(e.join("")):e.join("")},complexity:function(){return 1}}),e.Rect.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),e.Rect.fromElement=function(t,r){if(!t)return null;r=r||{};var s=e.parseAttributes(t,e.Rect.ATTRIBUTE_NAMES);s.left=s.left||0,s.top=s.top||0;var n=new e.Rect(i(r?e.util.object.clone(r):{},s));return n.visible=n.width>0&&n.height>0,n},e.Rect.fromObject=function(t){return new e.Rect(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});return e.Polyline?void e.warn("fabric.Polyline is already defined"):(e.Polyline=e.util.createClass(e.Object,{type:"polyline",points:null,minX:0,minY:0,initialize:function(t,i){return e.Polygon.prototype.initialize.call(this,t,i)},_calcDimensions:function(){return e.Polygon.prototype._calcDimensions.call(this)},_applyPointOffset:function(){return e.Polygon.prototype._applyPointOffset.call(this)},toObject:function(t){return e.Polygon.prototype.toObject.call(this,t)},toSVG:function(t){return e.Polygon.prototype.toSVG.call(this,t)},_render:function(t){e.Polygon.prototype.commonRender.call(this,t)&&(this._renderFill(t),this._renderStroke(t))},_renderDashedStroke:function(t){var i,r;t.beginPath();for(var s=0,n=this.points.length;n>s;s++)i=this.points[s],r=this.points[s+1]||i,e.util.drawDashedLine(t,i.x,i.y,r.x,r.y,this.strokeDashArray)},complexity:function(){return this.get("points").length}}),e.Polyline.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polyline.fromElement=function(t,i){if(!t)return null;i||(i={});var r=e.parsePointsAttribute(t.getAttribute("points")),s=e.parseAttributes(t,e.Polyline.ATTRIBUTE_NAMES);return new e.Polyline(r,e.util.object.extend(s,i))},void(e.Polyline.fromObject=function(t){var i=t.points;return new e.Polyline(i,t,!0)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.array.min,s=e.util.array.max,n=e.util.toFixed;return e.Polygon?void e.warn("fabric.Polygon is already defined"):(e.Polygon=e.util.createClass(e.Object,{type:"polygon",points:null,minX:0,minY:0,initialize:function(t,e){e=e||{},this.points=t||[],this.callSuper("initialize",e),this._calcDimensions(),"top"in e||(this.top=this.minY),"left"in e||(this.left=this.minX)},_calcDimensions:function(){var t=this.points,e=r(t,"x"),i=r(t,"y"),n=s(t,"x"),o=s(t,"y");this.width=n-e||0,this.height=o-i||0,this.minX=e||0,this.minY=i||0},_applyPointOffset:function(){this.points.forEach(function(t){t.x-=this.minX+this.width/2,t.y-=this.minY+this.height/2},this)},toObject:function(t){return i(this.callSuper("toObject",t),{points:this.points.concat()})},toSVG:function(t){for(var e=[],i=this._createBaseSVGMarkup(),r=0,s=this.points.length;s>r;r++)e.push(n(this.points[r].x,2),",",n(this.points[r].y,2)," ");return i.push("<",this.type," ",'points="',e.join(""),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n'),t?t(i.join("")):i.join("")},_render:function(t){this.commonRender(t)&&(this._renderFill(t),(this.stroke||this.strokeDashArray)&&(t.closePath(),this._renderStroke(t)))},commonRender:function(t){var e,i=this.points.length;if(!i||isNaN(this.points[i-1].y))return!1;t.beginPath(),this._applyPointOffset&&(this.group&&"path-group"===this.group.type||this._applyPointOffset(),this._applyPointOffset=null),t.moveTo(this.points[0].x,this.points[0].y);for(var r=0;i>r;r++)e=this.points[r],t.lineTo(e.x,e.y);return!0},_renderDashedStroke:function(t){e.Polyline.prototype._renderDashedStroke.call(this,t),t.closePath()},complexity:function(){return this.points.length}}),e.Polygon.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polygon.fromElement=function(t,r){if(!t)return null;r||(r={});var s=e.parsePointsAttribute(t.getAttribute("points")),n=e.parseAttributes(t,e.Polygon.ATTRIBUTE_NAMES);return new e.Polygon(s,i(n,r))},void(e.Polygon.fromObject=function(t){return new e.Polygon(t.points,t,!0)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.array.min,r=e.util.array.max,s=e.util.object.extend,n=Object.prototype.toString,o=e.util.drawArc,a={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},h={m:"l",M:"L"};return e.Path?void e.warn("fabric.Path is already defined"):(e.Path=e.util.createClass(e.Object,{type:"path",path:null,minX:0,minY:0,initialize:function(t,e){if(e=e||{},this.setOptions(e),!t)throw new Error("`path` argument is required");var i="[object Array]"===n.call(t);this.path=i?t:t.match&&t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi),this.path&&(i||(this.path=this._parsePath()),this._setPositionDimensions(e),e.sourcePath&&this.setSourcePath(e.sourcePath))},_setPositionDimensions:function(t){var e=this._parseDimensions();this.minX=e.left,this.minY=e.top,this.width=e.width,this.height=e.height,"undefined"==typeof t.left&&(this.left=e.left+("center"===this.originX?this.width/2:"right"===this.originX?this.width:0)),"undefined"==typeof t.top&&(this.top=e.top+("center"===this.originY?this.height/2:"bottom"===this.originY?this.height:0)),this.pathOffset=this.pathOffset||{x:this.minX+this.width/2,y:this.minY+this.height/2}},_render:function(t){var e,i,r,s=null,n=0,a=0,h=0,c=0,l=0,u=0,f=-this.pathOffset.x,d=-this.pathOffset.y;this.group&&"path-group"===this.group.type&&(f=0,d=0),t.beginPath();for(var g=0,p=this.path.length;p>g;++g){switch(e=this.path[g],e[0]){case"l":h+=e[1],c+=e[2],t.lineTo(h+f,c+d);break;case"L":h=e[1],c=e[2],t.lineTo(h+f,c+d);break;case"h":h+=e[1],t.lineTo(h+f,c+d);break;case"H":h=e[1],t.lineTo(h+f,c+d);break;case"v":c+=e[1],t.lineTo(h+f,c+d);break;case"V":c=e[1],t.lineTo(h+f,c+d);break;case"m":h+=e[1],c+=e[2],n=h,a=c,t.moveTo(h+f,c+d);break;case"M":h=e[1],c=e[2],n=h,a=c,t.moveTo(h+f,c+d);break;case"c":i=h+e[5],r=c+e[6],l=h+e[3],u=c+e[4],t.bezierCurveTo(h+e[1]+f,c+e[2]+d,l+f,u+d,i+f,r+d),h=i,c=r;break;case"C":h=e[5],c=e[6],l=e[3],u=e[4],t.bezierCurveTo(e[1]+f,e[2]+d,l+f,u+d,h+f,c+d);break;case"s":i=h+e[3],r=c+e[4],null===s[0].match(/[CcSs]/)?(l=h,u=c):(l=2*h-l,u=2*c-u),t.bezierCurveTo(l+f,u+d,h+e[1]+f,c+e[2]+d,i+f,r+d),l=h+e[1],u=c+e[2],h=i,c=r;break;case"S":i=e[3],r=e[4],null===s[0].match(/[CcSs]/)?(l=h,u=c):(l=2*h-l,u=2*c-u),t.bezierCurveTo(l+f,u+d,e[1]+f,e[2]+d,i+f,r+d),h=i,c=r,l=e[1],u=e[2];break;case"q":i=h+e[3],r=c+e[4],l=h+e[1],u=c+e[2],t.quadraticCurveTo(l+f,u+d,i+f,r+d),h=i,c=r;break;case"Q":i=e[3],r=e[4],t.quadraticCurveTo(e[1]+f,e[2]+d,i+f,r+d),h=i,c=r,l=e[1],u=e[2];break;case"t":i=h+e[1],r=c+e[2],null===s[0].match(/[QqTt]/)?(l=h,u=c):(l=2*h-l,u=2*c-u),t.quadraticCurveTo(l+f,u+d,i+f,r+d),h=i,c=r;break;case"T":i=e[1],r=e[2],null===s[0].match(/[QqTt]/)?(l=h,u=c):(l=2*h-l,u=2*c-u),t.quadraticCurveTo(l+f,u+d,i+f,r+d),h=i,c=r;break;case"a":o(t,h+f,c+d,[e[1],e[2],e[3],e[4],e[5],e[6]+h+f,e[7]+c+d]),h+=e[6],c+=e[7];break;case"A":o(t,h+f,c+d,[e[1],e[2],e[3],e[4],e[5],e[6]+f,e[7]+d]),h=e[6],c=e[7];break;case"z":case"Z":h=n,c=a,t.closePath()}s=e}this._renderFill(t),this._renderStroke(t)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(t){var e=s(this.callSuper("toObject",t),{path:this.path.map(function(t){return t.slice()}),pathOffset:this.pathOffset});return this.sourcePath&&(e.sourcePath=this.sourcePath),this.transformMatrix&&(e.transformMatrix=this.transformMatrix),e},toDatalessObject:function(t){var e=this.toObject(t);return this.sourcePath&&(e.path=this.sourcePath),delete e.sourcePath,e},toSVG:function(t){for(var e=[],i=this._createBaseSVGMarkup(),r="",s=0,n=this.path.length;n>s;s++)e.push(this.path[s].join(" "));var o=e.join(" ");return this.group&&"path-group"===this.group.type||(r=" translate("+-this.pathOffset.x+", "+-this.pathOffset.y+") "),i.push("<path ",'d="',o,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),r,this.getSvgTransformMatrix(),'" stroke-linecap="round" ',"/>\n"),t?t(i.join("")):i.join("")},complexity:function(){return this.path.length},_parsePath:function(){for(var t,e,i,r,s,n=[],o=[],c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,l=0,u=this.path.length;u>l;l++){for(t=this.path[l],r=t.slice(1).trim(),o.length=0;i=c.exec(r);)o.push(i[0]);s=[t.charAt(0)];for(var f=0,d=o.length;d>f;f++)e=parseFloat(o[f]),isNaN(e)||s.push(e);var g=s[0],p=a[g.toLowerCase()],v=h[g]||g;if(s.length-1>p)for(var b=1,m=s.length;m>b;b+=p)n.push([g].concat(s.slice(b,b+p))),g=v;else n.push(s)}return n},_parseDimensions:function(){for(var t,s,n,o,a=[],h=[],c=null,l=0,u=0,f=0,d=0,g=0,p=0,v=0,b=this.path.length;b>v;++v){switch(t=this.path[v],t[0]){case"l":f+=t[1],d+=t[2],o=[];break;case"L":f=t[1],d=t[2],o=[];break;case"h":f+=t[1],o=[];break;case"H":f=t[1],o=[];break;case"v":d+=t[1],o=[];break;case"V":d=t[1],o=[];break;case"m":f+=t[1],d+=t[2],l=f,u=d,o=[];break;case"M":f=t[1],d=t[2],l=f,u=d,o=[];break;case"c":s=f+t[5],n=d+t[6],g=f+t[3],p=d+t[4],o=e.util.getBoundsOfCurve(f,d,f+t[1],d+t[2],g,p,s,n),f=s,d=n;break;case"C":f=t[5],d=t[6],g=t[3],p=t[4],o=e.util.getBoundsOfCurve(f,d,t[1],t[2],g,p,f,d);break;case"s":s=f+t[3],n=d+t[4],null===c[0].match(/[CcSs]/)?(g=f,p=d):(g=2*f-g,p=2*d-p),o=e.util.getBoundsOfCurve(f,d,g,p,f+t[1],d+t[2],s,n),g=f+t[1],p=d+t[2],f=s,d=n;break;case"S":s=t[3],n=t[4],null===c[0].match(/[CcSs]/)?(g=f,p=d):(g=2*f-g,p=2*d-p),o=e.util.getBoundsOfCurve(f,d,g,p,t[1],t[2],s,n),f=s,d=n,g=t[1],p=t[2];break;case"q":s=f+t[3],n=d+t[4],g=f+t[1],p=d+t[2],o=e.util.getBoundsOfCurve(f,d,g,p,g,p,s,n),f=s,d=n;break;case"Q":g=t[1],p=t[2],o=e.util.getBoundsOfCurve(f,d,g,p,g,p,t[3],t[4]),f=t[3],d=t[4];break;case"t":s=f+t[1],n=d+t[2],null===c[0].match(/[QqTt]/)?(g=f,p=d):(g=2*f-g,p=2*d-p),o=e.util.getBoundsOfCurve(f,d,g,p,g,p,s,n),f=s,d=n;break;case"T":s=t[1],n=t[2],null===c[0].match(/[QqTt]/)?(g=f,p=d):(g=2*f-g,p=2*d-p),o=e.util.getBoundsOfCurve(f,d,g,p,g,p,s,n),f=s,d=n;break;case"a":o=e.util.getBoundsOfArc(f,d,t[1],t[2],t[3],t[4],t[5],t[6]+f,t[7]+d),f+=t[6],d+=t[7];break;case"A":o=e.util.getBoundsOfArc(f,d,t[1],t[2],t[3],t[4],t[5],t[6],t[7]),f=t[6],d=t[7];break;case"z":case"Z":f=l,d=u}c=t,o.forEach(function(t){a.push(t.x),h.push(t.y)}),a.push(f),h.push(d)}var m=i(a),y=i(h),_=r(a),x=r(h),C=_-m,S=x-y,w={left:m,top:y,width:C,height:S};return w}}),e.Path.fromObject=function(t,i){"string"==typeof t.path?e.loadSVGFromURL(t.path,function(r){var s=r[0],n=t.path;delete t.path,e.util.object.extend(s,t),s.setSourcePath(n),i(s)}):i(new e.Path(t.path,t))},e.Path.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(["d"]),e.Path.fromElement=function(t,i,r){var n=e.parseAttributes(t,e.Path.ATTRIBUTE_NAMES);i&&i(new e.Path(n.d,s(n,r)))},void(e.Path.async=!0))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.array.invoke,s=e.Object.prototype.toObject;return e.PathGroup?void e.warn("fabric.PathGroup is already defined"):(e.PathGroup=e.util.createClass(e.Path,{type:"path-group",fill:"",initialize:function(t,e){e=e||{},this.paths=t||[];for(var i=this.paths.length;i--;)this.paths[i].group=this;e.toBeParsed&&(this.parseDimensionsFromPaths(e),delete e.toBeParsed),this.setOptions(e),this.setCoords(),e.sourcePath&&this.setSourcePath(e.sourcePath)},parseDimensionsFromPaths:function(t){for(var i,r,s,n,o,a=[],h=[],c=this.transformMatrix,l=this.paths.length;l--;){s=this.paths[l],n=s.height+s.strokeWidth,o=s.width+s.strokeWidth,i=[{x:s.left,y:s.top},{x:s.left+o,y:s.top},{x:s.left,y:s.top+n},{x:s.left+o,y:s.top+n}];for(var u=0;u<i.length;u++)r=i[u],c&&(r=e.util.transformPoint(r,c,!1)),a.push(r.x),h.push(r.y)}t.width=Math.max.apply(null,a),t.height=Math.max.apply(null,h)},render:function(t){if(this.visible){t.save(),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this.transform(t),this._setShadow(t),this.clipTo&&e.util.clipContext(this,t),t.translate(-this.width/2,-this.height/2);for(var i=0,r=this.paths.length;r>i;++i)this.paths[i].render(t,!0);this.clipTo&&t.restore(),t.restore()}},_set:function(t,e){if("fill"===t&&e&&this.isSameColor())for(var i=this.paths.length;i--;)this.paths[i]._set(t,e);return this.callSuper("_set",t,e)},toObject:function(t){var e=i(s.call(this,t),{paths:r(this.getObjects(),"toObject",t)});return this.sourcePath&&(e.sourcePath=this.sourcePath),e},toDatalessObject:function(t){var e=this.toObject(t);return this.sourcePath&&(e.paths=this.sourcePath),e},toSVG:function(t){for(var e=this.getObjects(),i=this.getPointByOrigin("left","top"),r="translate("+i.x+" "+i.y+")",s=["<g ",'style="',this.getSvgStyles(),'" ','transform="',this.getSvgTransformMatrix(),r,this.getSvgTransform(),'" ',">\n"],n=0,o=e.length;o>n;n++)s.push(e[n].toSVG(t));return s.push("</g>\n"),t?t(s.join("")):s.join("")},toString:function(){return"#<fabric.PathGroup ("+this.complexity()+"): { top: "+this.top+", left: "+this.left+" }>"},isSameColor:function(){var t=(this.getObjects()[0].get("fill")||"").toLowerCase();return this.getObjects().every(function(e){return(e.get("fill")||"").toLowerCase()===t})},complexity:function(){return this.paths.reduce(function(t,e){return t+(e&&e.complexity?e.complexity():0)},0)},getObjects:function(){return this.paths}}),e.PathGroup.fromObject=function(t,i){"string"==typeof t.paths?e.loadSVGFromURL(t.paths,function(r){var s=t.paths;delete t.paths;var n=e.util.groupSVGElements(r,t,s);i(n)}):e.util.enlivenObjects(t.paths,function(r){delete t.paths,i(new e.PathGroup(r,t))})},void(e.PathGroup.async=!0))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.array.min,s=e.util.array.max,n=e.util.array.invoke;if(!e.Group){var o={lockMovementX:!0,lockMovementY:!0,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,lockUniScaling:!0};e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",strokeWidth:0,initialize:function(t,e){e=e||{},this._objects=t||[];for(var i=this._objects.length;i--;)this._objects[i].group=this;this.originalState={},e.originX&&(this.originX=e.originX),e.originY&&(this.originY=e.originY),this._calcBounds(),this._updateObjectsCoords(),this.callSuper("initialize",e),this.setCoords(),this.saveCoords()},_updateObjectsCoords:function(){this.forEachObject(this._updateObjectCoords,this)},_updateObjectCoords:function(t){var e=t.getLeft(),i=t.getTop(),r=this.getCenterPoint();t.set({originalLeft:e,originalTop:i,left:e-r.x,top:i-r.y}),t.setCoords(),t.__origHasControls=t.hasControls,t.hasControls=!1},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(t){return this._restoreObjectsState(),t&&(this._objects.push(t),t.group=this,t._set("canvas",this.canvas)),this.forEachObject(this._setObjectActive,this),this._calcBounds(),this._updateObjectsCoords(),this},_setObjectActive:function(t){t.set("active",!0),t.group=this},removeWithUpdate:function(t){return this._moveFlippedObject(t),this._restoreObjectsState(),this.forEachObject(this._setObjectActive,this),this.remove(t),this._calcBounds(),this._updateObjectsCoords(),this},_onObjectAdded:function(t){t.group=this,t._set("canvas",this.canvas)},_onObjectRemoved:function(t){delete t.group,t.set("active",!1)},delegatedProperties:{fill:!0,opacity:!0,fontFamily:!0,fontWeight:!0,fontSize:!0,fontStyle:!0,lineHeight:!0,textDecoration:!0,textAlign:!0,backgroundColor:!0},_set:function(t,e){if(t in this.delegatedProperties||"canvas"===t)for(var i=this._objects.length;i--;)this._objects[i].set(t,e);this.callSuper("_set",t,e)},toObject:function(t){return i(this.callSuper("toObject",t),{objects:n(this._objects,"toObject",t)})},render:function(t){if(this.visible){t.save(),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this.transform(t),this.clipTo&&e.util.clipContext(this,t);for(var i=0,r=this._objects.length;r>i;i++)this._renderObject(this._objects[i],t);this.clipTo&&t.restore(),t.restore()}},_renderControls:function(t,e){this.callSuper("_renderControls",t,e);for(var i=0,r=this._objects.length;r>i;i++)this._objects[i]._renderControls(t)},_renderObject:function(t,e){if(t.visible){var i=t.hasRotatingPoint;t.hasRotatingPoint=!1,t.render(e),t.hasRotatingPoint=i}},_restoreObjectsState:function(){return this._objects.forEach(this._restoreObjectState,this),this},realizeTransform:function(t){return this._moveFlippedObject(t),this._setObjectPosition(t),t},_moveFlippedObject:function(t){var e=t.get("originX"),i=t.get("originY"),r=t.getCenterPoint();t.set({originX:"center",originY:"center",left:r.x,top:r.y}),this._toggleFlipping(t);var s=t.getPointByOrigin(e,i);return t.set({originX:e,originY:i,left:s.x,top:s.y}),this},_toggleFlipping:function(t){this.flipX&&(t.toggle("flipX"),t.set("left",-t.get("left")),t.setAngle(-t.getAngle())),this.flipY&&(t.toggle("flipY"),t.set("top",-t.get("top")),t.setAngle(-t.getAngle()))},_restoreObjectState:function(t){return this._setObjectPosition(t),t.setCoords(),t.hasControls=t.__origHasControls,delete t.__origHasControls,t.set("active",!1),t.setCoords(),delete t.group,this},_setObjectPosition:function(t){var e=this.getCenterPoint(),i=this._getRotatedLeftTop(t);t.set({angle:t.getAngle()+this.getAngle(),left:e.x+i.left,top:e.y+i.top,scaleX:t.get("scaleX")*this.get("scaleX"),scaleY:t.get("scaleY")*this.get("scaleY")})},_getRotatedLeftTop:function(t){var e=this.getAngle()*(Math.PI/180);return{left:-Math.sin(e)*t.getTop()*this.get("scaleY")+Math.cos(e)*t.getLeft()*this.get("scaleX"),top:Math.cos(e)*t.getTop()*this.get("scaleY")+Math.sin(e)*t.getLeft()*this.get("scaleX")}},destroy:function(){return this._objects.forEach(this._moveFlippedObject,this),this._restoreObjectsState()},saveCoords:function(){return this._originalLeft=this.get("left"),this._originalTop=this.get("top"),this},hasMoved:function(){return this._originalLeft!==this.get("left")||this._originalTop!==this.get("top")},setObjectsCoords:function(){return this.forEachObject(function(t){t.setCoords()}),this},_calcBounds:function(t){for(var e,i,r=[],s=[],n=["tr","br","bl","tl"],o=0,a=this._objects.length;a>o;++o){e=this._objects[o],e.setCoords();for(var h=0;h<n.length;h++)i=n[h],r.push(e.oCoords[i].x),s.push(e.oCoords[i].y)}this.set(this._getBounds(r,s,t))},_getBounds:function(t,i,n){var o=e.util.invertTransform(this.getViewportTransform()),a=e.util.transformPoint(new e.Point(r(t),r(i)),o),h=e.util.transformPoint(new e.Point(s(t),s(i)),o),c={width:h.x-a.x||0,height:h.y-a.y||0};return n||(c.left=a.x||0,c.top=a.y||0,"center"===this.originX&&(c.left+=c.width/2),"right"===this.originX&&(c.left+=c.width),"center"===this.originY&&(c.top+=c.height/2),"bottom"===this.originY&&(c.top+=c.height)),c},toSVG:function(t){for(var e=["<g ",'transform="',this.getSvgTransform(),'">\n'],i=0,r=this._objects.length;r>i;i++)e.push(this._objects[i].toSVG(t));return e.push("</g>\n"),t?t(e.join("")):e.join("")},get:function(t){if(t in o){if(this[t])return this[t];for(var e=0,i=this._objects.length;i>e;e++)if(this._objects[e][t])return!0;return!1}return t in this.delegatedProperties?this._objects[0]&&this._objects[0].get(t):this[t]}}),e.Group.fromObject=function(t,i){e.util.enlivenObjects(t.objects,function(r){delete t.objects,i&&i(new e.Group(r,t))})},e.Group.async=!0}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=fabric.util.object.extend;return t.fabric||(t.fabric={}),t.fabric.Image?void fabric.warn("fabric.Image is already defined."):(fabric.Image=fabric.util.createClass(fabric.Object,{type:"image",crossOrigin:"",alignX:"none",alignY:"none",meetOrSlice:"meet",_lastScaleX:1,_lastScaleY:1,initialize:function(t,e){e||(e={}),this.filters=[],this.resizeFilters=[],this.callSuper("initialize",e),this._initElement(t,e)},getElement:function(){return this._element},setElement:function(t,e,i){return this._element=t,this._originalElement=t,this._initConfig(i),0!==this.filters.length?this.applyFilters(e):e&&e(),this},setCrossOrigin:function(t){return this.crossOrigin=t,this._element.crossOrigin=t,this},getOriginalSize:function(){var t=this.getElement();return{width:t.width,height:t.height}},_stroke:function(t){t.save(),this._setStrokeStyles(t),t.beginPath(),t.strokeRect(-this.width/2,-this.height/2,this.width,this.height),t.closePath(),t.restore()},_renderDashedStroke:function(t){var e=-this.width/2,i=-this.height/2,r=this.width,s=this.height;t.save(),this._setStrokeStyles(t),t.beginPath(),fabric.util.drawDashedLine(t,e,i,e+r,i,this.strokeDashArray),fabric.util.drawDashedLine(t,e+r,i,e+r,i+s,this.strokeDashArray),fabric.util.drawDashedLine(t,e+r,i+s,e,i+s,this.strokeDashArray),fabric.util.drawDashedLine(t,e,i+s,e,i,this.strokeDashArray),t.closePath(),t.restore()},toObject:function(t){var i=e(this.callSuper("toObject",t),{src:this._originalElement.src||this._originalElement._src,filters:this.filters.map(function(t){return t&&t.toObject()}),crossOrigin:this.crossOrigin,alignX:this.alignX,alignY:this.alignY,meetOrSlice:this.meetOrSlice});return this.resizeFilters.length>0&&(i.resizeFilters=this.resizeFilters.map(function(t){return t&&t.toObject()})),i},toSVG:function(t){var e=[],i=-this.width/2,r=-this.height/2,s="none";if(this.group&&"path-group"===this.group.type&&(i=this.left,r=this.top),"none"!==this.alignX&&"none"!==this.alignY&&(s="x"+this.alignX+"Y"+this.alignY+" "+this.meetOrSlice),e.push('<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n','<image xlink:href="',this.getSvgSrc(),'" x="',i,'" y="',r,'" style="',this.getSvgStyles(),'" width="',this.width,'" height="',this.height,'" preserveAspectRatio="',s,'"',"></image>\n"),this.stroke||this.strokeDashArray){var n=this.fill;this.fill=null,e.push("<rect ",'x="',i,'" y="',r,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'),this.fill=n}return e.push("</g>\n"),t?t(e.join("")):e.join("")},getSrc:function(){return this.getElement()?this.getElement().src||this.getElement()._src:void 0},setSrc:function(t,e,i){fabric.util.loadImage(t,function(t){return this.setElement(t,e,i)},this,i&&i.crossOrigin)},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},clone:function(t,e){this.constructor.fromObject(this.toObject(e),t)},applyFilters:function(t,e,i,r){if(e=e||this.filters,
i=i||this._originalElement){var s=i,n=fabric.util.createCanvasElement(),o=fabric.util.createImage(),a=this;return n.width=s.width,n.height=s.height,n.getContext("2d").drawImage(s,0,0,s.width,s.height),0===e.length?(this._element=i,t&&t(),n):(e.forEach(function(t){t&&t.applyTo(n,t.scaleX||a.scaleX,t.scaleY||a.scaleY),!r&&t&&"Resize"===t.type&&(a.width*=t.scaleX,a.height*=t.scaleY)}),o.width=n.width,o.height=n.height,fabric.isLikelyNode?(o.src=n.toBuffer(void 0,fabric.Image.pngCompression),a._element=o,!r&&(a._filteredEl=o),t&&t()):(o.onload=function(){a._element=o,!r&&(a._filteredEl=o),t&&t(),o.onload=n=s=null},o.src=n.toDataURL("image/png")),n)}},_render:function(t,e){var i,r,s,n=this._findMargins();i=e?this.left:-this.width/2,r=e?this.top:-this.height/2,"slice"===this.meetOrSlice&&(t.beginPath(),t.rect(i,r,this.width,this.height),t.clip()),this.isMoving===!1&&this.resizeFilters.length&&this._needsResize()?(this._lastScaleX=this.scaleX,this._lastScaleY=this.scaleY,s=this.applyFilters(null,this.resizeFilters,this._filteredEl||this._originalElement,!0)):s=this._element,s&&t.drawImage(s,i+n.marginX,r+n.marginY,n.width,n.height),this._renderStroke(t)},_needsResize:function(){return this.scaleX!==this._lastScaleX||this.scaleY!==this._lastScaleY},_findMargins:function(){var t,e,i=this.width,r=this.height,s=0,n=0;return("none"!==this.alignX||"none"!==this.alignY)&&(t=[this.width/this._element.width,this.height/this._element.height],e="meet"===this.meetOrSlice?Math.min.apply(null,t):Math.max.apply(null,t),i=this._element.width*e,r=this._element.height*e,"Mid"===this.alignX&&(s=(this.width-i)/2),"Max"===this.alignX&&(s=this.width-i),"Mid"===this.alignY&&(n=(this.height-r)/2),"Max"===this.alignY&&(n=this.height-r)),{width:i,height:r,marginX:s,marginY:n}},_resetWidthHeight:function(){var t=this.getElement();this.set("width",t.width),this.set("height",t.height)},_initElement:function(t){this.setElement(fabric.util.getById(t)),fabric.util.addClass(this.getElement(),fabric.Image.CSS_CANVAS)},_initConfig:function(t){t||(t={}),this.setOptions(t),this._setWidthHeight(t),this._element&&this.crossOrigin&&(this._element.crossOrigin=this.crossOrigin)},_initFilters:function(t,e){t&&t.length?fabric.util.enlivenObjects(t,function(t){e&&e(t)},"fabric.Image.filters"):e&&e()},_setWidthHeight:function(t){this.width="width"in t?t.width:this.getElement()?this.getElement().width||0:0,this.height="height"in t?t.height:this.getElement()?this.getElement().height||0:0},complexity:function(){return 1}}),fabric.Image.CSS_CANVAS="canvas-img",fabric.Image.prototype.getSvgSrc=fabric.Image.prototype.getSrc,fabric.Image.fromObject=function(t,e){fabric.util.loadImage(t.src,function(i){fabric.Image.prototype._initFilters.call(t,t.filters,function(r){t.filters=r||[],fabric.Image.prototype._initFilters.call(t,t.resizeFilters,function(r){t.resizeFilters=r||[];var s=new fabric.Image(i,t);e&&e(s)})})},null,t.crossOrigin)},fabric.Image.fromURL=function(t,e,i){fabric.util.loadImage(t,function(t){e&&e(new fabric.Image(t,i))},null,i&&i.crossOrigin)},fabric.Image.ATTRIBUTE_NAMES=fabric.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href".split(" ")),fabric.Image.fromElement=function(t,i,r){var s,n,o,a=fabric.parseAttributes(t,fabric.Image.ATTRIBUTE_NAMES),h="xMidYMid",c="meet";a.preserveAspectRatio&&(o=a.preserveAspectRatio.split(" ")),o&&o.length&&(c=o.pop(),"meet"!==c&&"slice"!==c?(h=c,c="meet"):o.length&&(h=o.pop())),s="none"!==h?h.slice(1,4):"none",n="none"!==h?h.slice(5,8):"none",a.alignX=s,a.alignY=n,a.meetOrSlice=c,fabric.Image.fromURL(a["xlink:href"],i,e(r?fabric.util.object.clone(r):{},a))},fabric.Image.async=!0,void(fabric.Image.pngCompression=1))}("undefined"!=typeof exports?exports:this),fabric.util.object.extend(fabric.Object.prototype,{_getAngleValueForStraighten:function(){var t=this.getAngle()%360;return t>0?90*Math.round((t-1)/90):90*Math.round(t/90)},straighten:function(){return this.setAngle(this._getAngleValueForStraighten()),this},fxStraighten:function(t){t=t||{};var e=function(){},i=t.onComplete||e,r=t.onChange||e,s=this;return fabric.util.animate({startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(t){s.setAngle(t),r()},onComplete:function(){s.setCoords(),i()},onStart:function(){s.set("active",!1)}}),this}}),fabric.util.object.extend(fabric.StaticCanvas.prototype,{straightenObject:function(t){return t.straighten(),this.renderAll(),this},fxStraightenObject:function(t){return t.fxStraighten({onChange:this.renderAll.bind(this)}),this}}),fabric.Image.filters=fabric.Image.filters||{},fabric.Image.filters.BaseFilter=fabric.util.createClass({type:"BaseFilter",initialize:function(t){t&&this.setOptions(t)},setOptions:function(t){for(var e in t)this[e]=t[e]},toObject:function(){return{type:this.type}},toJSON:function(){return this.toObject()}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Brightness=e.util.createClass(e.Image.filters.BaseFilter,{type:"Brightness",initialize:function(t){t=t||{},this.brightness=t.brightness||0},applyTo:function(t){for(var e=t.getContext("2d"),i=e.getImageData(0,0,t.width,t.height),r=i.data,s=this.brightness,n=0,o=r.length;o>n;n+=4)r[n]+=s,r[n+1]+=s,r[n+2]+=s;e.putImageData(i,0,0)},toObject:function(){return i(this.callSuper("toObject"),{brightness:this.brightness})}}),e.Image.filters.Brightness.fromObject=function(t){return new e.Image.filters.Brightness(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Convolute=e.util.createClass(e.Image.filters.BaseFilter,{type:"Convolute",initialize:function(t){t=t||{},this.opaque=t.opaque,this.matrix=t.matrix||[0,0,0,0,1,0,0,0,0];var i=e.util.createCanvasElement();this.tmpCtx=i.getContext("2d")},_createImageData:function(t,e){return this.tmpCtx.createImageData(t,e)},applyTo:function(t){for(var e=this.matrix,i=t.getContext("2d"),r=i.getImageData(0,0,t.width,t.height),s=Math.round(Math.sqrt(e.length)),n=Math.floor(s/2),o=r.data,a=r.width,h=r.height,c=a,l=h,u=this._createImageData(c,l),f=u.data,d=this.opaque?1:0,g=0;l>g;g++)for(var p=0;c>p;p++){for(var v=g,b=p,m=4*(g*c+p),y=0,_=0,x=0,C=0,S=0;s>S;S++)for(var w=0;s>w;w++){var O=v+S-n,T=b+w-n;if(!(0>O||O>h||0>T||T>a)){var k=4*(O*a+T),j=e[S*s+w];y+=o[k]*j,_+=o[k+1]*j,x+=o[k+2]*j,C+=o[k+3]*j}}f[m]=y,f[m+1]=_,f[m+2]=x,f[m+3]=C+d*(255-C)}i.putImageData(u,0,0)},toObject:function(){return i(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),e.Image.filters.Convolute.fromObject=function(t){return new e.Image.filters.Convolute(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.GradientTransparency=e.util.createClass(e.Image.filters.BaseFilter,{type:"GradientTransparency",initialize:function(t){t=t||{},this.threshold=t.threshold||100},applyTo:function(t){for(var e=t.getContext("2d"),i=e.getImageData(0,0,t.width,t.height),r=i.data,s=this.threshold,n=r.length,o=0,a=r.length;a>o;o+=4)r[o+3]=s+255*(n-o)/n;e.putImageData(i,0,0)},toObject:function(){return i(this.callSuper("toObject"),{threshold:this.threshold})}}),e.Image.filters.GradientTransparency.fromObject=function(t){return new e.Image.filters.GradientTransparency(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Image.filters.Grayscale=e.util.createClass(e.Image.filters.BaseFilter,{type:"Grayscale",applyTo:function(t){for(var e,i=t.getContext("2d"),r=i.getImageData(0,0,t.width,t.height),s=r.data,n=r.width*r.height*4,o=0;n>o;)e=(s[o]+s[o+1]+s[o+2])/3,s[o]=e,s[o+1]=e,s[o+2]=e,o+=4;i.putImageData(r,0,0)}}),e.Image.filters.Grayscale.fromObject=function(){return new e.Image.filters.Grayscale}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Image.filters.Invert=e.util.createClass(e.Image.filters.BaseFilter,{type:"Invert",applyTo:function(t){var e,i=t.getContext("2d"),r=i.getImageData(0,0,t.width,t.height),s=r.data,n=s.length;for(e=0;n>e;e+=4)s[e]=255-s[e],s[e+1]=255-s[e+1],s[e+2]=255-s[e+2];i.putImageData(r,0,0)}}),e.Image.filters.Invert.fromObject=function(){return new e.Image.filters.Invert}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Mask=e.util.createClass(e.Image.filters.BaseFilter,{type:"Mask",initialize:function(t){t=t||{},this.mask=t.mask,this.channel=[0,1,2,3].indexOf(t.channel)>-1?t.channel:0},applyTo:function(t){if(this.mask){var i,r=t.getContext("2d"),s=r.getImageData(0,0,t.width,t.height),n=s.data,o=this.mask.getElement(),a=e.util.createCanvasElement(),h=this.channel,c=s.width*s.height*4;a.width=o.width,a.height=o.height,a.getContext("2d").drawImage(o,0,0,o.width,o.height);var l=a.getContext("2d").getImageData(0,0,o.width,o.height),u=l.data;for(i=0;c>i;i+=4)n[i+3]=u[i+h];r.putImageData(s,0,0)}},toObject:function(){return i(this.callSuper("toObject"),{mask:this.mask.toObject(),channel:this.channel})}}),e.Image.filters.Mask.fromObject=function(t,i){e.util.loadImage(t.mask.src,function(r){t.mask=new e.Image(r,t.mask),i&&i(new e.Image.filters.Mask(t))})},e.Image.filters.Mask.async=!0}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Noise=e.util.createClass(e.Image.filters.BaseFilter,{type:"Noise",initialize:function(t){t=t||{},this.noise=t.noise||0},applyTo:function(t){for(var e,i=t.getContext("2d"),r=i.getImageData(0,0,t.width,t.height),s=r.data,n=this.noise,o=0,a=s.length;a>o;o+=4)e=(.5-Math.random())*n,s[o]+=e,s[o+1]+=e,s[o+2]+=e;i.putImageData(r,0,0)},toObject:function(){return i(this.callSuper("toObject"),{noise:this.noise})}}),e.Image.filters.Noise.fromObject=function(t){return new e.Image.filters.Noise(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Pixelate=e.util.createClass(e.Image.filters.BaseFilter,{type:"Pixelate",initialize:function(t){t=t||{},this.blocksize=t.blocksize||4},applyTo:function(t){var e,i,r,s,n,o,a,h=t.getContext("2d"),c=h.getImageData(0,0,t.width,t.height),l=c.data,u=c.height,f=c.width;for(i=0;u>i;i+=this.blocksize)for(r=0;f>r;r+=this.blocksize){e=4*i*f+4*r,s=l[e],n=l[e+1],o=l[e+2],a=l[e+3];for(var d=i,g=i+this.blocksize;g>d;d++)for(var p=r,v=r+this.blocksize;v>p;p++)e=4*d*f+4*p,l[e]=s,l[e+1]=n,l[e+2]=o,l[e+3]=a}h.putImageData(c,0,0)},toObject:function(){return i(this.callSuper("toObject"),{blocksize:this.blocksize})}}),e.Image.filters.Pixelate.fromObject=function(t){return new e.Image.filters.Pixelate(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.RemoveWhite=e.util.createClass(e.Image.filters.BaseFilter,{type:"RemoveWhite",initialize:function(t){t=t||{},this.threshold=t.threshold||30,this.distance=t.distance||20},applyTo:function(t){for(var e,i,r,s=t.getContext("2d"),n=s.getImageData(0,0,t.width,t.height),o=n.data,a=this.threshold,h=this.distance,c=255-a,l=Math.abs,u=0,f=o.length;f>u;u+=4)e=o[u],i=o[u+1],r=o[u+2],e>c&&i>c&&r>c&&l(e-i)<h&&l(e-r)<h&&l(i-r)<h&&(o[u+3]=1);s.putImageData(n,0,0)},toObject:function(){return i(this.callSuper("toObject"),{threshold:this.threshold,distance:this.distance})}}),e.Image.filters.RemoveWhite.fromObject=function(t){return new e.Image.filters.RemoveWhite(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Image.filters.Sepia=e.util.createClass(e.Image.filters.BaseFilter,{type:"Sepia",applyTo:function(t){var e,i,r=t.getContext("2d"),s=r.getImageData(0,0,t.width,t.height),n=s.data,o=n.length;for(e=0;o>e;e+=4)i=.3*n[e]+.59*n[e+1]+.11*n[e+2],n[e]=i+100,n[e+1]=i+50,n[e+2]=i+255;r.putImageData(s,0,0)}}),e.Image.filters.Sepia.fromObject=function(){return new e.Image.filters.Sepia}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Image.filters.Sepia2=e.util.createClass(e.Image.filters.BaseFilter,{type:"Sepia2",applyTo:function(t){var e,i,r,s,n=t.getContext("2d"),o=n.getImageData(0,0,t.width,t.height),a=o.data,h=a.length;for(e=0;h>e;e+=4)i=a[e],r=a[e+1],s=a[e+2],a[e]=(.393*i+.769*r+.189*s)/1.351,a[e+1]=(.349*i+.686*r+.168*s)/1.203,a[e+2]=(.272*i+.534*r+.131*s)/2.14;n.putImageData(o,0,0)}}),e.Image.filters.Sepia2.fromObject=function(){return new e.Image.filters.Sepia2}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Tint=e.util.createClass(e.Image.filters.BaseFilter,{type:"Tint",initialize:function(t){t=t||{},this.color=t.color||"#000000",this.opacity="undefined"!=typeof t.opacity?t.opacity:new e.Color(this.color).getAlpha()},applyTo:function(t){var i,r,s,n,o,a,h,c,l,u=t.getContext("2d"),f=u.getImageData(0,0,t.width,t.height),d=f.data,g=d.length;for(l=new e.Color(this.color).getSource(),r=l[0]*this.opacity,s=l[1]*this.opacity,n=l[2]*this.opacity,c=1-this.opacity,i=0;g>i;i+=4)o=d[i],a=d[i+1],h=d[i+2],d[i]=r+o*c,d[i+1]=s+a*c,d[i+2]=n+h*c;u.putImageData(f,0,0)},toObject:function(){return i(this.callSuper("toObject"),{color:this.color,opacity:this.opacity})}}),e.Image.filters.Tint.fromObject=function(t){return new e.Image.filters.Tint(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Multiply=e.util.createClass(e.Image.filters.BaseFilter,{type:"Multiply",initialize:function(t){t=t||{},this.color=t.color||"#000000"},applyTo:function(t){var i,r,s=t.getContext("2d"),n=s.getImageData(0,0,t.width,t.height),o=n.data,a=o.length;for(r=new e.Color(this.color).getSource(),i=0;a>i;i+=4)o[i]*=r[0]/255,o[i+1]*=r[1]/255,o[i+2]*=r[2]/255;s.putImageData(n,0,0)},toObject:function(){return i(this.callSuper("toObject"),{color:this.color})}}),e.Image.filters.Multiply.fromObject=function(t){return new e.Image.filters.Multiply(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric;e.Image.filters.Blend=e.util.createClass({type:"Blend",initialize:function(t){t=t||{},this.color=t.color||"#000",this.image=t.image||!1,this.mode=t.mode||"multiply",this.alpha=t.alpha||1},applyTo:function(t){var i,r,s,n,o,a,h,c,l,u,f=t.getContext("2d"),d=f.getImageData(0,0,t.width,t.height),g=d.data,p=!1;if(this.image){p=!0;var v=e.util.createCanvasElement();v.width=this.image.width,v.height=this.image.height;var b=new e.StaticCanvas(v);b.add(this.image);var m=b.getContext("2d");u=m.getImageData(0,0,b.width,b.height).data}else u=new e.Color(this.color).getSource(),i=u[0]*this.alpha,r=u[1]*this.alpha,s=u[2]*this.alpha;for(var y=0,_=g.length;_>y;y+=4)switch(n=g[y],o=g[y+1],a=g[y+2],p&&(i=u[y]*this.alpha,r=u[y+1]*this.alpha,s=u[y+2]*this.alpha),this.mode){case"multiply":g[y]=n*i/255,g[y+1]=o*r/255,g[y+2]=a*s/255;break;case"screen":g[y]=1-(1-n)*(1-i),g[y+1]=1-(1-o)*(1-r),g[y+2]=1-(1-a)*(1-s);break;case"add":g[y]=Math.min(255,n+i),g[y+1]=Math.min(255,o+r),g[y+2]=Math.min(255,a+s);break;case"diff":case"difference":g[y]=Math.abs(n-i),g[y+1]=Math.abs(o-r),g[y+2]=Math.abs(a-s);break;case"subtract":h=n-i,c=o-r,l=a-s,g[y]=0>h?0:h,g[y+1]=0>c?0:c,g[y+2]=0>l?0:l;break;case"darken":g[y]=Math.min(n,i),g[y+1]=Math.min(o,r),g[y+2]=Math.min(a,s);break;case"lighten":g[y]=Math.max(n,i),g[y+1]=Math.max(o,r),g[y+2]=Math.max(a,s)}f.putImageData(d,0,0)},toObject:function(){return{color:this.color,image:this.image,mode:this.mode,alpha:this.alpha}}}),e.Image.filters.Blend.fromObject=function(t){return new e.Image.filters.Blend(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=Math.pow,r=Math.floor,s=Math.sqrt,n=Math.abs,o=Math.max,a=Math.round,h=Math.sin,c=Math.ceil;e.Image.filters.Resize=e.util.createClass(e.Image.filters.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:0,scaleY:0,lanczosLobes:3,applyTo:function(t,e,i){this.rcpScaleX=1/e,this.rcpScaleY=1/i;var r,s=t.width,n=t.height,o=a(s*e),h=a(n*i);"sliceHack"===this.resizeType&&(r=this.sliceByTwo(t,s,n,o,h)),"hermite"===this.resizeType&&(r=this.hermiteFastResize(t,s,n,o,h)),"bilinear"===this.resizeType&&(r=this.bilinearFiltering(t,s,n,o,h)),"lanczos"===this.resizeType&&(r=this.lanczosResize(t,s,n,o,h)),t.width=o,t.height=h,t.getContext("2d").putImageData(r,0,0)},sliceByTwo:function(t,i,s,n,a){var h,c=t.getContext("2d"),l=.5,u=.5,f=1,d=1,g=!1,p=!1,v=i,b=s,m=e.util.createCanvasElement(),y=m.getContext("2d");for(n=r(n),a=r(a),m.width=o(n,i),m.height=o(a,s),n>i&&(l=2,f=-1),a>s&&(u=2,d=-1),h=c.getImageData(0,0,i,s),t.width=o(n,i),t.height=o(a,s),c.putImageData(h,0,0);!g||!p;)i=v,s=b,n*f<r(v*l*f)?v=r(v*l):(v=n,g=!0),a*d<r(b*u*d)?b=r(b*u):(b=a,p=!0),h=c.getImageData(0,0,i,s),y.putImageData(h,0,0),c.clearRect(0,0,v,b),c.drawImage(m,0,0,i,s,0,0,v,b);return c.getImageData(0,0,n,a)},lanczosResize:function(t,e,o,a,l){function u(t){return function(e){if(e>t)return 0;if(e*=Math.PI,n(e)<1e-16)return 1;var i=e/t;return h(e)*h(i)/e/i}}function f(t){var h,c,u,d,g,j,A,P,E,M,I;for(T.x=(t+.5)*y,k.x=r(T.x),h=0;l>h;h++){for(T.y=(h+.5)*_,k.y=r(T.y),g=0,j=0,A=0,P=0,E=0,c=k.x-S;c<=k.x+S;c++)if(!(0>c||c>=e)){M=r(1e3*n(c-T.x)),O[M]||(O[M]={});for(var D=k.y-w;D<=k.y+w;D++)0>D||D>=o||(I=r(1e3*n(D-T.y)),O[M][I]||(O[M][I]=m(s(i(M*x,2)+i(I*C,2))/1e3)),u=O[M][I],u>0&&(d=4*(D*e+c),g+=u,j+=u*v[d],A+=u*v[d+1],P+=u*v[d+2],E+=u*v[d+3]))}d=4*(h*a+t),b[d]=j/g,b[d+1]=A/g,b[d+2]=P/g,b[d+3]=E/g}return++t<a?f(t):p}var d=t.getContext("2d"),g=d.getImageData(0,0,e,o),p=d.getImageData(0,0,a,l),v=g.data,b=p.data,m=u(this.lanczosLobes),y=this.rcpScaleX,_=this.rcpScaleY,x=2/this.rcpScaleX,C=2/this.rcpScaleY,S=c(y*this.lanczosLobes/2),w=c(_*this.lanczosLobes/2),O={},T={},k={};return f(0)},bilinearFiltering:function(t,e,i,s,n){var o,a,h,c,l,u,f,d,g,p,v,b,m,y=0,_=this.rcpScaleX,x=this.rcpScaleY,C=t.getContext("2d"),S=4*(e-1),w=C.getImageData(0,0,e,i),O=w.data,T=C.getImageData(0,0,s,n),k=T.data;for(f=0;n>f;f++)for(d=0;s>d;d++)for(l=r(_*d),u=r(x*f),g=_*d-l,p=x*f-u,m=4*(u*e+l),v=0;4>v;v++)o=O[m+v],a=O[m+4+v],h=O[m+S+v],c=O[m+S+4+v],b=o*(1-g)*(1-p)+a*g*(1-p)+h*p*(1-g)+c*g*p,k[y++]=b;return T},hermiteFastResize:function(t,e,i,o,a){for(var h=this.rcpScaleX,l=this.rcpScaleY,u=c(h/2),f=c(l/2),d=t.getContext("2d"),g=d.getImageData(0,0,e,i),p=g.data,v=d.getImageData(0,0,o,a),b=v.data,m=0;a>m;m++)for(var y=0;o>y;y++){for(var _=4*(y+m*o),x=0,C=0,S=0,w=0,O=0,T=0,k=0,j=(m+.5)*l,A=r(m*l);(m+1)*l>A;A++)for(var P=n(j-(A+.5))/f,E=(y+.5)*h,M=P*P,I=r(y*h);(y+1)*h>I;I++){var D=n(E-(I+.5))/u,L=s(M+D*D);L>1&&-1>L||(x=2*L*L*L-3*L*L+1,x>0&&(D=4*(I+A*e),k+=x*p[D+3],S+=x,p[D+3]<255&&(x=x*p[D+3]/250),w+=x*p[D],O+=x*p[D+1],T+=x*p[D+2],C+=x))}b[_]=w/C,b[_+1]=O/C,b[_+2]=T/C,b[_+3]=k/S}return v},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),e.Image.filters.Resize.fromObject=function(t){return new e.Image.filters.Resize(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.object.clone,s=e.util.toFixed,n=e.StaticCanvas.supports("setLineDash"),o=e.Object.NUM_FRACTION_DIGITS;if(e.Text)return void e.warn("fabric.Text is already defined");var a=e.Object.prototype.stateProperties.concat();a.push("fontFamily","fontWeight","fontSize","text","textDecoration","textAlign","fontStyle","lineHeight","textBackgroundColor"),e.Text=e.util.createClass(e.Object,{_dimensionAffectingProps:{fontSize:!0,fontWeight:!0,fontFamily:!0,fontStyle:!0,lineHeight:!0,stroke:!0,strokeWidth:!0,text:!0,textAlign:!0},_reNewline:/\r?\n/,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",textDecoration:"",textAlign:"left",fontStyle:"",lineHeight:1.16,textBackgroundColor:"",stateProperties:a,stroke:null,shadow:null,_fontSizeFraction:.25,_fontSizeMult:1.13,initialize:function(t,e){e=e||{},this.text=t,this.__skipDimension=!0,this.setOptions(e),this.__skipDimension=!1,this._initDimensions()},_initDimensions:function(t){if(!this.__skipDimension){t||(t=e.util.createCanvasElement().getContext("2d"),this._setTextStyles(t)),this._textLines=this.text.split(this._reNewline),this._clearCache();var i=this.textAlign;this.textAlign="left",this.width=this._getTextWidth(t),this.textAlign=i,this.height=this._getTextHeight(t)}},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_render:function(t){this.clipTo&&e.util.clipContext(this,t),this._renderTextBackground(t),this._renderText(t),this._renderTextDecoration(t),this.clipTo&&t.restore()},_renderText:function(t){t.save(),this._translateForTextAlign(t),this._setOpacity(t),this._setShadow(t),this._setupCompositeOperation(t),this._renderTextFill(t),this._renderTextStroke(t),t.restore()},_translateForTextAlign:function(t){"left"!==this.textAlign&&"justify"!==this.textAlign&&t.translate("center"===this.textAlign?this.width/2:this.width,0)},_setTextStyles:function(t){t.textBaseline="alphabetic",this.skipTextAlign||(t.textAlign=this.textAlign),t.font=this._getFontDeclaration()},_getTextHeight:function(){return this._textLines.length*this._getHeightOfLine()},_getTextWidth:function(t){for(var e=this._getLineWidth(t,0),i=1,r=this._textLines.length;r>i;i++){var s=this._getLineWidth(t,i);s>e&&(e=s)}return e},_renderChars:function(t,e,i,r,s){var n=t.slice(0,-4);if(this[n].toLive){var o=-this.width/2+this[n].offsetX||0,a=-this.height/2+this[n].offsetY||0;e.save(),e.translate(o,a),r-=o,s-=a}e[t](i,r,s),this[n].toLive&&e.restore()},_renderTextLine:function(t,e,i,r,s,n){if(s-=this.fontSize*this._fontSizeFraction,"justify"!==this.textAlign)return void this._renderChars(t,e,i,r,s,n);var o=this._getLineWidth(e,n),a=this.width;if(a>=o)for(var h=i.split(/\s+/),c=this._getWidthOfWords(e,i,n),l=a-c,u=h.length-1,f=l/u,d=0,g=0,p=h.length;p>g;g++)this._renderChars(t,e,h[g],r+d,s,n),d+=e.measureText(h[g]).width+f;else this._renderChars(t,e,i,r,s,n)},_getWidthOfWords:function(t,e){return t.measureText(e.replace(/\s+/g,"")).width},_getLeftOffset:function(){return-this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextFill:function(t){if(this.fill||this._skipFillStrokeCheck)for(var e=0,i=0,r=this._textLines.length;r>i;i++){var s=this._getHeightOfLine(t,i),n=s/this.lineHeight;this._renderTextLine("fillText",t,this._textLines[i],this._getLeftOffset(),this._getTopOffset()+e+n,i),e+=s}},_renderTextStroke:function(t){if(this.stroke&&0!==this.strokeWidth||this._skipFillStrokeCheck){var e=0;this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeDashArray&&(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),n&&t.setLineDash(this.strokeDashArray)),t.beginPath();for(var i=0,r=this._textLines.length;r>i;i++){var s=this._getHeightOfLine(t,i),o=s/this.lineHeight;this._renderTextLine("strokeText",t,this._textLines[i],this._getLeftOffset(),this._getTopOffset()+e+o,i),e+=s}t.closePath(),t.restore()}},_getHeightOfLine:function(){return this.fontSize*this._fontSizeMult*this.lineHeight},_renderTextBackground:function(t){this._renderTextBoxBackground(t),this._renderTextLinesBackground(t)},_renderTextBoxBackground:function(t){this.backgroundColor&&(t.save(),t.fillStyle=this.backgroundColor,t.fillRect(this._getLeftOffset(),this._getTopOffset(),this.width,this.height),t.restore())},_renderTextLinesBackground:function(t){var e=0,i=this._getHeightOfLine();if(this.textBackgroundColor){t.save(),t.fillStyle=this.textBackgroundColor;for(var r=0,s=this._textLines.length;s>r;r++){if(""!==this._textLines[r]){var n=this._getLineWidth(t,r),o=this._getLineLeftOffset(n);t.fillRect(this._getLeftOffset()+o,this._getTopOffset()+e,n,this.fontSize*this._fontSizeMult)}e+=i}t.restore()}},_getLineLeftOffset:function(t){return"center"===this.textAlign?(this.width-t)/2:"right"===this.textAlign?this.width-t:0},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__lineOffsets=[]},_shouldClearCache:function(){var t=!1;for(var e in this._dimensionAffectingProps)this["__"+e]!==this[e]&&(this["__"+e]=this[e],t=!0);return t},_getLineWidth:function(t,e){return this.__lineWidths[e]?this.__lineWidths[e]:(this.__lineWidths[e]=t.measureText(this._textLines[e]).width,this.__lineWidths[e])},_renderTextDecoration:function(t){function e(e){var s,n,o,a,h=0;for(s=0,n=r._textLines.length;n>s;s++){var c=r._getLineWidth(t,s),l=r._getLineLeftOffset(c),u=r._getHeightOfLine(t,s);for(o=0,a=e.length;a>o;o++)t.fillRect(r._getLeftOffset()+l,h+(r._fontSizeMult-1+e[o])*r.fontSize-i,c,r.fontSize/15);h+=u}}if(this.textDecoration){var i=this.height/2,r=this,s=[];this.textDecoration.indexOf("underline")>-1&&s.push(.85),this.textDecoration.indexOf("line-through")>-1&&s.push(.43),this.textDecoration.indexOf("overline")>-1&&s.push(-.12),s.length>0&&e(s)}},_getFontDeclaration:function(){return[e.isLikelyNode?this.fontWeight:this.fontStyle,e.isLikelyNode?this.fontStyle:this.fontWeight,this.fontSize+"px",e.isLikelyNode?'"'+this.fontFamily+'"':this.fontFamily].join(" ")},render:function(t,e){this.visible&&(t.save(),this._setTextStyles(t),this._shouldClearCache()&&this._initDimensions(t),e||this.transform(t),this._setStrokeStyles(t),this._setFillStyles(t),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this.group&&"path-group"===this.group.type&&t.translate(this.left,this.top),this._render(t),t.restore())},toObject:function(t){var e=i(this.callSuper("toObject",t),{text:this.text,fontSize:this.fontSize,fontWeight:this.fontWeight,fontFamily:this.fontFamily,fontStyle:this.fontStyle,lineHeight:this.lineHeight,textDecoration:this.textDecoration,textAlign:this.textAlign,textBackgroundColor:this.textBackgroundColor});return this.includeDefaultValues||this._removeDefaultValues(e),e},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this._getSVGLeftTopOffsets(this.ctx),r=this._getSVGTextAndBg(i.textTop,i.textLeft);return this._wrapSVGTextAndBg(e,r),t?t(e.join("")):e.join("")},_getSVGLeftTopOffsets:function(t){var e=this._getHeightOfLine(t,0),i=-this.width/2,r=0;return{textLeft:i+(this.group&&"path-group"===this.group.type?this.left:0),textTop:r+(this.group&&"path-group"===this.group.type?-this.top:0),lineTop:e}},_wrapSVGTextAndBg:function(t,e){t.push('	<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n',e.textBgRects.join(""),"		<text ",this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",this.textDecoration?'text-decoration="'+this.textDecoration+'" ':"",'style="',this.getSvgStyles(),'" >',e.textSpans.join(""),"</text>\n","	</g>\n")},_getSVGTextAndBg:function(t,e){var i=[],r=[],s=0;this._setSVGBg(r);for(var n=0,o=this._textLines.length;o>n;n++)this.textBackgroundColor&&this._setSVGTextLineBg(r,n,e,t,s),this._setSVGTextLineText(n,i,s,e,t,r),s+=this._getHeightOfLine(this.ctx,n);return{textSpans:i,textBgRects:r}},_setSVGTextLineText:function(t,i,r,n,a){var h=this.fontSize*(this._fontSizeMult-this._fontSizeFraction)-a+r-this.height/2;i.push('<tspan x="',s(n+this._getLineLeftOffset(this.__lineWidths[t]),o),'" ','y="',s(h,o),'" ',this._getFillAttributes(this.fill),">",e.util.string.escapeXml(this._textLines[t]),"</tspan>")},_setSVGTextLineBg:function(t,e,i,r,n){t.push("		<rect ",this._getFillAttributes(this.textBackgroundColor),' x="',s(i+this._getLineLeftOffset(this.__lineWidths[e]),o),'" y="',s(n-this.height/2,o),'" width="',s(this.__lineWidths[e],o),'" height="',s(this._getHeightOfLine(this.ctx,e)/this.lineHeight,o),'"></rect>\n')},_setSVGBg:function(t){this.backgroundColor&&t.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',s(-this.width/2,o),'" y="',s(-this.height/2,o),'" width="',s(this.width,o),'" height="',s(this.height,o),'"></rect>\n')},_getFillAttributes:function(t){var i=t&&"string"==typeof t?new e.Color(t):"";return i&&i.getSource()&&1!==i.getAlpha()?'opacity="'+i.getAlpha()+'" fill="'+i.setAlpha(1).toRgb()+'"':'fill="'+t+'"'},_set:function(t,e){this.callSuper("_set",t,e),t in this._dimensionAffectingProps&&(this._initDimensions(),this.setCoords())},complexity:function(){return 1}}),e.Text.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size text-decoration text-anchor".split(" ")),e.Text.DEFAULT_SVG_FONT_SIZE=16,e.Text.fromElement=function(t,i){if(!t)return null;var r=e.parseAttributes(t,e.Text.ATTRIBUTE_NAMES);i=e.util.object.extend(i?e.util.object.clone(i):{},r),i.top=i.top||0,i.left=i.left||0,"dx"in r&&(i.left+=r.dx),"dy"in r&&(i.top+=r.dy),"fontSize"in i||(i.fontSize=e.Text.DEFAULT_SVG_FONT_SIZE),i.originX||(i.originX="left");var s=t.textContent.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),n=new e.Text(s,i),o=0;return"left"===n.originX&&(o=n.getWidth()/2),"right"===n.originX&&(o=-n.getWidth()/2),n.set({left:n.getLeft()+o,top:n.getTop()-n.getHeight()/2+n.fontSize*(.18+n._fontSizeFraction)}),n},e.Text.fromObject=function(t){return new e.Text(t.text,r(t))},e.util.createAccessors(e.Text)}("undefined"!=typeof exports?exports:this),function(){var t=fabric.util.object.clone;fabric.IText=fabric.util.createClass(fabric.Text,fabric.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"#333",cursorDelay:1e3,cursorDuration:600,styles:null,caching:!0,_skipFillStrokeCheck:!1,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,_charWidthsCache:{},initialize:function(t,e){this.styles=e?e.styles||{}:{},this.callSuper("initialize",t,e),this.initBehavior()},_clearCache:function(){this.callSuper("_clearCache"),this.__maxFontHeights=[],this.__widthOfSpace=[]},isEmptyStyles:function(){if(!this.styles)return!0;var t=this.styles;for(var e in t)for(var i in t[e])for(var r in t[e][i])return!1;return!0},setSelectionStart:function(t){t=Math.max(t,0),this.selectionStart!==t&&(this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this}),this.selectionStart=t),this._updateTextarea()},setSelectionEnd:function(t){t=Math.min(t,this.text.length),this.selectionEnd!==t&&(this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this}),this.selectionEnd=t),this._updateTextarea()},getSelectionStyles:function(t,e){if(2===arguments.length){for(var i=[],r=t;e>r;r++)i.push(this.getSelectionStyles(r));return i}var s=this.get2DCursorLocation(t);return this.styles[s.lineIndex]?this.styles[s.lineIndex][s.charIndex]||{}:{}},setSelectionStyles:function(t){if(this.selectionStart===this.selectionEnd)this._extendStyles(this.selectionStart,t);else for(var e=this.selectionStart;e<this.selectionEnd;e++)this._extendStyles(e,t);return this._clearCache(),this},_extendStyles:function(t,e){var i=this.get2DCursorLocation(t);this.styles[i.lineIndex]||(this.styles[i.lineIndex]={}),this.styles[i.lineIndex][i.charIndex]||(this.styles[i.lineIndex][i.charIndex]={}),fabric.util.object.extend(this.styles[i.lineIndex][i.charIndex],e)},_render:function(t){this.callSuper("_render",t),this.ctx=t,this.isEditing&&this.renderCursorOrSelection()},renderCursorOrSelection:function(){if(this.active){var t,e,i=this.text.split("");this.canvas.contextTop?(e=this.canvas.contextTop,e.save(),e.transform.apply(e,this.canvas.viewportTransform),this.transform(e),this.transformMatrix&&e.transform.apply(e,this.transformMatrix)):(e=this.ctx,e.save()),this.selectionStart===this.selectionEnd?(t=this._getCursorBoundaries(i,"cursor"),this.renderCursor(t,e)):(t=this._getCursorBoundaries(i,"selection"),this.renderSelection(i,t,e)),
e.restore()}},get2DCursorLocation:function(t){"undefined"==typeof t&&(t=this.selectionStart);for(var e=this._textLines.length,i=0;e>i;i++){if(t<=this._textLines[i].length)return{lineIndex:i,charIndex:t};t-=this._textLines[i].length+1}return{lineIndex:i-1,charIndex:this._textLines[i-1].length<t?this._textLines[i-1].length:t}},getCurrentCharStyle:function(t,e){var i=this.styles[t]&&this.styles[t][0===e?0:e-1];return{fontSize:i&&i.fontSize||this.fontSize,fill:i&&i.fill||this.fill,textBackgroundColor:i&&i.textBackgroundColor||this.textBackgroundColor,textDecoration:i&&i.textDecoration||this.textDecoration,fontFamily:i&&i.fontFamily||this.fontFamily,fontWeight:i&&i.fontWeight||this.fontWeight,fontStyle:i&&i.fontStyle||this.fontStyle,stroke:i&&i.stroke||this.stroke,strokeWidth:i&&i.strokeWidth||this.strokeWidth}},getCurrentCharFontSize:function(t,e){return this.styles[t]&&this.styles[t][0===e?0:e-1]&&this.styles[t][0===e?0:e-1].fontSize||this.fontSize},getCurrentCharColor:function(t,e){return this.styles[t]&&this.styles[t][0===e?0:e-1]&&this.styles[t][0===e?0:e-1].fill||this.cursorColor},_getCursorBoundaries:function(t,e){var i=Math.round(this._getLeftOffset()),r=this._getTopOffset(),s=this._getCursorBoundariesOffsets(t,e);return{left:i,top:r,leftOffset:s.left+s.lineLeft,topOffset:s.top}},_getCursorBoundariesOffsets:function(t,e){for(var i=0,r=0,s=0,n=0,o=0,a=0;a<this.selectionStart;a++)"\n"===t[a]?(o=0,n+=this._getHeightOfLine(this.ctx,r),r++,s=0):(o+=this._getWidthOfChar(this.ctx,t[a],r,s),s++),i=this._getCachedLineOffset(r);return"cursor"===e&&(n+=(1-this._fontSizeFraction)*this._getHeightOfLine(this.ctx,r)/this.lineHeight-this.getCurrentCharFontSize(r,s)*(1-this._fontSizeFraction)),{top:n,left:o,lineLeft:i}},_getCachedLineOffset:function(t){var e=this._getLineWidth(this.ctx,t);return this.__lineOffsets[t]||(this.__lineOffsets[t]=this._getLineLeftOffset(e))},renderCursor:function(t,e){var i=this.get2DCursorLocation(),r=i.lineIndex,s=i.charIndex,n=this.getCurrentCharFontSize(r,s),o=0===r&&0===s?this._getCachedLineOffset(r):t.leftOffset;e.fillStyle=this.getCurrentCharColor(r,s),e.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,e.fillRect(t.left+o,t.top+t.topOffset,this.cursorWidth/this.scaleX,n)},renderSelection:function(t,e,i){i.fillStyle=this.selectionColor;for(var r=this.get2DCursorLocation(this.selectionStart),s=this.get2DCursorLocation(this.selectionEnd),n=r.lineIndex,o=s.lineIndex,a=n;o>=a;a++){var h=this._getCachedLineOffset(a)||0,c=this._getHeightOfLine(this.ctx,a),l=0,u=this._textLines[a];if(a===n)for(var f=0,d=u.length;d>f;f++)f>=r.charIndex&&(a!==o||f<s.charIndex)&&(l+=this._getWidthOfChar(i,u[f],a,f)),f<r.charIndex&&(h+=this._getWidthOfChar(i,u[f],a,f));else if(a>n&&o>a)l+=this._getLineWidth(i,a)||5;else if(a===o)for(var g=0,p=s.charIndex;p>g;g++)l+=this._getWidthOfChar(i,u[g],a,g);i.fillRect(e.left+h,e.top+e.topOffset,l,c),e.topOffset+=c}},_renderChars:function(t,e,i,r,s,n){if(this.isEmptyStyles())return this._renderCharsFast(t,e,i,r,s);this.skipTextAlign=!0,r-="center"===this.textAlign?this.width/2:"right"===this.textAlign?this.width:0;var o,a=this._getHeightOfLine(e,n),h=this._getCachedLineOffset(n),c="";r+=h||0,e.save(),s-=a/this.lineHeight*this._fontSizeFraction;for(var l=0,u=i.length;u>=l;l++){o=o||this.getCurrentCharStyle(n,l);var f=this.getCurrentCharStyle(n,l+1);(this._hasStyleChanged(o,f)||l===u)&&(this._renderChar(t,e,n,l-1,c,r,s,a),c="",o=f),c+=i[l]}e.restore()},_renderCharsFast:function(t,e,i,r,s){this.skipTextAlign=!1,"fillText"===t&&this.fill&&this.callSuper("_renderChars",t,e,i,r,s),"strokeText"===t&&(this.stroke&&this.strokeWidth>0||this.skipFillStrokeCheck)&&this.callSuper("_renderChars",t,e,i,r,s)},_renderChar:function(t,e,i,r,s,n,o,a){var h,c,l,u=this._fontSizeFraction*a/this.lineHeight;if(this.styles&&this.styles[i]&&(h=this.styles[i][r])){var f=h.stroke||this.stroke,d=h.fill||this.fill;e.save(),c=this._applyCharStylesGetWidth(e,s,i,r,h),l=this._getHeightOfChar(e,s,i,r),d&&e.fillText(s,n,o),f&&e.strokeText(s,n,o),this._renderCharDecoration(e,h,n,o,u,c,l),e.restore(),e.translate(c,0)}else"strokeText"===t&&this.stroke&&e[t](s,n,o),"fillText"===t&&this.fill&&e[t](s,n,o),c=this._applyCharStylesGetWidth(e,s,i,r),this._renderCharDecoration(e,null,n,o,u,c,this.fontSize),e.translate(e.measureText(s).width,0)},_hasStyleChanged:function(t,e){return t.fill!==e.fill||t.fontSize!==e.fontSize||t.textBackgroundColor!==e.textBackgroundColor||t.textDecoration!==e.textDecoration||t.fontFamily!==e.fontFamily||t.fontWeight!==e.fontWeight||t.fontStyle!==e.fontStyle||t.stroke!==e.stroke||t.strokeWidth!==e.strokeWidth},_renderCharDecoration:function(t,e,i,r,s,n,o){var a=e?e.textDecoration||this.textDecoration:this.textDecoration;a&&(a.indexOf("underline")>-1&&t.fillRect(i,r+o/10,n,o/15),a.indexOf("line-through")>-1&&t.fillRect(i,r-o*(this._fontSizeFraction+this._fontSizeMult-1)+o/15,n,o/15),a.indexOf("overline")>-1&&t.fillRect(i,r-(this._fontSizeMult-this._fontSizeFraction)*o,n,o/15))},_renderTextLine:function(t,e,i,r,s,n){this.isEmptyStyles()||(s+=this.fontSize*(this._fontSizeFraction+.03)),this.callSuper("_renderTextLine",t,e,i,r,s,n)},_renderTextDecoration:function(t){return this.isEmptyStyles()?this.callSuper("_renderTextDecoration",t):void 0},_renderTextLinesBackground:function(t){if(this.textBackgroundColor||this.styles){t.save(),this.textBackgroundColor&&(t.fillStyle=this.textBackgroundColor);for(var e=0,i=0,r=this._textLines.length;r>i;i++){var s=this._getHeightOfLine(t,i);if(""!==this._textLines[i]){var n=this._getLineWidth(t,i),o=this._getCachedLineOffset(i);if(this.textBackgroundColor&&(t.fillStyle=this.textBackgroundColor,t.fillRect(this._getLeftOffset()+o,this._getTopOffset()+e,n,s/this.lineHeight)),this.styles[i])for(var a=0,h=this._textLines[i].length;h>a;a++)if(this.styles[i]&&this.styles[i][a]&&this.styles[i][a].textBackgroundColor){var c=this._textLines[i][a];t.fillStyle=this.styles[i][a].textBackgroundColor,t.fillRect(this._getLeftOffset()+o+this._getWidthOfCharsAt(t,i,a),this._getTopOffset()+e,this._getWidthOfChar(t,c,i,a)+1,s/this.lineHeight)}e+=s}else e+=s}t.restore()}},_getCacheProp:function(t,e){return t+e.fontFamily+e.fontSize+e.fontWeight+e.fontStyle+e.shadow},_applyCharStylesGetWidth:function(e,i,r,s,n){var o=n||this.styles[r]&&this.styles[r][s];o=o?t(o):{},this._applyFontStyles(o);var a=this._getCacheProp(i,o);if(this.isEmptyStyles()&&this._charWidthsCache[a]&&this.caching)return this._charWidthsCache[a];"string"==typeof o.shadow&&(o.shadow=new fabric.Shadow(o.shadow));var h=o.fill||this.fill;return e.fillStyle=h.toLive?h.toLive(e,this):h,o.stroke&&(e.strokeStyle=o.stroke&&o.stroke.toLive?o.stroke.toLive(e,this):o.stroke),e.lineWidth=o.strokeWidth||this.strokeWidth,e.font=this._getFontDeclaration.call(o),this._setShadow.call(o,e),this.caching?(this._charWidthsCache[a]||(this._charWidthsCache[a]=e.measureText(i).width),this._charWidthsCache[a]):e.measureText(i).width},_applyFontStyles:function(t){t.fontFamily||(t.fontFamily=this.fontFamily),t.fontSize||(t.fontSize=this.fontSize),t.fontWeight||(t.fontWeight=this.fontWeight),t.fontStyle||(t.fontStyle=this.fontStyle)},_getStyleDeclaration:function(e,i){return this.styles[e]&&this.styles[e][i]?t(this.styles[e][i]):{}},_getWidthOfChar:function(t,e,i,r){if("justify"===this.textAlign&&/\s/.test(e))return this._getWidthOfSpace(t,i);var s=this._getStyleDeclaration(i,r);this._applyFontStyles(s);var n=this._getCacheProp(e,s);if(this._charWidthsCache[n]&&this.caching)return this._charWidthsCache[n];if(t){t.save();var o=this._applyCharStylesGetWidth(t,e,i,r);return t.restore(),o}},_getHeightOfChar:function(t,e,i,r){return this.styles[i]&&this.styles[i][r]?this.styles[i][r].fontSize||this.fontSize:this.fontSize},_getHeightOfCharAt:function(t,e,i){var r=this._textLines[e][i];return this._getHeightOfChar(t,r,e,i)},_getWidthOfCharsAt:function(t,e,i){var r,s,n=0;for(r=0;i>r;r++)s=this._textLines[e][r],n+=this._getWidthOfChar(t,s,e,r);return n},_getLineWidth:function(t,e){return this.__lineWidths[e]?this.__lineWidths[e]:(this.__lineWidths[e]=this._getWidthOfCharsAt(t,e,this._textLines[e].length),this.__lineWidths[e])},_getWidthOfSpace:function(t,e){if(this.__widthOfSpace[e])return this.__widthOfSpace[e];var i=this._textLines[e],r=this._getWidthOfWords(t,i,e),s=this.width-r,n=i.length-i.replace(/\s+/g,"").length,o=s/n;return this.__widthOfSpace[e]=o,o},_getWidthOfWords:function(t,e,i){for(var r=0,s=0;s<e.length;s++){var n=e[s];n.match(/\s/)||(r+=this._getWidthOfChar(t,n,i,s))}return r},_getHeightOfLine:function(t,e){if(this.__lineHeights[e])return this.__lineHeights[e];for(var i=this._textLines[e],r=this._getHeightOfChar(t,i[0],e,0),s=1,n=i.length;n>s;s++){var o=this._getHeightOfChar(t,i[s],e,s);o>r&&(r=o)}return this.__maxFontHeights[e]=r,this.__lineHeights[e]=r*this.lineHeight*this._fontSizeMult,this.__lineHeights[e]},_getTextHeight:function(t){for(var e=0,i=0,r=this._textLines.length;r>i;i++)e+=this._getHeightOfLine(t,i);return e},_renderTextBoxBackground:function(t){this.backgroundColor&&(t.save(),t.fillStyle=this.backgroundColor,t.fillRect(this._getLeftOffset(),this._getTopOffset(),this.width,this.height),t.restore())},toObject:function(e){return fabric.util.object.extend(this.callSuper("toObject",e),{styles:t(this.styles)})}}),fabric.IText.fromObject=function(e){return new fabric.IText(e.text,t(e))}}(),function(){var t=fabric.util.object.clone;fabric.util.object.extend(fabric.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation()},initSelectedHandler:function(){this.on("selected",function(){var t=this;setTimeout(function(){t.selected=!0},100)})},initAddedHandler:function(){var t=this;this.on("added",function(){this.canvas&&!this.canvas._hasITextHandlers&&(this.canvas._hasITextHandlers=!0,this._initCanvasHandlers()),t.canvas&&(t.canvas._iTextInstances=t.canvas._iTextInstances||[],t.canvas._iTextInstances.push(t))})},initRemovedHandler:function(){var t=this;this.on("removed",function(){t.canvas&&(t.canvas._iTextInstances=t.canvas._iTextInstances||[],fabric.util.removeFromArray(t.canvas._iTextInstances,t))})},_initCanvasHandlers:function(){var t=this;this.canvas.on("selection:cleared",function(){fabric.IText.prototype.exitEditingOnOthers(t.canvas)}),this.canvas.on("mouse:up",function(){t.canvas._iTextInstances&&t.canvas._iTextInstances.forEach(function(t){t.__isMousedown=!1})}),this.canvas.on("object:selected",function(){fabric.IText.prototype.exitEditingOnOthers(t.canvas)})},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(t,e,i,r){var s;return s={isAborted:!1,abort:function(){this.isAborted=!0}},t.animate("_currentCursorOpacity",e,{duration:i,onComplete:function(){s.isAborted||t[r]()},onChange:function(){t.canvas&&(t.canvas.clearContext(t.canvas.contextTop||t.ctx),t.renderCursorOrSelection())},abort:function(){return s.isAborted}}),s},_onTickComplete:function(){var t=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){t._currentTickCompleteState=t._animateCursor(t,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(t){var e=this,i=t?0:this.cursorDelay;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),this._currentCursorOpacity=1,this.canvas&&(this.canvas.clearContext(this.canvas.contextTop||this.ctx),this.renderCursorOrSelection()),this._cursorTimeout2&&clearTimeout(this._cursorTimeout2),this._cursorTimeout2=setTimeout(function(){e._tick()},i)},abortCursorAnimation:function(){this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,this.canvas&&this.canvas.clearContext(this.canvas.contextTop||this.ctx)},selectAll:function(){this.setSelectionStart(0),this.setSelectionEnd(this.text.length)},getSelectedText:function(){return this.text.slice(this.selectionStart,this.selectionEnd)},findWordBoundaryLeft:function(t){var e=0,i=t-1;if(this._reSpace.test(this.text.charAt(i)))for(;this._reSpace.test(this.text.charAt(i));)e++,i--;for(;/\S/.test(this.text.charAt(i))&&i>-1;)e++,i--;return t-e},findWordBoundaryRight:function(t){var e=0,i=t;if(this._reSpace.test(this.text.charAt(i)))for(;this._reSpace.test(this.text.charAt(i));)e++,i++;for(;/\S/.test(this.text.charAt(i))&&i<this.text.length;)e++,i++;return t+e},findLineBoundaryLeft:function(t){for(var e=0,i=t-1;!/\n/.test(this.text.charAt(i))&&i>-1;)e++,i--;return t-e},findLineBoundaryRight:function(t){for(var e=0,i=t;!/\n/.test(this.text.charAt(i))&&i<this.text.length;)e++,i++;return t+e},getNumNewLinesInSelectedText:function(){for(var t=this.getSelectedText(),e=0,i=0,r=t.length;r>i;i++)"\n"===t[i]&&e++;return e},searchWordBoundary:function(t,e){for(var i=this._reSpace.test(this.text.charAt(t))?t-1:t,r=this.text.charAt(i),s=/[ \n\.,;!\?\-]/;!s.test(r)&&i>0&&i<this.text.length;)i+=e,r=this.text.charAt(i);return s.test(r)&&"\n"!==r&&(i+=1===e?0:1),i},selectWord:function(t){var e=this.searchWordBoundary(t,-1),i=this.searchWordBoundary(t,1);this.setSelectionStart(e),this.setSelectionEnd(i)},selectLine:function(t){var e=this.findLineBoundaryLeft(t),i=this.findLineBoundaryRight(t);this.setSelectionStart(e),this.setSelectionEnd(i)},enterEditing:function(){return!this.isEditing&&this.editable?(this.canvas&&this.exitEditingOnOthers(this.canvas),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._tick(),this.fire("editing:entered"),this.canvas?(this.canvas.renderAll(),this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this):this):void 0},exitEditingOnOthers:function(t){t._iTextInstances&&t._iTextInstances.forEach(function(t){t.selected=!1,t.isEditing&&t.exitEditing()})},initMouseMoveHandler:function(){var t=this;this.canvas.on("mouse:move",function(e){if(t.__isMousedown&&t.isEditing){var i=t.getSelectionStartFromPointer(e.e);i>=t.__selectionStartOnMouseDown?(t.setSelectionStart(t.__selectionStartOnMouseDown),t.setSelectionEnd(i)):(t.setSelectionStart(i),t.setSelectionEnd(t.__selectionStartOnMouseDown))}})},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},_updateTextarea:function(){this.hiddenTextarea&&(this.hiddenTextarea.value=this.text,this.hiddenTextarea.selectionStart=this.selectionStart,this.hiddenTextarea.selectionEnd=this.selectionEnd)},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.overCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){return this.selected=!1,this.isEditing=!1,this.selectable=!0,this.selectionEnd=this.selectionStart,this.hiddenTextarea&&this.canvas&&this.hiddenTextarea.parentNode.removeChild(this.hiddenTextarea),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this.fire("editing:exited"),this.canvas&&this.canvas.fire("text:editing:exited",{target:this}),this},_removeExtraneousStyles:function(){for(var t in this.styles)this._textLines[t]||delete this.styles[t]},_removeCharsFromTo:function(t,e){for(;e!==t;)this._removeSingleCharAndStyle(t+1),e--;this.setSelectionStart(t)},_removeSingleCharAndStyle:function(t){var e="\n"===this.text[t-1],i=e?t:t-1;this.removeStyleObject(e,i),this.text=this.text.slice(0,t-1)+this.text.slice(t),this._textLines=this.text.split(this._reNewline)},insertChars:function(t,e){this.selectionEnd-this.selectionStart>1&&(this._removeCharsFromTo(this.selectionStart,this.selectionEnd),this.setSelectionEnd(this.selectionStart));var i="\n"===this.text[this.selectionStart];this.text=this.text.slice(0,this.selectionStart)+t+this.text.slice(this.selectionEnd),this.insertStyleObjects(t,i,e),this.setSelectionStart(this.selectionStart+t.length),this.setSelectionEnd(this.selectionStart),this.canvas&&this.canvas.renderAll(),this.setCoords(),this.fire("changed"),this.canvas&&this.canvas.fire("text:changed",{target:this})},insertNewlineStyleObject:function(e,i,r){this.shiftLineStyles(e,1),this.styles[e+1]||(this.styles[e+1]={});var s={},n={};if(this.styles[e]&&this.styles[e][i-1]&&(s=this.styles[e][i-1]),r)n[0]=t(s),this.styles[e+1]=n;else{for(var o in this.styles[e])parseInt(o,10)>=i&&(n[parseInt(o,10)-i]=this.styles[e][o],delete this.styles[e][o]);this.styles[e+1]=n}this._clearCache()},insertCharStyleObject:function(e,i,r){var s=this.styles[e],n=t(s);0!==i||r||(i=1);for(var o in n){var a=parseInt(o,10);a>=i&&(s[a+1]=n[a])}this.styles[e][i]=r||t(s[i-1]),this._clearCache()},insertStyleObjects:function(t,e,i){var r=this.get2DCursorLocation(),s=r.lineIndex,n=r.charIndex;this.styles[s]||(this.styles[s]={}),"\n"===t?this.insertNewlineStyleObject(s,n,e):i?this._insertStyles(this.copiedStyles):this.insertCharStyleObject(s,n)},_insertStyles:function(t){for(var e=0,i=t.length;i>e;e++){var r=this.get2DCursorLocation(this.selectionStart+e),s=r.lineIndex,n=r.charIndex;this.insertCharStyleObject(s,n,t[e])}},shiftLineStyles:function(e,i){var r=t(this.styles);for(var s in this.styles){var n=parseInt(s,10);n>e&&(this.styles[n+i]=r[n],r[n-i]||delete this.styles[n])}},removeStyleObject:function(e,i){var r=this.get2DCursorLocation(i),s=r.lineIndex,n=r.charIndex;if(e){var o=this._textLines[s-1],a=o?o.length:0;this.styles[s-1]||(this.styles[s-1]={});for(n in this.styles[s])this.styles[s-1][parseInt(n,10)+a]=this.styles[s][n];this.shiftLineStyles(s,-1)}else{var h=this.styles[s];h&&delete h[n];var c=t(h);for(var l in c){var u=parseInt(l,10);u>=n&&0!==u&&(h[u-1]=c[u],delete h[u])}}},insertNewline:function(){this.insertChars("\n")}})}(),fabric.util.object.extend(fabric.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown.bind(this))},onMouseDown:function(t){this.__newClickTime=+new Date;var e=this.canvas.getPointer(t.e);this.isTripleClick(e)?(this.fire("tripleclick",t),this._stopEvent(t.e)):this.isDoubleClick(e)&&(this.fire("dblclick",t),this._stopEvent(t.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected},isDoubleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y&&this.__lastIsEditing},isTripleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y},_stopEvent:function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()},initCursorSelectionHandlers:function(){this.initSelectedHandler(),this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},initClicks:function(){this.on("dblclick",function(t){this.selectWord(this.getSelectionStartFromPointer(t.e))}),this.on("tripleclick",function(t){this.selectLine(this.getSelectionStartFromPointer(t.e))})},initMousedownHandler:function(){this.on("mousedown",function(t){var e=this.canvas.getPointer(t.e);this.__mousedownX=e.x,this.__mousedownY=e.y,this.__isMousedown=!0,this.hiddenTextarea&&this.canvas&&this.canvas.wrapperEl.appendChild(this.hiddenTextarea),this.selected&&this.setCursorByClick(t.e),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.initDelayedCursor(!0))})},_isObjectMoved:function(t){var e=this.canvas.getPointer(t);return this.__mousedownX!==e.x||this.__mousedownY!==e.y},initMouseupHandler:function(){this.on("mouseup",function(t){this.__isMousedown=!1,this._isObjectMoved(t.e)||(this.__lastSelected&&(this.enterEditing(),this.initDelayedCursor(!0)),this.selected=!0)})},setCursorByClick:function(t){var e=this.getSelectionStartFromPointer(t);t.shiftKey?e<this.selectionStart?(this.setSelectionEnd(this.selectionStart),this.setSelectionStart(e)):this.setSelectionEnd(e):(this.setSelectionStart(e),this.setSelectionEnd(e))},_getLocalRotatedPointer:function(t){var e=this.canvas.getPointer(t),i=new fabric.Point(e.x,e.y),r=new fabric.Point(this.left,this.top),s=fabric.util.rotatePoint(i,r,fabric.util.degreesToRadians(-this.angle));return this.getLocalPointer(t,s)},getSelectionStartFromPointer:function(t){for(var e,i,r=this._getLocalRotatedPointer(t),s=0,n=0,o=0,a=0,h=0,c=this._textLines.length;c>h;h++){i=this._textLines[h],o+=this._getHeightOfLine(this.ctx,h)*this.scaleY;var l=this._getLineWidth(this.ctx,h),u=this._getLineLeftOffset(l);n=u*this.scaleX,this.flipX&&(this._textLines[h]=i.reverse().join(""));for(var f=0,d=i.length;d>f;f++){if(s=n,n+=this._getWidthOfChar(this.ctx,i[f],h,this.flipX?d-f:f)*this.scaleX,!(o<=r.y||n<=r.x))return this._getNewSelectionStartFromOffset(r,s,n,a+h,d);a++}if(r.y<o)return this._getNewSelectionStartFromOffset(r,s,n,a+h,d)}return"undefined"==typeof e?this.text.length:void 0},_getNewSelectionStartFromOffset:function(t,e,i,r,s){var n=t.x-e,o=i-t.x,a=o>n?0:1,h=r+a;return this.flipX&&(h=s-h),h>this.text.length&&(h=this.text.length),h}}),fabric.util.object.extend(fabric.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=fabric.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.style.cssText="position: fixed; bottom: 20px; left: 0px; opacity: 0; width: 0px; height: 0px; z-index: -999;",fabric.document.body.appendChild(this.hiddenTextarea),fabric.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),fabric.util.addListener(this.hiddenTextarea,"keypress",this.onKeyPress.bind(this)),fabric.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),fabric.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(fabric.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},_keysMap:{8:"removeChars",9:"exitEditing",27:"exitEditing",13:"insertNewline",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown",46:"forwardDelete"},_ctrlKeysMap:{65:"selectAll",88:"cut"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(t){if(this.isEditing){if(t.keyCode in this._keysMap)this[this._keysMap[t.keyCode]](t);else{if(!(t.keyCode in this._ctrlKeysMap&&(t.ctrlKey||t.metaKey)))return;this[this._ctrlKeysMap[t.keyCode]](t)}t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.renderAll()}},forwardDelete:function(t){this.selectionStart===this.selectionEnd&&this.moveCursorRight(t),this.removeChars(t)},copy:function(t){var e=this.getSelectedText(),i=this._getClipboardData(t);i&&i.setData("text",e),this.copiedText=e,this.copiedStyles=this.getSelectionStyles(this.selectionStart,this.selectionEnd)},paste:function(t){var e=null,i=this._getClipboardData(t);e=i?i.getData("text"):this.copiedText,e&&this.insertChars(e,!0)},cut:function(t){this.selectionStart!==this.selectionEnd&&(this.copy(),this.removeChars(t))},_getClipboardData:function(t){return t&&(t.clipboardData||fabric.window.clipboardData)},onKeyPress:function(t){!this.isEditing||t.metaKey||t.ctrlKey||(0!==t.which&&this.insertChars(String.fromCharCode(t.which)),t.stopPropagation())},getDownCursorOffset:function(t,e){var i,r,s=e?this.selectionEnd:this.selectionStart,n=this.get2DCursorLocation(s),o=n.lineIndex,a=this._textLines[o].slice(0,n.charIndex),h=this._textLines[o].slice(n.charIndex),c=this._textLines[o+1]||"";if(o===this._textLines.length-1||t.metaKey||34===t.keyCode)return this.text.length-s;var l=this._getLineWidth(this.ctx,o);r=this._getLineLeftOffset(l);for(var u=r,f=0,d=a.length;d>f;f++)i=a[f],u+=this._getWidthOfChar(this.ctx,i,o,f);var g=this._getIndexOnNextLine(n,c,u);return h.length+1+g},_getIndexOnNextLine:function(t,e,i){for(var r,s=t.lineIndex+1,n=this._getLineWidth(this.ctx,s),o=this._getLineLeftOffset(n),a=o,h=0,c=0,l=e.length;l>c;c++){var u=e[c],f=this._getWidthOfChar(this.ctx,u,s,c);if(a+=f,a>i){r=!0;var d=a-f,g=a,p=Math.abs(d-i),v=Math.abs(g-i);h=p>v?c+1:c;break}}return r||(h=e.length),h},moveCursorDown:function(t){this.abortCursorAnimation(),this._currentCursorOpacity=1;var e=this.getDownCursorOffset(t,"right"===this._selectionDirection);t.shiftKey?this.moveCursorDownWithShift(e):this.moveCursorDownWithoutShift(e),this.initDelayedCursor()},moveCursorDownWithoutShift:function(t){this._selectionDirection="right",this.setSelectionStart(this.selectionStart+t),this.setSelectionEnd(this.selectionStart)},swapSelectionPoints:function(){var t=this.selectionEnd;this.setSelectionEnd(this.selectionStart),this.setSelectionStart(t)},moveCursorDownWithShift:function(t){this.selectionEnd===this.selectionStart&&(this._selectionDirection="right"),"right"===this._selectionDirection?this.setSelectionEnd(this.selectionEnd+t):this.setSelectionStart(this.selectionStart+t),this.selectionEnd<this.selectionStart&&"left"===this._selectionDirection&&(this.swapSelectionPoints(),this._selectionDirection="right"),this.selectionEnd>this.text.length&&this.setSelectionEnd(this.text.length)},getUpCursorOffset:function(t,e){var i=e?this.selectionEnd:this.selectionStart,r=this.get2DCursorLocation(i),s=r.lineIndex;if(0===s||t.metaKey||33===t.keyCode)return i;for(var n,o=this._textLines[s].slice(0,r.charIndex),a=this._textLines[s-1]||"",h=this._getLineWidth(this.ctx,r.lineIndex),c=this._getLineLeftOffset(h),l=c,u=0,f=o.length;f>u;u++)n=o[u],l+=this._getWidthOfChar(this.ctx,n,s,u);var d=this._getIndexOnPrevLine(r,a,l);return a.length-d+o.length},_getIndexOnPrevLine:function(t,e,i){for(var r,s=t.lineIndex-1,n=this._getLineWidth(this.ctx,s),o=this._getLineLeftOffset(n),a=o,h=0,c=0,l=e.length;l>c;c++){var u=e[c],f=this._getWidthOfChar(this.ctx,u,s,c);if(a+=f,a>i){r=!0;var d=a-f,g=a,p=Math.abs(d-i),v=Math.abs(g-i);h=p>v?c:c-1;break}}return r||(h=e.length-1),h},moveCursorUp:function(t){this.abortCursorAnimation(),this._currentCursorOpacity=1;var e=this.getUpCursorOffset(t,"right"===this._selectionDirection);t.shiftKey?this.moveCursorUpWithShift(e):this.moveCursorUpWithoutShift(e),this.initDelayedCursor()},moveCursorUpWithShift:function(t){this.selectionEnd===this.selectionStart&&(this._selectionDirection="left"),"right"===this._selectionDirection?this.setSelectionEnd(this.selectionEnd-t):this.setSelectionStart(this.selectionStart-t),this.selectionEnd<this.selectionStart&&"right"===this._selectionDirection&&(this.swapSelectionPoints(),this._selectionDirection="left")},moveCursorUpWithoutShift:function(t){this.selectionStart===this.selectionEnd&&this.setSelectionStart(this.selectionStart-t),this.setSelectionEnd(this.selectionStart),this._selectionDirection="left"},moveCursorLeft:function(t){(0!==this.selectionStart||0!==this.selectionEnd)&&(this.abortCursorAnimation(),this._currentCursorOpacity=1,t.shiftKey?this.moveCursorLeftWithShift(t):this.moveCursorLeftWithoutShift(t),this.initDelayedCursor())},_move:function(t,e,i){var r="selectionStart"===e?"setSelectionStart":"setSelectionEnd";this[r](t.altKey?this["findWordBoundary"+i](this[e]):t.metaKey||35===t.keyCode||36===t.keyCode?this["findLineBoundary"+i](this[e]):this[e]+("Left"===i?-1:1))},_moveLeft:function(t,e){this._move(t,e,"Left")},_moveRight:function(t,e){this._move(t,e,"Right")},moveCursorLeftWithoutShift:function(t){this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this._moveLeft(t,"selectionStart"),this.setSelectionEnd(this.selectionStart)},moveCursorLeftWithShift:function(t){"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):(this._selectionDirection="left",this._moveLeft(t,"selectionStart"))},moveCursorRight:function(t){this.selectionStart>=this.text.length&&this.selectionEnd>=this.text.length||(this.abortCursorAnimation(),this._currentCursorOpacity=1,t.shiftKey?this.moveCursorRightWithShift(t):this.moveCursorRightWithoutShift(t),this.initDelayedCursor())},moveCursorRightWithShift:function(t){"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):(this._selectionDirection="right",this._moveRight(t,"selectionEnd"))},moveCursorRightWithoutShift:function(t){this._selectionDirection="right",this.selectionStart===this.selectionEnd?(this._moveRight(t,"selectionStart"),this.setSelectionEnd(this.selectionStart)):(this.setSelectionEnd(this.selectionEnd+this.getNumNewLinesInSelectedText()),this.setSelectionStart(this.selectionEnd))},removeChars:function(t){this.selectionStart===this.selectionEnd?this._removeCharsNearCursor(t):this._removeCharsFromTo(this.selectionStart,this.selectionEnd),this.setSelectionEnd(this.selectionStart),this._removeExtraneousStyles(),this._clearCache(),this.canvas&&this.canvas.renderAll(),this.setCoords(),this.fire("changed"),this.canvas&&this.canvas.fire("text:changed",{target:this})},_removeCharsNearCursor:function(t){if(0!==this.selectionStart)if(t.metaKey){var e=this.findLineBoundaryLeft(this.selectionStart);this._removeCharsFromTo(e,this.selectionStart),this.setSelectionStart(e)}else if(t.altKey){var i=this.findWordBoundaryLeft(this.selectionStart);this._removeCharsFromTo(i,this.selectionStart),this.setSelectionStart(i)}else this._removeSingleCharAndStyle(this.selectionStart),this.setSelectionStart(this.selectionStart-1)}}),function(){var t=fabric.util.toFixed,e=fabric.Object.NUM_FRACTION_DIGITS;fabric.util.object.extend(fabric.IText.prototype,{_setSVGTextLineText:function(t,e,i,r,s,n){this.styles[t]?this._setSVGTextLineChars(t,e,i,r,n):this.callSuper("_setSVGTextLineText",t,e,i,r,s)},_setSVGTextLineChars:function(t,e,i,r,s){for(var n=this._textLines[t],o=0,a=this._getSVGLineLeftOffset(t)-this.width/2,h=this._getSVGLineTopOffset(t),c=this._getHeightOfLine(this.ctx,t),l=0,u=n.length;u>l;l++){var f=this.styles[t][l]||{};e.push(this._createTextCharSpan(n[l],f,a,h.lineTop+h.offset,o));var d=this._getWidthOfChar(this.ctx,n[l],t,l);f.textBackgroundColor&&s.push(this._createTextCharBg(f,a,h.lineTop,c,d,o)),o+=d}},_getSVGLineLeftOffset:function(t){return fabric.util.toFixed(this._getLineLeftOffset(this.__lineWidths[t]),2)},_getSVGLineTopOffset:function(t){for(var e=0,i=0,r=0;t>r;r++)e+=this._getHeightOfLine(this.ctx,r);return i=this._getHeightOfLine(this.ctx,r),{lineTop:e,offset:(this._fontSizeMult-this._fontSizeFraction)*i/(this.lineHeight*this._fontSizeMult)}},_createTextCharBg:function(i,r,s,n,o,a){return['<rect fill="',i.textBackgroundColor,'" x="',t(r+a,e),'" y="',t(s-this.height/2,e),'" width="',t(o,e),'" height="',t(n/this.lineHeight,e),'"></rect>'].join("")},_createTextCharSpan:function(t,e,i,r,s){var n=this.getSvgStyles.call(fabric.util.object.extend({visible:!0,fill:this.fill,stroke:this.stroke,type:"text"},e));return['<tspan x="',i+s,'" y="',r-this.height/2,'" ',e.fontFamily?'font-family="'+e.fontFamily.replace(/"/g,"'")+'" ':"",e.fontSize?'font-size="'+e.fontSize+'" ':"",e.fontStyle?'font-style="'+e.fontStyle+'" ':"",e.fontWeight?'font-weight="'+e.fontWeight+'" ':"",e.textDecoration?'text-decoration="'+e.textDecoration+'" ':"",'style="',n,'">',fabric.util.string.escapeXml(t),"</tspan>"].join("");

}})}(),function(){function request(t,e,i){var r=URL.parse(t);r.port||(r.port=0===r.protocol.indexOf("https:")?443:80);var s=0===r.protocol.indexOf("https:")?HTTPS:HTTP,n=s.request({hostname:r.hostname,port:r.port,path:r.path,method:"GET"},function(t){var r="";e&&t.setEncoding(e),t.on("end",function(){i(r)}),t.on("data",function(e){200===t.statusCode&&(r+=e)})});n.on("error",function(t){fabric.log(t.errno===process.ECONNREFUSED?"ECONNREFUSED: connection refused to "+r.hostname+":"+r.port:t.message),i(null)}),n.end()}function requestFs(t,e){var i=require("fs");i.readFile(t,function(t,i){if(t)throw fabric.log(t),t;e(i)})}if("undefined"==typeof document||"undefined"==typeof window){var DOMParser=require("xmldom").DOMParser,URL=require("url"),HTTP=require("http"),HTTPS=require("https"),Canvas=require("canvas"),Image=require("canvas").Image;fabric.util.loadImage=function(t,e,i){function r(r){r?(s.src=new Buffer(r,"binary"),s._src=t,e&&e.call(i,s)):(s=null,e&&e.call(i,null,!0))}var s=new Image;t&&(t instanceof Buffer||0===t.indexOf("data"))?(s.src=s._src=t,e&&e.call(i,s)):t&&0!==t.indexOf("http")?requestFs(t,r):t?request(t,"binary",r):e&&e.call(i,t)},fabric.loadSVGFromURL=function(t,e,i){t=t.replace(/^\n\s*/,"").replace(/\?.*$/,"").trim(),0!==t.indexOf("http")?requestFs(t,function(t){fabric.loadSVGFromString(t.toString(),e,i)}):request(t,"",function(t){fabric.loadSVGFromString(t,e,i)})},fabric.loadSVGFromString=function(t,e,i){var r=(new DOMParser).parseFromString(t);fabric.parseSVGDocument(r.documentElement,function(t,i){e&&e(t,i)},i)},fabric.util.getScript=function(url,callback){request(url,"",function(body){eval(body),callback&&callback()})},fabric.Image.fromObject=function(t,e){fabric.util.loadImage(t.src,function(i){var r=new fabric.Image(i);r._initConfig(t),r._initFilters(t.filters,function(i){r.filters=i||[],r._initFilters(t.resizeFilters,function(t){r.resizeFilters=t||[],e&&e(r)})})})},fabric.createCanvasForNode=function(t,e,i,r){r=r||i;var s=fabric.document.createElement("canvas"),n=new Canvas(t||600,e||600,r);s.style={},s.width=n.width,s.height=n.height;var o=fabric.Canvas||fabric.StaticCanvas,a=new o(s,i);return a.contextContainer=n.getContext("2d"),a.nodeCanvas=n,a.Font=Canvas.Font,a},fabric.StaticCanvas.prototype.createPNGStream=function(){return this.nodeCanvas.createPNGStream()},fabric.StaticCanvas.prototype.createJPEGStream=function(t){return this.nodeCanvas.createJPEGStream(t)};var origSetWidth=fabric.StaticCanvas.prototype.setWidth;fabric.StaticCanvas.prototype.setWidth=function(t,e){return origSetWidth.call(this,t,e),this.nodeCanvas.width=t,this},fabric.Canvas&&(fabric.Canvas.prototype.setWidth=fabric.StaticCanvas.prototype.setWidth);var origSetHeight=fabric.StaticCanvas.prototype.setHeight;fabric.StaticCanvas.prototype.setHeight=function(t,e){return origSetHeight.call(this,t,e),this.nodeCanvas.height=t,this},fabric.Canvas&&(fabric.Canvas.prototype.setHeight=fabric.StaticCanvas.prototype.setHeight)}}();
'use strict';

angular.module('ImageEditor', ['ngMaterial', 'ngAnimate', 'ui.sortable', 'image.crop', 'image.text', 'image.drawing', 'image.filters', 'image.shapes', 'image.directives', 'image.basics'])

.config(['$mdThemingProvider', function($mdThemingProvider) {
    $mdThemingProvider.theme('default')
        .primaryPalette('deep-orange')
        .accentPalette('brown'); 
}])

.controller('MainController', ['$rootScope', '$scope', '$timeout', '$$rAF', '$mdBottomSheet', 'canvas', 'history', 'simpleShapes', 'filters', function($rootScope, $scope, $timeout, $$rAF, $mdBottomSheet, canvas, history, simpleShapes, filters) {

    //true after user uploads an image or create a new canvas
    $rootScope.started = false;

    //check if we're on a demo site
    $rootScope.isDemo = document.URL.indexOf('pixie.vebto.com') > -1;

    $rootScope.isIntegrationMode = false; 
    var params = location.search.substring(1).split('&');
    var values = {};
    for(var id in params){
        var key_value = params[id].split('=');
        values[key_value[0]] = key_value[1];
    }
    $rootScope.order_id =values['order_id'];
    $rootScope.product_id = values['product_id'];

    //check if we're running in integration mode
    try {
        if (window.self !== window.top) { 
            $('script', window.parent.document).each(function(i, node) {
                if (node.src.indexOf('pixie-integrate') > -1) {
                    $rootScope.isIntegrationMode = true;
                    return false;
                }
            });
        }
    } catch (e) {
        $rootScope.isIntegrationMode = false;
    }

    //get a reference to top window if we're inside iframe
    if ($rootScope.isIntegrationMode) {
        $rootScope.pixie = window.parent.Pixie;
    }

    $rootScope.getParam = function(name) {
        if ($rootScope.pixie) {
            return $rootScope.pixie.getParams()[name];
        } else if (window.PixieParams) {
            return window.PixieParams[name];
        }
    };

    canvas.start();

    //make actions panels draggable
    $('.actions-menu').draggable({
        handle: '.menu-header',
        containment: 'body'
    });

	$rootScope.canvas = canvas;
	$rootScope.history = history;
    if(values['order_id']!='' && values['product_id']!=''){
        //"/wp-content/uploads/wineshop-labels/"+$rootScope.order_id + "-" + $rootScope.product_id+".json"

        // TODO: Convert straight file load to an AJAX request?
        jQuery.getJSON("/wp-admin/admin-ajax.php", {
            action: "wineshop_label_load",
            order_id: $rootScope.order_id,
            product_id: $rootScope.product_id
        })
            .done(function( data ) {
                console.log( "Existing JSON Found!" );
                $scope.history = data;
                $rootScope.history = data;
                history.load(data);
            })
            .fail(function() {
                console.log("No Existing JSON Found");
                canvas.openNew(1157, 1228);
                $rootScope.isNotLoading();
                jQuery(".btn-help").trigger("click");
                console.log("Showing Help Modal");
            });

        /*jQuery.getJSON("/wp-content/uploads/wineshop-labels/"+$rootScope.order_id + "-" + $rootScope.product_id+".json",function(data){
            $scope.history = data;
            $rootScope.history = data;
            history.load(data);

        }).fail(function(){
            canvas.openNew(1157, 1228);
        });*/

    }else{
        canvas.openNew(1157, 1228);
    }
    // console.log(canvas.fabric);

    // setTimeout(function(){
    //     if(!canvas.fabric.backgroundColor || canvas.fabric.backgroundColor==''){
    //         //canvas.fabric.backgroundColor = '#ffffff';
    //     }
    //     $rootScope.bgColor = canvas.fabric.backgroundColor;
    // }, 1000);

    $rootScope.shapes = simpleShapes;
	$rootScope.loading = false;
    $rootScope.animationEndEvent = 'webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend';
    $rootScope.transitionEndEvent = 'webkitTransitionEnd mozTransitionEnd MSTransitionEnd oatransitionend atransitionend transitionend';

    $rootScope.maxPanelHeight = $(window).height() - 120;

    $rootScope.openPanel = function(name, e) {
        if ($rootScope.activePanel === name) return;

        if(name=='canvasColor'){
            console.log(canvas);
            if(!canvas.fabric.backgroundColor || canvas.fabric.backgroundColor==''){
                canvas.fabric.setBackgroundColor('#ffffff');
                canvas.fabric.renderAll();
            }
            $rootScope.bgColor = canvas.fabric.backgroundColor;
            console.log(canvas);
            $("#cvs-bgcolor").spectrum("set", $rootScope.bgColor);
        }

        $rootScope.activePanel = name;

        var panel = $('[data-name="'+name+'"]');

        var clickRect = e.target.getBoundingClientRect();
        var panelRect = panel[0].getBoundingClientRect();

        var scaleX = Math.min(0.5, clickRect.width / panelRect.width);
        var scaleY = Math.min(0.5, clickRect.height / panelRect.height);

        panel.removeClass('transition-in').css('transform', 'translate3d(' +
            (-panelRect.left + clickRect.left + clickRect.width/2 - panelRect.width/2) + 'px,' +
            (-panelRect.top + clickRect.top + clickRect.height/2 - panelRect.height/2) + 'px,' +
            '0) scale(' + scaleX + ',' + scaleY + ')'
        );

        $$rAF(function() {
            $(panel).addClass('transition-in').css('transform', '');
        });
    };

	$rootScope.isLoading = function() {
		$timeout(function() {
			$rootScope.loading = true;
		});
	};

	$rootScope.isNotLoading = function() {
		$timeout(function() {
			$rootScope.loading = false;
		});
	};

	$rootScope.activePanel = false;
    $rootScope.activeTab   = false;

	$rootScope.keys = {
		google_fonts: 'AIzaSyDhc_8NKxXjtv69htFcUPe6A7oGSQ4om2o',
	};

	$rootScope.$watch('activePanel', function() {
		setTimeout(function () {
			$(window).resize(); 
		}, 100);
	});
    
    $rootScope.resetUI = function() {
        $timeout(function() {
            $rootScope.activePanel = null;
            $rootScope.activeTab   = 'basics';
            simpleShapes.selected  = null;
            filters.appliedFilters = [];
            $rootScope.history.all = [];
        });
    };

    //open corresponding tab in left panel when user selects an object
    canvas.fabric.on('object:selected', function(e) {
        if (e.target.name == 'text') {
            $rootScope.activeTab = 'text';
        } else if (e.target.name == 'sticker' && $rootScope.activeTab !== 'stickers') {
            $rootScope.activeTab = 'stickers';
        } else if (e.target.name && $rootScope.activeTab !== 'simple-shapes') {
            for (var i = 0; i < simpleShapes.available.length; i++) {
                var shape = simpleShapes.available[i];

                if (shape.name === e.target.name && $rootScope.activeTab !== 'simple-shapes') {
                    simpleShapes.selected = shape;
                    $rootScope.activeTab = 'simple-shapes';
                }
            }
        }

        $timeout(angular.noop);
    });

    //Close object panel when object is de-selected
    canvas.fabric.on('selection:cleared', function() {
        $timeout(angular.noop);
    });

    //deselect all objects when clicking outside canvas
    $('#viewport').on('click', function(e) {
        if (e.target.id === 'viewport') {
            console.log("viewport");
            $timeout(function() {
                canvas.fabric.deactivateAll().renderAll();
            });
        }
    });

    $scope.openBottomSheet = function(name) {
        $mdBottomSheet.show({
            template: $('#'+name+'-sheet-template').html(),
            controller: 'BottomSheetController'
        });
    }; 

    //cleanup. remove color picker containers on scope destroy.
    $scope.$on('$destroy', function() {
        $('.sp-container').remove();
    });

     $rootScope.spacify = function(text) {
        if (text) {
            var temp = text.replace( /([A-Z])/g, " $1" );
            return temp.charAt(0).toUpperCase() + temp.slice(1);
        }
     };


}])

.controller('BottomSheetController', ['$rootScope', '$scope', '$mdBottomSheet', '$mdDialog', 'simpleShapes', function($rootScope, $scope, $mdBottomSheet, $mdDialog, simpleShapes) {
    $scope.shapes = simpleShapes;

    $scope.showDialog = function($event) {
        $mdDialog.show({
            template: $('#texture-upload-dialog-template').html(),
            targetEvent: $event,
            controller: 'BottomSheetController'
        });
    }
}]);
angular.module('ImageEditor')

.factory('localStorage', function() {
	var storage = {

		/**
		 * How long (days) data will be cached in local storage.
		 * 
		 * @type {Number}
		 */
		expireAfter: 2,

		/**
		 * Retrieve value under given key from local storage.
		 * 
		 * @param  string key
		 * @return mixed
		 */
		get: function(key) {
			var value = JSON.parse(localStorage.getItem(key));
			
			if ( ! value || ! storage.isValid(value.time)) {
				return false;
			}

			return value.value;
		},

		/**
		 * Store value into browser local storage.
		 * 
		 * @param string key
		 * @param mixed value
		 */
		set: function(key, value) {
			var data = { value: value, time: new Date().getTime() };

			return localStorage.setItem(key, JSON.stringify(data));
		},

		/**
		 * Whether or not cache with given time is considered expired.
		 * 
		 * @param  string  time
		 * @return {Boolean}
		 */
		isValid: function(time) {
			var days = (new Date().getTime() - new Date(time).getTime())/(1000*60*60*24);

			return days < storage.expireAfter;
		}
	};

	return storage;
});
'use strict';

angular.module('ImageEditor').factory('settings', ['$rootScope', '$http', function($rootScope, $http) {

	var settings = {
        all: {},

        get: function(name) {
            return this.all[name];
        }
	}

    $http.get('config.json').success(function(data) {
        settings.all = data;

        $rootScope.$emit('settings.ready');
    });

	return settings;
}]);
'use strict';

angular.module('ImageEditor')

.factory('keybinds', ['$rootScope', function($rootScope) {

    var keybinds = {

        fabric: false,

        init: function(fabric) {
            this.fabric = fabric;
            init();
        },

        destroy: function() {
            $('.canvas-container').off("keydown", processKeys, false);
        }
    };

    function init() {
        $(document).on('keydown', handleKeyDown);
    }

    function handleKeyDown(e) {
        e = e || window.event;

        if ([37, 38, 39, 40].indexOf(e.keyCode) > -1) moveObject(e);
        if (e.keyCode === 46) deleteObject();

    }

    function deleteObject() {
        var activeObject = keybinds.fabric.getActiveObject();

        if (activeObject) {
            keybinds.fabric.remove(activeObject);
            keybinds.fabric.renderAll();
        }
    }

    function moveObject(e) {
        var movementDelta = 2;

        var activeObject = keybinds.fabric.getActiveObject();
        var activeGroup = keybinds.fabric.getActiveGroup();

        if (e.keyCode === 37) {
            e.preventDefault();
            if (activeObject) {
                var a = activeObject.get('left') - movementDelta;
                activeObject.set('left', a);
            }
            else if (activeGroup) {
                var a = activeGroup.get('left') - movementDelta;
                activeGroup.set('left', a);
            }

        } else if (e.keyCode === 39) {
            e.preventDefault();
            if (activeObject) {
                var a = activeObject.get('left') + movementDelta;
                activeObject.set('left', a);
            }
            else if (activeGroup) {
                var a = activeGroup.get('left') + movementDelta;
                activeGroup.set('left', a);
            }

        } else if (e.keyCode === 38) {
            e.preventDefault();
            if (activeObject) {
                var a = activeObject.get('top') - movementDelta;
                activeObject.set('top', a);
            }
            else if (activeGroup) {
                var a = activeGroup.get('top') - movementDelta;
                activeGroup.set('top', a);
            }

        } else if (e.keyCode === 40) {
            e.preventDefault();
            if (activeObject) {
                var a = activeObject.get('top') + movementDelta;
                activeObject.set('top', a);
            }
            else if (activeGroup) {
                var a = activeGroup.get('top') + movementDelta;
                activeGroup.set('top', a);
            }
        }

        if (activeObject) {
            activeObject.setCoords();
            keybinds.fabric.renderAll();
        } else if (activeGroup) {
            activeGroup.setCoords();
            keybinds.fabric.renderAll();
        }
    }

    return keybinds;
}]);
angular.module('ImageEditor')

.service('canvas', ['$rootScope', '$mdDialog', 'keybinds', function($rootScope, $mdDialog, keybinds) {

	var canvas = {

        original: {},

        //store window width and height so we don't execute
        //functions unnecessarily on resize event if they didn't change
        oldWindowDimensions: {
            width: window.innerWidth,
            height: window.innerHeight
        },

		mainImage: false,
		fabric: false,
		ctx: false,
		container: false,
		viewport: false,
		offset: false,
		element: false,

        minWidth: 50,
        minHeight: 50,

		imageStatic: {
            locked: true,
			selectable: false,
	      	evented: false,
	      	lockMovementX: true,
	      	lockMovementY: true,
	      	lockRotation: true,
	      	lockScalingX: true,
	      	lockScalingY: true,
	      	lockUniScaling: true,
	      	hasControls: false,
	      	hasBorders: false
		},

        destroy: function() {
            this.fabric.dispose();
            this.mainImage = false;
            this.fabric = false;
            this.ctx = false;
            this.container = false;
            this.viewport = false;
            this.offset = false;
            this.element = false;
            this.original = {};
            this.currentZoom = 1;
            $rootScope.editorCustomActions = {};
            $(window).off('resize');
            keybinds.destroy();
        },

		start: function(url) {
            this.element = document.getElementById('canvas');
            this.fabric = new fabric.Canvas('canvas');
            this.ctx = this.fabric.getContext('2d');
            this.container = $('.canvas-container');
            this.viewport = document.getElementById('viewport');
            $rootScope.editorCustomActions = {};

            this.fabric.selection = false; 
            this.fabric.renderOnAddRemove = false;

            if(!this.fabric.backgroundColor || this.fabric.backgroundColor==''){
                this.fabric.setBackgroundColor('#ffffff');
            }
            $rootScope.bgColor = this.fabric.backgroundColor;
            fabric.Object.prototype.borderColor = '#2196F3';
            fabric.Object.prototype.cornerColor = '#2196F3';
            fabric.Object.prototype.transparentCorners = false;

            if ( ! url) url = $rootScope.getParam('url');

            if (url) {
                this.loadMainImage(url);
                $rootScope.started = true;
            } else if ($rootScope.getParam('blankCanvasSize')) {
                var size = $rootScope.getParam('blankCanvasSize');
                this.openNew(size.width, size.height, 'newCanvas');
                $rootScope.started = true;
            }

            if ( ! $rootScope.started && ! $rootScope.isIntegrationMode && ! $rootScope.delayEditorStart) {
                /*$mdDialog.show({
                    template: $('#main-image-upload-dialog-template').html(),
                    controller: 'TopPanelController',
                    clickOutsideToClose: false
                });*/

                //$scope.createNewCanvas(500, 500)
                //canvas.openNew(500,500,"Unnamed");

                canvas.openNew(1157, 1228);
                $rootScope.started = true;
            }

            $(window).off('resize').on('resize', function(e) {
                if (canvas.oldWindowDimensions.height !== e.target.innerHeight ||
                    canvas.oldWindowDimensions.width !== e.target.innerWidth) {
                    canvas.fitToScreen();
                }

                canvas.oldWindowDimensions.width = e.target.innerWidth;
                canvas.oldWindowDimensions.height = e.target.innerHeight;
            });

            $rootScope.$emit('canvas.init');

            keybinds.init(this.fabric);

            if ($rootScope.getParam('onLoad')) {
                $rootScope.getParam('onLoad')(this.viewport, $rootScope, window); 
            }
        },

        hideModals: function() {
            $mdDialog.hide();
        },

        mergeObjects: function() {
            canvas.zoom(1);
            this.fabric.deactivateAll();
            var data = this.fabric.toDataURL();
            this.fabric.clear();
            this.loadMainImage(data);
        },

        loadFromJSON: function(design, callback) {
            canvas.fabric.loadFromJSON(design.serialized_editor_state || design.state, function() {
                canvas.fabric.forEachObject(function(obj) {

                    //reapply any filters object used to have
                    if (obj.applyFilters && obj.filters.length) {
                        obj.applyFilters(canvas.fabric.renderAll.bind(canvas.fabric));
                    }

                    //assign new reference to mainImage property
                    if (obj.name == 'mainImage') {
                        canvas.mainImage = obj;
                    }
                });

                if(!canvas.fabric.backgroundColor || canvas.fabric.backgroundColor==''){
                    canvas.fabric.setBackgroundColor('#ffffff');
                }
                $rootScope.bgColor = canvas.fabric.backgroundColor;

                if (design.width && design.height) {
                    canvas.fabric.setWidth(design.width);
                    canvas.fabric.setHeight(design.height);
                    canvas.original.height = design.height;
                    canvas.original.width = design.width;
                }

                canvas.fabric.renderAll();
                canvas.fabric.calcOffset();
                canvas.fitToScreen();
                $rootScope.$emit('history.loaded');

                callback && callback(design);
            });
        },

        /**
         * Create a new image with given dimensions.
         *
         * @param {int|string} width
         * @param {int|string} height
         * @param {string|undefined} name
         */
        openNew: function(width, height, name) {
            width = width < this.minWidth ? this.minWidth : width;
            height = height < this.minHeight ? this.minHeight : height;

            this.fabric.clear();
            this.fabric.setBackgroundColor('#ffffff');
            this.fabric.setWidth(width);
            this.fabric.setHeight(height);
            this.fabric.renderAll();
            canvas.fitToScreen();

            //save the dimensions so we can scale images opened later to them
            $rootScope.userPreset = {
                width: width,
                height: height,
                name: name
            };

            canvas.original.height = height;
            canvas.original.width = width;

            $rootScope.$emit('canvas.openedNew');
        },

        center: function(obj) {
            obj.center();

            if (canvas.zoom > 100) {
                obj.setLeft(10);
                obj.setTop(35);
            }

            obj.setCoords();
        },

        serialize: function() {
            return this.fabric.toJSON(['selectable', 'name']);
        },

		loadMainImage: function(url, height, width, dontFit, callback) {
			var object;

			fabric.util.loadImage(url, function (img) {
                //img.crossOrigin = 'anonymous';

			    object = new fabric.Image(img, canvas.imageStatic);
			    object.name = 'mainImage';

                if (width && height) {
                    object.width = width;
                    object.height = height;
                }

			    canvas.mainImage = object;

                canvas.fabric.forEachObject(function(obj) {
                    if (obj.name == 'mainImage') {
                        canvas.fabric.remove(obj);
                    }
                });
			    canvas.fabric.add(object);
			   	object.top = -0.5;
			   	object.left = -0.5;
			    object.moveTo(0);

			    canvas.fabric.setHeight(object.height);
			    canvas.fabric.setWidth(object.width);
                
                if(!canvas.fabric.backgroundColor || canvas.fabric.backgroundColor==''){
                    //canvas.fabric.setBackgroundColor('#ffffff');
                }
                $rootScope.bgColor = canvas.fabric.backgroundColor;

                canvas.original.height = object.height;
                canvas.original.width = object.width;

				if ( ! dontFit) {
                    canvas.fitToScreen();
                }

				$rootScope.$apply(function() {
					$rootScope.$emit('editor.mainImage.loaded');
				});

                if (callback) {
                    callback();
                }
			});
		},

        /**
         * Open image at given url in canvas.
         *
         * @param {string} url
         */
        openImage: function(url) {
            canvas.zoom(1);
            fabric.util.loadImage(url, function(image) {
                if ( ! image) return;

                var object = new fabric.Image(image);
                object.name = 'image';

                //use either main image or canvas dimensions as outter boundaries for scaling new image
                var maxWidth  = canvas.mainImage ? canvas.mainImage.getWidth() : canvas.fabric.getWidth(),
                    maxHeight = canvas.mainImage ? canvas.mainImage.getHeight() : canvas.fabric.getHeight();

                //if image is wider or heigher then the current canvas, we'll scale id down
                if (object.width >= maxWidth || object.height >= maxHeight) {

                    //calc new image dimensions (main image height - 10% and width - 10%)
                    var newWidth  = maxWidth - (0.1 * maxWidth),
                        newHeight = maxHeight - (0.1 * maxHeight),
                        scale     = 1 / (Math.min(newHeight / object.getHeight(), newWidth / object.getWidth()));

                    //scale newly uploaded image to the above dimesnsions
                    object.scaleX = object.scaleX * (1 / scale);
                    object.scaleY = object.scaleY * (1 / scale);
                }

                //center and render newly uploaded image on the canvas
                canvas.fabric.add(object);
                object.left = (canvas.fabric.getWidth() - object.getWidth()) / 2;
                object.top = (canvas.fabric.getHeight() - object.getHeight()) / 2;
                object.setCoords();
                canvas.fabric.setActiveObject(object);
                canvas.fabric.renderAll();

                canvas.fitToScreen();
            });
        },

        getDataURL: function(options) {
            if ( ! options) options = {};

            //ignore zoom when getting data url
            options.multiplier = 1 / canvas.currentZoom;

            return this.fabric.toDataURL(options);
        },

        currentZoom: 1,

        zoom: function(scaleFactor) {
            this.fabric.setZoom(scaleFactor);
            this.fabric.setHeight(this.original.height * scaleFactor);
            this.fabric.setWidth(this.original.width * scaleFactor);

            this.currentZoom = scaleFactor;
        },

        fitToScreen: function () {
            console.log("fitToScreen");
            var maxWidth  = canvas.viewport.offsetWidth - 40,
                maxHeight = canvas.viewport.offsetHeight - 120,
                outter    = canvas.mainImage || canvas.fabric,
            	scale     = Math.min(maxHeight / outter.getHeight(), maxWidth / outter.getWidth());

            if (outter.getHeight() > maxHeight || outter.getWidth() > maxWidth) {
                canvas.zoom(scale); 
            }
        }
	};

	return canvas;

}]);
angular.module('image.crop', [])

.service('cropper', ['$rootScope', 'cropzone', 'canvas', 'history', function($rootScope, cropzone, canvas, history) {
	
	var cropper = {

		start: function(e) {
			if (cropzone.initiated) return;
			
			cropzone.add();
			$rootScope.openPanel('crop', e);
		},

		stop: function(e) {
			cropzone.remove();
			$rootScope.activePanel = false;
		},

		crop: function() {
			if ( ! cropzone.initiated) return false;

			cropzone.hide();
		    var image = new Image();

		    image.onload = function() {
		        var fabricImage = new fabric.Image(this, canvas.imageStatic);
                fabricImage.name = 'mainImage';

		        canvas.mainImage && canvas.mainImage.remove();
                canvas.fabric.clear();
		        canvas.fabric.setWidth(Math.ceil(cropzone.rect.getWidth()));
		        canvas.fabric.setHeight(Math.ceil(cropzone.rect.getHeight()));

        		canvas.fabric.add(fabricImage);
                fabricImage.moveTo(0);
                fabricImage.center();
        		canvas.mainImage = fabricImage;
        		cropzone.remove();

                history.add('crop', 'crop');

				$rootScope.$apply(function() {
					$rootScope.activePanel = false;
				});
		    };

            canvas.zoom(1);

            $rootScope.editorCustomActions.crop = {
                left: cropzone.rect.getLeft(),
                top: cropzone.rect.getTop(),
                width: Math.ceil(cropzone.rect.getWidth()),
                height: Math.ceil(cropzone.rect.getHeight())
            };

		    image.src = canvas.fabric.toDataURL({
		        left: cropzone.rect.getLeft(),
		        top: cropzone.rect.getTop(),
		        width: Math.ceil(cropzone.rect.getWidth()),
		        height: Math.ceil(cropzone.rect.getHeight())
		    });

            canvas.original.width = Math.ceil(cropzone.rect.getWidth());
            canvas.original.height = Math.ceil(cropzone.rect.getHeight());
		}

	};

	return cropper;

}]);
angular.module('image.crop')

.service('cropzone', ['$rootScope', 'canvas', function($rootScope, canvas) {

	var cropzone = {

		rect: {},

		dragging: false,

		initiated: false,

		minHeight: 25,

		minWidth: 25,

		setWidth: function(width) {
            if ( ! width) return;

            width = parseInt(width);

			if (width < this.minWidth) {
				width = this.minWidth;
			}

			if (width > canvas.original.width) {
				width = canvas.original.width - 25;
			}

            this.rect.width = width;
			this.rect.setTop((canvas.original.height - this.rect.getHeight()) / 2);
			this.rect.setLeft((canvas.original.width - this.rect.getWidth()) / 2);
			this.rect.setCoords();
			this.drawGrid();
			this.drawOverlay();
			canvas.fabric.renderAll();
		},

		setHeight: function(height) {
            if ( ! height) return;

            height = parseInt(height);

			if (height < this.minHeight) {
				height = this.minHeight;
			}

            if (height > canvas.original.height) {
                height = canvas.original.height - 25;
            }

            this.rect.height = height;
			this.rect.setTop((canvas.original.height - this.rect.getHeight()) / 2);
			this.rect.setLeft((canvas.original.width - this.rect.getWidth()) / 2);
			this.rect.setCoords();
			this.drawGrid();
			this.drawOverlay();
			canvas.fabric.renderAll();
		},

		add: function() {
			this.drawMainZone();
			this.drawOverlay();
			this.drawGrid();
			this.attachEvents();

			canvas.fabric.renderAll();

			this.initiated = true;

			$rootScope.$emit('cropzone.added');
		},

		constrainWithinCanvas: function(object) {
		    var x = object.getLeft(), y = object.getTop();
		    var w = object.getWidth(), h = object.getHeight();
		    var maxX = canvas.original.width - w;
		    var maxY = canvas.original.height - h;

		    if (x < 0) {
		    	object.set('left', 0);
		    }
		    if (y < 0) {
		        object.set('top', 0);
			}
		    if (x > maxX) {
		        object.set('left', maxX);
		    }
		    if (y > maxY) {
		    	object.set('top', maxY);
		    }
		},

		constrainWithinCanvasOnScaling: function(object) {

		    var minX = object.getLeft();
		    var minY = object.getTop();
		    var maxX = object.getLeft() + object.getWidth();
		    var maxY = object.getTop() + object.getHeight();

		    if (minX < 0 || maxX > canvas.original.width) {
		        var lastScaleX = this.lastScaleX || 1;
		        object.setScaleX(lastScaleX);
		    }

		    if (minX < 0) {
		        object.setLeft(0);
		    }

		    if (minY < 0 || maxY > canvas.original.height) {
		        var lastScaleY = this.lastScaleY || 1;
		        object.setScaleY(lastScaleY);
		    }

		    if (minY < 0) {
		        object.setTop(0);
		    }

		    if (object.getWidth() < this.minWidth) {
		        object.width = this.minWidth;
		        object.setScaleX(1);
		    }

		    if (object.getHeight() < this.minHeight) {
		       object.height = this.minHeight;
		       object.setScaleY(1);
		    }

		    this.lastScaleX = object.getScaleX();
		    this.lastScaleY = object.getScaleY();
		},

		onMouseDown: function(event) {
			if (event.target && (event.target.name === 'cropzone' || event.target.name === 'crop.grid')) return;

			cropzone.dragging = true;

			//hide cropzone on single click on overlay
			cropzone.overlay.visible = false;
			cropzone.grid.visible = false;
			cropzone.rect.visible = false;

			//start position for drawing a cropzone
		    cropzone.rect.left = event.e.pageX - canvas.fabric._offset.left;
		    cropzone.rect.top = event.e.pageY - canvas.fabric._offset.top;

		    //make sure cropzone scale is 1 for accurate coordinates
		    cropzone.rect.scale(1);
            cropzone.overlay.scale(1);
            cropzone.grid.scale(1);
		    cropzone.mousex = event.e.pageX;
		    cropzone.mousey = event.e.pageY;

		    //prevent selection of objects while dragging
		    canvas.fabric.selection = false;

		    cropzone.drawOverlay();
		},

		onMouseMove: function(event) {
			if ( ! cropzone.dragging) return;

			var width  = event.e.pageX - cropzone.mousex,
				height = event.e.pageY - cropzone.mousey;

			//prevent cropzone going over the right edge
			if (canvas.offset.left + canvas.original.width < event.e.pageX) {
				width = (canvas.offset.left + canvas.original.width) - cropzone.mousex;
			}

			//left edge
			if (canvas.offset.left > event.e.pageX) {
				width = canvas.offset.left - cropzone.mousex;
			}

			//bottom edge
			if (canvas.offset.top + canvas.original.height < event.e.pageY) {
				height = (canvas.offset.top + canvas.original.height) - cropzone.mousey;
			}

			//top edge
			if (canvas.offset.top > event.e.pageY) {
				height = canvas.offset.top - cropzone.mousey;
			}

			cropzone.rect.width = width;
        	cropzone.rect.height = height;
        	cropzone.rect.moveTo(3);
            cropzone.rect.setCoords();
        	cropzone.drawOverlay();
	        cropzone.drawGrid();

			if ( ! cropzone.rect.visible) {
				cropzone.rect.visible = true;
				cropzone.overlay.visible = true;
				cropzone.grid.visible = true;
			}
		},

		onMouseUp: function() {
		   	cropzone.dragging = false;
		    canvas.fabric.selection = true;
		    cropzone.rect.setCoords();
            cropzone.grid.setCoords();
            cropzone.overlay.setCoords();

		    if (cropzone.rect.visible) {
		    	canvas.fabric.setActiveObject(cropzone.rect);
			}
		},

		attachEvents: function() {

			//redraw cropzone grid and overlay when cropzone is resized
			this.rect.on('moving', function() {
				cropzone.constrainWithinCanvas(cropzone.rect);
				cropzone.drawOverlay();
				cropzone.drawGrid();
			});

			this.rect.on('scaling', function(e) {
				cropzone.constrainWithinCanvasOnScaling(cropzone.rect, e);
				cropzone.drawOverlay();
				cropzone.drawGrid();
			});

			canvas.fabric.on("mouse:down", cropzone.onMouseDown);
			canvas.fabric.on("mouse:move", cropzone.onMouseMove);
			canvas.fabric.on("mouse:up", cropzone.onMouseUp);
		},

		remove: function() {
			canvas.fabric.off("mouse:down", cropzone.onMouseDown);
			canvas.fabric.off("mouse:move", cropzone.onMouseMove);
			canvas.fabric.off("mouse:up", cropzone.onMouseUp);

			canvas.fabric.remove(this.rect);
			canvas.fabric.remove(this.grid);
			canvas.fabric.remove(this.overlay);
            canvas.fabric.renderAll();
			this.initiated = false;
		},

		hide: function() {
			this.rect.visible = false;
			this.rect.hasControls = false;
			this.grid.visible = false;
			this.overlay.visible = false;
		},

		getOptimalDimensions: function () {
            var width = canvas.original.width / 2,
                height = canvas.original.height / 2,
                left = canvas.original.width / 4,
                top = canvas.original.height / 4;

			if (canvas.viewport.offsetWidth < canvas.original.width) {
				width = canvas.viewport.offsetWidth / 2;
				left = canvas.viewport.offsetWidth / 4;

			}

            if (canvas.viewport.offsetHeight < canvas.original.height) {
                height = canvas.viewport.offsetHeight / 2;
                top = canvas.viewport.offsetHeight / 4;
            }

			return {width: width, height: height, left: left, top: top};
		},

		drawMainZone: function() {
			var dimensions = this.getOptimalDimensions();

			this.rect = new fabric.Rect({
			    fill: 'transparent',
			    stroke: 'rgba(255, 255, 255, 0.6)',
			    hasBorders: false,
			    width: dimensions.width,
			    height: dimensions.height,
			    left: dimensions.left,
			    top: dimensions.top,
			    hasRotatingPoint: false,
			    name: 'cropzone',
			    cornerColor: 'rgba(255, 255, 255, 0.6)',
			    transparentCorners: false,
                ignore: true
			});

			canvas.fabric.add(this.rect);
			this.rect.moveTo(3);
			canvas.fabric.setActiveObject(cropzone.rect);
		},

		drawGrid: function() {

			if ( ! this.initiated) {
				this.line1 = new fabric.Line([], { stroke: 'rgba(255, 255, 255, 0.6)', strokeWidth: 1, selectable: false, evented: false });
				this.line2 = new fabric.Line([], { stroke: 'rgba(255, 255, 255, 0.6)', strokeWidth: 1, selectable: false, evented: false });
				this.line3 = new fabric.Line([], { stroke: 'rgba(255, 255, 255, 0.6)', strokeWidth: 1, selectable: false, evented: false });
				this.line4 = new fabric.Line([], { stroke: 'rgba(255, 255, 255, 0.6)', strokeWidth: 1, selectable: false, evented: false });
				this.grid = new fabric.Group([this.line1, this.line2, this.line3, this.line4]);
				this.grid.originY = 'left';
				this.grid.originX = 'top';
                this.grid.ignore = true;
                this.grid.selectable = false;
				canvas.fabric.add(this.grid);
		    	this.grid.moveTo(10);
			}

			this.grid.width = this.rect.getWidth();
			this.grid.height = this.rect.getHeight();
			this.grid.left = this.rect.getLeft();
			this.grid.top = this.rect.getTop();

			var width  = cropzone.rect.getWidth() / 3,
				height = cropzone.rect.getHeight() / 3;

			this.line1.set({
				x1: width,
				y1: 0,
				x2: width,
				y2: cropzone.grid.getHeight(),
			});

			this.line2.set({
				x1: width * 2,
				y1: 0,
				x2: width * 2,
				y2: cropzone.grid.getHeight()
			});

			this.line3.set({
				x1: 0,
				y1: height,
				x2: cropzone.grid.getWidth(),
				y2: height
			});

			this.line4.set({
				x1: 0,
				y1: height * 2,
				x2: cropzone.grid.getWidth(),
				y2: height * 2
			});

			this.constrainWithinCanvas(this.grid);
		},

		drawOverlay: function() {

	    	if ( ! this.initiated) {
	    		this.topRect = new fabric.Rect({fill: 'rgba(0,0,0,0.7)', selectable: true, evented: false});
	    		this.rightRect = new fabric.Rect({fill: 'rgba(0,0,0,0.7)', selectable: true, evented: false});
	    		this.bottomRect = new fabric.Rect({fill: 'rgba(0,0,0,0.7)', selectable: true, evented: false});
	    		this.leftRect = new fabric.Rect({fill: 'rgba(0,0,0,0.7)', selectable: true, evented: false});
	    		this.overlay = new fabric.Group([this.topRect, this.rightRect, this.bottomRect, this.leftRect]);
                this.overlay.ignore = true;
                this.overlay.name = 'grid.overlay';
				canvas.fabric.add(this.overlay);
				this.overlay.moveTo(1);
	    	}

    		this.topRect.set({
	    		left: 0,
				top: 0,
				width: canvas.original.width,
				height: this.rect.getHeight() < 0 ? this.rect.getTop() - Math.abs(this.rect.getHeight()) : this.rect.getTop(),
	    	});

	    	this.rightRect.set({
	    		left: this.rect.getWidth() < 0 ? this.rect.getLeft() : this.rect.getLeft() + this.rect.getWidth(),
				top: this.rect.getTop(),
				width: this.rect.getWidth() < 0 ? canvas.original.width - (this.rect.getLeft() + this.rect.getWidth()) - Math.abs(this.rect.getWidth()) : canvas.original.width - (this.rect.getLeft() + this.rect.getWidth()),
				height: this.rect.getHeight(),
	    	});

	    	this.bottomRect.set({
	    		left: 0,
				top: this.rect.getHeight() < 0 ? this.rect.getTop() : this.rect.getTop() + this.rect.getHeight(),
				width: canvas.original.width,
				height: this.rect.getHeight() < 0 ? canvas.original.height - (this.rect.getTop()) : canvas.original.height - (this.rect.getTop() + this.rect.getHeight()),
	    	});

	    	this.leftRect.set({
	    		left: 0,
				top: this.rect.getTop(),
				width: this.rect.getWidth() > 0 ? this.rect.getLeft() : this.rect.getLeft() - Math.abs(this.rect.getWidth()),
				height: this.rect.getHeight(),
	    	});


	    }
	};

	return cropzone;

}]);
angular.module('image.crop')

.controller('CropController', ['$scope', '$rootScope', 'cropper', 'cropzone', function($scope, $rootScope, cropper, cropzone) {

	$scope.cropper = cropper;
	$scope.cropzone = cropzone;

    $rootScope.$on('tab.changed', function(e, newTab, oldTab) {
       if (oldTab === 'basics' && newTab !== 'basics') {
           cropper.stop();
       }
    });

    $rootScope.$watch('activePanel', function(newPanel, oldPanel) {
        if (newPanel !== 'crop' && oldPanel === 'crop') {
            cropzone.remove();
        }
    });

	$rootScope.$on('cropzone.added', function() {
		$scope.width = Math.round(cropzone.rect.width);
		$scope.height = Math.round(cropzone.rect.height);
	});
}]);
angular.module('image.basics', [])

.controller('RotateController', ['$scope', '$rootScope', 'canvas', 'history', function($scope, $rootScope, canvas, history) {

        $scope.angle = 0;

        $scope.startRotator = function($event) {
            history.add('rotate-original-state', 'backup', true);
            $scope.openPanel('rotate', $event);
        };

        $scope.applyRotation = function() {
            $rootScope.activePanel = false;
            history.add('rotation', 'rotate-right');
        };

        $scope.cancel = function() {
            history.load('rotate-original-state');
            $rootScope.activePanel = false;
            $scope.angle = 0;
        };

        //rotate properly by scaling canvas to new height after rotating main image by 90 degrees
        $scope.rotateProper = function(originalAngle) {
            canvas.zoom(1);
            var angle = (canvas.mainImage.getAngle() + originalAngle) % 360;

            var height = Math.abs(canvas.mainImage.getWidth()*(Math.sin(angle*Math.PI/180)))+Math.abs(canvas.mainImage.getHeight()*(Math.cos(angle*Math.PI/180))),
                width = Math.abs(canvas.mainImage.getHeight()*(Math.sin(angle*Math.PI/180)))+Math.abs(canvas.mainImage.getWidth()*(Math.cos(angle*Math.PI/180)));

            canvas.fabric.setWidth(width * canvas.currentZoom);
            canvas.fabric.setHeight(height * canvas.currentZoom);
            canvas.original.height = height;
            canvas.original.width  = width;
            canvas.mainImage.center();

            canvas.fabric.forEachObject(function(obj) {
                obj.rotate((obj.getAngle() + originalAngle) % 360);
                obj.setCoords();
            });

            $rootScope.editorCustomActions.rotate = originalAngle;
            canvas.fabric.renderAll();
            canvas.fitToScreen();
        };

        //only rotate the objects of canvas while leaving canvas width/height intact
        $scope.rotate = function(angle, direction) {
            if (angle > 360 || angle < 0) return;
            var resetOrigin = false;

            canvas.fabric.forEachObject(function(obj) {

                if (direction && direction === 'left') {
                    angle = obj.getAngle() - 90;
                } else if (direction && direction === 'right') {
                    angle = obj.getAngle() + 90;
                }

                if ((obj.originX !== 'center' || obj.originY !== 'center') && obj.centeredRotation) {
                    $scope.setOriginToCenter && $scope.setOriginToCenter(obj);
                    resetOrigin = true;
                }

                angle = angle > 360 ? 90 : angle < 0 ? 270 : angle;

                obj.setAngle(angle).setCoords();

                if (resetOrigin) {
                    $scope.setCenterToOrigin && $scope.setCenterToOrigin(obj);
                }
            });

            canvas.fitToScreen();
            canvas.fabric.renderAll();
        };

        $scope.setOriginToCenter = function (obj) {
            obj._originalOriginX = obj.originX;
            obj._originalOriginY = obj.originY;

            var center = obj.getCenterPoint();

            obj.set({
                originX: 'center',
                originY: 'center',
                left: center.x,
                top: center.y
            });
        };

        $scope.setCenterToOrigin = function (obj) {
            var originPoint = obj.translateToOriginPoint(
                obj.getCenterPoint(),
                obj._originalOriginX,
                obj._originalOriginY);

            obj.set({
                originX: obj._originalOriginX,
                originY: obj._originalOriginY,
                left: originPoint.x,
                top: originPoint.y
            });
        };
}]);
angular.module('image.basics')

.controller('CanvasBackgroundController', ['$scope', '$rootScope', 'canvas', 'history', function($scope, $rootScope, canvas, history) {

    //canvas.fabric.setBackgroundColor('#ffffff');
    //canvas.fabric.renderAll();
    $scope.setBackground = function(color) {
        canvas.fabric.setBackgroundColor(color);
        canvas.fabric.renderAll();
    };

    $scope.apply = function() {
        $rootScope.activePanel = false;
        $rootScope.bgColor = $("#cvs-bgcolor").val();
        history.add('Canvas Color', 'format-color-fill');
    };

    $scope.cancel = function() {
        $rootScope.activePanel = false;
        canvas.fabric.setBackgroundColor($rootScope.bgColor);
        canvas.fabric.renderAll();
    };
}]);
angular.module('image.basics')

.controller('ResizeController', ['$scope', '$rootScope', 'canvas', 'history', function($scope, $rootScope, canvas, history) {

    $scope.constrainProportions = true;

    $scope.percent = 100;

    $scope.startResizer = function($event) {
        $scope.width  = $scope.usePercentages ? 100 : Math.ceil(canvas.original.width);
        $scope.height = $scope.usePercentages ? 100 : Math.ceil(canvas.original.height);
        history.add('beforeResize', false, true);
        canvas.zoom(1);
        $scope.openPanel('resize', $event);
    };

    /**
     * Toggle resizing mode between percentages and pixles.
     *
     * @param {boolean} usePercentages
     */
    $scope.togglePercentages = function(usePercentages) {
        if (usePercentages) {
            $scope.width = ($scope.width / canvas.original.width) * 100;
            $scope.height = ($scope.height / canvas.original.height) * 100;
        } else {
            $scope.width = ($scope.width * canvas.original.width) / 100;
            $scope.height = ($scope.height * canvas.original.height) / 100;
        }
    };

    $scope.apply = function() {
        var currentWidth  = Math.ceil(canvas.original.width),
            currentHeight = Math.ceil(canvas.original.height),
            newWidth      = Math.ceil($scope.width),
            newHeight     = Math.ceil($scope.height);

        if ($scope.usePercentages) {
            var widthScale    = $scope.width / 100;
            var heightScale   = $scope.height / 100;
        } else {
            var widthScale    = $scope.width / canvas.original.width;
            var heightScale   = $scope.height / canvas.original.height;
        }

        if (currentWidth === newWidth && currentHeight === newHeight) return;

        resize(widthScale, heightScale);

        $rootScope.activePanel = false;
        history.add('resize', 'open-width');
        canvas.fitToScreen();
    };

    $scope.close = function() {
        $rootScope.activePanel = false;
        canvas.fitToScreen();
    };

    $scope.aspectToHeight = function(newWidth) {
        if ( ! $scope.constrainProportions) return;

        if ($scope.usePercentages) {
            $scope.height = newWidth;
        } else {
            var wRatio = parseFloat((canvas.original.width / newWidth).toPrecision(3));
            $scope.height = Math.ceil(canvas.original.height / wRatio);
        }
    };

    $scope.aspectToWidth = function(newHeight) {
        if ( ! $scope.constrainProportions) return;

        if ($scope.usePercentages) {
            $scope.width = newHeight;
        } else {
            var hRatio = parseFloat((canvas.original.height / newHeight).toPrecision(3));
            $scope.width = Math.floor(canvas.original.width / hRatio);
        }
    };

    function resize(widthScale, heightScale) {
        var newHeight = Math.round(canvas.original.height * heightScale),
            newWidth  = Math.round(canvas.original.width * widthScale);

        canvas.fabric.setHeight(newHeight);
        canvas.fabric.setWidth(newWidth);
        canvas.original.width = newWidth;
        canvas.original.height = newHeight;

        var objects = canvas.fabric.getObjects();
        for (var i in objects) {
            var scaleX = objects[i].scaleX;
            var scaleY = objects[i].scaleY;
            var left = objects[i].left;
            var top = objects[i].top;

            var tempScaleX = scaleX * widthScale;
            var tempScaleY = scaleY * heightScale;
            var tempLeft = left * widthScale;
            var tempTop = top * heightScale;

            objects[i].scaleX = tempScaleX;
            objects[i].scaleY = tempScaleY;
            objects[i].left = tempLeft;
            objects[i].top = tempTop;

            objects[i].setCoords();
        }

        canvas.fabric.renderAll();
    }
}]);
angular.module('image.basics')

.controller('RoundedCornersController', ['$scope', '$rootScope', 'canvas', 'history', function($scope, $rootScope, canvas, history) {

    $scope.radius = 50;

    $scope.startRoundedCorners = function(e) {
        if ($rootScope.activePanel === 'round') return;

        $rootScope.openPanel('round', e);

        $scope.rect = new fabric.Rect({
            width: canvas.original.width,
            height: canvas.original.height,
            rx: $scope.radius,
            ry: $scope.radius,
            opacity: 1,
            fill: 'transparent',
            name: 'rounding-rect',
            stroke: '#fff',
            strokeDashArray: [5, 5],
            selectable: false,
            evented: false,
            ignore: true
        });

        canvas.fabric.add($scope.rect);
        canvas.fabric.renderAll();
    };

    $scope.adjustPreview = function() {
        if ( ! $scope.rect) return;

        $scope.rect.set({
            rx: $scope.radius, ry: $scope.radius
        });
        canvas.fabric.renderAll();
    };

    $scope.cancel = function(leavePanel) {
        canvas.fabric.remove($scope.rect);
        $scope.rect  = false;
        $scope.radius = 50;
        canvas.fabric.renderAll();

        if ( !leavePanel) {
            $rootScope.activePanel = false;
        }
    };

    $scope.apply = function() {
        $rootScope.editorCustomActions.roundCorners = angular.copy($scope.radius);

        canvas.fabric.remove($scope.rect);
        canvas.zoom(1);

        canvas.fabric.clipTo = function(ctx) {
            $scope.rect.render(ctx);
            canvas.fabric.clipTo = false;
        };
        var data = canvas.fabric.toDataURL(); //canvas.getDataURL();
        canvas.fabric.clear();
        $scope.cancel();

        canvas.loadMainImage(data, false, false, false, function() {
            $rootScope.$apply(function() {
                history.add('Round Corners', 'panorama-wide-angle');
            });
        });
    };

    $rootScope.$on('tab.changed', function(e, newTab, oldTab) {
        if (oldTab === 'basics' && $scope.rect && newTab !== 'basics') {
            $scope.cancel();
        }
    });

    $rootScope.$watch('activePanel', function(newPanel, oldPanel) {
        if (newPanel !== 'round' && oldPanel === 'round') {
            $scope.cancel(true);
        }
    });
}]);
'use strict';

angular.module('ImageEditor')

.controller('ZoomController', ['$rootScope', '$scope', 'canvas', function($rootScope, $scope, canvas) {

    $scope.canvas = canvas;
    $scope.zoom = 1;
    $scope.maxScale = 200;
    $scope.minScale = 30;

    $rootScope.$on('editor.mainImage.loaded', function() { $scope.fitToScreen() });
    $rootScope.$on('canvas.openedNew', function() { $scope.fitToScreen() });

    $scope.$watch('canvas.currentZoom', function(newValue) {
        var canvasZoom = newValue * 100;

        if (canvasZoom !== $scope.zoom) {
            $scope.zoom = canvasZoom;
        }
    });

    $scope.fitToScreen = function () {
        $scope.zoom = canvas.currentZoom * 100;
            
        if (canvas.mainImage) {
            var oWidth = canvas.mainImage.originalState.width,
                oHeight = canvas.mainImage.originalState.height;
        } else {
            var oWidth = canvas.original.width,
                oHeight = canvas.original.height;
        }

        var maxScale = Math.min(3582 / oHeight, 5731 / oWidth) * 100,
            minScale = Math.min(141 / oHeight, 211 / oWidth) * 100;

        $scope.maxScale = Math.ceil(maxScale);
        $scope.minScale = Math.ceil(minScale);

        canvas.zoom(canvas.currentZoom);
    };

    //make sure we adjust zoom slider properly on history change
    $rootScope.$on('history.loaded', function() {
        $scope.zoom = canvas.currentScale * 100;
    });

    $scope.doZoom = function () {
        canvas.zoom($scope.zoom / 100);
    };

    $scope.getCurrentZoom = function() {
        return Math.round(canvas.currentZoom * 100);
    };
}]);




'use strict';

angular.module('ImageEditor')

.controller('TopPanelController', ['$rootScope', '$scope', '$mdDialog', '$mdToast', '$$rAF', '$timeout', '$window', 'canvas', 'history', 'saver', function($rootScope, $scope, $mdDialog, $mdToast, $$rAF, $timeout, $window, canvas, history, saver) {

    $scope.history = history;

    $scope.isDemo = $rootScope.isDemo;
    $scope.canOpenImage = false;
    $scope.canvas = canvas;
    $scope.openImageMode = 'open';

    $scope.canvasWidth = 800;
    $scope.canvasHeight = 600;

    $scope.imageName = 'image';
    $scope.imageType = 'jpeg';
    $scope.imageQuality = 8;
    
    $scope.imageName = $rootScope.order_id + "-" + $rootScope.product_id;
    $scope.objectsPanelOpen = true;
    $scope.historyPanelOpen = false;

    $scope.openUploadDialog = function($event) {
        $mdDialog.show({
            template: $('#main-image-upload-dialog-template').html(),
            targetEvent: $event,
            controller: 'TopPanelController',
            clickOutsideToClose: true,
        });
    };

    $scope.toggleRightPanel = function(name, e) {
        var panelIsOpen = $scope[name+'PanelOpen'];

        if (panelIsOpen) {
            $scope[name+'PanelOpen'] = false;
            $('#'+name).hide();
        } else {
            $scope[name+'PanelOpen'] = true;
            $('#'+name).show();
        }
    };

    $scope.transformOpen = function(name, e) {
        var panel = $('#'+name);

        panel.removeClass('transition-out transition-in').show();
        $scope.transformToClickElement(panel, e);

        $$rAF(function() {
            panel.addClass('transition-in').css('transform', '');
            e.currentTarget.blur();
        });
    };

    $scope.transformClose = function(name, e) {
        var panel = $('#'+name);

        panel.addClass('transition-out').removeClass('transition-in');
        $scope.transformToClickElement(panel, e);

        panel.one($rootScope.transitionEndEvent, function() {
            panel.hide().css('transform', '').removeClass('transition-out');
            e.currentTarget.blur();
        });
    };

    $scope.transformToClickElement = function(panel, e) {
        var clickRect = e.target.getBoundingClientRect();
        var panelRect = panel[0].getBoundingClientRect();

        var scaleX = Math.min(0.5, clickRect.width / panelRect.width);
        var scaleY = Math.min(0.5, clickRect.height / panelRect.height);

        panel.css('transform', 'translate3d(' +
            (-panelRect.left + clickRect.left + clickRect.width/2 - panelRect.width/2) + 'px,' +
            (-panelRect.top + clickRect.top + clickRect.height/2 - panelRect.height/2) + 'px,' +
            '0) scale(' + scaleX + ',' + scaleY + ')'
        );
    };

    $scope.openSaveDialog = function($event) {
        if ($rootScope.getParam('onSaveButtonClick')) {
            return $rootScope.getParam('onSaveButtonClick')();
        }

        if ($rootScope.delayEditorStart) {
            return saver.saveImage();
        }

        $mdDialog.show({
            template: $('#save-image-dialog').html(),
            targetEvent: $event,
            controller: 'TopPanelController',
            clickOutsideToClose: true,
        });
    };

    $scope.openHelp = function($event) {

        $mdDialog.show({
            template: $('#modal-help-text').html(),
            clickOutsideToClose: true,
            controller: ['$scope', '$mdDialog', function($scope, $mdDialog) {
                $scope.closeModal = $mdDialog.hide;
            }]
        });        
    };

    $scope.createNewCanvas = function(width, height) {
        canvas.openNew(width, height);
        $scope.closeUploadDialog();
        $rootScope.started = true;
        $rootScope.resetUI(); 
    };

    $scope.openSampleImage = function() {
        canvas.loadMainImage('assets/images/lotus.jpg');
        $scope.closeUploadDialog();
        $rootScope.started = true;
    };

    $scope.saveImage = function($event) {
        saver.saveImage($scope.imageType, $scope.imageQuality, $scope.imageName, $event, false);
        //$scope.saveToServer($scope.imageName, false);
    };

    $scope.saveImageClose = function($event) {
        saver.saveImage($scope.imageType, $scope.imageQuality, $scope.imageName, $event, true);
        // $timeout(function() {
        //     top.tb_remove();
        // }, 1000);
    };

    $scope.saveToServer = function(name, close){
        canvas.fabric.deactivateAll();
        //cropper.stop();

        canvas.zoom(150/canvas.original.height);
        var data_jpeg = saver.getDataUrl('jpeg', 8);

        canvas.zoom(1);            
        var data_png = saver.getDataUrl('png', 8),
            data_json = saver.getDataUrl('json', 8);
        canvas.fitToScreen();  
        $rootScope.isLoading();
        jQuery.ajax({
            url: "/wp-admin/admin-ajax.php",
            data: {
                action: 'wineshop_label_save',
                order_id: $rootScope.order_id,
                product_id: $rootScope.product_id,
                jpeg : data_jpeg,
                png : data_png,
                json : data_json
            },
            async: false,
            type: 'POST',
            success: function(res){
                console.log($rootScope.loading);
                $rootScope.isNotLoading();
                if(close){
                    $timeout(function() {

                        if (typeof top.tb_remove == 'function') {
                            top.tb_remove();
                        }

                        var event;
                        var closeEventName = "personalized-wine-designer-modal-close";
                        if (document.createEvent) {
                            event = document.createEvent("HTMLEvents");
                            event.initEvent(closeEventName, true, true);
                        } else {
                            event = document.createEventObject();
                            event.eventType = closeEventName;
                        }

                        event.eventName = closeEventName;

                        if (document.createEvent) {
                            document.dispatchEvent(event);
                            window.parent.document.dispatchEvent(event);
                        } else {
                            document.fireEvent("on" + event.eventType, event);
                            window.parent.document.fireEvent("on" + event.eventType, event);
                        }

                    }, 1000);
                }
            }
        })
    }

    $scope.showImagePreview = function(url) {
        var historyObject = false;

        try {
            historyObject = JSON.parse(url);
        } catch (e) {
            //
        }

        if (historyObject && historyObject.state) {
            $scope.$apply(function() {
                $scope.canOpenImage = false;
            });

            canvas.fabric.clear();
            history.load(historyObject);
            $scope.closeUploadDialog();
            $rootScope.started = true;
            return;
        }

        fabric.util.loadImage(url, function(image) {
            if (image) {
                $scope.$apply(function() {
                    $('.img-preview').html('').append(image);
                    $scope.canOpenImage = true;
                });
            } else {
                $scope.$apply(function() {
                    $scope.canOpenImage = false;
                });
            }
        });
    };

    $scope.openImage = function() {
        var url = $('.img-preview img').attr('src');
            
        if ( ! url || ! $scope.canOpenImage) return;

        if ((!canvas.fabric._objects.length || ! canvas.mainImage) && ! $rootScope.userPreset) {
            canvas.fabric.clear();
            canvas.loadMainImage(url);
        } else {
            canvas.openImage(url);
        }

        $scope.closeUploadDialog();
        $rootScope.started = true;
    };

    $scope.closeUploadDialog = function() {
        $scope.canUploadImage = false;
        $scope.openImageMode = 'open';
        $('.img-preview').html();
        $mdDialog.hide();
    };
}]);




'use strict';

angular.module('image.directives', [])

.directive('edTabs', ['$rootScope', function ($rootScope) {
    return {
        link: function ($scope, el, attrs) {
            var blockClicks = false;

            $('#'+attrs.edTabs).addClass('open');
            $('[data-activates="'+attrs.edTabs+'"]').addClass('active');

            el.find('#navigation-bar').on('click', '.nav-item', function (e) {
                if (blockClicks === true) return;

                $scope.$apply(function() {
                    blockClicks = true;
                    $rootScope.activeTab = e.currentTarget.dataset.activates;
                });
            });

            $rootScope.$watch('activeTab', function(newTab, oldTab) {
                if (newTab && newTab !== oldTab) {
                    var oldTabNode = oldTab ? el.find('#'+oldTab) : el.find('.tab.open');
                    changeTab(newTab, oldTabNode, el.find('#'+newTab), $('[data-activates="'+newTab+'"]'));
                }
            });

            var changeTab = function(name, oldTab, newTab, tabButton) {
                var inAnimation  = 'fadeInLeft',
                    outAnimation = 'fadeOutRight';

                if (tabButton.hasClass('active')) return;

                //tab navigation
                $('.nav-item.active').removeClass('active');
                tabButton.addClass('active');

                //tabs
                if (parseInt(newTab.data('index')) < parseInt(oldTab.data('index'))) {
                    outAnimation = 'fadeOutLeft';
                    inAnimation  = 'fadeInRight';
                }

                oldTab.addClass('animated '+outAnimation).one($rootScope.animationEndEvent, function() {
                    if (newTab[0].id === $scope.activeTab) {
                        $(this).removeClass('open '+outAnimation);
                    }
                });
                newTab.addClass('open animated '+inAnimation).one($rootScope.animationEndEvent, function() {
                    $(this).removeClass(inAnimation);
                });

                $rootScope.$emit('tab.changed', name, oldTab[0].id);
                $rootScope.activePanel = false;

                setTimeout(function() {
                    newTab.removeClass('fadeOutRight fadeOutLeft');
                    blockClicks = false;
                }, 270)
            }
        }
    };
}]);

angular.module('image.directives')

.directive('edPrettyScrollbar', function() {
    return {
        restrict: 'A',
        compile: function(el, attrs) {
            setTimeout(function() {
                el.mCustomScrollbar({
                    theme: attrs.edScrollTheme || 'inset',
                    scrollInertia: 300,
                    autoExpandScrollbar: false,
                    axis: attrs.edScrollAxis || 'x',
                    advanced: { autoExpandHorizontalScroll:true },
                });
            }, 1)
        }
   	}
})

//fix some bug between custom scrollbar and material slider
.directive('edIeSliderFix', function() {
    return {
        restrict: 'A',
        template: '<div class="slider-fix-outter" style="height: 2px; position: absolute"><div class="slider-fix-inner" style="height: 1px; overflow: auto;">IE FIX</div></div>',
        compile: function(el) {
            el.find('.slider-fix-inner').mCustomScrollbar();
        }
    }
});
'use strict';

angular.module('image.directives')

.directive('edColorPicker', ['$rootScope', '$parse', function ($rootScope, $parse) {
    return {
        link: function ($scope, el, attrs) {
            var flat = 'edFlat' in attrs;

            $scope.$watch(attrs.ngDisabled, function(newVal) {
                if (newVal) {
                    el.spectrum('disable');
                } else {
                    el.spectrum('enable');
                }
            });

            var params = {
                color: attrs.startColor,
                clickoutFiresChange: true,
                showPalette: !flat,
                palette: colorsForPicker,
                preferredFormat: 'hex',
                showAlpha: true,
                showInput: true,
                flat: flat,
                showButtons: !flat
            },
            setter = function(selectedColor) {
                $parse(attrs.edColorPicker)($scope, {color: selectedColor.toString()});
                el.val(selectedColor.toString());
            };

            if (attrs.edDiscrete !== undefined) {
                el.on('dragstop.spectrum', function(e, selectedColor) {
                    setter(selectedColor);
                });

                params.change = function(selectedColor) {
                    setter(selectedColor);
                }
            } else {
                params.move = function(selectedColor) {
                    setter(selectedColor);
                }
            }

            el.spectrum(params);
        }
    };
}]);

angular.module('image.directives')

.directive('edFileUploader', ['$parse', '$mdDialog', '$mdBottomSheet', function($parse, $mdDialog, $mdBottomSheet) {
    var validTypes = ['png', 'jpg', 'jpeg', 'gif'];

    return {
        restrict: 'A',
        link: function($scope, el, attrs) {
            var setter = $parse(attrs.edFileUploader)($scope);

            $(el[0]).on('change', function(e) {
                var reader = new FileReader();

                reader.onload = function(event) {
                    var mime = event.target.result.split(",")[0].split(":")[1].split(";")[0].split('/')[1];

                    if (validTypes.indexOf(mime) < 0) {
                        //
                    }

                    if (setter) {
                        setter(event.target.result);

                        if (typeof attrs.edCloseAfter !== 'undefined') {
                            $mdDialog.hide();
                            $mdBottomSheet.hide();
                        }
                    }
                };

                if (e.target.files[0].name.match('.json')) {
                    reader.readAsText(e.target.files[0]);
                } else {
                    reader.readAsDataURL(e.target.files[0]);
                }
            });
        }
   	}
}]);
angular.module('image.directives')

.directive('edTogglePanelVisibility', function() {
    return {
        restrict: 'A',
        compile: function(el, attrs) {
            el.on('click', function() {
                el.find('.icon').toggleClass('toggled');

                $('#'+attrs.edTogglePanelVisibility).find('ul').mCustomScrollbar('disable').slideToggle(150, function() {
                    $(this).mCustomScrollbar('update');
                });
            });
        }
   	}
});
angular.module('image.directives')

.directive('edToggleSidebar', function() {
    return {
        restrict: 'A',
        compile: function(el, attrs) {
            var sidebar = $('#left-sidebar');

            el.on('click', function() {
                sidebar.toggleClass('open');
            });
        }
   	}
});
angular.module('image.text', [])

    .service('text', ['$rootScope', 'canvas', function ($rootScope, canvas) {

        var text = {

            removeTextFromCanvas: function(textObject) {
                  if ( ! textObject) {
                      textObject = canvas.fabric.getActiveObject();
                  }

                  //bail if we don't have a text object
                  if ( ! textObject.setFontSize) return;

                  canvas.fabric.remove(textObject);
                  canvas.fabric.renderAll();
            },

            getTextObject: function() {
                var active = canvas.fabric.getActiveObject();

                if (active && active.fontFamily) {
                    return active;
                }

                //if there is no active object or active object
                //is not text, return first text object available
                if ( ! active || ! active.fontFamily) {
                    var objects = canvas.fabric.getObjects();

                    for (var i = 0; i < objects.length; i++) {
                        if (objects[i].fontFamily) {
                            return objects[i];
                        }
                    }
                }
            },

            toggleTextDecoration: function(value) {
                var text = this.getTextObject(),
                    current = text.textDecoration.trim();

                //font style
                if (value == 'italic') {
                    if (text.fontStyle.indexOf('italic') > -1) {
                        text.setFontStyle('normal');
                    } else {
                        text.setFontStyle('italic');
                    }
                }

                //text decoration
                else {
                    if (current.indexOf(value) > -1) {
                        current = current.replace(value, '').trim();
                    } else {
                        current += ' '+value;
                    }

                    if (text.setTextDecoration) {
                        text.setTextDecoration(current);
                    }
                }

                canvas.fabric.renderAll();

                var decorations = text.fontStyle+' '+text.textDecoration.trim();

                return decorations.split(' ');
            },

            setProperty: function(property, value, enabled) {
                var text   = this.getTextObject(),
                    setter = this.makeSetterName(property);

                  if (text[setter] && enabled) {
                      text[setter](value);
                  }
                  canvas.fabric.renderAll();
            },

            /**
             * Toggle given property on/off on text object.
             *
             * @param {string}  property
             * @param {boolean} enabled
             */
            toggleProperty: function(property, enabled) {
                var text   = this.getTextObject(),
                    setter = this.makeSetterName(property);
                    
                if (text[setter]) {
                  if(!enabled){
                    text[setter](enabled);
                  }else{
                    if(property=='backgroundColor'){
                      text[setter](jQuery("#txtBgColor").val());
                    }else if(property=='stroke'){
                      text[setter](jQuery("#txtOutlineColor").val());
                    }
                  }
                }

                canvas.fabric.renderAll();
            },

            /**
             * Compile a fabric setter function name from give property.
             *
             * @param name (backgroundColor)
             * @returns string (setBackgroundColor)
             */
            makeSetterName: function(name) {
                  return 'set'+name.charAt(0).toUpperCase()+name.slice(1);
            }
        };

        return text;

    }]);
angular.module('image.text')

.controller('TextController', ['$scope', '$rootScope', '$timeout', 'canvas', 'text', 'fonts', function($scope, $rootScope, $timeout, canvas, text, fonts) {
	$scope.text  = text;
	$scope.fonts = fonts;

	$scope.activeFont = '';
	$scope.opacity = 1;
	$scope.fontSize = 25;
	$scope.txtColor = '#000000';
	$scope.enableBackground = true;
	$scope.txtBgColor = 'rgba(0,0,0,0)';
	$scope.enableOutline = true;
	$scope.txtOutlineColor = 'rgba(0,0,0,0)';
	$scope.txtAlign = 'left';
	$scope.txtUnderline = '';
	$scope.txtStyle = '';
	$scope.txtLineHeight = '';
	$scope.txtOutlineWidth = '';
	$scope.filters = {
		category: 'handwriting',
		family: ''
	};

	fonts.getAll($scope.filters);
    $scope.isPanelEnabled = function() {
        var obj = canvas.fabric.getActiveObject();
        $rootScope.activeObject = obj;
        if(obj && obj.name === 'text') $scope.setTxtValue(obj);
        return obj && obj.name === 'text' && $rootScope.activeTab === 'text';
    };

    $scope.setTxtValue = function(obj){
    	console.log(obj);
    	$scope.activeFont = obj.fontFamily;
	   	$scope.opacity = obj.opacity;
		$scope.fontSize = obj.fontSize;
		$scope.txtColor = obj.fill;
		if(obj.backgroundColor) {
			$scope.enableBackground = true;
			$scope.txtBgColor = obj.backgroundColor;
		}else{
			$scope.enableBackground = false;
		}
		if(obj.stroke) {
			$scope.enableOutline = true;
			$scope.txtOutlineColor = obj.stroke; 	
		}else{
			$scope.enableOutline = false;
		}
		$scope.txtAlign = obj.textAlign;
		console.log($scope.txtAlign);
		$scope.txtUnderline = obj.textDecoration;
		$scope.txtStyle = obj.fontStyle;
		$scope.txtLineHeight = obj.lineHight;
		$scope.txtOutlineWidth = obj.strokeWidth;
		jQuery("#txtColor").spectrum("set", obj.fill);
		if($scope.enableBackground) jQuery("#txtBgColor").spectrum("set", $scope.txtBgColor);
		if($scope.enableOutline) jQuery("#txtOutlineColor").spectrum("set", $scope.txtOutlineColor);
    };

	$scope.changeFont = function(font, e) {
        var active = canvas.fabric.getActiveObject();
		$rootScope.openPanel('text', e);

		if ( ! active || active.name !== 'text') {
			var newText = new fabric.IText('Double click me to edit my contents.', {
				fontFamily: font,
				fontWeight: 400,
				fontSize: $scope.fontSize,
				fill: $scope.txtColor,
				removeOnCancel: true,
				name: 'text'
			});

			canvas.fabric.add(newText);
            newText.setTop(25);
            newText.setLeft(25);
			canvas.fabric.setActiveObject(newText);
			canvas.fabric.renderAll();
		}

        text.setProperty('fontFamily', font, true);
		$scope.setTxtValue(active);
		$scope.activeFont = font;
	};

	$scope.cancelAddingTextToCanvas = function() {
		var textObject = text.getTextObject();

		if (textObject.removeOnCancel) {
			text.removeTextFromCanvas(textObject);
		}

		$rootScope.activePanel = false;
	};

	$scope.finishAddingTextToCanvas = function() {
		var textObject = text.getTextObject();

		$rootScope.activePanel = false;
		$rootScope.$emit('text.added', textObject);
		canvas.fabric.setActiveObject(canvas.mainImage);
		fonts.createLinkToFont(textObject.fontFamily);
		$rootScope.activeObject = canvas.mainImage;
	};

	$rootScope.$on('tab.changed', function(e, name) {
		if (name == 'text') {
			var textObject = $scope.text.getTextObject();

			//if we can find an existing text object set it as active
			if (textObject) {
				textObject.removeOnCancel = false;
				canvas.fabric.setActiveObject(textObject);
			}
		}
	});

}]);
'use strict';

angular.module('image.text')

.directive('edTextAlignButtons', ['text', function (text) {
    return {
        compile: function (el) {
            el.on('click', 'i', function(e) {
                var align = e.currentTarget.dataset.align;
                text.setProperty('textAlign', align, true);
                el.find('i').removeClass('active');
                $(e.currentTarget).addClass('active');

            });
        }
    };
}])

'use strict';

angular.module('image.text')

.directive('edTextDecorationButtons', ['text', function (text) {
    return {
        compile: function (el) {
            el.on('click', '.toolbar-btn', function(e) {
                var name = e.currentTarget.dataset.decoration;

                var decorations = text.toggleTextDecoration(name);

                el.find('.toolbar-btn').removeClass('active');

                for (var i = 0; i < decorations.length; i++) {
                    el.find('[data-decoration="'+decorations[i].trim()+'"]').addClass('active');
                }
            });
        }
    };
}])

'use strict';

angular.module('image.text')

.directive('edFontsPagination', ['$rootScope', 'fonts', function($rootScope, fonts) {

    return {
        restrict: 'A',
        link: function($scope, el) {

            //initiate pagination plugin
            el.pagination({
                items: 0,
                itemsOnPage: fonts.paginator.perPage,
                onPageClick: function(num) {
                    $scope.$apply(function() {
                        fonts.paginator.selectPage(num);
                    })
                }
            });

            //redraw pagination bar on total items change
            $scope.$watch('fonts.paginator.totalItems', function(value) {
                if (value) { el.pagination('updateItems', value) }
            });
        }
    }
}])

.factory('fonts', ['$rootScope', '$http', '$timeout', '$filter', 'localStorage', function($rootScope, $http, $timeout, $filter, localStorage) {

    var fonts = {

        loading: false,

        paginator: {

            /**
             * All available fonts.
             *
             * @type array
             */
            sourceItems: ["Slabo 27px",
                            "Roboto",
                            "Saira" ,
                            "Open Sans",
                            "Times New Roman",
                            "Playfair Display",
                            "Monotype Corsiva",
                            "PT Serif",
                            "IM Fell Double Pica SC",
                            "Cormorant Unicase",
                            "Chewy",
                            "Limelight",
                            "Poiret One",
                            "Voltaire",
                            "Oswald",
                            "Sniglet",
                            "Crushed",
                            //"Bookman Old Style",
                            "Arial",
                            "Helvetica",
                            "Lobster",
                            //"Disney",
                            "Star Trek",
                            //"Garamond",
                            "PT Sans",
                            "Indie Flower",
                            "Fjalla One",
                            "Pacifico",
                            "Amatic SC",
                            "Great Vibes",
                            "Permanent Marker",
                            "Bad Script",
                            "Monoton",
                            "Coming Soon",
                            "Just Another Hand",
                            "Delius Swash Caps",
                            "Rochester",
                            "Elsie Swash Caps",
                            "Inconsolata",
                            "Trocchi",
                            "Creepster",
                            "Bungee",
                            "Black Ops One",
                        ],

            /**
             * All available fonts with filtrs applied.
             */
            filteredItems: [],

            /**
             * Fonts currently being shown.
             *
             * @type array
             */
            currentItems: [],

            /**
             * Fonts to show per page.
             *
             * @type int
             */
            perPage: 10,

            /**
             * Total number of fonts.
             *
             * @type int
             */
            totalItems: 0,

            /**
             * Slice items for the given page.
             *
             * @param  {int} page
             * @return void
             */
            selectPage: function(page) {
                this.currentItems = this.filteredItems.slice(
                    (page-1)*this.perPage, (page-1)*this.perPage+this.perPage
                );

                //fonts.load();
            },

            filter: function(filters) {
                this.start($filter('filter')(fonts.paginator.sourceItems, filters));
            },

            /**
             * Start the paginator with given items.
             *
             * @param  {array} items
             * @return void
             */
            start: function(items) {
                console.log(items);
                this.perPage = items.length;
                this.filteredItems  = items;
                this.totalItems   = items.length;
                this.currentItems = items.slice(0, this.perPage);

                fonts.load(items);
            }
        },

        /**
         * Fetch all available fonts from GoogleFonts API.
         *
         * @return void
         */
        getAll: function(filters) {
            var self   = this,
                cached = localStorage.get('googleFonts'),
                key    = $rootScope.keys['google_fonts'];
            // console.log(fonts.paginator.currentItems);
            // if (cached) {
            //     self.paginator.sourceItems = cached;
            //     return filters ? self.paginator.filter(filters) : self.paginator.start(cached);
            // }

            // $http.get('https://www.googleapis.com/webfonts/v1/webfonts?sort=popularity&key='+key)
            //     .success(function(data) {
            //         localStorage.set('googleFonts', data.items);
            //         self.paginator.sourceItems = data.items;
            //         filters ? self.paginator.filter(filters) : self.paginator.start(data.items);
            //     });
            //console.log(self.paginator.sourceItems);
            //localStorage.set('googleFonts', self.paginator.sourceItems);
            //filters ? self.paginator.filter(filters) : self.paginator.start(self.paginator.sourceItems);
            self.paginator.start(self.paginator.sourceItems);
        },

        /**
         * Load given google fonts into the DOM.
         *
         * @param  {mixed} names
         * @return void
         */
        load: function(names) {
            var head = $('head');
            $rootScope.loading = true;

            //make an array of font names from current fonts
            //in the paginator if none passed
            if ( ! names) {
                names = $.map(fonts.paginator.currentItems, function(font) {
                    console.log(font);
                    //return font.family;
                    return font;
                });

                //normalize names to array if string passed
            } else if ( ! angular.isArray(names)) {
                names = [names];
            }

            //remove previous page fonts
            //$(head).find('#dynamic-fonts').remove();
            names = names.filter(val => val !== "Times New Roman");
            names = names.filter(val => val !== "Helvetica");
            names = names.filter(val => val !== "Monotype Corsiva");
            var perPage = 17;
            //load the given fonts
            for( var i=0; i*perPage < names.length; i++){
                var subfonts = names.slice(i*perPage, (i+1)*perPage);
                head.append(
                    '<link rel="stylesheet" id="dynamic-fonts'+i+'" href="https://fonts.googleapis.com/css?family='+
                    subfonts.join('|').replace(/ /g, '+')+'">'
                );
            }
        },

        createLinkToFont: function(font) {
            var name = font.replace(/ /g, '+'),
                link = $('#'+name);
                
            if (link[0]) {
                link.attr('href', 'https://fonts.googleapis.com/css?family='+name);
            } else {
                $('head').append('<link rel="stylesheet" id="'+name+'" href="https://fonts.googleapis.com/css?family='+name+'">');
            }
        }
    };

    return fonts;
}]);
angular.module('image.drawing', [])

.service('drawing', ['$rootScope', 'canvas', function ($rootScope, canvas) {

    var drawing = {

        availableBrushes: ['pencil', 'vLine', 'diamond', 'hLine', 'circle', 'square', 'spray'],

        defaultBrushName: 'pencil',

        activeBrushName: false,

        isEnabled: false,

        params: {
            shadowColor: '#1E89E6',
            brushWidth: 9,
            brushColor: '#000',
            shadowBlur: 30,
            shadowOffsetX: 10,
            shadowOffsetY: 10,
            enableShadow: false
        },

        enable: function() {
            canvas.fabric.isDrawingMode = true;
            this.changeBrush(this.defaultBrushName);

            if ( ! this.shadow) {
                this.shadow = new fabric.Shadow({
                    color: this.params.shadowColor,
                    blur: this.params.shadowBlur,
                    offsetX: this.params.shadowOffsetX,
                    offsetY: this.params.shadowOffsetY
                });
            }

            this.isEnabled = true;
        },

        disable: function() {
            canvas.fabric.isDrawingMode = false;
            this.isEnabled = false;
        },

        setShadowProperty: function(name, value) {
            if (canvas.fabric.freeDrawingBrush.shadow[name]) {
                canvas.fabric.freeDrawingBrush.shadow[name] = value;
            }
        },

        setProperty: function(name, value) {
            if (canvas.fabric.freeDrawingBrush[name]) {
                canvas.fabric.freeDrawingBrush[name] = value;
            }
        },

        toggleShadow: function(on) {
            if (on) {
                canvas.fabric.freeDrawingBrush.shadow = this.shadow;
            } else {
                this.shadow = canvas.fabric.freeDrawingBrush.shadow;
                canvas.fabric.freeDrawingBrush.shadow = undefined;
            }
        },
        
        changeBrush: function(name) {
            this.activeBrushName = name;
            name = this.makeBrushName(name);

            //check if it's a base fabric brush
            if (fabric[name]) {
                canvas.fabric.freeDrawingBrush = new fabric[name](canvas.fabric);

            //check if it's a custom brush that we have already made
            } else if (this[name]) {
                canvas.fabric.freeDrawingBrush = this[name];

            //check if we can make a request brush
            } else if (this['make'+name]) {
                canvas.fabric.freeDrawingBrush = this['make'+name]();
            }

            canvas.fabric.freeDrawingBrush.width  = this.params.brushWidth;
            canvas.fabric.freeDrawingBrush.color  = this.params.brushColor;

            if (this.params.enableShadow) {
                canvas.fabric.freeDrawingBrush.shadow = this.shadow;
            }
        },

        /**
         * Compile a fabric brush function name from given name.
         *
         * @param name (pencil)
         * @returns string (PencilBrush)
         */
        makeBrushName: function(name) {
            return name.charAt(0).toUpperCase()+name.slice(1) + 'Brush';
        },

        makeVLineBrush: function() {
            this.VLineBrush = new fabric.PatternBrush(canvas.fabric);

            this.VLineBrush.getPatternSrc = function() {

                var patternCanvas = fabric.document.createElement('canvas');
                patternCanvas.width = patternCanvas.height = 10;
                var ctx = patternCanvas.getContext('2d');

                ctx.strokeStyle = this.color;
                ctx.lineWidth = 5;
                ctx.beginPath();
                ctx.moveTo(0, 5);
                ctx.lineTo(10, 5);
                ctx.closePath();
                ctx.stroke();

                return patternCanvas;
            };

            return this.VLineBrush;
        },

        makeDiamondBrush: function () {
            this.DiamondBrush = new fabric.PatternBrush(canvas.fabric);

            this.DiamondBrush.getPatternSrc = function() {

                var squareWidth = 10, squareDistance = 5;
                var patternCanvas = fabric.document.createElement('canvas');
                var rect = new fabric.Rect({
                    width: squareWidth,
                    height: squareWidth,
                    angle: 45,
                    fill: this.color
                });

                var canvasWidth = rect.getBoundingRectWidth();

                patternCanvas.width = patternCanvas.height = canvasWidth + squareDistance;
                rect.set({ left: canvasWidth / 2, top: canvasWidth / 2 });

                var ctx = patternCanvas.getContext('2d');
                rect.render(ctx);

                return patternCanvas;
            };

            return this.DiamondBrush;
        },

        makeHLineBrush: function () {
            this.HLineBrush = new fabric.PatternBrush(canvas.fabric);

            this.HLineBrush.getPatternSrc = function() {

                var patternCanvas = fabric.document.createElement('canvas');
                patternCanvas.width = patternCanvas.height = 10;
                var ctx = patternCanvas.getContext('2d');

                ctx.strokeStyle = this.color;
                ctx.lineWidth = 5;
                ctx.beginPath();
                ctx.moveTo(5, 0);
                ctx.lineTo(5, 10);
                ctx.closePath();
                ctx.stroke();

                return patternCanvas;
            };

            return this.HLineBrush;
        },

        makeSquareBrush: function () {
            this.SquareBrush = new fabric.PatternBrush(canvas.fabric);

            this.SquareBrush.getPatternSrc = function() {

                var squareWidth = 10, squareDistance = 2;

                var patternCanvas = fabric.document.createElement('canvas');
                patternCanvas.width = patternCanvas.height = squareWidth + squareDistance;
                var ctx = patternCanvas.getContext('2d');

                ctx.fillStyle = this.color;
                ctx.fillRect(0, 0, squareWidth, squareWidth);

                return patternCanvas;
            };

            return this.SquareBrush;
        }

    };

    return drawing;

}]);
angular.module('image.drawing')

.controller('DrawingController', ['$scope', '$rootScope', 'canvas', 'drawing', 'history', function($scope, $rootScope, canvas, drawing, history) {
	$scope.drawing = drawing;
    window.fb = canvas.fabric;

	$scope.changeBrush = function(brush, $event) {
		$scope.openPanel('drawing', $event);

		if ( ! drawing.isEnabled) {
			drawing.enable();
		}

		drawing.changeBrush(brush);
	};

	$scope.finishAddingDrawingsToCanvas = function() {
		$rootScope.activePanel = false;

        if (canvas.mainImage) {
            canvas.fabric.setActiveObject(canvas.mainImage);
        }

		canvas.fabric.forEachObject(function(obj) {
			if (obj.name === 'freeDrawing') {
				obj.removeOnCancel = false;
			}
		});

        drawing.disable();

		$rootScope.activeObject = canvas.mainImage;
		history.add('added drawing', 'brush');
	};

	$scope.cancelAddingDrawingsToCanvas = function() {
        canvas.fabric.forEachObject(function (obj) {
			if (obj.name === 'freeDrawing' && obj.removeOnCancel) {
				canvas.fabric.remove(obj);
			}
		});

		drawing.disable();
        canvas.fabric.renderAll();
		$rootScope.activePanel = false;
	};

	$rootScope.$on('tab.changed', function(e, name) {
		if (name !== 'drawing') {
			drawing.disable();
			$scope.cancelAddingDrawingsToCanvas();
		}
	});

	canvas.fabric.on('path:created', function(e) {
		if (drawing.isEnabled) {
			e.path.setOptions(canvas.imageStatic);
			e.path.name = 'freeDrawing';
			e.path.removeOnCancel = true;
		}
	});
}]);
'use strict';

angular.module('image.directives')

.directive('edRenderBrushes', ['$rootScope', '$compile', function ($rootScope, $compile) {
    return {
        link: function ($scope, el) {
            var template = '<div ng-repeat="brush in drawing.availableBrushes" ng-class="{ active: drawing.activeBrushName == brush }" class="brush animated-in-sequence" ng-click="changeBrush(brush)">'+
                '<img class="img-responsive" ng-src="assets/images/brushes/{{brush}}.png"/>'+
                '<div class="brush-name">{{ brush }}</div>'+
            '</div>';

            var unbind = $rootScope.$on('tab.changed', function(e, name) {
                if (name === 'drawing') {
                    $scope.$apply(function() {
                        el.append($compile(template)($scope));
                    });
                    unbind();
                }
            });
        }
    };
}]);

'use strict';

angular.module('ImageEditor')

.factory('history', ['$rootScope', 'canvas', function($rootScope, canvas) {

	var history = {

		all: [],

        //used for backing up canvas and other serializations
        //that are not visible to the user
        ignored: [], 

		add: function(name, icon, ignore) {
            var prop = ignore ? 'ignored' : 'all';

            //make sure don't have duplicates in ignored array
            if (prop === 'ignored') { 
                for (var i = 0; i < this.ignored.length; i++) {
                    if (this.ignored[i].name === name) {
                        this.ignored.splice(i, 1)
                    }
                }
            }

			this[prop].unshift({
				name: name,
				state: canvas.fabric.toJSON(['selectable', 'name']),
				index: this.all.length+1,
				icon: icon,
                zoom: canvas.zoom,
				canvasWidth: canvas.original.width || canvas.fabric.getWidth(),
				canvasHeight: canvas.original.height || canvas.fabric.getHeight()
			});
		},

        get: function(name, prop) {
            if ( !prop) prop = 'ignored';

            for (var i = 0; i < history[prop].length; i++) {
                if (history[prop][i].name === name) {
                    return history[prop][i];
                }
            }
        },

        getCurrentCanvasState: function() {
            return {
                state: canvas.fabric.toJSON(['selectable', 'name']),
                index: this.all.length+1,
                zoom: canvas.zoom,
                canvasWidth: canvas.original.width || canvas.fabric.getWidth(),
                canvasHeight: canvas.original.height || canvas.fabric.getHeight()
            }
        },

		load: function(item) {
			$rootScope.isLoading();

            //if we get passed a name, fetch a matching history item
            if (angular.isString(item)) {
                item = this.get(item);
            }

            if ( ! item) {
                return $rootScope.isNotLoading();
            }

			setTimeout(function() {
				canvas.fabric.loadFromJSON(item.state, function() {
					canvas.fabric.forEachObject(function(obj) {

						//reapply any filters object used to have
						if (obj.applyFilters && obj.filters.length) {
							obj.applyFilters(canvas.fabric.renderAll.bind(canvas.fabric));
						}

						//assign new reference to mainImage property
						if (obj.name == 'mainImage') {
							canvas.mainImage = obj;
						}
					});

                    canvas.zoom(1);

                    if (item.canvasWidth && item.canvasHeight) {
                        canvas.fabric.setWidth(item.canvasWidth);
                        canvas.fabric.setHeight(item.canvasHeight);
                        canvas.original.width = item.canvasWidth;
                        canvas.original.height = item.canvasHeight;
                    }

                    canvas.fabric.renderAll();
                    canvas.fabric.calcOffset();
                    $rootScope.isNotLoading();
                    canvas.fitToScreen();

                    $rootScope.$emit('history.loaded');
                    
                    document.fonts.ready.then(function () {
                        console.log("loaded");
                        canvas.fabric.renderAll();
                        $rootScope.isNotLoading();
                    });
				});
			}, 30);

		}
	};

	return history;
}]);
'use strict';

angular.module('ImageEditor')

.factory('saver', ['$rootScope', '$mdDialog', '$http', '$timeout', 'canvas', 'cropper', 'history', function($rootScope, $mdDialog, $http, $timeout, canvas, cropper, history) {

	var saver = {

        saveImage: function(format, quality, name, e, close) {

            canvas.fabric.deactivateAll();
            cropper.stop();

            if ($rootScope.isDemo) {
                return this.handleDemoSiteSave(e);
            }

            if ($rootScope.isIntegrationMode) {
                return this.handleIntegrationModeSave(format, quality, name);
            }

            //this.saveToComputer(format, quality, name);
            this.saveToServer(name, close);
        },

        handleIntegrationModeSave: function(format, quality, name) {
            canvas.zoom(150/canvas.original.height);
            var data = this.getDataUrl(format, quality);

            this.handleCallbacks(data, name);

            //firefox integration mode fix
            $('.md-dialog-container').remove();
            
            $mdDialog.hide();
            $rootScope.pixie.close();
            canvas.zoom(0.5);
        },

        saveToServer: function(name, close) {

            canvas.zoom(150/canvas.original.height);
            var data_jpeg = this.getDataUrl('jpeg', 8);

            canvas.zoom(1);            
            var data_png = this.getDataUrl('png', 8),
                data_json = this.getDataUrl('json', 8);
            canvas.fitToScreen();  
            $rootScope.isLoading();
            jQuery.ajax({
                url: "/wp-admin/admin-ajax.php",
                data: {
                    action: 'wineshop_label_save',
                    order_id: $rootScope.order_id,
                    product_id: $rootScope.product_id,
                    jpeg : data_jpeg,
                    png : data_png,
                    json : data_json
                },
                type: 'POST',
                success: function(res){

                    $rootScope.isNotLoading();
                    if(close){
                        $timeout(function() {
                            if (typeof top.tb_remove == 'function') {
                                top.tb_remove();
                            }

                            var event;
                            var closeEventName = "personalized-wine-designer-modal-close";
                            if (document.createEvent) {
                                event = document.createEvent("HTMLEvents");
                                event.initEvent(closeEventName, true, true);
                            } else {
                                event = document.createEventObject();
                                event.eventType = closeEventName;
                            }

                            event.eventName = closeEventName;

                            if (document.createEvent) {
                                document.dispatchEvent(event);
                                window.parent.document.dispatchEvent(event);
                            } else {
                                document.fireEvent("on" + event.eventType, event);
                                window.parent.document.fireEvent("on" + event.eventType, event);
                            }
                        }, 1000);
                    }
                }
            })
            $mdDialog.hide();
        },

        saveToComputer: function(format, quality, name) {
            canvas.zoom(1);

            var link = document.createElement('a'),
                data = this.getDataUrl(format, quality);

            this.handleCallbacks(data, name);

            //browser supports html5 download attribute
            if (typeof link.download !== 'undefined') {
                link.download = (name || 'image')+'.'+format;
                link.href = data;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }

            //canvas blob and file saver workaround
            else {
                canvas.fabric.lowerCanvasEl.toBlob(function(blob) {
                    saveAs(blob, name+'.'+format);
                }, 'image/'+format, quality);
            }

            $mdDialog.hide();
        },

        handleCallbacks: function(data, name) {
            //replace image src with new data url in original window
            if ($rootScope.getParam('replaceOriginal') && $rootScope.getParam('image')) {
                $rootScope.getParam('image').src = data;
            }

            //send image data to user specified url
            if ($rootScope.getParam('saveUrl')) {
                $http.post($rootScope.getParam('saveUrl'), { data: data, name: name });
            }

            if ($rootScope.getParam('onSave')) {
                var img = $rootScope.getParam('image') || new Image(data);
                $rootScope.getParam('onSave')(data, img, name);
            }
        },

        handleDemoSiteSave: function(e) {
            $('.demo-alert').one($rootScope.animationEndEvent, function() {
                $(this).removeClass('animated shake');  e.target.blur();
            }).addClass('animated shake');
        },

        getDataUrl: function(format, quality) {
            if (format === 'json') {
                return "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(history.getCurrentCanvasState()));
            }
            return canvas.fabric.toDataURL({
                format: format || 'png',
                quality: (quality || 8) / 10
            });
        },

        getThumbDataUrl: function(datas, wantedWidth, wantedHeight){
            // We create an image to receive the Data URI
            var img = document.createElement('img');

            // We put the Data URI in the image's src attribute
            img.src = datas;
            var dataURI = '';
            // When the event "onload" is triggered we can resize the image.
            img.onload = function()
                {        
                    // We create a canvas and get its context.
                    var canvas = document.createElement('canvas');
                    var ctx = canvas.getContext('2d');

                    // We set the dimensions at the wanted size.
                    canvas.width = wantedWidth;
                    canvas.height = wantedHeight;

                    // We resize the image with the canvas method drawImage();
                    ctx.drawImage(this, 0, 0, wantedWidth, wantedHeight);

                    dataURI = canvas.toDataURL();
                    /////////////////////////////////////////
                    // Use and treat your Data URI here !! //
                    /////////////////////////////////////////
                };
            while(dataURI == ''){};
            return dataURI;
        }
	};

	return saver;
}]);
angular.module('image.filters', [])

.controller('FiltersController', ['$scope', '$rootScope', 'canvas', 'filters', function($scope, $rootScope, canvas, filters) {

    $scope.filters = filters;

    $rootScope.$on('history.loaded', function () {
        if ( ! canvas.mainImage) return;

        var appliedFilters = [];

        for (var i = 0; i < canvas.mainImage.filters.length; i++) {
            appliedFilters.push(canvas.mainImage.filters[i].name);
        }

        $scope.$apply(function() {
            filters.appliedFilters = appliedFilters;
        });
    });
}]);

'use strict';

angular.module('image.filters')

.service('filters', ['$rootScope', 'canvas', 'history', function ($rootScope, canvas, history) {

    var filters = {

        all: [
            { name: 'grayscale' },
            { name: 'invert' },
            { name: 'sepia' },
            { name: 'sepia2' },
            {
                name: 'removeWhite',
                options: {
                    distance: { current: 10 },
                    threshold: { current: 50 }
                }
            },
            {
                name: 'brightness',
                options: {
                    brightness: { current: 50 }
                }
            },
            {
                name: 'noise',
                options: {
                    noise: { current: 40, max: 600 }
                }
            },
            {
                name: 'GradientTransparency',
                displayName: 'Gradient',
                options: {
                    threshold: { current: 40 }
                }
            },
            {
                name: 'pixelate',
                options: {
                    blocksize: { max: 40, current: 2 }
                }
            },
            {
                name: 'sharpen',
                uses: 'Convolute',
                matrix: [ 0, -1,  0, -1,  5, -1, 0, -1,  0 ]
            },
            {
                name: 'blur',
                uses: 'Convolute',
                matrix: [ 1/9, 1/9, 1/9, 1/9, 1/9, 1/9, 1/9, 1/9, 1/9 ]
            },
            {
                name: 'emboss',
                uses: 'Convolute',
                matrix: [ 1,   1,  1, 1, 0.7, -1, -1,  -1, -1 ]
            },
            {
                name: 'tint',
                options: {
                    opacity: { current: 0.5, min: 0.1, max: 1, step: 0.1 },
                    color: { colorpicker: true, current: '#FF4081' }
                }
            },
            {
                name: 'multiply',
                options: {
                    color: { colorpicker: true, current: '#FF4081' }
                }
            },
            {
                name: 'blend',
                options: {
                    mode: { current: 'add', select: true, available: ['add', 'multiply', 'subtract', 'diff', 'screen', 'lighten', 'darken'] },
                    alpha: { current: 0.5, min: 0.1, max: 1, step: 0.1 },
                    color: { colorpicker: true, current: '#FF4081' }

                }
            }

        ],

        appliedFilters: [],

        applyFilter: function(filter) {
            if ( ! this.filterExists(filter)) return;

            if (this.filterAlreadyApplied(filter.name)) {
                return this.removeFilter(filter);
            }

            $rootScope.isLoading();
            filters.markAsApplied(filter.name);

            //need to use timeout to display loading spinner properly
            setTimeout(function() {
                canvas.fabric.forEachObject(function(obj) {
                    if (obj.applyFilters) {
                        obj.filters.push(filters.getFilter(filter));
                        obj.applyFilters(canvas.fabric.renderAll.bind(canvas.fabric));
                    }
                });

                history.add('filter: '+(filter.displayName || filter.name), 'brightness-6');
                filters.lastAppliedFilter = filter;
                $rootScope.isNotLoading();
            }, 30);
        },

        removeFilter: function(filter) {
            if ( ! this.filterExists(filter)) return;

            $rootScope.isLoading();
            filters.unmarkAsApplied(filter.name);

            setTimeout(function() {
                canvas.fabric.forEachObject(function(obj) {
                    if (obj.applyFilters) {
                        for (var i = 0; i < obj.filters.length; i++) {
                            if (obj.filters[i].name.toLowerCase() === filter.name.toLowerCase()) {
                                obj.filters.splice(i, 1);
                                obj.applyFilters(canvas.fabric.renderAll.bind(canvas.fabric));
                            }
                        }
                    }
                });

                filters.lastAppliedFilter = false;
                $rootScope.isNotLoading();
            }, 30);
        },

        applyValue: function(filterName, optionName, optionValue) {
            $rootScope.isLoading();

            setTimeout(function() {
                canvas.fabric.forEachObject(function(obj) {
                    if (obj.applyFilters) {
                        for (var i = 0; i < obj.filters.length; i++) {
                            var filter = obj.filters[i];

                            if (filter.type.toLowerCase() === filterName.toLowerCase()) {
                                filter[optionName] = optionValue;
                                obj.applyFilters(canvas.fabric.renderAll.bind(canvas.fabric));
                            }
                        }
                    }
                });

                $rootScope.isNotLoading();
            }, 30);
        },

        filterAlreadyApplied: function(name) {
            return this.appliedFilters.indexOf(name) !== -1
        },

        markAsApplied: function(name) {
            if (this.appliedFilters.indexOf(name) === -1) {
                this.appliedFilters.push(name);
            }
        },

        unmarkAsApplied: function(name) {
            for (var i = 0; i < this.appliedFilters.length; i++) {
                if (this.appliedFilters[i] === name) {
                    this.appliedFilters.splice(i, 1);
                }
            }
        },

        filterExists: function(filter) {
            return fabric.Image.filters[fabric.util.string.capitalize(filter.uses || filter.name, true)] !== undefined;
        },

        getFilter: function(filter) {
            var newFilter;

            if (filter.uses) {
                newFilter = new fabric.Image.filters[fabric.util.string.capitalize(filter.uses, true)]({ matrix: filter.matrix });
            }

            else {
                var options = {};

                for (var key in filter.options) {
                    options[key] = filter.options[key].current;
                }

                newFilter = new fabric.Image.filters[fabric.util.string.capitalize(filter.name, true)](options);
            }

            newFilter.name = filter.name;

            return newFilter;
        },
    };

    return filters;

}]);
angular.module('image.shapes', [])

.controller('SimpleShapesController', ['$scope', '$rootScope', '$timeout', 'canvas', 'simpleShapes', function($scope, $rootScope, $timeout, canvas, simpleShapes) {
	$scope.shapes = simpleShapes;

    $scope.available = ['rect', 'triangle', 'circle', 'ellipse', 'polygon'];

    $scope.isPanelEnabled = function() {
        var obj = canvas.fabric.getActiveObject();
        if(obj && $scope.available.indexOf(obj.name) > -1){
            $scope.setSeletedShape(obj);
            $rootScope.activeObject = obj;
        }
        return obj && $scope.available.indexOf(obj.name) > -1 && simpleShapes.selected.options;
    };

    $scope.setSeletedShape = function(obj){

        $scope.shapes.selectShape(obj.name);
        $scope.shapes.selectedShape = obj;

        var selectedShape = $scope.shapes.selected;

        selectedShape.options.main.fill.current = obj.fill;
        selectedShape.options.main.opacity.current = obj.opacity;
        if(obj.name == 'circle'){
            selectedShape.options.main.radius.current = obj.radius;
        }else if(obj.name == 'ellipse'){
            selectedShape.options.main.rx.current = obj.rx;
            selectedShape.options.main.ry.current = obj.ry;
        }else if(obj.name != 'polygon'){
            selectedShape.options.main.width.current = obj.width;
            selectedShape.options.main.height.current = obj.height;
        }
        jQuery("#shapeBgColor").spectrum("set", obj.fill);
        if(obj.stroke){
            selectedShape.options.border.enabled = true;
            selectedShape.options.border.stroke.current = obj.stroke;
            selectedShape.options.border.strokeWidth.current = obj.strokeWidth;
            jQuery("#borderstroke").spectrum("set", obj.stroke);
        }else{
            selectedShape.options.border.enabled = false;
        }
        if(obj.shadow){
            selectedShape.options.shadow.enabled = true;
            selectedShape.options.shadow.color.current = obj.shadow.color;
            selectedShape.options.shadow.blur.current = obj.shadow.blur;
            selectedShape.options.shadow.offsetX.current = obj.shadow.offsetX;
            selectedShape.options.shadow.offsetY.current = obj.shadow.offsetY;
            jQuery("#shadowcolor").spectrum("set", obj.shadow.color);
        }else{
            selectedShape.options.shadow.enabled = false;
        }

        // $scope.selectedShape['height'] = obj.height;
        // $scope.selectedShape['opacity'] = obj.opacity;
        // $scope.selectedShape['width'] = obj.width;
        // $scope.selectedShape['strokeWidth'] = obj.strokeWidth;
        // $scope.selectedShape['stroke'] = obj.stroke;
        // $scope.selectedShape['shadow'] = obj.shadow;

    };

    // canvas.fabric.on('object:selected', function(object) {
    //     if ($rootScope.activeTab !== 'simple-shapes') return;
    //     simpleShapes.selectShape(object.target.name);
    // });
}]);
'use strict';

angular.module('ImageEditor')

.controller('PhotoController', ['$rootScope', '$scope', '$mdDialog', '$mdToast', '$$rAF', 'canvas', 'history', 'settings', 'saver', function($rootScope, $scope, $mdDialog, $mdToast, $$rAF, canvas, history, settings, saver) {

    $scope.history = history;

    $scope.isDemo = $rootScope.isDemo;
    $scope.canOpenImage = false;
    $scope.canvas = canvas;
    $scope.openImageMode = 'open';

    $scope.canvasWidth = 800;
    $scope.canvasHeight = 600;

    $scope.imageName = 'image';
    $scope.imageType = 'jpeg';
    $scope.imageQuality = 8;

    $scope.objectsPanelOpen = true;
    $scope.historyPanelOpen = false;

    $rootScope.$on('settings.ready', function() {
        var photos = settings.get('photos');

        for (var i = photos.length - 1; i >= 0; i--) {
            photos[i].items = new Array(photos[i].items);
        };

        $scope.photos = photos;
    });

    $scope.activePhotoCategory = 'user';

    $scope.setActivePhotoCategory = function(name) {
        if ($scope.activePhotoCategory === name) {
            $scope.activePhotoCategory = false;
        } else {
            $scope.activePhotoCategory = name;
        }
    };

    $scope.openUploadDialog = function($event) {
        $mdDialog.show({
            template: $('#main-image-upload-dialog-template').html(),
            targetEvent: $event,
            controller: 'PhotoController',
            clickOutsideToClose: true,
        });
    };

    $scope.transformOpen = function(name, e) {
        var panel = $('#'+name);

        panel.removeClass('transition-out transition-in').show();
        $scope.transformToClickElement(panel, e);

        $$rAF(function() {
            panel.addClass('transition-in').css('transform', '');
            e.currentTarget.blur();
        });
    };

    $scope.transformClose = function(name, e) {
        var panel = $('#'+name);

        panel.addClass('transition-out').removeClass('transition-in');
        $scope.transformToClickElement(panel, e);

        panel.one($rootScope.transitionEndEvent, function() {
            panel.hide().css('transform', '').removeClass('transition-out');
            e.currentTarget.blur();
        });
    };

    $scope.transformToClickElement = function(panel, e) {
        var clickRect = e.target.getBoundingClientRect();
        var panelRect = panel[0].getBoundingClientRect();

        var scaleX = Math.min(0.5, clickRect.width / panelRect.width);
        var scaleY = Math.min(0.5, clickRect.height / panelRect.height);

        panel.css('transform', 'translate3d(' +
            (-panelRect.left + clickRect.left + clickRect.width/2 - panelRect.width/2) + 'px,' +
            (-panelRect.top + clickRect.top + clickRect.height/2 - panelRect.height/2) + 'px,' +
            '0) scale(' + scaleX + ',' + scaleY + ')'
        );
    };


    $scope.openSampleImage = function() {
        canvas.loadMainImage('assets/images/lotus.jpg');
        $scope.closeUploadDialog();
        $rootScope.started = true;
    };


    $scope.showImagePreview = function(url) {
        var historyObject = false;

        try {
            historyObject = JSON.parse(url);
        } catch (e) {
            //
        }

        if (historyObject && historyObject.state) {
            $scope.$apply(function() {
                $scope.canOpenImage = false;
            });

            canvas.fabric.clear();
            history.load(historyObject);
            $scope.closeUploadDialog();
            $rootScope.started = true;
            return;
        }

        fabric.util.loadImage(url, function(image) {
            if (image) {
                $scope.$apply(function() {
                    $('.img-preview').html('').append(image);
                    $scope.canOpenImage = true;
                });
            } else {
                $scope.$apply(function() {
                    $scope.canOpenImage = false;
                });
            }
        });
    };

    $scope.openImage = function() {
        var url = $('.img-preview img').attr('src');
            
        if ( ! url || ! $scope.canOpenImage) return;

        if ((!canvas.fabric._objects.length || ! canvas.mainImage) && ! $rootScope.userPreset) {
            canvas.fabric.clear();
            canvas.loadMainImage(url);
        } else {
            canvas.openImage(url);
        }

        $scope.closeUploadDialog();
        $rootScope.started = true;
    };

    $scope.closeUploadDialog = function() {
        $scope.canUploadImage = false;
        $scope.openImageMode = 'open';
        $('.img-preview').html();
        $mdDialog.hide();
    };


    $scope.addToCanvas = function(category, index, e) {
        if ($scope.loading) return;
        $scope.loading = true;
        //$scope.openPanel('photos', e);
        var img_url = 'assets/images/photos/'+category.name+'/'+index+'.'+category.type;
        // var http = new XMLHttpRequest();
        // http.open('HEAD', img_url, false);
        // http.send();
        // if(http.status==404) img_url = 'assets/images/photos/'+category.name+'/'+index+'.'+category.type;
        fabric.util.loadImage( img_url, function(img) {
            var image = new fabric.Image(img);
            afterAddPhotoToCanvas(image);
        });
        canvas.fitToScreen(); 
    }

    function afterAddPhotoToCanvas(image) {
        image.name = 'photo';
        canvas.fabric.add(image);
        image.scaleToHeight((50 / 100) * canvas.original.height);

        image.center();
        image.setCoords();
        canvas.fabric.setActiveObject(image);
        canvas.fabric.renderAll();
        $rootScope.activeObject = image;

        $scope.$apply(function() {
            $scope.loading = false;
        });

        history.add('Added: Photo', 'favorite');
    }

}]);




angular.module('image.shapes')

.directive('edPhotosCategories', function() {
    return {
        restrict: 'A',
        link: function($scope, el) {

            //load photo images into open category when photos tab is opened
            var unbind = $scope.$watch('activeTab', function(newTab) {
                if (newTab !== 'photos') return;

                var cat = $('.category-photos.open');

                cat.find('img').each(function() {
                    this.src = this.dataset.src;
                });

                cat.parent().addClass('loaded');

                unbind();
            });

            //load photo images for the category that just been opened
            el.on('click', '.category-header', function(e) {
                $scope.$apply(function() {
                    $scope.setActivePhotoCategory(e.target.dataset.name);
                });

                var category = $(e.currentTarget).parent();

                if ( ! category.hasClass('loaded')) {
                    category.addClass('loaded').find('img').each(function() {
                        this.src = this.dataset.src;
                    });
                }
            });
        }
   	}
});
angular.module('image.shapes')

.controller('StickersController', ['$scope', '$rootScope', 'canvas', 'simpleShapes', 'history', 'settings', function($scope, $rootScope, canvas, simpleShapes, history, settings) {
	$scope.shapes = simpleShapes;
    $scope.opacity = 0.9;

    $rootScope.$on('settings.ready', function() {
        var stickers = settings.get('stickers');

        for (var i = stickers.length - 1; i >= 0; i--) {
            stickers[i].items = new Array(stickers[i].items);
        };

        $scope.categories = stickers;
    });

    $scope.activeCategory = 'doodles';

    $scope.activeStickerIsSvg = function() {
        var obj = canvas.fabric.getActiveObject();

        return obj && angular.isDefined(obj.svgUid);
    };

    $scope.isPanelEnabled = function() {
        var obj = canvas.fabric.getActiveObject();
        return obj && obj.name === 'sticker' && $rootScope.activeTab === 'stickers';
    };

    $scope.setActiveCategory = function(name) {
        if ($scope.activeCategory === name) {
            $scope.activeCategory = false;
        } else {
            $scope.activeCategory = name;
        }
    };

    $scope.setOpacity = function(opacity) {
        simpleShapes.getShape('sticker').setOpacity(opacity);
        canvas.fabric.renderAll();
    };

    $scope.setColor = function(color) {
        var obj = simpleShapes.getShape('sticker');

        if (obj.isSameColor && obj.isSameColor() || ! obj.paths) {
            obj.setFill(color);
        }
        else if (obj.paths) {
            for (var i = 0; i < obj.paths.length; i++) {
                obj.paths[i].setFill(color);
            }
        }

        canvas.fabric.renderAll();
    };

    $scope.addToCanvas = function(category, index, e) {
        if ($scope.loading) return;
        $scope.loading = true;
        $scope.openPanel('stickers', e);

        if (category.type === 'svg') {
            fabric.loadSVGFromURL('assets/images/stickers/'+category.name+'/'+index+'.'+category.type, function (objects, options) {
                var image = fabric.util.groupSVGElements(objects, options);
                afterAddStickerToCanvas(image);
            });
        } else {
            fabric.util.loadImage('assets/images/stickers/'+category.name+'/'+index+'.'+category.type, function(img) {
                var image = new fabric.Image(img);
                afterAddStickerToCanvas(image);
            });
        }
    }

    function afterAddStickerToCanvas(image) {
        image.name = 'sticker';
        canvas.fabric.add(image);
        image.scaleToHeight((40 / 100) * canvas.original.height);

        image.center();
        image.setCoords();
        canvas.fabric.setActiveObject(image);
        canvas.fabric.renderAll();

        $scope.$apply(function() {
            $scope.loading = false;
        });
        $rootScope.activeObject = image;
        history.add('Added: Sticker', 'favorite');
    }
}]);
angular.module('image.shapes')

.directive('edStickersCategories', function() {
    return {
        restrict: 'A',
        link: function($scope, el) {

            //load sticker images into open category when stickers tab is opened
            var unbind = $scope.$watch('activeTab', function(newTab) {
                if (newTab !== 'stickers') return;

                var cat = $('.category-stickers.open');

                cat.find('img').each(function() {
                    this.src = this.dataset.src;
                });

                cat.parent().addClass('loaded');

                unbind();
            });

            //load sticker images for the category that just been opened
            el.on('click', '.category-header', function(e) {
                $scope.$apply(function() {
                    $scope.setActiveCategory(e.target.dataset.name);
                });

                var category = $(e.currentTarget).parent();

                if ( ! category.hasClass('loaded')) {
                    category.addClass('loaded').find('img').each(function() {
                        this.src = this.dataset.src;
                    });
                }
            });
        }
   	}
});
angular.module('image.shapes')

.filter('orderOptions', function() {
    return function(items, field, reverse) {
        var filtered = [];
        angular.forEach(items, function(item, key) {
            item.name = key;
            filtered.push(item);
        });
        filtered.sort(function (a, b) {
            return (a[field] > b[field] ? 1 : -1);
        });
        if(reverse) filtered.reverse();

        return filtered;
    };
})

.service('simpleShapes', ['$rootScope', 'canvas', 'polygon', 'history', function ($rootScope, canvas, polygon, history) {

    var shapes = {

        gradients: edGradients,

        textures: new Array(28),

        baseOptions: {
            main: {
                enabled: true,
                opacity: { type: 'slider', current: 1, min: 0.1, max: 1, step: 0.1 },
                fill: { type: 'colorpicker', current: '#263238', hidden: true }
            },
            border: {
                enabled: false,
                onToggle: 'toggleBorder',
                stroke: { type: 'colorpicker', current: '#2196F3', displayName: 'Color' },
                strokeWidth: { type: 'slider', current: 5, max: 40, displayName: 'Width' }
            },
            shadow: {
                enabled: false,
                onToggle: 'toggleShadow',
                color: { type: 'colorpicker', current: 'rgba(0,0,0,0.5)'},
                blur: { type: 'slider', current: 5, max: 80 },
                offsetX: { type: 'slider', current: 8, max: 30 },
                offsetY: { type: 'slider', current: 5, max: 30 }
            }
        },

        available: [],

        selected: false,
        selectedShape: false,

        fillWithGradient: function(index, type) {
            var shape = canvas.fabric.getActiveObject();

            shape.setGradient(type||'fill', this.gradients[index]);

            canvas.fabric.renderAll();
        },

        fillWithImage: function(url) {
            var shape = canvas.fabric.getActiveObject();

            fabric.util.loadImage(url, function(img) {
                shape.setPatternFill({ source: img });
                canvas.fabric.renderAll();
            });
        },

        addToCanvas: function(shape) {
            if ( ! this.shapeExists(shape)) return;
            this.selected = shape;
            console.log(shape);
            jQuery("#shapeBgColor").spectrum("set", shape.fill);
            // if(shape.stroke) jQuery("#borderstroke").spectrum("set", shape.stroke.color);
            // if(shape.shadow) jQuery("#shadowcolor").spectrum("set", shape.shadow.color);

            //we might need to enable a drawing mode instead
            //of added a shape to canvas if we get passed polygon
            if (shape.service && shape.service.enable) {
                return shape.service.enable();
            }

            var fabricShape = this.createNewShape(shape);

            canvas.fabric.add(fabricShape);
            canvas.center(fabricShape);
            canvas.fabric.setActiveObject(fabricShape);
            canvas.fabric.renderAll();
            this.selectedShape = fabricShape;

            history.add('Added: '+shape.name, 'panorama-vertical');
        },

        applyValue: function(group, name, option, value) {
            var setter = 'set'+fabric.util.string.capitalize(option, true),
                shape  = this.getShape(name);

            if (group === 'shadow') {
                return this.applyShadowValue(shape, option, value);
            }

            if (this.selected && this.selected.name === name) {
                console.log(setter);
                //use setter if available, other simply assign the value
                shape[setter] ? shape[setter](value) : shape[option] = value;
                shape.setCoords();
                canvas.fabric.setActiveObject(shape);
                canvas.fabric.renderAll();
            }
        },

        applyShadowValue: function(shape, option, value) {
            if ( ! shape) return;

            var options = {
                color: this.selected.options.shadow.color.current,
                blur: this.selected.options.shadow.blur.current,
                offsetX: this.selected.options.shadow.offsetX.current,
                offsetY: this.selected.options.shadow.offsetY.current
            };

            if (option && value) {
                options[option] = value;
            }

            shape.setShadow(options);
            canvas.fabric.renderAll();
        },

        toggleShadow: function(name, on) {
            if (on) {
                this.applyShadowValue(this.getShape(name));
            } else {
                this.getShape(name).setShadow(false);
                canvas.fabric.renderAll();
            }
        },

        /**
         * Toggle border on/off on active object in the canvas.
         *
         * @param name
         * @param on
         */
        toggleBorder: function(name, on) {
            if (on) {
                this.getShape(name).setStroke(this.selected.options.border.stroke);
            } else {
                this.getShape(name).setStroke(false);
            }

            canvas.fabric.renderAll();
        },

        shapeExists: function(shape) {
            for (var i = 0; i < this.available.length; i++) {
                if (this.available[i].name === shape.name) {
                    return true;
                }
            }
        },

        /**
         * Return a first available fabric object that matches given name.
         *
         * @param name
         * @returns {fabric.Object|*}
         */
        getShape: function(name) {
            var active = canvas.fabric.getActiveObject();

            if (active && active.name === name) {
                return active;
            }

            canvas.fabric.forEachObject(function(obj) {
                if (obj.name === name) {
                    canvas.fabric.setActiveObject(obj);
                    return active = obj;
                }
            });

            return active;
        },

        /**
         * Create new fabric shape from given config object.
         *
         * @param shape
         */
        createNewShape: function(shape) {
            var shapeName = fabric.util.string.capitalize(shape.name, true);

            console.log(shape);
            if (fabric[shapeName]) {

                var options = {
                    strokeWidth: shape.options.border.strokeWidth.current,
                    fill: shape.options.main.fill.current
                };

                angular.forEach(shape.options.main, function(val, key) {
                    if (typeof val !== 'boolean') {
                       options[key] = val.current;
                    }
                });

                if (shape.options.points) {
                    var newShape = new fabric[shapeName](shape.options.points.current, options);
                } else {
                    var newShape = new fabric[shapeName](options);
                }

                newShape.name = shape.name;

                return newShape;
            }
        },

        selectShape: function(name) {
            if ( ! name || this.selected.name === name) return;

            for (var i = 0; i < this.available.length; i++) {
                if (this.available[i].name === name) {
                    return this.selected = this.available[i];
                }
            }
        }
    };

    var circleOptions = angular.copy(shapes.baseOptions);
    circleOptions.main.radius = { type: 'slider', current: 72, min: 20 };

    shapes.available.push({
        name: 'circle',
        options: circleOptions
    });

    var rectOptions = angular.copy(shapes.baseOptions);
    rectOptions.main.width = { type: 'slider', current: 140 };
    rectOptions.main.height = { type: 'slider', current: 140 };

    shapes.available.push({
        name: 'rect',
        displayName: 'rectangle',
        options: rectOptions
    });

    var triangleOptions = angular.copy(shapes.baseOptions);
    triangleOptions.main.width = { type: 'slider', current: 140, min: 25 };
    triangleOptions.main.height = { type: 'slider', current: 140, min: 25 };

    shapes.available.push({
        name: 'triangle',
        options: triangleOptions
    });

    var ellipse = angular.copy(shapes.baseOptions);
    ellipse.main.rx = { type: 'slider', current: 80, displayName: 'horizontal radius' };
    ellipse.main.ry = { type: 'slider', current: 30, displayName: 'vertical radius' };

    shapes.available.push({
        name: 'ellipse',
        options: ellipse
    });

    shapes.available.push({
        name: 'polygon',  options: angular.copy(shapes.baseOptions), service: polygon
    });

    return shapes;
}]);
angular.module('image.shapes')

.service('polygon', ['$rootScope', '$mdDialog', 'canvas', function ($rootScope, $mdDialog, canvas) {

    var self = {

        mode: 'add',
        currentShape: false,

        onMouseMove: function(event) {
            var pos = canvas.fabric.getPointer(event.e);
            if (self.mode === "edit" && self.currentShape) {
                var points = self.currentShape.get("points");
                points[points.length - 1].x = pos.x - self.currentShape.get("left");
                points[points.length - 1].y = pos.y - self.currentShape.get("top");
                self.currentShape.set({
                    points: points
                });
                canvas.fabric.renderAll();
            }
        },

        onMouseDown: function(event) {
            var pos = canvas.fabric.getPointer(event.e);

            if (self.mode === "add") {
                var poly = new fabric.Polygon([{
                    x: pos.x,
                    y: pos.y
                }, {
                    x: pos.x + 0.5,
                    y: pos.y + 0.5
                }], {
                    fill: 'black',
                    opacity: 1,
                    selectable: false
                });
                self.currentShape = poly;
                self.currentShape.name = 'polygon';
                canvas.fabric.add(self.currentShape);
                self.mode = "edit";
            } else if (self.mode === "edit" && self.currentShape && self.currentShape.type === "polygon") {
                var points = self.currentShape.get("points");
                points.push({
                    x: pos.x - self.currentShape.get("left"),
                    y: pos.y - self.currentShape.get("top")
                });
                self.currentShape.set({
                    points: points
                });
                canvas.fabric.renderAll();
            }
        },

        onEscape: function(e) {
            if ((!e && self.currentShape) || e && e.keyCode === 27) {
                if (self.mode === 'edit' || self.mode === 'add') {
                    self.mode = 'normal';
                    self.currentShape.set({
                        selectable: true
                    });

                    self.currentShape._calcDimensions();
                    self.currentShape.setCoords();

                    canvas.fabric.setActiveObject(self.currentShape);
                    canvas.fabric.renderAll();
                } else {
                    self.mode = 'add';
                }

                self.currentShape = null;
            }
        },

        onClick: function(e) {
            var clickedInModal = $(e.target).closest('.md-dialog-container')[0];

            if (e.target.nodeName !== 'CANVAS' && $(e.target).closest('.shape').data('name') !== 'polygon' && !clickedInModal) {
                self.disable();
            }
        },

        enable: function() {
            if (this.enabled) return;

            this.enabled = true;
            canvas.fabric.on('mouse:move', self.onMouseMove);
            canvas.fabric.on('mouse:down', self.onMouseDown);
            fabric.util.addListener(window, 'keyup', self.onEscape);

            setTimeout(function() {
                fabric.util.addListener(window, 'click', self.onClick);
            }, 20);

            $mdDialog.show({
                templateUrl: 'modals/polygon.html',
                clickOutsideToClose: true,
                controller: ['$scope', '$mdDialog', function($scope, $mdDialog) {
                    $scope.closeModal = $mdDialog.hide;
                }]
            });
        },

        disable: function() {
            this.enabled = false;
            canvas.fabric.off('mouse:move', self.onMouseMove);
            canvas.fabric.off('mouse:down', self.onMouseDown);
            fabric.util.removeListener(window, 'keyup', self.onEscape);
            fabric.util.removeListener(window, 'click', self.onClick);
            self.onEscape();
        }
    };

    return self;

}]);
angular.module('ImageEditor')

.controller('ObjectsPanelController', ['$scope', '$rootScope', '$timeout', 'canvas', function($scope, $rootScope, $timeout, canvas) {
	$scope.objects = canvas.fabric._objects || [];
    $rootScope.activeObject = false;
    $scope.sortableOptions = {
        items: '.object:visible',
        scroll: false,
        containment: 'parent',
        start: function(e, ui) {
            console.log("Start");
            console.log(ui.item.index());
            ui.item.data('start', ui.item.index());
        },
        stop: function(e, ui) {
            console.log("Stop");
            console.log(ui.item.index());



        },
        update: function(e, ui) {
            console.log("Update");
            console.log(ui.item.index());

            var start = ui.item.data('start'),
                end   = ui.item.index();


            obj = canvas.fabric.getObjects()[start];

            if ( ! obj) return;

            if (end > start) {
                //send object forwards by the amount of objects it passed
                for (var i = 0; i < (end - start); i++) {
                    canvas.fabric.bringForward(obj);
                    //canvas.fabric.sendBackwards(obj);
                }
            } else {
                //send object backwards by the amount of objects it passed
                for (var i = 0; i < (start - end); i++) {
                    canvas.fabric.sendBackwards(obj);
                    //canvas.fabric.bringForward(obj);
                }
            }

            $timeout(function() {
                canvas.fabric.renderAll();
                start = false; end = false;
            });
        }
    }

    $scope.setAsActive = function(object) {
        if (object) {
            canvas.fabric.setActiveObject(object);
            $rootScope.activeObject = object;
        }
    };

    $scope.toggleVisibility = function(object) {
        if ( ! object) return;

        if (object.visible) {
            object.set({ visible: false, evented: false, selectable: false, hasBorders: false, hasCorners: false });
        } else {
            object.set({ visible: true, evented: true, selectable: true, hasBorders: true, hasCorners: true });
            canvas.fabric.setActiveObject(object);
        }

        canvas.fabric.renderAll();
    };

    $scope.deleteObject = function(object) {
        if (object) {
            canvas.fabric.remove(object);
            canvas.fabric.renderAll();
        }
    };

    $scope.toggleLock = function(object) {
        if ( ! object) return;

        if (object.locked) {
            object.set({
                locked: false,
                selectable: true,
                evented: true,
                lockMovementX: false,
                lockMovementY: false,
                lockRotation: false,
                lockScalingX: false,
                lockScalingY: false,
                lockUniScaling: false,
                hasControls: true,
                hasBorders: true
            });

            canvas.fabric.setActiveObject(object);
        } else {
            object.set({
                locked: true,
                selectable: false,
                evented: false,
                lockMovementX: true,
                lockMovementY: true,
                lockRotation: true,
                lockScalingX: true,
                lockScalingY: true,
                lockUniScaling: true,
                hasControls: false,
                hasBorders: false
            });
        }

        canvas.fabric.renderAll();
    }
}])
.filter('reverse', function() {
  return function(items) {
    return items.slice().reverse();
  };
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbG9ycy5qcyIsImdyYWRpZW50cy5qcyIsImpxdWVyeS5qcyIsImpxdWVyeS11aS5qcyIsImZpbGUtc2F2ZXIuanMiLCJwYWdpbmF0aW9uLmpzIiwic3BlY3RydW0uanMiLCJoYW1tZXIuanMiLCJzY3JvbGxiYXIuanMiLCJhbmd1bGFyLm1pbi5qcyIsImFuZ3VsYXItYW5pbWF0ZS5qcyIsImFuZ3VsYXItYXJpYS5qcyIsImFuZ3VsYXItbWF0ZXJpYWwuanMiLCJhbmd1bGFyLXNvcnRhYmxlLmpzIiwiZmFicmljLmpzIiwiQXBwLmpzIiwiTG9jYWxTdG9yYWdlLmpzIiwiU2V0dGluZ3MuanMiLCJLZXliaW5kcy5qcyIsIkNhbnZhcy5qcyIsImNyb3BwZXIuanMiLCJjcm9wem9uZS5qcyIsImNyb3BDb250cm9sbGVyLmpzIiwiUm90YXRlQ29udHJvbGxlci5qcyIsIkNhbnZhc0JhY2tncm91bmRDb250cm9sbGVyLmpzIiwiUmVzaXplQ29udHJvbGxlci5qcyIsIlJvdW5kZWRDb3JuZXJzQ29udHJvbGxlci5qcyIsInpvb21Db250cm9sbGVyLmpzIiwiVG9wUGFuZWxDb250cm9sbGVyLmpzIiwiVGFicy5qcyIsIlByZXR0eVNjcm9sbGJhci5qcyIsIkNvbG9yUGlja2VyLmpzIiwiRmlsZVVwbG9hZGVyLmpzIiwiVG9nZ2xlUGFuZWxWaXNpYmlsaXR5LmpzIiwiVG9nZ2xlU2lkZWJhci5qcyIsIlRleHQuanMiLCJUZXh0Q29udHJvbGxlci5qcyIsIlRleHRBbGlnbkJ1dHRvbnMuanMiLCJUZXh0RGVjb3JhdGlvbkJ1dHRvbnMuanMiLCJGb250cy5qcyIsIkRyYXdpbmcuanMiLCJEcmF3aW5nQ29udHJvbGxlci5qcyIsIlJlbmRlckJydXNoZXNEaXJlY3RpdmUuanMiLCJIaXN0b3J5LmpzIiwiU2F2ZXIuanMiLCJGaWx0ZXJzQ29udHJvbGxlci5qcyIsIkZpbHRlcnMuanMiLCJTaW1wbGVTaGFwZXNDb250cm9sbGVyLmpzIiwiUGhvdG9Db250cm9sbGVyLmpzIiwiUGhvdG9DYXRlZ29yaWVzLmpzIiwiU3RpY2tlcnNDb250cm9sbGVyLmpzIiwiU3RpY2tlcnNDYXRlZ29yaWVzLmpzIiwiU2ltcGxlU2hhcGVzLmpzIiwiUG9seWdvbi5qcyIsIk9iamVjdHNQYW5lbENvbnRyb2xsZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNwS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdDRHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDclhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDcFVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMvdUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMxUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDMWxFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ25WQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2xrZUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDOVZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM3UEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN0REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ25CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3RHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDcFZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN0RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM1WUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3hHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNoSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2xGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDMURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2pRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDaEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNuREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDZkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3ZIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN2SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDakJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDckJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDcE9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN2TUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzdEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2hIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3BCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMzTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ25FQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ25NQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzNGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNqUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDcEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6InNjcmlwdHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgY29sb3JzRm9yUGlja2VyID0gWycjRDI0RDU3JywgJyNGMjI2MTMnLCAnI0Q5MUUxOCcsICcjOTYyODFCJywgJyNFRjQ4MzYnLCAnI0Q2NDU0MScsICcjQzAzOTJCJywgJyNDRjAwMEYnLCAnI0U3NEMzQycsICcjREIwQTVCJywgJyNGNjQ3NDcnLCAnI0YxQTlBMCcsICcjRDI1MjdGJywgJyNFMDgyODMnLCAnI0Y2MjQ1OScsICcjRTI2QTZBJywgJyNEQ0M2RTAnLCAnIzY2MzM5OScsICcjNjc0MTcyJywgJyNBRUE4RDMnLCAnIzkxM0Q4OCcsICcjOUExMkIzJywgJyNCRjU1RUMnLCAnI0JFOTBENCcsICcjOEU0NEFEJywgJyM5QjU5QjYnLCAnIzQ0NkNCMycsICcjRTRGMUZFJywgJyM0MTgzRDcnLCAnIzU5QUJFMycsICcjODFDRkUwJywgJyM1MkIzRDknLCAnI0M1RUZGNycsICcjMjJBN0YwJywgJyMzNDk4REInLCAnIzJDM0U1MCcsICcjMTlCNUZFJywgJyMzMzZFN0InLCAnIzIyMzEzRicsICcjNkJCOUYwJywgJyMxRThCQzMnLCAnIzNBNTM5QicsICcjMzQ0OTVFJywgJyM2NzgwOUYnLCAnIzI1NzRBOScsICcjMUYzQTkzJywgJyM4OUM0RjQnLCAnIzRCNzdCRScsICcjNUM5N0JGJywgJyM0RUNEQzQnLCAnI0EyREVEMCcsICcjODdEMzdDJywgJyM5MEM2OTUnLCAnIzI2QTY1QicsICcjMDNDOUE5JywgJyM2OEMzQTMnLCAnIzY1QzZCQicsICcjMUJCQzlCJywgJyMxQkEzOUMnLCAnIzY2Q0M5OScsICcjMzZEN0I3JywgJyNDOEY3QzUnLCAnIzg2RTJENScsICcjMkVDQzcxJywgJyMxNmEwODUnLCAnIzNGQzM4MCcsICcjMDE5ODc1JywgJyMwM0E2NzgnLCAnIzREQUY3QycsICcjMkFCQjlCJywgJyMwMEIxNkEnLCAnIzFFODI0QycsICcjMDQ5MzcyJywgJyMyNkMyODEnLCAnI0ZERTNBNycsICcjRjg5NDA2JywgJyNFQjk1MzInLCAnI0U4N0UwNCcsICcjRjRCMzUwJywgJyNGMjc4NEInLCAnI0VCOTc0RScsICcjRjVBQjM1JywgJyNEMzU0MDAnLCAnI0YzOUMxMicsICcjRjk2OTBFJywgJyNGOUJGM0InLCAnI0YyNzkzNScsICcjRTY3RTIyJywgJyNlY2VjZWMnLCAnIzZDN0E4OScsICcjRDJEN0QzJywgJyNFRUVFRUUnLCAnI0JEQzNDNycsICcjRUNGMEYxJywgJyM5NUE1QTYnLCAnI0RBREZFMScsICcjQUJCN0I3JywgJyNGMkYxRUYnLCAnI0JGQkZCRicsICcjRTZFMkFGJywgJyNBN0EzN0UnLCAnI0VGRUNDQScsICcjMDQ2MzgwJywgJyMwMDJGMkYnLCAnIzQ2ODk2NicsICcjRkZGMEE1JywgJyNGRkIwM0InLCAnI0I2NDkyNicsICcjOEUyODAwJywgJyMxRTFFMjAnXTsiLCJ2YXIgZWRHcmFkaWVudHMgPSB7XG4gICAgMToge1xuICAgICAgICB0eXBlOiAnbGluZWFyJyxcbiAgICAgICAgeDE6IC04MCxcbiAgICAgICAgeTE6IDAsXG4gICAgICAgIHgyOiA4MCxcbiAgICAgICAgeTI6IDAsXG4gICAgICAgIGNvbG9yU3RvcHM6IHtcbiAgICAgICAgICAgIDA6ICcjZmZlNDdiJyxcbiAgICAgICAgICAgIDE6ICdyZ2IoMTExLDE1NCwyMTEpJ1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIDI6ICB7XG4gICAgICAgIHR5cGU6ICdsaW5lYXInLFxuICAgICAgICB4MTogMCxcbiAgICAgICAgeTE6IC0xMjAsXG4gICAgICAgIHgyOiAwLFxuICAgICAgICB5MjogMTIwLFxuICAgICAgICBjb2xvclN0b3BzOiB7XG4gICAgICAgICAgICAwOiAnI2ZmNDA0MCcsXG4gICAgICAgICAgICAxOiAnI2U2Mzk5YidcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAzOiB7XG4gICAgICAgIHR5cGU6ICdsaW5lYXInLFxuICAgICAgICB4MTogLTkwLFxuICAgICAgICB5MTogLTkwLFxuICAgICAgICB4MjogOTAsXG4gICAgICAgIHkyOiA5MCxcbiAgICAgICAgY29sb3JTdG9wczoge1xuICAgICAgICAgICAgMDogJ3JnYigxNjYsMTExLDIxMyknLFxuICAgICAgICAgICAgMC41OiAncmdiYSgxMDYsIDcyLCAyMTUsIDAuNSknLFxuICAgICAgICAgICAgMTogJyMyMDA3NzInXG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgNDoge1xuICAgICAgICB0eXBlOiAncmFkaWFsJyxcbiAgICAgICAgcjE6IDEwMCxcbiAgICAgICAgcjI6IDEwLFxuICAgICAgICB4MTogMCxcbiAgICAgICAgeTE6IDAsXG4gICAgICAgIHgyOiAwLFxuICAgICAgICB5MjogMCxcbiAgICAgICAgY29sb3JTdG9wczoge1xuICAgICAgICAgICAgMDogJyNGRjRGNEYnLFxuICAgICAgICAgICAgMTogJ3JnYigyNTUsIDIzOSwgNjQpJ1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIDU6IHtcbiAgICAgICAgdHlwZTogJ3JhZGlhbCcsXG4gICAgICAgIHIxOiAxMDAsXG4gICAgICAgIHIyOiAxMCxcbiAgICAgICAgeDE6IDAsXG4gICAgICAgIHkxOiAwLFxuICAgICAgICB4MjogMjAsXG4gICAgICAgIHkyOiAyMCxcbiAgICAgICAgY29sb3JTdG9wczoge1xuICAgICAgICAgICAgMDogJyNmZmU0N2InLFxuICAgICAgICAgICAgMC41OiAncmdiKDExMSwxNTQsMjExKScsXG4gICAgICAgICAgICAxOiAncmdiKDE2NiwxMTEsMjEzKSdcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICA2OiB7XG4gICAgICAgIHR5cGU6ICdyYWRpYWwnLFxuICAgICAgICByMTogNTAsXG4gICAgICAgIHIyOiA4MCxcbiAgICAgICAgeDE6IDQ1LFxuICAgICAgICB5MTogNDUsXG4gICAgICAgIHgyOiA1MixcbiAgICAgICAgeTI6IDUwLFxuICAgICAgICBjb2xvclN0b3BzOiB7XG4gICAgICAgICAgICAwOiAncmdiKDE1NSwgMjM3LCAwKScsXG4gICAgICAgICAgICAxOiAncmdiYSgwLCAxNjQsIDEyOCwwLjQpJ1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIDc6IHtcbiAgICAgICAgdHlwZTogJ2xpbmVhcicsXG4gICAgICAgIHgxOiAtOTAsXG4gICAgICAgIHkxOiAtOTAsXG4gICAgICAgIHgyOiA5MCxcbiAgICAgICAgeTI6IDkwLFxuICAgICAgICBjb2xvclN0b3BzOiB7XG4gICAgICAgICAgICAwOiAnIzllY2IyZCcsXG4gICAgICAgICAgICAwLjU6ICcjNzJhYTAwJyxcbiAgICAgICAgICAgIDE6ICcjYmZkMjU1J1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIDg6IHtcbiAgICAgICAgdHlwZTogJ3JhZGlhbCcsXG4gICAgICAgIHIxOiAxMDAsXG4gICAgICAgIHIyOiA1MCxcbiAgICAgICAgeDE6IDMwLFxuICAgICAgICB5MTogMCxcbiAgICAgICAgeDI6IDAsXG4gICAgICAgIHkyOiAwLFxuICAgICAgICBjb2xvclN0b3BzOiB7XG4gICAgICAgICAgICAwOiAnI2FlYmNiZicsXG4gICAgICAgICAgICAxOiAnIzBhMDgwOSdcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICA5OiB7XG4gICAgICAgIHR5cGU6ICdsaW5lYXInLFxuICAgICAgICB4MTogLTgwLFxuICAgICAgICB5MTogMCxcbiAgICAgICAgeDI6IDgwLFxuICAgICAgICB5MjogMCxcbiAgICAgICAgY29sb3JTdG9wczoge1xuICAgICAgICAgICAgMDogJyNmZmZmZmYnLFxuICAgICAgICAgICAgMTogJyNmNmY2ZjYnXG4gICAgICAgIH1cbiAgICB9LFxuICAgIDEwOiAge1xuICAgICAgICB0eXBlOiAnbGluZWFyJyxcbiAgICAgICAgeDE6IDAsXG4gICAgICAgIHkxOiAtMTIwLFxuICAgICAgICB4MjogMCxcbiAgICAgICAgeTI6IDEyMCxcbiAgICAgICAgY29sb3JTdG9wczoge1xuICAgICAgICAgICAgMDogJyNmZWZjZWEnLFxuICAgICAgICAgICAgMTogJyNmMWRhMzYnXG4gICAgICAgIH1cbiAgICB9LFxuICAgIDExOiB7XG4gICAgICAgIHR5cGU6ICdsaW5lYXInLFxuICAgICAgICB4MTogLTkwLFxuICAgICAgICB5MTogLTkwLFxuICAgICAgICB4MjogOTAsXG4gICAgICAgIHkyOiA5MCxcbiAgICAgICAgY29sb3JTdG9wczoge1xuICAgICAgICAgICAgMDogJ3JnYigxNjYsMTExLDIxMyknLFxuICAgICAgICAgICAgMC41OiAncmdiYSgxMDYsIDcyLCAyMTUsIDAuNSknLFxuICAgICAgICAgICAgMTogJyNmZjFhMDAnXG4gICAgICAgIH1cbiAgICB9LFxuICAgIDEyOiAge1xuICAgICAgICB0eXBlOiAnbGluZWFyJyxcbiAgICAgICAgeDE6IDAsXG4gICAgICAgIHkxOiAtMTIwLFxuICAgICAgICB4MjogMCxcbiAgICAgICAgeTI6IDEyMCxcbiAgICAgICAgY29sb3JTdG9wczoge1xuICAgICAgICAgICAgMDogJyNiN2RlZWQnLFxuICAgICAgICAgICAgMTogJyMyMWI0ZTInXG4gICAgICAgIH1cbiAgICB9LFxuICAgIDEzOiB7XG4gICAgICAgIHR5cGU6ICdsaW5lYXInLFxuICAgICAgICB4MTogLTgwLFxuICAgICAgICB5MTogMTAwLFxuICAgICAgICB4MjogODAsXG4gICAgICAgIHkyOiAtMTAwLFxuICAgICAgICBjb2xvclN0b3BzOiB7XG4gICAgICAgICAgICAwOiAnI2ZmZTQ3YicsXG4gICAgICAgICAgICAxOiAncmdiKDExMSwxNTQsMjExKSdcbiAgICAgICAgfVxuICAgIH0sXG59OyIsIi8qISBqUXVlcnkgdjIuMS4zIHwgKGMpIDIwMDUsIDIwMTQgalF1ZXJ5IEZvdW5kYXRpb24sIEluYy4gfCBqcXVlcnkub3JnL2xpY2Vuc2UgKi9cbiFmdW5jdGlvbihhLGIpe1wib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1hLmRvY3VtZW50P2IoYSwhMCk6ZnVuY3Rpb24oYSl7aWYoIWEuZG9jdW1lbnQpdGhyb3cgbmV3IEVycm9yKFwialF1ZXJ5IHJlcXVpcmVzIGEgd2luZG93IHdpdGggYSBkb2N1bWVudFwiKTtyZXR1cm4gYihhKX06YihhKX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6dGhpcyxmdW5jdGlvbihhLGIpe3ZhciBjPVtdLGQ9Yy5zbGljZSxlPWMuY29uY2F0LGY9Yy5wdXNoLGc9Yy5pbmRleE9mLGg9e30saT1oLnRvU3RyaW5nLGo9aC5oYXNPd25Qcm9wZXJ0eSxrPXt9LGw9YS5kb2N1bWVudCxtPVwiMi4xLjNcIixuPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBuLmZuLmluaXQoYSxiKX0sbz0vXltcXHNcXHVGRUZGXFx4QTBdK3xbXFxzXFx1RkVGRlxceEEwXSskL2cscD0vXi1tcy0vLHE9Ly0oW1xcZGEtel0pL2dpLHI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYi50b1VwcGVyQ2FzZSgpfTtuLmZuPW4ucHJvdG90eXBlPXtqcXVlcnk6bSxjb25zdHJ1Y3RvcjpuLHNlbGVjdG9yOlwiXCIsbGVuZ3RoOjAsdG9BcnJheTpmdW5jdGlvbigpe3JldHVybiBkLmNhbGwodGhpcyl9LGdldDpmdW5jdGlvbihhKXtyZXR1cm4gbnVsbCE9YT8wPmE/dGhpc1thK3RoaXMubGVuZ3RoXTp0aGlzW2FdOmQuY2FsbCh0aGlzKX0scHVzaFN0YWNrOmZ1bmN0aW9uKGEpe3ZhciBiPW4ubWVyZ2UodGhpcy5jb25zdHJ1Y3RvcigpLGEpO3JldHVybiBiLnByZXZPYmplY3Q9dGhpcyxiLmNvbnRleHQ9dGhpcy5jb250ZXh0LGJ9LGVhY2g6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbi5lYWNoKHRoaXMsYSxiKX0sbWFwOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnB1c2hTdGFjayhuLm1hcCh0aGlzLGZ1bmN0aW9uKGIsYyl7cmV0dXJuIGEuY2FsbChiLGMsYil9KSl9LHNsaWNlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGQuYXBwbHkodGhpcyxhcmd1bWVudHMpKX0sZmlyc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lcSgwKX0sbGFzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVxKC0xKX0sZXE6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5sZW5ndGgsYz0rYSsoMD5hP2I6MCk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGM+PTAmJmI+Yz9bdGhpc1tjXV06W10pfSxlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wcmV2T2JqZWN0fHx0aGlzLmNvbnN0cnVjdG9yKG51bGwpfSxwdXNoOmYsc29ydDpjLnNvcnQsc3BsaWNlOmMuc3BsaWNlfSxuLmV4dGVuZD1uLmZuLmV4dGVuZD1mdW5jdGlvbigpe3ZhciBhLGIsYyxkLGUsZixnPWFyZ3VtZW50c1swXXx8e30saD0xLGk9YXJndW1lbnRzLmxlbmd0aCxqPSExO2ZvcihcImJvb2xlYW5cIj09dHlwZW9mIGcmJihqPWcsZz1hcmd1bWVudHNbaF18fHt9LGgrKyksXCJvYmplY3RcIj09dHlwZW9mIGd8fG4uaXNGdW5jdGlvbihnKXx8KGc9e30pLGg9PT1pJiYoZz10aGlzLGgtLSk7aT5oO2grKylpZihudWxsIT0oYT1hcmd1bWVudHNbaF0pKWZvcihiIGluIGEpYz1nW2JdLGQ9YVtiXSxnIT09ZCYmKGomJmQmJihuLmlzUGxhaW5PYmplY3QoZCl8fChlPW4uaXNBcnJheShkKSkpPyhlPyhlPSExLGY9YyYmbi5pc0FycmF5KGMpP2M6W10pOmY9YyYmbi5pc1BsYWluT2JqZWN0KGMpP2M6e30sZ1tiXT1uLmV4dGVuZChqLGYsZCkpOnZvaWQgMCE9PWQmJihnW2JdPWQpKTtyZXR1cm4gZ30sbi5leHRlbmQoe2V4cGFuZG86XCJqUXVlcnlcIisobStNYXRoLnJhbmRvbSgpKS5yZXBsYWNlKC9cXEQvZyxcIlwiKSxpc1JlYWR5OiEwLGVycm9yOmZ1bmN0aW9uKGEpe3Rocm93IG5ldyBFcnJvcihhKX0sbm9vcDpmdW5jdGlvbigpe30saXNGdW5jdGlvbjpmdW5jdGlvbihhKXtyZXR1cm5cImZ1bmN0aW9uXCI9PT1uLnR5cGUoYSl9LGlzQXJyYXk6QXJyYXkuaXNBcnJheSxpc1dpbmRvdzpmdW5jdGlvbihhKXtyZXR1cm4gbnVsbCE9YSYmYT09PWEud2luZG93fSxpc051bWVyaWM6ZnVuY3Rpb24oYSl7cmV0dXJuIW4uaXNBcnJheShhKSYmYS1wYXJzZUZsb2F0KGEpKzE+PTB9LGlzUGxhaW5PYmplY3Q6ZnVuY3Rpb24oYSl7cmV0dXJuXCJvYmplY3RcIiE9PW4udHlwZShhKXx8YS5ub2RlVHlwZXx8bi5pc1dpbmRvdyhhKT8hMTphLmNvbnN0cnVjdG9yJiYhai5jYWxsKGEuY29uc3RydWN0b3IucHJvdG90eXBlLFwiaXNQcm90b3R5cGVPZlwiKT8hMTohMH0saXNFbXB0eU9iamVjdDpmdW5jdGlvbihhKXt2YXIgYjtmb3IoYiBpbiBhKXJldHVybiExO3JldHVybiEwfSx0eXBlOmZ1bmN0aW9uKGEpe3JldHVybiBudWxsPT1hP2ErXCJcIjpcIm9iamVjdFwiPT10eXBlb2YgYXx8XCJmdW5jdGlvblwiPT10eXBlb2YgYT9oW2kuY2FsbChhKV18fFwib2JqZWN0XCI6dHlwZW9mIGF9LGdsb2JhbEV2YWw6ZnVuY3Rpb24oYSl7dmFyIGIsYz1ldmFsO2E9bi50cmltKGEpLGEmJigxPT09YS5pbmRleE9mKFwidXNlIHN0cmljdFwiKT8oYj1sLmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIiksYi50ZXh0PWEsbC5oZWFkLmFwcGVuZENoaWxkKGIpLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYikpOmMoYSkpfSxjYW1lbENhc2U6ZnVuY3Rpb24oYSl7cmV0dXJuIGEucmVwbGFjZShwLFwibXMtXCIpLnJlcGxhY2UocSxyKX0sbm9kZU5hbWU6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5ub2RlTmFtZSYmYS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09Yi50b0xvd2VyQ2FzZSgpfSxlYWNoOmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlPTAsZj1hLmxlbmd0aCxnPXMoYSk7aWYoYyl7aWYoZyl7Zm9yKDtmPmU7ZSsrKWlmKGQ9Yi5hcHBseShhW2VdLGMpLGQ9PT0hMSlicmVha31lbHNlIGZvcihlIGluIGEpaWYoZD1iLmFwcGx5KGFbZV0sYyksZD09PSExKWJyZWFrfWVsc2UgaWYoZyl7Zm9yKDtmPmU7ZSsrKWlmKGQ9Yi5jYWxsKGFbZV0sZSxhW2VdKSxkPT09ITEpYnJlYWt9ZWxzZSBmb3IoZSBpbiBhKWlmKGQ9Yi5jYWxsKGFbZV0sZSxhW2VdKSxkPT09ITEpYnJlYWs7cmV0dXJuIGF9LHRyaW06ZnVuY3Rpb24oYSl7cmV0dXJuIG51bGw9PWE/XCJcIjooYStcIlwiKS5yZXBsYWNlKG8sXCJcIil9LG1ha2VBcnJheTpmdW5jdGlvbihhLGIpe3ZhciBjPWJ8fFtdO3JldHVybiBudWxsIT1hJiYocyhPYmplY3QoYSkpP24ubWVyZ2UoYyxcInN0cmluZ1wiPT10eXBlb2YgYT9bYV06YSk6Zi5jYWxsKGMsYSkpLGN9LGluQXJyYXk6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBudWxsPT1iPy0xOmcuY2FsbChiLGEsYyl9LG1lcmdlOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPStiLmxlbmd0aCxkPTAsZT1hLmxlbmd0aDtjPmQ7ZCsrKWFbZSsrXT1iW2RdO3JldHVybiBhLmxlbmd0aD1lLGF9LGdyZXA6ZnVuY3Rpb24oYSxiLGMpe2Zvcih2YXIgZCxlPVtdLGY9MCxnPWEubGVuZ3RoLGg9IWM7Zz5mO2YrKylkPSFiKGFbZl0sZiksZCE9PWgmJmUucHVzaChhW2ZdKTtyZXR1cm4gZX0sbWFwOmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxmPTAsZz1hLmxlbmd0aCxoPXMoYSksaT1bXTtpZihoKWZvcig7Zz5mO2YrKylkPWIoYVtmXSxmLGMpLG51bGwhPWQmJmkucHVzaChkKTtlbHNlIGZvcihmIGluIGEpZD1iKGFbZl0sZixjKSxudWxsIT1kJiZpLnB1c2goZCk7cmV0dXJuIGUuYXBwbHkoW10saSl9LGd1aWQ6MSxwcm94eTpmdW5jdGlvbihhLGIpe3ZhciBjLGUsZjtyZXR1cm5cInN0cmluZ1wiPT10eXBlb2YgYiYmKGM9YVtiXSxiPWEsYT1jKSxuLmlzRnVuY3Rpb24oYSk/KGU9ZC5jYWxsKGFyZ3VtZW50cywyKSxmPWZ1bmN0aW9uKCl7cmV0dXJuIGEuYXBwbHkoYnx8dGhpcyxlLmNvbmNhdChkLmNhbGwoYXJndW1lbnRzKSkpfSxmLmd1aWQ9YS5ndWlkPWEuZ3VpZHx8bi5ndWlkKyssZik6dm9pZCAwfSxub3c6RGF0ZS5ub3csc3VwcG9ydDprfSksbi5lYWNoKFwiQm9vbGVhbiBOdW1iZXIgU3RyaW5nIEZ1bmN0aW9uIEFycmF5IERhdGUgUmVnRXhwIE9iamVjdCBFcnJvclwiLnNwbGl0KFwiIFwiKSxmdW5jdGlvbihhLGIpe2hbXCJbb2JqZWN0IFwiK2IrXCJdXCJdPWIudG9Mb3dlckNhc2UoKX0pO2Z1bmN0aW9uIHMoYSl7dmFyIGI9YS5sZW5ndGgsYz1uLnR5cGUoYSk7cmV0dXJuXCJmdW5jdGlvblwiPT09Y3x8bi5pc1dpbmRvdyhhKT8hMToxPT09YS5ub2RlVHlwZSYmYj8hMDpcImFycmF5XCI9PT1jfHwwPT09Ynx8XCJudW1iZXJcIj09dHlwZW9mIGImJmI+MCYmYi0xIGluIGF9dmFyIHQ9ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGUsZixnLGgsaSxqLGssbCxtLG4sbyxwLHEscixzLHQsdT1cInNpenpsZVwiKzEqbmV3IERhdGUsdj1hLmRvY3VtZW50LHc9MCx4PTAseT1oYigpLHo9aGIoKSxBPWhiKCksQj1mdW5jdGlvbihhLGIpe3JldHVybiBhPT09YiYmKGw9ITApLDB9LEM9MTw8MzEsRD17fS5oYXNPd25Qcm9wZXJ0eSxFPVtdLEY9RS5wb3AsRz1FLnB1c2gsSD1FLnB1c2gsST1FLnNsaWNlLEo9ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9MCxkPWEubGVuZ3RoO2Q+YztjKyspaWYoYVtjXT09PWIpcmV0dXJuIGM7cmV0dXJuLTF9LEs9XCJjaGVja2VkfHNlbGVjdGVkfGFzeW5jfGF1dG9mb2N1c3xhdXRvcGxheXxjb250cm9sc3xkZWZlcnxkaXNhYmxlZHxoaWRkZW58aXNtYXB8bG9vcHxtdWx0aXBsZXxvcGVufHJlYWRvbmx5fHJlcXVpcmVkfHNjb3BlZFwiLEw9XCJbXFxcXHgyMFxcXFx0XFxcXHJcXFxcblxcXFxmXVwiLE09XCIoPzpcXFxcXFxcXC58W1xcXFx3LV18W15cXFxceDAwLVxcXFx4YTBdKStcIixOPU0ucmVwbGFjZShcIndcIixcIncjXCIpLE89XCJcXFxcW1wiK0wrXCIqKFwiK00rXCIpKD86XCIrTCtcIiooWypeJHwhfl0/PSlcIitMK1wiKig/OicoKD86XFxcXFxcXFwufFteXFxcXFxcXFwnXSkqKSd8XFxcIigoPzpcXFxcXFxcXC58W15cXFxcXFxcXFxcXCJdKSopXFxcInwoXCIrTitcIikpfClcIitMK1wiKlxcXFxdXCIsUD1cIjooXCIrTStcIikoPzpcXFxcKCgoJygoPzpcXFxcXFxcXC58W15cXFxcXFxcXCddKSopJ3xcXFwiKCg/OlxcXFxcXFxcLnxbXlxcXFxcXFxcXFxcIl0pKilcXFwiKXwoKD86XFxcXFxcXFwufFteXFxcXFxcXFwoKVtcXFxcXV18XCIrTytcIikqKXwuKilcXFxcKXwpXCIsUT1uZXcgUmVnRXhwKEwrXCIrXCIsXCJnXCIpLFI9bmV3IFJlZ0V4cChcIl5cIitMK1wiK3woKD86XnxbXlxcXFxcXFxcXSkoPzpcXFxcXFxcXC4pKilcIitMK1wiKyRcIixcImdcIiksUz1uZXcgUmVnRXhwKFwiXlwiK0wrXCIqLFwiK0wrXCIqXCIpLFQ9bmV3IFJlZ0V4cChcIl5cIitMK1wiKihbPit+XXxcIitMK1wiKVwiK0wrXCIqXCIpLFU9bmV3IFJlZ0V4cChcIj1cIitMK1wiKihbXlxcXFxdJ1xcXCJdKj8pXCIrTCtcIipcXFxcXVwiLFwiZ1wiKSxWPW5ldyBSZWdFeHAoUCksVz1uZXcgUmVnRXhwKFwiXlwiK04rXCIkXCIpLFg9e0lEOm5ldyBSZWdFeHAoXCJeIyhcIitNK1wiKVwiKSxDTEFTUzpuZXcgUmVnRXhwKFwiXlxcXFwuKFwiK00rXCIpXCIpLFRBRzpuZXcgUmVnRXhwKFwiXihcIitNLnJlcGxhY2UoXCJ3XCIsXCJ3KlwiKStcIilcIiksQVRUUjpuZXcgUmVnRXhwKFwiXlwiK08pLFBTRVVETzpuZXcgUmVnRXhwKFwiXlwiK1ApLENISUxEOm5ldyBSZWdFeHAoXCJeOihvbmx5fGZpcnN0fGxhc3R8bnRofG50aC1sYXN0KS0oY2hpbGR8b2YtdHlwZSkoPzpcXFxcKFwiK0wrXCIqKGV2ZW58b2RkfCgoWystXXwpKFxcXFxkKilufClcIitMK1wiKig/OihbKy1dfClcIitMK1wiKihcXFxcZCspfCkpXCIrTCtcIipcXFxcKXwpXCIsXCJpXCIpLGJvb2w6bmV3IFJlZ0V4cChcIl4oPzpcIitLK1wiKSRcIixcImlcIiksbmVlZHNDb250ZXh0Om5ldyBSZWdFeHAoXCJeXCIrTCtcIipbPit+XXw6KGV2ZW58b2RkfGVxfGd0fGx0fG50aHxmaXJzdHxsYXN0KSg/OlxcXFwoXCIrTCtcIiooKD86LVxcXFxkKT9cXFxcZCopXCIrTCtcIipcXFxcKXwpKD89W14tXXwkKVwiLFwiaVwiKX0sWT0vXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24pJC9pLFo9L15oXFxkJC9pLCQ9L15bXntdK1xce1xccypcXFtuYXRpdmUgXFx3LyxfPS9eKD86IyhbXFx3LV0rKXwoXFx3Kyl8XFwuKFtcXHctXSspKSQvLGFiPS9bK35dLyxiYj0vJ3xcXFxcL2csY2I9bmV3IFJlZ0V4cChcIlxcXFxcXFxcKFtcXFxcZGEtZl17MSw2fVwiK0wrXCI/fChcIitMK1wiKXwuKVwiLFwiaWdcIiksZGI9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPVwiMHhcIitiLTY1NTM2O3JldHVybiBkIT09ZHx8Yz9iOjA+ZD9TdHJpbmcuZnJvbUNoYXJDb2RlKGQrNjU1MzYpOlN0cmluZy5mcm9tQ2hhckNvZGUoZD4+MTB8NTUyOTYsMTAyMyZkfDU2MzIwKX0sZWI9ZnVuY3Rpb24oKXttKCl9O3RyeXtILmFwcGx5KEU9SS5jYWxsKHYuY2hpbGROb2Rlcyksdi5jaGlsZE5vZGVzKSxFW3YuY2hpbGROb2Rlcy5sZW5ndGhdLm5vZGVUeXBlfWNhdGNoKGZiKXtIPXthcHBseTpFLmxlbmd0aD9mdW5jdGlvbihhLGIpe0cuYXBwbHkoYSxJLmNhbGwoYikpfTpmdW5jdGlvbihhLGIpe3ZhciBjPWEubGVuZ3RoLGQ9MDt3aGlsZShhW2MrK109YltkKytdKTthLmxlbmd0aD1jLTF9fX1mdW5jdGlvbiBnYihhLGIsZCxlKXt2YXIgZixoLGosayxsLG8scixzLHcseDtpZigoYj9iLm93bmVyRG9jdW1lbnR8fGI6dikhPT1uJiZtKGIpLGI9Ynx8bixkPWR8fFtdLGs9Yi5ub2RlVHlwZSxcInN0cmluZ1wiIT10eXBlb2YgYXx8IWF8fDEhPT1rJiY5IT09ayYmMTEhPT1rKXJldHVybiBkO2lmKCFlJiZwKXtpZigxMSE9PWsmJihmPV8uZXhlYyhhKSkpaWYoaj1mWzFdKXtpZig5PT09ayl7aWYoaD1iLmdldEVsZW1lbnRCeUlkKGopLCFofHwhaC5wYXJlbnROb2RlKXJldHVybiBkO2lmKGguaWQ9PT1qKXJldHVybiBkLnB1c2goaCksZH1lbHNlIGlmKGIub3duZXJEb2N1bWVudCYmKGg9Yi5vd25lckRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGopKSYmdChiLGgpJiZoLmlkPT09ailyZXR1cm4gZC5wdXNoKGgpLGR9ZWxzZXtpZihmWzJdKXJldHVybiBILmFwcGx5KGQsYi5nZXRFbGVtZW50c0J5VGFnTmFtZShhKSksZDtpZigoaj1mWzNdKSYmYy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKXJldHVybiBILmFwcGx5KGQsYi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGopKSxkfWlmKGMucXNhJiYoIXF8fCFxLnRlc3QoYSkpKXtpZihzPXI9dSx3PWIseD0xIT09ayYmYSwxPT09ayYmXCJvYmplY3RcIiE9PWIubm9kZU5hbWUudG9Mb3dlckNhc2UoKSl7bz1nKGEpLChyPWIuZ2V0QXR0cmlidXRlKFwiaWRcIikpP3M9ci5yZXBsYWNlKGJiLFwiXFxcXCQmXCIpOmIuc2V0QXR0cmlidXRlKFwiaWRcIixzKSxzPVwiW2lkPSdcIitzK1wiJ10gXCIsbD1vLmxlbmd0aDt3aGlsZShsLS0pb1tsXT1zK3JiKG9bbF0pO3c9YWIudGVzdChhKSYmcGIoYi5wYXJlbnROb2RlKXx8Yix4PW8uam9pbihcIixcIil9aWYoeCl0cnl7cmV0dXJuIEguYXBwbHkoZCx3LnF1ZXJ5U2VsZWN0b3JBbGwoeCkpLGR9Y2F0Y2goeSl7fWZpbmFsbHl7cnx8Yi5yZW1vdmVBdHRyaWJ1dGUoXCJpZFwiKX19fXJldHVybiBpKGEucmVwbGFjZShSLFwiJDFcIiksYixkLGUpfWZ1bmN0aW9uIGhiKCl7dmFyIGE9W107ZnVuY3Rpb24gYihjLGUpe3JldHVybiBhLnB1c2goYytcIiBcIik+ZC5jYWNoZUxlbmd0aCYmZGVsZXRlIGJbYS5zaGlmdCgpXSxiW2MrXCIgXCJdPWV9cmV0dXJuIGJ9ZnVuY3Rpb24gaWIoYSl7cmV0dXJuIGFbdV09ITAsYX1mdW5jdGlvbiBqYihhKXt2YXIgYj1uLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7dHJ5e3JldHVybiEhYShiKX1jYXRjaChjKXtyZXR1cm4hMX1maW5hbGx5e2IucGFyZW50Tm9kZSYmYi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGIpLGI9bnVsbH19ZnVuY3Rpb24ga2IoYSxiKXt2YXIgYz1hLnNwbGl0KFwifFwiKSxlPWEubGVuZ3RoO3doaWxlKGUtLSlkLmF0dHJIYW5kbGVbY1tlXV09Yn1mdW5jdGlvbiBsYihhLGIpe3ZhciBjPWImJmEsZD1jJiYxPT09YS5ub2RlVHlwZSYmMT09PWIubm9kZVR5cGUmJih+Yi5zb3VyY2VJbmRleHx8QyktKH5hLnNvdXJjZUluZGV4fHxDKTtpZihkKXJldHVybiBkO2lmKGMpd2hpbGUoYz1jLm5leHRTaWJsaW5nKWlmKGM9PT1iKXJldHVybi0xO3JldHVybiBhPzE6LTF9ZnVuY3Rpb24gbWIoYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3ZhciBjPWIubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm5cImlucHV0XCI9PT1jJiZiLnR5cGU9PT1hfX1mdW5jdGlvbiBuYihhKXtyZXR1cm4gZnVuY3Rpb24oYil7dmFyIGM9Yi5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO3JldHVybihcImlucHV0XCI9PT1jfHxcImJ1dHRvblwiPT09YykmJmIudHlwZT09PWF9fWZ1bmN0aW9uIG9iKGEpe3JldHVybiBpYihmdW5jdGlvbihiKXtyZXR1cm4gYj0rYixpYihmdW5jdGlvbihjLGQpe3ZhciBlLGY9YShbXSxjLmxlbmd0aCxiKSxnPWYubGVuZ3RoO3doaWxlKGctLSljW2U9ZltnXV0mJihjW2VdPSEoZFtlXT1jW2VdKSl9KX0pfWZ1bmN0aW9uIHBiKGEpe3JldHVybiBhJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgYS5nZXRFbGVtZW50c0J5VGFnTmFtZSYmYX1jPWdiLnN1cHBvcnQ9e30sZj1nYi5pc1hNTD1mdW5jdGlvbihhKXt2YXIgYj1hJiYoYS5vd25lckRvY3VtZW50fHxhKS5kb2N1bWVudEVsZW1lbnQ7cmV0dXJuIGI/XCJIVE1MXCIhPT1iLm5vZGVOYW1lOiExfSxtPWdiLnNldERvY3VtZW50PWZ1bmN0aW9uKGEpe3ZhciBiLGUsZz1hP2Eub3duZXJEb2N1bWVudHx8YTp2O3JldHVybiBnIT09biYmOT09PWcubm9kZVR5cGUmJmcuZG9jdW1lbnRFbGVtZW50PyhuPWcsbz1nLmRvY3VtZW50RWxlbWVudCxlPWcuZGVmYXVsdFZpZXcsZSYmZSE9PWUudG9wJiYoZS5hZGRFdmVudExpc3RlbmVyP2UuYWRkRXZlbnRMaXN0ZW5lcihcInVubG9hZFwiLGViLCExKTplLmF0dGFjaEV2ZW50JiZlLmF0dGFjaEV2ZW50KFwib251bmxvYWRcIixlYikpLHA9IWYoZyksYy5hdHRyaWJ1dGVzPWpiKGZ1bmN0aW9uKGEpe3JldHVybiBhLmNsYXNzTmFtZT1cImlcIiwhYS5nZXRBdHRyaWJ1dGUoXCJjbGFzc05hbWVcIil9KSxjLmdldEVsZW1lbnRzQnlUYWdOYW1lPWpiKGZ1bmN0aW9uKGEpe3JldHVybiBhLmFwcGVuZENoaWxkKGcuY3JlYXRlQ29tbWVudChcIlwiKSksIWEuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCIqXCIpLmxlbmd0aH0pLGMuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZT0kLnRlc3QoZy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKSxjLmdldEJ5SWQ9amIoZnVuY3Rpb24oYSl7cmV0dXJuIG8uYXBwZW5kQ2hpbGQoYSkuaWQ9dSwhZy5nZXRFbGVtZW50c0J5TmFtZXx8IWcuZ2V0RWxlbWVudHNCeU5hbWUodSkubGVuZ3RofSksYy5nZXRCeUlkPyhkLmZpbmQuSUQ9ZnVuY3Rpb24oYSxiKXtpZihcInVuZGVmaW5lZFwiIT10eXBlb2YgYi5nZXRFbGVtZW50QnlJZCYmcCl7dmFyIGM9Yi5nZXRFbGVtZW50QnlJZChhKTtyZXR1cm4gYyYmYy5wYXJlbnROb2RlP1tjXTpbXX19LGQuZmlsdGVyLklEPWZ1bmN0aW9uKGEpe3ZhciBiPWEucmVwbGFjZShjYixkYik7cmV0dXJuIGZ1bmN0aW9uKGEpe3JldHVybiBhLmdldEF0dHJpYnV0ZShcImlkXCIpPT09Yn19KTooZGVsZXRlIGQuZmluZC5JRCxkLmZpbHRlci5JRD1mdW5jdGlvbihhKXt2YXIgYj1hLnJlcGxhY2UoY2IsZGIpO3JldHVybiBmdW5jdGlvbihhKXt2YXIgYz1cInVuZGVmaW5lZFwiIT10eXBlb2YgYS5nZXRBdHRyaWJ1dGVOb2RlJiZhLmdldEF0dHJpYnV0ZU5vZGUoXCJpZFwiKTtyZXR1cm4gYyYmYy52YWx1ZT09PWJ9fSksZC5maW5kLlRBRz1jLmdldEVsZW1lbnRzQnlUYWdOYW1lP2Z1bmN0aW9uKGEsYil7cmV0dXJuXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGIuZ2V0RWxlbWVudHNCeVRhZ05hbWU/Yi5nZXRFbGVtZW50c0J5VGFnTmFtZShhKTpjLnFzYT9iLnF1ZXJ5U2VsZWN0b3JBbGwoYSk6dm9pZCAwfTpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9W10sZT0wLGY9Yi5nZXRFbGVtZW50c0J5VGFnTmFtZShhKTtpZihcIipcIj09PWEpe3doaWxlKGM9ZltlKytdKTE9PT1jLm5vZGVUeXBlJiZkLnB1c2goYyk7cmV0dXJuIGR9cmV0dXJuIGZ9LGQuZmluZC5DTEFTUz1jLmdldEVsZW1lbnRzQnlDbGFzc05hbWUmJmZ1bmN0aW9uKGEsYil7cmV0dXJuIHA/Yi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGEpOnZvaWQgMH0scj1bXSxxPVtdLChjLnFzYT0kLnRlc3QoZy5xdWVyeVNlbGVjdG9yQWxsKSkmJihqYihmdW5jdGlvbihhKXtvLmFwcGVuZENoaWxkKGEpLmlubmVySFRNTD1cIjxhIGlkPSdcIit1K1wiJz48L2E+PHNlbGVjdCBpZD0nXCIrdStcIi1cXGZdJyBtc2FsbG93Y2FwdHVyZT0nJz48b3B0aW9uIHNlbGVjdGVkPScnPjwvb3B0aW9uPjwvc2VsZWN0PlwiLGEucXVlcnlTZWxlY3RvckFsbChcIlttc2FsbG93Y2FwdHVyZV49JyddXCIpLmxlbmd0aCYmcS5wdXNoKFwiWypeJF09XCIrTCtcIiooPzonJ3xcXFwiXFxcIilcIiksYS5xdWVyeVNlbGVjdG9yQWxsKFwiW3NlbGVjdGVkXVwiKS5sZW5ndGh8fHEucHVzaChcIlxcXFxbXCIrTCtcIiooPzp2YWx1ZXxcIitLK1wiKVwiKSxhLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbaWR+PVwiK3UrXCItXVwiKS5sZW5ndGh8fHEucHVzaChcIn49XCIpLGEucXVlcnlTZWxlY3RvckFsbChcIjpjaGVja2VkXCIpLmxlbmd0aHx8cS5wdXNoKFwiOmNoZWNrZWRcIiksYS5xdWVyeVNlbGVjdG9yQWxsKFwiYSNcIit1K1wiKypcIikubGVuZ3RofHxxLnB1c2goXCIuIy4rWyt+XVwiKX0pLGpiKGZ1bmN0aW9uKGEpe3ZhciBiPWcuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO2Iuc2V0QXR0cmlidXRlKFwidHlwZVwiLFwiaGlkZGVuXCIpLGEuYXBwZW5kQ2hpbGQoYikuc2V0QXR0cmlidXRlKFwibmFtZVwiLFwiRFwiKSxhLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbbmFtZT1kXVwiKS5sZW5ndGgmJnEucHVzaChcIm5hbWVcIitMK1wiKlsqXiR8IX5dPz1cIiksYS5xdWVyeVNlbGVjdG9yQWxsKFwiOmVuYWJsZWRcIikubGVuZ3RofHxxLnB1c2goXCI6ZW5hYmxlZFwiLFwiOmRpc2FibGVkXCIpLGEucXVlcnlTZWxlY3RvckFsbChcIiosOnhcIikscS5wdXNoKFwiLC4qOlwiKX0pKSwoYy5tYXRjaGVzU2VsZWN0b3I9JC50ZXN0KHM9by5tYXRjaGVzfHxvLndlYmtpdE1hdGNoZXNTZWxlY3Rvcnx8by5tb3pNYXRjaGVzU2VsZWN0b3J8fG8ub01hdGNoZXNTZWxlY3Rvcnx8by5tc01hdGNoZXNTZWxlY3RvcikpJiZqYihmdW5jdGlvbihhKXtjLmRpc2Nvbm5lY3RlZE1hdGNoPXMuY2FsbChhLFwiZGl2XCIpLHMuY2FsbChhLFwiW3MhPScnXTp4XCIpLHIucHVzaChcIiE9XCIsUCl9KSxxPXEubGVuZ3RoJiZuZXcgUmVnRXhwKHEuam9pbihcInxcIikpLHI9ci5sZW5ndGgmJm5ldyBSZWdFeHAoci5qb2luKFwifFwiKSksYj0kLnRlc3Qoby5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiksdD1ifHwkLnRlc3Qoby5jb250YWlucyk/ZnVuY3Rpb24oYSxiKXt2YXIgYz05PT09YS5ub2RlVHlwZT9hLmRvY3VtZW50RWxlbWVudDphLGQ9YiYmYi5wYXJlbnROb2RlO3JldHVybiBhPT09ZHx8ISghZHx8MSE9PWQubm9kZVR5cGV8fCEoYy5jb250YWlucz9jLmNvbnRhaW5zKGQpOmEuY29tcGFyZURvY3VtZW50UG9zaXRpb24mJjE2JmEuY29tcGFyZURvY3VtZW50UG9zaXRpb24oZCkpKX06ZnVuY3Rpb24oYSxiKXtpZihiKXdoaWxlKGI9Yi5wYXJlbnROb2RlKWlmKGI9PT1hKXJldHVybiEwO3JldHVybiExfSxCPWI/ZnVuY3Rpb24oYSxiKXtpZihhPT09YilyZXR1cm4gbD0hMCwwO3ZhciBkPSFhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uLSFiLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uO3JldHVybiBkP2Q6KGQ9KGEub3duZXJEb2N1bWVudHx8YSk9PT0oYi5vd25lckRvY3VtZW50fHxiKT9hLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGIpOjEsMSZkfHwhYy5zb3J0RGV0YWNoZWQmJmIuY29tcGFyZURvY3VtZW50UG9zaXRpb24oYSk9PT1kP2E9PT1nfHxhLm93bmVyRG9jdW1lbnQ9PT12JiZ0KHYsYSk/LTE6Yj09PWd8fGIub3duZXJEb2N1bWVudD09PXYmJnQodixiKT8xOms/SihrLGEpLUooayxiKTowOjQmZD8tMToxKX06ZnVuY3Rpb24oYSxiKXtpZihhPT09YilyZXR1cm4gbD0hMCwwO3ZhciBjLGQ9MCxlPWEucGFyZW50Tm9kZSxmPWIucGFyZW50Tm9kZSxoPVthXSxpPVtiXTtpZighZXx8IWYpcmV0dXJuIGE9PT1nPy0xOmI9PT1nPzE6ZT8tMTpmPzE6az9KKGssYSktSihrLGIpOjA7aWYoZT09PWYpcmV0dXJuIGxiKGEsYik7Yz1hO3doaWxlKGM9Yy5wYXJlbnROb2RlKWgudW5zaGlmdChjKTtjPWI7d2hpbGUoYz1jLnBhcmVudE5vZGUpaS51bnNoaWZ0KGMpO3doaWxlKGhbZF09PT1pW2RdKWQrKztyZXR1cm4gZD9sYihoW2RdLGlbZF0pOmhbZF09PT12Py0xOmlbZF09PT12PzE6MH0sZyk6bn0sZ2IubWF0Y2hlcz1mdW5jdGlvbihhLGIpe3JldHVybiBnYihhLG51bGwsbnVsbCxiKX0sZ2IubWF0Y2hlc1NlbGVjdG9yPWZ1bmN0aW9uKGEsYil7aWYoKGEub3duZXJEb2N1bWVudHx8YSkhPT1uJiZtKGEpLGI9Yi5yZXBsYWNlKFUsXCI9JyQxJ11cIiksISghYy5tYXRjaGVzU2VsZWN0b3J8fCFwfHxyJiZyLnRlc3QoYil8fHEmJnEudGVzdChiKSkpdHJ5e3ZhciBkPXMuY2FsbChhLGIpO2lmKGR8fGMuZGlzY29ubmVjdGVkTWF0Y2h8fGEuZG9jdW1lbnQmJjExIT09YS5kb2N1bWVudC5ub2RlVHlwZSlyZXR1cm4gZH1jYXRjaChlKXt9cmV0dXJuIGdiKGIsbixudWxsLFthXSkubGVuZ3RoPjB9LGdiLmNvbnRhaW5zPWZ1bmN0aW9uKGEsYil7cmV0dXJuKGEub3duZXJEb2N1bWVudHx8YSkhPT1uJiZtKGEpLHQoYSxiKX0sZ2IuYXR0cj1mdW5jdGlvbihhLGIpeyhhLm93bmVyRG9jdW1lbnR8fGEpIT09biYmbShhKTt2YXIgZT1kLmF0dHJIYW5kbGVbYi50b0xvd2VyQ2FzZSgpXSxmPWUmJkQuY2FsbChkLmF0dHJIYW5kbGUsYi50b0xvd2VyQ2FzZSgpKT9lKGEsYiwhcCk6dm9pZCAwO3JldHVybiB2b2lkIDAhPT1mP2Y6Yy5hdHRyaWJ1dGVzfHwhcD9hLmdldEF0dHJpYnV0ZShiKTooZj1hLmdldEF0dHJpYnV0ZU5vZGUoYikpJiZmLnNwZWNpZmllZD9mLnZhbHVlOm51bGx9LGdiLmVycm9yPWZ1bmN0aW9uKGEpe3Rocm93IG5ldyBFcnJvcihcIlN5bnRheCBlcnJvciwgdW5yZWNvZ25pemVkIGV4cHJlc3Npb246IFwiK2EpfSxnYi51bmlxdWVTb3J0PWZ1bmN0aW9uKGEpe3ZhciBiLGQ9W10sZT0wLGY9MDtpZihsPSFjLmRldGVjdER1cGxpY2F0ZXMsaz0hYy5zb3J0U3RhYmxlJiZhLnNsaWNlKDApLGEuc29ydChCKSxsKXt3aGlsZShiPWFbZisrXSliPT09YVtmXSYmKGU9ZC5wdXNoKGYpKTt3aGlsZShlLS0pYS5zcGxpY2UoZFtlXSwxKX1yZXR1cm4gaz1udWxsLGF9LGU9Z2IuZ2V0VGV4dD1mdW5jdGlvbihhKXt2YXIgYixjPVwiXCIsZD0wLGY9YS5ub2RlVHlwZTtpZihmKXtpZigxPT09Znx8OT09PWZ8fDExPT09Zil7aWYoXCJzdHJpbmdcIj09dHlwZW9mIGEudGV4dENvbnRlbnQpcmV0dXJuIGEudGV4dENvbnRlbnQ7Zm9yKGE9YS5maXJzdENoaWxkO2E7YT1hLm5leHRTaWJsaW5nKWMrPWUoYSl9ZWxzZSBpZigzPT09Znx8ND09PWYpcmV0dXJuIGEubm9kZVZhbHVlfWVsc2Ugd2hpbGUoYj1hW2QrK10pYys9ZShiKTtyZXR1cm4gY30sZD1nYi5zZWxlY3RvcnM9e2NhY2hlTGVuZ3RoOjUwLGNyZWF0ZVBzZXVkbzppYixtYXRjaDpYLGF0dHJIYW5kbGU6e30sZmluZDp7fSxyZWxhdGl2ZTp7XCI+XCI6e2RpcjpcInBhcmVudE5vZGVcIixmaXJzdDohMH0sXCIgXCI6e2RpcjpcInBhcmVudE5vZGVcIn0sXCIrXCI6e2RpcjpcInByZXZpb3VzU2libGluZ1wiLGZpcnN0OiEwfSxcIn5cIjp7ZGlyOlwicHJldmlvdXNTaWJsaW5nXCJ9fSxwcmVGaWx0ZXI6e0FUVFI6ZnVuY3Rpb24oYSl7cmV0dXJuIGFbMV09YVsxXS5yZXBsYWNlKGNiLGRiKSxhWzNdPShhWzNdfHxhWzRdfHxhWzVdfHxcIlwiKS5yZXBsYWNlKGNiLGRiKSxcIn49XCI9PT1hWzJdJiYoYVszXT1cIiBcIithWzNdK1wiIFwiKSxhLnNsaWNlKDAsNCl9LENISUxEOmZ1bmN0aW9uKGEpe3JldHVybiBhWzFdPWFbMV0udG9Mb3dlckNhc2UoKSxcIm50aFwiPT09YVsxXS5zbGljZSgwLDMpPyhhWzNdfHxnYi5lcnJvcihhWzBdKSxhWzRdPSsoYVs0XT9hWzVdKyhhWzZdfHwxKToyKihcImV2ZW5cIj09PWFbM118fFwib2RkXCI9PT1hWzNdKSksYVs1XT0rKGFbN10rYVs4XXx8XCJvZGRcIj09PWFbM10pKTphWzNdJiZnYi5lcnJvcihhWzBdKSxhfSxQU0VVRE86ZnVuY3Rpb24oYSl7dmFyIGIsYz0hYVs2XSYmYVsyXTtyZXR1cm4gWC5DSElMRC50ZXN0KGFbMF0pP251bGw6KGFbM10/YVsyXT1hWzRdfHxhWzVdfHxcIlwiOmMmJlYudGVzdChjKSYmKGI9ZyhjLCEwKSkmJihiPWMuaW5kZXhPZihcIilcIixjLmxlbmd0aC1iKS1jLmxlbmd0aCkmJihhWzBdPWFbMF0uc2xpY2UoMCxiKSxhWzJdPWMuc2xpY2UoMCxiKSksYS5zbGljZSgwLDMpKX19LGZpbHRlcjp7VEFHOmZ1bmN0aW9uKGEpe3ZhciBiPWEucmVwbGFjZShjYixkYikudG9Mb3dlckNhc2UoKTtyZXR1cm5cIipcIj09PWE/ZnVuY3Rpb24oKXtyZXR1cm4hMH06ZnVuY3Rpb24oYSl7cmV0dXJuIGEubm9kZU5hbWUmJmEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PWJ9fSxDTEFTUzpmdW5jdGlvbihhKXt2YXIgYj15W2ErXCIgXCJdO3JldHVybiBifHwoYj1uZXcgUmVnRXhwKFwiKF58XCIrTCtcIilcIithK1wiKFwiK0wrXCJ8JClcIikpJiZ5KGEsZnVuY3Rpb24oYSl7cmV0dXJuIGIudGVzdChcInN0cmluZ1wiPT10eXBlb2YgYS5jbGFzc05hbWUmJmEuY2xhc3NOYW1lfHxcInVuZGVmaW5lZFwiIT10eXBlb2YgYS5nZXRBdHRyaWJ1dGUmJmEuZ2V0QXR0cmlidXRlKFwiY2xhc3NcIil8fFwiXCIpfSl9LEFUVFI6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBmdW5jdGlvbihkKXt2YXIgZT1nYi5hdHRyKGQsYSk7cmV0dXJuIG51bGw9PWU/XCIhPVwiPT09YjpiPyhlKz1cIlwiLFwiPVwiPT09Yj9lPT09YzpcIiE9XCI9PT1iP2UhPT1jOlwiXj1cIj09PWI/YyYmMD09PWUuaW5kZXhPZihjKTpcIio9XCI9PT1iP2MmJmUuaW5kZXhPZihjKT4tMTpcIiQ9XCI9PT1iP2MmJmUuc2xpY2UoLWMubGVuZ3RoKT09PWM6XCJ+PVwiPT09Yj8oXCIgXCIrZS5yZXBsYWNlKFEsXCIgXCIpK1wiIFwiKS5pbmRleE9mKGMpPi0xOlwifD1cIj09PWI/ZT09PWN8fGUuc2xpY2UoMCxjLmxlbmd0aCsxKT09PWMrXCItXCI6ITEpOiEwfX0sQ0hJTEQ6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj1cIm50aFwiIT09YS5zbGljZSgwLDMpLGc9XCJsYXN0XCIhPT1hLnNsaWNlKC00KSxoPVwib2YtdHlwZVwiPT09YjtyZXR1cm4gMT09PWQmJjA9PT1lP2Z1bmN0aW9uKGEpe3JldHVybiEhYS5wYXJlbnROb2RlfTpmdW5jdGlvbihiLGMsaSl7dmFyIGosayxsLG0sbixvLHA9ZiE9PWc/XCJuZXh0U2libGluZ1wiOlwicHJldmlvdXNTaWJsaW5nXCIscT1iLnBhcmVudE5vZGUscj1oJiZiLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkscz0haSYmIWg7aWYocSl7aWYoZil7d2hpbGUocCl7bD1iO3doaWxlKGw9bFtwXSlpZihoP2wubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PXI6MT09PWwubm9kZVR5cGUpcmV0dXJuITE7bz1wPVwib25seVwiPT09YSYmIW8mJlwibmV4dFNpYmxpbmdcIn1yZXR1cm4hMH1pZihvPVtnP3EuZmlyc3RDaGlsZDpxLmxhc3RDaGlsZF0sZyYmcyl7az1xW3VdfHwocVt1XT17fSksaj1rW2FdfHxbXSxuPWpbMF09PT13JiZqWzFdLG09alswXT09PXcmJmpbMl0sbD1uJiZxLmNoaWxkTm9kZXNbbl07d2hpbGUobD0rK24mJmwmJmxbcF18fChtPW49MCl8fG8ucG9wKCkpaWYoMT09PWwubm9kZVR5cGUmJisrbSYmbD09PWIpe2tbYV09W3csbixtXTticmVha319ZWxzZSBpZihzJiYoaj0oYlt1XXx8KGJbdV09e30pKVthXSkmJmpbMF09PT13KW09alsxXTtlbHNlIHdoaWxlKGw9KytuJiZsJiZsW3BdfHwobT1uPTApfHxvLnBvcCgpKWlmKChoP2wubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PXI6MT09PWwubm9kZVR5cGUpJiYrK20mJihzJiYoKGxbdV18fChsW3VdPXt9KSlbYV09W3csbV0pLGw9PT1iKSlicmVhaztyZXR1cm4gbS09ZSxtPT09ZHx8bSVkPT09MCYmbS9kPj0wfX19LFBTRVVETzpmdW5jdGlvbihhLGIpe3ZhciBjLGU9ZC5wc2V1ZG9zW2FdfHxkLnNldEZpbHRlcnNbYS50b0xvd2VyQ2FzZSgpXXx8Z2IuZXJyb3IoXCJ1bnN1cHBvcnRlZCBwc2V1ZG86IFwiK2EpO3JldHVybiBlW3VdP2UoYik6ZS5sZW5ndGg+MT8oYz1bYSxhLFwiXCIsYl0sZC5zZXRGaWx0ZXJzLmhhc093blByb3BlcnR5KGEudG9Mb3dlckNhc2UoKSk/aWIoZnVuY3Rpb24oYSxjKXt2YXIgZCxmPWUoYSxiKSxnPWYubGVuZ3RoO3doaWxlKGctLSlkPUooYSxmW2ddKSxhW2RdPSEoY1tkXT1mW2ddKX0pOmZ1bmN0aW9uKGEpe3JldHVybiBlKGEsMCxjKX0pOmV9fSxwc2V1ZG9zOntub3Q6aWIoZnVuY3Rpb24oYSl7dmFyIGI9W10sYz1bXSxkPWgoYS5yZXBsYWNlKFIsXCIkMVwiKSk7cmV0dXJuIGRbdV0/aWIoZnVuY3Rpb24oYSxiLGMsZSl7dmFyIGYsZz1kKGEsbnVsbCxlLFtdKSxoPWEubGVuZ3RoO3doaWxlKGgtLSkoZj1nW2hdKSYmKGFbaF09IShiW2hdPWYpKX0pOmZ1bmN0aW9uKGEsZSxmKXtyZXR1cm4gYlswXT1hLGQoYixudWxsLGYsYyksYlswXT1udWxsLCFjLnBvcCgpfX0pLGhhczppYihmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIGdiKGEsYikubGVuZ3RoPjB9fSksY29udGFpbnM6aWIoZnVuY3Rpb24oYSl7cmV0dXJuIGE9YS5yZXBsYWNlKGNiLGRiKSxmdW5jdGlvbihiKXtyZXR1cm4oYi50ZXh0Q29udGVudHx8Yi5pbm5lclRleHR8fGUoYikpLmluZGV4T2YoYSk+LTF9fSksbGFuZzppYihmdW5jdGlvbihhKXtyZXR1cm4gVy50ZXN0KGF8fFwiXCIpfHxnYi5lcnJvcihcInVuc3VwcG9ydGVkIGxhbmc6IFwiK2EpLGE9YS5yZXBsYWNlKGNiLGRiKS50b0xvd2VyQ2FzZSgpLGZ1bmN0aW9uKGIpe3ZhciBjO2RvIGlmKGM9cD9iLmxhbmc6Yi5nZXRBdHRyaWJ1dGUoXCJ4bWw6bGFuZ1wiKXx8Yi5nZXRBdHRyaWJ1dGUoXCJsYW5nXCIpKXJldHVybiBjPWMudG9Mb3dlckNhc2UoKSxjPT09YXx8MD09PWMuaW5kZXhPZihhK1wiLVwiKTt3aGlsZSgoYj1iLnBhcmVudE5vZGUpJiYxPT09Yi5ub2RlVHlwZSk7cmV0dXJuITF9fSksdGFyZ2V0OmZ1bmN0aW9uKGIpe3ZhciBjPWEubG9jYXRpb24mJmEubG9jYXRpb24uaGFzaDtyZXR1cm4gYyYmYy5zbGljZSgxKT09PWIuaWR9LHJvb3Q6ZnVuY3Rpb24oYSl7cmV0dXJuIGE9PT1vfSxmb2N1czpmdW5jdGlvbihhKXtyZXR1cm4gYT09PW4uYWN0aXZlRWxlbWVudCYmKCFuLmhhc0ZvY3VzfHxuLmhhc0ZvY3VzKCkpJiYhIShhLnR5cGV8fGEuaHJlZnx8fmEudGFiSW5kZXgpfSxlbmFibGVkOmZ1bmN0aW9uKGEpe3JldHVybiBhLmRpc2FibGVkPT09ITF9LGRpc2FibGVkOmZ1bmN0aW9uKGEpe3JldHVybiBhLmRpc2FibGVkPT09ITB9LGNoZWNrZWQ6ZnVuY3Rpb24oYSl7dmFyIGI9YS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO3JldHVyblwiaW5wdXRcIj09PWImJiEhYS5jaGVja2VkfHxcIm9wdGlvblwiPT09YiYmISFhLnNlbGVjdGVkfSxzZWxlY3RlZDpmdW5jdGlvbihhKXtyZXR1cm4gYS5wYXJlbnROb2RlJiZhLnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleCxhLnNlbGVjdGVkPT09ITB9LGVtcHR5OmZ1bmN0aW9uKGEpe2ZvcihhPWEuZmlyc3RDaGlsZDthO2E9YS5uZXh0U2libGluZylpZihhLm5vZGVUeXBlPDYpcmV0dXJuITE7cmV0dXJuITB9LHBhcmVudDpmdW5jdGlvbihhKXtyZXR1cm4hZC5wc2V1ZG9zLmVtcHR5KGEpfSxoZWFkZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIFoudGVzdChhLm5vZGVOYW1lKX0saW5wdXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIFkudGVzdChhLm5vZGVOYW1lKX0sYnV0dG9uOmZ1bmN0aW9uKGEpe3ZhciBiPWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm5cImlucHV0XCI9PT1iJiZcImJ1dHRvblwiPT09YS50eXBlfHxcImJ1dHRvblwiPT09Yn0sdGV4dDpmdW5jdGlvbihhKXt2YXIgYjtyZXR1cm5cImlucHV0XCI9PT1hLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkmJlwidGV4dFwiPT09YS50eXBlJiYobnVsbD09KGI9YS5nZXRBdHRyaWJ1dGUoXCJ0eXBlXCIpKXx8XCJ0ZXh0XCI9PT1iLnRvTG93ZXJDYXNlKCkpfSxmaXJzdDpvYihmdW5jdGlvbigpe3JldHVyblswXX0pLGxhc3Q6b2IoZnVuY3Rpb24oYSxiKXtyZXR1cm5bYi0xXX0pLGVxOm9iKGZ1bmN0aW9uKGEsYixjKXtyZXR1cm5bMD5jP2MrYjpjXX0pLGV2ZW46b2IoZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9MDtiPmM7Yys9MilhLnB1c2goYyk7cmV0dXJuIGF9KSxvZGQ6b2IoZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9MTtiPmM7Yys9MilhLnB1c2goYyk7cmV0dXJuIGF9KSxsdDpvYihmdW5jdGlvbihhLGIsYyl7Zm9yKHZhciBkPTA+Yz9jK2I6YzstLWQ+PTA7KWEucHVzaChkKTtyZXR1cm4gYX0pLGd0Om9iKGZ1bmN0aW9uKGEsYixjKXtmb3IodmFyIGQ9MD5jP2MrYjpjOysrZDxiOylhLnB1c2goZCk7cmV0dXJuIGF9KX19LGQucHNldWRvcy5udGg9ZC5wc2V1ZG9zLmVxO2ZvcihiIGlue3JhZGlvOiEwLGNoZWNrYm94OiEwLGZpbGU6ITAscGFzc3dvcmQ6ITAsaW1hZ2U6ITB9KWQucHNldWRvc1tiXT1tYihiKTtmb3IoYiBpbntzdWJtaXQ6ITAscmVzZXQ6ITB9KWQucHNldWRvc1tiXT1uYihiKTtmdW5jdGlvbiBxYigpe31xYi5wcm90b3R5cGU9ZC5maWx0ZXJzPWQucHNldWRvcyxkLnNldEZpbHRlcnM9bmV3IHFiLGc9Z2IudG9rZW5pemU9ZnVuY3Rpb24oYSxiKXt2YXIgYyxlLGYsZyxoLGksaixrPXpbYStcIiBcIl07aWYoaylyZXR1cm4gYj8wOmsuc2xpY2UoMCk7aD1hLGk9W10saj1kLnByZUZpbHRlcjt3aGlsZShoKXsoIWN8fChlPVMuZXhlYyhoKSkpJiYoZSYmKGg9aC5zbGljZShlWzBdLmxlbmd0aCl8fGgpLGkucHVzaChmPVtdKSksYz0hMSwoZT1ULmV4ZWMoaCkpJiYoYz1lLnNoaWZ0KCksZi5wdXNoKHt2YWx1ZTpjLHR5cGU6ZVswXS5yZXBsYWNlKFIsXCIgXCIpfSksaD1oLnNsaWNlKGMubGVuZ3RoKSk7Zm9yKGcgaW4gZC5maWx0ZXIpIShlPVhbZ10uZXhlYyhoKSl8fGpbZ10mJiEoZT1qW2ddKGUpKXx8KGM9ZS5zaGlmdCgpLGYucHVzaCh7dmFsdWU6Yyx0eXBlOmcsbWF0Y2hlczplfSksaD1oLnNsaWNlKGMubGVuZ3RoKSk7aWYoIWMpYnJlYWt9cmV0dXJuIGI/aC5sZW5ndGg6aD9nYi5lcnJvcihhKTp6KGEsaSkuc2xpY2UoMCl9O2Z1bmN0aW9uIHJiKGEpe2Zvcih2YXIgYj0wLGM9YS5sZW5ndGgsZD1cIlwiO2M+YjtiKyspZCs9YVtiXS52YWx1ZTtyZXR1cm4gZH1mdW5jdGlvbiBzYihhLGIsYyl7dmFyIGQ9Yi5kaXIsZT1jJiZcInBhcmVudE5vZGVcIj09PWQsZj14Kys7cmV0dXJuIGIuZmlyc3Q/ZnVuY3Rpb24oYixjLGYpe3doaWxlKGI9YltkXSlpZigxPT09Yi5ub2RlVHlwZXx8ZSlyZXR1cm4gYShiLGMsZil9OmZ1bmN0aW9uKGIsYyxnKXt2YXIgaCxpLGo9W3csZl07aWYoZyl7d2hpbGUoYj1iW2RdKWlmKCgxPT09Yi5ub2RlVHlwZXx8ZSkmJmEoYixjLGcpKXJldHVybiEwfWVsc2Ugd2hpbGUoYj1iW2RdKWlmKDE9PT1iLm5vZGVUeXBlfHxlKXtpZihpPWJbdV18fChiW3VdPXt9KSwoaD1pW2RdKSYmaFswXT09PXcmJmhbMV09PT1mKXJldHVybiBqWzJdPWhbMl07aWYoaVtkXT1qLGpbMl09YShiLGMsZykpcmV0dXJuITB9fX1mdW5jdGlvbiB0YihhKXtyZXR1cm4gYS5sZW5ndGg+MT9mdW5jdGlvbihiLGMsZCl7dmFyIGU9YS5sZW5ndGg7d2hpbGUoZS0tKWlmKCFhW2VdKGIsYyxkKSlyZXR1cm4hMTtyZXR1cm4hMH06YVswXX1mdW5jdGlvbiB1YihhLGIsYyl7Zm9yKHZhciBkPTAsZT1iLmxlbmd0aDtlPmQ7ZCsrKWdiKGEsYltkXSxjKTtyZXR1cm4gY31mdW5jdGlvbiB2YihhLGIsYyxkLGUpe2Zvcih2YXIgZixnPVtdLGg9MCxpPWEubGVuZ3RoLGo9bnVsbCE9YjtpPmg7aCsrKShmPWFbaF0pJiYoIWN8fGMoZixkLGUpKSYmKGcucHVzaChmKSxqJiZiLnB1c2goaCkpO3JldHVybiBnfWZ1bmN0aW9uIHdiKGEsYixjLGQsZSxmKXtyZXR1cm4gZCYmIWRbdV0mJihkPXdiKGQpKSxlJiYhZVt1XSYmKGU9d2IoZSxmKSksaWIoZnVuY3Rpb24oZixnLGgsaSl7dmFyIGosayxsLG09W10sbj1bXSxvPWcubGVuZ3RoLHA9Znx8dWIoYnx8XCIqXCIsaC5ub2RlVHlwZT9baF06aCxbXSkscT0hYXx8IWYmJmI/cDp2YihwLG0sYSxoLGkpLHI9Yz9lfHwoZj9hOm98fGQpP1tdOmc6cTtpZihjJiZjKHEscixoLGkpLGQpe2o9dmIocixuKSxkKGosW10saCxpKSxrPWoubGVuZ3RoO3doaWxlKGstLSkobD1qW2tdKSYmKHJbbltrXV09IShxW25ba11dPWwpKX1pZihmKXtpZihlfHxhKXtpZihlKXtqPVtdLGs9ci5sZW5ndGg7d2hpbGUoay0tKShsPXJba10pJiZqLnB1c2gocVtrXT1sKTtlKG51bGwscj1bXSxqLGkpfWs9ci5sZW5ndGg7d2hpbGUoay0tKShsPXJba10pJiYoaj1lP0ooZixsKTptW2tdKT4tMSYmKGZbal09IShnW2pdPWwpKX19ZWxzZSByPXZiKHI9PT1nP3Iuc3BsaWNlKG8sci5sZW5ndGgpOnIpLGU/ZShudWxsLGcscixpKTpILmFwcGx5KGcscil9KX1mdW5jdGlvbiB4YihhKXtmb3IodmFyIGIsYyxlLGY9YS5sZW5ndGgsZz1kLnJlbGF0aXZlW2FbMF0udHlwZV0saD1nfHxkLnJlbGF0aXZlW1wiIFwiXSxpPWc/MTowLGs9c2IoZnVuY3Rpb24oYSl7cmV0dXJuIGE9PT1ifSxoLCEwKSxsPXNiKGZ1bmN0aW9uKGEpe3JldHVybiBKKGIsYSk+LTF9LGgsITApLG09W2Z1bmN0aW9uKGEsYyxkKXt2YXIgZT0hZyYmKGR8fGMhPT1qKXx8KChiPWMpLm5vZGVUeXBlP2soYSxjLGQpOmwoYSxjLGQpKTtyZXR1cm4gYj1udWxsLGV9XTtmPmk7aSsrKWlmKGM9ZC5yZWxhdGl2ZVthW2ldLnR5cGVdKW09W3NiKHRiKG0pLGMpXTtlbHNle2lmKGM9ZC5maWx0ZXJbYVtpXS50eXBlXS5hcHBseShudWxsLGFbaV0ubWF0Y2hlcyksY1t1XSl7Zm9yKGU9KytpO2Y+ZTtlKyspaWYoZC5yZWxhdGl2ZVthW2VdLnR5cGVdKWJyZWFrO3JldHVybiB3YihpPjEmJnRiKG0pLGk+MSYmcmIoYS5zbGljZSgwLGktMSkuY29uY2F0KHt2YWx1ZTpcIiBcIj09PWFbaS0yXS50eXBlP1wiKlwiOlwiXCJ9KSkucmVwbGFjZShSLFwiJDFcIiksYyxlPmkmJnhiKGEuc2xpY2UoaSxlKSksZj5lJiZ4YihhPWEuc2xpY2UoZSkpLGY+ZSYmcmIoYSkpfW0ucHVzaChjKX1yZXR1cm4gdGIobSl9ZnVuY3Rpb24geWIoYSxiKXt2YXIgYz1iLmxlbmd0aD4wLGU9YS5sZW5ndGg+MCxmPWZ1bmN0aW9uKGYsZyxoLGksayl7dmFyIGwsbSxvLHA9MCxxPVwiMFwiLHI9ZiYmW10scz1bXSx0PWosdT1mfHxlJiZkLmZpbmQuVEFHKFwiKlwiLGspLHY9dys9bnVsbD09dD8xOk1hdGgucmFuZG9tKCl8fC4xLHg9dS5sZW5ndGg7Zm9yKGsmJihqPWchPT1uJiZnKTtxIT09eCYmbnVsbCE9KGw9dVtxXSk7cSsrKXtpZihlJiZsKXttPTA7d2hpbGUobz1hW20rK10paWYobyhsLGcsaCkpe2kucHVzaChsKTticmVha31rJiYodz12KX1jJiYoKGw9IW8mJmwpJiZwLS0sZiYmci5wdXNoKGwpKX1pZihwKz1xLGMmJnEhPT1wKXttPTA7d2hpbGUobz1iW20rK10pbyhyLHMsZyxoKTtpZihmKXtpZihwPjApd2hpbGUocS0tKXJbcV18fHNbcV18fChzW3FdPUYuY2FsbChpKSk7cz12YihzKX1ILmFwcGx5KGkscyksayYmIWYmJnMubGVuZ3RoPjAmJnArYi5sZW5ndGg+MSYmZ2IudW5pcXVlU29ydChpKX1yZXR1cm4gayYmKHc9dixqPXQpLHJ9O3JldHVybiBjP2liKGYpOmZ9cmV0dXJuIGg9Z2IuY29tcGlsZT1mdW5jdGlvbihhLGIpe3ZhciBjLGQ9W10sZT1bXSxmPUFbYStcIiBcIl07aWYoIWYpe2J8fChiPWcoYSkpLGM9Yi5sZW5ndGg7d2hpbGUoYy0tKWY9eGIoYltjXSksZlt1XT9kLnB1c2goZik6ZS5wdXNoKGYpO2Y9QShhLHliKGUsZCkpLGYuc2VsZWN0b3I9YX1yZXR1cm4gZn0saT1nYi5zZWxlY3Q9ZnVuY3Rpb24oYSxiLGUsZil7dmFyIGksaixrLGwsbSxuPVwiZnVuY3Rpb25cIj09dHlwZW9mIGEmJmEsbz0hZiYmZyhhPW4uc2VsZWN0b3J8fGEpO2lmKGU9ZXx8W10sMT09PW8ubGVuZ3RoKXtpZihqPW9bMF09b1swXS5zbGljZSgwKSxqLmxlbmd0aD4yJiZcIklEXCI9PT0oaz1qWzBdKS50eXBlJiZjLmdldEJ5SWQmJjk9PT1iLm5vZGVUeXBlJiZwJiZkLnJlbGF0aXZlW2pbMV0udHlwZV0pe2lmKGI9KGQuZmluZC5JRChrLm1hdGNoZXNbMF0ucmVwbGFjZShjYixkYiksYil8fFtdKVswXSwhYilyZXR1cm4gZTtuJiYoYj1iLnBhcmVudE5vZGUpLGE9YS5zbGljZShqLnNoaWZ0KCkudmFsdWUubGVuZ3RoKX1pPVgubmVlZHNDb250ZXh0LnRlc3QoYSk/MDpqLmxlbmd0aDt3aGlsZShpLS0pe2lmKGs9altpXSxkLnJlbGF0aXZlW2w9ay50eXBlXSlicmVhaztpZigobT1kLmZpbmRbbF0pJiYoZj1tKGsubWF0Y2hlc1swXS5yZXBsYWNlKGNiLGRiKSxhYi50ZXN0KGpbMF0udHlwZSkmJnBiKGIucGFyZW50Tm9kZSl8fGIpKSl7aWYoai5zcGxpY2UoaSwxKSxhPWYubGVuZ3RoJiZyYihqKSwhYSlyZXR1cm4gSC5hcHBseShlLGYpLGU7YnJlYWt9fX1yZXR1cm4obnx8aChhLG8pKShmLGIsIXAsZSxhYi50ZXN0KGEpJiZwYihiLnBhcmVudE5vZGUpfHxiKSxlfSxjLnNvcnRTdGFibGU9dS5zcGxpdChcIlwiKS5zb3J0KEIpLmpvaW4oXCJcIik9PT11LGMuZGV0ZWN0RHVwbGljYXRlcz0hIWwsbSgpLGMuc29ydERldGFjaGVkPWpiKGZ1bmN0aW9uKGEpe3JldHVybiAxJmEuY29tcGFyZURvY3VtZW50UG9zaXRpb24obi5jcmVhdGVFbGVtZW50KFwiZGl2XCIpKX0pLGpiKGZ1bmN0aW9uKGEpe3JldHVybiBhLmlubmVySFRNTD1cIjxhIGhyZWY9JyMnPjwvYT5cIixcIiNcIj09PWEuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpfSl8fGtiKFwidHlwZXxocmVmfGhlaWdodHx3aWR0aFwiLGZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gYz92b2lkIDA6YS5nZXRBdHRyaWJ1dGUoYixcInR5cGVcIj09PWIudG9Mb3dlckNhc2UoKT8xOjIpfSksYy5hdHRyaWJ1dGVzJiZqYihmdW5jdGlvbihhKXtyZXR1cm4gYS5pbm5lckhUTUw9XCI8aW5wdXQvPlwiLGEuZmlyc3RDaGlsZC5zZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiLFwiXCIpLFwiXCI9PT1hLmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKFwidmFsdWVcIil9KXx8a2IoXCJ2YWx1ZVwiLGZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gY3x8XCJpbnB1dFwiIT09YS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpP3ZvaWQgMDphLmRlZmF1bHRWYWx1ZX0pLGpiKGZ1bmN0aW9uKGEpe3JldHVybiBudWxsPT1hLmdldEF0dHJpYnV0ZShcImRpc2FibGVkXCIpfSl8fGtiKEssZnVuY3Rpb24oYSxiLGMpe3ZhciBkO3JldHVybiBjP3ZvaWQgMDphW2JdPT09ITA/Yi50b0xvd2VyQ2FzZSgpOihkPWEuZ2V0QXR0cmlidXRlTm9kZShiKSkmJmQuc3BlY2lmaWVkP2QudmFsdWU6bnVsbH0pLGdifShhKTtuLmZpbmQ9dCxuLmV4cHI9dC5zZWxlY3RvcnMsbi5leHByW1wiOlwiXT1uLmV4cHIucHNldWRvcyxuLnVuaXF1ZT10LnVuaXF1ZVNvcnQsbi50ZXh0PXQuZ2V0VGV4dCxuLmlzWE1MRG9jPXQuaXNYTUwsbi5jb250YWlucz10LmNvbnRhaW5zO3ZhciB1PW4uZXhwci5tYXRjaC5uZWVkc0NvbnRleHQsdj0vXjwoXFx3KylcXHMqXFwvPz4oPzo8XFwvXFwxPnwpJC8sdz0vXi5bXjojXFxbXFwuLF0qJC87ZnVuY3Rpb24geChhLGIsYyl7aWYobi5pc0Z1bmN0aW9uKGIpKXJldHVybiBuLmdyZXAoYSxmdW5jdGlvbihhLGQpe3JldHVybiEhYi5jYWxsKGEsZCxhKSE9PWN9KTtpZihiLm5vZGVUeXBlKXJldHVybiBuLmdyZXAoYSxmdW5jdGlvbihhKXtyZXR1cm4gYT09PWIhPT1jfSk7aWYoXCJzdHJpbmdcIj09dHlwZW9mIGIpe2lmKHcudGVzdChiKSlyZXR1cm4gbi5maWx0ZXIoYixhLGMpO2I9bi5maWx0ZXIoYixhKX1yZXR1cm4gbi5ncmVwKGEsZnVuY3Rpb24oYSl7cmV0dXJuIGcuY2FsbChiLGEpPj0wIT09Y30pfW4uZmlsdGVyPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1iWzBdO3JldHVybiBjJiYoYT1cIjpub3QoXCIrYStcIilcIiksMT09PWIubGVuZ3RoJiYxPT09ZC5ub2RlVHlwZT9uLmZpbmQubWF0Y2hlc1NlbGVjdG9yKGQsYSk/W2RdOltdOm4uZmluZC5tYXRjaGVzKGEsbi5ncmVwKGIsZnVuY3Rpb24oYSl7cmV0dXJuIDE9PT1hLm5vZGVUeXBlfSkpfSxuLmZuLmV4dGVuZCh7ZmluZDpmdW5jdGlvbihhKXt2YXIgYixjPXRoaXMubGVuZ3RoLGQ9W10sZT10aGlzO2lmKFwic3RyaW5nXCIhPXR5cGVvZiBhKXJldHVybiB0aGlzLnB1c2hTdGFjayhuKGEpLmZpbHRlcihmdW5jdGlvbigpe2ZvcihiPTA7Yz5iO2IrKylpZihuLmNvbnRhaW5zKGVbYl0sdGhpcykpcmV0dXJuITB9KSk7Zm9yKGI9MDtjPmI7YisrKW4uZmluZChhLGVbYl0sZCk7cmV0dXJuIGQ9dGhpcy5wdXNoU3RhY2soYz4xP24udW5pcXVlKGQpOmQpLGQuc2VsZWN0b3I9dGhpcy5zZWxlY3Rvcj90aGlzLnNlbGVjdG9yK1wiIFwiK2E6YSxkfSxmaWx0ZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKHgodGhpcyxhfHxbXSwhMSkpfSxub3Q6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKHgodGhpcyxhfHxbXSwhMCkpfSxpczpmdW5jdGlvbihhKXtyZXR1cm4hIXgodGhpcyxcInN0cmluZ1wiPT10eXBlb2YgYSYmdS50ZXN0KGEpP24oYSk6YXx8W10sITEpLmxlbmd0aH19KTt2YXIgeSx6PS9eKD86XFxzKig8W1xcd1xcV10rPilbXj5dKnwjKFtcXHctXSopKSQvLEE9bi5mbi5pbml0PWZ1bmN0aW9uKGEsYil7dmFyIGMsZDtpZighYSlyZXR1cm4gdGhpcztpZihcInN0cmluZ1wiPT10eXBlb2YgYSl7aWYoYz1cIjxcIj09PWFbMF0mJlwiPlwiPT09YVthLmxlbmd0aC0xXSYmYS5sZW5ndGg+PTM/W251bGwsYSxudWxsXTp6LmV4ZWMoYSksIWN8fCFjWzFdJiZiKXJldHVybiFifHxiLmpxdWVyeT8oYnx8eSkuZmluZChhKTp0aGlzLmNvbnN0cnVjdG9yKGIpLmZpbmQoYSk7aWYoY1sxXSl7aWYoYj1iIGluc3RhbmNlb2Ygbj9iWzBdOmIsbi5tZXJnZSh0aGlzLG4ucGFyc2VIVE1MKGNbMV0sYiYmYi5ub2RlVHlwZT9iLm93bmVyRG9jdW1lbnR8fGI6bCwhMCkpLHYudGVzdChjWzFdKSYmbi5pc1BsYWluT2JqZWN0KGIpKWZvcihjIGluIGIpbi5pc0Z1bmN0aW9uKHRoaXNbY10pP3RoaXNbY10oYltjXSk6dGhpcy5hdHRyKGMsYltjXSk7cmV0dXJuIHRoaXN9cmV0dXJuIGQ9bC5nZXRFbGVtZW50QnlJZChjWzJdKSxkJiZkLnBhcmVudE5vZGUmJih0aGlzLmxlbmd0aD0xLHRoaXNbMF09ZCksdGhpcy5jb250ZXh0PWwsdGhpcy5zZWxlY3Rvcj1hLHRoaXN9cmV0dXJuIGEubm9kZVR5cGU/KHRoaXMuY29udGV4dD10aGlzWzBdPWEsdGhpcy5sZW5ndGg9MSx0aGlzKTpuLmlzRnVuY3Rpb24oYSk/XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHkucmVhZHk/eS5yZWFkeShhKTphKG4pOih2b2lkIDAhPT1hLnNlbGVjdG9yJiYodGhpcy5zZWxlY3Rvcj1hLnNlbGVjdG9yLHRoaXMuY29udGV4dD1hLmNvbnRleHQpLG4ubWFrZUFycmF5KGEsdGhpcykpfTtBLnByb3RvdHlwZT1uLmZuLHk9bihsKTt2YXIgQj0vXig/OnBhcmVudHN8cHJldig/OlVudGlsfEFsbCkpLyxDPXtjaGlsZHJlbjohMCxjb250ZW50czohMCxuZXh0OiEwLHByZXY6ITB9O24uZXh0ZW5kKHtkaXI6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPVtdLGU9dm9pZCAwIT09Yzt3aGlsZSgoYT1hW2JdKSYmOSE9PWEubm9kZVR5cGUpaWYoMT09PWEubm9kZVR5cGUpe2lmKGUmJm4oYSkuaXMoYykpYnJlYWs7ZC5wdXNoKGEpfXJldHVybiBkfSxzaWJsaW5nOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPVtdO2E7YT1hLm5leHRTaWJsaW5nKTE9PT1hLm5vZGVUeXBlJiZhIT09YiYmYy5wdXNoKGEpO3JldHVybiBjfX0pLG4uZm4uZXh0ZW5kKHtoYXM6ZnVuY3Rpb24oYSl7dmFyIGI9bihhLHRoaXMpLGM9Yi5sZW5ndGg7cmV0dXJuIHRoaXMuZmlsdGVyKGZ1bmN0aW9uKCl7Zm9yKHZhciBhPTA7Yz5hO2ErKylpZihuLmNvbnRhaW5zKHRoaXMsYlthXSkpcmV0dXJuITB9KX0sY2xvc2VzdDpmdW5jdGlvbihhLGIpe2Zvcih2YXIgYyxkPTAsZT10aGlzLmxlbmd0aCxmPVtdLGc9dS50ZXN0KGEpfHxcInN0cmluZ1wiIT10eXBlb2YgYT9uKGEsYnx8dGhpcy5jb250ZXh0KTowO2U+ZDtkKyspZm9yKGM9dGhpc1tkXTtjJiZjIT09YjtjPWMucGFyZW50Tm9kZSlpZihjLm5vZGVUeXBlPDExJiYoZz9nLmluZGV4KGMpPi0xOjE9PT1jLm5vZGVUeXBlJiZuLmZpbmQubWF0Y2hlc1NlbGVjdG9yKGMsYSkpKXtmLnB1c2goYyk7YnJlYWt9cmV0dXJuIHRoaXMucHVzaFN0YWNrKGYubGVuZ3RoPjE/bi51bmlxdWUoZik6Zil9LGluZGV4OmZ1bmN0aW9uKGEpe3JldHVybiBhP1wic3RyaW5nXCI9PXR5cGVvZiBhP2cuY2FsbChuKGEpLHRoaXNbMF0pOmcuY2FsbCh0aGlzLGEuanF1ZXJ5P2FbMF06YSk6dGhpc1swXSYmdGhpc1swXS5wYXJlbnROb2RlP3RoaXMuZmlyc3QoKS5wcmV2QWxsKCkubGVuZ3RoOi0xfSxhZGQ6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2sobi51bmlxdWUobi5tZXJnZSh0aGlzLmdldCgpLG4oYSxiKSkpKX0sYWRkQmFjazpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5hZGQobnVsbD09YT90aGlzLnByZXZPYmplY3Q6dGhpcy5wcmV2T2JqZWN0LmZpbHRlcihhKSl9fSk7ZnVuY3Rpb24gRChhLGIpe3doaWxlKChhPWFbYl0pJiYxIT09YS5ub2RlVHlwZSk7cmV0dXJuIGF9bi5lYWNoKHtwYXJlbnQ6ZnVuY3Rpb24oYSl7dmFyIGI9YS5wYXJlbnROb2RlO3JldHVybiBiJiYxMSE9PWIubm9kZVR5cGU/YjpudWxsfSxwYXJlbnRzOmZ1bmN0aW9uKGEpe3JldHVybiBuLmRpcihhLFwicGFyZW50Tm9kZVwiKX0scGFyZW50c1VudGlsOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbi5kaXIoYSxcInBhcmVudE5vZGVcIixjKX0sbmV4dDpmdW5jdGlvbihhKXtyZXR1cm4gRChhLFwibmV4dFNpYmxpbmdcIil9LHByZXY6ZnVuY3Rpb24oYSl7cmV0dXJuIEQoYSxcInByZXZpb3VzU2libGluZ1wiKX0sbmV4dEFsbDpmdW5jdGlvbihhKXtyZXR1cm4gbi5kaXIoYSxcIm5leHRTaWJsaW5nXCIpfSxwcmV2QWxsOmZ1bmN0aW9uKGEpe3JldHVybiBuLmRpcihhLFwicHJldmlvdXNTaWJsaW5nXCIpfSxuZXh0VW50aWw6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuLmRpcihhLFwibmV4dFNpYmxpbmdcIixjKX0scHJldlVudGlsOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbi5kaXIoYSxcInByZXZpb3VzU2libGluZ1wiLGMpfSxzaWJsaW5nczpmdW5jdGlvbihhKXtyZXR1cm4gbi5zaWJsaW5nKChhLnBhcmVudE5vZGV8fHt9KS5maXJzdENoaWxkLGEpfSxjaGlsZHJlbjpmdW5jdGlvbihhKXtyZXR1cm4gbi5zaWJsaW5nKGEuZmlyc3RDaGlsZCl9LGNvbnRlbnRzOmZ1bmN0aW9uKGEpe3JldHVybiBhLmNvbnRlbnREb2N1bWVudHx8bi5tZXJnZShbXSxhLmNoaWxkTm9kZXMpfX0sZnVuY3Rpb24oYSxiKXtuLmZuW2FdPWZ1bmN0aW9uKGMsZCl7dmFyIGU9bi5tYXAodGhpcyxiLGMpO3JldHVyblwiVW50aWxcIiE9PWEuc2xpY2UoLTUpJiYoZD1jKSxkJiZcInN0cmluZ1wiPT10eXBlb2YgZCYmKGU9bi5maWx0ZXIoZCxlKSksdGhpcy5sZW5ndGg+MSYmKENbYV18fG4udW5pcXVlKGUpLEIudGVzdChhKSYmZS5yZXZlcnNlKCkpLHRoaXMucHVzaFN0YWNrKGUpfX0pO3ZhciBFPS9cXFMrL2csRj17fTtmdW5jdGlvbiBHKGEpe3ZhciBiPUZbYV09e307cmV0dXJuIG4uZWFjaChhLm1hdGNoKEUpfHxbXSxmdW5jdGlvbihhLGMpe2JbY109ITB9KSxifW4uQ2FsbGJhY2tzPWZ1bmN0aW9uKGEpe2E9XCJzdHJpbmdcIj09dHlwZW9mIGE/RlthXXx8RyhhKTpuLmV4dGVuZCh7fSxhKTt2YXIgYixjLGQsZSxmLGcsaD1bXSxpPSFhLm9uY2UmJltdLGo9ZnVuY3Rpb24obCl7Zm9yKGI9YS5tZW1vcnkmJmwsYz0hMCxnPWV8fDAsZT0wLGY9aC5sZW5ndGgsZD0hMDtoJiZmPmc7ZysrKWlmKGhbZ10uYXBwbHkobFswXSxsWzFdKT09PSExJiZhLnN0b3BPbkZhbHNlKXtiPSExO2JyZWFrfWQ9ITEsaCYmKGk/aS5sZW5ndGgmJmooaS5zaGlmdCgpKTpiP2g9W106ay5kaXNhYmxlKCkpfSxrPXthZGQ6ZnVuY3Rpb24oKXtpZihoKXt2YXIgYz1oLmxlbmd0aDshZnVuY3Rpb24gZyhiKXtuLmVhY2goYixmdW5jdGlvbihiLGMpe3ZhciBkPW4udHlwZShjKTtcImZ1bmN0aW9uXCI9PT1kP2EudW5pcXVlJiZrLmhhcyhjKXx8aC5wdXNoKGMpOmMmJmMubGVuZ3RoJiZcInN0cmluZ1wiIT09ZCYmZyhjKX0pfShhcmd1bWVudHMpLGQ/Zj1oLmxlbmd0aDpiJiYoZT1jLGooYikpfXJldHVybiB0aGlzfSxyZW1vdmU6ZnVuY3Rpb24oKXtyZXR1cm4gaCYmbi5lYWNoKGFyZ3VtZW50cyxmdW5jdGlvbihhLGIpe3ZhciBjO3doaWxlKChjPW4uaW5BcnJheShiLGgsYykpPi0xKWguc3BsaWNlKGMsMSksZCYmKGY+PWMmJmYtLSxnPj1jJiZnLS0pfSksdGhpc30saGFzOmZ1bmN0aW9uKGEpe3JldHVybiBhP24uaW5BcnJheShhLGgpPi0xOiEoIWh8fCFoLmxlbmd0aCl9LGVtcHR5OmZ1bmN0aW9uKCl7cmV0dXJuIGg9W10sZj0wLHRoaXN9LGRpc2FibGU6ZnVuY3Rpb24oKXtyZXR1cm4gaD1pPWI9dm9pZCAwLHRoaXN9LGRpc2FibGVkOmZ1bmN0aW9uKCl7cmV0dXJuIWh9LGxvY2s6ZnVuY3Rpb24oKXtyZXR1cm4gaT12b2lkIDAsYnx8ay5kaXNhYmxlKCksdGhpc30sbG9ja2VkOmZ1bmN0aW9uKCl7cmV0dXJuIWl9LGZpcmVXaXRoOmZ1bmN0aW9uKGEsYil7cmV0dXJuIWh8fGMmJiFpfHwoYj1ifHxbXSxiPVthLGIuc2xpY2U/Yi5zbGljZSgpOmJdLGQ/aS5wdXNoKGIpOmooYikpLHRoaXN9LGZpcmU6ZnVuY3Rpb24oKXtyZXR1cm4gay5maXJlV2l0aCh0aGlzLGFyZ3VtZW50cyksdGhpc30sZmlyZWQ6ZnVuY3Rpb24oKXtyZXR1cm4hIWN9fTtyZXR1cm4ga30sbi5leHRlbmQoe0RlZmVycmVkOmZ1bmN0aW9uKGEpe3ZhciBiPVtbXCJyZXNvbHZlXCIsXCJkb25lXCIsbi5DYWxsYmFja3MoXCJvbmNlIG1lbW9yeVwiKSxcInJlc29sdmVkXCJdLFtcInJlamVjdFwiLFwiZmFpbFwiLG4uQ2FsbGJhY2tzKFwib25jZSBtZW1vcnlcIiksXCJyZWplY3RlZFwiXSxbXCJub3RpZnlcIixcInByb2dyZXNzXCIsbi5DYWxsYmFja3MoXCJtZW1vcnlcIildXSxjPVwicGVuZGluZ1wiLGQ9e3N0YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIGN9LGFsd2F5czpmdW5jdGlvbigpe3JldHVybiBlLmRvbmUoYXJndW1lbnRzKS5mYWlsKGFyZ3VtZW50cyksdGhpc30sdGhlbjpmdW5jdGlvbigpe3ZhciBhPWFyZ3VtZW50cztyZXR1cm4gbi5EZWZlcnJlZChmdW5jdGlvbihjKXtuLmVhY2goYixmdW5jdGlvbihiLGYpe3ZhciBnPW4uaXNGdW5jdGlvbihhW2JdKSYmYVtiXTtlW2ZbMV1dKGZ1bmN0aW9uKCl7dmFyIGE9ZyYmZy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7YSYmbi5pc0Z1bmN0aW9uKGEucHJvbWlzZSk/YS5wcm9taXNlKCkuZG9uZShjLnJlc29sdmUpLmZhaWwoYy5yZWplY3QpLnByb2dyZXNzKGMubm90aWZ5KTpjW2ZbMF0rXCJXaXRoXCJdKHRoaXM9PT1kP2MucHJvbWlzZSgpOnRoaXMsZz9bYV06YXJndW1lbnRzKX0pfSksYT1udWxsfSkucHJvbWlzZSgpfSxwcm9taXNlOmZ1bmN0aW9uKGEpe3JldHVybiBudWxsIT1hP24uZXh0ZW5kKGEsZCk6ZH19LGU9e307cmV0dXJuIGQucGlwZT1kLnRoZW4sbi5lYWNoKGIsZnVuY3Rpb24oYSxmKXt2YXIgZz1mWzJdLGg9ZlszXTtkW2ZbMV1dPWcuYWRkLGgmJmcuYWRkKGZ1bmN0aW9uKCl7Yz1ofSxiWzFeYV1bMl0uZGlzYWJsZSxiWzJdWzJdLmxvY2spLGVbZlswXV09ZnVuY3Rpb24oKXtyZXR1cm4gZVtmWzBdK1wiV2l0aFwiXSh0aGlzPT09ZT9kOnRoaXMsYXJndW1lbnRzKSx0aGlzfSxlW2ZbMF0rXCJXaXRoXCJdPWcuZmlyZVdpdGh9KSxkLnByb21pc2UoZSksYSYmYS5jYWxsKGUsZSksZX0sd2hlbjpmdW5jdGlvbihhKXt2YXIgYj0wLGM9ZC5jYWxsKGFyZ3VtZW50cyksZT1jLmxlbmd0aCxmPTEhPT1lfHxhJiZuLmlzRnVuY3Rpb24oYS5wcm9taXNlKT9lOjAsZz0xPT09Zj9hOm4uRGVmZXJyZWQoKSxoPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gZnVuY3Rpb24oZSl7YlthXT10aGlzLGNbYV09YXJndW1lbnRzLmxlbmd0aD4xP2QuY2FsbChhcmd1bWVudHMpOmUsYz09PWk/Zy5ub3RpZnlXaXRoKGIsYyk6LS1mfHxnLnJlc29sdmVXaXRoKGIsYyl9fSxpLGosaztpZihlPjEpZm9yKGk9bmV3IEFycmF5KGUpLGo9bmV3IEFycmF5KGUpLGs9bmV3IEFycmF5KGUpO2U+YjtiKyspY1tiXSYmbi5pc0Z1bmN0aW9uKGNbYl0ucHJvbWlzZSk/Y1tiXS5wcm9taXNlKCkuZG9uZShoKGIsayxjKSkuZmFpbChnLnJlamVjdCkucHJvZ3Jlc3MoaChiLGosaSkpOi0tZjtyZXR1cm4gZnx8Zy5yZXNvbHZlV2l0aChrLGMpLGcucHJvbWlzZSgpfX0pO3ZhciBIO24uZm4ucmVhZHk9ZnVuY3Rpb24oYSl7cmV0dXJuIG4ucmVhZHkucHJvbWlzZSgpLmRvbmUoYSksdGhpc30sbi5leHRlbmQoe2lzUmVhZHk6ITEscmVhZHlXYWl0OjEsaG9sZFJlYWR5OmZ1bmN0aW9uKGEpe2E/bi5yZWFkeVdhaXQrKzpuLnJlYWR5KCEwKX0scmVhZHk6ZnVuY3Rpb24oYSl7KGE9PT0hMD8tLW4ucmVhZHlXYWl0Om4uaXNSZWFkeSl8fChuLmlzUmVhZHk9ITAsYSE9PSEwJiYtLW4ucmVhZHlXYWl0PjB8fChILnJlc29sdmVXaXRoKGwsW25dKSxuLmZuLnRyaWdnZXJIYW5kbGVyJiYobihsKS50cmlnZ2VySGFuZGxlcihcInJlYWR5XCIpLG4obCkub2ZmKFwicmVhZHlcIikpKSl9fSk7ZnVuY3Rpb24gSSgpe2wucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIixJLCExKSxhLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsSSwhMSksbi5yZWFkeSgpfW4ucmVhZHkucHJvbWlzZT1mdW5jdGlvbihiKXtyZXR1cm4gSHx8KEg9bi5EZWZlcnJlZCgpLFwiY29tcGxldGVcIj09PWwucmVhZHlTdGF0ZT9zZXRUaW1lb3V0KG4ucmVhZHkpOihsLmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsSSwhMSksYS5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLEksITEpKSksSC5wcm9taXNlKGIpfSxuLnJlYWR5LnByb21pc2UoKTt2YXIgSj1uLmFjY2Vzcz1mdW5jdGlvbihhLGIsYyxkLGUsZixnKXt2YXIgaD0wLGk9YS5sZW5ndGgsaj1udWxsPT1jO2lmKFwib2JqZWN0XCI9PT1uLnR5cGUoYykpe2U9ITA7Zm9yKGggaW4gYyluLmFjY2VzcyhhLGIsaCxjW2hdLCEwLGYsZyl9ZWxzZSBpZih2b2lkIDAhPT1kJiYoZT0hMCxuLmlzRnVuY3Rpb24oZCl8fChnPSEwKSxqJiYoZz8oYi5jYWxsKGEsZCksYj1udWxsKTooaj1iLGI9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBqLmNhbGwobihhKSxjKX0pKSxiKSlmb3IoO2k+aDtoKyspYihhW2hdLGMsZz9kOmQuY2FsbChhW2hdLGgsYihhW2hdLGMpKSk7cmV0dXJuIGU/YTpqP2IuY2FsbChhKTppP2IoYVswXSxjKTpmfTtuLmFjY2VwdERhdGE9ZnVuY3Rpb24oYSl7cmV0dXJuIDE9PT1hLm5vZGVUeXBlfHw5PT09YS5ub2RlVHlwZXx8ISthLm5vZGVUeXBlfTtmdW5jdGlvbiBLKCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMuY2FjaGU9e30sMCx7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJue319fSksdGhpcy5leHBhbmRvPW4uZXhwYW5kbytLLnVpZCsrfUsudWlkPTEsSy5hY2NlcHRzPW4uYWNjZXB0RGF0YSxLLnByb3RvdHlwZT17a2V5OmZ1bmN0aW9uKGEpe2lmKCFLLmFjY2VwdHMoYSkpcmV0dXJuIDA7dmFyIGI9e30sYz1hW3RoaXMuZXhwYW5kb107aWYoIWMpe2M9Sy51aWQrKzt0cnl7Ylt0aGlzLmV4cGFuZG9dPXt2YWx1ZTpjfSxPYmplY3QuZGVmaW5lUHJvcGVydGllcyhhLGIpfWNhdGNoKGQpe2JbdGhpcy5leHBhbmRvXT1jLG4uZXh0ZW5kKGEsYil9fXJldHVybiB0aGlzLmNhY2hlW2NdfHwodGhpcy5jYWNoZVtjXT17fSksY30sc2V0OmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlPXRoaXMua2V5KGEpLGY9dGhpcy5jYWNoZVtlXTtpZihcInN0cmluZ1wiPT10eXBlb2YgYilmW2JdPWM7ZWxzZSBpZihuLmlzRW1wdHlPYmplY3QoZikpbi5leHRlbmQodGhpcy5jYWNoZVtlXSxiKTtlbHNlIGZvcihkIGluIGIpZltkXT1iW2RdO3JldHVybiBmfSxnZXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNhY2hlW3RoaXMua2V5KGEpXTtyZXR1cm4gdm9pZCAwPT09Yj9jOmNbYl19LGFjY2VzczpmdW5jdGlvbihhLGIsYyl7dmFyIGQ7cmV0dXJuIHZvaWQgMD09PWJ8fGImJlwic3RyaW5nXCI9PXR5cGVvZiBiJiZ2b2lkIDA9PT1jPyhkPXRoaXMuZ2V0KGEsYiksdm9pZCAwIT09ZD9kOnRoaXMuZ2V0KGEsbi5jYW1lbENhc2UoYikpKToodGhpcy5zZXQoYSxiLGMpLHZvaWQgMCE9PWM/YzpiKX0scmVtb3ZlOmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlLGY9dGhpcy5rZXkoYSksZz10aGlzLmNhY2hlW2ZdO2lmKHZvaWQgMD09PWIpdGhpcy5jYWNoZVtmXT17fTtlbHNle24uaXNBcnJheShiKT9kPWIuY29uY2F0KGIubWFwKG4uY2FtZWxDYXNlKSk6KGU9bi5jYW1lbENhc2UoYiksYiBpbiBnP2Q9W2IsZV06KGQ9ZSxkPWQgaW4gZz9bZF06ZC5tYXRjaChFKXx8W10pKSxjPWQubGVuZ3RoO3doaWxlKGMtLSlkZWxldGUgZ1tkW2NdXX19LGhhc0RhdGE6ZnVuY3Rpb24oYSl7cmV0dXJuIW4uaXNFbXB0eU9iamVjdCh0aGlzLmNhY2hlW2FbdGhpcy5leHBhbmRvXV18fHt9KX0sZGlzY2FyZDpmdW5jdGlvbihhKXthW3RoaXMuZXhwYW5kb10mJmRlbGV0ZSB0aGlzLmNhY2hlW2FbdGhpcy5leHBhbmRvXV19fTt2YXIgTD1uZXcgSyxNPW5ldyBLLE49L14oPzpcXHtbXFx3XFxXXSpcXH18XFxbW1xcd1xcV10qXFxdKSQvLE89LyhbQS1aXSkvZztmdW5jdGlvbiBQKGEsYixjKXt2YXIgZDtpZih2b2lkIDA9PT1jJiYxPT09YS5ub2RlVHlwZSlpZihkPVwiZGF0YS1cIitiLnJlcGxhY2UoTyxcIi0kMVwiKS50b0xvd2VyQ2FzZSgpLGM9YS5nZXRBdHRyaWJ1dGUoZCksXCJzdHJpbmdcIj09dHlwZW9mIGMpe3RyeXtjPVwidHJ1ZVwiPT09Yz8hMDpcImZhbHNlXCI9PT1jPyExOlwibnVsbFwiPT09Yz9udWxsOitjK1wiXCI9PT1jPytjOk4udGVzdChjKT9uLnBhcnNlSlNPTihjKTpjfWNhdGNoKGUpe31NLnNldChhLGIsYyl9ZWxzZSBjPXZvaWQgMDtyZXR1cm4gY31uLmV4dGVuZCh7aGFzRGF0YTpmdW5jdGlvbihhKXtyZXR1cm4gTS5oYXNEYXRhKGEpfHxMLmhhc0RhdGEoYSl9LGRhdGE6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBNLmFjY2VzcyhhLGIsYylcbn0scmVtb3ZlRGF0YTpmdW5jdGlvbihhLGIpe00ucmVtb3ZlKGEsYil9LF9kYXRhOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gTC5hY2Nlc3MoYSxiLGMpfSxfcmVtb3ZlRGF0YTpmdW5jdGlvbihhLGIpe0wucmVtb3ZlKGEsYil9fSksbi5mbi5leHRlbmQoe2RhdGE6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkLGUsZj10aGlzWzBdLGc9ZiYmZi5hdHRyaWJ1dGVzO2lmKHZvaWQgMD09PWEpe2lmKHRoaXMubGVuZ3RoJiYoZT1NLmdldChmKSwxPT09Zi5ub2RlVHlwZSYmIUwuZ2V0KGYsXCJoYXNEYXRhQXR0cnNcIikpKXtjPWcubGVuZ3RoO3doaWxlKGMtLSlnW2NdJiYoZD1nW2NdLm5hbWUsMD09PWQuaW5kZXhPZihcImRhdGEtXCIpJiYoZD1uLmNhbWVsQ2FzZShkLnNsaWNlKDUpKSxQKGYsZCxlW2RdKSkpO0wuc2V0KGYsXCJoYXNEYXRhQXR0cnNcIiwhMCl9cmV0dXJuIGV9cmV0dXJuXCJvYmplY3RcIj09dHlwZW9mIGE/dGhpcy5lYWNoKGZ1bmN0aW9uKCl7TS5zZXQodGhpcyxhKX0pOkoodGhpcyxmdW5jdGlvbihiKXt2YXIgYyxkPW4uY2FtZWxDYXNlKGEpO2lmKGYmJnZvaWQgMD09PWIpe2lmKGM9TS5nZXQoZixhKSx2b2lkIDAhPT1jKXJldHVybiBjO2lmKGM9TS5nZXQoZixkKSx2b2lkIDAhPT1jKXJldHVybiBjO2lmKGM9UChmLGQsdm9pZCAwKSx2b2lkIDAhPT1jKXJldHVybiBjfWVsc2UgdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGM9TS5nZXQodGhpcyxkKTtNLnNldCh0aGlzLGQsYiksLTEhPT1hLmluZGV4T2YoXCItXCIpJiZ2b2lkIDAhPT1jJiZNLnNldCh0aGlzLGEsYil9KX0sbnVsbCxiLGFyZ3VtZW50cy5sZW5ndGg+MSxudWxsLCEwKX0scmVtb3ZlRGF0YTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7TS5yZW1vdmUodGhpcyxhKX0pfX0pLG4uZXh0ZW5kKHtxdWV1ZTpmdW5jdGlvbihhLGIsYyl7dmFyIGQ7cmV0dXJuIGE/KGI9KGJ8fFwiZnhcIikrXCJxdWV1ZVwiLGQ9TC5nZXQoYSxiKSxjJiYoIWR8fG4uaXNBcnJheShjKT9kPUwuYWNjZXNzKGEsYixuLm1ha2VBcnJheShjKSk6ZC5wdXNoKGMpKSxkfHxbXSk6dm9pZCAwfSxkZXF1ZXVlOmZ1bmN0aW9uKGEsYil7Yj1ifHxcImZ4XCI7dmFyIGM9bi5xdWV1ZShhLGIpLGQ9Yy5sZW5ndGgsZT1jLnNoaWZ0KCksZj1uLl9xdWV1ZUhvb2tzKGEsYiksZz1mdW5jdGlvbigpe24uZGVxdWV1ZShhLGIpfTtcImlucHJvZ3Jlc3NcIj09PWUmJihlPWMuc2hpZnQoKSxkLS0pLGUmJihcImZ4XCI9PT1iJiZjLnVuc2hpZnQoXCJpbnByb2dyZXNzXCIpLGRlbGV0ZSBmLnN0b3AsZS5jYWxsKGEsZyxmKSksIWQmJmYmJmYuZW1wdHkuZmlyZSgpfSxfcXVldWVIb29rczpmdW5jdGlvbihhLGIpe3ZhciBjPWIrXCJxdWV1ZUhvb2tzXCI7cmV0dXJuIEwuZ2V0KGEsYyl8fEwuYWNjZXNzKGEsYyx7ZW1wdHk6bi5DYWxsYmFja3MoXCJvbmNlIG1lbW9yeVwiKS5hZGQoZnVuY3Rpb24oKXtMLnJlbW92ZShhLFtiK1wicXVldWVcIixjXSl9KX0pfX0pLG4uZm4uZXh0ZW5kKHtxdWV1ZTpmdW5jdGlvbihhLGIpe3ZhciBjPTI7cmV0dXJuXCJzdHJpbmdcIiE9dHlwZW9mIGEmJihiPWEsYT1cImZ4XCIsYy0tKSxhcmd1bWVudHMubGVuZ3RoPGM/bi5xdWV1ZSh0aGlzWzBdLGEpOnZvaWQgMD09PWI/dGhpczp0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgYz1uLnF1ZXVlKHRoaXMsYSxiKTtuLl9xdWV1ZUhvb2tzKHRoaXMsYSksXCJmeFwiPT09YSYmXCJpbnByb2dyZXNzXCIhPT1jWzBdJiZuLmRlcXVldWUodGhpcyxhKX0pfSxkZXF1ZXVlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtuLmRlcXVldWUodGhpcyxhKX0pfSxjbGVhclF1ZXVlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnF1ZXVlKGF8fFwiZnhcIixbXSl9LHByb21pc2U6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPTEsZT1uLkRlZmVycmVkKCksZj10aGlzLGc9dGhpcy5sZW5ndGgsaD1mdW5jdGlvbigpey0tZHx8ZS5yZXNvbHZlV2l0aChmLFtmXSl9O1wic3RyaW5nXCIhPXR5cGVvZiBhJiYoYj1hLGE9dm9pZCAwKSxhPWF8fFwiZnhcIjt3aGlsZShnLS0pYz1MLmdldChmW2ddLGErXCJxdWV1ZUhvb2tzXCIpLGMmJmMuZW1wdHkmJihkKyssYy5lbXB0eS5hZGQoaCkpO3JldHVybiBoKCksZS5wcm9taXNlKGIpfX0pO3ZhciBRPS9bKy1dPyg/OlxcZCpcXC58KVxcZCsoPzpbZUVdWystXT9cXGQrfCkvLnNvdXJjZSxSPVtcIlRvcFwiLFwiUmlnaHRcIixcIkJvdHRvbVwiLFwiTGVmdFwiXSxTPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGE9Ynx8YSxcIm5vbmVcIj09PW4uY3NzKGEsXCJkaXNwbGF5XCIpfHwhbi5jb250YWlucyhhLm93bmVyRG9jdW1lbnQsYSl9LFQ9L14oPzpjaGVja2JveHxyYWRpbykkL2k7IWZ1bmN0aW9uKCl7dmFyIGE9bC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksYj1hLmFwcGVuZENoaWxkKGwuY3JlYXRlRWxlbWVudChcImRpdlwiKSksYz1sLmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtjLnNldEF0dHJpYnV0ZShcInR5cGVcIixcInJhZGlvXCIpLGMuc2V0QXR0cmlidXRlKFwiY2hlY2tlZFwiLFwiY2hlY2tlZFwiKSxjLnNldEF0dHJpYnV0ZShcIm5hbWVcIixcInRcIiksYi5hcHBlbmRDaGlsZChjKSxrLmNoZWNrQ2xvbmU9Yi5jbG9uZU5vZGUoITApLmNsb25lTm9kZSghMCkubGFzdENoaWxkLmNoZWNrZWQsYi5pbm5lckhUTUw9XCI8dGV4dGFyZWE+eDwvdGV4dGFyZWE+XCIsay5ub0Nsb25lQ2hlY2tlZD0hIWIuY2xvbmVOb2RlKCEwKS5sYXN0Q2hpbGQuZGVmYXVsdFZhbHVlfSgpO3ZhciBVPVwidW5kZWZpbmVkXCI7ay5mb2N1c2luQnViYmxlcz1cIm9uZm9jdXNpblwiaW4gYTt2YXIgVj0vXmtleS8sVz0vXig/Om1vdXNlfHBvaW50ZXJ8Y29udGV4dG1lbnUpfGNsaWNrLyxYPS9eKD86Zm9jdXNpbmZvY3VzfGZvY3Vzb3V0Ymx1cikkLyxZPS9eKFteLl0qKSg/OlxcLiguKyl8KSQvO2Z1bmN0aW9uIFooKXtyZXR1cm4hMH1mdW5jdGlvbiAkKCl7cmV0dXJuITF9ZnVuY3Rpb24gXygpe3RyeXtyZXR1cm4gbC5hY3RpdmVFbGVtZW50fWNhdGNoKGEpe319bi5ldmVudD17Z2xvYmFsOnt9LGFkZDpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmLGcsaCxpLGosayxsLG0sbyxwLHEscj1MLmdldChhKTtpZihyKXtjLmhhbmRsZXImJihmPWMsYz1mLmhhbmRsZXIsZT1mLnNlbGVjdG9yKSxjLmd1aWR8fChjLmd1aWQ9bi5ndWlkKyspLChpPXIuZXZlbnRzKXx8KGk9ci5ldmVudHM9e30pLChnPXIuaGFuZGxlKXx8KGc9ci5oYW5kbGU9ZnVuY3Rpb24oYil7cmV0dXJuIHR5cGVvZiBuIT09VSYmbi5ldmVudC50cmlnZ2VyZWQhPT1iLnR5cGU/bi5ldmVudC5kaXNwYXRjaC5hcHBseShhLGFyZ3VtZW50cyk6dm9pZCAwfSksYj0oYnx8XCJcIikubWF0Y2goRSl8fFtcIlwiXSxqPWIubGVuZ3RoO3doaWxlKGotLSloPVkuZXhlYyhiW2pdKXx8W10sbz1xPWhbMV0scD0oaFsyXXx8XCJcIikuc3BsaXQoXCIuXCIpLnNvcnQoKSxvJiYobD1uLmV2ZW50LnNwZWNpYWxbb118fHt9LG89KGU/bC5kZWxlZ2F0ZVR5cGU6bC5iaW5kVHlwZSl8fG8sbD1uLmV2ZW50LnNwZWNpYWxbb118fHt9LGs9bi5leHRlbmQoe3R5cGU6byxvcmlnVHlwZTpxLGRhdGE6ZCxoYW5kbGVyOmMsZ3VpZDpjLmd1aWQsc2VsZWN0b3I6ZSxuZWVkc0NvbnRleHQ6ZSYmbi5leHByLm1hdGNoLm5lZWRzQ29udGV4dC50ZXN0KGUpLG5hbWVzcGFjZTpwLmpvaW4oXCIuXCIpfSxmKSwobT1pW29dKXx8KG09aVtvXT1bXSxtLmRlbGVnYXRlQ291bnQ9MCxsLnNldHVwJiZsLnNldHVwLmNhbGwoYSxkLHAsZykhPT0hMXx8YS5hZGRFdmVudExpc3RlbmVyJiZhLmFkZEV2ZW50TGlzdGVuZXIobyxnLCExKSksbC5hZGQmJihsLmFkZC5jYWxsKGEsayksay5oYW5kbGVyLmd1aWR8fChrLmhhbmRsZXIuZ3VpZD1jLmd1aWQpKSxlP20uc3BsaWNlKG0uZGVsZWdhdGVDb3VudCsrLDAsayk6bS5wdXNoKGspLG4uZXZlbnQuZ2xvYmFsW29dPSEwKX19LHJlbW92ZTpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmLGcsaCxpLGosayxsLG0sbyxwLHEscj1MLmhhc0RhdGEoYSkmJkwuZ2V0KGEpO2lmKHImJihpPXIuZXZlbnRzKSl7Yj0oYnx8XCJcIikubWF0Y2goRSl8fFtcIlwiXSxqPWIubGVuZ3RoO3doaWxlKGotLSlpZihoPVkuZXhlYyhiW2pdKXx8W10sbz1xPWhbMV0scD0oaFsyXXx8XCJcIikuc3BsaXQoXCIuXCIpLnNvcnQoKSxvKXtsPW4uZXZlbnQuc3BlY2lhbFtvXXx8e30sbz0oZD9sLmRlbGVnYXRlVHlwZTpsLmJpbmRUeXBlKXx8byxtPWlbb118fFtdLGg9aFsyXSYmbmV3IFJlZ0V4cChcIihefFxcXFwuKVwiK3Auam9pbihcIlxcXFwuKD86LipcXFxcLnwpXCIpK1wiKFxcXFwufCQpXCIpLGc9Zj1tLmxlbmd0aDt3aGlsZShmLS0paz1tW2ZdLCFlJiZxIT09ay5vcmlnVHlwZXx8YyYmYy5ndWlkIT09ay5ndWlkfHxoJiYhaC50ZXN0KGsubmFtZXNwYWNlKXx8ZCYmZCE9PWsuc2VsZWN0b3ImJihcIioqXCIhPT1kfHwhay5zZWxlY3Rvcil8fChtLnNwbGljZShmLDEpLGsuc2VsZWN0b3ImJm0uZGVsZWdhdGVDb3VudC0tLGwucmVtb3ZlJiZsLnJlbW92ZS5jYWxsKGEsaykpO2cmJiFtLmxlbmd0aCYmKGwudGVhcmRvd24mJmwudGVhcmRvd24uY2FsbChhLHAsci5oYW5kbGUpIT09ITF8fG4ucmVtb3ZlRXZlbnQoYSxvLHIuaGFuZGxlKSxkZWxldGUgaVtvXSl9ZWxzZSBmb3IobyBpbiBpKW4uZXZlbnQucmVtb3ZlKGEsbytiW2pdLGMsZCwhMCk7bi5pc0VtcHR5T2JqZWN0KGkpJiYoZGVsZXRlIHIuaGFuZGxlLEwucmVtb3ZlKGEsXCJldmVudHNcIikpfX0sdHJpZ2dlcjpmdW5jdGlvbihiLGMsZCxlKXt2YXIgZixnLGgsaSxrLG0sbyxwPVtkfHxsXSxxPWouY2FsbChiLFwidHlwZVwiKT9iLnR5cGU6YixyPWouY2FsbChiLFwibmFtZXNwYWNlXCIpP2IubmFtZXNwYWNlLnNwbGl0KFwiLlwiKTpbXTtpZihnPWg9ZD1kfHxsLDMhPT1kLm5vZGVUeXBlJiY4IT09ZC5ub2RlVHlwZSYmIVgudGVzdChxK24uZXZlbnQudHJpZ2dlcmVkKSYmKHEuaW5kZXhPZihcIi5cIik+PTAmJihyPXEuc3BsaXQoXCIuXCIpLHE9ci5zaGlmdCgpLHIuc29ydCgpKSxrPXEuaW5kZXhPZihcIjpcIik8MCYmXCJvblwiK3EsYj1iW24uZXhwYW5kb10/YjpuZXcgbi5FdmVudChxLFwib2JqZWN0XCI9PXR5cGVvZiBiJiZiKSxiLmlzVHJpZ2dlcj1lPzI6MyxiLm5hbWVzcGFjZT1yLmpvaW4oXCIuXCIpLGIubmFtZXNwYWNlX3JlPWIubmFtZXNwYWNlP25ldyBSZWdFeHAoXCIoXnxcXFxcLilcIityLmpvaW4oXCJcXFxcLig/Oi4qXFxcXC58KVwiKStcIihcXFxcLnwkKVwiKTpudWxsLGIucmVzdWx0PXZvaWQgMCxiLnRhcmdldHx8KGIudGFyZ2V0PWQpLGM9bnVsbD09Yz9bYl06bi5tYWtlQXJyYXkoYyxbYl0pLG89bi5ldmVudC5zcGVjaWFsW3FdfHx7fSxlfHwhby50cmlnZ2VyfHxvLnRyaWdnZXIuYXBwbHkoZCxjKSE9PSExKSl7aWYoIWUmJiFvLm5vQnViYmxlJiYhbi5pc1dpbmRvdyhkKSl7Zm9yKGk9by5kZWxlZ2F0ZVR5cGV8fHEsWC50ZXN0KGkrcSl8fChnPWcucGFyZW50Tm9kZSk7ZztnPWcucGFyZW50Tm9kZSlwLnB1c2goZyksaD1nO2g9PT0oZC5vd25lckRvY3VtZW50fHxsKSYmcC5wdXNoKGguZGVmYXVsdFZpZXd8fGgucGFyZW50V2luZG93fHxhKX1mPTA7d2hpbGUoKGc9cFtmKytdKSYmIWIuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSliLnR5cGU9Zj4xP2k6by5iaW5kVHlwZXx8cSxtPShMLmdldChnLFwiZXZlbnRzXCIpfHx7fSlbYi50eXBlXSYmTC5nZXQoZyxcImhhbmRsZVwiKSxtJiZtLmFwcGx5KGcsYyksbT1rJiZnW2tdLG0mJm0uYXBwbHkmJm4uYWNjZXB0RGF0YShnKSYmKGIucmVzdWx0PW0uYXBwbHkoZyxjKSxiLnJlc3VsdD09PSExJiZiLnByZXZlbnREZWZhdWx0KCkpO3JldHVybiBiLnR5cGU9cSxlfHxiLmlzRGVmYXVsdFByZXZlbnRlZCgpfHxvLl9kZWZhdWx0JiZvLl9kZWZhdWx0LmFwcGx5KHAucG9wKCksYykhPT0hMXx8IW4uYWNjZXB0RGF0YShkKXx8ayYmbi5pc0Z1bmN0aW9uKGRbcV0pJiYhbi5pc1dpbmRvdyhkKSYmKGg9ZFtrXSxoJiYoZFtrXT1udWxsKSxuLmV2ZW50LnRyaWdnZXJlZD1xLGRbcV0oKSxuLmV2ZW50LnRyaWdnZXJlZD12b2lkIDAsaCYmKGRba109aCkpLGIucmVzdWx0fX0sZGlzcGF0Y2g6ZnVuY3Rpb24oYSl7YT1uLmV2ZW50LmZpeChhKTt2YXIgYixjLGUsZixnLGg9W10saT1kLmNhbGwoYXJndW1lbnRzKSxqPShMLmdldCh0aGlzLFwiZXZlbnRzXCIpfHx7fSlbYS50eXBlXXx8W10saz1uLmV2ZW50LnNwZWNpYWxbYS50eXBlXXx8e307aWYoaVswXT1hLGEuZGVsZWdhdGVUYXJnZXQ9dGhpcywhay5wcmVEaXNwYXRjaHx8ay5wcmVEaXNwYXRjaC5jYWxsKHRoaXMsYSkhPT0hMSl7aD1uLmV2ZW50LmhhbmRsZXJzLmNhbGwodGhpcyxhLGopLGI9MDt3aGlsZSgoZj1oW2IrK10pJiYhYS5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpKXthLmN1cnJlbnRUYXJnZXQ9Zi5lbGVtLGM9MDt3aGlsZSgoZz1mLmhhbmRsZXJzW2MrK10pJiYhYS5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCgpKSghYS5uYW1lc3BhY2VfcmV8fGEubmFtZXNwYWNlX3JlLnRlc3QoZy5uYW1lc3BhY2UpKSYmKGEuaGFuZGxlT2JqPWcsYS5kYXRhPWcuZGF0YSxlPSgobi5ldmVudC5zcGVjaWFsW2cub3JpZ1R5cGVdfHx7fSkuaGFuZGxlfHxnLmhhbmRsZXIpLmFwcGx5KGYuZWxlbSxpKSx2b2lkIDAhPT1lJiYoYS5yZXN1bHQ9ZSk9PT0hMSYmKGEucHJldmVudERlZmF1bHQoKSxhLnN0b3BQcm9wYWdhdGlvbigpKSl9cmV0dXJuIGsucG9zdERpc3BhdGNoJiZrLnBvc3REaXNwYXRjaC5jYWxsKHRoaXMsYSksYS5yZXN1bHR9fSxoYW5kbGVyczpmdW5jdGlvbihhLGIpe3ZhciBjLGQsZSxmLGc9W10saD1iLmRlbGVnYXRlQ291bnQsaT1hLnRhcmdldDtpZihoJiZpLm5vZGVUeXBlJiYoIWEuYnV0dG9ufHxcImNsaWNrXCIhPT1hLnR5cGUpKWZvcig7aSE9PXRoaXM7aT1pLnBhcmVudE5vZGV8fHRoaXMpaWYoaS5kaXNhYmxlZCE9PSEwfHxcImNsaWNrXCIhPT1hLnR5cGUpe2ZvcihkPVtdLGM9MDtoPmM7YysrKWY9YltjXSxlPWYuc2VsZWN0b3IrXCIgXCIsdm9pZCAwPT09ZFtlXSYmKGRbZV09Zi5uZWVkc0NvbnRleHQ/bihlLHRoaXMpLmluZGV4KGkpPj0wOm4uZmluZChlLHRoaXMsbnVsbCxbaV0pLmxlbmd0aCksZFtlXSYmZC5wdXNoKGYpO2QubGVuZ3RoJiZnLnB1c2goe2VsZW06aSxoYW5kbGVyczpkfSl9cmV0dXJuIGg8Yi5sZW5ndGgmJmcucHVzaCh7ZWxlbTp0aGlzLGhhbmRsZXJzOmIuc2xpY2UoaCl9KSxnfSxwcm9wczpcImFsdEtleSBidWJibGVzIGNhbmNlbGFibGUgY3RybEtleSBjdXJyZW50VGFyZ2V0IGV2ZW50UGhhc2UgbWV0YUtleSByZWxhdGVkVGFyZ2V0IHNoaWZ0S2V5IHRhcmdldCB0aW1lU3RhbXAgdmlldyB3aGljaFwiLnNwbGl0KFwiIFwiKSxmaXhIb29rczp7fSxrZXlIb29rczp7cHJvcHM6XCJjaGFyIGNoYXJDb2RlIGtleSBrZXlDb2RlXCIuc3BsaXQoXCIgXCIpLGZpbHRlcjpmdW5jdGlvbihhLGIpe3JldHVybiBudWxsPT1hLndoaWNoJiYoYS53aGljaD1udWxsIT1iLmNoYXJDb2RlP2IuY2hhckNvZGU6Yi5rZXlDb2RlKSxhfX0sbW91c2VIb29rczp7cHJvcHM6XCJidXR0b24gYnV0dG9ucyBjbGllbnRYIGNsaWVudFkgb2Zmc2V0WCBvZmZzZXRZIHBhZ2VYIHBhZ2VZIHNjcmVlblggc2NyZWVuWSB0b0VsZW1lbnRcIi5zcGxpdChcIiBcIiksZmlsdGVyOmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlLGY9Yi5idXR0b247cmV0dXJuIG51bGw9PWEucGFnZVgmJm51bGwhPWIuY2xpZW50WCYmKGM9YS50YXJnZXQub3duZXJEb2N1bWVudHx8bCxkPWMuZG9jdW1lbnRFbGVtZW50LGU9Yy5ib2R5LGEucGFnZVg9Yi5jbGllbnRYKyhkJiZkLnNjcm9sbExlZnR8fGUmJmUuc2Nyb2xsTGVmdHx8MCktKGQmJmQuY2xpZW50TGVmdHx8ZSYmZS5jbGllbnRMZWZ0fHwwKSxhLnBhZ2VZPWIuY2xpZW50WSsoZCYmZC5zY3JvbGxUb3B8fGUmJmUuc2Nyb2xsVG9wfHwwKS0oZCYmZC5jbGllbnRUb3B8fGUmJmUuY2xpZW50VG9wfHwwKSksYS53aGljaHx8dm9pZCAwPT09Znx8KGEud2hpY2g9MSZmPzE6MiZmPzM6NCZmPzI6MCksYX19LGZpeDpmdW5jdGlvbihhKXtpZihhW24uZXhwYW5kb10pcmV0dXJuIGE7dmFyIGIsYyxkLGU9YS50eXBlLGY9YSxnPXRoaXMuZml4SG9va3NbZV07Z3x8KHRoaXMuZml4SG9va3NbZV09Zz1XLnRlc3QoZSk/dGhpcy5tb3VzZUhvb2tzOlYudGVzdChlKT90aGlzLmtleUhvb2tzOnt9KSxkPWcucHJvcHM/dGhpcy5wcm9wcy5jb25jYXQoZy5wcm9wcyk6dGhpcy5wcm9wcyxhPW5ldyBuLkV2ZW50KGYpLGI9ZC5sZW5ndGg7d2hpbGUoYi0tKWM9ZFtiXSxhW2NdPWZbY107cmV0dXJuIGEudGFyZ2V0fHwoYS50YXJnZXQ9bCksMz09PWEudGFyZ2V0Lm5vZGVUeXBlJiYoYS50YXJnZXQ9YS50YXJnZXQucGFyZW50Tm9kZSksZy5maWx0ZXI/Zy5maWx0ZXIoYSxmKTphfSxzcGVjaWFsOntsb2FkOntub0J1YmJsZTohMH0sZm9jdXM6e3RyaWdnZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcyE9PV8oKSYmdGhpcy5mb2N1cz8odGhpcy5mb2N1cygpLCExKTp2b2lkIDB9LGRlbGVnYXRlVHlwZTpcImZvY3VzaW5cIn0sYmx1cjp7dHJpZ2dlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzPT09XygpJiZ0aGlzLmJsdXI/KHRoaXMuYmx1cigpLCExKTp2b2lkIDB9LGRlbGVnYXRlVHlwZTpcImZvY3Vzb3V0XCJ9LGNsaWNrOnt0cmlnZ2VyOmZ1bmN0aW9uKCl7cmV0dXJuXCJjaGVja2JveFwiPT09dGhpcy50eXBlJiZ0aGlzLmNsaWNrJiZuLm5vZGVOYW1lKHRoaXMsXCJpbnB1dFwiKT8odGhpcy5jbGljaygpLCExKTp2b2lkIDB9LF9kZWZhdWx0OmZ1bmN0aW9uKGEpe3JldHVybiBuLm5vZGVOYW1lKGEudGFyZ2V0LFwiYVwiKX19LGJlZm9yZXVubG9hZDp7cG9zdERpc3BhdGNoOmZ1bmN0aW9uKGEpe3ZvaWQgMCE9PWEucmVzdWx0JiZhLm9yaWdpbmFsRXZlbnQmJihhLm9yaWdpbmFsRXZlbnQucmV0dXJuVmFsdWU9YS5yZXN1bHQpfX19LHNpbXVsYXRlOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPW4uZXh0ZW5kKG5ldyBuLkV2ZW50LGMse3R5cGU6YSxpc1NpbXVsYXRlZDohMCxvcmlnaW5hbEV2ZW50Ont9fSk7ZD9uLmV2ZW50LnRyaWdnZXIoZSxudWxsLGIpOm4uZXZlbnQuZGlzcGF0Y2guY2FsbChiLGUpLGUuaXNEZWZhdWx0UHJldmVudGVkKCkmJmMucHJldmVudERlZmF1bHQoKX19LG4ucmVtb3ZlRXZlbnQ9ZnVuY3Rpb24oYSxiLGMpe2EucmVtb3ZlRXZlbnRMaXN0ZW5lciYmYS5yZW1vdmVFdmVudExpc3RlbmVyKGIsYywhMSl9LG4uRXZlbnQ9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcyBpbnN0YW5jZW9mIG4uRXZlbnQ/KGEmJmEudHlwZT8odGhpcy5vcmlnaW5hbEV2ZW50PWEsdGhpcy50eXBlPWEudHlwZSx0aGlzLmlzRGVmYXVsdFByZXZlbnRlZD1hLmRlZmF1bHRQcmV2ZW50ZWR8fHZvaWQgMD09PWEuZGVmYXVsdFByZXZlbnRlZCYmYS5yZXR1cm5WYWx1ZT09PSExP1o6JCk6dGhpcy50eXBlPWEsYiYmbi5leHRlbmQodGhpcyxiKSx0aGlzLnRpbWVTdGFtcD1hJiZhLnRpbWVTdGFtcHx8bi5ub3coKSx2b2lkKHRoaXNbbi5leHBhbmRvXT0hMCkpOm5ldyBuLkV2ZW50KGEsYil9LG4uRXZlbnQucHJvdG90eXBlPXtpc0RlZmF1bHRQcmV2ZW50ZWQ6JCxpc1Byb3BhZ2F0aW9uU3RvcHBlZDokLGlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkOiQscHJldmVudERlZmF1bHQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9yaWdpbmFsRXZlbnQ7dGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQ9WixhJiZhLnByZXZlbnREZWZhdWx0JiZhLnByZXZlbnREZWZhdWx0KCl9LHN0b3BQcm9wYWdhdGlvbjpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3JpZ2luYWxFdmVudDt0aGlzLmlzUHJvcGFnYXRpb25TdG9wcGVkPVosYSYmYS5zdG9wUHJvcGFnYXRpb24mJmEuc3RvcFByb3BhZ2F0aW9uKCl9LHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbjpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3JpZ2luYWxFdmVudDt0aGlzLmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkPVosYSYmYS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24mJmEuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksdGhpcy5zdG9wUHJvcGFnYXRpb24oKX19LG4uZWFjaCh7bW91c2VlbnRlcjpcIm1vdXNlb3ZlclwiLG1vdXNlbGVhdmU6XCJtb3VzZW91dFwiLHBvaW50ZXJlbnRlcjpcInBvaW50ZXJvdmVyXCIscG9pbnRlcmxlYXZlOlwicG9pbnRlcm91dFwifSxmdW5jdGlvbihhLGIpe24uZXZlbnQuc3BlY2lhbFthXT17ZGVsZWdhdGVUeXBlOmIsYmluZFR5cGU6YixoYW5kbGU6ZnVuY3Rpb24oYSl7dmFyIGMsZD10aGlzLGU9YS5yZWxhdGVkVGFyZ2V0LGY9YS5oYW5kbGVPYmo7cmV0dXJuKCFlfHxlIT09ZCYmIW4uY29udGFpbnMoZCxlKSkmJihhLnR5cGU9Zi5vcmlnVHlwZSxjPWYuaGFuZGxlci5hcHBseSh0aGlzLGFyZ3VtZW50cyksYS50eXBlPWIpLGN9fX0pLGsuZm9jdXNpbkJ1YmJsZXN8fG4uZWFjaCh7Zm9jdXM6XCJmb2N1c2luXCIsYmx1cjpcImZvY3Vzb3V0XCJ9LGZ1bmN0aW9uKGEsYil7dmFyIGM9ZnVuY3Rpb24oYSl7bi5ldmVudC5zaW11bGF0ZShiLGEudGFyZ2V0LG4uZXZlbnQuZml4KGEpLCEwKX07bi5ldmVudC5zcGVjaWFsW2JdPXtzZXR1cDpmdW5jdGlvbigpe3ZhciBkPXRoaXMub3duZXJEb2N1bWVudHx8dGhpcyxlPUwuYWNjZXNzKGQsYik7ZXx8ZC5hZGRFdmVudExpc3RlbmVyKGEsYywhMCksTC5hY2Nlc3MoZCxiLChlfHwwKSsxKX0sdGVhcmRvd246ZnVuY3Rpb24oKXt2YXIgZD10aGlzLm93bmVyRG9jdW1lbnR8fHRoaXMsZT1MLmFjY2VzcyhkLGIpLTE7ZT9MLmFjY2VzcyhkLGIsZSk6KGQucmVtb3ZlRXZlbnRMaXN0ZW5lcihhLGMsITApLEwucmVtb3ZlKGQsYikpfX19KSxuLmZuLmV4dGVuZCh7b246ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZixnO2lmKFwib2JqZWN0XCI9PXR5cGVvZiBhKXtcInN0cmluZ1wiIT10eXBlb2YgYiYmKGM9Y3x8YixiPXZvaWQgMCk7Zm9yKGcgaW4gYSl0aGlzLm9uKGcsYixjLGFbZ10sZSk7cmV0dXJuIHRoaXN9aWYobnVsbD09YyYmbnVsbD09ZD8oZD1iLGM9Yj12b2lkIDApOm51bGw9PWQmJihcInN0cmluZ1wiPT10eXBlb2YgYj8oZD1jLGM9dm9pZCAwKTooZD1jLGM9YixiPXZvaWQgMCkpLGQ9PT0hMSlkPSQ7ZWxzZSBpZighZClyZXR1cm4gdGhpcztyZXR1cm4gMT09PWUmJihmPWQsZD1mdW5jdGlvbihhKXtyZXR1cm4gbigpLm9mZihhKSxmLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZC5ndWlkPWYuZ3VpZHx8KGYuZ3VpZD1uLmd1aWQrKykpLHRoaXMuZWFjaChmdW5jdGlvbigpe24uZXZlbnQuYWRkKHRoaXMsYSxkLGMsYil9KX0sb25lOmZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLm9uKGEsYixjLGQsMSl9LG9mZjpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZTtpZihhJiZhLnByZXZlbnREZWZhdWx0JiZhLmhhbmRsZU9iailyZXR1cm4gZD1hLmhhbmRsZU9iaixuKGEuZGVsZWdhdGVUYXJnZXQpLm9mZihkLm5hbWVzcGFjZT9kLm9yaWdUeXBlK1wiLlwiK2QubmFtZXNwYWNlOmQub3JpZ1R5cGUsZC5zZWxlY3RvcixkLmhhbmRsZXIpLHRoaXM7aWYoXCJvYmplY3RcIj09dHlwZW9mIGEpe2ZvcihlIGluIGEpdGhpcy5vZmYoZSxiLGFbZV0pO3JldHVybiB0aGlzfXJldHVybihiPT09ITF8fFwiZnVuY3Rpb25cIj09dHlwZW9mIGIpJiYoYz1iLGI9dm9pZCAwKSxjPT09ITEmJihjPSQpLHRoaXMuZWFjaChmdW5jdGlvbigpe24uZXZlbnQucmVtb3ZlKHRoaXMsYSxjLGIpfSl9LHRyaWdnZXI6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7bi5ldmVudC50cmlnZ2VyKGEsYix0aGlzKX0pfSx0cmlnZ2VySGFuZGxlcjpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXNbMF07cmV0dXJuIGM/bi5ldmVudC50cmlnZ2VyKGEsYixjLCEwKTp2b2lkIDB9fSk7dmFyIGFiPS88KD8hYXJlYXxicnxjb2x8ZW1iZWR8aHJ8aW1nfGlucHV0fGxpbmt8bWV0YXxwYXJhbSkoKFtcXHc6XSspW14+XSopXFwvPi9naSxiYj0vPChbXFx3Ol0rKS8sY2I9Lzx8JiM/XFx3KzsvLGRiPS88KD86c2NyaXB0fHN0eWxlfGxpbmspL2ksZWI9L2NoZWNrZWRcXHMqKD86W149XXw9XFxzKi5jaGVja2VkLikvaSxmYj0vXiR8XFwvKD86amF2YXxlY21hKXNjcmlwdC9pLGdiPS9edHJ1ZVxcLyguKikvLGhiPS9eXFxzKjwhKD86XFxbQ0RBVEFcXFt8LS0pfCg/OlxcXVxcXXwtLSk+XFxzKiQvZyxpYj17b3B0aW9uOlsxLFwiPHNlbGVjdCBtdWx0aXBsZT0nbXVsdGlwbGUnPlwiLFwiPC9zZWxlY3Q+XCJdLHRoZWFkOlsxLFwiPHRhYmxlPlwiLFwiPC90YWJsZT5cIl0sY29sOlsyLFwiPHRhYmxlPjxjb2xncm91cD5cIixcIjwvY29sZ3JvdXA+PC90YWJsZT5cIl0sdHI6WzIsXCI8dGFibGU+PHRib2R5PlwiLFwiPC90Ym9keT48L3RhYmxlPlwiXSx0ZDpbMyxcIjx0YWJsZT48dGJvZHk+PHRyPlwiLFwiPC90cj48L3Rib2R5PjwvdGFibGU+XCJdLF9kZWZhdWx0OlswLFwiXCIsXCJcIl19O2liLm9wdGdyb3VwPWliLm9wdGlvbixpYi50Ym9keT1pYi50Zm9vdD1pYi5jb2xncm91cD1pYi5jYXB0aW9uPWliLnRoZWFkLGliLnRoPWliLnRkO2Z1bmN0aW9uIGpiKGEsYil7cmV0dXJuIG4ubm9kZU5hbWUoYSxcInRhYmxlXCIpJiZuLm5vZGVOYW1lKDExIT09Yi5ub2RlVHlwZT9iOmIuZmlyc3RDaGlsZCxcInRyXCIpP2EuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ0Ym9keVwiKVswXXx8YS5hcHBlbmRDaGlsZChhLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRib2R5XCIpKTphfWZ1bmN0aW9uIGtiKGEpe3JldHVybiBhLnR5cGU9KG51bGwhPT1hLmdldEF0dHJpYnV0ZShcInR5cGVcIikpK1wiL1wiK2EudHlwZSxhfWZ1bmN0aW9uIGxiKGEpe3ZhciBiPWdiLmV4ZWMoYS50eXBlKTtyZXR1cm4gYj9hLnR5cGU9YlsxXTphLnJlbW92ZUF0dHJpYnV0ZShcInR5cGVcIiksYX1mdW5jdGlvbiBtYihhLGIpe2Zvcih2YXIgYz0wLGQ9YS5sZW5ndGg7ZD5jO2MrKylMLnNldChhW2NdLFwiZ2xvYmFsRXZhbFwiLCFifHxMLmdldChiW2NdLFwiZ2xvYmFsRXZhbFwiKSl9ZnVuY3Rpb24gbmIoYSxiKXt2YXIgYyxkLGUsZixnLGgsaSxqO2lmKDE9PT1iLm5vZGVUeXBlKXtpZihMLmhhc0RhdGEoYSkmJihmPUwuYWNjZXNzKGEpLGc9TC5zZXQoYixmKSxqPWYuZXZlbnRzKSl7ZGVsZXRlIGcuaGFuZGxlLGcuZXZlbnRzPXt9O2ZvcihlIGluIGopZm9yKGM9MCxkPWpbZV0ubGVuZ3RoO2Q+YztjKyspbi5ldmVudC5hZGQoYixlLGpbZV1bY10pfU0uaGFzRGF0YShhKSYmKGg9TS5hY2Nlc3MoYSksaT1uLmV4dGVuZCh7fSxoKSxNLnNldChiLGkpKX19ZnVuY3Rpb24gb2IoYSxiKXt2YXIgYz1hLmdldEVsZW1lbnRzQnlUYWdOYW1lP2EuZ2V0RWxlbWVudHNCeVRhZ05hbWUoYnx8XCIqXCIpOmEucXVlcnlTZWxlY3RvckFsbD9hLnF1ZXJ5U2VsZWN0b3JBbGwoYnx8XCIqXCIpOltdO3JldHVybiB2b2lkIDA9PT1ifHxiJiZuLm5vZGVOYW1lKGEsYik/bi5tZXJnZShbYV0sYyk6Y31mdW5jdGlvbiBwYihhLGIpe3ZhciBjPWIubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcImlucHV0XCI9PT1jJiZULnRlc3QoYS50eXBlKT9iLmNoZWNrZWQ9YS5jaGVja2VkOihcImlucHV0XCI9PT1jfHxcInRleHRhcmVhXCI9PT1jKSYmKGIuZGVmYXVsdFZhbHVlPWEuZGVmYXVsdFZhbHVlKX1uLmV4dGVuZCh7Y2xvbmU6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZixnLGg9YS5jbG9uZU5vZGUoITApLGk9bi5jb250YWlucyhhLm93bmVyRG9jdW1lbnQsYSk7aWYoIShrLm5vQ2xvbmVDaGVja2VkfHwxIT09YS5ub2RlVHlwZSYmMTEhPT1hLm5vZGVUeXBlfHxuLmlzWE1MRG9jKGEpKSlmb3IoZz1vYihoKSxmPW9iKGEpLGQ9MCxlPWYubGVuZ3RoO2U+ZDtkKyspcGIoZltkXSxnW2RdKTtpZihiKWlmKGMpZm9yKGY9Znx8b2IoYSksZz1nfHxvYihoKSxkPTAsZT1mLmxlbmd0aDtlPmQ7ZCsrKW5iKGZbZF0sZ1tkXSk7ZWxzZSBuYihhLGgpO3JldHVybiBnPW9iKGgsXCJzY3JpcHRcIiksZy5sZW5ndGg+MCYmbWIoZywhaSYmb2IoYSxcInNjcmlwdFwiKSksaH0sYnVpbGRGcmFnbWVudDpmdW5jdGlvbihhLGIsYyxkKXtmb3IodmFyIGUsZixnLGgsaSxqLGs9Yi5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksbD1bXSxtPTAsbz1hLmxlbmd0aDtvPm07bSsrKWlmKGU9YVttXSxlfHwwPT09ZSlpZihcIm9iamVjdFwiPT09bi50eXBlKGUpKW4ubWVyZ2UobCxlLm5vZGVUeXBlP1tlXTplKTtlbHNlIGlmKGNiLnRlc3QoZSkpe2Y9Znx8ay5hcHBlbmRDaGlsZChiLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIikpLGc9KGJiLmV4ZWMoZSl8fFtcIlwiLFwiXCJdKVsxXS50b0xvd2VyQ2FzZSgpLGg9aWJbZ118fGliLl9kZWZhdWx0LGYuaW5uZXJIVE1MPWhbMV0rZS5yZXBsYWNlKGFiLFwiPCQxPjwvJDI+XCIpK2hbMl0saj1oWzBdO3doaWxlKGotLSlmPWYubGFzdENoaWxkO24ubWVyZ2UobCxmLmNoaWxkTm9kZXMpLGY9ay5maXJzdENoaWxkLGYudGV4dENvbnRlbnQ9XCJcIn1lbHNlIGwucHVzaChiLmNyZWF0ZVRleHROb2RlKGUpKTtrLnRleHRDb250ZW50PVwiXCIsbT0wO3doaWxlKGU9bFttKytdKWlmKCghZHx8LTE9PT1uLmluQXJyYXkoZSxkKSkmJihpPW4uY29udGFpbnMoZS5vd25lckRvY3VtZW50LGUpLGY9b2Ioay5hcHBlbmRDaGlsZChlKSxcInNjcmlwdFwiKSxpJiZtYihmKSxjKSl7aj0wO3doaWxlKGU9ZltqKytdKWZiLnRlc3QoZS50eXBlfHxcIlwiKSYmYy5wdXNoKGUpfXJldHVybiBrfSxjbGVhbkRhdGE6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiLGMsZCxlLGY9bi5ldmVudC5zcGVjaWFsLGc9MDt2b2lkIDAhPT0oYz1hW2ddKTtnKyspe2lmKG4uYWNjZXB0RGF0YShjKSYmKGU9Y1tMLmV4cGFuZG9dLGUmJihiPUwuY2FjaGVbZV0pKSl7aWYoYi5ldmVudHMpZm9yKGQgaW4gYi5ldmVudHMpZltkXT9uLmV2ZW50LnJlbW92ZShjLGQpOm4ucmVtb3ZlRXZlbnQoYyxkLGIuaGFuZGxlKTtMLmNhY2hlW2VdJiZkZWxldGUgTC5jYWNoZVtlXX1kZWxldGUgTS5jYWNoZVtjW00uZXhwYW5kb11dfX19KSxuLmZuLmV4dGVuZCh7dGV4dDpmdW5jdGlvbihhKXtyZXR1cm4gSih0aGlzLGZ1bmN0aW9uKGEpe3JldHVybiB2b2lkIDA9PT1hP24udGV4dCh0aGlzKTp0aGlzLmVtcHR5KCkuZWFjaChmdW5jdGlvbigpeygxPT09dGhpcy5ub2RlVHlwZXx8MTE9PT10aGlzLm5vZGVUeXBlfHw5PT09dGhpcy5ub2RlVHlwZSkmJih0aGlzLnRleHRDb250ZW50PWEpfSl9LG51bGwsYSxhcmd1bWVudHMubGVuZ3RoKX0sYXBwZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLGZ1bmN0aW9uKGEpe2lmKDE9PT10aGlzLm5vZGVUeXBlfHwxMT09PXRoaXMubm9kZVR5cGV8fDk9PT10aGlzLm5vZGVUeXBlKXt2YXIgYj1qYih0aGlzLGEpO2IuYXBwZW5kQ2hpbGQoYSl9fSl9LHByZXBlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb21NYW5pcChhcmd1bWVudHMsZnVuY3Rpb24oYSl7aWYoMT09PXRoaXMubm9kZVR5cGV8fDExPT09dGhpcy5ub2RlVHlwZXx8OT09PXRoaXMubm9kZVR5cGUpe3ZhciBiPWpiKHRoaXMsYSk7Yi5pbnNlcnRCZWZvcmUoYSxiLmZpcnN0Q2hpbGQpfX0pfSxiZWZvcmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb21NYW5pcChhcmd1bWVudHMsZnVuY3Rpb24oYSl7dGhpcy5wYXJlbnROb2RlJiZ0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGEsdGhpcyl9KX0sYWZ0ZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb21NYW5pcChhcmd1bWVudHMsZnVuY3Rpb24oYSl7dGhpcy5wYXJlbnROb2RlJiZ0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGEsdGhpcy5uZXh0U2libGluZyl9KX0scmVtb3ZlOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjLGQ9YT9uLmZpbHRlcihhLHRoaXMpOnRoaXMsZT0wO251bGwhPShjPWRbZV0pO2UrKylifHwxIT09Yy5ub2RlVHlwZXx8bi5jbGVhbkRhdGEob2IoYykpLGMucGFyZW50Tm9kZSYmKGImJm4uY29udGFpbnMoYy5vd25lckRvY3VtZW50LGMpJiZtYihvYihjLFwic2NyaXB0XCIpKSxjLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYykpO3JldHVybiB0aGlzfSxlbXB0eTpmdW5jdGlvbigpe2Zvcih2YXIgYSxiPTA7bnVsbCE9KGE9dGhpc1tiXSk7YisrKTE9PT1hLm5vZGVUeXBlJiYobi5jbGVhbkRhdGEob2IoYSwhMSkpLGEudGV4dENvbnRlbnQ9XCJcIik7cmV0dXJuIHRoaXN9LGNsb25lOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGE9bnVsbD09YT8hMTphLGI9bnVsbD09Yj9hOmIsdGhpcy5tYXAoZnVuY3Rpb24oKXtyZXR1cm4gbi5jbG9uZSh0aGlzLGEsYil9KX0saHRtbDpmdW5jdGlvbihhKXtyZXR1cm4gSih0aGlzLGZ1bmN0aW9uKGEpe3ZhciBiPXRoaXNbMF18fHt9LGM9MCxkPXRoaXMubGVuZ3RoO2lmKHZvaWQgMD09PWEmJjE9PT1iLm5vZGVUeXBlKXJldHVybiBiLmlubmVySFRNTDtpZihcInN0cmluZ1wiPT10eXBlb2YgYSYmIWRiLnRlc3QoYSkmJiFpYlsoYmIuZXhlYyhhKXx8W1wiXCIsXCJcIl0pWzFdLnRvTG93ZXJDYXNlKCldKXthPWEucmVwbGFjZShhYixcIjwkMT48LyQyPlwiKTt0cnl7Zm9yKDtkPmM7YysrKWI9dGhpc1tjXXx8e30sMT09PWIubm9kZVR5cGUmJihuLmNsZWFuRGF0YShvYihiLCExKSksYi5pbm5lckhUTUw9YSk7Yj0wfWNhdGNoKGUpe319YiYmdGhpcy5lbXB0eSgpLmFwcGVuZChhKX0sbnVsbCxhLGFyZ3VtZW50cy5sZW5ndGgpfSxyZXBsYWNlV2l0aDpmdW5jdGlvbigpe3ZhciBhPWFyZ3VtZW50c1swXTtyZXR1cm4gdGhpcy5kb21NYW5pcChhcmd1bWVudHMsZnVuY3Rpb24oYil7YT10aGlzLnBhcmVudE5vZGUsbi5jbGVhbkRhdGEob2IodGhpcykpLGEmJmEucmVwbGFjZUNoaWxkKGIsdGhpcyl9KSxhJiYoYS5sZW5ndGh8fGEubm9kZVR5cGUpP3RoaXM6dGhpcy5yZW1vdmUoKX0sZGV0YWNoOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnJlbW92ZShhLCEwKX0sZG9tTWFuaXA6ZnVuY3Rpb24oYSxiKXthPWUuYXBwbHkoW10sYSk7dmFyIGMsZCxmLGcsaCxpLGo9MCxsPXRoaXMubGVuZ3RoLG09dGhpcyxvPWwtMSxwPWFbMF0scT1uLmlzRnVuY3Rpb24ocCk7aWYocXx8bD4xJiZcInN0cmluZ1wiPT10eXBlb2YgcCYmIWsuY2hlY2tDbG9uZSYmZWIudGVzdChwKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGMpe3ZhciBkPW0uZXEoYyk7cSYmKGFbMF09cC5jYWxsKHRoaXMsYyxkLmh0bWwoKSkpLGQuZG9tTWFuaXAoYSxiKX0pO2lmKGwmJihjPW4uYnVpbGRGcmFnbWVudChhLHRoaXNbMF0ub3duZXJEb2N1bWVudCwhMSx0aGlzKSxkPWMuZmlyc3RDaGlsZCwxPT09Yy5jaGlsZE5vZGVzLmxlbmd0aCYmKGM9ZCksZCkpe2ZvcihmPW4ubWFwKG9iKGMsXCJzY3JpcHRcIiksa2IpLGc9Zi5sZW5ndGg7bD5qO2orKyloPWMsaiE9PW8mJihoPW4uY2xvbmUoaCwhMCwhMCksZyYmbi5tZXJnZShmLG9iKGgsXCJzY3JpcHRcIikpKSxiLmNhbGwodGhpc1tqXSxoLGopO2lmKGcpZm9yKGk9ZltmLmxlbmd0aC0xXS5vd25lckRvY3VtZW50LG4ubWFwKGYsbGIpLGo9MDtnPmo7aisrKWg9ZltqXSxmYi50ZXN0KGgudHlwZXx8XCJcIikmJiFMLmFjY2VzcyhoLFwiZ2xvYmFsRXZhbFwiKSYmbi5jb250YWlucyhpLGgpJiYoaC5zcmM/bi5fZXZhbFVybCYmbi5fZXZhbFVybChoLnNyYyk6bi5nbG9iYWxFdmFsKGgudGV4dENvbnRlbnQucmVwbGFjZShoYixcIlwiKSkpfXJldHVybiB0aGlzfX0pLG4uZWFjaCh7YXBwZW5kVG86XCJhcHBlbmRcIixwcmVwZW5kVG86XCJwcmVwZW5kXCIsaW5zZXJ0QmVmb3JlOlwiYmVmb3JlXCIsaW5zZXJ0QWZ0ZXI6XCJhZnRlclwiLHJlcGxhY2VBbGw6XCJyZXBsYWNlV2l0aFwifSxmdW5jdGlvbihhLGIpe24uZm5bYV09ZnVuY3Rpb24oYSl7Zm9yKHZhciBjLGQ9W10sZT1uKGEpLGc9ZS5sZW5ndGgtMSxoPTA7Zz49aDtoKyspYz1oPT09Zz90aGlzOnRoaXMuY2xvbmUoITApLG4oZVtoXSlbYl0oYyksZi5hcHBseShkLGMuZ2V0KCkpO3JldHVybiB0aGlzLnB1c2hTdGFjayhkKX19KTt2YXIgcWIscmI9e307ZnVuY3Rpb24gc2IoYixjKXt2YXIgZCxlPW4oYy5jcmVhdGVFbGVtZW50KGIpKS5hcHBlbmRUbyhjLmJvZHkpLGY9YS5nZXREZWZhdWx0Q29tcHV0ZWRTdHlsZSYmKGQ9YS5nZXREZWZhdWx0Q29tcHV0ZWRTdHlsZShlWzBdKSk/ZC5kaXNwbGF5Om4uY3NzKGVbMF0sXCJkaXNwbGF5XCIpO3JldHVybiBlLmRldGFjaCgpLGZ9ZnVuY3Rpb24gdGIoYSl7dmFyIGI9bCxjPXJiW2FdO3JldHVybiBjfHwoYz1zYihhLGIpLFwibm9uZVwiIT09YyYmY3x8KHFiPShxYnx8bihcIjxpZnJhbWUgZnJhbWVib3JkZXI9JzAnIHdpZHRoPScwJyBoZWlnaHQ9JzAnLz5cIikpLmFwcGVuZFRvKGIuZG9jdW1lbnRFbGVtZW50KSxiPXFiWzBdLmNvbnRlbnREb2N1bWVudCxiLndyaXRlKCksYi5jbG9zZSgpLGM9c2IoYSxiKSxxYi5kZXRhY2goKSkscmJbYV09YyksY312YXIgdWI9L15tYXJnaW4vLHZiPW5ldyBSZWdFeHAoXCJeKFwiK1ErXCIpKD8hcHgpW2EteiVdKyRcIixcImlcIiksd2I9ZnVuY3Rpb24oYil7cmV0dXJuIGIub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldy5vcGVuZXI/Yi5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUoYixudWxsKTphLmdldENvbXB1dGVkU3R5bGUoYixudWxsKX07ZnVuY3Rpb24geGIoYSxiLGMpe3ZhciBkLGUsZixnLGg9YS5zdHlsZTtyZXR1cm4gYz1jfHx3YihhKSxjJiYoZz1jLmdldFByb3BlcnR5VmFsdWUoYil8fGNbYl0pLGMmJihcIlwiIT09Z3x8bi5jb250YWlucyhhLm93bmVyRG9jdW1lbnQsYSl8fChnPW4uc3R5bGUoYSxiKSksdmIudGVzdChnKSYmdWIudGVzdChiKSYmKGQ9aC53aWR0aCxlPWgubWluV2lkdGgsZj1oLm1heFdpZHRoLGgubWluV2lkdGg9aC5tYXhXaWR0aD1oLndpZHRoPWcsZz1jLndpZHRoLGgud2lkdGg9ZCxoLm1pbldpZHRoPWUsaC5tYXhXaWR0aD1mKSksdm9pZCAwIT09Zz9nK1wiXCI6Z31mdW5jdGlvbiB5YihhLGIpe3JldHVybntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gYSgpP3ZvaWQgZGVsZXRlIHRoaXMuZ2V0Oih0aGlzLmdldD1iKS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fX0hZnVuY3Rpb24oKXt2YXIgYixjLGQ9bC5kb2N1bWVudEVsZW1lbnQsZT1sLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksZj1sLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7aWYoZi5zdHlsZSl7Zi5zdHlsZS5iYWNrZ3JvdW5kQ2xpcD1cImNvbnRlbnQtYm94XCIsZi5jbG9uZU5vZGUoITApLnN0eWxlLmJhY2tncm91bmRDbGlwPVwiXCIsay5jbGVhckNsb25lU3R5bGU9XCJjb250ZW50LWJveFwiPT09Zi5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCxlLnN0eWxlLmNzc1RleHQ9XCJib3JkZXI6MDt3aWR0aDowO2hlaWdodDowO3RvcDowO2xlZnQ6LTk5OTlweDttYXJnaW4tdG9wOjFweDtwb3NpdGlvbjphYnNvbHV0ZVwiLGUuYXBwZW5kQ2hpbGQoZik7ZnVuY3Rpb24gZygpe2Yuc3R5bGUuY3NzVGV4dD1cIi13ZWJraXQtYm94LXNpemluZzpib3JkZXItYm94Oy1tb3otYm94LXNpemluZzpib3JkZXItYm94O2JveC1zaXppbmc6Ym9yZGVyLWJveDtkaXNwbGF5OmJsb2NrO21hcmdpbi10b3A6MSU7dG9wOjElO2JvcmRlcjoxcHg7cGFkZGluZzoxcHg7d2lkdGg6NHB4O3Bvc2l0aW9uOmFic29sdXRlXCIsZi5pbm5lckhUTUw9XCJcIixkLmFwcGVuZENoaWxkKGUpO3ZhciBnPWEuZ2V0Q29tcHV0ZWRTdHlsZShmLG51bGwpO2I9XCIxJVwiIT09Zy50b3AsYz1cIjRweFwiPT09Zy53aWR0aCxkLnJlbW92ZUNoaWxkKGUpfWEuZ2V0Q29tcHV0ZWRTdHlsZSYmbi5leHRlbmQoayx7cGl4ZWxQb3NpdGlvbjpmdW5jdGlvbigpe3JldHVybiBnKCksYn0sYm94U2l6aW5nUmVsaWFibGU6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbD09YyYmZygpLGN9LHJlbGlhYmxlTWFyZ2luUmlnaHQ6ZnVuY3Rpb24oKXt2YXIgYixjPWYuYXBwZW5kQ2hpbGQobC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpKTtyZXR1cm4gYy5zdHlsZS5jc3NUZXh0PWYuc3R5bGUuY3NzVGV4dD1cIi13ZWJraXQtYm94LXNpemluZzpjb250ZW50LWJveDstbW96LWJveC1zaXppbmc6Y29udGVudC1ib3g7Ym94LXNpemluZzpjb250ZW50LWJveDtkaXNwbGF5OmJsb2NrO21hcmdpbjowO2JvcmRlcjowO3BhZGRpbmc6MFwiLGMuc3R5bGUubWFyZ2luUmlnaHQ9Yy5zdHlsZS53aWR0aD1cIjBcIixmLnN0eWxlLndpZHRoPVwiMXB4XCIsZC5hcHBlbmRDaGlsZChlKSxiPSFwYXJzZUZsb2F0KGEuZ2V0Q29tcHV0ZWRTdHlsZShjLG51bGwpLm1hcmdpblJpZ2h0KSxkLnJlbW92ZUNoaWxkKGUpLGYucmVtb3ZlQ2hpbGQoYyksYn19KX19KCksbi5zd2FwPWZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlLGYsZz17fTtmb3IoZiBpbiBiKWdbZl09YS5zdHlsZVtmXSxhLnN0eWxlW2ZdPWJbZl07ZT1jLmFwcGx5KGEsZHx8W10pO2ZvcihmIGluIGIpYS5zdHlsZVtmXT1nW2ZdO3JldHVybiBlfTt2YXIgemI9L14obm9uZXx0YWJsZSg/IS1jW2VhXSkuKykvLEFiPW5ldyBSZWdFeHAoXCJeKFwiK1ErXCIpKC4qKSRcIixcImlcIiksQmI9bmV3IFJlZ0V4cChcIl4oWystXSk9KFwiK1ErXCIpXCIsXCJpXCIpLENiPXtwb3NpdGlvbjpcImFic29sdXRlXCIsdmlzaWJpbGl0eTpcImhpZGRlblwiLGRpc3BsYXk6XCJibG9ja1wifSxEYj17bGV0dGVyU3BhY2luZzpcIjBcIixmb250V2VpZ2h0OlwiNDAwXCJ9LEViPVtcIldlYmtpdFwiLFwiT1wiLFwiTW96XCIsXCJtc1wiXTtmdW5jdGlvbiBGYihhLGIpe2lmKGIgaW4gYSlyZXR1cm4gYjt2YXIgYz1iWzBdLnRvVXBwZXJDYXNlKCkrYi5zbGljZSgxKSxkPWIsZT1FYi5sZW5ndGg7d2hpbGUoZS0tKWlmKGI9RWJbZV0rYyxiIGluIGEpcmV0dXJuIGI7cmV0dXJuIGR9ZnVuY3Rpb24gR2IoYSxiLGMpe3ZhciBkPUFiLmV4ZWMoYik7cmV0dXJuIGQ/TWF0aC5tYXgoMCxkWzFdLShjfHwwKSkrKGRbMl18fFwicHhcIik6Yn1mdW5jdGlvbiBIYihhLGIsYyxkLGUpe2Zvcih2YXIgZj1jPT09KGQ/XCJib3JkZXJcIjpcImNvbnRlbnRcIik/NDpcIndpZHRoXCI9PT1iPzE6MCxnPTA7ND5mO2YrPTIpXCJtYXJnaW5cIj09PWMmJihnKz1uLmNzcyhhLGMrUltmXSwhMCxlKSksZD8oXCJjb250ZW50XCI9PT1jJiYoZy09bi5jc3MoYSxcInBhZGRpbmdcIitSW2ZdLCEwLGUpKSxcIm1hcmdpblwiIT09YyYmKGctPW4uY3NzKGEsXCJib3JkZXJcIitSW2ZdK1wiV2lkdGhcIiwhMCxlKSkpOihnKz1uLmNzcyhhLFwicGFkZGluZ1wiK1JbZl0sITAsZSksXCJwYWRkaW5nXCIhPT1jJiYoZys9bi5jc3MoYSxcImJvcmRlclwiK1JbZl0rXCJXaWR0aFwiLCEwLGUpKSk7cmV0dXJuIGd9ZnVuY3Rpb24gSWIoYSxiLGMpe3ZhciBkPSEwLGU9XCJ3aWR0aFwiPT09Yj9hLm9mZnNldFdpZHRoOmEub2Zmc2V0SGVpZ2h0LGY9d2IoYSksZz1cImJvcmRlci1ib3hcIj09PW4uY3NzKGEsXCJib3hTaXppbmdcIiwhMSxmKTtpZigwPj1lfHxudWxsPT1lKXtpZihlPXhiKGEsYixmKSwoMD5lfHxudWxsPT1lKSYmKGU9YS5zdHlsZVtiXSksdmIudGVzdChlKSlyZXR1cm4gZTtkPWcmJihrLmJveFNpemluZ1JlbGlhYmxlKCl8fGU9PT1hLnN0eWxlW2JdKSxlPXBhcnNlRmxvYXQoZSl8fDB9cmV0dXJuIGUrSGIoYSxiLGN8fChnP1wiYm9yZGVyXCI6XCJjb250ZW50XCIpLGQsZikrXCJweFwifWZ1bmN0aW9uIEpiKGEsYil7Zm9yKHZhciBjLGQsZSxmPVtdLGc9MCxoPWEubGVuZ3RoO2g+ZztnKyspZD1hW2ddLGQuc3R5bGUmJihmW2ddPUwuZ2V0KGQsXCJvbGRkaXNwbGF5XCIpLGM9ZC5zdHlsZS5kaXNwbGF5LGI/KGZbZ118fFwibm9uZVwiIT09Y3x8KGQuc3R5bGUuZGlzcGxheT1cIlwiKSxcIlwiPT09ZC5zdHlsZS5kaXNwbGF5JiZTKGQpJiYoZltnXT1MLmFjY2VzcyhkLFwib2xkZGlzcGxheVwiLHRiKGQubm9kZU5hbWUpKSkpOihlPVMoZCksXCJub25lXCI9PT1jJiZlfHxMLnNldChkLFwib2xkZGlzcGxheVwiLGU/YzpuLmNzcyhkLFwiZGlzcGxheVwiKSkpKTtmb3IoZz0wO2g+ZztnKyspZD1hW2ddLGQuc3R5bGUmJihiJiZcIm5vbmVcIiE9PWQuc3R5bGUuZGlzcGxheSYmXCJcIiE9PWQuc3R5bGUuZGlzcGxheXx8KGQuc3R5bGUuZGlzcGxheT1iP2ZbZ118fFwiXCI6XCJub25lXCIpKTtyZXR1cm4gYX1uLmV4dGVuZCh7Y3NzSG9va3M6e29wYWNpdHk6e2dldDpmdW5jdGlvbihhLGIpe2lmKGIpe3ZhciBjPXhiKGEsXCJvcGFjaXR5XCIpO3JldHVyblwiXCI9PT1jP1wiMVwiOmN9fX19LGNzc051bWJlcjp7Y29sdW1uQ291bnQ6ITAsZmlsbE9wYWNpdHk6ITAsZmxleEdyb3c6ITAsZmxleFNocmluazohMCxmb250V2VpZ2h0OiEwLGxpbmVIZWlnaHQ6ITAsb3BhY2l0eTohMCxvcmRlcjohMCxvcnBoYW5zOiEwLHdpZG93czohMCx6SW5kZXg6ITAsem9vbTohMH0sY3NzUHJvcHM6e1wiZmxvYXRcIjpcImNzc0Zsb2F0XCJ9LHN0eWxlOmZ1bmN0aW9uKGEsYixjLGQpe2lmKGEmJjMhPT1hLm5vZGVUeXBlJiY4IT09YS5ub2RlVHlwZSYmYS5zdHlsZSl7dmFyIGUsZixnLGg9bi5jYW1lbENhc2UoYiksaT1hLnN0eWxlO3JldHVybiBiPW4uY3NzUHJvcHNbaF18fChuLmNzc1Byb3BzW2hdPUZiKGksaCkpLGc9bi5jc3NIb29rc1tiXXx8bi5jc3NIb29rc1toXSx2b2lkIDA9PT1jP2cmJlwiZ2V0XCJpbiBnJiZ2b2lkIDAhPT0oZT1nLmdldChhLCExLGQpKT9lOmlbYl06KGY9dHlwZW9mIGMsXCJzdHJpbmdcIj09PWYmJihlPUJiLmV4ZWMoYykpJiYoYz0oZVsxXSsxKSplWzJdK3BhcnNlRmxvYXQobi5jc3MoYSxiKSksZj1cIm51bWJlclwiKSxudWxsIT1jJiZjPT09YyYmKFwibnVtYmVyXCIhPT1mfHxuLmNzc051bWJlcltoXXx8KGMrPVwicHhcIiksay5jbGVhckNsb25lU3R5bGV8fFwiXCIhPT1jfHwwIT09Yi5pbmRleE9mKFwiYmFja2dyb3VuZFwiKXx8KGlbYl09XCJpbmhlcml0XCIpLGcmJlwic2V0XCJpbiBnJiZ2b2lkIDA9PT0oYz1nLnNldChhLGMsZCkpfHwoaVtiXT1jKSksdm9pZCAwKX19LGNzczpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZSxmLGcsaD1uLmNhbWVsQ2FzZShiKTtyZXR1cm4gYj1uLmNzc1Byb3BzW2hdfHwobi5jc3NQcm9wc1toXT1GYihhLnN0eWxlLGgpKSxnPW4uY3NzSG9va3NbYl18fG4uY3NzSG9va3NbaF0sZyYmXCJnZXRcImluIGcmJihlPWcuZ2V0KGEsITAsYykpLHZvaWQgMD09PWUmJihlPXhiKGEsYixkKSksXCJub3JtYWxcIj09PWUmJmIgaW4gRGImJihlPURiW2JdKSxcIlwiPT09Y3x8Yz8oZj1wYXJzZUZsb2F0KGUpLGM9PT0hMHx8bi5pc051bWVyaWMoZik/Znx8MDplKTplfX0pLG4uZWFjaChbXCJoZWlnaHRcIixcIndpZHRoXCJdLGZ1bmN0aW9uKGEsYil7bi5jc3NIb29rc1tiXT17Z2V0OmZ1bmN0aW9uKGEsYyxkKXtyZXR1cm4gYz96Yi50ZXN0KG4uY3NzKGEsXCJkaXNwbGF5XCIpKSYmMD09PWEub2Zmc2V0V2lkdGg/bi5zd2FwKGEsQ2IsZnVuY3Rpb24oKXtyZXR1cm4gSWIoYSxiLGQpfSk6SWIoYSxiLGQpOnZvaWQgMH0sc2V0OmZ1bmN0aW9uKGEsYyxkKXt2YXIgZT1kJiZ3YihhKTtyZXR1cm4gR2IoYSxjLGQ/SGIoYSxiLGQsXCJib3JkZXItYm94XCI9PT1uLmNzcyhhLFwiYm94U2l6aW5nXCIsITEsZSksZSk6MCl9fX0pLG4uY3NzSG9va3MubWFyZ2luUmlnaHQ9eWIoay5yZWxpYWJsZU1hcmdpblJpZ2h0LGZ1bmN0aW9uKGEsYil7cmV0dXJuIGI/bi5zd2FwKGEse2Rpc3BsYXk6XCJpbmxpbmUtYmxvY2tcIn0seGIsW2EsXCJtYXJnaW5SaWdodFwiXSk6dm9pZCAwfSksbi5lYWNoKHttYXJnaW46XCJcIixwYWRkaW5nOlwiXCIsYm9yZGVyOlwiV2lkdGhcIn0sZnVuY3Rpb24oYSxiKXtuLmNzc0hvb2tzW2ErYl09e2V4cGFuZDpmdW5jdGlvbihjKXtmb3IodmFyIGQ9MCxlPXt9LGY9XCJzdHJpbmdcIj09dHlwZW9mIGM/Yy5zcGxpdChcIiBcIik6W2NdOzQ+ZDtkKyspZVthK1JbZF0rYl09ZltkXXx8ZltkLTJdfHxmWzBdO3JldHVybiBlfX0sdWIudGVzdChhKXx8KG4uY3NzSG9va3NbYStiXS5zZXQ9R2IpfSksbi5mbi5leHRlbmQoe2NzczpmdW5jdGlvbihhLGIpe3JldHVybiBKKHRoaXMsZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZj17fSxnPTA7aWYobi5pc0FycmF5KGIpKXtmb3IoZD13YihhKSxlPWIubGVuZ3RoO2U+ZztnKyspZltiW2ddXT1uLmNzcyhhLGJbZ10sITEsZCk7cmV0dXJuIGZ9cmV0dXJuIHZvaWQgMCE9PWM/bi5zdHlsZShhLGIsYyk6bi5jc3MoYSxiKX0sYSxiLGFyZ3VtZW50cy5sZW5ndGg+MSl9LHNob3c6ZnVuY3Rpb24oKXtyZXR1cm4gSmIodGhpcywhMCl9LGhpZGU6ZnVuY3Rpb24oKXtyZXR1cm4gSmIodGhpcyl9LHRvZ2dsZTpmdW5jdGlvbihhKXtyZXR1cm5cImJvb2xlYW5cIj09dHlwZW9mIGE/YT90aGlzLnNob3coKTp0aGlzLmhpZGUoKTp0aGlzLmVhY2goZnVuY3Rpb24oKXtTKHRoaXMpP24odGhpcykuc2hvdygpOm4odGhpcykuaGlkZSgpfSl9fSk7ZnVuY3Rpb24gS2IoYSxiLGMsZCxlKXtyZXR1cm4gbmV3IEtiLnByb3RvdHlwZS5pbml0KGEsYixjLGQsZSl9bi5Ud2Vlbj1LYixLYi5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOktiLGluaXQ6ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe3RoaXMuZWxlbT1hLHRoaXMucHJvcD1jLHRoaXMuZWFzaW5nPWV8fFwic3dpbmdcIix0aGlzLm9wdGlvbnM9Yix0aGlzLnN0YXJ0PXRoaXMubm93PXRoaXMuY3VyKCksdGhpcy5lbmQ9ZCx0aGlzLnVuaXQ9Znx8KG4uY3NzTnVtYmVyW2NdP1wiXCI6XCJweFwiKX0sY3VyOmZ1bmN0aW9uKCl7dmFyIGE9S2IucHJvcEhvb2tzW3RoaXMucHJvcF07cmV0dXJuIGEmJmEuZ2V0P2EuZ2V0KHRoaXMpOktiLnByb3BIb29rcy5fZGVmYXVsdC5nZXQodGhpcyl9LHJ1bjpmdW5jdGlvbihhKXt2YXIgYixjPUtiLnByb3BIb29rc1t0aGlzLnByb3BdO3JldHVybiB0aGlzLnBvcz1iPXRoaXMub3B0aW9ucy5kdXJhdGlvbj9uLmVhc2luZ1t0aGlzLmVhc2luZ10oYSx0aGlzLm9wdGlvbnMuZHVyYXRpb24qYSwwLDEsdGhpcy5vcHRpb25zLmR1cmF0aW9uKTphLHRoaXMubm93PSh0aGlzLmVuZC10aGlzLnN0YXJ0KSpiK3RoaXMuc3RhcnQsdGhpcy5vcHRpb25zLnN0ZXAmJnRoaXMub3B0aW9ucy5zdGVwLmNhbGwodGhpcy5lbGVtLHRoaXMubm93LHRoaXMpLGMmJmMuc2V0P2Muc2V0KHRoaXMpOktiLnByb3BIb29rcy5fZGVmYXVsdC5zZXQodGhpcyksdGhpc319LEtiLnByb3RvdHlwZS5pbml0LnByb3RvdHlwZT1LYi5wcm90b3R5cGUsS2IucHJvcEhvb2tzPXtfZGVmYXVsdDp7Z2V0OmZ1bmN0aW9uKGEpe3ZhciBiO3JldHVybiBudWxsPT1hLmVsZW1bYS5wcm9wXXx8YS5lbGVtLnN0eWxlJiZudWxsIT1hLmVsZW0uc3R5bGVbYS5wcm9wXT8oYj1uLmNzcyhhLmVsZW0sYS5wcm9wLFwiXCIpLGImJlwiYXV0b1wiIT09Yj9iOjApOmEuZWxlbVthLnByb3BdfSxzZXQ6ZnVuY3Rpb24oYSl7bi5meC5zdGVwW2EucHJvcF0/bi5meC5zdGVwW2EucHJvcF0oYSk6YS5lbGVtLnN0eWxlJiYobnVsbCE9YS5lbGVtLnN0eWxlW24uY3NzUHJvcHNbYS5wcm9wXV18fG4uY3NzSG9va3NbYS5wcm9wXSk/bi5zdHlsZShhLmVsZW0sYS5wcm9wLGEubm93K2EudW5pdCk6YS5lbGVtW2EucHJvcF09YS5ub3d9fX0sS2IucHJvcEhvb2tzLnNjcm9sbFRvcD1LYi5wcm9wSG9va3Muc2Nyb2xsTGVmdD17c2V0OmZ1bmN0aW9uKGEpe2EuZWxlbS5ub2RlVHlwZSYmYS5lbGVtLnBhcmVudE5vZGUmJihhLmVsZW1bYS5wcm9wXT1hLm5vdyl9fSxuLmVhc2luZz17bGluZWFyOmZ1bmN0aW9uKGEpe3JldHVybiBhfSxzd2luZzpmdW5jdGlvbihhKXtyZXR1cm4uNS1NYXRoLmNvcyhhKk1hdGguUEkpLzJ9fSxuLmZ4PUtiLnByb3RvdHlwZS5pbml0LG4uZnguc3RlcD17fTt2YXIgTGIsTWIsTmI9L14oPzp0b2dnbGV8c2hvd3xoaWRlKSQvLE9iPW5ldyBSZWdFeHAoXCJeKD86KFsrLV0pPXwpKFwiK1ErXCIpKFthLXolXSopJFwiLFwiaVwiKSxQYj0vcXVldWVIb29rcyQvLFFiPVtWYl0sUmI9e1wiKlwiOltmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuY3JlYXRlVHdlZW4oYSxiKSxkPWMuY3VyKCksZT1PYi5leGVjKGIpLGY9ZSYmZVszXXx8KG4uY3NzTnVtYmVyW2FdP1wiXCI6XCJweFwiKSxnPShuLmNzc051bWJlclthXXx8XCJweFwiIT09ZiYmK2QpJiZPYi5leGVjKG4uY3NzKGMuZWxlbSxhKSksaD0xLGk9MjA7aWYoZyYmZ1szXSE9PWYpe2Y9Znx8Z1szXSxlPWV8fFtdLGc9K2R8fDE7ZG8gaD1ofHxcIi41XCIsZy89aCxuLnN0eWxlKGMuZWxlbSxhLGcrZik7d2hpbGUoaCE9PShoPWMuY3VyKCkvZCkmJjEhPT1oJiYtLWkpfXJldHVybiBlJiYoZz1jLnN0YXJ0PStnfHwrZHx8MCxjLnVuaXQ9ZixjLmVuZD1lWzFdP2crKGVbMV0rMSkqZVsyXTorZVsyXSksY31dfTtmdW5jdGlvbiBTYigpe3JldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7TGI9dm9pZCAwfSksTGI9bi5ub3coKX1mdW5jdGlvbiBUYihhLGIpe3ZhciBjLGQ9MCxlPXtoZWlnaHQ6YX07Zm9yKGI9Yj8xOjA7ND5kO2QrPTItYiljPVJbZF0sZVtcIm1hcmdpblwiK2NdPWVbXCJwYWRkaW5nXCIrY109YTtyZXR1cm4gYiYmKGUub3BhY2l0eT1lLndpZHRoPWEpLGV9ZnVuY3Rpb24gVWIoYSxiLGMpe2Zvcih2YXIgZCxlPShSYltiXXx8W10pLmNvbmNhdChSYltcIipcIl0pLGY9MCxnPWUubGVuZ3RoO2c+ZjtmKyspaWYoZD1lW2ZdLmNhbGwoYyxiLGEpKXJldHVybiBkfWZ1bmN0aW9uIFZiKGEsYixjKXt2YXIgZCxlLGYsZyxoLGksaixrLGw9dGhpcyxtPXt9LG89YS5zdHlsZSxwPWEubm9kZVR5cGUmJlMoYSkscT1MLmdldChhLFwiZnhzaG93XCIpO2MucXVldWV8fChoPW4uX3F1ZXVlSG9va3MoYSxcImZ4XCIpLG51bGw9PWgudW5xdWV1ZWQmJihoLnVucXVldWVkPTAsaT1oLmVtcHR5LmZpcmUsaC5lbXB0eS5maXJlPWZ1bmN0aW9uKCl7aC51bnF1ZXVlZHx8aSgpfSksaC51bnF1ZXVlZCsrLGwuYWx3YXlzKGZ1bmN0aW9uKCl7bC5hbHdheXMoZnVuY3Rpb24oKXtoLnVucXVldWVkLS0sbi5xdWV1ZShhLFwiZnhcIikubGVuZ3RofHxoLmVtcHR5LmZpcmUoKX0pfSkpLDE9PT1hLm5vZGVUeXBlJiYoXCJoZWlnaHRcImluIGJ8fFwid2lkdGhcImluIGIpJiYoYy5vdmVyZmxvdz1bby5vdmVyZmxvdyxvLm92ZXJmbG93WCxvLm92ZXJmbG93WV0saj1uLmNzcyhhLFwiZGlzcGxheVwiKSxrPVwibm9uZVwiPT09aj9MLmdldChhLFwib2xkZGlzcGxheVwiKXx8dGIoYS5ub2RlTmFtZSk6aixcImlubGluZVwiPT09ayYmXCJub25lXCI9PT1uLmNzcyhhLFwiZmxvYXRcIikmJihvLmRpc3BsYXk9XCJpbmxpbmUtYmxvY2tcIikpLGMub3ZlcmZsb3cmJihvLm92ZXJmbG93PVwiaGlkZGVuXCIsbC5hbHdheXMoZnVuY3Rpb24oKXtvLm92ZXJmbG93PWMub3ZlcmZsb3dbMF0sby5vdmVyZmxvd1g9Yy5vdmVyZmxvd1sxXSxvLm92ZXJmbG93WT1jLm92ZXJmbG93WzJdfSkpO2ZvcihkIGluIGIpaWYoZT1iW2RdLE5iLmV4ZWMoZSkpe2lmKGRlbGV0ZSBiW2RdLGY9Znx8XCJ0b2dnbGVcIj09PWUsZT09PShwP1wiaGlkZVwiOlwic2hvd1wiKSl7aWYoXCJzaG93XCIhPT1lfHwhcXx8dm9pZCAwPT09cVtkXSljb250aW51ZTtwPSEwfW1bZF09cSYmcVtkXXx8bi5zdHlsZShhLGQpfWVsc2Ugaj12b2lkIDA7aWYobi5pc0VtcHR5T2JqZWN0KG0pKVwiaW5saW5lXCI9PT0oXCJub25lXCI9PT1qP3RiKGEubm9kZU5hbWUpOmopJiYoby5kaXNwbGF5PWopO2Vsc2V7cT9cImhpZGRlblwiaW4gcSYmKHA9cS5oaWRkZW4pOnE9TC5hY2Nlc3MoYSxcImZ4c2hvd1wiLHt9KSxmJiYocS5oaWRkZW49IXApLHA/bihhKS5zaG93KCk6bC5kb25lKGZ1bmN0aW9uKCl7bihhKS5oaWRlKCl9KSxsLmRvbmUoZnVuY3Rpb24oKXt2YXIgYjtMLnJlbW92ZShhLFwiZnhzaG93XCIpO2ZvcihiIGluIG0pbi5zdHlsZShhLGIsbVtiXSl9KTtmb3IoZCBpbiBtKWc9VWIocD9xW2RdOjAsZCxsKSxkIGluIHF8fChxW2RdPWcuc3RhcnQscCYmKGcuZW5kPWcuc3RhcnQsZy5zdGFydD1cIndpZHRoXCI9PT1kfHxcImhlaWdodFwiPT09ZD8xOjApKX19ZnVuY3Rpb24gV2IoYSxiKXt2YXIgYyxkLGUsZixnO2ZvcihjIGluIGEpaWYoZD1uLmNhbWVsQ2FzZShjKSxlPWJbZF0sZj1hW2NdLG4uaXNBcnJheShmKSYmKGU9ZlsxXSxmPWFbY109ZlswXSksYyE9PWQmJihhW2RdPWYsZGVsZXRlIGFbY10pLGc9bi5jc3NIb29rc1tkXSxnJiZcImV4cGFuZFwiaW4gZyl7Zj1nLmV4cGFuZChmKSxkZWxldGUgYVtkXTtmb3IoYyBpbiBmKWMgaW4gYXx8KGFbY109ZltjXSxiW2NdPWUpfWVsc2UgYltkXT1lfWZ1bmN0aW9uIFhiKGEsYixjKXt2YXIgZCxlLGY9MCxnPVFiLmxlbmd0aCxoPW4uRGVmZXJyZWQoKS5hbHdheXMoZnVuY3Rpb24oKXtkZWxldGUgaS5lbGVtfSksaT1mdW5jdGlvbigpe2lmKGUpcmV0dXJuITE7Zm9yKHZhciBiPUxifHxTYigpLGM9TWF0aC5tYXgoMCxqLnN0YXJ0VGltZStqLmR1cmF0aW9uLWIpLGQ9Yy9qLmR1cmF0aW9ufHwwLGY9MS1kLGc9MCxpPWoudHdlZW5zLmxlbmd0aDtpPmc7ZysrKWoudHdlZW5zW2ddLnJ1bihmKTtyZXR1cm4gaC5ub3RpZnlXaXRoKGEsW2osZixjXSksMT5mJiZpP2M6KGgucmVzb2x2ZVdpdGgoYSxbal0pLCExKX0saj1oLnByb21pc2Uoe2VsZW06YSxwcm9wczpuLmV4dGVuZCh7fSxiKSxvcHRzOm4uZXh0ZW5kKCEwLHtzcGVjaWFsRWFzaW5nOnt9fSxjKSxvcmlnaW5hbFByb3BlcnRpZXM6YixvcmlnaW5hbE9wdGlvbnM6YyxzdGFydFRpbWU6TGJ8fFNiKCksZHVyYXRpb246Yy5kdXJhdGlvbix0d2VlbnM6W10sY3JlYXRlVHdlZW46ZnVuY3Rpb24oYixjKXt2YXIgZD1uLlR3ZWVuKGEsai5vcHRzLGIsYyxqLm9wdHMuc3BlY2lhbEVhc2luZ1tiXXx8ai5vcHRzLmVhc2luZyk7cmV0dXJuIGoudHdlZW5zLnB1c2goZCksZH0sc3RvcDpmdW5jdGlvbihiKXt2YXIgYz0wLGQ9Yj9qLnR3ZWVucy5sZW5ndGg6MDtpZihlKXJldHVybiB0aGlzO2ZvcihlPSEwO2Q+YztjKyspai50d2VlbnNbY10ucnVuKDEpO3JldHVybiBiP2gucmVzb2x2ZVdpdGgoYSxbaixiXSk6aC5yZWplY3RXaXRoKGEsW2osYl0pLHRoaXN9fSksaz1qLnByb3BzO2ZvcihXYihrLGoub3B0cy5zcGVjaWFsRWFzaW5nKTtnPmY7ZisrKWlmKGQ9UWJbZl0uY2FsbChqLGEsayxqLm9wdHMpKXJldHVybiBkO3JldHVybiBuLm1hcChrLFViLGopLG4uaXNGdW5jdGlvbihqLm9wdHMuc3RhcnQpJiZqLm9wdHMuc3RhcnQuY2FsbChhLGopLG4uZngudGltZXIobi5leHRlbmQoaSx7ZWxlbTphLGFuaW06aixxdWV1ZTpqLm9wdHMucXVldWV9KSksai5wcm9ncmVzcyhqLm9wdHMucHJvZ3Jlc3MpLmRvbmUoai5vcHRzLmRvbmUsai5vcHRzLmNvbXBsZXRlKS5mYWlsKGoub3B0cy5mYWlsKS5hbHdheXMoai5vcHRzLmFsd2F5cyl9bi5BbmltYXRpb249bi5leHRlbmQoWGIse3R3ZWVuZXI6ZnVuY3Rpb24oYSxiKXtuLmlzRnVuY3Rpb24oYSk/KGI9YSxhPVtcIipcIl0pOmE9YS5zcGxpdChcIiBcIik7Zm9yKHZhciBjLGQ9MCxlPWEubGVuZ3RoO2U+ZDtkKyspYz1hW2RdLFJiW2NdPVJiW2NdfHxbXSxSYltjXS51bnNoaWZ0KGIpfSxwcmVmaWx0ZXI6ZnVuY3Rpb24oYSxiKXtiP1FiLnVuc2hpZnQoYSk6UWIucHVzaChhKX19KSxuLnNwZWVkPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1hJiZcIm9iamVjdFwiPT10eXBlb2YgYT9uLmV4dGVuZCh7fSxhKTp7Y29tcGxldGU6Y3x8IWMmJmJ8fG4uaXNGdW5jdGlvbihhKSYmYSxkdXJhdGlvbjphLGVhc2luZzpjJiZifHxiJiYhbi5pc0Z1bmN0aW9uKGIpJiZifTtyZXR1cm4gZC5kdXJhdGlvbj1uLmZ4Lm9mZj8wOlwibnVtYmVyXCI9PXR5cGVvZiBkLmR1cmF0aW9uP2QuZHVyYXRpb246ZC5kdXJhdGlvbiBpbiBuLmZ4LnNwZWVkcz9uLmZ4LnNwZWVkc1tkLmR1cmF0aW9uXTpuLmZ4LnNwZWVkcy5fZGVmYXVsdCwobnVsbD09ZC5xdWV1ZXx8ZC5xdWV1ZT09PSEwKSYmKGQucXVldWU9XCJmeFwiKSxkLm9sZD1kLmNvbXBsZXRlLGQuY29tcGxldGU9ZnVuY3Rpb24oKXtuLmlzRnVuY3Rpb24oZC5vbGQpJiZkLm9sZC5jYWxsKHRoaXMpLGQucXVldWUmJm4uZGVxdWV1ZSh0aGlzLGQucXVldWUpfSxkfSxuLmZuLmV4dGVuZCh7ZmFkZVRvOmZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLmZpbHRlcihTKS5jc3MoXCJvcGFjaXR5XCIsMCkuc2hvdygpLmVuZCgpLmFuaW1hdGUoe29wYWNpdHk6Yn0sYSxjLGQpfSxhbmltYXRlOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPW4uaXNFbXB0eU9iamVjdChhKSxmPW4uc3BlZWQoYixjLGQpLGc9ZnVuY3Rpb24oKXt2YXIgYj1YYih0aGlzLG4uZXh0ZW5kKHt9LGEpLGYpOyhlfHxMLmdldCh0aGlzLFwiZmluaXNoXCIpKSYmYi5zdG9wKCEwKX07cmV0dXJuIGcuZmluaXNoPWcsZXx8Zi5xdWV1ZT09PSExP3RoaXMuZWFjaChnKTp0aGlzLnF1ZXVlKGYucXVldWUsZyl9LHN0b3A6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWZ1bmN0aW9uKGEpe3ZhciBiPWEuc3RvcDtkZWxldGUgYS5zdG9wLGIoYyl9O3JldHVyblwic3RyaW5nXCIhPXR5cGVvZiBhJiYoYz1iLGI9YSxhPXZvaWQgMCksYiYmYSE9PSExJiZ0aGlzLnF1ZXVlKGF8fFwiZnhcIixbXSksdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGI9ITAsZT1udWxsIT1hJiZhK1wicXVldWVIb29rc1wiLGY9bi50aW1lcnMsZz1MLmdldCh0aGlzKTtpZihlKWdbZV0mJmdbZV0uc3RvcCYmZChnW2VdKTtlbHNlIGZvcihlIGluIGcpZ1tlXSYmZ1tlXS5zdG9wJiZQYi50ZXN0KGUpJiZkKGdbZV0pO2ZvcihlPWYubGVuZ3RoO2UtLTspZltlXS5lbGVtIT09dGhpc3x8bnVsbCE9YSYmZltlXS5xdWV1ZSE9PWF8fChmW2VdLmFuaW0uc3RvcChjKSxiPSExLGYuc3BsaWNlKGUsMSkpOyhifHwhYykmJm4uZGVxdWV1ZSh0aGlzLGEpfSl9LGZpbmlzaDpmdW5jdGlvbihhKXtyZXR1cm4gYSE9PSExJiYoYT1hfHxcImZ4XCIpLHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBiLGM9TC5nZXQodGhpcyksZD1jW2ErXCJxdWV1ZVwiXSxlPWNbYStcInF1ZXVlSG9va3NcIl0sZj1uLnRpbWVycyxnPWQ/ZC5sZW5ndGg6MDtmb3IoYy5maW5pc2g9ITAsbi5xdWV1ZSh0aGlzLGEsW10pLGUmJmUuc3RvcCYmZS5zdG9wLmNhbGwodGhpcywhMCksYj1mLmxlbmd0aDtiLS07KWZbYl0uZWxlbT09PXRoaXMmJmZbYl0ucXVldWU9PT1hJiYoZltiXS5hbmltLnN0b3AoITApLGYuc3BsaWNlKGIsMSkpO2ZvcihiPTA7Zz5iO2IrKylkW2JdJiZkW2JdLmZpbmlzaCYmZFtiXS5maW5pc2guY2FsbCh0aGlzKTtkZWxldGUgYy5maW5pc2h9KX19KSxuLmVhY2goW1widG9nZ2xlXCIsXCJzaG93XCIsXCJoaWRlXCJdLGZ1bmN0aW9uKGEsYil7dmFyIGM9bi5mbltiXTtuLmZuW2JdPWZ1bmN0aW9uKGEsZCxlKXtyZXR1cm4gbnVsbD09YXx8XCJib29sZWFuXCI9PXR5cGVvZiBhP2MuYXBwbHkodGhpcyxhcmd1bWVudHMpOnRoaXMuYW5pbWF0ZShUYihiLCEwKSxhLGQsZSl9fSksbi5lYWNoKHtzbGlkZURvd246VGIoXCJzaG93XCIpLHNsaWRlVXA6VGIoXCJoaWRlXCIpLHNsaWRlVG9nZ2xlOlRiKFwidG9nZ2xlXCIpLGZhZGVJbjp7b3BhY2l0eTpcInNob3dcIn0sZmFkZU91dDp7b3BhY2l0eTpcImhpZGVcIn0sZmFkZVRvZ2dsZTp7b3BhY2l0eTpcInRvZ2dsZVwifX0sZnVuY3Rpb24oYSxiKXtuLmZuW2FdPWZ1bmN0aW9uKGEsYyxkKXtyZXR1cm4gdGhpcy5hbmltYXRlKGIsYSxjLGQpfX0pLG4udGltZXJzPVtdLG4uZngudGljaz1mdW5jdGlvbigpe3ZhciBhLGI9MCxjPW4udGltZXJzO2ZvcihMYj1uLm5vdygpO2I8Yy5sZW5ndGg7YisrKWE9Y1tiXSxhKCl8fGNbYl0hPT1hfHxjLnNwbGljZShiLS0sMSk7Yy5sZW5ndGh8fG4uZnguc3RvcCgpLExiPXZvaWQgMH0sbi5meC50aW1lcj1mdW5jdGlvbihhKXtuLnRpbWVycy5wdXNoKGEpLGEoKT9uLmZ4LnN0YXJ0KCk6bi50aW1lcnMucG9wKCl9LG4uZnguaW50ZXJ2YWw9MTMsbi5meC5zdGFydD1mdW5jdGlvbigpe01ifHwoTWI9c2V0SW50ZXJ2YWwobi5meC50aWNrLG4uZnguaW50ZXJ2YWwpKX0sbi5meC5zdG9wPWZ1bmN0aW9uKCl7Y2xlYXJJbnRlcnZhbChNYiksTWI9bnVsbH0sbi5meC5zcGVlZHM9e3Nsb3c6NjAwLGZhc3Q6MjAwLF9kZWZhdWx0OjQwMH0sbi5mbi5kZWxheT1mdW5jdGlvbihhLGIpe3JldHVybiBhPW4uZng/bi5meC5zcGVlZHNbYV18fGE6YSxiPWJ8fFwiZnhcIix0aGlzLnF1ZXVlKGIsZnVuY3Rpb24oYixjKXt2YXIgZD1zZXRUaW1lb3V0KGIsYSk7Yy5zdG9wPWZ1bmN0aW9uKCl7Y2xlYXJUaW1lb3V0KGQpfX0pfSxmdW5jdGlvbigpe3ZhciBhPWwuY3JlYXRlRWxlbWVudChcImlucHV0XCIpLGI9bC5jcmVhdGVFbGVtZW50KFwic2VsZWN0XCIpLGM9Yi5hcHBlbmRDaGlsZChsLmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIikpO2EudHlwZT1cImNoZWNrYm94XCIsay5jaGVja09uPVwiXCIhPT1hLnZhbHVlLGsub3B0U2VsZWN0ZWQ9Yy5zZWxlY3RlZCxiLmRpc2FibGVkPSEwLGsub3B0RGlzYWJsZWQ9IWMuZGlzYWJsZWQsYT1sLmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKSxhLnZhbHVlPVwidFwiLGEudHlwZT1cInJhZGlvXCIsay5yYWRpb1ZhbHVlPVwidFwiPT09YS52YWx1ZX0oKTt2YXIgWWIsWmIsJGI9bi5leHByLmF0dHJIYW5kbGU7bi5mbi5leHRlbmQoe2F0dHI6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gSih0aGlzLG4uYXR0cixhLGIsYXJndW1lbnRzLmxlbmd0aD4xKX0scmVtb3ZlQXR0cjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7bi5yZW1vdmVBdHRyKHRoaXMsYSl9KX19KSxuLmV4dGVuZCh7YXR0cjpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZSxmPWEubm9kZVR5cGU7aWYoYSYmMyE9PWYmJjghPT1mJiYyIT09ZilyZXR1cm4gdHlwZW9mIGEuZ2V0QXR0cmlidXRlPT09VT9uLnByb3AoYSxiLGMpOigxPT09ZiYmbi5pc1hNTERvYyhhKXx8KGI9Yi50b0xvd2VyQ2FzZSgpLGQ9bi5hdHRySG9va3NbYl18fChuLmV4cHIubWF0Y2guYm9vbC50ZXN0KGIpP1piOlliKSksdm9pZCAwPT09Yz9kJiZcImdldFwiaW4gZCYmbnVsbCE9PShlPWQuZ2V0KGEsYikpP2U6KGU9bi5maW5kLmF0dHIoYSxiKSxudWxsPT1lP3ZvaWQgMDplKTpudWxsIT09Yz9kJiZcInNldFwiaW4gZCYmdm9pZCAwIT09KGU9ZC5zZXQoYSxjLGIpKT9lOihhLnNldEF0dHJpYnV0ZShiLGMrXCJcIiksYyk6dm9pZCBuLnJlbW92ZUF0dHIoYSxiKSlcbn0scmVtb3ZlQXR0cjpmdW5jdGlvbihhLGIpe3ZhciBjLGQsZT0wLGY9YiYmYi5tYXRjaChFKTtpZihmJiYxPT09YS5ub2RlVHlwZSl3aGlsZShjPWZbZSsrXSlkPW4ucHJvcEZpeFtjXXx8YyxuLmV4cHIubWF0Y2guYm9vbC50ZXN0KGMpJiYoYVtkXT0hMSksYS5yZW1vdmVBdHRyaWJ1dGUoYyl9LGF0dHJIb29rczp7dHlwZTp7c2V0OmZ1bmN0aW9uKGEsYil7aWYoIWsucmFkaW9WYWx1ZSYmXCJyYWRpb1wiPT09YiYmbi5ub2RlTmFtZShhLFwiaW5wdXRcIikpe3ZhciBjPWEudmFsdWU7cmV0dXJuIGEuc2V0QXR0cmlidXRlKFwidHlwZVwiLGIpLGMmJihhLnZhbHVlPWMpLGJ9fX19fSksWmI9e3NldDpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIGI9PT0hMT9uLnJlbW92ZUF0dHIoYSxjKTphLnNldEF0dHJpYnV0ZShjLGMpLGN9fSxuLmVhY2gobi5leHByLm1hdGNoLmJvb2wuc291cmNlLm1hdGNoKC9cXHcrL2cpLGZ1bmN0aW9uKGEsYil7dmFyIGM9JGJbYl18fG4uZmluZC5hdHRyOyRiW2JdPWZ1bmN0aW9uKGEsYixkKXt2YXIgZSxmO3JldHVybiBkfHwoZj0kYltiXSwkYltiXT1lLGU9bnVsbCE9YyhhLGIsZCk/Yi50b0xvd2VyQ2FzZSgpOm51bGwsJGJbYl09ZiksZX19KTt2YXIgX2I9L14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8YnV0dG9uKSQvaTtuLmZuLmV4dGVuZCh7cHJvcDpmdW5jdGlvbihhLGIpe3JldHVybiBKKHRoaXMsbi5wcm9wLGEsYixhcmd1bWVudHMubGVuZ3RoPjEpfSxyZW1vdmVQcm9wOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtkZWxldGUgdGhpc1tuLnByb3BGaXhbYV18fGFdfSl9fSksbi5leHRlbmQoe3Byb3BGaXg6e1wiZm9yXCI6XCJodG1sRm9yXCIsXCJjbGFzc1wiOlwiY2xhc3NOYW1lXCJ9LHByb3A6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZixnPWEubm9kZVR5cGU7aWYoYSYmMyE9PWcmJjghPT1nJiYyIT09ZylyZXR1cm4gZj0xIT09Z3x8IW4uaXNYTUxEb2MoYSksZiYmKGI9bi5wcm9wRml4W2JdfHxiLGU9bi5wcm9wSG9va3NbYl0pLHZvaWQgMCE9PWM/ZSYmXCJzZXRcImluIGUmJnZvaWQgMCE9PShkPWUuc2V0KGEsYyxiKSk/ZDphW2JdPWM6ZSYmXCJnZXRcImluIGUmJm51bGwhPT0oZD1lLmdldChhLGIpKT9kOmFbYl19LHByb3BIb29rczp7dGFiSW5kZXg6e2dldDpmdW5jdGlvbihhKXtyZXR1cm4gYS5oYXNBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiKXx8X2IudGVzdChhLm5vZGVOYW1lKXx8YS5ocmVmP2EudGFiSW5kZXg6LTF9fX19KSxrLm9wdFNlbGVjdGVkfHwobi5wcm9wSG9va3Muc2VsZWN0ZWQ9e2dldDpmdW5jdGlvbihhKXt2YXIgYj1hLnBhcmVudE5vZGU7cmV0dXJuIGImJmIucGFyZW50Tm9kZSYmYi5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXgsbnVsbH19KSxuLmVhY2goW1widGFiSW5kZXhcIixcInJlYWRPbmx5XCIsXCJtYXhMZW5ndGhcIixcImNlbGxTcGFjaW5nXCIsXCJjZWxsUGFkZGluZ1wiLFwicm93U3BhblwiLFwiY29sU3BhblwiLFwidXNlTWFwXCIsXCJmcmFtZUJvcmRlclwiLFwiY29udGVudEVkaXRhYmxlXCJdLGZ1bmN0aW9uKCl7bi5wcm9wRml4W3RoaXMudG9Mb3dlckNhc2UoKV09dGhpc30pO3ZhciBhYz0vW1xcdFxcclxcblxcZl0vZztuLmZuLmV4dGVuZCh7YWRkQ2xhc3M6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGUsZixnLGg9XCJzdHJpbmdcIj09dHlwZW9mIGEmJmEsaT0wLGo9dGhpcy5sZW5ndGg7aWYobi5pc0Z1bmN0aW9uKGEpKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oYil7bih0aGlzKS5hZGRDbGFzcyhhLmNhbGwodGhpcyxiLHRoaXMuY2xhc3NOYW1lKSl9KTtpZihoKWZvcihiPShhfHxcIlwiKS5tYXRjaChFKXx8W107aj5pO2krKylpZihjPXRoaXNbaV0sZD0xPT09Yy5ub2RlVHlwZSYmKGMuY2xhc3NOYW1lPyhcIiBcIitjLmNsYXNzTmFtZStcIiBcIikucmVwbGFjZShhYyxcIiBcIik6XCIgXCIpKXtmPTA7d2hpbGUoZT1iW2YrK10pZC5pbmRleE9mKFwiIFwiK2UrXCIgXCIpPDAmJihkKz1lK1wiIFwiKTtnPW4udHJpbShkKSxjLmNsYXNzTmFtZSE9PWcmJihjLmNsYXNzTmFtZT1nKX1yZXR1cm4gdGhpc30scmVtb3ZlQ2xhc3M6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGUsZixnLGg9MD09PWFyZ3VtZW50cy5sZW5ndGh8fFwic3RyaW5nXCI9PXR5cGVvZiBhJiZhLGk9MCxqPXRoaXMubGVuZ3RoO2lmKG4uaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGIpe24odGhpcykucmVtb3ZlQ2xhc3MoYS5jYWxsKHRoaXMsYix0aGlzLmNsYXNzTmFtZSkpfSk7aWYoaClmb3IoYj0oYXx8XCJcIikubWF0Y2goRSl8fFtdO2o+aTtpKyspaWYoYz10aGlzW2ldLGQ9MT09PWMubm9kZVR5cGUmJihjLmNsYXNzTmFtZT8oXCIgXCIrYy5jbGFzc05hbWUrXCIgXCIpLnJlcGxhY2UoYWMsXCIgXCIpOlwiXCIpKXtmPTA7d2hpbGUoZT1iW2YrK10pd2hpbGUoZC5pbmRleE9mKFwiIFwiK2UrXCIgXCIpPj0wKWQ9ZC5yZXBsYWNlKFwiIFwiK2UrXCIgXCIsXCIgXCIpO2c9YT9uLnRyaW0oZCk6XCJcIixjLmNsYXNzTmFtZSE9PWcmJihjLmNsYXNzTmFtZT1nKX1yZXR1cm4gdGhpc30sdG9nZ2xlQ2xhc3M6ZnVuY3Rpb24oYSxiKXt2YXIgYz10eXBlb2YgYTtyZXR1cm5cImJvb2xlYW5cIj09dHlwZW9mIGImJlwic3RyaW5nXCI9PT1jP2I/dGhpcy5hZGRDbGFzcyhhKTp0aGlzLnJlbW92ZUNsYXNzKGEpOnRoaXMuZWFjaChuLmlzRnVuY3Rpb24oYSk/ZnVuY3Rpb24oYyl7bih0aGlzKS50b2dnbGVDbGFzcyhhLmNhbGwodGhpcyxjLHRoaXMuY2xhc3NOYW1lLGIpLGIpfTpmdW5jdGlvbigpe2lmKFwic3RyaW5nXCI9PT1jKXt2YXIgYixkPTAsZT1uKHRoaXMpLGY9YS5tYXRjaChFKXx8W107d2hpbGUoYj1mW2QrK10pZS5oYXNDbGFzcyhiKT9lLnJlbW92ZUNsYXNzKGIpOmUuYWRkQ2xhc3MoYil9ZWxzZShjPT09VXx8XCJib29sZWFuXCI9PT1jKSYmKHRoaXMuY2xhc3NOYW1lJiZMLnNldCh0aGlzLFwiX19jbGFzc05hbWVfX1wiLHRoaXMuY2xhc3NOYW1lKSx0aGlzLmNsYXNzTmFtZT10aGlzLmNsYXNzTmFtZXx8YT09PSExP1wiXCI6TC5nZXQodGhpcyxcIl9fY2xhc3NOYW1lX19cIil8fFwiXCIpfSl9LGhhc0NsYXNzOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1cIiBcIithK1wiIFwiLGM9MCxkPXRoaXMubGVuZ3RoO2Q+YztjKyspaWYoMT09PXRoaXNbY10ubm9kZVR5cGUmJihcIiBcIit0aGlzW2NdLmNsYXNzTmFtZStcIiBcIikucmVwbGFjZShhYyxcIiBcIikuaW5kZXhPZihiKT49MClyZXR1cm4hMDtyZXR1cm4hMX19KTt2YXIgYmM9L1xcci9nO24uZm4uZXh0ZW5kKHt2YWw6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGU9dGhpc1swXTt7aWYoYXJndW1lbnRzLmxlbmd0aClyZXR1cm4gZD1uLmlzRnVuY3Rpb24oYSksdGhpcy5lYWNoKGZ1bmN0aW9uKGMpe3ZhciBlOzE9PT10aGlzLm5vZGVUeXBlJiYoZT1kP2EuY2FsbCh0aGlzLGMsbih0aGlzKS52YWwoKSk6YSxudWxsPT1lP2U9XCJcIjpcIm51bWJlclwiPT10eXBlb2YgZT9lKz1cIlwiOm4uaXNBcnJheShlKSYmKGU9bi5tYXAoZSxmdW5jdGlvbihhKXtyZXR1cm4gbnVsbD09YT9cIlwiOmErXCJcIn0pKSxiPW4udmFsSG9va3NbdGhpcy50eXBlXXx8bi52YWxIb29rc1t0aGlzLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldLGImJlwic2V0XCJpbiBiJiZ2b2lkIDAhPT1iLnNldCh0aGlzLGUsXCJ2YWx1ZVwiKXx8KHRoaXMudmFsdWU9ZSkpfSk7aWYoZSlyZXR1cm4gYj1uLnZhbEhvb2tzW2UudHlwZV18fG4udmFsSG9va3NbZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXSxiJiZcImdldFwiaW4gYiYmdm9pZCAwIT09KGM9Yi5nZXQoZSxcInZhbHVlXCIpKT9jOihjPWUudmFsdWUsXCJzdHJpbmdcIj09dHlwZW9mIGM/Yy5yZXBsYWNlKGJjLFwiXCIpOm51bGw9PWM/XCJcIjpjKX19fSksbi5leHRlbmQoe3ZhbEhvb2tzOntvcHRpb246e2dldDpmdW5jdGlvbihhKXt2YXIgYj1uLmZpbmQuYXR0cihhLFwidmFsdWVcIik7cmV0dXJuIG51bGwhPWI/YjpuLnRyaW0obi50ZXh0KGEpKX19LHNlbGVjdDp7Z2V0OmZ1bmN0aW9uKGEpe2Zvcih2YXIgYixjLGQ9YS5vcHRpb25zLGU9YS5zZWxlY3RlZEluZGV4LGY9XCJzZWxlY3Qtb25lXCI9PT1hLnR5cGV8fDA+ZSxnPWY/bnVsbDpbXSxoPWY/ZSsxOmQubGVuZ3RoLGk9MD5lP2g6Zj9lOjA7aD5pO2krKylpZihjPWRbaV0sISghYy5zZWxlY3RlZCYmaSE9PWV8fChrLm9wdERpc2FibGVkP2MuZGlzYWJsZWQ6bnVsbCE9PWMuZ2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIikpfHxjLnBhcmVudE5vZGUuZGlzYWJsZWQmJm4ubm9kZU5hbWUoYy5wYXJlbnROb2RlLFwib3B0Z3JvdXBcIikpKXtpZihiPW4oYykudmFsKCksZilyZXR1cm4gYjtnLnB1c2goYil9cmV0dXJuIGd9LHNldDpmdW5jdGlvbihhLGIpe3ZhciBjLGQsZT1hLm9wdGlvbnMsZj1uLm1ha2VBcnJheShiKSxnPWUubGVuZ3RoO3doaWxlKGctLSlkPWVbZ10sKGQuc2VsZWN0ZWQ9bi5pbkFycmF5KGQudmFsdWUsZik+PTApJiYoYz0hMCk7cmV0dXJuIGN8fChhLnNlbGVjdGVkSW5kZXg9LTEpLGZ9fX19KSxuLmVhY2goW1wicmFkaW9cIixcImNoZWNrYm94XCJdLGZ1bmN0aW9uKCl7bi52YWxIb29rc1t0aGlzXT17c2V0OmZ1bmN0aW9uKGEsYil7cmV0dXJuIG4uaXNBcnJheShiKT9hLmNoZWNrZWQ9bi5pbkFycmF5KG4oYSkudmFsKCksYik+PTA6dm9pZCAwfX0say5jaGVja09ufHwobi52YWxIb29rc1t0aGlzXS5nZXQ9ZnVuY3Rpb24oYSl7cmV0dXJuIG51bGw9PT1hLmdldEF0dHJpYnV0ZShcInZhbHVlXCIpP1wib25cIjphLnZhbHVlfSl9KSxuLmVhY2goXCJibHVyIGZvY3VzIGZvY3VzaW4gZm9jdXNvdXQgbG9hZCByZXNpemUgc2Nyb2xsIHVubG9hZCBjbGljayBkYmxjbGljayBtb3VzZWRvd24gbW91c2V1cCBtb3VzZW1vdmUgbW91c2VvdmVyIG1vdXNlb3V0IG1vdXNlZW50ZXIgbW91c2VsZWF2ZSBjaGFuZ2Ugc2VsZWN0IHN1Ym1pdCBrZXlkb3duIGtleXByZXNzIGtleXVwIGVycm9yIGNvbnRleHRtZW51XCIuc3BsaXQoXCIgXCIpLGZ1bmN0aW9uKGEsYil7bi5mbltiXT1mdW5jdGlvbihhLGMpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPjA/dGhpcy5vbihiLG51bGwsYSxjKTp0aGlzLnRyaWdnZXIoYil9fSksbi5mbi5leHRlbmQoe2hvdmVyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMubW91c2VlbnRlcihhKS5tb3VzZWxlYXZlKGJ8fGEpfSxiaW5kOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdGhpcy5vbihhLG51bGwsYixjKX0sdW5iaW5kOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMub2ZmKGEsbnVsbCxiKX0sZGVsZWdhdGU6ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIHRoaXMub24oYixhLGMsZCl9LHVuZGVsZWdhdGU6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiAxPT09YXJndW1lbnRzLmxlbmd0aD90aGlzLm9mZihhLFwiKipcIik6dGhpcy5vZmYoYixhfHxcIioqXCIsYyl9fSk7dmFyIGNjPW4ubm93KCksZGM9L1xcPy87bi5wYXJzZUpTT049ZnVuY3Rpb24oYSl7cmV0dXJuIEpTT04ucGFyc2UoYStcIlwiKX0sbi5wYXJzZVhNTD1mdW5jdGlvbihhKXt2YXIgYixjO2lmKCFhfHxcInN0cmluZ1wiIT10eXBlb2YgYSlyZXR1cm4gbnVsbDt0cnl7Yz1uZXcgRE9NUGFyc2VyLGI9Yy5wYXJzZUZyb21TdHJpbmcoYSxcInRleHQveG1sXCIpfWNhdGNoKGQpe2I9dm9pZCAwfXJldHVybighYnx8Yi5nZXRFbGVtZW50c0J5VGFnTmFtZShcInBhcnNlcmVycm9yXCIpLmxlbmd0aCkmJm4uZXJyb3IoXCJJbnZhbGlkIFhNTDogXCIrYSksYn07dmFyIGVjPS8jLiokLyxmYz0vKFs/Jl0pXz1bXiZdKi8sZ2M9L14oLio/KTpbIFxcdF0qKFteXFxyXFxuXSopJC9nbSxoYz0vXig/OmFib3V0fGFwcHxhcHAtc3RvcmFnZXwuKy1leHRlbnNpb258ZmlsZXxyZXN8d2lkZ2V0KTokLyxpYz0vXig/OkdFVHxIRUFEKSQvLGpjPS9eXFwvXFwvLyxrYz0vXihbXFx3ListXSs6KSg/OlxcL1xcLyg/OlteXFwvPyNdKkB8KShbXlxcLz8jOl0qKSg/OjooXFxkKyl8KXwpLyxsYz17fSxtYz17fSxuYz1cIiovXCIuY29uY2F0KFwiKlwiKSxvYz1hLmxvY2F0aW9uLmhyZWYscGM9a2MuZXhlYyhvYy50b0xvd2VyQ2FzZSgpKXx8W107ZnVuY3Rpb24gcWMoYSl7cmV0dXJuIGZ1bmN0aW9uKGIsYyl7XCJzdHJpbmdcIiE9dHlwZW9mIGImJihjPWIsYj1cIipcIik7dmFyIGQsZT0wLGY9Yi50b0xvd2VyQ2FzZSgpLm1hdGNoKEUpfHxbXTtpZihuLmlzRnVuY3Rpb24oYykpd2hpbGUoZD1mW2UrK10pXCIrXCI9PT1kWzBdPyhkPWQuc2xpY2UoMSl8fFwiKlwiLChhW2RdPWFbZF18fFtdKS51bnNoaWZ0KGMpKTooYVtkXT1hW2RdfHxbXSkucHVzaChjKX19ZnVuY3Rpb24gcmMoYSxiLGMsZCl7dmFyIGU9e30sZj1hPT09bWM7ZnVuY3Rpb24gZyhoKXt2YXIgaTtyZXR1cm4gZVtoXT0hMCxuLmVhY2goYVtoXXx8W10sZnVuY3Rpb24oYSxoKXt2YXIgaj1oKGIsYyxkKTtyZXR1cm5cInN0cmluZ1wiIT10eXBlb2Yganx8Znx8ZVtqXT9mPyEoaT1qKTp2b2lkIDA6KGIuZGF0YVR5cGVzLnVuc2hpZnQoaiksZyhqKSwhMSl9KSxpfXJldHVybiBnKGIuZGF0YVR5cGVzWzBdKXx8IWVbXCIqXCJdJiZnKFwiKlwiKX1mdW5jdGlvbiBzYyhhLGIpe3ZhciBjLGQsZT1uLmFqYXhTZXR0aW5ncy5mbGF0T3B0aW9uc3x8e307Zm9yKGMgaW4gYil2b2lkIDAhPT1iW2NdJiYoKGVbY10/YTpkfHwoZD17fSkpW2NdPWJbY10pO3JldHVybiBkJiZuLmV4dGVuZCghMCxhLGQpLGF9ZnVuY3Rpb24gdGMoYSxiLGMpe3ZhciBkLGUsZixnLGg9YS5jb250ZW50cyxpPWEuZGF0YVR5cGVzO3doaWxlKFwiKlwiPT09aVswXSlpLnNoaWZ0KCksdm9pZCAwPT09ZCYmKGQ9YS5taW1lVHlwZXx8Yi5nZXRSZXNwb25zZUhlYWRlcihcIkNvbnRlbnQtVHlwZVwiKSk7aWYoZClmb3IoZSBpbiBoKWlmKGhbZV0mJmhbZV0udGVzdChkKSl7aS51bnNoaWZ0KGUpO2JyZWFrfWlmKGlbMF1pbiBjKWY9aVswXTtlbHNle2ZvcihlIGluIGMpe2lmKCFpWzBdfHxhLmNvbnZlcnRlcnNbZStcIiBcIitpWzBdXSl7Zj1lO2JyZWFrfWd8fChnPWUpfWY9Znx8Z31yZXR1cm4gZj8oZiE9PWlbMF0mJmkudW5zaGlmdChmKSxjW2ZdKTp2b2lkIDB9ZnVuY3Rpb24gdWMoYSxiLGMsZCl7dmFyIGUsZixnLGgsaSxqPXt9LGs9YS5kYXRhVHlwZXMuc2xpY2UoKTtpZihrWzFdKWZvcihnIGluIGEuY29udmVydGVycylqW2cudG9Mb3dlckNhc2UoKV09YS5jb252ZXJ0ZXJzW2ddO2Y9ay5zaGlmdCgpO3doaWxlKGYpaWYoYS5yZXNwb25zZUZpZWxkc1tmXSYmKGNbYS5yZXNwb25zZUZpZWxkc1tmXV09YiksIWkmJmQmJmEuZGF0YUZpbHRlciYmKGI9YS5kYXRhRmlsdGVyKGIsYS5kYXRhVHlwZSkpLGk9ZixmPWsuc2hpZnQoKSlpZihcIipcIj09PWYpZj1pO2Vsc2UgaWYoXCIqXCIhPT1pJiZpIT09Zil7aWYoZz1qW2krXCIgXCIrZl18fGpbXCIqIFwiK2ZdLCFnKWZvcihlIGluIGopaWYoaD1lLnNwbGl0KFwiIFwiKSxoWzFdPT09ZiYmKGc9altpK1wiIFwiK2hbMF1dfHxqW1wiKiBcIitoWzBdXSkpe2c9PT0hMD9nPWpbZV06altlXSE9PSEwJiYoZj1oWzBdLGsudW5zaGlmdChoWzFdKSk7YnJlYWt9aWYoZyE9PSEwKWlmKGcmJmFbXCJ0aHJvd3NcIl0pYj1nKGIpO2Vsc2UgdHJ5e2I9ZyhiKX1jYXRjaChsKXtyZXR1cm57c3RhdGU6XCJwYXJzZXJlcnJvclwiLGVycm9yOmc/bDpcIk5vIGNvbnZlcnNpb24gZnJvbSBcIitpK1wiIHRvIFwiK2Z9fX1yZXR1cm57c3RhdGU6XCJzdWNjZXNzXCIsZGF0YTpifX1uLmV4dGVuZCh7YWN0aXZlOjAsbGFzdE1vZGlmaWVkOnt9LGV0YWc6e30sYWpheFNldHRpbmdzOnt1cmw6b2MsdHlwZTpcIkdFVFwiLGlzTG9jYWw6aGMudGVzdChwY1sxXSksZ2xvYmFsOiEwLHByb2Nlc3NEYXRhOiEwLGFzeW5jOiEwLGNvbnRlbnRUeXBlOlwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04XCIsYWNjZXB0czp7XCIqXCI6bmMsdGV4dDpcInRleHQvcGxhaW5cIixodG1sOlwidGV4dC9odG1sXCIseG1sOlwiYXBwbGljYXRpb24veG1sLCB0ZXh0L3htbFwiLGpzb246XCJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L2phdmFzY3JpcHRcIn0sY29udGVudHM6e3htbDoveG1sLyxodG1sOi9odG1sLyxqc29uOi9qc29uL30scmVzcG9uc2VGaWVsZHM6e3htbDpcInJlc3BvbnNlWE1MXCIsdGV4dDpcInJlc3BvbnNlVGV4dFwiLGpzb246XCJyZXNwb25zZUpTT05cIn0sY29udmVydGVyczp7XCIqIHRleHRcIjpTdHJpbmcsXCJ0ZXh0IGh0bWxcIjohMCxcInRleHQganNvblwiOm4ucGFyc2VKU09OLFwidGV4dCB4bWxcIjpuLnBhcnNlWE1MfSxmbGF0T3B0aW9uczp7dXJsOiEwLGNvbnRleHQ6ITB9fSxhamF4U2V0dXA6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYj9zYyhzYyhhLG4uYWpheFNldHRpbmdzKSxiKTpzYyhuLmFqYXhTZXR0aW5ncyxhKX0sYWpheFByZWZpbHRlcjpxYyhsYyksYWpheFRyYW5zcG9ydDpxYyhtYyksYWpheDpmdW5jdGlvbihhLGIpe1wib2JqZWN0XCI9PXR5cGVvZiBhJiYoYj1hLGE9dm9pZCAwKSxiPWJ8fHt9O3ZhciBjLGQsZSxmLGcsaCxpLGosaz1uLmFqYXhTZXR1cCh7fSxiKSxsPWsuY29udGV4dHx8ayxtPWsuY29udGV4dCYmKGwubm9kZVR5cGV8fGwuanF1ZXJ5KT9uKGwpOm4uZXZlbnQsbz1uLkRlZmVycmVkKCkscD1uLkNhbGxiYWNrcyhcIm9uY2UgbWVtb3J5XCIpLHE9ay5zdGF0dXNDb2RlfHx7fSxyPXt9LHM9e30sdD0wLHU9XCJjYW5jZWxlZFwiLHY9e3JlYWR5U3RhdGU6MCxnZXRSZXNwb25zZUhlYWRlcjpmdW5jdGlvbihhKXt2YXIgYjtpZigyPT09dCl7aWYoIWYpe2Y9e307d2hpbGUoYj1nYy5leGVjKGUpKWZbYlsxXS50b0xvd2VyQ2FzZSgpXT1iWzJdfWI9ZlthLnRvTG93ZXJDYXNlKCldfXJldHVybiBudWxsPT1iP251bGw6Yn0sZ2V0QWxsUmVzcG9uc2VIZWFkZXJzOmZ1bmN0aW9uKCl7cmV0dXJuIDI9PT10P2U6bnVsbH0sc2V0UmVxdWVzdEhlYWRlcjpmdW5jdGlvbihhLGIpe3ZhciBjPWEudG9Mb3dlckNhc2UoKTtyZXR1cm4gdHx8KGE9c1tjXT1zW2NdfHxhLHJbYV09YiksdGhpc30sb3ZlcnJpZGVNaW1lVHlwZTpmdW5jdGlvbihhKXtyZXR1cm4gdHx8KGsubWltZVR5cGU9YSksdGhpc30sc3RhdHVzQ29kZTpmdW5jdGlvbihhKXt2YXIgYjtpZihhKWlmKDI+dClmb3IoYiBpbiBhKXFbYl09W3FbYl0sYVtiXV07ZWxzZSB2LmFsd2F5cyhhW3Yuc3RhdHVzXSk7cmV0dXJuIHRoaXN9LGFib3J0OmZ1bmN0aW9uKGEpe3ZhciBiPWF8fHU7cmV0dXJuIGMmJmMuYWJvcnQoYikseCgwLGIpLHRoaXN9fTtpZihvLnByb21pc2UodikuY29tcGxldGU9cC5hZGQsdi5zdWNjZXNzPXYuZG9uZSx2LmVycm9yPXYuZmFpbCxrLnVybD0oKGF8fGsudXJsfHxvYykrXCJcIikucmVwbGFjZShlYyxcIlwiKS5yZXBsYWNlKGpjLHBjWzFdK1wiLy9cIiksay50eXBlPWIubWV0aG9kfHxiLnR5cGV8fGsubWV0aG9kfHxrLnR5cGUsay5kYXRhVHlwZXM9bi50cmltKGsuZGF0YVR5cGV8fFwiKlwiKS50b0xvd2VyQ2FzZSgpLm1hdGNoKEUpfHxbXCJcIl0sbnVsbD09ay5jcm9zc0RvbWFpbiYmKGg9a2MuZXhlYyhrLnVybC50b0xvd2VyQ2FzZSgpKSxrLmNyb3NzRG9tYWluPSEoIWh8fGhbMV09PT1wY1sxXSYmaFsyXT09PXBjWzJdJiYoaFszXXx8KFwiaHR0cDpcIj09PWhbMV0/XCI4MFwiOlwiNDQzXCIpKT09PShwY1szXXx8KFwiaHR0cDpcIj09PXBjWzFdP1wiODBcIjpcIjQ0M1wiKSkpKSxrLmRhdGEmJmsucHJvY2Vzc0RhdGEmJlwic3RyaW5nXCIhPXR5cGVvZiBrLmRhdGEmJihrLmRhdGE9bi5wYXJhbShrLmRhdGEsay50cmFkaXRpb25hbCkpLHJjKGxjLGssYix2KSwyPT09dClyZXR1cm4gdjtpPW4uZXZlbnQmJmsuZ2xvYmFsLGkmJjA9PT1uLmFjdGl2ZSsrJiZuLmV2ZW50LnRyaWdnZXIoXCJhamF4U3RhcnRcIiksay50eXBlPWsudHlwZS50b1VwcGVyQ2FzZSgpLGsuaGFzQ29udGVudD0haWMudGVzdChrLnR5cGUpLGQ9ay51cmwsay5oYXNDb250ZW50fHwoay5kYXRhJiYoZD1rLnVybCs9KGRjLnRlc3QoZCk/XCImXCI6XCI/XCIpK2suZGF0YSxkZWxldGUgay5kYXRhKSxrLmNhY2hlPT09ITEmJihrLnVybD1mYy50ZXN0KGQpP2QucmVwbGFjZShmYyxcIiQxXz1cIitjYysrKTpkKyhkYy50ZXN0KGQpP1wiJlwiOlwiP1wiKStcIl89XCIrY2MrKykpLGsuaWZNb2RpZmllZCYmKG4ubGFzdE1vZGlmaWVkW2RdJiZ2LnNldFJlcXVlc3RIZWFkZXIoXCJJZi1Nb2RpZmllZC1TaW5jZVwiLG4ubGFzdE1vZGlmaWVkW2RdKSxuLmV0YWdbZF0mJnYuc2V0UmVxdWVzdEhlYWRlcihcIklmLU5vbmUtTWF0Y2hcIixuLmV0YWdbZF0pKSwoay5kYXRhJiZrLmhhc0NvbnRlbnQmJmsuY29udGVudFR5cGUhPT0hMXx8Yi5jb250ZW50VHlwZSkmJnYuc2V0UmVxdWVzdEhlYWRlcihcIkNvbnRlbnQtVHlwZVwiLGsuY29udGVudFR5cGUpLHYuc2V0UmVxdWVzdEhlYWRlcihcIkFjY2VwdFwiLGsuZGF0YVR5cGVzWzBdJiZrLmFjY2VwdHNbay5kYXRhVHlwZXNbMF1dP2suYWNjZXB0c1trLmRhdGFUeXBlc1swXV0rKFwiKlwiIT09ay5kYXRhVHlwZXNbMF0/XCIsIFwiK25jK1wiOyBxPTAuMDFcIjpcIlwiKTprLmFjY2VwdHNbXCIqXCJdKTtmb3IoaiBpbiBrLmhlYWRlcnMpdi5zZXRSZXF1ZXN0SGVhZGVyKGosay5oZWFkZXJzW2pdKTtpZihrLmJlZm9yZVNlbmQmJihrLmJlZm9yZVNlbmQuY2FsbChsLHYsayk9PT0hMXx8Mj09PXQpKXJldHVybiB2LmFib3J0KCk7dT1cImFib3J0XCI7Zm9yKGogaW57c3VjY2VzczoxLGVycm9yOjEsY29tcGxldGU6MX0pdltqXShrW2pdKTtpZihjPXJjKG1jLGssYix2KSl7di5yZWFkeVN0YXRlPTEsaSYmbS50cmlnZ2VyKFwiYWpheFNlbmRcIixbdixrXSksay5hc3luYyYmay50aW1lb3V0PjAmJihnPXNldFRpbWVvdXQoZnVuY3Rpb24oKXt2LmFib3J0KFwidGltZW91dFwiKX0say50aW1lb3V0KSk7dHJ5e3Q9MSxjLnNlbmQocix4KX1jYXRjaCh3KXtpZighKDI+dCkpdGhyb3cgdzt4KC0xLHcpfX1lbHNlIHgoLTEsXCJObyBUcmFuc3BvcnRcIik7ZnVuY3Rpb24geChhLGIsZixoKXt2YXIgaixyLHMsdSx3LHg9YjsyIT09dCYmKHQ9MixnJiZjbGVhclRpbWVvdXQoZyksYz12b2lkIDAsZT1ofHxcIlwiLHYucmVhZHlTdGF0ZT1hPjA/NDowLGo9YT49MjAwJiYzMDA+YXx8MzA0PT09YSxmJiYodT10YyhrLHYsZikpLHU9dWMoayx1LHYsaiksaj8oay5pZk1vZGlmaWVkJiYodz12LmdldFJlc3BvbnNlSGVhZGVyKFwiTGFzdC1Nb2RpZmllZFwiKSx3JiYobi5sYXN0TW9kaWZpZWRbZF09dyksdz12LmdldFJlc3BvbnNlSGVhZGVyKFwiZXRhZ1wiKSx3JiYobi5ldGFnW2RdPXcpKSwyMDQ9PT1hfHxcIkhFQURcIj09PWsudHlwZT94PVwibm9jb250ZW50XCI6MzA0PT09YT94PVwibm90bW9kaWZpZWRcIjooeD11LnN0YXRlLHI9dS5kYXRhLHM9dS5lcnJvcixqPSFzKSk6KHM9eCwoYXx8IXgpJiYoeD1cImVycm9yXCIsMD5hJiYoYT0wKSkpLHYuc3RhdHVzPWEsdi5zdGF0dXNUZXh0PShifHx4KStcIlwiLGo/by5yZXNvbHZlV2l0aChsLFtyLHgsdl0pOm8ucmVqZWN0V2l0aChsLFt2LHgsc10pLHYuc3RhdHVzQ29kZShxKSxxPXZvaWQgMCxpJiZtLnRyaWdnZXIoaj9cImFqYXhTdWNjZXNzXCI6XCJhamF4RXJyb3JcIixbdixrLGo/cjpzXSkscC5maXJlV2l0aChsLFt2LHhdKSxpJiYobS50cmlnZ2VyKFwiYWpheENvbXBsZXRlXCIsW3Ysa10pLC0tbi5hY3RpdmV8fG4uZXZlbnQudHJpZ2dlcihcImFqYXhTdG9wXCIpKSl9cmV0dXJuIHZ9LGdldEpTT046ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuLmdldChhLGIsYyxcImpzb25cIil9LGdldFNjcmlwdDpmdW5jdGlvbihhLGIpe3JldHVybiBuLmdldChhLHZvaWQgMCxiLFwic2NyaXB0XCIpfX0pLG4uZWFjaChbXCJnZXRcIixcInBvc3RcIl0sZnVuY3Rpb24oYSxiKXtuW2JdPWZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBuLmlzRnVuY3Rpb24oYykmJihlPWV8fGQsZD1jLGM9dm9pZCAwKSxuLmFqYXgoe3VybDphLHR5cGU6YixkYXRhVHlwZTplLGRhdGE6YyxzdWNjZXNzOmR9KX19KSxuLl9ldmFsVXJsPWZ1bmN0aW9uKGEpe3JldHVybiBuLmFqYXgoe3VybDphLHR5cGU6XCJHRVRcIixkYXRhVHlwZTpcInNjcmlwdFwiLGFzeW5jOiExLGdsb2JhbDohMSxcInRocm93c1wiOiEwfSl9LG4uZm4uZXh0ZW5kKHt3cmFwQWxsOmZ1bmN0aW9uKGEpe3ZhciBiO3JldHVybiBuLmlzRnVuY3Rpb24oYSk/dGhpcy5lYWNoKGZ1bmN0aW9uKGIpe24odGhpcykud3JhcEFsbChhLmNhbGwodGhpcyxiKSl9KToodGhpc1swXSYmKGI9bihhLHRoaXNbMF0ub3duZXJEb2N1bWVudCkuZXEoMCkuY2xvbmUoITApLHRoaXNbMF0ucGFyZW50Tm9kZSYmYi5pbnNlcnRCZWZvcmUodGhpc1swXSksYi5tYXAoZnVuY3Rpb24oKXt2YXIgYT10aGlzO3doaWxlKGEuZmlyc3RFbGVtZW50Q2hpbGQpYT1hLmZpcnN0RWxlbWVudENoaWxkO3JldHVybiBhfSkuYXBwZW5kKHRoaXMpKSx0aGlzKX0sd3JhcElubmVyOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmVhY2gobi5pc0Z1bmN0aW9uKGEpP2Z1bmN0aW9uKGIpe24odGhpcykud3JhcElubmVyKGEuY2FsbCh0aGlzLGIpKX06ZnVuY3Rpb24oKXt2YXIgYj1uKHRoaXMpLGM9Yi5jb250ZW50cygpO2MubGVuZ3RoP2Mud3JhcEFsbChhKTpiLmFwcGVuZChhKX0pfSx3cmFwOmZ1bmN0aW9uKGEpe3ZhciBiPW4uaXNGdW5jdGlvbihhKTtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGMpe24odGhpcykud3JhcEFsbChiP2EuY2FsbCh0aGlzLGMpOmEpfSl9LHVud3JhcDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnBhcmVudCgpLmVhY2goZnVuY3Rpb24oKXtuLm5vZGVOYW1lKHRoaXMsXCJib2R5XCIpfHxuKHRoaXMpLnJlcGxhY2VXaXRoKHRoaXMuY2hpbGROb2Rlcyl9KS5lbmQoKX19KSxuLmV4cHIuZmlsdGVycy5oaWRkZW49ZnVuY3Rpb24oYSl7cmV0dXJuIGEub2Zmc2V0V2lkdGg8PTAmJmEub2Zmc2V0SGVpZ2h0PD0wfSxuLmV4cHIuZmlsdGVycy52aXNpYmxlPWZ1bmN0aW9uKGEpe3JldHVybiFuLmV4cHIuZmlsdGVycy5oaWRkZW4oYSl9O3ZhciB2Yz0vJTIwL2csd2M9L1xcW1xcXSQvLHhjPS9cXHI/XFxuL2cseWM9L14oPzpzdWJtaXR8YnV0dG9ufGltYWdlfHJlc2V0fGZpbGUpJC9pLHpjPS9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGtleWdlbikvaTtmdW5jdGlvbiBBYyhhLGIsYyxkKXt2YXIgZTtpZihuLmlzQXJyYXkoYikpbi5lYWNoKGIsZnVuY3Rpb24oYixlKXtjfHx3Yy50ZXN0KGEpP2QoYSxlKTpBYyhhK1wiW1wiKyhcIm9iamVjdFwiPT10eXBlb2YgZT9iOlwiXCIpK1wiXVwiLGUsYyxkKX0pO2Vsc2UgaWYoY3x8XCJvYmplY3RcIiE9PW4udHlwZShiKSlkKGEsYik7ZWxzZSBmb3IoZSBpbiBiKUFjKGErXCJbXCIrZStcIl1cIixiW2VdLGMsZCl9bi5wYXJhbT1mdW5jdGlvbihhLGIpe3ZhciBjLGQ9W10sZT1mdW5jdGlvbihhLGIpe2I9bi5pc0Z1bmN0aW9uKGIpP2IoKTpudWxsPT1iP1wiXCI6YixkW2QubGVuZ3RoXT1lbmNvZGVVUklDb21wb25lbnQoYSkrXCI9XCIrZW5jb2RlVVJJQ29tcG9uZW50KGIpfTtpZih2b2lkIDA9PT1iJiYoYj1uLmFqYXhTZXR0aW5ncyYmbi5hamF4U2V0dGluZ3MudHJhZGl0aW9uYWwpLG4uaXNBcnJheShhKXx8YS5qcXVlcnkmJiFuLmlzUGxhaW5PYmplY3QoYSkpbi5lYWNoKGEsZnVuY3Rpb24oKXtlKHRoaXMubmFtZSx0aGlzLnZhbHVlKX0pO2Vsc2UgZm9yKGMgaW4gYSlBYyhjLGFbY10sYixlKTtyZXR1cm4gZC5qb2luKFwiJlwiKS5yZXBsYWNlKHZjLFwiK1wiKX0sbi5mbi5leHRlbmQoe3NlcmlhbGl6ZTpmdW5jdGlvbigpe3JldHVybiBuLnBhcmFtKHRoaXMuc2VyaWFsaXplQXJyYXkoKSl9LHNlcmlhbGl6ZUFycmF5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCl7dmFyIGE9bi5wcm9wKHRoaXMsXCJlbGVtZW50c1wiKTtyZXR1cm4gYT9uLm1ha2VBcnJheShhKTp0aGlzfSkuZmlsdGVyKGZ1bmN0aW9uKCl7dmFyIGE9dGhpcy50eXBlO3JldHVybiB0aGlzLm5hbWUmJiFuKHRoaXMpLmlzKFwiOmRpc2FibGVkXCIpJiZ6Yy50ZXN0KHRoaXMubm9kZU5hbWUpJiYheWMudGVzdChhKSYmKHRoaXMuY2hlY2tlZHx8IVQudGVzdChhKSl9KS5tYXAoZnVuY3Rpb24oYSxiKXt2YXIgYz1uKHRoaXMpLnZhbCgpO3JldHVybiBudWxsPT1jP251bGw6bi5pc0FycmF5KGMpP24ubWFwKGMsZnVuY3Rpb24oYSl7cmV0dXJue25hbWU6Yi5uYW1lLHZhbHVlOmEucmVwbGFjZSh4YyxcIlxcclxcblwiKX19KTp7bmFtZTpiLm5hbWUsdmFsdWU6Yy5yZXBsYWNlKHhjLFwiXFxyXFxuXCIpfX0pLmdldCgpfX0pLG4uYWpheFNldHRpbmdzLnhocj1mdW5jdGlvbigpe3RyeXtyZXR1cm4gbmV3IFhNTEh0dHBSZXF1ZXN0fWNhdGNoKGEpe319O3ZhciBCYz0wLENjPXt9LERjPXswOjIwMCwxMjIzOjIwNH0sRWM9bi5hamF4U2V0dGluZ3MueGhyKCk7YS5hdHRhY2hFdmVudCYmYS5hdHRhY2hFdmVudChcIm9udW5sb2FkXCIsZnVuY3Rpb24oKXtmb3IodmFyIGEgaW4gQ2MpQ2NbYV0oKX0pLGsuY29ycz0hIUVjJiZcIndpdGhDcmVkZW50aWFsc1wiaW4gRWMsay5hamF4PUVjPSEhRWMsbi5hamF4VHJhbnNwb3J0KGZ1bmN0aW9uKGEpe3ZhciBiO3JldHVybiBrLmNvcnN8fEVjJiYhYS5jcm9zc0RvbWFpbj97c2VuZDpmdW5jdGlvbihjLGQpe3ZhciBlLGY9YS54aHIoKSxnPSsrQmM7aWYoZi5vcGVuKGEudHlwZSxhLnVybCxhLmFzeW5jLGEudXNlcm5hbWUsYS5wYXNzd29yZCksYS54aHJGaWVsZHMpZm9yKGUgaW4gYS54aHJGaWVsZHMpZltlXT1hLnhockZpZWxkc1tlXTthLm1pbWVUeXBlJiZmLm92ZXJyaWRlTWltZVR5cGUmJmYub3ZlcnJpZGVNaW1lVHlwZShhLm1pbWVUeXBlKSxhLmNyb3NzRG9tYWlufHxjW1wiWC1SZXF1ZXN0ZWQtV2l0aFwiXXx8KGNbXCJYLVJlcXVlc3RlZC1XaXRoXCJdPVwiWE1MSHR0cFJlcXVlc3RcIik7Zm9yKGUgaW4gYylmLnNldFJlcXVlc3RIZWFkZXIoZSxjW2VdKTtiPWZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbigpe2ImJihkZWxldGUgQ2NbZ10sYj1mLm9ubG9hZD1mLm9uZXJyb3I9bnVsbCxcImFib3J0XCI9PT1hP2YuYWJvcnQoKTpcImVycm9yXCI9PT1hP2QoZi5zdGF0dXMsZi5zdGF0dXNUZXh0KTpkKERjW2Yuc3RhdHVzXXx8Zi5zdGF0dXMsZi5zdGF0dXNUZXh0LFwic3RyaW5nXCI9PXR5cGVvZiBmLnJlc3BvbnNlVGV4dD97dGV4dDpmLnJlc3BvbnNlVGV4dH06dm9pZCAwLGYuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkpKX19LGYub25sb2FkPWIoKSxmLm9uZXJyb3I9YihcImVycm9yXCIpLGI9Q2NbZ109YihcImFib3J0XCIpO3RyeXtmLnNlbmQoYS5oYXNDb250ZW50JiZhLmRhdGF8fG51bGwpfWNhdGNoKGgpe2lmKGIpdGhyb3cgaH19LGFib3J0OmZ1bmN0aW9uKCl7YiYmYigpfX06dm9pZCAwfSksbi5hamF4U2V0dXAoe2FjY2VwdHM6e3NjcmlwdDpcInRleHQvamF2YXNjcmlwdCwgYXBwbGljYXRpb24vamF2YXNjcmlwdCwgYXBwbGljYXRpb24vZWNtYXNjcmlwdCwgYXBwbGljYXRpb24veC1lY21hc2NyaXB0XCJ9LGNvbnRlbnRzOntzY3JpcHQ6Lyg/OmphdmF8ZWNtYSlzY3JpcHQvfSxjb252ZXJ0ZXJzOntcInRleHQgc2NyaXB0XCI6ZnVuY3Rpb24oYSl7cmV0dXJuIG4uZ2xvYmFsRXZhbChhKSxhfX19KSxuLmFqYXhQcmVmaWx0ZXIoXCJzY3JpcHRcIixmdW5jdGlvbihhKXt2b2lkIDA9PT1hLmNhY2hlJiYoYS5jYWNoZT0hMSksYS5jcm9zc0RvbWFpbiYmKGEudHlwZT1cIkdFVFwiKX0pLG4uYWpheFRyYW5zcG9ydChcInNjcmlwdFwiLGZ1bmN0aW9uKGEpe2lmKGEuY3Jvc3NEb21haW4pe3ZhciBiLGM7cmV0dXJue3NlbmQ6ZnVuY3Rpb24oZCxlKXtiPW4oXCI8c2NyaXB0PlwiKS5wcm9wKHthc3luYzohMCxjaGFyc2V0OmEuc2NyaXB0Q2hhcnNldCxzcmM6YS51cmx9KS5vbihcImxvYWQgZXJyb3JcIixjPWZ1bmN0aW9uKGEpe2IucmVtb3ZlKCksYz1udWxsLGEmJmUoXCJlcnJvclwiPT09YS50eXBlPzQwNDoyMDAsYS50eXBlKX0pLGwuaGVhZC5hcHBlbmRDaGlsZChiWzBdKX0sYWJvcnQ6ZnVuY3Rpb24oKXtjJiZjKCl9fX19KTt2YXIgRmM9W10sR2M9Lyg9KVxcPyg/PSZ8JCl8XFw/XFw/LztuLmFqYXhTZXR1cCh7anNvbnA6XCJjYWxsYmFja1wiLGpzb25wQ2FsbGJhY2s6ZnVuY3Rpb24oKXt2YXIgYT1GYy5wb3AoKXx8bi5leHBhbmRvK1wiX1wiK2NjKys7cmV0dXJuIHRoaXNbYV09ITAsYX19KSxuLmFqYXhQcmVmaWx0ZXIoXCJqc29uIGpzb25wXCIsZnVuY3Rpb24oYixjLGQpe3ZhciBlLGYsZyxoPWIuanNvbnAhPT0hMSYmKEdjLnRlc3QoYi51cmwpP1widXJsXCI6XCJzdHJpbmdcIj09dHlwZW9mIGIuZGF0YSYmIShiLmNvbnRlbnRUeXBlfHxcIlwiKS5pbmRleE9mKFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCIpJiZHYy50ZXN0KGIuZGF0YSkmJlwiZGF0YVwiKTtyZXR1cm4gaHx8XCJqc29ucFwiPT09Yi5kYXRhVHlwZXNbMF0/KGU9Yi5qc29ucENhbGxiYWNrPW4uaXNGdW5jdGlvbihiLmpzb25wQ2FsbGJhY2spP2IuanNvbnBDYWxsYmFjaygpOmIuanNvbnBDYWxsYmFjayxoP2JbaF09YltoXS5yZXBsYWNlKEdjLFwiJDFcIitlKTpiLmpzb25wIT09ITEmJihiLnVybCs9KGRjLnRlc3QoYi51cmwpP1wiJlwiOlwiP1wiKStiLmpzb25wK1wiPVwiK2UpLGIuY29udmVydGVyc1tcInNjcmlwdCBqc29uXCJdPWZ1bmN0aW9uKCl7cmV0dXJuIGd8fG4uZXJyb3IoZStcIiB3YXMgbm90IGNhbGxlZFwiKSxnWzBdfSxiLmRhdGFUeXBlc1swXT1cImpzb25cIixmPWFbZV0sYVtlXT1mdW5jdGlvbigpe2c9YXJndW1lbnRzfSxkLmFsd2F5cyhmdW5jdGlvbigpe2FbZV09ZixiW2VdJiYoYi5qc29ucENhbGxiYWNrPWMuanNvbnBDYWxsYmFjayxGYy5wdXNoKGUpKSxnJiZuLmlzRnVuY3Rpb24oZikmJmYoZ1swXSksZz1mPXZvaWQgMH0pLFwic2NyaXB0XCIpOnZvaWQgMH0pLG4ucGFyc2VIVE1MPWZ1bmN0aW9uKGEsYixjKXtpZighYXx8XCJzdHJpbmdcIiE9dHlwZW9mIGEpcmV0dXJuIG51bGw7XCJib29sZWFuXCI9PXR5cGVvZiBiJiYoYz1iLGI9ITEpLGI9Ynx8bDt2YXIgZD12LmV4ZWMoYSksZT0hYyYmW107cmV0dXJuIGQ/W2IuY3JlYXRlRWxlbWVudChkWzFdKV06KGQ9bi5idWlsZEZyYWdtZW50KFthXSxiLGUpLGUmJmUubGVuZ3RoJiZuKGUpLnJlbW92ZSgpLG4ubWVyZ2UoW10sZC5jaGlsZE5vZGVzKSl9O3ZhciBIYz1uLmZuLmxvYWQ7bi5mbi5sb2FkPWZ1bmN0aW9uKGEsYixjKXtpZihcInN0cmluZ1wiIT10eXBlb2YgYSYmSGMpcmV0dXJuIEhjLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgZCxlLGYsZz10aGlzLGg9YS5pbmRleE9mKFwiIFwiKTtyZXR1cm4gaD49MCYmKGQ9bi50cmltKGEuc2xpY2UoaCkpLGE9YS5zbGljZSgwLGgpKSxuLmlzRnVuY3Rpb24oYik/KGM9YixiPXZvaWQgMCk6YiYmXCJvYmplY3RcIj09dHlwZW9mIGImJihlPVwiUE9TVFwiKSxnLmxlbmd0aD4wJiZuLmFqYXgoe3VybDphLHR5cGU6ZSxkYXRhVHlwZTpcImh0bWxcIixkYXRhOmJ9KS5kb25lKGZ1bmN0aW9uKGEpe2Y9YXJndW1lbnRzLGcuaHRtbChkP24oXCI8ZGl2PlwiKS5hcHBlbmQobi5wYXJzZUhUTUwoYSkpLmZpbmQoZCk6YSl9KS5jb21wbGV0ZShjJiZmdW5jdGlvbihhLGIpe2cuZWFjaChjLGZ8fFthLnJlc3BvbnNlVGV4dCxiLGFdKX0pLHRoaXN9LG4uZWFjaChbXCJhamF4U3RhcnRcIixcImFqYXhTdG9wXCIsXCJhamF4Q29tcGxldGVcIixcImFqYXhFcnJvclwiLFwiYWpheFN1Y2Nlc3NcIixcImFqYXhTZW5kXCJdLGZ1bmN0aW9uKGEsYil7bi5mbltiXT1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5vbihiLGEpfX0pLG4uZXhwci5maWx0ZXJzLmFuaW1hdGVkPWZ1bmN0aW9uKGEpe3JldHVybiBuLmdyZXAobi50aW1lcnMsZnVuY3Rpb24oYil7cmV0dXJuIGE9PT1iLmVsZW19KS5sZW5ndGh9O3ZhciBJYz1hLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtmdW5jdGlvbiBKYyhhKXtyZXR1cm4gbi5pc1dpbmRvdyhhKT9hOjk9PT1hLm5vZGVUeXBlJiZhLmRlZmF1bHRWaWV3fW4ub2Zmc2V0PXtzZXRPZmZzZXQ6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZixnLGgsaSxqLGs9bi5jc3MoYSxcInBvc2l0aW9uXCIpLGw9bihhKSxtPXt9O1wic3RhdGljXCI9PT1rJiYoYS5zdHlsZS5wb3NpdGlvbj1cInJlbGF0aXZlXCIpLGg9bC5vZmZzZXQoKSxmPW4uY3NzKGEsXCJ0b3BcIiksaT1uLmNzcyhhLFwibGVmdFwiKSxqPShcImFic29sdXRlXCI9PT1rfHxcImZpeGVkXCI9PT1rKSYmKGYraSkuaW5kZXhPZihcImF1dG9cIik+LTEsaj8oZD1sLnBvc2l0aW9uKCksZz1kLnRvcCxlPWQubGVmdCk6KGc9cGFyc2VGbG9hdChmKXx8MCxlPXBhcnNlRmxvYXQoaSl8fDApLG4uaXNGdW5jdGlvbihiKSYmKGI9Yi5jYWxsKGEsYyxoKSksbnVsbCE9Yi50b3AmJihtLnRvcD1iLnRvcC1oLnRvcCtnKSxudWxsIT1iLmxlZnQmJihtLmxlZnQ9Yi5sZWZ0LWgubGVmdCtlKSxcInVzaW5nXCJpbiBiP2IudXNpbmcuY2FsbChhLG0pOmwuY3NzKG0pfX0sbi5mbi5leHRlbmQoe29mZnNldDpmdW5jdGlvbihhKXtpZihhcmd1bWVudHMubGVuZ3RoKXJldHVybiB2b2lkIDA9PT1hP3RoaXM6dGhpcy5lYWNoKGZ1bmN0aW9uKGIpe24ub2Zmc2V0LnNldE9mZnNldCh0aGlzLGEsYil9KTt2YXIgYixjLGQ9dGhpc1swXSxlPXt0b3A6MCxsZWZ0OjB9LGY9ZCYmZC5vd25lckRvY3VtZW50O2lmKGYpcmV0dXJuIGI9Zi5kb2N1bWVudEVsZW1lbnQsbi5jb250YWlucyhiLGQpPyh0eXBlb2YgZC5nZXRCb3VuZGluZ0NsaWVudFJlY3QhPT1VJiYoZT1kLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpKSxjPUpjKGYpLHt0b3A6ZS50b3ArYy5wYWdlWU9mZnNldC1iLmNsaWVudFRvcCxsZWZ0OmUubGVmdCtjLnBhZ2VYT2Zmc2V0LWIuY2xpZW50TGVmdH0pOmV9LHBvc2l0aW9uOmZ1bmN0aW9uKCl7aWYodGhpc1swXSl7dmFyIGEsYixjPXRoaXNbMF0sZD17dG9wOjAsbGVmdDowfTtyZXR1cm5cImZpeGVkXCI9PT1uLmNzcyhjLFwicG9zaXRpb25cIik/Yj1jLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOihhPXRoaXMub2Zmc2V0UGFyZW50KCksYj10aGlzLm9mZnNldCgpLG4ubm9kZU5hbWUoYVswXSxcImh0bWxcIil8fChkPWEub2Zmc2V0KCkpLGQudG9wKz1uLmNzcyhhWzBdLFwiYm9yZGVyVG9wV2lkdGhcIiwhMCksZC5sZWZ0Kz1uLmNzcyhhWzBdLFwiYm9yZGVyTGVmdFdpZHRoXCIsITApKSx7dG9wOmIudG9wLWQudG9wLW4uY3NzKGMsXCJtYXJnaW5Ub3BcIiwhMCksbGVmdDpiLmxlZnQtZC5sZWZ0LW4uY3NzKGMsXCJtYXJnaW5MZWZ0XCIsITApfX19LG9mZnNldFBhcmVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1hcChmdW5jdGlvbigpe3ZhciBhPXRoaXMub2Zmc2V0UGFyZW50fHxJYzt3aGlsZShhJiYhbi5ub2RlTmFtZShhLFwiaHRtbFwiKSYmXCJzdGF0aWNcIj09PW4uY3NzKGEsXCJwb3NpdGlvblwiKSlhPWEub2Zmc2V0UGFyZW50O3JldHVybiBhfHxJY30pfX0pLG4uZWFjaCh7c2Nyb2xsTGVmdDpcInBhZ2VYT2Zmc2V0XCIsc2Nyb2xsVG9wOlwicGFnZVlPZmZzZXRcIn0sZnVuY3Rpb24oYixjKXt2YXIgZD1cInBhZ2VZT2Zmc2V0XCI9PT1jO24uZm5bYl09ZnVuY3Rpb24oZSl7cmV0dXJuIEoodGhpcyxmdW5jdGlvbihiLGUsZil7dmFyIGc9SmMoYik7cmV0dXJuIHZvaWQgMD09PWY/Zz9nW2NdOmJbZV06dm9pZChnP2cuc2Nyb2xsVG8oZD9hLnBhZ2VYT2Zmc2V0OmYsZD9mOmEucGFnZVlPZmZzZXQpOmJbZV09Zil9LGIsZSxhcmd1bWVudHMubGVuZ3RoLG51bGwpfX0pLG4uZWFjaChbXCJ0b3BcIixcImxlZnRcIl0sZnVuY3Rpb24oYSxiKXtuLmNzc0hvb2tzW2JdPXliKGsucGl4ZWxQb3NpdGlvbixmdW5jdGlvbihhLGMpe3JldHVybiBjPyhjPXhiKGEsYiksdmIudGVzdChjKT9uKGEpLnBvc2l0aW9uKClbYl0rXCJweFwiOmMpOnZvaWQgMH0pfSksbi5lYWNoKHtIZWlnaHQ6XCJoZWlnaHRcIixXaWR0aDpcIndpZHRoXCJ9LGZ1bmN0aW9uKGEsYil7bi5lYWNoKHtwYWRkaW5nOlwiaW5uZXJcIithLGNvbnRlbnQ6YixcIlwiOlwib3V0ZXJcIithfSxmdW5jdGlvbihjLGQpe24uZm5bZF09ZnVuY3Rpb24oZCxlKXt2YXIgZj1hcmd1bWVudHMubGVuZ3RoJiYoY3x8XCJib29sZWFuXCIhPXR5cGVvZiBkKSxnPWN8fChkPT09ITB8fGU9PT0hMD9cIm1hcmdpblwiOlwiYm9yZGVyXCIpO3JldHVybiBKKHRoaXMsZnVuY3Rpb24oYixjLGQpe3ZhciBlO3JldHVybiBuLmlzV2luZG93KGIpP2IuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50W1wiY2xpZW50XCIrYV06OT09PWIubm9kZVR5cGU/KGU9Yi5kb2N1bWVudEVsZW1lbnQsTWF0aC5tYXgoYi5ib2R5W1wic2Nyb2xsXCIrYV0sZVtcInNjcm9sbFwiK2FdLGIuYm9keVtcIm9mZnNldFwiK2FdLGVbXCJvZmZzZXRcIithXSxlW1wiY2xpZW50XCIrYV0pKTp2b2lkIDA9PT1kP24uY3NzKGIsYyxnKTpuLnN0eWxlKGIsYyxkLGcpfSxiLGY/ZDp2b2lkIDAsZixudWxsKX19KX0pLG4uZm4uc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxlbmd0aH0sbi5mbi5hbmRTZWxmPW4uZm4uYWRkQmFjayxcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQmJmRlZmluZShcImpxdWVyeVwiLFtdLGZ1bmN0aW9uKCl7cmV0dXJuIG59KTt2YXIgS2M9YS5qUXVlcnksTGM9YS4kO3JldHVybiBuLm5vQ29uZmxpY3Q9ZnVuY3Rpb24oYil7cmV0dXJuIGEuJD09PW4mJihhLiQ9TGMpLGImJmEualF1ZXJ5PT09biYmKGEualF1ZXJ5PUtjKSxufSx0eXBlb2YgYj09PVUmJihhLmpRdWVyeT1hLiQ9biksbn0pO1xuIiwiLyohIGpRdWVyeSBVSSAtIHYxLjExLjQgLSAyMDE1LTAzLTE5XG4qIGh0dHA6Ly9qcXVlcnl1aS5jb21cbiogSW5jbHVkZXM6IGNvcmUuanMsIHdpZGdldC5qcywgbW91c2UuanMsIGRyYWdnYWJsZS5qcywgc29ydGFibGUuanNcbiogQ29weXJpZ2h0IDIwMTUgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yczsgTGljZW5zZWQgTUlUICovXG5cbihmdW5jdGlvbiggZmFjdG9yeSApIHtcblx0aWYgKCB0eXBlb2YgZGVmaW5lID09PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCApIHtcblxuXHRcdC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cblx0XHRkZWZpbmUoWyBcImpxdWVyeVwiIF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59KGZ1bmN0aW9uKCAkICkge1xuLyohXG4gKiBqUXVlcnkgVUkgQ29yZSAxLjExLjRcbiAqIGh0dHA6Ly9qcXVlcnl1aS5jb21cbiAqXG4gKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZVxuICpcbiAqIGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2NhdGVnb3J5L3VpLWNvcmUvXG4gKi9cblxuXG4vLyAkLnVpIG1pZ2h0IGV4aXN0IGZyb20gY29tcG9uZW50cyB3aXRoIG5vIGRlcGVuZGVuY2llcywgZS5nLiwgJC51aS5wb3NpdGlvblxuJC51aSA9ICQudWkgfHwge307XG5cbiQuZXh0ZW5kKCAkLnVpLCB7XG5cdHZlcnNpb246IFwiMS4xMS40XCIsXG5cblx0a2V5Q29kZToge1xuXHRcdEJBQ0tTUEFDRTogOCxcblx0XHRDT01NQTogMTg4LFxuXHRcdERFTEVURTogNDYsXG5cdFx0RE9XTjogNDAsXG5cdFx0RU5EOiAzNSxcblx0XHRFTlRFUjogMTMsXG5cdFx0RVNDQVBFOiAyNyxcblx0XHRIT01FOiAzNixcblx0XHRMRUZUOiAzNyxcblx0XHRQQUdFX0RPV046IDM0LFxuXHRcdFBBR0VfVVA6IDMzLFxuXHRcdFBFUklPRDogMTkwLFxuXHRcdFJJR0hUOiAzOSxcblx0XHRTUEFDRTogMzIsXG5cdFx0VEFCOiA5LFxuXHRcdFVQOiAzOFxuXHR9XG59KTtcblxuLy8gcGx1Z2luc1xuJC5mbi5leHRlbmQoe1xuXHRzY3JvbGxQYXJlbnQ6IGZ1bmN0aW9uKCBpbmNsdWRlSGlkZGVuICkge1xuXHRcdHZhciBwb3NpdGlvbiA9IHRoaXMuY3NzKCBcInBvc2l0aW9uXCIgKSxcblx0XHRcdGV4Y2x1ZGVTdGF0aWNQYXJlbnQgPSBwb3NpdGlvbiA9PT0gXCJhYnNvbHV0ZVwiLFxuXHRcdFx0b3ZlcmZsb3dSZWdleCA9IGluY2x1ZGVIaWRkZW4gPyAvKGF1dG98c2Nyb2xsfGhpZGRlbikvIDogLyhhdXRvfHNjcm9sbCkvLFxuXHRcdFx0c2Nyb2xsUGFyZW50ID0gdGhpcy5wYXJlbnRzKCkuZmlsdGVyKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIHBhcmVudCA9ICQoIHRoaXMgKTtcblx0XHRcdFx0aWYgKCBleGNsdWRlU3RhdGljUGFyZW50ICYmIHBhcmVudC5jc3MoIFwicG9zaXRpb25cIiApID09PSBcInN0YXRpY1wiICkge1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gb3ZlcmZsb3dSZWdleC50ZXN0KCBwYXJlbnQuY3NzKCBcIm92ZXJmbG93XCIgKSArIHBhcmVudC5jc3MoIFwib3ZlcmZsb3cteVwiICkgKyBwYXJlbnQuY3NzKCBcIm92ZXJmbG93LXhcIiApICk7XG5cdFx0XHR9KS5lcSggMCApO1xuXG5cdFx0cmV0dXJuIHBvc2l0aW9uID09PSBcImZpeGVkXCIgfHwgIXNjcm9sbFBhcmVudC5sZW5ndGggPyAkKCB0aGlzWyAwIF0ub3duZXJEb2N1bWVudCB8fCBkb2N1bWVudCApIDogc2Nyb2xsUGFyZW50O1xuXHR9LFxuXG5cdHVuaXF1ZUlkOiAoZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHV1aWQgPSAwO1xuXG5cdFx0cmV0dXJuIGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKCAhdGhpcy5pZCApIHtcblx0XHRcdFx0XHR0aGlzLmlkID0gXCJ1aS1pZC1cIiArICggKyt1dWlkICk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH07XG5cdH0pKCksXG5cblx0cmVtb3ZlVW5pcXVlSWQ6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoIC9edWktaWQtXFxkKyQvLnRlc3QoIHRoaXMuaWQgKSApIHtcblx0XHRcdFx0JCggdGhpcyApLnJlbW92ZUF0dHIoIFwiaWRcIiApO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG59KTtcblxuLy8gc2VsZWN0b3JzXG5mdW5jdGlvbiBmb2N1c2FibGUoIGVsZW1lbnQsIGlzVGFiSW5kZXhOb3ROYU4gKSB7XG5cdHZhciBtYXAsIG1hcE5hbWUsIGltZyxcblx0XHRub2RlTmFtZSA9IGVsZW1lbnQubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcblx0aWYgKCBcImFyZWFcIiA9PT0gbm9kZU5hbWUgKSB7XG5cdFx0bWFwID0gZWxlbWVudC5wYXJlbnROb2RlO1xuXHRcdG1hcE5hbWUgPSBtYXAubmFtZTtcblx0XHRpZiAoICFlbGVtZW50LmhyZWYgfHwgIW1hcE5hbWUgfHwgbWFwLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgIT09IFwibWFwXCIgKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHRcdGltZyA9ICQoIFwiaW1nW3VzZW1hcD0nI1wiICsgbWFwTmFtZSArIFwiJ11cIiApWyAwIF07XG5cdFx0cmV0dXJuICEhaW1nICYmIHZpc2libGUoIGltZyApO1xuXHR9XG5cdHJldHVybiAoIC9eKGlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b258b2JqZWN0KSQvLnRlc3QoIG5vZGVOYW1lICkgP1xuXHRcdCFlbGVtZW50LmRpc2FibGVkIDpcblx0XHRcImFcIiA9PT0gbm9kZU5hbWUgP1xuXHRcdFx0ZWxlbWVudC5ocmVmIHx8IGlzVGFiSW5kZXhOb3ROYU4gOlxuXHRcdFx0aXNUYWJJbmRleE5vdE5hTikgJiZcblx0XHQvLyB0aGUgZWxlbWVudCBhbmQgYWxsIG9mIGl0cyBhbmNlc3RvcnMgbXVzdCBiZSB2aXNpYmxlXG5cdFx0dmlzaWJsZSggZWxlbWVudCApO1xufVxuXG5mdW5jdGlvbiB2aXNpYmxlKCBlbGVtZW50ICkge1xuXHRyZXR1cm4gJC5leHByLmZpbHRlcnMudmlzaWJsZSggZWxlbWVudCApICYmXG5cdFx0ISQoIGVsZW1lbnQgKS5wYXJlbnRzKCkuYWRkQmFjaygpLmZpbHRlcihmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiAkLmNzcyggdGhpcywgXCJ2aXNpYmlsaXR5XCIgKSA9PT0gXCJoaWRkZW5cIjtcblx0XHR9KS5sZW5ndGg7XG59XG5cbiQuZXh0ZW5kKCAkLmV4cHJbIFwiOlwiIF0sIHtcblx0ZGF0YTogJC5leHByLmNyZWF0ZVBzZXVkbyA/XG5cdFx0JC5leHByLmNyZWF0ZVBzZXVkbyhmdW5jdGlvbiggZGF0YU5hbWUgKSB7XG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRcdHJldHVybiAhISQuZGF0YSggZWxlbSwgZGF0YU5hbWUgKTtcblx0XHRcdH07XG5cdFx0fSkgOlxuXHRcdC8vIHN1cHBvcnQ6IGpRdWVyeSA8MS44XG5cdFx0ZnVuY3Rpb24oIGVsZW0sIGksIG1hdGNoICkge1xuXHRcdFx0cmV0dXJuICEhJC5kYXRhKCBlbGVtLCBtYXRjaFsgMyBdICk7XG5cdFx0fSxcblxuXHRmb2N1c2FibGU6IGZ1bmN0aW9uKCBlbGVtZW50ICkge1xuXHRcdHJldHVybiBmb2N1c2FibGUoIGVsZW1lbnQsICFpc05hTiggJC5hdHRyKCBlbGVtZW50LCBcInRhYmluZGV4XCIgKSApICk7XG5cdH0sXG5cblx0dGFiYmFibGU6IGZ1bmN0aW9uKCBlbGVtZW50ICkge1xuXHRcdHZhciB0YWJJbmRleCA9ICQuYXR0ciggZWxlbWVudCwgXCJ0YWJpbmRleFwiICksXG5cdFx0XHRpc1RhYkluZGV4TmFOID0gaXNOYU4oIHRhYkluZGV4ICk7XG5cdFx0cmV0dXJuICggaXNUYWJJbmRleE5hTiB8fCB0YWJJbmRleCA+PSAwICkgJiYgZm9jdXNhYmxlKCBlbGVtZW50LCAhaXNUYWJJbmRleE5hTiApO1xuXHR9XG59KTtcblxuLy8gc3VwcG9ydDogalF1ZXJ5IDwxLjhcbmlmICggISQoIFwiPGE+XCIgKS5vdXRlcldpZHRoKCAxICkuanF1ZXJ5ICkge1xuXHQkLmVhY2goIFsgXCJXaWR0aFwiLCBcIkhlaWdodFwiIF0sIGZ1bmN0aW9uKCBpLCBuYW1lICkge1xuXHRcdHZhciBzaWRlID0gbmFtZSA9PT0gXCJXaWR0aFwiID8gWyBcIkxlZnRcIiwgXCJSaWdodFwiIF0gOiBbIFwiVG9wXCIsIFwiQm90dG9tXCIgXSxcblx0XHRcdHR5cGUgPSBuYW1lLnRvTG93ZXJDYXNlKCksXG5cdFx0XHRvcmlnID0ge1xuXHRcdFx0XHRpbm5lcldpZHRoOiAkLmZuLmlubmVyV2lkdGgsXG5cdFx0XHRcdGlubmVySGVpZ2h0OiAkLmZuLmlubmVySGVpZ2h0LFxuXHRcdFx0XHRvdXRlcldpZHRoOiAkLmZuLm91dGVyV2lkdGgsXG5cdFx0XHRcdG91dGVySGVpZ2h0OiAkLmZuLm91dGVySGVpZ2h0XG5cdFx0XHR9O1xuXG5cdFx0ZnVuY3Rpb24gcmVkdWNlKCBlbGVtLCBzaXplLCBib3JkZXIsIG1hcmdpbiApIHtcblx0XHRcdCQuZWFjaCggc2lkZSwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHNpemUgLT0gcGFyc2VGbG9hdCggJC5jc3MoIGVsZW0sIFwicGFkZGluZ1wiICsgdGhpcyApICkgfHwgMDtcblx0XHRcdFx0aWYgKCBib3JkZXIgKSB7XG5cdFx0XHRcdFx0c2l6ZSAtPSBwYXJzZUZsb2F0KCAkLmNzcyggZWxlbSwgXCJib3JkZXJcIiArIHRoaXMgKyBcIldpZHRoXCIgKSApIHx8IDA7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKCBtYXJnaW4gKSB7XG5cdFx0XHRcdFx0c2l6ZSAtPSBwYXJzZUZsb2F0KCAkLmNzcyggZWxlbSwgXCJtYXJnaW5cIiArIHRoaXMgKSApIHx8IDA7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0cmV0dXJuIHNpemU7XG5cdFx0fVxuXG5cdFx0JC5mblsgXCJpbm5lclwiICsgbmFtZSBdID0gZnVuY3Rpb24oIHNpemUgKSB7XG5cdFx0XHRpZiAoIHNpemUgPT09IHVuZGVmaW5lZCApIHtcblx0XHRcdFx0cmV0dXJuIG9yaWdbIFwiaW5uZXJcIiArIG5hbWUgXS5jYWxsKCB0aGlzICk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHRcdCQoIHRoaXMgKS5jc3MoIHR5cGUsIHJlZHVjZSggdGhpcywgc2l6ZSApICsgXCJweFwiICk7XG5cdFx0XHR9KTtcblx0XHR9O1xuXG5cdFx0JC5mblsgXCJvdXRlclwiICsgbmFtZV0gPSBmdW5jdGlvbiggc2l6ZSwgbWFyZ2luICkge1xuXHRcdFx0aWYgKCB0eXBlb2Ygc2l6ZSAhPT0gXCJudW1iZXJcIiApIHtcblx0XHRcdFx0cmV0dXJuIG9yaWdbIFwib3V0ZXJcIiArIG5hbWUgXS5jYWxsKCB0aGlzLCBzaXplICk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHRcdCQoIHRoaXMpLmNzcyggdHlwZSwgcmVkdWNlKCB0aGlzLCBzaXplLCB0cnVlLCBtYXJnaW4gKSArIFwicHhcIiApO1xuXHRcdFx0fSk7XG5cdFx0fTtcblx0fSk7XG59XG5cbi8vIHN1cHBvcnQ6IGpRdWVyeSA8MS44XG5pZiAoICEkLmZuLmFkZEJhY2sgKSB7XG5cdCQuZm4uYWRkQmFjayA9IGZ1bmN0aW9uKCBzZWxlY3RvciApIHtcblx0XHRyZXR1cm4gdGhpcy5hZGQoIHNlbGVjdG9yID09IG51bGwgP1xuXHRcdFx0dGhpcy5wcmV2T2JqZWN0IDogdGhpcy5wcmV2T2JqZWN0LmZpbHRlciggc2VsZWN0b3IgKVxuXHRcdCk7XG5cdH07XG59XG5cbi8vIHN1cHBvcnQ6IGpRdWVyeSAxLjYuMSwgMS42LjIgKGh0dHA6Ly9idWdzLmpxdWVyeS5jb20vdGlja2V0Lzk0MTMpXG5pZiAoICQoIFwiPGE+XCIgKS5kYXRhKCBcImEtYlwiLCBcImFcIiApLnJlbW92ZURhdGEoIFwiYS1iXCIgKS5kYXRhKCBcImEtYlwiICkgKSB7XG5cdCQuZm4ucmVtb3ZlRGF0YSA9IChmdW5jdGlvbiggcmVtb3ZlRGF0YSApIHtcblx0XHRyZXR1cm4gZnVuY3Rpb24oIGtleSApIHtcblx0XHRcdGlmICggYXJndW1lbnRzLmxlbmd0aCApIHtcblx0XHRcdFx0cmV0dXJuIHJlbW92ZURhdGEuY2FsbCggdGhpcywgJC5jYW1lbENhc2UoIGtleSApICk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gcmVtb3ZlRGF0YS5jYWxsKCB0aGlzICk7XG5cdFx0XHR9XG5cdFx0fTtcblx0fSkoICQuZm4ucmVtb3ZlRGF0YSApO1xufVxuXG4vLyBkZXByZWNhdGVkXG4kLnVpLmllID0gISEvbXNpZSBbXFx3Ll0rLy5leGVjKCBuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkgKTtcblxuJC5mbi5leHRlbmQoe1xuXHRmb2N1czogKGZ1bmN0aW9uKCBvcmlnICkge1xuXHRcdHJldHVybiBmdW5jdGlvbiggZGVsYXksIGZuICkge1xuXHRcdFx0cmV0dXJuIHR5cGVvZiBkZWxheSA9PT0gXCJudW1iZXJcIiA/XG5cdFx0XHRcdHRoaXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR2YXIgZWxlbSA9IHRoaXM7XG5cdFx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdCQoIGVsZW0gKS5mb2N1cygpO1xuXHRcdFx0XHRcdFx0aWYgKCBmbiApIHtcblx0XHRcdFx0XHRcdFx0Zm4uY2FsbCggZWxlbSApO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0sIGRlbGF5ICk7XG5cdFx0XHRcdH0pIDpcblx0XHRcdFx0b3JpZy5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XG5cdFx0fTtcblx0fSkoICQuZm4uZm9jdXMgKSxcblxuXHRkaXNhYmxlU2VsZWN0aW9uOiAoZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGV2ZW50VHlwZSA9IFwib25zZWxlY3RzdGFydFwiIGluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIFwiZGl2XCIgKSA/XG5cdFx0XHRcInNlbGVjdHN0YXJ0XCIgOlxuXHRcdFx0XCJtb3VzZWRvd25cIjtcblxuXHRcdHJldHVybiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB0aGlzLmJpbmQoIGV2ZW50VHlwZSArIFwiLnVpLWRpc2FibGVTZWxlY3Rpb25cIiwgZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0fSk7XG5cdFx0fTtcblx0fSkoKSxcblxuXHRlbmFibGVTZWxlY3Rpb246IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLnVuYmluZCggXCIudWktZGlzYWJsZVNlbGVjdGlvblwiICk7XG5cdH0sXG5cblx0ekluZGV4OiBmdW5jdGlvbiggekluZGV4ICkge1xuXHRcdGlmICggekluZGV4ICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5jc3MoIFwiekluZGV4XCIsIHpJbmRleCApO1xuXHRcdH1cblxuXHRcdGlmICggdGhpcy5sZW5ndGggKSB7XG5cdFx0XHR2YXIgZWxlbSA9ICQoIHRoaXNbIDAgXSApLCBwb3NpdGlvbiwgdmFsdWU7XG5cdFx0XHR3aGlsZSAoIGVsZW0ubGVuZ3RoICYmIGVsZW1bIDAgXSAhPT0gZG9jdW1lbnQgKSB7XG5cdFx0XHRcdC8vIElnbm9yZSB6LWluZGV4IGlmIHBvc2l0aW9uIGlzIHNldCB0byBhIHZhbHVlIHdoZXJlIHotaW5kZXggaXMgaWdub3JlZCBieSB0aGUgYnJvd3NlclxuXHRcdFx0XHQvLyBUaGlzIG1ha2VzIGJlaGF2aW9yIG9mIHRoaXMgZnVuY3Rpb24gY29uc2lzdGVudCBhY3Jvc3MgYnJvd3NlcnNcblx0XHRcdFx0Ly8gV2ViS2l0IGFsd2F5cyByZXR1cm5zIGF1dG8gaWYgdGhlIGVsZW1lbnQgaXMgcG9zaXRpb25lZFxuXHRcdFx0XHRwb3NpdGlvbiA9IGVsZW0uY3NzKCBcInBvc2l0aW9uXCIgKTtcblx0XHRcdFx0aWYgKCBwb3NpdGlvbiA9PT0gXCJhYnNvbHV0ZVwiIHx8IHBvc2l0aW9uID09PSBcInJlbGF0aXZlXCIgfHwgcG9zaXRpb24gPT09IFwiZml4ZWRcIiApIHtcblx0XHRcdFx0XHQvLyBJRSByZXR1cm5zIDAgd2hlbiB6SW5kZXggaXMgbm90IHNwZWNpZmllZFxuXHRcdFx0XHRcdC8vIG90aGVyIGJyb3dzZXJzIHJldHVybiBhIHN0cmluZ1xuXHRcdFx0XHRcdC8vIHdlIGlnbm9yZSB0aGUgY2FzZSBvZiBuZXN0ZWQgZWxlbWVudHMgd2l0aCBhbiBleHBsaWNpdCB2YWx1ZSBvZiAwXG5cdFx0XHRcdFx0Ly8gPGRpdiBzdHlsZT1cInotaW5kZXg6IC0xMDtcIj48ZGl2IHN0eWxlPVwiei1pbmRleDogMDtcIj48L2Rpdj48L2Rpdj5cblx0XHRcdFx0XHR2YWx1ZSA9IHBhcnNlSW50KCBlbGVtLmNzcyggXCJ6SW5kZXhcIiApLCAxMCApO1xuXHRcdFx0XHRcdGlmICggIWlzTmFOKCB2YWx1ZSApICYmIHZhbHVlICE9PSAwICkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRlbGVtID0gZWxlbS5wYXJlbnQoKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gMDtcblx0fVxufSk7XG5cbi8vICQudWkucGx1Z2luIGlzIGRlcHJlY2F0ZWQuIFVzZSAkLndpZGdldCgpIGV4dGVuc2lvbnMgaW5zdGVhZC5cbiQudWkucGx1Z2luID0ge1xuXHRhZGQ6IGZ1bmN0aW9uKCBtb2R1bGUsIG9wdGlvbiwgc2V0ICkge1xuXHRcdHZhciBpLFxuXHRcdFx0cHJvdG8gPSAkLnVpWyBtb2R1bGUgXS5wcm90b3R5cGU7XG5cdFx0Zm9yICggaSBpbiBzZXQgKSB7XG5cdFx0XHRwcm90by5wbHVnaW5zWyBpIF0gPSBwcm90by5wbHVnaW5zWyBpIF0gfHwgW107XG5cdFx0XHRwcm90by5wbHVnaW5zWyBpIF0ucHVzaCggWyBvcHRpb24sIHNldFsgaSBdIF0gKTtcblx0XHR9XG5cdH0sXG5cdGNhbGw6IGZ1bmN0aW9uKCBpbnN0YW5jZSwgbmFtZSwgYXJncywgYWxsb3dEaXNjb25uZWN0ZWQgKSB7XG5cdFx0dmFyIGksXG5cdFx0XHRzZXQgPSBpbnN0YW5jZS5wbHVnaW5zWyBuYW1lIF07XG5cblx0XHRpZiAoICFzZXQgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKCAhYWxsb3dEaXNjb25uZWN0ZWQgJiYgKCAhaW5zdGFuY2UuZWxlbWVudFsgMCBdLnBhcmVudE5vZGUgfHwgaW5zdGFuY2UuZWxlbWVudFsgMCBdLnBhcmVudE5vZGUubm9kZVR5cGUgPT09IDExICkgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Zm9yICggaSA9IDA7IGkgPCBzZXQubGVuZ3RoOyBpKysgKSB7XG5cdFx0XHRpZiAoIGluc3RhbmNlLm9wdGlvbnNbIHNldFsgaSBdWyAwIF0gXSApIHtcblx0XHRcdFx0c2V0WyBpIF1bIDEgXS5hcHBseSggaW5zdGFuY2UuZWxlbWVudCwgYXJncyApO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufTtcblxuXG4vKiFcbiAqIGpRdWVyeSBVSSBXaWRnZXQgMS4xMS40XG4gKiBodHRwOi8vanF1ZXJ5dWkuY29tXG4gKlxuICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnNcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2VcbiAqXG4gKiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9qUXVlcnkud2lkZ2V0L1xuICovXG5cblxudmFyIHdpZGdldF91dWlkID0gMCxcblx0d2lkZ2V0X3NsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlO1xuXG4kLmNsZWFuRGF0YSA9IChmdW5jdGlvbiggb3JpZyApIHtcblx0cmV0dXJuIGZ1bmN0aW9uKCBlbGVtcyApIHtcblx0XHR2YXIgZXZlbnRzLCBlbGVtLCBpO1xuXHRcdGZvciAoIGkgPSAwOyAoZWxlbSA9IGVsZW1zW2ldKSAhPSBudWxsOyBpKysgKSB7XG5cdFx0XHR0cnkge1xuXG5cdFx0XHRcdC8vIE9ubHkgdHJpZ2dlciByZW1vdmUgd2hlbiBuZWNlc3NhcnkgdG8gc2F2ZSB0aW1lXG5cdFx0XHRcdGV2ZW50cyA9ICQuX2RhdGEoIGVsZW0sIFwiZXZlbnRzXCIgKTtcblx0XHRcdFx0aWYgKCBldmVudHMgJiYgZXZlbnRzLnJlbW92ZSApIHtcblx0XHRcdFx0XHQkKCBlbGVtICkudHJpZ2dlckhhbmRsZXIoIFwicmVtb3ZlXCIgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHQvLyBodHRwOi8vYnVncy5qcXVlcnkuY29tL3RpY2tldC84MjM1XG5cdFx0XHR9IGNhdGNoICggZSApIHt9XG5cdFx0fVxuXHRcdG9yaWcoIGVsZW1zICk7XG5cdH07XG59KSggJC5jbGVhbkRhdGEgKTtcblxuJC53aWRnZXQgPSBmdW5jdGlvbiggbmFtZSwgYmFzZSwgcHJvdG90eXBlICkge1xuXHR2YXIgZnVsbE5hbWUsIGV4aXN0aW5nQ29uc3RydWN0b3IsIGNvbnN0cnVjdG9yLCBiYXNlUHJvdG90eXBlLFxuXHRcdC8vIHByb3hpZWRQcm90b3R5cGUgYWxsb3dzIHRoZSBwcm92aWRlZCBwcm90b3R5cGUgdG8gcmVtYWluIHVubW9kaWZpZWRcblx0XHQvLyBzbyB0aGF0IGl0IGNhbiBiZSB1c2VkIGFzIGEgbWl4aW4gZm9yIG11bHRpcGxlIHdpZGdldHMgKCM4ODc2KVxuXHRcdHByb3hpZWRQcm90b3R5cGUgPSB7fSxcblx0XHRuYW1lc3BhY2UgPSBuYW1lLnNwbGl0KCBcIi5cIiApWyAwIF07XG5cblx0bmFtZSA9IG5hbWUuc3BsaXQoIFwiLlwiIClbIDEgXTtcblx0ZnVsbE5hbWUgPSBuYW1lc3BhY2UgKyBcIi1cIiArIG5hbWU7XG5cblx0aWYgKCAhcHJvdG90eXBlICkge1xuXHRcdHByb3RvdHlwZSA9IGJhc2U7XG5cdFx0YmFzZSA9ICQuV2lkZ2V0O1xuXHR9XG5cblx0Ly8gY3JlYXRlIHNlbGVjdG9yIGZvciBwbHVnaW5cblx0JC5leHByWyBcIjpcIiBdWyBmdWxsTmFtZS50b0xvd2VyQ2FzZSgpIF0gPSBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRyZXR1cm4gISEkLmRhdGEoIGVsZW0sIGZ1bGxOYW1lICk7XG5cdH07XG5cblx0JFsgbmFtZXNwYWNlIF0gPSAkWyBuYW1lc3BhY2UgXSB8fCB7fTtcblx0ZXhpc3RpbmdDb25zdHJ1Y3RvciA9ICRbIG5hbWVzcGFjZSBdWyBuYW1lIF07XG5cdGNvbnN0cnVjdG9yID0gJFsgbmFtZXNwYWNlIF1bIG5hbWUgXSA9IGZ1bmN0aW9uKCBvcHRpb25zLCBlbGVtZW50ICkge1xuXHRcdC8vIGFsbG93IGluc3RhbnRpYXRpb24gd2l0aG91dCBcIm5ld1wiIGtleXdvcmRcblx0XHRpZiAoICF0aGlzLl9jcmVhdGVXaWRnZXQgKSB7XG5cdFx0XHRyZXR1cm4gbmV3IGNvbnN0cnVjdG9yKCBvcHRpb25zLCBlbGVtZW50ICk7XG5cdFx0fVxuXG5cdFx0Ly8gYWxsb3cgaW5zdGFudGlhdGlvbiB3aXRob3V0IGluaXRpYWxpemluZyBmb3Igc2ltcGxlIGluaGVyaXRhbmNlXG5cdFx0Ly8gbXVzdCB1c2UgXCJuZXdcIiBrZXl3b3JkICh0aGUgY29kZSBhYm92ZSBhbHdheXMgcGFzc2VzIGFyZ3MpXG5cdFx0aWYgKCBhcmd1bWVudHMubGVuZ3RoICkge1xuXHRcdFx0dGhpcy5fY3JlYXRlV2lkZ2V0KCBvcHRpb25zLCBlbGVtZW50ICk7XG5cdFx0fVxuXHR9O1xuXHQvLyBleHRlbmQgd2l0aCB0aGUgZXhpc3RpbmcgY29uc3RydWN0b3IgdG8gY2Fycnkgb3ZlciBhbnkgc3RhdGljIHByb3BlcnRpZXNcblx0JC5leHRlbmQoIGNvbnN0cnVjdG9yLCBleGlzdGluZ0NvbnN0cnVjdG9yLCB7XG5cdFx0dmVyc2lvbjogcHJvdG90eXBlLnZlcnNpb24sXG5cdFx0Ly8gY29weSB0aGUgb2JqZWN0IHVzZWQgdG8gY3JlYXRlIHRoZSBwcm90b3R5cGUgaW4gY2FzZSB3ZSBuZWVkIHRvXG5cdFx0Ly8gcmVkZWZpbmUgdGhlIHdpZGdldCBsYXRlclxuXHRcdF9wcm90bzogJC5leHRlbmQoIHt9LCBwcm90b3R5cGUgKSxcblx0XHQvLyB0cmFjayB3aWRnZXRzIHRoYXQgaW5oZXJpdCBmcm9tIHRoaXMgd2lkZ2V0IGluIGNhc2UgdGhpcyB3aWRnZXQgaXNcblx0XHQvLyByZWRlZmluZWQgYWZ0ZXIgYSB3aWRnZXQgaW5oZXJpdHMgZnJvbSBpdFxuXHRcdF9jaGlsZENvbnN0cnVjdG9yczogW11cblx0fSk7XG5cblx0YmFzZVByb3RvdHlwZSA9IG5ldyBiYXNlKCk7XG5cdC8vIHdlIG5lZWQgdG8gbWFrZSB0aGUgb3B0aW9ucyBoYXNoIGEgcHJvcGVydHkgZGlyZWN0bHkgb24gdGhlIG5ldyBpbnN0YW5jZVxuXHQvLyBvdGhlcndpc2Ugd2UnbGwgbW9kaWZ5IHRoZSBvcHRpb25zIGhhc2ggb24gdGhlIHByb3RvdHlwZSB0aGF0IHdlJ3JlXG5cdC8vIGluaGVyaXRpbmcgZnJvbVxuXHRiYXNlUHJvdG90eXBlLm9wdGlvbnMgPSAkLndpZGdldC5leHRlbmQoIHt9LCBiYXNlUHJvdG90eXBlLm9wdGlvbnMgKTtcblx0JC5lYWNoKCBwcm90b3R5cGUsIGZ1bmN0aW9uKCBwcm9wLCB2YWx1ZSApIHtcblx0XHRpZiAoICEkLmlzRnVuY3Rpb24oIHZhbHVlICkgKSB7XG5cdFx0XHRwcm94aWVkUHJvdG90eXBlWyBwcm9wIF0gPSB2YWx1ZTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0cHJveGllZFByb3RvdHlwZVsgcHJvcCBdID0gKGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIF9zdXBlciA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHJldHVybiBiYXNlLnByb3RvdHlwZVsgcHJvcCBdLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTtcblx0XHRcdFx0fSxcblx0XHRcdFx0X3N1cGVyQXBwbHkgPSBmdW5jdGlvbiggYXJncyApIHtcblx0XHRcdFx0XHRyZXR1cm4gYmFzZS5wcm90b3R5cGVbIHByb3AgXS5hcHBseSggdGhpcywgYXJncyApO1xuXHRcdFx0XHR9O1xuXHRcdFx0cmV0dXJuIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgX19zdXBlciA9IHRoaXMuX3N1cGVyLFxuXHRcdFx0XHRcdF9fc3VwZXJBcHBseSA9IHRoaXMuX3N1cGVyQXBwbHksXG5cdFx0XHRcdFx0cmV0dXJuVmFsdWU7XG5cblx0XHRcdFx0dGhpcy5fc3VwZXIgPSBfc3VwZXI7XG5cdFx0XHRcdHRoaXMuX3N1cGVyQXBwbHkgPSBfc3VwZXJBcHBseTtcblxuXHRcdFx0XHRyZXR1cm5WYWx1ZSA9IHZhbHVlLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTtcblxuXHRcdFx0XHR0aGlzLl9zdXBlciA9IF9fc3VwZXI7XG5cdFx0XHRcdHRoaXMuX3N1cGVyQXBwbHkgPSBfX3N1cGVyQXBwbHk7XG5cblx0XHRcdFx0cmV0dXJuIHJldHVyblZhbHVlO1xuXHRcdFx0fTtcblx0XHR9KSgpO1xuXHR9KTtcblx0Y29uc3RydWN0b3IucHJvdG90eXBlID0gJC53aWRnZXQuZXh0ZW5kKCBiYXNlUHJvdG90eXBlLCB7XG5cdFx0Ly8gVE9ETzogcmVtb3ZlIHN1cHBvcnQgZm9yIHdpZGdldEV2ZW50UHJlZml4XG5cdFx0Ly8gYWx3YXlzIHVzZSB0aGUgbmFtZSArIGEgY29sb24gYXMgdGhlIHByZWZpeCwgZS5nLiwgZHJhZ2dhYmxlOnN0YXJ0XG5cdFx0Ly8gZG9uJ3QgcHJlZml4IGZvciB3aWRnZXRzIHRoYXQgYXJlbid0IERPTS1iYXNlZFxuXHRcdHdpZGdldEV2ZW50UHJlZml4OiBleGlzdGluZ0NvbnN0cnVjdG9yID8gKGJhc2VQcm90b3R5cGUud2lkZ2V0RXZlbnRQcmVmaXggfHwgbmFtZSkgOiBuYW1lXG5cdH0sIHByb3hpZWRQcm90b3R5cGUsIHtcblx0XHRjb25zdHJ1Y3RvcjogY29uc3RydWN0b3IsXG5cdFx0bmFtZXNwYWNlOiBuYW1lc3BhY2UsXG5cdFx0d2lkZ2V0TmFtZTogbmFtZSxcblx0XHR3aWRnZXRGdWxsTmFtZTogZnVsbE5hbWVcblx0fSk7XG5cblx0Ly8gSWYgdGhpcyB3aWRnZXQgaXMgYmVpbmcgcmVkZWZpbmVkIHRoZW4gd2UgbmVlZCB0byBmaW5kIGFsbCB3aWRnZXRzIHRoYXRcblx0Ly8gYXJlIGluaGVyaXRpbmcgZnJvbSBpdCBhbmQgcmVkZWZpbmUgYWxsIG9mIHRoZW0gc28gdGhhdCB0aGV5IGluaGVyaXQgZnJvbVxuXHQvLyB0aGUgbmV3IHZlcnNpb24gb2YgdGhpcyB3aWRnZXQuIFdlJ3JlIGVzc2VudGlhbGx5IHRyeWluZyB0byByZXBsYWNlIG9uZVxuXHQvLyBsZXZlbCBpbiB0aGUgcHJvdG90eXBlIGNoYWluLlxuXHRpZiAoIGV4aXN0aW5nQ29uc3RydWN0b3IgKSB7XG5cdFx0JC5lYWNoKCBleGlzdGluZ0NvbnN0cnVjdG9yLl9jaGlsZENvbnN0cnVjdG9ycywgZnVuY3Rpb24oIGksIGNoaWxkICkge1xuXHRcdFx0dmFyIGNoaWxkUHJvdG90eXBlID0gY2hpbGQucHJvdG90eXBlO1xuXG5cdFx0XHQvLyByZWRlZmluZSB0aGUgY2hpbGQgd2lkZ2V0IHVzaW5nIHRoZSBzYW1lIHByb3RvdHlwZSB0aGF0IHdhc1xuXHRcdFx0Ly8gb3JpZ2luYWxseSB1c2VkLCBidXQgaW5oZXJpdCBmcm9tIHRoZSBuZXcgdmVyc2lvbiBvZiB0aGUgYmFzZVxuXHRcdFx0JC53aWRnZXQoIGNoaWxkUHJvdG90eXBlLm5hbWVzcGFjZSArIFwiLlwiICsgY2hpbGRQcm90b3R5cGUud2lkZ2V0TmFtZSwgY29uc3RydWN0b3IsIGNoaWxkLl9wcm90byApO1xuXHRcdH0pO1xuXHRcdC8vIHJlbW92ZSB0aGUgbGlzdCBvZiBleGlzdGluZyBjaGlsZCBjb25zdHJ1Y3RvcnMgZnJvbSB0aGUgb2xkIGNvbnN0cnVjdG9yXG5cdFx0Ly8gc28gdGhlIG9sZCBjaGlsZCBjb25zdHJ1Y3RvcnMgY2FuIGJlIGdhcmJhZ2UgY29sbGVjdGVkXG5cdFx0ZGVsZXRlIGV4aXN0aW5nQ29uc3RydWN0b3IuX2NoaWxkQ29uc3RydWN0b3JzO1xuXHR9IGVsc2Uge1xuXHRcdGJhc2UuX2NoaWxkQ29uc3RydWN0b3JzLnB1c2goIGNvbnN0cnVjdG9yICk7XG5cdH1cblxuXHQkLndpZGdldC5icmlkZ2UoIG5hbWUsIGNvbnN0cnVjdG9yICk7XG5cblx0cmV0dXJuIGNvbnN0cnVjdG9yO1xufTtcblxuJC53aWRnZXQuZXh0ZW5kID0gZnVuY3Rpb24oIHRhcmdldCApIHtcblx0dmFyIGlucHV0ID0gd2lkZ2V0X3NsaWNlLmNhbGwoIGFyZ3VtZW50cywgMSApLFxuXHRcdGlucHV0SW5kZXggPSAwLFxuXHRcdGlucHV0TGVuZ3RoID0gaW5wdXQubGVuZ3RoLFxuXHRcdGtleSxcblx0XHR2YWx1ZTtcblx0Zm9yICggOyBpbnB1dEluZGV4IDwgaW5wdXRMZW5ndGg7IGlucHV0SW5kZXgrKyApIHtcblx0XHRmb3IgKCBrZXkgaW4gaW5wdXRbIGlucHV0SW5kZXggXSApIHtcblx0XHRcdHZhbHVlID0gaW5wdXRbIGlucHV0SW5kZXggXVsga2V5IF07XG5cdFx0XHRpZiAoIGlucHV0WyBpbnB1dEluZGV4IF0uaGFzT3duUHJvcGVydHkoIGtleSApICYmIHZhbHVlICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRcdC8vIENsb25lIG9iamVjdHNcblx0XHRcdFx0aWYgKCAkLmlzUGxhaW5PYmplY3QoIHZhbHVlICkgKSB7XG5cdFx0XHRcdFx0dGFyZ2V0WyBrZXkgXSA9ICQuaXNQbGFpbk9iamVjdCggdGFyZ2V0WyBrZXkgXSApID9cblx0XHRcdFx0XHRcdCQud2lkZ2V0LmV4dGVuZCgge30sIHRhcmdldFsga2V5IF0sIHZhbHVlICkgOlxuXHRcdFx0XHRcdFx0Ly8gRG9uJ3QgZXh0ZW5kIHN0cmluZ3MsIGFycmF5cywgZXRjLiB3aXRoIG9iamVjdHNcblx0XHRcdFx0XHRcdCQud2lkZ2V0LmV4dGVuZCgge30sIHZhbHVlICk7XG5cdFx0XHRcdC8vIENvcHkgZXZlcnl0aGluZyBlbHNlIGJ5IHJlZmVyZW5jZVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRhcmdldFsga2V5IF0gPSB2YWx1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRyZXR1cm4gdGFyZ2V0O1xufTtcblxuJC53aWRnZXQuYnJpZGdlID0gZnVuY3Rpb24oIG5hbWUsIG9iamVjdCApIHtcblx0dmFyIGZ1bGxOYW1lID0gb2JqZWN0LnByb3RvdHlwZS53aWRnZXRGdWxsTmFtZSB8fCBuYW1lO1xuXHQkLmZuWyBuYW1lIF0gPSBmdW5jdGlvbiggb3B0aW9ucyApIHtcblx0XHR2YXIgaXNNZXRob2RDYWxsID0gdHlwZW9mIG9wdGlvbnMgPT09IFwic3RyaW5nXCIsXG5cdFx0XHRhcmdzID0gd2lkZ2V0X3NsaWNlLmNhbGwoIGFyZ3VtZW50cywgMSApLFxuXHRcdFx0cmV0dXJuVmFsdWUgPSB0aGlzO1xuXG5cdFx0aWYgKCBpc01ldGhvZENhbGwgKSB7XG5cdFx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBtZXRob2RWYWx1ZSxcblx0XHRcdFx0XHRpbnN0YW5jZSA9ICQuZGF0YSggdGhpcywgZnVsbE5hbWUgKTtcblx0XHRcdFx0aWYgKCBvcHRpb25zID09PSBcImluc3RhbmNlXCIgKSB7XG5cdFx0XHRcdFx0cmV0dXJuVmFsdWUgPSBpbnN0YW5jZTtcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKCAhaW5zdGFuY2UgKSB7XG5cdFx0XHRcdFx0cmV0dXJuICQuZXJyb3IoIFwiY2Fubm90IGNhbGwgbWV0aG9kcyBvbiBcIiArIG5hbWUgKyBcIiBwcmlvciB0byBpbml0aWFsaXphdGlvbjsgXCIgK1xuXHRcdFx0XHRcdFx0XCJhdHRlbXB0ZWQgdG8gY2FsbCBtZXRob2QgJ1wiICsgb3B0aW9ucyArIFwiJ1wiICk7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKCAhJC5pc0Z1bmN0aW9uKCBpbnN0YW5jZVtvcHRpb25zXSApIHx8IG9wdGlvbnMuY2hhckF0KCAwICkgPT09IFwiX1wiICkge1xuXHRcdFx0XHRcdHJldHVybiAkLmVycm9yKCBcIm5vIHN1Y2ggbWV0aG9kICdcIiArIG9wdGlvbnMgKyBcIicgZm9yIFwiICsgbmFtZSArIFwiIHdpZGdldCBpbnN0YW5jZVwiICk7XG5cdFx0XHRcdH1cblx0XHRcdFx0bWV0aG9kVmFsdWUgPSBpbnN0YW5jZVsgb3B0aW9ucyBdLmFwcGx5KCBpbnN0YW5jZSwgYXJncyApO1xuXHRcdFx0XHRpZiAoIG1ldGhvZFZhbHVlICE9PSBpbnN0YW5jZSAmJiBtZXRob2RWYWx1ZSAhPT0gdW5kZWZpbmVkICkge1xuXHRcdFx0XHRcdHJldHVyblZhbHVlID0gbWV0aG9kVmFsdWUgJiYgbWV0aG9kVmFsdWUuanF1ZXJ5ID9cblx0XHRcdFx0XHRcdHJldHVyblZhbHVlLnB1c2hTdGFjayggbWV0aG9kVmFsdWUuZ2V0KCkgKSA6XG5cdFx0XHRcdFx0XHRtZXRob2RWYWx1ZTtcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0gZWxzZSB7XG5cblx0XHRcdC8vIEFsbG93IG11bHRpcGxlIGhhc2hlcyB0byBiZSBwYXNzZWQgb24gaW5pdFxuXHRcdFx0aWYgKCBhcmdzLmxlbmd0aCApIHtcblx0XHRcdFx0b3B0aW9ucyA9ICQud2lkZ2V0LmV4dGVuZC5hcHBseSggbnVsbCwgWyBvcHRpb25zIF0uY29uY2F0KGFyZ3MpICk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIGluc3RhbmNlID0gJC5kYXRhKCB0aGlzLCBmdWxsTmFtZSApO1xuXHRcdFx0XHRpZiAoIGluc3RhbmNlICkge1xuXHRcdFx0XHRcdGluc3RhbmNlLm9wdGlvbiggb3B0aW9ucyB8fCB7fSApO1xuXHRcdFx0XHRcdGlmICggaW5zdGFuY2UuX2luaXQgKSB7XG5cdFx0XHRcdFx0XHRpbnN0YW5jZS5faW5pdCgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQkLmRhdGEoIHRoaXMsIGZ1bGxOYW1lLCBuZXcgb2JqZWN0KCBvcHRpb25zLCB0aGlzICkgKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHJldHVyblZhbHVlO1xuXHR9O1xufTtcblxuJC5XaWRnZXQgPSBmdW5jdGlvbiggLyogb3B0aW9ucywgZWxlbWVudCAqLyApIHt9O1xuJC5XaWRnZXQuX2NoaWxkQ29uc3RydWN0b3JzID0gW107XG5cbiQuV2lkZ2V0LnByb3RvdHlwZSA9IHtcblx0d2lkZ2V0TmFtZTogXCJ3aWRnZXRcIixcblx0d2lkZ2V0RXZlbnRQcmVmaXg6IFwiXCIsXG5cdGRlZmF1bHRFbGVtZW50OiBcIjxkaXY+XCIsXG5cdG9wdGlvbnM6IHtcblx0XHRkaXNhYmxlZDogZmFsc2UsXG5cblx0XHQvLyBjYWxsYmFja3Ncblx0XHRjcmVhdGU6IG51bGxcblx0fSxcblx0X2NyZWF0ZVdpZGdldDogZnVuY3Rpb24oIG9wdGlvbnMsIGVsZW1lbnQgKSB7XG5cdFx0ZWxlbWVudCA9ICQoIGVsZW1lbnQgfHwgdGhpcy5kZWZhdWx0RWxlbWVudCB8fCB0aGlzIClbIDAgXTtcblx0XHR0aGlzLmVsZW1lbnQgPSAkKCBlbGVtZW50ICk7XG5cdFx0dGhpcy51dWlkID0gd2lkZ2V0X3V1aWQrKztcblx0XHR0aGlzLmV2ZW50TmFtZXNwYWNlID0gXCIuXCIgKyB0aGlzLndpZGdldE5hbWUgKyB0aGlzLnV1aWQ7XG5cblx0XHR0aGlzLmJpbmRpbmdzID0gJCgpO1xuXHRcdHRoaXMuaG92ZXJhYmxlID0gJCgpO1xuXHRcdHRoaXMuZm9jdXNhYmxlID0gJCgpO1xuXG5cdFx0aWYgKCBlbGVtZW50ICE9PSB0aGlzICkge1xuXHRcdFx0JC5kYXRhKCBlbGVtZW50LCB0aGlzLndpZGdldEZ1bGxOYW1lLCB0aGlzICk7XG5cdFx0XHR0aGlzLl9vbiggdHJ1ZSwgdGhpcy5lbGVtZW50LCB7XG5cdFx0XHRcdHJlbW92ZTogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHRcdGlmICggZXZlbnQudGFyZ2V0ID09PSBlbGVtZW50ICkge1xuXHRcdFx0XHRcdFx0dGhpcy5kZXN0cm95KCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdHRoaXMuZG9jdW1lbnQgPSAkKCBlbGVtZW50LnN0eWxlID9cblx0XHRcdFx0Ly8gZWxlbWVudCB3aXRoaW4gdGhlIGRvY3VtZW50XG5cdFx0XHRcdGVsZW1lbnQub3duZXJEb2N1bWVudCA6XG5cdFx0XHRcdC8vIGVsZW1lbnQgaXMgd2luZG93IG9yIGRvY3VtZW50XG5cdFx0XHRcdGVsZW1lbnQuZG9jdW1lbnQgfHwgZWxlbWVudCApO1xuXHRcdFx0dGhpcy53aW5kb3cgPSAkKCB0aGlzLmRvY3VtZW50WzBdLmRlZmF1bHRWaWV3IHx8IHRoaXMuZG9jdW1lbnRbMF0ucGFyZW50V2luZG93ICk7XG5cdFx0fVxuXG5cdFx0dGhpcy5vcHRpb25zID0gJC53aWRnZXQuZXh0ZW5kKCB7fSxcblx0XHRcdHRoaXMub3B0aW9ucyxcblx0XHRcdHRoaXMuX2dldENyZWF0ZU9wdGlvbnMoKSxcblx0XHRcdG9wdGlvbnMgKTtcblxuXHRcdHRoaXMuX2NyZWF0ZSgpO1xuXHRcdHRoaXMuX3RyaWdnZXIoIFwiY3JlYXRlXCIsIG51bGwsIHRoaXMuX2dldENyZWF0ZUV2ZW50RGF0YSgpICk7XG5cdFx0dGhpcy5faW5pdCgpO1xuXHR9LFxuXHRfZ2V0Q3JlYXRlT3B0aW9uczogJC5ub29wLFxuXHRfZ2V0Q3JlYXRlRXZlbnREYXRhOiAkLm5vb3AsXG5cdF9jcmVhdGU6ICQubm9vcCxcblx0X2luaXQ6ICQubm9vcCxcblxuXHRkZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl9kZXN0cm95KCk7XG5cdFx0Ly8gd2UgY2FuIHByb2JhYmx5IHJlbW92ZSB0aGUgdW5iaW5kIGNhbGxzIGluIDIuMFxuXHRcdC8vIGFsbCBldmVudCBiaW5kaW5ncyBzaG91bGQgZ28gdGhyb3VnaCB0aGlzLl9vbigpXG5cdFx0dGhpcy5lbGVtZW50XG5cdFx0XHQudW5iaW5kKCB0aGlzLmV2ZW50TmFtZXNwYWNlIClcblx0XHRcdC5yZW1vdmVEYXRhKCB0aGlzLndpZGdldEZ1bGxOYW1lIClcblx0XHRcdC8vIHN1cHBvcnQ6IGpxdWVyeSA8MS42LjNcblx0XHRcdC8vIGh0dHA6Ly9idWdzLmpxdWVyeS5jb20vdGlja2V0Lzk0MTNcblx0XHRcdC5yZW1vdmVEYXRhKCAkLmNhbWVsQ2FzZSggdGhpcy53aWRnZXRGdWxsTmFtZSApICk7XG5cdFx0dGhpcy53aWRnZXQoKVxuXHRcdFx0LnVuYmluZCggdGhpcy5ldmVudE5hbWVzcGFjZSApXG5cdFx0XHQucmVtb3ZlQXR0ciggXCJhcmlhLWRpc2FibGVkXCIgKVxuXHRcdFx0LnJlbW92ZUNsYXNzKFxuXHRcdFx0XHR0aGlzLndpZGdldEZ1bGxOYW1lICsgXCItZGlzYWJsZWQgXCIgK1xuXHRcdFx0XHRcInVpLXN0YXRlLWRpc2FibGVkXCIgKTtcblxuXHRcdC8vIGNsZWFuIHVwIGV2ZW50cyBhbmQgc3RhdGVzXG5cdFx0dGhpcy5iaW5kaW5ncy51bmJpbmQoIHRoaXMuZXZlbnROYW1lc3BhY2UgKTtcblx0XHR0aGlzLmhvdmVyYWJsZS5yZW1vdmVDbGFzcyggXCJ1aS1zdGF0ZS1ob3ZlclwiICk7XG5cdFx0dGhpcy5mb2N1c2FibGUucmVtb3ZlQ2xhc3MoIFwidWktc3RhdGUtZm9jdXNcIiApO1xuXHR9LFxuXHRfZGVzdHJveTogJC5ub29wLFxuXG5cdHdpZGdldDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuZWxlbWVudDtcblx0fSxcblxuXHRvcHRpb246IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkge1xuXHRcdHZhciBvcHRpb25zID0ga2V5LFxuXHRcdFx0cGFydHMsXG5cdFx0XHRjdXJPcHRpb24sXG5cdFx0XHRpO1xuXG5cdFx0aWYgKCBhcmd1bWVudHMubGVuZ3RoID09PSAwICkge1xuXHRcdFx0Ly8gZG9uJ3QgcmV0dXJuIGEgcmVmZXJlbmNlIHRvIHRoZSBpbnRlcm5hbCBoYXNoXG5cdFx0XHRyZXR1cm4gJC53aWRnZXQuZXh0ZW5kKCB7fSwgdGhpcy5vcHRpb25zICk7XG5cdFx0fVxuXG5cdFx0aWYgKCB0eXBlb2Yga2V5ID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0Ly8gaGFuZGxlIG5lc3RlZCBrZXlzLCBlLmcuLCBcImZvby5iYXJcIiA9PiB7IGZvbzogeyBiYXI6IF9fXyB9IH1cblx0XHRcdG9wdGlvbnMgPSB7fTtcblx0XHRcdHBhcnRzID0ga2V5LnNwbGl0KCBcIi5cIiApO1xuXHRcdFx0a2V5ID0gcGFydHMuc2hpZnQoKTtcblx0XHRcdGlmICggcGFydHMubGVuZ3RoICkge1xuXHRcdFx0XHRjdXJPcHRpb24gPSBvcHRpb25zWyBrZXkgXSA9ICQud2lkZ2V0LmV4dGVuZCgge30sIHRoaXMub3B0aW9uc1sga2V5IF0gKTtcblx0XHRcdFx0Zm9yICggaSA9IDA7IGkgPCBwYXJ0cy5sZW5ndGggLSAxOyBpKysgKSB7XG5cdFx0XHRcdFx0Y3VyT3B0aW9uWyBwYXJ0c1sgaSBdIF0gPSBjdXJPcHRpb25bIHBhcnRzWyBpIF0gXSB8fCB7fTtcblx0XHRcdFx0XHRjdXJPcHRpb24gPSBjdXJPcHRpb25bIHBhcnRzWyBpIF0gXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRrZXkgPSBwYXJ0cy5wb3AoKTtcblx0XHRcdFx0aWYgKCBhcmd1bWVudHMubGVuZ3RoID09PSAxICkge1xuXHRcdFx0XHRcdHJldHVybiBjdXJPcHRpb25bIGtleSBdID09PSB1bmRlZmluZWQgPyBudWxsIDogY3VyT3B0aW9uWyBrZXkgXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRjdXJPcHRpb25bIGtleSBdID0gdmFsdWU7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAoIGFyZ3VtZW50cy5sZW5ndGggPT09IDEgKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXMub3B0aW9uc1sga2V5IF0gPT09IHVuZGVmaW5lZCA/IG51bGwgOiB0aGlzLm9wdGlvbnNbIGtleSBdO1xuXHRcdFx0XHR9XG5cdFx0XHRcdG9wdGlvbnNbIGtleSBdID0gdmFsdWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dGhpcy5fc2V0T3B0aW9ucyggb3B0aW9ucyApO1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cdF9zZXRPcHRpb25zOiBmdW5jdGlvbiggb3B0aW9ucyApIHtcblx0XHR2YXIga2V5O1xuXG5cdFx0Zm9yICgga2V5IGluIG9wdGlvbnMgKSB7XG5cdFx0XHR0aGlzLl9zZXRPcHRpb24oIGtleSwgb3B0aW9uc1sga2V5IF0gKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblx0X3NldE9wdGlvbjogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7XG5cdFx0dGhpcy5vcHRpb25zWyBrZXkgXSA9IHZhbHVlO1xuXG5cdFx0aWYgKCBrZXkgPT09IFwiZGlzYWJsZWRcIiApIHtcblx0XHRcdHRoaXMud2lkZ2V0KClcblx0XHRcdFx0LnRvZ2dsZUNsYXNzKCB0aGlzLndpZGdldEZ1bGxOYW1lICsgXCItZGlzYWJsZWRcIiwgISF2YWx1ZSApO1xuXG5cdFx0XHQvLyBJZiB0aGUgd2lkZ2V0IGlzIGJlY29taW5nIGRpc2FibGVkLCB0aGVuIG5vdGhpbmcgaXMgaW50ZXJhY3RpdmVcblx0XHRcdGlmICggdmFsdWUgKSB7XG5cdFx0XHRcdHRoaXMuaG92ZXJhYmxlLnJlbW92ZUNsYXNzKCBcInVpLXN0YXRlLWhvdmVyXCIgKTtcblx0XHRcdFx0dGhpcy5mb2N1c2FibGUucmVtb3ZlQ2xhc3MoIFwidWktc3RhdGUtZm9jdXNcIiApO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdGVuYWJsZTogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3NldE9wdGlvbnMoeyBkaXNhYmxlZDogZmFsc2UgfSk7XG5cdH0sXG5cdGRpc2FibGU6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLl9zZXRPcHRpb25zKHsgZGlzYWJsZWQ6IHRydWUgfSk7XG5cdH0sXG5cblx0X29uOiBmdW5jdGlvbiggc3VwcHJlc3NEaXNhYmxlZENoZWNrLCBlbGVtZW50LCBoYW5kbGVycyApIHtcblx0XHR2YXIgZGVsZWdhdGVFbGVtZW50LFxuXHRcdFx0aW5zdGFuY2UgPSB0aGlzO1xuXG5cdFx0Ly8gbm8gc3VwcHJlc3NEaXNhYmxlZENoZWNrIGZsYWcsIHNodWZmbGUgYXJndW1lbnRzXG5cdFx0aWYgKCB0eXBlb2Ygc3VwcHJlc3NEaXNhYmxlZENoZWNrICE9PSBcImJvb2xlYW5cIiApIHtcblx0XHRcdGhhbmRsZXJzID0gZWxlbWVudDtcblx0XHRcdGVsZW1lbnQgPSBzdXBwcmVzc0Rpc2FibGVkQ2hlY2s7XG5cdFx0XHRzdXBwcmVzc0Rpc2FibGVkQ2hlY2sgPSBmYWxzZTtcblx0XHR9XG5cblx0XHQvLyBubyBlbGVtZW50IGFyZ3VtZW50LCBzaHVmZmxlIGFuZCB1c2UgdGhpcy5lbGVtZW50XG5cdFx0aWYgKCAhaGFuZGxlcnMgKSB7XG5cdFx0XHRoYW5kbGVycyA9IGVsZW1lbnQ7XG5cdFx0XHRlbGVtZW50ID0gdGhpcy5lbGVtZW50O1xuXHRcdFx0ZGVsZWdhdGVFbGVtZW50ID0gdGhpcy53aWRnZXQoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0ZWxlbWVudCA9IGRlbGVnYXRlRWxlbWVudCA9ICQoIGVsZW1lbnQgKTtcblx0XHRcdHRoaXMuYmluZGluZ3MgPSB0aGlzLmJpbmRpbmdzLmFkZCggZWxlbWVudCApO1xuXHRcdH1cblxuXHRcdCQuZWFjaCggaGFuZGxlcnMsIGZ1bmN0aW9uKCBldmVudCwgaGFuZGxlciApIHtcblx0XHRcdGZ1bmN0aW9uIGhhbmRsZXJQcm94eSgpIHtcblx0XHRcdFx0Ly8gYWxsb3cgd2lkZ2V0cyB0byBjdXN0b21pemUgdGhlIGRpc2FibGVkIGhhbmRsaW5nXG5cdFx0XHRcdC8vIC0gZGlzYWJsZWQgYXMgYW4gYXJyYXkgaW5zdGVhZCBvZiBib29sZWFuXG5cdFx0XHRcdC8vIC0gZGlzYWJsZWQgY2xhc3MgYXMgbWV0aG9kIGZvciBkaXNhYmxpbmcgaW5kaXZpZHVhbCBwYXJ0c1xuXHRcdFx0XHRpZiAoICFzdXBwcmVzc0Rpc2FibGVkQ2hlY2sgJiZcblx0XHRcdFx0XHRcdCggaW5zdGFuY2Uub3B0aW9ucy5kaXNhYmxlZCA9PT0gdHJ1ZSB8fFxuXHRcdFx0XHRcdFx0XHQkKCB0aGlzICkuaGFzQ2xhc3MoIFwidWktc3RhdGUtZGlzYWJsZWRcIiApICkgKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiAoIHR5cGVvZiBoYW5kbGVyID09PSBcInN0cmluZ1wiID8gaW5zdGFuY2VbIGhhbmRsZXIgXSA6IGhhbmRsZXIgKVxuXHRcdFx0XHRcdC5hcHBseSggaW5zdGFuY2UsIGFyZ3VtZW50cyApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBjb3B5IHRoZSBndWlkIHNvIGRpcmVjdCB1bmJpbmRpbmcgd29ya3Ncblx0XHRcdGlmICggdHlwZW9mIGhhbmRsZXIgIT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRcdGhhbmRsZXJQcm94eS5ndWlkID0gaGFuZGxlci5ndWlkID1cblx0XHRcdFx0XHRoYW5kbGVyLmd1aWQgfHwgaGFuZGxlclByb3h5Lmd1aWQgfHwgJC5ndWlkKys7XG5cdFx0XHR9XG5cblx0XHRcdHZhciBtYXRjaCA9IGV2ZW50Lm1hdGNoKCAvXihbXFx3Oi1dKilcXHMqKC4qKSQvICksXG5cdFx0XHRcdGV2ZW50TmFtZSA9IG1hdGNoWzFdICsgaW5zdGFuY2UuZXZlbnROYW1lc3BhY2UsXG5cdFx0XHRcdHNlbGVjdG9yID0gbWF0Y2hbMl07XG5cdFx0XHRpZiAoIHNlbGVjdG9yICkge1xuXHRcdFx0XHRkZWxlZ2F0ZUVsZW1lbnQuZGVsZWdhdGUoIHNlbGVjdG9yLCBldmVudE5hbWUsIGhhbmRsZXJQcm94eSApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZWxlbWVudC5iaW5kKCBldmVudE5hbWUsIGhhbmRsZXJQcm94eSApO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9LFxuXG5cdF9vZmY6IGZ1bmN0aW9uKCBlbGVtZW50LCBldmVudE5hbWUgKSB7XG5cdFx0ZXZlbnROYW1lID0gKGV2ZW50TmFtZSB8fCBcIlwiKS5zcGxpdCggXCIgXCIgKS5qb2luKCB0aGlzLmV2ZW50TmFtZXNwYWNlICsgXCIgXCIgKSArXG5cdFx0XHR0aGlzLmV2ZW50TmFtZXNwYWNlO1xuXHRcdGVsZW1lbnQudW5iaW5kKCBldmVudE5hbWUgKS51bmRlbGVnYXRlKCBldmVudE5hbWUgKTtcblxuXHRcdC8vIENsZWFyIHRoZSBzdGFjayB0byBhdm9pZCBtZW1vcnkgbGVha3MgKCMxMDA1Nilcblx0XHR0aGlzLmJpbmRpbmdzID0gJCggdGhpcy5iaW5kaW5ncy5ub3QoIGVsZW1lbnQgKS5nZXQoKSApO1xuXHRcdHRoaXMuZm9jdXNhYmxlID0gJCggdGhpcy5mb2N1c2FibGUubm90KCBlbGVtZW50ICkuZ2V0KCkgKTtcblx0XHR0aGlzLmhvdmVyYWJsZSA9ICQoIHRoaXMuaG92ZXJhYmxlLm5vdCggZWxlbWVudCApLmdldCgpICk7XG5cdH0sXG5cblx0X2RlbGF5OiBmdW5jdGlvbiggaGFuZGxlciwgZGVsYXkgKSB7XG5cdFx0ZnVuY3Rpb24gaGFuZGxlclByb3h5KCkge1xuXHRcdFx0cmV0dXJuICggdHlwZW9mIGhhbmRsZXIgPT09IFwic3RyaW5nXCIgPyBpbnN0YW5jZVsgaGFuZGxlciBdIDogaGFuZGxlciApXG5cdFx0XHRcdC5hcHBseSggaW5zdGFuY2UsIGFyZ3VtZW50cyApO1xuXHRcdH1cblx0XHR2YXIgaW5zdGFuY2UgPSB0aGlzO1xuXHRcdHJldHVybiBzZXRUaW1lb3V0KCBoYW5kbGVyUHJveHksIGRlbGF5IHx8IDAgKTtcblx0fSxcblxuXHRfaG92ZXJhYmxlOiBmdW5jdGlvbiggZWxlbWVudCApIHtcblx0XHR0aGlzLmhvdmVyYWJsZSA9IHRoaXMuaG92ZXJhYmxlLmFkZCggZWxlbWVudCApO1xuXHRcdHRoaXMuX29uKCBlbGVtZW50LCB7XG5cdFx0XHRtb3VzZWVudGVyOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdCQoIGV2ZW50LmN1cnJlbnRUYXJnZXQgKS5hZGRDbGFzcyggXCJ1aS1zdGF0ZS1ob3ZlclwiICk7XG5cdFx0XHR9LFxuXHRcdFx0bW91c2VsZWF2ZTogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHQkKCBldmVudC5jdXJyZW50VGFyZ2V0ICkucmVtb3ZlQ2xhc3MoIFwidWktc3RhdGUtaG92ZXJcIiApO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9LFxuXG5cdF9mb2N1c2FibGU6IGZ1bmN0aW9uKCBlbGVtZW50ICkge1xuXHRcdHRoaXMuZm9jdXNhYmxlID0gdGhpcy5mb2N1c2FibGUuYWRkKCBlbGVtZW50ICk7XG5cdFx0dGhpcy5fb24oIGVsZW1lbnQsIHtcblx0XHRcdGZvY3VzaW46IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0JCggZXZlbnQuY3VycmVudFRhcmdldCApLmFkZENsYXNzKCBcInVpLXN0YXRlLWZvY3VzXCIgKTtcblx0XHRcdH0sXG5cdFx0XHRmb2N1c291dDogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHQkKCBldmVudC5jdXJyZW50VGFyZ2V0ICkucmVtb3ZlQ2xhc3MoIFwidWktc3RhdGUtZm9jdXNcIiApO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9LFxuXG5cdF90cmlnZ2VyOiBmdW5jdGlvbiggdHlwZSwgZXZlbnQsIGRhdGEgKSB7XG5cdFx0dmFyIHByb3AsIG9yaWcsXG5cdFx0XHRjYWxsYmFjayA9IHRoaXMub3B0aW9uc1sgdHlwZSBdO1xuXG5cdFx0ZGF0YSA9IGRhdGEgfHwge307XG5cdFx0ZXZlbnQgPSAkLkV2ZW50KCBldmVudCApO1xuXHRcdGV2ZW50LnR5cGUgPSAoIHR5cGUgPT09IHRoaXMud2lkZ2V0RXZlbnRQcmVmaXggP1xuXHRcdFx0dHlwZSA6XG5cdFx0XHR0aGlzLndpZGdldEV2ZW50UHJlZml4ICsgdHlwZSApLnRvTG93ZXJDYXNlKCk7XG5cdFx0Ly8gdGhlIG9yaWdpbmFsIGV2ZW50IG1heSBjb21lIGZyb20gYW55IGVsZW1lbnRcblx0XHQvLyBzbyB3ZSBuZWVkIHRvIHJlc2V0IHRoZSB0YXJnZXQgb24gdGhlIG5ldyBldmVudFxuXHRcdGV2ZW50LnRhcmdldCA9IHRoaXMuZWxlbWVudFsgMCBdO1xuXG5cdFx0Ly8gY29weSBvcmlnaW5hbCBldmVudCBwcm9wZXJ0aWVzIG92ZXIgdG8gdGhlIG5ldyBldmVudFxuXHRcdG9yaWcgPSBldmVudC5vcmlnaW5hbEV2ZW50O1xuXHRcdGlmICggb3JpZyApIHtcblx0XHRcdGZvciAoIHByb3AgaW4gb3JpZyApIHtcblx0XHRcdFx0aWYgKCAhKCBwcm9wIGluIGV2ZW50ICkgKSB7XG5cdFx0XHRcdFx0ZXZlbnRbIHByb3AgXSA9IG9yaWdbIHByb3AgXTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRoaXMuZWxlbWVudC50cmlnZ2VyKCBldmVudCwgZGF0YSApO1xuXHRcdHJldHVybiAhKCAkLmlzRnVuY3Rpb24oIGNhbGxiYWNrICkgJiZcblx0XHRcdGNhbGxiYWNrLmFwcGx5KCB0aGlzLmVsZW1lbnRbMF0sIFsgZXZlbnQgXS5jb25jYXQoIGRhdGEgKSApID09PSBmYWxzZSB8fFxuXHRcdFx0ZXZlbnQuaXNEZWZhdWx0UHJldmVudGVkKCkgKTtcblx0fVxufTtcblxuJC5lYWNoKCB7IHNob3c6IFwiZmFkZUluXCIsIGhpZGU6IFwiZmFkZU91dFwiIH0sIGZ1bmN0aW9uKCBtZXRob2QsIGRlZmF1bHRFZmZlY3QgKSB7XG5cdCQuV2lkZ2V0LnByb3RvdHlwZVsgXCJfXCIgKyBtZXRob2QgXSA9IGZ1bmN0aW9uKCBlbGVtZW50LCBvcHRpb25zLCBjYWxsYmFjayApIHtcblx0XHRpZiAoIHR5cGVvZiBvcHRpb25zID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0b3B0aW9ucyA9IHsgZWZmZWN0OiBvcHRpb25zIH07XG5cdFx0fVxuXHRcdHZhciBoYXNPcHRpb25zLFxuXHRcdFx0ZWZmZWN0TmFtZSA9ICFvcHRpb25zID9cblx0XHRcdFx0bWV0aG9kIDpcblx0XHRcdFx0b3B0aW9ucyA9PT0gdHJ1ZSB8fCB0eXBlb2Ygb3B0aW9ucyA9PT0gXCJudW1iZXJcIiA/XG5cdFx0XHRcdFx0ZGVmYXVsdEVmZmVjdCA6XG5cdFx0XHRcdFx0b3B0aW9ucy5lZmZlY3QgfHwgZGVmYXVsdEVmZmVjdDtcblx0XHRvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblx0XHRpZiAoIHR5cGVvZiBvcHRpb25zID09PSBcIm51bWJlclwiICkge1xuXHRcdFx0b3B0aW9ucyA9IHsgZHVyYXRpb246IG9wdGlvbnMgfTtcblx0XHR9XG5cdFx0aGFzT3B0aW9ucyA9ICEkLmlzRW1wdHlPYmplY3QoIG9wdGlvbnMgKTtcblx0XHRvcHRpb25zLmNvbXBsZXRlID0gY2FsbGJhY2s7XG5cdFx0aWYgKCBvcHRpb25zLmRlbGF5ICkge1xuXHRcdFx0ZWxlbWVudC5kZWxheSggb3B0aW9ucy5kZWxheSApO1xuXHRcdH1cblx0XHRpZiAoIGhhc09wdGlvbnMgJiYgJC5lZmZlY3RzICYmICQuZWZmZWN0cy5lZmZlY3RbIGVmZmVjdE5hbWUgXSApIHtcblx0XHRcdGVsZW1lbnRbIG1ldGhvZCBdKCBvcHRpb25zICk7XG5cdFx0fSBlbHNlIGlmICggZWZmZWN0TmFtZSAhPT0gbWV0aG9kICYmIGVsZW1lbnRbIGVmZmVjdE5hbWUgXSApIHtcblx0XHRcdGVsZW1lbnRbIGVmZmVjdE5hbWUgXSggb3B0aW9ucy5kdXJhdGlvbiwgb3B0aW9ucy5lYXNpbmcsIGNhbGxiYWNrICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGVsZW1lbnQucXVldWUoZnVuY3Rpb24oIG5leHQgKSB7XG5cdFx0XHRcdCQoIHRoaXMgKVsgbWV0aG9kIF0oKTtcblx0XHRcdFx0aWYgKCBjYWxsYmFjayApIHtcblx0XHRcdFx0XHRjYWxsYmFjay5jYWxsKCBlbGVtZW50WyAwIF0gKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRuZXh0KCk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH07XG59KTtcblxudmFyIHdpZGdldCA9ICQud2lkZ2V0O1xuXG5cbi8qIVxuICogalF1ZXJ5IFVJIE1vdXNlIDEuMTEuNFxuICogaHR0cDovL2pxdWVyeXVpLmNvbVxuICpcbiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXG4gKlxuICogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vbW91c2UvXG4gKi9cblxuXG52YXIgbW91c2VIYW5kbGVkID0gZmFsc2U7XG4kKCBkb2N1bWVudCApLm1vdXNldXAoIGZ1bmN0aW9uKCkge1xuXHRtb3VzZUhhbmRsZWQgPSBmYWxzZTtcbn0pO1xuXG52YXIgbW91c2UgPSAkLndpZGdldChcInVpLm1vdXNlXCIsIHtcblx0dmVyc2lvbjogXCIxLjExLjRcIixcblx0b3B0aW9uczoge1xuXHRcdGNhbmNlbDogXCJpbnB1dCx0ZXh0YXJlYSxidXR0b24sc2VsZWN0LG9wdGlvblwiLFxuXHRcdGRpc3RhbmNlOiAxLFxuXHRcdGRlbGF5OiAwXG5cdH0sXG5cdF9tb3VzZUluaXQ6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB0aGF0ID0gdGhpcztcblxuXHRcdHRoaXMuZWxlbWVudFxuXHRcdFx0LmJpbmQoXCJtb3VzZWRvd24uXCIgKyB0aGlzLndpZGdldE5hbWUsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRcdHJldHVybiB0aGF0Ll9tb3VzZURvd24oZXZlbnQpO1xuXHRcdFx0fSlcblx0XHRcdC5iaW5kKFwiY2xpY2suXCIgKyB0aGlzLndpZGdldE5hbWUsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRcdGlmICh0cnVlID09PSAkLmRhdGEoZXZlbnQudGFyZ2V0LCB0aGF0LndpZGdldE5hbWUgKyBcIi5wcmV2ZW50Q2xpY2tFdmVudFwiKSkge1xuXHRcdFx0XHRcdCQucmVtb3ZlRGF0YShldmVudC50YXJnZXQsIHRoYXQud2lkZ2V0TmFtZSArIFwiLnByZXZlbnRDbGlja0V2ZW50XCIpO1xuXHRcdFx0XHRcdGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHR0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcblx0fSxcblxuXHQvLyBUT0RPOiBtYWtlIHN1cmUgZGVzdHJveWluZyBvbmUgaW5zdGFuY2Ugb2YgbW91c2UgZG9lc24ndCBtZXNzIHdpdGhcblx0Ly8gb3RoZXIgaW5zdGFuY2VzIG9mIG1vdXNlXG5cdF9tb3VzZURlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuZWxlbWVudC51bmJpbmQoXCIuXCIgKyB0aGlzLndpZGdldE5hbWUpO1xuXHRcdGlmICggdGhpcy5fbW91c2VNb3ZlRGVsZWdhdGUgKSB7XG5cdFx0XHR0aGlzLmRvY3VtZW50XG5cdFx0XHRcdC51bmJpbmQoXCJtb3VzZW1vdmUuXCIgKyB0aGlzLndpZGdldE5hbWUsIHRoaXMuX21vdXNlTW92ZURlbGVnYXRlKVxuXHRcdFx0XHQudW5iaW5kKFwibW91c2V1cC5cIiArIHRoaXMud2lkZ2V0TmFtZSwgdGhpcy5fbW91c2VVcERlbGVnYXRlKTtcblx0XHR9XG5cdH0sXG5cblx0X21vdXNlRG93bjogZnVuY3Rpb24oZXZlbnQpIHtcblx0XHQvLyBkb24ndCBsZXQgbW9yZSB0aGFuIG9uZSB3aWRnZXQgaGFuZGxlIG1vdXNlU3RhcnRcblx0XHRpZiAoIG1vdXNlSGFuZGxlZCApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR0aGlzLl9tb3VzZU1vdmVkID0gZmFsc2U7XG5cblx0XHQvLyB3ZSBtYXkgaGF2ZSBtaXNzZWQgbW91c2V1cCAob3V0IG9mIHdpbmRvdylcblx0XHQodGhpcy5fbW91c2VTdGFydGVkICYmIHRoaXMuX21vdXNlVXAoZXZlbnQpKTtcblxuXHRcdHRoaXMuX21vdXNlRG93bkV2ZW50ID0gZXZlbnQ7XG5cblx0XHR2YXIgdGhhdCA9IHRoaXMsXG5cdFx0XHRidG5Jc0xlZnQgPSAoZXZlbnQud2hpY2ggPT09IDEpLFxuXHRcdFx0Ly8gZXZlbnQudGFyZ2V0Lm5vZGVOYW1lIHdvcmtzIGFyb3VuZCBhIGJ1ZyBpbiBJRSA4IHdpdGhcblx0XHRcdC8vIGRpc2FibGVkIGlucHV0cyAoIzc2MjApXG5cdFx0XHRlbElzQ2FuY2VsID0gKHR5cGVvZiB0aGlzLm9wdGlvbnMuY2FuY2VsID09PSBcInN0cmluZ1wiICYmIGV2ZW50LnRhcmdldC5ub2RlTmFtZSA/ICQoZXZlbnQudGFyZ2V0KS5jbG9zZXN0KHRoaXMub3B0aW9ucy5jYW5jZWwpLmxlbmd0aCA6IGZhbHNlKTtcblx0XHRpZiAoIWJ0bklzTGVmdCB8fCBlbElzQ2FuY2VsIHx8ICF0aGlzLl9tb3VzZUNhcHR1cmUoZXZlbnQpKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHR0aGlzLm1vdXNlRGVsYXlNZXQgPSAhdGhpcy5vcHRpb25zLmRlbGF5O1xuXHRcdGlmICghdGhpcy5tb3VzZURlbGF5TWV0KSB7XG5cdFx0XHR0aGlzLl9tb3VzZURlbGF5VGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGF0Lm1vdXNlRGVsYXlNZXQgPSB0cnVlO1xuXHRcdFx0fSwgdGhpcy5vcHRpb25zLmRlbGF5KTtcblx0XHR9XG5cblx0XHRpZiAodGhpcy5fbW91c2VEaXN0YW5jZU1ldChldmVudCkgJiYgdGhpcy5fbW91c2VEZWxheU1ldChldmVudCkpIHtcblx0XHRcdHRoaXMuX21vdXNlU3RhcnRlZCA9ICh0aGlzLl9tb3VzZVN0YXJ0KGV2ZW50KSAhPT0gZmFsc2UpO1xuXHRcdFx0aWYgKCF0aGlzLl9tb3VzZVN0YXJ0ZWQpIHtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gQ2xpY2sgZXZlbnQgbWF5IG5ldmVyIGhhdmUgZmlyZWQgKEdlY2tvICYgT3BlcmEpXG5cdFx0aWYgKHRydWUgPT09ICQuZGF0YShldmVudC50YXJnZXQsIHRoaXMud2lkZ2V0TmFtZSArIFwiLnByZXZlbnRDbGlja0V2ZW50XCIpKSB7XG5cdFx0XHQkLnJlbW92ZURhdGEoZXZlbnQudGFyZ2V0LCB0aGlzLndpZGdldE5hbWUgKyBcIi5wcmV2ZW50Q2xpY2tFdmVudFwiKTtcblx0XHR9XG5cblx0XHQvLyB0aGVzZSBkZWxlZ2F0ZXMgYXJlIHJlcXVpcmVkIHRvIGtlZXAgY29udGV4dFxuXHRcdHRoaXMuX21vdXNlTW92ZURlbGVnYXRlID0gZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRcdHJldHVybiB0aGF0Ll9tb3VzZU1vdmUoZXZlbnQpO1xuXHRcdH07XG5cdFx0dGhpcy5fbW91c2VVcERlbGVnYXRlID0gZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRcdHJldHVybiB0aGF0Ll9tb3VzZVVwKGV2ZW50KTtcblx0XHR9O1xuXG5cdFx0dGhpcy5kb2N1bWVudFxuXHRcdFx0LmJpbmQoIFwibW91c2Vtb3ZlLlwiICsgdGhpcy53aWRnZXROYW1lLCB0aGlzLl9tb3VzZU1vdmVEZWxlZ2F0ZSApXG5cdFx0XHQuYmluZCggXCJtb3VzZXVwLlwiICsgdGhpcy53aWRnZXROYW1lLCB0aGlzLl9tb3VzZVVwRGVsZWdhdGUgKTtcblxuXHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRtb3VzZUhhbmRsZWQgPSB0cnVlO1xuXHRcdHJldHVybiB0cnVlO1xuXHR9LFxuXG5cdF9tb3VzZU1vdmU6IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0Ly8gT25seSBjaGVjayBmb3IgbW91c2V1cHMgb3V0c2lkZSB0aGUgZG9jdW1lbnQgaWYgeW91J3ZlIG1vdmVkIGluc2lkZSB0aGUgZG9jdW1lbnRcblx0XHQvLyBhdCBsZWFzdCBvbmNlLiBUaGlzIHByZXZlbnRzIHRoZSBmaXJpbmcgb2YgbW91c2V1cCBpbiB0aGUgY2FzZSBvZiBJRTw5LCB3aGljaCB3aWxsXG5cdFx0Ly8gZmlyZSBhIG1vdXNlbW92ZSBldmVudCBpZiBjb250ZW50IGlzIHBsYWNlZCB1bmRlciB0aGUgY3Vyc29yLiBTZWUgIzc3Nzhcblx0XHQvLyBTdXBwb3J0OiBJRSA8OVxuXHRcdGlmICggdGhpcy5fbW91c2VNb3ZlZCApIHtcblx0XHRcdC8vIElFIG1vdXNldXAgY2hlY2sgLSBtb3VzZXVwIGhhcHBlbmVkIHdoZW4gbW91c2Ugd2FzIG91dCBvZiB3aW5kb3dcblx0XHRcdGlmICgkLnVpLmllICYmICggIWRvY3VtZW50LmRvY3VtZW50TW9kZSB8fCBkb2N1bWVudC5kb2N1bWVudE1vZGUgPCA5ICkgJiYgIWV2ZW50LmJ1dHRvbikge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fbW91c2VVcChldmVudCk7XG5cblx0XHRcdC8vIElmcmFtZSBtb3VzZXVwIGNoZWNrIC0gbW91c2V1cCBvY2N1cnJlZCBpbiBhbm90aGVyIGRvY3VtZW50XG5cdFx0XHR9IGVsc2UgaWYgKCAhZXZlbnQud2hpY2ggKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9tb3VzZVVwKCBldmVudCApO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmICggZXZlbnQud2hpY2ggfHwgZXZlbnQuYnV0dG9uICkge1xuXHRcdFx0dGhpcy5fbW91c2VNb3ZlZCA9IHRydWU7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuX21vdXNlU3RhcnRlZCkge1xuXHRcdFx0dGhpcy5fbW91c2VEcmFnKGV2ZW50KTtcblx0XHRcdHJldHVybiBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdH1cblxuXHRcdGlmICh0aGlzLl9tb3VzZURpc3RhbmNlTWV0KGV2ZW50KSAmJiB0aGlzLl9tb3VzZURlbGF5TWV0KGV2ZW50KSkge1xuXHRcdFx0dGhpcy5fbW91c2VTdGFydGVkID1cblx0XHRcdFx0KHRoaXMuX21vdXNlU3RhcnQodGhpcy5fbW91c2VEb3duRXZlbnQsIGV2ZW50KSAhPT0gZmFsc2UpO1xuXHRcdFx0KHRoaXMuX21vdXNlU3RhcnRlZCA/IHRoaXMuX21vdXNlRHJhZyhldmVudCkgOiB0aGlzLl9tb3VzZVVwKGV2ZW50KSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuICF0aGlzLl9tb3VzZVN0YXJ0ZWQ7XG5cdH0sXG5cblx0X21vdXNlVXA6IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0dGhpcy5kb2N1bWVudFxuXHRcdFx0LnVuYmluZCggXCJtb3VzZW1vdmUuXCIgKyB0aGlzLndpZGdldE5hbWUsIHRoaXMuX21vdXNlTW92ZURlbGVnYXRlIClcblx0XHRcdC51bmJpbmQoIFwibW91c2V1cC5cIiArIHRoaXMud2lkZ2V0TmFtZSwgdGhpcy5fbW91c2VVcERlbGVnYXRlICk7XG5cblx0XHRpZiAodGhpcy5fbW91c2VTdGFydGVkKSB7XG5cdFx0XHR0aGlzLl9tb3VzZVN0YXJ0ZWQgPSBmYWxzZTtcblxuXHRcdFx0aWYgKGV2ZW50LnRhcmdldCA9PT0gdGhpcy5fbW91c2VEb3duRXZlbnQudGFyZ2V0KSB7XG5cdFx0XHRcdCQuZGF0YShldmVudC50YXJnZXQsIHRoaXMud2lkZ2V0TmFtZSArIFwiLnByZXZlbnRDbGlja0V2ZW50XCIsIHRydWUpO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLl9tb3VzZVN0b3AoZXZlbnQpO1xuXHRcdH1cblxuXHRcdG1vdXNlSGFuZGxlZCA9IGZhbHNlO1xuXHRcdHJldHVybiBmYWxzZTtcblx0fSxcblxuXHRfbW91c2VEaXN0YW5jZU1ldDogZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRyZXR1cm4gKE1hdGgubWF4KFxuXHRcdFx0XHRNYXRoLmFicyh0aGlzLl9tb3VzZURvd25FdmVudC5wYWdlWCAtIGV2ZW50LnBhZ2VYKSxcblx0XHRcdFx0TWF0aC5hYnModGhpcy5fbW91c2VEb3duRXZlbnQucGFnZVkgLSBldmVudC5wYWdlWSlcblx0XHRcdCkgPj0gdGhpcy5vcHRpb25zLmRpc3RhbmNlXG5cdFx0KTtcblx0fSxcblxuXHRfbW91c2VEZWxheU1ldDogZnVuY3Rpb24oLyogZXZlbnQgKi8pIHtcblx0XHRyZXR1cm4gdGhpcy5tb3VzZURlbGF5TWV0O1xuXHR9LFxuXG5cdC8vIFRoZXNlIGFyZSBwbGFjZWhvbGRlciBtZXRob2RzLCB0byBiZSBvdmVycmlkZW4gYnkgZXh0ZW5kaW5nIHBsdWdpblxuXHRfbW91c2VTdGFydDogZnVuY3Rpb24oLyogZXZlbnQgKi8pIHt9LFxuXHRfbW91c2VEcmFnOiBmdW5jdGlvbigvKiBldmVudCAqLykge30sXG5cdF9tb3VzZVN0b3A6IGZ1bmN0aW9uKC8qIGV2ZW50ICovKSB7fSxcblx0X21vdXNlQ2FwdHVyZTogZnVuY3Rpb24oLyogZXZlbnQgKi8pIHsgcmV0dXJuIHRydWU7IH1cbn0pO1xuXG5cbi8qIVxuICogalF1ZXJ5IFVJIERyYWdnYWJsZSAxLjExLjRcbiAqIGh0dHA6Ly9qcXVlcnl1aS5jb21cbiAqXG4gKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZVxuICpcbiAqIGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2RyYWdnYWJsZS9cbiAqL1xuXG5cbiQud2lkZ2V0KFwidWkuZHJhZ2dhYmxlXCIsICQudWkubW91c2UsIHtcblx0dmVyc2lvbjogXCIxLjExLjRcIixcblx0d2lkZ2V0RXZlbnRQcmVmaXg6IFwiZHJhZ1wiLFxuXHRvcHRpb25zOiB7XG5cdFx0YWRkQ2xhc3NlczogdHJ1ZSxcblx0XHRhcHBlbmRUbzogXCJwYXJlbnRcIixcblx0XHRheGlzOiBmYWxzZSxcblx0XHRjb25uZWN0VG9Tb3J0YWJsZTogZmFsc2UsXG5cdFx0Y29udGFpbm1lbnQ6IGZhbHNlLFxuXHRcdGN1cnNvcjogXCJhdXRvXCIsXG5cdFx0Y3Vyc29yQXQ6IGZhbHNlLFxuXHRcdGdyaWQ6IGZhbHNlLFxuXHRcdGhhbmRsZTogZmFsc2UsXG5cdFx0aGVscGVyOiBcIm9yaWdpbmFsXCIsXG5cdFx0aWZyYW1lRml4OiBmYWxzZSxcblx0XHRvcGFjaXR5OiBmYWxzZSxcblx0XHRyZWZyZXNoUG9zaXRpb25zOiBmYWxzZSxcblx0XHRyZXZlcnQ6IGZhbHNlLFxuXHRcdHJldmVydER1cmF0aW9uOiA1MDAsXG5cdFx0c2NvcGU6IFwiZGVmYXVsdFwiLFxuXHRcdHNjcm9sbDogdHJ1ZSxcblx0XHRzY3JvbGxTZW5zaXRpdml0eTogMjAsXG5cdFx0c2Nyb2xsU3BlZWQ6IDIwLFxuXHRcdHNuYXA6IGZhbHNlLFxuXHRcdHNuYXBNb2RlOiBcImJvdGhcIixcblx0XHRzbmFwVG9sZXJhbmNlOiAyMCxcblx0XHRzdGFjazogZmFsc2UsXG5cdFx0ekluZGV4OiBmYWxzZSxcblxuXHRcdC8vIGNhbGxiYWNrc1xuXHRcdGRyYWc6IG51bGwsXG5cdFx0c3RhcnQ6IG51bGwsXG5cdFx0c3RvcDogbnVsbFxuXHR9LFxuXHRfY3JlYXRlOiBmdW5jdGlvbigpIHtcblxuXHRcdGlmICggdGhpcy5vcHRpb25zLmhlbHBlciA9PT0gXCJvcmlnaW5hbFwiICkge1xuXHRcdFx0dGhpcy5fc2V0UG9zaXRpb25SZWxhdGl2ZSgpO1xuXHRcdH1cblx0XHRpZiAodGhpcy5vcHRpb25zLmFkZENsYXNzZXMpe1xuXHRcdFx0dGhpcy5lbGVtZW50LmFkZENsYXNzKFwidWktZHJhZ2dhYmxlXCIpO1xuXHRcdH1cblx0XHRpZiAodGhpcy5vcHRpb25zLmRpc2FibGVkKXtcblx0XHRcdHRoaXMuZWxlbWVudC5hZGRDbGFzcyhcInVpLWRyYWdnYWJsZS1kaXNhYmxlZFwiKTtcblx0XHR9XG5cdFx0dGhpcy5fc2V0SGFuZGxlQ2xhc3NOYW1lKCk7XG5cblx0XHR0aGlzLl9tb3VzZUluaXQoKTtcblx0fSxcblxuXHRfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHR0aGlzLl9zdXBlcigga2V5LCB2YWx1ZSApO1xuXHRcdGlmICgga2V5ID09PSBcImhhbmRsZVwiICkge1xuXHRcdFx0dGhpcy5fcmVtb3ZlSGFuZGxlQ2xhc3NOYW1lKCk7XG5cdFx0XHR0aGlzLl9zZXRIYW5kbGVDbGFzc05hbWUoKTtcblx0XHR9XG5cdH0sXG5cblx0X2Rlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICggKCB0aGlzLmhlbHBlciB8fCB0aGlzLmVsZW1lbnQgKS5pcyggXCIudWktZHJhZ2dhYmxlLWRyYWdnaW5nXCIgKSApIHtcblx0XHRcdHRoaXMuZGVzdHJveU9uQ2xlYXIgPSB0cnVlO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHR0aGlzLmVsZW1lbnQucmVtb3ZlQ2xhc3MoIFwidWktZHJhZ2dhYmxlIHVpLWRyYWdnYWJsZS1kcmFnZ2luZyB1aS1kcmFnZ2FibGUtZGlzYWJsZWRcIiApO1xuXHRcdHRoaXMuX3JlbW92ZUhhbmRsZUNsYXNzTmFtZSgpO1xuXHRcdHRoaXMuX21vdXNlRGVzdHJveSgpO1xuXHR9LFxuXG5cdF9tb3VzZUNhcHR1cmU6IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0dmFyIG8gPSB0aGlzLm9wdGlvbnM7XG5cblx0XHR0aGlzLl9ibHVyQWN0aXZlRWxlbWVudCggZXZlbnQgKTtcblxuXHRcdC8vIGFtb25nIG90aGVycywgcHJldmVudCBhIGRyYWcgb24gYSByZXNpemFibGUtaGFuZGxlXG5cdFx0aWYgKHRoaXMuaGVscGVyIHx8IG8uZGlzYWJsZWQgfHwgJChldmVudC50YXJnZXQpLmNsb3Nlc3QoXCIudWktcmVzaXphYmxlLWhhbmRsZVwiKS5sZW5ndGggPiAwKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0Ly9RdWl0IGlmIHdlJ3JlIG5vdCBvbiBhIHZhbGlkIGhhbmRsZVxuXHRcdHRoaXMuaGFuZGxlID0gdGhpcy5fZ2V0SGFuZGxlKGV2ZW50KTtcblx0XHRpZiAoIXRoaXMuaGFuZGxlKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0dGhpcy5fYmxvY2tGcmFtZXMoIG8uaWZyYW1lRml4ID09PSB0cnVlID8gXCJpZnJhbWVcIiA6IG8uaWZyYW1lRml4ICk7XG5cblx0XHRyZXR1cm4gdHJ1ZTtcblxuXHR9LFxuXG5cdF9ibG9ja0ZyYW1lczogZnVuY3Rpb24oIHNlbGVjdG9yICkge1xuXHRcdHRoaXMuaWZyYW1lQmxvY2tzID0gdGhpcy5kb2N1bWVudC5maW5kKCBzZWxlY3RvciApLm1hcChmdW5jdGlvbigpIHtcblx0XHRcdHZhciBpZnJhbWUgPSAkKCB0aGlzICk7XG5cblx0XHRcdHJldHVybiAkKCBcIjxkaXY+XCIgKVxuXHRcdFx0XHQuY3NzKCBcInBvc2l0aW9uXCIsIFwiYWJzb2x1dGVcIiApXG5cdFx0XHRcdC5hcHBlbmRUbyggaWZyYW1lLnBhcmVudCgpIClcblx0XHRcdFx0Lm91dGVyV2lkdGgoIGlmcmFtZS5vdXRlcldpZHRoKCkgKVxuXHRcdFx0XHQub3V0ZXJIZWlnaHQoIGlmcmFtZS5vdXRlckhlaWdodCgpIClcblx0XHRcdFx0Lm9mZnNldCggaWZyYW1lLm9mZnNldCgpIClbIDAgXTtcblx0XHR9KTtcblx0fSxcblxuXHRfdW5ibG9ja0ZyYW1lczogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCB0aGlzLmlmcmFtZUJsb2NrcyApIHtcblx0XHRcdHRoaXMuaWZyYW1lQmxvY2tzLnJlbW92ZSgpO1xuXHRcdFx0ZGVsZXRlIHRoaXMuaWZyYW1lQmxvY2tzO1xuXHRcdH1cblx0fSxcblxuXHRfYmx1ckFjdGl2ZUVsZW1lbnQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR2YXIgZG9jdW1lbnQgPSB0aGlzLmRvY3VtZW50WyAwIF07XG5cblx0XHQvLyBPbmx5IG5lZWQgdG8gYmx1ciBpZiB0aGUgZXZlbnQgb2NjdXJyZWQgb24gdGhlIGRyYWdnYWJsZSBpdHNlbGYsIHNlZSAjMTA1Mjdcblx0XHRpZiAoICF0aGlzLmhhbmRsZUVsZW1lbnQuaXMoIGV2ZW50LnRhcmdldCApICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIHN1cHBvcnQ6IElFOVxuXHRcdC8vIElFOSB0aHJvd3MgYW4gXCJVbnNwZWNpZmllZCBlcnJvclwiIGFjY2Vzc2luZyBkb2N1bWVudC5hY3RpdmVFbGVtZW50IGZyb20gYW4gPGlmcmFtZT5cblx0XHR0cnkge1xuXG5cdFx0XHQvLyBTdXBwb3J0OiBJRTksIElFMTBcblx0XHRcdC8vIElmIHRoZSA8Ym9keT4gaXMgYmx1cnJlZCwgSUUgd2lsbCBzd2l0Y2ggd2luZG93cywgc2VlICM5NTIwXG5cdFx0XHRpZiAoIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgJiYgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpICE9PSBcImJvZHlcIiApIHtcblxuXHRcdFx0XHQvLyBCbHVyIGFueSBlbGVtZW50IHRoYXQgY3VycmVudGx5IGhhcyBmb2N1cywgc2VlICM0MjYxXG5cdFx0XHRcdCQoIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgKS5ibHVyKCk7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoIGVycm9yICkge31cblx0fSxcblxuXHRfbW91c2VTdGFydDogZnVuY3Rpb24oZXZlbnQpIHtcblxuXHRcdHZhciBvID0gdGhpcy5vcHRpb25zO1xuXG5cdFx0Ly9DcmVhdGUgYW5kIGFwcGVuZCB0aGUgdmlzaWJsZSBoZWxwZXJcblx0XHR0aGlzLmhlbHBlciA9IHRoaXMuX2NyZWF0ZUhlbHBlcihldmVudCk7XG5cblx0XHR0aGlzLmhlbHBlci5hZGRDbGFzcyhcInVpLWRyYWdnYWJsZS1kcmFnZ2luZ1wiKTtcblxuXHRcdC8vQ2FjaGUgdGhlIGhlbHBlciBzaXplXG5cdFx0dGhpcy5fY2FjaGVIZWxwZXJQcm9wb3J0aW9ucygpO1xuXG5cdFx0Ly9JZiBkZG1hbmFnZXIgaXMgdXNlZCBmb3IgZHJvcHBhYmxlcywgc2V0IHRoZSBnbG9iYWwgZHJhZ2dhYmxlXG5cdFx0aWYgKCQudWkuZGRtYW5hZ2VyKSB7XG5cdFx0XHQkLnVpLmRkbWFuYWdlci5jdXJyZW50ID0gdGhpcztcblx0XHR9XG5cblx0XHQvKlxuXHRcdCAqIC0gUG9zaXRpb24gZ2VuZXJhdGlvbiAtXG5cdFx0ICogVGhpcyBibG9jayBnZW5lcmF0ZXMgZXZlcnl0aGluZyBwb3NpdGlvbiByZWxhdGVkIC0gaXQncyB0aGUgY29yZSBvZiBkcmFnZ2FibGVzLlxuXHRcdCAqL1xuXG5cdFx0Ly9DYWNoZSB0aGUgbWFyZ2lucyBvZiB0aGUgb3JpZ2luYWwgZWxlbWVudFxuXHRcdHRoaXMuX2NhY2hlTWFyZ2lucygpO1xuXG5cdFx0Ly9TdG9yZSB0aGUgaGVscGVyJ3MgY3NzIHBvc2l0aW9uXG5cdFx0dGhpcy5jc3NQb3NpdGlvbiA9IHRoaXMuaGVscGVyLmNzcyggXCJwb3NpdGlvblwiICk7XG5cdFx0dGhpcy5zY3JvbGxQYXJlbnQgPSB0aGlzLmhlbHBlci5zY3JvbGxQYXJlbnQoIHRydWUgKTtcblx0XHR0aGlzLm9mZnNldFBhcmVudCA9IHRoaXMuaGVscGVyLm9mZnNldFBhcmVudCgpO1xuXHRcdHRoaXMuaGFzRml4ZWRBbmNlc3RvciA9IHRoaXMuaGVscGVyLnBhcmVudHMoKS5maWx0ZXIoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiAkKCB0aGlzICkuY3NzKCBcInBvc2l0aW9uXCIgKSA9PT0gXCJmaXhlZFwiO1xuXHRcdFx0fSkubGVuZ3RoID4gMDtcblxuXHRcdC8vVGhlIGVsZW1lbnQncyBhYnNvbHV0ZSBwb3NpdGlvbiBvbiB0aGUgcGFnZSBtaW51cyBtYXJnaW5zXG5cdFx0dGhpcy5wb3NpdGlvbkFicyA9IHRoaXMuZWxlbWVudC5vZmZzZXQoKTtcblx0XHR0aGlzLl9yZWZyZXNoT2Zmc2V0cyggZXZlbnQgKTtcblxuXHRcdC8vR2VuZXJhdGUgdGhlIG9yaWdpbmFsIHBvc2l0aW9uXG5cdFx0dGhpcy5vcmlnaW5hbFBvc2l0aW9uID0gdGhpcy5wb3NpdGlvbiA9IHRoaXMuX2dlbmVyYXRlUG9zaXRpb24oIGV2ZW50LCBmYWxzZSApO1xuXHRcdHRoaXMub3JpZ2luYWxQYWdlWCA9IGV2ZW50LnBhZ2VYO1xuXHRcdHRoaXMub3JpZ2luYWxQYWdlWSA9IGV2ZW50LnBhZ2VZO1xuXG5cdFx0Ly9BZGp1c3QgdGhlIG1vdXNlIG9mZnNldCByZWxhdGl2ZSB0byB0aGUgaGVscGVyIGlmIFwiY3Vyc29yQXRcIiBpcyBzdXBwbGllZFxuXHRcdChvLmN1cnNvckF0ICYmIHRoaXMuX2FkanVzdE9mZnNldEZyb21IZWxwZXIoby5jdXJzb3JBdCkpO1xuXG5cdFx0Ly9TZXQgYSBjb250YWlubWVudCBpZiBnaXZlbiBpbiB0aGUgb3B0aW9uc1xuXHRcdHRoaXMuX3NldENvbnRhaW5tZW50KCk7XG5cblx0XHQvL1RyaWdnZXIgZXZlbnQgKyBjYWxsYmFja3Ncblx0XHRpZiAodGhpcy5fdHJpZ2dlcihcInN0YXJ0XCIsIGV2ZW50KSA9PT0gZmFsc2UpIHtcblx0XHRcdHRoaXMuX2NsZWFyKCk7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0Ly9SZWNhY2hlIHRoZSBoZWxwZXIgc2l6ZVxuXHRcdHRoaXMuX2NhY2hlSGVscGVyUHJvcG9ydGlvbnMoKTtcblxuXHRcdC8vUHJlcGFyZSB0aGUgZHJvcHBhYmxlIG9mZnNldHNcblx0XHRpZiAoJC51aS5kZG1hbmFnZXIgJiYgIW8uZHJvcEJlaGF2aW91cikge1xuXHRcdFx0JC51aS5kZG1hbmFnZXIucHJlcGFyZU9mZnNldHModGhpcywgZXZlbnQpO1xuXHRcdH1cblxuXHRcdC8vIFJlc2V0IGhlbHBlcidzIHJpZ2h0L2JvdHRvbSBjc3MgaWYgdGhleSdyZSBzZXQgYW5kIHNldCBleHBsaWNpdCB3aWR0aC9oZWlnaHQgaW5zdGVhZFxuXHRcdC8vIGFzIHRoaXMgcHJldmVudHMgcmVzaXppbmcgb2YgZWxlbWVudHMgd2l0aCByaWdodC9ib3R0b20gc2V0IChzZWUgIzc3NzIpXG5cdFx0dGhpcy5fbm9ybWFsaXplUmlnaHRCb3R0b20oKTtcblxuXHRcdHRoaXMuX21vdXNlRHJhZyhldmVudCwgdHJ1ZSk7IC8vRXhlY3V0ZSB0aGUgZHJhZyBvbmNlIC0gdGhpcyBjYXVzZXMgdGhlIGhlbHBlciBub3QgdG8gYmUgdmlzaWJsZSBiZWZvcmUgZ2V0dGluZyBpdHMgY29ycmVjdCBwb3NpdGlvblxuXG5cdFx0Ly9JZiB0aGUgZGRtYW5hZ2VyIGlzIHVzZWQgZm9yIGRyb3BwYWJsZXMsIGluZm9ybSB0aGUgbWFuYWdlciB0aGF0IGRyYWdnaW5nIGhhcyBzdGFydGVkIChzZWUgIzUwMDMpXG5cdFx0aWYgKCAkLnVpLmRkbWFuYWdlciApIHtcblx0XHRcdCQudWkuZGRtYW5hZ2VyLmRyYWdTdGFydCh0aGlzLCBldmVudCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRydWU7XG5cdH0sXG5cblx0X3JlZnJlc2hPZmZzZXRzOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0dGhpcy5vZmZzZXQgPSB7XG5cdFx0XHR0b3A6IHRoaXMucG9zaXRpb25BYnMudG9wIC0gdGhpcy5tYXJnaW5zLnRvcCxcblx0XHRcdGxlZnQ6IHRoaXMucG9zaXRpb25BYnMubGVmdCAtIHRoaXMubWFyZ2lucy5sZWZ0LFxuXHRcdFx0c2Nyb2xsOiBmYWxzZSxcblx0XHRcdHBhcmVudDogdGhpcy5fZ2V0UGFyZW50T2Zmc2V0KCksXG5cdFx0XHRyZWxhdGl2ZTogdGhpcy5fZ2V0UmVsYXRpdmVPZmZzZXQoKVxuXHRcdH07XG5cblx0XHR0aGlzLm9mZnNldC5jbGljayA9IHtcblx0XHRcdGxlZnQ6IGV2ZW50LnBhZ2VYIC0gdGhpcy5vZmZzZXQubGVmdCxcblx0XHRcdHRvcDogZXZlbnQucGFnZVkgLSB0aGlzLm9mZnNldC50b3Bcblx0XHR9O1xuXHR9LFxuXG5cdF9tb3VzZURyYWc6IGZ1bmN0aW9uKGV2ZW50LCBub1Byb3BhZ2F0aW9uKSB7XG5cdFx0Ly8gcmVzZXQgYW55IG5lY2Vzc2FyeSBjYWNoZWQgcHJvcGVydGllcyAoc2VlICM1MDA5KVxuXHRcdGlmICggdGhpcy5oYXNGaXhlZEFuY2VzdG9yICkge1xuXHRcdFx0dGhpcy5vZmZzZXQucGFyZW50ID0gdGhpcy5fZ2V0UGFyZW50T2Zmc2V0KCk7XG5cdFx0fVxuXG5cdFx0Ly9Db21wdXRlIHRoZSBoZWxwZXJzIHBvc2l0aW9uXG5cdFx0dGhpcy5wb3NpdGlvbiA9IHRoaXMuX2dlbmVyYXRlUG9zaXRpb24oIGV2ZW50LCB0cnVlICk7XG5cdFx0dGhpcy5wb3NpdGlvbkFicyA9IHRoaXMuX2NvbnZlcnRQb3NpdGlvblRvKFwiYWJzb2x1dGVcIik7XG5cblx0XHQvL0NhbGwgcGx1Z2lucyBhbmQgY2FsbGJhY2tzIGFuZCB1c2UgdGhlIHJlc3VsdGluZyBwb3NpdGlvbiBpZiBzb21ldGhpbmcgaXMgcmV0dXJuZWRcblx0XHRpZiAoIW5vUHJvcGFnYXRpb24pIHtcblx0XHRcdHZhciB1aSA9IHRoaXMuX3VpSGFzaCgpO1xuXHRcdFx0aWYgKHRoaXMuX3RyaWdnZXIoXCJkcmFnXCIsIGV2ZW50LCB1aSkgPT09IGZhbHNlKSB7XG5cdFx0XHRcdHRoaXMuX21vdXNlVXAoe30pO1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLnBvc2l0aW9uID0gdWkucG9zaXRpb247XG5cdFx0fVxuXG5cdFx0dGhpcy5oZWxwZXJbIDAgXS5zdHlsZS5sZWZ0ID0gdGhpcy5wb3NpdGlvbi5sZWZ0ICsgXCJweFwiO1xuXHRcdHRoaXMuaGVscGVyWyAwIF0uc3R5bGUudG9wID0gdGhpcy5wb3NpdGlvbi50b3AgKyBcInB4XCI7XG5cblx0XHRpZiAoJC51aS5kZG1hbmFnZXIpIHtcblx0XHRcdCQudWkuZGRtYW5hZ2VyLmRyYWcodGhpcywgZXZlbnQpO1xuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fSxcblxuXHRfbW91c2VTdG9wOiBmdW5jdGlvbihldmVudCkge1xuXG5cdFx0Ly9JZiB3ZSBhcmUgdXNpbmcgZHJvcHBhYmxlcywgaW5mb3JtIHRoZSBtYW5hZ2VyIGFib3V0IHRoZSBkcm9wXG5cdFx0dmFyIHRoYXQgPSB0aGlzLFxuXHRcdFx0ZHJvcHBlZCA9IGZhbHNlO1xuXHRcdGlmICgkLnVpLmRkbWFuYWdlciAmJiAhdGhpcy5vcHRpb25zLmRyb3BCZWhhdmlvdXIpIHtcblx0XHRcdGRyb3BwZWQgPSAkLnVpLmRkbWFuYWdlci5kcm9wKHRoaXMsIGV2ZW50KTtcblx0XHR9XG5cblx0XHQvL2lmIGEgZHJvcCBjb21lcyBmcm9tIG91dHNpZGUgKGEgc29ydGFibGUpXG5cdFx0aWYgKHRoaXMuZHJvcHBlZCkge1xuXHRcdFx0ZHJvcHBlZCA9IHRoaXMuZHJvcHBlZDtcblx0XHRcdHRoaXMuZHJvcHBlZCA9IGZhbHNlO1xuXHRcdH1cblxuXHRcdGlmICgodGhpcy5vcHRpb25zLnJldmVydCA9PT0gXCJpbnZhbGlkXCIgJiYgIWRyb3BwZWQpIHx8ICh0aGlzLm9wdGlvbnMucmV2ZXJ0ID09PSBcInZhbGlkXCIgJiYgZHJvcHBlZCkgfHwgdGhpcy5vcHRpb25zLnJldmVydCA9PT0gdHJ1ZSB8fCAoJC5pc0Z1bmN0aW9uKHRoaXMub3B0aW9ucy5yZXZlcnQpICYmIHRoaXMub3B0aW9ucy5yZXZlcnQuY2FsbCh0aGlzLmVsZW1lbnQsIGRyb3BwZWQpKSkge1xuXHRcdFx0JCh0aGlzLmhlbHBlcikuYW5pbWF0ZSh0aGlzLm9yaWdpbmFsUG9zaXRpb24sIHBhcnNlSW50KHRoaXMub3B0aW9ucy5yZXZlcnREdXJhdGlvbiwgMTApLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKHRoYXQuX3RyaWdnZXIoXCJzdG9wXCIsIGV2ZW50KSAhPT0gZmFsc2UpIHtcblx0XHRcdFx0XHR0aGF0Ll9jbGVhcigpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKHRoaXMuX3RyaWdnZXIoXCJzdG9wXCIsIGV2ZW50KSAhPT0gZmFsc2UpIHtcblx0XHRcdFx0dGhpcy5fY2xlYXIoKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH0sXG5cblx0X21vdXNlVXA6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR0aGlzLl91bmJsb2NrRnJhbWVzKCk7XG5cblx0XHQvL0lmIHRoZSBkZG1hbmFnZXIgaXMgdXNlZCBmb3IgZHJvcHBhYmxlcywgaW5mb3JtIHRoZSBtYW5hZ2VyIHRoYXQgZHJhZ2dpbmcgaGFzIHN0b3BwZWQgKHNlZSAjNTAwMylcblx0XHRpZiAoICQudWkuZGRtYW5hZ2VyICkge1xuXHRcdFx0JC51aS5kZG1hbmFnZXIuZHJhZ1N0b3AodGhpcywgZXZlbnQpO1xuXHRcdH1cblxuXHRcdC8vIE9ubHkgbmVlZCB0byBmb2N1cyBpZiB0aGUgZXZlbnQgb2NjdXJyZWQgb24gdGhlIGRyYWdnYWJsZSBpdHNlbGYsIHNlZSAjMTA1Mjdcblx0XHRpZiAoIHRoaXMuaGFuZGxlRWxlbWVudC5pcyggZXZlbnQudGFyZ2V0ICkgKSB7XG5cdFx0XHQvLyBUaGUgaW50ZXJhY3Rpb24gaXMgb3Zlcjsgd2hldGhlciBvciBub3QgdGhlIGNsaWNrIHJlc3VsdGVkIGluIGEgZHJhZywgZm9jdXMgdGhlIGVsZW1lbnRcblx0XHRcdHRoaXMuZWxlbWVudC5mb2N1cygpO1xuXHRcdH1cblxuXHRcdHJldHVybiAkLnVpLm1vdXNlLnByb3RvdHlwZS5fbW91c2VVcC5jYWxsKHRoaXMsIGV2ZW50KTtcblx0fSxcblxuXHRjYW5jZWw6IGZ1bmN0aW9uKCkge1xuXG5cdFx0aWYgKHRoaXMuaGVscGVyLmlzKFwiLnVpLWRyYWdnYWJsZS1kcmFnZ2luZ1wiKSkge1xuXHRcdFx0dGhpcy5fbW91c2VVcCh7fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuX2NsZWFyKCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXM7XG5cblx0fSxcblxuXHRfZ2V0SGFuZGxlOiBmdW5jdGlvbihldmVudCkge1xuXHRcdHJldHVybiB0aGlzLm9wdGlvbnMuaGFuZGxlID9cblx0XHRcdCEhJCggZXZlbnQudGFyZ2V0ICkuY2xvc2VzdCggdGhpcy5lbGVtZW50LmZpbmQoIHRoaXMub3B0aW9ucy5oYW5kbGUgKSApLmxlbmd0aCA6XG5cdFx0XHR0cnVlO1xuXHR9LFxuXG5cdF9zZXRIYW5kbGVDbGFzc05hbWU6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuaGFuZGxlRWxlbWVudCA9IHRoaXMub3B0aW9ucy5oYW5kbGUgP1xuXHRcdFx0dGhpcy5lbGVtZW50LmZpbmQoIHRoaXMub3B0aW9ucy5oYW5kbGUgKSA6IHRoaXMuZWxlbWVudDtcblx0XHR0aGlzLmhhbmRsZUVsZW1lbnQuYWRkQ2xhc3MoIFwidWktZHJhZ2dhYmxlLWhhbmRsZVwiICk7XG5cdH0sXG5cblx0X3JlbW92ZUhhbmRsZUNsYXNzTmFtZTogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5oYW5kbGVFbGVtZW50LnJlbW92ZUNsYXNzKCBcInVpLWRyYWdnYWJsZS1oYW5kbGVcIiApO1xuXHR9LFxuXG5cdF9jcmVhdGVIZWxwZXI6IGZ1bmN0aW9uKGV2ZW50KSB7XG5cblx0XHR2YXIgbyA9IHRoaXMub3B0aW9ucyxcblx0XHRcdGhlbHBlcklzRnVuY3Rpb24gPSAkLmlzRnVuY3Rpb24oIG8uaGVscGVyICksXG5cdFx0XHRoZWxwZXIgPSBoZWxwZXJJc0Z1bmN0aW9uID9cblx0XHRcdFx0JCggby5oZWxwZXIuYXBwbHkoIHRoaXMuZWxlbWVudFsgMCBdLCBbIGV2ZW50IF0gKSApIDpcblx0XHRcdFx0KCBvLmhlbHBlciA9PT0gXCJjbG9uZVwiID9cblx0XHRcdFx0XHR0aGlzLmVsZW1lbnQuY2xvbmUoKS5yZW1vdmVBdHRyKCBcImlkXCIgKSA6XG5cdFx0XHRcdFx0dGhpcy5lbGVtZW50ICk7XG5cblx0XHRpZiAoIWhlbHBlci5wYXJlbnRzKFwiYm9keVwiKS5sZW5ndGgpIHtcblx0XHRcdGhlbHBlci5hcHBlbmRUbygoby5hcHBlbmRUbyA9PT0gXCJwYXJlbnRcIiA/IHRoaXMuZWxlbWVudFswXS5wYXJlbnROb2RlIDogby5hcHBlbmRUbykpO1xuXHRcdH1cblxuXHRcdC8vIGh0dHA6Ly9idWdzLmpxdWVyeXVpLmNvbS90aWNrZXQvOTQ0NlxuXHRcdC8vIGEgaGVscGVyIGZ1bmN0aW9uIGNhbiByZXR1cm4gdGhlIG9yaWdpbmFsIGVsZW1lbnRcblx0XHQvLyB3aGljaCB3b3VsZG4ndCBoYXZlIGJlZW4gc2V0IHRvIHJlbGF0aXZlIGluIF9jcmVhdGVcblx0XHRpZiAoIGhlbHBlcklzRnVuY3Rpb24gJiYgaGVscGVyWyAwIF0gPT09IHRoaXMuZWxlbWVudFsgMCBdICkge1xuXHRcdFx0dGhpcy5fc2V0UG9zaXRpb25SZWxhdGl2ZSgpO1xuXHRcdH1cblxuXHRcdGlmIChoZWxwZXJbMF0gIT09IHRoaXMuZWxlbWVudFswXSAmJiAhKC8oZml4ZWR8YWJzb2x1dGUpLykudGVzdChoZWxwZXIuY3NzKFwicG9zaXRpb25cIikpKSB7XG5cdFx0XHRoZWxwZXIuY3NzKFwicG9zaXRpb25cIiwgXCJhYnNvbHV0ZVwiKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gaGVscGVyO1xuXG5cdH0sXG5cblx0X3NldFBvc2l0aW9uUmVsYXRpdmU6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICggISggL14oPzpyfGF8ZikvICkudGVzdCggdGhpcy5lbGVtZW50LmNzcyggXCJwb3NpdGlvblwiICkgKSApIHtcblx0XHRcdHRoaXMuZWxlbWVudFsgMCBdLnN0eWxlLnBvc2l0aW9uID0gXCJyZWxhdGl2ZVwiO1xuXHRcdH1cblx0fSxcblxuXHRfYWRqdXN0T2Zmc2V0RnJvbUhlbHBlcjogZnVuY3Rpb24ob2JqKSB7XG5cdFx0aWYgKHR5cGVvZiBvYmogPT09IFwic3RyaW5nXCIpIHtcblx0XHRcdG9iaiA9IG9iai5zcGxpdChcIiBcIik7XG5cdFx0fVxuXHRcdGlmICgkLmlzQXJyYXkob2JqKSkge1xuXHRcdFx0b2JqID0geyBsZWZ0OiArb2JqWzBdLCB0b3A6ICtvYmpbMV0gfHwgMCB9O1xuXHRcdH1cblx0XHRpZiAoXCJsZWZ0XCIgaW4gb2JqKSB7XG5cdFx0XHR0aGlzLm9mZnNldC5jbGljay5sZWZ0ID0gb2JqLmxlZnQgKyB0aGlzLm1hcmdpbnMubGVmdDtcblx0XHR9XG5cdFx0aWYgKFwicmlnaHRcIiBpbiBvYmopIHtcblx0XHRcdHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPSB0aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoIC0gb2JqLnJpZ2h0ICsgdGhpcy5tYXJnaW5zLmxlZnQ7XG5cdFx0fVxuXHRcdGlmIChcInRvcFwiIGluIG9iaikge1xuXHRcdFx0dGhpcy5vZmZzZXQuY2xpY2sudG9wID0gb2JqLnRvcCArIHRoaXMubWFyZ2lucy50b3A7XG5cdFx0fVxuXHRcdGlmIChcImJvdHRvbVwiIGluIG9iaikge1xuXHRcdFx0dGhpcy5vZmZzZXQuY2xpY2sudG9wID0gdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQgLSBvYmouYm90dG9tICsgdGhpcy5tYXJnaW5zLnRvcDtcblx0XHR9XG5cdH0sXG5cblx0X2lzUm9vdE5vZGU6IGZ1bmN0aW9uKCBlbGVtZW50ICkge1xuXHRcdHJldHVybiAoIC8oaHRtbHxib2R5KS9pICkudGVzdCggZWxlbWVudC50YWdOYW1lICkgfHwgZWxlbWVudCA9PT0gdGhpcy5kb2N1bWVudFsgMCBdO1xuXHR9LFxuXG5cdF9nZXRQYXJlbnRPZmZzZXQ6IGZ1bmN0aW9uKCkge1xuXG5cdFx0Ly9HZXQgdGhlIG9mZnNldFBhcmVudCBhbmQgY2FjaGUgaXRzIHBvc2l0aW9uXG5cdFx0dmFyIHBvID0gdGhpcy5vZmZzZXRQYXJlbnQub2Zmc2V0KCksXG5cdFx0XHRkb2N1bWVudCA9IHRoaXMuZG9jdW1lbnRbIDAgXTtcblxuXHRcdC8vIFRoaXMgaXMgYSBzcGVjaWFsIGNhc2Ugd2hlcmUgd2UgbmVlZCB0byBtb2RpZnkgYSBvZmZzZXQgY2FsY3VsYXRlZCBvbiBzdGFydCwgc2luY2UgdGhlIGZvbGxvd2luZyBoYXBwZW5lZDpcblx0XHQvLyAxLiBUaGUgcG9zaXRpb24gb2YgdGhlIGhlbHBlciBpcyBhYnNvbHV0ZSwgc28gaXQncyBwb3NpdGlvbiBpcyBjYWxjdWxhdGVkIGJhc2VkIG9uIHRoZSBuZXh0IHBvc2l0aW9uZWQgcGFyZW50XG5cdFx0Ly8gMi4gVGhlIGFjdHVhbCBvZmZzZXQgcGFyZW50IGlzIGEgY2hpbGQgb2YgdGhlIHNjcm9sbCBwYXJlbnQsIGFuZCB0aGUgc2Nyb2xsIHBhcmVudCBpc24ndCB0aGUgZG9jdW1lbnQsIHdoaWNoIG1lYW5zIHRoYXRcblx0XHQvLyAgICB0aGUgc2Nyb2xsIGlzIGluY2x1ZGVkIGluIHRoZSBpbml0aWFsIGNhbGN1bGF0aW9uIG9mIHRoZSBvZmZzZXQgb2YgdGhlIHBhcmVudCwgYW5kIG5ldmVyIHJlY2FsY3VsYXRlZCB1cG9uIGRyYWdcblx0XHRpZiAodGhpcy5jc3NQb3NpdGlvbiA9PT0gXCJhYnNvbHV0ZVwiICYmIHRoaXMuc2Nyb2xsUGFyZW50WzBdICE9PSBkb2N1bWVudCAmJiAkLmNvbnRhaW5zKHRoaXMuc2Nyb2xsUGFyZW50WzBdLCB0aGlzLm9mZnNldFBhcmVudFswXSkpIHtcblx0XHRcdHBvLmxlZnQgKz0gdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCgpO1xuXHRcdFx0cG8udG9wICs9IHRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpO1xuXHRcdH1cblxuXHRcdGlmICggdGhpcy5faXNSb290Tm9kZSggdGhpcy5vZmZzZXRQYXJlbnRbIDAgXSApICkge1xuXHRcdFx0cG8gPSB7IHRvcDogMCwgbGVmdDogMCB9O1xuXHRcdH1cblxuXHRcdHJldHVybiB7XG5cdFx0XHR0b3A6IHBvLnRvcCArIChwYXJzZUludCh0aGlzLm9mZnNldFBhcmVudC5jc3MoXCJib3JkZXJUb3BXaWR0aFwiKSwgMTApIHx8IDApLFxuXHRcdFx0bGVmdDogcG8ubGVmdCArIChwYXJzZUludCh0aGlzLm9mZnNldFBhcmVudC5jc3MoXCJib3JkZXJMZWZ0V2lkdGhcIiksIDEwKSB8fCAwKVxuXHRcdH07XG5cblx0fSxcblxuXHRfZ2V0UmVsYXRpdmVPZmZzZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICggdGhpcy5jc3NQb3NpdGlvbiAhPT0gXCJyZWxhdGl2ZVwiICkge1xuXHRcdFx0cmV0dXJuIHsgdG9wOiAwLCBsZWZ0OiAwIH07XG5cdFx0fVxuXG5cdFx0dmFyIHAgPSB0aGlzLmVsZW1lbnQucG9zaXRpb24oKSxcblx0XHRcdHNjcm9sbElzUm9vdE5vZGUgPSB0aGlzLl9pc1Jvb3ROb2RlKCB0aGlzLnNjcm9sbFBhcmVudFsgMCBdICk7XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0dG9wOiBwLnRvcCAtICggcGFyc2VJbnQodGhpcy5oZWxwZXIuY3NzKCBcInRvcFwiICksIDEwKSB8fCAwICkgKyAoICFzY3JvbGxJc1Jvb3ROb2RlID8gdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsVG9wKCkgOiAwICksXG5cdFx0XHRsZWZ0OiBwLmxlZnQgLSAoIHBhcnNlSW50KHRoaXMuaGVscGVyLmNzcyggXCJsZWZ0XCIgKSwgMTApIHx8IDAgKSArICggIXNjcm9sbElzUm9vdE5vZGUgPyB0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KCkgOiAwIClcblx0XHR9O1xuXG5cdH0sXG5cblx0X2NhY2hlTWFyZ2luczogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5tYXJnaW5zID0ge1xuXHRcdFx0bGVmdDogKHBhcnNlSW50KHRoaXMuZWxlbWVudC5jc3MoXCJtYXJnaW5MZWZ0XCIpLCAxMCkgfHwgMCksXG5cdFx0XHR0b3A6IChwYXJzZUludCh0aGlzLmVsZW1lbnQuY3NzKFwibWFyZ2luVG9wXCIpLCAxMCkgfHwgMCksXG5cdFx0XHRyaWdodDogKHBhcnNlSW50KHRoaXMuZWxlbWVudC5jc3MoXCJtYXJnaW5SaWdodFwiKSwgMTApIHx8IDApLFxuXHRcdFx0Ym90dG9tOiAocGFyc2VJbnQodGhpcy5lbGVtZW50LmNzcyhcIm1hcmdpbkJvdHRvbVwiKSwgMTApIHx8IDApXG5cdFx0fTtcblx0fSxcblxuXHRfY2FjaGVIZWxwZXJQcm9wb3J0aW9uczogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5oZWxwZXJQcm9wb3J0aW9ucyA9IHtcblx0XHRcdHdpZHRoOiB0aGlzLmhlbHBlci5vdXRlcldpZHRoKCksXG5cdFx0XHRoZWlnaHQ6IHRoaXMuaGVscGVyLm91dGVySGVpZ2h0KClcblx0XHR9O1xuXHR9LFxuXG5cdF9zZXRDb250YWlubWVudDogZnVuY3Rpb24oKSB7XG5cblx0XHR2YXIgaXNVc2VyU2Nyb2xsYWJsZSwgYywgY2UsXG5cdFx0XHRvID0gdGhpcy5vcHRpb25zLFxuXHRcdFx0ZG9jdW1lbnQgPSB0aGlzLmRvY3VtZW50WyAwIF07XG5cblx0XHR0aGlzLnJlbGF0aXZlQ29udGFpbmVyID0gbnVsbDtcblxuXHRcdGlmICggIW8uY29udGFpbm1lbnQgKSB7XG5cdFx0XHR0aGlzLmNvbnRhaW5tZW50ID0gbnVsbDtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAoIG8uY29udGFpbm1lbnQgPT09IFwid2luZG93XCIgKSB7XG5cdFx0XHR0aGlzLmNvbnRhaW5tZW50ID0gW1xuXHRcdFx0XHQkKCB3aW5kb3cgKS5zY3JvbGxMZWZ0KCkgLSB0aGlzLm9mZnNldC5yZWxhdGl2ZS5sZWZ0IC0gdGhpcy5vZmZzZXQucGFyZW50LmxlZnQsXG5cdFx0XHRcdCQoIHdpbmRvdyApLnNjcm9sbFRvcCgpIC0gdGhpcy5vZmZzZXQucmVsYXRpdmUudG9wIC0gdGhpcy5vZmZzZXQucGFyZW50LnRvcCxcblx0XHRcdFx0JCggd2luZG93ICkuc2Nyb2xsTGVmdCgpICsgJCggd2luZG93ICkud2lkdGgoKSAtIHRoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGggLSB0aGlzLm1hcmdpbnMubGVmdCxcblx0XHRcdFx0JCggd2luZG93ICkuc2Nyb2xsVG9wKCkgKyAoICQoIHdpbmRvdyApLmhlaWdodCgpIHx8IGRvY3VtZW50LmJvZHkucGFyZW50Tm9kZS5zY3JvbGxIZWlnaHQgKSAtIHRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0IC0gdGhpcy5tYXJnaW5zLnRvcFxuXHRcdFx0XTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAoIG8uY29udGFpbm1lbnQgPT09IFwiZG9jdW1lbnRcIikge1xuXHRcdFx0dGhpcy5jb250YWlubWVudCA9IFtcblx0XHRcdFx0MCxcblx0XHRcdFx0MCxcblx0XHRcdFx0JCggZG9jdW1lbnQgKS53aWR0aCgpIC0gdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAtIHRoaXMubWFyZ2lucy5sZWZ0LFxuXHRcdFx0XHQoICQoIGRvY3VtZW50ICkuaGVpZ2h0KCkgfHwgZG9jdW1lbnQuYm9keS5wYXJlbnROb2RlLnNjcm9sbEhlaWdodCApIC0gdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQgLSB0aGlzLm1hcmdpbnMudG9wXG5cdFx0XHRdO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGlmICggby5jb250YWlubWVudC5jb25zdHJ1Y3RvciA9PT0gQXJyYXkgKSB7XG5cdFx0XHR0aGlzLmNvbnRhaW5tZW50ID0gby5jb250YWlubWVudDtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAoIG8uY29udGFpbm1lbnQgPT09IFwicGFyZW50XCIgKSB7XG5cdFx0XHRvLmNvbnRhaW5tZW50ID0gdGhpcy5oZWxwZXJbIDAgXS5wYXJlbnROb2RlO1xuXHRcdH1cblxuXHRcdGMgPSAkKCBvLmNvbnRhaW5tZW50ICk7XG5cdFx0Y2UgPSBjWyAwIF07XG5cblx0XHRpZiAoICFjZSApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpc1VzZXJTY3JvbGxhYmxlID0gLyhzY3JvbGx8YXV0bykvLnRlc3QoIGMuY3NzKCBcIm92ZXJmbG93XCIgKSApO1xuXG5cdFx0dGhpcy5jb250YWlubWVudCA9IFtcblx0XHRcdCggcGFyc2VJbnQoIGMuY3NzKCBcImJvcmRlckxlZnRXaWR0aFwiICksIDEwICkgfHwgMCApICsgKCBwYXJzZUludCggYy5jc3MoIFwicGFkZGluZ0xlZnRcIiApLCAxMCApIHx8IDAgKSxcblx0XHRcdCggcGFyc2VJbnQoIGMuY3NzKCBcImJvcmRlclRvcFdpZHRoXCIgKSwgMTAgKSB8fCAwICkgKyAoIHBhcnNlSW50KCBjLmNzcyggXCJwYWRkaW5nVG9wXCIgKSwgMTAgKSB8fCAwICksXG5cdFx0XHQoIGlzVXNlclNjcm9sbGFibGUgPyBNYXRoLm1heCggY2Uuc2Nyb2xsV2lkdGgsIGNlLm9mZnNldFdpZHRoICkgOiBjZS5vZmZzZXRXaWR0aCApIC1cblx0XHRcdFx0KCBwYXJzZUludCggYy5jc3MoIFwiYm9yZGVyUmlnaHRXaWR0aFwiICksIDEwICkgfHwgMCApIC1cblx0XHRcdFx0KCBwYXJzZUludCggYy5jc3MoIFwicGFkZGluZ1JpZ2h0XCIgKSwgMTAgKSB8fCAwICkgLVxuXHRcdFx0XHR0aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoIC1cblx0XHRcdFx0dGhpcy5tYXJnaW5zLmxlZnQgLVxuXHRcdFx0XHR0aGlzLm1hcmdpbnMucmlnaHQsXG5cdFx0XHQoIGlzVXNlclNjcm9sbGFibGUgPyBNYXRoLm1heCggY2Uuc2Nyb2xsSGVpZ2h0LCBjZS5vZmZzZXRIZWlnaHQgKSA6IGNlLm9mZnNldEhlaWdodCApIC1cblx0XHRcdFx0KCBwYXJzZUludCggYy5jc3MoIFwiYm9yZGVyQm90dG9tV2lkdGhcIiApLCAxMCApIHx8IDAgKSAtXG5cdFx0XHRcdCggcGFyc2VJbnQoIGMuY3NzKCBcInBhZGRpbmdCb3R0b21cIiApLCAxMCApIHx8IDAgKSAtXG5cdFx0XHRcdHRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0IC1cblx0XHRcdFx0dGhpcy5tYXJnaW5zLnRvcCAtXG5cdFx0XHRcdHRoaXMubWFyZ2lucy5ib3R0b21cblx0XHRdO1xuXHRcdHRoaXMucmVsYXRpdmVDb250YWluZXIgPSBjO1xuXHR9LFxuXG5cdF9jb252ZXJ0UG9zaXRpb25UbzogZnVuY3Rpb24oZCwgcG9zKSB7XG5cblx0XHRpZiAoIXBvcykge1xuXHRcdFx0cG9zID0gdGhpcy5wb3NpdGlvbjtcblx0XHR9XG5cblx0XHR2YXIgbW9kID0gZCA9PT0gXCJhYnNvbHV0ZVwiID8gMSA6IC0xLFxuXHRcdFx0c2Nyb2xsSXNSb290Tm9kZSA9IHRoaXMuX2lzUm9vdE5vZGUoIHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0gKTtcblxuXHRcdHJldHVybiB7XG5cdFx0XHR0b3A6IChcblx0XHRcdFx0cG9zLnRvcFx0K1x0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIGFic29sdXRlIG1vdXNlIHBvc2l0aW9uXG5cdFx0XHRcdHRoaXMub2Zmc2V0LnJlbGF0aXZlLnRvcCAqIG1vZCArXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBPbmx5IGZvciByZWxhdGl2ZSBwb3NpdGlvbmVkIG5vZGVzOiBSZWxhdGl2ZSBvZmZzZXQgZnJvbSBlbGVtZW50IHRvIG9mZnNldCBwYXJlbnRcblx0XHRcdFx0dGhpcy5vZmZzZXQucGFyZW50LnRvcCAqIG1vZCAtXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBUaGUgb2Zmc2V0UGFyZW50J3Mgb2Zmc2V0IHdpdGhvdXQgYm9yZGVycyAob2Zmc2V0ICsgYm9yZGVyKVxuXHRcdFx0XHQoICggdGhpcy5jc3NQb3NpdGlvbiA9PT0gXCJmaXhlZFwiID8gLXRoaXMub2Zmc2V0LnNjcm9sbC50b3AgOiAoIHNjcm9sbElzUm9vdE5vZGUgPyAwIDogdGhpcy5vZmZzZXQuc2Nyb2xsLnRvcCApICkgKiBtb2QpXG5cdFx0XHQpLFxuXHRcdFx0bGVmdDogKFxuXHRcdFx0XHRwb3MubGVmdCArXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBUaGUgYWJzb2x1dGUgbW91c2UgcG9zaXRpb25cblx0XHRcdFx0dGhpcy5vZmZzZXQucmVsYXRpdmUubGVmdCAqIG1vZCArXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBPbmx5IGZvciByZWxhdGl2ZSBwb3NpdGlvbmVkIG5vZGVzOiBSZWxhdGl2ZSBvZmZzZXQgZnJvbSBlbGVtZW50IHRvIG9mZnNldCBwYXJlbnRcblx0XHRcdFx0dGhpcy5vZmZzZXQucGFyZW50LmxlZnQgKiBtb2RcdC1cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRoZSBvZmZzZXRQYXJlbnQncyBvZmZzZXQgd2l0aG91dCBib3JkZXJzIChvZmZzZXQgKyBib3JkZXIpXG5cdFx0XHRcdCggKCB0aGlzLmNzc1Bvc2l0aW9uID09PSBcImZpeGVkXCIgPyAtdGhpcy5vZmZzZXQuc2Nyb2xsLmxlZnQgOiAoIHNjcm9sbElzUm9vdE5vZGUgPyAwIDogdGhpcy5vZmZzZXQuc2Nyb2xsLmxlZnQgKSApICogbW9kKVxuXHRcdFx0KVxuXHRcdH07XG5cblx0fSxcblxuXHRfZ2VuZXJhdGVQb3NpdGlvbjogZnVuY3Rpb24oIGV2ZW50LCBjb25zdHJhaW5Qb3NpdGlvbiApIHtcblxuXHRcdHZhciBjb250YWlubWVudCwgY28sIHRvcCwgbGVmdCxcblx0XHRcdG8gPSB0aGlzLm9wdGlvbnMsXG5cdFx0XHRzY3JvbGxJc1Jvb3ROb2RlID0gdGhpcy5faXNSb290Tm9kZSggdGhpcy5zY3JvbGxQYXJlbnRbIDAgXSApLFxuXHRcdFx0cGFnZVggPSBldmVudC5wYWdlWCxcblx0XHRcdHBhZ2VZID0gZXZlbnQucGFnZVk7XG5cblx0XHQvLyBDYWNoZSB0aGUgc2Nyb2xsXG5cdFx0aWYgKCAhc2Nyb2xsSXNSb290Tm9kZSB8fCAhdGhpcy5vZmZzZXQuc2Nyb2xsICkge1xuXHRcdFx0dGhpcy5vZmZzZXQuc2Nyb2xsID0ge1xuXHRcdFx0XHR0b3A6IHRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpLFxuXHRcdFx0XHRsZWZ0OiB0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KClcblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0Lypcblx0XHQgKiAtIFBvc2l0aW9uIGNvbnN0cmFpbmluZyAtXG5cdFx0ICogQ29uc3RyYWluIHRoZSBwb3NpdGlvbiB0byBhIG1peCBvZiBncmlkLCBjb250YWlubWVudC5cblx0XHQgKi9cblxuXHRcdC8vIElmIHdlIGFyZSBub3QgZHJhZ2dpbmcgeWV0LCB3ZSB3b24ndCBjaGVjayBmb3Igb3B0aW9uc1xuXHRcdGlmICggY29uc3RyYWluUG9zaXRpb24gKSB7XG5cdFx0XHRpZiAoIHRoaXMuY29udGFpbm1lbnQgKSB7XG5cdFx0XHRcdGlmICggdGhpcy5yZWxhdGl2ZUNvbnRhaW5lciApe1xuXHRcdFx0XHRcdGNvID0gdGhpcy5yZWxhdGl2ZUNvbnRhaW5lci5vZmZzZXQoKTtcblx0XHRcdFx0XHRjb250YWlubWVudCA9IFtcblx0XHRcdFx0XHRcdHRoaXMuY29udGFpbm1lbnRbIDAgXSArIGNvLmxlZnQsXG5cdFx0XHRcdFx0XHR0aGlzLmNvbnRhaW5tZW50WyAxIF0gKyBjby50b3AsXG5cdFx0XHRcdFx0XHR0aGlzLmNvbnRhaW5tZW50WyAyIF0gKyBjby5sZWZ0LFxuXHRcdFx0XHRcdFx0dGhpcy5jb250YWlubWVudFsgMyBdICsgY28udG9wXG5cdFx0XHRcdFx0XTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjb250YWlubWVudCA9IHRoaXMuY29udGFpbm1lbnQ7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoZXZlbnQucGFnZVggLSB0aGlzLm9mZnNldC5jbGljay5sZWZ0IDwgY29udGFpbm1lbnRbMF0pIHtcblx0XHRcdFx0XHRwYWdlWCA9IGNvbnRhaW5tZW50WzBdICsgdGhpcy5vZmZzZXQuY2xpY2subGVmdDtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoZXZlbnQucGFnZVkgLSB0aGlzLm9mZnNldC5jbGljay50b3AgPCBjb250YWlubWVudFsxXSkge1xuXHRcdFx0XHRcdHBhZ2VZID0gY29udGFpbm1lbnRbMV0gKyB0aGlzLm9mZnNldC5jbGljay50b3A7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKGV2ZW50LnBhZ2VYIC0gdGhpcy5vZmZzZXQuY2xpY2subGVmdCA+IGNvbnRhaW5tZW50WzJdKSB7XG5cdFx0XHRcdFx0cGFnZVggPSBjb250YWlubWVudFsyXSArIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKGV2ZW50LnBhZ2VZIC0gdGhpcy5vZmZzZXQuY2xpY2sudG9wID4gY29udGFpbm1lbnRbM10pIHtcblx0XHRcdFx0XHRwYWdlWSA9IGNvbnRhaW5tZW50WzNdICsgdGhpcy5vZmZzZXQuY2xpY2sudG9wO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmIChvLmdyaWQpIHtcblx0XHRcdFx0Ly9DaGVjayBmb3IgZ3JpZCBlbGVtZW50cyBzZXQgdG8gMCB0byBwcmV2ZW50IGRpdmlkZSBieSAwIGVycm9yIGNhdXNpbmcgaW52YWxpZCBhcmd1bWVudCBlcnJvcnMgaW4gSUUgKHNlZSB0aWNrZXQgIzY5NTApXG5cdFx0XHRcdHRvcCA9IG8uZ3JpZFsxXSA/IHRoaXMub3JpZ2luYWxQYWdlWSArIE1hdGgucm91bmQoKHBhZ2VZIC0gdGhpcy5vcmlnaW5hbFBhZ2VZKSAvIG8uZ3JpZFsxXSkgKiBvLmdyaWRbMV0gOiB0aGlzLm9yaWdpbmFsUGFnZVk7XG5cdFx0XHRcdHBhZ2VZID0gY29udGFpbm1lbnQgPyAoKHRvcCAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA+PSBjb250YWlubWVudFsxXSB8fCB0b3AgLSB0aGlzLm9mZnNldC5jbGljay50b3AgPiBjb250YWlubWVudFszXSkgPyB0b3AgOiAoKHRvcCAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA+PSBjb250YWlubWVudFsxXSkgPyB0b3AgLSBvLmdyaWRbMV0gOiB0b3AgKyBvLmdyaWRbMV0pKSA6IHRvcDtcblxuXHRcdFx0XHRsZWZ0ID0gby5ncmlkWzBdID8gdGhpcy5vcmlnaW5hbFBhZ2VYICsgTWF0aC5yb3VuZCgocGFnZVggLSB0aGlzLm9yaWdpbmFsUGFnZVgpIC8gby5ncmlkWzBdKSAqIG8uZ3JpZFswXSA6IHRoaXMub3JpZ2luYWxQYWdlWDtcblx0XHRcdFx0cGFnZVggPSBjb250YWlubWVudCA/ICgobGVmdCAtIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPj0gY29udGFpbm1lbnRbMF0gfHwgbGVmdCAtIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPiBjb250YWlubWVudFsyXSkgPyBsZWZ0IDogKChsZWZ0IC0gdGhpcy5vZmZzZXQuY2xpY2subGVmdCA+PSBjb250YWlubWVudFswXSkgPyBsZWZ0IC0gby5ncmlkWzBdIDogbGVmdCArIG8uZ3JpZFswXSkpIDogbGVmdDtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCBvLmF4aXMgPT09IFwieVwiICkge1xuXHRcdFx0XHRwYWdlWCA9IHRoaXMub3JpZ2luYWxQYWdlWDtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCBvLmF4aXMgPT09IFwieFwiICkge1xuXHRcdFx0XHRwYWdlWSA9IHRoaXMub3JpZ2luYWxQYWdlWTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0dG9wOiAoXG5cdFx0XHRcdHBhZ2VZIC1cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIGFic29sdXRlIG1vdXNlIHBvc2l0aW9uXG5cdFx0XHRcdHRoaXMub2Zmc2V0LmNsaWNrLnRvcFx0LVx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIENsaWNrIG9mZnNldCAocmVsYXRpdmUgdG8gdGhlIGVsZW1lbnQpXG5cdFx0XHRcdHRoaXMub2Zmc2V0LnJlbGF0aXZlLnRvcCAtXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gT25seSBmb3IgcmVsYXRpdmUgcG9zaXRpb25lZCBub2RlczogUmVsYXRpdmUgb2Zmc2V0IGZyb20gZWxlbWVudCB0byBvZmZzZXQgcGFyZW50XG5cdFx0XHRcdHRoaXMub2Zmc2V0LnBhcmVudC50b3AgK1x0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRoZSBvZmZzZXRQYXJlbnQncyBvZmZzZXQgd2l0aG91dCBib3JkZXJzIChvZmZzZXQgKyBib3JkZXIpXG5cdFx0XHRcdCggdGhpcy5jc3NQb3NpdGlvbiA9PT0gXCJmaXhlZFwiID8gLXRoaXMub2Zmc2V0LnNjcm9sbC50b3AgOiAoIHNjcm9sbElzUm9vdE5vZGUgPyAwIDogdGhpcy5vZmZzZXQuc2Nyb2xsLnRvcCApIClcblx0XHRcdCksXG5cdFx0XHRsZWZ0OiAoXG5cdFx0XHRcdHBhZ2VYIC1cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIGFic29sdXRlIG1vdXNlIHBvc2l0aW9uXG5cdFx0XHRcdHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgLVx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIENsaWNrIG9mZnNldCAocmVsYXRpdmUgdG8gdGhlIGVsZW1lbnQpXG5cdFx0XHRcdHRoaXMub2Zmc2V0LnJlbGF0aXZlLmxlZnQgLVx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIE9ubHkgZm9yIHJlbGF0aXZlIHBvc2l0aW9uZWQgbm9kZXM6IFJlbGF0aXZlIG9mZnNldCBmcm9tIGVsZW1lbnQgdG8gb2Zmc2V0IHBhcmVudFxuXHRcdFx0XHR0aGlzLm9mZnNldC5wYXJlbnQubGVmdCArXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIG9mZnNldFBhcmVudCdzIG9mZnNldCB3aXRob3V0IGJvcmRlcnMgKG9mZnNldCArIGJvcmRlcilcblx0XHRcdFx0KCB0aGlzLmNzc1Bvc2l0aW9uID09PSBcImZpeGVkXCIgPyAtdGhpcy5vZmZzZXQuc2Nyb2xsLmxlZnQgOiAoIHNjcm9sbElzUm9vdE5vZGUgPyAwIDogdGhpcy5vZmZzZXQuc2Nyb2xsLmxlZnQgKSApXG5cdFx0XHQpXG5cdFx0fTtcblxuXHR9LFxuXG5cdF9jbGVhcjogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5oZWxwZXIucmVtb3ZlQ2xhc3MoXCJ1aS1kcmFnZ2FibGUtZHJhZ2dpbmdcIik7XG5cdFx0aWYgKHRoaXMuaGVscGVyWzBdICE9PSB0aGlzLmVsZW1lbnRbMF0gJiYgIXRoaXMuY2FuY2VsSGVscGVyUmVtb3ZhbCkge1xuXHRcdFx0dGhpcy5oZWxwZXIucmVtb3ZlKCk7XG5cdFx0fVxuXHRcdHRoaXMuaGVscGVyID0gbnVsbDtcblx0XHR0aGlzLmNhbmNlbEhlbHBlclJlbW92YWwgPSBmYWxzZTtcblx0XHRpZiAoIHRoaXMuZGVzdHJveU9uQ2xlYXIgKSB7XG5cdFx0XHR0aGlzLmRlc3Ryb3koKTtcblx0XHR9XG5cdH0sXG5cblx0X25vcm1hbGl6ZVJpZ2h0Qm90dG9tOiBmdW5jdGlvbigpIHtcblx0XHRpZiAoIHRoaXMub3B0aW9ucy5heGlzICE9PSBcInlcIiAmJiB0aGlzLmhlbHBlci5jc3MoIFwicmlnaHRcIiApICE9PSBcImF1dG9cIiApIHtcblx0XHRcdHRoaXMuaGVscGVyLndpZHRoKCB0aGlzLmhlbHBlci53aWR0aCgpICk7XG5cdFx0XHR0aGlzLmhlbHBlci5jc3MoIFwicmlnaHRcIiwgXCJhdXRvXCIgKTtcblx0XHR9XG5cdFx0aWYgKCB0aGlzLm9wdGlvbnMuYXhpcyAhPT0gXCJ4XCIgJiYgdGhpcy5oZWxwZXIuY3NzKCBcImJvdHRvbVwiICkgIT09IFwiYXV0b1wiICkge1xuXHRcdFx0dGhpcy5oZWxwZXIuaGVpZ2h0KCB0aGlzLmhlbHBlci5oZWlnaHQoKSApO1xuXHRcdFx0dGhpcy5oZWxwZXIuY3NzKCBcImJvdHRvbVwiLCBcImF1dG9cIiApO1xuXHRcdH1cblx0fSxcblxuXHQvLyBGcm9tIG5vdyBvbiBidWxrIHN0dWZmIC0gbWFpbmx5IGhlbHBlcnNcblxuXHRfdHJpZ2dlcjogZnVuY3Rpb24oIHR5cGUsIGV2ZW50LCB1aSApIHtcblx0XHR1aSA9IHVpIHx8IHRoaXMuX3VpSGFzaCgpO1xuXHRcdCQudWkucGx1Z2luLmNhbGwoIHRoaXMsIHR5cGUsIFsgZXZlbnQsIHVpLCB0aGlzIF0sIHRydWUgKTtcblxuXHRcdC8vIEFic29sdXRlIHBvc2l0aW9uIGFuZCBvZmZzZXQgKHNlZSAjNjg4NCApIGhhdmUgdG8gYmUgcmVjYWxjdWxhdGVkIGFmdGVyIHBsdWdpbnNcblx0XHRpZiAoIC9eKGRyYWd8c3RhcnR8c3RvcCkvLnRlc3QoIHR5cGUgKSApIHtcblx0XHRcdHRoaXMucG9zaXRpb25BYnMgPSB0aGlzLl9jb252ZXJ0UG9zaXRpb25UbyggXCJhYnNvbHV0ZVwiICk7XG5cdFx0XHR1aS5vZmZzZXQgPSB0aGlzLnBvc2l0aW9uQWJzO1xuXHRcdH1cblx0XHRyZXR1cm4gJC5XaWRnZXQucHJvdG90eXBlLl90cmlnZ2VyLmNhbGwoIHRoaXMsIHR5cGUsIGV2ZW50LCB1aSApO1xuXHR9LFxuXG5cdHBsdWdpbnM6IHt9LFxuXG5cdF91aUhhc2g6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB7XG5cdFx0XHRoZWxwZXI6IHRoaXMuaGVscGVyLFxuXHRcdFx0cG9zaXRpb246IHRoaXMucG9zaXRpb24sXG5cdFx0XHRvcmlnaW5hbFBvc2l0aW9uOiB0aGlzLm9yaWdpbmFsUG9zaXRpb24sXG5cdFx0XHRvZmZzZXQ6IHRoaXMucG9zaXRpb25BYnNcblx0XHR9O1xuXHR9XG5cbn0pO1xuXG4kLnVpLnBsdWdpbi5hZGQoIFwiZHJhZ2dhYmxlXCIsIFwiY29ubmVjdFRvU29ydGFibGVcIiwge1xuXHRzdGFydDogZnVuY3Rpb24oIGV2ZW50LCB1aSwgZHJhZ2dhYmxlICkge1xuXHRcdHZhciB1aVNvcnRhYmxlID0gJC5leHRlbmQoIHt9LCB1aSwge1xuXHRcdFx0aXRlbTogZHJhZ2dhYmxlLmVsZW1lbnRcblx0XHR9KTtcblxuXHRcdGRyYWdnYWJsZS5zb3J0YWJsZXMgPSBbXTtcblx0XHQkKCBkcmFnZ2FibGUub3B0aW9ucy5jb25uZWN0VG9Tb3J0YWJsZSApLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgc29ydGFibGUgPSAkKCB0aGlzICkuc29ydGFibGUoIFwiaW5zdGFuY2VcIiApO1xuXG5cdFx0XHRpZiAoIHNvcnRhYmxlICYmICFzb3J0YWJsZS5vcHRpb25zLmRpc2FibGVkICkge1xuXHRcdFx0XHRkcmFnZ2FibGUuc29ydGFibGVzLnB1c2goIHNvcnRhYmxlICk7XG5cblx0XHRcdFx0Ly8gcmVmcmVzaFBvc2l0aW9ucyBpcyBjYWxsZWQgYXQgZHJhZyBzdGFydCB0byByZWZyZXNoIHRoZSBjb250YWluZXJDYWNoZVxuXHRcdFx0XHQvLyB3aGljaCBpcyB1c2VkIGluIGRyYWcuIFRoaXMgZW5zdXJlcyBpdCdzIGluaXRpYWxpemVkIGFuZCBzeW5jaHJvbml6ZWRcblx0XHRcdFx0Ly8gd2l0aCBhbnkgY2hhbmdlcyB0aGF0IG1pZ2h0IGhhdmUgaGFwcGVuZWQgb24gdGhlIHBhZ2Ugc2luY2UgaW5pdGlhbGl6YXRpb24uXG5cdFx0XHRcdHNvcnRhYmxlLnJlZnJlc2hQb3NpdGlvbnMoKTtcblx0XHRcdFx0c29ydGFibGUuX3RyaWdnZXIoXCJhY3RpdmF0ZVwiLCBldmVudCwgdWlTb3J0YWJsZSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0sXG5cdHN0b3A6IGZ1bmN0aW9uKCBldmVudCwgdWksIGRyYWdnYWJsZSApIHtcblx0XHR2YXIgdWlTb3J0YWJsZSA9ICQuZXh0ZW5kKCB7fSwgdWksIHtcblx0XHRcdGl0ZW06IGRyYWdnYWJsZS5lbGVtZW50XG5cdFx0fSk7XG5cblx0XHRkcmFnZ2FibGUuY2FuY2VsSGVscGVyUmVtb3ZhbCA9IGZhbHNlO1xuXG5cdFx0JC5lYWNoKCBkcmFnZ2FibGUuc29ydGFibGVzLCBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBzb3J0YWJsZSA9IHRoaXM7XG5cblx0XHRcdGlmICggc29ydGFibGUuaXNPdmVyICkge1xuXHRcdFx0XHRzb3J0YWJsZS5pc092ZXIgPSAwO1xuXG5cdFx0XHRcdC8vIEFsbG93IHRoaXMgc29ydGFibGUgdG8gaGFuZGxlIHJlbW92aW5nIHRoZSBoZWxwZXJcblx0XHRcdFx0ZHJhZ2dhYmxlLmNhbmNlbEhlbHBlclJlbW92YWwgPSB0cnVlO1xuXHRcdFx0XHRzb3J0YWJsZS5jYW5jZWxIZWxwZXJSZW1vdmFsID0gZmFsc2U7XG5cblx0XHRcdFx0Ly8gVXNlIF9zdG9yZWRDU1MgVG8gcmVzdG9yZSBwcm9wZXJ0aWVzIGluIHRoZSBzb3J0YWJsZSxcblx0XHRcdFx0Ly8gYXMgdGhpcyBhbHNvIGhhbmRsZXMgcmV2ZXJ0ICgjOTY3NSkgc2luY2UgdGhlIGRyYWdnYWJsZVxuXHRcdFx0XHQvLyBtYXkgaGF2ZSBtb2RpZmllZCB0aGVtIGluIHVuZXhwZWN0ZWQgd2F5cyAoIzg4MDkpXG5cdFx0XHRcdHNvcnRhYmxlLl9zdG9yZWRDU1MgPSB7XG5cdFx0XHRcdFx0cG9zaXRpb246IHNvcnRhYmxlLnBsYWNlaG9sZGVyLmNzcyggXCJwb3NpdGlvblwiICksXG5cdFx0XHRcdFx0dG9wOiBzb3J0YWJsZS5wbGFjZWhvbGRlci5jc3MoIFwidG9wXCIgKSxcblx0XHRcdFx0XHRsZWZ0OiBzb3J0YWJsZS5wbGFjZWhvbGRlci5jc3MoIFwibGVmdFwiIClcblx0XHRcdFx0fTtcblxuXHRcdFx0XHRzb3J0YWJsZS5fbW91c2VTdG9wKGV2ZW50KTtcblxuXHRcdFx0XHQvLyBPbmNlIGRyYWcgaGFzIGVuZGVkLCB0aGUgc29ydGFibGUgc2hvdWxkIHJldHVybiB0byB1c2luZ1xuXHRcdFx0XHQvLyBpdHMgb3JpZ2luYWwgaGVscGVyLCBub3QgdGhlIHNoYXJlZCBoZWxwZXIgZnJvbSBkcmFnZ2FibGVcblx0XHRcdFx0c29ydGFibGUub3B0aW9ucy5oZWxwZXIgPSBzb3J0YWJsZS5vcHRpb25zLl9oZWxwZXI7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBQcmV2ZW50IHRoaXMgU29ydGFibGUgZnJvbSByZW1vdmluZyB0aGUgaGVscGVyLlxuXHRcdFx0XHQvLyBIb3dldmVyLCBkb24ndCBzZXQgdGhlIGRyYWdnYWJsZSB0byByZW1vdmUgdGhlIGhlbHBlclxuXHRcdFx0XHQvLyBlaXRoZXIgYXMgYW5vdGhlciBjb25uZWN0ZWQgU29ydGFibGUgbWF5IHlldCBoYW5kbGUgdGhlIHJlbW92YWwuXG5cdFx0XHRcdHNvcnRhYmxlLmNhbmNlbEhlbHBlclJlbW92YWwgPSB0cnVlO1xuXG5cdFx0XHRcdHNvcnRhYmxlLl90cmlnZ2VyKCBcImRlYWN0aXZhdGVcIiwgZXZlbnQsIHVpU29ydGFibGUgKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSxcblx0ZHJhZzogZnVuY3Rpb24oIGV2ZW50LCB1aSwgZHJhZ2dhYmxlICkge1xuXHRcdCQuZWFjaCggZHJhZ2dhYmxlLnNvcnRhYmxlcywgZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgaW5uZXJtb3N0SW50ZXJzZWN0aW5nID0gZmFsc2UsXG5cdFx0XHRcdHNvcnRhYmxlID0gdGhpcztcblxuXHRcdFx0Ly8gQ29weSBvdmVyIHZhcmlhYmxlcyB0aGF0IHNvcnRhYmxlJ3MgX2ludGVyc2VjdHNXaXRoIHVzZXNcblx0XHRcdHNvcnRhYmxlLnBvc2l0aW9uQWJzID0gZHJhZ2dhYmxlLnBvc2l0aW9uQWJzO1xuXHRcdFx0c29ydGFibGUuaGVscGVyUHJvcG9ydGlvbnMgPSBkcmFnZ2FibGUuaGVscGVyUHJvcG9ydGlvbnM7XG5cdFx0XHRzb3J0YWJsZS5vZmZzZXQuY2xpY2sgPSBkcmFnZ2FibGUub2Zmc2V0LmNsaWNrO1xuXG5cdFx0XHRpZiAoIHNvcnRhYmxlLl9pbnRlcnNlY3RzV2l0aCggc29ydGFibGUuY29udGFpbmVyQ2FjaGUgKSApIHtcblx0XHRcdFx0aW5uZXJtb3N0SW50ZXJzZWN0aW5nID0gdHJ1ZTtcblxuXHRcdFx0XHQkLmVhY2goIGRyYWdnYWJsZS5zb3J0YWJsZXMsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdC8vIENvcHkgb3ZlciB2YXJpYWJsZXMgdGhhdCBzb3J0YWJsZSdzIF9pbnRlcnNlY3RzV2l0aCB1c2VzXG5cdFx0XHRcdFx0dGhpcy5wb3NpdGlvbkFicyA9IGRyYWdnYWJsZS5wb3NpdGlvbkFicztcblx0XHRcdFx0XHR0aGlzLmhlbHBlclByb3BvcnRpb25zID0gZHJhZ2dhYmxlLmhlbHBlclByb3BvcnRpb25zO1xuXHRcdFx0XHRcdHRoaXMub2Zmc2V0LmNsaWNrID0gZHJhZ2dhYmxlLm9mZnNldC5jbGljaztcblxuXHRcdFx0XHRcdGlmICggdGhpcyAhPT0gc29ydGFibGUgJiZcblx0XHRcdFx0XHRcdFx0dGhpcy5faW50ZXJzZWN0c1dpdGgoIHRoaXMuY29udGFpbmVyQ2FjaGUgKSAmJlxuXHRcdFx0XHRcdFx0XHQkLmNvbnRhaW5zKCBzb3J0YWJsZS5lbGVtZW50WyAwIF0sIHRoaXMuZWxlbWVudFsgMCBdICkgKSB7XG5cdFx0XHRcdFx0XHRpbm5lcm1vc3RJbnRlcnNlY3RpbmcgPSBmYWxzZTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXR1cm4gaW5uZXJtb3N0SW50ZXJzZWN0aW5nO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCBpbm5lcm1vc3RJbnRlcnNlY3RpbmcgKSB7XG5cdFx0XHRcdC8vIElmIGl0IGludGVyc2VjdHMsIHdlIHVzZSBhIGxpdHRsZSBpc092ZXIgdmFyaWFibGUgYW5kIHNldCBpdCBvbmNlLFxuXHRcdFx0XHQvLyBzbyB0aGF0IHRoZSBtb3ZlLWluIHN0dWZmIGdldHMgZmlyZWQgb25seSBvbmNlLlxuXHRcdFx0XHRpZiAoICFzb3J0YWJsZS5pc092ZXIgKSB7XG5cdFx0XHRcdFx0c29ydGFibGUuaXNPdmVyID0gMTtcblxuXHRcdFx0XHRcdC8vIFN0b3JlIGRyYWdnYWJsZSdzIHBhcmVudCBpbiBjYXNlIHdlIG5lZWQgdG8gcmVhcHBlbmQgdG8gaXQgbGF0ZXIuXG5cdFx0XHRcdFx0ZHJhZ2dhYmxlLl9wYXJlbnQgPSB1aS5oZWxwZXIucGFyZW50KCk7XG5cblx0XHRcdFx0XHRzb3J0YWJsZS5jdXJyZW50SXRlbSA9IHVpLmhlbHBlclxuXHRcdFx0XHRcdFx0LmFwcGVuZFRvKCBzb3J0YWJsZS5lbGVtZW50IClcblx0XHRcdFx0XHRcdC5kYXRhKCBcInVpLXNvcnRhYmxlLWl0ZW1cIiwgdHJ1ZSApO1xuXG5cdFx0XHRcdFx0Ly8gU3RvcmUgaGVscGVyIG9wdGlvbiB0byBsYXRlciByZXN0b3JlIGl0XG5cdFx0XHRcdFx0c29ydGFibGUub3B0aW9ucy5faGVscGVyID0gc29ydGFibGUub3B0aW9ucy5oZWxwZXI7XG5cblx0XHRcdFx0XHRzb3J0YWJsZS5vcHRpb25zLmhlbHBlciA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHVpLmhlbHBlclsgMCBdO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvLyBGaXJlIHRoZSBzdGFydCBldmVudHMgb2YgdGhlIHNvcnRhYmxlIHdpdGggb3VyIHBhc3NlZCBicm93c2VyIGV2ZW50LFxuXHRcdFx0XHRcdC8vIGFuZCBvdXIgb3duIGhlbHBlciAoc28gaXQgZG9lc24ndCBjcmVhdGUgYSBuZXcgb25lKVxuXHRcdFx0XHRcdGV2ZW50LnRhcmdldCA9IHNvcnRhYmxlLmN1cnJlbnRJdGVtWyAwIF07XG5cdFx0XHRcdFx0c29ydGFibGUuX21vdXNlQ2FwdHVyZSggZXZlbnQsIHRydWUgKTtcblx0XHRcdFx0XHRzb3J0YWJsZS5fbW91c2VTdGFydCggZXZlbnQsIHRydWUsIHRydWUgKTtcblxuXHRcdFx0XHRcdC8vIEJlY2F1c2UgdGhlIGJyb3dzZXIgZXZlbnQgaXMgd2F5IG9mZiB0aGUgbmV3IGFwcGVuZGVkIHBvcnRsZXQsXG5cdFx0XHRcdFx0Ly8gbW9kaWZ5IG5lY2Vzc2FyeSB2YXJpYWJsZXMgdG8gcmVmbGVjdCB0aGUgY2hhbmdlc1xuXHRcdFx0XHRcdHNvcnRhYmxlLm9mZnNldC5jbGljay50b3AgPSBkcmFnZ2FibGUub2Zmc2V0LmNsaWNrLnRvcDtcblx0XHRcdFx0XHRzb3J0YWJsZS5vZmZzZXQuY2xpY2subGVmdCA9IGRyYWdnYWJsZS5vZmZzZXQuY2xpY2subGVmdDtcblx0XHRcdFx0XHRzb3J0YWJsZS5vZmZzZXQucGFyZW50LmxlZnQgLT0gZHJhZ2dhYmxlLm9mZnNldC5wYXJlbnQubGVmdCAtXG5cdFx0XHRcdFx0XHRzb3J0YWJsZS5vZmZzZXQucGFyZW50LmxlZnQ7XG5cdFx0XHRcdFx0c29ydGFibGUub2Zmc2V0LnBhcmVudC50b3AgLT0gZHJhZ2dhYmxlLm9mZnNldC5wYXJlbnQudG9wIC1cblx0XHRcdFx0XHRcdHNvcnRhYmxlLm9mZnNldC5wYXJlbnQudG9wO1xuXG5cdFx0XHRcdFx0ZHJhZ2dhYmxlLl90cmlnZ2VyKCBcInRvU29ydGFibGVcIiwgZXZlbnQgKTtcblxuXHRcdFx0XHRcdC8vIEluZm9ybSBkcmFnZ2FibGUgdGhhdCB0aGUgaGVscGVyIGlzIGluIGEgdmFsaWQgZHJvcCB6b25lLFxuXHRcdFx0XHRcdC8vIHVzZWQgc29sZWx5IGluIHRoZSByZXZlcnQgb3B0aW9uIHRvIGhhbmRsZSBcInZhbGlkL2ludmFsaWRcIi5cblx0XHRcdFx0XHRkcmFnZ2FibGUuZHJvcHBlZCA9IHNvcnRhYmxlLmVsZW1lbnQ7XG5cblx0XHRcdFx0XHQvLyBOZWVkIHRvIHJlZnJlc2hQb3NpdGlvbnMgb2YgYWxsIHNvcnRhYmxlcyBpbiB0aGUgY2FzZSB0aGF0XG5cdFx0XHRcdFx0Ly8gYWRkaW5nIHRvIG9uZSBzb3J0YWJsZSBjaGFuZ2VzIHRoZSBsb2NhdGlvbiBvZiB0aGUgb3RoZXIgc29ydGFibGVzICgjOTY3NSlcblx0XHRcdFx0XHQkLmVhY2goIGRyYWdnYWJsZS5zb3J0YWJsZXMsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0dGhpcy5yZWZyZXNoUG9zaXRpb25zKCk7XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHQvLyBoYWNrIHNvIHJlY2VpdmUvdXBkYXRlIGNhbGxiYWNrcyB3b3JrIChtb3N0bHkpXG5cdFx0XHRcdFx0ZHJhZ2dhYmxlLmN1cnJlbnRJdGVtID0gZHJhZ2dhYmxlLmVsZW1lbnQ7XG5cdFx0XHRcdFx0c29ydGFibGUuZnJvbU91dHNpZGUgPSBkcmFnZ2FibGU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoIHNvcnRhYmxlLmN1cnJlbnRJdGVtICkge1xuXHRcdFx0XHRcdHNvcnRhYmxlLl9tb3VzZURyYWcoIGV2ZW50ICk7XG5cdFx0XHRcdFx0Ly8gQ29weSB0aGUgc29ydGFibGUncyBwb3NpdGlvbiBiZWNhdXNlIHRoZSBkcmFnZ2FibGUncyBjYW4gcG90ZW50aWFsbHkgcmVmbGVjdFxuXHRcdFx0XHRcdC8vIGEgcmVsYXRpdmUgcG9zaXRpb24sIHdoaWxlIHNvcnRhYmxlIGlzIGFsd2F5cyBhYnNvbHV0ZSwgd2hpY2ggdGhlIGRyYWdnZWRcblx0XHRcdFx0XHQvLyBlbGVtZW50IGhhcyBub3cgYmVjb21lLiAoIzg4MDkpXG5cdFx0XHRcdFx0dWkucG9zaXRpb24gPSBzb3J0YWJsZS5wb3NpdGlvbjtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gSWYgaXQgZG9lc24ndCBpbnRlcnNlY3Qgd2l0aCB0aGUgc29ydGFibGUsIGFuZCBpdCBpbnRlcnNlY3RlZCBiZWZvcmUsXG5cdFx0XHRcdC8vIHdlIGZha2UgdGhlIGRyYWcgc3RvcCBvZiB0aGUgc29ydGFibGUsIGJ1dCBtYWtlIHN1cmUgaXQgZG9lc24ndCByZW1vdmVcblx0XHRcdFx0Ly8gdGhlIGhlbHBlciBieSB1c2luZyBjYW5jZWxIZWxwZXJSZW1vdmFsLlxuXHRcdFx0XHRpZiAoIHNvcnRhYmxlLmlzT3ZlciApIHtcblxuXHRcdFx0XHRcdHNvcnRhYmxlLmlzT3ZlciA9IDA7XG5cdFx0XHRcdFx0c29ydGFibGUuY2FuY2VsSGVscGVyUmVtb3ZhbCA9IHRydWU7XG5cblx0XHRcdFx0XHQvLyBDYWxsaW5nIHNvcnRhYmxlJ3MgbW91c2VTdG9wIHdvdWxkIHRyaWdnZXIgYSByZXZlcnQsXG5cdFx0XHRcdFx0Ly8gc28gcmV2ZXJ0IG11c3QgYmUgdGVtcG9yYXJpbHkgZmFsc2UgdW50aWwgYWZ0ZXIgbW91c2VTdG9wIGlzIGNhbGxlZC5cblx0XHRcdFx0XHRzb3J0YWJsZS5vcHRpb25zLl9yZXZlcnQgPSBzb3J0YWJsZS5vcHRpb25zLnJldmVydDtcblx0XHRcdFx0XHRzb3J0YWJsZS5vcHRpb25zLnJldmVydCA9IGZhbHNlO1xuXG5cdFx0XHRcdFx0c29ydGFibGUuX3RyaWdnZXIoIFwib3V0XCIsIGV2ZW50LCBzb3J0YWJsZS5fdWlIYXNoKCBzb3J0YWJsZSApICk7XG5cdFx0XHRcdFx0c29ydGFibGUuX21vdXNlU3RvcCggZXZlbnQsIHRydWUgKTtcblxuXHRcdFx0XHRcdC8vIHJlc3RvcmUgc29ydGFibGUgYmVoYXZpb3JzIHRoYXQgd2VyZSBtb2RmaWVkXG5cdFx0XHRcdFx0Ly8gd2hlbiB0aGUgZHJhZ2dhYmxlIGVudGVyZWQgdGhlIHNvcnRhYmxlIGFyZWEgKCM5NDgxKVxuXHRcdFx0XHRcdHNvcnRhYmxlLm9wdGlvbnMucmV2ZXJ0ID0gc29ydGFibGUub3B0aW9ucy5fcmV2ZXJ0O1xuXHRcdFx0XHRcdHNvcnRhYmxlLm9wdGlvbnMuaGVscGVyID0gc29ydGFibGUub3B0aW9ucy5faGVscGVyO1xuXG5cdFx0XHRcdFx0aWYgKCBzb3J0YWJsZS5wbGFjZWhvbGRlciApIHtcblx0XHRcdFx0XHRcdHNvcnRhYmxlLnBsYWNlaG9sZGVyLnJlbW92ZSgpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIFJlc3RvcmUgYW5kIHJlY2FsY3VsYXRlIHRoZSBkcmFnZ2FibGUncyBvZmZzZXQgY29uc2lkZXJpbmcgdGhlIHNvcnRhYmxlXG5cdFx0XHRcdFx0Ly8gbWF5IGhhdmUgbW9kaWZpZWQgdGhlbSBpbiB1bmV4cGVjdGVkIHdheXMuICgjODgwOSwgIzEwNjY5KVxuXHRcdFx0XHRcdHVpLmhlbHBlci5hcHBlbmRUbyggZHJhZ2dhYmxlLl9wYXJlbnQgKTtcblx0XHRcdFx0XHRkcmFnZ2FibGUuX3JlZnJlc2hPZmZzZXRzKCBldmVudCApO1xuXHRcdFx0XHRcdHVpLnBvc2l0aW9uID0gZHJhZ2dhYmxlLl9nZW5lcmF0ZVBvc2l0aW9uKCBldmVudCwgdHJ1ZSApO1xuXG5cdFx0XHRcdFx0ZHJhZ2dhYmxlLl90cmlnZ2VyKCBcImZyb21Tb3J0YWJsZVwiLCBldmVudCApO1xuXG5cdFx0XHRcdFx0Ly8gSW5mb3JtIGRyYWdnYWJsZSB0aGF0IHRoZSBoZWxwZXIgaXMgbm8gbG9uZ2VyIGluIGEgdmFsaWQgZHJvcCB6b25lXG5cdFx0XHRcdFx0ZHJhZ2dhYmxlLmRyb3BwZWQgPSBmYWxzZTtcblxuXHRcdFx0XHRcdC8vIE5lZWQgdG8gcmVmcmVzaFBvc2l0aW9ucyBvZiBhbGwgc29ydGFibGVzIGp1c3QgaW4gY2FzZSByZW1vdmluZ1xuXHRcdFx0XHRcdC8vIGZyb20gb25lIHNvcnRhYmxlIGNoYW5nZXMgdGhlIGxvY2F0aW9uIG9mIG90aGVyIHNvcnRhYmxlcyAoIzk2NzUpXG5cdFx0XHRcdFx0JC5lYWNoKCBkcmFnZ2FibGUuc29ydGFibGVzLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdHRoaXMucmVmcmVzaFBvc2l0aW9ucygpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cbn0pO1xuXG4kLnVpLnBsdWdpbi5hZGQoXCJkcmFnZ2FibGVcIiwgXCJjdXJzb3JcIiwge1xuXHRzdGFydDogZnVuY3Rpb24oIGV2ZW50LCB1aSwgaW5zdGFuY2UgKSB7XG5cdFx0dmFyIHQgPSAkKCBcImJvZHlcIiApLFxuXHRcdFx0byA9IGluc3RhbmNlLm9wdGlvbnM7XG5cblx0XHRpZiAodC5jc3MoXCJjdXJzb3JcIikpIHtcblx0XHRcdG8uX2N1cnNvciA9IHQuY3NzKFwiY3Vyc29yXCIpO1xuXHRcdH1cblx0XHR0LmNzcyhcImN1cnNvclwiLCBvLmN1cnNvcik7XG5cdH0sXG5cdHN0b3A6IGZ1bmN0aW9uKCBldmVudCwgdWksIGluc3RhbmNlICkge1xuXHRcdHZhciBvID0gaW5zdGFuY2Uub3B0aW9ucztcblx0XHRpZiAoby5fY3Vyc29yKSB7XG5cdFx0XHQkKFwiYm9keVwiKS5jc3MoXCJjdXJzb3JcIiwgby5fY3Vyc29yKTtcblx0XHR9XG5cdH1cbn0pO1xuXG4kLnVpLnBsdWdpbi5hZGQoXCJkcmFnZ2FibGVcIiwgXCJvcGFjaXR5XCIsIHtcblx0c3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWksIGluc3RhbmNlICkge1xuXHRcdHZhciB0ID0gJCggdWkuaGVscGVyICksXG5cdFx0XHRvID0gaW5zdGFuY2Uub3B0aW9ucztcblx0XHRpZiAodC5jc3MoXCJvcGFjaXR5XCIpKSB7XG5cdFx0XHRvLl9vcGFjaXR5ID0gdC5jc3MoXCJvcGFjaXR5XCIpO1xuXHRcdH1cblx0XHR0LmNzcyhcIm9wYWNpdHlcIiwgby5vcGFjaXR5KTtcblx0fSxcblx0c3RvcDogZnVuY3Rpb24oIGV2ZW50LCB1aSwgaW5zdGFuY2UgKSB7XG5cdFx0dmFyIG8gPSBpbnN0YW5jZS5vcHRpb25zO1xuXHRcdGlmIChvLl9vcGFjaXR5KSB7XG5cdFx0XHQkKHVpLmhlbHBlcikuY3NzKFwib3BhY2l0eVwiLCBvLl9vcGFjaXR5KTtcblx0XHR9XG5cdH1cbn0pO1xuXG4kLnVpLnBsdWdpbi5hZGQoXCJkcmFnZ2FibGVcIiwgXCJzY3JvbGxcIiwge1xuXHRzdGFydDogZnVuY3Rpb24oIGV2ZW50LCB1aSwgaSApIHtcblx0XHRpZiAoICFpLnNjcm9sbFBhcmVudE5vdEhpZGRlbiApIHtcblx0XHRcdGkuc2Nyb2xsUGFyZW50Tm90SGlkZGVuID0gaS5oZWxwZXIuc2Nyb2xsUGFyZW50KCBmYWxzZSApO1xuXHRcdH1cblxuXHRcdGlmICggaS5zY3JvbGxQYXJlbnROb3RIaWRkZW5bIDAgXSAhPT0gaS5kb2N1bWVudFsgMCBdICYmIGkuc2Nyb2xsUGFyZW50Tm90SGlkZGVuWyAwIF0udGFnTmFtZSAhPT0gXCJIVE1MXCIgKSB7XG5cdFx0XHRpLm92ZXJmbG93T2Zmc2V0ID0gaS5zY3JvbGxQYXJlbnROb3RIaWRkZW4ub2Zmc2V0KCk7XG5cdFx0fVxuXHR9LFxuXHRkcmFnOiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpICApIHtcblxuXHRcdHZhciBvID0gaS5vcHRpb25zLFxuXHRcdFx0c2Nyb2xsZWQgPSBmYWxzZSxcblx0XHRcdHNjcm9sbFBhcmVudCA9IGkuc2Nyb2xsUGFyZW50Tm90SGlkZGVuWyAwIF0sXG5cdFx0XHRkb2N1bWVudCA9IGkuZG9jdW1lbnRbIDAgXTtcblxuXHRcdGlmICggc2Nyb2xsUGFyZW50ICE9PSBkb2N1bWVudCAmJiBzY3JvbGxQYXJlbnQudGFnTmFtZSAhPT0gXCJIVE1MXCIgKSB7XG5cdFx0XHRpZiAoICFvLmF4aXMgfHwgby5heGlzICE9PSBcInhcIiApIHtcblx0XHRcdFx0aWYgKCAoIGkub3ZlcmZsb3dPZmZzZXQudG9wICsgc2Nyb2xsUGFyZW50Lm9mZnNldEhlaWdodCApIC0gZXZlbnQucGFnZVkgPCBvLnNjcm9sbFNlbnNpdGl2aXR5ICkge1xuXHRcdFx0XHRcdHNjcm9sbFBhcmVudC5zY3JvbGxUb3AgPSBzY3JvbGxlZCA9IHNjcm9sbFBhcmVudC5zY3JvbGxUb3AgKyBvLnNjcm9sbFNwZWVkO1xuXHRcdFx0XHR9IGVsc2UgaWYgKCBldmVudC5wYWdlWSAtIGkub3ZlcmZsb3dPZmZzZXQudG9wIDwgby5zY3JvbGxTZW5zaXRpdml0eSApIHtcblx0XHRcdFx0XHRzY3JvbGxQYXJlbnQuc2Nyb2xsVG9wID0gc2Nyb2xsZWQgPSBzY3JvbGxQYXJlbnQuc2Nyb2xsVG9wIC0gby5zY3JvbGxTcGVlZDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoICFvLmF4aXMgfHwgby5heGlzICE9PSBcInlcIiApIHtcblx0XHRcdFx0aWYgKCAoIGkub3ZlcmZsb3dPZmZzZXQubGVmdCArIHNjcm9sbFBhcmVudC5vZmZzZXRXaWR0aCApIC0gZXZlbnQucGFnZVggPCBvLnNjcm9sbFNlbnNpdGl2aXR5ICkge1xuXHRcdFx0XHRcdHNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0ID0gc2Nyb2xsZWQgPSBzY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCArIG8uc2Nyb2xsU3BlZWQ7XG5cdFx0XHRcdH0gZWxzZSBpZiAoIGV2ZW50LnBhZ2VYIC0gaS5vdmVyZmxvd09mZnNldC5sZWZ0IDwgby5zY3JvbGxTZW5zaXRpdml0eSApIHtcblx0XHRcdFx0XHRzY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCA9IHNjcm9sbGVkID0gc2Nyb2xsUGFyZW50LnNjcm9sbExlZnQgLSBvLnNjcm9sbFNwZWVkO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHR9IGVsc2Uge1xuXG5cdFx0XHRpZiAoIW8uYXhpcyB8fCBvLmF4aXMgIT09IFwieFwiKSB7XG5cdFx0XHRcdGlmIChldmVudC5wYWdlWSAtICQoZG9jdW1lbnQpLnNjcm9sbFRvcCgpIDwgby5zY3JvbGxTZW5zaXRpdml0eSkge1xuXHRcdFx0XHRcdHNjcm9sbGVkID0gJChkb2N1bWVudCkuc2Nyb2xsVG9wKCQoZG9jdW1lbnQpLnNjcm9sbFRvcCgpIC0gby5zY3JvbGxTcGVlZCk7XG5cdFx0XHRcdH0gZWxzZSBpZiAoJCh3aW5kb3cpLmhlaWdodCgpIC0gKGV2ZW50LnBhZ2VZIC0gJChkb2N1bWVudCkuc2Nyb2xsVG9wKCkpIDwgby5zY3JvbGxTZW5zaXRpdml0eSkge1xuXHRcdFx0XHRcdHNjcm9sbGVkID0gJChkb2N1bWVudCkuc2Nyb2xsVG9wKCQoZG9jdW1lbnQpLnNjcm9sbFRvcCgpICsgby5zY3JvbGxTcGVlZCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKCFvLmF4aXMgfHwgby5heGlzICE9PSBcInlcIikge1xuXHRcdFx0XHRpZiAoZXZlbnQucGFnZVggLSAkKGRvY3VtZW50KS5zY3JvbGxMZWZ0KCkgPCBvLnNjcm9sbFNlbnNpdGl2aXR5KSB7XG5cdFx0XHRcdFx0c2Nyb2xsZWQgPSAkKGRvY3VtZW50KS5zY3JvbGxMZWZ0KCQoZG9jdW1lbnQpLnNjcm9sbExlZnQoKSAtIG8uc2Nyb2xsU3BlZWQpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKCQod2luZG93KS53aWR0aCgpIC0gKGV2ZW50LnBhZ2VYIC0gJChkb2N1bWVudCkuc2Nyb2xsTGVmdCgpKSA8IG8uc2Nyb2xsU2Vuc2l0aXZpdHkpIHtcblx0XHRcdFx0XHRzY3JvbGxlZCA9ICQoZG9jdW1lbnQpLnNjcm9sbExlZnQoJChkb2N1bWVudCkuc2Nyb2xsTGVmdCgpICsgby5zY3JvbGxTcGVlZCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdH1cblxuXHRcdGlmIChzY3JvbGxlZCAhPT0gZmFsc2UgJiYgJC51aS5kZG1hbmFnZXIgJiYgIW8uZHJvcEJlaGF2aW91cikge1xuXHRcdFx0JC51aS5kZG1hbmFnZXIucHJlcGFyZU9mZnNldHMoaSwgZXZlbnQpO1xuXHRcdH1cblxuXHR9XG59KTtcblxuJC51aS5wbHVnaW4uYWRkKFwiZHJhZ2dhYmxlXCIsIFwic25hcFwiLCB7XG5cdHN0YXJ0OiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpICkge1xuXG5cdFx0dmFyIG8gPSBpLm9wdGlvbnM7XG5cblx0XHRpLnNuYXBFbGVtZW50cyA9IFtdO1xuXG5cdFx0JChvLnNuYXAuY29uc3RydWN0b3IgIT09IFN0cmluZyA/ICggby5zbmFwLml0ZW1zIHx8IFwiOmRhdGEodWktZHJhZ2dhYmxlKVwiICkgOiBvLnNuYXApLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgJHQgPSAkKHRoaXMpLFxuXHRcdFx0XHQkbyA9ICR0Lm9mZnNldCgpO1xuXHRcdFx0aWYgKHRoaXMgIT09IGkuZWxlbWVudFswXSkge1xuXHRcdFx0XHRpLnNuYXBFbGVtZW50cy5wdXNoKHtcblx0XHRcdFx0XHRpdGVtOiB0aGlzLFxuXHRcdFx0XHRcdHdpZHRoOiAkdC5vdXRlcldpZHRoKCksIGhlaWdodDogJHQub3V0ZXJIZWlnaHQoKSxcblx0XHRcdFx0XHR0b3A6ICRvLnRvcCwgbGVmdDogJG8ubGVmdFxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHR9LFxuXHRkcmFnOiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpbnN0ICkge1xuXG5cdFx0dmFyIHRzLCBicywgbHMsIHJzLCBsLCByLCB0LCBiLCBpLCBmaXJzdCxcblx0XHRcdG8gPSBpbnN0Lm9wdGlvbnMsXG5cdFx0XHRkID0gby5zbmFwVG9sZXJhbmNlLFxuXHRcdFx0eDEgPSB1aS5vZmZzZXQubGVmdCwgeDIgPSB4MSArIGluc3QuaGVscGVyUHJvcG9ydGlvbnMud2lkdGgsXG5cdFx0XHR5MSA9IHVpLm9mZnNldC50b3AsIHkyID0geTEgKyBpbnN0LmhlbHBlclByb3BvcnRpb25zLmhlaWdodDtcblxuXHRcdGZvciAoaSA9IGluc3Quc25hcEVsZW1lbnRzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKXtcblxuXHRcdFx0bCA9IGluc3Quc25hcEVsZW1lbnRzW2ldLmxlZnQgLSBpbnN0Lm1hcmdpbnMubGVmdDtcblx0XHRcdHIgPSBsICsgaW5zdC5zbmFwRWxlbWVudHNbaV0ud2lkdGg7XG5cdFx0XHR0ID0gaW5zdC5zbmFwRWxlbWVudHNbaV0udG9wIC0gaW5zdC5tYXJnaW5zLnRvcDtcblx0XHRcdGIgPSB0ICsgaW5zdC5zbmFwRWxlbWVudHNbaV0uaGVpZ2h0O1xuXG5cdFx0XHRpZiAoIHgyIDwgbCAtIGQgfHwgeDEgPiByICsgZCB8fCB5MiA8IHQgLSBkIHx8IHkxID4gYiArIGQgfHwgISQuY29udGFpbnMoIGluc3Quc25hcEVsZW1lbnRzWyBpIF0uaXRlbS5vd25lckRvY3VtZW50LCBpbnN0LnNuYXBFbGVtZW50c1sgaSBdLml0ZW0gKSApIHtcblx0XHRcdFx0aWYgKGluc3Quc25hcEVsZW1lbnRzW2ldLnNuYXBwaW5nKSB7XG5cdFx0XHRcdFx0KGluc3Qub3B0aW9ucy5zbmFwLnJlbGVhc2UgJiYgaW5zdC5vcHRpb25zLnNuYXAucmVsZWFzZS5jYWxsKGluc3QuZWxlbWVudCwgZXZlbnQsICQuZXh0ZW5kKGluc3QuX3VpSGFzaCgpLCB7IHNuYXBJdGVtOiBpbnN0LnNuYXBFbGVtZW50c1tpXS5pdGVtIH0pKSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0aW5zdC5zbmFwRWxlbWVudHNbaV0uc25hcHBpbmcgPSBmYWxzZTtcblx0XHRcdFx0Y29udGludWU7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChvLnNuYXBNb2RlICE9PSBcImlubmVyXCIpIHtcblx0XHRcdFx0dHMgPSBNYXRoLmFicyh0IC0geTIpIDw9IGQ7XG5cdFx0XHRcdGJzID0gTWF0aC5hYnMoYiAtIHkxKSA8PSBkO1xuXHRcdFx0XHRscyA9IE1hdGguYWJzKGwgLSB4MikgPD0gZDtcblx0XHRcdFx0cnMgPSBNYXRoLmFicyhyIC0geDEpIDw9IGQ7XG5cdFx0XHRcdGlmICh0cykge1xuXHRcdFx0XHRcdHVpLnBvc2l0aW9uLnRvcCA9IGluc3QuX2NvbnZlcnRQb3NpdGlvblRvKFwicmVsYXRpdmVcIiwgeyB0b3A6IHQgLSBpbnN0LmhlbHBlclByb3BvcnRpb25zLmhlaWdodCwgbGVmdDogMCB9KS50b3A7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKGJzKSB7XG5cdFx0XHRcdFx0dWkucG9zaXRpb24udG9wID0gaW5zdC5fY29udmVydFBvc2l0aW9uVG8oXCJyZWxhdGl2ZVwiLCB7IHRvcDogYiwgbGVmdDogMCB9KS50b3A7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKGxzKSB7XG5cdFx0XHRcdFx0dWkucG9zaXRpb24ubGVmdCA9IGluc3QuX2NvbnZlcnRQb3NpdGlvblRvKFwicmVsYXRpdmVcIiwgeyB0b3A6IDAsIGxlZnQ6IGwgLSBpbnN0LmhlbHBlclByb3BvcnRpb25zLndpZHRoIH0pLmxlZnQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKHJzKSB7XG5cdFx0XHRcdFx0dWkucG9zaXRpb24ubGVmdCA9IGluc3QuX2NvbnZlcnRQb3NpdGlvblRvKFwicmVsYXRpdmVcIiwgeyB0b3A6IDAsIGxlZnQ6IHIgfSkubGVmdDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRmaXJzdCA9ICh0cyB8fCBicyB8fCBscyB8fCBycyk7XG5cblx0XHRcdGlmIChvLnNuYXBNb2RlICE9PSBcIm91dGVyXCIpIHtcblx0XHRcdFx0dHMgPSBNYXRoLmFicyh0IC0geTEpIDw9IGQ7XG5cdFx0XHRcdGJzID0gTWF0aC5hYnMoYiAtIHkyKSA8PSBkO1xuXHRcdFx0XHRscyA9IE1hdGguYWJzKGwgLSB4MSkgPD0gZDtcblx0XHRcdFx0cnMgPSBNYXRoLmFicyhyIC0geDIpIDw9IGQ7XG5cdFx0XHRcdGlmICh0cykge1xuXHRcdFx0XHRcdHVpLnBvc2l0aW9uLnRvcCA9IGluc3QuX2NvbnZlcnRQb3NpdGlvblRvKFwicmVsYXRpdmVcIiwgeyB0b3A6IHQsIGxlZnQ6IDAgfSkudG9wO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChicykge1xuXHRcdFx0XHRcdHVpLnBvc2l0aW9uLnRvcCA9IGluc3QuX2NvbnZlcnRQb3NpdGlvblRvKFwicmVsYXRpdmVcIiwgeyB0b3A6IGIgLSBpbnN0LmhlbHBlclByb3BvcnRpb25zLmhlaWdodCwgbGVmdDogMCB9KS50b3A7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKGxzKSB7XG5cdFx0XHRcdFx0dWkucG9zaXRpb24ubGVmdCA9IGluc3QuX2NvbnZlcnRQb3NpdGlvblRvKFwicmVsYXRpdmVcIiwgeyB0b3A6IDAsIGxlZnQ6IGwgfSkubGVmdDtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAocnMpIHtcblx0XHRcdFx0XHR1aS5wb3NpdGlvbi5sZWZ0ID0gaW5zdC5fY29udmVydFBvc2l0aW9uVG8oXCJyZWxhdGl2ZVwiLCB7IHRvcDogMCwgbGVmdDogciAtIGluc3QuaGVscGVyUHJvcG9ydGlvbnMud2lkdGggfSkubGVmdDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIWluc3Quc25hcEVsZW1lbnRzW2ldLnNuYXBwaW5nICYmICh0cyB8fCBicyB8fCBscyB8fCBycyB8fCBmaXJzdCkpIHtcblx0XHRcdFx0KGluc3Qub3B0aW9ucy5zbmFwLnNuYXAgJiYgaW5zdC5vcHRpb25zLnNuYXAuc25hcC5jYWxsKGluc3QuZWxlbWVudCwgZXZlbnQsICQuZXh0ZW5kKGluc3QuX3VpSGFzaCgpLCB7IHNuYXBJdGVtOiBpbnN0LnNuYXBFbGVtZW50c1tpXS5pdGVtIH0pKSk7XG5cdFx0XHR9XG5cdFx0XHRpbnN0LnNuYXBFbGVtZW50c1tpXS5zbmFwcGluZyA9ICh0cyB8fCBicyB8fCBscyB8fCBycyB8fCBmaXJzdCk7XG5cblx0XHR9XG5cblx0fVxufSk7XG5cbiQudWkucGx1Z2luLmFkZChcImRyYWdnYWJsZVwiLCBcInN0YWNrXCIsIHtcblx0c3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWksIGluc3RhbmNlICkge1xuXHRcdHZhciBtaW4sXG5cdFx0XHRvID0gaW5zdGFuY2Uub3B0aW9ucyxcblx0XHRcdGdyb3VwID0gJC5tYWtlQXJyYXkoJChvLnN0YWNrKSkuc29ydChmdW5jdGlvbihhLCBiKSB7XG5cdFx0XHRcdHJldHVybiAocGFyc2VJbnQoJChhKS5jc3MoXCJ6SW5kZXhcIiksIDEwKSB8fCAwKSAtIChwYXJzZUludCgkKGIpLmNzcyhcInpJbmRleFwiKSwgMTApIHx8IDApO1xuXHRcdFx0fSk7XG5cblx0XHRpZiAoIWdyb3VwLmxlbmd0aCkgeyByZXR1cm47IH1cblxuXHRcdG1pbiA9IHBhcnNlSW50KCQoZ3JvdXBbMF0pLmNzcyhcInpJbmRleFwiKSwgMTApIHx8IDA7XG5cdFx0JChncm91cCkuZWFjaChmdW5jdGlvbihpKSB7XG5cdFx0XHQkKHRoaXMpLmNzcyhcInpJbmRleFwiLCBtaW4gKyBpKTtcblx0XHR9KTtcblx0XHR0aGlzLmNzcyhcInpJbmRleFwiLCAobWluICsgZ3JvdXAubGVuZ3RoKSk7XG5cdH1cbn0pO1xuXG4kLnVpLnBsdWdpbi5hZGQoXCJkcmFnZ2FibGVcIiwgXCJ6SW5kZXhcIiwge1xuXHRzdGFydDogZnVuY3Rpb24oIGV2ZW50LCB1aSwgaW5zdGFuY2UgKSB7XG5cdFx0dmFyIHQgPSAkKCB1aS5oZWxwZXIgKSxcblx0XHRcdG8gPSBpbnN0YW5jZS5vcHRpb25zO1xuXG5cdFx0aWYgKHQuY3NzKFwiekluZGV4XCIpKSB7XG5cdFx0XHRvLl96SW5kZXggPSB0LmNzcyhcInpJbmRleFwiKTtcblx0XHR9XG5cdFx0dC5jc3MoXCJ6SW5kZXhcIiwgby56SW5kZXgpO1xuXHR9LFxuXHRzdG9wOiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpbnN0YW5jZSApIHtcblx0XHR2YXIgbyA9IGluc3RhbmNlLm9wdGlvbnM7XG5cblx0XHRpZiAoby5fekluZGV4KSB7XG5cdFx0XHQkKHVpLmhlbHBlcikuY3NzKFwiekluZGV4XCIsIG8uX3pJbmRleCk7XG5cdFx0fVxuXHR9XG59KTtcblxudmFyIGRyYWdnYWJsZSA9ICQudWkuZHJhZ2dhYmxlO1xuXG5cbi8qIVxuICogalF1ZXJ5IFVJIFNvcnRhYmxlIDEuMTEuNFxuICogaHR0cDovL2pxdWVyeXVpLmNvbVxuICpcbiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXG4gKlxuICogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vc29ydGFibGUvXG4gKi9cblxuXG52YXIgc29ydGFibGUgPSAkLndpZGdldChcInVpLnNvcnRhYmxlXCIsICQudWkubW91c2UsIHtcblx0dmVyc2lvbjogXCIxLjExLjRcIixcblx0d2lkZ2V0RXZlbnRQcmVmaXg6IFwic29ydFwiLFxuXHRyZWFkeTogZmFsc2UsXG5cdG9wdGlvbnM6IHtcblx0XHRhcHBlbmRUbzogXCJwYXJlbnRcIixcblx0XHRheGlzOiBmYWxzZSxcblx0XHRjb25uZWN0V2l0aDogZmFsc2UsXG5cdFx0Y29udGFpbm1lbnQ6IGZhbHNlLFxuXHRcdGN1cnNvcjogXCJhdXRvXCIsXG5cdFx0Y3Vyc29yQXQ6IGZhbHNlLFxuXHRcdGRyb3BPbkVtcHR5OiB0cnVlLFxuXHRcdGZvcmNlUGxhY2Vob2xkZXJTaXplOiBmYWxzZSxcblx0XHRmb3JjZUhlbHBlclNpemU6IGZhbHNlLFxuXHRcdGdyaWQ6IGZhbHNlLFxuXHRcdGhhbmRsZTogZmFsc2UsXG5cdFx0aGVscGVyOiBcIm9yaWdpbmFsXCIsXG5cdFx0aXRlbXM6IFwiPiAqXCIsXG5cdFx0b3BhY2l0eTogZmFsc2UsXG5cdFx0cGxhY2Vob2xkZXI6IGZhbHNlLFxuXHRcdHJldmVydDogZmFsc2UsXG5cdFx0c2Nyb2xsOiB0cnVlLFxuXHRcdHNjcm9sbFNlbnNpdGl2aXR5OiAyMCxcblx0XHRzY3JvbGxTcGVlZDogMjAsXG5cdFx0c2NvcGU6IFwiZGVmYXVsdFwiLFxuXHRcdHRvbGVyYW5jZTogXCJpbnRlcnNlY3RcIixcblx0XHR6SW5kZXg6IDEwMDAsXG5cblx0XHQvLyBjYWxsYmFja3Ncblx0XHRhY3RpdmF0ZTogbnVsbCxcblx0XHRiZWZvcmVTdG9wOiBudWxsLFxuXHRcdGNoYW5nZTogbnVsbCxcblx0XHRkZWFjdGl2YXRlOiBudWxsLFxuXHRcdG91dDogbnVsbCxcblx0XHRvdmVyOiBudWxsLFxuXHRcdHJlY2VpdmU6IG51bGwsXG5cdFx0cmVtb3ZlOiBudWxsLFxuXHRcdHNvcnQ6IG51bGwsXG5cdFx0c3RhcnQ6IG51bGwsXG5cdFx0c3RvcDogbnVsbCxcblx0XHR1cGRhdGU6IG51bGxcblx0fSxcblxuXHRfaXNPdmVyQXhpczogZnVuY3Rpb24oIHgsIHJlZmVyZW5jZSwgc2l6ZSApIHtcblx0XHRyZXR1cm4gKCB4ID49IHJlZmVyZW5jZSApICYmICggeCA8ICggcmVmZXJlbmNlICsgc2l6ZSApICk7XG5cdH0sXG5cblx0X2lzRmxvYXRpbmc6IGZ1bmN0aW9uKCBpdGVtICkge1xuXHRcdHJldHVybiAoL2xlZnR8cmlnaHQvKS50ZXN0KGl0ZW0uY3NzKFwiZmxvYXRcIikpIHx8ICgvaW5saW5lfHRhYmxlLWNlbGwvKS50ZXN0KGl0ZW0uY3NzKFwiZGlzcGxheVwiKSk7XG5cdH0sXG5cblx0X2NyZWF0ZTogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5jb250YWluZXJDYWNoZSA9IHt9O1xuXHRcdHRoaXMuZWxlbWVudC5hZGRDbGFzcyhcInVpLXNvcnRhYmxlXCIpO1xuXG5cdFx0Ly9HZXQgdGhlIGl0ZW1zXG5cdFx0dGhpcy5yZWZyZXNoKCk7XG5cblx0XHQvL0xldCdzIGRldGVybWluZSB0aGUgcGFyZW50J3Mgb2Zmc2V0XG5cdFx0dGhpcy5vZmZzZXQgPSB0aGlzLmVsZW1lbnQub2Zmc2V0KCk7XG5cblx0XHQvL0luaXRpYWxpemUgbW91c2UgZXZlbnRzIGZvciBpbnRlcmFjdGlvblxuXHRcdHRoaXMuX21vdXNlSW5pdCgpO1xuXG5cdFx0dGhpcy5fc2V0SGFuZGxlQ2xhc3NOYW1lKCk7XG5cblx0XHQvL1dlJ3JlIHJlYWR5IHRvIGdvXG5cdFx0dGhpcy5yZWFkeSA9IHRydWU7XG5cblx0fSxcblxuXHRfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHR0aGlzLl9zdXBlcigga2V5LCB2YWx1ZSApO1xuXG5cdFx0aWYgKCBrZXkgPT09IFwiaGFuZGxlXCIgKSB7XG5cdFx0XHR0aGlzLl9zZXRIYW5kbGVDbGFzc05hbWUoKTtcblx0XHR9XG5cdH0sXG5cblx0X3NldEhhbmRsZUNsYXNzTmFtZTogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5lbGVtZW50LmZpbmQoIFwiLnVpLXNvcnRhYmxlLWhhbmRsZVwiICkucmVtb3ZlQ2xhc3MoIFwidWktc29ydGFibGUtaGFuZGxlXCIgKTtcblx0XHQkLmVhY2goIHRoaXMuaXRlbXMsIGZ1bmN0aW9uKCkge1xuXHRcdFx0KCB0aGlzLmluc3RhbmNlLm9wdGlvbnMuaGFuZGxlID9cblx0XHRcdFx0dGhpcy5pdGVtLmZpbmQoIHRoaXMuaW5zdGFuY2Uub3B0aW9ucy5oYW5kbGUgKSA6IHRoaXMuaXRlbSApXG5cdFx0XHRcdC5hZGRDbGFzcyggXCJ1aS1zb3J0YWJsZS1oYW5kbGVcIiApO1xuXHRcdH0pO1xuXHR9LFxuXG5cdF9kZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmVsZW1lbnRcblx0XHRcdC5yZW1vdmVDbGFzcyggXCJ1aS1zb3J0YWJsZSB1aS1zb3J0YWJsZS1kaXNhYmxlZFwiIClcblx0XHRcdC5maW5kKCBcIi51aS1zb3J0YWJsZS1oYW5kbGVcIiApXG5cdFx0XHRcdC5yZW1vdmVDbGFzcyggXCJ1aS1zb3J0YWJsZS1oYW5kbGVcIiApO1xuXHRcdHRoaXMuX21vdXNlRGVzdHJveSgpO1xuXG5cdFx0Zm9yICggdmFyIGkgPSB0aGlzLml0ZW1zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tICkge1xuXHRcdFx0dGhpcy5pdGVtc1tpXS5pdGVtLnJlbW92ZURhdGEodGhpcy53aWRnZXROYW1lICsgXCItaXRlbVwiKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRfbW91c2VDYXB0dXJlOiBmdW5jdGlvbihldmVudCwgb3ZlcnJpZGVIYW5kbGUpIHtcblx0XHR2YXIgY3VycmVudEl0ZW0gPSBudWxsLFxuXHRcdFx0dmFsaWRIYW5kbGUgPSBmYWxzZSxcblx0XHRcdHRoYXQgPSB0aGlzO1xuXG5cdFx0aWYgKHRoaXMucmV2ZXJ0aW5nKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0aWYodGhpcy5vcHRpb25zLmRpc2FibGVkIHx8IHRoaXMub3B0aW9ucy50eXBlID09PSBcInN0YXRpY1wiKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0Ly9XZSBoYXZlIHRvIHJlZnJlc2ggdGhlIGl0ZW1zIGRhdGEgb25jZSBmaXJzdFxuXHRcdHRoaXMuX3JlZnJlc2hJdGVtcyhldmVudCk7XG5cblx0XHQvL0ZpbmQgb3V0IGlmIHRoZSBjbGlja2VkIG5vZGUgKG9yIG9uZSBvZiBpdHMgcGFyZW50cykgaXMgYSBhY3R1YWwgaXRlbSBpbiB0aGlzLml0ZW1zXG5cdFx0JChldmVudC50YXJnZXQpLnBhcmVudHMoKS5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYoJC5kYXRhKHRoaXMsIHRoYXQud2lkZ2V0TmFtZSArIFwiLWl0ZW1cIikgPT09IHRoYXQpIHtcblx0XHRcdFx0Y3VycmVudEl0ZW0gPSAkKHRoaXMpO1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0aWYoJC5kYXRhKGV2ZW50LnRhcmdldCwgdGhhdC53aWRnZXROYW1lICsgXCItaXRlbVwiKSA9PT0gdGhhdCkge1xuXHRcdFx0Y3VycmVudEl0ZW0gPSAkKGV2ZW50LnRhcmdldCk7XG5cdFx0fVxuXG5cdFx0aWYoIWN1cnJlbnRJdGVtKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHRcdGlmKHRoaXMub3B0aW9ucy5oYW5kbGUgJiYgIW92ZXJyaWRlSGFuZGxlKSB7XG5cdFx0XHQkKHRoaXMub3B0aW9ucy5oYW5kbGUsIGN1cnJlbnRJdGVtKS5maW5kKFwiKlwiKS5hZGRCYWNrKCkuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYodGhpcyA9PT0gZXZlbnQudGFyZ2V0KSB7XG5cdFx0XHRcdFx0dmFsaWRIYW5kbGUgPSB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdGlmKCF2YWxpZEhhbmRsZSkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dGhpcy5jdXJyZW50SXRlbSA9IGN1cnJlbnRJdGVtO1xuXHRcdHRoaXMuX3JlbW92ZUN1cnJlbnRzRnJvbUl0ZW1zKCk7XG5cdFx0cmV0dXJuIHRydWU7XG5cblx0fSxcblxuXHRfbW91c2VTdGFydDogZnVuY3Rpb24oZXZlbnQsIG92ZXJyaWRlSGFuZGxlLCBub0FjdGl2YXRpb24pIHtcblxuXHRcdHZhciBpLCBib2R5LFxuXHRcdFx0byA9IHRoaXMub3B0aW9ucztcblxuXHRcdHRoaXMuY3VycmVudENvbnRhaW5lciA9IHRoaXM7XG5cblx0XHQvL1dlIG9ubHkgbmVlZCB0byBjYWxsIHJlZnJlc2hQb3NpdGlvbnMsIGJlY2F1c2UgdGhlIHJlZnJlc2hJdGVtcyBjYWxsIGhhcyBiZWVuIG1vdmVkIHRvIG1vdXNlQ2FwdHVyZVxuXHRcdHRoaXMucmVmcmVzaFBvc2l0aW9ucygpO1xuXG5cdFx0Ly9DcmVhdGUgYW5kIGFwcGVuZCB0aGUgdmlzaWJsZSBoZWxwZXJcblx0XHR0aGlzLmhlbHBlciA9IHRoaXMuX2NyZWF0ZUhlbHBlcihldmVudCk7XG5cblx0XHQvL0NhY2hlIHRoZSBoZWxwZXIgc2l6ZVxuXHRcdHRoaXMuX2NhY2hlSGVscGVyUHJvcG9ydGlvbnMoKTtcblxuXHRcdC8qXG5cdFx0ICogLSBQb3NpdGlvbiBnZW5lcmF0aW9uIC1cblx0XHQgKiBUaGlzIGJsb2NrIGdlbmVyYXRlcyBldmVyeXRoaW5nIHBvc2l0aW9uIHJlbGF0ZWQgLSBpdCdzIHRoZSBjb3JlIG9mIGRyYWdnYWJsZXMuXG5cdFx0ICovXG5cblx0XHQvL0NhY2hlIHRoZSBtYXJnaW5zIG9mIHRoZSBvcmlnaW5hbCBlbGVtZW50XG5cdFx0dGhpcy5fY2FjaGVNYXJnaW5zKCk7XG5cblx0XHQvL0dldCB0aGUgbmV4dCBzY3JvbGxpbmcgcGFyZW50XG5cdFx0dGhpcy5zY3JvbGxQYXJlbnQgPSB0aGlzLmhlbHBlci5zY3JvbGxQYXJlbnQoKTtcblxuXHRcdC8vVGhlIGVsZW1lbnQncyBhYnNvbHV0ZSBwb3NpdGlvbiBvbiB0aGUgcGFnZSBtaW51cyBtYXJnaW5zXG5cdFx0dGhpcy5vZmZzZXQgPSB0aGlzLmN1cnJlbnRJdGVtLm9mZnNldCgpO1xuXHRcdHRoaXMub2Zmc2V0ID0ge1xuXHRcdFx0dG9wOiB0aGlzLm9mZnNldC50b3AgLSB0aGlzLm1hcmdpbnMudG9wLFxuXHRcdFx0bGVmdDogdGhpcy5vZmZzZXQubGVmdCAtIHRoaXMubWFyZ2lucy5sZWZ0XG5cdFx0fTtcblxuXHRcdCQuZXh0ZW5kKHRoaXMub2Zmc2V0LCB7XG5cdFx0XHRjbGljazogeyAvL1doZXJlIHRoZSBjbGljayBoYXBwZW5lZCwgcmVsYXRpdmUgdG8gdGhlIGVsZW1lbnRcblx0XHRcdFx0bGVmdDogZXZlbnQucGFnZVggLSB0aGlzLm9mZnNldC5sZWZ0LFxuXHRcdFx0XHR0b3A6IGV2ZW50LnBhZ2VZIC0gdGhpcy5vZmZzZXQudG9wXG5cdFx0XHR9LFxuXHRcdFx0cGFyZW50OiB0aGlzLl9nZXRQYXJlbnRPZmZzZXQoKSxcblx0XHRcdHJlbGF0aXZlOiB0aGlzLl9nZXRSZWxhdGl2ZU9mZnNldCgpIC8vVGhpcyBpcyBhIHJlbGF0aXZlIHRvIGFic29sdXRlIHBvc2l0aW9uIG1pbnVzIHRoZSBhY3R1YWwgcG9zaXRpb24gY2FsY3VsYXRpb24gLSBvbmx5IHVzZWQgZm9yIHJlbGF0aXZlIHBvc2l0aW9uZWQgaGVscGVyXG5cdFx0fSk7XG5cblx0XHQvLyBPbmx5IGFmdGVyIHdlIGdvdCB0aGUgb2Zmc2V0LCB3ZSBjYW4gY2hhbmdlIHRoZSBoZWxwZXIncyBwb3NpdGlvbiB0byBhYnNvbHV0ZVxuXHRcdC8vIFRPRE86IFN0aWxsIG5lZWQgdG8gZmlndXJlIG91dCBhIHdheSB0byBtYWtlIHJlbGF0aXZlIHNvcnRpbmcgcG9zc2libGVcblx0XHR0aGlzLmhlbHBlci5jc3MoXCJwb3NpdGlvblwiLCBcImFic29sdXRlXCIpO1xuXHRcdHRoaXMuY3NzUG9zaXRpb24gPSB0aGlzLmhlbHBlci5jc3MoXCJwb3NpdGlvblwiKTtcblxuXHRcdC8vR2VuZXJhdGUgdGhlIG9yaWdpbmFsIHBvc2l0aW9uXG5cdFx0dGhpcy5vcmlnaW5hbFBvc2l0aW9uID0gdGhpcy5fZ2VuZXJhdGVQb3NpdGlvbihldmVudCk7XG5cdFx0dGhpcy5vcmlnaW5hbFBhZ2VYID0gZXZlbnQucGFnZVg7XG5cdFx0dGhpcy5vcmlnaW5hbFBhZ2VZID0gZXZlbnQucGFnZVk7XG5cblx0XHQvL0FkanVzdCB0aGUgbW91c2Ugb2Zmc2V0IHJlbGF0aXZlIHRvIHRoZSBoZWxwZXIgaWYgXCJjdXJzb3JBdFwiIGlzIHN1cHBsaWVkXG5cdFx0KG8uY3Vyc29yQXQgJiYgdGhpcy5fYWRqdXN0T2Zmc2V0RnJvbUhlbHBlcihvLmN1cnNvckF0KSk7XG5cblx0XHQvL0NhY2hlIHRoZSBmb3JtZXIgRE9NIHBvc2l0aW9uXG5cdFx0dGhpcy5kb21Qb3NpdGlvbiA9IHsgcHJldjogdGhpcy5jdXJyZW50SXRlbS5wcmV2KClbMF0sIHBhcmVudDogdGhpcy5jdXJyZW50SXRlbS5wYXJlbnQoKVswXSB9O1xuXG5cdFx0Ly9JZiB0aGUgaGVscGVyIGlzIG5vdCB0aGUgb3JpZ2luYWwsIGhpZGUgdGhlIG9yaWdpbmFsIHNvIGl0J3Mgbm90IHBsYXlpbmcgYW55IHJvbGUgZHVyaW5nIHRoZSBkcmFnLCB3b24ndCBjYXVzZSBhbnl0aGluZyBiYWQgdGhpcyB3YXlcblx0XHRpZih0aGlzLmhlbHBlclswXSAhPT0gdGhpcy5jdXJyZW50SXRlbVswXSkge1xuXHRcdFx0dGhpcy5jdXJyZW50SXRlbS5oaWRlKCk7XG5cdFx0fVxuXG5cdFx0Ly9DcmVhdGUgdGhlIHBsYWNlaG9sZGVyXG5cdFx0dGhpcy5fY3JlYXRlUGxhY2Vob2xkZXIoKTtcblxuXHRcdC8vU2V0IGEgY29udGFpbm1lbnQgaWYgZ2l2ZW4gaW4gdGhlIG9wdGlvbnNcblx0XHRpZihvLmNvbnRhaW5tZW50KSB7XG5cdFx0XHR0aGlzLl9zZXRDb250YWlubWVudCgpO1xuXHRcdH1cblxuXHRcdGlmKCBvLmN1cnNvciAmJiBvLmN1cnNvciAhPT0gXCJhdXRvXCIgKSB7IC8vIGN1cnNvciBvcHRpb25cblx0XHRcdGJvZHkgPSB0aGlzLmRvY3VtZW50LmZpbmQoIFwiYm9keVwiICk7XG5cblx0XHRcdC8vIHN1cHBvcnQ6IElFXG5cdFx0XHR0aGlzLnN0b3JlZEN1cnNvciA9IGJvZHkuY3NzKCBcImN1cnNvclwiICk7XG5cdFx0XHRib2R5LmNzcyggXCJjdXJzb3JcIiwgby5jdXJzb3IgKTtcblxuXHRcdFx0dGhpcy5zdG9yZWRTdHlsZXNoZWV0ID0gJCggXCI8c3R5bGU+KnsgY3Vyc29yOiBcIitvLmN1cnNvcitcIiAhaW1wb3J0YW50OyB9PC9zdHlsZT5cIiApLmFwcGVuZFRvKCBib2R5ICk7XG5cdFx0fVxuXG5cdFx0aWYoby5vcGFjaXR5KSB7IC8vIG9wYWNpdHkgb3B0aW9uXG5cdFx0XHRpZiAodGhpcy5oZWxwZXIuY3NzKFwib3BhY2l0eVwiKSkge1xuXHRcdFx0XHR0aGlzLl9zdG9yZWRPcGFjaXR5ID0gdGhpcy5oZWxwZXIuY3NzKFwib3BhY2l0eVwiKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuaGVscGVyLmNzcyhcIm9wYWNpdHlcIiwgby5vcGFjaXR5KTtcblx0XHR9XG5cblx0XHRpZihvLnpJbmRleCkgeyAvLyB6SW5kZXggb3B0aW9uXG5cdFx0XHRpZiAodGhpcy5oZWxwZXIuY3NzKFwiekluZGV4XCIpKSB7XG5cdFx0XHRcdHRoaXMuX3N0b3JlZFpJbmRleCA9IHRoaXMuaGVscGVyLmNzcyhcInpJbmRleFwiKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuaGVscGVyLmNzcyhcInpJbmRleFwiLCBvLnpJbmRleCk7XG5cdFx0fVxuXG5cdFx0Ly9QcmVwYXJlIHNjcm9sbGluZ1xuXHRcdGlmKHRoaXMuc2Nyb2xsUGFyZW50WzBdICE9PSB0aGlzLmRvY3VtZW50WzBdICYmIHRoaXMuc2Nyb2xsUGFyZW50WzBdLnRhZ05hbWUgIT09IFwiSFRNTFwiKSB7XG5cdFx0XHR0aGlzLm92ZXJmbG93T2Zmc2V0ID0gdGhpcy5zY3JvbGxQYXJlbnQub2Zmc2V0KCk7XG5cdFx0fVxuXG5cdFx0Ly9DYWxsIGNhbGxiYWNrc1xuXHRcdHRoaXMuX3RyaWdnZXIoXCJzdGFydFwiLCBldmVudCwgdGhpcy5fdWlIYXNoKCkpO1xuXG5cdFx0Ly9SZWNhY2hlIHRoZSBoZWxwZXIgc2l6ZVxuXHRcdGlmKCF0aGlzLl9wcmVzZXJ2ZUhlbHBlclByb3BvcnRpb25zKSB7XG5cdFx0XHR0aGlzLl9jYWNoZUhlbHBlclByb3BvcnRpb25zKCk7XG5cdFx0fVxuXG5cblx0XHQvL1Bvc3QgXCJhY3RpdmF0ZVwiIGV2ZW50cyB0byBwb3NzaWJsZSBjb250YWluZXJzXG5cdFx0aWYoICFub0FjdGl2YXRpb24gKSB7XG5cdFx0XHRmb3IgKCBpID0gdGhpcy5jb250YWluZXJzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tICkge1xuXHRcdFx0XHR0aGlzLmNvbnRhaW5lcnNbIGkgXS5fdHJpZ2dlciggXCJhY3RpdmF0ZVwiLCBldmVudCwgdGhpcy5fdWlIYXNoKCB0aGlzICkgKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvL1ByZXBhcmUgcG9zc2libGUgZHJvcHBhYmxlc1xuXHRcdGlmKCQudWkuZGRtYW5hZ2VyKSB7XG5cdFx0XHQkLnVpLmRkbWFuYWdlci5jdXJyZW50ID0gdGhpcztcblx0XHR9XG5cblx0XHRpZiAoJC51aS5kZG1hbmFnZXIgJiYgIW8uZHJvcEJlaGF2aW91cikge1xuXHRcdFx0JC51aS5kZG1hbmFnZXIucHJlcGFyZU9mZnNldHModGhpcywgZXZlbnQpO1xuXHRcdH1cblxuXHRcdHRoaXMuZHJhZ2dpbmcgPSB0cnVlO1xuXG5cdFx0dGhpcy5oZWxwZXIuYWRkQ2xhc3MoXCJ1aS1zb3J0YWJsZS1oZWxwZXJcIik7XG5cdFx0dGhpcy5fbW91c2VEcmFnKGV2ZW50KTsgLy9FeGVjdXRlIHRoZSBkcmFnIG9uY2UgLSB0aGlzIGNhdXNlcyB0aGUgaGVscGVyIG5vdCB0byBiZSB2aXNpYmxlIGJlZm9yZSBnZXR0aW5nIGl0cyBjb3JyZWN0IHBvc2l0aW9uXG5cdFx0cmV0dXJuIHRydWU7XG5cblx0fSxcblxuXHRfbW91c2VEcmFnOiBmdW5jdGlvbihldmVudCkge1xuXHRcdHZhciBpLCBpdGVtLCBpdGVtRWxlbWVudCwgaW50ZXJzZWN0aW9uLFxuXHRcdFx0byA9IHRoaXMub3B0aW9ucyxcblx0XHRcdHNjcm9sbGVkID0gZmFsc2U7XG5cblx0XHQvL0NvbXB1dGUgdGhlIGhlbHBlcnMgcG9zaXRpb25cblx0XHR0aGlzLnBvc2l0aW9uID0gdGhpcy5fZ2VuZXJhdGVQb3NpdGlvbihldmVudCk7XG5cdFx0dGhpcy5wb3NpdGlvbkFicyA9IHRoaXMuX2NvbnZlcnRQb3NpdGlvblRvKFwiYWJzb2x1dGVcIik7XG5cblx0XHRpZiAoIXRoaXMubGFzdFBvc2l0aW9uQWJzKSB7XG5cdFx0XHR0aGlzLmxhc3RQb3NpdGlvbkFicyA9IHRoaXMucG9zaXRpb25BYnM7XG5cdFx0fVxuXG5cdFx0Ly9EbyBzY3JvbGxpbmdcblx0XHRpZih0aGlzLm9wdGlvbnMuc2Nyb2xsKSB7XG5cdFx0XHRpZih0aGlzLnNjcm9sbFBhcmVudFswXSAhPT0gdGhpcy5kb2N1bWVudFswXSAmJiB0aGlzLnNjcm9sbFBhcmVudFswXS50YWdOYW1lICE9PSBcIkhUTUxcIikge1xuXG5cdFx0XHRcdGlmKCh0aGlzLm92ZXJmbG93T2Zmc2V0LnRvcCArIHRoaXMuc2Nyb2xsUGFyZW50WzBdLm9mZnNldEhlaWdodCkgLSBldmVudC5wYWdlWSA8IG8uc2Nyb2xsU2Vuc2l0aXZpdHkpIHtcblx0XHRcdFx0XHR0aGlzLnNjcm9sbFBhcmVudFswXS5zY3JvbGxUb3AgPSBzY3JvbGxlZCA9IHRoaXMuc2Nyb2xsUGFyZW50WzBdLnNjcm9sbFRvcCArIG8uc2Nyb2xsU3BlZWQ7XG5cdFx0XHRcdH0gZWxzZSBpZihldmVudC5wYWdlWSAtIHRoaXMub3ZlcmZsb3dPZmZzZXQudG9wIDwgby5zY3JvbGxTZW5zaXRpdml0eSkge1xuXHRcdFx0XHRcdHRoaXMuc2Nyb2xsUGFyZW50WzBdLnNjcm9sbFRvcCA9IHNjcm9sbGVkID0gdGhpcy5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsVG9wIC0gby5zY3JvbGxTcGVlZDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmKCh0aGlzLm92ZXJmbG93T2Zmc2V0LmxlZnQgKyB0aGlzLnNjcm9sbFBhcmVudFswXS5vZmZzZXRXaWR0aCkgLSBldmVudC5wYWdlWCA8IG8uc2Nyb2xsU2Vuc2l0aXZpdHkpIHtcblx0XHRcdFx0XHR0aGlzLnNjcm9sbFBhcmVudFswXS5zY3JvbGxMZWZ0ID0gc2Nyb2xsZWQgPSB0aGlzLnNjcm9sbFBhcmVudFswXS5zY3JvbGxMZWZ0ICsgby5zY3JvbGxTcGVlZDtcblx0XHRcdFx0fSBlbHNlIGlmKGV2ZW50LnBhZ2VYIC0gdGhpcy5vdmVyZmxvd09mZnNldC5sZWZ0IDwgby5zY3JvbGxTZW5zaXRpdml0eSkge1xuXHRcdFx0XHRcdHRoaXMuc2Nyb2xsUGFyZW50WzBdLnNjcm9sbExlZnQgPSBzY3JvbGxlZCA9IHRoaXMuc2Nyb2xsUGFyZW50WzBdLnNjcm9sbExlZnQgLSBvLnNjcm9sbFNwZWVkO1xuXHRcdFx0XHR9XG5cblx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0aWYoZXZlbnQucGFnZVkgLSB0aGlzLmRvY3VtZW50LnNjcm9sbFRvcCgpIDwgby5zY3JvbGxTZW5zaXRpdml0eSkge1xuXHRcdFx0XHRcdHNjcm9sbGVkID0gdGhpcy5kb2N1bWVudC5zY3JvbGxUb3AodGhpcy5kb2N1bWVudC5zY3JvbGxUb3AoKSAtIG8uc2Nyb2xsU3BlZWQpO1xuXHRcdFx0XHR9IGVsc2UgaWYodGhpcy53aW5kb3cuaGVpZ2h0KCkgLSAoZXZlbnQucGFnZVkgLSB0aGlzLmRvY3VtZW50LnNjcm9sbFRvcCgpKSA8IG8uc2Nyb2xsU2Vuc2l0aXZpdHkpIHtcblx0XHRcdFx0XHRzY3JvbGxlZCA9IHRoaXMuZG9jdW1lbnQuc2Nyb2xsVG9wKHRoaXMuZG9jdW1lbnQuc2Nyb2xsVG9wKCkgKyBvLnNjcm9sbFNwZWVkKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmKGV2ZW50LnBhZ2VYIC0gdGhpcy5kb2N1bWVudC5zY3JvbGxMZWZ0KCkgPCBvLnNjcm9sbFNlbnNpdGl2aXR5KSB7XG5cdFx0XHRcdFx0c2Nyb2xsZWQgPSB0aGlzLmRvY3VtZW50LnNjcm9sbExlZnQodGhpcy5kb2N1bWVudC5zY3JvbGxMZWZ0KCkgLSBvLnNjcm9sbFNwZWVkKTtcblx0XHRcdFx0fSBlbHNlIGlmKHRoaXMud2luZG93LndpZHRoKCkgLSAoZXZlbnQucGFnZVggLSB0aGlzLmRvY3VtZW50LnNjcm9sbExlZnQoKSkgPCBvLnNjcm9sbFNlbnNpdGl2aXR5KSB7XG5cdFx0XHRcdFx0c2Nyb2xsZWQgPSB0aGlzLmRvY3VtZW50LnNjcm9sbExlZnQodGhpcy5kb2N1bWVudC5zY3JvbGxMZWZ0KCkgKyBvLnNjcm9sbFNwZWVkKTtcblx0XHRcdFx0fVxuXG5cdFx0XHR9XG5cblx0XHRcdGlmKHNjcm9sbGVkICE9PSBmYWxzZSAmJiAkLnVpLmRkbWFuYWdlciAmJiAhby5kcm9wQmVoYXZpb3VyKSB7XG5cdFx0XHRcdCQudWkuZGRtYW5hZ2VyLnByZXBhcmVPZmZzZXRzKHRoaXMsIGV2ZW50KTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvL1JlZ2VuZXJhdGUgdGhlIGFic29sdXRlIHBvc2l0aW9uIHVzZWQgZm9yIHBvc2l0aW9uIGNoZWNrc1xuXHRcdHRoaXMucG9zaXRpb25BYnMgPSB0aGlzLl9jb252ZXJ0UG9zaXRpb25UbyhcImFic29sdXRlXCIpO1xuXG5cdFx0Ly9TZXQgdGhlIGhlbHBlciBwb3NpdGlvblxuXHRcdGlmKCF0aGlzLm9wdGlvbnMuYXhpcyB8fCB0aGlzLm9wdGlvbnMuYXhpcyAhPT0gXCJ5XCIpIHtcblx0XHRcdHRoaXMuaGVscGVyWzBdLnN0eWxlLmxlZnQgPSB0aGlzLnBvc2l0aW9uLmxlZnQrXCJweFwiO1xuXHRcdH1cblx0XHRpZighdGhpcy5vcHRpb25zLmF4aXMgfHwgdGhpcy5vcHRpb25zLmF4aXMgIT09IFwieFwiKSB7XG5cdFx0XHR0aGlzLmhlbHBlclswXS5zdHlsZS50b3AgPSB0aGlzLnBvc2l0aW9uLnRvcCtcInB4XCI7XG5cdFx0fVxuXG5cdFx0Ly9SZWFycmFuZ2Vcblx0XHRmb3IgKGkgPSB0aGlzLml0ZW1zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG5cblx0XHRcdC8vQ2FjaGUgdmFyaWFibGVzIGFuZCBpbnRlcnNlY3Rpb24sIGNvbnRpbnVlIGlmIG5vIGludGVyc2VjdGlvblxuXHRcdFx0aXRlbSA9IHRoaXMuaXRlbXNbaV07XG5cdFx0XHRpdGVtRWxlbWVudCA9IGl0ZW0uaXRlbVswXTtcblx0XHRcdGludGVyc2VjdGlvbiA9IHRoaXMuX2ludGVyc2VjdHNXaXRoUG9pbnRlcihpdGVtKTtcblx0XHRcdGlmICghaW50ZXJzZWN0aW9uKSB7XG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBPbmx5IHB1dCB0aGUgcGxhY2Vob2xkZXIgaW5zaWRlIHRoZSBjdXJyZW50IENvbnRhaW5lciwgc2tpcCBhbGxcblx0XHRcdC8vIGl0ZW1zIGZyb20gb3RoZXIgY29udGFpbmVycy4gVGhpcyB3b3JrcyBiZWNhdXNlIHdoZW4gbW92aW5nXG5cdFx0XHQvLyBhbiBpdGVtIGZyb20gb25lIGNvbnRhaW5lciB0byBhbm90aGVyIHRoZVxuXHRcdFx0Ly8gY3VycmVudENvbnRhaW5lciBpcyBzd2l0Y2hlZCBiZWZvcmUgdGhlIHBsYWNlaG9sZGVyIGlzIG1vdmVkLlxuXHRcdFx0Ly9cblx0XHRcdC8vIFdpdGhvdXQgdGhpcywgbW92aW5nIGl0ZW1zIGluIFwic3ViLXNvcnRhYmxlc1wiIGNhbiBjYXVzZVxuXHRcdFx0Ly8gdGhlIHBsYWNlaG9sZGVyIHRvIGppdHRlciBiZXR3ZWVuIHRoZSBvdXRlciBhbmQgaW5uZXIgY29udGFpbmVyLlxuXHRcdFx0aWYgKGl0ZW0uaW5zdGFuY2UgIT09IHRoaXMuY3VycmVudENvbnRhaW5lcikge1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gY2Fubm90IGludGVyc2VjdCB3aXRoIGl0c2VsZlxuXHRcdFx0Ly8gbm8gdXNlbGVzcyBhY3Rpb25zIHRoYXQgaGF2ZSBiZWVuIGRvbmUgYmVmb3JlXG5cdFx0XHQvLyBubyBhY3Rpb24gaWYgdGhlIGl0ZW0gbW92ZWQgaXMgdGhlIHBhcmVudCBvZiB0aGUgaXRlbSBjaGVja2VkXG5cdFx0XHRpZiAoaXRlbUVsZW1lbnQgIT09IHRoaXMuY3VycmVudEl0ZW1bMF0gJiZcblx0XHRcdFx0dGhpcy5wbGFjZWhvbGRlcltpbnRlcnNlY3Rpb24gPT09IDEgPyBcIm5leHRcIiA6IFwicHJldlwiXSgpWzBdICE9PSBpdGVtRWxlbWVudCAmJlxuXHRcdFx0XHQhJC5jb250YWlucyh0aGlzLnBsYWNlaG9sZGVyWzBdLCBpdGVtRWxlbWVudCkgJiZcblx0XHRcdFx0KHRoaXMub3B0aW9ucy50eXBlID09PSBcInNlbWktZHluYW1pY1wiID8gISQuY29udGFpbnModGhpcy5lbGVtZW50WzBdLCBpdGVtRWxlbWVudCkgOiB0cnVlKVxuXHRcdFx0KSB7XG5cblx0XHRcdFx0dGhpcy5kaXJlY3Rpb24gPSBpbnRlcnNlY3Rpb24gPT09IDEgPyBcImRvd25cIiA6IFwidXBcIjtcblxuXHRcdFx0XHRpZiAodGhpcy5vcHRpb25zLnRvbGVyYW5jZSA9PT0gXCJwb2ludGVyXCIgfHwgdGhpcy5faW50ZXJzZWN0c1dpdGhTaWRlcyhpdGVtKSkge1xuXHRcdFx0XHRcdHRoaXMuX3JlYXJyYW5nZShldmVudCwgaXRlbSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0aGlzLl90cmlnZ2VyKFwiY2hhbmdlXCIsIGV2ZW50LCB0aGlzLl91aUhhc2goKSk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vUG9zdCBldmVudHMgdG8gY29udGFpbmVyc1xuXHRcdHRoaXMuX2NvbnRhY3RDb250YWluZXJzKGV2ZW50KTtcblxuXHRcdC8vSW50ZXJjb25uZWN0IHdpdGggZHJvcHBhYmxlc1xuXHRcdGlmKCQudWkuZGRtYW5hZ2VyKSB7XG5cdFx0XHQkLnVpLmRkbWFuYWdlci5kcmFnKHRoaXMsIGV2ZW50KTtcblx0XHR9XG5cblx0XHQvL0NhbGwgY2FsbGJhY2tzXG5cdFx0dGhpcy5fdHJpZ2dlcihcInNvcnRcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCgpKTtcblxuXHRcdHRoaXMubGFzdFBvc2l0aW9uQWJzID0gdGhpcy5wb3NpdGlvbkFicztcblx0XHRyZXR1cm4gZmFsc2U7XG5cblx0fSxcblxuXHRfbW91c2VTdG9wOiBmdW5jdGlvbihldmVudCwgbm9Qcm9wYWdhdGlvbikge1xuXG5cdFx0aWYoIWV2ZW50KSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly9JZiB3ZSBhcmUgdXNpbmcgZHJvcHBhYmxlcywgaW5mb3JtIHRoZSBtYW5hZ2VyIGFib3V0IHRoZSBkcm9wXG5cdFx0aWYgKCQudWkuZGRtYW5hZ2VyICYmICF0aGlzLm9wdGlvbnMuZHJvcEJlaGF2aW91cikge1xuXHRcdFx0JC51aS5kZG1hbmFnZXIuZHJvcCh0aGlzLCBldmVudCk7XG5cdFx0fVxuXG5cdFx0aWYodGhpcy5vcHRpb25zLnJldmVydCkge1xuXHRcdFx0dmFyIHRoYXQgPSB0aGlzLFxuXHRcdFx0XHRjdXIgPSB0aGlzLnBsYWNlaG9sZGVyLm9mZnNldCgpLFxuXHRcdFx0XHRheGlzID0gdGhpcy5vcHRpb25zLmF4aXMsXG5cdFx0XHRcdGFuaW1hdGlvbiA9IHt9O1xuXG5cdFx0XHRpZiAoICFheGlzIHx8IGF4aXMgPT09IFwieFwiICkge1xuXHRcdFx0XHRhbmltYXRpb24ubGVmdCA9IGN1ci5sZWZ0IC0gdGhpcy5vZmZzZXQucGFyZW50LmxlZnQgLSB0aGlzLm1hcmdpbnMubGVmdCArICh0aGlzLm9mZnNldFBhcmVudFswXSA9PT0gdGhpcy5kb2N1bWVudFswXS5ib2R5ID8gMCA6IHRoaXMub2Zmc2V0UGFyZW50WzBdLnNjcm9sbExlZnQpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKCAhYXhpcyB8fCBheGlzID09PSBcInlcIiApIHtcblx0XHRcdFx0YW5pbWF0aW9uLnRvcCA9IGN1ci50b3AgLSB0aGlzLm9mZnNldC5wYXJlbnQudG9wIC0gdGhpcy5tYXJnaW5zLnRvcCArICh0aGlzLm9mZnNldFBhcmVudFswXSA9PT0gdGhpcy5kb2N1bWVudFswXS5ib2R5ID8gMCA6IHRoaXMub2Zmc2V0UGFyZW50WzBdLnNjcm9sbFRvcCk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLnJldmVydGluZyA9IHRydWU7XG5cdFx0XHQkKHRoaXMuaGVscGVyKS5hbmltYXRlKCBhbmltYXRpb24sIHBhcnNlSW50KHRoaXMub3B0aW9ucy5yZXZlcnQsIDEwKSB8fCA1MDAsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGF0Ll9jbGVhcihldmVudCk7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5fY2xlYXIoZXZlbnQsIG5vUHJvcGFnYXRpb24pO1xuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblxuXHR9LFxuXG5cdGNhbmNlbDogZnVuY3Rpb24oKSB7XG5cblx0XHRpZih0aGlzLmRyYWdnaW5nKSB7XG5cblx0XHRcdHRoaXMuX21vdXNlVXAoeyB0YXJnZXQ6IG51bGwgfSk7XG5cblx0XHRcdGlmKHRoaXMub3B0aW9ucy5oZWxwZXIgPT09IFwib3JpZ2luYWxcIikge1xuXHRcdFx0XHR0aGlzLmN1cnJlbnRJdGVtLmNzcyh0aGlzLl9zdG9yZWRDU1MpLnJlbW92ZUNsYXNzKFwidWktc29ydGFibGUtaGVscGVyXCIpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5jdXJyZW50SXRlbS5zaG93KCk7XG5cdFx0XHR9XG5cblx0XHRcdC8vUG9zdCBkZWFjdGl2YXRpbmcgZXZlbnRzIHRvIGNvbnRhaW5lcnNcblx0XHRcdGZvciAodmFyIGkgPSB0aGlzLmNvbnRhaW5lcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pe1xuXHRcdFx0XHR0aGlzLmNvbnRhaW5lcnNbaV0uX3RyaWdnZXIoXCJkZWFjdGl2YXRlXCIsIG51bGwsIHRoaXMuX3VpSGFzaCh0aGlzKSk7XG5cdFx0XHRcdGlmKHRoaXMuY29udGFpbmVyc1tpXS5jb250YWluZXJDYWNoZS5vdmVyKSB7XG5cdFx0XHRcdFx0dGhpcy5jb250YWluZXJzW2ldLl90cmlnZ2VyKFwib3V0XCIsIG51bGwsIHRoaXMuX3VpSGFzaCh0aGlzKSk7XG5cdFx0XHRcdFx0dGhpcy5jb250YWluZXJzW2ldLmNvbnRhaW5lckNhY2hlLm92ZXIgPSAwO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHR9XG5cblx0XHRpZiAodGhpcy5wbGFjZWhvbGRlcikge1xuXHRcdFx0Ly8kKHRoaXMucGxhY2Vob2xkZXJbMF0pLnJlbW92ZSgpOyB3b3VsZCBoYXZlIGJlZW4gdGhlIGpRdWVyeSB3YXkgLSB1bmZvcnR1bmF0ZWx5LCBpdCB1bmJpbmRzIEFMTCBldmVudHMgZnJvbSB0aGUgb3JpZ2luYWwgbm9kZSFcblx0XHRcdGlmKHRoaXMucGxhY2Vob2xkZXJbMF0ucGFyZW50Tm9kZSkge1xuXHRcdFx0XHR0aGlzLnBsYWNlaG9sZGVyWzBdLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5wbGFjZWhvbGRlclswXSk7XG5cdFx0XHR9XG5cdFx0XHRpZih0aGlzLm9wdGlvbnMuaGVscGVyICE9PSBcIm9yaWdpbmFsXCIgJiYgdGhpcy5oZWxwZXIgJiYgdGhpcy5oZWxwZXJbMF0ucGFyZW50Tm9kZSkge1xuXHRcdFx0XHR0aGlzLmhlbHBlci5yZW1vdmUoKTtcblx0XHRcdH1cblxuXHRcdFx0JC5leHRlbmQodGhpcywge1xuXHRcdFx0XHRoZWxwZXI6IG51bGwsXG5cdFx0XHRcdGRyYWdnaW5nOiBmYWxzZSxcblx0XHRcdFx0cmV2ZXJ0aW5nOiBmYWxzZSxcblx0XHRcdFx0X25vRmluYWxTb3J0OiBudWxsXG5cdFx0XHR9KTtcblxuXHRcdFx0aWYodGhpcy5kb21Qb3NpdGlvbi5wcmV2KSB7XG5cdFx0XHRcdCQodGhpcy5kb21Qb3NpdGlvbi5wcmV2KS5hZnRlcih0aGlzLmN1cnJlbnRJdGVtKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdCQodGhpcy5kb21Qb3NpdGlvbi5wYXJlbnQpLnByZXBlbmQodGhpcy5jdXJyZW50SXRlbSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXM7XG5cblx0fSxcblxuXHRzZXJpYWxpemU6IGZ1bmN0aW9uKG8pIHtcblxuXHRcdHZhciBpdGVtcyA9IHRoaXMuX2dldEl0ZW1zQXNqUXVlcnkobyAmJiBvLmNvbm5lY3RlZCksXG5cdFx0XHRzdHIgPSBbXTtcblx0XHRvID0gbyB8fCB7fTtcblxuXHRcdCQoaXRlbXMpLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgcmVzID0gKCQoby5pdGVtIHx8IHRoaXMpLmF0dHIoby5hdHRyaWJ1dGUgfHwgXCJpZFwiKSB8fCBcIlwiKS5tYXRjaChvLmV4cHJlc3Npb24gfHwgKC8oLispW1xcLT1fXSguKykvKSk7XG5cdFx0XHRpZiAocmVzKSB7XG5cdFx0XHRcdHN0ci5wdXNoKChvLmtleSB8fCByZXNbMV0rXCJbXVwiKStcIj1cIisoby5rZXkgJiYgby5leHByZXNzaW9uID8gcmVzWzFdIDogcmVzWzJdKSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRpZighc3RyLmxlbmd0aCAmJiBvLmtleSkge1xuXHRcdFx0c3RyLnB1c2goby5rZXkgKyBcIj1cIik7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHN0ci5qb2luKFwiJlwiKTtcblxuXHR9LFxuXG5cdHRvQXJyYXk6IGZ1bmN0aW9uKG8pIHtcblxuXHRcdHZhciBpdGVtcyA9IHRoaXMuX2dldEl0ZW1zQXNqUXVlcnkobyAmJiBvLmNvbm5lY3RlZCksXG5cdFx0XHRyZXQgPSBbXTtcblxuXHRcdG8gPSBvIHx8IHt9O1xuXG5cdFx0aXRlbXMuZWFjaChmdW5jdGlvbigpIHsgcmV0LnB1c2goJChvLml0ZW0gfHwgdGhpcykuYXR0cihvLmF0dHJpYnV0ZSB8fCBcImlkXCIpIHx8IFwiXCIpOyB9KTtcblx0XHRyZXR1cm4gcmV0O1xuXG5cdH0sXG5cblx0LyogQmUgY2FyZWZ1bCB3aXRoIHRoZSBmb2xsb3dpbmcgY29yZSBmdW5jdGlvbnMgKi9cblx0X2ludGVyc2VjdHNXaXRoOiBmdW5jdGlvbihpdGVtKSB7XG5cblx0XHR2YXIgeDEgPSB0aGlzLnBvc2l0aW9uQWJzLmxlZnQsXG5cdFx0XHR4MiA9IHgxICsgdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCxcblx0XHRcdHkxID0gdGhpcy5wb3NpdGlvbkFicy50b3AsXG5cdFx0XHR5MiA9IHkxICsgdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQsXG5cdFx0XHRsID0gaXRlbS5sZWZ0LFxuXHRcdFx0ciA9IGwgKyBpdGVtLndpZHRoLFxuXHRcdFx0dCA9IGl0ZW0udG9wLFxuXHRcdFx0YiA9IHQgKyBpdGVtLmhlaWdodCxcblx0XHRcdGR5Q2xpY2sgPSB0aGlzLm9mZnNldC5jbGljay50b3AsXG5cdFx0XHRkeENsaWNrID0gdGhpcy5vZmZzZXQuY2xpY2subGVmdCxcblx0XHRcdGlzT3ZlckVsZW1lbnRIZWlnaHQgPSAoIHRoaXMub3B0aW9ucy5heGlzID09PSBcInhcIiApIHx8ICggKCB5MSArIGR5Q2xpY2sgKSA+IHQgJiYgKCB5MSArIGR5Q2xpY2sgKSA8IGIgKSxcblx0XHRcdGlzT3ZlckVsZW1lbnRXaWR0aCA9ICggdGhpcy5vcHRpb25zLmF4aXMgPT09IFwieVwiICkgfHwgKCAoIHgxICsgZHhDbGljayApID4gbCAmJiAoIHgxICsgZHhDbGljayApIDwgciApLFxuXHRcdFx0aXNPdmVyRWxlbWVudCA9IGlzT3ZlckVsZW1lbnRIZWlnaHQgJiYgaXNPdmVyRWxlbWVudFdpZHRoO1xuXG5cdFx0aWYgKCB0aGlzLm9wdGlvbnMudG9sZXJhbmNlID09PSBcInBvaW50ZXJcIiB8fFxuXHRcdFx0dGhpcy5vcHRpb25zLmZvcmNlUG9pbnRlckZvckNvbnRhaW5lcnMgfHxcblx0XHRcdCh0aGlzLm9wdGlvbnMudG9sZXJhbmNlICE9PSBcInBvaW50ZXJcIiAmJiB0aGlzLmhlbHBlclByb3BvcnRpb25zW3RoaXMuZmxvYXRpbmcgPyBcIndpZHRoXCIgOiBcImhlaWdodFwiXSA+IGl0ZW1bdGhpcy5mbG9hdGluZyA/IFwid2lkdGhcIiA6IFwiaGVpZ2h0XCJdKVxuXHRcdCkge1xuXHRcdFx0cmV0dXJuIGlzT3ZlckVsZW1lbnQ7XG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0cmV0dXJuIChsIDwgeDEgKyAodGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAvIDIpICYmIC8vIFJpZ2h0IEhhbGZcblx0XHRcdFx0eDIgLSAodGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAvIDIpIDwgciAmJiAvLyBMZWZ0IEhhbGZcblx0XHRcdFx0dCA8IHkxICsgKHRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0IC8gMikgJiYgLy8gQm90dG9tIEhhbGZcblx0XHRcdFx0eTIgLSAodGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQgLyAyKSA8IGIgKTsgLy8gVG9wIEhhbGZcblxuXHRcdH1cblx0fSxcblxuXHRfaW50ZXJzZWN0c1dpdGhQb2ludGVyOiBmdW5jdGlvbihpdGVtKSB7XG5cblx0XHR2YXIgaXNPdmVyRWxlbWVudEhlaWdodCA9ICh0aGlzLm9wdGlvbnMuYXhpcyA9PT0gXCJ4XCIpIHx8IHRoaXMuX2lzT3ZlckF4aXModGhpcy5wb3NpdGlvbkFicy50b3AgKyB0aGlzLm9mZnNldC5jbGljay50b3AsIGl0ZW0udG9wLCBpdGVtLmhlaWdodCksXG5cdFx0XHRpc092ZXJFbGVtZW50V2lkdGggPSAodGhpcy5vcHRpb25zLmF4aXMgPT09IFwieVwiKSB8fCB0aGlzLl9pc092ZXJBeGlzKHRoaXMucG9zaXRpb25BYnMubGVmdCArIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQsIGl0ZW0ubGVmdCwgaXRlbS53aWR0aCksXG5cdFx0XHRpc092ZXJFbGVtZW50ID0gaXNPdmVyRWxlbWVudEhlaWdodCAmJiBpc092ZXJFbGVtZW50V2lkdGgsXG5cdFx0XHR2ZXJ0aWNhbERpcmVjdGlvbiA9IHRoaXMuX2dldERyYWdWZXJ0aWNhbERpcmVjdGlvbigpLFxuXHRcdFx0aG9yaXpvbnRhbERpcmVjdGlvbiA9IHRoaXMuX2dldERyYWdIb3Jpem9udGFsRGlyZWN0aW9uKCk7XG5cblx0XHRpZiAoIWlzT3ZlckVsZW1lbnQpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcy5mbG9hdGluZyA/XG5cdFx0XHQoICgoaG9yaXpvbnRhbERpcmVjdGlvbiAmJiBob3Jpem9udGFsRGlyZWN0aW9uID09PSBcInJpZ2h0XCIpIHx8IHZlcnRpY2FsRGlyZWN0aW9uID09PSBcImRvd25cIikgPyAyIDogMSApXG5cdFx0XHQ6ICggdmVydGljYWxEaXJlY3Rpb24gJiYgKHZlcnRpY2FsRGlyZWN0aW9uID09PSBcImRvd25cIiA/IDIgOiAxKSApO1xuXG5cdH0sXG5cblx0X2ludGVyc2VjdHNXaXRoU2lkZXM6IGZ1bmN0aW9uKGl0ZW0pIHtcblxuXHRcdHZhciBpc092ZXJCb3R0b21IYWxmID0gdGhpcy5faXNPdmVyQXhpcyh0aGlzLnBvc2l0aW9uQWJzLnRvcCArIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCwgaXRlbS50b3AgKyAoaXRlbS5oZWlnaHQvMiksIGl0ZW0uaGVpZ2h0KSxcblx0XHRcdGlzT3ZlclJpZ2h0SGFsZiA9IHRoaXMuX2lzT3ZlckF4aXModGhpcy5wb3NpdGlvbkFicy5sZWZ0ICsgdGhpcy5vZmZzZXQuY2xpY2subGVmdCwgaXRlbS5sZWZ0ICsgKGl0ZW0ud2lkdGgvMiksIGl0ZW0ud2lkdGgpLFxuXHRcdFx0dmVydGljYWxEaXJlY3Rpb24gPSB0aGlzLl9nZXREcmFnVmVydGljYWxEaXJlY3Rpb24oKSxcblx0XHRcdGhvcml6b250YWxEaXJlY3Rpb24gPSB0aGlzLl9nZXREcmFnSG9yaXpvbnRhbERpcmVjdGlvbigpO1xuXG5cdFx0aWYgKHRoaXMuZmxvYXRpbmcgJiYgaG9yaXpvbnRhbERpcmVjdGlvbikge1xuXHRcdFx0cmV0dXJuICgoaG9yaXpvbnRhbERpcmVjdGlvbiA9PT0gXCJyaWdodFwiICYmIGlzT3ZlclJpZ2h0SGFsZikgfHwgKGhvcml6b250YWxEaXJlY3Rpb24gPT09IFwibGVmdFwiICYmICFpc092ZXJSaWdodEhhbGYpKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cmV0dXJuIHZlcnRpY2FsRGlyZWN0aW9uICYmICgodmVydGljYWxEaXJlY3Rpb24gPT09IFwiZG93blwiICYmIGlzT3ZlckJvdHRvbUhhbGYpIHx8ICh2ZXJ0aWNhbERpcmVjdGlvbiA9PT0gXCJ1cFwiICYmICFpc092ZXJCb3R0b21IYWxmKSk7XG5cdFx0fVxuXG5cdH0sXG5cblx0X2dldERyYWdWZXJ0aWNhbERpcmVjdGlvbjogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGRlbHRhID0gdGhpcy5wb3NpdGlvbkFicy50b3AgLSB0aGlzLmxhc3RQb3NpdGlvbkFicy50b3A7XG5cdFx0cmV0dXJuIGRlbHRhICE9PSAwICYmIChkZWx0YSA+IDAgPyBcImRvd25cIiA6IFwidXBcIik7XG5cdH0sXG5cblx0X2dldERyYWdIb3Jpem9udGFsRGlyZWN0aW9uOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgZGVsdGEgPSB0aGlzLnBvc2l0aW9uQWJzLmxlZnQgLSB0aGlzLmxhc3RQb3NpdGlvbkFicy5sZWZ0O1xuXHRcdHJldHVybiBkZWx0YSAhPT0gMCAmJiAoZGVsdGEgPiAwID8gXCJyaWdodFwiIDogXCJsZWZ0XCIpO1xuXHR9LFxuXG5cdHJlZnJlc2g6IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0dGhpcy5fcmVmcmVzaEl0ZW1zKGV2ZW50KTtcblx0XHR0aGlzLl9zZXRIYW5kbGVDbGFzc05hbWUoKTtcblx0XHR0aGlzLnJlZnJlc2hQb3NpdGlvbnMoKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRfY29ubmVjdFdpdGg6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zO1xuXHRcdHJldHVybiBvcHRpb25zLmNvbm5lY3RXaXRoLmNvbnN0cnVjdG9yID09PSBTdHJpbmcgPyBbb3B0aW9ucy5jb25uZWN0V2l0aF0gOiBvcHRpb25zLmNvbm5lY3RXaXRoO1xuXHR9LFxuXG5cdF9nZXRJdGVtc0FzalF1ZXJ5OiBmdW5jdGlvbihjb25uZWN0ZWQpIHtcblxuXHRcdHZhciBpLCBqLCBjdXIsIGluc3QsXG5cdFx0XHRpdGVtcyA9IFtdLFxuXHRcdFx0cXVlcmllcyA9IFtdLFxuXHRcdFx0Y29ubmVjdFdpdGggPSB0aGlzLl9jb25uZWN0V2l0aCgpO1xuXG5cdFx0aWYoY29ubmVjdFdpdGggJiYgY29ubmVjdGVkKSB7XG5cdFx0XHRmb3IgKGkgPSBjb25uZWN0V2l0aC5sZW5ndGggLSAxOyBpID49IDA7IGktLSl7XG5cdFx0XHRcdGN1ciA9ICQoY29ubmVjdFdpdGhbaV0sIHRoaXMuZG9jdW1lbnRbMF0pO1xuXHRcdFx0XHRmb3IgKCBqID0gY3VyLmxlbmd0aCAtIDE7IGogPj0gMDsgai0tKXtcblx0XHRcdFx0XHRpbnN0ID0gJC5kYXRhKGN1cltqXSwgdGhpcy53aWRnZXRGdWxsTmFtZSk7XG5cdFx0XHRcdFx0aWYoaW5zdCAmJiBpbnN0ICE9PSB0aGlzICYmICFpbnN0Lm9wdGlvbnMuZGlzYWJsZWQpIHtcblx0XHRcdFx0XHRcdHF1ZXJpZXMucHVzaChbJC5pc0Z1bmN0aW9uKGluc3Qub3B0aW9ucy5pdGVtcykgPyBpbnN0Lm9wdGlvbnMuaXRlbXMuY2FsbChpbnN0LmVsZW1lbnQpIDogJChpbnN0Lm9wdGlvbnMuaXRlbXMsIGluc3QuZWxlbWVudCkubm90KFwiLnVpLXNvcnRhYmxlLWhlbHBlclwiKS5ub3QoXCIudWktc29ydGFibGUtcGxhY2Vob2xkZXJcIiksIGluc3RdKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRxdWVyaWVzLnB1c2goWyQuaXNGdW5jdGlvbih0aGlzLm9wdGlvbnMuaXRlbXMpID8gdGhpcy5vcHRpb25zLml0ZW1zLmNhbGwodGhpcy5lbGVtZW50LCBudWxsLCB7IG9wdGlvbnM6IHRoaXMub3B0aW9ucywgaXRlbTogdGhpcy5jdXJyZW50SXRlbSB9KSA6ICQodGhpcy5vcHRpb25zLml0ZW1zLCB0aGlzLmVsZW1lbnQpLm5vdChcIi51aS1zb3J0YWJsZS1oZWxwZXJcIikubm90KFwiLnVpLXNvcnRhYmxlLXBsYWNlaG9sZGVyXCIpLCB0aGlzXSk7XG5cblx0XHRmdW5jdGlvbiBhZGRJdGVtcygpIHtcblx0XHRcdGl0ZW1zLnB1c2goIHRoaXMgKTtcblx0XHR9XG5cdFx0Zm9yIChpID0gcXVlcmllcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSl7XG5cdFx0XHRxdWVyaWVzW2ldWzBdLmVhY2goIGFkZEl0ZW1zICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuICQoaXRlbXMpO1xuXG5cdH0sXG5cblx0X3JlbW92ZUN1cnJlbnRzRnJvbUl0ZW1zOiBmdW5jdGlvbigpIHtcblxuXHRcdHZhciBsaXN0ID0gdGhpcy5jdXJyZW50SXRlbS5maW5kKFwiOmRhdGEoXCIgKyB0aGlzLndpZGdldE5hbWUgKyBcIi1pdGVtKVwiKTtcblxuXHRcdHRoaXMuaXRlbXMgPSAkLmdyZXAodGhpcy5pdGVtcywgZnVuY3Rpb24gKGl0ZW0pIHtcblx0XHRcdGZvciAodmFyIGo9MDsgaiA8IGxpc3QubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0aWYobGlzdFtqXSA9PT0gaXRlbS5pdGVtWzBdKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9KTtcblxuXHR9LFxuXG5cdF9yZWZyZXNoSXRlbXM6IGZ1bmN0aW9uKGV2ZW50KSB7XG5cblx0XHR0aGlzLml0ZW1zID0gW107XG5cdFx0dGhpcy5jb250YWluZXJzID0gW3RoaXNdO1xuXG5cdFx0dmFyIGksIGosIGN1ciwgaW5zdCwgdGFyZ2V0RGF0YSwgX3F1ZXJpZXMsIGl0ZW0sIHF1ZXJpZXNMZW5ndGgsXG5cdFx0XHRpdGVtcyA9IHRoaXMuaXRlbXMsXG5cdFx0XHRxdWVyaWVzID0gW1skLmlzRnVuY3Rpb24odGhpcy5vcHRpb25zLml0ZW1zKSA/IHRoaXMub3B0aW9ucy5pdGVtcy5jYWxsKHRoaXMuZWxlbWVudFswXSwgZXZlbnQsIHsgaXRlbTogdGhpcy5jdXJyZW50SXRlbSB9KSA6ICQodGhpcy5vcHRpb25zLml0ZW1zLCB0aGlzLmVsZW1lbnQpLCB0aGlzXV0sXG5cdFx0XHRjb25uZWN0V2l0aCA9IHRoaXMuX2Nvbm5lY3RXaXRoKCk7XG5cblx0XHRpZihjb25uZWN0V2l0aCAmJiB0aGlzLnJlYWR5KSB7IC8vU2hvdWxkbid0IGJlIHJ1biB0aGUgZmlyc3QgdGltZSB0aHJvdWdoIGR1ZSB0byBtYXNzaXZlIHNsb3ctZG93blxuXHRcdFx0Zm9yIChpID0gY29ubmVjdFdpdGgubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pe1xuXHRcdFx0XHRjdXIgPSAkKGNvbm5lY3RXaXRoW2ldLCB0aGlzLmRvY3VtZW50WzBdKTtcblx0XHRcdFx0Zm9yIChqID0gY3VyLmxlbmd0aCAtIDE7IGogPj0gMDsgai0tKXtcblx0XHRcdFx0XHRpbnN0ID0gJC5kYXRhKGN1cltqXSwgdGhpcy53aWRnZXRGdWxsTmFtZSk7XG5cdFx0XHRcdFx0aWYoaW5zdCAmJiBpbnN0ICE9PSB0aGlzICYmICFpbnN0Lm9wdGlvbnMuZGlzYWJsZWQpIHtcblx0XHRcdFx0XHRcdHF1ZXJpZXMucHVzaChbJC5pc0Z1bmN0aW9uKGluc3Qub3B0aW9ucy5pdGVtcykgPyBpbnN0Lm9wdGlvbnMuaXRlbXMuY2FsbChpbnN0LmVsZW1lbnRbMF0sIGV2ZW50LCB7IGl0ZW06IHRoaXMuY3VycmVudEl0ZW0gfSkgOiAkKGluc3Qub3B0aW9ucy5pdGVtcywgaW5zdC5lbGVtZW50KSwgaW5zdF0pO1xuXHRcdFx0XHRcdFx0dGhpcy5jb250YWluZXJzLnB1c2goaW5zdCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Zm9yIChpID0gcXVlcmllcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuXHRcdFx0dGFyZ2V0RGF0YSA9IHF1ZXJpZXNbaV1bMV07XG5cdFx0XHRfcXVlcmllcyA9IHF1ZXJpZXNbaV1bMF07XG5cblx0XHRcdGZvciAoaj0wLCBxdWVyaWVzTGVuZ3RoID0gX3F1ZXJpZXMubGVuZ3RoOyBqIDwgcXVlcmllc0xlbmd0aDsgaisrKSB7XG5cdFx0XHRcdGl0ZW0gPSAkKF9xdWVyaWVzW2pdKTtcblxuXHRcdFx0XHRpdGVtLmRhdGEodGhpcy53aWRnZXROYW1lICsgXCItaXRlbVwiLCB0YXJnZXREYXRhKTsgLy8gRGF0YSBmb3IgdGFyZ2V0IGNoZWNraW5nIChtb3VzZSBtYW5hZ2VyKVxuXG5cdFx0XHRcdGl0ZW1zLnB1c2goe1xuXHRcdFx0XHRcdGl0ZW06IGl0ZW0sXG5cdFx0XHRcdFx0aW5zdGFuY2U6IHRhcmdldERhdGEsXG5cdFx0XHRcdFx0d2lkdGg6IDAsIGhlaWdodDogMCxcblx0XHRcdFx0XHRsZWZ0OiAwLCB0b3A6IDBcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdH0sXG5cblx0cmVmcmVzaFBvc2l0aW9uczogZnVuY3Rpb24oZmFzdCkge1xuXG5cdFx0Ly8gRGV0ZXJtaW5lIHdoZXRoZXIgaXRlbXMgYXJlIGJlaW5nIGRpc3BsYXllZCBob3Jpem9udGFsbHlcblx0XHR0aGlzLmZsb2F0aW5nID0gdGhpcy5pdGVtcy5sZW5ndGggP1xuXHRcdFx0dGhpcy5vcHRpb25zLmF4aXMgPT09IFwieFwiIHx8IHRoaXMuX2lzRmxvYXRpbmcoIHRoaXMuaXRlbXNbIDAgXS5pdGVtICkgOlxuXHRcdFx0ZmFsc2U7XG5cblx0XHQvL1RoaXMgaGFzIHRvIGJlIHJlZG9uZSBiZWNhdXNlIGR1ZSB0byB0aGUgaXRlbSBiZWluZyBtb3ZlZCBvdXQvaW50byB0aGUgb2Zmc2V0UGFyZW50LCB0aGUgb2Zmc2V0UGFyZW50J3MgcG9zaXRpb24gd2lsbCBjaGFuZ2Vcblx0XHRpZih0aGlzLm9mZnNldFBhcmVudCAmJiB0aGlzLmhlbHBlcikge1xuXHRcdFx0dGhpcy5vZmZzZXQucGFyZW50ID0gdGhpcy5fZ2V0UGFyZW50T2Zmc2V0KCk7XG5cdFx0fVxuXG5cdFx0dmFyIGksIGl0ZW0sIHQsIHA7XG5cblx0XHRmb3IgKGkgPSB0aGlzLml0ZW1zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKXtcblx0XHRcdGl0ZW0gPSB0aGlzLml0ZW1zW2ldO1xuXG5cdFx0XHQvL1dlIGlnbm9yZSBjYWxjdWxhdGluZyBwb3NpdGlvbnMgb2YgYWxsIGNvbm5lY3RlZCBjb250YWluZXJzIHdoZW4gd2UncmUgbm90IG92ZXIgdGhlbVxuXHRcdFx0aWYoaXRlbS5pbnN0YW5jZSAhPT0gdGhpcy5jdXJyZW50Q29udGFpbmVyICYmIHRoaXMuY3VycmVudENvbnRhaW5lciAmJiBpdGVtLml0ZW1bMF0gIT09IHRoaXMuY3VycmVudEl0ZW1bMF0pIHtcblx0XHRcdFx0Y29udGludWU7XG5cdFx0XHR9XG5cblx0XHRcdHQgPSB0aGlzLm9wdGlvbnMudG9sZXJhbmNlRWxlbWVudCA/ICQodGhpcy5vcHRpb25zLnRvbGVyYW5jZUVsZW1lbnQsIGl0ZW0uaXRlbSkgOiBpdGVtLml0ZW07XG5cblx0XHRcdGlmICghZmFzdCkge1xuXHRcdFx0XHRpdGVtLndpZHRoID0gdC5vdXRlcldpZHRoKCk7XG5cdFx0XHRcdGl0ZW0uaGVpZ2h0ID0gdC5vdXRlckhlaWdodCgpO1xuXHRcdFx0fVxuXG5cdFx0XHRwID0gdC5vZmZzZXQoKTtcblx0XHRcdGl0ZW0ubGVmdCA9IHAubGVmdDtcblx0XHRcdGl0ZW0udG9wID0gcC50b3A7XG5cdFx0fVxuXG5cdFx0aWYodGhpcy5vcHRpb25zLmN1c3RvbSAmJiB0aGlzLm9wdGlvbnMuY3VzdG9tLnJlZnJlc2hDb250YWluZXJzKSB7XG5cdFx0XHR0aGlzLm9wdGlvbnMuY3VzdG9tLnJlZnJlc2hDb250YWluZXJzLmNhbGwodGhpcyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGZvciAoaSA9IHRoaXMuY29udGFpbmVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSl7XG5cdFx0XHRcdHAgPSB0aGlzLmNvbnRhaW5lcnNbaV0uZWxlbWVudC5vZmZzZXQoKTtcblx0XHRcdFx0dGhpcy5jb250YWluZXJzW2ldLmNvbnRhaW5lckNhY2hlLmxlZnQgPSBwLmxlZnQ7XG5cdFx0XHRcdHRoaXMuY29udGFpbmVyc1tpXS5jb250YWluZXJDYWNoZS50b3AgPSBwLnRvcDtcblx0XHRcdFx0dGhpcy5jb250YWluZXJzW2ldLmNvbnRhaW5lckNhY2hlLndpZHRoID0gdGhpcy5jb250YWluZXJzW2ldLmVsZW1lbnQub3V0ZXJXaWR0aCgpO1xuXHRcdFx0XHR0aGlzLmNvbnRhaW5lcnNbaV0uY29udGFpbmVyQ2FjaGUuaGVpZ2h0ID0gdGhpcy5jb250YWluZXJzW2ldLmVsZW1lbnQub3V0ZXJIZWlnaHQoKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRfY3JlYXRlUGxhY2Vob2xkZXI6IGZ1bmN0aW9uKHRoYXQpIHtcblx0XHR0aGF0ID0gdGhhdCB8fCB0aGlzO1xuXHRcdHZhciBjbGFzc05hbWUsXG5cdFx0XHRvID0gdGhhdC5vcHRpb25zO1xuXG5cdFx0aWYoIW8ucGxhY2Vob2xkZXIgfHwgby5wbGFjZWhvbGRlci5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nKSB7XG5cdFx0XHRjbGFzc05hbWUgPSBvLnBsYWNlaG9sZGVyO1xuXHRcdFx0by5wbGFjZWhvbGRlciA9IHtcblx0XHRcdFx0ZWxlbWVudDogZnVuY3Rpb24oKSB7XG5cblx0XHRcdFx0XHR2YXIgbm9kZU5hbWUgPSB0aGF0LmN1cnJlbnRJdGVtWzBdLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCksXG5cdFx0XHRcdFx0XHRlbGVtZW50ID0gJCggXCI8XCIgKyBub2RlTmFtZSArIFwiPlwiLCB0aGF0LmRvY3VtZW50WzBdIClcblx0XHRcdFx0XHRcdFx0LmFkZENsYXNzKGNsYXNzTmFtZSB8fCB0aGF0LmN1cnJlbnRJdGVtWzBdLmNsYXNzTmFtZStcIiB1aS1zb3J0YWJsZS1wbGFjZWhvbGRlclwiKVxuXHRcdFx0XHRcdFx0XHQucmVtb3ZlQ2xhc3MoXCJ1aS1zb3J0YWJsZS1oZWxwZXJcIik7XG5cblx0XHRcdFx0XHRpZiAoIG5vZGVOYW1lID09PSBcInRib2R5XCIgKSB7XG5cdFx0XHRcdFx0XHR0aGF0Ll9jcmVhdGVUclBsYWNlaG9sZGVyKFxuXHRcdFx0XHRcdFx0XHR0aGF0LmN1cnJlbnRJdGVtLmZpbmQoIFwidHJcIiApLmVxKCAwICksXG5cdFx0XHRcdFx0XHRcdCQoIFwiPHRyPlwiLCB0aGF0LmRvY3VtZW50WyAwIF0gKS5hcHBlbmRUbyggZWxlbWVudCApXG5cdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAoIG5vZGVOYW1lID09PSBcInRyXCIgKSB7XG5cdFx0XHRcdFx0XHR0aGF0Ll9jcmVhdGVUclBsYWNlaG9sZGVyKCB0aGF0LmN1cnJlbnRJdGVtLCBlbGVtZW50ICk7XG5cdFx0XHRcdFx0fSBlbHNlIGlmICggbm9kZU5hbWUgPT09IFwiaW1nXCIgKSB7XG5cdFx0XHRcdFx0XHRlbGVtZW50LmF0dHIoIFwic3JjXCIsIHRoYXQuY3VycmVudEl0ZW0uYXR0ciggXCJzcmNcIiApICk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKCAhY2xhc3NOYW1lICkge1xuXHRcdFx0XHRcdFx0ZWxlbWVudC5jc3MoIFwidmlzaWJpbGl0eVwiLCBcImhpZGRlblwiICk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cmV0dXJuIGVsZW1lbnQ7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdHVwZGF0ZTogZnVuY3Rpb24oY29udGFpbmVyLCBwKSB7XG5cblx0XHRcdFx0XHQvLyAxLiBJZiBhIGNsYXNzTmFtZSBpcyBzZXQgYXMgJ3BsYWNlaG9sZGVyIG9wdGlvbiwgd2UgZG9uJ3QgZm9yY2Ugc2l6ZXMgLSB0aGUgY2xhc3MgaXMgcmVzcG9uc2libGUgZm9yIHRoYXRcblx0XHRcdFx0XHQvLyAyLiBUaGUgb3B0aW9uICdmb3JjZVBsYWNlaG9sZGVyU2l6ZSBjYW4gYmUgZW5hYmxlZCB0byBmb3JjZSBpdCBldmVuIGlmIGEgY2xhc3MgbmFtZSBpcyBzcGVjaWZpZWRcblx0XHRcdFx0XHRpZihjbGFzc05hbWUgJiYgIW8uZm9yY2VQbGFjZWhvbGRlclNpemUpIHtcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvL0lmIHRoZSBlbGVtZW50IGRvZXNuJ3QgaGF2ZSBhIGFjdHVhbCBoZWlnaHQgYnkgaXRzZWxmICh3aXRob3V0IHN0eWxlcyBjb21pbmcgZnJvbSBhIHN0eWxlc2hlZXQpLCBpdCByZWNlaXZlcyB0aGUgaW5saW5lIGhlaWdodCBmcm9tIHRoZSBkcmFnZ2VkIGl0ZW1cblx0XHRcdFx0XHRpZighcC5oZWlnaHQoKSkgeyBwLmhlaWdodCh0aGF0LmN1cnJlbnRJdGVtLmlubmVySGVpZ2h0KCkgLSBwYXJzZUludCh0aGF0LmN1cnJlbnRJdGVtLmNzcyhcInBhZGRpbmdUb3BcIil8fDAsIDEwKSAtIHBhcnNlSW50KHRoYXQuY3VycmVudEl0ZW0uY3NzKFwicGFkZGluZ0JvdHRvbVwiKXx8MCwgMTApKTsgfVxuXHRcdFx0XHRcdGlmKCFwLndpZHRoKCkpIHsgcC53aWR0aCh0aGF0LmN1cnJlbnRJdGVtLmlubmVyV2lkdGgoKSAtIHBhcnNlSW50KHRoYXQuY3VycmVudEl0ZW0uY3NzKFwicGFkZGluZ0xlZnRcIil8fDAsIDEwKSAtIHBhcnNlSW50KHRoYXQuY3VycmVudEl0ZW0uY3NzKFwicGFkZGluZ1JpZ2h0XCIpfHwwLCAxMCkpOyB9XG5cdFx0XHRcdH1cblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0Ly9DcmVhdGUgdGhlIHBsYWNlaG9sZGVyXG5cdFx0dGhhdC5wbGFjZWhvbGRlciA9ICQoby5wbGFjZWhvbGRlci5lbGVtZW50LmNhbGwodGhhdC5lbGVtZW50LCB0aGF0LmN1cnJlbnRJdGVtKSk7XG5cblx0XHQvL0FwcGVuZCBpdCBhZnRlciB0aGUgYWN0dWFsIGN1cnJlbnQgaXRlbVxuXHRcdHRoYXQuY3VycmVudEl0ZW0uYWZ0ZXIodGhhdC5wbGFjZWhvbGRlcik7XG5cblx0XHQvL1VwZGF0ZSB0aGUgc2l6ZSBvZiB0aGUgcGxhY2Vob2xkZXIgKFRPRE86IExvZ2ljIHRvIGZ1enp5LCBzZWUgbGluZSAzMTYvMzE3KVxuXHRcdG8ucGxhY2Vob2xkZXIudXBkYXRlKHRoYXQsIHRoYXQucGxhY2Vob2xkZXIpO1xuXG5cdH0sXG5cblx0X2NyZWF0ZVRyUGxhY2Vob2xkZXI6IGZ1bmN0aW9uKCBzb3VyY2VUciwgdGFyZ2V0VHIgKSB7XG5cdFx0dmFyIHRoYXQgPSB0aGlzO1xuXG5cdFx0c291cmNlVHIuY2hpbGRyZW4oKS5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0JCggXCI8dGQ+JiMxNjA7PC90ZD5cIiwgdGhhdC5kb2N1bWVudFsgMCBdIClcblx0XHRcdFx0LmF0dHIoIFwiY29sc3BhblwiLCAkKCB0aGlzICkuYXR0ciggXCJjb2xzcGFuXCIgKSB8fCAxIClcblx0XHRcdFx0LmFwcGVuZFRvKCB0YXJnZXRUciApO1xuXHRcdH0pO1xuXHR9LFxuXG5cdF9jb250YWN0Q29udGFpbmVyczogZnVuY3Rpb24oZXZlbnQpIHtcblx0XHR2YXIgaSwgaiwgZGlzdCwgaXRlbVdpdGhMZWFzdERpc3RhbmNlLCBwb3NQcm9wZXJ0eSwgc2l6ZVByb3BlcnR5LCBjdXIsIG5lYXJCb3R0b20sIGZsb2F0aW5nLCBheGlzLFxuXHRcdFx0aW5uZXJtb3N0Q29udGFpbmVyID0gbnVsbCxcblx0XHRcdGlubmVybW9zdEluZGV4ID0gbnVsbDtcblxuXHRcdC8vIGdldCBpbm5lcm1vc3QgY29udGFpbmVyIHRoYXQgaW50ZXJzZWN0cyB3aXRoIGl0ZW1cblx0XHRmb3IgKGkgPSB0aGlzLmNvbnRhaW5lcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcblxuXHRcdFx0Ly8gbmV2ZXIgY29uc2lkZXIgYSBjb250YWluZXIgdGhhdCdzIGxvY2F0ZWQgd2l0aGluIHRoZSBpdGVtIGl0c2VsZlxuXHRcdFx0aWYoJC5jb250YWlucyh0aGlzLmN1cnJlbnRJdGVtWzBdLCB0aGlzLmNvbnRhaW5lcnNbaV0uZWxlbWVudFswXSkpIHtcblx0XHRcdFx0Y29udGludWU7XG5cdFx0XHR9XG5cblx0XHRcdGlmKHRoaXMuX2ludGVyc2VjdHNXaXRoKHRoaXMuY29udGFpbmVyc1tpXS5jb250YWluZXJDYWNoZSkpIHtcblxuXHRcdFx0XHQvLyBpZiB3ZSd2ZSBhbHJlYWR5IGZvdW5kIGEgY29udGFpbmVyIGFuZCBpdCdzIG1vcmUgXCJpbm5lclwiIHRoYW4gdGhpcywgdGhlbiBjb250aW51ZVxuXHRcdFx0XHRpZihpbm5lcm1vc3RDb250YWluZXIgJiYgJC5jb250YWlucyh0aGlzLmNvbnRhaW5lcnNbaV0uZWxlbWVudFswXSwgaW5uZXJtb3N0Q29udGFpbmVyLmVsZW1lbnRbMF0pKSB7XG5cdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpbm5lcm1vc3RDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lcnNbaV07XG5cdFx0XHRcdGlubmVybW9zdEluZGV4ID0gaTtcblxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gY29udGFpbmVyIGRvZXNuJ3QgaW50ZXJzZWN0LiB0cmlnZ2VyIFwib3V0XCIgZXZlbnQgaWYgbmVjZXNzYXJ5XG5cdFx0XHRcdGlmKHRoaXMuY29udGFpbmVyc1tpXS5jb250YWluZXJDYWNoZS5vdmVyKSB7XG5cdFx0XHRcdFx0dGhpcy5jb250YWluZXJzW2ldLl90cmlnZ2VyKFwib3V0XCIsIGV2ZW50LCB0aGlzLl91aUhhc2godGhpcykpO1xuXHRcdFx0XHRcdHRoaXMuY29udGFpbmVyc1tpXS5jb250YWluZXJDYWNoZS5vdmVyID0gMDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdFx0Ly8gaWYgbm8gaW50ZXJzZWN0aW5nIGNvbnRhaW5lcnMgZm91bmQsIHJldHVyblxuXHRcdGlmKCFpbm5lcm1vc3RDb250YWluZXIpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBtb3ZlIHRoZSBpdGVtIGludG8gdGhlIGNvbnRhaW5lciBpZiBpdCdzIG5vdCB0aGVyZSBhbHJlYWR5XG5cdFx0aWYodGhpcy5jb250YWluZXJzLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0aWYgKCF0aGlzLmNvbnRhaW5lcnNbaW5uZXJtb3N0SW5kZXhdLmNvbnRhaW5lckNhY2hlLm92ZXIpIHtcblx0XHRcdFx0dGhpcy5jb250YWluZXJzW2lubmVybW9zdEluZGV4XS5fdHJpZ2dlcihcIm92ZXJcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCh0aGlzKSk7XG5cdFx0XHRcdHRoaXMuY29udGFpbmVyc1tpbm5lcm1vc3RJbmRleF0uY29udGFpbmVyQ2FjaGUub3ZlciA9IDE7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0Ly9XaGVuIGVudGVyaW5nIGEgbmV3IGNvbnRhaW5lciwgd2Ugd2lsbCBmaW5kIHRoZSBpdGVtIHdpdGggdGhlIGxlYXN0IGRpc3RhbmNlIGFuZCBhcHBlbmQgb3VyIGl0ZW0gbmVhciBpdFxuXHRcdFx0ZGlzdCA9IDEwMDAwO1xuXHRcdFx0aXRlbVdpdGhMZWFzdERpc3RhbmNlID0gbnVsbDtcblx0XHRcdGZsb2F0aW5nID0gaW5uZXJtb3N0Q29udGFpbmVyLmZsb2F0aW5nIHx8IHRoaXMuX2lzRmxvYXRpbmcodGhpcy5jdXJyZW50SXRlbSk7XG5cdFx0XHRwb3NQcm9wZXJ0eSA9IGZsb2F0aW5nID8gXCJsZWZ0XCIgOiBcInRvcFwiO1xuXHRcdFx0c2l6ZVByb3BlcnR5ID0gZmxvYXRpbmcgPyBcIndpZHRoXCIgOiBcImhlaWdodFwiO1xuXHRcdFx0YXhpcyA9IGZsb2F0aW5nID8gXCJjbGllbnRYXCIgOiBcImNsaWVudFlcIjtcblxuXHRcdFx0Zm9yIChqID0gdGhpcy5pdGVtcy5sZW5ndGggLSAxOyBqID49IDA7IGotLSkge1xuXHRcdFx0XHRpZighJC5jb250YWlucyh0aGlzLmNvbnRhaW5lcnNbaW5uZXJtb3N0SW5kZXhdLmVsZW1lbnRbMF0sIHRoaXMuaXRlbXNbal0uaXRlbVswXSkpIHtcblx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZih0aGlzLml0ZW1zW2pdLml0ZW1bMF0gPT09IHRoaXMuY3VycmVudEl0ZW1bMF0pIHtcblx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGN1ciA9IHRoaXMuaXRlbXNbal0uaXRlbS5vZmZzZXQoKVtwb3NQcm9wZXJ0eV07XG5cdFx0XHRcdG5lYXJCb3R0b20gPSBmYWxzZTtcblx0XHRcdFx0aWYgKCBldmVudFsgYXhpcyBdIC0gY3VyID4gdGhpcy5pdGVtc1sgaiBdWyBzaXplUHJvcGVydHkgXSAvIDIgKSB7XG5cdFx0XHRcdFx0bmVhckJvdHRvbSA9IHRydWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoIE1hdGguYWJzKCBldmVudFsgYXhpcyBdIC0gY3VyICkgPCBkaXN0ICkge1xuXHRcdFx0XHRcdGRpc3QgPSBNYXRoLmFicyggZXZlbnRbIGF4aXMgXSAtIGN1ciApO1xuXHRcdFx0XHRcdGl0ZW1XaXRoTGVhc3REaXN0YW5jZSA9IHRoaXMuaXRlbXNbIGogXTtcblx0XHRcdFx0XHR0aGlzLmRpcmVjdGlvbiA9IG5lYXJCb3R0b20gPyBcInVwXCI6IFwiZG93blwiO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vQ2hlY2sgaWYgZHJvcE9uRW1wdHkgaXMgZW5hYmxlZFxuXHRcdFx0aWYoIWl0ZW1XaXRoTGVhc3REaXN0YW5jZSAmJiAhdGhpcy5vcHRpb25zLmRyb3BPbkVtcHR5KSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0aWYodGhpcy5jdXJyZW50Q29udGFpbmVyID09PSB0aGlzLmNvbnRhaW5lcnNbaW5uZXJtb3N0SW5kZXhdKSB7XG5cdFx0XHRcdGlmICggIXRoaXMuY3VycmVudENvbnRhaW5lci5jb250YWluZXJDYWNoZS5vdmVyICkge1xuXHRcdFx0XHRcdHRoaXMuY29udGFpbmVyc1sgaW5uZXJtb3N0SW5kZXggXS5fdHJpZ2dlciggXCJvdmVyXCIsIGV2ZW50LCB0aGlzLl91aUhhc2goKSApO1xuXHRcdFx0XHRcdHRoaXMuY3VycmVudENvbnRhaW5lci5jb250YWluZXJDYWNoZS5vdmVyID0gMTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdGl0ZW1XaXRoTGVhc3REaXN0YW5jZSA/IHRoaXMuX3JlYXJyYW5nZShldmVudCwgaXRlbVdpdGhMZWFzdERpc3RhbmNlLCBudWxsLCB0cnVlKSA6IHRoaXMuX3JlYXJyYW5nZShldmVudCwgbnVsbCwgdGhpcy5jb250YWluZXJzW2lubmVybW9zdEluZGV4XS5lbGVtZW50LCB0cnVlKTtcblx0XHRcdHRoaXMuX3RyaWdnZXIoXCJjaGFuZ2VcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCgpKTtcblx0XHRcdHRoaXMuY29udGFpbmVyc1tpbm5lcm1vc3RJbmRleF0uX3RyaWdnZXIoXCJjaGFuZ2VcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCh0aGlzKSk7XG5cdFx0XHR0aGlzLmN1cnJlbnRDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lcnNbaW5uZXJtb3N0SW5kZXhdO1xuXG5cdFx0XHQvL1VwZGF0ZSB0aGUgcGxhY2Vob2xkZXJcblx0XHRcdHRoaXMub3B0aW9ucy5wbGFjZWhvbGRlci51cGRhdGUodGhpcy5jdXJyZW50Q29udGFpbmVyLCB0aGlzLnBsYWNlaG9sZGVyKTtcblxuXHRcdFx0dGhpcy5jb250YWluZXJzW2lubmVybW9zdEluZGV4XS5fdHJpZ2dlcihcIm92ZXJcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCh0aGlzKSk7XG5cdFx0XHR0aGlzLmNvbnRhaW5lcnNbaW5uZXJtb3N0SW5kZXhdLmNvbnRhaW5lckNhY2hlLm92ZXIgPSAxO1xuXHRcdH1cblxuXG5cdH0sXG5cblx0X2NyZWF0ZUhlbHBlcjogZnVuY3Rpb24oZXZlbnQpIHtcblxuXHRcdHZhciBvID0gdGhpcy5vcHRpb25zLFxuXHRcdFx0aGVscGVyID0gJC5pc0Z1bmN0aW9uKG8uaGVscGVyKSA/ICQoby5oZWxwZXIuYXBwbHkodGhpcy5lbGVtZW50WzBdLCBbZXZlbnQsIHRoaXMuY3VycmVudEl0ZW1dKSkgOiAoby5oZWxwZXIgPT09IFwiY2xvbmVcIiA/IHRoaXMuY3VycmVudEl0ZW0uY2xvbmUoKSA6IHRoaXMuY3VycmVudEl0ZW0pO1xuXG5cdFx0Ly9BZGQgdGhlIGhlbHBlciB0byB0aGUgRE9NIGlmIHRoYXQgZGlkbid0IGhhcHBlbiBhbHJlYWR5XG5cdFx0aWYoIWhlbHBlci5wYXJlbnRzKFwiYm9keVwiKS5sZW5ndGgpIHtcblx0XHRcdCQoby5hcHBlbmRUbyAhPT0gXCJwYXJlbnRcIiA/IG8uYXBwZW5kVG8gOiB0aGlzLmN1cnJlbnRJdGVtWzBdLnBhcmVudE5vZGUpWzBdLmFwcGVuZENoaWxkKGhlbHBlclswXSk7XG5cdFx0fVxuXG5cdFx0aWYoaGVscGVyWzBdID09PSB0aGlzLmN1cnJlbnRJdGVtWzBdKSB7XG5cdFx0XHR0aGlzLl9zdG9yZWRDU1MgPSB7IHdpZHRoOiB0aGlzLmN1cnJlbnRJdGVtWzBdLnN0eWxlLndpZHRoLCBoZWlnaHQ6IHRoaXMuY3VycmVudEl0ZW1bMF0uc3R5bGUuaGVpZ2h0LCBwb3NpdGlvbjogdGhpcy5jdXJyZW50SXRlbS5jc3MoXCJwb3NpdGlvblwiKSwgdG9wOiB0aGlzLmN1cnJlbnRJdGVtLmNzcyhcInRvcFwiKSwgbGVmdDogdGhpcy5jdXJyZW50SXRlbS5jc3MoXCJsZWZ0XCIpIH07XG5cdFx0fVxuXG5cdFx0aWYoIWhlbHBlclswXS5zdHlsZS53aWR0aCB8fCBvLmZvcmNlSGVscGVyU2l6ZSkge1xuXHRcdFx0aGVscGVyLndpZHRoKHRoaXMuY3VycmVudEl0ZW0ud2lkdGgoKSk7XG5cdFx0fVxuXHRcdGlmKCFoZWxwZXJbMF0uc3R5bGUuaGVpZ2h0IHx8IG8uZm9yY2VIZWxwZXJTaXplKSB7XG5cdFx0XHRoZWxwZXIuaGVpZ2h0KHRoaXMuY3VycmVudEl0ZW0uaGVpZ2h0KCkpO1xuXHRcdH1cblxuXHRcdHJldHVybiBoZWxwZXI7XG5cblx0fSxcblxuXHRfYWRqdXN0T2Zmc2V0RnJvbUhlbHBlcjogZnVuY3Rpb24ob2JqKSB7XG5cdFx0aWYgKHR5cGVvZiBvYmogPT09IFwic3RyaW5nXCIpIHtcblx0XHRcdG9iaiA9IG9iai5zcGxpdChcIiBcIik7XG5cdFx0fVxuXHRcdGlmICgkLmlzQXJyYXkob2JqKSkge1xuXHRcdFx0b2JqID0ge2xlZnQ6ICtvYmpbMF0sIHRvcDogK29ialsxXSB8fCAwfTtcblx0XHR9XG5cdFx0aWYgKFwibGVmdFwiIGluIG9iaikge1xuXHRcdFx0dGhpcy5vZmZzZXQuY2xpY2subGVmdCA9IG9iai5sZWZ0ICsgdGhpcy5tYXJnaW5zLmxlZnQ7XG5cdFx0fVxuXHRcdGlmIChcInJpZ2h0XCIgaW4gb2JqKSB7XG5cdFx0XHR0aGlzLm9mZnNldC5jbGljay5sZWZ0ID0gdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAtIG9iai5yaWdodCArIHRoaXMubWFyZ2lucy5sZWZ0O1xuXHRcdH1cblx0XHRpZiAoXCJ0b3BcIiBpbiBvYmopIHtcblx0XHRcdHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA9IG9iai50b3AgKyB0aGlzLm1hcmdpbnMudG9wO1xuXHRcdH1cblx0XHRpZiAoXCJib3R0b21cIiBpbiBvYmopIHtcblx0XHRcdHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA9IHRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0IC0gb2JqLmJvdHRvbSArIHRoaXMubWFyZ2lucy50b3A7XG5cdFx0fVxuXHR9LFxuXG5cdF9nZXRQYXJlbnRPZmZzZXQ6IGZ1bmN0aW9uKCkge1xuXG5cblx0XHQvL0dldCB0aGUgb2Zmc2V0UGFyZW50IGFuZCBjYWNoZSBpdHMgcG9zaXRpb25cblx0XHR0aGlzLm9mZnNldFBhcmVudCA9IHRoaXMuaGVscGVyLm9mZnNldFBhcmVudCgpO1xuXHRcdHZhciBwbyA9IHRoaXMub2Zmc2V0UGFyZW50Lm9mZnNldCgpO1xuXG5cdFx0Ly8gVGhpcyBpcyBhIHNwZWNpYWwgY2FzZSB3aGVyZSB3ZSBuZWVkIHRvIG1vZGlmeSBhIG9mZnNldCBjYWxjdWxhdGVkIG9uIHN0YXJ0LCBzaW5jZSB0aGUgZm9sbG93aW5nIGhhcHBlbmVkOlxuXHRcdC8vIDEuIFRoZSBwb3NpdGlvbiBvZiB0aGUgaGVscGVyIGlzIGFic29sdXRlLCBzbyBpdCdzIHBvc2l0aW9uIGlzIGNhbGN1bGF0ZWQgYmFzZWQgb24gdGhlIG5leHQgcG9zaXRpb25lZCBwYXJlbnRcblx0XHQvLyAyLiBUaGUgYWN0dWFsIG9mZnNldCBwYXJlbnQgaXMgYSBjaGlsZCBvZiB0aGUgc2Nyb2xsIHBhcmVudCwgYW5kIHRoZSBzY3JvbGwgcGFyZW50IGlzbid0IHRoZSBkb2N1bWVudCwgd2hpY2ggbWVhbnMgdGhhdFxuXHRcdC8vICAgIHRoZSBzY3JvbGwgaXMgaW5jbHVkZWQgaW4gdGhlIGluaXRpYWwgY2FsY3VsYXRpb24gb2YgdGhlIG9mZnNldCBvZiB0aGUgcGFyZW50LCBhbmQgbmV2ZXIgcmVjYWxjdWxhdGVkIHVwb24gZHJhZ1xuXHRcdGlmKHRoaXMuY3NzUG9zaXRpb24gPT09IFwiYWJzb2x1dGVcIiAmJiB0aGlzLnNjcm9sbFBhcmVudFswXSAhPT0gdGhpcy5kb2N1bWVudFswXSAmJiAkLmNvbnRhaW5zKHRoaXMuc2Nyb2xsUGFyZW50WzBdLCB0aGlzLm9mZnNldFBhcmVudFswXSkpIHtcblx0XHRcdHBvLmxlZnQgKz0gdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCgpO1xuXHRcdFx0cG8udG9wICs9IHRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpO1xuXHRcdH1cblxuXHRcdC8vIFRoaXMgbmVlZHMgdG8gYmUgYWN0dWFsbHkgZG9uZSBmb3IgYWxsIGJyb3dzZXJzLCBzaW5jZSBwYWdlWC9wYWdlWSBpbmNsdWRlcyB0aGlzIGluZm9ybWF0aW9uXG5cdFx0Ly8gd2l0aCBhbiB1Z2x5IElFIGZpeFxuXHRcdGlmKCB0aGlzLm9mZnNldFBhcmVudFswXSA9PT0gdGhpcy5kb2N1bWVudFswXS5ib2R5IHx8ICh0aGlzLm9mZnNldFBhcmVudFswXS50YWdOYW1lICYmIHRoaXMub2Zmc2V0UGFyZW50WzBdLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gXCJodG1sXCIgJiYgJC51aS5pZSkpIHtcblx0XHRcdHBvID0geyB0b3A6IDAsIGxlZnQ6IDAgfTtcblx0XHR9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0dG9wOiBwby50b3AgKyAocGFyc2VJbnQodGhpcy5vZmZzZXRQYXJlbnQuY3NzKFwiYm9yZGVyVG9wV2lkdGhcIiksMTApIHx8IDApLFxuXHRcdFx0bGVmdDogcG8ubGVmdCArIChwYXJzZUludCh0aGlzLm9mZnNldFBhcmVudC5jc3MoXCJib3JkZXJMZWZ0V2lkdGhcIiksMTApIHx8IDApXG5cdFx0fTtcblxuXHR9LFxuXG5cdF9nZXRSZWxhdGl2ZU9mZnNldDogZnVuY3Rpb24oKSB7XG5cblx0XHRpZih0aGlzLmNzc1Bvc2l0aW9uID09PSBcInJlbGF0aXZlXCIpIHtcblx0XHRcdHZhciBwID0gdGhpcy5jdXJyZW50SXRlbS5wb3NpdGlvbigpO1xuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0dG9wOiBwLnRvcCAtIChwYXJzZUludCh0aGlzLmhlbHBlci5jc3MoXCJ0b3BcIiksMTApIHx8IDApICsgdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsVG9wKCksXG5cdFx0XHRcdGxlZnQ6IHAubGVmdCAtIChwYXJzZUludCh0aGlzLmhlbHBlci5jc3MoXCJsZWZ0XCIpLDEwKSB8fCAwKSArIHRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbExlZnQoKVxuXHRcdFx0fTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cmV0dXJuIHsgdG9wOiAwLCBsZWZ0OiAwIH07XG5cdFx0fVxuXG5cdH0sXG5cblx0X2NhY2hlTWFyZ2luczogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5tYXJnaW5zID0ge1xuXHRcdFx0bGVmdDogKHBhcnNlSW50KHRoaXMuY3VycmVudEl0ZW0uY3NzKFwibWFyZ2luTGVmdFwiKSwxMCkgfHwgMCksXG5cdFx0XHR0b3A6IChwYXJzZUludCh0aGlzLmN1cnJlbnRJdGVtLmNzcyhcIm1hcmdpblRvcFwiKSwxMCkgfHwgMClcblx0XHR9O1xuXHR9LFxuXG5cdF9jYWNoZUhlbHBlclByb3BvcnRpb25zOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmhlbHBlclByb3BvcnRpb25zID0ge1xuXHRcdFx0d2lkdGg6IHRoaXMuaGVscGVyLm91dGVyV2lkdGgoKSxcblx0XHRcdGhlaWdodDogdGhpcy5oZWxwZXIub3V0ZXJIZWlnaHQoKVxuXHRcdH07XG5cdH0sXG5cblx0X3NldENvbnRhaW5tZW50OiBmdW5jdGlvbigpIHtcblxuXHRcdHZhciBjZSwgY28sIG92ZXIsXG5cdFx0XHRvID0gdGhpcy5vcHRpb25zO1xuXHRcdGlmKG8uY29udGFpbm1lbnQgPT09IFwicGFyZW50XCIpIHtcblx0XHRcdG8uY29udGFpbm1lbnQgPSB0aGlzLmhlbHBlclswXS5wYXJlbnROb2RlO1xuXHRcdH1cblx0XHRpZihvLmNvbnRhaW5tZW50ID09PSBcImRvY3VtZW50XCIgfHwgby5jb250YWlubWVudCA9PT0gXCJ3aW5kb3dcIikge1xuXHRcdFx0dGhpcy5jb250YWlubWVudCA9IFtcblx0XHRcdFx0MCAtIHRoaXMub2Zmc2V0LnJlbGF0aXZlLmxlZnQgLSB0aGlzLm9mZnNldC5wYXJlbnQubGVmdCxcblx0XHRcdFx0MCAtIHRoaXMub2Zmc2V0LnJlbGF0aXZlLnRvcCAtIHRoaXMub2Zmc2V0LnBhcmVudC50b3AsXG5cdFx0XHRcdG8uY29udGFpbm1lbnQgPT09IFwiZG9jdW1lbnRcIiA/IHRoaXMuZG9jdW1lbnQud2lkdGgoKSA6IHRoaXMud2luZG93LndpZHRoKCkgLSB0aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoIC0gdGhpcy5tYXJnaW5zLmxlZnQsXG5cdFx0XHRcdChvLmNvbnRhaW5tZW50ID09PSBcImRvY3VtZW50XCIgPyB0aGlzLmRvY3VtZW50LndpZHRoKCkgOiB0aGlzLndpbmRvdy5oZWlnaHQoKSB8fCB0aGlzLmRvY3VtZW50WzBdLmJvZHkucGFyZW50Tm9kZS5zY3JvbGxIZWlnaHQpIC0gdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQgLSB0aGlzLm1hcmdpbnMudG9wXG5cdFx0XHRdO1xuXHRcdH1cblxuXHRcdGlmKCEoL14oZG9jdW1lbnR8d2luZG93fHBhcmVudCkkLykudGVzdChvLmNvbnRhaW5tZW50KSkge1xuXHRcdFx0Y2UgPSAkKG8uY29udGFpbm1lbnQpWzBdO1xuXHRcdFx0Y28gPSAkKG8uY29udGFpbm1lbnQpLm9mZnNldCgpO1xuXHRcdFx0b3ZlciA9ICgkKGNlKS5jc3MoXCJvdmVyZmxvd1wiKSAhPT0gXCJoaWRkZW5cIik7XG5cblx0XHRcdHRoaXMuY29udGFpbm1lbnQgPSBbXG5cdFx0XHRcdGNvLmxlZnQgKyAocGFyc2VJbnQoJChjZSkuY3NzKFwiYm9yZGVyTGVmdFdpZHRoXCIpLDEwKSB8fCAwKSArIChwYXJzZUludCgkKGNlKS5jc3MoXCJwYWRkaW5nTGVmdFwiKSwxMCkgfHwgMCkgLSB0aGlzLm1hcmdpbnMubGVmdCxcblx0XHRcdFx0Y28udG9wICsgKHBhcnNlSW50KCQoY2UpLmNzcyhcImJvcmRlclRvcFdpZHRoXCIpLDEwKSB8fCAwKSArIChwYXJzZUludCgkKGNlKS5jc3MoXCJwYWRkaW5nVG9wXCIpLDEwKSB8fCAwKSAtIHRoaXMubWFyZ2lucy50b3AsXG5cdFx0XHRcdGNvLmxlZnQrKG92ZXIgPyBNYXRoLm1heChjZS5zY3JvbGxXaWR0aCxjZS5vZmZzZXRXaWR0aCkgOiBjZS5vZmZzZXRXaWR0aCkgLSAocGFyc2VJbnQoJChjZSkuY3NzKFwiYm9yZGVyTGVmdFdpZHRoXCIpLDEwKSB8fCAwKSAtIChwYXJzZUludCgkKGNlKS5jc3MoXCJwYWRkaW5nUmlnaHRcIiksMTApIHx8IDApIC0gdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAtIHRoaXMubWFyZ2lucy5sZWZ0LFxuXHRcdFx0XHRjby50b3ArKG92ZXIgPyBNYXRoLm1heChjZS5zY3JvbGxIZWlnaHQsY2Uub2Zmc2V0SGVpZ2h0KSA6IGNlLm9mZnNldEhlaWdodCkgLSAocGFyc2VJbnQoJChjZSkuY3NzKFwiYm9yZGVyVG9wV2lkdGhcIiksMTApIHx8IDApIC0gKHBhcnNlSW50KCQoY2UpLmNzcyhcInBhZGRpbmdCb3R0b21cIiksMTApIHx8IDApIC0gdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQgLSB0aGlzLm1hcmdpbnMudG9wXG5cdFx0XHRdO1xuXHRcdH1cblxuXHR9LFxuXG5cdF9jb252ZXJ0UG9zaXRpb25UbzogZnVuY3Rpb24oZCwgcG9zKSB7XG5cblx0XHRpZighcG9zKSB7XG5cdFx0XHRwb3MgPSB0aGlzLnBvc2l0aW9uO1xuXHRcdH1cblx0XHR2YXIgbW9kID0gZCA9PT0gXCJhYnNvbHV0ZVwiID8gMSA6IC0xLFxuXHRcdFx0c2Nyb2xsID0gdGhpcy5jc3NQb3NpdGlvbiA9PT0gXCJhYnNvbHV0ZVwiICYmICEodGhpcy5zY3JvbGxQYXJlbnRbMF0gIT09IHRoaXMuZG9jdW1lbnRbMF0gJiYgJC5jb250YWlucyh0aGlzLnNjcm9sbFBhcmVudFswXSwgdGhpcy5vZmZzZXRQYXJlbnRbMF0pKSA/IHRoaXMub2Zmc2V0UGFyZW50IDogdGhpcy5zY3JvbGxQYXJlbnQsXG5cdFx0XHRzY3JvbGxJc1Jvb3ROb2RlID0gKC8oaHRtbHxib2R5KS9pKS50ZXN0KHNjcm9sbFswXS50YWdOYW1lKTtcblxuXHRcdHJldHVybiB7XG5cdFx0XHR0b3A6IChcblx0XHRcdFx0cG9zLnRvcFx0K1x0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIGFic29sdXRlIG1vdXNlIHBvc2l0aW9uXG5cdFx0XHRcdHRoaXMub2Zmc2V0LnJlbGF0aXZlLnRvcCAqIG1vZCArXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBPbmx5IGZvciByZWxhdGl2ZSBwb3NpdGlvbmVkIG5vZGVzOiBSZWxhdGl2ZSBvZmZzZXQgZnJvbSBlbGVtZW50IHRvIG9mZnNldCBwYXJlbnRcblx0XHRcdFx0dGhpcy5vZmZzZXQucGFyZW50LnRvcCAqIG1vZCAtXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRoZSBvZmZzZXRQYXJlbnQncyBvZmZzZXQgd2l0aG91dCBib3JkZXJzIChvZmZzZXQgKyBib3JkZXIpXG5cdFx0XHRcdCggKCB0aGlzLmNzc1Bvc2l0aW9uID09PSBcImZpeGVkXCIgPyAtdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsVG9wKCkgOiAoIHNjcm9sbElzUm9vdE5vZGUgPyAwIDogc2Nyb2xsLnNjcm9sbFRvcCgpICkgKSAqIG1vZClcblx0XHRcdCksXG5cdFx0XHRsZWZ0OiAoXG5cdFx0XHRcdHBvcy5sZWZ0ICtcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRoZSBhYnNvbHV0ZSBtb3VzZSBwb3NpdGlvblxuXHRcdFx0XHR0aGlzLm9mZnNldC5yZWxhdGl2ZS5sZWZ0ICogbW9kICtcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIE9ubHkgZm9yIHJlbGF0aXZlIHBvc2l0aW9uZWQgbm9kZXM6IFJlbGF0aXZlIG9mZnNldCBmcm9tIGVsZW1lbnQgdG8gb2Zmc2V0IHBhcmVudFxuXHRcdFx0XHR0aGlzLm9mZnNldC5wYXJlbnQubGVmdCAqIG1vZFx0LVx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIG9mZnNldFBhcmVudCdzIG9mZnNldCB3aXRob3V0IGJvcmRlcnMgKG9mZnNldCArIGJvcmRlcilcblx0XHRcdFx0KCAoIHRoaXMuY3NzUG9zaXRpb24gPT09IFwiZml4ZWRcIiA/IC10aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KCkgOiBzY3JvbGxJc1Jvb3ROb2RlID8gMCA6IHNjcm9sbC5zY3JvbGxMZWZ0KCkgKSAqIG1vZClcblx0XHRcdClcblx0XHR9O1xuXG5cdH0sXG5cblx0X2dlbmVyYXRlUG9zaXRpb246IGZ1bmN0aW9uKGV2ZW50KSB7XG5cblx0XHR2YXIgdG9wLCBsZWZ0LFxuXHRcdFx0byA9IHRoaXMub3B0aW9ucyxcblx0XHRcdHBhZ2VYID0gZXZlbnQucGFnZVgsXG5cdFx0XHRwYWdlWSA9IGV2ZW50LnBhZ2VZLFxuXHRcdFx0c2Nyb2xsID0gdGhpcy5jc3NQb3NpdGlvbiA9PT0gXCJhYnNvbHV0ZVwiICYmICEodGhpcy5zY3JvbGxQYXJlbnRbMF0gIT09IHRoaXMuZG9jdW1lbnRbMF0gJiYgJC5jb250YWlucyh0aGlzLnNjcm9sbFBhcmVudFswXSwgdGhpcy5vZmZzZXRQYXJlbnRbMF0pKSA/IHRoaXMub2Zmc2V0UGFyZW50IDogdGhpcy5zY3JvbGxQYXJlbnQsIHNjcm9sbElzUm9vdE5vZGUgPSAoLyhodG1sfGJvZHkpL2kpLnRlc3Qoc2Nyb2xsWzBdLnRhZ05hbWUpO1xuXG5cdFx0Ly8gVGhpcyBpcyBhbm90aGVyIHZlcnkgd2VpcmQgc3BlY2lhbCBjYXNlIHRoYXQgb25seSBoYXBwZW5zIGZvciByZWxhdGl2ZSBlbGVtZW50czpcblx0XHQvLyAxLiBJZiB0aGUgY3NzIHBvc2l0aW9uIGlzIHJlbGF0aXZlXG5cdFx0Ly8gMi4gYW5kIHRoZSBzY3JvbGwgcGFyZW50IGlzIHRoZSBkb2N1bWVudCBvciBzaW1pbGFyIHRvIHRoZSBvZmZzZXQgcGFyZW50XG5cdFx0Ly8gd2UgaGF2ZSB0byByZWZyZXNoIHRoZSByZWxhdGl2ZSBvZmZzZXQgZHVyaW5nIHRoZSBzY3JvbGwgc28gdGhlcmUgYXJlIG5vIGp1bXBzXG5cdFx0aWYodGhpcy5jc3NQb3NpdGlvbiA9PT0gXCJyZWxhdGl2ZVwiICYmICEodGhpcy5zY3JvbGxQYXJlbnRbMF0gIT09IHRoaXMuZG9jdW1lbnRbMF0gJiYgdGhpcy5zY3JvbGxQYXJlbnRbMF0gIT09IHRoaXMub2Zmc2V0UGFyZW50WzBdKSkge1xuXHRcdFx0dGhpcy5vZmZzZXQucmVsYXRpdmUgPSB0aGlzLl9nZXRSZWxhdGl2ZU9mZnNldCgpO1xuXHRcdH1cblxuXHRcdC8qXG5cdFx0ICogLSBQb3NpdGlvbiBjb25zdHJhaW5pbmcgLVxuXHRcdCAqIENvbnN0cmFpbiB0aGUgcG9zaXRpb24gdG8gYSBtaXggb2YgZ3JpZCwgY29udGFpbm1lbnQuXG5cdFx0ICovXG5cblx0XHRpZih0aGlzLm9yaWdpbmFsUG9zaXRpb24pIHsgLy9JZiB3ZSBhcmUgbm90IGRyYWdnaW5nIHlldCwgd2Ugd29uJ3QgY2hlY2sgZm9yIG9wdGlvbnNcblxuXHRcdFx0aWYodGhpcy5jb250YWlubWVudCkge1xuXHRcdFx0XHRpZihldmVudC5wYWdlWCAtIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPCB0aGlzLmNvbnRhaW5tZW50WzBdKSB7XG5cdFx0XHRcdFx0cGFnZVggPSB0aGlzLmNvbnRhaW5tZW50WzBdICsgdGhpcy5vZmZzZXQuY2xpY2subGVmdDtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZihldmVudC5wYWdlWSAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA8IHRoaXMuY29udGFpbm1lbnRbMV0pIHtcblx0XHRcdFx0XHRwYWdlWSA9IHRoaXMuY29udGFpbm1lbnRbMV0gKyB0aGlzLm9mZnNldC5jbGljay50b3A7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYoZXZlbnQucGFnZVggLSB0aGlzLm9mZnNldC5jbGljay5sZWZ0ID4gdGhpcy5jb250YWlubWVudFsyXSkge1xuXHRcdFx0XHRcdHBhZ2VYID0gdGhpcy5jb250YWlubWVudFsyXSArIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYoZXZlbnQucGFnZVkgLSB0aGlzLm9mZnNldC5jbGljay50b3AgPiB0aGlzLmNvbnRhaW5tZW50WzNdKSB7XG5cdFx0XHRcdFx0cGFnZVkgPSB0aGlzLmNvbnRhaW5tZW50WzNdICsgdGhpcy5vZmZzZXQuY2xpY2sudG9wO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmKG8uZ3JpZCkge1xuXHRcdFx0XHR0b3AgPSB0aGlzLm9yaWdpbmFsUGFnZVkgKyBNYXRoLnJvdW5kKChwYWdlWSAtIHRoaXMub3JpZ2luYWxQYWdlWSkgLyBvLmdyaWRbMV0pICogby5ncmlkWzFdO1xuXHRcdFx0XHRwYWdlWSA9IHRoaXMuY29udGFpbm1lbnQgPyAoICh0b3AgLSB0aGlzLm9mZnNldC5jbGljay50b3AgPj0gdGhpcy5jb250YWlubWVudFsxXSAmJiB0b3AgLSB0aGlzLm9mZnNldC5jbGljay50b3AgPD0gdGhpcy5jb250YWlubWVudFszXSkgPyB0b3AgOiAoKHRvcCAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA+PSB0aGlzLmNvbnRhaW5tZW50WzFdKSA/IHRvcCAtIG8uZ3JpZFsxXSA6IHRvcCArIG8uZ3JpZFsxXSkpIDogdG9wO1xuXG5cdFx0XHRcdGxlZnQgPSB0aGlzLm9yaWdpbmFsUGFnZVggKyBNYXRoLnJvdW5kKChwYWdlWCAtIHRoaXMub3JpZ2luYWxQYWdlWCkgLyBvLmdyaWRbMF0pICogby5ncmlkWzBdO1xuXHRcdFx0XHRwYWdlWCA9IHRoaXMuY29udGFpbm1lbnQgPyAoIChsZWZ0IC0gdGhpcy5vZmZzZXQuY2xpY2subGVmdCA+PSB0aGlzLmNvbnRhaW5tZW50WzBdICYmIGxlZnQgLSB0aGlzLm9mZnNldC5jbGljay5sZWZ0IDw9IHRoaXMuY29udGFpbm1lbnRbMl0pID8gbGVmdCA6ICgobGVmdCAtIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPj0gdGhpcy5jb250YWlubWVudFswXSkgPyBsZWZ0IC0gby5ncmlkWzBdIDogbGVmdCArIG8uZ3JpZFswXSkpIDogbGVmdDtcblx0XHRcdH1cblxuXHRcdH1cblxuXHRcdHJldHVybiB7XG5cdFx0XHR0b3A6IChcblx0XHRcdFx0cGFnZVkgLVx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIGFic29sdXRlIG1vdXNlIHBvc2l0aW9uXG5cdFx0XHRcdHRoaXMub2Zmc2V0LmNsaWNrLnRvcCAtXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBDbGljayBvZmZzZXQgKHJlbGF0aXZlIHRvIHRoZSBlbGVtZW50KVxuXHRcdFx0XHR0aGlzLm9mZnNldC5yZWxhdGl2ZS50b3BcdC1cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gT25seSBmb3IgcmVsYXRpdmUgcG9zaXRpb25lZCBub2RlczogUmVsYXRpdmUgb2Zmc2V0IGZyb20gZWxlbWVudCB0byBvZmZzZXQgcGFyZW50XG5cdFx0XHRcdHRoaXMub2Zmc2V0LnBhcmVudC50b3AgK1x0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRoZSBvZmZzZXRQYXJlbnQncyBvZmZzZXQgd2l0aG91dCBib3JkZXJzIChvZmZzZXQgKyBib3JkZXIpXG5cdFx0XHRcdCggKCB0aGlzLmNzc1Bvc2l0aW9uID09PSBcImZpeGVkXCIgPyAtdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsVG9wKCkgOiAoIHNjcm9sbElzUm9vdE5vZGUgPyAwIDogc2Nyb2xsLnNjcm9sbFRvcCgpICkgKSlcblx0XHRcdCksXG5cdFx0XHRsZWZ0OiAoXG5cdFx0XHRcdHBhZ2VYIC1cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRoZSBhYnNvbHV0ZSBtb3VzZSBwb3NpdGlvblxuXHRcdFx0XHR0aGlzLm9mZnNldC5jbGljay5sZWZ0IC1cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBDbGljayBvZmZzZXQgKHJlbGF0aXZlIHRvIHRoZSBlbGVtZW50KVxuXHRcdFx0XHR0aGlzLm9mZnNldC5yZWxhdGl2ZS5sZWZ0XHQtXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIE9ubHkgZm9yIHJlbGF0aXZlIHBvc2l0aW9uZWQgbm9kZXM6IFJlbGF0aXZlIG9mZnNldCBmcm9tIGVsZW1lbnQgdG8gb2Zmc2V0IHBhcmVudFxuXHRcdFx0XHR0aGlzLm9mZnNldC5wYXJlbnQubGVmdCArXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIG9mZnNldFBhcmVudCdzIG9mZnNldCB3aXRob3V0IGJvcmRlcnMgKG9mZnNldCArIGJvcmRlcilcblx0XHRcdFx0KCAoIHRoaXMuY3NzUG9zaXRpb24gPT09IFwiZml4ZWRcIiA/IC10aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KCkgOiBzY3JvbGxJc1Jvb3ROb2RlID8gMCA6IHNjcm9sbC5zY3JvbGxMZWZ0KCkgKSlcblx0XHRcdClcblx0XHR9O1xuXG5cdH0sXG5cblx0X3JlYXJyYW5nZTogZnVuY3Rpb24oZXZlbnQsIGksIGEsIGhhcmRSZWZyZXNoKSB7XG5cblx0XHRhID8gYVswXS5hcHBlbmRDaGlsZCh0aGlzLnBsYWNlaG9sZGVyWzBdKSA6IGkuaXRlbVswXS5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0aGlzLnBsYWNlaG9sZGVyWzBdLCAodGhpcy5kaXJlY3Rpb24gPT09IFwiZG93blwiID8gaS5pdGVtWzBdIDogaS5pdGVtWzBdLm5leHRTaWJsaW5nKSk7XG5cblx0XHQvL1ZhcmlvdXMgdGhpbmdzIGRvbmUgaGVyZSB0byBpbXByb3ZlIHRoZSBwZXJmb3JtYW5jZTpcblx0XHQvLyAxLiB3ZSBjcmVhdGUgYSBzZXRUaW1lb3V0LCB0aGF0IGNhbGxzIHJlZnJlc2hQb3NpdGlvbnNcblx0XHQvLyAyLiBvbiB0aGUgaW5zdGFuY2UsIHdlIGhhdmUgYSBjb3VudGVyIHZhcmlhYmxlLCB0aGF0IGdldCdzIGhpZ2hlciBhZnRlciBldmVyeSBhcHBlbmRcblx0XHQvLyAzLiBvbiB0aGUgbG9jYWwgc2NvcGUsIHdlIGNvcHkgdGhlIGNvdW50ZXIgdmFyaWFibGUsIGFuZCBjaGVjayBpbiB0aGUgdGltZW91dCwgaWYgaXQncyBzdGlsbCB0aGUgc2FtZVxuXHRcdC8vIDQuIHRoaXMgbGV0cyBvbmx5IHRoZSBsYXN0IGFkZGl0aW9uIHRvIHRoZSB0aW1lb3V0IHN0YWNrIHRocm91Z2hcblx0XHR0aGlzLmNvdW50ZXIgPSB0aGlzLmNvdW50ZXIgPyArK3RoaXMuY291bnRlciA6IDE7XG5cdFx0dmFyIGNvdW50ZXIgPSB0aGlzLmNvdW50ZXI7XG5cblx0XHR0aGlzLl9kZWxheShmdW5jdGlvbigpIHtcblx0XHRcdGlmKGNvdW50ZXIgPT09IHRoaXMuY291bnRlcikge1xuXHRcdFx0XHR0aGlzLnJlZnJlc2hQb3NpdGlvbnMoIWhhcmRSZWZyZXNoKTsgLy9QcmVjb21wdXRlIGFmdGVyIGVhY2ggRE9NIGluc2VydGlvbiwgTk9UIG9uIG1vdXNlbW92ZVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdH0sXG5cblx0X2NsZWFyOiBmdW5jdGlvbihldmVudCwgbm9Qcm9wYWdhdGlvbikge1xuXG5cdFx0dGhpcy5yZXZlcnRpbmcgPSBmYWxzZTtcblx0XHQvLyBXZSBkZWxheSBhbGwgZXZlbnRzIHRoYXQgaGF2ZSB0byBiZSB0cmlnZ2VyZWQgdG8gYWZ0ZXIgdGhlIHBvaW50IHdoZXJlIHRoZSBwbGFjZWhvbGRlciBoYXMgYmVlbiByZW1vdmVkIGFuZFxuXHRcdC8vIGV2ZXJ5dGhpbmcgZWxzZSBub3JtYWxpemVkIGFnYWluXG5cdFx0dmFyIGksXG5cdFx0XHRkZWxheWVkVHJpZ2dlcnMgPSBbXTtcblxuXHRcdC8vIFdlIGZpcnN0IGhhdmUgdG8gdXBkYXRlIHRoZSBkb20gcG9zaXRpb24gb2YgdGhlIGFjdHVhbCBjdXJyZW50SXRlbVxuXHRcdC8vIE5vdGU6IGRvbid0IGRvIGl0IGlmIHRoZSBjdXJyZW50IGl0ZW0gaXMgYWxyZWFkeSByZW1vdmVkIChieSBhIHVzZXIpLCBvciBpdCBnZXRzIHJlYXBwZW5kZWQgKHNlZSAjNDA4OClcblx0XHRpZighdGhpcy5fbm9GaW5hbFNvcnQgJiYgdGhpcy5jdXJyZW50SXRlbS5wYXJlbnQoKS5sZW5ndGgpIHtcblx0XHRcdHRoaXMucGxhY2Vob2xkZXIuYmVmb3JlKHRoaXMuY3VycmVudEl0ZW0pO1xuXHRcdH1cblx0XHR0aGlzLl9ub0ZpbmFsU29ydCA9IG51bGw7XG5cblx0XHRpZih0aGlzLmhlbHBlclswXSA9PT0gdGhpcy5jdXJyZW50SXRlbVswXSkge1xuXHRcdFx0Zm9yKGkgaW4gdGhpcy5fc3RvcmVkQ1NTKSB7XG5cdFx0XHRcdGlmKHRoaXMuX3N0b3JlZENTU1tpXSA9PT0gXCJhdXRvXCIgfHwgdGhpcy5fc3RvcmVkQ1NTW2ldID09PSBcInN0YXRpY1wiKSB7XG5cdFx0XHRcdFx0dGhpcy5fc3RvcmVkQ1NTW2ldID0gXCJcIjtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0dGhpcy5jdXJyZW50SXRlbS5jc3ModGhpcy5fc3RvcmVkQ1NTKS5yZW1vdmVDbGFzcyhcInVpLXNvcnRhYmxlLWhlbHBlclwiKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5jdXJyZW50SXRlbS5zaG93KCk7XG5cdFx0fVxuXG5cdFx0aWYodGhpcy5mcm9tT3V0c2lkZSAmJiAhbm9Qcm9wYWdhdGlvbikge1xuXHRcdFx0ZGVsYXllZFRyaWdnZXJzLnB1c2goZnVuY3Rpb24oZXZlbnQpIHsgdGhpcy5fdHJpZ2dlcihcInJlY2VpdmVcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCh0aGlzLmZyb21PdXRzaWRlKSk7IH0pO1xuXHRcdH1cblx0XHRpZigodGhpcy5mcm9tT3V0c2lkZSB8fCB0aGlzLmRvbVBvc2l0aW9uLnByZXYgIT09IHRoaXMuY3VycmVudEl0ZW0ucHJldigpLm5vdChcIi51aS1zb3J0YWJsZS1oZWxwZXJcIilbMF0gfHwgdGhpcy5kb21Qb3NpdGlvbi5wYXJlbnQgIT09IHRoaXMuY3VycmVudEl0ZW0ucGFyZW50KClbMF0pICYmICFub1Byb3BhZ2F0aW9uKSB7XG5cdFx0XHRkZWxheWVkVHJpZ2dlcnMucHVzaChmdW5jdGlvbihldmVudCkgeyB0aGlzLl90cmlnZ2VyKFwidXBkYXRlXCIsIGV2ZW50LCB0aGlzLl91aUhhc2goKSk7IH0pOyAvL1RyaWdnZXIgdXBkYXRlIGNhbGxiYWNrIGlmIHRoZSBET00gcG9zaXRpb24gaGFzIGNoYW5nZWRcblx0XHR9XG5cblx0XHQvLyBDaGVjayBpZiB0aGUgaXRlbXMgQ29udGFpbmVyIGhhcyBDaGFuZ2VkIGFuZCB0cmlnZ2VyIGFwcHJvcHJpYXRlXG5cdFx0Ly8gZXZlbnRzLlxuXHRcdGlmICh0aGlzICE9PSB0aGlzLmN1cnJlbnRDb250YWluZXIpIHtcblx0XHRcdGlmKCFub1Byb3BhZ2F0aW9uKSB7XG5cdFx0XHRcdGRlbGF5ZWRUcmlnZ2Vycy5wdXNoKGZ1bmN0aW9uKGV2ZW50KSB7IHRoaXMuX3RyaWdnZXIoXCJyZW1vdmVcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCgpKTsgfSk7XG5cdFx0XHRcdGRlbGF5ZWRUcmlnZ2Vycy5wdXNoKChmdW5jdGlvbihjKSB7IHJldHVybiBmdW5jdGlvbihldmVudCkgeyBjLl90cmlnZ2VyKFwicmVjZWl2ZVwiLCBldmVudCwgdGhpcy5fdWlIYXNoKHRoaXMpKTsgfTsgIH0pLmNhbGwodGhpcywgdGhpcy5jdXJyZW50Q29udGFpbmVyKSk7XG5cdFx0XHRcdGRlbGF5ZWRUcmlnZ2Vycy5wdXNoKChmdW5jdGlvbihjKSB7IHJldHVybiBmdW5jdGlvbihldmVudCkgeyBjLl90cmlnZ2VyKFwidXBkYXRlXCIsIGV2ZW50LCB0aGlzLl91aUhhc2godGhpcykpOyAgfTsgfSkuY2FsbCh0aGlzLCB0aGlzLmN1cnJlbnRDb250YWluZXIpKTtcblx0XHRcdH1cblx0XHR9XG5cblxuXHRcdC8vUG9zdCBldmVudHMgdG8gY29udGFpbmVyc1xuXHRcdGZ1bmN0aW9uIGRlbGF5RXZlbnQoIHR5cGUsIGluc3RhbmNlLCBjb250YWluZXIgKSB7XG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHRjb250YWluZXIuX3RyaWdnZXIoIHR5cGUsIGV2ZW50LCBpbnN0YW5jZS5fdWlIYXNoKCBpbnN0YW5jZSApICk7XG5cdFx0XHR9O1xuXHRcdH1cblx0XHRmb3IgKGkgPSB0aGlzLmNvbnRhaW5lcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pe1xuXHRcdFx0aWYgKCFub1Byb3BhZ2F0aW9uKSB7XG5cdFx0XHRcdGRlbGF5ZWRUcmlnZ2Vycy5wdXNoKCBkZWxheUV2ZW50KCBcImRlYWN0aXZhdGVcIiwgdGhpcywgdGhpcy5jb250YWluZXJzWyBpIF0gKSApO1xuXHRcdFx0fVxuXHRcdFx0aWYodGhpcy5jb250YWluZXJzW2ldLmNvbnRhaW5lckNhY2hlLm92ZXIpIHtcblx0XHRcdFx0ZGVsYXllZFRyaWdnZXJzLnB1c2goIGRlbGF5RXZlbnQoIFwib3V0XCIsIHRoaXMsIHRoaXMuY29udGFpbmVyc1sgaSBdICkgKTtcblx0XHRcdFx0dGhpcy5jb250YWluZXJzW2ldLmNvbnRhaW5lckNhY2hlLm92ZXIgPSAwO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vRG8gd2hhdCB3YXMgb3JpZ2luYWxseSBpbiBwbHVnaW5zXG5cdFx0aWYgKCB0aGlzLnN0b3JlZEN1cnNvciApIHtcblx0XHRcdHRoaXMuZG9jdW1lbnQuZmluZCggXCJib2R5XCIgKS5jc3MoIFwiY3Vyc29yXCIsIHRoaXMuc3RvcmVkQ3Vyc29yICk7XG5cdFx0XHR0aGlzLnN0b3JlZFN0eWxlc2hlZXQucmVtb3ZlKCk7XG5cdFx0fVxuXHRcdGlmKHRoaXMuX3N0b3JlZE9wYWNpdHkpIHtcblx0XHRcdHRoaXMuaGVscGVyLmNzcyhcIm9wYWNpdHlcIiwgdGhpcy5fc3RvcmVkT3BhY2l0eSk7XG5cdFx0fVxuXHRcdGlmKHRoaXMuX3N0b3JlZFpJbmRleCkge1xuXHRcdFx0dGhpcy5oZWxwZXIuY3NzKFwiekluZGV4XCIsIHRoaXMuX3N0b3JlZFpJbmRleCA9PT0gXCJhdXRvXCIgPyBcIlwiIDogdGhpcy5fc3RvcmVkWkluZGV4KTtcblx0XHR9XG5cblx0XHR0aGlzLmRyYWdnaW5nID0gZmFsc2U7XG5cblx0XHRpZighbm9Qcm9wYWdhdGlvbikge1xuXHRcdFx0dGhpcy5fdHJpZ2dlcihcImJlZm9yZVN0b3BcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCgpKTtcblx0XHR9XG5cblx0XHQvLyQodGhpcy5wbGFjZWhvbGRlclswXSkucmVtb3ZlKCk7IHdvdWxkIGhhdmUgYmVlbiB0aGUgalF1ZXJ5IHdheSAtIHVuZm9ydHVuYXRlbHksIGl0IHVuYmluZHMgQUxMIGV2ZW50cyBmcm9tIHRoZSBvcmlnaW5hbCBub2RlIVxuXHRcdHRoaXMucGxhY2Vob2xkZXJbMF0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnBsYWNlaG9sZGVyWzBdKTtcblxuXHRcdGlmICggIXRoaXMuY2FuY2VsSGVscGVyUmVtb3ZhbCApIHtcblx0XHRcdGlmICggdGhpcy5oZWxwZXJbIDAgXSAhPT0gdGhpcy5jdXJyZW50SXRlbVsgMCBdICkge1xuXHRcdFx0XHR0aGlzLmhlbHBlci5yZW1vdmUoKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuaGVscGVyID0gbnVsbDtcblx0XHR9XG5cblx0XHRpZighbm9Qcm9wYWdhdGlvbikge1xuXHRcdFx0Zm9yIChpPTA7IGkgPCBkZWxheWVkVHJpZ2dlcnMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0ZGVsYXllZFRyaWdnZXJzW2ldLmNhbGwodGhpcywgZXZlbnQpO1xuXHRcdFx0fSAvL1RyaWdnZXIgYWxsIGRlbGF5ZWQgZXZlbnRzXG5cdFx0XHR0aGlzLl90cmlnZ2VyKFwic3RvcFwiLCBldmVudCwgdGhpcy5fdWlIYXNoKCkpO1xuXHRcdH1cblxuXHRcdHRoaXMuZnJvbU91dHNpZGUgPSBmYWxzZTtcblx0XHRyZXR1cm4gIXRoaXMuY2FuY2VsSGVscGVyUmVtb3ZhbDtcblxuXHR9LFxuXG5cdF90cmlnZ2VyOiBmdW5jdGlvbigpIHtcblx0XHRpZiAoJC5XaWRnZXQucHJvdG90eXBlLl90cmlnZ2VyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgPT09IGZhbHNlKSB7XG5cdFx0XHR0aGlzLmNhbmNlbCgpO1xuXHRcdH1cblx0fSxcblxuXHRfdWlIYXNoOiBmdW5jdGlvbihfaW5zdCkge1xuXHRcdHZhciBpbnN0ID0gX2luc3QgfHwgdGhpcztcblx0XHRyZXR1cm4ge1xuXHRcdFx0aGVscGVyOiBpbnN0LmhlbHBlcixcblx0XHRcdHBsYWNlaG9sZGVyOiBpbnN0LnBsYWNlaG9sZGVyIHx8ICQoW10pLFxuXHRcdFx0cG9zaXRpb246IGluc3QucG9zaXRpb24sXG5cdFx0XHRvcmlnaW5hbFBvc2l0aW9uOiBpbnN0Lm9yaWdpbmFsUG9zaXRpb24sXG5cdFx0XHRvZmZzZXQ6IGluc3QucG9zaXRpb25BYnMsXG5cdFx0XHRpdGVtOiBpbnN0LmN1cnJlbnRJdGVtLFxuXHRcdFx0c2VuZGVyOiBfaW5zdCA/IF9pbnN0LmVsZW1lbnQgOiBudWxsXG5cdFx0fTtcblx0fVxuXG59KTtcblxuXG5cbn0pKTsiLCIvKiBjYW52YXMtdG9CbG9iLmpzXG4gKiBBIGNhbnZhcy50b0Jsb2IoKSBpbXBsZW1lbnRhdGlvbi5cbiAqIDIwMTMtMTItMjdcbiAqIFxuICogQnkgRWxpIEdyZXksIGh0dHA6Ly9lbGlncmV5LmNvbSBhbmQgRGV2aW4gU2FtYXJpbiwgaHR0cHM6Ly9naXRodWIuY29tL2Vib3lqclxuICogTGljZW5zZTogWDExL01JVFxuICogICBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2VsaWdyZXkvY2FudmFzLXRvQmxvYi5qcy9ibG9iL21hc3Rlci9MSUNFTlNFLm1kXG4gKi9cblxuLypnbG9iYWwgc2VsZiAqL1xuLypqc2xpbnQgYml0d2lzZTogdHJ1ZSwgcmVnZXhwOiB0cnVlLCBjb25mdXNpb246IHRydWUsIGVzNTogdHJ1ZSwgdmFyczogdHJ1ZSwgd2hpdGU6IHRydWUsXG4gIHBsdXNwbHVzOiB0cnVlICovXG5cbi8qISBAc291cmNlIGh0dHA6Ly9wdXJsLmVsaWdyZXkuY29tL2dpdGh1Yi9jYW52YXMtdG9CbG9iLmpzL2Jsb2IvbWFzdGVyL2NhbnZhcy10b0Jsb2IuanMgKi9cblxuKGZ1bmN0aW9uKHZpZXcpIHtcblwidXNlIHN0cmljdFwiO1xudmFyXG5cdCAgVWludDhBcnJheSA9IHZpZXcuVWludDhBcnJheVxuXHQsIEhUTUxDYW52YXNFbGVtZW50ID0gdmlldy5IVE1MQ2FudmFzRWxlbWVudFxuXHQsIGNhbnZhc19wcm90byA9IEhUTUxDYW52YXNFbGVtZW50ICYmIEhUTUxDYW52YXNFbGVtZW50LnByb3RvdHlwZVxuXHQsIGlzX2Jhc2U2NF9yZWdleCA9IC9cXHMqO1xccypiYXNlNjRcXHMqKD86O3wkKS9pXG5cdCwgdG9fZGF0YV91cmwgPSBcInRvRGF0YVVSTFwiXG5cdCwgYmFzZTY0X3JhbmtzXG5cdCwgZGVjb2RlX2Jhc2U2NCA9IGZ1bmN0aW9uKGJhc2U2NCkge1xuXHRcdHZhclxuXHRcdFx0ICBsZW4gPSBiYXNlNjQubGVuZ3RoXG5cdFx0XHQsIGJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KGxlbiAvIDQgKiAzIHwgMClcblx0XHRcdCwgaSA9IDBcblx0XHRcdCwgb3V0cHRyID0gMFxuXHRcdFx0LCBsYXN0ID0gWzAsIDBdXG5cdFx0XHQsIHN0YXRlID0gMFxuXHRcdFx0LCBzYXZlID0gMFxuXHRcdFx0LCByYW5rXG5cdFx0XHQsIGNvZGVcblx0XHRcdCwgdW5kZWZcblx0XHQ7XG5cdFx0d2hpbGUgKGxlbi0tKSB7XG5cdFx0XHRjb2RlID0gYmFzZTY0LmNoYXJDb2RlQXQoaSsrKTtcblx0XHRcdHJhbmsgPSBiYXNlNjRfcmFua3NbY29kZS00M107XG5cdFx0XHRpZiAocmFuayAhPT0gMjU1ICYmIHJhbmsgIT09IHVuZGVmKSB7XG5cdFx0XHRcdGxhc3RbMV0gPSBsYXN0WzBdO1xuXHRcdFx0XHRsYXN0WzBdID0gY29kZTtcblx0XHRcdFx0c2F2ZSA9IChzYXZlIDw8IDYpIHwgcmFuaztcblx0XHRcdFx0c3RhdGUrKztcblx0XHRcdFx0aWYgKHN0YXRlID09PSA0KSB7XG5cdFx0XHRcdFx0YnVmZmVyW291dHB0cisrXSA9IHNhdmUgPj4+IDE2O1xuXHRcdFx0XHRcdGlmIChsYXN0WzFdICE9PSA2MSAvKiBwYWRkaW5nIGNoYXJhY3RlciAqLykge1xuXHRcdFx0XHRcdFx0YnVmZmVyW291dHB0cisrXSA9IHNhdmUgPj4+IDg7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmIChsYXN0WzBdICE9PSA2MSAvKiBwYWRkaW5nIGNoYXJhY3RlciAqLykge1xuXHRcdFx0XHRcdFx0YnVmZmVyW291dHB0cisrXSA9IHNhdmU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHN0YXRlID0gMDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHQvLyAyLzMgY2hhbmNlIHRoZXJlJ3MgZ29pbmcgdG8gYmUgc29tZSBudWxsIGJ5dGVzIGF0IHRoZSBlbmQsIGJ1dCB0aGF0XG5cdFx0Ly8gZG9lc24ndCByZWFsbHkgbWF0dGVyIHdpdGggbW9zdCBpbWFnZSBmb3JtYXRzLlxuXHRcdC8vIElmIGl0IHNvbWVob3cgbWF0dGVycyBmb3IgeW91LCB0cnVuY2F0ZSB0aGUgYnVmZmVyIHVwIG91dHB0ci5cblx0XHRyZXR1cm4gYnVmZmVyO1xuXHR9XG47XG5pZiAoVWludDhBcnJheSkge1xuXHRiYXNlNjRfcmFua3MgPSBuZXcgVWludDhBcnJheShbXG5cdFx0ICA2MiwgLTEsIC0xLCAtMSwgNjMsIDUyLCA1MywgNTQsIDU1LCA1NiwgNTcsIDU4LCA1OSwgNjAsIDYxLCAtMVxuXHRcdCwgLTEsIC0xLCAgMCwgLTEsIC0xLCAtMSwgIDAsICAxLCAgMiwgIDMsICA0LCAgNSwgIDYsICA3LCAgOCwgIDlcblx0XHQsIDEwLCAxMSwgMTIsIDEzLCAxNCwgMTUsIDE2LCAxNywgMTgsIDE5LCAyMCwgMjEsIDIyLCAyMywgMjQsIDI1XG5cdFx0LCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAyNiwgMjcsIDI4LCAyOSwgMzAsIDMxLCAzMiwgMzMsIDM0LCAzNVxuXHRcdCwgMzYsIDM3LCAzOCwgMzksIDQwLCA0MSwgNDIsIDQzLCA0NCwgNDUsIDQ2LCA0NywgNDgsIDQ5LCA1MCwgNTFcblx0XSk7XG59XG5pZiAoSFRNTENhbnZhc0VsZW1lbnQgJiYgIWNhbnZhc19wcm90by50b0Jsb2IpIHtcblx0Y2FudmFzX3Byb3RvLnRvQmxvYiA9IGZ1bmN0aW9uKGNhbGxiYWNrLCB0eXBlIC8qLCAuLi5hcmdzKi8pIHtcblx0XHQgIGlmICghdHlwZSkge1xuXHRcdFx0dHlwZSA9IFwiaW1hZ2UvcG5nXCI7XG5cdFx0fSBpZiAodGhpcy5tb3pHZXRBc0ZpbGUpIHtcblx0XHRcdGNhbGxiYWNrKHRoaXMubW96R2V0QXNGaWxlKFwiY2FudmFzXCIsIHR5cGUpKTtcblx0XHRcdHJldHVybjtcblx0XHR9IGlmICh0aGlzLm1zVG9CbG9iICYmIC9eXFxzKmltYWdlXFwvcG5nXFxzKig/OiR8OykvaS50ZXN0KHR5cGUpKSB7XG5cdFx0XHRjYWxsYmFjayh0aGlzLm1zVG9CbG9iKCkpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHZhclxuXHRcdFx0ICBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKVxuXHRcdFx0LCBkYXRhVVJJID0gdGhpc1t0b19kYXRhX3VybF0uYXBwbHkodGhpcywgYXJncylcblx0XHRcdCwgaGVhZGVyX2VuZCA9IGRhdGFVUkkuaW5kZXhPZihcIixcIilcblx0XHRcdCwgZGF0YSA9IGRhdGFVUkkuc3Vic3RyaW5nKGhlYWRlcl9lbmQgKyAxKVxuXHRcdFx0LCBpc19iYXNlNjQgPSBpc19iYXNlNjRfcmVnZXgudGVzdChkYXRhVVJJLnN1YnN0cmluZygwLCBoZWFkZXJfZW5kKSlcblx0XHRcdCwgYmxvYlxuXHRcdDtcblx0XHRpZiAoQmxvYi5mYWtlKSB7XG5cdFx0XHQvLyBubyByZWFzb24gdG8gZGVjb2RlIGEgZGF0YTogVVJJIHRoYXQncyBqdXN0IGdvaW5nIHRvIGJlY29tZSBhIGRhdGEgVVJJIGFnYWluXG5cdFx0XHRibG9iID0gbmV3IEJsb2Jcblx0XHRcdGlmIChpc19iYXNlNjQpIHtcblx0XHRcdFx0YmxvYi5lbmNvZGluZyA9IFwiYmFzZTY0XCI7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRibG9iLmVuY29kaW5nID0gXCJVUklcIjtcblx0XHRcdH1cblx0XHRcdGJsb2IuZGF0YSA9IGRhdGE7XG5cdFx0XHRibG9iLnNpemUgPSBkYXRhLmxlbmd0aDtcblx0XHR9IGVsc2UgaWYgKFVpbnQ4QXJyYXkpIHtcblx0XHRcdGlmIChpc19iYXNlNjQpIHtcblx0XHRcdFx0YmxvYiA9IG5ldyBCbG9iKFtkZWNvZGVfYmFzZTY0KGRhdGEpXSwge3R5cGU6IHR5cGV9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGJsb2IgPSBuZXcgQmxvYihbZGVjb2RlVVJJQ29tcG9uZW50KGRhdGEpXSwge3R5cGU6IHR5cGV9KTtcblx0XHRcdH1cblx0XHR9XG5cdFx0Y2FsbGJhY2soYmxvYik7XG5cdH07XG5cblx0aWYgKGNhbnZhc19wcm90by50b0RhdGFVUkxIRCkge1xuXHRcdGNhbnZhc19wcm90by50b0Jsb2JIRCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0dG9fZGF0YV91cmwgPSBcInRvRGF0YVVSTEhEXCI7XG5cdFx0XHR2YXIgYmxvYiA9IHRoaXMudG9CbG9iKCk7XG5cdFx0XHR0b19kYXRhX3VybCA9IFwidG9EYXRhVVJMXCI7XG5cdFx0XHRyZXR1cm4gYmxvYjtcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0Y2FudmFzX3Byb3RvLnRvQmxvYkhEID0gY2FudmFzX3Byb3RvLnRvQmxvYjtcblx0fVxufVxufSh0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiAmJiBzZWxmIHx8IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgJiYgd2luZG93IHx8IHRoaXMuY29udGVudCB8fCB0aGlzKSk7XG5cbi8qIEZpbGVTYXZlci5qc1xuICogQSBzYXZlQXMoKSBGaWxlU2F2ZXIgaW1wbGVtZW50YXRpb24uXG4gKiAyMDE1LTAzLTA0XG4gKlxuICogQnkgRWxpIEdyZXksIGh0dHA6Ly9lbGlncmV5LmNvbVxuICogTGljZW5zZTogWDExL01JVFxuICogICBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2VsaWdyZXkvRmlsZVNhdmVyLmpzL2Jsb2IvbWFzdGVyL0xJQ0VOU0UubWRcbiAqL1xuXG4vKmdsb2JhbCBzZWxmICovXG4vKmpzbGludCBiaXR3aXNlOiB0cnVlLCBpbmRlbnQ6IDQsIGxheGJyZWFrOiB0cnVlLCBsYXhjb21tYTogdHJ1ZSwgc21hcnR0YWJzOiB0cnVlLCBwbHVzcGx1czogdHJ1ZSAqL1xuXG4vKiEgQHNvdXJjZSBodHRwOi8vcHVybC5lbGlncmV5LmNvbS9naXRodWIvRmlsZVNhdmVyLmpzL2Jsb2IvbWFzdGVyL0ZpbGVTYXZlci5qcyAqL1xuXG52YXIgc2F2ZUFzID0gc2F2ZUFzXG4gIC8vIElFIDEwKyAobmF0aXZlIHNhdmVBcylcbiAgfHwgKHR5cGVvZiBuYXZpZ2F0b3IgIT09IFwidW5kZWZpbmVkXCIgJiZcbiAgICAgIG5hdmlnYXRvci5tc1NhdmVPck9wZW5CbG9iICYmIG5hdmlnYXRvci5tc1NhdmVPck9wZW5CbG9iLmJpbmQobmF2aWdhdG9yKSlcbiAgLy8gRXZlcnlvbmUgZWxzZVxuICB8fCAoZnVuY3Rpb24odmlldykge1xuXHRcInVzZSBzdHJpY3RcIjtcblx0Ly8gSUUgPDEwIGlzIGV4cGxpY2l0bHkgdW5zdXBwb3J0ZWRcblx0aWYgKHR5cGVvZiBuYXZpZ2F0b3IgIT09IFwidW5kZWZpbmVkXCIgJiZcblx0ICAgIC9NU0lFIFsxLTldXFwuLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKSB7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdHZhclxuXHRcdCAgZG9jID0gdmlldy5kb2N1bWVudFxuXHRcdCAgLy8gb25seSBnZXQgVVJMIHdoZW4gbmVjZXNzYXJ5IGluIGNhc2UgQmxvYi5qcyBoYXNuJ3Qgb3ZlcnJpZGRlbiBpdCB5ZXRcblx0XHQsIGdldF9VUkwgPSBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB2aWV3LlVSTCB8fCB2aWV3LndlYmtpdFVSTCB8fCB2aWV3O1xuXHRcdH1cblx0XHQsIHNhdmVfbGluayA9IGRvYy5jcmVhdGVFbGVtZW50TlMoXCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sXCIsIFwiYVwiKVxuXHRcdCwgY2FuX3VzZV9zYXZlX2xpbmsgPSBcImRvd25sb2FkXCIgaW4gc2F2ZV9saW5rXG5cdFx0LCBjbGljayA9IGZ1bmN0aW9uKG5vZGUpIHtcblx0XHRcdHZhciBldmVudCA9IGRvYy5jcmVhdGVFdmVudChcIk1vdXNlRXZlbnRzXCIpO1xuXHRcdFx0ZXZlbnQuaW5pdE1vdXNlRXZlbnQoXG5cdFx0XHRcdFwiY2xpY2tcIiwgdHJ1ZSwgZmFsc2UsIHZpZXcsIDAsIDAsIDAsIDAsIDBcblx0XHRcdFx0LCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgMCwgbnVsbFxuXHRcdFx0KTtcblx0XHRcdG5vZGUuZGlzcGF0Y2hFdmVudChldmVudCk7XG5cdFx0fVxuXHRcdCwgd2Via2l0X3JlcV9mcyA9IHZpZXcud2Via2l0UmVxdWVzdEZpbGVTeXN0ZW1cblx0XHQsIHJlcV9mcyA9IHZpZXcucmVxdWVzdEZpbGVTeXN0ZW0gfHwgd2Via2l0X3JlcV9mcyB8fCB2aWV3Lm1velJlcXVlc3RGaWxlU3lzdGVtXG5cdFx0LCB0aHJvd19vdXRzaWRlID0gZnVuY3Rpb24oZXgpIHtcblx0XHRcdCh2aWV3LnNldEltbWVkaWF0ZSB8fCB2aWV3LnNldFRpbWVvdXQpKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aHJvdyBleDtcblx0XHRcdH0sIDApO1xuXHRcdH1cblx0XHQsIGZvcmNlX3NhdmVhYmxlX3R5cGUgPSBcImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbVwiXG5cdFx0LCBmc19taW5fc2l6ZSA9IDBcblx0XHQvLyBTZWUgaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTM3NTI5NyNjNyBhbmRcblx0XHQvLyBodHRwczovL2dpdGh1Yi5jb20vZWxpZ3JleS9GaWxlU2F2ZXIuanMvY29tbWl0LzQ4NTkzMGEjY29tbWl0Y29tbWVudC04NzY4MDQ3XG5cdFx0Ly8gZm9yIHRoZSByZWFzb25pbmcgYmVoaW5kIHRoZSB0aW1lb3V0IGFuZCByZXZvY2F0aW9uIGZsb3dcblx0XHQsIGFyYml0cmFyeV9yZXZva2VfdGltZW91dCA9IDUwMCAvLyBpbiBtc1xuXHRcdCwgcmV2b2tlID0gZnVuY3Rpb24oZmlsZSkge1xuXHRcdFx0dmFyIHJldm9rZXIgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKHR5cGVvZiBmaWxlID09PSBcInN0cmluZ1wiKSB7IC8vIGZpbGUgaXMgYW4gb2JqZWN0IFVSTFxuXHRcdFx0XHRcdGdldF9VUkwoKS5yZXZva2VPYmplY3RVUkwoZmlsZSk7XG5cdFx0XHRcdH0gZWxzZSB7IC8vIGZpbGUgaXMgYSBGaWxlXG5cdFx0XHRcdFx0ZmlsZS5yZW1vdmUoKTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHRcdGlmICh2aWV3LmNocm9tZSkge1xuXHRcdFx0XHRyZXZva2VyKCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzZXRUaW1lb3V0KHJldm9rZXIsIGFyYml0cmFyeV9yZXZva2VfdGltZW91dCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdCwgZGlzcGF0Y2ggPSBmdW5jdGlvbihmaWxlc2F2ZXIsIGV2ZW50X3R5cGVzLCBldmVudCkge1xuXHRcdFx0ZXZlbnRfdHlwZXMgPSBbXS5jb25jYXQoZXZlbnRfdHlwZXMpO1xuXHRcdFx0dmFyIGkgPSBldmVudF90eXBlcy5sZW5ndGg7XG5cdFx0XHR3aGlsZSAoaS0tKSB7XG5cdFx0XHRcdHZhciBsaXN0ZW5lciA9IGZpbGVzYXZlcltcIm9uXCIgKyBldmVudF90eXBlc1tpXV07XG5cdFx0XHRcdGlmICh0eXBlb2YgbGlzdGVuZXIgPT09IFwiZnVuY3Rpb25cIikge1xuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRsaXN0ZW5lci5jYWxsKGZpbGVzYXZlciwgZXZlbnQgfHwgZmlsZXNhdmVyKTtcblx0XHRcdFx0XHR9IGNhdGNoIChleCkge1xuXHRcdFx0XHRcdFx0dGhyb3dfb3V0c2lkZShleCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdCwgRmlsZVNhdmVyID0gZnVuY3Rpb24oYmxvYiwgbmFtZSkge1xuXHRcdFx0Ly8gRmlyc3QgdHJ5IGEuZG93bmxvYWQsIHRoZW4gd2ViIGZpbGVzeXN0ZW0sIHRoZW4gb2JqZWN0IFVSTHNcblx0XHRcdHZhclxuXHRcdFx0XHQgIGZpbGVzYXZlciA9IHRoaXNcblx0XHRcdFx0LCB0eXBlID0gYmxvYi50eXBlXG5cdFx0XHRcdCwgYmxvYl9jaGFuZ2VkID0gZmFsc2Vcblx0XHRcdFx0LCBvYmplY3RfdXJsXG5cdFx0XHRcdCwgdGFyZ2V0X3ZpZXdcblx0XHRcdFx0LCBkaXNwYXRjaF9hbGwgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRkaXNwYXRjaChmaWxlc2F2ZXIsIFwid3JpdGVzdGFydCBwcm9ncmVzcyB3cml0ZSB3cml0ZWVuZFwiLnNwbGl0KFwiIFwiKSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gb24gYW55IGZpbGVzeXMgZXJyb3JzIHJldmVydCB0byBzYXZpbmcgd2l0aCBvYmplY3QgVVJMc1xuXHRcdFx0XHQsIGZzX2Vycm9yID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Ly8gZG9uJ3QgY3JlYXRlIG1vcmUgb2JqZWN0IFVSTHMgdGhhbiBuZWVkZWRcblx0XHRcdFx0XHRpZiAoYmxvYl9jaGFuZ2VkIHx8ICFvYmplY3RfdXJsKSB7XG5cdFx0XHRcdFx0XHRvYmplY3RfdXJsID0gZ2V0X1VSTCgpLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKHRhcmdldF92aWV3KSB7XG5cdFx0XHRcdFx0XHR0YXJnZXRfdmlldy5sb2NhdGlvbi5ocmVmID0gb2JqZWN0X3VybDtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0dmFyIG5ld190YWIgPSB2aWV3Lm9wZW4ob2JqZWN0X3VybCwgXCJfYmxhbmtcIik7XG5cdFx0XHRcdFx0XHRpZiAobmV3X3RhYiA9PSB1bmRlZmluZWQgJiYgdHlwZW9mIHNhZmFyaSAhPT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0XHRcdFx0XHQvL0FwcGxlIGRvIG5vdCBhbGxvdyB3aW5kb3cub3Blbiwgc2VlIGh0dHA6Ly9iaXQubHkvMWtaZmZSSVxuXHRcdFx0XHRcdFx0XHR2aWV3LmxvY2F0aW9uLmhyZWYgPSBvYmplY3RfdXJsXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGZpbGVzYXZlci5yZWFkeVN0YXRlID0gZmlsZXNhdmVyLkRPTkU7XG5cdFx0XHRcdFx0ZGlzcGF0Y2hfYWxsKCk7XG5cdFx0XHRcdFx0cmV2b2tlKG9iamVjdF91cmwpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdCwgYWJvcnRhYmxlID0gZnVuY3Rpb24oZnVuYykge1xuXHRcdFx0XHRcdHJldHVybiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdGlmIChmaWxlc2F2ZXIucmVhZHlTdGF0ZSAhPT0gZmlsZXNhdmVyLkRPTkUpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGZ1bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9XG5cdFx0XHRcdCwgY3JlYXRlX2lmX25vdF9mb3VuZCA9IHtjcmVhdGU6IHRydWUsIGV4Y2x1c2l2ZTogZmFsc2V9XG5cdFx0XHRcdCwgc2xpY2Vcblx0XHRcdDtcblx0XHRcdGZpbGVzYXZlci5yZWFkeVN0YXRlID0gZmlsZXNhdmVyLklOSVQ7XG5cdFx0XHRpZiAoIW5hbWUpIHtcblx0XHRcdFx0bmFtZSA9IFwiZG93bmxvYWRcIjtcblx0XHRcdH1cblx0XHRcdGlmIChjYW5fdXNlX3NhdmVfbGluaykge1xuXHRcdFx0XHRvYmplY3RfdXJsID0gZ2V0X1VSTCgpLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcblx0XHRcdFx0c2F2ZV9saW5rLmhyZWYgPSBvYmplY3RfdXJsO1xuXHRcdFx0XHRzYXZlX2xpbmsuZG93bmxvYWQgPSBuYW1lO1xuXHRcdFx0XHRjbGljayhzYXZlX2xpbmspO1xuXHRcdFx0XHRmaWxlc2F2ZXIucmVhZHlTdGF0ZSA9IGZpbGVzYXZlci5ET05FO1xuXHRcdFx0XHRkaXNwYXRjaF9hbGwoKTtcblx0XHRcdFx0cmV2b2tlKG9iamVjdF91cmwpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHQvLyBwcmVwZW5kIEJPTSBmb3IgVVRGLTggWE1MIGFuZCB0ZXh0L3BsYWluIHR5cGVzXG5cdFx0XHRpZiAoL15cXHMqKD86dGV4dFxcLyg/OnBsYWlufHhtbCl8YXBwbGljYXRpb25cXC94bWx8XFxTKlxcL1xcUypcXCt4bWwpXFxzKjsuKmNoYXJzZXRcXHMqPVxccyp1dGYtOC9pLnRlc3QoYmxvYi50eXBlKSkge1xuXHRcdFx0XHRibG9iID0gbmV3IEJsb2IoW1wiXFx1ZmVmZlwiLCBibG9iXSwge3R5cGU6IGJsb2IudHlwZX0pO1xuXHRcdFx0fVxuXHRcdFx0Ly8gT2JqZWN0IGFuZCB3ZWIgZmlsZXN5c3RlbSBVUkxzIGhhdmUgYSBwcm9ibGVtIHNhdmluZyBpbiBHb29nbGUgQ2hyb21lIHdoZW5cblx0XHRcdC8vIHZpZXdlZCBpbiBhIHRhYiwgc28gSSBmb3JjZSBzYXZlIHdpdGggYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtXG5cdFx0XHQvLyBodHRwOi8vY29kZS5nb29nbGUuY29tL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD05MTE1OFxuXHRcdFx0Ly8gVXBkYXRlOiBHb29nbGUgZXJyYW50bHkgY2xvc2VkIDkxMTU4LCBJIHN1Ym1pdHRlZCBpdCBhZ2Fpbjpcblx0XHRcdC8vIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD0zODk2NDJcblx0XHRcdGlmICh2aWV3LmNocm9tZSAmJiB0eXBlICYmIHR5cGUgIT09IGZvcmNlX3NhdmVhYmxlX3R5cGUpIHtcblx0XHRcdFx0c2xpY2UgPSBibG9iLnNsaWNlIHx8IGJsb2Iud2Via2l0U2xpY2U7XG5cdFx0XHRcdGJsb2IgPSBzbGljZS5jYWxsKGJsb2IsIDAsIGJsb2Iuc2l6ZSwgZm9yY2Vfc2F2ZWFibGVfdHlwZSk7XG5cdFx0XHRcdGJsb2JfY2hhbmdlZCA9IHRydWU7XG5cdFx0XHR9XG5cdFx0XHQvLyBTaW5jZSBJIGNhbid0IGJlIHN1cmUgdGhhdCB0aGUgZ3Vlc3NlZCBtZWRpYSB0eXBlIHdpbGwgdHJpZ2dlciBhIGRvd25sb2FkXG5cdFx0XHQvLyBpbiBXZWJLaXQsIEkgYXBwZW5kIC5kb3dubG9hZCB0byB0aGUgZmlsZW5hbWUuXG5cdFx0XHQvLyBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9NjU0NDBcblx0XHRcdGlmICh3ZWJraXRfcmVxX2ZzICYmIG5hbWUgIT09IFwiZG93bmxvYWRcIikge1xuXHRcdFx0XHRuYW1lICs9IFwiLmRvd25sb2FkXCI7XG5cdFx0XHR9XG5cdFx0XHRpZiAodHlwZSA9PT0gZm9yY2Vfc2F2ZWFibGVfdHlwZSB8fCB3ZWJraXRfcmVxX2ZzKSB7XG5cdFx0XHRcdHRhcmdldF92aWV3ID0gdmlldztcblx0XHRcdH1cblx0XHRcdGlmICghcmVxX2ZzKSB7XG5cdFx0XHRcdGZzX2Vycm9yKCk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdGZzX21pbl9zaXplICs9IGJsb2Iuc2l6ZTtcblx0XHRcdHJlcV9mcyh2aWV3LlRFTVBPUkFSWSwgZnNfbWluX3NpemUsIGFib3J0YWJsZShmdW5jdGlvbihmcykge1xuXHRcdFx0XHRmcy5yb290LmdldERpcmVjdG9yeShcInNhdmVkXCIsIGNyZWF0ZV9pZl9ub3RfZm91bmQsIGFib3J0YWJsZShmdW5jdGlvbihkaXIpIHtcblx0XHRcdFx0XHR2YXIgc2F2ZSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0ZGlyLmdldEZpbGUobmFtZSwgY3JlYXRlX2lmX25vdF9mb3VuZCwgYWJvcnRhYmxlKGZ1bmN0aW9uKGZpbGUpIHtcblx0XHRcdFx0XHRcdFx0ZmlsZS5jcmVhdGVXcml0ZXIoYWJvcnRhYmxlKGZ1bmN0aW9uKHdyaXRlcikge1xuXHRcdFx0XHRcdFx0XHRcdHdyaXRlci5vbndyaXRlZW5kID0gZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRhcmdldF92aWV3LmxvY2F0aW9uLmhyZWYgPSBmaWxlLnRvVVJMKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRmaWxlc2F2ZXIucmVhZHlTdGF0ZSA9IGZpbGVzYXZlci5ET05FO1xuXHRcdFx0XHRcdFx0XHRcdFx0ZGlzcGF0Y2goZmlsZXNhdmVyLCBcIndyaXRlZW5kXCIsIGV2ZW50KTtcblx0XHRcdFx0XHRcdFx0XHRcdHJldm9rZShmaWxlKTtcblx0XHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0XHRcdHdyaXRlci5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgZXJyb3IgPSB3cml0ZXIuZXJyb3I7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoZXJyb3IuY29kZSAhPT0gZXJyb3IuQUJPUlRfRVJSKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGZzX2Vycm9yKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdFx0XHRcIndyaXRlc3RhcnQgcHJvZ3Jlc3Mgd3JpdGUgYWJvcnRcIi5zcGxpdChcIiBcIikuZm9yRWFjaChmdW5jdGlvbihldmVudCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0d3JpdGVyW1wib25cIiArIGV2ZW50XSA9IGZpbGVzYXZlcltcIm9uXCIgKyBldmVudF07XG5cdFx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdFx0d3JpdGVyLndyaXRlKGJsb2IpO1xuXHRcdFx0XHRcdFx0XHRcdGZpbGVzYXZlci5hYm9ydCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0d3JpdGVyLmFib3J0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRmaWxlc2F2ZXIucmVhZHlTdGF0ZSA9IGZpbGVzYXZlci5ET05FO1xuXHRcdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRcdFx0ZmlsZXNhdmVyLnJlYWR5U3RhdGUgPSBmaWxlc2F2ZXIuV1JJVElORztcblx0XHRcdFx0XHRcdFx0fSksIGZzX2Vycm9yKTtcblx0XHRcdFx0XHRcdH0pLCBmc19lcnJvcik7XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRkaXIuZ2V0RmlsZShuYW1lLCB7Y3JlYXRlOiBmYWxzZX0sIGFib3J0YWJsZShmdW5jdGlvbihmaWxlKSB7XG5cdFx0XHRcdFx0XHQvLyBkZWxldGUgZmlsZSBpZiBpdCBhbHJlYWR5IGV4aXN0c1xuXHRcdFx0XHRcdFx0ZmlsZS5yZW1vdmUoKTtcblx0XHRcdFx0XHRcdHNhdmUoKTtcblx0XHRcdFx0XHR9KSwgYWJvcnRhYmxlKGZ1bmN0aW9uKGV4KSB7XG5cdFx0XHRcdFx0XHRpZiAoZXguY29kZSA9PT0gZXguTk9UX0ZPVU5EX0VSUikge1xuXHRcdFx0XHRcdFx0XHRzYXZlKCk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRmc19lcnJvcigpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pKTtcblx0XHRcdFx0fSksIGZzX2Vycm9yKTtcblx0XHRcdH0pLCBmc19lcnJvcik7XG5cdFx0fVxuXHRcdCwgRlNfcHJvdG8gPSBGaWxlU2F2ZXIucHJvdG90eXBlXG5cdFx0LCBzYXZlQXMgPSBmdW5jdGlvbihibG9iLCBuYW1lKSB7XG5cdFx0XHRyZXR1cm4gbmV3IEZpbGVTYXZlcihibG9iLCBuYW1lKTtcblx0XHR9XG5cdDtcblx0RlNfcHJvdG8uYWJvcnQgPSBmdW5jdGlvbigpIHtcblx0XHR2YXIgZmlsZXNhdmVyID0gdGhpcztcblx0XHRmaWxlc2F2ZXIucmVhZHlTdGF0ZSA9IGZpbGVzYXZlci5ET05FO1xuXHRcdGRpc3BhdGNoKGZpbGVzYXZlciwgXCJhYm9ydFwiKTtcblx0fTtcblx0RlNfcHJvdG8ucmVhZHlTdGF0ZSA9IEZTX3Byb3RvLklOSVQgPSAwO1xuXHRGU19wcm90by5XUklUSU5HID0gMTtcblx0RlNfcHJvdG8uRE9ORSA9IDI7XG5cblx0RlNfcHJvdG8uZXJyb3IgPVxuXHRGU19wcm90by5vbndyaXRlc3RhcnQgPVxuXHRGU19wcm90by5vbnByb2dyZXNzID1cblx0RlNfcHJvdG8ub253cml0ZSA9XG5cdEZTX3Byb3RvLm9uYWJvcnQgPVxuXHRGU19wcm90by5vbmVycm9yID1cblx0RlNfcHJvdG8ub253cml0ZWVuZCA9XG5cdFx0bnVsbDtcblxuXHRyZXR1cm4gc2F2ZUFzO1xufShcblx0ICAgdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgJiYgc2VsZlxuXHR8fCB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiICYmIHdpbmRvd1xuXHR8fCB0aGlzLmNvbnRlbnRcbikpO1xuLy8gYHNlbGZgIGlzIHVuZGVmaW5lZCBpbiBGaXJlZm94IGZvciBBbmRyb2lkIGNvbnRlbnQgc2NyaXB0IGNvbnRleHRcbi8vIHdoaWxlIGB0aGlzYCBpcyBuc0lDb250ZW50RnJhbWVNZXNzYWdlTWFuYWdlclxuLy8gd2l0aCBhbiBhdHRyaWJ1dGUgYGNvbnRlbnRgIHRoYXQgY29ycmVzcG9uZHMgdG8gdGhlIHdpbmRvd1xuXG5pZiAodHlwZW9mIG1vZHVsZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBtb2R1bGUuZXhwb3J0cykge1xuICBtb2R1bGUuZXhwb3J0cy5zYXZlQXMgPSBzYXZlQXM7XG59IGVsc2UgaWYgKCh0eXBlb2YgZGVmaW5lICE9PSBcInVuZGVmaW5lZFwiICYmIGRlZmluZSAhPT0gbnVsbCkgJiYgKGRlZmluZS5hbWQgIT0gbnVsbCkpIHtcbiAgZGVmaW5lKFtdLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gc2F2ZUFzO1xuICB9KTtcbn1cbiIsIi8qKlxuKiBzaW1wbGVQYWdpbmF0aW9uLmpzIHYxLjZcbiogQSBzaW1wbGUgalF1ZXJ5IHBhZ2luYXRpb24gcGx1Z2luLlxuKiBodHRwOi8vZmxhdml1c21hdGlzLmdpdGh1Yi5jb20vc2ltcGxlUGFnaW5hdGlvbi5qcy9cbipcbiogQ29weXJpZ2h0IDIwMTIsIEZsYXZpdXMgTWF0aXNcbiogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuKiBodHRwOi8vZmxhdml1c21hdGlzLmdpdGh1Yi5jb20vbGljZW5zZS5odG1sXG4qL1xuXG4oZnVuY3Rpb24oJCl7XG5cblx0dmFyIG1ldGhvZHMgPSB7XG5cdFx0aW5pdDogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdFx0dmFyIG8gPSAkLmV4dGVuZCh7XG5cdFx0XHRcdGl0ZW1zOiAxLFxuXHRcdFx0XHRpdGVtc09uUGFnZTogMSxcblx0XHRcdFx0cGFnZXM6IDAsXG5cdFx0XHRcdGRpc3BsYXllZFBhZ2VzOiA1LFxuXHRcdFx0XHRlZGdlczogMixcblx0XHRcdFx0Y3VycmVudFBhZ2U6IDAsXG5cdFx0XHRcdGhyZWZUZXh0UHJlZml4OiAnI3BhZ2UtJyxcblx0XHRcdFx0aHJlZlRleHRTdWZmaXg6ICcnLFxuXHRcdFx0XHRwcmV2VGV4dDogJ1ByZXYnLFxuXHRcdFx0XHRuZXh0VGV4dDogJ05leHQnLFxuXHRcdFx0XHRlbGxpcHNlVGV4dDogJyZoZWxsaXA7Jyxcblx0XHRcdFx0Y3NzU3R5bGU6ICdsaWdodC10aGVtZScsXG5cdFx0XHRcdGxhYmVsTWFwOiBbXSxcblx0XHRcdFx0c2VsZWN0T25DbGljazogdHJ1ZSxcblx0XHRcdFx0bmV4dEF0RnJvbnQ6IGZhbHNlLFxuXHRcdFx0XHRpbnZlcnRQYWdlT3JkZXI6IGZhbHNlLFxuXHRcdFx0XHRvblBhZ2VDbGljazogZnVuY3Rpb24ocGFnZU51bWJlciwgZXZlbnQpIHtcblx0XHRcdFx0XHQvLyBDYWxsYmFjayB0cmlnZ2VyZWQgd2hlbiBhIHBhZ2UgaXMgY2xpY2tlZFxuXHRcdFx0XHRcdC8vIFBhZ2UgbnVtYmVyIGlzIGdpdmVuIGFzIGFuIG9wdGlvbmFsIHBhcmFtZXRlclxuXHRcdFx0XHR9LFxuXHRcdFx0XHRvbkluaXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdC8vIENhbGxiYWNrIHRyaWdnZXJlZCBpbW1lZGlhdGVseSBhZnRlciBpbml0aWFsaXphdGlvblxuXHRcdFx0XHR9XG5cdFx0XHR9LCBvcHRpb25zIHx8IHt9KTtcblxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHRvLnBhZ2VzID0gby5wYWdlcyA/IG8ucGFnZXMgOiBNYXRoLmNlaWwoby5pdGVtcyAvIG8uaXRlbXNPblBhZ2UpID8gTWF0aC5jZWlsKG8uaXRlbXMgLyBvLml0ZW1zT25QYWdlKSA6IDE7XG5cdFx0XHRpZiAoby5jdXJyZW50UGFnZSlcblx0XHRcdFx0by5jdXJyZW50UGFnZSA9IG8uY3VycmVudFBhZ2UgLSAxO1xuXHRcdFx0ZWxzZVxuXHRcdFx0XHRvLmN1cnJlbnRQYWdlID0gIW8uaW52ZXJ0UGFnZU9yZGVyID8gMCA6IG8ucGFnZXMgLSAxO1xuXHRcdFx0by5oYWxmRGlzcGxheWVkID0gby5kaXNwbGF5ZWRQYWdlcyAvIDI7XG5cblx0XHRcdHRoaXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdFx0c2VsZi5hZGRDbGFzcyhvLmNzc1N0eWxlICsgJyBzaW1wbGUtcGFnaW5hdGlvbicpLmRhdGEoJ3BhZ2luYXRpb24nLCBvKTtcblx0XHRcdFx0bWV0aG9kcy5fZHJhdy5jYWxsKHNlbGYpO1xuXHRcdFx0fSk7XG5cblx0XHRcdG8ub25Jbml0KCk7XG5cblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH0sXG5cblx0XHRzZWxlY3RQYWdlOiBmdW5jdGlvbihwYWdlKSB7XG5cdFx0XHRtZXRob2RzLl9zZWxlY3RQYWdlLmNhbGwodGhpcywgcGFnZSAtIDEpO1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fSxcblxuXHRcdHByZXZQYWdlOiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBvID0gdGhpcy5kYXRhKCdwYWdpbmF0aW9uJyk7XG5cdFx0XHRpZiAoIW8uaW52ZXJ0UGFnZU9yZGVyKSB7XG5cdFx0XHRcdGlmIChvLmN1cnJlbnRQYWdlID4gMCkge1xuXHRcdFx0XHRcdG1ldGhvZHMuX3NlbGVjdFBhZ2UuY2FsbCh0aGlzLCBvLmN1cnJlbnRQYWdlIC0gMSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmIChvLmN1cnJlbnRQYWdlIDwgby5wYWdlcyAtIDEpIHtcblx0XHRcdFx0XHRtZXRob2RzLl9zZWxlY3RQYWdlLmNhbGwodGhpcywgby5jdXJyZW50UGFnZSArIDEpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXG5cdFx0bmV4dFBhZ2U6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIG8gPSB0aGlzLmRhdGEoJ3BhZ2luYXRpb24nKTtcblx0XHRcdGlmICghby5pbnZlcnRQYWdlT3JkZXIpIHtcblx0XHRcdFx0aWYgKG8uY3VycmVudFBhZ2UgPCBvLnBhZ2VzIC0gMSkge1xuXHRcdFx0XHRcdG1ldGhvZHMuX3NlbGVjdFBhZ2UuY2FsbCh0aGlzLCBvLmN1cnJlbnRQYWdlICsgMSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmIChvLmN1cnJlbnRQYWdlID4gMCkge1xuXHRcdFx0XHRcdG1ldGhvZHMuX3NlbGVjdFBhZ2UuY2FsbCh0aGlzLCBvLmN1cnJlbnRQYWdlIC0gMSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH0sXG5cblx0XHRnZXRQYWdlc0NvdW50OiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB0aGlzLmRhdGEoJ3BhZ2luYXRpb24nKS5wYWdlcztcblx0XHR9LFxuXG5cdFx0Z2V0Q3VycmVudFBhZ2U6IGZ1bmN0aW9uICgpIHtcblx0XHRcdHJldHVybiB0aGlzLmRhdGEoJ3BhZ2luYXRpb24nKS5jdXJyZW50UGFnZSArIDE7XG5cdFx0fSxcblxuXHRcdGRlc3Ryb3k6IGZ1bmN0aW9uKCl7XG5cdFx0XHR0aGlzLmVtcHR5KCk7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXG5cdFx0ZHJhd1BhZ2U6IGZ1bmN0aW9uIChwYWdlKSB7XG5cdFx0XHR2YXIgbyA9IHRoaXMuZGF0YSgncGFnaW5hdGlvbicpO1xuXHRcdFx0by5jdXJyZW50UGFnZSA9IHBhZ2UgLSAxO1xuXHRcdFx0dGhpcy5kYXRhKCdwYWdpbmF0aW9uJywgbyk7XG5cdFx0XHRtZXRob2RzLl9kcmF3LmNhbGwodGhpcyk7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXG5cdFx0cmVkcmF3OiBmdW5jdGlvbigpe1xuXHRcdFx0bWV0aG9kcy5fZHJhdy5jYWxsKHRoaXMpO1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fSxcblxuXHRcdGRpc2FibGU6IGZ1bmN0aW9uKCl7XG5cdFx0XHR2YXIgbyA9IHRoaXMuZGF0YSgncGFnaW5hdGlvbicpO1xuXHRcdFx0by5kaXNhYmxlZCA9IHRydWU7XG5cdFx0XHR0aGlzLmRhdGEoJ3BhZ2luYXRpb24nLCBvKTtcblx0XHRcdG1ldGhvZHMuX2RyYXcuY2FsbCh0aGlzKTtcblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH0sXG5cblx0XHRlbmFibGU6IGZ1bmN0aW9uKCl7XG5cdFx0XHR2YXIgbyA9IHRoaXMuZGF0YSgncGFnaW5hdGlvbicpO1xuXHRcdFx0by5kaXNhYmxlZCA9IGZhbHNlO1xuXHRcdFx0dGhpcy5kYXRhKCdwYWdpbmF0aW9uJywgbyk7XG5cdFx0XHRtZXRob2RzLl9kcmF3LmNhbGwodGhpcyk7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXG5cdFx0dXBkYXRlSXRlbXM6IGZ1bmN0aW9uIChuZXdJdGVtcykge1xuXHRcdFx0dmFyIG8gPSB0aGlzLmRhdGEoJ3BhZ2luYXRpb24nKTtcblx0XHRcdG8uaXRlbXMgPSBuZXdJdGVtcztcblx0XHRcdG8ucGFnZXMgPSBtZXRob2RzLl9nZXRQYWdlcyhvKTtcblx0XHRcdHRoaXMuZGF0YSgncGFnaW5hdGlvbicsIG8pO1xuXHRcdFx0bWV0aG9kcy5fZHJhdy5jYWxsKHRoaXMpO1xuXHRcdH0sXG5cblx0XHR1cGRhdGVJdGVtc09uUGFnZTogZnVuY3Rpb24gKGl0ZW1zT25QYWdlKSB7XG5cdFx0XHR2YXIgbyA9IHRoaXMuZGF0YSgncGFnaW5hdGlvbicpO1xuXHRcdFx0by5pdGVtc09uUGFnZSA9IGl0ZW1zT25QYWdlO1xuXHRcdFx0by5wYWdlcyA9IG1ldGhvZHMuX2dldFBhZ2VzKG8pO1xuXHRcdFx0dGhpcy5kYXRhKCdwYWdpbmF0aW9uJywgbyk7XG5cdFx0XHRtZXRob2RzLl9zZWxlY3RQYWdlLmNhbGwodGhpcywgMCk7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXG5cdFx0X2RyYXc6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyXHRvID0gdGhpcy5kYXRhKCdwYWdpbmF0aW9uJyksXG5cdFx0XHRcdGludGVydmFsID0gbWV0aG9kcy5fZ2V0SW50ZXJ2YWwobyksXG5cdFx0XHRcdGksXG5cdFx0XHRcdHRhZ05hbWU7XG5cblx0XHRcdG1ldGhvZHMuZGVzdHJveS5jYWxsKHRoaXMpO1xuXHRcdFx0XG5cdFx0XHR0YWdOYW1lID0gKHR5cGVvZiB0aGlzLnByb3AgPT09ICdmdW5jdGlvbicpID8gdGhpcy5wcm9wKCd0YWdOYW1lJykgOiB0aGlzLmF0dHIoJ3RhZ05hbWUnKTtcblxuXHRcdFx0dmFyICRwYW5lbCA9IHRhZ05hbWUgPT09ICdVTCcgPyB0aGlzIDogJCgnPHVsPjwvdWw+JykuYXBwZW5kVG8odGhpcyk7XG5cblx0XHRcdC8vIEdlbmVyYXRlIFByZXYgbGlua1xuXHRcdFx0aWYgKG8ucHJldlRleHQpIHtcblx0XHRcdFx0bWV0aG9kcy5fYXBwZW5kSXRlbS5jYWxsKHRoaXMsICFvLmludmVydFBhZ2VPcmRlciA/IG8uY3VycmVudFBhZ2UgLSAxIDogby5jdXJyZW50UGFnZSArIDEsIHt0ZXh0OiBvLnByZXZUZXh0LCBjbGFzc2VzOiAncHJldid9KTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gR2VuZXJhdGUgTmV4dCBsaW5rIChpZiBvcHRpb24gc2V0IGZvciBhdCBmcm9udClcblx0XHRcdGlmIChvLm5leHRUZXh0ICYmIG8ubmV4dEF0RnJvbnQpIHtcblx0XHRcdFx0bWV0aG9kcy5fYXBwZW5kSXRlbS5jYWxsKHRoaXMsICFvLmludmVydFBhZ2VPcmRlciA/IG8uY3VycmVudFBhZ2UgKyAxIDogby5jdXJyZW50UGFnZSAtIDEsIHt0ZXh0OiBvLm5leHRUZXh0LCBjbGFzc2VzOiAnbmV4dCd9KTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gR2VuZXJhdGUgc3RhcnQgZWRnZXNcblx0XHRcdGlmICghby5pbnZlcnRQYWdlT3JkZXIpIHtcblx0XHRcdFx0aWYgKGludGVydmFsLnN0YXJ0ID4gMCAmJiBvLmVkZ2VzID4gMCkge1xuXHRcdFx0XHRcdHZhciBlbmQgPSBNYXRoLm1pbihvLmVkZ2VzLCBpbnRlcnZhbC5zdGFydCk7XG5cdFx0XHRcdFx0Zm9yIChpID0gMDsgaSA8IGVuZDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRtZXRob2RzLl9hcHBlbmRJdGVtLmNhbGwodGhpcywgaSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmIChvLmVkZ2VzIDwgaW50ZXJ2YWwuc3RhcnQgJiYgKGludGVydmFsLnN0YXJ0IC0gby5lZGdlcyAhPSAxKSkge1xuXHRcdFx0XHRcdFx0JHBhbmVsLmFwcGVuZCgnPGxpIGNsYXNzPVwiZGlzYWJsZWRcIj48c3BhbiBjbGFzcz1cImVsbGlwc2VcIj4nICsgby5lbGxpcHNlVGV4dCArICc8L3NwYW4+PC9saT4nKTtcblx0XHRcdFx0XHR9IGVsc2UgaWYgKGludGVydmFsLnN0YXJ0IC0gby5lZGdlcyA9PSAxKSB7XG5cdFx0XHRcdFx0XHRtZXRob2RzLl9hcHBlbmRJdGVtLmNhbGwodGhpcywgby5lZGdlcyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAoaW50ZXJ2YWwuZW5kIDwgby5wYWdlcyAmJiBvLmVkZ2VzID4gMCkge1xuXHRcdFx0XHRcdHZhciBiZWdpbiA9IE1hdGgubWF4KG8ucGFnZXMgLSBvLmVkZ2VzLCBpbnRlcnZhbC5lbmQpO1xuXHRcdFx0XHRcdGZvciAoaSA9IG8ucGFnZXMgLSAxOyBpID49IGJlZ2luOyBpLS0pIHtcblx0XHRcdFx0XHRcdG1ldGhvZHMuX2FwcGVuZEl0ZW0uY2FsbCh0aGlzLCBpKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKG8ucGFnZXMgLSBvLmVkZ2VzID4gaW50ZXJ2YWwuZW5kICYmIChvLnBhZ2VzIC0gby5lZGdlcyAtIGludGVydmFsLmVuZCAhPSAxKSkge1xuXHRcdFx0XHRcdFx0JHBhbmVsLmFwcGVuZCgnPGxpIGNsYXNzPVwiZGlzYWJsZWRcIj48c3BhbiBjbGFzcz1cImVsbGlwc2VcIj4nICsgby5lbGxpcHNlVGV4dCArICc8L3NwYW4+PC9saT4nKTtcblx0XHRcdFx0XHR9IGVsc2UgaWYgKG8ucGFnZXMgLSBvLmVkZ2VzIC0gaW50ZXJ2YWwuZW5kID09IDEpIHtcblx0XHRcdFx0XHRcdG1ldGhvZHMuX2FwcGVuZEl0ZW0uY2FsbCh0aGlzLCBpbnRlcnZhbC5lbmQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyBHZW5lcmF0ZSBpbnRlcnZhbCBsaW5rc1xuXHRcdFx0aWYgKCFvLmludmVydFBhZ2VPcmRlcikge1xuXHRcdFx0XHRmb3IgKGkgPSBpbnRlcnZhbC5zdGFydDsgaSA8IGludGVydmFsLmVuZDsgaSsrKSB7XG5cdFx0XHRcdFx0bWV0aG9kcy5fYXBwZW5kSXRlbS5jYWxsKHRoaXMsIGkpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRmb3IgKGkgPSBpbnRlcnZhbC5lbmQgLSAxOyBpID49IGludGVydmFsLnN0YXJ0OyBpLS0pIHtcblx0XHRcdFx0XHRtZXRob2RzLl9hcHBlbmRJdGVtLmNhbGwodGhpcywgaSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gR2VuZXJhdGUgZW5kIGVkZ2VzXG5cdFx0XHRpZiAoIW8uaW52ZXJ0UGFnZU9yZGVyKSB7XG5cdFx0XHRcdGlmIChpbnRlcnZhbC5lbmQgPCBvLnBhZ2VzICYmIG8uZWRnZXMgPiAwKSB7XG5cdFx0XHRcdFx0aWYgKG8ucGFnZXMgLSBvLmVkZ2VzID4gaW50ZXJ2YWwuZW5kICYmIChvLnBhZ2VzIC0gby5lZGdlcyAtIGludGVydmFsLmVuZCAhPSAxKSkge1xuXHRcdFx0XHRcdFx0JHBhbmVsLmFwcGVuZCgnPGxpIGNsYXNzPVwiZGlzYWJsZWRcIj48c3BhbiBjbGFzcz1cImVsbGlwc2VcIj4nICsgby5lbGxpcHNlVGV4dCArICc8L3NwYW4+PC9saT4nKTtcblx0XHRcdFx0XHR9IGVsc2UgaWYgKG8ucGFnZXMgLSBvLmVkZ2VzIC0gaW50ZXJ2YWwuZW5kID09IDEpIHtcblx0XHRcdFx0XHRcdG1ldGhvZHMuX2FwcGVuZEl0ZW0uY2FsbCh0aGlzLCBpbnRlcnZhbC5lbmQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR2YXIgYmVnaW4gPSBNYXRoLm1heChvLnBhZ2VzIC0gby5lZGdlcywgaW50ZXJ2YWwuZW5kKTtcblx0XHRcdFx0XHRmb3IgKGkgPSBiZWdpbjsgaSA8IG8ucGFnZXM7IGkrKykge1xuXHRcdFx0XHRcdFx0bWV0aG9kcy5fYXBwZW5kSXRlbS5jYWxsKHRoaXMsIGkpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYgKGludGVydmFsLnN0YXJ0ID4gMCAmJiBvLmVkZ2VzID4gMCkge1xuXHRcdFx0XHRcdGlmIChvLmVkZ2VzIDwgaW50ZXJ2YWwuc3RhcnQgJiYgKGludGVydmFsLnN0YXJ0IC0gby5lZGdlcyAhPSAxKSkge1xuXHRcdFx0XHRcdFx0JHBhbmVsLmFwcGVuZCgnPGxpIGNsYXNzPVwiZGlzYWJsZWRcIj48c3BhbiBjbGFzcz1cImVsbGlwc2VcIj4nICsgby5lbGxpcHNlVGV4dCArICc8L3NwYW4+PC9saT4nKTtcblx0XHRcdFx0XHR9IGVsc2UgaWYgKGludGVydmFsLnN0YXJ0IC0gby5lZGdlcyA9PSAxKSB7XG5cdFx0XHRcdFx0XHRtZXRob2RzLl9hcHBlbmRJdGVtLmNhbGwodGhpcywgby5lZGdlcyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHZhciBlbmQgPSBNYXRoLm1pbihvLmVkZ2VzLCBpbnRlcnZhbC5zdGFydCk7XG5cdFx0XHRcdFx0Zm9yIChpID0gZW5kIC0gMTsgaSA+PSAwOyBpLS0pIHtcblx0XHRcdFx0XHRcdG1ldGhvZHMuX2FwcGVuZEl0ZW0uY2FsbCh0aGlzLCBpKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gR2VuZXJhdGUgTmV4dCBsaW5rICh1bmxlc3Mgb3B0aW9uIGlzIHNldCBmb3IgYXQgZnJvbnQpXG5cdFx0XHRpZiAoby5uZXh0VGV4dCAmJiAhby5uZXh0QXRGcm9udCkge1xuXHRcdFx0XHRtZXRob2RzLl9hcHBlbmRJdGVtLmNhbGwodGhpcywgIW8uaW52ZXJ0UGFnZU9yZGVyID8gby5jdXJyZW50UGFnZSArIDEgOiBvLmN1cnJlbnRQYWdlIC0gMSwge3RleHQ6IG8ubmV4dFRleHQsIGNsYXNzZXM6ICduZXh0J30pO1xuXHRcdFx0fVxuXHRcdH0sXG5cblx0XHRfZ2V0UGFnZXM6IGZ1bmN0aW9uKG8pIHtcblx0XHRcdHZhciBwYWdlcyA9IE1hdGguY2VpbChvLml0ZW1zIC8gby5pdGVtc09uUGFnZSk7XG5cdFx0XHRyZXR1cm4gcGFnZXMgfHwgMTtcblx0XHR9LFxuXG5cdFx0X2dldEludGVydmFsOiBmdW5jdGlvbihvKSB7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRzdGFydDogTWF0aC5jZWlsKG8uY3VycmVudFBhZ2UgPiBvLmhhbGZEaXNwbGF5ZWQgPyBNYXRoLm1heChNYXRoLm1pbihvLmN1cnJlbnRQYWdlIC0gby5oYWxmRGlzcGxheWVkLCAoby5wYWdlcyAtIG8uZGlzcGxheWVkUGFnZXMpKSwgMCkgOiAwKSxcblx0XHRcdFx0ZW5kOiBNYXRoLmNlaWwoby5jdXJyZW50UGFnZSA+IG8uaGFsZkRpc3BsYXllZCA/IE1hdGgubWluKG8uY3VycmVudFBhZ2UgKyBvLmhhbGZEaXNwbGF5ZWQsIG8ucGFnZXMpIDogTWF0aC5taW4oby5kaXNwbGF5ZWRQYWdlcywgby5wYWdlcykpXG5cdFx0XHR9O1xuXHRcdH0sXG5cblx0XHRfYXBwZW5kSXRlbTogZnVuY3Rpb24ocGFnZUluZGV4LCBvcHRzKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMsIG9wdGlvbnMsICRsaW5rLCBvID0gc2VsZi5kYXRhKCdwYWdpbmF0aW9uJyksICRsaW5rV3JhcHBlciA9ICQoJzxsaT48L2xpPicpLCAkdWwgPSBzZWxmLmZpbmQoJ3VsJyk7XG5cblx0XHRcdHBhZ2VJbmRleCA9IHBhZ2VJbmRleCA8IDAgPyAwIDogKHBhZ2VJbmRleCA8IG8ucGFnZXMgPyBwYWdlSW5kZXggOiBvLnBhZ2VzIC0gMSk7XG5cblx0XHRcdG9wdGlvbnMgPSB7XG5cdFx0XHRcdHRleHQ6IHBhZ2VJbmRleCArIDEsXG5cdFx0XHRcdGNsYXNzZXM6ICcnXG5cdFx0XHR9O1xuXG5cdFx0XHRpZiAoby5sYWJlbE1hcC5sZW5ndGggJiYgby5sYWJlbE1hcFtwYWdlSW5kZXhdKSB7XG5cdFx0XHRcdG9wdGlvbnMudGV4dCA9IG8ubGFiZWxNYXBbcGFnZUluZGV4XTtcblx0XHRcdH1cblxuXHRcdFx0b3B0aW9ucyA9ICQuZXh0ZW5kKG9wdGlvbnMsIG9wdHMgfHwge30pO1xuXG5cdFx0XHRpZiAocGFnZUluZGV4ID09IG8uY3VycmVudFBhZ2UgfHwgby5kaXNhYmxlZCkge1xuXHRcdFx0XHRpZiAoby5kaXNhYmxlZCkge1xuXHRcdFx0XHRcdCRsaW5rV3JhcHBlci5hZGRDbGFzcygnZGlzYWJsZWQnKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQkbGlua1dyYXBwZXIuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdCRsaW5rID0gJCgnPHNwYW4gY2xhc3M9XCJjdXJyZW50XCI+JyArIChvcHRpb25zLnRleHQpICsgJzwvc3Bhbj4nKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdCRsaW5rID0gJCgnPGEgaHJlZj1cIicgKyBvLmhyZWZUZXh0UHJlZml4ICsgKHBhZ2VJbmRleCArIDEpICsgby5ocmVmVGV4dFN1ZmZpeCArICdcIiBjbGFzcz1cInBhZ2UtbGlua1wiPicgKyAob3B0aW9ucy50ZXh0KSArICc8L2E+Jyk7XG5cdFx0XHRcdCRsaW5rLmNsaWNrKGZ1bmN0aW9uKGV2ZW50KXtcblx0XHRcdFx0XHRyZXR1cm4gbWV0aG9kcy5fc2VsZWN0UGFnZS5jYWxsKHNlbGYsIHBhZ2VJbmRleCwgZXZlbnQpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKG9wdGlvbnMuY2xhc3Nlcykge1xuXHRcdFx0XHQkbGluay5hZGRDbGFzcyhvcHRpb25zLmNsYXNzZXMpO1xuXHRcdFx0fVxuXG5cdFx0XHQkbGlua1dyYXBwZXIuYXBwZW5kKCRsaW5rKTtcblxuXHRcdFx0aWYgKCR1bC5sZW5ndGgpIHtcblx0XHRcdFx0JHVsLmFwcGVuZCgkbGlua1dyYXBwZXIpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0c2VsZi5hcHBlbmQoJGxpbmtXcmFwcGVyKTtcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0X3NlbGVjdFBhZ2U6IGZ1bmN0aW9uKHBhZ2VJbmRleCwgZXZlbnQpIHtcblx0XHRcdHZhciBvID0gdGhpcy5kYXRhKCdwYWdpbmF0aW9uJyk7XG5cdFx0XHRvLmN1cnJlbnRQYWdlID0gcGFnZUluZGV4O1xuXHRcdFx0aWYgKG8uc2VsZWN0T25DbGljaykge1xuXHRcdFx0XHRtZXRob2RzLl9kcmF3LmNhbGwodGhpcyk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gby5vblBhZ2VDbGljayhwYWdlSW5kZXggKyAxLCBldmVudCk7XG5cdFx0fVxuXG5cdH07XG5cblx0JC5mbi5wYWdpbmF0aW9uID0gZnVuY3Rpb24obWV0aG9kKSB7XG5cblx0XHQvLyBNZXRob2QgY2FsbGluZyBsb2dpY1xuXHRcdGlmIChtZXRob2RzW21ldGhvZF0gJiYgbWV0aG9kLmNoYXJBdCgwKSAhPSAnXycpIHtcblx0XHRcdHJldHVybiBtZXRob2RzW21ldGhvZF0uYXBwbHkodGhpcywgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG5cdFx0fSBlbHNlIGlmICh0eXBlb2YgbWV0aG9kID09PSAnb2JqZWN0JyB8fCAhbWV0aG9kKSB7XG5cdFx0XHRyZXR1cm4gbWV0aG9kcy5pbml0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdCQuZXJyb3IoJ01ldGhvZCAnICsgIG1ldGhvZCArICcgZG9lcyBub3QgZXhpc3Qgb24galF1ZXJ5LnBhZ2luYXRpb24nKTtcblx0XHR9XG5cblx0fTtcblxufSkoalF1ZXJ5KTtcbiIsIi8vIFNwZWN0cnVtIENvbG9ycGlja2VyIHYxLjYuMFxuLy8gaHR0cHM6Ly9naXRodWIuY29tL2Jncmlucy9zcGVjdHJ1bVxuLy8gQXV0aG9yOiBCcmlhbiBHcmluc3RlYWRcbi8vIExpY2Vuc2U6IE1JVFxuXG4oZnVuY3Rpb24gKGZhY3RvcnkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHsgLy8gQU1EXG4gICAgICAgIGRlZmluZShbJ2pxdWVyeSddLCBmYWN0b3J5KTtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIGV4cG9ydHMgPT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgbW9kdWxlID09IFwib2JqZWN0XCIpIHsgLy8gQ29tbW9uSlNcbiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5O1xuICAgIH1cbiAgICBlbHNlIHsgLy8gQnJvd3NlclxuICAgICAgICBmYWN0b3J5KGpRdWVyeSk7XG4gICAgfVxufSkoZnVuY3Rpb24oJCwgdW5kZWZpbmVkKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICB2YXIgZGVmYXVsdE9wdHMgPSB7XG5cbiAgICAgICAgLy8gQ2FsbGJhY2tzXG4gICAgICAgIGJlZm9yZVNob3c6IG5vb3AsXG4gICAgICAgIG1vdmU6IG5vb3AsXG4gICAgICAgIGNoYW5nZTogbm9vcCxcbiAgICAgICAgc2hvdzogbm9vcCxcbiAgICAgICAgaGlkZTogbm9vcCxcblxuICAgICAgICAvLyBPcHRpb25zXG4gICAgICAgIGNvbG9yOiBmYWxzZSxcbiAgICAgICAgZmxhdDogZmFsc2UsXG4gICAgICAgIHNob3dJbnB1dDogZmFsc2UsXG4gICAgICAgIGFsbG93RW1wdHk6IGZhbHNlLFxuICAgICAgICBzaG93QnV0dG9uczogdHJ1ZSxcbiAgICAgICAgY2xpY2tvdXRGaXJlc0NoYW5nZTogZmFsc2UsXG4gICAgICAgIHNob3dJbml0aWFsOiBmYWxzZSxcbiAgICAgICAgc2hvd1BhbGV0dGU6IGZhbHNlLFxuICAgICAgICBzaG93UGFsZXR0ZU9ubHk6IGZhbHNlLFxuICAgICAgICBoaWRlQWZ0ZXJQYWxldHRlU2VsZWN0OiBmYWxzZSxcbiAgICAgICAgdG9nZ2xlUGFsZXR0ZU9ubHk6IGZhbHNlLFxuICAgICAgICBzaG93U2VsZWN0aW9uUGFsZXR0ZTogdHJ1ZSxcbiAgICAgICAgbG9jYWxTdG9yYWdlS2V5OiBmYWxzZSxcbiAgICAgICAgYXBwZW5kVG86IFwiYm9keVwiLFxuICAgICAgICBtYXhTZWxlY3Rpb25TaXplOiA3LFxuICAgICAgICBjYW5jZWxUZXh0OiBcImNhbmNlbFwiLFxuICAgICAgICBjaG9vc2VUZXh0OiBcImNob29zZVwiLFxuICAgICAgICB0b2dnbGVQYWxldHRlTW9yZVRleHQ6IFwibW9yZVwiLFxuICAgICAgICB0b2dnbGVQYWxldHRlTGVzc1RleHQ6IFwibGVzc1wiLFxuICAgICAgICBjbGVhclRleHQ6IFwiQ2xlYXIgQ29sb3IgU2VsZWN0aW9uXCIsXG4gICAgICAgIG5vQ29sb3JTZWxlY3RlZFRleHQ6IFwiTm8gQ29sb3IgU2VsZWN0ZWRcIixcbiAgICAgICAgcHJlZmVycmVkRm9ybWF0OiBmYWxzZSxcbiAgICAgICAgY2xhc3NOYW1lOiBcIlwiLCAvLyBEZXByZWNhdGVkIC0gdXNlIGNvbnRhaW5lckNsYXNzTmFtZSBhbmQgcmVwbGFjZXJDbGFzc05hbWUgaW5zdGVhZC5cbiAgICAgICAgY29udGFpbmVyQ2xhc3NOYW1lOiBcIlwiLFxuICAgICAgICByZXBsYWNlckNsYXNzTmFtZTogXCJcIixcbiAgICAgICAgc2hvd0FscGhhOiBmYWxzZSxcbiAgICAgICAgdGhlbWU6IFwic3AtbGlnaHRcIixcbiAgICAgICAgcGFsZXR0ZTogW1tcIiNmZmZmZmZcIiwgXCIjMDAwMDAwXCIsIFwiI2ZmMDAwMFwiLCBcIiNmZjgwMDBcIiwgXCIjZmZmZjAwXCIsIFwiIzAwODAwMFwiLCBcIiMwMDAwZmZcIiwgXCIjNGIwMDgyXCIsIFwiIzk0MDBkM1wiXV0sXG4gICAgICAgIHNlbGVjdGlvblBhbGV0dGU6IFtdLFxuICAgICAgICBkaXNhYmxlZDogZmFsc2UsXG4gICAgICAgIG9mZnNldDogbnVsbFxuICAgIH0sXG4gICAgc3BlY3RydW1zID0gW10sXG4gICAgSUUgPSAhIS9tc2llL2kuZXhlYyggd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQgKSxcbiAgICByZ2JhU3VwcG9ydCA9IChmdW5jdGlvbigpIHtcbiAgICAgICAgZnVuY3Rpb24gY29udGFpbnMoIHN0ciwgc3Vic3RyICkge1xuICAgICAgICAgICAgcmV0dXJuICEhfignJyArIHN0cikuaW5kZXhPZihzdWJzdHIpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGVsZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdmFyIHN0eWxlID0gZWxlbS5zdHlsZTtcbiAgICAgICAgc3R5bGUuY3NzVGV4dCA9ICdiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMCwwLDAsLjUpJztcbiAgICAgICAgcmV0dXJuIGNvbnRhaW5zKHN0eWxlLmJhY2tncm91bmRDb2xvciwgJ3JnYmEnKSB8fCBjb250YWlucyhzdHlsZS5iYWNrZ3JvdW5kQ29sb3IsICdoc2xhJyk7XG4gICAgfSkoKSxcbiAgICBpbnB1dFR5cGVDb2xvclN1cHBvcnQgPSAoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjb2xvcklucHV0ID0gJChcIjxpbnB1dCB0eXBlPSdjb2xvcicgdmFsdWU9JyEnIC8+XCIpWzBdO1xuICAgICAgICByZXR1cm4gY29sb3JJbnB1dC50eXBlID09PSBcImNvbG9yXCIgJiYgY29sb3JJbnB1dC52YWx1ZSAhPT0gXCIhXCI7XG4gICAgfSkoKSxcbiAgICByZXBsYWNlSW5wdXQgPSBbXG4gICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtcmVwbGFjZXInPlwiLFxuICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcC1wcmV2aWV3Jz48ZGl2IGNsYXNzPSdzcC1wcmV2aWV3LWlubmVyJz48L2Rpdj48L2Rpdj5cIixcbiAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtZGQnPiYjOTY2MDs8L2Rpdj5cIixcbiAgICAgICAgXCI8L2Rpdj5cIlxuICAgIF0uam9pbignJyksXG4gICAgbWFya3VwID0gKGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAvLyBJRSBkb2VzIG5vdCBzdXBwb3J0IGdyYWRpZW50cyB3aXRoIG11bHRpcGxlIHN0b3BzLCBzbyB3ZSBuZWVkIHRvIHNpbXVsYXRlXG4gICAgICAgIC8vICB0aGF0IGZvciB0aGUgcmFpbmJvdyBzbGlkZXIgd2l0aCA4IGRpdnMgdGhhdCBlYWNoIGhhdmUgYSBzaW5nbGUgZ3JhZGllbnRcbiAgICAgICAgdmFyIGdyYWRpZW50Rml4ID0gXCJcIjtcbiAgICAgICAgaWYgKElFKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8PSA2OyBpKyspIHtcbiAgICAgICAgICAgICAgICBncmFkaWVudEZpeCArPSBcIjxkaXYgY2xhc3M9J3NwLVwiICsgaSArIFwiJz48L2Rpdj5cIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBcIjxkaXYgY2xhc3M9J3NwLWNvbnRhaW5lciBzcC1oaWRkZW4nPlwiLFxuICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtcGFsZXR0ZS1jb250YWluZXInPlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9J3NwLXBhbGV0dGUgc3AtdGh1bWIgc3AtY2YnPjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9J3NwLXBhbGV0dGUtYnV0dG9uLWNvbnRhaW5lciBzcC1jZic+XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIjxidXR0b24gdHlwZT0nYnV0dG9uJyBjbGFzcz0nc3AtcGFsZXR0ZS10b2dnbGUnPjwvYnV0dG9uPlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcC1waWNrZXItY29udGFpbmVyJz5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcC10b3Agc3AtY2YnPlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcC1maWxsJz48L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtdG9wLWlubmVyJz5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9J3NwLWNvbG9yJz5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcC1zYXQnPlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcC12YWwnPlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtZHJhZ2dlcic+PC9kaXY+XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcC1jbGVhciBzcC1jbGVhci1kaXNwbGF5Jz5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtaHVlJz5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcC1zbGlkZXInPjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncmFkaWVudEZpeCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtYWxwaGEnPjxkaXYgY2xhc3M9J3NwLWFscGhhLWlubmVyJz48ZGl2IGNsYXNzPSdzcC1hbHBoYS1oYW5kbGUnPjwvZGl2PjwvZGl2PjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9J3NwLWlucHV0LWNvbnRhaW5lciBzcC1jZic+XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIjxpbnB1dCBjbGFzcz0nc3AtaW5wdXQnIHR5cGU9J3RleHQnIHNwZWxsY2hlY2s9J2ZhbHNlJyAgLz5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcC1pbml0aWFsIHNwLXRodW1iIHNwLWNmJz48L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcC1idXR0b24tY29udGFpbmVyIHNwLWNmJz5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiPGEgY2xhc3M9J3NwLWNhbmNlbCcgaHJlZj0nIyc+PC9hPlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCI8YnV0dG9uIHR5cGU9J2J1dHRvbicgY2xhc3M9J3NwLWNob29zZSc+PC9idXR0b24+XCIsXG4gICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgIFwiPC9kaXY+XCJcbiAgICAgICAgXS5qb2luKFwiXCIpO1xuICAgIH0pKCk7XG5cbiAgICBmdW5jdGlvbiBwYWxldHRlVGVtcGxhdGUgKHAsIGNvbG9yLCBjbGFzc05hbWUsIG9wdHMpIHtcbiAgICAgICAgdmFyIGh0bWwgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudCA9IHBbaV07XG4gICAgICAgICAgICBpZihjdXJyZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRpbnkgPSB0aW55Y29sb3IoY3VycmVudCk7XG4gICAgICAgICAgICAgICAgdmFyIGMgPSB0aW55LnRvSHNsKCkubCA8IDAuNSA/IFwic3AtdGh1bWItZWwgc3AtdGh1bWItZGFya1wiIDogXCJzcC10aHVtYi1lbCBzcC10aHVtYi1saWdodFwiO1xuICAgICAgICAgICAgICAgIGMgKz0gKHRpbnljb2xvci5lcXVhbHMoY29sb3IsIGN1cnJlbnQpKSA/IFwiIHNwLXRodW1iLWFjdGl2ZVwiIDogXCJcIjtcbiAgICAgICAgICAgICAgICB2YXIgZm9ybWF0dGVkU3RyaW5nID0gdGlueS50b1N0cmluZyhvcHRzLnByZWZlcnJlZEZvcm1hdCB8fCBcInJnYlwiKTtcbiAgICAgICAgICAgICAgICB2YXIgc3dhdGNoU3R5bGUgPSByZ2JhU3VwcG9ydCA/IChcImJhY2tncm91bmQtY29sb3I6XCIgKyB0aW55LnRvUmdiU3RyaW5nKCkpIDogXCJmaWx0ZXI6XCIgKyB0aW55LnRvRmlsdGVyKCk7XG4gICAgICAgICAgICAgICAgaHRtbC5wdXNoKCc8c3BhbiB0aXRsZT1cIicgKyBmb3JtYXR0ZWRTdHJpbmcgKyAnXCIgZGF0YS1jb2xvcj1cIicgKyB0aW55LnRvUmdiU3RyaW5nKCkgKyAnXCIgY2xhc3M9XCInICsgYyArICdcIj48c3BhbiBjbGFzcz1cInNwLXRodW1iLWlubmVyXCIgc3R5bGU9XCInICsgc3dhdGNoU3R5bGUgKyAnO1wiIC8+PC9zcGFuPicpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgY2xzID0gJ3NwLWNsZWFyLWRpc3BsYXknO1xuICAgICAgICAgICAgICAgIGh0bWwucHVzaCgkKCc8ZGl2IC8+JylcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8c3BhbiBkYXRhLWNvbG9yPVwiXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOnRyYW5zcGFyZW50O1wiIGNsYXNzPVwiJyArIGNscyArICdcIj48L3NwYW4+JylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCd0aXRsZScsIG9wdHMubm9Db2xvclNlbGVjdGVkVGV4dClcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAuaHRtbCgpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXCI8ZGl2IGNsYXNzPSdzcC1jZiBcIiArIGNsYXNzTmFtZSArIFwiJz5cIiArIGh0bWwuam9pbignJykgKyBcIjwvZGl2PlwiO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGhpZGVBbGwoKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3BlY3RydW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoc3BlY3RydW1zW2ldKSB7XG4gICAgICAgICAgICAgICAgc3BlY3RydW1zW2ldLmhpZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluc3RhbmNlT3B0aW9ucyhvLCBjYWxsYmFja0NvbnRleHQpIHtcbiAgICAgICAgdmFyIG9wdHMgPSAkLmV4dGVuZCh7fSwgZGVmYXVsdE9wdHMsIG8pO1xuICAgICAgICBvcHRzLmNhbGxiYWNrcyA9IHtcbiAgICAgICAgICAgICdtb3ZlJzogYmluZChvcHRzLm1vdmUsIGNhbGxiYWNrQ29udGV4dCksXG4gICAgICAgICAgICAnY2hhbmdlJzogYmluZChvcHRzLmNoYW5nZSwgY2FsbGJhY2tDb250ZXh0KSxcbiAgICAgICAgICAgICdzaG93JzogYmluZChvcHRzLnNob3csIGNhbGxiYWNrQ29udGV4dCksXG4gICAgICAgICAgICAnaGlkZSc6IGJpbmQob3B0cy5oaWRlLCBjYWxsYmFja0NvbnRleHQpLFxuICAgICAgICAgICAgJ2JlZm9yZVNob3cnOiBiaW5kKG9wdHMuYmVmb3JlU2hvdywgY2FsbGJhY2tDb250ZXh0KVxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBvcHRzO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNwZWN0cnVtKGVsZW1lbnQsIG8pIHtcblxuICAgICAgICB2YXIgb3B0cyA9IGluc3RhbmNlT3B0aW9ucyhvLCBlbGVtZW50KSxcbiAgICAgICAgICAgIGZsYXQgPSBvcHRzLmZsYXQsXG4gICAgICAgICAgICBzaG93U2VsZWN0aW9uUGFsZXR0ZSA9IG9wdHMuc2hvd1NlbGVjdGlvblBhbGV0dGUsXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2VLZXkgPSBvcHRzLmxvY2FsU3RvcmFnZUtleSxcbiAgICAgICAgICAgIHRoZW1lID0gb3B0cy50aGVtZSxcbiAgICAgICAgICAgIGNhbGxiYWNrcyA9IG9wdHMuY2FsbGJhY2tzLFxuICAgICAgICAgICAgcmVzaXplID0gdGhyb3R0bGUocmVmbG93LCAxMCksXG4gICAgICAgICAgICB2aXNpYmxlID0gZmFsc2UsXG4gICAgICAgICAgICBkcmFnV2lkdGggPSAwLFxuICAgICAgICAgICAgZHJhZ0hlaWdodCA9IDAsXG4gICAgICAgICAgICBkcmFnSGVscGVySGVpZ2h0ID0gMCxcbiAgICAgICAgICAgIHNsaWRlSGVpZ2h0ID0gMCxcbiAgICAgICAgICAgIHNsaWRlV2lkdGggPSAwLFxuICAgICAgICAgICAgYWxwaGFXaWR0aCA9IDAsXG4gICAgICAgICAgICBhbHBoYVNsaWRlSGVscGVyV2lkdGggPSAwLFxuICAgICAgICAgICAgc2xpZGVIZWxwZXJIZWlnaHQgPSAwLFxuICAgICAgICAgICAgY3VycmVudEh1ZSA9IDAsXG4gICAgICAgICAgICBjdXJyZW50U2F0dXJhdGlvbiA9IDAsXG4gICAgICAgICAgICBjdXJyZW50VmFsdWUgPSAwLFxuICAgICAgICAgICAgY3VycmVudEFscGhhID0gMSxcbiAgICAgICAgICAgIHBhbGV0dGUgPSBbXSxcbiAgICAgICAgICAgIHBhbGV0dGVBcnJheSA9IFtdLFxuICAgICAgICAgICAgcGFsZXR0ZUxvb2t1cCA9IHt9LFxuICAgICAgICAgICAgc2VsZWN0aW9uUGFsZXR0ZSA9IG9wdHMuc2VsZWN0aW9uUGFsZXR0ZS5zbGljZSgwKSxcbiAgICAgICAgICAgIG1heFNlbGVjdGlvblNpemUgPSBvcHRzLm1heFNlbGVjdGlvblNpemUsXG4gICAgICAgICAgICBkcmFnZ2luZ0NsYXNzID0gXCJzcC1kcmFnZ2luZ1wiLFxuICAgICAgICAgICAgc2hpZnRNb3ZlbWVudERpcmVjdGlvbiA9IG51bGw7XG5cbiAgICAgICAgdmFyIGRvYyA9IGVsZW1lbnQub3duZXJEb2N1bWVudCxcbiAgICAgICAgICAgIGJvZHkgPSBkb2MuYm9keSxcbiAgICAgICAgICAgIGJvdW5kRWxlbWVudCA9ICQoZWxlbWVudCksXG4gICAgICAgICAgICBkaXNhYmxlZCA9IGZhbHNlLFxuICAgICAgICAgICAgY29udGFpbmVyID0gJChtYXJrdXAsIGRvYykuYWRkQ2xhc3ModGhlbWUpLFxuICAgICAgICAgICAgcGlja2VyQ29udGFpbmVyID0gY29udGFpbmVyLmZpbmQoXCIuc3AtcGlja2VyLWNvbnRhaW5lclwiKSxcbiAgICAgICAgICAgIGRyYWdnZXIgPSBjb250YWluZXIuZmluZChcIi5zcC1jb2xvclwiKSxcbiAgICAgICAgICAgIGRyYWdIZWxwZXIgPSBjb250YWluZXIuZmluZChcIi5zcC1kcmFnZ2VyXCIpLFxuICAgICAgICAgICAgc2xpZGVyID0gY29udGFpbmVyLmZpbmQoXCIuc3AtaHVlXCIpLFxuICAgICAgICAgICAgc2xpZGVIZWxwZXIgPSBjb250YWluZXIuZmluZChcIi5zcC1zbGlkZXJcIiksXG4gICAgICAgICAgICBhbHBoYVNsaWRlcklubmVyID0gY29udGFpbmVyLmZpbmQoXCIuc3AtYWxwaGEtaW5uZXJcIiksXG4gICAgICAgICAgICBhbHBoYVNsaWRlciA9IGNvbnRhaW5lci5maW5kKFwiLnNwLWFscGhhXCIpLFxuICAgICAgICAgICAgYWxwaGFTbGlkZUhlbHBlciA9IGNvbnRhaW5lci5maW5kKFwiLnNwLWFscGhhLWhhbmRsZVwiKSxcbiAgICAgICAgICAgIHRleHRJbnB1dCA9IGNvbnRhaW5lci5maW5kKFwiLnNwLWlucHV0XCIpLFxuICAgICAgICAgICAgcGFsZXR0ZUNvbnRhaW5lciA9IGNvbnRhaW5lci5maW5kKFwiLnNwLXBhbGV0dGVcIiksXG4gICAgICAgICAgICBpbml0aWFsQ29sb3JDb250YWluZXIgPSBjb250YWluZXIuZmluZChcIi5zcC1pbml0aWFsXCIpLFxuICAgICAgICAgICAgY2FuY2VsQnV0dG9uID0gY29udGFpbmVyLmZpbmQoXCIuc3AtY2FuY2VsXCIpLFxuICAgICAgICAgICAgY2xlYXJCdXR0b24gPSBjb250YWluZXIuZmluZChcIi5zcC1jbGVhclwiKSxcbiAgICAgICAgICAgIGNob29zZUJ1dHRvbiA9IGNvbnRhaW5lci5maW5kKFwiLnNwLWNob29zZVwiKSxcbiAgICAgICAgICAgIHRvZ2dsZUJ1dHRvbiA9IGNvbnRhaW5lci5maW5kKFwiLnNwLXBhbGV0dGUtdG9nZ2xlXCIpLFxuICAgICAgICAgICAgaXNJbnB1dCA9IGJvdW5kRWxlbWVudC5pcyhcImlucHV0XCIpLFxuICAgICAgICAgICAgaXNJbnB1dFR5cGVDb2xvciA9IGlzSW5wdXQgJiYgaW5wdXRUeXBlQ29sb3JTdXBwb3J0ICYmIGJvdW5kRWxlbWVudC5hdHRyKFwidHlwZVwiKSA9PT0gXCJjb2xvclwiLFxuICAgICAgICAgICAgc2hvdWxkUmVwbGFjZSA9IGlzSW5wdXQgJiYgIWZsYXQsXG4gICAgICAgICAgICByZXBsYWNlciA9IChzaG91bGRSZXBsYWNlKSA/ICQocmVwbGFjZUlucHV0KS5hZGRDbGFzcyh0aGVtZSkuYWRkQ2xhc3Mob3B0cy5jbGFzc05hbWUpLmFkZENsYXNzKG9wdHMucmVwbGFjZXJDbGFzc05hbWUpIDogJChbXSksXG4gICAgICAgICAgICBvZmZzZXRFbGVtZW50ID0gKHNob3VsZFJlcGxhY2UpID8gcmVwbGFjZXIgOiBib3VuZEVsZW1lbnQsXG4gICAgICAgICAgICBwcmV2aWV3RWxlbWVudCA9IHJlcGxhY2VyLmZpbmQoXCIuc3AtcHJldmlldy1pbm5lclwiKSxcbiAgICAgICAgICAgIGluaXRpYWxDb2xvciA9IG9wdHMuY29sb3IgfHwgKGlzSW5wdXQgJiYgYm91bmRFbGVtZW50LnZhbCgpKSxcbiAgICAgICAgICAgIGNvbG9yT25TaG93ID0gZmFsc2UsXG4gICAgICAgICAgICBwcmVmZXJyZWRGb3JtYXQgPSBvcHRzLnByZWZlcnJlZEZvcm1hdCxcbiAgICAgICAgICAgIGN1cnJlbnRQcmVmZXJyZWRGb3JtYXQgPSBwcmVmZXJyZWRGb3JtYXQsXG4gICAgICAgICAgICBjbGlja291dEZpcmVzQ2hhbmdlID0gIW9wdHMuc2hvd0J1dHRvbnMgfHwgb3B0cy5jbGlja291dEZpcmVzQ2hhbmdlLFxuICAgICAgICAgICAgaXNFbXB0eSA9ICFpbml0aWFsQ29sb3IsXG4gICAgICAgICAgICBhbGxvd0VtcHR5ID0gb3B0cy5hbGxvd0VtcHR5ICYmICFpc0lucHV0VHlwZUNvbG9yO1xuXG4gICAgICAgIGZ1bmN0aW9uIGFwcGx5T3B0aW9ucygpIHtcblxuICAgICAgICAgICAgaWYgKG9wdHMuc2hvd1BhbGV0dGVPbmx5KSB7XG4gICAgICAgICAgICAgICAgb3B0cy5zaG93UGFsZXR0ZSA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRvZ2dsZUJ1dHRvbi50ZXh0KG9wdHMuc2hvd1BhbGV0dGVPbmx5ID8gb3B0cy50b2dnbGVQYWxldHRlTW9yZVRleHQgOiBvcHRzLnRvZ2dsZVBhbGV0dGVMZXNzVGV4dCk7XG5cbiAgICAgICAgICAgIGlmIChvcHRzLnBhbGV0dGUpIHtcbiAgICAgICAgICAgICAgICBwYWxldHRlID0gb3B0cy5wYWxldHRlLnNsaWNlKDApO1xuICAgICAgICAgICAgICAgIHBhbGV0dGVBcnJheSA9ICQuaXNBcnJheShwYWxldHRlWzBdKSA/IHBhbGV0dGUgOiBbcGFsZXR0ZV07XG4gICAgICAgICAgICAgICAgcGFsZXR0ZUxvb2t1cCA9IHt9O1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFsZXR0ZUFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgcGFsZXR0ZUFycmF5W2ldLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmdiID0gdGlueWNvbG9yKHBhbGV0dGVBcnJheVtpXVtqXSkudG9SZ2JTdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhbGV0dGVMb29rdXBbcmdiXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnRhaW5lci50b2dnbGVDbGFzcyhcInNwLWZsYXRcIiwgZmxhdCk7XG4gICAgICAgICAgICBjb250YWluZXIudG9nZ2xlQ2xhc3MoXCJzcC1pbnB1dC1kaXNhYmxlZFwiLCAhb3B0cy5zaG93SW5wdXQpO1xuICAgICAgICAgICAgY29udGFpbmVyLnRvZ2dsZUNsYXNzKFwic3AtYWxwaGEtZW5hYmxlZFwiLCBvcHRzLnNob3dBbHBoYSk7XG4gICAgICAgICAgICBjb250YWluZXIudG9nZ2xlQ2xhc3MoXCJzcC1jbGVhci1lbmFibGVkXCIsIGFsbG93RW1wdHkpO1xuICAgICAgICAgICAgY29udGFpbmVyLnRvZ2dsZUNsYXNzKFwic3AtYnV0dG9ucy1kaXNhYmxlZFwiLCAhb3B0cy5zaG93QnV0dG9ucyk7XG4gICAgICAgICAgICBjb250YWluZXIudG9nZ2xlQ2xhc3MoXCJzcC1wYWxldHRlLWJ1dHRvbnMtZGlzYWJsZWRcIiwgIW9wdHMudG9nZ2xlUGFsZXR0ZU9ubHkpO1xuICAgICAgICAgICAgY29udGFpbmVyLnRvZ2dsZUNsYXNzKFwic3AtcGFsZXR0ZS1kaXNhYmxlZFwiLCAhb3B0cy5zaG93UGFsZXR0ZSk7XG4gICAgICAgICAgICBjb250YWluZXIudG9nZ2xlQ2xhc3MoXCJzcC1wYWxldHRlLW9ubHlcIiwgb3B0cy5zaG93UGFsZXR0ZU9ubHkpO1xuICAgICAgICAgICAgY29udGFpbmVyLnRvZ2dsZUNsYXNzKFwic3AtaW5pdGlhbC1kaXNhYmxlZFwiLCAhb3B0cy5zaG93SW5pdGlhbCk7XG4gICAgICAgICAgICBjb250YWluZXIuYWRkQ2xhc3Mob3B0cy5jbGFzc05hbWUpLmFkZENsYXNzKG9wdHMuY29udGFpbmVyQ2xhc3NOYW1lKTtcblxuICAgICAgICAgICAgcmVmbG93KCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpbml0aWFsaXplKCkge1xuXG4gICAgICAgICAgICBpZiAoSUUpIHtcbiAgICAgICAgICAgICAgICBjb250YWluZXIuZmluZChcIio6bm90KGlucHV0KVwiKS5hdHRyKFwidW5zZWxlY3RhYmxlXCIsIFwib25cIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGFwcGx5T3B0aW9ucygpO1xuXG4gICAgICAgICAgICBpZiAoc2hvdWxkUmVwbGFjZSkge1xuICAgICAgICAgICAgICAgIGJvdW5kRWxlbWVudC5hZnRlcihyZXBsYWNlcikuaGlkZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIWFsbG93RW1wdHkpIHtcbiAgICAgICAgICAgICAgICBjbGVhckJ1dHRvbi5oaWRlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChmbGF0KSB7XG4gICAgICAgICAgICAgICAgYm91bmRFbGVtZW50LmFmdGVyKGNvbnRhaW5lcikuaGlkZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgYXBwZW5kVG8gPSBvcHRzLmFwcGVuZFRvID09PSBcInBhcmVudFwiID8gYm91bmRFbGVtZW50LnBhcmVudCgpIDogJChvcHRzLmFwcGVuZFRvKTtcbiAgICAgICAgICAgICAgICBpZiAoYXBwZW5kVG8ubGVuZ3RoICE9PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIGFwcGVuZFRvID0gJChcImJvZHlcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgYXBwZW5kVG8uYXBwZW5kKGNvbnRhaW5lcik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHVwZGF0ZVNlbGVjdGlvblBhbGV0dGVGcm9tU3RvcmFnZSgpO1xuXG4gICAgICAgICAgICBvZmZzZXRFbGVtZW50LmJpbmQoXCJjbGljay5zcGVjdHJ1bSB0b3VjaHN0YXJ0LnNwZWN0cnVtXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFkaXNhYmxlZCkge1xuICAgICAgICAgICAgICAgICAgICB0b2dnbGUoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCEkKGUudGFyZ2V0KS5pcyhcImlucHV0XCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYoYm91bmRFbGVtZW50LmlzKFwiOmRpc2FibGVkXCIpIHx8IChvcHRzLmRpc2FibGVkID09PSB0cnVlKSkge1xuICAgICAgICAgICAgICAgIGRpc2FibGUoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gUHJldmVudCBjbGlja3MgZnJvbSBidWJibGluZyB1cCB0byBkb2N1bWVudC4gIFRoaXMgd291bGQgY2F1c2UgaXQgdG8gYmUgaGlkZGVuLlxuICAgICAgICAgICAgY29udGFpbmVyLmNsaWNrKHN0b3BQcm9wYWdhdGlvbik7XG5cbiAgICAgICAgICAgIC8vIEhhbmRsZSB1c2VyIHR5cGVkIGlucHV0XG4gICAgICAgICAgICB0ZXh0SW5wdXQuY2hhbmdlKHNldEZyb21UZXh0SW5wdXQpO1xuICAgICAgICAgICAgdGV4dElucHV0LmJpbmQoXCJwYXN0ZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChzZXRGcm9tVGV4dElucHV0LCAxKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGV4dElucHV0LmtleWRvd24oZnVuY3Rpb24gKGUpIHsgaWYgKGUua2V5Q29kZSA9PSAxMykgeyBzZXRGcm9tVGV4dElucHV0KCk7IH0gfSk7XG5cbiAgICAgICAgICAgIGNhbmNlbEJ1dHRvbi50ZXh0KG9wdHMuY2FuY2VsVGV4dCk7XG4gICAgICAgICAgICBjYW5jZWxCdXR0b24uYmluZChcImNsaWNrLnNwZWN0cnVtXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgcmV2ZXJ0KCk7XG4gICAgICAgICAgICAgICAgaGlkZSgpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNsZWFyQnV0dG9uLmF0dHIoXCJ0aXRsZVwiLCBvcHRzLmNsZWFyVGV4dCk7XG4gICAgICAgICAgICBjbGVhckJ1dHRvbi5iaW5kKFwiY2xpY2suc3BlY3RydW1cIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICBpc0VtcHR5ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBtb3ZlKCk7XG5cbiAgICAgICAgICAgICAgICBpZihmbGF0KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vZm9yIHRoZSBmbGF0IHN0eWxlLCB0aGlzIGlzIGEgY2hhbmdlIGV2ZW50XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZU9yaWdpbmFsSW5wdXQodHJ1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNob29zZUJ1dHRvbi50ZXh0KG9wdHMuY2hvb3NlVGV4dCk7XG4gICAgICAgICAgICBjaG9vc2VCdXR0b24uYmluZChcImNsaWNrLnNwZWN0cnVtXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaXNWYWxpZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZU9yaWdpbmFsSW5wdXQodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGhpZGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdG9nZ2xlQnV0dG9uLnRleHQob3B0cy5zaG93UGFsZXR0ZU9ubHkgPyBvcHRzLnRvZ2dsZVBhbGV0dGVNb3JlVGV4dCA6IG9wdHMudG9nZ2xlUGFsZXR0ZUxlc3NUZXh0KTtcbiAgICAgICAgICAgIHRvZ2dsZUJ1dHRvbi5iaW5kKFwiY2xpY2suc3BlY3RydW1cIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgICAgIG9wdHMuc2hvd1BhbGV0dGVPbmx5ID0gIW9wdHMuc2hvd1BhbGV0dGVPbmx5O1xuXG4gICAgICAgICAgICAgICAgLy8gVG8gbWFrZSBzdXJlIHRoZSBQaWNrZXIgYXJlYSBpcyBkcmF3biBvbiB0aGUgcmlnaHQsIG5leHQgdG8gdGhlXG4gICAgICAgICAgICAgICAgLy8gUGFsZXR0ZSBhcmVhIChhbmQgbm90IGJlbG93IHRoZSBwYWxldHRlKSwgZmlyc3QgbW92ZSB0aGUgUGFsZXR0ZVxuICAgICAgICAgICAgICAgIC8vIHRvIHRoZSBsZWZ0IHRvIG1ha2Ugc3BhY2UgZm9yIHRoZSBwaWNrZXIsIHBsdXMgNXB4IGV4dHJhLlxuICAgICAgICAgICAgICAgIC8vIFRoZSAnYXBwbHlPcHRpb25zJyBmdW5jdGlvbiBwdXRzIHRoZSB3aG9sZSBjb250YWluZXIgYmFjayBpbnRvIHBsYWNlXG4gICAgICAgICAgICAgICAgLy8gYW5kIHRha2VzIGNhcmUgb2YgdGhlIGJ1dHRvbi10ZXh0IGFuZCB0aGUgc3AtcGFsZXR0ZS1vbmx5IENTUyBjbGFzcy5cbiAgICAgICAgICAgICAgICBpZiAoIW9wdHMuc2hvd1BhbGV0dGVPbmx5ICYmICFmbGF0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5jc3MoJ2xlZnQnLCAnLT0nICsgKHBpY2tlckNvbnRhaW5lci5vdXRlcldpZHRoKHRydWUpICsgNSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhcHBseU9wdGlvbnMoKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBkcmFnZ2FibGUoYWxwaGFTbGlkZXIsIGZ1bmN0aW9uIChkcmFnWCwgZHJhZ1ksIGUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50QWxwaGEgPSAoZHJhZ1ggLyBhbHBoYVdpZHRoKTtcbiAgICAgICAgICAgICAgICBpc0VtcHR5ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKGUuc2hpZnRLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudEFscGhhID0gTWF0aC5yb3VuZChjdXJyZW50QWxwaGEgKiAxMCkgLyAxMDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBtb3ZlKCk7XG4gICAgICAgICAgICB9LCBkcmFnU3RhcnQsIGRyYWdTdG9wKTtcblxuICAgICAgICAgICAgZHJhZ2dhYmxlKHNsaWRlciwgZnVuY3Rpb24gKGRyYWdYLCBkcmFnWSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRIdWUgPSBwYXJzZUZsb2F0KGRyYWdZIC8gc2xpZGVIZWlnaHQpO1xuICAgICAgICAgICAgICAgIGlzRW1wdHkgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAoIW9wdHMuc2hvd0FscGhhKSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRBbHBoYSA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG1vdmUoKTtcbiAgICAgICAgICAgIH0sIGRyYWdTdGFydCwgZHJhZ1N0b3ApO1xuXG4gICAgICAgICAgICBkcmFnZ2FibGUoZHJhZ2dlciwgZnVuY3Rpb24gKGRyYWdYLCBkcmFnWSwgZSkge1xuXG4gICAgICAgICAgICAgICAgLy8gc2hpZnQrZHJhZyBzaG91bGQgc25hcCB0aGUgbW92ZW1lbnQgdG8gZWl0aGVyIHRoZSB4IG9yIHkgYXhpcy5cbiAgICAgICAgICAgICAgICBpZiAoIWUuc2hpZnRLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2hpZnRNb3ZlbWVudERpcmVjdGlvbiA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFzaGlmdE1vdmVtZW50RGlyZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvbGREcmFnWCA9IGN1cnJlbnRTYXR1cmF0aW9uICogZHJhZ1dpZHRoO1xuICAgICAgICAgICAgICAgICAgICB2YXIgb2xkRHJhZ1kgPSBkcmFnSGVpZ2h0IC0gKGN1cnJlbnRWYWx1ZSAqIGRyYWdIZWlnaHQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZnVydGhlckZyb21YID0gTWF0aC5hYnMoZHJhZ1ggLSBvbGREcmFnWCkgPiBNYXRoLmFicyhkcmFnWSAtIG9sZERyYWdZKTtcblxuICAgICAgICAgICAgICAgICAgICBzaGlmdE1vdmVtZW50RGlyZWN0aW9uID0gZnVydGhlckZyb21YID8gXCJ4XCIgOiBcInlcIjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgc2V0U2F0dXJhdGlvbiA9ICFzaGlmdE1vdmVtZW50RGlyZWN0aW9uIHx8IHNoaWZ0TW92ZW1lbnREaXJlY3Rpb24gPT09IFwieFwiO1xuICAgICAgICAgICAgICAgIHZhciBzZXRWYWx1ZSA9ICFzaGlmdE1vdmVtZW50RGlyZWN0aW9uIHx8IHNoaWZ0TW92ZW1lbnREaXJlY3Rpb24gPT09IFwieVwiO1xuXG4gICAgICAgICAgICAgICAgaWYgKHNldFNhdHVyYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFNhdHVyYXRpb24gPSBwYXJzZUZsb2F0KGRyYWdYIC8gZHJhZ1dpZHRoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHNldFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRWYWx1ZSA9IHBhcnNlRmxvYXQoKGRyYWdIZWlnaHQgLSBkcmFnWSkgLyBkcmFnSGVpZ2h0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpc0VtcHR5ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKCFvcHRzLnNob3dBbHBoYSkge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50QWxwaGEgPSAxO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIG1vdmUoKTtcblxuICAgICAgICAgICAgfSwgZHJhZ1N0YXJ0LCBkcmFnU3RvcCk7XG5cbiAgICAgICAgICAgIGlmICghIWluaXRpYWxDb2xvcikge1xuICAgICAgICAgICAgICAgIHNldChpbml0aWFsQ29sb3IpO1xuXG4gICAgICAgICAgICAgICAgLy8gSW4gY2FzZSBjb2xvciB3YXMgYmxhY2sgLSB1cGRhdGUgdGhlIHByZXZpZXcgVUkgYW5kIHNldCB0aGUgZm9ybWF0XG4gICAgICAgICAgICAgICAgLy8gc2luY2UgdGhlIHNldCBmdW5jdGlvbiB3aWxsIG5vdCBydW4gKGRlZmF1bHQgY29sb3IgaXMgYmxhY2spLlxuICAgICAgICAgICAgICAgIHVwZGF0ZVVJKCk7XG4gICAgICAgICAgICAgICAgY3VycmVudFByZWZlcnJlZEZvcm1hdCA9IHByZWZlcnJlZEZvcm1hdCB8fCB0aW55Y29sb3IoaW5pdGlhbENvbG9yKS5mb3JtYXQ7XG5cbiAgICAgICAgICAgICAgICBhZGRDb2xvclRvU2VsZWN0aW9uUGFsZXR0ZShpbml0aWFsQ29sb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdXBkYXRlVUkoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGZsYXQpIHtcbiAgICAgICAgICAgICAgICBzaG93KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHBhbGV0dGVFbGVtZW50Q2xpY2soZSkge1xuICAgICAgICAgICAgICAgIGlmIChlLmRhdGEgJiYgZS5kYXRhLmlnbm9yZSkge1xuICAgICAgICAgICAgICAgICAgICBzZXQoJChlLnRhcmdldCkuY2xvc2VzdChcIi5zcC10aHVtYi1lbFwiKS5kYXRhKFwiY29sb3JcIikpO1xuICAgICAgICAgICAgICAgICAgICBtb3ZlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzZXQoJChlLnRhcmdldCkuY2xvc2VzdChcIi5zcC10aHVtYi1lbFwiKS5kYXRhKFwiY29sb3JcIikpO1xuICAgICAgICAgICAgICAgICAgICBtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZU9yaWdpbmFsSW5wdXQodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRzLmhpZGVBZnRlclBhbGV0dGVTZWxlY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICBoaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBwYWxldHRlRXZlbnQgPSBJRSA/IFwibW91c2Vkb3duLnNwZWN0cnVtXCIgOiBcImNsaWNrLnNwZWN0cnVtIHRvdWNoc3RhcnQuc3BlY3RydW1cIjtcbiAgICAgICAgICAgIHBhbGV0dGVDb250YWluZXIuZGVsZWdhdGUoXCIuc3AtdGh1bWItZWxcIiwgcGFsZXR0ZUV2ZW50LCBwYWxldHRlRWxlbWVudENsaWNrKTtcbiAgICAgICAgICAgIGluaXRpYWxDb2xvckNvbnRhaW5lci5kZWxlZ2F0ZShcIi5zcC10aHVtYi1lbDpudGgtY2hpbGQoMSlcIiwgcGFsZXR0ZUV2ZW50LCB7IGlnbm9yZTogdHJ1ZSB9LCBwYWxldHRlRWxlbWVudENsaWNrKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVNlbGVjdGlvblBhbGV0dGVGcm9tU3RvcmFnZSgpIHtcblxuICAgICAgICAgICAgaWYgKGxvY2FsU3RvcmFnZUtleSAmJiB3aW5kb3cubG9jYWxTdG9yYWdlKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBNaWdyYXRlIG9sZCBwYWxldHRlcyBvdmVyIHRvIG5ldyBmb3JtYXQuICBNYXkgd2FudCB0byByZW1vdmUgdGhpcyBldmVudHVhbGx5LlxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvbGRQYWxldHRlID0gd2luZG93LmxvY2FsU3RvcmFnZVtsb2NhbFN0b3JhZ2VLZXldLnNwbGl0KFwiLCNcIik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvbGRQYWxldHRlLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB3aW5kb3cubG9jYWxTdG9yYWdlW2xvY2FsU3RvcmFnZUtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2gob2xkUGFsZXR0ZSwgZnVuY3Rpb24oaSwgYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRDb2xvclRvU2VsZWN0aW9uUGFsZXR0ZShjKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoKGUpIHsgfVxuXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uUGFsZXR0ZSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2VbbG9jYWxTdG9yYWdlS2V5XS5zcGxpdChcIjtcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7IH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGFkZENvbG9yVG9TZWxlY3Rpb25QYWxldHRlKGNvbG9yKSB7XG4gICAgICAgICAgICBpZiAoc2hvd1NlbGVjdGlvblBhbGV0dGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmdiID0gdGlueWNvbG9yKGNvbG9yKS50b1JnYlN0cmluZygpO1xuICAgICAgICAgICAgICAgIGlmICghcGFsZXR0ZUxvb2t1cFtyZ2JdICYmICQuaW5BcnJheShyZ2IsIHNlbGVjdGlvblBhbGV0dGUpID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb25QYWxldHRlLnB1c2gocmdiKTtcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUoc2VsZWN0aW9uUGFsZXR0ZS5sZW5ndGggPiBtYXhTZWxlY3Rpb25TaXplKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb25QYWxldHRlLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAobG9jYWxTdG9yYWdlS2V5ICYmIHdpbmRvdy5sb2NhbFN0b3JhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2VbbG9jYWxTdG9yYWdlS2V5XSA9IHNlbGVjdGlvblBhbGV0dGUuam9pbihcIjtcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2goZSkgeyB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0VW5pcXVlU2VsZWN0aW9uUGFsZXR0ZSgpIHtcbiAgICAgICAgICAgIHZhciB1bmlxdWUgPSBbXTtcbiAgICAgICAgICAgIGlmIChvcHRzLnNob3dQYWxldHRlKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxlY3Rpb25QYWxldHRlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZ2IgPSB0aW55Y29sb3Ioc2VsZWN0aW9uUGFsZXR0ZVtpXSkudG9SZ2JTdHJpbmcoKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIXBhbGV0dGVMb29rdXBbcmdiXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdW5pcXVlLnB1c2goc2VsZWN0aW9uUGFsZXR0ZVtpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB1bmlxdWUucmV2ZXJzZSgpLnNsaWNlKDAsIG9wdHMubWF4U2VsZWN0aW9uU2l6ZSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkcmF3UGFsZXR0ZSgpIHtcblxuICAgICAgICAgICAgdmFyIGN1cnJlbnRDb2xvciA9IGdldCgpO1xuXG4gICAgICAgICAgICB2YXIgaHRtbCA9ICQubWFwKHBhbGV0dGVBcnJheSwgZnVuY3Rpb24gKHBhbGV0dGUsIGkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFsZXR0ZVRlbXBsYXRlKHBhbGV0dGUsIGN1cnJlbnRDb2xvciwgXCJzcC1wYWxldHRlLXJvdyBzcC1wYWxldHRlLXJvdy1cIiArIGksIG9wdHMpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHVwZGF0ZVNlbGVjdGlvblBhbGV0dGVGcm9tU3RvcmFnZSgpO1xuXG4gICAgICAgICAgICBpZiAoc2VsZWN0aW9uUGFsZXR0ZSkge1xuICAgICAgICAgICAgICAgIGh0bWwucHVzaChwYWxldHRlVGVtcGxhdGUoZ2V0VW5pcXVlU2VsZWN0aW9uUGFsZXR0ZSgpLCBjdXJyZW50Q29sb3IsIFwic3AtcGFsZXR0ZS1yb3cgc3AtcGFsZXR0ZS1yb3ctc2VsZWN0aW9uXCIsIG9wdHMpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcGFsZXR0ZUNvbnRhaW5lci5odG1sKGh0bWwuam9pbihcIlwiKSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkcmF3SW5pdGlhbCgpIHtcbiAgICAgICAgICAgIGlmIChvcHRzLnNob3dJbml0aWFsKSB7XG4gICAgICAgICAgICAgICAgdmFyIGluaXRpYWwgPSBjb2xvck9uU2hvdztcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudCA9IGdldCgpO1xuICAgICAgICAgICAgICAgIGluaXRpYWxDb2xvckNvbnRhaW5lci5odG1sKHBhbGV0dGVUZW1wbGF0ZShbaW5pdGlhbCwgY3VycmVudF0sIGN1cnJlbnQsIFwic3AtcGFsZXR0ZS1yb3ctaW5pdGlhbFwiLCBvcHRzKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkcmFnU3RhcnQoKSB7XG4gICAgICAgICAgICBpZiAoZHJhZ0hlaWdodCA8PSAwIHx8IGRyYWdXaWR0aCA8PSAwIHx8IHNsaWRlSGVpZ2h0IDw9IDApIHtcbiAgICAgICAgICAgICAgICByZWZsb3coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRhaW5lci5hZGRDbGFzcyhkcmFnZ2luZ0NsYXNzKTtcbiAgICAgICAgICAgIHNoaWZ0TW92ZW1lbnREaXJlY3Rpb24gPSBudWxsO1xuICAgICAgICAgICAgYm91bmRFbGVtZW50LnRyaWdnZXIoJ2RyYWdzdGFydC5zcGVjdHJ1bScsIFsgZ2V0KCkgXSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkcmFnU3RvcCgpIHtcbiAgICAgICAgICAgIGNvbnRhaW5lci5yZW1vdmVDbGFzcyhkcmFnZ2luZ0NsYXNzKTtcbiAgICAgICAgICAgIGJvdW5kRWxlbWVudC50cmlnZ2VyKCdkcmFnc3RvcC5zcGVjdHJ1bScsIFsgZ2V0KCkgXSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRGcm9tVGV4dElucHV0KCkge1xuXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSB0ZXh0SW5wdXQudmFsKCk7XG5cbiAgICAgICAgICAgIGlmICgodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IFwiXCIpICYmIGFsbG93RW1wdHkpIHtcbiAgICAgICAgICAgICAgICBzZXQobnVsbCk7XG4gICAgICAgICAgICAgICAgdXBkYXRlT3JpZ2luYWxJbnB1dCh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciB0aW55ID0gdGlueWNvbG9yKHZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAodGlueS5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0KHRpbnkpO1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVPcmlnaW5hbElucHV0KHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dElucHV0LmFkZENsYXNzKFwic3AtdmFsaWRhdGlvbi1lcnJvclwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB0b2dnbGUoKSB7XG4gICAgICAgICAgICBpZiAodmlzaWJsZSkge1xuICAgICAgICAgICAgICAgIGhpZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHNob3coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNob3coKSB7XG4gICAgICAgICAgICB2YXIgZXZlbnQgPSAkLkV2ZW50KCdiZWZvcmVTaG93LnNwZWN0cnVtJyk7XG5cbiAgICAgICAgICAgIGlmICh2aXNpYmxlKSB7XG4gICAgICAgICAgICAgICAgcmVmbG93KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBib3VuZEVsZW1lbnQudHJpZ2dlcihldmVudCwgWyBnZXQoKSBdKTtcblxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrcy5iZWZvcmVTaG93KGdldCgpKSA9PT0gZmFsc2UgfHwgZXZlbnQuaXNEZWZhdWx0UHJldmVudGVkKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGhpZGVBbGwoKTtcbiAgICAgICAgICAgIHZpc2libGUgPSB0cnVlO1xuXG4gICAgICAgICAgICAkKGRvYykuYmluZChcImNsaWNrLnNwZWN0cnVtXCIsIGNsaWNrb3V0KTtcbiAgICAgICAgICAgICQod2luZG93KS5iaW5kKFwicmVzaXplLnNwZWN0cnVtXCIsIHJlc2l6ZSk7XG4gICAgICAgICAgICByZXBsYWNlci5hZGRDbGFzcyhcInNwLWFjdGl2ZVwiKTtcbiAgICAgICAgICAgIGNvbnRhaW5lci5yZW1vdmVDbGFzcyhcInNwLWhpZGRlblwiKTtcblxuICAgICAgICAgICAgcmVmbG93KCk7XG4gICAgICAgICAgICB1cGRhdGVVSSgpO1xuXG4gICAgICAgICAgICBjb2xvck9uU2hvdyA9IGdldCgpO1xuXG4gICAgICAgICAgICBkcmF3SW5pdGlhbCgpO1xuICAgICAgICAgICAgY2FsbGJhY2tzLnNob3coY29sb3JPblNob3cpO1xuICAgICAgICAgICAgYm91bmRFbGVtZW50LnRyaWdnZXIoJ3Nob3cuc3BlY3RydW0nLCBbIGNvbG9yT25TaG93IF0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY2xpY2tvdXQoZSkge1xuICAgICAgICAgICAgLy8gUmV0dXJuIG9uIHJpZ2h0IGNsaWNrLlxuICAgICAgICAgICAgaWYgKGUuYnV0dG9uID09IDIpIHsgcmV0dXJuOyB9XG5cbiAgICAgICAgICAgIGlmIChjbGlja291dEZpcmVzQ2hhbmdlKSB7XG4gICAgICAgICAgICAgICAgdXBkYXRlT3JpZ2luYWxJbnB1dCh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldmVydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaGlkZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaGlkZSgpIHtcbiAgICAgICAgICAgIC8vIFJldHVybiBpZiBoaWRpbmcgaXMgdW5uZWNlc3NhcnlcbiAgICAgICAgICAgIGlmICghdmlzaWJsZSB8fCBmbGF0KSB7IHJldHVybjsgfVxuICAgICAgICAgICAgdmlzaWJsZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICAkKGRvYykudW5iaW5kKFwiY2xpY2suc3BlY3RydW1cIiwgY2xpY2tvdXQpO1xuICAgICAgICAgICAgJCh3aW5kb3cpLnVuYmluZChcInJlc2l6ZS5zcGVjdHJ1bVwiLCByZXNpemUpO1xuXG4gICAgICAgICAgICByZXBsYWNlci5yZW1vdmVDbGFzcyhcInNwLWFjdGl2ZVwiKTtcbiAgICAgICAgICAgIGNvbnRhaW5lci5hZGRDbGFzcyhcInNwLWhpZGRlblwiKTtcblxuICAgICAgICAgICAgY2FsbGJhY2tzLmhpZGUoZ2V0KCkpO1xuICAgICAgICAgICAgYm91bmRFbGVtZW50LnRyaWdnZXIoJ2hpZGUuc3BlY3RydW0nLCBbIGdldCgpIF0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcmV2ZXJ0KCkge1xuICAgICAgICAgICAgc2V0KGNvbG9yT25TaG93LCB0cnVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldChjb2xvciwgaWdub3JlRm9ybWF0Q2hhbmdlKSB7XG4gICAgICAgICAgICBpZiAodGlueWNvbG9yLmVxdWFscyhjb2xvciwgZ2V0KCkpKSB7XG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIFVJIGp1c3QgaW4gY2FzZSBhIHZhbGlkYXRpb24gZXJyb3IgbmVlZHNcbiAgICAgICAgICAgICAgICAvLyB0byBiZSBjbGVhcmVkLlxuICAgICAgICAgICAgICAgIHVwZGF0ZVVJKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgbmV3Q29sb3IsIG5ld0hzdjtcbiAgICAgICAgICAgIGlmICghY29sb3IgJiYgYWxsb3dFbXB0eSkge1xuICAgICAgICAgICAgICAgIGlzRW1wdHkgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpc0VtcHR5ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbmV3Q29sb3IgPSB0aW55Y29sb3IoY29sb3IpO1xuICAgICAgICAgICAgICAgIG5ld0hzdiA9IG5ld0NvbG9yLnRvSHN2KCk7XG5cbiAgICAgICAgICAgICAgICBjdXJyZW50SHVlID0gKG5ld0hzdi5oICUgMzYwKSAvIDM2MDtcbiAgICAgICAgICAgICAgICBjdXJyZW50U2F0dXJhdGlvbiA9IG5ld0hzdi5zO1xuICAgICAgICAgICAgICAgIGN1cnJlbnRWYWx1ZSA9IG5ld0hzdi52O1xuICAgICAgICAgICAgICAgIGN1cnJlbnRBbHBoYSA9IG5ld0hzdi5hO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdXBkYXRlVUkoKTtcblxuICAgICAgICAgICAgaWYgKG5ld0NvbG9yICYmIG5ld0NvbG9yLmlzVmFsaWQoKSAmJiAhaWdub3JlRm9ybWF0Q2hhbmdlKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFByZWZlcnJlZEZvcm1hdCA9IHByZWZlcnJlZEZvcm1hdCB8fCBuZXdDb2xvci5nZXRGb3JtYXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldChvcHRzKSB7XG4gICAgICAgICAgICBvcHRzID0gb3B0cyB8fCB7IH07XG5cbiAgICAgICAgICAgIGlmIChhbGxvd0VtcHR5ICYmIGlzRW1wdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRpbnljb2xvci5mcm9tUmF0aW8oe1xuICAgICAgICAgICAgICAgIGg6IGN1cnJlbnRIdWUsXG4gICAgICAgICAgICAgICAgczogY3VycmVudFNhdHVyYXRpb24sXG4gICAgICAgICAgICAgICAgdjogY3VycmVudFZhbHVlLFxuICAgICAgICAgICAgICAgIGE6IE1hdGgucm91bmQoY3VycmVudEFscGhhICogMTAwKSAvIDEwMFxuICAgICAgICAgICAgfSwgeyBmb3JtYXQ6IG9wdHMuZm9ybWF0IHx8IGN1cnJlbnRQcmVmZXJyZWRGb3JtYXQgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpc1ZhbGlkKCkge1xuICAgICAgICAgICAgcmV0dXJuICF0ZXh0SW5wdXQuaGFzQ2xhc3MoXCJzcC12YWxpZGF0aW9uLWVycm9yXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gbW92ZSgpIHtcbiAgICAgICAgICAgIHVwZGF0ZVVJKCk7XG5cbiAgICAgICAgICAgIGNhbGxiYWNrcy5tb3ZlKGdldCgpKTtcbiAgICAgICAgICAgIGJvdW5kRWxlbWVudC50cmlnZ2VyKCdtb3ZlLnNwZWN0cnVtJywgWyBnZXQoKSBdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVVJKCkge1xuXG4gICAgICAgICAgICB0ZXh0SW5wdXQucmVtb3ZlQ2xhc3MoXCJzcC12YWxpZGF0aW9uLWVycm9yXCIpO1xuXG4gICAgICAgICAgICB1cGRhdGVIZWxwZXJMb2NhdGlvbnMoKTtcblxuICAgICAgICAgICAgLy8gVXBkYXRlIGRyYWdnZXIgYmFja2dyb3VuZCBjb2xvciAoZ3JhZGllbnRzIHRha2UgY2FyZSBvZiBzYXR1cmF0aW9uIGFuZCB2YWx1ZSkuXG4gICAgICAgICAgICB2YXIgZmxhdENvbG9yID0gdGlueWNvbG9yLmZyb21SYXRpbyh7IGg6IGN1cnJlbnRIdWUsIHM6IDEsIHY6IDEgfSk7XG4gICAgICAgICAgICBkcmFnZ2VyLmNzcyhcImJhY2tncm91bmQtY29sb3JcIiwgZmxhdENvbG9yLnRvSGV4U3RyaW5nKCkpO1xuXG4gICAgICAgICAgICAvLyBHZXQgYSBmb3JtYXQgdGhhdCBhbHBoYSB3aWxsIGJlIGluY2x1ZGVkIGluIChoZXggYW5kIG5hbWVzIGlnbm9yZSBhbHBoYSlcbiAgICAgICAgICAgIHZhciBmb3JtYXQgPSBjdXJyZW50UHJlZmVycmVkRm9ybWF0O1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRBbHBoYSA8IDEgJiYgIShjdXJyZW50QWxwaGEgPT09IDAgJiYgZm9ybWF0ID09PSBcIm5hbWVcIikpIHtcbiAgICAgICAgICAgICAgICBpZiAoZm9ybWF0ID09PSBcImhleFwiIHx8IGZvcm1hdCA9PT0gXCJoZXgzXCIgfHwgZm9ybWF0ID09PSBcImhleDZcIiB8fCBmb3JtYXQgPT09IFwibmFtZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvcm1hdCA9IFwicmdiXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgcmVhbENvbG9yID0gZ2V0KHsgZm9ybWF0OiBmb3JtYXQgfSksXG4gICAgICAgICAgICAgICAgZGlzcGxheUNvbG9yID0gJyc7XG5cbiAgICAgICAgICAgICAvL3Jlc2V0IGJhY2tncm91bmQgaW5mbyBmb3IgcHJldmlldyBlbGVtZW50XG4gICAgICAgICAgICBwcmV2aWV3RWxlbWVudC5yZW1vdmVDbGFzcyhcInNwLWNsZWFyLWRpc3BsYXlcIik7XG4gICAgICAgICAgICBwcmV2aWV3RWxlbWVudC5jc3MoJ2JhY2tncm91bmQtY29sb3InLCAndHJhbnNwYXJlbnQnKTtcblxuICAgICAgICAgICAgaWYgKCFyZWFsQ29sb3IgJiYgYWxsb3dFbXB0eSkge1xuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgcmVwbGFjZWQgZWxlbWVudHMgYmFja2dyb3VuZCB3aXRoIGljb24gaW5kaWNhdGluZyBubyBjb2xvciBzZWxlY3Rpb25cbiAgICAgICAgICAgICAgICBwcmV2aWV3RWxlbWVudC5hZGRDbGFzcyhcInNwLWNsZWFyLWRpc3BsYXlcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVhbEhleCA9IHJlYWxDb2xvci50b0hleFN0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICByZWFsUmdiID0gcmVhbENvbG9yLnRvUmdiU3RyaW5nKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGhlIHJlcGxhY2VkIGVsZW1lbnRzIGJhY2tncm91bmQgY29sb3IgKHdpdGggYWN0dWFsIHNlbGVjdGVkIGNvbG9yKVxuICAgICAgICAgICAgICAgIGlmIChyZ2JhU3VwcG9ydCB8fCByZWFsQ29sb3IuYWxwaGEgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld0VsZW1lbnQuY3NzKFwiYmFja2dyb3VuZC1jb2xvclwiLCByZWFsUmdiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXdFbGVtZW50LmNzcyhcImJhY2tncm91bmQtY29sb3JcIiwgXCJ0cmFuc3BhcmVudFwiKTtcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld0VsZW1lbnQuY3NzKFwiZmlsdGVyXCIsIHJlYWxDb2xvci50b0ZpbHRlcigpKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAob3B0cy5zaG93QWxwaGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJnYiA9IHJlYWxDb2xvci50b1JnYigpO1xuICAgICAgICAgICAgICAgICAgICByZ2IuYSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZWFsQWxwaGEgPSB0aW55Y29sb3IocmdiKS50b1JnYlN0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JhZGllbnQgPSBcImxpbmVhci1ncmFkaWVudChsZWZ0LCBcIiArIHJlYWxBbHBoYSArIFwiLCBcIiArIHJlYWxIZXggKyBcIilcIjtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoSUUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhU2xpZGVySW5uZXIuY3NzKFwiZmlsdGVyXCIsIHRpbnljb2xvcihyZWFsQWxwaGEpLnRvRmlsdGVyKHsgZ3JhZGllbnRUeXBlOiAxIH0sIHJlYWxIZXgpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhU2xpZGVySW5uZXIuY3NzKFwiYmFja2dyb3VuZFwiLCBcIi13ZWJraXQtXCIgKyBncmFkaWVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbHBoYVNsaWRlcklubmVyLmNzcyhcImJhY2tncm91bmRcIiwgXCItbW96LVwiICsgZ3JhZGllbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGFTbGlkZXJJbm5lci5jc3MoXCJiYWNrZ3JvdW5kXCIsIFwiLW1zLVwiICsgZ3JhZGllbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXNlIGN1cnJlbnQgc3ludGF4IGdyYWRpZW50IG9uIHVucHJlZml4ZWQgcHJvcGVydHkuXG4gICAgICAgICAgICAgICAgICAgICAgICBhbHBoYVNsaWRlcklubmVyLmNzcyhcImJhY2tncm91bmRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxpbmVhci1ncmFkaWVudCh0byByaWdodCwgXCIgKyByZWFsQWxwaGEgKyBcIiwgXCIgKyByZWFsSGV4ICsgXCIpXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZGlzcGxheUNvbG9yID0gcmVhbENvbG9yLnRvU3RyaW5nKGZvcm1hdCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgdGV4dCBlbnRyeSBpbnB1dCBhcyBpdCBjaGFuZ2VzIGhhcHBlblxuICAgICAgICAgICAgaWYgKG9wdHMuc2hvd0lucHV0KSB7XG4gICAgICAgICAgICAgICAgdGV4dElucHV0LnZhbChkaXNwbGF5Q29sb3IpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAob3B0cy5zaG93UGFsZXR0ZSkge1xuICAgICAgICAgICAgICAgIGRyYXdQYWxldHRlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGRyYXdJbml0aWFsKCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVIZWxwZXJMb2NhdGlvbnMoKSB7XG4gICAgICAgICAgICB2YXIgcyA9IGN1cnJlbnRTYXR1cmF0aW9uO1xuICAgICAgICAgICAgdmFyIHYgPSBjdXJyZW50VmFsdWU7XG5cbiAgICAgICAgICAgIGlmKGFsbG93RW1wdHkgJiYgaXNFbXB0eSkge1xuICAgICAgICAgICAgICAgIC8vaWYgc2VsZWN0ZWQgY29sb3IgaXMgZW1wdHksIGhpZGUgdGhlIGhlbHBlcnNcbiAgICAgICAgICAgICAgICBhbHBoYVNsaWRlSGVscGVyLmhpZGUoKTtcbiAgICAgICAgICAgICAgICBzbGlkZUhlbHBlci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgZHJhZ0hlbHBlci5oaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvL21ha2Ugc3VyZSBoZWxwZXJzIGFyZSB2aXNpYmxlXG4gICAgICAgICAgICAgICAgYWxwaGFTbGlkZUhlbHBlci5zaG93KCk7XG4gICAgICAgICAgICAgICAgc2xpZGVIZWxwZXIuc2hvdygpO1xuICAgICAgICAgICAgICAgIGRyYWdIZWxwZXIuc2hvdygpO1xuXG4gICAgICAgICAgICAgICAgLy8gV2hlcmUgdG8gc2hvdyB0aGUgbGl0dGxlIGNpcmNsZSBpbiB0aGF0IGRpc3BsYXlzIHlvdXIgY3VycmVudCBzZWxlY3RlZCBjb2xvclxuICAgICAgICAgICAgICAgIHZhciBkcmFnWCA9IHMgKiBkcmFnV2lkdGg7XG4gICAgICAgICAgICAgICAgdmFyIGRyYWdZID0gZHJhZ0hlaWdodCAtICh2ICogZHJhZ0hlaWdodCk7XG4gICAgICAgICAgICAgICAgZHJhZ1ggPSBNYXRoLm1heChcbiAgICAgICAgICAgICAgICAgICAgLWRyYWdIZWxwZXJIZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgIE1hdGgubWluKGRyYWdXaWR0aCAtIGRyYWdIZWxwZXJIZWlnaHQsIGRyYWdYIC0gZHJhZ0hlbHBlckhlaWdodClcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGRyYWdZID0gTWF0aC5tYXgoXG4gICAgICAgICAgICAgICAgICAgIC1kcmFnSGVscGVySGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICBNYXRoLm1pbihkcmFnSGVpZ2h0IC0gZHJhZ0hlbHBlckhlaWdodCwgZHJhZ1kgLSBkcmFnSGVscGVySGVpZ2h0KVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgZHJhZ0hlbHBlci5jc3Moe1xuICAgICAgICAgICAgICAgICAgICBcInRvcFwiOiBkcmFnWSArIFwicHhcIixcbiAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCI6IGRyYWdYICsgXCJweFwiXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYWxwaGFYID0gY3VycmVudEFscGhhICogYWxwaGFXaWR0aDtcbiAgICAgICAgICAgICAgICBhbHBoYVNsaWRlSGVscGVyLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgIFwibGVmdFwiOiAoYWxwaGFYIC0gKGFscGhhU2xpZGVIZWxwZXJXaWR0aCAvIDIpKSArIFwicHhcIlxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8gV2hlcmUgdG8gc2hvdyB0aGUgYmFyIHRoYXQgZGlzcGxheXMgeW91ciBjdXJyZW50IHNlbGVjdGVkIGh1ZVxuICAgICAgICAgICAgICAgIHZhciBzbGlkZVkgPSAoY3VycmVudEh1ZSkgKiBzbGlkZUhlaWdodDtcbiAgICAgICAgICAgICAgICBzbGlkZUhlbHBlci5jc3Moe1xuICAgICAgICAgICAgICAgICAgICBcInRvcFwiOiAoc2xpZGVZIC0gc2xpZGVIZWxwZXJIZWlnaHQpICsgXCJweFwiXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVPcmlnaW5hbElucHV0KGZpcmVDYWxsYmFjaykge1xuICAgICAgICAgICAgdmFyIGNvbG9yID0gZ2V0KCksXG4gICAgICAgICAgICAgICAgZGlzcGxheUNvbG9yID0gJycsXG4gICAgICAgICAgICAgICAgaGFzQ2hhbmdlZCA9ICF0aW55Y29sb3IuZXF1YWxzKGNvbG9yLCBjb2xvck9uU2hvdyk7XG5cbiAgICAgICAgICAgIGlmIChjb2xvcikge1xuICAgICAgICAgICAgICAgIGRpc3BsYXlDb2xvciA9IGNvbG9yLnRvU3RyaW5nKGN1cnJlbnRQcmVmZXJyZWRGb3JtYXQpO1xuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgc2VsZWN0aW9uIHBhbGV0dGUgd2l0aCB0aGUgY3VycmVudCBjb2xvclxuICAgICAgICAgICAgICAgIGFkZENvbG9yVG9TZWxlY3Rpb25QYWxldHRlKGNvbG9yKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGlzSW5wdXQpIHtcbiAgICAgICAgICAgICAgICBib3VuZEVsZW1lbnQudmFsKGRpc3BsYXlDb2xvcik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChmaXJlQ2FsbGJhY2sgJiYgaGFzQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrcy5jaGFuZ2UoY29sb3IpO1xuICAgICAgICAgICAgICAgIGJvdW5kRWxlbWVudC50cmlnZ2VyKCdjaGFuZ2UnLCBbIGNvbG9yIF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcmVmbG93KCkge1xuICAgICAgICAgICAgZHJhZ1dpZHRoID0gZHJhZ2dlci53aWR0aCgpO1xuICAgICAgICAgICAgZHJhZ0hlaWdodCA9IGRyYWdnZXIuaGVpZ2h0KCk7XG4gICAgICAgICAgICBkcmFnSGVscGVySGVpZ2h0ID0gZHJhZ0hlbHBlci5oZWlnaHQoKTtcbiAgICAgICAgICAgIHNsaWRlV2lkdGggPSBzbGlkZXIud2lkdGgoKTtcbiAgICAgICAgICAgIHNsaWRlSGVpZ2h0ID0gc2xpZGVyLmhlaWdodCgpO1xuICAgICAgICAgICAgc2xpZGVIZWxwZXJIZWlnaHQgPSBzbGlkZUhlbHBlci5oZWlnaHQoKTtcbiAgICAgICAgICAgIGFscGhhV2lkdGggPSBhbHBoYVNsaWRlci53aWR0aCgpO1xuICAgICAgICAgICAgYWxwaGFTbGlkZUhlbHBlcldpZHRoID0gYWxwaGFTbGlkZUhlbHBlci53aWR0aCgpO1xuXG4gICAgICAgICAgICBpZiAoIWZsYXQpIHtcbiAgICAgICAgICAgICAgICBjb250YWluZXIuY3NzKFwicG9zaXRpb25cIiwgXCJhYnNvbHV0ZVwiKTtcbiAgICAgICAgICAgICAgICBpZiAob3B0cy5vZmZzZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLm9mZnNldChvcHRzLm9mZnNldCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLm9mZnNldChnZXRPZmZzZXQoY29udGFpbmVyLCBvZmZzZXRFbGVtZW50KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB1cGRhdGVIZWxwZXJMb2NhdGlvbnMoKTtcblxuICAgICAgICAgICAgaWYgKG9wdHMuc2hvd1BhbGV0dGUpIHtcbiAgICAgICAgICAgICAgICBkcmF3UGFsZXR0ZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBib3VuZEVsZW1lbnQudHJpZ2dlcigncmVmbG93LnNwZWN0cnVtJyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICAgICAgYm91bmRFbGVtZW50LnNob3coKTtcbiAgICAgICAgICAgIG9mZnNldEVsZW1lbnQudW5iaW5kKFwiY2xpY2suc3BlY3RydW0gdG91Y2hzdGFydC5zcGVjdHJ1bVwiKTtcbiAgICAgICAgICAgIGNvbnRhaW5lci5yZW1vdmUoKTtcbiAgICAgICAgICAgIHJlcGxhY2VyLnJlbW92ZSgpO1xuICAgICAgICAgICAgc3BlY3RydW1zW3NwZWN0LmlkXSA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBvcHRpb24ob3B0aW9uTmFtZSwgb3B0aW9uVmFsdWUpIHtcbiAgICAgICAgICAgIGlmIChvcHRpb25OYW1lID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJC5leHRlbmQoe30sIG9wdHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wdGlvblZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb3B0c1tvcHRpb25OYW1lXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgb3B0c1tvcHRpb25OYW1lXSA9IG9wdGlvblZhbHVlO1xuICAgICAgICAgICAgYXBwbHlPcHRpb25zKCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBlbmFibGUoKSB7XG4gICAgICAgICAgICBkaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgYm91bmRFbGVtZW50LmF0dHIoXCJkaXNhYmxlZFwiLCBmYWxzZSk7XG4gICAgICAgICAgICBvZmZzZXRFbGVtZW50LnJlbW92ZUNsYXNzKFwic3AtZGlzYWJsZWRcIik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkaXNhYmxlKCkge1xuICAgICAgICAgICAgaGlkZSgpO1xuICAgICAgICAgICAgZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgYm91bmRFbGVtZW50LmF0dHIoXCJkaXNhYmxlZFwiLCB0cnVlKTtcbiAgICAgICAgICAgIG9mZnNldEVsZW1lbnQuYWRkQ2xhc3MoXCJzcC1kaXNhYmxlZFwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldE9mZnNldChjb29yZCkge1xuICAgICAgICAgICAgb3B0cy5vZmZzZXQgPSBjb29yZDtcbiAgICAgICAgICAgIHJlZmxvdygpO1xuICAgICAgICB9XG5cbiAgICAgICAgaW5pdGlhbGl6ZSgpO1xuXG4gICAgICAgIHZhciBzcGVjdCA9IHtcbiAgICAgICAgICAgIHNob3c6IHNob3csXG4gICAgICAgICAgICBoaWRlOiBoaWRlLFxuICAgICAgICAgICAgdG9nZ2xlOiB0b2dnbGUsXG4gICAgICAgICAgICByZWZsb3c6IHJlZmxvdyxcbiAgICAgICAgICAgIG9wdGlvbjogb3B0aW9uLFxuICAgICAgICAgICAgZW5hYmxlOiBlbmFibGUsXG4gICAgICAgICAgICBkaXNhYmxlOiBkaXNhYmxlLFxuICAgICAgICAgICAgb2Zmc2V0OiBzZXRPZmZzZXQsXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIChjKSB7XG4gICAgICAgICAgICAgICAgc2V0KGMpO1xuICAgICAgICAgICAgICAgIHVwZGF0ZU9yaWdpbmFsSW5wdXQoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXQ6IGdldCxcbiAgICAgICAgICAgIGRlc3Ryb3k6IGRlc3Ryb3ksXG4gICAgICAgICAgICBjb250YWluZXI6IGNvbnRhaW5lclxuICAgICAgICB9O1xuXG4gICAgICAgIHNwZWN0LmlkID0gc3BlY3RydW1zLnB1c2goc3BlY3QpIC0gMTtcblxuICAgICAgICByZXR1cm4gc3BlY3Q7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgKiBjaGVja09mZnNldCAtIGdldCB0aGUgb2Zmc2V0IGJlbG93L2Fib3ZlIGFuZCBsZWZ0L3JpZ2h0IGVsZW1lbnQgZGVwZW5kaW5nIG9uIHNjcmVlbiBwb3NpdGlvblxuICAgICogVGhhbmtzIGh0dHBzOi8vZ2l0aHViLmNvbS9qcXVlcnkvanF1ZXJ5LXVpL2Jsb2IvbWFzdGVyL3VpL2pxdWVyeS51aS5kYXRlcGlja2VyLmpzXG4gICAgKi9cbiAgICBmdW5jdGlvbiBnZXRPZmZzZXQocGlja2VyLCBpbnB1dCkge1xuICAgICAgICB2YXIgZXh0cmFZID0gMDtcbiAgICAgICAgdmFyIGRwV2lkdGggPSBwaWNrZXIub3V0ZXJXaWR0aCgpO1xuICAgICAgICB2YXIgZHBIZWlnaHQgPSBwaWNrZXIub3V0ZXJIZWlnaHQoKTtcbiAgICAgICAgdmFyIGlucHV0SGVpZ2h0ID0gaW5wdXQub3V0ZXJIZWlnaHQoKTtcbiAgICAgICAgdmFyIGRvYyA9IHBpY2tlclswXS5vd25lckRvY3VtZW50O1xuICAgICAgICB2YXIgZG9jRWxlbSA9IGRvYy5kb2N1bWVudEVsZW1lbnQ7XG4gICAgICAgIHZhciB2aWV3V2lkdGggPSBkb2NFbGVtLmNsaWVudFdpZHRoICsgJChkb2MpLnNjcm9sbExlZnQoKTtcbiAgICAgICAgdmFyIHZpZXdIZWlnaHQgPSBkb2NFbGVtLmNsaWVudEhlaWdodCArICQoZG9jKS5zY3JvbGxUb3AoKTtcbiAgICAgICAgdmFyIG9mZnNldCA9IGlucHV0Lm9mZnNldCgpO1xuICAgICAgICBvZmZzZXQudG9wICs9IGlucHV0SGVpZ2h0O1xuXG4gICAgICAgIG9mZnNldC5sZWZ0IC09XG4gICAgICAgICAgICBNYXRoLm1pbihvZmZzZXQubGVmdCwgKG9mZnNldC5sZWZ0ICsgZHBXaWR0aCA+IHZpZXdXaWR0aCAmJiB2aWV3V2lkdGggPiBkcFdpZHRoKSA/XG4gICAgICAgICAgICBNYXRoLmFicyhvZmZzZXQubGVmdCArIGRwV2lkdGggLSB2aWV3V2lkdGgpIDogMCk7XG5cbiAgICAgICAgb2Zmc2V0LnRvcCAtPVxuICAgICAgICAgICAgTWF0aC5taW4ob2Zmc2V0LnRvcCwgKChvZmZzZXQudG9wICsgZHBIZWlnaHQgPiB2aWV3SGVpZ2h0ICYmIHZpZXdIZWlnaHQgPiBkcEhlaWdodCkgP1xuICAgICAgICAgICAgTWF0aC5hYnMoZHBIZWlnaHQgKyBpbnB1dEhlaWdodCAtIGV4dHJhWSkgOiBleHRyYVkpKTtcblxuICAgICAgICByZXR1cm4gb2Zmc2V0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICogbm9vcCAtIGRvIG5vdGhpbmdcbiAgICAqL1xuICAgIGZ1bmN0aW9uIG5vb3AoKSB7XG5cbiAgICB9XG5cbiAgICAvKipcbiAgICAqIHN0b3BQcm9wYWdhdGlvbiAtIG1ha2VzIHRoZSBjb2RlIG9ubHkgZG9pbmcgdGhpcyBhIGxpdHRsZSBlYXNpZXIgdG8gcmVhZCBpbiBsaW5lXG4gICAgKi9cbiAgICBmdW5jdGlvbiBzdG9wUHJvcGFnYXRpb24oZSkge1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICogQ3JlYXRlIGEgZnVuY3Rpb24gYm91bmQgdG8gYSBnaXZlbiBvYmplY3RcbiAgICAqIFRoYW5rcyB0byB1bmRlcnNjb3JlLmpzXG4gICAgKi9cbiAgICBmdW5jdGlvbiBiaW5kKGZ1bmMsIG9iaikge1xuICAgICAgICB2YXIgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7XG4gICAgICAgIHZhciBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmMuYXBwbHkob2JqLCBhcmdzLmNvbmNhdChzbGljZS5jYWxsKGFyZ3VtZW50cykpKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAqIExpZ2h0d2VpZ2h0IGRyYWcgaGVscGVyLiAgSGFuZGxlcyBjb250YWlubWVudCB3aXRoaW4gdGhlIGVsZW1lbnQsIHNvIHRoYXRcbiAgICAqIHdoZW4gZHJhZ2dpbmcsIHRoZSB4IGlzIHdpdGhpbiBbMCxlbGVtZW50LndpZHRoXSBhbmQgeSBpcyB3aXRoaW4gWzAsZWxlbWVudC5oZWlnaHRdXG4gICAgKi9cbiAgICBmdW5jdGlvbiBkcmFnZ2FibGUoZWxlbWVudCwgb25tb3ZlLCBvbnN0YXJ0LCBvbnN0b3ApIHtcbiAgICAgICAgb25tb3ZlID0gb25tb3ZlIHx8IGZ1bmN0aW9uICgpIHsgfTtcbiAgICAgICAgb25zdGFydCA9IG9uc3RhcnQgfHwgZnVuY3Rpb24gKCkgeyB9O1xuICAgICAgICBvbnN0b3AgPSBvbnN0b3AgfHwgZnVuY3Rpb24gKCkgeyB9O1xuICAgICAgICB2YXIgZG9jID0gZG9jdW1lbnQ7XG4gICAgICAgIHZhciBkcmFnZ2luZyA9IGZhbHNlO1xuICAgICAgICB2YXIgb2Zmc2V0ID0ge307XG4gICAgICAgIHZhciBtYXhIZWlnaHQgPSAwO1xuICAgICAgICB2YXIgbWF4V2lkdGggPSAwO1xuICAgICAgICB2YXIgaGFzVG91Y2ggPSAoJ29udG91Y2hzdGFydCcgaW4gd2luZG93KTtcblxuICAgICAgICB2YXIgZHVyaW5nRHJhZ0V2ZW50cyA9IHt9O1xuICAgICAgICBkdXJpbmdEcmFnRXZlbnRzW1wic2VsZWN0c3RhcnRcIl0gPSBwcmV2ZW50O1xuICAgICAgICBkdXJpbmdEcmFnRXZlbnRzW1wiZHJhZ3N0YXJ0XCJdID0gcHJldmVudDtcbiAgICAgICAgZHVyaW5nRHJhZ0V2ZW50c1tcInRvdWNobW92ZSBtb3VzZW1vdmVcIl0gPSBtb3ZlO1xuICAgICAgICBkdXJpbmdEcmFnRXZlbnRzW1widG91Y2hlbmQgbW91c2V1cFwiXSA9IHN0b3A7XG5cbiAgICAgICAgZnVuY3Rpb24gcHJldmVudChlKSB7XG4gICAgICAgICAgICBpZiAoZS5zdG9wUHJvcGFnYXRpb24pIHtcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGUucHJldmVudERlZmF1bHQpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlLnJldHVyblZhbHVlID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBtb3ZlKGUpIHtcbiAgICAgICAgICAgIGlmIChkcmFnZ2luZykge1xuICAgICAgICAgICAgICAgIC8vIE1vdXNldXAgaGFwcGVuZWQgb3V0c2lkZSBvZiB3aW5kb3dcbiAgICAgICAgICAgICAgICBpZiAoSUUgJiYgZG9jLmRvY3VtZW50TW9kZSA8IDkgJiYgIWUuYnV0dG9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdG9wKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHRvdWNoZXMgPSBlLm9yaWdpbmFsRXZlbnQgJiYgZS5vcmlnaW5hbEV2ZW50LnRvdWNoZXM7XG4gICAgICAgICAgICAgICAgdmFyIHBhZ2VYID0gdG91Y2hlcyA/IHRvdWNoZXNbMF0ucGFnZVggOiBlLnBhZ2VYO1xuICAgICAgICAgICAgICAgIHZhciBwYWdlWSA9IHRvdWNoZXMgPyB0b3VjaGVzWzBdLnBhZ2VZIDogZS5wYWdlWTtcblxuICAgICAgICAgICAgICAgIHZhciBkcmFnWCA9IE1hdGgubWF4KDAsIE1hdGgubWluKHBhZ2VYIC0gb2Zmc2V0LmxlZnQsIG1heFdpZHRoKSk7XG4gICAgICAgICAgICAgICAgdmFyIGRyYWdZID0gTWF0aC5tYXgoMCwgTWF0aC5taW4ocGFnZVkgLSBvZmZzZXQudG9wLCBtYXhIZWlnaHQpKTtcblxuICAgICAgICAgICAgICAgIGlmIChoYXNUb3VjaCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBTdG9wIHNjcm9sbGluZyBpbiBpT1NcbiAgICAgICAgICAgICAgICAgICAgcHJldmVudChlKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBvbm1vdmUuYXBwbHkoZWxlbWVudCwgW2RyYWdYLCBkcmFnWSwgZV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc3RhcnQoZSkge1xuICAgICAgICAgICAgdmFyIHJpZ2h0Y2xpY2sgPSAoZS53aGljaCkgPyAoZS53aGljaCA9PSAzKSA6IChlLmJ1dHRvbiA9PSAyKTtcblxuICAgICAgICAgICAgaWYgKCFyaWdodGNsaWNrICYmICFkcmFnZ2luZykge1xuICAgICAgICAgICAgICAgIGlmIChvbnN0YXJ0LmFwcGx5KGVsZW1lbnQsIGFyZ3VtZW50cykgIT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGRyYWdnaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gJChlbGVtZW50KS5oZWlnaHQoKTtcbiAgICAgICAgICAgICAgICAgICAgbWF4V2lkdGggPSAkKGVsZW1lbnQpLndpZHRoKCk7XG4gICAgICAgICAgICAgICAgICAgIG9mZnNldCA9ICQoZWxlbWVudCkub2Zmc2V0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgJChkb2MpLmJpbmQoZHVyaW5nRHJhZ0V2ZW50cyk7XG4gICAgICAgICAgICAgICAgICAgICQoZG9jLmJvZHkpLmFkZENsYXNzKFwic3AtZHJhZ2dpbmdcIik7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFoYXNUb3VjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbW92ZShlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHByZXZlbnQoZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICAgICAgICAgIGlmIChkcmFnZ2luZykge1xuICAgICAgICAgICAgICAgICQoZG9jKS51bmJpbmQoZHVyaW5nRHJhZ0V2ZW50cyk7XG4gICAgICAgICAgICAgICAgJChkb2MuYm9keSkucmVtb3ZlQ2xhc3MoXCJzcC1kcmFnZ2luZ1wiKTtcbiAgICAgICAgICAgICAgICBvbnN0b3AuYXBwbHkoZWxlbWVudCwgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRyYWdnaW5nID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICAkKGVsZW1lbnQpLmJpbmQoXCJ0b3VjaHN0YXJ0IG1vdXNlZG93blwiLCBzdGFydCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdGhyb3R0bGUoZnVuYywgd2FpdCwgZGVib3VuY2UpIHtcbiAgICAgICAgdmFyIHRpbWVvdXQ7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY29udGV4dCA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICAgICAgICB2YXIgdGhyb3R0bGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBudWxsO1xuICAgICAgICAgICAgICAgIGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKGRlYm91bmNlKSBjbGVhclRpbWVvdXQodGltZW91dCk7XG4gICAgICAgICAgICBpZiAoZGVib3VuY2UgfHwgIXRpbWVvdXQpIHRpbWVvdXQgPSBzZXRUaW1lb3V0KHRocm90dGxlciwgd2FpdCk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgKiBEZWZpbmUgYSBqUXVlcnkgcGx1Z2luXG4gICAgKi9cbiAgICB2YXIgZGF0YUlEID0gXCJzcGVjdHJ1bS5pZFwiO1xuICAgICQuZm4uc3BlY3RydW0gPSBmdW5jdGlvbiAob3B0cywgZXh0cmEpIHtcblxuICAgICAgICBpZiAodHlwZW9mIG9wdHMgPT0gXCJzdHJpbmdcIikge1xuXG4gICAgICAgICAgICB2YXIgcmV0dXJuVmFsdWUgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCggYXJndW1lbnRzLCAxICk7XG5cbiAgICAgICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNwZWN0ID0gc3BlY3RydW1zWyQodGhpcykuZGF0YShkYXRhSUQpXTtcbiAgICAgICAgICAgICAgICBpZiAoc3BlY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1ldGhvZCA9IHNwZWN0W29wdHNdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIW1ldGhvZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCBcIlNwZWN0cnVtOiBubyBzdWNoIG1ldGhvZDogJ1wiICsgb3B0cyArIFwiJ1wiICk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAob3B0cyA9PSBcImdldFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5WYWx1ZSA9IHNwZWN0LmdldCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKG9wdHMgPT0gXCJjb250YWluZXJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuVmFsdWUgPSBzcGVjdC5jb250YWluZXI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAob3B0cyA9PSBcIm9wdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5WYWx1ZSA9IHNwZWN0Lm9wdGlvbi5hcHBseShzcGVjdCwgYXJncyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAob3B0cyA9PSBcImRlc3Ryb3lcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3BlY3QuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVEYXRhKGRhdGFJRCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2QuYXBwbHkoc3BlY3QsIGFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiByZXR1cm5WYWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEluaXRpYWxpemluZyBhIG5ldyBpbnN0YW5jZSBvZiBzcGVjdHJ1bVxuICAgICAgICByZXR1cm4gdGhpcy5zcGVjdHJ1bShcImRlc3Ryb3lcIikuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCBvcHRzLCAkKHRoaXMpLmRhdGEoKSk7XG4gICAgICAgICAgICB2YXIgc3BlY3QgPSBzcGVjdHJ1bSh0aGlzLCBvcHRpb25zKTtcbiAgICAgICAgICAgICQodGhpcykuZGF0YShkYXRhSUQsIHNwZWN0LmlkKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgICQuZm4uc3BlY3RydW0ubG9hZCA9IHRydWU7XG4gICAgJC5mbi5zcGVjdHJ1bS5sb2FkT3B0cyA9IHt9O1xuICAgICQuZm4uc3BlY3RydW0uZHJhZ2dhYmxlID0gZHJhZ2dhYmxlO1xuICAgICQuZm4uc3BlY3RydW0uZGVmYXVsdHMgPSBkZWZhdWx0T3B0cztcblxuICAgICQuc3BlY3RydW0gPSB7IH07XG4gICAgJC5zcGVjdHJ1bS5sb2NhbGl6YXRpb24gPSB7IH07XG4gICAgJC5zcGVjdHJ1bS5wYWxldHRlcyA9IHsgfTtcblxuICAgICQuZm4uc3BlY3RydW0ucHJvY2Vzc05hdGl2ZUNvbG9ySW5wdXRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIWlucHV0VHlwZUNvbG9yU3VwcG9ydCkge1xuICAgICAgICAgICAgJChcImlucHV0W3R5cGU9Y29sb3JdXCIpLnNwZWN0cnVtKHtcbiAgICAgICAgICAgICAgICBwcmVmZXJyZWRGb3JtYXQ6IFwiaGV4NlwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBUaW55Q29sb3IgdjEuMS4xXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2Jncmlucy9UaW55Q29sb3JcbiAgICAvLyBCcmlhbiBHcmluc3RlYWQsIE1JVCBMaWNlbnNlXG5cbiAgICAoZnVuY3Rpb24oKSB7XG5cbiAgICB2YXIgdHJpbUxlZnQgPSAvXltcXHMsI10rLyxcbiAgICAgICAgdHJpbVJpZ2h0ID0gL1xccyskLyxcbiAgICAgICAgdGlueUNvdW50ZXIgPSAwLFxuICAgICAgICBtYXRoID0gTWF0aCxcbiAgICAgICAgbWF0aFJvdW5kID0gbWF0aC5yb3VuZCxcbiAgICAgICAgbWF0aE1pbiA9IG1hdGgubWluLFxuICAgICAgICBtYXRoTWF4ID0gbWF0aC5tYXgsXG4gICAgICAgIG1hdGhSYW5kb20gPSBtYXRoLnJhbmRvbTtcblxuICAgIHZhciB0aW55Y29sb3IgPSBmdW5jdGlvbiB0aW55Y29sb3IgKGNvbG9yLCBvcHRzKSB7XG5cbiAgICAgICAgY29sb3IgPSAoY29sb3IpID8gY29sb3IgOiAnJztcbiAgICAgICAgb3B0cyA9IG9wdHMgfHwgeyB9O1xuXG4gICAgICAgIC8vIElmIGlucHV0IGlzIGFscmVhZHkgYSB0aW55Y29sb3IsIHJldHVybiBpdHNlbGZcbiAgICAgICAgaWYgKGNvbG9yIGluc3RhbmNlb2YgdGlueWNvbG9yKSB7XG4gICAgICAgICAgIHJldHVybiBjb2xvcjtcbiAgICAgICAgfVxuICAgICAgICAvLyBJZiB3ZSBhcmUgY2FsbGVkIGFzIGEgZnVuY3Rpb24sIGNhbGwgdXNpbmcgbmV3IGluc3RlYWRcbiAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIHRpbnljb2xvcikpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgdGlueWNvbG9yKGNvbG9yLCBvcHRzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciByZ2IgPSBpbnB1dFRvUkdCKGNvbG9yKTtcbiAgICAgICAgdGhpcy5fb3JpZ2luYWxJbnB1dCA9IGNvbG9yLFxuICAgICAgICB0aGlzLl9yID0gcmdiLnIsXG4gICAgICAgIHRoaXMuX2cgPSByZ2IuZyxcbiAgICAgICAgdGhpcy5fYiA9IHJnYi5iLFxuICAgICAgICB0aGlzLl9hID0gcmdiLmEsXG4gICAgICAgIHRoaXMuX3JvdW5kQSA9IG1hdGhSb3VuZCgxMDAqdGhpcy5fYSkgLyAxMDAsXG4gICAgICAgIHRoaXMuX2Zvcm1hdCA9IG9wdHMuZm9ybWF0IHx8IHJnYi5mb3JtYXQ7XG4gICAgICAgIHRoaXMuX2dyYWRpZW50VHlwZSA9IG9wdHMuZ3JhZGllbnRUeXBlO1xuXG4gICAgICAgIC8vIERvbid0IGxldCB0aGUgcmFuZ2Ugb2YgWzAsMjU1XSBjb21lIGJhY2sgaW4gWzAsMV0uXG4gICAgICAgIC8vIFBvdGVudGlhbGx5IGxvc2UgYSBsaXR0bGUgYml0IG9mIHByZWNpc2lvbiBoZXJlLCBidXQgd2lsbCBmaXggaXNzdWVzIHdoZXJlXG4gICAgICAgIC8vIC41IGdldHMgaW50ZXJwcmV0ZWQgYXMgaGFsZiBvZiB0aGUgdG90YWwsIGluc3RlYWQgb2YgaGFsZiBvZiAxXG4gICAgICAgIC8vIElmIGl0IHdhcyBzdXBwb3NlZCB0byBiZSAxMjgsIHRoaXMgd2FzIGFscmVhZHkgdGFrZW4gY2FyZSBvZiBieSBgaW5wdXRUb1JnYmBcbiAgICAgICAgaWYgKHRoaXMuX3IgPCAxKSB7IHRoaXMuX3IgPSBtYXRoUm91bmQodGhpcy5fcik7IH1cbiAgICAgICAgaWYgKHRoaXMuX2cgPCAxKSB7IHRoaXMuX2cgPSBtYXRoUm91bmQodGhpcy5fZyk7IH1cbiAgICAgICAgaWYgKHRoaXMuX2IgPCAxKSB7IHRoaXMuX2IgPSBtYXRoUm91bmQodGhpcy5fYik7IH1cblxuICAgICAgICB0aGlzLl9vayA9IHJnYi5vaztcbiAgICAgICAgdGhpcy5fdGNfaWQgPSB0aW55Q291bnRlcisrO1xuICAgIH07XG5cbiAgICB0aW55Y29sb3IucHJvdG90eXBlID0ge1xuICAgICAgICBpc0Rhcms6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QnJpZ2h0bmVzcygpIDwgMTI4O1xuICAgICAgICB9LFxuICAgICAgICBpc0xpZ2h0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAhdGhpcy5pc0RhcmsoKTtcbiAgICAgICAgfSxcbiAgICAgICAgaXNWYWxpZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb2s7XG4gICAgICAgIH0sXG4gICAgICAgIGdldE9yaWdpbmFsSW5wdXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9vcmlnaW5hbElucHV0O1xuICAgICAgICB9LFxuICAgICAgICBnZXRGb3JtYXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Zvcm1hdDtcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0QWxwaGE6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2E7XG4gICAgICAgIH0sXG4gICAgICAgIGdldEJyaWdodG5lc3M6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHJnYiA9IHRoaXMudG9SZ2IoKTtcbiAgICAgICAgICAgIHJldHVybiAocmdiLnIgKiAyOTkgKyByZ2IuZyAqIDU4NyArIHJnYi5iICogMTE0KSAvIDEwMDA7XG4gICAgICAgIH0sXG4gICAgICAgIHNldEFscGhhOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5fYSA9IGJvdW5kQWxwaGEodmFsdWUpO1xuICAgICAgICAgICAgdGhpcy5fcm91bmRBID0gbWF0aFJvdW5kKDEwMCp0aGlzLl9hKSAvIDEwMDtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICB0b0hzdjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgaHN2ID0gcmdiVG9Ic3YodGhpcy5fciwgdGhpcy5fZywgdGhpcy5fYik7XG4gICAgICAgICAgICByZXR1cm4geyBoOiBoc3YuaCAqIDM2MCwgczogaHN2LnMsIHY6IGhzdi52LCBhOiB0aGlzLl9hIH07XG4gICAgICAgIH0sXG4gICAgICAgIHRvSHN2U3RyaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBoc3YgPSByZ2JUb0hzdih0aGlzLl9yLCB0aGlzLl9nLCB0aGlzLl9iKTtcbiAgICAgICAgICAgIHZhciBoID0gbWF0aFJvdW5kKGhzdi5oICogMzYwKSwgcyA9IG1hdGhSb3VuZChoc3YucyAqIDEwMCksIHYgPSBtYXRoUm91bmQoaHN2LnYgKiAxMDApO1xuICAgICAgICAgICAgcmV0dXJuICh0aGlzLl9hID09IDEpID9cbiAgICAgICAgICAgICAgXCJoc3YoXCIgICsgaCArIFwiLCBcIiArIHMgKyBcIiUsIFwiICsgdiArIFwiJSlcIiA6XG4gICAgICAgICAgICAgIFwiaHN2YShcIiArIGggKyBcIiwgXCIgKyBzICsgXCIlLCBcIiArIHYgKyBcIiUsIFwiKyB0aGlzLl9yb3VuZEEgKyBcIilcIjtcbiAgICAgICAgfSxcbiAgICAgICAgdG9Ic2w6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGhzbCA9IHJnYlRvSHNsKHRoaXMuX3IsIHRoaXMuX2csIHRoaXMuX2IpO1xuICAgICAgICAgICAgcmV0dXJuIHsgaDogaHNsLmggKiAzNjAsIHM6IGhzbC5zLCBsOiBoc2wubCwgYTogdGhpcy5fYSB9O1xuICAgICAgICB9LFxuICAgICAgICB0b0hzbFN0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgaHNsID0gcmdiVG9Ic2wodGhpcy5fciwgdGhpcy5fZywgdGhpcy5fYik7XG4gICAgICAgICAgICB2YXIgaCA9IG1hdGhSb3VuZChoc2wuaCAqIDM2MCksIHMgPSBtYXRoUm91bmQoaHNsLnMgKiAxMDApLCBsID0gbWF0aFJvdW5kKGhzbC5sICogMTAwKTtcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5fYSA9PSAxKSA/XG4gICAgICAgICAgICAgIFwiaHNsKFwiICArIGggKyBcIiwgXCIgKyBzICsgXCIlLCBcIiArIGwgKyBcIiUpXCIgOlxuICAgICAgICAgICAgICBcImhzbGEoXCIgKyBoICsgXCIsIFwiICsgcyArIFwiJSwgXCIgKyBsICsgXCIlLCBcIisgdGhpcy5fcm91bmRBICsgXCIpXCI7XG4gICAgICAgIH0sXG4gICAgICAgIHRvSGV4OiBmdW5jdGlvbihhbGxvdzNDaGFyKSB7XG4gICAgICAgICAgICByZXR1cm4gcmdiVG9IZXgodGhpcy5fciwgdGhpcy5fZywgdGhpcy5fYiwgYWxsb3czQ2hhcik7XG4gICAgICAgIH0sXG4gICAgICAgIHRvSGV4U3RyaW5nOiBmdW5jdGlvbihhbGxvdzNDaGFyKSB7XG4gICAgICAgICAgICByZXR1cm4gJyMnICsgdGhpcy50b0hleChhbGxvdzNDaGFyKTtcbiAgICAgICAgfSxcbiAgICAgICAgdG9IZXg4OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiByZ2JhVG9IZXgodGhpcy5fciwgdGhpcy5fZywgdGhpcy5fYiwgdGhpcy5fYSk7XG4gICAgICAgIH0sXG4gICAgICAgIHRvSGV4OFN0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gJyMnICsgdGhpcy50b0hleDgoKTtcbiAgICAgICAgfSxcbiAgICAgICAgdG9SZ2I6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgcjogbWF0aFJvdW5kKHRoaXMuX3IpLCBnOiBtYXRoUm91bmQodGhpcy5fZyksIGI6IG1hdGhSb3VuZCh0aGlzLl9iKSwgYTogdGhpcy5fYSB9O1xuICAgICAgICB9LFxuICAgICAgICB0b1JnYlN0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gKHRoaXMuX2EgPT0gMSkgP1xuICAgICAgICAgICAgICBcInJnYihcIiAgKyBtYXRoUm91bmQodGhpcy5fcikgKyBcIiwgXCIgKyBtYXRoUm91bmQodGhpcy5fZykgKyBcIiwgXCIgKyBtYXRoUm91bmQodGhpcy5fYikgKyBcIilcIiA6XG4gICAgICAgICAgICAgIFwicmdiYShcIiArIG1hdGhSb3VuZCh0aGlzLl9yKSArIFwiLCBcIiArIG1hdGhSb3VuZCh0aGlzLl9nKSArIFwiLCBcIiArIG1hdGhSb3VuZCh0aGlzLl9iKSArIFwiLCBcIiArIHRoaXMuX3JvdW5kQSArIFwiKVwiO1xuICAgICAgICB9LFxuICAgICAgICB0b1BlcmNlbnRhZ2VSZ2I6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgcjogbWF0aFJvdW5kKGJvdW5kMDEodGhpcy5fciwgMjU1KSAqIDEwMCkgKyBcIiVcIiwgZzogbWF0aFJvdW5kKGJvdW5kMDEodGhpcy5fZywgMjU1KSAqIDEwMCkgKyBcIiVcIiwgYjogbWF0aFJvdW5kKGJvdW5kMDEodGhpcy5fYiwgMjU1KSAqIDEwMCkgKyBcIiVcIiwgYTogdGhpcy5fYSB9O1xuICAgICAgICB9LFxuICAgICAgICB0b1BlcmNlbnRhZ2VSZ2JTdHJpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuICh0aGlzLl9hID09IDEpID9cbiAgICAgICAgICAgICAgXCJyZ2IoXCIgICsgbWF0aFJvdW5kKGJvdW5kMDEodGhpcy5fciwgMjU1KSAqIDEwMCkgKyBcIiUsIFwiICsgbWF0aFJvdW5kKGJvdW5kMDEodGhpcy5fZywgMjU1KSAqIDEwMCkgKyBcIiUsIFwiICsgbWF0aFJvdW5kKGJvdW5kMDEodGhpcy5fYiwgMjU1KSAqIDEwMCkgKyBcIiUpXCIgOlxuICAgICAgICAgICAgICBcInJnYmEoXCIgKyBtYXRoUm91bmQoYm91bmQwMSh0aGlzLl9yLCAyNTUpICogMTAwKSArIFwiJSwgXCIgKyBtYXRoUm91bmQoYm91bmQwMSh0aGlzLl9nLCAyNTUpICogMTAwKSArIFwiJSwgXCIgKyBtYXRoUm91bmQoYm91bmQwMSh0aGlzLl9iLCAyNTUpICogMTAwKSArIFwiJSwgXCIgKyB0aGlzLl9yb3VuZEEgKyBcIilcIjtcbiAgICAgICAgfSxcbiAgICAgICAgdG9OYW1lOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9hID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNwYXJlbnRcIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuX2EgPCAxKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gaGV4TmFtZXNbcmdiVG9IZXgodGhpcy5fciwgdGhpcy5fZywgdGhpcy5fYiwgdHJ1ZSldIHx8IGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICB0b0ZpbHRlcjogZnVuY3Rpb24oc2Vjb25kQ29sb3IpIHtcbiAgICAgICAgICAgIHZhciBoZXg4U3RyaW5nID0gJyMnICsgcmdiYVRvSGV4KHRoaXMuX3IsIHRoaXMuX2csIHRoaXMuX2IsIHRoaXMuX2EpO1xuICAgICAgICAgICAgdmFyIHNlY29uZEhleDhTdHJpbmcgPSBoZXg4U3RyaW5nO1xuICAgICAgICAgICAgdmFyIGdyYWRpZW50VHlwZSA9IHRoaXMuX2dyYWRpZW50VHlwZSA/IFwiR3JhZGllbnRUeXBlID0gMSwgXCIgOiBcIlwiO1xuXG4gICAgICAgICAgICBpZiAoc2Vjb25kQ29sb3IpIHtcbiAgICAgICAgICAgICAgICB2YXIgcyA9IHRpbnljb2xvcihzZWNvbmRDb2xvcik7XG4gICAgICAgICAgICAgICAgc2Vjb25kSGV4OFN0cmluZyA9IHMudG9IZXg4U3RyaW5nKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBcInByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5ncmFkaWVudChcIitncmFkaWVudFR5cGUrXCJzdGFydENvbG9yc3RyPVwiK2hleDhTdHJpbmcrXCIsZW5kQ29sb3JzdHI9XCIrc2Vjb25kSGV4OFN0cmluZytcIilcIjtcbiAgICAgICAgfSxcbiAgICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKGZvcm1hdCkge1xuICAgICAgICAgICAgdmFyIGZvcm1hdFNldCA9ICEhZm9ybWF0O1xuICAgICAgICAgICAgZm9ybWF0ID0gZm9ybWF0IHx8IHRoaXMuX2Zvcm1hdDtcblxuICAgICAgICAgICAgdmFyIGZvcm1hdHRlZFN0cmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGhhc0FscGhhID0gdGhpcy5fYSA8IDEgJiYgdGhpcy5fYSA+PSAwO1xuICAgICAgICAgICAgdmFyIG5lZWRzQWxwaGFGb3JtYXQgPSAhZm9ybWF0U2V0ICYmIGhhc0FscGhhICYmIChmb3JtYXQgPT09IFwiaGV4XCIgfHwgZm9ybWF0ID09PSBcImhleDZcIiB8fCBmb3JtYXQgPT09IFwiaGV4M1wiIHx8IGZvcm1hdCA9PT0gXCJuYW1lXCIpO1xuXG4gICAgICAgICAgICBpZiAobmVlZHNBbHBoYUZvcm1hdCkge1xuICAgICAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZSBmb3IgXCJ0cmFuc3BhcmVudFwiLCBhbGwgb3RoZXIgbm9uLWFscGhhIGZvcm1hdHNcbiAgICAgICAgICAgICAgICAvLyB3aWxsIHJldHVybiByZ2JhIHdoZW4gdGhlcmUgaXMgdHJhbnNwYXJlbmN5LlxuICAgICAgICAgICAgICAgIGlmIChmb3JtYXQgPT09IFwibmFtZVwiICYmIHRoaXMuX2EgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudG9OYW1lKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRvUmdiU3RyaW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZm9ybWF0ID09PSBcInJnYlwiKSB7XG4gICAgICAgICAgICAgICAgZm9ybWF0dGVkU3RyaW5nID0gdGhpcy50b1JnYlN0cmluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZvcm1hdCA9PT0gXCJwcmdiXCIpIHtcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZWRTdHJpbmcgPSB0aGlzLnRvUGVyY2VudGFnZVJnYlN0cmluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZvcm1hdCA9PT0gXCJoZXhcIiB8fCBmb3JtYXQgPT09IFwiaGV4NlwiKSB7XG4gICAgICAgICAgICAgICAgZm9ybWF0dGVkU3RyaW5nID0gdGhpcy50b0hleFN0cmluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZvcm1hdCA9PT0gXCJoZXgzXCIpIHtcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZWRTdHJpbmcgPSB0aGlzLnRvSGV4U3RyaW5nKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZvcm1hdCA9PT0gXCJoZXg4XCIpIHtcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZWRTdHJpbmcgPSB0aGlzLnRvSGV4OFN0cmluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZvcm1hdCA9PT0gXCJuYW1lXCIpIHtcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZWRTdHJpbmcgPSB0aGlzLnRvTmFtZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZvcm1hdCA9PT0gXCJoc2xcIikge1xuICAgICAgICAgICAgICAgIGZvcm1hdHRlZFN0cmluZyA9IHRoaXMudG9Ic2xTdHJpbmcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmb3JtYXQgPT09IFwiaHN2XCIpIHtcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZWRTdHJpbmcgPSB0aGlzLnRvSHN2U3RyaW5nKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBmb3JtYXR0ZWRTdHJpbmcgfHwgdGhpcy50b0hleFN0cmluZygpO1xuICAgICAgICB9LFxuXG4gICAgICAgIF9hcHBseU1vZGlmaWNhdGlvbjogZnVuY3Rpb24oZm4sIGFyZ3MpIHtcbiAgICAgICAgICAgIHZhciBjb2xvciA9IGZuLmFwcGx5KG51bGwsIFt0aGlzXS5jb25jYXQoW10uc2xpY2UuY2FsbChhcmdzKSkpO1xuICAgICAgICAgICAgdGhpcy5fciA9IGNvbG9yLl9yO1xuICAgICAgICAgICAgdGhpcy5fZyA9IGNvbG9yLl9nO1xuICAgICAgICAgICAgdGhpcy5fYiA9IGNvbG9yLl9iO1xuICAgICAgICAgICAgdGhpcy5zZXRBbHBoYShjb2xvci5fYSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgbGlnaHRlbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXBwbHlNb2RpZmljYXRpb24obGlnaHRlbiwgYXJndW1lbnRzKTtcbiAgICAgICAgfSxcbiAgICAgICAgYnJpZ2h0ZW46IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FwcGx5TW9kaWZpY2F0aW9uKGJyaWdodGVuLCBhcmd1bWVudHMpO1xuICAgICAgICB9LFxuICAgICAgICBkYXJrZW46IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FwcGx5TW9kaWZpY2F0aW9uKGRhcmtlbiwgYXJndW1lbnRzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZGVzYXR1cmF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXBwbHlNb2RpZmljYXRpb24oZGVzYXR1cmF0ZSwgYXJndW1lbnRzKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2F0dXJhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FwcGx5TW9kaWZpY2F0aW9uKHNhdHVyYXRlLCBhcmd1bWVudHMpO1xuICAgICAgICB9LFxuICAgICAgICBncmV5c2NhbGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FwcGx5TW9kaWZpY2F0aW9uKGdyZXlzY2FsZSwgYXJndW1lbnRzKTtcbiAgICAgICAgfSxcbiAgICAgICAgc3BpbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXBwbHlNb2RpZmljYXRpb24oc3BpbiwgYXJndW1lbnRzKTtcbiAgICAgICAgfSxcblxuICAgICAgICBfYXBwbHlDb21iaW5hdGlvbjogZnVuY3Rpb24oZm4sIGFyZ3MpIHtcbiAgICAgICAgICAgIHJldHVybiBmbi5hcHBseShudWxsLCBbdGhpc10uY29uY2F0KFtdLnNsaWNlLmNhbGwoYXJncykpKTtcbiAgICAgICAgfSxcbiAgICAgICAgYW5hbG9nb3VzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hcHBseUNvbWJpbmF0aW9uKGFuYWxvZ291cywgYXJndW1lbnRzKTtcbiAgICAgICAgfSxcbiAgICAgICAgY29tcGxlbWVudDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXBwbHlDb21iaW5hdGlvbihjb21wbGVtZW50LCBhcmd1bWVudHMpO1xuICAgICAgICB9LFxuICAgICAgICBtb25vY2hyb21hdGljOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hcHBseUNvbWJpbmF0aW9uKG1vbm9jaHJvbWF0aWMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH0sXG4gICAgICAgIHNwbGl0Y29tcGxlbWVudDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXBwbHlDb21iaW5hdGlvbihzcGxpdGNvbXBsZW1lbnQsIGFyZ3VtZW50cyk7XG4gICAgICAgIH0sXG4gICAgICAgIHRyaWFkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hcHBseUNvbWJpbmF0aW9uKHRyaWFkLCBhcmd1bWVudHMpO1xuICAgICAgICB9LFxuICAgICAgICB0ZXRyYWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FwcGx5Q29tYmluYXRpb24odGV0cmFkLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8vIElmIGlucHV0IGlzIGFuIG9iamVjdCwgZm9yY2UgMSBpbnRvIFwiMS4wXCIgdG8gaGFuZGxlIHJhdGlvcyBwcm9wZXJseVxuICAgIC8vIFN0cmluZyBpbnB1dCByZXF1aXJlcyBcIjEuMFwiIGFzIGlucHV0LCBzbyAxIHdpbGwgYmUgdHJlYXRlZCBhcyAxXG4gICAgdGlueWNvbG9yLmZyb21SYXRpbyA9IGZ1bmN0aW9uKGNvbG9yLCBvcHRzKSB7XG4gICAgICAgIGlmICh0eXBlb2YgY29sb3IgPT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgdmFyIG5ld0NvbG9yID0ge307XG4gICAgICAgICAgICBmb3IgKHZhciBpIGluIGNvbG9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbG9yLmhhc093blByb3BlcnR5KGkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpID09PSBcImFcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q29sb3JbaV0gPSBjb2xvcltpXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NvbG9yW2ldID0gY29udmVydFRvUGVyY2VudGFnZShjb2xvcltpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb2xvciA9IG5ld0NvbG9yO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRpbnljb2xvcihjb2xvciwgb3B0cyk7XG4gICAgfTtcblxuICAgIC8vIEdpdmVuIGEgc3RyaW5nIG9yIG9iamVjdCwgY29udmVydCB0aGF0IGlucHV0IHRvIFJHQlxuICAgIC8vIFBvc3NpYmxlIHN0cmluZyBpbnB1dHM6XG4gICAgLy9cbiAgICAvLyAgICAgXCJyZWRcIlxuICAgIC8vICAgICBcIiNmMDBcIiBvciBcImYwMFwiXG4gICAgLy8gICAgIFwiI2ZmMDAwMFwiIG9yIFwiZmYwMDAwXCJcbiAgICAvLyAgICAgXCIjZmYwMDAwMDBcIiBvciBcImZmMDAwMDAwXCJcbiAgICAvLyAgICAgXCJyZ2IgMjU1IDAgMFwiIG9yIFwicmdiICgyNTUsIDAsIDApXCJcbiAgICAvLyAgICAgXCJyZ2IgMS4wIDAgMFwiIG9yIFwicmdiICgxLCAwLCAwKVwiXG4gICAgLy8gICAgIFwicmdiYSAoMjU1LCAwLCAwLCAxKVwiIG9yIFwicmdiYSAyNTUsIDAsIDAsIDFcIlxuICAgIC8vICAgICBcInJnYmEgKDEuMCwgMCwgMCwgMSlcIiBvciBcInJnYmEgMS4wLCAwLCAwLCAxXCJcbiAgICAvLyAgICAgXCJoc2woMCwgMTAwJSwgNTAlKVwiIG9yIFwiaHNsIDAgMTAwJSA1MCVcIlxuICAgIC8vICAgICBcImhzbGEoMCwgMTAwJSwgNTAlLCAxKVwiIG9yIFwiaHNsYSAwIDEwMCUgNTAlLCAxXCJcbiAgICAvLyAgICAgXCJoc3YoMCwgMTAwJSwgMTAwJSlcIiBvciBcImhzdiAwIDEwMCUgMTAwJVwiXG4gICAgLy9cbiAgICBmdW5jdGlvbiBpbnB1dFRvUkdCKGNvbG9yKSB7XG5cbiAgICAgICAgdmFyIHJnYiA9IHsgcjogMCwgZzogMCwgYjogMCB9O1xuICAgICAgICB2YXIgYSA9IDE7XG4gICAgICAgIHZhciBvayA9IGZhbHNlO1xuICAgICAgICB2YXIgZm9ybWF0ID0gZmFsc2U7XG5cbiAgICAgICAgaWYgKHR5cGVvZiBjb2xvciA9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBjb2xvciA9IHN0cmluZ0lucHV0VG9PYmplY3QoY29sb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHR5cGVvZiBjb2xvciA9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICBpZiAoY29sb3IuaGFzT3duUHJvcGVydHkoXCJyXCIpICYmIGNvbG9yLmhhc093blByb3BlcnR5KFwiZ1wiKSAmJiBjb2xvci5oYXNPd25Qcm9wZXJ0eShcImJcIikpIHtcbiAgICAgICAgICAgICAgICByZ2IgPSByZ2JUb1JnYihjb2xvci5yLCBjb2xvci5nLCBjb2xvci5iKTtcbiAgICAgICAgICAgICAgICBvayA9IHRydWU7XG4gICAgICAgICAgICAgICAgZm9ybWF0ID0gU3RyaW5nKGNvbG9yLnIpLnN1YnN0cigtMSkgPT09IFwiJVwiID8gXCJwcmdiXCIgOiBcInJnYlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY29sb3IuaGFzT3duUHJvcGVydHkoXCJoXCIpICYmIGNvbG9yLmhhc093blByb3BlcnR5KFwic1wiKSAmJiBjb2xvci5oYXNPd25Qcm9wZXJ0eShcInZcIikpIHtcbiAgICAgICAgICAgICAgICBjb2xvci5zID0gY29udmVydFRvUGVyY2VudGFnZShjb2xvci5zKTtcbiAgICAgICAgICAgICAgICBjb2xvci52ID0gY29udmVydFRvUGVyY2VudGFnZShjb2xvci52KTtcbiAgICAgICAgICAgICAgICByZ2IgPSBoc3ZUb1JnYihjb2xvci5oLCBjb2xvci5zLCBjb2xvci52KTtcbiAgICAgICAgICAgICAgICBvayA9IHRydWU7XG4gICAgICAgICAgICAgICAgZm9ybWF0ID0gXCJoc3ZcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNvbG9yLmhhc093blByb3BlcnR5KFwiaFwiKSAmJiBjb2xvci5oYXNPd25Qcm9wZXJ0eShcInNcIikgJiYgY29sb3IuaGFzT3duUHJvcGVydHkoXCJsXCIpKSB7XG4gICAgICAgICAgICAgICAgY29sb3IucyA9IGNvbnZlcnRUb1BlcmNlbnRhZ2UoY29sb3Iucyk7XG4gICAgICAgICAgICAgICAgY29sb3IubCA9IGNvbnZlcnRUb1BlcmNlbnRhZ2UoY29sb3IubCk7XG4gICAgICAgICAgICAgICAgcmdiID0gaHNsVG9SZ2IoY29sb3IuaCwgY29sb3IucywgY29sb3IubCk7XG4gICAgICAgICAgICAgICAgb2sgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGZvcm1hdCA9IFwiaHNsXCI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjb2xvci5oYXNPd25Qcm9wZXJ0eShcImFcIikpIHtcbiAgICAgICAgICAgICAgICBhID0gY29sb3IuYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGEgPSBib3VuZEFscGhhKGEpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBvazogb2ssXG4gICAgICAgICAgICBmb3JtYXQ6IGNvbG9yLmZvcm1hdCB8fCBmb3JtYXQsXG4gICAgICAgICAgICByOiBtYXRoTWluKDI1NSwgbWF0aE1heChyZ2IuciwgMCkpLFxuICAgICAgICAgICAgZzogbWF0aE1pbigyNTUsIG1hdGhNYXgocmdiLmcsIDApKSxcbiAgICAgICAgICAgIGI6IG1hdGhNaW4oMjU1LCBtYXRoTWF4KHJnYi5iLCAwKSksXG4gICAgICAgICAgICBhOiBhXG4gICAgICAgIH07XG4gICAgfVxuXG5cbiAgICAvLyBDb252ZXJzaW9uIEZ1bmN0aW9uc1xuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvLyBgcmdiVG9Ic2xgLCBgcmdiVG9Ic3ZgLCBgaHNsVG9SZ2JgLCBgaHN2VG9SZ2JgIG1vZGlmaWVkIGZyb206XG4gICAgLy8gPGh0dHA6Ly9tamlqYWNrc29uLmNvbS8yMDA4LzAyL3JnYi10by1oc2wtYW5kLXJnYi10by1oc3YtY29sb3ItbW9kZWwtY29udmVyc2lvbi1hbGdvcml0aG1zLWluLWphdmFzY3JpcHQ+XG5cbiAgICAvLyBgcmdiVG9SZ2JgXG4gICAgLy8gSGFuZGxlIGJvdW5kcyAvIHBlcmNlbnRhZ2UgY2hlY2tpbmcgdG8gY29uZm9ybSB0byBDU1MgY29sb3Igc3BlY1xuICAgIC8vIDxodHRwOi8vd3d3LnczLm9yZy9UUi9jc3MzLWNvbG9yLz5cbiAgICAvLyAqQXNzdW1lczoqIHIsIGcsIGIgaW4gWzAsIDI1NV0gb3IgWzAsIDFdXG4gICAgLy8gKlJldHVybnM6KiB7IHIsIGcsIGIgfSBpbiBbMCwgMjU1XVxuICAgIGZ1bmN0aW9uIHJnYlRvUmdiKHIsIGcsIGIpe1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcjogYm91bmQwMShyLCAyNTUpICogMjU1LFxuICAgICAgICAgICAgZzogYm91bmQwMShnLCAyNTUpICogMjU1LFxuICAgICAgICAgICAgYjogYm91bmQwMShiLCAyNTUpICogMjU1XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gYHJnYlRvSHNsYFxuICAgIC8vIENvbnZlcnRzIGFuIFJHQiBjb2xvciB2YWx1ZSB0byBIU0wuXG4gICAgLy8gKkFzc3VtZXM6KiByLCBnLCBhbmQgYiBhcmUgY29udGFpbmVkIGluIFswLCAyNTVdIG9yIFswLCAxXVxuICAgIC8vICpSZXR1cm5zOiogeyBoLCBzLCBsIH0gaW4gWzAsMV1cbiAgICBmdW5jdGlvbiByZ2JUb0hzbChyLCBnLCBiKSB7XG5cbiAgICAgICAgciA9IGJvdW5kMDEociwgMjU1KTtcbiAgICAgICAgZyA9IGJvdW5kMDEoZywgMjU1KTtcbiAgICAgICAgYiA9IGJvdW5kMDEoYiwgMjU1KTtcblxuICAgICAgICB2YXIgbWF4ID0gbWF0aE1heChyLCBnLCBiKSwgbWluID0gbWF0aE1pbihyLCBnLCBiKTtcbiAgICAgICAgdmFyIGgsIHMsIGwgPSAobWF4ICsgbWluKSAvIDI7XG5cbiAgICAgICAgaWYobWF4ID09IG1pbikge1xuICAgICAgICAgICAgaCA9IHMgPSAwOyAvLyBhY2hyb21hdGljXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgZCA9IG1heCAtIG1pbjtcbiAgICAgICAgICAgIHMgPSBsID4gMC41ID8gZCAvICgyIC0gbWF4IC0gbWluKSA6IGQgLyAobWF4ICsgbWluKTtcbiAgICAgICAgICAgIHN3aXRjaChtYXgpIHtcbiAgICAgICAgICAgICAgICBjYXNlIHI6IGggPSAoZyAtIGIpIC8gZCArIChnIDwgYiA/IDYgOiAwKTsgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBnOiBoID0gKGIgLSByKSAvIGQgKyAyOyBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIGI6IGggPSAociAtIGcpIC8gZCArIDQ7IGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBoIC89IDY7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyBoOiBoLCBzOiBzLCBsOiBsIH07XG4gICAgfVxuXG4gICAgLy8gYGhzbFRvUmdiYFxuICAgIC8vIENvbnZlcnRzIGFuIEhTTCBjb2xvciB2YWx1ZSB0byBSR0IuXG4gICAgLy8gKkFzc3VtZXM6KiBoIGlzIGNvbnRhaW5lZCBpbiBbMCwgMV0gb3IgWzAsIDM2MF0gYW5kIHMgYW5kIGwgYXJlIGNvbnRhaW5lZCBbMCwgMV0gb3IgWzAsIDEwMF1cbiAgICAvLyAqUmV0dXJuczoqIHsgciwgZywgYiB9IGluIHRoZSBzZXQgWzAsIDI1NV1cbiAgICBmdW5jdGlvbiBoc2xUb1JnYihoLCBzLCBsKSB7XG4gICAgICAgIHZhciByLCBnLCBiO1xuXG4gICAgICAgIGggPSBib3VuZDAxKGgsIDM2MCk7XG4gICAgICAgIHMgPSBib3VuZDAxKHMsIDEwMCk7XG4gICAgICAgIGwgPSBib3VuZDAxKGwsIDEwMCk7XG5cbiAgICAgICAgZnVuY3Rpb24gaHVlMnJnYihwLCBxLCB0KSB7XG4gICAgICAgICAgICBpZih0IDwgMCkgdCArPSAxO1xuICAgICAgICAgICAgaWYodCA+IDEpIHQgLT0gMTtcbiAgICAgICAgICAgIGlmKHQgPCAxLzYpIHJldHVybiBwICsgKHEgLSBwKSAqIDYgKiB0O1xuICAgICAgICAgICAgaWYodCA8IDEvMikgcmV0dXJuIHE7XG4gICAgICAgICAgICBpZih0IDwgMi8zKSByZXR1cm4gcCArIChxIC0gcCkgKiAoMi8zIC0gdCkgKiA2O1xuICAgICAgICAgICAgcmV0dXJuIHA7XG4gICAgICAgIH1cblxuICAgICAgICBpZihzID09PSAwKSB7XG4gICAgICAgICAgICByID0gZyA9IGIgPSBsOyAvLyBhY2hyb21hdGljXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgcSA9IGwgPCAwLjUgPyBsICogKDEgKyBzKSA6IGwgKyBzIC0gbCAqIHM7XG4gICAgICAgICAgICB2YXIgcCA9IDIgKiBsIC0gcTtcbiAgICAgICAgICAgIHIgPSBodWUycmdiKHAsIHEsIGggKyAxLzMpO1xuICAgICAgICAgICAgZyA9IGh1ZTJyZ2IocCwgcSwgaCk7XG4gICAgICAgICAgICBiID0gaHVlMnJnYihwLCBxLCBoIC0gMS8zKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IHI6IHIgKiAyNTUsIGc6IGcgKiAyNTUsIGI6IGIgKiAyNTUgfTtcbiAgICB9XG5cbiAgICAvLyBgcmdiVG9Ic3ZgXG4gICAgLy8gQ29udmVydHMgYW4gUkdCIGNvbG9yIHZhbHVlIHRvIEhTVlxuICAgIC8vICpBc3N1bWVzOiogciwgZywgYW5kIGIgYXJlIGNvbnRhaW5lZCBpbiB0aGUgc2V0IFswLCAyNTVdIG9yIFswLCAxXVxuICAgIC8vICpSZXR1cm5zOiogeyBoLCBzLCB2IH0gaW4gWzAsMV1cbiAgICBmdW5jdGlvbiByZ2JUb0hzdihyLCBnLCBiKSB7XG5cbiAgICAgICAgciA9IGJvdW5kMDEociwgMjU1KTtcbiAgICAgICAgZyA9IGJvdW5kMDEoZywgMjU1KTtcbiAgICAgICAgYiA9IGJvdW5kMDEoYiwgMjU1KTtcblxuICAgICAgICB2YXIgbWF4ID0gbWF0aE1heChyLCBnLCBiKSwgbWluID0gbWF0aE1pbihyLCBnLCBiKTtcbiAgICAgICAgdmFyIGgsIHMsIHYgPSBtYXg7XG5cbiAgICAgICAgdmFyIGQgPSBtYXggLSBtaW47XG4gICAgICAgIHMgPSBtYXggPT09IDAgPyAwIDogZCAvIG1heDtcblxuICAgICAgICBpZihtYXggPT0gbWluKSB7XG4gICAgICAgICAgICBoID0gMDsgLy8gYWNocm9tYXRpY1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3dpdGNoKG1heCkge1xuICAgICAgICAgICAgICAgIGNhc2UgcjogaCA9IChnIC0gYikgLyBkICsgKGcgPCBiID8gNiA6IDApOyBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIGc6IGggPSAoYiAtIHIpIC8gZCArIDI7IGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgYjogaCA9IChyIC0gZykgLyBkICsgNDsgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBoIC89IDY7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgaDogaCwgczogcywgdjogdiB9O1xuICAgIH1cblxuICAgIC8vIGBoc3ZUb1JnYmBcbiAgICAvLyBDb252ZXJ0cyBhbiBIU1YgY29sb3IgdmFsdWUgdG8gUkdCLlxuICAgIC8vICpBc3N1bWVzOiogaCBpcyBjb250YWluZWQgaW4gWzAsIDFdIG9yIFswLCAzNjBdIGFuZCBzIGFuZCB2IGFyZSBjb250YWluZWQgaW4gWzAsIDFdIG9yIFswLCAxMDBdXG4gICAgLy8gKlJldHVybnM6KiB7IHIsIGcsIGIgfSBpbiB0aGUgc2V0IFswLCAyNTVdXG4gICAgIGZ1bmN0aW9uIGhzdlRvUmdiKGgsIHMsIHYpIHtcblxuICAgICAgICBoID0gYm91bmQwMShoLCAzNjApICogNjtcbiAgICAgICAgcyA9IGJvdW5kMDEocywgMTAwKTtcbiAgICAgICAgdiA9IGJvdW5kMDEodiwgMTAwKTtcblxuICAgICAgICB2YXIgaSA9IG1hdGguZmxvb3IoaCksXG4gICAgICAgICAgICBmID0gaCAtIGksXG4gICAgICAgICAgICBwID0gdiAqICgxIC0gcyksXG4gICAgICAgICAgICBxID0gdiAqICgxIC0gZiAqIHMpLFxuICAgICAgICAgICAgdCA9IHYgKiAoMSAtICgxIC0gZikgKiBzKSxcbiAgICAgICAgICAgIG1vZCA9IGkgJSA2LFxuICAgICAgICAgICAgciA9IFt2LCBxLCBwLCBwLCB0LCB2XVttb2RdLFxuICAgICAgICAgICAgZyA9IFt0LCB2LCB2LCBxLCBwLCBwXVttb2RdLFxuICAgICAgICAgICAgYiA9IFtwLCBwLCB0LCB2LCB2LCBxXVttb2RdO1xuXG4gICAgICAgIHJldHVybiB7IHI6IHIgKiAyNTUsIGc6IGcgKiAyNTUsIGI6IGIgKiAyNTUgfTtcbiAgICB9XG5cbiAgICAvLyBgcmdiVG9IZXhgXG4gICAgLy8gQ29udmVydHMgYW4gUkdCIGNvbG9yIHRvIGhleFxuICAgIC8vIEFzc3VtZXMgciwgZywgYW5kIGIgYXJlIGNvbnRhaW5lZCBpbiB0aGUgc2V0IFswLCAyNTVdXG4gICAgLy8gUmV0dXJucyBhIDMgb3IgNiBjaGFyYWN0ZXIgaGV4XG4gICAgZnVuY3Rpb24gcmdiVG9IZXgociwgZywgYiwgYWxsb3czQ2hhcikge1xuXG4gICAgICAgIHZhciBoZXggPSBbXG4gICAgICAgICAgICBwYWQyKG1hdGhSb3VuZChyKS50b1N0cmluZygxNikpLFxuICAgICAgICAgICAgcGFkMihtYXRoUm91bmQoZykudG9TdHJpbmcoMTYpKSxcbiAgICAgICAgICAgIHBhZDIobWF0aFJvdW5kKGIpLnRvU3RyaW5nKDE2KSlcbiAgICAgICAgXTtcblxuICAgICAgICAvLyBSZXR1cm4gYSAzIGNoYXJhY3RlciBoZXggaWYgcG9zc2libGVcbiAgICAgICAgaWYgKGFsbG93M0NoYXIgJiYgaGV4WzBdLmNoYXJBdCgwKSA9PSBoZXhbMF0uY2hhckF0KDEpICYmIGhleFsxXS5jaGFyQXQoMCkgPT0gaGV4WzFdLmNoYXJBdCgxKSAmJiBoZXhbMl0uY2hhckF0KDApID09IGhleFsyXS5jaGFyQXQoMSkpIHtcbiAgICAgICAgICAgIHJldHVybiBoZXhbMF0uY2hhckF0KDApICsgaGV4WzFdLmNoYXJBdCgwKSArIGhleFsyXS5jaGFyQXQoMCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gaGV4LmpvaW4oXCJcIik7XG4gICAgfVxuICAgICAgICAvLyBgcmdiYVRvSGV4YFxuICAgICAgICAvLyBDb252ZXJ0cyBhbiBSR0JBIGNvbG9yIHBsdXMgYWxwaGEgdHJhbnNwYXJlbmN5IHRvIGhleFxuICAgICAgICAvLyBBc3N1bWVzIHIsIGcsIGIgYW5kIGEgYXJlIGNvbnRhaW5lZCBpbiB0aGUgc2V0IFswLCAyNTVdXG4gICAgICAgIC8vIFJldHVybnMgYW4gOCBjaGFyYWN0ZXIgaGV4XG4gICAgICAgIGZ1bmN0aW9uIHJnYmFUb0hleChyLCBnLCBiLCBhKSB7XG5cbiAgICAgICAgICAgIHZhciBoZXggPSBbXG4gICAgICAgICAgICAgICAgcGFkMihjb252ZXJ0RGVjaW1hbFRvSGV4KGEpKSxcbiAgICAgICAgICAgICAgICBwYWQyKG1hdGhSb3VuZChyKS50b1N0cmluZygxNikpLFxuICAgICAgICAgICAgICAgIHBhZDIobWF0aFJvdW5kKGcpLnRvU3RyaW5nKDE2KSksXG4gICAgICAgICAgICAgICAgcGFkMihtYXRoUm91bmQoYikudG9TdHJpbmcoMTYpKVxuICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgcmV0dXJuIGhleC5qb2luKFwiXCIpO1xuICAgICAgICB9XG5cbiAgICAvLyBgZXF1YWxzYFxuICAgIC8vIENhbiBiZSBjYWxsZWQgd2l0aCBhbnkgdGlueWNvbG9yIGlucHV0XG4gICAgdGlueWNvbG9yLmVxdWFscyA9IGZ1bmN0aW9uIChjb2xvcjEsIGNvbG9yMikge1xuICAgICAgICBpZiAoIWNvbG9yMSB8fCAhY29sb3IyKSB7IHJldHVybiBmYWxzZTsgfVxuICAgICAgICByZXR1cm4gdGlueWNvbG9yKGNvbG9yMSkudG9SZ2JTdHJpbmcoKSA9PSB0aW55Y29sb3IoY29sb3IyKS50b1JnYlN0cmluZygpO1xuICAgIH07XG4gICAgdGlueWNvbG9yLnJhbmRvbSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGlueWNvbG9yLmZyb21SYXRpbyh7XG4gICAgICAgICAgICByOiBtYXRoUmFuZG9tKCksXG4gICAgICAgICAgICBnOiBtYXRoUmFuZG9tKCksXG4gICAgICAgICAgICBiOiBtYXRoUmFuZG9tKClcbiAgICAgICAgfSk7XG4gICAgfTtcblxuXG4gICAgLy8gTW9kaWZpY2F0aW9uIEZ1bmN0aW9uc1xuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBUaGFua3MgdG8gbGVzcy5qcyBmb3Igc29tZSBvZiB0aGUgYmFzaWNzIGhlcmVcbiAgICAvLyA8aHR0cHM6Ly9naXRodWIuY29tL2Nsb3VkaGVhZC9sZXNzLmpzL2Jsb2IvbWFzdGVyL2xpYi9sZXNzL2Z1bmN0aW9ucy5qcz5cblxuICAgIGZ1bmN0aW9uIGRlc2F0dXJhdGUoY29sb3IsIGFtb3VudCkge1xuICAgICAgICBhbW91bnQgPSAoYW1vdW50ID09PSAwKSA/IDAgOiAoYW1vdW50IHx8IDEwKTtcbiAgICAgICAgdmFyIGhzbCA9IHRpbnljb2xvcihjb2xvcikudG9Ic2woKTtcbiAgICAgICAgaHNsLnMgLT0gYW1vdW50IC8gMTAwO1xuICAgICAgICBoc2wucyA9IGNsYW1wMDEoaHNsLnMpO1xuICAgICAgICByZXR1cm4gdGlueWNvbG9yKGhzbCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2F0dXJhdGUoY29sb3IsIGFtb3VudCkge1xuICAgICAgICBhbW91bnQgPSAoYW1vdW50ID09PSAwKSA/IDAgOiAoYW1vdW50IHx8IDEwKTtcbiAgICAgICAgdmFyIGhzbCA9IHRpbnljb2xvcihjb2xvcikudG9Ic2woKTtcbiAgICAgICAgaHNsLnMgKz0gYW1vdW50IC8gMTAwO1xuICAgICAgICBoc2wucyA9IGNsYW1wMDEoaHNsLnMpO1xuICAgICAgICByZXR1cm4gdGlueWNvbG9yKGhzbCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ3JleXNjYWxlKGNvbG9yKSB7XG4gICAgICAgIHJldHVybiB0aW55Y29sb3IoY29sb3IpLmRlc2F0dXJhdGUoMTAwKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsaWdodGVuIChjb2xvciwgYW1vdW50KSB7XG4gICAgICAgIGFtb3VudCA9IChhbW91bnQgPT09IDApID8gMCA6IChhbW91bnQgfHwgMTApO1xuICAgICAgICB2YXIgaHNsID0gdGlueWNvbG9yKGNvbG9yKS50b0hzbCgpO1xuICAgICAgICBoc2wubCArPSBhbW91bnQgLyAxMDA7XG4gICAgICAgIGhzbC5sID0gY2xhbXAwMShoc2wubCk7XG4gICAgICAgIHJldHVybiB0aW55Y29sb3IoaHNsKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBicmlnaHRlbihjb2xvciwgYW1vdW50KSB7XG4gICAgICAgIGFtb3VudCA9IChhbW91bnQgPT09IDApID8gMCA6IChhbW91bnQgfHwgMTApO1xuICAgICAgICB2YXIgcmdiID0gdGlueWNvbG9yKGNvbG9yKS50b1JnYigpO1xuICAgICAgICByZ2IuciA9IG1hdGhNYXgoMCwgbWF0aE1pbigyNTUsIHJnYi5yIC0gbWF0aFJvdW5kKDI1NSAqIC0gKGFtb3VudCAvIDEwMCkpKSk7XG4gICAgICAgIHJnYi5nID0gbWF0aE1heCgwLCBtYXRoTWluKDI1NSwgcmdiLmcgLSBtYXRoUm91bmQoMjU1ICogLSAoYW1vdW50IC8gMTAwKSkpKTtcbiAgICAgICAgcmdiLmIgPSBtYXRoTWF4KDAsIG1hdGhNaW4oMjU1LCByZ2IuYiAtIG1hdGhSb3VuZCgyNTUgKiAtIChhbW91bnQgLyAxMDApKSkpO1xuICAgICAgICByZXR1cm4gdGlueWNvbG9yKHJnYik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGFya2VuIChjb2xvciwgYW1vdW50KSB7XG4gICAgICAgIGFtb3VudCA9IChhbW91bnQgPT09IDApID8gMCA6IChhbW91bnQgfHwgMTApO1xuICAgICAgICB2YXIgaHNsID0gdGlueWNvbG9yKGNvbG9yKS50b0hzbCgpO1xuICAgICAgICBoc2wubCAtPSBhbW91bnQgLyAxMDA7XG4gICAgICAgIGhzbC5sID0gY2xhbXAwMShoc2wubCk7XG4gICAgICAgIHJldHVybiB0aW55Y29sb3IoaHNsKTtcbiAgICB9XG5cbiAgICAvLyBTcGluIHRha2VzIGEgcG9zaXRpdmUgb3IgbmVnYXRpdmUgYW1vdW50IHdpdGhpbiBbLTM2MCwgMzYwXSBpbmRpY2F0aW5nIHRoZSBjaGFuZ2Ugb2YgaHVlLlxuICAgIC8vIFZhbHVlcyBvdXRzaWRlIG9mIHRoaXMgcmFuZ2Ugd2lsbCBiZSB3cmFwcGVkIGludG8gdGhpcyByYW5nZS5cbiAgICBmdW5jdGlvbiBzcGluKGNvbG9yLCBhbW91bnQpIHtcbiAgICAgICAgdmFyIGhzbCA9IHRpbnljb2xvcihjb2xvcikudG9Ic2woKTtcbiAgICAgICAgdmFyIGh1ZSA9IChtYXRoUm91bmQoaHNsLmgpICsgYW1vdW50KSAlIDM2MDtcbiAgICAgICAgaHNsLmggPSBodWUgPCAwID8gMzYwICsgaHVlIDogaHVlO1xuICAgICAgICByZXR1cm4gdGlueWNvbG9yKGhzbCk7XG4gICAgfVxuXG4gICAgLy8gQ29tYmluYXRpb24gRnVuY3Rpb25zXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gVGhhbmtzIHRvIGpRdWVyeSB4Q29sb3IgZm9yIHNvbWUgb2YgdGhlIGlkZWFzIGJlaGluZCB0aGVzZVxuICAgIC8vIDxodHRwczovL2dpdGh1Yi5jb20vaW5mdXNpb24valF1ZXJ5LXhjb2xvci9ibG9iL21hc3Rlci9qcXVlcnkueGNvbG9yLmpzPlxuXG4gICAgZnVuY3Rpb24gY29tcGxlbWVudChjb2xvcikge1xuICAgICAgICB2YXIgaHNsID0gdGlueWNvbG9yKGNvbG9yKS50b0hzbCgpO1xuICAgICAgICBoc2wuaCA9IChoc2wuaCArIDE4MCkgJSAzNjA7XG4gICAgICAgIHJldHVybiB0aW55Y29sb3IoaHNsKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB0cmlhZChjb2xvcikge1xuICAgICAgICB2YXIgaHNsID0gdGlueWNvbG9yKGNvbG9yKS50b0hzbCgpO1xuICAgICAgICB2YXIgaCA9IGhzbC5oO1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgdGlueWNvbG9yKGNvbG9yKSxcbiAgICAgICAgICAgIHRpbnljb2xvcih7IGg6IChoICsgMTIwKSAlIDM2MCwgczogaHNsLnMsIGw6IGhzbC5sIH0pLFxuICAgICAgICAgICAgdGlueWNvbG9yKHsgaDogKGggKyAyNDApICUgMzYwLCBzOiBoc2wucywgbDogaHNsLmwgfSlcbiAgICAgICAgXTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB0ZXRyYWQoY29sb3IpIHtcbiAgICAgICAgdmFyIGhzbCA9IHRpbnljb2xvcihjb2xvcikudG9Ic2woKTtcbiAgICAgICAgdmFyIGggPSBoc2wuaDtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHRpbnljb2xvcihjb2xvciksXG4gICAgICAgICAgICB0aW55Y29sb3IoeyBoOiAoaCArIDkwKSAlIDM2MCwgczogaHNsLnMsIGw6IGhzbC5sIH0pLFxuICAgICAgICAgICAgdGlueWNvbG9yKHsgaDogKGggKyAxODApICUgMzYwLCBzOiBoc2wucywgbDogaHNsLmwgfSksXG4gICAgICAgICAgICB0aW55Y29sb3IoeyBoOiAoaCArIDI3MCkgJSAzNjAsIHM6IGhzbC5zLCBsOiBoc2wubCB9KVxuICAgICAgICBdO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNwbGl0Y29tcGxlbWVudChjb2xvcikge1xuICAgICAgICB2YXIgaHNsID0gdGlueWNvbG9yKGNvbG9yKS50b0hzbCgpO1xuICAgICAgICB2YXIgaCA9IGhzbC5oO1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgdGlueWNvbG9yKGNvbG9yKSxcbiAgICAgICAgICAgIHRpbnljb2xvcih7IGg6IChoICsgNzIpICUgMzYwLCBzOiBoc2wucywgbDogaHNsLmx9KSxcbiAgICAgICAgICAgIHRpbnljb2xvcih7IGg6IChoICsgMjE2KSAlIDM2MCwgczogaHNsLnMsIGw6IGhzbC5sfSlcbiAgICAgICAgXTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhbmFsb2dvdXMoY29sb3IsIHJlc3VsdHMsIHNsaWNlcykge1xuICAgICAgICByZXN1bHRzID0gcmVzdWx0cyB8fCA2O1xuICAgICAgICBzbGljZXMgPSBzbGljZXMgfHwgMzA7XG5cbiAgICAgICAgdmFyIGhzbCA9IHRpbnljb2xvcihjb2xvcikudG9Ic2woKTtcbiAgICAgICAgdmFyIHBhcnQgPSAzNjAgLyBzbGljZXM7XG4gICAgICAgIHZhciByZXQgPSBbdGlueWNvbG9yKGNvbG9yKV07XG5cbiAgICAgICAgZm9yIChoc2wuaCA9ICgoaHNsLmggLSAocGFydCAqIHJlc3VsdHMgPj4gMSkpICsgNzIwKSAlIDM2MDsgLS1yZXN1bHRzOyApIHtcbiAgICAgICAgICAgIGhzbC5oID0gKGhzbC5oICsgcGFydCkgJSAzNjA7XG4gICAgICAgICAgICByZXQucHVzaCh0aW55Y29sb3IoaHNsKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBtb25vY2hyb21hdGljKGNvbG9yLCByZXN1bHRzKSB7XG4gICAgICAgIHJlc3VsdHMgPSByZXN1bHRzIHx8IDY7XG4gICAgICAgIHZhciBoc3YgPSB0aW55Y29sb3IoY29sb3IpLnRvSHN2KCk7XG4gICAgICAgIHZhciBoID0gaHN2LmgsIHMgPSBoc3YucywgdiA9IGhzdi52O1xuICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgIHZhciBtb2RpZmljYXRpb24gPSAxIC8gcmVzdWx0cztcblxuICAgICAgICB3aGlsZSAocmVzdWx0cy0tKSB7XG4gICAgICAgICAgICByZXQucHVzaCh0aW55Y29sb3IoeyBoOiBoLCBzOiBzLCB2OiB2fSkpO1xuICAgICAgICAgICAgdiA9ICh2ICsgbW9kaWZpY2F0aW9uKSAlIDE7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH1cblxuICAgIC8vIFV0aWxpdHkgRnVuY3Rpb25zXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICB0aW55Y29sb3IubWl4ID0gZnVuY3Rpb24oY29sb3IxLCBjb2xvcjIsIGFtb3VudCkge1xuICAgICAgICBhbW91bnQgPSAoYW1vdW50ID09PSAwKSA/IDAgOiAoYW1vdW50IHx8IDUwKTtcblxuICAgICAgICB2YXIgcmdiMSA9IHRpbnljb2xvcihjb2xvcjEpLnRvUmdiKCk7XG4gICAgICAgIHZhciByZ2IyID0gdGlueWNvbG9yKGNvbG9yMikudG9SZ2IoKTtcblxuICAgICAgICB2YXIgcCA9IGFtb3VudCAvIDEwMDtcbiAgICAgICAgdmFyIHcgPSBwICogMiAtIDE7XG4gICAgICAgIHZhciBhID0gcmdiMi5hIC0gcmdiMS5hO1xuXG4gICAgICAgIHZhciB3MTtcblxuICAgICAgICBpZiAodyAqIGEgPT0gLTEpIHtcbiAgICAgICAgICAgIHcxID0gdztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHcxID0gKHcgKyBhKSAvICgxICsgdyAqIGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgdzEgPSAodzEgKyAxKSAvIDI7XG5cbiAgICAgICAgdmFyIHcyID0gMSAtIHcxO1xuXG4gICAgICAgIHZhciByZ2JhID0ge1xuICAgICAgICAgICAgcjogcmdiMi5yICogdzEgKyByZ2IxLnIgKiB3MixcbiAgICAgICAgICAgIGc6IHJnYjIuZyAqIHcxICsgcmdiMS5nICogdzIsXG4gICAgICAgICAgICBiOiByZ2IyLmIgKiB3MSArIHJnYjEuYiAqIHcyLFxuICAgICAgICAgICAgYTogcmdiMi5hICogcCAgKyByZ2IxLmEgKiAoMSAtIHApXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHRpbnljb2xvcihyZ2JhKTtcbiAgICB9O1xuXG5cbiAgICAvLyBSZWFkYWJpbGl0eSBGdW5jdGlvbnNcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyA8aHR0cDovL3d3dy53My5vcmcvVFIvQUVSVCNjb2xvci1jb250cmFzdD5cblxuICAgIC8vIGByZWFkYWJpbGl0eWBcbiAgICAvLyBBbmFseXplIHRoZSAyIGNvbG9ycyBhbmQgcmV0dXJucyBhbiBvYmplY3Qgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XG4gICAgLy8gICAgYGJyaWdodG5lc3NgOiBkaWZmZXJlbmNlIGluIGJyaWdodG5lc3MgYmV0d2VlbiB0aGUgdHdvIGNvbG9yc1xuICAgIC8vICAgIGBjb2xvcmA6IGRpZmZlcmVuY2UgaW4gY29sb3IvaHVlIGJldHdlZW4gdGhlIHR3byBjb2xvcnNcbiAgICB0aW55Y29sb3IucmVhZGFiaWxpdHkgPSBmdW5jdGlvbihjb2xvcjEsIGNvbG9yMikge1xuICAgICAgICB2YXIgYzEgPSB0aW55Y29sb3IoY29sb3IxKTtcbiAgICAgICAgdmFyIGMyID0gdGlueWNvbG9yKGNvbG9yMik7XG4gICAgICAgIHZhciByZ2IxID0gYzEudG9SZ2IoKTtcbiAgICAgICAgdmFyIHJnYjIgPSBjMi50b1JnYigpO1xuICAgICAgICB2YXIgYnJpZ2h0bmVzc0EgPSBjMS5nZXRCcmlnaHRuZXNzKCk7XG4gICAgICAgIHZhciBicmlnaHRuZXNzQiA9IGMyLmdldEJyaWdodG5lc3MoKTtcbiAgICAgICAgdmFyIGNvbG9yRGlmZiA9IChcbiAgICAgICAgICAgIE1hdGgubWF4KHJnYjEuciwgcmdiMi5yKSAtIE1hdGgubWluKHJnYjEuciwgcmdiMi5yKSArXG4gICAgICAgICAgICBNYXRoLm1heChyZ2IxLmcsIHJnYjIuZykgLSBNYXRoLm1pbihyZ2IxLmcsIHJnYjIuZykgK1xuICAgICAgICAgICAgTWF0aC5tYXgocmdiMS5iLCByZ2IyLmIpIC0gTWF0aC5taW4ocmdiMS5iLCByZ2IyLmIpXG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGJyaWdodG5lc3M6IE1hdGguYWJzKGJyaWdodG5lc3NBIC0gYnJpZ2h0bmVzc0IpLFxuICAgICAgICAgICAgY29sb3I6IGNvbG9yRGlmZlxuICAgICAgICB9O1xuICAgIH07XG5cbiAgICAvLyBgcmVhZGFibGVgXG4gICAgLy8gaHR0cDovL3d3dy53My5vcmcvVFIvQUVSVCNjb2xvci1jb250cmFzdFxuICAgIC8vIEVuc3VyZSB0aGF0IGZvcmVncm91bmQgYW5kIGJhY2tncm91bmQgY29sb3IgY29tYmluYXRpb25zIHByb3ZpZGUgc3VmZmljaWVudCBjb250cmFzdC5cbiAgICAvLyAqRXhhbXBsZSpcbiAgICAvLyAgICB0aW55Y29sb3IuaXNSZWFkYWJsZShcIiMwMDBcIiwgXCIjMTExXCIpID0+IGZhbHNlXG4gICAgdGlueWNvbG9yLmlzUmVhZGFibGUgPSBmdW5jdGlvbihjb2xvcjEsIGNvbG9yMikge1xuICAgICAgICB2YXIgcmVhZGFiaWxpdHkgPSB0aW55Y29sb3IucmVhZGFiaWxpdHkoY29sb3IxLCBjb2xvcjIpO1xuICAgICAgICByZXR1cm4gcmVhZGFiaWxpdHkuYnJpZ2h0bmVzcyA+IDEyNSAmJiByZWFkYWJpbGl0eS5jb2xvciA+IDUwMDtcbiAgICB9O1xuXG4gICAgLy8gYG1vc3RSZWFkYWJsZWBcbiAgICAvLyBHaXZlbiBhIGJhc2UgY29sb3IgYW5kIGEgbGlzdCBvZiBwb3NzaWJsZSBmb3JlZ3JvdW5kIG9yIGJhY2tncm91bmRcbiAgICAvLyBjb2xvcnMgZm9yIHRoYXQgYmFzZSwgcmV0dXJucyB0aGUgbW9zdCByZWFkYWJsZSBjb2xvci5cbiAgICAvLyAqRXhhbXBsZSpcbiAgICAvLyAgICB0aW55Y29sb3IubW9zdFJlYWRhYmxlKFwiIzEyM1wiLCBbXCIjZmZmXCIsIFwiIzAwMFwiXSkgPT4gXCIjMDAwXCJcbiAgICB0aW55Y29sb3IubW9zdFJlYWRhYmxlID0gZnVuY3Rpb24oYmFzZUNvbG9yLCBjb2xvckxpc3QpIHtcbiAgICAgICAgdmFyIGJlc3RDb2xvciA9IG51bGw7XG4gICAgICAgIHZhciBiZXN0U2NvcmUgPSAwO1xuICAgICAgICB2YXIgYmVzdElzUmVhZGFibGUgPSBmYWxzZTtcbiAgICAgICAgZm9yICh2YXIgaT0wOyBpIDwgY29sb3JMaXN0Lmxlbmd0aDsgaSsrKSB7XG5cbiAgICAgICAgICAgIC8vIFdlIG5vcm1hbGl6ZSBib3RoIGFyb3VuZCB0aGUgXCJhY2NlcHRhYmxlXCIgYnJlYWtpbmcgcG9pbnQsXG4gICAgICAgICAgICAvLyBidXQgcmFuayBicmlnaHRuZXNzIGNvbnN0cmFzdCBoaWdoZXIgdGhhbiBodWUuXG5cbiAgICAgICAgICAgIHZhciByZWFkYWJpbGl0eSA9IHRpbnljb2xvci5yZWFkYWJpbGl0eShiYXNlQ29sb3IsIGNvbG9yTGlzdFtpXSk7XG4gICAgICAgICAgICB2YXIgcmVhZGFibGUgPSByZWFkYWJpbGl0eS5icmlnaHRuZXNzID4gMTI1ICYmIHJlYWRhYmlsaXR5LmNvbG9yID4gNTAwO1xuICAgICAgICAgICAgdmFyIHNjb3JlID0gMyAqIChyZWFkYWJpbGl0eS5icmlnaHRuZXNzIC8gMTI1KSArIChyZWFkYWJpbGl0eS5jb2xvciAvIDUwMCk7XG5cbiAgICAgICAgICAgIGlmICgocmVhZGFibGUgJiYgISBiZXN0SXNSZWFkYWJsZSkgfHxcbiAgICAgICAgICAgICAgICAocmVhZGFibGUgJiYgYmVzdElzUmVhZGFibGUgJiYgc2NvcmUgPiBiZXN0U2NvcmUpIHx8XG4gICAgICAgICAgICAgICAgKCghIHJlYWRhYmxlKSAmJiAoISBiZXN0SXNSZWFkYWJsZSkgJiYgc2NvcmUgPiBiZXN0U2NvcmUpKSB7XG4gICAgICAgICAgICAgICAgYmVzdElzUmVhZGFibGUgPSByZWFkYWJsZTtcbiAgICAgICAgICAgICAgICBiZXN0U2NvcmUgPSBzY29yZTtcbiAgICAgICAgICAgICAgICBiZXN0Q29sb3IgPSB0aW55Y29sb3IoY29sb3JMaXN0W2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYmVzdENvbG9yO1xuICAgIH07XG5cblxuICAgIC8vIEJpZyBMaXN0IG9mIENvbG9yc1xuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIDxodHRwOi8vd3d3LnczLm9yZy9UUi9jc3MzLWNvbG9yLyNzdmctY29sb3I+XG4gICAgdmFyIG5hbWVzID0gdGlueWNvbG9yLm5hbWVzID0ge1xuICAgICAgICBhbGljZWJsdWU6IFwiZjBmOGZmXCIsXG4gICAgICAgIGFudGlxdWV3aGl0ZTogXCJmYWViZDdcIixcbiAgICAgICAgYXF1YTogXCIwZmZcIixcbiAgICAgICAgYXF1YW1hcmluZTogXCI3ZmZmZDRcIixcbiAgICAgICAgYXp1cmU6IFwiZjBmZmZmXCIsXG4gICAgICAgIGJlaWdlOiBcImY1ZjVkY1wiLFxuICAgICAgICBiaXNxdWU6IFwiZmZlNGM0XCIsXG4gICAgICAgIGJsYWNrOiBcIjAwMFwiLFxuICAgICAgICBibGFuY2hlZGFsbW9uZDogXCJmZmViY2RcIixcbiAgICAgICAgYmx1ZTogXCIwMGZcIixcbiAgICAgICAgYmx1ZXZpb2xldDogXCI4YTJiZTJcIixcbiAgICAgICAgYnJvd246IFwiYTUyYTJhXCIsXG4gICAgICAgIGJ1cmx5d29vZDogXCJkZWI4ODdcIixcbiAgICAgICAgYnVybnRzaWVubmE6IFwiZWE3ZTVkXCIsXG4gICAgICAgIGNhZGV0Ymx1ZTogXCI1ZjllYTBcIixcbiAgICAgICAgY2hhcnRyZXVzZTogXCI3ZmZmMDBcIixcbiAgICAgICAgY2hvY29sYXRlOiBcImQyNjkxZVwiLFxuICAgICAgICBjb3JhbDogXCJmZjdmNTBcIixcbiAgICAgICAgY29ybmZsb3dlcmJsdWU6IFwiNjQ5NWVkXCIsXG4gICAgICAgIGNvcm5zaWxrOiBcImZmZjhkY1wiLFxuICAgICAgICBjcmltc29uOiBcImRjMTQzY1wiLFxuICAgICAgICBjeWFuOiBcIjBmZlwiLFxuICAgICAgICBkYXJrYmx1ZTogXCIwMDAwOGJcIixcbiAgICAgICAgZGFya2N5YW46IFwiMDA4YjhiXCIsXG4gICAgICAgIGRhcmtnb2xkZW5yb2Q6IFwiYjg4NjBiXCIsXG4gICAgICAgIGRhcmtncmF5OiBcImE5YTlhOVwiLFxuICAgICAgICBkYXJrZ3JlZW46IFwiMDA2NDAwXCIsXG4gICAgICAgIGRhcmtncmV5OiBcImE5YTlhOVwiLFxuICAgICAgICBkYXJra2hha2k6IFwiYmRiNzZiXCIsXG4gICAgICAgIGRhcmttYWdlbnRhOiBcIjhiMDA4YlwiLFxuICAgICAgICBkYXJrb2xpdmVncmVlbjogXCI1NTZiMmZcIixcbiAgICAgICAgZGFya29yYW5nZTogXCJmZjhjMDBcIixcbiAgICAgICAgZGFya29yY2hpZDogXCI5OTMyY2NcIixcbiAgICAgICAgZGFya3JlZDogXCI4YjAwMDBcIixcbiAgICAgICAgZGFya3NhbG1vbjogXCJlOTk2N2FcIixcbiAgICAgICAgZGFya3NlYWdyZWVuOiBcIjhmYmM4ZlwiLFxuICAgICAgICBkYXJrc2xhdGVibHVlOiBcIjQ4M2Q4YlwiLFxuICAgICAgICBkYXJrc2xhdGVncmF5OiBcIjJmNGY0ZlwiLFxuICAgICAgICBkYXJrc2xhdGVncmV5OiBcIjJmNGY0ZlwiLFxuICAgICAgICBkYXJrdHVycXVvaXNlOiBcIjAwY2VkMVwiLFxuICAgICAgICBkYXJrdmlvbGV0OiBcIjk0MDBkM1wiLFxuICAgICAgICBkZWVwcGluazogXCJmZjE0OTNcIixcbiAgICAgICAgZGVlcHNreWJsdWU6IFwiMDBiZmZmXCIsXG4gICAgICAgIGRpbWdyYXk6IFwiNjk2OTY5XCIsXG4gICAgICAgIGRpbWdyZXk6IFwiNjk2OTY5XCIsXG4gICAgICAgIGRvZGdlcmJsdWU6IFwiMWU5MGZmXCIsXG4gICAgICAgIGZpcmVicmljazogXCJiMjIyMjJcIixcbiAgICAgICAgZmxvcmFsd2hpdGU6IFwiZmZmYWYwXCIsXG4gICAgICAgIGZvcmVzdGdyZWVuOiBcIjIyOGIyMlwiLFxuICAgICAgICBmdWNoc2lhOiBcImYwZlwiLFxuICAgICAgICBnYWluc2Jvcm86IFwiZGNkY2RjXCIsXG4gICAgICAgIGdob3N0d2hpdGU6IFwiZjhmOGZmXCIsXG4gICAgICAgIGdvbGQ6IFwiZmZkNzAwXCIsXG4gICAgICAgIGdvbGRlbnJvZDogXCJkYWE1MjBcIixcbiAgICAgICAgZ3JheTogXCI4MDgwODBcIixcbiAgICAgICAgZ3JlZW46IFwiMDA4MDAwXCIsXG4gICAgICAgIGdyZWVueWVsbG93OiBcImFkZmYyZlwiLFxuICAgICAgICBncmV5OiBcIjgwODA4MFwiLFxuICAgICAgICBob25leWRldzogXCJmMGZmZjBcIixcbiAgICAgICAgaG90cGluazogXCJmZjY5YjRcIixcbiAgICAgICAgaW5kaWFucmVkOiBcImNkNWM1Y1wiLFxuICAgICAgICBpbmRpZ286IFwiNGIwMDgyXCIsXG4gICAgICAgIGl2b3J5OiBcImZmZmZmMFwiLFxuICAgICAgICBraGFraTogXCJmMGU2OGNcIixcbiAgICAgICAgbGF2ZW5kZXI6IFwiZTZlNmZhXCIsXG4gICAgICAgIGxhdmVuZGVyYmx1c2g6IFwiZmZmMGY1XCIsXG4gICAgICAgIGxhd25ncmVlbjogXCI3Y2ZjMDBcIixcbiAgICAgICAgbGVtb25jaGlmZm9uOiBcImZmZmFjZFwiLFxuICAgICAgICBsaWdodGJsdWU6IFwiYWRkOGU2XCIsXG4gICAgICAgIGxpZ2h0Y29yYWw6IFwiZjA4MDgwXCIsXG4gICAgICAgIGxpZ2h0Y3lhbjogXCJlMGZmZmZcIixcbiAgICAgICAgbGlnaHRnb2xkZW5yb2R5ZWxsb3c6IFwiZmFmYWQyXCIsXG4gICAgICAgIGxpZ2h0Z3JheTogXCJkM2QzZDNcIixcbiAgICAgICAgbGlnaHRncmVlbjogXCI5MGVlOTBcIixcbiAgICAgICAgbGlnaHRncmV5OiBcImQzZDNkM1wiLFxuICAgICAgICBsaWdodHBpbms6IFwiZmZiNmMxXCIsXG4gICAgICAgIGxpZ2h0c2FsbW9uOiBcImZmYTA3YVwiLFxuICAgICAgICBsaWdodHNlYWdyZWVuOiBcIjIwYjJhYVwiLFxuICAgICAgICBsaWdodHNreWJsdWU6IFwiODdjZWZhXCIsXG4gICAgICAgIGxpZ2h0c2xhdGVncmF5OiBcIjc4OVwiLFxuICAgICAgICBsaWdodHNsYXRlZ3JleTogXCI3ODlcIixcbiAgICAgICAgbGlnaHRzdGVlbGJsdWU6IFwiYjBjNGRlXCIsXG4gICAgICAgIGxpZ2h0eWVsbG93OiBcImZmZmZlMFwiLFxuICAgICAgICBsaW1lOiBcIjBmMFwiLFxuICAgICAgICBsaW1lZ3JlZW46IFwiMzJjZDMyXCIsXG4gICAgICAgIGxpbmVuOiBcImZhZjBlNlwiLFxuICAgICAgICBtYWdlbnRhOiBcImYwZlwiLFxuICAgICAgICBtYXJvb246IFwiODAwMDAwXCIsXG4gICAgICAgIG1lZGl1bWFxdWFtYXJpbmU6IFwiNjZjZGFhXCIsXG4gICAgICAgIG1lZGl1bWJsdWU6IFwiMDAwMGNkXCIsXG4gICAgICAgIG1lZGl1bW9yY2hpZDogXCJiYTU1ZDNcIixcbiAgICAgICAgbWVkaXVtcHVycGxlOiBcIjkzNzBkYlwiLFxuICAgICAgICBtZWRpdW1zZWFncmVlbjogXCIzY2IzNzFcIixcbiAgICAgICAgbWVkaXVtc2xhdGVibHVlOiBcIjdiNjhlZVwiLFxuICAgICAgICBtZWRpdW1zcHJpbmdncmVlbjogXCIwMGZhOWFcIixcbiAgICAgICAgbWVkaXVtdHVycXVvaXNlOiBcIjQ4ZDFjY1wiLFxuICAgICAgICBtZWRpdW12aW9sZXRyZWQ6IFwiYzcxNTg1XCIsXG4gICAgICAgIG1pZG5pZ2h0Ymx1ZTogXCIxOTE5NzBcIixcbiAgICAgICAgbWludGNyZWFtOiBcImY1ZmZmYVwiLFxuICAgICAgICBtaXN0eXJvc2U6IFwiZmZlNGUxXCIsXG4gICAgICAgIG1vY2Nhc2luOiBcImZmZTRiNVwiLFxuICAgICAgICBuYXZham93aGl0ZTogXCJmZmRlYWRcIixcbiAgICAgICAgbmF2eTogXCIwMDAwODBcIixcbiAgICAgICAgb2xkbGFjZTogXCJmZGY1ZTZcIixcbiAgICAgICAgb2xpdmU6IFwiODA4MDAwXCIsXG4gICAgICAgIG9saXZlZHJhYjogXCI2YjhlMjNcIixcbiAgICAgICAgb3JhbmdlOiBcImZmYTUwMFwiLFxuICAgICAgICBvcmFuZ2VyZWQ6IFwiZmY0NTAwXCIsXG4gICAgICAgIG9yY2hpZDogXCJkYTcwZDZcIixcbiAgICAgICAgcGFsZWdvbGRlbnJvZDogXCJlZWU4YWFcIixcbiAgICAgICAgcGFsZWdyZWVuOiBcIjk4ZmI5OFwiLFxuICAgICAgICBwYWxldHVycXVvaXNlOiBcImFmZWVlZVwiLFxuICAgICAgICBwYWxldmlvbGV0cmVkOiBcImRiNzA5M1wiLFxuICAgICAgICBwYXBheWF3aGlwOiBcImZmZWZkNVwiLFxuICAgICAgICBwZWFjaHB1ZmY6IFwiZmZkYWI5XCIsXG4gICAgICAgIHBlcnU6IFwiY2Q4NTNmXCIsXG4gICAgICAgIHBpbms6IFwiZmZjMGNiXCIsXG4gICAgICAgIHBsdW06IFwiZGRhMGRkXCIsXG4gICAgICAgIHBvd2RlcmJsdWU6IFwiYjBlMGU2XCIsXG4gICAgICAgIHB1cnBsZTogXCI4MDAwODBcIixcbiAgICAgICAgcmViZWNjYXB1cnBsZTogXCI2NjMzOTlcIixcbiAgICAgICAgcmVkOiBcImYwMFwiLFxuICAgICAgICByb3N5YnJvd246IFwiYmM4ZjhmXCIsXG4gICAgICAgIHJveWFsYmx1ZTogXCI0MTY5ZTFcIixcbiAgICAgICAgc2FkZGxlYnJvd246IFwiOGI0NTEzXCIsXG4gICAgICAgIHNhbG1vbjogXCJmYTgwNzJcIixcbiAgICAgICAgc2FuZHlicm93bjogXCJmNGE0NjBcIixcbiAgICAgICAgc2VhZ3JlZW46IFwiMmU4YjU3XCIsXG4gICAgICAgIHNlYXNoZWxsOiBcImZmZjVlZVwiLFxuICAgICAgICBzaWVubmE6IFwiYTA1MjJkXCIsXG4gICAgICAgIHNpbHZlcjogXCJjMGMwYzBcIixcbiAgICAgICAgc2t5Ymx1ZTogXCI4N2NlZWJcIixcbiAgICAgICAgc2xhdGVibHVlOiBcIjZhNWFjZFwiLFxuICAgICAgICBzbGF0ZWdyYXk6IFwiNzA4MDkwXCIsXG4gICAgICAgIHNsYXRlZ3JleTogXCI3MDgwOTBcIixcbiAgICAgICAgc25vdzogXCJmZmZhZmFcIixcbiAgICAgICAgc3ByaW5nZ3JlZW46IFwiMDBmZjdmXCIsXG4gICAgICAgIHN0ZWVsYmx1ZTogXCI0NjgyYjRcIixcbiAgICAgICAgdGFuOiBcImQyYjQ4Y1wiLFxuICAgICAgICB0ZWFsOiBcIjAwODA4MFwiLFxuICAgICAgICB0aGlzdGxlOiBcImQ4YmZkOFwiLFxuICAgICAgICB0b21hdG86IFwiZmY2MzQ3XCIsXG4gICAgICAgIHR1cnF1b2lzZTogXCI0MGUwZDBcIixcbiAgICAgICAgdmlvbGV0OiBcImVlODJlZVwiLFxuICAgICAgICB3aGVhdDogXCJmNWRlYjNcIixcbiAgICAgICAgd2hpdGU6IFwiZmZmXCIsXG4gICAgICAgIHdoaXRlc21va2U6IFwiZjVmNWY1XCIsXG4gICAgICAgIHllbGxvdzogXCJmZjBcIixcbiAgICAgICAgeWVsbG93Z3JlZW46IFwiOWFjZDMyXCJcbiAgICB9O1xuXG4gICAgLy8gTWFrZSBpdCBlYXN5IHRvIGFjY2VzcyBjb2xvcnMgdmlhIGBoZXhOYW1lc1toZXhdYFxuICAgIHZhciBoZXhOYW1lcyA9IHRpbnljb2xvci5oZXhOYW1lcyA9IGZsaXAobmFtZXMpO1xuXG5cbiAgICAvLyBVdGlsaXRpZXNcbiAgICAvLyAtLS0tLS0tLS1cblxuICAgIC8vIGB7ICduYW1lMSc6ICd2YWwxJyB9YCBiZWNvbWVzIGB7ICd2YWwxJzogJ25hbWUxJyB9YFxuICAgIGZ1bmN0aW9uIGZsaXAobykge1xuICAgICAgICB2YXIgZmxpcHBlZCA9IHsgfTtcbiAgICAgICAgZm9yICh2YXIgaSBpbiBvKSB7XG4gICAgICAgICAgICBpZiAoby5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICAgICAgICAgIGZsaXBwZWRbb1tpXV0gPSBpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmbGlwcGVkO1xuICAgIH1cblxuICAgIC8vIFJldHVybiBhIHZhbGlkIGFscGhhIHZhbHVlIFswLDFdIHdpdGggYWxsIGludmFsaWQgdmFsdWVzIGJlaW5nIHNldCB0byAxXG4gICAgZnVuY3Rpb24gYm91bmRBbHBoYShhKSB7XG4gICAgICAgIGEgPSBwYXJzZUZsb2F0KGEpO1xuXG4gICAgICAgIGlmIChpc05hTihhKSB8fCBhIDwgMCB8fCBhID4gMSkge1xuICAgICAgICAgICAgYSA9IDE7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYTtcbiAgICB9XG5cbiAgICAvLyBUYWtlIGlucHV0IGZyb20gWzAsIG5dIGFuZCByZXR1cm4gaXQgYXMgWzAsIDFdXG4gICAgZnVuY3Rpb24gYm91bmQwMShuLCBtYXgpIHtcbiAgICAgICAgaWYgKGlzT25lUG9pbnRaZXJvKG4pKSB7IG4gPSBcIjEwMCVcIjsgfVxuXG4gICAgICAgIHZhciBwcm9jZXNzUGVyY2VudCA9IGlzUGVyY2VudGFnZShuKTtcbiAgICAgICAgbiA9IG1hdGhNaW4obWF4LCBtYXRoTWF4KDAsIHBhcnNlRmxvYXQobikpKTtcblxuICAgICAgICAvLyBBdXRvbWF0aWNhbGx5IGNvbnZlcnQgcGVyY2VudGFnZSBpbnRvIG51bWJlclxuICAgICAgICBpZiAocHJvY2Vzc1BlcmNlbnQpIHtcbiAgICAgICAgICAgIG4gPSBwYXJzZUludChuICogbWF4LCAxMCkgLyAxMDA7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBIYW5kbGUgZmxvYXRpbmcgcG9pbnQgcm91bmRpbmcgZXJyb3JzXG4gICAgICAgIGlmICgobWF0aC5hYnMobiAtIG1heCkgPCAwLjAwMDAwMSkpIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ29udmVydCBpbnRvIFswLCAxXSByYW5nZSBpZiBpdCBpc24ndCBhbHJlYWR5XG4gICAgICAgIHJldHVybiAobiAlIG1heCkgLyBwYXJzZUZsb2F0KG1heCk7XG4gICAgfVxuXG4gICAgLy8gRm9yY2UgYSBudW1iZXIgYmV0d2VlbiAwIGFuZCAxXG4gICAgZnVuY3Rpb24gY2xhbXAwMSh2YWwpIHtcbiAgICAgICAgcmV0dXJuIG1hdGhNaW4oMSwgbWF0aE1heCgwLCB2YWwpKTtcbiAgICB9XG5cbiAgICAvLyBQYXJzZSBhIGJhc2UtMTYgaGV4IHZhbHVlIGludG8gYSBiYXNlLTEwIGludGVnZXJcbiAgICBmdW5jdGlvbiBwYXJzZUludEZyb21IZXgodmFsKSB7XG4gICAgICAgIHJldHVybiBwYXJzZUludCh2YWwsIDE2KTtcbiAgICB9XG5cbiAgICAvLyBOZWVkIHRvIGhhbmRsZSAxLjAgYXMgMTAwJSwgc2luY2Ugb25jZSBpdCBpcyBhIG51bWJlciwgdGhlcmUgaXMgbm8gZGlmZmVyZW5jZSBiZXR3ZWVuIGl0IGFuZCAxXG4gICAgLy8gPGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNzQyMjA3Mi9qYXZhc2NyaXB0LWhvdy10by1kZXRlY3QtbnVtYmVyLWFzLWEtZGVjaW1hbC1pbmNsdWRpbmctMS0wPlxuICAgIGZ1bmN0aW9uIGlzT25lUG9pbnRaZXJvKG4pIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBuID09IFwic3RyaW5nXCIgJiYgbi5pbmRleE9mKCcuJykgIT0gLTEgJiYgcGFyc2VGbG9hdChuKSA9PT0gMTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayB0byBzZWUgaWYgc3RyaW5nIHBhc3NlZCBpbiBpcyBhIHBlcmNlbnRhZ2VcbiAgICBmdW5jdGlvbiBpc1BlcmNlbnRhZ2Uobikge1xuICAgICAgICByZXR1cm4gdHlwZW9mIG4gPT09IFwic3RyaW5nXCIgJiYgbi5pbmRleE9mKCclJykgIT0gLTE7XG4gICAgfVxuXG4gICAgLy8gRm9yY2UgYSBoZXggdmFsdWUgdG8gaGF2ZSAyIGNoYXJhY3RlcnNcbiAgICBmdW5jdGlvbiBwYWQyKGMpIHtcbiAgICAgICAgcmV0dXJuIGMubGVuZ3RoID09IDEgPyAnMCcgKyBjIDogJycgKyBjO1xuICAgIH1cblxuICAgIC8vIFJlcGxhY2UgYSBkZWNpbWFsIHdpdGggaXQncyBwZXJjZW50YWdlIHZhbHVlXG4gICAgZnVuY3Rpb24gY29udmVydFRvUGVyY2VudGFnZShuKSB7XG4gICAgICAgIGlmIChuIDw9IDEpIHtcbiAgICAgICAgICAgIG4gPSAobiAqIDEwMCkgKyBcIiVcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBuO1xuICAgIH1cblxuICAgIC8vIENvbnZlcnRzIGEgZGVjaW1hbCB0byBhIGhleCB2YWx1ZVxuICAgIGZ1bmN0aW9uIGNvbnZlcnREZWNpbWFsVG9IZXgoZCkge1xuICAgICAgICByZXR1cm4gTWF0aC5yb3VuZChwYXJzZUZsb2F0KGQpICogMjU1KS50b1N0cmluZygxNik7XG4gICAgfVxuICAgIC8vIENvbnZlcnRzIGEgaGV4IHZhbHVlIHRvIGEgZGVjaW1hbFxuICAgIGZ1bmN0aW9uIGNvbnZlcnRIZXhUb0RlY2ltYWwoaCkge1xuICAgICAgICByZXR1cm4gKHBhcnNlSW50RnJvbUhleChoKSAvIDI1NSk7XG4gICAgfVxuXG4gICAgdmFyIG1hdGNoZXJzID0gKGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIC8vIDxodHRwOi8vd3d3LnczLm9yZy9UUi9jc3MzLXZhbHVlcy8jaW50ZWdlcnM+XG4gICAgICAgIHZhciBDU1NfSU5URUdFUiA9IFwiWy1cXFxcK10/XFxcXGQrJT9cIjtcblxuICAgICAgICAvLyA8aHR0cDovL3d3dy53My5vcmcvVFIvY3NzMy12YWx1ZXMvI251bWJlci12YWx1ZT5cbiAgICAgICAgdmFyIENTU19OVU1CRVIgPSBcIlstXFxcXCtdP1xcXFxkKlxcXFwuXFxcXGQrJT9cIjtcblxuICAgICAgICAvLyBBbGxvdyBwb3NpdGl2ZS9uZWdhdGl2ZSBpbnRlZ2VyL251bWJlci4gIERvbid0IGNhcHR1cmUgdGhlIGVpdGhlci9vciwganVzdCB0aGUgZW50aXJlIG91dGNvbWUuXG4gICAgICAgIHZhciBDU1NfVU5JVCA9IFwiKD86XCIgKyBDU1NfTlVNQkVSICsgXCIpfCg/OlwiICsgQ1NTX0lOVEVHRVIgKyBcIilcIjtcblxuICAgICAgICAvLyBBY3R1YWwgbWF0Y2hpbmcuXG4gICAgICAgIC8vIFBhcmVudGhlc2VzIGFuZCBjb21tYXMgYXJlIG9wdGlvbmFsLCBidXQgbm90IHJlcXVpcmVkLlxuICAgICAgICAvLyBXaGl0ZXNwYWNlIGNhbiB0YWtlIHRoZSBwbGFjZSBvZiBjb21tYXMgb3Igb3BlbmluZyBwYXJlblxuICAgICAgICB2YXIgUEVSTUlTU0lWRV9NQVRDSDMgPSBcIltcXFxcc3xcXFxcKF0rKFwiICsgQ1NTX1VOSVQgKyBcIilbLHxcXFxcc10rKFwiICsgQ1NTX1VOSVQgKyBcIilbLHxcXFxcc10rKFwiICsgQ1NTX1VOSVQgKyBcIilcXFxccypcXFxcKT9cIjtcbiAgICAgICAgdmFyIFBFUk1JU1NJVkVfTUFUQ0g0ID0gXCJbXFxcXHN8XFxcXChdKyhcIiArIENTU19VTklUICsgXCIpWyx8XFxcXHNdKyhcIiArIENTU19VTklUICsgXCIpWyx8XFxcXHNdKyhcIiArIENTU19VTklUICsgXCIpWyx8XFxcXHNdKyhcIiArIENTU19VTklUICsgXCIpXFxcXHMqXFxcXCk/XCI7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJnYjogbmV3IFJlZ0V4cChcInJnYlwiICsgUEVSTUlTU0lWRV9NQVRDSDMpLFxuICAgICAgICAgICAgcmdiYTogbmV3IFJlZ0V4cChcInJnYmFcIiArIFBFUk1JU1NJVkVfTUFUQ0g0KSxcbiAgICAgICAgICAgIGhzbDogbmV3IFJlZ0V4cChcImhzbFwiICsgUEVSTUlTU0lWRV9NQVRDSDMpLFxuICAgICAgICAgICAgaHNsYTogbmV3IFJlZ0V4cChcImhzbGFcIiArIFBFUk1JU1NJVkVfTUFUQ0g0KSxcbiAgICAgICAgICAgIGhzdjogbmV3IFJlZ0V4cChcImhzdlwiICsgUEVSTUlTU0lWRV9NQVRDSDMpLFxuICAgICAgICAgICAgaHN2YTogbmV3IFJlZ0V4cChcImhzdmFcIiArIFBFUk1JU1NJVkVfTUFUQ0g0KSxcbiAgICAgICAgICAgIGhleDM6IC9eKFswLTlhLWZBLUZdezF9KShbMC05YS1mQS1GXXsxfSkoWzAtOWEtZkEtRl17MX0pJC8sXG4gICAgICAgICAgICBoZXg2OiAvXihbMC05YS1mQS1GXXsyfSkoWzAtOWEtZkEtRl17Mn0pKFswLTlhLWZBLUZdezJ9KSQvLFxuICAgICAgICAgICAgaGV4ODogL14oWzAtOWEtZkEtRl17Mn0pKFswLTlhLWZBLUZdezJ9KShbMC05YS1mQS1GXXsyfSkoWzAtOWEtZkEtRl17Mn0pJC9cbiAgICAgICAgfTtcbiAgICB9KSgpO1xuXG4gICAgLy8gYHN0cmluZ0lucHV0VG9PYmplY3RgXG4gICAgLy8gUGVybWlzc2l2ZSBzdHJpbmcgcGFyc2luZy4gIFRha2UgaW4gYSBudW1iZXIgb2YgZm9ybWF0cywgYW5kIG91dHB1dCBhbiBvYmplY3RcbiAgICAvLyBiYXNlZCBvbiBkZXRlY3RlZCBmb3JtYXQuICBSZXR1cm5zIGB7IHIsIGcsIGIgfWAgb3IgYHsgaCwgcywgbCB9YCBvciBgeyBoLCBzLCB2fWBcbiAgICBmdW5jdGlvbiBzdHJpbmdJbnB1dFRvT2JqZWN0KGNvbG9yKSB7XG5cbiAgICAgICAgY29sb3IgPSBjb2xvci5yZXBsYWNlKHRyaW1MZWZ0LCcnKS5yZXBsYWNlKHRyaW1SaWdodCwgJycpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIHZhciBuYW1lZCA9IGZhbHNlO1xuICAgICAgICBpZiAobmFtZXNbY29sb3JdKSB7XG4gICAgICAgICAgICBjb2xvciA9IG5hbWVzW2NvbG9yXTtcbiAgICAgICAgICAgIG5hbWVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjb2xvciA9PSAndHJhbnNwYXJlbnQnKSB7XG4gICAgICAgICAgICByZXR1cm4geyByOiAwLCBnOiAwLCBiOiAwLCBhOiAwLCBmb3JtYXQ6IFwibmFtZVwiIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUcnkgdG8gbWF0Y2ggc3RyaW5nIGlucHV0IHVzaW5nIHJlZ3VsYXIgZXhwcmVzc2lvbnMuXG4gICAgICAgIC8vIEtlZXAgbW9zdCBvZiB0aGUgbnVtYmVyIGJvdW5kaW5nIG91dCBvZiB0aGlzIGZ1bmN0aW9uIC0gZG9uJ3Qgd29ycnkgYWJvdXQgWzAsMV0gb3IgWzAsMTAwXSBvciBbMCwzNjBdXG4gICAgICAgIC8vIEp1c3QgcmV0dXJuIGFuIG9iamVjdCBhbmQgbGV0IHRoZSBjb252ZXJzaW9uIGZ1bmN0aW9ucyBoYW5kbGUgdGhhdC5cbiAgICAgICAgLy8gVGhpcyB3YXkgdGhlIHJlc3VsdCB3aWxsIGJlIHRoZSBzYW1lIHdoZXRoZXIgdGhlIHRpbnljb2xvciBpcyBpbml0aWFsaXplZCB3aXRoIHN0cmluZyBvciBvYmplY3QuXG4gICAgICAgIHZhciBtYXRjaDtcbiAgICAgICAgaWYgKChtYXRjaCA9IG1hdGNoZXJzLnJnYi5leGVjKGNvbG9yKSkpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHI6IG1hdGNoWzFdLCBnOiBtYXRjaFsyXSwgYjogbWF0Y2hbM10gfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoKG1hdGNoID0gbWF0Y2hlcnMucmdiYS5leGVjKGNvbG9yKSkpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHI6IG1hdGNoWzFdLCBnOiBtYXRjaFsyXSwgYjogbWF0Y2hbM10sIGE6IG1hdGNoWzRdIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKChtYXRjaCA9IG1hdGNoZXJzLmhzbC5leGVjKGNvbG9yKSkpIHtcbiAgICAgICAgICAgIHJldHVybiB7IGg6IG1hdGNoWzFdLCBzOiBtYXRjaFsyXSwgbDogbWF0Y2hbM10gfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoKG1hdGNoID0gbWF0Y2hlcnMuaHNsYS5leGVjKGNvbG9yKSkpIHtcbiAgICAgICAgICAgIHJldHVybiB7IGg6IG1hdGNoWzFdLCBzOiBtYXRjaFsyXSwgbDogbWF0Y2hbM10sIGE6IG1hdGNoWzRdIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKChtYXRjaCA9IG1hdGNoZXJzLmhzdi5leGVjKGNvbG9yKSkpIHtcbiAgICAgICAgICAgIHJldHVybiB7IGg6IG1hdGNoWzFdLCBzOiBtYXRjaFsyXSwgdjogbWF0Y2hbM10gfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoKG1hdGNoID0gbWF0Y2hlcnMuaHN2YS5leGVjKGNvbG9yKSkpIHtcbiAgICAgICAgICAgIHJldHVybiB7IGg6IG1hdGNoWzFdLCBzOiBtYXRjaFsyXSwgdjogbWF0Y2hbM10sIGE6IG1hdGNoWzRdIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKChtYXRjaCA9IG1hdGNoZXJzLmhleDguZXhlYyhjb2xvcikpKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGE6IGNvbnZlcnRIZXhUb0RlY2ltYWwobWF0Y2hbMV0pLFxuICAgICAgICAgICAgICAgIHI6IHBhcnNlSW50RnJvbUhleChtYXRjaFsyXSksXG4gICAgICAgICAgICAgICAgZzogcGFyc2VJbnRGcm9tSGV4KG1hdGNoWzNdKSxcbiAgICAgICAgICAgICAgICBiOiBwYXJzZUludEZyb21IZXgobWF0Y2hbNF0pLFxuICAgICAgICAgICAgICAgIGZvcm1hdDogbmFtZWQgPyBcIm5hbWVcIiA6IFwiaGV4OFwiXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmICgobWF0Y2ggPSBtYXRjaGVycy5oZXg2LmV4ZWMoY29sb3IpKSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICByOiBwYXJzZUludEZyb21IZXgobWF0Y2hbMV0pLFxuICAgICAgICAgICAgICAgIGc6IHBhcnNlSW50RnJvbUhleChtYXRjaFsyXSksXG4gICAgICAgICAgICAgICAgYjogcGFyc2VJbnRGcm9tSGV4KG1hdGNoWzNdKSxcbiAgICAgICAgICAgICAgICBmb3JtYXQ6IG5hbWVkID8gXCJuYW1lXCIgOiBcImhleFwiXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmICgobWF0Y2ggPSBtYXRjaGVycy5oZXgzLmV4ZWMoY29sb3IpKSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICByOiBwYXJzZUludEZyb21IZXgobWF0Y2hbMV0gKyAnJyArIG1hdGNoWzFdKSxcbiAgICAgICAgICAgICAgICBnOiBwYXJzZUludEZyb21IZXgobWF0Y2hbMl0gKyAnJyArIG1hdGNoWzJdKSxcbiAgICAgICAgICAgICAgICBiOiBwYXJzZUludEZyb21IZXgobWF0Y2hbM10gKyAnJyArIG1hdGNoWzNdKSxcbiAgICAgICAgICAgICAgICBmb3JtYXQ6IG5hbWVkID8gXCJuYW1lXCIgOiBcImhleFwiXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHdpbmRvdy50aW55Y29sb3IgPSB0aW55Y29sb3I7XG4gICAgfSkoKTtcblxuXG4gICAgJChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICgkLmZuLnNwZWN0cnVtLmxvYWQpIHtcbiAgICAgICAgICAgICQuZm4uc3BlY3RydW0ucHJvY2Vzc05hdGl2ZUNvbG9ySW5wdXRzKCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxufSk7XG4iLCIvKiEgSGFtbWVyLkpTIC0gdjIuMC40IC0gMjAxNC0wOS0yOFxuICogaHR0cDovL2hhbW1lcmpzLmdpdGh1Yi5pby9cbiAqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgSm9yaWsgVGFuZ2VsZGVyO1xuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlICovXG4hZnVuY3Rpb24oYSxiLGMsZCl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gZShhLGIsYyl7cmV0dXJuIHNldFRpbWVvdXQoayhhLGMpLGIpfWZ1bmN0aW9uIGYoYSxiLGMpe3JldHVybiBBcnJheS5pc0FycmF5KGEpPyhnKGEsY1tiXSxjKSwhMCk6ITF9ZnVuY3Rpb24gZyhhLGIsYyl7dmFyIGU7aWYoYSlpZihhLmZvckVhY2gpYS5mb3JFYWNoKGIsYyk7ZWxzZSBpZihhLmxlbmd0aCE9PWQpZm9yKGU9MDtlPGEubGVuZ3RoOyliLmNhbGwoYyxhW2VdLGUsYSksZSsrO2Vsc2UgZm9yKGUgaW4gYSlhLmhhc093blByb3BlcnR5KGUpJiZiLmNhbGwoYyxhW2VdLGUsYSl9ZnVuY3Rpb24gaChhLGIsYyl7Zm9yKHZhciBlPU9iamVjdC5rZXlzKGIpLGY9MDtmPGUubGVuZ3RoOykoIWN8fGMmJmFbZVtmXV09PT1kKSYmKGFbZVtmXV09YltlW2ZdXSksZisrO3JldHVybiBhfWZ1bmN0aW9uIGkoYSxiKXtyZXR1cm4gaChhLGIsITApfWZ1bmN0aW9uIGooYSxiLGMpe3ZhciBkLGU9Yi5wcm90b3R5cGU7ZD1hLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGUpLGQuY29uc3RydWN0b3I9YSxkLl9zdXBlcj1lLGMmJmgoZCxjKX1mdW5jdGlvbiBrKGEsYil7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGEuYXBwbHkoYixhcmd1bWVudHMpfX1mdW5jdGlvbiBsKGEsYil7cmV0dXJuIHR5cGVvZiBhPT1rYj9hLmFwcGx5KGI/YlswXXx8ZDpkLGIpOmF9ZnVuY3Rpb24gbShhLGIpe3JldHVybiBhPT09ZD9iOmF9ZnVuY3Rpb24gbihhLGIsYyl7ZyhyKGIpLGZ1bmN0aW9uKGIpe2EuYWRkRXZlbnRMaXN0ZW5lcihiLGMsITEpfSl9ZnVuY3Rpb24gbyhhLGIsYyl7ZyhyKGIpLGZ1bmN0aW9uKGIpe2EucmVtb3ZlRXZlbnRMaXN0ZW5lcihiLGMsITEpfSl9ZnVuY3Rpb24gcChhLGIpe2Zvcig7YTspe2lmKGE9PWIpcmV0dXJuITA7YT1hLnBhcmVudE5vZGV9cmV0dXJuITF9ZnVuY3Rpb24gcShhLGIpe3JldHVybiBhLmluZGV4T2YoYik+LTF9ZnVuY3Rpb24gcihhKXtyZXR1cm4gYS50cmltKCkuc3BsaXQoL1xccysvZyl9ZnVuY3Rpb24gcyhhLGIsYyl7aWYoYS5pbmRleE9mJiYhYylyZXR1cm4gYS5pbmRleE9mKGIpO2Zvcih2YXIgZD0wO2Q8YS5sZW5ndGg7KXtpZihjJiZhW2RdW2NdPT1ifHwhYyYmYVtkXT09PWIpcmV0dXJuIGQ7ZCsrfXJldHVybi0xfWZ1bmN0aW9uIHQoYSl7cmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGEsMCl9ZnVuY3Rpb24gdShhLGIsYyl7Zm9yKHZhciBkPVtdLGU9W10sZj0wO2Y8YS5sZW5ndGg7KXt2YXIgZz1iP2FbZl1bYl06YVtmXTtzKGUsZyk8MCYmZC5wdXNoKGFbZl0pLGVbZl09ZyxmKyt9cmV0dXJuIGMmJihkPWI/ZC5zb3J0KGZ1bmN0aW9uKGEsYyl7cmV0dXJuIGFbYl0+Y1tiXX0pOmQuc29ydCgpKSxkfWZ1bmN0aW9uIHYoYSxiKXtmb3IodmFyIGMsZSxmPWJbMF0udG9VcHBlckNhc2UoKStiLnNsaWNlKDEpLGc9MDtnPGliLmxlbmd0aDspe2lmKGM9aWJbZ10sZT1jP2MrZjpiLGUgaW4gYSlyZXR1cm4gZTtnKyt9cmV0dXJuIGR9ZnVuY3Rpb24gdygpe3JldHVybiBvYisrfWZ1bmN0aW9uIHgoYSl7dmFyIGI9YS5vd25lckRvY3VtZW50O3JldHVybiBiLmRlZmF1bHRWaWV3fHxiLnBhcmVudFdpbmRvd31mdW5jdGlvbiB5KGEsYil7dmFyIGM9dGhpczt0aGlzLm1hbmFnZXI9YSx0aGlzLmNhbGxiYWNrPWIsdGhpcy5lbGVtZW50PWEuZWxlbWVudCx0aGlzLnRhcmdldD1hLm9wdGlvbnMuaW5wdXRUYXJnZXQsdGhpcy5kb21IYW5kbGVyPWZ1bmN0aW9uKGIpe2woYS5vcHRpb25zLmVuYWJsZSxbYV0pJiZjLmhhbmRsZXIoYil9LHRoaXMuaW5pdCgpfWZ1bmN0aW9uIHooYSl7dmFyIGIsYz1hLm9wdGlvbnMuaW5wdXRDbGFzcztyZXR1cm4gbmV3KGI9Yz9jOnJiP046c2I/UTpxYj9TOk0pKGEsQSl9ZnVuY3Rpb24gQShhLGIsYyl7dmFyIGQ9Yy5wb2ludGVycy5sZW5ndGgsZT1jLmNoYW5nZWRQb2ludGVycy5sZW5ndGgsZj1iJnliJiZkLWU9PT0wLGc9YiYoQWJ8QmIpJiZkLWU9PT0wO2MuaXNGaXJzdD0hIWYsYy5pc0ZpbmFsPSEhZyxmJiYoYS5zZXNzaW9uPXt9KSxjLmV2ZW50VHlwZT1iLEIoYSxjKSxhLmVtaXQoXCJoYW1tZXIuaW5wdXRcIixjKSxhLnJlY29nbml6ZShjKSxhLnNlc3Npb24ucHJldklucHV0PWN9ZnVuY3Rpb24gQihhLGIpe3ZhciBjPWEuc2Vzc2lvbixkPWIucG9pbnRlcnMsZT1kLmxlbmd0aDtjLmZpcnN0SW5wdXR8fChjLmZpcnN0SW5wdXQ9RShiKSksZT4xJiYhYy5maXJzdE11bHRpcGxlP2MuZmlyc3RNdWx0aXBsZT1FKGIpOjE9PT1lJiYoYy5maXJzdE11bHRpcGxlPSExKTt2YXIgZj1jLmZpcnN0SW5wdXQsZz1jLmZpcnN0TXVsdGlwbGUsaD1nP2cuY2VudGVyOmYuY2VudGVyLGk9Yi5jZW50ZXI9RihkKTtiLnRpbWVTdGFtcD1uYigpLGIuZGVsdGFUaW1lPWIudGltZVN0YW1wLWYudGltZVN0YW1wLGIuYW5nbGU9SihoLGkpLGIuZGlzdGFuY2U9SShoLGkpLEMoYyxiKSxiLm9mZnNldERpcmVjdGlvbj1IKGIuZGVsdGFYLGIuZGVsdGFZKSxiLnNjYWxlPWc/TChnLnBvaW50ZXJzLGQpOjEsYi5yb3RhdGlvbj1nP0soZy5wb2ludGVycyxkKTowLEQoYyxiKTt2YXIgaj1hLmVsZW1lbnQ7cChiLnNyY0V2ZW50LnRhcmdldCxqKSYmKGo9Yi5zcmNFdmVudC50YXJnZXQpLGIudGFyZ2V0PWp9ZnVuY3Rpb24gQyhhLGIpe3ZhciBjPWIuY2VudGVyLGQ9YS5vZmZzZXREZWx0YXx8e30sZT1hLnByZXZEZWx0YXx8e30sZj1hLnByZXZJbnB1dHx8e307KGIuZXZlbnRUeXBlPT09eWJ8fGYuZXZlbnRUeXBlPT09QWIpJiYoZT1hLnByZXZEZWx0YT17eDpmLmRlbHRhWHx8MCx5OmYuZGVsdGFZfHwwfSxkPWEub2Zmc2V0RGVsdGE9e3g6Yy54LHk6Yy55fSksYi5kZWx0YVg9ZS54KyhjLngtZC54KSxiLmRlbHRhWT1lLnkrKGMueS1kLnkpfWZ1bmN0aW9uIEQoYSxiKXt2YXIgYyxlLGYsZyxoPWEubGFzdEludGVydmFsfHxiLGk9Yi50aW1lU3RhbXAtaC50aW1lU3RhbXA7aWYoYi5ldmVudFR5cGUhPUJiJiYoaT54Ynx8aC52ZWxvY2l0eT09PWQpKXt2YXIgaj1oLmRlbHRhWC1iLmRlbHRhWCxrPWguZGVsdGFZLWIuZGVsdGFZLGw9RyhpLGosayk7ZT1sLngsZj1sLnksYz1tYihsLngpPm1iKGwueSk/bC54OmwueSxnPUgoaixrKSxhLmxhc3RJbnRlcnZhbD1ifWVsc2UgYz1oLnZlbG9jaXR5LGU9aC52ZWxvY2l0eVgsZj1oLnZlbG9jaXR5WSxnPWguZGlyZWN0aW9uO2IudmVsb2NpdHk9YyxiLnZlbG9jaXR5WD1lLGIudmVsb2NpdHlZPWYsYi5kaXJlY3Rpb249Z31mdW5jdGlvbiBFKGEpe2Zvcih2YXIgYj1bXSxjPTA7YzxhLnBvaW50ZXJzLmxlbmd0aDspYltjXT17Y2xpZW50WDpsYihhLnBvaW50ZXJzW2NdLmNsaWVudFgpLGNsaWVudFk6bGIoYS5wb2ludGVyc1tjXS5jbGllbnRZKX0sYysrO3JldHVybnt0aW1lU3RhbXA6bmIoKSxwb2ludGVyczpiLGNlbnRlcjpGKGIpLGRlbHRhWDphLmRlbHRhWCxkZWx0YVk6YS5kZWx0YVl9fWZ1bmN0aW9uIEYoYSl7dmFyIGI9YS5sZW5ndGg7aWYoMT09PWIpcmV0dXJue3g6bGIoYVswXS5jbGllbnRYKSx5OmxiKGFbMF0uY2xpZW50WSl9O2Zvcih2YXIgYz0wLGQ9MCxlPTA7Yj5lOyljKz1hW2VdLmNsaWVudFgsZCs9YVtlXS5jbGllbnRZLGUrKztyZXR1cm57eDpsYihjL2IpLHk6bGIoZC9iKX19ZnVuY3Rpb24gRyhhLGIsYyl7cmV0dXJue3g6Yi9hfHwwLHk6Yy9hfHwwfX1mdW5jdGlvbiBIKGEsYil7cmV0dXJuIGE9PT1iP0NiOm1iKGEpPj1tYihiKT9hPjA/RGI6RWI6Yj4wP0ZiOkdifWZ1bmN0aW9uIEkoYSxiLGMpe2N8fChjPUtiKTt2YXIgZD1iW2NbMF1dLWFbY1swXV0sZT1iW2NbMV1dLWFbY1sxXV07cmV0dXJuIE1hdGguc3FydChkKmQrZSplKX1mdW5jdGlvbiBKKGEsYixjKXtjfHwoYz1LYik7dmFyIGQ9YltjWzBdXS1hW2NbMF1dLGU9YltjWzFdXS1hW2NbMV1dO3JldHVybiAxODAqTWF0aC5hdGFuMihlLGQpL01hdGguUEl9ZnVuY3Rpb24gSyhhLGIpe3JldHVybiBKKGJbMV0sYlswXSxMYiktSihhWzFdLGFbMF0sTGIpfWZ1bmN0aW9uIEwoYSxiKXtyZXR1cm4gSShiWzBdLGJbMV0sTGIpL0koYVswXSxhWzFdLExiKX1mdW5jdGlvbiBNKCl7dGhpcy5ldkVsPU5iLHRoaXMuZXZXaW49T2IsdGhpcy5hbGxvdz0hMCx0aGlzLnByZXNzZWQ9ITEseS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9ZnVuY3Rpb24gTigpe3RoaXMuZXZFbD1SYix0aGlzLmV2V2luPVNiLHkuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuc3RvcmU9dGhpcy5tYW5hZ2VyLnNlc3Npb24ucG9pbnRlckV2ZW50cz1bXX1mdW5jdGlvbiBPKCl7dGhpcy5ldlRhcmdldD1VYix0aGlzLmV2V2luPVZiLHRoaXMuc3RhcnRlZD0hMSx5LmFwcGx5KHRoaXMsYXJndW1lbnRzKX1mdW5jdGlvbiBQKGEsYil7dmFyIGM9dChhLnRvdWNoZXMpLGQ9dChhLmNoYW5nZWRUb3VjaGVzKTtyZXR1cm4gYiYoQWJ8QmIpJiYoYz11KGMuY29uY2F0KGQpLFwiaWRlbnRpZmllclwiLCEwKSksW2MsZF19ZnVuY3Rpb24gUSgpe3RoaXMuZXZUYXJnZXQ9WGIsdGhpcy50YXJnZXRJZHM9e30seS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9ZnVuY3Rpb24gUihhLGIpe3ZhciBjPXQoYS50b3VjaGVzKSxkPXRoaXMudGFyZ2V0SWRzO2lmKGImKHlifHpiKSYmMT09PWMubGVuZ3RoKXJldHVybiBkW2NbMF0uaWRlbnRpZmllcl09ITAsW2MsY107dmFyIGUsZixnPXQoYS5jaGFuZ2VkVG91Y2hlcyksaD1bXSxpPXRoaXMudGFyZ2V0O2lmKGY9Yy5maWx0ZXIoZnVuY3Rpb24oYSl7cmV0dXJuIHAoYS50YXJnZXQsaSl9KSxiPT09eWIpZm9yKGU9MDtlPGYubGVuZ3RoOylkW2ZbZV0uaWRlbnRpZmllcl09ITAsZSsrO2ZvcihlPTA7ZTxnLmxlbmd0aDspZFtnW2VdLmlkZW50aWZpZXJdJiZoLnB1c2goZ1tlXSksYiYoQWJ8QmIpJiZkZWxldGUgZFtnW2VdLmlkZW50aWZpZXJdLGUrKztyZXR1cm4gaC5sZW5ndGg/W3UoZi5jb25jYXQoaCksXCJpZGVudGlmaWVyXCIsITApLGhdOnZvaWQgMH1mdW5jdGlvbiBTKCl7eS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIGE9ayh0aGlzLmhhbmRsZXIsdGhpcyk7dGhpcy50b3VjaD1uZXcgUSh0aGlzLm1hbmFnZXIsYSksdGhpcy5tb3VzZT1uZXcgTSh0aGlzLm1hbmFnZXIsYSl9ZnVuY3Rpb24gVChhLGIpe3RoaXMubWFuYWdlcj1hLHRoaXMuc2V0KGIpfWZ1bmN0aW9uIFUoYSl7aWYocShhLGJjKSlyZXR1cm4gYmM7dmFyIGI9cShhLGNjKSxjPXEoYSxkYyk7cmV0dXJuIGImJmM/Y2MrXCIgXCIrZGM6Ynx8Yz9iP2NjOmRjOnEoYSxhYyk/YWM6X2J9ZnVuY3Rpb24gVihhKXt0aGlzLmlkPXcoKSx0aGlzLm1hbmFnZXI9bnVsbCx0aGlzLm9wdGlvbnM9aShhfHx7fSx0aGlzLmRlZmF1bHRzKSx0aGlzLm9wdGlvbnMuZW5hYmxlPW0odGhpcy5vcHRpb25zLmVuYWJsZSwhMCksdGhpcy5zdGF0ZT1lYyx0aGlzLnNpbXVsdGFuZW91cz17fSx0aGlzLnJlcXVpcmVGYWlsPVtdfWZ1bmN0aW9uIFcoYSl7cmV0dXJuIGEmamM/XCJjYW5jZWxcIjphJmhjP1wiZW5kXCI6YSZnYz9cIm1vdmVcIjphJmZjP1wic3RhcnRcIjpcIlwifWZ1bmN0aW9uIFgoYSl7cmV0dXJuIGE9PUdiP1wiZG93blwiOmE9PUZiP1widXBcIjphPT1EYj9cImxlZnRcIjphPT1FYj9cInJpZ2h0XCI6XCJcIn1mdW5jdGlvbiBZKGEsYil7dmFyIGM9Yi5tYW5hZ2VyO3JldHVybiBjP2MuZ2V0KGEpOmF9ZnVuY3Rpb24gWigpe1YuYXBwbHkodGhpcyxhcmd1bWVudHMpfWZ1bmN0aW9uICQoKXtaLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLnBYPW51bGwsdGhpcy5wWT1udWxsfWZ1bmN0aW9uIF8oKXtaLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1mdW5jdGlvbiBhYigpe1YuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuX3RpbWVyPW51bGwsdGhpcy5faW5wdXQ9bnVsbH1mdW5jdGlvbiBiYigpe1ouYXBwbHkodGhpcyxhcmd1bWVudHMpfWZ1bmN0aW9uIGNiKCl7Wi5hcHBseSh0aGlzLGFyZ3VtZW50cyl9ZnVuY3Rpb24gZGIoKXtWLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLnBUaW1lPSExLHRoaXMucENlbnRlcj0hMSx0aGlzLl90aW1lcj1udWxsLHRoaXMuX2lucHV0PW51bGwsdGhpcy5jb3VudD0wfWZ1bmN0aW9uIGViKGEsYil7cmV0dXJuIGI9Ynx8e30sYi5yZWNvZ25pemVycz1tKGIucmVjb2duaXplcnMsZWIuZGVmYXVsdHMucHJlc2V0KSxuZXcgZmIoYSxiKX1mdW5jdGlvbiBmYihhLGIpe2I9Ynx8e30sdGhpcy5vcHRpb25zPWkoYixlYi5kZWZhdWx0cyksdGhpcy5vcHRpb25zLmlucHV0VGFyZ2V0PXRoaXMub3B0aW9ucy5pbnB1dFRhcmdldHx8YSx0aGlzLmhhbmRsZXJzPXt9LHRoaXMuc2Vzc2lvbj17fSx0aGlzLnJlY29nbml6ZXJzPVtdLHRoaXMuZWxlbWVudD1hLHRoaXMuaW5wdXQ9eih0aGlzKSx0aGlzLnRvdWNoQWN0aW9uPW5ldyBUKHRoaXMsdGhpcy5vcHRpb25zLnRvdWNoQWN0aW9uKSxnYih0aGlzLCEwKSxnKGIucmVjb2duaXplcnMsZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5hZGQobmV3IGFbMF0oYVsxXSkpO2FbMl0mJmIucmVjb2duaXplV2l0aChhWzJdKSxhWzNdJiZiLnJlcXVpcmVGYWlsdXJlKGFbM10pfSx0aGlzKX1mdW5jdGlvbiBnYihhLGIpe3ZhciBjPWEuZWxlbWVudDtnKGEub3B0aW9ucy5jc3NQcm9wcyxmdW5jdGlvbihhLGQpe2Muc3R5bGVbdihjLnN0eWxlLGQpXT1iP2E6XCJcIn0pfWZ1bmN0aW9uIGhiKGEsYyl7dmFyIGQ9Yi5jcmVhdGVFdmVudChcIkV2ZW50XCIpO2QuaW5pdEV2ZW50KGEsITAsITApLGQuZ2VzdHVyZT1jLGMudGFyZ2V0LmRpc3BhdGNoRXZlbnQoZCl9dmFyIGliPVtcIlwiLFwid2Via2l0XCIsXCJtb3pcIixcIk1TXCIsXCJtc1wiLFwib1wiXSxqYj1iLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksa2I9XCJmdW5jdGlvblwiLGxiPU1hdGgucm91bmQsbWI9TWF0aC5hYnMsbmI9RGF0ZS5ub3csb2I9MSxwYj0vbW9iaWxlfHRhYmxldHxpcChhZHxob25lfG9kKXxhbmRyb2lkL2kscWI9XCJvbnRvdWNoc3RhcnRcImluIGEscmI9dihhLFwiUG9pbnRlckV2ZW50XCIpIT09ZCxzYj1xYiYmcGIudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSx0Yj1cInRvdWNoXCIsdWI9XCJwZW5cIix2Yj1cIm1vdXNlXCIsd2I9XCJraW5lY3RcIix4Yj0yNSx5Yj0xLHpiPTIsQWI9NCxCYj04LENiPTEsRGI9MixFYj00LEZiPTgsR2I9MTYsSGI9RGJ8RWIsSWI9RmJ8R2IsSmI9SGJ8SWIsS2I9W1wieFwiLFwieVwiXSxMYj1bXCJjbGllbnRYXCIsXCJjbGllbnRZXCJdO3kucHJvdG90eXBlPXtoYW5kbGVyOmZ1bmN0aW9uKCl7fSxpbml0OmZ1bmN0aW9uKCl7dGhpcy5ldkVsJiZuKHRoaXMuZWxlbWVudCx0aGlzLmV2RWwsdGhpcy5kb21IYW5kbGVyKSx0aGlzLmV2VGFyZ2V0JiZuKHRoaXMudGFyZ2V0LHRoaXMuZXZUYXJnZXQsdGhpcy5kb21IYW5kbGVyKSx0aGlzLmV2V2luJiZuKHgodGhpcy5lbGVtZW50KSx0aGlzLmV2V2luLHRoaXMuZG9tSGFuZGxlcil9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmV2RWwmJm8odGhpcy5lbGVtZW50LHRoaXMuZXZFbCx0aGlzLmRvbUhhbmRsZXIpLHRoaXMuZXZUYXJnZXQmJm8odGhpcy50YXJnZXQsdGhpcy5ldlRhcmdldCx0aGlzLmRvbUhhbmRsZXIpLHRoaXMuZXZXaW4mJm8oeCh0aGlzLmVsZW1lbnQpLHRoaXMuZXZXaW4sdGhpcy5kb21IYW5kbGVyKX19O3ZhciBNYj17bW91c2Vkb3duOnliLG1vdXNlbW92ZTp6Yixtb3VzZXVwOkFifSxOYj1cIm1vdXNlZG93blwiLE9iPVwibW91c2Vtb3ZlIG1vdXNldXBcIjtqKE0seSx7aGFuZGxlcjpmdW5jdGlvbihhKXt2YXIgYj1NYlthLnR5cGVdO2ImeWImJjA9PT1hLmJ1dHRvbiYmKHRoaXMucHJlc3NlZD0hMCksYiZ6YiYmMSE9PWEud2hpY2gmJihiPUFiKSx0aGlzLnByZXNzZWQmJnRoaXMuYWxsb3cmJihiJkFiJiYodGhpcy5wcmVzc2VkPSExKSx0aGlzLmNhbGxiYWNrKHRoaXMubWFuYWdlcixiLHtwb2ludGVyczpbYV0sY2hhbmdlZFBvaW50ZXJzOlthXSxwb2ludGVyVHlwZTp2YixzcmNFdmVudDphfSkpfX0pO3ZhciBQYj17cG9pbnRlcmRvd246eWIscG9pbnRlcm1vdmU6emIscG9pbnRlcnVwOkFiLHBvaW50ZXJjYW5jZWw6QmIscG9pbnRlcm91dDpCYn0sUWI9ezI6dGIsMzp1Yiw0OnZiLDU6d2J9LFJiPVwicG9pbnRlcmRvd25cIixTYj1cInBvaW50ZXJtb3ZlIHBvaW50ZXJ1cCBwb2ludGVyY2FuY2VsXCI7YS5NU1BvaW50ZXJFdmVudCYmKFJiPVwiTVNQb2ludGVyRG93blwiLFNiPVwiTVNQb2ludGVyTW92ZSBNU1BvaW50ZXJVcCBNU1BvaW50ZXJDYW5jZWxcIiksaihOLHkse2hhbmRsZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5zdG9yZSxjPSExLGQ9YS50eXBlLnRvTG93ZXJDYXNlKCkucmVwbGFjZShcIm1zXCIsXCJcIiksZT1QYltkXSxmPVFiW2EucG9pbnRlclR5cGVdfHxhLnBvaW50ZXJUeXBlLGc9Zj09dGIsaD1zKGIsYS5wb2ludGVySWQsXCJwb2ludGVySWRcIik7ZSZ5YiYmKDA9PT1hLmJ1dHRvbnx8Zyk/MD5oJiYoYi5wdXNoKGEpLGg9Yi5sZW5ndGgtMSk6ZSYoQWJ8QmIpJiYoYz0hMCksMD5ofHwoYltoXT1hLHRoaXMuY2FsbGJhY2sodGhpcy5tYW5hZ2VyLGUse3BvaW50ZXJzOmIsY2hhbmdlZFBvaW50ZXJzOlthXSxwb2ludGVyVHlwZTpmLHNyY0V2ZW50OmF9KSxjJiZiLnNwbGljZShoLDEpKX19KTt2YXIgVGI9e3RvdWNoc3RhcnQ6eWIsdG91Y2htb3ZlOnpiLHRvdWNoZW5kOkFiLHRvdWNoY2FuY2VsOkJifSxVYj1cInRvdWNoc3RhcnRcIixWYj1cInRvdWNoc3RhcnQgdG91Y2htb3ZlIHRvdWNoZW5kIHRvdWNoY2FuY2VsXCI7aihPLHkse2hhbmRsZXI6ZnVuY3Rpb24oYSl7dmFyIGI9VGJbYS50eXBlXTtpZihiPT09eWImJih0aGlzLnN0YXJ0ZWQ9ITApLHRoaXMuc3RhcnRlZCl7dmFyIGM9UC5jYWxsKHRoaXMsYSxiKTtiJihBYnxCYikmJmNbMF0ubGVuZ3RoLWNbMV0ubGVuZ3RoPT09MCYmKHRoaXMuc3RhcnRlZD0hMSksdGhpcy5jYWxsYmFjayh0aGlzLm1hbmFnZXIsYix7cG9pbnRlcnM6Y1swXSxjaGFuZ2VkUG9pbnRlcnM6Y1sxXSxwb2ludGVyVHlwZTp0YixzcmNFdmVudDphfSl9fX0pO3ZhciBXYj17dG91Y2hzdGFydDp5Yix0b3VjaG1vdmU6emIsdG91Y2hlbmQ6QWIsdG91Y2hjYW5jZWw6QmJ9LFhiPVwidG91Y2hzdGFydCB0b3VjaG1vdmUgdG91Y2hlbmQgdG91Y2hjYW5jZWxcIjtqKFEseSx7aGFuZGxlcjpmdW5jdGlvbihhKXt2YXIgYj1XYlthLnR5cGVdLGM9Ui5jYWxsKHRoaXMsYSxiKTtjJiZ0aGlzLmNhbGxiYWNrKHRoaXMubWFuYWdlcixiLHtwb2ludGVyczpjWzBdLGNoYW5nZWRQb2ludGVyczpjWzFdLHBvaW50ZXJUeXBlOnRiLHNyY0V2ZW50OmF9KX19KSxqKFMseSx7aGFuZGxlcjpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9Yy5wb2ludGVyVHlwZT09dGIsZT1jLnBvaW50ZXJUeXBlPT12YjtpZihkKXRoaXMubW91c2UuYWxsb3c9ITE7ZWxzZSBpZihlJiYhdGhpcy5tb3VzZS5hbGxvdylyZXR1cm47YiYoQWJ8QmIpJiYodGhpcy5tb3VzZS5hbGxvdz0hMCksdGhpcy5jYWxsYmFjayhhLGIsYyl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLnRvdWNoLmRlc3Ryb3koKSx0aGlzLm1vdXNlLmRlc3Ryb3koKX19KTt2YXIgWWI9dihqYi5zdHlsZSxcInRvdWNoQWN0aW9uXCIpLFpiPVliIT09ZCwkYj1cImNvbXB1dGVcIixfYj1cImF1dG9cIixhYz1cIm1hbmlwdWxhdGlvblwiLGJjPVwibm9uZVwiLGNjPVwicGFuLXhcIixkYz1cInBhbi15XCI7VC5wcm90b3R5cGU9e3NldDpmdW5jdGlvbihhKXthPT0kYiYmKGE9dGhpcy5jb21wdXRlKCkpLFpiJiYodGhpcy5tYW5hZ2VyLmVsZW1lbnQuc3R5bGVbWWJdPWEpLHRoaXMuYWN0aW9ucz1hLnRvTG93ZXJDYXNlKCkudHJpbSgpfSx1cGRhdGU6ZnVuY3Rpb24oKXt0aGlzLnNldCh0aGlzLm1hbmFnZXIub3B0aW9ucy50b3VjaEFjdGlvbil9LGNvbXB1dGU6ZnVuY3Rpb24oKXt2YXIgYT1bXTtyZXR1cm4gZyh0aGlzLm1hbmFnZXIucmVjb2duaXplcnMsZnVuY3Rpb24oYil7bChiLm9wdGlvbnMuZW5hYmxlLFtiXSkmJihhPWEuY29uY2F0KGIuZ2V0VG91Y2hBY3Rpb24oKSkpfSksVShhLmpvaW4oXCIgXCIpKX0scHJldmVudERlZmF1bHRzOmZ1bmN0aW9uKGEpe2lmKCFaYil7dmFyIGI9YS5zcmNFdmVudCxjPWEub2Zmc2V0RGlyZWN0aW9uO2lmKHRoaXMubWFuYWdlci5zZXNzaW9uLnByZXZlbnRlZClyZXR1cm4gdm9pZCBiLnByZXZlbnREZWZhdWx0KCk7dmFyIGQ9dGhpcy5hY3Rpb25zLGU9cShkLGJjKSxmPXEoZCxkYyksZz1xKGQsY2MpO3JldHVybiBlfHxmJiZjJkhifHxnJiZjJkliP3RoaXMucHJldmVudFNyYyhiKTp2b2lkIDB9fSxwcmV2ZW50U3JjOmZ1bmN0aW9uKGEpe3RoaXMubWFuYWdlci5zZXNzaW9uLnByZXZlbnRlZD0hMCxhLnByZXZlbnREZWZhdWx0KCl9fTt2YXIgZWM9MSxmYz0yLGdjPTQsaGM9OCxpYz1oYyxqYz0xNixrYz0zMjtWLnByb3RvdHlwZT17ZGVmYXVsdHM6e30sc2V0OmZ1bmN0aW9uKGEpe3JldHVybiBoKHRoaXMub3B0aW9ucyxhKSx0aGlzLm1hbmFnZXImJnRoaXMubWFuYWdlci50b3VjaEFjdGlvbi51cGRhdGUoKSx0aGlzfSxyZWNvZ25pemVXaXRoOmZ1bmN0aW9uKGEpe2lmKGYoYSxcInJlY29nbml6ZVdpdGhcIix0aGlzKSlyZXR1cm4gdGhpczt2YXIgYj10aGlzLnNpbXVsdGFuZW91cztyZXR1cm4gYT1ZKGEsdGhpcyksYlthLmlkXXx8KGJbYS5pZF09YSxhLnJlY29nbml6ZVdpdGgodGhpcykpLHRoaXN9LGRyb3BSZWNvZ25pemVXaXRoOmZ1bmN0aW9uKGEpe3JldHVybiBmKGEsXCJkcm9wUmVjb2duaXplV2l0aFwiLHRoaXMpP3RoaXM6KGE9WShhLHRoaXMpLGRlbGV0ZSB0aGlzLnNpbXVsdGFuZW91c1thLmlkXSx0aGlzKX0scmVxdWlyZUZhaWx1cmU6ZnVuY3Rpb24oYSl7aWYoZihhLFwicmVxdWlyZUZhaWx1cmVcIix0aGlzKSlyZXR1cm4gdGhpczt2YXIgYj10aGlzLnJlcXVpcmVGYWlsO3JldHVybiBhPVkoYSx0aGlzKSwtMT09PXMoYixhKSYmKGIucHVzaChhKSxhLnJlcXVpcmVGYWlsdXJlKHRoaXMpKSx0aGlzfSxkcm9wUmVxdWlyZUZhaWx1cmU6ZnVuY3Rpb24oYSl7aWYoZihhLFwiZHJvcFJlcXVpcmVGYWlsdXJlXCIsdGhpcykpcmV0dXJuIHRoaXM7YT1ZKGEsdGhpcyk7dmFyIGI9cyh0aGlzLnJlcXVpcmVGYWlsLGEpO3JldHVybiBiPi0xJiZ0aGlzLnJlcXVpcmVGYWlsLnNwbGljZShiLDEpLHRoaXN9LGhhc1JlcXVpcmVGYWlsdXJlczpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJlcXVpcmVGYWlsLmxlbmd0aD4wfSxjYW5SZWNvZ25pemVXaXRoOmZ1bmN0aW9uKGEpe3JldHVybiEhdGhpcy5zaW11bHRhbmVvdXNbYS5pZF19LGVtaXQ6ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihiKXtjLm1hbmFnZXIuZW1pdChjLm9wdGlvbnMuZXZlbnQrKGI/VyhkKTpcIlwiKSxhKX12YXIgYz10aGlzLGQ9dGhpcy5zdGF0ZTtoYz5kJiZiKCEwKSxiKCksZD49aGMmJmIoITApfSx0cnlFbWl0OmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmNhbkVtaXQoKT90aGlzLmVtaXQoYSk6dm9pZCh0aGlzLnN0YXRlPWtjKX0sY2FuRW1pdDpmdW5jdGlvbigpe2Zvcih2YXIgYT0wO2E8dGhpcy5yZXF1aXJlRmFpbC5sZW5ndGg7KXtpZighKHRoaXMucmVxdWlyZUZhaWxbYV0uc3RhdGUmKGtjfGVjKSkpcmV0dXJuITE7YSsrfXJldHVybiEwfSxyZWNvZ25pemU6ZnVuY3Rpb24oYSl7dmFyIGI9aCh7fSxhKTtyZXR1cm4gbCh0aGlzLm9wdGlvbnMuZW5hYmxlLFt0aGlzLGJdKT8odGhpcy5zdGF0ZSYoaWN8amN8a2MpJiYodGhpcy5zdGF0ZT1lYyksdGhpcy5zdGF0ZT10aGlzLnByb2Nlc3MoYiksdm9pZCh0aGlzLnN0YXRlJihmY3xnY3xoY3xqYykmJnRoaXMudHJ5RW1pdChiKSkpOih0aGlzLnJlc2V0KCksdm9pZCh0aGlzLnN0YXRlPWtjKSl9LHByb2Nlc3M6ZnVuY3Rpb24oKXt9LGdldFRvdWNoQWN0aW9uOmZ1bmN0aW9uKCl7fSxyZXNldDpmdW5jdGlvbigpe319LGooWixWLHtkZWZhdWx0czp7cG9pbnRlcnM6MX0sYXR0clRlc3Q6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcHRpb25zLnBvaW50ZXJzO3JldHVybiAwPT09Ynx8YS5wb2ludGVycy5sZW5ndGg9PT1ifSxwcm9jZXNzOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuc3RhdGUsYz1hLmV2ZW50VHlwZSxkPWImKGZjfGdjKSxlPXRoaXMuYXR0clRlc3QoYSk7cmV0dXJuIGQmJihjJkJifHwhZSk/YnxqYzpkfHxlP2MmQWI/YnxoYzpiJmZjP2J8Z2M6ZmM6a2N9fSksaigkLFose2RlZmF1bHRzOntldmVudDpcInBhblwiLHRocmVzaG9sZDoxMCxwb2ludGVyczoxLGRpcmVjdGlvbjpKYn0sZ2V0VG91Y2hBY3Rpb246ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMuZGlyZWN0aW9uLGI9W107cmV0dXJuIGEmSGImJmIucHVzaChkYyksYSZJYiYmYi5wdXNoKGNjKSxifSxkaXJlY3Rpb25UZXN0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9ucyxjPSEwLGQ9YS5kaXN0YW5jZSxlPWEuZGlyZWN0aW9uLGY9YS5kZWx0YVgsZz1hLmRlbHRhWTtyZXR1cm4gZSZiLmRpcmVjdGlvbnx8KGIuZGlyZWN0aW9uJkhiPyhlPTA9PT1mP0NiOjA+Zj9EYjpFYixjPWYhPXRoaXMucFgsZD1NYXRoLmFicyhhLmRlbHRhWCkpOihlPTA9PT1nP0NiOjA+Zz9GYjpHYixjPWchPXRoaXMucFksZD1NYXRoLmFicyhhLmRlbHRhWSkpKSxhLmRpcmVjdGlvbj1lLGMmJmQ+Yi50aHJlc2hvbGQmJmUmYi5kaXJlY3Rpb259LGF0dHJUZXN0OmZ1bmN0aW9uKGEpe3JldHVybiBaLnByb3RvdHlwZS5hdHRyVGVzdC5jYWxsKHRoaXMsYSkmJih0aGlzLnN0YXRlJmZjfHwhKHRoaXMuc3RhdGUmZmMpJiZ0aGlzLmRpcmVjdGlvblRlc3QoYSkpfSxlbWl0OmZ1bmN0aW9uKGEpe3RoaXMucFg9YS5kZWx0YVgsdGhpcy5wWT1hLmRlbHRhWTt2YXIgYj1YKGEuZGlyZWN0aW9uKTtiJiZ0aGlzLm1hbmFnZXIuZW1pdCh0aGlzLm9wdGlvbnMuZXZlbnQrYixhKSx0aGlzLl9zdXBlci5lbWl0LmNhbGwodGhpcyxhKX19KSxqKF8sWix7ZGVmYXVsdHM6e2V2ZW50OlwicGluY2hcIix0aHJlc2hvbGQ6MCxwb2ludGVyczoyfSxnZXRUb3VjaEFjdGlvbjpmdW5jdGlvbigpe3JldHVybltiY119LGF0dHJUZXN0OmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLl9zdXBlci5hdHRyVGVzdC5jYWxsKHRoaXMsYSkmJihNYXRoLmFicyhhLnNjYWxlLTEpPnRoaXMub3B0aW9ucy50aHJlc2hvbGR8fHRoaXMuc3RhdGUmZmMpfSxlbWl0OmZ1bmN0aW9uKGEpe2lmKHRoaXMuX3N1cGVyLmVtaXQuY2FsbCh0aGlzLGEpLDEhPT1hLnNjYWxlKXt2YXIgYj1hLnNjYWxlPDE/XCJpblwiOlwib3V0XCI7dGhpcy5tYW5hZ2VyLmVtaXQodGhpcy5vcHRpb25zLmV2ZW50K2IsYSl9fX0pLGooYWIsVix7ZGVmYXVsdHM6e2V2ZW50OlwicHJlc3NcIixwb2ludGVyczoxLHRpbWU6NTAwLHRocmVzaG9sZDo1fSxnZXRUb3VjaEFjdGlvbjpmdW5jdGlvbigpe3JldHVybltfYl19LHByb2Nlc3M6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcHRpb25zLGM9YS5wb2ludGVycy5sZW5ndGg9PT1iLnBvaW50ZXJzLGQ9YS5kaXN0YW5jZTxiLnRocmVzaG9sZCxmPWEuZGVsdGFUaW1lPmIudGltZTtpZih0aGlzLl9pbnB1dD1hLCFkfHwhY3x8YS5ldmVudFR5cGUmKEFifEJiKSYmIWYpdGhpcy5yZXNldCgpO2Vsc2UgaWYoYS5ldmVudFR5cGUmeWIpdGhpcy5yZXNldCgpLHRoaXMuX3RpbWVyPWUoZnVuY3Rpb24oKXt0aGlzLnN0YXRlPWljLHRoaXMudHJ5RW1pdCgpfSxiLnRpbWUsdGhpcyk7ZWxzZSBpZihhLmV2ZW50VHlwZSZBYilyZXR1cm4gaWM7cmV0dXJuIGtjfSxyZXNldDpmdW5jdGlvbigpe2NsZWFyVGltZW91dCh0aGlzLl90aW1lcil9LGVtaXQ6ZnVuY3Rpb24oYSl7dGhpcy5zdGF0ZT09PWljJiYoYSYmYS5ldmVudFR5cGUmQWI/dGhpcy5tYW5hZ2VyLmVtaXQodGhpcy5vcHRpb25zLmV2ZW50K1widXBcIixhKToodGhpcy5faW5wdXQudGltZVN0YW1wPW5iKCksdGhpcy5tYW5hZ2VyLmVtaXQodGhpcy5vcHRpb25zLmV2ZW50LHRoaXMuX2lucHV0KSkpfX0pLGooYmIsWix7ZGVmYXVsdHM6e2V2ZW50Olwicm90YXRlXCIsdGhyZXNob2xkOjAscG9pbnRlcnM6Mn0sZ2V0VG91Y2hBY3Rpb246ZnVuY3Rpb24oKXtyZXR1cm5bYmNdfSxhdHRyVGVzdDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5fc3VwZXIuYXR0clRlc3QuY2FsbCh0aGlzLGEpJiYoTWF0aC5hYnMoYS5yb3RhdGlvbik+dGhpcy5vcHRpb25zLnRocmVzaG9sZHx8dGhpcy5zdGF0ZSZmYyl9fSksaihjYixaLHtkZWZhdWx0czp7ZXZlbnQ6XCJzd2lwZVwiLHRocmVzaG9sZDoxMCx2ZWxvY2l0eTouNjUsZGlyZWN0aW9uOkhifEliLHBvaW50ZXJzOjF9LGdldFRvdWNoQWN0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuICQucHJvdG90eXBlLmdldFRvdWNoQWN0aW9uLmNhbGwodGhpcyl9LGF0dHJUZXN0OmZ1bmN0aW9uKGEpe3ZhciBiLGM9dGhpcy5vcHRpb25zLmRpcmVjdGlvbjtyZXR1cm4gYyYoSGJ8SWIpP2I9YS52ZWxvY2l0eTpjJkhiP2I9YS52ZWxvY2l0eVg6YyZJYiYmKGI9YS52ZWxvY2l0eVkpLHRoaXMuX3N1cGVyLmF0dHJUZXN0LmNhbGwodGhpcyxhKSYmYyZhLmRpcmVjdGlvbiYmYS5kaXN0YW5jZT50aGlzLm9wdGlvbnMudGhyZXNob2xkJiZtYihiKT50aGlzLm9wdGlvbnMudmVsb2NpdHkmJmEuZXZlbnRUeXBlJkFifSxlbWl0OmZ1bmN0aW9uKGEpe3ZhciBiPVgoYS5kaXJlY3Rpb24pO2ImJnRoaXMubWFuYWdlci5lbWl0KHRoaXMub3B0aW9ucy5ldmVudCtiLGEpLHRoaXMubWFuYWdlci5lbWl0KHRoaXMub3B0aW9ucy5ldmVudCxhKX19KSxqKGRiLFYse2RlZmF1bHRzOntldmVudDpcInRhcFwiLHBvaW50ZXJzOjEsdGFwczoxLGludGVydmFsOjMwMCx0aW1lOjI1MCx0aHJlc2hvbGQ6Mixwb3NUaHJlc2hvbGQ6MTB9LGdldFRvdWNoQWN0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuW2FjXX0scHJvY2VzczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm9wdGlvbnMsYz1hLnBvaW50ZXJzLmxlbmd0aD09PWIucG9pbnRlcnMsZD1hLmRpc3RhbmNlPGIudGhyZXNob2xkLGY9YS5kZWx0YVRpbWU8Yi50aW1lO2lmKHRoaXMucmVzZXQoKSxhLmV2ZW50VHlwZSZ5YiYmMD09PXRoaXMuY291bnQpcmV0dXJuIHRoaXMuZmFpbFRpbWVvdXQoKTtpZihkJiZmJiZjKXtpZihhLmV2ZW50VHlwZSE9QWIpcmV0dXJuIHRoaXMuZmFpbFRpbWVvdXQoKTt2YXIgZz10aGlzLnBUaW1lP2EudGltZVN0YW1wLXRoaXMucFRpbWU8Yi5pbnRlcnZhbDohMCxoPSF0aGlzLnBDZW50ZXJ8fEkodGhpcy5wQ2VudGVyLGEuY2VudGVyKTxiLnBvc1RocmVzaG9sZDt0aGlzLnBUaW1lPWEudGltZVN0YW1wLHRoaXMucENlbnRlcj1hLmNlbnRlcixoJiZnP3RoaXMuY291bnQrPTE6dGhpcy5jb3VudD0xLHRoaXMuX2lucHV0PWE7dmFyIGk9dGhpcy5jb3VudCViLnRhcHM7aWYoMD09PWkpcmV0dXJuIHRoaXMuaGFzUmVxdWlyZUZhaWx1cmVzKCk/KHRoaXMuX3RpbWVyPWUoZnVuY3Rpb24oKXt0aGlzLnN0YXRlPWljLHRoaXMudHJ5RW1pdCgpfSxiLmludGVydmFsLHRoaXMpLGZjKTppY31yZXR1cm4ga2N9LGZhaWxUaW1lb3V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3RpbWVyPWUoZnVuY3Rpb24oKXt0aGlzLnN0YXRlPWtjfSx0aGlzLm9wdGlvbnMuaW50ZXJ2YWwsdGhpcyksa2N9LHJlc2V0OmZ1bmN0aW9uKCl7Y2xlYXJUaW1lb3V0KHRoaXMuX3RpbWVyKX0sZW1pdDpmdW5jdGlvbigpe3RoaXMuc3RhdGU9PWljJiYodGhpcy5faW5wdXQudGFwQ291bnQ9dGhpcy5jb3VudCx0aGlzLm1hbmFnZXIuZW1pdCh0aGlzLm9wdGlvbnMuZXZlbnQsdGhpcy5faW5wdXQpKX19KSxlYi5WRVJTSU9OPVwiMi4wLjRcIixlYi5kZWZhdWx0cz17ZG9tRXZlbnRzOiExLHRvdWNoQWN0aW9uOiRiLGVuYWJsZTohMCxpbnB1dFRhcmdldDpudWxsLGlucHV0Q2xhc3M6bnVsbCxwcmVzZXQ6W1tiYix7ZW5hYmxlOiExfV0sW18se2VuYWJsZTohMX0sW1wicm90YXRlXCJdXSxbY2Ise2RpcmVjdGlvbjpIYn1dLFskLHtkaXJlY3Rpb246SGJ9LFtcInN3aXBlXCJdXSxbZGJdLFtkYix7ZXZlbnQ6XCJkb3VibGV0YXBcIix0YXBzOjJ9LFtcInRhcFwiXV0sW2FiXV0sY3NzUHJvcHM6e3VzZXJTZWxlY3Q6XCJub25lXCIsdG91Y2hTZWxlY3Q6XCJub25lXCIsdG91Y2hDYWxsb3V0Olwibm9uZVwiLGNvbnRlbnRab29taW5nOlwibm9uZVwiLHVzZXJEcmFnOlwibm9uZVwiLHRhcEhpZ2hsaWdodENvbG9yOlwicmdiYSgwLDAsMCwwKVwifX07dmFyIGxjPTEsbWM9MjtmYi5wcm90b3R5cGU9e3NldDpmdW5jdGlvbihhKXtyZXR1cm4gaCh0aGlzLm9wdGlvbnMsYSksYS50b3VjaEFjdGlvbiYmdGhpcy50b3VjaEFjdGlvbi51cGRhdGUoKSxhLmlucHV0VGFyZ2V0JiYodGhpcy5pbnB1dC5kZXN0cm95KCksdGhpcy5pbnB1dC50YXJnZXQ9YS5pbnB1dFRhcmdldCx0aGlzLmlucHV0LmluaXQoKSksdGhpc30sc3RvcDpmdW5jdGlvbihhKXt0aGlzLnNlc3Npb24uc3RvcHBlZD1hP21jOmxjfSxyZWNvZ25pemU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5zZXNzaW9uO2lmKCFiLnN0b3BwZWQpe3RoaXMudG91Y2hBY3Rpb24ucHJldmVudERlZmF1bHRzKGEpO3ZhciBjLGQ9dGhpcy5yZWNvZ25pemVycyxlPWIuY3VyUmVjb2duaXplcjsoIWV8fGUmJmUuc3RhdGUmaWMpJiYoZT1iLmN1clJlY29nbml6ZXI9bnVsbCk7Zm9yKHZhciBmPTA7ZjxkLmxlbmd0aDspYz1kW2ZdLGIuc3RvcHBlZD09PW1jfHxlJiZjIT1lJiYhYy5jYW5SZWNvZ25pemVXaXRoKGUpP2MucmVzZXQoKTpjLnJlY29nbml6ZShhKSwhZSYmYy5zdGF0ZSYoZmN8Z2N8aGMpJiYoZT1iLmN1clJlY29nbml6ZXI9YyksZisrfX0sZ2V0OmZ1bmN0aW9uKGEpe2lmKGEgaW5zdGFuY2VvZiBWKXJldHVybiBhO2Zvcih2YXIgYj10aGlzLnJlY29nbml6ZXJzLGM9MDtjPGIubGVuZ3RoO2MrKylpZihiW2NdLm9wdGlvbnMuZXZlbnQ9PWEpcmV0dXJuIGJbY107cmV0dXJuIG51bGx9LGFkZDpmdW5jdGlvbihhKXtpZihmKGEsXCJhZGRcIix0aGlzKSlyZXR1cm4gdGhpczt2YXIgYj10aGlzLmdldChhLm9wdGlvbnMuZXZlbnQpO3JldHVybiBiJiZ0aGlzLnJlbW92ZShiKSx0aGlzLnJlY29nbml6ZXJzLnB1c2goYSksYS5tYW5hZ2VyPXRoaXMsdGhpcy50b3VjaEFjdGlvbi51cGRhdGUoKSxhfSxyZW1vdmU6ZnVuY3Rpb24oYSl7aWYoZihhLFwicmVtb3ZlXCIsdGhpcykpcmV0dXJuIHRoaXM7dmFyIGI9dGhpcy5yZWNvZ25pemVycztyZXR1cm4gYT10aGlzLmdldChhKSxiLnNwbGljZShzKGIsYSksMSksdGhpcy50b3VjaEFjdGlvbi51cGRhdGUoKSx0aGlzfSxvbjpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuaGFuZGxlcnM7cmV0dXJuIGcocihhKSxmdW5jdGlvbihhKXtjW2FdPWNbYV18fFtdLGNbYV0ucHVzaChiKX0pLHRoaXN9LG9mZjpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuaGFuZGxlcnM7cmV0dXJuIGcocihhKSxmdW5jdGlvbihhKXtiP2NbYV0uc3BsaWNlKHMoY1thXSxiKSwxKTpkZWxldGUgY1thXX0pLHRoaXN9LGVtaXQ6ZnVuY3Rpb24oYSxiKXt0aGlzLm9wdGlvbnMuZG9tRXZlbnRzJiZoYihhLGIpO3ZhciBjPXRoaXMuaGFuZGxlcnNbYV0mJnRoaXMuaGFuZGxlcnNbYV0uc2xpY2UoKTtpZihjJiZjLmxlbmd0aCl7Yi50eXBlPWEsYi5wcmV2ZW50RGVmYXVsdD1mdW5jdGlvbigpe2Iuc3JjRXZlbnQucHJldmVudERlZmF1bHQoKX07Zm9yKHZhciBkPTA7ZDxjLmxlbmd0aDspY1tkXShiKSxkKyt9fSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5lbGVtZW50JiZnYih0aGlzLCExKSx0aGlzLmhhbmRsZXJzPXt9LHRoaXMuc2Vzc2lvbj17fSx0aGlzLmlucHV0LmRlc3Ryb3koKSx0aGlzLmVsZW1lbnQ9bnVsbH19LGgoZWIse0lOUFVUX1NUQVJUOnliLElOUFVUX01PVkU6emIsSU5QVVRfRU5EOkFiLElOUFVUX0NBTkNFTDpCYixTVEFURV9QT1NTSUJMRTplYyxTVEFURV9CRUdBTjpmYyxTVEFURV9DSEFOR0VEOmdjLFNUQVRFX0VOREVEOmhjLFNUQVRFX1JFQ09HTklaRUQ6aWMsU1RBVEVfQ0FOQ0VMTEVEOmpjLFNUQVRFX0ZBSUxFRDprYyxESVJFQ1RJT05fTk9ORTpDYixESVJFQ1RJT05fTEVGVDpEYixESVJFQ1RJT05fUklHSFQ6RWIsRElSRUNUSU9OX1VQOkZiLERJUkVDVElPTl9ET1dOOkdiLERJUkVDVElPTl9IT1JJWk9OVEFMOkhiLERJUkVDVElPTl9WRVJUSUNBTDpJYixESVJFQ1RJT05fQUxMOkpiLE1hbmFnZXI6ZmIsSW5wdXQ6eSxUb3VjaEFjdGlvbjpULFRvdWNoSW5wdXQ6USxNb3VzZUlucHV0Ok0sUG9pbnRlckV2ZW50SW5wdXQ6TixUb3VjaE1vdXNlSW5wdXQ6UyxTaW5nbGVUb3VjaElucHV0Ok8sUmVjb2duaXplcjpWLEF0dHJSZWNvZ25pemVyOlosVGFwOmRiLFBhbjokLFN3aXBlOmNiLFBpbmNoOl8sUm90YXRlOmJiLFByZXNzOmFiLG9uOm4sb2ZmOm8sZWFjaDpnLG1lcmdlOmksZXh0ZW5kOmgsaW5oZXJpdDpqLGJpbmRGbjprLHByZWZpeGVkOnZ9KSx0eXBlb2YgZGVmaW5lPT1rYiYmZGVmaW5lLmFtZD9kZWZpbmUoZnVuY3Rpb24oKXtyZXR1cm4gZWJ9KTpcInVuZGVmaW5lZFwiIT10eXBlb2YgbW9kdWxlJiZtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1lYjphW2NdPWVifSh3aW5kb3csZG9jdW1lbnQsXCJIYW1tZXJcIik7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1oYW1tZXIubWluLm1hcCIsIi8qID09IGpxdWVyeSBtb3VzZXdoZWVsIHBsdWdpbiA9PSBWZXJzaW9uOiAzLjEuMTIsIExpY2Vuc2U6IE1JVCBMaWNlbnNlIChNSVQpICovXG4hZnVuY3Rpb24oYSl7XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShbXCJqcXVlcnlcIl0sYSk6XCJvYmplY3RcIj09dHlwZW9mIGV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9YTphKGpRdWVyeSl9KGZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYil7dmFyIGc9Ynx8d2luZG93LmV2ZW50LGg9aS5jYWxsKGFyZ3VtZW50cywxKSxqPTAsbD0wLG09MCxuPTAsbz0wLHA9MDtpZihiPWEuZXZlbnQuZml4KGcpLGIudHlwZT1cIm1vdXNld2hlZWxcIixcImRldGFpbFwiaW4gZyYmKG09LTEqZy5kZXRhaWwpLFwid2hlZWxEZWx0YVwiaW4gZyYmKG09Zy53aGVlbERlbHRhKSxcIndoZWVsRGVsdGFZXCJpbiBnJiYobT1nLndoZWVsRGVsdGFZKSxcIndoZWVsRGVsdGFYXCJpbiBnJiYobD0tMSpnLndoZWVsRGVsdGFYKSxcImF4aXNcImluIGcmJmcuYXhpcz09PWcuSE9SSVpPTlRBTF9BWElTJiYobD0tMSptLG09MCksaj0wPT09bT9sOm0sXCJkZWx0YVlcImluIGcmJihtPS0xKmcuZGVsdGFZLGo9bSksXCJkZWx0YVhcImluIGcmJihsPWcuZGVsdGFYLDA9PT1tJiYoaj0tMSpsKSksMCE9PW18fDAhPT1sKXtpZigxPT09Zy5kZWx0YU1vZGUpe3ZhciBxPWEuZGF0YSh0aGlzLFwibW91c2V3aGVlbC1saW5lLWhlaWdodFwiKTtqKj1xLG0qPXEsbCo9cX1lbHNlIGlmKDI9PT1nLmRlbHRhTW9kZSl7dmFyIHI9YS5kYXRhKHRoaXMsXCJtb3VzZXdoZWVsLXBhZ2UtaGVpZ2h0XCIpO2oqPXIsbSo9cixsKj1yfWlmKG49TWF0aC5tYXgoTWF0aC5hYnMobSksTWF0aC5hYnMobCkpLCghZnx8Zj5uKSYmKGY9bixkKGcsbikmJihmLz00MCkpLGQoZyxuKSYmKGovPTQwLGwvPTQwLG0vPTQwKSxqPU1hdGhbaj49MT9cImZsb29yXCI6XCJjZWlsXCJdKGovZiksbD1NYXRoW2w+PTE/XCJmbG9vclwiOlwiY2VpbFwiXShsL2YpLG09TWF0aFttPj0xP1wiZmxvb3JcIjpcImNlaWxcIl0obS9mKSxrLnNldHRpbmdzLm5vcm1hbGl6ZU9mZnNldCYmdGhpcy5nZXRCb3VuZGluZ0NsaWVudFJlY3Qpe3ZhciBzPXRoaXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7bz1iLmNsaWVudFgtcy5sZWZ0LHA9Yi5jbGllbnRZLXMudG9wfXJldHVybiBiLmRlbHRhWD1sLGIuZGVsdGFZPW0sYi5kZWx0YUZhY3Rvcj1mLGIub2Zmc2V0WD1vLGIub2Zmc2V0WT1wLGIuZGVsdGFNb2RlPTAsaC51bnNoaWZ0KGIsaixsLG0pLGUmJmNsZWFyVGltZW91dChlKSxlPXNldFRpbWVvdXQoYywyMDApLChhLmV2ZW50LmRpc3BhdGNofHxhLmV2ZW50LmhhbmRsZSkuYXBwbHkodGhpcyxoKX19ZnVuY3Rpb24gYygpe2Y9bnVsbH1mdW5jdGlvbiBkKGEsYil7cmV0dXJuIGsuc2V0dGluZ3MuYWRqdXN0T2xkRGVsdGFzJiZcIm1vdXNld2hlZWxcIj09PWEudHlwZSYmYiUxMjA9PT0wfXZhciBlLGYsZz1bXCJ3aGVlbFwiLFwibW91c2V3aGVlbFwiLFwiRE9NTW91c2VTY3JvbGxcIixcIk1vek1vdXNlUGl4ZWxTY3JvbGxcIl0saD1cIm9ud2hlZWxcImluIGRvY3VtZW50fHxkb2N1bWVudC5kb2N1bWVudE1vZGU+PTk/W1wid2hlZWxcIl06W1wibW91c2V3aGVlbFwiLFwiRG9tTW91c2VTY3JvbGxcIixcIk1vek1vdXNlUGl4ZWxTY3JvbGxcIl0saT1BcnJheS5wcm90b3R5cGUuc2xpY2U7aWYoYS5ldmVudC5maXhIb29rcylmb3IodmFyIGo9Zy5sZW5ndGg7ajspYS5ldmVudC5maXhIb29rc1tnWy0tal1dPWEuZXZlbnQubW91c2VIb29rczt2YXIgaz1hLmV2ZW50LnNwZWNpYWwubW91c2V3aGVlbD17dmVyc2lvbjpcIjMuMS4xMlwiLHNldHVwOmZ1bmN0aW9uKCl7aWYodGhpcy5hZGRFdmVudExpc3RlbmVyKWZvcih2YXIgYz1oLmxlbmd0aDtjOyl0aGlzLmFkZEV2ZW50TGlzdGVuZXIoaFstLWNdLGIsITEpO2Vsc2UgdGhpcy5vbm1vdXNld2hlZWw9YjthLmRhdGEodGhpcyxcIm1vdXNld2hlZWwtbGluZS1oZWlnaHRcIixrLmdldExpbmVIZWlnaHQodGhpcykpLGEuZGF0YSh0aGlzLFwibW91c2V3aGVlbC1wYWdlLWhlaWdodFwiLGsuZ2V0UGFnZUhlaWdodCh0aGlzKSl9LHRlYXJkb3duOmZ1bmN0aW9uKCl7aWYodGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKWZvcih2YXIgYz1oLmxlbmd0aDtjOyl0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoaFstLWNdLGIsITEpO2Vsc2UgdGhpcy5vbm1vdXNld2hlZWw9bnVsbDthLnJlbW92ZURhdGEodGhpcyxcIm1vdXNld2hlZWwtbGluZS1oZWlnaHRcIiksYS5yZW1vdmVEYXRhKHRoaXMsXCJtb3VzZXdoZWVsLXBhZ2UtaGVpZ2h0XCIpfSxnZXRMaW5lSGVpZ2h0OmZ1bmN0aW9uKGIpe3ZhciBjPWEoYiksZD1jW1wib2Zmc2V0UGFyZW50XCJpbiBhLmZuP1wib2Zmc2V0UGFyZW50XCI6XCJwYXJlbnRcIl0oKTtyZXR1cm4gZC5sZW5ndGh8fChkPWEoXCJib2R5XCIpKSxwYXJzZUludChkLmNzcyhcImZvbnRTaXplXCIpLDEwKXx8cGFyc2VJbnQoYy5jc3MoXCJmb250U2l6ZVwiKSwxMCl8fDE2fSxnZXRQYWdlSGVpZ2h0OmZ1bmN0aW9uKGIpe3JldHVybiBhKGIpLmhlaWdodCgpfSxzZXR0aW5nczp7YWRqdXN0T2xkRGVsdGFzOiEwLG5vcm1hbGl6ZU9mZnNldDohMH19O2EuZm4uZXh0ZW5kKHttb3VzZXdoZWVsOmZ1bmN0aW9uKGEpe3JldHVybiBhP3RoaXMuYmluZChcIm1vdXNld2hlZWxcIixhKTp0aGlzLnRyaWdnZXIoXCJtb3VzZXdoZWVsXCIpfSx1bm1vdXNld2hlZWw6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMudW5iaW5kKFwibW91c2V3aGVlbFwiLGEpfX0pfSk7XG4vKiA9PSBtYWxpaHUganF1ZXJ5IGN1c3RvbSBzY3JvbGxiYXIgcGx1Z2luID09IFZlcnNpb246IDMuMC43LCBMaWNlbnNlOiBNSVQgTGljZW5zZSAoTUlUKSAqL1xuIWZ1bmN0aW9uKGUsdCxhKXshZnVuY3Rpb24odCl7dmFyIG89XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kLG49XCJodHRwczpcIj09YS5sb2NhdGlvbi5wcm90b2NvbD9cImh0dHBzOlwiOlwiaHR0cDpcIixpPVwiY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2pxdWVyeS1tb3VzZXdoZWVsLzMuMS4xMi9qcXVlcnkubW91c2V3aGVlbC5taW4uanNcIjtvfHxlLmV2ZW50LnNwZWNpYWwubW91c2V3aGVlbHx8ZShcImhlYWRcIikuYXBwZW5kKGRlY29kZVVSSShcIiUzQ3NjcmlwdCBzcmM9XCIrbitcIi8vXCIraStcIiUzRSUzQy9zY3JpcHQlM0VcIikpLHQoKX0oZnVuY3Rpb24oKXt2YXIgbyxuPVwibUN1c3RvbVNjcm9sbGJhclwiLGk9XCJtQ1NcIixyPVwiLm1DdXN0b21TY3JvbGxiYXJcIixsPXtzZXRUb3A6MCxzZXRMZWZ0OjAsYXhpczpcInlcIixzY3JvbGxiYXJQb3NpdGlvbjpcImluc2lkZVwiLHNjcm9sbEluZXJ0aWE6OTUwLGF1dG9EcmFnZ2VyTGVuZ3RoOiEwLGFsd2F5c1Nob3dTY3JvbGxiYXI6MCxzbmFwT2Zmc2V0OjAsbW91c2VXaGVlbDp7ZW5hYmxlOiEwLHNjcm9sbEFtb3VudDpcImF1dG9cIixheGlzOlwieVwiLGRlbHRhRmFjdG9yOlwiYXV0b1wiLGRpc2FibGVPdmVyOltcInNlbGVjdFwiLFwib3B0aW9uXCIsXCJrZXlnZW5cIixcImRhdGFsaXN0XCIsXCJ0ZXh0YXJlYVwiXX0sc2Nyb2xsQnV0dG9uczp7c2Nyb2xsVHlwZTpcInN0ZXBsZXNzXCIsc2Nyb2xsQW1vdW50OlwiYXV0b1wifSxrZXlib2FyZDp7ZW5hYmxlOiEwLHNjcm9sbFR5cGU6XCJzdGVwbGVzc1wiLHNjcm9sbEFtb3VudDpcImF1dG9cIn0sY29udGVudFRvdWNoU2Nyb2xsOjI1LGFkdmFuY2VkOnthdXRvU2Nyb2xsT25Gb2N1czpcImlucHV0LHRleHRhcmVhLHNlbGVjdCxidXR0b24sZGF0YWxpc3Qsa2V5Z2VuLGFbdGFiaW5kZXhdLGFyZWEsb2JqZWN0LFtjb250ZW50ZWRpdGFibGU9J3RydWUnXVwiLHVwZGF0ZU9uQ29udGVudFJlc2l6ZTohMCx1cGRhdGVPbkltYWdlTG9hZDohMH0sdGhlbWU6XCJsaWdodFwiLGNhbGxiYWNrczp7b25Ub3RhbFNjcm9sbE9mZnNldDowLG9uVG90YWxTY3JvbGxCYWNrT2Zmc2V0OjAsYWx3YXlzVHJpZ2dlck9mZnNldHM6ITB9fSxzPTAsYz17fSxkPXQuYXR0YWNoRXZlbnQmJiF0LmFkZEV2ZW50TGlzdGVuZXI/MTowLHU9ITEsZj1bXCJtQ1NCX2RyYWdnZXJfb25EcmFnXCIsXCJtQ1NCX3Njcm9sbFRvb2xzX29uRHJhZ1wiLFwibUNTX2ltZ19sb2FkZWRcIixcIm1DU19kaXNhYmxlZFwiLFwibUNTX2Rlc3Ryb3llZFwiLFwibUNTX25vX3Njcm9sbGJhclwiLFwibUNTLWF1dG9IaWRlXCIsXCJtQ1MtZGlyLXJ0bFwiLFwibUNTX25vX3Njcm9sbGJhcl95XCIsXCJtQ1Nfbm9fc2Nyb2xsYmFyX3hcIixcIm1DU195X2hpZGRlblwiLFwibUNTX3hfaGlkZGVuXCIsXCJtQ1NCX2RyYWdnZXJDb250YWluZXJcIixcIm1DU0JfYnV0dG9uVXBcIixcIm1DU0JfYnV0dG9uRG93blwiLFwibUNTQl9idXR0b25MZWZ0XCIsXCJtQ1NCX2J1dHRvblJpZ2h0XCJdLGg9e2luaXQ6ZnVuY3Rpb24odCl7dmFyIHQ9ZS5leHRlbmQoITAse30sbCx0KSxhPW0uY2FsbCh0aGlzKTtpZih0LmxpdmUpe3ZhciBvPXQubGl2ZVNlbGVjdG9yfHx0aGlzLnNlbGVjdG9yfHxyLG49ZShvKTtpZihcIm9mZlwiPT09dC5saXZlKXJldHVybiB2b2lkIGcobyk7Y1tvXT1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7bi5tQ3VzdG9tU2Nyb2xsYmFyKHQpLFwib25jZVwiPT09dC5saXZlJiZuLmxlbmd0aCYmZyhvKX0sNTAwKX1lbHNlIGcobyk7cmV0dXJuIHQuc2V0V2lkdGg9dC5zZXRfd2lkdGg/dC5zZXRfd2lkdGg6dC5zZXRXaWR0aCx0LnNldEhlaWdodD10LnNldF9oZWlnaHQ/dC5zZXRfaGVpZ2h0OnQuc2V0SGVpZ2h0LHQuYXhpcz10Lmhvcml6b250YWxTY3JvbGw/XCJ4XCI6dih0LmF4aXMpLHQuc2Nyb2xsSW5lcnRpYT10LnNjcm9sbEluZXJ0aWE+MCYmdC5zY3JvbGxJbmVydGlhPDE3PzE3OnQuc2Nyb2xsSW5lcnRpYSxcIm9iamVjdFwiIT10eXBlb2YgdC5tb3VzZVdoZWVsJiYxPT10Lm1vdXNlV2hlZWwmJih0Lm1vdXNlV2hlZWw9e2VuYWJsZTohMCxzY3JvbGxBbW91bnQ6XCJhdXRvXCIsYXhpczpcInlcIixwcmV2ZW50RGVmYXVsdDohMSxkZWx0YUZhY3RvcjpcImF1dG9cIixub3JtYWxpemVEZWx0YTohMSxpbnZlcnQ6ITF9KSx0Lm1vdXNlV2hlZWwuc2Nyb2xsQW1vdW50PXQubW91c2VXaGVlbFBpeGVscz90Lm1vdXNlV2hlZWxQaXhlbHM6dC5tb3VzZVdoZWVsLnNjcm9sbEFtb3VudCx0Lm1vdXNlV2hlZWwubm9ybWFsaXplRGVsdGE9dC5hZHZhbmNlZC5ub3JtYWxpemVNb3VzZVdoZWVsRGVsdGE/dC5hZHZhbmNlZC5ub3JtYWxpemVNb3VzZVdoZWVsRGVsdGE6dC5tb3VzZVdoZWVsLm5vcm1hbGl6ZURlbHRhLHQuc2Nyb2xsQnV0dG9ucy5zY3JvbGxUeXBlPXgodC5zY3JvbGxCdXR0b25zLnNjcm9sbFR5cGUpLHAodCksZShhKS5lYWNoKGZ1bmN0aW9uKCl7dmFyIGE9ZSh0aGlzKTtpZighYS5kYXRhKGkpKXthLmRhdGEoaSx7aWR4OisrcyxvcHQ6dCxzY3JvbGxSYXRpbzp7eTpudWxsLHg6bnVsbH0sb3ZlcmZsb3dlZDpudWxsLGNvbnRlbnRSZXNldDp7eTpudWxsLHg6bnVsbH0sYmluZEV2ZW50czohMSx0d2VlblJ1bm5pbmc6ITEsc2VxdWVudGlhbDp7fSxsYW5nRGlyOmEuY3NzKFwiZGlyZWN0aW9uXCIpLGNiT2Zmc2V0czpudWxsLHRyaWdnZXI6bnVsbH0pO3ZhciBvPWEuZGF0YShpKSxuPW8ub3B0LHI9YS5kYXRhKFwibWNzLWF4aXNcIiksbD1hLmRhdGEoXCJtY3Mtc2Nyb2xsYmFyLXBvc2l0aW9uXCIpLGM9YS5kYXRhKFwibWNzLXRoZW1lXCIpO3ImJihuLmF4aXM9ciksbCYmKG4uc2Nyb2xsYmFyUG9zaXRpb249bCksYyYmKG4udGhlbWU9YyxwKG4pKSxfLmNhbGwodGhpcyksZShcIiNtQ1NCX1wiK28uaWR4K1wiX2NvbnRhaW5lciBpbWc6bm90KC5cIitmWzJdK1wiKVwiKS5hZGRDbGFzcyhmWzJdKSxoLnVwZGF0ZS5jYWxsKG51bGwsYSl9fSl9LHVwZGF0ZTpmdW5jdGlvbih0LGEpe3ZhciBvPXR8fG0uY2FsbCh0aGlzKTtyZXR1cm4gZShvKS5lYWNoKGZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKTtpZih0LmRhdGEoaSkpe3ZhciBvPXQuZGF0YShpKSxuPW8ub3B0LHI9ZShcIiNtQ1NCX1wiK28uaWR4K1wiX2NvbnRhaW5lclwiKSxsPVtlKFwiI21DU0JfXCIrby5pZHgrXCJfZHJhZ2dlcl92ZXJ0aWNhbFwiKSxlKFwiI21DU0JfXCIrby5pZHgrXCJfZHJhZ2dlcl9ob3Jpem9udGFsXCIpXTtpZighci5sZW5ndGgpcmV0dXJuO28udHdlZW5SdW5uaW5nJiZRKHQpLHQuaGFzQ2xhc3MoZlszXSkmJnQucmVtb3ZlQ2xhc3MoZlszXSksdC5oYXNDbGFzcyhmWzRdKSYmdC5yZW1vdmVDbGFzcyhmWzRdKSxDLmNhbGwodGhpcyksdy5jYWxsKHRoaXMpLFwieVwiPT09bi5heGlzfHxuLmFkdmFuY2VkLmF1dG9FeHBhbmRIb3Jpem9udGFsU2Nyb2xsfHxyLmNzcyhcIndpZHRoXCIsUyhyLmNoaWxkcmVuKCkpKSxvLm92ZXJmbG93ZWQ9ay5jYWxsKHRoaXMpLFIuY2FsbCh0aGlzKSxuLmF1dG9EcmFnZ2VyTGVuZ3RoJiZ5LmNhbGwodGhpcyksQi5jYWxsKHRoaXMpLE8uY2FsbCh0aGlzKTt2YXIgcz1bTWF0aC5hYnMoclswXS5vZmZzZXRUb3ApLE1hdGguYWJzKHJbMF0ub2Zmc2V0TGVmdCldO1wieFwiIT09bi5heGlzJiYoby5vdmVyZmxvd2VkWzBdP2xbMF0uaGVpZ2h0KCk+bFswXS5wYXJlbnQoKS5oZWlnaHQoKT9NLmNhbGwodGhpcyk6KEcodCxzWzBdLnRvU3RyaW5nKCkse2RpcjpcInlcIixkdXI6MCxvdmVyd3JpdGU6XCJub25lXCJ9KSxvLmNvbnRlbnRSZXNldC55PW51bGwpOihNLmNhbGwodGhpcyksXCJ5XCI9PT1uLmF4aXM/SS5jYWxsKHRoaXMpOlwieXhcIj09PW4uYXhpcyYmby5vdmVyZmxvd2VkWzFdJiZHKHQsc1sxXS50b1N0cmluZygpLHtkaXI6XCJ4XCIsZHVyOjAsb3ZlcndyaXRlOlwibm9uZVwifSkpKSxcInlcIiE9PW4uYXhpcyYmKG8ub3ZlcmZsb3dlZFsxXT9sWzFdLndpZHRoKCk+bFsxXS5wYXJlbnQoKS53aWR0aCgpP00uY2FsbCh0aGlzKTooRyh0LHNbMV0udG9TdHJpbmcoKSx7ZGlyOlwieFwiLGR1cjowLG92ZXJ3cml0ZTpcIm5vbmVcIn0pLG8uY29udGVudFJlc2V0Lng9bnVsbCk6KE0uY2FsbCh0aGlzKSxcInhcIj09PW4uYXhpcz9JLmNhbGwodGhpcyk6XCJ5eFwiPT09bi5heGlzJiZvLm92ZXJmbG93ZWRbMF0mJkcodCxzWzBdLnRvU3RyaW5nKCkse2RpcjpcInlcIixkdXI6MCxvdmVyd3JpdGU6XCJub25lXCJ9KSkpLGEmJm8mJigyPT09YSYmbi5jYWxsYmFja3Mub25JbWFnZUxvYWQmJlwiZnVuY3Rpb25cIj09dHlwZW9mIG4uY2FsbGJhY2tzLm9uSW1hZ2VMb2FkP24uY2FsbGJhY2tzLm9uSW1hZ2VMb2FkLmNhbGwodGhpcyk6Mz09PWEmJm4uY2FsbGJhY2tzLm9uU2VsZWN0b3JDaGFuZ2UmJlwiZnVuY3Rpb25cIj09dHlwZW9mIG4uY2FsbGJhY2tzLm9uU2VsZWN0b3JDaGFuZ2U/bi5jYWxsYmFja3Mub25TZWxlY3RvckNoYW5nZS5jYWxsKHRoaXMpOm4uY2FsbGJhY2tzLm9uVXBkYXRlJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBuLmNhbGxiYWNrcy5vblVwZGF0ZSYmbi5jYWxsYmFja3Mub25VcGRhdGUuY2FsbCh0aGlzKSksTi5jYWxsKHRoaXMpfX0pfSxzY3JvbGxUbzpmdW5jdGlvbih0LGEpe2lmKFwidW5kZWZpbmVkXCIhPXR5cGVvZiB0JiZudWxsIT10KXt2YXIgbz1tLmNhbGwodGhpcyk7cmV0dXJuIGUobykuZWFjaChmdW5jdGlvbigpe3ZhciBvPWUodGhpcyk7aWYoby5kYXRhKGkpKXt2YXIgbj1vLmRhdGEoaSkscj1uLm9wdCxsPXt0cmlnZ2VyOlwiZXh0ZXJuYWxcIixzY3JvbGxJbmVydGlhOnIuc2Nyb2xsSW5lcnRpYSxzY3JvbGxFYXNpbmc6XCJtY3NFYXNlSW5PdXRcIixtb3ZlRHJhZ2dlcjohMSx0aW1lb3V0OjYwLGNhbGxiYWNrczohMCxvblN0YXJ0OiEwLG9uVXBkYXRlOiEwLG9uQ29tcGxldGU6ITB9LHM9ZS5leHRlbmQoITAse30sbCxhKSxjPVkuY2FsbCh0aGlzLHQpLGQ9cy5zY3JvbGxJbmVydGlhPjAmJnMuc2Nyb2xsSW5lcnRpYTwxNz8xNzpzLnNjcm9sbEluZXJ0aWE7Y1swXT1YLmNhbGwodGhpcyxjWzBdLFwieVwiKSxjWzFdPVguY2FsbCh0aGlzLGNbMV0sXCJ4XCIpLHMubW92ZURyYWdnZXImJihjWzBdKj1uLnNjcm9sbFJhdGlvLnksY1sxXSo9bi5zY3JvbGxSYXRpby54KSxzLmR1cj1kLHNldFRpbWVvdXQoZnVuY3Rpb24oKXtudWxsIT09Y1swXSYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGNbMF0mJlwieFwiIT09ci5heGlzJiZuLm92ZXJmbG93ZWRbMF0mJihzLmRpcj1cInlcIixzLm92ZXJ3cml0ZT1cImFsbFwiLEcobyxjWzBdLnRvU3RyaW5nKCkscykpLG51bGwhPT1jWzFdJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgY1sxXSYmXCJ5XCIhPT1yLmF4aXMmJm4ub3ZlcmZsb3dlZFsxXSYmKHMuZGlyPVwieFwiLHMub3ZlcndyaXRlPVwibm9uZVwiLEcobyxjWzFdLnRvU3RyaW5nKCkscykpfSxzLnRpbWVvdXQpfX0pfX0sc3RvcDpmdW5jdGlvbigpe3ZhciB0PW0uY2FsbCh0aGlzKTtyZXR1cm4gZSh0KS5lYWNoKGZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKTt0LmRhdGEoaSkmJlEodCl9KX0sZGlzYWJsZTpmdW5jdGlvbih0KXt2YXIgYT1tLmNhbGwodGhpcyk7cmV0dXJuIGUoYSkuZWFjaChmdW5jdGlvbigpe3ZhciBhPWUodGhpcyk7aWYoYS5kYXRhKGkpKXt7YS5kYXRhKGkpfU4uY2FsbCh0aGlzLFwicmVtb3ZlXCIpLEkuY2FsbCh0aGlzKSx0JiZNLmNhbGwodGhpcyksUi5jYWxsKHRoaXMsITApLGEuYWRkQ2xhc3MoZlszXSl9fSl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgdD1tLmNhbGwodGhpcyk7cmV0dXJuIGUodCkuZWFjaChmdW5jdGlvbigpe3ZhciBhPWUodGhpcyk7aWYoYS5kYXRhKGkpKXt2YXIgbz1hLmRhdGEoaSkscj1vLm9wdCxsPWUoXCIjbUNTQl9cIitvLmlkeCkscz1lKFwiI21DU0JfXCIrby5pZHgrXCJfY29udGFpbmVyXCIpLGM9ZShcIi5tQ1NCX1wiK28uaWR4K1wiX3Njcm9sbGJhclwiKTtyLmxpdmUmJmcoci5saXZlU2VsZWN0b3J8fGUodCkuc2VsZWN0b3IpLE4uY2FsbCh0aGlzLFwicmVtb3ZlXCIpLEkuY2FsbCh0aGlzKSxNLmNhbGwodGhpcyksYS5yZW1vdmVEYXRhKGkpLCQodGhpcyxcIm1jc1wiKSxjLnJlbW92ZSgpLHMuZmluZChcImltZy5cIitmWzJdKS5yZW1vdmVDbGFzcyhmWzJdKSxsLnJlcGxhY2VXaXRoKHMuY29udGVudHMoKSksYS5yZW1vdmVDbGFzcyhuK1wiIF9cIitpK1wiX1wiK28uaWR4K1wiIFwiK2ZbNl0rXCIgXCIrZls3XStcIiBcIitmWzVdK1wiIFwiK2ZbM10pLmFkZENsYXNzKGZbNF0pfX0pfX0sbT1mdW5jdGlvbigpe3JldHVyblwib2JqZWN0XCIhPXR5cGVvZiBlKHRoaXMpfHxlKHRoaXMpLmxlbmd0aDwxP3I6dGhpc30scD1mdW5jdGlvbih0KXt2YXIgYT1bXCJyb3VuZGVkXCIsXCJyb3VuZGVkLWRhcmtcIixcInJvdW5kZWQtZG90c1wiLFwicm91bmRlZC1kb3RzLWRhcmtcIl0sbz1bXCJyb3VuZGVkLWRvdHNcIixcInJvdW5kZWQtZG90cy1kYXJrXCIsXCIzZFwiLFwiM2QtZGFya1wiLFwiM2QtdGhpY2tcIixcIjNkLXRoaWNrLWRhcmtcIixcImluc2V0XCIsXCJpbnNldC1kYXJrXCIsXCJpbnNldC0yXCIsXCJpbnNldC0yLWRhcmtcIixcImluc2V0LTNcIixcImluc2V0LTMtZGFya1wiXSxuPVtcIm1pbmltYWxcIixcIm1pbmltYWwtZGFya1wiXSxpPVtcIm1pbmltYWxcIixcIm1pbmltYWwtZGFya1wiXSxyPVtcIm1pbmltYWxcIixcIm1pbmltYWwtZGFya1wiXTt0LmF1dG9EcmFnZ2VyTGVuZ3RoPWUuaW5BcnJheSh0LnRoZW1lLGEpPi0xPyExOnQuYXV0b0RyYWdnZXJMZW5ndGgsdC5hdXRvRXhwYW5kU2Nyb2xsYmFyPWUuaW5BcnJheSh0LnRoZW1lLG8pPi0xPyExOnQuYXV0b0V4cGFuZFNjcm9sbGJhcix0LnNjcm9sbEJ1dHRvbnMuZW5hYmxlPWUuaW5BcnJheSh0LnRoZW1lLG4pPi0xPyExOnQuc2Nyb2xsQnV0dG9ucy5lbmFibGUsdC5hdXRvSGlkZVNjcm9sbGJhcj1lLmluQXJyYXkodC50aGVtZSxpKT4tMT8hMDp0LmF1dG9IaWRlU2Nyb2xsYmFyLHQuc2Nyb2xsYmFyUG9zaXRpb249ZS5pbkFycmF5KHQudGhlbWUscik+LTE/XCJvdXRzaWRlXCI6dC5zY3JvbGxiYXJQb3NpdGlvbn0sZz1mdW5jdGlvbihlKXtjW2VdJiYoY2xlYXJUaW1lb3V0KGNbZV0pLCQoYyxlKSl9LHY9ZnVuY3Rpb24oZSl7cmV0dXJuXCJ5eFwiPT09ZXx8XCJ4eVwiPT09ZXx8XCJhdXRvXCI9PT1lP1wieXhcIjpcInhcIj09PWV8fFwiaG9yaXpvbnRhbFwiPT09ZT9cInhcIjpcInlcIn0seD1mdW5jdGlvbihlKXtyZXR1cm5cInN0ZXBwZWRcIj09PWV8fFwicGl4ZWxzXCI9PT1lfHxcInN0ZXBcIj09PWV8fFwiY2xpY2tcIj09PWU/XCJzdGVwcGVkXCI6XCJzdGVwbGVzc1wifSxfPWZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKSxhPXQuZGF0YShpKSxvPWEub3B0LHI9by5hdXRvRXhwYW5kU2Nyb2xsYmFyP1wiIFwiK2ZbMV0rXCJfZXhwYW5kXCI6XCJcIixsPVtcIjxkaXYgaWQ9J21DU0JfXCIrYS5pZHgrXCJfc2Nyb2xsYmFyX3ZlcnRpY2FsJyBjbGFzcz0nbUNTQl9zY3JvbGxUb29scyBtQ1NCX1wiK2EuaWR4K1wiX3Njcm9sbGJhciBtQ1MtXCIrby50aGVtZStcIiBtQ1NCX3Njcm9sbFRvb2xzX3ZlcnRpY2FsXCIrcitcIic+PGRpdiBjbGFzcz0nXCIrZlsxMl0rXCInPjxkaXYgaWQ9J21DU0JfXCIrYS5pZHgrXCJfZHJhZ2dlcl92ZXJ0aWNhbCcgY2xhc3M9J21DU0JfZHJhZ2dlcicgc3R5bGU9J3Bvc2l0aW9uOmFic29sdXRlOycgb25jb250ZXh0bWVudT0ncmV0dXJuIGZhbHNlOyc+PGRpdiBjbGFzcz0nbUNTQl9kcmFnZ2VyX2JhcicgLz48L2Rpdj48ZGl2IGNsYXNzPSdtQ1NCX2RyYWdnZXJSYWlsJyAvPjwvZGl2PjwvZGl2PlwiLFwiPGRpdiBpZD0nbUNTQl9cIithLmlkeCtcIl9zY3JvbGxiYXJfaG9yaXpvbnRhbCcgY2xhc3M9J21DU0Jfc2Nyb2xsVG9vbHMgbUNTQl9cIithLmlkeCtcIl9zY3JvbGxiYXIgbUNTLVwiK28udGhlbWUrXCIgbUNTQl9zY3JvbGxUb29sc19ob3Jpem9udGFsXCIrcitcIic+PGRpdiBjbGFzcz0nXCIrZlsxMl0rXCInPjxkaXYgaWQ9J21DU0JfXCIrYS5pZHgrXCJfZHJhZ2dlcl9ob3Jpem9udGFsJyBjbGFzcz0nbUNTQl9kcmFnZ2VyJyBzdHlsZT0ncG9zaXRpb246YWJzb2x1dGU7JyBvbmNvbnRleHRtZW51PSdyZXR1cm4gZmFsc2U7Jz48ZGl2IGNsYXNzPSdtQ1NCX2RyYWdnZXJfYmFyJyAvPjwvZGl2PjxkaXYgY2xhc3M9J21DU0JfZHJhZ2dlclJhaWwnIC8+PC9kaXY+PC9kaXY+XCJdLHM9XCJ5eFwiPT09by5heGlzP1wibUNTQl92ZXJ0aWNhbF9ob3Jpem9udGFsXCI6XCJ4XCI9PT1vLmF4aXM/XCJtQ1NCX2hvcml6b250YWxcIjpcIm1DU0JfdmVydGljYWxcIixjPVwieXhcIj09PW8uYXhpcz9sWzBdK2xbMV06XCJ4XCI9PT1vLmF4aXM/bFsxXTpsWzBdLGQ9XCJ5eFwiPT09by5heGlzP1wiPGRpdiBpZD0nbUNTQl9cIithLmlkeCtcIl9jb250YWluZXJfd3JhcHBlcicgY2xhc3M9J21DU0JfY29udGFpbmVyX3dyYXBwZXInIC8+XCI6XCJcIix1PW8uYXV0b0hpZGVTY3JvbGxiYXI/XCIgXCIrZls2XTpcIlwiLGg9XCJ4XCIhPT1vLmF4aXMmJlwicnRsXCI9PT1hLmxhbmdEaXI/XCIgXCIrZls3XTpcIlwiO28uc2V0V2lkdGgmJnQuY3NzKFwid2lkdGhcIixvLnNldFdpZHRoKSxvLnNldEhlaWdodCYmdC5jc3MoXCJoZWlnaHRcIixvLnNldEhlaWdodCksby5zZXRMZWZ0PVwieVwiIT09by5heGlzJiZcInJ0bFwiPT09YS5sYW5nRGlyP1wiOTg5OTk5cHhcIjpvLnNldExlZnQsdC5hZGRDbGFzcyhuK1wiIF9cIitpK1wiX1wiK2EuaWR4K3UraCkud3JhcElubmVyKFwiPGRpdiBpZD0nbUNTQl9cIithLmlkeCtcIicgY2xhc3M9J21DdXN0b21TY3JvbGxCb3ggbUNTLVwiK28udGhlbWUrXCIgXCIrcytcIic+PGRpdiBpZD0nbUNTQl9cIithLmlkeCtcIl9jb250YWluZXInIGNsYXNzPSdtQ1NCX2NvbnRhaW5lcicgc3R5bGU9J3Bvc2l0aW9uOnJlbGF0aXZlOyB0b3A6XCIrby5zZXRUb3ArXCI7IGxlZnQ6XCIrby5zZXRMZWZ0K1wiOycgZGlyPVwiK2EubGFuZ0RpcitcIiAvPjwvZGl2PlwiKTt2YXIgbT1lKFwiI21DU0JfXCIrYS5pZHgpLHA9ZShcIiNtQ1NCX1wiK2EuaWR4K1wiX2NvbnRhaW5lclwiKTtcInlcIj09PW8uYXhpc3x8by5hZHZhbmNlZC5hdXRvRXhwYW5kSG9yaXpvbnRhbFNjcm9sbHx8cC5jc3MoXCJ3aWR0aFwiLFMocC5jaGlsZHJlbigpKSksXCJvdXRzaWRlXCI9PT1vLnNjcm9sbGJhclBvc2l0aW9uPyhcInN0YXRpY1wiPT09dC5jc3MoXCJwb3NpdGlvblwiKSYmdC5jc3MoXCJwb3NpdGlvblwiLFwicmVsYXRpdmVcIiksdC5jc3MoXCJvdmVyZmxvd1wiLFwidmlzaWJsZVwiKSxtLmFkZENsYXNzKFwibUNTQl9vdXRzaWRlXCIpLmFmdGVyKGMpKToobS5hZGRDbGFzcyhcIm1DU0JfaW5zaWRlXCIpLmFwcGVuZChjKSxwLndyYXAoZCkpLGIuY2FsbCh0aGlzKTt2YXIgZz1bZShcIiNtQ1NCX1wiK2EuaWR4K1wiX2RyYWdnZXJfdmVydGljYWxcIiksZShcIiNtQ1NCX1wiK2EuaWR4K1wiX2RyYWdnZXJfaG9yaXpvbnRhbFwiKV07Z1swXS5jc3MoXCJtaW4taGVpZ2h0XCIsZ1swXS5oZWlnaHQoKSksZ1sxXS5jc3MoXCJtaW4td2lkdGhcIixnWzFdLndpZHRoKCkpfSxTPWZ1bmN0aW9uKHQpe3JldHVybiBNYXRoLm1heC5hcHBseShNYXRoLHQubWFwKGZ1bmN0aW9uKCl7cmV0dXJuIGUodGhpcykub3V0ZXJXaWR0aCghMCl9KS5nZXQoKSl9LHc9ZnVuY3Rpb24oKXt2YXIgdD1lKHRoaXMpLGE9dC5kYXRhKGkpLG89YS5vcHQsbj1lKFwiI21DU0JfXCIrYS5pZHgrXCJfY29udGFpbmVyXCIpO28uYWR2YW5jZWQuYXV0b0V4cGFuZEhvcml6b250YWxTY3JvbGwmJlwieVwiIT09by5heGlzJiZuLmNzcyh7cG9zaXRpb246XCJhYnNvbHV0ZVwiLHdpZHRoOlwiYXV0b1wifSkud3JhcChcIjxkaXYgY2xhc3M9J21DU0JfaF93cmFwcGVyJyBzdHlsZT0ncG9zaXRpb246cmVsYXRpdmU7IGxlZnQ6MDsgd2lkdGg6OTk5OTk5cHg7JyAvPlwiKS5jc3Moe3dpZHRoOk1hdGguY2VpbChuWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnJpZ2h0Ky40KS1NYXRoLmZsb29yKG5bMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCkscG9zaXRpb246XCJyZWxhdGl2ZVwifSkudW53cmFwKCl9LGI9ZnVuY3Rpb24oKXt2YXIgdD1lKHRoaXMpLGE9dC5kYXRhKGkpLG89YS5vcHQsbj1lKFwiLm1DU0JfXCIrYS5pZHgrXCJfc2Nyb2xsYmFyOmZpcnN0XCIpLHI9YXQoby5zY3JvbGxCdXR0b25zLnRhYmluZGV4KT9cInRhYmluZGV4PSdcIitvLnNjcm9sbEJ1dHRvbnMudGFiaW5kZXgrXCInXCI6XCJcIixsPVtcIjxhIGhyZWY9JyMnIGNsYXNzPSdcIitmWzEzXStcIicgb25jb250ZXh0bWVudT0ncmV0dXJuIGZhbHNlOycgXCIrcitcIiAvPlwiLFwiPGEgaHJlZj0nIycgY2xhc3M9J1wiK2ZbMTRdK1wiJyBvbmNvbnRleHRtZW51PSdyZXR1cm4gZmFsc2U7JyBcIityK1wiIC8+XCIsXCI8YSBocmVmPScjJyBjbGFzcz0nXCIrZlsxNV0rXCInIG9uY29udGV4dG1lbnU9J3JldHVybiBmYWxzZTsnIFwiK3IrXCIgLz5cIixcIjxhIGhyZWY9JyMnIGNsYXNzPSdcIitmWzE2XStcIicgb25jb250ZXh0bWVudT0ncmV0dXJuIGZhbHNlOycgXCIrcitcIiAvPlwiXSxzPVtcInhcIj09PW8uYXhpcz9sWzJdOmxbMF0sXCJ4XCI9PT1vLmF4aXM/bFszXTpsWzFdLGxbMl0sbFszXV07by5zY3JvbGxCdXR0b25zLmVuYWJsZSYmbi5wcmVwZW5kKHNbMF0pLmFwcGVuZChzWzFdKS5uZXh0KFwiLm1DU0Jfc2Nyb2xsVG9vbHNcIikucHJlcGVuZChzWzJdKS5hcHBlbmQoc1szXSl9LEM9ZnVuY3Rpb24oKXt2YXIgdD1lKHRoaXMpLGE9dC5kYXRhKGkpLG89ZShcIiNtQ1NCX1wiK2EuaWR4KSxuPXQuY3NzKFwibWF4LWhlaWdodFwiKXx8XCJub25lXCIscj0tMSE9PW4uaW5kZXhPZihcIiVcIiksbD10LmNzcyhcImJveC1zaXppbmdcIik7aWYoXCJub25lXCIhPT1uKXt2YXIgcz1yP3QucGFyZW50KCkuaGVpZ2h0KCkqcGFyc2VJbnQobikvMTAwOnBhcnNlSW50KG4pO1wiYm9yZGVyLWJveFwiPT09bCYmKHMtPXQuaW5uZXJIZWlnaHQoKS10LmhlaWdodCgpKyh0Lm91dGVySGVpZ2h0KCktdC5pbm5lckhlaWdodCgpKSksby5jc3MoXCJtYXgtaGVpZ2h0XCIsTWF0aC5yb3VuZChzKSl9fSx5PWZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKSxhPXQuZGF0YShpKSxvPWUoXCIjbUNTQl9cIithLmlkeCksbj1lKFwiI21DU0JfXCIrYS5pZHgrXCJfY29udGFpbmVyXCIpLHI9W2UoXCIjbUNTQl9cIithLmlkeCtcIl9kcmFnZ2VyX3ZlcnRpY2FsXCIpLGUoXCIjbUNTQl9cIithLmlkeCtcIl9kcmFnZ2VyX2hvcml6b250YWxcIildLGw9W28uaGVpZ2h0KCkvbi5vdXRlckhlaWdodCghMSksby53aWR0aCgpL24ub3V0ZXJXaWR0aCghMSldLHM9W3BhcnNlSW50KHJbMF0uY3NzKFwibWluLWhlaWdodFwiKSksTWF0aC5yb3VuZChsWzBdKnJbMF0ucGFyZW50KCkuaGVpZ2h0KCkpLHBhcnNlSW50KHJbMV0uY3NzKFwibWluLXdpZHRoXCIpKSxNYXRoLnJvdW5kKGxbMV0qclsxXS5wYXJlbnQoKS53aWR0aCgpKV0sYz1kJiZzWzFdPHNbMF0/c1swXTpzWzFdLHU9ZCYmc1szXTxzWzJdP3NbMl06c1szXTtyWzBdLmNzcyh7aGVpZ2h0OmMsXCJtYXgtaGVpZ2h0XCI6clswXS5wYXJlbnQoKS5oZWlnaHQoKS0xMH0pLmZpbmQoXCIubUNTQl9kcmFnZ2VyX2JhclwiKS5jc3Moe1wibGluZS1oZWlnaHRcIjpzWzBdK1wicHhcIn0pLHJbMV0uY3NzKHt3aWR0aDp1LFwibWF4LXdpZHRoXCI6clsxXS5wYXJlbnQoKS53aWR0aCgpLTEwfSl9LEI9ZnVuY3Rpb24oKXt2YXIgdD1lKHRoaXMpLGE9dC5kYXRhKGkpLG89ZShcIiNtQ1NCX1wiK2EuaWR4KSxuPWUoXCIjbUNTQl9cIithLmlkeCtcIl9jb250YWluZXJcIikscj1bZShcIiNtQ1NCX1wiK2EuaWR4K1wiX2RyYWdnZXJfdmVydGljYWxcIiksZShcIiNtQ1NCX1wiK2EuaWR4K1wiX2RyYWdnZXJfaG9yaXpvbnRhbFwiKV0sbD1bbi5vdXRlckhlaWdodCghMSktby5oZWlnaHQoKSxuLm91dGVyV2lkdGgoITEpLW8ud2lkdGgoKV0scz1bbFswXS8oclswXS5wYXJlbnQoKS5oZWlnaHQoKS1yWzBdLmhlaWdodCgpKSxsWzFdLyhyWzFdLnBhcmVudCgpLndpZHRoKCktclsxXS53aWR0aCgpKV07YS5zY3JvbGxSYXRpbz17eTpzWzBdLHg6c1sxXX19LFQ9ZnVuY3Rpb24oZSx0LGEpe3ZhciBvPWE/ZlswXStcIl9leHBhbmRlZFwiOlwiXCIsbj1lLmNsb3Nlc3QoXCIubUNTQl9zY3JvbGxUb29sc1wiKTtcImFjdGl2ZVwiPT09dD8oZS50b2dnbGVDbGFzcyhmWzBdK1wiIFwiK28pLG4udG9nZ2xlQ2xhc3MoZlsxXSksZVswXS5fZHJhZ2dhYmxlPWVbMF0uX2RyYWdnYWJsZT8wOjEpOmVbMF0uX2RyYWdnYWJsZXx8KFwiaGlkZVwiPT09dD8oZS5yZW1vdmVDbGFzcyhmWzBdKSxuLnJlbW92ZUNsYXNzKGZbMV0pKTooZS5hZGRDbGFzcyhmWzBdKSxuLmFkZENsYXNzKGZbMV0pKSl9LGs9ZnVuY3Rpb24oKXt2YXIgdD1lKHRoaXMpLGE9dC5kYXRhKGkpLG89ZShcIiNtQ1NCX1wiK2EuaWR4KSxuPWUoXCIjbUNTQl9cIithLmlkeCtcIl9jb250YWluZXJcIikscj1udWxsPT1hLm92ZXJmbG93ZWQ/bi5oZWlnaHQoKTpuLm91dGVySGVpZ2h0KCExKSxsPW51bGw9PWEub3ZlcmZsb3dlZD9uLndpZHRoKCk6bi5vdXRlcldpZHRoKCExKTtyZXR1cm5bcj5vLmhlaWdodCgpLGw+by53aWR0aCgpXX0sTT1mdW5jdGlvbigpe3ZhciB0PWUodGhpcyksYT10LmRhdGEoaSksbz1hLm9wdCxuPWUoXCIjbUNTQl9cIithLmlkeCkscj1lKFwiI21DU0JfXCIrYS5pZHgrXCJfY29udGFpbmVyXCIpLGw9W2UoXCIjbUNTQl9cIithLmlkeCtcIl9kcmFnZ2VyX3ZlcnRpY2FsXCIpLGUoXCIjbUNTQl9cIithLmlkeCtcIl9kcmFnZ2VyX2hvcml6b250YWxcIildO2lmKFEodCksKFwieFwiIT09by5heGlzJiYhYS5vdmVyZmxvd2VkWzBdfHxcInlcIj09PW8uYXhpcyYmYS5vdmVyZmxvd2VkWzBdKSYmKGxbMF0uYWRkKHIpLmNzcyhcInRvcFwiLDApLEcodCxcIl9yZXNldFlcIikpLFwieVwiIT09by5heGlzJiYhYS5vdmVyZmxvd2VkWzFdfHxcInhcIj09PW8uYXhpcyYmYS5vdmVyZmxvd2VkWzFdKXt2YXIgcz1keD0wO1wicnRsXCI9PT1hLmxhbmdEaXImJihzPW4ud2lkdGgoKS1yLm91dGVyV2lkdGgoITEpLGR4PU1hdGguYWJzKHMvYS5zY3JvbGxSYXRpby54KSksci5jc3MoXCJsZWZ0XCIscyksbFsxXS5jc3MoXCJsZWZ0XCIsZHgpLEcodCxcIl9yZXNldFhcIil9fSxPPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3I9c2V0VGltZW91dChmdW5jdGlvbigpe2UuZXZlbnQuc3BlY2lhbC5tb3VzZXdoZWVsPyhjbGVhclRpbWVvdXQociksQS5jYWxsKGFbMF0pKTp0KCl9LDEwMCl9dmFyIGE9ZSh0aGlzKSxvPWEuZGF0YShpKSxuPW8ub3B0O2lmKCFvLmJpbmRFdmVudHMpe2lmKEQuY2FsbCh0aGlzKSxuLmNvbnRlbnRUb3VjaFNjcm9sbCYmTC5jYWxsKHRoaXMpLFcuY2FsbCh0aGlzKSxuLm1vdXNlV2hlZWwuZW5hYmxlKXt2YXIgcjt0KCl9ei5jYWxsKHRoaXMpLFUuY2FsbCh0aGlzKSxuLmFkdmFuY2VkLmF1dG9TY3JvbGxPbkZvY3VzJiZILmNhbGwodGhpcyksbi5zY3JvbGxCdXR0b25zLmVuYWJsZSYmRi5jYWxsKHRoaXMpLG4ua2V5Ym9hcmQuZW5hYmxlJiZxLmNhbGwodGhpcyksby5iaW5kRXZlbnRzPSEwfX0sST1mdW5jdGlvbigpe3ZhciB0PWUodGhpcyksbz10LmRhdGEoaSksbj1vLm9wdCxyPWkrXCJfXCIrby5pZHgsbD1cIi5tQ1NCX1wiK28uaWR4K1wiX3Njcm9sbGJhclwiLHM9ZShcIiNtQ1NCX1wiK28uaWR4K1wiLCNtQ1NCX1wiK28uaWR4K1wiX2NvbnRhaW5lciwjbUNTQl9cIitvLmlkeCtcIl9jb250YWluZXJfd3JhcHBlcixcIitsK1wiIC5cIitmWzEyXStcIiwjbUNTQl9cIitvLmlkeCtcIl9kcmFnZ2VyX3ZlcnRpY2FsLCNtQ1NCX1wiK28uaWR4K1wiX2RyYWdnZXJfaG9yaXpvbnRhbCxcIitsK1wiPmFcIiksYz1lKFwiI21DU0JfXCIrby5pZHgrXCJfY29udGFpbmVyXCIpO24uYWR2YW5jZWQucmVsZWFzZURyYWdnYWJsZVNlbGVjdG9ycyYmcy5hZGQoZShuLmFkdmFuY2VkLnJlbGVhc2VEcmFnZ2FibGVTZWxlY3RvcnMpKSxvLmJpbmRFdmVudHMmJihlKGEpLnVuYmluZChcIi5cIityKSxzLmVhY2goZnVuY3Rpb24oKXtlKHRoaXMpLnVuYmluZChcIi5cIityKX0pLGNsZWFyVGltZW91dCh0WzBdLl9mb2N1c1RpbWVvdXQpLCQodFswXSxcIl9mb2N1c1RpbWVvdXRcIiksY2xlYXJUaW1lb3V0KG8uc2VxdWVudGlhbC5zdGVwKSwkKG8uc2VxdWVudGlhbCxcInN0ZXBcIiksY2xlYXJUaW1lb3V0KGNbMF0ub25Db21wbGV0ZVRpbWVvdXQpLCQoY1swXSxcIm9uQ29tcGxldGVUaW1lb3V0XCIpLG8uYmluZEV2ZW50cz0hMSl9LFI9ZnVuY3Rpb24odCl7dmFyIGE9ZSh0aGlzKSxvPWEuZGF0YShpKSxuPW8ub3B0LHI9ZShcIiNtQ1NCX1wiK28uaWR4K1wiX2NvbnRhaW5lcl93cmFwcGVyXCIpLGw9ci5sZW5ndGg/cjplKFwiI21DU0JfXCIrby5pZHgrXCJfY29udGFpbmVyXCIpLHM9W2UoXCIjbUNTQl9cIitvLmlkeCtcIl9zY3JvbGxiYXJfdmVydGljYWxcIiksZShcIiNtQ1NCX1wiK28uaWR4K1wiX3Njcm9sbGJhcl9ob3Jpem9udGFsXCIpXSxjPVtzWzBdLmZpbmQoXCIubUNTQl9kcmFnZ2VyXCIpLHNbMV0uZmluZChcIi5tQ1NCX2RyYWdnZXJcIildO1wieFwiIT09bi5heGlzJiYoby5vdmVyZmxvd2VkWzBdJiYhdD8oc1swXS5hZGQoY1swXSkuYWRkKHNbMF0uY2hpbGRyZW4oXCJhXCIpKS5jc3MoXCJkaXNwbGF5XCIsXCJibG9ja1wiKSxsLnJlbW92ZUNsYXNzKGZbOF0rXCIgXCIrZlsxMF0pKToobi5hbHdheXNTaG93U2Nyb2xsYmFyPygyIT09bi5hbHdheXNTaG93U2Nyb2xsYmFyJiZjWzBdLmNzcyhcImRpc3BsYXlcIixcIm5vbmVcIiksbC5yZW1vdmVDbGFzcyhmWzEwXSkpOihzWzBdLmNzcyhcImRpc3BsYXlcIixcIm5vbmVcIiksbC5hZGRDbGFzcyhmWzEwXSkpLGwuYWRkQ2xhc3MoZls4XSkpKSxcInlcIiE9PW4uYXhpcyYmKG8ub3ZlcmZsb3dlZFsxXSYmIXQ/KHNbMV0uYWRkKGNbMV0pLmFkZChzWzFdLmNoaWxkcmVuKFwiYVwiKSkuY3NzKFwiZGlzcGxheVwiLFwiYmxvY2tcIiksbC5yZW1vdmVDbGFzcyhmWzldK1wiIFwiK2ZbMTFdKSk6KG4uYWx3YXlzU2hvd1Njcm9sbGJhcj8oMiE9PW4uYWx3YXlzU2hvd1Njcm9sbGJhciYmY1sxXS5jc3MoXCJkaXNwbGF5XCIsXCJub25lXCIpLGwucmVtb3ZlQ2xhc3MoZlsxMV0pKTooc1sxXS5jc3MoXCJkaXNwbGF5XCIsXCJub25lXCIpLGwuYWRkQ2xhc3MoZlsxMV0pKSxsLmFkZENsYXNzKGZbOV0pKSksby5vdmVyZmxvd2VkWzBdfHxvLm92ZXJmbG93ZWRbMV0/YS5yZW1vdmVDbGFzcyhmWzVdKTphLmFkZENsYXNzKGZbNV0pfSxFPWZ1bmN0aW9uKGUpe3ZhciB0PWUudHlwZTtzd2l0Y2godCl7Y2FzZVwicG9pbnRlcmRvd25cIjpjYXNlXCJNU1BvaW50ZXJEb3duXCI6Y2FzZVwicG9pbnRlcm1vdmVcIjpjYXNlXCJNU1BvaW50ZXJNb3ZlXCI6Y2FzZVwicG9pbnRlcnVwXCI6Y2FzZVwiTVNQb2ludGVyVXBcIjpyZXR1cm5bZS5vcmlnaW5hbEV2ZW50LnBhZ2VZLGUub3JpZ2luYWxFdmVudC5wYWdlWCwhMV07Y2FzZVwidG91Y2hzdGFydFwiOmNhc2VcInRvdWNobW92ZVwiOmNhc2VcInRvdWNoZW5kXCI6dmFyIGE9ZS5vcmlnaW5hbEV2ZW50LnRvdWNoZXNbMF18fGUub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlc1swXSxvPWUub3JpZ2luYWxFdmVudC50b3VjaGVzLmxlbmd0aHx8ZS5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzLmxlbmd0aDtyZXR1cm5bYS5wYWdlWSxhLnBhZ2VYLG8+MV07ZGVmYXVsdDpyZXR1cm5bZS5wYWdlWSxlLnBhZ2VYLCExXX19LEQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUpe3ZhciB0PXAuZmluZChcImlmcmFtZVwiKTtpZih0Lmxlbmd0aCl7dmFyIGE9ZT9cImF1dG9cIjpcIm5vbmVcIjt0LmNzcyhcInBvaW50ZXItZXZlbnRzXCIsYSl9fWZ1bmN0aW9uIG8oZSx0LGEsbyl7aWYocFswXS5pZGxlVGltZXI9Zi5zY3JvbGxJbmVydGlhPDIzMz8yNTA6MCxuLmF0dHIoXCJpZFwiKT09PW1bMV0pdmFyIGk9XCJ4XCIscj0oblswXS5vZmZzZXRMZWZ0LXQrbykqYy5zY3JvbGxSYXRpby54O2Vsc2UgdmFyIGk9XCJ5XCIscj0oblswXS5vZmZzZXRUb3AtZSthKSpjLnNjcm9sbFJhdGlvLnk7RyhzLHIudG9TdHJpbmcoKSx7ZGlyOmksZHJhZzohMH0pfXZhciBuLHIsbCxzPWUodGhpcyksYz1zLmRhdGEoaSksZj1jLm9wdCxoPWkrXCJfXCIrYy5pZHgsbT1bXCJtQ1NCX1wiK2MuaWR4K1wiX2RyYWdnZXJfdmVydGljYWxcIixcIm1DU0JfXCIrYy5pZHgrXCJfZHJhZ2dlcl9ob3Jpem9udGFsXCJdLHA9ZShcIiNtQ1NCX1wiK2MuaWR4K1wiX2NvbnRhaW5lclwiKSxnPWUoXCIjXCIrbVswXStcIiwjXCIrbVsxXSksdj1mLmFkdmFuY2VkLnJlbGVhc2VEcmFnZ2FibGVTZWxlY3RvcnM/Zy5hZGQoZShmLmFkdmFuY2VkLnJlbGVhc2VEcmFnZ2FibGVTZWxlY3RvcnMpKTpnO2cuYmluZChcIm1vdXNlZG93bi5cIitoK1wiIHRvdWNoc3RhcnQuXCIraCtcIiBwb2ludGVyZG93bi5cIitoK1wiIE1TUG9pbnRlckRvd24uXCIraCxmdW5jdGlvbihvKXtpZihvLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLG8ucHJldmVudERlZmF1bHQoKSxldChvKSl7dT0hMCxkJiYoYS5vbnNlbGVjdHN0YXJ0PWZ1bmN0aW9uKCl7cmV0dXJuITF9KSx0KCExKSxRKHMpLG49ZSh0aGlzKTt2YXIgaT1uLm9mZnNldCgpLGM9RShvKVswXS1pLnRvcCxoPUUobylbMV0taS5sZWZ0LG09bi5oZWlnaHQoKStpLnRvcCxwPW4ud2lkdGgoKStpLmxlZnQ7bT5jJiZjPjAmJnA+aCYmaD4wJiYocj1jLGw9aCksVChuLFwiYWN0aXZlXCIsZi5hdXRvRXhwYW5kU2Nyb2xsYmFyKX19KS5iaW5kKFwidG91Y2htb3ZlLlwiK2gsZnVuY3Rpb24oZSl7ZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSxlLnByZXZlbnREZWZhdWx0KCk7dmFyIHQ9bi5vZmZzZXQoKSxhPUUoZSlbMF0tdC50b3AsaT1FKGUpWzFdLXQubGVmdDtvKHIsbCxhLGkpfSksZShhKS5iaW5kKFwibW91c2Vtb3ZlLlwiK2grXCIgcG9pbnRlcm1vdmUuXCIraCtcIiBNU1BvaW50ZXJNb3ZlLlwiK2gsZnVuY3Rpb24oZSl7aWYobil7dmFyIHQ9bi5vZmZzZXQoKSxhPUUoZSlbMF0tdC50b3AsaT1FKGUpWzFdLXQubGVmdDtpZihyPT09YSlyZXR1cm47byhyLGwsYSxpKX19KS5hZGQodikuYmluZChcIm1vdXNldXAuXCIraCtcIiB0b3VjaGVuZC5cIitoK1wiIHBvaW50ZXJ1cC5cIitoK1wiIE1TUG9pbnRlclVwLlwiK2gsZnVuY3Rpb24oKXtuJiYoVChuLFwiYWN0aXZlXCIsZi5hdXRvRXhwYW5kU2Nyb2xsYmFyKSxuPW51bGwpLHU9ITEsZCYmKGEub25zZWxlY3RzdGFydD1udWxsKSx0KCEwKX0pfSxMPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChlLHQpe3ZhciBhPVsxLjUqdCwyKnQsdC8xLjUsdC8yXTtyZXR1cm4gZT45MD90PjQ/YVswXTphWzNdOmU+NjA/dD4zP2FbM106YVsyXTplPjMwP3Q+OD9hWzFdOnQ+Nj9hWzBdOnQ+ND90OmFbMl06dD44P3Q6YVszXX1mdW5jdGlvbiBhKGUsdCxhLG8sbixpKXtlJiZHKF8sZS50b1N0cmluZygpLHtkdXI6dCxzY3JvbGxFYXNpbmc6YSxkaXI6byxvdmVyd3JpdGU6bixkcmFnOml9KX12YXIgbixyLGwscyxjLGQsZixoLG0scCxnLHYseCxfPWUodGhpcyksUz1fLmRhdGEoaSksdz1TLm9wdCxiPWkrXCJfXCIrUy5pZHgsQz1lKFwiI21DU0JfXCIrUy5pZHgpLHk9ZShcIiNtQ1NCX1wiK1MuaWR4K1wiX2NvbnRhaW5lclwiKSxCPVtlKFwiI21DU0JfXCIrUy5pZHgrXCJfZHJhZ2dlcl92ZXJ0aWNhbFwiKSxlKFwiI21DU0JfXCIrUy5pZHgrXCJfZHJhZ2dlcl9ob3Jpem9udGFsXCIpXSxUPVtdLGs9W10sTT0wLE89XCJ5eFwiPT09dy5heGlzP1wibm9uZVwiOlwiYWxsXCIsST1bXTt5LmJpbmQoXCJ0b3VjaHN0YXJ0LlwiK2IrXCIgcG9pbnRlcmRvd24uXCIrYitcIiBNU1BvaW50ZXJEb3duLlwiK2IsZnVuY3Rpb24oZSl7aWYoIXR0KGUpfHx1fHxFKGUpWzJdKXJldHVybiB2b2lkKG89MCk7bz0xLHY9MCx4PTA7dmFyIHQ9eS5vZmZzZXQoKTtuPUUoZSlbMF0tdC50b3Ascj1FKGUpWzFdLXQubGVmdCxJPVtFKGUpWzBdLEUoZSlbMV1dfSkuYmluZChcInRvdWNobW92ZS5cIitiK1wiIHBvaW50ZXJtb3ZlLlwiK2IrXCIgTVNQb2ludGVyTW92ZS5cIitiLGZ1bmN0aW9uKGUpe2lmKHR0KGUpJiYhdSYmIUUoZSlbMl0mJihlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLCF4fHx2KSl7ZD1LKCk7dmFyIHQ9Qy5vZmZzZXQoKSxvPUUoZSlbMF0tdC50b3AsaT1FKGUpWzFdLXQubGVmdCxsPVwibWNzTGluZWFyT3V0XCI7aWYoVC5wdXNoKG8pLGsucHVzaChpKSxJWzJdPU1hdGguYWJzKEUoZSlbMF0tSVswXSksSVszXT1NYXRoLmFicyhFKGUpWzFdLUlbMV0pLFMub3ZlcmZsb3dlZFswXSl2YXIgcz1CWzBdLnBhcmVudCgpLmhlaWdodCgpLUJbMF0uaGVpZ2h0KCksYz1uLW8+MCYmby1uPi0ocypTLnNjcm9sbFJhdGlvLnkpJiYoMipJWzNdPElbMl18fFwieXhcIj09PXcuYXhpcyk7aWYoUy5vdmVyZmxvd2VkWzFdKXZhciBmPUJbMV0ucGFyZW50KCkud2lkdGgoKS1CWzFdLndpZHRoKCksaD1yLWk+MCYmaS1yPi0oZipTLnNjcm9sbFJhdGlvLngpJiYoMipJWzJdPElbM118fFwieXhcIj09PXcuYXhpcyk7Y3x8aD8oZS5wcmV2ZW50RGVmYXVsdCgpLHY9MSk6eD0xLHA9XCJ5eFwiPT09dy5heGlzP1tuLW8sci1pXTpcInhcIj09PXcuYXhpcz9bbnVsbCxyLWldOltuLW8sbnVsbF0seVswXS5pZGxlVGltZXI9MjUwLFMub3ZlcmZsb3dlZFswXSYmYShwWzBdLE0sbCxcInlcIixcImFsbFwiLCEwKSxTLm92ZXJmbG93ZWRbMV0mJmEocFsxXSxNLGwsXCJ4XCIsTywhMCl9fSksQy5iaW5kKFwidG91Y2hzdGFydC5cIitiK1wiIHBvaW50ZXJkb3duLlwiK2IrXCIgTVNQb2ludGVyRG93bi5cIitiLGZ1bmN0aW9uKGUpe2lmKCF0dChlKXx8dXx8RShlKVsyXSlyZXR1cm4gdm9pZChvPTApO289MSxlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLFEoXyksYz1LKCk7dmFyIHQ9Qy5vZmZzZXQoKTtsPUUoZSlbMF0tdC50b3Ascz1FKGUpWzFdLXQubGVmdCxUPVtdLGs9W119KS5iaW5kKFwidG91Y2hlbmQuXCIrYitcIiBwb2ludGVydXAuXCIrYitcIiBNU1BvaW50ZXJVcC5cIitiLGZ1bmN0aW9uKGUpe2lmKHR0KGUpJiYhdSYmIUUoZSlbMl0pe2Uuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksdj0wLHg9MCxmPUsoKTt2YXIgbz1DLm9mZnNldCgpLG49RShlKVswXS1vLnRvcCxpPUUoZSlbMV0tby5sZWZ0O2lmKCEoZi1kPjMwKSl7bT0xZTMvKGYtYyk7dmFyIHI9XCJtY3NFYXNlT3V0XCIsXz0yLjU+bSxiPV8/W1RbVC5sZW5ndGgtMl0sa1trLmxlbmd0aC0yXV06WzAsMF07aD1fP1tuLWJbMF0saS1iWzFdXTpbbi1sLGktc107dmFyIEI9W01hdGguYWJzKGhbMF0pLE1hdGguYWJzKGhbMV0pXTttPV8/W01hdGguYWJzKGhbMF0vNCksTWF0aC5hYnMoaFsxXS80KV06W20sbV07dmFyIE09W01hdGguYWJzKHlbMF0ub2Zmc2V0VG9wKS1oWzBdKnQoQlswXS9tWzBdLG1bMF0pLE1hdGguYWJzKHlbMF0ub2Zmc2V0TGVmdCktaFsxXSp0KEJbMV0vbVsxXSxtWzFdKV07cD1cInl4XCI9PT13LmF4aXM/W01bMF0sTVsxXV06XCJ4XCI9PT13LmF4aXM/W251bGwsTVsxXV06W01bMF0sbnVsbF0sZz1bNCpCWzBdK3cuc2Nyb2xsSW5lcnRpYSw0KkJbMV0rdy5zY3JvbGxJbmVydGlhXTt2YXIgST1wYXJzZUludCh3LmNvbnRlbnRUb3VjaFNjcm9sbCl8fDA7cFswXT1CWzBdPkk/cFswXTowLHBbMV09QlsxXT5JP3BbMV06MCxTLm92ZXJmbG93ZWRbMF0mJmEocFswXSxnWzBdLHIsXCJ5XCIsTywhMSksUy5vdmVyZmxvd2VkWzFdJiZhKHBbMV0sZ1sxXSxyLFwieFwiLE8sITEpfX19KX0sVz1mdW5jdGlvbigpe2Z1bmN0aW9uIG4oKXtyZXR1cm4gdC5nZXRTZWxlY3Rpb24/dC5nZXRTZWxlY3Rpb24oKS50b1N0cmluZygpOmEuc2VsZWN0aW9uJiZcIkNvbnRyb2xcIiE9YS5zZWxlY3Rpb24udHlwZT9hLnNlbGVjdGlvbi5jcmVhdGVSYW5nZSgpLnRleHQ6MH1mdW5jdGlvbiByKGUsdCxhKXtmLnR5cGU9YSYmbD9cInN0ZXBwZWRcIjpcInN0ZXBsZXNzXCIsZi5zY3JvbGxBbW91bnQ9MTAsaihzLGUsdCxcIm1jc0xpbmVhck91dFwiLGE/NjA6bnVsbCl9dmFyIGwscz1lKHRoaXMpLGM9cy5kYXRhKGkpLGQ9Yy5vcHQsZj1jLnNlcXVlbnRpYWwsaD1pK1wiX1wiK2MuaWR4LG09ZShcIiNtQ1NCX1wiK2MuaWR4K1wiX2NvbnRhaW5lclwiKSxwPW0ucGFyZW50KCk7bS5iaW5kKFwibW91c2Vkb3duLlwiK2gsZnVuY3Rpb24oKXtvfHxsfHwobD0xLHU9ITApfSkuYWRkKGEpLmJpbmQoXCJtb3VzZW1vdmUuXCIraCxmdW5jdGlvbihlKXtpZighbyYmbCYmbigpKXt2YXIgdD1tLm9mZnNldCgpLGE9RShlKVswXS10LnRvcCttWzBdLm9mZnNldFRvcCxpPUUoZSlbMV0tdC5sZWZ0K21bMF0ub2Zmc2V0TGVmdDthPjAmJmE8cC5oZWlnaHQoKSYmaT4wJiZpPHAud2lkdGgoKT9mLnN0ZXAmJnIoXCJvZmZcIixudWxsLFwic3RlcHBlZFwiKTooXCJ4XCIhPT1kLmF4aXMmJmMub3ZlcmZsb3dlZFswXSYmKDA+YT9yKFwib25cIiwzOCk6YT5wLmhlaWdodCgpJiZyKFwib25cIiw0MCkpLFwieVwiIT09ZC5heGlzJiZjLm92ZXJmbG93ZWRbMV0mJigwPmk/cihcIm9uXCIsMzcpOmk+cC53aWR0aCgpJiZyKFwib25cIiwzOSkpKX19KS5iaW5kKFwibW91c2V1cC5cIitoLGZ1bmN0aW9uKCl7b3x8KGwmJihsPTAscihcIm9mZlwiLG51bGwpKSx1PSExKX0pfSxBPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChlKXt2YXIgdD1udWxsO3RyeXt2YXIgYT1lLmNvbnRlbnREb2N1bWVudHx8ZS5jb250ZW50V2luZG93LmRvY3VtZW50O3Q9YS5ib2R5LmlubmVySFRNTH1jYXRjaChvKXt9cmV0dXJuIG51bGwhPT10fXZhciBhPWUodGhpcyksbz1hLmRhdGEoaSk7aWYobyl7dmFyIG49by5vcHQscj1pK1wiX1wiK28uaWR4LGw9ZShcIiNtQ1NCX1wiK28uaWR4KSxzPVtlKFwiI21DU0JfXCIrby5pZHgrXCJfZHJhZ2dlcl92ZXJ0aWNhbFwiKSxlKFwiI21DU0JfXCIrby5pZHgrXCJfZHJhZ2dlcl9ob3Jpem9udGFsXCIpXSxjPWUoXCIjbUNTQl9cIitvLmlkeCtcIl9jb250YWluZXJcIikuZmluZChcImlmcmFtZVwiKSx1PWw7Yy5sZW5ndGgmJmMuZWFjaChmdW5jdGlvbigpe3ZhciBhPXRoaXM7dChhKSYmKHU9dS5hZGQoZShhKS5jb250ZW50cygpLmZpbmQoXCJib2R5XCIpKSl9KSx1LmJpbmQoXCJtb3VzZXdoZWVsLlwiK3IsZnVuY3Rpb24odCxpKXtpZihRKGEpLCFQKGEsdC50YXJnZXQpKXt2YXIgcj1cImF1dG9cIiE9PW4ubW91c2VXaGVlbC5kZWx0YUZhY3Rvcj9wYXJzZUludChuLm1vdXNlV2hlZWwuZGVsdGFGYWN0b3IpOmQmJnQuZGVsdGFGYWN0b3I8MTAwPzEwMDp0LmRlbHRhRmFjdG9yfHwxMDA7aWYoXCJ4XCI9PT1uLmF4aXN8fFwieFwiPT09bi5tb3VzZVdoZWVsLmF4aXMpdmFyIGM9XCJ4XCIsdT1bTWF0aC5yb3VuZChyKm8uc2Nyb2xsUmF0aW8ueCkscGFyc2VJbnQobi5tb3VzZVdoZWVsLnNjcm9sbEFtb3VudCldLGY9XCJhdXRvXCIhPT1uLm1vdXNlV2hlZWwuc2Nyb2xsQW1vdW50P3VbMV06dVswXT49bC53aWR0aCgpPy45Kmwud2lkdGgoKTp1WzBdLGg9TWF0aC5hYnMoZShcIiNtQ1NCX1wiK28uaWR4K1wiX2NvbnRhaW5lclwiKVswXS5vZmZzZXRMZWZ0KSxtPXNbMV1bMF0ub2Zmc2V0TGVmdCxwPXNbMV0ucGFyZW50KCkud2lkdGgoKS1zWzFdLndpZHRoKCksZz10LmRlbHRhWHx8dC5kZWx0YVl8fGk7ZWxzZSB2YXIgYz1cInlcIix1PVtNYXRoLnJvdW5kKHIqby5zY3JvbGxSYXRpby55KSxwYXJzZUludChuLm1vdXNlV2hlZWwuc2Nyb2xsQW1vdW50KV0sZj1cImF1dG9cIiE9PW4ubW91c2VXaGVlbC5zY3JvbGxBbW91bnQ/dVsxXTp1WzBdPj1sLmhlaWdodCgpPy45KmwuaGVpZ2h0KCk6dVswXSxoPU1hdGguYWJzKGUoXCIjbUNTQl9cIitvLmlkeCtcIl9jb250YWluZXJcIilbMF0ub2Zmc2V0VG9wKSxtPXNbMF1bMF0ub2Zmc2V0VG9wLHA9c1swXS5wYXJlbnQoKS5oZWlnaHQoKS1zWzBdLmhlaWdodCgpLGc9dC5kZWx0YVl8fGk7XCJ5XCI9PT1jJiYhby5vdmVyZmxvd2VkWzBdfHxcInhcIj09PWMmJiFvLm92ZXJmbG93ZWRbMV18fChuLm1vdXNlV2hlZWwuaW52ZXJ0JiYoZz0tZyksbi5tb3VzZVdoZWVsLm5vcm1hbGl6ZURlbHRhJiYoZz0wPmc/LTE6MSksKGc+MCYmMCE9PW18fDA+ZyYmbSE9PXB8fG4ubW91c2VXaGVlbC5wcmV2ZW50RGVmYXVsdCkmJih0LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLHQucHJldmVudERlZmF1bHQoKSksRyhhLChoLWcqZikudG9TdHJpbmcoKSx7ZGlyOmN9KSl9fSl9fSxQPWZ1bmN0aW9uKHQsYSl7dmFyIG89YS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpLG49dC5kYXRhKGkpLm9wdC5tb3VzZVdoZWVsLmRpc2FibGVPdmVyLHI9W1wic2VsZWN0XCIsXCJ0ZXh0YXJlYVwiXTtyZXR1cm4gZS5pbkFycmF5KG8sbik+LTEmJiEoZS5pbkFycmF5KG8scik+LTEmJiFlKGEpLmlzKFwiOmZvY3VzXCIpKX0sej1mdW5jdGlvbigpe3ZhciB0PWUodGhpcyksYT10LmRhdGEoaSksbz1pK1wiX1wiK2EuaWR4LG49ZShcIiNtQ1NCX1wiK2EuaWR4K1wiX2NvbnRhaW5lclwiKSxyPW4ucGFyZW50KCksbD1lKFwiLm1DU0JfXCIrYS5pZHgrXCJfc2Nyb2xsYmFyIC5cIitmWzEyXSk7bC5iaW5kKFwidG91Y2hzdGFydC5cIitvK1wiIHBvaW50ZXJkb3duLlwiK28rXCIgTVNQb2ludGVyRG93bi5cIitvLGZ1bmN0aW9uKCl7dT0hMH0pLmJpbmQoXCJ0b3VjaGVuZC5cIitvK1wiIHBvaW50ZXJ1cC5cIitvK1wiIE1TUG9pbnRlclVwLlwiK28sZnVuY3Rpb24oKXt1PSExfSkuYmluZChcImNsaWNrLlwiK28sZnVuY3Rpb24obyl7aWYoZShvLnRhcmdldCkuaGFzQ2xhc3MoZlsxMl0pfHxlKG8udGFyZ2V0KS5oYXNDbGFzcyhcIm1DU0JfZHJhZ2dlclJhaWxcIikpe1EodCk7dmFyIGk9ZSh0aGlzKSxsPWkuZmluZChcIi5tQ1NCX2RyYWdnZXJcIik7aWYoaS5wYXJlbnQoXCIubUNTQl9zY3JvbGxUb29sc19ob3Jpem9udGFsXCIpLmxlbmd0aD4wKXtpZighYS5vdmVyZmxvd2VkWzFdKXJldHVybjt2YXIgcz1cInhcIixjPW8ucGFnZVg+bC5vZmZzZXQoKS5sZWZ0Py0xOjEsZD1NYXRoLmFicyhuWzBdLm9mZnNldExlZnQpLS45KmMqci53aWR0aCgpfWVsc2V7aWYoIWEub3ZlcmZsb3dlZFswXSlyZXR1cm47dmFyIHM9XCJ5XCIsYz1vLnBhZ2VZPmwub2Zmc2V0KCkudG9wPy0xOjEsZD1NYXRoLmFicyhuWzBdLm9mZnNldFRvcCktLjkqYypyLmhlaWdodCgpfUcodCxkLnRvU3RyaW5nKCkse2RpcjpzLHNjcm9sbEVhc2luZzpcIm1jc0Vhc2VJbk91dFwifSl9fSl9LEg9ZnVuY3Rpb24oKXt2YXIgdD1lKHRoaXMpLG89dC5kYXRhKGkpLG49by5vcHQscj1pK1wiX1wiK28uaWR4LGw9ZShcIiNtQ1NCX1wiK28uaWR4K1wiX2NvbnRhaW5lclwiKSxzPWwucGFyZW50KCk7bC5iaW5kKFwiZm9jdXNpbi5cIityLGZ1bmN0aW9uKCl7dmFyIG89ZShhLmFjdGl2ZUVsZW1lbnQpLGk9bC5maW5kKFwiLm1DdXN0b21TY3JvbGxCb3hcIikubGVuZ3RoLHI9MDtvLmlzKG4uYWR2YW5jZWQuYXV0b1Njcm9sbE9uRm9jdXMpJiYoUSh0KSxjbGVhclRpbWVvdXQodFswXS5fZm9jdXNUaW1lb3V0KSx0WzBdLl9mb2N1c1RpbWVyPWk/KHIrMTcpKmk6MCx0WzBdLl9mb2N1c1RpbWVvdXQ9c2V0VGltZW91dChmdW5jdGlvbigpe3ZhciBlPVtvdChvKVswXSxvdChvKVsxXV0sYT1bbFswXS5vZmZzZXRUb3AsbFswXS5vZmZzZXRMZWZ0XSxpPVthWzBdK2VbMF0+PTAmJmFbMF0rZVswXTxzLmhlaWdodCgpLW8ub3V0ZXJIZWlnaHQoITEpLGFbMV0rZVsxXT49MCYmYVswXStlWzFdPHMud2lkdGgoKS1vLm91dGVyV2lkdGgoITEpXSxjPVwieXhcIiE9PW4uYXhpc3x8aVswXXx8aVsxXT9cImFsbFwiOlwibm9uZVwiO1wieFwiPT09bi5heGlzfHxpWzBdfHxHKHQsZVswXS50b1N0cmluZygpLHtkaXI6XCJ5XCIsc2Nyb2xsRWFzaW5nOlwibWNzRWFzZUluT3V0XCIsb3ZlcndyaXRlOmMsZHVyOnJ9KSxcInlcIj09PW4uYXhpc3x8aVsxXXx8Ryh0LGVbMV0udG9TdHJpbmcoKSx7ZGlyOlwieFwiLHNjcm9sbEVhc2luZzpcIm1jc0Vhc2VJbk91dFwiLG92ZXJ3cml0ZTpjLGR1cjpyfSl9LHRbMF0uX2ZvY3VzVGltZXIpKX0pfSxVPWZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKSxhPXQuZGF0YShpKSxvPWkrXCJfXCIrYS5pZHgsbj1lKFwiI21DU0JfXCIrYS5pZHgrXCJfY29udGFpbmVyXCIpLnBhcmVudCgpO24uYmluZChcInNjcm9sbC5cIitvLGZ1bmN0aW9uKCl7KDAhPT1uLnNjcm9sbFRvcCgpfHwwIT09bi5zY3JvbGxMZWZ0KCkpJiZlKFwiLm1DU0JfXCIrYS5pZHgrXCJfc2Nyb2xsYmFyXCIpLmNzcyhcInZpc2liaWxpdHlcIixcImhpZGRlblwiKX0pfSxGPWZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKSxhPXQuZGF0YShpKSxvPWEub3B0LG49YS5zZXF1ZW50aWFsLHI9aStcIl9cIithLmlkeCxsPVwiLm1DU0JfXCIrYS5pZHgrXCJfc2Nyb2xsYmFyXCIscz1lKGwrXCI+YVwiKTtzLmJpbmQoXCJtb3VzZWRvd24uXCIrcitcIiB0b3VjaHN0YXJ0LlwiK3IrXCIgcG9pbnRlcmRvd24uXCIrcitcIiBNU1BvaW50ZXJEb3duLlwiK3IrXCIgbW91c2V1cC5cIityK1wiIHRvdWNoZW5kLlwiK3IrXCIgcG9pbnRlcnVwLlwiK3IrXCIgTVNQb2ludGVyVXAuXCIrcitcIiBtb3VzZW91dC5cIityK1wiIHBvaW50ZXJvdXQuXCIrcitcIiBNU1BvaW50ZXJPdXQuXCIrcitcIiBjbGljay5cIityLGZ1bmN0aW9uKGkpe2Z1bmN0aW9uIHIoZSxhKXtuLnNjcm9sbEFtb3VudD1vLnNuYXBBbW91bnR8fG8uc2Nyb2xsQnV0dG9ucy5zY3JvbGxBbW91bnQsaih0LGUsYSl9aWYoaS5wcmV2ZW50RGVmYXVsdCgpLGV0KGkpKXt2YXIgbD1lKHRoaXMpLmF0dHIoXCJjbGFzc1wiKTtzd2l0Y2gobi50eXBlPW8uc2Nyb2xsQnV0dG9ucy5zY3JvbGxUeXBlLGkudHlwZSl7Y2FzZVwibW91c2Vkb3duXCI6Y2FzZVwidG91Y2hzdGFydFwiOmNhc2VcInBvaW50ZXJkb3duXCI6Y2FzZVwiTVNQb2ludGVyRG93blwiOmlmKFwic3RlcHBlZFwiPT09bi50eXBlKXJldHVybjt1PSEwLGEudHdlZW5SdW5uaW5nPSExLHIoXCJvblwiLGwpO2JyZWFrO2Nhc2VcIm1vdXNldXBcIjpjYXNlXCJ0b3VjaGVuZFwiOmNhc2VcInBvaW50ZXJ1cFwiOmNhc2VcIk1TUG9pbnRlclVwXCI6Y2FzZVwibW91c2VvdXRcIjpjYXNlXCJwb2ludGVyb3V0XCI6Y2FzZVwiTVNQb2ludGVyT3V0XCI6aWYoXCJzdGVwcGVkXCI9PT1uLnR5cGUpcmV0dXJuO3U9ITEsbi5kaXImJnIoXCJvZmZcIixsKTticmVhaztjYXNlXCJjbGlja1wiOmlmKFwic3RlcHBlZFwiIT09bi50eXBlfHxhLnR3ZWVuUnVubmluZylyZXR1cm47cihcIm9uXCIsbCl9fX0pfSxxPWZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKSxvPXQuZGF0YShpKSxuPW8ub3B0LHI9by5zZXF1ZW50aWFsLGw9aStcIl9cIitvLmlkeCxzPWUoXCIjbUNTQl9cIitvLmlkeCksYz1lKFwiI21DU0JfXCIrby5pZHgrXCJfY29udGFpbmVyXCIpLGQ9Yy5wYXJlbnQoKSx1PVwiaW5wdXQsdGV4dGFyZWEsc2VsZWN0LGRhdGFsaXN0LGtleWdlbixbY29udGVudGVkaXRhYmxlPSd0cnVlJ11cIjtzLmF0dHIoXCJ0YWJpbmRleFwiLFwiMFwiKS5iaW5kKFwiYmx1ci5cIitsK1wiIGtleWRvd24uXCIrbCtcIiBrZXl1cC5cIitsLGZ1bmN0aW9uKGkpe2Z1bmN0aW9uIGwoZSxhKXtyLnR5cGU9bi5rZXlib2FyZC5zY3JvbGxUeXBlLHIuc2Nyb2xsQW1vdW50PW4uc25hcEFtb3VudHx8bi5rZXlib2FyZC5zY3JvbGxBbW91bnQsXCJzdGVwcGVkXCI9PT1yLnR5cGUmJm8udHdlZW5SdW5uaW5nfHxqKHQsZSxhKX1zd2l0Y2goaS50eXBlKXtjYXNlXCJibHVyXCI6by50d2VlblJ1bm5pbmcmJnIuZGlyJiZsKFwib2ZmXCIsbnVsbCk7YnJlYWs7Y2FzZVwia2V5ZG93blwiOmNhc2VcImtleXVwXCI6dmFyIHM9aS5rZXlDb2RlP2kua2V5Q29kZTppLndoaWNoLGY9XCJvblwiO2lmKFwieFwiIT09bi5heGlzJiYoMzg9PT1zfHw0MD09PXMpfHxcInlcIiE9PW4uYXhpcyYmKDM3PT09c3x8Mzk9PT1zKSl7aWYoKDM4PT09c3x8NDA9PT1zKSYmIW8ub3ZlcmZsb3dlZFswXXx8KDM3PT09c3x8Mzk9PT1zKSYmIW8ub3ZlcmZsb3dlZFsxXSlyZXR1cm47XCJrZXl1cFwiPT09aS50eXBlJiYoZj1cIm9mZlwiKSxlKGEuYWN0aXZlRWxlbWVudCkuaXModSl8fChpLnByZXZlbnREZWZhdWx0KCksaS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSxsKGYscykpfWVsc2UgaWYoMzM9PT1zfHwzND09PXMpe2lmKChvLm92ZXJmbG93ZWRbMF18fG8ub3ZlcmZsb3dlZFsxXSkmJihpLnByZXZlbnREZWZhdWx0KCksaS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSksXCJrZXl1cFwiPT09aS50eXBlKXtRKHQpO3ZhciBoPTM0PT09cz8tMToxO2lmKFwieFwiPT09bi5heGlzfHxcInl4XCI9PT1uLmF4aXMmJm8ub3ZlcmZsb3dlZFsxXSYmIW8ub3ZlcmZsb3dlZFswXSl2YXIgbT1cInhcIixwPU1hdGguYWJzKGNbMF0ub2Zmc2V0TGVmdCktLjkqaCpkLndpZHRoKCk7ZWxzZSB2YXIgbT1cInlcIixwPU1hdGguYWJzKGNbMF0ub2Zmc2V0VG9wKS0uOSpoKmQuaGVpZ2h0KCk7Ryh0LHAudG9TdHJpbmcoKSx7ZGlyOm0sc2Nyb2xsRWFzaW5nOlwibWNzRWFzZUluT3V0XCJ9KX19ZWxzZSBpZigoMzU9PT1zfHwzNj09PXMpJiYhZShhLmFjdGl2ZUVsZW1lbnQpLmlzKHUpJiYoKG8ub3ZlcmZsb3dlZFswXXx8by5vdmVyZmxvd2VkWzFdKSYmKGkucHJldmVudERlZmF1bHQoKSxpLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpKSxcImtleXVwXCI9PT1pLnR5cGUpKXtpZihcInhcIj09PW4uYXhpc3x8XCJ5eFwiPT09bi5heGlzJiZvLm92ZXJmbG93ZWRbMV0mJiFvLm92ZXJmbG93ZWRbMF0pdmFyIG09XCJ4XCIscD0zNT09PXM/TWF0aC5hYnMoZC53aWR0aCgpLWMub3V0ZXJXaWR0aCghMSkpOjA7ZWxzZSB2YXIgbT1cInlcIixwPTM1PT09cz9NYXRoLmFicyhkLmhlaWdodCgpLWMub3V0ZXJIZWlnaHQoITEpKTowO0codCxwLnRvU3RyaW5nKCkse2RpcjptLHNjcm9sbEVhc2luZzpcIm1jc0Vhc2VJbk91dFwifSl9fX0pfSxqPWZ1bmN0aW9uKHQsYSxvLG4scil7ZnVuY3Rpb24gbChlKXt2YXIgYT1cInN0ZXBwZWRcIiE9PXUudHlwZSxvPXI/cjplP2E/cC8xLjU6ZzoxZTMvNjAsaT1lP2E/Ny41OjQwOjIuNSxzPVtNYXRoLmFicyhoWzBdLm9mZnNldFRvcCksTWF0aC5hYnMoaFswXS5vZmZzZXRMZWZ0KV0sZD1bYy5zY3JvbGxSYXRpby55PjEwPzEwOmMuc2Nyb2xsUmF0aW8ueSxjLnNjcm9sbFJhdGlvLng+MTA/MTA6Yy5zY3JvbGxSYXRpby54XSxmPVwieFwiPT09dS5kaXJbMF0/c1sxXSt1LmRpclsxXSpkWzFdKmk6c1swXSt1LmRpclsxXSpkWzBdKmksbT1cInhcIj09PXUuZGlyWzBdP3NbMV0rdS5kaXJbMV0qcGFyc2VJbnQodS5zY3JvbGxBbW91bnQpOnNbMF0rdS5kaXJbMV0qcGFyc2VJbnQodS5zY3JvbGxBbW91bnQpLHY9XCJhdXRvXCIhPT11LnNjcm9sbEFtb3VudD9tOmYseD1uP246ZT9hP1wibWNzTGluZWFyT3V0XCI6XCJtY3NFYXNlSW5PdXRcIjpcIm1jc0xpbmVhclwiLF89ZT8hMDohMTtyZXR1cm4gZSYmMTc+byYmKHY9XCJ4XCI9PT11LmRpclswXT9zWzFdOnNbMF0pLEcodCx2LnRvU3RyaW5nKCkse2Rpcjp1LmRpclswXSxzY3JvbGxFYXNpbmc6eCxkdXI6byxvbkNvbXBsZXRlOl99KSxlP3ZvaWQodS5kaXI9ITEpOihjbGVhclRpbWVvdXQodS5zdGVwKSx2b2lkKHUuc3RlcD1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7bCgpfSxvKSkpfWZ1bmN0aW9uIHMoKXtjbGVhclRpbWVvdXQodS5zdGVwKSwkKHUsXCJzdGVwXCIpLFEodCl9dmFyIGM9dC5kYXRhKGkpLGQ9Yy5vcHQsdT1jLnNlcXVlbnRpYWwsaD1lKFwiI21DU0JfXCIrYy5pZHgrXCJfY29udGFpbmVyXCIpLG09XCJzdGVwcGVkXCI9PT11LnR5cGU/ITA6ITEscD1kLnNjcm9sbEluZXJ0aWE8MjY/MjY6ZC5zY3JvbGxJbmVydGlhLGc9ZC5zY3JvbGxJbmVydGlhPDE/MTc6ZC5zY3JvbGxJbmVydGlhO3N3aXRjaChhKXtjYXNlXCJvblwiOmlmKHUuZGlyPVtvPT09ZlsxNl18fG89PT1mWzE1XXx8Mzk9PT1vfHwzNz09PW8/XCJ4XCI6XCJ5XCIsbz09PWZbMTNdfHxvPT09ZlsxNV18fDM4PT09b3x8Mzc9PT1vPy0xOjFdLFEodCksYXQobykmJlwic3RlcHBlZFwiPT09dS50eXBlKXJldHVybjtsKG0pO2JyZWFrO2Nhc2VcIm9mZlwiOnMoKSwobXx8Yy50d2VlblJ1bm5pbmcmJnUuZGlyKSYmbCghMCl9fSxZPWZ1bmN0aW9uKHQpe3ZhciBhPWUodGhpcykuZGF0YShpKS5vcHQsbz1bXTtyZXR1cm5cImZ1bmN0aW9uXCI9PXR5cGVvZiB0JiYodD10KCkpLHQgaW5zdGFuY2VvZiBBcnJheT9vPXQubGVuZ3RoPjE/W3RbMF0sdFsxXV06XCJ4XCI9PT1hLmF4aXM/W251bGwsdFswXV06W3RbMF0sbnVsbF06KG9bMF09dC55P3QueTp0Lnh8fFwieFwiPT09YS5heGlzP251bGw6dCxvWzFdPXQueD90Lng6dC55fHxcInlcIj09PWEuYXhpcz9udWxsOnQpLFwiZnVuY3Rpb25cIj09dHlwZW9mIG9bMF0mJihvWzBdPW9bMF0oKSksXCJmdW5jdGlvblwiPT10eXBlb2Ygb1sxXSYmKG9bMV09b1sxXSgpKSxvfSxYPWZ1bmN0aW9uKHQsYSl7aWYobnVsbCE9dCYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHQpe3ZhciBvPWUodGhpcyksbj1vLmRhdGEoaSkscj1uLm9wdCxsPWUoXCIjbUNTQl9cIituLmlkeCtcIl9jb250YWluZXJcIikscz1sLnBhcmVudCgpLGM9dHlwZW9mIHQ7YXx8KGE9XCJ4XCI9PT1yLmF4aXM/XCJ4XCI6XCJ5XCIpO3ZhciBkPVwieFwiPT09YT9sLm91dGVyV2lkdGgoITEpOmwub3V0ZXJIZWlnaHQoITEpLHU9XCJ4XCI9PT1hP2xbMF0ub2Zmc2V0TGVmdDpsWzBdLm9mZnNldFRvcCxmPVwieFwiPT09YT9cImxlZnRcIjpcInRvcFwiO3N3aXRjaChjKXtjYXNlXCJmdW5jdGlvblwiOnJldHVybiB0KCk7Y2FzZVwib2JqZWN0XCI6dmFyIG09dC5qcXVlcnk/dDplKHQpO2lmKCFtLmxlbmd0aClyZXR1cm47cmV0dXJuXCJ4XCI9PT1hP290KG0pWzFdOm90KG0pWzBdO2Nhc2VcInN0cmluZ1wiOmNhc2VcIm51bWJlclwiOmlmKGF0KHQpKXJldHVybiBNYXRoLmFicyh0KTtpZigtMSE9PXQuaW5kZXhPZihcIiVcIikpcmV0dXJuIE1hdGguYWJzKGQqcGFyc2VJbnQodCkvMTAwKTtpZigtMSE9PXQuaW5kZXhPZihcIi09XCIpKXJldHVybiBNYXRoLmFicyh1LXBhcnNlSW50KHQuc3BsaXQoXCItPVwiKVsxXSkpO2lmKC0xIT09dC5pbmRleE9mKFwiKz1cIikpe3ZhciBwPXUrcGFyc2VJbnQodC5zcGxpdChcIis9XCIpWzFdKTtyZXR1cm4gcD49MD8wOk1hdGguYWJzKHApfWlmKC0xIT09dC5pbmRleE9mKFwicHhcIikmJmF0KHQuc3BsaXQoXCJweFwiKVswXSkpcmV0dXJuIE1hdGguYWJzKHQuc3BsaXQoXCJweFwiKVswXSk7aWYoXCJ0b3BcIj09PXR8fFwibGVmdFwiPT09dClyZXR1cm4gMDtpZihcImJvdHRvbVwiPT09dClyZXR1cm4gTWF0aC5hYnMocy5oZWlnaHQoKS1sLm91dGVySGVpZ2h0KCExKSk7aWYoXCJyaWdodFwiPT09dClyZXR1cm4gTWF0aC5hYnMocy53aWR0aCgpLWwub3V0ZXJXaWR0aCghMSkpO2lmKFwiZmlyc3RcIj09PXR8fFwibGFzdFwiPT09dCl7dmFyIG09bC5maW5kKFwiOlwiK3QpO3JldHVyblwieFwiPT09YT9vdChtKVsxXTpvdChtKVswXX1yZXR1cm4gZSh0KS5sZW5ndGg/XCJ4XCI9PT1hP290KGUodCkpWzFdOm90KGUodCkpWzBdOihsLmNzcyhmLHQpLHZvaWQgaC51cGRhdGUuY2FsbChudWxsLG9bMF0pKX19fSxOPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGEoKXtjbGVhclRpbWVvdXQodVswXS5hdXRvVXBkYXRlKSx1WzBdLmF1dG9VcGRhdGU9c2V0VGltZW91dChmdW5jdGlvbigpe3JldHVybiBkLmFkdmFuY2VkLnVwZGF0ZU9uU2VsZWN0b3JDaGFuZ2UmJihtPXIoKSxtIT09Uyk/KGwoMyksdm9pZChTPW0pKTooZC5hZHZhbmNlZC51cGRhdGVPbkNvbnRlbnRSZXNpemUmJihwPVt1Lm91dGVySGVpZ2h0KCExKSx1Lm91dGVyV2lkdGgoITEpLHYuaGVpZ2h0KCksdi53aWR0aCgpLF8oKVswXSxfKClbMV1dLChwWzBdIT09d1swXXx8cFsxXSE9PXdbMV18fHBbMl0hPT13WzJdfHxwWzNdIT09d1szXXx8cFs0XSE9PXdbNF18fHBbNV0hPT13WzVdKSYmKGwocFswXSE9PXdbMF18fHBbMV0hPT13WzFdKSx3PXApKSxkLmFkdmFuY2VkLnVwZGF0ZU9uSW1hZ2VMb2FkJiYoZz1vKCksZyE9PWImJih1LmZpbmQoXCJpbWdcIikuZWFjaChmdW5jdGlvbigpe24odGhpcyl9KSxiPWcpKSx2b2lkKChkLmFkdmFuY2VkLnVwZGF0ZU9uU2VsZWN0b3JDaGFuZ2V8fGQuYWR2YW5jZWQudXBkYXRlT25Db250ZW50UmVzaXplfHxkLmFkdmFuY2VkLnVwZGF0ZU9uSW1hZ2VMb2FkKSYmYSgpKSl9LDYwKX1mdW5jdGlvbiBvKCl7dmFyIGU9MDtyZXR1cm4gZC5hZHZhbmNlZC51cGRhdGVPbkltYWdlTG9hZCYmKGU9dS5maW5kKFwiaW1nXCIpLmxlbmd0aCksZX1mdW5jdGlvbiBuKHQpe2Z1bmN0aW9uIGEoZSx0KXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdC5hcHBseShlLGFyZ3VtZW50cyl9fWZ1bmN0aW9uIG8oKXt0aGlzLm9ubG9hZD1udWxsLGUodCkuYWRkQ2xhc3MoZlsyXSksbCgyKX1pZihlKHQpLmhhc0NsYXNzKGZbMl0pKXJldHVybiB2b2lkIGwoKTt2YXIgbj1uZXcgSW1hZ2U7bi5vbmxvYWQ9YShuLG8pLG4uc3JjPXQuc3JjfWZ1bmN0aW9uIHIoKXtkLmFkdmFuY2VkLnVwZGF0ZU9uU2VsZWN0b3JDaGFuZ2U9PT0hMCYmKGQuYWR2YW5jZWQudXBkYXRlT25TZWxlY3RvckNoYW5nZT1cIipcIik7dmFyIHQ9MCxhPXUuZmluZChkLmFkdmFuY2VkLnVwZGF0ZU9uU2VsZWN0b3JDaGFuZ2UpO3JldHVybiBkLmFkdmFuY2VkLnVwZGF0ZU9uU2VsZWN0b3JDaGFuZ2UmJmEubGVuZ3RoPjAmJmEuZWFjaChmdW5jdGlvbigpe3QrPWUodGhpcykuaGVpZ2h0KCkrZSh0aGlzKS53aWR0aCgpfSksdH1mdW5jdGlvbiBsKGUpe2NsZWFyVGltZW91dCh1WzBdLmF1dG9VcGRhdGUpLGgudXBkYXRlLmNhbGwobnVsbCxzWzBdLGUpfXZhciBzPWUodGhpcyksYz1zLmRhdGEoaSksZD1jLm9wdCx1PWUoXCIjbUNTQl9cIitjLmlkeCtcIl9jb250YWluZXJcIik7aWYodClyZXR1cm4gY2xlYXJUaW1lb3V0KHVbMF0uYXV0b1VwZGF0ZSksdm9pZCAkKHVbMF0sXCJhdXRvVXBkYXRlXCIpO3ZhciBtLHAsZyx2PXUucGFyZW50KCkseD1bZShcIiNtQ1NCX1wiK2MuaWR4K1wiX3Njcm9sbGJhcl92ZXJ0aWNhbFwiKSxlKFwiI21DU0JfXCIrYy5pZHgrXCJfc2Nyb2xsYmFyX2hvcml6b250YWxcIildLF89ZnVuY3Rpb24oKXtyZXR1cm5beFswXS5pcyhcIjp2aXNpYmxlXCIpP3hbMF0ub3V0ZXJIZWlnaHQoITApOjAseFsxXS5pcyhcIjp2aXNpYmxlXCIpP3hbMV0ub3V0ZXJXaWR0aCghMCk6MF19LFM9cigpLHc9W3Uub3V0ZXJIZWlnaHQoITEpLHUub3V0ZXJXaWR0aCghMSksdi5oZWlnaHQoKSx2LndpZHRoKCksXygpWzBdLF8oKVsxXV0sYj1vKCk7YSgpfSxWPWZ1bmN0aW9uKGUsdCxhKXtyZXR1cm4gTWF0aC5yb3VuZChlL3QpKnQtYX0sUT1mdW5jdGlvbih0KXt2YXIgYT10LmRhdGEoaSksbz1lKFwiI21DU0JfXCIrYS5pZHgrXCJfY29udGFpbmVyLCNtQ1NCX1wiK2EuaWR4K1wiX2NvbnRhaW5lcl93cmFwcGVyLCNtQ1NCX1wiK2EuaWR4K1wiX2RyYWdnZXJfdmVydGljYWwsI21DU0JfXCIrYS5pZHgrXCJfZHJhZ2dlcl9ob3Jpem9udGFsXCIpO28uZWFjaChmdW5jdGlvbigpe1ouY2FsbCh0aGlzKX0pfSxHPWZ1bmN0aW9uKHQsYSxvKXtmdW5jdGlvbiBuKGUpe3JldHVybiBzJiZjLmNhbGxiYWNrc1tlXSYmXCJmdW5jdGlvblwiPT10eXBlb2YgYy5jYWxsYmFja3NbZV19ZnVuY3Rpb24gcigpe3JldHVybltjLmNhbGxiYWNrcy5hbHdheXNUcmlnZ2VyT2Zmc2V0c3x8Xz49U1swXStiLGMuY2FsbGJhY2tzLmFsd2F5c1RyaWdnZXJPZmZzZXRzfHwtQz49X119ZnVuY3Rpb24gbCgpe3ZhciBlPVtoWzBdLm9mZnNldFRvcCxoWzBdLm9mZnNldExlZnRdLGE9W3ZbMF0ub2Zmc2V0VG9wLHZbMF0ub2Zmc2V0TGVmdF0sbj1baC5vdXRlckhlaWdodCghMSksaC5vdXRlcldpZHRoKCExKV0saT1bZi5oZWlnaHQoKSxmLndpZHRoKCldO3RbMF0ubWNzPXtjb250ZW50OmgsdG9wOmVbMF0sbGVmdDplWzFdLGRyYWdnZXJUb3A6YVswXSxkcmFnZ2VyTGVmdDphWzFdLHRvcFBjdDpNYXRoLnJvdW5kKDEwMCpNYXRoLmFicyhlWzBdKS8oTWF0aC5hYnMoblswXSktaVswXSkpLGxlZnRQY3Q6TWF0aC5yb3VuZCgxMDAqTWF0aC5hYnMoZVsxXSkvKE1hdGguYWJzKG5bMV0pLWlbMV0pKSxkaXJlY3Rpb246by5kaXJ9fXZhciBzPXQuZGF0YShpKSxjPXMub3B0LGQ9e3RyaWdnZXI6XCJpbnRlcm5hbFwiLGRpcjpcInlcIixzY3JvbGxFYXNpbmc6XCJtY3NFYXNlT3V0XCIsZHJhZzohMSxkdXI6Yy5zY3JvbGxJbmVydGlhLG92ZXJ3cml0ZTpcImFsbFwiLGNhbGxiYWNrczohMCxvblN0YXJ0OiEwLG9uVXBkYXRlOiEwLG9uQ29tcGxldGU6ITB9LG89ZS5leHRlbmQoZCxvKSx1PVtvLmR1cixvLmRyYWc/MDpvLmR1cl0sZj1lKFwiI21DU0JfXCIrcy5pZHgpLGg9ZShcIiNtQ1NCX1wiK3MuaWR4K1wiX2NvbnRhaW5lclwiKSxtPWgucGFyZW50KCkscD1jLmNhbGxiYWNrcy5vblRvdGFsU2Nyb2xsT2Zmc2V0P1kuY2FsbCh0LGMuY2FsbGJhY2tzLm9uVG90YWxTY3JvbGxPZmZzZXQpOlswLDBdLGc9Yy5jYWxsYmFja3Mub25Ub3RhbFNjcm9sbEJhY2tPZmZzZXQ/WS5jYWxsKHQsYy5jYWxsYmFja3Mub25Ub3RhbFNjcm9sbEJhY2tPZmZzZXQpOlswLDBdO2lmKHMudHJpZ2dlcj1vLnRyaWdnZXIsKDAhPT1tLnNjcm9sbFRvcCgpfHwwIT09bS5zY3JvbGxMZWZ0KCkpJiYoZShcIi5tQ1NCX1wiK3MuaWR4K1wiX3Njcm9sbGJhclwiKS5jc3MoXCJ2aXNpYmlsaXR5XCIsXCJ2aXNpYmxlXCIpLG0uc2Nyb2xsVG9wKDApLnNjcm9sbExlZnQoMCkpLFwiX3Jlc2V0WVwiIT09YXx8cy5jb250ZW50UmVzZXQueXx8KG4oXCJvbk92ZXJmbG93WU5vbmVcIikmJmMuY2FsbGJhY2tzLm9uT3ZlcmZsb3dZTm9uZS5jYWxsKHRbMF0pLHMuY29udGVudFJlc2V0Lnk9MSksXCJfcmVzZXRYXCIhPT1hfHxzLmNvbnRlbnRSZXNldC54fHwobihcIm9uT3ZlcmZsb3dYTm9uZVwiKSYmYy5jYWxsYmFja3Mub25PdmVyZmxvd1hOb25lLmNhbGwodFswXSkscy5jb250ZW50UmVzZXQueD0xKSxcIl9yZXNldFlcIiE9PWEmJlwiX3Jlc2V0WFwiIT09YSl7c3dpdGNoKCFzLmNvbnRlbnRSZXNldC55JiZ0WzBdLm1jc3x8IXMub3ZlcmZsb3dlZFswXXx8KG4oXCJvbk92ZXJmbG93WVwiKSYmYy5jYWxsYmFja3Mub25PdmVyZmxvd1kuY2FsbCh0WzBdKSxzLmNvbnRlbnRSZXNldC54PW51bGwpLCFzLmNvbnRlbnRSZXNldC54JiZ0WzBdLm1jc3x8IXMub3ZlcmZsb3dlZFsxXXx8KG4oXCJvbk92ZXJmbG93WFwiKSYmYy5jYWxsYmFja3Mub25PdmVyZmxvd1guY2FsbCh0WzBdKSxzLmNvbnRlbnRSZXNldC54PW51bGwpLGMuc25hcEFtb3VudCYmKGE9VihhLGMuc25hcEFtb3VudCxjLnNuYXBPZmZzZXQpKSxvLmRpcil7Y2FzZVwieFwiOnZhciB2PWUoXCIjbUNTQl9cIitzLmlkeCtcIl9kcmFnZ2VyX2hvcml6b250YWxcIikseD1cImxlZnRcIixfPWhbMF0ub2Zmc2V0TGVmdCxTPVtmLndpZHRoKCktaC5vdXRlcldpZHRoKCExKSx2LnBhcmVudCgpLndpZHRoKCktdi53aWR0aCgpXSx3PVthLDA9PT1hPzA6YS9zLnNjcm9sbFJhdGlvLnhdLGI9cFsxXSxDPWdbMV0seT1iPjA/Yi9zLnNjcm9sbFJhdGlvLng6MCxCPUM+MD9DL3Muc2Nyb2xsUmF0aW8ueDowO1xuYnJlYWs7Y2FzZVwieVwiOnZhciB2PWUoXCIjbUNTQl9cIitzLmlkeCtcIl9kcmFnZ2VyX3ZlcnRpY2FsXCIpLHg9XCJ0b3BcIixfPWhbMF0ub2Zmc2V0VG9wLFM9W2YuaGVpZ2h0KCktaC5vdXRlckhlaWdodCghMSksdi5wYXJlbnQoKS5oZWlnaHQoKS12LmhlaWdodCgpXSx3PVthLDA9PT1hPzA6YS9zLnNjcm9sbFJhdGlvLnldLGI9cFswXSxDPWdbMF0seT1iPjA/Yi9zLnNjcm9sbFJhdGlvLnk6MCxCPUM+MD9DL3Muc2Nyb2xsUmF0aW8ueTowfXdbMV08MHx8MD09PXdbMF0mJjA9PT13WzFdP3c9WzAsMF06d1sxXT49U1sxXT93PVtTWzBdLFNbMV1dOndbMF09LXdbMF0sdFswXS5tY3N8fChsKCksbihcIm9uSW5pdFwiKSYmYy5jYWxsYmFja3Mub25Jbml0LmNhbGwodFswXSkpLGNsZWFyVGltZW91dChoWzBdLm9uQ29tcGxldGVUaW1lb3V0KSwocy50d2VlblJ1bm5pbmd8fCEoMD09PV8mJndbMF0+PTB8fF89PT1TWzBdJiZ3WzBdPD1TWzBdKSkmJihKKHZbMF0seCxNYXRoLnJvdW5kKHdbMV0pLHVbMV0sby5zY3JvbGxFYXNpbmcpLEooaFswXSx4LE1hdGgucm91bmQod1swXSksdVswXSxvLnNjcm9sbEVhc2luZyxvLm92ZXJ3cml0ZSx7b25TdGFydDpmdW5jdGlvbigpe28uY2FsbGJhY2tzJiZvLm9uU3RhcnQmJiFzLnR3ZWVuUnVubmluZyYmKG4oXCJvblNjcm9sbFN0YXJ0XCIpJiYobCgpLGMuY2FsbGJhY2tzLm9uU2Nyb2xsU3RhcnQuY2FsbCh0WzBdKSkscy50d2VlblJ1bm5pbmc9ITAsVCh2KSxzLmNiT2Zmc2V0cz1yKCkpfSxvblVwZGF0ZTpmdW5jdGlvbigpe28uY2FsbGJhY2tzJiZvLm9uVXBkYXRlJiZuKFwid2hpbGVTY3JvbGxpbmdcIikmJihsKCksYy5jYWxsYmFja3Mud2hpbGVTY3JvbGxpbmcuY2FsbCh0WzBdKSl9LG9uQ29tcGxldGU6ZnVuY3Rpb24oKXtpZihvLmNhbGxiYWNrcyYmby5vbkNvbXBsZXRlKXtcInl4XCI9PT1jLmF4aXMmJmNsZWFyVGltZW91dChoWzBdLm9uQ29tcGxldGVUaW1lb3V0KTt2YXIgZT1oWzBdLmlkbGVUaW1lcnx8MDtoWzBdLm9uQ29tcGxldGVUaW1lb3V0PXNldFRpbWVvdXQoZnVuY3Rpb24oKXtuKFwib25TY3JvbGxcIikmJihsKCksYy5jYWxsYmFja3Mub25TY3JvbGwuY2FsbCh0WzBdKSksbihcIm9uVG90YWxTY3JvbGxcIikmJndbMV0+PVNbMV0teSYmcy5jYk9mZnNldHNbMF0mJihsKCksYy5jYWxsYmFja3Mub25Ub3RhbFNjcm9sbC5jYWxsKHRbMF0pKSxuKFwib25Ub3RhbFNjcm9sbEJhY2tcIikmJndbMV08PUImJnMuY2JPZmZzZXRzWzFdJiYobCgpLGMuY2FsbGJhY2tzLm9uVG90YWxTY3JvbGxCYWNrLmNhbGwodFswXSkpLHMudHdlZW5SdW5uaW5nPSExLGhbMF0uaWRsZVRpbWVyPTAsVCh2LFwiaGlkZVwiKX0sZSl9fX0pKX19LEo9ZnVuY3Rpb24oZSxhLG8sbixpLHIsbCl7ZnVuY3Rpb24gcygpe2Iuc3RvcHx8KF98fHAuY2FsbCgpLF89SygpLXgsYygpLF8+PWIudGltZSYmKGIudGltZT1fPmIudGltZT9fK2gtKF8tYi50aW1lKTpfK2gtMSxiLnRpbWU8XysxJiYoYi50aW1lPV8rMSkpLGIudGltZTxuP2IuaWQ9bShzKTp2LmNhbGwoKSl9ZnVuY3Rpb24gYygpe24+MD8oYi5jdXJyVmFsPWYoYi50aW1lLFMsQyxuLGkpLHdbYV09TWF0aC5yb3VuZChiLmN1cnJWYWwpK1wicHhcIik6d1thXT1vK1wicHhcIixnLmNhbGwoKX1mdW5jdGlvbiBkKCl7aD0xZTMvNjAsYi50aW1lPV8raCxtPXQucmVxdWVzdEFuaW1hdGlvbkZyYW1lP3QucmVxdWVzdEFuaW1hdGlvbkZyYW1lOmZ1bmN0aW9uKGUpe3JldHVybiBjKCksc2V0VGltZW91dChlLC4wMSl9LGIuaWQ9bShzKX1mdW5jdGlvbiB1KCl7bnVsbCE9Yi5pZCYmKHQucmVxdWVzdEFuaW1hdGlvbkZyYW1lP3QuY2FuY2VsQW5pbWF0aW9uRnJhbWUoYi5pZCk6Y2xlYXJUaW1lb3V0KGIuaWQpLGIuaWQ9bnVsbCl9ZnVuY3Rpb24gZihlLHQsYSxvLG4pe3N3aXRjaChuKXtjYXNlXCJsaW5lYXJcIjpjYXNlXCJtY3NMaW5lYXJcIjpyZXR1cm4gYSplL28rdDtjYXNlXCJtY3NMaW5lYXJPdXRcIjpyZXR1cm4gZS89byxlLS0sYSpNYXRoLnNxcnQoMS1lKmUpK3Q7Y2FzZVwiZWFzZUluT3V0U21vb3RoXCI6cmV0dXJuIGUvPW8vMiwxPmU/YS8yKmUqZSt0OihlLS0sLWEvMiooZSooZS0yKS0xKSt0KTtjYXNlXCJlYXNlSW5PdXRTdHJvbmdcIjpyZXR1cm4gZS89by8yLDE+ZT9hLzIqTWF0aC5wb3coMiwxMCooZS0xKSkrdDooZS0tLGEvMiooLU1hdGgucG93KDIsLTEwKmUpKzIpK3QpO2Nhc2VcImVhc2VJbk91dFwiOmNhc2VcIm1jc0Vhc2VJbk91dFwiOnJldHVybiBlLz1vLzIsMT5lP2EvMiplKmUqZSt0OihlLT0yLGEvMiooZSplKmUrMikrdCk7Y2FzZVwiZWFzZU91dFNtb290aFwiOnJldHVybiBlLz1vLGUtLSwtYSooZSplKmUqZS0xKSt0O2Nhc2VcImVhc2VPdXRTdHJvbmdcIjpyZXR1cm4gYSooLU1hdGgucG93KDIsLTEwKmUvbykrMSkrdDtjYXNlXCJlYXNlT3V0XCI6Y2FzZVwibWNzRWFzZU91dFwiOmRlZmF1bHQ6dmFyIGk9KGUvPW8pKmUscj1pKmU7cmV0dXJuIHQrYSooLjQ5OTk5OTk5OTk5OTk5NypyKmkrLTIuNSppKmkrNS41KnIrLTYuNSppKzQqZSl9fWUuX21Ud2Vlbnx8KGUuX21Ud2Vlbj17dG9wOnt9LGxlZnQ6e319KTt2YXIgaCxtLGw9bHx8e30scD1sLm9uU3RhcnR8fGZ1bmN0aW9uKCl7fSxnPWwub25VcGRhdGV8fGZ1bmN0aW9uKCl7fSx2PWwub25Db21wbGV0ZXx8ZnVuY3Rpb24oKXt9LHg9SygpLF89MCxTPWUub2Zmc2V0VG9wLHc9ZS5zdHlsZSxiPWUuX21Ud2VlblthXTtcImxlZnRcIj09PWEmJihTPWUub2Zmc2V0TGVmdCk7dmFyIEM9by1TO2Iuc3RvcD0wLFwibm9uZVwiIT09ciYmdSgpLGQoKX0sSz1mdW5jdGlvbigpe3JldHVybiB0LnBlcmZvcm1hbmNlJiZ0LnBlcmZvcm1hbmNlLm5vdz90LnBlcmZvcm1hbmNlLm5vdygpOnQucGVyZm9ybWFuY2UmJnQucGVyZm9ybWFuY2Uud2Via2l0Tm93P3QucGVyZm9ybWFuY2Uud2Via2l0Tm93KCk6RGF0ZS5ub3c/RGF0ZS5ub3coKToobmV3IERhdGUpLmdldFRpbWUoKX0sWj1mdW5jdGlvbigpe3ZhciBlPXRoaXM7ZS5fbVR3ZWVufHwoZS5fbVR3ZWVuPXt0b3A6e30sbGVmdDp7fX0pO2Zvcih2YXIgYT1bXCJ0b3BcIixcImxlZnRcIl0sbz0wO288YS5sZW5ndGg7bysrKXt2YXIgbj1hW29dO2UuX21Ud2VlbltuXS5pZCYmKHQucmVxdWVzdEFuaW1hdGlvbkZyYW1lP3QuY2FuY2VsQW5pbWF0aW9uRnJhbWUoZS5fbVR3ZWVuW25dLmlkKTpjbGVhclRpbWVvdXQoZS5fbVR3ZWVuW25dLmlkKSxlLl9tVHdlZW5bbl0uaWQ9bnVsbCxlLl9tVHdlZW5bbl0uc3RvcD0xKX19LCQ9ZnVuY3Rpb24oZSx0KXt0cnl7ZGVsZXRlIGVbdF19Y2F0Y2goYSl7ZVt0XT1udWxsfX0sZXQ9ZnVuY3Rpb24oZSl7cmV0dXJuIShlLndoaWNoJiYxIT09ZS53aGljaCl9LHR0PWZ1bmN0aW9uKGUpe3ZhciB0PWUub3JpZ2luYWxFdmVudC5wb2ludGVyVHlwZTtyZXR1cm4hKHQmJlwidG91Y2hcIiE9PXQmJjIhPT10KX0sYXQ9ZnVuY3Rpb24oZSl7cmV0dXJuIWlzTmFOKHBhcnNlRmxvYXQoZSkpJiZpc0Zpbml0ZShlKX0sb3Q9ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wYXJlbnRzKFwiLm1DU0JfY29udGFpbmVyXCIpO3JldHVybltlLm9mZnNldCgpLnRvcC10Lm9mZnNldCgpLnRvcCxlLm9mZnNldCgpLmxlZnQtdC5vZmZzZXQoKS5sZWZ0XX07ZS5mbltuXT1mdW5jdGlvbih0KXtyZXR1cm4gaFt0XT9oW3RdLmFwcGx5KHRoaXMsQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKTpcIm9iamVjdFwiIT10eXBlb2YgdCYmdD92b2lkIGUuZXJyb3IoXCJNZXRob2QgXCIrdCtcIiBkb2VzIG5vdCBleGlzdFwiKTpoLmluaXQuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxlW25dPWZ1bmN0aW9uKHQpe3JldHVybiBoW3RdP2hbdF0uYXBwbHkodGhpcyxBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpOlwib2JqZWN0XCIhPXR5cGVvZiB0JiZ0P3ZvaWQgZS5lcnJvcihcIk1ldGhvZCBcIit0K1wiIGRvZXMgbm90IGV4aXN0XCIpOmguaW5pdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGVbbl0uZGVmYXVsdHM9bCx0W25dPSEwLGUodCkubG9hZChmdW5jdGlvbigpe2Uocilbbl0oKSxlLmV4dGVuZChlLmV4cHJbXCI6XCJdLHttY3NJblZpZXc6ZS5leHByW1wiOlwiXS5tY3NJblZpZXd8fGZ1bmN0aW9uKHQpe3ZhciBhLG8sbj1lKHQpLGk9bi5wYXJlbnRzKFwiLm1DU0JfY29udGFpbmVyXCIpO2lmKGkubGVuZ3RoKXJldHVybiBhPWkucGFyZW50KCksbz1baVswXS5vZmZzZXRUb3AsaVswXS5vZmZzZXRMZWZ0XSxvWzBdK290KG4pWzBdPj0wJiZvWzBdK290KG4pWzBdPGEuaGVpZ2h0KCktbi5vdXRlckhlaWdodCghMSkmJm9bMV0rb3QobilbMV0+PTAmJm9bMV0rb3QobilbMV08YS53aWR0aCgpLW4ub3V0ZXJXaWR0aCghMSl9LG1jc092ZXJmbG93OmUuZXhwcltcIjpcIl0ubWNzT3ZlcmZsb3d8fGZ1bmN0aW9uKHQpe3ZhciBhPWUodCkuZGF0YShpKTtpZihhKXJldHVybiBhLm92ZXJmbG93ZWRbMF18fGEub3ZlcmZsb3dlZFsxXX19KX0pfSl9KGpRdWVyeSx3aW5kb3csZG9jdW1lbnQpOyIsIi8qXG4gQW5ndWxhckpTIHYxLjMuOVxuIChjKSAyMDEwLTIwMTQgR29vZ2xlLCBJbmMuIGh0dHA6Ly9hbmd1bGFyanMub3JnXG4gTGljZW5zZTogTUlUXG4qL1xuKGZ1bmN0aW9uKE0sWSx0KXsndXNlIHN0cmljdCc7ZnVuY3Rpb24gVChiKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYT1hcmd1bWVudHNbMF0sYztjPVwiW1wiKyhiP2IrXCI6XCI6XCJcIikrYStcIl0gaHR0cDovL2Vycm9ycy5hbmd1bGFyanMub3JnLzEuMy45L1wiKyhiP2IrXCIvXCI6XCJcIikrYTtmb3IoYT0xO2E8YXJndW1lbnRzLmxlbmd0aDthKyspe2M9YysoMT09YT9cIj9cIjpcIiZcIikrXCJwXCIrKGEtMSkrXCI9XCI7dmFyIGQ9ZW5jb2RlVVJJQ29tcG9uZW50LGU7ZT1hcmd1bWVudHNbYV07ZT1cImZ1bmN0aW9uXCI9PXR5cGVvZiBlP2UudG9TdHJpbmcoKS5yZXBsYWNlKC8gXFx7W1xcc1xcU10qJC8sXCJcIik6XCJ1bmRlZmluZWRcIj09dHlwZW9mIGU/XCJ1bmRlZmluZWRcIjpcInN0cmluZ1wiIT10eXBlb2YgZT9KU09OLnN0cmluZ2lmeShlKTplO2MrPWQoZSl9cmV0dXJuIEVycm9yKGMpfX1mdW5jdGlvbiBUYShiKXtpZihudWxsPT1ifHxVYShiKSlyZXR1cm4hMTt2YXIgYT1iLmxlbmd0aDtyZXR1cm4gYi5ub2RlVHlwZT09PVxub2EmJmE/ITA6RihiKXx8RChiKXx8MD09PWF8fFwibnVtYmVyXCI9PT10eXBlb2YgYSYmMDxhJiZhLTEgaW4gYn1mdW5jdGlvbiBzKGIsYSxjKXt2YXIgZCxlO2lmKGIpaWYoRyhiKSlmb3IoZCBpbiBiKVwicHJvdG90eXBlXCI9PWR8fFwibGVuZ3RoXCI9PWR8fFwibmFtZVwiPT1kfHxiLmhhc093blByb3BlcnR5JiYhYi5oYXNPd25Qcm9wZXJ0eShkKXx8YS5jYWxsKGMsYltkXSxkLGIpO2Vsc2UgaWYoRChiKXx8VGEoYikpe3ZhciBmPVwib2JqZWN0XCIhPT10eXBlb2YgYjtkPTA7Zm9yKGU9Yi5sZW5ndGg7ZDxlO2QrKykoZnx8ZCBpbiBiKSYmYS5jYWxsKGMsYltkXSxkLGIpfWVsc2UgaWYoYi5mb3JFYWNoJiZiLmZvckVhY2ghPT1zKWIuZm9yRWFjaChhLGMsYik7ZWxzZSBmb3IoZCBpbiBiKWIuaGFzT3duUHJvcGVydHkoZCkmJmEuY2FsbChjLGJbZF0sZCxiKTtyZXR1cm4gYn1mdW5jdGlvbiBFZChiLGEsYyl7Zm9yKHZhciBkPU9iamVjdC5rZXlzKGIpLnNvcnQoKSxlPTA7ZTxkLmxlbmd0aDtlKyspYS5jYWxsKGMsXG5iW2RbZV1dLGRbZV0pO3JldHVybiBkfWZ1bmN0aW9uIGtjKGIpe3JldHVybiBmdW5jdGlvbihhLGMpe2IoYyxhKX19ZnVuY3Rpb24gRmQoKXtyZXR1cm4rK25ifWZ1bmN0aW9uIGxjKGIsYSl7YT9iLiQkaGFzaEtleT1hOmRlbGV0ZSBiLiQkaGFzaEtleX1mdW5jdGlvbiB6KGIpe2Zvcih2YXIgYT1iLiQkaGFzaEtleSxjPTEsZD1hcmd1bWVudHMubGVuZ3RoO2M8ZDtjKyspe3ZhciBlPWFyZ3VtZW50c1tjXTtpZihlKWZvcih2YXIgZj1PYmplY3Qua2V5cyhlKSxnPTAsaD1mLmxlbmd0aDtnPGg7ZysrKXt2YXIgbD1mW2ddO2JbbF09ZVtsXX19bGMoYixhKTtyZXR1cm4gYn1mdW5jdGlvbiBiYShiKXtyZXR1cm4gcGFyc2VJbnQoYiwxMCl9ZnVuY3Rpb24gSCgpe31mdW5jdGlvbiBwYShiKXtyZXR1cm4gYn1mdW5jdGlvbiBkYShiKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gYn19ZnVuY3Rpb24gQShiKXtyZXR1cm5cInVuZGVmaW5lZFwiPT09dHlwZW9mIGJ9ZnVuY3Rpb24geShiKXtyZXR1cm5cInVuZGVmaW5lZFwiIT09XG50eXBlb2YgYn1mdW5jdGlvbiBJKGIpe3JldHVybiBudWxsIT09YiYmXCJvYmplY3RcIj09PXR5cGVvZiBifWZ1bmN0aW9uIEYoYil7cmV0dXJuXCJzdHJpbmdcIj09PXR5cGVvZiBifWZ1bmN0aW9uIFYoYil7cmV0dXJuXCJudW1iZXJcIj09PXR5cGVvZiBifWZ1bmN0aW9uIHFhKGIpe3JldHVyblwiW29iamVjdCBEYXRlXVwiPT09RGEuY2FsbChiKX1mdW5jdGlvbiBHKGIpe3JldHVyblwiZnVuY3Rpb25cIj09PXR5cGVvZiBifWZ1bmN0aW9uIG9iKGIpe3JldHVyblwiW29iamVjdCBSZWdFeHBdXCI9PT1EYS5jYWxsKGIpfWZ1bmN0aW9uIFVhKGIpe3JldHVybiBiJiZiLndpbmRvdz09PWJ9ZnVuY3Rpb24gVmEoYil7cmV0dXJuIGImJmIuJGV2YWxBc3luYyYmYi4kd2F0Y2h9ZnVuY3Rpb24gV2EoYil7cmV0dXJuXCJib29sZWFuXCI9PT10eXBlb2YgYn1mdW5jdGlvbiBtYyhiKXtyZXR1cm4hKCFifHwhKGIubm9kZU5hbWV8fGIucHJvcCYmYi5hdHRyJiZiLmZpbmQpKX1mdW5jdGlvbiBHZChiKXt2YXIgYT17fTtcbmI9Yi5zcGxpdChcIixcIik7dmFyIGM7Zm9yKGM9MDtjPGIubGVuZ3RoO2MrKylhW2JbY11dPSEwO3JldHVybiBhfWZ1bmN0aW9uIHVhKGIpe3JldHVybiBRKGIubm9kZU5hbWV8fGJbMF0mJmJbMF0ubm9kZU5hbWUpfWZ1bmN0aW9uIFhhKGIsYSl7dmFyIGM9Yi5pbmRleE9mKGEpOzA8PWMmJmIuc3BsaWNlKGMsMSk7cmV0dXJuIGF9ZnVuY3Rpb24gRWEoYixhLGMsZCl7aWYoVWEoYil8fFZhKGIpKXRocm93IEthKFwiY3B3c1wiKTtpZihhKXtpZihiPT09YSl0aHJvdyBLYShcImNwaVwiKTtjPWN8fFtdO2Q9ZHx8W107aWYoSShiKSl7dmFyIGU9Yy5pbmRleE9mKGIpO2lmKC0xIT09ZSlyZXR1cm4gZFtlXTtjLnB1c2goYik7ZC5wdXNoKGEpfWlmKEQoYikpZm9yKHZhciBmPWEubGVuZ3RoPTA7ZjxiLmxlbmd0aDtmKyspZT1FYShiW2ZdLG51bGwsYyxkKSxJKGJbZl0pJiYoYy5wdXNoKGJbZl0pLGQucHVzaChlKSksYS5wdXNoKGUpO2Vsc2V7dmFyIGc9YS4kJGhhc2hLZXk7RChhKT9hLmxlbmd0aD1cbjA6cyhhLGZ1bmN0aW9uKGIsYyl7ZGVsZXRlIGFbY119KTtmb3IoZiBpbiBiKWIuaGFzT3duUHJvcGVydHkoZikmJihlPUVhKGJbZl0sbnVsbCxjLGQpLEkoYltmXSkmJihjLnB1c2goYltmXSksZC5wdXNoKGUpKSxhW2ZdPWUpO2xjKGEsZyl9fWVsc2UgaWYoYT1iKUQoYik/YT1FYShiLFtdLGMsZCk6cWEoYik/YT1uZXcgRGF0ZShiLmdldFRpbWUoKSk6b2IoYik/KGE9bmV3IFJlZ0V4cChiLnNvdXJjZSxiLnRvU3RyaW5nKCkubWF0Y2goL1teXFwvXSokLylbMF0pLGEubGFzdEluZGV4PWIubGFzdEluZGV4KTpJKGIpJiYoZT1PYmplY3QuY3JlYXRlKE9iamVjdC5nZXRQcm90b3R5cGVPZihiKSksYT1FYShiLGUsYyxkKSk7cmV0dXJuIGF9ZnVuY3Rpb24gcmEoYixhKXtpZihEKGIpKXthPWF8fFtdO2Zvcih2YXIgYz0wLGQ9Yi5sZW5ndGg7YzxkO2MrKylhW2NdPWJbY119ZWxzZSBpZihJKGIpKWZvcihjIGluIGE9YXx8e30sYilpZihcIiRcIiE9PWMuY2hhckF0KDApfHxcIiRcIiE9PWMuY2hhckF0KDEpKWFbY109XG5iW2NdO3JldHVybiBhfHxifWZ1bmN0aW9uIGZhKGIsYSl7aWYoYj09PWEpcmV0dXJuITA7aWYobnVsbD09PWJ8fG51bGw9PT1hKXJldHVybiExO2lmKGIhPT1iJiZhIT09YSlyZXR1cm4hMDt2YXIgYz10eXBlb2YgYixkO2lmKGM9PXR5cGVvZiBhJiZcIm9iamVjdFwiPT1jKWlmKEQoYikpe2lmKCFEKGEpKXJldHVybiExO2lmKChjPWIubGVuZ3RoKT09YS5sZW5ndGgpe2ZvcihkPTA7ZDxjO2QrKylpZighZmEoYltkXSxhW2RdKSlyZXR1cm4hMTtyZXR1cm4hMH19ZWxzZXtpZihxYShiKSlyZXR1cm4gcWEoYSk/ZmEoYi5nZXRUaW1lKCksYS5nZXRUaW1lKCkpOiExO2lmKG9iKGIpJiZvYihhKSlyZXR1cm4gYi50b1N0cmluZygpPT1hLnRvU3RyaW5nKCk7aWYoVmEoYil8fFZhKGEpfHxVYShiKXx8VWEoYSl8fEQoYSkpcmV0dXJuITE7Yz17fTtmb3IoZCBpbiBiKWlmKFwiJFwiIT09ZC5jaGFyQXQoMCkmJiFHKGJbZF0pKXtpZighZmEoYltkXSxhW2RdKSlyZXR1cm4hMTtjW2RdPSEwfWZvcihkIGluIGEpaWYoIWMuaGFzT3duUHJvcGVydHkoZCkmJlxuXCIkXCIhPT1kLmNoYXJBdCgwKSYmYVtkXSE9PXQmJiFHKGFbZF0pKXJldHVybiExO3JldHVybiEwfXJldHVybiExfWZ1bmN0aW9uIFlhKGIsYSxjKXtyZXR1cm4gYi5jb25jYXQoWmEuY2FsbChhLGMpKX1mdW5jdGlvbiBuYyhiLGEpe3ZhciBjPTI8YXJndW1lbnRzLmxlbmd0aD9aYS5jYWxsKGFyZ3VtZW50cywyKTpbXTtyZXR1cm4hRyhhKXx8YSBpbnN0YW5jZW9mIFJlZ0V4cD9hOmMubGVuZ3RoP2Z1bmN0aW9uKCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/YS5hcHBseShiLFlhKGMsYXJndW1lbnRzLDApKTphLmFwcGx5KGIsYyl9OmZ1bmN0aW9uKCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/YS5hcHBseShiLGFyZ3VtZW50cyk6YS5jYWxsKGIpfX1mdW5jdGlvbiBIZChiLGEpe3ZhciBjPWE7XCJzdHJpbmdcIj09PXR5cGVvZiBiJiZcIiRcIj09PWIuY2hhckF0KDApJiZcIiRcIj09PWIuY2hhckF0KDEpP2M9dDpVYShhKT9jPVwiJFdJTkRPV1wiOmEmJlk9PT1hP2M9XCIkRE9DVU1FTlRcIjpWYShhKSYmXG4oYz1cIiRTQ09QRVwiKTtyZXR1cm4gY31mdW5jdGlvbiAkYShiLGEpe2lmKFwidW5kZWZpbmVkXCI9PT10eXBlb2YgYilyZXR1cm4gdDtWKGEpfHwoYT1hPzI6bnVsbCk7cmV0dXJuIEpTT04uc3RyaW5naWZ5KGIsSGQsYSl9ZnVuY3Rpb24gb2MoYil7cmV0dXJuIEYoYik/SlNPTi5wYXJzZShiKTpifWZ1bmN0aW9uIHZhKGIpe2I9QihiKS5jbG9uZSgpO3RyeXtiLmVtcHR5KCl9Y2F0Y2goYSl7fXZhciBjPUIoXCI8ZGl2PlwiKS5hcHBlbmQoYikuaHRtbCgpO3RyeXtyZXR1cm4gYlswXS5ub2RlVHlwZT09PXBiP1EoYyk6Yy5tYXRjaCgvXig8W14+XSs+KS8pWzFdLnJlcGxhY2UoL148KFtcXHdcXC1dKykvLGZ1bmN0aW9uKGEsYil7cmV0dXJuXCI8XCIrUShiKX0pfWNhdGNoKGQpe3JldHVybiBRKGMpfX1mdW5jdGlvbiBwYyhiKXt0cnl7cmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChiKX1jYXRjaChhKXt9fWZ1bmN0aW9uIHFjKGIpe3ZhciBhPXt9LGMsZDtzKChifHxcIlwiKS5zcGxpdChcIiZcIiksZnVuY3Rpb24oYil7YiYmXG4oYz1iLnJlcGxhY2UoL1xcKy9nLFwiJTIwXCIpLnNwbGl0KFwiPVwiKSxkPXBjKGNbMF0pLHkoZCkmJihiPXkoY1sxXSk/cGMoY1sxXSk6ITAscmMuY2FsbChhLGQpP0QoYVtkXSk/YVtkXS5wdXNoKGIpOmFbZF09W2FbZF0sYl06YVtkXT1iKSl9KTtyZXR1cm4gYX1mdW5jdGlvbiBOYihiKXt2YXIgYT1bXTtzKGIsZnVuY3Rpb24oYixkKXtEKGIpP3MoYixmdW5jdGlvbihiKXthLnB1c2goRmEoZCwhMCkrKCEwPT09Yj9cIlwiOlwiPVwiK0ZhKGIsITApKSl9KTphLnB1c2goRmEoZCwhMCkrKCEwPT09Yj9cIlwiOlwiPVwiK0ZhKGIsITApKSl9KTtyZXR1cm4gYS5sZW5ndGg/YS5qb2luKFwiJlwiKTpcIlwifWZ1bmN0aW9uIHFiKGIpe3JldHVybiBGYShiLCEwKS5yZXBsYWNlKC8lMjYvZ2ksXCImXCIpLnJlcGxhY2UoLyUzRC9naSxcIj1cIikucmVwbGFjZSgvJTJCL2dpLFwiK1wiKX1mdW5jdGlvbiBGYShiLGEpe3JldHVybiBlbmNvZGVVUklDb21wb25lbnQoYikucmVwbGFjZSgvJTQwL2dpLFwiQFwiKS5yZXBsYWNlKC8lM0EvZ2ksXG5cIjpcIikucmVwbGFjZSgvJTI0L2csXCIkXCIpLnJlcGxhY2UoLyUyQy9naSxcIixcIikucmVwbGFjZSgvJTNCL2dpLFwiO1wiKS5yZXBsYWNlKC8lMjAvZyxhP1wiJTIwXCI6XCIrXCIpfWZ1bmN0aW9uIElkKGIsYSl7dmFyIGMsZCxlPXJiLmxlbmd0aDtiPUIoYik7Zm9yKGQ9MDtkPGU7KytkKWlmKGM9cmJbZF0rYSxGKGM9Yi5hdHRyKGMpKSlyZXR1cm4gYztyZXR1cm4gbnVsbH1mdW5jdGlvbiBKZChiLGEpe3ZhciBjLGQsZT17fTtzKHJiLGZ1bmN0aW9uKGEpe2ErPVwiYXBwXCI7IWMmJmIuaGFzQXR0cmlidXRlJiZiLmhhc0F0dHJpYnV0ZShhKSYmKGM9YixkPWIuZ2V0QXR0cmlidXRlKGEpKX0pO3MocmIsZnVuY3Rpb24oYSl7YSs9XCJhcHBcIjt2YXIgZTshYyYmKGU9Yi5xdWVyeVNlbGVjdG9yKFwiW1wiK2EucmVwbGFjZShcIjpcIixcIlxcXFw6XCIpK1wiXVwiKSkmJihjPWUsZD1lLmdldEF0dHJpYnV0ZShhKSl9KTtjJiYoZS5zdHJpY3REaT1udWxsIT09SWQoYyxcInN0cmljdC1kaVwiKSxhKGMsZD9bZF06W10sZSkpfWZ1bmN0aW9uIHNjKGIsXG5hLGMpe0koYyl8fChjPXt9KTtjPXooe3N0cmljdERpOiExfSxjKTt2YXIgZD1mdW5jdGlvbigpe2I9QihiKTtpZihiLmluamVjdG9yKCkpe3ZhciBkPWJbMF09PT1ZP1wiZG9jdW1lbnRcIjp2YShiKTt0aHJvdyBLYShcImJ0c3RycGRcIixkLnJlcGxhY2UoLzwvLFwiJmx0O1wiKS5yZXBsYWNlKC8+LyxcIiZndDtcIikpO31hPWF8fFtdO2EudW5zaGlmdChbXCIkcHJvdmlkZVwiLGZ1bmN0aW9uKGEpe2EudmFsdWUoXCIkcm9vdEVsZW1lbnRcIixiKX1dKTtjLmRlYnVnSW5mb0VuYWJsZWQmJmEucHVzaChbXCIkY29tcGlsZVByb3ZpZGVyXCIsZnVuY3Rpb24oYSl7YS5kZWJ1Z0luZm9FbmFibGVkKCEwKX1dKTthLnVuc2hpZnQoXCJuZ1wiKTtkPU9iKGEsYy5zdHJpY3REaSk7ZC5pbnZva2UoW1wiJHJvb3RTY29wZVwiLFwiJHJvb3RFbGVtZW50XCIsXCIkY29tcGlsZVwiLFwiJGluamVjdG9yXCIsZnVuY3Rpb24oYSxiLGMsZCl7YS4kYXBwbHkoZnVuY3Rpb24oKXtiLmRhdGEoXCIkaW5qZWN0b3JcIixkKTtjKGIpKGEpfSl9XSk7cmV0dXJuIGR9LFxuZT0vXk5HX0VOQUJMRV9ERUJVR19JTkZPIS8sZj0vXk5HX0RFRkVSX0JPT1RTVFJBUCEvO00mJmUudGVzdChNLm5hbWUpJiYoYy5kZWJ1Z0luZm9FbmFibGVkPSEwLE0ubmFtZT1NLm5hbWUucmVwbGFjZShlLFwiXCIpKTtpZihNJiYhZi50ZXN0KE0ubmFtZSkpcmV0dXJuIGQoKTtNLm5hbWU9TS5uYW1lLnJlcGxhY2UoZixcIlwiKTtnYS5yZXN1bWVCb290c3RyYXA9ZnVuY3Rpb24oYil7cyhiLGZ1bmN0aW9uKGIpe2EucHVzaChiKX0pO2QoKX19ZnVuY3Rpb24gS2QoKXtNLm5hbWU9XCJOR19FTkFCTEVfREVCVUdfSU5GTyFcIitNLm5hbWU7TS5sb2NhdGlvbi5yZWxvYWQoKX1mdW5jdGlvbiBMZChiKXtiPWdhLmVsZW1lbnQoYikuaW5qZWN0b3IoKTtpZighYil0aHJvdyBLYShcInRlc3RcIik7cmV0dXJuIGIuZ2V0KFwiJCR0ZXN0YWJpbGl0eVwiKX1mdW5jdGlvbiB0YyhiLGEpe2E9YXx8XCJfXCI7cmV0dXJuIGIucmVwbGFjZShNZCxmdW5jdGlvbihiLGQpe3JldHVybihkP2E6XCJcIikrYi50b0xvd2VyQ2FzZSgpfSl9XG5mdW5jdGlvbiBOZCgpe3ZhciBiO3VjfHwoKHNhPU0ualF1ZXJ5KSYmc2EuZm4ub24/KEI9c2EseihzYS5mbix7c2NvcGU6TGEuc2NvcGUsaXNvbGF0ZVNjb3BlOkxhLmlzb2xhdGVTY29wZSxjb250cm9sbGVyOkxhLmNvbnRyb2xsZXIsaW5qZWN0b3I6TGEuaW5qZWN0b3IsaW5oZXJpdGVkRGF0YTpMYS5pbmhlcml0ZWREYXRhfSksYj1zYS5jbGVhbkRhdGEsc2EuY2xlYW5EYXRhPWZ1bmN0aW9uKGEpe3ZhciBjO2lmKFBiKVBiPSExO2Vsc2UgZm9yKHZhciBkPTAsZTtudWxsIT0oZT1hW2RdKTtkKyspKGM9c2EuX2RhdGEoZSxcImV2ZW50c1wiKSkmJmMuJGRlc3Ryb3kmJnNhKGUpLnRyaWdnZXJIYW5kbGVyKFwiJGRlc3Ryb3lcIik7YihhKX0pOkI9UixnYS5lbGVtZW50PUIsdWM9ITApfWZ1bmN0aW9uIFFiKGIsYSxjKXtpZighYil0aHJvdyBLYShcImFyZXFcIixhfHxcIj9cIixjfHxcInJlcXVpcmVkXCIpO3JldHVybiBifWZ1bmN0aW9uIHNiKGIsYSxjKXtjJiZEKGIpJiYoYj1iW2IubGVuZ3RoLTFdKTtcblFiKEcoYiksYSxcIm5vdCBhIGZ1bmN0aW9uLCBnb3QgXCIrKGImJlwib2JqZWN0XCI9PT10eXBlb2YgYj9iLmNvbnN0cnVjdG9yLm5hbWV8fFwiT2JqZWN0XCI6dHlwZW9mIGIpKTtyZXR1cm4gYn1mdW5jdGlvbiBNYShiLGEpe2lmKFwiaGFzT3duUHJvcGVydHlcIj09PWIpdGhyb3cgS2EoXCJiYWRuYW1lXCIsYSk7fWZ1bmN0aW9uIHZjKGIsYSxjKXtpZighYSlyZXR1cm4gYjthPWEuc3BsaXQoXCIuXCIpO2Zvcih2YXIgZCxlPWIsZj1hLmxlbmd0aCxnPTA7ZzxmO2crKylkPWFbZ10sYiYmKGI9KGU9YilbZF0pO3JldHVybiFjJiZHKGIpP25jKGUsYik6Yn1mdW5jdGlvbiB0YihiKXt2YXIgYT1iWzBdO2I9YltiLmxlbmd0aC0xXTt2YXIgYz1bYV07ZG97YT1hLm5leHRTaWJsaW5nO2lmKCFhKWJyZWFrO2MucHVzaChhKX13aGlsZShhIT09Yik7cmV0dXJuIEIoYyl9ZnVuY3Rpb24gaGEoKXtyZXR1cm4gT2JqZWN0LmNyZWF0ZShudWxsKX1mdW5jdGlvbiBPZChiKXtmdW5jdGlvbiBhKGEsYixjKXtyZXR1cm4gYVtiXXx8XG4oYVtiXT1jKCkpfXZhciBjPVQoXCIkaW5qZWN0b3JcIiksZD1UKFwibmdcIik7Yj1hKGIsXCJhbmd1bGFyXCIsT2JqZWN0KTtiLiQkbWluRXJyPWIuJCRtaW5FcnJ8fFQ7cmV0dXJuIGEoYixcIm1vZHVsZVwiLGZ1bmN0aW9uKCl7dmFyIGI9e307cmV0dXJuIGZ1bmN0aW9uKGYsZyxoKXtpZihcImhhc093blByb3BlcnR5XCI9PT1mKXRocm93IGQoXCJiYWRuYW1lXCIsXCJtb2R1bGVcIik7ZyYmYi5oYXNPd25Qcm9wZXJ0eShmKSYmKGJbZl09bnVsbCk7cmV0dXJuIGEoYixmLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGQsZSxmKXtmfHwoZj1iKTtyZXR1cm4gZnVuY3Rpb24oKXtmW2V8fFwicHVzaFwiXShbYyxkLGFyZ3VtZW50c10pO3JldHVybiB1fX1pZighZyl0aHJvdyBjKFwibm9tb2RcIixmKTt2YXIgYj1bXSxkPVtdLGU9W10scT1hKFwiJGluamVjdG9yXCIsXCJpbnZva2VcIixcInB1c2hcIixkKSx1PXtfaW52b2tlUXVldWU6YixfY29uZmlnQmxvY2tzOmQsX3J1bkJsb2NrczplLHJlcXVpcmVzOmcsbmFtZTpmLHByb3ZpZGVyOmEoXCIkcHJvdmlkZVwiLFxuXCJwcm92aWRlclwiKSxmYWN0b3J5OmEoXCIkcHJvdmlkZVwiLFwiZmFjdG9yeVwiKSxzZXJ2aWNlOmEoXCIkcHJvdmlkZVwiLFwic2VydmljZVwiKSx2YWx1ZTphKFwiJHByb3ZpZGVcIixcInZhbHVlXCIpLGNvbnN0YW50OmEoXCIkcHJvdmlkZVwiLFwiY29uc3RhbnRcIixcInVuc2hpZnRcIiksYW5pbWF0aW9uOmEoXCIkYW5pbWF0ZVByb3ZpZGVyXCIsXCJyZWdpc3RlclwiKSxmaWx0ZXI6YShcIiRmaWx0ZXJQcm92aWRlclwiLFwicmVnaXN0ZXJcIiksY29udHJvbGxlcjphKFwiJGNvbnRyb2xsZXJQcm92aWRlclwiLFwicmVnaXN0ZXJcIiksZGlyZWN0aXZlOmEoXCIkY29tcGlsZVByb3ZpZGVyXCIsXCJkaXJlY3RpdmVcIiksY29uZmlnOnEscnVuOmZ1bmN0aW9uKGEpe2UucHVzaChhKTtyZXR1cm4gdGhpc319O2gmJnEoaCk7cmV0dXJuIHV9KX19KX1mdW5jdGlvbiBQZChiKXt6KGIse2Jvb3RzdHJhcDpzYyxjb3B5OkVhLGV4dGVuZDp6LGVxdWFsczpmYSxlbGVtZW50OkIsZm9yRWFjaDpzLGluamVjdG9yOk9iLG5vb3A6SCxiaW5kOm5jLHRvSnNvbjokYSxcbmZyb21Kc29uOm9jLGlkZW50aXR5OnBhLGlzVW5kZWZpbmVkOkEsaXNEZWZpbmVkOnksaXNTdHJpbmc6Rixpc0Z1bmN0aW9uOkcsaXNPYmplY3Q6SSxpc051bWJlcjpWLGlzRWxlbWVudDptYyxpc0FycmF5OkQsdmVyc2lvbjpRZCxpc0RhdGU6cWEsbG93ZXJjYXNlOlEsdXBwZXJjYXNlOnViLGNhbGxiYWNrczp7Y291bnRlcjowfSxnZXRUZXN0YWJpbGl0eTpMZCwkJG1pbkVycjpULCQkY3NwOmFiLHJlbG9hZFdpdGhEZWJ1Z0luZm86S2R9KTtiYj1PZChNKTt0cnl7YmIoXCJuZ0xvY2FsZVwiKX1jYXRjaChhKXtiYihcIm5nTG9jYWxlXCIsW10pLnByb3ZpZGVyKFwiJGxvY2FsZVwiLFJkKX1iYihcIm5nXCIsW1wibmdMb2NhbGVcIl0sW1wiJHByb3ZpZGVcIixmdW5jdGlvbihhKXthLnByb3ZpZGVyKHskJHNhbml0aXplVXJpOlNkfSk7YS5wcm92aWRlcihcIiRjb21waWxlXCIsd2MpLmRpcmVjdGl2ZSh7YTpUZCxpbnB1dDp4Yyx0ZXh0YXJlYTp4Yyxmb3JtOlVkLHNjcmlwdDpWZCxzZWxlY3Q6V2Qsc3R5bGU6WGQsXG5vcHRpb246WWQsbmdCaW5kOlpkLG5nQmluZEh0bWw6JGQsbmdCaW5kVGVtcGxhdGU6YWUsbmdDbGFzczpiZSxuZ0NsYXNzRXZlbjpjZSxuZ0NsYXNzT2RkOmRlLG5nQ2xvYWs6ZWUsbmdDb250cm9sbGVyOmZlLG5nRm9ybTpnZSxuZ0hpZGU6aGUsbmdJZjppZSxuZ0luY2x1ZGU6amUsbmdJbml0OmtlLG5nTm9uQmluZGFibGU6bGUsbmdQbHVyYWxpemU6bWUsbmdSZXBlYXQ6bmUsbmdTaG93Om9lLG5nU3R5bGU6cGUsbmdTd2l0Y2g6cWUsbmdTd2l0Y2hXaGVuOnJlLG5nU3dpdGNoRGVmYXVsdDpzZSxuZ09wdGlvbnM6dGUsbmdUcmFuc2NsdWRlOnVlLG5nTW9kZWw6dmUsbmdMaXN0OndlLG5nQ2hhbmdlOnhlLHBhdHRlcm46eWMsbmdQYXR0ZXJuOnljLHJlcXVpcmVkOnpjLG5nUmVxdWlyZWQ6emMsbWlubGVuZ3RoOkFjLG5nTWlubGVuZ3RoOkFjLG1heGxlbmd0aDpCYyxuZ01heGxlbmd0aDpCYyxuZ1ZhbHVlOnllLG5nTW9kZWxPcHRpb25zOnplfSkuZGlyZWN0aXZlKHtuZ0luY2x1ZGU6QWV9KS5kaXJlY3RpdmUodmIpLmRpcmVjdGl2ZShDYyk7XG5hLnByb3ZpZGVyKHskYW5jaG9yU2Nyb2xsOkJlLCRhbmltYXRlOkNlLCRicm93c2VyOkRlLCRjYWNoZUZhY3Rvcnk6RWUsJGNvbnRyb2xsZXI6RmUsJGRvY3VtZW50OkdlLCRleGNlcHRpb25IYW5kbGVyOkhlLCRmaWx0ZXI6RGMsJGludGVycG9sYXRlOkllLCRpbnRlcnZhbDpKZSwkaHR0cDpLZSwkaHR0cEJhY2tlbmQ6TGUsJGxvY2F0aW9uOk1lLCRsb2c6TmUsJHBhcnNlOk9lLCRyb290U2NvcGU6UGUsJHE6UWUsJCRxOlJlLCRzY2U6U2UsJHNjZURlbGVnYXRlOlRlLCRzbmlmZmVyOlVlLCR0ZW1wbGF0ZUNhY2hlOlZlLCR0ZW1wbGF0ZVJlcXVlc3Q6V2UsJCR0ZXN0YWJpbGl0eTpYZSwkdGltZW91dDpZZSwkd2luZG93OlplLCQkckFGOiRlLCQkYXN5bmNDYWxsYmFjazphZiwkJGpxTGl0ZTpiZn0pfV0pfWZ1bmN0aW9uIGNiKGIpe3JldHVybiBiLnJlcGxhY2UoY2YsZnVuY3Rpb24oYSxiLGQsZSl7cmV0dXJuIGU/ZC50b1VwcGVyQ2FzZSgpOmR9KS5yZXBsYWNlKGRmLFwiTW96JDFcIil9XG5mdW5jdGlvbiBFYyhiKXtiPWIubm9kZVR5cGU7cmV0dXJuIGI9PT1vYXx8IWJ8fDk9PT1ifWZ1bmN0aW9uIEZjKGIsYSl7dmFyIGMsZCxlPWEuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLGY9W107aWYoUmIudGVzdChiKSl7Yz1jfHxlLmFwcGVuZENoaWxkKGEuY3JlYXRlRWxlbWVudChcImRpdlwiKSk7ZD0oZWYuZXhlYyhiKXx8W1wiXCIsXCJcIl0pWzFdLnRvTG93ZXJDYXNlKCk7ZD1pYVtkXXx8aWEuX2RlZmF1bHQ7Yy5pbm5lckhUTUw9ZFsxXStiLnJlcGxhY2UoZmYsXCI8JDE+PC8kMj5cIikrZFsyXTtmb3IoZD1kWzBdO2QtLTspYz1jLmxhc3RDaGlsZDtmPVlhKGYsYy5jaGlsZE5vZGVzKTtjPWUuZmlyc3RDaGlsZDtjLnRleHRDb250ZW50PVwiXCJ9ZWxzZSBmLnB1c2goYS5jcmVhdGVUZXh0Tm9kZShiKSk7ZS50ZXh0Q29udGVudD1cIlwiO2UuaW5uZXJIVE1MPVwiXCI7cyhmLGZ1bmN0aW9uKGEpe2UuYXBwZW5kQ2hpbGQoYSl9KTtyZXR1cm4gZX1mdW5jdGlvbiBSKGIpe2lmKGIgaW5zdGFuY2VvZlxuUilyZXR1cm4gYjt2YXIgYTtGKGIpJiYoYj1VKGIpLGE9ITApO2lmKCEodGhpcyBpbnN0YW5jZW9mIFIpKXtpZihhJiZcIjxcIiE9Yi5jaGFyQXQoMCkpdGhyb3cgU2IoXCJub3NlbFwiKTtyZXR1cm4gbmV3IFIoYil9aWYoYSl7YT1ZO3ZhciBjO2I9KGM9Z2YuZXhlYyhiKSk/W2EuY3JlYXRlRWxlbWVudChjWzFdKV06KGM9RmMoYixhKSk/Yy5jaGlsZE5vZGVzOltdfUdjKHRoaXMsYil9ZnVuY3Rpb24gVGIoYil7cmV0dXJuIGIuY2xvbmVOb2RlKCEwKX1mdW5jdGlvbiB3YihiLGEpe2F8fHhiKGIpO2lmKGIucXVlcnlTZWxlY3RvckFsbClmb3IodmFyIGM9Yi5xdWVyeVNlbGVjdG9yQWxsKFwiKlwiKSxkPTAsZT1jLmxlbmd0aDtkPGU7ZCsrKXhiKGNbZF0pfWZ1bmN0aW9uIEhjKGIsYSxjLGQpe2lmKHkoZCkpdGhyb3cgU2IoXCJvZmZhcmdzXCIpO3ZhciBlPShkPXliKGIpKSYmZC5ldmVudHMsZj1kJiZkLmhhbmRsZTtpZihmKWlmKGEpcyhhLnNwbGl0KFwiIFwiKSxmdW5jdGlvbihhKXtpZih5KGMpKXt2YXIgZD1cbmVbYV07WGEoZHx8W10sYyk7aWYoZCYmMDxkLmxlbmd0aClyZXR1cm59Yi5yZW1vdmVFdmVudExpc3RlbmVyKGEsZiwhMSk7ZGVsZXRlIGVbYV19KTtlbHNlIGZvcihhIGluIGUpXCIkZGVzdHJveVwiIT09YSYmYi5yZW1vdmVFdmVudExpc3RlbmVyKGEsZiwhMSksZGVsZXRlIGVbYV19ZnVuY3Rpb24geGIoYixhKXt2YXIgYz1iLm5nMzM5LGQ9YyYmemJbY107ZCYmKGE/ZGVsZXRlIGQuZGF0YVthXTooZC5oYW5kbGUmJihkLmV2ZW50cy4kZGVzdHJveSYmZC5oYW5kbGUoe30sXCIkZGVzdHJveVwiKSxIYyhiKSksZGVsZXRlIHpiW2NdLGIubmczMzk9dCkpfWZ1bmN0aW9uIHliKGIsYSl7dmFyIGM9Yi5uZzMzOSxjPWMmJnpiW2NdO2EmJiFjJiYoYi5uZzMzOT1jPSsraGYsYz16YltjXT17ZXZlbnRzOnt9LGRhdGE6e30saGFuZGxlOnR9KTtyZXR1cm4gY31mdW5jdGlvbiBVYihiLGEsYyl7aWYoRWMoYikpe3ZhciBkPXkoYyksZT0hZCYmYSYmIUkoYSksZj0hYTtiPShiPXliKGIsIWUpKSYmYi5kYXRhO1xuaWYoZCliW2FdPWM7ZWxzZXtpZihmKXJldHVybiBiO2lmKGUpcmV0dXJuIGImJmJbYV07eihiLGEpfX19ZnVuY3Rpb24gQWIoYixhKXtyZXR1cm4gYi5nZXRBdHRyaWJ1dGU/LTE8KFwiIFwiKyhiLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpfHxcIlwiKStcIiBcIikucmVwbGFjZSgvW1xcblxcdF0vZyxcIiBcIikuaW5kZXhPZihcIiBcIithK1wiIFwiKTohMX1mdW5jdGlvbiBCYihiLGEpe2EmJmIuc2V0QXR0cmlidXRlJiZzKGEuc3BsaXQoXCIgXCIpLGZ1bmN0aW9uKGEpe2Iuc2V0QXR0cmlidXRlKFwiY2xhc3NcIixVKChcIiBcIisoYi5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKXx8XCJcIikrXCIgXCIpLnJlcGxhY2UoL1tcXG5cXHRdL2csXCIgXCIpLnJlcGxhY2UoXCIgXCIrVShhKStcIiBcIixcIiBcIikpKX0pfWZ1bmN0aW9uIENiKGIsYSl7aWYoYSYmYi5zZXRBdHRyaWJ1dGUpe3ZhciBjPShcIiBcIisoYi5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKXx8XCJcIikrXCIgXCIpLnJlcGxhY2UoL1tcXG5cXHRdL2csXCIgXCIpO3MoYS5zcGxpdChcIiBcIiksZnVuY3Rpb24oYSl7YT1cblUoYSk7LTE9PT1jLmluZGV4T2YoXCIgXCIrYStcIiBcIikmJihjKz1hK1wiIFwiKX0pO2Iuc2V0QXR0cmlidXRlKFwiY2xhc3NcIixVKGMpKX19ZnVuY3Rpb24gR2MoYixhKXtpZihhKWlmKGEubm9kZVR5cGUpYltiLmxlbmd0aCsrXT1hO2Vsc2V7dmFyIGM9YS5sZW5ndGg7aWYoXCJudW1iZXJcIj09PXR5cGVvZiBjJiZhLndpbmRvdyE9PWEpe2lmKGMpZm9yKHZhciBkPTA7ZDxjO2QrKyliW2IubGVuZ3RoKytdPWFbZF19ZWxzZSBiW2IubGVuZ3RoKytdPWF9fWZ1bmN0aW9uIEljKGIsYSl7cmV0dXJuIERiKGIsXCIkXCIrKGF8fFwibmdDb250cm9sbGVyXCIpK1wiQ29udHJvbGxlclwiKX1mdW5jdGlvbiBEYihiLGEsYyl7OT09Yi5ub2RlVHlwZSYmKGI9Yi5kb2N1bWVudEVsZW1lbnQpO2ZvcihhPUQoYSk/YTpbYV07Yjspe2Zvcih2YXIgZD0wLGU9YS5sZW5ndGg7ZDxlO2QrKylpZigoYz1CLmRhdGEoYixhW2RdKSkhPT10KXJldHVybiBjO2I9Yi5wYXJlbnROb2RlfHwxMT09PWIubm9kZVR5cGUmJmIuaG9zdH19XG5mdW5jdGlvbiBKYyhiKXtmb3Iod2IoYiwhMCk7Yi5maXJzdENoaWxkOyliLnJlbW92ZUNoaWxkKGIuZmlyc3RDaGlsZCl9ZnVuY3Rpb24gS2MoYixhKXthfHx3YihiKTt2YXIgYz1iLnBhcmVudE5vZGU7YyYmYy5yZW1vdmVDaGlsZChiKX1mdW5jdGlvbiBqZihiLGEpe2E9YXx8TTtpZihcImNvbXBsZXRlXCI9PT1hLmRvY3VtZW50LnJlYWR5U3RhdGUpYS5zZXRUaW1lb3V0KGIpO2Vsc2UgQihhKS5vbihcImxvYWRcIixiKX1mdW5jdGlvbiBMYyhiLGEpe3ZhciBjPUViW2EudG9Mb3dlckNhc2UoKV07cmV0dXJuIGMmJk1jW3VhKGIpXSYmY31mdW5jdGlvbiBrZihiLGEpe3ZhciBjPWIubm9kZU5hbWU7cmV0dXJuKFwiSU5QVVRcIj09PWN8fFwiVEVYVEFSRUFcIj09PWMpJiZOY1thXX1mdW5jdGlvbiBsZihiLGEpe3ZhciBjPWZ1bmN0aW9uKGMsZSl7Yy5pc0RlZmF1bHRQcmV2ZW50ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gYy5kZWZhdWx0UHJldmVudGVkfTt2YXIgZj1hW2V8fGMudHlwZV0sZz1mP2YubGVuZ3RoOlxuMDtpZihnKXtpZihBKGMuaW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKSl7dmFyIGg9Yy5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb247Yy5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb249ZnVuY3Rpb24oKXtjLmltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZD0hMDtjLnN0b3BQcm9wYWdhdGlvbiYmYy5zdG9wUHJvcGFnYXRpb24oKTtoJiZoLmNhbGwoYyl9fWMuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ9ZnVuY3Rpb24oKXtyZXR1cm4hMD09PWMuaW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkfTsxPGcmJihmPXJhKGYpKTtmb3IodmFyIGw9MDtsPGc7bCsrKWMuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKXx8ZltsXS5jYWxsKGIsYyl9fTtjLmVsZW09YjtyZXR1cm4gY31mdW5jdGlvbiBiZigpe3RoaXMuJGdldD1mdW5jdGlvbigpe3JldHVybiB6KFIse2hhc0NsYXNzOmZ1bmN0aW9uKGIsYSl7Yi5hdHRyJiYoYj1iWzBdKTtyZXR1cm4gQWIoYixhKX0sYWRkQ2xhc3M6ZnVuY3Rpb24oYixcbmEpe2IuYXR0ciYmKGI9YlswXSk7cmV0dXJuIENiKGIsYSl9LHJlbW92ZUNsYXNzOmZ1bmN0aW9uKGIsYSl7Yi5hdHRyJiYoYj1iWzBdKTtyZXR1cm4gQmIoYixhKX19KX19ZnVuY3Rpb24gTmEoYixhKXt2YXIgYz1iJiZiLiQkaGFzaEtleTtpZihjKXJldHVyblwiZnVuY3Rpb25cIj09PXR5cGVvZiBjJiYoYz1iLiQkaGFzaEtleSgpKSxjO2M9dHlwZW9mIGI7cmV0dXJuIGM9XCJmdW5jdGlvblwiPT1jfHxcIm9iamVjdFwiPT1jJiZudWxsIT09Yj9iLiQkaGFzaEtleT1jK1wiOlwiKyhhfHxGZCkoKTpjK1wiOlwiK2J9ZnVuY3Rpb24gZGIoYixhKXtpZihhKXt2YXIgYz0wO3RoaXMubmV4dFVpZD1mdW5jdGlvbigpe3JldHVybisrY319cyhiLHRoaXMucHV0LHRoaXMpfWZ1bmN0aW9uIG1mKGIpe3JldHVybihiPWIudG9TdHJpbmcoKS5yZXBsYWNlKE9jLFwiXCIpLm1hdGNoKFBjKSk/XCJmdW5jdGlvbihcIisoYlsxXXx8XCJcIikucmVwbGFjZSgvW1xcc1xcclxcbl0rLyxcIiBcIikrXCIpXCI6XCJmblwifWZ1bmN0aW9uIFZiKGIsXG5hLGMpe3ZhciBkO2lmKFwiZnVuY3Rpb25cIj09PXR5cGVvZiBiKXtpZighKGQ9Yi4kaW5qZWN0KSl7ZD1bXTtpZihiLmxlbmd0aCl7aWYoYSl0aHJvdyBGKGMpJiZjfHwoYz1iLm5hbWV8fG1mKGIpKSxHYShcInN0cmljdGRpXCIsYyk7YT1iLnRvU3RyaW5nKCkucmVwbGFjZShPYyxcIlwiKTthPWEubWF0Y2goUGMpO3MoYVsxXS5zcGxpdChuZiksZnVuY3Rpb24oYSl7YS5yZXBsYWNlKG9mLGZ1bmN0aW9uKGEsYixjKXtkLnB1c2goYyl9KX0pfWIuJGluamVjdD1kfX1lbHNlIEQoYik/KGE9Yi5sZW5ndGgtMSxzYihiW2FdLFwiZm5cIiksZD1iLnNsaWNlKDAsYSkpOnNiKGIsXCJmblwiLCEwKTtyZXR1cm4gZH1mdW5jdGlvbiBPYihiLGEpe2Z1bmN0aW9uIGMoYSl7cmV0dXJuIGZ1bmN0aW9uKGIsYyl7aWYoSShiKSlzKGIsa2MoYSkpO2Vsc2UgcmV0dXJuIGEoYixjKX19ZnVuY3Rpb24gZChhLGIpe01hKGEsXCJzZXJ2aWNlXCIpO2lmKEcoYil8fEQoYikpYj1xLmluc3RhbnRpYXRlKGIpO2lmKCFiLiRnZXQpdGhyb3cgR2EoXCJwZ2V0XCIsXG5hKTtyZXR1cm4gcFthK1wiUHJvdmlkZXJcIl09Yn1mdW5jdGlvbiBlKGEsYil7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGM9ci5pbnZva2UoYix0aGlzKTtpZihBKGMpKXRocm93IEdhKFwidW5kZWZcIixhKTtyZXR1cm4gY319ZnVuY3Rpb24gZihhLGIsYyl7cmV0dXJuIGQoYSx7JGdldDohMSE9PWM/ZShhLGIpOmJ9KX1mdW5jdGlvbiBnKGEpe3ZhciBiPVtdLGM7cyhhLGZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGQoYSl7dmFyIGIsYztiPTA7Zm9yKGM9YS5sZW5ndGg7YjxjO2IrKyl7dmFyIGU9YVtiXSxmPXEuZ2V0KGVbMF0pO2ZbZVsxXV0uYXBwbHkoZixlWzJdKX19aWYoIW0uZ2V0KGEpKXttLnB1dChhLCEwKTt0cnl7RihhKT8oYz1iYihhKSxiPWIuY29uY2F0KGcoYy5yZXF1aXJlcykpLmNvbmNhdChjLl9ydW5CbG9ja3MpLGQoYy5faW52b2tlUXVldWUpLGQoYy5fY29uZmlnQmxvY2tzKSk6RyhhKT9iLnB1c2gocS5pbnZva2UoYSkpOkQoYSk/Yi5wdXNoKHEuaW52b2tlKGEpKTpzYihhLFwibW9kdWxlXCIpfWNhdGNoKGUpe3Rocm93IEQoYSkmJlxuKGE9YVthLmxlbmd0aC0xXSksZS5tZXNzYWdlJiZlLnN0YWNrJiYtMT09ZS5zdGFjay5pbmRleE9mKGUubWVzc2FnZSkmJihlPWUubWVzc2FnZStcIlxcblwiK2Uuc3RhY2spLEdhKFwibW9kdWxlcnJcIixhLGUuc3RhY2t8fGUubWVzc2FnZXx8ZSk7fX19KTtyZXR1cm4gYn1mdW5jdGlvbiBoKGIsYyl7ZnVuY3Rpb24gZChhLGUpe2lmKGIuaGFzT3duUHJvcGVydHkoYSkpe2lmKGJbYV09PT1sKXRocm93IEdhKFwiY2RlcFwiLGErXCIgPC0gXCIray5qb2luKFwiIDwtIFwiKSk7cmV0dXJuIGJbYV19dHJ5e3JldHVybiBrLnVuc2hpZnQoYSksYlthXT1sLGJbYV09YyhhLGUpfWNhdGNoKGYpe3Rocm93IGJbYV09PT1sJiZkZWxldGUgYlthXSxmO31maW5hbGx5e2suc2hpZnQoKX19ZnVuY3Rpb24gZShiLGMsZixnKXtcInN0cmluZ1wiPT09dHlwZW9mIGYmJihnPWYsZj1udWxsKTt2YXIgaD1bXSxrPVZiKGIsYSxnKSxsLHEscDtxPTA7Zm9yKGw9ay5sZW5ndGg7cTxsO3ErKyl7cD1rW3FdO2lmKFwic3RyaW5nXCIhPT1cbnR5cGVvZiBwKXRocm93IEdhKFwiaXRrblwiLHApO2gucHVzaChmJiZmLmhhc093blByb3BlcnR5KHApP2ZbcF06ZChwLGcpKX1EKGIpJiYoYj1iW2xdKTtyZXR1cm4gYi5hcHBseShjLGgpfXJldHVybntpbnZva2U6ZSxpbnN0YW50aWF0ZTpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9T2JqZWN0LmNyZWF0ZSgoRChhKT9hW2EubGVuZ3RoLTFdOmEpLnByb3RvdHlwZSk7YT1lKGEsZCxiLGMpO3JldHVybiBJKGEpfHxHKGEpP2E6ZH0sZ2V0OmQsYW5ub3RhdGU6VmIsaGFzOmZ1bmN0aW9uKGEpe3JldHVybiBwLmhhc093blByb3BlcnR5KGErXCJQcm92aWRlclwiKXx8Yi5oYXNPd25Qcm9wZXJ0eShhKX19fWE9ITA9PT1hO3ZhciBsPXt9LGs9W10sbT1uZXcgZGIoW10sITApLHA9eyRwcm92aWRlOntwcm92aWRlcjpjKGQpLGZhY3Rvcnk6YyhmKSxzZXJ2aWNlOmMoZnVuY3Rpb24oYSxiKXtyZXR1cm4gZihhLFtcIiRpbmplY3RvclwiLGZ1bmN0aW9uKGEpe3JldHVybiBhLmluc3RhbnRpYXRlKGIpfV0pfSksXG52YWx1ZTpjKGZ1bmN0aW9uKGEsYil7cmV0dXJuIGYoYSxkYShiKSwhMSl9KSxjb25zdGFudDpjKGZ1bmN0aW9uKGEsYil7TWEoYSxcImNvbnN0YW50XCIpO3BbYV09Yjt1W2FdPWJ9KSxkZWNvcmF0b3I6ZnVuY3Rpb24oYSxiKXt2YXIgYz1xLmdldChhK1wiUHJvdmlkZXJcIiksZD1jLiRnZXQ7Yy4kZ2V0PWZ1bmN0aW9uKCl7dmFyIGE9ci5pbnZva2UoZCxjKTtyZXR1cm4gci5pbnZva2UoYixudWxsLHskZGVsZWdhdGU6YX0pfX19fSxxPXAuJGluamVjdG9yPWgocCxmdW5jdGlvbihhLGIpe2dhLmlzU3RyaW5nKGIpJiZrLnB1c2goYik7dGhyb3cgR2EoXCJ1bnByXCIsay5qb2luKFwiIDwtIFwiKSk7fSksdT17fSxyPXUuJGluamVjdG9yPWgodSxmdW5jdGlvbihhLGIpe3ZhciBjPXEuZ2V0KGErXCJQcm92aWRlclwiLGIpO3JldHVybiByLmludm9rZShjLiRnZXQsYyx0LGEpfSk7cyhnKGIpLGZ1bmN0aW9uKGEpe3IuaW52b2tlKGF8fEgpfSk7cmV0dXJuIHJ9ZnVuY3Rpb24gQmUoKXt2YXIgYj0hMDt0aGlzLmRpc2FibGVBdXRvU2Nyb2xsaW5nPVxuZnVuY3Rpb24oKXtiPSExfTt0aGlzLiRnZXQ9W1wiJHdpbmRvd1wiLFwiJGxvY2F0aW9uXCIsXCIkcm9vdFNjb3BlXCIsZnVuY3Rpb24oYSxjLGQpe2Z1bmN0aW9uIGUoYSl7dmFyIGI9bnVsbDtBcnJheS5wcm90b3R5cGUuc29tZS5jYWxsKGEsZnVuY3Rpb24oYSl7aWYoXCJhXCI9PT11YShhKSlyZXR1cm4gYj1hLCEwfSk7cmV0dXJuIGJ9ZnVuY3Rpb24gZihiKXtpZihiKXtiLnNjcm9sbEludG9WaWV3KCk7dmFyIGM7Yz1nLnlPZmZzZXQ7RyhjKT9jPWMoKTptYyhjKT8oYz1jWzBdLGM9XCJmaXhlZFwiIT09YS5nZXRDb21wdXRlZFN0eWxlKGMpLnBvc2l0aW9uPzA6Yy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5ib3R0b20pOlYoYyl8fChjPTApO2MmJihiPWIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wLGEuc2Nyb2xsQnkoMCxiLWMpKX1lbHNlIGEuc2Nyb2xsVG8oMCwwKX1mdW5jdGlvbiBnKCl7dmFyIGE9Yy5oYXNoKCksYjthPyhiPWguZ2V0RWxlbWVudEJ5SWQoYSkpP2YoYik6KGI9ZShoLmdldEVsZW1lbnRzQnlOYW1lKGEpKSk/XG5mKGIpOlwidG9wXCI9PT1hJiZmKG51bGwpOmYobnVsbCl9dmFyIGg9YS5kb2N1bWVudDtiJiZkLiR3YXRjaChmdW5jdGlvbigpe3JldHVybiBjLmhhc2goKX0sZnVuY3Rpb24oYSxiKXthPT09YiYmXCJcIj09PWF8fGpmKGZ1bmN0aW9uKCl7ZC4kZXZhbEFzeW5jKGcpfSl9KTtyZXR1cm4gZ31dfWZ1bmN0aW9uIGFmKCl7dGhpcy4kZ2V0PVtcIiQkckFGXCIsXCIkdGltZW91dFwiLGZ1bmN0aW9uKGIsYSl7cmV0dXJuIGIuc3VwcG9ydGVkP2Z1bmN0aW9uKGEpe3JldHVybiBiKGEpfTpmdW5jdGlvbihiKXtyZXR1cm4gYShiLDAsITEpfX1dfWZ1bmN0aW9uIHBmKGIsYSxjLGQpe2Z1bmN0aW9uIGUoYSl7dHJ5e2EuYXBwbHkobnVsbCxaYS5jYWxsKGFyZ3VtZW50cywxKSl9ZmluYWxseXtpZih2LS0sMD09PXYpZm9yKDt3Lmxlbmd0aDspdHJ5e3cucG9wKCkoKX1jYXRjaChiKXtjLmVycm9yKGIpfX19ZnVuY3Rpb24gZihhLGIpeyhmdW5jdGlvbiBOKCl7cyhMLGZ1bmN0aW9uKGEpe2EoKX0pO0M9YihOLFxuYSl9KSgpfWZ1bmN0aW9uIGcoKXtoKCk7bCgpfWZ1bmN0aW9uIGgoKXt4PWIuaGlzdG9yeS5zdGF0ZTt4PUEoeCk/bnVsbDp4O2ZhKHgsSikmJih4PUopO0o9eH1mdW5jdGlvbiBsKCl7aWYoRSE9PW0udXJsKCl8fFAhPT14KUU9bS51cmwoKSxQPXgscyhXLGZ1bmN0aW9uKGEpe2EobS51cmwoKSx4KX0pfWZ1bmN0aW9uIGsoYSl7dHJ5e3JldHVybiBkZWNvZGVVUklDb21wb25lbnQoYSl9Y2F0Y2goYil7cmV0dXJuIGF9fXZhciBtPXRoaXMscD1hWzBdLHE9Yi5sb2NhdGlvbix1PWIuaGlzdG9yeSxyPWIuc2V0VGltZW91dCxPPWIuY2xlYXJUaW1lb3V0LG49e307bS5pc01vY2s9ITE7dmFyIHY9MCx3PVtdO20uJCRjb21wbGV0ZU91dHN0YW5kaW5nUmVxdWVzdD1lO20uJCRpbmNPdXRzdGFuZGluZ1JlcXVlc3RDb3VudD1mdW5jdGlvbigpe3YrK307bS5ub3RpZnlXaGVuTm9PdXRzdGFuZGluZ1JlcXVlc3RzPWZ1bmN0aW9uKGEpe3MoTCxmdW5jdGlvbihhKXthKCl9KTswPT09dj9hKCk6XG53LnB1c2goYSl9O3ZhciBMPVtdLEM7bS5hZGRQb2xsRm49ZnVuY3Rpb24oYSl7QShDKSYmZigxMDAscik7TC5wdXNoKGEpO3JldHVybiBhfTt2YXIgeCxQLEU9cS5ocmVmLFM9YS5maW5kKFwiYmFzZVwiKSxYPW51bGw7aCgpO1A9eDttLnVybD1mdW5jdGlvbihhLGMsZSl7QShlKSYmKGU9bnVsbCk7cSE9PWIubG9jYXRpb24mJihxPWIubG9jYXRpb24pO3UhPT1iLmhpc3RvcnkmJih1PWIuaGlzdG9yeSk7aWYoYSl7dmFyIGY9UD09PWU7aWYoRT09PWEmJighZC5oaXN0b3J5fHxmKSlyZXR1cm4gbTt2YXIgZz1FJiZIYShFKT09PUhhKGEpO0U9YTtQPWU7IWQuaGlzdG9yeXx8ZyYmZj8oZ3x8KFg9YSksYz9xLnJlcGxhY2UoYSk6Zz8oYz1xLGU9YS5pbmRleE9mKFwiI1wiKSxhPS0xPT09ZT9cIlwiOmEuc3Vic3RyKGUrMSksYy5oYXNoPWEpOnEuaHJlZj1hKToodVtjP1wicmVwbGFjZVN0YXRlXCI6XCJwdXNoU3RhdGVcIl0oZSxcIlwiLGEpLGgoKSxQPXgpO3JldHVybiBtfXJldHVybiBYfHxxLmhyZWYucmVwbGFjZSgvJTI3L2csXG5cIidcIil9O20uc3RhdGU9ZnVuY3Rpb24oKXtyZXR1cm4geH07dmFyIFc9W10sd2E9ITEsSj1udWxsO20ub25VcmxDaGFuZ2U9ZnVuY3Rpb24oYSl7aWYoIXdhKXtpZihkLmhpc3RvcnkpQihiKS5vbihcInBvcHN0YXRlXCIsZyk7QihiKS5vbihcImhhc2hjaGFuZ2VcIixnKTt3YT0hMH1XLnB1c2goYSk7cmV0dXJuIGF9O20uJCRjaGVja1VybENoYW5nZT1sO20uYmFzZUhyZWY9ZnVuY3Rpb24oKXt2YXIgYT1TLmF0dHIoXCJocmVmXCIpO3JldHVybiBhP2EucmVwbGFjZSgvXihodHRwcz9cXDopP1xcL1xcL1teXFwvXSovLFwiXCIpOlwiXCJ9O3ZhciBlYT17fSx5PVwiXCIsY2E9bS5iYXNlSHJlZigpO20uY29va2llcz1mdW5jdGlvbihhLGIpe3ZhciBkLGUsZixnO2lmKGEpYj09PXQ/cC5jb29raWU9ZW5jb2RlVVJJQ29tcG9uZW50KGEpK1wiPTtwYXRoPVwiK2NhK1wiO2V4cGlyZXM9VGh1LCAwMSBKYW4gMTk3MCAwMDowMDowMCBHTVRcIjpGKGIpJiYoZD0ocC5jb29raWU9ZW5jb2RlVVJJQ29tcG9uZW50KGEpK1wiPVwiK2VuY29kZVVSSUNvbXBvbmVudChiKStcblwiO3BhdGg9XCIrY2EpLmxlbmd0aCsxLDQwOTY8ZCYmYy53YXJuKFwiQ29va2llICdcIithK1wiJyBwb3NzaWJseSBub3Qgc2V0IG9yIG92ZXJmbG93ZWQgYmVjYXVzZSBpdCB3YXMgdG9vIGxhcmdlIChcIitkK1wiID4gNDA5NiBieXRlcykhXCIpKTtlbHNle2lmKHAuY29va2llIT09eSlmb3IoeT1wLmNvb2tpZSxkPXkuc3BsaXQoXCI7IFwiKSxlYT17fSxmPTA7ZjxkLmxlbmd0aDtmKyspZT1kW2ZdLGc9ZS5pbmRleE9mKFwiPVwiKSwwPGcmJihhPWsoZS5zdWJzdHJpbmcoMCxnKSksZWFbYV09PT10JiYoZWFbYV09ayhlLnN1YnN0cmluZyhnKzEpKSkpO3JldHVybiBlYX19O20uZGVmZXI9ZnVuY3Rpb24oYSxiKXt2YXIgYzt2Kys7Yz1yKGZ1bmN0aW9uKCl7ZGVsZXRlIG5bY107ZShhKX0sYnx8MCk7bltjXT0hMDtyZXR1cm4gY307bS5kZWZlci5jYW5jZWw9ZnVuY3Rpb24oYSl7cmV0dXJuIG5bYV0/KGRlbGV0ZSBuW2FdLE8oYSksZShIKSwhMCk6ITF9fWZ1bmN0aW9uIERlKCl7dGhpcy4kZ2V0PVtcIiR3aW5kb3dcIixcblwiJGxvZ1wiLFwiJHNuaWZmZXJcIixcIiRkb2N1bWVudFwiLGZ1bmN0aW9uKGIsYSxjLGQpe3JldHVybiBuZXcgcGYoYixkLGEsYyl9XX1mdW5jdGlvbiBFZSgpe3RoaXMuJGdldD1mdW5jdGlvbigpe2Z1bmN0aW9uIGIoYixkKXtmdW5jdGlvbiBlKGEpe2EhPXAmJihxP3E9PWEmJihxPWEubik6cT1hLGYoYS5uLGEucCksZihhLHApLHA9YSxwLm49bnVsbCl9ZnVuY3Rpb24gZihhLGIpe2EhPWImJihhJiYoYS5wPWIpLGImJihiLm49YSkpfWlmKGIgaW4gYSl0aHJvdyBUKFwiJGNhY2hlRmFjdG9yeVwiKShcImlpZFwiLGIpO3ZhciBnPTAsaD16KHt9LGQse2lkOmJ9KSxsPXt9LGs9ZCYmZC5jYXBhY2l0eXx8TnVtYmVyLk1BWF9WQUxVRSxtPXt9LHA9bnVsbCxxPW51bGw7cmV0dXJuIGFbYl09e3B1dDpmdW5jdGlvbihhLGIpe2lmKGs8TnVtYmVyLk1BWF9WQUxVRSl7dmFyIGM9bVthXXx8KG1bYV09e2tleTphfSk7ZShjKX1pZighQShiKSlyZXR1cm4gYSBpbiBsfHxnKyssbFthXT1iLGc+ayYmdGhpcy5yZW1vdmUocS5rZXkpLFxuYn0sZ2V0OmZ1bmN0aW9uKGEpe2lmKGs8TnVtYmVyLk1BWF9WQUxVRSl7dmFyIGI9bVthXTtpZighYilyZXR1cm47ZShiKX1yZXR1cm4gbFthXX0scmVtb3ZlOmZ1bmN0aW9uKGEpe2lmKGs8TnVtYmVyLk1BWF9WQUxVRSl7dmFyIGI9bVthXTtpZighYilyZXR1cm47Yj09cCYmKHA9Yi5wKTtiPT1xJiYocT1iLm4pO2YoYi5uLGIucCk7ZGVsZXRlIG1bYV19ZGVsZXRlIGxbYV07Zy0tfSxyZW1vdmVBbGw6ZnVuY3Rpb24oKXtsPXt9O2c9MDttPXt9O3A9cT1udWxsfSxkZXN0cm95OmZ1bmN0aW9uKCl7bT1oPWw9bnVsbDtkZWxldGUgYVtiXX0saW5mbzpmdW5jdGlvbigpe3JldHVybiB6KHt9LGgse3NpemU6Z30pfX19dmFyIGE9e307Yi5pbmZvPWZ1bmN0aW9uKCl7dmFyIGI9e307cyhhLGZ1bmN0aW9uKGEsZSl7YltlXT1hLmluZm8oKX0pO3JldHVybiBifTtiLmdldD1mdW5jdGlvbihiKXtyZXR1cm4gYVtiXX07cmV0dXJuIGJ9fWZ1bmN0aW9uIFZlKCl7dGhpcy4kZ2V0PVtcIiRjYWNoZUZhY3RvcnlcIixcbmZ1bmN0aW9uKGIpe3JldHVybiBiKFwidGVtcGxhdGVzXCIpfV19ZnVuY3Rpb24gd2MoYixhKXtmdW5jdGlvbiBjKGEsYil7dmFyIGM9L15cXHMqKFtAJl18PShcXCo/KSkoXFw/PylcXHMqKFxcdyopXFxzKiQvLGQ9e307cyhhLGZ1bmN0aW9uKGEsZSl7dmFyIGY9YS5tYXRjaChjKTtpZighZil0aHJvdyBqYShcImlzY3BcIixiLGUsYSk7ZFtlXT17bW9kZTpmWzFdWzBdLGNvbGxlY3Rpb246XCIqXCI9PT1mWzJdLG9wdGlvbmFsOlwiP1wiPT09ZlszXSxhdHRyTmFtZTpmWzRdfHxlfX0pO3JldHVybiBkfXZhciBkPXt9LGU9L15cXHMqZGlyZWN0aXZlXFw6XFxzKihbXFx3XFwtXSspXFxzKyguKikkLyxmPS8oKFtcXHdcXC1dKykoPzpcXDooW147XSspKT87PykvLGc9R2QoXCJuZ1NyYyxuZ1NyY3NldCxzcmMsc3Jjc2V0XCIpLGg9L14oPzooXFxeXFxePyk/KFxcPyk/KFxcXlxcXj8pPyk/LyxsPS9eKG9uW2Etel0rfGZvcm1hY3Rpb24pJC87dGhpcy5kaXJlY3RpdmU9ZnVuY3Rpb24gcChhLGUpe01hKGEsXCJkaXJlY3RpdmVcIik7RihhKT8oUWIoZSxcblwiZGlyZWN0aXZlRmFjdG9yeVwiKSxkLmhhc093blByb3BlcnR5KGEpfHwoZFthXT1bXSxiLmZhY3RvcnkoYStcIkRpcmVjdGl2ZVwiLFtcIiRpbmplY3RvclwiLFwiJGV4Y2VwdGlvbkhhbmRsZXJcIixmdW5jdGlvbihiLGUpe3ZhciBmPVtdO3MoZFthXSxmdW5jdGlvbihkLGcpe3RyeXt2YXIgaD1iLmludm9rZShkKTtHKGgpP2g9e2NvbXBpbGU6ZGEoaCl9OiFoLmNvbXBpbGUmJmgubGluayYmKGguY29tcGlsZT1kYShoLmxpbmspKTtoLnByaW9yaXR5PWgucHJpb3JpdHl8fDA7aC5pbmRleD1nO2gubmFtZT1oLm5hbWV8fGE7aC5yZXF1aXJlPWgucmVxdWlyZXx8aC5jb250cm9sbGVyJiZoLm5hbWU7aC5yZXN0cmljdD1oLnJlc3RyaWN0fHxcIkVBXCI7SShoLnNjb3BlKSYmKGguJCRpc29sYXRlQmluZGluZ3M9YyhoLnNjb3BlLGgubmFtZSkpO2YucHVzaChoKX1jYXRjaChsKXtlKGwpfX0pO3JldHVybiBmfV0pKSxkW2FdLnB1c2goZSkpOnMoYSxrYyhwKSk7cmV0dXJuIHRoaXN9O3RoaXMuYUhyZWZTYW5pdGl6YXRpb25XaGl0ZWxpc3Q9XG5mdW5jdGlvbihiKXtyZXR1cm4geShiKT8oYS5hSHJlZlNhbml0aXphdGlvbldoaXRlbGlzdChiKSx0aGlzKTphLmFIcmVmU2FuaXRpemF0aW9uV2hpdGVsaXN0KCl9O3RoaXMuaW1nU3JjU2FuaXRpemF0aW9uV2hpdGVsaXN0PWZ1bmN0aW9uKGIpe3JldHVybiB5KGIpPyhhLmltZ1NyY1Nhbml0aXphdGlvbldoaXRlbGlzdChiKSx0aGlzKTphLmltZ1NyY1Nhbml0aXphdGlvbldoaXRlbGlzdCgpfTt2YXIgaz0hMDt0aGlzLmRlYnVnSW5mb0VuYWJsZWQ9ZnVuY3Rpb24oYSl7cmV0dXJuIHkoYSk/KGs9YSx0aGlzKTprfTt0aGlzLiRnZXQ9W1wiJGluamVjdG9yXCIsXCIkaW50ZXJwb2xhdGVcIixcIiRleGNlcHRpb25IYW5kbGVyXCIsXCIkdGVtcGxhdGVSZXF1ZXN0XCIsXCIkcGFyc2VcIixcIiRjb250cm9sbGVyXCIsXCIkcm9vdFNjb3BlXCIsXCIkZG9jdW1lbnRcIixcIiRzY2VcIixcIiRhbmltYXRlXCIsXCIkJHNhbml0aXplVXJpXCIsZnVuY3Rpb24oYSxiLGMscixPLG4sdix3LEwsQyx4KXtmdW5jdGlvbiBQKGEsYil7dHJ5e2EuYWRkQ2xhc3MoYil9Y2F0Y2goYyl7fX1cbmZ1bmN0aW9uIEUoYSxiLGMsZCxlKXthIGluc3RhbmNlb2YgQnx8KGE9QihhKSk7cyhhLGZ1bmN0aW9uKGIsYyl7Yi5ub2RlVHlwZT09cGImJmIubm9kZVZhbHVlLm1hdGNoKC9cXFMrLykmJihhW2NdPUIoYikud3JhcChcIjxzcGFuPjwvc3Bhbj5cIikucGFyZW50KClbMF0pfSk7dmFyIGY9UyhhLGIsYSxjLGQsZSk7RS4kJGFkZFNjb3BlQ2xhc3MoYSk7dmFyIGc9bnVsbDtyZXR1cm4gZnVuY3Rpb24oYixjLGQpe1FiKGIsXCJzY29wZVwiKTtkPWR8fHt9O3ZhciBlPWQucGFyZW50Qm91bmRUcmFuc2NsdWRlRm4saD1kLnRyYW5zY2x1ZGVDb250cm9sbGVycztkPWQuZnV0dXJlUGFyZW50RWxlbWVudDtlJiZlLiQkYm91bmRUcmFuc2NsdWRlJiYoZT1lLiQkYm91bmRUcmFuc2NsdWRlKTtnfHwoZz0oZD1kJiZkWzBdKT9cImZvcmVpZ25vYmplY3RcIiE9PXVhKGQpJiZkLnRvU3RyaW5nKCkubWF0Y2goL1NWRy8pP1wic3ZnXCI6XCJodG1sXCI6XCJodG1sXCIpO2Q9XCJodG1sXCIhPT1nP0IoV2IoZyxCKFwiPGRpdj5cIikuYXBwZW5kKGEpLmh0bWwoKSkpOlxuYz9MYS5jbG9uZS5jYWxsKGEpOmE7aWYoaClmb3IodmFyIGwgaW4gaClkLmRhdGEoXCIkXCIrbCtcIkNvbnRyb2xsZXJcIixoW2xdLmluc3RhbmNlKTtFLiQkYWRkU2NvcGVJbmZvKGQsYik7YyYmYyhkLGIpO2YmJmYoYixkLGQsZSk7cmV0dXJuIGR9fWZ1bmN0aW9uIFMoYSxiLGMsZCxlLGYpe2Z1bmN0aW9uIGcoYSxjLGQsZSl7dmFyIGYsbCxrLHEscCxuLHc7aWYocilmb3Iodz1BcnJheShjLmxlbmd0aCkscT0wO3E8aC5sZW5ndGg7cSs9MylmPWhbcV0sd1tmXT1jW2ZdO2Vsc2Ugdz1jO3E9MDtmb3IocD1oLmxlbmd0aDtxPHA7KWw9d1toW3ErK11dLGM9aFtxKytdLGY9aFtxKytdLGM/KGMuc2NvcGU/KGs9YS4kbmV3KCksRS4kJGFkZFNjb3BlSW5mbyhCKGwpLGspKTprPWEsbj1jLnRyYW5zY2x1ZGVPblRoaXNFbGVtZW50P1goYSxjLnRyYW5zY2x1ZGUsZSxjLmVsZW1lbnRUcmFuc2NsdWRlT25UaGlzRWxlbWVudCk6IWMudGVtcGxhdGVPblRoaXNFbGVtZW50JiZlP2U6IWUmJmI/WChhLFxuYik6bnVsbCxjKGYsayxsLGQsbikpOmYmJmYoYSxsLmNoaWxkTm9kZXMsdCxlKX1mb3IodmFyIGg9W10sbCxrLHEscCxyLG49MDtuPGEubGVuZ3RoO24rKyl7bD1uZXcgWGI7az1XKGFbbl0sW10sbCwwPT09bj9kOnQsZSk7KGY9ay5sZW5ndGg/ZWEoayxhW25dLGwsYixjLG51bGwsW10sW10sZik6bnVsbCkmJmYuc2NvcGUmJkUuJCRhZGRTY29wZUNsYXNzKGwuJCRlbGVtZW50KTtsPWYmJmYudGVybWluYWx8fCEocT1hW25dLmNoaWxkTm9kZXMpfHwhcS5sZW5ndGg/bnVsbDpTKHEsZj8oZi50cmFuc2NsdWRlT25UaGlzRWxlbWVudHx8IWYudGVtcGxhdGVPblRoaXNFbGVtZW50KSYmZi50cmFuc2NsdWRlOmIpO2lmKGZ8fGwpaC5wdXNoKG4sZixsKSxwPSEwLHI9cnx8ZjtmPW51bGx9cmV0dXJuIHA/ZzpudWxsfWZ1bmN0aW9uIFgoYSxiLGMsZCl7cmV0dXJuIGZ1bmN0aW9uKGQsZSxmLGcsaCl7ZHx8KGQ9YS4kbmV3KCExLGgpLGQuJCR0cmFuc2NsdWRlZD0hMCk7cmV0dXJuIGIoZCxlLFxue3BhcmVudEJvdW5kVHJhbnNjbHVkZUZuOmMsdHJhbnNjbHVkZUNvbnRyb2xsZXJzOmYsZnV0dXJlUGFyZW50RWxlbWVudDpnfSl9fWZ1bmN0aW9uIFcoYSxiLGMsZCxnKXt2YXIgaD1jLiRhdHRyLGw7c3dpdGNoKGEubm9kZVR5cGUpe2Nhc2Ugb2E6Y2EoYix5YSh1YShhKSksXCJFXCIsZCxnKTtmb3IodmFyIGsscSxwLHI9YS5hdHRyaWJ1dGVzLG49MCx3PXImJnIubGVuZ3RoO248dztuKyspe3ZhciBPPSExLEw9ITE7az1yW25dO2w9ay5uYW1lO3E9VShrLnZhbHVlKTtrPXlhKGwpO2lmKHA9ZmIudGVzdChrKSlsPWwucmVwbGFjZShSYyxcIlwiKS5zdWJzdHIoOCkucmVwbGFjZSgvXyguKS9nLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGIudG9VcHBlckNhc2UoKX0pO3ZhciB1PWsucmVwbGFjZSgvKFN0YXJ0fEVuZCkkLyxcIlwiKTtBKHUpJiZrPT09dStcIlN0YXJ0XCImJihPPWwsTD1sLnN1YnN0cigwLGwubGVuZ3RoLTUpK1wiZW5kXCIsbD1sLnN1YnN0cigwLGwubGVuZ3RoLTYpKTtrPXlhKGwudG9Mb3dlckNhc2UoKSk7XG5oW2tdPWw7aWYocHx8IWMuaGFzT3duUHJvcGVydHkoaykpY1trXT1xLExjKGEsaykmJihjW2tdPSEwKTtQYShhLGIscSxrLHApO2NhKGIsayxcIkFcIixkLGcsTyxMKX1hPWEuY2xhc3NOYW1lO2lmKEYoYSkmJlwiXCIhPT1hKWZvcig7bD1mLmV4ZWMoYSk7KWs9eWEobFsyXSksY2EoYixrLFwiQ1wiLGQsZykmJihjW2tdPVUobFszXSkpLGE9YS5zdWJzdHIobC5pbmRleCtsWzBdLmxlbmd0aCk7YnJlYWs7Y2FzZSBwYjpNKGIsYS5ub2RlVmFsdWUpO2JyZWFrO2Nhc2UgODp0cnl7aWYobD1lLmV4ZWMoYS5ub2RlVmFsdWUpKWs9eWEobFsxXSksY2EoYixrLFwiTVwiLGQsZykmJihjW2tdPVUobFsyXSkpfWNhdGNoKHYpe319Yi5zb3J0KE4pO3JldHVybiBifWZ1bmN0aW9uIHdhKGEsYixjKXt2YXIgZD1bXSxlPTA7aWYoYiYmYS5oYXNBdHRyaWJ1dGUmJmEuaGFzQXR0cmlidXRlKGIpKXtkb3tpZighYSl0aHJvdyBqYShcInV0ZXJkaXJcIixiLGMpO2Eubm9kZVR5cGU9PW9hJiYoYS5oYXNBdHRyaWJ1dGUoYikmJlxuZSsrLGEuaGFzQXR0cmlidXRlKGMpJiZlLS0pO2QucHVzaChhKTthPWEubmV4dFNpYmxpbmd9d2hpbGUoMDxlKX1lbHNlIGQucHVzaChhKTtyZXR1cm4gQihkKX1mdW5jdGlvbiBKKGEsYixjKXtyZXR1cm4gZnVuY3Rpb24oZCxlLGYsZyxoKXtlPXdhKGVbMF0sYixjKTtyZXR1cm4gYShkLGUsZixnLGgpfX1mdW5jdGlvbiBlYShhLGQsZSxmLGcsbCxrLHAscil7ZnVuY3Rpb24gdyhhLGIsYyxkKXtpZihhKXtjJiYoYT1KKGEsYyxkKSk7YS5yZXF1aXJlPUsucmVxdWlyZTthLmRpcmVjdGl2ZU5hbWU9ejtpZihTPT09S3x8Sy4kJGlzb2xhdGVTY29wZSlhPVooYSx7aXNvbGF0ZVNjb3BlOiEwfSk7ay5wdXNoKGEpfWlmKGIpe2MmJihiPUooYixjLGQpKTtiLnJlcXVpcmU9Sy5yZXF1aXJlO2IuZGlyZWN0aXZlTmFtZT16O2lmKFM9PT1LfHxLLiQkaXNvbGF0ZVNjb3BlKWI9WihiLHtpc29sYXRlU2NvcGU6ITB9KTtwLnB1c2goYil9fWZ1bmN0aW9uIEwoYSxiLGMsZCl7dmFyIGUsZj1cImRhdGFcIixcbmc9ITEsbD1jLGs7aWYoRihiKSl7az1iLm1hdGNoKGgpO2I9Yi5zdWJzdHJpbmcoa1swXS5sZW5ndGgpO2tbM10mJihrWzFdP2tbM109bnVsbDprWzFdPWtbM10pO1wiXlwiPT09a1sxXT9mPVwiaW5oZXJpdGVkRGF0YVwiOlwiXl5cIj09PWtbMV0mJihmPVwiaW5oZXJpdGVkRGF0YVwiLGw9Yy5wYXJlbnQoKSk7XCI/XCI9PT1rWzJdJiYoZz0hMCk7ZT1udWxsO2QmJlwiZGF0YVwiPT09ZiYmKGU9ZFtiXSkmJihlPWUuaW5zdGFuY2UpO2U9ZXx8bFtmXShcIiRcIitiK1wiQ29udHJvbGxlclwiKTtpZighZSYmIWcpdGhyb3cgamEoXCJjdHJlcVwiLGIsYSk7cmV0dXJuIGV8fG51bGx9RChiKSYmKGU9W10scyhiLGZ1bmN0aW9uKGIpe2UucHVzaChMKGEsYixjLGQpKX0pKTtyZXR1cm4gZX1mdW5jdGlvbiB2KGEsYyxmLGcsaCl7ZnVuY3Rpb24gbChhLGIsYyl7dmFyIGQ7VmEoYSl8fChjPWIsYj1hLGE9dCk7SCYmKGQ9UCk7Y3x8KGM9SD9XLnBhcmVudCgpOlcpO3JldHVybiBoKGEsYixkLGMsd2EpfXZhciByLHcsdSx4LFxuUCxlYixXLEo7ZD09PWY/KEo9ZSxXPWUuJCRlbGVtZW50KTooVz1CKGYpLEo9bmV3IFhiKFcsZSkpO1MmJih4PWMuJG5ldyghMCkpO2gmJihlYj1sLGViLiQkYm91bmRUcmFuc2NsdWRlPWgpO0MmJihYPXt9LFA9e30scyhDLGZ1bmN0aW9uKGEpe3ZhciBiPXskc2NvcGU6YT09PVN8fGEuJCRpc29sYXRlU2NvcGU/eDpjLCRlbGVtZW50OlcsJGF0dHJzOkosJHRyYW5zY2x1ZGU6ZWJ9O3U9YS5jb250cm9sbGVyO1wiQFwiPT11JiYodT1KW2EubmFtZV0pO2I9bih1LGIsITAsYS5jb250cm9sbGVyQXMpO1BbYS5uYW1lXT1iO0h8fFcuZGF0YShcIiRcIithLm5hbWUrXCJDb250cm9sbGVyXCIsYi5pbnN0YW5jZSk7WFthLm5hbWVdPWJ9KSk7aWYoUyl7RS4kJGFkZFNjb3BlSW5mbyhXLHgsITAsIShrYSYmKGthPT09U3x8a2E9PT1TLiQkb3JpZ2luYWxEaXJlY3RpdmUpKSk7RS4kJGFkZFNjb3BlQ2xhc3MoVywhMCk7Zz1YJiZYW1MubmFtZV07dmFyIHhhPXg7ZyYmZy5pZGVudGlmaWVyJiYhMD09PVMuYmluZFRvQ29udHJvbGxlciYmXG4oeGE9Zy5pbnN0YW5jZSk7cyh4LiQkaXNvbGF0ZUJpbmRpbmdzPVMuJCRpc29sYXRlQmluZGluZ3MsZnVuY3Rpb24oYSxkKXt2YXIgZT1hLmF0dHJOYW1lLGY9YS5vcHRpb25hbCxnLGgsbCxrO3N3aXRjaChhLm1vZGUpe2Nhc2UgXCJAXCI6Si4kb2JzZXJ2ZShlLGZ1bmN0aW9uKGEpe3hhW2RdPWF9KTtKLiQkb2JzZXJ2ZXJzW2VdLiQkc2NvcGU9YztKW2VdJiYoeGFbZF09YihKW2VdKShjKSk7YnJlYWs7Y2FzZSBcIj1cIjppZihmJiYhSltlXSlicmVhaztoPU8oSltlXSk7az1oLmxpdGVyYWw/ZmE6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT09PWJ8fGEhPT1hJiZiIT09Yn07bD1oLmFzc2lnbnx8ZnVuY3Rpb24oKXtnPXhhW2RdPWgoYyk7dGhyb3cgamEoXCJub25hc3NpZ25cIixKW2VdLFMubmFtZSk7fTtnPXhhW2RdPWgoYyk7Zj1mdW5jdGlvbihhKXtrKGEseGFbZF0pfHwoayhhLGcpP2woYyxhPXhhW2RdKTp4YVtkXT1hKTtyZXR1cm4gZz1hfTtmLiRzdGF0ZWZ1bD0hMDtmPWEuY29sbGVjdGlvbj9cbmMuJHdhdGNoQ29sbGVjdGlvbihKW2VdLGYpOmMuJHdhdGNoKE8oSltlXSxmKSxudWxsLGgubGl0ZXJhbCk7eC4kb24oXCIkZGVzdHJveVwiLGYpO2JyZWFrO2Nhc2UgXCImXCI6aD1PKEpbZV0pLHhhW2RdPWZ1bmN0aW9uKGEpe3JldHVybiBoKGMsYSl9fX0pfVgmJihzKFgsZnVuY3Rpb24oYSl7YSgpfSksWD1udWxsKTtnPTA7Zm9yKHI9ay5sZW5ndGg7ZzxyO2crKyl3PWtbZ10sJCh3LHcuaXNvbGF0ZVNjb3BlP3g6YyxXLEosdy5yZXF1aXJlJiZMKHcuZGlyZWN0aXZlTmFtZSx3LnJlcXVpcmUsVyxQKSxlYik7dmFyIHdhPWM7UyYmKFMudGVtcGxhdGV8fG51bGw9PT1TLnRlbXBsYXRlVXJsKSYmKHdhPXgpO2EmJmEod2EsZi5jaGlsZE5vZGVzLHQsaCk7Zm9yKGc9cC5sZW5ndGgtMTswPD1nO2ctLSl3PXBbZ10sJCh3LHcuaXNvbGF0ZVNjb3BlP3g6YyxXLEosdy5yZXF1aXJlJiZMKHcuZGlyZWN0aXZlTmFtZSx3LnJlcXVpcmUsVyxQKSxlYil9cj1yfHx7fTtmb3IodmFyIHg9LU51bWJlci5NQVhfVkFMVUUsXG5QLEM9ci5jb250cm9sbGVyRGlyZWN0aXZlcyxYLFM9ci5uZXdJc29sYXRlU2NvcGVEaXJlY3RpdmUsa2E9ci50ZW1wbGF0ZURpcmVjdGl2ZSxlYT1yLm5vblRsYlRyYW5zY2x1ZGVEaXJlY3RpdmUsY2E9ITEsQT0hMSxIPXIuaGFzRWxlbWVudFRyYW5zY2x1ZGVEaXJlY3RpdmUsYWE9ZS4kJGVsZW1lbnQ9QihkKSxLLHosTixBYT1mLFEsTT0wLFI9YS5sZW5ndGg7TTxSO00rKyl7Sz1hW01dO3ZhciBQYT1LLiQkc3RhcnQsZmI9Sy4kJGVuZDtQYSYmKGFhPXdhKGQsUGEsZmIpKTtOPXQ7aWYoeD5LLnByaW9yaXR5KWJyZWFrO2lmKE49Sy5zY29wZSlLLnRlbXBsYXRlVXJsfHwoSShOKT8oT2EoXCJuZXcvaXNvbGF0ZWQgc2NvcGVcIixTfHxQLEssYWEpLFM9Syk6T2EoXCJuZXcvaXNvbGF0ZWQgc2NvcGVcIixTLEssYWEpKSxQPVB8fEs7ej1LLm5hbWU7IUsudGVtcGxhdGVVcmwmJksuY29udHJvbGxlciYmKE49Sy5jb250cm9sbGVyLEM9Q3x8e30sT2EoXCInXCIreitcIicgY29udHJvbGxlclwiLENbel0sXG5LLGFhKSxDW3pdPUspO2lmKE49Sy50cmFuc2NsdWRlKWNhPSEwLEsuJCR0bGJ8fChPYShcInRyYW5zY2x1c2lvblwiLGVhLEssYWEpLGVhPUspLFwiZWxlbWVudFwiPT1OPyhIPSEwLHg9Sy5wcmlvcml0eSxOPWFhLGFhPWUuJCRlbGVtZW50PUIoWS5jcmVhdGVDb21tZW50KFwiIFwiK3orXCI6IFwiK2Vbel0rXCIgXCIpKSxkPWFhWzBdLFYoZyxaYS5jYWxsKE4sMCksZCksQWE9RShOLGYseCxsJiZsLm5hbWUse25vblRsYlRyYW5zY2x1ZGVEaXJlY3RpdmU6ZWF9KSk6KE49QihUYihkKSkuY29udGVudHMoKSxhYS5lbXB0eSgpLEFhPUUoTixmKSk7aWYoSy50ZW1wbGF0ZSlpZihBPSEwLE9hKFwidGVtcGxhdGVcIixrYSxLLGFhKSxrYT1LLE49RyhLLnRlbXBsYXRlKT9LLnRlbXBsYXRlKGFhLGUpOksudGVtcGxhdGUsTj1TYyhOKSxLLnJlcGxhY2Upe2w9SztOPVJiLnRlc3QoTik/VGMoV2IoSy50ZW1wbGF0ZU5hbWVzcGFjZSxVKE4pKSk6W107ZD1OWzBdO2lmKDEhPU4ubGVuZ3RofHxkLm5vZGVUeXBlIT09XG5vYSl0aHJvdyBqYShcInRwbHJ0XCIseixcIlwiKTtWKGcsYWEsZCk7Uj17JGF0dHI6e319O049VyhkLFtdLFIpO3ZhciBiYT1hLnNwbGljZShNKzEsYS5sZW5ndGgtKE0rMSkpO1MmJnkoTik7YT1hLmNvbmNhdChOKS5jb25jYXQoYmEpO1FjKGUsUik7Uj1hLmxlbmd0aH1lbHNlIGFhLmh0bWwoTik7aWYoSy50ZW1wbGF0ZVVybClBPSEwLE9hKFwidGVtcGxhdGVcIixrYSxLLGFhKSxrYT1LLEsucmVwbGFjZSYmKGw9Syksdj1UKGEuc3BsaWNlKE0sYS5sZW5ndGgtTSksYWEsZSxnLGNhJiZBYSxrLHAse2NvbnRyb2xsZXJEaXJlY3RpdmVzOkMsbmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlOlMsdGVtcGxhdGVEaXJlY3RpdmU6a2Esbm9uVGxiVHJhbnNjbHVkZURpcmVjdGl2ZTplYX0pLFI9YS5sZW5ndGg7ZWxzZSBpZihLLmNvbXBpbGUpdHJ5e1E9Sy5jb21waWxlKGFhLGUsQWEpLEcoUSk/dyhudWxsLFEsUGEsZmIpOlEmJncoUS5wcmUsUS5wb3N0LFBhLGZiKX1jYXRjaChxZil7YyhxZix2YShhYSkpfUsudGVybWluYWwmJlxuKHYudGVybWluYWw9ITAseD1NYXRoLm1heCh4LEsucHJpb3JpdHkpKX12LnNjb3BlPVAmJiEwPT09UC5zY29wZTt2LnRyYW5zY2x1ZGVPblRoaXNFbGVtZW50PWNhO3YuZWxlbWVudFRyYW5zY2x1ZGVPblRoaXNFbGVtZW50PUg7di50ZW1wbGF0ZU9uVGhpc0VsZW1lbnQ9QTt2LnRyYW5zY2x1ZGU9QWE7ci5oYXNFbGVtZW50VHJhbnNjbHVkZURpcmVjdGl2ZT1IO3JldHVybiB2fWZ1bmN0aW9uIHkoYSl7Zm9yKHZhciBiPTAsYz1hLmxlbmd0aDtiPGM7YisrKXt2YXIgZD1iLGU7ZT16KE9iamVjdC5jcmVhdGUoYVtiXSkseyQkaXNvbGF0ZVNjb3BlOiEwfSk7YVtkXT1lfX1mdW5jdGlvbiBjYShiLGUsZixnLGgsbCxrKXtpZihlPT09aClyZXR1cm4gbnVsbDtoPW51bGw7aWYoZC5oYXNPd25Qcm9wZXJ0eShlKSl7dmFyIHE7ZT1hLmdldChlK1wiRGlyZWN0aXZlXCIpO2Zvcih2YXIgcj0wLG49ZS5sZW5ndGg7cjxuO3IrKyl0cnl7aWYocT1lW3JdLChnPT09dHx8Zz5xLnByaW9yaXR5KSYmLTEhPVxucS5yZXN0cmljdC5pbmRleE9mKGYpKXtpZihsKXt2YXIgdz17JCRzdGFydDpsLCQkZW5kOmt9O3E9eihPYmplY3QuY3JlYXRlKHEpLHcpfWIucHVzaChxKTtoPXF9fWNhdGNoKE8pe2MoTyl9fXJldHVybiBofWZ1bmN0aW9uIEEoYil7aWYoZC5oYXNPd25Qcm9wZXJ0eShiKSlmb3IodmFyIGM9YS5nZXQoYitcIkRpcmVjdGl2ZVwiKSxlPTAsZj1jLmxlbmd0aDtlPGY7ZSsrKWlmKGI9Y1tlXSxiLm11bHRpRWxlbWVudClyZXR1cm4hMDtyZXR1cm4hMX1mdW5jdGlvbiBRYyhhLGIpe3ZhciBjPWIuJGF0dHIsZD1hLiRhdHRyLGU9YS4kJGVsZW1lbnQ7cyhhLGZ1bmN0aW9uKGQsZSl7XCIkXCIhPWUuY2hhckF0KDApJiYoYltlXSYmYltlXSE9PWQmJihkKz0oXCJzdHlsZVwiPT09ZT9cIjtcIjpcIiBcIikrYltlXSksYS4kc2V0KGUsZCwhMCxjW2VdKSl9KTtzKGIsZnVuY3Rpb24oYixmKXtcImNsYXNzXCI9PWY/KFAoZSxiKSxhW1wiY2xhc3NcIl09KGFbXCJjbGFzc1wiXT9hW1wiY2xhc3NcIl0rXCIgXCI6XCJcIikrYik6XCJzdHlsZVwiPT1cbmY/KGUuYXR0cihcInN0eWxlXCIsZS5hdHRyKFwic3R5bGVcIikrXCI7XCIrYiksYS5zdHlsZT0oYS5zdHlsZT9hLnN0eWxlK1wiO1wiOlwiXCIpK2IpOlwiJFwiPT1mLmNoYXJBdCgwKXx8YS5oYXNPd25Qcm9wZXJ0eShmKXx8KGFbZl09YixkW2ZdPWNbZl0pfSl9ZnVuY3Rpb24gVChhLGIsYyxkLGUsZixnLGgpe3ZhciBsPVtdLGsscSxwPWJbMF0sbj1hLnNoaWZ0KCksdz16KHt9LG4se3RlbXBsYXRlVXJsOm51bGwsdHJhbnNjbHVkZTpudWxsLHJlcGxhY2U6bnVsbCwkJG9yaWdpbmFsRGlyZWN0aXZlOm59KSxPPUcobi50ZW1wbGF0ZVVybCk/bi50ZW1wbGF0ZVVybChiLGMpOm4udGVtcGxhdGVVcmwsdT1uLnRlbXBsYXRlTmFtZXNwYWNlO2IuZW1wdHkoKTtyKEwuZ2V0VHJ1c3RlZFJlc291cmNlVXJsKE8pKS50aGVuKGZ1bmN0aW9uKHIpe3ZhciBMLHY7cj1TYyhyKTtpZihuLnJlcGxhY2Upe3I9UmIudGVzdChyKT9UYyhXYih1LFUocikpKTpbXTtMPXJbMF07aWYoMSE9ci5sZW5ndGh8fEwubm9kZVR5cGUhPT1cbm9hKXRocm93IGphKFwidHBscnRcIixuLm5hbWUsTyk7cj17JGF0dHI6e319O1YoZCxiLEwpO3ZhciB4PVcoTCxbXSxyKTtJKG4uc2NvcGUpJiZ5KHgpO2E9eC5jb25jYXQoYSk7UWMoYyxyKX1lbHNlIEw9cCxiLmh0bWwocik7YS51bnNoaWZ0KHcpO2s9ZWEoYSxMLGMsZSxiLG4sZixnLGgpO3MoZCxmdW5jdGlvbihhLGMpe2E9PUwmJihkW2NdPWJbMF0pfSk7Zm9yKHE9UyhiWzBdLmNoaWxkTm9kZXMsZSk7bC5sZW5ndGg7KXtyPWwuc2hpZnQoKTt2PWwuc2hpZnQoKTt2YXIgQz1sLnNoaWZ0KCksRT1sLnNoaWZ0KCkseD1iWzBdO2lmKCFyLiQkZGVzdHJveWVkKXtpZih2IT09cCl7dmFyIEo9di5jbGFzc05hbWU7aC5oYXNFbGVtZW50VHJhbnNjbHVkZURpcmVjdGl2ZSYmbi5yZXBsYWNlfHwoeD1UYihMKSk7VihDLEIodikseCk7UChCKHgpLEopfXY9ay50cmFuc2NsdWRlT25UaGlzRWxlbWVudD9YKHIsay50cmFuc2NsdWRlLEUpOkU7ayhxLHIseCxkLHYpfX1sPW51bGx9KTtyZXR1cm4gZnVuY3Rpb24oYSxcbmIsYyxkLGUpe2E9ZTtiLiQkZGVzdHJveWVkfHwobD9sLnB1c2goYixjLGQsYSk6KGsudHJhbnNjbHVkZU9uVGhpc0VsZW1lbnQmJihhPVgoYixrLnRyYW5zY2x1ZGUsZSkpLGsocSxiLGMsZCxhKSkpfX1mdW5jdGlvbiBOKGEsYil7dmFyIGM9Yi5wcmlvcml0eS1hLnByaW9yaXR5O3JldHVybiAwIT09Yz9jOmEubmFtZSE9PWIubmFtZT9hLm5hbWU8Yi5uYW1lPy0xOjE6YS5pbmRleC1iLmluZGV4fWZ1bmN0aW9uIE9hKGEsYixjLGQpe2lmKGIpdGhyb3cgamEoXCJtdWx0aWRpclwiLGIubmFtZSxjLm5hbWUsYSx2YShkKSk7fWZ1bmN0aW9uIE0oYSxjKXt2YXIgZD1iKGMsITApO2QmJmEucHVzaCh7cHJpb3JpdHk6MCxjb21waWxlOmZ1bmN0aW9uKGEpe2E9YS5wYXJlbnQoKTt2YXIgYj0hIWEubGVuZ3RoO2ImJkUuJCRhZGRCaW5kaW5nQ2xhc3MoYSk7cmV0dXJuIGZ1bmN0aW9uKGEsYyl7dmFyIGU9Yy5wYXJlbnQoKTtifHxFLiQkYWRkQmluZGluZ0NsYXNzKGUpO0UuJCRhZGRCaW5kaW5nSW5mbyhlLFxuZC5leHByZXNzaW9ucyk7YS4kd2F0Y2goZCxmdW5jdGlvbihhKXtjWzBdLm5vZGVWYWx1ZT1hfSl9fX0pfWZ1bmN0aW9uIFdiKGEsYil7YT1RKGF8fFwiaHRtbFwiKTtzd2l0Y2goYSl7Y2FzZSBcInN2Z1wiOmNhc2UgXCJtYXRoXCI6dmFyIGM9WS5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO2MuaW5uZXJIVE1MPVwiPFwiK2ErXCI+XCIrYitcIjwvXCIrYStcIj5cIjtyZXR1cm4gYy5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXM7ZGVmYXVsdDpyZXR1cm4gYn19ZnVuY3Rpb24gUihhLGIpe2lmKFwic3JjZG9jXCI9PWIpcmV0dXJuIEwuSFRNTDt2YXIgYz11YShhKTtpZihcInhsaW5rSHJlZlwiPT1ifHxcImZvcm1cIj09YyYmXCJhY3Rpb25cIj09Ynx8XCJpbWdcIiE9YyYmKFwic3JjXCI9PWJ8fFwibmdTcmNcIj09YikpcmV0dXJuIEwuUkVTT1VSQ0VfVVJMfWZ1bmN0aW9uIFBhKGEsYyxkLGUsZil7dmFyIGg9UihhLGUpO2Y9Z1tlXXx8Zjt2YXIgaz1iKGQsITAsaCxmKTtpZihrKXtpZihcIm11bHRpcGxlXCI9PT1lJiZcInNlbGVjdFwiPT09dWEoYSkpdGhyb3cgamEoXCJzZWxtdWx0aVwiLFxudmEoYSkpO2MucHVzaCh7cHJpb3JpdHk6MTAwLGNvbXBpbGU6ZnVuY3Rpb24oKXtyZXR1cm57cHJlOmZ1bmN0aW9uKGEsYyxnKXtjPWcuJCRvYnNlcnZlcnN8fChnLiQkb2JzZXJ2ZXJzPXt9KTtpZihsLnRlc3QoZSkpdGhyb3cgamEoXCJub2RvbWV2ZW50c1wiKTt2YXIgcD1nW2VdO3AhPT1kJiYoaz1wJiZiKHAsITAsaCxmKSxkPXApO2smJihnW2VdPWsoYSksKGNbZV18fChjW2VdPVtdKSkuJCRpbnRlcj0hMCwoZy4kJG9ic2VydmVycyYmZy4kJG9ic2VydmVyc1tlXS4kJHNjb3BlfHxhKS4kd2F0Y2goayxmdW5jdGlvbihhLGIpe1wiY2xhc3NcIj09PWUmJmEhPWI/Zy4kdXBkYXRlQ2xhc3MoYSxiKTpnLiRzZXQoZSxhKX0pKX19fX0pfX1mdW5jdGlvbiBWKGEsYixjKXt2YXIgZD1iWzBdLGU9Yi5sZW5ndGgsZj1kLnBhcmVudE5vZGUsZyxoO2lmKGEpZm9yKGc9MCxoPWEubGVuZ3RoO2c8aDtnKyspaWYoYVtnXT09ZCl7YVtnKytdPWM7aD1nK2UtMTtmb3IodmFyIGw9YS5sZW5ndGg7ZzxsO2crKyxcbmgrKyloPGw/YVtnXT1hW2hdOmRlbGV0ZSBhW2ddO2EubGVuZ3RoLT1lLTE7YS5jb250ZXh0PT09ZCYmKGEuY29udGV4dD1jKTticmVha31mJiZmLnJlcGxhY2VDaGlsZChjLGQpO2E9WS5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7YS5hcHBlbmRDaGlsZChkKTtCKGMpLmRhdGEoQihkKS5kYXRhKCkpO3NhPyhQYj0hMCxzYS5jbGVhbkRhdGEoW2RdKSk6ZGVsZXRlIEIuY2FjaGVbZFtCLmV4cGFuZG9dXTtkPTE7Zm9yKGU9Yi5sZW5ndGg7ZDxlO2QrKylmPWJbZF0sQihmKS5yZW1vdmUoKSxhLmFwcGVuZENoaWxkKGYpLGRlbGV0ZSBiW2RdO2JbMF09YztiLmxlbmd0aD0xfWZ1bmN0aW9uIFooYSxiKXtyZXR1cm4geihmdW5jdGlvbigpe3JldHVybiBhLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sYSxiKX1mdW5jdGlvbiAkKGEsYixkLGUsZixnKXt0cnl7YShiLGQsZSxmLGcpfWNhdGNoKGgpe2MoaCx2YShkKSl9fXZhciBYYj1mdW5jdGlvbihhLGIpe2lmKGIpe3ZhciBjPU9iamVjdC5rZXlzKGIpLFxuZCxlLGY7ZD0wO2ZvcihlPWMubGVuZ3RoO2Q8ZTtkKyspZj1jW2RdLHRoaXNbZl09YltmXX1lbHNlIHRoaXMuJGF0dHI9e307dGhpcy4kJGVsZW1lbnQ9YX07WGIucHJvdG90eXBlPXskbm9ybWFsaXplOnlhLCRhZGRDbGFzczpmdW5jdGlvbihhKXthJiYwPGEubGVuZ3RoJiZDLmFkZENsYXNzKHRoaXMuJCRlbGVtZW50LGEpfSwkcmVtb3ZlQ2xhc3M6ZnVuY3Rpb24oYSl7YSYmMDxhLmxlbmd0aCYmQy5yZW1vdmVDbGFzcyh0aGlzLiQkZWxlbWVudCxhKX0sJHVwZGF0ZUNsYXNzOmZ1bmN0aW9uKGEsYil7dmFyIGM9VWMoYSxiKTtjJiZjLmxlbmd0aCYmQy5hZGRDbGFzcyh0aGlzLiQkZWxlbWVudCxjKTsoYz1VYyhiLGEpKSYmYy5sZW5ndGgmJkMucmVtb3ZlQ2xhc3ModGhpcy4kJGVsZW1lbnQsYyl9LCRzZXQ6ZnVuY3Rpb24oYSxiLGQsZSl7dmFyIGY9dGhpcy4kJGVsZW1lbnRbMF0sZz1MYyhmLGEpLGg9a2YoZixhKSxmPWE7Zz8odGhpcy4kJGVsZW1lbnQucHJvcChhLGIpLGU9Zyk6XG5oJiYodGhpc1toXT1iLGY9aCk7dGhpc1thXT1iO2U/dGhpcy4kYXR0clthXT1lOihlPXRoaXMuJGF0dHJbYV0pfHwodGhpcy4kYXR0clthXT1lPXRjKGEsXCItXCIpKTtnPXVhKHRoaXMuJCRlbGVtZW50KTtpZihcImFcIj09PWcmJlwiaHJlZlwiPT09YXx8XCJpbWdcIj09PWcmJlwic3JjXCI9PT1hKXRoaXNbYV09Yj14KGIsXCJzcmNcIj09PWEpO2Vsc2UgaWYoXCJpbWdcIj09PWcmJlwic3Jjc2V0XCI9PT1hKXtmb3IodmFyIGc9XCJcIixoPVUoYiksbD0vKFxccytcXGQreFxccyosfFxccytcXGQrd1xccyosfFxccyssfCxcXHMrKS8sbD0vXFxzLy50ZXN0KGgpP2w6LygsKS8saD1oLnNwbGl0KGwpLGw9TWF0aC5mbG9vcihoLmxlbmd0aC8yKSxrPTA7azxsO2srKyl2YXIgcT0yKmssZz1nK3goVShoW3FdKSwhMCksZz1nKyhcIiBcIitVKGhbcSsxXSkpO2g9VShoWzIqa10pLnNwbGl0KC9cXHMvKTtnKz14KFUoaFswXSksITApOzI9PT1oLmxlbmd0aCYmKGcrPVwiIFwiK1UoaFsxXSkpO3RoaXNbYV09Yj1nfSExIT09ZCYmKG51bGw9PT1ifHxcbmI9PT10P3RoaXMuJCRlbGVtZW50LnJlbW92ZUF0dHIoZSk6dGhpcy4kJGVsZW1lbnQuYXR0cihlLGIpKTsoYT10aGlzLiQkb2JzZXJ2ZXJzKSYmcyhhW2ZdLGZ1bmN0aW9uKGEpe3RyeXthKGIpfWNhdGNoKGQpe2MoZCl9fSl9LCRvYnNlcnZlOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxkPWMuJCRvYnNlcnZlcnN8fChjLiQkb2JzZXJ2ZXJzPWhhKCkpLGU9ZFthXXx8KGRbYV09W10pO2UucHVzaChiKTt2LiRldmFsQXN5bmMoZnVuY3Rpb24oKXshZS4kJGludGVyJiZjLmhhc093blByb3BlcnR5KGEpJiZiKGNbYV0pfSk7cmV0dXJuIGZ1bmN0aW9uKCl7WGEoZSxiKX19fTt2YXIgQWE9Yi5zdGFydFN5bWJvbCgpLGthPWIuZW5kU3ltYm9sKCksU2M9XCJ7e1wiPT1BYXx8XCJ9fVwiPT1rYT9wYTpmdW5jdGlvbihhKXtyZXR1cm4gYS5yZXBsYWNlKC9cXHtcXHsvZyxBYSkucmVwbGFjZSgvfX0vZyxrYSl9LGZiPS9ebmdBdHRyW0EtWl0vO0UuJCRhZGRCaW5kaW5nSW5mbz1rP2Z1bmN0aW9uKGEsYil7dmFyIGM9XG5hLmRhdGEoXCIkYmluZGluZ1wiKXx8W107RChiKT9jPWMuY29uY2F0KGIpOmMucHVzaChiKTthLmRhdGEoXCIkYmluZGluZ1wiLGMpfTpIO0UuJCRhZGRCaW5kaW5nQ2xhc3M9az9mdW5jdGlvbihhKXtQKGEsXCJuZy1iaW5kaW5nXCIpfTpIO0UuJCRhZGRTY29wZUluZm89az9mdW5jdGlvbihhLGIsYyxkKXthLmRhdGEoYz9kP1wiJGlzb2xhdGVTY29wZU5vVGVtcGxhdGVcIjpcIiRpc29sYXRlU2NvcGVcIjpcIiRzY29wZVwiLGIpfTpIO0UuJCRhZGRTY29wZUNsYXNzPWs/ZnVuY3Rpb24oYSxiKXtQKGEsYj9cIm5nLWlzb2xhdGUtc2NvcGVcIjpcIm5nLXNjb3BlXCIpfTpIO3JldHVybiBFfV19ZnVuY3Rpb24geWEoYil7cmV0dXJuIGNiKGIucmVwbGFjZShSYyxcIlwiKSl9ZnVuY3Rpb24gVWMoYixhKXt2YXIgYz1cIlwiLGQ9Yi5zcGxpdCgvXFxzKy8pLGU9YS5zcGxpdCgvXFxzKy8pLGY9MDthOmZvcig7ZjxkLmxlbmd0aDtmKyspe2Zvcih2YXIgZz1kW2ZdLGg9MDtoPGUubGVuZ3RoO2grKylpZihnPT1lW2hdKWNvbnRpbnVlIGE7XG5jKz0oMDxjLmxlbmd0aD9cIiBcIjpcIlwiKStnfXJldHVybiBjfWZ1bmN0aW9uIFRjKGIpe2I9QihiKTt2YXIgYT1iLmxlbmd0aDtpZigxPj1hKXJldHVybiBiO2Zvcig7YS0tOyk4PT09YlthXS5ub2RlVHlwZSYmcmYuY2FsbChiLGEsMSk7cmV0dXJuIGJ9ZnVuY3Rpb24gRmUoKXt2YXIgYj17fSxhPSExLGM9L14oXFxTKykoXFxzK2FzXFxzKyhcXHcrKSk/JC87dGhpcy5yZWdpc3Rlcj1mdW5jdGlvbihhLGMpe01hKGEsXCJjb250cm9sbGVyXCIpO0koYSk/eihiLGEpOmJbYV09Y307dGhpcy5hbGxvd0dsb2JhbHM9ZnVuY3Rpb24oKXthPSEwfTt0aGlzLiRnZXQ9W1wiJGluamVjdG9yXCIsXCIkd2luZG93XCIsZnVuY3Rpb24oZCxlKXtmdW5jdGlvbiBmKGEsYixjLGQpe2lmKCFhfHwhSShhLiRzY29wZSkpdGhyb3cgVChcIiRjb250cm9sbGVyXCIpKFwibm9zY3BcIixkLGIpO2EuJHNjb3BlW2JdPWN9cmV0dXJuIGZ1bmN0aW9uKGcsaCxsLGspe3ZhciBtLHAscTtsPSEwPT09bDtrJiZGKGspJiYocT1rKTtGKGcpJiZcbihrPWcubWF0Y2goYykscD1rWzFdLHE9cXx8a1szXSxnPWIuaGFzT3duUHJvcGVydHkocCk/YltwXTp2YyhoLiRzY29wZSxwLCEwKXx8KGE/dmMoZSxwLCEwKTp0KSxzYihnLHAsITApKTtpZihsKXJldHVybiBsPShEKGcpP2dbZy5sZW5ndGgtMV06ZykucHJvdG90eXBlLG09T2JqZWN0LmNyZWF0ZShsKSxxJiZmKGgscSxtLHB8fGcubmFtZSkseihmdW5jdGlvbigpe2QuaW52b2tlKGcsbSxoLHApO3JldHVybiBtfSx7aW5zdGFuY2U6bSxpZGVudGlmaWVyOnF9KTttPWQuaW5zdGFudGlhdGUoZyxoLHApO3EmJmYoaCxxLG0scHx8Zy5uYW1lKTtyZXR1cm4gbX19XX1mdW5jdGlvbiBHZSgpe3RoaXMuJGdldD1bXCIkd2luZG93XCIsZnVuY3Rpb24oYil7cmV0dXJuIEIoYi5kb2N1bWVudCl9XX1mdW5jdGlvbiBIZSgpe3RoaXMuJGdldD1bXCIkbG9nXCIsZnVuY3Rpb24oYil7cmV0dXJuIGZ1bmN0aW9uKGEsYyl7Yi5lcnJvci5hcHBseShiLGFyZ3VtZW50cyl9fV19ZnVuY3Rpb24gWWIoYixhKXtpZihGKGIpKXt2YXIgYz1cbmIucmVwbGFjZShzZixcIlwiKS50cmltKCk7aWYoYyl7dmFyIGQ9YShcIkNvbnRlbnQtVHlwZVwiKTsoZD1kJiYwPT09ZC5pbmRleE9mKFZjKSl8fChkPShkPWMubWF0Y2godGYpKSYmdWZbZFswXV0udGVzdChjKSk7ZCYmKGI9b2MoYykpfX1yZXR1cm4gYn1mdW5jdGlvbiBXYyhiKXt2YXIgYT1oYSgpLGMsZCxlO2lmKCFiKXJldHVybiBhO3MoYi5zcGxpdChcIlxcblwiKSxmdW5jdGlvbihiKXtlPWIuaW5kZXhPZihcIjpcIik7Yz1RKFUoYi5zdWJzdHIoMCxlKSkpO2Q9VShiLnN1YnN0cihlKzEpKTtjJiYoYVtjXT1hW2NdP2FbY10rXCIsIFwiK2Q6ZCl9KTtyZXR1cm4gYX1mdW5jdGlvbiBYYyhiKXt2YXIgYT1JKGIpP2I6dDtyZXR1cm4gZnVuY3Rpb24oYyl7YXx8KGE9V2MoYikpO3JldHVybiBjPyhjPWFbUShjKV0sdm9pZCAwPT09YyYmKGM9bnVsbCksYyk6YX19ZnVuY3Rpb24gWWMoYixhLGMsZCl7aWYoRyhkKSlyZXR1cm4gZChiLGEsYyk7cyhkLGZ1bmN0aW9uKGQpe2I9ZChiLGEsYyl9KTtyZXR1cm4gYn1cbmZ1bmN0aW9uIEtlKCl7dmFyIGI9dGhpcy5kZWZhdWx0cz17dHJhbnNmb3JtUmVzcG9uc2U6W1liXSx0cmFuc2Zvcm1SZXF1ZXN0OltmdW5jdGlvbihhKXtyZXR1cm4gSShhKSYmXCJbb2JqZWN0IEZpbGVdXCIhPT1EYS5jYWxsKGEpJiZcIltvYmplY3QgQmxvYl1cIiE9PURhLmNhbGwoYSkmJlwiW29iamVjdCBGb3JtRGF0YV1cIiE9PURhLmNhbGwoYSk/JGEoYSk6YX1dLGhlYWRlcnM6e2NvbW1vbjp7QWNjZXB0OlwiYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qXCJ9LHBvc3Q6cmEoWmIpLHB1dDpyYShaYikscGF0Y2g6cmEoWmIpfSx4c3JmQ29va2llTmFtZTpcIlhTUkYtVE9LRU5cIix4c3JmSGVhZGVyTmFtZTpcIlgtWFNSRi1UT0tFTlwifSxhPSExO3RoaXMudXNlQXBwbHlBc3luYz1mdW5jdGlvbihiKXtyZXR1cm4geShiKT8oYT0hIWIsdGhpcyk6YX07dmFyIGM9dGhpcy5pbnRlcmNlcHRvcnM9W107dGhpcy4kZ2V0PVtcIiRodHRwQmFja2VuZFwiLFwiJGJyb3dzZXJcIixcIiRjYWNoZUZhY3RvcnlcIixcblwiJHJvb3RTY29wZVwiLFwiJHFcIixcIiRpbmplY3RvclwiLGZ1bmN0aW9uKGQsZSxmLGcsaCxsKXtmdW5jdGlvbiBrKGEpe2Z1bmN0aW9uIGMoYSl7dmFyIGI9eih7fSxhKTtiLmRhdGE9YS5kYXRhP1ljKGEuZGF0YSxhLmhlYWRlcnMsYS5zdGF0dXMsZS50cmFuc2Zvcm1SZXNwb25zZSk6YS5kYXRhO2E9YS5zdGF0dXM7cmV0dXJuIDIwMDw9YSYmMzAwPmE/YjpoLnJlamVjdChiKX1mdW5jdGlvbiBkKGEpe3ZhciBiLGM9e307cyhhLGZ1bmN0aW9uKGEsZCl7RyhhKT8oYj1hKCksbnVsbCE9YiYmKGNbZF09YikpOmNbZF09YX0pO3JldHVybiBjfWlmKCFnYS5pc09iamVjdChhKSl0aHJvdyBUKFwiJGh0dHBcIikoXCJiYWRyZXFcIixhKTt2YXIgZT16KHttZXRob2Q6XCJnZXRcIix0cmFuc2Zvcm1SZXF1ZXN0OmIudHJhbnNmb3JtUmVxdWVzdCx0cmFuc2Zvcm1SZXNwb25zZTpiLnRyYW5zZm9ybVJlc3BvbnNlfSxhKTtlLmhlYWRlcnM9ZnVuY3Rpb24oYSl7dmFyIGM9Yi5oZWFkZXJzLGU9eih7fSxhLmhlYWRlcnMpLFxuZixnLGM9eih7fSxjLmNvbW1vbixjW1EoYS5tZXRob2QpXSk7YTpmb3IoZiBpbiBjKXthPVEoZik7Zm9yKGcgaW4gZSlpZihRKGcpPT09YSljb250aW51ZSBhO2VbZl09Y1tmXX1yZXR1cm4gZChlKX0oYSk7ZS5tZXRob2Q9dWIoZS5tZXRob2QpO3ZhciBmPVtmdW5jdGlvbihhKXt2YXIgZD1hLmhlYWRlcnMsZT1ZYyhhLmRhdGEsWGMoZCksdCxhLnRyYW5zZm9ybVJlcXVlc3QpO0EoZSkmJnMoZCxmdW5jdGlvbihhLGIpe1wiY29udGVudC10eXBlXCI9PT1RKGIpJiZkZWxldGUgZFtiXX0pO0EoYS53aXRoQ3JlZGVudGlhbHMpJiYhQShiLndpdGhDcmVkZW50aWFscykmJihhLndpdGhDcmVkZW50aWFscz1iLndpdGhDcmVkZW50aWFscyk7cmV0dXJuIG0oYSxlKS50aGVuKGMsYyl9LHRdLGc9aC53aGVuKGUpO2ZvcihzKHUsZnVuY3Rpb24oYSl7KGEucmVxdWVzdHx8YS5yZXF1ZXN0RXJyb3IpJiZmLnVuc2hpZnQoYS5yZXF1ZXN0LGEucmVxdWVzdEVycm9yKTsoYS5yZXNwb25zZXx8YS5yZXNwb25zZUVycm9yKSYmXG5mLnB1c2goYS5yZXNwb25zZSxhLnJlc3BvbnNlRXJyb3IpfSk7Zi5sZW5ndGg7KXthPWYuc2hpZnQoKTt2YXIgbD1mLnNoaWZ0KCksZz1nLnRoZW4oYSxsKX1nLnN1Y2Nlc3M9ZnVuY3Rpb24oYSl7Zy50aGVuKGZ1bmN0aW9uKGIpe2EoYi5kYXRhLGIuc3RhdHVzLGIuaGVhZGVycyxlKX0pO3JldHVybiBnfTtnLmVycm9yPWZ1bmN0aW9uKGEpe2cudGhlbihudWxsLGZ1bmN0aW9uKGIpe2EoYi5kYXRhLGIuc3RhdHVzLGIuaGVhZGVycyxlKX0pO3JldHVybiBnfTtyZXR1cm4gZ31mdW5jdGlvbiBtKGMsZil7ZnVuY3Rpb24gbChiLGMsZCxlKXtmdW5jdGlvbiBmKCl7bShjLGIsZCxlKX1QJiYoMjAwPD1iJiYzMDA+Yj9QLnB1dChYLFtiLGMsV2MoZCksZV0pOlAucmVtb3ZlKFgpKTthP2cuJGFwcGx5QXN5bmMoZik6KGYoKSxnLiQkcGhhc2V8fGcuJGFwcGx5KCkpfWZ1bmN0aW9uIG0oYSxiLGQsZSl7Yj1NYXRoLm1heChiLDApOygyMDA8PWImJjMwMD5iP0MucmVzb2x2ZTpDLnJlamVjdCkoe2RhdGE6YSxcbnN0YXR1czpiLGhlYWRlcnM6WGMoZCksY29uZmlnOmMsc3RhdHVzVGV4dDplfSl9ZnVuY3Rpb24gdyhhKXttKGEuZGF0YSxhLnN0YXR1cyxyYShhLmhlYWRlcnMoKSksYS5zdGF0dXNUZXh0KX1mdW5jdGlvbiB1KCl7dmFyIGE9ay5wZW5kaW5nUmVxdWVzdHMuaW5kZXhPZihjKTstMSE9PWEmJmsucGVuZGluZ1JlcXVlc3RzLnNwbGljZShhLDEpfXZhciBDPWguZGVmZXIoKSx4PUMucHJvbWlzZSxQLEUscz1jLmhlYWRlcnMsWD1wKGMudXJsLGMucGFyYW1zKTtrLnBlbmRpbmdSZXF1ZXN0cy5wdXNoKGMpO3gudGhlbih1LHUpOyFjLmNhY2hlJiYhYi5jYWNoZXx8ITE9PT1jLmNhY2hlfHxcIkdFVFwiIT09Yy5tZXRob2QmJlwiSlNPTlBcIiE9PWMubWV0aG9kfHwoUD1JKGMuY2FjaGUpP2MuY2FjaGU6SShiLmNhY2hlKT9iLmNhY2hlOnEpO1AmJihFPVAuZ2V0KFgpLHkoRSk/RSYmRyhFLnRoZW4pP0UudGhlbih3LHcpOkQoRSk/bShFWzFdLEVbMF0scmEoRVsyXSksRVszXSk6bShFLDIwMCx7fSxcblwiT0tcIik6UC5wdXQoWCx4KSk7QShFKSYmKChFPVpjKGMudXJsKT9lLmNvb2tpZXMoKVtjLnhzcmZDb29raWVOYW1lfHxiLnhzcmZDb29raWVOYW1lXTp0KSYmKHNbYy54c3JmSGVhZGVyTmFtZXx8Yi54c3JmSGVhZGVyTmFtZV09RSksZChjLm1ldGhvZCxYLGYsbCxzLGMudGltZW91dCxjLndpdGhDcmVkZW50aWFscyxjLnJlc3BvbnNlVHlwZSkpO3JldHVybiB4fWZ1bmN0aW9uIHAoYSxiKXtpZighYilyZXR1cm4gYTt2YXIgYz1bXTtFZChiLGZ1bmN0aW9uKGEsYil7bnVsbD09PWF8fEEoYSl8fChEKGEpfHwoYT1bYV0pLHMoYSxmdW5jdGlvbihhKXtJKGEpJiYoYT1xYShhKT9hLnRvSVNPU3RyaW5nKCk6JGEoYSkpO2MucHVzaChGYShiKStcIj1cIitGYShhKSl9KSl9KTswPGMubGVuZ3RoJiYoYSs9KC0xPT1hLmluZGV4T2YoXCI/XCIpP1wiP1wiOlwiJlwiKStjLmpvaW4oXCImXCIpKTtyZXR1cm4gYX12YXIgcT1mKFwiJGh0dHBcIiksdT1bXTtzKGMsZnVuY3Rpb24oYSl7dS51bnNoaWZ0KEYoYSk/bC5nZXQoYSk6XG5sLmludm9rZShhKSl9KTtrLnBlbmRpbmdSZXF1ZXN0cz1bXTsoZnVuY3Rpb24oYSl7cyhhcmd1bWVudHMsZnVuY3Rpb24oYSl7a1thXT1mdW5jdGlvbihiLGMpe3JldHVybiBrKHooY3x8e30se21ldGhvZDphLHVybDpifSkpfX0pfSkoXCJnZXRcIixcImRlbGV0ZVwiLFwiaGVhZFwiLFwianNvbnBcIik7KGZ1bmN0aW9uKGEpe3MoYXJndW1lbnRzLGZ1bmN0aW9uKGEpe2tbYV09ZnVuY3Rpb24oYixjLGQpe3JldHVybiBrKHooZHx8e30se21ldGhvZDphLHVybDpiLGRhdGE6Y30pKX19KX0pKFwicG9zdFwiLFwicHV0XCIsXCJwYXRjaFwiKTtrLmRlZmF1bHRzPWI7cmV0dXJuIGt9XX1mdW5jdGlvbiB2Zigpe3JldHVybiBuZXcgTS5YTUxIdHRwUmVxdWVzdH1mdW5jdGlvbiBMZSgpe3RoaXMuJGdldD1bXCIkYnJvd3NlclwiLFwiJHdpbmRvd1wiLFwiJGRvY3VtZW50XCIsZnVuY3Rpb24oYixhLGMpe3JldHVybiB3ZihiLHZmLGIuZGVmZXIsYS5hbmd1bGFyLmNhbGxiYWNrcyxjWzBdKX1dfWZ1bmN0aW9uIHdmKGIsYSxjLFxuZCxlKXtmdW5jdGlvbiBmKGEsYixjKXt2YXIgZj1lLmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIiksbT1udWxsO2YudHlwZT1cInRleHQvamF2YXNjcmlwdFwiO2Yuc3JjPWE7Zi5hc3luYz0hMDttPWZ1bmN0aW9uKGEpe2YucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImxvYWRcIixtLCExKTtmLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLG0sITEpO2UuYm9keS5yZW1vdmVDaGlsZChmKTtmPW51bGw7dmFyIGc9LTEsdT1cInVua25vd25cIjthJiYoXCJsb2FkXCIhPT1hLnR5cGV8fGRbYl0uY2FsbGVkfHwoYT17dHlwZTpcImVycm9yXCJ9KSx1PWEudHlwZSxnPVwiZXJyb3JcIj09PWEudHlwZT80MDQ6MjAwKTtjJiZjKGcsdSl9O2YuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIixtLCExKTtmLmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLG0sITEpO2UuYm9keS5hcHBlbmRDaGlsZChmKTtyZXR1cm4gbX1yZXR1cm4gZnVuY3Rpb24oZSxoLGwsayxtLHAscSx1KXtmdW5jdGlvbiByKCl7diYmdigpO3cmJncuYWJvcnQoKX1cbmZ1bmN0aW9uIE8oYSxkLGUsZixnKXtDIT09dCYmYy5jYW5jZWwoQyk7dj13PW51bGw7YShkLGUsZixnKTtiLiQkY29tcGxldGVPdXRzdGFuZGluZ1JlcXVlc3QoSCl9Yi4kJGluY091dHN0YW5kaW5nUmVxdWVzdENvdW50KCk7aD1ofHxiLnVybCgpO2lmKFwianNvbnBcIj09UShlKSl7dmFyIG49XCJfXCIrKGQuY291bnRlcisrKS50b1N0cmluZygzNik7ZFtuXT1mdW5jdGlvbihhKXtkW25dLmRhdGE9YTtkW25dLmNhbGxlZD0hMH07dmFyIHY9ZihoLnJlcGxhY2UoXCJKU09OX0NBTExCQUNLXCIsXCJhbmd1bGFyLmNhbGxiYWNrcy5cIituKSxuLGZ1bmN0aW9uKGEsYil7TyhrLGEsZFtuXS5kYXRhLFwiXCIsYik7ZFtuXT1IfSl9ZWxzZXt2YXIgdz1hKCk7dy5vcGVuKGUsaCwhMCk7cyhtLGZ1bmN0aW9uKGEsYil7eShhKSYmdy5zZXRSZXF1ZXN0SGVhZGVyKGIsYSl9KTt3Lm9ubG9hZD1mdW5jdGlvbigpe3ZhciBhPXcuc3RhdHVzVGV4dHx8XCJcIixiPVwicmVzcG9uc2VcImluIHc/dy5yZXNwb25zZTp3LnJlc3BvbnNlVGV4dCxcbmM9MTIyMz09PXcuc3RhdHVzPzIwNDp3LnN0YXR1czswPT09YyYmKGM9Yj8yMDA6XCJmaWxlXCI9PUJhKGgpLnByb3RvY29sPzQwNDowKTtPKGssYyxiLHcuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCksYSl9O2U9ZnVuY3Rpb24oKXtPKGssLTEsbnVsbCxudWxsLFwiXCIpfTt3Lm9uZXJyb3I9ZTt3Lm9uYWJvcnQ9ZTtxJiYody53aXRoQ3JlZGVudGlhbHM9ITApO2lmKHUpdHJ5e3cucmVzcG9uc2VUeXBlPXV9Y2F0Y2goTCl7aWYoXCJqc29uXCIhPT11KXRocm93IEw7fXcuc2VuZChsfHxudWxsKX1pZigwPHApdmFyIEM9YyhyLHApO2Vsc2UgcCYmRyhwLnRoZW4pJiZwLnRoZW4ocil9fWZ1bmN0aW9uIEllKCl7dmFyIGI9XCJ7e1wiLGE9XCJ9fVwiO3RoaXMuc3RhcnRTeW1ib2w9ZnVuY3Rpb24oYSl7cmV0dXJuIGE/KGI9YSx0aGlzKTpifTt0aGlzLmVuZFN5bWJvbD1mdW5jdGlvbihiKXtyZXR1cm4gYj8oYT1iLHRoaXMpOmF9O3RoaXMuJGdldD1bXCIkcGFyc2VcIixcIiRleGNlcHRpb25IYW5kbGVyXCIsXCIkc2NlXCIsXG5mdW5jdGlvbihjLGQsZSl7ZnVuY3Rpb24gZihhKXtyZXR1cm5cIlxcXFxcXFxcXFxcXFwiK2F9ZnVuY3Rpb24gZyhmLGcsdSxyKXtmdW5jdGlvbiBPKGMpe3JldHVybiBjLnJlcGxhY2UoayxiKS5yZXBsYWNlKG0sYSl9ZnVuY3Rpb24gbihhKXt0cnl7dmFyIGI9YTthPXU/ZS5nZXRUcnVzdGVkKHUsYik6ZS52YWx1ZU9mKGIpO3ZhciBjO2lmKHImJiF5KGEpKWM9YTtlbHNlIGlmKG51bGw9PWEpYz1cIlwiO2Vsc2V7c3dpdGNoKHR5cGVvZiBhKXtjYXNlIFwic3RyaW5nXCI6YnJlYWs7Y2FzZSBcIm51bWJlclwiOmE9XCJcIithO2JyZWFrO2RlZmF1bHQ6YT0kYShhKX1jPWF9cmV0dXJuIGN9Y2F0Y2goZyl7Yz0kYihcImludGVyclwiLGYsZy50b1N0cmluZygpKSxkKGMpfX1yPSEhcjtmb3IodmFyIHYsdyxMPTAsQz1bXSx4PVtdLFA9Zi5sZW5ndGgsRT1bXSxzPVtdO0w8UDspaWYoLTEhPSh2PWYuaW5kZXhPZihiLEwpKSYmLTEhPSh3PWYuaW5kZXhPZihhLHYraCkpKUwhPT12JiZFLnB1c2goTyhmLnN1YnN0cmluZyhMLFxudikpKSxMPWYuc3Vic3RyaW5nKHYraCx3KSxDLnB1c2goTCkseC5wdXNoKGMoTCxuKSksTD13K2wscy5wdXNoKEUubGVuZ3RoKSxFLnB1c2goXCJcIik7ZWxzZXtMIT09UCYmRS5wdXNoKE8oZi5zdWJzdHJpbmcoTCkpKTticmVha31pZih1JiYxPEUubGVuZ3RoKXRocm93ICRiKFwibm9jb25jYXRcIixmKTtpZighZ3x8Qy5sZW5ndGgpe3ZhciBYPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0wLGM9Qy5sZW5ndGg7YjxjO2IrKyl7aWYociYmQShhW2JdKSlyZXR1cm47RVtzW2JdXT1hW2JdfXJldHVybiBFLmpvaW4oXCJcIil9O3JldHVybiB6KGZ1bmN0aW9uKGEpe3ZhciBiPTAsYz1DLmxlbmd0aCxlPUFycmF5KGMpO3RyeXtmb3IoO2I8YztiKyspZVtiXT14W2JdKGEpO3JldHVybiBYKGUpfWNhdGNoKGcpe2E9JGIoXCJpbnRlcnJcIixmLGcudG9TdHJpbmcoKSksZChhKX19LHtleHA6ZixleHByZXNzaW9uczpDLCQkd2F0Y2hEZWxlZ2F0ZTpmdW5jdGlvbihhLGIsYyl7dmFyIGQ7cmV0dXJuIGEuJHdhdGNoR3JvdXAoeCxcbmZ1bmN0aW9uKGMsZSl7dmFyIGY9WChjKTtHKGIpJiZiLmNhbGwodGhpcyxmLGMhPT1lP2Q6ZixhKTtkPWZ9LGMpfX0pfX12YXIgaD1iLmxlbmd0aCxsPWEubGVuZ3RoLGs9bmV3IFJlZ0V4cChiLnJlcGxhY2UoLy4vZyxmKSxcImdcIiksbT1uZXcgUmVnRXhwKGEucmVwbGFjZSgvLi9nLGYpLFwiZ1wiKTtnLnN0YXJ0U3ltYm9sPWZ1bmN0aW9uKCl7cmV0dXJuIGJ9O2cuZW5kU3ltYm9sPWZ1bmN0aW9uKCl7cmV0dXJuIGF9O3JldHVybiBnfV19ZnVuY3Rpb24gSmUoKXt0aGlzLiRnZXQ9W1wiJHJvb3RTY29wZVwiLFwiJHdpbmRvd1wiLFwiJHFcIixcIiQkcVwiLGZ1bmN0aW9uKGIsYSxjLGQpe2Z1bmN0aW9uIGUoZSxoLGwsayl7dmFyIG09YS5zZXRJbnRlcnZhbCxwPWEuY2xlYXJJbnRlcnZhbCxxPTAsdT15KGspJiYhayxyPSh1P2Q6YykuZGVmZXIoKSxPPXIucHJvbWlzZTtsPXkobCk/bDowO08udGhlbihudWxsLG51bGwsZSk7Ty4kJGludGVydmFsSWQ9bShmdW5jdGlvbigpe3Iubm90aWZ5KHErKyk7MDxcbmwmJnE+PWwmJihyLnJlc29sdmUocSkscChPLiQkaW50ZXJ2YWxJZCksZGVsZXRlIGZbTy4kJGludGVydmFsSWRdKTt1fHxiLiRhcHBseSgpfSxoKTtmW08uJCRpbnRlcnZhbElkXT1yO3JldHVybiBPfXZhciBmPXt9O2UuY2FuY2VsPWZ1bmN0aW9uKGIpe3JldHVybiBiJiZiLiQkaW50ZXJ2YWxJZCBpbiBmPyhmW2IuJCRpbnRlcnZhbElkXS5yZWplY3QoXCJjYW5jZWxlZFwiKSxhLmNsZWFySW50ZXJ2YWwoYi4kJGludGVydmFsSWQpLGRlbGV0ZSBmW2IuJCRpbnRlcnZhbElkXSwhMCk6ITF9O3JldHVybiBlfV19ZnVuY3Rpb24gUmQoKXt0aGlzLiRnZXQ9ZnVuY3Rpb24oKXtyZXR1cm57aWQ6XCJlbi11c1wiLE5VTUJFUl9GT1JNQVRTOntERUNJTUFMX1NFUDpcIi5cIixHUk9VUF9TRVA6XCIsXCIsUEFUVEVSTlM6W3ttaW5JbnQ6MSxtaW5GcmFjOjAsbWF4RnJhYzozLHBvc1ByZTpcIlwiLHBvc1N1ZjpcIlwiLG5lZ1ByZTpcIi1cIixuZWdTdWY6XCJcIixnU2l6ZTozLGxnU2l6ZTozfSx7bWluSW50OjEsbWluRnJhYzoyLFxubWF4RnJhYzoyLHBvc1ByZTpcIlxcdTAwYTRcIixwb3NTdWY6XCJcIixuZWdQcmU6XCIoXFx1MDBhNFwiLG5lZ1N1ZjpcIilcIixnU2l6ZTozLGxnU2l6ZTozfV0sQ1VSUkVOQ1lfU1lNOlwiJFwifSxEQVRFVElNRV9GT1JNQVRTOntNT05USDpcIkphbnVhcnkgRmVicnVhcnkgTWFyY2ggQXByaWwgTWF5IEp1bmUgSnVseSBBdWd1c3QgU2VwdGVtYmVyIE9jdG9iZXIgTm92ZW1iZXIgRGVjZW1iZXJcIi5zcGxpdChcIiBcIiksU0hPUlRNT05USDpcIkphbiBGZWIgTWFyIEFwciBNYXkgSnVuIEp1bCBBdWcgU2VwIE9jdCBOb3YgRGVjXCIuc3BsaXQoXCIgXCIpLERBWTpcIlN1bmRheSBNb25kYXkgVHVlc2RheSBXZWRuZXNkYXkgVGh1cnNkYXkgRnJpZGF5IFNhdHVyZGF5XCIuc3BsaXQoXCIgXCIpLFNIT1JUREFZOlwiU3VuIE1vbiBUdWUgV2VkIFRodSBGcmkgU2F0XCIuc3BsaXQoXCIgXCIpLEFNUE1TOltcIkFNXCIsXCJQTVwiXSxtZWRpdW06XCJNTU0gZCwgeSBoOm1tOnNzIGFcIixcInNob3J0XCI6XCJNL2QveXkgaDptbSBhXCIsZnVsbERhdGU6XCJFRUVFLCBNTU1NIGQsIHlcIixcbmxvbmdEYXRlOlwiTU1NTSBkLCB5XCIsbWVkaXVtRGF0ZTpcIk1NTSBkLCB5XCIsc2hvcnREYXRlOlwiTS9kL3l5XCIsbWVkaXVtVGltZTpcImg6bW06c3MgYVwiLHNob3J0VGltZTpcImg6bW0gYVwifSxwbHVyYWxDYXQ6ZnVuY3Rpb24oYil7cmV0dXJuIDE9PT1iP1wib25lXCI6XCJvdGhlclwifX19fWZ1bmN0aW9uIGFjKGIpe2I9Yi5zcGxpdChcIi9cIik7Zm9yKHZhciBhPWIubGVuZ3RoO2EtLTspYlthXT1xYihiW2FdKTtyZXR1cm4gYi5qb2luKFwiL1wiKX1mdW5jdGlvbiAkYyhiLGEpe3ZhciBjPUJhKGIpO2EuJCRwcm90b2NvbD1jLnByb3RvY29sO2EuJCRob3N0PWMuaG9zdG5hbWU7YS4kJHBvcnQ9YmEoYy5wb3J0KXx8eGZbYy5wcm90b2NvbF18fG51bGx9ZnVuY3Rpb24gYWQoYixhKXt2YXIgYz1cIi9cIiE9PWIuY2hhckF0KDApO2MmJihiPVwiL1wiK2IpO3ZhciBkPUJhKGIpO2EuJCRwYXRoPWRlY29kZVVSSUNvbXBvbmVudChjJiZcIi9cIj09PWQucGF0aG5hbWUuY2hhckF0KDApP2QucGF0aG5hbWUuc3Vic3RyaW5nKDEpOlxuZC5wYXRobmFtZSk7YS4kJHNlYXJjaD1xYyhkLnNlYXJjaCk7YS4kJGhhc2g9ZGVjb2RlVVJJQ29tcG9uZW50KGQuaGFzaCk7YS4kJHBhdGgmJlwiL1wiIT1hLiQkcGF0aC5jaGFyQXQoMCkmJihhLiQkcGF0aD1cIi9cIithLiQkcGF0aCl9ZnVuY3Rpb24gemEoYixhKXtpZigwPT09YS5pbmRleE9mKGIpKXJldHVybiBhLnN1YnN0cihiLmxlbmd0aCl9ZnVuY3Rpb24gSGEoYil7dmFyIGE9Yi5pbmRleE9mKFwiI1wiKTtyZXR1cm4tMT09YT9iOmIuc3Vic3RyKDAsYSl9ZnVuY3Rpb24gYmQoYil7cmV0dXJuIGIucmVwbGFjZSgvKCMuKyl8IyQvLFwiJDFcIil9ZnVuY3Rpb24gYmMoYil7cmV0dXJuIGIuc3Vic3RyKDAsSGEoYikubGFzdEluZGV4T2YoXCIvXCIpKzEpfWZ1bmN0aW9uIGNjKGIsYSl7dGhpcy4kJGh0bWw1PSEwO2E9YXx8XCJcIjt2YXIgYz1iYyhiKTskYyhiLHRoaXMpO3RoaXMuJCRwYXJzZT1mdW5jdGlvbihhKXt2YXIgYj16YShjLGEpO2lmKCFGKGIpKXRocm93IEZiKFwiaXB0aHByZnhcIixhLGMpO1xuYWQoYix0aGlzKTt0aGlzLiQkcGF0aHx8KHRoaXMuJCRwYXRoPVwiL1wiKTt0aGlzLiQkY29tcG9zZSgpfTt0aGlzLiQkY29tcG9zZT1mdW5jdGlvbigpe3ZhciBhPU5iKHRoaXMuJCRzZWFyY2gpLGI9dGhpcy4kJGhhc2g/XCIjXCIrcWIodGhpcy4kJGhhc2gpOlwiXCI7dGhpcy4kJHVybD1hYyh0aGlzLiQkcGF0aCkrKGE/XCI/XCIrYTpcIlwiKStiO3RoaXMuJCRhYnNVcmw9Yyt0aGlzLiQkdXJsLnN1YnN0cigxKX07dGhpcy4kJHBhcnNlTGlua1VybD1mdW5jdGlvbihkLGUpe2lmKGUmJlwiI1wiPT09ZVswXSlyZXR1cm4gdGhpcy5oYXNoKGUuc2xpY2UoMSkpLCEwO3ZhciBmLGc7KGY9emEoYixkKSkhPT10PyhnPWYsZz0oZj16YShhLGYpKSE9PXQ/YysoemEoXCIvXCIsZil8fGYpOmIrZyk6KGY9emEoYyxkKSkhPT10P2c9YytmOmM9PWQrXCIvXCImJihnPWMpO2cmJnRoaXMuJCRwYXJzZShnKTtyZXR1cm4hIWd9fWZ1bmN0aW9uIGRjKGIsYSl7dmFyIGM9YmMoYik7JGMoYix0aGlzKTt0aGlzLiQkcGFyc2U9ZnVuY3Rpb24oZCl7ZD1cbnphKGIsZCl8fHphKGMsZCk7dmFyIGU7XCIjXCI9PT1kLmNoYXJBdCgwKT8oZT16YShhLGQpLEEoZSkmJihlPWQpKTplPXRoaXMuJCRodG1sNT9kOlwiXCI7YWQoZSx0aGlzKTtkPXRoaXMuJCRwYXRoO3ZhciBmPS9eXFwvW0EtWl06KFxcLy4qKS87MD09PWUuaW5kZXhPZihiKSYmKGU9ZS5yZXBsYWNlKGIsXCJcIikpO2YuZXhlYyhlKXx8KGQ9KGU9Zi5leGVjKGQpKT9lWzFdOmQpO3RoaXMuJCRwYXRoPWQ7dGhpcy4kJGNvbXBvc2UoKX07dGhpcy4kJGNvbXBvc2U9ZnVuY3Rpb24oKXt2YXIgYz1OYih0aGlzLiQkc2VhcmNoKSxlPXRoaXMuJCRoYXNoP1wiI1wiK3FiKHRoaXMuJCRoYXNoKTpcIlwiO3RoaXMuJCR1cmw9YWModGhpcy4kJHBhdGgpKyhjP1wiP1wiK2M6XCJcIikrZTt0aGlzLiQkYWJzVXJsPWIrKHRoaXMuJCR1cmw/YSt0aGlzLiQkdXJsOlwiXCIpfTt0aGlzLiQkcGFyc2VMaW5rVXJsPWZ1bmN0aW9uKGEsYyl7cmV0dXJuIEhhKGIpPT1IYShhKT8odGhpcy4kJHBhcnNlKGEpLCEwKTohMX19ZnVuY3Rpb24gY2QoYixcbmEpe3RoaXMuJCRodG1sNT0hMDtkYy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIGM9YmMoYik7dGhpcy4kJHBhcnNlTGlua1VybD1mdW5jdGlvbihkLGUpe2lmKGUmJlwiI1wiPT09ZVswXSlyZXR1cm4gdGhpcy5oYXNoKGUuc2xpY2UoMSkpLCEwO3ZhciBmLGc7Yj09SGEoZCk/Zj1kOihnPXphKGMsZCkpP2Y9YithK2c6Yz09PWQrXCIvXCImJihmPWMpO2YmJnRoaXMuJCRwYXJzZShmKTtyZXR1cm4hIWZ9O3RoaXMuJCRjb21wb3NlPWZ1bmN0aW9uKCl7dmFyIGM9TmIodGhpcy4kJHNlYXJjaCksZT10aGlzLiQkaGFzaD9cIiNcIitxYih0aGlzLiQkaGFzaCk6XCJcIjt0aGlzLiQkdXJsPWFjKHRoaXMuJCRwYXRoKSsoYz9cIj9cIitjOlwiXCIpK2U7dGhpcy4kJGFic1VybD1iK2ErdGhpcy4kJHVybH19ZnVuY3Rpb24gR2IoYil7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXNbYl19fWZ1bmN0aW9uIGRkKGIsYSl7cmV0dXJuIGZ1bmN0aW9uKGMpe2lmKEEoYykpcmV0dXJuIHRoaXNbYl07dGhpc1tiXT1cbmEoYyk7dGhpcy4kJGNvbXBvc2UoKTtyZXR1cm4gdGhpc319ZnVuY3Rpb24gTWUoKXt2YXIgYj1cIlwiLGE9e2VuYWJsZWQ6ITEscmVxdWlyZUJhc2U6ITAscmV3cml0ZUxpbmtzOiEwfTt0aGlzLmhhc2hQcmVmaXg9ZnVuY3Rpb24oYSl7cmV0dXJuIHkoYSk/KGI9YSx0aGlzKTpifTt0aGlzLmh0bWw1TW9kZT1mdW5jdGlvbihiKXtyZXR1cm4gV2EoYik/KGEuZW5hYmxlZD1iLHRoaXMpOkkoYik/KFdhKGIuZW5hYmxlZCkmJihhLmVuYWJsZWQ9Yi5lbmFibGVkKSxXYShiLnJlcXVpcmVCYXNlKSYmKGEucmVxdWlyZUJhc2U9Yi5yZXF1aXJlQmFzZSksV2EoYi5yZXdyaXRlTGlua3MpJiYoYS5yZXdyaXRlTGlua3M9Yi5yZXdyaXRlTGlua3MpLHRoaXMpOmF9O3RoaXMuJGdldD1bXCIkcm9vdFNjb3BlXCIsXCIkYnJvd3NlclwiLFwiJHNuaWZmZXJcIixcIiRyb290RWxlbWVudFwiLFwiJHdpbmRvd1wiLGZ1bmN0aW9uKGMsZCxlLGYsZyl7ZnVuY3Rpb24gaChhLGIsYyl7dmFyIGU9ay51cmwoKSxmPWsuJCRzdGF0ZTtcbnRyeXtkLnVybChhLGIsYyksay4kJHN0YXRlPWQuc3RhdGUoKX1jYXRjaChnKXt0aHJvdyBrLnVybChlKSxrLiQkc3RhdGU9ZixnO319ZnVuY3Rpb24gbChhLGIpe2MuJGJyb2FkY2FzdChcIiRsb2NhdGlvbkNoYW5nZVN1Y2Nlc3NcIixrLmFic1VybCgpLGEsay4kJHN0YXRlLGIpfXZhciBrLG07bT1kLmJhc2VIcmVmKCk7dmFyIHA9ZC51cmwoKSxxO2lmKGEuZW5hYmxlZCl7aWYoIW0mJmEucmVxdWlyZUJhc2UpdGhyb3cgRmIoXCJub2Jhc2VcIik7cT1wLnN1YnN0cmluZygwLHAuaW5kZXhPZihcIi9cIixwLmluZGV4T2YoXCIvL1wiKSsyKSkrKG18fFwiL1wiKTttPWUuaGlzdG9yeT9jYzpjZH1lbHNlIHE9SGEocCksbT1kYztrPW5ldyBtKHEsXCIjXCIrYik7ay4kJHBhcnNlTGlua1VybChwLHApO2suJCRzdGF0ZT1kLnN0YXRlKCk7dmFyIHU9L15cXHMqKGphdmFzY3JpcHR8bWFpbHRvKTovaTtmLm9uKFwiY2xpY2tcIixmdW5jdGlvbihiKXtpZihhLnJld3JpdGVMaW5rcyYmIWIuY3RybEtleSYmIWIubWV0YUtleSYmXG4yIT1iLndoaWNoKXtmb3IodmFyIGU9QihiLnRhcmdldCk7XCJhXCIhPT11YShlWzBdKTspaWYoZVswXT09PWZbMF18fCEoZT1lLnBhcmVudCgpKVswXSlyZXR1cm47dmFyIGg9ZS5wcm9wKFwiaHJlZlwiKSxsPWUuYXR0cihcImhyZWZcIil8fGUuYXR0cihcInhsaW5rOmhyZWZcIik7SShoKSYmXCJbb2JqZWN0IFNWR0FuaW1hdGVkU3RyaW5nXVwiPT09aC50b1N0cmluZygpJiYoaD1CYShoLmFuaW1WYWwpLmhyZWYpO3UudGVzdChoKXx8IWh8fGUuYXR0cihcInRhcmdldFwiKXx8Yi5pc0RlZmF1bHRQcmV2ZW50ZWQoKXx8IWsuJCRwYXJzZUxpbmtVcmwoaCxsKXx8KGIucHJldmVudERlZmF1bHQoKSxrLmFic1VybCgpIT1kLnVybCgpJiYoYy4kYXBwbHkoKSxnLmFuZ3VsYXJbXCJmZi02ODQyMDgtcHJldmVudERlZmF1bHRcIl09ITApKX19KTtrLmFic1VybCgpIT1wJiZkLnVybChrLmFic1VybCgpLCEwKTt2YXIgcj0hMDtkLm9uVXJsQ2hhbmdlKGZ1bmN0aW9uKGEsYil7Yy4kZXZhbEFzeW5jKGZ1bmN0aW9uKCl7dmFyIGQ9XG5rLmFic1VybCgpLGU9ay4kJHN0YXRlLGY7ay4kJHBhcnNlKGEpO2suJCRzdGF0ZT1iO2Y9Yy4kYnJvYWRjYXN0KFwiJGxvY2F0aW9uQ2hhbmdlU3RhcnRcIixhLGQsYixlKS5kZWZhdWx0UHJldmVudGVkO2suYWJzVXJsKCk9PT1hJiYoZj8oay4kJHBhcnNlKGQpLGsuJCRzdGF0ZT1lLGgoZCwhMSxlKSk6KHI9ITEsbChkLGUpKSl9KTtjLiQkcGhhc2V8fGMuJGRpZ2VzdCgpfSk7Yy4kd2F0Y2goZnVuY3Rpb24oKXt2YXIgYT1iZChkLnVybCgpKSxiPWJkKGsuYWJzVXJsKCkpLGY9ZC5zdGF0ZSgpLGc9ay4kJHJlcGxhY2UscT1hIT09Ynx8ay4kJGh0bWw1JiZlLmhpc3RvcnkmJmYhPT1rLiQkc3RhdGU7aWYocnx8cSlyPSExLGMuJGV2YWxBc3luYyhmdW5jdGlvbigpe3ZhciBiPWsuYWJzVXJsKCksZD1jLiRicm9hZGNhc3QoXCIkbG9jYXRpb25DaGFuZ2VTdGFydFwiLGIsYSxrLiQkc3RhdGUsZikuZGVmYXVsdFByZXZlbnRlZDtrLmFic1VybCgpPT09YiYmKGQ/KGsuJCRwYXJzZShhKSxrLiQkc3RhdGU9XG5mKToocSYmaChiLGcsZj09PWsuJCRzdGF0ZT9udWxsOmsuJCRzdGF0ZSksbChhLGYpKSl9KTtrLiQkcmVwbGFjZT0hMX0pO3JldHVybiBrfV19ZnVuY3Rpb24gTmUoKXt2YXIgYj0hMCxhPXRoaXM7dGhpcy5kZWJ1Z0VuYWJsZWQ9ZnVuY3Rpb24oYSl7cmV0dXJuIHkoYSk/KGI9YSx0aGlzKTpifTt0aGlzLiRnZXQ9W1wiJHdpbmRvd1wiLGZ1bmN0aW9uKGMpe2Z1bmN0aW9uIGQoYSl7YSBpbnN0YW5jZW9mIEVycm9yJiYoYS5zdGFjaz9hPWEubWVzc2FnZSYmLTE9PT1hLnN0YWNrLmluZGV4T2YoYS5tZXNzYWdlKT9cIkVycm9yOiBcIithLm1lc3NhZ2UrXCJcXG5cIithLnN0YWNrOmEuc3RhY2s6YS5zb3VyY2VVUkwmJihhPWEubWVzc2FnZStcIlxcblwiK2Euc291cmNlVVJMK1wiOlwiK2EubGluZSkpO3JldHVybiBhfWZ1bmN0aW9uIGUoYSl7dmFyIGI9Yy5jb25zb2xlfHx7fSxlPWJbYV18fGIubG9nfHxIO2E9ITE7dHJ5e2E9ISFlLmFwcGx5fWNhdGNoKGwpe31yZXR1cm4gYT9mdW5jdGlvbigpe3ZhciBhPVxuW107cyhhcmd1bWVudHMsZnVuY3Rpb24oYil7YS5wdXNoKGQoYikpfSk7cmV0dXJuIGUuYXBwbHkoYixhKX06ZnVuY3Rpb24oYSxiKXtlKGEsbnVsbD09Yj9cIlwiOmIpfX1yZXR1cm57bG9nOmUoXCJsb2dcIiksaW5mbzplKFwiaW5mb1wiKSx3YXJuOmUoXCJ3YXJuXCIpLGVycm9yOmUoXCJlcnJvclwiKSxkZWJ1ZzpmdW5jdGlvbigpe3ZhciBjPWUoXCJkZWJ1Z1wiKTtyZXR1cm4gZnVuY3Rpb24oKXtiJiZjLmFwcGx5KGEsYXJndW1lbnRzKX19KCl9fV19ZnVuY3Rpb24gdGEoYixhKXtpZihcIl9fZGVmaW5lR2V0dGVyX19cIj09PWJ8fFwiX19kZWZpbmVTZXR0ZXJfX1wiPT09Ynx8XCJfX2xvb2t1cEdldHRlcl9fXCI9PT1ifHxcIl9fbG9va3VwU2V0dGVyX19cIj09PWJ8fFwiX19wcm90b19fXCI9PT1iKXRocm93IGxhKFwiaXNlY2ZsZFwiLGEpO3JldHVybiBifWZ1bmN0aW9uIG1hKGIsYSl7aWYoYil7aWYoYi5jb25zdHJ1Y3Rvcj09PWIpdGhyb3cgbGEoXCJpc2VjZm5cIixhKTtpZihiLndpbmRvdz09PWIpdGhyb3cgbGEoXCJpc2Vjd2luZG93XCIsXG5hKTtpZihiLmNoaWxkcmVuJiYoYi5ub2RlTmFtZXx8Yi5wcm9wJiZiLmF0dHImJmIuZmluZCkpdGhyb3cgbGEoXCJpc2VjZG9tXCIsYSk7aWYoYj09PU9iamVjdCl0aHJvdyBsYShcImlzZWNvYmpcIixhKTt9cmV0dXJuIGJ9ZnVuY3Rpb24gZWMoYil7cmV0dXJuIGIuY29uc3RhbnR9ZnVuY3Rpb24gZ2IoYixhLGMsZCxlKXttYShiLGUpO21hKGEsZSk7Yz1jLnNwbGl0KFwiLlwiKTtmb3IodmFyIGYsZz0wOzE8Yy5sZW5ndGg7ZysrKXtmPXRhKGMuc2hpZnQoKSxlKTt2YXIgaD0wPT09ZyYmYSYmYVtmXXx8YltmXTtofHwoaD17fSxiW2ZdPWgpO2I9bWEoaCxlKX1mPXRhKGMuc2hpZnQoKSxlKTttYShiW2ZdLGUpO3JldHVybiBiW2ZdPWR9ZnVuY3Rpb24gUWEoYil7cmV0dXJuXCJjb25zdHJ1Y3RvclwiPT1ifWZ1bmN0aW9uIGVkKGIsYSxjLGQsZSxmLGcpe3RhKGIsZik7dGEoYSxmKTt0YShjLGYpO3RhKGQsZik7dGEoZSxmKTt2YXIgaD1mdW5jdGlvbihhKXtyZXR1cm4gbWEoYSxmKX0sbD1nfHxRYShiKT9cbmg6cGEsaz1nfHxRYShhKT9oOnBhLG09Z3x8UWEoYyk/aDpwYSxwPWd8fFFhKGQpP2g6cGEscT1nfHxRYShlKT9oOnBhO3JldHVybiBmdW5jdGlvbihmLGcpe3ZhciBoPWcmJmcuaGFzT3duUHJvcGVydHkoYik/ZzpmO2lmKG51bGw9PWgpcmV0dXJuIGg7aD1sKGhbYl0pO2lmKCFhKXJldHVybiBoO2lmKG51bGw9PWgpcmV0dXJuIHQ7aD1rKGhbYV0pO2lmKCFjKXJldHVybiBoO2lmKG51bGw9PWgpcmV0dXJuIHQ7aD1tKGhbY10pO2lmKCFkKXJldHVybiBoO2lmKG51bGw9PWgpcmV0dXJuIHQ7aD1wKGhbZF0pO3JldHVybiBlP251bGw9PWg/dDpoPXEoaFtlXSk6aH19ZnVuY3Rpb24geWYoYixhKXtyZXR1cm4gZnVuY3Rpb24oYyxkKXtyZXR1cm4gYihjLGQsbWEsYSl9fWZ1bmN0aW9uIHpmKGIsYSxjKXt2YXIgZD1hLmV4cGVuc2l2ZUNoZWNrcyxlPWQ/QWY6QmYsZj1lW2JdO2lmKGYpcmV0dXJuIGY7dmFyIGc9Yi5zcGxpdChcIi5cIiksaD1nLmxlbmd0aDtpZihhLmNzcClmPTY+aD9lZChnWzBdLFxuZ1sxXSxnWzJdLGdbM10sZ1s0XSxjLGQpOmZ1bmN0aW9uKGEsYil7dmFyIGU9MCxmO2RvIGY9ZWQoZ1tlKytdLGdbZSsrXSxnW2UrK10sZ1tlKytdLGdbZSsrXSxjLGQpKGEsYiksYj10LGE9Zjt3aGlsZShlPGgpO3JldHVybiBmfTtlbHNle3ZhciBsPVwiXCI7ZCYmKGwrPVwicyA9IGVzbyhzLCBmZSk7XFxubCA9IGVzbyhsLCBmZSk7XFxuXCIpO3ZhciBrPWQ7cyhnLGZ1bmN0aW9uKGEsYil7dGEoYSxjKTt2YXIgZT0oYj9cInNcIjonKChsJiZsLmhhc093blByb3BlcnR5KFwiJythKydcIikpP2w6cyknKStcIi5cIithO2lmKGR8fFFhKGEpKWU9XCJlc28oXCIrZStcIiwgZmUpXCIsaz0hMDtsKz1cImlmKHMgPT0gbnVsbCkgcmV0dXJuIHVuZGVmaW5lZDtcXG5zPVwiK2UrXCI7XFxuXCJ9KTtsKz1cInJldHVybiBzO1wiO2E9bmV3IEZ1bmN0aW9uKFwic1wiLFwibFwiLFwiZXNvXCIsXCJmZVwiLGwpO2EudG9TdHJpbmc9ZGEobCk7ayYmKGE9eWYoYSxjKSk7Zj1hfWYuc2hhcmVkR2V0dGVyPSEwO2YuYXNzaWduPWZ1bmN0aW9uKGEsYyxkKXtyZXR1cm4gZ2IoYSxcbmQsYixjLGIpfTtyZXR1cm4gZVtiXT1mfWZ1bmN0aW9uIGZjKGIpe3JldHVybiBHKGIudmFsdWVPZik/Yi52YWx1ZU9mKCk6Q2YuY2FsbChiKX1mdW5jdGlvbiBPZSgpe3ZhciBiPWhhKCksYT1oYSgpO3RoaXMuJGdldD1bXCIkZmlsdGVyXCIsXCIkc25pZmZlclwiLGZ1bmN0aW9uKGMsZCl7ZnVuY3Rpb24gZShhKXt2YXIgYj1hO2Euc2hhcmVkR2V0dGVyJiYoYj1mdW5jdGlvbihiLGMpe3JldHVybiBhKGIsYyl9LGIubGl0ZXJhbD1hLmxpdGVyYWwsYi5jb25zdGFudD1hLmNvbnN0YW50LGIuYXNzaWduPWEuYXNzaWduKTtyZXR1cm4gYn1mdW5jdGlvbiBmKGEsYil7Zm9yKHZhciBjPTAsZD1hLmxlbmd0aDtjPGQ7YysrKXt2YXIgZT1hW2NdO2UuY29uc3RhbnR8fChlLmlucHV0cz9mKGUuaW5wdXRzLGIpOi0xPT09Yi5pbmRleE9mKGUpJiZiLnB1c2goZSkpfXJldHVybiBifWZ1bmN0aW9uIGcoYSxiKXtyZXR1cm4gbnVsbD09YXx8bnVsbD09Yj9hPT09YjpcIm9iamVjdFwiPT09dHlwZW9mIGEmJlxuKGE9ZmMoYSksXCJvYmplY3RcIj09PXR5cGVvZiBhKT8hMTphPT09Ynx8YSE9PWEmJmIhPT1ifWZ1bmN0aW9uIGgoYSxiLGMsZCl7dmFyIGU9ZC4kJGlucHV0c3x8KGQuJCRpbnB1dHM9ZihkLmlucHV0cyxbXSkpLGg7aWYoMT09PWUubGVuZ3RoKXt2YXIgbD1nLGU9ZVswXTtyZXR1cm4gYS4kd2F0Y2goZnVuY3Rpb24oYSl7dmFyIGI9ZShhKTtnKGIsbCl8fChoPWQoYSksbD1iJiZmYyhiKSk7cmV0dXJuIGh9LGIsYyl9Zm9yKHZhciBrPVtdLHE9MCxwPWUubGVuZ3RoO3E8cDtxKyspa1txXT1nO3JldHVybiBhLiR3YXRjaChmdW5jdGlvbihhKXtmb3IodmFyIGI9ITEsYz0wLGY9ZS5sZW5ndGg7YzxmO2MrKyl7dmFyIGw9ZVtjXShhKTtpZihifHwoYj0hZyhsLGtbY10pKSlrW2NdPWwmJmZjKGwpfWImJihoPWQoYSkpO3JldHVybiBofSxiLGMpfWZ1bmN0aW9uIGwoYSxiLGMsZCl7dmFyIGUsZjtyZXR1cm4gZT1hLiR3YXRjaChmdW5jdGlvbihhKXtyZXR1cm4gZChhKX0sZnVuY3Rpb24oYSxcbmMsZCl7Zj1hO0coYikmJmIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3koYSkmJmQuJCRwb3N0RGlnZXN0KGZ1bmN0aW9uKCl7eShmKSYmZSgpfSl9LGMpfWZ1bmN0aW9uIGsoYSxiLGMsZCl7ZnVuY3Rpb24gZShhKXt2YXIgYj0hMDtzKGEsZnVuY3Rpb24oYSl7eShhKXx8KGI9ITEpfSk7cmV0dXJuIGJ9dmFyIGYsZztyZXR1cm4gZj1hLiR3YXRjaChmdW5jdGlvbihhKXtyZXR1cm4gZChhKX0sZnVuY3Rpb24oYSxjLGQpe2c9YTtHKGIpJiZiLmNhbGwodGhpcyxhLGMsZCk7ZShhKSYmZC4kJHBvc3REaWdlc3QoZnVuY3Rpb24oKXtlKGcpJiZmKCl9KX0sYyl9ZnVuY3Rpb24gbShhLGIsYyxkKXt2YXIgZTtyZXR1cm4gZT1hLiR3YXRjaChmdW5jdGlvbihhKXtyZXR1cm4gZChhKX0sZnVuY3Rpb24oYSxjLGQpe0coYikmJmIuYXBwbHkodGhpcyxhcmd1bWVudHMpO2UoKX0sYyl9ZnVuY3Rpb24gcChhLGIpe2lmKCFiKXJldHVybiBhO3ZhciBjPWEuJCR3YXRjaERlbGVnYXRlLGM9YyE9PWsmJlxuYyE9PWw/ZnVuY3Rpb24oYyxkKXt2YXIgZT1hKGMsZCk7cmV0dXJuIGIoZSxjLGQpfTpmdW5jdGlvbihjLGQpe3ZhciBlPWEoYyxkKSxmPWIoZSxjLGQpO3JldHVybiB5KGUpP2Y6ZX07YS4kJHdhdGNoRGVsZWdhdGUmJmEuJCR3YXRjaERlbGVnYXRlIT09aD9jLiQkd2F0Y2hEZWxlZ2F0ZT1hLiQkd2F0Y2hEZWxlZ2F0ZTpiLiRzdGF0ZWZ1bHx8KGMuJCR3YXRjaERlbGVnYXRlPWgsYy5pbnB1dHM9W2FdKTtyZXR1cm4gY312YXIgcT17Y3NwOmQuY3NwLGV4cGVuc2l2ZUNoZWNrczohMX0sdT17Y3NwOmQuY3NwLGV4cGVuc2l2ZUNoZWNrczohMH07cmV0dXJuIGZ1bmN0aW9uKGQsZixnKXt2YXIgdix3LEw7c3dpdGNoKHR5cGVvZiBkKXtjYXNlIFwic3RyaW5nXCI6TD1kPWQudHJpbSgpO3ZhciBDPWc/YTpiO3Y9Q1tMXTt2fHwoXCI6XCI9PT1kLmNoYXJBdCgwKSYmXCI6XCI9PT1kLmNoYXJBdCgxKSYmKHc9ITAsZD1kLnN1YnN0cmluZygyKSksZz1nP3U6cSx2PW5ldyBnYyhnKSx2PShuZXcgaGIodixcbmMsZykpLnBhcnNlKGQpLHYuY29uc3RhbnQ/di4kJHdhdGNoRGVsZWdhdGU9bTp3Pyh2PWUodiksdi4kJHdhdGNoRGVsZWdhdGU9di5saXRlcmFsP2s6bCk6di5pbnB1dHMmJih2LiQkd2F0Y2hEZWxlZ2F0ZT1oKSxDW0xdPXYpO3JldHVybiBwKHYsZik7Y2FzZSBcImZ1bmN0aW9uXCI6cmV0dXJuIHAoZCxmKTtkZWZhdWx0OnJldHVybiBwKEgsZil9fX1dfWZ1bmN0aW9uIFFlKCl7dGhpcy4kZ2V0PVtcIiRyb290U2NvcGVcIixcIiRleGNlcHRpb25IYW5kbGVyXCIsZnVuY3Rpb24oYixhKXtyZXR1cm4gZmQoZnVuY3Rpb24oYSl7Yi4kZXZhbEFzeW5jKGEpfSxhKX1dfWZ1bmN0aW9uIFJlKCl7dGhpcy4kZ2V0PVtcIiRicm93c2VyXCIsXCIkZXhjZXB0aW9uSGFuZGxlclwiLGZ1bmN0aW9uKGIsYSl7cmV0dXJuIGZkKGZ1bmN0aW9uKGEpe2IuZGVmZXIoYSl9LGEpfV19ZnVuY3Rpb24gZmQoYixhKXtmdW5jdGlvbiBjKGEsYixjKXtmdW5jdGlvbiBkKGIpe3JldHVybiBmdW5jdGlvbihjKXtlfHwoZT0hMCxcbmIuY2FsbChhLGMpKX19dmFyIGU9ITE7cmV0dXJuW2QoYiksZChjKV19ZnVuY3Rpb24gZCgpe3RoaXMuJCRzdGF0ZT17c3RhdHVzOjB9fWZ1bmN0aW9uIGUoYSxiKXtyZXR1cm4gZnVuY3Rpb24oYyl7Yi5jYWxsKGEsYyl9fWZ1bmN0aW9uIGYoYyl7IWMucHJvY2Vzc1NjaGVkdWxlZCYmYy5wZW5kaW5nJiYoYy5wcm9jZXNzU2NoZWR1bGVkPSEwLGIoZnVuY3Rpb24oKXt2YXIgYixkLGU7ZT1jLnBlbmRpbmc7Yy5wcm9jZXNzU2NoZWR1bGVkPSExO2MucGVuZGluZz10O2Zvcih2YXIgZj0wLGc9ZS5sZW5ndGg7ZjxnOysrZil7ZD1lW2ZdWzBdO2I9ZVtmXVtjLnN0YXR1c107dHJ5e0coYik/ZC5yZXNvbHZlKGIoYy52YWx1ZSkpOjE9PT1jLnN0YXR1cz9kLnJlc29sdmUoYy52YWx1ZSk6ZC5yZWplY3QoYy52YWx1ZSl9Y2F0Y2goaCl7ZC5yZWplY3QoaCksYShoKX19fSkpfWZ1bmN0aW9uIGcoKXt0aGlzLnByb21pc2U9bmV3IGQ7dGhpcy5yZXNvbHZlPWUodGhpcyx0aGlzLnJlc29sdmUpO1xudGhpcy5yZWplY3Q9ZSh0aGlzLHRoaXMucmVqZWN0KTt0aGlzLm5vdGlmeT1lKHRoaXMsdGhpcy5ub3RpZnkpfXZhciBoPVQoXCIkcVwiLFR5cGVFcnJvcik7ZC5wcm90b3R5cGU9e3RoZW46ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPW5ldyBnO3RoaXMuJCRzdGF0ZS5wZW5kaW5nPXRoaXMuJCRzdGF0ZS5wZW5kaW5nfHxbXTt0aGlzLiQkc3RhdGUucGVuZGluZy5wdXNoKFtkLGEsYixjXSk7MDx0aGlzLiQkc3RhdGUuc3RhdHVzJiZmKHRoaXMuJCRzdGF0ZSk7cmV0dXJuIGQucHJvbWlzZX0sXCJjYXRjaFwiOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnRoZW4obnVsbCxhKX0sXCJmaW5hbGx5XCI6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy50aGVuKGZ1bmN0aW9uKGIpe3JldHVybiBrKGIsITAsYSl9LGZ1bmN0aW9uKGIpe3JldHVybiBrKGIsITEsYSl9LGIpfX07Zy5wcm90b3R5cGU9e3Jlc29sdmU6ZnVuY3Rpb24oYSl7dGhpcy5wcm9taXNlLiQkc3RhdGUuc3RhdHVzfHwoYT09PXRoaXMucHJvbWlzZT9cbnRoaXMuJCRyZWplY3QoaChcInFjeWNsZVwiLGEpKTp0aGlzLiQkcmVzb2x2ZShhKSl9LCQkcmVzb2x2ZTpmdW5jdGlvbihiKXt2YXIgZCxlO2U9Yyh0aGlzLHRoaXMuJCRyZXNvbHZlLHRoaXMuJCRyZWplY3QpO3RyeXtpZihJKGIpfHxHKGIpKWQ9YiYmYi50aGVuO0coZCk/KHRoaXMucHJvbWlzZS4kJHN0YXRlLnN0YXR1cz0tMSxkLmNhbGwoYixlWzBdLGVbMV0sdGhpcy5ub3RpZnkpKToodGhpcy5wcm9taXNlLiQkc3RhdGUudmFsdWU9Yix0aGlzLnByb21pc2UuJCRzdGF0ZS5zdGF0dXM9MSxmKHRoaXMucHJvbWlzZS4kJHN0YXRlKSl9Y2F0Y2goZyl7ZVsxXShnKSxhKGcpfX0scmVqZWN0OmZ1bmN0aW9uKGEpe3RoaXMucHJvbWlzZS4kJHN0YXRlLnN0YXR1c3x8dGhpcy4kJHJlamVjdChhKX0sJCRyZWplY3Q6ZnVuY3Rpb24oYSl7dGhpcy5wcm9taXNlLiQkc3RhdGUudmFsdWU9YTt0aGlzLnByb21pc2UuJCRzdGF0ZS5zdGF0dXM9MjtmKHRoaXMucHJvbWlzZS4kJHN0YXRlKX0sbm90aWZ5OmZ1bmN0aW9uKGMpe3ZhciBkPVxudGhpcy5wcm9taXNlLiQkc3RhdGUucGVuZGluZzswPj10aGlzLnByb21pc2UuJCRzdGF0ZS5zdGF0dXMmJmQmJmQubGVuZ3RoJiZiKGZ1bmN0aW9uKCl7Zm9yKHZhciBiLGUsZj0wLGc9ZC5sZW5ndGg7ZjxnO2YrKyl7ZT1kW2ZdWzBdO2I9ZFtmXVszXTt0cnl7ZS5ub3RpZnkoRyhiKT9iKGMpOmMpfWNhdGNoKGgpe2EoaCl9fX0pfX07dmFyIGw9ZnVuY3Rpb24oYSxiKXt2YXIgYz1uZXcgZztiP2MucmVzb2x2ZShhKTpjLnJlamVjdChhKTtyZXR1cm4gYy5wcm9taXNlfSxrPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1udWxsO3RyeXtHKGMpJiYoZD1jKCkpfWNhdGNoKGUpe3JldHVybiBsKGUsITEpfXJldHVybiBkJiZHKGQudGhlbik/ZC50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGwoYSxiKX0sZnVuY3Rpb24oYSl7cmV0dXJuIGwoYSwhMSl9KTpsKGEsYil9LG09ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9bmV3IGc7ZS5yZXNvbHZlKGEpO3JldHVybiBlLnByb21pc2UudGhlbihiLGMsZCl9LFxucD1mdW5jdGlvbiB1KGEpe2lmKCFHKGEpKXRocm93IGgoXCJub3JzbHZyXCIsYSk7aWYoISh0aGlzIGluc3RhbmNlb2YgdSkpcmV0dXJuIG5ldyB1KGEpO3ZhciBiPW5ldyBnO2EoZnVuY3Rpb24oYSl7Yi5yZXNvbHZlKGEpfSxmdW5jdGlvbihhKXtiLnJlamVjdChhKX0pO3JldHVybiBiLnByb21pc2V9O3AuZGVmZXI9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGd9O3AucmVqZWN0PWZ1bmN0aW9uKGEpe3ZhciBiPW5ldyBnO2IucmVqZWN0KGEpO3JldHVybiBiLnByb21pc2V9O3Aud2hlbj1tO3AuYWxsPWZ1bmN0aW9uKGEpe3ZhciBiPW5ldyBnLGM9MCxkPUQoYSk/W106e307cyhhLGZ1bmN0aW9uKGEsZSl7YysrO20oYSkudGhlbihmdW5jdGlvbihhKXtkLmhhc093blByb3BlcnR5KGUpfHwoZFtlXT1hLC0tY3x8Yi5yZXNvbHZlKGQpKX0sZnVuY3Rpb24oYSl7ZC5oYXNPd25Qcm9wZXJ0eShlKXx8Yi5yZWplY3QoYSl9KX0pOzA9PT1jJiZiLnJlc29sdmUoZCk7cmV0dXJuIGIucHJvbWlzZX07XG5yZXR1cm4gcH1mdW5jdGlvbiAkZSgpe3RoaXMuJGdldD1bXCIkd2luZG93XCIsXCIkdGltZW91dFwiLGZ1bmN0aW9uKGIsYSl7dmFyIGM9Yi5yZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGIud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lLGQ9Yi5jYW5jZWxBbmltYXRpb25GcmFtZXx8Yi53ZWJraXRDYW5jZWxBbmltYXRpb25GcmFtZXx8Yi53ZWJraXRDYW5jZWxSZXF1ZXN0QW5pbWF0aW9uRnJhbWUsZT0hIWMsZj1lP2Z1bmN0aW9uKGEpe3ZhciBiPWMoYSk7cmV0dXJuIGZ1bmN0aW9uKCl7ZChiKX19OmZ1bmN0aW9uKGIpe3ZhciBjPWEoYiwxNi42NiwhMSk7cmV0dXJuIGZ1bmN0aW9uKCl7YS5jYW5jZWwoYyl9fTtmLnN1cHBvcnRlZD1lO3JldHVybiBmfV19ZnVuY3Rpb24gUGUoKXt2YXIgYj0xMCxhPVQoXCIkcm9vdFNjb3BlXCIpLGM9bnVsbCxkPW51bGw7dGhpcy5kaWdlc3RUdGw9ZnVuY3Rpb24oYSl7YXJndW1lbnRzLmxlbmd0aCYmKGI9YSk7cmV0dXJuIGJ9O3RoaXMuJGdldD1bXCIkaW5qZWN0b3JcIixcblwiJGV4Y2VwdGlvbkhhbmRsZXJcIixcIiRwYXJzZVwiLFwiJGJyb3dzZXJcIixmdW5jdGlvbihlLGYsZyxoKXtmdW5jdGlvbiBsKCl7dGhpcy4kaWQ9KytuYjt0aGlzLiQkcGhhc2U9dGhpcy4kcGFyZW50PXRoaXMuJCR3YXRjaGVycz10aGlzLiQkbmV4dFNpYmxpbmc9dGhpcy4kJHByZXZTaWJsaW5nPXRoaXMuJCRjaGlsZEhlYWQ9dGhpcy4kJGNoaWxkVGFpbD1udWxsO3RoaXMuJHJvb3Q9dGhpczt0aGlzLiQkZGVzdHJveWVkPSExO3RoaXMuJCRsaXN0ZW5lcnM9e307dGhpcy4kJGxpc3RlbmVyQ291bnQ9e307dGhpcy4kJGlzb2xhdGVCaW5kaW5ncz1udWxsfWZ1bmN0aW9uIGsoYil7aWYoci4kJHBoYXNlKXRocm93IGEoXCJpbnByb2dcIixyLiQkcGhhc2UpO3IuJCRwaGFzZT1ifWZ1bmN0aW9uIG0oYSxiLGMpe2RvIGEuJCRsaXN0ZW5lckNvdW50W2NdLT1iLDA9PT1hLiQkbGlzdGVuZXJDb3VudFtjXSYmZGVsZXRlIGEuJCRsaXN0ZW5lckNvdW50W2NdO3doaWxlKGE9YS4kcGFyZW50KX1mdW5jdGlvbiBwKCl7fVxuZnVuY3Rpb24gcSgpe2Zvcig7di5sZW5ndGg7KXRyeXt2LnNoaWZ0KCkoKX1jYXRjaChhKXtmKGEpfWQ9bnVsbH1mdW5jdGlvbiB1KCl7bnVsbD09PWQmJihkPWguZGVmZXIoZnVuY3Rpb24oKXtyLiRhcHBseShxKX0pKX1sLnByb3RvdHlwZT17Y29uc3RydWN0b3I6bCwkbmV3OmZ1bmN0aW9uKGEsYil7ZnVuY3Rpb24gYygpe2QuJCRkZXN0cm95ZWQ9ITB9dmFyIGQ7Yj1ifHx0aGlzO2E/KGQ9bmV3IGwsZC4kcm9vdD10aGlzLiRyb290KToodGhpcy4kJENoaWxkU2NvcGV8fCh0aGlzLiQkQ2hpbGRTY29wZT1mdW5jdGlvbigpe3RoaXMuJCR3YXRjaGVycz10aGlzLiQkbmV4dFNpYmxpbmc9dGhpcy4kJGNoaWxkSGVhZD10aGlzLiQkY2hpbGRUYWlsPW51bGw7dGhpcy4kJGxpc3RlbmVycz17fTt0aGlzLiQkbGlzdGVuZXJDb3VudD17fTt0aGlzLiRpZD0rK25iO3RoaXMuJCRDaGlsZFNjb3BlPW51bGx9LHRoaXMuJCRDaGlsZFNjb3BlLnByb3RvdHlwZT10aGlzKSxkPW5ldyB0aGlzLiQkQ2hpbGRTY29wZSk7XG5kLiRwYXJlbnQ9YjtkLiQkcHJldlNpYmxpbmc9Yi4kJGNoaWxkVGFpbDtiLiQkY2hpbGRIZWFkPyhiLiQkY2hpbGRUYWlsLiQkbmV4dFNpYmxpbmc9ZCxiLiQkY2hpbGRUYWlsPWQpOmIuJCRjaGlsZEhlYWQ9Yi4kJGNoaWxkVGFpbD1kOyhhfHxiIT10aGlzKSYmZC4kb24oXCIkZGVzdHJveVwiLGMpO3JldHVybiBkfSwkd2F0Y2g6ZnVuY3Rpb24oYSxiLGQpe3ZhciBlPWcoYSk7aWYoZS4kJHdhdGNoRGVsZWdhdGUpcmV0dXJuIGUuJCR3YXRjaERlbGVnYXRlKHRoaXMsYixkLGUpO3ZhciBmPXRoaXMuJCR3YXRjaGVycyxoPXtmbjpiLGxhc3Q6cCxnZXQ6ZSxleHA6YSxlcTohIWR9O2M9bnVsbDtHKGIpfHwoaC5mbj1IKTtmfHwoZj10aGlzLiQkd2F0Y2hlcnM9W10pO2YudW5zaGlmdChoKTtyZXR1cm4gZnVuY3Rpb24oKXtYYShmLGgpO2M9bnVsbH19LCR3YXRjaEdyb3VwOmZ1bmN0aW9uKGEsYil7ZnVuY3Rpb24gYygpe2g9ITE7bD8obD0hMSxiKGUsZSxnKSk6YihlLGQsZyl9dmFyIGQ9QXJyYXkoYS5sZW5ndGgpLFxuZT1BcnJheShhLmxlbmd0aCksZj1bXSxnPXRoaXMsaD0hMSxsPSEwO2lmKCFhLmxlbmd0aCl7dmFyIGs9ITA7Zy4kZXZhbEFzeW5jKGZ1bmN0aW9uKCl7ayYmYihlLGUsZyl9KTtyZXR1cm4gZnVuY3Rpb24oKXtrPSExfX1pZigxPT09YS5sZW5ndGgpcmV0dXJuIHRoaXMuJHdhdGNoKGFbMF0sZnVuY3Rpb24oYSxjLGYpe2VbMF09YTtkWzBdPWM7YihlLGE9PT1jP2U6ZCxmKX0pO3MoYSxmdW5jdGlvbihhLGIpe3ZhciBsPWcuJHdhdGNoKGEsZnVuY3Rpb24oYSxmKXtlW2JdPWE7ZFtiXT1mO2h8fChoPSEwLGcuJGV2YWxBc3luYyhjKSl9KTtmLnB1c2gobCl9KTtyZXR1cm4gZnVuY3Rpb24oKXtmb3IoO2YubGVuZ3RoOylmLnNoaWZ0KCkoKX19LCR3YXRjaENvbGxlY3Rpb246ZnVuY3Rpb24oYSxiKXtmdW5jdGlvbiBjKGEpe2U9YTt2YXIgYixkLGcsaDtpZighQShlKSl7aWYoSShlKSlpZihUYShlKSlmb3IoZiE9PXEmJihmPXEsdT1mLmxlbmd0aD0wLGsrKyksYT1lLmxlbmd0aCx1IT09XG5hJiYoaysrLGYubGVuZ3RoPXU9YSksYj0wO2I8YTtiKyspaD1mW2JdLGc9ZVtiXSxkPWghPT1oJiZnIT09ZyxkfHxoPT09Z3x8KGsrKyxmW2JdPWcpO2Vsc2V7ZiE9PW0mJihmPW09e30sdT0wLGsrKyk7YT0wO2ZvcihiIGluIGUpZS5oYXNPd25Qcm9wZXJ0eShiKSYmKGErKyxnPWVbYl0saD1mW2JdLGIgaW4gZj8oZD1oIT09aCYmZyE9PWcsZHx8aD09PWd8fChrKyssZltiXT1nKSk6KHUrKyxmW2JdPWcsaysrKSk7aWYodT5hKWZvcihiIGluIGsrKyxmKWUuaGFzT3duUHJvcGVydHkoYil8fCh1LS0sZGVsZXRlIGZbYl0pfWVsc2UgZiE9PWUmJihmPWUsaysrKTtyZXR1cm4ga319Yy4kc3RhdGVmdWw9ITA7dmFyIGQ9dGhpcyxlLGYsaCxsPTE8Yi5sZW5ndGgsaz0wLHA9ZyhhLGMpLHE9W10sbT17fSxuPSEwLHU9MDtyZXR1cm4gdGhpcy4kd2F0Y2gocCxmdW5jdGlvbigpe24/KG49ITEsYihlLGUsZCkpOmIoZSxoLGQpO2lmKGwpaWYoSShlKSlpZihUYShlKSl7aD1BcnJheShlLmxlbmd0aCk7XG5mb3IodmFyIGE9MDthPGUubGVuZ3RoO2ErKyloW2FdPWVbYV19ZWxzZSBmb3IoYSBpbiBoPXt9LGUpcmMuY2FsbChlLGEpJiYoaFthXT1lW2FdKTtlbHNlIGg9ZX0pfSwkZGlnZXN0OmZ1bmN0aW9uKCl7dmFyIGUsZyxsLG0sdSx2LHM9Yix0LFc9W10seSxKO2soXCIkZGlnZXN0XCIpO2guJCRjaGVja1VybENoYW5nZSgpO3RoaXM9PT1yJiZudWxsIT09ZCYmKGguZGVmZXIuY2FuY2VsKGQpLHEoKSk7Yz1udWxsO2Rve3Y9ITE7Zm9yKHQ9dGhpcztPLmxlbmd0aDspe3RyeXtKPU8uc2hpZnQoKSxKLnNjb3BlLiRldmFsKEouZXhwcmVzc2lvbixKLmxvY2Fscyl9Y2F0Y2goQil7ZihCKX1jPW51bGx9YTpkb3tpZihtPXQuJCR3YXRjaGVycylmb3IodT1tLmxlbmd0aDt1LS07KXRyeXtpZihlPW1bdV0paWYoKGc9ZS5nZXQodCkpIT09KGw9ZS5sYXN0KSYmIShlLmVxP2ZhKGcsbCk6XCJudW1iZXJcIj09PXR5cGVvZiBnJiZcIm51bWJlclwiPT09dHlwZW9mIGwmJmlzTmFOKGcpJiZpc05hTihsKSkpdj1cbiEwLGM9ZSxlLmxhc3Q9ZS5lcT9FYShnLG51bGwpOmcsZS5mbihnLGw9PT1wP2c6bCx0KSw1PnMmJih5PTQtcyxXW3ldfHwoV1t5XT1bXSksV1t5XS5wdXNoKHttc2c6RyhlLmV4cCk/XCJmbjogXCIrKGUuZXhwLm5hbWV8fGUuZXhwLnRvU3RyaW5nKCkpOmUuZXhwLG5ld1ZhbDpnLG9sZFZhbDpsfSkpO2Vsc2UgaWYoZT09PWMpe3Y9ITE7YnJlYWsgYX19Y2F0Y2goQSl7ZihBKX1pZighKG09dC4kJGNoaWxkSGVhZHx8dCE9PXRoaXMmJnQuJCRuZXh0U2libGluZykpZm9yKDt0IT09dGhpcyYmIShtPXQuJCRuZXh0U2libGluZyk7KXQ9dC4kcGFyZW50fXdoaWxlKHQ9bSk7aWYoKHZ8fE8ubGVuZ3RoKSYmIXMtLSl0aHJvdyByLiQkcGhhc2U9bnVsbCxhKFwiaW5mZGlnXCIsYixXKTt9d2hpbGUodnx8Ty5sZW5ndGgpO2ZvcihyLiQkcGhhc2U9bnVsbDtuLmxlbmd0aDspdHJ5e24uc2hpZnQoKSgpfWNhdGNoKGNhKXtmKGNhKX19LCRkZXN0cm95OmZ1bmN0aW9uKCl7aWYoIXRoaXMuJCRkZXN0cm95ZWQpe3ZhciBhPVxudGhpcy4kcGFyZW50O3RoaXMuJGJyb2FkY2FzdChcIiRkZXN0cm95XCIpO3RoaXMuJCRkZXN0cm95ZWQ9ITA7aWYodGhpcyE9PXIpe2Zvcih2YXIgYiBpbiB0aGlzLiQkbGlzdGVuZXJDb3VudCltKHRoaXMsdGhpcy4kJGxpc3RlbmVyQ291bnRbYl0sYik7YS4kJGNoaWxkSGVhZD09dGhpcyYmKGEuJCRjaGlsZEhlYWQ9dGhpcy4kJG5leHRTaWJsaW5nKTthLiQkY2hpbGRUYWlsPT10aGlzJiYoYS4kJGNoaWxkVGFpbD10aGlzLiQkcHJldlNpYmxpbmcpO3RoaXMuJCRwcmV2U2libGluZyYmKHRoaXMuJCRwcmV2U2libGluZy4kJG5leHRTaWJsaW5nPXRoaXMuJCRuZXh0U2libGluZyk7dGhpcy4kJG5leHRTaWJsaW5nJiYodGhpcy4kJG5leHRTaWJsaW5nLiQkcHJldlNpYmxpbmc9dGhpcy4kJHByZXZTaWJsaW5nKTt0aGlzLiRkZXN0cm95PXRoaXMuJGRpZ2VzdD10aGlzLiRhcHBseT10aGlzLiRldmFsQXN5bmM9dGhpcy4kYXBwbHlBc3luYz1IO3RoaXMuJG9uPXRoaXMuJHdhdGNoPXRoaXMuJHdhdGNoR3JvdXA9XG5mdW5jdGlvbigpe3JldHVybiBIfTt0aGlzLiQkbGlzdGVuZXJzPXt9O3RoaXMuJHBhcmVudD10aGlzLiQkbmV4dFNpYmxpbmc9dGhpcy4kJHByZXZTaWJsaW5nPXRoaXMuJCRjaGlsZEhlYWQ9dGhpcy4kJGNoaWxkVGFpbD10aGlzLiRyb290PXRoaXMuJCR3YXRjaGVycz1udWxsfX19LCRldmFsOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGcoYSkodGhpcyxiKX0sJGV2YWxBc3luYzpmdW5jdGlvbihhLGIpe3IuJCRwaGFzZXx8Ty5sZW5ndGh8fGguZGVmZXIoZnVuY3Rpb24oKXtPLmxlbmd0aCYmci4kZGlnZXN0KCl9KTtPLnB1c2goe3Njb3BlOnRoaXMsZXhwcmVzc2lvbjphLGxvY2FsczpifSl9LCQkcG9zdERpZ2VzdDpmdW5jdGlvbihhKXtuLnB1c2goYSl9LCRhcHBseTpmdW5jdGlvbihhKXt0cnl7cmV0dXJuIGsoXCIkYXBwbHlcIiksdGhpcy4kZXZhbChhKX1jYXRjaChiKXtmKGIpfWZpbmFsbHl7ci4kJHBoYXNlPW51bGw7dHJ5e3IuJGRpZ2VzdCgpfWNhdGNoKGMpe3Rocm93IGYoYyksYztcbn19fSwkYXBwbHlBc3luYzpmdW5jdGlvbihhKXtmdW5jdGlvbiBiKCl7Yy4kZXZhbChhKX12YXIgYz10aGlzO2EmJnYucHVzaChiKTt1KCl9LCRvbjpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuJCRsaXN0ZW5lcnNbYV07Y3x8KHRoaXMuJCRsaXN0ZW5lcnNbYV09Yz1bXSk7Yy5wdXNoKGIpO3ZhciBkPXRoaXM7ZG8gZC4kJGxpc3RlbmVyQ291bnRbYV18fChkLiQkbGlzdGVuZXJDb3VudFthXT0wKSxkLiQkbGlzdGVuZXJDb3VudFthXSsrO3doaWxlKGQ9ZC4kcGFyZW50KTt2YXIgZT10aGlzO3JldHVybiBmdW5jdGlvbigpe3ZhciBkPWMuaW5kZXhPZihiKTstMSE9PWQmJihjW2RdPW51bGwsbShlLDEsYSkpfX0sJGVtaXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz1bXSxkLGU9dGhpcyxnPSExLGg9e25hbWU6YSx0YXJnZXRTY29wZTplLHN0b3BQcm9wYWdhdGlvbjpmdW5jdGlvbigpe2c9ITB9LHByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKCl7aC5kZWZhdWx0UHJldmVudGVkPSEwfSxkZWZhdWx0UHJldmVudGVkOiExfSxcbmw9WWEoW2hdLGFyZ3VtZW50cywxKSxrLHA7ZG97ZD1lLiQkbGlzdGVuZXJzW2FdfHxjO2guY3VycmVudFNjb3BlPWU7az0wO2ZvcihwPWQubGVuZ3RoO2s8cDtrKyspaWYoZFtrXSl0cnl7ZFtrXS5hcHBseShudWxsLGwpfWNhdGNoKG0pe2YobSl9ZWxzZSBkLnNwbGljZShrLDEpLGstLSxwLS07aWYoZylyZXR1cm4gaC5jdXJyZW50U2NvcGU9bnVsbCxoO2U9ZS4kcGFyZW50fXdoaWxlKGUpO2guY3VycmVudFNjb3BlPW51bGw7cmV0dXJuIGh9LCRicm9hZGNhc3Q6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGQ9dGhpcyxlPXtuYW1lOmEsdGFyZ2V0U2NvcGU6dGhpcyxwcmV2ZW50RGVmYXVsdDpmdW5jdGlvbigpe2UuZGVmYXVsdFByZXZlbnRlZD0hMH0sZGVmYXVsdFByZXZlbnRlZDohMX07aWYoIXRoaXMuJCRsaXN0ZW5lckNvdW50W2FdKXJldHVybiBlO2Zvcih2YXIgZz1ZYShbZV0sYXJndW1lbnRzLDEpLGgsbDtjPWQ7KXtlLmN1cnJlbnRTY29wZT1jO2Q9Yy4kJGxpc3RlbmVyc1thXXx8XG5bXTtoPTA7Zm9yKGw9ZC5sZW5ndGg7aDxsO2grKylpZihkW2hdKXRyeXtkW2hdLmFwcGx5KG51bGwsZyl9Y2F0Y2goayl7ZihrKX1lbHNlIGQuc3BsaWNlKGgsMSksaC0tLGwtLTtpZighKGQ9Yy4kJGxpc3RlbmVyQ291bnRbYV0mJmMuJCRjaGlsZEhlYWR8fGMhPT10aGlzJiZjLiQkbmV4dFNpYmxpbmcpKWZvcig7YyE9PXRoaXMmJiEoZD1jLiQkbmV4dFNpYmxpbmcpOyljPWMuJHBhcmVudH1lLmN1cnJlbnRTY29wZT1udWxsO3JldHVybiBlfX07dmFyIHI9bmV3IGwsTz1yLiQkYXN5bmNRdWV1ZT1bXSxuPXIuJCRwb3N0RGlnZXN0UXVldWU9W10sdj1yLiQkYXBwbHlBc3luY1F1ZXVlPVtdO3JldHVybiByfV19ZnVuY3Rpb24gU2QoKXt2YXIgYj0vXlxccyooaHR0cHM/fGZ0cHxtYWlsdG98dGVsfGZpbGUpOi8sYT0vXlxccyooKGh0dHBzP3xmdHB8ZmlsZXxibG9iKTp8ZGF0YTppbWFnZVxcLykvO3RoaXMuYUhyZWZTYW5pdGl6YXRpb25XaGl0ZWxpc3Q9ZnVuY3Rpb24oYSl7cmV0dXJuIHkoYSk/XG4oYj1hLHRoaXMpOmJ9O3RoaXMuaW1nU3JjU2FuaXRpemF0aW9uV2hpdGVsaXN0PWZ1bmN0aW9uKGIpe3JldHVybiB5KGIpPyhhPWIsdGhpcyk6YX07dGhpcy4kZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGMsZCl7dmFyIGU9ZD9hOmIsZjtmPUJhKGMpLmhyZWY7cmV0dXJuXCJcIj09PWZ8fGYubWF0Y2goZSk/YzpcInVuc2FmZTpcIitmfX19ZnVuY3Rpb24gRGYoYil7aWYoXCJzZWxmXCI9PT1iKXJldHVybiBiO2lmKEYoYikpe2lmKC0xPGIuaW5kZXhPZihcIioqKlwiKSl0aHJvdyBDYShcIml3Y2FyZFwiLGIpO2I9Z2QoYikucmVwbGFjZShcIlxcXFwqXFxcXCpcIixcIi4qXCIpLnJlcGxhY2UoXCJcXFxcKlwiLFwiW146Ly4/JjtdKlwiKTtyZXR1cm4gbmV3IFJlZ0V4cChcIl5cIitiK1wiJFwiKX1pZihvYihiKSlyZXR1cm4gbmV3IFJlZ0V4cChcIl5cIitiLnNvdXJjZStcIiRcIik7dGhyb3cgQ2EoXCJpbWF0Y2hlclwiKTt9ZnVuY3Rpb24gaGQoYil7dmFyIGE9W107eShiKSYmcyhiLGZ1bmN0aW9uKGIpe2EucHVzaChEZihiKSl9KTtcbnJldHVybiBhfWZ1bmN0aW9uIFRlKCl7dGhpcy5TQ0VfQ09OVEVYVFM9bmE7dmFyIGI9W1wic2VsZlwiXSxhPVtdO3RoaXMucmVzb3VyY2VVcmxXaGl0ZWxpc3Q9ZnVuY3Rpb24oYSl7YXJndW1lbnRzLmxlbmd0aCYmKGI9aGQoYSkpO3JldHVybiBifTt0aGlzLnJlc291cmNlVXJsQmxhY2tsaXN0PWZ1bmN0aW9uKGIpe2FyZ3VtZW50cy5sZW5ndGgmJihhPWhkKGIpKTtyZXR1cm4gYX07dGhpcy4kZ2V0PVtcIiRpbmplY3RvclwiLGZ1bmN0aW9uKGMpe2Z1bmN0aW9uIGQoYSxiKXtyZXR1cm5cInNlbGZcIj09PWE/WmMoYik6ISFhLmV4ZWMoYi5ocmVmKX1mdW5jdGlvbiBlKGEpe3ZhciBiPWZ1bmN0aW9uKGEpe3RoaXMuJCR1bndyYXBUcnVzdGVkVmFsdWU9ZnVuY3Rpb24oKXtyZXR1cm4gYX19O2EmJihiLnByb3RvdHlwZT1uZXcgYSk7Yi5wcm90b3R5cGUudmFsdWVPZj1mdW5jdGlvbigpe3JldHVybiB0aGlzLiQkdW53cmFwVHJ1c3RlZFZhbHVlKCl9O2IucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJCR1bndyYXBUcnVzdGVkVmFsdWUoKS50b1N0cmluZygpfTtcbnJldHVybiBifXZhciBmPWZ1bmN0aW9uKGEpe3Rocm93IENhKFwidW5zYWZlXCIpO307Yy5oYXMoXCIkc2FuaXRpemVcIikmJihmPWMuZ2V0KFwiJHNhbml0aXplXCIpKTt2YXIgZz1lKCksaD17fTtoW25hLkhUTUxdPWUoZyk7aFtuYS5DU1NdPWUoZyk7aFtuYS5VUkxdPWUoZyk7aFtuYS5KU109ZShnKTtoW25hLlJFU09VUkNFX1VSTF09ZShoW25hLlVSTF0pO3JldHVybnt0cnVzdEFzOmZ1bmN0aW9uKGEsYil7dmFyIGM9aC5oYXNPd25Qcm9wZXJ0eShhKT9oW2FdOm51bGw7aWYoIWMpdGhyb3cgQ2EoXCJpY29udGV4dFwiLGEsYik7aWYobnVsbD09PWJ8fGI9PT10fHxcIlwiPT09YilyZXR1cm4gYjtpZihcInN0cmluZ1wiIT09dHlwZW9mIGIpdGhyb3cgQ2EoXCJpdHlwZVwiLGEpO3JldHVybiBuZXcgYyhiKX0sZ2V0VHJ1c3RlZDpmdW5jdGlvbihjLGUpe2lmKG51bGw9PT1lfHxlPT09dHx8XCJcIj09PWUpcmV0dXJuIGU7dmFyIGc9aC5oYXNPd25Qcm9wZXJ0eShjKT9oW2NdOm51bGw7aWYoZyYmZSBpbnN0YW5jZW9mXG5nKXJldHVybiBlLiQkdW53cmFwVHJ1c3RlZFZhbHVlKCk7aWYoYz09PW5hLlJFU09VUkNFX1VSTCl7dmFyIGc9QmEoZS50b1N0cmluZygpKSxwLHEsdT0hMTtwPTA7Zm9yKHE9Yi5sZW5ndGg7cDxxO3ArKylpZihkKGJbcF0sZykpe3U9ITA7YnJlYWt9aWYodSlmb3IocD0wLHE9YS5sZW5ndGg7cDxxO3ArKylpZihkKGFbcF0sZykpe3U9ITE7YnJlYWt9aWYodSlyZXR1cm4gZTt0aHJvdyBDYShcImluc2VjdXJsXCIsZS50b1N0cmluZygpKTt9aWYoYz09PW5hLkhUTUwpcmV0dXJuIGYoZSk7dGhyb3cgQ2EoXCJ1bnNhZmVcIik7fSx2YWx1ZU9mOmZ1bmN0aW9uKGEpe3JldHVybiBhIGluc3RhbmNlb2YgZz9hLiQkdW53cmFwVHJ1c3RlZFZhbHVlKCk6YX19fV19ZnVuY3Rpb24gU2UoKXt2YXIgYj0hMDt0aGlzLmVuYWJsZWQ9ZnVuY3Rpb24oYSl7YXJndW1lbnRzLmxlbmd0aCYmKGI9ISFhKTtyZXR1cm4gYn07dGhpcy4kZ2V0PVtcIiRwYXJzZVwiLFwiJHNjZURlbGVnYXRlXCIsZnVuY3Rpb24oYSxjKXtpZihiJiZcbjg+UmEpdGhyb3cgQ2EoXCJpZXF1aXJrc1wiKTt2YXIgZD1yYShuYSk7ZC5pc0VuYWJsZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gYn07ZC50cnVzdEFzPWMudHJ1c3RBcztkLmdldFRydXN0ZWQ9Yy5nZXRUcnVzdGVkO2QudmFsdWVPZj1jLnZhbHVlT2Y7Ynx8KGQudHJ1c3RBcz1kLmdldFRydXN0ZWQ9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYn0sZC52YWx1ZU9mPXBhKTtkLnBhcnNlQXM9ZnVuY3Rpb24oYixjKXt2YXIgZT1hKGMpO3JldHVybiBlLmxpdGVyYWwmJmUuY29uc3RhbnQ/ZTphKGMsZnVuY3Rpb24oYSl7cmV0dXJuIGQuZ2V0VHJ1c3RlZChiLGEpfSl9O3ZhciBlPWQucGFyc2VBcyxmPWQuZ2V0VHJ1c3RlZCxnPWQudHJ1c3RBcztzKG5hLGZ1bmN0aW9uKGEsYil7dmFyIGM9UShiKTtkW2NiKFwicGFyc2VfYXNfXCIrYyldPWZ1bmN0aW9uKGIpe3JldHVybiBlKGEsYil9O2RbY2IoXCJnZXRfdHJ1c3RlZF9cIitjKV09ZnVuY3Rpb24oYil7cmV0dXJuIGYoYSxiKX07ZFtjYihcInRydXN0X2FzX1wiK1xuYyldPWZ1bmN0aW9uKGIpe3JldHVybiBnKGEsYil9fSk7cmV0dXJuIGR9XX1mdW5jdGlvbiBVZSgpe3RoaXMuJGdldD1bXCIkd2luZG93XCIsXCIkZG9jdW1lbnRcIixmdW5jdGlvbihiLGEpe3ZhciBjPXt9LGQ9YmEoKC9hbmRyb2lkIChcXGQrKS8uZXhlYyhRKChiLm5hdmlnYXRvcnx8e30pLnVzZXJBZ2VudCkpfHxbXSlbMV0pLGU9L0JveGVlL2kudGVzdCgoYi5uYXZpZ2F0b3J8fHt9KS51c2VyQWdlbnQpLGY9YVswXXx8e30sZyxoPS9eKE1venx3ZWJraXR8bXMpKD89W0EtWl0pLyxsPWYuYm9keSYmZi5ib2R5LnN0eWxlLGs9ITEsbT0hMTtpZihsKXtmb3IodmFyIHAgaW4gbClpZihrPWguZXhlYyhwKSl7Zz1rWzBdO2c9Zy5zdWJzdHIoMCwxKS50b1VwcGVyQ2FzZSgpK2cuc3Vic3RyKDEpO2JyZWFrfWd8fChnPVwiV2Via2l0T3BhY2l0eVwiaW4gbCYmXCJ3ZWJraXRcIik7az0hIShcInRyYW5zaXRpb25cImluIGx8fGcrXCJUcmFuc2l0aW9uXCJpbiBsKTttPSEhKFwiYW5pbWF0aW9uXCJpbiBsfHxnK1wiQW5pbWF0aW9uXCJpblxubCk7IWR8fGsmJm18fChrPUYoZi5ib2R5LnN0eWxlLndlYmtpdFRyYW5zaXRpb24pLG09RihmLmJvZHkuc3R5bGUud2Via2l0QW5pbWF0aW9uKSl9cmV0dXJue2hpc3Rvcnk6ISghYi5oaXN0b3J5fHwhYi5oaXN0b3J5LnB1c2hTdGF0ZXx8ND5kfHxlKSxoYXNFdmVudDpmdW5jdGlvbihhKXtpZihcImlucHV0XCI9PT1hJiYxMT49UmEpcmV0dXJuITE7aWYoQShjW2FdKSl7dmFyIGI9Zi5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO2NbYV09XCJvblwiK2EgaW4gYn1yZXR1cm4gY1thXX0sY3NwOmFiKCksdmVuZG9yUHJlZml4OmcsdHJhbnNpdGlvbnM6ayxhbmltYXRpb25zOm0sYW5kcm9pZDpkfX1dfWZ1bmN0aW9uIFdlKCl7dGhpcy4kZ2V0PVtcIiR0ZW1wbGF0ZUNhY2hlXCIsXCIkaHR0cFwiLFwiJHFcIixmdW5jdGlvbihiLGEsYyl7ZnVuY3Rpb24gZChlLGYpe2QudG90YWxQZW5kaW5nUmVxdWVzdHMrKzt2YXIgZz1hLmRlZmF1bHRzJiZhLmRlZmF1bHRzLnRyYW5zZm9ybVJlc3BvbnNlO0QoZyk/Zz1nLmZpbHRlcihmdW5jdGlvbihhKXtyZXR1cm4gYSE9PVxuWWJ9KTpnPT09WWImJihnPW51bGwpO3JldHVybiBhLmdldChlLHtjYWNoZTpiLHRyYW5zZm9ybVJlc3BvbnNlOmd9KS50aGVuKGZ1bmN0aW9uKGEpe2QudG90YWxQZW5kaW5nUmVxdWVzdHMtLTtyZXR1cm4gYS5kYXRhfSxmdW5jdGlvbihhKXtkLnRvdGFsUGVuZGluZ1JlcXVlc3RzLS07aWYoIWYpdGhyb3cgamEoXCJ0cGxvYWRcIixlKTtyZXR1cm4gYy5yZWplY3QoYSl9KX1kLnRvdGFsUGVuZGluZ1JlcXVlc3RzPTA7cmV0dXJuIGR9XX1mdW5jdGlvbiBYZSgpe3RoaXMuJGdldD1bXCIkcm9vdFNjb3BlXCIsXCIkYnJvd3NlclwiLFwiJGxvY2F0aW9uXCIsZnVuY3Rpb24oYixhLGMpe3JldHVybntmaW5kQmluZGluZ3M6ZnVuY3Rpb24oYSxiLGMpe2E9YS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwibmctYmluZGluZ1wiKTt2YXIgZz1bXTtzKGEsZnVuY3Rpb24oYSl7dmFyIGQ9Z2EuZWxlbWVudChhKS5kYXRhKFwiJGJpbmRpbmdcIik7ZCYmcyhkLGZ1bmN0aW9uKGQpe2M/KG5ldyBSZWdFeHAoXCIoXnxcXFxccylcIitcbmdkKGIpK1wiKFxcXFxzfFxcXFx8fCQpXCIpKS50ZXN0KGQpJiZnLnB1c2goYSk6LTEhPWQuaW5kZXhPZihiKSYmZy5wdXNoKGEpfSl9KTtyZXR1cm4gZ30sZmluZE1vZGVsczpmdW5jdGlvbihhLGIsYyl7Zm9yKHZhciBnPVtcIm5nLVwiLFwiZGF0YS1uZy1cIixcIm5nXFxcXDpcIl0saD0wO2g8Zy5sZW5ndGg7KytoKXt2YXIgbD1hLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbXCIrZ1toXStcIm1vZGVsXCIrKGM/XCI9XCI6XCIqPVwiKSsnXCInK2IrJ1wiXScpO2lmKGwubGVuZ3RoKXJldHVybiBsfX0sZ2V0TG9jYXRpb246ZnVuY3Rpb24oKXtyZXR1cm4gYy51cmwoKX0sc2V0TG9jYXRpb246ZnVuY3Rpb24oYSl7YSE9PWMudXJsKCkmJihjLnVybChhKSxiLiRkaWdlc3QoKSl9LHdoZW5TdGFibGU6ZnVuY3Rpb24oYil7YS5ub3RpZnlXaGVuTm9PdXRzdGFuZGluZ1JlcXVlc3RzKGIpfX19XX1mdW5jdGlvbiBZZSgpe3RoaXMuJGdldD1bXCIkcm9vdFNjb3BlXCIsXCIkYnJvd3NlclwiLFwiJHFcIixcIiQkcVwiLFwiJGV4Y2VwdGlvbkhhbmRsZXJcIixcbmZ1bmN0aW9uKGIsYSxjLGQsZSl7ZnVuY3Rpb24gZihmLGwsayl7dmFyIG09eShrKSYmIWsscD0obT9kOmMpLmRlZmVyKCkscT1wLnByb21pc2U7bD1hLmRlZmVyKGZ1bmN0aW9uKCl7dHJ5e3AucmVzb2x2ZShmKCkpfWNhdGNoKGEpe3AucmVqZWN0KGEpLGUoYSl9ZmluYWxseXtkZWxldGUgZ1txLiQkdGltZW91dElkXX1tfHxiLiRhcHBseSgpfSxsKTtxLiQkdGltZW91dElkPWw7Z1tsXT1wO3JldHVybiBxfXZhciBnPXt9O2YuY2FuY2VsPWZ1bmN0aW9uKGIpe3JldHVybiBiJiZiLiQkdGltZW91dElkIGluIGc/KGdbYi4kJHRpbWVvdXRJZF0ucmVqZWN0KFwiY2FuY2VsZWRcIiksZGVsZXRlIGdbYi4kJHRpbWVvdXRJZF0sYS5kZWZlci5jYW5jZWwoYi4kJHRpbWVvdXRJZCkpOiExfTtyZXR1cm4gZn1dfWZ1bmN0aW9uIEJhKGIpe1JhJiYoWi5zZXRBdHRyaWJ1dGUoXCJocmVmXCIsYiksYj1aLmhyZWYpO1ouc2V0QXR0cmlidXRlKFwiaHJlZlwiLGIpO3JldHVybntocmVmOlouaHJlZixwcm90b2NvbDpaLnByb3RvY29sP1xuWi5wcm90b2NvbC5yZXBsYWNlKC86JC8sXCJcIik6XCJcIixob3N0OlouaG9zdCxzZWFyY2g6Wi5zZWFyY2g/Wi5zZWFyY2gucmVwbGFjZSgvXlxcPy8sXCJcIik6XCJcIixoYXNoOlouaGFzaD9aLmhhc2gucmVwbGFjZSgvXiMvLFwiXCIpOlwiXCIsaG9zdG5hbWU6Wi5ob3N0bmFtZSxwb3J0OloucG9ydCxwYXRobmFtZTpcIi9cIj09PVoucGF0aG5hbWUuY2hhckF0KDApP1oucGF0aG5hbWU6XCIvXCIrWi5wYXRobmFtZX19ZnVuY3Rpb24gWmMoYil7Yj1GKGIpP0JhKGIpOmI7cmV0dXJuIGIucHJvdG9jb2w9PT1pZC5wcm90b2NvbCYmYi5ob3N0PT09aWQuaG9zdH1mdW5jdGlvbiBaZSgpe3RoaXMuJGdldD1kYShNKX1mdW5jdGlvbiBEYyhiKXtmdW5jdGlvbiBhKGMsZCl7aWYoSShjKSl7dmFyIGU9e307cyhjLGZ1bmN0aW9uKGIsYyl7ZVtjXT1hKGMsYil9KTtyZXR1cm4gZX1yZXR1cm4gYi5mYWN0b3J5KGMrXCJGaWx0ZXJcIixkKX10aGlzLnJlZ2lzdGVyPWE7dGhpcy4kZ2V0PVtcIiRpbmplY3RvclwiLGZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gYS5nZXQoYitcblwiRmlsdGVyXCIpfX1dO2EoXCJjdXJyZW5jeVwiLGpkKTthKFwiZGF0ZVwiLGtkKTthKFwiZmlsdGVyXCIsRWYpO2EoXCJqc29uXCIsRmYpO2EoXCJsaW1pdFRvXCIsR2YpO2EoXCJsb3dlcmNhc2VcIixIZik7YShcIm51bWJlclwiLGxkKTthKFwib3JkZXJCeVwiLG1kKTthKFwidXBwZXJjYXNlXCIsSWYpfWZ1bmN0aW9uIEVmKCl7cmV0dXJuIGZ1bmN0aW9uKGIsYSxjKXtpZighRChiKSlyZXR1cm4gYjt2YXIgZDtzd2l0Y2godHlwZW9mIGEpe2Nhc2UgXCJmdW5jdGlvblwiOmJyZWFrO2Nhc2UgXCJib29sZWFuXCI6Y2FzZSBcIm51bWJlclwiOmNhc2UgXCJzdHJpbmdcIjpkPSEwO2Nhc2UgXCJvYmplY3RcIjphPUpmKGEsYyxkKTticmVhaztkZWZhdWx0OnJldHVybiBifXJldHVybiBiLmZpbHRlcihhKX19ZnVuY3Rpb24gSmYoYixhLGMpe3ZhciBkPUkoYikmJlwiJFwiaW4gYjshMD09PWE/YT1mYTpHKGEpfHwoYT1mdW5jdGlvbihhLGIpe2lmKEkoYSl8fEkoYikpcmV0dXJuITE7YT1RKFwiXCIrYSk7Yj1RKFwiXCIrYik7cmV0dXJuLTEhPT1hLmluZGV4T2YoYil9KTtcbnJldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gZCYmIUkoZSk/SWEoZSxiLiQsYSwhMSk6SWEoZSxiLGEsYyl9fWZ1bmN0aW9uIElhKGIsYSxjLGQsZSl7dmFyIGY9dHlwZW9mIGIsZz10eXBlb2YgYTtpZihcInN0cmluZ1wiPT09ZyYmXCIhXCI9PT1hLmNoYXJBdCgwKSlyZXR1cm4hSWEoYixhLnN1YnN0cmluZygxKSxjLGQpO2lmKEQoYikpcmV0dXJuIGIuc29tZShmdW5jdGlvbihiKXtyZXR1cm4gSWEoYixhLGMsZCl9KTtzd2l0Y2goZil7Y2FzZSBcIm9iamVjdFwiOnZhciBoO2lmKGQpe2ZvcihoIGluIGIpaWYoXCIkXCIhPT1oLmNoYXJBdCgwKSYmSWEoYltoXSxhLGMsITApKXJldHVybiEwO3JldHVybiBlPyExOklhKGIsYSxjLCExKX1pZihcIm9iamVjdFwiPT09Zyl7Zm9yKGggaW4gYSlpZihlPWFbaF0sIUcoZSkmJihmPVwiJFwiPT09aCwhSWEoZj9iOmJbaF0sZSxjLGYsZikpKXJldHVybiExO3JldHVybiEwfXJldHVybiBjKGIsYSk7Y2FzZSBcImZ1bmN0aW9uXCI6cmV0dXJuITE7ZGVmYXVsdDpyZXR1cm4gYyhiLFxuYSl9fWZ1bmN0aW9uIGpkKGIpe3ZhciBhPWIuTlVNQkVSX0ZPUk1BVFM7cmV0dXJuIGZ1bmN0aW9uKGIsZCxlKXtBKGQpJiYoZD1hLkNVUlJFTkNZX1NZTSk7QShlKSYmKGU9YS5QQVRURVJOU1sxXS5tYXhGcmFjKTtyZXR1cm4gbnVsbD09Yj9iOm5kKGIsYS5QQVRURVJOU1sxXSxhLkdST1VQX1NFUCxhLkRFQ0lNQUxfU0VQLGUpLnJlcGxhY2UoL1xcdTAwQTQvZyxkKX19ZnVuY3Rpb24gbGQoYil7dmFyIGE9Yi5OVU1CRVJfRk9STUFUUztyZXR1cm4gZnVuY3Rpb24oYixkKXtyZXR1cm4gbnVsbD09Yj9iOm5kKGIsYS5QQVRURVJOU1swXSxhLkdST1VQX1NFUCxhLkRFQ0lNQUxfU0VQLGQpfX1mdW5jdGlvbiBuZChiLGEsYyxkLGUpe2lmKCFpc0Zpbml0ZShiKXx8SShiKSlyZXR1cm5cIlwiO3ZhciBmPTA+YjtiPU1hdGguYWJzKGIpO3ZhciBnPWIrXCJcIixoPVwiXCIsbD1bXSxrPSExO2lmKC0xIT09Zy5pbmRleE9mKFwiZVwiKSl7dmFyIG09Zy5tYXRjaCgvKFtcXGRcXC5dKyllKC0/KShcXGQrKS8pO20mJlxuXCItXCI9PW1bMl0mJm1bM10+ZSsxP2I9MDooaD1nLGs9ITApfWlmKGspMDxlJiYxPmImJihoPWIudG9GaXhlZChlKSxiPXBhcnNlRmxvYXQoaCkpO2Vsc2V7Zz0oZy5zcGxpdChvZClbMV18fFwiXCIpLmxlbmd0aDtBKGUpJiYoZT1NYXRoLm1pbihNYXRoLm1heChhLm1pbkZyYWMsZyksYS5tYXhGcmFjKSk7Yj0rKE1hdGgucm91bmQoKyhiLnRvU3RyaW5nKCkrXCJlXCIrZSkpLnRvU3RyaW5nKCkrXCJlXCIrLWUpO3ZhciBnPShcIlwiK2IpLnNwbGl0KG9kKSxrPWdbMF0sZz1nWzFdfHxcIlwiLHA9MCxxPWEubGdTaXplLHU9YS5nU2l6ZTtpZihrLmxlbmd0aD49cSt1KWZvcihwPWsubGVuZ3RoLXEsbT0wO208cDttKyspMD09PShwLW0pJXUmJjAhPT1tJiYoaCs9YyksaCs9ay5jaGFyQXQobSk7Zm9yKG09cDttPGsubGVuZ3RoO20rKykwPT09KGsubGVuZ3RoLW0pJXEmJjAhPT1tJiYoaCs9YyksaCs9ay5jaGFyQXQobSk7Zm9yKDtnLmxlbmd0aDxlOylnKz1cIjBcIjtlJiZcIjBcIiE9PWUmJihoKz1kK2cuc3Vic3RyKDAsXG5lKSl9MD09PWImJihmPSExKTtsLnB1c2goZj9hLm5lZ1ByZTphLnBvc1ByZSxoLGY/YS5uZWdTdWY6YS5wb3NTdWYpO3JldHVybiBsLmpvaW4oXCJcIil9ZnVuY3Rpb24gSGIoYixhLGMpe3ZhciBkPVwiXCI7MD5iJiYoZD1cIi1cIixiPS1iKTtmb3IoYj1cIlwiK2I7Yi5sZW5ndGg8YTspYj1cIjBcIitiO2MmJihiPWIuc3Vic3RyKGIubGVuZ3RoLWEpKTtyZXR1cm4gZCtifWZ1bmN0aW9uICQoYixhLGMsZCl7Yz1jfHwwO3JldHVybiBmdW5jdGlvbihlKXtlPWVbXCJnZXRcIitiXSgpO2lmKDA8Y3x8ZT4tYyllKz1jOzA9PT1lJiYtMTI9PWMmJihlPTEyKTtyZXR1cm4gSGIoZSxhLGQpfX1mdW5jdGlvbiBJYihiLGEpe3JldHVybiBmdW5jdGlvbihjLGQpe3ZhciBlPWNbXCJnZXRcIitiXSgpLGY9dWIoYT9cIlNIT1JUXCIrYjpiKTtyZXR1cm4gZFtmXVtlXX19ZnVuY3Rpb24gcGQoYil7dmFyIGE9KG5ldyBEYXRlKGIsMCwxKSkuZ2V0RGF5KCk7cmV0dXJuIG5ldyBEYXRlKGIsMCwoND49YT81OjEyKS1hKX1mdW5jdGlvbiBxZChiKXtyZXR1cm4gZnVuY3Rpb24oYSl7dmFyIGM9XG5wZChhLmdldEZ1bGxZZWFyKCkpO2E9K25ldyBEYXRlKGEuZ2V0RnVsbFllYXIoKSxhLmdldE1vbnRoKCksYS5nZXREYXRlKCkrKDQtYS5nZXREYXkoKSkpLStjO2E9MStNYXRoLnJvdW5kKGEvNjA0OEU1KTtyZXR1cm4gSGIoYSxiKX19ZnVuY3Rpb24ga2QoYil7ZnVuY3Rpb24gYShhKXt2YXIgYjtpZihiPWEubWF0Y2goYykpe2E9bmV3IERhdGUoMCk7dmFyIGY9MCxnPTAsaD1iWzhdP2Euc2V0VVRDRnVsbFllYXI6YS5zZXRGdWxsWWVhcixsPWJbOF0/YS5zZXRVVENIb3VyczphLnNldEhvdXJzO2JbOV0mJihmPWJhKGJbOV0rYlsxMF0pLGc9YmEoYls5XStiWzExXSkpO2guY2FsbChhLGJhKGJbMV0pLGJhKGJbMl0pLTEsYmEoYlszXSkpO2Y9YmEoYls0XXx8MCktZjtnPWJhKGJbNV18fDApLWc7aD1iYShiWzZdfHwwKTtiPU1hdGgucm91bmQoMUUzKnBhcnNlRmxvYXQoXCIwLlwiKyhiWzddfHwwKSkpO2wuY2FsbChhLGYsZyxoLGIpfXJldHVybiBhfXZhciBjPS9eKFxcZHs0fSktPyhcXGRcXGQpLT8oXFxkXFxkKSg/OlQoXFxkXFxkKSg/Ojo/KFxcZFxcZCkoPzo6PyhcXGRcXGQpKD86XFwuKFxcZCspKT8pPyk/KFp8KFsrLV0pKFxcZFxcZCk6PyhcXGRcXGQpKT8pPyQvO1xucmV0dXJuIGZ1bmN0aW9uKGMsZSxmKXt2YXIgZz1cIlwiLGg9W10sbCxrO2U9ZXx8XCJtZWRpdW1EYXRlXCI7ZT1iLkRBVEVUSU1FX0ZPUk1BVFNbZV18fGU7RihjKSYmKGM9S2YudGVzdChjKT9iYShjKTphKGMpKTtWKGMpJiYoYz1uZXcgRGF0ZShjKSk7aWYoIXFhKGMpKXJldHVybiBjO2Zvcig7ZTspKGs9TGYuZXhlYyhlKSk/KGg9WWEoaCxrLDEpLGU9aC5wb3AoKSk6KGgucHVzaChlKSxlPW51bGwpO2YmJlwiVVRDXCI9PT1mJiYoYz1uZXcgRGF0ZShjLmdldFRpbWUoKSksYy5zZXRNaW51dGVzKGMuZ2V0TWludXRlcygpK2MuZ2V0VGltZXpvbmVPZmZzZXQoKSkpO3MoaCxmdW5jdGlvbihhKXtsPU1mW2FdO2crPWw/bChjLGIuREFURVRJTUVfRk9STUFUUyk6YS5yZXBsYWNlKC8oXid8JyQpL2csXCJcIikucmVwbGFjZSgvJycvZyxcIidcIil9KTtyZXR1cm4gZ319ZnVuY3Rpb24gRmYoKXtyZXR1cm4gZnVuY3Rpb24oYixhKXtBKGEpJiYoYT0yKTtyZXR1cm4gJGEoYixhKX19ZnVuY3Rpb24gR2YoKXtyZXR1cm4gZnVuY3Rpb24oYixcbmEpe1YoYikmJihiPWIudG9TdHJpbmcoKSk7cmV0dXJuIEQoYil8fEYoYik/KGE9SW5maW5pdHk9PT1NYXRoLmFicyhOdW1iZXIoYSkpP051bWJlcihhKTpiYShhKSk/MDxhP2Iuc2xpY2UoMCxhKTpiLnNsaWNlKGEpOkYoYik/XCJcIjpbXTpifX1mdW5jdGlvbiBtZChiKXtyZXR1cm4gZnVuY3Rpb24oYSxjLGQpe2Z1bmN0aW9uIGUoYSxiKXtyZXR1cm4gYj9mdW5jdGlvbihiLGMpe3JldHVybiBhKGMsYil9OmF9ZnVuY3Rpb24gZihhKXtzd2l0Y2godHlwZW9mIGEpe2Nhc2UgXCJudW1iZXJcIjpjYXNlIFwiYm9vbGVhblwiOmNhc2UgXCJzdHJpbmdcIjpyZXR1cm4hMDtkZWZhdWx0OnJldHVybiExfX1mdW5jdGlvbiBnKGEpe3JldHVybiBudWxsPT09YT9cIm51bGxcIjpcImZ1bmN0aW9uXCI9PT10eXBlb2YgYS52YWx1ZU9mJiYoYT1hLnZhbHVlT2YoKSxmKGEpKXx8XCJmdW5jdGlvblwiPT09dHlwZW9mIGEudG9TdHJpbmcmJihhPWEudG9TdHJpbmcoKSxmKGEpKT9hOlwiXCJ9ZnVuY3Rpb24gaChhLGIpe3ZhciBjPVxudHlwZW9mIGEsZD10eXBlb2YgYjtjPT09ZCYmXCJvYmplY3RcIj09PWMmJihhPWcoYSksYj1nKGIpKTtyZXR1cm4gYz09PWQ/KFwic3RyaW5nXCI9PT1jJiYoYT1hLnRvTG93ZXJDYXNlKCksYj1iLnRvTG93ZXJDYXNlKCkpLGE9PT1iPzA6YTxiPy0xOjEpOmM8ZD8tMToxfWlmKCFUYShhKSlyZXR1cm4gYTtjPUQoYyk/YzpbY107MD09PWMubGVuZ3RoJiYoYz1bXCIrXCJdKTtjPWMubWFwKGZ1bmN0aW9uKGEpe3ZhciBjPSExLGQ9YXx8cGE7aWYoRihhKSl7aWYoXCIrXCI9PWEuY2hhckF0KDApfHxcIi1cIj09YS5jaGFyQXQoMCkpYz1cIi1cIj09YS5jaGFyQXQoMCksYT1hLnN1YnN0cmluZygxKTtpZihcIlwiPT09YSlyZXR1cm4gZShoLGMpO2Q9YihhKTtpZihkLmNvbnN0YW50KXt2YXIgZj1kKCk7cmV0dXJuIGUoZnVuY3Rpb24oYSxiKXtyZXR1cm4gaChhW2ZdLGJbZl0pfSxjKX19cmV0dXJuIGUoZnVuY3Rpb24oYSxiKXtyZXR1cm4gaChkKGEpLGQoYikpfSxjKX0pO3JldHVybiBaYS5jYWxsKGEpLnNvcnQoZShmdW5jdGlvbihhLFxuYil7Zm9yKHZhciBkPTA7ZDxjLmxlbmd0aDtkKyspe3ZhciBlPWNbZF0oYSxiKTtpZigwIT09ZSlyZXR1cm4gZX1yZXR1cm4gMH0sZCkpfX1mdW5jdGlvbiBKYShiKXtHKGIpJiYoYj17bGluazpifSk7Yi5yZXN0cmljdD1iLnJlc3RyaWN0fHxcIkFDXCI7cmV0dXJuIGRhKGIpfWZ1bmN0aW9uIHJkKGIsYSxjLGQsZSl7dmFyIGY9dGhpcyxnPVtdLGg9Zi4kJHBhcmVudEZvcm09Yi5wYXJlbnQoKS5jb250cm9sbGVyKFwiZm9ybVwiKXx8SmI7Zi4kZXJyb3I9e307Zi4kJHN1Y2Nlc3M9e307Zi4kcGVuZGluZz10O2YuJG5hbWU9ZShhLm5hbWV8fGEubmdGb3JtfHxcIlwiKShjKTtmLiRkaXJ0eT0hMTtmLiRwcmlzdGluZT0hMDtmLiR2YWxpZD0hMDtmLiRpbnZhbGlkPSExO2YuJHN1Ym1pdHRlZD0hMTtoLiRhZGRDb250cm9sKGYpO2YuJHJvbGxiYWNrVmlld1ZhbHVlPWZ1bmN0aW9uKCl7cyhnLGZ1bmN0aW9uKGEpe2EuJHJvbGxiYWNrVmlld1ZhbHVlKCl9KX07Zi4kY29tbWl0Vmlld1ZhbHVlPWZ1bmN0aW9uKCl7cyhnLFxuZnVuY3Rpb24oYSl7YS4kY29tbWl0Vmlld1ZhbHVlKCl9KX07Zi4kYWRkQ29udHJvbD1mdW5jdGlvbihhKXtNYShhLiRuYW1lLFwiaW5wdXRcIik7Zy5wdXNoKGEpO2EuJG5hbWUmJihmW2EuJG5hbWVdPWEpfTtmLiQkcmVuYW1lQ29udHJvbD1mdW5jdGlvbihhLGIpe3ZhciBjPWEuJG5hbWU7ZltjXT09PWEmJmRlbGV0ZSBmW2NdO2ZbYl09YTthLiRuYW1lPWJ9O2YuJHJlbW92ZUNvbnRyb2w9ZnVuY3Rpb24oYSl7YS4kbmFtZSYmZlthLiRuYW1lXT09PWEmJmRlbGV0ZSBmW2EuJG5hbWVdO3MoZi4kcGVuZGluZyxmdW5jdGlvbihiLGMpe2YuJHNldFZhbGlkaXR5KGMsbnVsbCxhKX0pO3MoZi4kZXJyb3IsZnVuY3Rpb24oYixjKXtmLiRzZXRWYWxpZGl0eShjLG51bGwsYSl9KTtYYShnLGEpfTtzZCh7Y3RybDp0aGlzLCRlbGVtZW50OmIsc2V0OmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1hW2JdO2Q/LTE9PT1kLmluZGV4T2YoYykmJmQucHVzaChjKTphW2JdPVtjXX0sdW5zZXQ6ZnVuY3Rpb24oYSxcbmIsYyl7dmFyIGQ9YVtiXTtkJiYoWGEoZCxjKSwwPT09ZC5sZW5ndGgmJmRlbGV0ZSBhW2JdKX0scGFyZW50Rm9ybTpoLCRhbmltYXRlOmR9KTtmLiRzZXREaXJ0eT1mdW5jdGlvbigpe2QucmVtb3ZlQ2xhc3MoYixTYSk7ZC5hZGRDbGFzcyhiLEtiKTtmLiRkaXJ0eT0hMDtmLiRwcmlzdGluZT0hMTtoLiRzZXREaXJ0eSgpfTtmLiRzZXRQcmlzdGluZT1mdW5jdGlvbigpe2Quc2V0Q2xhc3MoYixTYSxLYitcIiBuZy1zdWJtaXR0ZWRcIik7Zi4kZGlydHk9ITE7Zi4kcHJpc3RpbmU9ITA7Zi4kc3VibWl0dGVkPSExO3MoZyxmdW5jdGlvbihhKXthLiRzZXRQcmlzdGluZSgpfSl9O2YuJHNldFVudG91Y2hlZD1mdW5jdGlvbigpe3MoZyxmdW5jdGlvbihhKXthLiRzZXRVbnRvdWNoZWQoKX0pfTtmLiRzZXRTdWJtaXR0ZWQ9ZnVuY3Rpb24oKXtkLmFkZENsYXNzKGIsXCJuZy1zdWJtaXR0ZWRcIik7Zi4kc3VibWl0dGVkPSEwO2guJHNldFN1Ym1pdHRlZCgpfX1mdW5jdGlvbiBoYyhiKXtiLiRmb3JtYXR0ZXJzLnB1c2goZnVuY3Rpb24oYSl7cmV0dXJuIGIuJGlzRW1wdHkoYSk/XG5hOmEudG9TdHJpbmcoKX0pfWZ1bmN0aW9uIGliKGIsYSxjLGQsZSxmKXt2YXIgZz1RKGFbMF0udHlwZSk7aWYoIWUuYW5kcm9pZCl7dmFyIGg9ITE7YS5vbihcImNvbXBvc2l0aW9uc3RhcnRcIixmdW5jdGlvbihhKXtoPSEwfSk7YS5vbihcImNvbXBvc2l0aW9uZW5kXCIsZnVuY3Rpb24oKXtoPSExO2woKX0pfXZhciBsPWZ1bmN0aW9uKGIpe2smJihmLmRlZmVyLmNhbmNlbChrKSxrPW51bGwpO2lmKCFoKXt2YXIgZT1hLnZhbCgpO2I9YiYmYi50eXBlO1wicGFzc3dvcmRcIj09PWd8fGMubmdUcmltJiZcImZhbHNlXCI9PT1jLm5nVHJpbXx8KGU9VShlKSk7KGQuJHZpZXdWYWx1ZSE9PWV8fFwiXCI9PT1lJiZkLiQkaGFzTmF0aXZlVmFsaWRhdG9ycykmJmQuJHNldFZpZXdWYWx1ZShlLGIpfX07aWYoZS5oYXNFdmVudChcImlucHV0XCIpKWEub24oXCJpbnB1dFwiLGwpO2Vsc2V7dmFyIGssbT1mdW5jdGlvbihhLGIsYyl7a3x8KGs9Zi5kZWZlcihmdW5jdGlvbigpe2s9bnVsbDtiJiZiLnZhbHVlPT09Y3x8bChhKX0pKX07XG5hLm9uKFwia2V5ZG93blwiLGZ1bmN0aW9uKGEpe3ZhciBiPWEua2V5Q29kZTs5MT09PWJ8fDE1PGImJjE5PmJ8fDM3PD1iJiY0MD49Ynx8bShhLHRoaXMsdGhpcy52YWx1ZSl9KTtpZihlLmhhc0V2ZW50KFwicGFzdGVcIikpYS5vbihcInBhc3RlIGN1dFwiLG0pfWEub24oXCJjaGFuZ2VcIixsKTtkLiRyZW5kZXI9ZnVuY3Rpb24oKXthLnZhbChkLiRpc0VtcHR5KGQuJHZpZXdWYWx1ZSk/XCJcIjpkLiR2aWV3VmFsdWUpfX1mdW5jdGlvbiBMYihiLGEpe3JldHVybiBmdW5jdGlvbihjLGQpe3ZhciBlLGY7aWYocWEoYykpcmV0dXJuIGM7aWYoRihjKSl7J1wiJz09Yy5jaGFyQXQoMCkmJidcIic9PWMuY2hhckF0KGMubGVuZ3RoLTEpJiYoYz1jLnN1YnN0cmluZygxLGMubGVuZ3RoLTEpKTtpZihOZi50ZXN0KGMpKXJldHVybiBuZXcgRGF0ZShjKTtiLmxhc3RJbmRleD0wO2lmKGU9Yi5leGVjKGMpKXJldHVybiBlLnNoaWZ0KCksZj1kP3t5eXl5OmQuZ2V0RnVsbFllYXIoKSxNTTpkLmdldE1vbnRoKCkrMSxcbmRkOmQuZ2V0RGF0ZSgpLEhIOmQuZ2V0SG91cnMoKSxtbTpkLmdldE1pbnV0ZXMoKSxzczpkLmdldFNlY29uZHMoKSxzc3M6ZC5nZXRNaWxsaXNlY29uZHMoKS8xRTN9Ont5eXl5OjE5NzAsTU06MSxkZDoxLEhIOjAsbW06MCxzczowLHNzczowfSxzKGUsZnVuY3Rpb24oYixjKXtjPGEubGVuZ3RoJiYoZlthW2NdXT0rYil9KSxuZXcgRGF0ZShmLnl5eXksZi5NTS0xLGYuZGQsZi5ISCxmLm1tLGYuc3N8fDAsMUUzKmYuc3NzfHwwKX1yZXR1cm4gTmFOfX1mdW5jdGlvbiBqYihiLGEsYyxkKXtyZXR1cm4gZnVuY3Rpb24oZSxmLGcsaCxsLGssbSl7ZnVuY3Rpb24gcChhKXtyZXR1cm4gYSYmIShhLmdldFRpbWUmJmEuZ2V0VGltZSgpIT09YS5nZXRUaW1lKCkpfWZ1bmN0aW9uIHEoYSl7cmV0dXJuIHkoYSk/cWEoYSk/YTpjKGEpOnR9dGQoZSxmLGcsaCk7aWIoZSxmLGcsaCxsLGspO3ZhciB1PWgmJmguJG9wdGlvbnMmJmguJG9wdGlvbnMudGltZXpvbmUscjtoLiQkcGFyc2VyTmFtZT1iO1xuaC4kcGFyc2Vycy5wdXNoKGZ1bmN0aW9uKGIpe3JldHVybiBoLiRpc0VtcHR5KGIpP251bGw6YS50ZXN0KGIpPyhiPWMoYixyKSxcIlVUQ1wiPT09dSYmYi5zZXRNaW51dGVzKGIuZ2V0TWludXRlcygpLWIuZ2V0VGltZXpvbmVPZmZzZXQoKSksYik6dH0pO2guJGZvcm1hdHRlcnMucHVzaChmdW5jdGlvbihhKXtpZihhJiYhcWEoYSkpdGhyb3cgTWIoXCJkYXRlZm10XCIsYSk7aWYocChhKSl7aWYoKHI9YSkmJlwiVVRDXCI9PT11KXt2YXIgYj02RTQqci5nZXRUaW1lem9uZU9mZnNldCgpO3I9bmV3IERhdGUoci5nZXRUaW1lKCkrYil9cmV0dXJuIG0oXCJkYXRlXCIpKGEsZCx1KX1yPW51bGw7cmV0dXJuXCJcIn0pO2lmKHkoZy5taW4pfHxnLm5nTWluKXt2YXIgcztoLiR2YWxpZGF0b3JzLm1pbj1mdW5jdGlvbihhKXtyZXR1cm4hcChhKXx8QShzKXx8YyhhKT49c307Zy4kb2JzZXJ2ZShcIm1pblwiLGZ1bmN0aW9uKGEpe3M9cShhKTtoLiR2YWxpZGF0ZSgpfSl9aWYoeShnLm1heCl8fGcubmdNYXgpe3ZhciBuO1xuaC4kdmFsaWRhdG9ycy5tYXg9ZnVuY3Rpb24oYSl7cmV0dXJuIXAoYSl8fEEobil8fGMoYSk8PW59O2cuJG9ic2VydmUoXCJtYXhcIixmdW5jdGlvbihhKXtuPXEoYSk7aC4kdmFsaWRhdGUoKX0pfX19ZnVuY3Rpb24gdGQoYixhLGMsZCl7KGQuJCRoYXNOYXRpdmVWYWxpZGF0b3JzPUkoYVswXS52YWxpZGl0eSkpJiZkLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24oYil7dmFyIGM9YS5wcm9wKFwidmFsaWRpdHlcIil8fHt9O3JldHVybiBjLmJhZElucHV0JiYhYy50eXBlTWlzbWF0Y2g/dDpifSl9ZnVuY3Rpb24gdWQoYixhLGMsZCxlKXtpZih5KGQpKXtiPWIoZCk7aWYoIWIuY29uc3RhbnQpdGhyb3cgVChcIm5nTW9kZWxcIikoXCJjb25zdGV4cHJcIixjLGQpO3JldHVybiBiKGEpfXJldHVybiBlfWZ1bmN0aW9uIGljKGIsYSl7Yj1cIm5nQ2xhc3NcIitiO3JldHVybltcIiRhbmltYXRlXCIsZnVuY3Rpb24oYyl7ZnVuY3Rpb24gZChhLGIpe3ZhciBjPVtdLGQ9MDthOmZvcig7ZDxhLmxlbmd0aDtkKyspe2Zvcih2YXIgZT1cbmFbZF0sbT0wO208Yi5sZW5ndGg7bSsrKWlmKGU9PWJbbV0pY29udGludWUgYTtjLnB1c2goZSl9cmV0dXJuIGN9ZnVuY3Rpb24gZShhKXtpZighRChhKSl7aWYoRihhKSlyZXR1cm4gYS5zcGxpdChcIiBcIik7aWYoSShhKSl7dmFyIGI9W107cyhhLGZ1bmN0aW9uKGEsYyl7YSYmKGI9Yi5jb25jYXQoYy5zcGxpdChcIiBcIikpKX0pO3JldHVybiBifX1yZXR1cm4gYX1yZXR1cm57cmVzdHJpY3Q6XCJBQ1wiLGxpbms6ZnVuY3Rpb24oZixnLGgpe2Z1bmN0aW9uIGwoYSxiKXt2YXIgYz1nLmRhdGEoXCIkY2xhc3NDb3VudHNcIil8fHt9LGQ9W107cyhhLGZ1bmN0aW9uKGEpe2lmKDA8Ynx8Y1thXSljW2FdPShjW2FdfHwwKStiLGNbYV09PT0rKDA8YikmJmQucHVzaChhKX0pO2cuZGF0YShcIiRjbGFzc0NvdW50c1wiLGMpO3JldHVybiBkLmpvaW4oXCIgXCIpfWZ1bmN0aW9uIGsoYil7aWYoITA9PT1hfHxmLiRpbmRleCUyPT09YSl7dmFyIGs9ZShifHxbXSk7aWYoIW0pe3ZhciB1PWwoaywxKTtoLiRhZGRDbGFzcyh1KX1lbHNlIGlmKCFmYShiLFxubSkpe3ZhciByPWUobSksdT1kKGssciksaz1kKHIsayksdT1sKHUsMSksaz1sKGssLTEpO3UmJnUubGVuZ3RoJiZjLmFkZENsYXNzKGcsdSk7ayYmay5sZW5ndGgmJmMucmVtb3ZlQ2xhc3MoZyxrKX19bT1yYShiKX12YXIgbTtmLiR3YXRjaChoW2JdLGssITApO2guJG9ic2VydmUoXCJjbGFzc1wiLGZ1bmN0aW9uKGEpe2soZi4kZXZhbChoW2JdKSl9KTtcIm5nQ2xhc3NcIiE9PWImJmYuJHdhdGNoKFwiJGluZGV4XCIsZnVuY3Rpb24oYyxkKXt2YXIgZz1jJjE7aWYoZyE9PShkJjEpKXt2YXIgaz1lKGYuJGV2YWwoaFtiXSkpO2c9PT1hPyhnPWwoaywxKSxoLiRhZGRDbGFzcyhnKSk6KGc9bChrLC0xKSxoLiRyZW1vdmVDbGFzcyhnKSl9fSl9fX1dfWZ1bmN0aW9uIHNkKGIpe2Z1bmN0aW9uIGEoYSxiKXtiJiYhZlthXT8oay5hZGRDbGFzcyhlLGEpLGZbYV09ITApOiFiJiZmW2FdJiYoay5yZW1vdmVDbGFzcyhlLGEpLGZbYV09ITEpfWZ1bmN0aW9uIGMoYixjKXtiPWI/XCItXCIrdGMoYixcIi1cIik6XCJcIjtcbmEoa2IrYiwhMD09PWMpO2EodmQrYiwhMT09PWMpfXZhciBkPWIuY3RybCxlPWIuJGVsZW1lbnQsZj17fSxnPWIuc2V0LGg9Yi51bnNldCxsPWIucGFyZW50Rm9ybSxrPWIuJGFuaW1hdGU7Zlt2ZF09IShmW2tiXT1lLmhhc0NsYXNzKGtiKSk7ZC4kc2V0VmFsaWRpdHk9ZnVuY3Rpb24oYixlLGYpe2U9PT10PyhkLiRwZW5kaW5nfHwoZC4kcGVuZGluZz17fSksZyhkLiRwZW5kaW5nLGIsZikpOihkLiRwZW5kaW5nJiZoKGQuJHBlbmRpbmcsYixmKSx3ZChkLiRwZW5kaW5nKSYmKGQuJHBlbmRpbmc9dCkpO1dhKGUpP2U/KGgoZC4kZXJyb3IsYixmKSxnKGQuJCRzdWNjZXNzLGIsZikpOihnKGQuJGVycm9yLGIsZiksaChkLiQkc3VjY2VzcyxiLGYpKTooaChkLiRlcnJvcixiLGYpLGgoZC4kJHN1Y2Nlc3MsYixmKSk7ZC4kcGVuZGluZz8oYSh4ZCwhMCksZC4kdmFsaWQ9ZC4kaW52YWxpZD10LGMoXCJcIixudWxsKSk6KGEoeGQsITEpLGQuJHZhbGlkPXdkKGQuJGVycm9yKSxkLiRpbnZhbGlkPVxuIWQuJHZhbGlkLGMoXCJcIixkLiR2YWxpZCkpO2U9ZC4kcGVuZGluZyYmZC4kcGVuZGluZ1tiXT90OmQuJGVycm9yW2JdPyExOmQuJCRzdWNjZXNzW2JdPyEwOm51bGw7YyhiLGUpO2wuJHNldFZhbGlkaXR5KGIsZSxkKX19ZnVuY3Rpb24gd2QoYil7aWYoYilmb3IodmFyIGEgaW4gYilyZXR1cm4hMTtyZXR1cm4hMH12YXIgT2Y9L15cXC8oLispXFwvKFthLXpdKikkLyxRPWZ1bmN0aW9uKGIpe3JldHVybiBGKGIpP2IudG9Mb3dlckNhc2UoKTpifSxyYz1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LHViPWZ1bmN0aW9uKGIpe3JldHVybiBGKGIpP2IudG9VcHBlckNhc2UoKTpifSxSYSxCLHNhLFphPVtdLnNsaWNlLHJmPVtdLnNwbGljZSxQZj1bXS5wdXNoLERhPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcsS2E9VChcIm5nXCIpLGdhPU0uYW5ndWxhcnx8KE0uYW5ndWxhcj17fSksYmIsbmI9MDtSYT1ZLmRvY3VtZW50TW9kZTtILiRpbmplY3Q9W107cGEuJGluamVjdD1bXTt2YXIgRD1cbkFycmF5LmlzQXJyYXksVT1mdW5jdGlvbihiKXtyZXR1cm4gRihiKT9iLnRyaW0oKTpifSxnZD1mdW5jdGlvbihiKXtyZXR1cm4gYi5yZXBsYWNlKC8oWy0oKVxcW1xcXXt9Kz8qLiRcXF58LDojPCFcXFxcXSkvZyxcIlxcXFwkMVwiKS5yZXBsYWNlKC9cXHgwOC9nLFwiXFxcXHgwOFwiKX0sYWI9ZnVuY3Rpb24oKXtpZih5KGFiLmlzQWN0aXZlXykpcmV0dXJuIGFiLmlzQWN0aXZlXzt2YXIgYj0hKCFZLnF1ZXJ5U2VsZWN0b3IoXCJbbmctY3NwXVwiKSYmIVkucXVlcnlTZWxlY3RvcihcIltkYXRhLW5nLWNzcF1cIikpO2lmKCFiKXRyeXtuZXcgRnVuY3Rpb24oXCJcIil9Y2F0Y2goYSl7Yj0hMH1yZXR1cm4gYWIuaXNBY3RpdmVfPWJ9LHJiPVtcIm5nLVwiLFwiZGF0YS1uZy1cIixcIm5nOlwiLFwieC1uZy1cIl0sTWQ9L1tBLVpdL2csdWM9ITEsUGIsb2E9MSxwYj0zLFFkPXtmdWxsOlwiMS4zLjlcIixtYWpvcjoxLG1pbm9yOjMsZG90OjksY29kZU5hbWU6XCJtdWx0aWRpbWVuc2lvbmFsLWF3YXJlbmVzc1wifTtSLmV4cGFuZG89XCJuZzMzOVwiO1xudmFyIHpiPVIuY2FjaGU9e30saGY9MTtSLl9kYXRhPWZ1bmN0aW9uKGIpe3JldHVybiB0aGlzLmNhY2hlW2JbdGhpcy5leHBhbmRvXV18fHt9fTt2YXIgY2Y9LyhbXFw6XFwtXFxfXSsoLikpL2csZGY9L15tb3ooW0EtWl0pLyxRZj17bW91c2VsZWF2ZTpcIm1vdXNlb3V0XCIsbW91c2VlbnRlcjpcIm1vdXNlb3ZlclwifSxTYj1UKFwianFMaXRlXCIpLGdmPS9ePChcXHcrKVxccypcXC8/Pig/OjxcXC9cXDE+fCkkLyxSYj0vPHwmIz9cXHcrOy8sZWY9LzwoW1xcdzpdKykvLGZmPS88KD8hYXJlYXxicnxjb2x8ZW1iZWR8aHJ8aW1nfGlucHV0fGxpbmt8bWV0YXxwYXJhbSkoKFtcXHc6XSspW14+XSopXFwvPi9naSxpYT17b3B0aW9uOlsxLCc8c2VsZWN0IG11bHRpcGxlPVwibXVsdGlwbGVcIj4nLFwiPC9zZWxlY3Q+XCJdLHRoZWFkOlsxLFwiPHRhYmxlPlwiLFwiPC90YWJsZT5cIl0sY29sOlsyLFwiPHRhYmxlPjxjb2xncm91cD5cIixcIjwvY29sZ3JvdXA+PC90YWJsZT5cIl0sdHI6WzIsXCI8dGFibGU+PHRib2R5PlwiLFwiPC90Ym9keT48L3RhYmxlPlwiXSxcbnRkOlszLFwiPHRhYmxlPjx0Ym9keT48dHI+XCIsXCI8L3RyPjwvdGJvZHk+PC90YWJsZT5cIl0sX2RlZmF1bHQ6WzAsXCJcIixcIlwiXX07aWEub3B0Z3JvdXA9aWEub3B0aW9uO2lhLnRib2R5PWlhLnRmb290PWlhLmNvbGdyb3VwPWlhLmNhcHRpb249aWEudGhlYWQ7aWEudGg9aWEudGQ7dmFyIExhPVIucHJvdG90eXBlPXtyZWFkeTpmdW5jdGlvbihiKXtmdW5jdGlvbiBhKCl7Y3x8KGM9ITAsYigpKX12YXIgYz0hMTtcImNvbXBsZXRlXCI9PT1ZLnJlYWR5U3RhdGU/c2V0VGltZW91dChhKToodGhpcy5vbihcIkRPTUNvbnRlbnRMb2FkZWRcIixhKSxSKE0pLm9uKFwibG9hZFwiLGEpKX0sdG9TdHJpbmc6ZnVuY3Rpb24oKXt2YXIgYj1bXTtzKHRoaXMsZnVuY3Rpb24oYSl7Yi5wdXNoKFwiXCIrYSl9KTtyZXR1cm5cIltcIitiLmpvaW4oXCIsIFwiKStcIl1cIn0sZXE6ZnVuY3Rpb24oYil7cmV0dXJuIDA8PWI/Qih0aGlzW2JdKTpCKHRoaXNbdGhpcy5sZW5ndGgrYl0pfSxsZW5ndGg6MCxwdXNoOlBmLHNvcnQ6W10uc29ydCxcbnNwbGljZTpbXS5zcGxpY2V9LEViPXt9O3MoXCJtdWx0aXBsZSBzZWxlY3RlZCBjaGVja2VkIGRpc2FibGVkIHJlYWRPbmx5IHJlcXVpcmVkIG9wZW5cIi5zcGxpdChcIiBcIiksZnVuY3Rpb24oYil7RWJbUShiKV09Yn0pO3ZhciBNYz17fTtzKFwiaW5wdXQgc2VsZWN0IG9wdGlvbiB0ZXh0YXJlYSBidXR0b24gZm9ybSBkZXRhaWxzXCIuc3BsaXQoXCIgXCIpLGZ1bmN0aW9uKGIpe01jW2JdPSEwfSk7dmFyIE5jPXtuZ01pbmxlbmd0aDpcIm1pbmxlbmd0aFwiLG5nTWF4bGVuZ3RoOlwibWF4bGVuZ3RoXCIsbmdNaW46XCJtaW5cIixuZ01heDpcIm1heFwiLG5nUGF0dGVybjpcInBhdHRlcm5cIn07cyh7ZGF0YTpVYixyZW1vdmVEYXRhOnhifSxmdW5jdGlvbihiLGEpe1JbYV09Yn0pO3Moe2RhdGE6VWIsaW5oZXJpdGVkRGF0YTpEYixzY29wZTpmdW5jdGlvbihiKXtyZXR1cm4gQi5kYXRhKGIsXCIkc2NvcGVcIil8fERiKGIucGFyZW50Tm9kZXx8YixbXCIkaXNvbGF0ZVNjb3BlXCIsXCIkc2NvcGVcIl0pfSxpc29sYXRlU2NvcGU6ZnVuY3Rpb24oYil7cmV0dXJuIEIuZGF0YShiLFxuXCIkaXNvbGF0ZVNjb3BlXCIpfHxCLmRhdGEoYixcIiRpc29sYXRlU2NvcGVOb1RlbXBsYXRlXCIpfSxjb250cm9sbGVyOkljLGluamVjdG9yOmZ1bmN0aW9uKGIpe3JldHVybiBEYihiLFwiJGluamVjdG9yXCIpfSxyZW1vdmVBdHRyOmZ1bmN0aW9uKGIsYSl7Yi5yZW1vdmVBdHRyaWJ1dGUoYSl9LGhhc0NsYXNzOkFiLGNzczpmdW5jdGlvbihiLGEsYyl7YT1jYihhKTtpZih5KGMpKWIuc3R5bGVbYV09YztlbHNlIHJldHVybiBiLnN0eWxlW2FdfSxhdHRyOmZ1bmN0aW9uKGIsYSxjKXt2YXIgZD1RKGEpO2lmKEViW2RdKWlmKHkoYykpYz8oYlthXT0hMCxiLnNldEF0dHJpYnV0ZShhLGQpKTooYlthXT0hMSxiLnJlbW92ZUF0dHJpYnV0ZShkKSk7ZWxzZSByZXR1cm4gYlthXXx8KGIuYXR0cmlidXRlcy5nZXROYW1lZEl0ZW0oYSl8fEgpLnNwZWNpZmllZD9kOnQ7ZWxzZSBpZih5KGMpKWIuc2V0QXR0cmlidXRlKGEsYyk7ZWxzZSBpZihiLmdldEF0dHJpYnV0ZSlyZXR1cm4gYj1iLmdldEF0dHJpYnV0ZShhLFxuMiksbnVsbD09PWI/dDpifSxwcm9wOmZ1bmN0aW9uKGIsYSxjKXtpZih5KGMpKWJbYV09YztlbHNlIHJldHVybiBiW2FdfSx0ZXh0OmZ1bmN0aW9uKCl7ZnVuY3Rpb24gYihhLGIpe2lmKEEoYikpe3ZhciBkPWEubm9kZVR5cGU7cmV0dXJuIGQ9PT1vYXx8ZD09PXBiP2EudGV4dENvbnRlbnQ6XCJcIn1hLnRleHRDb250ZW50PWJ9Yi4kZHY9XCJcIjtyZXR1cm4gYn0oKSx2YWw6ZnVuY3Rpb24oYixhKXtpZihBKGEpKXtpZihiLm11bHRpcGxlJiZcInNlbGVjdFwiPT09dWEoYikpe3ZhciBjPVtdO3MoYi5vcHRpb25zLGZ1bmN0aW9uKGEpe2Euc2VsZWN0ZWQmJmMucHVzaChhLnZhbHVlfHxhLnRleHQpfSk7cmV0dXJuIDA9PT1jLmxlbmd0aD9udWxsOmN9cmV0dXJuIGIudmFsdWV9Yi52YWx1ZT1hfSxodG1sOmZ1bmN0aW9uKGIsYSl7aWYoQShhKSlyZXR1cm4gYi5pbm5lckhUTUw7d2IoYiwhMCk7Yi5pbm5lckhUTUw9YX0sZW1wdHk6SmN9LGZ1bmN0aW9uKGIsYSl7Ui5wcm90b3R5cGVbYV09ZnVuY3Rpb24oYSxcbmQpe3ZhciBlLGYsZz10aGlzLmxlbmd0aDtpZihiIT09SmMmJigyPT1iLmxlbmd0aCYmYiE9PUFiJiZiIT09SWM/YTpkKT09PXQpe2lmKEkoYSkpe2ZvcihlPTA7ZTxnO2UrKylpZihiPT09VWIpYih0aGlzW2VdLGEpO2Vsc2UgZm9yKGYgaW4gYSliKHRoaXNbZV0sZixhW2ZdKTtyZXR1cm4gdGhpc31lPWIuJGR2O2c9ZT09PXQ/TWF0aC5taW4oZywxKTpnO2ZvcihmPTA7ZjxnO2YrKyl7dmFyIGg9Yih0aGlzW2ZdLGEsZCk7ZT1lP2UraDpofXJldHVybiBlfWZvcihlPTA7ZTxnO2UrKyliKHRoaXNbZV0sYSxkKTtyZXR1cm4gdGhpc319KTtzKHtyZW1vdmVEYXRhOnhiLG9uOmZ1bmN0aW9uIGEoYyxkLGUsZil7aWYoeShmKSl0aHJvdyBTYihcIm9uYXJnc1wiKTtpZihFYyhjKSl7dmFyIGc9eWIoYywhMCk7Zj1nLmV2ZW50czt2YXIgaD1nLmhhbmRsZTtofHwoaD1nLmhhbmRsZT1sZihjLGYpKTtmb3IodmFyIGc9MDw9ZC5pbmRleE9mKFwiIFwiKT9kLnNwbGl0KFwiIFwiKTpbZF0sbD1nLmxlbmd0aDtsLS07KXtkPVxuZ1tsXTt2YXIgaz1mW2RdO2t8fChmW2RdPVtdLFwibW91c2VlbnRlclwiPT09ZHx8XCJtb3VzZWxlYXZlXCI9PT1kP2EoYyxRZltkXSxmdW5jdGlvbihhKXt2YXIgYz1hLnJlbGF0ZWRUYXJnZXQ7YyYmKGM9PT10aGlzfHx0aGlzLmNvbnRhaW5zKGMpKXx8aChhLGQpfSk6XCIkZGVzdHJveVwiIT09ZCYmYy5hZGRFdmVudExpc3RlbmVyKGQsaCwhMSksaz1mW2RdKTtrLnB1c2goZSl9fX0sb2ZmOkhjLG9uZTpmdW5jdGlvbihhLGMsZCl7YT1CKGEpO2Eub24oYyxmdW5jdGlvbiBmKCl7YS5vZmYoYyxkKTthLm9mZihjLGYpfSk7YS5vbihjLGQpfSxyZXBsYWNlV2l0aDpmdW5jdGlvbihhLGMpe3ZhciBkLGU9YS5wYXJlbnROb2RlO3diKGEpO3MobmV3IFIoYyksZnVuY3Rpb24oYyl7ZD9lLmluc2VydEJlZm9yZShjLGQubmV4dFNpYmxpbmcpOmUucmVwbGFjZUNoaWxkKGMsYSk7ZD1jfSl9LGNoaWxkcmVuOmZ1bmN0aW9uKGEpe3ZhciBjPVtdO3MoYS5jaGlsZE5vZGVzLGZ1bmN0aW9uKGEpe2Eubm9kZVR5cGU9PT1cbm9hJiZjLnB1c2goYSl9KTtyZXR1cm4gY30sY29udGVudHM6ZnVuY3Rpb24oYSl7cmV0dXJuIGEuY29udGVudERvY3VtZW50fHxhLmNoaWxkTm9kZXN8fFtdfSxhcHBlbmQ6ZnVuY3Rpb24oYSxjKXt2YXIgZD1hLm5vZGVUeXBlO2lmKGQ9PT1vYXx8MTE9PT1kKXtjPW5ldyBSKGMpO2Zvcih2YXIgZD0wLGU9Yy5sZW5ndGg7ZDxlO2QrKylhLmFwcGVuZENoaWxkKGNbZF0pfX0scHJlcGVuZDpmdW5jdGlvbihhLGMpe2lmKGEubm9kZVR5cGU9PT1vYSl7dmFyIGQ9YS5maXJzdENoaWxkO3MobmV3IFIoYyksZnVuY3Rpb24oYyl7YS5pbnNlcnRCZWZvcmUoYyxkKX0pfX0sd3JhcDpmdW5jdGlvbihhLGMpe2M9QihjKS5lcSgwKS5jbG9uZSgpWzBdO3ZhciBkPWEucGFyZW50Tm9kZTtkJiZkLnJlcGxhY2VDaGlsZChjLGEpO2MuYXBwZW5kQ2hpbGQoYSl9LHJlbW92ZTpLYyxkZXRhY2g6ZnVuY3Rpb24oYSl7S2MoYSwhMCl9LGFmdGVyOmZ1bmN0aW9uKGEsYyl7dmFyIGQ9YSxlPWEucGFyZW50Tm9kZTtcbmM9bmV3IFIoYyk7Zm9yKHZhciBmPTAsZz1jLmxlbmd0aDtmPGc7ZisrKXt2YXIgaD1jW2ZdO2UuaW5zZXJ0QmVmb3JlKGgsZC5uZXh0U2libGluZyk7ZD1ofX0sYWRkQ2xhc3M6Q2IscmVtb3ZlQ2xhc3M6QmIsdG9nZ2xlQ2xhc3M6ZnVuY3Rpb24oYSxjLGQpe2MmJnMoYy5zcGxpdChcIiBcIiksZnVuY3Rpb24oYyl7dmFyIGY9ZDtBKGYpJiYoZj0hQWIoYSxjKSk7KGY/Q2I6QmIpKGEsYyl9KX0scGFyZW50OmZ1bmN0aW9uKGEpe3JldHVybihhPWEucGFyZW50Tm9kZSkmJjExIT09YS5ub2RlVHlwZT9hOm51bGx9LG5leHQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGEubmV4dEVsZW1lbnRTaWJsaW5nfSxmaW5kOmZ1bmN0aW9uKGEsYyl7cmV0dXJuIGEuZ2V0RWxlbWVudHNCeVRhZ05hbWU/YS5nZXRFbGVtZW50c0J5VGFnTmFtZShjKTpbXX0sY2xvbmU6VGIsdHJpZ2dlckhhbmRsZXI6ZnVuY3Rpb24oYSxjLGQpe3ZhciBlLGYsZz1jLnR5cGV8fGMsaD15YihhKTtpZihoPShoPWgmJmguZXZlbnRzKSYmXG5oW2ddKWU9e3ByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKCl7dGhpcy5kZWZhdWx0UHJldmVudGVkPSEwfSxpc0RlZmF1bHRQcmV2ZW50ZWQ6ZnVuY3Rpb24oKXtyZXR1cm4hMD09PXRoaXMuZGVmYXVsdFByZXZlbnRlZH0sc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dGhpcy5pbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ9ITB9LGlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkOmZ1bmN0aW9uKCl7cmV0dXJuITA9PT10aGlzLmltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZH0sc3RvcFByb3BhZ2F0aW9uOkgsdHlwZTpnLHRhcmdldDphfSxjLnR5cGUmJihlPXooZSxjKSksYz1yYShoKSxmPWQ/W2VdLmNvbmNhdChkKTpbZV0scyhjLGZ1bmN0aW9uKGMpe2UuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKXx8Yy5hcHBseShhLGYpfSl9fSxmdW5jdGlvbihhLGMpe1IucHJvdG90eXBlW2NdPWZ1bmN0aW9uKGMsZSxmKXtmb3IodmFyIGcsaD0wLGw9dGhpcy5sZW5ndGg7aDxcbmw7aCsrKUEoZyk/KGc9YSh0aGlzW2hdLGMsZSxmKSx5KGcpJiYoZz1CKGcpKSk6R2MoZyxhKHRoaXNbaF0sYyxlLGYpKTtyZXR1cm4geShnKT9nOnRoaXN9O1IucHJvdG90eXBlLmJpbmQ9Ui5wcm90b3R5cGUub247Ui5wcm90b3R5cGUudW5iaW5kPVIucHJvdG90eXBlLm9mZn0pO2RiLnByb3RvdHlwZT17cHV0OmZ1bmN0aW9uKGEsYyl7dGhpc1tOYShhLHRoaXMubmV4dFVpZCldPWN9LGdldDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpc1tOYShhLHRoaXMubmV4dFVpZCldfSxyZW1vdmU6ZnVuY3Rpb24oYSl7dmFyIGM9dGhpc1thPU5hKGEsdGhpcy5uZXh0VWlkKV07ZGVsZXRlIHRoaXNbYV07cmV0dXJuIGN9fTt2YXIgUGM9L15mdW5jdGlvblxccypbXlxcKF0qXFwoXFxzKihbXlxcKV0qKVxcKS9tLG5mPS8sLyxvZj0vXlxccyooXz8pKFxcUys/KVxcMVxccyokLyxPYz0vKChcXC9cXC8uKiQpfChcXC9cXCpbXFxzXFxTXSo/XFwqXFwvKSkvbWcsR2E9VChcIiRpbmplY3RvclwiKTtPYi4kJGFubm90YXRlPVZiO3ZhciBSZj1cblQoXCIkYW5pbWF0ZVwiKSxDZT1bXCIkcHJvdmlkZVwiLGZ1bmN0aW9uKGEpe3RoaXMuJCRzZWxlY3RvcnM9e307dGhpcy5yZWdpc3Rlcj1mdW5jdGlvbihjLGQpe3ZhciBlPWMrXCItYW5pbWF0aW9uXCI7aWYoYyYmXCIuXCIhPWMuY2hhckF0KDApKXRocm93IFJmKFwibm90Y3NlbFwiLGMpO3RoaXMuJCRzZWxlY3RvcnNbYy5zdWJzdHIoMSldPWU7YS5mYWN0b3J5KGUsZCl9O3RoaXMuY2xhc3NOYW1lRmlsdGVyPWZ1bmN0aW9uKGEpezE9PT1hcmd1bWVudHMubGVuZ3RoJiYodGhpcy4kJGNsYXNzTmFtZUZpbHRlcj1hIGluc3RhbmNlb2YgUmVnRXhwP2E6bnVsbCk7cmV0dXJuIHRoaXMuJCRjbGFzc05hbWVGaWx0ZXJ9O3RoaXMuJGdldD1bXCIkJHFcIixcIiQkYXN5bmNDYWxsYmFja1wiLFwiJHJvb3RTY29wZVwiLGZ1bmN0aW9uKGEsZCxlKXtmdW5jdGlvbiBmKGQpe3ZhciBmLGc9YS5kZWZlcigpO2cucHJvbWlzZS4kJGNhbmNlbEZuPWZ1bmN0aW9uKCl7ZiYmZigpfTtlLiQkcG9zdERpZ2VzdChmdW5jdGlvbigpe2Y9XG5kKGZ1bmN0aW9uKCl7Zy5yZXNvbHZlKCl9KX0pO3JldHVybiBnLnByb21pc2V9ZnVuY3Rpb24gZyhhLGMpe3ZhciBkPVtdLGU9W10sZj1oYSgpO3MoKGEuYXR0cihcImNsYXNzXCIpfHxcIlwiKS5zcGxpdCgvXFxzKy8pLGZ1bmN0aW9uKGEpe2ZbYV09ITB9KTtzKGMsZnVuY3Rpb24oYSxjKXt2YXIgZz1mW2NdOyExPT09YSYmZz9lLnB1c2goYyk6ITAhPT1hfHxnfHxkLnB1c2goYyl9KTtyZXR1cm4gMDxkLmxlbmd0aCtlLmxlbmd0aCYmW2QubGVuZ3RoP2Q6bnVsbCxlLmxlbmd0aD9lOm51bGxdfWZ1bmN0aW9uIGgoYSxjLGQpe2Zvcih2YXIgZT0wLGY9Yy5sZW5ndGg7ZTxmOysrZSlhW2NbZV1dPWR9ZnVuY3Rpb24gbCgpe218fChtPWEuZGVmZXIoKSxkKGZ1bmN0aW9uKCl7bS5yZXNvbHZlKCk7bT1udWxsfSkpO3JldHVybiBtLnByb21pc2V9ZnVuY3Rpb24gayhhLGMpe2lmKGdhLmlzT2JqZWN0KGMpKXt2YXIgZD16KGMuZnJvbXx8e30sYy50b3x8e30pO2EuY3NzKGQpfX12YXIgbTtyZXR1cm57YW5pbWF0ZTpmdW5jdGlvbihhLFxuYyxkKXtrKGEse2Zyb206Yyx0bzpkfSk7cmV0dXJuIGwoKX0sZW50ZXI6ZnVuY3Rpb24oYSxjLGQsZSl7ayhhLGUpO2Q/ZC5hZnRlcihhKTpjLnByZXBlbmQoYSk7cmV0dXJuIGwoKX0sbGVhdmU6ZnVuY3Rpb24oYSxjKXthLnJlbW92ZSgpO3JldHVybiBsKCl9LG1vdmU6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIHRoaXMuZW50ZXIoYSxjLGQsZSl9LGFkZENsYXNzOmZ1bmN0aW9uKGEsYyxkKXtyZXR1cm4gdGhpcy5zZXRDbGFzcyhhLGMsW10sZCl9LCQkYWRkQ2xhc3NJbW1lZGlhdGVseTpmdW5jdGlvbihhLGMsZCl7YT1CKGEpO2M9RihjKT9jOkQoYyk/Yy5qb2luKFwiIFwiKTpcIlwiO3MoYSxmdW5jdGlvbihhKXtDYihhLGMpfSk7ayhhLGQpO3JldHVybiBsKCl9LHJlbW92ZUNsYXNzOmZ1bmN0aW9uKGEsYyxkKXtyZXR1cm4gdGhpcy5zZXRDbGFzcyhhLFtdLGMsZCl9LCQkcmVtb3ZlQ2xhc3NJbW1lZGlhdGVseTpmdW5jdGlvbihhLGMsZCl7YT1CKGEpO2M9RihjKT9jOkQoYyk/Yy5qb2luKFwiIFwiKTpcblwiXCI7cyhhLGZ1bmN0aW9uKGEpe0JiKGEsYyl9KTtrKGEsZCk7cmV0dXJuIGwoKX0sc2V0Q2xhc3M6ZnVuY3Rpb24oYSxjLGQsZSl7dmFyIGs9dGhpcyxsPSExO2E9QihhKTt2YXIgbT1hLmRhdGEoXCIkJGFuaW1hdGVDbGFzc2VzXCIpO20/ZSYmbS5vcHRpb25zJiYobS5vcHRpb25zPWdhLmV4dGVuZChtLm9wdGlvbnN8fHt9LGUpKToobT17Y2xhc3Nlczp7fSxvcHRpb25zOmV9LGw9ITApO2U9bS5jbGFzc2VzO2M9RChjKT9jOmMuc3BsaXQoXCIgXCIpO2Q9RChkKT9kOmQuc3BsaXQoXCIgXCIpO2goZSxjLCEwKTtoKGUsZCwhMSk7bCYmKG0ucHJvbWlzZT1mKGZ1bmN0aW9uKGMpe3ZhciBkPWEuZGF0YShcIiQkYW5pbWF0ZUNsYXNzZXNcIik7YS5yZW1vdmVEYXRhKFwiJCRhbmltYXRlQ2xhc3Nlc1wiKTtpZihkKXt2YXIgZT1nKGEsZC5jbGFzc2VzKTtlJiZrLiQkc2V0Q2xhc3NJbW1lZGlhdGVseShhLGVbMF0sZVsxXSxkLm9wdGlvbnMpfWMoKX0pLGEuZGF0YShcIiQkYW5pbWF0ZUNsYXNzZXNcIixtKSk7XG5yZXR1cm4gbS5wcm9taXNlfSwkJHNldENsYXNzSW1tZWRpYXRlbHk6ZnVuY3Rpb24oYSxjLGQsZSl7YyYmdGhpcy4kJGFkZENsYXNzSW1tZWRpYXRlbHkoYSxjKTtkJiZ0aGlzLiQkcmVtb3ZlQ2xhc3NJbW1lZGlhdGVseShhLGQpO2soYSxlKTtyZXR1cm4gbCgpfSxlbmFibGVkOkgsY2FuY2VsOkh9fV19XSxqYT1UKFwiJGNvbXBpbGVcIik7d2MuJGluamVjdD1bXCIkcHJvdmlkZVwiLFwiJCRzYW5pdGl6ZVVyaVByb3ZpZGVyXCJdO3ZhciBSYz0vXigoPzp4fGRhdGEpW1xcOlxcLV9dKS9pLFZjPVwiYXBwbGljYXRpb24vanNvblwiLFpiPXtcIkNvbnRlbnQtVHlwZVwiOlZjK1wiO2NoYXJzZXQ9dXRmLThcIn0sdGY9L15cXFt8Xlxceyg/IVxceykvLHVmPXtcIltcIjovXSQvLFwie1wiOi99JC99LHNmPS9eXFwpXFxdXFx9Jyw/XFxuLywkYj1UKFwiJGludGVycG9sYXRlXCIpLFNmPS9eKFteXFw/I10qKShcXD8oW14jXSopKT8oIyguKikpPyQvLHhmPXtodHRwOjgwLGh0dHBzOjQ0MyxmdHA6MjF9LEZiPVQoXCIkbG9jYXRpb25cIiksVGY9XG57JCRodG1sNTohMSwkJHJlcGxhY2U6ITEsYWJzVXJsOkdiKFwiJCRhYnNVcmxcIiksdXJsOmZ1bmN0aW9uKGEpe2lmKEEoYSkpcmV0dXJuIHRoaXMuJCR1cmw7dmFyIGM9U2YuZXhlYyhhKTsoY1sxXXx8XCJcIj09PWEpJiZ0aGlzLnBhdGgoZGVjb2RlVVJJQ29tcG9uZW50KGNbMV0pKTsoY1syXXx8Y1sxXXx8XCJcIj09PWEpJiZ0aGlzLnNlYXJjaChjWzNdfHxcIlwiKTt0aGlzLmhhc2goY1s1XXx8XCJcIik7cmV0dXJuIHRoaXN9LHByb3RvY29sOkdiKFwiJCRwcm90b2NvbFwiKSxob3N0OkdiKFwiJCRob3N0XCIpLHBvcnQ6R2IoXCIkJHBvcnRcIikscGF0aDpkZChcIiQkcGF0aFwiLGZ1bmN0aW9uKGEpe2E9bnVsbCE9PWE/YS50b1N0cmluZygpOlwiXCI7cmV0dXJuXCIvXCI9PWEuY2hhckF0KDApP2E6XCIvXCIrYX0pLHNlYXJjaDpmdW5jdGlvbihhLGMpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIHRoaXMuJCRzZWFyY2g7Y2FzZSAxOmlmKEYoYSl8fFYoYSkpYT1hLnRvU3RyaW5nKCksdGhpcy4kJHNlYXJjaD1cbnFjKGEpO2Vsc2UgaWYoSShhKSlhPUVhKGEse30pLHMoYSxmdW5jdGlvbihjLGUpe251bGw9PWMmJmRlbGV0ZSBhW2VdfSksdGhpcy4kJHNlYXJjaD1hO2Vsc2UgdGhyb3cgRmIoXCJpc3JjaGFyZ1wiKTticmVhaztkZWZhdWx0OkEoYyl8fG51bGw9PT1jP2RlbGV0ZSB0aGlzLiQkc2VhcmNoW2FdOnRoaXMuJCRzZWFyY2hbYV09Y310aGlzLiQkY29tcG9zZSgpO3JldHVybiB0aGlzfSxoYXNoOmRkKFwiJCRoYXNoXCIsZnVuY3Rpb24oYSl7cmV0dXJuIG51bGwhPT1hP2EudG9TdHJpbmcoKTpcIlwifSkscmVwbGFjZTpmdW5jdGlvbigpe3RoaXMuJCRyZXBsYWNlPSEwO3JldHVybiB0aGlzfX07cyhbY2QsZGMsY2NdLGZ1bmN0aW9uKGEpe2EucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoVGYpO2EucHJvdG90eXBlLnN0YXRlPWZ1bmN0aW9uKGMpe2lmKCFhcmd1bWVudHMubGVuZ3RoKXJldHVybiB0aGlzLiQkc3RhdGU7aWYoYSE9PWNjfHwhdGhpcy4kJGh0bWw1KXRocm93IEZiKFwibm9zdGF0ZVwiKTt0aGlzLiQkc3RhdGU9XG5BKGMpP251bGw6YztyZXR1cm4gdGhpc319KTt2YXIgbGE9VChcIiRwYXJzZVwiKSxVZj1GdW5jdGlvbi5wcm90b3R5cGUuY2FsbCxWZj1GdW5jdGlvbi5wcm90b3R5cGUuYXBwbHksV2Y9RnVuY3Rpb24ucHJvdG90eXBlLmJpbmQsbGI9aGEoKTtzKHtcIm51bGxcIjpmdW5jdGlvbigpe3JldHVybiBudWxsfSxcInRydWVcIjpmdW5jdGlvbigpe3JldHVybiEwfSxcImZhbHNlXCI6ZnVuY3Rpb24oKXtyZXR1cm4hMX0sdW5kZWZpbmVkOmZ1bmN0aW9uKCl7fX0sZnVuY3Rpb24oYSxjKXthLmNvbnN0YW50PWEubGl0ZXJhbD1hLnNoYXJlZEdldHRlcj0hMDtsYltjXT1hfSk7bGJbXCJ0aGlzXCJdPWZ1bmN0aW9uKGEpe3JldHVybiBhfTtsYltcInRoaXNcIl0uc2hhcmVkR2V0dGVyPSEwO3ZhciBtYj16KGhhKCkse1wiK1wiOmZ1bmN0aW9uKGEsYyxkLGUpe2Q9ZChhLGMpO2U9ZShhLGMpO3JldHVybiB5KGQpP3koZSk/ZCtlOmQ6eShlKT9lOnR9LFwiLVwiOmZ1bmN0aW9uKGEsYyxkLGUpe2Q9ZChhLGMpO2U9ZShhLGMpO1xucmV0dXJuKHkoZCk/ZDowKS0oeShlKT9lOjApfSxcIipcIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpKmUoYSxjKX0sXCIvXCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKS9lKGEsYyl9LFwiJVwiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYyklZShhLGMpfSxcIj09PVwiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYyk9PT1lKGEsYyl9LFwiIT09XCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKSE9PWUoYSxjKX0sXCI9PVwiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYyk9PWUoYSxjKX0sXCIhPVwiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYykhPWUoYSxjKX0sXCI8XCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKTxlKGEsYyl9LFwiPlwiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYyk+ZShhLGMpfSxcIjw9XCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKTw9ZShhLGMpfSxcIj49XCI6ZnVuY3Rpb24oYSxjLFxuZCxlKXtyZXR1cm4gZChhLGMpPj1lKGEsYyl9LFwiJiZcIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpJiZlKGEsYyl9LFwifHxcIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpfHxlKGEsYyl9LFwiIVwiOmZ1bmN0aW9uKGEsYyxkKXtyZXR1cm4hZChhLGMpfSxcIj1cIjohMCxcInxcIjohMH0pLFhmPXtuOlwiXFxuXCIsZjpcIlxcZlwiLHI6XCJcXHJcIix0OlwiXFx0XCIsdjpcIlxcdlwiLFwiJ1wiOlwiJ1wiLCdcIic6J1wiJ30sZ2M9ZnVuY3Rpb24oYSl7dGhpcy5vcHRpb25zPWF9O2djLnByb3RvdHlwZT17Y29uc3RydWN0b3I6Z2MsbGV4OmZ1bmN0aW9uKGEpe3RoaXMudGV4dD1hO3RoaXMuaW5kZXg9MDtmb3IodGhpcy50b2tlbnM9W107dGhpcy5pbmRleDx0aGlzLnRleHQubGVuZ3RoOylpZihhPXRoaXMudGV4dC5jaGFyQXQodGhpcy5pbmRleCksJ1wiJz09PWF8fFwiJ1wiPT09YSl0aGlzLnJlYWRTdHJpbmcoYSk7ZWxzZSBpZih0aGlzLmlzTnVtYmVyKGEpfHxcIi5cIj09PWEmJnRoaXMuaXNOdW1iZXIodGhpcy5wZWVrKCkpKXRoaXMucmVhZE51bWJlcigpO1xuZWxzZSBpZih0aGlzLmlzSWRlbnQoYSkpdGhpcy5yZWFkSWRlbnQoKTtlbHNlIGlmKHRoaXMuaXMoYSxcIigpe31bXS4sOzo/XCIpKXRoaXMudG9rZW5zLnB1c2goe2luZGV4OnRoaXMuaW5kZXgsdGV4dDphfSksdGhpcy5pbmRleCsrO2Vsc2UgaWYodGhpcy5pc1doaXRlc3BhY2UoYSkpdGhpcy5pbmRleCsrO2Vsc2V7dmFyIGM9YSt0aGlzLnBlZWsoKSxkPWMrdGhpcy5wZWVrKDIpLGU9bWJbY10sZj1tYltkXTttYlthXXx8ZXx8Zj8oYT1mP2Q6ZT9jOmEsdGhpcy50b2tlbnMucHVzaCh7aW5kZXg6dGhpcy5pbmRleCx0ZXh0OmEsb3BlcmF0b3I6ITB9KSx0aGlzLmluZGV4Kz1hLmxlbmd0aCk6dGhpcy50aHJvd0Vycm9yKFwiVW5leHBlY3RlZCBuZXh0IGNoYXJhY3RlciBcIix0aGlzLmluZGV4LHRoaXMuaW5kZXgrMSl9cmV0dXJuIHRoaXMudG9rZW5zfSxpczpmdW5jdGlvbihhLGMpe3JldHVybi0xIT09Yy5pbmRleE9mKGEpfSxwZWVrOmZ1bmN0aW9uKGEpe2E9YXx8MTtyZXR1cm4gdGhpcy5pbmRleCtcbmE8dGhpcy50ZXh0Lmxlbmd0aD90aGlzLnRleHQuY2hhckF0KHRoaXMuaW5kZXgrYSk6ITF9LGlzTnVtYmVyOmZ1bmN0aW9uKGEpe3JldHVyblwiMFwiPD1hJiZcIjlcIj49YSYmXCJzdHJpbmdcIj09PXR5cGVvZiBhfSxpc1doaXRlc3BhY2U6ZnVuY3Rpb24oYSl7cmV0dXJuXCIgXCI9PT1hfHxcIlxcclwiPT09YXx8XCJcXHRcIj09PWF8fFwiXFxuXCI9PT1hfHxcIlxcdlwiPT09YXx8XCJcXHUwMGEwXCI9PT1hfSxpc0lkZW50OmZ1bmN0aW9uKGEpe3JldHVyblwiYVwiPD1hJiZcInpcIj49YXx8XCJBXCI8PWEmJlwiWlwiPj1hfHxcIl9cIj09PWF8fFwiJFwiPT09YX0saXNFeHBPcGVyYXRvcjpmdW5jdGlvbihhKXtyZXR1cm5cIi1cIj09PWF8fFwiK1wiPT09YXx8dGhpcy5pc051bWJlcihhKX0sdGhyb3dFcnJvcjpmdW5jdGlvbihhLGMsZCl7ZD1kfHx0aGlzLmluZGV4O2M9eShjKT9cInMgXCIrYytcIi1cIit0aGlzLmluZGV4K1wiIFtcIit0aGlzLnRleHQuc3Vic3RyaW5nKGMsZCkrXCJdXCI6XCIgXCIrZDt0aHJvdyBsYShcImxleGVyclwiLGEsYyx0aGlzLnRleHQpO1xufSxyZWFkTnVtYmVyOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPVwiXCIsYz10aGlzLmluZGV4O3RoaXMuaW5kZXg8dGhpcy50ZXh0Lmxlbmd0aDspe3ZhciBkPVEodGhpcy50ZXh0LmNoYXJBdCh0aGlzLmluZGV4KSk7aWYoXCIuXCI9PWR8fHRoaXMuaXNOdW1iZXIoZCkpYSs9ZDtlbHNle3ZhciBlPXRoaXMucGVlaygpO2lmKFwiZVwiPT1kJiZ0aGlzLmlzRXhwT3BlcmF0b3IoZSkpYSs9ZDtlbHNlIGlmKHRoaXMuaXNFeHBPcGVyYXRvcihkKSYmZSYmdGhpcy5pc051bWJlcihlKSYmXCJlXCI9PWEuY2hhckF0KGEubGVuZ3RoLTEpKWErPWQ7ZWxzZSBpZighdGhpcy5pc0V4cE9wZXJhdG9yKGQpfHxlJiZ0aGlzLmlzTnVtYmVyKGUpfHxcImVcIiE9YS5jaGFyQXQoYS5sZW5ndGgtMSkpYnJlYWs7ZWxzZSB0aGlzLnRocm93RXJyb3IoXCJJbnZhbGlkIGV4cG9uZW50XCIpfXRoaXMuaW5kZXgrK310aGlzLnRva2Vucy5wdXNoKHtpbmRleDpjLHRleHQ6YSxjb25zdGFudDohMCx2YWx1ZTpOdW1iZXIoYSl9KX0scmVhZElkZW50OmZ1bmN0aW9uKCl7Zm9yKHZhciBhPVxudGhpcy5pbmRleDt0aGlzLmluZGV4PHRoaXMudGV4dC5sZW5ndGg7KXt2YXIgYz10aGlzLnRleHQuY2hhckF0KHRoaXMuaW5kZXgpO2lmKCF0aGlzLmlzSWRlbnQoYykmJiF0aGlzLmlzTnVtYmVyKGMpKWJyZWFrO3RoaXMuaW5kZXgrK310aGlzLnRva2Vucy5wdXNoKHtpbmRleDphLHRleHQ6dGhpcy50ZXh0LnNsaWNlKGEsdGhpcy5pbmRleCksaWRlbnRpZmllcjohMH0pfSxyZWFkU3RyaW5nOmZ1bmN0aW9uKGEpe3ZhciBjPXRoaXMuaW5kZXg7dGhpcy5pbmRleCsrO2Zvcih2YXIgZD1cIlwiLGU9YSxmPSExO3RoaXMuaW5kZXg8dGhpcy50ZXh0Lmxlbmd0aDspe3ZhciBnPXRoaXMudGV4dC5jaGFyQXQodGhpcy5pbmRleCksZT1lK2c7aWYoZilcInVcIj09PWc/KGY9dGhpcy50ZXh0LnN1YnN0cmluZyh0aGlzLmluZGV4KzEsdGhpcy5pbmRleCs1KSxmLm1hdGNoKC9bXFxkYS1mXXs0fS9pKXx8dGhpcy50aHJvd0Vycm9yKFwiSW52YWxpZCB1bmljb2RlIGVzY2FwZSBbXFxcXHVcIitmK1wiXVwiKSx0aGlzLmluZGV4Kz1cbjQsZCs9U3RyaW5nLmZyb21DaGFyQ29kZShwYXJzZUludChmLDE2KSkpOmQrPVhmW2ddfHxnLGY9ITE7ZWxzZSBpZihcIlxcXFxcIj09PWcpZj0hMDtlbHNle2lmKGc9PT1hKXt0aGlzLmluZGV4Kys7dGhpcy50b2tlbnMucHVzaCh7aW5kZXg6Yyx0ZXh0OmUsY29uc3RhbnQ6ITAsdmFsdWU6ZH0pO3JldHVybn1kKz1nfXRoaXMuaW5kZXgrK310aGlzLnRocm93RXJyb3IoXCJVbnRlcm1pbmF0ZWQgcXVvdGVcIixjKX19O3ZhciBoYj1mdW5jdGlvbihhLGMsZCl7dGhpcy5sZXhlcj1hO3RoaXMuJGZpbHRlcj1jO3RoaXMub3B0aW9ucz1kfTtoYi5aRVJPPXooZnVuY3Rpb24oKXtyZXR1cm4gMH0se3NoYXJlZEdldHRlcjohMCxjb25zdGFudDohMH0pO2hiLnByb3RvdHlwZT17Y29uc3RydWN0b3I6aGIscGFyc2U6ZnVuY3Rpb24oYSl7dGhpcy50ZXh0PWE7dGhpcy50b2tlbnM9dGhpcy5sZXhlci5sZXgoYSk7YT10aGlzLnN0YXRlbWVudHMoKTswIT09dGhpcy50b2tlbnMubGVuZ3RoJiZ0aGlzLnRocm93RXJyb3IoXCJpcyBhbiB1bmV4cGVjdGVkIHRva2VuXCIsXG50aGlzLnRva2Vuc1swXSk7YS5saXRlcmFsPSEhYS5saXRlcmFsO2EuY29uc3RhbnQ9ISFhLmNvbnN0YW50O3JldHVybiBhfSxwcmltYXJ5OmZ1bmN0aW9uKCl7dmFyIGE7dGhpcy5leHBlY3QoXCIoXCIpPyhhPXRoaXMuZmlsdGVyQ2hhaW4oKSx0aGlzLmNvbnN1bWUoXCIpXCIpKTp0aGlzLmV4cGVjdChcIltcIik/YT10aGlzLmFycmF5RGVjbGFyYXRpb24oKTp0aGlzLmV4cGVjdChcIntcIik/YT10aGlzLm9iamVjdCgpOnRoaXMucGVlaygpLmlkZW50aWZpZXImJnRoaXMucGVlaygpLnRleHQgaW4gbGI/YT1sYlt0aGlzLmNvbnN1bWUoKS50ZXh0XTp0aGlzLnBlZWsoKS5pZGVudGlmaWVyP2E9dGhpcy5pZGVudGlmaWVyKCk6dGhpcy5wZWVrKCkuY29uc3RhbnQ/YT10aGlzLmNvbnN0YW50KCk6dGhpcy50aHJvd0Vycm9yKFwibm90IGEgcHJpbWFyeSBleHByZXNzaW9uXCIsdGhpcy5wZWVrKCkpO2Zvcih2YXIgYyxkO2M9dGhpcy5leHBlY3QoXCIoXCIsXCJbXCIsXCIuXCIpOylcIihcIj09PWMudGV4dD8oYT10aGlzLmZ1bmN0aW9uQ2FsbChhLFxuZCksZD1udWxsKTpcIltcIj09PWMudGV4dD8oZD1hLGE9dGhpcy5vYmplY3RJbmRleChhKSk6XCIuXCI9PT1jLnRleHQ/KGQ9YSxhPXRoaXMuZmllbGRBY2Nlc3MoYSkpOnRoaXMudGhyb3dFcnJvcihcIklNUE9TU0lCTEVcIik7cmV0dXJuIGF9LHRocm93RXJyb3I6ZnVuY3Rpb24oYSxjKXt0aHJvdyBsYShcInN5bnRheFwiLGMudGV4dCxhLGMuaW5kZXgrMSx0aGlzLnRleHQsdGhpcy50ZXh0LnN1YnN0cmluZyhjLmluZGV4KSk7fSxwZWVrVG9rZW46ZnVuY3Rpb24oKXtpZigwPT09dGhpcy50b2tlbnMubGVuZ3RoKXRocm93IGxhKFwidWVvZVwiLHRoaXMudGV4dCk7cmV0dXJuIHRoaXMudG9rZW5zWzBdfSxwZWVrOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiB0aGlzLnBlZWtBaGVhZCgwLGEsYyxkLGUpfSxwZWVrQWhlYWQ6ZnVuY3Rpb24oYSxjLGQsZSxmKXtpZih0aGlzLnRva2Vucy5sZW5ndGg+YSl7YT10aGlzLnRva2Vuc1thXTt2YXIgZz1hLnRleHQ7aWYoZz09PWN8fGc9PT1kfHxnPT09ZXx8Zz09PVxuZnx8IShjfHxkfHxlfHxmKSlyZXR1cm4gYX1yZXR1cm4hMX0sZXhwZWN0OmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybihhPXRoaXMucGVlayhhLGMsZCxlKSk/KHRoaXMudG9rZW5zLnNoaWZ0KCksYSk6ITF9LGNvbnN1bWU6ZnVuY3Rpb24oYSl7aWYoMD09PXRoaXMudG9rZW5zLmxlbmd0aCl0aHJvdyBsYShcInVlb2VcIix0aGlzLnRleHQpO3ZhciBjPXRoaXMuZXhwZWN0KGEpO2N8fHRoaXMudGhyb3dFcnJvcihcImlzIHVuZXhwZWN0ZWQsIGV4cGVjdGluZyBbXCIrYStcIl1cIix0aGlzLnBlZWsoKSk7cmV0dXJuIGN9LHVuYXJ5Rm46ZnVuY3Rpb24oYSxjKXt2YXIgZD1tYlthXTtyZXR1cm4geihmdW5jdGlvbihhLGYpe3JldHVybiBkKGEsZixjKX0se2NvbnN0YW50OmMuY29uc3RhbnQsaW5wdXRzOltjXX0pfSxiaW5hcnlGbjpmdW5jdGlvbihhLGMsZCxlKXt2YXIgZj1tYltjXTtyZXR1cm4geihmdW5jdGlvbihjLGUpe3JldHVybiBmKGMsZSxhLGQpfSx7Y29uc3RhbnQ6YS5jb25zdGFudCYmXG5kLmNvbnN0YW50LGlucHV0czohZSYmW2EsZF19KX0saWRlbnRpZmllcjpmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLmNvbnN1bWUoKS50ZXh0O3RoaXMucGVlayhcIi5cIikmJnRoaXMucGVla0FoZWFkKDEpLmlkZW50aWZpZXImJiF0aGlzLnBlZWtBaGVhZCgyLFwiKFwiKTspYSs9dGhpcy5jb25zdW1lKCkudGV4dCt0aGlzLmNvbnN1bWUoKS50ZXh0O3JldHVybiB6ZihhLHRoaXMub3B0aW9ucyx0aGlzLnRleHQpfSxjb25zdGFudDpmdW5jdGlvbigpe3ZhciBhPXRoaXMuY29uc3VtZSgpLnZhbHVlO3JldHVybiB6KGZ1bmN0aW9uKCl7cmV0dXJuIGF9LHtjb25zdGFudDohMCxsaXRlcmFsOiEwfSl9LHN0YXRlbWVudHM6ZnVuY3Rpb24oKXtmb3IodmFyIGE9W107OylpZigwPHRoaXMudG9rZW5zLmxlbmd0aCYmIXRoaXMucGVlayhcIn1cIixcIilcIixcIjtcIixcIl1cIikmJmEucHVzaCh0aGlzLmZpbHRlckNoYWluKCkpLCF0aGlzLmV4cGVjdChcIjtcIikpcmV0dXJuIDE9PT1hLmxlbmd0aD9hWzBdOmZ1bmN0aW9uKGMsXG5kKXtmb3IodmFyIGUsZj0wLGc9YS5sZW5ndGg7ZjxnO2YrKyllPWFbZl0oYyxkKTtyZXR1cm4gZX19LGZpbHRlckNoYWluOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMuZXhwcmVzc2lvbigpO3RoaXMuZXhwZWN0KFwifFwiKTspYT10aGlzLmZpbHRlcihhKTtyZXR1cm4gYX0sZmlsdGVyOmZ1bmN0aW9uKGEpe3ZhciBjPXRoaXMuJGZpbHRlcih0aGlzLmNvbnN1bWUoKS50ZXh0KSxkLGU7aWYodGhpcy5wZWVrKFwiOlwiKSlmb3IoZD1bXSxlPVtdO3RoaXMuZXhwZWN0KFwiOlwiKTspZC5wdXNoKHRoaXMuZXhwcmVzc2lvbigpKTt2YXIgZj1bYV0uY29uY2F0KGR8fFtdKTtyZXR1cm4geihmdW5jdGlvbihmLGgpe3ZhciBsPWEoZixoKTtpZihlKXtlWzBdPWw7Zm9yKGw9ZC5sZW5ndGg7bC0tOyllW2wrMV09ZFtsXShmLGgpO3JldHVybiBjLmFwcGx5KHQsZSl9cmV0dXJuIGMobCl9LHtjb25zdGFudDohYy4kc3RhdGVmdWwmJmYuZXZlcnkoZWMpLGlucHV0czohYy4kc3RhdGVmdWwmJmZ9KX0sZXhwcmVzc2lvbjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmFzc2lnbm1lbnQoKX0sXG5hc3NpZ25tZW50OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy50ZXJuYXJ5KCksYyxkO3JldHVybihkPXRoaXMuZXhwZWN0KFwiPVwiKSk/KGEuYXNzaWdufHx0aGlzLnRocm93RXJyb3IoXCJpbXBsaWVzIGFzc2lnbm1lbnQgYnV0IFtcIit0aGlzLnRleHQuc3Vic3RyaW5nKDAsZC5pbmRleCkrXCJdIGNhbiBub3QgYmUgYXNzaWduZWQgdG9cIixkKSxjPXRoaXMudGVybmFyeSgpLHooZnVuY3Rpb24oZCxmKXtyZXR1cm4gYS5hc3NpZ24oZCxjKGQsZiksZil9LHtpbnB1dHM6W2EsY119KSk6YX0sdGVybmFyeTpmdW5jdGlvbigpe3ZhciBhPXRoaXMubG9naWNhbE9SKCksYztpZih0aGlzLmV4cGVjdChcIj9cIikmJihjPXRoaXMuYXNzaWdubWVudCgpLHRoaXMuY29uc3VtZShcIjpcIikpKXt2YXIgZD10aGlzLmFzc2lnbm1lbnQoKTtyZXR1cm4geihmdW5jdGlvbihlLGYpe3JldHVybiBhKGUsZik/YyhlLGYpOmQoZSxmKX0se2NvbnN0YW50OmEuY29uc3RhbnQmJmMuY29uc3RhbnQmJmQuY29uc3RhbnR9KX1yZXR1cm4gYX0sXG5sb2dpY2FsT1I6ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5sb2dpY2FsQU5EKCksYztjPXRoaXMuZXhwZWN0KFwifHxcIik7KWE9dGhpcy5iaW5hcnlGbihhLGMudGV4dCx0aGlzLmxvZ2ljYWxBTkQoKSwhMCk7cmV0dXJuIGF9LGxvZ2ljYWxBTkQ6ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5lcXVhbGl0eSgpLGM7Yz10aGlzLmV4cGVjdChcIiYmXCIpOylhPXRoaXMuYmluYXJ5Rm4oYSxjLnRleHQsdGhpcy5lcXVhbGl0eSgpLCEwKTtyZXR1cm4gYX0sZXF1YWxpdHk6ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5yZWxhdGlvbmFsKCksYztjPXRoaXMuZXhwZWN0KFwiPT1cIixcIiE9XCIsXCI9PT1cIixcIiE9PVwiKTspYT10aGlzLmJpbmFyeUZuKGEsYy50ZXh0LHRoaXMucmVsYXRpb25hbCgpKTtyZXR1cm4gYX0scmVsYXRpb25hbDpmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLmFkZGl0aXZlKCksYztjPXRoaXMuZXhwZWN0KFwiPFwiLFwiPlwiLFwiPD1cIixcIj49XCIpOylhPXRoaXMuYmluYXJ5Rm4oYSxjLnRleHQsXG50aGlzLmFkZGl0aXZlKCkpO3JldHVybiBhfSxhZGRpdGl2ZTpmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLm11bHRpcGxpY2F0aXZlKCksYztjPXRoaXMuZXhwZWN0KFwiK1wiLFwiLVwiKTspYT10aGlzLmJpbmFyeUZuKGEsYy50ZXh0LHRoaXMubXVsdGlwbGljYXRpdmUoKSk7cmV0dXJuIGF9LG11bHRpcGxpY2F0aXZlOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMudW5hcnkoKSxjO2M9dGhpcy5leHBlY3QoXCIqXCIsXCIvXCIsXCIlXCIpOylhPXRoaXMuYmluYXJ5Rm4oYSxjLnRleHQsdGhpcy51bmFyeSgpKTtyZXR1cm4gYX0sdW5hcnk6ZnVuY3Rpb24oKXt2YXIgYTtyZXR1cm4gdGhpcy5leHBlY3QoXCIrXCIpP3RoaXMucHJpbWFyeSgpOihhPXRoaXMuZXhwZWN0KFwiLVwiKSk/dGhpcy5iaW5hcnlGbihoYi5aRVJPLGEudGV4dCx0aGlzLnVuYXJ5KCkpOihhPXRoaXMuZXhwZWN0KFwiIVwiKSk/dGhpcy51bmFyeUZuKGEudGV4dCx0aGlzLnVuYXJ5KCkpOnRoaXMucHJpbWFyeSgpfSxmaWVsZEFjY2VzczpmdW5jdGlvbihhKXt2YXIgYz1cbnRoaXMuaWRlbnRpZmllcigpO3JldHVybiB6KGZ1bmN0aW9uKGQsZSxmKXtkPWZ8fGEoZCxlKTtyZXR1cm4gbnVsbD09ZD90OmMoZCl9LHthc3NpZ246ZnVuY3Rpb24oZCxlLGYpe3ZhciBnPWEoZCxmKTtnfHxhLmFzc2lnbihkLGc9e30sZik7cmV0dXJuIGMuYXNzaWduKGcsZSl9fSl9LG9iamVjdEluZGV4OmZ1bmN0aW9uKGEpe3ZhciBjPXRoaXMudGV4dCxkPXRoaXMuZXhwcmVzc2lvbigpO3RoaXMuY29uc3VtZShcIl1cIik7cmV0dXJuIHooZnVuY3Rpb24oZSxmKXt2YXIgZz1hKGUsZiksaD1kKGUsZik7dGEoaCxjKTtyZXR1cm4gZz9tYShnW2hdLGMpOnR9LHthc3NpZ246ZnVuY3Rpb24oZSxmLGcpe3ZhciBoPXRhKGQoZSxnKSxjKSxsPW1hKGEoZSxnKSxjKTtsfHxhLmFzc2lnbihlLGw9e30sZyk7cmV0dXJuIGxbaF09Zn19KX0sZnVuY3Rpb25DYWxsOmZ1bmN0aW9uKGEsYyl7dmFyIGQ9W107aWYoXCIpXCIhPT10aGlzLnBlZWtUb2tlbigpLnRleHQpe2RvIGQucHVzaCh0aGlzLmV4cHJlc3Npb24oKSk7XG53aGlsZSh0aGlzLmV4cGVjdChcIixcIikpfXRoaXMuY29uc3VtZShcIilcIik7dmFyIGU9dGhpcy50ZXh0LGY9ZC5sZW5ndGg/W106bnVsbDtyZXR1cm4gZnVuY3Rpb24oZyxoKXt2YXIgbD1jP2MoZyxoKTp5KGMpP3Q6ZyxrPWEoZyxoLGwpfHxIO2lmKGYpZm9yKHZhciBtPWQubGVuZ3RoO20tLTspZlttXT1tYShkW21dKGcsaCksZSk7bWEobCxlKTtpZihrKXtpZihrLmNvbnN0cnVjdG9yPT09ayl0aHJvdyBsYShcImlzZWNmblwiLGUpO2lmKGs9PT1VZnx8az09PVZmfHxrPT09V2YpdGhyb3cgbGEoXCJpc2VjZmZcIixlKTt9bD1rLmFwcGx5P2suYXBwbHkobCxmKTprKGZbMF0sZlsxXSxmWzJdLGZbM10sZls0XSk7cmV0dXJuIG1hKGwsZSl9fSxhcnJheURlY2xhcmF0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9W107aWYoXCJdXCIhPT10aGlzLnBlZWtUb2tlbigpLnRleHQpe2Rve2lmKHRoaXMucGVlayhcIl1cIikpYnJlYWs7YS5wdXNoKHRoaXMuZXhwcmVzc2lvbigpKX13aGlsZSh0aGlzLmV4cGVjdChcIixcIikpXG59dGhpcy5jb25zdW1lKFwiXVwiKTtyZXR1cm4geihmdW5jdGlvbihjLGQpe2Zvcih2YXIgZT1bXSxmPTAsZz1hLmxlbmd0aDtmPGc7ZisrKWUucHVzaChhW2ZdKGMsZCkpO3JldHVybiBlfSx7bGl0ZXJhbDohMCxjb25zdGFudDphLmV2ZXJ5KGVjKSxpbnB1dHM6YX0pfSxvYmplY3Q6ZnVuY3Rpb24oKXt2YXIgYT1bXSxjPVtdO2lmKFwifVwiIT09dGhpcy5wZWVrVG9rZW4oKS50ZXh0KXtkb3tpZih0aGlzLnBlZWsoXCJ9XCIpKWJyZWFrO3ZhciBkPXRoaXMuY29uc3VtZSgpO2QuY29uc3RhbnQ/YS5wdXNoKGQudmFsdWUpOmQuaWRlbnRpZmllcj9hLnB1c2goZC50ZXh0KTp0aGlzLnRocm93RXJyb3IoXCJpbnZhbGlkIGtleVwiLGQpO3RoaXMuY29uc3VtZShcIjpcIik7Yy5wdXNoKHRoaXMuZXhwcmVzc2lvbigpKX13aGlsZSh0aGlzLmV4cGVjdChcIixcIikpfXRoaXMuY29uc3VtZShcIn1cIik7cmV0dXJuIHooZnVuY3Rpb24oZCxmKXtmb3IodmFyIGc9e30saD0wLGw9Yy5sZW5ndGg7aDxsO2grKylnW2FbaF1dPVxuY1toXShkLGYpO3JldHVybiBnfSx7bGl0ZXJhbDohMCxjb25zdGFudDpjLmV2ZXJ5KGVjKSxpbnB1dHM6Y30pfX07dmFyIEJmPWhhKCksQWY9aGEoKSxDZj1PYmplY3QucHJvdG90eXBlLnZhbHVlT2YsQ2E9VChcIiRzY2VcIiksbmE9e0hUTUw6XCJodG1sXCIsQ1NTOlwiY3NzXCIsVVJMOlwidXJsXCIsUkVTT1VSQ0VfVVJMOlwicmVzb3VyY2VVcmxcIixKUzpcImpzXCJ9LGphPVQoXCIkY29tcGlsZVwiKSxaPVkuY3JlYXRlRWxlbWVudChcImFcIiksaWQ9QmEoTS5sb2NhdGlvbi5ocmVmKTtEYy4kaW5qZWN0PVtcIiRwcm92aWRlXCJdO2pkLiRpbmplY3Q9W1wiJGxvY2FsZVwiXTtsZC4kaW5qZWN0PVtcIiRsb2NhbGVcIl07dmFyIG9kPVwiLlwiLE1mPXt5eXl5OiQoXCJGdWxsWWVhclwiLDQpLHl5OiQoXCJGdWxsWWVhclwiLDIsMCwhMCkseTokKFwiRnVsbFllYXJcIiwxKSxNTU1NOkliKFwiTW9udGhcIiksTU1NOkliKFwiTW9udGhcIiwhMCksTU06JChcIk1vbnRoXCIsMiwxKSxNOiQoXCJNb250aFwiLDEsMSksZGQ6JChcIkRhdGVcIiwyKSxkOiQoXCJEYXRlXCIsXG4xKSxISDokKFwiSG91cnNcIiwyKSxIOiQoXCJIb3Vyc1wiLDEpLGhoOiQoXCJIb3Vyc1wiLDIsLTEyKSxoOiQoXCJIb3Vyc1wiLDEsLTEyKSxtbTokKFwiTWludXRlc1wiLDIpLG06JChcIk1pbnV0ZXNcIiwxKSxzczokKFwiU2Vjb25kc1wiLDIpLHM6JChcIlNlY29uZHNcIiwxKSxzc3M6JChcIk1pbGxpc2Vjb25kc1wiLDMpLEVFRUU6SWIoXCJEYXlcIiksRUVFOkliKFwiRGF5XCIsITApLGE6ZnVuY3Rpb24oYSxjKXtyZXR1cm4gMTI+YS5nZXRIb3VycygpP2MuQU1QTVNbMF06Yy5BTVBNU1sxXX0sWjpmdW5jdGlvbihhKXthPS0xKmEuZ2V0VGltZXpvbmVPZmZzZXQoKTtyZXR1cm4gYT0oMDw9YT9cIitcIjpcIlwiKSsoSGIoTWF0aFswPGE/XCJmbG9vclwiOlwiY2VpbFwiXShhLzYwKSwyKStIYihNYXRoLmFicyhhJTYwKSwyKSl9LHd3OnFkKDIpLHc6cWQoMSl9LExmPS8oKD86W155TWRIaG1zYVpFdyddKyl8KD86Jyg/OlteJ118JycpKicpfCg/OkUrfHkrfE0rfGQrfEgrfGgrfG0rfHMrfGF8Wnx3KykpKC4qKS8sS2Y9L15cXC0/XFxkKyQvO1xua2QuJGluamVjdD1bXCIkbG9jYWxlXCJdO3ZhciBIZj1kYShRKSxJZj1kYSh1Yik7bWQuJGluamVjdD1bXCIkcGFyc2VcIl07dmFyIFRkPWRhKHtyZXN0cmljdDpcIkVcIixjb21waWxlOmZ1bmN0aW9uKGEsYyl7aWYoIWMuaHJlZiYmIWMueGxpbmtIcmVmJiYhYy5uYW1lKXJldHVybiBmdW5jdGlvbihhLGMpe3ZhciBmPVwiW29iamVjdCBTVkdBbmltYXRlZFN0cmluZ11cIj09PURhLmNhbGwoYy5wcm9wKFwiaHJlZlwiKSk/XCJ4bGluazpocmVmXCI6XCJocmVmXCI7Yy5vbihcImNsaWNrXCIsZnVuY3Rpb24oYSl7Yy5hdHRyKGYpfHxhLnByZXZlbnREZWZhdWx0KCl9KX19fSksdmI9e307cyhFYixmdW5jdGlvbihhLGMpe2lmKFwibXVsdGlwbGVcIiE9YSl7dmFyIGQ9eWEoXCJuZy1cIitjKTt2YltkXT1mdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkFcIixwcmlvcml0eToxMDAsbGluazpmdW5jdGlvbihhLGYsZyl7YS4kd2F0Y2goZ1tkXSxmdW5jdGlvbihhKXtnLiRzZXQoYywhIWEpfSl9fX19fSk7cyhOYyxmdW5jdGlvbihhLFxuYyl7dmJbY109ZnVuY3Rpb24oKXtyZXR1cm57cHJpb3JpdHk6MTAwLGxpbms6ZnVuY3Rpb24oYSxlLGYpe2lmKFwibmdQYXR0ZXJuXCI9PT1jJiZcIi9cIj09Zi5uZ1BhdHRlcm4uY2hhckF0KDApJiYoZT1mLm5nUGF0dGVybi5tYXRjaChPZikpKXtmLiRzZXQoXCJuZ1BhdHRlcm5cIixuZXcgUmVnRXhwKGVbMV0sZVsyXSkpO3JldHVybn1hLiR3YXRjaChmW2NdLGZ1bmN0aW9uKGEpe2YuJHNldChjLGEpfSl9fX19KTtzKFtcInNyY1wiLFwic3Jjc2V0XCIsXCJocmVmXCJdLGZ1bmN0aW9uKGEpe3ZhciBjPXlhKFwibmctXCIrYSk7dmJbY109ZnVuY3Rpb24oKXtyZXR1cm57cHJpb3JpdHk6OTksbGluazpmdW5jdGlvbihkLGUsZil7dmFyIGc9YSxoPWE7XCJocmVmXCI9PT1hJiZcIltvYmplY3QgU1ZHQW5pbWF0ZWRTdHJpbmddXCI9PT1EYS5jYWxsKGUucHJvcChcImhyZWZcIikpJiYoaD1cInhsaW5rSHJlZlwiLGYuJGF0dHJbaF09XCJ4bGluazpocmVmXCIsZz1udWxsKTtmLiRvYnNlcnZlKGMsZnVuY3Rpb24oYyl7Yz8oZi4kc2V0KGgsXG5jKSxSYSYmZyYmZS5wcm9wKGcsZltoXSkpOlwiaHJlZlwiPT09YSYmZi4kc2V0KGgsbnVsbCl9KX19fX0pO3ZhciBKYj17JGFkZENvbnRyb2w6SCwkJHJlbmFtZUNvbnRyb2w6ZnVuY3Rpb24oYSxjKXthLiRuYW1lPWN9LCRyZW1vdmVDb250cm9sOkgsJHNldFZhbGlkaXR5OkgsJHNldERpcnR5OkgsJHNldFByaXN0aW5lOkgsJHNldFN1Ym1pdHRlZDpIfTtyZC4kaW5qZWN0PVtcIiRlbGVtZW50XCIsXCIkYXR0cnNcIixcIiRzY29wZVwiLFwiJGFuaW1hdGVcIixcIiRpbnRlcnBvbGF0ZVwiXTt2YXIgeWQ9ZnVuY3Rpb24oYSl7cmV0dXJuW1wiJHRpbWVvdXRcIixmdW5jdGlvbihjKXtyZXR1cm57bmFtZTpcImZvcm1cIixyZXN0cmljdDphP1wiRUFDXCI6XCJFXCIsY29udHJvbGxlcjpyZCxjb21waWxlOmZ1bmN0aW9uKGEpe2EuYWRkQ2xhc3MoU2EpLmFkZENsYXNzKGtiKTtyZXR1cm57cHJlOmZ1bmN0aW9uKGEsZCxnLGgpe2lmKCEoXCJhY3Rpb25cImluIGcpKXt2YXIgbD1mdW5jdGlvbihjKXthLiRhcHBseShmdW5jdGlvbigpe2guJGNvbW1pdFZpZXdWYWx1ZSgpO1xuaC4kc2V0U3VibWl0dGVkKCl9KTtjLnByZXZlbnREZWZhdWx0KCl9O2RbMF0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLGwsITEpO2Qub24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7YyhmdW5jdGlvbigpe2RbMF0ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLGwsITEpfSwwLCExKX0pfXZhciBrPWguJCRwYXJlbnRGb3JtLG09aC4kbmFtZTttJiYoZ2IoYSxudWxsLG0saCxtKSxnLiRvYnNlcnZlKGcubmFtZT9cIm5hbWVcIjpcIm5nRm9ybVwiLGZ1bmN0aW9uKGMpe20hPT1jJiYoZ2IoYSxudWxsLG0sdCxtKSxtPWMsZ2IoYSxudWxsLG0saCxtKSxrLiQkcmVuYW1lQ29udHJvbChoLG0pKX0pKTtkLm9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe2suJHJlbW92ZUNvbnRyb2woaCk7bSYmZ2IoYSxudWxsLG0sdCxtKTt6KGgsSmIpfSl9fX19fV19LFVkPXlkKCksZ2U9eWQoITApLE5mPS9cXGR7NH0tWzAxXVxcZC1bMC0zXVxcZFRbMC0yXVxcZDpbMC01XVxcZDpbMC01XVxcZFxcLlxcZCsoWystXVswLTJdXFxkOlswLTVdXFxkfFopLyxcbllmPS9eKGZ0cHxodHRwfGh0dHBzKTpcXC9cXC8oXFx3Kzp7MCwxfVxcdypAKT8oXFxTKykoOlswLTldKyk/KFxcL3xcXC8oW1xcdyMhOi4/Kz0mJUAhXFwtXFwvXSkpPyQvLFpmPS9eW2EtejAtOSEjJCUmJyorXFwvPT9eX2B7fH1+Li1dK0BbYS16MC05XShbYS16MC05LV0qW2EtejAtOV0pPyhcXC5bYS16MC05XShbYS16MC05LV0qW2EtejAtOV0pPykqJC9pLCRmPS9eXFxzKihcXC18XFwrKT8oXFxkK3woXFxkKihcXC5cXGQqKSkpXFxzKiQvLHpkPS9eKFxcZHs0fSktKFxcZHsyfSktKFxcZHsyfSkkLyxBZD0vXihcXGR7NH0pLShcXGRcXGQpLShcXGRcXGQpVChcXGRcXGQpOihcXGRcXGQpKD86OihcXGRcXGQpKFxcLlxcZHsxLDN9KT8pPyQvLGpjPS9eKFxcZHs0fSktVyhcXGRcXGQpJC8sQmQ9L14oXFxkezR9KS0oXFxkXFxkKSQvLENkPS9eKFxcZFxcZCk6KFxcZFxcZCkoPzo6KFxcZFxcZCkoXFwuXFxkezEsM30pPyk/JC8sRGQ9e3RleHQ6ZnVuY3Rpb24oYSxjLGQsZSxmLGcpe2liKGEsYyxkLGUsZixnKTtoYyhlKX0sZGF0ZTpqYihcImRhdGVcIix6ZCxMYih6ZCxbXCJ5eXl5XCIsXG5cIk1NXCIsXCJkZFwiXSksXCJ5eXl5LU1NLWRkXCIpLFwiZGF0ZXRpbWUtbG9jYWxcIjpqYihcImRhdGV0aW1lbG9jYWxcIixBZCxMYihBZCxcInl5eXkgTU0gZGQgSEggbW0gc3Mgc3NzXCIuc3BsaXQoXCIgXCIpKSxcInl5eXktTU0tZGRUSEg6bW06c3Muc3NzXCIpLHRpbWU6amIoXCJ0aW1lXCIsQ2QsTGIoQ2QsW1wiSEhcIixcIm1tXCIsXCJzc1wiLFwic3NzXCJdKSxcIkhIOm1tOnNzLnNzc1wiKSx3ZWVrOmpiKFwid2Vla1wiLGpjLGZ1bmN0aW9uKGEsYyl7aWYocWEoYSkpcmV0dXJuIGE7aWYoRihhKSl7amMubGFzdEluZGV4PTA7dmFyIGQ9amMuZXhlYyhhKTtpZihkKXt2YXIgZT0rZFsxXSxmPStkWzJdLGc9ZD0wLGg9MCxsPTAsaz1wZChlKSxmPTcqKGYtMSk7YyYmKGQ9Yy5nZXRIb3VycygpLGc9Yy5nZXRNaW51dGVzKCksaD1jLmdldFNlY29uZHMoKSxsPWMuZ2V0TWlsbGlzZWNvbmRzKCkpO3JldHVybiBuZXcgRGF0ZShlLDAsay5nZXREYXRlKCkrZixkLGcsaCxsKX19cmV0dXJuIE5hTn0sXCJ5eXl5LVd3d1wiKSxtb250aDpqYihcIm1vbnRoXCIsXG5CZCxMYihCZCxbXCJ5eXl5XCIsXCJNTVwiXSksXCJ5eXl5LU1NXCIpLG51bWJlcjpmdW5jdGlvbihhLGMsZCxlLGYsZyl7dGQoYSxjLGQsZSk7aWIoYSxjLGQsZSxmLGcpO2UuJCRwYXJzZXJOYW1lPVwibnVtYmVyXCI7ZS4kcGFyc2Vycy5wdXNoKGZ1bmN0aW9uKGEpe3JldHVybiBlLiRpc0VtcHR5KGEpP251bGw6JGYudGVzdChhKT9wYXJzZUZsb2F0KGEpOnR9KTtlLiRmb3JtYXR0ZXJzLnB1c2goZnVuY3Rpb24oYSl7aWYoIWUuJGlzRW1wdHkoYSkpe2lmKCFWKGEpKXRocm93IE1iKFwibnVtZm10XCIsYSk7YT1hLnRvU3RyaW5nKCl9cmV0dXJuIGF9KTtpZihkLm1pbnx8ZC5uZ01pbil7dmFyIGg7ZS4kdmFsaWRhdG9ycy5taW49ZnVuY3Rpb24oYSl7cmV0dXJuIGUuJGlzRW1wdHkoYSl8fEEoaCl8fGE+PWh9O2QuJG9ic2VydmUoXCJtaW5cIixmdW5jdGlvbihhKXt5KGEpJiYhVihhKSYmKGE9cGFyc2VGbG9hdChhLDEwKSk7aD1WKGEpJiYhaXNOYU4oYSk/YTp0O2UuJHZhbGlkYXRlKCl9KX1pZihkLm1heHx8XG5kLm5nTWF4KXt2YXIgbDtlLiR2YWxpZGF0b3JzLm1heD1mdW5jdGlvbihhKXtyZXR1cm4gZS4kaXNFbXB0eShhKXx8QShsKXx8YTw9bH07ZC4kb2JzZXJ2ZShcIm1heFwiLGZ1bmN0aW9uKGEpe3koYSkmJiFWKGEpJiYoYT1wYXJzZUZsb2F0KGEsMTApKTtsPVYoYSkmJiFpc05hTihhKT9hOnQ7ZS4kdmFsaWRhdGUoKX0pfX0sdXJsOmZ1bmN0aW9uKGEsYyxkLGUsZixnKXtpYihhLGMsZCxlLGYsZyk7aGMoZSk7ZS4kJHBhcnNlck5hbWU9XCJ1cmxcIjtlLiR2YWxpZGF0b3JzLnVybD1mdW5jdGlvbihhLGMpe3ZhciBkPWF8fGM7cmV0dXJuIGUuJGlzRW1wdHkoZCl8fFlmLnRlc3QoZCl9fSxlbWFpbDpmdW5jdGlvbihhLGMsZCxlLGYsZyl7aWIoYSxjLGQsZSxmLGcpO2hjKGUpO2UuJCRwYXJzZXJOYW1lPVwiZW1haWxcIjtlLiR2YWxpZGF0b3JzLmVtYWlsPWZ1bmN0aW9uKGEsYyl7dmFyIGQ9YXx8YztyZXR1cm4gZS4kaXNFbXB0eShkKXx8WmYudGVzdChkKX19LHJhZGlvOmZ1bmN0aW9uKGEsYyxcbmQsZSl7QShkLm5hbWUpJiZjLmF0dHIoXCJuYW1lXCIsKytuYik7Yy5vbihcImNsaWNrXCIsZnVuY3Rpb24oYSl7Y1swXS5jaGVja2VkJiZlLiRzZXRWaWV3VmFsdWUoZC52YWx1ZSxhJiZhLnR5cGUpfSk7ZS4kcmVuZGVyPWZ1bmN0aW9uKCl7Y1swXS5jaGVja2VkPWQudmFsdWU9PWUuJHZpZXdWYWx1ZX07ZC4kb2JzZXJ2ZShcInZhbHVlXCIsZS4kcmVuZGVyKX0sY2hlY2tib3g6ZnVuY3Rpb24oYSxjLGQsZSxmLGcsaCxsKXt2YXIgaz11ZChsLGEsXCJuZ1RydWVWYWx1ZVwiLGQubmdUcnVlVmFsdWUsITApLG09dWQobCxhLFwibmdGYWxzZVZhbHVlXCIsZC5uZ0ZhbHNlVmFsdWUsITEpO2Mub24oXCJjbGlja1wiLGZ1bmN0aW9uKGEpe2UuJHNldFZpZXdWYWx1ZShjWzBdLmNoZWNrZWQsYSYmYS50eXBlKX0pO2UuJHJlbmRlcj1mdW5jdGlvbigpe2NbMF0uY2hlY2tlZD1lLiR2aWV3VmFsdWV9O2UuJGlzRW1wdHk9ZnVuY3Rpb24oYSl7cmV0dXJuITE9PT1hfTtlLiRmb3JtYXR0ZXJzLnB1c2goZnVuY3Rpb24oYSl7cmV0dXJuIGZhKGEsXG5rKX0pO2UuJHBhcnNlcnMucHVzaChmdW5jdGlvbihhKXtyZXR1cm4gYT9rOm19KX0saGlkZGVuOkgsYnV0dG9uOkgsc3VibWl0OkgscmVzZXQ6SCxmaWxlOkh9LHhjPVtcIiRicm93c2VyXCIsXCIkc25pZmZlclwiLFwiJGZpbHRlclwiLFwiJHBhcnNlXCIsZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJue3Jlc3RyaWN0OlwiRVwiLHJlcXVpcmU6W1wiP25nTW9kZWxcIl0sbGluazp7cHJlOmZ1bmN0aW9uKGYsZyxoLGwpe2xbMF0mJihEZFtRKGgudHlwZSldfHxEZC50ZXh0KShmLGcsaCxsWzBdLGMsYSxkLGUpfX19fV0sYWc9L14odHJ1ZXxmYWxzZXxcXGQrKSQvLHllPWZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiQVwiLHByaW9yaXR5OjEwMCxjb21waWxlOmZ1bmN0aW9uKGEsYyl7cmV0dXJuIGFnLnRlc3QoYy5uZ1ZhbHVlKT9mdW5jdGlvbihhLGMsZil7Zi4kc2V0KFwidmFsdWVcIixhLiRldmFsKGYubmdWYWx1ZSkpfTpmdW5jdGlvbihhLGMsZil7YS4kd2F0Y2goZi5uZ1ZhbHVlLGZ1bmN0aW9uKGEpe2YuJHNldChcInZhbHVlXCIsXG5hKX0pfX19fSxaZD1bXCIkY29tcGlsZVwiLGZ1bmN0aW9uKGEpe3JldHVybntyZXN0cmljdDpcIkFDXCIsY29tcGlsZTpmdW5jdGlvbihjKXthLiQkYWRkQmluZGluZ0NsYXNzKGMpO3JldHVybiBmdW5jdGlvbihjLGUsZil7YS4kJGFkZEJpbmRpbmdJbmZvKGUsZi5uZ0JpbmQpO2U9ZVswXTtjLiR3YXRjaChmLm5nQmluZCxmdW5jdGlvbihhKXtlLnRleHRDb250ZW50PWE9PT10P1wiXCI6YX0pfX19fV0sYWU9W1wiJGludGVycG9sYXRlXCIsXCIkY29tcGlsZVwiLGZ1bmN0aW9uKGEsYyl7cmV0dXJue2NvbXBpbGU6ZnVuY3Rpb24oZCl7Yy4kJGFkZEJpbmRpbmdDbGFzcyhkKTtyZXR1cm4gZnVuY3Rpb24oZCxmLGcpe2Q9YShmLmF0dHIoZy4kYXR0ci5uZ0JpbmRUZW1wbGF0ZSkpO2MuJCRhZGRCaW5kaW5nSW5mbyhmLGQuZXhwcmVzc2lvbnMpO2Y9ZlswXTtnLiRvYnNlcnZlKFwibmdCaW5kVGVtcGxhdGVcIixmdW5jdGlvbihhKXtmLnRleHRDb250ZW50PWE9PT10P1wiXCI6YX0pfX19fV0sJGQ9W1wiJHNjZVwiLFxuXCIkcGFyc2VcIixcIiRjb21waWxlXCIsZnVuY3Rpb24oYSxjLGQpe3JldHVybntyZXN0cmljdDpcIkFcIixjb21waWxlOmZ1bmN0aW9uKGUsZil7dmFyIGc9YyhmLm5nQmluZEh0bWwpLGg9YyhmLm5nQmluZEh0bWwsZnVuY3Rpb24oYSl7cmV0dXJuKGF8fFwiXCIpLnRvU3RyaW5nKCl9KTtkLiQkYWRkQmluZGluZ0NsYXNzKGUpO3JldHVybiBmdW5jdGlvbihjLGUsZil7ZC4kJGFkZEJpbmRpbmdJbmZvKGUsZi5uZ0JpbmRIdG1sKTtjLiR3YXRjaChoLGZ1bmN0aW9uKCl7ZS5odG1sKGEuZ2V0VHJ1c3RlZEh0bWwoZyhjKSl8fFwiXCIpfSl9fX19XSx4ZT1kYSh7cmVzdHJpY3Q6XCJBXCIscmVxdWlyZTpcIm5nTW9kZWxcIixsaW5rOmZ1bmN0aW9uKGEsYyxkLGUpe2UuJHZpZXdDaGFuZ2VMaXN0ZW5lcnMucHVzaChmdW5jdGlvbigpe2EuJGV2YWwoZC5uZ0NoYW5nZSl9KX19KSxiZT1pYyhcIlwiLCEwKSxkZT1pYyhcIk9kZFwiLDApLGNlPWljKFwiRXZlblwiLDEpLGVlPUphKHtjb21waWxlOmZ1bmN0aW9uKGEsYyl7Yy4kc2V0KFwibmdDbG9ha1wiLFxudCk7YS5yZW1vdmVDbGFzcyhcIm5nLWNsb2FrXCIpfX0pLGZlPVtmdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkFcIixzY29wZTohMCxjb250cm9sbGVyOlwiQFwiLHByaW9yaXR5OjUwMH19XSxDYz17fSxiZz17Ymx1cjohMCxmb2N1czohMH07cyhcImNsaWNrIGRibGNsaWNrIG1vdXNlZG93biBtb3VzZXVwIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZW1vdmUgbW91c2VlbnRlciBtb3VzZWxlYXZlIGtleWRvd24ga2V5dXAga2V5cHJlc3Mgc3VibWl0IGZvY3VzIGJsdXIgY29weSBjdXQgcGFzdGVcIi5zcGxpdChcIiBcIiksZnVuY3Rpb24oYSl7dmFyIGM9eWEoXCJuZy1cIithKTtDY1tjXT1bXCIkcGFyc2VcIixcIiRyb290U2NvcGVcIixmdW5jdGlvbihkLGUpe3JldHVybntyZXN0cmljdDpcIkFcIixjb21waWxlOmZ1bmN0aW9uKGYsZyl7dmFyIGg9ZChnW2NdLG51bGwsITApO3JldHVybiBmdW5jdGlvbihjLGQpe2Qub24oYSxmdW5jdGlvbihkKXt2YXIgZj1mdW5jdGlvbigpe2goYyx7JGV2ZW50OmR9KX07XG5iZ1thXSYmZS4kJHBoYXNlP2MuJGV2YWxBc3luYyhmKTpjLiRhcHBseShmKX0pfX19fV19KTt2YXIgaWU9W1wiJGFuaW1hdGVcIixmdW5jdGlvbihhKXtyZXR1cm57bXVsdGlFbGVtZW50OiEwLHRyYW5zY2x1ZGU6XCJlbGVtZW50XCIscHJpb3JpdHk6NjAwLHRlcm1pbmFsOiEwLHJlc3RyaWN0OlwiQVwiLCQkdGxiOiEwLGxpbms6ZnVuY3Rpb24oYyxkLGUsZixnKXt2YXIgaCxsLGs7Yy4kd2F0Y2goZS5uZ0lmLGZ1bmN0aW9uKGMpe2M/bHx8ZyhmdW5jdGlvbihjLGYpe2w9ZjtjW2MubGVuZ3RoKytdPVkuY3JlYXRlQ29tbWVudChcIiBlbmQgbmdJZjogXCIrZS5uZ0lmK1wiIFwiKTtoPXtjbG9uZTpjfTthLmVudGVyKGMsZC5wYXJlbnQoKSxkKX0pOihrJiYoay5yZW1vdmUoKSxrPW51bGwpLGwmJihsLiRkZXN0cm95KCksbD1udWxsKSxoJiYoaz10YihoLmNsb25lKSxhLmxlYXZlKGspLnRoZW4oZnVuY3Rpb24oKXtrPW51bGx9KSxoPW51bGwpKX0pfX19XSxqZT1bXCIkdGVtcGxhdGVSZXF1ZXN0XCIsXCIkYW5jaG9yU2Nyb2xsXCIsXG5cIiRhbmltYXRlXCIsXCIkc2NlXCIsZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJue3Jlc3RyaWN0OlwiRUNBXCIscHJpb3JpdHk6NDAwLHRlcm1pbmFsOiEwLHRyYW5zY2x1ZGU6XCJlbGVtZW50XCIsY29udHJvbGxlcjpnYS5ub29wLGNvbXBpbGU6ZnVuY3Rpb24oZixnKXt2YXIgaD1nLm5nSW5jbHVkZXx8Zy5zcmMsbD1nLm9ubG9hZHx8XCJcIixrPWcuYXV0b3Njcm9sbDtyZXR1cm4gZnVuY3Rpb24oZixnLHEscyxyKXt2YXIgdD0wLG4sdix3LEw9ZnVuY3Rpb24oKXt2JiYodi5yZW1vdmUoKSx2PW51bGwpO24mJihuLiRkZXN0cm95KCksbj1udWxsKTt3JiYoZC5sZWF2ZSh3KS50aGVuKGZ1bmN0aW9uKCl7dj1udWxsfSksdj13LHc9bnVsbCl9O2YuJHdhdGNoKGUucGFyc2VBc1Jlc291cmNlVXJsKGgpLGZ1bmN0aW9uKGUpe3ZhciBoPWZ1bmN0aW9uKCl7IXkoayl8fGsmJiFmLiRldmFsKGspfHxjKCl9LHE9Kyt0O2U/KGEoZSwhMCkudGhlbihmdW5jdGlvbihhKXtpZihxPT09dCl7dmFyIGM9Zi4kbmV3KCk7XG5zLnRlbXBsYXRlPWE7YT1yKGMsZnVuY3Rpb24oYSl7TCgpO2QuZW50ZXIoYSxudWxsLGcpLnRoZW4oaCl9KTtuPWM7dz1hO24uJGVtaXQoXCIkaW5jbHVkZUNvbnRlbnRMb2FkZWRcIixlKTtmLiRldmFsKGwpfX0sZnVuY3Rpb24oKXtxPT09dCYmKEwoKSxmLiRlbWl0KFwiJGluY2x1ZGVDb250ZW50RXJyb3JcIixlKSl9KSxmLiRlbWl0KFwiJGluY2x1ZGVDb250ZW50UmVxdWVzdGVkXCIsZSkpOihMKCkscy50ZW1wbGF0ZT1udWxsKX0pfX19fV0sQWU9W1wiJGNvbXBpbGVcIixmdW5jdGlvbihhKXtyZXR1cm57cmVzdHJpY3Q6XCJFQ0FcIixwcmlvcml0eTotNDAwLHJlcXVpcmU6XCJuZ0luY2x1ZGVcIixsaW5rOmZ1bmN0aW9uKGMsZCxlLGYpey9TVkcvLnRlc3QoZFswXS50b1N0cmluZygpKT8oZC5lbXB0eSgpLGEoRmMoZi50ZW1wbGF0ZSxZKS5jaGlsZE5vZGVzKShjLGZ1bmN0aW9uKGEpe2QuYXBwZW5kKGEpfSx7ZnV0dXJlUGFyZW50RWxlbWVudDpkfSkpOihkLmh0bWwoZi50ZW1wbGF0ZSksYShkLmNvbnRlbnRzKCkpKGMpKX19fV0sXG5rZT1KYSh7cHJpb3JpdHk6NDUwLGNvbXBpbGU6ZnVuY3Rpb24oKXtyZXR1cm57cHJlOmZ1bmN0aW9uKGEsYyxkKXthLiRldmFsKGQubmdJbml0KX19fX0pLHdlPWZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiQVwiLHByaW9yaXR5OjEwMCxyZXF1aXJlOlwibmdNb2RlbFwiLGxpbms6ZnVuY3Rpb24oYSxjLGQsZSl7dmFyIGY9Yy5hdHRyKGQuJGF0dHIubmdMaXN0KXx8XCIsIFwiLGc9XCJmYWxzZVwiIT09ZC5uZ1RyaW0saD1nP1UoZik6ZjtlLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24oYSl7aWYoIUEoYSkpe3ZhciBjPVtdO2EmJnMoYS5zcGxpdChoKSxmdW5jdGlvbihhKXthJiZjLnB1c2goZz9VKGEpOmEpfSk7cmV0dXJuIGN9fSk7ZS4kZm9ybWF0dGVycy5wdXNoKGZ1bmN0aW9uKGEpe3JldHVybiBEKGEpP2Euam9pbihmKTp0fSk7ZS4kaXNFbXB0eT1mdW5jdGlvbihhKXtyZXR1cm4hYXx8IWEubGVuZ3RofX19fSxrYj1cIm5nLXZhbGlkXCIsdmQ9XCJuZy1pbnZhbGlkXCIsU2E9XCJuZy1wcmlzdGluZVwiLFxuS2I9XCJuZy1kaXJ0eVwiLHhkPVwibmctcGVuZGluZ1wiLE1iPW5ldyBUKFwibmdNb2RlbFwiKSxjZz1bXCIkc2NvcGVcIixcIiRleGNlcHRpb25IYW5kbGVyXCIsXCIkYXR0cnNcIixcIiRlbGVtZW50XCIsXCIkcGFyc2VcIixcIiRhbmltYXRlXCIsXCIkdGltZW91dFwiLFwiJHJvb3RTY29wZVwiLFwiJHFcIixcIiRpbnRlcnBvbGF0ZVwiLGZ1bmN0aW9uKGEsYyxkLGUsZixnLGgsbCxrLG0pe3RoaXMuJG1vZGVsVmFsdWU9dGhpcy4kdmlld1ZhbHVlPU51bWJlci5OYU47dGhpcy4kJHJhd01vZGVsVmFsdWU9dDt0aGlzLiR2YWxpZGF0b3JzPXt9O3RoaXMuJGFzeW5jVmFsaWRhdG9ycz17fTt0aGlzLiRwYXJzZXJzPVtdO3RoaXMuJGZvcm1hdHRlcnM9W107dGhpcy4kdmlld0NoYW5nZUxpc3RlbmVycz1bXTt0aGlzLiR1bnRvdWNoZWQ9ITA7dGhpcy4kdG91Y2hlZD0hMTt0aGlzLiRwcmlzdGluZT0hMDt0aGlzLiRkaXJ0eT0hMTt0aGlzLiR2YWxpZD0hMDt0aGlzLiRpbnZhbGlkPSExO3RoaXMuJGVycm9yPXt9O3RoaXMuJCRzdWNjZXNzPVxue307dGhpcy4kcGVuZGluZz10O3RoaXMuJG5hbWU9bShkLm5hbWV8fFwiXCIsITEpKGEpO3ZhciBwPWYoZC5uZ01vZGVsKSxxPXAuYXNzaWduLHU9cCxyPXEsTz1udWxsLG49dGhpczt0aGlzLiQkc2V0T3B0aW9ucz1mdW5jdGlvbihhKXtpZigobi4kb3B0aW9ucz1hKSYmYS5nZXR0ZXJTZXR0ZXIpe3ZhciBjPWYoZC5uZ01vZGVsK1wiKClcIiksZz1mKGQubmdNb2RlbCtcIigkJCRwKVwiKTt1PWZ1bmN0aW9uKGEpe3ZhciBkPXAoYSk7RyhkKSYmKGQ9YyhhKSk7cmV0dXJuIGR9O3I9ZnVuY3Rpb24oYSxjKXtHKHAoYSkpP2coYSx7JCQkcDpuLiRtb2RlbFZhbHVlfSk6cShhLG4uJG1vZGVsVmFsdWUpfX1lbHNlIGlmKCFwLmFzc2lnbil0aHJvdyBNYihcIm5vbmFzc2lnblwiLGQubmdNb2RlbCx2YShlKSk7fTt0aGlzLiRyZW5kZXI9SDt0aGlzLiRpc0VtcHR5PWZ1bmN0aW9uKGEpe3JldHVybiBBKGEpfHxcIlwiPT09YXx8bnVsbD09PWF8fGEhPT1hfTt2YXIgdj1lLmluaGVyaXRlZERhdGEoXCIkZm9ybUNvbnRyb2xsZXJcIil8fFxuSmIsdz0wO3NkKHtjdHJsOnRoaXMsJGVsZW1lbnQ6ZSxzZXQ6ZnVuY3Rpb24oYSxjKXthW2NdPSEwfSx1bnNldDpmdW5jdGlvbihhLGMpe2RlbGV0ZSBhW2NdfSxwYXJlbnRGb3JtOnYsJGFuaW1hdGU6Z30pO3RoaXMuJHNldFByaXN0aW5lPWZ1bmN0aW9uKCl7bi4kZGlydHk9ITE7bi4kcHJpc3RpbmU9ITA7Zy5yZW1vdmVDbGFzcyhlLEtiKTtnLmFkZENsYXNzKGUsU2EpfTt0aGlzLiRzZXREaXJ0eT1mdW5jdGlvbigpe24uJGRpcnR5PSEwO24uJHByaXN0aW5lPSExO2cucmVtb3ZlQ2xhc3MoZSxTYSk7Zy5hZGRDbGFzcyhlLEtiKTt2LiRzZXREaXJ0eSgpfTt0aGlzLiRzZXRVbnRvdWNoZWQ9ZnVuY3Rpb24oKXtuLiR0b3VjaGVkPSExO24uJHVudG91Y2hlZD0hMDtnLnNldENsYXNzKGUsXCJuZy11bnRvdWNoZWRcIixcIm5nLXRvdWNoZWRcIil9O3RoaXMuJHNldFRvdWNoZWQ9ZnVuY3Rpb24oKXtuLiR0b3VjaGVkPSEwO24uJHVudG91Y2hlZD0hMTtnLnNldENsYXNzKGUsXCJuZy10b3VjaGVkXCIsXG5cIm5nLXVudG91Y2hlZFwiKX07dGhpcy4kcm9sbGJhY2tWaWV3VmFsdWU9ZnVuY3Rpb24oKXtoLmNhbmNlbChPKTtuLiR2aWV3VmFsdWU9bi4kJGxhc3RDb21taXR0ZWRWaWV3VmFsdWU7bi4kcmVuZGVyKCl9O3RoaXMuJHZhbGlkYXRlPWZ1bmN0aW9uKCl7aWYoIVYobi4kbW9kZWxWYWx1ZSl8fCFpc05hTihuLiRtb2RlbFZhbHVlKSl7dmFyIGE9bi4kJHJhd01vZGVsVmFsdWUsYz1uLiR2YWxpZCxkPW4uJG1vZGVsVmFsdWUsZT1uLiRvcHRpb25zJiZuLiRvcHRpb25zLmFsbG93SW52YWxpZDtuLiQkcnVuVmFsaWRhdG9ycyhuLiRlcnJvcltuLiQkcGFyc2VyTmFtZXx8XCJwYXJzZVwiXT8hMTp0LGEsbi4kJGxhc3RDb21taXR0ZWRWaWV3VmFsdWUsZnVuY3Rpb24oZil7ZXx8Yz09PWZ8fChuLiRtb2RlbFZhbHVlPWY/YTp0LG4uJG1vZGVsVmFsdWUhPT1kJiZuLiQkd3JpdGVNb2RlbFRvU2NvcGUoKSl9KX19O3RoaXMuJCRydW5WYWxpZGF0b3JzPWZ1bmN0aW9uKGEsYyxkLGUpe2Z1bmN0aW9uIGYoKXt2YXIgYT1cbiEwO3Mobi4kdmFsaWRhdG9ycyxmdW5jdGlvbihlLGYpe3ZhciBnPWUoYyxkKTthPWEmJmc7aChmLGcpfSk7cmV0dXJuIGE/ITA6KHMobi4kYXN5bmNWYWxpZGF0b3JzLGZ1bmN0aW9uKGEsYyl7aChjLG51bGwpfSksITEpfWZ1bmN0aW9uIGcoKXt2YXIgYT1bXSxlPSEwO3Mobi4kYXN5bmNWYWxpZGF0b3JzLGZ1bmN0aW9uKGYsZyl7dmFyIGw9ZihjLGQpO2lmKCFsfHwhRyhsLnRoZW4pKXRocm93IE1iKFwiJGFzeW5jVmFsaWRhdG9yc1wiLGwpO2goZyx0KTthLnB1c2gobC50aGVuKGZ1bmN0aW9uKCl7aChnLCEwKX0sZnVuY3Rpb24oYSl7ZT0hMTtoKGcsITEpfSkpfSk7YS5sZW5ndGg/ay5hbGwoYSkudGhlbihmdW5jdGlvbigpe2woZSl9LEgpOmwoITApfWZ1bmN0aW9uIGgoYSxjKXttPT09dyYmbi4kc2V0VmFsaWRpdHkoYSxjKX1mdW5jdGlvbiBsKGEpe209PT13JiZlKGEpfXcrKzt2YXIgbT13OyhmdW5jdGlvbihhKXt2YXIgYz1uLiQkcGFyc2VyTmFtZXx8XCJwYXJzZVwiO2lmKGE9PT1cbnQpaChjLG51bGwpO2Vsc2UgaWYoaChjLGEpLCFhKXJldHVybiBzKG4uJHZhbGlkYXRvcnMsZnVuY3Rpb24oYSxjKXtoKGMsbnVsbCl9KSxzKG4uJGFzeW5jVmFsaWRhdG9ycyxmdW5jdGlvbihhLGMpe2goYyxudWxsKX0pLCExO3JldHVybiEwfSkoYSk/ZigpP2coKTpsKCExKTpsKCExKX07dGhpcy4kY29tbWl0Vmlld1ZhbHVlPWZ1bmN0aW9uKCl7dmFyIGE9bi4kdmlld1ZhbHVlO2guY2FuY2VsKE8pO2lmKG4uJCRsYXN0Q29tbWl0dGVkVmlld1ZhbHVlIT09YXx8XCJcIj09PWEmJm4uJCRoYXNOYXRpdmVWYWxpZGF0b3JzKW4uJCRsYXN0Q29tbWl0dGVkVmlld1ZhbHVlPWEsbi4kcHJpc3RpbmUmJnRoaXMuJHNldERpcnR5KCksdGhpcy4kJHBhcnNlQW5kVmFsaWRhdGUoKX07dGhpcy4kJHBhcnNlQW5kVmFsaWRhdGU9ZnVuY3Rpb24oKXt2YXIgYz1uLiQkbGFzdENvbW1pdHRlZFZpZXdWYWx1ZSxkPUEoYyk/dDohMDtpZihkKWZvcih2YXIgZT0wO2U8bi4kcGFyc2Vycy5sZW5ndGg7ZSsrKWlmKGM9XG5uLiRwYXJzZXJzW2VdKGMpLEEoYykpe2Q9ITE7YnJlYWt9VihuLiRtb2RlbFZhbHVlKSYmaXNOYU4obi4kbW9kZWxWYWx1ZSkmJihuLiRtb2RlbFZhbHVlPXUoYSkpO3ZhciBmPW4uJG1vZGVsVmFsdWUsZz1uLiRvcHRpb25zJiZuLiRvcHRpb25zLmFsbG93SW52YWxpZDtuLiQkcmF3TW9kZWxWYWx1ZT1jO2cmJihuLiRtb2RlbFZhbHVlPWMsbi4kbW9kZWxWYWx1ZSE9PWYmJm4uJCR3cml0ZU1vZGVsVG9TY29wZSgpKTtuLiQkcnVuVmFsaWRhdG9ycyhkLGMsbi4kJGxhc3RDb21taXR0ZWRWaWV3VmFsdWUsZnVuY3Rpb24oYSl7Z3x8KG4uJG1vZGVsVmFsdWU9YT9jOnQsbi4kbW9kZWxWYWx1ZSE9PWYmJm4uJCR3cml0ZU1vZGVsVG9TY29wZSgpKX0pfTt0aGlzLiQkd3JpdGVNb2RlbFRvU2NvcGU9ZnVuY3Rpb24oKXtyKGEsbi4kbW9kZWxWYWx1ZSk7cyhuLiR2aWV3Q2hhbmdlTGlzdGVuZXJzLGZ1bmN0aW9uKGEpe3RyeXthKCl9Y2F0Y2goZCl7YyhkKX19KX07dGhpcy4kc2V0Vmlld1ZhbHVlPVxuZnVuY3Rpb24oYSxjKXtuLiR2aWV3VmFsdWU9YTtuLiRvcHRpb25zJiYhbi4kb3B0aW9ucy51cGRhdGVPbkRlZmF1bHR8fG4uJCRkZWJvdW5jZVZpZXdWYWx1ZUNvbW1pdChjKX07dGhpcy4kJGRlYm91bmNlVmlld1ZhbHVlQ29tbWl0PWZ1bmN0aW9uKGMpe3ZhciBkPTAsZT1uLiRvcHRpb25zO2UmJnkoZS5kZWJvdW5jZSkmJihlPWUuZGVib3VuY2UsVihlKT9kPWU6VihlW2NdKT9kPWVbY106VihlW1wiZGVmYXVsdFwiXSkmJihkPWVbXCJkZWZhdWx0XCJdKSk7aC5jYW5jZWwoTyk7ZD9PPWgoZnVuY3Rpb24oKXtuLiRjb21taXRWaWV3VmFsdWUoKX0sZCk6bC4kJHBoYXNlP24uJGNvbW1pdFZpZXdWYWx1ZSgpOmEuJGFwcGx5KGZ1bmN0aW9uKCl7bi4kY29tbWl0Vmlld1ZhbHVlKCl9KX07YS4kd2F0Y2goZnVuY3Rpb24oKXt2YXIgYz11KGEpO2lmKGMhPT1uLiRtb2RlbFZhbHVlKXtuLiRtb2RlbFZhbHVlPW4uJCRyYXdNb2RlbFZhbHVlPWM7Zm9yKHZhciBkPW4uJGZvcm1hdHRlcnMsZT1kLmxlbmd0aCxcbmY9YztlLS07KWY9ZFtlXShmKTtuLiR2aWV3VmFsdWUhPT1mJiYobi4kdmlld1ZhbHVlPW4uJCRsYXN0Q29tbWl0dGVkVmlld1ZhbHVlPWYsbi4kcmVuZGVyKCksbi4kJHJ1blZhbGlkYXRvcnModCxjLGYsSCkpfXJldHVybiBjfSl9XSx2ZT1bXCIkcm9vdFNjb3BlXCIsZnVuY3Rpb24oYSl7cmV0dXJue3Jlc3RyaWN0OlwiQVwiLHJlcXVpcmU6W1wibmdNb2RlbFwiLFwiXj9mb3JtXCIsXCJeP25nTW9kZWxPcHRpb25zXCJdLGNvbnRyb2xsZXI6Y2cscHJpb3JpdHk6MSxjb21waWxlOmZ1bmN0aW9uKGMpe2MuYWRkQ2xhc3MoU2EpLmFkZENsYXNzKFwibmctdW50b3VjaGVkXCIpLmFkZENsYXNzKGtiKTtyZXR1cm57cHJlOmZ1bmN0aW9uKGEsYyxmLGcpe3ZhciBoPWdbMF0sbD1nWzFdfHxKYjtoLiQkc2V0T3B0aW9ucyhnWzJdJiZnWzJdLiRvcHRpb25zKTtsLiRhZGRDb250cm9sKGgpO2YuJG9ic2VydmUoXCJuYW1lXCIsZnVuY3Rpb24oYSl7aC4kbmFtZSE9PWEmJmwuJCRyZW5hbWVDb250cm9sKGgsYSl9KTthLiRvbihcIiRkZXN0cm95XCIsXG5mdW5jdGlvbigpe2wuJHJlbW92ZUNvbnRyb2woaCl9KX0scG9zdDpmdW5jdGlvbihjLGUsZixnKXt2YXIgaD1nWzBdO2lmKGguJG9wdGlvbnMmJmguJG9wdGlvbnMudXBkYXRlT24pZS5vbihoLiRvcHRpb25zLnVwZGF0ZU9uLGZ1bmN0aW9uKGEpe2guJCRkZWJvdW5jZVZpZXdWYWx1ZUNvbW1pdChhJiZhLnR5cGUpfSk7ZS5vbihcImJsdXJcIixmdW5jdGlvbihlKXtoLiR0b3VjaGVkfHwoYS4kJHBoYXNlP2MuJGV2YWxBc3luYyhoLiRzZXRUb3VjaGVkKTpjLiRhcHBseShoLiRzZXRUb3VjaGVkKSl9KX19fX19XSxkZz0vKFxccyt8XilkZWZhdWx0KFxccyt8JCkvLHplPWZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiQVwiLGNvbnRyb2xsZXI6W1wiJHNjb3BlXCIsXCIkYXR0cnNcIixmdW5jdGlvbihhLGMpe3ZhciBkPXRoaXM7dGhpcy4kb3B0aW9ucz1hLiRldmFsKGMubmdNb2RlbE9wdGlvbnMpO3RoaXMuJG9wdGlvbnMudXBkYXRlT24hPT10Pyh0aGlzLiRvcHRpb25zLnVwZGF0ZU9uRGVmYXVsdD1cbiExLHRoaXMuJG9wdGlvbnMudXBkYXRlT249VSh0aGlzLiRvcHRpb25zLnVwZGF0ZU9uLnJlcGxhY2UoZGcsZnVuY3Rpb24oKXtkLiRvcHRpb25zLnVwZGF0ZU9uRGVmYXVsdD0hMDtyZXR1cm5cIiBcIn0pKSk6dGhpcy4kb3B0aW9ucy51cGRhdGVPbkRlZmF1bHQ9ITB9XX19LGxlPUphKHt0ZXJtaW5hbDohMCxwcmlvcml0eToxRTN9KSxtZT1bXCIkbG9jYWxlXCIsXCIkaW50ZXJwb2xhdGVcIixmdW5jdGlvbihhLGMpe3ZhciBkPS97fS9nLGU9L153aGVuKE1pbnVzKT8oLispJC87cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixsaW5rOmZ1bmN0aW9uKGYsZyxoKXtmdW5jdGlvbiBsKGEpe2cudGV4dChhfHxcIlwiKX12YXIgaz1oLmNvdW50LG09aC4kYXR0ci53aGVuJiZnLmF0dHIoaC4kYXR0ci53aGVuKSxwPWgub2Zmc2V0fHwwLHE9Zi4kZXZhbChtKXx8e30sdT17fSxtPWMuc3RhcnRTeW1ib2woKSxyPWMuZW5kU3ltYm9sKCksdD1tK2srXCItXCIrcCtyLG49Z2Eubm9vcCx2O3MoaCxmdW5jdGlvbihhLGMpe3ZhciBkPVxuZS5leGVjKGMpO2QmJihkPShkWzFdP1wiLVwiOlwiXCIpK1EoZFsyXSkscVtkXT1nLmF0dHIoaC4kYXR0cltjXSkpfSk7cyhxLGZ1bmN0aW9uKGEsZSl7dVtlXT1jKGEucmVwbGFjZShkLHQpKX0pO2YuJHdhdGNoKGssZnVuY3Rpb24oYyl7Yz1wYXJzZUZsb2F0KGMpO3ZhciBkPWlzTmFOKGMpO2R8fGMgaW4gcXx8KGM9YS5wbHVyYWxDYXQoYy1wKSk7Yz09PXZ8fGQmJmlzTmFOKHYpfHwobigpLG49Zi4kd2F0Y2godVtjXSxsKSx2PWMpfSl9fX1dLG5lPVtcIiRwYXJzZVwiLFwiJGFuaW1hdGVcIixmdW5jdGlvbihhLGMpe3ZhciBkPVQoXCJuZ1JlcGVhdFwiKSxlPWZ1bmN0aW9uKGEsYyxkLGUsayxtLHApe2FbZF09ZTtrJiYoYVtrXT1tKTthLiRpbmRleD1jO2EuJGZpcnN0PTA9PT1jO2EuJGxhc3Q9Yz09PXAtMTthLiRtaWRkbGU9IShhLiRmaXJzdHx8YS4kbGFzdCk7YS4kb2RkPSEoYS4kZXZlbj0wPT09KGMmMSkpfTtyZXR1cm57cmVzdHJpY3Q6XCJBXCIsbXVsdGlFbGVtZW50OiEwLHRyYW5zY2x1ZGU6XCJlbGVtZW50XCIsXG5wcmlvcml0eToxRTMsdGVybWluYWw6ITAsJCR0bGI6ITAsY29tcGlsZTpmdW5jdGlvbihmLGcpe3ZhciBoPWcubmdSZXBlYXQsbD1ZLmNyZWF0ZUNvbW1lbnQoXCIgZW5kIG5nUmVwZWF0OiBcIitoK1wiIFwiKSxrPWgubWF0Y2goL15cXHMqKFtcXHNcXFNdKz8pXFxzK2luXFxzKyhbXFxzXFxTXSs/KSg/Olxccythc1xccysoW1xcc1xcU10rPykpPyg/Olxccyt0cmFja1xccytieVxccysoW1xcc1xcU10rPykpP1xccyokLyk7aWYoIWspdGhyb3cgZChcImlleHBcIixoKTt2YXIgbT1rWzFdLHA9a1syXSxxPWtbM10sdT1rWzRdLGs9bS5tYXRjaCgvXig/OihcXHMqW1xcJFxcd10rKXxcXChcXHMqKFtcXCRcXHddKylcXHMqLFxccyooW1xcJFxcd10rKVxccypcXCkpJC8pO2lmKCFrKXRocm93IGQoXCJpaWRleHBcIixtKTt2YXIgcj1rWzNdfHxrWzFdLHk9a1syXTtpZihxJiYoIS9eWyRhLXpBLVpfXVskYS16QS1aMC05X10qJC8udGVzdChxKXx8L14obnVsbHx1bmRlZmluZWR8dGhpc3xcXCRpbmRleHxcXCRmaXJzdHxcXCRtaWRkbGV8XFwkbGFzdHxcXCRldmVufFxcJG9kZHxcXCRwYXJlbnQpJC8udGVzdChxKSkpdGhyb3cgZChcImJhZGlkZW50XCIsXG5xKTt2YXIgbix2LHcsQSx6PXskaWQ6TmF9O3U/bj1hKHUpOih3PWZ1bmN0aW9uKGEsYyl7cmV0dXJuIE5hKGMpfSxBPWZ1bmN0aW9uKGEpe3JldHVybiBhfSk7cmV0dXJuIGZ1bmN0aW9uKGEsZixnLGssbSl7biYmKHY9ZnVuY3Rpb24oYyxkLGUpe3kmJih6W3ldPWMpO3pbcl09ZDt6LiRpbmRleD1lO3JldHVybiBuKGEseil9KTt2YXIgdT1oYSgpO2EuJHdhdGNoQ29sbGVjdGlvbihwLGZ1bmN0aW9uKGcpe3ZhciBrLHAsbj1mWzBdLEUsej1oYSgpLEgsUyxOLEQsRyxDLEk7cSYmKGFbcV09Zyk7aWYoVGEoZykpRz1nLHA9dnx8dztlbHNle3A9dnx8QTtHPVtdO2ZvcihJIGluIGcpZy5oYXNPd25Qcm9wZXJ0eShJKSYmXCIkXCIhPUkuY2hhckF0KDApJiZHLnB1c2goSSk7Ry5zb3J0KCl9SD1HLmxlbmd0aDtJPUFycmF5KEgpO2ZvcihrPTA7azxIO2srKylpZihTPWc9PT1HP2s6R1trXSxOPWdbU10sRD1wKFMsTixrKSx1W0RdKUM9dVtEXSxkZWxldGUgdVtEXSx6W0RdPUMsSVtrXT1DO2Vsc2V7aWYoeltEXSl0aHJvdyBzKEksXG5mdW5jdGlvbihhKXthJiZhLnNjb3BlJiYodVthLmlkXT1hKX0pLGQoXCJkdXBlc1wiLGgsRCxOKTtJW2tdPXtpZDpELHNjb3BlOnQsY2xvbmU6dH07eltEXT0hMH1mb3IoRSBpbiB1KXtDPXVbRV07RD10YihDLmNsb25lKTtjLmxlYXZlKEQpO2lmKERbMF0ucGFyZW50Tm9kZSlmb3Ioaz0wLHA9RC5sZW5ndGg7azxwO2srKylEW2tdLiQkTkdfUkVNT1ZFRD0hMDtDLnNjb3BlLiRkZXN0cm95KCl9Zm9yKGs9MDtrPEg7aysrKWlmKFM9Zz09PUc/azpHW2tdLE49Z1tTXSxDPUlba10sQy5zY29wZSl7RT1uO2RvIEU9RS5uZXh0U2libGluZzt3aGlsZShFJiZFLiQkTkdfUkVNT1ZFRCk7Qy5jbG9uZVswXSE9RSYmYy5tb3ZlKHRiKEMuY2xvbmUpLG51bGwsQihuKSk7bj1DLmNsb25lW0MuY2xvbmUubGVuZ3RoLTFdO2UoQy5zY29wZSxrLHIsTix5LFMsSCl9ZWxzZSBtKGZ1bmN0aW9uKGEsZCl7Qy5zY29wZT1kO3ZhciBmPWwuY2xvbmVOb2RlKCExKTthW2EubGVuZ3RoKytdPWY7Yy5lbnRlcihhLFxubnVsbCxCKG4pKTtuPWY7Qy5jbG9uZT1hO3pbQy5pZF09QztlKEMuc2NvcGUsayxyLE4seSxTLEgpfSk7dT16fSl9fX19XSxvZT1bXCIkYW5pbWF0ZVwiLGZ1bmN0aW9uKGEpe3JldHVybntyZXN0cmljdDpcIkFcIixtdWx0aUVsZW1lbnQ6ITAsbGluazpmdW5jdGlvbihjLGQsZSl7Yy4kd2F0Y2goZS5uZ1Nob3csZnVuY3Rpb24oYyl7YVtjP1wicmVtb3ZlQ2xhc3NcIjpcImFkZENsYXNzXCJdKGQsXCJuZy1oaWRlXCIse3RlbXBDbGFzc2VzOlwibmctaGlkZS1hbmltYXRlXCJ9KX0pfX19XSxoZT1bXCIkYW5pbWF0ZVwiLGZ1bmN0aW9uKGEpe3JldHVybntyZXN0cmljdDpcIkFcIixtdWx0aUVsZW1lbnQ6ITAsbGluazpmdW5jdGlvbihjLGQsZSl7Yy4kd2F0Y2goZS5uZ0hpZGUsZnVuY3Rpb24oYyl7YVtjP1wiYWRkQ2xhc3NcIjpcInJlbW92ZUNsYXNzXCJdKGQsXCJuZy1oaWRlXCIse3RlbXBDbGFzc2VzOlwibmctaGlkZS1hbmltYXRlXCJ9KX0pfX19XSxwZT1KYShmdW5jdGlvbihhLGMsZCl7YS4kd2F0Y2hDb2xsZWN0aW9uKGQubmdTdHlsZSxcbmZ1bmN0aW9uKGEsZCl7ZCYmYSE9PWQmJnMoZCxmdW5jdGlvbihhLGQpe2MuY3NzKGQsXCJcIil9KTthJiZjLmNzcyhhKX0pfSkscWU9W1wiJGFuaW1hdGVcIixmdW5jdGlvbihhKXtyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLHJlcXVpcmU6XCJuZ1N3aXRjaFwiLGNvbnRyb2xsZXI6W1wiJHNjb3BlXCIsZnVuY3Rpb24oKXt0aGlzLmNhc2VzPXt9fV0sbGluazpmdW5jdGlvbihjLGQsZSxmKXt2YXIgZz1bXSxoPVtdLGw9W10saz1bXSxtPWZ1bmN0aW9uKGEsYyl7cmV0dXJuIGZ1bmN0aW9uKCl7YS5zcGxpY2UoYywxKX19O2MuJHdhdGNoKGUubmdTd2l0Y2h8fGUub24sZnVuY3Rpb24oYyl7dmFyIGQsZTtkPTA7Zm9yKGU9bC5sZW5ndGg7ZDxlOysrZClhLmNhbmNlbChsW2RdKTtkPWwubGVuZ3RoPTA7Zm9yKGU9ay5sZW5ndGg7ZDxlOysrZCl7dmFyIHI9dGIoaFtkXS5jbG9uZSk7a1tkXS4kZGVzdHJveSgpOyhsW2RdPWEubGVhdmUocikpLnRoZW4obShsLGQpKX1oLmxlbmd0aD0wO2subGVuZ3RoPTA7KGc9XG5mLmNhc2VzW1wiIVwiK2NdfHxmLmNhc2VzW1wiP1wiXSkmJnMoZyxmdW5jdGlvbihjKXtjLnRyYW5zY2x1ZGUoZnVuY3Rpb24oZCxlKXtrLnB1c2goZSk7dmFyIGY9Yy5lbGVtZW50O2RbZC5sZW5ndGgrK109WS5jcmVhdGVDb21tZW50KFwiIGVuZCBuZ1N3aXRjaFdoZW46IFwiKTtoLnB1c2goe2Nsb25lOmR9KTthLmVudGVyKGQsZi5wYXJlbnQoKSxmKX0pfSl9KX19fV0scmU9SmEoe3RyYW5zY2x1ZGU6XCJlbGVtZW50XCIscHJpb3JpdHk6MTIwMCxyZXF1aXJlOlwiXm5nU3dpdGNoXCIsbXVsdGlFbGVtZW50OiEwLGxpbms6ZnVuY3Rpb24oYSxjLGQsZSxmKXtlLmNhc2VzW1wiIVwiK2QubmdTd2l0Y2hXaGVuXT1lLmNhc2VzW1wiIVwiK2QubmdTd2l0Y2hXaGVuXXx8W107ZS5jYXNlc1tcIiFcIitkLm5nU3dpdGNoV2hlbl0ucHVzaCh7dHJhbnNjbHVkZTpmLGVsZW1lbnQ6Y30pfX0pLHNlPUphKHt0cmFuc2NsdWRlOlwiZWxlbWVudFwiLHByaW9yaXR5OjEyMDAscmVxdWlyZTpcIl5uZ1N3aXRjaFwiLG11bHRpRWxlbWVudDohMCxcbmxpbms6ZnVuY3Rpb24oYSxjLGQsZSxmKXtlLmNhc2VzW1wiP1wiXT1lLmNhc2VzW1wiP1wiXXx8W107ZS5jYXNlc1tcIj9cIl0ucHVzaCh7dHJhbnNjbHVkZTpmLGVsZW1lbnQ6Y30pfX0pLHVlPUphKHtyZXN0cmljdDpcIkVBQ1wiLGxpbms6ZnVuY3Rpb24oYSxjLGQsZSxmKXtpZighZil0aHJvdyBUKFwibmdUcmFuc2NsdWRlXCIpKFwib3JwaGFuXCIsdmEoYykpO2YoZnVuY3Rpb24oYSl7Yy5lbXB0eSgpO2MuYXBwZW5kKGEpfSl9fSksVmQ9W1wiJHRlbXBsYXRlQ2FjaGVcIixmdW5jdGlvbihhKXtyZXR1cm57cmVzdHJpY3Q6XCJFXCIsdGVybWluYWw6ITAsY29tcGlsZTpmdW5jdGlvbihjLGQpe1widGV4dC9uZy10ZW1wbGF0ZVwiPT1kLnR5cGUmJmEucHV0KGQuaWQsY1swXS50ZXh0KX19fV0sZWc9VChcIm5nT3B0aW9uc1wiKSx0ZT1kYSh7cmVzdHJpY3Q6XCJBXCIsdGVybWluYWw6ITB9KSxXZD1bXCIkY29tcGlsZVwiLFwiJHBhcnNlXCIsZnVuY3Rpb24oYSxjKXt2YXIgZD0vXlxccyooW1xcc1xcU10rPykoPzpcXHMrYXNcXHMrKFtcXHNcXFNdKz8pKT8oPzpcXHMrZ3JvdXBcXHMrYnlcXHMrKFtcXHNcXFNdKz8pKT9cXHMrZm9yXFxzKyg/OihbXFwkXFx3XVtcXCRcXHddKil8KD86XFwoXFxzKihbXFwkXFx3XVtcXCRcXHddKilcXHMqLFxccyooW1xcJFxcd11bXFwkXFx3XSopXFxzKlxcKSkpXFxzK2luXFxzKyhbXFxzXFxTXSs/KSg/Olxccyt0cmFja1xccytieVxccysoW1xcc1xcU10rPykpPyQvLFxuZT17JHNldFZpZXdWYWx1ZTpIfTtyZXR1cm57cmVzdHJpY3Q6XCJFXCIscmVxdWlyZTpbXCJzZWxlY3RcIixcIj9uZ01vZGVsXCJdLGNvbnRyb2xsZXI6W1wiJGVsZW1lbnRcIixcIiRzY29wZVwiLFwiJGF0dHJzXCIsZnVuY3Rpb24oYSxjLGQpe3ZhciBsPXRoaXMsaz17fSxtPWUscDtsLmRhdGFib3VuZD1kLm5nTW9kZWw7bC5pbml0PWZ1bmN0aW9uKGEsYyxkKXttPWE7cD1kfTtsLmFkZE9wdGlvbj1mdW5jdGlvbihjLGQpe01hKGMsJ1wib3B0aW9uIHZhbHVlXCInKTtrW2NdPSEwO20uJHZpZXdWYWx1ZT09YyYmKGEudmFsKGMpLHAucGFyZW50KCkmJnAucmVtb3ZlKCkpO2QmJmRbMF0uaGFzQXR0cmlidXRlKFwic2VsZWN0ZWRcIikmJihkWzBdLnNlbGVjdGVkPSEwKX07bC5yZW1vdmVPcHRpb249ZnVuY3Rpb24oYSl7dGhpcy5oYXNPcHRpb24oYSkmJihkZWxldGUga1thXSxtLiR2aWV3VmFsdWU9PT1hJiZ0aGlzLnJlbmRlclVua25vd25PcHRpb24oYSkpfTtsLnJlbmRlclVua25vd25PcHRpb249ZnVuY3Rpb24oYyl7Yz1cblwiPyBcIitOYShjKStcIiA/XCI7cC52YWwoYyk7YS5wcmVwZW5kKHApO2EudmFsKGMpO3AucHJvcChcInNlbGVjdGVkXCIsITApfTtsLmhhc09wdGlvbj1mdW5jdGlvbihhKXtyZXR1cm4gay5oYXNPd25Qcm9wZXJ0eShhKX07Yy4kb24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7bC5yZW5kZXJVbmtub3duT3B0aW9uPUh9KX1dLGxpbms6ZnVuY3Rpb24oZSxnLGgsbCl7ZnVuY3Rpb24gayhhLGMsZCxlKXtkLiRyZW5kZXI9ZnVuY3Rpb24oKXt2YXIgYT1kLiR2aWV3VmFsdWU7ZS5oYXNPcHRpb24oYSk/KEMucGFyZW50KCkmJkMucmVtb3ZlKCksYy52YWwoYSksXCJcIj09PWEmJm4ucHJvcChcInNlbGVjdGVkXCIsITApKTpBKGEpJiZuP2MudmFsKFwiXCIpOmUucmVuZGVyVW5rbm93bk9wdGlvbihhKX07Yy5vbihcImNoYW5nZVwiLGZ1bmN0aW9uKCl7YS4kYXBwbHkoZnVuY3Rpb24oKXtDLnBhcmVudCgpJiZDLnJlbW92ZSgpO2QuJHNldFZpZXdWYWx1ZShjLnZhbCgpKX0pfSl9ZnVuY3Rpb24gbShhLGMsZCl7dmFyIGU7XG5kLiRyZW5kZXI9ZnVuY3Rpb24oKXt2YXIgYT1uZXcgZGIoZC4kdmlld1ZhbHVlKTtzKGMuZmluZChcIm9wdGlvblwiKSxmdW5jdGlvbihjKXtjLnNlbGVjdGVkPXkoYS5nZXQoYy52YWx1ZSkpfSl9O2EuJHdhdGNoKGZ1bmN0aW9uKCl7ZmEoZSxkLiR2aWV3VmFsdWUpfHwoZT1yYShkLiR2aWV3VmFsdWUpLGQuJHJlbmRlcigpKX0pO2Mub24oXCJjaGFuZ2VcIixmdW5jdGlvbigpe2EuJGFwcGx5KGZ1bmN0aW9uKCl7dmFyIGE9W107cyhjLmZpbmQoXCJvcHRpb25cIiksZnVuY3Rpb24oYyl7Yy5zZWxlY3RlZCYmYS5wdXNoKGMudmFsdWUpfSk7ZC4kc2V0Vmlld1ZhbHVlKGEpfSl9KX1mdW5jdGlvbiBwKGUsZixnKXtmdW5jdGlvbiBoKGEsYyxkKXtUW3hdPWQ7RyYmKFRbR109Yyk7cmV0dXJuIGEoZSxUKX1mdW5jdGlvbiBrKGEpe3ZhciBjO2lmKHUpaWYoTSYmRChhKSl7Yz1uZXcgZGIoW10pO2Zvcih2YXIgZD0wO2Q8YS5sZW5ndGg7ZCsrKWMucHV0KGgoTSxudWxsLGFbZF0pLCEwKX1lbHNlIGM9XG5uZXcgZGIoYSk7ZWxzZSBNJiYoYT1oKE0sbnVsbCxhKSk7cmV0dXJuIGZ1bmN0aW9uKGQsZSl7dmFyIGY7Zj1NP006Qj9COkY7cmV0dXJuIHU/eShjLnJlbW92ZShoKGYsZCxlKSkpOmE9PT1oKGYsZCxlKX19ZnVuY3Rpb24gbCgpe3Z8fChlLiQkcG9zdERpZ2VzdChwKSx2PSEwKX1mdW5jdGlvbiBtKGEsYyxkKXthW2NdPWFbY118fDA7YVtjXSs9ZD8xOi0xfWZ1bmN0aW9uIHAoKXt2PSExO3ZhciBhPXtcIlwiOltdfSxjPVtcIlwiXSxkLGwsbixyLHQ7bj1nLiR2aWV3VmFsdWU7cj1QKGUpfHxbXTt2YXIgQj1HP09iamVjdC5rZXlzKHIpLnNvcnQoKTpyLHgsQSxELEYsTj17fTt0PWsobik7dmFyIEo9ITEsVSxWO1E9e307Zm9yKEY9MDtEPUIubGVuZ3RoLEY8RDtGKyspe3g9RjtpZihHJiYoeD1CW0ZdLFwiJFwiPT09eC5jaGFyQXQoMCkpKWNvbnRpbnVlO0E9clt4XTtkPWgoSSx4LEEpfHxcIlwiOyhsPWFbZF0pfHwobD1hW2RdPVtdLGMucHVzaChkKSk7ZD10KHgsQSk7Sj1KfHxkO0E9aChDLHgsQSk7XG5BPXkoQSk/QTpcIlwiO1Y9TT9NKGUsVCk6Rz9CW0ZdOkY7TSYmKFFbVl09eCk7bC5wdXNoKHtpZDpWLGxhYmVsOkEsc2VsZWN0ZWQ6ZH0pfXV8fCh6fHxudWxsPT09bj9hW1wiXCJdLnVuc2hpZnQoe2lkOlwiXCIsbGFiZWw6XCJcIixzZWxlY3RlZDohSn0pOkp8fGFbXCJcIl0udW5zaGlmdCh7aWQ6XCI/XCIsbGFiZWw6XCJcIixzZWxlY3RlZDohMH0pKTt4PTA7Zm9yKEI9Yy5sZW5ndGg7eDxCO3grKyl7ZD1jW3hdO2w9YVtkXTtSLmxlbmd0aDw9eD8obj17ZWxlbWVudDpILmNsb25lKCkuYXR0cihcImxhYmVsXCIsZCksbGFiZWw6bC5sYWJlbH0scj1bbl0sUi5wdXNoKHIpLGYuYXBwZW5kKG4uZWxlbWVudCkpOihyPVJbeF0sbj1yWzBdLG4ubGFiZWwhPWQmJm4uZWxlbWVudC5hdHRyKFwibGFiZWxcIixuLmxhYmVsPWQpKTtKPW51bGw7Rj0wO2ZvcihEPWwubGVuZ3RoO0Y8RDtGKyspZD1sW0ZdLCh0PXJbRisxXSk/KEo9dC5lbGVtZW50LHQubGFiZWwhPT1kLmxhYmVsJiYobShOLHQubGFiZWwsITEpLG0oTixkLmxhYmVsLFxuITApLEoudGV4dCh0LmxhYmVsPWQubGFiZWwpLEoucHJvcChcImxhYmVsXCIsdC5sYWJlbCkpLHQuaWQhPT1kLmlkJiZKLnZhbCh0LmlkPWQuaWQpLEpbMF0uc2VsZWN0ZWQhPT1kLnNlbGVjdGVkJiYoSi5wcm9wKFwic2VsZWN0ZWRcIix0LnNlbGVjdGVkPWQuc2VsZWN0ZWQpLFJhJiZKLnByb3AoXCJzZWxlY3RlZFwiLHQuc2VsZWN0ZWQpKSk6KFwiXCI9PT1kLmlkJiZ6P1U9ejooVT13LmNsb25lKCkpLnZhbChkLmlkKS5wcm9wKFwic2VsZWN0ZWRcIixkLnNlbGVjdGVkKS5hdHRyKFwic2VsZWN0ZWRcIixkLnNlbGVjdGVkKS5wcm9wKFwibGFiZWxcIixkLmxhYmVsKS50ZXh0KGQubGFiZWwpLHIucHVzaCh0PXtlbGVtZW50OlUsbGFiZWw6ZC5sYWJlbCxpZDpkLmlkLHNlbGVjdGVkOmQuc2VsZWN0ZWR9KSxtKE4sZC5sYWJlbCwhMCksSj9KLmFmdGVyKFUpOm4uZWxlbWVudC5hcHBlbmQoVSksSj1VKTtmb3IoRisrO3IubGVuZ3RoPkY7KWQ9ci5wb3AoKSxtKE4sZC5sYWJlbCwhMSksZC5lbGVtZW50LnJlbW92ZSgpfWZvcig7Ui5sZW5ndGg+XG54Oyl7bD1SLnBvcCgpO2ZvcihGPTE7RjxsLmxlbmd0aDsrK0YpbShOLGxbRl0ubGFiZWwsITEpO2xbMF0uZWxlbWVudC5yZW1vdmUoKX1zKE4sZnVuY3Rpb24oYSxjKXswPGE/cS5hZGRPcHRpb24oYyk6MD5hJiZxLnJlbW92ZU9wdGlvbihjKX0pfXZhciBuO2lmKCEobj1yLm1hdGNoKGQpKSl0aHJvdyBlZyhcImlleHBcIixyLHZhKGYpKTt2YXIgQz1jKG5bMl18fG5bMV0pLHg9bls0XXx8bls2XSxBPS8gYXMgLy50ZXN0KG5bMF0pJiZuWzFdLEI9QT9jKEEpOm51bGwsRz1uWzVdLEk9YyhuWzNdfHxcIlwiKSxGPWMoblsyXT9uWzFdOngpLFA9YyhuWzddKSxNPW5bOF0/YyhuWzhdKTpudWxsLFE9e30sUj1bW3tlbGVtZW50OmYsbGFiZWw6XCJcIn1dXSxUPXt9O3omJihhKHopKGUpLHoucmVtb3ZlQ2xhc3MoXCJuZy1zY29wZVwiKSx6LnJlbW92ZSgpKTtmLmVtcHR5KCk7Zi5vbihcImNoYW5nZVwiLGZ1bmN0aW9uKCl7ZS4kYXBwbHkoZnVuY3Rpb24oKXt2YXIgYT1QKGUpfHxbXSxjO2lmKHUpYz1bXSxzKGYudmFsKCksXG5mdW5jdGlvbihkKXtkPU0/UVtkXTpkO2MucHVzaChcIj9cIj09PWQ/dDpcIlwiPT09ZD9udWxsOmgoQj9COkYsZCxhW2RdKSl9KTtlbHNle3ZhciBkPU0/UVtmLnZhbCgpXTpmLnZhbCgpO2M9XCI/XCI9PT1kP3Q6XCJcIj09PWQ/bnVsbDpoKEI/QjpGLGQsYVtkXSl9Zy4kc2V0Vmlld1ZhbHVlKGMpO3AoKX0pfSk7Zy4kcmVuZGVyPXA7ZS4kd2F0Y2hDb2xsZWN0aW9uKFAsbCk7ZS4kd2F0Y2hDb2xsZWN0aW9uKGZ1bmN0aW9uKCl7dmFyIGE9UChlKSxjO2lmKGEmJkQoYSkpe2M9QXJyYXkoYS5sZW5ndGgpO2Zvcih2YXIgZD0wLGY9YS5sZW5ndGg7ZDxmO2QrKyljW2RdPWgoQyxkLGFbZF0pfWVsc2UgaWYoYSlmb3IoZCBpbiBjPXt9LGEpYS5oYXNPd25Qcm9wZXJ0eShkKSYmKGNbZF09aChDLGQsYVtkXSkpO3JldHVybiBjfSxsKTt1JiZlLiR3YXRjaENvbGxlY3Rpb24oZnVuY3Rpb24oKXtyZXR1cm4gZy4kbW9kZWxWYWx1ZX0sbCl9aWYobFsxXSl7dmFyIHE9bFswXTtsPWxbMV07dmFyIHU9aC5tdWx0aXBsZSxcbnI9aC5uZ09wdGlvbnMsej0hMSxuLHY9ITEsdz1CKFkuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKSksSD1CKFkuY3JlYXRlRWxlbWVudChcIm9wdGdyb3VwXCIpKSxDPXcuY2xvbmUoKTtoPTA7Zm9yKHZhciB4PWcuY2hpbGRyZW4oKSxHPXgubGVuZ3RoO2g8RztoKyspaWYoXCJcIj09PXhbaF0udmFsdWUpe249ej14LmVxKGgpO2JyZWFrfXEuaW5pdChsLHosQyk7dSYmKGwuJGlzRW1wdHk9ZnVuY3Rpb24oYSl7cmV0dXJuIWF8fDA9PT1hLmxlbmd0aH0pO3I/cChlLGcsbCk6dT9tKGUsZyxsKTprKGUsZyxsLHEpfX19fV0sWWQ9W1wiJGludGVycG9sYXRlXCIsZnVuY3Rpb24oYSl7dmFyIGM9e2FkZE9wdGlvbjpILHJlbW92ZU9wdGlvbjpIfTtyZXR1cm57cmVzdHJpY3Q6XCJFXCIscHJpb3JpdHk6MTAwLGNvbXBpbGU6ZnVuY3Rpb24oZCxlKXtpZihBKGUudmFsdWUpKXt2YXIgZj1hKGQudGV4dCgpLCEwKTtmfHxlLiRzZXQoXCJ2YWx1ZVwiLGQudGV4dCgpKX1yZXR1cm4gZnVuY3Rpb24oYSxkLGUpe3ZhciBrPVxuZC5wYXJlbnQoKSxtPWsuZGF0YShcIiRzZWxlY3RDb250cm9sbGVyXCIpfHxrLnBhcmVudCgpLmRhdGEoXCIkc2VsZWN0Q29udHJvbGxlclwiKTttJiZtLmRhdGFib3VuZHx8KG09Yyk7Zj9hLiR3YXRjaChmLGZ1bmN0aW9uKGEsYyl7ZS4kc2V0KFwidmFsdWVcIixhKTtjIT09YSYmbS5yZW1vdmVPcHRpb24oYyk7bS5hZGRPcHRpb24oYSxkKX0pOm0uYWRkT3B0aW9uKGUudmFsdWUsZCk7ZC5vbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXttLnJlbW92ZU9wdGlvbihlLnZhbHVlKX0pfX19fV0sWGQ9ZGEoe3Jlc3RyaWN0OlwiRVwiLHRlcm1pbmFsOiExfSksemM9ZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJBXCIscmVxdWlyZTpcIj9uZ01vZGVsXCIsbGluazpmdW5jdGlvbihhLGMsZCxlKXtlJiYoZC5yZXF1aXJlZD0hMCxlLiR2YWxpZGF0b3JzLnJlcXVpcmVkPWZ1bmN0aW9uKGEsYyl7cmV0dXJuIWQucmVxdWlyZWR8fCFlLiRpc0VtcHR5KGMpfSxkLiRvYnNlcnZlKFwicmVxdWlyZWRcIixmdW5jdGlvbigpe2UuJHZhbGlkYXRlKCl9KSl9fX0sXG55Yz1mdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkFcIixyZXF1aXJlOlwiP25nTW9kZWxcIixsaW5rOmZ1bmN0aW9uKGEsYyxkLGUpe2lmKGUpe3ZhciBmLGc9ZC5uZ1BhdHRlcm58fGQucGF0dGVybjtkLiRvYnNlcnZlKFwicGF0dGVyblwiLGZ1bmN0aW9uKGEpe0YoYSkmJjA8YS5sZW5ndGgmJihhPW5ldyBSZWdFeHAoXCJeXCIrYStcIiRcIikpO2lmKGEmJiFhLnRlc3QpdGhyb3cgVChcIm5nUGF0dGVyblwiKShcIm5vcmVnZXhwXCIsZyxhLHZhKGMpKTtmPWF8fHQ7ZS4kdmFsaWRhdGUoKX0pO2UuJHZhbGlkYXRvcnMucGF0dGVybj1mdW5jdGlvbihhKXtyZXR1cm4gZS4kaXNFbXB0eShhKXx8QShmKXx8Zi50ZXN0KGEpfX19fX0sQmM9ZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJBXCIscmVxdWlyZTpcIj9uZ01vZGVsXCIsbGluazpmdW5jdGlvbihhLGMsZCxlKXtpZihlKXt2YXIgZj0tMTtkLiRvYnNlcnZlKFwibWF4bGVuZ3RoXCIsZnVuY3Rpb24oYSl7YT1iYShhKTtmPWlzTmFOKGEpPy0xOmE7ZS4kdmFsaWRhdGUoKX0pO1xuZS4kdmFsaWRhdG9ycy5tYXhsZW5ndGg9ZnVuY3Rpb24oYSxjKXtyZXR1cm4gMD5mfHxlLiRpc0VtcHR5KGEpfHxjLmxlbmd0aDw9Zn19fX19LEFjPWZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiQVwiLHJlcXVpcmU6XCI/bmdNb2RlbFwiLGxpbms6ZnVuY3Rpb24oYSxjLGQsZSl7aWYoZSl7dmFyIGY9MDtkLiRvYnNlcnZlKFwibWlubGVuZ3RoXCIsZnVuY3Rpb24oYSl7Zj1iYShhKXx8MDtlLiR2YWxpZGF0ZSgpfSk7ZS4kdmFsaWRhdG9ycy5taW5sZW5ndGg9ZnVuY3Rpb24oYSxjKXtyZXR1cm4gZS4kaXNFbXB0eShjKXx8Yy5sZW5ndGg+PWZ9fX19fTtNLmFuZ3VsYXIuYm9vdHN0cmFwP2NvbnNvbGUubG9nKFwiV0FSTklORzogVHJpZWQgdG8gbG9hZCBhbmd1bGFyIG1vcmUgdGhhbiBvbmNlLlwiKTooTmQoKSxQZChnYSksQihZKS5yZWFkeShmdW5jdGlvbigpe0pkKFksc2MpfSkpfSkod2luZG93LGRvY3VtZW50KTshd2luZG93LmFuZ3VsYXIuJCRjc3AoKSYmd2luZG93LmFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkuZmluZChcImhlYWRcIikucHJlcGVuZCgnPHN0eWxlIHR5cGU9XCJ0ZXh0L2Nzc1wiPkBjaGFyc2V0IFwiVVRGLThcIjtbbmdcXFxcOmNsb2FrXSxbbmctY2xvYWtdLFtkYXRhLW5nLWNsb2FrXSxbeC1uZy1jbG9ha10sLm5nLWNsb2FrLC54LW5nLWNsb2FrLC5uZy1oaWRlOm5vdCgubmctaGlkZS1hbmltYXRlKXtkaXNwbGF5Om5vbmUgIWltcG9ydGFudDt9bmdcXFxcOmZvcm17ZGlzcGxheTpibG9jazt9PC9zdHlsZT4nKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFuZ3VsYXIubWluLmpzLm1hcFxuIiwiLyoqXG4gKiBAbGljZW5zZSBBbmd1bGFySlMgdjEuMy4xMVxuICogKGMpIDIwMTAtMjAxNCBHb29nbGUsIEluYy4gaHR0cDovL2FuZ3VsYXJqcy5vcmdcbiAqIExpY2Vuc2U6IE1JVFxuICovXG4oZnVuY3Rpb24od2luZG93LCBhbmd1bGFyLCB1bmRlZmluZWQpIHsndXNlIHN0cmljdCc7XG5cbi8qIGpzaGludCBtYXhsZW46IGZhbHNlICovXG5cbi8qKlxuICogQG5nZG9jIG1vZHVsZVxuICogQG5hbWUgbmdBbmltYXRlXG4gKiBAZGVzY3JpcHRpb25cbiAqXG4gKiBUaGUgYG5nQW5pbWF0ZWAgbW9kdWxlIHByb3ZpZGVzIHN1cHBvcnQgZm9yIEphdmFTY3JpcHQsIENTUzMgdHJhbnNpdGlvbiBhbmQgQ1NTMyBrZXlmcmFtZSBhbmltYXRpb24gaG9va3Mgd2l0aGluIGV4aXN0aW5nIGNvcmUgYW5kIGN1c3RvbSBkaXJlY3RpdmVzLlxuICpcbiAqIDxkaXYgZG9jLW1vZHVsZS1jb21wb25lbnRzPVwibmdBbmltYXRlXCI+PC9kaXY+XG4gKlxuICogIyBVc2FnZVxuICpcbiAqIFRvIHNlZSBhbmltYXRpb25zIGluIGFjdGlvbiwgYWxsIHRoYXQgaXMgcmVxdWlyZWQgaXMgdG8gZGVmaW5lIHRoZSBhcHByb3ByaWF0ZSBDU1MgY2xhc3Nlc1xuICogb3IgdG8gcmVnaXN0ZXIgYSBKYXZhU2NyaXB0IGFuaW1hdGlvbiB2aWEgdGhlIGBteU1vZHVsZS5hbmltYXRpb24oKWAgZnVuY3Rpb24uIFRoZSBkaXJlY3RpdmVzIHRoYXQgc3VwcG9ydCBhbmltYXRpb24gYXV0b21hdGljYWxseSBhcmU6XG4gKiBgbmdSZXBlYXRgLCBgbmdJbmNsdWRlYCwgYG5nSWZgLCBgbmdTd2l0Y2hgLCBgbmdTaG93YCwgYG5nSGlkZWAsIGBuZ1ZpZXdgIGFuZCBgbmdDbGFzc2AuIEN1c3RvbSBkaXJlY3RpdmVzIGNhbiB0YWtlIGFkdmFudGFnZSBvZiBhbmltYXRpb25cbiAqIGJ5IHVzaW5nIHRoZSBgJGFuaW1hdGVgIHNlcnZpY2UuXG4gKlxuICogQmVsb3cgaXMgYSBtb3JlIGRldGFpbGVkIGJyZWFrZG93biBvZiB0aGUgc3VwcG9ydGVkIGFuaW1hdGlvbiBldmVudHMgcHJvdmlkZWQgYnkgcHJlLWV4aXN0aW5nIG5nIGRpcmVjdGl2ZXM6XG4gKlxuICogfCBEaXJlY3RpdmUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IFN1cHBvcnRlZCBBbmltYXRpb25zICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcbiAqIHwge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ1JlcGVhdCNhbmltYXRpb25zIG5nUmVwZWF0fSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBlbnRlciwgbGVhdmUgYW5kIG1vdmUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICogfCB7QGxpbmsgbmdSb3V0ZS5kaXJlY3RpdmU6bmdWaWV3I2FuaW1hdGlvbnMgbmdWaWV3fSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGVudGVyIGFuZCBsZWF2ZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8IHtAbGluayBuZy5kaXJlY3RpdmU6bmdJbmNsdWRlI2FuaW1hdGlvbnMgbmdJbmNsdWRlfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgZW50ZXIgYW5kIGxlYXZlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAqIHwge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ1N3aXRjaCNhbmltYXRpb25zIG5nU3dpdGNofSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBlbnRlciBhbmQgbGVhdmUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICogfCB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nSWYjYW5pbWF0aW9ucyBuZ0lmfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGVudGVyIGFuZCBsZWF2ZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8IHtAbGluayBuZy5kaXJlY3RpdmU6bmdDbGFzcyNhbmltYXRpb25zIG5nQ2xhc3N9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYWRkIGFuZCByZW1vdmUgKHRoZSBDU1MgY2xhc3MoZXMpIHByZXNlbnQpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAqIHwge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ1Nob3cjYW5pbWF0aW9ucyBuZ1Nob3d9ICYge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0hpZGUjYW5pbWF0aW9ucyBuZ0hpZGV9ICAgICAgICAgICAgfCBhZGQgYW5kIHJlbW92ZSAodGhlIG5nLWhpZGUgY2xhc3MgdmFsdWUpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICogfCB7QGxpbmsgbmcuZGlyZWN0aXZlOmZvcm0jYW5pbWF0aW9uLWhvb2tzIGZvcm19ICYge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ01vZGVsI2FuaW1hdGlvbi1ob29rcyBuZ01vZGVsfSAgICB8IGFkZCBhbmQgcmVtb3ZlIChkaXJ0eSwgcHJpc3RpbmUsIHZhbGlkLCBpbnZhbGlkICYgYWxsIG90aGVyIHZhbGlkYXRpb25zKSB8XG4gKiB8IHtAbGluayBtb2R1bGU6bmdNZXNzYWdlcyNhbmltYXRpb25zIG5nTWVzc2FnZXN9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYWRkIGFuZCByZW1vdmUgKG5nLWFjdGl2ZSAmIG5nLWluYWN0aXZlKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAqIHwge0BsaW5rIG1vZHVsZTpuZ01lc3NhZ2VzI2FuaW1hdGlvbnMgbmdNZXNzYWdlfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBlbnRlciBhbmQgbGVhdmUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICpcbiAqIFlvdSBjYW4gZmluZCBvdXQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBhbmltYXRpb25zIHVwb24gdmlzaXRpbmcgZWFjaCBkaXJlY3RpdmUgcGFnZS5cbiAqXG4gKiBCZWxvdyBpcyBhbiBleGFtcGxlIG9mIGhvdyB0byBhcHBseSBhbmltYXRpb25zIHRvIGEgZGlyZWN0aXZlIHRoYXQgc3VwcG9ydHMgYW5pbWF0aW9uIGhvb2tzOlxuICpcbiAqIGBgYGh0bWxcbiAqIDxzdHlsZSB0eXBlPVwidGV4dC9jc3NcIj5cbiAqIC5zbGlkZS5uZy1lbnRlciwgLnNsaWRlLm5nLWxlYXZlIHtcbiAqICAgLXdlYmtpdC10cmFuc2l0aW9uOjAuNXMgbGluZWFyIGFsbDtcbiAqICAgdHJhbnNpdGlvbjowLjVzIGxpbmVhciBhbGw7XG4gKiB9XG4gKlxuICogLnNsaWRlLm5nLWVudGVyIHsgfSAgICAgICAgLyYjNDI7IHN0YXJ0aW5nIGFuaW1hdGlvbnMgZm9yIGVudGVyICYjNDI7L1xuICogLnNsaWRlLm5nLWVudGVyLm5nLWVudGVyLWFjdGl2ZSB7IH0gLyYjNDI7IHRlcm1pbmFsIGFuaW1hdGlvbnMgZm9yIGVudGVyICYjNDI7L1xuICogLnNsaWRlLm5nLWxlYXZlIHsgfSAgICAgICAgLyYjNDI7IHN0YXJ0aW5nIGFuaW1hdGlvbnMgZm9yIGxlYXZlICYjNDI7L1xuICogLnNsaWRlLm5nLWxlYXZlLm5nLWxlYXZlLWFjdGl2ZSB7IH0gLyYjNDI7IHRlcm1pbmFsIGFuaW1hdGlvbnMgZm9yIGxlYXZlICYjNDI7L1xuICogPC9zdHlsZT5cbiAqXG4gKiA8IS0tXG4gKiB0aGUgYW5pbWF0ZSBzZXJ2aWNlIHdpbGwgYXV0b21hdGljYWxseSBhZGQgLm5nLWVudGVyIGFuZCAubmctbGVhdmUgdG8gdGhlIGVsZW1lbnRcbiAqIHRvIHRyaWdnZXIgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbnNcbiAqIC0tPlxuICogPEFOWSBjbGFzcz1cInNsaWRlXCIgbmctaW5jbHVkZT1cIi4uLlwiPjwvQU5ZPlxuICogYGBgXG4gKlxuICogS2VlcCBpbiBtaW5kIHRoYXQsIGJ5IGRlZmF1bHQsIGlmIGFuIGFuaW1hdGlvbiBpcyBydW5uaW5nLCBhbnkgY2hpbGQgZWxlbWVudHMgY2Fubm90IGJlIGFuaW1hdGVkXG4gKiB1bnRpbCB0aGUgcGFyZW50IGVsZW1lbnQncyBhbmltYXRpb24gaGFzIGNvbXBsZXRlZC4gVGhpcyBibG9ja2luZyBmZWF0dXJlIGNhbiBiZSBvdmVycmlkZGVuIGJ5XG4gKiBwbGFjaW5nIHRoZSBgbmctYW5pbWF0ZS1jaGlsZHJlbmAgYXR0cmlidXRlIG9uIGEgcGFyZW50IGNvbnRhaW5lciB0YWcuXG4gKlxuICogYGBgaHRtbFxuICogPGRpdiBjbGFzcz1cInNsaWRlLWFuaW1hdGlvblwiIG5nLWlmPVwib25cIiBuZy1hbmltYXRlLWNoaWxkcmVuPlxuICogICA8ZGl2IGNsYXNzPVwiZmFkZS1hbmltYXRpb25cIiBuZy1pZj1cIm9uXCI+XG4gKiAgICAgPGRpdiBjbGFzcz1cImV4cGxvZGUtYW5pbWF0aW9uXCIgbmctaWY9XCJvblwiPlxuICogICAgICAgIC4uLlxuICogICAgIDwvZGl2PlxuICogICA8L2Rpdj5cbiAqIDwvZGl2PlxuICogYGBgXG4gKlxuICogV2hlbiB0aGUgYG9uYCBleHByZXNzaW9uIHZhbHVlIGNoYW5nZXMgYW5kIGFuIGFuaW1hdGlvbiBpcyB0cmlnZ2VyZWQgdGhlbiBlYWNoIG9mIHRoZSBlbGVtZW50cyB3aXRoaW5cbiAqIHdpbGwgYWxsIGFuaW1hdGUgd2l0aG91dCB0aGUgYmxvY2sgYmVpbmcgYXBwbGllZCB0byBjaGlsZCBlbGVtZW50cy5cbiAqXG4gKiAjIyBBcmUgYW5pbWF0aW9ucyBydW4gd2hlbiB0aGUgYXBwbGljYXRpb24gc3RhcnRzP1xuICogTm8gdGhleSBhcmUgbm90LiBXaGVuIGFuIGFwcGxpY2F0aW9uIGlzIGJvb3RzdHJhcHBlZCBBbmd1bGFyIHdpbGwgZGlzYWJsZSBhbmltYXRpb25zIGZyb20gcnVubmluZyB0byBhdm9pZFxuICogYSBmcmVuenkgb2YgYW5pbWF0aW9ucyBmcm9tIGJlaW5nIHRyaWdnZXJlZCBhcyBzb29uIGFzIHRoZSBicm93c2VyIGhhcyByZW5kZXJlZCB0aGUgc2NyZWVuLiBGb3IgdGhpcyB0byB3b3JrLFxuICogQW5ndWxhciB3aWxsIHdhaXQgZm9yIHR3byBkaWdlc3QgY3ljbGVzIHVudGlsIGVuYWJsaW5nIGFuaW1hdGlvbnMuIEZyb20gdGhlcmUgb24sIGFueSBhbmltYXRpb24tdHJpZ2dlcmluZ1xuICogbGF5b3V0IGNoYW5nZXMgaW4gdGhlIGFwcGxpY2F0aW9uIHdpbGwgdHJpZ2dlciBhbmltYXRpb25zIGFzIG5vcm1hbC5cbiAqXG4gKiBJbiBhZGRpdGlvbiwgdXBvbiBib290c3RyYXAsIGlmIHRoZSByb3V0aW5nIHN5c3RlbSBvciBhbnkgZGlyZWN0aXZlcyBvciBsb2FkIHJlbW90ZSBkYXRhICh2aWEgJGh0dHApIHRoZW4gQW5ndWxhclxuICogd2lsbCBhdXRvbWF0aWNhbGx5IGV4dGVuZCB0aGUgd2FpdCB0aW1lIHRvIGVuYWJsZSBhbmltYXRpb25zIG9uY2UgKiphbGwqKiBvZiB0aGUgb3V0Ym91bmQgSFRUUCByZXF1ZXN0c1xuICogYXJlIGNvbXBsZXRlLlxuICpcbiAqICMjIENTUy1kZWZpbmVkIEFuaW1hdGlvbnNcbiAqIFRoZSBhbmltYXRlIHNlcnZpY2Ugd2lsbCBhdXRvbWF0aWNhbGx5IGFwcGx5IHR3byBDU1MgY2xhc3NlcyB0byB0aGUgYW5pbWF0ZWQgZWxlbWVudCBhbmQgdGhlc2UgdHdvIENTUyBjbGFzc2VzXG4gKiBhcmUgZGVzaWduZWQgdG8gY29udGFpbiB0aGUgc3RhcnQgYW5kIGVuZCBDU1Mgc3R5bGluZy4gQm90aCBDU1MgdHJhbnNpdGlvbnMgYW5kIGtleWZyYW1lIGFuaW1hdGlvbnMgYXJlIHN1cHBvcnRlZFxuICogYW5kIGNhbiBiZSB1c2VkIHRvIHBsYXkgYWxvbmcgd2l0aCB0aGlzIG5hbWluZyBzdHJ1Y3R1cmUuXG4gKlxuICogVGhlIGZvbGxvd2luZyBjb2RlIGJlbG93IGRlbW9uc3RyYXRlcyBob3cgdG8gcGVyZm9ybSBhbmltYXRpb25zIHVzaW5nICoqQ1NTIHRyYW5zaXRpb25zKiogd2l0aCBBbmd1bGFyOlxuICpcbiAqIGBgYGh0bWxcbiAqIDxzdHlsZSB0eXBlPVwidGV4dC9jc3NcIj5cbiAqIC8mIzQyO1xuICogIFRoZSBhbmltYXRlIGNsYXNzIGlzIGFwYXJ0IG9mIHRoZSBlbGVtZW50IGFuZCB0aGUgbmctZW50ZXIgY2xhc3NcbiAqICBpcyBhdHRhY2hlZCB0byB0aGUgZWxlbWVudCBvbmNlIHRoZSBlbnRlciBhbmltYXRpb24gZXZlbnQgaXMgdHJpZ2dlcmVkXG4gKiAmIzQyOy9cbiAqIC5yZXZlYWwtYW5pbWF0aW9uLm5nLWVudGVyIHtcbiAqICAtd2Via2l0LXRyYW5zaXRpb246IDFzIGxpbmVhciBhbGw7IC8mIzQyOyBTYWZhcmkvQ2hyb21lICYjNDI7L1xuICogIHRyYW5zaXRpb246IDFzIGxpbmVhciBhbGw7IC8mIzQyOyBBbGwgb3RoZXIgbW9kZXJuIGJyb3dzZXJzIGFuZCBJRTEwKyAmIzQyOy9cbiAqXG4gKiAgLyYjNDI7IFRoZSBhbmltYXRpb24gcHJlcGFyYXRpb24gY29kZSAmIzQyOy9cbiAqICBvcGFjaXR5OiAwO1xuICogfVxuICpcbiAqIC8mIzQyO1xuICogIEtlZXAgaW4gbWluZCB0aGF0IHlvdSB3YW50IHRvIGNvbWJpbmUgYm90aCBDU1NcbiAqICBjbGFzc2VzIHRvZ2V0aGVyIHRvIGF2b2lkIGFueSBDU1Mtc3BlY2lmaWNpdHlcbiAqICBjb25mbGljdHNcbiAqICYjNDI7L1xuICogLnJldmVhbC1hbmltYXRpb24ubmctZW50ZXIubmctZW50ZXItYWN0aXZlIHtcbiAqICAvJiM0MjsgVGhlIGFuaW1hdGlvbiBjb2RlIGl0c2VsZiAmIzQyOy9cbiAqICBvcGFjaXR5OiAxO1xuICogfVxuICogPC9zdHlsZT5cbiAqXG4gKiA8ZGl2IGNsYXNzPVwidmlldy1jb250YWluZXJcIj5cbiAqICAgPGRpdiBuZy12aWV3IGNsYXNzPVwicmV2ZWFsLWFuaW1hdGlvblwiPjwvZGl2PlxuICogPC9kaXY+XG4gKiBgYGBcbiAqXG4gKiBUaGUgZm9sbG93aW5nIGNvZGUgYmVsb3cgZGVtb25zdHJhdGVzIGhvdyB0byBwZXJmb3JtIGFuaW1hdGlvbnMgdXNpbmcgKipDU1MgYW5pbWF0aW9ucyoqIHdpdGggQW5ndWxhcjpcbiAqXG4gKiBgYGBodG1sXG4gKiA8c3R5bGUgdHlwZT1cInRleHQvY3NzXCI+XG4gKiAucmV2ZWFsLWFuaW1hdGlvbi5uZy1lbnRlciB7XG4gKiAgIC13ZWJraXQtYW5pbWF0aW9uOiBlbnRlcl9zZXF1ZW5jZSAxcyBsaW5lYXI7IC8mIzQyOyBTYWZhcmkvQ2hyb21lICYjNDI7L1xuICogICBhbmltYXRpb246IGVudGVyX3NlcXVlbmNlIDFzIGxpbmVhcjsgLyYjNDI7IElFMTArIGFuZCBGdXR1cmUgQnJvd3NlcnMgJiM0MjsvXG4gKiB9XG4gKiBALXdlYmtpdC1rZXlmcmFtZXMgZW50ZXJfc2VxdWVuY2Uge1xuICogICBmcm9tIHsgb3BhY2l0eTowOyB9XG4gKiAgIHRvIHsgb3BhY2l0eToxOyB9XG4gKiB9XG4gKiBAa2V5ZnJhbWVzIGVudGVyX3NlcXVlbmNlIHtcbiAqICAgZnJvbSB7IG9wYWNpdHk6MDsgfVxuICogICB0byB7IG9wYWNpdHk6MTsgfVxuICogfVxuICogPC9zdHlsZT5cbiAqXG4gKiA8ZGl2IGNsYXNzPVwidmlldy1jb250YWluZXJcIj5cbiAqICAgPGRpdiBuZy12aWV3IGNsYXNzPVwicmV2ZWFsLWFuaW1hdGlvblwiPjwvZGl2PlxuICogPC9kaXY+XG4gKiBgYGBcbiAqXG4gKiBCb3RoIENTUzMgYW5pbWF0aW9ucyBhbmQgdHJhbnNpdGlvbnMgY2FuIGJlIHVzZWQgdG9nZXRoZXIgYW5kIHRoZSBhbmltYXRlIHNlcnZpY2Ugd2lsbCBmaWd1cmUgb3V0IHRoZSBjb3JyZWN0IGR1cmF0aW9uIGFuZCBkZWxheSB0aW1pbmcuXG4gKlxuICogVXBvbiBET00gbXV0YXRpb24sIHRoZSBldmVudCBjbGFzcyBpcyBhZGRlZCBmaXJzdCAoc29tZXRoaW5nIGxpa2UgYG5nLWVudGVyYCksIHRoZW4gdGhlIGJyb3dzZXIgcHJlcGFyZXMgaXRzZWxmIHRvIGFkZFxuICogdGhlIGFjdGl2ZSBjbGFzcyAoaW4gdGhpcyBjYXNlIGBuZy1lbnRlci1hY3RpdmVgKSB3aGljaCB0aGVuIHRyaWdnZXJzIHRoZSBhbmltYXRpb24uIFRoZSBhbmltYXRpb24gbW9kdWxlIHdpbGwgYXV0b21hdGljYWxseVxuICogZGV0ZWN0IHRoZSBDU1MgY29kZSB0byBkZXRlcm1pbmUgd2hlbiB0aGUgYW5pbWF0aW9uIGVuZHMuIE9uY2UgdGhlIGFuaW1hdGlvbiBpcyBvdmVyIHRoZW4gYm90aCBDU1MgY2xhc3NlcyB3aWxsIGJlXG4gKiByZW1vdmVkIGZyb20gdGhlIERPTS4gSWYgYSBicm93c2VyIGRvZXMgbm90IHN1cHBvcnQgQ1NTIHRyYW5zaXRpb25zIG9yIENTUyBhbmltYXRpb25zIHRoZW4gdGhlIGFuaW1hdGlvbiB3aWxsIHN0YXJ0IGFuZCBlbmRcbiAqIGltbWVkaWF0ZWx5IHJlc3VsdGluZyBpbiBhIERPTSBlbGVtZW50IHRoYXQgaXMgYXQgaXRzIGZpbmFsIHN0YXRlLiBUaGlzIGZpbmFsIHN0YXRlIGlzIHdoZW4gdGhlIERPTSBlbGVtZW50XG4gKiBoYXMgbm8gQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uIGNsYXNzZXMgYXBwbGllZCB0byBpdC5cbiAqXG4gKiAjIyMgU3RydWN0dXJhbCB0cmFuc2l0aW9uIGFuaW1hdGlvbnNcbiAqXG4gKiBTdHJ1Y3R1cmFsIHRyYW5zaXRpb25zIChzdWNoIGFzIGVudGVyLCBsZWF2ZSBhbmQgbW92ZSkgd2lsbCBhbHdheXMgYXBwbHkgYSBgMHMgbm9uZWAgdHJhbnNpdGlvblxuICogdmFsdWUgdG8gZm9yY2UgdGhlIGJyb3dzZXIgaW50byByZW5kZXJpbmcgdGhlIHN0eWxlcyBkZWZpbmVkIGluIHRoZSBzZXR1cCAoYC5uZy1lbnRlcmAsIGAubmctbGVhdmVgXG4gKiBvciBgLm5nLW1vdmVgKSBjbGFzcy4gVGhpcyBtZWFucyB0aGF0IGFueSBhY3RpdmUgdHJhbnNpdGlvbiBhbmltYXRpb25zIG9wZXJhdGluZyBvbiB0aGUgZWxlbWVudFxuICogd2lsbCBiZSBjdXQgb2ZmIHRvIG1ha2Ugd2F5IGZvciB0aGUgZW50ZXIsIGxlYXZlIG9yIG1vdmUgYW5pbWF0aW9uLlxuICpcbiAqICMjIyBDbGFzcy1iYXNlZCB0cmFuc2l0aW9uIGFuaW1hdGlvbnNcbiAqXG4gKiBDbGFzcy1iYXNlZCB0cmFuc2l0aW9ucyByZWZlciB0byB0cmFuc2l0aW9uIGFuaW1hdGlvbnMgdGhhdCBhcmUgdHJpZ2dlcmVkIHdoZW4gYSBDU1MgY2xhc3MgaXNcbiAqIGFkZGVkIHRvIG9yIHJlbW92ZWQgZnJvbSB0aGUgZWxlbWVudCAodmlhIGAkYW5pbWF0ZS5hZGRDbGFzc2AsIGAkYW5pbWF0ZS5yZW1vdmVDbGFzc2AsXG4gKiBgJGFuaW1hdGUuc2V0Q2xhc3NgLCBvciBieSBkaXJlY3RpdmVzIHN1Y2ggYXMgYG5nQ2xhc3NgLCBgbmdNb2RlbGAgYW5kIGBmb3JtYCkuXG4gKiBUaGV5IGFyZSBkaWZmZXJlbnQgd2hlbiBjb21wYXJlZCB0byBzdHJ1Y3R1cmFsIGFuaW1hdGlvbnMgc2luY2UgdGhleSAqKmRvIG5vdCBjYW5jZWwgZXhpc3RpbmdcbiAqIGFuaW1hdGlvbnMqKiBub3IgZG8gdGhleSAqKmJsb2NrIHN1Y2Nlc3NpdmUgdHJhbnNpdGlvbnMqKiBmcm9tIHJlbmRlcmluZyBvbiB0aGUgc2FtZSBlbGVtZW50LlxuICogVGhpcyBkaXN0aW5jdGlvbiBhbGxvd3MgZm9yICoqbXVsdGlwbGUgY2xhc3MtYmFzZWQgdHJhbnNpdGlvbnMqKiB0byBiZSBwZXJmb3JtZWQgb24gdGhlIHNhbWUgZWxlbWVudC5cbiAqXG4gKiBJbiBhZGRpdGlvbiB0byBuZ0FuaW1hdGUgc3VwcG9ydGluZyB0aGUgZGVmYXVsdCAobmF0dXJhbCkgZnVuY3Rpb25hbGl0eSBvZiBjbGFzcy1iYXNlZCB0cmFuc2l0aW9uXG4gKiBhbmltYXRpb25zLCBuZ0FuaW1hdGUgYWxzbyBkZWNvcmF0ZXMgdGhlIGVsZW1lbnQgd2l0aCBzdGFydGluZyBhbmQgZW5kaW5nIENTUyBjbGFzc2VzIHRvIGFpZCB0aGVcbiAqIGRldmVsb3BlciBpbiBmdXJ0aGVyIHN0eWxpbmcgdGhlIGVsZW1lbnQgdGhyb3VnaG91dCB0aGUgdHJhbnNpdGlvbiBhbmltYXRpb24uIEVhcmxpZXIgdmVyc2lvbnNcbiAqIG9mIG5nQW5pbWF0ZSBtYXkgaGF2ZSBjYXVzZWQgbmF0dXJhbCBDU1MgdHJhbnNpdGlvbnMgdG8gYnJlYWsgYW5kIG5vdCByZW5kZXIgcHJvcGVybHkgZHVlIHRvXG4gKiAkYW5pbWF0ZSB0ZW1wb3JhcmlseSBibG9ja2luZyB0cmFuc2l0aW9ucyB1c2luZyBgMHMgbm9uZWAgaW4gb3JkZXIgdG8gYWxsb3cgdGhlIHNldHVwIENTUyBjbGFzc1xuICogKHRoZSBgLWFkZGAgb3IgYC1yZW1vdmVgIGNsYXNzKSB0byBiZSBhcHBsaWVkIHdpdGhvdXQgdHJpZ2dlcmluZyBhbiBhbmltYXRpb24uIEhvd2V2ZXIsIGFzIG9mXG4gKiAqKnZlcnNpb24gMS4zKiosIHRoaXMgd29ya2Fyb3VuZCBoYXMgYmVlbiByZW1vdmVkIHdpdGggbmdBbmltYXRlIGFuZCBhbGwgbm9uLW5nQW5pbWF0ZSBDU1NcbiAqIGNsYXNzIHRyYW5zaXRpb25zIGFyZSBjb21wYXRpYmxlIHdpdGggbmdBbmltYXRlLlxuICpcbiAqIFRoZXJlIGlzLCBob3dldmVyLCBvbmUgc3BlY2lhbCBjYXNlIHdoZW4gZGVhbGluZyB3aXRoIGNsYXNzLWJhc2VkIHRyYW5zaXRpb25zIGluIG5nQW5pbWF0ZS5cbiAqIFdoZW4gcmVuZGVyaW5nIGNsYXNzLWJhc2VkIHRyYW5zaXRpb25zIHRoYXQgbWFrZSB1c2Ugb2YgdGhlIHNldHVwIGFuZCBhY3RpdmUgQ1NTIGNsYXNzZXNcbiAqIChlLmcuIGAuZmFkZS1hZGRgIGFuZCBgLmZhZGUtYWRkLWFjdGl2ZWAgZm9yIHdoZW4gYC5mYWRlYCBpcyBhZGRlZCkgYmUgc3VyZSB0byBkZWZpbmVcbiAqIHRoZSB0cmFuc2l0aW9uIHZhbHVlICoqb24gdGhlIGFjdGl2ZSBDU1MgY2xhc3MqKiBhbmQgbm90IHRoZSBzZXR1cCBjbGFzcy5cbiAqXG4gKiBgYGBjc3NcbiAqIC5mYWRlLWFkZCB7XG4gKiAgIC8mIzQyOyByZW1lbWJlciB0byBwbGFjZSBhIDBzIHRyYW5zaXRpb24gaGVyZVxuICogICAgICB0byBlbnN1cmUgdGhhdCB0aGUgc3R5bGVzIGFyZSBhcHBsaWVkIGluc3RhbnRseVxuICogICAgICBldmVuIGlmIHRoZSBlbGVtZW50IGFscmVhZHkgaGFzIGEgdHJhbnNpdGlvbiBzdHlsZSAmIzQyOy9cbiAqICAgdHJhbnNpdGlvbjowcyBsaW5lYXIgYWxsO1xuICpcbiAqICAgLyYjNDI7IHN0YXJ0aW5nIENTUyBzdHlsZXMgJiM0MjsvXG4gKiAgIG9wYWNpdHk6MTtcbiAqIH1cbiAqIC5mYWRlLWFkZC5mYWRlLWFkZC1hY3RpdmUge1xuICogICAvJiM0MjsgdGhpcyB3aWxsIGJlIHRoZSBsZW5ndGggb2YgdGhlIGFuaW1hdGlvbiAmIzQyOy9cbiAqICAgdHJhbnNpdGlvbjoxcyBsaW5lYXIgYWxsO1xuICogICBvcGFjaXR5OjA7XG4gKiB9XG4gKiBgYGBcbiAqXG4gKiBUaGUgc2V0dXAgQ1NTIGNsYXNzIChpbiB0aGlzIGNhc2UgYC5mYWRlLWFkZGApIGFsc28gaGFzIGEgdHJhbnNpdGlvbiBzdHlsZSBwcm9wZXJ0eSwgaG93ZXZlciwgaXRcbiAqIGhhcyBhIGR1cmF0aW9uIG9mIHplcm8uIFRoaXMgbWF5IG5vdCBiZSByZXF1aXJlZCwgaG93ZXZlciwgaW5jYXNlIHRoZSBicm93c2VyIGlzIHVuYWJsZSB0byByZW5kZXJcbiAqIHRoZSBzdHlsaW5nIHByZXNlbnQgaW4gdGhpcyBDU1MgY2xhc3MgaW5zdGFudGx5IHRoZW4gaXQgY291bGQgYmUgdGhhdCB0aGUgYnJvd3NlciBpcyBhdHRlbXB0aW5nXG4gKiB0byBwZXJmb3JtIGFuIHVubmVjZXNzYXJ5IHRyYW5zaXRpb24uXG4gKlxuICogVGhpcyB3b3JrYXJvdW5kLCBob3dldmVyLCBkb2VzIG5vdCBhcHBseSB0byAgc3RhbmRhcmQgY2xhc3MtYmFzZWQgdHJhbnNpdGlvbnMgdGhhdCBhcmUgcmVuZGVyZWRcbiAqIHdoZW4gYSBDU1MgY2xhc3MgY29udGFpbmluZyBhIHRyYW5zaXRpb24gaXMgYXBwbGllZCB0byBhbiBlbGVtZW50OlxuICpcbiAqIGBgYGNzc1xuICogLyYjNDI7IHRoaXMgd29ya3MgYXMgZXhwZWN0ZWQgJiM0MjsvXG4gKiAuZmFkZSB7XG4gKiAgIHRyYW5zaXRpb246MXMgbGluZWFyIGFsbDtcbiAqICAgb3BhY2l0eTowO1xuICogfVxuICogYGBgXG4gKlxuICogUGxlYXNlIGtlZXAgdGhpcyBpbiBtaW5kIHdoZW4gY29kaW5nIHRoZSBDU1MgbWFya3VwIHRoYXQgd2lsbCBiZSB1c2VkIHdpdGhpbiBjbGFzcy1iYXNlZCB0cmFuc2l0aW9ucy5cbiAqIEFsc28sIHRyeSBub3QgdG8gbWl4IHRoZSB0d28gY2xhc3MtYmFzZWQgYW5pbWF0aW9uIGZsYXZvcnMgdG9nZXRoZXIgc2luY2UgdGhlIENTUyBjb2RlIG1heSBiZWNvbWVcbiAqIG92ZXJseSBjb21wbGV4LlxuICpcbiAqXG4gKiAjIyMgUHJldmVudGluZyBDb2xsaXNpb25zIFdpdGggVGhpcmQgUGFydHkgTGlicmFyaWVzXG4gKlxuICogU29tZSB0aGlyZC1wYXJ0eSBmcmFtZXdvcmtzIHBsYWNlIGFuaW1hdGlvbiBkdXJhdGlvbiBkZWZhdWx0cyBhY3Jvc3MgbWFueSBlbGVtZW50IG9yIGNsYXNzTmFtZVxuICogc2VsZWN0b3JzIGluIG9yZGVyIHRvIG1ha2UgdGhlaXIgY29kZSBzbWFsbCBhbmQgcmV1c2VhYmxlLiBUaGlzIGNhbiBsZWFkIHRvIGlzc3VlcyB3aXRoIG5nQW5pbWF0ZSwgd2hpY2hcbiAqIGlzIGV4cGVjdGluZyBhY3R1YWwgYW5pbWF0aW9ucyBvbiB0aGVzZSBlbGVtZW50cyBhbmQgaGFzIHRvIHdhaXQgZm9yIHRoZWlyIGNvbXBsZXRpb24uXG4gKlxuICogWW91IGNhbiBwcmV2ZW50IHRoaXMgdW53YW50ZWQgYmVoYXZpb3IgYnkgdXNpbmcgYSBwcmVmaXggb24gYWxsIHlvdXIgYW5pbWF0aW9uIGNsYXNzZXM6XG4gKlxuICogYGBgY3NzXG4gKiAvJiM0MjsgcHJlZml4ZWQgd2l0aCBhbmltYXRlLSAmIzQyOy9cbiAqIC5hbmltYXRlLWZhZGUtYWRkLmFuaW1hdGUtZmFkZS1hZGQtYWN0aXZlIHtcbiAqICAgdHJhbnNpdGlvbjoxcyBsaW5lYXIgYWxsO1xuICogICBvcGFjaXR5OjA7XG4gKiB9XG4gKiBgYGBcbiAqXG4gKiBZb3UgdGhlbiBjb25maWd1cmUgYCRhbmltYXRlYCB0byBlbmZvcmNlIHRoaXMgcHJlZml4OlxuICpcbiAqIGBgYGpzXG4gKiAkYW5pbWF0ZVByb3ZpZGVyLmNsYXNzTmFtZUZpbHRlcigvYW5pbWF0ZS0vKTtcbiAqIGBgYFxuICogPC9kaXY+XG4gKlxuICogIyMjIENTUyBTdGFnZ2VyaW5nIEFuaW1hdGlvbnNcbiAqIEEgU3RhZ2dlcmluZyBhbmltYXRpb24gaXMgYSBjb2xsZWN0aW9uIG9mIGFuaW1hdGlvbnMgdGhhdCBhcmUgaXNzdWVkIHdpdGggYSBzbGlnaHQgZGVsYXkgaW4gYmV0d2VlbiBlYWNoIHN1Y2Nlc3NpdmUgb3BlcmF0aW9uIHJlc3VsdGluZyBpbiBhXG4gKiBjdXJ0YWluLWxpa2UgZWZmZWN0LiBUaGUgbmdBbmltYXRlIG1vZHVsZSAodmVyc2lvbnMgPj0xLjIpIHN1cHBvcnRzIHN0YWdnZXJpbmcgYW5pbWF0aW9ucyBhbmQgdGhlIHN0YWdnZXIgZWZmZWN0IGNhbiBiZVxuICogcGVyZm9ybWVkIGJ5IGNyZWF0aW5nIGEgKipuZy1FVkVOVC1zdGFnZ2VyKiogQ1NTIGNsYXNzIGFuZCBhdHRhY2hpbmcgdGhhdCBjbGFzcyB0byB0aGUgYmFzZSBDU1MgY2xhc3MgdXNlZCBmb3JcbiAqIHRoZSBhbmltYXRpb24uIFRoZSBzdHlsZSBwcm9wZXJ0eSBleHBlY3RlZCB3aXRoaW4gdGhlIHN0YWdnZXIgY2xhc3MgY2FuIGVpdGhlciBiZSBhICoqdHJhbnNpdGlvbi1kZWxheSoqIG9yIGFuXG4gKiAqKmFuaW1hdGlvbi1kZWxheSoqIHByb3BlcnR5IChvciBib3RoIGlmIHlvdXIgYW5pbWF0aW9uIGNvbnRhaW5zIGJvdGggdHJhbnNpdGlvbnMgYW5kIGtleWZyYW1lIGFuaW1hdGlvbnMpLlxuICpcbiAqIGBgYGNzc1xuICogLm15LWFuaW1hdGlvbi5uZy1lbnRlciB7XG4gKiAgIC8mIzQyOyBzdGFuZGFyZCB0cmFuc2l0aW9uIGNvZGUgJiM0MjsvXG4gKiAgIC13ZWJraXQtdHJhbnNpdGlvbjogMXMgbGluZWFyIGFsbDtcbiAqICAgdHJhbnNpdGlvbjogMXMgbGluZWFyIGFsbDtcbiAqICAgb3BhY2l0eTowO1xuICogfVxuICogLm15LWFuaW1hdGlvbi5uZy1lbnRlci1zdGFnZ2VyIHtcbiAqICAgLyYjNDI7IHRoaXMgd2lsbCBoYXZlIGEgMTAwbXMgZGVsYXkgYmV0d2VlbiBlYWNoIHN1Y2Nlc3NpdmUgbGVhdmUgYW5pbWF0aW9uICYjNDI7L1xuICogICAtd2Via2l0LXRyYW5zaXRpb24tZGVsYXk6IDAuMXM7XG4gKiAgIHRyYW5zaXRpb24tZGVsYXk6IDAuMXM7XG4gKlxuICogICAvJiM0MjsgaW4gY2FzZSB0aGUgc3RhZ2dlciBkb2Vzbid0IHdvcmsgdGhlbiB0aGVzZSB0d28gdmFsdWVzXG4gKiAgICBtdXN0IGJlIHNldCB0byAwIHRvIGF2b2lkIGFuIGFjY2lkZW50YWwgQ1NTIGluaGVyaXRhbmNlICYjNDI7L1xuICogICAtd2Via2l0LXRyYW5zaXRpb24tZHVyYXRpb246IDBzO1xuICogICB0cmFuc2l0aW9uLWR1cmF0aW9uOiAwcztcbiAqIH1cbiAqIC5teS1hbmltYXRpb24ubmctZW50ZXIubmctZW50ZXItYWN0aXZlIHtcbiAqICAgLyYjNDI7IHN0YW5kYXJkIHRyYW5zaXRpb24gc3R5bGVzICYjNDI7L1xuICogICBvcGFjaXR5OjE7XG4gKiB9XG4gKiBgYGBcbiAqXG4gKiBTdGFnZ2VyaW5nIGFuaW1hdGlvbnMgd29yayBieSBkZWZhdWx0IGluIG5nUmVwZWF0IChzbyBsb25nIGFzIHRoZSBDU1MgY2xhc3MgaXMgZGVmaW5lZCkuIE91dHNpZGUgb2YgbmdSZXBlYXQsIHRvIHVzZSBzdGFnZ2VyaW5nIGFuaW1hdGlvbnNcbiAqIG9uIHlvdXIgb3duLCB0aGV5IGNhbiBiZSB0cmlnZ2VyZWQgYnkgZmlyaW5nIG11bHRpcGxlIGNhbGxzIHRvIHRoZSBzYW1lIGV2ZW50IG9uICRhbmltYXRlLiBIb3dldmVyLCB0aGUgcmVzdHJpY3Rpb25zIHN1cnJvdW5kaW5nIHRoaXNcbiAqIGFyZSB0aGF0IGVhY2ggb2YgdGhlIGVsZW1lbnRzIG11c3QgaGF2ZSB0aGUgc2FtZSBDU1MgY2xhc3NOYW1lIHZhbHVlIGFzIHdlbGwgYXMgdGhlIHNhbWUgcGFyZW50IGVsZW1lbnQuIEEgc3RhZ2dlciBvcGVyYXRpb25cbiAqIHdpbGwgYWxzbyBiZSByZXNldCBpZiBtb3JlIHRoYW4gMTBtcyBoYXMgcGFzc2VkIGFmdGVyIHRoZSBsYXN0IGFuaW1hdGlvbiBoYXMgYmVlbiBmaXJlZC5cbiAqXG4gKiBUaGUgZm9sbG93aW5nIGNvZGUgd2lsbCBpc3N1ZSB0aGUgKipuZy1sZWF2ZS1zdGFnZ2VyKiogZXZlbnQgb24gdGhlIGVsZW1lbnQgcHJvdmlkZWQ6XG4gKlxuICogYGBganNcbiAqIHZhciBraWRzID0gcGFyZW50LmNoaWxkcmVuKCk7XG4gKlxuICogJGFuaW1hdGUubGVhdmUoa2lkc1swXSk7IC8vc3RhZ2dlciBpbmRleD0wXG4gKiAkYW5pbWF0ZS5sZWF2ZShraWRzWzFdKTsgLy9zdGFnZ2VyIGluZGV4PTFcbiAqICRhbmltYXRlLmxlYXZlKGtpZHNbMl0pOyAvL3N0YWdnZXIgaW5kZXg9MlxuICogJGFuaW1hdGUubGVhdmUoa2lkc1szXSk7IC8vc3RhZ2dlciBpbmRleD0zXG4gKiAkYW5pbWF0ZS5sZWF2ZShraWRzWzRdKTsgLy9zdGFnZ2VyIGluZGV4PTRcbiAqXG4gKiAkdGltZW91dChmdW5jdGlvbigpIHtcbiAqICAgLy9zdGFnZ2VyIGhhcyByZXNldCBpdHNlbGZcbiAqICAgJGFuaW1hdGUubGVhdmUoa2lkc1s1XSk7IC8vc3RhZ2dlciBpbmRleD0wXG4gKiAgICRhbmltYXRlLmxlYXZlKGtpZHNbNl0pOyAvL3N0YWdnZXIgaW5kZXg9MVxuICogfSwgMTAwLCBmYWxzZSk7XG4gKiBgYGBcbiAqXG4gKiBTdGFnZ2VyIGFuaW1hdGlvbnMgYXJlIGN1cnJlbnRseSBvbmx5IHN1cHBvcnRlZCB3aXRoaW4gQ1NTLWRlZmluZWQgYW5pbWF0aW9ucy5cbiAqXG4gKiAjIyBKYXZhU2NyaXB0LWRlZmluZWQgQW5pbWF0aW9uc1xuICogSW4gdGhlIGV2ZW50IHRoYXQgeW91IGRvIG5vdCB3YW50IHRvIHVzZSBDU1MzIHRyYW5zaXRpb25zIG9yIENTUzMgYW5pbWF0aW9ucyBvciBpZiB5b3Ugd2lzaCB0byBvZmZlciBhbmltYXRpb25zIG9uIGJyb3dzZXJzIHRoYXQgZG8gbm90XG4gKiB5ZXQgc3VwcG9ydCBDU1MgdHJhbnNpdGlvbnMvYW5pbWF0aW9ucywgdGhlbiB5b3UgY2FuIG1ha2UgdXNlIG9mIEphdmFTY3JpcHQgYW5pbWF0aW9ucyBkZWZpbmVkIGluc2lkZSBvZiB5b3VyIEFuZ3VsYXJKUyBtb2R1bGUuXG4gKlxuICogYGBganNcbiAqIC8vIWFubm90YXRlPVwiWW91ckFwcFwiIFlvdXIgQW5ndWxhckpTIE1vZHVsZXxSZXBsYWNlIHRoaXMgb3IgbmdNb2R1bGUgd2l0aCB0aGUgbW9kdWxlIHRoYXQgeW91IHVzZWQgdG8gZGVmaW5lIHlvdXIgYXBwbGljYXRpb24uXG4gKiB2YXIgbmdNb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnWW91ckFwcCcsIFsnbmdBbmltYXRlJ10pO1xuICogbmdNb2R1bGUuYW5pbWF0aW9uKCcubXktY3JhenktYW5pbWF0aW9uJywgZnVuY3Rpb24oKSB7XG4gKiAgIHJldHVybiB7XG4gKiAgICAgZW50ZXI6IGZ1bmN0aW9uKGVsZW1lbnQsIGRvbmUpIHtcbiAqICAgICAgIC8vcnVuIHRoZSBhbmltYXRpb24gaGVyZSBhbmQgY2FsbCBkb25lIHdoZW4gdGhlIGFuaW1hdGlvbiBpcyBjb21wbGV0ZVxuICogICAgICAgcmV0dXJuIGZ1bmN0aW9uKGNhbmNlbGxlZCkge1xuICogICAgICAgICAvL3RoaXMgKG9wdGlvbmFsKSBmdW5jdGlvbiB3aWxsIGJlIGNhbGxlZCB3aGVuIHRoZSBhbmltYXRpb25cbiAqICAgICAgICAgLy9jb21wbGV0ZXMgb3Igd2hlbiB0aGUgYW5pbWF0aW9uIGlzIGNhbmNlbGxlZCAodGhlIGNhbmNlbGxlZFxuICogICAgICAgICAvL2ZsYWcgd2lsbCBiZSBzZXQgdG8gdHJ1ZSBpZiBjYW5jZWxsZWQpLlxuICogICAgICAgfTtcbiAqICAgICB9LFxuICogICAgIGxlYXZlOiBmdW5jdGlvbihlbGVtZW50LCBkb25lKSB7IH0sXG4gKiAgICAgbW92ZTogZnVuY3Rpb24oZWxlbWVudCwgZG9uZSkgeyB9LFxuICpcbiAqICAgICAvL2FuaW1hdGlvbiB0aGF0IGNhbiBiZSB0cmlnZ2VyZWQgYmVmb3JlIHRoZSBjbGFzcyBpcyBhZGRlZFxuICogICAgIGJlZm9yZUFkZENsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGRvbmUpIHsgfSxcbiAqXG4gKiAgICAgLy9hbmltYXRpb24gdGhhdCBjYW4gYmUgdHJpZ2dlcmVkIGFmdGVyIHRoZSBjbGFzcyBpcyBhZGRlZFxuICogICAgIGFkZENsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGRvbmUpIHsgfSxcbiAqXG4gKiAgICAgLy9hbmltYXRpb24gdGhhdCBjYW4gYmUgdHJpZ2dlcmVkIGJlZm9yZSB0aGUgY2xhc3MgaXMgcmVtb3ZlZFxuICogICAgIGJlZm9yZVJlbW92ZUNsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGRvbmUpIHsgfSxcbiAqXG4gKiAgICAgLy9hbmltYXRpb24gdGhhdCBjYW4gYmUgdHJpZ2dlcmVkIGFmdGVyIHRoZSBjbGFzcyBpcyByZW1vdmVkXG4gKiAgICAgcmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgZG9uZSkgeyB9XG4gKiAgIH07XG4gKiB9KTtcbiAqIGBgYFxuICpcbiAqIEphdmFTY3JpcHQtZGVmaW5lZCBhbmltYXRpb25zIGFyZSBjcmVhdGVkIHdpdGggYSBDU1MtbGlrZSBjbGFzcyBzZWxlY3RvciBhbmQgYSBjb2xsZWN0aW9uIG9mIGV2ZW50cyB3aGljaCBhcmUgc2V0IHRvIHJ1blxuICogYSBqYXZhc2NyaXB0IGNhbGxiYWNrIGZ1bmN0aW9uLiBXaGVuIGFuIGFuaW1hdGlvbiBpcyB0cmlnZ2VyZWQsICRhbmltYXRlIHdpbGwgbG9vayBmb3IgYSBtYXRjaGluZyBhbmltYXRpb24gd2hpY2ggZml0c1xuICogdGhlIGVsZW1lbnQncyBDU1MgY2xhc3MgYXR0cmlidXRlIHZhbHVlIGFuZCB0aGVuIHJ1biB0aGUgbWF0Y2hpbmcgYW5pbWF0aW9uIGV2ZW50IGZ1bmN0aW9uIChpZiBmb3VuZCkuXG4gKiBJbiBvdGhlciB3b3JkcywgaWYgdGhlIENTUyBjbGFzc2VzIHByZXNlbnQgb24gdGhlIGFuaW1hdGVkIGVsZW1lbnQgbWF0Y2ggYW55IG9mIHRoZSBKYXZhU2NyaXB0IGFuaW1hdGlvbnMgdGhlbiB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gd2lsbFxuICogYmUgZXhlY3V0ZWQuIEl0IHNob3VsZCBiZSBhbHNvIG5vdGVkIHRoYXQgb25seSBzaW1wbGUsIHNpbmdsZSBjbGFzcyBzZWxlY3RvcnMgYXJlIGFsbG93ZWQgKGNvbXBvdW5kIGNsYXNzIHNlbGVjdG9ycyBhcmUgbm90IHN1cHBvcnRlZCkuXG4gKlxuICogV2l0aGluIGEgSmF2YVNjcmlwdCBhbmltYXRpb24sIGFuIG9iamVjdCBjb250YWluaW5nIHZhcmlvdXMgZXZlbnQgY2FsbGJhY2sgYW5pbWF0aW9uIGZ1bmN0aW9ucyBpcyBleHBlY3RlZCB0byBiZSByZXR1cm5lZC5cbiAqIEFzIGV4cGxhaW5lZCBhYm92ZSwgdGhlc2UgY2FsbGJhY2tzIGFyZSB0cmlnZ2VyZWQgYmFzZWQgb24gdGhlIGFuaW1hdGlvbiBldmVudC4gVGhlcmVmb3JlIGlmIGFuIGVudGVyIGFuaW1hdGlvbiBpcyBydW4sXG4gKiBhbmQgdGhlIEphdmFTY3JpcHQgYW5pbWF0aW9uIGlzIGZvdW5kLCB0aGVuIHRoZSBlbnRlciBjYWxsYmFjayB3aWxsIGhhbmRsZSB0aGF0IGFuaW1hdGlvbiAoaW4gYWRkaXRpb24gdG8gdGhlIENTUyBrZXlmcmFtZSBhbmltYXRpb25cbiAqIG9yIHRyYW5zaXRpb24gY29kZSB0aGF0IGlzIGRlZmluZWQgdmlhIGEgc3R5bGVzaGVldCkuXG4gKlxuICpcbiAqICMjIyBBcHBseWluZyBEaXJlY3RpdmUtc3BlY2lmaWMgU3R5bGVzIHRvIGFuIEFuaW1hdGlvblxuICogSW4gc29tZSBjYXNlcyBhIGRpcmVjdGl2ZSBvciBzZXJ2aWNlIG1heSB3YW50IHRvIHByb3ZpZGUgYCRhbmltYXRlYCB3aXRoIGV4dHJhIGRldGFpbHMgdGhhdCB0aGUgYW5pbWF0aW9uIHdpbGxcbiAqIGluY2x1ZGUgaW50byBpdHMgYW5pbWF0aW9uLiBMZXQncyBzYXkgZm9yIGV4YW1wbGUgd2Ugd2FudGVkIHRvIHJlbmRlciBhbiBhbmltYXRpb24gdGhhdCBhbmltYXRlcyBhbiBlbGVtZW50XG4gKiB0b3dhcmRzIHRoZSBtb3VzZSBjb29yZGluYXRlcyBhcyB0byB3aGVyZSB0aGUgdXNlciBjbGlja2VkIGxhc3QuIEJ5IGNvbGxlY3RpbmcgdGhlIFgvWSBjb29yZGluYXRlcyBvZiB0aGUgY2xpY2tcbiAqICh2aWEgdGhlIGV2ZW50IHBhcmFtZXRlcikgd2UgY2FuIHNldCB0aGUgYHRvcGAgYW5kIGBsZWZ0YCBzdHlsZXMgaW50byBhbiBvYmplY3QgYW5kIHBhc3MgdGhhdCBpbnRvIG91ciBmdW5jdGlvblxuICogY2FsbCB0byBgJGFuaW1hdGUuYWRkQ2xhc3NgLlxuICpcbiAqIGBgYGpzXG4gKiBjYW52YXMub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICogICAkYW5pbWF0ZS5hZGRDbGFzcyhlbGVtZW50LCAnb24nLCB7XG4gKiAgICAgdG86IHtcbiAqICAgICAgIGxlZnQgOiBlLmNsaWVudC54ICsgJ3B4JyxcbiAqICAgICAgIHRvcCA6IGUuY2xpZW50LnkgKyAncHgnXG4gKiAgICAgfVxuICogICB9KTpcbiAqIH0pO1xuICogYGBgXG4gKlxuICogTm93IHdoZW4gdGhlIGFuaW1hdGlvbiBydW5zLCBhbmQgYSB0cmFuc2l0aW9uIG9yIGtleWZyYW1lIGFuaW1hdGlvbiBpcyBwaWNrZWQgdXAsIHRoZW4gdGhlIGFuaW1hdGlvbiBpdHNlbGYgd2lsbFxuICogYWxzbyBpbmNsdWRlIGFuZCB0cmFuc2l0aW9uIHRoZSBzdHlsaW5nIG9mIHRoZSBgbGVmdGAgYW5kIGB0b3BgIHByb3BlcnRpZXMgaW50byBpdHMgcnVubmluZyBhbmltYXRpb24uIElmIHdlIHdhbnRcbiAqIHRvIHByb3ZpZGUgc29tZSBzdGFydGluZyBhbmltYXRpb24gdmFsdWVzIHRoZW4gd2UgY2FuIGRvIHNvIGJ5IHBsYWNpbmcgdGhlIHN0YXJ0aW5nIGFuaW1hdGlvbnMgc3R5bGVzIGludG8gYW4gb2JqZWN0XG4gKiBjYWxsZWQgYGZyb21gIGluIHRoZSBzYW1lIG9iamVjdCBhcyB0aGUgYHRvYCBhbmltYXRpb25zLlxuICpcbiAqIGBgYGpzXG4gKiBjYW52YXMub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICogICAkYW5pbWF0ZS5hZGRDbGFzcyhlbGVtZW50LCAnb24nLCB7XG4gKiAgICAgZnJvbToge1xuICogICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICogICAgICAgIGxlZnQ6ICcwcHgnLFxuICogICAgICAgIHRvcDogJzBweCdcbiAqICAgICB9LFxuICogICAgIHRvOiB7XG4gKiAgICAgICBsZWZ0IDogZS5jbGllbnQueCArICdweCcsXG4gKiAgICAgICB0b3AgOiBlLmNsaWVudC55ICsgJ3B4J1xuICogICAgIH1cbiAqICAgfSk6XG4gKiB9KTtcbiAqIGBgYFxuICpcbiAqIE9uY2UgdGhlIGFuaW1hdGlvbiBpcyBjb21wbGV0ZSBvciBjYW5jZWxsZWQgdGhlbiB0aGUgdW5pb24gb2YgYm90aCB0aGUgYmVmb3JlIGFuZCBhZnRlciBzdHlsZXMgYXJlIGFwcGxpZWQgdG8gdGhlXG4gKiBlbGVtZW50LiBJZiBgbmdBbmltYXRlYCBpcyBub3QgcHJlc2VudCB0aGVuIHRoZSBzdHlsZXMgd2lsbCBiZSBhcHBsaWVkIGltbWVkaWF0ZWx5LlxuICpcbiAqL1xuXG5hbmd1bGFyLm1vZHVsZSgnbmdBbmltYXRlJywgWyduZyddKVxuXG4gIC8qKlxuICAgKiBAbmdkb2MgcHJvdmlkZXJcbiAgICogQG5hbWUgJGFuaW1hdGVQcm92aWRlclxuICAgKiBAZGVzY3JpcHRpb25cbiAgICpcbiAgICogVGhlIGAkYW5pbWF0ZVByb3ZpZGVyYCBhbGxvd3MgZGV2ZWxvcGVycyB0byByZWdpc3RlciBKYXZhU2NyaXB0IGFuaW1hdGlvbiBldmVudCBoYW5kbGVycyBkaXJlY3RseSBpbnNpZGUgb2YgYSBtb2R1bGUuXG4gICAqIFdoZW4gYW4gYW5pbWF0aW9uIGlzIHRyaWdnZXJlZCwgdGhlICRhbmltYXRlIHNlcnZpY2Ugd2lsbCBxdWVyeSB0aGUgJGFuaW1hdGUgc2VydmljZSB0byBmaW5kIGFueSBhbmltYXRpb25zIHRoYXQgbWF0Y2hcbiAgICogdGhlIHByb3ZpZGVkIG5hbWUgdmFsdWUuXG4gICAqXG4gICAqIFJlcXVpcmVzIHRoZSB7QGxpbmsgbmdBbmltYXRlIGBuZ0FuaW1hdGVgfSBtb2R1bGUgdG8gYmUgaW5zdGFsbGVkLlxuICAgKlxuICAgKiBQbGVhc2UgdmlzaXQgdGhlIHtAbGluayBuZ0FuaW1hdGUgYG5nQW5pbWF0ZWB9IG1vZHVsZSBvdmVydmlldyBwYWdlIGxlYXJuIG1vcmUgYWJvdXQgaG93IHRvIHVzZSBhbmltYXRpb25zIGluIHlvdXIgYXBwbGljYXRpb24uXG4gICAqXG4gICAqL1xuICAuZGlyZWN0aXZlKCduZ0FuaW1hdGVDaGlsZHJlbicsIGZ1bmN0aW9uKCkge1xuICAgIHZhciBOR19BTklNQVRFX0NISUxEUkVOID0gJyQkbmdBbmltYXRlQ2hpbGRyZW4nO1xuICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgIHZhciB2YWwgPSBhdHRycy5uZ0FuaW1hdGVDaGlsZHJlbjtcbiAgICAgIGlmIChhbmd1bGFyLmlzU3RyaW5nKHZhbCkgJiYgdmFsLmxlbmd0aCA9PT0gMCkgeyAvL2VtcHR5IGF0dHJpYnV0ZVxuICAgICAgICBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9DSElMRFJFTiwgdHJ1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzY29wZS4kd2F0Y2godmFsLCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgIGVsZW1lbnQuZGF0YShOR19BTklNQVRFX0NISUxEUkVOLCAhIXZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgfSlcblxuICAvL3RoaXMgcHJpdmF0ZSBzZXJ2aWNlIGlzIG9ubHkgdXNlZCB3aXRoaW4gQ1NTLWVuYWJsZWQgYW5pbWF0aW9uc1xuICAvL0lFOCArIElFOSBkbyBub3Qgc3VwcG9ydCByQUYgbmF0aXZlbHksIGJ1dCB0aGF0IGlzIGZpbmUgc2luY2UgdGhleVxuICAvL2Fsc28gZG9uJ3Qgc3VwcG9ydCB0cmFuc2l0aW9ucyBhbmQga2V5ZnJhbWVzIHdoaWNoIG1lYW5zIHRoYXQgdGhlIGNvZGVcbiAgLy9iZWxvdyB3aWxsIG5ldmVyIGJlIHVzZWQgYnkgdGhlIHR3byBicm93c2Vycy5cbiAgLmZhY3RvcnkoJyQkYW5pbWF0ZVJlZmxvdycsIFsnJCRyQUYnLCAnJGRvY3VtZW50JywgZnVuY3Rpb24oJCRyQUYsICRkb2N1bWVudCkge1xuICAgIHZhciBib2QgPSAkZG9jdW1lbnRbMF0uYm9keTtcbiAgICByZXR1cm4gZnVuY3Rpb24oZm4pIHtcbiAgICAgIC8vdGhlIHJldHVybmVkIGZ1bmN0aW9uIGFjdHMgYXMgdGhlIGNhbmNlbGxhdGlvbiBmdW5jdGlvblxuICAgICAgcmV0dXJuICQkckFGKGZ1bmN0aW9uKCkge1xuICAgICAgICAvL3RoZSBsaW5lIGJlbG93IHdpbGwgZm9yY2UgdGhlIGJyb3dzZXIgdG8gcGVyZm9ybSBhIHJlcGFpbnRcbiAgICAgICAgLy9zbyB0aGF0IGFsbCB0aGUgYW5pbWF0ZWQgZWxlbWVudHMgd2l0aGluIHRoZSBhbmltYXRpb24gZnJhbWVcbiAgICAgICAgLy93aWxsIGJlIHByb3Blcmx5IHVwZGF0ZWQgYW5kIGRyYXduIG9uIHNjcmVlbi4gVGhpcyBpc1xuICAgICAgICAvL3JlcXVpcmVkIHRvIHBlcmZvcm0gbXVsdGktY2xhc3MgQ1NTIGJhc2VkIGFuaW1hdGlvbnMgd2l0aFxuICAgICAgICAvL0ZpcmVmb3guIERPIE5PVCBSRU1PVkUgVEhJUyBMSU5FLlxuICAgICAgICB2YXIgYSA9IGJvZC5vZmZzZXRXaWR0aCArIDE7XG4gICAgICAgIGZuKCk7XG4gICAgICB9KTtcbiAgICB9O1xuICB9XSlcblxuICAuY29uZmlnKFsnJHByb3ZpZGUnLCAnJGFuaW1hdGVQcm92aWRlcicsIGZ1bmN0aW9uKCRwcm92aWRlLCAkYW5pbWF0ZVByb3ZpZGVyKSB7XG4gICAgdmFyIG5vb3AgPSBhbmd1bGFyLm5vb3A7XG4gICAgdmFyIGZvckVhY2ggPSBhbmd1bGFyLmZvckVhY2g7XG4gICAgdmFyIHNlbGVjdG9ycyA9ICRhbmltYXRlUHJvdmlkZXIuJCRzZWxlY3RvcnM7XG4gICAgdmFyIGlzQXJyYXkgPSBhbmd1bGFyLmlzQXJyYXk7XG4gICAgdmFyIGlzU3RyaW5nID0gYW5ndWxhci5pc1N0cmluZztcbiAgICB2YXIgaXNPYmplY3QgPSBhbmd1bGFyLmlzT2JqZWN0O1xuXG4gICAgdmFyIEVMRU1FTlRfTk9ERSA9IDE7XG4gICAgdmFyIE5HX0FOSU1BVEVfU1RBVEUgPSAnJCRuZ0FuaW1hdGVTdGF0ZSc7XG4gICAgdmFyIE5HX0FOSU1BVEVfQ0hJTERSRU4gPSAnJCRuZ0FuaW1hdGVDaGlsZHJlbic7XG4gICAgdmFyIE5HX0FOSU1BVEVfQ0xBU1NfTkFNRSA9ICduZy1hbmltYXRlJztcbiAgICB2YXIgcm9vdEFuaW1hdGVTdGF0ZSA9IHtydW5uaW5nOiB0cnVlfTtcblxuICAgIGZ1bmN0aW9uIGV4dHJhY3RFbGVtZW50Tm9kZShlbGVtZW50KSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1lbnQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGVsbSA9IGVsZW1lbnRbaV07XG4gICAgICAgIGlmIChlbG0ubm9kZVR5cGUgPT0gRUxFTUVOVF9OT0RFKSB7XG4gICAgICAgICAgcmV0dXJuIGVsbTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHByZXBhcmVFbGVtZW50KGVsZW1lbnQpIHtcbiAgICAgIHJldHVybiBlbGVtZW50ICYmIGFuZ3VsYXIuZWxlbWVudChlbGVtZW50KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdHJpcENvbW1lbnRzRnJvbUVsZW1lbnQoZWxlbWVudCkge1xuICAgICAgcmV0dXJuIGFuZ3VsYXIuZWxlbWVudChleHRyYWN0RWxlbWVudE5vZGUoZWxlbWVudCkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzTWF0Y2hpbmdFbGVtZW50KGVsbTEsIGVsbTIpIHtcbiAgICAgIHJldHVybiBleHRyYWN0RWxlbWVudE5vZGUoZWxtMSkgPT0gZXh0cmFjdEVsZW1lbnROb2RlKGVsbTIpO1xuICAgIH1cbiAgICB2YXIgJCRqcUxpdGU7XG4gICAgJHByb3ZpZGUuZGVjb3JhdG9yKCckYW5pbWF0ZScsXG4gICAgICAgIFsnJGRlbGVnYXRlJywgJyQkcScsICckaW5qZWN0b3InLCAnJHNuaWZmZXInLCAnJHJvb3RFbGVtZW50JywgJyQkYXN5bmNDYWxsYmFjaycsICckcm9vdFNjb3BlJywgJyRkb2N1bWVudCcsICckdGVtcGxhdGVSZXF1ZXN0JywgJyQkanFMaXRlJyxcbiBmdW5jdGlvbigkZGVsZWdhdGUsICAgJCRxLCAgICRpbmplY3RvciwgICAkc25pZmZlciwgICAkcm9vdEVsZW1lbnQsICAgJCRhc3luY0NhbGxiYWNrLCAgICRyb290U2NvcGUsICAgJGRvY3VtZW50LCAgICR0ZW1wbGF0ZVJlcXVlc3QsICAgJCQkanFMaXRlKSB7XG5cbiAgICAgICQkanFMaXRlID0gJCQkanFMaXRlO1xuICAgICAgJHJvb3RFbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSwgcm9vdEFuaW1hdGVTdGF0ZSk7XG5cbiAgICAgIC8vIFdhaXQgdW50aWwgYWxsIGRpcmVjdGl2ZSBhbmQgcm91dGUtcmVsYXRlZCB0ZW1wbGF0ZXMgYXJlIGRvd25sb2FkZWQgYW5kXG4gICAgICAvLyBjb21waWxlZC4gVGhlICR0ZW1wbGF0ZVJlcXVlc3QudG90YWxQZW5kaW5nUmVxdWVzdHMgdmFyaWFibGUga2VlcHMgdHJhY2sgb2ZcbiAgICAgIC8vIGFsbCBvZiB0aGUgcmVtb3RlIHRlbXBsYXRlcyBiZWluZyBjdXJyZW50bHkgZG93bmxvYWRlZC4gSWYgdGhlcmUgYXJlIG5vXG4gICAgICAvLyB0ZW1wbGF0ZXMgY3VycmVudGx5IGRvd25sb2FkaW5nIHRoZW4gdGhlIHdhdGNoZXIgd2lsbCBzdGlsbCBmaXJlIGFueXdheS5cbiAgICAgIHZhciBkZXJlZ2lzdGVyV2F0Y2ggPSAkcm9vdFNjb3BlLiR3YXRjaChcbiAgICAgICAgZnVuY3Rpb24oKSB7IHJldHVybiAkdGVtcGxhdGVSZXF1ZXN0LnRvdGFsUGVuZGluZ1JlcXVlc3RzOyB9LFxuICAgICAgICBmdW5jdGlvbih2YWwsIG9sZFZhbCkge1xuICAgICAgICAgIGlmICh2YWwgIT09IDApIHJldHVybjtcbiAgICAgICAgICBkZXJlZ2lzdGVyV2F0Y2goKTtcblxuICAgICAgICAgIC8vIE5vdyB0aGF0IGFsbCB0ZW1wbGF0ZXMgaGF2ZSBiZWVuIGRvd25sb2FkZWQsICRhbmltYXRlIHdpbGwgd2FpdCB1bnRpbFxuICAgICAgICAgIC8vIHRoZSBwb3N0IGRpZ2VzdCBxdWV1ZSBpcyBlbXB0eSBiZWZvcmUgZW5hYmxpbmcgYW5pbWF0aW9ucy4gQnkgaGF2aW5nIHR3b1xuICAgICAgICAgIC8vIGNhbGxzIHRvICRwb3N0RGlnZXN0IGNhbGxzIHdlIGNhbiBlbnN1cmUgdGhhdCB0aGUgZmxhZyBpcyBlbmFibGVkIGF0IHRoZVxuICAgICAgICAgIC8vIHZlcnkgZW5kIG9mIHRoZSBwb3N0IGRpZ2VzdCBxdWV1ZS4gU2luY2UgYWxsIG9mIHRoZSBhbmltYXRpb25zIGluICRhbmltYXRlXG4gICAgICAgICAgLy8gdXNlICRwb3N0RGlnZXN0LCBpdCdzIGltcG9ydGFudCB0aGF0IHRoZSBjb2RlIGJlbG93IGV4ZWN1dGVzIGF0IHRoZSBlbmQuXG4gICAgICAgICAgLy8gVGhpcyBiYXNpY2FsbHkgbWVhbnMgdGhhdCB0aGUgcGFnZSBpcyBmdWxseSBkb3dubG9hZGVkIGFuZCBjb21waWxlZCBiZWZvcmVcbiAgICAgICAgICAvLyBhbnkgYW5pbWF0aW9ucyBhcmUgdHJpZ2dlcmVkLlxuICAgICAgICAgICRyb290U2NvcGUuJCRwb3N0RGlnZXN0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJHJvb3RTY29wZS4kJHBvc3REaWdlc3QoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHJvb3RBbmltYXRlU3RhdGUucnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICk7XG5cbiAgICAgIHZhciBnbG9iYWxBbmltYXRpb25Db3VudGVyID0gMDtcbiAgICAgIHZhciBjbGFzc05hbWVGaWx0ZXIgPSAkYW5pbWF0ZVByb3ZpZGVyLmNsYXNzTmFtZUZpbHRlcigpO1xuICAgICAgdmFyIGlzQW5pbWF0YWJsZUNsYXNzTmFtZSA9ICFjbGFzc05hbWVGaWx0ZXJcbiAgICAgICAgICAgICAgPyBmdW5jdGlvbigpIHsgcmV0dXJuIHRydWU7IH1cbiAgICAgICAgICAgICAgOiBmdW5jdGlvbihjbGFzc05hbWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2xhc3NOYW1lRmlsdGVyLnRlc3QoY2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgfTtcblxuICAgICAgZnVuY3Rpb24gY2xhc3NCYXNlZEFuaW1hdGlvbnNCbG9ja2VkKGVsZW1lbnQsIHNldHRlcikge1xuICAgICAgICB2YXIgZGF0YSA9IGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFKSB8fCB7fTtcbiAgICAgICAgaWYgKHNldHRlcikge1xuICAgICAgICAgIGRhdGEucnVubmluZyA9IHRydWU7XG4gICAgICAgICAgZGF0YS5zdHJ1Y3R1cmFsID0gdHJ1ZTtcbiAgICAgICAgICBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSwgZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRhdGEuZGlzYWJsZWQgfHwgKGRhdGEucnVubmluZyAmJiBkYXRhLnN0cnVjdHVyYWwpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBydW5BbmltYXRpb25Qb3N0RGlnZXN0KGZuKSB7XG4gICAgICAgIHZhciBjYW5jZWxGbiwgZGVmZXIgPSAkJHEuZGVmZXIoKTtcbiAgICAgICAgZGVmZXIucHJvbWlzZS4kJGNhbmNlbEZuID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgY2FuY2VsRm4gJiYgY2FuY2VsRm4oKTtcbiAgICAgICAgfTtcbiAgICAgICAgJHJvb3RTY29wZS4kJHBvc3REaWdlc3QoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgY2FuY2VsRm4gPSBmbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBwYXJzZUFuaW1hdGVPcHRpb25zKG9wdGlvbnMpIHtcbiAgICAgICAgLy8gc29tZSBwbHVnaW4gY29kZSBtYXkgc3RpbGwgYmUgcGFzc2luZyBpbiB0aGUgY2FsbGJhY2tcbiAgICAgICAgLy8gZnVuY3Rpb24gYXMgdGhlIGxhc3QgcGFyYW0gZm9yIHRoZSAkYW5pbWF0ZSBtZXRob2RzIHNvXG4gICAgICAgIC8vIGl0J3MgYmVzdCB0byBvbmx5IGFsbG93IHN0cmluZyBvciBhcnJheSB2YWx1ZXMgZm9yIG5vd1xuICAgICAgICBpZiAoaXNPYmplY3Qob3B0aW9ucykpIHtcbiAgICAgICAgICBpZiAob3B0aW9ucy50ZW1wQ2xhc3NlcyAmJiBpc1N0cmluZyhvcHRpb25zLnRlbXBDbGFzc2VzKSkge1xuICAgICAgICAgICAgb3B0aW9ucy50ZW1wQ2xhc3NlcyA9IG9wdGlvbnMudGVtcENsYXNzZXMuc3BsaXQoL1xccysvKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG9wdGlvbnM7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gcmVzb2x2ZUVsZW1lbnRDbGFzc2VzKGVsZW1lbnQsIGNhY2hlLCBydW5uaW5nQW5pbWF0aW9ucykge1xuICAgICAgICBydW5uaW5nQW5pbWF0aW9ucyA9IHJ1bm5pbmdBbmltYXRpb25zIHx8IHt9O1xuXG4gICAgICAgIHZhciBsb29rdXAgPSB7fTtcbiAgICAgICAgZm9yRWFjaChydW5uaW5nQW5pbWF0aW9ucywgZnVuY3Rpb24oZGF0YSwgc2VsZWN0b3IpIHtcbiAgICAgICAgICBmb3JFYWNoKHNlbGVjdG9yLnNwbGl0KCcgJyksIGZ1bmN0aW9uKHMpIHtcbiAgICAgICAgICAgIGxvb2t1cFtzXT1kYXRhO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICB2YXIgaGFzQ2xhc3NlcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgIGZvckVhY2goKGVsZW1lbnQuYXR0cignY2xhc3MnKSB8fCAnJykuc3BsaXQoL1xccysvKSwgZnVuY3Rpb24oY2xhc3NOYW1lKSB7XG4gICAgICAgICAgaGFzQ2xhc3Nlc1tjbGFzc05hbWVdID0gdHJ1ZTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdmFyIHRvQWRkID0gW10sIHRvUmVtb3ZlID0gW107XG4gICAgICAgIGZvckVhY2goKGNhY2hlICYmIGNhY2hlLmNsYXNzZXMpIHx8IFtdLCBmdW5jdGlvbihzdGF0dXMsIGNsYXNzTmFtZSkge1xuICAgICAgICAgIHZhciBoYXNDbGFzcyA9IGhhc0NsYXNzZXNbY2xhc3NOYW1lXTtcbiAgICAgICAgICB2YXIgbWF0Y2hpbmdBbmltYXRpb24gPSBsb29rdXBbY2xhc3NOYW1lXSB8fCB7fTtcblxuICAgICAgICAgIC8vIFdoZW4gYWRkQ2xhc3MgYW5kIHJlbW92ZUNsYXNzIGlzIGNhbGxlZCB0aGVuICRhbmltYXRlIHdpbGwgY2hlY2sgdG9cbiAgICAgICAgICAvLyBzZWUgaWYgYWRkQ2xhc3MgYW5kIHJlbW92ZUNsYXNzIGNhbmNlbCBlYWNoIG90aGVyIG91dC4gV2hlbiB0aGVyZSBhcmVcbiAgICAgICAgICAvLyBtb3JlIGNhbGxzIHRvIHJlbW92ZUNsYXNzIHRoYW4gYWRkQ2xhc3MgdGhlbiB0aGUgY291bnQgZmFsbHMgYmVsb3cgMFxuICAgICAgICAgIC8vIGFuZCB0aGVuIHRoZSByZW1vdmVDbGFzcyBhbmltYXRpb24gd2lsbCBiZSBhbGxvd2VkLiBPdGhlcndpc2UgaWYgdGhlXG4gICAgICAgICAgLy8gY291bnQgaXMgYWJvdmUgMCB0aGVuIHRoYXQgbWVhbnMgYW4gYWRkQ2xhc3MgYW5pbWF0aW9uIHdpbGwgY29tbWVuY2UuXG4gICAgICAgICAgLy8gT25jZSBhbiBhbmltYXRpb24gaXMgYWxsb3dlZCB0aGVuIHRoZSBjb2RlIHdpbGwgYWxzbyBjaGVjayB0byBzZWUgaWZcbiAgICAgICAgICAvLyB0aGVyZSBleGlzdHMgYW55IG9uLWdvaW5nIGFuaW1hdGlvbiB0aGF0IGlzIGFscmVhZHkgYWRkaW5nIG9yIHJlbXZvaW5nXG4gICAgICAgICAgLy8gdGhlIG1hdGNoaW5nIENTUyBjbGFzcy5cbiAgICAgICAgICBpZiAoc3RhdHVzID09PSBmYWxzZSkge1xuICAgICAgICAgICAgLy9kb2VzIGl0IGhhdmUgdGhlIGNsYXNzIG9yIHdpbGwgaXQgaGF2ZSB0aGUgY2xhc3NcbiAgICAgICAgICAgIGlmIChoYXNDbGFzcyB8fCBtYXRjaGluZ0FuaW1hdGlvbi5ldmVudCA9PSAnYWRkQ2xhc3MnKSB7XG4gICAgICAgICAgICAgIHRvUmVtb3ZlLnB1c2goY2xhc3NOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2UgaWYgKHN0YXR1cyA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgLy9pcyB0aGUgY2xhc3MgbWlzc2luZyBvciB3aWxsIGl0IGJlIHJlbW92ZWQ/XG4gICAgICAgICAgICBpZiAoIWhhc0NsYXNzIHx8IG1hdGNoaW5nQW5pbWF0aW9uLmV2ZW50ID09ICdyZW1vdmVDbGFzcycpIHtcbiAgICAgICAgICAgICAgdG9BZGQucHVzaChjbGFzc05hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuICh0b0FkZC5sZW5ndGggKyB0b1JlbW92ZS5sZW5ndGgpID4gMCAmJiBbdG9BZGQuam9pbignICcpLCB0b1JlbW92ZS5qb2luKCcgJyldO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBsb29rdXAobmFtZSkge1xuICAgICAgICBpZiAobmFtZSkge1xuICAgICAgICAgIHZhciBtYXRjaGVzID0gW10sXG4gICAgICAgICAgICAgIGZsYWdNYXAgPSB7fSxcbiAgICAgICAgICAgICAgY2xhc3NlcyA9IG5hbWUuc3Vic3RyKDEpLnNwbGl0KCcuJyk7XG5cbiAgICAgICAgICAvL3RoZSBlbXB0eSBzdHJpbmcgdmFsdWUgaXMgdGhlIGRlZmF1bHQgYW5pbWF0aW9uXG4gICAgICAgICAgLy9vcGVyYXRpb24gd2hpY2ggcGVyZm9ybXMgQ1NTIHRyYW5zaXRpb24gYW5kIGtleWZyYW1lXG4gICAgICAgICAgLy9hbmltYXRpb25zIHNuaWZmaW5nLiBUaGlzIGlzIGFsd2F5cyBpbmNsdWRlZCBmb3IgZWFjaFxuICAgICAgICAgIC8vZWxlbWVudCBhbmltYXRpb24gcHJvY2VkdXJlIGlmIHRoZSBicm93c2VyIHN1cHBvcnRzXG4gICAgICAgICAgLy90cmFuc2l0aW9ucyBhbmQvb3Iga2V5ZnJhbWUgYW5pbWF0aW9ucy4gVGhlIGRlZmF1bHRcbiAgICAgICAgICAvL2FuaW1hdGlvbiBpcyBhZGRlZCB0byB0aGUgdG9wIG9mIHRoZSBsaXN0IHRvIHByZXZlbnRcbiAgICAgICAgICAvL2FueSBwcmV2aW91cyBhbmltYXRpb25zIGZyb20gYWZmZWN0aW5nIHRoZSBlbGVtZW50IHN0eWxpbmdcbiAgICAgICAgICAvL3ByaW9yIHRvIHRoZSBlbGVtZW50IGJlaW5nIGFuaW1hdGVkLlxuICAgICAgICAgIGlmICgkc25pZmZlci50cmFuc2l0aW9ucyB8fCAkc25pZmZlci5hbmltYXRpb25zKSB7XG4gICAgICAgICAgICBtYXRjaGVzLnB1c2goJGluamVjdG9yLmdldChzZWxlY3RvcnNbJyddKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZm9yICh2YXIgaT0wOyBpIDwgY2xhc3Nlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGtsYXNzID0gY2xhc3Nlc1tpXSxcbiAgICAgICAgICAgICAgICBzZWxlY3RvckZhY3RvcnlOYW1lID0gc2VsZWN0b3JzW2tsYXNzXTtcbiAgICAgICAgICAgIGlmIChzZWxlY3RvckZhY3RvcnlOYW1lICYmICFmbGFnTWFwW2tsYXNzXSkge1xuICAgICAgICAgICAgICBtYXRjaGVzLnB1c2goJGluamVjdG9yLmdldChzZWxlY3RvckZhY3RvcnlOYW1lKSk7XG4gICAgICAgICAgICAgIGZsYWdNYXBba2xhc3NdID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG1hdGNoZXM7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gYW5pbWF0aW9uUnVubmVyKGVsZW1lbnQsIGFuaW1hdGlvbkV2ZW50LCBjbGFzc05hbWUsIG9wdGlvbnMpIHtcbiAgICAgICAgLy90cmFuc2NsdWRlZCBkaXJlY3RpdmVzIG1heSBzb21ldGltZXMgZmlyZSBhbiBhbmltYXRpb24gdXNpbmcgb25seSBjb21tZW50IG5vZGVzXG4gICAgICAgIC8vYmVzdCB0byBjYXRjaCB0aGlzIGVhcmx5IG9uIHRvIHByZXZlbnQgYW55IGFuaW1hdGlvbiBvcGVyYXRpb25zIGZyb20gb2NjdXJyaW5nXG4gICAgICAgIHZhciBub2RlID0gZWxlbWVudFswXTtcbiAgICAgICAgaWYgKCFub2RlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG9wdGlvbnMpIHtcbiAgICAgICAgICBvcHRpb25zLnRvID0gb3B0aW9ucy50byB8fCB7fTtcbiAgICAgICAgICBvcHRpb25zLmZyb20gPSBvcHRpb25zLmZyb20gfHwge307XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgY2xhc3NOYW1lQWRkO1xuICAgICAgICB2YXIgY2xhc3NOYW1lUmVtb3ZlO1xuICAgICAgICBpZiAoaXNBcnJheShjbGFzc05hbWUpKSB7XG4gICAgICAgICAgY2xhc3NOYW1lQWRkID0gY2xhc3NOYW1lWzBdO1xuICAgICAgICAgIGNsYXNzTmFtZVJlbW92ZSA9IGNsYXNzTmFtZVsxXTtcbiAgICAgICAgICBpZiAoIWNsYXNzTmFtZUFkZCkge1xuICAgICAgICAgICAgY2xhc3NOYW1lID0gY2xhc3NOYW1lUmVtb3ZlO1xuICAgICAgICAgICAgYW5pbWF0aW9uRXZlbnQgPSAncmVtb3ZlQ2xhc3MnO1xuICAgICAgICAgIH0gZWxzZSBpZiAoIWNsYXNzTmFtZVJlbW92ZSkge1xuICAgICAgICAgICAgY2xhc3NOYW1lID0gY2xhc3NOYW1lQWRkO1xuICAgICAgICAgICAgYW5pbWF0aW9uRXZlbnQgPSAnYWRkQ2xhc3MnO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjbGFzc05hbWUgPSBjbGFzc05hbWVBZGQgKyAnICcgKyBjbGFzc05hbWVSZW1vdmU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGlzU2V0Q2xhc3NPcGVyYXRpb24gPSBhbmltYXRpb25FdmVudCA9PSAnc2V0Q2xhc3MnO1xuICAgICAgICB2YXIgaXNDbGFzc0Jhc2VkID0gaXNTZXRDbGFzc09wZXJhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgYW5pbWF0aW9uRXZlbnQgPT0gJ2FkZENsYXNzJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgYW5pbWF0aW9uRXZlbnQgPT0gJ3JlbW92ZUNsYXNzJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgYW5pbWF0aW9uRXZlbnQgPT0gJ2FuaW1hdGUnO1xuXG4gICAgICAgIHZhciBjdXJyZW50Q2xhc3NOYW1lID0gZWxlbWVudC5hdHRyKCdjbGFzcycpO1xuICAgICAgICB2YXIgY2xhc3NlcyA9IGN1cnJlbnRDbGFzc05hbWUgKyAnICcgKyBjbGFzc05hbWU7XG4gICAgICAgIGlmICghaXNBbmltYXRhYmxlQ2xhc3NOYW1lKGNsYXNzZXMpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGJlZm9yZUNvbXBsZXRlID0gbm9vcCxcbiAgICAgICAgICAgIGJlZm9yZUNhbmNlbCA9IFtdLFxuICAgICAgICAgICAgYmVmb3JlID0gW10sXG4gICAgICAgICAgICBhZnRlckNvbXBsZXRlID0gbm9vcCxcbiAgICAgICAgICAgIGFmdGVyQ2FuY2VsID0gW10sXG4gICAgICAgICAgICBhZnRlciA9IFtdO1xuXG4gICAgICAgIHZhciBhbmltYXRpb25Mb29rdXAgPSAoJyAnICsgY2xhc3NlcykucmVwbGFjZSgvXFxzKy9nLCcuJyk7XG4gICAgICAgIGZvckVhY2gobG9va3VwKGFuaW1hdGlvbkxvb2t1cCksIGZ1bmN0aW9uKGFuaW1hdGlvbkZhY3RvcnkpIHtcbiAgICAgICAgICB2YXIgY3JlYXRlZCA9IHJlZ2lzdGVyQW5pbWF0aW9uKGFuaW1hdGlvbkZhY3RvcnksIGFuaW1hdGlvbkV2ZW50KTtcbiAgICAgICAgICBpZiAoIWNyZWF0ZWQgJiYgaXNTZXRDbGFzc09wZXJhdGlvbikge1xuICAgICAgICAgICAgcmVnaXN0ZXJBbmltYXRpb24oYW5pbWF0aW9uRmFjdG9yeSwgJ2FkZENsYXNzJyk7XG4gICAgICAgICAgICByZWdpc3RlckFuaW1hdGlvbihhbmltYXRpb25GYWN0b3J5LCAncmVtb3ZlQ2xhc3MnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIHJlZ2lzdGVyQW5pbWF0aW9uKGFuaW1hdGlvbkZhY3RvcnksIGV2ZW50KSB7XG4gICAgICAgICAgdmFyIGFmdGVyRm4gPSBhbmltYXRpb25GYWN0b3J5W2V2ZW50XTtcbiAgICAgICAgICB2YXIgYmVmb3JlRm4gPSBhbmltYXRpb25GYWN0b3J5WydiZWZvcmUnICsgZXZlbnQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBldmVudC5zdWJzdHIoMSldO1xuICAgICAgICAgIGlmIChhZnRlckZuIHx8IGJlZm9yZUZuKSB7XG4gICAgICAgICAgICBpZiAoZXZlbnQgPT0gJ2xlYXZlJykge1xuICAgICAgICAgICAgICBiZWZvcmVGbiA9IGFmdGVyRm47XG4gICAgICAgICAgICAgIC8vd2hlbiBzZXQgYXMgbnVsbCB0aGVuIGFuaW1hdGlvbiBrbm93cyB0byBza2lwIHRoaXMgcGhhc2VcbiAgICAgICAgICAgICAgYWZ0ZXJGbiA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhZnRlci5wdXNoKHtcbiAgICAgICAgICAgICAgZXZlbnQ6IGV2ZW50LCBmbjogYWZ0ZXJGblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBiZWZvcmUucHVzaCh7XG4gICAgICAgICAgICAgIGV2ZW50OiBldmVudCwgZm46IGJlZm9yZUZuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJ1bihmbnMsIGNhbmNlbGxhdGlvbnMsIGFsbENvbXBsZXRlRm4pIHtcbiAgICAgICAgICB2YXIgYW5pbWF0aW9ucyA9IFtdO1xuICAgICAgICAgIGZvckVhY2goZm5zLCBmdW5jdGlvbihhbmltYXRpb24pIHtcbiAgICAgICAgICAgIGFuaW1hdGlvbi5mbiAmJiBhbmltYXRpb25zLnB1c2goYW5pbWF0aW9uKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBjb3VudCA9IDA7XG4gICAgICAgICAgZnVuY3Rpb24gYWZ0ZXJBbmltYXRpb25Db21wbGV0ZShpbmRleCkge1xuICAgICAgICAgICAgaWYgKGNhbmNlbGxhdGlvbnMpIHtcbiAgICAgICAgICAgICAgKGNhbmNlbGxhdGlvbnNbaW5kZXhdIHx8IG5vb3ApKCk7XG4gICAgICAgICAgICAgIGlmICgrK2NvdW50IDwgYW5pbWF0aW9ucy5sZW5ndGgpIHJldHVybjtcbiAgICAgICAgICAgICAgY2FuY2VsbGF0aW9ucyA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhbGxDb21wbGV0ZUZuKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy9UaGUgY29kZSBiZWxvdyBhZGRzIGRpcmVjdGx5IHRvIHRoZSBhcnJheSBpbiBvcmRlciB0byB3b3JrIHdpdGhcbiAgICAgICAgICAvL2JvdGggc3luYyBhbmQgYXN5bmMgYW5pbWF0aW9ucy4gU3luYyBhbmltYXRpb25zIGFyZSB3aGVuIHRoZSBkb25lKClcbiAgICAgICAgICAvL29wZXJhdGlvbiBpcyBjYWxsZWQgcmlnaHQgYXdheS4gRE8gTk9UIFJFRkFDVE9SIVxuICAgICAgICAgIGZvckVhY2goYW5pbWF0aW9ucywgZnVuY3Rpb24oYW5pbWF0aW9uLCBpbmRleCkge1xuICAgICAgICAgICAgdmFyIHByb2dyZXNzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGFmdGVyQW5pbWF0aW9uQ29tcGxldGUoaW5kZXgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHN3aXRjaCAoYW5pbWF0aW9uLmV2ZW50KSB7XG4gICAgICAgICAgICAgIGNhc2UgJ3NldENsYXNzJzpcbiAgICAgICAgICAgICAgICBjYW5jZWxsYXRpb25zLnB1c2goYW5pbWF0aW9uLmZuKGVsZW1lbnQsIGNsYXNzTmFtZUFkZCwgY2xhc3NOYW1lUmVtb3ZlLCBwcm9ncmVzcywgb3B0aW9ucykpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICBjYXNlICdhbmltYXRlJzpcbiAgICAgICAgICAgICAgICBjYW5jZWxsYXRpb25zLnB1c2goYW5pbWF0aW9uLmZuKGVsZW1lbnQsIGNsYXNzTmFtZSwgb3B0aW9ucy5mcm9tLCBvcHRpb25zLnRvLCBwcm9ncmVzcykpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICBjYXNlICdhZGRDbGFzcyc6XG4gICAgICAgICAgICAgICAgY2FuY2VsbGF0aW9ucy5wdXNoKGFuaW1hdGlvbi5mbihlbGVtZW50LCBjbGFzc05hbWVBZGQgfHwgY2xhc3NOYW1lLCAgICAgcHJvZ3Jlc3MsIG9wdGlvbnMpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgY2FzZSAncmVtb3ZlQ2xhc3MnOlxuICAgICAgICAgICAgICAgIGNhbmNlbGxhdGlvbnMucHVzaChhbmltYXRpb24uZm4oZWxlbWVudCwgY2xhc3NOYW1lUmVtb3ZlIHx8IGNsYXNzTmFtZSwgIHByb2dyZXNzLCBvcHRpb25zKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgY2FuY2VsbGF0aW9ucy5wdXNoKGFuaW1hdGlvbi5mbihlbGVtZW50LCBwcm9ncmVzcywgb3B0aW9ucykpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgaWYgKGNhbmNlbGxhdGlvbnMgJiYgY2FuY2VsbGF0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGFsbENvbXBsZXRlRm4oKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIG5vZGU6IG5vZGUsXG4gICAgICAgICAgZXZlbnQ6IGFuaW1hdGlvbkV2ZW50LFxuICAgICAgICAgIGNsYXNzTmFtZTogY2xhc3NOYW1lLFxuICAgICAgICAgIGlzQ2xhc3NCYXNlZDogaXNDbGFzc0Jhc2VkLFxuICAgICAgICAgIGlzU2V0Q2xhc3NPcGVyYXRpb246IGlzU2V0Q2xhc3NPcGVyYXRpb24sXG4gICAgICAgICAgYXBwbHlTdHlsZXM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgZWxlbWVudC5jc3MoYW5ndWxhci5leHRlbmQob3B0aW9ucy5mcm9tIHx8IHt9LCBvcHRpb25zLnRvIHx8IHt9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBiZWZvcmU6IGZ1bmN0aW9uKGFsbENvbXBsZXRlRm4pIHtcbiAgICAgICAgICAgIGJlZm9yZUNvbXBsZXRlID0gYWxsQ29tcGxldGVGbjtcbiAgICAgICAgICAgIHJ1bihiZWZvcmUsIGJlZm9yZUNhbmNlbCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGJlZm9yZUNvbXBsZXRlID0gbm9vcDtcbiAgICAgICAgICAgICAgYWxsQ29tcGxldGVGbigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBhZnRlcjogZnVuY3Rpb24oYWxsQ29tcGxldGVGbikge1xuICAgICAgICAgICAgYWZ0ZXJDb21wbGV0ZSA9IGFsbENvbXBsZXRlRm47XG4gICAgICAgICAgICBydW4oYWZ0ZXIsIGFmdGVyQ2FuY2VsLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgYWZ0ZXJDb21wbGV0ZSA9IG5vb3A7XG4gICAgICAgICAgICAgIGFsbENvbXBsZXRlRm4oKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgY2FuY2VsOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmIChiZWZvcmVDYW5jZWwpIHtcbiAgICAgICAgICAgICAgZm9yRWFjaChiZWZvcmVDYW5jZWwsIGZ1bmN0aW9uKGNhbmNlbEZuKSB7XG4gICAgICAgICAgICAgICAgKGNhbmNlbEZuIHx8IG5vb3ApKHRydWUpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgYmVmb3JlQ29tcGxldGUodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYWZ0ZXJDYW5jZWwpIHtcbiAgICAgICAgICAgICAgZm9yRWFjaChhZnRlckNhbmNlbCwgZnVuY3Rpb24oY2FuY2VsRm4pIHtcbiAgICAgICAgICAgICAgICAoY2FuY2VsRm4gfHwgbm9vcCkodHJ1ZSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBhZnRlckNvbXBsZXRlKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiBAbmdkb2Mgc2VydmljZVxuICAgICAgICogQG5hbWUgJGFuaW1hdGVcbiAgICAgICAqIEBraW5kIG9iamVjdFxuICAgICAgICpcbiAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICogVGhlIGAkYW5pbWF0ZWAgc2VydmljZSBwcm92aWRlcyBhbmltYXRpb24gZGV0ZWN0aW9uIHN1cHBvcnQgd2hpbGUgcGVyZm9ybWluZyBET00gb3BlcmF0aW9ucyAoZW50ZXIsIGxlYXZlIGFuZCBtb3ZlKSBhcyB3ZWxsIGFzIGR1cmluZyBhZGRDbGFzcyBhbmQgcmVtb3ZlQ2xhc3Mgb3BlcmF0aW9ucy5cbiAgICAgICAqIFdoZW4gYW55IG9mIHRoZXNlIG9wZXJhdGlvbnMgYXJlIHJ1biwgdGhlICRhbmltYXRlIHNlcnZpY2VcbiAgICAgICAqIHdpbGwgZXhhbWluZSBhbnkgSmF2YVNjcmlwdC1kZWZpbmVkIGFuaW1hdGlvbnMgKHdoaWNoIGFyZSBkZWZpbmVkIGJ5IHVzaW5nIHRoZSAkYW5pbWF0ZVByb3ZpZGVyIHByb3ZpZGVyIG9iamVjdClcbiAgICAgICAqIGFzIHdlbGwgYXMgYW55IENTUy1kZWZpbmVkIGFuaW1hdGlvbnMgYWdhaW5zdCB0aGUgQ1NTIGNsYXNzZXMgcHJlc2VudCBvbiB0aGUgZWxlbWVudCBvbmNlIHRoZSBET00gb3BlcmF0aW9uIGlzIHJ1bi5cbiAgICAgICAqXG4gICAgICAgKiBUaGUgYCRhbmltYXRlYCBzZXJ2aWNlIGlzIHVzZWQgYmVoaW5kIHRoZSBzY2VuZXMgd2l0aCBwcmUtZXhpc3RpbmcgZGlyZWN0aXZlcyBhbmQgYW5pbWF0aW9uIHdpdGggdGhlc2UgZGlyZWN0aXZlc1xuICAgICAgICogd2lsbCB3b3JrIG91dCBvZiB0aGUgYm94IHdpdGhvdXQgYW55IGV4dHJhIGNvbmZpZ3VyYXRpb24uXG4gICAgICAgKlxuICAgICAgICogUmVxdWlyZXMgdGhlIHtAbGluayBuZ0FuaW1hdGUgYG5nQW5pbWF0ZWB9IG1vZHVsZSB0byBiZSBpbnN0YWxsZWQuXG4gICAgICAgKlxuICAgICAgICogUGxlYXNlIHZpc2l0IHRoZSB7QGxpbmsgbmdBbmltYXRlIGBuZ0FuaW1hdGVgfSBtb2R1bGUgb3ZlcnZpZXcgcGFnZSBsZWFybiBtb3JlIGFib3V0IGhvdyB0byB1c2UgYW5pbWF0aW9ucyBpbiB5b3VyIGFwcGxpY2F0aW9uLlxuICAgICAgICogIyMgQ2FsbGJhY2sgUHJvbWlzZXNcbiAgICAgICAqIFdpdGggQW5ndWxhckpTIDEuMywgZWFjaCBvZiB0aGUgYW5pbWF0aW9uIG1ldGhvZHMsIG9uIHRoZSBgJGFuaW1hdGVgIHNlcnZpY2UsIHJldHVybiBhIHByb21pc2Ugd2hlbiBjYWxsZWQuIFRoZVxuICAgICAgICogcHJvbWlzZSBpdHNlbGYgaXMgdGhlbiByZXNvbHZlZCBvbmNlIHRoZSBhbmltYXRpb24gaGFzIGNvbXBsZXRlZCBpdHNlbGYsIGhhcyBiZWVuIGNhbmNlbGxlZCBvciBoYXMgYmVlblxuICAgICAgICogc2tpcHBlZCBkdWUgdG8gYW5pbWF0aW9ucyBiZWluZyBkaXNhYmxlZC4gKE5vdGUgdGhhdCBldmVuIGlmIHRoZSBhbmltYXRpb24gaXMgY2FuY2VsbGVkIGl0IHdpbGwgc3RpbGxcbiAgICAgICAqIGNhbGwgdGhlIHJlc29sdmUgZnVuY3Rpb24gb2YgdGhlIGFuaW1hdGlvbi4pXG4gICAgICAgKlxuICAgICAgICogYGBganNcbiAgICAgICAqICRhbmltYXRlLmVudGVyKGVsZW1lbnQsIGNvbnRhaW5lcikudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAqICAgLy8uLi50aGlzIGlzIGNhbGxlZCBvbmNlIHRoZSBhbmltYXRpb24gaXMgY29tcGxldGUuLi5cbiAgICAgICAqIH0pO1xuICAgICAgICogYGBgXG4gICAgICAgKlxuICAgICAgICogQWxzbyBub3RlIHRoYXQsIGR1ZSB0byB0aGUgbmF0dXJlIG9mIHRoZSBjYWxsYmFjayBwcm9taXNlLCBpZiBhbnkgQW5ndWxhci1zcGVjaWZpYyBjb2RlIChsaWtlIGNoYW5naW5nIHRoZSBzY29wZSxcbiAgICAgICAqIGxvY2F0aW9uIG9mIHRoZSBwYWdlLCBldGMuLi4pIGlzIGV4ZWN1dGVkIHdpdGhpbiB0aGUgY2FsbGJhY2sgcHJvbWlzZSB0aGVuIGJlIHN1cmUgdG8gd3JhcCB0aGUgY29kZSB1c2luZ1xuICAgICAgICogYCRzY29wZS4kYXBwbHkoLi4uKWA7XG4gICAgICAgKlxuICAgICAgICogYGBganNcbiAgICAgICAqICRhbmltYXRlLmxlYXZlKGVsZW1lbnQpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgKiAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG4gICAgICAgKiAgICAgJGxvY2F0aW9uLnBhdGgoJy9uZXctcGFnZScpO1xuICAgICAgICogICB9KTtcbiAgICAgICAqIH0pO1xuICAgICAgICogYGBgXG4gICAgICAgKlxuICAgICAgICogQW4gYW5pbWF0aW9uIGNhbiBhbHNvIGJlIGNhbmNlbGxlZCBieSBjYWxsaW5nIHRoZSBgJGFuaW1hdGUuY2FuY2VsKHByb21pc2UpYCBtZXRob2Qgd2l0aCB0aGUgcHJvdmlkZWRcbiAgICAgICAqIHByb21pc2UgdGhhdCB3YXMgcmV0dXJuZWQgd2hlbiB0aGUgYW5pbWF0aW9uIHdhcyBzdGFydGVkLlxuICAgICAgICpcbiAgICAgICAqIGBgYGpzXG4gICAgICAgKiB2YXIgcHJvbWlzZSA9ICRhbmltYXRlLmFkZENsYXNzKGVsZW1lbnQsICdzdXBlci1sb25nLWFuaW1hdGlvbicpO1xuICAgICAgICogcHJvbWlzZS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICogICAvL3RoaXMgd2lsbCBzdGlsbCBiZSBjYWxsZWQgZXZlbiBpZiBjYW5jZWxsZWRcbiAgICAgICAqIH0pO1xuICAgICAgICpcbiAgICAgICAqIGVsZW1lbnQub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgKiAgIC8vdG9vbyBsYXp5IHRvIHdhaXQgZm9yIHRoZSBhbmltYXRpb24gdG8gZW5kXG4gICAgICAgKiAgICRhbmltYXRlLmNhbmNlbChwcm9taXNlKTtcbiAgICAgICAqIH0pO1xuICAgICAgICogYGBgXG4gICAgICAgKlxuICAgICAgICogKEtlZXAgaW4gbWluZCB0aGF0IHRoZSBwcm9taXNlIGNhbmNlbGxhdGlvbiBpcyB1bmlxdWUgdG8gYCRhbmltYXRlYCBzaW5jZSBwcm9taXNlcyBpblxuICAgICAgICogZ2VuZXJhbCBjYW5ub3QgYmUgY2FuY2VsbGVkLilcbiAgICAgICAqXG4gICAgICAgKi9cbiAgICAgIHJldHVybiB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgICAqIEBuYW1lICRhbmltYXRlI2FuaW1hdGVcbiAgICAgICAgICogQGtpbmQgZnVuY3Rpb25cbiAgICAgICAgICpcbiAgICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgICAqIFBlcmZvcm1zIGFuIGlubGluZSBhbmltYXRpb24gb24gdGhlIGVsZW1lbnQgd2hpY2ggYXBwbGllcyB0aGUgcHJvdmlkZWQgYHRvYCBhbmQgYGZyb21gIENTUyBzdHlsZXMgdG8gdGhlIGVsZW1lbnQuXG4gICAgICAgICAqIElmIGFueSBkZXRlY3RlZCBDU1MgdHJhbnNpdGlvbiwga2V5ZnJhbWUgb3IgSmF2YVNjcmlwdCBtYXRjaGVzIHRoZSBwcm92aWRlZCBgY2xhc3NOYW1lYCB2YWx1ZSB0aGVuIHRoZSBhbmltYXRpb25cbiAgICAgICAgICogd2lsbCB0YWtlIG9uIHRoZSBwcm92aWRlZCBzdHlsZXMuIEZvciBleGFtcGxlLCBpZiBhIHRyYW5zaXRpb24gYW5pbWF0aW9uIGlzIHNldCBmb3IgdGhlIGdpdmVuIGNsYXNzTmFtZSB0aGVuIHRoZVxuICAgICAgICAgKiBwcm92aWRlZCBgZnJvbWAgYW5kIGB0b2Agc3R5bGVzIHdpbGwgYmUgYXBwbGllZCBhbG9uZ3NpZGUgdGhlIGdpdmVuIHRyYW5zaXRpb24uIElmIGEgSmF2YVNjcmlwdCBhbmltYXRpb24gaXNcbiAgICAgICAgICogZGV0ZWN0ZWQgdGhlbiB0aGUgcHJvdmlkZWQgc3R5bGVzIHdpbGwgYmUgZ2l2ZW4gaW4gYXMgZnVuY3Rpb24gcGFyYW10ZXJzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBgYGBqc1xuICAgICAgICAgKiBuZ01vZHVsZS5hbmltYXRpb24oJy5teS1pbmxpbmUtYW5pbWF0aW9uJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAqICAgcmV0dXJuIHtcbiAgICAgICAgICogICAgIGFuaW1hdGUgOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGZyb20sIHRvLCBkb25lKSB7XG4gICAgICAgICAqICAgICAgIC8vc3R5bGVzXG4gICAgICAgICAqICAgICB9XG4gICAgICAgICAqICAgfVxuICAgICAgICAgKiB9KTtcbiAgICAgICAgICogYGBgXG4gICAgICAgICAqXG4gICAgICAgICAqIEJlbG93IGlzIGEgYnJlYWtkb3duIG9mIGVhY2ggc3RlcCB0aGF0IG9jY3VycyBkdXJpbmcgdGhlIGBhbmltYXRlYCBhbmltYXRpb246XG4gICAgICAgICAqXG4gICAgICAgICAqIHwgQW5pbWF0aW9uIFN0ZXAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgV2hhdCB0aGUgZWxlbWVudCBjbGFzcyBhdHRyaWJ1dGUgbG9va3MgbGlrZSAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxuICAgICAgICAgKiB8IDEuIGAkYW5pbWF0ZS5hbmltYXRlKC4uLilgIGlzIGNhbGxlZCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCAyLiBgJGFuaW1hdGVgIHdhaXRzIGZvciB0aGUgbmV4dCBkaWdlc3QgdG8gc3RhcnQgdGhlIGFuaW1hdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZVwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgMy4gYCRhbmltYXRlYCBydW5zIHRoZSBKYXZhU2NyaXB0LWRlZmluZWQgYW5pbWF0aW9ucyBkZXRlY3RlZCBvbiB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGVcImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDQuIHRoZSBgY2xhc3NOYW1lYCBjbGFzcyB2YWx1ZSBpcyBhZGRlZCB0byB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIGNsYXNzTmFtZVwiYCAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCA1LiBgJGFuaW1hdGVgIHNjYW5zIHRoZSBlbGVtZW50IHN0eWxlcyB0byBnZXQgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbiBkdXJhdGlvbiBhbmQgZGVsYXkgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBjbGFzc05hbWVcImAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgNi4gYCRhbmltYXRlYCBibG9ja3MgYWxsIENTUyB0cmFuc2l0aW9ucyBvbiB0aGUgZWxlbWVudCB0byBlbnN1cmUgdGhlIGAuY2xhc3NOYW1lYCBjbGFzcyBzdHlsaW5nIGlzIGFwcGxpZWQgcmlnaHQgYXdheXwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgY2xhc3NOYW1lXCJgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDcuIGAkYW5pbWF0ZWAgYXBwbGllcyB0aGUgcHJvdmlkZWQgY29sbGVjdGlvbiBvZiBgZnJvbWAgQ1NTIHN0eWxlcyB0byB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIGNsYXNzTmFtZVwiYCAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCA4LiBgJGFuaW1hdGVgIHdhaXRzIGZvciBhIHNpbmdsZSBhbmltYXRpb24gZnJhbWUgKHRoaXMgcGVyZm9ybXMgYSByZWZsb3cpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBjbGFzc05hbWVcImAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgOS4gYCRhbmltYXRlYCByZW1vdmVzIHRoZSBDU1MgdHJhbnNpdGlvbiBibG9jayBwbGFjZWQgb24gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgY2xhc3NOYW1lXCJgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDEwLiB0aGUgYGNsYXNzTmFtZS1hY3RpdmVgIGNsYXNzIGlzIGFkZGVkICh0aGlzIHRyaWdnZXJzIHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIGNsYXNzTmFtZSBjbGFzc05hbWUtYWN0aXZlXCJgIHxcbiAgICAgICAgICogfCAxMS4gYCRhbmltYXRlYCBhcHBsaWVzIHRoZSBjb2xsZWN0aW9uIG9mIGB0b2AgQ1NTIHN0eWxlcyB0byB0aGUgZWxlbWVudCB3aGljaCBhcmUgdGhlbiBoYW5kbGVkIGJ5IHRoZSB0cmFuc2l0aW9uICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBjbGFzc05hbWUgY2xhc3NOYW1lLWFjdGl2ZVwiYCB8XG4gICAgICAgICAqIHwgMTIuIGAkYW5pbWF0ZWAgd2FpdHMgZm9yIHRoZSBhbmltYXRpb24gdG8gY29tcGxldGUgKHZpYSBldmVudHMgYW5kIHRpbWVvdXQpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgY2xhc3NOYW1lIGNsYXNzTmFtZS1hY3RpdmVcImAgfFxuICAgICAgICAgKiB8IDEzLiBUaGUgYW5pbWF0aW9uIGVuZHMgYW5kIGFsbCBnZW5lcmF0ZWQgQ1NTIGNsYXNzZXMgYXJlIHJlbW92ZWQgZnJvbSB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCAxNC4gVGhlIHJldHVybmVkIHByb21pc2UgaXMgcmVzb2x2ZWQuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb25cImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gZWxlbWVudCB0aGUgZWxlbWVudCB0aGF0IHdpbGwgYmUgdGhlIGZvY3VzIG9mIHRoZSBlbnRlciBhbmltYXRpb25cbiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IGZyb20gYSBjb2xsZWN0aW9uIG9mIENTUyBzdHlsZXMgdGhhdCB3aWxsIGJlIGFwcGxpZWQgdG8gdGhlIGVsZW1lbnQgYXQgdGhlIHN0YXJ0IG9mIHRoZSBhbmltYXRpb25cbiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHRvIGEgY29sbGVjdGlvbiBvZiBDU1Mgc3R5bGVzIHRoYXQgdGhlIGVsZW1lbnQgd2lsbCBhbmltYXRlIHRvd2FyZHNcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmc9fSBjbGFzc05hbWUgYW4gb3B0aW9uYWwgQ1NTIGNsYXNzIHRoYXQgd2lsbCBiZSBhZGRlZCB0byB0aGUgZWxlbWVudCBmb3IgdGhlIGR1cmF0aW9uIG9mIHRoZSBhbmltYXRpb24gKHRoZSBkZWZhdWx0IGNsYXNzIGlzIGBuZy1pbmxpbmUtYW5pbWF0ZWApXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyBhbiBvcHRpb25hbCBjb2xsZWN0aW9uIG9mIG9wdGlvbnMgdGhhdCB3aWxsIGJlIHBpY2tlZCB1cCBieSB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uXG4gICAgICAgICAqIEByZXR1cm4ge1Byb21pc2V9IHRoZSBhbmltYXRpb24gY2FsbGJhY2sgcHJvbWlzZVxuICAgICAgICAqL1xuICAgICAgICBhbmltYXRlOiBmdW5jdGlvbihlbGVtZW50LCBmcm9tLCB0bywgY2xhc3NOYW1lLCBvcHRpb25zKSB7XG4gICAgICAgICAgY2xhc3NOYW1lID0gY2xhc3NOYW1lIHx8ICduZy1pbmxpbmUtYW5pbWF0ZSc7XG4gICAgICAgICAgb3B0aW9ucyA9IHBhcnNlQW5pbWF0ZU9wdGlvbnMob3B0aW9ucykgfHwge307XG4gICAgICAgICAgb3B0aW9ucy5mcm9tID0gdG8gPyBmcm9tIDogbnVsbDtcbiAgICAgICAgICBvcHRpb25zLnRvICAgPSB0byA/IHRvIDogZnJvbTtcblxuICAgICAgICAgIHJldHVybiBydW5BbmltYXRpb25Qb3N0RGlnZXN0KGZ1bmN0aW9uKGRvbmUpIHtcbiAgICAgICAgICAgIHJldHVybiBwZXJmb3JtQW5pbWF0aW9uKCdhbmltYXRlJywgY2xhc3NOYW1lLCBzdHJpcENvbW1lbnRzRnJvbUVsZW1lbnQoZWxlbWVudCksIG51bGwsIG51bGwsIG5vb3AsIG9wdGlvbnMsIGRvbmUpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgICAqIEBuYW1lICRhbmltYXRlI2VudGVyXG4gICAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICAgKiBBcHBlbmRzIHRoZSBlbGVtZW50IHRvIHRoZSBwYXJlbnRFbGVtZW50IGVsZW1lbnQgdGhhdCByZXNpZGVzIGluIHRoZSBkb2N1bWVudCBhbmQgdGhlbiBydW5zIHRoZSBlbnRlciBhbmltYXRpb24uIE9uY2VcbiAgICAgICAgICogdGhlIGFuaW1hdGlvbiBpcyBzdGFydGVkLCB0aGUgZm9sbG93aW5nIENTUyBjbGFzc2VzIHdpbGwgYmUgcHJlc2VudCBvbiB0aGUgZWxlbWVudCBmb3IgdGhlIGR1cmF0aW9uIG9mIHRoZSBhbmltYXRpb246XG4gICAgICAgICAqXG4gICAgICAgICAqIEJlbG93IGlzIGEgYnJlYWtkb3duIG9mIGVhY2ggc3RlcCB0aGF0IG9jY3VycyBkdXJpbmcgZW50ZXIgYW5pbWF0aW9uOlxuICAgICAgICAgKlxuICAgICAgICAgKiB8IEFuaW1hdGlvbiBTdGVwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IFdoYXQgdGhlIGVsZW1lbnQgY2xhc3MgYXR0cmlidXRlIGxvb2tzIGxpa2UgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxuICAgICAgICAgKiB8IDEuIGAkYW5pbWF0ZS5lbnRlciguLi4pYCBpcyBjYWxsZWQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgMi4gZWxlbWVudCBpcyBpbnNlcnRlZCBpbnRvIHRoZSBgcGFyZW50RWxlbWVudGAgZWxlbWVudCBvciBiZXNpZGUgdGhlIGBhZnRlckVsZW1lbnRgIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCAzLiBgJGFuaW1hdGVgIHdhaXRzIGZvciB0aGUgbmV4dCBkaWdlc3QgdG8gc3RhcnQgdGhlIGFuaW1hdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZVwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDQuIGAkYW5pbWF0ZWAgcnVucyB0aGUgSmF2YVNjcmlwdC1kZWZpbmVkIGFuaW1hdGlvbnMgZGV0ZWN0ZWQgb24gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlXCJgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgNS4gdGhlIGAubmctZW50ZXJgIGNsYXNzIGlzIGFkZGVkIHRvIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctZW50ZXJcImAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCA2LiBgJGFuaW1hdGVgIHNjYW5zIHRoZSBlbGVtZW50IHN0eWxlcyB0byBnZXQgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbiBkdXJhdGlvbiBhbmQgZGVsYXkgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1lbnRlclwiYCAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDcuIGAkYW5pbWF0ZWAgYmxvY2tzIGFsbCBDU1MgdHJhbnNpdGlvbnMgb24gdGhlIGVsZW1lbnQgdG8gZW5zdXJlIHRoZSBgLm5nLWVudGVyYCBjbGFzcyBzdHlsaW5nIGlzIGFwcGxpZWQgcmlnaHQgYXdheSB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWVudGVyXCJgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgOC4gYCRhbmltYXRlYCB3YWl0cyBmb3IgYSBzaW5nbGUgYW5pbWF0aW9uIGZyYW1lICh0aGlzIHBlcmZvcm1zIGEgcmVmbG93KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctZW50ZXJcImAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCA5LiBgJGFuaW1hdGVgIHJlbW92ZXMgdGhlIENTUyB0cmFuc2l0aW9uIGJsb2NrIHBsYWNlZCBvbiB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1lbnRlclwiYCAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDEwLiB0aGUgYC5uZy1lbnRlci1hY3RpdmVgIGNsYXNzIGlzIGFkZGVkICh0aGlzIHRyaWdnZXJzIHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWVudGVyIG5nLWVudGVyLWFjdGl2ZVwiYCB8XG4gICAgICAgICAqIHwgMTEuIGAkYW5pbWF0ZWAgd2FpdHMgZm9yIHRoZSBhbmltYXRpb24gdG8gY29tcGxldGUgKHZpYSBldmVudHMgYW5kIHRpbWVvdXQpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctZW50ZXIgbmctZW50ZXItYWN0aXZlXCJgIHxcbiAgICAgICAgICogfCAxMi4gVGhlIGFuaW1hdGlvbiBlbmRzIGFuZCBhbGwgZ2VuZXJhdGVkIENTUyBjbGFzc2VzIGFyZSByZW1vdmVkIGZyb20gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb25cImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDEzLiBUaGUgcmV0dXJuZWQgcHJvbWlzZSBpcyByZXNvbHZlZC4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gZWxlbWVudCB0aGUgZWxlbWVudCB0aGF0IHdpbGwgYmUgdGhlIGZvY3VzIG9mIHRoZSBlbnRlciBhbmltYXRpb25cbiAgICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBwYXJlbnRFbGVtZW50IHRoZSBwYXJlbnQgZWxlbWVudCBvZiB0aGUgZWxlbWVudCB0aGF0IHdpbGwgYmUgdGhlIGZvY3VzIG9mIHRoZSBlbnRlciBhbmltYXRpb25cbiAgICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBhZnRlckVsZW1lbnQgdGhlIHNpYmxpbmcgZWxlbWVudCAod2hpY2ggaXMgdGhlIHByZXZpb3VzIGVsZW1lbnQpIG9mIHRoZSBlbGVtZW50IHRoYXQgd2lsbCBiZSB0aGUgZm9jdXMgb2YgdGhlIGVudGVyIGFuaW1hdGlvblxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdD19IG9wdGlvbnMgYW4gb3B0aW9uYWwgY29sbGVjdGlvbiBvZiBvcHRpb25zIHRoYXQgd2lsbCBiZSBwaWNrZWQgdXAgYnkgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvblxuICAgICAgICAgKiBAcmV0dXJuIHtQcm9taXNlfSB0aGUgYW5pbWF0aW9uIGNhbGxiYWNrIHByb21pc2VcbiAgICAgICAgKi9cbiAgICAgICAgZW50ZXI6IGZ1bmN0aW9uKGVsZW1lbnQsIHBhcmVudEVsZW1lbnQsIGFmdGVyRWxlbWVudCwgb3B0aW9ucykge1xuICAgICAgICAgIG9wdGlvbnMgPSBwYXJzZUFuaW1hdGVPcHRpb25zKG9wdGlvbnMpO1xuICAgICAgICAgIGVsZW1lbnQgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudCk7XG4gICAgICAgICAgcGFyZW50RWxlbWVudCA9IHByZXBhcmVFbGVtZW50KHBhcmVudEVsZW1lbnQpO1xuICAgICAgICAgIGFmdGVyRWxlbWVudCA9IHByZXBhcmVFbGVtZW50KGFmdGVyRWxlbWVudCk7XG5cbiAgICAgICAgICBjbGFzc0Jhc2VkQW5pbWF0aW9uc0Jsb2NrZWQoZWxlbWVudCwgdHJ1ZSk7XG4gICAgICAgICAgJGRlbGVnYXRlLmVudGVyKGVsZW1lbnQsIHBhcmVudEVsZW1lbnQsIGFmdGVyRWxlbWVudCk7XG4gICAgICAgICAgcmV0dXJuIHJ1bkFuaW1hdGlvblBvc3REaWdlc3QoZnVuY3Rpb24oZG9uZSkge1xuICAgICAgICAgICAgcmV0dXJuIHBlcmZvcm1BbmltYXRpb24oJ2VudGVyJywgJ25nLWVudGVyJywgc3RyaXBDb21tZW50c0Zyb21FbGVtZW50KGVsZW1lbnQpLCBwYXJlbnRFbGVtZW50LCBhZnRlckVsZW1lbnQsIG5vb3AsIG9wdGlvbnMsIGRvbmUpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgICAqIEBuYW1lICRhbmltYXRlI2xlYXZlXG4gICAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICAgKiBSdW5zIHRoZSBsZWF2ZSBhbmltYXRpb24gb3BlcmF0aW9uIGFuZCwgdXBvbiBjb21wbGV0aW9uLCByZW1vdmVzIHRoZSBlbGVtZW50IGZyb20gdGhlIERPTS4gT25jZVxuICAgICAgICAgKiB0aGUgYW5pbWF0aW9uIGlzIHN0YXJ0ZWQsIHRoZSBmb2xsb3dpbmcgQ1NTIGNsYXNzZXMgd2lsbCBiZSBhZGRlZCBmb3IgdGhlIGR1cmF0aW9uIG9mIHRoZSBhbmltYXRpb246XG4gICAgICAgICAqXG4gICAgICAgICAqIEJlbG93IGlzIGEgYnJlYWtkb3duIG9mIGVhY2ggc3RlcCB0aGF0IG9jY3VycyBkdXJpbmcgbGVhdmUgYW5pbWF0aW9uOlxuICAgICAgICAgKlxuICAgICAgICAgKiB8IEFuaW1hdGlvbiBTdGVwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IFdoYXQgdGhlIGVsZW1lbnQgY2xhc3MgYXR0cmlidXRlIGxvb2tzIGxpa2UgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxuICAgICAgICAgKiB8IDEuIGAkYW5pbWF0ZS5sZWF2ZSguLi4pYCBpcyBjYWxsZWQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgMi4gYCRhbmltYXRlYCBydW5zIHRoZSBKYXZhU2NyaXB0LWRlZmluZWQgYW5pbWF0aW9ucyBkZXRlY3RlZCBvbiB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGVcImAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCAzLiBgJGFuaW1hdGVgIHdhaXRzIGZvciB0aGUgbmV4dCBkaWdlc3QgdG8gc3RhcnQgdGhlIGFuaW1hdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZVwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDQuIHRoZSBgLm5nLWxlYXZlYCBjbGFzcyBpcyBhZGRlZCB0byB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWxlYXZlXCJgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgNS4gYCRhbmltYXRlYCBzY2FucyB0aGUgZWxlbWVudCBzdHlsZXMgdG8gZ2V0IHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24gZHVyYXRpb24gYW5kIGRlbGF5ICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctbGVhdmVcImAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCA2LiBgJGFuaW1hdGVgIGJsb2NrcyBhbGwgQ1NTIHRyYW5zaXRpb25zIG9uIHRoZSBlbGVtZW50IHRvIGVuc3VyZSB0aGUgYC5uZy1sZWF2ZWAgY2xhc3Mgc3R5bGluZyBpcyBhcHBsaWVkIHJpZ2h0IGF3YXkgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1sZWF2ZVwiYCAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDcuIGAkYW5pbWF0ZWAgd2FpdHMgZm9yIGEgc2luZ2xlIGFuaW1hdGlvbiBmcmFtZSAodGhpcyBwZXJmb3JtcyBhIHJlZmxvdykgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWxlYXZlXCJgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgOC4gYCRhbmltYXRlYCByZW1vdmVzIHRoZSBDU1MgdHJhbnNpdGlvbiBibG9jayBwbGFjZWQgb24gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctbGVhdmVcImAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCA5LiB0aGUgYC5uZy1sZWF2ZS1hY3RpdmVgIGNsYXNzIGlzIGFkZGVkICh0aGlzIHRyaWdnZXJzIHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1sZWF2ZSBuZy1sZWF2ZS1hY3RpdmVcImAgfFxuICAgICAgICAgKiB8IDEwLiBgJGFuaW1hdGVgIHdhaXRzIGZvciB0aGUgYW5pbWF0aW9uIHRvIGNvbXBsZXRlICh2aWEgZXZlbnRzIGFuZCB0aW1lb3V0KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWxlYXZlIG5nLWxlYXZlLWFjdGl2ZVwiYCB8XG4gICAgICAgICAqIHwgMTEuIFRoZSBhbmltYXRpb24gZW5kcyBhbmQgYWxsIGdlbmVyYXRlZCBDU1MgY2xhc3NlcyBhcmUgcmVtb3ZlZCBmcm9tIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCAxMi4gVGhlIGVsZW1lbnQgaXMgcmVtb3ZlZCBmcm9tIHRoZSBET00gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAuLi4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCAxMy4gVGhlIHJldHVybmVkIHByb21pc2UgaXMgcmVzb2x2ZWQuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAuLi4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBlbGVtZW50IHRoZSBlbGVtZW50IHRoYXQgd2lsbCBiZSB0aGUgZm9jdXMgb2YgdGhlIGxlYXZlIGFuaW1hdGlvblxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdD19IG9wdGlvbnMgYW4gb3B0aW9uYWwgY29sbGVjdGlvbiBvZiBzdHlsZXMgdGhhdCB3aWxsIGJlIHBpY2tlZCB1cCBieSB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uXG4gICAgICAgICAqIEByZXR1cm4ge1Byb21pc2V9IHRoZSBhbmltYXRpb24gY2FsbGJhY2sgcHJvbWlzZVxuICAgICAgICAqL1xuICAgICAgICBsZWF2ZTogZnVuY3Rpb24oZWxlbWVudCwgb3B0aW9ucykge1xuICAgICAgICAgIG9wdGlvbnMgPSBwYXJzZUFuaW1hdGVPcHRpb25zKG9wdGlvbnMpO1xuICAgICAgICAgIGVsZW1lbnQgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudCk7XG5cbiAgICAgICAgICBjYW5jZWxDaGlsZEFuaW1hdGlvbnMoZWxlbWVudCk7XG4gICAgICAgICAgY2xhc3NCYXNlZEFuaW1hdGlvbnNCbG9ja2VkKGVsZW1lbnQsIHRydWUpO1xuICAgICAgICAgIHJldHVybiBydW5BbmltYXRpb25Qb3N0RGlnZXN0KGZ1bmN0aW9uKGRvbmUpIHtcbiAgICAgICAgICAgIHJldHVybiBwZXJmb3JtQW5pbWF0aW9uKCdsZWF2ZScsICduZy1sZWF2ZScsIHN0cmlwQ29tbWVudHNGcm9tRWxlbWVudChlbGVtZW50KSwgbnVsbCwgbnVsbCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICRkZWxlZ2F0ZS5sZWF2ZShlbGVtZW50KTtcbiAgICAgICAgICAgIH0sIG9wdGlvbnMsIGRvbmUpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgICAqIEBuYW1lICRhbmltYXRlI21vdmVcbiAgICAgICAgICogQGtpbmQgZnVuY3Rpb25cbiAgICAgICAgICpcbiAgICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgICAqIEZpcmVzIHRoZSBtb3ZlIERPTSBvcGVyYXRpb24uIEp1c3QgYmVmb3JlIHRoZSBhbmltYXRpb24gc3RhcnRzLCB0aGUgYW5pbWF0ZSBzZXJ2aWNlIHdpbGwgZWl0aGVyIGFwcGVuZCBpdCBpbnRvIHRoZSBwYXJlbnRFbGVtZW50IGNvbnRhaW5lciBvclxuICAgICAgICAgKiBhZGQgdGhlIGVsZW1lbnQgZGlyZWN0bHkgYWZ0ZXIgdGhlIGFmdGVyRWxlbWVudCBlbGVtZW50IGlmIHByZXNlbnQuIFRoZW4gdGhlIG1vdmUgYW5pbWF0aW9uIHdpbGwgYmUgcnVuLiBPbmNlXG4gICAgICAgICAqIHRoZSBhbmltYXRpb24gaXMgc3RhcnRlZCwgdGhlIGZvbGxvd2luZyBDU1MgY2xhc3NlcyB3aWxsIGJlIGFkZGVkIGZvciB0aGUgZHVyYXRpb24gb2YgdGhlIGFuaW1hdGlvbjpcbiAgICAgICAgICpcbiAgICAgICAgICogQmVsb3cgaXMgYSBicmVha2Rvd24gb2YgZWFjaCBzdGVwIHRoYXQgb2NjdXJzIGR1cmluZyBtb3ZlIGFuaW1hdGlvbjpcbiAgICAgICAgICpcbiAgICAgICAgICogfCBBbmltYXRpb24gU3RlcCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IFdoYXQgdGhlIGVsZW1lbnQgY2xhc3MgYXR0cmlidXRlIGxvb2tzIGxpa2UgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcbiAgICAgICAgICogfCAxLiBgJGFuaW1hdGUubW92ZSguLi4pYCBpcyBjYWxsZWQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDIuIGVsZW1lbnQgaXMgbW92ZWQgaW50byB0aGUgcGFyZW50RWxlbWVudCBlbGVtZW50IG9yIGJlc2lkZSB0aGUgYWZ0ZXJFbGVtZW50IGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgMy4gYCRhbmltYXRlYCB3YWl0cyBmb3IgdGhlIG5leHQgZGlnZXN0IHRvIHN0YXJ0IHRoZSBhbmltYXRpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZVwiYCAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCA0LiBgJGFuaW1hdGVgIHJ1bnMgdGhlIEphdmFTY3JpcHQtZGVmaW5lZCBhbmltYXRpb25zIGRldGVjdGVkIG9uIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlXCJgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDUuIHRoZSBgLm5nLW1vdmVgIGNsYXNzIGlzIGFkZGVkIHRvIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctbW92ZVwiYCAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgNi4gYCRhbmltYXRlYCBzY2FucyB0aGUgZWxlbWVudCBzdHlsZXMgdG8gZ2V0IHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24gZHVyYXRpb24gYW5kIGRlbGF5ICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1tb3ZlXCJgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCA3LiBgJGFuaW1hdGVgIGJsb2NrcyBhbGwgQ1NTIHRyYW5zaXRpb25zIG9uIHRoZSBlbGVtZW50IHRvIGVuc3VyZSB0aGUgYC5uZy1tb3ZlYCBjbGFzcyBzdHlsaW5nIGlzIGFwcGxpZWQgcmlnaHQgYXdheSB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLW1vdmVcImAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDguIGAkYW5pbWF0ZWAgd2FpdHMgZm9yIGEgc2luZ2xlIGFuaW1hdGlvbiBmcmFtZSAodGhpcyBwZXJmb3JtcyBhIHJlZmxvdykgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctbW92ZVwiYCAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgOS4gYCRhbmltYXRlYCByZW1vdmVzIHRoZSBDU1MgdHJhbnNpdGlvbiBibG9jayBwbGFjZWQgb24gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1tb3ZlXCJgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCAxMC4gdGhlIGAubmctbW92ZS1hY3RpdmVgIGNsYXNzIGlzIGFkZGVkICh0aGlzIHRyaWdnZXJzIHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLW1vdmUgbmctbW92ZS1hY3RpdmVcImAgfFxuICAgICAgICAgKiB8IDExLiBgJGFuaW1hdGVgIHdhaXRzIGZvciB0aGUgYW5pbWF0aW9uIHRvIGNvbXBsZXRlICh2aWEgZXZlbnRzIGFuZCB0aW1lb3V0KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctbW92ZSBuZy1tb3ZlLWFjdGl2ZVwiYCB8XG4gICAgICAgICAqIHwgMTIuIFRoZSBhbmltYXRpb24gZW5kcyBhbmQgYWxsIGdlbmVyYXRlZCBDU1MgY2xhc3NlcyBhcmUgcmVtb3ZlZCBmcm9tIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb25cImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCAxMy4gVGhlIHJldHVybmVkIHByb21pc2UgaXMgcmVzb2x2ZWQuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgdGhlIGVsZW1lbnQgdGhhdCB3aWxsIGJlIHRoZSBmb2N1cyBvZiB0aGUgbW92ZSBhbmltYXRpb25cbiAgICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBwYXJlbnRFbGVtZW50IHRoZSBwYXJlbnRFbGVtZW50IGVsZW1lbnQgb2YgdGhlIGVsZW1lbnQgdGhhdCB3aWxsIGJlIHRoZSBmb2N1cyBvZiB0aGUgbW92ZSBhbmltYXRpb25cbiAgICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBhZnRlckVsZW1lbnQgdGhlIHNpYmxpbmcgZWxlbWVudCAod2hpY2ggaXMgdGhlIHByZXZpb3VzIGVsZW1lbnQpIG9mIHRoZSBlbGVtZW50IHRoYXQgd2lsbCBiZSB0aGUgZm9jdXMgb2YgdGhlIG1vdmUgYW5pbWF0aW9uXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyBhbiBvcHRpb25hbCBjb2xsZWN0aW9uIG9mIHN0eWxlcyB0aGF0IHdpbGwgYmUgcGlja2VkIHVwIGJ5IHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb25cbiAgICAgICAgICogQHJldHVybiB7UHJvbWlzZX0gdGhlIGFuaW1hdGlvbiBjYWxsYmFjayBwcm9taXNlXG4gICAgICAgICovXG4gICAgICAgIG1vdmU6IGZ1bmN0aW9uKGVsZW1lbnQsIHBhcmVudEVsZW1lbnQsIGFmdGVyRWxlbWVudCwgb3B0aW9ucykge1xuICAgICAgICAgIG9wdGlvbnMgPSBwYXJzZUFuaW1hdGVPcHRpb25zKG9wdGlvbnMpO1xuICAgICAgICAgIGVsZW1lbnQgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudCk7XG4gICAgICAgICAgcGFyZW50RWxlbWVudCA9IHByZXBhcmVFbGVtZW50KHBhcmVudEVsZW1lbnQpO1xuICAgICAgICAgIGFmdGVyRWxlbWVudCA9IHByZXBhcmVFbGVtZW50KGFmdGVyRWxlbWVudCk7XG5cbiAgICAgICAgICBjYW5jZWxDaGlsZEFuaW1hdGlvbnMoZWxlbWVudCk7XG4gICAgICAgICAgY2xhc3NCYXNlZEFuaW1hdGlvbnNCbG9ja2VkKGVsZW1lbnQsIHRydWUpO1xuICAgICAgICAgICRkZWxlZ2F0ZS5tb3ZlKGVsZW1lbnQsIHBhcmVudEVsZW1lbnQsIGFmdGVyRWxlbWVudCk7XG4gICAgICAgICAgcmV0dXJuIHJ1bkFuaW1hdGlvblBvc3REaWdlc3QoZnVuY3Rpb24oZG9uZSkge1xuICAgICAgICAgICAgcmV0dXJuIHBlcmZvcm1BbmltYXRpb24oJ21vdmUnLCAnbmctbW92ZScsIHN0cmlwQ29tbWVudHNGcm9tRWxlbWVudChlbGVtZW50KSwgcGFyZW50RWxlbWVudCwgYWZ0ZXJFbGVtZW50LCBub29wLCBvcHRpb25zLCBkb25lKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICAgKiBAbmFtZSAkYW5pbWF0ZSNhZGRDbGFzc1xuICAgICAgICAgKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAgICogVHJpZ2dlcnMgYSBjdXN0b20gYW5pbWF0aW9uIGV2ZW50IGJhc2VkIG9mZiB0aGUgY2xhc3NOYW1lIHZhcmlhYmxlIGFuZCB0aGVuIGF0dGFjaGVzIHRoZSBjbGFzc05hbWUgdmFsdWUgdG8gdGhlIGVsZW1lbnQgYXMgYSBDU1MgY2xhc3MuXG4gICAgICAgICAqIFVubGlrZSB0aGUgb3RoZXIgYW5pbWF0aW9uIG1ldGhvZHMsIHRoZSBhbmltYXRlIHNlcnZpY2Ugd2lsbCBzdWZmaXggdGhlIGNsYXNzTmFtZSB2YWx1ZSB3aXRoIHtAdHlwZSAtYWRkfSBpbiBvcmRlciB0byBwcm92aWRlXG4gICAgICAgICAqIHRoZSBhbmltYXRlIHNlcnZpY2UgdGhlIHNldHVwIGFuZCBhY3RpdmUgQ1NTIGNsYXNzZXMgaW4gb3JkZXIgdG8gdHJpZ2dlciB0aGUgYW5pbWF0aW9uICh0aGlzIHdpbGwgYmUgc2tpcHBlZCBpZiBubyBDU1MgdHJhbnNpdGlvbnNcbiAgICAgICAgICogb3Iga2V5ZnJhbWVzIGFyZSBkZWZpbmVkIG9uIHRoZSAtYWRkLWFjdGl2ZSBvciBiYXNlIENTUyBjbGFzcykuXG4gICAgICAgICAqXG4gICAgICAgICAqIEJlbG93IGlzIGEgYnJlYWtkb3duIG9mIGVhY2ggc3RlcCB0aGF0IG9jY3VycyBkdXJpbmcgYWRkQ2xhc3MgYW5pbWF0aW9uOlxuICAgICAgICAgKlxuICAgICAgICAgKiB8IEFuaW1hdGlvbiBTdGVwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IFdoYXQgdGhlIGVsZW1lbnQgY2xhc3MgYXR0cmlidXRlIGxvb2tzIGxpa2UgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcbiAgICAgICAgICogfCAxLiBgJGFuaW1hdGUuYWRkQ2xhc3MoZWxlbWVudCwgJ3N1cGVyJylgIGlzIGNhbGxlZCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb25cImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgMi4gYCRhbmltYXRlYCBydW5zIHRoZSBKYXZhU2NyaXB0LWRlZmluZWQgYW5pbWF0aW9ucyBkZXRlY3RlZCBvbiB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGVcImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDMuIHRoZSBgLnN1cGVyLWFkZGAgY2xhc3MgaXMgYWRkZWQgdG8gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIHN1cGVyLWFkZFwiYCAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCA0LiBgJGFuaW1hdGVgIHdhaXRzIGZvciBhIHNpbmdsZSBhbmltYXRpb24gZnJhbWUgKHRoaXMgcGVyZm9ybXMgYSByZWZsb3cpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBzdXBlci1hZGRcImAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgNS4gdGhlIGAuc3VwZXJgIGFuZCBgLnN1cGVyLWFkZC1hY3RpdmVgIGNsYXNzZXMgYXJlIGFkZGVkICh0aGlzIHRyaWdnZXJzIHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24pIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgc3VwZXIgc3VwZXItYWRkIHN1cGVyLWFkZC1hY3RpdmVcImAgfFxuICAgICAgICAgKiB8IDYuIGAkYW5pbWF0ZWAgc2NhbnMgdGhlIGVsZW1lbnQgc3R5bGVzIHRvIGdldCB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uIGR1cmF0aW9uIGFuZCBkZWxheSAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIHN1cGVyIHN1cGVyLWFkZCBzdXBlci1hZGQtYWN0aXZlXCJgIHxcbiAgICAgICAgICogfCA3LiBgJGFuaW1hdGVgIHdhaXRzIGZvciB0aGUgYW5pbWF0aW9uIHRvIGNvbXBsZXRlICh2aWEgZXZlbnRzIGFuZCB0aW1lb3V0KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBzdXBlciBzdXBlci1hZGQgc3VwZXItYWRkLWFjdGl2ZVwiYCB8XG4gICAgICAgICAqIHwgOC4gVGhlIGFuaW1hdGlvbiBlbmRzIGFuZCBhbGwgZ2VuZXJhdGVkIENTUyBjbGFzc2VzIGFyZSByZW1vdmVkIGZyb20gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIHN1cGVyXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDkuIFRoZSBzdXBlciBjbGFzcyBpcyBrZXB0IG9uIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBzdXBlclwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCAxMC4gVGhlIHJldHVybmVkIHByb21pc2UgaXMgcmVzb2x2ZWQuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gc3VwZXJcImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gZWxlbWVudCB0aGUgZWxlbWVudCB0aGF0IHdpbGwgYmUgYW5pbWF0ZWRcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGNsYXNzTmFtZSB0aGUgQ1NTIGNsYXNzIHRoYXQgd2lsbCBiZSBhZGRlZCB0byB0aGUgZWxlbWVudCBhbmQgdGhlbiBhbmltYXRlZFxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdD19IG9wdGlvbnMgYW4gb3B0aW9uYWwgY29sbGVjdGlvbiBvZiBzdHlsZXMgdGhhdCB3aWxsIGJlIHBpY2tlZCB1cCBieSB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uXG4gICAgICAgICAqIEByZXR1cm4ge1Byb21pc2V9IHRoZSBhbmltYXRpb24gY2FsbGJhY2sgcHJvbWlzZVxuICAgICAgICAqL1xuICAgICAgICBhZGRDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBvcHRpb25zKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuc2V0Q2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lLCBbXSwgb3B0aW9ucyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAgICogQG5hbWUgJGFuaW1hdGUjcmVtb3ZlQ2xhc3NcbiAgICAgICAgICpcbiAgICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgICAqIFRyaWdnZXJzIGEgY3VzdG9tIGFuaW1hdGlvbiBldmVudCBiYXNlZCBvZmYgdGhlIGNsYXNzTmFtZSB2YXJpYWJsZSBhbmQgdGhlbiByZW1vdmVzIHRoZSBDU1MgY2xhc3MgcHJvdmlkZWQgYnkgdGhlIGNsYXNzTmFtZSB2YWx1ZVxuICAgICAgICAgKiBmcm9tIHRoZSBlbGVtZW50LiBVbmxpa2UgdGhlIG90aGVyIGFuaW1hdGlvbiBtZXRob2RzLCB0aGUgYW5pbWF0ZSBzZXJ2aWNlIHdpbGwgc3VmZml4IHRoZSBjbGFzc05hbWUgdmFsdWUgd2l0aCB7QHR5cGUgLXJlbW92ZX0gaW5cbiAgICAgICAgICogb3JkZXIgdG8gcHJvdmlkZSB0aGUgYW5pbWF0ZSBzZXJ2aWNlIHRoZSBzZXR1cCBhbmQgYWN0aXZlIENTUyBjbGFzc2VzIGluIG9yZGVyIHRvIHRyaWdnZXIgdGhlIGFuaW1hdGlvbiAodGhpcyB3aWxsIGJlIHNraXBwZWQgaWZcbiAgICAgICAgICogbm8gQ1NTIHRyYW5zaXRpb25zIG9yIGtleWZyYW1lcyBhcmUgZGVmaW5lZCBvbiB0aGUgLXJlbW92ZSBvciBiYXNlIENTUyBjbGFzc2VzKS5cbiAgICAgICAgICpcbiAgICAgICAgICogQmVsb3cgaXMgYSBicmVha2Rvd24gb2YgZWFjaCBzdGVwIHRoYXQgb2NjdXJzIGR1cmluZyByZW1vdmVDbGFzcyBhbmltYXRpb246XG4gICAgICAgICAqXG4gICAgICAgICAqIHwgQW5pbWF0aW9uIFN0ZXAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBXaGF0IHRoZSBlbGVtZW50IGNsYXNzIGF0dHJpYnV0ZSBsb29rcyBsaWtlICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcbiAgICAgICAgICogfCAxLiBgJGFuaW1hdGUucmVtb3ZlQ2xhc3MoZWxlbWVudCwgJ3N1cGVyJylgIGlzIGNhbGxlZCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBzdXBlclwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCAyLiBgJGFuaW1hdGVgIHJ1bnMgdGhlIEphdmFTY3JpcHQtZGVmaW5lZCBhbmltYXRpb25zIGRldGVjdGVkIG9uIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBzdXBlciBuZy1hbmltYXRlXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCAzLiB0aGUgYC5zdXBlci1yZW1vdmVgIGNsYXNzIGlzIGFkZGVkIHRvIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBzdXBlciBuZy1hbmltYXRlIHN1cGVyLXJlbW92ZVwiYCAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCA0LiBgJGFuaW1hdGVgIHdhaXRzIGZvciBhIHNpbmdsZSBhbmltYXRpb24gZnJhbWUgKHRoaXMgcGVyZm9ybXMgYSByZWZsb3cpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBzdXBlciBuZy1hbmltYXRlIHN1cGVyLXJlbW92ZVwiYCAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCA1LiB0aGUgYC5zdXBlci1yZW1vdmUtYWN0aXZlYCBjbGFzc2VzIGFyZSBhZGRlZCBhbmQgYC5zdXBlcmAgaXMgcmVtb3ZlZCAodGhpcyB0cmlnZ2VycyB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uKSB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIHN1cGVyLXJlbW92ZSBzdXBlci1yZW1vdmUtYWN0aXZlXCJgIHxcbiAgICAgICAgICogfCA2LiBgJGFuaW1hdGVgIHNjYW5zIHRoZSBlbGVtZW50IHN0eWxlcyB0byBnZXQgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbiBkdXJhdGlvbiBhbmQgZGVsYXkgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIHN1cGVyLXJlbW92ZSBzdXBlci1yZW1vdmUtYWN0aXZlXCJgIHxcbiAgICAgICAgICogfCA3LiBgJGFuaW1hdGVgIHdhaXRzIGZvciB0aGUgYW5pbWF0aW9uIHRvIGNvbXBsZXRlICh2aWEgZXZlbnRzIGFuZCB0aW1lb3V0KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIHN1cGVyLXJlbW92ZSBzdXBlci1yZW1vdmUtYWN0aXZlXCJgIHxcbiAgICAgICAgICogfCA4LiBUaGUgYW5pbWF0aW9uIGVuZHMgYW5kIGFsbCBnZW5lcmF0ZWQgQ1NTIGNsYXNzZXMgYXJlIHJlbW92ZWQgZnJvbSB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCA5LiBUaGUgcmV0dXJuZWQgcHJvbWlzZSBpcyByZXNvbHZlZC4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICpcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBlbGVtZW50IHRoZSBlbGVtZW50IHRoYXQgd2lsbCBiZSBhbmltYXRlZFxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NOYW1lIHRoZSBDU1MgY2xhc3MgdGhhdCB3aWxsIGJlIGFuaW1hdGVkIGFuZCB0aGVuIHJlbW92ZWQgZnJvbSB0aGUgZWxlbWVudFxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdD19IG9wdGlvbnMgYW4gb3B0aW9uYWwgY29sbGVjdGlvbiBvZiBzdHlsZXMgdGhhdCB3aWxsIGJlIHBpY2tlZCB1cCBieSB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uXG4gICAgICAgICAqIEByZXR1cm4ge1Byb21pc2V9IHRoZSBhbmltYXRpb24gY2FsbGJhY2sgcHJvbWlzZVxuICAgICAgICAqL1xuICAgICAgICByZW1vdmVDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBvcHRpb25zKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuc2V0Q2xhc3MoZWxlbWVudCwgW10sIGNsYXNzTmFtZSwgb3B0aW9ucyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAgICogQG5hbWUgJGFuaW1hdGUjc2V0Q2xhc3NcbiAgICAgICAgICpcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIEFkZHMgYW5kL29yIHJlbW92ZXMgdGhlIGdpdmVuIENTUyBjbGFzc2VzIHRvIGFuZCBmcm9tIHRoZSBlbGVtZW50LlxuICAgICAgICAgKiBPbmNlIGNvbXBsZXRlLCB0aGUgYGRvbmUoKWAgY2FsbGJhY2sgd2lsbCBiZSBmaXJlZCAoaWYgcHJvdmlkZWQpLlxuICAgICAgICAgKlxuICAgICAgICAgKiB8IEFuaW1hdGlvbiBTdGVwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgV2hhdCB0aGUgZWxlbWVudCBjbGFzcyBhdHRyaWJ1dGUgbG9va3MgbGlrZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxuICAgICAgICAgKiB8IDEuIGAkYW5pbWF0ZS5zZXRDbGFzcyhlbGVtZW50LCAnb24nLCAnb2ZmJylgIGlzIGNhbGxlZCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG9mZlwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgMi4gYCRhbmltYXRlYCBydW5zIHRoZSBKYXZhU2NyaXB0LWRlZmluZWQgYW5pbWF0aW9ucyBkZXRlY3RlZCBvbiB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBvZmZcImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCAzLiB0aGUgYC5vbi1hZGRgIGFuZCBgLm9mZi1yZW1vdmVgIGNsYXNzZXMgYXJlIGFkZGVkIHRvIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG9uLWFkZCBvZmYtcmVtb3ZlIG9mZlwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKiB8IDQuIGAkYW5pbWF0ZWAgd2FpdHMgZm9yIGEgc2luZ2xlIGFuaW1hdGlvbiBmcmFtZSAodGhpcyBwZXJmb3JtcyBhIHJlZmxvdykgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgb24tYWRkIG9mZi1yZW1vdmUgb2ZmXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAqIHwgNS4gdGhlIGAub25gLCBgLm9uLWFkZC1hY3RpdmVgIGFuZCBgLm9mZi1yZW1vdmUtYWN0aXZlYCBjbGFzc2VzIGFyZSBhZGRlZCBhbmQgYC5vZmZgIGlzIHJlbW92ZWQgKHRoaXMgdHJpZ2dlcnMgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbikgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBvbiBvbi1hZGQgb24tYWRkLWFjdGl2ZSBvZmYtcmVtb3ZlIG9mZi1yZW1vdmUtYWN0aXZlXCJgIHxcbiAgICAgICAgICogfCA2LiBgJGFuaW1hdGVgIHNjYW5zIHRoZSBlbGVtZW50IHN0eWxlcyB0byBnZXQgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbiBkdXJhdGlvbiBhbmQgZGVsYXkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG9uIG9uLWFkZCBvbi1hZGQtYWN0aXZlIG9mZi1yZW1vdmUgb2ZmLXJlbW92ZS1hY3RpdmVcImAgfFxuICAgICAgICAgKiB8IDcuIGAkYW5pbWF0ZWAgd2FpdHMgZm9yIHRoZSBhbmltYXRpb24gdG8gY29tcGxldGUgKHZpYSBldmVudHMgYW5kIHRpbWVvdXQpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgb24gb24tYWRkIG9uLWFkZC1hY3RpdmUgb2ZmLXJlbW92ZSBvZmYtcmVtb3ZlLWFjdGl2ZVwiYCB8XG4gICAgICAgICAqIHwgOC4gVGhlIGFuaW1hdGlvbiBlbmRzIGFuZCBhbGwgZ2VuZXJhdGVkIENTUyBjbGFzc2VzIGFyZSByZW1vdmVkIGZyb20gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gb25cImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICogfCA5LiBUaGUgcmV0dXJuZWQgcHJvbWlzZSBpcyByZXNvbHZlZC4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgdGhlIGVsZW1lbnQgd2hpY2ggd2lsbCBoYXZlIGl0cyBDU1MgY2xhc3NlcyBjaGFuZ2VkXG4gICAgICAgICAqICAgcmVtb3ZlZCBmcm9tIGl0XG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhZGQgdGhlIENTUyBjbGFzc2VzIHdoaWNoIHdpbGwgYmUgYWRkZWQgdG8gdGhlIGVsZW1lbnRcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IHJlbW92ZSB0aGUgQ1NTIGNsYXNzIHdoaWNoIHdpbGwgYmUgcmVtb3ZlZCBmcm9tIHRoZSBlbGVtZW50XG4gICAgICAgICAqICAgQ1NTIGNsYXNzZXMgaGF2ZSBiZWVuIHNldCBvbiB0aGUgZWxlbWVudFxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdD19IG9wdGlvbnMgYW4gb3B0aW9uYWwgY29sbGVjdGlvbiBvZiBzdHlsZXMgdGhhdCB3aWxsIGJlIHBpY2tlZCB1cCBieSB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uXG4gICAgICAgICAqIEByZXR1cm4ge1Byb21pc2V9IHRoZSBhbmltYXRpb24gY2FsbGJhY2sgcHJvbWlzZVxuICAgICAgICAgKi9cbiAgICAgICAgc2V0Q2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGFkZCwgcmVtb3ZlLCBvcHRpb25zKSB7XG4gICAgICAgICAgb3B0aW9ucyA9IHBhcnNlQW5pbWF0ZU9wdGlvbnMob3B0aW9ucyk7XG5cbiAgICAgICAgICB2YXIgU1RPUkFHRV9LRVkgPSAnJCRhbmltYXRlQ2xhc3Nlcyc7XG4gICAgICAgICAgZWxlbWVudCA9IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50KTtcbiAgICAgICAgICBlbGVtZW50ID0gc3RyaXBDb21tZW50c0Zyb21FbGVtZW50KGVsZW1lbnQpO1xuXG4gICAgICAgICAgaWYgKGNsYXNzQmFzZWRBbmltYXRpb25zQmxvY2tlZChlbGVtZW50KSkge1xuICAgICAgICAgICAgcmV0dXJuICRkZWxlZ2F0ZS4kJHNldENsYXNzSW1tZWRpYXRlbHkoZWxlbWVudCwgYWRkLCByZW1vdmUsIG9wdGlvbnMpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIHdlJ3JlIHVzaW5nIGEgY29tYmluZWQgYXJyYXkgZm9yIGJvdGggdGhlIGFkZCBhbmQgcmVtb3ZlXG4gICAgICAgICAgLy8gb3BlcmF0aW9ucyBzaW5jZSB0aGUgT1JERVIgT0YgYWRkQ2xhc3MgYW5kIHJlbW92ZUNsYXNzIG1hdHRlcnNcbiAgICAgICAgICB2YXIgY2xhc3NlcywgY2FjaGUgPSBlbGVtZW50LmRhdGEoU1RPUkFHRV9LRVkpO1xuICAgICAgICAgIHZhciBoYXNDYWNoZSA9ICEhY2FjaGU7XG4gICAgICAgICAgaWYgKCFjYWNoZSkge1xuICAgICAgICAgICAgY2FjaGUgPSB7fTtcbiAgICAgICAgICAgIGNhY2hlLmNsYXNzZXMgPSB7fTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2xhc3NlcyA9IGNhY2hlLmNsYXNzZXM7XG5cbiAgICAgICAgICBhZGQgPSBpc0FycmF5KGFkZCkgPyBhZGQgOiBhZGQuc3BsaXQoJyAnKTtcbiAgICAgICAgICBmb3JFYWNoKGFkZCwgZnVuY3Rpb24oYykge1xuICAgICAgICAgICAgaWYgKGMgJiYgYy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgY2xhc3Nlc1tjXSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICByZW1vdmUgPSBpc0FycmF5KHJlbW92ZSkgPyByZW1vdmUgOiByZW1vdmUuc3BsaXQoJyAnKTtcbiAgICAgICAgICBmb3JFYWNoKHJlbW92ZSwgZnVuY3Rpb24oYykge1xuICAgICAgICAgICAgaWYgKGMgJiYgYy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgY2xhc3Nlc1tjXSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgaWYgKGhhc0NhY2hlKSB7XG4gICAgICAgICAgICBpZiAob3B0aW9ucyAmJiBjYWNoZS5vcHRpb25zKSB7XG4gICAgICAgICAgICAgIGNhY2hlLm9wdGlvbnMgPSBhbmd1bGFyLmV4dGVuZChjYWNoZS5vcHRpb25zIHx8IHt9LCBvcHRpb25zKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy90aGUgZGlnZXN0IGN5Y2xlIHdpbGwgY29tYmluZSBhbGwgdGhlIGFuaW1hdGlvbnMgaW50byBvbmUgZnVuY3Rpb25cbiAgICAgICAgICAgIHJldHVybiBjYWNoZS5wcm9taXNlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlbGVtZW50LmRhdGEoU1RPUkFHRV9LRVksIGNhY2hlID0ge1xuICAgICAgICAgICAgICBjbGFzc2VzOiBjbGFzc2VzLFxuICAgICAgICAgICAgICBvcHRpb25zOiBvcHRpb25zXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gY2FjaGUucHJvbWlzZSA9IHJ1bkFuaW1hdGlvblBvc3REaWdlc3QoZnVuY3Rpb24oZG9uZSkge1xuICAgICAgICAgICAgdmFyIHBhcmVudEVsZW1lbnQgPSBlbGVtZW50LnBhcmVudCgpO1xuICAgICAgICAgICAgdmFyIGVsZW1lbnROb2RlID0gZXh0cmFjdEVsZW1lbnROb2RlKGVsZW1lbnQpO1xuICAgICAgICAgICAgdmFyIHBhcmVudE5vZGUgPSBlbGVtZW50Tm9kZS5wYXJlbnROb2RlO1xuICAgICAgICAgICAgLy8gVE9ETyhtYXRza28pOiBtb3ZlIHRoaXMgY29kZSBpbnRvIHRoZSBhbmltYXRpb25zRGlzYWJsZWQoKSBmdW5jdGlvbiBvbmNlICM4MDkyIGlzIGZpeGVkXG4gICAgICAgICAgICBpZiAoIXBhcmVudE5vZGUgfHwgcGFyZW50Tm9kZVsnJCROR19SRU1PVkVEJ10gfHwgZWxlbWVudE5vZGVbJyQkTkdfUkVNT1ZFRCddKSB7XG4gICAgICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgY2FjaGUgPSBlbGVtZW50LmRhdGEoU1RPUkFHRV9LRVkpO1xuICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVEYXRhKFNUT1JBR0VfS0VZKTtcblxuICAgICAgICAgICAgdmFyIHN0YXRlID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUpIHx8IHt9O1xuICAgICAgICAgICAgdmFyIGNsYXNzZXMgPSByZXNvbHZlRWxlbWVudENsYXNzZXMoZWxlbWVudCwgY2FjaGUsIHN0YXRlLmFjdGl2ZSk7XG4gICAgICAgICAgICByZXR1cm4gIWNsYXNzZXNcbiAgICAgICAgICAgICAgPyBkb25lKClcbiAgICAgICAgICAgICAgOiBwZXJmb3JtQW5pbWF0aW9uKCdzZXRDbGFzcycsIGNsYXNzZXMsIGVsZW1lbnQsIHBhcmVudEVsZW1lbnQsIG51bGwsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgaWYgKGNsYXNzZXNbMF0pICRkZWxlZ2F0ZS4kJGFkZENsYXNzSW1tZWRpYXRlbHkoZWxlbWVudCwgY2xhc3Nlc1swXSk7XG4gICAgICAgICAgICAgICAgICBpZiAoY2xhc3Nlc1sxXSkgJGRlbGVnYXRlLiQkcmVtb3ZlQ2xhc3NJbW1lZGlhdGVseShlbGVtZW50LCBjbGFzc2VzWzFdKTtcbiAgICAgICAgICAgICAgICB9LCBjYWNoZS5vcHRpb25zLCBkb25lKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICAgKiBAbmFtZSAkYW5pbWF0ZSNjYW5jZWxcbiAgICAgICAgICogQGtpbmQgZnVuY3Rpb25cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtQcm9taXNlfSBhbmltYXRpb25Qcm9taXNlIFRoZSBhbmltYXRpb24gcHJvbWlzZSB0aGF0IGlzIHJldHVybmVkIHdoZW4gYW4gYW5pbWF0aW9uIGlzIHN0YXJ0ZWQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICAgKiBDYW5jZWxzIHRoZSBwcm92aWRlZCBhbmltYXRpb24uXG4gICAgICAgICovXG4gICAgICAgIGNhbmNlbDogZnVuY3Rpb24ocHJvbWlzZSkge1xuICAgICAgICAgIHByb21pc2UuJCRjYW5jZWxGbigpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgICAqIEBuYW1lICRhbmltYXRlI2VuYWJsZWRcbiAgICAgICAgICogQGtpbmQgZnVuY3Rpb25cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtib29sZWFuPX0gdmFsdWUgSWYgcHJvdmlkZWQgdGhlbiBzZXQgdGhlIGFuaW1hdGlvbiBvbiBvciBvZmYuXG4gICAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudD19IGVsZW1lbnQgSWYgcHJvdmlkZWQgdGhlbiB0aGUgZWxlbWVudCB3aWxsIGJlIHVzZWQgdG8gcmVwcmVzZW50IHRoZSBlbmFibGUvZGlzYWJsZSBvcGVyYXRpb25cbiAgICAgICAgICogQHJldHVybiB7Ym9vbGVhbn0gQ3VycmVudCBhbmltYXRpb24gc3RhdGUuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICAgKiBHbG9iYWxseSBlbmFibGVzL2Rpc2FibGVzIGFuaW1hdGlvbnMuXG4gICAgICAgICAqXG4gICAgICAgICovXG4gICAgICAgIGVuYWJsZWQ6IGZ1bmN0aW9uKHZhbHVlLCBlbGVtZW50KSB7XG4gICAgICAgICAgc3dpdGNoIChhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGNsZWFudXAoZWxlbWVudCk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSkgfHwge307XG4gICAgICAgICAgICAgICAgZGF0YS5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUsIGRhdGEpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICByb290QW5pbWF0ZVN0YXRlLmRpc2FibGVkID0gIXZhbHVlO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgIHZhbHVlID0gIXJvb3RBbmltYXRlU3RhdGUuZGlzYWJsZWQ7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuICEhdmFsdWU7XG4gICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICAvKlxuICAgICAgICBhbGwgYW5pbWF0aW9ucyBjYWxsIHRoaXMgc2hhcmVkIGFuaW1hdGlvbiB0cmlnZ2VyaW5nIGZ1bmN0aW9uIGludGVybmFsbHkuXG4gICAgICAgIFRoZSBhbmltYXRpb25FdmVudCB2YXJpYWJsZSByZWZlcnMgdG8gdGhlIEphdmFTY3JpcHQgYW5pbWF0aW9uIGV2ZW50IHRoYXQgd2lsbCBiZSB0cmlnZ2VyZWRcbiAgICAgICAgYW5kIHRoZSBjbGFzc05hbWUgdmFsdWUgaXMgdGhlIG5hbWUgb2YgdGhlIGFuaW1hdGlvbiB0aGF0IHdpbGwgYmUgYXBwbGllZCB3aXRoaW4gdGhlXG4gICAgICAgIENTUyBjb2RlLiBFbGVtZW50LCBgcGFyZW50RWxlbWVudGAgYW5kIGBhZnRlckVsZW1lbnRgIGFyZSBwcm92aWRlZCBET00gZWxlbWVudHMgZm9yIHRoZSBhbmltYXRpb25cbiAgICAgICAgYW5kIHRoZSBvbkNvbXBsZXRlIGNhbGxiYWNrIHdpbGwgYmUgZmlyZWQgb25jZSB0aGUgYW5pbWF0aW9uIGlzIGZ1bGx5IGNvbXBsZXRlLlxuICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIHBlcmZvcm1BbmltYXRpb24oYW5pbWF0aW9uRXZlbnQsIGNsYXNzTmFtZSwgZWxlbWVudCwgcGFyZW50RWxlbWVudCwgYWZ0ZXJFbGVtZW50LCBkb21PcGVyYXRpb24sIG9wdGlvbnMsIGRvbmVDYWxsYmFjaykge1xuICAgICAgICB2YXIgbm9vcENhbmNlbCA9IG5vb3A7XG4gICAgICAgIHZhciBydW5uZXIgPSBhbmltYXRpb25SdW5uZXIoZWxlbWVudCwgYW5pbWF0aW9uRXZlbnQsIGNsYXNzTmFtZSwgb3B0aW9ucyk7XG4gICAgICAgIGlmICghcnVubmVyKSB7XG4gICAgICAgICAgZmlyZURPTU9wZXJhdGlvbigpO1xuICAgICAgICAgIGZpcmVCZWZvcmVDYWxsYmFja0FzeW5jKCk7XG4gICAgICAgICAgZmlyZUFmdGVyQ2FsbGJhY2tBc3luYygpO1xuICAgICAgICAgIGNsb3NlQW5pbWF0aW9uKCk7XG4gICAgICAgICAgcmV0dXJuIG5vb3BDYW5jZWw7XG4gICAgICAgIH1cblxuICAgICAgICBhbmltYXRpb25FdmVudCA9IHJ1bm5lci5ldmVudDtcbiAgICAgICAgY2xhc3NOYW1lID0gcnVubmVyLmNsYXNzTmFtZTtcbiAgICAgICAgdmFyIGVsZW1lbnRFdmVudHMgPSBhbmd1bGFyLmVsZW1lbnQuX2RhdGEocnVubmVyLm5vZGUpO1xuICAgICAgICBlbGVtZW50RXZlbnRzID0gZWxlbWVudEV2ZW50cyAmJiBlbGVtZW50RXZlbnRzLmV2ZW50cztcblxuICAgICAgICBpZiAoIXBhcmVudEVsZW1lbnQpIHtcbiAgICAgICAgICBwYXJlbnRFbGVtZW50ID0gYWZ0ZXJFbGVtZW50ID8gYWZ0ZXJFbGVtZW50LnBhcmVudCgpIDogZWxlbWVudC5wYXJlbnQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vc2tpcCB0aGUgYW5pbWF0aW9uIGlmIGFuaW1hdGlvbnMgYXJlIGRpc2FibGVkLCBhIHBhcmVudCBpcyBhbHJlYWR5IGJlaW5nIGFuaW1hdGVkLFxuICAgICAgICAvL3RoZSBlbGVtZW50IGlzIG5vdCBjdXJyZW50bHkgYXR0YWNoZWQgdG8gdGhlIGRvY3VtZW50IGJvZHkgb3IgdGhlbiBjb21wbGV0ZWx5IGNsb3NlXG4gICAgICAgIC8vdGhlIGFuaW1hdGlvbiBpZiBhbnkgbWF0Y2hpbmcgYW5pbWF0aW9ucyBhcmUgbm90IGZvdW5kIGF0IGFsbC5cbiAgICAgICAgLy9OT1RFOiBJRTggKyBJRTkgc2hvdWxkIGNsb3NlIHByb3Blcmx5IChydW4gY2xvc2VBbmltYXRpb24oKSkgaW4gY2FzZSBhbiBhbmltYXRpb24gd2FzIGZvdW5kLlxuICAgICAgICBpZiAoYW5pbWF0aW9uc0Rpc2FibGVkKGVsZW1lbnQsIHBhcmVudEVsZW1lbnQpKSB7XG4gICAgICAgICAgZmlyZURPTU9wZXJhdGlvbigpO1xuICAgICAgICAgIGZpcmVCZWZvcmVDYWxsYmFja0FzeW5jKCk7XG4gICAgICAgICAgZmlyZUFmdGVyQ2FsbGJhY2tBc3luYygpO1xuICAgICAgICAgIGNsb3NlQW5pbWF0aW9uKCk7XG4gICAgICAgICAgcmV0dXJuIG5vb3BDYW5jZWw7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgbmdBbmltYXRlU3RhdGUgID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUpIHx8IHt9O1xuICAgICAgICB2YXIgcnVubmluZ0FuaW1hdGlvbnMgICAgID0gbmdBbmltYXRlU3RhdGUuYWN0aXZlIHx8IHt9O1xuICAgICAgICB2YXIgdG90YWxBY3RpdmVBbmltYXRpb25zID0gbmdBbmltYXRlU3RhdGUudG90YWxBY3RpdmUgfHwgMDtcbiAgICAgICAgdmFyIGxhc3RBbmltYXRpb24gICAgICAgICA9IG5nQW5pbWF0ZVN0YXRlLmxhc3Q7XG4gICAgICAgIHZhciBza2lwQW5pbWF0aW9uID0gZmFsc2U7XG5cbiAgICAgICAgaWYgKHRvdGFsQWN0aXZlQW5pbWF0aW9ucyA+IDApIHtcbiAgICAgICAgICB2YXIgYW5pbWF0aW9uc1RvQ2FuY2VsID0gW107XG4gICAgICAgICAgaWYgKCFydW5uZXIuaXNDbGFzc0Jhc2VkKSB7XG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9uRXZlbnQgPT0gJ2xlYXZlJyAmJiBydW5uaW5nQW5pbWF0aW9uc1snbmctbGVhdmUnXSkge1xuICAgICAgICAgICAgICBza2lwQW5pbWF0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIC8vY2FuY2VsIGFsbCBhbmltYXRpb25zIHdoZW4gYSBzdHJ1Y3R1cmFsIGFuaW1hdGlvbiB0YWtlcyBwbGFjZVxuICAgICAgICAgICAgICBmb3IgKHZhciBrbGFzcyBpbiBydW5uaW5nQW5pbWF0aW9ucykge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbnNUb0NhbmNlbC5wdXNoKHJ1bm5pbmdBbmltYXRpb25zW2tsYXNzXSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgbmdBbmltYXRlU3RhdGUgPSB7fTtcbiAgICAgICAgICAgICAgY2xlYW51cChlbGVtZW50LCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2UgaWYgKGxhc3RBbmltYXRpb24uZXZlbnQgPT0gJ3NldENsYXNzJykge1xuICAgICAgICAgICAgYW5pbWF0aW9uc1RvQ2FuY2VsLnB1c2gobGFzdEFuaW1hdGlvbik7XG4gICAgICAgICAgICBjbGVhbnVwKGVsZW1lbnQsIGNsYXNzTmFtZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYgKHJ1bm5pbmdBbmltYXRpb25zW2NsYXNzTmFtZV0pIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50ID0gcnVubmluZ0FuaW1hdGlvbnNbY2xhc3NOYW1lXTtcbiAgICAgICAgICAgIGlmIChjdXJyZW50LmV2ZW50ID09IGFuaW1hdGlvbkV2ZW50KSB7XG4gICAgICAgICAgICAgIHNraXBBbmltYXRpb24gPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgYW5pbWF0aW9uc1RvQ2FuY2VsLnB1c2goY3VycmVudCk7XG4gICAgICAgICAgICAgIGNsZWFudXAoZWxlbWVudCwgY2xhc3NOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoYW5pbWF0aW9uc1RvQ2FuY2VsLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZvckVhY2goYW5pbWF0aW9uc1RvQ2FuY2VsLCBmdW5jdGlvbihvcGVyYXRpb24pIHtcbiAgICAgICAgICAgICAgb3BlcmF0aW9uLmNhbmNlbCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHJ1bm5lci5pc0NsYXNzQmFzZWRcbiAgICAgICAgICAgICYmICFydW5uZXIuaXNTZXRDbGFzc09wZXJhdGlvblxuICAgICAgICAgICAgJiYgYW5pbWF0aW9uRXZlbnQgIT0gJ2FuaW1hdGUnXG4gICAgICAgICAgICAmJiAhc2tpcEFuaW1hdGlvbikge1xuICAgICAgICAgIHNraXBBbmltYXRpb24gPSAoYW5pbWF0aW9uRXZlbnQgPT0gJ2FkZENsYXNzJykgPT0gZWxlbWVudC5oYXNDbGFzcyhjbGFzc05hbWUpOyAvL29wcG9zaXRlIG9mIFhPUlxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHNraXBBbmltYXRpb24pIHtcbiAgICAgICAgICBmaXJlRE9NT3BlcmF0aW9uKCk7XG4gICAgICAgICAgZmlyZUJlZm9yZUNhbGxiYWNrQXN5bmMoKTtcbiAgICAgICAgICBmaXJlQWZ0ZXJDYWxsYmFja0FzeW5jKCk7XG4gICAgICAgICAgZmlyZURvbmVDYWxsYmFja0FzeW5jKCk7XG4gICAgICAgICAgcmV0dXJuIG5vb3BDYW5jZWw7XG4gICAgICAgIH1cblxuICAgICAgICBydW5uaW5nQW5pbWF0aW9ucyAgICAgPSBuZ0FuaW1hdGVTdGF0ZS5hY3RpdmUgfHwge307XG4gICAgICAgIHRvdGFsQWN0aXZlQW5pbWF0aW9ucyA9IG5nQW5pbWF0ZVN0YXRlLnRvdGFsQWN0aXZlIHx8IDA7XG5cbiAgICAgICAgaWYgKGFuaW1hdGlvbkV2ZW50ID09ICdsZWF2ZScpIHtcbiAgICAgICAgICAvL3RoZXJlJ3Mgbm8gbmVlZCB0byBldmVyIHJlbW92ZSB0aGUgbGlzdGVuZXIgc2luY2UgdGhlIGVsZW1lbnRcbiAgICAgICAgICAvL3dpbGwgYmUgcmVtb3ZlZCAoZGVzdHJveWVkKSBhZnRlciB0aGUgbGVhdmUgYW5pbWF0aW9uIGVuZHMgb3JcbiAgICAgICAgICAvL2lzIGNhbmNlbGxlZCBtaWR3YXlcbiAgICAgICAgICBlbGVtZW50Lm9uZSgnJGRlc3Ryb3knLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICB2YXIgZWxlbWVudCA9IGFuZ3VsYXIuZWxlbWVudCh0aGlzKTtcbiAgICAgICAgICAgIHZhciBzdGF0ZSA9IGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFKTtcbiAgICAgICAgICAgIGlmIChzdGF0ZSkge1xuICAgICAgICAgICAgICB2YXIgYWN0aXZlTGVhdmVBbmltYXRpb24gPSBzdGF0ZS5hY3RpdmVbJ25nLWxlYXZlJ107XG4gICAgICAgICAgICAgIGlmIChhY3RpdmVMZWF2ZUFuaW1hdGlvbikge1xuICAgICAgICAgICAgICAgIGFjdGl2ZUxlYXZlQW5pbWF0aW9uLmNhbmNlbCgpO1xuICAgICAgICAgICAgICAgIGNsZWFudXAoZWxlbWVudCwgJ25nLWxlYXZlJyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vdGhlIG5nLWFuaW1hdGUgY2xhc3MgZG9lcyBub3RoaW5nLCBidXQgaXQncyBoZXJlIHRvIGFsbG93IGZvclxuICAgICAgICAvL3BhcmVudCBhbmltYXRpb25zIHRvIGZpbmQgYW5kIGNhbmNlbCBjaGlsZCBhbmltYXRpb25zIHdoZW4gbmVlZGVkXG4gICAgICAgICQkanFMaXRlLmFkZENsYXNzKGVsZW1lbnQsIE5HX0FOSU1BVEVfQ0xBU1NfTkFNRSk7XG4gICAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMudGVtcENsYXNzZXMpIHtcbiAgICAgICAgICBmb3JFYWNoKG9wdGlvbnMudGVtcENsYXNzZXMsIGZ1bmN0aW9uKGNsYXNzTmFtZSkge1xuICAgICAgICAgICAgJCRqcUxpdGUuYWRkQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBsb2NhbEFuaW1hdGlvbkNvdW50ID0gZ2xvYmFsQW5pbWF0aW9uQ291bnRlcisrO1xuICAgICAgICB0b3RhbEFjdGl2ZUFuaW1hdGlvbnMrKztcbiAgICAgICAgcnVubmluZ0FuaW1hdGlvbnNbY2xhc3NOYW1lXSA9IHJ1bm5lcjtcblxuICAgICAgICBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSwge1xuICAgICAgICAgIGxhc3Q6IHJ1bm5lcixcbiAgICAgICAgICBhY3RpdmU6IHJ1bm5pbmdBbmltYXRpb25zLFxuICAgICAgICAgIGluZGV4OiBsb2NhbEFuaW1hdGlvbkNvdW50LFxuICAgICAgICAgIHRvdGFsQWN0aXZlOiB0b3RhbEFjdGl2ZUFuaW1hdGlvbnNcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy9maXJzdCB3ZSBydW4gdGhlIGJlZm9yZSBhbmltYXRpb25zIGFuZCB3aGVuIGFsbCBvZiB0aG9zZSBhcmUgY29tcGxldGVcbiAgICAgICAgLy90aGVuIHdlIHBlcmZvcm0gdGhlIERPTSBvcGVyYXRpb24gYW5kIHJ1biB0aGUgbmV4dCBzZXQgb2YgYW5pbWF0aW9uc1xuICAgICAgICBmaXJlQmVmb3JlQ2FsbGJhY2tBc3luYygpO1xuICAgICAgICBydW5uZXIuYmVmb3JlKGZ1bmN0aW9uKGNhbmNlbGxlZCkge1xuICAgICAgICAgIHZhciBkYXRhID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUpO1xuICAgICAgICAgIGNhbmNlbGxlZCA9IGNhbmNlbGxlZCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIWRhdGEgfHwgIWRhdGEuYWN0aXZlW2NsYXNzTmFtZV0gfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIChydW5uZXIuaXNDbGFzc0Jhc2VkICYmIGRhdGEuYWN0aXZlW2NsYXNzTmFtZV0uZXZlbnQgIT0gYW5pbWF0aW9uRXZlbnQpO1xuXG4gICAgICAgICAgZmlyZURPTU9wZXJhdGlvbigpO1xuICAgICAgICAgIGlmIChjYW5jZWxsZWQgPT09IHRydWUpIHtcbiAgICAgICAgICAgIGNsb3NlQW5pbWF0aW9uKCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZpcmVBZnRlckNhbGxiYWNrQXN5bmMoKTtcbiAgICAgICAgICAgIHJ1bm5lci5hZnRlcihjbG9zZUFuaW1hdGlvbik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gcnVubmVyLmNhbmNlbDtcblxuICAgICAgICBmdW5jdGlvbiBmaXJlRE9NQ2FsbGJhY2soYW5pbWF0aW9uUGhhc2UpIHtcbiAgICAgICAgICB2YXIgZXZlbnROYW1lID0gJyRhbmltYXRlOicgKyBhbmltYXRpb25QaGFzZTtcbiAgICAgICAgICBpZiAoZWxlbWVudEV2ZW50cyAmJiBlbGVtZW50RXZlbnRzW2V2ZW50TmFtZV0gJiYgZWxlbWVudEV2ZW50c1tldmVudE5hbWVdLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICQkYXN5bmNDYWxsYmFjayhmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgZWxlbWVudC50cmlnZ2VySGFuZGxlcihldmVudE5hbWUsIHtcbiAgICAgICAgICAgICAgICBldmVudDogYW5pbWF0aW9uRXZlbnQsXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBjbGFzc05hbWVcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBmaXJlQmVmb3JlQ2FsbGJhY2tBc3luYygpIHtcbiAgICAgICAgICBmaXJlRE9NQ2FsbGJhY2soJ2JlZm9yZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZmlyZUFmdGVyQ2FsbGJhY2tBc3luYygpIHtcbiAgICAgICAgICBmaXJlRE9NQ2FsbGJhY2soJ2FmdGVyJyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBmaXJlRG9uZUNhbGxiYWNrQXN5bmMoKSB7XG4gICAgICAgICAgZmlyZURPTUNhbGxiYWNrKCdjbG9zZScpO1xuICAgICAgICAgIGRvbmVDYWxsYmFjaygpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9pdCBpcyBsZXNzIGNvbXBsaWNhdGVkIHRvIHVzZSBhIGZsYWcgdGhhbiBtYW5hZ2luZyBhbmQgY2FuY2VsaW5nXG4gICAgICAgIC8vdGltZW91dHMgY29udGFpbmluZyBtdWx0aXBsZSBjYWxsYmFja3MuXG4gICAgICAgIGZ1bmN0aW9uIGZpcmVET01PcGVyYXRpb24oKSB7XG4gICAgICAgICAgaWYgKCFmaXJlRE9NT3BlcmF0aW9uLmhhc0JlZW5SdW4pIHtcbiAgICAgICAgICAgIGZpcmVET01PcGVyYXRpb24uaGFzQmVlblJ1biA9IHRydWU7XG4gICAgICAgICAgICBkb21PcGVyYXRpb24oKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjbG9zZUFuaW1hdGlvbigpIHtcbiAgICAgICAgICBpZiAoIWNsb3NlQW5pbWF0aW9uLmhhc0JlZW5SdW4pIHtcbiAgICAgICAgICAgIGlmIChydW5uZXIpIHsgLy90aGUgcnVubmVyIGRvZXNuJ3QgZXhpc3QgaWYgaXQgZmFpbHMgdG8gaW5zdGFudGlhdGVcbiAgICAgICAgICAgICAgcnVubmVyLmFwcGx5U3R5bGVzKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNsb3NlQW5pbWF0aW9uLmhhc0JlZW5SdW4gPSB0cnVlO1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy50ZW1wQ2xhc3Nlcykge1xuICAgICAgICAgICAgICBmb3JFYWNoKG9wdGlvbnMudGVtcENsYXNzZXMsIGZ1bmN0aW9uKGNsYXNzTmFtZSkge1xuICAgICAgICAgICAgICAgICQkanFMaXRlLnJlbW92ZUNsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFKTtcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgLyogb25seSBzdHJ1Y3R1cmFsIGFuaW1hdGlvbnMgd2FpdCBmb3IgcmVmbG93IGJlZm9yZSByZW1vdmluZyBhblxuICAgICAgICAgICAgICAgICBhbmltYXRpb24sIGJ1dCBjbGFzcy1iYXNlZCBhbmltYXRpb25zIGRvbid0LiBBbiBleGFtcGxlIG9mIHRoaXNcbiAgICAgICAgICAgICAgICAgZmFpbGluZyB3b3VsZCBiZSB3aGVuIGEgcGFyZW50IEhUTUwgdGFnIGhhcyBhIG5nLWNsYXNzIGF0dHJpYnV0ZVxuICAgICAgICAgICAgICAgICBjYXVzaW5nIEFMTCBkaXJlY3RpdmVzIGJlbG93IHRvIHNraXAgYW5pbWF0aW9ucyBkdXJpbmcgdGhlIGRpZ2VzdCAqL1xuICAgICAgICAgICAgICBpZiAocnVubmVyICYmIHJ1bm5lci5pc0NsYXNzQmFzZWQpIHtcbiAgICAgICAgICAgICAgICBjbGVhbnVwKGVsZW1lbnQsIGNsYXNzTmFtZSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJCRhc3luY0NhbGxiYWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSkgfHwge307XG4gICAgICAgICAgICAgICAgICBpZiAobG9jYWxBbmltYXRpb25Db3VudCA9PSBkYXRhLmluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFudXAoZWxlbWVudCwgY2xhc3NOYW1lLCBhbmltYXRpb25FdmVudCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUsIGRhdGEpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaXJlRG9uZUNhbGxiYWNrQXN5bmMoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gY2FuY2VsQ2hpbGRBbmltYXRpb25zKGVsZW1lbnQpIHtcbiAgICAgICAgdmFyIG5vZGUgPSBleHRyYWN0RWxlbWVudE5vZGUoZWxlbWVudCk7XG4gICAgICAgIGlmIChub2RlKSB7XG4gICAgICAgICAgdmFyIG5vZGVzID0gYW5ndWxhci5pc0Z1bmN0aW9uKG5vZGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSkgP1xuICAgICAgICAgICAgbm9kZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKE5HX0FOSU1BVEVfQ0xBU1NfTkFNRSkgOlxuICAgICAgICAgICAgbm9kZS5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIE5HX0FOSU1BVEVfQ0xBU1NfTkFNRSk7XG4gICAgICAgICAgZm9yRWFjaChub2RlcywgZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgICAgICAgZWxlbWVudCA9IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50KTtcbiAgICAgICAgICAgIHZhciBkYXRhID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUpO1xuICAgICAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5hY3RpdmUpIHtcbiAgICAgICAgICAgICAgZm9yRWFjaChkYXRhLmFjdGl2ZSwgZnVuY3Rpb24ocnVubmVyKSB7XG4gICAgICAgICAgICAgICAgcnVubmVyLmNhbmNlbCgpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBjbGVhbnVwKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xuICAgICAgICBpZiAoaXNNYXRjaGluZ0VsZW1lbnQoZWxlbWVudCwgJHJvb3RFbGVtZW50KSkge1xuICAgICAgICAgIGlmICghcm9vdEFuaW1hdGVTdGF0ZS5kaXNhYmxlZCkge1xuICAgICAgICAgICAgcm9vdEFuaW1hdGVTdGF0ZS5ydW5uaW5nID0gZmFsc2U7XG4gICAgICAgICAgICByb290QW5pbWF0ZVN0YXRlLnN0cnVjdHVyYWwgPSBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoY2xhc3NOYW1lKSB7XG4gICAgICAgICAgdmFyIGRhdGEgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSkgfHwge307XG5cbiAgICAgICAgICB2YXIgcmVtb3ZlQW5pbWF0aW9ucyA9IGNsYXNzTmFtZSA9PT0gdHJ1ZTtcbiAgICAgICAgICBpZiAoIXJlbW92ZUFuaW1hdGlvbnMgJiYgZGF0YS5hY3RpdmUgJiYgZGF0YS5hY3RpdmVbY2xhc3NOYW1lXSkge1xuICAgICAgICAgICAgZGF0YS50b3RhbEFjdGl2ZS0tO1xuICAgICAgICAgICAgZGVsZXRlIGRhdGEuYWN0aXZlW2NsYXNzTmFtZV07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHJlbW92ZUFuaW1hdGlvbnMgfHwgIWRhdGEudG90YWxBY3RpdmUpIHtcbiAgICAgICAgICAgICQkanFMaXRlLnJlbW92ZUNsYXNzKGVsZW1lbnQsIE5HX0FOSU1BVEVfQ0xBU1NfTkFNRSk7XG4gICAgICAgICAgICBlbGVtZW50LnJlbW92ZURhdGEoTkdfQU5JTUFURV9TVEFURSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGFuaW1hdGlvbnNEaXNhYmxlZChlbGVtZW50LCBwYXJlbnRFbGVtZW50KSB7XG4gICAgICAgIGlmIChyb290QW5pbWF0ZVN0YXRlLmRpc2FibGVkKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaXNNYXRjaGluZ0VsZW1lbnQoZWxlbWVudCwgJHJvb3RFbGVtZW50KSkge1xuICAgICAgICAgIHJldHVybiByb290QW5pbWF0ZVN0YXRlLnJ1bm5pbmc7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgYWxsb3dDaGlsZEFuaW1hdGlvbnMsIHBhcmVudFJ1bm5pbmdBbmltYXRpb24sIGhhc1BhcmVudDtcbiAgICAgICAgZG8ge1xuICAgICAgICAgIC8vdGhlIGVsZW1lbnQgZGlkIG5vdCByZWFjaCB0aGUgcm9vdCBlbGVtZW50IHdoaWNoIG1lYW5zIHRoYXQgaXRcbiAgICAgICAgICAvL2lzIG5vdCBhcGFydCBvZiB0aGUgRE9NLiBUaGVyZWZvcmUgdGhlcmUgaXMgbm8gcmVhc29uIHRvIGRvXG4gICAgICAgICAgLy9hbnkgYW5pbWF0aW9ucyBvbiBpdFxuICAgICAgICAgIGlmIChwYXJlbnRFbGVtZW50Lmxlbmd0aCA9PT0gMCkgYnJlYWs7XG5cbiAgICAgICAgICB2YXIgaXNSb290ID0gaXNNYXRjaGluZ0VsZW1lbnQocGFyZW50RWxlbWVudCwgJHJvb3RFbGVtZW50KTtcbiAgICAgICAgICB2YXIgc3RhdGUgPSBpc1Jvb3QgPyByb290QW5pbWF0ZVN0YXRlIDogKHBhcmVudEVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFKSB8fCB7fSk7XG4gICAgICAgICAgaWYgKHN0YXRlLmRpc2FibGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvL25vIG1hdHRlciB3aGF0LCBmb3IgYW4gYW5pbWF0aW9uIHRvIHdvcmsgaXQgbXVzdCByZWFjaCB0aGUgcm9vdCBlbGVtZW50XG4gICAgICAgICAgLy90aGlzIGltcGxpZXMgdGhhdCB0aGUgZWxlbWVudCBpcyBhdHRhY2hlZCB0byB0aGUgRE9NIHdoZW4gdGhlIGFuaW1hdGlvbiBpcyBydW5cbiAgICAgICAgICBpZiAoaXNSb290KSB7XG4gICAgICAgICAgICBoYXNQYXJlbnQgPSB0cnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vb25jZSBhIGZsYWcgaXMgZm91bmQgdGhhdCBpcyBzdHJpY3RseSBmYWxzZSB0aGVuIGV2ZXJ5dGhpbmcgYmVmb3JlXG4gICAgICAgICAgLy9pdCB3aWxsIGJlIGRpc2NhcmRlZCBhbmQgYWxsIGNoaWxkIGFuaW1hdGlvbnMgd2lsbCBiZSByZXN0cmljdGVkXG4gICAgICAgICAgaWYgKGFsbG93Q2hpbGRBbmltYXRpb25zICE9PSBmYWxzZSkge1xuICAgICAgICAgICAgdmFyIGFuaW1hdGVDaGlsZHJlbkZsYWcgPSBwYXJlbnRFbGVtZW50LmRhdGEoTkdfQU5JTUFURV9DSElMRFJFTik7XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoYW5pbWF0ZUNoaWxkcmVuRmxhZykpIHtcbiAgICAgICAgICAgICAgYWxsb3dDaGlsZEFuaW1hdGlvbnMgPSBhbmltYXRlQ2hpbGRyZW5GbGFnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHBhcmVudFJ1bm5pbmdBbmltYXRpb24gPSBwYXJlbnRSdW5uaW5nQW5pbWF0aW9uIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLnJ1bm5pbmcgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHN0YXRlLmxhc3QgJiYgIXN0YXRlLmxhc3QuaXNDbGFzc0Jhc2VkKTtcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAocGFyZW50RWxlbWVudCA9IHBhcmVudEVsZW1lbnQucGFyZW50KCkpO1xuXG4gICAgICAgIHJldHVybiAhaGFzUGFyZW50IHx8ICghYWxsb3dDaGlsZEFuaW1hdGlvbnMgJiYgcGFyZW50UnVubmluZ0FuaW1hdGlvbik7XG4gICAgICB9XG4gICAgfV0pO1xuXG4gICAgJGFuaW1hdGVQcm92aWRlci5yZWdpc3RlcignJywgWyckd2luZG93JywgJyRzbmlmZmVyJywgJyR0aW1lb3V0JywgJyQkYW5pbWF0ZVJlZmxvdycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbigkd2luZG93LCAgICRzbmlmZmVyLCAgICR0aW1lb3V0LCAgICQkYW5pbWF0ZVJlZmxvdykge1xuICAgICAgLy8gRGV0ZWN0IHByb3BlciB0cmFuc2l0aW9uZW5kL2FuaW1hdGlvbmVuZCBldmVudCBuYW1lcy5cbiAgICAgIHZhciBDU1NfUFJFRklYID0gJycsIFRSQU5TSVRJT05fUFJPUCwgVFJBTlNJVElPTkVORF9FVkVOVCwgQU5JTUFUSU9OX1BST1AsIEFOSU1BVElPTkVORF9FVkVOVDtcblxuICAgICAgLy8gSWYgdW5wcmVmaXhlZCBldmVudHMgYXJlIG5vdCBzdXBwb3J0ZWQgYnV0IHdlYmtpdC1wcmVmaXhlZCBhcmUsIHVzZSB0aGUgbGF0dGVyLlxuICAgICAgLy8gT3RoZXJ3aXNlLCBqdXN0IHVzZSBXM0MgbmFtZXMsIGJyb3dzZXJzIG5vdCBzdXBwb3J0aW5nIHRoZW0gYXQgYWxsIHdpbGwganVzdCBpZ25vcmUgdGhlbS5cbiAgICAgIC8vIE5vdGU6IENocm9tZSBpbXBsZW1lbnRzIGB3aW5kb3cub253ZWJraXRhbmltYXRpb25lbmRgIGFuZCBkb2Vzbid0IGltcGxlbWVudCBgd2luZG93Lm9uYW5pbWF0aW9uZW5kYFxuICAgICAgLy8gYnV0IGF0IHRoZSBzYW1lIHRpbWUgZGlzcGF0Y2hlcyB0aGUgYGFuaW1hdGlvbmVuZGAgZXZlbnQgYW5kIG5vdCBgd2Via2l0QW5pbWF0aW9uRW5kYC5cbiAgICAgIC8vIFJlZ2lzdGVyIGJvdGggZXZlbnRzIGluIGNhc2UgYHdpbmRvdy5vbmFuaW1hdGlvbmVuZGAgaXMgbm90IHN1cHBvcnRlZCBiZWNhdXNlIG9mIHRoYXQsXG4gICAgICAvLyBkbyB0aGUgc2FtZSBmb3IgYHRyYW5zaXRpb25lbmRgIGFzIFNhZmFyaSBpcyBsaWtlbHkgdG8gZXhoaWJpdCBzaW1pbGFyIGJlaGF2aW9yLlxuICAgICAgLy8gQWxzbywgdGhlIG9ubHkgbW9kZXJuIGJyb3dzZXIgdGhhdCB1c2VzIHZlbmRvciBwcmVmaXhlcyBmb3IgdHJhbnNpdGlvbnMva2V5ZnJhbWVzIGlzIHdlYmtpdFxuICAgICAgLy8gdGhlcmVmb3JlIHRoZXJlIGlzIG5vIHJlYXNvbiB0byB0ZXN0IGFueW1vcmUgZm9yIG90aGVyIHZlbmRvciBwcmVmaXhlczogaHR0cDovL2Nhbml1c2UuY29tLyNzZWFyY2g9dHJhbnNpdGlvblxuICAgICAgaWYgKHdpbmRvdy5vbnRyYW5zaXRpb25lbmQgPT09IHVuZGVmaW5lZCAmJiB3aW5kb3cub253ZWJraXR0cmFuc2l0aW9uZW5kICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgQ1NTX1BSRUZJWCA9ICctd2Via2l0LSc7XG4gICAgICAgIFRSQU5TSVRJT05fUFJPUCA9ICdXZWJraXRUcmFuc2l0aW9uJztcbiAgICAgICAgVFJBTlNJVElPTkVORF9FVkVOVCA9ICd3ZWJraXRUcmFuc2l0aW9uRW5kIHRyYW5zaXRpb25lbmQnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgVFJBTlNJVElPTl9QUk9QID0gJ3RyYW5zaXRpb24nO1xuICAgICAgICBUUkFOU0lUSU9ORU5EX0VWRU5UID0gJ3RyYW5zaXRpb25lbmQnO1xuICAgICAgfVxuXG4gICAgICBpZiAod2luZG93Lm9uYW5pbWF0aW9uZW5kID09PSB1bmRlZmluZWQgJiYgd2luZG93Lm9ud2Via2l0YW5pbWF0aW9uZW5kICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgQ1NTX1BSRUZJWCA9ICctd2Via2l0LSc7XG4gICAgICAgIEFOSU1BVElPTl9QUk9QID0gJ1dlYmtpdEFuaW1hdGlvbic7XG4gICAgICAgIEFOSU1BVElPTkVORF9FVkVOVCA9ICd3ZWJraXRBbmltYXRpb25FbmQgYW5pbWF0aW9uZW5kJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIEFOSU1BVElPTl9QUk9QID0gJ2FuaW1hdGlvbic7XG4gICAgICAgIEFOSU1BVElPTkVORF9FVkVOVCA9ICdhbmltYXRpb25lbmQnO1xuICAgICAgfVxuXG4gICAgICB2YXIgRFVSQVRJT05fS0VZID0gJ0R1cmF0aW9uJztcbiAgICAgIHZhciBQUk9QRVJUWV9LRVkgPSAnUHJvcGVydHknO1xuICAgICAgdmFyIERFTEFZX0tFWSA9ICdEZWxheSc7XG4gICAgICB2YXIgQU5JTUFUSU9OX0lURVJBVElPTl9DT1VOVF9LRVkgPSAnSXRlcmF0aW9uQ291bnQnO1xuICAgICAgdmFyIEFOSU1BVElPTl9QTEFZU1RBVEVfS0VZID0gJ1BsYXlTdGF0ZSc7XG4gICAgICB2YXIgTkdfQU5JTUFURV9QQVJFTlRfS0VZID0gJyQkbmdBbmltYXRlS2V5JztcbiAgICAgIHZhciBOR19BTklNQVRFX0NTU19EQVRBX0tFWSA9ICckJG5nQW5pbWF0ZUNTUzNEYXRhJztcbiAgICAgIHZhciBFTEFQU0VEX1RJTUVfTUFYX0RFQ0lNQUxfUExBQ0VTID0gMztcbiAgICAgIHZhciBDTE9TSU5HX1RJTUVfQlVGRkVSID0gMS41O1xuICAgICAgdmFyIE9ORV9TRUNPTkQgPSAxMDAwO1xuXG4gICAgICB2YXIgbG9va3VwQ2FjaGUgPSB7fTtcbiAgICAgIHZhciBwYXJlbnRDb3VudGVyID0gMDtcbiAgICAgIHZhciBhbmltYXRpb25SZWZsb3dRdWV1ZSA9IFtdO1xuICAgICAgdmFyIGNhbmNlbEFuaW1hdGlvblJlZmxvdztcbiAgICAgIGZ1bmN0aW9uIGNsZWFyQ2FjaGVBZnRlclJlZmxvdygpIHtcbiAgICAgICAgaWYgKCFjYW5jZWxBbmltYXRpb25SZWZsb3cpIHtcbiAgICAgICAgICBjYW5jZWxBbmltYXRpb25SZWZsb3cgPSAkJGFuaW1hdGVSZWZsb3coZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBhbmltYXRpb25SZWZsb3dRdWV1ZSA9IFtdO1xuICAgICAgICAgICAgY2FuY2VsQW5pbWF0aW9uUmVmbG93ID0gbnVsbDtcbiAgICAgICAgICAgIGxvb2t1cENhY2hlID0ge307XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gYWZ0ZXJSZWZsb3coZWxlbWVudCwgY2FsbGJhY2spIHtcbiAgICAgICAgaWYgKGNhbmNlbEFuaW1hdGlvblJlZmxvdykge1xuICAgICAgICAgIGNhbmNlbEFuaW1hdGlvblJlZmxvdygpO1xuICAgICAgICB9XG4gICAgICAgIGFuaW1hdGlvblJlZmxvd1F1ZXVlLnB1c2goY2FsbGJhY2spO1xuICAgICAgICBjYW5jZWxBbmltYXRpb25SZWZsb3cgPSAkJGFuaW1hdGVSZWZsb3coZnVuY3Rpb24oKSB7XG4gICAgICAgICAgZm9yRWFjaChhbmltYXRpb25SZWZsb3dRdWV1ZSwgZnVuY3Rpb24oZm4pIHtcbiAgICAgICAgICAgIGZuKCk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBhbmltYXRpb25SZWZsb3dRdWV1ZSA9IFtdO1xuICAgICAgICAgIGNhbmNlbEFuaW1hdGlvblJlZmxvdyA9IG51bGw7XG4gICAgICAgICAgbG9va3VwQ2FjaGUgPSB7fTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHZhciBjbG9zaW5nVGltZXIgPSBudWxsO1xuICAgICAgdmFyIGNsb3NpbmdUaW1lc3RhbXAgPSAwO1xuICAgICAgdmFyIGFuaW1hdGlvbkVsZW1lbnRRdWV1ZSA9IFtdO1xuICAgICAgZnVuY3Rpb24gYW5pbWF0aW9uQ2xvc2VIYW5kbGVyKGVsZW1lbnQsIHRvdGFsVGltZSkge1xuICAgICAgICB2YXIgbm9kZSA9IGV4dHJhY3RFbGVtZW50Tm9kZShlbGVtZW50KTtcbiAgICAgICAgZWxlbWVudCA9IGFuZ3VsYXIuZWxlbWVudChub2RlKTtcblxuICAgICAgICAvL3RoaXMgaXRlbSB3aWxsIGJlIGdhcmJhZ2UgY29sbGVjdGVkIGJ5IHRoZSBjbG9zaW5nXG4gICAgICAgIC8vYW5pbWF0aW9uIHRpbWVvdXRcbiAgICAgICAgYW5pbWF0aW9uRWxlbWVudFF1ZXVlLnB1c2goZWxlbWVudCk7XG5cbiAgICAgICAgLy9idXQgaXQgbWF5IG5vdCBuZWVkIHRvIGNhbmNlbCBvdXQgdGhlIGV4aXN0aW5nIHRpbWVvdXRcbiAgICAgICAgLy9pZiB0aGUgdGltZXN0YW1wIGlzIGxlc3MgdGhhbiB0aGUgcHJldmlvdXMgb25lXG4gICAgICAgIHZhciBmdXR1cmVUaW1lc3RhbXAgPSBEYXRlLm5vdygpICsgdG90YWxUaW1lO1xuICAgICAgICBpZiAoZnV0dXJlVGltZXN0YW1wIDw9IGNsb3NpbmdUaW1lc3RhbXApIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAkdGltZW91dC5jYW5jZWwoY2xvc2luZ1RpbWVyKTtcblxuICAgICAgICBjbG9zaW5nVGltZXN0YW1wID0gZnV0dXJlVGltZXN0YW1wO1xuICAgICAgICBjbG9zaW5nVGltZXIgPSAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICBjbG9zZUFsbEFuaW1hdGlvbnMoYW5pbWF0aW9uRWxlbWVudFF1ZXVlKTtcbiAgICAgICAgICBhbmltYXRpb25FbGVtZW50UXVldWUgPSBbXTtcbiAgICAgICAgfSwgdG90YWxUaW1lLCBmYWxzZSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGNsb3NlQWxsQW5pbWF0aW9ucyhlbGVtZW50cykge1xuICAgICAgICBmb3JFYWNoKGVsZW1lbnRzLCBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgICAgdmFyIGVsZW1lbnREYXRhID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfQ1NTX0RBVEFfS0VZKTtcbiAgICAgICAgICBpZiAoZWxlbWVudERhdGEpIHtcbiAgICAgICAgICAgIGZvckVhY2goZWxlbWVudERhdGEuY2xvc2VBbmltYXRpb25GbnMsIGZ1bmN0aW9uKGZuKSB7XG4gICAgICAgICAgICAgIGZuKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBnZXRFbGVtZW50QW5pbWF0aW9uRGV0YWlscyhlbGVtZW50LCBjYWNoZUtleSkge1xuICAgICAgICB2YXIgZGF0YSA9IGNhY2hlS2V5ID8gbG9va3VwQ2FjaGVbY2FjaGVLZXldIDogbnVsbDtcbiAgICAgICAgaWYgKCFkYXRhKSB7XG4gICAgICAgICAgdmFyIHRyYW5zaXRpb25EdXJhdGlvbiA9IDA7XG4gICAgICAgICAgdmFyIHRyYW5zaXRpb25EZWxheSA9IDA7XG4gICAgICAgICAgdmFyIGFuaW1hdGlvbkR1cmF0aW9uID0gMDtcbiAgICAgICAgICB2YXIgYW5pbWF0aW9uRGVsYXkgPSAwO1xuXG4gICAgICAgICAgLy93ZSB3YW50IGFsbCB0aGUgc3R5bGVzIGRlZmluZWQgYmVmb3JlIGFuZCBhZnRlclxuICAgICAgICAgIGZvckVhY2goZWxlbWVudCwgZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgICAgICAgaWYgKGVsZW1lbnQubm9kZVR5cGUgPT0gRUxFTUVOVF9OT0RFKSB7XG4gICAgICAgICAgICAgIHZhciBlbGVtZW50U3R5bGVzID0gJHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpIHx8IHt9O1xuXG4gICAgICAgICAgICAgIHZhciB0cmFuc2l0aW9uRHVyYXRpb25TdHlsZSA9IGVsZW1lbnRTdHlsZXNbVFJBTlNJVElPTl9QUk9QICsgRFVSQVRJT05fS0VZXTtcbiAgICAgICAgICAgICAgdHJhbnNpdGlvbkR1cmF0aW9uID0gTWF0aC5tYXgocGFyc2VNYXhUaW1lKHRyYW5zaXRpb25EdXJhdGlvblN0eWxlKSwgdHJhbnNpdGlvbkR1cmF0aW9uKTtcblxuICAgICAgICAgICAgICB2YXIgdHJhbnNpdGlvbkRlbGF5U3R5bGUgPSBlbGVtZW50U3R5bGVzW1RSQU5TSVRJT05fUFJPUCArIERFTEFZX0tFWV07XG4gICAgICAgICAgICAgIHRyYW5zaXRpb25EZWxheSAgPSBNYXRoLm1heChwYXJzZU1heFRpbWUodHJhbnNpdGlvbkRlbGF5U3R5bGUpLCB0cmFuc2l0aW9uRGVsYXkpO1xuXG4gICAgICAgICAgICAgIHZhciBhbmltYXRpb25EZWxheVN0eWxlID0gZWxlbWVudFN0eWxlc1tBTklNQVRJT05fUFJPUCArIERFTEFZX0tFWV07XG4gICAgICAgICAgICAgIGFuaW1hdGlvbkRlbGF5ICAgPSBNYXRoLm1heChwYXJzZU1heFRpbWUoZWxlbWVudFN0eWxlc1tBTklNQVRJT05fUFJPUCArIERFTEFZX0tFWV0pLCBhbmltYXRpb25EZWxheSk7XG5cbiAgICAgICAgICAgICAgdmFyIGFEdXJhdGlvbiAgPSBwYXJzZU1heFRpbWUoZWxlbWVudFN0eWxlc1tBTklNQVRJT05fUFJPUCArIERVUkFUSU9OX0tFWV0pO1xuXG4gICAgICAgICAgICAgIGlmIChhRHVyYXRpb24gPiAwKSB7XG4gICAgICAgICAgICAgICAgYUR1cmF0aW9uICo9IHBhcnNlSW50KGVsZW1lbnRTdHlsZXNbQU5JTUFUSU9OX1BST1AgKyBBTklNQVRJT05fSVRFUkFUSU9OX0NPVU5UX0tFWV0sIDEwKSB8fCAxO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGFuaW1hdGlvbkR1cmF0aW9uID0gTWF0aC5tYXgoYUR1cmF0aW9uLCBhbmltYXRpb25EdXJhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZGF0YSA9IHtcbiAgICAgICAgICAgIHRvdGFsOiAwLFxuICAgICAgICAgICAgdHJhbnNpdGlvbkRlbGF5OiB0cmFuc2l0aW9uRGVsYXksXG4gICAgICAgICAgICB0cmFuc2l0aW9uRHVyYXRpb246IHRyYW5zaXRpb25EdXJhdGlvbixcbiAgICAgICAgICAgIGFuaW1hdGlvbkRlbGF5OiBhbmltYXRpb25EZWxheSxcbiAgICAgICAgICAgIGFuaW1hdGlvbkR1cmF0aW9uOiBhbmltYXRpb25EdXJhdGlvblxuICAgICAgICAgIH07XG4gICAgICAgICAgaWYgKGNhY2hlS2V5KSB7XG4gICAgICAgICAgICBsb29rdXBDYWNoZVtjYWNoZUtleV0gPSBkYXRhO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gcGFyc2VNYXhUaW1lKHN0cikge1xuICAgICAgICB2YXIgbWF4VmFsdWUgPSAwO1xuICAgICAgICB2YXIgdmFsdWVzID0gaXNTdHJpbmcoc3RyKSA/XG4gICAgICAgICAgc3RyLnNwbGl0KC9cXHMqLFxccyovKSA6XG4gICAgICAgICAgW107XG4gICAgICAgIGZvckVhY2godmFsdWVzLCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgIG1heFZhbHVlID0gTWF0aC5tYXgocGFyc2VGbG9hdCh2YWx1ZSkgfHwgMCwgbWF4VmFsdWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG1heFZhbHVlO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBnZXRDYWNoZUtleShlbGVtZW50KSB7XG4gICAgICAgIHZhciBwYXJlbnRFbGVtZW50ID0gZWxlbWVudC5wYXJlbnQoKTtcbiAgICAgICAgdmFyIHBhcmVudElEID0gcGFyZW50RWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfUEFSRU5UX0tFWSk7XG4gICAgICAgIGlmICghcGFyZW50SUQpIHtcbiAgICAgICAgICBwYXJlbnRFbGVtZW50LmRhdGEoTkdfQU5JTUFURV9QQVJFTlRfS0VZLCArK3BhcmVudENvdW50ZXIpO1xuICAgICAgICAgIHBhcmVudElEID0gcGFyZW50Q291bnRlcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFyZW50SUQgKyAnLScgKyBleHRyYWN0RWxlbWVudE5vZGUoZWxlbWVudCkuZ2V0QXR0cmlidXRlKCdjbGFzcycpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBhbmltYXRlU2V0dXAoYW5pbWF0aW9uRXZlbnQsIGVsZW1lbnQsIGNsYXNzTmFtZSwgc3R5bGVzKSB7XG4gICAgICAgIHZhciBzdHJ1Y3R1cmFsID0gWyduZy1lbnRlcicsJ25nLWxlYXZlJywnbmctbW92ZSddLmluZGV4T2YoY2xhc3NOYW1lKSA+PSAwO1xuXG4gICAgICAgIHZhciBjYWNoZUtleSA9IGdldENhY2hlS2V5KGVsZW1lbnQpO1xuICAgICAgICB2YXIgZXZlbnRDYWNoZUtleSA9IGNhY2hlS2V5ICsgJyAnICsgY2xhc3NOYW1lO1xuICAgICAgICB2YXIgaXRlbUluZGV4ID0gbG9va3VwQ2FjaGVbZXZlbnRDYWNoZUtleV0gPyArK2xvb2t1cENhY2hlW2V2ZW50Q2FjaGVLZXldLnRvdGFsIDogMDtcblxuICAgICAgICB2YXIgc3RhZ2dlciA9IHt9O1xuICAgICAgICBpZiAoaXRlbUluZGV4ID4gMCkge1xuICAgICAgICAgIHZhciBzdGFnZ2VyQ2xhc3NOYW1lID0gY2xhc3NOYW1lICsgJy1zdGFnZ2VyJztcbiAgICAgICAgICB2YXIgc3RhZ2dlckNhY2hlS2V5ID0gY2FjaGVLZXkgKyAnICcgKyBzdGFnZ2VyQ2xhc3NOYW1lO1xuICAgICAgICAgIHZhciBhcHBseUNsYXNzZXMgPSAhbG9va3VwQ2FjaGVbc3RhZ2dlckNhY2hlS2V5XTtcblxuICAgICAgICAgIGFwcGx5Q2xhc3NlcyAmJiAkJGpxTGl0ZS5hZGRDbGFzcyhlbGVtZW50LCBzdGFnZ2VyQ2xhc3NOYW1lKTtcblxuICAgICAgICAgIHN0YWdnZXIgPSBnZXRFbGVtZW50QW5pbWF0aW9uRGV0YWlscyhlbGVtZW50LCBzdGFnZ2VyQ2FjaGVLZXkpO1xuXG4gICAgICAgICAgYXBwbHlDbGFzc2VzICYmICQkanFMaXRlLnJlbW92ZUNsYXNzKGVsZW1lbnQsIHN0YWdnZXJDbGFzc05hbWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgJCRqcUxpdGUuYWRkQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKTtcblxuICAgICAgICB2YXIgZm9ybWVyRGF0YSA9IGVsZW1lbnQuZGF0YShOR19BTklNQVRFX0NTU19EQVRBX0tFWSkgfHwge307XG4gICAgICAgIHZhciB0aW1pbmdzID0gZ2V0RWxlbWVudEFuaW1hdGlvbkRldGFpbHMoZWxlbWVudCwgZXZlbnRDYWNoZUtleSk7XG4gICAgICAgIHZhciB0cmFuc2l0aW9uRHVyYXRpb24gPSB0aW1pbmdzLnRyYW5zaXRpb25EdXJhdGlvbjtcbiAgICAgICAgdmFyIGFuaW1hdGlvbkR1cmF0aW9uID0gdGltaW5ncy5hbmltYXRpb25EdXJhdGlvbjtcblxuICAgICAgICBpZiAoc3RydWN0dXJhbCAmJiB0cmFuc2l0aW9uRHVyYXRpb24gPT09IDAgJiYgYW5pbWF0aW9uRHVyYXRpb24gPT09IDApIHtcbiAgICAgICAgICAkJGpxTGl0ZS5yZW1vdmVDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUpO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBibG9ja1RyYW5zaXRpb24gPSBzdHlsZXMgfHwgKHN0cnVjdHVyYWwgJiYgdHJhbnNpdGlvbkR1cmF0aW9uID4gMCk7XG4gICAgICAgIHZhciBibG9ja0FuaW1hdGlvbiA9IGFuaW1hdGlvbkR1cmF0aW9uID4gMCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFnZ2VyLmFuaW1hdGlvbkRlbGF5ID4gMCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFnZ2VyLmFuaW1hdGlvbkR1cmF0aW9uID09PSAwO1xuXG4gICAgICAgIHZhciBjbG9zZUFuaW1hdGlvbkZucyA9IGZvcm1lckRhdGEuY2xvc2VBbmltYXRpb25GbnMgfHwgW107XG4gICAgICAgIGVsZW1lbnQuZGF0YShOR19BTklNQVRFX0NTU19EQVRBX0tFWSwge1xuICAgICAgICAgIHN0YWdnZXI6IHN0YWdnZXIsXG4gICAgICAgICAgY2FjaGVLZXk6IGV2ZW50Q2FjaGVLZXksXG4gICAgICAgICAgcnVubmluZzogZm9ybWVyRGF0YS5ydW5uaW5nIHx8IDAsXG4gICAgICAgICAgaXRlbUluZGV4OiBpdGVtSW5kZXgsXG4gICAgICAgICAgYmxvY2tUcmFuc2l0aW9uOiBibG9ja1RyYW5zaXRpb24sXG4gICAgICAgICAgY2xvc2VBbmltYXRpb25GbnM6IGNsb3NlQW5pbWF0aW9uRm5zXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBub2RlID0gZXh0cmFjdEVsZW1lbnROb2RlKGVsZW1lbnQpO1xuXG4gICAgICAgIGlmIChibG9ja1RyYW5zaXRpb24pIHtcbiAgICAgICAgICBibG9ja1RyYW5zaXRpb25zKG5vZGUsIHRydWUpO1xuICAgICAgICAgIGlmIChzdHlsZXMpIHtcbiAgICAgICAgICAgIGVsZW1lbnQuY3NzKHN0eWxlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGJsb2NrQW5pbWF0aW9uKSB7XG4gICAgICAgICAgYmxvY2tBbmltYXRpb25zKG5vZGUsIHRydWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGFuaW1hdGVSdW4oYW5pbWF0aW9uRXZlbnQsIGVsZW1lbnQsIGNsYXNzTmFtZSwgYWN0aXZlQW5pbWF0aW9uQ29tcGxldGUsIHN0eWxlcykge1xuICAgICAgICB2YXIgbm9kZSA9IGV4dHJhY3RFbGVtZW50Tm9kZShlbGVtZW50KTtcbiAgICAgICAgdmFyIGVsZW1lbnREYXRhID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfQ1NTX0RBVEFfS0VZKTtcbiAgICAgICAgaWYgKG5vZGUuZ2V0QXR0cmlidXRlKCdjbGFzcycpLmluZGV4T2YoY2xhc3NOYW1lKSA9PSAtMSB8fCAhZWxlbWVudERhdGEpIHtcbiAgICAgICAgICBhY3RpdmVBbmltYXRpb25Db21wbGV0ZSgpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBhY3RpdmVDbGFzc05hbWUgPSAnJztcbiAgICAgICAgdmFyIHBlbmRpbmdDbGFzc05hbWUgPSAnJztcbiAgICAgICAgZm9yRWFjaChjbGFzc05hbWUuc3BsaXQoJyAnKSwgZnVuY3Rpb24oa2xhc3MsIGkpIHtcbiAgICAgICAgICB2YXIgcHJlZml4ID0gKGkgPiAwID8gJyAnIDogJycpICsga2xhc3M7XG4gICAgICAgICAgYWN0aXZlQ2xhc3NOYW1lICs9IHByZWZpeCArICctYWN0aXZlJztcbiAgICAgICAgICBwZW5kaW5nQ2xhc3NOYW1lICs9IHByZWZpeCArICctcGVuZGluZyc7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBzdHlsZSA9ICcnO1xuICAgICAgICB2YXIgYXBwbGllZFN0eWxlcyA9IFtdO1xuICAgICAgICB2YXIgaXRlbUluZGV4ID0gZWxlbWVudERhdGEuaXRlbUluZGV4O1xuICAgICAgICB2YXIgc3RhZ2dlciA9IGVsZW1lbnREYXRhLnN0YWdnZXI7XG4gICAgICAgIHZhciBzdGFnZ2VyVGltZSA9IDA7XG4gICAgICAgIGlmIChpdGVtSW5kZXggPiAwKSB7XG4gICAgICAgICAgdmFyIHRyYW5zaXRpb25TdGFnZ2VyRGVsYXkgPSAwO1xuICAgICAgICAgIGlmIChzdGFnZ2VyLnRyYW5zaXRpb25EZWxheSA+IDAgJiYgc3RhZ2dlci50cmFuc2l0aW9uRHVyYXRpb24gPT09IDApIHtcbiAgICAgICAgICAgIHRyYW5zaXRpb25TdGFnZ2VyRGVsYXkgPSBzdGFnZ2VyLnRyYW5zaXRpb25EZWxheSAqIGl0ZW1JbmRleDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgYW5pbWF0aW9uU3RhZ2dlckRlbGF5ID0gMDtcbiAgICAgICAgICBpZiAoc3RhZ2dlci5hbmltYXRpb25EZWxheSA+IDAgJiYgc3RhZ2dlci5hbmltYXRpb25EdXJhdGlvbiA9PT0gMCkge1xuICAgICAgICAgICAgYW5pbWF0aW9uU3RhZ2dlckRlbGF5ID0gc3RhZ2dlci5hbmltYXRpb25EZWxheSAqIGl0ZW1JbmRleDtcbiAgICAgICAgICAgIGFwcGxpZWRTdHlsZXMucHVzaChDU1NfUFJFRklYICsgJ2FuaW1hdGlvbi1wbGF5LXN0YXRlJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgc3RhZ2dlclRpbWUgPSBNYXRoLnJvdW5kKE1hdGgubWF4KHRyYW5zaXRpb25TdGFnZ2VyRGVsYXksIGFuaW1hdGlvblN0YWdnZXJEZWxheSkgKiAxMDApIC8gMTAwO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFzdGFnZ2VyVGltZSkge1xuICAgICAgICAgICQkanFMaXRlLmFkZENsYXNzKGVsZW1lbnQsIGFjdGl2ZUNsYXNzTmFtZSk7XG4gICAgICAgICAgaWYgKGVsZW1lbnREYXRhLmJsb2NrVHJhbnNpdGlvbikge1xuICAgICAgICAgICAgYmxvY2tUcmFuc2l0aW9ucyhub2RlLCBmYWxzZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGV2ZW50Q2FjaGVLZXkgPSBlbGVtZW50RGF0YS5jYWNoZUtleSArICcgJyArIGFjdGl2ZUNsYXNzTmFtZTtcbiAgICAgICAgdmFyIHRpbWluZ3MgPSBnZXRFbGVtZW50QW5pbWF0aW9uRGV0YWlscyhlbGVtZW50LCBldmVudENhY2hlS2V5KTtcbiAgICAgICAgdmFyIG1heER1cmF0aW9uID0gTWF0aC5tYXgodGltaW5ncy50cmFuc2l0aW9uRHVyYXRpb24sIHRpbWluZ3MuYW5pbWF0aW9uRHVyYXRpb24pO1xuICAgICAgICBpZiAobWF4RHVyYXRpb24gPT09IDApIHtcbiAgICAgICAgICAkJGpxTGl0ZS5yZW1vdmVDbGFzcyhlbGVtZW50LCBhY3RpdmVDbGFzc05hbWUpO1xuICAgICAgICAgIGFuaW1hdGVDbG9zZShlbGVtZW50LCBjbGFzc05hbWUpO1xuICAgICAgICAgIGFjdGl2ZUFuaW1hdGlvbkNvbXBsZXRlKCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFzdGFnZ2VyVGltZSAmJiBzdHlsZXMgJiYgT2JqZWN0LmtleXMoc3R5bGVzKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgaWYgKCF0aW1pbmdzLnRyYW5zaXRpb25EdXJhdGlvbikge1xuICAgICAgICAgICAgZWxlbWVudC5jc3MoJ3RyYW5zaXRpb24nLCB0aW1pbmdzLmFuaW1hdGlvbkR1cmF0aW9uICsgJ3MgbGluZWFyIGFsbCcpO1xuICAgICAgICAgICAgYXBwbGllZFN0eWxlcy5wdXNoKCd0cmFuc2l0aW9uJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsZW1lbnQuY3NzKHN0eWxlcyk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgbWF4RGVsYXkgPSBNYXRoLm1heCh0aW1pbmdzLnRyYW5zaXRpb25EZWxheSwgdGltaW5ncy5hbmltYXRpb25EZWxheSk7XG4gICAgICAgIHZhciBtYXhEZWxheVRpbWUgPSBtYXhEZWxheSAqIE9ORV9TRUNPTkQ7XG5cbiAgICAgICAgaWYgKGFwcGxpZWRTdHlsZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIC8vdGhlIGVsZW1lbnQgYmVpbmcgYW5pbWF0ZWQgbWF5IHNvbWV0aW1lcyBjb250YWluIGNvbW1lbnQgbm9kZXMgaW5cbiAgICAgICAgICAvL3RoZSBqcUxpdGUgb2JqZWN0LCBzbyB3ZSdyZSBzYWZlIHRvIHVzZSBhIHNpbmdsZSB2YXJpYWJsZSB0byBob3VzZVxuICAgICAgICAgIC8vdGhlIHN0eWxlcyBzaW5jZSB0aGVyZSBpcyBhbHdheXMgb25seSBvbmUgZWxlbWVudCBiZWluZyBhbmltYXRlZFxuICAgICAgICAgIHZhciBvbGRTdHlsZSA9IG5vZGUuZ2V0QXR0cmlidXRlKCdzdHlsZScpIHx8ICcnO1xuICAgICAgICAgIGlmIChvbGRTdHlsZS5jaGFyQXQob2xkU3R5bGUubGVuZ3RoIC0gMSkgIT09ICc7Jykge1xuICAgICAgICAgICAgb2xkU3R5bGUgKz0gJzsnO1xuICAgICAgICAgIH1cbiAgICAgICAgICBub2RlLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCBvbGRTdHlsZSArICcgJyArIHN0eWxlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICB2YXIgY3NzM0FuaW1hdGlvbkV2ZW50cyA9IEFOSU1BVElPTkVORF9FVkVOVCArICcgJyArIFRSQU5TSVRJT05FTkRfRVZFTlQ7XG4gICAgICAgIHZhciBhbmltYXRpb25UaW1lICAgICA9IChtYXhEZWxheSArIG1heER1cmF0aW9uKSAqIENMT1NJTkdfVElNRV9CVUZGRVI7XG4gICAgICAgIHZhciB0b3RhbFRpbWUgICAgICAgICA9IChzdGFnZ2VyVGltZSArIGFuaW1hdGlvblRpbWUpICogT05FX1NFQ09ORDtcblxuICAgICAgICB2YXIgc3RhZ2dlclRpbWVvdXQ7XG4gICAgICAgIGlmIChzdGFnZ2VyVGltZSA+IDApIHtcbiAgICAgICAgICAkJGpxTGl0ZS5hZGRDbGFzcyhlbGVtZW50LCBwZW5kaW5nQ2xhc3NOYW1lKTtcbiAgICAgICAgICBzdGFnZ2VyVGltZW91dCA9ICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc3RhZ2dlclRpbWVvdXQgPSBudWxsO1xuXG4gICAgICAgICAgICBpZiAodGltaW5ncy50cmFuc2l0aW9uRHVyYXRpb24gPiAwKSB7XG4gICAgICAgICAgICAgIGJsb2NrVHJhbnNpdGlvbnMobm9kZSwgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRpbWluZ3MuYW5pbWF0aW9uRHVyYXRpb24gPiAwKSB7XG4gICAgICAgICAgICAgIGJsb2NrQW5pbWF0aW9ucyhub2RlLCBmYWxzZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICQkanFMaXRlLmFkZENsYXNzKGVsZW1lbnQsIGFjdGl2ZUNsYXNzTmFtZSk7XG4gICAgICAgICAgICAkJGpxTGl0ZS5yZW1vdmVDbGFzcyhlbGVtZW50LCBwZW5kaW5nQ2xhc3NOYW1lKTtcblxuICAgICAgICAgICAgaWYgKHN0eWxlcykge1xuICAgICAgICAgICAgICBpZiAodGltaW5ncy50cmFuc2l0aW9uRHVyYXRpb24gPT09IDApIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNzcygndHJhbnNpdGlvbicsIHRpbWluZ3MuYW5pbWF0aW9uRHVyYXRpb24gKyAncyBsaW5lYXIgYWxsJyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZWxlbWVudC5jc3Moc3R5bGVzKTtcbiAgICAgICAgICAgICAgYXBwbGllZFN0eWxlcy5wdXNoKCd0cmFuc2l0aW9uJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSwgc3RhZ2dlclRpbWUgKiBPTkVfU0VDT05ELCBmYWxzZSk7XG4gICAgICAgIH1cblxuICAgICAgICBlbGVtZW50Lm9uKGNzczNBbmltYXRpb25FdmVudHMsIG9uQW5pbWF0aW9uUHJvZ3Jlc3MpO1xuICAgICAgICBlbGVtZW50RGF0YS5jbG9zZUFuaW1hdGlvbkZucy5wdXNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIG9uRW5kKCk7XG4gICAgICAgICAgYWN0aXZlQW5pbWF0aW9uQ29tcGxldGUoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZWxlbWVudERhdGEucnVubmluZysrO1xuICAgICAgICBhbmltYXRpb25DbG9zZUhhbmRsZXIoZWxlbWVudCwgdG90YWxUaW1lKTtcbiAgICAgICAgcmV0dXJuIG9uRW5kO1xuXG4gICAgICAgIC8vIFRoaXMgd2lsbCBhdXRvbWF0aWNhbGx5IGJlIGNhbGxlZCBieSAkYW5pbWF0ZSBzb1xuICAgICAgICAvLyB0aGVyZSBpcyBubyBuZWVkIHRvIGF0dGFjaCB0aGlzIGludGVybmFsbHkgdG8gdGhlXG4gICAgICAgIC8vIHRpbWVvdXQgZG9uZSBtZXRob2QuXG4gICAgICAgIGZ1bmN0aW9uIG9uRW5kKCkge1xuICAgICAgICAgIGVsZW1lbnQub2ZmKGNzczNBbmltYXRpb25FdmVudHMsIG9uQW5pbWF0aW9uUHJvZ3Jlc3MpO1xuICAgICAgICAgICQkanFMaXRlLnJlbW92ZUNsYXNzKGVsZW1lbnQsIGFjdGl2ZUNsYXNzTmFtZSk7XG4gICAgICAgICAgJCRqcUxpdGUucmVtb3ZlQ2xhc3MoZWxlbWVudCwgcGVuZGluZ0NsYXNzTmFtZSk7XG4gICAgICAgICAgaWYgKHN0YWdnZXJUaW1lb3V0KSB7XG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwoc3RhZ2dlclRpbWVvdXQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhbmltYXRlQ2xvc2UoZWxlbWVudCwgY2xhc3NOYW1lKTtcbiAgICAgICAgICB2YXIgbm9kZSA9IGV4dHJhY3RFbGVtZW50Tm9kZShlbGVtZW50KTtcbiAgICAgICAgICBmb3IgKHZhciBpIGluIGFwcGxpZWRTdHlsZXMpIHtcbiAgICAgICAgICAgIG5vZGUuc3R5bGUucmVtb3ZlUHJvcGVydHkoYXBwbGllZFN0eWxlc1tpXSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gb25BbmltYXRpb25Qcm9ncmVzcyhldmVudCkge1xuICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgIHZhciBldiA9IGV2ZW50Lm9yaWdpbmFsRXZlbnQgfHwgZXZlbnQ7XG4gICAgICAgICAgdmFyIHRpbWVTdGFtcCA9IGV2LiRtYW51YWxUaW1lU3RhbXAgfHwgZXYudGltZVN0YW1wIHx8IERhdGUubm93KCk7XG5cbiAgICAgICAgICAvKiBGaXJlZm94IChvciBwb3NzaWJseSBqdXN0IEdlY2tvKSBsaWtlcyB0byBub3Qgcm91bmQgdmFsdWVzIHVwXG4gICAgICAgICAgICogd2hlbiBhIG1zIG1lYXN1cmVtZW50IGlzIHVzZWQgZm9yIHRoZSBhbmltYXRpb24gKi9cbiAgICAgICAgICB2YXIgZWxhcHNlZFRpbWUgPSBwYXJzZUZsb2F0KGV2LmVsYXBzZWRUaW1lLnRvRml4ZWQoRUxBUFNFRF9USU1FX01BWF9ERUNJTUFMX1BMQUNFUykpO1xuXG4gICAgICAgICAgLyogJG1hbnVhbFRpbWVTdGFtcCBpcyBhIG1vY2tlZCB0aW1lU3RhbXAgdmFsdWUgd2hpY2ggaXMgc2V0XG4gICAgICAgICAgICogd2l0aGluIGJyb3dzZXJUcmlnZ2VyKCkuIFRoaXMgaXMgb25seSBoZXJlIHNvIHRoYXQgdGVzdHMgY2FuXG4gICAgICAgICAgICogbW9jayBhbmltYXRpb25zIHByb3Blcmx5LiBSZWFsIGV2ZW50cyBmYWxsYmFjayB0byBldmVudC50aW1lU3RhbXAsXG4gICAgICAgICAgICogb3IsIGlmIHRoZXkgZG9uJ3QsIHRoZW4gYSB0aW1lU3RhbXAgaXMgYXV0b21hdGljYWxseSBjcmVhdGVkIGZvciB0aGVtLlxuICAgICAgICAgICAqIFdlJ3JlIGNoZWNraW5nIHRvIHNlZSBpZiB0aGUgdGltZVN0YW1wIHN1cnBhc3NlcyB0aGUgZXhwZWN0ZWQgZGVsYXksXG4gICAgICAgICAgICogYnV0IHdlJ3JlIHVzaW5nIGVsYXBzZWRUaW1lIGluc3RlYWQgb2YgdGhlIHRpbWVTdGFtcCBvbiB0aGUgMm5kXG4gICAgICAgICAgICogcHJlLWNvbmRpdGlvbiBzaW5jZSBhbmltYXRpb25zIHNvbWV0aW1lcyBjbG9zZSBvZmYgZWFybHkgKi9cbiAgICAgICAgICBpZiAoTWF0aC5tYXgodGltZVN0YW1wIC0gc3RhcnRUaW1lLCAwKSA+PSBtYXhEZWxheVRpbWUgJiYgZWxhcHNlZFRpbWUgPj0gbWF4RHVyYXRpb24pIHtcbiAgICAgICAgICAgIGFjdGl2ZUFuaW1hdGlvbkNvbXBsZXRlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGJsb2NrVHJhbnNpdGlvbnMobm9kZSwgYm9vbCkge1xuICAgICAgICBub2RlLnN0eWxlW1RSQU5TSVRJT05fUFJPUCArIFBST1BFUlRZX0tFWV0gPSBib29sID8gJ25vbmUnIDogJyc7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGJsb2NrQW5pbWF0aW9ucyhub2RlLCBib29sKSB7XG4gICAgICAgIG5vZGUuc3R5bGVbQU5JTUFUSU9OX1BST1AgKyBBTklNQVRJT05fUExBWVNUQVRFX0tFWV0gPSBib29sID8gJ3BhdXNlZCcgOiAnJztcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gYW5pbWF0ZUJlZm9yZShhbmltYXRpb25FdmVudCwgZWxlbWVudCwgY2xhc3NOYW1lLCBzdHlsZXMpIHtcbiAgICAgICAgaWYgKGFuaW1hdGVTZXR1cChhbmltYXRpb25FdmVudCwgZWxlbWVudCwgY2xhc3NOYW1lLCBzdHlsZXMpKSB7XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGNhbmNlbGxlZCkge1xuICAgICAgICAgICAgY2FuY2VsbGVkICYmIGFuaW1hdGVDbG9zZShlbGVtZW50LCBjbGFzc05hbWUpO1xuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gYW5pbWF0ZUFmdGVyKGFuaW1hdGlvbkV2ZW50LCBlbGVtZW50LCBjbGFzc05hbWUsIGFmdGVyQW5pbWF0aW9uQ29tcGxldGUsIHN0eWxlcykge1xuICAgICAgICBpZiAoZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfQ1NTX0RBVEFfS0VZKSkge1xuICAgICAgICAgIHJldHVybiBhbmltYXRlUnVuKGFuaW1hdGlvbkV2ZW50LCBlbGVtZW50LCBjbGFzc05hbWUsIGFmdGVyQW5pbWF0aW9uQ29tcGxldGUsIHN0eWxlcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYW5pbWF0ZUNsb3NlKGVsZW1lbnQsIGNsYXNzTmFtZSk7XG4gICAgICAgICAgYWZ0ZXJBbmltYXRpb25Db21wbGV0ZSgpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGFuaW1hdGUoYW5pbWF0aW9uRXZlbnQsIGVsZW1lbnQsIGNsYXNzTmFtZSwgYW5pbWF0aW9uQ29tcGxldGUsIG9wdGlvbnMpIHtcbiAgICAgICAgLy9JZiB0aGUgYW5pbWF0ZVNldHVwIGZ1bmN0aW9uIGRvZXNuJ3QgYm90aGVyIHJldHVybmluZyBhXG4gICAgICAgIC8vY2FuY2VsbGF0aW9uIGZ1bmN0aW9uIHRoZW4gaXQgbWVhbnMgdGhhdCB0aGVyZSBpcyBubyBhbmltYXRpb25cbiAgICAgICAgLy90byBwZXJmb3JtIGF0IGFsbFxuICAgICAgICB2YXIgcHJlUmVmbG93Q2FuY2VsbGF0aW9uID0gYW5pbWF0ZUJlZm9yZShhbmltYXRpb25FdmVudCwgZWxlbWVudCwgY2xhc3NOYW1lLCBvcHRpb25zLmZyb20pO1xuICAgICAgICBpZiAoIXByZVJlZmxvd0NhbmNlbGxhdGlvbikge1xuICAgICAgICAgIGNsZWFyQ2FjaGVBZnRlclJlZmxvdygpO1xuICAgICAgICAgIGFuaW1hdGlvbkNvbXBsZXRlKCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9UaGVyZSBhcmUgdHdvIGNhbmNlbGxhdGlvbiBmdW5jdGlvbnM6IG9uZSBpcyBiZWZvcmUgdGhlIGZpcnN0XG4gICAgICAgIC8vcmVmbG93IGFuaW1hdGlvbiBhbmQgdGhlIHNlY29uZCBpcyBkdXJpbmcgdGhlIGFjdGl2ZSBzdGF0ZVxuICAgICAgICAvL2FuaW1hdGlvbi4gVGhlIGZpcnN0IGZ1bmN0aW9uIHdpbGwgdGFrZSBjYXJlIG9mIHJlbW92aW5nIHRoZVxuICAgICAgICAvL2RhdGEgZnJvbSB0aGUgZWxlbWVudCB3aGljaCB3aWxsIG5vdCBtYWtlIHRoZSAybmQgYW5pbWF0aW9uXG4gICAgICAgIC8vaGFwcGVuIGluIHRoZSBmaXJzdCBwbGFjZVxuICAgICAgICB2YXIgY2FuY2VsID0gcHJlUmVmbG93Q2FuY2VsbGF0aW9uO1xuICAgICAgICBhZnRlclJlZmxvdyhlbGVtZW50LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAvL29uY2UgdGhlIHJlZmxvdyBpcyBjb21wbGV0ZSB0aGVuIHdlIHBvaW50IGNhbmNlbCB0b1xuICAgICAgICAgIC8vdGhlIG5ldyBjYW5jZWxsYXRpb24gZnVuY3Rpb24gd2hpY2ggd2lsbCByZW1vdmUgYWxsIG9mIHRoZVxuICAgICAgICAgIC8vYW5pbWF0aW9uIHByb3BlcnRpZXMgZnJvbSB0aGUgYWN0aXZlIGFuaW1hdGlvblxuICAgICAgICAgIGNhbmNlbCA9IGFuaW1hdGVBZnRlcihhbmltYXRpb25FdmVudCwgZWxlbWVudCwgY2xhc3NOYW1lLCBhbmltYXRpb25Db21wbGV0ZSwgb3B0aW9ucy50byk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBmdW5jdGlvbihjYW5jZWxsZWQpIHtcbiAgICAgICAgICAoY2FuY2VsIHx8IG5vb3ApKGNhbmNlbGxlZCk7XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGFuaW1hdGVDbG9zZShlbGVtZW50LCBjbGFzc05hbWUpIHtcbiAgICAgICAgJCRqcUxpdGUucmVtb3ZlQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKTtcbiAgICAgICAgdmFyIGRhdGEgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9DU1NfREFUQV9LRVkpO1xuICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgIGlmIChkYXRhLnJ1bm5pbmcpIHtcbiAgICAgICAgICAgIGRhdGEucnVubmluZy0tO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIWRhdGEucnVubmluZyB8fCBkYXRhLnJ1bm5pbmcgPT09IDApIHtcbiAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlRGF0YShOR19BTklNQVRFX0NTU19EQVRBX0tFWSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFuaW1hdGU6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgZnJvbSwgdG8sIGFuaW1hdGlvbkNvbXBsZXRlZCwgb3B0aW9ucykge1xuICAgICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgICAgIG9wdGlvbnMuZnJvbSA9IGZyb207XG4gICAgICAgICAgb3B0aW9ucy50byA9IHRvO1xuICAgICAgICAgIHJldHVybiBhbmltYXRlKCdhbmltYXRlJywgZWxlbWVudCwgY2xhc3NOYW1lLCBhbmltYXRpb25Db21wbGV0ZWQsIG9wdGlvbnMpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGVudGVyOiBmdW5jdGlvbihlbGVtZW50LCBhbmltYXRpb25Db21wbGV0ZWQsIG9wdGlvbnMpIHtcbiAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgICAgICByZXR1cm4gYW5pbWF0ZSgnZW50ZXInLCBlbGVtZW50LCAnbmctZW50ZXInLCBhbmltYXRpb25Db21wbGV0ZWQsIG9wdGlvbnMpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGxlYXZlOiBmdW5jdGlvbihlbGVtZW50LCBhbmltYXRpb25Db21wbGV0ZWQsIG9wdGlvbnMpIHtcbiAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgICAgICByZXR1cm4gYW5pbWF0ZSgnbGVhdmUnLCBlbGVtZW50LCAnbmctbGVhdmUnLCBhbmltYXRpb25Db21wbGV0ZWQsIG9wdGlvbnMpO1xuICAgICAgICB9LFxuXG4gICAgICAgIG1vdmU6IGZ1bmN0aW9uKGVsZW1lbnQsIGFuaW1hdGlvbkNvbXBsZXRlZCwgb3B0aW9ucykge1xuICAgICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgICAgIHJldHVybiBhbmltYXRlKCdtb3ZlJywgZWxlbWVudCwgJ25nLW1vdmUnLCBhbmltYXRpb25Db21wbGV0ZWQsIG9wdGlvbnMpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGJlZm9yZVNldENsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBhZGQsIHJlbW92ZSwgYW5pbWF0aW9uQ29tcGxldGVkLCBvcHRpb25zKSB7XG4gICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgICAgICAgdmFyIGNsYXNzTmFtZSA9IHN1ZmZpeENsYXNzZXMocmVtb3ZlLCAnLXJlbW92ZScpICsgJyAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc3VmZml4Q2xhc3NlcyhhZGQsICctYWRkJyk7XG4gICAgICAgICAgdmFyIGNhbmNlbGxhdGlvbk1ldGhvZCA9IGFuaW1hdGVCZWZvcmUoJ3NldENsYXNzJywgZWxlbWVudCwgY2xhc3NOYW1lLCBvcHRpb25zLmZyb20pO1xuICAgICAgICAgIGlmIChjYW5jZWxsYXRpb25NZXRob2QpIHtcbiAgICAgICAgICAgIGFmdGVyUmVmbG93KGVsZW1lbnQsIGFuaW1hdGlvbkNvbXBsZXRlZCk7XG4gICAgICAgICAgICByZXR1cm4gY2FuY2VsbGF0aW9uTWV0aG9kO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjbGVhckNhY2hlQWZ0ZXJSZWZsb3coKTtcbiAgICAgICAgICBhbmltYXRpb25Db21wbGV0ZWQoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBiZWZvcmVBZGRDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBhbmltYXRpb25Db21wbGV0ZWQsIG9wdGlvbnMpIHtcbiAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgICAgICB2YXIgY2FuY2VsbGF0aW9uTWV0aG9kID0gYW5pbWF0ZUJlZm9yZSgnYWRkQ2xhc3MnLCBlbGVtZW50LCBzdWZmaXhDbGFzc2VzKGNsYXNzTmFtZSwgJy1hZGQnKSwgb3B0aW9ucy5mcm9tKTtcbiAgICAgICAgICBpZiAoY2FuY2VsbGF0aW9uTWV0aG9kKSB7XG4gICAgICAgICAgICBhZnRlclJlZmxvdyhlbGVtZW50LCBhbmltYXRpb25Db21wbGV0ZWQpO1xuICAgICAgICAgICAgcmV0dXJuIGNhbmNlbGxhdGlvbk1ldGhvZDtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2xlYXJDYWNoZUFmdGVyUmVmbG93KCk7XG4gICAgICAgICAgYW5pbWF0aW9uQ29tcGxldGVkKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYmVmb3JlUmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgYW5pbWF0aW9uQ29tcGxldGVkLCBvcHRpb25zKSB7XG4gICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgICAgICAgdmFyIGNhbmNlbGxhdGlvbk1ldGhvZCA9IGFuaW1hdGVCZWZvcmUoJ3JlbW92ZUNsYXNzJywgZWxlbWVudCwgc3VmZml4Q2xhc3NlcyhjbGFzc05hbWUsICctcmVtb3ZlJyksIG9wdGlvbnMuZnJvbSk7XG4gICAgICAgICAgaWYgKGNhbmNlbGxhdGlvbk1ldGhvZCkge1xuICAgICAgICAgICAgYWZ0ZXJSZWZsb3coZWxlbWVudCwgYW5pbWF0aW9uQ29tcGxldGVkKTtcbiAgICAgICAgICAgIHJldHVybiBjYW5jZWxsYXRpb25NZXRob2Q7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNsZWFyQ2FjaGVBZnRlclJlZmxvdygpO1xuICAgICAgICAgIGFuaW1hdGlvbkNvbXBsZXRlZCgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldENsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBhZGQsIHJlbW92ZSwgYW5pbWF0aW9uQ29tcGxldGVkLCBvcHRpb25zKSB7XG4gICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgICAgICAgcmVtb3ZlID0gc3VmZml4Q2xhc3NlcyhyZW1vdmUsICctcmVtb3ZlJyk7XG4gICAgICAgICAgYWRkID0gc3VmZml4Q2xhc3NlcyhhZGQsICctYWRkJyk7XG4gICAgICAgICAgdmFyIGNsYXNzTmFtZSA9IHJlbW92ZSArICcgJyArIGFkZDtcbiAgICAgICAgICByZXR1cm4gYW5pbWF0ZUFmdGVyKCdzZXRDbGFzcycsIGVsZW1lbnQsIGNsYXNzTmFtZSwgYW5pbWF0aW9uQ29tcGxldGVkLCBvcHRpb25zLnRvKTtcbiAgICAgICAgfSxcblxuICAgICAgICBhZGRDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBhbmltYXRpb25Db21wbGV0ZWQsIG9wdGlvbnMpIHtcbiAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgICAgICByZXR1cm4gYW5pbWF0ZUFmdGVyKCdhZGRDbGFzcycsIGVsZW1lbnQsIHN1ZmZpeENsYXNzZXMoY2xhc3NOYW1lLCAnLWFkZCcpLCBhbmltYXRpb25Db21wbGV0ZWQsIG9wdGlvbnMudG8pO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbW92ZUNsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGFuaW1hdGlvbkNvbXBsZXRlZCwgb3B0aW9ucykge1xuICAgICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgICAgIHJldHVybiBhbmltYXRlQWZ0ZXIoJ3JlbW92ZUNsYXNzJywgZWxlbWVudCwgc3VmZml4Q2xhc3NlcyhjbGFzc05hbWUsICctcmVtb3ZlJyksIGFuaW1hdGlvbkNvbXBsZXRlZCwgb3B0aW9ucy50byk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGZ1bmN0aW9uIHN1ZmZpeENsYXNzZXMoY2xhc3Nlcywgc3VmZml4KSB7XG4gICAgICAgIHZhciBjbGFzc05hbWUgPSAnJztcbiAgICAgICAgY2xhc3NlcyA9IGlzQXJyYXkoY2xhc3NlcykgPyBjbGFzc2VzIDogY2xhc3Nlcy5zcGxpdCgvXFxzKy8pO1xuICAgICAgICBmb3JFYWNoKGNsYXNzZXMsIGZ1bmN0aW9uKGtsYXNzLCBpKSB7XG4gICAgICAgICAgaWYgKGtsYXNzICYmIGtsYXNzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNsYXNzTmFtZSArPSAoaSA+IDAgPyAnICcgOiAnJykgKyBrbGFzcyArIHN1ZmZpeDtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY2xhc3NOYW1lO1xuICAgICAgfVxuICAgIH1dKTtcbiAgfV0pO1xuXG5cbn0pKHdpbmRvdywgd2luZG93LmFuZ3VsYXIpO1xuIiwiLyoqXG4gKiBAbGljZW5zZSBBbmd1bGFySlMgdjEuMy4xMVxuICogKGMpIDIwMTAtMjAxNCBHb29nbGUsIEluYy4gaHR0cDovL2FuZ3VsYXJqcy5vcmdcbiAqIExpY2Vuc2U6IE1JVFxuICovXG4oZnVuY3Rpb24od2luZG93LCBhbmd1bGFyLCB1bmRlZmluZWQpIHsndXNlIHN0cmljdCc7XG5cbi8qKlxuICogQG5nZG9jIG1vZHVsZVxuICogQG5hbWUgbmdBcmlhXG4gKiBAZGVzY3JpcHRpb25cbiAqXG4gKiBUaGUgYG5nQXJpYWAgbW9kdWxlIHByb3ZpZGVzIHN1cHBvcnQgZm9yIGNvbW1vblxuICogWzxhYmJyIHRpdGxlPVwiQWNjZXNzaWJsZSBSaWNoIEludGVybmV0IEFwcGxpY2F0aW9uc1wiPkFSSUE8L2FiYnI+XShodHRwOi8vd3d3LnczLm9yZy9UUi93YWktYXJpYS8pXG4gKiBhdHRyaWJ1dGVzIHRoYXQgY29udmV5IHN0YXRlIG9yIHNlbWFudGljIGluZm9ybWF0aW9uIGFib3V0IHRoZSBhcHBsaWNhdGlvbiBmb3IgdXNlcnNcbiAqIG9mIGFzc2lzdGl2ZSB0ZWNobm9sb2dpZXMsIHN1Y2ggYXMgc2NyZWVuIHJlYWRlcnMuXG4gKlxuICogPGRpdiBkb2MtbW9kdWxlLWNvbXBvbmVudHM9XCJuZ0FyaWFcIj48L2Rpdj5cbiAqXG4gKiAjIyBVc2FnZVxuICpcbiAqIEZvciBuZ0FyaWEgdG8gZG8gaXRzIG1hZ2ljLCBzaW1wbHkgaW5jbHVkZSB0aGUgbW9kdWxlIGFzIGEgZGVwZW5kZW5jeS4gVGhlIGRpcmVjdGl2ZXMgc3VwcG9ydGVkXG4gKiBieSBuZ0FyaWEgYXJlOlxuICogYG5nTW9kZWxgLCBgbmdEaXNhYmxlZGAsIGBuZ1Nob3dgLCBgbmdIaWRlYCwgYG5nQ2xpY2tgLCBgbmdEYmxDbGlja2AsIGFuZCBgbmdNZXNzYWdlc2AuXG4gKlxuICogQmVsb3cgaXMgYSBtb3JlIGRldGFpbGVkIGJyZWFrZG93biBvZiB0aGUgYXR0cmlidXRlcyBoYW5kbGVkIGJ5IG5nQXJpYTpcbiAqXG4gKiB8IERpcmVjdGl2ZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBTdXBwb3J0ZWQgQXR0cmlidXRlcyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18XG4gKiB8IHtAbGluayBuZy5kaXJlY3RpdmU6bmdNb2RlbCBuZ01vZGVsfSAgICAgICAgfCBhcmlhLWNoZWNrZWQsIGFyaWEtdmFsdWVtaW4sIGFyaWEtdmFsdWVtYXgsIGFyaWEtdmFsdWVub3csIGFyaWEtaW52YWxpZCwgYXJpYS1yZXF1aXJlZCB8XG4gKiB8IHtAbGluayBuZy5kaXJlY3RpdmU6bmdEaXNhYmxlZCBuZ0Rpc2FibGVkfSAgfCBhcmlhLWRpc2FibGVkICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8IHtAbGluayBuZy5kaXJlY3RpdmU6bmdTaG93IG5nU2hvd30gICAgICAgICAgfCBhcmlhLWhpZGRlbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8IHtAbGluayBuZy5kaXJlY3RpdmU6bmdIaWRlIG5nSGlkZX0gICAgICAgICAgfCBhcmlhLWhpZGRlbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8IHtAbGluayBuZy5kaXJlY3RpdmU6bmdDbGljayBuZ0NsaWNrfSAgICAgICAgfCB0YWJpbmRleCwga2V5cHJlc3MgZXZlbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8IHtAbGluayBuZy5kaXJlY3RpdmU6bmdEYmxjbGljayBuZ0RibGNsaWNrfSAgfCB0YWJpbmRleCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8IHtAbGluayBtb2R1bGU6bmdNZXNzYWdlcyBuZ01lc3NhZ2VzfSAgICAgICAgfCBhcmlhLWxpdmUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKlxuICogRmluZCBvdXQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBlYWNoIGRpcmVjdGl2ZSBieSByZWFkaW5nIHRoZVxuICoge0BsaW5rIGd1aWRlL2FjY2Vzc2liaWxpdHkgbmdBcmlhIERldmVsb3BlciBHdWlkZX0uXG4gKlxuICogIyNFeGFtcGxlXG4gKiBVc2luZyBuZ0Rpc2FibGVkIHdpdGggbmdBcmlhOlxuICogYGBgaHRtbFxuICogPG1kLWNoZWNrYm94IG5nLWRpc2FibGVkPVwiZGlzYWJsZWRcIj5cbiAqIGBgYFxuICogQmVjb21lczpcbiAqIGBgYGh0bWxcbiAqIDxtZC1jaGVja2JveCBuZy1kaXNhYmxlZD1cImRpc2FibGVkXCIgYXJpYS1kaXNhYmxlZD1cInRydWVcIj5cbiAqIGBgYFxuICpcbiAqICMjRGlzYWJsaW5nIEF0dHJpYnV0ZXNcbiAqIEl0J3MgcG9zc2libGUgdG8gZGlzYWJsZSBpbmRpdmlkdWFsIGF0dHJpYnV0ZXMgYWRkZWQgYnkgbmdBcmlhIHdpdGggdGhlXG4gKiB7QGxpbmsgbmdBcmlhLiRhcmlhUHJvdmlkZXIjY29uZmlnIGNvbmZpZ30gbWV0aG9kLiBGb3IgbW9yZSBkZXRhaWxzLCBzZWUgdGhlXG4gKiB7QGxpbmsgZ3VpZGUvYWNjZXNzaWJpbGl0eSBEZXZlbG9wZXIgR3VpZGV9LlxuICovXG4gLyogZ2xvYmFsIC1uZ0FyaWFNb2R1bGUgKi9cbnZhciBuZ0FyaWFNb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbmdBcmlhJywgWyduZyddKS5cbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyKCckYXJpYScsICRBcmlhUHJvdmlkZXIpO1xuXG4vKipcbiAqIEBuZ2RvYyBwcm92aWRlclxuICogQG5hbWUgJGFyaWFQcm92aWRlclxuICpcbiAqIEBkZXNjcmlwdGlvblxuICpcbiAqIFVzZWQgZm9yIGNvbmZpZ3VyaW5nIHRoZSBBUklBIGF0dHJpYnV0ZXMgaW5qZWN0ZWQgYW5kIG1hbmFnZWQgYnkgbmdBcmlhLlxuICpcbiAqIGBgYGpzXG4gKiBhbmd1bGFyLm1vZHVsZSgnbXlBcHAnLCBbJ25nQXJpYSddLCBmdW5jdGlvbiBjb25maWcoJGFyaWFQcm92aWRlcikge1xuICogICAkYXJpYVByb3ZpZGVyLmNvbmZpZyh7XG4gKiAgICAgYXJpYVZhbHVlOiB0cnVlLFxuICogICAgIHRhYmluZGV4OiBmYWxzZVxuICogICB9KTtcbiAqIH0pO1xuICpgYGBcbiAqXG4gKiAjIyBEZXBlbmRlbmNpZXNcbiAqIFJlcXVpcmVzIHRoZSB7QGxpbmsgbmdBcmlhfSBtb2R1bGUgdG8gYmUgaW5zdGFsbGVkLlxuICpcbiAqL1xuZnVuY3Rpb24gJEFyaWFQcm92aWRlcigpIHtcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBhcmlhSGlkZGVuOiB0cnVlLFxuICAgIGFyaWFDaGVja2VkOiB0cnVlLFxuICAgIGFyaWFEaXNhYmxlZDogdHJ1ZSxcbiAgICBhcmlhUmVxdWlyZWQ6IHRydWUsXG4gICAgYXJpYUludmFsaWQ6IHRydWUsXG4gICAgYXJpYU11bHRpbGluZTogdHJ1ZSxcbiAgICBhcmlhVmFsdWU6IHRydWUsXG4gICAgdGFiaW5kZXg6IHRydWUsXG4gICAgYmluZEtleXByZXNzOiB0cnVlXG4gIH07XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBtZXRob2RcbiAgICogQG5hbWUgJGFyaWFQcm92aWRlciNjb25maWdcbiAgICpcbiAgICogQHBhcmFtIHtvYmplY3R9IGNvbmZpZyBvYmplY3QgdG8gZW5hYmxlL2Rpc2FibGUgc3BlY2lmaWMgQVJJQSBhdHRyaWJ1dGVzXG4gICAqXG4gICAqICAtICoqYXJpYUhpZGRlbioqIOKAkyBge2Jvb2xlYW59YCDigJMgRW5hYmxlcy9kaXNhYmxlcyBhcmlhLWhpZGRlbiB0YWdzXG4gICAqICAtICoqYXJpYUNoZWNrZWQqKiDigJMgYHtib29sZWFufWAg4oCTIEVuYWJsZXMvZGlzYWJsZXMgYXJpYS1jaGVja2VkIHRhZ3NcbiAgICogIC0gKiphcmlhRGlzYWJsZWQqKiDigJMgYHtib29sZWFufWAg4oCTIEVuYWJsZXMvZGlzYWJsZXMgYXJpYS1kaXNhYmxlZCB0YWdzXG4gICAqICAtICoqYXJpYVJlcXVpcmVkKiog4oCTIGB7Ym9vbGVhbn1gIOKAkyBFbmFibGVzL2Rpc2FibGVzIGFyaWEtcmVxdWlyZWQgdGFnc1xuICAgKiAgLSAqKmFyaWFJbnZhbGlkKiog4oCTIGB7Ym9vbGVhbn1gIOKAkyBFbmFibGVzL2Rpc2FibGVzIGFyaWEtaW52YWxpZCB0YWdzXG4gICAqICAtICoqYXJpYU11bHRpbGluZSoqIOKAkyBge2Jvb2xlYW59YCDigJMgRW5hYmxlcy9kaXNhYmxlcyBhcmlhLW11bHRpbGluZSB0YWdzXG4gICAqICAtICoqYXJpYVZhbHVlKiog4oCTIGB7Ym9vbGVhbn1gIOKAkyBFbmFibGVzL2Rpc2FibGVzIGFyaWEtdmFsdWVtaW4sIGFyaWEtdmFsdWVtYXggYW5kIGFyaWEtdmFsdWVub3cgdGFnc1xuICAgKiAgLSAqKnRhYmluZGV4Kiog4oCTIGB7Ym9vbGVhbn1gIOKAkyBFbmFibGVzL2Rpc2FibGVzIHRhYmluZGV4IHRhZ3NcbiAgICogIC0gKipiaW5kS2V5cHJlc3MqKiDigJMgYHtib29sZWFufWAg4oCTIEVuYWJsZXMvZGlzYWJsZXMga2V5cHJlc3MgZXZlbnQgYmluZGluZyBvbiBuZy1jbGlja1xuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogRW5hYmxlcy9kaXNhYmxlcyB2YXJpb3VzIEFSSUEgYXR0cmlidXRlc1xuICAgKi9cbiAgdGhpcy5jb25maWcgPSBmdW5jdGlvbihuZXdDb25maWcpIHtcbiAgICBjb25maWcgPSBhbmd1bGFyLmV4dGVuZChjb25maWcsIG5ld0NvbmZpZyk7XG4gIH07XG5cbiAgZnVuY3Rpb24gd2F0Y2hFeHByKGF0dHJOYW1lLCBhcmlhQXR0ciwgbmVnYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBlbGVtLCBhdHRyKSB7XG4gICAgICB2YXIgYXJpYUNhbWVsTmFtZSA9IGF0dHIuJG5vcm1hbGl6ZShhcmlhQXR0cik7XG4gICAgICBpZiAoY29uZmlnW2FyaWFDYW1lbE5hbWVdICYmICFhdHRyW2FyaWFDYW1lbE5hbWVdKSB7XG4gICAgICAgIHNjb3BlLiR3YXRjaChhdHRyW2F0dHJOYW1lXSwgZnVuY3Rpb24oYm9vbFZhbCkge1xuICAgICAgICAgIGlmIChuZWdhdGUpIHtcbiAgICAgICAgICAgIGJvb2xWYWwgPSAhYm9vbFZhbDtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxlbS5hdHRyKGFyaWFBdHRyLCBib29sVmFsKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAbmdkb2Mgc2VydmljZVxuICAgKiBAbmFtZSAkYXJpYVxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICpcbiAgICogVGhlICRhcmlhIHNlcnZpY2UgY29udGFpbnMgaGVscGVyIG1ldGhvZHMgZm9yIGFwcGx5aW5nIGNvbW1vblxuICAgKiBbQVJJQV0oaHR0cDovL3d3dy53My5vcmcvVFIvd2FpLWFyaWEvKSBhdHRyaWJ1dGVzIHRvIEhUTUwgZGlyZWN0aXZlcy5cbiAgICpcbiAgICogbmdBcmlhIGluamVjdHMgY29tbW9uIGFjY2Vzc2liaWxpdHkgYXR0cmlidXRlcyB0aGF0IHRlbGwgYXNzaXN0aXZlIHRlY2hub2xvZ2llcyB3aGVuIEhUTUxcbiAgICogZWxlbWVudHMgYXJlIGVuYWJsZWQsIHNlbGVjdGVkLCBoaWRkZW4sIGFuZCBtb3JlLiBUbyBzZWUgaG93IHRoaXMgaXMgcGVyZm9ybWVkIHdpdGggbmdBcmlhLFxuICAgKiBsZXQncyByZXZpZXcgYSBjb2RlIHNuaXBwZXQgZnJvbSBuZ0FyaWEgaXRzZWxmOlxuICAgKlxuICAgKmBgYGpzXG4gICAqIG5nQXJpYU1vZHVsZS5kaXJlY3RpdmUoJ25nRGlzYWJsZWQnLCBbJyRhcmlhJywgZnVuY3Rpb24oJGFyaWEpIHtcbiAgICogICByZXR1cm4gJGFyaWEuJCR3YXRjaEV4cHIoJ25nRGlzYWJsZWQnLCAnYXJpYS1kaXNhYmxlZCcpO1xuICAgKiB9XSlcbiAgICpgYGBcbiAgICogU2hvd24gYWJvdmUsIHRoZSBuZ0FyaWEgbW9kdWxlIGNyZWF0ZXMgYSBkaXJlY3RpdmUgd2l0aCB0aGUgc2FtZSBzaWduYXR1cmUgYXMgdGhlXG4gICAqIHRyYWRpdGlvbmFsIGBuZy1kaXNhYmxlZGAgZGlyZWN0aXZlLiBCdXQgdGhpcyBuZ0FyaWEgdmVyc2lvbiBpcyBkZWRpY2F0ZWQgdG9cbiAgICogc29sZWx5IG1hbmFnaW5nIGFjY2Vzc2liaWxpdHkgYXR0cmlidXRlcy4gVGhlIGludGVybmFsIGAkYXJpYWAgc2VydmljZSBpcyB1c2VkIHRvIHdhdGNoIHRoZVxuICAgKiBib29sZWFuIGF0dHJpYnV0ZSBgbmdEaXNhYmxlZGAuIElmIGl0IGhhcyBub3QgYmVlbiBleHBsaWNpdGx5IHNldCBieSB0aGUgZGV2ZWxvcGVyLFxuICAgKiBgYXJpYS1kaXNhYmxlZGAgaXMgaW5qZWN0ZWQgYXMgYW4gYXR0cmlidXRlIHdpdGggaXRzIHZhbHVlIHN5bmNocm9uaXplZCB0byB0aGUgdmFsdWUgaW5cbiAgICogYG5nRGlzYWJsZWRgLlxuICAgKlxuICAgKiBCZWNhdXNlIG5nQXJpYSBob29rcyBpbnRvIHRoZSBgbmctZGlzYWJsZWRgIGRpcmVjdGl2ZSwgZGV2ZWxvcGVycyBkbyBub3QgaGF2ZSB0byBkb1xuICAgKiBhbnl0aGluZyB0byBlbmFibGUgdGhpcyBmZWF0dXJlLiBUaGUgYGFyaWEtZGlzYWJsZWRgIGF0dHJpYnV0ZSBpcyBhdXRvbWF0aWNhbGx5IG1hbmFnZWRcbiAgICogc2ltcGx5IGFzIGEgc2lsZW50IHNpZGUtZWZmZWN0IG9mIHVzaW5nIGBuZy1kaXNhYmxlZGAgd2l0aCB0aGUgbmdBcmlhIG1vZHVsZS5cbiAgICpcbiAgICogVGhlIGZ1bGwgbGlzdCBvZiBkaXJlY3RpdmVzIHRoYXQgaW50ZXJmYWNlIHdpdGggbmdBcmlhOlxuICAgKiAqICoqbmdNb2RlbCoqXG4gICAqICogKipuZ1Nob3cqKlxuICAgKiAqICoqbmdIaWRlKipcbiAgICogKiAqKm5nQ2xpY2sqKlxuICAgKiAqICoqbmdEYmxjbGljayoqXG4gICAqICogKipuZ01lc3NhZ2VzKipcbiAgICogKiAqKm5nRGlzYWJsZWQqKlxuICAgKlxuICAgKiBSZWFkIHRoZSB7QGxpbmsgZ3VpZGUvYWNjZXNzaWJpbGl0eSBuZ0FyaWEgRGV2ZWxvcGVyIEd1aWRlfSBmb3IgYSB0aG9yb3VnaCBleHBsYW5hdGlvbiBvZiBlYWNoXG4gICAqIGRpcmVjdGl2ZS5cbiAgICpcbiAgICpcbiAgICogIyMgRGVwZW5kZW5jaWVzXG4gICAqIFJlcXVpcmVzIHRoZSB7QGxpbmsgbmdBcmlhfSBtb2R1bGUgdG8gYmUgaW5zdGFsbGVkLlxuICAgKi9cbiAgdGhpcy4kZ2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGNvbmZpZzogZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgIHJldHVybiBjb25maWdba2V5XTtcbiAgICAgIH0sXG4gICAgICAkJHdhdGNoRXhwcjogd2F0Y2hFeHByXG4gICAgfTtcbiAgfTtcbn1cblxuXG5uZ0FyaWFNb2R1bGUuZGlyZWN0aXZlKCduZ1Nob3cnLCBbJyRhcmlhJywgZnVuY3Rpb24oJGFyaWEpIHtcbiAgcmV0dXJuICRhcmlhLiQkd2F0Y2hFeHByKCduZ1Nob3cnLCAnYXJpYS1oaWRkZW4nLCB0cnVlKTtcbn1dKVxuLmRpcmVjdGl2ZSgnbmdIaWRlJywgWyckYXJpYScsIGZ1bmN0aW9uKCRhcmlhKSB7XG4gIHJldHVybiAkYXJpYS4kJHdhdGNoRXhwcignbmdIaWRlJywgJ2FyaWEtaGlkZGVuJywgZmFsc2UpO1xufV0pXG4uZGlyZWN0aXZlKCduZ01vZGVsJywgWyckYXJpYScsIGZ1bmN0aW9uKCRhcmlhKSB7XG5cbiAgZnVuY3Rpb24gc2hvdWxkQXR0YWNoQXR0cihhdHRyLCBub3JtYWxpemVkQXR0ciwgZWxlbSkge1xuICAgIHJldHVybiAkYXJpYS5jb25maWcobm9ybWFsaXplZEF0dHIpICYmICFlbGVtLmF0dHIoYXR0cik7XG4gIH1cblxuICBmdW5jdGlvbiBnZXRTaGFwZShhdHRyLCBlbGVtKSB7XG4gICAgdmFyIHR5cGUgPSBhdHRyLnR5cGUsXG4gICAgICAgIHJvbGUgPSBhdHRyLnJvbGU7XG5cbiAgICByZXR1cm4gKCh0eXBlIHx8IHJvbGUpID09PSAnY2hlY2tib3gnIHx8IHJvbGUgPT09ICdtZW51aXRlbWNoZWNrYm94JykgPyAnY2hlY2tib3gnIDpcbiAgICAgICAgICAgKCh0eXBlIHx8IHJvbGUpID09PSAncmFkaW8nICAgIHx8IHJvbGUgPT09ICdtZW51aXRlbXJhZGlvJykgPyAncmFkaW8nIDpcbiAgICAgICAgICAgKHR5cGUgPT09ICdyYW5nZScgICAgICAgICAgICAgIHx8IHJvbGUgPT09ICdwcm9ncmVzc2JhcicgfHwgcm9sZSA9PT0gJ3NsaWRlcicpID8gJ3JhbmdlJyA6XG4gICAgICAgICAgICh0eXBlIHx8IHJvbGUpID09PSAndGV4dGJveCcgICB8fCBlbGVtWzBdLm5vZGVOYW1lID09PSAnVEVYVEFSRUEnID8gJ211bHRpbGluZScgOiAnJztcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdBJyxcbiAgICByZXF1aXJlOiAnP25nTW9kZWwnLFxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtLCBhdHRyLCBuZ01vZGVsKSB7XG4gICAgICB2YXIgc2hhcGUgPSBnZXRTaGFwZShhdHRyLCBlbGVtKTtcbiAgICAgIHZhciBuZWVkc1RhYkluZGV4ID0gc2hvdWxkQXR0YWNoQXR0cigndGFiaW5kZXgnLCAndGFiaW5kZXgnLCBlbGVtKTtcblxuICAgICAgZnVuY3Rpb24gbmdBcmlhV2F0Y2hNb2RlbFZhbHVlKCkge1xuICAgICAgICByZXR1cm4gbmdNb2RlbC4kbW9kZWxWYWx1ZTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gZ2V0UmFkaW9SZWFjdGlvbigpIHtcbiAgICAgICAgaWYgKG5lZWRzVGFiSW5kZXgpIHtcbiAgICAgICAgICBuZWVkc1RhYkluZGV4ID0gZmFsc2U7XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIG5nQXJpYVJhZGlvUmVhY3Rpb24obmV3VmFsKSB7XG4gICAgICAgICAgICB2YXIgYm9vbFZhbCA9IG5ld1ZhbCA9PT0gYXR0ci52YWx1ZTtcbiAgICAgICAgICAgIGVsZW0uYXR0cignYXJpYS1jaGVja2VkJywgYm9vbFZhbCk7XG4gICAgICAgICAgICBlbGVtLmF0dHIoJ3RhYmluZGV4JywgMCAtICFib29sVmFsKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBuZ0FyaWFSYWRpb1JlYWN0aW9uKG5ld1ZhbCkge1xuICAgICAgICAgICAgZWxlbS5hdHRyKCdhcmlhLWNoZWNrZWQnLCBuZXdWYWwgPT09IGF0dHIudmFsdWUpO1xuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gbmdBcmlhQ2hlY2tib3hSZWFjdGlvbihuZXdWYWwpIHtcbiAgICAgICAgZWxlbS5hdHRyKCdhcmlhLWNoZWNrZWQnLCAhIW5ld1ZhbCk7XG4gICAgICB9XG5cbiAgICAgIHN3aXRjaCAoc2hhcGUpIHtcbiAgICAgICAgY2FzZSAncmFkaW8nOlxuICAgICAgICBjYXNlICdjaGVja2JveCc6XG4gICAgICAgICAgaWYgKHNob3VsZEF0dGFjaEF0dHIoJ2FyaWEtY2hlY2tlZCcsICdhcmlhQ2hlY2tlZCcsIGVsZW0pKSB7XG4gICAgICAgICAgICBzY29wZS4kd2F0Y2gobmdBcmlhV2F0Y2hNb2RlbFZhbHVlLCBzaGFwZSA9PT0gJ3JhZGlvJyA/XG4gICAgICAgICAgICAgICAgZ2V0UmFkaW9SZWFjdGlvbigpIDogbmdBcmlhQ2hlY2tib3hSZWFjdGlvbik7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdyYW5nZSc6XG4gICAgICAgICAgaWYgKCRhcmlhLmNvbmZpZygnYXJpYVZhbHVlJykpIHtcbiAgICAgICAgICAgIGlmIChhdHRyLm1pbiAmJiAhZWxlbS5hdHRyKCdhcmlhLXZhbHVlbWluJykpIHtcbiAgICAgICAgICAgICAgZWxlbS5hdHRyKCdhcmlhLXZhbHVlbWluJywgYXR0ci5taW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGF0dHIubWF4ICYmICFlbGVtLmF0dHIoJ2FyaWEtdmFsdWVtYXgnKSkge1xuICAgICAgICAgICAgICBlbGVtLmF0dHIoJ2FyaWEtdmFsdWVtYXgnLCBhdHRyLm1heCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWVsZW0uYXR0cignYXJpYS12YWx1ZW5vdycpKSB7XG4gICAgICAgICAgICAgIHNjb3BlLiR3YXRjaChuZ0FyaWFXYXRjaE1vZGVsVmFsdWUsIGZ1bmN0aW9uIG5nQXJpYVZhbHVlTm93UmVhY3Rpb24obmV3VmFsKSB7XG4gICAgICAgICAgICAgICAgZWxlbS5hdHRyKCdhcmlhLXZhbHVlbm93JywgbmV3VmFsKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdtdWx0aWxpbmUnOlxuICAgICAgICAgIGlmIChzaG91bGRBdHRhY2hBdHRyKCdhcmlhLW11bHRpbGluZScsICdhcmlhTXVsdGlsaW5lJywgZWxlbSkpIHtcbiAgICAgICAgICAgIGVsZW0uYXR0cignYXJpYS1tdWx0aWxpbmUnLCB0cnVlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGlmIChuZWVkc1RhYkluZGV4KSB7XG4gICAgICAgIGVsZW0uYXR0cigndGFiaW5kZXgnLCAwKTtcbiAgICAgIH1cblxuICAgICAgaWYgKG5nTW9kZWwuJHZhbGlkYXRvcnMucmVxdWlyZWQgJiYgc2hvdWxkQXR0YWNoQXR0cignYXJpYS1yZXF1aXJlZCcsICdhcmlhUmVxdWlyZWQnLCBlbGVtKSkge1xuICAgICAgICBzY29wZS4kd2F0Y2goZnVuY3Rpb24gbmdBcmlhUmVxdWlyZWRXYXRjaCgpIHtcbiAgICAgICAgICByZXR1cm4gbmdNb2RlbC4kZXJyb3IucmVxdWlyZWQ7XG4gICAgICAgIH0sIGZ1bmN0aW9uIG5nQXJpYVJlcXVpcmVkUmVhY3Rpb24obmV3VmFsKSB7XG4gICAgICAgICAgZWxlbS5hdHRyKCdhcmlhLXJlcXVpcmVkJywgISFuZXdWYWwpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKHNob3VsZEF0dGFjaEF0dHIoJ2FyaWEtaW52YWxpZCcsICdhcmlhSW52YWxpZCcsIGVsZW0pKSB7XG4gICAgICAgIHNjb3BlLiR3YXRjaChmdW5jdGlvbiBuZ0FyaWFJbnZhbGlkV2F0Y2goKSB7XG4gICAgICAgICAgcmV0dXJuIG5nTW9kZWwuJGludmFsaWQ7XG4gICAgICAgIH0sIGZ1bmN0aW9uIG5nQXJpYUludmFsaWRSZWFjdGlvbihuZXdWYWwpIHtcbiAgICAgICAgICBlbGVtLmF0dHIoJ2FyaWEtaW52YWxpZCcsICEhbmV3VmFsKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xufV0pXG4uZGlyZWN0aXZlKCduZ0Rpc2FibGVkJywgWyckYXJpYScsIGZ1bmN0aW9uKCRhcmlhKSB7XG4gIHJldHVybiAkYXJpYS4kJHdhdGNoRXhwcignbmdEaXNhYmxlZCcsICdhcmlhLWRpc2FibGVkJyk7XG59XSlcbi5kaXJlY3RpdmUoJ25nTWVzc2FnZXMnLCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIHJlcXVpcmU6ICc/bmdNZXNzYWdlcycsXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW0sIGF0dHIsIG5nTWVzc2FnZXMpIHtcbiAgICAgIGlmICghZWxlbS5hdHRyKCdhcmlhLWxpdmUnKSkge1xuICAgICAgICBlbGVtLmF0dHIoJ2FyaWEtbGl2ZScsICdhc3NlcnRpdmUnKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG59KVxuLmRpcmVjdGl2ZSgnbmdDbGljaycsWyckYXJpYScsICckcGFyc2UnLCBmdW5jdGlvbigkYXJpYSwgJHBhcnNlKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdBJyxcbiAgICBjb21waWxlOiBmdW5jdGlvbihlbGVtLCBhdHRyKSB7XG4gICAgICB2YXIgZm4gPSAkcGFyc2UoYXR0ci5uZ0NsaWNrLCAvKiBpbnRlcmNlcHRvckZuICovIG51bGwsIC8qIGV4cGVuc2l2ZUNoZWNrcyAqLyB0cnVlKTtcbiAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgZWxlbSwgYXR0cikge1xuICAgICAgICBpZiAoJGFyaWEuY29uZmlnKCd0YWJpbmRleCcpICYmICFlbGVtLmF0dHIoJ3RhYmluZGV4JykpIHtcbiAgICAgICAgICBlbGVtLmF0dHIoJ3RhYmluZGV4JywgMCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoJGFyaWEuY29uZmlnKCdiaW5kS2V5cHJlc3MnKSAmJiAhYXR0ci5uZ0tleXByZXNzKSB7XG4gICAgICAgICAgZWxlbS5vbigna2V5cHJlc3MnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDMyIHx8IGV2ZW50LmtleUNvZGUgPT09IDEzKSB7XG4gICAgICAgICAgICAgIHNjb3BlLiRhcHBseShjYWxsYmFjayk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNhbGxiYWNrKCkge1xuICAgICAgICAgICAgICBmbihzY29wZSwgeyAkZXZlbnQ6IGV2ZW50IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfTtcbn1dKVxuLmRpcmVjdGl2ZSgnbmdEYmxjbGljaycsIFsnJGFyaWEnLCBmdW5jdGlvbigkYXJpYSkge1xuICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW0sIGF0dHIpIHtcbiAgICBpZiAoJGFyaWEuY29uZmlnKCd0YWJpbmRleCcpICYmICFlbGVtLmF0dHIoJ3RhYmluZGV4JykpIHtcbiAgICAgIGVsZW0uYXR0cigndGFiaW5kZXgnLCAwKTtcbiAgICB9XG4gIH07XG59XSk7XG5cblxufSkod2luZG93LCB3aW5kb3cuYW5ndWxhcik7XG4iLCIvKiFcbiAqIEFuZ3VsYXIgTWF0ZXJpYWwgRGVzaWduXG4gKiBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9tYXRlcmlhbFxuICogQGxpY2Vuc2UgTUlUXG4gKiB2MC4xMC4wLW1hc3Rlci02ZTlhYmRkXG4gKi9cbihmdW5jdGlvbiggd2luZG93LCBhbmd1bGFyLCB1bmRlZmluZWQgKXtcblwidXNlIHN0cmljdFwiO1xuXG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG5hbmd1bGFyLm1vZHVsZSgnbmdNYXRlcmlhbCcsIFtcIm5nXCIsXCJuZ0FuaW1hdGVcIixcIm5nQXJpYVwiLFwibWF0ZXJpYWwuY29yZVwiLFwibWF0ZXJpYWwuY29yZS5nZXN0dXJlc1wiLFwibWF0ZXJpYWwuY29yZS50aGVtaW5nLnBhbGV0dGVcIixcIm1hdGVyaWFsLmNvcmUudGhlbWluZ1wiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5hdXRvY29tcGxldGVcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuYmFja2Ryb3BcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuYm90dG9tU2hlZXRcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuYnV0dG9uXCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLmNhcmRcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuY2hlY2tib3hcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuY2hpcHNcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuY29udGVudFwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5kaWFsb2dcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuZGl2aWRlclwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5mYWJBY3Rpb25zXCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLmZhYlNwZWVkRGlhbFwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5mYWJUb29sYmFyXCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLmZhYlRyaWdnZXJcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuZ3JpZExpc3RcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuaWNvblwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5pbnB1dFwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5saXN0XCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLm1lbnVcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMucHJvZ3Jlc3NDaXJjdWxhclwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5wcm9ncmVzc0xpbmVhclwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5yYWRpb0J1dHRvblwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5zZWxlY3RcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuc2lkZW5hdlwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5zbGlkZXJcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuc3RpY2t5XCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLnN1YmhlYWRlclwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5zd2lwZVwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5zd2l0Y2hcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMudGFic1wiLFwibWF0ZXJpYWwuY29tcG9uZW50cy50b2FzdFwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy50b29sYmFyXCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLnRvb2x0aXBcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMud2hpdGVmcmFtZVwiXSk7XG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuXG4vKipcbiAqIEluaXRpYWxpemF0aW9uIGZ1bmN0aW9uIHRoYXQgdmFsaWRhdGVzIGVudmlyb25tZW50XG4gKiByZXF1aXJlbWVudHMuXG4gKi9cbmFuZ3VsYXJcbiAgLm1vZHVsZSgnbWF0ZXJpYWwuY29yZScsIFsgJ21hdGVyaWFsLmNvcmUuZ2VzdHVyZXMnLCAnbWF0ZXJpYWwuY29yZS50aGVtaW5nJyBdKVxuICAuY29uZmlnKCBNZENvcmVDb25maWd1cmUgKTtcblxuXG5mdW5jdGlvbiBNZENvcmVDb25maWd1cmUoJHByb3ZpZGUsICRtZFRoZW1pbmdQcm92aWRlcikge1xuXG4gICRwcm92aWRlLmRlY29yYXRvcignJCRyQUYnLCBbXCIkZGVsZWdhdGVcIiwgckFGRGVjb3JhdG9yXSk7XG5cbiAgJG1kVGhlbWluZ1Byb3ZpZGVyLnRoZW1lKCdkZWZhdWx0JylcbiAgICAucHJpbWFyeVBhbGV0dGUoJ2luZGlnbycpXG4gICAgLmFjY2VudFBhbGV0dGUoJ3BpbmsnKVxuICAgIC53YXJuUGFsZXR0ZSgncmVkJylcbiAgICAuYmFja2dyb3VuZFBhbGV0dGUoJ2dyZXknKTtcbn1cbk1kQ29yZUNvbmZpZ3VyZS4kaW5qZWN0ID0gW1wiJHByb3ZpZGVcIiwgXCIkbWRUaGVtaW5nUHJvdmlkZXJcIl07XG5cbmZ1bmN0aW9uIHJBRkRlY29yYXRvciggJGRlbGVnYXRlICkge1xuICAvKipcbiAgICogVXNlIHRoaXMgdG8gdGhyb3R0bGUgZXZlbnRzIHRoYXQgY29tZSBpbiBvZnRlbi5cbiAgICogVGhlIHRocm90dGxlZCBmdW5jdGlvbiB3aWxsIGFsd2F5cyB1c2UgdGhlICpsYXN0KiBpbnZvY2F0aW9uIGJlZm9yZSB0aGVcbiAgICogY29taW5nIGZyYW1lLlxuICAgKlxuICAgKiBGb3IgZXhhbXBsZSwgd2luZG93IHJlc2l6ZSBldmVudHMgdGhhdCBmaXJlIG1hbnkgdGltZXMgYSBzZWNvbmQ6XG4gICAqIElmIHdlIHNldCB0byB1c2UgYW4gcmFmLXRocm90dGxlZCBjYWxsYmFjayBvbiB3aW5kb3cgcmVzaXplLCB0aGVuXG4gICAqIG91ciBjYWxsYmFjayB3aWxsIG9ubHkgYmUgZmlyZWQgb25jZSBwZXIgZnJhbWUsIHdpdGggdGhlIGxhc3QgcmVzaXplXG4gICAqIGV2ZW50IHRoYXQgaGFwcGVuZWQgYmVmb3JlIHRoYXQgZnJhbWUuXG4gICAqXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIGZ1bmN0aW9uIHRvIGRlYm91bmNlXG4gICAqL1xuICAkZGVsZWdhdGUudGhyb3R0bGUgPSBmdW5jdGlvbihjYikge1xuICAgIHZhciBxdWV1ZUFyZ3MsIGFscmVhZHlRdWV1ZWQsIHF1ZXVlQ2IsIGNvbnRleHQ7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIGRlYm91bmNlZCgpIHtcbiAgICAgIHF1ZXVlQXJncyA9IGFyZ3VtZW50cztcbiAgICAgIGNvbnRleHQgPSB0aGlzO1xuICAgICAgcXVldWVDYiA9IGNiO1xuICAgICAgaWYgKCFhbHJlYWR5UXVldWVkKSB7XG4gICAgICAgIGFscmVhZHlRdWV1ZWQgPSB0cnVlO1xuICAgICAgICAkZGVsZWdhdGUoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcXVldWVDYi5hcHBseShjb250ZXh0LCBxdWV1ZUFyZ3MpO1xuICAgICAgICAgIGFscmVhZHlRdWV1ZWQgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgfTtcbiAgcmV0dXJuICRkZWxlZ2F0ZTtcbn1cblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb3JlJylcbi5mYWN0b3J5KCckbWRDb25zdGFudCcsIE1kQ29uc3RhbnRGYWN0b3J5KTtcblxuZnVuY3Rpb24gTWRDb25zdGFudEZhY3RvcnkoJCRyQUYsICRzbmlmZmVyKSB7XG5cbiAgdmFyIHdlYmtpdCA9IC93ZWJraXQvaS50ZXN0KCRzbmlmZmVyLnZlbmRvclByZWZpeCk7XG4gIGZ1bmN0aW9uIHZlbmRvclByb3BlcnR5KG5hbWUpIHtcbiAgICByZXR1cm4gd2Via2l0ID8gICgnd2Via2l0JyArIG5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnN1YnN0cmluZygxKSkgOiBuYW1lO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBLRVlfQ09ERToge1xuICAgICAgRU5URVI6IDEzLFxuICAgICAgRVNDQVBFOiAyNyxcbiAgICAgIFNQQUNFOiAzMixcbiAgICAgIExFRlRfQVJST1cgOiAzNyxcbiAgICAgIFVQX0FSUk9XIDogMzgsXG4gICAgICBSSUdIVF9BUlJPVyA6IDM5LFxuICAgICAgRE9XTl9BUlJPVyA6IDQwLFxuICAgICAgVEFCIDogOSxcbiAgICAgIEJBQ0tTUEFDRTogOCxcbiAgICAgIERFTEVURTogNDZcbiAgICB9LFxuICAgIENTUzoge1xuICAgICAgLyogQ29uc3RhbnRzICovXG4gICAgICBUUkFOU0lUSU9ORU5EOiAndHJhbnNpdGlvbmVuZCcgKyAod2Via2l0ID8gJyB3ZWJraXRUcmFuc2l0aW9uRW5kJyA6ICcnKSxcbiAgICAgIEFOSU1BVElPTkVORDogJ2FuaW1hdGlvbmVuZCcgKyAod2Via2l0ID8gJyB3ZWJraXRBbmltYXRpb25FbmQnIDogJycpLFxuXG4gICAgICBUUkFOU0ZPUk06IHZlbmRvclByb3BlcnR5KCd0cmFuc2Zvcm0nKSxcbiAgICAgIFRSQU5TRk9STV9PUklHSU46IHZlbmRvclByb3BlcnR5KCd0cmFuc2Zvcm1PcmlnaW4nKSxcbiAgICAgIFRSQU5TSVRJT046IHZlbmRvclByb3BlcnR5KCd0cmFuc2l0aW9uJyksXG4gICAgICBUUkFOU0lUSU9OX0RVUkFUSU9OOiB2ZW5kb3JQcm9wZXJ0eSgndHJhbnNpdGlvbkR1cmF0aW9uJyksXG4gICAgICBBTklNQVRJT05fUExBWV9TVEFURTogdmVuZG9yUHJvcGVydHkoJ2FuaW1hdGlvblBsYXlTdGF0ZScpLFxuICAgICAgQU5JTUFUSU9OX0RVUkFUSU9OOiB2ZW5kb3JQcm9wZXJ0eSgnYW5pbWF0aW9uRHVyYXRpb24nKSxcbiAgICAgIEFOSU1BVElPTl9OQU1FOiB2ZW5kb3JQcm9wZXJ0eSgnYW5pbWF0aW9uTmFtZScpLFxuICAgICAgQU5JTUFUSU9OX1RJTUlORzogdmVuZG9yUHJvcGVydHkoJ2FuaW1hdGlvblRpbWluZ0Z1bmN0aW9uJyksXG4gICAgICBBTklNQVRJT05fRElSRUNUSU9OOiB2ZW5kb3JQcm9wZXJ0eSgnYW5pbWF0aW9uRGlyZWN0aW9uJylcbiAgICB9LFxuICAgIE1FRElBOiB7XG4gICAgICAnc20nOiAnKG1heC13aWR0aDogNjAwcHgpJyxcbiAgICAgICdndC1zbSc6ICcobWluLXdpZHRoOiA2MDBweCknLFxuICAgICAgJ21kJzogJyhtaW4td2lkdGg6IDYwMHB4KSBhbmQgKG1heC13aWR0aDogOTYwcHgpJyxcbiAgICAgICdndC1tZCc6ICcobWluLXdpZHRoOiA5NjBweCknLFxuICAgICAgJ2xnJzogJyhtaW4td2lkdGg6IDk2MHB4KSBhbmQgKG1heC13aWR0aDogMTIwMHB4KScsXG4gICAgICAnZ3QtbGcnOiAnKG1pbi13aWR0aDogMTIwMHB4KSdcbiAgICB9LFxuICAgIE1FRElBX1BSSU9SSVRZOiBbXG4gICAgICAnZ3QtbGcnLFxuICAgICAgJ2xnJyxcbiAgICAgICdndC1tZCcsXG4gICAgICAnbWQnLFxuICAgICAgJ2d0LXNtJyxcbiAgICAgICdzbSdcbiAgICBdXG4gIH07XG59XG5NZENvbnN0YW50RmFjdG9yeS4kaW5qZWN0ID0gW1wiJCRyQUZcIiwgXCIkc25pZmZlclwiXTtcblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvcmUnKVxuICAgIC5jb25maWcoIFtcIiRwcm92aWRlXCIsIGZ1bmN0aW9uKCRwcm92aWRlKXtcbiAgICAgICAkcHJvdmlkZS5kZWNvcmF0b3IoJyRtZFV0aWwnLCBbJyRkZWxlZ2F0ZScsIGZ1bmN0aW9uICgkZGVsZWdhdGUpe1xuICAgICAgICAgICAvKipcbiAgICAgICAgICAgICogSW5qZWN0IHRoZSBpdGVyYXRvciBmYWNhZGUgdG8gZWFzaWx5IHN1cHBvcnQgaXRlcmF0aW9uIGFuZCBhY2Nlc3NvcnNcbiAgICAgICAgICAgICogQHNlZSBpdGVyYXRvciBiZWxvd1xuICAgICAgICAgICAgKi9cbiAgICAgICAgICAgJGRlbGVnYXRlLml0ZXJhdG9yID0gTWRJdGVyYXRvcjtcblxuICAgICAgICAgICByZXR1cm4gJGRlbGVnYXRlO1xuICAgICAgICAgfVxuICAgICAgIF0pO1xuICAgICB9XSk7XG5cbiAgLyoqXG4gICAqIGl0ZXJhdG9yIGlzIGEgbGlzdCBmYWNhZGUgdG8gZWFzaWx5IHN1cHBvcnQgaXRlcmF0aW9uIGFuZCBhY2Nlc3NvcnNcbiAgICpcbiAgICogQHBhcmFtIGl0ZW1zIEFycmF5IGxpc3Qgd2hpY2ggdGhpcyBpdGVyYXRvciB3aWxsIGVudW1lcmF0ZVxuICAgKiBAcGFyYW0gcmVsb29wIEJvb2xlYW4gZW5hYmxlcyBpdGVyYXRvciB0byBjb25zaWRlciB0aGUgbGlzdCBhcyBhbiBlbmRsZXNzIHJlbG9vcFxuICAgKi9cbiAgZnVuY3Rpb24gTWRJdGVyYXRvcihpdGVtcywgcmVsb29wKSB7XG4gICAgdmFyIHRydWVGbiA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdHJ1ZTsgfTtcblxuICAgIGlmIChpdGVtcyAmJiAhYW5ndWxhci5pc0FycmF5KGl0ZW1zKSkge1xuICAgICAgaXRlbXMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChpdGVtcyk7XG4gICAgfVxuXG4gICAgcmVsb29wID0gISFyZWxvb3A7XG4gICAgdmFyIF9pdGVtcyA9IGl0ZW1zIHx8IFsgXTtcblxuICAgIC8vIFB1Ymxpc2hlZCBBUElcbiAgICByZXR1cm4ge1xuICAgICAgaXRlbXM6IGdldEl0ZW1zLFxuICAgICAgY291bnQ6IGNvdW50LFxuXG4gICAgICBpblJhbmdlOiBpblJhbmdlLFxuICAgICAgY29udGFpbnM6IGNvbnRhaW5zLFxuICAgICAgaW5kZXhPZjogaW5kZXhPZixcbiAgICAgIGl0ZW1BdDogaXRlbUF0LFxuXG4gICAgICBmaW5kQnk6IGZpbmRCeSxcblxuICAgICAgYWRkOiBhZGQsXG4gICAgICByZW1vdmU6IHJlbW92ZSxcblxuICAgICAgZmlyc3Q6IGZpcnN0LFxuICAgICAgbGFzdDogbGFzdCxcbiAgICAgIG5leHQ6IGFuZ3VsYXIuYmluZChudWxsLCBmaW5kU3Vic2VxdWVudEl0ZW0sIGZhbHNlKSxcbiAgICAgIHByZXZpb3VzOiBhbmd1bGFyLmJpbmQobnVsbCwgZmluZFN1YnNlcXVlbnRJdGVtLCB0cnVlKSxcblxuICAgICAgaGFzUHJldmlvdXM6IGhhc1ByZXZpb3VzLFxuICAgICAgaGFzTmV4dDogaGFzTmV4dFxuXG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFB1Ymxpc2ggY29weSBvZiB0aGUgZW51bWVyYWJsZSBzZXRcbiAgICAgKiBAcmV0dXJucyB7QXJyYXl8Kn1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRJdGVtcygpIHtcbiAgICAgIHJldHVybiBbXS5jb25jYXQoX2l0ZW1zKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXRlcm1pbmUgbGVuZ3RoIG9mIHRoZSBsaXN0XG4gICAgICogQHJldHVybnMge0FycmF5Lmxlbmd0aHwqfG51bWJlcn1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb3VudCgpIHtcbiAgICAgIHJldHVybiBfaXRlbXMubGVuZ3RoO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIElzIHRoZSBpbmRleCBzcGVjaWZpZWQgdmFsaWRcbiAgICAgKiBAcGFyYW0gaW5kZXhcbiAgICAgKiBAcmV0dXJucyB7QXJyYXkubGVuZ3RofCp8bnVtYmVyfGJvb2xlYW59XG4gICAgICovXG4gICAgZnVuY3Rpb24gaW5SYW5nZShpbmRleCkge1xuICAgICAgcmV0dXJuIF9pdGVtcy5sZW5ndGggJiYgKCBpbmRleCA+IC0xICkgJiYgKGluZGV4IDwgX2l0ZW1zLmxlbmd0aCApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbiB0aGUgaXRlcmF0b3IgcHJvY2VlZCB0byB0aGUgbmV4dCBpdGVtIGluIHRoZSBsaXN0OyByZWxhdGl2ZSB0b1xuICAgICAqIHRoZSBzcGVjaWZpZWQgaXRlbS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBpdGVtXG4gICAgICogQHJldHVybnMge0FycmF5Lmxlbmd0aHwqfG51bWJlcnxib29sZWFufVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGhhc05leHQoaXRlbSkge1xuICAgICAgcmV0dXJuIGl0ZW0gPyBpblJhbmdlKGluZGV4T2YoaXRlbSkgKyAxKSA6IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbiB0aGUgaXRlcmF0b3IgcHJvY2VlZCB0byB0aGUgcHJldmlvdXMgaXRlbSBpbiB0aGUgbGlzdDsgcmVsYXRpdmUgdG9cbiAgICAgKiB0aGUgc3BlY2lmaWVkIGl0ZW0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gaXRlbVxuICAgICAqIEByZXR1cm5zIHtBcnJheS5sZW5ndGh8KnxudW1iZXJ8Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBoYXNQcmV2aW91cyhpdGVtKSB7XG4gICAgICByZXR1cm4gaXRlbSA/IGluUmFuZ2UoaW5kZXhPZihpdGVtKSAtIDEpIDogZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGl0ZW0gYXQgc3BlY2lmaWVkIGluZGV4L3Bvc2l0aW9uXG4gICAgICogQHBhcmFtIGluZGV4XG4gICAgICogQHJldHVybnMgeyp9XG4gICAgICovXG4gICAgZnVuY3Rpb24gaXRlbUF0KGluZGV4KSB7XG4gICAgICByZXR1cm4gaW5SYW5nZShpbmRleCkgPyBfaXRlbXNbaW5kZXhdIDogbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaW5kIGFsbCBlbGVtZW50cyBtYXRjaGluZyB0aGUga2V5L3ZhbHVlIHBhaXJcbiAgICAgKiBvdGhlcndpc2UgcmV0dXJuIG51bGxcbiAgICAgKlxuICAgICAqIEBwYXJhbSB2YWxcbiAgICAgKiBAcGFyYW0ga2V5XG4gICAgICpcbiAgICAgKiBAcmV0dXJuIGFycmF5XG4gICAgICovXG4gICAgZnVuY3Rpb24gZmluZEJ5KGtleSwgdmFsKSB7XG4gICAgICByZXR1cm4gX2l0ZW1zLmZpbHRlcihmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIHJldHVybiBpdGVtW2tleV0gPT09IHZhbDtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBpdGVtIHRvIGxpc3RcbiAgICAgKiBAcGFyYW0gaXRlbVxuICAgICAqIEBwYXJhbSBpbmRleFxuICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFkZChpdGVtLCBpbmRleCkge1xuICAgICAgaWYgKCAhaXRlbSApIHJldHVybiAtMTtcblxuICAgICAgaWYgKCFhbmd1bGFyLmlzTnVtYmVyKGluZGV4KSkge1xuICAgICAgICBpbmRleCA9IF9pdGVtcy5sZW5ndGg7XG4gICAgICB9XG5cbiAgICAgIF9pdGVtcy5zcGxpY2UoaW5kZXgsIDAsIGl0ZW0pO1xuXG4gICAgICByZXR1cm4gaW5kZXhPZihpdGVtKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgaXRlbSBmcm9tIGxpc3QuLi5cbiAgICAgKiBAcGFyYW0gaXRlbVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlbW92ZShpdGVtKSB7XG4gICAgICBpZiAoIGNvbnRhaW5zKGl0ZW0pICl7XG4gICAgICAgIF9pdGVtcy5zcGxpY2UoaW5kZXhPZihpdGVtKSwgMSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSB6ZXJvLWJhc2VkIGluZGV4IG9mIHRoZSB0YXJnZXQgaXRlbVxuICAgICAqIEBwYXJhbSBpdGVtXG4gICAgICogQHJldHVybnMgeyp9XG4gICAgICovXG4gICAgZnVuY3Rpb24gaW5kZXhPZihpdGVtKSB7XG4gICAgICByZXR1cm4gX2l0ZW1zLmluZGV4T2YoaXRlbSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQm9vbGVhbiBleGlzdGVuY2UgY2hlY2tcbiAgICAgKiBAcGFyYW0gaXRlbVxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvbnRhaW5zKGl0ZW0pIHtcbiAgICAgIHJldHVybiBpdGVtICYmIChpbmRleE9mKGl0ZW0pID4gLTEpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiBmaXJzdCBpdGVtIGluIHRoZSBsaXN0XG4gICAgICogQHJldHVybnMgeyp9XG4gICAgICovXG4gICAgZnVuY3Rpb24gZmlyc3QoKSB7XG4gICAgICByZXR1cm4gX2l0ZW1zLmxlbmd0aCA/IF9pdGVtc1swXSA6IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIGxhc3QgaXRlbSBpbiB0aGUgbGlzdC4uLlxuICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGxhc3QoKSB7XG4gICAgICByZXR1cm4gX2l0ZW1zLmxlbmd0aCA/IF9pdGVtc1tfaXRlbXMubGVuZ3RoIC0gMV0gOiBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpbmQgdGhlIG5leHQgaXRlbS4gSWYgcmVsb29wIGlzIHRydWUgYW5kIGF0IHRoZSBlbmQgb2YgdGhlIGxpc3QsIGl0IHdpbGwgZ28gYmFjayB0byB0aGVcbiAgICAgKiBmaXJzdCBpdGVtLiBJZiBnaXZlbiwgdGhlIGB2YWxpZGF0ZWAgY2FsbGJhY2sgd2lsbCBiZSB1c2VkIHRvIGRldGVybWluZSB3aGV0aGVyIHRoZSBuZXh0IGl0ZW1cbiAgICAgKiBpcyB2YWxpZC4gSWYgbm90IHZhbGlkLCBpdCB3aWxsIHRyeSB0byBmaW5kIHRoZSBuZXh0IGl0ZW0gYWdhaW4uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGJhY2t3YXJkcyBTcGVjaWZpZXMgdGhlIGRpcmVjdGlvbiBvZiBzZWFyY2hpbmcgKGZvcndhcmRzL2JhY2t3YXJkcylcbiAgICAgKiBAcGFyYW0geyp9IGl0ZW0gVGhlIGl0ZW0gd2hvc2Ugc3Vic2VxdWVudCBpdGVtIHdlIGFyZSBsb29raW5nIGZvclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb249fSB2YWxpZGF0ZSBUaGUgYHZhbGlkYXRlYCBmdW5jdGlvblxuICAgICAqIEBwYXJhbSB7aW50ZWdlcj19IGxpbWl0IFRoZSByZWN1cnNpb24gbGltaXRcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHsqfSBUaGUgc3Vic2VxdWVudCBpdGVtIG9yIG51bGxcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBmaW5kU3Vic2VxdWVudEl0ZW0oYmFja3dhcmRzLCBpdGVtLCB2YWxpZGF0ZSwgbGltaXQpIHtcbiAgICAgIHZhbGlkYXRlID0gdmFsaWRhdGUgfHwgdHJ1ZUZuO1xuXG4gICAgICB2YXIgY3VySW5kZXggPSBpbmRleE9mKGl0ZW0pO1xuICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgaWYgKCFpblJhbmdlKGN1ckluZGV4KSkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgdmFyIG5leHRJbmRleCA9IGN1ckluZGV4ICsgKGJhY2t3YXJkcyA/IC0xIDogMSk7XG4gICAgICAgIHZhciBmb3VuZEl0ZW0gPSBudWxsO1xuICAgICAgICBpZiAoaW5SYW5nZShuZXh0SW5kZXgpKSB7XG4gICAgICAgICAgZm91bmRJdGVtID0gX2l0ZW1zW25leHRJbmRleF07XG4gICAgICAgIH0gZWxzZSBpZiAocmVsb29wKSB7XG4gICAgICAgICAgZm91bmRJdGVtID0gYmFja3dhcmRzID8gbGFzdCgpIDogZmlyc3QoKTtcbiAgICAgICAgICBuZXh0SW5kZXggPSBpbmRleE9mKGZvdW5kSXRlbSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoKGZvdW5kSXRlbSA9PT0gbnVsbCkgfHwgKG5leHRJbmRleCA9PT0gbGltaXQpKSByZXR1cm4gbnVsbDtcbiAgICAgICAgaWYgKHZhbGlkYXRlKGZvdW5kSXRlbSkpIHJldHVybiBmb3VuZEl0ZW07XG5cbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQobGltaXQpKSBsaW1pdCA9IG5leHRJbmRleDtcblxuICAgICAgICBjdXJJbmRleCA9IG5leHRJbmRleDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuXG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvcmUnKVxuLmZhY3RvcnkoJyRtZE1lZGlhJywgbWRNZWRpYUZhY3RvcnkpO1xuXG4vKipcbiAqIEBuZ2RvYyBzZXJ2aWNlXG4gKiBAbmFtZSAkbWRNZWRpYVxuICogQG1vZHVsZSBtYXRlcmlhbC5jb3JlXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBgJG1kTWVkaWFgIGlzIHVzZWQgdG8gZXZhbHVhdGUgd2hldGhlciBhIGdpdmVuIG1lZGlhIHF1ZXJ5IGlzIHRydWUgb3IgZmFsc2UgZ2l2ZW4gdGhlXG4gKiBjdXJyZW50IGRldmljZSdzIHNjcmVlbiAvIHdpbmRvdyBzaXplLiBUaGUgbWVkaWEgcXVlcnkgd2lsbCBiZSByZS1ldmFsdWF0ZWQgb24gcmVzaXplLCBhbGxvd2luZ1xuICogeW91IHRvIHJlZ2lzdGVyIGEgd2F0Y2guXG4gKlxuICogYCRtZE1lZGlhYCBhbHNvIGhhcyBwcmUtcHJvZ3JhbW1lZCBzdXBwb3J0IGZvciBtZWRpYSBxdWVyaWVzIHRoYXQgbWF0Y2ggdGhlIGxheW91dCBicmVha3BvaW50cy5cbiAqICAoYHNtYCwgYGd0LXNtYCwgYG1kYCwgYGd0LW1kYCwgYGxnYCwgYGd0LWxnYCkuXG4gKlxuICogQHJldHVybnMge2Jvb2xlYW59IGEgYm9vbGVhbiByZXByZXNlbnRpbmcgd2hldGhlciBvciBub3QgdGhlIGdpdmVuIG1lZGlhIHF1ZXJ5IGlzIHRydWUgb3IgZmFsc2UuXG4gKlxuICogQHVzYWdlXG4gKiA8aGxqcyBsYW5nPVwianNcIj5cbiAqIGFwcC5jb250cm9sbGVyKCdNeUNvbnRyb2xsZXInLCBmdW5jdGlvbigkbWRNZWRpYSwgJHNjb3BlKSB7XG4gKiAgICRzY29wZS4kd2F0Y2goZnVuY3Rpb24oKSB7IHJldHVybiAkbWRNZWRpYSgnbGcnKTsgfSwgZnVuY3Rpb24oYmlnKSB7XG4gKiAgICAgJHNjb3BlLmJpZ1NjcmVlbiA9IGJpZztcbiAqICAgfSk7XG4gKlxuICogICAkc2NvcGUuc2NyZWVuSXNTbWFsbCA9ICRtZE1lZGlhKCdzbScpO1xuICogICAkc2NvcGUuY3VzdG9tUXVlcnkgPSAkbWRNZWRpYSgnKG1pbi13aWR0aDogMTIzNHB4KScpO1xuICogICAkc2NvcGUuYW5vdGhlckN1c3RvbSA9ICRtZE1lZGlhKCdtYXgtd2lkdGg6IDMwMHB4Jyk7XG4gKiB9KTtcbiAqIDwvaGxqcz5cbiAqL1xuXG5mdW5jdGlvbiBtZE1lZGlhRmFjdG9yeSgkbWRDb25zdGFudCwgJHJvb3RTY29wZSwgJHdpbmRvdykge1xuICB2YXIgcXVlcmllcyA9IHt9O1xuICB2YXIgbXFscyA9IHt9O1xuICB2YXIgcmVzdWx0cyA9IHt9O1xuICB2YXIgbm9ybWFsaXplQ2FjaGUgPSB7fTtcblxuICAkbWRNZWRpYS5nZXRSZXNwb25zaXZlQXR0cmlidXRlID0gZ2V0UmVzcG9uc2l2ZUF0dHJpYnV0ZTtcbiAgJG1kTWVkaWEuZ2V0UXVlcnkgPSBnZXRRdWVyeTtcbiAgJG1kTWVkaWEud2F0Y2hSZXNwb25zaXZlQXR0cmlidXRlcyA9IHdhdGNoUmVzcG9uc2l2ZUF0dHJpYnV0ZXM7XG5cbiAgcmV0dXJuICRtZE1lZGlhO1xuXG4gIGZ1bmN0aW9uICRtZE1lZGlhKHF1ZXJ5KSB7XG4gICAgdmFyIHZhbGlkYXRlZCA9IHF1ZXJpZXNbcXVlcnldO1xuICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKHZhbGlkYXRlZCkpIHtcbiAgICAgIHZhbGlkYXRlZCA9IHF1ZXJpZXNbcXVlcnldID0gdmFsaWRhdGUocXVlcnkpO1xuICAgIH1cblxuICAgIHZhciByZXN1bHQgPSByZXN1bHRzW3ZhbGlkYXRlZF07XG4gICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQocmVzdWx0KSkge1xuICAgICAgcmVzdWx0ID0gYWRkKHZhbGlkYXRlZCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIGZ1bmN0aW9uIHZhbGlkYXRlKHF1ZXJ5KSB7XG4gICAgcmV0dXJuICRtZENvbnN0YW50Lk1FRElBW3F1ZXJ5XSB8fFxuICAgICAgICAgICAoKHF1ZXJ5LmNoYXJBdCgwKSAhPT0gJygnKSA/ICgnKCcgKyBxdWVyeSArICcpJykgOiBxdWVyeSk7XG4gIH1cblxuICBmdW5jdGlvbiBhZGQocXVlcnkpIHtcbiAgICB2YXIgcmVzdWx0ID0gbXFsc1txdWVyeV0gPSAkd2luZG93Lm1hdGNoTWVkaWEocXVlcnkpO1xuICAgIHJlc3VsdC5hZGRMaXN0ZW5lcihvblF1ZXJ5Q2hhbmdlKTtcbiAgICByZXR1cm4gKHJlc3VsdHNbcmVzdWx0Lm1lZGlhXSA9ICEhcmVzdWx0Lm1hdGNoZXMpO1xuICB9XG5cbiAgZnVuY3Rpb24gb25RdWVyeUNoYW5nZShxdWVyeSkge1xuICAgICRyb290U2NvcGUuJGV2YWxBc3luYyhmdW5jdGlvbigpIHtcbiAgICAgIHJlc3VsdHNbcXVlcnkubWVkaWFdID0gISFxdWVyeS5tYXRjaGVzO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0UXVlcnkobmFtZSkge1xuICAgIHJldHVybiBtcWxzW25hbWVdO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0UmVzcG9uc2l2ZUF0dHJpYnV0ZShhdHRycywgYXR0ck5hbWUpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8ICRtZENvbnN0YW50Lk1FRElBX1BSSU9SSVRZLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgbWVkaWFOYW1lID0gJG1kQ29uc3RhbnQuTUVESUFfUFJJT1JJVFlbaV07XG4gICAgICBpZiAoIW1xbHNbcXVlcmllc1ttZWRpYU5hbWVdXS5tYXRjaGVzKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgbm9ybWFsaXplZE5hbWUgPSBnZXROb3JtYWxpemVkTmFtZShhdHRycywgYXR0ck5hbWUgKyAnLScgKyBtZWRpYU5hbWUpO1xuICAgICAgaWYgKGF0dHJzW25vcm1hbGl6ZWROYW1lXSkge1xuICAgICAgICByZXR1cm4gYXR0cnNbbm9ybWFsaXplZE5hbWVdO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIGZhbGxiYWNrIG9uIHVucHJlZml4ZWRcbiAgICByZXR1cm4gYXR0cnNbZ2V0Tm9ybWFsaXplZE5hbWUoYXR0cnMsIGF0dHJOYW1lKV07XG4gIH1cblxuICBmdW5jdGlvbiB3YXRjaFJlc3BvbnNpdmVBdHRyaWJ1dGVzKGF0dHJOYW1lcywgYXR0cnMsIHdhdGNoRm4pIHtcbiAgICB2YXIgdW53YXRjaEZucyA9IFtdO1xuICAgIGF0dHJOYW1lcy5mb3JFYWNoKGZ1bmN0aW9uKGF0dHJOYW1lKSB7XG4gICAgICB2YXIgbm9ybWFsaXplZE5hbWUgPSBnZXROb3JtYWxpemVkTmFtZShhdHRycywgYXR0ck5hbWUpO1xuICAgICAgaWYgKGF0dHJzW25vcm1hbGl6ZWROYW1lXSkge1xuICAgICAgICB1bndhdGNoRm5zLnB1c2goXG4gICAgICAgICAgICBhdHRycy4kb2JzZXJ2ZShub3JtYWxpemVkTmFtZSwgYW5ndWxhci5iaW5kKHZvaWQgMCwgd2F0Y2hGbiwgbnVsbCkpKTtcbiAgICAgIH1cblxuICAgICAgZm9yICh2YXIgbWVkaWFOYW1lIGluICRtZENvbnN0YW50Lk1FRElBKSB7XG4gICAgICAgIG5vcm1hbGl6ZWROYW1lID0gZ2V0Tm9ybWFsaXplZE5hbWUoYXR0cnMsIGF0dHJOYW1lICsgJy0nICsgbWVkaWFOYW1lKTtcbiAgICAgICAgaWYgKCFhdHRyc1tub3JtYWxpemVkTmFtZV0pIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB1bndhdGNoRm5zLnB1c2goYXR0cnMuJG9ic2VydmUobm9ybWFsaXplZE5hbWUsIGFuZ3VsYXIuYmluZCh2b2lkIDAsIHdhdGNoRm4sIG1lZGlhTmFtZSkpKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBmdW5jdGlvbiB1bndhdGNoKCkge1xuICAgICAgdW53YXRjaEZucy5mb3JFYWNoKGZ1bmN0aW9uKGZuKSB7IGZuKCk7IH0pXG4gICAgfTtcbiAgfVxuXG4gIC8vIEltcHJvdmVzIHBlcmZvcm1hbmNlIGRyYW1hdGljYWxseVxuICBmdW5jdGlvbiBnZXROb3JtYWxpemVkTmFtZShhdHRycywgYXR0ck5hbWUpIHtcbiAgICByZXR1cm4gbm9ybWFsaXplQ2FjaGVbYXR0ck5hbWVdIHx8XG4gICAgICAgIChub3JtYWxpemVDYWNoZVthdHRyTmFtZV0gPSBhdHRycy4kbm9ybWFsaXplKGF0dHJOYW1lKSk7XG4gIH1cbn1cbm1kTWVkaWFGYWN0b3J5LiRpbmplY3QgPSBbXCIkbWRDb25zdGFudFwiLCBcIiRyb290U2NvcGVcIiwgXCIkd2luZG93XCJdO1xuXG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuLypcbiAqIFRoaXMgdmFyIGhhcyB0byBiZSBvdXRzaWRlIHRoZSBhbmd1bGFyIGZhY3RvcnksIG90aGVyd2lzZSB3aGVuXG4gKiB0aGVyZSBhcmUgbXVsdGlwbGUgbWF0ZXJpYWwgYXBwcyBvbiB0aGUgc2FtZSBwYWdlLCBlYWNoIGFwcFxuICogd2lsbCBjcmVhdGUgaXRzIG93biBpbnN0YW5jZSBvZiB0aGlzIGFycmF5IGFuZCB0aGUgYXBwJ3MgSURzXG4gKiB3aWxsIG5vdCBiZSB1bmlxdWUuXG4gKi9cbnZhciBuZXh0VW5pcXVlSWQgPSAwO1xuXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29yZScpXG4gIC5mYWN0b3J5KCckbWRVdGlsJywgW1wiJGNhY2hlRmFjdG9yeVwiLCBcIiRkb2N1bWVudFwiLCBcIiR0aW1lb3V0XCIsIFwiJHFcIiwgXCIkd2luZG93XCIsIFwiJG1kQ29uc3RhbnRcIiwgZnVuY3Rpb24gKCRjYWNoZUZhY3RvcnksICRkb2N1bWVudCwgJHRpbWVvdXQsICRxLCAkd2luZG93LCAkbWRDb25zdGFudCkge1xuICAgIHZhciBVdGlsO1xuXG4gICAgZnVuY3Rpb24gZ2V0Tm9kZShlbCkge1xuICAgICAgcmV0dXJuIGVsWzBdIHx8IGVsO1xuICAgIH1cblxuICAgIHJldHVybiBVdGlsID0ge1xuICAgICAgbm93OiB3aW5kb3cucGVyZm9ybWFuY2UgP1xuICAgICAgICBhbmd1bGFyLmJpbmQod2luZG93LnBlcmZvcm1hbmNlLCB3aW5kb3cucGVyZm9ybWFuY2Uubm93KSA6XG4gICAgICAgIERhdGUubm93LFxuXG4gICAgICBjbGllbnRSZWN0OiBmdW5jdGlvbiAoZWxlbWVudCwgb2Zmc2V0UGFyZW50LCBpc09mZnNldFJlY3QpIHtcbiAgICAgICAgdmFyIG5vZGUgPSBnZXROb2RlKGVsZW1lbnQpO1xuICAgICAgICBvZmZzZXRQYXJlbnQgPSBnZXROb2RlKG9mZnNldFBhcmVudCB8fCBub2RlLm9mZnNldFBhcmVudCB8fCBkb2N1bWVudC5ib2R5KTtcbiAgICAgICAgdmFyIG5vZGVSZWN0ID0gbm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgICAgICAvLyBUaGUgdXNlciBjYW4gYXNrIGZvciBhbiBvZmZzZXRSZWN0OiBhIHJlY3QgcmVsYXRpdmUgdG8gdGhlIG9mZnNldFBhcmVudCxcbiAgICAgICAgLy8gb3IgYSBjbGllbnRSZWN0OiBhIHJlY3QgcmVsYXRpdmUgdG8gdGhlIHBhZ2VcbiAgICAgICAgdmFyIG9mZnNldFJlY3QgPSBpc09mZnNldFJlY3QgP1xuICAgICAgICAgIG9mZnNldFBhcmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSA6XG4gICAgICAgIHtsZWZ0OiAwLCB0b3A6IDAsIHdpZHRoOiAwLCBoZWlnaHQ6IDB9O1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGxlZnQ6IG5vZGVSZWN0LmxlZnQgLSBvZmZzZXRSZWN0LmxlZnQsXG4gICAgICAgICAgdG9wOiBub2RlUmVjdC50b3AgLSBvZmZzZXRSZWN0LnRvcCxcbiAgICAgICAgICB3aWR0aDogbm9kZVJlY3Qud2lkdGgsXG4gICAgICAgICAgaGVpZ2h0OiBub2RlUmVjdC5oZWlnaHRcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgICBvZmZzZXRSZWN0OiBmdW5jdGlvbiAoZWxlbWVudCwgb2Zmc2V0UGFyZW50KSB7XG4gICAgICAgIHJldHVybiBVdGlsLmNsaWVudFJlY3QoZWxlbWVudCwgb2Zmc2V0UGFyZW50LCB0cnVlKTtcbiAgICAgIH0sXG5cbiAgICAgIC8vIEFubm95aW5nIG1ldGhvZCB0byBjb3B5IG5vZGVzIHRvIGFuIGFycmF5LCB0aGFua3MgdG8gSUVcbiAgICAgIG5vZGVzVG9BcnJheTogZnVuY3Rpb24gKG5vZGVzKSB7XG4gICAgICAgIHZhciByZXN1bHRzID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICByZXN1bHRzLnB1c2gobm9kZXMuaXRlbShpKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgICB9LFxuXG4gICAgICAvLyBEaXNhYmxlcyBzY3JvbGwgYXJvdW5kIHRoZSBwYXNzZWQgZWxlbWVudC5cbiAgICAgIGRpc2FibGVTY3JvbGxBcm91bmQ6IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgIGlmIChVdGlsLmRpc2FibGVTY3JvbGxBcm91bmQuX2VuYWJsZVNjcm9sbGluZykgcmV0dXJuIFV0aWwuZGlzYWJsZVNjcm9sbEFyb3VuZC5fZW5hYmxlU2Nyb2xsaW5nO1xuICAgICAgICBlbGVtZW50ID0gYW5ndWxhci5lbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICB2YXIgYm9keSA9ICRkb2N1bWVudFswXS5ib2R5LFxuICAgICAgICAgIHJlc3RvcmVCb2R5ID0gZGlzYWJsZUJvZHlTY3JvbGwoKSxcbiAgICAgICAgICByZXN0b3JlRWxlbWVudCA9IGRpc2FibGVFbGVtZW50U2Nyb2xsKCk7XG5cbiAgICAgICAgcmV0dXJuIFV0aWwuZGlzYWJsZVNjcm9sbEFyb3VuZC5fZW5hYmxlU2Nyb2xsaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJlc3RvcmVCb2R5KCk7XG4gICAgICAgICAgcmVzdG9yZUVsZW1lbnQoKTtcbiAgICAgICAgICBkZWxldGUgVXRpbC5kaXNhYmxlU2Nyb2xsQXJvdW5kLl9lbmFibGVTY3JvbGxpbmc7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gQ3JlYXRlcyBhIHZpcnR1YWwgc2Nyb2xsaW5nIG1hc2sgdG8gYWJzb3JiIHRvdWNobW92ZSwga2V5Ym9hcmQsIHNjcm9sbGJhciBjbGlja2luZywgYW5kIHdoZWVsIGV2ZW50c1xuICAgICAgICBmdW5jdGlvbiBkaXNhYmxlRWxlbWVudFNjcm9sbCgpIHtcbiAgICAgICAgICB2YXIgekluZGV4ID0gJHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsZW1lbnRbMF0pLnpJbmRleCAtIDE7XG4gICAgICAgICAgaWYgKGlzTmFOKHpJbmRleCkpIHpJbmRleCA9IDk5O1xuICAgICAgICAgIHZhciBzY3JvbGxNYXNrID0gYW5ndWxhci5lbGVtZW50KFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJtZC1zY3JvbGwtbWFza1wiIHN0eWxlPVwiei1pbmRleDogJyArIHpJbmRleCArICdcIj4nICtcbiAgICAgICAgICAgICcgIDxkaXYgY2xhc3M9XCJtZC1zY3JvbGwtbWFzay1iYXJcIj48L2Rpdj4nICtcbiAgICAgICAgICAgICc8L2Rpdj4nKTtcbiAgICAgICAgICBib2R5LmFwcGVuZENoaWxkKHNjcm9sbE1hc2tbMF0pO1xuXG4gICAgICAgICAgc2Nyb2xsTWFzay5vbignd2hlZWwnLCBwcmV2ZW50RGVmYXVsdCk7XG4gICAgICAgICAgc2Nyb2xsTWFzay5vbigndG91Y2htb3ZlJywgcHJldmVudERlZmF1bHQpO1xuICAgICAgICAgICRkb2N1bWVudC5vbigna2V5ZG93bicsIGRpc2FibGVLZXlOYXYpO1xuXG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIHJlc3RvcmVTY3JvbGwoKSB7XG4gICAgICAgICAgICBzY3JvbGxNYXNrLm9mZignd2hlZWwnKTtcbiAgICAgICAgICAgIHNjcm9sbE1hc2sub2ZmKCd0b3VjaG1vdmUnKTtcbiAgICAgICAgICAgIHNjcm9sbE1hc2tbMF0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzY3JvbGxNYXNrWzBdKTtcbiAgICAgICAgICAgICRkb2N1bWVudC5vZmYoJ2tleWRvd24nLCBkaXNhYmxlS2V5TmF2KTtcbiAgICAgICAgICAgIGRlbGV0ZSBVdGlsLmRpc2FibGVTY3JvbGxBcm91bmQuX2VuYWJsZVNjcm9sbGluZztcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgLy8gUHJldmVudCBrZXlwcmVzc2VzIGZyb20gZWxlbWVudHMgaW5zaWRlIHRoZSBib2R5XG4gICAgICAgICAgLy8gdXNlZCB0byBzdG9wIHRoZSBrZXlwcmVzc2VzIHRoYXQgY291bGQgY2F1c2UgdGhlIHBhZ2UgdG8gc2Nyb2xsXG4gICAgICAgICAgLy8gKGFycm93IGtleXMsIHNwYWNlYmFyLCB0YWIsIGV0YykuXG4gICAgICAgICAgZnVuY3Rpb24gZGlzYWJsZUtleU5hdihlKSB7XG4gICAgICAgICAgICAvLy0tIHRlbXBvcmFyaWx5IHJlbW92ZWQgdGhpcyBsb2dpYywgd2lsbCBwb3NzaWJseSByZS1hZGQgYXQgYSBsYXRlciBkYXRlXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBpZiAoIWVsZW1lbnRbMF0uY29udGFpbnMoZS50YXJnZXQpKSB7XG4gICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBwcmV2ZW50RGVmYXVsdChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ29udmVydHMgdGhlIGJvZHkgdG8gYSBwb3NpdGlvbiBmaXhlZCBibG9jayBhbmQgdHJhbnNsYXRlIGl0IHRvIHRoZSBwcm9wZXIgc2Nyb2xsXG4gICAgICAgIC8vIHBvc2l0aW9uXG4gICAgICAgIGZ1bmN0aW9uIGRpc2FibGVCb2R5U2Nyb2xsKCkge1xuICAgICAgICAgIHZhciByZXN0b3JlU3R5bGUgPSBib2R5LmdldEF0dHJpYnV0ZSgnc3R5bGUnKSB8fCAnJztcbiAgICAgICAgICB2YXIgc2Nyb2xsT2Zmc2V0ID0gYm9keS5zY3JvbGxUb3AgKyBib2R5LnBhcmVudEVsZW1lbnQuc2Nyb2xsVG9wO1xuICAgICAgICAgIHZhciBjbGllbnRXaWR0aCA9IGJvZHkuY2xpZW50V2lkdGg7XG5cbiAgICAgICAgICBhcHBseVN0eWxlcyhib2R5LCB7XG4gICAgICAgICAgICBwb3NpdGlvbjogJ2ZpeGVkJyxcbiAgICAgICAgICAgIHdpZHRoOiAnMTAwJScsXG4gICAgICAgICAgICBvdmVyZmxvd1k6ICdzY3JvbGwnLFxuICAgICAgICAgICAgdG9wOiAtc2Nyb2xsT2Zmc2V0ICsgJ3B4J1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgaWYgKGJvZHkuY2xpZW50V2lkdGggPCBjbGllbnRXaWR0aCkgYXBwbHlTdHlsZXMoYm9keSwge292ZXJmbG93OiAnaGlkZGVuJ30pO1xuXG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIHJlc3RvcmVTY3JvbGwoKSB7XG4gICAgICAgICAgICBib2R5LnNldEF0dHJpYnV0ZSgnc3R5bGUnLCByZXN0b3JlU3R5bGUpO1xuICAgICAgICAgICAgYm9keS5zY3JvbGxUb3AgPSBzY3JvbGxPZmZzZXQ7XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGFwcGx5U3R5bGVzKGVsLCBzdHlsZXMpIHtcbiAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gc3R5bGVzKSB7XG4gICAgICAgICAgICBlbC5zdHlsZVtrZXldID0gc3R5bGVzW2tleV07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZW5hYmxlU2Nyb2xsaW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBtZXRob2QgPSB0aGlzLmRpc2FibGVTY3JvbGxBcm91bmQuX2VuYWJsZVNjcm9sbGluZztcbiAgICAgICAgbWV0aG9kICYmIG1ldGhvZCgpO1xuICAgICAgfSxcbiAgICAgIGZsb2F0aW5nU2Nyb2xsYmFyczogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5mbG9hdGluZ1Njcm9sbGJhcnMuY2FjaGVkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICB2YXIgdGVtcE5vZGUgPSBhbmd1bGFyLmVsZW1lbnQoJzxkaXYgc3R5bGU9XCJ3aWR0aDogMTAwJTsgei1pbmRleDogLTE7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgaGVpZ2h0OiAzNXB4OyBvdmVyZmxvdy15OiBzY3JvbGxcIj48ZGl2IHN0eWxlPVwiaGVpZ2h0OiA2MDtcIj48L2Rpdj48L2Rpdj4nKTtcbiAgICAgICAgICAkZG9jdW1lbnRbMF0uYm9keS5hcHBlbmRDaGlsZCh0ZW1wTm9kZVswXSk7XG4gICAgICAgICAgdGhpcy5mbG9hdGluZ1Njcm9sbGJhcnMuY2FjaGVkID0gKHRlbXBOb2RlWzBdLm9mZnNldFdpZHRoID09IHRlbXBOb2RlWzBdLmNoaWxkTm9kZXNbMF0ub2Zmc2V0V2lkdGgpO1xuICAgICAgICAgIHRlbXBOb2RlLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmZsb2F0aW5nU2Nyb2xsYmFycy5jYWNoZWQ7XG4gICAgICB9LFxuXG4gICAgICAvLyBNb2JpbGUgc2FmYXJpIG9ubHkgYWxsb3dzIHlvdSB0byBzZXQgZm9jdXMgaW4gY2xpY2sgZXZlbnQgbGlzdGVuZXJzLi4uXG4gICAgICBmb3JjZUZvY3VzOiBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICB2YXIgbm9kZSA9IGVsZW1lbnRbMF0gfHwgZWxlbWVudDtcblxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIGZvY3VzT25DbGljayhldikge1xuICAgICAgICAgIGlmIChldi50YXJnZXQgPT09IG5vZGUgJiYgZXYuJGZvY3VzKSB7XG4gICAgICAgICAgICBub2RlLmZvY3VzKCk7XG4gICAgICAgICAgICBldi5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBub2RlLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZm9jdXNPbkNsaWNrKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIHRydWUpO1xuXG4gICAgICAgIHZhciBuZXdFdmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdNb3VzZUV2ZW50cycpO1xuICAgICAgICBuZXdFdmVudC5pbml0TW91c2VFdmVudCgnY2xpY2snLCBmYWxzZSwgdHJ1ZSwgd2luZG93LCB7fSwgMCwgMCwgMCwgMCxcbiAgICAgICAgICBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgMCwgbnVsbCk7XG4gICAgICAgIG5ld0V2ZW50LiRtYXRlcmlhbCA9IHRydWU7XG4gICAgICAgIG5ld0V2ZW50LiRmb2N1cyA9IHRydWU7XG4gICAgICAgIG5vZGUuZGlzcGF0Y2hFdmVudChuZXdFdmVudCk7XG4gICAgICB9LFxuXG4gICAgICB0cmFuc2l0aW9uRW5kUHJvbWlzZTogZnVuY3Rpb24gKGVsZW1lbnQsIG9wdHMpIHtcbiAgICAgICAgb3B0cyA9IG9wdHMgfHwge307XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIGVsZW1lbnQub24oJG1kQ29uc3RhbnQuQ1NTLlRSQU5TSVRJT05FTkQsIGZpbmlzaGVkKTtcbiAgICAgICAgZnVuY3Rpb24gZmluaXNoZWQoZXYpIHtcbiAgICAgICAgICAvLyBNYWtlIHN1cmUgdGhpcyB0cmFuc2l0aW9uZW5kIGRpZG4ndCBidWJibGUgdXAgZnJvbSBhIGNoaWxkXG4gICAgICAgICAgaWYgKCFldiB8fCBldi50YXJnZXQgPT09IGVsZW1lbnRbMF0pIHtcbiAgICAgICAgICAgIGVsZW1lbnQub2ZmKCRtZENvbnN0YW50LkNTUy5UUkFOU0lUSU9ORU5ELCBmaW5pc2hlZCk7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG9wdHMudGltZW91dCkgJHRpbWVvdXQoZmluaXNoZWQsIG9wdHMudGltZW91dCk7XG4gICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgfSxcblxuICAgICAgZmFrZU5nTW9kZWw6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAkZmFrZTogdHJ1ZSxcbiAgICAgICAgICAkc2V0VG91Y2hlZDogYW5ndWxhci5ub29wLFxuICAgICAgICAgICRzZXRWaWV3VmFsdWU6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy4kdmlld1ZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLiRyZW5kZXIodmFsdWUpO1xuICAgICAgICAgICAgdGhpcy4kdmlld0NoYW5nZUxpc3RlbmVycy5mb3JFYWNoKGZ1bmN0aW9uIChjYikge1xuICAgICAgICAgICAgICBjYigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICAkaXNFbXB0eTogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gKCcnICsgdmFsdWUpLmxlbmd0aCA9PT0gMDtcbiAgICAgICAgICB9LFxuICAgICAgICAgICRwYXJzZXJzOiBbXSxcbiAgICAgICAgICAkZm9ybWF0dGVyczogW10sXG4gICAgICAgICAgJHZpZXdDaGFuZ2VMaXN0ZW5lcnM6IFtdLFxuICAgICAgICAgICRyZW5kZXI6IGFuZ3VsYXIubm9vcFxuICAgICAgICB9O1xuICAgICAgfSxcblxuICAgICAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uLCB0aGF0LCBhcyBsb25nIGFzIGl0IGNvbnRpbnVlcyB0byBiZSBpbnZva2VkLCB3aWxsIG5vdFxuICAgICAgLy8gYmUgdHJpZ2dlcmVkLiBUaGUgZnVuY3Rpb24gd2lsbCBiZSBjYWxsZWQgYWZ0ZXIgaXQgc3RvcHMgYmVpbmcgY2FsbGVkIGZvclxuICAgICAgLy8gTiBtaWxsaXNlY29uZHMuXG4gICAgICAvLyBAcGFyYW0gd2FpdCBJbnRlZ2VyIHZhbHVlIG9mIG1zZWNzIHRvIGRlbGF5IChzaW5jZSBsYXN0IGRlYm91bmNlIHJlc2V0KTsgZGVmYXVsdCB2YWx1ZSAxMCBtc2Vjc1xuICAgICAgLy8gQHBhcmFtIGludm9rZUFwcGx5IHNob3VsZCB0aGUgJHRpbWVvdXQgdHJpZ2dlciAkZGlnZXN0KCkgZGlydHkgY2hlY2tpbmdcbiAgICAgIGRlYm91bmNlOiBmdW5jdGlvbiAoZnVuYywgd2FpdCwgc2NvcGUsIGludm9rZUFwcGx5KSB7XG4gICAgICAgIHZhciB0aW1lcjtcblxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gZGVib3VuY2VkKCkge1xuICAgICAgICAgIHZhciBjb250ZXh0ID0gc2NvcGUsXG4gICAgICAgICAgICBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtcblxuICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aW1lcik7XG4gICAgICAgICAgdGltZXIgPSAkdGltZW91dChmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIHRpbWVyID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcblxuICAgICAgICAgIH0sIHdhaXQgfHwgMTAsIGludm9rZUFwcGx5KTtcbiAgICAgICAgfTtcbiAgICAgIH0sXG5cbiAgICAgIC8vIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IGNhbiBvbmx5IGJlIHRyaWdnZXJlZCBldmVyeSBgZGVsYXlgIG1pbGxpc2Vjb25kcy5cbiAgICAgIC8vIEluIG90aGVyIHdvcmRzLCB0aGUgZnVuY3Rpb24gd2lsbCBub3QgYmUgY2FsbGVkIHVubGVzcyBpdCBoYXMgYmVlbiBtb3JlXG4gICAgICAvLyB0aGFuIGBkZWxheWAgbWlsbGlzZWNvbmRzIHNpbmNlIHRoZSBsYXN0IGNhbGwuXG4gICAgICB0aHJvdHRsZTogZnVuY3Rpb24gdGhyb3R0bGUoZnVuYywgZGVsYXkpIHtcbiAgICAgICAgdmFyIHJlY2VudDtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIHRocm90dGxlZCgpIHtcbiAgICAgICAgICB2YXIgY29udGV4dCA9IHRoaXM7XG4gICAgICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICAgICAgdmFyIG5vdyA9IFV0aWwubm93KCk7XG5cbiAgICAgICAgICBpZiAoIXJlY2VudCB8fCAobm93IC0gcmVjZW50ID4gZGVsYXkpKSB7XG4gICAgICAgICAgICBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgICAgICAgICAgcmVjZW50ID0gbm93O1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH0sXG5cbiAgICAgIC8qKlxuICAgICAgICogTWVhc3VyZXMgdGhlIG51bWJlciBvZiBtaWxsaXNlY29uZHMgdGFrZW4gdG8gcnVuIHRoZSBwcm92aWRlZCBjYWxsYmFja1xuICAgICAgICogZnVuY3Rpb24uIFVzZXMgYSBoaWdoLXByZWNpc2lvbiB0aW1lciBpZiBhdmFpbGFibGUuXG4gICAgICAgKi9cbiAgICAgIHRpbWU6IGZ1bmN0aW9uIHRpbWUoY2IpIHtcbiAgICAgICAgdmFyIHN0YXJ0ID0gVXRpbC5ub3coKTtcbiAgICAgICAgY2IoKTtcbiAgICAgICAgcmV0dXJuIFV0aWwubm93KCkgLSBzdGFydDtcbiAgICAgIH0sXG5cbiAgICAgIC8qKlxuICAgICAgICogR2V0IGEgdW5pcXVlIElELlxuICAgICAgICpcbiAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IGFuIHVuaXF1ZSBudW1lcmljIHN0cmluZ1xuICAgICAgICovXG4gICAgICBuZXh0VWlkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAnJyArIG5leHRVbmlxdWVJZCsrO1xuICAgICAgfSxcblxuICAgICAgLy8gU3RvcCB3YXRjaGVycyBhbmQgZXZlbnRzIGZyb20gZmlyaW5nIG9uIGEgc2NvcGUgd2l0aG91dCBkZXN0cm95aW5nIGl0LFxuICAgICAgLy8gYnkgZGlzY29ubmVjdGluZyBpdCBmcm9tIGl0cyBwYXJlbnQgYW5kIGl0cyBzaWJsaW5ncycgbGlua2VkIGxpc3RzLlxuICAgICAgZGlzY29ubmVjdFNjb3BlOiBmdW5jdGlvbiBkaXNjb25uZWN0U2NvcGUoc2NvcGUpIHtcbiAgICAgICAgaWYgKCFzY29wZSkgcmV0dXJuO1xuXG4gICAgICAgIC8vIHdlIGNhbid0IGRlc3Ryb3kgdGhlIHJvb3Qgc2NvcGUgb3IgYSBzY29wZSB0aGF0IGhhcyBiZWVuIGFscmVhZHkgZGVzdHJveWVkXG4gICAgICAgIGlmIChzY29wZS4kcm9vdCA9PT0gc2NvcGUpIHJldHVybjtcbiAgICAgICAgaWYgKHNjb3BlLiQkZGVzdHJveWVkKSByZXR1cm47XG5cbiAgICAgICAgdmFyIHBhcmVudCA9IHNjb3BlLiRwYXJlbnQ7XG4gICAgICAgIHNjb3BlLiQkZGlzY29ubmVjdGVkID0gdHJ1ZTtcblxuICAgICAgICAvLyBTZWUgU2NvcGUuJGRlc3Ryb3lcbiAgICAgICAgaWYgKHBhcmVudC4kJGNoaWxkSGVhZCA9PT0gc2NvcGUpIHBhcmVudC4kJGNoaWxkSGVhZCA9IHNjb3BlLiQkbmV4dFNpYmxpbmc7XG4gICAgICAgIGlmIChwYXJlbnQuJCRjaGlsZFRhaWwgPT09IHNjb3BlKSBwYXJlbnQuJCRjaGlsZFRhaWwgPSBzY29wZS4kJHByZXZTaWJsaW5nO1xuICAgICAgICBpZiAoc2NvcGUuJCRwcmV2U2libGluZykgc2NvcGUuJCRwcmV2U2libGluZy4kJG5leHRTaWJsaW5nID0gc2NvcGUuJCRuZXh0U2libGluZztcbiAgICAgICAgaWYgKHNjb3BlLiQkbmV4dFNpYmxpbmcpIHNjb3BlLiQkbmV4dFNpYmxpbmcuJCRwcmV2U2libGluZyA9IHNjb3BlLiQkcHJldlNpYmxpbmc7XG5cbiAgICAgICAgc2NvcGUuJCRuZXh0U2libGluZyA9IHNjb3BlLiQkcHJldlNpYmxpbmcgPSBudWxsO1xuXG4gICAgICB9LFxuXG4gICAgICAvLyBVbmRvIHRoZSBlZmZlY3RzIG9mIGRpc2Nvbm5lY3RTY29wZSBhYm92ZS5cbiAgICAgIHJlY29ubmVjdFNjb3BlOiBmdW5jdGlvbiByZWNvbm5lY3RTY29wZShzY29wZSkge1xuICAgICAgICBpZiAoIXNjb3BlKSByZXR1cm47XG5cbiAgICAgICAgLy8gd2UgY2FuJ3QgZGlzY29ubmVjdCB0aGUgcm9vdCBub2RlIG9yIHNjb3BlIGFscmVhZHkgZGlzY29ubmVjdGVkXG4gICAgICAgIGlmIChzY29wZS4kcm9vdCA9PT0gc2NvcGUpIHJldHVybjtcbiAgICAgICAgaWYgKCFzY29wZS4kJGRpc2Nvbm5lY3RlZCkgcmV0dXJuO1xuXG4gICAgICAgIHZhciBjaGlsZCA9IHNjb3BlO1xuXG4gICAgICAgIHZhciBwYXJlbnQgPSBjaGlsZC4kcGFyZW50O1xuICAgICAgICBjaGlsZC4kJGRpc2Nvbm5lY3RlZCA9IGZhbHNlO1xuICAgICAgICAvLyBTZWUgU2NvcGUuJG5ldyBmb3IgdGhpcyBsb2dpYy4uLlxuICAgICAgICBjaGlsZC4kJHByZXZTaWJsaW5nID0gcGFyZW50LiQkY2hpbGRUYWlsO1xuICAgICAgICBpZiAocGFyZW50LiQkY2hpbGRIZWFkKSB7XG4gICAgICAgICAgcGFyZW50LiQkY2hpbGRUYWlsLiQkbmV4dFNpYmxpbmcgPSBjaGlsZDtcbiAgICAgICAgICBwYXJlbnQuJCRjaGlsZFRhaWwgPSBjaGlsZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwYXJlbnQuJCRjaGlsZEhlYWQgPSBwYXJlbnQuJCRjaGlsZFRhaWwgPSBjaGlsZDtcbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgLypcbiAgICAgICAqIGdldENsb3Nlc3QgcmVwbGljYXRlcyBqUXVlcnkuY2xvc2VzdCgpIHRvIHdhbGsgdXAgdGhlIERPTSB0cmVlIHVudGlsIGl0IGZpbmRzIGEgbWF0Y2hpbmcgbm9kZU5hbWVcbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0gZWwgRWxlbWVudCB0byBzdGFydCB3YWxraW5nIHRoZSBET00gZnJvbVxuICAgICAgICogQHBhcmFtIHRhZ05hbWUgVGFnIG5hbWUgdG8gZmluZCBjbG9zZXN0IHRvIGVsLCBzdWNoIGFzICdmb3JtJ1xuICAgICAgICovXG4gICAgICBnZXRDbG9zZXN0OiBmdW5jdGlvbiBnZXRDbG9zZXN0KGVsLCB0YWdOYW1lLCBvbmx5UGFyZW50KSB7XG4gICAgICAgIGlmIChlbCBpbnN0YW5jZW9mIGFuZ3VsYXIuZWxlbWVudCkgZWwgPSBlbFswXTtcbiAgICAgICAgdGFnTmFtZSA9IHRhZ05hbWUudG9VcHBlckNhc2UoKTtcbiAgICAgICAgaWYgKG9ubHlQYXJlbnQpIGVsID0gZWwucGFyZW50Tm9kZTtcbiAgICAgICAgaWYgKCFlbCkgcmV0dXJuIG51bGw7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICBpZiAoZWwubm9kZU5hbWUgPT09IHRhZ05hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBlbDtcbiAgICAgICAgICB9XG4gICAgICAgIH0gd2hpbGUgKGVsID0gZWwucGFyZW50Tm9kZSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfSxcblxuICAgICAgLyoqXG4gICAgICAgKiBGdW5jdGlvbmFsIGVxdWl2YWxlbnQgZm9yICRlbGVtZW50LmZpbHRlcijigJhtZC1ib3R0b20tc2hlZXTigJkpXG4gICAgICAgKiB1c2VmdWwgd2l0aCBpbnRlcmltRWxlbWVudHMgd2hlcmUgdGhlIGVsZW1lbnQgYW5kIGl0cyBjb250YWluZXIgYXJlIGltcG9ydGFudC4uLlxuICAgICAgICovXG4gICAgICBleHRyYWN0RWxlbWVudEJ5TmFtZTogZnVuY3Rpb24gKGVsZW1lbnQsIG5vZGVOYW1lKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBlbGVtZW50Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgaWYgKGVsZW1lbnRbaV0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gbm9kZU5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudFtpXSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlbGVtZW50O1xuICAgICAgfSxcblxuICAgICAgLyoqXG4gICAgICAgKiBHaXZlIG9wdGlvbmFsIHByb3BlcnRpZXMgd2l0aCBubyB2YWx1ZSBhIGJvb2xlYW4gdHJ1ZSBpZiBhdHRyIHByb3ZpZGVkIG9yIGZhbHNlIG90aGVyd2lzZVxuICAgICAgICovXG4gICAgICBpbml0T3B0aW9uYWxQcm9wZXJ0aWVzOiBmdW5jdGlvbiAoc2NvcGUsIGF0dHIsIGRlZmF1bHRzKSB7XG4gICAgICAgIGRlZmF1bHRzID0gZGVmYXVsdHMgfHwge307XG4gICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzY29wZS4kJGlzb2xhdGVCaW5kaW5ncywgZnVuY3Rpb24gKGJpbmRpbmcsIGtleSkge1xuICAgICAgICAgIGlmIChiaW5kaW5nLm9wdGlvbmFsICYmIGFuZ3VsYXIuaXNVbmRlZmluZWQoc2NvcGVba2V5XSkpIHtcbiAgICAgICAgICAgIHZhciBhdHRySXNEZWZpbmVkID0gYW5ndWxhci5pc0RlZmluZWQoYXR0cltiaW5kaW5nLmF0dHJOYW1lXSk7XG4gICAgICAgICAgICBzY29wZVtrZXldID0gYW5ndWxhci5pc0RlZmluZWQoZGVmYXVsdHNba2V5XSkgPyBkZWZhdWx0c1trZXldIDogYXR0cklzRGVmaW5lZDtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgfTtcblxuICB9XSk7XG5cbi8qXG4gKiBTaW5jZSByZW1vdmluZyBqUXVlcnkgZnJvbSB0aGUgZGVtb3MsIHNvbWUgY29kZSB0aGF0IHVzZXMgYGVsZW1lbnQuZm9jdXMoKWAgaXMgYnJva2VuLlxuICpcbiAqIFdlIG5lZWQgdG8gYWRkIGBlbGVtZW50LmZvY3VzKClgLCBiZWNhdXNlIGl0J3MgdGVzdGFibGUgdW5saWtlIGBlbGVtZW50WzBdLmZvY3VzYC5cbiAqXG4gKiBUT0RPKGFqb3NsaW4pOiBUaGlzIHNob3VsZCBiZSBhZGRlZCBpbiBhIGJldHRlciBwbGFjZSBsYXRlci5cbiAqL1xuXG5hbmd1bGFyLmVsZW1lbnQucHJvdG90eXBlLmZvY3VzID0gYW5ndWxhci5lbGVtZW50LnByb3RvdHlwZS5mb2N1cyB8fCBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHRoaXMubGVuZ3RoKSB7XG4gICAgICB0aGlzWzBdLmZvY3VzKCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuYW5ndWxhci5lbGVtZW50LnByb3RvdHlwZS5ibHVyID0gYW5ndWxhci5lbGVtZW50LnByb3RvdHlwZS5ibHVyIHx8IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy5sZW5ndGgpIHtcbiAgICAgIHRoaXNbMF0uYmx1cigpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvcmUnKVxuICAuc2VydmljZSgnJG1kQXJpYScsIEFyaWFTZXJ2aWNlKTtcblxuLypcbiAqIEBuZ0luamVjdFxuICovXG5mdW5jdGlvbiBBcmlhU2VydmljZSgkJHJBRiwgJGxvZywgJHdpbmRvdykge1xuXG4gIHJldHVybiB7XG4gICAgZXhwZWN0OiBleHBlY3QsXG4gICAgZXhwZWN0QXN5bmM6IGV4cGVjdEFzeW5jLFxuICAgIGV4cGVjdFdpdGhUZXh0OiBleHBlY3RXaXRoVGV4dFxuICB9O1xuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBleHBlY3RlZCBhdHRyaWJ1dGUgaGFzIGJlZW4gc3BlY2lmaWVkIG9uIHRoZSB0YXJnZXQgZWxlbWVudCBvciBjaGlsZFxuICAgKiBAcGFyYW0gZWxlbWVudFxuICAgKiBAcGFyYW0gYXR0ck5hbWVcbiAgICogQHBhcmFtIHtvcHRpb25hbH0gZGVmYXVsdFZhbHVlIFdoYXQgdG8gc2V0IHRoZSBhdHRyIHRvIGlmIG5vIHZhbHVlIGlzIGZvdW5kXG4gICAqL1xuICBmdW5jdGlvbiBleHBlY3QoZWxlbWVudCwgYXR0ck5hbWUsIGRlZmF1bHRWYWx1ZSkge1xuICAgIHZhciBub2RlID0gZWxlbWVudFswXSB8fCBlbGVtZW50O1xuXG4gICAgLy8gaWYgbm9kZSBleGlzdHMgYW5kIG5laXRoZXIgaXQgbm9yIGl0cyBjaGlsZHJlbiBoYXZlIHRoZSBhdHRyaWJ1dGVcbiAgICBpZiAobm9kZSAmJlxuICAgICAgICgoIW5vZGUuaGFzQXR0cmlidXRlKGF0dHJOYW1lKSB8fFxuICAgICAgICBub2RlLmdldEF0dHJpYnV0ZShhdHRyTmFtZSkubGVuZ3RoID09PSAwKSAmJlxuICAgICAgICAhY2hpbGRIYXNBdHRyaWJ1dGUobm9kZSwgYXR0ck5hbWUpKSkge1xuXG4gICAgICBkZWZhdWx0VmFsdWUgPSBhbmd1bGFyLmlzU3RyaW5nKGRlZmF1bHRWYWx1ZSkgPyBkZWZhdWx0VmFsdWUudHJpbSgpIDogJyc7XG4gICAgICBpZiAoZGVmYXVsdFZhbHVlLmxlbmd0aCkge1xuICAgICAgICBlbGVtZW50LmF0dHIoYXR0ck5hbWUsIGRlZmF1bHRWYWx1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkbG9nLndhcm4oJ0FSSUE6IEF0dHJpYnV0ZSBcIicsIGF0dHJOYW1lLCAnXCIsIHJlcXVpcmVkIGZvciBhY2Nlc3NpYmlsaXR5LCBpcyBtaXNzaW5nIG9uIG5vZGU6Jywgbm9kZSk7XG4gICAgICB9XG5cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBleHBlY3RBc3luYyhlbGVtZW50LCBhdHRyTmFtZSwgZGVmYXVsdFZhbHVlR2V0dGVyKSB7XG4gICAgLy8gUHJvYmxlbTogd2hlbiByZXRyaWV2aW5nIHRoZSBlbGVtZW50J3MgY29udGVudHMgc3luY2hyb25vdXNseSB0byBmaW5kIHRoZSBsYWJlbCxcbiAgICAvLyB0aGUgdGV4dCBtYXkgbm90IGJlIGRlZmluZWQgeWV0IGluIHRoZSBjYXNlIG9mIGEgYmluZGluZy5cbiAgICAvLyBUaGVyZSBpcyBhIGhpZ2hlciBjaGFuY2UgdGhhdCBhIGJpbmRpbmcgd2lsbCBiZSBkZWZpbmVkIGlmIHdlIHdhaXQgb25lIGZyYW1lLlxuICAgICQkckFGKGZ1bmN0aW9uKCkge1xuICAgICAgZXhwZWN0KGVsZW1lbnQsIGF0dHJOYW1lLCBkZWZhdWx0VmFsdWVHZXR0ZXIoKSk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBleHBlY3RXaXRoVGV4dChlbGVtZW50LCBhdHRyTmFtZSkge1xuICAgIGV4cGVjdEFzeW5jKGVsZW1lbnQsIGF0dHJOYW1lLCBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBnZXRUZXh0KGVsZW1lbnQpO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0VGV4dChlbGVtZW50KSB7XG4gICAgcmV0dXJuIGVsZW1lbnQudGV4dCgpLnRyaW0oKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNoaWxkSGFzQXR0cmlidXRlKG5vZGUsIGF0dHJOYW1lKSB7XG4gICAgdmFyIGhhc0NoaWxkcmVuID0gbm9kZS5oYXNDaGlsZE5vZGVzKCksXG4gICAgICAgIGhhc0F0dHIgPSBmYWxzZTtcblxuICAgIGZ1bmN0aW9uIGlzSGlkZGVuKGVsKSB7XG4gICAgICB2YXIgc3R5bGUgPSBlbC5jdXJyZW50U3R5bGUgPyBlbC5jdXJyZW50U3R5bGUgOiAkd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWwpO1xuICAgICAgcmV0dXJuIChzdHlsZS5kaXNwbGF5ID09PSAnbm9uZScpO1xuICAgIH1cblxuICAgIGlmKGhhc0NoaWxkcmVuKSB7XG4gICAgICB2YXIgY2hpbGRyZW4gPSBub2RlLmNoaWxkTm9kZXM7XG4gICAgICBmb3IodmFyIGk9MDsgaTxjaGlsZHJlbi5sZW5ndGg7IGkrKyl7XG4gICAgICAgIHZhciBjaGlsZCA9IGNoaWxkcmVuW2ldO1xuICAgICAgICBpZihjaGlsZC5ub2RlVHlwZSA9PT0gMSAmJiBjaGlsZC5oYXNBdHRyaWJ1dGUoYXR0ck5hbWUpKSB7XG4gICAgICAgICAgaWYoIWlzSGlkZGVuKGNoaWxkKSl7XG4gICAgICAgICAgICBoYXNBdHRyID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGhhc0F0dHI7XG4gIH1cbn1cbkFyaWFTZXJ2aWNlLiRpbmplY3QgPSBbXCIkJHJBRlwiLCBcIiRsb2dcIiwgXCIkd2luZG93XCJdO1xuXG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvcmUnKVxuICAuc2VydmljZSgnJG1kQ29tcGlsZXInLCBtZENvbXBpbGVyU2VydmljZSk7XG5cbmZ1bmN0aW9uIG1kQ29tcGlsZXJTZXJ2aWNlKCRxLCAkaHR0cCwgJGluamVjdG9yLCAkY29tcGlsZSwgJGNvbnRyb2xsZXIsICR0ZW1wbGF0ZUNhY2hlKSB7XG4gIC8qIGpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cblxuICAvKlxuICAgKiBAbmdkb2Mgc2VydmljZVxuICAgKiBAbmFtZSAkbWRDb21waWxlclxuICAgKiBAbW9kdWxlIG1hdGVyaWFsLmNvcmVcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFRoZSAkbWRDb21waWxlciBzZXJ2aWNlIGlzIGFuIGFic3RyYWN0aW9uIG9mIGFuZ3VsYXIncyBjb21waWxlciwgdGhhdCBhbGxvd3MgdGhlIGRldmVsb3BlclxuICAgKiB0byBlYXNpbHkgY29tcGlsZSBhbiBlbGVtZW50IHdpdGggYSB0ZW1wbGF0ZVVybCwgY29udHJvbGxlciwgYW5kIGxvY2Fscy5cbiAgICpcbiAgICogQHVzYWdlXG4gICAqIDxobGpzIGxhbmc9XCJqc1wiPlxuICAgKiAkbWRDb21waWxlci5jb21waWxlKHtcbiAgICogICB0ZW1wbGF0ZVVybDogJ21vZGFsLmh0bWwnLFxuICAgKiAgIGNvbnRyb2xsZXI6ICdNb2RhbEN0cmwnLFxuICAgKiAgIGxvY2Fsczoge1xuICAgKiAgICAgbW9kYWw6IG15TW9kYWxJbnN0YW5jZTtcbiAgICogICB9XG4gICAqIH0pLnRoZW4oZnVuY3Rpb24oY29tcGlsZURhdGEpIHtcbiAgICogICBjb21waWxlRGF0YS5lbGVtZW50OyAvLyBtb2RhbC5odG1sJ3MgdGVtcGxhdGUgaW4gYW4gZWxlbWVudFxuICAgKiAgIGNvbXBpbGVEYXRhLmxpbmsobXlTY29wZSk7IC8vYXR0YWNoIGNvbnRyb2xsZXIgJiBzY29wZSB0byBlbGVtZW50XG4gICAqIH0pO1xuICAgKiA8L2hsanM+XG4gICAqL1xuXG4gICAvKlxuICAgICogQG5nZG9jIG1ldGhvZFxuICAgICogQG5hbWUgJG1kQ29tcGlsZXIjY29tcGlsZVxuICAgICogQGRlc2NyaXB0aW9uIEEgaGVscGVyIHRvIGNvbXBpbGUgYW4gSFRNTCB0ZW1wbGF0ZS90ZW1wbGF0ZVVybCB3aXRoIGEgZ2l2ZW4gY29udHJvbGxlcixcbiAgICAqIGxvY2FscywgYW5kIHNjb3BlLlxuICAgICogQHBhcmFtIHtvYmplY3R9IG9wdGlvbnMgQW4gb3B0aW9ucyBvYmplY3QsIHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOlxuICAgICpcbiAgICAqICAgIC0gYGNvbnRyb2xsZXJgIC0gYHsoc3RyaW5nPXxmdW5jdGlvbigpPX1gIENvbnRyb2xsZXIgZm4gdGhhdCBzaG91bGQgYmUgYXNzb2NpYXRlZCB3aXRoXG4gICAgKiAgICAgIG5ld2x5IGNyZWF0ZWQgc2NvcGUgb3IgdGhlIG5hbWUgb2YgYSByZWdpc3RlcmVkIGNvbnRyb2xsZXIgaWYgcGFzc2VkIGFzIGEgc3RyaW5nLlxuICAgICogICAgLSBgY29udHJvbGxlckFzYCAtIGB7c3RyaW5nPX1gIEEgY29udHJvbGxlciBhbGlhcyBuYW1lLiBJZiBwcmVzZW50IHRoZSBjb250cm9sbGVyIHdpbGwgYmVcbiAgICAqICAgICAgcHVibGlzaGVkIHRvIHNjb3BlIHVuZGVyIHRoZSBgY29udHJvbGxlckFzYCBuYW1lLlxuICAgICogICAgLSBgdGVtcGxhdGVgIC0gYHtzdHJpbmc9fWAgQW4gaHRtbCB0ZW1wbGF0ZSBhcyBhIHN0cmluZy5cbiAgICAqICAgIC0gYHRlbXBsYXRlVXJsYCAtIGB7c3RyaW5nPX1gIEEgcGF0aCB0byBhbiBodG1sIHRlbXBsYXRlLlxuICAgICogICAgLSBgdHJhbnNmb3JtVGVtcGxhdGVgIC0gYHtmdW5jdGlvbih0ZW1wbGF0ZSk9fWAgQSBmdW5jdGlvbiB3aGljaCB0cmFuc2Zvcm1zIHRoZSB0ZW1wbGF0ZSBhZnRlclxuICAgICogICAgICBpdCBpcyBsb2FkZWQuIEl0IHdpbGwgYmUgZ2l2ZW4gdGhlIHRlbXBsYXRlIHN0cmluZyBhcyBhIHBhcmFtZXRlciwgYW5kIHNob3VsZFxuICAgICogICAgICByZXR1cm4gYSBhIG5ldyBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSB0cmFuc2Zvcm1lZCB0ZW1wbGF0ZS5cbiAgICAqICAgIC0gYHJlc29sdmVgIC0gYHtPYmplY3QuPHN0cmluZywgZnVuY3Rpb24+PX1gIC0gQW4gb3B0aW9uYWwgbWFwIG9mIGRlcGVuZGVuY2llcyB3aGljaCBzaG91bGRcbiAgICAqICAgICAgYmUgaW5qZWN0ZWQgaW50byB0aGUgY29udHJvbGxlci4gSWYgYW55IG9mIHRoZXNlIGRlcGVuZGVuY2llcyBhcmUgcHJvbWlzZXMsIHRoZSBjb21waWxlclxuICAgICogICAgICB3aWxsIHdhaXQgZm9yIHRoZW0gYWxsIHRvIGJlIHJlc29sdmVkLCBvciBpZiBvbmUgaXMgcmVqZWN0ZWQgYmVmb3JlIHRoZSBjb250cm9sbGVyIGlzXG4gICAgKiAgICAgIGluc3RhbnRpYXRlZCBgY29tcGlsZSgpYCB3aWxsIGZhaWwuLlxuICAgICogICAgICAqIGBrZXlgIC0gYHtzdHJpbmd9YDogYSBuYW1lIG9mIGEgZGVwZW5kZW5jeSB0byBiZSBpbmplY3RlZCBpbnRvIHRoZSBjb250cm9sbGVyLlxuICAgICogICAgICAqIGBmYWN0b3J5YCAtIGB7c3RyaW5nfGZ1bmN0aW9ufWA6IElmIGBzdHJpbmdgIHRoZW4gaXQgaXMgYW4gYWxpYXMgZm9yIGEgc2VydmljZS5cbiAgICAqICAgICAgICBPdGhlcndpc2UgaWYgZnVuY3Rpb24sIHRoZW4gaXQgaXMgaW5qZWN0ZWQgYW5kIHRoZSByZXR1cm4gdmFsdWUgaXMgdHJlYXRlZCBhcyB0aGVcbiAgICAqICAgICAgICBkZXBlbmRlbmN5LiBJZiB0aGUgcmVzdWx0IGlzIGEgcHJvbWlzZSwgaXQgaXMgcmVzb2x2ZWQgYmVmb3JlIGl0cyB2YWx1ZSBpcyBcbiAgICAqICAgICAgICBpbmplY3RlZCBpbnRvIHRoZSBjb250cm9sbGVyLlxuICAgICpcbiAgICAqIEByZXR1cm5zIHtvYmplY3Q9fSBwcm9taXNlIEEgcHJvbWlzZSwgd2hpY2ggd2lsbCBiZSByZXNvbHZlZCB3aXRoIGEgYGNvbXBpbGVEYXRhYCBvYmplY3QuXG4gICAgKiBgY29tcGlsZURhdGFgIGhhcyB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6IFxuICAgICpcbiAgICAqICAgLSBgZWxlbWVudGAgLSBge2VsZW1lbnR9YDogYW4gdW5jb21waWxlZCBlbGVtZW50IG1hdGNoaW5nIHRoZSBwcm92aWRlZCB0ZW1wbGF0ZS5cbiAgICAqICAgLSBgbGlua2AgLSBge2Z1bmN0aW9uKHNjb3BlKX1gOiBBIGxpbmsgZnVuY3Rpb24sIHdoaWNoLCB3aGVuIGNhbGxlZCwgd2lsbCBjb21waWxlXG4gICAgKiAgICAgdGhlIGVsZW1lbnQgYW5kIGluc3RhbnRpYXRlIHRoZSBwcm92aWRlZCBjb250cm9sbGVyIChpZiBnaXZlbikuXG4gICAgKiAgIC0gYGxvY2Fsc2AgLSBge29iamVjdH1gOiBUaGUgbG9jYWxzIHdoaWNoIHdpbGwgYmUgcGFzc2VkIGludG8gdGhlIGNvbnRyb2xsZXIgb25jZSBgbGlua2AgaXNcbiAgICAqICAgICBjYWxsZWQuIElmIGBiaW5kVG9Db250cm9sbGVyYCBpcyB0cnVlLCB0aGV5IHdpbGwgYmUgY29wcGllZCB0byB0aGUgY3RybCBpbnN0ZWFkXG4gICAgKiAgIC0gYGJpbmRUb0NvbnRyb2xsZXJgIC0gYGJvb2xgOiBiaW5kIHRoZSBsb2NhbHMgdG8gdGhlIGNvbnRyb2xsZXIsIGluc3RlYWQgb2YgcGFzc2luZyB0aGVtIGluLlxuICAgICovXG4gIHRoaXMuY29tcGlsZSA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICB2YXIgdGVtcGxhdGVVcmwgPSBvcHRpb25zLnRlbXBsYXRlVXJsO1xuICAgIHZhciB0ZW1wbGF0ZSA9IG9wdGlvbnMudGVtcGxhdGUgfHwgJyc7XG4gICAgdmFyIGNvbnRyb2xsZXIgPSBvcHRpb25zLmNvbnRyb2xsZXI7XG4gICAgdmFyIGNvbnRyb2xsZXJBcyA9IG9wdGlvbnMuY29udHJvbGxlckFzO1xuICAgIHZhciByZXNvbHZlID0gb3B0aW9ucy5yZXNvbHZlIHx8IHt9O1xuICAgIHZhciBsb2NhbHMgPSBvcHRpb25zLmxvY2FscyB8fCB7fTtcbiAgICB2YXIgdHJhbnNmb3JtVGVtcGxhdGUgPSBvcHRpb25zLnRyYW5zZm9ybVRlbXBsYXRlIHx8IGFuZ3VsYXIuaWRlbnRpdHk7XG4gICAgdmFyIGJpbmRUb0NvbnRyb2xsZXIgPSBvcHRpb25zLmJpbmRUb0NvbnRyb2xsZXI7XG5cbiAgICAvLyBUYWtlIHJlc29sdmUgdmFsdWVzIGFuZCBpbnZva2UgdGhlbS4gIFxuICAgIC8vIFJlc29sdmVzIGNhbiBlaXRoZXIgYmUgYSBzdHJpbmcgKHZhbHVlOiAnTXlSZWdpc3RlcmVkQW5ndWxhckNvbnN0JyksXG4gICAgLy8gb3IgYW4gaW52b2thYmxlICdmYWN0b3J5JyBvZiBzb3J0czogKHZhbHVlOiBmdW5jdGlvbiBWYWx1ZUdldHRlcigkZGVwZW5kZW5jeSkge30pXG4gICAgYW5ndWxhci5mb3JFYWNoKHJlc29sdmUsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgIGlmIChhbmd1bGFyLmlzU3RyaW5nKHZhbHVlKSkge1xuICAgICAgICByZXNvbHZlW2tleV0gPSAkaW5qZWN0b3IuZ2V0KHZhbHVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmVba2V5XSA9ICRpbmplY3Rvci5pbnZva2UodmFsdWUpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIC8vQWRkIHRoZSBsb2NhbHMsIHdoaWNoIGFyZSBqdXN0IHN0cmFpZ2h0IHZhbHVlcyB0byBpbmplY3RcbiAgICAvL2VnIGxvY2FsczogeyB0aHJlZTogMyB9LCB3aWxsIGluamVjdCB0aHJlZSBpbnRvIHRoZSBjb250cm9sbGVyXG4gICAgYW5ndWxhci5leHRlbmQocmVzb2x2ZSwgbG9jYWxzKTtcblxuICAgIGlmICh0ZW1wbGF0ZVVybCkge1xuICAgICAgcmVzb2x2ZS4kdGVtcGxhdGUgPSAkaHR0cC5nZXQodGVtcGxhdGVVcmwsIHtjYWNoZTogJHRlbXBsYXRlQ2FjaGV9KVxuICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzb2x2ZS4kdGVtcGxhdGUgPSAkcS53aGVuKHRlbXBsYXRlKTtcbiAgICB9XG5cbiAgICAvLyBXYWl0IGZvciBhbGwgdGhlIHJlc29sdmVzIHRvIGZpbmlzaCBpZiB0aGV5IGFyZSBwcm9taXNlc1xuICAgIHJldHVybiAkcS5hbGwocmVzb2x2ZSkudGhlbihmdW5jdGlvbihsb2NhbHMpIHtcblxuICAgICAgdmFyIHRlbXBsYXRlID0gdHJhbnNmb3JtVGVtcGxhdGUobG9jYWxzLiR0ZW1wbGF0ZSk7XG4gICAgICB2YXIgZWxlbWVudCA9IG9wdGlvbnMuZWxlbWVudCB8fCBhbmd1bGFyLmVsZW1lbnQoJzxkaXY+JykuaHRtbCh0ZW1wbGF0ZS50cmltKCkpLmNvbnRlbnRzKCk7XG4gICAgICB2YXIgbGlua0ZuID0gJGNvbXBpbGUoZWxlbWVudCk7XG5cbiAgICAgIC8vUmV0dXJuIGEgbGlua2luZyBmdW5jdGlvbiB0aGF0IGNhbiBiZSB1c2VkIGxhdGVyIHdoZW4gdGhlIGVsZW1lbnQgaXMgcmVhZHlcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGxvY2FsczogbG9jYWxzLFxuICAgICAgICBlbGVtZW50OiBlbGVtZW50LFxuICAgICAgICBsaW5rOiBmdW5jdGlvbiBsaW5rKHNjb3BlKSB7XG4gICAgICAgICAgbG9jYWxzLiRzY29wZSA9IHNjb3BlO1xuXG4gICAgICAgICAgLy9JbnN0YW50aWF0ZSBjb250cm9sbGVyIGlmIGl0IGV4aXN0cywgYmVjYXVzZSB3ZSBoYXZlIHNjb3BlXG4gICAgICAgICAgaWYgKGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIHZhciBpbnZva2VDdHJsID0gJGNvbnRyb2xsZXIoY29udHJvbGxlciwgbG9jYWxzLCB0cnVlKTtcbiAgICAgICAgICAgIGlmIChiaW5kVG9Db250cm9sbGVyKSB7XG4gICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKGludm9rZUN0cmwuaW5zdGFuY2UsIGxvY2Fscyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY3RybCA9IGludm9rZUN0cmwoKTtcbiAgICAgICAgICAgIC8vU2VlIGFuZ3VsYXItcm91dGUgc291cmNlIGZvciB0aGlzIGxvZ2ljXG4gICAgICAgICAgICBlbGVtZW50LmRhdGEoJyRuZ0NvbnRyb2xsZXJDb250cm9sbGVyJywgY3RybCk7XG4gICAgICAgICAgICBlbGVtZW50LmNoaWxkcmVuKCkuZGF0YSgnJG5nQ29udHJvbGxlckNvbnRyb2xsZXInLCBjdHJsKTtcblxuICAgICAgICAgICAgaWYgKGNvbnRyb2xsZXJBcykge1xuICAgICAgICAgICAgICBzY29wZVtjb250cm9sbGVyQXNdID0gY3RybDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGxpbmtGbihzY29wZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSk7XG5cbiAgfTtcbn1cbm1kQ29tcGlsZXJTZXJ2aWNlLiRpbmplY3QgPSBbXCIkcVwiLCBcIiRodHRwXCIsIFwiJGluamVjdG9yXCIsIFwiJGNvbXBpbGVcIiwgXCIkY29udHJvbGxlclwiLCBcIiR0ZW1wbGF0ZUNhY2hlXCJdO1xuXG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuICB2YXIgSEFORExFUlMgPSB7fTtcbiAgLyogVGhlIHN0YXRlIG9mIHRoZSBjdXJyZW50ICdwb2ludGVyJ1xuICAgKiBUaGUgcG9pbnRlciByZXByZXNlbnRzIHRoZSBzdGF0ZSBvZiB0aGUgY3VycmVudCB0b3VjaC5cbiAgICogSXQgY29udGFpbnMgbm9ybWFsaXplZCB4IGFuZCB5IGNvb3JkaW5hdGVzIGZyb20gRE9NIGV2ZW50cyxcbiAgICogYXMgd2VsbCBhcyBvdGhlciBpbmZvcm1hdGlvbiBhYnN0cmFjdGVkIGZyb20gdGhlIERPTS5cbiAgICovXG4gIHZhciBwb2ludGVyLCBsYXN0UG9pbnRlciwgZm9yY2VTa2lwQ2xpY2tIaWphY2sgPSBmYWxzZTtcblxuICAvLyBVc2VkIHRvIGF0dGFjaCBldmVudCBsaXN0ZW5lcnMgb25jZSB3aGVuIG11bHRpcGxlIG5nLWFwcHMgYXJlIHJ1bm5pbmcuXG4gIHZhciBpc0luaXRpYWxpemVkID0gZmFsc2U7XG4gIFxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29yZS5nZXN0dXJlcycsIFsgXSlcbiAgICAucHJvdmlkZXIoJyRtZEdlc3R1cmUnLCBNZEdlc3R1cmVQcm92aWRlcilcbiAgICAuZmFjdG9yeSgnJCRNZEdlc3R1cmVIYW5kbGVyJywgTWRHZXN0dXJlSGFuZGxlcilcbiAgICAucnVuKCBhdHRhY2hUb0RvY3VtZW50ICk7XG5cbiAgLyoqXG4gICAgICogQG5nZG9jIHNlcnZpY2VcbiAgICAgKiBAbmFtZSAkbWRHZXN0dXJlUHJvdmlkZXJcbiAgICAgKiBAbW9kdWxlIG1hdGVyaWFsLmNvcmUuZ2VzdHVyZXNcbiAgICAgKlxuICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAqIEluIHNvbWUgc2NlbmFyaW9zIG9uIE1vYmlsZSBkZXZpY2VzICh3aXRob3V0IGpRdWVyeSksIHRoZSBjbGljayBldmVudHMgc2hvdWxkIE5PVCBiZSBoaWphY2tlZC5cbiAgICAgKiBgJG1kR2VzdHVyZVByb3ZpZGVyYCBpcyB1c2VkIHRvIGNvbmZpZ3VyZSB0aGUgR2VzdHVyZSBtb2R1bGUgdG8gaWdub3JlIG9yIHNraXAgY2xpY2sgaGlqYWNraW5nIG9uIG1vYmlsZVxuICAgICAqIGRldmljZXMuXG4gICAgICpcbiAgICAgKiA8aGxqcyBsYW5nPVwianNcIj5cbiAgICAgKiAgIGFwcC5jb25maWcoZnVuY3Rpb24oJG1kR2VzdHVyZVByb3ZpZGVyKSB7XG4gICAgICpcbiAgICAgKiAgICAgLy8gRm9yIG1vYmlsZSBkZXZpY2VzIHdpdGhvdXQgalF1ZXJ5IGxvYWRlZCwgZG8gbm90XG4gICAgICogICAgIC8vIGludGVyY2VwdCBjbGljayBldmVudHMgZHVyaW5nIHRoZSBjYXB0dXJlIHBoYXNlLlxuICAgICAqICAgICAkbWRHZXN0dXJlUHJvdmlkZXIuc2tpcENsaWNrSGlqYWNrKCk7XG4gICAgICpcbiAgICAgKiAgIH0pO1xuICAgICAqIDwvaGxqcz5cbiAgICAgKlxuICAgICAqL1xuICBmdW5jdGlvbiBNZEdlc3R1cmVQcm92aWRlcigpIHsgfVxuXG4gIE1kR2VzdHVyZVByb3ZpZGVyLnByb3RvdHlwZSA9IHtcblxuICAgIC8vIFB1Ymxpc2ggYWNjZXNzIHRvIHNldHRlciB0byBjb25maWd1cmUgYSB2YXJpYWJsZSAgQkVGT1JFIHRoZVxuICAgIC8vICRtZEdlc3R1cmUgc2VydmljZSBpcyBpbnN0YW50aWF0ZWQuLi5cbiAgICBza2lwQ2xpY2tIaWphY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGZvcmNlU2tpcENsaWNrSGlqYWNrID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogJGdldCBpcyB1c2VkIHRvIGJ1aWxkIGFuIGluc3RhbmNlIG9mICRtZEdlc3R1cmVcbiAgICAgKiBAbmdJbmplY3RcbiAgICAgKi9cbiAgICAkZ2V0IDogW1wiJCRNZEdlc3R1cmVIYW5kbGVyXCIsIFwiJCRyQUZcIiwgXCIkdGltZW91dFwiLCBmdW5jdGlvbigkJE1kR2VzdHVyZUhhbmRsZXIsICQkckFGLCAkdGltZW91dCkge1xuICAgICAgICAgcmV0dXJuIG5ldyBNZEdlc3R1cmUoJCRNZEdlc3R1cmVIYW5kbGVyLCAkJHJBRiwgJHRpbWVvdXQpO1xuICAgIH1dXG4gIH07XG5cblxuXG4gIC8qKlxuICAgKiBNZEdlc3R1cmUgZmFjdG9yeSBjb25zdHJ1Y3Rpb24gZnVuY3Rpb25cbiAgICogQG5nSW5qZWN0XG4gICAqL1xuICBmdW5jdGlvbiBNZEdlc3R1cmUoJCRNZEdlc3R1cmVIYW5kbGVyLCAkJHJBRiwgJHRpbWVvdXQpIHtcbiAgICB2YXIgdXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudCB8fCBuYXZpZ2F0b3IudmVuZG9yIHx8IHdpbmRvdy5vcGVyYTtcbiAgICB2YXIgaXNJb3MgPSB1c2VyQWdlbnQubWF0Y2goL2lwYWR8aXBob25lfGlwb2QvaSk7XG4gICAgdmFyIGlzQW5kcm9pZCA9IHVzZXJBZ2VudC5tYXRjaCgvYW5kcm9pZC9pKTtcbiAgICB2YXIgaGFzSlF1ZXJ5ID0gICh0eXBlb2Ygd2luZG93LmpRdWVyeSAhPT0gJ3VuZGVmaW5lZCcpICYmIChhbmd1bGFyLmVsZW1lbnQgPT09IHdpbmRvdy5qUXVlcnkpO1xuXG4gICAgdmFyIHNlbGYgPSB7XG4gICAgICBoYW5kbGVyOiBhZGRIYW5kbGVyLFxuICAgICAgcmVnaXN0ZXI6IHJlZ2lzdGVyLFxuICAgICAgLy8gT24gbW9iaWxlIHcvb3V0IGpRdWVyeSwgd2Ugbm9ybWFsbHkgaW50ZXJjZXB0IGNsaWNrcy4gU2hvdWxkIHdlIHNraXAgdGhhdD9cbiAgICAgIGlzSGlqYWNraW5nQ2xpY2tzOiAoaXNJb3MgfHwgaXNBbmRyb2lkKSAmJiAhaGFzSlF1ZXJ5ICYmICFmb3JjZVNraXBDbGlja0hpamFja1xuICAgIH07XG5cbiAgICBpZiAoc2VsZi5pc0hpamFja2luZ0NsaWNrcykge1xuICAgICAgc2VsZi5oYW5kbGVyKCdjbGljaycsIHtcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIG1heERpc3RhbmNlOiA2XG4gICAgICAgIH0sXG4gICAgICAgIG9uRW5kOiBmdW5jdGlvbiAoZXYsIHBvaW50ZXIpIHtcbiAgICAgICAgICBpZiAocG9pbnRlci5kaXN0YW5jZSA8IHRoaXMuc3RhdGUub3B0aW9ucy5tYXhEaXN0YW5jZSkge1xuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2LCAnY2xpY2snKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogUmVnaXN0ZXIgYW4gZWxlbWVudCB0byBsaXN0ZW4gZm9yIGEgaGFuZGxlci5cbiAgICAgKiBUaGlzIGFsbG93cyBhbiBlbGVtZW50IHRvIG92ZXJyaWRlIHRoZSBkZWZhdWx0IG9wdGlvbnMgZm9yIGEgaGFuZGxlci5cbiAgICAgKiBBZGRpdGlvbmFsbHksIHNvbWUgaGFuZGxlcnMgbGlrZSBkcmFnIGFuZCBob2xkIG9ubHkgZGlzcGF0Y2ggZXZlbnRzIGlmXG4gICAgICogdGhlIGRvbUV2ZW50IGhhcHBlbnMgaW5zaWRlIGFuIGVsZW1lbnQgdGhhdCdzIHJlZ2lzdGVyZWQgdG8gbGlzdGVuIGZvciB0aGVzZSBldmVudHMuXG4gICAgICpcbiAgICAgKiBAc2VlIEdlc3R1cmVIYW5kbGVyIGZvciBob3cgb3ZlcnJpZGluZyBvZiBkZWZhdWx0IG9wdGlvbnMgd29ya3MuXG4gICAgICogQGV4YW1wbGUgJG1kR2VzdHVyZS5yZWdpc3RlcihteUVsZW1lbnQsICdkcmFnJywgeyBtaW5EaXN0YW5jZTogMjAsIGhvcnppb250YWw6IGZhbHNlIH0pXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVnaXN0ZXIoZWxlbWVudCwgaGFuZGxlck5hbWUsIG9wdGlvbnMpIHtcbiAgICAgIHZhciBoYW5kbGVyID0gSEFORExFUlNbaGFuZGxlck5hbWUucmVwbGFjZSgvXlxcJG1kLi8sICcnKV07XG4gICAgICBpZiAoIWhhbmRsZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gcmVnaXN0ZXIgZWxlbWVudCB3aXRoIGhhbmRsZXIgJyArIGhhbmRsZXJOYW1lICsgJy4gJyArXG4gICAgICAgICdBdmFpbGFibGUgaGFuZGxlcnM6ICcgKyBPYmplY3Qua2V5cyhIQU5ETEVSUykuam9pbignLCAnKSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gaGFuZGxlci5yZWdpc3RlckVsZW1lbnQoZWxlbWVudCwgb3B0aW9ucyk7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBhZGQgYSBoYW5kbGVyIHRvICRtZEdlc3R1cmUuIHNlZSBiZWxvdy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhZGRIYW5kbGVyKG5hbWUsIGRlZmluaXRpb24pIHtcbiAgICAgIHZhciBoYW5kbGVyID0gbmV3ICQkTWRHZXN0dXJlSGFuZGxlcihuYW1lKTtcbiAgICAgIGFuZ3VsYXIuZXh0ZW5kKGhhbmRsZXIsIGRlZmluaXRpb24pO1xuICAgICAgSEFORExFUlNbbmFtZV0gPSBoYW5kbGVyO1xuXG4gICAgICByZXR1cm4gc2VsZjtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIFJlZ2lzdGVyIGhhbmRsZXJzLiBUaGVzZSBsaXN0ZW4gdG8gdG91Y2gvc3RhcnQvbW92ZSBldmVudHMsIGludGVycHJldCB0aGVtLFxuICAgICAqIGFuZCBkaXNwYXRjaCBnZXN0dXJlIGV2ZW50cyBkZXBlbmRpbmcgb24gb3B0aW9ucyAmIGNvbmRpdGlvbnMuIFRoZXNlIGFyZSBhbGxcbiAgICAgKiBpbnN0YW5jZXMgb2YgR2VzdHVyZUhhbmRsZXIuXG4gICAgICogQHNlZSBHZXN0dXJlSGFuZGxlciBcbiAgICAgKi9cbiAgICByZXR1cm4gc2VsZlxuICAgICAgLypcbiAgICAgICAqIFRoZSBwcmVzcyBoYW5kbGVyIGRpc3BhdGNoZXMgYW4gZXZlbnQgb24gdG91Y2hkb3duL3RvdWNoZW5kLlxuICAgICAgICogSXQncyBhIHNpbXBsZSBhYnN0cmFjdGlvbiBvZiB0b3VjaC9tb3VzZS9wb2ludGVyIHN0YXJ0IGFuZCBlbmQuXG4gICAgICAgKi9cbiAgICAgIC5oYW5kbGVyKCdwcmVzcycsIHtcbiAgICAgICAgb25TdGFydDogZnVuY3Rpb24gKGV2LCBwb2ludGVyKSB7XG4gICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2LCAnJG1kLnByZXNzZG93bicpO1xuICAgICAgICB9LFxuICAgICAgICBvbkVuZDogZnVuY3Rpb24gKGV2LCBwb2ludGVyKSB7XG4gICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2LCAnJG1kLnByZXNzdXAnKTtcbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgLypcbiAgICAgICAqIFRoZSBob2xkIGhhbmRsZXIgZGlzcGF0Y2hlcyBhbiBldmVudCBpZiB0aGUgdXNlciBrZWVwcyB0aGVpciBmaW5nZXIgd2l0aGluXG4gICAgICAgKiB0aGUgc2FtZSA8bWF4RGlzdGFuY2U+IGFyZWEgZm9yIDxkZWxheT4gbXMuXG4gICAgICAgKiBUaGUgaG9sZCBoYW5kbGVyIHdpbGwgb25seSBydW4gaWYgYSBwYXJlbnQgb2YgdGhlIHRvdWNoIHRhcmdldCBpcyByZWdpc3RlcmVkXG4gICAgICAgKiB0byBsaXN0ZW4gZm9yIGhvbGQgZXZlbnRzIHRocm91Z2ggJG1kR2VzdHVyZS5yZWdpc3RlcigpXG4gICAgICAgKi9cbiAgICAgIC5oYW5kbGVyKCdob2xkJywge1xuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgbWF4RGlzdGFuY2U6IDYsXG4gICAgICAgICAgZGVsYXk6IDUwMFxuICAgICAgICB9LFxuICAgICAgICBvbkNhbmNlbDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aGlzLnN0YXRlLnRpbWVvdXQpO1xuICAgICAgICB9LFxuICAgICAgICBvblN0YXJ0OiBmdW5jdGlvbiAoZXYsIHBvaW50ZXIpIHtcbiAgICAgICAgICAvLyBGb3IgaG9sZCwgcmVxdWlyZSBhIHBhcmVudCB0byBiZSByZWdpc3RlcmVkIHdpdGggJG1kR2VzdHVyZS5yZWdpc3RlcigpXG4gICAgICAgICAgLy8gQmVjYXVzZSB3ZSBwcmV2ZW50IHNjcm9sbCBldmVudHMsIHRoaXMgaXMgbmVjZXNzYXJ5LlxuICAgICAgICAgIGlmICghdGhpcy5zdGF0ZS5yZWdpc3RlcmVkUGFyZW50KSByZXR1cm4gdGhpcy5jYW5jZWwoKTtcblxuICAgICAgICAgIHRoaXMuc3RhdGUucG9zID0ge3g6IHBvaW50ZXIueCwgeTogcG9pbnRlci55fTtcbiAgICAgICAgICB0aGlzLnN0YXRlLnRpbWVvdXQgPSAkdGltZW91dChhbmd1bGFyLmJpbmQodGhpcywgZnVuY3Rpb24gaG9sZERlbGF5Rm4oKSB7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXYsICckbWQuaG9sZCcpO1xuICAgICAgICAgICAgdGhpcy5jYW5jZWwoKTsgLy93ZSdyZSBkb25lIVxuICAgICAgICAgIH0pLCB0aGlzLnN0YXRlLm9wdGlvbnMuZGVsYXksIGZhbHNlKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25Nb3ZlOiBmdW5jdGlvbiAoZXYsIHBvaW50ZXIpIHtcbiAgICAgICAgICAvLyBEb24ndCBzY3JvbGwgd2hpbGUgd2FpdGluZyBmb3IgaG9sZC5cbiAgICAgICAgICAvLyBJZiB3ZSBkb24ndCBwcmV2ZW50RGVmYXVsdCB0b3VjaG1vdmUgZXZlbnRzIGhlcmUsIEFuZHJvaWQgd2lsbCBhc3N1bWUgd2UgZG9uJ3RcbiAgICAgICAgICAvLyB3YW50IHRvIGxpc3RlbiB0byBhbnltb3JlIHRvdWNoIGV2ZW50cy4gSXQgd2lsbCBzdGFydCBzY3JvbGxpbmcgYW5kIHN0b3Agc2VuZGluZ1xuICAgICAgICAgIC8vIHRvdWNobW92ZSBldmVudHMuXG4gICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgIC8vIElmIHRoZSB1c2VyIG1vdmVzIGdyZWF0ZXIgdGhhbiA8bWF4RGlzdGFuY2U+IHBpeGVscywgc3RvcCB0aGUgaG9sZCB0aW1lclxuICAgICAgICAgIC8vIHNldCBpbiBvblN0YXJ0XG4gICAgICAgICAgdmFyIGR4ID0gdGhpcy5zdGF0ZS5wb3MueCAtIHBvaW50ZXIueDtcbiAgICAgICAgICB2YXIgZHkgPSB0aGlzLnN0YXRlLnBvcy55IC0gcG9pbnRlci55O1xuICAgICAgICAgIGlmIChNYXRoLnNxcnQoZHggKiBkeCArIGR5ICogZHkpID4gdGhpcy5vcHRpb25zLm1heERpc3RhbmNlKSB7XG4gICAgICAgICAgICB0aGlzLmNhbmNlbCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgb25FbmQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB0aGlzLm9uQ2FuY2VsKCk7XG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIC8qXG4gICAgICAgKiBUaGUgZHJhZyBoYW5kbGVyIGRpc3BhdGNoZXMgYSBkcmFnIGV2ZW50IGlmIHRoZSB1c2VyIGhvbGRzIGFuZCBtb3ZlcyBoaXMgZmluZ2VyIGdyZWF0ZXIgdGhhblxuICAgICAgICogPG1pbkRpc3RhbmNlPiBweCBpbiB0aGUgeCBvciB5IGRpcmVjdGlvbiwgZGVwZW5kaW5nIG9uIG9wdGlvbnMuaG9yaXpvbnRhbC5cbiAgICAgICAqIFRoZSBkcmFnIHdpbGwgYmUgY2FuY2VsbGVkIGlmIHRoZSB1c2VyIG1vdmVzIGhpcyBmaW5nZXIgZ3JlYXRlciB0aGFuIDxtaW5EaXN0YW5jZT4qPGNhbmNlbE11bHRpcGxpZXI+IGluXG4gICAgICAgKiB0aGUgcGVycGluZGljdWxhciBkaXJlY3Rpb24uIEVnIGlmIHRoZSBkcmFnIGlzIGhvcml6b250YWwgYW5kIHRoZSB1c2VyIG1vdmVzIGhpcyBmaW5nZXIgPG1pbkRpc3RhbmNlPio8Y2FuY2VsTXVsdGlwbGllcj5cbiAgICAgICAqIHBpeGVscyB2ZXJ0aWNhbGx5LCB0aGlzIGhhbmRsZXIgd29uJ3QgY29uc2lkZXIgdGhlIG1vdmUgcGFydCBvZiBhIGRyYWcuXG4gICAgICAgKi9cbiAgICAgIC5oYW5kbGVyKCdkcmFnJywge1xuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgbWluRGlzdGFuY2U6IDYsXG4gICAgICAgICAgaG9yaXpvbnRhbDogdHJ1ZSxcbiAgICAgICAgICBjYW5jZWxNdWx0aXBsaWVyOiAxLjVcbiAgICAgICAgfSxcbiAgICAgICAgb25TdGFydDogZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgICAgLy8gRm9yIGRyYWcsIHJlcXVpcmUgYSBwYXJlbnQgdG8gYmUgcmVnaXN0ZXJlZCB3aXRoICRtZEdlc3R1cmUucmVnaXN0ZXIoKVxuICAgICAgICAgIGlmICghdGhpcy5zdGF0ZS5yZWdpc3RlcmVkUGFyZW50KSB0aGlzLmNhbmNlbCgpO1xuICAgICAgICB9LFxuICAgICAgICBvbk1vdmU6IGZ1bmN0aW9uIChldiwgcG9pbnRlcikge1xuICAgICAgICAgIHZhciBzaG91bGRTdGFydERyYWcsIHNob3VsZENhbmNlbDtcbiAgICAgICAgICAvLyBEb24ndCBzY3JvbGwgd2hpbGUgZGVjaWRpbmcgaWYgdGhpcyB0b3VjaG1vdmUgcXVhbGlmaWVzIGFzIGEgZHJhZyBldmVudC5cbiAgICAgICAgICAvLyBJZiB3ZSBkb24ndCBwcmV2ZW50RGVmYXVsdCB0b3VjaG1vdmUgZXZlbnRzIGhlcmUsIEFuZHJvaWQgd2lsbCBhc3N1bWUgd2UgZG9uJ3RcbiAgICAgICAgICAvLyB3YW50IHRvIGxpc3RlbiB0byBhbnltb3JlIHRvdWNoIGV2ZW50cy4gSXQgd2lsbCBzdGFydCBzY3JvbGxpbmcgYW5kIHN0b3Agc2VuZGluZ1xuICAgICAgICAgIC8vIHRvdWNobW92ZSBldmVudHMuXG4gICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgIGlmICghdGhpcy5zdGF0ZS5kcmFnUG9pbnRlcikge1xuICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUub3B0aW9ucy5ob3Jpem9udGFsKSB7XG4gICAgICAgICAgICAgIHNob3VsZFN0YXJ0RHJhZyA9IE1hdGguYWJzKHBvaW50ZXIuZGlzdGFuY2VYKSA+IHRoaXMuc3RhdGUub3B0aW9ucy5taW5EaXN0YW5jZTtcbiAgICAgICAgICAgICAgc2hvdWxkQ2FuY2VsID0gTWF0aC5hYnMocG9pbnRlci5kaXN0YW5jZVkpID4gdGhpcy5zdGF0ZS5vcHRpb25zLm1pbkRpc3RhbmNlICogdGhpcy5zdGF0ZS5vcHRpb25zLmNhbmNlbE11bHRpcGxpZXI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzaG91bGRTdGFydERyYWcgPSBNYXRoLmFicyhwb2ludGVyLmRpc3RhbmNlWSkgPiB0aGlzLnN0YXRlLm9wdGlvbnMubWluRGlzdGFuY2U7XG4gICAgICAgICAgICAgIHNob3VsZENhbmNlbCA9IE1hdGguYWJzKHBvaW50ZXIuZGlzdGFuY2VYKSA+IHRoaXMuc3RhdGUub3B0aW9ucy5taW5EaXN0YW5jZSAqIHRoaXMuc3RhdGUub3B0aW9ucy5jYW5jZWxNdWx0aXBsaWVyO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoc2hvdWxkU3RhcnREcmFnKSB7XG4gICAgICAgICAgICAgIC8vIENyZWF0ZSBhIG5ldyBwb2ludGVyIHJlcHJlc2VudGluZyB0aGlzIGRyYWcsIHN0YXJ0aW5nIGF0IHRoaXMgcG9pbnQgd2hlcmUgdGhlIGRyYWcgc3RhcnRlZC5cbiAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5kcmFnUG9pbnRlciA9IG1ha2VTdGFydFBvaW50ZXIoZXYpO1xuICAgICAgICAgICAgICB1cGRhdGVQb2ludGVyU3RhdGUoZXYsIHRoaXMuc3RhdGUuZHJhZ1BvaW50ZXIpO1xuICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXYsICckbWQuZHJhZ3N0YXJ0JywgdGhpcy5zdGF0ZS5kcmFnUG9pbnRlcik7XG5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hvdWxkQ2FuY2VsKSB7XG4gICAgICAgICAgICAgIHRoaXMuY2FuY2VsKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hEcmFnTW92ZShldik7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvLyBPbmx5IGRpc3BhdGNoIGRyYWdtb3ZlIGV2ZW50cyBldmVyeSBmcmFtZTsgYW55IG1vcmUgaXMgdW5uZWNlc3NyYXlcbiAgICAgICAgZGlzcGF0Y2hEcmFnTW92ZTogJCRyQUYudGhyb3R0bGUoZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgICAgLy8gTWFrZSBzdXJlIHRoZSBkcmFnIGRpZG4ndCBzdG9wIHdoaWxlIHdhaXRpbmcgZm9yIHRoZSBuZXh0IGZyYW1lXG4gICAgICAgICAgaWYgKHRoaXMuc3RhdGUuaXNSdW5uaW5nKSB7XG4gICAgICAgICAgICB1cGRhdGVQb2ludGVyU3RhdGUoZXYsIHRoaXMuc3RhdGUuZHJhZ1BvaW50ZXIpO1xuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2LCAnJG1kLmRyYWcnLCB0aGlzLnN0YXRlLmRyYWdQb2ludGVyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pLFxuICAgICAgICBvbkVuZDogZnVuY3Rpb24gKGV2LCBwb2ludGVyKSB7XG4gICAgICAgICAgaWYgKHRoaXMuc3RhdGUuZHJhZ1BvaW50ZXIpIHtcbiAgICAgICAgICAgIHVwZGF0ZVBvaW50ZXJTdGF0ZShldiwgdGhpcy5zdGF0ZS5kcmFnUG9pbnRlcik7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXYsICckbWQuZHJhZ2VuZCcsIHRoaXMuc3RhdGUuZHJhZ1BvaW50ZXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgLypcbiAgICAgICAqIFRoZSBzd2lwZSBoYW5kbGVyIHdpbGwgZGlzcGF0Y2ggYSBzd2lwZSBldmVudCBpZiwgb24gdGhlIGVuZCBvZiBhIHRvdWNoLFxuICAgICAgICogdGhlIHZlbG9jaXR5IGFuZCBkaXN0YW5jZSB3ZXJlIGhpZ2ggZW5vdWdoLlxuICAgICAgICogVE9ETzogYWRkIHZlcnRpY2FsIHN3aXBpbmcgd2l0aCBhIGBob3Jpem9udGFsYCBvcHRpb24gc2ltaWxhciB0byB0aGUgZHJhZyBoYW5kbGVyLlxuICAgICAgICovXG4gICAgICAuaGFuZGxlcignc3dpcGUnLCB7XG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBtaW5WZWxvY2l0eTogMC42NSxcbiAgICAgICAgICBtaW5EaXN0YW5jZTogMTBcbiAgICAgICAgfSxcbiAgICAgICAgb25FbmQ6IGZ1bmN0aW9uIChldiwgcG9pbnRlcikge1xuICAgICAgICAgIGlmIChNYXRoLmFicyhwb2ludGVyLnZlbG9jaXR5WCkgPiB0aGlzLnN0YXRlLm9wdGlvbnMubWluVmVsb2NpdHkgJiZcbiAgICAgICAgICAgIE1hdGguYWJzKHBvaW50ZXIuZGlzdGFuY2VYKSA+IHRoaXMuc3RhdGUub3B0aW9ucy5taW5EaXN0YW5jZSkge1xuICAgICAgICAgICAgdmFyIGV2ZW50VHlwZSA9IHBvaW50ZXIuZGlyZWN0aW9uWCA9PSAnbGVmdCcgPyAnJG1kLnN3aXBlbGVmdCcgOiAnJG1kLnN3aXBlcmlnaHQnO1xuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2LCBldmVudFR5cGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgfVxuICBNZEdlc3R1cmUuJGluamVjdCA9IFtcIiQkTWRHZXN0dXJlSGFuZGxlclwiLCBcIiQkckFGXCIsIFwiJHRpbWVvdXRcIl07XG5cbiAgLyoqXG4gICAqIE1kR2VzdHVyZUhhbmRsZXJcbiAgICogQSBHZXN0dXJlSGFuZGxlciBpcyBhbiBvYmplY3Qgd2hpY2ggaXMgYWJsZSB0byBkaXNwYXRjaCBjdXN0b20gZG9tIGV2ZW50c1xuICAgKiBiYXNlZCBvbiBuYXRpdmUgZG9tIHt0b3VjaCxwb2ludGVyLG1vdXNlfXtzdGFydCxtb3ZlLGVuZH0gZXZlbnRzLlxuICAgKlxuICAgKiBBIGdlc3R1cmUgd2lsbCBtYW5hZ2UgaXRzIGxpZmVjeWNsZSB0aHJvdWdoIHRoZSBzdGFydCxtb3ZlLGVuZCwgYW5kIGNhbmNlbFxuICAgKiBmdW5jdGlvbnMsIHdoaWNoIGFyZSBjYWxsZWQgYnkgbmF0aXZlIGRvbSBldmVudHMuXG4gICAqXG4gICAqIEEgZ2VzdHVyZSBoYXMgdGhlIGNvbmNlcHQgb2YgJ29wdGlvbnMnIChlZyBhIHN3aXBlJ3MgcmVxdWlyZWQgdmVsb2NpdHkpLCB3aGljaCBjYW4gYmVcbiAgICogb3ZlcnJpZGRlbiBieSBlbGVtZW50cyByZWdpc3RlcmluZyB0aHJvdWdoICRtZEdlc3R1cmUucmVnaXN0ZXIoKVxuICAgKi9cbiAgZnVuY3Rpb24gR2VzdHVyZUhhbmRsZXIgKG5hbWUpIHtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIHRoaXMuc3RhdGUgPSB7fTtcbiAgfVxuXG4gIGZ1bmN0aW9uIE1kR2VzdHVyZUhhbmRsZXIoKSB7XG4gICAgdmFyIGhhc0pRdWVyeSA9ICAodHlwZW9mIHdpbmRvdy5qUXVlcnkgIT09ICd1bmRlZmluZWQnKSAmJiAoYW5ndWxhci5lbGVtZW50ID09PSB3aW5kb3cualF1ZXJ5KTtcblxuICAgIEdlc3R1cmVIYW5kbGVyLnByb3RvdHlwZSA9IHtcbiAgICAgIG9wdGlvbnM6IHt9LFxuICAgICAgLy8galF1ZXJ5IGxpc3RlbmVycyBkb24ndCB3b3JrIHdpdGggY3VzdG9tIERPTUV2ZW50cywgc28gd2UgaGF2ZSB0byBkaXNwYXRjaCBldmVudHNcbiAgICAgIC8vIGRpZmZlcmVudGx5IHdoZW4galF1ZXJ5IGlzIGxvYWRlZFxuICAgICAgZGlzcGF0Y2hFdmVudDogaGFzSlF1ZXJ5ID8gIGpRdWVyeURpc3BhdGNoRXZlbnQgOiBuYXRpdmVEaXNwYXRjaEV2ZW50LFxuXG4gICAgICAvLyBUaGVzZSBhcmUgb3ZlcnJpZGRlbiBieSB0aGUgcmVnaXN0ZXJlZCBoYW5kbGVyXG4gICAgICBvblN0YXJ0OiBhbmd1bGFyLm5vb3AsXG4gICAgICBvbk1vdmU6IGFuZ3VsYXIubm9vcCxcbiAgICAgIG9uRW5kOiBhbmd1bGFyLm5vb3AsXG4gICAgICBvbkNhbmNlbDogYW5ndWxhci5ub29wLFxuXG4gICAgICAvLyBvblN0YXJ0IHNldHMgdXAgYSBuZXcgc3RhdGUgZm9yIHRoZSBoYW5kbGVyLCB3aGljaCBpbmNsdWRlcyBvcHRpb25zIGZyb20gdGhlXG4gICAgICAvLyBuZWFyZXN0IHJlZ2lzdGVyZWQgcGFyZW50IGVsZW1lbnQgb2YgZXYudGFyZ2V0LlxuICAgICAgc3RhcnQ6IGZ1bmN0aW9uIChldiwgcG9pbnRlcikge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5pc1J1bm5pbmcpIHJldHVybjtcbiAgICAgICAgdmFyIHBhcmVudFRhcmdldCA9IHRoaXMuZ2V0TmVhcmVzdFBhcmVudChldi50YXJnZXQpO1xuICAgICAgICAvLyBHZXQgdGhlIG9wdGlvbnMgZnJvbSB0aGUgbmVhcmVzdCByZWdpc3RlcmVkIHBhcmVudFxuICAgICAgICB2YXIgcGFyZW50VGFyZ2V0T3B0aW9ucyA9IHBhcmVudFRhcmdldCAmJiBwYXJlbnRUYXJnZXQuJG1kR2VzdHVyZVt0aGlzLm5hbWVdIHx8IHt9O1xuXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgaXNSdW5uaW5nOiB0cnVlLFxuICAgICAgICAgIC8vIE92ZXJyaWRlIHRoZSBkZWZhdWx0IG9wdGlvbnMgd2l0aCB0aGUgbmVhcmVzdCByZWdpc3RlcmVkIHBhcmVudCdzIG9wdGlvbnNcbiAgICAgICAgICBvcHRpb25zOiBhbmd1bGFyLmV4dGVuZCh7fSwgdGhpcy5vcHRpb25zLCBwYXJlbnRUYXJnZXRPcHRpb25zKSxcbiAgICAgICAgICAvLyBQYXNzIGluIHRoZSByZWdpc3RlcmVkIHBhcmVudCBub2RlIHRvIHRoZSBzdGF0ZSBzbyB0aGUgb25TdGFydCBsaXN0ZW5lciBjYW4gdXNlXG4gICAgICAgICAgcmVnaXN0ZXJlZFBhcmVudDogcGFyZW50VGFyZ2V0XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMub25TdGFydChldiwgcG9pbnRlcik7XG4gICAgICB9LFxuICAgICAgbW92ZTogZnVuY3Rpb24gKGV2LCBwb2ludGVyKSB7XG4gICAgICAgIGlmICghdGhpcy5zdGF0ZS5pc1J1bm5pbmcpIHJldHVybjtcbiAgICAgICAgdGhpcy5vbk1vdmUoZXYsIHBvaW50ZXIpO1xuICAgICAgfSxcbiAgICAgIGVuZDogZnVuY3Rpb24gKGV2LCBwb2ludGVyKSB7XG4gICAgICAgIGlmICghdGhpcy5zdGF0ZS5pc1J1bm5pbmcpIHJldHVybjtcbiAgICAgICAgdGhpcy5vbkVuZChldiwgcG9pbnRlcik7XG4gICAgICAgIHRoaXMuc3RhdGUuaXNSdW5uaW5nID0gZmFsc2U7XG4gICAgICB9LFxuICAgICAgY2FuY2VsOiBmdW5jdGlvbiAoZXYsIHBvaW50ZXIpIHtcbiAgICAgICAgdGhpcy5vbkNhbmNlbChldiwgcG9pbnRlcik7XG4gICAgICAgIHRoaXMuc3RhdGUgPSB7fTtcbiAgICAgIH0sXG5cbiAgICAgIC8vIEZpbmQgYW5kIHJldHVybiB0aGUgbmVhcmVzdCBwYXJlbnQgZWxlbWVudCB0aGF0IGhhcyBiZWVuIHJlZ2lzdGVyZWQgdG9cbiAgICAgIC8vIGxpc3RlbiBmb3IgdGhpcyBoYW5kbGVyIHZpYSAkbWRHZXN0dXJlLnJlZ2lzdGVyKGVsZW1lbnQsICdoYW5kbGVyTmFtZScpLlxuICAgICAgZ2V0TmVhcmVzdFBhcmVudDogZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgdmFyIGN1cnJlbnQgPSBub2RlO1xuICAgICAgICB3aGlsZSAoY3VycmVudCkge1xuICAgICAgICAgIGlmICgoY3VycmVudC4kbWRHZXN0dXJlIHx8IHt9KVt0aGlzLm5hbWVdKSB7XG4gICAgICAgICAgICByZXR1cm4gY3VycmVudDtcbiAgICAgICAgICB9XG4gICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQucGFyZW50Tm9kZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH0sXG5cbiAgICAgIC8vIENhbGxlZCBmcm9tICRtZEdlc3R1cmUucmVnaXN0ZXIgd2hlbiBhbiBlbGVtZW50IHJlaWdzdGVycyBpdHNlbGYgd2l0aCBhIGhhbmRsZXIuXG4gICAgICAvLyBTdG9yZSB0aGUgb3B0aW9ucyB0aGUgdXNlciBnYXZlIG9uIHRoZSBET01FbGVtZW50IGl0c2VsZi4gVGhlc2Ugb3B0aW9ucyB3aWxsXG4gICAgICAvLyBiZSByZXRyaWV2ZWQgd2l0aCBnZXROZWFyZXN0UGFyZW50IHdoZW4gdGhlIGhhbmRsZXIgc3RhcnRzLlxuICAgICAgcmVnaXN0ZXJFbGVtZW50OiBmdW5jdGlvbiAoZWxlbWVudCwgb3B0aW9ucykge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIGVsZW1lbnRbMF0uJG1kR2VzdHVyZSA9IGVsZW1lbnRbMF0uJG1kR2VzdHVyZSB8fCB7fTtcbiAgICAgICAgZWxlbWVudFswXS4kbWRHZXN0dXJlW3RoaXMubmFtZV0gPSBvcHRpb25zIHx8IHt9O1xuICAgICAgICBlbGVtZW50Lm9uKCckZGVzdHJveScsIG9uRGVzdHJveSk7XG5cbiAgICAgICAgcmV0dXJuIG9uRGVzdHJveTtcblxuICAgICAgICBmdW5jdGlvbiBvbkRlc3Ryb3koKSB7XG4gICAgICAgICAgZGVsZXRlIGVsZW1lbnRbMF0uJG1kR2VzdHVyZVtzZWxmLm5hbWVdO1xuICAgICAgICAgIGVsZW1lbnQub2ZmKCckZGVzdHJveScsIG9uRGVzdHJveSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIEdlc3R1cmVIYW5kbGVyO1xuXG4gICAgLypcbiAgICAgKiBEaXNwYXRjaCBhbiBldmVudCB3aXRoIGpRdWVyeVxuICAgICAqIFRPRE86IE1ha2Ugc3VyZSB0aGlzIHNlbmRzIGJ1YmJsaW5nIGV2ZW50c1xuICAgICAqXG4gICAgICogQHBhcmFtIHNyY0V2ZW50IHRoZSBvcmlnaW5hbCBET00gdG91Y2ggZXZlbnQgdGhhdCBzdGFydGVkIHRoaXMuXG4gICAgICogQHBhcmFtIGV2ZW50VHlwZSB0aGUgbmFtZSBvZiB0aGUgY3VzdG9tIGV2ZW50IHRvIHNlbmQgKGVnICdjbGljaycgb3IgJyRtZC5kcmFnJylcbiAgICAgKiBAcGFyYW0gZXZlbnRQb2ludGVyIHRoZSBwb2ludGVyIG9iamVjdCB0aGF0IG1hdGNoZXMgdGhpcyBldmVudC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBqUXVlcnlEaXNwYXRjaEV2ZW50KHNyY0V2ZW50LCBldmVudFR5cGUsIGV2ZW50UG9pbnRlcikge1xuICAgICAgZXZlbnRQb2ludGVyID0gZXZlbnRQb2ludGVyIHx8IHBvaW50ZXI7XG4gICAgICB2YXIgZXZlbnRPYmogPSBuZXcgYW5ndWxhci5lbGVtZW50LkV2ZW50KGV2ZW50VHlwZSk7XG5cbiAgICAgIGV2ZW50T2JqLiRtYXRlcmlhbCA9IHRydWU7XG4gICAgICBldmVudE9iai5wb2ludGVyID0gZXZlbnRQb2ludGVyO1xuICAgICAgZXZlbnRPYmouc3JjRXZlbnQgPSBzcmNFdmVudDtcblxuICAgICAgYW5ndWxhci5leHRlbmQoZXZlbnRPYmosIHtcbiAgICAgICAgY2xpZW50WDogZXZlbnRQb2ludGVyLngsXG4gICAgICAgIGNsaWVudFk6IGV2ZW50UG9pbnRlci55LFxuICAgICAgICBzY3JlZW5YOiBldmVudFBvaW50ZXIueCxcbiAgICAgICAgc2NyZWVuWTogZXZlbnRQb2ludGVyLnksXG4gICAgICAgIHBhZ2VYOiBldmVudFBvaW50ZXIueCxcbiAgICAgICAgcGFnZVk6IGV2ZW50UG9pbnRlci55LFxuICAgICAgICBjdHJsS2V5OiBzcmNFdmVudC5jdHJsS2V5LFxuICAgICAgICBhbHRLZXk6IHNyY0V2ZW50LmFsdEtleSxcbiAgICAgICAgc2hpZnRLZXk6IHNyY0V2ZW50LnNoaWZ0S2V5LFxuICAgICAgICBtZXRhS2V5OiBzcmNFdmVudC5tZXRhS2V5XG4gICAgICB9KTtcbiAgICAgIGFuZ3VsYXIuZWxlbWVudChldmVudFBvaW50ZXIudGFyZ2V0KS50cmlnZ2VyKGV2ZW50T2JqKTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIE5PVEU6IG5hdGl2ZURpc3BhdGNoRXZlbnQgaXMgdmVyeSBwZXJmb3JtYW5jZSBzZW5zaXRpdmUuXG4gICAgICogQHBhcmFtIHNyY0V2ZW50IHRoZSBvcmlnaW5hbCBET00gdG91Y2ggZXZlbnQgdGhhdCBzdGFydGVkIHRoaXMuXG4gICAgICogQHBhcmFtIGV2ZW50VHlwZSB0aGUgbmFtZSBvZiB0aGUgY3VzdG9tIGV2ZW50IHRvIHNlbmQgKGVnICdjbGljaycgb3IgJyRtZC5kcmFnJylcbiAgICAgKiBAcGFyYW0gZXZlbnRQb2ludGVyIHRoZSBwb2ludGVyIG9iamVjdCB0aGF0IG1hdGNoZXMgdGhpcyBldmVudC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBuYXRpdmVEaXNwYXRjaEV2ZW50KHNyY0V2ZW50LCBldmVudFR5cGUsIGV2ZW50UG9pbnRlcikge1xuICAgICAgZXZlbnRQb2ludGVyID0gZXZlbnRQb2ludGVyIHx8IHBvaW50ZXI7XG4gICAgICB2YXIgZXZlbnRPYmo7XG5cbiAgICAgIGlmIChldmVudFR5cGUgPT09ICdjbGljaycpIHtcbiAgICAgICAgZXZlbnRPYmogPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnTW91c2VFdmVudHMnKTtcbiAgICAgICAgZXZlbnRPYmouaW5pdE1vdXNlRXZlbnQoXG4gICAgICAgICAgJ2NsaWNrJywgdHJ1ZSwgdHJ1ZSwgd2luZG93LCBzcmNFdmVudC5kZXRhaWwsXG4gICAgICAgICAgZXZlbnRQb2ludGVyLngsIGV2ZW50UG9pbnRlci55LCBldmVudFBvaW50ZXIueCwgZXZlbnRQb2ludGVyLnksXG4gICAgICAgICAgc3JjRXZlbnQuY3RybEtleSwgc3JjRXZlbnQuYWx0S2V5LCBzcmNFdmVudC5zaGlmdEtleSwgc3JjRXZlbnQubWV0YUtleSxcbiAgICAgICAgICBzcmNFdmVudC5idXR0b24sIHNyY0V2ZW50LnJlbGF0ZWRUYXJnZXQgfHwgbnVsbFxuICAgICAgICApO1xuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBldmVudE9iaiA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xuICAgICAgICBldmVudE9iai5pbml0Q3VzdG9tRXZlbnQoZXZlbnRUeXBlLCB0cnVlLCB0cnVlLCB7fSk7XG4gICAgICB9XG4gICAgICBldmVudE9iai4kbWF0ZXJpYWwgPSB0cnVlO1xuICAgICAgZXZlbnRPYmoucG9pbnRlciA9IGV2ZW50UG9pbnRlcjtcbiAgICAgIGV2ZW50T2JqLnNyY0V2ZW50ID0gc3JjRXZlbnQ7XG4gICAgICBldmVudFBvaW50ZXIudGFyZ2V0LmRpc3BhdGNoRXZlbnQoZXZlbnRPYmopO1xuICAgIH1cblxuICB9XG5cbiAgLyoqXG4gICAqIEF0dGFjaCBHZXN0dXJlczogaG9vayBkb2N1bWVudCBhbmQgY2hlY2sgc2hvdWxkSGlqYWNrIGNsaWNrc1xuICAgKiBAbmdJbmplY3RcbiAgICovXG4gIGZ1bmN0aW9uIGF0dGFjaFRvRG9jdW1lbnQoICRtZEdlc3R1cmUsICQkTWRHZXN0dXJlSGFuZGxlciApIHtcblxuICAgIC8vIFBvbHlmaWxsIGRvY3VtZW50LmNvbnRhaW5zIGZvciBJRTExLlxuICAgIC8vIFRPRE86IG1vdmUgdG8gdXRpbFxuICAgIGRvY3VtZW50LmNvbnRhaW5zIHx8IChkb2N1bWVudC5jb250YWlucyA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICByZXR1cm4gZG9jdW1lbnQuYm9keS5jb250YWlucyhub2RlKTtcbiAgICB9KTtcblxuICAgIGlmICghaXNJbml0aWFsaXplZCAmJiAkbWRHZXN0dXJlLmlzSGlqYWNraW5nQ2xpY2tzICkge1xuICAgICAgLypcbiAgICAgICAqIElmIGhpamFjayBjbGlja3MgaXMgdHJ1ZSwgd2UgcHJldmVudERlZmF1bHQgYW55IGNsaWNrIHRoYXQgd2Fzbid0XG4gICAgICAgKiBzZW50IGJ5IG5nTWF0ZXJpYWwuIFRoaXMgaXMgYmVjYXVzZSBvbiBvbGRlciBBbmRyb2lkICYgaU9TLCBhIGZhbHNlLCBvciAnZ2hvc3QnLFxuICAgICAgICogY2xpY2sgZXZlbnQgd2lsbCBiZSBzZW50IH40MDBtcyBhZnRlciBhIHRvdWNoZW5kIGV2ZW50IGhhcHBlbnMuXG4gICAgICAgKiBUaGUgb25seSB3YXkgdG8ga25vdyBpZiB0aGlzIGNsaWNrIGlzIHJlYWwgaXMgdG8gcHJldmVudCBhbnkgbm9ybWFsXG4gICAgICAgKiBjbGljayBldmVudHMsIGFuZCBhZGQgYSBmbGFnIHRvIGV2ZW50cyBzZW50IGJ5IG1hdGVyaWFsIHNvIHdlIGtub3cgbm90IHRvIHByZXZlbnQgdGhvc2UuXG4gICAgICAgKiBcbiAgICAgICAqIFR3byBleGNlcHRpb25zIHRvIGNsaWNrIGV2ZW50cyB0aGF0IHNob3VsZCBiZSBwcmV2ZW50ZWQgYXJlOlxuICAgICAgICogIC0gY2xpY2sgZXZlbnRzIHNlbnQgYnkgdGhlIGtleWJvYXJkIChlZyBmb3JtIHN1Ym1pdClcbiAgICAgICAqICAtIGV2ZW50cyB0aGF0IG9yaWdpbmF0ZSBmcm9tIGFuIElvbmljIGFwcFxuICAgICAgICovXG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIGNsaWNrSGlqYWNrZXIoZXYpIHtcbiAgICAgICAgdmFyIGlzS2V5Q2xpY2sgPSBldi5jbGllbnRYID09PSAwICYmIGV2LmNsaWVudFkgPT09IDA7XG4gICAgICAgIGlmICghaXNLZXlDbGljayAmJiAhZXYuJG1hdGVyaWFsICYmICFldi5pc0lvbmljVGFwKSB7XG4gICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgfVxuICAgICAgfSwgdHJ1ZSk7XG4gICAgICBcbiAgICAgIGlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIC8vIExpc3RlbiB0byBhbGwgZXZlbnRzIHRvIGNvdmVyIGFsbCBwbGF0Zm9ybXMuXG4gICAgdmFyIFNUQVJUX0VWRU5UUyA9ICdtb3VzZWRvd24gdG91Y2hzdGFydCBwb2ludGVyZG93bic7XG4gICAgdmFyIE1PVkVfRVZFTlRTID0gJ21vdXNlbW92ZSB0b3VjaG1vdmUgcG9pbnRlcm1vdmUnO1xuICAgIHZhciBFTkRfRVZFTlRTID0gJ21vdXNldXAgbW91c2VsZWF2ZSB0b3VjaGVuZCB0b3VjaGNhbmNlbCBwb2ludGVydXAgcG9pbnRlcmNhbmNlbCc7XG5cbiAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpXG4gICAgICAub24oU1RBUlRfRVZFTlRTLCBnZXN0dXJlU3RhcnQpXG4gICAgICAub24oTU9WRV9FVkVOVFMsIGdlc3R1cmVNb3ZlKVxuICAgICAgLm9uKEVORF9FVkVOVFMsIGdlc3R1cmVFbmQpXG4gICAgICAvLyBGb3IgdGVzdGluZ1xuICAgICAgLm9uKCckJG1kR2VzdHVyZVJlc2V0JywgZnVuY3Rpb24gZ2VzdHVyZUNsZWFyQ2FjaGUgKCkge1xuICAgICAgICBsYXN0UG9pbnRlciA9IHBvaW50ZXIgPSBudWxsO1xuICAgICAgfSk7XG5cbiAgICAvKlxuICAgICAqIFdoZW4gYSBET00gZXZlbnQgaGFwcGVucywgcnVuIGFsbCByZWdpc3RlcmVkIGdlc3R1cmUgaGFuZGxlcnMnIGxpZmVjeWNsZVxuICAgICAqIG1ldGhvZHMgd2hpY2ggbWF0Y2ggdGhlIERPTSBldmVudC5cbiAgICAgKiBFZyB3aGVuIGEgJ3RvdWNoc3RhcnQnIGV2ZW50IGhhcHBlbnMsIHJ1bkhhbmRsZXJzKCdzdGFydCcpIHdpbGwgY2FsbCBhbmRcbiAgICAgKiBydW4gYGhhbmRsZXIuY2FuY2VsKClgIGFuZCBgaGFuZGxlci5zdGFydCgpYCBvbiBhbGwgcmVnaXN0ZXJlZCBoYW5kbGVycy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBydW5IYW5kbGVycyhoYW5kbGVyRXZlbnQsIGV2ZW50KSB7XG4gICAgICB2YXIgaGFuZGxlcjtcbiAgICAgIGZvciAodmFyIG5hbWUgaW4gSEFORExFUlMpIHtcbiAgICAgICAgaGFuZGxlciA9IEhBTkRMRVJTW25hbWVdO1xuICAgICAgICBpZiggaGFuZGxlciBpbnN0YW5jZW9mICQkTWRHZXN0dXJlSGFuZGxlciApIHtcblxuICAgICAgICAgIGlmIChoYW5kbGVyRXZlbnQgPT09ICdzdGFydCcpIHtcbiAgICAgICAgICAgIC8vIFJ1biBjYW5jZWwgdG8gcmVzZXQgYW55IGhhbmRsZXJzJyBzdGF0ZVxuICAgICAgICAgICAgaGFuZGxlci5jYW5jZWwoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaGFuZGxlcltoYW5kbGVyRXZlbnRdKGV2ZW50LCBwb2ludGVyKTtcblxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBnZXN0dXJlU3RhcnQgdmV0cyBpZiBhIHN0YXJ0IGV2ZW50IGlzIGxlZ2l0aW1hdGUgKGFuZCBub3QgcGFydCBvZiBhICdnaG9zdCBjbGljaycgZnJvbSBpT1MvQW5kcm9pZClcbiAgICAgKiBJZiBpdCBpcyBsZWdpdGltYXRlLCB3ZSBpbml0aWF0ZSB0aGUgcG9pbnRlciBzdGF0ZSBhbmQgbWFyayB0aGUgY3VycmVudCBwb2ludGVyJ3MgdHlwZVxuICAgICAqIEZvciBleGFtcGxlLCBmb3IgYSB0b3VjaHN0YXJ0IGV2ZW50LCBtYXJrIHRoZSBjdXJyZW50IHBvaW50ZXIgYXMgYSAndG91Y2gnIHBvaW50ZXIsIHNvIG1vdXNlIGV2ZW50c1xuICAgICAqIHdvbid0IGVmZmVjdCBpdC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXN0dXJlU3RhcnQoZXYpIHtcbiAgICAgIC8vIElmIHdlJ3JlIGFscmVhZHkgdG91Y2hlZCBkb3duLCBhYm9ydFxuICAgICAgaWYgKHBvaW50ZXIpIHJldHVybjtcblxuICAgICAgdmFyIG5vdyA9ICtEYXRlLm5vdygpO1xuXG4gICAgICAvLyBpT1MgJiBvbGQgYW5kcm9pZCBidWc6IGFmdGVyIGEgdG91Y2ggZXZlbnQsIGEgY2xpY2sgZXZlbnQgaXMgc2VudCAzNTAgbXMgbGF0ZXIuXG4gICAgICAvLyBJZiA8NDAwbXMgaGF2ZSBwYXNzZWQsIGRvbid0IGFsbG93IGFuIGV2ZW50IG9mIGEgZGlmZmVyZW50IHR5cGUgdGhhbiB0aGUgcHJldmlvdXMgZXZlbnRcbiAgICAgIGlmIChsYXN0UG9pbnRlciAmJiAhdHlwZXNNYXRjaChldiwgbGFzdFBvaW50ZXIpICYmIChub3cgLSBsYXN0UG9pbnRlci5lbmRUaW1lIDwgMTUwMCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBwb2ludGVyID0gbWFrZVN0YXJ0UG9pbnRlcihldik7XG5cbiAgICAgIHJ1bkhhbmRsZXJzKCdzdGFydCcsIGV2KTtcbiAgICB9XG4gICAgLypcbiAgICAgKiBJZiBhIG1vdmUgZXZlbnQgaGFwcGVucyBvZiB0aGUgcmlnaHQgdHlwZSwgdXBkYXRlIHRoZSBwb2ludGVyIGFuZCBydW4gYWxsIHRoZSBtb3ZlIGhhbmRsZXJzLlxuICAgICAqIFwib2YgdGhlIHJpZ2h0IHR5cGVcIjogaWYgYSBtb3VzZW1vdmUgaGFwcGVucyBidXQgb3VyIHBvaW50ZXIgc3RhcnRlZCB3aXRoIGEgdG91Y2ggZXZlbnQsIGRvIG5vdGhpbmcuXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2VzdHVyZU1vdmUoZXYpIHtcbiAgICAgIGlmICghcG9pbnRlciB8fCAhdHlwZXNNYXRjaChldiwgcG9pbnRlcikpIHJldHVybjtcblxuICAgICAgdXBkYXRlUG9pbnRlclN0YXRlKGV2LCBwb2ludGVyKTtcbiAgICAgIHJ1bkhhbmRsZXJzKCdtb3ZlJywgZXYpO1xuICAgIH1cbiAgICAvKlxuICAgICAqIElmIGFuIGVuZCBldmVudCBoYXBwZW5zIG9mIHRoZSByaWdodCB0eXBlLCB1cGRhdGUgdGhlIHBvaW50ZXIsIHJ1biBlbmRIYW5kbGVycywgYW5kIHNhdmUgdGhlIHBvaW50ZXIgYXMgJ2xhc3RQb2ludGVyJ1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdlc3R1cmVFbmQoZXYpIHtcbiAgICAgIGlmICghcG9pbnRlciB8fCAhdHlwZXNNYXRjaChldiwgcG9pbnRlcikpIHJldHVybjtcblxuICAgICAgdXBkYXRlUG9pbnRlclN0YXRlKGV2LCBwb2ludGVyKTtcbiAgICAgIHBvaW50ZXIuZW5kVGltZSA9ICtEYXRlLm5vdygpO1xuXG4gICAgICBydW5IYW5kbGVycygnZW5kJywgZXYpO1xuXG4gICAgICBsYXN0UG9pbnRlciA9IHBvaW50ZXI7XG4gICAgICBwb2ludGVyID0gbnVsbDtcbiAgICB9XG5cbiAgfVxuICBhdHRhY2hUb0RvY3VtZW50LiRpbmplY3QgPSBbXCIkbWRHZXN0dXJlXCIsIFwiJCRNZEdlc3R1cmVIYW5kbGVyXCJdO1xuXG4gIC8vICoqKioqKioqKioqKioqKioqKioqXG4gIC8vIE1vZHVsZSBGdW5jdGlvbnNcbiAgLy8gKioqKioqKioqKioqKioqKioqKipcblxuICAvKlxuICAgKiBJbml0aWF0ZSB0aGUgcG9pbnRlci4geCwgeSwgYW5kIHRoZSBwb2ludGVyJ3MgdHlwZS5cbiAgICovXG4gIGZ1bmN0aW9uIG1ha2VTdGFydFBvaW50ZXIoZXYpIHtcbiAgICB2YXIgcG9pbnQgPSBnZXRFdmVudFBvaW50KGV2KTtcbiAgICB2YXIgc3RhcnRQb2ludGVyID0ge1xuICAgICAgc3RhcnRUaW1lOiArRGF0ZS5ub3coKSxcbiAgICAgIHRhcmdldDogZXYudGFyZ2V0LFxuICAgICAgLy8gJ3AnIGZvciBwb2ludGVyIGV2ZW50cywgJ20nIGZvciBtb3VzZSwgJ3QnIGZvciB0b3VjaFxuICAgICAgdHlwZTogZXYudHlwZS5jaGFyQXQoMClcbiAgICB9O1xuICAgIHN0YXJ0UG9pbnRlci5zdGFydFggPSBzdGFydFBvaW50ZXIueCA9IHBvaW50LnBhZ2VYO1xuICAgIHN0YXJ0UG9pbnRlci5zdGFydFkgPSBzdGFydFBvaW50ZXIueSA9IHBvaW50LnBhZ2VZO1xuICAgIHJldHVybiBzdGFydFBvaW50ZXI7XG4gIH1cblxuICAvKlxuICAgKiByZXR1cm4gd2hldGhlciB0aGUgcG9pbnRlcidzIHR5cGUgbWF0Y2hlcyB0aGUgZXZlbnQncyB0eXBlLlxuICAgKiBFZyBpZiBhIHRvdWNoIGV2ZW50IGhhcHBlbnMgYnV0IHRoZSBwb2ludGVyIGhhcyBhIG1vdXNlIHR5cGUsIHJldHVybiBmYWxzZS5cbiAgICovXG4gIGZ1bmN0aW9uIHR5cGVzTWF0Y2goZXYsIHBvaW50ZXIpIHtcbiAgICByZXR1cm4gZXYgJiYgcG9pbnRlciAmJiBldi50eXBlLmNoYXJBdCgwKSA9PT0gcG9pbnRlci50eXBlO1xuICB9XG5cbiAgLypcbiAgICogVXBkYXRlIHRoZSBnaXZlbiBwb2ludGVyIGJhc2VkIHVwb24gdGhlIGdpdmVuIERPTUV2ZW50LlxuICAgKiBEaXN0YW5jZSwgdmVsb2NpdHksIGRpcmVjdGlvbiwgZHVyYXRpb24sIGV0Y1xuICAgKi9cbiAgZnVuY3Rpb24gdXBkYXRlUG9pbnRlclN0YXRlKGV2LCBwb2ludGVyKSB7XG4gICAgdmFyIHBvaW50ID0gZ2V0RXZlbnRQb2ludChldik7XG4gICAgdmFyIHggPSBwb2ludGVyLnggPSBwb2ludC5wYWdlWDtcbiAgICB2YXIgeSA9IHBvaW50ZXIueSA9IHBvaW50LnBhZ2VZO1xuXG4gICAgcG9pbnRlci5kaXN0YW5jZVggPSB4IC0gcG9pbnRlci5zdGFydFg7XG4gICAgcG9pbnRlci5kaXN0YW5jZVkgPSB5IC0gcG9pbnRlci5zdGFydFk7XG4gICAgcG9pbnRlci5kaXN0YW5jZSA9IE1hdGguc3FydChcbiAgICAgIHBvaW50ZXIuZGlzdGFuY2VYICogcG9pbnRlci5kaXN0YW5jZVggKyBwb2ludGVyLmRpc3RhbmNlWSAqIHBvaW50ZXIuZGlzdGFuY2VZXG4gICAgKTtcblxuICAgIHBvaW50ZXIuZGlyZWN0aW9uWCA9IHBvaW50ZXIuZGlzdGFuY2VYID4gMCA/ICdyaWdodCcgOiBwb2ludGVyLmRpc3RhbmNlWCA8IDAgPyAnbGVmdCcgOiAnJztcbiAgICBwb2ludGVyLmRpcmVjdGlvblkgPSBwb2ludGVyLmRpc3RhbmNlWSA+IDAgPyAndXAnIDogcG9pbnRlci5kaXN0YW5jZVkgPCAwID8gJ2Rvd24nIDogJyc7XG5cbiAgICBwb2ludGVyLmR1cmF0aW9uID0gK0RhdGUubm93KCkgLSBwb2ludGVyLnN0YXJ0VGltZTtcbiAgICBwb2ludGVyLnZlbG9jaXR5WCA9IHBvaW50ZXIuZGlzdGFuY2VYIC8gcG9pbnRlci5kdXJhdGlvbjtcbiAgICBwb2ludGVyLnZlbG9jaXR5WSA9IHBvaW50ZXIuZGlzdGFuY2VZIC8gcG9pbnRlci5kdXJhdGlvbjtcbiAgfVxuXG4gIC8qXG4gICAqIE5vcm1hbGl6ZSB0aGUgcG9pbnQgd2hlcmUgdGhlIERPTSBldmVudCBoYXBwZW5lZCB3aGV0aGVyIGl0J3MgdG91Y2ggb3IgbW91c2UuXG4gICAqIEByZXR1cm5zIHBvaW50IGV2ZW50IG9iaiB3aXRoIHBhZ2VYIGFuZCBwYWdlWSBvbiBpdC5cbiAgICovXG4gIGZ1bmN0aW9uIGdldEV2ZW50UG9pbnQoZXYpIHtcbiAgICBldiA9IGV2Lm9yaWdpbmFsRXZlbnQgfHwgZXY7IC8vIHN1cHBvcnQgalF1ZXJ5IGV2ZW50c1xuICAgIHJldHVybiAoZXYudG91Y2hlcyAmJiBldi50b3VjaGVzWzBdKSB8fFxuICAgICAgKGV2LmNoYW5nZWRUb3VjaGVzICYmIGV2LmNoYW5nZWRUb3VjaGVzWzBdKSB8fFxuICAgICAgZXY7XG4gIH1cblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb3JlJylcbiAgLnByb3ZpZGVyKCckJGludGVyaW1FbGVtZW50JywgSW50ZXJpbUVsZW1lbnRQcm92aWRlcik7XG5cbi8qXG4gKiBAbmdkb2Mgc2VydmljZVxuICogQG5hbWUgJCRpbnRlcmltRWxlbWVudFxuICogQG1vZHVsZSBtYXRlcmlhbC5jb3JlXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKlxuICogRmFjdG9yeSB0aGF0IGNvbnRydWN0cyBgJCRpbnRlcmltRWxlbWVudC4kc2VydmljZWAgc2VydmljZXMuXG4gKiBVc2VkIGludGVybmFsbHkgaW4gbWF0ZXJpYWwgZGVzaWduIGZvciBlbGVtZW50cyB0aGF0IGFwcGVhciBvbiBzY3JlZW4gdGVtcG9yYXJpbHkuXG4gKiBUaGUgc2VydmljZSBwcm92aWRlcyBhIHByb21pc2UtbGlrZSBBUEkgZm9yIGludGVyYWN0aW5nIHdpdGggdGhlIHRlbXBvcmFyeVxuICogZWxlbWVudHMuXG4gKlxuICogYGBganNcbiAqIGFwcC5zZXJ2aWNlKCckbWRUb2FzdCcsIGZ1bmN0aW9uKCQkaW50ZXJpbUVsZW1lbnQpIHtcbiAqICAgdmFyICRtZFRvYXN0ID0gJCRpbnRlcmltRWxlbWVudCh0b2FzdERlZmF1bHRPcHRpb25zKTtcbiAqICAgcmV0dXJuICRtZFRvYXN0O1xuICogfSk7XG4gKiBgYGBcbiAqIEBwYXJhbSB7b2JqZWN0PX0gZGVmYXVsdE9wdGlvbnMgT3B0aW9ucyB1c2VkIGJ5IGRlZmF1bHQgZm9yIHRoZSBgc2hvd2AgbWV0aG9kIG9uIHRoZSBzZXJ2aWNlLlxuICpcbiAqIEByZXR1cm5zIHskJGludGVyaW1FbGVtZW50LiRzZXJ2aWNlfVxuICpcbiAqL1xuXG5mdW5jdGlvbiBJbnRlcmltRWxlbWVudFByb3ZpZGVyKCkge1xuICBjcmVhdGVJbnRlcmltRWxlbWVudFByb3ZpZGVyLiRnZXQgPSBJbnRlcmltRWxlbWVudEZhY3Rvcnk7XG4gIEludGVyaW1FbGVtZW50RmFjdG9yeS4kaW5qZWN0ID0gW1wiJGRvY3VtZW50XCIsIFwiJHFcIiwgXCIkcm9vdFNjb3BlXCIsIFwiJHRpbWVvdXRcIiwgXCIkcm9vdEVsZW1lbnRcIiwgXCIkYW5pbWF0ZVwiLCBcIiRpbnRlcnBvbGF0ZVwiLCBcIiRtZENvbXBpbGVyXCIsIFwiJG1kVGhlbWluZ1wiXTtcbiAgcmV0dXJuIGNyZWF0ZUludGVyaW1FbGVtZW50UHJvdmlkZXI7XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBuZXcgcHJvdmlkZXIgd2hpY2ggYWxsb3dzIGNvbmZpZ3VyYXRpb24gb2YgYSBuZXcgaW50ZXJpbUVsZW1lbnRcbiAgICogc2VydmljZS4gQWxsb3dzIGNvbmZpZ3VyYXRpb24gb2YgZGVmYXVsdCBvcHRpb25zICYgbWV0aG9kcyBmb3Igb3B0aW9ucyxcbiAgICogYXMgd2VsbCBhcyBjb25maWd1cmF0aW9uIG9mICdwcmVzZXQnIG1ldGhvZHMgKGVnIGRpYWxvZy5iYXNpYygpOiBiYXNpYyBpcyBhIHByZXNldCBtZXRob2QpXG4gICAqL1xuICBmdW5jdGlvbiBjcmVhdGVJbnRlcmltRWxlbWVudFByb3ZpZGVyKGludGVyaW1GYWN0b3J5TmFtZSkge1xuICAgIHZhciBFWFBPU0VEX01FVEhPRFMgPSBbJ29uSGlkZScsICdvblNob3cnLCAnb25SZW1vdmUnXTtcblxuICAgIHZhciBjdXN0b21NZXRob2RzID0ge307XG4gICAgdmFyIHByb3ZpZGVyQ29uZmlnID0ge1xuICAgICAgcHJlc2V0czoge31cbiAgICB9O1xuXG4gICAgdmFyIHByb3ZpZGVyID0ge1xuICAgICAgc2V0RGVmYXVsdHM6IHNldERlZmF1bHRzLFxuICAgICAgYWRkUHJlc2V0OiBhZGRQcmVzZXQsXG4gICAgICBhZGRNZXRob2Q6IGFkZE1ldGhvZCxcbiAgICAgICRnZXQ6IGZhY3RvcnlcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogYWxsIGludGVyaW0gZWxlbWVudHMgd2lsbCBjb21lIHdpdGggdGhlICdidWlsZCcgcHJlc2V0XG4gICAgICovXG4gICAgcHJvdmlkZXIuYWRkUHJlc2V0KCdidWlsZCcsIHtcbiAgICAgIG1ldGhvZHM6IFsnY29udHJvbGxlcicsICdjb250cm9sbGVyQXMnLCAncmVzb2x2ZScsXG4gICAgICAgICd0ZW1wbGF0ZScsICd0ZW1wbGF0ZVVybCcsICd0aGVtYWJsZScsICd0cmFuc2Zvcm1UZW1wbGF0ZScsICdwYXJlbnQnXVxuICAgIH0pO1xuXG4gICAgZmFjdG9yeS4kaW5qZWN0ID0gW1wiJCRpbnRlcmltRWxlbWVudFwiLCBcIiRhbmltYXRlXCIsIFwiJGluamVjdG9yXCJdO1xuICAgIHJldHVybiBwcm92aWRlcjtcblxuICAgIC8qKlxuICAgICAqIFNhdmUgdGhlIGNvbmZpZ3VyZWQgZGVmYXVsdHMgdG8gYmUgdXNlZCB3aGVuIHRoZSBmYWN0b3J5IGlzIGluc3RhbnRpYXRlZFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHNldERlZmF1bHRzKGRlZmluaXRpb24pIHtcbiAgICAgIHByb3ZpZGVyQ29uZmlnLm9wdGlvbnNGYWN0b3J5ID0gZGVmaW5pdGlvbi5vcHRpb25zO1xuICAgICAgcHJvdmlkZXJDb25maWcubWV0aG9kcyA9IChkZWZpbml0aW9uLm1ldGhvZHMgfHwgW10pLmNvbmNhdChFWFBPU0VEX01FVEhPRFMpO1xuICAgICAgcmV0dXJuIHByb3ZpZGVyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBhIG1ldGhvZCB0byB0aGUgZmFjdG9yeSB0aGF0IGlzbid0IHNwZWNpZmljIHRvIGFueSBpbnRlcmltIGVsZW1lbnQgb3BlcmF0aW9uc1xuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gYWRkTWV0aG9kKG5hbWUsIGZuKSB7XG4gICAgICBjdXN0b21NZXRob2RzW25hbWVdID0gZm47XG4gICAgICByZXR1cm4gcHJvdmlkZXI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2F2ZSB0aGUgY29uZmlndXJlZCBwcmVzZXQgdG8gYmUgdXNlZCB3aGVuIHRoZSBmYWN0b3J5IGlzIGluc3RhbnRpYXRlZFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFkZFByZXNldChuYW1lLCBkZWZpbml0aW9uKSB7XG4gICAgICBkZWZpbml0aW9uID0gZGVmaW5pdGlvbiB8fCB7fTtcbiAgICAgIGRlZmluaXRpb24ubWV0aG9kcyA9IGRlZmluaXRpb24ubWV0aG9kcyB8fCBbXTtcbiAgICAgIGRlZmluaXRpb24ub3B0aW9ucyA9IGRlZmluaXRpb24ub3B0aW9ucyB8fCBmdW5jdGlvbigpIHsgcmV0dXJuIHt9OyB9O1xuXG4gICAgICBpZiAoL15jYW5jZWx8aGlkZXxzaG93JC8udGVzdChuYW1lKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQcmVzZXQgJ1wiICsgbmFtZSArIFwiJyBpbiBcIiArIGludGVyaW1GYWN0b3J5TmFtZSArIFwiIGlzIHJlc2VydmVkIVwiKTtcbiAgICAgIH1cbiAgICAgIGlmIChkZWZpbml0aW9uLm1ldGhvZHMuaW5kZXhPZignX29wdGlvbnMnKSA+IC0xKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk1ldGhvZCAnX29wdGlvbnMnIGluIFwiICsgaW50ZXJpbUZhY3RvcnlOYW1lICsgXCIgaXMgcmVzZXJ2ZWQhXCIpO1xuICAgICAgfVxuICAgICAgcHJvdmlkZXJDb25maWcucHJlc2V0c1tuYW1lXSA9IHtcbiAgICAgICAgbWV0aG9kczogZGVmaW5pdGlvbi5tZXRob2RzLmNvbmNhdChFWFBPU0VEX01FVEhPRFMpLFxuICAgICAgICBvcHRpb25zRmFjdG9yeTogZGVmaW5pdGlvbi5vcHRpb25zLFxuICAgICAgICBhcmdPcHRpb246IGRlZmluaXRpb24uYXJnT3B0aW9uXG4gICAgICB9O1xuICAgICAgcmV0dXJuIHByb3ZpZGVyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIGZhY3RvcnkgdGhhdCBoYXMgdGhlIGdpdmVuIG1ldGhvZHMgJiBkZWZhdWx0cyBpbXBsZW1lbnRpbmcgaW50ZXJpbUVsZW1lbnRcbiAgICAgKi9cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBmYWN0b3J5KCQkaW50ZXJpbUVsZW1lbnQsICRhbmltYXRlLCAkaW5qZWN0b3IpIHtcbiAgICAgIHZhciBkZWZhdWx0TWV0aG9kcztcbiAgICAgIHZhciBkZWZhdWx0T3B0aW9ucztcbiAgICAgIHZhciBpbnRlcmltRWxlbWVudFNlcnZpY2UgPSAkJGludGVyaW1FbGVtZW50KCk7XG5cbiAgICAgIC8qXG4gICAgICAgKiBwdWJsaWNTZXJ2aWNlIGlzIHdoYXQgdGhlIGRldmVsb3BlciB3aWxsIGJlIHVzaW5nLlxuICAgICAgICogSXQgaGFzIG1ldGhvZHMgaGlkZSgpLCBjYW5jZWwoKSwgc2hvdygpLCBidWlsZCgpLCBhbmQgYW55IG90aGVyXG4gICAgICAgKiBwcmVzZXRzIHdoaWNoIHdlcmUgc2V0IGR1cmluZyB0aGUgY29uZmlnIHBoYXNlLlxuICAgICAgICovXG4gICAgICB2YXIgcHVibGljU2VydmljZSA9IHtcbiAgICAgICAgaGlkZTogaW50ZXJpbUVsZW1lbnRTZXJ2aWNlLmhpZGUsXG4gICAgICAgIGNhbmNlbDogaW50ZXJpbUVsZW1lbnRTZXJ2aWNlLmNhbmNlbCxcbiAgICAgICAgc2hvdzogc2hvd0ludGVyaW1FbGVtZW50XG4gICAgICB9O1xuXG4gICAgICBkZWZhdWx0TWV0aG9kcyA9IHByb3ZpZGVyQ29uZmlnLm1ldGhvZHMgfHwgW107XG4gICAgICAvLyBUaGlzIG11c3QgYmUgaW52b2tlZCBhZnRlciB0aGUgcHVibGljU2VydmljZSBpcyBpbml0aWFsaXplZFxuICAgICAgZGVmYXVsdE9wdGlvbnMgPSBpbnZva2VGYWN0b3J5KHByb3ZpZGVyQ29uZmlnLm9wdGlvbnNGYWN0b3J5LCB7fSk7XG5cbiAgICAgIC8vIENvcHkgb3ZlciB0aGUgc2ltcGxlIGN1c3RvbSBtZXRob2RzXG4gICAgICBhbmd1bGFyLmZvckVhY2goY3VzdG9tTWV0aG9kcywgZnVuY3Rpb24oZm4sIG5hbWUpIHtcbiAgICAgICAgcHVibGljU2VydmljZVtuYW1lXSA9IGZuO1xuICAgICAgfSk7XG5cbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChwcm92aWRlckNvbmZpZy5wcmVzZXRzLCBmdW5jdGlvbihkZWZpbml0aW9uLCBuYW1lKSB7XG4gICAgICAgIHZhciBwcmVzZXREZWZhdWx0cyA9IGludm9rZUZhY3RvcnkoZGVmaW5pdGlvbi5vcHRpb25zRmFjdG9yeSwge30pO1xuICAgICAgICB2YXIgcHJlc2V0TWV0aG9kcyA9IChkZWZpbml0aW9uLm1ldGhvZHMgfHwgW10pLmNvbmNhdChkZWZhdWx0TWV0aG9kcyk7XG5cbiAgICAgICAgLy8gRXZlcnkgaW50ZXJpbUVsZW1lbnQgYnVpbHQgd2l0aCBhIHByZXNldCBoYXMgYSBmaWVsZCBjYWxsZWQgYCR0eXBlYCxcbiAgICAgICAgLy8gd2hpY2ggbWF0Y2hlcyB0aGUgbmFtZSBvZiB0aGUgcHJlc2V0LlxuICAgICAgICAvLyBFZyBpbiBwcmVzZXQgJ2NvbmZpcm0nLCBvcHRpb25zLiR0eXBlID09PSAnY29uZmlybSdcbiAgICAgICAgYW5ndWxhci5leHRlbmQocHJlc2V0RGVmYXVsdHMsIHsgJHR5cGU6IG5hbWUgfSk7XG5cbiAgICAgICAgLy8gVGhpcyBjcmVhdGVzIGEgcHJlc2V0IGNsYXNzIHdoaWNoIGhhcyBzZXR0ZXIgbWV0aG9kcyBmb3IgZXZlcnlcbiAgICAgICAgLy8gbWV0aG9kIGdpdmVuIGluIHRoZSBgLmFkZFByZXNldCgpYCBmdW5jdGlvbiwgYXMgd2VsbCBhcyBldmVyeVxuICAgICAgICAvLyBtZXRob2QgZ2l2ZW4gaW4gdGhlIGAuc2V0RGVmYXVsdHMoKWAgZnVuY3Rpb24uXG4gICAgICAgIC8vXG4gICAgICAgIC8vIEBleGFtcGxlXG4gICAgICAgIC8vIC5zZXREZWZhdWx0cyh7XG4gICAgICAgIC8vICAgbWV0aG9kczogWydoYXNCYWNrZHJvcCcsICdjbGlja091dHNpZGVUb0Nsb3NlJywgJ2VzY2FwZVRvQ2xvc2UnLCAndGFyZ2V0RXZlbnQnXSxcbiAgICAgICAgLy8gICBvcHRpb25zOiBkaWFsb2dEZWZhdWx0T3B0aW9uc1xuICAgICAgICAvLyB9KVxuICAgICAgICAvLyAuYWRkUHJlc2V0KCdhbGVydCcsIHtcbiAgICAgICAgLy8gICBtZXRob2RzOiBbJ3RpdGxlJywgJ29rJ10sXG4gICAgICAgIC8vICAgb3B0aW9uczogYWxlcnREaWFsb2dPcHRpb25zXG4gICAgICAgIC8vIH0pXG4gICAgICAgIC8vXG4gICAgICAgIC8vIFNldCB2YWx1ZXMgd2lsbCBiZSBwYXNzZWQgdG8gdGhlIG9wdGlvbnMgd2hlbiBpbnRlcmltRWxlbW50LnNob3coKSBpcyBjYWxsZWQuXG4gICAgICAgIGZ1bmN0aW9uIFByZXNldChvcHRzKSB7XG4gICAgICAgICAgdGhpcy5fb3B0aW9ucyA9IGFuZ3VsYXIuZXh0ZW5kKHt9LCBwcmVzZXREZWZhdWx0cywgb3B0cyk7XG4gICAgICAgIH1cbiAgICAgICAgYW5ndWxhci5mb3JFYWNoKHByZXNldE1ldGhvZHMsIGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgICAgICBQcmVzZXQucHJvdG90eXBlW25hbWVdID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX29wdGlvbnNbbmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIENyZWF0ZSBzaG9ydGN1dCBtZXRob2QgZm9yIG9uZS1saW5lYXIgbWV0aG9kc1xuICAgICAgICBpZiAoZGVmaW5pdGlvbi5hcmdPcHRpb24pIHtcbiAgICAgICAgICB2YXIgbWV0aG9kTmFtZSA9ICdzaG93JyArIG5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnNsaWNlKDEpO1xuICAgICAgICAgIHB1YmxpY1NlcnZpY2VbbWV0aG9kTmFtZV0gPSBmdW5jdGlvbihhcmcpIHtcbiAgICAgICAgICAgIHZhciBjb25maWcgPSBwdWJsaWNTZXJ2aWNlW25hbWVdKGFyZyk7XG4gICAgICAgICAgICByZXR1cm4gcHVibGljU2VydmljZS5zaG93KGNvbmZpZyk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGVnICRtZERpYWxvZy5hbGVydCgpIHdpbGwgcmV0dXJuIGEgbmV3IGFsZXJ0IHByZXNldFxuICAgICAgICBwdWJsaWNTZXJ2aWNlW25hbWVdID0gZnVuY3Rpb24oYXJnKSB7XG4gICAgICAgICAgLy8gSWYgYXJnT3B0aW9uIGlzIHN1cHBsaWVkLCBlZyBgYXJnT3B0aW9uOiAnY29udGVudCdgLCB0aGVuIHdlIGFzc3VtZVxuICAgICAgICAgIC8vIGlmIHRoZSBhcmd1bWVudCBpcyBub3QgYW4gb3B0aW9ucyBvYmplY3QgdGhlbiBpdCBpcyB0aGUgYGFyZ09wdGlvbmAgb3B0aW9uLlxuICAgICAgICAgIC8vXG4gICAgICAgICAgLy8gQGV4YW1wbGUgYCRtZFRvYXN0LnNpbXBsZSgnaGVsbG8nKWAgLy8gc2V0cyBvcHRpb25zLmNvbnRlbnQgdG8gaGVsbG9cbiAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBiZWNhdXNlIGFyZ09wdGlvbiA9PT0gJ2NvbnRlbnQnXG4gICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggJiYgZGVmaW5pdGlvbi5hcmdPcHRpb24gJiYgIWFuZ3VsYXIuaXNPYmplY3QoYXJnKSAmJlxuICAgICAgICAgICAgICAhYW5ndWxhci5pc0FycmF5KGFyZykpIHtcbiAgICAgICAgICAgIHJldHVybiAobmV3IFByZXNldCgpKVtkZWZpbml0aW9uLmFyZ09wdGlvbl0oYXJnKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcmVzZXQoYXJnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgfTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gcHVibGljU2VydmljZTtcblxuICAgICAgZnVuY3Rpb24gc2hvd0ludGVyaW1FbGVtZW50KG9wdHMpIHtcbiAgICAgICAgLy8gb3B0cyBpcyBlaXRoZXIgYSBwcmVzZXQgd2hpY2ggc3RvcmVzIGl0cyBvcHRpb25zIG9uIGFuIF9vcHRpb25zIGZpZWxkLFxuICAgICAgICAvLyBvciBqdXN0IGFuIG9iamVjdCBtYWRlIHVwIG9mIG9wdGlvbnNcbiAgICAgICAgaWYgKG9wdHMgJiYgb3B0cy5fb3B0aW9ucykgb3B0cyA9IG9wdHMuX29wdGlvbnM7XG4gICAgICAgIHJldHVybiBpbnRlcmltRWxlbWVudFNlcnZpY2Uuc2hvdyhcbiAgICAgICAgICBhbmd1bGFyLmV4dGVuZCh7fSwgZGVmYXVsdE9wdGlvbnMsIG9wdHMpXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIC8qKlxuICAgICAgICogSGVscGVyIHRvIGNhbGwgJGluamVjdG9yLmludm9rZSB3aXRoIGEgbG9jYWwgb2YgdGhlIGZhY3RvcnkgbmFtZSBmb3JcbiAgICAgICAqIHRoaXMgcHJvdmlkZXIuXG4gICAgICAgKiBJZiBhbiAkbWREaWFsb2cgaXMgcHJvdmlkaW5nIG9wdGlvbnMgZm9yIGEgZGlhbG9nIGFuZCB0cmllcyB0byBpbmplY3RcbiAgICAgICAqICRtZERpYWxvZywgYSBjaXJjdWxhciBkZXBlbmRlbmN5IGVycm9yIHdpbGwgaGFwcGVuLlxuICAgICAgICogV2UgZ2V0IGFyb3VuZCB0aGF0IGJ5IG1hbnVhbGx5IGluamVjdGluZyAkbWREaWFsb2cgYXMgYSBsb2NhbC5cbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gaW52b2tlRmFjdG9yeShmYWN0b3J5LCBkZWZhdWx0VmFsKSB7XG4gICAgICAgIHZhciBsb2NhbHMgPSB7fTtcbiAgICAgICAgbG9jYWxzW2ludGVyaW1GYWN0b3J5TmFtZV0gPSBwdWJsaWNTZXJ2aWNlO1xuICAgICAgICByZXR1cm4gJGluamVjdG9yLmludm9rZShmYWN0b3J5IHx8IGZ1bmN0aW9uKCkgeyByZXR1cm4gZGVmYXVsdFZhbDsgfSwge30sIGxvY2Fscyk7XG4gICAgICB9XG5cbiAgICB9XG5cbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBJbnRlcmltRWxlbWVudEZhY3RvcnkoJGRvY3VtZW50LCAkcSwgJHJvb3RTY29wZSwgJHRpbWVvdXQsICRyb290RWxlbWVudCwgJGFuaW1hdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaW50ZXJwb2xhdGUsICRtZENvbXBpbGVyLCAkbWRUaGVtaW5nICkge1xuICAgIHZhciBzdGFydFN5bWJvbCA9ICRpbnRlcnBvbGF0ZS5zdGFydFN5bWJvbCgpLFxuICAgICAgICBlbmRTeW1ib2wgPSAkaW50ZXJwb2xhdGUuZW5kU3ltYm9sKCksXG4gICAgICAgIHVzZXNTdGFuZGFyZFN5bWJvbHMgPSAoKHN0YXJ0U3ltYm9sID09PSAne3snKSAmJiAoZW5kU3ltYm9sID09PSAnfX0nKSksXG4gICAgICAgIHByb2Nlc3NUZW1wbGF0ZSAgPSB1c2VzU3RhbmRhcmRTeW1ib2xzID8gYW5ndWxhci5pZGVudGl0eSA6IHJlcGxhY2VJbnRlcnBvbGF0aW9uU3ltYm9scztcblxuICAgIHJldHVybiBmdW5jdGlvbiBjcmVhdGVJbnRlcmltRWxlbWVudFNlcnZpY2UoKSB7XG4gICAgICAvKlxuICAgICAgICogQG5nZG9jIHNlcnZpY2VcbiAgICAgICAqIEBuYW1lICQkaW50ZXJpbUVsZW1lbnQuJHNlcnZpY2VcbiAgICAgICAqXG4gICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAqIEEgc2VydmljZSB1c2VkIHRvIGNvbnRyb2wgaW5zZXJ0aW5nIGFuZCByZW1vdmluZyBhbiBlbGVtZW50IGludG8gdGhlIERPTS5cbiAgICAgICAqXG4gICAgICAgKi9cbiAgICAgIHZhciBzdGFjayA9IFtdO1xuICAgICAgdmFyIHNlcnZpY2U7XG4gICAgICByZXR1cm4gc2VydmljZSA9IHtcbiAgICAgICAgc2hvdzogc2hvdyxcbiAgICAgICAgaGlkZTogaGlkZSxcbiAgICAgICAgY2FuY2VsOiBjYW5jZWxcbiAgICAgIH07XG5cbiAgICAgIC8qXG4gICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgKiBAbmFtZSAkJGludGVyaW1FbGVtZW50LiRzZXJ2aWNlI3Nob3dcbiAgICAgICAqIEBraW5kIGZ1bmN0aW9uXG4gICAgICAgKlxuICAgICAgICogQGRlc2NyaXB0aW9uXG4gICAgICAgKiBBZGRzIHRoZSBgJGludGVyaW1FbGVtZW50YCB0byB0aGUgRE9NIGFuZCByZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHdpbGwgYmUgcmVzb2x2ZWQgb3IgcmVqZWN0ZWRcbiAgICAgICAqIHdpdGggaGlkZSBvciBjYW5jZWwsIHJlc3BlY3RpdmVseS5cbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0geyp9IG9wdGlvbnMgaXMgaGFzaE1hcCBvZiBzZXR0aW5nc1xuICAgICAgICogQHJldHVybnMgYSBQcm9taXNlXG4gICAgICAgKlxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBzaG93KG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKHN0YWNrLmxlbmd0aCkge1xuICAgICAgICAgIHJldHVybiBzZXJ2aWNlLmNhbmNlbCgpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gc2hvdyhvcHRpb25zKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgaW50ZXJpbUVsZW1lbnQgPSBuZXcgSW50ZXJpbUVsZW1lbnQob3B0aW9ucyk7XG4gICAgICAgICAgc3RhY2sucHVzaChpbnRlcmltRWxlbWVudCk7XG4gICAgICAgICAgcmV0dXJuIGludGVyaW1FbGVtZW50LnNob3coKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIGludGVyaW1FbGVtZW50LmRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLypcbiAgICAgICAqIEBuZ2RvYyBtZXRob2RcbiAgICAgICAqIEBuYW1lICQkaW50ZXJpbUVsZW1lbnQuJHNlcnZpY2UjaGlkZVxuICAgICAgICogQGtpbmQgZnVuY3Rpb25cbiAgICAgICAqXG4gICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAqIFJlbW92ZXMgdGhlIGAkaW50ZXJpbUVsZW1lbnRgIGZyb20gdGhlIERPTSBhbmQgcmVzb2x2ZXMgdGhlIHByb21pc2UgcmV0dXJuZWQgZnJvbSBgc2hvd2BcbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0geyp9IHJlc29sdmVQYXJhbSBEYXRhIHRvIHJlc29sdmUgdGhlIHByb21pc2Ugd2l0aFxuICAgICAgICogQHJldHVybnMgYSBQcm9taXNlIHRoYXQgd2lsbCBiZSByZXNvbHZlZCBhZnRlciB0aGUgZWxlbWVudCBoYXMgYmVlbiByZW1vdmVkLlxuICAgICAgICpcbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gaGlkZShyZXNwb25zZSkge1xuICAgICAgICB2YXIgaW50ZXJpbUVsZW1lbnQgPSBzdGFjay5zaGlmdCgpO1xuICAgICAgICByZXR1cm4gaW50ZXJpbUVsZW1lbnQgJiYgaW50ZXJpbUVsZW1lbnQucmVtb3ZlKCkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICBpbnRlcmltRWxlbWVudC5kZWZlcnJlZC5yZXNvbHZlKHJlc3BvbnNlKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8qXG4gICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgKiBAbmFtZSAkJGludGVyaW1FbGVtZW50LiRzZXJ2aWNlI2NhbmNlbFxuICAgICAgICogQGtpbmQgZnVuY3Rpb25cbiAgICAgICAqXG4gICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAqIFJlbW92ZXMgdGhlIGAkaW50ZXJpbUVsZW1lbnRgIGZyb20gdGhlIERPTSBhbmQgcmVqZWN0cyB0aGUgcHJvbWlzZSByZXR1cm5lZCBmcm9tIGBzaG93YFxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7Kn0gcmVhc29uIERhdGEgdG8gcmVqZWN0IHRoZSBwcm9taXNlIHdpdGhcbiAgICAgICAqIEByZXR1cm5zIFByb21pc2UgdGhhdCB3aWxsIGJlIHJlc29sdmVkIGFmdGVyIHRoZSBlbGVtZW50IGhhcyBiZWVuIHJlbW92ZWQuXG4gICAgICAgKlxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBjYW5jZWwocmVhc29uKSB7XG4gICAgICAgIHZhciBpbnRlcmltRWxlbWVudCA9IHN0YWNrLnNoaWZ0KCk7XG4gICAgICAgIHJldHVybiAkcS53aGVuKGludGVyaW1FbGVtZW50ICYmIGludGVyaW1FbGVtZW50LnJlbW92ZSgpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaW50ZXJpbUVsZW1lbnQuZGVmZXJyZWQucmVqZWN0KHJlYXNvbik7XG4gICAgICAgIH0pKTtcbiAgICAgIH1cblxuXG4gICAgICAvKlxuICAgICAgICogSW50ZXJuYWwgSW50ZXJpbSBFbGVtZW50IE9iamVjdFxuICAgICAgICogVXNlZCBpbnRlcm5hbGx5IHRvIG1hbmFnZSB0aGUgRE9NIGVsZW1lbnQgYW5kIHJlbGF0ZWQgZGF0YVxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBJbnRlcmltRWxlbWVudChvcHRpb25zKSB7XG4gICAgICAgIHZhciBzZWxmO1xuICAgICAgICB2YXIgaGlkZVRpbWVvdXQsIGVsZW1lbnQsIHNob3dEb25lLCByZW1vdmVEb25lO1xuXG4gICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgICBvcHRpb25zID0gYW5ndWxhci5leHRlbmQoe1xuICAgICAgICAgIHByZXNlcnZlU2NvcGU6IGZhbHNlLFxuICAgICAgICAgIHNjb3BlOiBvcHRpb25zLnNjb3BlIHx8ICRyb290U2NvcGUuJG5ldyhvcHRpb25zLmlzb2xhdGVTY29wZSksXG4gICAgICAgICAgb25TaG93OiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgb3B0aW9ucykge1xuICAgICAgICAgICAgcmV0dXJuICRhbmltYXRlLmVudGVyKGVsZW1lbnQsIG9wdGlvbnMucGFyZW50KTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIG9uUmVtb3ZlOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgb3B0aW9ucykge1xuICAgICAgICAgICAgLy8gRWxlbWVudCBjb3VsZCBiZSB1bmRlZmluZWQgaWYgYSBuZXcgZWxlbWVudCBpcyBzaG93biBiZWZvcmVcbiAgICAgICAgICAgIC8vIHRoZSBvbGQgb25lIGZpbmlzaGVzIGNvbXBpbGluZy5cbiAgICAgICAgICAgIHJldHVybiBlbGVtZW50ICYmICRhbmltYXRlLmxlYXZlKGVsZW1lbnQpIHx8ICRxLndoZW4oKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIG9wdGlvbnMpO1xuXG4gICAgICAgIGlmIChvcHRpb25zLnRlbXBsYXRlKSB7XG4gICAgICAgICAgb3B0aW9ucy50ZW1wbGF0ZSA9IHByb2Nlc3NUZW1wbGF0ZShvcHRpb25zLnRlbXBsYXRlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzZWxmID0ge1xuICAgICAgICAgIG9wdGlvbnM6IG9wdGlvbnMsXG4gICAgICAgICAgZGVmZXJyZWQ6ICRxLmRlZmVyKCksXG4gICAgICAgICAgc2hvdzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgY29tcGlsZVByb21pc2U7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5za2lwQ29tcGlsZSkge1xuICAgICAgICAgICAgICBjb21waWxlUHJvbWlzZSA9ICRxKGZ1bmN0aW9uKHJlc29sdmUpIHsgXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh7XG4gICAgICAgICAgICAgICAgICBsb2NhbHM6IHt9LFxuICAgICAgICAgICAgICAgICAgbGluazogZnVuY3Rpb24oKSB7IHJldHVybiBvcHRpb25zLmVsZW1lbnQ7IH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBjb21waWxlUHJvbWlzZSA9ICRtZENvbXBpbGVyLmNvbXBpbGUob3B0aW9ucyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBzaG93RG9uZSA9IGNvbXBpbGVQcm9taXNlLnRoZW4oZnVuY3Rpb24oY29tcGlsZURhdGEpIHtcbiAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoY29tcGlsZURhdGEubG9jYWxzLCBzZWxmLm9wdGlvbnMpO1xuXG4gICAgICAgICAgICAgIGVsZW1lbnQgPSBjb21waWxlRGF0YS5saW5rKG9wdGlvbnMuc2NvcGUpO1xuXG4gICAgICAgICAgICAgIC8vIFNlYXJjaCBmb3IgcGFyZW50IGF0IGluc2VydGlvbiB0aW1lLCBpZiBub3Qgc3BlY2lmaWVkXG4gICAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzRnVuY3Rpb24ob3B0aW9ucy5wYXJlbnQpKSB7XG4gICAgICAgICAgICAgICAgb3B0aW9ucy5wYXJlbnQgPSBvcHRpb25zLnBhcmVudChvcHRpb25zLnNjb3BlLCBlbGVtZW50LCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChhbmd1bGFyLmlzU3RyaW5nKG9wdGlvbnMucGFyZW50KSkge1xuICAgICAgICAgICAgICAgIG9wdGlvbnMucGFyZW50ID0gYW5ndWxhci5lbGVtZW50KCRkb2N1bWVudFswXS5xdWVyeVNlbGVjdG9yKG9wdGlvbnMucGFyZW50KSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAvLyBJZiBwYXJlbnQgcXVlcnlTZWxlY3Rvci9nZXR0ZXIgZnVuY3Rpb24gZmFpbHMsIG9yIGl0J3MganVzdCBudWxsLFxuICAgICAgICAgICAgICAvLyBmaW5kIGEgZGVmYXVsdC5cbiAgICAgICAgICAgICAgaWYgKCEob3B0aW9ucy5wYXJlbnQgfHwge30pLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHZhciBlbDtcbiAgICAgICAgICAgICAgICBpZiAoJHJvb3RFbGVtZW50WzBdICYmICRyb290RWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKSB7XG4gICAgICAgICAgICAgICAgICBlbCA9ICRyb290RWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCc6bm90KHN2ZykgPiBib2R5Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghZWwpIGVsID0gJHJvb3RFbGVtZW50WzBdO1xuICAgICAgICAgICAgICAgIGlmIChlbC5ub2RlTmFtZSA9PSAnI2NvbW1lbnQnKSB7XG4gICAgICAgICAgICAgICAgICBlbCA9ICRkb2N1bWVudFswXS5ib2R5O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvcHRpb25zLnBhcmVudCA9IGFuZ3VsYXIuZWxlbWVudChlbCk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAob3B0aW9ucy50aGVtYWJsZSkgJG1kVGhlbWluZyhlbGVtZW50KTtcbiAgICAgICAgICAgICAgdmFyIHJldCA9IG9wdGlvbnMub25TaG93KG9wdGlvbnMuc2NvcGUsIGVsZW1lbnQsIG9wdGlvbnMpO1xuICAgICAgICAgICAgICByZXR1cm4gJHEud2hlbihyZXQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgIC8vIElzc3VlIG9uQ29tcGxldGUgY2FsbGJhY2sgd2hlbiB0aGUgYHNob3coKWAgZmluaXNoZXNcbiAgICAgICAgICAgICAgICAgIChvcHRpb25zLm9uQ29tcGxldGUgfHwgYW5ndWxhci5ub29wKShvcHRpb25zLnNjb3BlLCBlbGVtZW50LCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgIHN0YXJ0SGlkZVRpbWVvdXQoKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICBmdW5jdGlvbiBzdGFydEhpZGVUaW1lb3V0KCkge1xuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmhpZGVEZWxheSkge1xuICAgICAgICAgICAgICAgICAgaGlkZVRpbWVvdXQgPSAkdGltZW91dChzZXJ2aWNlLmNhbmNlbCwgb3B0aW9ucy5oaWRlRGVsYXkpIDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlYXNvbikgeyBzaG93RG9uZSA9IHRydWU7IHNlbGYuZGVmZXJyZWQucmVqZWN0KHJlYXNvbik7IH0pO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgY2FuY2VsVGltZW91dDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoaGlkZVRpbWVvdXQpIHtcbiAgICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKGhpZGVUaW1lb3V0KTtcbiAgICAgICAgICAgICAgaGlkZVRpbWVvdXQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICByZW1vdmU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2VsZi5jYW5jZWxUaW1lb3V0KCk7XG4gICAgICAgICAgICByZXR1cm4gcmVtb3ZlRG9uZSA9ICRxLndoZW4oc2hvd0RvbmUpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHZhciByZXQgPSBlbGVtZW50ID8gb3B0aW9ucy5vblJlbW92ZShvcHRpb25zLnNjb3BlLCBlbGVtZW50LCBvcHRpb25zKSA6IHRydWU7XG4gICAgICAgICAgICAgIHJldHVybiAkcS53aGVuKHJldCkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAoIW9wdGlvbnMucHJlc2VydmVTY29wZSkgb3B0aW9ucy5zY29wZS4kZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIHJlbW92ZURvbmUgPSB0cnVlO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLypcbiAgICAgKiBSZXBsYWNlIGB7e2AgYW5kIGB9fWAgaW4gYSBzdHJpbmcgKHVzdWFsbHkgYSB0ZW1wbGF0ZSkgd2l0aCB0aGUgYWN0dWFsIHN0YXJ0LS9lbmRTeW1ib2xzIHVzZWRcbiAgICAgKiBmb3IgaW50ZXJwb2xhdGlvbi4gVGhpcyBhbGxvd3MgcHJlLWRlZmluZWQgdGVtcGxhdGVzIChmb3IgY29tcG9uZW50cyBzdWNoIGFzIGRpYWxvZywgdG9hc3QgZXRjKVxuICAgICAqIHRvIGNvbnRpbnVlIHRvIHdvcmsgaW4gYXBwcyB0aGF0IHVzZSBjdXN0b20gaW50ZXJwb2xhdGlvbiBzdGFydC0vZW5kU3ltYm9scy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0IFRoZSB0ZXh0IGluIHdoaWNoIHRvIHJlcGxhY2UgYHt7YCAvIGB9fWBcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgbW9kaWZpZWQgc3RyaW5nIHVzaW5nIHRoZSBhY3R1YWwgaW50ZXJwb2xhdGlvbiBzdGFydC0vZW5kU3ltYm9sc1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlcGxhY2VJbnRlcnBvbGF0aW9uU3ltYm9scyh0ZXh0KSB7XG4gICAgICBpZiAoIXRleHQgfHwgIWFuZ3VsYXIuaXNTdHJpbmcodGV4dCkpIHJldHVybiB0ZXh0O1xuICAgICAgcmV0dXJuIHRleHQucmVwbGFjZSgvXFx7XFx7L2csIHN0YXJ0U3ltYm9sKS5yZXBsYWNlKC99fS9nLCBlbmRTeW1ib2wpO1xuICAgIH1cbiAgfVxuXG59XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG4gIC8qKlxuICAgKiBAbmdkb2MgbW9kdWxlXG4gICAqIEBuYW1lIG1hdGVyaWFsLmNvcmUuY29tcG9uZW50UmVnaXN0cnlcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIEEgY29tcG9uZW50IGluc3RhbmNlIHJlZ2lzdHJhdGlvbiBzZXJ2aWNlLlxuICAgKiBOb3RlOiBjdXJyZW50bHkgdGhpcyBhcyBhIHByaXZhdGUgc2VydmljZSBpbiB0aGUgU2lkZU5hdiBjb21wb25lbnQuXG4gICAqL1xuICBhbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29yZScpXG4gICAgLmZhY3RvcnkoJyRtZENvbXBvbmVudFJlZ2lzdHJ5JywgQ29tcG9uZW50UmVnaXN0cnkpO1xuXG4gIC8qXG4gICAqIEBwcml2YXRlXG4gICAqIEBuZ2RvYyBmYWN0b3J5XG4gICAqIEBuYW1lIENvbXBvbmVudFJlZ2lzdHJ5XG4gICAqIEBtb2R1bGUgbWF0ZXJpYWwuY29yZS5jb21wb25lbnRSZWdpc3RyeVxuICAgKlxuICAgKi9cbiAgZnVuY3Rpb24gQ29tcG9uZW50UmVnaXN0cnkoJGxvZywgJHEpIHtcblxuICAgIHZhciBzZWxmO1xuICAgIHZhciBpbnN0YW5jZXMgPSBbIF07XG4gICAgdmFyIHBlbmRpbmdzID0geyB9O1xuXG4gICAgcmV0dXJuIHNlbGYgPSB7XG4gICAgICAvKipcbiAgICAgICAqIFVzZWQgdG8gcHJpbnQgYW4gZXJyb3Igd2hlbiBhbiBpbnN0YW5jZSBmb3IgYSBoYW5kbGUgaXNuJ3QgZm91bmQuXG4gICAgICAgKi9cbiAgICAgIG5vdEZvdW5kRXJyb3I6IGZ1bmN0aW9uKGhhbmRsZSkge1xuICAgICAgICAkbG9nLmVycm9yKCdObyBpbnN0YW5jZSBmb3VuZCBmb3IgaGFuZGxlJywgaGFuZGxlKTtcbiAgICAgIH0sXG4gICAgICAvKipcbiAgICAgICAqIFJldHVybiBhbGwgcmVnaXN0ZXJlZCBpbnN0YW5jZXMgYXMgYW4gYXJyYXkuXG4gICAgICAgKi9cbiAgICAgIGdldEluc3RhbmNlczogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBpbnN0YW5jZXM7XG4gICAgICB9LFxuXG4gICAgICAvKipcbiAgICAgICAqIEdldCBhIHJlZ2lzdGVyZWQgaW5zdGFuY2UuXG4gICAgICAgKiBAcGFyYW0gaGFuZGxlIHRoZSBTdHJpbmcgaGFuZGxlIHRvIGxvb2sgdXAgZm9yIGEgcmVnaXN0ZXJlZCBpbnN0YW5jZS5cbiAgICAgICAqL1xuICAgICAgZ2V0OiBmdW5jdGlvbihoYW5kbGUpIHtcbiAgICAgICAgaWYgKCAhaXNWYWxpZElEKGhhbmRsZSkgKSByZXR1cm4gbnVsbDtcblxuICAgICAgICB2YXIgaSwgaiwgaW5zdGFuY2U7XG4gICAgICAgIGZvcihpID0gMCwgaiA9IGluc3RhbmNlcy5sZW5ndGg7IGkgPCBqOyBpKyspIHtcbiAgICAgICAgICBpbnN0YW5jZSA9IGluc3RhbmNlc1tpXTtcbiAgICAgICAgICBpZihpbnN0YW5jZS4kJG1kSGFuZGxlID09PSBoYW5kbGUpIHtcbiAgICAgICAgICAgIHJldHVybiBpbnN0YW5jZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9LFxuXG4gICAgICAvKipcbiAgICAgICAqIFJlZ2lzdGVyIGFuIGluc3RhbmNlLlxuICAgICAgICogQHBhcmFtIGluc3RhbmNlIHRoZSBpbnN0YW5jZSB0byByZWdpc3RlclxuICAgICAgICogQHBhcmFtIGhhbmRsZSB0aGUgaGFuZGxlIHRvIGlkZW50aWZ5IHRoZSBpbnN0YW5jZSB1bmRlci5cbiAgICAgICAqL1xuICAgICAgcmVnaXN0ZXI6IGZ1bmN0aW9uKGluc3RhbmNlLCBoYW5kbGUpIHtcbiAgICAgICAgaWYgKCAhaGFuZGxlICkgcmV0dXJuIGFuZ3VsYXIubm9vcDtcblxuICAgICAgICBpbnN0YW5jZS4kJG1kSGFuZGxlID0gaGFuZGxlO1xuICAgICAgICBpbnN0YW5jZXMucHVzaChpbnN0YW5jZSk7XG4gICAgICAgIHJlc29sdmVXaGVuKCk7XG5cbiAgICAgICAgcmV0dXJuIGRlcmVnaXN0ZXI7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlbW92ZSByZWdpc3RyYXRpb24gZm9yIGFuIGluc3RhbmNlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBkZXJlZ2lzdGVyKCkge1xuICAgICAgICAgIHZhciBpbmRleCA9IGluc3RhbmNlcy5pbmRleE9mKGluc3RhbmNlKTtcbiAgICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICBpbnN0YW5jZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVzb2x2ZSBhbnkgcGVuZGluZyBwcm9taXNlcyBmb3IgdGhpcyBpbnN0YW5jZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZVdoZW4oKSB7XG4gICAgICAgICAgdmFyIGRmZCA9IHBlbmRpbmdzW2hhbmRsZV07XG4gICAgICAgICAgaWYgKCBkZmQgKSB7XG4gICAgICAgICAgICBkZmQucmVzb2x2ZSggaW5zdGFuY2UgKTtcbiAgICAgICAgICAgIGRlbGV0ZSBwZW5kaW5nc1toYW5kbGVdO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgLyoqXG4gICAgICAgKiBBc3luYyBhY2Nlc3NvciB0byByZWdpc3RlcmVkIGNvbXBvbmVudCBpbnN0YW5jZVxuICAgICAgICogSWYgbm90IGF2YWlsYWJsZSB0aGVuIGEgcHJvbWlzZSBpcyBjcmVhdGVkIHRvIG5vdGlmeVxuICAgICAgICogYWxsIGxpc3RlbmVycyB3aGVuIHRoZSBpbnN0YW5jZSBpcyByZWdpc3RlcmVkLlxuICAgICAgICovXG4gICAgICB3aGVuIDogZnVuY3Rpb24oaGFuZGxlKSB7XG4gICAgICAgIGlmICggaXNWYWxpZElEKGhhbmRsZSkgKSB7XG4gICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICB2YXIgaW5zdGFuY2UgPSBzZWxmLmdldChoYW5kbGUpO1xuXG4gICAgICAgICAgaWYgKCBpbnN0YW5jZSApICB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCBpbnN0YW5jZSApO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwZW5kaW5nc1toYW5kbGVdID0gZGVmZXJyZWQ7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICRxLnJlamVjdChcIkludmFsaWQgYG1kLWNvbXBvbmVudC1pZGAgdmFsdWUuXCIpO1xuICAgICAgfVxuXG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGlzVmFsaWRJRChoYW5kbGUpe1xuICAgICAgcmV0dXJuIGhhbmRsZSAmJiAoaGFuZGxlICE9PSBcIlwiKTtcbiAgICB9XG5cbiAgfVxuICBDb21wb25lbnRSZWdpc3RyeS4kaW5qZWN0ID0gW1wiJGxvZ1wiLCBcIiRxXCJdO1xuXG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBzZXJ2aWNlXG4gICAqIEBuYW1lICRtZEJ1dHRvbklua1JpcHBsZVxuICAgKiBAbW9kdWxlIG1hdGVyaWFsLmNvcmVcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFByb3ZpZGVzIHJpcHBsZSBlZmZlY3RzIGZvciBtZC1idXR0b24uICBTZWUgJG1kSW5rUmlwcGxlIHNlcnZpY2UgZm9yIGFsbCBwb3NzaWJsZSBjb25maWd1cmF0aW9uIG9wdGlvbnMuXG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0PX0gc2NvcGUgU2NvcGUgd2l0aGluIHRoZSBjdXJyZW50IGNvbnRleHRcbiAgICogQHBhcmFtIHtvYmplY3Q9fSBlbGVtZW50IFRoZSBlbGVtZW50IHRoZSByaXBwbGUgZWZmZWN0IHNob3VsZCBiZSBhcHBsaWVkIHRvXG4gICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyAoT3B0aW9uYWwpIENvbmZpZ3VyYXRpb24gb3B0aW9ucyB0byBvdmVycmlkZSB0aGUgZGVmYXVsdHJpcHBsZSBjb25maWd1cmF0aW9uXG4gICAqL1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb3JlJylcbiAgICAuZmFjdG9yeSgnJG1kQnV0dG9uSW5rUmlwcGxlJywgTWRCdXR0b25JbmtSaXBwbGUpO1xuXG4gIGZ1bmN0aW9uIE1kQnV0dG9uSW5rUmlwcGxlKCRtZElua1JpcHBsZSkge1xuICAgIHJldHVybiB7XG4gICAgICBhdHRhY2g6IGF0dGFjaFxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBhdHRhY2goc2NvcGUsIGVsZW1lbnQsIG9wdGlvbnMpIHtcbiAgICAgIHZhciBlbGVtZW50T3B0aW9ucyA9IG9wdGlvbnNGb3JFbGVtZW50KGVsZW1lbnQpO1xuICAgICAgcmV0dXJuICRtZElua1JpcHBsZS5hdHRhY2goc2NvcGUsIGVsZW1lbnQsIGFuZ3VsYXIuZXh0ZW5kKGVsZW1lbnRPcHRpb25zLCBvcHRpb25zKSk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIG9wdGlvbnNGb3JFbGVtZW50KGVsZW1lbnQpIHtcbiAgICAgIGlmIChlbGVtZW50Lmhhc0NsYXNzKCdtZC1pY29uLWJ1dHRvbicpKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgaXNNZW51SXRlbTogZWxlbWVudC5oYXNDbGFzcygnbWQtbWVudS1pdGVtJyksXG4gICAgICAgICAgZml0UmlwcGxlOiB0cnVlLFxuICAgICAgICAgIGNlbnRlcjogdHJ1ZVxuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBpc01lbnVJdGVtOiBlbGVtZW50Lmhhc0NsYXNzKCdtZC1tZW51LWl0ZW0nKSxcbiAgICAgICAgICBkaW1CYWNrZ3JvdW5kOiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICB9XG4gIE1kQnV0dG9uSW5rUmlwcGxlLiRpbmplY3QgPSBbXCIkbWRJbmtSaXBwbGVcIl07O1xufSkoKTtcblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgLyoqXG4gICAqIEBuZ2RvYyBzZXJ2aWNlXG4gICAqIEBuYW1lICRtZENoZWNrYm94SW5rUmlwcGxlXG4gICAqIEBtb2R1bGUgbWF0ZXJpYWwuY29yZVxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogUHJvdmlkZXMgcmlwcGxlIGVmZmVjdHMgZm9yIG1kLWNoZWNrYm94LiAgU2VlICRtZElua1JpcHBsZSBzZXJ2aWNlIGZvciBhbGwgcG9zc2libGUgY29uZmlndXJhdGlvbiBvcHRpb25zLlxuICAgKlxuICAgKiBAcGFyYW0ge29iamVjdD19IHNjb3BlIFNjb3BlIHdpdGhpbiB0aGUgY3VycmVudCBjb250ZXh0XG4gICAqIEBwYXJhbSB7b2JqZWN0PX0gZWxlbWVudCBUaGUgZWxlbWVudCB0aGUgcmlwcGxlIGVmZmVjdCBzaG91bGQgYmUgYXBwbGllZCB0b1xuICAgKiBAcGFyYW0ge29iamVjdD19IG9wdGlvbnMgKE9wdGlvbmFsKSBDb25maWd1cmF0aW9uIG9wdGlvbnMgdG8gb3ZlcnJpZGUgdGhlIGRlZmF1bHRyaXBwbGUgY29uZmlndXJhdGlvblxuICAgKi9cblxuICBhbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29yZScpXG4gICAgLmZhY3RvcnkoJyRtZENoZWNrYm94SW5rUmlwcGxlJywgTWRDaGVja2JveElua1JpcHBsZSk7XG5cbiAgZnVuY3Rpb24gTWRDaGVja2JveElua1JpcHBsZSgkbWRJbmtSaXBwbGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYXR0YWNoOiBhdHRhY2hcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gYXR0YWNoKHNjb3BlLCBlbGVtZW50LCBvcHRpb25zKSB7XG4gICAgICByZXR1cm4gJG1kSW5rUmlwcGxlLmF0dGFjaChzY29wZSwgZWxlbWVudCwgYW5ndWxhci5leHRlbmQoe1xuICAgICAgICBjZW50ZXI6IHRydWUsXG4gICAgICAgIGRpbUJhY2tncm91bmQ6IGZhbHNlLFxuICAgICAgICBmaXRSaXBwbGU6IHRydWVcbiAgICAgIH0sIG9wdGlvbnMpKTtcbiAgICB9O1xuICB9XG4gIE1kQ2hlY2tib3hJbmtSaXBwbGUuJGluamVjdCA9IFtcIiRtZElua1JpcHBsZVwiXTs7XG59KSgpO1xuXG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBzZXJ2aWNlXG4gICAqIEBuYW1lICRtZExpc3RJbmtSaXBwbGVcbiAgICogQG1vZHVsZSBtYXRlcmlhbC5jb3JlXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBQcm92aWRlcyByaXBwbGUgZWZmZWN0cyBmb3IgbWQtbGlzdC4gIFNlZSAkbWRJbmtSaXBwbGUgc2VydmljZSBmb3IgYWxsIHBvc3NpYmxlIGNvbmZpZ3VyYXRpb24gb3B0aW9ucy5cbiAgICpcbiAgICogQHBhcmFtIHtvYmplY3Q9fSBzY29wZSBTY29wZSB3aXRoaW4gdGhlIGN1cnJlbnQgY29udGV4dFxuICAgKiBAcGFyYW0ge29iamVjdD19IGVsZW1lbnQgVGhlIGVsZW1lbnQgdGhlIHJpcHBsZSBlZmZlY3Qgc2hvdWxkIGJlIGFwcGxpZWQgdG9cbiAgICogQHBhcmFtIHtvYmplY3Q9fSBvcHRpb25zIChPcHRpb25hbCkgQ29uZmlndXJhdGlvbiBvcHRpb25zIHRvIG92ZXJyaWRlIHRoZSBkZWZhdWx0cmlwcGxlIGNvbmZpZ3VyYXRpb25cbiAgICovXG5cbiAgYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvcmUnKVxuICAgIC5mYWN0b3J5KCckbWRMaXN0SW5rUmlwcGxlJywgTWRMaXN0SW5rUmlwcGxlKTtcblxuICBmdW5jdGlvbiBNZExpc3RJbmtSaXBwbGUoJG1kSW5rUmlwcGxlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGF0dGFjaDogYXR0YWNoXG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGF0dGFjaChzY29wZSwgZWxlbWVudCwgb3B0aW9ucykge1xuICAgICAgcmV0dXJuICRtZElua1JpcHBsZS5hdHRhY2goc2NvcGUsIGVsZW1lbnQsIGFuZ3VsYXIuZXh0ZW5kKHtcbiAgICAgICAgY2VudGVyOiBmYWxzZSxcbiAgICAgICAgZGltQmFja2dyb3VuZDogdHJ1ZSxcbiAgICAgICAgb3V0bGluZTogZmFsc2UsXG4gICAgICAgIHJpcHBsZVNpemU6ICdmdWxsJ1xuICAgICAgfSwgb3B0aW9ucykpO1xuICAgIH07XG4gIH1cbiAgTWRMaXN0SW5rUmlwcGxlLiRpbmplY3QgPSBbXCIkbWRJbmtSaXBwbGVcIl07O1xufSkoKTtcblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb3JlJylcbiAgLmZhY3RvcnkoJyRtZElua1JpcHBsZScsIElua1JpcHBsZVNlcnZpY2UpXG4gIC5kaXJlY3RpdmUoJ21kSW5rUmlwcGxlJywgSW5rUmlwcGxlRGlyZWN0aXZlKVxuICAuZGlyZWN0aXZlKCdtZE5vSW5rJywgYXR0ck5vRGlyZWN0aXZlKCkpXG4gIC5kaXJlY3RpdmUoJ21kTm9CYXInLCBhdHRyTm9EaXJlY3RpdmUoKSlcbiAgLmRpcmVjdGl2ZSgnbWROb1N0cmV0Y2gnLCBhdHRyTm9EaXJlY3RpdmUoKSk7XG5cbmZ1bmN0aW9uIElua1JpcHBsZURpcmVjdGl2ZSgkbWRCdXR0b25JbmtSaXBwbGUsICRtZENoZWNrYm94SW5rUmlwcGxlKSB7XG4gIHJldHVybiB7XG4gICAgY29udHJvbGxlcjogYW5ndWxhci5ub29wLFxuICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cikge1xuICAgICAgaWYgKGF0dHIuaGFzT3duUHJvcGVydHkoJ21kSW5rUmlwcGxlQ2hlY2tib3gnKSkge1xuICAgICAgICAkbWRDaGVja2JveElua1JpcHBsZS5hdHRhY2goc2NvcGUsIGVsZW1lbnQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJG1kQnV0dG9uSW5rUmlwcGxlLmF0dGFjaChzY29wZSwgZWxlbWVudCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xufVxuSW5rUmlwcGxlRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkbWRCdXR0b25JbmtSaXBwbGVcIiwgXCIkbWRDaGVja2JveElua1JpcHBsZVwiXTtcblxuZnVuY3Rpb24gSW5rUmlwcGxlU2VydmljZSgkd2luZG93LCAkdGltZW91dCkge1xuXG4gIHJldHVybiB7XG4gICAgYXR0YWNoOiBhdHRhY2hcbiAgfTtcblxuICBmdW5jdGlvbiBhdHRhY2goc2NvcGUsIGVsZW1lbnQsIG9wdGlvbnMpIHtcbiAgICBpZiAoZWxlbWVudC5jb250cm9sbGVyKCdtZE5vSW5rJykpIHJldHVybiBhbmd1bGFyLm5vb3A7XG5cbiAgICBvcHRpb25zID0gYW5ndWxhci5leHRlbmQoe1xuICAgICAgY29sb3JFbGVtZW50OiBlbGVtZW50LFxuICAgICAgbW91c2Vkb3duOiB0cnVlLFxuICAgICAgaG92ZXI6IHRydWUsXG4gICAgICBmb2N1czogdHJ1ZSxcbiAgICAgIGNlbnRlcjogZmFsc2UsXG4gICAgICBtb3VzZWRvd25QYXVzZVRpbWU6IDE1MCxcbiAgICAgIGRpbUJhY2tncm91bmQ6IGZhbHNlLFxuICAgICAgb3V0bGluZTogZmFsc2UsXG4gICAgICBmdWxsUmlwcGxlOiB0cnVlLFxuICAgICAgaXNNZW51SXRlbTogZmFsc2UsXG4gICAgICBmaXRSaXBwbGU6IGZhbHNlXG4gICAgfSwgb3B0aW9ucyk7XG5cbiAgICB2YXIgcmlwcGxlU2l6ZSxcbiAgICAgICAgY29udHJvbGxlciA9IGVsZW1lbnQuY29udHJvbGxlcignbWRJbmtSaXBwbGUnKSB8fCB7fSxcbiAgICAgICAgY291bnRlciA9IDAsXG4gICAgICAgIHJpcHBsZXMgPSBbXSxcbiAgICAgICAgc3RhdGVzID0gW10sXG4gICAgICAgIGlzQWN0aXZlRXhwciA9IGVsZW1lbnQuYXR0cignbWQtaGlnaGxpZ2h0JyksXG4gICAgICAgIGlzQWN0aXZlID0gZmFsc2UsXG4gICAgICAgIGlzSGVsZCA9IGZhbHNlLFxuICAgICAgICBub2RlID0gZWxlbWVudFswXSxcbiAgICAgICAgcmlwcGxlU2l6ZVNldHRpbmcgPSBlbGVtZW50LmF0dHIoJ21kLXJpcHBsZS1zaXplJyksXG4gICAgICAgIGNvbG9yID0gcGFyc2VDb2xvcihlbGVtZW50LmF0dHIoJ21kLWluay1yaXBwbGUnKSkgfHwgcGFyc2VDb2xvcihvcHRpb25zLmNvbG9yRWxlbWVudC5sZW5ndGggJiYgJHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKG9wdGlvbnMuY29sb3JFbGVtZW50WzBdKS5jb2xvciB8fCAncmdiKDAsIDAsIDApJyk7XG5cbiAgICBzd2l0Y2ggKHJpcHBsZVNpemVTZXR0aW5nKSB7XG4gICAgICBjYXNlICdmdWxsJzpcbiAgICAgICAgb3B0aW9ucy5mdWxsUmlwcGxlID0gdHJ1ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdwYXJ0aWFsJzpcbiAgICAgICAgb3B0aW9ucy5mdWxsUmlwcGxlID0gZmFsc2U7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIC8vIGV4cG9zZSBvbklucHV0IGZvciByaXBwbGUgdGVzdGluZ1xuICAgIGlmIChvcHRpb25zLm1vdXNlZG93bikge1xuICAgICAgZWxlbWVudC5vbignJG1kLnByZXNzZG93bicsIG9uUHJlc3NEb3duKVxuICAgICAgICAub24oJyRtZC5wcmVzc3VwJywgb25QcmVzc1VwKTtcbiAgICB9XG5cbiAgICBjb250cm9sbGVyLmNyZWF0ZVJpcHBsZSA9IGNyZWF0ZVJpcHBsZTtcblxuICAgIGlmIChpc0FjdGl2ZUV4cHIpIHtcbiAgICAgIHNjb3BlLiR3YXRjaChpc0FjdGl2ZUV4cHIsIGZ1bmN0aW9uIHdhdGNoQWN0aXZlKG5ld1ZhbHVlKSB7XG4gICAgICAgIGlzQWN0aXZlID0gbmV3VmFsdWU7XG4gICAgICAgIGlmIChpc0FjdGl2ZSAmJiAhcmlwcGxlcy5sZW5ndGgpIHtcbiAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7IGNyZWF0ZVJpcHBsZSgwLCAwKTsgfSwgMCwgZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIGFuZ3VsYXIuZm9yRWFjaChyaXBwbGVzLCB1cGRhdGVFbGVtZW50KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFB1Ymxpc2ggc2VsZi1kZXRhY2ggbWV0aG9kIGlmIGRlc2lyZWQuLi5cbiAgICByZXR1cm4gZnVuY3Rpb24gZGV0YWNoKCkge1xuICAgICAgZWxlbWVudC5vZmYoJyRtZC5wcmVzc2Rvd24nLCBvblByZXNzRG93bilcbiAgICAgICAgLm9mZignJG1kLnByZXNzdXAnLCBvblByZXNzVXApO1xuICAgICAgZ2V0UmlwcGxlQ29udGFpbmVyKCkucmVtb3ZlKCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGN1cnJlbnQgcmlwcGxlIGNvbnRhaW5lclxuICAgICAqIElmIHRoZXJlIGlzIG5vIHJpcHBsZSBjb250YWluZXIsIGl0IGNyZWF0ZXMgb25lIGFuZCByZXR1cm5zIGl0XG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7YW5ndWxhci5lbGVtZW50fSByaXBwbGUgY29udGFpbmVyIGVsZW1lbnRcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRSaXBwbGVDb250YWluZXIoKSB7XG4gICAgICB2YXIgY29udGFpbmVyID0gZWxlbWVudC5kYXRhKCckbWRSaXBwbGVDb250YWluZXInKTtcbiAgICAgIGlmIChjb250YWluZXIpIHJldHVybiBjb250YWluZXI7XG4gICAgICBjb250YWluZXIgPSBhbmd1bGFyLmVsZW1lbnQoJzxkaXYgY2xhc3M9XCJtZC1yaXBwbGUtY29udGFpbmVyXCI+Jyk7XG4gICAgICBlbGVtZW50LmFwcGVuZChjb250YWluZXIpO1xuICAgICAgZWxlbWVudC5kYXRhKCckbWRSaXBwbGVDb250YWluZXInLCBjb250YWluZXIpO1xuICAgICAgcmV0dXJuIGNvbnRhaW5lcjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXJzZUNvbG9yKGNvbG9yKSB7XG4gICAgICBpZiAoIWNvbG9yKSByZXR1cm47XG4gICAgICBpZiAoY29sb3IuaW5kZXhPZigncmdiYScpID09PSAwKSByZXR1cm4gY29sb3IucmVwbGFjZSgvXFxkP1xcLj9cXGQqXFxzKlxcKVxccyokLywgJzAuMSknKTtcbiAgICAgIGlmIChjb2xvci5pbmRleE9mKCdyZ2InKSAgPT09IDApIHJldHVybiByZ2JUb1JHQkEoY29sb3IpO1xuICAgICAgaWYgKGNvbG9yLmluZGV4T2YoJyMnKSAgICA9PT0gMCkgcmV0dXJuIGhleFRvUkdCQShjb2xvcik7XG5cbiAgICAgIC8qKlxuICAgICAgICogQ29udmVydHMgYSBoZXggdmFsdWUgdG8gYW4gcmdiYSBzdHJpbmdcbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge3N0cmluZ30gaGV4IHZhbHVlICgzIG9yIDYgZGlnaXRzKSB0byBiZSBjb252ZXJ0ZWRcbiAgICAgICAqXG4gICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSByZ2JhIGNvbG9yIHdpdGggMC4xIGFscGhhXG4gICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIGhleFRvUkdCQShjb2xvcikge1xuICAgICAgICB2YXIgaGV4ID0gY29sb3IuY2hhckF0KDApID09PSAnIycgPyBjb2xvci5zdWJzdHIoMSkgOiBjb2xvcixcbiAgICAgICAgICBkaWcgPSBoZXgubGVuZ3RoIC8gMyxcbiAgICAgICAgICByZWQgPSBoZXguc3Vic3RyKDAsIGRpZyksXG4gICAgICAgICAgZ3JuID0gaGV4LnN1YnN0cihkaWcsIGRpZyksXG4gICAgICAgICAgYmx1ID0gaGV4LnN1YnN0cihkaWcgKiAyKTtcbiAgICAgICAgaWYgKGRpZyA9PT0gMSkge1xuICAgICAgICAgIHJlZCArPSByZWQ7XG4gICAgICAgICAgZ3JuICs9IGdybjtcbiAgICAgICAgICBibHUgKz0gYmx1O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAncmdiYSgnICsgcGFyc2VJbnQocmVkLCAxNikgKyAnLCcgKyBwYXJzZUludChncm4sIDE2KSArICcsJyArIHBhcnNlSW50KGJsdSwgMTYpICsgJywwLjEpJztcbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiBDb252ZXJ0cyByZ2IgdmFsdWUgdG8gcmdiYSBzdHJpbmdcbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge3N0cmluZ30gcmdiIGNvbG9yIHN0cmluZ1xuICAgICAgICpcbiAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHJnYmEgY29sb3Igd2l0aCAwLjEgYWxwaGFcbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gcmdiVG9SR0JBKGNvbG9yKSB7XG4gICAgICAgIHJldHVybiBjb2xvci5yZXBsYWNlKCcpJywgJywgMC4xKScpLnJlcGxhY2UoJygnLCAnYSgnKTtcbiAgICAgIH1cblxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbW92ZUVsZW1lbnQoZWxlbSwgd2FpdCkge1xuICAgICAgcmlwcGxlcy5zcGxpY2UocmlwcGxlcy5pbmRleE9mKGVsZW0pLCAxKTtcbiAgICAgIGlmIChyaXBwbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBnZXRSaXBwbGVDb250YWluZXIoKS5jc3MoeyBiYWNrZ3JvdW5kQ29sb3I6ICcnIH0pO1xuICAgICAgfVxuICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkgeyBlbGVtLnJlbW92ZSgpOyB9LCB3YWl0LCBmYWxzZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlRWxlbWVudChlbGVtKSB7XG4gICAgICB2YXIgaW5kZXggPSByaXBwbGVzLmluZGV4T2YoZWxlbSksXG4gICAgICAgICAgc3RhdGUgPSBzdGF0ZXNbaW5kZXhdIHx8IHt9LFxuICAgICAgICAgIGVsZW1Jc0FjdGl2ZSA9IHJpcHBsZXMubGVuZ3RoID4gMSA/IGZhbHNlIDogaXNBY3RpdmUsXG4gICAgICAgICAgZWxlbUlzSGVsZCAgID0gcmlwcGxlcy5sZW5ndGggPiAxID8gZmFsc2UgOiBpc0hlbGQ7XG4gICAgICBpZiAoZWxlbUlzQWN0aXZlIHx8IHN0YXRlLmFuaW1hdGluZyB8fCBlbGVtSXNIZWxkKSB7XG4gICAgICAgIGVsZW0uYWRkQ2xhc3MoJ21kLXJpcHBsZS12aXNpYmxlJyk7XG4gICAgICB9IGVsc2UgaWYgKGVsZW0pIHtcbiAgICAgICAgZWxlbS5yZW1vdmVDbGFzcygnbWQtcmlwcGxlLXZpc2libGUnKTtcbiAgICAgICAgaWYgKG9wdGlvbnMub3V0bGluZSkge1xuICAgICAgICAgIGVsZW0uY3NzKHtcbiAgICAgICAgICAgIHdpZHRoOiByaXBwbGVTaXplICsgJ3B4JyxcbiAgICAgICAgICAgIGhlaWdodDogcmlwcGxlU2l6ZSArICdweCcsXG4gICAgICAgICAgICBtYXJnaW5MZWZ0OiAocmlwcGxlU2l6ZSAqIC0xKSArICdweCcsXG4gICAgICAgICAgICBtYXJnaW5Ub3A6IChyaXBwbGVTaXplICogLTEpICsgJ3B4J1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJlbW92ZUVsZW1lbnQoZWxlbSwgb3B0aW9ucy5vdXRsaW5lID8gNDUwIDogNjUwKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgcmlwcGxlIGF0IHRoZSBwcm92aWRlZCBjb29yZGluYXRlc1xuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGxlZnQgY3Vyc29yIHBvc2l0aW9uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHRvcCBjdXJzb3IgcG9zaXRpb25cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHthbmd1bGFyLmVsZW1lbnR9IHRoZSBnZW5lcmF0ZWQgcmlwcGxlIGVsZW1lbnRcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjcmVhdGVSaXBwbGUobGVmdCwgdG9wKSB7XG5cbiAgICAgIGNvbG9yID0gcGFyc2VDb2xvcihlbGVtZW50LmF0dHIoJ21kLWluay1yaXBwbGUnKSkgfHwgcGFyc2VDb2xvcigkd2luZG93LmdldENvbXB1dGVkU3R5bGUob3B0aW9ucy5jb2xvckVsZW1lbnRbMF0pLmNvbG9yIHx8ICdyZ2IoMCwgMCwgMCknKTtcblxuICAgICAgdmFyIGNvbnRhaW5lciA9IGdldFJpcHBsZUNvbnRhaW5lcigpLFxuICAgICAgICAgIHNpemUgPSBnZXRSaXBwbGVTaXplKGxlZnQsIHRvcCksXG4gICAgICAgICAgY3NzID0gZ2V0UmlwcGxlQ3NzKHNpemUsIGxlZnQsIHRvcCksXG4gICAgICAgICAgZWxlbSA9IGdldFJpcHBsZUVsZW1lbnQoY3NzKSxcbiAgICAgICAgICBpbmRleCA9IHJpcHBsZXMuaW5kZXhPZihlbGVtKSxcbiAgICAgICAgICBzdGF0ZSA9IHN0YXRlc1tpbmRleF0gfHwge307XG5cbiAgICAgIHJpcHBsZVNpemUgPSBzaXplO1xuXG4gICAgICBzdGF0ZS5hbmltYXRpbmcgPSB0cnVlO1xuXG4gICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChvcHRpb25zLmRpbUJhY2tncm91bmQpIHtcbiAgICAgICAgICBjb250YWluZXIuY3NzKHsgYmFja2dyb3VuZENvbG9yOiBjb2xvciB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbGVtLmFkZENsYXNzKCdtZC1yaXBwbGUtcGxhY2VkIG1kLXJpcHBsZS1zY2FsZWQnKTtcbiAgICAgICAgaWYgKG9wdGlvbnMub3V0bGluZSkge1xuICAgICAgICAgIGVsZW0uY3NzKHtcbiAgICAgICAgICAgIGJvcmRlcldpZHRoOiAoc2l6ZSAqIDAuNSkgKyAncHgnLFxuICAgICAgICAgICAgbWFyZ2luTGVmdDogKHNpemUgKiAtMC41KSArICdweCcsXG4gICAgICAgICAgICBtYXJnaW5Ub3A6IChzaXplICogLTAuNSkgKyAncHgnXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZWxlbS5jc3MoeyBsZWZ0OiAnNTAlJywgdG9wOiAnNTAlJyB9KTtcbiAgICAgICAgfVxuICAgICAgICB1cGRhdGVFbGVtZW50KGVsZW0pO1xuICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgc3RhdGUuYW5pbWF0aW5nID0gZmFsc2U7XG4gICAgICAgICAgdXBkYXRlRWxlbWVudChlbGVtKTtcbiAgICAgICAgfSwgKG9wdGlvbnMub3V0bGluZSA/IDQ1MCA6IDIyNSksIGZhbHNlKTtcbiAgICAgIH0sIDAsIGZhbHNlKTtcblxuICAgICAgcmV0dXJuIGVsZW07XG5cbiAgICAgIC8qKlxuICAgICAgICogQ3JlYXRlcyB0aGUgcmlwcGxlIGVsZW1lbnQgd2l0aCB0aGUgcHJvdmlkZWQgY3NzXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIHtvYmplY3R9IGNzcyBwcm9wZXJ0aWVzIHRvIGJlIGFwcGxpZWRcbiAgICAgICAqXG4gICAgICAgKiBAcmV0dXJucyB7YW5ndWxhci5lbGVtZW50fSB0aGUgZ2VuZXJhdGVkIHJpcHBsZSBlbGVtZW50XG4gICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIGdldFJpcHBsZUVsZW1lbnQoY3NzKSB7XG4gICAgICAgIHZhciBlbGVtID0gYW5ndWxhci5lbGVtZW50KCc8ZGl2IGNsYXNzPVwibWQtcmlwcGxlXCIgZGF0YS1jb3VudGVyPVwiJyArIGNvdW50ZXIrKyArICdcIj4nKTtcbiAgICAgICAgcmlwcGxlcy51bnNoaWZ0KGVsZW0pO1xuICAgICAgICBzdGF0ZXMudW5zaGlmdCh7IGFuaW1hdGluZzogdHJ1ZSB9KTtcbiAgICAgICAgY29udGFpbmVyLmFwcGVuZChlbGVtKTtcbiAgICAgICAgY3NzICYmIGVsZW0uY3NzKGNzcyk7XG4gICAgICAgIHJldHVybiBlbGVtO1xuICAgICAgfVxuXG4gICAgICAvKipcbiAgICAgICAqIENhbGN1bGF0ZSB0aGUgcmlwcGxlIHNpemVcbiAgICAgICAqXG4gICAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBjYWxjdWxhdGVkIHJpcHBsZSBkaWFtZXRlclxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBnZXRSaXBwbGVTaXplKGxlZnQsIHRvcCkge1xuICAgICAgICB2YXIgd2lkdGggPSBjb250YWluZXIucHJvcCgnb2Zmc2V0V2lkdGgnKSxcbiAgICAgICAgICAgIGhlaWdodCA9IGNvbnRhaW5lci5wcm9wKCdvZmZzZXRIZWlnaHQnKSxcbiAgICAgICAgICAgIG11bHRpcGxpZXIsIHNpemUsIHJlY3Q7XG4gICAgICAgIGlmIChvcHRpb25zLmlzTWVudUl0ZW0pIHtcbiAgICAgICAgICBzaXplID0gTWF0aC5zcXJ0KE1hdGgucG93KHdpZHRoLCAyKSArIE1hdGgucG93KGhlaWdodCwgMikpO1xuICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbnMub3V0bGluZSkge1xuICAgICAgICAgIHJlY3QgPSBub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICAgIGxlZnQgLT0gcmVjdC5sZWZ0O1xuICAgICAgICAgIHRvcCAtPSByZWN0LnRvcDtcbiAgICAgICAgICB3aWR0aCA9IE1hdGgubWF4KGxlZnQsIHdpZHRoIC0gbGVmdCk7XG4gICAgICAgICAgaGVpZ2h0ID0gTWF0aC5tYXgodG9wLCBoZWlnaHQgLSB0b3ApO1xuICAgICAgICAgIHNpemUgPSAyICogTWF0aC5zcXJ0KE1hdGgucG93KHdpZHRoLCAyKSArIE1hdGgucG93KGhlaWdodCwgMikpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG11bHRpcGxpZXIgPSBvcHRpb25zLmZ1bGxSaXBwbGUgPyAxLjEgOiAwLjg7XG4gICAgICAgICAgc2l6ZSA9IE1hdGguc3FydChNYXRoLnBvdyh3aWR0aCwgMikgKyBNYXRoLnBvdyhoZWlnaHQsIDIpKSAqIG11bHRpcGxpZXI7XG4gICAgICAgICAgaWYgKG9wdGlvbnMuZml0UmlwcGxlKSB7XG4gICAgICAgICAgICBzaXplID0gTWF0aC5taW4oaGVpZ2h0LCB3aWR0aCwgc2l6ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzaXplO1xuICAgICAgfVxuXG4gICAgICAvKipcbiAgICAgICAqIEdlbmVyYXRlcyB0aGUgcmlwcGxlIGNzc1xuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSB0aGUgZGlhbWV0ZXIgb2YgdGhlIHJpcHBsZVxuICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHRoZSBsZWZ0IGN1cnNvciBvZmZzZXRcbiAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSB0aGUgdG9wIGN1cnNvciBvZmZzZXRcbiAgICAgICAqXG4gICAgICAgKiBAcmV0dXJucyB7e2JhY2tncm91bmRDb2xvcjogc3RyaW5nLCBib3JkZXJDb2xvcjogc3RyaW5nLCB3aWR0aDogc3RyaW5nLCBoZWlnaHQ6IHN0cmluZ319XG4gICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIGdldFJpcHBsZUNzcyhzaXplLCBsZWZ0LCB0b3ApIHtcbiAgICAgICAgdmFyIHJlY3QgPSBub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICAgICAgY3NzICA9IHtcbiAgICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiByZ2JhVG9SR0IoY29sb3IpLFxuICAgICAgICAgICAgICBib3JkZXJDb2xvcjogcmdiYVRvUkdCKGNvbG9yKSxcbiAgICAgICAgICAgICAgd2lkdGg6IHNpemUgKyAncHgnLFxuICAgICAgICAgICAgICBoZWlnaHQ6IHNpemUgKyAncHgnXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIGlmIChvcHRpb25zLm91dGxpbmUpIHtcbiAgICAgICAgICBjc3Mud2lkdGggPSAwO1xuICAgICAgICAgIGNzcy5oZWlnaHQgPSAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNzcy5tYXJnaW5MZWZ0ID0gY3NzLm1hcmdpblRvcCA9IChzaXplICogLTAuNSkgKyAncHgnO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG9wdGlvbnMuY2VudGVyKSB7XG4gICAgICAgICAgY3NzLmxlZnQgPSBjc3MudG9wID0gJzUwJSc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY3NzLmxlZnQgPSBNYXRoLnJvdW5kKChsZWZ0IC0gcmVjdC5sZWZ0KSAvIGNvbnRhaW5lci5wcm9wKCdvZmZzZXRXaWR0aCcpICogMTAwKSArICclJztcbiAgICAgICAgICBjc3MudG9wID0gTWF0aC5yb3VuZCgodG9wIC0gcmVjdC50b3ApIC8gY29udGFpbmVyLnByb3AoJ29mZnNldEhlaWdodCcpICogMTAwKSArICclJztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjc3M7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvbnZlcnRzIHJnYmEgc3RyaW5nIHRvIHJnYiwgcmVtb3ZpbmcgdGhlIGFscGhhIHZhbHVlXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSByZ2JhIGNvbG9yXG4gICAgICAgICAqXG4gICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHJnYiBjb2xvclxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gcmdiYVRvUkdCKGNvbG9yKSB7XG4gICAgICAgICAgcmV0dXJuIGNvbG9yLnJlcGxhY2UoJ3JnYmEnLCAncmdiJykucmVwbGFjZSgvLFteXFwpLF0rXFwpLywgJyknKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZXMgdXNlciBpbnB1dCBzdGFydCBhbmQgc3RvcCBldmVudHNcbiAgICAgKlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG9uUHJlc3NEb3duKGV2KSB7XG4gICAgICBpZiAoIWlzUmlwcGxlQWxsb3dlZCgpKSByZXR1cm47XG5cbiAgICAgIGNyZWF0ZVJpcHBsZShldi5wb2ludGVyLngsIGV2LnBvaW50ZXIueSk7XG4gICAgICBpc0hlbGQgPSB0cnVlO1xuICAgIH1cbiAgICBmdW5jdGlvbiBvblByZXNzVXAoKSB7XG4gICAgICBpc0hlbGQgPSBmYWxzZTtcbiAgICAgIHZhciByaXBwbGUgPSByaXBwbGVzWyByaXBwbGVzLmxlbmd0aCAtIDEgXTtcbiAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHsgdXBkYXRlRWxlbWVudChyaXBwbGUpOyB9LCAwLCBmYWxzZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGV0ZXJtaW5lcyBpZiB0aGUgcmlwcGxlIGlzIGFsbG93ZWRcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSB0cnVlIGlmIHRoZSByaXBwbGUgaXMgYWxsb3dlZCwgZmFsc2UgaWYgbm90XG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNSaXBwbGVBbGxvd2VkKCkge1xuICAgICAgdmFyIHBhcmVudCA9IG5vZGUucGFyZW50Tm9kZTtcbiAgICAgIHZhciBncmFuZHBhcmVudCA9IHBhcmVudCAmJiBwYXJlbnQucGFyZW50Tm9kZTtcbiAgICAgIHZhciBhbmNlc3RvciA9IGdyYW5kcGFyZW50ICYmIGdyYW5kcGFyZW50LnBhcmVudE5vZGU7XG4gICAgICByZXR1cm4gIWlzRGlzYWJsZWQobm9kZSkgJiYgIWlzRGlzYWJsZWQocGFyZW50KSAmJiAhaXNEaXNhYmxlZChncmFuZHBhcmVudCkgJiYgIWlzRGlzYWJsZWQoYW5jZXN0b3IpO1xuICAgICAgZnVuY3Rpb24gaXNEaXNhYmxlZCAoZWxlbSkge1xuICAgICAgICByZXR1cm4gZWxlbSAmJiBlbGVtLmhhc0F0dHJpYnV0ZSAmJiBlbGVtLmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgfVxufVxuSW5rUmlwcGxlU2VydmljZS4kaW5qZWN0ID0gW1wiJHdpbmRvd1wiLCBcIiR0aW1lb3V0XCJdO1xuXG4vKipcbiAqIG5vaW5rL25vYmFyL25vc3RyZXRjaCBkaXJlY3RpdmU6IG1ha2UgYW55IGVsZW1lbnQgdGhhdCBoYXMgb25lIG9mXG4gKiB0aGVzZSBhdHRyaWJ1dGVzIGJlIGdpdmVuIGEgY29udHJvbGxlciwgc28gdGhhdCBvdGhlciBkaXJlY3RpdmVzIGNhblxuICogYHJlcXVpcmU6YCB0aGVzZSBhbmQgc2VlIGlmIHRoZXJlIGlzIGEgYG5vPHh4eD5gIHBhcmVudCBhdHRyaWJ1dGUuXG4gKlxuICogQHVzYWdlXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxuICogPHBhcmVudCBtZC1uby1pbms+XG4gKiAgIDxjaGlsZCBkZXRlY3Qtbm8+XG4gKiAgIDwvY2hpbGQ+XG4gKiA8L3BhcmVudD5cbiAqIDwvaGxqcz5cbiAqXG4gKiA8aGxqcyBsYW5nPVwianNcIj5cbiAqIG15QXBwLmRpcmVjdGl2ZSgnZGV0ZWN0Tm8nLCBmdW5jdGlvbigpIHtcbiAqICAgcmV0dXJuIHtcbiAqICAgICByZXF1aXJlOiBbJ14/bWROb0luaycsIF4/bWROb0JhciddLFxuICogICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJscykge1xuICogICAgICAgdmFyIG5vaW5rQ3RybCA9IGN0cmxzWzBdO1xuICogICAgICAgdmFyIG5vYmFyQ3RybCA9IGN0cmxzWzFdO1xuICogICAgICAgaWYgKG5vSW5rQ3RybCkge1xuICogICAgICAgICBhbGVydChcInRoZSBtZC1uby1pbmsgZmxhZyBoYXMgYmVlbiBzcGVjaWZpZWQgb24gYW4gYW5jZXN0b3IhXCIpO1xuICogICAgICAgfVxuICogICAgICAgaWYgKG5vYmFyQ3RybCkge1xuICogICAgICAgICBhbGVydChcInRoZSBtZC1uby1iYXIgZmxhZyBoYXMgYmVlbiBzcGVjaWZpZWQgb24gYW4gYW5jZXN0b3IhXCIpO1xuICogICAgICAgfVxuICogICAgIH1cbiAqICAgfTtcbiAqIH0pO1xuICogPC9obGpzPlxuICovXG5mdW5jdGlvbiBhdHRyTm9EaXJlY3RpdmUoKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgY29udHJvbGxlcjogYW5ndWxhci5ub29wXG4gICAgfTtcbiAgfTtcbn1cblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgLyoqXG4gICAqIEBuZ2RvYyBzZXJ2aWNlXG4gICAqIEBuYW1lICRtZFRhYklua1JpcHBsZVxuICAgKiBAbW9kdWxlIG1hdGVyaWFsLmNvcmVcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFByb3ZpZGVzIHJpcHBsZSBlZmZlY3RzIGZvciBtZC10YWJzLiAgU2VlICRtZElua1JpcHBsZSBzZXJ2aWNlIGZvciBhbGwgcG9zc2libGUgY29uZmlndXJhdGlvbiBvcHRpb25zLlxuICAgKlxuICAgKiBAcGFyYW0ge29iamVjdD19IHNjb3BlIFNjb3BlIHdpdGhpbiB0aGUgY3VycmVudCBjb250ZXh0XG4gICAqIEBwYXJhbSB7b2JqZWN0PX0gZWxlbWVudCBUaGUgZWxlbWVudCB0aGUgcmlwcGxlIGVmZmVjdCBzaG91bGQgYmUgYXBwbGllZCB0b1xuICAgKiBAcGFyYW0ge29iamVjdD19IG9wdGlvbnMgKE9wdGlvbmFsKSBDb25maWd1cmF0aW9uIG9wdGlvbnMgdG8gb3ZlcnJpZGUgdGhlIGRlZmF1bHRyaXBwbGUgY29uZmlndXJhdGlvblxuICAgKi9cblxuICBhbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29yZScpXG4gICAgLmZhY3RvcnkoJyRtZFRhYklua1JpcHBsZScsIE1kVGFiSW5rUmlwcGxlKTtcblxuICBmdW5jdGlvbiBNZFRhYklua1JpcHBsZSgkbWRJbmtSaXBwbGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYXR0YWNoOiBhdHRhY2hcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gYXR0YWNoKHNjb3BlLCBlbGVtZW50LCBvcHRpb25zKSB7XG4gICAgICByZXR1cm4gJG1kSW5rUmlwcGxlLmF0dGFjaChzY29wZSwgZWxlbWVudCwgYW5ndWxhci5leHRlbmQoe1xuICAgICAgICBjZW50ZXI6IGZhbHNlLFxuICAgICAgICBkaW1CYWNrZ3JvdW5kOiB0cnVlLFxuICAgICAgICBvdXRsaW5lOiBmYWxzZSxcbiAgICAgICAgcmlwcGxlU2l6ZTogJ2Z1bGwnXG4gICAgICB9LCBvcHRpb25zKSk7XG4gICAgfTtcbiAgfVxuICBNZFRhYklua1JpcHBsZS4kaW5qZWN0ID0gW1wiJG1kSW5rUmlwcGxlXCJdOztcbn0pKCk7XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29yZS50aGVtaW5nLnBhbGV0dGUnLCBbXSlcbi5jb25zdGFudCgnJG1kQ29sb3JQYWxldHRlJywge1xuICAncmVkJzoge1xuICAgICc1MCc6ICcjZmZlYmVlJyxcbiAgICAnMTAwJzogJyNmZmNkZDInLFxuICAgICcyMDAnOiAnI2VmOWE5YScsXG4gICAgJzMwMCc6ICcjZTU3MzczJyxcbiAgICAnNDAwJzogJyNlZjUzNTAnLFxuICAgICc1MDAnOiAnI2Y0NDMzNicsXG4gICAgJzYwMCc6ICcjZTUzOTM1JyxcbiAgICAnNzAwJzogJyNkMzJmMmYnLFxuICAgICc4MDAnOiAnI2M2MjgyOCcsXG4gICAgJzkwMCc6ICcjYjcxYzFjJyxcbiAgICAnQTEwMCc6ICcjZmY4YTgwJyxcbiAgICAnQTIwMCc6ICcjZmY1MjUyJyxcbiAgICAnQTQwMCc6ICcjZmYxNzQ0JyxcbiAgICAnQTcwMCc6ICcjZDUwMDAwJyxcbiAgICAnY29udHJhc3REZWZhdWx0Q29sb3InOiAnbGlnaHQnLFxuICAgICdjb250cmFzdERhcmtDb2xvcnMnOiAnNTAgMTAwIDIwMCAzMDAgNDAwIEExMDAnLFxuICAgICdjb250cmFzdFN0cm9uZ0xpZ2h0Q29sb3JzJzogJzUwMCA2MDAgNzAwIEEyMDAgQTQwMCBBNzAwJ1xuICB9LFxuICAncGluayc6IHtcbiAgICAnNTAnOiAnI2ZjZTRlYycsXG4gICAgJzEwMCc6ICcjZjhiYmQwJyxcbiAgICAnMjAwJzogJyNmNDhmYjEnLFxuICAgICczMDAnOiAnI2YwNjI5MicsXG4gICAgJzQwMCc6ICcjZWM0MDdhJyxcbiAgICAnNTAwJzogJyNlOTFlNjMnLFxuICAgICc2MDAnOiAnI2Q4MWI2MCcsXG4gICAgJzcwMCc6ICcjYzIxODViJyxcbiAgICAnODAwJzogJyNhZDE0NTcnLFxuICAgICc5MDAnOiAnIzg4MGU0ZicsXG4gICAgJ0ExMDAnOiAnI2ZmODBhYicsXG4gICAgJ0EyMDAnOiAnI2ZmNDA4MScsXG4gICAgJ0E0MDAnOiAnI2Y1MDA1NycsXG4gICAgJ0E3MDAnOiAnI2M1MTE2MicsXG4gICAgJ2NvbnRyYXN0RGVmYXVsdENvbG9yJzogJ2xpZ2h0JyxcbiAgICAnY29udHJhc3REYXJrQ29sb3JzJzogJzUwIDEwMCAyMDAgMzAwIDQwMCBBMTAwJyxcbiAgICAnY29udHJhc3RTdHJvbmdMaWdodENvbG9ycyc6ICc1MDAgNjAwIEEyMDAgQTQwMCBBNzAwJ1xuICB9LFxuICAncHVycGxlJzoge1xuICAgICc1MCc6ICcjZjNlNWY1JyxcbiAgICAnMTAwJzogJyNlMWJlZTcnLFxuICAgICcyMDAnOiAnI2NlOTNkOCcsXG4gICAgJzMwMCc6ICcjYmE2OGM4JyxcbiAgICAnNDAwJzogJyNhYjQ3YmMnLFxuICAgICc1MDAnOiAnIzljMjdiMCcsXG4gICAgJzYwMCc6ICcjOGUyNGFhJyxcbiAgICAnNzAwJzogJyM3YjFmYTInLFxuICAgICc4MDAnOiAnIzZhMWI5YScsXG4gICAgJzkwMCc6ICcjNGExNDhjJyxcbiAgICAnQTEwMCc6ICcjZWE4MGZjJyxcbiAgICAnQTIwMCc6ICcjZTA0MGZiJyxcbiAgICAnQTQwMCc6ICcjZDUwMGY5JyxcbiAgICAnQTcwMCc6ICcjYWEwMGZmJyxcbiAgICAnY29udHJhc3REZWZhdWx0Q29sb3InOiAnbGlnaHQnLFxuICAgICdjb250cmFzdERhcmtDb2xvcnMnOiAnNTAgMTAwIDIwMCBBMTAwJyxcbiAgICAnY29udHJhc3RTdHJvbmdMaWdodENvbG9ycyc6ICczMDAgNDAwIEEyMDAgQTQwMCBBNzAwJ1xuICB9LFxuICAnZGVlcC1wdXJwbGUnOiB7XG4gICAgJzUwJzogJyNlZGU3ZjYnLFxuICAgICcxMDAnOiAnI2QxYzRlOScsXG4gICAgJzIwMCc6ICcjYjM5ZGRiJyxcbiAgICAnMzAwJzogJyM5NTc1Y2QnLFxuICAgICc0MDAnOiAnIzdlNTdjMicsXG4gICAgJzUwMCc6ICcjNjczYWI3JyxcbiAgICAnNjAwJzogJyM1ZTM1YjEnLFxuICAgICc3MDAnOiAnIzUxMmRhOCcsXG4gICAgJzgwMCc6ICcjNDUyN2EwJyxcbiAgICAnOTAwJzogJyMzMTFiOTInLFxuICAgICdBMTAwJzogJyNiMzg4ZmYnLFxuICAgICdBMjAwJzogJyM3YzRkZmYnLFxuICAgICdBNDAwJzogJyM2NTFmZmYnLFxuICAgICdBNzAwJzogJyM2MjAwZWEnLFxuICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdsaWdodCcsXG4gICAgJ2NvbnRyYXN0RGFya0NvbG9ycyc6ICc1MCAxMDAgMjAwIEExMDAnLFxuICAgICdjb250cmFzdFN0cm9uZ0xpZ2h0Q29sb3JzJzogJzMwMCA0MDAgQTIwMCdcbiAgfSxcbiAgJ2luZGlnbyc6IHtcbiAgICAnNTAnOiAnI2U4ZWFmNicsXG4gICAgJzEwMCc6ICcjYzVjYWU5JyxcbiAgICAnMjAwJzogJyM5ZmE4ZGEnLFxuICAgICczMDAnOiAnIzc5ODZjYicsXG4gICAgJzQwMCc6ICcjNWM2YmMwJyxcbiAgICAnNTAwJzogJyMzZjUxYjUnLFxuICAgICc2MDAnOiAnIzM5NDlhYicsXG4gICAgJzcwMCc6ICcjMzAzZjlmJyxcbiAgICAnODAwJzogJyMyODM1OTMnLFxuICAgICc5MDAnOiAnIzFhMjM3ZScsXG4gICAgJ0ExMDAnOiAnIzhjOWVmZicsXG4gICAgJ0EyMDAnOiAnIzUzNmRmZScsXG4gICAgJ0E0MDAnOiAnIzNkNWFmZScsXG4gICAgJ0E3MDAnOiAnIzMwNGZmZScsXG4gICAgJ2NvbnRyYXN0RGVmYXVsdENvbG9yJzogJ2xpZ2h0JyxcbiAgICAnY29udHJhc3REYXJrQ29sb3JzJzogJzUwIDEwMCAyMDAgQTEwMCcsXG4gICAgJ2NvbnRyYXN0U3Ryb25nTGlnaHRDb2xvcnMnOiAnMzAwIDQwMCBBMjAwIEE0MDAnXG4gIH0sXG4gICdibHVlJzoge1xuICAgICc1MCc6ICcjZTNmMmZkJyxcbiAgICAnMTAwJzogJyNiYmRlZmInLFxuICAgICcyMDAnOiAnIzkwY2FmOScsXG4gICAgJzMwMCc6ICcjNjRiNWY2JyxcbiAgICAnNDAwJzogJyM0MmE1ZjUnLFxuICAgICc1MDAnOiAnIzIxOTZmMycsXG4gICAgJzYwMCc6ICcjMWU4OGU1JyxcbiAgICAnNzAwJzogJyMxOTc2ZDInLFxuICAgICc4MDAnOiAnIzE1NjVjMCcsXG4gICAgJzkwMCc6ICcjMGQ0N2ExJyxcbiAgICAnQTEwMCc6ICcjODJiMWZmJyxcbiAgICAnQTIwMCc6ICcjNDQ4YWZmJyxcbiAgICAnQTQwMCc6ICcjMjk3OWZmJyxcbiAgICAnQTcwMCc6ICcjMjk2MmZmJyxcbiAgICAnY29udHJhc3REZWZhdWx0Q29sb3InOiAnbGlnaHQnLFxuICAgICdjb250cmFzdERhcmtDb2xvcnMnOiAnMTAwIDIwMCAzMDAgNDAwIEExMDAnLFxuICAgICdjb250cmFzdFN0cm9uZ0xpZ2h0Q29sb3JzJzogJzUwMCA2MDAgNzAwIEEyMDAgQTQwMCBBNzAwJ1xuICB9LFxuICAnbGlnaHQtYmx1ZSc6IHtcbiAgICAnNTAnOiAnI2UxZjVmZScsXG4gICAgJzEwMCc6ICcjYjNlNWZjJyxcbiAgICAnMjAwJzogJyM4MWQ0ZmEnLFxuICAgICczMDAnOiAnIzRmYzNmNycsXG4gICAgJzQwMCc6ICcjMjliNmY2JyxcbiAgICAnNTAwJzogJyMwM2E5ZjQnLFxuICAgICc2MDAnOiAnIzAzOWJlNScsXG4gICAgJzcwMCc6ICcjMDI4OGQxJyxcbiAgICAnODAwJzogJyMwMjc3YmQnLFxuICAgICc5MDAnOiAnIzAxNTc5YicsXG4gICAgJ0ExMDAnOiAnIzgwZDhmZicsXG4gICAgJ0EyMDAnOiAnIzQwYzRmZicsXG4gICAgJ0E0MDAnOiAnIzAwYjBmZicsXG4gICAgJ0E3MDAnOiAnIzAwOTFlYScsXG4gICAgJ2NvbnRyYXN0RGVmYXVsdENvbG9yJzogJ2RhcmsnLFxuICAgICdjb250cmFzdExpZ2h0Q29sb3JzJzogJzUwMCA2MDAgNzAwIDgwMCA5MDAgQTcwMCcsXG4gICAgJ2NvbnRyYXN0U3Ryb25nTGlnaHRDb2xvcnMnOiAnNTAwIDYwMCA3MDAgODAwIEE3MDAnXG4gIH0sXG4gICdjeWFuJzoge1xuICAgICc1MCc6ICcjZTBmN2ZhJyxcbiAgICAnMTAwJzogJyNiMmViZjInLFxuICAgICcyMDAnOiAnIzgwZGVlYScsXG4gICAgJzMwMCc6ICcjNGRkMGUxJyxcbiAgICAnNDAwJzogJyMyNmM2ZGEnLFxuICAgICc1MDAnOiAnIzAwYmNkNCcsXG4gICAgJzYwMCc6ICcjMDBhY2MxJyxcbiAgICAnNzAwJzogJyMwMDk3YTcnLFxuICAgICc4MDAnOiAnIzAwODM4ZicsXG4gICAgJzkwMCc6ICcjMDA2MDY0JyxcbiAgICAnQTEwMCc6ICcjODRmZmZmJyxcbiAgICAnQTIwMCc6ICcjMThmZmZmJyxcbiAgICAnQTQwMCc6ICcjMDBlNWZmJyxcbiAgICAnQTcwMCc6ICcjMDBiOGQ0JyxcbiAgICAnY29udHJhc3REZWZhdWx0Q29sb3InOiAnZGFyaycsXG4gICAgJ2NvbnRyYXN0TGlnaHRDb2xvcnMnOiAnNTAwIDYwMCA3MDAgODAwIDkwMCcsXG4gICAgJ2NvbnRyYXN0U3Ryb25nTGlnaHRDb2xvcnMnOiAnNTAwIDYwMCA3MDAgODAwJ1xuICB9LFxuICAndGVhbCc6IHtcbiAgICAnNTAnOiAnI2UwZjJmMScsXG4gICAgJzEwMCc6ICcjYjJkZmRiJyxcbiAgICAnMjAwJzogJyM4MGNiYzQnLFxuICAgICczMDAnOiAnIzRkYjZhYycsXG4gICAgJzQwMCc6ICcjMjZhNjlhJyxcbiAgICAnNTAwJzogJyMwMDk2ODgnLFxuICAgICc2MDAnOiAnIzAwODk3YicsXG4gICAgJzcwMCc6ICcjMDA3OTZiJyxcbiAgICAnODAwJzogJyMwMDY5NWMnLFxuICAgICc5MDAnOiAnIzAwNGQ0MCcsXG4gICAgJ0ExMDAnOiAnI2E3ZmZlYicsXG4gICAgJ0EyMDAnOiAnIzY0ZmZkYScsXG4gICAgJ0E0MDAnOiAnIzFkZTliNicsXG4gICAgJ0E3MDAnOiAnIzAwYmZhNScsXG4gICAgJ2NvbnRyYXN0RGVmYXVsdENvbG9yJzogJ2RhcmsnLFxuICAgICdjb250cmFzdExpZ2h0Q29sb3JzJzogJzUwMCA2MDAgNzAwIDgwMCA5MDAnLFxuICAgICdjb250cmFzdFN0cm9uZ0xpZ2h0Q29sb3JzJzogJzUwMCA2MDAgNzAwJ1xuICB9LFxuICAnZ3JlZW4nOiB7XG4gICAgJzUwJzogJyNlOGY1ZTknLFxuICAgICcxMDAnOiAnI2M4ZTZjOScsXG4gICAgJzIwMCc6ICcjYTVkNmE3JyxcbiAgICAnMzAwJzogJyM4MWM3ODQnLFxuICAgICc0MDAnOiAnIzY2YmI2YScsXG4gICAgJzUwMCc6ICcjNGNhZjUwJyxcbiAgICAnNjAwJzogJyM0M2EwNDcnLFxuICAgICc3MDAnOiAnIzM4OGUzYycsXG4gICAgJzgwMCc6ICcjMmU3ZDMyJyxcbiAgICAnOTAwJzogJyMxYjVlMjAnLFxuICAgICdBMTAwJzogJyNiOWY2Y2EnLFxuICAgICdBMjAwJzogJyM2OWYwYWUnLFxuICAgICdBNDAwJzogJyMwMGU2NzYnLFxuICAgICdBNzAwJzogJyMwMGM4NTMnLFxuICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdkYXJrJyxcbiAgICAnY29udHJhc3RMaWdodENvbG9ycyc6ICc1MDAgNjAwIDcwMCA4MDAgOTAwJyxcbiAgICAnY29udHJhc3RTdHJvbmdMaWdodENvbG9ycyc6ICc1MDAgNjAwIDcwMCdcbiAgfSxcbiAgJ2xpZ2h0LWdyZWVuJzoge1xuICAgICc1MCc6ICcjZjFmOGU5JyxcbiAgICAnMTAwJzogJyNkY2VkYzgnLFxuICAgICcyMDAnOiAnI2M1ZTFhNScsXG4gICAgJzMwMCc6ICcjYWVkNTgxJyxcbiAgICAnNDAwJzogJyM5Y2NjNjUnLFxuICAgICc1MDAnOiAnIzhiYzM0YScsXG4gICAgJzYwMCc6ICcjN2NiMzQyJyxcbiAgICAnNzAwJzogJyM2ODlmMzgnLFxuICAgICc4MDAnOiAnIzU1OGIyZicsXG4gICAgJzkwMCc6ICcjMzM2OTFlJyxcbiAgICAnQTEwMCc6ICcjY2NmZjkwJyxcbiAgICAnQTIwMCc6ICcjYjJmZjU5JyxcbiAgICAnQTQwMCc6ICcjNzZmZjAzJyxcbiAgICAnQTcwMCc6ICcjNjRkZDE3JyxcbiAgICAnY29udHJhc3REZWZhdWx0Q29sb3InOiAnZGFyaycsXG4gICAgJ2NvbnRyYXN0TGlnaHRDb2xvcnMnOiAnODAwIDkwMCcsXG4gICAgJ2NvbnRyYXN0U3Ryb25nTGlnaHRDb2xvcnMnOiAnODAwIDkwMCdcbiAgfSxcbiAgJ2xpbWUnOiB7XG4gICAgJzUwJzogJyNmOWZiZTcnLFxuICAgICcxMDAnOiAnI2YwZjRjMycsXG4gICAgJzIwMCc6ICcjZTZlZTljJyxcbiAgICAnMzAwJzogJyNkY2U3NzUnLFxuICAgICc0MDAnOiAnI2Q0ZTE1NycsXG4gICAgJzUwMCc6ICcjY2RkYzM5JyxcbiAgICAnNjAwJzogJyNjMGNhMzMnLFxuICAgICc3MDAnOiAnI2FmYjQyYicsXG4gICAgJzgwMCc6ICcjOWU5ZDI0JyxcbiAgICAnOTAwJzogJyM4Mjc3MTcnLFxuICAgICdBMTAwJzogJyNmNGZmODEnLFxuICAgICdBMjAwJzogJyNlZWZmNDEnLFxuICAgICdBNDAwJzogJyNjNmZmMDAnLFxuICAgICdBNzAwJzogJyNhZWVhMDAnLFxuICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdkYXJrJyxcbiAgICAnY29udHJhc3RMaWdodENvbG9ycyc6ICc5MDAnLFxuICAgICdjb250cmFzdFN0cm9uZ0xpZ2h0Q29sb3JzJzogJzkwMCdcbiAgfSxcbiAgJ3llbGxvdyc6IHtcbiAgICAnNTAnOiAnI2ZmZmRlNycsXG4gICAgJzEwMCc6ICcjZmZmOWM0JyxcbiAgICAnMjAwJzogJyNmZmY1OWQnLFxuICAgICczMDAnOiAnI2ZmZjE3NicsXG4gICAgJzQwMCc6ICcjZmZlZTU4JyxcbiAgICAnNTAwJzogJyNmZmViM2InLFxuICAgICc2MDAnOiAnI2ZkZDgzNScsXG4gICAgJzcwMCc6ICcjZmJjMDJkJyxcbiAgICAnODAwJzogJyNmOWE4MjUnLFxuICAgICc5MDAnOiAnI2Y1N2YxNycsXG4gICAgJ0ExMDAnOiAnI2ZmZmY4ZCcsXG4gICAgJ0EyMDAnOiAnI2ZmZmYwMCcsXG4gICAgJ0E0MDAnOiAnI2ZmZWEwMCcsXG4gICAgJ0E3MDAnOiAnI2ZmZDYwMCcsXG4gICAgJ2NvbnRyYXN0RGVmYXVsdENvbG9yJzogJ2RhcmsnXG4gIH0sXG4gICdhbWJlcic6IHtcbiAgICAnNTAnOiAnI2ZmZjhlMScsXG4gICAgJzEwMCc6ICcjZmZlY2IzJyxcbiAgICAnMjAwJzogJyNmZmUwODInLFxuICAgICczMDAnOiAnI2ZmZDU0ZicsXG4gICAgJzQwMCc6ICcjZmZjYTI4JyxcbiAgICAnNTAwJzogJyNmZmMxMDcnLFxuICAgICc2MDAnOiAnI2ZmYjMwMCcsXG4gICAgJzcwMCc6ICcjZmZhMDAwJyxcbiAgICAnODAwJzogJyNmZjhmMDAnLFxuICAgICc5MDAnOiAnI2ZmNmYwMCcsXG4gICAgJ0ExMDAnOiAnI2ZmZTU3ZicsXG4gICAgJ0EyMDAnOiAnI2ZmZDc0MCcsXG4gICAgJ0E0MDAnOiAnI2ZmYzQwMCcsXG4gICAgJ0E3MDAnOiAnI2ZmYWIwMCcsXG4gICAgJ2NvbnRyYXN0RGVmYXVsdENvbG9yJzogJ2RhcmsnXG4gIH0sXG4gICdvcmFuZ2UnOiB7XG4gICAgJzUwJzogJyNmZmYzZTAnLFxuICAgICcxMDAnOiAnI2ZmZTBiMicsXG4gICAgJzIwMCc6ICcjZmZjYzgwJyxcbiAgICAnMzAwJzogJyNmZmI3NGQnLFxuICAgICc0MDAnOiAnI2ZmYTcyNicsXG4gICAgJzUwMCc6ICcjZmY5ODAwJyxcbiAgICAnNjAwJzogJyNmYjhjMDAnLFxuICAgICc3MDAnOiAnI2Y1N2MwMCcsXG4gICAgJzgwMCc6ICcjZWY2YzAwJyxcbiAgICAnOTAwJzogJyNlNjUxMDAnLFxuICAgICdBMTAwJzogJyNmZmQxODAnLFxuICAgICdBMjAwJzogJyNmZmFiNDAnLFxuICAgICdBNDAwJzogJyNmZjkxMDAnLFxuICAgICdBNzAwJzogJyNmZjZkMDAnLFxuICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdkYXJrJyxcbiAgICAnY29udHJhc3RMaWdodENvbG9ycyc6ICc4MDAgOTAwJyxcbiAgICAnY29udHJhc3RTdHJvbmdMaWdodENvbG9ycyc6ICc4MDAgOTAwJ1xuICB9LFxuICAnZGVlcC1vcmFuZ2UnOiB7XG4gICAgJzUwJzogJyNmYmU5ZTcnLFxuICAgICcxMDAnOiAnI2ZmY2NiYycsXG4gICAgJzIwMCc6ICcjZmZhYjkxJyxcbiAgICAnMzAwJzogJyNmZjhhNjUnLFxuICAgICc0MDAnOiAnI2ZmNzA0MycsXG4gICAgJzUwMCc6ICcjZmY1NzIyJyxcbiAgICAnNjAwJzogJyNmNDUxMWUnLFxuICAgICc3MDAnOiAnI2U2NGExOScsXG4gICAgJzgwMCc6ICcjZDg0MzE1JyxcbiAgICAnOTAwJzogJyNiZjM2MGMnLFxuICAgICdBMTAwJzogJyNmZjllODAnLFxuICAgICdBMjAwJzogJyNmZjZlNDAnLFxuICAgICdBNDAwJzogJyNmZjNkMDAnLFxuICAgICdBNzAwJzogJyNkZDJjMDAnLFxuICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdsaWdodCcsXG4gICAgJ2NvbnRyYXN0RGFya0NvbG9ycyc6ICc1MCAxMDAgMjAwIDMwMCA0MDAgQTEwMCBBMjAwJyxcbiAgICAnY29udHJhc3RTdHJvbmdMaWdodENvbG9ycyc6ICc1MDAgNjAwIDcwMCA4MDAgOTAwIEE0MDAgQTcwMCdcbiAgfSxcbiAgJ2Jyb3duJzoge1xuICAgICc1MCc6ICcjZWZlYmU5JyxcbiAgICAnMTAwJzogJyNkN2NjYzgnLFxuICAgICcyMDAnOiAnI2JjYWFhNCcsXG4gICAgJzMwMCc6ICcjYTE4ODdmJyxcbiAgICAnNDAwJzogJyM4ZDZlNjMnLFxuICAgICc1MDAnOiAnIzc5NTU0OCcsXG4gICAgJzYwMCc6ICcjNmQ0YzQxJyxcbiAgICAnNzAwJzogJyM1ZDQwMzcnLFxuICAgICc4MDAnOiAnIzRlMzQyZScsXG4gICAgJzkwMCc6ICcjM2UyNzIzJyxcbiAgICAnQTEwMCc6ICcjZDdjY2M4JyxcbiAgICAnQTIwMCc6ICcjYmNhYWE0JyxcbiAgICAnQTQwMCc6ICcjOGQ2ZTYzJyxcbiAgICAnQTcwMCc6ICcjNWQ0MDM3JyxcbiAgICAnY29udHJhc3REZWZhdWx0Q29sb3InOiAnbGlnaHQnLFxuICAgICdjb250cmFzdERhcmtDb2xvcnMnOiAnNTAgMTAwIDIwMCcsXG4gICAgJ2NvbnRyYXN0U3Ryb25nTGlnaHRDb2xvcnMnOiAnMzAwIDQwMCdcbiAgfSxcbiAgJ2dyZXknOiB7XG4gICAgJzUwJzogJyNmYWZhZmEnLFxuICAgICcxMDAnOiAnI2Y1ZjVmNScsXG4gICAgJzIwMCc6ICcjZWVlZWVlJyxcbiAgICAnMzAwJzogJyNlMGUwZTAnLFxuICAgICc0MDAnOiAnI2JkYmRiZCcsXG4gICAgJzUwMCc6ICcjOWU5ZTllJyxcbiAgICAnNjAwJzogJyM3NTc1NzUnLFxuICAgICc3MDAnOiAnIzYxNjE2MScsXG4gICAgJzgwMCc6ICcjNDI0MjQyJyxcbiAgICAnOTAwJzogJyMyMTIxMjEnLFxuICAgICcxMDAwJzogJyMwMDAwMDAnLFxuICAgICdBMTAwJzogJyNmZmZmZmYnLFxuICAgICdBMjAwJzogJyNlZWVlZWUnLFxuICAgICdBNDAwJzogJyNiZGJkYmQnLFxuICAgICdBNzAwJzogJyM2MTYxNjEnLFxuICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdkYXJrJyxcbiAgICAnY29udHJhc3RMaWdodENvbG9ycyc6ICc2MDAgNzAwIDgwMCA5MDAnXG4gIH0sXG4gICdibHVlLWdyZXknOiB7XG4gICAgJzUwJzogJyNlY2VmZjEnLFxuICAgICcxMDAnOiAnI2NmZDhkYycsXG4gICAgJzIwMCc6ICcjYjBiZWM1JyxcbiAgICAnMzAwJzogJyM5MGE0YWUnLFxuICAgICc0MDAnOiAnIzc4OTA5YycsXG4gICAgJzUwMCc6ICcjNjA3ZDhiJyxcbiAgICAnNjAwJzogJyM1NDZlN2EnLFxuICAgICc3MDAnOiAnIzQ1NWE2NCcsXG4gICAgJzgwMCc6ICcjMzc0NzRmJyxcbiAgICAnOTAwJzogJyMyNjMyMzgnLFxuICAgICdBMTAwJzogJyNjZmQ4ZGMnLFxuICAgICdBMjAwJzogJyNiMGJlYzUnLFxuICAgICdBNDAwJzogJyM3ODkwOWMnLFxuICAgICdBNzAwJzogJyM0NTVhNjQnLFxuICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdsaWdodCcsXG4gICAgJ2NvbnRyYXN0RGFya0NvbG9ycyc6ICc1MCAxMDAgMjAwIDMwMCcsXG4gICAgJ2NvbnRyYXN0U3Ryb25nTGlnaHRDb2xvcnMnOiAnNDAwIDUwMCdcbiAgfVxufSk7XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29yZS50aGVtaW5nJywgWydtYXRlcmlhbC5jb3JlLnRoZW1pbmcucGFsZXR0ZSddKVxuICAuZGlyZWN0aXZlKCdtZFRoZW1lJywgVGhlbWluZ0RpcmVjdGl2ZSlcbiAgLmRpcmVjdGl2ZSgnbWRUaGVtYWJsZScsIFRoZW1hYmxlRGlyZWN0aXZlKVxuICAucHJvdmlkZXIoJyRtZFRoZW1pbmcnLCBUaGVtaW5nUHJvdmlkZXIpXG4gIC5ydW4oZ2VuZXJhdGVUaGVtZXMpO1xuXG4vKipcbiAqIEBuZ2RvYyBwcm92aWRlclxuICogQG5hbWUgJG1kVGhlbWluZ1Byb3ZpZGVyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvcmVcbiAqXG4gKiBAZGVzY3JpcHRpb24gUHJvdmlkZXIgdG8gY29uZmlndXJlIHRoZSBgJG1kVGhlbWluZ2Agc2VydmljZS5cbiAqL1xuXG4vKipcbiAqIEBuZ2RvYyBtZXRob2RcbiAqIEBuYW1lICRtZFRoZW1pbmdQcm92aWRlciNzZXREZWZhdWx0VGhlbWVcbiAqIEBwYXJhbSB7c3RyaW5nfSB0aGVtZU5hbWUgRGVmYXVsdCB0aGVtZSBuYW1lIHRvIGJlIGFwcGxpZWQgdG8gZWxlbWVudHMuIERlZmF1bHQgdmFsdWUgaXMgYGRlZmF1bHRgLlxuICovXG5cbi8qKlxuICogQG5nZG9jIG1ldGhvZFxuICogQG5hbWUgJG1kVGhlbWluZ1Byb3ZpZGVyI2Fsd2F5c1dhdGNoVGhlbWVcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gd2F0Y2ggV2hldGhlciBvciBub3QgdG8gYWx3YXlzIHdhdGNoIHRoZW1lcyBmb3IgY2hhbmdlcyBhbmQgcmUtYXBwbHlcbiAqIGNsYXNzZXMgd2hlbiB0aGV5IGNoYW5nZS4gRGVmYXVsdCBpcyBgZmFsc2VgLiBFbmFibGluZyBjYW4gcmVkdWNlIHBlcmZvcm1hbmNlLlxuICovXG5cbi8qIFNvbWUgRXhhbXBsZSBWYWxpZCBUaGVtaW5nIEV4cHJlc3Npb25zXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAqXG4gKiBJbnRlbnRpb24gZ3JvdXAgZXhwYW5zaW9uOiAodmFsaWQgZm9yIHByaW1hcnksIGFjY2VudCwgd2FybiwgYmFja2dyb3VuZClcbiAqXG4gKiB7e3ByaW1hcnktMTAwfX0gLSBncmFiIHNoYWRlIDEwMCBmcm9tIHRoZSBwcmltYXJ5IHBhbGV0dGVcbiAqIHt7cHJpbWFyeS0xMDAtMC43fX0gLSBncmFiIHNoYWRlIDEwMCwgYXBwbHkgb3BhY2l0eSBvZiAwLjdcbiAqIHt7cHJpbWFyeS1odWUtMX19IC0gZ3JhYiB0aGUgc2hhZGUgYXNzaWduZWQgdG8gaHVlLTEgZnJvbSB0aGUgcHJpbWFyeSBwYWxldHRlXG4gKiB7e3ByaW1hcnktaHVlLTEtMC43fX0gLSBhcHBseSAwLjcgb3BhY2l0eSB0byBwcmltYXJ5LWh1ZS0xXG4gKiB7e3ByaW1hcnktY29sb3J9fSAtIEdlbmVyYXRlcyAubWQtaHVlLTEsIC5tZC1odWUtMiwgLm1kLWh1ZS0zIHdpdGggY29uZmlndXJlZCBzaGFkZXMgc2V0IGZvciBlYWNoIGh1ZVxuICoge3twcmltYXJ5LWNvbG9yLTAuN319IC0gQXBwbHkgMC43IG9wYWNpdHkgdG8gZWFjaCBvZiB0aGUgYWJvdmUgcnVsZXNcbiAqIHt7cHJpbWFyeS1jb250cmFzdH19IC0gR2VuZXJhdGVzIC5tZC1odWUtMSwgLm1kLWh1ZS0yLCAubWQtaHVlLTMgd2l0aCBjb25maWd1cmVkIGNvbnRyYXN0IChpZS4gdGV4dCkgY29sb3Igc2hhZGVzIHNldCBmb3IgZWFjaCBodWVcbiAqIHt7cHJpbWFyeS1jb250cmFzdC0wLjd9fSAtIEFwcGx5IDAuNyBvcGFjaXR5IHRvIGVhY2ggb2YgdGhlIGFib3ZlIHJ1bGVzXG4gKlxuICogRm9yZWdyb3VuZCBleHBhbnNpb246IEFwcGxpZXMgcmdiYSB0byBibGFjay93aGl0ZSBmb3JlZ3JvdW5kIHRleHRcbiAqXG4gKiB7e2ZvcmVncm91bmQtMX19IC0gdXNlZCBmb3IgcHJpbWFyeSB0ZXh0XG4gKiB7e2ZvcmVncm91bmQtMn19IC0gdXNlZCBmb3Igc2Vjb25kYXJ5IHRleHQvZGl2aWRlclxuICoge3tmb3JlZ3JvdW5kLTN9fSAtIHVzZWQgZm9yIGRpc2FibGVkIHRleHRcbiAqIHt7Zm9yZWdyb3VuZC00fX0gLSB1c2VkIGZvciBkaXZpZGVyc1xuICpcbiAqL1xuXG4vLyBJbiBtZW1vcnkgZ2VuZXJhdGVkIENTUyBydWxlczsgcmVnaXN0ZXJlZCBieSB0aGVtZS5uYW1lXG52YXIgR0VORVJBVEVEID0geyB9O1xuXG4vLyBJbiBtZW1vcnkgc3RvcmFnZSBvZiBkZWZpbmVkIHRoZW1lcyBhbmQgY29sb3IgcGFsZXR0ZXMgKGJvdGggbG9hZGVkIGJ5IENTUywgYW5kIHVzZXIgc3BlY2lmaWVkKVxudmFyIFBBTEVUVEVTO1xudmFyIFRIRU1FUztcblxudmFyIERBUktfRk9SRUdST1VORCA9IHtcbiAgbmFtZTogJ2RhcmsnLFxuICAnMSc6ICdyZ2JhKDAsMCwwLDAuODcpJyxcbiAgJzInOiAncmdiYSgwLDAsMCwwLjU0KScsXG4gICczJzogJ3JnYmEoMCwwLDAsMC4yNiknLFxuICAnNCc6ICdyZ2JhKDAsMCwwLDAuMTIpJ1xufTtcbnZhciBMSUdIVF9GT1JFR1JPVU5EID0ge1xuICBuYW1lOiAnbGlnaHQnLFxuICAnMSc6ICdyZ2JhKDI1NSwyNTUsMjU1LDEuMCknLFxuICAnMic6ICdyZ2JhKDI1NSwyNTUsMjU1LDAuNyknLFxuICAnMyc6ICdyZ2JhKDI1NSwyNTUsMjU1LDAuMyknLFxuICAnNCc6ICdyZ2JhKDI1NSwyNTUsMjU1LDAuMTIpJ1xufTtcblxudmFyIERBUktfU0hBRE9XID0gJzFweCAxcHggMHB4IHJnYmEoMCwwLDAsMC40KSwgLTFweCAtMXB4IDBweCByZ2JhKDAsMCwwLDAuNCknO1xudmFyIExJR0hUX1NIQURPVyA9ICcnO1xuXG52YXIgREFSS19DT05UUkFTVF9DT0xPUiA9IGNvbG9yVG9SZ2JhQXJyYXkoJ3JnYmEoMCwwLDAsMC44NyknKTtcbnZhciBMSUdIVF9DT05UUkFTVF9DT0xPUiA9IGNvbG9yVG9SZ2JhQXJyYXkoJ3JnYmEoMjU1LDI1NSwyNTUsMC44NycpO1xudmFyIFNUUk9OR19MSUdIVF9DT05UUkFTVF9DT0xPUiA9IGNvbG9yVG9SZ2JhQXJyYXkoJ3JnYigyNTUsMjU1LDI1NSknKTtcblxudmFyIFRIRU1FX0NPTE9SX1RZUEVTID0gWydwcmltYXJ5JywgJ2FjY2VudCcsICd3YXJuJywgJ2JhY2tncm91bmQnXTtcbnZhciBERUZBVUxUX0NPTE9SX1RZUEUgPSAncHJpbWFyeSc7XG5cbi8vIEEgY29sb3IgaW4gYSB0aGVtZSB3aWxsIHVzZSB0aGVzZSBodWVzIGJ5IGRlZmF1bHQsIGlmIG5vdCBzcGVjaWZpZWQgYnkgdXNlci5cbnZhciBMSUdIVF9ERUZBVUxUX0hVRVMgPSB7XG4gICdhY2NlbnQnOiB7XG4gICAgJ2RlZmF1bHQnOiAnQTIwMCcsXG4gICAgJ2h1ZS0xJzogJ0ExMDAnLFxuICAgICdodWUtMic6ICdBNDAwJyxcbiAgICAnaHVlLTMnOiAnQTcwMCdcbiAgfSxcbiAgJ2JhY2tncm91bmQnOiB7XG4gICAgJ2RlZmF1bHQnOiAnQTEwMCcsXG4gICAgJ2h1ZS0xJzogJzMwMCcsXG4gICAgJ2h1ZS0yJzogJzgwMCcsXG4gICAgJ2h1ZS0zJzogJzkwMCdcbiAgfVxufTtcblxudmFyIERBUktfREVGQVVMVF9IVUVTID0ge1xuICAnYmFja2dyb3VuZCc6IHtcbiAgICAnZGVmYXVsdCc6ICc4MDAnLFxuICAgICdodWUtMSc6ICczMDAnLFxuICAgICdodWUtMic6ICc2MDAnLFxuICAgICdodWUtMyc6ICc5MDAnXG4gIH1cbn07XG5USEVNRV9DT0xPUl9UWVBFUy5mb3JFYWNoKGZ1bmN0aW9uKGNvbG9yVHlwZSkge1xuICAvLyBDb2xvciB0eXBlcyB3aXRoIHVuc3BlY2lmaWVkIGRlZmF1bHQgaHVlcyB3aWxsIHVzZSB0aGVzZSBkZWZhdWx0IGh1ZSB2YWx1ZXNcbiAgdmFyIGRlZmF1bHREZWZhdWx0SHVlcyA9IHtcbiAgICAnZGVmYXVsdCc6ICc1MDAnLFxuICAgICdodWUtMSc6ICczMDAnLFxuICAgICdodWUtMic6ICc4MDAnLFxuICAgICdodWUtMyc6ICdBMTAwJ1xuICB9O1xuICBpZiAoIUxJR0hUX0RFRkFVTFRfSFVFU1tjb2xvclR5cGVdKSBMSUdIVF9ERUZBVUxUX0hVRVNbY29sb3JUeXBlXSA9IGRlZmF1bHREZWZhdWx0SHVlcztcbiAgaWYgKCFEQVJLX0RFRkFVTFRfSFVFU1tjb2xvclR5cGVdKSBEQVJLX0RFRkFVTFRfSFVFU1tjb2xvclR5cGVdID0gZGVmYXVsdERlZmF1bHRIdWVzO1xufSk7XG5cbnZhciBWQUxJRF9IVUVfVkFMVUVTID0gW1xuICAnNTAnLCAnMTAwJywgJzIwMCcsICczMDAnLCAnNDAwJywgJzUwMCcsICc2MDAnLFxuICAnNzAwJywgJzgwMCcsICc5MDAnLCAnQTEwMCcsICdBMjAwJywgJ0E0MDAnLCAnQTcwMCdcbl07XG5cbmZ1bmN0aW9uIFRoZW1pbmdQcm92aWRlcigkbWRDb2xvclBhbGV0dGUpIHtcbiAgUEFMRVRURVMgPSB7IH07XG4gIFRIRU1FUyA9IHsgfTtcblxuICB2YXIgdGhlbWluZ1Byb3ZpZGVyO1xuICB2YXIgZGVmYXVsdFRoZW1lID0gJ2RlZmF1bHQnO1xuICB2YXIgYWx3YXlzV2F0Y2hUaGVtZSA9IGZhbHNlO1xuXG4gIC8vIExvYWQgSlMgRGVmaW5lZCBQYWxldHRlc1xuICBhbmd1bGFyLmV4dGVuZChQQUxFVFRFUywgJG1kQ29sb3JQYWxldHRlKTtcblxuICAvLyBEZWZhdWx0IHRoZW1lIGRlZmluZWQgaW4gY29yZS5qc1xuXG4gIFRoZW1pbmdTZXJ2aWNlLiRpbmplY3QgPSBbXCIkcm9vdFNjb3BlXCIsIFwiJGxvZ1wiXTtcbiAgcmV0dXJuIHRoZW1pbmdQcm92aWRlciA9IHtcbiAgICBkZWZpbmVQYWxldHRlOiBkZWZpbmVQYWxldHRlLFxuICAgIGV4dGVuZFBhbGV0dGU6IGV4dGVuZFBhbGV0dGUsXG4gICAgdGhlbWU6IHJlZ2lzdGVyVGhlbWUsXG5cbiAgICBzZXREZWZhdWx0VGhlbWU6IGZ1bmN0aW9uKHRoZW1lKSB7XG4gICAgICBkZWZhdWx0VGhlbWUgPSB0aGVtZTtcbiAgICB9LFxuICAgIGFsd2F5c1dhdGNoVGhlbWU6IGZ1bmN0aW9uKGFsd2F5c1dhdGNoKSB7XG4gICAgICBhbHdheXNXYXRjaFRoZW1lID0gYWx3YXlzV2F0Y2g7XG4gICAgfSxcbiAgICAkZ2V0OiBUaGVtaW5nU2VydmljZSxcbiAgICBfTElHSFRfREVGQVVMVF9IVUVTOiBMSUdIVF9ERUZBVUxUX0hVRVMsXG4gICAgX0RBUktfREVGQVVMVF9IVUVTOiBEQVJLX0RFRkFVTFRfSFVFUyxcbiAgICBfUEFMRVRURVM6IFBBTEVUVEVTLFxuICAgIF9USEVNRVM6IFRIRU1FUyxcbiAgICBfcGFyc2VSdWxlczogcGFyc2VSdWxlcyxcbiAgICBfcmdiYTogcmdiYVxuICB9O1xuXG4gIC8vIEV4YW1wbGU6ICRtZFRoZW1pbmdQcm92aWRlci5kZWZpbmVQYWxldHRlKCduZW9uUmVkJywgeyA1MDogJyNmNWZhZmEnLCAuLi4gfSk7XG4gIGZ1bmN0aW9uIGRlZmluZVBhbGV0dGUobmFtZSwgbWFwKSB7XG4gICAgbWFwID0gbWFwIHx8IHt9O1xuICAgIFBBTEVUVEVTW25hbWVdID0gY2hlY2tQYWxldHRlVmFsaWQobmFtZSwgbWFwKTtcbiAgICByZXR1cm4gdGhlbWluZ1Byb3ZpZGVyO1xuICB9XG5cbiAgLy8gUmV0dXJucyBhbiBuZXcgb2JqZWN0IHdoaWNoIGlzIGEgY29weSBvZiBhIGdpdmVuIHBhbGV0dGUgYG5hbWVgIHdpdGggdmFyaWFibGVzIGZyb21cbiAgLy8gYG1hcGAgb3ZlcndyaXR0ZW5cbiAgLy8gRXhhbXBsZTogdmFyIG5lb25SZWRNYXAgPSAkbWRUaGVtaW5nUHJvdmlkZXIuZXh0ZW5kUGFsZXR0ZSgncmVkJywgeyA1MDogJyNmNWZhZmFmYScgfSk7XG4gIGZ1bmN0aW9uIGV4dGVuZFBhbGV0dGUobmFtZSwgbWFwKSB7XG4gICAgcmV0dXJuIGNoZWNrUGFsZXR0ZVZhbGlkKG5hbWUsICBhbmd1bGFyLmV4dGVuZCh7fSwgUEFMRVRURVNbbmFtZV0gfHwge30sIG1hcCkgKTtcbiAgfVxuXG4gIC8vIE1ha2Ugc3VyZSB0aGF0IHBhbGV0dGUgaGFzIGFsbCByZXF1aXJlZCBodWVzXG4gIGZ1bmN0aW9uIGNoZWNrUGFsZXR0ZVZhbGlkKG5hbWUsIG1hcCkge1xuICAgIHZhciBtaXNzaW5nQ29sb3JzID0gVkFMSURfSFVFX1ZBTFVFUy5maWx0ZXIoZnVuY3Rpb24oZmllbGQpIHtcbiAgICAgIHJldHVybiAhbWFwW2ZpZWxkXTtcbiAgICB9KTtcbiAgICBpZiAobWlzc2luZ0NvbG9ycy5sZW5ndGgpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgY29sb3JzICUxIGluIHBhbGV0dGUgJTIhXCJcbiAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgnJTEnLCBtaXNzaW5nQ29sb3JzLmpvaW4oJywgJykpXG4gICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoJyUyJywgbmFtZSkpO1xuICAgIH1cblxuICAgIHJldHVybiBtYXA7XG4gIH1cblxuICAvLyBSZWdpc3RlciBhIHRoZW1lICh3aGljaCBpcyBhIGNvbGxlY3Rpb24gb2YgY29sb3IgcGFsZXR0ZXMgdG8gdXNlIHdpdGggdmFyaW91cyBzdGF0ZXNcbiAgLy8gaWUuIHdhcm4sIGFjY2VudCwgcHJpbWFyeSApXG4gIC8vIE9wdGlvbmFsbHkgaW5oZXJpdCBmcm9tIGFuIGV4aXN0aW5nIHRoZW1lXG4gIC8vICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnY3VzdG9tLXRoZW1lJykucHJpbWFyeVBhbGV0dGUoJ3JlZCcpO1xuICBmdW5jdGlvbiByZWdpc3RlclRoZW1lKG5hbWUsIGluaGVyaXRGcm9tKSB7XG4gICAgaWYgKFRIRU1FU1tuYW1lXSkgcmV0dXJuIFRIRU1FU1tuYW1lXTtcblxuICAgIGluaGVyaXRGcm9tID0gaW5oZXJpdEZyb20gfHwgJ2RlZmF1bHQnO1xuXG4gICAgdmFyIHBhcmVudFRoZW1lID0gdHlwZW9mIGluaGVyaXRGcm9tID09PSAnc3RyaW5nJyA/IFRIRU1FU1tpbmhlcml0RnJvbV0gOiBpbmhlcml0RnJvbTtcbiAgICB2YXIgdGhlbWUgPSBuZXcgVGhlbWUobmFtZSk7XG5cbiAgICBpZiAocGFyZW50VGhlbWUpIHtcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChwYXJlbnRUaGVtZS5jb2xvcnMsIGZ1bmN0aW9uKGNvbG9yLCBjb2xvclR5cGUpIHtcbiAgICAgICAgdGhlbWUuY29sb3JzW2NvbG9yVHlwZV0gPSB7XG4gICAgICAgICAgbmFtZTogY29sb3IubmFtZSxcbiAgICAgICAgICAvLyBNYWtlIHN1cmUgYSBDT1BZIG9mIHRoZSBodWVzIGlzIGdpdmVuIHRvIHRoZSBjaGlsZCBjb2xvcixcbiAgICAgICAgICAvLyBub3QgdGhlIHNhbWUgcmVmZXJlbmNlLlxuICAgICAgICAgIGh1ZXM6IGFuZ3VsYXIuZXh0ZW5kKHt9LCBjb2xvci5odWVzKVxuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgfVxuICAgIFRIRU1FU1tuYW1lXSA9IHRoZW1lO1xuXG4gICAgcmV0dXJuIHRoZW1lO1xuICB9XG5cbiAgZnVuY3Rpb24gVGhlbWUobmFtZSkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZWxmLm5hbWUgPSBuYW1lO1xuICAgIHNlbGYuY29sb3JzID0ge307XG5cbiAgICBzZWxmLmRhcmsgPSBzZXREYXJrO1xuICAgIHNldERhcmsoZmFsc2UpO1xuXG4gICAgZnVuY3Rpb24gc2V0RGFyayhpc0RhcmspIHtcbiAgICAgIGlzRGFyayA9IGFyZ3VtZW50cy5sZW5ndGggPT09IDAgPyB0cnVlIDogISFpc0Rhcms7XG5cbiAgICAgIC8vIElmIG5vIGNoYW5nZSwgYWJvcnRcbiAgICAgIGlmIChpc0RhcmsgPT09IHNlbGYuaXNEYXJrKSByZXR1cm47XG5cbiAgICAgIHNlbGYuaXNEYXJrID0gaXNEYXJrO1xuXG4gICAgICBzZWxmLmZvcmVncm91bmRQYWxldHRlID0gc2VsZi5pc0RhcmsgPyBMSUdIVF9GT1JFR1JPVU5EIDogREFSS19GT1JFR1JPVU5EO1xuICAgICAgc2VsZi5mb3JlZ3JvdW5kU2hhZG93ID0gc2VsZi5pc0RhcmsgPyBEQVJLX1NIQURPVyA6IExJR0hUX1NIQURPVztcblxuICAgICAgLy8gTGlnaHQgYW5kIGRhcmsgdGhlbWVzIGhhdmUgZGlmZmVyZW50IGRlZmF1bHQgaHVlcy5cbiAgICAgIC8vIEdvIHRocm91Z2ggZWFjaCBleGlzdGluZyBjb2xvciB0eXBlIGZvciB0aGlzIHRoZW1lLCBhbmQgZm9yIGV2ZXJ5XG4gICAgICAvLyBodWUgdmFsdWUgdGhhdCBpcyBzdGlsbCB0aGUgZGVmYXVsdCBodWUgdmFsdWUgZnJvbSB0aGUgcHJldmlvdXMgbGlnaHQvZGFyayBzZXR0aW5nLFxuICAgICAgLy8gc2V0IGl0IHRvIHRoZSBkZWZhdWx0IGh1ZSB2YWx1ZSBmcm9tIHRoZSBuZXcgbGlnaHQvZGFyayBzZXR0aW5nLlxuICAgICAgdmFyIG5ld0RlZmF1bHRIdWVzID0gc2VsZi5pc0RhcmsgPyBEQVJLX0RFRkFVTFRfSFVFUyA6IExJR0hUX0RFRkFVTFRfSFVFUztcbiAgICAgIHZhciBvbGREZWZhdWx0SHVlcyA9IHNlbGYuaXNEYXJrID8gTElHSFRfREVGQVVMVF9IVUVTIDogREFSS19ERUZBVUxUX0hVRVM7XG4gICAgICBhbmd1bGFyLmZvckVhY2gobmV3RGVmYXVsdEh1ZXMsIGZ1bmN0aW9uKG5ld0RlZmF1bHRzLCBjb2xvclR5cGUpIHtcbiAgICAgICAgdmFyIGNvbG9yID0gc2VsZi5jb2xvcnNbY29sb3JUeXBlXTtcbiAgICAgICAgdmFyIG9sZERlZmF1bHRzID0gb2xkRGVmYXVsdEh1ZXNbY29sb3JUeXBlXTtcbiAgICAgICAgaWYgKGNvbG9yKSB7XG4gICAgICAgICAgZm9yICh2YXIgaHVlTmFtZSBpbiBjb2xvci5odWVzKSB7XG4gICAgICAgICAgICBpZiAoY29sb3IuaHVlc1todWVOYW1lXSA9PT0gb2xkRGVmYXVsdHNbaHVlTmFtZV0pIHtcbiAgICAgICAgICAgICAgY29sb3IuaHVlc1todWVOYW1lXSA9IG5ld0RlZmF1bHRzW2h1ZU5hbWVdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBzZWxmO1xuICAgIH1cblxuICAgIFRIRU1FX0NPTE9SX1RZUEVTLmZvckVhY2goZnVuY3Rpb24oY29sb3JUeXBlKSB7XG4gICAgICB2YXIgZGVmYXVsdEh1ZXMgPSAoc2VsZi5pc0RhcmsgPyBEQVJLX0RFRkFVTFRfSFVFUyA6IExJR0hUX0RFRkFVTFRfSFVFUylbY29sb3JUeXBlXTtcbiAgICAgIHNlbGZbY29sb3JUeXBlICsgJ1BhbGV0dGUnXSA9IGZ1bmN0aW9uIHNldFBhbGV0dGVUeXBlKHBhbGV0dGVOYW1lLCBodWVzKSB7XG4gICAgICAgIHZhciBjb2xvciA9IHNlbGYuY29sb3JzW2NvbG9yVHlwZV0gPSB7XG4gICAgICAgICAgbmFtZTogcGFsZXR0ZU5hbWUsXG4gICAgICAgICAgaHVlczogYW5ndWxhci5leHRlbmQoe30sIGRlZmF1bHRIdWVzLCBodWVzKVxuICAgICAgICB9O1xuXG4gICAgICAgIE9iamVjdC5rZXlzKGNvbG9yLmh1ZXMpLmZvckVhY2goZnVuY3Rpb24obmFtZSkge1xuICAgICAgICAgIGlmICghZGVmYXVsdEh1ZXNbbmFtZV0pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgaHVlIG5hbWUgJyUxJyBpbiB0aGVtZSAlMidzICUzIGNvbG9yICU0LiBBdmFpbGFibGUgaHVlIG5hbWVzOiAlNFwiXG4gICAgICAgICAgICAgIC5yZXBsYWNlKCclMScsIG5hbWUpXG4gICAgICAgICAgICAgIC5yZXBsYWNlKCclMicsIHNlbGYubmFtZSlcbiAgICAgICAgICAgICAgLnJlcGxhY2UoJyUzJywgcGFsZXR0ZU5hbWUpXG4gICAgICAgICAgICAgIC5yZXBsYWNlKCclNCcsIE9iamVjdC5rZXlzKGRlZmF1bHRIdWVzKS5qb2luKCcsICcpKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3Qua2V5cyhjb2xvci5odWVzKS5tYXAoZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgICAgcmV0dXJuIGNvbG9yLmh1ZXNba2V5XTtcbiAgICAgICAgfSkuZm9yRWFjaChmdW5jdGlvbihodWVWYWx1ZSkge1xuICAgICAgICAgIGlmIChWQUxJRF9IVUVfVkFMVUVTLmluZGV4T2YoaHVlVmFsdWUpID09IC0xKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGh1ZSB2YWx1ZSAnJTEnIGluIHRoZW1lICUyJ3MgJTMgY29sb3IgJTQuIEF2YWlsYWJsZSBodWUgdmFsdWVzOiAlNVwiXG4gICAgICAgICAgICAgIC5yZXBsYWNlKCclMScsIGh1ZVZhbHVlKVxuICAgICAgICAgICAgICAucmVwbGFjZSgnJTInLCBzZWxmLm5hbWUpXG4gICAgICAgICAgICAgIC5yZXBsYWNlKCclMycsIGNvbG9yVHlwZSlcbiAgICAgICAgICAgICAgLnJlcGxhY2UoJyU0JywgcGFsZXR0ZU5hbWUpXG4gICAgICAgICAgICAgIC5yZXBsYWNlKCclNScsIFZBTElEX0hVRV9WQUxVRVMuam9pbignLCAnKSlcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHNlbGY7XG4gICAgICB9O1xuXG4gICAgICBzZWxmW2NvbG9yVHlwZSArICdDb2xvciddID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtcbiAgICAgICAgY29uc29sZS53YXJuKCckbWRUaGVtaW5nUHJvdmlkZXJUaGVtZS4nICsgY29sb3JUeXBlICsgJ0NvbG9yKCkgaGFzIGJlZW4gZGVwcmVjYXRlZC4gJyArXG4gICAgICAgICAgICAgICAgICAgICAnVXNlICRtZFRoZW1pbmdQcm92aWRlclRoZW1lLicgKyBjb2xvclR5cGUgKyAnUGFsZXR0ZSgpIGluc3RlYWQuJyk7XG4gICAgICAgIHJldHVybiBzZWxmW2NvbG9yVHlwZSArICdQYWxldHRlJ10uYXBwbHkoc2VsZiwgYXJncyk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBzZXJ2aWNlXG4gICAqIEBuYW1lICRtZFRoZW1pbmdcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqXG4gICAqIFNlcnZpY2UgdGhhdCBtYWtlcyBhbiBlbGVtZW50IGFwcGx5IHRoZW1pbmcgcmVsYXRlZCBjbGFzc2VzIHRvIGl0c2VsZi5cbiAgICpcbiAgICogYGBganNcbiAgICogYXBwLmRpcmVjdGl2ZSgnbXlGYW5jeURpcmVjdGl2ZScsIGZ1bmN0aW9uKCRtZFRoZW1pbmcpIHtcbiAgICogICByZXR1cm4ge1xuICAgKiAgICAgcmVzdHJpY3Q6ICdlJyxcbiAgICogICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbCwgYXR0cnMpIHtcbiAgICogICAgICAgJG1kVGhlbWluZyhlbCk7XG4gICAqICAgICB9XG4gICAqICAgfTtcbiAgICogfSk7XG4gICAqIGBgYFxuICAgKiBAcGFyYW0ge2VsPX0gZWxlbWVudCB0byBhcHBseSB0aGVtaW5nIHRvXG4gICAqL1xuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gVGhlbWluZ1NlcnZpY2UoJHJvb3RTY29wZSwgJGxvZykge1xuXG4gICAgYXBwbHlUaGVtZS5pbmhlcml0ID0gZnVuY3Rpb24oZWwsIHBhcmVudCkge1xuICAgICAgdmFyIGN0cmwgPSBwYXJlbnQuY29udHJvbGxlcignbWRUaGVtZScpO1xuXG4gICAgICB2YXIgYXR0clRoZW1lVmFsdWUgPSBlbC5hdHRyKCdtZC10aGVtZS13YXRjaCcpO1xuICAgICAgaWYgKCAoYWx3YXlzV2F0Y2hUaGVtZSB8fCBhbmd1bGFyLmlzRGVmaW5lZChhdHRyVGhlbWVWYWx1ZSkpICYmIGF0dHJUaGVtZVZhbHVlICE9ICdmYWxzZScpIHtcbiAgICAgICAgdmFyIGRlcmVnaXN0ZXJXYXRjaCA9ICRyb290U2NvcGUuJHdhdGNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBjdHJsICYmIGN0cmwuJG1kVGhlbWUgfHwgZGVmYXVsdFRoZW1lO1xuICAgICAgICB9LCBjaGFuZ2VUaGVtZSk7XG4gICAgICAgIGVsLm9uKCckZGVzdHJveScsIGRlcmVnaXN0ZXJXYXRjaCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgdGhlbWUgPSBjdHJsICYmIGN0cmwuJG1kVGhlbWUgfHwgZGVmYXVsdFRoZW1lO1xuICAgICAgICBjaGFuZ2VUaGVtZSh0aGVtZSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGNoYW5nZVRoZW1lKHRoZW1lKSB7XG4gICAgICAgIGlmICghcmVnaXN0ZXJlZCh0aGVtZSkpIHtcbiAgICAgICAgICAkbG9nLndhcm4oJ0F0dGVtcHRlZCB0byB1c2UgdW5yZWdpc3RlcmVkIHRoZW1lIFxcJycgKyB0aGVtZSArICdcXCcuICcgK1xuICAgICAgICAgICAgICAgICAgICAnUmVnaXN0ZXIgaXQgd2l0aCAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoKS4nKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb2xkVGhlbWUgPSBlbC5kYXRhKCckbWRUaGVtZU5hbWUnKTtcbiAgICAgICAgaWYgKG9sZFRoZW1lKSBlbC5yZW1vdmVDbGFzcygnbWQtJyArIG9sZFRoZW1lICsnLXRoZW1lJyk7XG4gICAgICAgIGVsLmFkZENsYXNzKCdtZC0nICsgdGhlbWUgKyAnLXRoZW1lJyk7XG4gICAgICAgIGVsLmRhdGEoJyRtZFRoZW1lTmFtZScsIHRoZW1lKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgYXBwbHlUaGVtZS5USEVNRVMgPSBhbmd1bGFyLmV4dGVuZCh7fSwgVEhFTUVTKTtcbiAgICBhcHBseVRoZW1lLmRlZmF1bHRUaGVtZSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gZGVmYXVsdFRoZW1lOyB9O1xuICAgIGFwcGx5VGhlbWUucmVnaXN0ZXJlZCA9IHJlZ2lzdGVyZWQ7XG5cbiAgICByZXR1cm4gYXBwbHlUaGVtZTtcblxuICAgIGZ1bmN0aW9uIHJlZ2lzdGVyZWQodGhlbWVOYW1lKSB7XG4gICAgICBpZiAodGhlbWVOYW1lID09PSB1bmRlZmluZWQgfHwgdGhlbWVOYW1lID09PSAnJykgcmV0dXJuIHRydWU7XG4gICAgICByZXR1cm4gYXBwbHlUaGVtZS5USEVNRVNbdGhlbWVOYW1lXSAhPT0gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFwcGx5VGhlbWUoc2NvcGUsIGVsKSB7XG4gICAgICAvLyBBbGxvdyB1cyB0byBiZSBpbnZva2VkIHZpYSBhIGxpbmtpbmcgZnVuY3Rpb24gc2lnbmF0dXJlLlxuICAgICAgaWYgKGVsID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgZWwgPSBzY29wZTtcbiAgICAgICAgc2NvcGUgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgICBpZiAoc2NvcGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBzY29wZSA9ICRyb290U2NvcGU7XG4gICAgICB9XG4gICAgICBhcHBseVRoZW1lLmluaGVyaXQoZWwsIGVsKTtcbiAgICB9XG4gIH1cbn1cblRoZW1pbmdQcm92aWRlci4kaW5qZWN0ID0gW1wiJG1kQ29sb3JQYWxldHRlXCJdO1xuXG5mdW5jdGlvbiBUaGVtaW5nRGlyZWN0aXZlKCRtZFRoZW1pbmcsICRpbnRlcnBvbGF0ZSwgJGxvZykge1xuICByZXR1cm4ge1xuICAgIHByaW9yaXR5OiAxMDAsXG4gICAgbGluazoge1xuICAgICAgcHJlOiBmdW5jdGlvbihzY29wZSwgZWwsIGF0dHJzKSB7XG4gICAgICAgIHZhciBjdHJsID0ge1xuICAgICAgICAgICRzZXRUaGVtZTogZnVuY3Rpb24odGhlbWUpIHtcbiAgICAgICAgICAgIGlmICghJG1kVGhlbWluZy5yZWdpc3RlcmVkKHRoZW1lKSkge1xuICAgICAgICAgICAgICAkbG9nLndhcm4oJ2F0dGVtcHRlZCB0byB1c2UgdW5yZWdpc3RlcmVkIHRoZW1lIFxcJycgKyB0aGVtZSArICdcXCcnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN0cmwuJG1kVGhlbWUgPSB0aGVtZTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGVsLmRhdGEoJyRtZFRoZW1lQ29udHJvbGxlcicsIGN0cmwpO1xuICAgICAgICBjdHJsLiRzZXRUaGVtZSgkaW50ZXJwb2xhdGUoYXR0cnMubWRUaGVtZSkoc2NvcGUpKTtcbiAgICAgICAgYXR0cnMuJG9ic2VydmUoJ21kVGhlbWUnLCBjdHJsLiRzZXRUaGVtZSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xufVxuVGhlbWluZ0RpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kVGhlbWluZ1wiLCBcIiRpbnRlcnBvbGF0ZVwiLCBcIiRsb2dcIl07XG5cbmZ1bmN0aW9uIFRoZW1hYmxlRGlyZWN0aXZlKCRtZFRoZW1pbmcpIHtcbiAgcmV0dXJuICRtZFRoZW1pbmc7XG59XG5UaGVtYWJsZURpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kVGhlbWluZ1wiXTtcblxuZnVuY3Rpb24gcGFyc2VSdWxlcyh0aGVtZSwgY29sb3JUeXBlLCBydWxlcykge1xuICBjaGVja1ZhbGlkUGFsZXR0ZSh0aGVtZSwgY29sb3JUeXBlKTtcblxuICBydWxlcyA9IHJ1bGVzLnJlcGxhY2UoL1RIRU1FX05BTUUvZywgdGhlbWUubmFtZSk7XG4gIHZhciBnZW5lcmF0ZWRSdWxlcyA9IFtdO1xuICB2YXIgY29sb3IgPSB0aGVtZS5jb2xvcnNbY29sb3JUeXBlXTtcblxuICB2YXIgdGhlbWVOYW1lUmVnZXggPSBuZXcgUmVnRXhwKCcubWQtJyArIHRoZW1lLm5hbWUgKyAnLXRoZW1lJywgJ2cnKTtcbiAgLy8gTWF0Y2hlcyAne3sgcHJpbWFyeS1jb2xvciB9fScsIGV0Y1xuICB2YXIgaHVlUmVnZXggPSBuZXcgUmVnRXhwKCcoXFwnfFwiKT97e1xcXFxzKignICsgY29sb3JUeXBlICsgJyktKGNvbG9yfGNvbnRyYXN0KS0/KFxcXFxkXFxcXC4/XFxcXGQqKT9cXFxccyp9fShcXFwifFxcJyk/JywnZycpO1xuICB2YXIgc2ltcGxlVmFyaWFibGVSZWdleCA9IC8nP1wiP1xce1xce1xccyooW2EtekEtWl0rKS0oQT9cXGQrfGh1ZVxcLVswLTNdfHNoYWRvdyktPyhcXGRcXC4/XFxkKik/XFxzKlxcfVxcfSc/XCI/L2c7XG4gIHZhciBwYWxldHRlID0gUEFMRVRURVNbY29sb3IubmFtZV07XG5cbiAgLy8gZmluZCBhbmQgcmVwbGFjZSBzaW1wbGUgdmFyaWFibGVzIHdoZXJlIHdlIHVzZSBhIHNwZWNpZmljIGh1ZSwgbm90IGFuIGVudGlyZSBwYWxldHRlXG4gIC8vIGVnLiBcInt7cHJpbWFyeS0xMDB9fVwiXG4gIC8vXFwoJyArIFRIRU1FX0NPTE9SX1RZUEVTLmpvaW4oJ1xcfCcpICsgJ1xcKSdcbiAgcnVsZXMgPSBydWxlcy5yZXBsYWNlKHNpbXBsZVZhcmlhYmxlUmVnZXgsIGZ1bmN0aW9uKG1hdGNoLCBjb2xvclR5cGUsIGh1ZSwgb3BhY2l0eSkge1xuICAgIGlmIChjb2xvclR5cGUgPT09ICdmb3JlZ3JvdW5kJykge1xuICAgICAgaWYgKGh1ZSA9PSAnc2hhZG93Jykge1xuICAgICAgICByZXR1cm4gdGhlbWUuZm9yZWdyb3VuZFNoYWRvdztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0aGVtZS5mb3JlZ3JvdW5kUGFsZXR0ZVtodWVdIHx8IHRoZW1lLmZvcmVncm91bmRQYWxldHRlWycxJ107XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChodWUuaW5kZXhPZignaHVlJykgPT09IDApIHtcbiAgICAgIGh1ZSA9IHRoZW1lLmNvbG9yc1tjb2xvclR5cGVdLmh1ZXNbaHVlXTtcbiAgICB9XG4gICAgcmV0dXJuIHJnYmEoIChQQUxFVFRFU1sgdGhlbWUuY29sb3JzW2NvbG9yVHlwZV0ubmFtZSBdW2h1ZV0gfHwgJycpLnZhbHVlLCBvcGFjaXR5ICk7XG4gIH0pO1xuXG4gIC8vIEZvciBlYWNoIHR5cGUsIGdlbmVyYXRlIHJ1bGVzIGZvciBlYWNoIGh1ZSAoaWUuIGRlZmF1bHQsIG1kLWh1ZS0xLCBtZC1odWUtMiwgbWQtaHVlLTMpXG4gIGFuZ3VsYXIuZm9yRWFjaChjb2xvci5odWVzLCBmdW5jdGlvbihodWVWYWx1ZSwgaHVlTmFtZSkge1xuICAgIHZhciBuZXdSdWxlID0gcnVsZXNcbiAgICAgIC5yZXBsYWNlKGh1ZVJlZ2V4LCBmdW5jdGlvbihtYXRjaCwgXywgY29sb3JUeXBlLCBodWVUeXBlLCBvcGFjaXR5KSB7XG4gICAgICAgIHJldHVybiByZ2JhKHBhbGV0dGVbaHVlVmFsdWVdW2h1ZVR5cGUgPT09ICdjb2xvcicgPyAndmFsdWUnIDogJ2NvbnRyYXN0J10sIG9wYWNpdHkpO1xuICAgICAgfSk7XG4gICAgaWYgKGh1ZU5hbWUgIT09ICdkZWZhdWx0Jykge1xuICAgICAgbmV3UnVsZSA9IG5ld1J1bGUucmVwbGFjZSh0aGVtZU5hbWVSZWdleCwgJy5tZC0nICsgdGhlbWUubmFtZSArICctdGhlbWUubWQtJyArIGh1ZU5hbWUpO1xuICAgIH1cblxuICAgIC8vIERvbid0IGFwcGx5IGEgc2VsZWN0b3IgcnVsZSB0byB0aGUgZGVmYXVsdCB0aGVtZSwgbWFraW5nIGl0IGVhc2llciB0byBvdmVycmlkZVxuICAgIC8vIHN0eWxlcyBvZiB0aGUgYmFzZS1jb21wb25lbnRcbiAgICBpZiAodGhlbWUubmFtZSA9PSAnZGVmYXVsdCcpIHtcbiAgICAgIG5ld1J1bGUgPSBuZXdSdWxlLnJlcGxhY2UoL1xcLm1kLWRlZmF1bHQtdGhlbWUvZywgJycpO1xuICAgIH1cbiAgICBnZW5lcmF0ZWRSdWxlcy5wdXNoKG5ld1J1bGUpO1xuICB9KTtcblxuICByZXR1cm4gZ2VuZXJhdGVkUnVsZXM7XG59XG5cbi8vIEdlbmVyYXRlIG91ciB0aGVtZXMgYXQgcnVuIHRpbWUgZ2l2ZW4gdGhlIHN0YXRlIG9mIFRIRU1FUyBhbmQgUEFMRVRURVNcbmZ1bmN0aW9uIGdlbmVyYXRlVGhlbWVzKCRpbmplY3Rvcikge1xuXG4gIHZhciBoZWFkID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVswXTtcbiAgdmFyIGZpcnN0Q2hpbGQgPSBoZWFkID8gaGVhZC5maXJzdEVsZW1lbnRDaGlsZCA6IG51bGw7XG4gIHZhciB0aGVtZUNzcyA9ICRpbmplY3Rvci5oYXMoJyRNRF9USEVNRV9DU1MnKSA/ICRpbmplY3Rvci5nZXQoJyRNRF9USEVNRV9DU1MnKSA6ICcnO1xuXG4gIGlmICggIWZpcnN0Q2hpbGQgKSByZXR1cm47XG4gIGlmICh0aGVtZUNzcy5sZW5ndGggPT09IDApIHJldHVybjsgLy8gbm8gcnVsZXMsIHNvIG5vIHBvaW50IGluIHJ1bm5pbmcgdGhpcyBleHBlbnNpdmUgdGFza1xuXG4gIC8vIEV4cG9zZSBjb250cmFzdCBjb2xvcnMgZm9yIHBhbGV0dGVzIHRvIGVuc3VyZSB0aGF0IHRleHQgaXMgYWx3YXlzIHJlYWRhYmxlXG4gIGFuZ3VsYXIuZm9yRWFjaChQQUxFVFRFUywgc2FuaXRpemVQYWxldHRlKTtcblxuICAvLyBNRF9USEVNRV9DU1MgaXMgYSBzdHJpbmcgZ2VuZXJhdGVkIGJ5IHRoZSBidWlsZCBwcm9jZXNzIHRoYXQgaW5jbHVkZXMgYWxsIHRoZSB0aGVtYWJsZVxuICAvLyBjb21wb25lbnRzIGFzIHRlbXBsYXRlc1xuXG4gIC8vIEJyZWFrIHRoZSBDU1MgaW50byBpbmRpdmlkdWFsIHJ1bGVzXG4gIHZhciBydWxlc0J5VHlwZSA9IHt9O1xuICB2YXIgcnVsZXMgPSB0aGVtZUNzc1xuICAgICAgICAgICAgICAgICAgLnNwbGl0KC9cXH0oPyEoXFx9fCd8XCJ8OykpLylcbiAgICAgICAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24ocnVsZSkgeyByZXR1cm4gcnVsZSAmJiBydWxlLmxlbmd0aDsgfSlcbiAgICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24ocnVsZSkgeyByZXR1cm4gcnVsZS50cmltKCkgKyAnfSc7IH0pO1xuXG5cbiAgdmFyIHJ1bGVNYXRjaFJlZ2V4ID0gbmV3IFJlZ0V4cCgnbWQtKCcgKyBUSEVNRV9DT0xPUl9UWVBFUy5qb2luKCd8JykgKyAnKScsICdnJyk7XG5cbiAgVEhFTUVfQ09MT1JfVFlQRVMuZm9yRWFjaChmdW5jdGlvbih0eXBlKSB7XG4gICAgcnVsZXNCeVR5cGVbdHlwZV0gPSAnJztcbiAgfSk7XG5cblxuICAvLyBTb3J0IHRoZSBydWxlcyBiYXNlZCBvbiB0eXBlLCBhbGxvd2luZyB1cyB0byBkbyBjb2xvciBzdWJzdGl0dXRpb24gb24gYSBwZXItdHlwZSBiYXNpc1xuICBydWxlcy5mb3JFYWNoKGZ1bmN0aW9uKHJ1bGUpIHtcbiAgICB2YXIgbWF0Y2ggPSBydWxlLm1hdGNoKHJ1bGVNYXRjaFJlZ2V4KTtcbiAgICAvLyBGaXJzdDogdGVzdCB0aGF0IGlmIHRoZSBydWxlIGhhcyAnLm1kLWFjY2VudCcsIGl0IGdvZXMgaW50byB0aGUgYWNjZW50IHNldCBvZiBydWxlc1xuICAgIGZvciAodmFyIGkgPSAwLCB0eXBlOyB0eXBlID0gVEhFTUVfQ09MT1JfVFlQRVNbaV07IGkrKykge1xuICAgICAgaWYgKHJ1bGUuaW5kZXhPZignLm1kLScgKyB0eXBlKSA+IC0xKSB7XG4gICAgICAgIHJldHVybiBydWxlc0J5VHlwZVt0eXBlXSArPSBydWxlO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIElmIG5vIGVnICdtZC1hY2NlbnQnIGNsYXNzIGlzIGZvdW5kLCB0cnkgdG8ganVzdCBmaW5kICdhY2NlbnQnIGluIHRoZSBydWxlIGFuZCBndWVzcyBmcm9tXG4gICAgLy8gdGhlcmVcbiAgICBmb3IgKGkgPSAwOyB0eXBlID0gVEhFTUVfQ09MT1JfVFlQRVNbaV07IGkrKykge1xuICAgICAgaWYgKHJ1bGUuaW5kZXhPZih0eXBlKSA+IC0xKSB7XG4gICAgICAgIHJldHVybiBydWxlc0J5VHlwZVt0eXBlXSArPSBydWxlO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIERlZmF1bHQgdG8gdGhlIHByaW1hcnkgYXJyYXlcbiAgICByZXR1cm4gcnVsZXNCeVR5cGVbREVGQVVMVF9DT0xPUl9UWVBFXSArPSBydWxlO1xuICB9KTtcblxuICAgIC8vIEZvciBlYWNoIHRoZW1lLCB1c2UgdGhlIGNvbG9yIHBhbGV0dGVzIHNwZWNpZmllZCBmb3JcbiAgICAvLyBgcHJpbWFyeWAsIGB3YXJuYCBhbmQgYGFjY2VudGAgdG8gZ2VuZXJhdGUgQ1NTIHJ1bGVzLlxuXG4gICAgYW5ndWxhci5mb3JFYWNoKFRIRU1FUywgZnVuY3Rpb24odGhlbWUpIHtcbiAgICAgIGlmICggIUdFTkVSQVRFRFt0aGVtZS5uYW1lXSApIHtcblxuXG4gICAgICAgIFRIRU1FX0NPTE9SX1RZUEVTLmZvckVhY2goZnVuY3Rpb24oY29sb3JUeXBlKSB7XG4gICAgICAgICAgdmFyIHN0eWxlU3RyaW5ncyA9IHBhcnNlUnVsZXModGhlbWUsIGNvbG9yVHlwZSwgcnVsZXNCeVR5cGVbY29sb3JUeXBlXSk7XG4gICAgICAgICAgd2hpbGUgKHN0eWxlU3RyaW5ncy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHZhciBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XG4gICAgICAgICAgICAgICAgc3R5bGUuc2V0QXR0cmlidXRlKCd0eXBlJywgJ3RleHQvY3NzJyk7XG4gICAgICAgICAgICBzdHlsZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShzdHlsZVN0cmluZ3Muc2hpZnQoKSkpO1xuICAgICAgICAgICAgaGVhZC5pbnNlcnRCZWZvcmUoc3R5bGUsIGZpcnN0Q2hpbGQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cblxuICAgICAgICBpZiAodGhlbWUuY29sb3JzLnByaW1hcnkubmFtZSA9PSB0aGVtZS5jb2xvcnMuYWNjZW50Lm5hbWUpIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oXCIkbWRUaGVtaW5nUHJvdmlkZXI6IFVzaW5nIHRoZSBzYW1lIHBhbGV0dGUgZm9yIHByaW1hcnkgYW5kXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICBcIiBhY2NlbnQuIFRoaXMgdmlvbGF0ZXMgdGhlIG1hdGVyaWFsIGRlc2lnbiBzcGVjLlwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIEdFTkVSQVRFRFt0aGVtZS5uYW1lXSA9IHRydWU7XG4gICAgICB9XG4gICAgfSk7XG5cblxuICAvLyAqKioqKioqKioqKioqKioqKioqKioqKioqXG4gIC8vIEludGVybmFsIGZ1bmN0aW9uc1xuICAvLyAqKioqKioqKioqKioqKioqKioqKioqKioqXG5cbiAgLy8gVGhlIHVzZXIgc3BlY2lmaWVzIGEgJ2RlZmF1bHQnIGNvbnRyYXN0IGNvbG9yIGFzIGVpdGhlciBsaWdodCBvciBkYXJrLFxuICAvLyB0aGVuIGV4cGxpY2l0bHkgbGlzdHMgd2hpY2ggaHVlcyBhcmUgdGhlIG9wcG9zaXRlIGNvbnRyYXN0IChlZy4gQTEwMCBoYXMgZGFyaywgQTIwMCBoYXMgbGlnaHQpXG4gIGZ1bmN0aW9uIHNhbml0aXplUGFsZXR0ZShwYWxldHRlKSB7XG4gICAgdmFyIGRlZmF1bHRDb250cmFzdCA9IHBhbGV0dGUuY29udHJhc3REZWZhdWx0Q29sb3I7XG4gICAgdmFyIGxpZ2h0Q29sb3JzID0gcGFsZXR0ZS5jb250cmFzdExpZ2h0Q29sb3JzIHx8IFtdO1xuICAgIHZhciBzdHJvbmdMaWdodENvbG9ycyA9IHBhbGV0dGUuY29udHJhc3RTdHJvbmdMaWdodENvbG9ycyB8fCBbXTtcbiAgICB2YXIgZGFya0NvbG9ycyA9IHBhbGV0dGUuY29udHJhc3REYXJrQ29sb3JzIHx8IFtdO1xuXG4gICAgLy8gVGhlc2UgY29sb3JzIGFyZSBwcm92aWRlZCBhcyBzcGFjZS1zZXBhcmF0ZWQgbGlzdHNcbiAgICBpZiAodHlwZW9mIGxpZ2h0Q29sb3JzID09PSAnc3RyaW5nJykgbGlnaHRDb2xvcnMgPSBsaWdodENvbG9ycy5zcGxpdCgnICcpO1xuICAgIGlmICh0eXBlb2Ygc3Ryb25nTGlnaHRDb2xvcnMgPT09ICdzdHJpbmcnKSBzdHJvbmdMaWdodENvbG9ycyA9IHN0cm9uZ0xpZ2h0Q29sb3JzLnNwbGl0KCcgJyk7XG4gICAgaWYgKHR5cGVvZiBkYXJrQ29sb3JzID09PSAnc3RyaW5nJykgZGFya0NvbG9ycyA9IGRhcmtDb2xvcnMuc3BsaXQoJyAnKTtcblxuICAgIC8vIENsZWFudXAgYWZ0ZXIgb3Vyc2VsdmVzXG4gICAgZGVsZXRlIHBhbGV0dGUuY29udHJhc3REZWZhdWx0Q29sb3I7XG4gICAgZGVsZXRlIHBhbGV0dGUuY29udHJhc3RMaWdodENvbG9ycztcbiAgICBkZWxldGUgcGFsZXR0ZS5jb250cmFzdFN0cm9uZ0xpZ2h0Q29sb3JzO1xuICAgIGRlbGV0ZSBwYWxldHRlLmNvbnRyYXN0RGFya0NvbG9ycztcblxuICAgIC8vIENoYW5nZSB7ICdBMTAwJzogJyNmZmZlZWUnIH0gdG8geyAnQTEwMCc6IHsgdmFsdWU6ICcjZmZmZWVlJywgY29udHJhc3Q6REFSS19DT05UUkFTVF9DT0xPUiB9XG4gICAgYW5ndWxhci5mb3JFYWNoKHBhbGV0dGUsIGZ1bmN0aW9uKGh1ZVZhbHVlLCBodWVOYW1lKSB7XG4gICAgICBpZiAoYW5ndWxhci5pc09iamVjdChodWVWYWx1ZSkpIHJldHVybjsgLy8gQWxyZWFkeSBjb252ZXJ0ZWRcbiAgICAgIC8vIE1hcCBldmVyeXRoaW5nIHRvIHJnYiBjb2xvcnNcbiAgICAgIHZhciByZ2JWYWx1ZSA9IGNvbG9yVG9SZ2JhQXJyYXkoaHVlVmFsdWUpO1xuICAgICAgaWYgKCFyZ2JWYWx1ZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb2xvciAlMSwgaW4gcGFsZXR0ZSAlMidzIGh1ZSAlMywgaXMgaW52YWxpZC4gSGV4IG9yIHJnYihhKSBjb2xvciBleHBlY3RlZC5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoJyUxJywgaHVlVmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgnJTInLCBwYWxldHRlLm5hbWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgnJTMnLCBodWVOYW1lKSk7XG4gICAgICB9XG5cbiAgICAgIHBhbGV0dGVbaHVlTmFtZV0gPSB7XG4gICAgICAgIHZhbHVlOiByZ2JWYWx1ZSxcbiAgICAgICAgY29udHJhc3Q6IGdldENvbnRyYXN0Q29sb3IoKVxuICAgICAgfTtcbiAgICAgIGZ1bmN0aW9uIGdldENvbnRyYXN0Q29sb3IoKSB7XG4gICAgICAgIGlmIChkZWZhdWx0Q29udHJhc3QgPT09ICdsaWdodCcpIHtcbiAgICAgICAgICBpZiAoZGFya0NvbG9ycy5pbmRleE9mKGh1ZU5hbWUpID4gLTEpIHtcbiAgICAgICAgICAgIHJldHVybiBEQVJLX0NPTlRSQVNUX0NPTE9SO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gc3Ryb25nTGlnaHRDb2xvcnMuaW5kZXhPZihodWVOYW1lKSA+IC0xID8gU1RST05HX0xJR0hUX0NPTlRSQVNUX0NPTE9SXG4gICAgICAgICAgICAgIDogTElHSFRfQ09OVFJBU1RfQ09MT1I7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChsaWdodENvbG9ycy5pbmRleE9mKGh1ZU5hbWUpID4gLTEpIHtcbiAgICAgICAgICAgIHJldHVybiBzdHJvbmdMaWdodENvbG9ycy5pbmRleE9mKGh1ZU5hbWUpID4gLTEgPyBTVFJPTkdfTElHSFRfQ09OVFJBU1RfQ09MT1JcbiAgICAgICAgICAgICAgOiBMSUdIVF9DT05UUkFTVF9DT0xPUjtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIERBUktfQ09OVFJBU1RfQ09MT1I7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuXG59XG5nZW5lcmF0ZVRoZW1lcy4kaW5qZWN0ID0gW1wiJGluamVjdG9yXCJdO1xuXG5mdW5jdGlvbiBjaGVja1ZhbGlkUGFsZXR0ZSh0aGVtZSwgY29sb3JUeXBlKSB7XG4gIC8vIElmIHRoZW1lIGF0dGVtcHRzIHRvIHVzZSBhIHBhbGV0dGUgdGhhdCBkb2VzbnQgZXhpc3QsIHRocm93IGVycm9yXG4gIGlmICghUEFMRVRURVNbICh0aGVtZS5jb2xvcnNbY29sb3JUeXBlXSB8fCB7fSkubmFtZSBdKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgXCJZb3Ugc3VwcGxpZWQgYW4gaW52YWxpZCBjb2xvciBwYWxldHRlIGZvciB0aGVtZSAlMSdzICUyIHBhbGV0dGUuIEF2YWlsYWJsZSBwYWxldHRlczogJTNcIlxuICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgnJTEnLCB0aGVtZS5uYW1lKVxuICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgnJTInLCBjb2xvclR5cGUpXG4gICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKCclMycsIE9iamVjdC5rZXlzKFBBTEVUVEVTKS5qb2luKCcsICcpKVxuICAgICk7XG4gIH1cbn1cblxuZnVuY3Rpb24gY29sb3JUb1JnYmFBcnJheShjbHIpIHtcbiAgaWYgKGFuZ3VsYXIuaXNBcnJheShjbHIpICYmIGNsci5sZW5ndGggPT0gMykgcmV0dXJuIGNscjtcbiAgaWYgKC9ecmdiLy50ZXN0KGNscikpIHtcbiAgICByZXR1cm4gY2xyLnJlcGxhY2UoLyheXFxzKnJnYmE/XFwofFxcKVxccyokKS9nLCAnJykuc3BsaXQoJywnKS5tYXAoZnVuY3Rpb24odmFsdWUsIGkpIHtcbiAgICAgIHJldHVybiBpID09IDMgPyBwYXJzZUZsb2F0KHZhbHVlLCAxMCkgOiBwYXJzZUludCh2YWx1ZSwgMTApO1xuICAgIH0pO1xuICB9XG4gIGlmIChjbHIuY2hhckF0KDApID09ICcjJykgY2xyID0gY2xyLnN1YnN0cmluZygxKTtcbiAgaWYgKCEvXihbYS1mQS1GMC05XXszfSl7MSwyfSQvZy50ZXN0KGNscikpIHJldHVybjtcblxuICB2YXIgZGlnID0gY2xyLmxlbmd0aCAvIDM7XG4gIHZhciByZWQgPSBjbHIuc3Vic3RyKDAsIGRpZyk7XG4gIHZhciBncm4gPSBjbHIuc3Vic3RyKGRpZywgZGlnKTtcbiAgdmFyIGJsdSA9IGNsci5zdWJzdHIoZGlnICogMik7XG4gIGlmIChkaWcgPT09IDEpIHtcbiAgICByZWQgKz0gcmVkO1xuICAgIGdybiArPSBncm47XG4gICAgYmx1ICs9IGJsdTtcbiAgfVxuICByZXR1cm4gW3BhcnNlSW50KHJlZCwgMTYpLCBwYXJzZUludChncm4sIDE2KSwgcGFyc2VJbnQoYmx1LCAxNildO1xufVxuXG5mdW5jdGlvbiByZ2JhKHJnYkFycmF5LCBvcGFjaXR5KSB7XG4gIGlmICggIXJnYkFycmF5ICkgcmV0dXJuIFwicmdiKCcwLDAsMCcpXCI7XG5cbiAgaWYgKHJnYkFycmF5Lmxlbmd0aCA9PSA0KSB7XG4gICAgcmdiQXJyYXkgPSBhbmd1bGFyLmNvcHkocmdiQXJyYXkpO1xuICAgIG9wYWNpdHkgPyByZ2JBcnJheS5wb3AoKSA6IG9wYWNpdHkgPSByZ2JBcnJheS5wb3AoKTtcbiAgfVxuICByZXR1cm4gb3BhY2l0eSAmJiAodHlwZW9mIG9wYWNpdHkgPT0gJ251bWJlcicgfHwgKHR5cGVvZiBvcGFjaXR5ID09ICdzdHJpbmcnICYmIG9wYWNpdHkubGVuZ3RoKSkgP1xuICAgICdyZ2JhKCcgKyByZ2JBcnJheS5qb2luKCcsJykgKyAnLCcgKyBvcGFjaXR5ICsgJyknIDpcbiAgICAncmdiKCcgKyByZ2JBcnJheS5qb2luKCcsJykgKyAnKSc7XG59XG5cblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogQG5nZG9jIG1vZHVsZVxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5hdXRvY29tcGxldGVcbiAqL1xuLypcbiAqIEBzZWUganMgZm9sZGVyIGZvciBhdXRvY29tcGxldGUgaW1wbGVtZW50YXRpb25cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuYXV0b2NvbXBsZXRlJywgW1xuICAnbWF0ZXJpYWwuY29yZScsXG4gICdtYXRlcmlhbC5jb21wb25lbnRzLmljb24nXG5dKTtcblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qXG4gKiBAbmdkb2MgbW9kdWxlXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLmJhY2tkcm9wXG4gKiBAZGVzY3JpcHRpb24gQmFja2Ryb3BcbiAqL1xuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG1kQmFja2Ryb3BcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5iYWNrZHJvcFxuICpcbiAqIEByZXN0cmljdCBFXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBgPG1kLWJhY2tkcm9wPmAgaXMgYSBiYWNrZHJvcCBlbGVtZW50IHVzZWQgYnkgb3RoZXIgY29tcG9uZW50cywgc3VjaCBhcyBkaWFsb2cgYW5kIGJvdHRvbSBzaGVldC5cbiAqIEFwcGx5IGNsYXNzIGBvcGFxdWVgIHRvIG1ha2UgdGhlIGJhY2tkcm9wIHVzZSB0aGUgdGhlbWUgYmFja2Ryb3AgY29sb3IuXG4gKlxuICovXG5cbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmJhY2tkcm9wJywgW1xuICAnbWF0ZXJpYWwuY29yZSdcbl0pXG4gIC5kaXJlY3RpdmUoJ21kQmFja2Ryb3AnLCBCYWNrZHJvcERpcmVjdGl2ZSk7XG5cbmZ1bmN0aW9uIEJhY2tkcm9wRGlyZWN0aXZlKCRtZFRoZW1pbmcpIHtcbiAgcmV0dXJuICRtZFRoZW1pbmc7XG59XG5CYWNrZHJvcERpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kVGhlbWluZ1wiXTtcblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogQG5nZG9jIG1vZHVsZVxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5ib3R0b21TaGVldFxuICogQGRlc2NyaXB0aW9uXG4gKiBCb3R0b21TaGVldFxuICovXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5ib3R0b21TaGVldCcsIFtcbiAgJ21hdGVyaWFsLmNvcmUnLFxuICAnbWF0ZXJpYWwuY29tcG9uZW50cy5iYWNrZHJvcCdcbl0pXG4gIC5kaXJlY3RpdmUoJ21kQm90dG9tU2hlZXQnLCBNZEJvdHRvbVNoZWV0RGlyZWN0aXZlKVxuICAucHJvdmlkZXIoJyRtZEJvdHRvbVNoZWV0JywgTWRCb3R0b21TaGVldFByb3ZpZGVyKTtcblxuZnVuY3Rpb24gTWRCb3R0b21TaGVldERpcmVjdGl2ZSgpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0UnXG4gIH07XG59XG5cbi8qKlxuICogQG5nZG9jIHNlcnZpY2VcbiAqIEBuYW1lICRtZEJvdHRvbVNoZWV0XG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuYm90dG9tU2hlZXRcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIGAkbWRCb3R0b21TaGVldGAgb3BlbnMgYSBib3R0b20gc2hlZXQgb3ZlciB0aGUgYXBwIGFuZCBwcm92aWRlcyBhIHNpbXBsZSBwcm9taXNlIEFQSS5cbiAqXG4gKiAjIyBSZXN0cmljdGlvbnNcbiAqXG4gKiAtIFRoZSBib3R0b20gc2hlZXQncyB0ZW1wbGF0ZSBtdXN0IGhhdmUgYW4gb3V0ZXIgYDxtZC1ib3R0b20tc2hlZXQ+YCBlbGVtZW50LlxuICogLSBBZGQgdGhlIGBtZC1ncmlkYCBjbGFzcyB0byB0aGUgYm90dG9tIHNoZWV0IGZvciBhIGdyaWQgbGF5b3V0LlxuICogLSBBZGQgdGhlIGBtZC1saXN0YCBjbGFzcyB0byB0aGUgYm90dG9tIHNoZWV0IGZvciBhIGxpc3QgbGF5b3V0LlxuICpcbiAqIEB1c2FnZVxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cbiAqIDxkaXYgbmctY29udHJvbGxlcj1cIk15Q29udHJvbGxlclwiPlxuICogICA8bWQtYnV0dG9uIG5nLWNsaWNrPVwib3BlbkJvdHRvbVNoZWV0KClcIj5cbiAqICAgICBPcGVuIGEgQm90dG9tIFNoZWV0IVxuICogICA8L21kLWJ1dHRvbj5cbiAqIDwvZGl2PlxuICogPC9obGpzPlxuICogPGhsanMgbGFuZz1cImpzXCI+XG4gKiB2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFsnbmdNYXRlcmlhbCddKTtcbiAqIGFwcC5jb250cm9sbGVyKCdNeUNvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUsICRtZEJvdHRvbVNoZWV0KSB7XG4gKiAgICRzY29wZS5vcGVuQm90dG9tU2hlZXQgPSBmdW5jdGlvbigpIHtcbiAqICAgICAkbWRCb3R0b21TaGVldC5zaG93KHtcbiAqICAgICAgIHRlbXBsYXRlOiAnPG1kLWJvdHRvbS1zaGVldD5IZWxsbyE8L21kLWJvdHRvbS1zaGVldD4nXG4gKiAgICAgfSk7XG4gKiAgIH07XG4gKiB9KTtcbiAqIDwvaGxqcz5cbiAqL1xuXG4gLyoqXG4gKiBAbmdkb2MgbWV0aG9kXG4gKiBAbmFtZSAkbWRCb3R0b21TaGVldCNzaG93XG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBTaG93IGEgYm90dG9tIHNoZWV0IHdpdGggdGhlIHNwZWNpZmllZCBvcHRpb25zLlxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBvcHRpb25zIEFuIG9wdGlvbnMgb2JqZWN0LCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAqXG4gKiAgIC0gYHRlbXBsYXRlVXJsYCAtIGB7c3RyaW5nPX1gOiBUaGUgdXJsIG9mIGFuIGh0bWwgdGVtcGxhdGUgZmlsZSB0aGF0IHdpbGxcbiAqICAgYmUgdXNlZCBhcyB0aGUgY29udGVudCBvZiB0aGUgYm90dG9tIHNoZWV0LiBSZXN0cmljdGlvbnM6IHRoZSB0ZW1wbGF0ZSBtdXN0XG4gKiAgIGhhdmUgYW4gb3V0ZXIgYG1kLWJvdHRvbS1zaGVldGAgZWxlbWVudC5cbiAqICAgLSBgdGVtcGxhdGVgIC0gYHtzdHJpbmc9fWA6IFNhbWUgYXMgdGVtcGxhdGVVcmwsIGV4Y2VwdCB0aGlzIGlzIGFuIGFjdHVhbFxuICogICB0ZW1wbGF0ZSBzdHJpbmcuXG4gKiAgIC0gYHNjb3BlYCAtIGB7b2JqZWN0PX1gOiB0aGUgc2NvcGUgdG8gbGluayB0aGUgdGVtcGxhdGUgLyBjb250cm9sbGVyIHRvLiBJZiBub25lIGlzIHNwZWNpZmllZCwgaXQgd2lsbCBjcmVhdGUgYSBuZXcgY2hpbGQgc2NvcGUuXG4gKiAgICAgVGhpcyBzY29wZSB3aWxsIGJlIGRlc3Ryb3llZCB3aGVuIHRoZSBib3R0b20gc2hlZXQgaXMgcmVtb3ZlZCB1bmxlc3MgYHByZXNlcnZlU2NvcGVgIGlzIHNldCB0byB0cnVlLlxuICogICAtIGBwcmVzZXJ2ZVNjb3BlYCAtIGB7Ym9vbGVhbj19YDogd2hldGhlciB0byBwcmVzZXJ2ZSB0aGUgc2NvcGUgd2hlbiB0aGUgZWxlbWVudCBpcyByZW1vdmVkLiBEZWZhdWx0IGlzIGZhbHNlXG4gKiAgIC0gYGNvbnRyb2xsZXJgIC0gYHtzdHJpbmc9fWA6IFRoZSBjb250cm9sbGVyIHRvIGFzc29jaWF0ZSB3aXRoIHRoaXMgYm90dG9tIHNoZWV0LlxuICogICAtIGBsb2NhbHNgIC0gYHtzdHJpbmc9fWA6IEFuIG9iamVjdCBjb250YWluaW5nIGtleS92YWx1ZSBwYWlycy4gVGhlIGtleXMgd2lsbFxuICogICBiZSB1c2VkIGFzIG5hbWVzIG9mIHZhbHVlcyB0byBpbmplY3QgaW50byB0aGUgY29udHJvbGxlci4gRm9yIGV4YW1wbGUsXG4gKiAgIGBsb2NhbHM6IHt0aHJlZTogM31gIHdvdWxkIGluamVjdCBgdGhyZWVgIGludG8gdGhlIGNvbnRyb2xsZXIgd2l0aCB0aGUgdmFsdWVcbiAqICAgb2YgMy5cbiAqICAgLSBgdGFyZ2V0RXZlbnRgIC0gYHtET01DbGlja0V2ZW50PX1gOiBBIGNsaWNrJ3MgZXZlbnQgb2JqZWN0LiBXaGVuIHBhc3NlZCBpbiBhcyBhbiBvcHRpb24sXG4gKiAgIHRoZSBsb2NhdGlvbiBvZiB0aGUgY2xpY2sgd2lsbCBiZSB1c2VkIGFzIHRoZSBzdGFydGluZyBwb2ludCBmb3IgdGhlIG9wZW5pbmcgYW5pbWF0aW9uXG4gKiAgIG9mIHRoZSB0aGUgZGlhbG9nLlxuICogICAtIGByZXNvbHZlYCAtIGB7b2JqZWN0PX1gOiBTaW1pbGFyIHRvIGxvY2FscywgZXhjZXB0IGl0IHRha2VzIHByb21pc2VzIGFzIHZhbHVlc1xuICogICBhbmQgdGhlIGJvdHRvbSBzaGVldCB3aWxsIG5vdCBvcGVuIHVudGlsIHRoZSBwcm9taXNlcyByZXNvbHZlLlxuICogICAtIGBjb250cm9sbGVyQXNgIC0gYHtzdHJpbmc9fWA6IEFuIGFsaWFzIHRvIGFzc2lnbiB0aGUgY29udHJvbGxlciB0byBvbiB0aGUgc2NvcGUuXG4gKiAgIC0gYHBhcmVudGAgLSBge2VsZW1lbnQ9fWA6IFRoZSBlbGVtZW50IHRvIGFwcGVuZCB0aGUgYm90dG9tIHNoZWV0IHRvLiBUaGUgYHBhcmVudGAgbWF5IGJlIGEgYGZ1bmN0aW9uYCwgYHN0cmluZ2AsXG4gKiAgIGBvYmplY3RgLCBvciBudWxsLiBEZWZhdWx0cyB0byBhcHBlbmRpbmcgdG8gdGhlIGJvZHkgb2YgdGhlIHJvb3QgZWxlbWVudCAob3IgdGhlIHJvb3QgZWxlbWVudCkgb2YgdGhlIGFwcGxpY2F0aW9uLlxuICogICBlLmcuIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udGVudCcpKSBvciBcIiNjb250ZW50XCJcbiAqICAgLSBgZGlzYWJsZVBhcmVudFNjcm9sbGAgLSBge2Jvb2xlYW49fWA6IFdoZXRoZXIgdG8gZGlzYWJsZSBzY3JvbGxpbmcgd2hpbGUgdGhlIGJvdHRvbSBzaGVldCBpcyBvcGVuLlxuICogICAgIERlZmF1bHQgdHJ1ZS5cbiAqXG4gKiBAcmV0dXJucyB7cHJvbWlzZX0gQSBwcm9taXNlIHRoYXQgY2FuIGJlIHJlc29sdmVkIHdpdGggYCRtZEJvdHRvbVNoZWV0LmhpZGUoKWAgb3JcbiAqIHJlamVjdGVkIHdpdGggYCRtZEJvdHRvbVNoZWV0LmNhbmNlbCgpYC5cbiAqL1xuXG4vKipcbiAqIEBuZ2RvYyBtZXRob2RcbiAqIEBuYW1lICRtZEJvdHRvbVNoZWV0I2hpZGVcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIEhpZGUgdGhlIGV4aXN0aW5nIGJvdHRvbSBzaGVldCBhbmQgcmVzb2x2ZSB0aGUgcHJvbWlzZSByZXR1cm5lZCBmcm9tXG4gKiBgJG1kQm90dG9tU2hlZXQuc2hvdygpYC4gVGhpcyBjYWxsIHdpbGwgY2xvc2UgdGhlIG1vc3QgcmVjZW50bHkgb3BlbmVkL2N1cnJlbnQgYm90dG9tc2hlZXQgKGlmIGFueSkuXG4gKlxuICogQHBhcmFtIHsqPX0gcmVzcG9uc2UgQW4gYXJndW1lbnQgZm9yIHRoZSByZXNvbHZlZCBwcm9taXNlLlxuICpcbiAqL1xuXG4vKipcbiAqIEBuZ2RvYyBtZXRob2RcbiAqIEBuYW1lICRtZEJvdHRvbVNoZWV0I2NhbmNlbFxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogSGlkZSB0aGUgZXhpc3RpbmcgYm90dG9tIHNoZWV0IGFuZCByZWplY3QgdGhlIHByb21pc2UgcmV0dXJuZWQgZnJvbVxuICogYCRtZEJvdHRvbVNoZWV0LnNob3coKWAuXG4gKlxuICogQHBhcmFtIHsqPX0gcmVzcG9uc2UgQW4gYXJndW1lbnQgZm9yIHRoZSByZWplY3RlZCBwcm9taXNlLlxuICpcbiAqL1xuXG5mdW5jdGlvbiBNZEJvdHRvbVNoZWV0UHJvdmlkZXIoJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyKSB7XG4gIC8vIGhvdyBmYXN0IHdlIG5lZWQgdG8gZmxpY2sgZG93biB0byBjbG9zZSB0aGUgc2hlZXQsIHBpeGVscy9tc1xuICB2YXIgQ0xPU0lOR19WRUxPQ0lUWSA9IDAuNTtcbiAgdmFyIFBBRERJTkcgPSA4MDsgLy8gc2FtZSBhcyBjc3NcblxuICBib3R0b21TaGVldERlZmF1bHRzLiRpbmplY3QgPSBbXCIkYW5pbWF0ZVwiLCBcIiRtZENvbnN0YW50XCIsIFwiJG1kVXRpbFwiLCBcIiR0aW1lb3V0XCIsIFwiJGNvbXBpbGVcIiwgXCIkbWRUaGVtaW5nXCIsIFwiJG1kQm90dG9tU2hlZXRcIiwgXCIkcm9vdEVsZW1lbnRcIiwgXCIkbWRHZXN0dXJlXCJdO1xuICByZXR1cm4gJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyKCckbWRCb3R0b21TaGVldCcpXG4gICAgLnNldERlZmF1bHRzKHtcbiAgICAgIG1ldGhvZHM6IFsnZGlzYWJsZVBhcmVudFNjcm9sbCcsICdlc2NhcGVUb0Nsb3NlJywgJ3RhcmdldEV2ZW50J10sXG4gICAgICBvcHRpb25zOiBib3R0b21TaGVldERlZmF1bHRzXG4gICAgfSk7XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIGJvdHRvbVNoZWV0RGVmYXVsdHMoJGFuaW1hdGUsICRtZENvbnN0YW50LCAkbWRVdGlsLCAkdGltZW91dCwgJGNvbXBpbGUsICRtZFRoZW1pbmcsICRtZEJvdHRvbVNoZWV0LCAkcm9vdEVsZW1lbnQsICRtZEdlc3R1cmUpIHtcbiAgICB2YXIgYmFja2Ryb3A7XG5cbiAgICByZXR1cm4ge1xuICAgICAgdGhlbWFibGU6IHRydWUsXG4gICAgICB0YXJnZXRFdmVudDogbnVsbCxcbiAgICAgIG9uU2hvdzogb25TaG93LFxuICAgICAgb25SZW1vdmU6IG9uUmVtb3ZlLFxuICAgICAgZXNjYXBlVG9DbG9zZTogdHJ1ZSxcbiAgICAgIGRpc2FibGVQYXJlbnRTY3JvbGw6IHRydWVcbiAgICB9O1xuXG5cbiAgICBmdW5jdGlvbiBvblNob3coc2NvcGUsIGVsZW1lbnQsIG9wdGlvbnMpIHtcblxuICAgICAgZWxlbWVudCA9ICRtZFV0aWwuZXh0cmFjdEVsZW1lbnRCeU5hbWUoZWxlbWVudCwgJ21kLWJvdHRvbS1zaGVldCcpO1xuXG4gICAgICAvLyBBZGQgYSBiYWNrZHJvcCB0aGF0IHdpbGwgY2xvc2Ugb24gY2xpY2tcbiAgICAgIGJhY2tkcm9wID0gJGNvbXBpbGUoJzxtZC1iYWNrZHJvcCBjbGFzcz1cIm1kLW9wYXF1ZSBtZC1ib3R0b20tc2hlZXQtYmFja2Ryb3BcIj4nKShzY29wZSk7XG4gICAgICBiYWNrZHJvcC5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgJHRpbWVvdXQoJG1kQm90dG9tU2hlZXQuY2FuY2VsKTtcbiAgICAgIH0pO1xuICAgICAgJG1kVGhlbWluZy5pbmhlcml0KGJhY2tkcm9wLCBvcHRpb25zLnBhcmVudCk7XG5cbiAgICAgICRhbmltYXRlLmVudGVyKGJhY2tkcm9wLCBvcHRpb25zLnBhcmVudCwgbnVsbCk7XG5cbiAgICAgIHZhciBib3R0b21TaGVldCA9IG5ldyBCb3R0b21TaGVldChlbGVtZW50LCBvcHRpb25zLnBhcmVudCk7XG4gICAgICBvcHRpb25zLmJvdHRvbVNoZWV0ID0gYm90dG9tU2hlZXQ7XG5cbiAgICAgIC8vIEdpdmUgdXAgZm9jdXMgb24gY2FsbGluZyBpdGVtXG4gICAgICBvcHRpb25zLnRhcmdldEV2ZW50ICYmIGFuZ3VsYXIuZWxlbWVudChvcHRpb25zLnRhcmdldEV2ZW50LnRhcmdldCkuYmx1cigpO1xuICAgICAgJG1kVGhlbWluZy5pbmhlcml0KGJvdHRvbVNoZWV0LmVsZW1lbnQsIG9wdGlvbnMucGFyZW50KTtcblxuICAgICAgaWYgKG9wdGlvbnMuZGlzYWJsZVBhcmVudFNjcm9sbCkge1xuICAgICAgICBvcHRpb25zLmxhc3RPdmVyZmxvdyA9IG9wdGlvbnMucGFyZW50LmNzcygnb3ZlcmZsb3cnKTtcbiAgICAgICAgb3B0aW9ucy5wYXJlbnQuY3NzKCdvdmVyZmxvdycsICdoaWRkZW4nKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuICRhbmltYXRlLmVudGVyKGJvdHRvbVNoZWV0LmVsZW1lbnQsIG9wdGlvbnMucGFyZW50KVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgZm9jdXNhYmxlID0gYW5ndWxhci5lbGVtZW50KFxuICAgICAgICAgICAgZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCdidXR0b24nKSB8fFxuICAgICAgICAgICAgZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCdhJykgfHxcbiAgICAgICAgICAgIGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignW25nLWNsaWNrXScpXG4gICAgICAgICAgKTtcbiAgICAgICAgICBmb2N1c2FibGUuZm9jdXMoKTtcblxuICAgICAgICAgIGlmIChvcHRpb25zLmVzY2FwZVRvQ2xvc2UpIHtcbiAgICAgICAgICAgIG9wdGlvbnMucm9vdEVsZW1lbnRLZXl1cENhbGxiYWNrID0gZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09PSAkbWRDb25zdGFudC5LRVlfQ09ERS5FU0NBUEUpIHtcbiAgICAgICAgICAgICAgICAkdGltZW91dCgkbWRCb3R0b21TaGVldC5jYW5jZWwpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgJHJvb3RFbGVtZW50Lm9uKCdrZXl1cCcsIG9wdGlvbnMucm9vdEVsZW1lbnRLZXl1cENhbGxiYWNrKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25SZW1vdmUoc2NvcGUsIGVsZW1lbnQsIG9wdGlvbnMpIHtcblxuICAgICAgdmFyIGJvdHRvbVNoZWV0ID0gb3B0aW9ucy5ib3R0b21TaGVldDtcblxuICAgICAgJGFuaW1hdGUubGVhdmUoYmFja2Ryb3ApO1xuICAgICAgcmV0dXJuICRhbmltYXRlLmxlYXZlKGJvdHRvbVNoZWV0LmVsZW1lbnQpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChvcHRpb25zLmRpc2FibGVQYXJlbnRTY3JvbGwpIHtcbiAgICAgICAgICBvcHRpb25zLnBhcmVudC5jc3MoJ292ZXJmbG93Jywgb3B0aW9ucy5sYXN0T3ZlcmZsb3cpO1xuICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmxhc3RPdmVyZmxvdztcbiAgICAgICAgfVxuXG4gICAgICAgIGJvdHRvbVNoZWV0LmNsZWFudXAoKTtcblxuICAgICAgICAvLyBSZXN0b3JlIGZvY3VzXG4gICAgICAgIG9wdGlvbnMudGFyZ2V0RXZlbnQgJiYgYW5ndWxhci5lbGVtZW50KG9wdGlvbnMudGFyZ2V0RXZlbnQudGFyZ2V0KS5mb2N1cygpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQm90dG9tU2hlZXQgY2xhc3MgdG8gYXBwbHkgYm90dG9tLXNoZWV0IGJlaGF2aW9yIHRvIGFuIGVsZW1lbnRcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBCb3R0b21TaGVldChlbGVtZW50LCBwYXJlbnQpIHtcbiAgICAgIHZhciBkZXJlZ2lzdGVyID0gJG1kR2VzdHVyZS5yZWdpc3RlcihwYXJlbnQsICdkcmFnJywgeyBob3Jpem9udGFsOiBmYWxzZSB9KTtcbiAgICAgIHBhcmVudC5vbignJG1kLmRyYWdzdGFydCcsIG9uRHJhZ1N0YXJ0KVxuICAgICAgICAub24oJyRtZC5kcmFnJywgb25EcmFnKVxuICAgICAgICAub24oJyRtZC5kcmFnZW5kJywgb25EcmFnRW5kKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZWxlbWVudDogZWxlbWVudCxcbiAgICAgICAgY2xlYW51cDogZnVuY3Rpb24gY2xlYW51cCgpIHtcbiAgICAgICAgICBkZXJlZ2lzdGVyKCk7XG4gICAgICAgICAgcGFyZW50Lm9mZignJG1kLmRyYWdzdGFydCcsIG9uRHJhZ1N0YXJ0KVxuICAgICAgICAgICAgLm9mZignJG1kLmRyYWcnLCBvbkRyYWcpXG4gICAgICAgICAgICAub2ZmKCckbWQuZHJhZ2VuZCcsIG9uRHJhZ0VuZCk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGZ1bmN0aW9uIG9uRHJhZ1N0YXJ0KGV2KSB7XG4gICAgICAgIC8vIERpc2FibGUgdHJhbnNpdGlvbnMgb24gdHJhbnNmb3JtIHNvIHRoYXQgaXQgZmVlbHMgZmFzdFxuICAgICAgICBlbGVtZW50LmNzcygkbWRDb25zdGFudC5DU1MuVFJBTlNJVElPTl9EVVJBVElPTiwgJzBtcycpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBvbkRyYWcoZXYpIHtcbiAgICAgICAgdmFyIHRyYW5zZm9ybSA9IGV2LnBvaW50ZXIuZGlzdGFuY2VZO1xuICAgICAgICBpZiAodHJhbnNmb3JtIDwgNSkge1xuICAgICAgICAgIC8vIFNsb3cgZG93biBkcmFnIHdoZW4gdHJ5aW5nIHRvIGRyYWcgdXAsIGFuZCBzdG9wIGFmdGVyIFBBRERJTkdcbiAgICAgICAgICB0cmFuc2Zvcm0gPSBNYXRoLm1heCgtUEFERElORywgdHJhbnNmb3JtIC8gMik7XG4gICAgICAgIH1cbiAgICAgICAgZWxlbWVudC5jc3MoJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STSwgJ3RyYW5zbGF0ZTNkKDAsJyArIChQQURESU5HICsgdHJhbnNmb3JtKSArICdweCwwKScpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBvbkRyYWdFbmQoZXYpIHtcbiAgICAgICAgaWYgKGV2LnBvaW50ZXIuZGlzdGFuY2VZID4gMCAmJlxuICAgICAgICAgICAgKGV2LnBvaW50ZXIuZGlzdGFuY2VZID4gMjAgfHwgTWF0aC5hYnMoZXYucG9pbnRlci52ZWxvY2l0eVkpID4gQ0xPU0lOR19WRUxPQ0lUWSkpIHtcbiAgICAgICAgICB2YXIgZGlzdGFuY2VSZW1haW5pbmcgPSBlbGVtZW50LnByb3AoJ29mZnNldEhlaWdodCcpIC0gZXYucG9pbnRlci5kaXN0YW5jZVk7XG4gICAgICAgICAgdmFyIHRyYW5zaXRpb25EdXJhdGlvbiA9IE1hdGgubWluKGRpc3RhbmNlUmVtYWluaW5nIC8gZXYucG9pbnRlci52ZWxvY2l0eVkgKiAwLjc1LCA1MDApO1xuICAgICAgICAgIGVsZW1lbnQuY3NzKCRtZENvbnN0YW50LkNTUy5UUkFOU0lUSU9OX0RVUkFUSU9OLCB0cmFuc2l0aW9uRHVyYXRpb24gKyAnbXMnKTtcbiAgICAgICAgICAkdGltZW91dCgkbWRCb3R0b21TaGVldC5jYW5jZWwpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVsZW1lbnQuY3NzKCRtZENvbnN0YW50LkNTUy5UUkFOU0lUSU9OX0RVUkFUSU9OLCAnJyk7XG4gICAgICAgICAgZWxlbWVudC5jc3MoJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STSwgJycpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gIH1cblxufVxuTWRCb3R0b21TaGVldFByb3ZpZGVyLiRpbmplY3QgPSBbXCIkJGludGVyaW1FbGVtZW50UHJvdmlkZXJcIl07XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIEBuZ2RvYyBtb2R1bGVcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuYnV0dG9uXG4gKiBAZGVzY3JpcHRpb25cbiAqXG4gKiBCdXR0b25cbiAqL1xuYW5ndWxhclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuYnV0dG9uJywgWyAnbWF0ZXJpYWwuY29yZScgXSlcbiAgICAuZGlyZWN0aXZlKCdtZEJ1dHRvbicsIE1kQnV0dG9uRGlyZWN0aXZlKTtcblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBtZEJ1dHRvblxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmJ1dHRvblxuICpcbiAqIEByZXN0cmljdCBFXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBgPG1kLWJ1dHRvbj5gIGlzIGEgYnV0dG9uIGRpcmVjdGl2ZSB3aXRoIG9wdGlvbmFsIGluayByaXBwbGVzIChkZWZhdWx0IGVuYWJsZWQpLlxuICpcbiAqIElmIHlvdSBzdXBwbHkgYSBgaHJlZmAgb3IgYG5nLWhyZWZgIGF0dHJpYnV0ZSwgaXQgd2lsbCBiZWNvbWUgYW4gYDxhPmAgZWxlbWVudC4gT3RoZXJ3aXNlLCBpdCB3aWxsXG4gKiBiZWNvbWUgYSBgPGJ1dHRvbj5gIGVsZW1lbnQuIEFzIHBlciB0aGUgW01hdGVyaWFsIERlc2lnbiBzcGVjaWZpY2F0aW9uc10oaHR0cDovL3d3dy5nb29nbGUuY29tL2Rlc2lnbi9zcGVjL3N0eWxlL2NvbG9yLmh0bWwjY29sb3ItdWktY29sb3ItYXBwbGljYXRpb24pXG4gKiB0aGUgRkFCIGJ1dHRvbiBiYWNrZ3JvdW5kIGlzIGZpbGxlZCB3aXRoIHRoZSBhY2NlbnQgY29sb3IgW2J5IGRlZmF1bHRdLiBUaGUgcHJpbWFyeSBjb2xvciBwYWxldHRlIG1heSBiZSB1c2VkIHdpdGhcbiAqIHRoZSBgbWQtcHJpbWFyeWAgY2xhc3MuXG4gKlxuICogQHBhcmFtIHtib29sZWFuPX0gbWQtbm8taW5rIElmIHByZXNlbnQsIGRpc2FibGUgcmlwcGxlIGluayBlZmZlY3RzLlxuICogQHBhcmFtIHtleHByZXNzaW9uPX0gbmctZGlzYWJsZWQgRW4vRGlzYWJsZSBiYXNlZCBvbiB0aGUgZXhwcmVzc2lvblxuICogQHBhcmFtIHtzdHJpbmc9fSBtZC1yaXBwbGUtc2l6ZSBPdmVycmlkZXMgdGhlIGRlZmF1bHQgcmlwcGxlIHNpemUgbG9naWMuIE9wdGlvbnM6IGBmdWxsYCwgYHBhcnRpYWxgLCBgYXV0b2BcbiAqIEBwYXJhbSB7c3RyaW5nPX0gYXJpYS1sYWJlbCBBZGRzIGFsdGVybmF0aXZlIHRleHQgdG8gYnV0dG9uIGZvciBhY2Nlc3NpYmlsaXR5LCB1c2VmdWwgZm9yIGljb24gYnV0dG9ucy5cbiAqIElmIG5vIGRlZmF1bHQgdGV4dCBpcyBmb3VuZCwgYSB3YXJuaW5nIHdpbGwgYmUgbG9nZ2VkLlxuICpcbiAqIEB1c2FnZVxuICpcbiAqIFJlZ3VsYXIgYnV0dG9uczpcbiAqXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxuICogIDxtZC1idXR0b24+IEZsYXQgQnV0dG9uIDwvbWQtYnV0dG9uPlxuICogIDxtZC1idXR0b24gaHJlZj1cImh0dHA6Ly9nb29nbGUuY29tXCI+IEZsYXQgbGluayA8L21kLWJ1dHRvbj5cbiAqICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtcmFpc2VkXCI+IFJhaXNlZCBCdXR0b24gPC9tZC1idXR0b24+XG4gKiAgPG1kLWJ1dHRvbiBuZy1kaXNhYmxlZD1cInRydWVcIj4gRGlzYWJsZWQgQnV0dG9uIDwvbWQtYnV0dG9uPlxuICogIDxtZC1idXR0b24+XG4gKiAgICA8bWQtaWNvbiBtZC1zdmctc3JjPVwieW91ci9pY29uLnN2Z1wiPjwvbWQtaWNvbj5cbiAqICAgIFJlZ2lzdGVyIE5vd1xuICogIDwvbWQtYnV0dG9uPlxuICogPC9obGpzPlxuICpcbiAqIEZBQiBidXR0b25zOlxuICpcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiAgPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLWZhYlwiIGFyaWEtbGFiZWw9XCJGQUJcIj5cbiAqICAgIDxtZC1pY29uIG1kLXN2Zy1zcmM9XCJ5b3VyL2ljb24uc3ZnXCI+PC9tZC1pY29uPlxuICogIDwvbWQtYnV0dG9uPlxuICogIDwhLS0gbWluaS1GQUIgLS0+XG4gKiAgPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLWZhYiBtZC1taW5pXCIgYXJpYS1sYWJlbD1cIk1pbmkgRkFCXCI+XG4gKiAgICA8bWQtaWNvbiBtZC1zdmctc3JjPVwieW91ci9pY29uLnN2Z1wiPjwvbWQtaWNvbj5cbiAqICA8L21kLWJ1dHRvbj5cbiAqICA8IS0tIEJ1dHRvbiB3aXRoIFNWRyBJY29uIC0tPlxuICogIDxtZC1idXR0b24gY2xhc3M9XCJtZC1pY29uLWJ1dHRvblwiIGFyaWEtbGFiZWw9XCJDdXN0b20gSWNvbiBCdXR0b25cIj5cbiAqICAgIDxtZC1pY29uIG1kLXN2Zy1pY29uPVwicGF0aC90by95b3VyLnN2Z1wiPjwvbWQtaWNvbj5cbiAqICA8L21kLWJ1dHRvbj5cbiAqIDwvaGxqcz5cbiAqL1xuZnVuY3Rpb24gTWRCdXR0b25EaXJlY3RpdmUoJG1kQnV0dG9uSW5rUmlwcGxlLCAkbWRUaGVtaW5nLCAkbWRBcmlhLCAkdGltZW91dCkge1xuXG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdFQScsXG4gICAgcmVwbGFjZTogdHJ1ZSxcbiAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgIHRlbXBsYXRlOiBnZXRUZW1wbGF0ZSxcbiAgICBsaW5rOiBwb3N0TGlua1xuICB9O1xuXG4gIGZ1bmN0aW9uIGlzQW5jaG9yKGF0dHIpIHtcbiAgICByZXR1cm4gYW5ndWxhci5pc0RlZmluZWQoYXR0ci5ocmVmKSB8fCBhbmd1bGFyLmlzRGVmaW5lZChhdHRyLm5nSHJlZikgfHwgYW5ndWxhci5pc0RlZmluZWQoYXR0ci5uZ0xpbmspIHx8IGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHIudWlTcmVmKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFRlbXBsYXRlKGVsZW1lbnQsIGF0dHIpIHtcbiAgICByZXR1cm4gaXNBbmNob3IoYXR0cikgP1xuICAgICAgICAgICAnPGEgY2xhc3M9XCJtZC1idXR0b25cIiBuZy10cmFuc2NsdWRlPjwvYT4nIDpcbiAgICAgICAgICAgJzxidXR0b24gY2xhc3M9XCJtZC1idXR0b25cIiBuZy10cmFuc2NsdWRlPjwvYnV0dG9uPic7XG4gIH1cblxuICBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0cikge1xuICAgIHZhciBub2RlID0gZWxlbWVudFswXTtcbiAgICAkbWRUaGVtaW5nKGVsZW1lbnQpO1xuICAgICRtZEJ1dHRvbklua1JpcHBsZS5hdHRhY2goc2NvcGUsIGVsZW1lbnQpO1xuXG4gICAgdmFyIGVsZW1lbnRIYXNUZXh0ID0gbm9kZS50ZXh0Q29udGVudC50cmltKCk7XG4gICAgaWYgKCFlbGVtZW50SGFzVGV4dCkge1xuICAgICAgJG1kQXJpYS5leHBlY3QoZWxlbWVudCwgJ2FyaWEtbGFiZWwnKTtcbiAgICB9XG5cbiAgICAvLyBGb3IgYW5jaG9yIGVsZW1lbnRzLCB3ZSBoYXZlIHRvIHNldCB0YWJpbmRleCBtYW51YWxseSB3aGVuIHRoZVxuICAgIC8vIGVsZW1lbnQgaXMgZGlzYWJsZWRcbiAgICBpZiAoaXNBbmNob3IoYXR0cikgJiYgYW5ndWxhci5pc0RlZmluZWQoYXR0ci5uZ0Rpc2FibGVkKSApIHtcbiAgICAgIHNjb3BlLiR3YXRjaChhdHRyLm5nRGlzYWJsZWQsIGZ1bmN0aW9uKGlzRGlzYWJsZWQpIHtcbiAgICAgICAgZWxlbWVudC5hdHRyKCd0YWJpbmRleCcsIGlzRGlzYWJsZWQgPyAtMSA6IDApO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gZGlzYWJsaW5nIGNsaWNrIGV2ZW50IHdoZW4gZGlzYWJsZWQgaXMgdHJ1ZVxuICAgIGVsZW1lbnQub24oJ2NsaWNrJywgZnVuY3Rpb24oZSl7XG4gICAgICBpZiAoYXR0ci5kaXNhYmxlZCA9PT0gdHJ1ZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyByZXN0cmljdCBmb2N1cyBzdHlsZXMgdG8gdGhlIGtleWJvYXJkXG4gICAgc2NvcGUubW91c2VBY3RpdmUgPSBmYWxzZTtcbiAgICBlbGVtZW50Lm9uKCdtb3VzZWRvd24nLCBmdW5jdGlvbigpIHtcbiAgICAgICAgc2NvcGUubW91c2VBY3RpdmUgPSB0cnVlO1xuICAgICAgICAkdGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgIHNjb3BlLm1vdXNlQWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH0sIDEwMCk7XG4gICAgICB9KVxuICAgICAgLm9uKCdmb2N1cycsIGZ1bmN0aW9uKCkge1xuICAgICAgICBpZihzY29wZS5tb3VzZUFjdGl2ZSA9PT0gZmFsc2UpIHsgZWxlbWVudC5hZGRDbGFzcygnbWQtZm9jdXNlZCcpOyB9XG4gICAgICB9KVxuICAgICAgLm9uKCdibHVyJywgZnVuY3Rpb24oKSB7IGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21kLWZvY3VzZWQnKTsgfSk7XG4gIH1cblxufVxuTWRCdXR0b25EaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZEJ1dHRvbklua1JpcHBsZVwiLCBcIiRtZFRoZW1pbmdcIiwgXCIkbWRBcmlhXCIsIFwiJHRpbWVvdXRcIl07XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIEBuZ2RvYyBtb2R1bGVcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuY2FyZFxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogQ2FyZCBjb21wb25lbnRzLlxuICovXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5jYXJkJywgW1xuICAnbWF0ZXJpYWwuY29yZSdcbl0pXG4gIC5kaXJlY3RpdmUoJ21kQ2FyZCcsIG1kQ2FyZERpcmVjdGl2ZSk7XG5cblxuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG1kQ2FyZFxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmNhcmRcbiAqXG4gKiBAcmVzdHJpY3QgRVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogVGhlIGA8bWQtY2FyZD5gIGRpcmVjdGl2ZSBpcyBhIGNvbnRhaW5lciBlbGVtZW50IHVzZWQgd2l0aGluIGA8bWQtY29udGVudD5gIGNvbnRhaW5lcnMuXG4gKlxuICogQW4gaW1hZ2UgaW5jbHVkZWQgYXMgYSBkaXJlY3QgZGVzY2VuZGFudCB3aWxsIGZpbGwgdGhlIGNhcmQncyB3aWR0aCwgd2hpbGUgdGhlIGA8bWQtY2FyZC1jb250ZW50PmBcbiAqIGNvbnRhaW5lciB3aWxsIHdyYXAgdGV4dCBjb250ZW50IGFuZCBwcm92aWRlIHBhZGRpbmcuIEFuIGA8bWQtY2FyZC1mb290ZXI+YCBlbGVtZW50IGNhbiBiZVxuICogb3B0aW9uYWxseSBpbmNsdWRlZCB0byBwdXQgY29udGVudCBmbHVzaCBhZ2FpbnN0IHRoZSBib3R0b20gZWRnZSBvZiB0aGUgY2FyZC5cbiAqXG4gKiBBY3Rpb24gYnV0dG9ucyBjYW4gYmUgaW5jbHVkZWQgaW4gYW4gZWxlbWVudCB3aXRoIHRoZSBgLm1kLWFjdGlvbnNgIGNsYXNzLCBhbHNvIHVzZWQgaW4gYG1kLWRpYWxvZ2AuXG4gKiBZb3UgY2FuIHRoZW4gcG9zaXRpb24gYnV0dG9ucyB1c2luZyBsYXlvdXQgYXR0cmlidXRlcy5cbiAqXG4gKiBDYXJkcyBoYXZlIGNvbnN0YW50IHdpZHRoIGFuZCB2YXJpYWJsZSBoZWlnaHRzOyB3aGVyZSB0aGUgbWF4aW11bSBoZWlnaHQgaXMgbGltaXRlZCB0byB3aGF0IGNhblxuICogZml0IHdpdGhpbiBhIHNpbmdsZSB2aWV3IG9uIGEgcGxhdGZvcm0sIGJ1dCBpdCBjYW4gdGVtcG9yYXJpbHkgZXhwYW5kIGFzIG5lZWRlZC5cbiAqXG4gKiBAdXNhZ2VcbiAqICMjI0NhcmQgd2l0aCBvcHRpb25hbCBmb290ZXJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiA8bWQtY2FyZD5cbiAqICA8aW1nIHNyYz1cImNhcmQtaW1hZ2UucG5nXCIgY2xhc3M9XCJtZC1jYXJkLWltYWdlXCIgYWx0PVwiaW1hZ2UgY2FwdGlvblwiPlxuICogIDxtZC1jYXJkLWNvbnRlbnQ+XG4gKiAgICA8aDI+Q2FyZCBoZWFkbGluZTwvaDI+XG4gKiAgICA8cD5DYXJkIGNvbnRlbnQ8L3A+XG4gKiAgPC9tZC1jYXJkLWNvbnRlbnQ+XG4gKiAgPG1kLWNhcmQtZm9vdGVyPlxuICogICAgQ2FyZCBmb290ZXJcbiAqICA8L21kLWNhcmQtZm9vdGVyPlxuICogPC9tZC1jYXJkPlxuICogPC9obGpzPlxuICpcbiAqICMjI0NhcmQgd2l0aCBhY3Rpb25zXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxuICogPG1kLWNhcmQ+XG4gKiAgPGltZyBzcmM9XCJjYXJkLWltYWdlLnBuZ1wiIGNsYXNzPVwibWQtY2FyZC1pbWFnZVwiIGFsdD1cImltYWdlIGNhcHRpb25cIj5cbiAqICA8bWQtY2FyZC1jb250ZW50PlxuICogICAgPGgyPkNhcmQgaGVhZGxpbmU8L2gyPlxuICogICAgPHA+Q2FyZCBjb250ZW50PC9wPlxuICogIDwvbWQtY2FyZC1jb250ZW50PlxuICogIDxkaXYgY2xhc3M9XCJtZC1hY3Rpb25zXCIgbGF5b3V0PVwicm93XCIgbGF5b3V0LWFsaWduPVwiZW5kIGNlbnRlclwiPlxuICogICAgPG1kLWJ1dHRvbj5BY3Rpb24gMTwvbWQtYnV0dG9uPlxuICogICAgPG1kLWJ1dHRvbj5BY3Rpb24gMjwvbWQtYnV0dG9uPlxuICogIDwvZGl2PlxuICogPC9tZC1jYXJkPlxuICogPC9obGpzPlxuICpcbiAqL1xuZnVuY3Rpb24gbWRDYXJkRGlyZWN0aXZlKCRtZFRoZW1pbmcpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0UnLFxuICAgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRyKSB7XG4gICAgICAkbWRUaGVtaW5nKCRlbGVtZW50KTtcbiAgICB9XG4gIH07XG59XG5tZENhcmREaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZFRoZW1pbmdcIl07XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIEBuZ2RvYyBtb2R1bGVcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuY2hlY2tib3hcbiAqIEBkZXNjcmlwdGlvbiBDaGVja2JveCBtb2R1bGUhXG4gKi9cbmFuZ3VsYXJcbiAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5jaGVja2JveCcsIFsnbWF0ZXJpYWwuY29yZSddKVxuICAuZGlyZWN0aXZlKCdtZENoZWNrYm94JywgTWRDaGVja2JveERpcmVjdGl2ZSk7XG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbWRDaGVja2JveFxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmNoZWNrYm94XG4gKiBAcmVzdHJpY3QgRVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogVGhlIGNoZWNrYm94IGRpcmVjdGl2ZSBpcyB1c2VkIGxpa2UgdGhlIG5vcm1hbCBbYW5ndWxhciBjaGVja2JveF0oaHR0cHM6Ly9kb2NzLmFuZ3VsYXJqcy5vcmcvYXBpL25nL2lucHV0L2lucHV0JTVCY2hlY2tib3glNUQpLlxuICpcbiAqIEFzIHBlciB0aGUgW21hdGVyaWFsIGRlc2lnbiBzcGVjXShodHRwOi8vd3d3Lmdvb2dsZS5jb20vZGVzaWduL3NwZWMvc3R5bGUvY29sb3IuaHRtbCNjb2xvci11aS1jb2xvci1hcHBsaWNhdGlvbilcbiAqIHRoZSBjaGVja2JveCBpcyBpbiB0aGUgYWNjZW50IGNvbG9yIGJ5IGRlZmF1bHQuIFRoZSBwcmltYXJ5IGNvbG9yIHBhbGV0dGUgbWF5IGJlIHVzZWQgd2l0aFxuICogdGhlIGBtZC1wcmltYXJ5YCBjbGFzcy5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbmctbW9kZWwgQXNzaWduYWJsZSBhbmd1bGFyIGV4cHJlc3Npb24gdG8gZGF0YS1iaW5kIHRvLlxuICogQHBhcmFtIHtzdHJpbmc9fSBuYW1lIFByb3BlcnR5IG5hbWUgb2YgdGhlIGZvcm0gdW5kZXIgd2hpY2ggdGhlIGNvbnRyb2wgaXMgcHVibGlzaGVkLlxuICogQHBhcmFtIHtleHByZXNzaW9uPX0gbmctdHJ1ZS12YWx1ZSBUaGUgdmFsdWUgdG8gd2hpY2ggdGhlIGV4cHJlc3Npb24gc2hvdWxkIGJlIHNldCB3aGVuIHNlbGVjdGVkLlxuICogQHBhcmFtIHtleHByZXNzaW9uPX0gbmctZmFsc2UtdmFsdWUgVGhlIHZhbHVlIHRvIHdoaWNoIHRoZSBleHByZXNzaW9uIHNob3VsZCBiZSBzZXQgd2hlbiBub3Qgc2VsZWN0ZWQuXG4gKiBAcGFyYW0ge3N0cmluZz19IG5nLWNoYW5nZSBBbmd1bGFyIGV4cHJlc3Npb24gdG8gYmUgZXhlY3V0ZWQgd2hlbiBpbnB1dCBjaGFuZ2VzIGR1ZSB0byB1c2VyIGludGVyYWN0aW9uIHdpdGggdGhlIGlucHV0IGVsZW1lbnQuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBtZC1uby1pbmsgVXNlIG9mIGF0dHJpYnV0ZSBpbmRpY2F0ZXMgdXNlIG9mIHJpcHBsZSBpbmsgZWZmZWN0c1xuICogQHBhcmFtIHtzdHJpbmc9fSBhcmlhLWxhYmVsIEFkZHMgbGFiZWwgdG8gY2hlY2tib3ggZm9yIGFjY2Vzc2liaWxpdHkuXG4gKiBEZWZhdWx0cyB0byBjaGVja2JveCdzIHRleHQuIElmIG5vIGRlZmF1bHQgdGV4dCBpcyBmb3VuZCwgYSB3YXJuaW5nIHdpbGwgYmUgbG9nZ2VkLlxuICpcbiAqIEB1c2FnZVxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cbiAqIDxtZC1jaGVja2JveCBuZy1tb2RlbD1cImlzQ2hlY2tlZFwiIGFyaWEtbGFiZWw9XCJGaW5pc2hlZD9cIj5cbiAqICAgRmluaXNoZWQgP1xuICogPC9tZC1jaGVja2JveD5cbiAqXG4gKiA8bWQtY2hlY2tib3ggbWQtbm8taW5rIG5nLW1vZGVsPVwiaGFzSW5rXCIgYXJpYS1sYWJlbD1cIk5vIEluayBFZmZlY3RzXCI+XG4gKiAgIE5vIEluayBFZmZlY3RzXG4gKiA8L21kLWNoZWNrYm94PlxuICpcbiAqIDxtZC1jaGVja2JveCBuZy1kaXNhYmxlZD1cInRydWVcIiBuZy1tb2RlbD1cImlzRGlzYWJsZWRcIiBhcmlhLWxhYmVsPVwiRGlzYWJsZWRcIj5cbiAqICAgRGlzYWJsZWRcbiAqIDwvbWQtY2hlY2tib3g+XG4gKlxuICogPC9obGpzPlxuICpcbiAqL1xuZnVuY3Rpb24gTWRDaGVja2JveERpcmVjdGl2ZShpbnB1dERpcmVjdGl2ZSwgJG1kSW5rUmlwcGxlLCAkbWRBcmlhLCAkbWRDb25zdGFudCwgJG1kVGhlbWluZywgJG1kVXRpbCwgJHRpbWVvdXQpIHtcbiAgaW5wdXREaXJlY3RpdmUgPSBpbnB1dERpcmVjdGl2ZVswXTtcbiAgdmFyIENIRUNLRURfQ1NTID0gJ21kLWNoZWNrZWQnO1xuXG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdFJyxcbiAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgIHJlcXVpcmU6ICc/bmdNb2RlbCcsXG4gICAgcHJpb3JpdHk6MjEwLCAvLyBSdW4gYmVmb3JlIG5nQXJpYVxuICAgIHRlbXBsYXRlOiBcbiAgICAgICc8ZGl2IGNsYXNzPVwibWQtY29udGFpbmVyXCIgbWQtaW5rLXJpcHBsZSBtZC1pbmstcmlwcGxlLWNoZWNrYm94PicgK1xuICAgICAgICAnPGRpdiBjbGFzcz1cIm1kLWljb25cIj48L2Rpdj4nICtcbiAgICAgICc8L2Rpdj4nICtcbiAgICAgICc8ZGl2IG5nLXRyYW5zY2x1ZGUgY2xhc3M9XCJtZC1sYWJlbFwiPjwvZGl2PicsXG4gICAgY29tcGlsZTogY29tcGlsZVxuICB9O1xuXG4gIC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgLy8gUHJpdmF0ZSBNZXRob2RzXG4gIC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcblxuICBmdW5jdGlvbiBjb21waWxlICh0RWxlbWVudCwgdEF0dHJzKSB7XG5cbiAgICB0QXR0cnMudHlwZSA9ICdjaGVja2JveCc7XG4gICAgdEF0dHJzLnRhYmluZGV4ID0gdEF0dHJzLnRhYmluZGV4IHx8ICcwJztcbiAgICB0RWxlbWVudC5hdHRyKCdyb2xlJywgdEF0dHJzLnR5cGUpO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBuZ01vZGVsQ3RybCkge1xuICAgICAgbmdNb2RlbEN0cmwgPSBuZ01vZGVsQ3RybCB8fCAkbWRVdGlsLmZha2VOZ01vZGVsKCk7XG4gICAgICAkbWRUaGVtaW5nKGVsZW1lbnQpO1xuXG4gICAgICBpZiAoYXR0ci5uZ0NoZWNrZWQpIHtcbiAgICAgICAgc2NvcGUuJHdhdGNoKFxuICAgICAgICAgICAgc2NvcGUuJGV2YWwuYmluZChzY29wZSwgYXR0ci5uZ0NoZWNrZWQpLFxuICAgICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZpZXdWYWx1ZS5iaW5kKG5nTW9kZWxDdHJsKVxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgJCR3YXRjaEV4cHIoJ25nRGlzYWJsZWQnLCAndGFiaW5kZXgnLCB7XG4gICAgICAgIHRydWU6ICctMScsXG4gICAgICAgIGZhbHNlOiBhdHRyLnRhYmluZGV4XG4gICAgICB9KTtcbiAgICAgICRtZEFyaWEuZXhwZWN0V2l0aFRleHQoZWxlbWVudCwgJ2FyaWEtbGFiZWwnKTtcblxuICAgICAgLy8gUmV1c2UgdGhlIG9yaWdpbmFsIGlucHV0W3R5cGU9Y2hlY2tib3hdIGRpcmVjdGl2ZSBmcm9tIEFuZ3VsYXIgY29yZS5cbiAgICAgIC8vIFRoaXMgaXMgYSBiaXQgaGFja3kgYXMgd2UgbmVlZCBvdXIgb3duIGV2ZW50IGxpc3RlbmVyIGFuZCBvd24gcmVuZGVyXG4gICAgICAvLyBmdW5jdGlvbi5cbiAgICAgIGlucHV0RGlyZWN0aXZlLmxpbmsucHJlKHNjb3BlLCB7XG4gICAgICAgIG9uOiBhbmd1bGFyLm5vb3AsXG4gICAgICAgIDA6IHt9XG4gICAgICB9LCBhdHRyLCBbbmdNb2RlbEN0cmxdKTtcblxuICAgICAgc2NvcGUubW91c2VBY3RpdmUgPSBmYWxzZTtcbiAgICAgIGVsZW1lbnQub24oJ2NsaWNrJywgbGlzdGVuZXIpXG4gICAgICAgIC5vbigna2V5cHJlc3MnLCBrZXlwcmVzc0hhbmRsZXIpXG4gICAgICAgIC5vbignbW91c2Vkb3duJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgc2NvcGUubW91c2VBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBzY29wZS5tb3VzZUFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgIH0sIDEwMCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5vbignZm9jdXMnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZihzY29wZS5tb3VzZUFjdGl2ZSA9PT0gZmFsc2UpIHsgZWxlbWVudC5hZGRDbGFzcygnbWQtZm9jdXNlZCcpOyB9XG4gICAgICAgIH0pXG4gICAgICAgIC5vbignYmx1cicsIGZ1bmN0aW9uKCkgeyBlbGVtZW50LnJlbW92ZUNsYXNzKCdtZC1mb2N1c2VkJyk7IH0pO1xuXG4gICAgICBuZ01vZGVsQ3RybC4kcmVuZGVyID0gcmVuZGVyO1xuXG4gICAgICBmdW5jdGlvbiAkJHdhdGNoRXhwcihleHByLCBodG1sQXR0ciwgdmFsdWVPcHRzKSB7XG4gICAgICAgIGlmIChhdHRyW2V4cHJdKSB7XG4gICAgICAgICAgc2NvcGUuJHdhdGNoKGF0dHJbZXhwcl0sIGZ1bmN0aW9uKHZhbCkge1xuICAgICAgICAgICAgaWYgKHZhbHVlT3B0c1t2YWxdKSB7XG4gICAgICAgICAgICAgIGVsZW1lbnQuYXR0cihodG1sQXR0ciwgdmFsdWVPcHRzW3ZhbF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGtleXByZXNzSGFuZGxlcihldikge1xuICAgICAgICB2YXIga2V5Q29kZSA9IGV2LndoaWNoIHx8IGV2LmtleUNvZGU7XG4gICAgICAgIGlmIChrZXlDb2RlID09PSAkbWRDb25zdGFudC5LRVlfQ09ERS5TUEFDRSB8fCBrZXlDb2RlID09PSAkbWRDb25zdGFudC5LRVlfQ09ERS5FTlRFUikge1xuICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgaWYgKCFlbGVtZW50Lmhhc0NsYXNzKCdtZC1mb2N1c2VkJykpIHsgZWxlbWVudC5hZGRDbGFzcygnbWQtZm9jdXNlZCcpOyB9XG4gICAgICAgICAgbGlzdGVuZXIoZXYpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBsaXN0ZW5lcihldikge1xuICAgICAgICBpZiAoZWxlbWVudFswXS5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHJldHVybjtcblxuICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgLy8gVG9nZ2xlIHRoZSBjaGVja2JveCB2YWx1ZS4uLlxuICAgICAgICAgIHZhciB2aWV3VmFsdWUgPSBhdHRyLm5nQ2hlY2tlZCA/IGF0dHIuY2hlY2tlZCA6ICFuZ01vZGVsQ3RybC4kdmlld1ZhbHVlO1xuXG4gICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZpZXdWYWx1ZSggdmlld1ZhbHVlLCBldiAmJiBldi50eXBlKTtcbiAgICAgICAgICBuZ01vZGVsQ3RybC4kcmVuZGVyKCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICAgIGlmKG5nTW9kZWxDdHJsLiR2aWV3VmFsdWUpIHtcbiAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKENIRUNLRURfQ1NTKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKENIRUNLRURfQ1NTKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gIH1cbn1cbk1kQ2hlY2tib3hEaXJlY3RpdmUuJGluamVjdCA9IFtcImlucHV0RGlyZWN0aXZlXCIsIFwiJG1kSW5rUmlwcGxlXCIsIFwiJG1kQXJpYVwiLCBcIiRtZENvbnN0YW50XCIsIFwiJG1kVGhlbWluZ1wiLCBcIiRtZFV0aWxcIiwgXCIkdGltZW91dFwiXTtcblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogQG5nZG9jIG1vZHVsZVxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5jaGlwc1xuICovXG4vKlxuICogQHNlZSBqcyBmb2xkZXIgZm9yIGNoaXBzIGltcGxlbWVudGF0aW9uXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmNoaXBzJywgW1xuICAnbWF0ZXJpYWwuY29yZScsXG4gICdtYXRlcmlhbC5jb21wb25lbnRzLmF1dG9jb21wbGV0ZSdcbl0pO1xuXG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBAbmdkb2MgbW9kdWxlXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLmNvbnRlbnRcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFNjcm9sbGFibGUgY29udGVudFxuICovXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5jb250ZW50JywgW1xuICAnbWF0ZXJpYWwuY29yZSdcbl0pXG4gIC5kaXJlY3RpdmUoJ21kQ29udGVudCcsIG1kQ29udGVudERpcmVjdGl2ZSk7XG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbWRDb250ZW50XG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuY29udGVudFxuICpcbiAqIEByZXN0cmljdCBFXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBUaGUgYDxtZC1jb250ZW50PmAgZGlyZWN0aXZlIGlzIGEgY29udGFpbmVyIGVsZW1lbnQgdXNlZnVsIGZvciBzY3JvbGxhYmxlIGNvbnRlbnRcbiAqXG4gKiBAdXNhZ2VcbiAqXG4gKiAtIEFkZCB0aGUgYFtsYXlvdXQtcGFkZGluZ11gIGF0dHJpYnV0ZSB0byBtYWtlIHRoZSBjb250ZW50IHBhZGRlZC5cbiAqXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxuICogIDxtZC1jb250ZW50IGxheW91dC1wYWRkaW5nPlxuICogICAgICBMb3JlbSBpcHN1bSBkb2xvciBzaXQgYW1ldCwgbmUgcXVvZCBub3Z1bSBtZWkuXG4gKiAgPC9tZC1jb250ZW50PlxuICogPC9obGpzPlxuICpcbiAqL1xuXG5mdW5jdGlvbiBtZENvbnRlbnREaXJlY3RpdmUoJG1kVGhlbWluZykge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnRScsXG4gICAgY29udHJvbGxlcjogWyckc2NvcGUnLCAnJGVsZW1lbnQnLCBDb250ZW50Q29udHJvbGxlcl0sXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcbiAgICAgIHZhciBub2RlID0gZWxlbWVudFswXTtcblxuICAgICAgJG1kVGhlbWluZyhlbGVtZW50KTtcbiAgICAgIHNjb3BlLiRicm9hZGNhc3QoJyRtZENvbnRlbnRMb2FkZWQnLCBlbGVtZW50KTtcblxuICAgICAgaW9zU2Nyb2xsRml4KGVsZW1lbnRbMF0pO1xuICAgIH1cbiAgfTtcblxuICBmdW5jdGlvbiBDb250ZW50Q29udHJvbGxlcigkc2NvcGUsICRlbGVtZW50KSB7XG4gICAgdGhpcy4kc2NvcGUgPSAkc2NvcGU7XG4gICAgdGhpcy4kZWxlbWVudCA9ICRlbGVtZW50O1xuICB9XG59XG5tZENvbnRlbnREaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZFRoZW1pbmdcIl07XG5cbmZ1bmN0aW9uIGlvc1Njcm9sbEZpeChub2RlKSB7XG4gIC8vIElPUyBGSVg6XG4gIC8vIElmIHdlIHNjcm9sbCB3aGVyZSB0aGVyZSBpcyBubyBtb3JlIHJvb20gZm9yIHRoZSB3ZWJ2aWV3IHRvIHNjcm9sbCxcbiAgLy8gYnkgZGVmYXVsdCB0aGUgd2VidmlldyBpdHNlbGYgd2lsbCBzY3JvbGwgdXAgYW5kIGRvd24sIHRoaXMgbG9va3MgcmVhbGx5XG4gIC8vIGJhZC4gIFNvIGlmIHdlIGFyZSBzY3JvbGxpbmcgdG8gdGhlIHZlcnkgdG9wIG9yIGJvdHRvbSwgYWRkL3N1YnRyYWN0IG9uZVxuICBhbmd1bGFyLmVsZW1lbnQobm9kZSkub24oJyRtZC5wcmVzc2Rvd24nLCBmdW5jdGlvbihldikge1xuICAgIC8vIE9ubHkgdG91Y2ggZXZlbnRzXG4gICAgaWYgKGV2LnBvaW50ZXIudHlwZSAhPT0gJ3QnKSByZXR1cm47XG4gICAgLy8gRG9uJ3QgbGV0IGEgY2hpbGQgY29udGVudCdzIHRvdWNoc3RhcnQgcnVpbiBpdCBmb3IgdXMuXG4gICAgaWYgKGV2LiRtYXRlcmlhbFNjcm9sbEZpeGVkKSByZXR1cm47XG4gICAgZXYuJG1hdGVyaWFsU2Nyb2xsRml4ZWQgPSB0cnVlO1xuXG4gICAgaWYgKG5vZGUuc2Nyb2xsVG9wID09PSAwKSB7XG4gICAgICBub2RlLnNjcm9sbFRvcCA9IDE7XG4gICAgfSBlbHNlIGlmIChub2RlLnNjcm9sbEhlaWdodCA9PT0gbm9kZS5zY3JvbGxUb3AgKyBub2RlLm9mZnNldEhlaWdodCkge1xuICAgICAgbm9kZS5zY3JvbGxUb3AgLT0gMTtcbiAgICB9XG4gIH0pO1xufVxuXG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBAbmdkb2MgbW9kdWxlXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLmRpYWxvZ1xuICovXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5kaWFsb2cnLCBbXG4gICdtYXRlcmlhbC5jb3JlJyxcbiAgJ21hdGVyaWFsLmNvbXBvbmVudHMuYmFja2Ryb3AnXG5dKVxuICAuZGlyZWN0aXZlKCdtZERpYWxvZycsIE1kRGlhbG9nRGlyZWN0aXZlKVxuICAucHJvdmlkZXIoJyRtZERpYWxvZycsIE1kRGlhbG9nUHJvdmlkZXIpO1xuXG5mdW5jdGlvbiBNZERpYWxvZ0RpcmVjdGl2ZSgkJHJBRiwgJG1kVGhlbWluZykge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnRScsXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcbiAgICAgICRtZFRoZW1pbmcoZWxlbWVudCk7XG4gICAgICAkJHJBRihmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGNvbnRlbnQgPSBlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJ21kLWRpYWxvZy1jb250ZW50Jyk7XG4gICAgICAgIGlmIChjb250ZW50ICYmIGNvbnRlbnQuc2Nyb2xsSGVpZ2h0ID4gY29udGVudC5jbGllbnRIZWlnaHQpIHtcbiAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdtZC1jb250ZW50LW92ZXJmbG93Jyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbn1cbk1kRGlhbG9nRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkJHJBRlwiLCBcIiRtZFRoZW1pbmdcIl07XG5cbi8qKlxuICogQG5nZG9jIHNlcnZpY2VcbiAqIEBuYW1lICRtZERpYWxvZ1xuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmRpYWxvZ1xuICpcbiAqIEBkZXNjcmlwdGlvblxuICogYCRtZERpYWxvZ2Agb3BlbnMgYSBkaWFsb2cgb3ZlciB0aGUgYXBwIHRvIGluZm9ybSB1c2VycyBhYm91dCBjcml0aWNhbCBpbmZvcm1hdGlvbiBvciByZXF1aXJlXG4gKiAgdGhlbSB0byBtYWtlIGRlY2lzaW9ucy4gVGhlcmUgYXJlIHR3byBhcHByb2FjaGVzIGZvciBzZXR1cDogYSBzaW1wbGUgcHJvbWlzZSBBUElcbiAqICBhbmQgcmVndWxhciBvYmplY3Qgc3ludGF4LlxuICpcbiAqICMjIFJlc3RyaWN0aW9uc1xuICpcbiAqIC0gVGhlIGRpYWxvZyBpcyBhbHdheXMgZ2l2ZW4gYW4gaXNvbGF0ZSBzY29wZS5cbiAqIC0gVGhlIGRpYWxvZydzIHRlbXBsYXRlIG11c3QgaGF2ZSBhbiBvdXRlciBgPG1kLWRpYWxvZz5gIGVsZW1lbnQuXG4gKiAgIEluc2lkZSwgdXNlIGFuIGA8bWQtZGlhbG9nLWNvbnRlbnQ+YCBlbGVtZW50IGZvciB0aGUgZGlhbG9nJ3MgY29udGVudCwgYW5kIHVzZVxuICogICBhbiBlbGVtZW50IHdpdGggY2xhc3MgYG1kLWFjdGlvbnNgIGZvciB0aGUgZGlhbG9nJ3MgYWN0aW9ucy5cbiAqIC0gRGlhbG9ncyBtdXN0IGNvdmVyIHRoZSBlbnRpcmUgYXBwbGljYXRpb24gdG8ga2VlcCBpbnRlcmFjdGlvbnMgaW5zaWRlIG9mIHRoZW0uXG4gKiBVc2UgdGhlIGBwYXJlbnRgIG9wdGlvbiB0byBjaGFuZ2Ugd2hlcmUgZGlhbG9ncyBhcmUgYXBwZW5kZWQuXG4gKlxuICogIyMgU2l6aW5nXG4gKiAtIENvbXBsZXggZGlhbG9ncyBjYW4gYmUgc2l6ZWQgd2l0aCBgZmxleD1cInBlcmNlbnRhZ2VcImAsIGkuZS4gYGZsZXg9XCI2NlwiYC5cbiAqIC0gRGVmYXVsdCBtYXgtd2lkdGggaXMgODAlIG9mIHRoZSBgcm9vdEVsZW1lbnRgIG9yIGBwYXJlbnRgLlxuICpcbiAqIEB1c2FnZVxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cbiAqIDxkaXYgIG5nLWFwcD1cImRlbW9BcHBcIiBuZy1jb250cm9sbGVyPVwiRW1wbG95ZWVDb250cm9sbGVyXCI+XG4gKiAgIDxkaXY+XG4gKiAgICAgPG1kLWJ1dHRvbiBuZy1jbGljaz1cInNob3dBbGVydCgpXCIgY2xhc3M9XCJtZC1yYWlzZWQgbWQtd2FyblwiPlxuICogICAgICAgRW1wbG95ZWUgQWxlcnQhXG4gKiAgICAgICA8L21kLWJ1dHRvbj5cbiAqICAgPC9kaXY+XG4gKiAgIDxkaXY+XG4gKiAgICAgPG1kLWJ1dHRvbiBuZy1jbGljaz1cInNob3dEaWFsb2coJGV2ZW50KVwiIGNsYXNzPVwibWQtcmFpc2VkXCI+XG4gKiAgICAgICBDdXN0b20gRGlhbG9nXG4gKiAgICAgICA8L21kLWJ1dHRvbj5cbiAqICAgPC9kaXY+XG4gKiAgIDxkaXY+XG4gKiAgICAgPG1kLWJ1dHRvbiBuZy1jbGljaz1cImNsb3NlQWxlcnQoKVwiIG5nLWRpc2FibGVkPVwiIWhhc0FsZXJ0KClcIiBjbGFzcz1cIm1kLXJhaXNlZFwiPlxuICogICAgICAgQ2xvc2UgQWxlcnRcbiAqICAgICA8L21kLWJ1dHRvbj5cbiAqICAgPC9kaXY+XG4gKiAgIDxkaXY+XG4gKiAgICAgPG1kLWJ1dHRvbiBuZy1jbGljaz1cInNob3dHcmVldGluZygkZXZlbnQpXCIgY2xhc3M9XCJtZC1yYWlzZWQgbWQtcHJpbWFyeVwiID5cbiAqICAgICAgIEdyZWV0IEVtcGxveWVlXG4gKiAgICAgICA8L21kLWJ1dHRvbj5cbiAqICAgPC9kaXY+XG4gKiA8L2Rpdj5cbiAqIDwvaGxqcz5cbiAqXG4gKiAjIyMgSmF2YVNjcmlwdDogb2JqZWN0IHN5bnRheFxuICogPGhsanMgbGFuZz1cImpzXCI+XG4gKiAoZnVuY3Rpb24oYW5ndWxhciwgdW5kZWZpbmVkKXtcbiAqICAgXCJ1c2Ugc3RyaWN0XCI7XG4gKlxuICogICBhbmd1bGFyXG4gKiAgICAubW9kdWxlKCdkZW1vQXBwJywgWyduZ01hdGVyaWFsJ10pXG4gKiAgICAuY29udHJvbGxlcignQXBwQ3RybCcsIEFwcENvbnRyb2xsZXIpO1xuICpcbiAqICAgZnVuY3Rpb24gQXBwQ29udHJvbGxlcigkc2NvcGUsICRtZERpYWxvZykge1xuICogICAgIHZhciBhbGVydDtcbiAqICAgICAkc2NvcGUuc2hvd0FsZXJ0ID0gc2hvd0FsZXJ0O1xuICogICAgICRzY29wZS5zaG93RGlhbG9nID0gc2hvd0RpYWxvZztcbiAqICAgICAkc2NvcGUuaXRlbXMgPSBbMSwgMiwgM107XG4gKlxuICogICAgIC8vIEludGVybmFsIG1ldGhvZFxuICogICAgIGZ1bmN0aW9uIHNob3dBbGVydCgpIHtcbiAqICAgICAgIGFsZXJ0ID0gJG1kRGlhbG9nLmFsZXJ0KHtcbiAqICAgICAgICAgdGl0bGU6ICdBdHRlbnRpb24nLFxuICogICAgICAgICBjb250ZW50OiAnVGhpcyBpcyBhbiBleGFtcGxlIG9mIGhvdyBlYXN5IGRpYWxvZ3MgY2FuIGJlIScsXG4gKiAgICAgICAgIG9rOiAnQ2xvc2UnXG4gKiAgICAgICB9KTtcbiAqXG4gKiAgICAgICAkbWREaWFsb2dcbiAqICAgICAgICAgLnNob3coIGFsZXJ0IClcbiAqICAgICAgICAgLmZpbmFsbHkoZnVuY3Rpb24oKSB7XG4gKiAgICAgICAgICAgYWxlcnQgPSB1bmRlZmluZWQ7XG4gKiAgICAgICAgIH0pO1xuICogICAgIH1cbiAqXG4gKiAgICAgZnVuY3Rpb24gc2hvd0RpYWxvZygkZXZlbnQpIHtcbiAqICAgICAgICB2YXIgcGFyZW50RWwgPSBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSk7XG4gKiAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICogICAgICAgICAgcGFyZW50OiBwYXJlbnRFbCxcbiAqICAgICAgICAgIHRhcmdldEV2ZW50OiAkZXZlbnQsXG4gKiAgICAgICAgICB0ZW1wbGF0ZTpcbiAqICAgICAgICAgICAgJzxtZC1kaWFsb2cgYXJpYS1sYWJlbD1cIkxpc3QgZGlhbG9nXCI+JyArXG4gKiAgICAgICAgICAgICcgIDxtZC1kaWFsb2ctY29udGVudD4nK1xuICogICAgICAgICAgICAnICAgIDxtZC1saXN0PicrXG4gKiAgICAgICAgICAgICcgICAgICA8bWQtbGlzdC1pdGVtIG5nLXJlcGVhdD1cIml0ZW0gaW4gaXRlbXNcIj4nK1xuICogICAgICAgICAgICAnICAgICAgIDxwPk51bWJlciB7e2l0ZW19fTwvcD4nICtcbiAqICAgICAgICAgICAgJyAgICAgIDwvbWQtaXRlbT4nK1xuICogICAgICAgICAgICAnICAgIDwvbWQtbGlzdD4nK1xuICogICAgICAgICAgICAnICA8L21kLWRpYWxvZy1jb250ZW50PicgK1xuICogICAgICAgICAgICAnICA8ZGl2IGNsYXNzPVwibWQtYWN0aW9uc1wiPicgK1xuICogICAgICAgICAgICAnICAgIDxtZC1idXR0b24gbmctY2xpY2s9XCJjbG9zZURpYWxvZygpXCIgY2xhc3M9XCJtZC1wcmltYXJ5XCI+JyArXG4gKiAgICAgICAgICAgICcgICAgICBDbG9zZSBEaWFsb2cnICtcbiAqICAgICAgICAgICAgJyAgICA8L21kLWJ1dHRvbj4nICtcbiAqICAgICAgICAgICAgJyAgPC9kaXY+JyArXG4gKiAgICAgICAgICAgICc8L21kLWRpYWxvZz4nLFxuICogICAgICAgICAgbG9jYWxzOiB7XG4gKiAgICAgICAgICAgIGl0ZW1zOiAkc2NvcGUuaXRlbXNcbiAqICAgICAgICAgIH0sXG4gKiAgICAgICAgICBjb250cm9sbGVyOiBEaWFsb2dDb250cm9sbGVyXG4gKiAgICAgICB9KTtcbiAqICAgICAgIGZ1bmN0aW9uIERpYWxvZ0NvbnRyb2xsZXIoJHNjb3BlLCAkbWREaWFsb2csIGl0ZW1zKSB7XG4gKiAgICAgICAgICRzY29wZS5pdGVtcyA9IGl0ZW1zO1xuICogICAgICAgICAkc2NvcGUuY2xvc2VEaWFsb2cgPSBmdW5jdGlvbigpIHtcbiAqICAgICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xuICogICAgICAgICB9XG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICB9XG4gKiB9KShhbmd1bGFyKTtcbiAqIDwvaGxqcz5cbiAqXG4gKiAjIyMgSmF2YVNjcmlwdDogcHJvbWlzZSBBUEkgc3ludGF4LCBjdXN0b20gZGlhbG9nIHRlbXBsYXRlXG4gKiA8aGxqcyBsYW5nPVwianNcIj5cbiAqIChmdW5jdGlvbihhbmd1bGFyLCB1bmRlZmluZWQpe1xuICogICBcInVzZSBzdHJpY3RcIjtcbiAqXG4gKiAgIGFuZ3VsYXJcbiAqICAgICAubW9kdWxlKCdkZW1vQXBwJywgWyduZ01hdGVyaWFsJ10pXG4gKiAgICAgLmNvbnRyb2xsZXIoJ0VtcGxveWVlQ29udHJvbGxlcicsIEVtcGxveWVlRWRpdG9yKVxuICogICAgIC5jb250cm9sbGVyKCdHcmVldGluZ0NvbnRyb2xsZXInLCBHcmVldGluZ0NvbnRyb2xsZXIpO1xuICpcbiAqICAgLy8gRmljdGl0aW91cyBFbXBsb3llZSBFZGl0b3IgdG8gc2hvdyBob3cgdG8gdXNlIHNpbXBsZSBhbmQgY29tcGxleCBkaWFsb2dzLlxuICpcbiAqICAgZnVuY3Rpb24gRW1wbG95ZWVFZGl0b3IoJHNjb3BlLCAkbWREaWFsb2cpIHtcbiAqICAgICB2YXIgYWxlcnQ7XG4gKlxuICogICAgICRzY29wZS5zaG93QWxlcnQgPSBzaG93QWxlcnQ7XG4gKiAgICAgJHNjb3BlLmNsb3NlQWxlcnQgPSBjbG9zZUFsZXJ0O1xuICogICAgICRzY29wZS5zaG93R3JlZXRpbmcgPSBzaG93Q3VzdG9tR3JlZXRpbmc7XG4gKlxuICogICAgICRzY29wZS5oYXNBbGVydCA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gISFhbGVydCB9O1xuICogICAgICRzY29wZS51c2VyTmFtZSA9ICRzY29wZS51c2VyTmFtZSB8fCAnQm9iYnknO1xuICpcbiAqICAgICAvLyBEaWFsb2cgIzEgLSBTaG93IHNpbXBsZSBhbGVydCBkaWFsb2cgYW5kIGNhY2hlXG4gKiAgICAgLy8gcmVmZXJlbmNlIHRvIGRpYWxvZyBpbnN0YW5jZVxuICpcbiAqICAgICBmdW5jdGlvbiBzaG93QWxlcnQoKSB7XG4gKiAgICAgICBhbGVydCA9ICRtZERpYWxvZy5hbGVydCgpXG4gKiAgICAgICAgIC50aXRsZSgnQXR0ZW50aW9uLCAnICsgJHNjb3BlLnVzZXJOYW1lKVxuICogICAgICAgICAuY29udGVudCgnVGhpcyBpcyBhbiBleGFtcGxlIG9mIGhvdyBlYXN5IGRpYWxvZ3MgY2FuIGJlIScpXG4gKiAgICAgICAgIC5vaygnQ2xvc2UnKTtcbiAqXG4gKiAgICAgICAkbWREaWFsb2dcbiAqICAgICAgICAgICAuc2hvdyggYWxlcnQgKVxuICogICAgICAgICAgIC5maW5hbGx5KGZ1bmN0aW9uKCkge1xuICogICAgICAgICAgICAgYWxlcnQgPSB1bmRlZmluZWQ7XG4gKiAgICAgICAgICAgfSk7XG4gKiAgICAgfVxuICpcbiAqICAgICAvLyBDbG9zZSB0aGUgc3BlY2lmaWVkIGRpYWxvZyBpbnN0YW5jZSBhbmQgcmVzb2x2ZSB3aXRoICdmaW5pc2hlZCcgZmxhZ1xuICogICAgIC8vIE5vcm1hbGx5IHRoaXMgaXMgbm90IG5lZWRlZCwganVzdCB1c2UgJyRtZERpYWxvZy5oaWRlKCknIHRvIGNsb3NlXG4gKiAgICAgLy8gdGhlIG1vc3QgcmVjZW50IGRpYWxvZyBwb3B1cC5cbiAqXG4gKiAgICAgZnVuY3Rpb24gY2xvc2VBbGVydCgpIHtcbiAqICAgICAgICRtZERpYWxvZy5oaWRlKCBhbGVydCwgXCJmaW5pc2hlZFwiICk7XG4gKiAgICAgICBhbGVydCA9IHVuZGVmaW5lZDtcbiAqICAgICB9XG4gKlxuICogICAgIC8vIERpYWxvZyAjMiAtIERlbW9uc3RyYXRlIG1vcmUgY29tcGxleCBkaWFsb2dzIGNvbnN0cnVjdGlvbiBhbmQgcG9wdXAuXG4gKlxuICogICAgIGZ1bmN0aW9uIHNob3dDdXN0b21HcmVldGluZygkZXZlbnQpIHtcbiAqICAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICogICAgICAgICAgIHRhcmdldEV2ZW50OiAkZXZlbnQsXG4gKiAgICAgICAgICAgdGVtcGxhdGU6XG4gKiAgICAgICAgICAgICAnPG1kLWRpYWxvZz4nICtcbiAqXG4gKiAgICAgICAgICAgICAnICA8bWQtZGlhbG9nLWNvbnRlbnQ+SGVsbG8ge3sgZW1wbG95ZWUgfX0hPC9tZC1kaWFsb2ctY29udGVudD4nICtcbiAqXG4gKiAgICAgICAgICAgICAnICA8ZGl2IGNsYXNzPVwibWQtYWN0aW9uc1wiPicgK1xuICogICAgICAgICAgICAgJyAgICA8bWQtYnV0dG9uIG5nLWNsaWNrPVwiY2xvc2VEaWFsb2coKVwiIGNsYXNzPVwibWQtcHJpbWFyeVwiPicgK1xuICogICAgICAgICAgICAgJyAgICAgIENsb3NlIEdyZWV0aW5nJyArXG4gKiAgICAgICAgICAgICAnICAgIDwvbWQtYnV0dG9uPicgK1xuICogICAgICAgICAgICAgJyAgPC9kaXY+JyArXG4gKiAgICAgICAgICAgICAnPC9tZC1kaWFsb2c+JyxcbiAqICAgICAgICAgICBjb250cm9sbGVyOiAnR3JlZXRpbmdDb250cm9sbGVyJyxcbiAqICAgICAgICAgICBvbkNvbXBsZXRlOiBhZnRlclNob3dBbmltYXRpb24sXG4gKiAgICAgICAgICAgbG9jYWxzOiB7IGVtcGxveWVlOiAkc2NvcGUudXNlck5hbWUgfVxuICogICAgICAgICB9KTtcbiAqXG4gKiAgICAgICAgIC8vIFdoZW4gdGhlICdlbnRlcicgYW5pbWF0aW9uIGZpbmlzaGVzLi4uXG4gKlxuICogICAgICAgICBmdW5jdGlvbiBhZnRlclNob3dBbmltYXRpb24oc2NvcGUsIGVsZW1lbnQsIG9wdGlvbnMpIHtcbiAqICAgICAgICAgICAgLy8gcG9zdC1zaG93IGNvZGUgaGVyZTogRE9NIGVsZW1lbnQgZm9jdXMsIGV0Yy5cbiAqICAgICAgICAgfVxuICogICAgIH1cbiAqXG4gKiAgICAgLy8gRGlhbG9nICMzIC0gRGVtb25zdHJhdGUgdXNlIG9mIENvbnRyb2xsZXJBcyBhbmQgcGFzc2luZyAkc2NvcGUgdG8gZGlhbG9nXG4gKiAgICAgLy8gICAgICAgICAgICAgSGVyZSB3ZSB1c2VkIG5nLWNvbnRyb2xsZXI9XCJHcmVldGluZ0NvbnRyb2xsZXIgYXMgdm1cIiBhbmRcbiAqICAgICAvLyAgICAgICAgICAgICAkc2NvcGUudm0gPT09IDxjb250cm9sbGVyIGluc3RhbmNlPlxuICpcbiAqICAgICBmdW5jdGlvbiBzaG93Q3VzdG9tR3JlZXRpbmcoKSB7XG4gKlxuICogICAgICAgICRtZERpYWxvZy5zaG93KHtcbiAqICAgICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlLFxuICpcbiAqICAgICAgICAgICBzY29wZTogJHNjb3BlLCAgICAgICAgLy8gdXNlIHBhcmVudCBzY29wZSBpbiB0ZW1wbGF0ZVxuICogICAgICAgICAgIHByZXNlcnZlU2NvcGU6IHRydWUsICAvLyBkbyBub3QgZm9yZ2V0IHRoaXMgaWYgdXNlIHBhcmVudCBzY29wZVxuXG4gKiAgICAgICAgICAgLy8gU2luY2UgR3JlZXRpbmdDb250cm9sbGVyIGlzIGluc3RhbnRpYXRlZCB3aXRoIENvbnRyb2xsZXJBcyBzeW50YXhcbiAqICAgICAgICAgICAvLyBBTkQgd2UgYXJlIHBhc3NpbmcgdGhlIHBhcmVudCAnJHNjb3BlJyB0byB0aGUgZGlhbG9nLCB3ZSBNVVNUXG4gKiAgICAgICAgICAgLy8gdXNlICd2bS48eHh4PicgaW4gdGhlIHRlbXBsYXRlIG1hcmt1cFxuICpcbiAqICAgICAgICAgICB0ZW1wbGF0ZTogJzxtZC1kaWFsb2c+JyArXG4gKiAgICAgICAgICAgICAgICAgICAgICcgIDxtZC1kaWFsb2ctY29udGVudD4nICtcbiAqICAgICAgICAgICAgICAgICAgICAgJyAgICAgSGkgVGhlcmUge3t2bS5lbXBsb3llZX19JyArXG4gKiAgICAgICAgICAgICAgICAgICAgICcgIDwvbWQtZGlhbG9nLWNvbnRlbnQ+JyArXG4gKiAgICAgICAgICAgICAgICAgICAgICc8L21kLWRpYWxvZz4nLFxuICpcbiAqICAgICAgICAgICBjb250cm9sbGVyOiBmdW5jdGlvbiBEaWFsb2dDb250cm9sbGVyKCRzY29wZSwgJG1kRGlhbG9nKSB7XG4gKiAgICAgICAgICAgICAkc2NvcGUuY2xvc2VEaWFsb2cgPSBmdW5jdGlvbigpIHtcbiAqICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAqICAgICAgICAgICAgIH1cbiAqICAgICAgICAgICB9XG4gKiAgICAgICAgfSk7XG4gKiAgICAgfVxuICpcbiAqICAgfVxuICpcbiAqICAgLy8gR3JlZXRpbmcgY29udHJvbGxlciB1c2VkIHdpdGggdGhlIG1vcmUgY29tcGxleCAnc2hvd0N1c3RvbUdyZWV0aW5nKCknIGN1c3RvbSBkaWFsb2dcbiAqXG4gKiAgIGZ1bmN0aW9uIEdyZWV0aW5nQ29udHJvbGxlcigkc2NvcGUsICRtZERpYWxvZywgZW1wbG95ZWUpIHtcbiAqICAgICAvLyBBc3NpZ25lZCBmcm9tIGNvbnN0cnVjdGlvbiA8Y29kZT5sb2NhbHM8L2NvZGU+IG9wdGlvbnMuLi5cbiAqICAgICAkc2NvcGUuZW1wbG95ZWUgPSBlbXBsb3llZTtcbiAqXG4gKiAgICAgJHNjb3BlLmNsb3NlRGlhbG9nID0gZnVuY3Rpb24oKSB7XG4gKiAgICAgICAvLyBFYXNpbHkgaGlkZXMgbW9zdCByZWNlbnQgZGlhbG9nIHNob3duLi4uXG4gKiAgICAgICAvLyBubyBzcGVjaWZpYyBpbnN0YW5jZSByZWZlcmVuY2UgaXMgbmVlZGVkLlxuICogICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAqICAgICB9O1xuICogICB9XG4gKlxuICogfSkoYW5ndWxhcik7XG4gKiA8L2hsanM+XG4gKi9cblxuIC8qKlxuICogQG5nZG9jIG1ldGhvZFxuICogQG5hbWUgJG1kRGlhbG9nI2FsZXJ0XG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBCdWlsZHMgYSBwcmVjb25maWd1cmVkIGRpYWxvZyB3aXRoIHRoZSBzcGVjaWZpZWQgbWVzc2FnZS5cbiAqXG4gKiBAcmV0dXJucyB7b2JqfSBhbiBgJG1kRGlhbG9nUHJlc2V0YCB3aXRoIHRoZSBjaGFpbmFibGUgY29uZmlndXJhdGlvbiBtZXRob2RzOlxuICpcbiAqIC0gJG1kRGlhbG9nUHJlc2V0I3RpdGxlKHN0cmluZykgLSBzZXRzIHRpdGxlIHRvIHN0cmluZ1xuICogLSAkbWREaWFsb2dQcmVzZXQjY29udGVudChzdHJpbmcpIC0gc2V0cyBjb250ZW50IC8gbWVzc2FnZSB0byBzdHJpbmdcbiAqIC0gJG1kRGlhbG9nUHJlc2V0I29rKHN0cmluZykgLSBzZXRzIG9rYXkgYnV0dG9uIHRleHQgdG8gc3RyaW5nXG4gKiAtICRtZERpYWxvZ1ByZXNldCN0aGVtZShzdHJpbmcpIC0gc2V0cyB0aGUgdGhlbWUgb2YgdGhlIGRpYWxvZ1xuICpcbiAqL1xuXG4gLyoqXG4gKiBAbmdkb2MgbWV0aG9kXG4gKiBAbmFtZSAkbWREaWFsb2cjY29uZmlybVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogQnVpbGRzIGEgcHJlY29uZmlndXJlZCBkaWFsb2cgd2l0aCB0aGUgc3BlY2lmaWVkIG1lc3NhZ2UuIFlvdSBjYW4gY2FsbCBzaG93IGFuZCB0aGUgcHJvbWlzZSByZXR1cm5lZFxuICogd2lsbCBiZSByZXNvbHZlZCBvbmx5IGlmIHRoZSB1c2VyIGNsaWNrcyB0aGUgY29uZmlybSBhY3Rpb24gb24gdGhlIGRpYWxvZy5cbiAqXG4gKiBAcmV0dXJucyB7b2JqfSBhbiBgJG1kRGlhbG9nUHJlc2V0YCB3aXRoIHRoZSBjaGFpbmFibGUgY29uZmlndXJhdGlvbiBtZXRob2RzOlxuICpcbiAqIEFkZGl0aW9uYWxseSwgaXQgc3VwcG9ydHMgdGhlIGZvbGxvd2luZyBtZXRob2RzOlxuICpcbiAqIC0gJG1kRGlhbG9nUHJlc2V0I3RpdGxlKHN0cmluZykgLSBzZXRzIHRpdGxlIHRvIHN0cmluZ1xuICogLSAkbWREaWFsb2dQcmVzZXQjY29udGVudChzdHJpbmcpIC0gc2V0cyBjb250ZW50IC8gbWVzc2FnZSB0byBzdHJpbmdcbiAqIC0gJG1kRGlhbG9nUHJlc2V0I29rKHN0cmluZykgLSBzZXRzIG9rYXkgYnV0dG9uIHRleHQgdG8gc3RyaW5nXG4gKiAtICRtZERpYWxvZ1ByZXNldCNjYW5jZWwoc3RyaW5nKSAtIHNldHMgY2FuY2VsIGJ1dHRvbiB0ZXh0IHRvIHN0cmluZ1xuICogLSAkbWREaWFsb2dQcmVzZXQjdGhlbWUoc3RyaW5nKSAtIHNldHMgdGhlIHRoZW1lIG9mIHRoZSBkaWFsb2dcbiAqXG4gKi9cblxuLyoqXG4gKiBAbmdkb2MgbWV0aG9kXG4gKiBAbmFtZSAkbWREaWFsb2cjc2hvd1xuICpcbiAqIEBkZXNjcmlwdGlvblxuICogU2hvdyBhIGRpYWxvZyB3aXRoIHRoZSBzcGVjaWZpZWQgb3B0aW9ucy5cbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gb3B0aW9uc09yUHJlc2V0IEVpdGhlciBwcm92aWRlIGFuIGAkbWREaWFsb2dQcmVzZXRgIHJldHVybmVkIGZyb20gYGFsZXJ0KClgLCBhbmRcbiAqIGBjb25maXJtKClgLCBvciBhbiBvcHRpb25zIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAqICAgLSBgdGVtcGxhdGVVcmxgIC0gYHtzdHJpbmc9fWA6IFRoZSB1cmwgb2YgYSB0ZW1wbGF0ZSB0aGF0IHdpbGwgYmUgdXNlZCBhcyB0aGUgY29udGVudFxuICogICBvZiB0aGUgZGlhbG9nLlxuICogICAtIGB0ZW1wbGF0ZWAgLSBge3N0cmluZz19YDogU2FtZSBhcyB0ZW1wbGF0ZVVybCwgZXhjZXB0IHRoaXMgaXMgYW4gYWN0dWFsIHRlbXBsYXRlIHN0cmluZy5cbiAqICAgLSBgdGFyZ2V0RXZlbnRgIC0gYHtET01DbGlja0V2ZW50PX1gOiBBIGNsaWNrJ3MgZXZlbnQgb2JqZWN0LiBXaGVuIHBhc3NlZCBpbiBhcyBhbiBvcHRpb24sXG4gKiAgICAgdGhlIGxvY2F0aW9uIG9mIHRoZSBjbGljayB3aWxsIGJlIHVzZWQgYXMgdGhlIHN0YXJ0aW5nIHBvaW50IGZvciB0aGUgb3BlbmluZyBhbmltYXRpb25cbiAqICAgICBvZiB0aGUgdGhlIGRpYWxvZy5cbiAqICAgLSBgc2NvcGVgIC0gYHtvYmplY3Q9fWA6IHRoZSBzY29wZSB0byBsaW5rIHRoZSB0ZW1wbGF0ZSAvIGNvbnRyb2xsZXIgdG8uIElmIG5vbmUgaXMgc3BlY2lmaWVkLFxuICogICAgIGl0IHdpbGwgY3JlYXRlIGEgbmV3IGlzb2xhdGUgc2NvcGUuXG4gKiAgICAgVGhpcyBzY29wZSB3aWxsIGJlIGRlc3Ryb3llZCB3aGVuIHRoZSBkaWFsb2cgaXMgcmVtb3ZlZCB1bmxlc3MgYHByZXNlcnZlU2NvcGVgIGlzIHNldCB0byB0cnVlLlxuICogICAtIGBwcmVzZXJ2ZVNjb3BlYCAtIGB7Ym9vbGVhbj19YDogd2hldGhlciB0byBwcmVzZXJ2ZSB0aGUgc2NvcGUgd2hlbiB0aGUgZWxlbWVudCBpcyByZW1vdmVkLiBEZWZhdWx0IGlzIGZhbHNlXG4gKiAgIC0gYGRpc2FibGVQYXJlbnRTY3JvbGxgIC0gYHtib29sZWFuPX1gOiBXaGV0aGVyIHRvIGRpc2FibGUgc2Nyb2xsaW5nIHdoaWxlIHRoZSBkaWFsb2cgaXMgb3Blbi5cbiAqICAgICBEZWZhdWx0IHRydWUuXG4gKiAgIC0gYGhhc0JhY2tkcm9wYCAtIGB7Ym9vbGVhbj19YDogV2hldGhlciB0aGVyZSBzaG91bGQgYmUgYW4gb3BhcXVlIGJhY2tkcm9wIGJlaGluZCB0aGUgZGlhbG9nLlxuICogICAgIERlZmF1bHQgdHJ1ZS5cbiAqICAgLSBgY2xpY2tPdXRzaWRlVG9DbG9zZWAgLSBge2Jvb2xlYW49fWA6IFdoZXRoZXIgdGhlIHVzZXIgY2FuIGNsaWNrIG91dHNpZGUgdGhlIGRpYWxvZyB0b1xuICogICAgIGNsb3NlIGl0LiBEZWZhdWx0IGZhbHNlLlxuICogICAtIGBlc2NhcGVUb0Nsb3NlYCAtIGB7Ym9vbGVhbj19YDogV2hldGhlciB0aGUgdXNlciBjYW4gcHJlc3MgZXNjYXBlIHRvIGNsb3NlIHRoZSBkaWFsb2cuXG4gKiAgICAgRGVmYXVsdCB0cnVlLlxuICogICAtIGBmb2N1c09uT3BlbmAgLSBge2Jvb2xlYW49fWA6IEFuIG9wdGlvbiB0byBvdmVycmlkZSBmb2N1cyBiZWhhdmlvciBvbiBvcGVuLiBPbmx5IGRpc2FibGUgaWZcbiAqICAgICBmb2N1c2luZyBzb21lIG90aGVyIHdheSwgYXMgZm9jdXMgbWFuYWdlbWVudCBpcyByZXF1aXJlZCBmb3IgZGlhbG9ncyB0byBiZSBhY2Nlc3NpYmxlLlxuICogICAgIERlZmF1bHRzIHRvIHRydWUuXG4gKiAgIC0gYGNvbnRyb2xsZXJgIC0gYHtzdHJpbmc9fWA6IFRoZSBjb250cm9sbGVyIHRvIGFzc29jaWF0ZSB3aXRoIHRoZSBkaWFsb2cuIFRoZSBjb250cm9sbGVyXG4gKiAgICAgd2lsbCBiZSBpbmplY3RlZCB3aXRoIHRoZSBsb2NhbCBgJG1kRGlhbG9nYCwgd2hpY2ggcGFzc2VzIGFsb25nIGEgc2NvcGUgZm9yIHRoZSBkaWFsb2cuXG4gKiAgIC0gYGxvY2Fsc2AgLSBge29iamVjdD19YDogQW4gb2JqZWN0IGNvbnRhaW5pbmcga2V5L3ZhbHVlIHBhaXJzLiBUaGUga2V5cyB3aWxsIGJlIHVzZWQgYXMgbmFtZXNcbiAqICAgICBvZiB2YWx1ZXMgdG8gaW5qZWN0IGludG8gdGhlIGNvbnRyb2xsZXIuIEZvciBleGFtcGxlLCBgbG9jYWxzOiB7dGhyZWU6IDN9YCB3b3VsZCBpbmplY3RcbiAqICAgICBgdGhyZWVgIGludG8gdGhlIGNvbnRyb2xsZXIsIHdpdGggdGhlIHZhbHVlIDMuIElmIGBiaW5kVG9Db250cm9sbGVyYCBpcyB0cnVlLCB0aGV5IHdpbGwgYmVcbiAqICAgICBjb3BpZWQgdG8gdGhlIGNvbnRyb2xsZXIgaW5zdGVhZC5cbiAqICAgLSBgYmluZFRvQ29udHJvbGxlcmAgLSBgYm9vbGA6IGJpbmQgdGhlIGxvY2FscyB0byB0aGUgY29udHJvbGxlciwgaW5zdGVhZCBvZiBwYXNzaW5nIHRoZW0gaW4uXG4gKiAgICAgVGhlc2UgdmFsdWVzIHdpbGwgbm90IGJlIGF2YWlsYWJsZSB1bnRpbCBhZnRlciBpbml0aWFsaXphdGlvbi5cbiAqICAgLSBgcmVzb2x2ZWAgLSBge29iamVjdD19YDogU2ltaWxhciB0byBsb2NhbHMsIGV4Y2VwdCBpdCB0YWtlcyBwcm9taXNlcyBhcyB2YWx1ZXMsIGFuZCB0aGVcbiAqICAgICBkaWFsb2cgd2lsbCBub3Qgb3BlbiB1bnRpbCBhbGwgb2YgdGhlIHByb21pc2VzIHJlc29sdmUuXG4gKiAgIC0gYGNvbnRyb2xsZXJBc2AgLSBge3N0cmluZz19YDogQW4gYWxpYXMgdG8gYXNzaWduIHRoZSBjb250cm9sbGVyIHRvIG9uIHRoZSBzY29wZS5cbiAqICAgLSBgcGFyZW50YCAtIGB7ZWxlbWVudD19YDogVGhlIGVsZW1lbnQgdG8gYXBwZW5kIHRoZSBkaWFsb2cgdG8uIERlZmF1bHRzIHRvIGFwcGVuZGluZ1xuICogICAgIHRvIHRoZSByb290IGVsZW1lbnQgb2YgdGhlIGFwcGxpY2F0aW9uLlxuICogICAtIGBvbkNvbXBsZXRlYCBge2Z1bmN0aW9uPX1gOiBDYWxsYmFjayBmdW5jdGlvbiB1c2VkIHRvIGFubm91bmNlIHdoZW4gdGhlIHNob3coKSBhY3Rpb24gaXNcbiAqICAgICBmaW5pc2hlZC5cbiAqXG4gKiBAcmV0dXJucyB7cHJvbWlzZX0gQSBwcm9taXNlIHRoYXQgY2FuIGJlIHJlc29sdmVkIHdpdGggYCRtZERpYWxvZy5oaWRlKClgIG9yXG4gKiByZWplY3RlZCB3aXRoIGAkbWREaWFsb2cuY2FuY2VsKClgLlxuICovXG5cbi8qKlxuICogQG5nZG9jIG1ldGhvZFxuICogQG5hbWUgJG1kRGlhbG9nI2hpZGVcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIEhpZGUgYW4gZXhpc3RpbmcgZGlhbG9nIGFuZCByZXNvbHZlIHRoZSBwcm9taXNlIHJldHVybmVkIGZyb20gYCRtZERpYWxvZy5zaG93KClgLlxuICpcbiAqIEBwYXJhbSB7Kj19IHJlc3BvbnNlIEFuIGFyZ3VtZW50IGZvciB0aGUgcmVzb2x2ZWQgcHJvbWlzZS5cbiAqXG4gKiBAcmV0dXJucyB7cHJvbWlzZX0gQSBwcm9taXNlIHRoYXQgaXMgcmVzb2x2ZWQgd2hlbiB0aGUgZGlhbG9nIGhhcyBiZWVuIGNsb3NlZC5cbiAqL1xuXG4vKipcbiAqIEBuZ2RvYyBtZXRob2RcbiAqIEBuYW1lICRtZERpYWxvZyNjYW5jZWxcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIEhpZGUgYW4gZXhpc3RpbmcgZGlhbG9nIGFuZCByZWplY3QgdGhlIHByb21pc2UgcmV0dXJuZWQgZnJvbSBgJG1kRGlhbG9nLnNob3coKWAuXG4gKlxuICogQHBhcmFtIHsqPX0gcmVzcG9uc2UgQW4gYXJndW1lbnQgZm9yIHRoZSByZWplY3RlZCBwcm9taXNlLlxuICpcbiAqIEByZXR1cm5zIHtwcm9taXNlfSBBIHByb21pc2UgdGhhdCBpcyByZXNvbHZlZCB3aGVuIHRoZSBkaWFsb2cgaGFzIGJlZW4gY2xvc2VkLlxuICovXG5cbmZ1bmN0aW9uIE1kRGlhbG9nUHJvdmlkZXIoJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyKSB7XG5cbiAgdmFyIGFsZXJ0RGlhbG9nTWV0aG9kcyA9IFsndGl0bGUnLCAnY29udGVudCcsICdhcmlhTGFiZWwnLCAnb2snXTtcblxuICBhZHZhbmNlZERpYWxvZ09wdGlvbnMuJGluamVjdCA9IFtcIiRtZERpYWxvZ1wiLCBcIiRtZFRoZW1pbmdcIl07XG4gIGRpYWxvZ0RlZmF1bHRPcHRpb25zLiRpbmplY3QgPSBbXCIkbWRBcmlhXCIsIFwiJGRvY3VtZW50XCIsIFwiJG1kVXRpbFwiLCBcIiRtZENvbnN0YW50XCIsIFwiJG1kVGhlbWluZ1wiLCBcIiRtZERpYWxvZ1wiLCBcIiR0aW1lb3V0XCIsIFwiJHJvb3RFbGVtZW50XCIsIFwiJGFuaW1hdGVcIiwgXCIkJHJBRlwiLCBcIiRxXCJdO1xuICByZXR1cm4gJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyKCckbWREaWFsb2cnKVxuICAgIC5zZXREZWZhdWx0cyh7XG4gICAgICBtZXRob2RzOiBbJ2Rpc2FibGVQYXJlbnRTY3JvbGwnLCAnaGFzQmFja2Ryb3AnLCAnY2xpY2tPdXRzaWRlVG9DbG9zZScsICdlc2NhcGVUb0Nsb3NlJywgJ3RhcmdldEV2ZW50JywgJ3BhcmVudCddLFxuICAgICAgb3B0aW9uczogZGlhbG9nRGVmYXVsdE9wdGlvbnNcbiAgICB9KVxuICAgIC5hZGRQcmVzZXQoJ2FsZXJ0Jywge1xuICAgICAgbWV0aG9kczogWyd0aXRsZScsICdjb250ZW50JywgJ2FyaWFMYWJlbCcsICdvaycsICd0aGVtZSddLFxuICAgICAgb3B0aW9uczogYWR2YW5jZWREaWFsb2dPcHRpb25zXG4gICAgfSlcbiAgICAuYWRkUHJlc2V0KCdjb25maXJtJywge1xuICAgICAgbWV0aG9kczogWyd0aXRsZScsICdjb250ZW50JywgJ2FyaWFMYWJlbCcsICdvaycsICdjYW5jZWwnLCAndGhlbWUnXSxcbiAgICAgIG9wdGlvbnM6IGFkdmFuY2VkRGlhbG9nT3B0aW9uc1xuICAgIH0pO1xuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBhZHZhbmNlZERpYWxvZ09wdGlvbnMoJG1kRGlhbG9nLCAkbWRUaGVtaW5nKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRlbXBsYXRlOiBbXG4gICAgICAgICc8bWQtZGlhbG9nIG1kLXRoZW1lPVwie3sgZGlhbG9nLnRoZW1lIH19XCIgYXJpYS1sYWJlbD1cInt7IGRpYWxvZy5hcmlhTGFiZWwgfX1cIj4nLFxuICAgICAgICAgICc8bWQtZGlhbG9nLWNvbnRlbnQgcm9sZT1cImRvY3VtZW50XCIgdGFiSW5kZXg9XCItMVwiPicsXG4gICAgICAgICAgICAnPGgyIGNsYXNzPVwibWQtdGl0bGVcIj57eyBkaWFsb2cudGl0bGUgfX08L2gyPicsXG4gICAgICAgICAgICAnPHA+e3sgZGlhbG9nLmNvbnRlbnQgfX08L3A+JyxcbiAgICAgICAgICAnPC9tZC1kaWFsb2ctY29udGVudD4nLFxuICAgICAgICAgICc8ZGl2IGNsYXNzPVwibWQtYWN0aW9uc1wiPicsXG4gICAgICAgICAgICAnPG1kLWJ1dHRvbiBuZy1pZj1cImRpYWxvZy4kdHlwZSA9PSBcXCdjb25maXJtXFwnXCInICtcbiAgICAgICAgICAgICAgICAgICAgICAnIG5nLWNsaWNrPVwiZGlhbG9nLmFib3J0KClcIiBjbGFzcz1cIm1kLXByaW1hcnlcIj4nLFxuICAgICAgICAgICAgICAne3sgZGlhbG9nLmNhbmNlbCB9fScsXG4gICAgICAgICAgICAnPC9tZC1idXR0b24+JyxcbiAgICAgICAgICAgICc8bWQtYnV0dG9uIG5nLWNsaWNrPVwiZGlhbG9nLmhpZGUoKVwiIGNsYXNzPVwibWQtcHJpbWFyeVwiPicsXG4gICAgICAgICAgICAgICd7eyBkaWFsb2cub2sgfX0nLFxuICAgICAgICAgICAgJzwvbWQtYnV0dG9uPicsXG4gICAgICAgICAgJzwvZGl2PicsXG4gICAgICAgICc8L21kLWRpYWxvZz4nXG4gICAgICBdLmpvaW4oJycpLFxuICAgICAgY29udHJvbGxlcjogZnVuY3Rpb24gbWREaWFsb2dDdHJsKCkge1xuICAgICAgICB0aGlzLmhpZGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAkbWREaWFsb2cuaGlkZSh0cnVlKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5hYm9ydCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgICBjb250cm9sbGVyQXM6ICdkaWFsb2cnLFxuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIHRoZW1lOiAkbWRUaGVtaW5nLmRlZmF1bHRUaGVtZSgpXG4gICAgfTtcbiAgfVxuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBkaWFsb2dEZWZhdWx0T3B0aW9ucygkbWRBcmlhLCAkZG9jdW1lbnQsICRtZFV0aWwsICRtZENvbnN0YW50LCAkbWRUaGVtaW5nLCAkbWREaWFsb2csICR0aW1lb3V0LCAkcm9vdEVsZW1lbnQsICRhbmltYXRlLCAkJHJBRiwgJHEpIHtcbiAgICByZXR1cm4ge1xuICAgICAgaGFzQmFja2Ryb3A6IHRydWUsXG4gICAgICBpc29sYXRlU2NvcGU6IHRydWUsXG4gICAgICBvblNob3c6IG9uU2hvdyxcbiAgICAgIG9uUmVtb3ZlOiBvblJlbW92ZSxcbiAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IGZhbHNlLFxuICAgICAgZXNjYXBlVG9DbG9zZTogdHJ1ZSxcbiAgICAgIHRhcmdldEV2ZW50OiBudWxsLFxuICAgICAgZm9jdXNPbk9wZW46IHRydWUsXG4gICAgICBkaXNhYmxlUGFyZW50U2Nyb2xsOiB0cnVlLFxuICAgICAgdHJhbnNmb3JtVGVtcGxhdGU6IGZ1bmN0aW9uKHRlbXBsYXRlKSB7XG4gICAgICAgIHJldHVybiAnPGRpdiBjbGFzcz1cIm1kLWRpYWxvZy1jb250YWluZXJcIj4nICsgdGVtcGxhdGUgKyAnPC9kaXY+JztcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gdHJhcEZvY3VzKGV2KSB7XG4gICAgICB2YXIgZGlhbG9nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbWQtZGlhbG9nJyk7XG5cbiAgICAgIGlmIChkaWFsb2cgJiYgIWRpYWxvZy5jb250YWlucyhldi50YXJnZXQpKSB7XG4gICAgICAgIGV2LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICBkaWFsb2cuZm9jdXMoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBPbiBzaG93IG1ldGhvZCBmb3IgZGlhbG9nc1xuICAgIGZ1bmN0aW9uIG9uU2hvdyhzY29wZSwgZWxlbWVudCwgb3B0aW9ucykge1xuICAgICAgYW5ndWxhci5lbGVtZW50KCRkb2N1bWVudFswXS5ib2R5KS5hZGRDbGFzcygnbWQtZGlhbG9nLWlzLXNob3dpbmcnKTtcbiAgICAgIGVsZW1lbnQgPSAkbWRVdGlsLmV4dHJhY3RFbGVtZW50QnlOYW1lKGVsZW1lbnQsICdtZC1kaWFsb2cnKTtcblxuICAgICAgLy8gSW5jYXNlIHRoZSB1c2VyIHByb3ZpZGVzIGEgcmF3IGRvbSBlbGVtZW50LCBhbHdheXMgd3JhcCBpdCBpbiBqcUxpdGVcbiAgICAgIG9wdGlvbnMucGFyZW50ID0gYW5ndWxhci5lbGVtZW50KG9wdGlvbnMucGFyZW50KTtcblxuICAgICAgb3B0aW9ucy5wb3BJblRhcmdldCA9IGFuZ3VsYXIuZWxlbWVudCgob3B0aW9ucy50YXJnZXRFdmVudCB8fCB7fSkudGFyZ2V0KTtcbiAgICAgIHZhciBjbG9zZUJ1dHRvbiA9IGZpbmRDbG9zZUJ1dHRvbigpO1xuXG4gICAgICBpZiAob3B0aW9ucy5oYXNCYWNrZHJvcCkge1xuICAgICAgICAvLyBGaXggZm9yIElFIDEwXG4gICAgICAgIHZhciBjb21wdXRlRnJvbSA9IChvcHRpb25zLnBhcmVudFswXSA9PSAkZG9jdW1lbnRbMF0uYm9keSAmJiAkZG9jdW1lbnRbMF0uZG9jdW1lbnRFbGVtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAmJiAkZG9jdW1lbnRbMF0uZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCkgPyBhbmd1bGFyLmVsZW1lbnQoJGRvY3VtZW50WzBdLmRvY3VtZW50RWxlbWVudCkgOiBvcHRpb25zLnBhcmVudDtcbiAgICAgICAgdmFyIHBhcmVudE9mZnNldCA9IGNvbXB1dGVGcm9tLnByb3AoJ3Njcm9sbFRvcCcpO1xuICAgICAgICBvcHRpb25zLmJhY2tkcm9wID0gYW5ndWxhci5lbGVtZW50KCc8bWQtYmFja2Ryb3AgY2xhc3M9XCJtZC1kaWFsb2ctYmFja2Ryb3AgbWQtb3BhcXVlXCI+Jyk7XG4gICAgICAgIG9wdGlvbnMuYmFja2Ryb3AuY3NzKCd0b3AnLCBwYXJlbnRPZmZzZXQgKydweCcpO1xuICAgICAgICAkbWRUaGVtaW5nLmluaGVyaXQob3B0aW9ucy5iYWNrZHJvcCwgb3B0aW9ucy5wYXJlbnQpO1xuICAgICAgICAkYW5pbWF0ZS5lbnRlcihvcHRpb25zLmJhY2tkcm9wLCBvcHRpb25zLnBhcmVudCk7XG4gICAgICAgIGVsZW1lbnQuY3NzKCd0b3AnLCBwYXJlbnRPZmZzZXQgKydweCcpO1xuICAgICAgfVxuXG4gICAgICB2YXIgcm9sZSA9ICdkaWFsb2cnLFxuICAgICAgICAgIGVsZW1lbnRUb0ZvY3VzID0gY2xvc2VCdXR0b247XG5cbiAgICAgIGlmIChvcHRpb25zLiR0eXBlID09PSAnYWxlcnQnKSB7XG4gICAgICAgIHJvbGUgPSAnYWxlcnRkaWFsb2cnO1xuICAgICAgICBlbGVtZW50VG9Gb2N1cyA9IGVsZW1lbnQuZmluZCgnbWQtZGlhbG9nLWNvbnRlbnQnKTtcbiAgICAgIH1cblxuICAgICAgY29uZmlndXJlQXJpYShlbGVtZW50LmZpbmQoJ21kLWRpYWxvZycpLCByb2xlLCBvcHRpb25zKTtcblxuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCB0cmFwRm9jdXMsIHRydWUpO1xuXG4gICAgICBpZiAob3B0aW9ucy5kaXNhYmxlUGFyZW50U2Nyb2xsKSB7XG4gICAgICAgIG9wdGlvbnMubGFzdE92ZXJmbG93ID0gb3B0aW9ucy5wYXJlbnQuY3NzKCdvdmVyZmxvdycpO1xuICAgICAgICBvcHRpb25zLnBhcmVudC5jc3MoJ292ZXJmbG93JywgJ2hpZGRlbicpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZGlhbG9nUG9wSW4oXG4gICAgICAgIGVsZW1lbnQsXG4gICAgICAgIG9wdGlvbnMucGFyZW50LFxuICAgICAgICBvcHRpb25zLnBvcEluVGFyZ2V0ICYmIG9wdGlvbnMucG9wSW5UYXJnZXQubGVuZ3RoICYmIG9wdGlvbnMucG9wSW5UYXJnZXRcbiAgICAgIClcbiAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIGFwcGx5QXJpYVRvU2libGluZ3MoZWxlbWVudCwgdHJ1ZSk7XG5cbiAgICAgICAgaWYgKG9wdGlvbnMuZXNjYXBlVG9DbG9zZSkge1xuICAgICAgICAgIG9wdGlvbnMucm9vdEVsZW1lbnRLZXl1cENhbGxiYWNrID0gZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gJG1kQ29uc3RhbnQuS0VZX0NPREUuRVNDQVBFKSB7XG4gICAgICAgICAgICAgICR0aW1lb3V0KCRtZERpYWxvZy5jYW5jZWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG4gICAgICAgICAgJHJvb3RFbGVtZW50Lm9uKCdrZXl1cCcsIG9wdGlvbnMucm9vdEVsZW1lbnRLZXl1cENhbGxiYWNrKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChvcHRpb25zLmNsaWNrT3V0c2lkZVRvQ2xvc2UpIHtcbiAgICAgICAgICBvcHRpb25zLmRpYWxvZ0NsaWNrT3V0c2lkZUNhbGxiYWNrID0gZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgIC8vIE9ubHkgY2xvc2UgaWYgd2UgY2xpY2sgdGhlIGZsZXggY29udGFpbmVyIG91dHNpZGUgdGhlIGJhY2tkcm9wXG4gICAgICAgICAgICBpZiAoZXYudGFyZ2V0ID09PSBlbGVtZW50WzBdKSB7XG4gICAgICAgICAgICAgICR0aW1lb3V0KCRtZERpYWxvZy5jYW5jZWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG4gICAgICAgICAgZWxlbWVudC5vbignY2xpY2snLCBvcHRpb25zLmRpYWxvZ0NsaWNrT3V0c2lkZUNhbGxiYWNrKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChvcHRpb25zLmZvY3VzT25PcGVuKSB7XG4gICAgICAgICAgZWxlbWVudFRvRm9jdXMuZm9jdXMoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cblxuICAgICAgZnVuY3Rpb24gZmluZENsb3NlQnV0dG9uKCkge1xuICAgICAgICAvL0lmIG5vIGVsZW1lbnQgd2l0aCBjbGFzcyBkaWFsb2ctY2xvc2UsIHRyeSB0byBmaW5kIHRoZSBsYXN0XG4gICAgICAgIC8vYnV0dG9uIGNoaWxkIGluIG1kLWFjdGlvbnMgYW5kIGFzc3VtZSBpdCBpcyBhIGNsb3NlIGJ1dHRvblxuICAgICAgICB2YXIgY2xvc2VCdXR0b24gPSBlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJy5kaWFsb2ctY2xvc2UnKTtcbiAgICAgICAgaWYgKCFjbG9zZUJ1dHRvbikge1xuICAgICAgICAgIHZhciBhY3Rpb25CdXR0b25zID0gZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yQWxsKCcubWQtYWN0aW9ucyBidXR0b24nKTtcbiAgICAgICAgICBjbG9zZUJ1dHRvbiA9IGFjdGlvbkJ1dHRvbnNbIGFjdGlvbkJ1dHRvbnMubGVuZ3RoIC0gMSBdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhbmd1bGFyLmVsZW1lbnQoY2xvc2VCdXR0b24pO1xuICAgICAgfVxuXG4gICAgfVxuXG4gICAgLy8gT24gcmVtb3ZlIGZ1bmN0aW9uIGZvciBhbGwgZGlhbG9nc1xuICAgIGZ1bmN0aW9uIG9uUmVtb3ZlKHNjb3BlLCBlbGVtZW50LCBvcHRpb25zKSB7XG4gICAgICBhbmd1bGFyLmVsZW1lbnQoJGRvY3VtZW50WzBdLmJvZHkpLnJlbW92ZUNsYXNzKCdtZC1kaWFsb2ctaXMtc2hvd2luZycpO1xuXG4gICAgICBpZiAob3B0aW9ucy5iYWNrZHJvcCkge1xuICAgICAgICAkYW5pbWF0ZS5sZWF2ZShvcHRpb25zLmJhY2tkcm9wKTtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRpb25zLmRpc2FibGVQYXJlbnRTY3JvbGwpIHtcbiAgICAgICAgb3B0aW9ucy5wYXJlbnQuY3NzKCdvdmVyZmxvdycsIG9wdGlvbnMubGFzdE92ZXJmbG93KTtcbiAgICAgICAgZGVsZXRlIG9wdGlvbnMubGFzdE92ZXJmbG93O1xuICAgICAgfVxuICAgICAgaWYgKG9wdGlvbnMuZXNjYXBlVG9DbG9zZSkge1xuICAgICAgICAkcm9vdEVsZW1lbnQub2ZmKCdrZXl1cCcsIG9wdGlvbnMucm9vdEVsZW1lbnRLZXl1cENhbGxiYWNrKTtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRpb25zLmNsaWNrT3V0c2lkZVRvQ2xvc2UpIHtcbiAgICAgICAgZWxlbWVudC5vZmYoJ2NsaWNrJywgb3B0aW9ucy5kaWFsb2dDbGlja091dHNpZGVDYWxsYmFjayk7XG4gICAgICB9XG5cbiAgICAgIGFwcGx5QXJpYVRvU2libGluZ3MoZWxlbWVudCwgZmFsc2UpO1xuXG4gICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdmb2N1cycsIHRyYXBGb2N1cywgdHJ1ZSk7XG5cbiAgICAgIHJldHVybiBkaWFsb2dQb3BPdXQoXG4gICAgICAgIGVsZW1lbnQsXG4gICAgICAgIG9wdGlvbnMucGFyZW50LFxuICAgICAgICBvcHRpb25zLnBvcEluVGFyZ2V0ICYmIG9wdGlvbnMucG9wSW5UYXJnZXQubGVuZ3RoICYmIG9wdGlvbnMucG9wSW5UYXJnZXRcbiAgICAgICkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgZWxlbWVudC5yZW1vdmUoKTtcbiAgICAgICAgb3B0aW9ucy5wb3BJblRhcmdldCAmJiBvcHRpb25zLnBvcEluVGFyZ2V0LmZvY3VzKCk7XG4gICAgICB9KTtcblxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEluamVjdCBBUklBLXNwZWNpZmljIGF0dHJpYnV0ZXMgYXBwcm9wcmlhdGUgZm9yIERpYWxvZ3NcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb25maWd1cmVBcmlhKGVsZW1lbnQsIHJvbGUsIG9wdGlvbnMpIHtcblxuICAgICAgZWxlbWVudC5hdHRyKHtcbiAgICAgICAgJ3JvbGUnOiByb2xlLFxuICAgICAgICAndGFiSW5kZXgnOiAnLTEnXG4gICAgICB9KTtcblxuICAgICAgdmFyIGRpYWxvZ0NvbnRlbnQgPSBlbGVtZW50LmZpbmQoJ21kLWRpYWxvZy1jb250ZW50Jyk7XG4gICAgICBpZiAoZGlhbG9nQ29udGVudC5sZW5ndGggPT09IDApe1xuICAgICAgICBkaWFsb2dDb250ZW50ID0gZWxlbWVudDtcbiAgICAgIH1cblxuICAgICAgdmFyIGRpYWxvZ0lkID0gZWxlbWVudC5hdHRyKCdpZCcpIHx8ICgnZGlhbG9nXycgKyAkbWRVdGlsLm5leHRVaWQoKSk7XG4gICAgICBkaWFsb2dDb250ZW50LmF0dHIoJ2lkJywgZGlhbG9nSWQpO1xuICAgICAgZWxlbWVudC5hdHRyKCdhcmlhLWRlc2NyaWJlZGJ5JywgZGlhbG9nSWQpO1xuXG4gICAgICBpZiAob3B0aW9ucy5hcmlhTGFiZWwpIHtcbiAgICAgICAgJG1kQXJpYS5leHBlY3QoZWxlbWVudCwgJ2FyaWEtbGFiZWwnLCBvcHRpb25zLmFyaWFMYWJlbCk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgJG1kQXJpYS5leHBlY3RBc3luYyhlbGVtZW50LCAnYXJpYS1sYWJlbCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciB3b3JkcyA9IGRpYWxvZ0NvbnRlbnQudGV4dCgpLnNwbGl0KC9cXHMrLyk7XG4gICAgICAgICAgaWYgKHdvcmRzLmxlbmd0aCA+IDMpIHdvcmRzID0gd29yZHMuc2xpY2UoMCwzKS5jb25jYXQoJy4uLicpO1xuICAgICAgICAgIHJldHVybiB3b3Jkcy5qb2luKCcgJyk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBVdGlsaXR5IGZ1bmN0aW9uIHRvIGZpbHRlciBvdXQgcmF3IERPTSBub2Rlc1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzTm9kZU9uZU9mKGVsZW0sIG5vZGVUeXBlQXJyYXkpIHtcbiAgICAgIGlmIChub2RlVHlwZUFycmF5LmluZGV4T2YoZWxlbS5ub2RlTmFtZSkgIT09IC0xKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBXYWxrIERPTSB0byBhcHBseSBvciByZW1vdmUgYXJpYS1oaWRkZW4gb24gc2libGluZyBub2Rlc1xuICAgICAqIGFuZCBwYXJlbnQgc2libGluZyBub2Rlc1xuICAgICAqXG4gICAgICogUHJldmVudHMgc2NyZWVuIHJlYWRlciBpbnRlcmFjdGlvbiBiZWhpbmQgbW9kYWwgd2luZG93XG4gICAgICogb24gc3dpcGUgaW50ZXJmYWNlc1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFwcGx5QXJpYVRvU2libGluZ3MoZWxlbWVudCwgdmFsdWUpIHtcbiAgICAgIHZhciBhdHRyaWJ1dGUgPSAnYXJpYS1oaWRkZW4nO1xuXG4gICAgICAvLyBnZXQgcmF3IERPTSBub2RlXG4gICAgICBlbGVtZW50ID0gZWxlbWVudFswXTtcblxuICAgICAgZnVuY3Rpb24gd2Fsa0RPTShlbGVtZW50KSB7XG4gICAgICAgIHdoaWxlIChlbGVtZW50LnBhcmVudE5vZGUpIHtcbiAgICAgICAgICBpZiAoZWxlbWVudCA9PT0gZG9jdW1lbnQuYm9keSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgY2hpbGRyZW4gPSBlbGVtZW50LnBhcmVudE5vZGUuY2hpbGRyZW47XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgLy8gc2tpcCBvdmVyIGNoaWxkIGlmIGl0IGlzIGFuIGFzY2VuZGFudCBvZiB0aGUgZGlhbG9nXG4gICAgICAgICAgICAvLyBvciBhIHNjcmlwdCBvciBzdHlsZSB0YWdcbiAgICAgICAgICAgIGlmIChlbGVtZW50ICE9PSBjaGlsZHJlbltpXSAmJiAhaXNOb2RlT25lT2YoY2hpbGRyZW5baV0sIFsnU0NSSVBUJywgJ1NUWUxFJ10pKSB7XG4gICAgICAgICAgICAgIGNoaWxkcmVuW2ldLnNldEF0dHJpYnV0ZShhdHRyaWJ1dGUsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICB3YWxrRE9NKGVsZW1lbnQgPSBlbGVtZW50LnBhcmVudE5vZGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB3YWxrRE9NKGVsZW1lbnQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRpYWxvZ1BvcEluKGNvbnRhaW5lciwgcGFyZW50RWxlbWVudCwgY2xpY2tFbGVtZW50KSB7XG4gICAgICB2YXIgZGlhbG9nRWwgPSBjb250YWluZXIuZmluZCgnbWQtZGlhbG9nJyk7XG5cbiAgICAgIHBhcmVudEVsZW1lbnQuYXBwZW5kKGNvbnRhaW5lcik7XG4gICAgICB0cmFuc2Zvcm1Ub0NsaWNrRWxlbWVudChkaWFsb2dFbCwgY2xpY2tFbGVtZW50KTtcblxuICAgICAgJCRyQUYoZnVuY3Rpb24oKSB7XG4gICAgICAgIGRpYWxvZ0VsLmFkZENsYXNzKCd0cmFuc2l0aW9uLWluJylcbiAgICAgICAgICAuY3NzKCRtZENvbnN0YW50LkNTUy5UUkFOU0ZPUk0sICcnKTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gJG1kVXRpbC50cmFuc2l0aW9uRW5kUHJvbWlzZShkaWFsb2dFbCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGlhbG9nUG9wT3V0KGNvbnRhaW5lciwgcGFyZW50RWxlbWVudCwgY2xpY2tFbGVtZW50KSB7XG4gICAgICB2YXIgZGlhbG9nRWwgPSBjb250YWluZXIuZmluZCgnbWQtZGlhbG9nJyk7XG5cbiAgICAgIGRpYWxvZ0VsLmFkZENsYXNzKCd0cmFuc2l0aW9uLW91dCcpLnJlbW92ZUNsYXNzKCd0cmFuc2l0aW9uLWluJyk7XG4gICAgICB0cmFuc2Zvcm1Ub0NsaWNrRWxlbWVudChkaWFsb2dFbCwgY2xpY2tFbGVtZW50KTtcblxuICAgICAgcmV0dXJuICRtZFV0aWwudHJhbnNpdGlvbkVuZFByb21pc2UoZGlhbG9nRWwpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHRyYW5zZm9ybVRvQ2xpY2tFbGVtZW50KGRpYWxvZ0VsLCBjbGlja0VsZW1lbnQpIHtcbiAgICAgIGlmIChjbGlja0VsZW1lbnQpIHtcbiAgICAgICAgdmFyIGNsaWNrUmVjdCA9IGNsaWNrRWxlbWVudFswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgdmFyIGRpYWxvZ1JlY3QgPSBkaWFsb2dFbFswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgICAgICB2YXIgc2NhbGVYID0gTWF0aC5taW4oMC41LCBjbGlja1JlY3Qud2lkdGggLyBkaWFsb2dSZWN0LndpZHRoKTtcbiAgICAgICAgdmFyIHNjYWxlWSA9IE1hdGgubWluKDAuNSwgY2xpY2tSZWN0LmhlaWdodCAvIGRpYWxvZ1JlY3QuaGVpZ2h0KTtcblxuICAgICAgICBkaWFsb2dFbC5jc3MoJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STSwgJ3RyYW5zbGF0ZTNkKCcgK1xuICAgICAgICAgICgtZGlhbG9nUmVjdC5sZWZ0ICsgY2xpY2tSZWN0LmxlZnQgKyBjbGlja1JlY3Qud2lkdGgvMiAtIGRpYWxvZ1JlY3Qud2lkdGgvMikgKyAncHgsJyArXG4gICAgICAgICAgKC1kaWFsb2dSZWN0LnRvcCArIGNsaWNrUmVjdC50b3AgKyBjbGlja1JlY3QuaGVpZ2h0LzIgLSBkaWFsb2dSZWN0LmhlaWdodC8yKSArICdweCwnICtcbiAgICAgICAgICAnMCkgc2NhbGUoJyArIHNjYWxlWCArICcsJyArIHNjYWxlWSArICcpJ1xuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRpYWxvZ1RyYW5zaXRpb25FbmQoZGlhbG9nRWwpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICBkaWFsb2dFbC5vbigkbWRDb25zdGFudC5DU1MuVFJBTlNJVElPTkVORCwgZmluaXNoZWQpO1xuICAgICAgZnVuY3Rpb24gZmluaXNoZWQoZXYpIHtcbiAgICAgICAgLy9NYWtlIHN1cmUgdGhpcyB0cmFuc2l0aW9uZW5kIGRpZG4ndCBidWJibGUgdXAgZnJvbSBhIGNoaWxkXG4gICAgICAgIGlmIChldi50YXJnZXQgPT09IGRpYWxvZ0VsWzBdKSB7XG4gICAgICAgICAgZGlhbG9nRWwub2ZmKCRtZENvbnN0YW50LkNTUy5UUkFOU0lUSU9ORU5ELCBmaW5pc2hlZCk7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICB9XG5cbiAgfVxufVxuTWREaWFsb2dQcm92aWRlci4kaW5qZWN0ID0gW1wiJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyXCJdO1xuXG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBAbmdkb2MgbW9kdWxlXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLmRpdmlkZXJcbiAqIEBkZXNjcmlwdGlvbiBEaXZpZGVyIG1vZHVsZSFcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuZGl2aWRlcicsIFtcbiAgJ21hdGVyaWFsLmNvcmUnXG5dKVxuICAuZGlyZWN0aXZlKCdtZERpdmlkZXInLCBNZERpdmlkZXJEaXJlY3RpdmUpO1xuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG1kRGl2aWRlclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmRpdmlkZXJcbiAqIEByZXN0cmljdCBFXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBEaXZpZGVycyBncm91cCBhbmQgc2VwYXJhdGUgY29udGVudCB3aXRoaW4gbGlzdHMgYW5kIHBhZ2UgbGF5b3V0cyB1c2luZyBzdHJvbmcgdmlzdWFsIGFuZCBzcGF0aWFsIGRpc3RpbmN0aW9ucy4gVGhpcyBkaXZpZGVyIGlzIGEgdGhpbiBydWxlLCBsaWdodHdlaWdodCBlbm91Z2ggdG8gbm90IGRpc3RyYWN0IHRoZSB1c2VyIGZyb20gY29udGVudC5cbiAqXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBtZC1pbnNldCBBZGQgdGhpcyBhdHRyaWJ1dGUgdG8gYWN0aXZhdGUgdGhlIGluc2V0IGRpdmlkZXIgc3R5bGUuXG4gKiBAdXNhZ2VcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiA8bWQtZGl2aWRlcj48L21kLWRpdmlkZXI+XG4gKlxuICogPG1kLWRpdmlkZXIgbWQtaW5zZXQ+PC9tZC1kaXZpZGVyPlxuICogPC9obGpzPlxuICpcbiAqL1xuZnVuY3Rpb24gTWREaXZpZGVyRGlyZWN0aXZlKCRtZFRoZW1pbmcpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0UnLFxuICAgIGxpbms6ICRtZFRoZW1pbmdcbiAgfTtcbn1cbk1kRGl2aWRlckRpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kVGhlbWluZ1wiXTtcblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmZhYkFjdGlvbnMnLCBbJ21hdGVyaWFsLmNvcmUnXSlcbiAgICAuZGlyZWN0aXZlKCdtZEZhYkFjdGlvbnMnLCBNZEZhYkFjdGlvbnNEaXJlY3RpdmUpO1xuXG4gIC8qKlxuICAgKiBAbmdkb2MgZGlyZWN0aXZlXG4gICAqIEBuYW1lIG1kRmFiQWN0aW9uc1xuICAgKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuZmFiU3BlZWREaWFsXG4gICAqXG4gICAqIEByZXN0cmljdCBFXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBUaGUgYDxtZC1mYWItYWN0aW9ucz5gIGRpcmVjdGl2ZSBpcyB1c2VkIGluc2lkZSBvZiBhIGA8bWQtZmFiLXNwZWVkLWRpYWw+YCBvclxuICAgKiBgPG1kLWZhYi10b29sYmFyPmAgZGlyZWN0aXZlIHRvIG1hcmsgdGhlIGFuIGVsZW1lbnQgKG9yIGVsZW1lbnRzKSBhcyB0aGUgYWN0aW9ucyBhbmQgc2V0dXAgdGhlXG4gICAqIHByb3BlciBldmVudCBsaXN0ZW5lcnMuXG4gICAqXG4gICAqIEB1c2FnZVxuICAgKiBTZWUgdGhlIGA8bWQtZmFiLXNwZWVkLWRpYWw+YCBvciBgPG1kLWZhYi10b29sYmFyPmAgZGlyZWN0aXZlcyBmb3IgZXhhbXBsZSB1c2FnZS5cbiAgICovXG4gIGZ1bmN0aW9uIE1kRmFiQWN0aW9uc0RpcmVjdGl2ZSgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcmVzdHJpY3Q6ICdFJyxcblxuICAgICAgcmVxdWlyZTogWydeP21kRmFiU3BlZWREaWFsJywgJ14/bWRGYWJUb29sYmFyJ10sXG5cbiAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyaWJ1dGVzLCBjb250cm9sbGVycykge1xuICAgICAgICAvLyBHcmFiIHdoaWNoZXZlciBwYXJlbnQgY29udHJvbGxlciBpcyB1c2VkXG4gICAgICAgIHZhciBjb250cm9sbGVyID0gY29udHJvbGxlcnNbMF0gfHwgY29udHJvbGxlcnNbMV07XG5cbiAgICAgICAgLy8gTWFrZSB0aGUgY2hpbGRyZW4gb3Blbi9jbG9zZSB0aGVpciBwYXJlbnQgZGlyZWN0aXZlXG4gICAgICAgIGlmIChjb250cm9sbGVyKSB7XG4gICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGVsZW1lbnQuY2hpbGRyZW4oKSwgZnVuY3Rpb24oY2hpbGQpIHtcbiAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChjaGlsZCkub24oJ2ZvY3VzJywgY29udHJvbGxlci5vcGVuKTtcbiAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChjaGlsZCkub24oJ2JsdXInLCBjb250cm9sbGVyLmNsb3NlKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFmdGVyIHNldHRpbmcgdXAgdGhlIGxpc3RlbmVycywgd3JhcCBldmVyeSBjaGlsZCBpbiBhIG5ldyBkaXYgYW5kIGFkZCBhIGNsYXNzIHRoYXQgd2UgY2FuXG4gICAgICAgIC8vIHNjYWxlL2ZsaW5nIGluZGVwZW5kZW50bHlcbiAgICAgICAgZWxlbWVudC5jaGlsZHJlbigpLndyYXAoJzxkaXYgY2xhc3M9XCJtZC1mYWItYWN0aW9uLWl0ZW1cIj4nKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxufSkoKTtcbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG4oZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5mYWJTcGVlZERpYWwnLCBbXG4gICAgICAnbWF0ZXJpYWwuY29yZScsXG4gICAgICAnbWF0ZXJpYWwuY29tcG9uZW50cy5mYWJUcmlnZ2VyJyxcbiAgICAgICdtYXRlcmlhbC5jb21wb25lbnRzLmZhYkFjdGlvbnMnXG4gICAgXSlcbiAgICAuZGlyZWN0aXZlKCdtZEZhYlNwZWVkRGlhbCcsIE1kRmFiU3BlZWREaWFsRGlyZWN0aXZlKVxuICAgIC5hbmltYXRpb24oJy5tZC1mbGluZycsIE1kRmFiU3BlZWREaWFsRmxpbmdBbmltYXRpb24pXG4gICAgLmFuaW1hdGlvbignLm1kLXNjYWxlJywgTWRGYWJTcGVlZERpYWxTY2FsZUFuaW1hdGlvbik7XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAgICogQG5hbWUgbWRGYWJTcGVlZERpYWxcbiAgICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmZhYlNwZWVkRGlhbFxuICAgKlxuICAgKiBAcmVzdHJpY3QgRVxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogVGhlIGA8bWQtZmFiLXNwZWVkLWRpYWw+YCBkaXJlY3RpdmUgaXMgdXNlZCB0byBwcmVzZW50IGEgc2VyaWVzIG9mIHBvcHVwIGVsZW1lbnRzICh1c3VhbGx5XG4gICAqIGA8bWQtYnV0dG9uPmBzKSBmb3IgcXVpY2sgYWNjZXNzIHRvIGNvbW1vbiBhY3Rpb25zLlxuICAgKlxuICAgKiBUaGVyZSBhcmUgY3VycmVudGx5IHR3byBhbmltYXRpb25zIGF2YWlsYWJsZSBieSBhcHBseWluZyBvbmUgb2YgdGhlIGZvbGxvd2luZyBjbGFzc2VzIHRvXG4gICAqIHRoZSBjb21wb25lbnQ6XG4gICAqXG4gICAqICAtIGBtZC1mbGluZ2AgLSBUaGUgc3BlZWQgZGlhbCBpdGVtcyBhcHBlYXIgZnJvbSB1bmRlcm5lYXRoIHRoZSB0cmlnZ2VyIGFuZCBtb3ZlIGludG8gdGhlaXJcbiAgICogICAgYXBwcm9wcmlhdGUgcG9zaXRpb25zLlxuICAgKiAgLSBgbWQtc2NhbGVgIC0gVGhlIHNwZWVkIGRpYWwgaXRlbXMgYXBwZWFyIGluIHRoZWlyIHByb3BlciBwbGFjZXMgYnkgc2NhbGluZyBmcm9tIDAlIHRvIDEwMCUuXG4gICAqXG4gICAqIEB1c2FnZVxuICAgKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxuICAgKiA8bWQtZmFiLXNwZWVkLWRpYWwgZGlyZWN0aW9uPVwidXBcIiBjbGFzcz1cIm1kLWZsaW5nXCI+XG4gICAqICAgPG1kLWZhYi10cmlnZ2VyPlxuICAgKiAgICAgPG1kLWJ1dHRvbiBhcmlhLWxhYmVsPVwiQWRkLi4uXCI+PG1kLWljb24gaWNvbj1cIi9pbWcvaWNvbnMvcGx1cy5zdmdcIj48L21kLWljb24+PC9tZC1idXR0b24+XG4gICAqICAgPC9tZC1mYWItdHJpZ2dlcj5cbiAgICpcbiAgICogICA8bWQtZmFiLWFjdGlvbnM+XG4gICAqICAgICA8bWQtYnV0dG9uIGFyaWEtbGFiZWw9XCJBZGQgVXNlclwiPlxuICAgKiAgICAgICA8bWQtaWNvbiBpY29uPVwiL2ltZy9pY29ucy91c2VyLnN2Z1wiPjwvbWQtaWNvbj5cbiAgICogICAgIDwvbWQtYnV0dG9uPlxuICAgKlxuICAgKiAgICAgPG1kLWJ1dHRvbiBhcmlhLWxhYmVsPVwiQWRkIEdyb3VwXCI+XG4gICAqICAgICAgIDxtZC1pY29uIGljb249XCIvaW1nL2ljb25zL2dyb3VwLnN2Z1wiPjwvbWQtaWNvbj5cbiAgICogICAgIDwvbWQtYnV0dG9uPlxuICAgKiAgIDwvbWQtZmFiLWFjdGlvbnM+XG4gICAqIDwvbWQtZmFiLXNwZWVkLWRpYWw+XG4gICAqIDwvaGxqcz5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBtZC1kaXJlY3Rpb24gRnJvbSB3aGljaCBkaXJlY3Rpb24geW91IHdvdWxkIGxpa2UgdGhlIHNwZWVkIGRpYWwgdG8gYXBwZWFyXG4gICAqIHJlbGF0aXZlIHRvIHRoZSB0cmlnZ2VyIGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7ZXhwcmVzc2lvbj19IG1kLW9wZW4gUHJvZ3JhbW1hdGljYWxseSBjb250cm9sIHdoZXRoZXIgb3Igbm90IHRoZSBzcGVlZC1kaWFsIGlzIHZpc2libGUuXG4gICAqL1xuICBmdW5jdGlvbiBNZEZhYlNwZWVkRGlhbERpcmVjdGl2ZSgpIHtcbiAgICBGYWJTcGVlZERpYWxDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkZWxlbWVudFwiLCBcIiRhbmltYXRlXCJdO1xuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogJ0UnLFxuXG4gICAgICBzY29wZToge1xuICAgICAgICBkaXJlY3Rpb246ICdAP21kRGlyZWN0aW9uJyxcbiAgICAgICAgaXNPcGVuOiAnPT9tZE9wZW4nXG4gICAgICB9LFxuXG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogRmFiU3BlZWREaWFsQ29udHJvbGxlcixcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcblxuICAgICAgbGluazogRmFiU3BlZWREaWFsTGlua1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBGYWJTcGVlZERpYWxMaW5rKHNjb3BlLCBlbGVtZW50KSB7XG4gICAgICAvLyBQcmVwZW5kIGFuIGVsZW1lbnQgdG8gaG9sZCBvdXIgQ1NTIHZhcmlhYmxlcyBzbyB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIGFuaW1hdGlvbnMgYmVsb3dcbiAgICAgIGVsZW1lbnQucHJlcGVuZCgnPGRpdiBjbGFzcz1cIm1kLWNzcy12YXJpYWJsZXNcIj48L2Rpdj4nKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBGYWJTcGVlZERpYWxDb250cm9sbGVyKCRzY29wZSwgJGVsZW1lbnQsICRhbmltYXRlKSB7XG4gICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAvLyBEZWZpbmUgb3VyIG9wZW4vY2xvc2UgZnVuY3Rpb25zXG4gICAgICAvLyBOb3RlOiBVc2VkIGJ5IGZhYlRyaWdnZXIgYW5kIGZhYkFjdGlvbnMgZGlyZWN0aXZlc1xuICAgICAgdm0ub3BlbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAkc2NvcGUuJGFwcGx5KCd2bS5pc09wZW4gPSB0cnVlJyk7XG4gICAgICB9O1xuXG4gICAgICB2bS5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAkc2NvcGUuJGFwcGx5KCd2bS5pc09wZW4gPSBmYWxzZScpO1xuICAgICAgfTtcblxuICAgICAgc2V0dXBEZWZhdWx0cygpO1xuICAgICAgc2V0dXBMaXN0ZW5lcnMoKTtcbiAgICAgIHNldHVwV2F0Y2hlcnMoKTtcblxuICAgICAgLy8gU2V0IG91ciBkZWZhdWx0IHZhcmlhYmxlc1xuICAgICAgZnVuY3Rpb24gc2V0dXBEZWZhdWx0cygpIHtcbiAgICAgICAgLy8gU2V0IHRoZSBkZWZhdWx0IGRpcmVjdGlvbiB0byAnZG93bicgaWYgbm9uZSBpcyBzcGVjaWZpZWRcbiAgICAgICAgdm0uZGlyZWN0aW9uID0gdm0uZGlyZWN0aW9uIHx8ICdkb3duJztcblxuICAgICAgICAvLyBTZXQgdGhlIGRlZmF1bHQgdG8gYmUgY2xvc2VkXG4gICAgICAgIHZtLmlzT3BlbiA9IHZtLmlzT3BlbiB8fCBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgLy8gU2V0dXAgb3VyIGV2ZW50IGxpc3RlbmVyc1xuICAgICAgZnVuY3Rpb24gc2V0dXBMaXN0ZW5lcnMoKSB7XG4gICAgICAgICRlbGVtZW50Lm9uKCdtb3VzZWVudGVyJywgdm0ub3Blbik7XG4gICAgICAgICRlbGVtZW50Lm9uKCdtb3VzZWxlYXZlJywgdm0uY2xvc2UpO1xuICAgICAgfVxuXG4gICAgICAvLyBTZXR1cCBvdXIgd2F0Y2hlcnNcbiAgICAgIGZ1bmN0aW9uIHNldHVwV2F0Y2hlcnMoKSB7XG4gICAgICAgIC8vIFdhdGNoIGZvciBjaGFuZ2VzIHRvIHRoZSBkaXJlY3Rpb24gYW5kIHVwZGF0ZSBjbGFzc2VzL2F0dHJpYnV0ZXNcbiAgICAgICAgJHNjb3BlLiR3YXRjaCgndm0uZGlyZWN0aW9uJywgZnVuY3Rpb24obmV3RGlyLCBvbGREaXIpIHtcbiAgICAgICAgICAvLyBBZGQgdGhlIGFwcHJvcHJpYXRlIGNsYXNzZXMgc28gd2UgY2FuIHRhcmdldCB0aGUgZGlyZWN0aW9uIGluIHRoZSBDU1NcbiAgICAgICAgICAkYW5pbWF0ZS5yZW1vdmVDbGFzcygkZWxlbWVudCwgJ21kLScgKyBvbGREaXIpO1xuICAgICAgICAgICRhbmltYXRlLmFkZENsYXNzKCRlbGVtZW50LCAnbWQtJyArIG5ld0Rpcik7XG4gICAgICAgIH0pO1xuXG5cbiAgICAgICAgLy8gV2F0Y2ggZm9yIGNoYW5nZXMgdG8gbWQtb3BlblxuICAgICAgICAkc2NvcGUuJHdhdGNoKCd2bS5pc09wZW4nLCBmdW5jdGlvbihpc09wZW4pIHtcbiAgICAgICAgICB2YXIgdG9BZGQgPSBpc09wZW4gPyAnbWQtaXMtb3BlbicgOiAnJztcbiAgICAgICAgICB2YXIgdG9SZW1vdmUgPSBpc09wZW4gPyAnJyA6ICdtZC1pcy1vcGVuJztcblxuICAgICAgICAgICRhbmltYXRlLnNldENsYXNzKCRlbGVtZW50LCB0b0FkZCwgdG9SZW1vdmUpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBNZEZhYlNwZWVkRGlhbEZsaW5nQW5pbWF0aW9uKCkge1xuICAgIGZ1bmN0aW9uIHJ1bkFuaW1hdGlvbihlbGVtZW50KSB7XG4gICAgICB2YXIgZWwgPSBlbGVtZW50WzBdO1xuICAgICAgdmFyIGN0cmwgPSBlbGVtZW50LmNvbnRyb2xsZXIoJ21kRmFiU3BlZWREaWFsJyk7XG4gICAgICB2YXIgaXRlbXMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKCcubWQtZmFiLWFjdGlvbi1pdGVtJyk7XG5cbiAgICAgIC8vIEdyYWIgb3VyIGVsZW1lbnQgd2hpY2ggc3RvcmVzIENTUyB2YXJpYWJsZXNcbiAgICAgIHZhciB2YXJpYWJsZXNFbGVtZW50ID0gZWwucXVlcnlTZWxlY3RvcignLm1kLWNzcy12YXJpYWJsZXMnKTtcblxuICAgICAgLy8gU2V0dXAgSlMgdmFyaWFibGVzIGJhc2VkIG9uIG91ciBDU1MgdmFyaWFibGVzXG4gICAgICB2YXIgc3RhcnRaSW5kZXggPSB2YXJpYWJsZXNFbGVtZW50LnN0eWxlLnpJbmRleDtcblxuICAgICAgLy8gQWx3YXlzIHJlc2V0IHRoZSBpdGVtcyB0byB0aGVpciBuYXR1cmFsIHBvc2l0aW9uL3N0YXRlXG4gICAgICBhbmd1bGFyLmZvckVhY2goaXRlbXMsIGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XG4gICAgICAgIHZhciBzdHlsZXMgPSBpdGVtLnN0eWxlO1xuXG4gICAgICAgIHN0eWxlcy50cmFuc2Zvcm0gPSAnJztcbiAgICAgICAgc3R5bGVzLnRyYW5zaXRpb25EZWxheSA9ICcnO1xuICAgICAgICBzdHlsZXMub3BhY2l0eSA9IDE7XG5cbiAgICAgICAgLy8gTWFrZSB0aGUgaXRlbXMgY2xvc2VzdCB0byB0aGUgdHJpZ2dlciBoYXZlIHRoZSBoaWdoZXN0IHotaW5kZXhcbiAgICAgICAgaXRlbS5zdHlsZS56SW5kZXggPSAoaXRlbXMubGVuZ3RoIC0gaW5kZXgpICsgc3RhcnRaSW5kZXg7XG4gICAgICB9KTtcblxuICAgICAgLy8gSWYgdGhlIGNvbnRyb2wgaXMgY2xvc2VkLCBoaWRlIHRoZSBpdGVtcyBiZWhpbmQgdGhlIHRyaWdnZXJcbiAgICAgIGlmICghY3RybC5pc09wZW4pIHtcbiAgICAgICAgYW5ndWxhci5mb3JFYWNoKGl0ZW1zLCBmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuICAgICAgICAgIHZhciBuZXdQb3NpdGlvbiwgYXhpcztcblxuICAgICAgICAgIHN3aXRjaCAoY3RybC5kaXJlY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgJ3VwJzpcbiAgICAgICAgICAgICAgbmV3UG9zaXRpb24gPSBpdGVtLnNjcm9sbEhlaWdodCAqIChpbmRleCArIDEpO1xuICAgICAgICAgICAgICBheGlzID0gJ1knO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2Rvd24nOlxuICAgICAgICAgICAgICBuZXdQb3NpdGlvbiA9IC1pdGVtLnNjcm9sbEhlaWdodCAqIChpbmRleCArIDEpO1xuICAgICAgICAgICAgICBheGlzID0gJ1knO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2xlZnQnOlxuICAgICAgICAgICAgICBuZXdQb3NpdGlvbiA9IGl0ZW0uc2Nyb2xsV2lkdGggKiAoaW5kZXggKyAxKTtcbiAgICAgICAgICAgICAgYXhpcyA9ICdYJztcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdyaWdodCc6XG4gICAgICAgICAgICAgIG5ld1Bvc2l0aW9uID0gLWl0ZW0uc2Nyb2xsV2lkdGggKiAoaW5kZXggKyAxKTtcbiAgICAgICAgICAgICAgYXhpcyA9ICdYJztcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaXRlbS5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlJyArIGF4aXMgKyAnKCcgKyBuZXdQb3NpdGlvbiArICdweCknO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgYWRkQ2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgZG9uZSkge1xuICAgICAgICBpZiAoZWxlbWVudC5oYXNDbGFzcygnbWQtZmxpbmcnKSkge1xuICAgICAgICAgIHJ1bkFuaW1hdGlvbihlbGVtZW50KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHJlbW92ZUNsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGRvbmUpIHtcbiAgICAgICAgcnVuQW5pbWF0aW9uKGVsZW1lbnQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIE1kRmFiU3BlZWREaWFsU2NhbGVBbmltYXRpb24oKSB7XG4gICAgdmFyIGRlbGF5ID0gNjU7XG5cbiAgICBmdW5jdGlvbiBydW5BbmltYXRpb24oZWxlbWVudCkge1xuICAgICAgdmFyIGVsID0gZWxlbWVudFswXTtcbiAgICAgIHZhciBjdHJsID0gZWxlbWVudC5jb250cm9sbGVyKCdtZEZhYlNwZWVkRGlhbCcpO1xuICAgICAgdmFyIGl0ZW1zID0gZWwucXVlcnlTZWxlY3RvckFsbCgnLm1kLWZhYi1hY3Rpb24taXRlbScpO1xuXG4gICAgICAvLyBBbHdheXMgcmVzZXQgdGhlIGl0ZW1zIHRvIHRoZWlyIG5hdHVyYWwgcG9zaXRpb24vc3RhdGVcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChpdGVtcywgZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHtcbiAgICAgICAgdmFyIHN0eWxlcyA9IGl0ZW0uc3R5bGUsXG4gICAgICAgICAgb2Zmc2V0RGVsYXkgPSBpbmRleCAqIGRlbGF5O1xuXG4gICAgICAgIHN0eWxlcy5vcGFjaXR5ID0gY3RybC5pc09wZW4gPyAxIDogMDtcbiAgICAgICAgc3R5bGVzLnRyYW5zZm9ybSA9IGN0cmwuaXNPcGVuID8gJ3NjYWxlKDEpJyA6ICdzY2FsZSgwKSc7XG4gICAgICAgIHN0eWxlcy50cmFuc2l0aW9uRGVsYXkgPSAoY3RybC5pc09wZW4gPyAgb2Zmc2V0RGVsYXkgOiAoaXRlbXMubGVuZ3RoIC0gb2Zmc2V0RGVsYXkpKSArICdtcyc7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgYWRkQ2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgZG9uZSkge1xuICAgICAgICBydW5BbmltYXRpb24oZWxlbWVudCk7XG4gICAgICB9LFxuXG4gICAgICByZW1vdmVDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lKSB7XG4gICAgICAgIHJ1bkFuaW1hdGlvbihlbGVtZW50KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG4oZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5mYWJUb29sYmFyJywgW1xuICAgICAgJ21hdGVyaWFsLmNvcmUnLFxuICAgICAgJ21hdGVyaWFsLmNvbXBvbmVudHMuZmFiVHJpZ2dlcicsXG4gICAgICAnbWF0ZXJpYWwuY29tcG9uZW50cy5mYWJBY3Rpb25zJ1xuICAgIF0pXG4gICAgLmRpcmVjdGl2ZSgnbWRGYWJUb29sYmFyJywgTWRGYWJUb29sYmFyRGlyZWN0aXZlKVxuICAgIC5hbmltYXRpb24oJy5tZC1mYWItdG9vbGJhcicsIE1kRmFiVG9vbGJhckFuaW1hdGlvbik7XG5cbiAgLyoqXG4gICAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAgICogQG5hbWUgbWRGYWJUb29sYmFyXG4gICAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5mYWJUb29sYmFyXG4gICAqXG4gICAqIEByZXN0cmljdCBFXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBUaGUgYDxtZC1mYWItdG9vbGJhcj5gIGRpcmVjdGl2ZSBpcyB1c2VkIHByZXNlbnQgYSB0b29sYmFyIG9mIGVsZW1lbnRzICh1c3VhbGx5IGA8bWQtYnV0dG9uPmBzKVxuICAgKiBmb3IgcXVpY2sgYWNjZXNzIHRvIGNvbW1vbiBhY3Rpb25zIHdoZW4gYSBmbG9hdGluZyBhY3Rpb24gYnV0dG9uIGlzIGFjdGl2YXRlZCAodmlhIGhvdmVyIG9yXG4gICAqIGtleWJvYXJkIG5hdmlnYXRpb24pLlxuICAgKlxuICAgKiBAdXNhZ2VcbiAgICpcbiAgICogPGhsanMgbGFuZz1cImh0bWxcIj5cbiAgICogPG1kLWZhYi10b29sYmFyPlxuICAgKiAgIDxtZC1mYWItdHJpZ2dlcj5cbiAgICogICAgIDxtZC1idXR0b24gYXJpYS1sYWJlbD1cIkFkZC4uLlwiPjxtZC1pY29uIGljb249XCIvaW1nL2ljb25zL3BsdXMuc3ZnXCI+PC9tZC1pY29uPjwvbWQtYnV0dG9uPlxuICAgKiAgIDwvbWQtZmFiLXRyaWdnZXI+XG4gICAqXG4gICAqICAgPG1kLWZhYi1hY3Rpb25zPlxuICAgKiAgICAgPG1kLWJ1dHRvbiBhcmlhLWxhYmVsPVwiQWRkIFVzZXJcIj5cbiAgICogICAgICAgPG1kLWljb24gaWNvbj1cIi9pbWcvaWNvbnMvdXNlci5zdmdcIj48L21kLWljb24+XG4gICAqICAgICA8L21kLWJ1dHRvbj5cbiAgICpcbiAgICogICAgIDxtZC1idXR0b24gYXJpYS1sYWJlbD1cIkFkZCBHcm91cFwiPlxuICAgKiAgICAgICA8bWQtaWNvbiBpY29uPVwiL2ltZy9pY29ucy9ncm91cC5zdmdcIj48L21kLWljb24+XG4gICAqICAgICA8L21kLWJ1dHRvbj5cbiAgICogICA8L21kLWZhYi1hY3Rpb25zPlxuICAgKiA8L21kLWZhYi10b29sYmFyPlxuICAgKiA8L2hsanM+XG4gICAqXG4gICAqIEBwYXJhbSB7ZXhwcmVzc2lvbj19IG1kLW9wZW4gUHJvZ3JhbW1hdGljYWxseSBjb250cm9sIHdoZXRoZXIgb3Igbm90IHRoZSB0b29sYmFyIGlzIHZpc2libGUuXG4gICAqL1xuICBmdW5jdGlvbiBNZEZhYlRvb2xiYXJEaXJlY3RpdmUoKSB7XG4gICAgRmFiVG9vbGJhckNvbnRyb2xsZXIuJGluamVjdCA9IFtcIiRzY29wZVwiLCBcIiRlbGVtZW50XCIsIFwiJGFuaW1hdGVcIl07XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgdGVtcGxhdGU6XG4gICAgICAgICc8ZGl2IGNsYXNzPVwibWQtZmFiLXRvb2xiYXItd3JhcHBlclwiPicgK1xuICAgICAgICAnICA8ZGl2IGNsYXNzPVwibWQtZmFiLXRvb2xiYXItY29udGVudFwiIG5nLXRyYW5zY2x1ZGU+PC9kaXY+JyArXG4gICAgICAgICc8L2Rpdj4nLFxuXG4gICAgICBzY29wZToge1xuICAgICAgICBpc09wZW46ICc9P21kT3BlbidcbiAgICAgIH0sXG5cbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBGYWJUb29sYmFyQ29udHJvbGxlcixcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcblxuICAgICAgbGluazogbGlua1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBGYWJUb29sYmFyQ29udHJvbGxlcigkc2NvcGUsICRlbGVtZW50LCAkYW5pbWF0ZSkge1xuICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgLy8gU2V0IHRoZSBkZWZhdWx0IHRvIGJlIGNsb3NlZFxuICAgICAgdm0uaXNPcGVuID0gdm0uaXNPcGVuIHx8IGZhbHNlO1xuXG4gICAgICB2bS5vcGVuID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZtLmlzT3BlbiA9IHRydWU7XG4gICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAgIH07XG5cbiAgICAgIHZtLmNsb3NlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZtLmlzT3BlbiA9IGZhbHNlO1xuICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XG4gICAgICB9O1xuXG4gICAgICAvLyBBZGQgb3VyIGNsYXNzIHNvIHdlIGNhbiB0cmlnZ2VyIHRoZSBhbmltYXRpb24gb24gc3RhcnRcbiAgICAgICRlbGVtZW50LmFkZENsYXNzKCdtZC1mYWItdG9vbGJhcicpO1xuXG4gICAgICAvLyBTZXR1cCBzb21lIG1vdXNlIGV2ZW50cyBzbyB0aGUgaG92ZXIgZWZmZWN0IGNhbiBiZSB0cmlnZ2VyZWRcbiAgICAgIC8vIGFueXdoZXJlIG92ZXIgdGhlIHRvb2xiYXJcbiAgICAgICRlbGVtZW50Lm9uKCdtb3VzZWVudGVyJywgdm0ub3Blbik7XG4gICAgICAkZWxlbWVudC5vbignbW91c2VsZWF2ZScsIHZtLmNsb3NlKTtcblxuICAgICAgLy8gV2F0Y2ggZm9yIGNoYW5nZXMgdG8gbWQtb3BlbiBhbmQgdG9nZ2xlIG91ciBjbGFzc1xuICAgICAgJHNjb3BlLiR3YXRjaCgndm0uaXNPcGVuJywgZnVuY3Rpb24oaXNPcGVuKSB7XG4gICAgICAgIHZhciB0b0FkZCA9IGlzT3BlbiA/ICdtZC1pcy1vcGVuJyA6ICcnO1xuICAgICAgICB2YXIgdG9SZW1vdmUgPSBpc09wZW4gPyAnJyA6ICdtZC1pcy1vcGVuJztcblxuICAgICAgICAkYW5pbWF0ZS5zZXRDbGFzcygkZWxlbWVudCwgdG9BZGQsIHRvUmVtb3ZlKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHJpYnV0ZXMpIHtcbiAgICAgIC8vIERvbid0IGFsbG93IGZvY3VzIG9uIHRoZSB0cmlnZ2VyXG4gICAgICBlbGVtZW50LmZpbmQoJ21kLWZhYi10cmlnZ2VyJykuZmluZCgnYnV0dG9uJykuYXR0cigndGFiaW5kZXgnLCAnLTEnKTtcblxuICAgICAgLy8gUHJlcGVuZCB0aGUgYmFja2dyb3VuZCBlbGVtZW50IHRvIHRoZSB0cmlnZ2VyJ3MgYnV0dG9uXG4gICAgICBlbGVtZW50LmZpbmQoJ21kLWZhYi10cmlnZ2VyJykuZmluZCgnYnV0dG9uJylcbiAgICAgICAgLnByZXBlbmQoJzxkaXYgY2xhc3M9XCJtZC1mYWItdG9vbGJhci1iYWNrZ3JvdW5kXCI+PC9kaXY+Jyk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gTWRGYWJUb29sYmFyQW5pbWF0aW9uKCkge1xuICAgIHZhciBvcmlnaW5hbEljb25EZWxheTtcblxuICAgIGZ1bmN0aW9uIHJ1bkFuaW1hdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGRvbmUpIHtcbiAgICAgIHZhciBlbCA9IGVsZW1lbnRbMF07XG4gICAgICB2YXIgY3RybCA9IGVsZW1lbnQuY29udHJvbGxlcignbWRGYWJUb29sYmFyJyk7XG5cbiAgICAgIC8vIEdyYWIgdGhlIHJlbGV2YW50IGNoaWxkIGVsZW1lbnRzXG4gICAgICB2YXIgYmFja2dyb3VuZEVsZW1lbnQgPSBlbC5xdWVyeVNlbGVjdG9yKCcubWQtZmFiLXRvb2xiYXItYmFja2dyb3VuZCcpO1xuICAgICAgdmFyIHRyaWdnZXJFbGVtZW50ID0gZWwucXVlcnlTZWxlY3RvcignbWQtZmFiLXRyaWdnZXIgYnV0dG9uJyk7XG4gICAgICB2YXIgaWNvbkVsZW1lbnQgPSBlbC5xdWVyeVNlbGVjdG9yKCdtZC1mYWItdHJpZ2dlciBidXR0b24gbWQtaWNvbicpO1xuICAgICAgdmFyIGFjdGlvbnMgPSBlbGVtZW50LmZpbmQoJ21kLWZhYi1hY3Rpb25zJykuY2hpbGRyZW4oKTtcblxuICAgICAgLy8gSWYgd2UgaGF2ZSBib3RoIGVsZW1lbnRzLCB1c2UgdGhlbSB0byBwb3NpdGlvbiB0aGUgbmV3IGJhY2tncm91bmRcbiAgICAgIGlmICh0cmlnZ2VyRWxlbWVudCAmJiBiYWNrZ3JvdW5kRWxlbWVudCkge1xuICAgICAgICAvLyBHZXQgb3VyIHZhcmlhYmxlc1xuICAgICAgICB2YXIgY29sb3IgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0cmlnZ2VyRWxlbWVudCkuZ2V0UHJvcGVydHlWYWx1ZSgnYmFja2dyb3VuZC1jb2xvcicpO1xuICAgICAgICB2YXIgd2lkdGggPSBlbC5vZmZzZXRXaWR0aDtcbiAgICAgICAgdmFyIGhlaWdodCA9IGVsLm9mZnNldEhlaWdodDtcblxuICAgICAgICAvLyBNYWtlIGEgc3F1YXJlXG4gICAgICAgIHZhciBzY2FsZSA9IHdpZHRoICogMjtcblxuICAgICAgICAvLyBTZXQgc29tZSBiYXNpYyBzdHlsZXMgbm8gbWF0dGVyIHdoYXQgYW5pbWF0aW9uIHdlJ3JlIGRvaW5nXG4gICAgICAgIGJhY2tncm91bmRFbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNvbG9yO1xuICAgICAgICBiYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS5ib3JkZXJSYWRpdXMgPSB3aWR0aCArICdweCc7XG5cbiAgICAgICAgLy8gSWYgd2UncmUgb3BlblxuICAgICAgICBpZiAoY3RybC5pc09wZW4pIHtcblxuICAgICAgICAgIC8vIFNldCB0aGUgd2lkdGgvaGVpZ2h0IHRvIHRha2UgdXAgdGhlIGZ1bGwgdG9vbGJhciB3aWR0aFxuICAgICAgICAgIGJhY2tncm91bmRFbGVtZW50LnN0eWxlLndpZHRoID0gc2NhbGUgKyAncHgnO1xuICAgICAgICAgIGJhY2tncm91bmRFbGVtZW50LnN0eWxlLmhlaWdodCA9IHNjYWxlICsgJ3B4JztcblxuICAgICAgICAgIC8vIFNldCB0aGUgdG9wL2xlZnQgdG8gbW92ZSB1cC9sZWZ0IChvciByaWdodCkgYnkgdGhlIHNjYWxlIHdpZHRoL2hlaWdodFxuICAgICAgICAgIGJhY2tncm91bmRFbGVtZW50LnN0eWxlLnRvcCA9IC0oc2NhbGUgLyAyKSArICdweCc7XG5cbiAgICAgICAgICBpZiAoZWxlbWVudC5oYXNDbGFzcygnbWQtbGVmdCcpKSB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS5sZWZ0ID0gLShzY2FsZSAvIDIpICsgJ3B4JztcbiAgICAgICAgICAgIGJhY2tncm91bmRFbGVtZW50LnN0eWxlLnJpZ2h0ID0gbnVsbDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoZWxlbWVudC5oYXNDbGFzcygnbWQtcmlnaHQnKSkge1xuICAgICAgICAgICAgYmFja2dyb3VuZEVsZW1lbnQuc3R5bGUucmlnaHQgPSAtKHNjYWxlIC8gMikgKyAncHgnO1xuICAgICAgICAgICAgYmFja2dyb3VuZEVsZW1lbnQuc3R5bGUubGVmdCA9IG51bGw7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gU2V0IHRoZSBuZXh0IGNsb3NlIGFuaW1hdGlvbiB0byBoYXZlIHRoZSBwcm9wZXIgZGVsYXlzXG4gICAgICAgICAgYmFja2dyb3VuZEVsZW1lbnQuc3R5bGUudHJhbnNpdGlvbkRlbGF5ID0gJzBtcyc7XG4gICAgICAgICAgaWNvbkVsZW1lbnQuc3R5bGUudHJhbnNpdGlvbkRlbGF5ID0gJy4zcyc7XG5cbiAgICAgICAgICAvLyBBcHBseSBhIHRyYW5zaXRpb24gZGVsYXkgdG8gYWN0aW9uc1xuICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChhY3Rpb25zLCBmdW5jdGlvbihhY3Rpb24sIGluZGV4KSB7XG4gICAgICAgICAgICBhY3Rpb24uc3R5bGUudHJhbnNpdGlvbkRlbGF5ID0gKGFjdGlvbnMubGVuZ3RoIC0gaW5kZXgpICogMjUgKyAnbXMnO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIE90aGVyd2lzZSwgc2V0IHRoZSB3aWR0aC9oZWlnaHQgdG8gdGhlIHRyaWdnZXIncyB3aWR0aC9oZWlnaHRcbiAgICAgICAgICBiYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS53aWR0aCA9IHRyaWdnZXJFbGVtZW50Lm9mZnNldFdpZHRoICsgJ3B4JztcbiAgICAgICAgICBiYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS5oZWlnaHQgPSB0cmlnZ2VyRWxlbWVudC5vZmZzZXRIZWlnaHQgKyAncHgnO1xuXG4gICAgICAgICAgLy8gUmVzZXQgdGhlIHBvc2l0aW9uXG4gICAgICAgICAgYmFja2dyb3VuZEVsZW1lbnQuc3R5bGUudG9wID0gJzBweCc7XG5cbiAgICAgICAgICBpZiAoZWxlbWVudC5oYXNDbGFzcygnbWQtbGVmdCcpKSB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS5sZWZ0ID0gJzBweCc7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS5yaWdodCA9IG51bGw7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGVsZW1lbnQuaGFzQ2xhc3MoJ21kLXJpZ2h0JykpIHtcbiAgICAgICAgICAgIGJhY2tncm91bmRFbGVtZW50LnN0eWxlLnJpZ2h0ID0gJzBweCc7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS5sZWZ0ID0gbnVsbDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBTZXQgdGhlIG5leHQgb3BlbiBhbmltYXRpb24gdG8gaGF2ZSB0aGUgcHJvcGVyIGRlbGF5c1xuICAgICAgICAgIGJhY2tncm91bmRFbGVtZW50LnN0eWxlLnRyYW5zaXRpb25EZWxheSA9ICcyMDBtcyc7XG4gICAgICAgICAgaWNvbkVsZW1lbnQuc3R5bGUudHJhbnNpdGlvbkRlbGF5ID0gJzBtcyc7XG5cbiAgICAgICAgICAvLyBBcHBseSBhIHRyYW5zaXRpb24gZGVsYXkgdG8gYWN0aW9uc1xuICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChhY3Rpb25zLCBmdW5jdGlvbihhY3Rpb24sIGluZGV4KSB7XG4gICAgICAgICAgICBhY3Rpb24uc3R5bGUudHJhbnNpdGlvbkRlbGF5ID0gKGluZGV4ICogMjUpICsgJ21zJztcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBhZGRDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lKSB7XG4gICAgICAgIHJ1bkFuaW1hdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGRvbmUpO1xuICAgICAgfSxcblxuICAgICAgcmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgZG9uZSkge1xuICAgICAgICBydW5BbmltYXRpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7XG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuZmFiVHJpZ2dlcicsIFsgJ21hdGVyaWFsLmNvcmUnIF0pXG4gICAgLmRpcmVjdGl2ZSgnbWRGYWJUcmlnZ2VyJywgTWRGYWJUcmlnZ2VyRGlyZWN0aXZlKTtcblxuICAvKipcbiAgICogQG5nZG9jIGRpcmVjdGl2ZVxuICAgKiBAbmFtZSBtZEZhYlRyaWdnZXJcbiAgICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmZhYlNwZWVkRGlhbFxuICAgKlxuICAgKiBAcmVzdHJpY3QgRVxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogVGhlIGA8bWQtZmFiLXRyaWdnZXI+YCBkaXJlY3RpdmUgaXMgdXNlZCBpbnNpZGUgb2YgYSBgPG1kLWZhYi1zcGVlZC1kaWFsPmAgb3JcbiAgICogYDxtZC1mYWItdG9vbGJhcj5gIGRpcmVjdGl2ZSB0byBtYXJrIHRoZSBhbiBlbGVtZW50IChvciBlbGVtZW50cykgYXMgdGhlIHRyaWdnZXIgYW5kIHNldHVwIHRoZVxuICAgKiBwcm9wZXIgZXZlbnQgbGlzdGVuZXJzLlxuICAgKlxuICAgKiBAdXNhZ2VcbiAgICogU2VlIHRoZSBgPG1kLWZhYi1zcGVlZC1kaWFsPmAgb3IgYDxtZC1mYWItdG9vbGJhcj5gIGRpcmVjdGl2ZXMgZm9yIGV4YW1wbGUgdXNhZ2UuXG4gICAqL1xuICBmdW5jdGlvbiBNZEZhYlRyaWdnZXJEaXJlY3RpdmUoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3RyaWN0OiAnRScsXG5cbiAgICAgIHJlcXVpcmU6IFsnXj9tZEZhYlNwZWVkRGlhbCcsICdeP21kRmFiVG9vbGJhciddLFxuXG4gICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cmlidXRlcywgY29udHJvbGxlcnMpIHtcbiAgICAgICAgLy8gR3JhYiB3aGljaGV2ZXIgcGFyZW50IGNvbnRyb2xsZXIgaXMgdXNlZFxuICAgICAgICB2YXIgY29udHJvbGxlciA9IGNvbnRyb2xsZXJzWzBdIHx8IGNvbnRyb2xsZXJzWzFdO1xuXG4gICAgICAgIC8vIE1ha2UgdGhlIGNoaWxkcmVuIG9wZW4vY2xvc2UgdGhlaXIgcGFyZW50IGRpcmVjdGl2ZVxuICAgICAgICBpZiAoY29udHJvbGxlcikge1xuICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChlbGVtZW50LmNoaWxkcmVuKCksIGZ1bmN0aW9uKGNoaWxkKSB7XG4gICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoY2hpbGQpLm9uKCdmb2N1cycsIGNvbnRyb2xsZXIub3Blbik7XG4gICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoY2hpbGQpLm9uKCdibHVyJywgY29udHJvbGxlci5jbG9zZSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7XG5cblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogQG5nZG9jIG1vZHVsZVxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5ncmlkTGlzdFxuICovXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5ncmlkTGlzdCcsIFsnbWF0ZXJpYWwuY29yZSddKVxuICAgICAgIC5kaXJlY3RpdmUoJ21kR3JpZExpc3QnLCBHcmlkTGlzdERpcmVjdGl2ZSlcbiAgICAgICAuZGlyZWN0aXZlKCdtZEdyaWRUaWxlJywgR3JpZFRpbGVEaXJlY3RpdmUpXG4gICAgICAgLmRpcmVjdGl2ZSgnbWRHcmlkVGlsZUZvb3RlcicsIEdyaWRUaWxlQ2FwdGlvbkRpcmVjdGl2ZSlcbiAgICAgICAuZGlyZWN0aXZlKCdtZEdyaWRUaWxlSGVhZGVyJywgR3JpZFRpbGVDYXB0aW9uRGlyZWN0aXZlKVxuICAgICAgIC5mYWN0b3J5KCckbWRHcmlkTGF5b3V0JywgR3JpZExheW91dEZhY3RvcnkpO1xuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG1kR3JpZExpc3RcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5ncmlkTGlzdFxuICogQHJlc3RyaWN0IEVcbiAqIEBkZXNjcmlwdGlvblxuICogR3JpZCBsaXN0cyBhcmUgYW4gYWx0ZXJuYXRpdmUgdG8gc3RhbmRhcmQgbGlzdCB2aWV3cy4gR3JpZCBsaXN0cyBhcmUgZGlzdGluY3RcbiAqIGZyb20gZ3JpZHMgdXNlZCBmb3IgbGF5b3V0cyBhbmQgb3RoZXIgdmlzdWFsIHByZXNlbnRhdGlvbnMuXG4gKlxuICogQSBncmlkIGxpc3QgaXMgYmVzdCBzdWl0ZWQgdG8gcHJlc2VudGluZyBhIGhvbW9nZW5vdXMgZGF0YSB0eXBlLCB0eXBpY2FsbHlcbiAqIGltYWdlcywgYW5kIGlzIG9wdGltaXplZCBmb3IgdmlzdWFsIGNvbXByZWhlbnNpb24gYW5kIGRpZmZlcmVudGlhdGluZyBiZXR3ZWVuXG4gKiBsaWtlIGRhdGEgdHlwZXMuXG4gKlxuICogQSBncmlkIGxpc3QgaXMgYSBjb250aW51b3VzIGVsZW1lbnQgY29uc2lzdGluZyBvZiB0ZXNzZWxsYXRlZCwgcmVndWxhclxuICogc3ViZGl2aXNpb25zIGNhbGxlZCBjZWxscyB0aGF0IGNvbnRhaW4gdGlsZXMgKGBtZC1ncmlkLXRpbGVgKS5cbiAqXG4gKiA8aW1nIHNyYz1cIi8vbWF0ZXJpYWwtZGVzaWduLnN0b3JhZ2UuZ29vZ2xlYXBpcy5jb20vcHVibGlzaC92XzIvbWF0ZXJpYWxfZXh0X3B1Ymxpc2gvMEJ4NEJTdDZqbmlEN09WbEVhWFo1WW1VMVh6Zy9jb21wb25lbnRzX2dyaWRzX3VzYWdlMi5wbmdcIlxuICogICAgc3R5bGU9XCJ3aWR0aDogMzAwcHg7IGhlaWdodDogYXV0bzsgbWFyZ2luLXJpZ2h0OiAxNnB4O1wiIGFsdD1cIkNvbmNlcHQgb2YgZ3JpZCBleHBsYWluZWQgdmlzdWFsbHlcIj5cbiAqIDxpbWcgc3JjPVwiLy9tYXRlcmlhbC1kZXNpZ24uc3RvcmFnZS5nb29nbGVhcGlzLmNvbS9wdWJsaXNoL3ZfMi9tYXRlcmlhbF9leHRfcHVibGlzaC8wQng0QlN0NmpuaUQ3Vkdoc09FNWlkV2xKV1hNL2NvbXBvbmVudHNfZ3JpZHNfdXNhZ2UzLnBuZ1wiXG4gKiAgICBzdHlsZT1cIndpZHRoOiAzMDBweDsgaGVpZ2h0OiBhdXRvO1wiIGFsdD1cIkdyaWQgY29uY2VwdHMgbGVnZW5kXCI+XG4gKlxuICogQ2VsbHMgYXJlIGFycmF5ZWQgdmVydGljYWxseSBhbmQgaG9yaXpvbnRhbGx5IHdpdGhpbiB0aGUgZ3JpZC5cbiAqXG4gKiBUaWxlcyBob2xkIGNvbnRlbnQgYW5kIGNhbiBzcGFuIG9uZSBvciBtb3JlIGNlbGxzIHZlcnRpY2FsbHkgb3IgaG9yaXpvbnRhbGx5LlxuICpcbiAqICMjIyBSZXNwb25zaXZlIEF0dHJpYnV0ZXNcbiAqXG4gKiBUaGUgYG1kLWdyaWQtbGlzdGAgZGlyZWN0aXZlIHN1cHBvcnRzIFwicmVzcG9uc2l2ZVwiIGF0dHJpYnV0ZXMsIHdoaWNoIGFsbG93XG4gKiBkaWZmZXJlbnQgYG1kLWNvbHNgLCBgbWQtZ3V0dGVyYCBhbmQgYG1kLXJvdy1oZWlnaHRgIHZhbHVlcyBkZXBlbmRpbmcgb24gdGhlXG4gKiBjdXJyZW50bHkgbWF0Y2hpbmcgbWVkaWEgcXVlcnkgKGFzIGRlZmluZWQgaW4gYCRtZENvbnN0YW50Lk1FRElBYCkuXG4gKlxuICogSW4gb3JkZXIgdG8gc2V0IGEgcmVzcG9uc2l2ZSBhdHRyaWJ1dGUsIGZpcnN0IGRlZmluZSB0aGUgZmFsbGJhY2sgdmFsdWUgd2l0aFxuICogdGhlIHN0YW5kYXJkIGF0dHJpYnV0ZSBuYW1lLCB0aGVuIGFkZCBhZGRpdGlvbmFsIGF0dHJpYnV0ZXMgd2l0aCB0aGVcbiAqIGZvbGxvd2luZyBjb252ZW50aW9uOiBge2Jhc2UtYXR0cmlidXRlLW5hbWV9LXttZWRpYS1xdWVyeS1uYW1lfT1cInt2YWx1ZX1cImBcbiAqIChpZS4gYG1kLWNvbHMtbGc9XCI4XCJgKVxuICpcbiAqIEBwYXJhbSB7bnVtYmVyfSBtZC1jb2xzIE51bWJlciBvZiBjb2x1bW5zIGluIHRoZSBncmlkLlxuICogQHBhcmFtIHtzdHJpbmd9IG1kLXJvdy1oZWlnaHQgT25lIG9mXG4gKiA8dWw+XG4gKiAgIDxsaT5DU1MgbGVuZ3RoIC0gRml4ZWQgaGVpZ2h0IHJvd3MgKGVnLiBgOHB4YCBvciBgMXJlbWApPC9saT5cbiAqICAgPGxpPmB7d2lkdGh9OntoZWlnaHR9YCAtIFJhdGlvIG9mIHdpZHRoIHRvIGhlaWdodCAoZWcuXG4gKiAgIGBtZC1yb3ctaGVpZ2h0PVwiMTY6OVwiYCk8L2xpPlxuICogICA8bGk+YFwiZml0XCJgIC0gSGVpZ2h0IHdpbGwgYmUgZGV0ZXJtaW5lZCBieSBzdWJkaXZpZGluZyB0aGUgYXZhaWxhYmxlXG4gKiAgIGhlaWdodCBieSB0aGUgbnVtYmVyIG9mIHJvd3M8L2xpPlxuICogPC91bD5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gbWQtZ3V0dGVyIFRoZSBhbW91bnQgb2Ygc3BhY2UgYmV0d2VlbiB0aWxlcyBpbiBDU1MgdW5pdHNcbiAqICAgICAoZGVmYXVsdCAxcHgpXG4gKiBAcGFyYW0ge2V4cHJlc3Npb249fSBtZC1vbi1sYXlvdXQgRXhwcmVzc2lvbiB0byBldmFsdWF0ZSBhZnRlciBsYXlvdXQuIEV2ZW50XG4gKiAgICAgb2JqZWN0IGlzIGF2YWlsYWJsZSBhcyBgJGV2ZW50YCwgYW5kIGNvbnRhaW5zIHBlcmZvcm1hbmNlIGluZm9ybWF0aW9uLlxuICpcbiAqIEB1c2FnZVxuICogQmFzaWM6XG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxuICogPG1kLWdyaWQtbGlzdCBtZC1jb2xzPVwiNVwiIG1kLWd1dHRlcj1cIjFlbVwiIG1kLXJvdy1oZWlnaHQ9XCI0OjNcIj5cbiAqICAgPG1kLWdyaWQtdGlsZT48L21kLWdyaWQtdGlsZT5cbiAqIDwvbWQtZ3JpZC1saXN0PlxuICogPC9obGpzPlxuICpcbiAqIEZpeGVkLWhlaWdodCByb3dzOlxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cbiAqIDxtZC1ncmlkLWxpc3QgbWQtY29scz1cIjRcIiBtZC1yb3ctaGVpZ2h0PVwiMjAwcHhcIiAuLi4+XG4gKiAgIDxtZC1ncmlkLXRpbGU+PC9tZC1ncmlkLXRpbGU+XG4gKiA8L21kLWdyaWQtbGlzdD5cbiAqIDwvaGxqcz5cbiAqXG4gKiBGaXQgcm93czpcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiA8bWQtZ3JpZC1saXN0IG1kLWNvbHM9XCI0XCIgbWQtcm93LWhlaWdodD1cImZpdFwiIHN0eWxlPVwiaGVpZ2h0OiA0MDBweDtcIiAuLi4+XG4gKiAgIDxtZC1ncmlkLXRpbGU+PC9tZC1ncmlkLXRpbGU+XG4gKiA8L21kLWdyaWQtbGlzdD5cbiAqIDwvaGxqcz5cbiAqXG4gKiBVc2luZyByZXNwb25zaXZlIGF0dHJpYnV0ZXM6XG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxuICogPG1kLWdyaWQtbGlzdFxuICogICAgIG1kLWNvbHMtc209XCIyXCJcbiAqICAgICBtZC1jb2xzLW1kPVwiNFwiXG4gKiAgICAgbWQtY29scy1sZz1cIjhcIlxuICogICAgIG1kLWNvbHMtZ3QtbGc9XCIxMlwiXG4gKiAgICAgLi4uPlxuICogICA8bWQtZ3JpZC10aWxlPjwvbWQtZ3JpZC10aWxlPlxuICogPC9tZC1ncmlkLWxpc3Q+XG4gKiA8L2hsanM+XG4gKi9cbmZ1bmN0aW9uIEdyaWRMaXN0RGlyZWN0aXZlKCRpbnRlcnBvbGF0ZSwgJG1kQ29uc3RhbnQsICRtZEdyaWRMYXlvdXQsICRtZE1lZGlhKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdFJyxcbiAgICBjb250cm9sbGVyOiBHcmlkTGlzdENvbnRyb2xsZXIsXG4gICAgc2NvcGU6IHtcbiAgICAgIG1kT25MYXlvdXQ6ICcmJ1xuICAgIH0sXG4gICAgbGluazogcG9zdExpbmtcbiAgfTtcblxuICBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMsIGN0cmwpIHtcbiAgICAvLyBBcHBseSBzZW1hbnRpY3NcbiAgICBlbGVtZW50LmF0dHIoJ3JvbGUnLCAnbGlzdCcpO1xuXG4gICAgLy8gUHJvdmlkZSB0aGUgY29udHJvbGxlciB3aXRoIGEgd2F5IHRvIHRyaWdnZXIgbGF5b3V0cy5cbiAgICBjdHJsLmxheW91dERlbGVnYXRlID0gbGF5b3V0RGVsZWdhdGU7XG5cbiAgICB2YXIgaW52YWxpZGF0ZUxheW91dCA9IGFuZ3VsYXIuYmluZChjdHJsLCBjdHJsLmludmFsaWRhdGVMYXlvdXQpLFxuICAgICAgICB1bndhdGNoQXR0cnMgPSB3YXRjaE1lZGlhKCk7XG4gICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgdW53YXRjaE1lZGlhKTtcblxuICAgIC8qKlxuICAgICAqIFdhdGNoZXMgZm9yIGNoYW5nZXMgaW4gbWVkaWEsIGludmFsaWRhdGluZyBsYXlvdXQgYXMgbmVjZXNzYXJ5LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHdhdGNoTWVkaWEoKSB7XG4gICAgICBmb3IgKHZhciBtZWRpYU5hbWUgaW4gJG1kQ29uc3RhbnQuTUVESUEpIHtcbiAgICAgICAgJG1kTWVkaWEobWVkaWFOYW1lKTsgLy8gaW5pdGlhbGl6ZVxuICAgICAgICAkbWRNZWRpYS5nZXRRdWVyeSgkbWRDb25zdGFudC5NRURJQVttZWRpYU5hbWVdKVxuICAgICAgICAgICAgLmFkZExpc3RlbmVyKGludmFsaWRhdGVMYXlvdXQpO1xuICAgICAgfVxuICAgICAgcmV0dXJuICRtZE1lZGlhLndhdGNoUmVzcG9uc2l2ZUF0dHJpYnV0ZXMoXG4gICAgICAgICAgWydtZC1jb2xzJywgJ21kLXJvdy1oZWlnaHQnXSwgYXR0cnMsIGxheW91dElmTWVkaWFNYXRjaCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdW53YXRjaE1lZGlhKCkge1xuICAgICAgY3RybC5sYXlvdXREZWxlZ2F0ZSA9IGFuZ3VsYXIubm9vcDtcblxuICAgICAgdW53YXRjaEF0dHJzKCk7XG4gICAgICBmb3IgKHZhciBtZWRpYU5hbWUgaW4gJG1kQ29uc3RhbnQuTUVESUEpIHtcbiAgICAgICAgJG1kTWVkaWEuZ2V0UXVlcnkoJG1kQ29uc3RhbnQuTUVESUFbbWVkaWFOYW1lXSlcbiAgICAgICAgICAgIC5yZW1vdmVMaXN0ZW5lcihpbnZhbGlkYXRlTGF5b3V0KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtcyBncmlkIGxheW91dCBpZiB0aGUgcHJvdmlkZWQgbWVkaWFOYW1lIG1hdGNoZXMgdGhlIGN1cnJlbnRseVxuICAgICAqIGFjdGl2ZSBtZWRpYSB0eXBlLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGxheW91dElmTWVkaWFNYXRjaChtZWRpYU5hbWUpIHtcbiAgICAgIGlmIChtZWRpYU5hbWUgPT0gbnVsbCkge1xuICAgICAgICAvLyBUT0RPKHNoeW5kbWFuKTogSXQgd291bGQgYmUgbmljZSB0byBvbmx5IGxheW91dCBpZiB3ZSBoYXZlXG4gICAgICAgIC8vIGluc3RhbmNlcyBvZiBhdHRyaWJ1dGVzIHVzaW5nIHRoaXMgbWVkaWEgdHlwZVxuICAgICAgICBjdHJsLmludmFsaWRhdGVMYXlvdXQoKTtcbiAgICAgIH0gZWxzZSBpZiAoJG1kTWVkaWEobWVkaWFOYW1lKSkge1xuICAgICAgICBjdHJsLmludmFsaWRhdGVMYXlvdXQoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgbGFzdExheW91dFByb3BzO1xuXG4gICAgLyoqXG4gICAgICogSW52b2tlcyB0aGUgbGF5b3V0IGVuZ2luZSwgYW5kIHVzZXMgaXRzIHJlc3VsdHMgdG8gbGF5IG91dCBvdXJcbiAgICAgKiB0aWxlIGVsZW1lbnRzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtib29sZWFufSB0aWxlc0ludmFsaWRhdGVkIFdoZXRoZXIgdGlsZXMgaGF2ZSBiZWVuXG4gICAgICogICAgYWRkZWQvcmVtb3ZlZC9tb3ZlZCBzaW5jZSB0aGUgbGFzdCBsYXlvdXQuIFRoaXMgaXMgdG8gYXZvaWQgc2l0dWF0aW9uc1xuICAgICAqICAgIHdoZXJlIHRpbGVzIGFyZSByZXBsYWNlZCB3aXRoIHByb3BlcnRpZXMgaWRlbnRpY2FsIHRvIHRoZWlyIHJlbW92ZWRcbiAgICAgKiAgICBjb3VudGVycGFydHMuXG4gICAgICovXG4gICAgZnVuY3Rpb24gbGF5b3V0RGVsZWdhdGUodGlsZXNJbnZhbGlkYXRlZCkge1xuICAgICAgdmFyIHRpbGVzID0gZ2V0VGlsZUVsZW1lbnRzKCk7XG4gICAgICB2YXIgcHJvcHMgPSB7XG4gICAgICAgIHRpbGVTcGFuczogZ2V0VGlsZVNwYW5zKHRpbGVzKSxcbiAgICAgICAgY29sQ291bnQ6IGdldENvbHVtbkNvdW50KCksXG4gICAgICAgIHJvd01vZGU6IGdldFJvd01vZGUoKSxcbiAgICAgICAgcm93SGVpZ2h0OiBnZXRSb3dIZWlnaHQoKSxcbiAgICAgICAgZ3V0dGVyOiBnZXRHdXR0ZXIoKVxuICAgICAgfTtcblxuICAgICAgaWYgKCF0aWxlc0ludmFsaWRhdGVkICYmIGFuZ3VsYXIuZXF1YWxzKHByb3BzLCBsYXN0TGF5b3V0UHJvcHMpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIHBlcmZvcm1hbmNlID1cbiAgICAgICAgJG1kR3JpZExheW91dChwcm9wcy5jb2xDb3VudCwgcHJvcHMudGlsZVNwYW5zLCB0aWxlcylcbiAgICAgICAgICAubWFwKGZ1bmN0aW9uKHRpbGVQb3NpdGlvbnMsIHJvd0NvdW50KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICBncmlkOiB7XG4gICAgICAgICAgICAgICAgZWxlbWVudDogZWxlbWVudCxcbiAgICAgICAgICAgICAgICBzdHlsZTogZ2V0R3JpZFN0eWxlKHByb3BzLmNvbENvdW50LCByb3dDb3VudCxcbiAgICAgICAgICAgICAgICAgICAgcHJvcHMuZ3V0dGVyLCBwcm9wcy5yb3dNb2RlLCBwcm9wcy5yb3dIZWlnaHQpXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHRpbGVzOiB0aWxlUG9zaXRpb25zLm1hcChmdW5jdGlvbihwcywgaSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICBlbGVtZW50OiBhbmd1bGFyLmVsZW1lbnQodGlsZXNbaV0pLFxuICAgICAgICAgICAgICAgICAgc3R5bGU6IGdldFRpbGVTdHlsZShwcy5wb3NpdGlvbiwgcHMuc3BhbnMsXG4gICAgICAgICAgICAgICAgICAgICAgcHJvcHMuY29sQ291bnQsIHByb3BzLnJvd0NvdW50LFxuICAgICAgICAgICAgICAgICAgICAgIHByb3BzLmd1dHRlciwgcHJvcHMucm93TW9kZSwgcHJvcHMucm93SGVpZ2h0KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICAgIC5yZWZsb3coKVxuICAgICAgICAgIC5wZXJmb3JtYW5jZSgpO1xuXG4gICAgICAvLyBSZXBvcnQgbGF5b3V0XG4gICAgICBzY29wZS5tZE9uTGF5b3V0KHtcbiAgICAgICAgJGV2ZW50OiB7XG4gICAgICAgICAgcGVyZm9ybWFuY2U6IHBlcmZvcm1hbmNlXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBsYXN0TGF5b3V0UHJvcHMgPSBwcm9wcztcbiAgICB9XG5cbiAgICAvLyBVc2UgJGludGVycG9sYXRlIHRvIGRvIHNvbWUgc2ltcGxlIHN0cmluZyBpbnRlcnBvbGF0aW9uIGFzIGEgY29udmVuaWVuY2UuXG5cbiAgICB2YXIgc3RhcnRTeW1ib2wgPSAkaW50ZXJwb2xhdGUuc3RhcnRTeW1ib2woKTtcbiAgICB2YXIgZW5kU3ltYm9sID0gJGludGVycG9sYXRlLmVuZFN5bWJvbCgpO1xuXG4gICAgLy8gUmV0dXJucyBhbiBleHByZXNzaW9uIHdyYXBwZWQgaW4gdGhlIGludGVycG9sYXRvcidzIHN0YXJ0IGFuZCBlbmQgc3ltYm9scy5cbiAgICBmdW5jdGlvbiBleHByKGV4cHJTdHIpIHtcbiAgICAgIHJldHVybiBzdGFydFN5bWJvbCArIGV4cHJTdHIgKyBlbmRTeW1ib2w7XG4gICAgfVxuXG4gICAgLy8gVGhlIGFtb3VudCBvZiBzcGFjZSBhIHNpbmdsZSAxeDEgdGlsZSB3b3VsZCB0YWtlIHVwIChlaXRoZXIgd2lkdGggb3IgaGVpZ2h0KSwgdXNlZCBhc1xuICAgIC8vIGEgYmFzaXMgZm9yIG90aGVyIGNhbGN1bGF0aW9ucy4gVGhpcyBjb25zaXN0cyBvZiB0YWtpbmcgdGhlIGJhc2Ugc2l6ZSBwZXJjZW50IChhcyB3b3VsZCBiZVxuICAgIC8vIGlmIGV2ZW5seSBkaXZpZGluZyB0aGUgc2l6ZSBiZXR3ZWVuIGNlbGxzKSwgYW5kIHRoZW4gc3VidHJhY3RpbmcgdGhlIHNpemUgb2Ygb25lIGd1dHRlci5cbiAgICAvLyBIb3dldmVyLCBzaW5jZSB0aGVyZSBhcmUgbm8gZ3V0dGVycyBvbiB0aGUgZWRnZXMsIGVhY2ggdGlsZSBvbmx5IHVzZXMgYSBmcmF0aW9uXG4gICAgLy8gKGd1dHRlclNoYXJlID0gbnVtR3V0dGVycyAvIG51bUNlbGxzKSBvZiB0aGUgZ3V0dGVyIHNpemUuIChJbWFnaW5lIGhhdmluZyBvbmUgZ3V0dGVyIHBlclxuICAgIC8vIHRpbGUsIGFuZCB0aGVuIGJyZWFraW5nIHVwIHRoZSBleHRyYSBndXR0ZXIgb24gdGhlIGVkZ2UgZXZlbmx5IGFtb25nIHRoZSBjZWxscykuXG4gICAgdmFyIFVOSVQgPSAkaW50ZXJwb2xhdGUoZXhwcignc2hhcmUnKSArICclIC0gKCcgKyBleHByKCdndXR0ZXInKSArICcgKiAnICsgZXhwcignZ3V0dGVyU2hhcmUnKSArICcpJyk7XG5cbiAgICAvLyBUaGUgaG9yaXpvbnRhbCBvciB2ZXJ0aWNhbCBwb3NpdGlvbiBvZiBhIHRpbGUsIGUuZy4sIHRoZSAndG9wJyBvciAnbGVmdCcgcHJvcGVydHkgdmFsdWUuXG4gICAgLy8gVGhlIHBvc2l0aW9uIGNvbWVzIHRoZSBzaXplIG9mIGEgMXgxIHRpbGUgcGx1cyBndXR0ZXIgZm9yIGVhY2ggcHJldmlvdXMgdGlsZSBpbiB0aGVcbiAgICAvLyByb3cvY29sdW1uIChvZmZzZXQpLlxuICAgIHZhciBQT1NJVElPTiAgPSAkaW50ZXJwb2xhdGUoJ2NhbGMoKCcgKyBleHByKCd1bml0JykgKyAnICsgJyArIGV4cHIoJ2d1dHRlcicpICsgJykgKiAnICsgZXhwcignb2Zmc2V0JykgKyAnKScpO1xuXG4gICAgLy8gVGhlIGFjdHVhbCBzaXplIG9mIGEgdGlsZSwgZS5nLiwgd2lkdGggb3IgaGVpZ2h0LCB0YWtpbmcgcm93U3BhbiBvciBjb2xTcGFuIGludG8gYWNjb3VudC5cbiAgICAvLyBUaGlzIGlzIGNvbXB1dGVkIGJ5IG11bHRpcGx5aW5nIHRoZSBiYXNlIHVuaXQgYnkgdGhlIHJvd1NwYW4vY29sU3BhbiwgYW5kIHRoZW4gYWRkaW5nIGJhY2tcbiAgICAvLyBpbiB0aGUgc3BhY2UgdGhhdCB0aGUgZ3V0dGVyIHdvdWxkIG5vcm1hbGx5IGhhdmUgdXNlZCAod2hpY2ggd2FzIGFscmVhZHkgYWNjb3VudGVkIGZvciBpblxuICAgIC8vIHRoZSBiYXNlIHVuaXQgY2FsY3VsYXRpb24pLlxuICAgIHZhciBESU1FTlNJT04gPSAkaW50ZXJwb2xhdGUoJ2NhbGMoKCcgKyBleHByKCd1bml0JykgKyAnKSAqICcgKyBleHByKCdzcGFuJykgKyAnICsgKCcgKyBleHByKCdzcGFuJykgKyAnIC0gMSkgKiAnICsgZXhwcignZ3V0dGVyJykgKyAnKScpO1xuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgc3R5bGVzIGFwcGxpZWQgdG8gYSB0aWxlIGVsZW1lbnQgZGVzY3JpYmVkIGJ5IHRoZSBnaXZlbiBwYXJhbWV0ZXJzLlxuICAgICAqIEBwYXJhbSB7e3JvdzogbnVtYmVyLCBjb2w6IG51bWJlcn19IHBvc2l0aW9uIFRoZSByb3cgYW5kIGNvbHVtbiBpbmRpY2VzIG9mIHRoZSB0aWxlLlxuICAgICAqIEBwYXJhbSB7e3JvdzogbnVtYmVyLCBjb2w6IG51bWJlcn19IHNwYW5zIFRoZSByb3dTcGFuIGFuZCBjb2xTcGFuIG9mIHRoZSB0aWxlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjb2xDb3VudCBUaGUgbnVtYmVyIG9mIGNvbHVtbnMuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHJvd0NvdW50IFRoZSBudW1iZXIgb2Ygcm93cy5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZ3V0dGVyIFRoZSBhbW91bnQgb2Ygc3BhY2UgYmV0d2VlbiB0aWxlcy4gVGhpcyB3aWxsIGJlIHNvbWV0aGluZyBsaWtlXG4gICAgICogICAgICc1cHgnIG9yICcyZW0nLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSByb3dNb2RlIFRoZSByb3cgaGVpZ2h0IG1vZGUuIENhbiBiZSBvbmUgb2Y6XG4gICAgICogICAgICdmaXhlZCc6IGFsbCByb3dzIGhhdmUgYSBmaXhlZCBzaXplLCBnaXZlbiBieSByb3dIZWlnaHQsXG4gICAgICogICAgICdyYXRpbyc6IHJvdyBoZWlnaHQgZGVmaW5lZCBhcyBhIHJhdGlvIHRvIHdpZHRoLCBvclxuICAgICAqICAgICAnZml0JzogZml0IHRvIHRoZSBncmlkLWxpc3QgZWxlbWVudCBoZWlnaHQsIGRpdmluZGluZyBldmVubHkgYW1vbmcgcm93cy5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xudW1iZXJ9IHJvd0hlaWdodCBUaGUgaGVpZ2h0IG9mIGEgcm93LiBUaGlzIGlzIG9ubHkgdXNlZCBmb3IgJ2ZpeGVkJyBtb2RlIGFuZFxuICAgICAqICAgICBmb3IgJ3JhdGlvJyBtb2RlLiBGb3IgJ3JhdGlvJyBtb2RlLCB0aGlzIGlzIHRoZSAqcmF0aW8qIG9mIHdpZHRoLXRvLWhlaWdodCAoZS5nLiwgMC43NSkuXG4gICAgICogQHJldHVybnMge09iamVjdH0gTWFwIG9mIENTUyBwcm9wZXJ0aWVzIHRvIGJlIGFwcGxpZWQgdG8gdGhlIHN0eWxlIGVsZW1lbnQuIFdpbGwgZGVmaW5lXG4gICAgICogICAgIHZhbHVlcyBmb3IgdG9wLCBsZWZ0LCB3aWR0aCwgaGVpZ2h0LCBtYXJnaW5Ub3AsIGFuZCBwYWRkaW5nVG9wLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldFRpbGVTdHlsZShwb3NpdGlvbiwgc3BhbnMsIGNvbENvdW50LCByb3dDb3VudCwgZ3V0dGVyLCByb3dNb2RlLCByb3dIZWlnaHQpIHtcbiAgICAgIC8vIFRPRE8oc2h5bmRtYW4pOiBUaGVyZSBhcmUgc3R5bGUgY2FjaGluZyBvcHBvcnR1bml0aWVzIGhlcmUuXG5cbiAgICAgIC8vIFBlcmNlbnQgb2YgdGhlIGF2YWlsYWJsZSBob3Jpem9udGFsIHNwYWNlIHRoYXQgb25lIGNvbHVtbiB0YWtlcyB1cC5cbiAgICAgIHZhciBoU2hhcmUgPSAoMSAvIGNvbENvdW50KSAqIDEwMDtcblxuICAgICAgLy8gRnJhY3Rpb24gb2YgdGhlIGd1dHRlciBzaXplIHRoYXQgZWFjaCBjb2x1bW4gdGFrZXMgdXAuXG4gICAgICB2YXIgaEd1dHRlclNoYXJlID0gKGNvbENvdW50IC0gMSkgLyBjb2xDb3VudDtcblxuICAgICAgLy8gQmFzZSBob3Jpem9udGFsIHNpemUgb2YgYSBjb2x1bW4uXG4gICAgICB2YXIgaFVuaXQgPSBVTklUKHtzaGFyZTogaFNoYXJlLCBndXR0ZXJTaGFyZTogaEd1dHRlclNoYXJlLCBndXR0ZXI6IGd1dHRlcn0pO1xuXG4gICAgICAvLyBUaGUgd2lkdGggYW5kIGhvcml6b250YWwgcG9zaXRpb24gb2YgZWFjaCB0aWxlIGlzIGFsd2F5cyBjYWxjdWxhdGVkIHRoZSBzYW1lIHdheSwgYnV0IHRoZVxuICAgICAgLy8gaGVpZ2h0IGFuZCB2ZXJ0aWNhbCBwb3NpdGlvbiBkZXBlbmRzIG9uIHRoZSByb3dNb2RlLlxuICAgICAgdmFyIHN0eWxlID0ge1xuICAgICAgICBsZWZ0OiBQT1NJVElPTih7IHVuaXQ6IGhVbml0LCBvZmZzZXQ6IHBvc2l0aW9uLmNvbCwgZ3V0dGVyOiBndXR0ZXIgfSksXG4gICAgICAgIHdpZHRoOiBESU1FTlNJT04oeyB1bml0OiBoVW5pdCwgc3Bhbjogc3BhbnMuY29sLCBndXR0ZXI6IGd1dHRlciB9KSxcbiAgICAgICAgLy8gcmVzZXRzXG4gICAgICAgIHBhZGRpbmdUb3A6ICcnLFxuICAgICAgICBtYXJnaW5Ub3A6ICcnLFxuICAgICAgICB0b3A6ICcnLFxuICAgICAgICBoZWlnaHQ6ICcnXG4gICAgICB9O1xuXG4gICAgICBzd2l0Y2ggKHJvd01vZGUpIHtcbiAgICAgICAgY2FzZSAnZml4ZWQnOlxuICAgICAgICAgIC8vIEluIGZpeGVkIG1vZGUsIHNpbXBseSB1c2UgdGhlIGdpdmVuIHJvd0hlaWdodC5cbiAgICAgICAgICBzdHlsZS50b3AgPSBQT1NJVElPTih7IHVuaXQ6IHJvd0hlaWdodCwgb2Zmc2V0OiBwb3NpdGlvbi5yb3csIGd1dHRlcjogZ3V0dGVyIH0pO1xuICAgICAgICAgIHN0eWxlLmhlaWdodCA9IERJTUVOU0lPTih7IHVuaXQ6IHJvd0hlaWdodCwgc3Bhbjogc3BhbnMucm93LCBndXR0ZXI6IGd1dHRlciB9KTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdyYXRpbyc6XG4gICAgICAgICAgLy8gUGVyY2VudCBvZiB0aGUgYXZhaWxhYmxlIHZlcnRpY2FsIHNwYWNlIHRoYXQgb25lIHJvdyB0YWtlcyB1cC4gSGVyZSwgcm93SGVpZ2h0IGhvbGRzXG4gICAgICAgICAgLy8gdGhlIHJhdGlvIHZhbHVlLiBGb3IgZXhhbXBsZSwgaWYgdGhlIHdpZHRoOmhlaWdodCByYXRpbyBpcyA0OjMsIHJvd0hlaWdodCA9IDEuMzMzLlxuICAgICAgICAgIHZhciB2U2hhcmUgPSBoU2hhcmUgLyByb3dIZWlnaHQ7XG5cbiAgICAgICAgICAvLyBCYXNlIHZlcml0Y2FsIHNpemUgb2YgYSByb3cuXG4gICAgICAgICAgdmFyIHZVbml0ID0gVU5JVCh7IHNoYXJlOiB2U2hhcmUsIGd1dHRlclNoYXJlOiBoR3V0dGVyU2hhcmUsIGd1dHRlcjogZ3V0dGVyIH0pO1xuXG4gICAgICAgICAgLy8gcGFkaWRuZ1RvcCBhbmQgbWFyZ2luVG9wIGFyZSB1c2VkIHRvIG1haW50YWluIHRoZSBnaXZlbiBhc3BlY3QgcmF0aW8sIGFzXG4gICAgICAgICAgLy8gYSBwZXJjZW50YWdlLWJhc2VkIHZhbHVlIGZvciB0aGVzZSBwcm9wZXJ0aWVzIGlzIGFwcGxpZWQgdG8gdGhlICp3aWR0aCogb2YgdGhlXG4gICAgICAgICAgLy8gY29udGFpbmluZyBibG9jay4gU2VlIGh0dHA6Ly93d3cudzMub3JnL1RSL0NTUzIvYm94Lmh0bWwjbWFyZ2luLXByb3BlcnRpZXNcbiAgICAgICAgICBzdHlsZS5wYWRkaW5nVG9wID0gRElNRU5TSU9OKHsgdW5pdDogdlVuaXQsIHNwYW46IHNwYW5zLnJvdywgZ3V0dGVyOiBndXR0ZXJ9KTtcbiAgICAgICAgICBzdHlsZS5tYXJnaW5Ub3AgPSBQT1NJVElPTih7IHVuaXQ6IHZVbml0LCBvZmZzZXQ6IHBvc2l0aW9uLnJvdywgZ3V0dGVyOiBndXR0ZXIgfSk7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnZml0JzpcbiAgICAgICAgICAvLyBGcmFjdGlvbiBvZiB0aGUgZ3V0dGVyIHNpemUgdGhhdCBlYWNoIGNvbHVtbiB0YWtlcyB1cC5cbiAgICAgICAgICB2YXIgdkd1dHRlclNoYXJlID0gKHJvd0NvdW50IC0gMSkgLyByb3dDb3VudDtcblxuICAgICAgICAgIC8vIFBlcmNlbnQgb2YgdGhlIGF2YWlsYWJsZSB2ZXJ0aWNhbCBzcGFjZSB0aGF0IG9uZSByb3cgdGFrZXMgdXAuXG4gICAgICAgICAgdmFyIHZTaGFyZSA9ICgxIC8gcm93Q291bnQpICogMTAwO1xuXG4gICAgICAgICAgLy8gQmFzZSB2ZXJ0aWNhbCBzaXplIG9mIGEgcm93LlxuICAgICAgICAgIHZhciB2VW5pdCA9IFVOSVQoe3NoYXJlOiB2U2hhcmUsIGd1dHRlclNoYXJlOiB2R3V0dGVyU2hhcmUsIGd1dHRlcjogZ3V0dGVyfSk7XG5cbiAgICAgICAgICBzdHlsZS50b3AgPSBQT1NJVElPTih7dW5pdDogdlVuaXQsIG9mZnNldDogcG9zaXRpb24ucm93LCBndXR0ZXI6IGd1dHRlcn0pO1xuICAgICAgICAgIHN0eWxlLmhlaWdodCA9IERJTUVOU0lPTih7dW5pdDogdlVuaXQsIHNwYW46IHNwYW5zLnJvdywgZ3V0dGVyOiBndXR0ZXJ9KTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHN0eWxlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEdyaWRTdHlsZShjb2xDb3VudCwgcm93Q291bnQsIGd1dHRlciwgcm93TW9kZSwgcm93SGVpZ2h0KSB7XG4gICAgICB2YXIgc3R5bGUgPSB7XG4gICAgICAgIGhlaWdodDogJycsXG4gICAgICAgIHBhZGRpbmdCb3R0b206ICcnXG4gICAgICB9O1xuXG4gICAgICBzd2l0Y2gocm93TW9kZSkge1xuICAgICAgICBjYXNlICdmaXhlZCc6XG4gICAgICAgICAgc3R5bGUuaGVpZ2h0ID0gRElNRU5TSU9OKHsgdW5pdDogcm93SGVpZ2h0LCBzcGFuOiByb3dDb3VudCwgZ3V0dGVyOiBndXR0ZXIgfSk7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAncmF0aW8nOlxuICAgICAgICAgIC8vIHJvd0hlaWdodCBpcyB3aWR0aCAvIGhlaWdodFxuICAgICAgICAgIHZhciBoR3V0dGVyU2hhcmUgPSBjb2xDb3VudCA9PT0gMSA/IDAgOiAoY29sQ291bnQgLSAxKSAvIGNvbENvdW50LFxuICAgICAgICAgICAgICBoU2hhcmUgPSAoMSAvIGNvbENvdW50KSAqIDEwMCxcbiAgICAgICAgICAgICAgdlNoYXJlID0gaFNoYXJlICogKDEgLyByb3dIZWlnaHQpLFxuICAgICAgICAgICAgICB2VW5pdCA9IFVOSVQoeyBzaGFyZTogdlNoYXJlLCBndXR0ZXJTaGFyZTogaEd1dHRlclNoYXJlLCBndXR0ZXI6IGd1dHRlciB9KTtcblxuICAgICAgICAgIHN0eWxlLnBhZGRpbmdCb3R0b20gPSBESU1FTlNJT04oeyB1bml0OiB2VW5pdCwgc3Bhbjogcm93Q291bnQsIGd1dHRlcjogZ3V0dGVyfSk7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnZml0JzpcbiAgICAgICAgICAvLyBub29wLCBhcyB0aGUgaGVpZ2h0IGlzIHVzZXIgc2V0XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzdHlsZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRUaWxlRWxlbWVudHMoKSB7XG4gICAgICByZXR1cm4gW10uZmlsdGVyLmNhbGwoZWxlbWVudC5jaGlsZHJlbigpLCBmdW5jdGlvbihlbGUpIHtcbiAgICAgICAgcmV0dXJuIGVsZS50YWdOYW1lID09ICdNRC1HUklELVRJTEUnO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyBhbiBhcnJheSBvZiBvYmplY3RzIGNvbnRhaW5pbmcgdGhlIHJvd3NwYW4gYW5kIGNvbHNwYW4gZm9yIGVhY2ggdGlsZS5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXk8e3JvdzogbnVtYmVyLCBjb2w6IG51bWJlcn0+fVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldFRpbGVTcGFucyh0aWxlRWxlbWVudHMpIHtcbiAgICAgIHJldHVybiBbXS5tYXAuY2FsbCh0aWxlRWxlbWVudHMsIGZ1bmN0aW9uKGVsZSkge1xuICAgICAgICB2YXIgY3RybCA9IGFuZ3VsYXIuZWxlbWVudChlbGUpLmNvbnRyb2xsZXIoJ21kR3JpZFRpbGUnKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICByb3c6IHBhcnNlSW50KFxuICAgICAgICAgICAgICAkbWRNZWRpYS5nZXRSZXNwb25zaXZlQXR0cmlidXRlKGN0cmwuJGF0dHJzLCAnbWQtcm93c3BhbicpLCAxMCkgfHwgMSxcbiAgICAgICAgICBjb2w6IHBhcnNlSW50KFxuICAgICAgICAgICAgICAkbWRNZWRpYS5nZXRSZXNwb25zaXZlQXR0cmlidXRlKGN0cmwuJGF0dHJzLCAnbWQtY29sc3BhbicpLCAxMCkgfHwgMVxuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0Q29sdW1uQ291bnQoKSB7XG4gICAgICB2YXIgY29sQ291bnQgPSBwYXJzZUludCgkbWRNZWRpYS5nZXRSZXNwb25zaXZlQXR0cmlidXRlKGF0dHJzLCAnbWQtY29scycpLCAxMCk7XG4gICAgICBpZiAoaXNOYU4oY29sQ291bnQpKSB7XG4gICAgICAgIHRocm93ICdtZC1ncmlkLWxpc3Q6IG1kLWNvbHMgYXR0cmlidXRlIHdhcyBub3QgZm91bmQsIG9yIGNvbnRhaW5lZCBhIG5vbi1udW1lcmljIHZhbHVlJztcbiAgICAgIH1cbiAgICAgIHJldHVybiBjb2xDb3VudDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRHdXR0ZXIoKSB7XG4gICAgICByZXR1cm4gYXBwbHlEZWZhdWx0VW5pdCgkbWRNZWRpYS5nZXRSZXNwb25zaXZlQXR0cmlidXRlKGF0dHJzLCAnbWQtZ3V0dGVyJykgfHwgMSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0Um93SGVpZ2h0KCkge1xuICAgICAgdmFyIHJvd0hlaWdodCA9ICRtZE1lZGlhLmdldFJlc3BvbnNpdmVBdHRyaWJ1dGUoYXR0cnMsICdtZC1yb3ctaGVpZ2h0Jyk7XG4gICAgICBzd2l0Y2ggKGdldFJvd01vZGUoKSkge1xuICAgICAgICBjYXNlICdmaXhlZCc6XG4gICAgICAgICAgcmV0dXJuIGFwcGx5RGVmYXVsdFVuaXQocm93SGVpZ2h0KTtcbiAgICAgICAgY2FzZSAncmF0aW8nOlxuICAgICAgICAgIHZhciB3aFJhdGlvID0gcm93SGVpZ2h0LnNwbGl0KCc6Jyk7XG4gICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQod2hSYXRpb1swXSkgLyBwYXJzZUZsb2F0KHdoUmF0aW9bMV0pO1xuICAgICAgICBjYXNlICdmaXQnOlxuICAgICAgICAgIHJldHVybiAwOyAvLyBOL0FcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRSb3dNb2RlKCkge1xuICAgICAgdmFyIHJvd0hlaWdodCA9ICRtZE1lZGlhLmdldFJlc3BvbnNpdmVBdHRyaWJ1dGUoYXR0cnMsICdtZC1yb3ctaGVpZ2h0Jyk7XG4gICAgICBpZiAocm93SGVpZ2h0ID09ICdmaXQnKSB7XG4gICAgICAgIHJldHVybiAnZml0JztcbiAgICAgIH0gZWxzZSBpZiAocm93SGVpZ2h0LmluZGV4T2YoJzonKSAhPT0gLTEpIHtcbiAgICAgICAgcmV0dXJuICdyYXRpbyc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJ2ZpeGVkJztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhcHBseURlZmF1bHRVbml0KHZhbCkge1xuICAgICAgcmV0dXJuIC9cXEQkLy50ZXN0KHZhbCkgPyB2YWwgOiB2YWwgKyAncHgnO1xuICAgIH1cbiAgfVxufVxuR3JpZExpc3REaXJlY3RpdmUuJGluamVjdCA9IFtcIiRpbnRlcnBvbGF0ZVwiLCBcIiRtZENvbnN0YW50XCIsIFwiJG1kR3JpZExheW91dFwiLCBcIiRtZE1lZGlhXCJdO1xuXG4vKiBAbmdJbmplY3QgKi9cbmZ1bmN0aW9uIEdyaWRMaXN0Q29udHJvbGxlcigkdGltZW91dCkge1xuICB0aGlzLmxheW91dEludmFsaWRhdGVkID0gZmFsc2U7XG4gIHRoaXMudGlsZXNJbnZhbGlkYXRlZCA9IGZhbHNlO1xuICB0aGlzLiR0aW1lb3V0XyA9ICR0aW1lb3V0O1xuICB0aGlzLmxheW91dERlbGVnYXRlID0gYW5ndWxhci5ub29wO1xufVxuR3JpZExpc3RDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkdGltZW91dFwiXTtcblxuR3JpZExpc3RDb250cm9sbGVyLnByb3RvdHlwZSA9IHtcbiAgaW52YWxpZGF0ZVRpbGVzOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnRpbGVzSW52YWxpZGF0ZWQgPSB0cnVlO1xuICAgIHRoaXMuaW52YWxpZGF0ZUxheW91dCgpO1xuICB9LFxuXG4gIGludmFsaWRhdGVMYXlvdXQ6IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLmxheW91dEludmFsaWRhdGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMubGF5b3V0SW52YWxpZGF0ZWQgPSB0cnVlO1xuICAgIHRoaXMuJHRpbWVvdXRfKGFuZ3VsYXIuYmluZCh0aGlzLCB0aGlzLmxheW91dCkpO1xuICB9LFxuXG4gIGxheW91dDogZnVuY3Rpb24oKSB7XG4gICAgdHJ5IHtcbiAgICAgIHRoaXMubGF5b3V0RGVsZWdhdGUodGhpcy50aWxlc0ludmFsaWRhdGVkKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgdGhpcy5sYXlvdXRJbnZhbGlkYXRlZCA9IGZhbHNlO1xuICAgICAgdGhpcy50aWxlc0ludmFsaWRhdGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG59O1xuXG5cbi8qIEBuZ0luamVjdCAqL1xuZnVuY3Rpb24gR3JpZExheW91dEZhY3RvcnkoJG1kVXRpbCkge1xuICB2YXIgZGVmYXVsdEFuaW1hdG9yID0gR3JpZFRpbGVBbmltYXRvcjtcblxuICAvKipcbiAgICogU2V0IHRoZSByZWZsb3cgYW5pbWF0b3IgY2FsbGJhY2tcbiAgICovXG4gIEdyaWRMYXlvdXQuYW5pbWF0ZVdpdGggPSBmdW5jdGlvbihjdXN0b21BbmltYXRvcikge1xuICAgIGRlZmF1bHRBbmltYXRvciA9ICFhbmd1bGFyLmlzRnVuY3Rpb24oY3VzdG9tQW5pbWF0b3IpID8gR3JpZFRpbGVBbmltYXRvciA6IGN1c3RvbUFuaW1hdG9yO1xuICB9O1xuXG4gIHJldHVybiBHcmlkTGF5b3V0O1xuXG4gIC8qKlxuICAgKiBQdWJsaXNoIGxheW91dCBmdW5jdGlvblxuICAgKi9cbiAgZnVuY3Rpb24gR3JpZExheW91dChjb2xDb3VudCwgdGlsZVNwYW5zKSB7XG4gICAgICB2YXIgc2VsZiwgbGF5b3V0SW5mbywgZ3JpZFN0eWxlcywgbGF5b3V0VGltZSwgbWFwVGltZSwgcmVmbG93VGltZTtcblxuICAgICAgbGF5b3V0VGltZSA9ICRtZFV0aWwudGltZShmdW5jdGlvbigpIHtcbiAgICAgICAgbGF5b3V0SW5mbyA9IGNhbGN1bGF0ZUdyaWRGb3IoY29sQ291bnQsIHRpbGVTcGFucyk7XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHNlbGYgPSB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFuIGFycmF5IG9mIG9iamVjdHMgZGVzY3JpYmluZyBlYWNoIHRpbGUncyBwb3NpdGlvbiBpbiB0aGUgZ3JpZC5cbiAgICAgICAgICovXG4gICAgICAgIGxheW91dEluZm86IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBsYXlvdXRJbmZvO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYXBzIGdyaWQgcG9zaXRpb25pbmcgdG8gYW4gZWxlbWVudCBhbmQgYSBzZXQgb2Ygc3R5bGVzIHVzaW5nIHRoZVxuICAgICAgICAgKiBwcm92aWRlZCB1cGRhdGVGbi5cbiAgICAgICAgICovXG4gICAgICAgIG1hcDogZnVuY3Rpb24odXBkYXRlRm4pIHtcbiAgICAgICAgICBtYXBUaW1lID0gJG1kVXRpbC50aW1lKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGluZm8gPSBzZWxmLmxheW91dEluZm8oKTtcbiAgICAgICAgICAgIGdyaWRTdHlsZXMgPSB1cGRhdGVGbihpbmZvLnBvc2l0aW9uaW5nLCBpbmZvLnJvd0NvdW50KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gc2VsZjtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogRGVmYXVsdCBhbmltYXRvciBzaW1wbHkgc2V0cyB0aGUgZWxlbWVudC5jc3MoIDxzdHlsZXM+ICkuIEFuIGFsdGVybmF0ZVxuICAgICAgICAgKiBhbmltYXRvciBjYW4gYmUgcHJvdmlkZWQgYXMgYW4gYXJndW1lbnQuIFRoZSBmdW5jdGlvbiBoYXMgdGhlIGZvbGxvd2luZ1xuICAgICAgICAgKiBzaWduYXR1cmU6XG4gICAgICAgICAqXG4gICAgICAgICAqICAgIGZ1bmN0aW9uKHtncmlkOiB7ZWxlbWVudDogSlFMaXRlLCBzdHlsZTogT2JqZWN0fSwgdGlsZXM6IEFycmF5PHtlbGVtZW50OiBKUUxpdGUsIHN0eWxlOiBPYmplY3R9PilcbiAgICAgICAgICovXG4gICAgICAgIHJlZmxvdzogZnVuY3Rpb24oYW5pbWF0b3JGbikge1xuICAgICAgICAgIHJlZmxvd1RpbWUgPSAkbWRVdGlsLnRpbWUoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgYW5pbWF0b3IgPSBhbmltYXRvckZuIHx8IGRlZmF1bHRBbmltYXRvcjtcbiAgICAgICAgICAgIGFuaW1hdG9yKGdyaWRTdHlsZXMuZ3JpZCwgZ3JpZFN0eWxlcy50aWxlcyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIHNlbGY7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRpbWluZyBmb3IgdGhlIG1vc3QgcmVjZW50IGxheW91dCBydW4uXG4gICAgICAgICAqL1xuICAgICAgICBwZXJmb3JtYW5jZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRpbGVDb3VudDogdGlsZVNwYW5zLmxlbmd0aCxcbiAgICAgICAgICAgIGxheW91dFRpbWU6IGxheW91dFRpbWUsXG4gICAgICAgICAgICBtYXBUaW1lOiBtYXBUaW1lLFxuICAgICAgICAgICAgcmVmbG93VGltZTogcmVmbG93VGltZSxcbiAgICAgICAgICAgIHRvdGFsVGltZTogbGF5b3V0VGltZSArIG1hcFRpbWUgKyByZWZsb3dUaW1lXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG5cbiAgLyoqXG4gICAqIERlZmF1bHQgR3JpZGxpc3QgYW5pbWF0b3Igc2ltcGxlIHNldHMgdGhlIGNzcyBmb3IgZWFjaCBlbGVtZW50O1xuICAgKiBOT1RFOiBhbnkgdHJhbnNpdGlvbnMgZWZmZWN0cyBtdXN0IGJlIG1hbnVhbGx5IHNldCBpbiB0aGUgQ1NTLlxuICAgKiBlLmcuXG4gICAqXG4gICAqICBtZC1ncmlkLXRpbGUge1xuICAgKiAgICB0cmFuc2l0aW9uOiBhbGwgNzAwbXMgZWFzZS1vdXQgNTBtcztcbiAgICogIH1cbiAgICpcbiAgICovXG4gIGZ1bmN0aW9uIEdyaWRUaWxlQW5pbWF0b3IoZ3JpZCwgdGlsZXMpIHtcbiAgICBncmlkLmVsZW1lbnQuY3NzKGdyaWQuc3R5bGUpO1xuICAgIHRpbGVzLmZvckVhY2goZnVuY3Rpb24odCkge1xuICAgICAgdC5lbGVtZW50LmNzcyh0LnN0eWxlKTtcbiAgICB9KVxuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZXMgdGhlIHBvc2l0aW9ucyBvZiB0aWxlcy5cbiAgICpcbiAgICogVGhlIGFsZ29yaXRobSB3b3JrcyBhcyBmb2xsb3dzOlxuICAgKiAgICBBbiBBcnJheTxOdW1iZXI+IHdpdGggbGVuZ3RoIGNvbENvdW50IChzcGFjZVRyYWNrZXIpIGtlZXBzIHRyYWNrIG9mXG4gICAqICAgIGF2YWlsYWJsZSB0aWxpbmcgcG9zaXRpb25zLCB3aGVyZSBlbGVtZW50cyBvZiB2YWx1ZSAwIHJlcHJlc2VudHMgYW5cbiAgICogICAgZW1wdHkgcG9zaXRpb24uIFNwYWNlIGZvciBhIHRpbGUgaXMgcmVzZXJ2ZWQgYnkgZmluZGluZyBhIHNlcXVlbmNlIG9mXG4gICAqICAgIDBzIHdpdGggbGVuZ3RoIDw9IHRoYW4gdGhlIHRpbGUncyBjb2xzcGFuLiBXaGVuIHN1Y2ggYSBzcGFjZSBoYXMgYmVlblxuICAgKiAgICBmb3VuZCwgdGhlIG9jY3VwaWVkIHRpbGUgcG9zaXRpb25zIGFyZSBpbmNyZW1lbnRlZCBieSB0aGUgdGlsZSdzXG4gICAqICAgIHJvd3NwYW4gdmFsdWUsIGFzIHRoZXNlIHBvc2l0aW9ucyBoYXZlIGJlY29tZSB1bmF2YWlsYWJsZSBmb3IgdGhhdFxuICAgKiAgICBtYW55IHJvd3MuXG4gICAqXG4gICAqICAgIElmIHRoZSBlbmQgb2YgYSByb3cgaGFzIGJlZW4gcmVhY2hlZCB3aXRob3V0IGZpbmRpbmcgc3BhY2UgZm9yIHRoZVxuICAgKiAgICB0aWxlLCBzcGFjZVRyYWNrZXIncyBlbGVtZW50cyBhcmUgZWFjaCBkZWNyZW1lbnRlZCBieSAxIHRvIGEgbWluaW11bVxuICAgKiAgICBvZiAwLiBSb3dzIGFyZSBzZWFyY2hlZCBpbiB0aGlzIGZhc2hpb24gdW50aWwgc3BhY2UgaXMgZm91bmQuXG4gICAqL1xuICBmdW5jdGlvbiBjYWxjdWxhdGVHcmlkRm9yKGNvbENvdW50LCB0aWxlU3BhbnMpIHtcbiAgICB2YXIgY3VyQ29sID0gMCxcbiAgICAgICAgY3VyUm93ID0gMCxcbiAgICAgICAgc3BhY2VUcmFja2VyID0gbmV3U3BhY2VUcmFja2VyKCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgcG9zaXRpb25pbmc6IHRpbGVTcGFucy5tYXAoZnVuY3Rpb24oc3BhbnMsIGkpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzcGFuczogc3BhbnMsXG4gICAgICAgICAgcG9zaXRpb246IHJlc2VydmVTcGFjZShzcGFucywgaSlcbiAgICAgICAgfTtcbiAgICAgIH0pLFxuICAgICAgcm93Q291bnQ6IGN1clJvdyArIE1hdGgubWF4LmFwcGx5KE1hdGgsIHNwYWNlVHJhY2tlcilcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gcmVzZXJ2ZVNwYWNlKHNwYW5zLCBpKSB7XG4gICAgICBpZiAoc3BhbnMuY29sID4gY29sQ291bnQpIHtcbiAgICAgICAgdGhyb3cgJ21kLWdyaWQtbGlzdDogVGlsZSBhdCBwb3NpdGlvbiAnICsgaSArICcgaGFzIGEgY29sc3BhbiAnICtcbiAgICAgICAgICAgICcoJyArIHNwYW5zLmNvbCArICcpIHRoYXQgZXhjZWVkcyB0aGUgY29sdW1uIGNvdW50ICcgK1xuICAgICAgICAgICAgJygnICsgY29sQ291bnQgKyAnKSc7XG4gICAgICB9XG5cbiAgICAgIHZhciBzdGFydCA9IDAsXG4gICAgICAgICAgZW5kID0gMDtcblxuICAgICAgLy8gVE9ETyhzaHluZG1hbik6IFRoaXMgbG9vcCBpc24ndCBzdHJpY3RseSBuZWNlc3NhcnkgaWYgeW91IGNhblxuICAgICAgLy8gZGV0ZXJtaW5lIHRoZSBtaW5pbXVtIG51bWJlciBvZiByb3dzIGJlZm9yZSBhIHNwYWNlIG9wZW5zIHVwLiBUbyBkb1xuICAgICAgLy8gdGhpcywgcmVjb2duaXplIHRoYXQgeW91J3ZlIGl0ZXJhdGVkIGFjcm9zcyBhbiBlbnRpcmUgcm93IGxvb2tpbmcgZm9yXG4gICAgICAvLyBzcGFjZSwgYW5kIGlmIHNvIGZhc3QtZm9yd2FyZCBieSB0aGUgbWluaW11bSByb3dTcGFuIGNvdW50LiBSZXBlYXRcbiAgICAgIC8vIHVudGlsIHRoZSByZXF1aXJlZCBzcGFjZSBvcGVucyB1cC5cbiAgICAgIHdoaWxlIChlbmQgLSBzdGFydCA8IHNwYW5zLmNvbCkge1xuICAgICAgICBpZiAoY3VyQ29sID49IGNvbENvdW50KSB7XG4gICAgICAgICAgbmV4dFJvdygpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgc3RhcnQgPSBzcGFjZVRyYWNrZXIuaW5kZXhPZigwLCBjdXJDb2wpO1xuICAgICAgICBpZiAoc3RhcnQgPT09IC0xIHx8IChlbmQgPSBmaW5kRW5kKHN0YXJ0ICsgMSkpID09PSAtMSkge1xuICAgICAgICAgIHN0YXJ0ID0gZW5kID0gMDtcbiAgICAgICAgICBuZXh0Um93KCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBjdXJDb2wgPSBlbmQgKyAxO1xuICAgICAgfVxuXG4gICAgICBhZGp1c3RSb3coc3RhcnQsIHNwYW5zLmNvbCwgc3BhbnMucm93KTtcbiAgICAgIGN1ckNvbCA9IHN0YXJ0ICsgc3BhbnMuY29sO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb2w6IHN0YXJ0LFxuICAgICAgICByb3c6IGN1clJvd1xuICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBuZXh0Um93KCkge1xuICAgICAgY3VyQ29sID0gMDtcbiAgICAgIGN1clJvdysrO1xuICAgICAgYWRqdXN0Um93KDAsIGNvbENvdW50LCAtMSk7IC8vIERlY3JlbWVudCByb3cgc3BhbnMgYnkgb25lXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWRqdXN0Um93KGZyb20sIGNvbHMsIGJ5KSB7XG4gICAgICBmb3IgKHZhciBpID0gZnJvbTsgaSA8IGZyb20gKyBjb2xzOyBpKyspIHtcbiAgICAgICAgc3BhY2VUcmFja2VyW2ldID0gTWF0aC5tYXgoc3BhY2VUcmFja2VyW2ldICsgYnksIDApO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZpbmRFbmQoc3RhcnQpIHtcbiAgICAgIHZhciBpO1xuICAgICAgZm9yIChpID0gc3RhcnQ7IGkgPCBzcGFjZVRyYWNrZXIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHNwYWNlVHJhY2tlcltpXSAhPT0gMCkge1xuICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChpID09PSBzcGFjZVRyYWNrZXIubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5ld1NwYWNlVHJhY2tlcigpIHtcbiAgICAgIHZhciB0cmFja2VyID0gW107XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbENvdW50OyBpKyspIHtcbiAgICAgICAgdHJhY2tlci5wdXNoKDApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRyYWNrZXI7XG4gICAgfVxuICB9XG59XG5HcmlkTGF5b3V0RmFjdG9yeS4kaW5qZWN0ID0gW1wiJG1kVXRpbFwiXTtcblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBtZEdyaWRUaWxlXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuZ3JpZExpc3RcbiAqIEByZXN0cmljdCBFXG4gKiBAZGVzY3JpcHRpb25cbiAqIFRpbGVzIGNvbnRhaW4gdGhlIGNvbnRlbnQgb2YgYW4gYG1kLWdyaWQtbGlzdGAuIFRoZXkgc3BhbiBvbmUgb3IgbW9yZSBncmlkXG4gKiBjZWxscyB2ZXJ0aWNhbGx5IG9yIGhvcml6b250YWxseSwgYW5kIHVzZSBgbWQtZ3JpZC10aWxlLXtmb290ZXIsaGVhZGVyfWAgdG9cbiAqIGRpc3BsYXkgc2Vjb25kYXJ5IGNvbnRlbnQuXG4gKlxuICogIyMjIFJlc3BvbnNpdmUgQXR0cmlidXRlc1xuICpcbiAqIFRoZSBgbWQtZ3JpZC10aWxlYCBkaXJlY3RpdmUgc3VwcG9ydHMgXCJyZXNwb25zaXZlXCIgYXR0cmlidXRlcywgd2hpY2ggYWxsb3dcbiAqIGRpZmZlcmVudCBgbWQtcm93c3BhbmAgYW5kIGBtZC1jb2xzcGFuYCB2YWx1ZXMgZGVwZW5kaW5nIG9uIHRoZSBjdXJyZW50bHlcbiAqIG1hdGNoaW5nIG1lZGlhIHF1ZXJ5IChhcyBkZWZpbmVkIGluIGAkbWRDb25zdGFudC5NRURJQWApLlxuICpcbiAqIEluIG9yZGVyIHRvIHNldCBhIHJlc3BvbnNpdmUgYXR0cmlidXRlLCBmaXJzdCBkZWZpbmUgdGhlIGZhbGxiYWNrIHZhbHVlIHdpdGhcbiAqIHRoZSBzdGFuZGFyZCBhdHRyaWJ1dGUgbmFtZSwgdGhlbiBhZGQgYWRkaXRpb25hbCBhdHRyaWJ1dGVzIHdpdGggdGhlXG4gKiBmb2xsb3dpbmcgY29udmVudGlvbjogYHtiYXNlLWF0dHJpYnV0ZS1uYW1lfS17bWVkaWEtcXVlcnktbmFtZX09XCJ7dmFsdWV9XCJgXG4gKiAoaWUuIGBtZC1jb2xzcGFuLXNtPVwiNFwiYClcbiAqXG4gKiBAcGFyYW0ge251bWJlcj19IG1kLWNvbHNwYW4gVGhlIG51bWJlciBvZiBjb2x1bW5zIHRvIHNwYW4gKGRlZmF1bHQgMSkuIENhbm5vdFxuICogICAgZXhjZWVkIHRoZSBudW1iZXIgb2YgY29sdW1ucyBpbiB0aGUgZ3JpZC4gU3VwcG9ydHMgaW50ZXJwb2xhdGlvbi5cbiAqIEBwYXJhbSB7bnVtYmVyPX0gbWQtcm93c3BhbiBUaGUgbnVtYmVyIG9mIHJvd3MgdG8gc3BhbiAoZGVmYXVsdCAxKS4gU3VwcG9ydHNcbiAqICAgICBpbnRlcnBvbGF0aW9uLlxuICpcbiAqIEB1c2FnZVxuICogV2l0aCBoZWFkZXI6XG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxuICogPG1kLWdyaWQtdGlsZT5cbiAqICAgPG1kLWdyaWQtdGlsZS1oZWFkZXI+XG4gKiAgICAgPGgzPlRoaXMgaXMgYSBoZWFkZXI8L2gzPlxuICogICA8L21kLWdyaWQtdGlsZS1oZWFkZXI+XG4gKiA8L21kLWdyaWQtdGlsZT5cbiAqIDwvaGxqcz5cbiAqXG4gKiBXaXRoIGZvb3RlcjpcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiA8bWQtZ3JpZC10aWxlPlxuICogICA8bWQtZ3JpZC10aWxlLWZvb3Rlcj5cbiAqICAgICA8aDM+VGhpcyBpcyBhIGZvb3RlcjwvaDM+XG4gKiAgIDwvbWQtZ3JpZC10aWxlLWZvb3Rlcj5cbiAqIDwvbWQtZ3JpZC10aWxlPlxuICogPC9obGpzPlxuICpcbiAqIFNwYW5uaW5nIG11bHRpcGxlIHJvd3MvY29sdW1uczpcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiA8bWQtZ3JpZC10aWxlIG1kLWNvbHNwYW49XCIyXCIgbWQtcm93c3Bhbj1cIjNcIj5cbiAqIDwvbWQtZ3JpZC10aWxlPlxuICogPC9obGpzPlxuICpcbiAqIFJlc3BvbnNpdmUgYXR0cmlidXRlczpcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiA8bWQtZ3JpZC10aWxlIG1kLWNvbHNwYW49XCIxXCIgbWQtY29sc3Bhbi1zbT1cIjNcIiBtZC1jb2xzcGFuLW1kPVwiNVwiPlxuICogPC9tZC1ncmlkLXRpbGU+XG4gKiA8L2hsanM+XG4gKi9cbmZ1bmN0aW9uIEdyaWRUaWxlRGlyZWN0aXZlKCRtZE1lZGlhKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdFJyxcbiAgICByZXF1aXJlOiAnXm1kR3JpZExpc3QnLFxuICAgIHRlbXBsYXRlOiAnPGZpZ3VyZSBuZy10cmFuc2NsdWRlPjwvZmlndXJlPicsXG4gICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICBzY29wZToge30sXG4gICAgLy8gU2ltcGxlIGNvbnRyb2xsZXIgdGhhdCBleHBvc2VzIGF0dHJpYnV0ZXMgdG8gdGhlIGdyaWQgZGlyZWN0aXZlXG4gICAgY29udHJvbGxlcjogW1wiJGF0dHJzXCIsIGZ1bmN0aW9uKCRhdHRycykge1xuICAgICAgdGhpcy4kYXR0cnMgPSAkYXR0cnM7XG4gICAgfV0sXG4gICAgbGluazogcG9zdExpbmtcbiAgfTtcblxuICBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMsIGdyaWRDdHJsKSB7XG4gICAgLy8gQXBwbHkgc2VtYW50aWNzXG4gICAgZWxlbWVudC5hdHRyKCdyb2xlJywgJ2xpc3RpdGVtJyk7XG5cbiAgICAvLyBJZiBvdXIgY29sc3BhbiBvciByb3dzcGFuIGNoYW5nZXMsIHRyaWdnZXIgYSBsYXlvdXRcbiAgICB2YXIgdW53YXRjaEF0dHJzID0gJG1kTWVkaWEud2F0Y2hSZXNwb25zaXZlQXR0cmlidXRlcyhbJ21kLWNvbHNwYW4nLCAnbWQtcm93c3BhbiddLFxuICAgICAgICBhdHRycywgYW5ndWxhci5iaW5kKGdyaWRDdHJsLCBncmlkQ3RybC5pbnZhbGlkYXRlTGF5b3V0KSk7XG5cbiAgICAvLyBUaWxlIHJlZ2lzdHJhdGlvbi9kZXJlZ2lzdHJhdGlvblxuICAgIGdyaWRDdHJsLmludmFsaWRhdGVUaWxlcygpO1xuICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcbiAgICAgIHVud2F0Y2hBdHRycygpO1xuICAgICAgZ3JpZEN0cmwuaW52YWxpZGF0ZUxheW91dCgpO1xuICAgIH0pO1xuXG4gICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKHNjb3BlLiRwYXJlbnQuJGluZGV4KSkge1xuICAgICAgc2NvcGUuJHdhdGNoKGZ1bmN0aW9uKCkgeyByZXR1cm4gc2NvcGUuJHBhcmVudC4kaW5kZXg7IH0sXG4gICAgICAgIGZ1bmN0aW9uIGluZGV4Q2hhbmdlZChuZXdJZHgsIG9sZElkeCkge1xuICAgICAgICAgIGlmIChuZXdJZHggPT09IG9sZElkeCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBncmlkQ3RybC5pbnZhbGlkYXRlVGlsZXMoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICB9XG59XG5HcmlkVGlsZURpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kTWVkaWFcIl07XG5cblxuZnVuY3Rpb24gR3JpZFRpbGVDYXB0aW9uRGlyZWN0aXZlKCkge1xuICByZXR1cm4ge1xuICAgIHRlbXBsYXRlOiAnPGZpZ2NhcHRpb24gbmctdHJhbnNjbHVkZT48L2ZpZ2NhcHRpb24+JyxcbiAgICB0cmFuc2NsdWRlOiB0cnVlXG4gIH07XG59XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIEBuZ2RvYyBtb2R1bGVcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuaWNvblxuICogQGRlc2NyaXB0aW9uXG4gKiBJY29uXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmljb24nLCBbXG4gICAgJ21hdGVyaWFsLmNvcmUnXG4gIF0pXG4gIC5kaXJlY3RpdmUoJ21kSWNvbicsIG1kSWNvbkRpcmVjdGl2ZSk7XG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbWRJY29uXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuaWNvblxuICpcbiAqIEByZXN0cmljdCBFXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBUaGUgYDxtZC1pY29uPmAgZGlyZWN0aXZlIGlzIGFuIG1hcmt1cCBlbGVtZW50IHVzZWZ1bCBmb3Igc2hvd2luZyBhbiBpY29uIGJhc2VkIG9uIGEgZm9udC1pY29uXG4gKiBvciBhIFNWRy4gSWNvbnMgYXJlIHZpZXctb25seSBlbGVtZW50cyB0aGF0IHNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBhcyBidXR0b25zOyBpbnN0ZWFkIG5lc3QgYSBgPG1kLWljb24+YFxuICogaW5zaWRlIGEgYG1kLWJ1dHRvbmAgdG8gYWRkIGhvdmVyIGFuZCBjbGljayBmZWF0dXJlcy5cbiAqXG4gKiBXaGVuIHVzaW5nIFNWR3MsIGJvdGggZXh0ZXJuYWwgU1ZHcyAodmlhIFVSTHMpIG9yIHNldHMgb2YgU1ZHcyBbZnJvbSBpY29uIHNldHNdIGNhbiBiZVxuICogZWFzaWx5IGxvYWRlZCBhbmQgdXNlZC5XaGVuIHVzZSBmb250LWljb25zLCBkZXZlbG9wZXJzIG11c3QgZm9sbG93aW5nIHRocmVlICgzKSBzaW1wbGUgc3RlcHM6XG4gKlxuICogPG9sPlxuICogPGxpPkxvYWQgdGhlIGZvbnQgbGlicmFyeS4gZS5nLjxici8+XG4gKiAgICAmbHQ7bGluayBocmVmPVwiaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9pY29uP2ZhbWlseT1NYXRlcmlhbCtJY29uc1wiXG4gKiAgICByZWw9XCJzdHlsZXNoZWV0XCImZ3Q7XG4gKiA8L2xpPlxuICogPGxpPiBVc2UgZWl0aGVyIChhKSBmb250LWljb24gY2xhc3MgbmFtZXMgb3IgKGIpIGZvbnQgbGlnYXR1cmVzIHRvIHJlbmRlciB0aGUgZm9udCBnbHlwaCBieSB1c2luZyBpdHMgdGV4dHVhbCBuYW1lPC9saT5cbiAqIDxsaT4gVXNlICZsdDttZC1pY29uIG1kLWZvbnQtaWNvbj1cImNsYXNzbmFtZVwiIC8mZ3Q7IG9yIDxici8+XG4gKiAgICAgdXNlICZsdDttZC1pY29uIG1kLWZvbnQtc2V0PVwiZm9udCBsaWJyYXJ5IGNsYXNzbmFtZSBvciBhbGlhc1wiJmd0OyB0ZXh0dWFsX25hbWUgJmx0Oy9tZC1pY29uJmd0OyBvciA8YnIvPlxuICogICAgIHVzZSAmbHQ7bWQtaWNvbiBtZC1mb250LXNldD1cImZvbnQgbGlicmFyeSBjbGFzc25hbWUgb3IgYWxpYXNcIiZndDsgbnVtZXJpY2FsX2NoYXJhY3Rlcl9yZWZlcmVuY2UgJmx0Oy9tZC1pY29uJmd0O1xuICogPC9saT5cbiAqIDwvb2w+XG4gKlxuICogRnVsbCBkZXRhaWxzIGZvciB0aGVzZSBzdGVwcyBjYW4gYmUgZm91bmQ6XG4gKlxuICogPHVsPlxuICogPGxpPmh0dHA6Ly9nb29nbGUuZ2l0aHViLmlvL21hdGVyaWFsLWRlc2lnbi1pY29ucy88L2xpPlxuICogPGxpPmh0dHA6Ly9nb29nbGUuZ2l0aHViLmlvL21hdGVyaWFsLWRlc2lnbi1pY29ucy8jaWNvbi1mb250LWZvci10aGUtd2ViPC9saT5cbiAqIDwvdWw+XG4gKlxuICogVGhlIE1hdGVyaWFsIERlc2lnbiBpY29uIHN0eWxlIDxjb2RlPi5tYXRlcmlhbC1pY29uczwvY29kZT4gYW5kIHRoZSBpY29uIGZvbnQgcmVmZXJlbmNlcyBhcmUgcHVibGlzaGVkIGluXG4gKiBNYXRlcmlhbCBEZXNpZ24gSWNvbnM6XG4gKlxuICogPHVsPlxuICogPGxpPmh0dHA6Ly93d3cuZ29vZ2xlLmNvbS9kZXNpZ24vaWNvbnMvPC9saT5cbiAqIDxsaT5odHRwczovL3d3dy5nb29nbGUuY29tL2Rlc2lnbi9pY29ucy8jaWNfYWNjZXNzaWJpbGl0eTwvbGk+XG4gKiA8L3VsPlxuICpcbiAqIDxoMiBpZD1cIm1hdGVyaWFsX2Rlc2lnbl9pY29uc1wiPk1hdGVyaWFsIERlc2lnbiBJY29uczwvaDI+XG4gKiBVc2luZyB0aGUgTWF0ZXJpYWwgRGVzaWduIEljb24tU2VsZWN0b3IsIGRldmVsb3BlcnMgY2FuIGVhc2lseSBhbmQgcXVpY2tseSBzZWFyY2ggZm9yIGEgTWF0ZXJpYWwgRGVzaWduIGZvbnQtaWNvbiBhbmRcbiAqIGRldGVybWluZSBpdHMgdGV4dHVhbCBuYW1lIGFuZCBjaGFyYWN0ZXIgcmVmZXJlbmNlIGNvZGUuIENsaWNrIG9uIGFueSBpY29uIHRvIHNlZSB0aGUgc2xpZGUtdXAgaW5mb3JtYXRpb25cbiAqIHBhbmVsIHdpdGggZGV0YWlscyByZWdhcmRpbmcgYSBTVkcgZG93bmxvYWQgb3IgaW5mb3JtYXRpb24gb24gdGhlIGZvbnQtaWNvbiB1c2FnZS5cbiAqXG4gKiA8YSBocmVmPVwiaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9kZXNpZ24vaWNvbnMvI2ljX2FjY2Vzc2liaWxpdHlcIiB0YXJnZXQ9XCJfYmxhbmtcIiBzdHlsZT1cImJvcmRlci1ib3R0b206bm9uZTtcIj5cbiAqIDxpbWcgc3JjPVwiaHR0cHM6Ly9jbG91ZC5naXRodWJ1c2VyY29udGVudC5jb20vYXNzZXRzLzIxMDQxMy83OTAyNDkwL2ZlOGRkMTRjLTA3ODAtMTFlNS05OGZiLWM4MjFjYzY0NzVlNi5wbmdcIlxuICogICAgICBhcmlhLWxhYmVsPVwiTWF0ZXJpYWwgRGVzaWduIEljb24tU2VsZWN0b3JcIiBzdHlsZT1cIm1heC13aWR0aDo3NSU7cGFkZGluZy1sZWZ0OjEwJVwiPlxuICogPC9hPlxuICpcbiAqIDxzcGFuIGNsYXNzPVwiaW1hZ2VfY2FwdGlvblwiPlxuICogIENsaWNrIG9uIHRoZSBpbWFnZSBhYm92ZSB0byBsaW5rIHRvIHRoZVxuICogIDxhIGhyZWY9XCJodHRwczovL3d3dy5nb29nbGUuY29tL2Rlc2lnbi9pY29ucy8jaWNfYWNjZXNzaWJpbGl0eVwiIHRhcmdldD1cIl9ibGFua1wiPk1hdGVyaWFsIERlc2lnbiBJY29uLVNlbGVjdG9yPC9hPi5cbiAqIDwvc3Bhbj5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbWQtZm9udC1pY29uIE5hbWUgb2YgQ1NTIGljb24gYXNzb2NpYXRlZCB3aXRoIHRoZSBmb250LWZhY2Ugd2lsbCBiZSB1c2VkXG4gKiB0byByZW5kZXIgdGhlIGljb24uIFJlcXVpcmVzIHRoZSBmb250cyBhbmQgdGhlIG5hbWVkIENTUyBzdHlsZXMgdG8gYmUgcHJlbG9hZGVkLlxuICogQHBhcmFtIHtzdHJpbmd9IG1kLWZvbnQtc2V0IENTUyBzdHlsZSBuYW1lIGFzc29jaWF0ZWQgd2l0aCB0aGUgZm9udCBsaWJyYXJ5OyB3aGljaCB3aWxsIGJlIGFzc2lnbmVkIGFzXG4gKiB0aGUgY2xhc3MgZm9yIHRoZSBmb250LWljb24gbGlnYXR1cmUuIFRoaXMgdmFsdWUgbWF5IGFsc28gYmUgYW4gYWxpYXMgdGhhdCBpcyB1c2VkIHRvIGxvb2t1cCB0aGUgY2xhc3NuYW1lO1xuICogaW50ZXJuYWxseSB1c2UgYCRtZEljb25Qcm92aWRlci5mb250U2V0KDxhbGlhcz4pYCB0byBkZXRlcm1pbmUgdGhlIHN0eWxlIG5hbWUuXG4gKiBAcGFyYW0ge3N0cmluZ30gbWQtc3ZnLXNyYyBVUkwgW29yIGV4cHJlc3Npb24gXSB1c2VkIHRvIGxvYWQsIGNhY2hlLCBhbmQgZGlzcGxheSBhbiBleHRlcm5hbCBTVkcuXG4gKiBAcGFyYW0ge3N0cmluZ30gbWQtc3ZnLWljb24gTmFtZSB1c2VkIGZvciBsb29rdXAgb2YgdGhlIGljb24gZnJvbSB0aGUgaW50ZXJuYWwgY2FjaGU7IGludGVycG9sYXRlZCBzdHJpbmdzIG9yXG4gKiBleHByZXNzaW9ucyBtYXkgYWxzbyBiZSB1c2VkLiBTcGVjaWZpYyBzZXQgbmFtZXMgY2FuIGJlIHVzZWQgd2l0aCB0aGUgc3ludGF4IGA8c2V0IG5hbWU+OjxpY29uIG5hbWU+YC48YnIvPjxici8+XG4gKiBUbyB1c2UgaWNvbiBzZXRzLCBkZXZlbG9wZXJzIGFyZSByZXF1aXJlZCB0byBwcmUtcmVnaXN0ZXIgdGhlIHNldHMgdXNpbmcgdGhlIGAkbWRJY29uUHJvdmlkZXJgIHNlcnZpY2UuXG4gKiBAcGFyYW0ge3N0cmluZz19IGFyaWEtbGFiZWwgTGFiZWxzIGljb24gZm9yIGFjY2Vzc2liaWxpdHkuIElmIGFuIGVtcHR5IHN0cmluZyBpcyBwcm92aWRlZCwgaWNvblxuICogd2lsbCBiZSBoaWRkZW4gZnJvbSBhY2Nlc3NpYmlsaXR5IGxheWVyIHdpdGggYGFyaWEtaGlkZGVuPVwidHJ1ZVwiYC4gSWYgdGhlcmUncyBubyBhcmlhLWxhYmVsIG9uIHRoZSBpY29uXG4gKiBub3IgYSBsYWJlbCBvbiB0aGUgcGFyZW50IGVsZW1lbnQsIGEgd2FybmluZyB3aWxsIGJlIGxvZ2dlZCB0byB0aGUgY29uc29sZS5cbiAqXG4gKiBAdXNhZ2VcbiAqIFdoZW4gdXNpbmcgU1ZHczpcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKlxuICogIDwhLS0gSWNvbiBJRDsgbWF5IGNvbnRhaW4gb3B0aW9uYWwgaWNvbiBzZXQgcHJlZml4OyBpY29ucyBtdXN0IHJlZ2lzdGVyZWQgdXNpbmcgJG1kSWNvblByb3ZpZGVyIC0tPlxuICogIDxtZC1pY29uIG1kLXN2Zy1pY29uPVwic29jaWFsOmFuZHJvaWRcIiAgICBhcmlhLWxhYmVsPVwiYW5kcm9pZCBcIiA+PC9tZC1pY29uPlxuICpcbiAqICA8IS0tIEljb24gdXJsczsgbWF5IGJlIHByZWxvYWRlZCBpbiB0ZW1wbGF0ZUNhY2hlIC0tPlxuICogIDxtZC1pY29uIG1kLXN2Zy1zcmM9XCIvYW5kcm9pZC5zdmdcIiAgICAgICBhcmlhLWxhYmVsPVwiYW5kcm9pZCBcIiA+PC9tZC1pY29uPlxuICogIDxtZC1pY29uIG1kLXN2Zy1zcmM9XCJ7eyBnZXRBbmRyb2lkKCkgfX1cIiBhcmlhLWxhYmVsPVwiYW5kcm9pZCBcIiA+PC9tZC1pY29uPlxuICpcbiAqIDwvaGxqcz5cbiAqXG4gKiBVc2UgdGhlIDxjb2RlPiRtZEljb25Qcm92aWRlcjwvY29kZT4gdG8gY29uZmlndXJlIHlvdXIgYXBwbGljYXRpb24gd2l0aFxuICogc3ZnIGljb25zZXRzLlxuICpcbiAqIDxobGpzIGxhbmc9XCJqc1wiPlxuICogIGFuZ3VsYXIubW9kdWxlKCdhcHBTdmdJY29uU2V0cycsIFsnbmdNYXRlcmlhbCddKVxuICogICAgLmNvbnRyb2xsZXIoJ0RlbW9DdHJsJywgZnVuY3Rpb24oJHNjb3BlKSB7fSlcbiAqICAgIC5jb25maWcoZnVuY3Rpb24oJG1kSWNvblByb3ZpZGVyKSB7XG4gKiAgICAgICRtZEljb25Qcm92aWRlclxuICogICAgICAgICAuaWNvblNldCgnc29jaWFsJywgJ2ltZy9pY29ucy9zZXRzL3NvY2lhbC1pY29ucy5zdmcnLCAyNClcbiAqICAgICAgICAgLmRlZmF1bHRJY29uU2V0KCdpbWcvaWNvbnMvc2V0cy9jb3JlLWljb25zLnN2ZycsIDI0KTtcbiAqICAgICB9KTtcbiAqIDwvaGxqcz5cbiAqXG4gKlxuICogV2hlbiB1c2luZyBGb250IEljb25zIHdpdGggY2xhc3NuYW1lczpcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKlxuICogIDxtZC1pY29uIG1kLWZvbnQtaWNvbj1cImFuZHJvaWRcIiBhcmlhLWxhYmVsPVwiYW5kcm9pZFwiID48L21kLWljb24+XG4gKiAgPG1kLWljb24gY2xhc3M9XCJpY29uX2hvbWVcIiAgICAgIGFyaWEtbGFiZWw9XCJIb21lXCIgICAgPjwvbWQtaWNvbj5cbiAqXG4gKiA8L2hsanM+XG4gKlxuICogV2hlbiB1c2luZyBNYXRlcmlhbCBGb250IEljb25zIHdpdGggbGlnYXR1cmVzOlxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cbiAqICA8IS0tIEZvciBNYXRlcmlhbCBEZXNpZ24gSWNvbnMgLS0+XG4gKiAgPCEtLSBUaGUgY2xhc3MgJy5tYXRlcmlhbC1pY29ucycgaXMgYXV0by1hZGRlZCBpZiBhIHN0eWxlIGhhcyBOT1QgYmVlbiBzcGVjaWZpZWQgLS0+XG4gKiAgPG1kLWljb24+IGZhY2UgPC9tZC1pY29uPlxuICogIDxtZC1pY29uIG1kLWZvbnQtc2V0PVwibWF0ZXJpYWwtaWNvbnNcIj4gZmFjZSA8L21kLWljb24+XG4gKiAgPG1kLWljb24+ICN4RTg3QzsgPC9tZC1pY29uPlxuICogIDwhLS0gVGhlIGNsYXNzICcubWF0ZXJpYWwtaWNvbnMnIG11c3QgYmUgbWFudWFsbHkgYWRkZWQgaWYgb3RoZXIgc3R5bGVzIGFyZSBhbHNvIHNwZWNpZmllZC0tPlxuICogIDxtZC1pY29uIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnMgbWQtbGlnaHQgbWQtNDhcIj4gZmFjZSA8L21kLWljb24+XG4gKiA8L2hsanM+XG4gKlxuICogV2hlbiB1c2luZyBvdGhlciBGb250LUljb24gbGlicmFyaWVzOlxuICpcbiAqIDxobGpzIGxhbmc9XCJqc1wiPlxuICogIC8vIFNwZWNpZnkgYSBmb250LWljb24gc3R5bGUgYWxpYXNcbiAqICBhbmd1bGFyLmNvbmZpZyhmdW5jdGlvbigkbWRJY29uUHJvdmlkZXIpIHtcbiAqICAgICRtZEljb25Qcm92aWRlci5mb250U2V0KCdmYScsICdmb250YXdlc29tZScpO1xuICogIH0pO1xuICogPC9obGpzPlxuICpcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiAgPG1kLWljb24gbWQtZm9udC1zZXQ9XCJmYVwiPmVtYWlsPC9tZC1pY29uPlxuICogPC9obGpzPlxuICpcbiAqL1xuZnVuY3Rpb24gbWRJY29uRGlyZWN0aXZlKCRtZEljb24sICRtZFRoZW1pbmcsICRtZEFyaWEsICRpbnRlcnBvbGF0ZSApIHtcblxuICByZXR1cm4ge1xuICAgIHNjb3BlOiB7XG4gICAgICBmb250U2V0IDogJ0BtZEZvbnRTZXQnLFxuICAgICAgZm9udEljb246ICdAbWRGb250SWNvbicsXG4gICAgICBzdmdJY29uIDogJ0BtZFN2Z0ljb24nLFxuICAgICAgc3ZnU3JjICA6ICdAbWRTdmdTcmMnXG4gICAgfSxcbiAgICByZXN0cmljdDogJ0UnLFxuICAgIGxpbmsgOiBwb3N0TGlua1xuICB9O1xuXG5cbiAgLyoqXG4gICAqIERpcmVjdGl2ZSBwb3N0TGlua1xuICAgKiBTdXBwb3J0cyBlbWJlZGRlZCBTVkdzLCBmb250LWljb25zLCAmIGV4dGVybmFsIFNWR3NcbiAgICovXG4gIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XG4gICAgJG1kVGhlbWluZyhlbGVtZW50KTtcblxuICAgIHByZXBhcmVGb3JGb250SWNvbigpO1xuXG4gICAgLy8gSWYgdXNpbmcgYSBmb250LWljb24sIHRoZW4gdGhlIHRleHR1YWwgbmFtZSBvZiB0aGUgaWNvbiBpdHNlbGZcbiAgICAvLyBwcm92aWRlcyB0aGUgYXJpYS1sYWJlbC5cblxuICAgIHZhciBsYWJlbCA9IGF0dHIuYWx0IHx8IHNjb3BlLmZvbnRJY29uIHx8IHNjb3BlLnN2Z0ljb24gfHwgZWxlbWVudC50ZXh0KCk7XG4gICAgdmFyIGF0dHJOYW1lID0gYXR0ci4kbm9ybWFsaXplKGF0dHIuJGF0dHIubWRTdmdJY29uIHx8IGF0dHIuJGF0dHIubWRTdmdTcmMgfHwgJycpO1xuXG4gICAgaWYgKCAhYXR0clsnYXJpYS1sYWJlbCddICkge1xuXG4gICAgICBpZiAobGFiZWwgIT0gJycgJiYgIXBhcmVudHNIYXZlVGV4dCgpICkge1xuXG4gICAgICAgICRtZEFyaWEuZXhwZWN0KGVsZW1lbnQsICdhcmlhLWxhYmVsJywgbGFiZWwpO1xuICAgICAgICAkbWRBcmlhLmV4cGVjdChlbGVtZW50LCAncm9sZScsICdpbWcnKTtcblxuICAgICAgfSBlbHNlIGlmICggIWVsZW1lbnQudGV4dCgpICkge1xuICAgICAgICAvLyBJZiBub3QgYSBmb250LWljb24gd2l0aCBsaWdhdHVyZSwgdGhlblxuICAgICAgICAvLyBoaWRlIGZyb20gdGhlIGFjY2Vzc2liaWxpdHkgbGF5ZXIuXG5cbiAgICAgICAgJG1kQXJpYS5leHBlY3QoZWxlbWVudCwgJ2FyaWEtaGlkZGVuJywgJ3RydWUnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoYXR0ck5hbWUpIHtcbiAgICAgIC8vIFVzZSBlaXRoZXIgcHJlLWNvbmZpZ3VyZWQgU1ZHIG9yIFVSTCBzb3VyY2UsIHJlc3BlY3RpdmVseS5cbiAgICAgIGF0dHIuJG9ic2VydmUoYXR0ck5hbWUsIGZ1bmN0aW9uKGF0dHJWYWwpIHtcblxuICAgICAgICBlbGVtZW50LmVtcHR5KCk7XG4gICAgICAgIGlmIChhdHRyVmFsKSB7XG4gICAgICAgICAgJG1kSWNvbihhdHRyVmFsKS50aGVuKGZ1bmN0aW9uKHN2Zykge1xuICAgICAgICAgICAgZWxlbWVudC5hcHBlbmQoc3ZnKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXJlbnRzSGF2ZVRleHQoKSB7XG4gICAgICB2YXIgcGFyZW50ID0gZWxlbWVudC5wYXJlbnQoKTtcbiAgICAgIGlmIChwYXJlbnQuYXR0cignYXJpYS1sYWJlbCcpIHx8IHBhcmVudC50ZXh0KCkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICBlbHNlIGlmKHBhcmVudC5wYXJlbnQoKS5hdHRyKCdhcmlhLWxhYmVsJykgfHwgcGFyZW50LnBhcmVudCgpLnRleHQoKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwcmVwYXJlRm9yRm9udEljb24gKCkge1xuICAgICAgaWYgKCFzY29wZS5zdmdJY29uICYmICFzY29wZS5zdmdTcmMpIHtcblxuICAgICAgICBpZiAoc2NvcGUuZm9udEljb24pIHtcbiAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdtZC1mb250Jyk7XG4gICAgICAgICAgZWxlbWVudC5hZGRDbGFzcyhzY29wZS5mb250SWNvbik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc2NvcGUuZm9udFNldCkge1xuICAgICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJG1kSWNvbi5mb250U2V0KHNjb3BlLmZvbnRTZXQpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZvciBNYXRlcmlhbCBEZXNpZ24gZm9udCBpY29ucywgdGhlIGNsYXNzICcubWF0ZXJpYWwtaWNvbnMnXG4gICAgICAgIC8vIGlzIGF1dG8tYWRkZWQgSUYgYSBzdHlsZSBoYXMgbm90IGJlZW4gc3BlY2lmaWVkXG5cbiAgICAgICAgaWYgKCFzY29wZS5mb250SWNvbiAmJiAhc2NvcGUuZm9udFNldCAmJiAhYW5ndWxhci5pc0RlZmluZWQoYXR0ci5jbGFzcykpIHtcblxuICAgICAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnbWF0ZXJpYWwtaWNvbnMnKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgfVxuICB9XG59XG5tZEljb25EaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZEljb25cIiwgXCIkbWRUaGVtaW5nXCIsIFwiJG1kQXJpYVwiLCBcIiRpbnRlcnBvbGF0ZVwiXTtcblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuaWNvbicgKVxuICAgIC5wcm92aWRlcignJG1kSWNvbicsIE1kSWNvblByb3ZpZGVyKTtcblxuICAvKipcbiAgICAqIEBuZ2RvYyBzZXJ2aWNlXG4gICAgKiBAbmFtZSAkbWRJY29uUHJvdmlkZXJcbiAgICAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5pY29uXG4gICAgKlxuICAgICogQGRlc2NyaXB0aW9uXG4gICAgKiBgJG1kSWNvblByb3ZpZGVyYCBpcyB1c2VkIG9ubHkgdG8gcmVnaXN0ZXIgaWNvbiBJRHMgd2l0aCBVUkxzLiBUaGVzZSBjb25maWd1cmF0aW9uIGZlYXR1cmVzIGFsbG93XG4gICAgKiBpY29ucyBhbmQgaWNvbiBzZXRzIHRvIGJlIHByZS1yZWdpc3RlcmVkIGFuZCBhc3NvY2lhdGVkIHdpdGggc291cmNlIFVSTHMgKipiZWZvcmUqKiB0aGUgYDxtZC1pY29uIC8+YFxuICAgICogZGlyZWN0aXZlcyBhcmUgY29tcGlsZWQuXG4gICAgKlxuICAgICogSWYgdXNpbmcgZm9udC1pY29ucywgdGhlIGRldmVsb3BlciBpcyByZXBzb25zaWJsZSBmb3IgbG9hZGluZyB0aGUgZm9udHMuXG4gICAgKlxuICAgICogSWYgdXNpbmcgU1ZHcywgbG9hZGluZyBvZiB0aGUgYWN0dWFsIHN2ZyBmaWxlcyBhcmUgZGVmZXJyZWQgdG8gb24tZGVtYW5kIHJlcXVlc3RzIGFuZCBhcmUgbG9hZGVkXG4gICAgKiBpbnRlcm5hbGx5IGJ5IHRoZSBgJG1kSWNvbmAgc2VydmljZSB1c2luZyB0aGUgYCRodHRwYCBzZXJ2aWNlLiBXaGVuIGFuIFNWRyBpcyByZXF1ZXN0ZWQgYnkgbmFtZS9JRCxcbiAgICAqIHRoZSBgJG1kSWNvbmAgc2VydmljZSBzZWFyY2hlcyBpdHMgcmVnaXN0cnkgZm9yIHRoZSBhc3NvY2lhdGVkIHNvdXJjZSBVUkw7XG4gICAgKiB0aGF0IFVSTCBpcyB1c2VkIHRvIG9uLWRlbWFuZCBsb2FkIGFuZCBwYXJzZSB0aGUgU1ZHIGR5bmFtaWNhbGx5LlxuICAgICpcbiAgICAqIEB1c2FnZVxuICAgICogPGhsanMgbGFuZz1cImpzXCI+XG4gICAgKiAgIGFwcC5jb25maWcoZnVuY3Rpb24oJG1kSWNvblByb3ZpZGVyKSB7XG4gICAgKlxuICAgICogICAgIC8vIENvbmZpZ3VyZSBVUkxzIGZvciBpY29ucyBzcGVjaWZpZWQgYnkgW3NldDpdaWQuXG4gICAgKlxuICAgICogICAgICRtZEljb25Qcm92aWRlclxuICAgICogICAgICAgICAgLmRlZmF1bHRGb250U2V0KCAnZm9udGF3ZXNvbWUnIClcbiAgICAqICAgICAgICAgIC5kZWZhdWx0SWNvblNldCgnbXkvYXBwL2ljb25zLnN2ZycpICAgICAgIC8vIFJlZ2lzdGVyIGEgZGVmYXVsdCBzZXQgb2YgU1ZHIGljb25zXG4gICAgKiAgICAgICAgICAuaWNvblNldCgnc29jaWFsJywgJ215L2FwcC9zb2NpYWwuc3ZnJykgICAvLyBSZWdpc3RlciBhIG5hbWVkIGljb24gc2V0IG9mIFNWR3NcbiAgICAqICAgICAgICAgIC5pY29uKCdhbmRyb2lkJywgJ215L2FwcC9hbmRyb2lkLnN2ZycpICAgIC8vIFJlZ2lzdGVyIGEgc3BlY2lmaWMgaWNvbiAoYnkgbmFtZSlcbiAgICAqICAgICAgICAgIC5pY29uKCd3b3JrOmNoYWlyJywgJ215L2FwcC9jaGFpci5zdmcnKTsgIC8vIFJlZ2lzdGVyIGljb24gaW4gYSBzcGVjaWZpYyBzZXRcbiAgICAqICAgfSk7XG4gICAgKiA8L2hsanM+XG4gICAgKlxuICAgICogU1ZHIGljb25zIGFuZCBpY29uIHNldHMgY2FuIGJlIGVhc2lseSBwcmUtbG9hZGVkIGFuZCBjYWNoZWQgdXNpbmcgZWl0aGVyIChhKSBhIGJ1aWxkIHByb2Nlc3Mgb3IgKGIpIGEgcnVudGltZVxuICAgICogKipzdGFydHVwKiogcHJvY2VzcyAoc2hvd24gYmVsb3cpOlxuICAgICpcbiAgICAqIDxobGpzIGxhbmc9XCJqc1wiPlxuICAgICogICBhcHAuY29uZmlnKGZ1bmN0aW9uKCRtZEljb25Qcm92aWRlcikge1xuICAgICpcbiAgICAqICAgICAvLyBSZWdpc3RlciBhIGRlZmF1bHQgc2V0IG9mIFNWRyBpY29uIGRlZmluaXRpb25zXG4gICAgKiAgICAgJG1kSWNvblByb3ZpZGVyLmRlZmF1bHRJY29uU2V0KCdteS9hcHAvaWNvbnMuc3ZnJylcbiAgICAqXG4gICAgKiAgIH0pXG4gICAgKiAgIC5ydW4oZnVuY3Rpb24oJGh0dHAsICR0ZW1wbGF0ZUNhY2hlKXtcbiAgICAqXG4gICAgKiAgICAgLy8gUHJlLWZldGNoIGljb25zIHNvdXJjZXMgYnkgVVJMIGFuZCBjYWNoZSBpbiB0aGUgJHRlbXBsYXRlQ2FjaGUuLi5cbiAgICAqICAgICAvLyBzdWJzZXF1ZW50ICRodHRwIGNhbGxzIHdpbGwgbG9vayB0aGVyZSBmaXJzdC5cbiAgICAqXG4gICAgKiAgICAgdmFyIHVybHMgPSBbICdpbXkvYXBwL2ljb25zLnN2ZycsICdpbWcvaWNvbnMvYW5kcm9pZC5zdmcnXTtcbiAgICAqXG4gICAgKiAgICAgYW5ndWxhci5mb3JFYWNoKHVybHMsIGZ1bmN0aW9uKHVybCkge1xuICAgICogICAgICAgJGh0dHAuZ2V0KHVybCwge2NhY2hlOiAkdGVtcGxhdGVDYWNoZX0pO1xuICAgICogICAgIH0pO1xuICAgICpcbiAgICAqICAgfSk7XG4gICAgKlxuICAgICogPC9obGpzPlxuICAgICpcbiAgICAqIE5PVEU6IHRoZSBsb2FkZWQgU1ZHIGRhdGEgaXMgc3Vic2VxdWVudGx5IGNhY2hlZCBpbnRlcm5hbGx5IGZvciBmdXR1cmUgcmVxdWVzdHMuXG4gICAgKlxuICAgICovXG5cbiAgIC8qKlxuICAgICogQG5nZG9jIG1ldGhvZFxuICAgICogQG5hbWUgJG1kSWNvblByb3ZpZGVyI2ljb25cbiAgICAqXG4gICAgKiBAZGVzY3JpcHRpb25cbiAgICAqIFJlZ2lzdGVyIGEgc291cmNlIFVSTCBmb3IgYSBzcGVjaWZpYyBpY29uIG5hbWU7IHRoZSBuYW1lIG1heSBpbmNsdWRlIG9wdGlvbmFsICdpY29uIHNldCcgbmFtZSBwcmVmaXguXG4gICAgKiBUaGVzZSBpY29ucyAgd2lsbCBsYXRlciBiZSByZXRyaWV2ZWQgZnJvbSB0aGUgY2FjaGUgdXNpbmcgYCRtZEljb24oIDxpY29uIG5hbWU+IClgXG4gICAgKlxuICAgICogQHBhcmFtIHtzdHJpbmd9IGlkIEljb24gbmFtZS9pZCB1c2VkIHRvIHJlZ2lzdGVyIHRoZSBpY29uXG4gICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIHNwZWNpZmllcyB0aGUgZXh0ZXJuYWwgbG9jYXRpb24gZm9yIHRoZSBkYXRhIGZpbGUuIFVzZWQgaW50ZXJuYWxseSBieSBgJGh0dHBgIHRvIGxvYWQgdGhlXG4gICAgKiBkYXRhIG9yIGFzIHBhcnQgb2YgdGhlIGxvb2t1cCBpbiBgJHRlbXBsYXRlQ2FjaGVgIGlmIHByZS1sb2FkaW5nIHdhcyBjb25maWd1cmVkLlxuICAgICogQHBhcmFtIHtudW1iZXI9fSB2aWV3Qm94U2l6ZSBTZXRzIHRoZSB3aWR0aCBhbmQgaGVpZ2h0IHRoZSBpY29uJ3Mgdmlld0JveC5cbiAgICAqIEl0IGlzIGlnbm9yZWQgZm9yIGljb25zIHdpdGggYW4gZXhpc3Rpbmcgdmlld0JveC4gRGVmYXVsdCBzaXplIGlzIDI0LlxuICAgICpcbiAgICAqIEByZXR1cm5zIHtvYmp9IGFuIGAkbWRJY29uUHJvdmlkZXJgIHJlZmVyZW5jZTsgdXNlZCB0byBzdXBwb3J0IG1ldGhvZCBjYWxsIGNoYWlucyBmb3IgdGhlIEFQSVxuICAgICpcbiAgICAqIEB1c2FnZVxuICAgICogPGhsanMgbGFuZz1cImpzXCI+XG4gICAgKiAgIGFwcC5jb25maWcoZnVuY3Rpb24oJG1kSWNvblByb3ZpZGVyKSB7XG4gICAgKlxuICAgICogICAgIC8vIENvbmZpZ3VyZSBVUkxzIGZvciBpY29ucyBzcGVjaWZpZWQgYnkgW3NldDpdaWQuXG4gICAgKlxuICAgICogICAgICRtZEljb25Qcm92aWRlclxuICAgICogICAgICAgICAgLmljb24oJ2FuZHJvaWQnLCAnbXkvYXBwL2FuZHJvaWQuc3ZnJykgICAgLy8gUmVnaXN0ZXIgYSBzcGVjaWZpYyBpY29uIChieSBuYW1lKVxuICAgICogICAgICAgICAgLmljb24oJ3dvcms6Y2hhaXInLCAnbXkvYXBwL2NoYWlyLnN2ZycpOyAgLy8gUmVnaXN0ZXIgaWNvbiBpbiBhIHNwZWNpZmljIHNldFxuICAgICogICB9KTtcbiAgICAqIDwvaGxqcz5cbiAgICAqXG4gICAgKi9cbiAgIC8qKlxuICAgICogQG5nZG9jIG1ldGhvZFxuICAgICogQG5hbWUgJG1kSWNvblByb3ZpZGVyI2ljb25TZXRcbiAgICAqXG4gICAgKiBAZGVzY3JpcHRpb25cbiAgICAqIFJlZ2lzdGVyIGEgc291cmNlIFVSTCBmb3IgYSAnbmFtZWQnIHNldCBvZiBpY29uczsgZ3JvdXAgb2YgU1ZHIGRlZmluaXRpb25zIHdoZXJlIGVhY2ggZGVmaW5pdGlvblxuICAgICogaGFzIGFuIGljb24gaWQuIEluZGl2aWR1YWwgaWNvbnMgY2FuIGJlIHN1YnNlcXVlbnRseSByZXRyaWV2ZWQgZnJvbSB0aGlzIGNhY2hlZCBzZXQgdXNpbmdcbiAgICAqIGAkbWRJY29uKDxpY29uIHNldCBuYW1lPjo8aWNvbiBuYW1lPilgXG4gICAgKlxuICAgICogQHBhcmFtIHtzdHJpbmd9IGlkIEljb24gbmFtZS9pZCB1c2VkIHRvIHJlZ2lzdGVyIHRoZSBpY29uc2V0XG4gICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIHNwZWNpZmllcyB0aGUgZXh0ZXJuYWwgbG9jYXRpb24gZm9yIHRoZSBkYXRhIGZpbGUuIFVzZWQgaW50ZXJuYWxseSBieSBgJGh0dHBgIHRvIGxvYWQgdGhlXG4gICAgKiBkYXRhIG9yIGFzIHBhcnQgb2YgdGhlIGxvb2t1cCBpbiBgJHRlbXBsYXRlQ2FjaGVgIGlmIHByZS1sb2FkaW5nIHdhcyBjb25maWd1cmVkLlxuICAgICogQHBhcmFtIHtudW1iZXI9fSB2aWV3Qm94U2l6ZSBTZXRzIHRoZSB3aWR0aCBhbmQgaGVpZ2h0IG9mIHRoZSB2aWV3Qm94IG9mIGFsbCBpY29ucyBpbiB0aGUgc2V0LiBcbiAgICAqIEl0IGlzIGlnbm9yZWQgZm9yIGljb25zIHdpdGggYW4gZXhpc3Rpbmcgdmlld0JveC4gQWxsIGljb25zIGluIHRoZSBpY29uIHNldCBzaG91bGQgYmUgdGhlIHNhbWUgc2l6ZS5cbiAgICAqIERlZmF1bHQgdmFsdWUgaXMgMjQuXG4gICAgKlxuICAgICogQHJldHVybnMge29ian0gYW4gYCRtZEljb25Qcm92aWRlcmAgcmVmZXJlbmNlOyB1c2VkIHRvIHN1cHBvcnQgbWV0aG9kIGNhbGwgY2hhaW5zIGZvciB0aGUgQVBJXG4gICAgKlxuICAgICpcbiAgICAqIEB1c2FnZVxuICAgICogPGhsanMgbGFuZz1cImpzXCI+XG4gICAgKiAgIGFwcC5jb25maWcoZnVuY3Rpb24oJG1kSWNvblByb3ZpZGVyKSB7XG4gICAgKlxuICAgICogICAgIC8vIENvbmZpZ3VyZSBVUkxzIGZvciBpY29ucyBzcGVjaWZpZWQgYnkgW3NldDpdaWQuXG4gICAgKlxuICAgICogICAgICRtZEljb25Qcm92aWRlclxuICAgICogICAgICAgICAgLmljb25TZXQoJ3NvY2lhbCcsICdteS9hcHAvc29jaWFsLnN2ZycpICAgLy8gUmVnaXN0ZXIgYSBuYW1lZCBpY29uIHNldFxuICAgICogICB9KTtcbiAgICAqIDwvaGxqcz5cbiAgICAqXG4gICAgKi9cbiAgIC8qKlxuICAgICogQG5nZG9jIG1ldGhvZFxuICAgICogQG5hbWUgJG1kSWNvblByb3ZpZGVyI2RlZmF1bHRJY29uU2V0XG4gICAgKlxuICAgICogQGRlc2NyaXB0aW9uXG4gICAgKiBSZWdpc3RlciBhIHNvdXJjZSBVUkwgZm9yIHRoZSBkZWZhdWx0ICduYW1lZCcgc2V0IG9mIGljb25zLiBVbmxlc3MgZXhwbGljaXRseSByZWdpc3RlcmVkLFxuICAgICogc3Vic2VxdWVudCBsb29rdXBzIG9mIGljb25zIHdpbGwgZmFpbG92ZXIgdG8gc2VhcmNoIHRoaXMgJ2RlZmF1bHQnIGljb24gc2V0LlxuICAgICogSWNvbiBjYW4gYmUgcmV0cmlldmVkIGZyb20gdGhpcyBjYWNoZWQsIGRlZmF1bHQgc2V0IHVzaW5nIGAkbWRJY29uKDxuYW1lPilgXG4gICAgKlxuICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCBzcGVjaWZpZXMgdGhlIGV4dGVybmFsIGxvY2F0aW9uIGZvciB0aGUgZGF0YSBmaWxlLiBVc2VkIGludGVybmFsbHkgYnkgYCRodHRwYCB0byBsb2FkIHRoZVxuICAgICogZGF0YSBvciBhcyBwYXJ0IG9mIHRoZSBsb29rdXAgaW4gYCR0ZW1wbGF0ZUNhY2hlYCBpZiBwcmUtbG9hZGluZyB3YXMgY29uZmlndXJlZC5cbiAgICAqIEBwYXJhbSB7bnVtYmVyPX0gdmlld0JveFNpemUgU2V0cyB0aGUgd2lkdGggYW5kIGhlaWdodCBvZiB0aGUgdmlld0JveCBvZiBhbGwgaWNvbnMgaW4gdGhlIHNldC4gXG4gICAgKiBJdCBpcyBpZ25vcmVkIGZvciBpY29ucyB3aXRoIGFuIGV4aXN0aW5nIHZpZXdCb3guIEFsbCBpY29ucyBpbiB0aGUgaWNvbiBzZXQgc2hvdWxkIGJlIHRoZSBzYW1lIHNpemUuXG4gICAgKiBEZWZhdWx0IHZhbHVlIGlzIDI0LlxuICAgICpcbiAgICAqIEByZXR1cm5zIHtvYmp9IGFuIGAkbWRJY29uUHJvdmlkZXJgIHJlZmVyZW5jZTsgdXNlZCB0byBzdXBwb3J0IG1ldGhvZCBjYWxsIGNoYWlucyBmb3IgdGhlIEFQSVxuICAgICpcbiAgICAqIEB1c2FnZVxuICAgICogPGhsanMgbGFuZz1cImpzXCI+XG4gICAgKiAgIGFwcC5jb25maWcoZnVuY3Rpb24oJG1kSWNvblByb3ZpZGVyKSB7XG4gICAgKlxuICAgICogICAgIC8vIENvbmZpZ3VyZSBVUkxzIGZvciBpY29ucyBzcGVjaWZpZWQgYnkgW3NldDpdaWQuXG4gICAgKlxuICAgICogICAgICRtZEljb25Qcm92aWRlclxuICAgICogICAgICAgICAgLmRlZmF1bHRJY29uU2V0KCAnbXkvYXBwL3NvY2lhbC5zdmcnICkgICAvLyBSZWdpc3RlciBhIGRlZmF1bHQgaWNvbiBzZXRcbiAgICAqICAgfSk7XG4gICAgKiA8L2hsanM+XG4gICAgKlxuICAgICovXG4gIC8qKlxuICAgKiBAbmdkb2MgbWV0aG9kXG4gICAqIEBuYW1lICRtZEljb25Qcm92aWRlciNkZWZhdWx0Rm9udFNldFxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogV2hlbiB1c2luZyBGb250LUljb25zLCBBbmd1bGFyIE1hdGVyaWFsIGFzc3VtZXMgdGhlIHRoZSBNYXRlcmlhbCBEZXNpZ24gaWNvbnMgd2lsbCBiZSB1c2VkIGFuZCBhdXRvbWF0aWNhbGx5XG4gICAqIGNvbmZpZ3VyZXMgdGhlIGRlZmF1bHQgZm9udC1zZXQgPT0gJ21hdGVyaWFsLWljb25zJy4gTm90ZSB0aGF0IHRoZSBmb250LXNldCByZWZlcmVuY2VzIHRoZSBmb250LWljb24gbGlicmFyeVxuICAgKiBjbGFzcyBzdHlsZSB0aGF0IHNob3VsZCBiZSBhcHBsaWVkIHRvIHRoZSBgPG1kLWljb24+YC5cbiAgICpcbiAgICogQ29uZmlndXJpbmcgdGhlIGRlZmF1bHQgbWVhbnMgdGhhdCB0aGUgYXR0cmlidXRlc1xuICAgKiBgbWQtZm9udC1zZXQ9XCJtYXRlcmlhbC1pY29uc1wiYCBvciBgY2xhc3M9XCJtYXRlcmlhbC1pY29uc1wiYCBkbyBub3QgbmVlZCB0byBiZSBleHBsaWNpdGx5IGRlY2xhcmVkIG9uIHRoZVxuICAgKiBgPG1kLWljb24+YCBtYXJrdXAuIEZvciBleGFtcGxlOlxuICAgKlxuICAgKiAgYDxtZC1pY29uPiBmYWNlIDwvbWQtaWNvbj5gXG4gICAqICB3aWxsIHJlbmRlciBhc1xuICAgKiAgYDxzcGFuIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnNcIj4gZmFjZSA8L3NwYW4+YCwgYW5kXG4gICAqXG4gICAqICBgPG1kLWljb24gbWQtZm9udC1zZXQ9XCJmYVwiPiBmYWNlIDwvbWQtaWNvbj5gXG4gICAqICB3aWxsIHJlbmRlciBhc1xuICAgKiAgYDxzcGFuIGNsYXNzPVwiZmFcIj4gZmFjZSA8L3NwYW4+YFxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBvZiB0aGUgZm9udC1saWJyYXJ5IHN0eWxlIHRoYXQgc2hvdWxkIGJlIGFwcGxpZWQgdG8gdGhlIG1kLWljb24gRE9NIGVsZW1lbnRcbiAgICpcbiAgICogQHVzYWdlXG4gICAqIDxobGpzIGxhbmc9XCJqc1wiPlxuICAgKiAgIGFwcC5jb25maWcoZnVuY3Rpb24oJG1kSWNvblByb3ZpZGVyKSB7XG4gICAqICAgICAkbWRJY29uUHJvdmlkZXIuZGVmYXVsdEZvbnRTZXQoICdmb250YXdlc29tZScgKTtcbiAgICogICB9KTtcbiAgICogPC9obGpzPlxuICAgKlxuICAgKi9cblxuICAgLyoqXG4gICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgKiBAbmFtZSAkbWRJY29uUHJvdmlkZXIjZGVmYXVsdFZpZXdCb3hTaXplXG4gICAgKlxuICAgICogQGRlc2NyaXB0aW9uXG4gICAgKiBXaGlsZSBgPG1kLWljb24gLz5gIG1hcmt1cCBjYW4gYWxzbyBiZSBzdHlsZSB3aXRoIHNpemluZyBDU1MsIHRoaXMgbWV0aG9kIGNvbmZpZ3VyZXNcbiAgICAqIHRoZSBkZWZhdWx0IHdpZHRoICoqYW5kKiogaGVpZ2h0IHVzZWQgZm9yIGFsbCBpY29uczsgdW5sZXNzIG92ZXJyaWRkZW4gYnkgc3BlY2lmaWMgQ1NTLlxuICAgICogVGhlIGRlZmF1bHQgc2l6aW5nIGlzICgyNHB4LCAyNHB4KS5cbiAgICAqIEBwYXJhbSB7bnVtYmVyPX0gdmlld0JveFNpemUgU2V0cyB0aGUgd2lkdGggYW5kIGhlaWdodCBvZiB0aGUgdmlld0JveCBmb3IgYW4gaWNvbiBvciBhbiBpY29uIHNldC5cbiAgICAqIEFsbCBpY29ucyBpbiBhIHNldCBzaG91bGQgYmUgdGhlIHNhbWUgc2l6ZS4gVGhlIGRlZmF1bHQgdmFsdWUgaXMgMjQuXG4gICAgKlxuICAgICogQHJldHVybnMge29ian0gYW4gYCRtZEljb25Qcm92aWRlcmAgcmVmZXJlbmNlOyB1c2VkIHRvIHN1cHBvcnQgbWV0aG9kIGNhbGwgY2hhaW5zIGZvciB0aGUgQVBJXG4gICAgKlxuICAgICogQHVzYWdlXG4gICAgKiA8aGxqcyBsYW5nPVwianNcIj5cbiAgICAqICAgYXBwLmNvbmZpZyhmdW5jdGlvbigkbWRJY29uUHJvdmlkZXIpIHtcbiAgICAqXG4gICAgKiAgICAgLy8gQ29uZmlndXJlIFVSTHMgZm9yIGljb25zIHNwZWNpZmllZCBieSBbc2V0Ol1pZC5cbiAgICAqXG4gICAgKiAgICAgJG1kSWNvblByb3ZpZGVyXG4gICAgKiAgICAgICAgICAuZGVmYXVsdFZpZXdCb3hTaXplKDM2KSAgIC8vIFJlZ2lzdGVyIGEgZGVmYXVsdCBpY29uIHNpemUgKHdpZHRoID09IGhlaWdodClcbiAgICAqICAgfSk7XG4gICAgKiA8L2hsanM+XG4gICAgKlxuICAgICovXG5cbiB2YXIgY29uZmlnID0ge1xuICAgZGVmYXVsdFZpZXdCb3hTaXplOiAyNCxcbiAgIGRlZmF1bHRGb250U2V0OiAnbWF0ZXJpYWwtaWNvbnMnLFxuICAgZm9udFNldHMgOiBbIF1cbiB9O1xuXG4gZnVuY3Rpb24gTWRJY29uUHJvdmlkZXIoKSB7IH1cblxuIE1kSWNvblByb3ZpZGVyLnByb3RvdHlwZSA9IHtcbiAgIGljb24gOiBmdW5jdGlvbiAoaWQsIHVybCwgdmlld0JveFNpemUpIHtcbiAgICAgaWYgKCBpZC5pbmRleE9mKCc6JykgPT0gLTEgKSBpZCA9ICckZGVmYXVsdDonICsgaWQ7XG5cbiAgICAgY29uZmlnW2lkXSA9IG5ldyBDb25maWd1cmF0aW9uSXRlbSh1cmwsIHZpZXdCb3hTaXplICk7XG4gICAgIHJldHVybiB0aGlzO1xuICAgfSxcblxuICAgaWNvblNldCA6IGZ1bmN0aW9uIChpZCwgdXJsLCB2aWV3Qm94U2l6ZSkge1xuICAgICBjb25maWdbaWRdID0gbmV3IENvbmZpZ3VyYXRpb25JdGVtKHVybCwgdmlld0JveFNpemUgKTtcbiAgICAgcmV0dXJuIHRoaXM7XG4gICB9LFxuXG4gICBkZWZhdWx0SWNvblNldCA6IGZ1bmN0aW9uICh1cmwsIHZpZXdCb3hTaXplKSB7XG4gICAgIHZhciBzZXROYW1lID0gJyRkZWZhdWx0JztcblxuICAgICBpZiAoICFjb25maWdbc2V0TmFtZV0gKSB7XG4gICAgICAgY29uZmlnW3NldE5hbWVdID0gbmV3IENvbmZpZ3VyYXRpb25JdGVtKHVybCwgdmlld0JveFNpemUgKTtcbiAgICAgfVxuXG4gICAgIGNvbmZpZ1tzZXROYW1lXS52aWV3Qm94U2l6ZSA9IHZpZXdCb3hTaXplIHx8IGNvbmZpZy5kZWZhdWx0Vmlld0JveFNpemU7XG5cbiAgICAgcmV0dXJuIHRoaXM7XG4gICB9LFxuXG4gICBkZWZhdWx0Vmlld0JveFNpemUgOiBmdW5jdGlvbiAodmlld0JveFNpemUpIHtcbiAgICAgY29uZmlnLmRlZmF1bHRWaWV3Qm94U2l6ZSA9IHZpZXdCb3hTaXplO1xuICAgICByZXR1cm4gdGhpcztcbiAgIH0sXG4gICBcbiAgIC8qKlxuICAgICogUmVnaXN0ZXIgYW4gYWxpYXMgbmFtZSBhc3NvY2lhdGVkIHdpdGggYSBmb250LWljb24gbGlicmFyeSBzdHlsZSA7XG4gICAgKi9cbiAgIGZvbnRTZXQgOiBmdW5jdGlvbiBmb250U2V0KGFsaWFzLCBjbGFzc05hbWUpIHtcbiAgICBjb25maWcuZm9udFNldHMucHVzaCh7XG4gICAgICBhbGlhcyA6IGFsaWFzLFxuICAgICAgZm9udFNldCA6IGNsYXNzTmFtZSB8fCBhbGlhc1xuICAgIH0pO1xuICAgfSxcblxuICAgLyoqXG4gICAgKiBTcGVjaWZ5IGEgZGVmYXVsdCBzdHlsZSBuYW1lIGFzc29jaWF0ZWQgd2l0aCBhIGZvbnQtaWNvbiBsaWJyYXJ5XG4gICAgKiBmYWxsYmFjayB0byBNYXRlcmlhbCBJY29ucy5cbiAgICAqXG4gICAgKi9cbiAgIGRlZmF1bHRGb250U2V0IDogZnVuY3Rpb24gZGVmYXVsdEZvbnRTZXQoY2xhc3NOYW1lKSB7XG4gICAgY29uZmlnLmRlZmF1bHRGb250U2V0ID0gIWNsYXNzTmFtZSA/ICcnIDogY2xhc3NOYW1lO1xuICAgIHJldHVybiB0aGlzO1xuICAgfSxcblxuICAgZGVmYXVsdEljb25TaXplIDogZnVuY3Rpb24gZGVmYXVsdEljb25TaXplKGljb25TaXplKSB7XG4gICAgIGNvbmZpZy5kZWZhdWx0SWNvblNpemUgPSBpY29uU2l6ZTtcbiAgICAgcmV0dXJuIHRoaXM7XG4gICB9LFxuXG4gICBwcmVsb2FkSWNvbnM6IGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuICAgICB2YXIgaWNvblByb3ZpZGVyID0gdGhpcztcbiAgICAgdmFyIHN2Z1JlZ2lzdHJ5ID0gW1xuICAgICAgIHtcbiAgICAgICAgIGlkIDogJ21kLXRhYnMtYXJyb3cnLFxuICAgICAgICAgdXJsOiAnbWQtdGFicy1hcnJvdy5zdmcnLFxuICAgICAgICAgc3ZnOiAnPHN2ZyB2ZXJzaW9uPVwiMS4xXCIgeD1cIjBweFwiIHk9XCIwcHhcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCI+PGc+PHBvbHlnb24gcG9pbnRzPVwiMTUuNCw3LjQgMTQsNiA4LDEyIDE0LDE4IDE1LjQsMTYuNiAxMC44LDEyIFwiLz48L2c+PC9zdmc+J1xuICAgICAgIH0sXG4gICAgICAge1xuICAgICAgICAgaWQgOiAnbWQtY2xvc2UnLFxuICAgICAgICAgdXJsOiAnbWQtY2xvc2Uuc3ZnJyxcbiAgICAgICAgIHN2ZzogJzxzdmcgdmVyc2lvbj1cIjEuMVwiIHg9XCIwcHhcIiB5PVwiMHB4XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiPjxnPjxwYXRoIGQ9XCJNMTkgNi40MWwtMS40MS0xLjQxLTUuNTkgNS41OS01LjU5LTUuNTktMS40MSAxLjQxIDUuNTkgNS41OS01LjU5IDUuNTkgMS40MSAxLjQxIDUuNTktNS41OSA1LjU5IDUuNTkgMS40MS0xLjQxLTUuNTktNS41OXpcIi8+PC9nPjwvc3ZnPidcbiAgICAgICB9LFxuICAgICAgIHtcbiAgICAgICAgIGlkOiAgJ21kLWNhbmNlbCcsXG4gICAgICAgICB1cmw6ICdtZC1jYW5jZWwuc3ZnJyxcbiAgICAgICAgIHN2ZzogJzxzdmcgdmVyc2lvbj1cIjEuMVwiIHg9XCIwcHhcIiB5PVwiMHB4XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiPjxnPjxwYXRoIGQ9XCJNMTIgMmMtNS41MyAwLTEwIDQuNDctMTAgMTBzNC40NyAxMCAxMCAxMCAxMC00LjQ3IDEwLTEwLTQuNDctMTAtMTAtMTB6bTUgMTMuNTlsLTEuNDEgMS40MS0zLjU5LTMuNTktMy41OSAzLjU5LTEuNDEtMS40MSAzLjU5LTMuNTktMy41OS0zLjU5IDEuNDEtMS40MSAzLjU5IDMuNTkgMy41OS0zLjU5IDEuNDEgMS40MS0zLjU5IDMuNTkgMy41OSAzLjU5elwiLz48L2c+PC9zdmc+J1xuICAgICAgIH0sXG4gICAgICAge1xuICAgICAgICAgaWQ6ICAnbWQtbWVudScsXG4gICAgICAgICB1cmw6ICdtZC1tZW51LnN2ZycsXG4gICAgICAgICBzdmc6ICc8c3ZnIHZlcnNpb249XCIxLjFcIiB4PVwiMHB4XCIgeT1cIjBweFwiIHZpZXdCb3g9XCIwIDAgMTAwIDEwMFwiPjxwYXRoIGQ9XCJNIDUwIDAgTCAxMDAgMTQgTCA5MiA4MCBMIDUwIDEwMCBMIDggODAgTCAwIDE0IFpcIiBmaWxsPVwiI2IyYjJiMlwiPjwvcGF0aD48cGF0aCBkPVwiTSA1MCA1IEwgNiAxOCBMIDEzLjUgNzcgTCA1MCA5NCBaXCIgZmlsbD1cIiNFNDI5MzlcIj48L3BhdGg+PHBhdGggZD1cIk0gNTAgNSBMIDk0IDE4IEwgODYuNSA3NyBMIDUwIDk0IFpcIiBmaWxsPVwiI0I3MjgzM1wiPjwvcGF0aD48cGF0aCBkPVwiTSA1MCA3IEwgODMgNzUgTCA3MiA3NSBMIDY1IDU5IEwgNTAgNTkgTCA1MCA1MCBMIDYxIDUwIEwgNTAgMjYgWlwiIGZpbGw9XCIjYjJiMmIyXCI+PC9wYXRoPjxwYXRoIGQ9XCJNIDUwIDcgTCAxNyA3NSBMIDI4IDc1IEwgMzUgNTkgTCA1MCA1OSBMIDUwIDUwIEwgMzkgNTAgTCA1MCAyNiBaXCIgZmlsbD1cIiNmZmZcIj48L3BhdGg+PC9zdmc+J1xuICAgICAgIH0sXG4gICAgICAge1xuICAgICAgICAgaWQ6ICAnbWQtdG9nZ2xlLWFycm93JyxcbiAgICAgICAgIHVybDogJ21kLXRvZ2dsZS1hcnJvdy1zdmcnLFxuICAgICAgICAgc3ZnOiAnPHN2ZyB2ZXJzaW9uPVwiMS4xXCIgeD1cIjBweFwiIHk9XCIwcHhcIiB2aWV3Qm94PVwiMCAwIDQ4IDQ4XCI+PHBhdGggZD1cIk0yNCAxNmwtMTIgMTIgMi44MyAyLjgzIDkuMTctOS4xNyA5LjE3IDkuMTcgMi44My0yLjgzelwiLz48cGF0aCBkPVwiTTAgMGg0OHY0OGgtNDh6XCIgZmlsbD1cIm5vbmVcIi8+PC9zdmc+J1xuICAgICAgIH1cbiAgICAgXTtcblxuICAgICBzdmdSZWdpc3RyeS5mb3JFYWNoKGZ1bmN0aW9uKGFzc2V0KXtcbiAgICAgICBpY29uUHJvdmlkZXIuaWNvbihhc3NldC5pZCwgIGFzc2V0LnVybCk7XG4gICAgICAgJHRlbXBsYXRlQ2FjaGUucHV0KGFzc2V0LnVybCwgYXNzZXQuc3ZnKTtcbiAgICAgfSk7XG5cbiAgIH0sXG5cbiAgICRnZXQgOiBbJyRodHRwJywgJyRxJywgJyRsb2cnLCAnJHRlbXBsYXRlQ2FjaGUnLCBmdW5jdGlvbigkaHR0cCwgJHEsICRsb2csICR0ZW1wbGF0ZUNhY2hlKSB7XG4gICAgIHRoaXMucHJlbG9hZEljb25zKCR0ZW1wbGF0ZUNhY2hlKTtcbiAgICAgcmV0dXJuIE1kSWNvblNlcnZpY2UoY29uZmlnLCAkaHR0cCwgJHEsICRsb2csICR0ZW1wbGF0ZUNhY2hlKTtcbiAgIH1dXG4gfTtcblxuICAgLyoqXG4gICAgKiAgQ29uZmlndXJhdGlvbiBpdGVtIHN0b3JlZCBpbiB0aGUgSWNvbiByZWdpc3RyeTsgdXNlZCBmb3IgbG9va3Vwc1xuICAgICogIHRvIGxvYWQgaWYgbm90IGFscmVhZHkgY2FjaGVkIGluIHRoZSBgbG9hZGVkYCBjYWNoZVxuICAgICovXG4gICBmdW5jdGlvbiBDb25maWd1cmF0aW9uSXRlbSh1cmwsIHZpZXdCb3hTaXplKSB7XG4gICAgIHRoaXMudXJsID0gdXJsO1xuICAgICB0aGlzLnZpZXdCb3hTaXplID0gdmlld0JveFNpemUgfHwgY29uZmlnLmRlZmF1bHRWaWV3Qm94U2l6ZTtcbiAgIH1cblxuIC8qKlxuICAqIEBuZ2RvYyBzZXJ2aWNlXG4gICogQG5hbWUgJG1kSWNvblxuICAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5pY29uXG4gICpcbiAgKiBAZGVzY3JpcHRpb25cbiAgKiBUaGUgYCRtZEljb25gIHNlcnZpY2UgaXMgYSBmdW5jdGlvbiB1c2VkIHRvIGxvb2t1cCBTVkcgaWNvbnMuXG4gICpcbiAgKiBAcGFyYW0ge3N0cmluZ30gaWQgUXVlcnkgdmFsdWUgZm9yIGEgdW5pcXVlIElkIG9yIFVSTC4gSWYgdGhlIGFyZ3VtZW50IGlzIGEgVVJMLCB0aGVuIHRoZSBzZXJ2aWNlIHdpbGwgcmV0cmlldmUgdGhlIGljb24gZWxlbWVudFxuICAqIGZyb20gaXRzIGludGVybmFsIGNhY2hlIG9yIGxvYWQgdGhlIGljb24gYW5kIGNhY2hlIGl0IGZpcnN0LiBJZiB0aGUgdmFsdWUgaXMgbm90IGEgVVJMLXR5cGUgc3RyaW5nLCB0aGVuIGFuIElEIGxvb2t1cCBpc1xuICAqIHBlcmZvcm1lZC4gVGhlIElkIG1heSBiZSBhIHVuaXF1ZSBpY29uIElEIG9yIG1heSBpbmNsdWRlIGFuIGljb25TZXQgSUQgcHJlZml4LlxuICAqXG4gICogRm9yIHRoZSAqKmlkKiogcXVlcnkgdG8gd29yayBwcm9wZXJseSwgdGhpcyBtZWFucyB0aGF0IGFsbCBpZC10by1VUkwgbWFwcGluZ3MgbXVzdCBoYXZlIGJlZW4gcHJldmlvdXNseSBjb25maWd1cmVkXG4gICogdXNpbmcgdGhlIGAkbWRJY29uUHJvdmlkZXJgLlxuICAqXG4gICogQHJldHVybnMge29ian0gQ2xvbmUgb2YgdGhlIGluaXRpYWwgU1ZHIERPTSBlbGVtZW50OyB3aGljaCB3YXMgY3JlYXRlZCBmcm9tIHRoZSBTVkcgbWFya3VwIGluIHRoZSBTVkcgZGF0YSBmaWxlLlxuICAqXG4gICogQHVzYWdlXG4gICogPGhsanMgbGFuZz1cImpzXCI+XG4gICogZnVuY3Rpb24gU29tZURpcmVjdGl2ZSgkbWRJY29uKSB7XG4gICpcbiAgKiAgIC8vIFNlZSBpZiB0aGUgaWNvbiBoYXMgYWxyZWFkeSBiZWVuIGxvYWRlZCwgaWYgbm90XG4gICogICAvLyB0aGVuIGxvb2t1cCB0aGUgaWNvbiBmcm9tIHRoZSByZWdpc3RyeSBjYWNoZSwgbG9hZCBhbmQgY2FjaGVcbiAgKiAgIC8vIGl0IGZvciBmdXR1cmUgcmVxdWVzdHMuXG4gICogICAvLyBOT1RFOiBJRCBxdWVyaWVzIHJlcXVpcmUgY29uZmlndXJhdGlvbiB3aXRoICRtZEljb25Qcm92aWRlclxuICAqXG4gICogICAkbWRJY29uKCdhbmRyb2lkJykudGhlbihmdW5jdGlvbihpY29uRWwpICAgIHsgZWxlbWVudC5hcHBlbmQoaWNvbkVsKTsgfSk7XG4gICogICAkbWRJY29uKCd3b3JrOmNoYWlyJykudGhlbihmdW5jdGlvbihpY29uRWwpIHsgZWxlbWVudC5hcHBlbmQoaWNvbkVsKTsgfSk7XG4gICpcbiAgKiAgIC8vIExvYWQgYW5kIGNhY2hlIHRoZSBleHRlcm5hbCBTVkcgdXNpbmcgYSBVUkxcbiAgKlxuICAqICAgJG1kSWNvbignaW1nL2ljb25zL2FuZHJvaWQuc3ZnJykudGhlbihmdW5jdGlvbihpY29uRWwpIHtcbiAgKiAgICAgZWxlbWVudC5hcHBlbmQoaWNvbkVsKTtcbiAgKiAgIH0pO1xuICAqIH07XG4gICogPC9obGpzPlxuICAqXG4gICogTk9URTogVGhlIGA8bWQtaWNvbiAvPiAgYCBkaXJlY3RpdmUgaW50ZXJuYWxseSB1c2VzIHRoZSBgJG1kSWNvbmAgc2VydmljZSB0byBxdWVyeSwgbG9hZGVkLCBhbmQgaW5zdGFudGlhdGVcbiAgKiBTVkcgRE9NIGVsZW1lbnRzLlxuICAqL1xuIGZ1bmN0aW9uIE1kSWNvblNlcnZpY2UoY29uZmlnLCAkaHR0cCwgJHEsICRsb2csICR0ZW1wbGF0ZUNhY2hlKSB7XG4gICB2YXIgaWNvbkNhY2hlID0ge307XG4gICB2YXIgdXJsUmVnZXggPSAvWy1hLXpBLVowLTlAOiVfXFwrLn4jPyYvLz1dezIsMjU2fVxcLlthLXpdezIsNH1cXGIoXFwvWy1hLXpBLVowLTlAOiVfXFwrLn4jPyYvLz1dKik/L2k7XG5cbiAgIEljb24ucHJvdG90eXBlID0geyBjbG9uZSA6IGNsb25lU1ZHLCBwcmVwYXJlOiBwcmVwYXJlQW5kU3R5bGUgfTtcbiAgIGdldEljb24uZm9udFNldCA9IGZpbmRSZWdpc3RlcmVkRm9udFNldDtcblxuICAgLy8gUHVibGlzaCBzZXJ2aWNlLi4uXG4gICByZXR1cm4gZ2V0SWNvbjtcblxuICAgLyoqXG4gICAgKiBBY3R1YWwgJG1kSWNvbiBzZXJ2aWNlIGlzIGVzc2VudGlhbGx5IGEgbG9va3VwIGZ1bmN0aW9uXG4gICAgKi9cbiAgIGZ1bmN0aW9uIGdldEljb24oaWQpIHtcbiAgICAgaWQgPSBpZCB8fCAnJztcblxuICAgICAvLyBJZiBhbHJlYWR5IGxvYWRlZCBhbmQgY2FjaGVkLCB1c2UgYSBjbG9uZSBvZiB0aGUgY2FjaGVkIGljb24uXG4gICAgIC8vIE90aGVyd2lzZSBlaXRoZXIgbG9hZCBieSBVUkwsIG9yIGxvb2t1cCBpbiB0aGUgcmVnaXN0cnkgYW5kIHRoZW4gbG9hZCBieSBVUkwsIGFuZCBjYWNoZS5cblxuICAgICBpZiAoIGljb25DYWNoZVtpZF0gICAgICAgICApIHJldHVybiAkcS53aGVuKCBpY29uQ2FjaGVbaWRdLmNsb25lKCkgKTtcbiAgICAgaWYgKCB1cmxSZWdleC50ZXN0KGlkKSAgICAgKSByZXR1cm4gbG9hZEJ5VVJMKGlkKS50aGVuKCBjYWNoZUljb24oaWQpICk7XG4gICAgIGlmICggaWQuaW5kZXhPZignOicpID09IC0xICkgaWQgPSAnJGRlZmF1bHQ6JyArIGlkO1xuXG4gICAgIHJldHVybiBsb2FkQnlJRChpZClcbiAgICAgICAgIC5jYXRjaChsb2FkRnJvbUljb25TZXQpXG4gICAgICAgICAuY2F0Y2goYW5ub3VuY2VJZE5vdEZvdW5kKVxuICAgICAgICAgLmNhdGNoKGFubm91bmNlTm90Rm91bmQpXG4gICAgICAgICAudGhlbiggY2FjaGVJY29uKGlkKSApO1xuICAgfVxuXG4gICAvKipcbiAgICAqIExvb2t1cCByZWdpc3RlcmVkIGZvbnRTZXQgc3R5bGUgdXNpbmcgaXRzIGFsaWFzLi4uXG4gICAgKiBJZiBub3QgZm91bmQsXG4gICAgKi9cbiAgIGZ1bmN0aW9uIGZpbmRSZWdpc3RlcmVkRm9udFNldChhbGlhcykge1xuICAgICAgdmFyIHVzZURlZmF1bHQgPSBhbmd1bGFyLmlzVW5kZWZpbmVkKGFsaWFzKSB8fCAhKGFsaWFzICYmIGFsaWFzLmxlbmd0aCk7XG4gICAgICBpZiAoIHVzZURlZmF1bHQgKSByZXR1cm4gY29uZmlnLmRlZmF1bHRGb250U2V0O1xuXG4gICAgICB2YXIgcmVzdWx0ID0gYWxpYXM7XG4gICAgICBhbmd1bGFyLmZvckVhY2goY29uZmlnLmZvbnRTZXRzLCBmdW5jdGlvbihpdCl7XG4gICAgICAgIGlmICggaXQuYWxpYXMgPT0gYWxpYXMgKSByZXN1bHQgPSBpdC5mb250U2V0IHx8IHJlc3VsdDtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgfVxuXG4gICAvKipcbiAgICAqIFByZXBhcmUgYW5kIGNhY2hlIHRoZSBsb2FkZWQgaWNvbiBmb3IgdGhlIHNwZWNpZmllZCBgaWRgXG4gICAgKi9cbiAgIGZ1bmN0aW9uIGNhY2hlSWNvbiggaWQgKSB7XG5cbiAgICAgcmV0dXJuIGZ1bmN0aW9uIHVwZGF0ZUNhY2hlKCBpY29uICkge1xuICAgICAgIGljb25DYWNoZVtpZF0gPSBpc0ljb24oaWNvbikgPyBpY29uIDogbmV3IEljb24oaWNvbiwgY29uZmlnW2lkXSk7XG5cbiAgICAgICByZXR1cm4gaWNvbkNhY2hlW2lkXS5jbG9uZSgpO1xuICAgICB9O1xuICAgfVxuXG4gICAvKipcbiAgICAqIExvb2t1cCB0aGUgY29uZmlndXJhdGlvbiBpbiB0aGUgcmVnaXN0cnksIGlmICFyZWdpc3RlcmVkIHRocm93IGFuIGVycm9yXG4gICAgKiBvdGhlcndpc2UgbG9hZCB0aGUgaWNvbiBbb24tZGVtYW5kXSB1c2luZyB0aGUgcmVnaXN0ZXJlZCBVUkwuXG4gICAgKlxuICAgICovXG4gICBmdW5jdGlvbiBsb2FkQnlJRChpZCkge1xuICAgICB2YXIgaWNvbkNvbmZpZyA9IGNvbmZpZ1tpZF07XG5cbiAgICAgcmV0dXJuICFpY29uQ29uZmlnID8gJHEucmVqZWN0KGlkKSA6IGxvYWRCeVVSTChpY29uQ29uZmlnLnVybCkudGhlbihmdW5jdGlvbihpY29uKSB7XG4gICAgICAgcmV0dXJuIG5ldyBJY29uKGljb24sIGljb25Db25maWcpO1xuICAgICB9KTtcbiAgIH1cblxuICAgLyoqXG4gICAgKiAgICBMb2FkcyB0aGUgZmlsZSBhcyBYTUwgYW5kIHVzZXMgcXVlcnlTZWxlY3RvciggPGlkPiApIHRvIGZpbmRcbiAgICAqICAgIHRoZSBkZXNpcmVkIG5vZGUuLi5cbiAgICAqL1xuICAgZnVuY3Rpb24gbG9hZEZyb21JY29uU2V0KGlkKSB7XG4gICAgIHZhciBzZXROYW1lID0gaWQuc3Vic3RyaW5nKDAsIGlkLmxhc3RJbmRleE9mKCc6JykpIHx8ICckZGVmYXVsdCc7XG4gICAgIHZhciBpY29uU2V0Q29uZmlnID0gY29uZmlnW3NldE5hbWVdO1xuXG4gICAgIHJldHVybiAhaWNvblNldENvbmZpZyA/ICRxLnJlamVjdChpZCkgOiBsb2FkQnlVUkwoaWNvblNldENvbmZpZy51cmwpLnRoZW4oZXh0cmFjdEZyb21TZXQpO1xuXG4gICAgIGZ1bmN0aW9uIGV4dHJhY3RGcm9tU2V0KHNldCkge1xuICAgICAgIHZhciBpY29uTmFtZSA9IGlkLnNsaWNlKGlkLmxhc3RJbmRleE9mKCc6JykgKyAxKTtcbiAgICAgICB2YXIgaWNvbiA9IHNldC5xdWVyeVNlbGVjdG9yKCcjJyArIGljb25OYW1lKTtcbiAgICAgICByZXR1cm4gIWljb24gPyAkcS5yZWplY3QoaWQpIDogbmV3IEljb24oaWNvbiwgaWNvblNldENvbmZpZyk7XG4gICAgIH1cbiAgIH1cblxuICAgLyoqXG4gICAgKiBMb2FkIHRoZSBpY29uIGJ5IFVSTCAobWF5IHVzZSB0aGUgJHRlbXBsYXRlQ2FjaGUpLlxuICAgICogRXh0cmFjdCB0aGUgZGF0YSBmb3IgbGF0ZXIgY29udmVyc2lvbiB0byBJY29uXG4gICAgKi9cbiAgIGZ1bmN0aW9uIGxvYWRCeVVSTCh1cmwpIHtcbiAgICAgcmV0dXJuICRodHRwXG4gICAgICAgLmdldCh1cmwsIHsgY2FjaGU6ICR0ZW1wbGF0ZUNhY2hlIH0pXG4gICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgIHJldHVybiBhbmd1bGFyLmVsZW1lbnQoJzxkaXY+JykuYXBwZW5kKHJlc3BvbnNlLmRhdGEpLmZpbmQoJ3N2ZycpWzBdO1xuICAgICAgIH0pO1xuICAgfVxuXG4gICAvKipcbiAgICAqIFVzZXIgZGlkIG5vdCBzcGVjaWZ5IGEgVVJMIGFuZCB0aGUgSUQgaGFzIG5vdCBiZWVuIHJlZ2lzdGVyZWQgd2l0aCB0aGUgJG1kSWNvblxuICAgICogcmVnaXN0cnlcbiAgICAqL1xuICAgZnVuY3Rpb24gYW5ub3VuY2VJZE5vdEZvdW5kKGlkKSB7XG4gICAgIHZhciBtc2c7XG5cbiAgICAgaWYgKGFuZ3VsYXIuaXNTdHJpbmcoaWQpKSB7XG4gICAgICAgbXNnID0gJ2ljb24gJyArIGlkICsgJyBub3QgZm91bmQnO1xuICAgICAgICRsb2cud2Fybihtc2cpO1xuICAgICB9XG5cbiAgICAgcmV0dXJuICRxLnJlamVjdChtc2cgfHwgaWQpO1xuICAgfVxuXG4gICAvKipcbiAgICAqIENhdGNoIEhUVFAgb3IgZ2VuZXJpYyBlcnJvcnMgbm90IHJlbGF0ZWQgdG8gaW5jb3JyZWN0IGljb24gSURzLlxuICAgICovXG4gICBmdW5jdGlvbiBhbm5vdW5jZU5vdEZvdW5kKGVycikge1xuICAgICB2YXIgbXNnID0gYW5ndWxhci5pc1N0cmluZyhlcnIpID8gZXJyIDogKGVyci5tZXNzYWdlIHx8IGVyci5kYXRhIHx8IGVyci5zdGF0dXNUZXh0KTtcbiAgICAgJGxvZy53YXJuKG1zZyk7XG5cbiAgICAgcmV0dXJuICRxLnJlamVjdChtc2cpO1xuICAgfVxuXG4gICAvKipcbiAgICAqIENoZWNrIHRhcmdldCBzaWduYXR1cmUgdG8gc2VlIGlmIGl0IGlzIGFuIEljb24gaW5zdGFuY2UuXG4gICAgKi9cbiAgIGZ1bmN0aW9uIGlzSWNvbih0YXJnZXQpIHtcbiAgICAgcmV0dXJuIGFuZ3VsYXIuaXNEZWZpbmVkKHRhcmdldC5lbGVtZW50KSAmJiBhbmd1bGFyLmlzRGVmaW5lZCh0YXJnZXQuY29uZmlnKTtcbiAgIH1cblxuICAgLyoqXG4gICAgKiAgRGVmaW5lIHRoZSBJY29uIGNsYXNzXG4gICAgKi9cbiAgIGZ1bmN0aW9uIEljb24oZWwsIGNvbmZpZykge1xuICAgICBpZiAoZWwudGFnTmFtZSAhPSAnc3ZnJykge1xuICAgICAgIGVsID0gYW5ndWxhci5lbGVtZW50KCc8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj4nKS5hcHBlbmQoZWwpWzBdO1xuICAgICB9XG5cbiAgICAgLy8gSW5qZWN0IHRoZSBuYW1lc3BhY2UgaWYgbm90IGF2YWlsYWJsZS4uLlxuICAgICBpZiAoICFlbC5nZXRBdHRyaWJ1dGUoJ3htbG5zJykgKSB7XG4gICAgICAgZWwuc2V0QXR0cmlidXRlKCd4bWxucycsIFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIik7XG4gICAgIH1cblxuICAgICB0aGlzLmVsZW1lbnQgPSBlbDtcbiAgICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgIHRoaXMucHJlcGFyZSgpO1xuICAgfVxuXG4gICAvKipcbiAgICAqICBQcmVwYXJlIHRoZSBET00gZWxlbWVudCB0aGF0IHdpbGwgYmUgY2FjaGVkIGluIHRoZVxuICAgICogIGxvYWRlZCBpY29uQ2FjaGUgc3RvcmUuXG4gICAgKi9cbiAgIGZ1bmN0aW9uIHByZXBhcmVBbmRTdHlsZSgpIHtcbiAgICAgdmFyIHZpZXdCb3hTaXplID0gdGhpcy5jb25maWcgPyB0aGlzLmNvbmZpZy52aWV3Qm94U2l6ZSA6IGNvbmZpZy5kZWZhdWx0Vmlld0JveFNpemU7XG4gICAgICAgICBhbmd1bGFyLmZvckVhY2goe1xuICAgICAgICAgICAnZml0JyAgIDogJycsXG4gICAgICAgICAgICdoZWlnaHQnOiAnMTAwJScsXG4gICAgICAgICAgICd3aWR0aCcgOiAnMTAwJScsXG4gICAgICAgICAgICdwcmVzZXJ2ZUFzcGVjdFJhdGlvJzogJ3hNaWRZTWlkIG1lZXQnLFxuICAgICAgICAgICAndmlld0JveCcgOiB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCd2aWV3Qm94JykgfHwgKCcwIDAgJyArIHZpZXdCb3hTaXplICsgJyAnICsgdmlld0JveFNpemUpXG4gICAgICAgICB9LCBmdW5jdGlvbih2YWwsIGF0dHIpIHtcbiAgICAgICAgICAgdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZShhdHRyLCB2YWwpO1xuICAgICAgICAgfSwgdGhpcyk7XG5cbiAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCh7XG4gICAgICAgICAgICdwb2ludGVyLWV2ZW50cycgOiAnbm9uZScsXG4gICAgICAgICAgICdkaXNwbGF5JyA6ICdibG9jaydcbiAgICAgICAgIH0sIGZ1bmN0aW9uKHZhbCwgc3R5bGUpIHtcbiAgICAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlW3N0eWxlXSA9IHZhbDtcbiAgICAgICAgIH0sIHRoaXMpO1xuICAgfVxuXG4gICAvKipcbiAgICAqIENsb25lIHRoZSBJY29uIERPTSBlbGVtZW50LlxuICAgICovXG4gICBmdW5jdGlvbiBjbG9uZVNWRygpe1xuICAgICByZXR1cm4gdGhpcy5lbGVtZW50LmNsb25lTm9kZSh0cnVlKTtcbiAgIH1cblxuIH1cblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogQG5nZG9jIG1vZHVsZVxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5pbnB1dFxuICovXG5cbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmlucHV0JywgW1xuICAnbWF0ZXJpYWwuY29yZSdcbl0pXG4gIC5kaXJlY3RpdmUoJ21kSW5wdXRDb250YWluZXInLCBtZElucHV0Q29udGFpbmVyRGlyZWN0aXZlKVxuICAuZGlyZWN0aXZlKCdsYWJlbCcsIGxhYmVsRGlyZWN0aXZlKVxuICAuZGlyZWN0aXZlKCdpbnB1dCcsIGlucHV0VGV4dGFyZWFEaXJlY3RpdmUpXG4gIC5kaXJlY3RpdmUoJ3RleHRhcmVhJywgaW5wdXRUZXh0YXJlYURpcmVjdGl2ZSlcbiAgLmRpcmVjdGl2ZSgnbWRNYXhsZW5ndGgnLCBtZE1heGxlbmd0aERpcmVjdGl2ZSlcbiAgLmRpcmVjdGl2ZSgncGxhY2Vob2xkZXInLCBwbGFjZWhvbGRlckRpcmVjdGl2ZSk7XG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbWRJbnB1dENvbnRhaW5lclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmlucHV0XG4gKlxuICogQHJlc3RyaWN0IEVcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIGA8bWQtaW5wdXQtY29udGFpbmVyPmAgaXMgdGhlIHBhcmVudCBvZiBhbnkgaW5wdXQgb3IgdGV4dGFyZWEgZWxlbWVudC5cbiAqXG4gKiBJbnB1dCBhbmQgdGV4dGFyZWEgZWxlbWVudHMgd2lsbCBub3QgYmVoYXZlIHByb3Blcmx5IHVubGVzcyB0aGUgbWQtaW5wdXQtY29udGFpbmVyXG4gKiBwYXJlbnQgaXMgcHJvdmlkZWQuXG4gKlxuICogQHBhcmFtIG1kLWlzLWVycm9yIHtleHByZXNzaW9uPX0gV2hlbiB0aGUgZ2l2ZW4gZXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gdHJ1ZSwgdGhlIGlucHV0IGNvbnRhaW5lciB3aWxsIGdvIGludG8gZXJyb3Igc3RhdGUuIERlZmF1bHRzIHRvIGVycm9yaW5nIGlmIHRoZSBpbnB1dCBoYXMgYmVlbiB0b3VjaGVkIGFuZCBpcyBpbnZhbGlkLlxuICogQHBhcmFtIG1kLW5vLWZsb2F0IHtib29sZWFuPX0gV2hlbiBwcmVzZW50LCBwbGFjZWhvbGRlcnMgd2lsbCBub3QgYmUgY29udmVydGVkIHRvIGZsb2F0aW5nIGxhYmVsc1xuICpcbiAqIEB1c2FnZVxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cbiAqXG4gKiA8bWQtaW5wdXQtY29udGFpbmVyPlxuICogICA8bGFiZWw+VXNlcm5hbWU8L2xhYmVsPlxuICogICA8aW5wdXQgdHlwZT1cInRleHRcIiBuZy1tb2RlbD1cInVzZXIubmFtZVwiPlxuICogPC9tZC1pbnB1dC1jb250YWluZXI+XG4gKlxuICogPG1kLWlucHV0LWNvbnRhaW5lcj5cbiAqICAgPGxhYmVsPkRlc2NyaXB0aW9uPC9sYWJlbD5cbiAqICAgPHRleHRhcmVhIG5nLW1vZGVsPVwidXNlci5kZXNjcmlwdGlvblwiPjwvdGV4dGFyZWE+XG4gKiA8L21kLWlucHV0LWNvbnRhaW5lcj5cbiAqXG4gKiA8L2hsanM+XG4gKi9cbmZ1bmN0aW9uIG1kSW5wdXRDb250YWluZXJEaXJlY3RpdmUoJG1kVGhlbWluZywgJHBhcnNlKSB7XG4gIENvbnRhaW5lckN0cmwuJGluamVjdCA9IFtcIiRzY29wZVwiLCBcIiRlbGVtZW50XCIsIFwiJGF0dHJzXCJdO1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnRScsXG4gICAgbGluazogcG9zdExpbmssXG4gICAgY29udHJvbGxlcjogQ29udGFpbmVyQ3RybFxuICB9O1xuXG4gIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XG4gICAgJG1kVGhlbWluZyhlbGVtZW50KTtcbiAgfVxuICBmdW5jdGlvbiBDb250YWluZXJDdHJsKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycykge1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIHNlbGYuaXNFcnJvckdldHRlciA9ICRhdHRycy5tZElzRXJyb3IgJiYgJHBhcnNlKCRhdHRycy5tZElzRXJyb3IpO1xuXG4gICAgc2VsZi5kZWxlZ2F0ZUNsaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICBzZWxmLmlucHV0LmZvY3VzKCk7XG4gICAgfTtcbiAgICBzZWxmLmVsZW1lbnQgPSAkZWxlbWVudDtcbiAgICBzZWxmLnNldEZvY3VzZWQgPSBmdW5jdGlvbihpc0ZvY3VzZWQpIHtcbiAgICAgICRlbGVtZW50LnRvZ2dsZUNsYXNzKCdtZC1pbnB1dC1mb2N1c2VkJywgISFpc0ZvY3VzZWQpO1xuICAgIH07XG4gICAgc2VsZi5zZXRIYXNWYWx1ZSA9IGZ1bmN0aW9uKGhhc1ZhbHVlKSB7XG4gICAgICAkZWxlbWVudC50b2dnbGVDbGFzcygnbWQtaW5wdXQtaGFzLXZhbHVlJywgISFoYXNWYWx1ZSk7XG4gICAgfTtcbiAgICBzZWxmLnNldEludmFsaWQgPSBmdW5jdGlvbihpc0ludmFsaWQpIHtcbiAgICAgICRlbGVtZW50LnRvZ2dsZUNsYXNzKCdtZC1pbnB1dC1pbnZhbGlkJywgISFpc0ludmFsaWQpO1xuICAgIH07XG4gICAgJHNjb3BlLiR3YXRjaChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBzZWxmLmxhYmVsICYmIHNlbGYuaW5wdXQ7XG4gICAgfSwgZnVuY3Rpb24oaGFzTGFiZWxBbmRJbnB1dCkge1xuICAgICAgaWYgKGhhc0xhYmVsQW5kSW5wdXQgJiYgIXNlbGYubGFiZWwuYXR0cignZm9yJykpIHtcbiAgICAgICAgc2VsZi5sYWJlbC5hdHRyKCdmb3InLCBzZWxmLmlucHV0LmF0dHIoJ2lkJykpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5tZElucHV0Q29udGFpbmVyRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkbWRUaGVtaW5nXCIsIFwiJHBhcnNlXCJdO1xuXG5mdW5jdGlvbiBsYWJlbERpcmVjdGl2ZSgpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0UnLFxuICAgIHJlcXVpcmU6ICdeP21kSW5wdXRDb250YWluZXInLFxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjb250YWluZXJDdHJsKSB7XG4gICAgICBpZiAoIWNvbnRhaW5lckN0cmwgfHwgYXR0ci5tZE5vRmxvYXQpIHJldHVybjtcblxuICAgICAgY29udGFpbmVyQ3RybC5sYWJlbCA9IGVsZW1lbnQ7XG4gICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnRhaW5lckN0cmwubGFiZWwgPSBudWxsO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xufVxuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG1kSW5wdXRcbiAqIEByZXN0cmljdCBFXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuaW5wdXRcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFVzZSB0aGUgYDxpbnB1dD5gIG9yIHRoZSAgYDx0ZXh0YXJlYT5gIGFzIGEgY2hpbGQgb2YgYW4gYDxtZC1pbnB1dC1jb250YWluZXI+YC5cbiAqXG4gKiBAcGFyYW0ge251bWJlcj19IG1kLW1heGxlbmd0aCBUaGUgbWF4aW11bSBudW1iZXIgb2YgY2hhcmFjdGVycyBhbGxvd2VkIGluIHRoaXMgaW5wdXQuIElmIHRoaXMgaXMgc3BlY2lmaWVkLCBhIGNoYXJhY3RlciBjb3VudGVyIHdpbGwgYmUgc2hvd24gdW5kZXJuZWF0aCB0aGUgaW5wdXQuPGJyLz48YnIvPlxuICogVGhlIHB1cnBvc2Ugb2YgKipgbWQtbWF4bGVuZ3RoYCoqIGlzIGV4YWN0bHkgdG8gc2hvdyB0aGUgbWF4IGxlbmd0aCBjb3VudGVyIHRleHQuIElmIHlvdSBkb24ndCB3YW50IHRoZSBjb3VudGVyIHRleHQgYW5kIG9ubHkgbmVlZCBcInBsYWluXCIgdmFsaWRhdGlvbiwgeW91IGNhbiB1c2UgdGhlIFwic2ltcGxlXCIgYG5nLW1heGxlbmd0aGAgb3IgbWF4bGVuZ3RoIGF0dHJpYnV0ZXMuXG4gKiBAcGFyYW0ge3N0cmluZz19IGFyaWEtbGFiZWwgQXJpYS1sYWJlbCBpcyByZXF1aXJlZCB3aGVuIG5vIGxhYmVsIGlzIHByZXNlbnQuICBBIHdhcm5pbmcgbWVzc2FnZSB3aWxsIGJlIGxvZ2dlZCBpbiB0aGUgY29uc29sZSBpZiBub3QgcHJlc2VudC5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gcGxhY2Vob2xkZXIgQW4gYWx0ZXJuYXRpdmUgYXBwcm9hY2ggdG8gdXNpbmcgYXJpYS1sYWJlbCB3aGVuIHRoZSBsYWJlbCBpcyBub3QgcHJlc2VudC4gIFRoZSBwbGFjZWhvbGRlciB0ZXh0IGlzIGNvcGllZCB0byB0aGUgYXJpYS1sYWJlbCBhdHRyaWJ1dGUuXG4gKlxuICogQHVzYWdlXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxuICogPG1kLWlucHV0LWNvbnRhaW5lcj5cbiAqICAgPGxhYmVsPkNvbG9yPC9sYWJlbD5cbiAqICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmctbW9kZWw9XCJjb2xvclwiIHJlcXVpcmVkIG1kLW1heGxlbmd0aD1cIjEwXCI+XG4gKiA8L21kLWlucHV0LWNvbnRhaW5lcj5cbiAqIDwvaGxqcz5cbiAqIDxoMz5XaXRoIEVycm9yczwvaDM+XG4gKlxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cbiAqIDxmb3JtIG5hbWU9XCJ1c2VyRm9ybVwiPlxuICogICA8bWQtaW5wdXQtY29udGFpbmVyPlxuICogICAgIDxsYWJlbD5MYXN0IE5hbWU8L2xhYmVsPlxuICogICAgIDxpbnB1dCBuYW1lPVwibGFzdE5hbWVcIiBuZy1tb2RlbD1cImxhc3ROYW1lXCIgcmVxdWlyZWQgbWQtbWF4bGVuZ3RoPVwiMTBcIiBtaW5sZW5ndGg9XCI0XCI+XG4gKiAgICAgPGRpdiBuZy1tZXNzYWdlcz1cInVzZXJGb3JtLmxhc3ROYW1lLiRlcnJvclwiIG5nLXNob3c9XCJ1c2VyRm9ybS5sYXN0TmFtZS4kZGlydHlcIj5cbiAqICAgICAgIDxkaXYgbmctbWVzc2FnZT1cInJlcXVpcmVkXCI+VGhpcyBpcyByZXF1aXJlZCE8L2Rpdj5cbiAqICAgICAgIDxkaXYgbmctbWVzc2FnZT1cIm1kLW1heGxlbmd0aFwiPlRoYXQncyB0b28gbG9uZyE8L2Rpdj5cbiAqICAgICAgIDxkaXYgbmctbWVzc2FnZT1cIm1pbmxlbmd0aFwiPlRoYXQncyB0b28gc2hvcnQhPC9kaXY+XG4gKiAgICAgPC9kaXY+XG4gKiAgIDwvbWQtaW5wdXQtY29udGFpbmVyPlxuICogICA8bWQtaW5wdXQtY29udGFpbmVyPlxuICogICAgIDxsYWJlbD5CaW9ncmFwaHk8L2xhYmVsPlxuICogICAgIDx0ZXh0YXJlYSBuYW1lPVwiYmlvXCIgbmctbW9kZWw9XCJiaW9ncmFwaHlcIiByZXF1aXJlZCBtZC1tYXhsZW5ndGg9XCIxNTBcIj48L3RleHRhcmVhPlxuICogICAgIDxkaXYgbmctbWVzc2FnZXM9XCJ1c2VyRm9ybS5iaW8uJGVycm9yXCIgbmctc2hvdz1cInVzZXJGb3JtLmJpby4kZGlydHlcIj5cbiAqICAgICAgIDxkaXYgbmctbWVzc2FnZT1cInJlcXVpcmVkXCI+VGhpcyBpcyByZXF1aXJlZCE8L2Rpdj5cbiAqICAgICAgIDxkaXYgbmctbWVzc2FnZT1cIm1kLW1heGxlbmd0aFwiPlRoYXQncyB0b28gbG9uZyE8L2Rpdj5cbiAqICAgICA8L2Rpdj5cbiAqICAgPC9tZC1pbnB1dC1jb250YWluZXI+XG4gKiAgIDxtZC1pbnB1dC1jb250YWluZXI+XG4gKiAgICAgPGlucHV0IGFyaWEtbGFiZWw9J3RpdGxlJyBuZy1tb2RlbD0ndGl0bGUnPlxuICogICA8L21kLWlucHV0LWNvbnRhaW5lcj5cbiAqICAgPG1kLWlucHV0LWNvbnRhaW5lcj5cbiAqICAgICA8aW5wdXQgcGxhY2Vob2xkZXI9J3RpdGxlJyBuZy1tb2RlbD0ndGl0bGUnPlxuICogICA8L21kLWlucHV0LWNvbnRhaW5lcj5cbiAqIDwvZm9ybT5cbiAqIDwvaGxqcz5cbiAqXG4gKiBSZXF1aXJlcyBbbmdNZXNzYWdlc10oaHR0cHM6Ly9kb2NzLmFuZ3VsYXJqcy5vcmcvYXBpL25nTWVzc2FnZXMpLlxuICogQmVoYXZlcyBsaWtlIHRoZSBbQW5ndWxhckpTIGlucHV0IGRpcmVjdGl2ZV0oaHR0cHM6Ly9kb2NzLmFuZ3VsYXJqcy5vcmcvYXBpL25nL2RpcmVjdGl2ZS9pbnB1dCkuXG4gKlxuICovXG5cbmZ1bmN0aW9uIGlucHV0VGV4dGFyZWFEaXJlY3RpdmUoJG1kVXRpbCwgJHdpbmRvdywgJG1kQXJpYSkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnRScsXG4gICAgcmVxdWlyZTogWydeP21kSW5wdXRDb250YWluZXInLCAnP25nTW9kZWwnXSxcbiAgICBsaW5rOiBwb3N0TGlua1xuICB9O1xuXG4gIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJscykge1xuXG4gICAgdmFyIGNvbnRhaW5lckN0cmwgPSBjdHJsc1swXTtcbiAgICB2YXIgbmdNb2RlbEN0cmwgPSBjdHJsc1sxXSB8fCAkbWRVdGlsLmZha2VOZ01vZGVsKCk7XG4gICAgdmFyIGlzUmVhZG9ubHkgPSBhbmd1bGFyLmlzRGVmaW5lZChhdHRyLnJlYWRvbmx5KTtcblxuICAgIGlmICggIWNvbnRhaW5lckN0cmwgKSByZXR1cm47XG4gICAgaWYgKGNvbnRhaW5lckN0cmwuaW5wdXQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIjxtZC1pbnB1dC1jb250YWluZXI+IGNhbiBvbmx5IGhhdmUgKm9uZSogPGlucHV0PiBvciA8dGV4dGFyZWE+IGNoaWxkIGVsZW1lbnQhXCIpO1xuICAgIH1cbiAgICBjb250YWluZXJDdHJsLmlucHV0ID0gZWxlbWVudDtcblxuICAgIGlmKCFjb250YWluZXJDdHJsLmxhYmVsKSB7XG4gICAgICAkbWRBcmlhLmV4cGVjdChlbGVtZW50LCAnYXJpYS1sYWJlbCcsIGVsZW1lbnQuYXR0cigncGxhY2Vob2xkZXInKSk7XG4gICAgfVxuXG4gICAgZWxlbWVudC5hZGRDbGFzcygnbWQtaW5wdXQnKTtcbiAgICBpZiAoIWVsZW1lbnQuYXR0cignaWQnKSkge1xuICAgICAgZWxlbWVudC5hdHRyKCdpZCcsICdpbnB1dF8nICsgJG1kVXRpbC5uZXh0VWlkKCkpO1xuICAgIH1cblxuICAgIGlmIChlbGVtZW50WzBdLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ3RleHRhcmVhJykge1xuICAgICAgc2V0dXBUZXh0YXJlYSgpO1xuICAgIH1cblxuICAgIHZhciBpc0Vycm9yR2V0dGVyID0gY29udGFpbmVyQ3RybC5pc0Vycm9yR2V0dGVyIHx8IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIG5nTW9kZWxDdHJsLiRpbnZhbGlkICYmIG5nTW9kZWxDdHJsLiR0b3VjaGVkO1xuICAgIH07XG4gICAgc2NvcGUuJHdhdGNoKGlzRXJyb3JHZXR0ZXIsIGNvbnRhaW5lckN0cmwuc2V0SW52YWxpZCk7XG5cbiAgICBuZ01vZGVsQ3RybC4kcGFyc2Vycy5wdXNoKG5nTW9kZWxQaXBlbGluZUNoZWNrVmFsdWUpO1xuICAgIG5nTW9kZWxDdHJsLiRmb3JtYXR0ZXJzLnB1c2gobmdNb2RlbFBpcGVsaW5lQ2hlY2tWYWx1ZSk7XG5cbiAgICBlbGVtZW50Lm9uKCdpbnB1dCcsIGlucHV0Q2hlY2tWYWx1ZSk7XG5cbiAgICBpZiAoIWlzUmVhZG9ubHkpIHtcbiAgICAgIGVsZW1lbnRcbiAgICAgICAgLm9uKCdmb2N1cycsIGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgY29udGFpbmVyQ3RybC5zZXRGb2N1c2VkKHRydWUpO1xuICAgICAgICB9KVxuICAgICAgICAub24oJ2JsdXInLCBmdW5jdGlvbihldikge1xuICAgICAgICAgIGNvbnRhaW5lckN0cmwuc2V0Rm9jdXNlZChmYWxzZSk7XG4gICAgICAgICAgaW5wdXRDaGVja1ZhbHVlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgfVxuXG4gICAgLy9uZ01vZGVsQ3RybC4kc2V0VG91Y2hlZCgpO1xuICAgIC8vaWYoIG5nTW9kZWxDdHJsLiRpbnZhbGlkICkgY29udGFpbmVyQ3RybC5zZXRJbnZhbGlkKCk7XG5cbiAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oKSB7XG4gICAgICBjb250YWluZXJDdHJsLnNldEZvY3VzZWQoZmFsc2UpO1xuICAgICAgY29udGFpbmVyQ3RybC5zZXRIYXNWYWx1ZShmYWxzZSk7XG4gICAgICBjb250YWluZXJDdHJsLmlucHV0ID0gbnVsbDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqXG4gICAgICovXG4gICAgZnVuY3Rpb24gbmdNb2RlbFBpcGVsaW5lQ2hlY2tWYWx1ZShhcmcpIHtcbiAgICAgIGNvbnRhaW5lckN0cmwuc2V0SGFzVmFsdWUoIW5nTW9kZWxDdHJsLiRpc0VtcHR5KGFyZykpO1xuICAgICAgcmV0dXJuIGFyZztcbiAgICB9XG4gICAgZnVuY3Rpb24gaW5wdXRDaGVja1ZhbHVlKCkge1xuICAgICAgLy8gQW4gaW5wdXQncyB2YWx1ZSBjb3VudHMgaWYgaXRzIGxlbmd0aCA+IDAsXG4gICAgICAvLyBvciBpZiB0aGUgaW5wdXQncyB2YWxpZGl0eSBzdGF0ZSBzYXlzIGl0IGhhcyBiYWQgaW5wdXQgKGVnIHN0cmluZyBpbiBhIG51bWJlciBpbnB1dClcbiAgICAgIGNvbnRhaW5lckN0cmwuc2V0SGFzVmFsdWUoZWxlbWVudC52YWwoKS5sZW5ndGggPiAwIHx8IChlbGVtZW50WzBdLnZhbGlkaXR5fHx7fSkuYmFkSW5wdXQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldHVwVGV4dGFyZWEoKSB7XG4gICAgICB2YXIgbm9kZSA9IGVsZW1lbnRbMF07XG4gICAgICB2YXIgb25DaGFuZ2VUZXh0YXJlYSA9ICRtZFV0aWwuZGVib3VuY2UoZ3Jvd1RleHRhcmVhLCAxKTtcblxuICAgICAgZnVuY3Rpb24gcGlwZWxpbmVMaXN0ZW5lcih2YWx1ZSkge1xuICAgICAgICBvbkNoYW5nZVRleHRhcmVhKCk7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKG5nTW9kZWxDdHJsKSB7XG4gICAgICAgIG5nTW9kZWxDdHJsLiRmb3JtYXR0ZXJzLnB1c2gocGlwZWxpbmVMaXN0ZW5lcik7XG4gICAgICAgIG5nTW9kZWxDdHJsLiR2aWV3Q2hhbmdlTGlzdGVuZXJzLnB1c2gocGlwZWxpbmVMaXN0ZW5lcik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvbkNoYW5nZVRleHRhcmVhKCk7XG4gICAgICB9XG4gICAgICBlbGVtZW50Lm9uKCdrZXlkb3duIGlucHV0Jywgb25DaGFuZ2VUZXh0YXJlYSk7XG4gICAgICBlbGVtZW50Lm9uKCdzY3JvbGwnLCBvblNjcm9sbCk7XG4gICAgICBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdykub24oJ3Jlc2l6ZScsIG9uQ2hhbmdlVGV4dGFyZWEpO1xuXG4gICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vZmYoJ3Jlc2l6ZScsIG9uQ2hhbmdlVGV4dGFyZWEpO1xuICAgICAgfSk7XG5cbiAgICAgIGZ1bmN0aW9uIGdyb3dUZXh0YXJlYSgpIHtcbiAgICAgICAgbm9kZS5zdHlsZS5oZWlnaHQgPSBcImF1dG9cIjtcbiAgICAgICAgbm9kZS5zY3JvbGxUb3AgPSAwO1xuICAgICAgICB2YXIgaGVpZ2h0ID0gZ2V0SGVpZ2h0KCk7XG4gICAgICAgIGlmIChoZWlnaHQpIG5vZGUuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgJ3B4JztcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gZ2V0SGVpZ2h0ICgpIHtcbiAgICAgICAgdmFyIGxpbmUgPSBub2RlLnNjcm9sbEhlaWdodCAtIG5vZGUub2Zmc2V0SGVpZ2h0O1xuICAgICAgICByZXR1cm4gbm9kZS5vZmZzZXRIZWlnaHQgKyAobGluZSA+IDAgPyBsaW5lIDogMCk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIG9uU2Nyb2xsKGUpIHtcbiAgICAgICAgbm9kZS5zY3JvbGxUb3AgPSAwO1xuICAgICAgICAvLyBmb3Igc21vb3RoIG5ldyBsaW5lIGFkZGluZ1xuICAgICAgICB2YXIgbGluZSA9IG5vZGUuc2Nyb2xsSGVpZ2h0IC0gbm9kZS5vZmZzZXRIZWlnaHQ7XG4gICAgICAgIHZhciBoZWlnaHQgPSBub2RlLm9mZnNldEhlaWdodCArIGxpbmU7XG4gICAgICAgIG5vZGUuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgJ3B4JztcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbmlucHV0VGV4dGFyZWFEaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZFV0aWxcIiwgXCIkd2luZG93XCIsIFwiJG1kQXJpYVwiXTtcblxuZnVuY3Rpb24gbWRNYXhsZW5ndGhEaXJlY3RpdmUoJGFuaW1hdGUpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIHJlcXVpcmU6IFsnbmdNb2RlbCcsICdebWRJbnB1dENvbnRhaW5lciddLFxuICAgIGxpbms6IHBvc3RMaW5rXG4gIH07XG5cbiAgZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmxzKSB7XG4gICAgdmFyIG1heGxlbmd0aDtcbiAgICB2YXIgbmdNb2RlbEN0cmwgPSBjdHJsc1swXTtcbiAgICB2YXIgY29udGFpbmVyQ3RybCA9IGN0cmxzWzFdO1xuICAgIHZhciBjaGFyQ291bnRFbCA9IGFuZ3VsYXIuZWxlbWVudCgnPGRpdiBjbGFzcz1cIm1kLWNoYXItY291bnRlclwiPicpO1xuXG4gICAgLy8gU3RvcCBtb2RlbCBmcm9tIHRyaW1taW5nLiBUaGlzIG1ha2VzIGl0IHNvIHdoaXRlc3BhY2VcbiAgICAvLyBvdmVyIHRoZSBtYXhsZW5ndGggc3RpbGwgY291bnRzIGFzIGludmFsaWQuXG4gICAgYXR0ci4kc2V0KCduZ1RyaW0nLCAnZmFsc2UnKTtcbiAgICBjb250YWluZXJDdHJsLmVsZW1lbnQuYXBwZW5kKGNoYXJDb3VudEVsKTtcblxuICAgIG5nTW9kZWxDdHJsLiRmb3JtYXR0ZXJzLnB1c2gocmVuZGVyQ2hhckNvdW50KTtcbiAgICBuZ01vZGVsQ3RybC4kdmlld0NoYW5nZUxpc3RlbmVycy5wdXNoKHJlbmRlckNoYXJDb3VudCk7XG4gICAgZWxlbWVudC5vbignaW5wdXQga2V5ZG93bicsIGZ1bmN0aW9uKCkge1xuICAgICAgcmVuZGVyQ2hhckNvdW50KCk7IC8vbWFrZSBzdXJlIGl0J3MgY2FsbGVkIHdpdGggbm8gYXJnc1xuICAgIH0pO1xuXG4gICAgc2NvcGUuJHdhdGNoKGF0dHIubWRNYXhsZW5ndGgsIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICBtYXhsZW5ndGggPSB2YWx1ZTtcbiAgICAgIGlmIChhbmd1bGFyLmlzTnVtYmVyKHZhbHVlKSAmJiB2YWx1ZSA+IDApIHtcbiAgICAgICAgaWYgKCFjaGFyQ291bnRFbC5wYXJlbnQoKS5sZW5ndGgpIHtcbiAgICAgICAgICAkYW5pbWF0ZS5lbnRlcihjaGFyQ291bnRFbCwgY29udGFpbmVyQ3RybC5lbGVtZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChjb250YWluZXJDdHJsLmVsZW1lbnRbMF0ubGFzdEVsZW1lbnRDaGlsZCkpO1xuICAgICAgICB9XG4gICAgICAgIHJlbmRlckNoYXJDb3VudCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJGFuaW1hdGUubGVhdmUoY2hhckNvdW50RWwpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgbmdNb2RlbEN0cmwuJHZhbGlkYXRvcnNbJ21kLW1heGxlbmd0aCddID0gZnVuY3Rpb24obW9kZWxWYWx1ZSwgdmlld1ZhbHVlKSB7XG4gICAgICBpZiAoIWFuZ3VsYXIuaXNOdW1iZXIobWF4bGVuZ3RoKSB8fCBtYXhsZW5ndGggPCAwKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgICAgcmV0dXJuICggbW9kZWxWYWx1ZSB8fCBlbGVtZW50LnZhbCgpIHx8IHZpZXdWYWx1ZSB8fCAnJyApLmxlbmd0aCA8PSBtYXhsZW5ndGg7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIHJlbmRlckNoYXJDb3VudCh2YWx1ZSkge1xuICAgICAgY2hhckNvdW50RWwudGV4dCggKCBlbGVtZW50LnZhbCgpIHx8IHZhbHVlIHx8ICcnICkubGVuZ3RoICsgJy8nICsgbWF4bGVuZ3RoICk7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICB9XG59XG5tZE1heGxlbmd0aERpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJGFuaW1hdGVcIl07XG5cbmZ1bmN0aW9uIHBsYWNlaG9sZGVyRGlyZWN0aXZlKCRsb2cpIHtcbiAgdmFyIGJsYWNrTGlzdEVsZW1lbnRzID0gWydNRC1TRUxFQ1QnXTtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIHJlcXVpcmU6ICdeXj9tZElucHV0Q29udGFpbmVyJyxcbiAgICBwcmlvcml0eTogMjAwLFxuICAgIGxpbms6IHBvc3RMaW5rXG4gIH07XG5cbiAgZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGlucHV0Q29udGFpbmVyKSB7XG4gICAgaWYgKCFpbnB1dENvbnRhaW5lcikgcmV0dXJuO1xuICAgIGlmIChibGFja0xpc3RFbGVtZW50cy5pbmRleE9mKGVsZW1lbnRbMF0ubm9kZU5hbWUpICE9IC0xKSByZXR1cm47XG4gICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKGlucHV0Q29udGFpbmVyLmVsZW1lbnQuYXR0cignbWQtbm8tZmxvYXQnKSkpIHJldHVybjtcblxuICAgIHZhciBwbGFjZWhvbGRlclRleHQgPSBhdHRyLnBsYWNlaG9sZGVyO1xuICAgIGVsZW1lbnQucmVtb3ZlQXR0cigncGxhY2Vob2xkZXInKTtcblxuICAgIGlmICggaW5wdXRDb250YWluZXIuZWxlbWVudC5maW5kKCdsYWJlbCcpLmxlbmd0aCA9PSAwICkge1xuICAgICAgdmFyIHBsYWNlaG9sZGVyID0gJzxsYWJlbCBuZy1jbGljaz1cImRlbGVnYXRlQ2xpY2soKVwiPicgKyBwbGFjZWhvbGRlclRleHQgKyAnPC9sYWJlbD4nO1xuXG4gICAgICBpbnB1dENvbnRhaW5lci5lbGVtZW50LmFkZENsYXNzKCdtZC1pY29uLWZsb2F0Jyk7XG4gICAgICBpbnB1dENvbnRhaW5lci5lbGVtZW50LnByZXBlbmQocGxhY2Vob2xkZXIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAkbG9nLndhcm4oXCJUaGUgcGxhY2Vob2xkZXI9J1wiICsgcGxhY2Vob2xkZXJUZXh0ICsgXCInIHdpbGwgYmUgaWdub3JlZCBzaW5jZSB0aGlzIG1kLWlucHV0LWNvbnRhaW5lciBoYXMgYSBjaGlsZCBsYWJlbCBlbGVtZW50LlwiKTtcbiAgICB9XG5cbiAgfVxufVxucGxhY2Vob2xkZXJEaXJlY3RpdmUuJGluamVjdCA9IFtcIiRsb2dcIl07XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIEBuZ2RvYyBtb2R1bGVcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMubGlzdFxuICogQGRlc2NyaXB0aW9uXG4gKiBMaXN0IG1vZHVsZVxuICovXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5saXN0JywgW1xuICAnbWF0ZXJpYWwuY29yZSdcbl0pXG4gIC5jb250cm9sbGVyKCdNZExpc3RDb250cm9sbGVyJywgTWRMaXN0Q29udHJvbGxlcilcbiAgLmRpcmVjdGl2ZSgnbWRMaXN0JywgbWRMaXN0RGlyZWN0aXZlKVxuICAuZGlyZWN0aXZlKCdtZExpc3RJdGVtJywgbWRMaXN0SXRlbURpcmVjdGl2ZSk7XG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbWRMaXN0XG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMubGlzdFxuICpcbiAqIEByZXN0cmljdCBFXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBUaGUgYDxtZC1saXN0PmAgZGlyZWN0aXZlIGlzIGEgbGlzdCBjb250YWluZXIgZm9yIDEuLm4gYDxtZC1saXN0LWl0ZW0+YCB0YWdzLlxuICpcbiAqIEB1c2FnZVxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cbiAqIDxtZC1saXN0PlxuICogICA8bWQtbGlzdC1pdGVtIGNsYXNzPVwibWQtMi1saW5lXCIgbmctcmVwZWF0PVwiaXRlbSBpbiB0b2Rvc1wiPlxuICogICAgIDxtZC1jaGVja2JveCBuZy1tb2RlbD1cIml0ZW0uZG9uZVwiPjwvbWQtY2hlY2tib3g+XG4gKiAgICAgPGRpdiBjbGFzcz1cIm1kLWxpc3QtaXRlbS10ZXh0XCI+XG4gKiAgICAgICA8aDM+e3tpdGVtLnRpdGxlfX08L2gzPlxuICogICAgICAgPHA+e3tpdGVtLmRlc2NyaXB0aW9ufX08L3A+XG4gKiAgICAgPC9kaXY+XG4gKiAgIDwvbWQtbGlzdC1pdGVtPlxuICogPC9tZC1saXN0PlxuICogPC9obGpzPlxuICovXG5cbmZ1bmN0aW9uIG1kTGlzdERpcmVjdGl2ZSgkbWRUaGVtaW5nKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdFJyxcbiAgICBjb21waWxlOiBmdW5jdGlvbih0RWwpIHtcbiAgICAgIHRFbFswXS5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnbGlzdCcpO1xuICAgICAgcmV0dXJuICRtZFRoZW1pbmc7XG4gICAgfVxuICB9O1xufVxubWRMaXN0RGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkbWRUaGVtaW5nXCJdO1xuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBtZExpc3RJdGVtXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMubGlzdFxuICpcbiAqIEByZXN0cmljdCBFXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBUaGUgYDxtZC1saXN0LWl0ZW0+YCBkaXJlY3RpdmUgaXMgYSBjb250YWluZXIgaW50ZW5kZWQgZm9yIHJvdyBpdGVtcyBpbiBhIGA8bWQtbGlzdD5gIGNvbnRhaW5lci5cbiAqXG4gKiBAdXNhZ2VcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiAgPG1kLWxpc3Q+XG4gKiAgICA8bWQtbGlzdC1pdGVtPlxuICogICAgICAgICAgICBJdGVtIGNvbnRlbnQgaW4gbGlzdFxuICogICAgPC9tZC1saXN0LWl0ZW0+XG4gKiAgPC9tZC1saXN0PlxuICogPC9obGpzPlxuICpcbiAqL1xuZnVuY3Rpb24gbWRMaXN0SXRlbURpcmVjdGl2ZSgkbWRBcmlhLCAkbWRDb25zdGFudCwgJHRpbWVvdXQpIHtcbiAgdmFyIHByb3hpZWRUeXBlcyA9IFsnbWQtY2hlY2tib3gnLCAnbWQtc3dpdGNoJ107XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdFJyxcbiAgICBjb250cm9sbGVyOiAnTWRMaXN0Q29udHJvbGxlcicsXG4gICAgY29tcGlsZTogZnVuY3Rpb24odEVsLCB0QXR0cnMpIHtcbiAgICAgIC8vIENoZWNrIGZvciBwcm94eSBjb250cm9scyAobm8gbmctY2xpY2sgb24gcGFyZW50LCBhbmQgYSBjb250cm9sIGluc2lkZSlcbiAgICAgIHZhciBzZWNvbmRhcnlJdGVtID0gdEVsWzBdLnF1ZXJ5U2VsZWN0b3IoJy5tZC1zZWNvbmRhcnknKTtcbiAgICAgIHZhciBoYXNQcm94aWVkRWxlbWVudDtcbiAgICAgIHZhciBwcm94eUVsZW1lbnQ7XG5cbiAgICAgIHRFbFswXS5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnbGlzdGl0ZW0nKTtcblxuICAgICAgaWYgKCF0QXR0cnMubmdDbGljaykge1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgdHlwZTsgdHlwZSA9IHByb3hpZWRUeXBlc1tpXTsgKytpKSB7XG4gICAgICAgICAgaWYgKHByb3h5RWxlbWVudCA9IHRFbFswXS5xdWVyeVNlbGVjdG9yKHR5cGUpKSB7XG4gICAgICAgICAgICBoYXNQcm94aWVkRWxlbWVudCA9IHRydWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGhhc1Byb3hpZWRFbGVtZW50KSB7XG4gICAgICAgICAgd3JhcEluKCdkaXYnKTtcbiAgICAgICAgfSBlbHNlIGlmICghdEVsWzBdLnF1ZXJ5U2VsZWN0b3IoJ21kLWJ1dHRvbicpKSB7XG4gICAgICAgICAgdEVsLmFkZENsYXNzKCdtZC1uby1wcm94eScpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB3cmFwSW4oJ2J1dHRvbicpO1xuICAgICAgfVxuICAgICAgc2V0dXBUb2dnbGVBcmlhKCk7XG5cblxuICAgICAgZnVuY3Rpb24gc2V0dXBUb2dnbGVBcmlhKCkge1xuICAgICAgICB2YXIgdG9nZ2xlVHlwZXMgPSBbJ21kLXN3aXRjaCcsICdtZC1jaGVja2JveCddO1xuICAgICAgICB2YXIgdG9nZ2xlO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCB0b2dnbGVUeXBlOyB0b2dnbGVUeXBlID0gdG9nZ2xlVHlwZXNbaV07ICsraSkge1xuICAgICAgICAgIGlmICh0b2dnbGUgPSB0RWwuZmluZCh0b2dnbGVUeXBlKVswXSkge1xuICAgICAgICAgICAgaWYgKCF0b2dnbGUuaGFzQXR0cmlidXRlKCdhcmlhLWxhYmVsJykpIHtcbiAgICAgICAgICAgICAgdmFyIHAgPSB0RWwuZmluZCgncCcpWzBdO1xuICAgICAgICAgICAgICBpZiAoIXApIHJldHVybjtcbiAgICAgICAgICAgICAgdG9nZ2xlLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdUb2dnbGUgJyArIHAudGV4dENvbnRlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiB3cmFwSW4odHlwZSkge1xuICAgICAgICB2YXIgY29udGFpbmVyO1xuICAgICAgICBpZiAodHlwZSA9PSAnZGl2Jykge1xuICAgICAgICAgIGNvbnRhaW5lciA9IGFuZ3VsYXIuZWxlbWVudCgnPGRpdiBjbGFzcz1cIm1kLW5vLXN0eWxlIG1kLWxpc3QtaXRlbS1pbm5lclwiPicpO1xuICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmQodEVsLmNvbnRlbnRzKCkpO1xuICAgICAgICAgIHRFbC5hZGRDbGFzcygnbWQtcHJveHktZm9jdXMnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb250YWluZXIgPSBhbmd1bGFyLmVsZW1lbnQoJzxtZC1idXR0b24gY2xhc3M9XCJtZC1uby1zdHlsZVwiPjxkaXYgY2xhc3M9XCJtZC1saXN0LWl0ZW0taW5uZXJcIj48L2Rpdj48L21kLWJ1dHRvbj4nKTtcbiAgICAgICAgICB2YXIgY29waWVkQXR0cnMgPSBbJ25nLWNsaWNrJywgJ2FyaWEtbGFiZWwnLCAnbmctZGlzYWJsZWQnXTtcbiAgICAgICAgICBhbmd1bGFyLmZvckVhY2goY29waWVkQXR0cnMsIGZ1bmN0aW9uKGF0dHIpIHtcbiAgICAgICAgICAgIGlmICh0RWxbMF0uaGFzQXR0cmlidXRlKGF0dHIpKSB7XG4gICAgICAgICAgICAgIGNvbnRhaW5lclswXS5zZXRBdHRyaWJ1dGUoYXR0ciwgdEVsWzBdLmdldEF0dHJpYnV0ZShhdHRyKSk7XG4gICAgICAgICAgICAgIHRFbFswXS5yZW1vdmVBdHRyaWJ1dGUoYXR0cik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY29udGFpbmVyLmNoaWxkcmVuKCkuZXEoMCkuYXBwZW5kKHRFbC5jb250ZW50cygpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRFbFswXS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XG4gICAgICAgIHRFbC5hcHBlbmQoY29udGFpbmVyKTtcblxuICAgICAgICBpZiAoc2Vjb25kYXJ5SXRlbSAmJiBzZWNvbmRhcnlJdGVtLmhhc0F0dHJpYnV0ZSgnbmctY2xpY2snKSkge1xuICAgICAgICAgICRtZEFyaWEuZXhwZWN0KHNlY29uZGFyeUl0ZW0sICdhcmlhLWxhYmVsJyk7XG4gICAgICAgICAgdmFyIGJ1dHRvbldyYXBwZXIgPSBhbmd1bGFyLmVsZW1lbnQoJzxtZC1idXR0b24gY2xhc3M9XCJtZC1zZWNvbmRhcnktY29udGFpbmVyIG1kLWljb24tYnV0dG9uXCI+Jyk7XG4gICAgICAgICAgYnV0dG9uV3JhcHBlci5hdHRyKCduZy1jbGljaycsIHNlY29uZGFyeUl0ZW0uZ2V0QXR0cmlidXRlKCduZy1jbGljaycpKTtcbiAgICAgICAgICBzZWNvbmRhcnlJdGVtLnJlbW92ZUF0dHJpYnV0ZSgnbmctY2xpY2snKTtcbiAgICAgICAgICBzZWNvbmRhcnlJdGVtLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnLTEnKTtcbiAgICAgICAgICBzZWNvbmRhcnlJdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ21kLXNlY29uZGFyeScpO1xuICAgICAgICAgIGJ1dHRvbldyYXBwZXIuYXBwZW5kKHNlY29uZGFyeUl0ZW0pO1xuICAgICAgICAgIHNlY29uZGFyeUl0ZW0gPSBidXR0b25XcmFwcGVyWzBdO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgZm9yIGEgc2Vjb25kYXJ5IGl0ZW0gYW5kIG1vdmUgaXQgb3V0c2lkZVxuICAgICAgICBpZiAoIHNlY29uZGFyeUl0ZW0gJiYgKFxuICAgICAgICAgIHNlY29uZGFyeUl0ZW0uaGFzQXR0cmlidXRlKCduZy1jbGljaycpIHx8XG4gICAgICAgICAgICAoIHRBdHRycy5uZ0NsaWNrICYmXG4gICAgICAgICAgICAgaXNQcm94aWVkRWxlbWVudChzZWNvbmRhcnlJdGVtKSApXG4gICAgICAgICkpIHtcbiAgICAgICAgICB0RWwuYWRkQ2xhc3MoJ21kLXdpdGgtc2Vjb25kYXJ5Jyk7XG4gICAgICAgICAgdEVsLmFwcGVuZChzZWNvbmRhcnlJdGVtKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBpc1Byb3hpZWRFbGVtZW50KGVsKSB7XG4gICAgICAgIHJldHVybiBwcm94aWVkVHlwZXMuaW5kZXhPZihlbC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpKSAhPSAtMTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHBvc3RMaW5rO1xuXG4gICAgICBmdW5jdGlvbiBwb3N0TGluaygkc2NvcGUsICRlbGVtZW50LCAkYXR0ciwgY3RybCkge1xuXG4gICAgICAgIHZhciBwcm94aWVzICAgID0gW10sXG4gICAgICAgICAgICBmaXJzdENoaWxkID0gJGVsZW1lbnRbMF0uZmlyc3RFbGVtZW50Q2hpbGQsXG4gICAgICAgICAgICBoYXNDbGljayAgID0gZmlyc3RDaGlsZCAmJiBmaXJzdENoaWxkLmhhc0F0dHJpYnV0ZSgnbmctY2xpY2snKTtcblxuICAgICAgICBjb21wdXRlUHJveGllcygpO1xuICAgICAgICBjb21wdXRlQ2xpY2thYmxlKCk7XG5cbiAgICAgICAgaWYgKCRlbGVtZW50Lmhhc0NsYXNzKCdtZC1wcm94eS1mb2N1cycpICYmIHByb3hpZXMubGVuZ3RoKSB7XG4gICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHByb3hpZXMsIGZ1bmN0aW9uKHByb3h5KSB7XG4gICAgICAgICAgICBwcm94eSA9IGFuZ3VsYXIuZWxlbWVudChwcm94eSk7XG5cbiAgICAgICAgICAgICRzY29wZS5tb3VzZUFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgcHJveHkub24oJ21vdXNlZG93bicsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAkc2NvcGUubW91c2VBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICRzY29wZS5tb3VzZUFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICB9LCAxMDApO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5vbignZm9jdXMnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgaWYgKCRzY29wZS5tb3VzZUFjdGl2ZSA9PT0gZmFsc2UpIHsgJGVsZW1lbnQuYWRkQ2xhc3MoJ21kLWZvY3VzZWQnKTsgfVxuICAgICAgICAgICAgICBwcm94eS5vbignYmx1cicsIGZ1bmN0aW9uIHByb3h5T25CbHVyKCkge1xuICAgICAgICAgICAgICAgICRlbGVtZW50LnJlbW92ZUNsYXNzKCdtZC1mb2N1c2VkJyk7XG4gICAgICAgICAgICAgICAgcHJveHkub2ZmKCdibHVyJywgcHJveHlPbkJsdXIpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY29tcHV0ZVByb3hpZXMoKSB7XG4gICAgICAgICAgdmFyIGNoaWxkcmVuID0gJGVsZW1lbnQuY2hpbGRyZW4oKTtcbiAgICAgICAgICBpZiAoY2hpbGRyZW4ubGVuZ3RoICYmICFjaGlsZHJlblswXS5oYXNBdHRyaWJ1dGUoJ25nLWNsaWNrJykpIHtcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChwcm94aWVkVHlwZXMsIGZ1bmN0aW9uKHR5cGUpIHtcbiAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGZpcnN0Q2hpbGQucXVlcnlTZWxlY3RvckFsbCh0eXBlKSwgZnVuY3Rpb24oY2hpbGQpIHtcbiAgICAgICAgICAgICAgICBwcm94aWVzLnB1c2goY2hpbGQpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjb21wdXRlQ2xpY2thYmxlKCkge1xuICAgICAgICAgIGlmIChwcm94aWVzLmxlbmd0aCB8fCBoYXNDbGljaykge1xuICAgICAgICAgICAgJGVsZW1lbnQuYWRkQ2xhc3MoJ21kLWNsaWNrYWJsZScpO1xuXG4gICAgICAgICAgICBjdHJsLmF0dGFjaFJpcHBsZSgkc2NvcGUsIGFuZ3VsYXIuZWxlbWVudCgkZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCcubWQtbm8tc3R5bGUnKSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghaGFzQ2xpY2sgJiYgIXByb3hpZXMubGVuZ3RoKSB7XG4gICAgICAgICAgZmlyc3RDaGlsZCAmJiBmaXJzdENoaWxkLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgaWYgKGUudGFyZ2V0Lm5vZGVOYW1lICE9ICdJTlBVVCcgJiYgZS50YXJnZXQubm9kZU5hbWUgIT0gJ1RFWFRBUkVBJykge1xuICAgICAgICAgICAgICB2YXIga2V5Q29kZSA9IGUud2hpY2ggfHwgZS5rZXlDb2RlO1xuICAgICAgICAgICAgICBpZiAoa2V5Q29kZSA9PSAkbWRDb25zdGFudC5LRVlfQ09ERS5TUEFDRSkge1xuICAgICAgICAgICAgICAgIGlmIChmaXJzdENoaWxkKSB7XG4gICAgICAgICAgICAgICAgICBmaXJzdENoaWxkLmNsaWNrKCk7XG4gICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgJGVsZW1lbnQub2ZmKCdjbGljaycpO1xuICAgICAgICAkZWxlbWVudC5vZmYoJ2tleXByZXNzJyk7XG5cbiAgICAgICAgaWYgKHByb3hpZXMubGVuZ3RoICYmIGZpcnN0Q2hpbGQpIHtcbiAgICAgICAgICAkZWxlbWVudC5jaGlsZHJlbigpLmVxKDApLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGlmIChmaXJzdENoaWxkLmNvbnRhaW5zKGUudGFyZ2V0KSkge1xuICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2gocHJveGllcywgZnVuY3Rpb24ocHJveHkpIHtcbiAgICAgICAgICAgICAgICBpZiAoZS50YXJnZXQgIT09IHByb3h5ICYmICFwcm94eS5jb250YWlucyhlLnRhcmdldCkpIHtcbiAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChwcm94eSkudHJpZ2dlckhhbmRsZXIoJ2NsaWNrJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cbm1kTGlzdEl0ZW1EaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZEFyaWFcIiwgXCIkbWRDb25zdGFudFwiLCBcIiR0aW1lb3V0XCJdO1xuXG4vKlxuICogQHByaXZhdGVcbiAqIEBuZ2RvYyBjb250cm9sbGVyXG4gKiBAbmFtZSBNZExpc3RDb250cm9sbGVyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMubGlzdFxuICpcbiAqL1xuZnVuY3Rpb24gTWRMaXN0Q29udHJvbGxlcigkc2NvcGUsICRlbGVtZW50LCAkbWRMaXN0SW5rUmlwcGxlKSB7XG4gIHZhciBjdHJsID0gdGhpcztcbiAgY3RybC5hdHRhY2hSaXBwbGUgPSBhdHRhY2hSaXBwbGU7XG5cbiAgZnVuY3Rpb24gYXR0YWNoUmlwcGxlIChzY29wZSwgZWxlbWVudCkge1xuICAgIHZhciBvcHRpb25zID0ge307XG4gICAgJG1kTGlzdElua1JpcHBsZS5hdHRhY2goc2NvcGUsIGVsZW1lbnQsIG9wdGlvbnMpO1xuICB9XG59XG5NZExpc3RDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkZWxlbWVudFwiLCBcIiRtZExpc3RJbmtSaXBwbGVcIl07XG5cblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogQG5nZG9jIG1vZHVsZVxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5tZW51XG4gKi9cblxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMubWVudScsIFtcbiAgJ21hdGVyaWFsLmNvcmUnLFxuICAnbWF0ZXJpYWwuY29tcG9uZW50cy5iYWNrZHJvcCdcbl0pXG4uZGlyZWN0aXZlKCdtZE1lbnUnLCBNZW51RGlyZWN0aXZlKVxuLmNvbnRyb2xsZXIoJ21kTWVudUN0cmwnLCBNZW51Q29udHJvbGxlcik7XG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbWRNZW51XG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMubWVudVxuICogQHJlc3RyaWN0IEVcbiAqIEBkZXNjcmlwdGlvblxuICpcbiAqIE1lbnVzIGFyZSBlbGVtZW50cyB0aGF0IG9wZW4gd2hlbiBjbGlja2VkLiBUaGV5IGFyZSB1c2VmdWwgZm9yIGRpc3BsYXlpbmdcbiAqIGFkZGl0aW9uYWwgb3B0aW9ucyB3aXRoaW4gdGhlIGNvbnRleHQgb2YgYW4gYWN0aW9uLlxuICpcbiAqIEV2ZXJ5IGBtZC1tZW51YCBtdXN0IHNwZWNpZnkgZXhhY3RseSB0d28gY2hpbGQgZWxlbWVudHMuIFRoZSBmaXJzdCBlbGVtZW50IGlzIHdoYXQgaXNcbiAqIGxlZnQgaW4gdGhlIERPTSBhbmQgaXMgdXNlZCB0byBvcGVuIHRoZSBtZW51LiBUaGlzIGVsZW1lbnQgaXMgY2FsbGVkIHRoZSB0cmlnZ2VyIGVsZW1lbnQuXG4gKiBUaGUgdHJpZ2dlciBlbGVtZW50J3Mgc2NvcGUgaGFzIGFjY2VzcyB0byBgJG1kT3Blbk1lbnUoJGV2ZW50KWBcbiAqIHdoaWNoIGl0IG1heSBjYWxsIHRvIG9wZW4gdGhlIG1lbnUuIEJ5IHBhc3NpbmcgJGV2ZW50IGFzIGFyZ3VtZW50LCB0aGVcbiAqIGNvcnJlc3BvbmRpbmcgZXZlbnQgaXMgc3RvcHBlZCBmcm9tIHByb3BhZ2F0aW5nIHVwIHRoZSBET00tdHJlZS5cbiAqXG4gKiBUaGUgc2Vjb25kIGVsZW1lbnQgaXMgdGhlIGBtZC1tZW51LWNvbnRlbnRgIGVsZW1lbnQgd2hpY2ggcmVwcmVzZW50cyB0aGVcbiAqIGNvbnRlbnRzIG9mIHRoZSBtZW51IHdoZW4gaXQgaXMgb3Blbi4gVHlwaWNhbGx5IHRoaXMgd2lsbCBjb250YWluIGBtZC1tZW51LWl0ZW1gcyxcbiAqIGJ1dCB5b3UgY2FuIGRvIGN1c3RvbSBjb250ZW50IGFzIHdlbGwuXG4gKlxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cbiAqIDxtZC1tZW51PlxuICogIDwhLS0gVHJpZ2dlciBlbGVtZW50IGlzIGEgbWQtYnV0dG9uIHdpdGggYW4gaWNvbiAtLT5cbiAqICA8bWQtYnV0dG9uIG5nLWNsaWNrPVwiJG1kT3Blbk1lbnUoJGV2ZW50KVwiIGNsYXNzPVwibWQtaWNvbi1idXR0b25cIiBhcmlhLWxhYmVsPVwiT3BlbiBzYW1wbGUgbWVudVwiPlxuICogICAgPG1kLWljb24gbWQtc3ZnLWljb249XCJjYWxsOnBob25lXCI+PC9tZC1pY29uPlxuICogIDwvbWQtYnV0dG9uPlxuICogIDxtZC1tZW51LWNvbnRlbnQ+XG4gKiAgICA8bWQtbWVudS1pdGVtPjxtZC1idXR0b24gbmctY2xpY2s9XCJkb1NvbWV0aGluZygpXCI+RG8gU29tZXRoaW5nPC9tZC1idXR0b24+PC9tZC1tZW51LWl0ZW0+XG4gKiAgPC9tZC1tZW51LWNvbnRlbnQ+XG4gKiA8L21kLW1lbnU+XG4gKiA8L2hsanM+XG5cbiAqICMjIFNpemluZyBNZW51c1xuICpcbiAqIFRoZSB3aWR0aCBvZiB0aGUgbWVudSB3aGVuIGl0IGlzIG9wZW4gbWF5IGJlIHNwZWNpZmllZCBieSBzcGVjaWZ5aW5nIGEgYHdpZHRoYFxuICogYXR0cmlidXRlIG9uIHRoZSBgbWQtbWVudS1jb250ZW50YCBlbGVtZW50LlxuICogU2VlIHRoZSBbTWF0ZXJpYWwgRGVzaWduIFNwZWNdKGh0dHA6Ly93d3cuZ29vZ2xlLmNvbS9kZXNpZ24vc3BlYy9jb21wb25lbnRzL21lbnVzLmh0bWwjbWVudXMtc3BlY3MpXG4gKiBmb3IgbW9yZSBpbmZvcm1hdGlvbi5cbiAqXG4gKlxuICogIyMgQWxpZ25pbmcgTWVudXNcbiAqXG4gKiBXaGVuIGEgbWVudSBvcGVucywgaXQgaXMgaW1wb3J0YW50IHRoYXQgdGhlIGNvbnRlbnQgYWxpZ25zIHdpdGggdGhlIHRyaWdnZXIgZWxlbWVudC5cbiAqIEZhaWx1cmUgdG8gYWxpZ24gbWVudXMgY2FuIHJlc3VsdCBpbiBqYXJyaW5nIGV4cGVyaWVuY2VzIGZvciB1c2VycyBhcyBjb250ZW50XG4gKiBzdWRkZW5seSBzaGlmdHMuIFRvIGhlbHAgd2l0aCB0aGlzLCBgbWQtbWVudWAgcHJvdmlkZXMgc2VydmVyYWwgQVBJcyB0byBoZWxwXG4gKiB3aXRoIGFsaWdubWVudC5cbiAqXG4gKiAjIyMgVGFyZ2V0IE1vZGVcbiAqXG4gKiBCeSBkZWZhdWx0LCBgbWQtbWVudWAgd2lsbCBhdHRlbXB0IHRvIGFsaWduIHRoZSBgbWQtbWVudS1jb250ZW50YCBieSBhbGlnbmluZ1xuICogZGVzaWduYXRlZCBjaGlsZCBlbGVtZW50cyBpbiBib3RoIHRoZSB0cmlnZ2VyIGFuZCB0aGUgbWVudSBjb250ZW50LlxuICpcbiAqIFRvIHNwZWNpZnkgdGhlIGFsaWdubWVudCBlbGVtZW50IGluIHRoZSBgdHJpZ2dlcmAgeW91IGNhbiB1c2UgdGhlIGBtZC1tZW51LW9yaWdpbmBcbiAqIGF0dHJpYnV0ZSBvbiBhIGNoaWxkIGVsZW1lbnQuIElmIG5vIGBtZC1tZW51LW9yaWdpbmAgaXMgc3BlY2lmaWVkLCB0aGUgYG1kLW1lbnVgXG4gKiB3aWxsIGJlIHVzZWQgYXMgdGhlIG9yaWdpbiBlbGVtZW50LlxuICpcbiAqIFNpbWlsYXJseSwgdGhlIGBtZC1tZW51LWNvbnRlbnRgIG1heSBzcGVjaWZ5IGEgYG1kLW1lbnUtYWxpZ24tdGFyZ2V0YCBmb3IgYVxuICogYG1kLW1lbnUtaXRlbWAgdG8gc3BlY2lmeSB0aGUgbm9kZSB0aGF0IGl0IHNob3VsZCB0cnkgYW5kIGFsaWduIHdpdGguXG4gKlxuICogSW4gdGhpcyBleGFtcGxlIGNvZGUsIHdlIHNwZWNpZnkgYW4gaWNvbiB0byBiZSBvdXIgb3JpZ2luIGVsZW1lbnQsIGFuZCBhblxuICogaWNvbiBpbiBvdXIgbWVudSBjb250ZW50IHRvIGJlIG91ciBhbGlnbm1lbnQgdGFyZ2V0LiBUaGlzIGVuc3VyZXMgdGhhdCBib3RoXG4gKiBpY29ucyBhcmUgYWxpZ25lZCB3aGVuIHRoZSBtZW51IG9wZW5zLlxuICpcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiA8bWQtbWVudT5cbiAqICA8bWQtYnV0dG9uIG5nLWNsaWNrPVwiJG1kT3Blbk1lbnUoJGV2ZW50KVwiIGNsYXNzPVwibWQtaWNvbi1idXR0b25cIiBhcmlhLWxhYmVsPVwiT3BlbiBzb21lIG1lbnVcIj5cbiAqICAgIDxtZC1pY29uIG1kLW1lbnUtb3JpZ2luIG1kLXN2Zy1pY29uPVwiY2FsbDpwaG9uZVwiPjwvbWQtaWNvbj5cbiAqICA8L21kLWJ1dHRvbj5cbiAqICA8bWQtbWVudS1jb250ZW50PlxuICogICAgPG1kLW1lbnUtaXRlbT5cbiAqICAgICAgPG1kLWJ1dHRvbiBuZy1jbGljaz1cImRvU29tZXRoaW5nKClcIiBhcmlhLWxhYmVsPVwiRG8gc29tZXRoaW5nXCI+XG4gKiAgICAgICAgPG1kLWljb24gbWQtbWVudS1hbGlnbi10YXJnZXQgbWQtc3ZnLWljb249XCJjYWxsOnBob25lXCI+PC9tZC1pY29uPlxuICogICAgICAgIERvIFNvbWV0aGluZ1xuICogICAgICA8L21kLWJ1dHRvbj5cbiAqICAgIDwvbWQtbWVudS1pdGVtPlxuICogIDwvbWQtbWVudS1jb250ZW50PlxuICogPC9tZC1tZW51PlxuICogPC9obGpzPlxuICpcbiAqIFNvbWV0aW1lcyB3ZSB3YW50IHRvIHNwZWNpZnkgYWxpZ25tZW50IG9uIHRoZSByaWdodCBzaWRlIG9mIGFuIGVsZW1lbnQsIGZvciBleGFtcGxlXG4gKiBpZiB3ZSBoYXZlIGEgbWVudSBvbiB0aGUgcmlnaHQgc2lkZSBhIHRvb2xiYXIsIHdlIHdhbnQgdG8gcmlnaHQgYWxpZ24gb3VyIG1lbnUgY29udGVudC5cbiAqXG4gKiBXZSBjYW4gc3BlY2lmeSB0aGUgb3JpZ2luIGJ5IHVzaW5nIHRoZSBgbWQtcG9zaXRpb24tbW9kZWAgYXR0cmlidXRlIG9uIGJvdGhcbiAqIHRoZSBgeGAgYW5kIGB5YCBheGlzLiBSaWdodCBub3cgb25seSB0aGUgYHgtYXhpc2AgaGFzIG1vcmUgdGhhbiBvbmUgb3B0aW9uLlxuICogWW91IG1heSBzcGVjaWZ5IHRoZSBkZWZhdWx0IG1vZGUgb2YgYHRhcmdldCB0YXJnZXRgIG9yXG4gKiBgdGFyZ2V0LXJpZ2h0IHRhcmdldGAgdG8gc3BlY2lmeSBhIHJpZ2h0LW9yaWVudGVkIGFsaWdubWVudCB0YXJnZXQuIFNlZSB0aGVcbiAqIHBvc2l0aW9uIHNlY3Rpb24gb2YgdGhlIGRlbW9zIGZvciBtb3JlIGV4YW1wbGVzLlxuICpcbiAqICMjIyBNZW51IE9mZnNldHNcbiAqXG4gKiBJdCBpcyBzb21ldGltZXMgdW5hdm9pZGFibGUgdG8gbmVlZCB0byBoYXZlIGEgZGVlcGVyIGxldmVsIG9mIGNvbnRyb2wgZm9yXG4gKiB0aGUgcG9zaXRpb25pbmcgb2YgYSBtZW51IHRvIGVuc3VyZSBwZXJmZWN0IGFsaWdubWVudC4gYG1kLW1lbnVgIHByb3ZpZGVzXG4gKiB0aGUgYG1kLW9mZnNldGAgYXR0cmlidXRlIHRvIGFsbG93IHBpeGVsIGxldmVsIHNwZWNpZmljdHkgb2YgYWRqdXN0aW5nIHRoZVxuICogZXhhY3QgcG9zaXRpb25pbmcuXG4gKlxuICogVGhpcyBvZmZzZXQgaXMgcHJvdmlkZWQgaW4gdGhlIGZvcm1hdCBvZiBgeCB5YCBvciBgbmAgd2hlcmUgYG5gIHdpbGwgYmUgdXNlZFxuICogaW4gYm90aCB0aGUgYHhgIGFuZCBgeWAgYXhpcy5cbiAqXG4gKiBGb3IgZXhhbXBsZSwgdG8gbW92ZSBhIG1lbnUgYnkgYDJweGAgZnJvbSB0aGUgdG9wLCB3ZSBjYW4gdXNlOlxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cbiAqIDxtZC1tZW51IG1kLW9mZnNldD1cIjIgMFwiPlxuICogICA8IS0tIG1lbnUtY29udGVudCAtLT5cbiAqIDwvbWQtbWVudT5cbiAqIDwvaGxqcz5cbiAqXG4gKiBAdXNhZ2VcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiA8bWQtbWVudT5cbiAqICA8bWQtYnV0dG9uIG5nLWNsaWNrPVwiJG1kT3Blbk1lbnUoJGV2ZW50KVwiIGNsYXNzPVwibWQtaWNvbi1idXR0b25cIj5cbiAqICAgIDxtZC1pY29uIG1kLXN2Zy1pY29uPVwiY2FsbDpwaG9uZVwiPjwvbWQtaWNvbj5cbiAqICA8L21kLWJ1dHRvbj5cbiAqICA8bWQtbWVudS1jb250ZW50PlxuICogICAgPG1kLW1lbnUtaXRlbT48bWQtYnV0dG9uIG5nLWNsaWNrPVwiZG9Tb21ldGhpbmcoKVwiPkRvIFNvbWV0aGluZzwvbWQtYnV0dG9uPjwvbWQtbWVudS1pdGVtPlxuICogIDwvbWQtbWVudS1jb250ZW50PlxuICogPC9tZC1tZW51PlxuICogPC9obGpzPlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZC1wb3NpdGlvbi1tb2RlIFRoZSBwb3NpdGlvbiBtb2RlIGluIHRoZSBmb3JtIG9mXG4gICAgICAgICAgICAgYHhgLCBgeWAuIERlZmF1bHQgdmFsdWUgaXMgYHRhcmdldGAsYHRhcmdldGAuIFJpZ2h0IG5vdyB0aGUgYHhgIGF4aXNcbiAgICAgICAgICAgICBhbHNvIHN1cHBwb3J0cyBgdGFyZ2V0LXJpZ2h0YC5cbiAqIEBwYXJhbSB7c3RyaW5nfSBtZC1vZmZzZXQgQW4gb2Zmc2V0IHRvIGFwcGx5IHRvIHRoZSBkcm9wZG93biBhZnRlciBwb3NpdGlvbmluZ1xuICAgICAgICAgICAgIGB4YCwgYHlgLiBEZWZhdWx0IHZhbHVlIGlzIGAwYCxgMGAuXG4gKlxuICovXG5cbmZ1bmN0aW9uIE1lbnVEaXJlY3RpdmUoJG1kTWVudSkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnRScsXG4gICAgcmVxdWlyZTogJ21kTWVudScsXG4gICAgY29udHJvbGxlcjogJ21kTWVudUN0cmwnLCAvLyBlbXB0eSBmdW5jdGlvbiB0byBiZSBidWlsdCBieSBsaW5rXG4gICAgc2NvcGU6IHRydWUsXG4gICAgY29tcGlsZTogY29tcGlsZVxuICB9O1xuXG4gIGZ1bmN0aW9uIGNvbXBpbGUodGVtcGxhdGVFbGVtZW50KSB7XG4gICAgdGVtcGxhdGVFbGVtZW50LmFkZENsYXNzKCdtZC1tZW51Jyk7XG4gICAgdmFyIHRyaWdnZXJFbGVtZW50ID0gdGVtcGxhdGVFbGVtZW50LmNoaWxkcmVuKClbMF07XG4gICAgaWYgKCF0cmlnZ2VyRWxlbWVudC5oYXNBdHRyaWJ1dGUoJ25nLWNsaWNrJykpIHtcbiAgICAgIHRyaWdnZXJFbGVtZW50ID0gdHJpZ2dlckVsZW1lbnQucXVlcnlTZWxlY3RvcignW25nLWNsaWNrXScpO1xuICAgIH1cbiAgICB0cmlnZ2VyRWxlbWVudCAmJiB0cmlnZ2VyRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGFzcG9wdXAnLCAndHJ1ZScpO1xuICAgIGlmICh0ZW1wbGF0ZUVsZW1lbnQuY2hpbGRyZW4oKS5sZW5ndGggIT0gMikge1xuICAgICAgdGhyb3cgRXJyb3IoJ0ludmFsaWQgSFRNTCBmb3IgbWQtbWVudS4gRXhwZWN0ZWQgdHdvIGNoaWxkcmVuIGVsZW1lbnRzLicpO1xuICAgIH1cbiAgICByZXR1cm4gbGluaztcbiAgfVxuXG4gIGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBtZE1lbnVDdHJsKSB7XG5cbiAgICAvLyBNb3ZlIGV2ZXJ5dGhpbmcgaW50byBhIG1kLW1lbnUtY29udGFpbmVyIGFuZCBwYXNzIGl0IHRvIHRoZSBjb250cm9sbGVyXG4gICAgdmFyIG1lbnVDb250YWluZXIgPSBhbmd1bGFyLmVsZW1lbnQoXG4gICAgICAnPGRpdiBjbGFzcz1cIm1kLW9wZW4tbWVudS1jb250YWluZXIgbWQtd2hpdGVmcmFtZS16MlwiPjwvZGl2PidcbiAgICApO1xuICAgIHZhciBtZW51Q29udGVudHMgPSBlbGVtZW50LmNoaWxkcmVuKClbMV07XG4gICAgbWVudUNvbnRhaW5lci5hcHBlbmQobWVudUNvbnRlbnRzKTtcbiAgICBtZE1lbnVDdHJsLmluaXQobWVudUNvbnRhaW5lcik7XG5cbiAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oKSB7XG4gICAgICBpZiAobWRNZW51Q3RybC5pc09wZW4pIHtcbiAgICAgICAgbWVudUNvbnRhaW5lci5yZW1vdmUoKTtcbiAgICAgICAgbWRNZW51Q3RybC5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gIH1cbn1cbk1lbnVEaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZE1lbnVcIl07XG5cbmZ1bmN0aW9uIE1lbnVDb250cm9sbGVyKCRtZE1lbnUsICRhdHRycywgJGVsZW1lbnQsICRzY29wZSkge1xuXG4gIHZhciBtZW51Q29udGFpbmVyO1xuICB2YXIgY3RybCA9IHRoaXM7XG4gIHZhciB0cmlnZ2VyRWxlbWVudDtcblxuICAvLyBDYWxsZWQgYnkgb3VyIGxpbmtpbmcgZm4gdG8gcHJvdmlkZSBhY2Nlc3MgdG8gdGhlIG1lbnUtY29udGVudFxuICAvLyBlbGVtZW50IHJlbW92ZWQgZHVyaW5nIGxpbmtcbiAgdGhpcy5pbml0ID0gZnVuY3Rpb24oc2V0TWVudUNvbnRhaW5lcikge1xuICAgIG1lbnVDb250YWluZXIgPSBzZXRNZW51Q29udGFpbmVyO1xuICAgIHRyaWdnZXJFbGVtZW50ID0gJGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignW25nLWNsaWNrXScpO1xuICB9O1xuXG4gIC8vIFVzZXMgdGhlICRtZE1lbnUgaW50ZXJpbSBlbGVtZW50IHNlcnZpY2UgdG8gb3BlbiB0aGUgbWVudSBjb250ZW50c1xuICB0aGlzLm9wZW4gPSBmdW5jdGlvbiBvcGVuTWVudShldikge1xuICAgIGV2ICYmIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgY3RybC5pc09wZW4gPSB0cnVlO1xuICAgIHRyaWdnZXJFbGVtZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICd0cnVlJyk7XG4gICAgJG1kTWVudS5zaG93KHtcbiAgICAgIG1kTWVudUN0cmw6IGN0cmwsXG4gICAgICBlbGVtZW50OiBtZW51Q29udGFpbmVyLFxuICAgICAgdGFyZ2V0OiAkZWxlbWVudFswXVxuICAgIH0pO1xuICB9O1xuICAvLyBFeHBvc2UgYSBvcGVuIGZ1bmN0aW9uIHRvIHRoZSBjaGlsZCBzY29wZSBmb3IgaHRtbCB0byB1c2VcbiAgJHNjb3BlLiRtZE9wZW5NZW51ID0gdGhpcy5vcGVuO1xuXG4gIC8vIFVzZSB0aGUgJG1kTWVudSBpbnRlcmltIGVsZW1lbnQgc2VydmljZSB0byBjbG9zZSB0aGUgbWVudSBjb250ZW50c1xuICB0aGlzLmNsb3NlID0gZnVuY3Rpb24gY2xvc2VNZW51KHNraXBGb2N1cykge1xuICAgIGN0cmwuaXNPcGVuID0gZmFsc2U7XG4gICAgdHJpZ2dlckVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XG4gICAgJG1kTWVudS5oaWRlKCk7XG5cbiAgICBpZiAoIXNraXBGb2N1cykge1xuICAgICAgJGVsZW1lbnQuY2hpbGRyZW4oKVswXS5mb2N1cygpO1xuICAgIH1cbiAgfTtcblxuICAvLyBCdWlsZCBhIG5pY2Ugb2JqZWN0IG91dCBvZiBvdXIgc3RyaW5nIGF0dHJpYnV0ZSB3aGljaCBzcGVjaWZpZXMgdGhlXG4gIC8vIHRhcmdldCBtb2RlIGZvciBsZWZ0IGFuZCB0b3AgcG9zaXRpb25pbmdcbiAgdGhpcy5wb3NpdGlvbk1vZGUgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgYXR0YWNobWVudCA9ICgkYXR0cnMubWRQb3NpdGlvbk1vZGUgfHwgJ3RhcmdldCcpLnNwbGl0KCcgJyk7XG5cbiAgICAvLyBJZiBhdHRhY2htZW50IGlzIGEgc2luZ2xlIGl0ZW0sIGR1cGxpY2F0ZSBpdCBmb3Igb3VyIHNlY29uZCB2YWx1ZS5cbiAgICAvLyBpZS4gJ3RhcmdldCcgLT4gJ3RhcmdldCB0YXJnZXQnXG4gICAgaWYgKGF0dGFjaG1lbnQubGVuZ3RoID09IDEpIHtcbiAgICAgIGF0dGFjaG1lbnQucHVzaChhdHRhY2htZW50WzBdKTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgbGVmdDogYXR0YWNobWVudFswXSxcbiAgICAgIHRvcDogYXR0YWNobWVudFsxXVxuICAgIH07XG4gIH07XG5cbiAgLy8gQnVpbGQgYSBuaWNlIG9iamVjdCBvdXQgb2Ygb3VyIHN0cmluZyBhdHRyaWJ1dGUgd2hpY2ggc3BlY2lmaWVzXG4gIC8vIHRoZSBvZmZzZXQgb2YgdG9wIGFuZCBsZWZ0IGluIHBpeGVscy5cbiAgdGhpcy5vZmZzZXRzID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIG9mZnNldHMgPSAoJGF0dHJzLm1kT2Zmc2V0IHx8ICcwIDAnKS5zcGxpdCgnICcpLm1hcChwYXJzZUZsb2F0KTtcbiAgICBpZiAob2Zmc2V0cy5sZW5ndGggPT0gMikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbGVmdDogb2Zmc2V0c1swXSxcbiAgICAgICAgdG9wOiBvZmZzZXRzWzFdXG4gICAgICB9O1xuICAgIH0gZWxzZSBpZiAob2Zmc2V0cy5sZW5ndGggPT0gMSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdG9wOiBvZmZzZXRzWzBdLFxuICAgICAgICBsZWZ0OiBvZmZzZXRzWzBdXG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBFcnJvcignSW52YWxpZCBvZmZzZXRzIHNwZWNpZmllZC4gUGxlYXNlIGZvbGxvdyBmb3JtYXQgPHgsIHk+IG9yIDxuPicpO1xuICAgIH1cbiAgfTtcbn1cbk1lbnVDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkbWRNZW51XCIsIFwiJGF0dHJzXCIsIFwiJGVsZW1lbnRcIiwgXCIkc2NvcGVcIl07XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5tZW51Jylcbi5wcm92aWRlcignJG1kTWVudScsIE1lbnVQcm92aWRlcik7XG5cbi8qXG4gKiBJbnRlcmltIGVsZW1lbnQgcHJvdmlkZXIgZm9yIHRoZSBtZW51LlxuICogSGFuZGxlcyBiZWhhdmlvciBmb3IgYSBtZW51IHdoaWxlIGl0IGlzIG9wZW4sIGluY2x1ZGluZzpcbiAqICAgIC0gaGFuZGxpbmcgYW5pbWF0aW5nIHRoZSBtZW51IG9wZW5pbmcvY2xvc2luZ1xuICogICAgLSBoYW5kbGluZyBrZXkvbW91c2UgZXZlbnRzIG9uIHRoZSBtZW51IGVsZW1lbnRcbiAqICAgIC0gaGFuZGxpbmcgZW5hYmxpbmcvZGlzYWJsaW5nIHNjcm9sbCB3aGlsZSB0aGUgbWVudSBpcyBvcGVuXG4gKiAgICAtIGhhbmRsaW5nIHJlZHJhd2luZyBkdXJpbmcgcmVzaXplcyBhbmQgb3JpZW50YXRpb24gY2hhbmdlc1xuICpcbiAqL1xuXG5mdW5jdGlvbiBNZW51UHJvdmlkZXIoJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyKSB7XG4gIHZhciBNRU5VX0VER0VfTUFSR0lOID0gODtcblxuICBtZW51RGVmYXVsdE9wdGlvbnMuJGluamVjdCA9IFtcIiQkckFGXCIsIFwiJHdpbmRvd1wiLCBcIiRtZFV0aWxcIiwgXCIkbWRUaGVtaW5nXCIsIFwiJHRpbWVvdXRcIiwgXCIkbWRDb25zdGFudFwiLCBcIiRkb2N1bWVudFwiXTtcbiAgcmV0dXJuICQkaW50ZXJpbUVsZW1lbnRQcm92aWRlcignJG1kTWVudScpXG4gICAgLnNldERlZmF1bHRzKHtcbiAgICAgIG1ldGhvZHM6IFsndGFyZ2V0J10sXG4gICAgICBvcHRpb25zOiBtZW51RGVmYXVsdE9wdGlvbnNcbiAgICB9KTtcblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gbWVudURlZmF1bHRPcHRpb25zKCQkckFGLCAkd2luZG93LCAkbWRVdGlsLCAkbWRUaGVtaW5nLCAkdGltZW91dCwgJG1kQ29uc3RhbnQsICRkb2N1bWVudCkge1xuICAgIHJldHVybiB7XG4gICAgICBwYXJlbnQ6ICdib2R5JyxcbiAgICAgIG9uU2hvdzogb25TaG93LFxuICAgICAgb25SZW1vdmU6IG9uUmVtb3ZlLFxuICAgICAgaGFzQmFja2Ryb3A6IHRydWUsXG4gICAgICBkaXNhYmxlUGFyZW50U2Nyb2xsOiB0cnVlLFxuICAgICAgc2tpcENvbXBpbGU6IHRydWUsXG4gICAgICB0aGVtYWJsZTogdHJ1ZVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBCb2lsZXJwbGF0ZSBpbnRlcmltRWxlbWVudCBvblNob3cgZnVuY3Rpb25cbiAgICAgKiBIYW5kbGVzIGluc2VydGluZyB0aGUgbWVudSBpbnRvIHRoZSBET00sIHBvc2l0aW9uaW5nIGl0LCBhbmQgd2lyaW5nIHVwXG4gICAgICogdmFyaW91cyBpbnRlcmFjdGlvbiBldmVudHNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBvblNob3coc2NvcGUsIGVsZW1lbnQsIG9wdHMpIHtcblxuICAgICAgLy8gU2FuaXRpemUgYW5kIHNldCBkZWZhdWx0cyBvbiBvcHRzXG4gICAgICBidWlsZE9wdHMob3B0cyk7XG5cbiAgICAgIC8vIFdpcmUgdXAgdGhlbWluZyBvbiBvdXIgbWVudSBlbGVtZW50XG4gICAgICAkbWRUaGVtaW5nLmluaGVyaXQob3B0cy5tZW51Q29udGVudEVsLCBvcHRzLnRhcmdldCk7XG5cbiAgICAgIC8vIFJlZ2lzdGVyIHZhcmlvdXMgbGlzdGVuZXJzIHRvIG1vdmUgbWVudSBvbiByZXNpemUvb3JpZW50YXRpb24gY2hhbmdlXG4gICAgICBoYW5kbGVSZXNpemluZygpO1xuXG4gICAgICAvLyBEaXNhYmxlIHNjcm9sbGluZ1xuICAgICAgaWYgKG9wdHMuZGlzYWJsZVBhcmVudFNjcm9sbCkge1xuICAgICAgICBvcHRzLnJlc3RvcmVTY3JvbGwgPSAkbWRVdGlsLmRpc2FibGVTY3JvbGxBcm91bmQob3B0cy5lbGVtZW50KTtcbiAgICAgIH1cblxuICAgICAgLy8gT25seSBhY3RpdmF0ZSBjbGljayBsaXN0ZW5lcnMgYWZ0ZXIgYSBzaG9ydCB0aW1lIHRvIHN0b3AgYWNjaWRlbnRhbCBkb3VibGUgdGFwcy9jbGlja3NcbiAgICAgIC8vIGZyb20gY2xpY2tpbmcgdGhlIHdyb25nIGl0ZW1cbiAgICAgICR0aW1lb3V0KGFjdGl2YXRlSW50ZXJhY3Rpb24sIDc1LCBmYWxzZSk7XG5cbiAgICAgIGlmIChvcHRzLmJhY2tkcm9wKSB7XG4gICAgICAgICRtZFRoZW1pbmcuaW5oZXJpdChvcHRzLmJhY2tkcm9wLCBvcHRzLnBhcmVudCk7XG4gICAgICAgIG9wdHMucGFyZW50LmFwcGVuZChvcHRzLmJhY2tkcm9wKTtcbiAgICAgIH1cbiAgICAgIHNob3dNZW51KCk7XG5cbiAgICAgIC8vIFJldHVybiB0aGUgcHJvbWlzZSBmb3Igd2hlbiBvdXIgbWVudSBpcyBkb25lIGFuaW1hdGluZyBpblxuICAgICAgcmV0dXJuICRtZFV0aWwudHJhbnNpdGlvbkVuZFByb21pc2UoZWxlbWVudCwge3RpbWVvdXQ6IDM1MH0pO1xuXG4gICAgICAvKiogQ2hlY2sgZm9yIHZhbGlkIG9wdHMgYW5kIHNldCBzb21lIHNhbmUgZGVmYXVsdHMgKi9cbiAgICAgIGZ1bmN0aW9uIGJ1aWxkT3B0cygpIHtcbiAgICAgICAgaWYgKCFvcHRzLnRhcmdldCkge1xuICAgICAgICAgIHRocm93IEVycm9yKFxuICAgICAgICAgICAgJyRtZE1lbnUuc2hvdygpIGV4cGVjdGVkIGEgdGFyZ2V0IHRvIGFuaW1hdGUgZnJvbSBpbiBvcHRpb25zLnRhcmdldCdcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGFuZ3VsYXIuZXh0ZW5kKG9wdHMsIHtcbiAgICAgICAgICBhbHJlYWR5T3BlbjogZmFsc2UsXG4gICAgICAgICAgaXNSZW1vdmVkOiBmYWxzZSxcbiAgICAgICAgICB0YXJnZXQ6IGFuZ3VsYXIuZWxlbWVudChvcHRzLnRhcmdldCksIC8vbWFrZSBzdXJlIGl0J3Mgbm90IGEgbmFrZWQgZG9tIG5vZGVcbiAgICAgICAgICBwYXJlbnQ6IGFuZ3VsYXIuZWxlbWVudChvcHRzLnBhcmVudCksXG4gICAgICAgICAgbWVudUNvbnRlbnRFbDogYW5ndWxhci5lbGVtZW50KGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignbWQtbWVudS1jb250ZW50JykpLFxuICAgICAgICAgIGJhY2tkcm9wOiBvcHRzLmhhc0JhY2tkcm9wICYmIGFuZ3VsYXIuZWxlbWVudCgnPG1kLWJhY2tkcm9wIGNsYXNzPVwibWQtbWVudS1iYWNrZHJvcCBtZC1jbGljay1jYXRjaGVyXCI+JylcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8qKiBXaXJldXAgdmFyaW91cyByZXNpemUgbGlzdGVuZXJzIGZvciBzY3JlZW4gY2hhbmdlcyAqL1xuICAgICAgZnVuY3Rpb24gaGFuZGxlUmVzaXppbmcoKSB7XG4gICAgICAgIG9wdHMucmVzaXplRm4gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICBwb3NpdGlvbk1lbnUoZWxlbWVudCwgb3B0cyk7XG4gICAgICAgIH07XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vbigncmVzaXplJywgb3B0cy5yZXNpemVGbik7XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vbignb3JpZW50YXRpb25jaGFuZ2UnLCBvcHRzLnJlc2l6ZUZuKTtcbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiBQbGFjZSB0aGUgbWVudSBpbnRvIHRoZSBET00gYW5kIGNhbGwgcG9zaXRpb25pbmcgcmVsYXRlZCBmdW5jdGlvbnNcbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gc2hvd01lbnUoKSB7XG4gICAgICAgIG9wdHMucGFyZW50LmFwcGVuZChlbGVtZW50KTtcblxuICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdtZC1sZWF2ZScpO1xuICAgICAgICAvLyBLaWNrIG9mZiBvdXIgYW5pbWF0aW9uL3Bvc2l0aW9uaW5nIGJ1dCBmaXJzdCwgd2FpdCBhIGZldyBmcmFtZXNcbiAgICAgICAgLy8gc28gYWxsIG9mIG91ciBjb21wdXRlZCBwb3NpdGlvbnMvc2l6ZXMgYXJlIGFjY3VyYXRlXG4gICAgICAgICQkckFGKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICQkckFGKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcG9zaXRpb25NZW51KGVsZW1lbnQsIG9wdHMpO1xuICAgICAgICAgICAgLy8gV2FpdCBhIGZyYW1lIGJlZm9yZSBmYWRpbmcgaW4gbWVudSAobWQtYWN0aXZlKSBzbyB0aGF0IHdlIGRvbid0IHRyaWdnZXJcbiAgICAgICAgICAgIC8vIHRyYW5zaXRpb25zIG9uIHRoZSBtZW51IHBvc2l0aW9uIGNoYW5naW5nXG4gICAgICAgICAgICAkJHJBRihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnbWQtYWN0aXZlJyk7XG4gICAgICAgICAgICAgIG9wdHMuYWxyZWFkeU9wZW4gPSB0cnVlO1xuICAgICAgICAgICAgICBlbGVtZW50WzBdLnN0eWxlWyRtZENvbnN0YW50LkNTUy5UUkFOU0ZPUk1dID0gJyc7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cblxuICAgICAgLyoqXG4gICAgICAgKiBBY3RpdmF0ZSBpbnRlcmFjdGlvbiBvbiB0aGUgbWVudS4gV2lyZSB1cCBrZXlib2FyZCBsaXN0ZXJucyBmb3JcbiAgICAgICAqIGNsaWNrcywga2V5cHJlc3NlcywgYmFja2Ryb3AgY2xvc2luZywgZXRjLlxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBhY3RpdmF0ZUludGVyYWN0aW9uKCkge1xuICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdtZC1jbGlja2FibGUnKTtcblxuICAgICAgICAvLyBjbG9zZSBvbiBiYWNrZHJvcCBjbGlja1xuICAgICAgICBvcHRzLmJhY2tkcm9wICYmIG9wdHMuYmFja2Ryb3Aub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgIG9wdHMubWRNZW51Q3RybC5jbG9zZSh0cnVlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gV2lyZSB1cCBrZXlib2FyZCBsaXN0ZW5lcnMuXG4gICAgICAgIC8vIENsb3NlIG9uIGVzY2FwZSwgZm9jdXMgbmV4dCBpdGVtIG9uIGRvd24gYXJyb3csIGZvY3VzIHByZXYgaXRlbSBvbiB1cFxuICAgICAgICBvcHRzLm1lbnVDb250ZW50RWwub24oJ2tleWRvd24nLCBmdW5jdGlvbihldikge1xuICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoZXYua2V5Q29kZSkge1xuICAgICAgICAgICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLkVTQ0FQRTogb3B0cy5tZE1lbnVDdHJsLmNsb3NlKCk7IGJyZWFrO1xuICAgICAgICAgICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLlVQX0FSUk9XOiBmb2N1c01lbnVJdGVtKGV2LCBvcHRzLm1lbnVDb250ZW50RWwsIG9wdHMsIC0xKTsgYnJlYWs7XG4gICAgICAgICAgICAgIGNhc2UgJG1kQ29uc3RhbnQuS0VZX0NPREUuRE9XTl9BUlJPVzogZm9jdXNNZW51SXRlbShldiwgb3B0cy5tZW51Q29udGVudEVsLCBvcHRzLCAxKTsgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIENsb3NlIG1lbnUgb24gbWVudSBpdGVtIGNsaWNrLCBpZiBzYWlkIG1lbnUtaXRlbSBpcyBub3QgZGlzYWJsZWRcbiAgICAgICAgb3B0cy5tZW51Q29udGVudEVsLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQ7XG4gICAgICAgICAgLy8gVHJhdmVyc2UgdXAgdGhlIGV2ZW50IHVudGlsIHdlIGdldCB0byB0aGUgbWVudUNvbnRlbnRFbCB0byBzZWUgaWZcbiAgICAgICAgICAvLyB0aGVyZSBpcyBhbiBuZy1jbGljayBhbmQgdGhhdCB0aGUgbmctY2xpY2sgaXMgbm90IGRpc2FibGVkXG4gICAgICAgICAgZG8ge1xuICAgICAgICAgICAgaWYgKHRhcmdldCAmJiB0YXJnZXQuaGFzQXR0cmlidXRlKCduZy1jbGljaycpKSB7XG4gICAgICAgICAgICAgIGlmICghdGFyZ2V0Lmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAgICAgICAgICAgICAgIGNsb3NlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSB3aGlsZSAoKHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2RlKSAmJiB0YXJnZXQgIT0gb3B0cy5tZW51Q29udGVudEVsKVxuXG4gICAgICAgICAgZnVuY3Rpb24gY2xvc2UoKSB7XG4gICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIG9wdHMubWRNZW51Q3RybC5jbG9zZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBraWNrIG9mZiBpbml0aWFsIGZvY3VzIGluIHRoZSBtZW51IG9uIHRoZSBmaXJzdCBlbGVtZW50XG4gICAgICAgIHZhciBmb2N1c1RhcmdldCA9IG9wdHMubWVudUNvbnRlbnRFbFswXS5xdWVyeVNlbGVjdG9yKCdbbWQtbWVudS1mb2N1cy10YXJnZXRdJyk7XG4gICAgICAgIGlmICghZm9jdXNUYXJnZXQpIGZvY3VzVGFyZ2V0ID0gb3B0cy5tZW51Q29udGVudEVsWzBdLmZpcnN0RWxlbWVudENoaWxkLmZpcnN0RWxlbWVudENoaWxkO1xuICAgICAgICBmb2N1c1RhcmdldC5mb2N1cygpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAgKiBUYWtlcyBhIGtleXByZXNzIGV2ZW50IGFuZCBmb2N1c2VzIHRoZSBuZXh0L3ByZXZpb3VzIG1lbnVcbiAgICAgICogaXRlbSBmcm9tIHRoZSBlbWl0dGluZyBlbGVtZW50XG4gICAgICAqIEBwYXJhbSB7ZXZlbnR9IGUgLSBUaGUgb3JpZ2luIGtleXByZXNzIGV2ZW50XG4gICAgICAqIEBwYXJhbSB7YW5ndWxhci5lbGVtZW50fSBtZW51RWwgLSBUaGUgbWVudSBlbGVtZW50XG4gICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvcHRzIC0gVGhlIGludGVyaW0gZWxlbWVudCBvcHRpb25zIGZvciB0aGUgbWRNZW51XG4gICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkaXJlY3Rpb24gLSBUaGUgZGlyZWN0aW9uIHRvIG1vdmUgaW4gKCsxID0gbmV4dCwgLTEgPSBwcmV2KVxuICAgICAgKi9cbiAgICBmdW5jdGlvbiBmb2N1c01lbnVJdGVtKGUsIG1lbnVFbCwgb3B0cywgZGlyZWN0aW9uKSB7XG4gICAgICB2YXIgY3VycmVudEl0ZW0gPSAkbWRVdGlsLmdldENsb3Nlc3QoZS50YXJnZXQsICdNRC1NRU5VLUlURU0nKTtcblxuICAgICAgdmFyIGl0ZW1zID0gJG1kVXRpbC5ub2Rlc1RvQXJyYXkobWVudUVsWzBdLmNoaWxkcmVuKTtcbiAgICAgIHZhciBjdXJyZW50SW5kZXggPSBpdGVtcy5pbmRleE9mKGN1cnJlbnRJdGVtKTtcblxuICAgICAgLy8gVHJhdmVyc2UgdGhyb3VnaCBvdXIgZWxlbWVudHMgaW4gdGhlIHNwZWNpZmllZCBkaXJlY3Rpb24gKCsvLTEpIGFuZCB0cnkgdG9cbiAgICAgIC8vIGZvY3VzIHRoZW0gdW50aWwgd2UgZmluZCBvbmUgdGhhdCBhY2NlcHRzIGZvY3VzXG4gICAgICBmb3IgKHZhciBpID0gY3VycmVudEluZGV4ICsgZGlyZWN0aW9uOyBpID49IDAgJiYgaSA8IGl0ZW1zLmxlbmd0aDsgaSA9IGkgKyBkaXJlY3Rpb24pIHtcbiAgICAgICAgdmFyIGZvY3VzVGFyZ2V0ID0gaXRlbXNbaV0uZmlyc3RFbGVtZW50Q2hpbGQgfHwgaXRlbXNbaV07XG4gICAgICAgIHZhciBkaWRGb2N1cyA9IGF0dGVtcHRGb2N1cyhmb2N1c1RhcmdldCk7XG4gICAgICAgIGlmIChkaWRGb2N1cykge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXR0ZW1wdHMgdG8gZm9jdXMgYW4gZWxlbWVudC4gQ2hlY2tzIHdoZXRoZXIgdGhhdCBlbGVtZW50IGlzIHRoZSBjdXJyZW50bHlcbiAgICAgKiBmb2N1c2VkIGVsZW1lbnQgYWZ0ZXIgYXR0ZW1wdGluZy5cbiAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBlbCAtIHRoZSBlbGVtZW50IHRvIGF0dGVtcHQgZm9jdXMgb25cbiAgICAgKiBAcmV0dXJucyB7Ym9vbH0gLSB3aGV0aGVyIHRoZSBlbGVtZW50IHdhcyBzdWNjZXNzZnVsbHkgZm9jdXNlZFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGF0dGVtcHRGb2N1cyhlbCkge1xuICAgICAgaWYgKGVsICYmIGVsLmdldEF0dHJpYnV0ZSgndGFiaW5kZXgnKSAhPSAtMSkge1xuICAgICAgICBlbC5mb2N1cygpO1xuICAgICAgICBpZiAoJGRvY3VtZW50WzBdLmFjdGl2ZUVsZW1lbnQgPT0gZWwpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCb2lsZXJwbGF0ZSBpbnRlcmltRWxlbWVudCBvblJlbW92ZSBmdW5jdGlvblxuICAgICAqIEhhbmRsZXMgcmVtb3ZpbmcgdGhlIG1lbnUgZnJvbSB0aGUgRE9NLCBjbGVhbmluZyB1cCB0aGUgZWxlbWVudFxuICAgICAqIGFuZCByZW1vdmluZyB2YXJpb3VzIGxpc3RlbmVyc1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIG9uUmVtb3ZlKHNjb3BlLCBlbGVtZW50LCBvcHRzKSB7XG4gICAgICBvcHRzLmlzUmVtb3ZlZCA9IHRydWU7XG4gICAgICBlbGVtZW50LmFkZENsYXNzKCdtZC1sZWF2ZScpXG4gICAgICAgIC5yZW1vdmVDbGFzcygnbWQtY2xpY2thYmxlJyk7XG5cbiAgICAgIC8vIERpc2FibGUgcmVzaXppbmcgaGFuZGxlcnNcbiAgICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vZmYoJ3Jlc2l6ZScsIG9wdHMucmVzaXplRm4pO1xuICAgICAgYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpLm9mZignb3JpZW50YXRpb25jaGFuZ2UnLCBvcHRzLnJlc2l6ZUZuKTtcbiAgICAgIG9wdHMucmVzaXplRm4gPSB1bmRlZmluZWQ7XG5cbiAgICAgIC8vIFdhaXQgZm9yIGFuaW1hdGUgb3V0LCB0aGVuIHJlbW92ZSBmcm9tIHRoZSBET01cbiAgICAgIHJldHVybiAkbWRVdGlsLnRyYW5zaXRpb25FbmRQcm9taXNlKGVsZW1lbnQsIHsgdGltZW91dDogMzUwIH0pLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21kLWFjdGl2ZScpO1xuICAgICAgICBvcHRzLmJhY2tkcm9wICYmIG9wdHMuYmFja2Ryb3AucmVtb3ZlKCk7XG4gICAgICAgIGlmIChlbGVtZW50WzBdLnBhcmVudE5vZGUgPT09IG9wdHMucGFyZW50WzBdKSB7XG4gICAgICAgICAgb3B0cy5wYXJlbnRbMF0ucmVtb3ZlQ2hpbGQoZWxlbWVudFswXSk7XG4gICAgICAgIH1cbiAgICAgICAgb3B0cy5yZXN0b3JlU2Nyb2xsICYmIG9wdHMucmVzdG9yZVNjcm9sbCgpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29tcHV0ZXMgbWVudSBwb3NpdGlvbiBhbmQgc2V0cyB0aGUgc3R5bGUgb24gdGhlIG1lbnUgY29udGFpbmVyXG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZWwgLSB0aGUgbWVudSBjb250YWluZXIgZWxlbWVudFxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvcHRzIC0gdGhlIGludGVyaW0gZWxlbWVudCBvcHRpb25zIG9iamVjdFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHBvc2l0aW9uTWVudShlbCwgb3B0cykge1xuICAgICAgaWYgKG9wdHMuaXNSZW1vdmVkKSByZXR1cm47XG5cbiAgICAgIHZhciBjb250YWluZXJOb2RlID0gZWxbMF0sXG4gICAgICAgICAgb3Blbk1lbnVOb2RlID0gZWxbMF0uZmlyc3RFbGVtZW50Q2hpbGQsXG4gICAgICAgICAgb3Blbk1lbnVOb2RlUmVjdCA9IG9wZW5NZW51Tm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICAgICAgICBib3VuZHJ5Tm9kZSA9IG9wdHMucGFyZW50WzBdLFxuICAgICAgICAgIGJvdW5kcnlOb2RlUmVjdCA9IGJvdW5kcnlOb2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgICB2YXIgb3JpZ2luTm9kZSA9IG9wdHMudGFyZ2V0WzBdLnF1ZXJ5U2VsZWN0b3IoJ1ttZC1tZW51LW9yaWdpbl0nKSB8fCBvcHRzLnRhcmdldFswXSxcbiAgICAgICAgICBvcmlnaW5Ob2RlUmVjdCA9IG9yaWdpbk5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cblxuICAgICAgdmFyIGJvdW5kcyA9IHtcbiAgICAgICAgbGVmdDogYm91bmRyeU5vZGVSZWN0LmxlZnQgKyBNRU5VX0VER0VfTUFSR0lOLFxuICAgICAgICB0b3A6IGJvdW5kcnlOb2RlUmVjdC50b3AgKyBNRU5VX0VER0VfTUFSR0lOLFxuICAgICAgICBib3R0b206IGJvdW5kcnlOb2RlUmVjdC5ib3R0b20gLSBNRU5VX0VER0VfTUFSR0lOLFxuICAgICAgICByaWdodDogYm91bmRyeU5vZGVSZWN0LnJpZ2h0IC0gTUVOVV9FREdFX01BUkdJTlxuICAgICAgfTtcblxuXG4gICAgICB2YXIgYWxpZ25UYXJnZXQsIGFsaWduVGFyZ2V0UmVjdCwgZXhpc3RpbmdPZmZzZXRzO1xuICAgICAgdmFyIHBvc2l0aW9uTW9kZSA9IG9wdHMubWRNZW51Q3RybC5wb3NpdGlvbk1vZGUoKTtcblxuICAgICAgaWYgKHBvc2l0aW9uTW9kZS50b3AgPT0gJ3RhcmdldCcgfHwgcG9zaXRpb25Nb2RlLmxlZnQgPT0gJ3RhcmdldCcgfHwgcG9zaXRpb25Nb2RlLmxlZnQgPT0gJ3RhcmdldC1yaWdodCcpIHtcbiAgICAgICAgLy8gVE9ETzogQWxsb3cgY2VudGVyaW5nIG9uIGFuIGFyYml0cmFyeSBub2RlLCBmb3Igbm93IGNlbnRlciBvbiBmaXJzdCBtZW51LWl0ZW0ncyBjaGlsZFxuICAgICAgICBhbGlnblRhcmdldCA9IG9wZW5NZW51Tm9kZS5maXJzdEVsZW1lbnRDaGlsZC5maXJzdEVsZW1lbnRDaGlsZCB8fCBvcGVuTWVudU5vZGUuZmlyc3RFbGVtZW50Q2hpbGQ7XG4gICAgICAgIGFsaWduVGFyZ2V0ID0gYWxpZ25UYXJnZXQucXVlcnlTZWxlY3RvcignW21kLW1lbnUtYWxpZ24tdGFyZ2V0XScpIHx8IGFsaWduVGFyZ2V0O1xuICAgICAgICBhbGlnblRhcmdldFJlY3QgPSBhbGlnblRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgICAgICBleGlzdGluZ09mZnNldHMgPSB7XG4gICAgICAgICAgdG9wOiBwYXJzZUZsb2F0KGNvbnRhaW5lck5vZGUuc3R5bGUudG9wIHx8IDApLFxuICAgICAgICAgIGxlZnQ6IHBhcnNlRmxvYXQoY29udGFpbmVyTm9kZS5zdHlsZS5sZWZ0IHx8IDApXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHZhciBwb3NpdGlvbiA9IHsgfTtcbiAgICAgIHZhciB0cmFuc2Zvcm1PcmlnaW4gPSAndG9wICc7XG5cbiAgICAgIHN3aXRjaCAocG9zaXRpb25Nb2RlLnRvcCkge1xuICAgICAgICBjYXNlICd0YXJnZXQnOlxuICAgICAgICAgIHBvc2l0aW9uLnRvcCA9IGV4aXN0aW5nT2Zmc2V0cy50b3AgKyBvcmlnaW5Ob2RlUmVjdC50b3AgLSBhbGlnblRhcmdldFJlY3QudG9wO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICAvLyBGdXR1cmUgc3VwcG9ydCBmb3IgbWRNZW51QmFyXG4gICAgICAgIC8vIGNhc2UgJ3RvcCc6XG4gICAgICAgIC8vICAgcG9zaXRpb24udG9wID0gb3JpZ2luTm9kZVJlY3QudG9wO1xuICAgICAgICAvLyAgIGJyZWFrO1xuICAgICAgICAvLyBjYXNlICdib3R0b20nOlxuICAgICAgICAvLyAgIHBvc2l0aW9uLnRvcCA9IG9yaWdpbk5vZGVSZWN0LnRvcCArIG9yaWdpbk5vZGVSZWN0LmhlaWdodDtcbiAgICAgICAgLy8gICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgdGFyZ2V0IG1vZGUgXCInICsgcG9zaXRpb25Nb2RlLnRvcCArICdcIiBzcGVjaWZpZWQgZm9yIG1kLW1lbnUgb24gWSBheGlzLicpO1xuICAgICAgfVxuXG4gICAgICBzd2l0Y2ggKHBvc2l0aW9uTW9kZS5sZWZ0KSB7XG4gICAgICAgIGNhc2UgJ3RhcmdldCc6XG4gICAgICAgICAgcG9zaXRpb24ubGVmdCA9IGV4aXN0aW5nT2Zmc2V0cy5sZWZ0ICsgb3JpZ2luTm9kZVJlY3QubGVmdCAtIGFsaWduVGFyZ2V0UmVjdC5sZWZ0O1xuICAgICAgICAgIHRyYW5zZm9ybU9yaWdpbiArPSAnbGVmdCc7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3RhcmdldC1yaWdodCc6XG4gICAgICAgICAgcG9zaXRpb24ubGVmdCA9IG9yaWdpbk5vZGVSZWN0LnJpZ2h0IC0gb3Blbk1lbnVOb2RlUmVjdC53aWR0aCArIChvcGVuTWVudU5vZGVSZWN0LnJpZ2h0IC0gYWxpZ25UYXJnZXRSZWN0LnJpZ2h0KTtcbiAgICAgICAgICB0cmFuc2Zvcm1PcmlnaW4gKz0gJ3JpZ2h0JztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgLy8gRnV0dXJlIHN1cHBvcnQgZm9yIG1kTWVudUJhclxuICAgICAgICAvLyBjYXNlICdsZWZ0JzpcbiAgICAgICAgLy8gICBwb3NpdGlvbi5sZWZ0ID0gb3JpZ2luTm9kZVJlY3QubGVmdDtcbiAgICAgICAgLy8gICB0cmFuc2Zvcm1PcmlnaW4gKz0gJ2xlZnQnO1xuICAgICAgICAvLyAgIGJyZWFrO1xuICAgICAgICAvLyBjYXNlICdyaWdodCc6XG4gICAgICAgIC8vICAgcG9zaXRpb24ubGVmdCA9IG9yaWdpbk5vZGVSZWN0LnJpZ2h0IC0gY29udGFpbmVyTm9kZS5vZmZzZXRXaWR0aDtcbiAgICAgICAgLy8gICB0cmFuc2Zvcm1PcmlnaW4gKz0gJ3JpZ2h0JztcbiAgICAgICAgLy8gICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgdGFyZ2V0IG1vZGUgXCInICsgcG9zaXRpb25Nb2RlLmxlZnQgKyAnXCIgc3BlY2lmaWVkIGZvciBtZC1tZW51IG9uIFggYXhpcy4nKTtcbiAgICAgIH1cblxuICAgICAgdmFyIG9mZnNldHMgPSBvcHRzLm1kTWVudUN0cmwub2Zmc2V0cygpO1xuICAgICAgcG9zaXRpb24udG9wICs9IG9mZnNldHMudG9wO1xuICAgICAgcG9zaXRpb24ubGVmdCArPSBvZmZzZXRzLmxlZnQ7XG5cbiAgICAgIGNsYW1wKHBvc2l0aW9uKTtcblxuICAgICAgZWwuY3NzKHtcbiAgICAgICAgdG9wOiBwb3NpdGlvbi50b3AgKyAncHgnLFxuICAgICAgICBsZWZ0OiBwb3NpdGlvbi5sZWZ0ICsgJ3B4J1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnRhaW5lck5vZGUuc3R5bGVbJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STV9PUklHSU5dID0gdHJhbnNmb3JtT3JpZ2luO1xuXG4gICAgICAvLyBBbmltYXRlIGEgc2NhbGUgb3V0IGlmIHdlIGFyZW4ndCBqdXN0IHJlcG9zaXRpb25pbmdcbiAgICAgIGlmICghb3B0cy5hbHJlYWR5T3Blbikge1xuICAgICAgICBjb250YWluZXJOb2RlLnN0eWxlWyRtZENvbnN0YW50LkNTUy5UUkFOU0ZPUk1dID0gJ3NjYWxlKCcgK1xuICAgICAgICAgIE1hdGgubWluKG9yaWdpbk5vZGVSZWN0LndpZHRoIC8gY29udGFpbmVyTm9kZS5vZmZzZXRXaWR0aCwgMS4wKSArICcsJyArXG4gICAgICAgICAgTWF0aC5taW4ob3JpZ2luTm9kZVJlY3QuaGVpZ2h0IC8gY29udGFpbmVyTm9kZS5vZmZzZXRIZWlnaHQsIDEuMCkgK1xuICAgICAgICAnKSc7XG4gICAgICB9XG5cbiAgICAgIC8qKlxuICAgICAgICogQ2xhbXBzIHRoZSByZXBvc2l0aW9uaW5nIG9mIHRoZSBtZW51IHdpdGhpbiB0aGUgY29uZmluZXMgb2ZcbiAgICAgICAqIGJvdW5kaW5nIGVsZW1lbnQgKG9mdGVuIHRoZSBzY3JlZW4vYm9keSlcbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gY2xhbXAocG9zKSB7XG4gICAgICAgIHBvcy50b3AgPSBNYXRoLm1heChNYXRoLm1pbihwb3MudG9wLCBib3VuZHMuYm90dG9tIC0gY29udGFpbmVyTm9kZS5vZmZzZXRIZWlnaHQpLCBib3VuZHMudG9wKTtcbiAgICAgICAgcG9zLmxlZnQgPSBNYXRoLm1heChNYXRoLm1pbihwb3MubGVmdCwgYm91bmRzLnJpZ2h0IC0gY29udGFpbmVyTm9kZS5vZmZzZXRXaWR0aCksIGJvdW5kcy5sZWZ0KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbk1lbnVQcm92aWRlci4kaW5qZWN0ID0gW1wiJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyXCJdO1xuXG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBAbmdkb2MgbW9kdWxlXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLnByb2dyZXNzQ2lyY3VsYXJcbiAqIEBkZXNjcmlwdGlvbiBDaXJjdWxhciBQcm9ncmVzcyBtb2R1bGUhXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnByb2dyZXNzQ2lyY3VsYXInLCBbXG4gICdtYXRlcmlhbC5jb3JlJ1xuXSlcbiAgLmRpcmVjdGl2ZSgnbWRQcm9ncmVzc0NpcmN1bGFyJywgTWRQcm9ncmVzc0NpcmN1bGFyRGlyZWN0aXZlKTtcblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBtZFByb2dyZXNzQ2lyY3VsYXJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5wcm9ncmVzc0NpcmN1bGFyXG4gKiBAcmVzdHJpY3QgRVxuICpcbiogQGRlc2NyaXB0aW9uXG4gKiBUaGUgY2lyY3VsYXIgcHJvZ3Jlc3MgZGlyZWN0aXZlIGlzIHVzZWQgdG8gbWFrZSBsb2FkaW5nIGNvbnRlbnQgaW4geW91ciBhcHAgYXMgZGVsaWdodGZ1bCBhbmRcbiAqIHBhaW5sZXNzIGFzIHBvc3NpYmxlIGJ5IG1pbmltaXppbmcgdGhlIGFtb3VudCBvZiB2aXN1YWwgY2hhbmdlIGEgdXNlciBzZWVzIGJlZm9yZSB0aGV5IGNhbiB2aWV3XG4gKiBhbmQgaW50ZXJhY3Qgd2l0aCBjb250ZW50LlxuICpcbiAqIEZvciBvcGVyYXRpb25zIHdoZXJlIHRoZSBwZXJjZW50YWdlIG9mIHRoZSBvcGVyYXRpb24gY29tcGxldGVkIGNhbiBiZSBkZXRlcm1pbmVkLCB1c2UgYVxuICogZGV0ZXJtaW5hdGUgaW5kaWNhdG9yLiBUaGV5IGdpdmUgdXNlcnMgYSBxdWljayBzZW5zZSBvZiBob3cgbG9uZyBhbiBvcGVyYXRpb24gd2lsbCB0YWtlLlxuICpcbiAqIEZvciBvcGVyYXRpb25zIHdoZXJlIHRoZSB1c2VyIGlzIGFza2VkIHRvIHdhaXQgYSBtb21lbnQgd2hpbGUgc29tZXRoaW5nIGZpbmlzaGVzIHVwLCBhbmQgaXTigJlzXG4gKiBub3QgbmVjZXNzYXJ5IHRvIGV4cG9zZSB3aGF0J3MgaGFwcGVuaW5nIGJlaGluZCB0aGUgc2NlbmVzIGFuZCBob3cgbG9uZyBpdCB3aWxsIHRha2UsIHVzZSBhblxuICogaW5kZXRlcm1pbmF0ZSBpbmRpY2F0b3IuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IG1kLW1vZGUgU2VsZWN0IGZyb20gb25lIG9mIHR3byBtb2RlczogZGV0ZXJtaW5hdGUgYW5kIGluZGV0ZXJtaW5hdGUuXG4gKiBAcGFyYW0ge251bWJlcj19IHZhbHVlIEluIGRldGVybWluYXRlIG1vZGUsIHRoaXMgbnVtYmVyIHJlcHJlc2VudHMgdGhlIHBlcmNlbnRhZ2Ugb2YgdGhlXG4gKiAgICAgY2lyY3VsYXIgcHJvZ3Jlc3MuIERlZmF1bHQ6IDBcbiAqIEBwYXJhbSB7bnVtYmVyPX0gbWQtZGlhbWV0ZXIgVGhpcyBzcGVjaWZpZXMgdGhlIGRpYW10ZXIgb2YgdGhlIGNpcmN1bGFyIHByb2dyZXNzLiBEZWZhdWx0OiA0OFxuICpcbiAqIEB1c2FnZVxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cbiAqIDxtZC1wcm9ncmVzcy1jaXJjdWxhciBtZC1tb2RlPVwiZGV0ZXJtaW5hdGVcIiB2YWx1ZT1cIi4uLlwiPjwvbWQtcHJvZ3Jlc3MtY2lyY3VsYXI+XG4gKlxuICogPG1kLXByb2dyZXNzLWNpcmN1bGFyIG1kLW1vZGU9XCJkZXRlcm1pbmF0ZVwiIG5nLXZhbHVlPVwiLi4uXCI+PC9tZC1wcm9ncmVzcy1jaXJjdWxhcj5cbiAqXG4gKiA8bWQtcHJvZ3Jlc3MtY2lyY3VsYXIgbWQtbW9kZT1cImRldGVybWluYXRlXCIgdmFsdWU9XCIuLi5cIiBtZC1kaWFtZXRlcj1cIjEwMFwiPjwvbWQtcHJvZ3Jlc3MtY2lyY3VsYXI+XG4gKlxuICogPG1kLXByb2dyZXNzLWNpcmN1bGFyIG1kLW1vZGU9XCJpbmRldGVybWluYXRlXCI+PC9tZC1wcm9ncmVzcy1jaXJjdWxhcj5cbiAqIDwvaGxqcz5cbiAqL1xuZnVuY3Rpb24gTWRQcm9ncmVzc0NpcmN1bGFyRGlyZWN0aXZlKCRtZENvbnN0YW50LCAkbWRUaGVtaW5nKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdFJyxcbiAgICB0ZW1wbGF0ZTpcbiAgICAgICAgLy8gVGhlIHByb2dyZXNzICdjaXJjbGUnIGlzIGNvbXBvc2VkIG9mIHR3byBoYWxmLWNpcmNsZXM6IHRoZSBsZWZ0IHNpZGUgYW5kIHRoZSByaWdodFxuICAgICAgICAvLyBzaWRlLiBFYWNoIHNpZGUgaGFzIENTUyBhcHBsaWVkIHRvICdmaWxsLWluJyB0aGUgaGFsZi1jaXJjbGUgdG8gdGhlIGFwcHJvcHJpYXRlIHByb2dyZXNzLlxuICAgICAgICAnPGRpdiBjbGFzcz1cIm1kLXNwaW5uZXItd3JhcHBlclwiPicgK1xuICAgICAgICAgICc8ZGl2IGNsYXNzPVwibWQtaW5uZXJcIj4nICtcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwibWQtZ2FwXCI+PC9kaXY+JyArXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cIm1kLWxlZnRcIj4nICtcbiAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJtZC1oYWxmLWNpcmNsZVwiPjwvZGl2PicgK1xuICAgICAgICAgICAgJzwvZGl2PicgK1xuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJtZC1yaWdodFwiPicgK1xuICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cIm1kLWhhbGYtY2lyY2xlXCI+PC9kaXY+JyArXG4gICAgICAgICAgICAnPC9kaXY+JyArXG4gICAgICAgICAgJzwvZGl2PicgK1xuICAgICAgICAnPC9kaXY+JyxcbiAgICBjb21waWxlOiBjb21waWxlXG4gIH07XG5cbiAgZnVuY3Rpb24gY29tcGlsZSh0RWxlbWVudCkge1xuICAgIC8vIFRoZSBqYXZhc2NyaXB0IGluIHRoaXMgZmlsZSBpcyBtYWlubHkgcmVzcG9uc2libGUgZm9yIHNldHRpbmcgdGhlIGNvcnJlY3QgYXJpYSBhdHRyaWJ1dGVzLlxuICAgIC8vIFRoZSBhbmltYXRpb24gb2YgdGhlIHByb2dyZXNzIHNwaW5uZXIgaXMgZG9uZSBlbnRpcmVseSB3aXRoIGp1c3QgQ1NTLlxuICAgIHRFbGVtZW50LmF0dHIoJ2FyaWEtdmFsdWVtaW4nLCAwKTtcbiAgICB0RWxlbWVudC5hdHRyKCdhcmlhLXZhbHVlbWF4JywgMTAwKTtcbiAgICB0RWxlbWVudC5hdHRyKCdyb2xlJywgJ3Byb2dyZXNzYmFyJyk7XG5cbiAgICByZXR1cm4gcG9zdExpbms7XG4gIH1cblxuICBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0cikge1xuICAgICRtZFRoZW1pbmcoZWxlbWVudCk7XG4gICAgdmFyIGNpcmNsZSA9IGVsZW1lbnRbMF07XG5cbiAgICAvLyBTY2FsZSB0aGUgcHJvZ3Jlc3MgY2lyY2xlIGJhc2VkIG9uIHRoZSBkZWZhdWx0IGRpYW1ldGVyLlxuICAgIHZhciBkaWFtZXRlciA9IGF0dHIubWREaWFtZXRlciB8fCA0ODtcbiAgICB2YXIgc2NhbGUgPSBkaWFtZXRlciAvIDQ4O1xuICAgIGNpcmNsZS5zdHlsZVskbWRDb25zdGFudC5DU1MuVFJBTlNGT1JNXSA9ICdzY2FsZSgnICsgc2NhbGUgKyAnKSc7XG5cbiAgICBhdHRyLiRvYnNlcnZlKCd2YWx1ZScsIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICB2YXIgcGVyY2VudFZhbHVlID0gY2xhbXAodmFsdWUpO1xuICAgICAgZWxlbWVudC5hdHRyKCdhcmlhLXZhbHVlbm93JywgcGVyY2VudFZhbHVlKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGFtcHMgdGhlIHZhbHVlIHRvIGJlIGJldHdlZW4gMCBhbmQgMTAwLlxuICAgKiBAcGFyYW0ge251bWJlcn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNsYW1wLlxuICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgKi9cbiAgZnVuY3Rpb24gY2xhbXAodmFsdWUpIHtcbiAgICByZXR1cm4gTWF0aC5tYXgoMCwgTWF0aC5taW4odmFsdWUgfHwgMCwgMTAwKSk7XG4gIH1cbn1cbk1kUHJvZ3Jlc3NDaXJjdWxhckRpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kQ29uc3RhbnRcIiwgXCIkbWRUaGVtaW5nXCJdO1xuXG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBAbmdkb2MgbW9kdWxlXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLnByb2dyZXNzTGluZWFyXG4gKiBAZGVzY3JpcHRpb24gTGluZWFyIFByb2dyZXNzIG1vZHVsZSFcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMucHJvZ3Jlc3NMaW5lYXInLCBbXG4gICdtYXRlcmlhbC5jb3JlJ1xuXSlcbiAgLmRpcmVjdGl2ZSgnbWRQcm9ncmVzc0xpbmVhcicsIE1kUHJvZ3Jlc3NMaW5lYXJEaXJlY3RpdmUpO1xuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG1kUHJvZ3Jlc3NMaW5lYXJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5wcm9ncmVzc0xpbmVhclxuICogQHJlc3RyaWN0IEVcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFRoZSBsaW5lYXIgcHJvZ3Jlc3MgZGlyZWN0aXZlIGlzIHVzZWQgdG8gbWFrZSBsb2FkaW5nIGNvbnRlbnQgaW4geW91ciBhcHAgYXMgZGVsaWdodGZ1bCBhbmQgcGFpbmxlc3MgYXMgcG9zc2libGUgYnkgbWluaW1pemluZyB0aGUgYW1vdW50IG9mIHZpc3VhbCBjaGFuZ2UgYSB1c2VyIHNlZXMgYmVmb3JlIHRoZXkgY2FuIHZpZXcgYW5kIGludGVyYWN0IHdpdGggY29udGVudC4gRWFjaCBvcGVyYXRpb24gc2hvdWxkIG9ubHkgYmUgcmVwcmVzZW50ZWQgYnkgb25lIGFjdGl2aXR5IGluZGljYXRvcuKAlGZvciBleGFtcGxlLCBvbmUgcmVmcmVzaCBvcGVyYXRpb24gc2hvdWxkIG5vdCBkaXNwbGF5IGJvdGggYSByZWZyZXNoIGJhciBhbmQgYW4gYWN0aXZpdHkgY2lyY2xlLlxuICpcbiAqIEZvciBvcGVyYXRpb25zIHdoZXJlIHRoZSBwZXJjZW50YWdlIG9mIHRoZSBvcGVyYXRpb24gY29tcGxldGVkIGNhbiBiZSBkZXRlcm1pbmVkLCB1c2UgYSBkZXRlcm1pbmF0ZSBpbmRpY2F0b3IuIFRoZXkgZ2l2ZSB1c2VycyBhIHF1aWNrIHNlbnNlIG9mIGhvdyBsb25nIGFuIG9wZXJhdGlvbiB3aWxsIHRha2UuXG4gKlxuICogRm9yIG9wZXJhdGlvbnMgd2hlcmUgdGhlIHVzZXIgaXMgYXNrZWQgdG8gd2FpdCBhIG1vbWVudCB3aGlsZSBzb21ldGhpbmcgZmluaXNoZXMgdXAsIGFuZCBpdOKAmXMgbm90IG5lY2Vzc2FyeSB0byBleHBvc2Ugd2hhdCdzIGhhcHBlbmluZyBiZWhpbmQgdGhlIHNjZW5lcyBhbmQgaG93IGxvbmcgaXQgd2lsbCB0YWtlLCB1c2UgYW4gaW5kZXRlcm1pbmF0ZSBpbmRpY2F0b3IuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IG1kLW1vZGUgU2VsZWN0IGZyb20gb25lIG9mIGZvdXIgbW9kZXM6IGRldGVybWluYXRlLCBpbmRldGVybWluYXRlLCBidWZmZXIgb3IgcXVlcnkuXG4gKiBAcGFyYW0ge251bWJlcj19IHZhbHVlIEluIGRldGVybWluYXRlIGFuZCBidWZmZXIgbW9kZXMsIHRoaXMgbnVtYmVyIHJlcHJlc2VudHMgdGhlIHBlcmNlbnRhZ2Ugb2YgdGhlIHByaW1hcnkgcHJvZ3Jlc3MgYmFyLiBEZWZhdWx0OiAwXG4gKiBAcGFyYW0ge251bWJlcj19IG1kLWJ1ZmZlci12YWx1ZSBJbiB0aGUgYnVmZmVyIG1vZGUsIHRoaXMgbnVtYmVyIHJlcHJlc2VudHMgdGhlIHByZWNlbnRhZ2Ugb2YgdGhlIHNlY29uZGFyeSBwcm9ncmVzcyBiYXIuIERlZmF1bHQ6IDBcbiAqXG4gKiBAdXNhZ2VcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiA8bWQtcHJvZ3Jlc3MtbGluZWFyIG1kLW1vZGU9XCJkZXRlcm1pbmF0ZVwiIHZhbHVlPVwiLi4uXCI+PC9tZC1wcm9ncmVzcy1saW5lYXI+XG4gKlxuICogPG1kLXByb2dyZXNzLWxpbmVhciBtZC1tb2RlPVwiZGV0ZXJtaW5hdGVcIiBuZy12YWx1ZT1cIi4uLlwiPjwvbWQtcHJvZ3Jlc3MtbGluZWFyPlxuICpcbiAqIDxtZC1wcm9ncmVzcy1saW5lYXIgbWQtbW9kZT1cImluZGV0ZXJtaW5hdGVcIj48L21kLXByb2dyZXNzLWxpbmVhcj5cbiAqXG4gKiA8bWQtcHJvZ3Jlc3MtbGluZWFyIG1kLW1vZGU9XCJidWZmZXJcIiB2YWx1ZT1cIi4uLlwiIG1kLWJ1ZmZlci12YWx1ZT1cIi4uLlwiPjwvbWQtcHJvZ3Jlc3MtbGluZWFyPlxuICpcbiAqIDxtZC1wcm9ncmVzcy1saW5lYXIgbWQtbW9kZT1cInF1ZXJ5XCI+PC9tZC1wcm9ncmVzcy1saW5lYXI+XG4gKiA8L2hsanM+XG4gKi9cbmZ1bmN0aW9uIE1kUHJvZ3Jlc3NMaW5lYXJEaXJlY3RpdmUoJCRyQUYsICRtZENvbnN0YW50LCAkbWRUaGVtaW5nKSB7XG5cbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0UnLFxuICAgIHRlbXBsYXRlOiAnPGRpdiBjbGFzcz1cIm1kLWNvbnRhaW5lclwiPicgK1xuICAgICAgJzxkaXYgY2xhc3M9XCJtZC1kYXNoZWRcIj48L2Rpdj4nICtcbiAgICAgICc8ZGl2IGNsYXNzPVwibWQtYmFyIG1kLWJhcjFcIj48L2Rpdj4nICtcbiAgICAgICc8ZGl2IGNsYXNzPVwibWQtYmFyIG1kLWJhcjJcIj48L2Rpdj4nICtcbiAgICAgICc8L2Rpdj4nLFxuICAgIGNvbXBpbGU6IGNvbXBpbGVcbiAgfTtcbiAgXG4gIGZ1bmN0aW9uIGNvbXBpbGUodEVsZW1lbnQsIHRBdHRycywgdHJhbnNjbHVkZSkge1xuICAgIHRFbGVtZW50LmF0dHIoJ2FyaWEtdmFsdWVtaW4nLCAwKTtcbiAgICB0RWxlbWVudC5hdHRyKCdhcmlhLXZhbHVlbWF4JywgMTAwKTtcbiAgICB0RWxlbWVudC5hdHRyKCdyb2xlJywgJ3Byb2dyZXNzYmFyJyk7XG5cbiAgICByZXR1cm4gcG9zdExpbms7XG4gIH1cbiAgZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcbiAgICAkbWRUaGVtaW5nKGVsZW1lbnQpO1xuICAgIHZhciBiYXIxU3R5bGUgPSBlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJy5tZC1iYXIxJykuc3R5bGUsXG4gICAgICBiYXIyU3R5bGUgPSBlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJy5tZC1iYXIyJykuc3R5bGUsXG4gICAgICBjb250YWluZXIgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCcubWQtY29udGFpbmVyJykpO1xuXG4gICAgYXR0ci4kb2JzZXJ2ZSgndmFsdWUnLCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgaWYgKGF0dHIubWRNb2RlID09ICdxdWVyeScpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgY2xhbXBlZCA9IGNsYW1wKHZhbHVlKTtcbiAgICAgIGVsZW1lbnQuYXR0cignYXJpYS12YWx1ZW5vdycsIGNsYW1wZWQpO1xuICAgICAgYmFyMlN0eWxlWyRtZENvbnN0YW50LkNTUy5UUkFOU0ZPUk1dID0gdHJhbnNmb3Jtc1tjbGFtcGVkXTtcbiAgICB9KTtcblxuICAgIGF0dHIuJG9ic2VydmUoJ21kQnVmZmVyVmFsdWUnLCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgYmFyMVN0eWxlWyRtZENvbnN0YW50LkNTUy5UUkFOU0ZPUk1dID0gdHJhbnNmb3Jtc1tjbGFtcCh2YWx1ZSldO1xuICAgIH0pO1xuXG4gICAgJCRyQUYoZnVuY3Rpb24oKSB7XG4gICAgICBjb250YWluZXIuYWRkQ2xhc3MoJ21kLXJlYWR5Jyk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBjbGFtcCh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSA+IDEwMCkge1xuICAgICAgcmV0dXJuIDEwMDtcbiAgICB9XG5cbiAgICBpZiAodmFsdWUgPCAwKSB7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG5cbiAgICByZXR1cm4gTWF0aC5jZWlsKHZhbHVlIHx8IDApO1xuICB9XG59XG5NZFByb2dyZXNzTGluZWFyRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkJHJBRlwiLCBcIiRtZENvbnN0YW50XCIsIFwiJG1kVGhlbWluZ1wiXTtcblxuXG4vLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4vLyBQcml2YXRlIE1ldGhvZHNcbi8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbnZhciB0cmFuc2Zvcm1zID0gKGZ1bmN0aW9uKCkge1xuICB2YXIgdmFsdWVzID0gbmV3IEFycmF5KDEwMSk7XG4gIGZvcih2YXIgaSA9IDA7IGkgPCAxMDE7IGkrKyl7XG4gICAgdmFsdWVzW2ldID0gbWFrZVRyYW5zZm9ybShpKTtcbiAgfVxuXG4gIHJldHVybiB2YWx1ZXM7XG5cbiAgZnVuY3Rpb24gbWFrZVRyYW5zZm9ybSh2YWx1ZSl7XG4gICAgdmFyIHNjYWxlID0gdmFsdWUvMTAwO1xuICAgIHZhciB0cmFuc2xhdGVYID0gKHZhbHVlLTEwMCkvMjtcbiAgICByZXR1cm4gJ3RyYW5zbGF0ZVgoJyArIHRyYW5zbGF0ZVgudG9TdHJpbmcoKSArICclKSBzY2FsZSgnICsgc2NhbGUudG9TdHJpbmcoKSArICcsIDEpJztcbiAgfVxufSkoKTtcblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogQG5nZG9jIG1vZHVsZVxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5yYWRpb0J1dHRvblxuICogQGRlc2NyaXB0aW9uIHJhZGlvQnV0dG9uIG1vZHVsZSFcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMucmFkaW9CdXR0b24nLCBbXG4gICdtYXRlcmlhbC5jb3JlJ1xuXSlcbiAgLmRpcmVjdGl2ZSgnbWRSYWRpb0dyb3VwJywgbWRSYWRpb0dyb3VwRGlyZWN0aXZlKVxuICAuZGlyZWN0aXZlKCdtZFJhZGlvQnV0dG9uJywgbWRSYWRpb0J1dHRvbkRpcmVjdGl2ZSk7XG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnJhZGlvQnV0dG9uXG4gKiBAbmFtZSBtZFJhZGlvR3JvdXBcbiAqXG4gKiBAcmVzdHJpY3QgRVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogVGhlIGA8bWQtcmFkaW8tZ3JvdXA+YCBkaXJlY3RpdmUgaWRlbnRpZmllcyBhIGdyb3VwaW5nXG4gKiBjb250YWluZXIgZm9yIHRoZSAxLi5uIGdyb3VwZWQgcmFkaW8gYnV0dG9uczsgc3BlY2lmaWVkIHVzaW5nIG5lc3RlZFxuICogYDxtZC1yYWRpby1idXR0b24+YCB0YWdzLlxuICpcbiAqIEFzIHBlciB0aGUgW21hdGVyaWFsIGRlc2lnbiBzcGVjXShodHRwOi8vd3d3Lmdvb2dsZS5jb20vZGVzaWduL3NwZWMvc3R5bGUvY29sb3IuaHRtbCNjb2xvci11aS1jb2xvci1hcHBsaWNhdGlvbilcbiAqIHRoZSByYWRpbyBidXR0b24gaXMgaW4gdGhlIGFjY2VudCBjb2xvciBieSBkZWZhdWx0LiBUaGUgcHJpbWFyeSBjb2xvciBwYWxldHRlIG1heSBiZSB1c2VkIHdpdGhcbiAqIHRoZSBgbWQtcHJpbWFyeWAgY2xhc3MuXG4gKlxuICogTm90ZTogYDxtZC1yYWRpby1ncm91cD5gIGFuZCBgPG1kLXJhZGlvLWJ1dHRvbj5gIGhhbmRsZSB0YWJpbmRleCBkaWZmZXJlbnRseVxuICogdGhhbiB0aGUgbmF0aXZlIGA8aW5wdXQgdHlwZT0ncmFkaW8nPmAgY29udHJvbHMuIFdoZXJlYXMgdGhlIG5hdGl2ZSBjb250cm9sc1xuICogZm9yY2UgdGhlIHVzZXIgdG8gdGFiIHRocm91Z2ggYWxsIHRoZSByYWRpbyBidXR0b25zLCBgPG1kLXJhZGlvLWdyb3VwPmBcbiAqIGlzIGZvY3VzYWJsZSwgYW5kIGJ5IGRlZmF1bHQgdGhlIGA8bWQtcmFkaW8tYnV0dG9uPmBzIGFyZSBub3QuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IG5nLW1vZGVsIEFzc2lnbmFibGUgYW5ndWxhciBleHByZXNzaW9uIHRvIGRhdGEtYmluZCB0by5cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG1kLW5vLWluayBVc2Ugb2YgYXR0cmlidXRlIGluZGljYXRlcyBmbGFnIHRvIGRpc2FibGUgaW5rIHJpcHBsZSBlZmZlY3RzLlxuICpcbiAqIEB1c2FnZVxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cbiAqIDxtZC1yYWRpby1ncm91cCBuZy1tb2RlbD1cInNlbGVjdGVkXCI+XG4gKlxuICogICA8bWQtcmFkaW8tYnV0dG9uXG4gKiAgICAgICAgbmctcmVwZWF0PVwiZCBpbiBjb2xvck9wdGlvbnNcIlxuICogICAgICAgIG5nLXZhbHVlPVwiZC52YWx1ZVwiIGFyaWEtbGFiZWw9XCJ7eyBkLmxhYmVsIH19XCI+XG4gKlxuICogICAgICAgICAge3sgZC5sYWJlbCB9fVxuICpcbiAqICAgPC9tZC1yYWRpby1idXR0b24+XG4gKlxuICogPC9tZC1yYWRpby1ncm91cD5cbiAqIDwvaGxqcz5cbiAqXG4gKi9cbmZ1bmN0aW9uIG1kUmFkaW9Hcm91cERpcmVjdGl2ZSgkbWRVdGlsLCAkbWRDb25zdGFudCwgJG1kVGhlbWluZywgJHRpbWVvdXQpIHtcbiAgUmFkaW9Hcm91cENvbnRyb2xsZXIucHJvdG90eXBlID0gY3JlYXRlUmFkaW9Hcm91cENvbnRyb2xsZXJQcm90bygpO1xuXG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdFJyxcbiAgICBjb250cm9sbGVyOiBbJyRlbGVtZW50JywgUmFkaW9Hcm91cENvbnRyb2xsZXJdLFxuICAgIHJlcXVpcmU6IFsnbWRSYWRpb0dyb3VwJywgJz9uZ01vZGVsJ10sXG4gICAgbGluazogeyBwcmU6IGxpbmtSYWRpb0dyb3VwIH1cbiAgfTtcblxuICBmdW5jdGlvbiBsaW5rUmFkaW9Hcm91cChzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybHMpIHtcbiAgICAkbWRUaGVtaW5nKGVsZW1lbnQpO1xuICAgIHZhciByZ0N0cmwgPSBjdHJsc1swXTtcbiAgICB2YXIgbmdNb2RlbEN0cmwgPSBjdHJsc1sxXSB8fCAkbWRVdGlsLmZha2VOZ01vZGVsKCk7XG5cbiAgICBmdW5jdGlvbiBzZXRGb2N1cygpIHtcbiAgICAgIGlmICghZWxlbWVudC5oYXNDbGFzcygnbWQtZm9jdXNlZCcpKSB7IGVsZW1lbnQuYWRkQ2xhc3MoJ21kLWZvY3VzZWQnKTsgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGtleWRvd25MaXN0ZW5lcihldikge1xuICAgICAgdmFyIGtleUNvZGUgPSBldi53aGljaCB8fCBldi5rZXlDb2RlO1xuICAgICAgc3dpdGNoKGtleUNvZGUpIHtcbiAgICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5MRUZUX0FSUk9XOlxuICAgICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLlVQX0FSUk9XOlxuICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgcmdDdHJsLnNlbGVjdFByZXZpb3VzKCk7XG4gICAgICAgICAgc2V0Rm9jdXMoKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLlJJR0hUX0FSUk9XOlxuICAgICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLkRPV05fQVJST1c6XG4gICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICByZ0N0cmwuc2VsZWN0TmV4dCgpO1xuICAgICAgICAgIHNldEZvY3VzKCk7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5FTlRFUjpcbiAgICAgICAgICB2YXIgZm9ybSA9IGFuZ3VsYXIuZWxlbWVudCgkbWRVdGlsLmdldENsb3Nlc3QoZWxlbWVudFswXSwgJ2Zvcm0nKSk7XG4gICAgICAgICAgaWYgKGZvcm0ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZm9ybS50cmlnZ2VySGFuZGxlcignc3VibWl0Jyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJnQ3RybC5pbml0KG5nTW9kZWxDdHJsKTtcblxuICAgIHNjb3BlLm1vdXNlQWN0aXZlID0gZmFsc2U7XG4gICAgZWxlbWVudC5hdHRyKHtcbiAgICAgICAgICAgICAgJ3JvbGUnOiAncmFkaW9ncm91cCcsXG4gICAgICAgICAgICAgICd0YWJJbmRleCc6IGVsZW1lbnQuYXR0cigndGFiaW5kZXgnKSB8fCAnMCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAub24oJ2tleWRvd24nLCBrZXlkb3duTGlzdGVuZXIpXG4gICAgICAgICAgICAub24oJ21vdXNlZG93bicsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAgIHNjb3BlLm1vdXNlQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc2NvcGUubW91c2VBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAub24oJ2ZvY3VzJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGlmKHNjb3BlLm1vdXNlQWN0aXZlID09PSBmYWxzZSkgeyByZ0N0cmwuJGVsZW1lbnQuYWRkQ2xhc3MoJ21kLWZvY3VzZWQnKTsgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5vbignYmx1cicsIGZ1bmN0aW9uKCkgeyByZ0N0cmwuJGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21kLWZvY3VzZWQnKTsgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBSYWRpb0dyb3VwQ29udHJvbGxlcigkZWxlbWVudCkge1xuICAgIHRoaXMuX3JhZGlvQnV0dG9uUmVuZGVyRm5zID0gW107XG4gICAgdGhpcy4kZWxlbWVudCA9ICRlbGVtZW50O1xuICB9XG5cbiAgZnVuY3Rpb24gY3JlYXRlUmFkaW9Hcm91cENvbnRyb2xsZXJQcm90bygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgaW5pdDogZnVuY3Rpb24obmdNb2RlbEN0cmwpIHtcbiAgICAgICAgdGhpcy5fbmdNb2RlbEN0cmwgPSBuZ01vZGVsQ3RybDtcbiAgICAgICAgdGhpcy5fbmdNb2RlbEN0cmwuJHJlbmRlciA9IGFuZ3VsYXIuYmluZCh0aGlzLCB0aGlzLnJlbmRlcik7XG4gICAgICB9LFxuICAgICAgYWRkOiBmdW5jdGlvbihyYlJlbmRlcikge1xuICAgICAgICB0aGlzLl9yYWRpb0J1dHRvblJlbmRlckZucy5wdXNoKHJiUmVuZGVyKTtcbiAgICAgIH0sXG4gICAgICByZW1vdmU6IGZ1bmN0aW9uKHJiUmVuZGVyKSB7XG4gICAgICAgIHZhciBpbmRleCA9IHRoaXMuX3JhZGlvQnV0dG9uUmVuZGVyRm5zLmluZGV4T2YocmJSZW5kZXIpO1xuICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgdGhpcy5fcmFkaW9CdXR0b25SZW5kZXJGbnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuX3JhZGlvQnV0dG9uUmVuZGVyRm5zLmZvckVhY2goZnVuY3Rpb24ocmJSZW5kZXIpIHtcbiAgICAgICAgICByYlJlbmRlcigpO1xuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBzZXRWaWV3VmFsdWU6IGZ1bmN0aW9uKHZhbHVlLCBldmVudFR5cGUpIHtcbiAgICAgICAgdGhpcy5fbmdNb2RlbEN0cmwuJHNldFZpZXdWYWx1ZSh2YWx1ZSwgZXZlbnRUeXBlKTtcbiAgICAgICAgLy8gdXBkYXRlIHRoZSBvdGhlciByYWRpbyBidXR0b25zIGFzIHdlbGxcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgIH0sXG4gICAgICBnZXRWaWV3VmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbmdNb2RlbEN0cmwuJHZpZXdWYWx1ZTtcbiAgICAgIH0sXG4gICAgICBzZWxlY3ROZXh0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIGNoYW5nZVNlbGVjdGVkQnV0dG9uKHRoaXMuJGVsZW1lbnQsIDEpO1xuICAgICAgfSxcbiAgICAgIHNlbGVjdFByZXZpb3VzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIGNoYW5nZVNlbGVjdGVkQnV0dG9uKHRoaXMuJGVsZW1lbnQsIC0xKTtcbiAgICAgIH0sXG4gICAgICBzZXRBY3RpdmVEZXNjZW5kYW50OiBmdW5jdGlvbiAocmFkaW9JZCkge1xuICAgICAgICB0aGlzLiRlbGVtZW50LmF0dHIoJ2FyaWEtYWN0aXZlZGVzY2VuZGFudCcsIHJhZGlvSWQpO1xuICAgICAgfVxuICAgIH07XG4gIH1cbiAgLyoqXG4gICAqIENoYW5nZSB0aGUgcmFkaW8gZ3JvdXAncyBzZWxlY3RlZCBidXR0b24gYnkgYSBnaXZlbiBpbmNyZW1lbnQuXG4gICAqIElmIG5vIGJ1dHRvbiBpcyBzZWxlY3RlZCwgc2VsZWN0IHRoZSBmaXJzdCBidXR0b24uXG4gICAqL1xuICBmdW5jdGlvbiBjaGFuZ2VTZWxlY3RlZEJ1dHRvbihwYXJlbnQsIGluY3JlbWVudCkge1xuICAgIC8vIENvZXJjZSBhbGwgY2hpbGQgcmFkaW8gYnV0dG9ucyBpbnRvIGFuIGFycmF5LCB0aGVuIHdyYXAgdGhlbiBpbiBhbiBpdGVyYXRvclxuICAgIHZhciBidXR0b25zID0gJG1kVXRpbC5pdGVyYXRvcihwYXJlbnRbMF0ucXVlcnlTZWxlY3RvckFsbCgnbWQtcmFkaW8tYnV0dG9uJyksIHRydWUpO1xuXG4gICAgaWYgKGJ1dHRvbnMuY291bnQoKSkge1xuICAgICAgdmFyIHZhbGlkYXRlID0gZnVuY3Rpb24gKGJ1dHRvbikge1xuICAgICAgICAvLyBJZiBkaXNhYmxlZCwgdGhlbiBOT1QgdmFsaWRcbiAgICAgICAgcmV0dXJuICFhbmd1bGFyLmVsZW1lbnQoYnV0dG9uKS5hdHRyKFwiZGlzYWJsZWRcIik7XG4gICAgICB9O1xuICAgICAgdmFyIHNlbGVjdGVkID0gcGFyZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJ21kLXJhZGlvLWJ1dHRvbi5tZC1jaGVja2VkJyk7XG4gICAgICB2YXIgdGFyZ2V0ID0gYnV0dG9uc1tpbmNyZW1lbnQgPCAwID8gJ3ByZXZpb3VzJyA6ICduZXh0J10oc2VsZWN0ZWQsIHZhbGlkYXRlKSB8fCBidXR0b25zLmZpcnN0KCk7XG4gICAgICAvLyBBY3RpdmF0ZSByYWRpb0J1dHRvbidzIGNsaWNrIGxpc3RlbmVyICh0cmlnZ2VySGFuZGxlciB3b24ndCBjcmVhdGUgYSByZWFsIGNsaWNrIGV2ZW50KVxuICAgICAgYW5ndWxhci5lbGVtZW50KHRhcmdldCkudHJpZ2dlckhhbmRsZXIoJ2NsaWNrJyk7XG5cblxuICAgIH1cbiAgfVxuXG59XG5tZFJhZGlvR3JvdXBEaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZFV0aWxcIiwgXCIkbWRDb25zdGFudFwiLCBcIiRtZFRoZW1pbmdcIiwgXCIkdGltZW91dFwiXTtcblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMucmFkaW9CdXR0b25cbiAqIEBuYW1lIG1kUmFkaW9CdXR0b25cbiAqXG4gKiBAcmVzdHJpY3QgRVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogVGhlIGA8bWQtcmFkaW8tYnV0dG9uPmBkaXJlY3RpdmUgaXMgdGhlIGNoaWxkIGRpcmVjdGl2ZSByZXF1aXJlZCB0byBiZSB1c2VkIHdpdGhpbiBgPG1kLXJhZGlvLWdyb3VwPmAgZWxlbWVudHMuXG4gKlxuICogV2hpbGUgc2ltaWxhciB0byB0aGUgYDxpbnB1dCB0eXBlPVwicmFkaW9cIiBuZy1tb2RlbD1cIlwiIHZhbHVlPVwiXCI+YCBkaXJlY3RpdmUsXG4gKiB0aGUgYDxtZC1yYWRpby1idXR0b24+YCBkaXJlY3RpdmUgcHJvdmlkZXMgaW5rIGVmZmVjdHMsIEFSSUEgc3VwcG9ydCwgYW5kXG4gKiBzdXBwb3J0cyB1c2Ugd2l0aGluIG5hbWVkIHJhZGlvIGdyb3Vwcy5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbmdNb2RlbCBBc3NpZ25hYmxlIGFuZ3VsYXIgZXhwcmVzc2lvbiB0byBkYXRhLWJpbmQgdG8uXG4gKiBAcGFyYW0ge3N0cmluZz19IG5nQ2hhbmdlIEFuZ3VsYXIgZXhwcmVzc2lvbiB0byBiZSBleGVjdXRlZCB3aGVuIGlucHV0IGNoYW5nZXMgZHVlIHRvIHVzZXJcbiAqICAgIGludGVyYWN0aW9uIHdpdGggdGhlIGlucHV0IGVsZW1lbnQuXG4gKiBAcGFyYW0ge3N0cmluZ30gbmdWYWx1ZSBBbmd1bGFyIGV4cHJlc3Npb24gd2hpY2ggc2V0cyB0aGUgdmFsdWUgdG8gd2hpY2ggdGhlIGV4cHJlc3Npb24gc2hvdWxkXG4gKiAgICBiZSBzZXQgd2hlbiBzZWxlY3RlZC4qXG4gKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUgVGhlIHZhbHVlIHRvIHdoaWNoIHRoZSBleHByZXNzaW9uIHNob3VsZCBiZSBzZXQgd2hlbiBzZWxlY3RlZC5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gbmFtZSBQcm9wZXJ0eSBuYW1lIG9mIHRoZSBmb3JtIHVuZGVyIHdoaWNoIHRoZSBjb250cm9sIGlzIHB1Ymxpc2hlZC5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gYXJpYS1sYWJlbCBBZGRzIGxhYmVsIHRvIHJhZGlvIGJ1dHRvbiBmb3IgYWNjZXNzaWJpbGl0eS5cbiAqIERlZmF1bHRzIHRvIHJhZGlvIGJ1dHRvbidzIHRleHQuIElmIG5vIHRleHQgY29udGVudCBpcyBhdmFpbGFibGUsIGEgd2FybmluZyB3aWxsIGJlIGxvZ2dlZC5cbiAqXG4gKiBAdXNhZ2VcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKlxuICogPG1kLXJhZGlvLWJ1dHRvbiB2YWx1ZT1cIjFcIiBhcmlhLWxhYmVsPVwiTGFiZWwgMVwiPlxuICogICBMYWJlbCAxXG4gKiA8L21kLXJhZGlvLWJ1dHRvbj5cbiAqXG4gKiA8bWQtcmFkaW8tYnV0dG9uIG5nLW1vZGVsPVwiY29sb3JcIiBuZy12YWx1ZT1cInNwZWNpYWxWYWx1ZVwiIGFyaWEtbGFiZWw9XCJHcmVlblwiPlxuICogICBHcmVlblxuICogPC9tZC1yYWRpby1idXR0b24+XG4gKlxuICogPC9obGpzPlxuICpcbiAqL1xuZnVuY3Rpb24gbWRSYWRpb0J1dHRvbkRpcmVjdGl2ZSgkbWRBcmlhLCAkbWRVdGlsLCAkbWRUaGVtaW5nKSB7XG5cbiAgdmFyIENIRUNLRURfQ1NTID0gJ21kLWNoZWNrZWQnO1xuXG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdFJyxcbiAgICByZXF1aXJlOiAnXm1kUmFkaW9Hcm91cCcsXG4gICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICB0ZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJtZC1jb250YWluZXJcIiBtZC1pbmstcmlwcGxlIG1kLWluay1yaXBwbGUtY2hlY2tib3g+JyArXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJtZC1vZmZcIj48L2Rpdj4nICtcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cIm1kLW9uXCI+PC9kaXY+JyArXG4gICAgICAgICAgICAgICc8L2Rpdj4nICtcbiAgICAgICAgICAgICAgJzxkaXYgbmctdHJhbnNjbHVkZSBjbGFzcz1cIm1kLWxhYmVsXCI+PC9kaXY+JyxcbiAgICBsaW5rOiBsaW5rXG4gIH07XG5cbiAgZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0ciwgcmdDdHJsKSB7XG4gICAgdmFyIGxhc3RDaGVja2VkO1xuXG4gICAgJG1kVGhlbWluZyhlbGVtZW50KTtcbiAgICBjb25maWd1cmVBcmlhKGVsZW1lbnQsIHNjb3BlKTtcblxuICAgIHJnQ3RybC5hZGQocmVuZGVyKTtcbiAgICBhdHRyLiRvYnNlcnZlKCd2YWx1ZScsIHJlbmRlcik7XG5cbiAgICBlbGVtZW50XG4gICAgICAub24oJ2NsaWNrJywgbGlzdGVuZXIpXG4gICAgICAub24oJyRkZXN0cm95JywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJnQ3RybC5yZW1vdmUocmVuZGVyKTtcbiAgICAgIH0pO1xuXG4gICAgZnVuY3Rpb24gbGlzdGVuZXIoZXYpIHtcbiAgICAgIGlmIChlbGVtZW50WzBdLmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkgcmV0dXJuO1xuXG4gICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJnQ3RybC5zZXRWaWV3VmFsdWUoYXR0ci52YWx1ZSwgZXYgJiYgZXYudHlwZSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICB2YXIgY2hlY2tlZCA9IChyZ0N0cmwuZ2V0Vmlld1ZhbHVlKCkgPT0gYXR0ci52YWx1ZSk7XG4gICAgICBpZiAoY2hlY2tlZCA9PT0gbGFzdENoZWNrZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgbGFzdENoZWNrZWQgPSBjaGVja2VkO1xuICAgICAgZWxlbWVudC5hdHRyKCdhcmlhLWNoZWNrZWQnLCBjaGVja2VkKTtcbiAgICAgIGlmIChjaGVja2VkKSB7XG4gICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoQ0hFQ0tFRF9DU1MpO1xuICAgICAgICByZ0N0cmwuc2V0QWN0aXZlRGVzY2VuZGFudChlbGVtZW50LmF0dHIoJ2lkJykpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcyhDSEVDS0VEX0NTUyk7XG4gICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEluamVjdCBBUklBLXNwZWNpZmljIGF0dHJpYnV0ZXMgYXBwcm9wcmlhdGUgZm9yIGVhY2ggcmFkaW8gYnV0dG9uXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29uZmlndXJlQXJpYSggZWxlbWVudCwgc2NvcGUgKXtcbiAgICAgIHNjb3BlLmFyaWFJZCA9IGJ1aWxkQXJpYUlEKCk7XG5cbiAgICAgIGVsZW1lbnQuYXR0cih7XG4gICAgICAgICdpZCcgOiAgc2NvcGUuYXJpYUlkLFxuICAgICAgICAncm9sZScgOiAncmFkaW8nLFxuICAgICAgICAnYXJpYS1jaGVja2VkJyA6ICdmYWxzZSdcbiAgICAgIH0pO1xuXG4gICAgICAkbWRBcmlhLmV4cGVjdFdpdGhUZXh0KGVsZW1lbnQsICdhcmlhLWxhYmVsJyk7XG5cbiAgICAgIC8qKlxuICAgICAgICogQnVpbGQgYSB1bmlxdWUgSUQgZm9yIGVhY2ggcmFkaW8gYnV0dG9uIHRoYXQgd2lsbCBiZSB1c2VkIHdpdGggYXJpYS1hY3RpdmVkZXNjZW5kYW50LlxuICAgICAgICogUHJlc2VydmUgZXhpc3RpbmcgSUQgaWYgYWxyZWFkeSBzcGVjaWZpZWQuXG4gICAgICAgKiBAcmV0dXJucyB7KnxzdHJpbmd9XG4gICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIGJ1aWxkQXJpYUlEKCkge1xuICAgICAgICByZXR1cm4gYXR0ci5pZCB8fCAoICdyYWRpbycgKyBcIl9cIiArICRtZFV0aWwubmV4dFVpZCgpICk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5tZFJhZGlvQnV0dG9uRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkbWRBcmlhXCIsIFwiJG1kVXRpbFwiLCBcIiRtZFRoZW1pbmdcIl07XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIEBuZ2RvYyBtb2R1bGVcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuc2VsZWN0XG4gKi9cblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXG4jIyMgVE9ETyAjIyNcbioqRE9DVU1FTlRBVElPTiBBTkQgREVNT1MqKlxuXG4tIFsgXSBuZy1tb2RlbCB3aXRoIGNoaWxkIG1kT3B0aW9ucyAoYmFzaWMpXG4tIFsgXSBuZy1tb2RlbD1cImZvb1wiIG5nLW1vZGVsLW9wdGlvbnM9XCJ7IHRyYWNrQnk6ICckdmFsdWUuaWQnIH1cIiBmb3Igb2JqZWN0c1xuLSBbIF0gbWRPcHRpb24gd2l0aCB2YWx1ZVxuLSBbIF0gVXNhZ2Ugd2l0aCBpbnB1dCBpbnNpZGVcblxuIyMjIFRPRE8gLSBQT1NUIFJDMSAjIyNcbi0gWyBdIEFic3RyYWN0IHBsYWNlbWVudCBsb2dpYyBpbiAkbWRTZWxlY3Qgc2VydmljZSB0byAkbWRNZW51IHNlcnZpY2VcblxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG52YXIgU0VMRUNUX0VER0VfTUFSR0lOID0gODtcbnZhciBzZWxlY3ROZXh0SWQgPSAwO1xuXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5zZWxlY3QnLCBbXG4gICdtYXRlcmlhbC5jb3JlJyxcbiAgJ21hdGVyaWFsLmNvbXBvbmVudHMuYmFja2Ryb3AnXG5dKVxuLmRpcmVjdGl2ZSgnbWRTZWxlY3QnLCBTZWxlY3REaXJlY3RpdmUpXG4uZGlyZWN0aXZlKCdtZFNlbGVjdE1lbnUnLCBTZWxlY3RNZW51RGlyZWN0aXZlKVxuLmRpcmVjdGl2ZSgnbWRPcHRpb24nLCBPcHRpb25EaXJlY3RpdmUpXG4uZGlyZWN0aXZlKCdtZE9wdGdyb3VwJywgT3B0Z3JvdXBEaXJlY3RpdmUpXG4ucHJvdmlkZXIoJyRtZFNlbGVjdCcsIFNlbGVjdFByb3ZpZGVyKTtcblxuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG1kU2VsZWN0XG4gKiBAcmVzdHJpY3QgRVxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnNlbGVjdFxuICpcbiAqIEBkZXNjcmlwdGlvbiBEaXNwbGF5cyBhIHNlbGVjdCBib3gsIGJvdW5kIHRvIGFuIG5nLW1vZGVsLlxuICpcbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbn0gbmctbW9kZWwgVGhlIG1vZGVsIVxuICogQHBhcmFtIHtleHByZXNzaW9uPX0gbWQtb24tY2xvc2UgZXhwcmVzc2lvbiB0byBiZSBldmFsdWF0ZWQgd2hlbiB0aGUgc2VsZWN0IGlzIGNsb3NlZFxuICogQHBhcmFtIHtib29sZWFuPX0gbXVsdGlwbGUgV2hldGhlciBpdCdzIG11bHRpcGxlLlxuICogQHBhcmFtIHtzdHJpbmc9fSBwbGFjZWhvbGRlciBQbGFjZWhvbGRlciBoaW50IHRleHQuXG4gKiBAcGFyYW0ge3N0cmluZz19IGFyaWEtbGFiZWwgT3B0aW9uYWwgbGFiZWwgZm9yIGFjY2Vzc2liaWxpdHkuIE9ubHkgbmVjZXNzYXJ5IGlmIG5vIHBsYWNlaG9sZGVyIG9yXG4gKiBleHBsaWNpdCBsYWJlbCBpcyBwcmVzZW50LlxuICpcbiAqIEB1c2FnZVxuICogV2l0aCBhIHBsYWNlaG9sZGVyIChsYWJlbCBhbmQgYXJpYS1sYWJlbCBhcmUgYWRkZWQgZHluYW1pY2FsbHkpXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxuICogICA8bWQtc2VsZWN0XG4gKiAgICAgbmctbW9kZWw9XCJzb21lTW9kZWxcIlxuICogICAgIHBsYWNlaG9sZGVyPVwiU2VsZWN0IGEgc3RhdGVcIj5cbiAqICAgICA8bWQtb3B0aW9uIG5nLXZhbHVlPVwib3B0XCIgbmctcmVwZWF0PVwib3B0IGluIG5laWdoYm9yaG9vZHMyXCI+e3sgb3B0IH19PC9tZC1vcHRpb24+XG4gKiAgIDwvbWQtc2VsZWN0PlxuICogPC9obGpzPlxuICpcbiAqIFdpdGggYW4gZXhwbGljaXQgbGFiZWxcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiAgIDxtZC1zZWxlY3RcbiAqICAgICBuZy1tb2RlbD1cInNvbWVNb2RlbFwiPlxuICogICAgIDxtZC1zZWxlY3QtbGFiZWw+U2VsZWN0IGEgc3RhdGU8L21kLXNlbGVjdC1sYWJlbD5cbiAqICAgICA8bWQtb3B0aW9uIG5nLXZhbHVlPVwib3B0XCIgbmctcmVwZWF0PVwib3B0IGluIG5laWdoYm9yaG9vZHMyXCI+e3sgb3B0IH19PC9tZC1vcHRpb24+XG4gKiAgIDwvbWQtc2VsZWN0PlxuICogPC9obGpzPlxuICovXG5mdW5jdGlvbiBTZWxlY3REaXJlY3RpdmUoJG1kU2VsZWN0LCAkbWRVdGlsLCAkbWRUaGVtaW5nLCAkbWRBcmlhLCAkaW50ZXJwb2xhdGUsICRjb21waWxlLCAkcGFyc2UpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0UnLFxuICAgIHJlcXVpcmU6IFsnbWRTZWxlY3QnLCAnbmdNb2RlbCcsICc/XmZvcm0nXSxcbiAgICBjb21waWxlOiBjb21waWxlLFxuICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uKCkgeyB9IC8vIGVtcHR5IHBsYWNlaG9sZGVyIGNvbnRyb2xsZXIgdG8gYmUgaW5pdGlhbGl6ZWQgaW4gbGlua1xuICB9O1xuXG4gIGZ1bmN0aW9uIGNvbXBpbGUoZWxlbWVudCwgYXR0cikge1xuICAgIC8vIFRoZSB1c2VyIGlzIGFsbG93ZWQgdG8gcHJvdmlkZSBhIGxhYmVsIGZvciB0aGUgc2VsZWN0IGFzIG1kLXNlbGVjdC1sYWJlbCBjaGlsZFxuICAgIHZhciBsYWJlbEVsID0gZWxlbWVudC5maW5kKCdtZC1zZWxlY3QtbGFiZWwnKS5yZW1vdmUoKTtcblxuICAgIC8vIElmIG5vdCBwcm92aWRlZCwgd2UgYXV0b21hdGljYWxseSBtYWtlIG9uZVxuICAgIGlmICghbGFiZWxFbC5sZW5ndGgpIHtcbiAgICAgIGxhYmVsRWwgPSBhbmd1bGFyLmVsZW1lbnQoJzxtZC1zZWxlY3QtbGFiZWw+PHNwYW4+PC9zcGFuPjwvbWQtc2VsZWN0LWxhYmVsPicpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoIWxhYmVsRWxbMF0uZmlyc3RFbGVtZW50Q2hpbGQpIHtcbiAgICAgICAgdmFyIHNwYW5XcmFwcGVyID0gYW5ndWxhci5lbGVtZW50KCc8c3Bhbj4nKTtcbiAgICAgICAgc3BhbldyYXBwZXIuYXBwZW5kKGxhYmVsRWwuY29udGVudHMoKSk7XG4gICAgICAgIGxhYmVsRWwuYXBwZW5kKHNwYW5XcmFwcGVyKTtcbiAgICAgIH1cbiAgICB9XG4gICAgbGFiZWxFbC5hcHBlbmQoJzxzcGFuIGNsYXNzPVwibWQtc2VsZWN0LWljb25cIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L3NwYW4+Jyk7XG4gICAgbGFiZWxFbC5hZGRDbGFzcygnbWQtc2VsZWN0LWxhYmVsJyk7XG4gICAgaWYgKCFsYWJlbEVsWzBdLmhhc0F0dHJpYnV0ZSgnaWQnKSkge1xuICAgICAgbGFiZWxFbC5hdHRyKCdpZCcsICdzZWxlY3RfbGFiZWxfJyArICRtZFV0aWwubmV4dFVpZCgpKTtcbiAgICB9XG5cbiAgICAvLyBUaGVyZSdzIGdvdCB0byBiZSBhbiBtZC1jb250ZW50IGluc2lkZS4gSWYgdGhlcmUncyBub3Qgb25lLCBsZXQncyBhZGQgaXQuXG4gICAgaWYgKCFlbGVtZW50LmZpbmQoJ21kLWNvbnRlbnQnKS5sZW5ndGgpIHtcbiAgICAgIGVsZW1lbnQuYXBwZW5kKCBhbmd1bGFyLmVsZW1lbnQoJzxtZC1jb250ZW50PicpLmFwcGVuZChlbGVtZW50LmNvbnRlbnRzKCkpICk7XG4gICAgfVxuXG4gICAgLy8gQWRkIHByb2dyZXNzIHNwaW5uZXIgZm9yIG1kLW9wdGlvbnMtbG9hZGluZ1xuICAgIGlmIChhdHRyLm1kT25PcGVuKSB7XG4gICAgICBlbGVtZW50LmZpbmQoJ21kLWNvbnRlbnQnKS5wcmVwZW5kKFxuICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJzxtZC1wcm9ncmVzcy1jaXJjdWxhcj4nKVxuICAgICAgICAgICAgICAgLmF0dHIoJ21kLW1vZGUnLCAnaW5kZXRlcm1pbmF0ZScpXG4gICAgICAgICAgICAgICAuYXR0cignbmctaGlkZScsICckJGxvYWRpbmdBc3luY0RvbmUnKVxuICAgICAgICAgICAgICAgLndyYXAoJzxkaXY+JylcbiAgICAgICAgICAgICAgIC5wYXJlbnQoKVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoYXR0ci5uYW1lKSB7XG4gICAgICB2YXIgYXV0b2ZpbGxDbG9uZSA9IGFuZ3VsYXIuZWxlbWVudCgnPHNlbGVjdCBjbGFzcz1cIm1kLXZpc3VhbGx5LWhpZGRlblwiPicpO1xuICAgICAgYXV0b2ZpbGxDbG9uZS5hdHRyKHtcbiAgICAgICAgJ25hbWUnOiAnLicgKyBhdHRyLm5hbWUsXG4gICAgICAgICduZy1tb2RlbCc6IGF0dHIubmdNb2RlbCxcbiAgICAgICAgJ2FyaWEtaGlkZGVuJzogJ3RydWUnLFxuICAgICAgICAndGFiaW5kZXgnOiAnLTEnXG4gICAgICB9KTtcbiAgICAgIHZhciBvcHRzID0gZWxlbWVudC5maW5kKCdtZC1vcHRpb24nKTtcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChvcHRzLCBmdW5jdGlvbihlbCkge1xuICAgICAgICB2YXIgbmV3RWwgPSBhbmd1bGFyLmVsZW1lbnQoJzxvcHRpb24+JyArIGVsLmlubmVySFRNTCArICc8L29wdGlvbj4nKTtcbiAgICAgICAgaWYgKGVsLmhhc0F0dHJpYnV0ZSgnbmctdmFsdWUnKSkgbmV3RWwuYXR0cignbmctdmFsdWUnLCBlbC5nZXRBdHRyaWJ1dGUoJ25nLXZhbHVlJykpO1xuICAgICAgICBlbHNlIGlmIChlbC5oYXNBdHRyaWJ1dGUoJ3ZhbHVlJykpIG5ld0VsLmF0dHIoJ3ZhbHVlJywgZWwuZ2V0QXR0cmlidXRlKCd2YWx1ZScpKTtcbiAgICAgICAgYXV0b2ZpbGxDbG9uZS5hcHBlbmQobmV3RWwpO1xuICAgICAgfSk7XG5cbiAgICAgIGVsZW1lbnQucGFyZW50KCkuYXBwZW5kKGF1dG9maWxsQ2xvbmUpO1xuICAgIH1cblxuICAgIC8vIFVzZSBldmVyeXRoaW5nIHRoYXQncyBsZWZ0IGluc2lkZSBlbGVtZW50LmNvbnRlbnRzKCkgYXMgdGhlIGNvbnRlbnRzIG9mIHRoZSBtZW51XG4gICAgdmFyIHNlbGVjdFRlbXBsYXRlID0gJzxkaXYgY2xhc3M9XCJtZC1zZWxlY3QtbWVudS1jb250YWluZXJcIj4nICtcbiAgICAgICAgJzxtZC1zZWxlY3QtbWVudSAnICtcbiAgICAgICAgKGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHIubXVsdGlwbGUpID8gJ211bHRpcGxlJyA6ICcnKSArICc+JyArXG4gICAgICAgICAgZWxlbWVudC5odG1sKCkgK1xuICAgICAgICAnPC9tZC1zZWxlY3QtbWVudT48L2Rpdj4nO1xuXG4gICAgZWxlbWVudC5lbXB0eSgpLmFwcGVuZChsYWJlbEVsKTtcblxuICAgIGF0dHIudGFiaW5kZXggPSBhdHRyLnRhYmluZGV4IHx8ICcwJztcblxuICAgIHJldHVybiBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybHMpIHtcbiAgICAgIHZhciBpc09wZW47XG4gICAgICB2YXIgaXNEaXNhYmxlZDtcblxuICAgICAgdmFyIG1kU2VsZWN0Q3RybCA9IGN0cmxzWzBdO1xuICAgICAgdmFyIG5nTW9kZWwgPSBjdHJsc1sxXTtcbiAgICAgIHZhciBmb3JtQ3RybCA9IGN0cmxzWzJdO1xuXG4gICAgICB2YXIgbGFiZWxFbCA9IGVsZW1lbnQuZmluZCgnbWQtc2VsZWN0LWxhYmVsJyk7XG4gICAgICB2YXIgY3VzdG9tTGFiZWwgPSBsYWJlbEVsLnRleHQoKS5sZW5ndGggIT09IDA7XG4gICAgICB2YXIgc2VsZWN0Q29udGFpbmVyLCBzZWxlY3RTY29wZSwgc2VsZWN0TWVudUN0cmw7XG4gICAgICBjcmVhdGVTZWxlY3QoKTtcblxuICAgICAgJG1kVGhlbWluZyhlbGVtZW50KTtcblxuICAgICAgaWYgKGF0dHIubmFtZSAmJiBmb3JtQ3RybCkge1xuICAgICAgICB2YXIgc2VsZWN0RWwgPSBlbGVtZW50LnBhcmVudCgpWzBdLnF1ZXJ5U2VsZWN0b3IoJ3NlbGVjdFtuYW1lPVwiLicgKyBhdHRyLm5hbWUgKyAnXCJdJyk7XG4gICAgICAgIGZvcm1DdHJsLiRyZW1vdmVDb250cm9sKGFuZ3VsYXIuZWxlbWVudChzZWxlY3RFbCkuY29udHJvbGxlcigpKTtcbiAgICAgIH1cblxuICAgICAgdmFyIG9yaWdpbmFsUmVuZGVyID0gbmdNb2RlbC4kcmVuZGVyO1xuICAgICAgbmdNb2RlbC4kcmVuZGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIG9yaWdpbmFsUmVuZGVyKCk7XG4gICAgICAgIHN5bmNMYWJlbFRleHQoKTtcbiAgICAgIH07XG5cbiAgICAgIG1kU2VsZWN0Q3RybC5zZXRMYWJlbFRleHQgPSBmdW5jdGlvbih0ZXh0KSB7XG4gICAgICAgIGlmIChjdXN0b21MYWJlbCkgcmV0dXJuOyAvLyBBc3N1bWUgdGhhdCB1c2VyIGlzIGhhbmRsaW5nIGl0IG9uIHRoZWlyIG93blxuICAgICAgICBtZFNlbGVjdEN0cmwuc2V0SXNQbGFjZWhvbGRlcighdGV4dCk7XG4gICAgICAgIHRleHQgPSB0ZXh0IHx8IGF0dHIucGxhY2Vob2xkZXIgfHwgJyc7XG4gICAgICAgIHZhciB0YXJnZXQgPSBjdXN0b21MYWJlbCA/IGxhYmVsRWwgOiBsYWJlbEVsLmNoaWxkcmVuKCkuZXEoMCk7XG4gICAgICAgIHRhcmdldC50ZXh0KHRleHQpO1xuICAgICAgfTtcblxuICAgICAgbWRTZWxlY3RDdHJsLnNldElzUGxhY2Vob2xkZXIgPSBmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgdmFsID8gbGFiZWxFbC5hZGRDbGFzcygnbWQtcGxhY2Vob2xkZXInKSA6IGxhYmVsRWwucmVtb3ZlQ2xhc3MoJ21kLXBsYWNlaG9sZGVyJyk7XG4gICAgICB9O1xuXG4gICAgICBtZFNlbGVjdEN0cmwudHJpZ2dlckNsb3NlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICRwYXJzZShhdHRyLm1kT25DbG9zZSkoc2NvcGUpO1xuICAgICAgfTtcblxuICAgICAgc2NvcGUuJCRwb3N0RGlnZXN0KGZ1bmN0aW9uKCkge1xuICAgICAgICBzZXRBcmlhTGFiZWwoKTtcbiAgICAgICAgc3luY0xhYmVsVGV4dCgpO1xuICAgICAgfSk7XG5cbiAgICAgIGZ1bmN0aW9uIHNldEFyaWFMYWJlbCgpIHtcbiAgICAgICAgdmFyIGxhYmVsVGV4dCA9IGVsZW1lbnQuYXR0cigncGxhY2Vob2xkZXInKTtcbiAgICAgICAgaWYgKCFsYWJlbFRleHQpIHtcbiAgICAgICAgICBsYWJlbFRleHQgPSBlbGVtZW50LmZpbmQoJ21kLXNlbGVjdC1sYWJlbCcpLnRleHQoKTtcbiAgICAgICAgfVxuICAgICAgICAkbWRBcmlhLmV4cGVjdChlbGVtZW50LCAnYXJpYS1sYWJlbCcsIGxhYmVsVGV4dCk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIHN5bmNMYWJlbFRleHQoKSB7XG4gICAgICAgIGlmIChzZWxlY3RDb250YWluZXIpIHtcbiAgICAgICAgICBzZWxlY3RNZW51Q3RybCA9IHNlbGVjdE1lbnVDdHJsIHx8IHNlbGVjdENvbnRhaW5lci5maW5kKCdtZC1zZWxlY3QtbWVudScpLmNvbnRyb2xsZXIoJ21kU2VsZWN0TWVudScpO1xuICAgICAgICAgIG1kU2VsZWN0Q3RybC5zZXRMYWJlbFRleHQoc2VsZWN0TWVudUN0cmwuc2VsZWN0ZWRMYWJlbHMoKSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdmFyIGRlcmVnaXN0ZXJXYXRjaGVyO1xuICAgICAgYXR0ci4kb2JzZXJ2ZSgnbmdNdWx0aXBsZScsIGZ1bmN0aW9uKHZhbCkge1xuICAgICAgICBpZiAoZGVyZWdpc3RlcldhdGNoZXIpIGRlcmVnaXN0ZXJXYXRjaGVyKCk7XG4gICAgICAgIHZhciBwYXJzZXIgPSAkcGFyc2UodmFsKTtcbiAgICAgICAgZGVyZWdpc3RlcldhdGNoZXIgPSBzY29wZS4kd2F0Y2goZnVuY3Rpb24oKSB7IHJldHVybiBwYXJzZXIoc2NvcGUpOyB9LCBmdW5jdGlvbihtdWx0aXBsZSwgcHJldlZhbCkge1xuICAgICAgICAgIGlmIChtdWx0aXBsZSA9PT0gdW5kZWZpbmVkICYmIHByZXZWYWwgPT09IHVuZGVmaW5lZCkgcmV0dXJuOyAvLyBhc3N1bWUgY29tcGlsZXIgZGlkIGEgZ29vZCBqb2JcbiAgICAgICAgICBpZiAobXVsdGlwbGUpIHtcbiAgICAgICAgICAgIGVsZW1lbnQuYXR0cignbXVsdGlwbGUnLCAnbXVsdGlwbGUnKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVBdHRyKCdtdWx0aXBsZScpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoc2VsZWN0Q29udGFpbmVyKSB7XG4gICAgICAgICAgICBzZWxlY3RNZW51Q3RybC5zZXRNdWx0aXBsZShtdWx0aXBsZSk7XG4gICAgICAgICAgICBvcmlnaW5hbFJlbmRlciA9IG5nTW9kZWwuJHJlbmRlcjtcbiAgICAgICAgICAgIG5nTW9kZWwuJHJlbmRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBvcmlnaW5hbFJlbmRlcigpO1xuICAgICAgICAgICAgICBzeW5jTGFiZWxUZXh0KCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgc2VsZWN0TWVudUN0cmwucmVmcmVzaFZpZXdWYWx1ZSgpO1xuICAgICAgICAgICAgbmdNb2RlbC4kcmVuZGVyKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBhdHRyLiRvYnNlcnZlKCdkaXNhYmxlZCcsIGZ1bmN0aW9uKGRpc2FibGVkKSB7XG4gICAgICAgIGlmICh0eXBlb2YgZGlzYWJsZWQgPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgIGRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICAvLyBQcmV2ZW50IGNsaWNrIGV2ZW50IGJlaW5nIHJlZ2lzdGVyZWQgdHdpY2VcbiAgICAgICAgaWYgKGlzRGlzYWJsZWQgIT09IHVuZGVmaW5lZCAmJiBpc0Rpc2FibGVkID09PSBkaXNhYmxlZCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpc0Rpc2FibGVkID0gZGlzYWJsZWQ7XG4gICAgICAgIGlmIChkaXNhYmxlZCkge1xuICAgICAgICAgIGVsZW1lbnQuYXR0cih7J3RhYmluZGV4JzogLTEsICdhcmlhLWRpc2FibGVkJzogJ3RydWUnfSk7XG4gICAgICAgICAgZWxlbWVudC5vZmYoJ2NsaWNrJywgb3BlblNlbGVjdCk7XG4gICAgICAgICAgZWxlbWVudC5vZmYoJ2tleWRvd24nLCBoYW5kbGVLZXlwcmVzcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZWxlbWVudC5hdHRyKHsndGFiaW5kZXgnOiBhdHRyLnRhYmluZGV4LCAnYXJpYS1kaXNhYmxlZCc6ICdmYWxzZSd9KTtcbiAgICAgICAgICBlbGVtZW50Lm9uKCdjbGljaycsIG9wZW5TZWxlY3QpO1xuICAgICAgICAgIGVsZW1lbnQub24oJ2tleWRvd24nLCBoYW5kbGVLZXlwcmVzcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIWF0dHIuZGlzYWJsZWQgJiYgIWF0dHIubmdEaXNhYmxlZCkge1xuICAgICAgICBlbGVtZW50LmF0dHIoeyd0YWJpbmRleCc6IGF0dHIudGFiaW5kZXgsICdhcmlhLWRpc2FibGVkJzogJ2ZhbHNlJ30pO1xuICAgICAgICBlbGVtZW50Lm9uKCdjbGljaycsIG9wZW5TZWxlY3QpO1xuICAgICAgICBlbGVtZW50Lm9uKCdrZXlkb3duJywgaGFuZGxlS2V5cHJlc3MpO1xuICAgICAgfVxuXG4gICAgICB2YXIgYXJpYUF0dHJzID0ge1xuICAgICAgICByb2xlOiAnY29tYm9ib3gnLFxuICAgICAgICAnYXJpYS1leHBhbmRlZCc6ICdmYWxzZSdcbiAgICAgIH07XG4gICAgICBpZiAoIWVsZW1lbnRbMF0uaGFzQXR0cmlidXRlKCdpZCcpKSB7XG4gICAgICAgIGFyaWFBdHRycy5pZCA9ICdzZWxlY3RfJyArICRtZFV0aWwubmV4dFVpZCgpO1xuICAgICAgfVxuICAgICAgZWxlbWVudC5hdHRyKGFyaWFBdHRycyk7XG5cbiAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGlzT3Blbikge1xuICAgICAgICAgICRtZFNlbGVjdC5jYW5jZWwoKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2VsZWN0Q29udGFpbmVyLnJlbW92ZSgpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNlbGVjdENvbnRhaW5lci5yZW1vdmUoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cblxuICAgICAgLy8gQ3JlYXRlIGEgZmFrZSBzZWxlY3QgdG8gZmluZCBvdXQgdGhlIGxhYmVsIHZhbHVlXG4gICAgICBmdW5jdGlvbiBjcmVhdGVTZWxlY3QoKSB7XG4gICAgICAgIHNlbGVjdENvbnRhaW5lciA9IGFuZ3VsYXIuZWxlbWVudChzZWxlY3RUZW1wbGF0ZSk7XG4gICAgICAgIHZhciBzZWxlY3RFbCA9IHNlbGVjdENvbnRhaW5lci5maW5kKCdtZC1zZWxlY3QtbWVudScpO1xuICAgICAgICBzZWxlY3RFbC5kYXRhKCckbmdNb2RlbENvbnRyb2xsZXInLCBuZ01vZGVsKTtcbiAgICAgICAgc2VsZWN0RWwuZGF0YSgnJG1kU2VsZWN0Q29udHJvbGxlcicsIG1kU2VsZWN0Q3RybCk7XG4gICAgICAgIHNlbGVjdFNjb3BlID0gc2NvcGUuJG5ldygpO1xuICAgICAgICBzZWxlY3RDb250YWluZXIgPSAkY29tcGlsZShzZWxlY3RDb250YWluZXIpKHNlbGVjdFNjb3BlKTtcbiAgICAgICAgc2VsZWN0TWVudUN0cmwgPSBzZWxlY3RDb250YWluZXIuZmluZCgnbWQtc2VsZWN0LW1lbnUnKS5jb250cm9sbGVyKCdtZFNlbGVjdE1lbnUnKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gaGFuZGxlS2V5cHJlc3MoZSkge1xuICAgICAgICB2YXIgYWxsb3dlZENvZGVzID0gWzMyLCAxMywgMzgsIDQwXTtcbiAgICAgICAgaWYgKGFsbG93ZWRDb2Rlcy5pbmRleE9mKGUua2V5Q29kZSkgIT0gLTEgKSB7XG4gICAgICAgICAgLy8gcHJldmVudCBwYWdlIHNjcm9sbGluZyBvbiBpbnRlcmFjdGlvblxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBvcGVuU2VsZWN0KGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChlLmtleUNvZGUgPD0gOTAgJiYgZS5rZXlDb2RlID49IDMxKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB2YXIgbm9kZSA9IHNlbGVjdE1lbnVDdHJsLm9wdE5vZGVGb3JLZXlib2FyZFNlYXJjaChlKTtcbiAgICAgICAgICAgIGlmICghbm9kZSkgcmV0dXJuO1xuICAgICAgICAgICAgdmFyIG9wdGlvbkN0cmwgPSBhbmd1bGFyLmVsZW1lbnQobm9kZSkuY29udHJvbGxlcignbWRPcHRpb24nKTtcbiAgICAgICAgICAgIGlmICghc2VsZWN0TWVudUN0cmwuaXNNdWx0aXBsZSkge1xuICAgICAgICAgICAgICBzZWxlY3RNZW51Q3RybC5kZXNlbGVjdCggT2JqZWN0LmtleXMoc2VsZWN0TWVudUN0cmwuc2VsZWN0ZWQpWzBdICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZWxlY3RNZW51Q3RybC5zZWxlY3Qob3B0aW9uQ3RybC5oYXNoS2V5LCBvcHRpb25DdHJsLnZhbHVlKTtcbiAgICAgICAgICAgIHNlbGVjdE1lbnVDdHJsLnJlZnJlc2hWaWV3VmFsdWUoKTtcbiAgICAgICAgICAgIG5nTW9kZWwuJHJlbmRlcigpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBvcGVuU2VsZWN0KCkge1xuICAgICAgICBzY29wZS4kZXZhbEFzeW5jKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlzT3BlbiA9IHRydWU7XG4gICAgICAgICAgJG1kU2VsZWN0LnNob3coe1xuICAgICAgICAgICAgc2NvcGU6IHNlbGVjdFNjb3BlLFxuICAgICAgICAgICAgcHJlc2VydmVTY29wZTogdHJ1ZSxcbiAgICAgICAgICAgIHNraXBDb21waWxlOiB0cnVlLFxuICAgICAgICAgICAgZWxlbWVudDogc2VsZWN0Q29udGFpbmVyLFxuICAgICAgICAgICAgdGFyZ2V0OiBlbGVtZW50WzBdLFxuICAgICAgICAgICAgaGFzQmFja2Ryb3A6IHRydWUsXG4gICAgICAgICAgICBsb2FkaW5nQXN5bmM6IGF0dHIubWRPbk9wZW4gPyBzY29wZS4kZXZhbChhdHRyLm1kT25PcGVuKSB8fCB0cnVlIDogZmFsc2UsXG4gICAgICAgICAgfSkudGhlbihmdW5jdGlvbihzZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgIGlzT3BlbiA9IGZhbHNlO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG59XG5TZWxlY3REaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZFNlbGVjdFwiLCBcIiRtZFV0aWxcIiwgXCIkbWRUaGVtaW5nXCIsIFwiJG1kQXJpYVwiLCBcIiRpbnRlcnBvbGF0ZVwiLCBcIiRjb21waWxlXCIsIFwiJHBhcnNlXCJdO1xuXG5mdW5jdGlvbiBTZWxlY3RNZW51RGlyZWN0aXZlKCRwYXJzZSwgJG1kVXRpbCwgJG1kVGhlbWluZykge1xuXG4gIFNlbGVjdE1lbnVDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkYXR0cnNcIiwgXCIkZWxlbWVudFwiXTtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0UnLFxuICAgIHJlcXVpcmU6IFsnbWRTZWxlY3RNZW51JywgJz9uZ01vZGVsJ10sXG4gICAgY29udHJvbGxlcjogU2VsZWN0TWVudUNvbnRyb2xsZXIsXG4gICAgbGluazogeyBwcmU6IHByZUxpbmsgfVxuICB9O1xuXG4gIC8vIFdlIHVzZSBwcmVMaW5rIGluc3RlYWQgb2YgcG9zdExpbmsgdG8gZW5zdXJlIHRoYXQgdGhlIHNlbGVjdCBpcyBpbml0aWFsaXplZCBiZWZvcmVcbiAgLy8gaXRzIGNoaWxkIG9wdGlvbnMgcnVuIHBvc3RMaW5rLlxuICBmdW5jdGlvbiBwcmVMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJscykge1xuICAgIHZhciBzZWxlY3RDdHJsID0gY3RybHNbMF07XG4gICAgdmFyIG5nTW9kZWwgPSBjdHJsc1sxXTtcblxuICAgICRtZFRoZW1pbmcoZWxlbWVudCk7XG4gICAgZWxlbWVudC5vbignY2xpY2snLCBjbGlja0xpc3RlbmVyKTtcbiAgICBlbGVtZW50Lm9uKCdrZXlwcmVzcycsIGtleUxpc3RlbmVyKTtcbiAgICBpZiAobmdNb2RlbCkgc2VsZWN0Q3RybC5pbml0KG5nTW9kZWwpO1xuICAgIGNvbmZpZ3VyZUFyaWEoKTtcblxuICAgIGZ1bmN0aW9uIGNvbmZpZ3VyZUFyaWEoKSB7XG4gICAgICBlbGVtZW50LmF0dHIoe1xuICAgICAgICAnaWQnOiAnc2VsZWN0X21lbnVfJyArICRtZFV0aWwubmV4dFVpZCgpLFxuICAgICAgICAncm9sZSc6ICdsaXN0Ym94JyxcbiAgICAgICAgJ2FyaWEtbXVsdGlzZWxlY3RhYmxlJzogKHNlbGVjdEN0cmwuaXNNdWx0aXBsZSA/ICd0cnVlJyA6ICdmYWxzZScpXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBrZXlMaXN0ZW5lcihlKSB7XG4gICAgICBpZiAoZS5rZXlDb2RlID09IDEzIHx8IGUua2V5Q29kZSA9PSAzMikge1xuICAgICAgICBjbGlja0xpc3RlbmVyKGUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNsaWNrTGlzdGVuZXIoZXYpIHtcbiAgICAgIHZhciBvcHRpb24gPSAkbWRVdGlsLmdldENsb3Nlc3QoZXYudGFyZ2V0LCAnbWQtb3B0aW9uJyk7XG4gICAgICB2YXIgb3B0aW9uQ3RybCA9IG9wdGlvbiAmJiBhbmd1bGFyLmVsZW1lbnQob3B0aW9uKS5kYXRhKCckbWRPcHRpb25Db250cm9sbGVyJyk7XG4gICAgICBpZiAoIW9wdGlvbiB8fCAhb3B0aW9uQ3RybCkgcmV0dXJuO1xuXG4gICAgICB2YXIgb3B0aW9uSGFzaEtleSA9IHNlbGVjdEN0cmwuaGFzaEdldHRlcihvcHRpb25DdHJsLnZhbHVlKTtcbiAgICAgIHZhciBpc1NlbGVjdGVkID0gYW5ndWxhci5pc0RlZmluZWQoc2VsZWN0Q3RybC5zZWxlY3RlZFtvcHRpb25IYXNoS2V5XSk7XG5cbiAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHNlbGVjdEN0cmwuaXNNdWx0aXBsZSkge1xuICAgICAgICAgIGlmIChpc1NlbGVjdGVkKSB7XG4gICAgICAgICAgICBzZWxlY3RDdHJsLmRlc2VsZWN0KG9wdGlvbkhhc2hLZXkpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZWxlY3RDdHJsLnNlbGVjdChvcHRpb25IYXNoS2V5LCBvcHRpb25DdHJsLnZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKCFpc1NlbGVjdGVkKSB7XG4gICAgICAgICAgICBzZWxlY3RDdHJsLmRlc2VsZWN0KCBPYmplY3Qua2V5cyhzZWxlY3RDdHJsLnNlbGVjdGVkKVswXSApO1xuICAgICAgICAgICAgc2VsZWN0Q3RybC5zZWxlY3QoIG9wdGlvbkhhc2hLZXksIG9wdGlvbkN0cmwudmFsdWUgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc2VsZWN0Q3RybC5yZWZyZXNoVmlld1ZhbHVlKCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuXG5cbiAgZnVuY3Rpb24gU2VsZWN0TWVudUNvbnRyb2xsZXIoJHNjb3BlLCAkYXR0cnMsICRlbGVtZW50KSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYuaXNNdWx0aXBsZSA9IGFuZ3VsYXIuaXNEZWZpbmVkKCRhdHRycy5tdWx0aXBsZSk7XG4gICAgLy8gc2VsZWN0ZWQgaXMgYW4gb2JqZWN0IHdpdGgga2V5cyBtYXRjaGluZyBhbGwgb2YgdGhlIHNlbGVjdGVkIG9wdGlvbnMnIGhhc2hlZCB2YWx1ZXNcbiAgICBzZWxmLnNlbGVjdGVkID0ge307XG4gICAgLy8gb3B0aW9ucyBpcyBhbiBvYmplY3Qgd2l0aCBrZXlzIG1hdGNoaW5nIGV2ZXJ5IG9wdGlvbidzIGhhc2ggdmFsdWUsXG4gICAgLy8gYW5kIHZhbHVlcyBtYXRjaGluZyBldmVyeSBvcHRpb24ncyBjb250cm9sbGVyLlxuICAgIHNlbGYub3B0aW9ucyA9IHt9O1xuXG4gICAgJHNjb3BlLiR3YXRjaChmdW5jdGlvbigpIHsgcmV0dXJuIHNlbGYub3B0aW9uczsgfSwgZnVuY3Rpb24oKSB7XG4gICAgICBzZWxmLm5nTW9kZWwuJHJlbmRlcigpO1xuICAgIH0sIHRydWUpO1xuXG4gICAgdmFyIGRlcmVnaXN0ZXJDb2xsZWN0aW9uV2F0Y2g7XG4gICAgc2VsZi5zZXRNdWx0aXBsZSA9IGZ1bmN0aW9uKGlzTXVsdGlwbGUpIHtcbiAgICAgIHZhciBuZ01vZGVsID0gc2VsZi5uZ01vZGVsO1xuICAgICAgc2VsZi5pc011bHRpcGxlID0gaXNNdWx0aXBsZTtcbiAgICAgIGlmIChkZXJlZ2lzdGVyQ29sbGVjdGlvbldhdGNoKSBkZXJlZ2lzdGVyQ29sbGVjdGlvbldhdGNoKCk7XG5cbiAgICAgIGlmIChzZWxmLmlzTXVsdGlwbGUpIHtcbiAgICAgICAgbmdNb2RlbC4kdmFsaWRhdG9yc1snbWQtbXVsdGlwbGUnXSA9IHZhbGlkYXRlQXJyYXk7XG4gICAgICAgIG5nTW9kZWwuJHJlbmRlciA9IHJlbmRlck11bHRpcGxlO1xuXG4gICAgICAgIC8vIHdhdGNoQ29sbGVjdGlvbiBvbiB0aGUgbW9kZWwgYmVjYXVzZSBieSBkZWZhdWx0IG5nTW9kZWwgb25seSB3YXRjaGVzIHRoZSBtb2RlbCdzXG4gICAgICAgIC8vIHJlZmVyZW5jZS4gVGhpcyBhbGxvd2VkIHRoZSBkZXZlbG9wZXIgdG8gYWxzbyBwdXNoIGFuZCBwb3AgZnJvbSB0aGVpciBhcnJheS5cbiAgICAgICAgJHNjb3BlLiR3YXRjaENvbGxlY3Rpb24oJGF0dHJzLm5nTW9kZWwsIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgaWYgKHZhbGlkYXRlQXJyYXkodmFsdWUpKSByZW5kZXJNdWx0aXBsZSh2YWx1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGVsZXRlIG5nTW9kZWwuJHZhbGlkYXRvcnNbJ21kLW11bHRpcGxlJ107XG4gICAgICAgIG5nTW9kZWwuJHJlbmRlciA9IHJlbmRlclNpbmd1bGFyO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiB2YWxpZGF0ZUFycmF5KG1vZGVsVmFsdWUsIHZpZXdWYWx1ZSkge1xuICAgICAgICAvLyBJZiBhIHZhbHVlIGlzIHRydXRoeSBidXQgbm90IGFuIGFycmF5LCByZWplY3QgaXQuXG4gICAgICAgIC8vIElmIHZhbHVlIGlzIHVuZGVmaW5lZC9mYWxzeSwgYWNjZXB0IHRoYXQgaXQncyBhbiBlbXB0eSBhcnJheS5cbiAgICAgICAgcmV0dXJuIGFuZ3VsYXIuaXNBcnJheShtb2RlbFZhbHVlIHx8IHZpZXdWYWx1ZSB8fCBbXSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHZhciBzZWFyY2hTdHIgPSAnJztcbiAgICB2YXIgY2xlYXJTZWFyY2hUaW1lb3V0LCBvcHROb2Rlcywgb3B0VGV4dDtcbiAgICB2YXIgQ0xFQVJfU0VBUkNIX0FGVEVSID0gMzAwO1xuICAgIHNlbGYub3B0Tm9kZUZvcktleWJvYXJkU2VhcmNoID0gZnVuY3Rpb24oZSkge1xuICAgICAgY2xlYXJTZWFyY2hUaW1lb3V0ICYmIGNsZWFyVGltZW91dChjbGVhclNlYXJjaFRpbWVvdXQpO1xuICAgICAgY2xlYXJTZWFyY2hUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgY2xlYXJTZWFyY2hUaW1lb3V0ID0gdW5kZWZpbmVkO1xuICAgICAgICBzZWFyY2hTdHIgPSAnJztcbiAgICAgICAgb3B0VGV4dCA9IHVuZGVmaW5lZDtcbiAgICAgICAgb3B0Tm9kZXMgPSB1bmRlZmluZWQ7XG4gICAgICB9LCBDTEVBUl9TRUFSQ0hfQUZURVIpO1xuICAgICAgc2VhcmNoU3RyICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoZS5rZXlDb2RlKTtcbiAgICAgIHZhciBzZWFyY2ggPSBuZXcgUmVnRXhwKCdeJyArIHNlYXJjaFN0ciwgJ2knKTtcbiAgICAgIGlmICghb3B0Tm9kZXMpIHtcbiAgICAgICAgb3B0Tm9kZXMgPSAkZWxlbWVudC5maW5kKCdtZC1vcHRpb24nKTtcbiAgICAgICAgb3B0VGV4dCA9IG5ldyBBcnJheShvcHROb2Rlcy5sZW5ndGgpO1xuICAgICAgICBhbmd1bGFyLmZvckVhY2gob3B0Tm9kZXMsIGZ1bmN0aW9uKGVsLCBpKSB7XG4gICAgICAgICAgb3B0VGV4dFtpXSA9IGVsLnRleHRDb250ZW50LnRyaW0oKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9wdFRleHQubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgaWYgKHNlYXJjaC50ZXN0KG9wdFRleHRbaV0pKSB7XG4gICAgICAgICAgcmV0dXJuIG9wdE5vZGVzW2ldO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuXG4gICAgc2VsZi5pbml0ID0gZnVuY3Rpb24obmdNb2RlbCkge1xuICAgICAgc2VsZi5uZ01vZGVsID0gbmdNb2RlbDtcblxuICAgICAgLy8gQWxsb3cgdXNlcnMgdG8gcHJvdmlkZSBgbmctbW9kZWw9XCJmb29cIiBuZy1tb2RlbC1vcHRpb25zPVwie3RyYWNrQnk6ICdmb28uaWQnfVwiYCBzb1xuICAgICAgLy8gdGhhdCB3ZSBjYW4gcHJvcGVybHkgY29tcGFyZSBvYmplY3RzIHNldCBvbiB0aGUgbW9kZWwgdG8gdGhlIGF2YWlsYWJsZSBvcHRpb25zXG4gICAgICBpZiAobmdNb2RlbC4kb3B0aW9ucyAmJiBuZ01vZGVsLiRvcHRpb25zLnRyYWNrQnkpIHtcbiAgICAgICAgdmFyIHRyYWNrQnlMb2NhbHMgPSB7fTtcbiAgICAgICAgdmFyIHRyYWNrQnlQYXJzZWQgPSAkcGFyc2UobmdNb2RlbC4kb3B0aW9ucy50cmFja0J5KTtcbiAgICAgICAgc2VsZi5oYXNoR2V0dGVyID0gZnVuY3Rpb24odmFsdWUsIHZhbHVlU2NvcGUpIHtcbiAgICAgICAgICB0cmFja0J5TG9jYWxzLiR2YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgIHJldHVybiB0cmFja0J5UGFyc2VkKHZhbHVlU2NvcGUgfHwgJHNjb3BlLCB0cmFja0J5TG9jYWxzKTtcbiAgICAgICAgfTtcbiAgICAgIC8vIElmIHRoZSB1c2VyIGRvZXNuJ3QgcHJvdmlkZSBhIHRyYWNrQnksIHdlIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGUgYW4gaWQgZm9yIGV2ZXJ5XG4gICAgICAvLyB2YWx1ZSBwYXNzZWQgaW5cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNlbGYuaGFzaEdldHRlciA9IGZ1bmN0aW9uIGdldEhhc2hWYWx1ZSh2YWx1ZSkge1xuICAgICAgICAgIGlmIChhbmd1bGFyLmlzT2JqZWN0KHZhbHVlKSkge1xuICAgICAgICAgICAgcmV0dXJuICdvYmplY3RfJyArICh2YWx1ZS4kJG1kU2VsZWN0SWQgfHwgKHZhbHVlLiQkbWRTZWxlY3RJZCA9ICsrc2VsZWN0TmV4dElkKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHNlbGYuc2V0TXVsdGlwbGUoc2VsZi5pc011bHRpcGxlKTtcbiAgICB9O1xuXG4gICAgc2VsZi5zZWxlY3RlZExhYmVscyA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHNlbGVjdGVkT3B0aW9uRWxzID0gJG1kVXRpbC5ub2Rlc1RvQXJyYXkoJGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvckFsbCgnbWQtb3B0aW9uW3NlbGVjdGVkXScpKTtcbiAgICAgIGlmIChzZWxlY3RlZE9wdGlvbkVscy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIHNlbGVjdGVkT3B0aW9uRWxzLm1hcChmdW5jdGlvbihlbCkgeyByZXR1cm4gZWwudGV4dENvbnRlbnQ7IH0pLmpvaW4oJywgJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHNlbGYuc2VsZWN0ID0gZnVuY3Rpb24oaGFzaEtleSwgaGFzaGVkVmFsdWUpIHtcbiAgICAgIHZhciBvcHRpb24gPSBzZWxmLm9wdGlvbnNbaGFzaEtleV07XG4gICAgICBvcHRpb24gJiYgb3B0aW9uLnNldFNlbGVjdGVkKHRydWUpO1xuICAgICAgc2VsZi5zZWxlY3RlZFtoYXNoS2V5XSA9IGhhc2hlZFZhbHVlO1xuICAgIH07XG4gICAgc2VsZi5kZXNlbGVjdCA9IGZ1bmN0aW9uKGhhc2hLZXkpIHtcbiAgICAgIHZhciBvcHRpb24gPSBzZWxmLm9wdGlvbnNbaGFzaEtleV07XG4gICAgICBvcHRpb24gJiYgb3B0aW9uLnNldFNlbGVjdGVkKGZhbHNlKTtcbiAgICAgIGRlbGV0ZSBzZWxmLnNlbGVjdGVkW2hhc2hLZXldO1xuICAgIH07XG5cbiAgICBzZWxmLmFkZE9wdGlvbiA9IGZ1bmN0aW9uKGhhc2hLZXksIG9wdGlvbkN0cmwpIHtcbiAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChzZWxmLm9wdGlvbnNbaGFzaEtleV0pKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRHVwbGljYXRlIG1kLW9wdGlvbiB2YWx1ZXMgYXJlIG5vdCBhbGxvd2VkIGluIGEgc2VsZWN0LiAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICdEdXBsaWNhdGUgdmFsdWUgXCInICsgb3B0aW9uQ3RybC52YWx1ZSArICdcIiBmb3VuZC4nKTtcbiAgICAgIH1cbiAgICAgIHNlbGYub3B0aW9uc1toYXNoS2V5XSA9IG9wdGlvbkN0cmw7XG5cbiAgICAgIC8vIElmIHRoaXMgb3B0aW9uJ3MgdmFsdWUgd2FzIGFscmVhZHkgaW4gb3VyIG5nTW9kZWwsIGdvIGFoZWFkIGFuZCBzZWxlY3QgaXQuXG4gICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoc2VsZi5zZWxlY3RlZFtoYXNoS2V5XSkpIHtcbiAgICAgICAgc2VsZi5zZWxlY3QoaGFzaEtleSwgb3B0aW9uQ3RybC52YWx1ZSk7XG4gICAgICAgIHNlbGYucmVmcmVzaFZpZXdWYWx1ZSgpO1xuICAgICAgfVxuICAgIH07XG4gICAgc2VsZi5yZW1vdmVPcHRpb24gPSBmdW5jdGlvbihoYXNoS2V5KSB7XG4gICAgICBkZWxldGUgc2VsZi5vcHRpb25zW2hhc2hLZXldO1xuICAgICAgLy8gRG9uJ3QgZGVzZWxlY3QgYW4gb3B0aW9uIHdoZW4gaXQncyByZW1vdmVkIC0gdGhlIHVzZXIncyBuZ01vZGVsIHNob3VsZCBiZSBhbGxvd2VkXG4gICAgICAvLyB0byBoYXZlIHZhbHVlcyB0aGF0IGRvIG5vdCBtYXRjaCBhIGN1cnJlbnRseSBhdmFpbGFibGUgb3B0aW9uLlxuICAgIH07XG5cbiAgICBzZWxmLnJlZnJlc2hWaWV3VmFsdWUgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciB2YWx1ZXMgPSBbXTtcbiAgICAgIHZhciBvcHRpb247XG4gICAgICBmb3IgKHZhciBoYXNoS2V5IGluIHNlbGYuc2VsZWN0ZWQpIHtcbiAgICAgICAgIC8vIElmIHRoaXMgaGFzaEtleSBoYXMgYW4gYXNzb2NpYXRlZCBvcHRpb24sIHB1c2ggdGhhdCBvcHRpb24ncyB2YWx1ZSB0byB0aGUgbW9kZWwuXG4gICAgICAgICBpZiAoKG9wdGlvbiA9IHNlbGYub3B0aW9uc1toYXNoS2V5XSkpIHtcbiAgICAgICAgICAgdmFsdWVzLnB1c2gob3B0aW9uLnZhbHVlKTtcbiAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgIC8vIE90aGVyd2lzZSwgdGhlIGdpdmVuIGhhc2hLZXkgaGFzIG5vIGFzc29jaWF0ZWQgb3B0aW9uLCBhbmQgd2UgZ290IGl0XG4gICAgICAgICAgIC8vIGZyb20gYW4gbmdNb2RlbCB2YWx1ZSBhdCBhbiBlYXJsaWVyIHRpbWUuIFB1c2ggdGhlIHVuaGFzaGVkIHZhbHVlIG9mXG4gICAgICAgICAgIC8vIHRoaXMgaGFzaEtleSB0byB0aGUgbW9kZWwuXG4gICAgICAgICAgIC8vIFRoaXMgYWxsb3dzIHRoZSBkZXZlbG9wZXIgdG8gcHV0IGEgdmFsdWUgaW4gdGhlIG1vZGVsIHRoYXQgZG9lc24ndCB5ZXQgaGF2ZVxuICAgICAgICAgICAvLyBhbiBhc3NvY2lhdGVkIG9wdGlvbi5cbiAgICAgICAgICAgdmFsdWVzLnB1c2goc2VsZi5zZWxlY3RlZFtoYXNoS2V5XSk7XG4gICAgICAgICB9XG4gICAgICB9XG4gICAgICBzZWxmLm5nTW9kZWwuJHNldFZpZXdWYWx1ZShzZWxmLmlzTXVsdGlwbGUgPyB2YWx1ZXMgOiB2YWx1ZXNbMF0pO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiByZW5kZXJNdWx0aXBsZSgpIHtcbiAgICAgIHZhciBuZXdTZWxlY3RlZFZhbHVlcyA9IHNlbGYubmdNb2RlbC4kbW9kZWxWYWx1ZSB8fCBzZWxmLm5nTW9kZWwuJHZpZXdWYWx1ZTtcbiAgICAgIGlmICghYW5ndWxhci5pc0FycmF5KG5ld1NlbGVjdGVkVmFsdWVzKSkgcmV0dXJuO1xuXG4gICAgICB2YXIgb2xkU2VsZWN0ZWQgPSBPYmplY3Qua2V5cyhzZWxmLnNlbGVjdGVkKTtcblxuICAgICAgdmFyIG5ld1NlbGVjdGVkSGFzaGVzID0gbmV3U2VsZWN0ZWRWYWx1ZXMubWFwKHNlbGYuaGFzaEdldHRlcik7XG4gICAgICB2YXIgZGVzZWxlY3RlZCA9IG9sZFNlbGVjdGVkLmZpbHRlcihmdW5jdGlvbihoYXNoKSB7XG4gICAgICAgIHJldHVybiBuZXdTZWxlY3RlZEhhc2hlcy5pbmRleE9mKGhhc2gpID09PSAtMTtcbiAgICAgIH0pO1xuXG4gICAgICBkZXNlbGVjdGVkLmZvckVhY2goc2VsZi5kZXNlbGVjdCk7XG4gICAgICBuZXdTZWxlY3RlZEhhc2hlcy5mb3JFYWNoKGZ1bmN0aW9uKGhhc2hLZXksIGkpIHtcbiAgICAgICAgc2VsZi5zZWxlY3QoaGFzaEtleSwgbmV3U2VsZWN0ZWRWYWx1ZXNbaV0pO1xuICAgICAgfSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHJlbmRlclNpbmd1bGFyKCkge1xuICAgICAgdmFyIHZhbHVlID0gc2VsZi5uZ01vZGVsLiR2aWV3VmFsdWUgfHwgc2VsZi5uZ01vZGVsLiRtb2RlbFZhbHVlO1xuICAgICAgT2JqZWN0LmtleXMoc2VsZi5zZWxlY3RlZCkuZm9yRWFjaChzZWxmLmRlc2VsZWN0KTtcbiAgICAgIHNlbGYuc2VsZWN0KCBzZWxmLmhhc2hHZXR0ZXIodmFsdWUpLCB2YWx1ZSApO1xuICAgIH1cbiAgfVxuXG59XG5TZWxlY3RNZW51RGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkcGFyc2VcIiwgXCIkbWRVdGlsXCIsIFwiJG1kVGhlbWluZ1wiXTtcblxuZnVuY3Rpb24gT3B0aW9uRGlyZWN0aXZlKCRtZEJ1dHRvbklua1JpcHBsZSwgJG1kVXRpbCkge1xuXG4gIE9wdGlvbkNvbnRyb2xsZXIuJGluamVjdCA9IFtcIiRlbGVtZW50XCJdO1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnRScsXG4gICAgcmVxdWlyZTogWydtZE9wdGlvbicsICdeXm1kU2VsZWN0TWVudSddLFxuICAgIGNvbnRyb2xsZXI6IE9wdGlvbkNvbnRyb2xsZXIsXG4gICAgY29tcGlsZTogY29tcGlsZVxuICB9O1xuXG4gIGZ1bmN0aW9uIGNvbXBpbGUoZWxlbWVudCwgYXR0cikge1xuICAgIC8vIE1hbnVhbCB0cmFuc2NsdXNpb24gdG8gYXZvaWQgdGhlIGV4dHJhIGlubmVyIDxzcGFuPiB0aGF0IG5nLXRyYW5zY2x1ZGUgZ2VuZXJhdGVzXG4gICAgZWxlbWVudC5hcHBlbmQoIGFuZ3VsYXIuZWxlbWVudCgnPGRpdiBjbGFzcz1cIm1kLXRleHRcIj4nKS5hcHBlbmQoZWxlbWVudC5jb250ZW50cygpKSApO1xuXG4gICAgZWxlbWVudC5hdHRyKCd0YWJpbmRleCcsIGF0dHIudGFiaW5kZXggfHwgJzAnKTtcbiAgICByZXR1cm4gcG9zdExpbms7XG4gIH1cblxuICBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybHMpIHtcbiAgICB2YXIgb3B0aW9uQ3RybCA9IGN0cmxzWzBdO1xuICAgIHZhciBzZWxlY3RDdHJsID0gY3RybHNbMV07XG5cbiAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoYXR0ci5uZ1ZhbHVlKSkge1xuICAgICAgc2NvcGUuJHdhdGNoKGF0dHIubmdWYWx1ZSwgc2V0T3B0aW9uVmFsdWUpO1xuICAgIH0gZWxzZSBpZiAoYW5ndWxhci5pc0RlZmluZWQoYXR0ci52YWx1ZSkpIHtcbiAgICAgIHNldE9wdGlvblZhbHVlKGF0dHIudmFsdWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzY29wZS4kd2F0Y2goZnVuY3Rpb24oKSB7IHJldHVybiBlbGVtZW50LnRleHQoKTsgfSwgc2V0T3B0aW9uVmFsdWUpO1xuICAgIH1cblxuICAgIHNjb3BlLiQkcG9zdERpZ2VzdChmdW5jdGlvbigpIHtcbiAgICAgIGF0dHIuJG9ic2VydmUoJ3NlbGVjdGVkJywgZnVuY3Rpb24oc2VsZWN0ZWQpIHtcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChzZWxlY3RlZCkpIHJldHVybjtcbiAgICAgICAgaWYgKHNlbGVjdGVkKSB7XG4gICAgICAgICAgaWYgKCFzZWxlY3RDdHJsLmlzTXVsdGlwbGUpIHtcbiAgICAgICAgICAgIHNlbGVjdEN0cmwuZGVzZWxlY3QoIE9iamVjdC5rZXlzKHNlbGVjdEN0cmwuc2VsZWN0ZWQpWzBdICk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHNlbGVjdEN0cmwuc2VsZWN0KG9wdGlvbkN0cmwuaGFzaEtleSwgb3B0aW9uQ3RybC52YWx1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2VsZWN0Q3RybC5kZXNlbGVjdChvcHRpb25DdHJsLmhhc2hLZXkpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGVjdEN0cmwucmVmcmVzaFZpZXdWYWx1ZSgpO1xuICAgICAgICBzZWxlY3RDdHJsLm5nTW9kZWwuJHJlbmRlcigpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAkbWRCdXR0b25JbmtSaXBwbGUuYXR0YWNoKHNjb3BlLCBlbGVtZW50KTtcbiAgICBjb25maWd1cmVBcmlhKCk7XG5cbiAgICBmdW5jdGlvbiBzZXRPcHRpb25WYWx1ZShuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgIHZhciBvbGRIYXNoS2V5ID0gc2VsZWN0Q3RybC5oYXNoR2V0dGVyKG9sZFZhbHVlLCBzY29wZSk7XG4gICAgICB2YXIgbmV3SGFzaEtleSA9IHNlbGVjdEN0cmwuaGFzaEdldHRlcihuZXdWYWx1ZSwgc2NvcGUpO1xuXG4gICAgICBvcHRpb25DdHJsLmhhc2hLZXkgPSBuZXdIYXNoS2V5O1xuICAgICAgb3B0aW9uQ3RybC52YWx1ZSA9IG5ld1ZhbHVlO1xuXG4gICAgICBzZWxlY3RDdHJsLnJlbW92ZU9wdGlvbihvbGRIYXNoS2V5LCBvcHRpb25DdHJsKTtcbiAgICAgIHNlbGVjdEN0cmwuYWRkT3B0aW9uKG5ld0hhc2hLZXksIG9wdGlvbkN0cmwpO1xuICAgIH1cblxuICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcbiAgICAgIHNlbGVjdEN0cmwucmVtb3ZlT3B0aW9uKG9wdGlvbkN0cmwuaGFzaEtleSwgb3B0aW9uQ3RybCk7XG4gICAgfSk7XG5cbiAgICBmdW5jdGlvbiBjb25maWd1cmVBcmlhKCkge1xuICAgICAgdmFyIGFyaWFBdHRycyA9IHtcbiAgICAgICAgJ3JvbGUnOiAnb3B0aW9uJyxcbiAgICAgICAgJ2FyaWEtc2VsZWN0ZWQnOiAnZmFsc2UnXG4gICAgICB9O1xuXG4gICAgICBpZiAoIWVsZW1lbnRbMF0uaGFzQXR0cmlidXRlKCdpZCcpKSB7XG4gICAgICAgIGFyaWFBdHRycy5pZCA9ICdzZWxlY3Rfb3B0aW9uXycgKyAkbWRVdGlsLm5leHRVaWQoKTtcbiAgICAgIH1cbiAgICAgIGVsZW1lbnQuYXR0cihhcmlhQXR0cnMpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIE9wdGlvbkNvbnRyb2xsZXIoJGVsZW1lbnQpIHtcbiAgICB0aGlzLnNlbGVjdGVkID0gZmFsc2U7XG4gICAgdGhpcy5zZXRTZWxlY3RlZCA9IGZ1bmN0aW9uKGlzU2VsZWN0ZWQpIHtcbiAgICAgIGlmIChpc1NlbGVjdGVkICYmICF0aGlzLnNlbGVjdGVkKSB7XG4gICAgICAgICRlbGVtZW50LmF0dHIoe1xuICAgICAgICAgICdzZWxlY3RlZCc6ICdzZWxlY3RlZCcsXG4gICAgICAgICAgJ2FyaWEtc2VsZWN0ZWQnOiAndHJ1ZSdcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKCFpc1NlbGVjdGVkICYmIHRoaXMuc2VsZWN0ZWQpIHtcbiAgICAgICAgJGVsZW1lbnQucmVtb3ZlQXR0cignc2VsZWN0ZWQnKTtcbiAgICAgICAgJGVsZW1lbnQuYXR0cignYXJpYS1zZWxlY3RlZCcsICdmYWxzZScpO1xuICAgICAgfVxuICAgICAgdGhpcy5zZWxlY3RlZCA9IGlzU2VsZWN0ZWQ7XG4gICAgfTtcbiAgfVxuXG59XG5PcHRpb25EaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZEJ1dHRvbklua1JpcHBsZVwiLCBcIiRtZFV0aWxcIl07XG5cbmZ1bmN0aW9uIE9wdGdyb3VwRGlyZWN0aXZlKCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnRScsXG4gICAgY29tcGlsZTogY29tcGlsZVxuICB9O1xuICBmdW5jdGlvbiBjb21waWxlKGVsLCBhdHRycykge1xuICAgIHZhciBsYWJlbEVsZW1lbnQgPSBlbC5maW5kKCdsYWJlbCcpO1xuICAgIGlmICghbGFiZWxFbGVtZW50Lmxlbmd0aCkge1xuICAgICAgbGFiZWxFbGVtZW50ID0gYW5ndWxhci5lbGVtZW50KCc8bGFiZWw+Jyk7XG4gICAgICBlbC5wcmVwZW5kKGxhYmVsRWxlbWVudCk7XG4gICAgfVxuICAgIGlmIChhdHRycy5sYWJlbCkgbGFiZWxFbGVtZW50LnRleHQoYXR0cnMubGFiZWwpO1xuICB9XG59XG5cbmZ1bmN0aW9uIFNlbGVjdFByb3ZpZGVyKCQkaW50ZXJpbUVsZW1lbnRQcm92aWRlcikge1xuICBzZWxlY3REZWZhdWx0T3B0aW9ucy4kaW5qZWN0ID0gW1wiJG1kU2VsZWN0XCIsIFwiJG1kQ29uc3RhbnRcIiwgXCIkJHJBRlwiLCBcIiRtZFV0aWxcIiwgXCIkbWRUaGVtaW5nXCIsIFwiJHRpbWVvdXRcIiwgXCIkd2luZG93XCJdO1xuICByZXR1cm4gJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyKCckbWRTZWxlY3QnKVxuICAgIC5zZXREZWZhdWx0cyh7XG4gICAgICBtZXRob2RzOiBbJ3RhcmdldCddLFxuICAgICAgb3B0aW9uczogc2VsZWN0RGVmYXVsdE9wdGlvbnNcbiAgICB9KTtcblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gc2VsZWN0RGVmYXVsdE9wdGlvbnMoJG1kU2VsZWN0LCAkbWRDb25zdGFudCwgJCRyQUYsICRtZFV0aWwsICRtZFRoZW1pbmcsICR0aW1lb3V0LCAkd2luZG93ICkge1xuICAgIHJldHVybiB7XG4gICAgICBwYXJlbnQ6ICdib2R5JyxcbiAgICAgIG9uU2hvdzogb25TaG93LFxuICAgICAgb25SZW1vdmU6IG9uUmVtb3ZlLFxuICAgICAgaGFzQmFja2Ryb3A6IHRydWUsXG4gICAgICBkaXNhYmxlUGFyZW50U2Nyb2xsOiB0cnVlLFxuICAgICAgdGhlbWFibGU6IHRydWVcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gb25TaG93KHNjb3BlLCBlbGVtZW50LCBvcHRzKSB7XG4gICAgICBpZiAoIW9wdHMudGFyZ2V0KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignJG1kU2VsZWN0LnNob3coKSBleHBlY3RlZCBhIHRhcmdldCBlbGVtZW50IGluIG9wdGlvbnMudGFyZ2V0IGJ1dCBnb3QgJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnXCInICsgb3B0cy50YXJnZXQgKyAnXCIhJyk7XG4gICAgICB9XG5cbiAgICAgIGFuZ3VsYXIuZXh0ZW5kKG9wdHMsIHtcbiAgICAgICAgaXNSZW1vdmVkOiBmYWxzZSxcbiAgICAgICAgdGFyZ2V0OiBhbmd1bGFyLmVsZW1lbnQob3B0cy50YXJnZXQpLCAvL21ha2Ugc3VyZSBpdCdzIG5vdCBhIG5ha2VkIGRvbSBub2RlXG4gICAgICAgIHBhcmVudDogYW5ndWxhci5lbGVtZW50KG9wdHMucGFyZW50KSxcbiAgICAgICAgc2VsZWN0RWw6IGVsZW1lbnQuZmluZCgnbWQtc2VsZWN0LW1lbnUnKSxcbiAgICAgICAgY29udGVudEVsOiBlbGVtZW50LmZpbmQoJ21kLWNvbnRlbnQnKSxcbiAgICAgICAgYmFja2Ryb3A6IG9wdHMuaGFzQmFja2Ryb3AgJiYgYW5ndWxhci5lbGVtZW50KCc8bWQtYmFja2Ryb3AgY2xhc3M9XCJtZC1zZWxlY3QtYmFja2Ryb3AgbWQtY2xpY2stY2F0Y2hlclwiPicpXG4gICAgICB9KTtcblxuICAgICAgb3B0cy5yZXNpemVGbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAkJHJBRihmdW5jdGlvbigpIHtcbiAgICAgICAgICAkJHJBRihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGFuaW1hdGVTZWxlY3Qoc2NvcGUsIGVsZW1lbnQsIG9wdHMpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH07XG5cbiAgICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vbigncmVzaXplJywgb3B0cy5yZXNpemVGbik7XG4gICAgICBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdykub24oJ29yaWVudGF0aW9uY2hhbmdlJywgb3B0cy5yZXNpemVGbik7XG5cblxuICAgICAgY29uZmlndXJlQXJpYSgpO1xuXG4gICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdtZC1sZWF2ZScpO1xuXG4gICAgICB2YXIgb3B0aW9uTm9kZXMgPSBvcHRzLnNlbGVjdEVsWzBdLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdtZC1vcHRpb24nKTtcblxuICAgICAgaWYgKG9wdHMubG9hZGluZ0FzeW5jICYmIG9wdHMubG9hZGluZ0FzeW5jLnRoZW4pIHtcbiAgICAgICAgb3B0cy5sb2FkaW5nQXN5bmMudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICBzY29wZS4kJGxvYWRpbmdBc3luY0RvbmUgPSB0cnVlO1xuICAgICAgICAgIC8vIEdpdmUgb3Vyc2VsdmVzIHR3byBmcmFtZXMgZm9yIHRoZSBwcm9ncmVzcyBsb2FkZXIgdG8gY2xlYXIgb3V0LlxuICAgICAgICAgICQkckFGKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJCRyQUYoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIC8vIERvbid0IGdvIGZvcndhcmQgaWYgdGhlIHNlbGVjdCBoYXMgYmVlbiByZW1vdmVkIGluIHRoaXMgdGltZS4uLlxuICAgICAgICAgICAgICBpZiAob3B0cy5pc1JlbW92ZWQpIHJldHVybjtcbiAgICAgICAgICAgICAgYW5pbWF0ZVNlbGVjdChzY29wZSwgZWxlbWVudCwgb3B0cyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKG9wdHMubG9hZGluZ0FzeW5jKSB7XG4gICAgICAgIHNjb3BlLiQkbG9hZGluZ0FzeW5jRG9uZSA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRzLmRpc2FibGVQYXJlbnRTY3JvbGwgJiYgISRtZFV0aWwuZ2V0Q2xvc2VzdChvcHRzLnRhcmdldCwgJ01ELURJQUxPRycpKSB7XG4gICAgICAgIG9wdHMucmVzdG9yZVNjcm9sbCA9ICRtZFV0aWwuZGlzYWJsZVNjcm9sbEFyb3VuZChvcHRzLmVsZW1lbnQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb3B0cy5kaXNhYmxlUGFyZW50U2Nyb2xsID0gZmFsc2U7XG4gICAgICB9XG4gICAgICAvLyBPbmx5IGFjdGl2YXRlIGNsaWNrIGxpc3RlbmVycyBhZnRlciBhIHNob3J0IHRpbWUgdG8gc3RvcCBhY2NpZGVudGFsIGRvdWJsZSB0YXBzL2NsaWNrc1xuICAgICAgLy8gZnJvbSBjbGlja2luZyB0aGUgd3JvbmcgaXRlbVxuICAgICAgJHRpbWVvdXQoYWN0aXZhdGVJbnRlcmFjdGlvbiwgNzUsIGZhbHNlKTtcblxuICAgICAgaWYgKG9wdHMuYmFja2Ryb3ApIHtcbiAgICAgICAgJG1kVGhlbWluZy5pbmhlcml0KG9wdHMuYmFja2Ryb3AsIG9wdHMucGFyZW50KTtcbiAgICAgICAgb3B0cy5wYXJlbnQuYXBwZW5kKG9wdHMuYmFja2Ryb3ApO1xuICAgICAgfVxuICAgICAgb3B0cy5wYXJlbnQuYXBwZW5kKGVsZW1lbnQpO1xuXG4gICAgICAvLyBHaXZlIHRoZSBzZWxlY3QgYSBmcmFtZSB0byAnaW5pdGlhbGl6ZScgaW4gdGhlIERPTSxcbiAgICAgIC8vIHNvIHdlIGNhbiByZWFkIGl0cyBoZWlnaHQvd2lkdGgvcG9zaXRpb25cbiAgICAgICQkckFGKGZ1bmN0aW9uKCkge1xuICAgICAgICAkJHJBRihmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAob3B0cy5pc1JlbW92ZWQpIHJldHVybjtcbiAgICAgICAgICBhbmltYXRlU2VsZWN0KHNjb3BlLCBlbGVtZW50LCBvcHRzKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuICRtZFV0aWwudHJhbnNpdGlvbkVuZFByb21pc2Uob3B0cy5zZWxlY3RFbCwge3RpbWVvdXQ6IDM1MH0pO1xuXG4gICAgICBmdW5jdGlvbiBjb25maWd1cmVBcmlhKCkge1xuICAgICAgICBvcHRzLnRhcmdldC5hdHRyKCdhcmlhLWV4cGFuZGVkJywgJ3RydWUnKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gYWN0aXZhdGVJbnRlcmFjdGlvbigpIHtcbiAgICAgICAgaWYgKG9wdHMuaXNSZW1vdmVkKSByZXR1cm47XG4gICAgICAgIHZhciBzZWxlY3RDdHJsID0gb3B0cy5zZWxlY3RFbC5jb250cm9sbGVyKCdtZFNlbGVjdE1lbnUnKSB8fCB7fTtcbiAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnbWQtY2xpY2thYmxlJyk7XG5cbiAgICAgICAgb3B0cy5iYWNrZHJvcCAmJiBvcHRzLmJhY2tkcm9wLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICBvcHRzLnJlc3RvcmVGb2N1cyA9IGZhbHNlO1xuICAgICAgICAgIHNjb3BlLiRhcHBseSgkbWRTZWxlY3QuY2FuY2VsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gRXNjYXBlIHRvIGNsb3NlXG4gICAgICAgIG9wdHMuc2VsZWN0RWwub24oJ2tleWRvd24nLCBmdW5jdGlvbihldikge1xuICAgICAgICAgIHN3aXRjaCAoZXYua2V5Q29kZSkge1xuICAgICAgICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5TUEFDRTpcbiAgICAgICAgICAgIGNhc2UgJG1kQ29uc3RhbnQuS0VZX0NPREUuRU5URVI6XG4gICAgICAgICAgICAgIHZhciBvcHRpb24gPSAkbWRVdGlsLmdldENsb3Nlc3QoZXYudGFyZ2V0LCAnbWQtb3B0aW9uJyk7XG4gICAgICAgICAgICAgIGlmIChvcHRpb24pIHtcbiAgICAgICAgICAgICAgICBvcHRzLnNlbGVjdEVsLnRyaWdnZXJIYW5kbGVyKHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6ICdjbGljaycsXG4gICAgICAgICAgICAgICAgICB0YXJnZXQ6IG9wdGlvblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLlRBQjpcbiAgICAgICAgICAgIGNhc2UgJG1kQ29uc3RhbnQuS0VZX0NPREUuRVNDQVBFOlxuICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICBvcHRzLnJlc3RvcmVGb2N1cyA9IHRydWU7XG4gICAgICAgICAgICAgIHNjb3BlLiRhcHBseSgkbWRTZWxlY3QuY2FuY2VsKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEN5Y2xpbmcgb2Ygb3B0aW9ucywgYW5kIGNsb3Npbmcgb24gZW50ZXJcbiAgICAgICAgb3B0cy5zZWxlY3RFbC5vbigna2V5ZG93bicsIGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgc3dpdGNoIChldi5rZXlDb2RlKSB7XG4gICAgICAgICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLlVQX0FSUk9XOiByZXR1cm4gZm9jdXNQcmV2T3B0aW9uKCk7XG4gICAgICAgICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLkRPV05fQVJST1c6IHJldHVybiBmb2N1c05leHRPcHRpb24oKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgIGlmIChldi5rZXlDb2RlID49IDMxICYmIGV2LmtleUNvZGUgPD0gOTApIHtcbiAgICAgICAgICAgICAgICB2YXIgb3B0Tm9kZSA9IG9wdHMuc2VsZWN0RWwuY29udHJvbGxlcignbWRTZWxlY3RNZW51Jykub3B0Tm9kZUZvcktleWJvYXJkU2VhcmNoKGV2KTtcbiAgICAgICAgICAgICAgICBvcHROb2RlICYmIG9wdE5vZGUuZm9jdXMoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cblxuICAgICAgICBmdW5jdGlvbiBmb2N1c09wdGlvbihkaXJlY3Rpb24pIHtcbiAgICAgICAgICB2YXIgb3B0aW9uc0FycmF5ID0gJG1kVXRpbC5ub2Rlc1RvQXJyYXkob3B0aW9uTm9kZXMpO1xuICAgICAgICAgIHZhciBpbmRleCA9IG9wdGlvbnNBcnJheS5pbmRleE9mKG9wdHMuZm9jdXNlZE5vZGUpO1xuICAgICAgICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgIC8vIFdlIGxvc3QgdGhlIHByZXZpb3VzbHkgZm9jdXNlZCBlbGVtZW50LCByZXNldCB0byBmaXJzdCBvcHRpb25cbiAgICAgICAgICAgIGluZGV4ID0gMDtcbiAgICAgICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ25leHQnICYmIGluZGV4IDwgb3B0aW9uc0FycmF5Lmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgICAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT09ICdwcmV2JyAmJiBpbmRleCA+IDApIHtcbiAgICAgICAgICAgIGluZGV4LS07XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBuZXdPcHRpb24gPSBvcHRzLmZvY3VzZWROb2RlID0gb3B0aW9uc0FycmF5W2luZGV4XTtcbiAgICAgICAgICBuZXdPcHRpb24gJiYgbmV3T3B0aW9uLmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZm9jdXNOZXh0T3B0aW9uKCkge1xuICAgICAgICAgIGZvY3VzT3B0aW9uKCduZXh0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZm9jdXNQcmV2T3B0aW9uKCkge1xuICAgICAgICAgIGZvY3VzT3B0aW9uKCdwcmV2Jyk7XG4gICAgICAgIH1cblxuICAgICAgICBvcHRzLnNlbGVjdEVsLm9uKCdjbGljaycsIGNoZWNrQ2xvc2VNZW51KTtcbiAgICAgICAgb3B0cy5zZWxlY3RFbC5vbigna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICBpZiAoZS5rZXlDb2RlID09IDMyIHx8IGUua2V5Q29kZSA9PSAxMykge1xuICAgICAgICAgICAgY2hlY2tDbG9zZU1lbnUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIGNoZWNrQ2xvc2VNZW51KCkge1xuICAgICAgICAgIGlmICghc2VsZWN0Q3RybC5pc011bHRpcGxlKSB7XG4gICAgICAgICAgICBvcHRzLnJlc3RvcmVGb2N1cyA9IHRydWU7XG4gICAgICAgICAgICBzY29wZS4kZXZhbEFzeW5jKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAkbWRTZWxlY3QuaGlkZShzZWxlY3RDdHJsLm5nTW9kZWwuJHZpZXdWYWx1ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uUmVtb3ZlKHNjb3BlLCBlbGVtZW50LCBvcHRzKSB7XG4gICAgICBvcHRzLmlzUmVtb3ZlZCA9IHRydWU7XG4gICAgICBlbGVtZW50LmFkZENsYXNzKCdtZC1sZWF2ZScpXG4gICAgICAgIC5yZW1vdmVDbGFzcygnbWQtY2xpY2thYmxlJyk7XG4gICAgICBvcHRzLnRhcmdldC5hdHRyKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XG5cblxuICAgICAgYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpLm9mZigncmVzaXplJywgb3B0cy5yZXNpemVGbik7XG4gICAgICBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdykub2ZmKCdvcmllbnRhdGlvbmNoYW5nZScsIG9wdHMucmVzaXplZm4pO1xuICAgICAgb3B0cy5yZXNpemVGbiA9IHVuZGVmaW5lZDtcblxuICAgICAgdmFyIG1kU2VsZWN0ID0gb3B0cy5zZWxlY3RFbC5jb250cm9sbGVyKCdtZFNlbGVjdCcpO1xuICAgICAgaWYgKG1kU2VsZWN0KSB7XG4gICAgICAgIG1kU2VsZWN0LnNldExhYmVsVGV4dChvcHRzLnNlbGVjdEVsLmNvbnRyb2xsZXIoJ21kU2VsZWN0TWVudScpLnNlbGVjdGVkTGFiZWxzKCkpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gJG1kVXRpbC50cmFuc2l0aW9uRW5kUHJvbWlzZShlbGVtZW50LCB7IHRpbWVvdXQ6IDM1MCB9KS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdtZC1hY3RpdmUnKTtcbiAgICAgICAgb3B0cy5iYWNrZHJvcCAmJiBvcHRzLmJhY2tkcm9wLnJlbW92ZSgpO1xuICAgICAgICBpZiAoZWxlbWVudFswXS5wYXJlbnROb2RlID09PSBvcHRzLnBhcmVudFswXSkge1xuICAgICAgICAgIG9wdHMucGFyZW50WzBdLnJlbW92ZUNoaWxkKGVsZW1lbnRbMF0pOyAvLyB1c2UgYnJvd3NlciB0byBhdm9pZCAkZGVzdHJveSBldmVudFxuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRzLmRpc2FibGVQYXJlbnRTY3JvbGwpIHtcbiAgICAgICAgICBvcHRzLnJlc3RvcmVTY3JvbGwoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0cy5yZXN0b3JlRm9jdXMpIG9wdHMudGFyZ2V0LmZvY3VzKCk7XG4gICAgICAgIG1kU2VsZWN0ICYmIG1kU2VsZWN0LnRyaWdnZXJDbG9zZSgpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYW5pbWF0ZVNlbGVjdChzY29wZSwgZWxlbWVudCwgb3B0cykge1xuICAgICAgdmFyIGNvbnRhaW5lck5vZGUgPSBlbGVtZW50WzBdLFxuICAgICAgICAgIHRhcmdldE5vZGUgPSBvcHRzLnRhcmdldFswXS5maXJzdEVsZW1lbnRDaGlsZC5maXJzdEVsZW1lbnRDaGlsZCwgLy8gdGFyZ2V0IHRoZSBmaXJzdCBzcGFuLCBmdW5jdGlvbmluZyBhcyB0aGUgbGFiZWxcbiAgICAgICAgICBwYXJlbnROb2RlID0gb3B0cy5wYXJlbnRbMF0sXG4gICAgICAgICAgc2VsZWN0Tm9kZSA9IG9wdHMuc2VsZWN0RWxbMF0sXG4gICAgICAgICAgY29udGVudE5vZGUgPSBvcHRzLmNvbnRlbnRFbFswXSxcbiAgICAgICAgICBwYXJlbnRSZWN0ID0gcGFyZW50Tm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICAgICAgICB0YXJnZXRSZWN0ID0gdGFyZ2V0Tm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICAgICAgICBzaG91bGRPcGVuQXJvdW5kVGFyZ2V0ID0gZmFsc2UsXG4gICAgICAgICAgYm91bmRzID0ge1xuICAgICAgICAgICAgbGVmdDogcGFyZW50UmVjdC5sZWZ0ICsgU0VMRUNUX0VER0VfTUFSR0lOLFxuICAgICAgICAgICAgdG9wOiBTRUxFQ1RfRURHRV9NQVJHSU4sXG4gICAgICAgICAgICBib3R0b206IHBhcmVudFJlY3QuaGVpZ2h0IC0gU0VMRUNUX0VER0VfTUFSR0lOLFxuICAgICAgICAgICAgcmlnaHQ6IHBhcmVudFJlY3Qud2lkdGggLSBTRUxFQ1RfRURHRV9NQVJHSU4gLSAoJG1kVXRpbC5mbG9hdGluZ1Njcm9sbGJhcnMoKSA/IDE2IDogMClcbiAgICAgICAgICB9LFxuICAgICAgICAgIHNwYWNlQXZhaWxhYmxlID0ge1xuICAgICAgICAgICAgdG9wOiB0YXJnZXRSZWN0LnRvcCAtIGJvdW5kcy50b3AsXG4gICAgICAgICAgICBsZWZ0OiB0YXJnZXRSZWN0LmxlZnQgLSBib3VuZHMubGVmdCxcbiAgICAgICAgICAgIHJpZ2h0OiBib3VuZHMucmlnaHQgLSAodGFyZ2V0UmVjdC5sZWZ0ICsgdGFyZ2V0UmVjdC53aWR0aCksXG4gICAgICAgICAgICBib3R0b206IGJvdW5kcy5ib3R0b20gLSAodGFyZ2V0UmVjdC50b3AgKyB0YXJnZXRSZWN0LmhlaWdodClcbiAgICAgICAgICB9LFxuICAgICAgICAgIG1heFdpZHRoID0gcGFyZW50UmVjdC53aWR0aCAtIFNFTEVDVF9FREdFX01BUkdJTiAqIDIsXG4gICAgICAgICAgaXNTY3JvbGxhYmxlID0gY29udGVudE5vZGUuc2Nyb2xsSGVpZ2h0ID4gY29udGVudE5vZGUub2Zmc2V0SGVpZ2h0LFxuICAgICAgICAgIHNlbGVjdGVkTm9kZSA9IHNlbGVjdE5vZGUucXVlcnlTZWxlY3RvcignbWQtb3B0aW9uW3NlbGVjdGVkXScpLFxuICAgICAgICAgIG9wdGlvbk5vZGVzID0gc2VsZWN0Tm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbWQtb3B0aW9uJyksXG4gICAgICAgICAgb3B0Z3JvdXBOb2RlcyA9IHNlbGVjdE5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ21kLW9wdGdyb3VwJyk7XG5cblxuICAgICAgdmFyIGNlbnRlcmVkTm9kZTtcbiAgICAgIC8vIElmIGEgc2VsZWN0ZWQgbm9kZSwgY2VudGVyIGFyb3VuZCB0aGF0XG4gICAgICBpZiAoc2VsZWN0ZWROb2RlKSB7XG4gICAgICAgIGNlbnRlcmVkTm9kZSA9IHNlbGVjdGVkTm9kZTtcbiAgICAgIC8vIElmIHRoZXJlIGFyZSBvcHRpb24gZ3JvdXBzLCBjZW50ZXIgYXJvdW5kIHRoZSBmaXJzdCBvcHRpb24gZ3JvdXBcbiAgICAgIH0gZWxzZSBpZiAob3B0Z3JvdXBOb2Rlcy5sZW5ndGgpIHtcbiAgICAgICAgY2VudGVyZWROb2RlID0gb3B0Z3JvdXBOb2Rlc1swXTtcbiAgICAgIC8vIE90aGVyd2lzZSwgY2VudGVyIGFyb3VuZCB0aGUgZmlyc3Qgb3B0aW9uTm9kZVxuICAgICAgfSBlbHNlIGlmIChvcHRpb25Ob2Rlcy5sZW5ndGgpe1xuICAgICAgICBjZW50ZXJlZE5vZGUgPSBvcHRpb25Ob2Rlc1swXTtcbiAgICAgIC8vIEluIGNhc2UgdGhlcmUgYXJlIG5vIG9wdGlvbnMsIGNlbnRlciBvbiB3aGF0ZXZlcidzIGluIHRoZXJlLi4uIChlZyBwcm9ncmVzcyBpbmRpY2F0b3IpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjZW50ZXJlZE5vZGUgPSBjb250ZW50Tm9kZS5maXJzdEVsZW1lbnRDaGlsZCB8fCBjb250ZW50Tm9kZTtcbiAgICAgIH1cblxuICAgICAgaWYgKGNvbnRlbnROb2RlLm9mZnNldFdpZHRoID4gbWF4V2lkdGgpIHtcbiAgICAgICAgY29udGVudE5vZGUuc3R5bGVbJ21heC13aWR0aCddID0gbWF4V2lkdGggKyAncHgnO1xuICAgICAgfVxuICAgICAgaWYgKHNob3VsZE9wZW5Bcm91bmRUYXJnZXQpIHtcbiAgICAgICAgY29udGVudE5vZGUuc3R5bGVbJ21pbi13aWR0aCddID0gdGFyZ2V0UmVjdC53aWR0aCArICdweCc7XG4gICAgICB9XG5cbiAgICAgIC8vIFJlbW92ZSBwYWRkaW5nIGJlZm9yZSB3ZSBjb21wdXRlIHRoZSBwb3NpdGlvbiBvZiB0aGUgbWVudVxuICAgICAgaWYgKGlzU2Nyb2xsYWJsZSkge1xuICAgICAgICBzZWxlY3ROb2RlLmNsYXNzTGlzdC5hZGQoJ21kLW92ZXJmbG93Jyk7XG4gICAgICB9XG5cbiAgICAgIC8vIEdldCB0aGUgc2VsZWN0TWVudVJlY3QgKmFmdGVyKiBtYXgtd2lkdGggaXMgcG9zc2libHkgc2V0IGFib3ZlXG4gICAgICB2YXIgc2VsZWN0TWVudVJlY3QgPSBzZWxlY3ROb2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgdmFyIGNlbnRlcmVkUmVjdCA9IGdldE9mZnNldFJlY3QoY2VudGVyZWROb2RlKTtcblxuICAgICAgaWYgKGNlbnRlcmVkTm9kZSkge1xuICAgICAgICB2YXIgY2VudGVyZWRTdHlsZSA9ICR3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShjZW50ZXJlZE5vZGUpO1xuICAgICAgICBjZW50ZXJlZFJlY3QucGFkZGluZ0xlZnQgPSBwYXJzZUludChjZW50ZXJlZFN0eWxlLnBhZGRpbmdMZWZ0LCAxMCkgfHwgMDtcbiAgICAgICAgY2VudGVyZWRSZWN0LnBhZGRpbmdSaWdodCA9IHBhcnNlSW50KGNlbnRlcmVkU3R5bGUucGFkZGluZ1JpZ2h0LCAxMCkgfHwgMDtcbiAgICAgIH1cblxuICAgICAgdmFyIGZvY3VzZWROb2RlID0gY2VudGVyZWROb2RlO1xuICAgICAgaWYgKChmb2N1c2VkTm9kZS50YWdOYW1lIHx8ICcnKS50b1VwcGVyQ2FzZSgpID09PSAnTUQtT1BUR1JPVVAnKSB7XG4gICAgICAgIGZvY3VzZWROb2RlID0gb3B0aW9uTm9kZXNbMF0gfHwgY29udGVudE5vZGUuZmlyc3RFbGVtZW50Q2hpbGQgfHwgY29udGVudE5vZGU7XG4gICAgICB9XG5cbiAgICAgIGlmIChpc1Njcm9sbGFibGUpIHtcbiAgICAgICAgdmFyIHNjcm9sbEJ1ZmZlciA9IGNvbnRlbnROb2RlLm9mZnNldEhlaWdodCAvIDI7XG4gICAgICAgIGNvbnRlbnROb2RlLnNjcm9sbFRvcCA9IGNlbnRlcmVkUmVjdC50b3AgKyBjZW50ZXJlZFJlY3QuaGVpZ2h0IC8gMiAtIHNjcm9sbEJ1ZmZlcjtcblxuICAgICAgICBpZiAoc3BhY2VBdmFpbGFibGUudG9wIDwgc2Nyb2xsQnVmZmVyKSB7XG4gICAgICAgICAgY29udGVudE5vZGUuc2Nyb2xsVG9wID0gTWF0aC5taW4oXG4gICAgICAgICAgICBjZW50ZXJlZFJlY3QudG9wLFxuICAgICAgICAgICAgY29udGVudE5vZGUuc2Nyb2xsVG9wICsgc2Nyb2xsQnVmZmVyIC0gc3BhY2VBdmFpbGFibGUudG9wXG4gICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIGlmIChzcGFjZUF2YWlsYWJsZS5ib3R0b20gPCBzY3JvbGxCdWZmZXIpIHtcbiAgICAgICAgICBjb250ZW50Tm9kZS5zY3JvbGxUb3AgPSBNYXRoLm1heChcbiAgICAgICAgICAgIGNlbnRlcmVkUmVjdC50b3AgKyBjZW50ZXJlZFJlY3QuaGVpZ2h0IC0gc2VsZWN0TWVudVJlY3QuaGVpZ2h0LFxuICAgICAgICAgICAgY29udGVudE5vZGUuc2Nyb2xsVG9wIC0gc2Nyb2xsQnVmZmVyICsgc3BhY2VBdmFpbGFibGUuYm90dG9tXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB2YXIgbGVmdCwgdG9wLCB0cmFuc2Zvcm1PcmlnaW47XG4gICAgICBpZiAoc2hvdWxkT3BlbkFyb3VuZFRhcmdldCkge1xuICAgICAgICBsZWZ0ID0gdGFyZ2V0UmVjdC5sZWZ0O1xuICAgICAgICB0b3AgPSB0YXJnZXRSZWN0LnRvcCArIHRhcmdldFJlY3QuaGVpZ2h0O1xuICAgICAgICB0cmFuc2Zvcm1PcmlnaW4gPSAnNTAlIDAnO1xuICAgICAgICBpZiAodG9wICsgc2VsZWN0TWVudVJlY3QuaGVpZ2h0ID4gYm91bmRzLmJvdHRvbSkge1xuICAgICAgICAgIHRvcCA9IHRhcmdldFJlY3QudG9wIC0gc2VsZWN0TWVudVJlY3QuaGVpZ2h0O1xuICAgICAgICAgIHRyYW5zZm9ybU9yaWdpbiA9ICc1MCUgMTAwJSc7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxlZnQgPSB0YXJnZXRSZWN0LmxlZnQgKyBjZW50ZXJlZFJlY3QubGVmdCAtIGNlbnRlcmVkUmVjdC5wYWRkaW5nTGVmdDtcbiAgICAgICAgdG9wID0gTWF0aC5mbG9vcih0YXJnZXRSZWN0LnRvcCArIHRhcmdldFJlY3QuaGVpZ2h0IC8gMiAtIGNlbnRlcmVkUmVjdC5oZWlnaHQgLyAyIC1cbiAgICAgICAgICBjZW50ZXJlZFJlY3QudG9wICsgY29udGVudE5vZGUuc2Nyb2xsVG9wKTtcblxuXG4gICAgICAgIHRyYW5zZm9ybU9yaWdpbiA9IChjZW50ZXJlZFJlY3QubGVmdCArIHRhcmdldFJlY3Qud2lkdGggLyAyKSArICdweCAnICtcbiAgICAgICAgKGNlbnRlcmVkUmVjdC50b3AgKyBjZW50ZXJlZFJlY3QuaGVpZ2h0IC8gMiAtIGNvbnRlbnROb2RlLnNjcm9sbFRvcCkgKyAncHggMHB4JztcblxuICAgICAgICBjb250YWluZXJOb2RlLnN0eWxlLm1pbldpZHRoID0gdGFyZ2V0UmVjdC53aWR0aCArIGNlbnRlcmVkUmVjdC5wYWRkaW5nTGVmdCArXG4gICAgICAgICAgY2VudGVyZWRSZWN0LnBhZGRpbmdSaWdodCArICdweCc7XG4gICAgICB9XG5cbiAgICAgIC8vIEtlZXAgbGVmdCBhbmQgdG9wIHdpdGhpbiB0aGUgd2luZG93XG4gICAgICB2YXIgY29udGFpbmVyUmVjdCA9IGNvbnRhaW5lck5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICBjb250YWluZXJOb2RlLnN0eWxlLmxlZnQgPSBjbGFtcChib3VuZHMubGVmdCwgbGVmdCwgYm91bmRzLnJpZ2h0IC0gY29udGFpbmVyUmVjdC53aWR0aCkgKyAncHgnO1xuICAgICAgY29udGFpbmVyTm9kZS5zdHlsZS50b3AgPSBjbGFtcChib3VuZHMudG9wLCB0b3AsIGJvdW5kcy5ib3R0b20gLSBjb250YWluZXJSZWN0LmhlaWdodCkgKyAncHgnO1xuICAgICAgc2VsZWN0Tm9kZS5zdHlsZVskbWRDb25zdGFudC5DU1MuVFJBTlNGT1JNX09SSUdJTl0gPSB0cmFuc2Zvcm1PcmlnaW47XG5cbiAgICAgIHNlbGVjdE5vZGUuc3R5bGVbJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STV0gPSAnc2NhbGUoJyArXG4gICAgICAgIE1hdGgubWluKHRhcmdldFJlY3Qud2lkdGggLyBzZWxlY3RNZW51UmVjdC53aWR0aCwgMS4wKSArICcsJyArXG4gICAgICAgIE1hdGgubWluKHRhcmdldFJlY3QuaGVpZ2h0IC8gc2VsZWN0TWVudVJlY3QuaGVpZ2h0LCAxLjApICtcbiAgICAgICcpJztcblxuXG4gICAgICAkJHJBRihmdW5jdGlvbigpIHtcbiAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnbWQtYWN0aXZlJyk7XG4gICAgICAgIHNlbGVjdE5vZGUuc3R5bGVbJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STV0gPSAnJztcbiAgICAgICAgaWYgKGZvY3VzZWROb2RlKSB7XG4gICAgICAgICAgb3B0cy5mb2N1c2VkTm9kZSA9IGZvY3VzZWROb2RlO1xuICAgICAgICAgIGZvY3VzZWROb2RlLmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICB9XG5cbiAgZnVuY3Rpb24gY2xhbXAobWluLCBuLCBtYXgpIHtcbiAgICByZXR1cm4gTWF0aC5tYXgobWluLCBNYXRoLm1pbihuLCBtYXgpKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldE9mZnNldFJlY3Qobm9kZSkge1xuICAgIHJldHVybiBub2RlID8ge1xuICAgICAgbGVmdDogbm9kZS5vZmZzZXRMZWZ0LFxuICAgICAgdG9wOiBub2RlLm9mZnNldFRvcCxcbiAgICAgIHdpZHRoOiBub2RlLm9mZnNldFdpZHRoLFxuICAgICAgaGVpZ2h0OiBub2RlLm9mZnNldEhlaWdodFxuICAgIH0gOiB7IGxlZnQ6IDAsIHRvcDogMCwgd2lkdGg6IDAsIGhlaWdodDogMCB9O1xuICB9XG59XG5TZWxlY3RQcm92aWRlci4kaW5qZWN0ID0gW1wiJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyXCJdO1xuXG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIEBuZ2RvYyBtb2R1bGVcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuc2lkZW5hdlxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogQSBTaWRlbmF2IFFQIGNvbXBvbmVudC5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuc2lkZW5hdicsIFtcbiAgICAnbWF0ZXJpYWwuY29yZScsXG4gICAgJ21hdGVyaWFsLmNvbXBvbmVudHMuYmFja2Ryb3AnXG4gIF0pXG4gIC5mYWN0b3J5KCckbWRTaWRlbmF2JywgU2lkZW5hdlNlcnZpY2UgKVxuICAuZGlyZWN0aXZlKCdtZFNpZGVuYXYnLCBTaWRlbmF2RGlyZWN0aXZlKVxuICAuZGlyZWN0aXZlKCdtZFNpZGVuYXZGb2N1cycsIFNpZGVuYXZGb2N1c0RpcmVjdGl2ZSlcbiAgLmNvbnRyb2xsZXIoJyRtZFNpZGVuYXZDb250cm9sbGVyJywgU2lkZW5hdkNvbnRyb2xsZXIpO1xuXG5cbi8qKlxuICogQHByaXZhdGVcbiAqIEBuZ2RvYyBzZXJ2aWNlXG4gKiBAbmFtZSAkbWRTaWRlbmF2XG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuc2lkZW5hdlxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogYCRtZFNpZGVuYXZgIG1ha2VzIGl0IGVhc3kgdG8gaW50ZXJhY3Qgd2l0aCBtdWx0aXBsZSBzaWRlbmF2c1xuICogaW4gYW4gYXBwLlxuICpcbiAqIEB1c2FnZVxuICogPGhsanMgbGFuZz1cImpzXCI+XG4gKiAvLyBBc3luYyBsb29rdXAgZm9yIHNpZGVuYXYgaW5zdGFuY2U7IHdpbGwgcmVzb2x2ZSB3aGVuIHRoZSBpbnN0YW5jZSBpcyBhdmFpbGFibGVcbiAqICRtZFNpZGVuYXYoY29tcG9uZW50SWQpLnRoZW4oZnVuY3Rpb24oaW5zdGFuY2UpIHtcbiAqICAgJGxvZy5kZWJ1ZyggY29tcG9uZW50SWQgKyBcImlzIG5vdyByZWFkeVwiICk7XG4gKiB9KTtcbiAqIC8vIEFzeW5jIHRvZ2dsZSB0aGUgZ2l2ZW4gc2lkZW5hdjtcbiAqIC8vIHdoZW4gaW5zdGFuY2UgaXMga25vd24gcmVhZHkgYW5kIGxhenkgbG9va3VwIGlzIG5vdCBuZWVkZWQuXG4gKiAkbWRTaWRlbmF2KGNvbXBvbmVudElkKVxuICogICAgLnRvZ2dsZSgpXG4gKiAgICAudGhlbihmdW5jdGlvbigpe1xuICogICAgICAkbG9nLmRlYnVnKCd0b2dnbGVkJyk7XG4gKiAgICB9KTtcbiAqIC8vIEFzeW5jIG9wZW4gdGhlIGdpdmVuIHNpZGVuYXZcbiAqICRtZFNpZGVuYXYoY29tcG9uZW50SWQpXG4gKiAgICAub3BlbigpXG4gKiAgICAudGhlbihmdW5jdGlvbigpe1xuICogICAgICAkbG9nLmRlYnVnKCdvcGVuZWQnKTtcbiAqICAgIH0pO1xuICogLy8gQXN5bmMgY2xvc2UgdGhlIGdpdmVuIHNpZGVuYXZcbiAqICRtZFNpZGVuYXYoY29tcG9uZW50SWQpXG4gKiAgICAuY2xvc2UoKVxuICogICAgLnRoZW4oZnVuY3Rpb24oKXtcbiAqICAgICAgJGxvZy5kZWJ1ZygnY2xvc2VkJyk7XG4gKiAgICB9KTtcbiAqIC8vIFN5bmMgY2hlY2sgdG8gc2VlIGlmIHRoZSBzcGVjaWZpZWQgc2lkZW5hdiBpcyBzZXQgdG8gYmUgb3BlblxuICogJG1kU2lkZW5hdihjb21wb25lbnRJZCkuaXNPcGVuKCk7XG4gKiAvLyBTeW5jIGNoZWNrIHRvIHdoZXRoZXIgZ2l2ZW4gc2lkZW5hdiBpcyBsb2NrZWQgb3BlblxuICogLy8gSWYgdGhpcyBpcyB0cnVlLCB0aGUgc2lkZW5hdiB3aWxsIGJlIG9wZW4gcmVnYXJkbGVzcyBvZiBjbG9zZSgpXG4gKiAkbWRTaWRlbmF2KGNvbXBvbmVudElkKS5pc0xvY2tlZE9wZW4oKTtcbiAqIDwvaGxqcz5cbiAqL1xuZnVuY3Rpb24gU2lkZW5hdlNlcnZpY2UoJG1kQ29tcG9uZW50UmVnaXN0cnksICRxKSB7XG4gIHJldHVybiBmdW5jdGlvbihoYW5kbGUpIHtcblxuICAgIC8vIExvb2t1cCB0aGUgY29udHJvbGxlciBpbnN0YW5jZSBmb3IgdGhlIHNwZWNpZmllZCBzaWROYXYgaW5zdGFuY2VcbiAgICB2YXIgc2VsZjtcbiAgICB2YXIgZXJyb3JNc2cgPSBcIlNpZGVOYXYgJ1wiICsgaGFuZGxlICsgXCInIGlzIG5vdCBhdmFpbGFibGUhXCI7XG4gICAgdmFyIGluc3RhbmNlID0gJG1kQ29tcG9uZW50UmVnaXN0cnkuZ2V0KGhhbmRsZSk7XG5cbiAgICBpZighaW5zdGFuY2UpIHtcbiAgICAgICRtZENvbXBvbmVudFJlZ2lzdHJ5Lm5vdEZvdW5kRXJyb3IoaGFuZGxlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gc2VsZiA9IHtcbiAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAvLyBTeW5jIG1ldGhvZHNcbiAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICBpc09wZW46IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gaW5zdGFuY2UgJiYgaW5zdGFuY2UuaXNPcGVuKCk7XG4gICAgICB9LFxuICAgICAgaXNMb2NrZWRPcGVuOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlICYmIGluc3RhbmNlLmlzTG9ja2VkT3BlbigpO1xuICAgICAgfSxcbiAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAvLyBBc3luYyBtZXRob2RzXG4gICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgdG9nZ2xlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlID8gaW5zdGFuY2UudG9nZ2xlKCkgOiAkcS5yZWplY3QoZXJyb3JNc2cpO1xuICAgICAgfSxcbiAgICAgIG9wZW46IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gaW5zdGFuY2UgPyBpbnN0YW5jZS5vcGVuKCkgOiAkcS5yZWplY3QoZXJyb3JNc2cpO1xuICAgICAgfSxcbiAgICAgIGNsb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlID8gaW5zdGFuY2UuY2xvc2UoKSA6ICRxLnJlamVjdChlcnJvck1zZyk7XG4gICAgICB9LFxuICAgICAgdGhlbiA6IGZ1bmN0aW9uKCBjYWxsYmFja0ZuICkge1xuICAgICAgICB2YXIgcHJvbWlzZSA9IGluc3RhbmNlID8gJHEud2hlbihpbnN0YW5jZSkgOiB3YWl0Rm9ySW5zdGFuY2UoKTtcbiAgICAgICAgcmV0dXJuIHByb21pc2UudGhlbiggY2FsbGJhY2tGbiB8fCBhbmd1bGFyLm5vb3AgKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogRGVmZXJyZWQgbG9va3VwIG9mIGNvbXBvbmVudCBpbnN0YW5jZSB1c2luZyAkY29tcG9uZW50IHJlZ2lzdHJ5XG4gICAgICovXG4gICAgZnVuY3Rpb24gd2FpdEZvckluc3RhbmNlKCkge1xuICAgICAgcmV0dXJuICRtZENvbXBvbmVudFJlZ2lzdHJ5XG4gICAgICAgICAgICAgICAgLndoZW4oaGFuZGxlKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCBpdCApe1xuICAgICAgICAgICAgICAgICAgaW5zdGFuY2UgPSBpdDtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBpdDtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICB9XG4gIH07XG59XG5TaWRlbmF2U2VydmljZS4kaW5qZWN0ID0gW1wiJG1kQ29tcG9uZW50UmVnaXN0cnlcIiwgXCIkcVwiXTtcbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbWRTaWRlbmF2Rm9jdXNcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5zaWRlbmF2XG4gKlxuICogQHJlc3RyaWN0IEFcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIGAkbWRTaWRlbmF2Rm9jdXNgIHByb3ZpZGVzIGEgd2F5IHRvIHNwZWNpZnkgdGhlIGZvY3VzZWQgZWxlbWVudCB3aGVuIGEgc2lkZW5hdiBvcGVucy5cbiAqIFRoaXMgaXMgY29tcGxldGVseSBvcHRpb25hbCwgYXMgdGhlIHNpZGVuYXYgaXRzZWxmIGlzIGZvY3VzZWQgYnkgZGVmYXVsdC5cbiAqXG4gKiBAdXNhZ2VcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiA8bWQtc2lkZW5hdj5cbiAqICAgPGZvcm0+XG4gKiAgICAgPG1kLWlucHV0LWNvbnRhaW5lcj5cbiAqICAgICAgIDxsYWJlbCBmb3I9XCJ0ZXN0SW5wdXRcIj5MYWJlbDwvbGFiZWw+XG4gKiAgICAgICA8aW5wdXQgaWQ9XCJ0ZXN0SW5wdXRcIiB0eXBlPVwidGV4dFwiIG1kLXNpZGVuYXYtZm9jdXM+XG4gKiAgICAgPC9tZC1pbnB1dC1jb250YWluZXI+XG4gKiAgIDwvZm9ybT5cbiAqIDwvbWQtc2lkZW5hdj5cbiAqIDwvaGxqcz5cbiAqKi9cbmZ1bmN0aW9uIFNpZGVuYXZGb2N1c0RpcmVjdGl2ZSgpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIHJlcXVpcmU6ICdebWRTaWRlbmF2JyxcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0ciwgc2lkZW5hdkN0cmwpIHtcbiAgICAgIHNpZGVuYXZDdHJsLmZvY3VzRWxlbWVudChlbGVtZW50KTtcbiAgICB9XG4gIH07XG59XG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG1kU2lkZW5hdlxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnNpZGVuYXZcbiAqIEByZXN0cmljdCBFXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKlxuICogQSBTaWRlbmF2IGNvbXBvbmVudCB0aGF0IGNhbiBiZSBvcGVuZWQgYW5kIGNsb3NlZCBwcm9ncmFtYXRpY2FsbHkuXG4gKlxuICogQnkgZGVmYXVsdCwgdXBvbiBvcGVuaW5nIGl0IHdpbGwgc2xpZGUgb3V0IG9uIHRvcCBvZiB0aGUgbWFpbiBjb250ZW50IGFyZWEuXG4gKlxuICogRm9yIGtleWJvYXJkIGFuZCBzY3JlZW4gcmVhZGVyIGFjY2Vzc2liaWxpdHksIGZvY3VzIGlzIHNlbnQgdG8gdGhlIHNpZGVuYXYgd3JhcHBlciBieSBkZWZhdWx0LlxuICogSXQgY2FuIGJlIG92ZXJyaWRkZW4gd2l0aCB0aGUgYG1kLXNpZGVuYXYtZm9jdXNgIGRpcmVjdGl2ZSBvbiB0aGUgY2hpbGQgZWxlbWVudCB5b3Ugd2FudCBmb2N1c2VkLlxuICpcbiAqIEB1c2FnZVxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cbiAqIDxkaXYgbGF5b3V0PVwicm93XCIgbmctY29udHJvbGxlcj1cIk15Q29udHJvbGxlclwiPlxuICogICA8bWQtc2lkZW5hdiBtZC1jb21wb25lbnQtaWQ9XCJsZWZ0XCIgY2xhc3M9XCJtZC1zaWRlbmF2LWxlZnRcIj5cbiAqICAgICBMZWZ0IE5hdiFcbiAqICAgPC9tZC1zaWRlbmF2PlxuICpcbiAqICAgPG1kLWNvbnRlbnQ+XG4gKiAgICAgQ2VudGVyIENvbnRlbnRcbiAqICAgICA8bWQtYnV0dG9uIG5nLWNsaWNrPVwib3BlbkxlZnRNZW51KClcIj5cbiAqICAgICAgIE9wZW4gTGVmdCBNZW51XG4gKiAgICAgPC9tZC1idXR0b24+XG4gKiAgIDwvbWQtY29udGVudD5cbiAqXG4gKiAgIDxtZC1zaWRlbmF2IG1kLWNvbXBvbmVudC1pZD1cInJpZ2h0XCJcbiAqICAgICBtZC1pcy1sb2NrZWQtb3Blbj1cIiRtZE1lZGlhKCdtaW4td2lkdGg6IDMzM3B4JylcIlxuICogICAgIGNsYXNzPVwibWQtc2lkZW5hdi1yaWdodFwiPlxuICogICAgIDxmb3JtPlxuICogICAgICAgPG1kLWlucHV0LWNvbnRhaW5lcj5cbiAqICAgICAgICAgPGxhYmVsIGZvcj1cInRlc3RJbnB1dFwiPlRlc3QgaW5wdXQ8L2xhYmVsPlxuICogICAgICAgICA8aW5wdXQgaWQ9XCJ0ZXN0SW5wdXRcIiB0eXBlPVwidGV4dFwiXG4gKiAgICAgICAgICAgICAgICBuZy1tb2RlbD1cImRhdGFcIiBtZC1zaWRlbmF2LWZvY3VzPlxuICogICAgICAgPC9tZC1pbnB1dC1jb250YWluZXI+XG4gKiAgICAgPC9mb3JtPlxuICogICA8L21kLXNpZGVuYXY+XG4gKiA8L2Rpdj5cbiAqIDwvaGxqcz5cbiAqXG4gKiA8aGxqcyBsYW5nPVwianNcIj5cbiAqIHZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbXlBcHAnLCBbJ25nTWF0ZXJpYWwnXSk7XG4gKiBhcHAuY29udHJvbGxlcignTXlDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkbWRTaWRlbmF2KSB7XG4gKiAgICRzY29wZS5vcGVuTGVmdE1lbnUgPSBmdW5jdGlvbigpIHtcbiAqICAgICAkbWRTaWRlbmF2KCdsZWZ0JykudG9nZ2xlKCk7XG4gKiAgIH07XG4gKiB9KTtcbiAqIDwvaGxqcz5cbiAqXG4gKiBAcGFyYW0ge2V4cHJlc3Npb249fSBtZC1pcy1vcGVuIEEgbW9kZWwgYm91bmQgdG8gd2hldGhlciB0aGUgc2lkZW5hdiBpcyBvcGVuZWQuXG4gKiBAcGFyYW0ge3N0cmluZz19IG1kLWNvbXBvbmVudC1pZCBjb21wb25lbnRJZCB0byB1c2Ugd2l0aCAkbWRTaWRlbmF2IHNlcnZpY2UuXG4gKiBAcGFyYW0ge2V4cHJlc3Npb249fSBtZC1pcy1sb2NrZWQtb3BlbiBXaGVuIHRoaXMgZXhwcmVzc2lvbiBldmFsdXRlcyB0byB0cnVlLFxuICogdGhlIHNpZGVuYXYgJ2xvY2tzIG9wZW4nOiBpdCBmYWxscyBpbnRvIHRoZSBjb250ZW50J3MgZmxvdyBpbnN0ZWFkXG4gKiBvZiBhcHBlYXJpbmcgb3ZlciBpdC4gVGhpcyBvdmVycmlkZXMgdGhlIGBpcy1vcGVuYCBhdHRyaWJ1dGUuXG4gKlxuICogVGhlICRtZE1lZGlhKCkgc2VydmljZSBpcyBleHBvc2VkIHRvIHRoZSBpcy1sb2NrZWQtb3BlbiBhdHRyaWJ1dGUsIHdoaWNoXG4gKiBjYW4gYmUgZ2l2ZW4gYSBtZWRpYSBxdWVyeSBvciBvbmUgb2YgdGhlIGBzbWAsIGBndC1zbWAsIGBtZGAsIGBndC1tZGAsIGBsZ2Agb3IgYGd0LWxnYCBwcmVzZXRzLlxuICogRXhhbXBsZXM6XG4gKlxuICogICAtIGA8bWQtc2lkZW5hdiBtZC1pcy1sb2NrZWQtb3Blbj1cInNob3VsZExvY2tPcGVuXCI+PC9tZC1zaWRlbmF2PmBcbiAqICAgLSBgPG1kLXNpZGVuYXYgbWQtaXMtbG9ja2VkLW9wZW49XCIkbWRNZWRpYSgnbWluLXdpZHRoOiAxMDAwcHgnKVwiPjwvbWQtc2lkZW5hdj5gXG4gKiAgIC0gYDxtZC1zaWRlbmF2IG1kLWlzLWxvY2tlZC1vcGVuPVwiJG1kTWVkaWEoJ3NtJylcIj48L21kLXNpZGVuYXY+YCAobG9ja3Mgb3BlbiBvbiBzbWFsbCBzY3JlZW5zKVxuICovXG5mdW5jdGlvbiBTaWRlbmF2RGlyZWN0aXZlKCR0aW1lb3V0LCAkYW5pbWF0ZSwgJHBhcnNlLCAkbG9nLCAkbWRNZWRpYSwgJG1kQ29uc3RhbnQsICRjb21waWxlLCAkbWRUaGVtaW5nLCAkcSwgJGRvY3VtZW50KSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdFJyxcbiAgICBzY29wZToge1xuICAgICAgaXNPcGVuOiAnPT9tZElzT3BlbidcbiAgICB9LFxuICAgIGNvbnRyb2xsZXI6ICckbWRTaWRlbmF2Q29udHJvbGxlcicsXG4gICAgY29tcGlsZTogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgZWxlbWVudC5hZGRDbGFzcygnbWQtY2xvc2VkJyk7XG4gICAgICBlbGVtZW50LmF0dHIoJ3RhYkluZGV4JywgJy0xJyk7XG4gICAgICByZXR1cm4gcG9zdExpbms7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBEaXJlY3RpdmUgUG9zdCBMaW5rIGZ1bmN0aW9uLi4uXG4gICAqL1xuICBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0ciwgc2lkZW5hdkN0cmwpIHtcbiAgICB2YXIgbGFzdFBhcmVudE92ZXJGbG93O1xuICAgIHZhciB0cmlnZ2VyaW5nRWxlbWVudCA9IG51bGw7XG4gICAgdmFyIHByb21pc2UgPSAkcS53aGVuKHRydWUpO1xuXG4gICAgdmFyIGlzTG9ja2VkT3BlblBhcnNlZCA9ICRwYXJzZShhdHRyLm1kSXNMb2NrZWRPcGVuKTtcbiAgICB2YXIgaXNMb2NrZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBpc0xvY2tlZE9wZW5QYXJzZWQoc2NvcGUuJHBhcmVudCwge1xuICAgICAgICAkbWVkaWE6IGZ1bmN0aW9uKGFyZykge1xuICAgICAgICAgICRsb2cud2FybihcIiRtZWRpYSBpcyBkZXByZWNhdGVkIGZvciBpcy1sb2NrZWQtb3Blbi4gVXNlICRtZE1lZGlhIGluc3RlYWQuXCIpO1xuICAgICAgICAgIHJldHVybiAkbWRNZWRpYShhcmcpO1xuICAgICAgICB9LFxuICAgICAgICAkbWRNZWRpYTogJG1kTWVkaWFcbiAgICAgIH0pO1xuICAgIH07XG4gICAgdmFyIGJhY2tkcm9wID0gJGNvbXBpbGUoXG4gICAgICAnPG1kLWJhY2tkcm9wIGNsYXNzPVwibWQtc2lkZW5hdi1iYWNrZHJvcCBtZC1vcGFxdWUgbmctZW50ZXJcIj4nXG4gICAgKShzY29wZSk7XG5cbiAgICBlbGVtZW50Lm9uKCckZGVzdHJveScsIHNpZGVuYXZDdHJsLmRlc3Ryb3kpO1xuICAgICRtZFRoZW1pbmcuaW5oZXJpdChiYWNrZHJvcCwgZWxlbWVudCk7XG5cbiAgICBzY29wZS4kd2F0Y2goaXNMb2NrZWQsIHVwZGF0ZUlzTG9ja2VkKTtcbiAgICBzY29wZS4kd2F0Y2goJ2lzT3BlbicsIHVwZGF0ZUlzT3Blbik7XG5cblxuICAgIC8vIFB1Ymxpc2ggc3BlY2lhbCBhY2Nlc3NvciBmb3IgdGhlIENvbnRyb2xsZXIgaW5zdGFuY2VcbiAgICBzaWRlbmF2Q3RybC4kdG9nZ2xlT3BlbiA9IHRvZ2dsZU9wZW47XG4gICAgc2lkZW5hdkN0cmwuZm9jdXNFbGVtZW50KCBzaWRlbmF2Q3RybC5mb2N1c0VsZW1lbnQoKSB8fCBlbGVtZW50ICk7XG5cbiAgICAvKipcbiAgICAgKiBUb2dnbGUgdGhlIERPTSBjbGFzc2VzIHRvIGluZGljYXRlIGBsb2NrZWRgXG4gICAgICogQHBhcmFtIGlzTG9ja2VkXG4gICAgICovXG4gICAgZnVuY3Rpb24gdXBkYXRlSXNMb2NrZWQoaXNMb2NrZWQsIG9sZFZhbHVlKSB7XG4gICAgICBzY29wZS5pc0xvY2tlZE9wZW4gPSBpc0xvY2tlZDtcbiAgICAgIGlmIChpc0xvY2tlZCA9PT0gb2xkVmFsdWUpIHtcbiAgICAgICAgZWxlbWVudC50b2dnbGVDbGFzcygnbWQtbG9ja2VkLW9wZW4nLCAhIWlzTG9ja2VkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRhbmltYXRlW2lzTG9ja2VkID8gJ2FkZENsYXNzJyA6ICdyZW1vdmVDbGFzcyddKGVsZW1lbnQsICdtZC1sb2NrZWQtb3BlbicpO1xuICAgICAgfVxuICAgICAgYmFja2Ryb3AudG9nZ2xlQ2xhc3MoJ21kLWxvY2tlZC1vcGVuJywgISFpc0xvY2tlZCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVG9nZ2xlIHRoZSBTaWRlTmF2IHZpZXcgYW5kIGF0dGFjaC9kZXRhY2ggbGlzdGVuZXJzXG4gICAgICogQHBhcmFtIGlzT3BlblxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHVwZGF0ZUlzT3Blbihpc09wZW4pIHtcbiAgICAgIHZhciBwYXJlbnQgPSBlbGVtZW50LnBhcmVudCgpO1xuXG4gICAgICBwYXJlbnRbaXNPcGVuID8gJ29uJyA6ICdvZmYnXSgna2V5ZG93bicsIG9uS2V5RG93bik7XG4gICAgICBiYWNrZHJvcFtpc09wZW4gPyAnb24nIDogJ29mZiddKCdjbGljaycsIGNsb3NlKTtcblxuICAgICAgaWYgKCBpc09wZW4gKSB7XG4gICAgICAgIC8vIENhcHR1cmUgdXBvbiBvcGVuaW5nLi5cbiAgICAgICAgdHJpZ2dlcmluZ0VsZW1lbnQgPSAkZG9jdW1lbnRbMF0uYWN0aXZlRWxlbWVudDtcbiAgICAgIH1cbiAgICAgIHZhciBmb2N1c0VsID0gc2lkZW5hdkN0cmwuZm9jdXNFbGVtZW50KCk7XG5cbiAgICAgIGRpc2FibGVQYXJlbnRTY3JvbGwoaXNPcGVuKTtcblxuICAgICAgcmV0dXJuIHByb21pc2UgPSAkcS5hbGwoW1xuICAgICAgICAgICAgICAgIGlzT3BlbiA/ICRhbmltYXRlLmVudGVyKGJhY2tkcm9wLCBwYXJlbnQpIDogJGFuaW1hdGUubGVhdmUoYmFja2Ryb3ApLFxuICAgICAgICAgICAgICAgICRhbmltYXRlW2lzT3BlbiA/ICdyZW1vdmVDbGFzcycgOiAnYWRkQ2xhc3MnXShlbGVtZW50LCAnbWQtY2xvc2VkJylcbiAgICAgICAgICAgICAgXSlcbiAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgLy8gUGVyZm9ybSBmb2N1cyB3aGVuIGFuaW1hdGlvbnMgYXJlIEFMTCBkb25lLi4uXG4gICAgICAgICAgICAgICAgaWYgKHNjb3BlLmlzT3Blbikge1xuICAgICAgICAgICAgICAgICAgZm9jdXNFbCAmJiBmb2N1c0VsLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcmV2ZW50IHBhcmVudCBzY3JvbGxpbmcgKHdoZW4gdGhlIFNpZGVOYXYgaXMgb3BlbilcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBkaXNhYmxlUGFyZW50U2Nyb2xsKGRpc2FibGVkKSB7XG4gICAgICB2YXIgcGFyZW50ID0gZWxlbWVudC5wYXJlbnQoKTtcbiAgICAgIGlmICggZGlzYWJsZWQgKSB7XG4gICAgICAgIGxhc3RQYXJlbnRPdmVyRmxvdyA9IHBhcmVudC5jc3MoJ292ZXJmbG93Jyk7XG4gICAgICAgIHBhcmVudC5jc3MoJ292ZXJmbG93JywgJ2hpZGRlbicpO1xuICAgICAgfSBlbHNlIGlmIChhbmd1bGFyLmlzRGVmaW5lZChsYXN0UGFyZW50T3ZlckZsb3cpKSB7XG4gICAgICAgIHBhcmVudC5jc3MoJ292ZXJmbG93JywgbGFzdFBhcmVudE92ZXJGbG93KTtcbiAgICAgICAgbGFzdFBhcmVudE92ZXJGbG93ID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRvZ2dsZSB0aGUgc2lkZU5hdiB2aWV3IGFuZCBwdWJsaXNoIGEgcHJvbWlzZSB0byBiZSByZXNvbHZlZCB3aGVuXG4gICAgICogdGhlIHZpZXcgYW5pbWF0aW9uIGZpbmlzaGVzLlxuICAgICAqXG4gICAgICogQHBhcmFtIGlzT3BlblxuICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHRvZ2dsZU9wZW4oIGlzT3BlbiApIHtcbiAgICAgIGlmIChzY29wZS5pc09wZW4gPT0gaXNPcGVuICkge1xuXG4gICAgICAgIHJldHVybiAkcS53aGVuKHRydWUpO1xuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgIC8vIFRvZ2dsZSB2YWx1ZSB0byBmb3JjZSBhbiBhc3luYyBgdXBkYXRlSXNPcGVuKClgIHRvIHJ1blxuICAgICAgICBzY29wZS5pc09wZW4gPSBpc09wZW47XG5cbiAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAvLyBXaGVuIHRoZSBjdXJyZW50IGB1cGRhdGVJc09wZW4oKWAgYW5pbWF0aW9uIGZpbmlzaGVzXG4gICAgICAgICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuXG4gICAgICAgICAgICBpZiAoICFzY29wZS5pc09wZW4gKSB7XG4gICAgICAgICAgICAgIC8vIHJlc2V0IGZvY3VzIHRvIG9yaWdpbmF0aW5nIGVsZW1lbnQgKGlmIGF2YWlsYWJsZSkgdXBvbiBjbG9zZVxuICAgICAgICAgICAgICB0cmlnZ2VyaW5nRWxlbWVudCAmJiB0cmlnZ2VyaW5nRWxlbWVudC5mb2N1cygpO1xuICAgICAgICAgICAgICB0cmlnZ2VyaW5nRWxlbWVudCA9IG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICB9LDAsZmFsc2UpO1xuXG4gICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEF1dG8tY2xvc2Ugc2lkZU5hdiB3aGVuIHRoZSBgZXNjYXBlYCBrZXkgaXMgcHJlc3NlZC5cbiAgICAgKiBAcGFyYW0gZXZ0XG4gICAgICovXG4gICAgZnVuY3Rpb24gb25LZXlEb3duKGV2KSB7XG4gICAgICB2YXIgaXNFc2NhcGUgPSAoZXYua2V5Q29kZSA9PT0gJG1kQ29uc3RhbnQuS0VZX0NPREUuRVNDQVBFKTtcbiAgICAgIHJldHVybiBpc0VzY2FwZSA/IGNsb3NlKGV2KSA6ICRxLndoZW4odHJ1ZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogV2l0aCBiYWNrZHJvcCBgY2xpY2tzYCBvciBgZXNjYXBlYCBrZXktcHJlc3MsIGltbWVkaWF0ZWx5XG4gICAgICogYXBwbHkgdGhlIENTUyBjbG9zZSB0cmFuc2l0aW9uLi4uIFRoZW4gbm90aWZ5IHRoZSBjb250cm9sbGVyXG4gICAgICogdG8gY2xvc2UoKSBhbmQgcGVyZm9ybSBpdHMgb3duIGFjdGlvbnMuXG4gICAgICovXG4gICAgZnVuY3Rpb24gY2xvc2UoZXYpIHtcbiAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgcmV0dXJuIHNpZGVuYXZDdHJsLmNsb3NlKCk7XG4gICAgfVxuXG4gIH1cbn1cblNpZGVuYXZEaXJlY3RpdmUuJGluamVjdCA9IFtcIiR0aW1lb3V0XCIsIFwiJGFuaW1hdGVcIiwgXCIkcGFyc2VcIiwgXCIkbG9nXCIsIFwiJG1kTWVkaWFcIiwgXCIkbWRDb25zdGFudFwiLCBcIiRjb21waWxlXCIsIFwiJG1kVGhlbWluZ1wiLCBcIiRxXCIsIFwiJGRvY3VtZW50XCJdO1xuXG4vKlxuICogQHByaXZhdGVcbiAqIEBuZ2RvYyBjb250cm9sbGVyXG4gKiBAbmFtZSBTaWRlbmF2Q29udHJvbGxlclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnNpZGVuYXZcbiAqXG4gKi9cbmZ1bmN0aW9uIFNpZGVuYXZDb250cm9sbGVyKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgJG1kQ29tcG9uZW50UmVnaXN0cnksICRxKSB7XG5cbiAgdmFyIHNlbGYgPSB0aGlzLFxuICAgICAgZm9jdXNFbGVtZW50O1xuXG4gIC8vIFVzZSBEZWZhdWx0IGludGVybmFsIG1ldGhvZCB1bnRpbCBvdmVycmlkZGVuIGJ5IGRpcmVjdGl2ZSBwb3N0TGlua1xuXG4gIC8vIFN5bmNocm9ub3VzIGdldHRlcnNcbiAgc2VsZi5pc09wZW4gPSBmdW5jdGlvbigpIHsgcmV0dXJuICEhJHNjb3BlLmlzT3BlbjsgfTtcbiAgc2VsZi5pc0xvY2tlZE9wZW4gPSBmdW5jdGlvbigpIHsgcmV0dXJuICEhJHNjb3BlLmlzTG9ja2VkT3BlbjsgfTtcblxuICAvLyBBc3luYyBhY3Rpb25zXG4gIHNlbGYub3BlbiAgID0gZnVuY3Rpb24oKSB7IHJldHVybiBzZWxmLiR0b2dnbGVPcGVuKCB0cnVlICk7ICB9O1xuICBzZWxmLmNsb3NlICA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gc2VsZi4kdG9nZ2xlT3BlbiggZmFsc2UgKTsgfTtcbiAgc2VsZi50b2dnbGUgPSBmdW5jdGlvbigpIHsgcmV0dXJuIHNlbGYuJHRvZ2dsZU9wZW4oICEkc2NvcGUuaXNPcGVuICk7ICB9O1xuICBzZWxmLmZvY3VzRWxlbWVudCA9IGZ1bmN0aW9uKGVsKSB7XG4gICAgaWYgKCBhbmd1bGFyLmlzRGVmaW5lZChlbCkgKSB7XG4gICAgICBmb2N1c0VsZW1lbnQgPSBlbDtcbiAgICB9XG4gICAgcmV0dXJuIGZvY3VzRWxlbWVudDtcbiAgfTtcblxuICBzZWxmLiR0b2dnbGVPcGVuID0gZnVuY3Rpb24oKSB7IHJldHVybiAkcS53aGVuKCRzY29wZS5pc09wZW4pOyB9O1xuXG4gIHNlbGYuZGVzdHJveSA9ICRtZENvbXBvbmVudFJlZ2lzdHJ5LnJlZ2lzdGVyKHNlbGYsICRhdHRycy5tZENvbXBvbmVudElkKTtcbn1cblNpZGVuYXZDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkZWxlbWVudFwiLCBcIiRhdHRyc1wiLCBcIiRtZENvbXBvbmVudFJlZ2lzdHJ5XCIsIFwiJHFcIl07XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG4gIC8qKlxuICAgKiBAbmdkb2MgbW9kdWxlXG4gICAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuc2xpZGVyXG4gICAqL1xuICBhbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5zbGlkZXInLCBbXG4gICAgJ21hdGVyaWFsLmNvcmUnXG4gIF0pXG4gIC5kaXJlY3RpdmUoJ21kU2xpZGVyJywgU2xpZGVyRGlyZWN0aXZlKTtcblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBtZFNsaWRlclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnNsaWRlclxuICogQHJlc3RyaWN0IEVcbiAqIEBkZXNjcmlwdGlvblxuICogVGhlIGA8bWQtc2xpZGVyPmAgY29tcG9uZW50IGFsbG93cyB0aGUgdXNlciB0byBjaG9vc2UgZnJvbSBhIHJhbmdlIG9mXG4gKiB2YWx1ZXMuXG4gKlxuICogQXMgcGVyIHRoZSBbbWF0ZXJpYWwgZGVzaWduIHNwZWNdKGh0dHA6Ly93d3cuZ29vZ2xlLmNvbS9kZXNpZ24vc3BlYy9zdHlsZS9jb2xvci5odG1sI2NvbG9yLXVpLWNvbG9yLWFwcGxpY2F0aW9uKVxuICogdGhlIHNsaWRlciBpcyBpbiB0aGUgYWNjZW50IGNvbG9yIGJ5IGRlZmF1bHQuIFRoZSBwcmltYXJ5IGNvbG9yIHBhbGV0dGUgbWF5IGJlIHVzZWQgd2l0aFxuICogdGhlIGBtZC1wcmltYXJ5YCBjbGFzcy5cbiAqXG4gKiBJdCBoYXMgdHdvIG1vZGVzOiAnbm9ybWFsJyBtb2RlLCB3aGVyZSB0aGUgdXNlciBzbGlkZXMgYmV0d2VlbiBhIHdpZGUgcmFuZ2VcbiAqIG9mIHZhbHVlcywgYW5kICdkaXNjcmV0ZScgbW9kZSwgd2hlcmUgdGhlIHVzZXIgc2xpZGVzIGJldHdlZW4gb25seSBhIGZld1xuICogc2VsZWN0IHZhbHVlcy5cbiAqXG4gKiBUbyBlbmFibGUgZGlzY3JldGUgbW9kZSwgYWRkIHRoZSBgbWQtZGlzY3JldGVgIGF0dHJpYnV0ZSB0byBhIHNsaWRlcixcbiAqIGFuZCB1c2UgdGhlIGBzdGVwYCBhdHRyaWJ1dGUgdG8gY2hhbmdlIHRoZSBkaXN0YW5jZSBiZXR3ZWVuXG4gKiB2YWx1ZXMgdGhlIHVzZXIgaXMgYWxsb3dlZCB0byBwaWNrLlxuICpcbiAqIEB1c2FnZVxuICogPGg0Pk5vcm1hbCBNb2RlPC9oND5cbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiA8bWQtc2xpZGVyIG5nLW1vZGVsPVwibXlWYWx1ZVwiIG1pbj1cIjVcIiBtYXg9XCI1MDBcIj5cbiAqIDwvbWQtc2xpZGVyPlxuICogPC9obGpzPlxuICogPGg0PkRpc2NyZXRlIE1vZGU8L2g0PlxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cbiAqIDxtZC1zbGlkZXIgbWQtZGlzY3JldGUgbmctbW9kZWw9XCJteURpc2NyZXRlVmFsdWVcIiBzdGVwPVwiMTBcIiBtaW49XCIxMFwiIG1heD1cIjEzMFwiPlxuICogPC9tZC1zbGlkZXI+XG4gKiA8L2hsanM+XG4gKlxuICogQHBhcmFtIHtib29sZWFuPX0gbWQtZGlzY3JldGUgV2hldGhlciB0byBlbmFibGUgZGlzY3JldGUgbW9kZS5cbiAqIEBwYXJhbSB7bnVtYmVyPX0gc3RlcCBUaGUgZGlzdGFuY2UgYmV0d2VlbiB2YWx1ZXMgdGhlIHVzZXIgaXMgYWxsb3dlZCB0byBwaWNrLiBEZWZhdWx0IDEuXG4gKiBAcGFyYW0ge251bWJlcj19IG1pbiBUaGUgbWluaW11bSB2YWx1ZSB0aGUgdXNlciBpcyBhbGxvd2VkIHRvIHBpY2suIERlZmF1bHQgMC5cbiAqIEBwYXJhbSB7bnVtYmVyPX0gbWF4IFRoZSBtYXhpbXVtIHZhbHVlIHRoZSB1c2VyIGlzIGFsbG93ZWQgdG8gcGljay4gRGVmYXVsdCAxMDAuXG4gKi9cbmZ1bmN0aW9uIFNsaWRlckRpcmVjdGl2ZSgkJHJBRiwgJHdpbmRvdywgJG1kQXJpYSwgJG1kVXRpbCwgJG1kQ29uc3RhbnQsICRtZFRoZW1pbmcsICRtZEdlc3R1cmUsICRwYXJzZSkge1xuICByZXR1cm4ge1xuICAgIHNjb3BlOiB7fSxcbiAgICByZXF1aXJlOiAnP25nTW9kZWwnLFxuICAgIHRlbXBsYXRlOlxuICAgICAgJzxkaXYgY2xhc3M9XCJtZC1zbGlkZXItd3JhcHBlclwiPlxcXG4gICAgICAgIDxkaXYgY2xhc3M9XCJtZC10cmFjay1jb250YWluZXJcIj5cXFxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZC10cmFja1wiPjwvZGl2PlxcXG4gICAgICAgICAgPGRpdiBjbGFzcz1cIm1kLXRyYWNrIG1kLXRyYWNrLWZpbGxcIj48L2Rpdj5cXFxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZC10cmFjay10aWNrc1wiPjwvZGl2PlxcXG4gICAgICAgIDwvZGl2PlxcXG4gICAgICAgIDxkaXYgY2xhc3M9XCJtZC10aHVtYi1jb250YWluZXJcIj5cXFxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZC10aHVtYlwiPjwvZGl2PlxcXG4gICAgICAgICAgPGRpdiBjbGFzcz1cIm1kLWZvY3VzLXRodW1iXCI+PC9kaXY+XFxcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwibWQtZm9jdXMtcmluZ1wiPjwvZGl2PlxcXG4gICAgICAgICAgPGRpdiBjbGFzcz1cIm1kLXNpZ25cIj5cXFxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJtZC10aHVtYi10ZXh0XCI+PC9zcGFuPlxcXG4gICAgICAgICAgPC9kaXY+XFxcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwibWQtZGlzYWJsZWQtdGh1bWJcIj48L2Rpdj5cXFxuICAgICAgICA8L2Rpdj5cXFxuICAgICAgPC9kaXY+JyxcbiAgICBjb21waWxlOiBjb21waWxlXG4gIH07XG5cbiAgLy8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAvLyBQcml2YXRlIE1ldGhvZHNcbiAgLy8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXG4gIGZ1bmN0aW9uIGNvbXBpbGUgKHRFbGVtZW50LCB0QXR0cnMpIHtcbiAgICB0RWxlbWVudC5hdHRyKHtcbiAgICAgIHRhYkluZGV4OiAwLFxuICAgICAgcm9sZTogJ3NsaWRlcidcbiAgICB9KTtcblxuICAgICRtZEFyaWEuZXhwZWN0KHRFbGVtZW50LCAnYXJpYS1sYWJlbCcpO1xuXG4gICAgcmV0dXJuIHBvc3RMaW5rO1xuICB9XG5cbiAgZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIG5nTW9kZWxDdHJsKSB7XG4gICAgJG1kVGhlbWluZyhlbGVtZW50KTtcbiAgICBuZ01vZGVsQ3RybCA9IG5nTW9kZWxDdHJsIHx8IHtcbiAgICAgIC8vIE1vY2sgbmdNb2RlbENvbnRyb2xsZXIgaWYgaXQgZG9lc24ndCBleGlzdCB0byBnaXZlIHVzXG4gICAgICAvLyB0aGUgbWluaW11bSBmdW5jdGlvbmFsaXR5IG5lZWRlZFxuICAgICAgJHNldFZpZXdWYWx1ZTogZnVuY3Rpb24odmFsKSB7XG4gICAgICAgIHRoaXMuJHZpZXdWYWx1ZSA9IHZhbDtcbiAgICAgICAgdGhpcy4kdmlld0NoYW5nZUxpc3RlbmVycy5mb3JFYWNoKGZ1bmN0aW9uKGNiKSB7IGNiKCk7IH0pO1xuICAgICAgfSxcbiAgICAgICRwYXJzZXJzOiBbXSxcbiAgICAgICRmb3JtYXR0ZXJzOiBbXSxcbiAgICAgICR2aWV3Q2hhbmdlTGlzdGVuZXJzOiBbXVxuICAgIH07XG5cbiAgICB2YXIgaXNEaXNhYmxlZFBhcnNlZCA9IGF0dHIubmdEaXNhYmxlZCAmJiAkcGFyc2UoYXR0ci5uZ0Rpc2FibGVkKTtcbiAgICB2YXIgaXNEaXNhYmxlZEdldHRlciA9IGlzRGlzYWJsZWRQYXJzZWQgP1xuICAgICAgZnVuY3Rpb24oKSB7IHJldHVybiBpc0Rpc2FibGVkUGFyc2VkKHNjb3BlLiRwYXJlbnQpOyB9IDpcbiAgICAgIGFuZ3VsYXIubm9vcDtcbiAgICB2YXIgdGh1bWIgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCcubWQtdGh1bWInKSk7XG4gICAgdmFyIHRodW1iVGV4dCA9IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJy5tZC10aHVtYi10ZXh0JykpO1xuICAgIHZhciB0aHVtYkNvbnRhaW5lciA9IHRodW1iLnBhcmVudCgpO1xuICAgIHZhciB0cmFja0NvbnRhaW5lciA9IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJy5tZC10cmFjay1jb250YWluZXInKSk7XG4gICAgdmFyIGFjdGl2ZVRyYWNrID0gYW5ndWxhci5lbGVtZW50KGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignLm1kLXRyYWNrLWZpbGwnKSk7XG4gICAgdmFyIHRpY2tDb250YWluZXIgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCcubWQtdHJhY2stdGlja3MnKSk7XG4gICAgdmFyIHRocm90dGxlZFJlZnJlc2hEaW1lbnNpb25zID0gJG1kVXRpbC50aHJvdHRsZShyZWZyZXNoU2xpZGVyRGltZW5zaW9ucywgNTAwMCk7XG5cbiAgICAvLyBEZWZhdWx0IHZhbHVlcywgb3ZlcnJpZGFibGUgYnkgYXR0cnNcbiAgICBhbmd1bGFyLmlzRGVmaW5lZChhdHRyLm1pbikgPyBhdHRyLiRvYnNlcnZlKCdtaW4nLCB1cGRhdGVNaW4pIDogdXBkYXRlTWluKDApO1xuICAgIGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHIubWF4KSA/IGF0dHIuJG9ic2VydmUoJ21heCcsIHVwZGF0ZU1heCkgOiB1cGRhdGVNYXgoMTAwKTtcbiAgICBhbmd1bGFyLmlzRGVmaW5lZChhdHRyLnN0ZXApPyBhdHRyLiRvYnNlcnZlKCdzdGVwJywgdXBkYXRlU3RlcCkgOiB1cGRhdGVTdGVwKDEpO1xuXG4gICAgLy8gV2UgaGF2ZSB0byBtYW51YWxseSBzdG9wIHRoZSAkd2F0Y2ggb24gbmdEaXNhYmxlZCBiZWNhdXNlIGl0IGV4aXN0c1xuICAgIC8vIG9uIHRoZSBwYXJlbnQgc2NvcGUsIGFuZCB3b24ndCBiZSBhdXRvbWF0aWNhbGx5IGRlc3Ryb3llZCB3aGVuXG4gICAgLy8gdGhlIGNvbXBvbmVudCBpcyBkZXN0cm95ZWQuXG4gICAgdmFyIHN0b3BEaXNhYmxlZFdhdGNoID0gYW5ndWxhci5ub29wO1xuICAgIGlmIChhdHRyLm5nRGlzYWJsZWQpIHtcbiAgICAgIHN0b3BEaXNhYmxlZFdhdGNoID0gc2NvcGUuJHBhcmVudC4kd2F0Y2goYXR0ci5uZ0Rpc2FibGVkLCB1cGRhdGVBcmlhRGlzYWJsZWQpO1xuICAgIH1cblxuICAgICRtZEdlc3R1cmUucmVnaXN0ZXIoZWxlbWVudCwgJ2RyYWcnKTtcblxuICAgIGVsZW1lbnRcbiAgICAgIC5vbigna2V5ZG93bicsIGtleWRvd25MaXN0ZW5lcilcbiAgICAgIC5vbignJG1kLnByZXNzZG93bicsIG9uUHJlc3NEb3duKVxuICAgICAgLm9uKCckbWQucHJlc3N1cCcsIG9uUHJlc3NVcClcbiAgICAgIC5vbignJG1kLmRyYWdzdGFydCcsIG9uRHJhZ1N0YXJ0KVxuICAgICAgLm9uKCckbWQuZHJhZycsIG9uRHJhZylcbiAgICAgIC5vbignJG1kLmRyYWdlbmQnLCBvbkRyYWdFbmQpO1xuXG4gICAgLy8gT24gcmVzaXplLCByZWNhbGN1bGF0ZSB0aGUgc2xpZGVyJ3MgZGltZW5zaW9ucyBhbmQgcmUtcmVuZGVyXG4gICAgZnVuY3Rpb24gdXBkYXRlQWxsKCkge1xuICAgICAgcmVmcmVzaFNsaWRlckRpbWVuc2lvbnMoKTtcbiAgICAgIG5nTW9kZWxSZW5kZXIoKTtcbiAgICAgIHJlZHJhd1RpY2tzKCk7XG4gICAgfVxuICAgIHNldFRpbWVvdXQodXBkYXRlQWxsKTtcblxuICAgIHZhciBkZWJvdW5jZWRVcGRhdGVBbGwgPSAkJHJBRi50aHJvdHRsZSh1cGRhdGVBbGwpO1xuICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vbigncmVzaXplJywgZGVib3VuY2VkVXBkYXRlQWxsKTtcblxuICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcbiAgICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vZmYoJ3Jlc2l6ZScsIGRlYm91bmNlZFVwZGF0ZUFsbCk7XG4gICAgICBzdG9wRGlzYWJsZWRXYXRjaCgpO1xuICAgIH0pO1xuXG4gICAgbmdNb2RlbEN0cmwuJHJlbmRlciA9IG5nTW9kZWxSZW5kZXI7XG4gICAgbmdNb2RlbEN0cmwuJHZpZXdDaGFuZ2VMaXN0ZW5lcnMucHVzaChuZ01vZGVsUmVuZGVyKTtcbiAgICBuZ01vZGVsQ3RybC4kZm9ybWF0dGVycy5wdXNoKG1pbk1heFZhbGlkYXRvcik7XG4gICAgbmdNb2RlbEN0cmwuJGZvcm1hdHRlcnMucHVzaChzdGVwVmFsaWRhdG9yKTtcblxuICAgIC8qKlxuICAgICAqIEF0dHJpYnV0ZXNcbiAgICAgKi9cbiAgICB2YXIgbWluO1xuICAgIHZhciBtYXg7XG4gICAgdmFyIHN0ZXA7XG4gICAgZnVuY3Rpb24gdXBkYXRlTWluKHZhbHVlKSB7XG4gICAgICBtaW4gPSBwYXJzZUZsb2F0KHZhbHVlKTtcbiAgICAgIGVsZW1lbnQuYXR0cignYXJpYS12YWx1ZW1pbicsIHZhbHVlKTtcbiAgICAgIHVwZGF0ZUFsbCgpO1xuICAgIH1cbiAgICBmdW5jdGlvbiB1cGRhdGVNYXgodmFsdWUpIHtcbiAgICAgIG1heCA9IHBhcnNlRmxvYXQodmFsdWUpO1xuICAgICAgZWxlbWVudC5hdHRyKCdhcmlhLXZhbHVlbWF4JywgdmFsdWUpO1xuICAgICAgdXBkYXRlQWxsKCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHVwZGF0ZVN0ZXAodmFsdWUpIHtcbiAgICAgIHN0ZXAgPSBwYXJzZUZsb2F0KHZhbHVlKTtcbiAgICAgIHJlZHJhd1RpY2tzKCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHVwZGF0ZUFyaWFEaXNhYmxlZChpc0Rpc2FibGVkKSB7XG4gICAgICBlbGVtZW50LmF0dHIoJ2FyaWEtZGlzYWJsZWQnLCAhIWlzRGlzYWJsZWQpO1xuICAgIH1cblxuICAgIC8vIERyYXcgdGhlIHRpY2tzIHdpdGggY2FudmFzLlxuICAgIC8vIFRoZSBhbHRlcm5hdGl2ZSB0byBkcmF3aW5nIHRpY2tzIHdpdGggY2FudmFzIGlzIHRvIGRyYXcgb25lIGVsZW1lbnQgZm9yIGVhY2ggdGljayxcbiAgICAvLyB3aGljaCBjb3VsZCBxdWlja2x5IGJlY29tZSBhIHBlcmZvcm1hbmNlIGJvdHRsZW5lY2suXG4gICAgdmFyIHRpY2tDYW52YXMsIHRpY2tDdHg7XG4gICAgZnVuY3Rpb24gcmVkcmF3VGlja3MoKSB7XG4gICAgICBpZiAoIWFuZ3VsYXIuaXNEZWZpbmVkKGF0dHIubWREaXNjcmV0ZSkpIHJldHVybjtcblxuICAgICAgdmFyIG51bVN0ZXBzID0gTWF0aC5mbG9vciggKG1heCAtIG1pbikgLyBzdGVwICk7XG4gICAgICBpZiAoIXRpY2tDYW52YXMpIHtcbiAgICAgICAgdmFyIHRyYWNrVGlja3NTdHlsZSA9ICR3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aWNrQ29udGFpbmVyWzBdKTtcbiAgICAgICAgdGlja0NhbnZhcyA9IGFuZ3VsYXIuZWxlbWVudCgnPGNhbnZhcyBzdHlsZT1cInBvc2l0aW9uOmFic29sdXRlO1wiPicpO1xuICAgICAgICB0aWNrQ3R4ID0gdGlja0NhbnZhc1swXS5nZXRDb250ZXh0KCcyZCcpO1xuICAgICAgICB0aWNrQ3R4LmZpbGxTdHlsZSA9IHRyYWNrVGlja3NTdHlsZS5iYWNrZ3JvdW5kQ29sb3IgfHwgJ2JsYWNrJztcbiAgICAgICAgdGlja0NvbnRhaW5lci5hcHBlbmQodGlja0NhbnZhcyk7XG4gICAgICB9XG4gICAgICB2YXIgZGltZW5zaW9ucyA9IGdldFNsaWRlckRpbWVuc2lvbnMoKTtcbiAgICAgIHRpY2tDYW52YXNbMF0ud2lkdGggPSBkaW1lbnNpb25zLndpZHRoO1xuICAgICAgdGlja0NhbnZhc1swXS5oZWlnaHQgPSBkaW1lbnNpb25zLmhlaWdodDtcblxuICAgICAgdmFyIGRpc3RhbmNlO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPD0gbnVtU3RlcHM7IGkrKykge1xuICAgICAgICBkaXN0YW5jZSA9IE1hdGguZmxvb3IoZGltZW5zaW9ucy53aWR0aCAqIChpIC8gbnVtU3RlcHMpKTtcbiAgICAgICAgdGlja0N0eC5maWxsUmVjdChkaXN0YW5jZSAtIDEsIDAsIDIsIGRpbWVuc2lvbnMuaGVpZ2h0KTtcbiAgICAgIH1cbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIFJlZnJlc2hpbmcgRGltZW5zaW9uc1xuICAgICAqL1xuICAgIHZhciBzbGlkZXJEaW1lbnNpb25zID0ge307XG4gICAgcmVmcmVzaFNsaWRlckRpbWVuc2lvbnMoKTtcbiAgICBmdW5jdGlvbiByZWZyZXNoU2xpZGVyRGltZW5zaW9ucygpIHtcbiAgICAgIHNsaWRlckRpbWVuc2lvbnMgPSB0cmFja0NvbnRhaW5lclswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ2V0U2xpZGVyRGltZW5zaW9ucygpIHtcbiAgICAgIHRocm90dGxlZFJlZnJlc2hEaW1lbnNpb25zKCk7XG4gICAgICByZXR1cm4gc2xpZGVyRGltZW5zaW9ucztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBsZWZ0L3JpZ2h0IGFycm93IGxpc3RlbmVyXG4gICAgICovXG4gICAgZnVuY3Rpb24ga2V5ZG93bkxpc3RlbmVyKGV2KSB7XG4gICAgICBpZihlbGVtZW50WzBdLmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBjaGFuZ2VBbW91bnQ7XG4gICAgICBpZiAoZXYua2V5Q29kZSA9PT0gJG1kQ29uc3RhbnQuS0VZX0NPREUuTEVGVF9BUlJPVykge1xuICAgICAgICBjaGFuZ2VBbW91bnQgPSAtc3RlcDtcbiAgICAgIH0gZWxzZSBpZiAoZXYua2V5Q29kZSA9PT0gJG1kQ29uc3RhbnQuS0VZX0NPREUuUklHSFRfQVJST1cpIHtcbiAgICAgICAgY2hhbmdlQW1vdW50ID0gc3RlcDtcbiAgICAgIH1cbiAgICAgIGlmIChjaGFuZ2VBbW91bnQpIHtcbiAgICAgICAgaWYgKGV2Lm1ldGFLZXkgfHwgZXYuY3RybEtleSB8fCBldi5hbHRLZXkpIHtcbiAgICAgICAgICBjaGFuZ2VBbW91bnQgKj0gNDtcbiAgICAgICAgfVxuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgc2NvcGUuJGV2YWxBc3luYyhmdW5jdGlvbigpIHtcbiAgICAgICAgICBzZXRNb2RlbFZhbHVlKG5nTW9kZWxDdHJsLiR2aWV3VmFsdWUgKyBjaGFuZ2VBbW91bnQpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBuZ01vZGVsIHNldHRlcnMgYW5kIHZhbGlkYXRvcnNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzZXRNb2RlbFZhbHVlKHZhbHVlKSB7XG4gICAgICBuZ01vZGVsQ3RybC4kc2V0Vmlld1ZhbHVlKCBtaW5NYXhWYWxpZGF0b3Ioc3RlcFZhbGlkYXRvcih2YWx1ZSkpICk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIG5nTW9kZWxSZW5kZXIoKSB7XG4gICAgICBpZiAoaXNOYU4obmdNb2RlbEN0cmwuJHZpZXdWYWx1ZSkpIHtcbiAgICAgICAgbmdNb2RlbEN0cmwuJHZpZXdWYWx1ZSA9IG5nTW9kZWxDdHJsLiRtb2RlbFZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgcGVyY2VudCA9IChuZ01vZGVsQ3RybC4kdmlld1ZhbHVlIC0gbWluKSAvIChtYXggLSBtaW4pO1xuICAgICAgc2NvcGUubW9kZWxWYWx1ZSA9IG5nTW9kZWxDdHJsLiR2aWV3VmFsdWU7XG4gICAgICBlbGVtZW50LmF0dHIoJ2FyaWEtdmFsdWVub3cnLCBuZ01vZGVsQ3RybC4kdmlld1ZhbHVlKTtcbiAgICAgIHNldFNsaWRlclBlcmNlbnQocGVyY2VudCk7XG4gICAgICB0aHVtYlRleHQudGV4dCggbmdNb2RlbEN0cmwuJHZpZXdWYWx1ZSApO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG1pbk1heFZhbGlkYXRvcih2YWx1ZSkge1xuICAgICAgaWYgKGFuZ3VsYXIuaXNOdW1iZXIodmFsdWUpKSB7XG4gICAgICAgIHJldHVybiBNYXRoLm1heChtaW4sIE1hdGgubWluKG1heCwgdmFsdWUpKTtcbiAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gc3RlcFZhbGlkYXRvcih2YWx1ZSkge1xuICAgICAgaWYgKGFuZ3VsYXIuaXNOdW1iZXIodmFsdWUpKSB7XG4gICAgICAgIHZhciBmb3JtYXR0ZWRWYWx1ZSA9IChNYXRoLnJvdW5kKHZhbHVlIC8gc3RlcCkgKiBzdGVwKTtcbiAgICAgICAgLy8gRm9ybWF0IHRvIDMgZGlnaXRzIGFmdGVyIHRoZSBkZWNpbWFsIHBvaW50IC0gZml4ZXMgIzIwMTUuXG4gICAgICAgIHJldHVybiAoTWF0aC5yb3VuZChmb3JtYXR0ZWRWYWx1ZSAqIDEwMDApIC8gMTAwMCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHBlcmNlbnQgMC0xXG4gICAgICovXG4gICAgZnVuY3Rpb24gc2V0U2xpZGVyUGVyY2VudChwZXJjZW50KSB7XG4gICAgICBhY3RpdmVUcmFjay5jc3MoJ3dpZHRoJywgKHBlcmNlbnQgKiAxMDApICsgJyUnKTtcbiAgICAgIHRodW1iQ29udGFpbmVyLmNzcyhcbiAgICAgICAgJ2xlZnQnLFxuICAgICAgICAocGVyY2VudCAqIDEwMCkgKyAnJSdcbiAgICAgICk7XG4gICAgICBlbGVtZW50LnRvZ2dsZUNsYXNzKCdtZC1taW4nLCBwZXJjZW50ID09PSAwKTtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIFNsaWRlIGxpc3RlbmVyc1xuICAgICAqL1xuICAgIHZhciBpc0RyYWdnaW5nID0gZmFsc2U7XG4gICAgdmFyIGlzRGlzY3JldGUgPSBhbmd1bGFyLmlzRGVmaW5lZChhdHRyLm1kRGlzY3JldGUpO1xuXG4gICAgZnVuY3Rpb24gb25QcmVzc0Rvd24oZXYpIHtcbiAgICAgIGlmIChpc0Rpc2FibGVkR2V0dGVyKCkpIHJldHVybjtcblxuICAgICAgZWxlbWVudC5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICBlbGVtZW50WzBdLmZvY3VzKCk7XG4gICAgICByZWZyZXNoU2xpZGVyRGltZW5zaW9ucygpO1xuXG4gICAgICB2YXIgZXhhY3RWYWwgPSBwZXJjZW50VG9WYWx1ZSggcG9zaXRpb25Ub1BlcmNlbnQoIGV2LnBvaW50ZXIueCApKTtcbiAgICAgIHZhciBjbG9zZXN0VmFsID0gbWluTWF4VmFsaWRhdG9yKCBzdGVwVmFsaWRhdG9yKGV4YWN0VmFsKSApO1xuICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xuICAgICAgICBzZXRNb2RlbFZhbHVlKCBjbG9zZXN0VmFsICk7XG4gICAgICAgIHNldFNsaWRlclBlcmNlbnQoIHZhbHVlVG9QZXJjZW50KGNsb3Nlc3RWYWwpKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiBvblByZXNzVXAoZXYpIHtcbiAgICAgIGlmIChpc0Rpc2FibGVkR2V0dGVyKCkpIHJldHVybjtcblxuICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcygnZHJhZ2dpbmcgYWN0aXZlJyk7XG5cbiAgICAgIHZhciBleGFjdFZhbCA9IHBlcmNlbnRUb1ZhbHVlKCBwb3NpdGlvblRvUGVyY2VudCggZXYucG9pbnRlci54ICkpO1xuICAgICAgdmFyIGNsb3Nlc3RWYWwgPSBtaW5NYXhWYWxpZGF0b3IoIHN0ZXBWYWxpZGF0b3IoZXhhY3RWYWwpICk7XG4gICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG4gICAgICAgIHNldE1vZGVsVmFsdWUoY2xvc2VzdFZhbCk7XG4gICAgICAgIG5nTW9kZWxSZW5kZXIoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiBvbkRyYWdTdGFydChldikge1xuICAgICAgaWYgKGlzRGlzYWJsZWRHZXR0ZXIoKSkgcmV0dXJuO1xuICAgICAgaXNEcmFnZ2luZyA9IHRydWU7XG4gICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgZWxlbWVudC5hZGRDbGFzcygnZHJhZ2dpbmcnKTtcbiAgICAgIHNldFNsaWRlckZyb21FdmVudChldik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIG9uRHJhZyhldikge1xuICAgICAgaWYgKCFpc0RyYWdnaW5nKSByZXR1cm47XG4gICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIHNldFNsaWRlckZyb21FdmVudChldik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIG9uRHJhZ0VuZChldikge1xuICAgICAgaWYgKCFpc0RyYWdnaW5nKSByZXR1cm47XG4gICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIGlzRHJhZ2dpbmcgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRTbGlkZXJGcm9tRXZlbnQoZXYpIHtcbiAgICAgIC8vIFdoaWxlIHBhbm5pbmcgZGlzY3JldGUsIHVwZGF0ZSBvbmx5IHRoZVxuICAgICAgLy8gdmlzdWFsIHBvc2l0aW9uaW5nIGJ1dCBub3QgdGhlIG1vZGVsIHZhbHVlLlxuICAgICAgaWYgKCBpc0Rpc2NyZXRlICkgYWRqdXN0VGh1bWJQb3NpdGlvbiggZXYucG9pbnRlci54ICk7XG4gICAgICBlbHNlICAgICAgICAgICAgICBkb1NsaWRlKCBldi5wb2ludGVyLnggKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTbGlkZSB0aGUgVUkgYnkgY2hhbmdpbmcgdGhlIG1vZGVsIHZhbHVlXG4gICAgICogQHBhcmFtIHhcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBkb1NsaWRlKCB4ICkge1xuICAgICAgc2NvcGUuJGV2YWxBc3luYyggZnVuY3Rpb24oKSB7XG4gICAgICAgIHNldE1vZGVsVmFsdWUoIHBlcmNlbnRUb1ZhbHVlKCBwb3NpdGlvblRvUGVyY2VudCh4KSApKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNsaWRlIHRoZSBVSSB3aXRob3V0IGNoYW5naW5nIHRoZSBtb2RlbCAod2hpbGUgZHJhZ2dpbmcvcGFubmluZylcbiAgICAgKiBAcGFyYW0geFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFkanVzdFRodW1iUG9zaXRpb24oIHggKSB7XG4gICAgICB2YXIgZXhhY3RWYWwgPSBwZXJjZW50VG9WYWx1ZSggcG9zaXRpb25Ub1BlcmNlbnQoIHggKSk7XG4gICAgICB2YXIgY2xvc2VzdFZhbCA9IG1pbk1heFZhbGlkYXRvciggc3RlcFZhbGlkYXRvcihleGFjdFZhbCkgKTtcbiAgICAgIHNldFNsaWRlclBlcmNlbnQoIHBvc2l0aW9uVG9QZXJjZW50KHgpICk7XG4gICAgICB0aHVtYlRleHQudGV4dCggY2xvc2VzdFZhbCApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbnZlcnQgaG9yaXpvbnRhbCBwb3NpdGlvbiBvbiBzbGlkZXIgdG8gcGVyY2VudGFnZSB2YWx1ZSBvZiBvZmZzZXQgZnJvbSBiZWdpbm5pbmcuLi5cbiAgICAgKiBAcGFyYW0geFxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9XG4gICAgICovXG4gICAgZnVuY3Rpb24gcG9zaXRpb25Ub1BlcmNlbnQoIHggKSB7XG4gICAgICByZXR1cm4gTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgKHggLSBzbGlkZXJEaW1lbnNpb25zLmxlZnQpIC8gKHNsaWRlckRpbWVuc2lvbnMud2lkdGgpKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29udmVydCBwZXJjZW50YWdlIG9mZnNldCBvbiBzbGlkZSB0byBlcXVpdmFsZW50IG1vZGVsIHZhbHVlXG4gICAgICogQHBhcmFtIHBlcmNlbnRcbiAgICAgKiBAcmV0dXJucyB7Kn1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBwZXJjZW50VG9WYWx1ZSggcGVyY2VudCApIHtcbiAgICAgIHJldHVybiAobWluICsgcGVyY2VudCAqIChtYXggLSBtaW4pKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB2YWx1ZVRvUGVyY2VudCggdmFsICkge1xuICAgICAgcmV0dXJuICh2YWwgLSBtaW4pLyhtYXggLSBtaW4pO1xuICAgIH1cbiAgfVxufVxuU2xpZGVyRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkJHJBRlwiLCBcIiR3aW5kb3dcIiwgXCIkbWRBcmlhXCIsIFwiJG1kVXRpbFwiLCBcIiRtZENvbnN0YW50XCIsIFwiJG1kVGhlbWluZ1wiLCBcIiRtZEdlc3R1cmVcIiwgXCIkcGFyc2VcIl07XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG4vKlxuICogQG5nZG9jIG1vZHVsZVxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5zdGlja3lcbiAqIEBkZXNjcmlwdGlvblxuICpcbiAqIFN0aWNreSBlZmZlY3RzIGZvciBtZFxuICovXG5cbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnN0aWNreScsIFtcbiAgJ21hdGVyaWFsLmNvcmUnLFxuICAnbWF0ZXJpYWwuY29tcG9uZW50cy5jb250ZW50J1xuXSlcbiAgLmZhY3RvcnkoJyRtZFN0aWNreScsIE1kU3RpY2t5KTtcblxuLypcbiAqIEBuZ2RvYyBzZXJ2aWNlXG4gKiBAbmFtZSAkbWRTdGlja3lcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5zdGlja3lcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFRoZSBgJG1kU3RpY2t5YHNlcnZpY2UgcHJvdmlkZXMgYSBtaXhpbiB0byBtYWtlIGVsZW1lbnRzIHN0aWNreS5cbiAqXG4gKiBAcmV0dXJucyBBIGAkbWRTdGlja3lgIGZ1bmN0aW9uIHRoYXQgdGFrZXMgdGhyZWUgYXJndW1lbnRzOlxuICogICAtIGBzY29wZWBcbiAqICAgLSBgZWxlbWVudGA6IFRoZSBlbGVtZW50IHRoYXQgd2lsbCBiZSAnc3RpY2t5J1xuICogICAtIGBlbGVtZW50Q2xvbmVgOiBBIGNsb25lIG9mIHRoZSBlbGVtZW50LCB0aGF0IHdpbGwgYmUgc2hvd25cbiAqICAgICB3aGVuIHRoZSB1c2VyIHN0YXJ0cyBzY3JvbGxpbmcgcGFzdCB0aGUgb3JpZ2luYWwgZWxlbWVudC5cbiAqICAgICBJZiBub3QgcHJvdmlkZWQsIGl0IHdpbGwgdXNlIHRoZSByZXN1bHQgb2YgYGVsZW1lbnQuY2xvbmUoKWAuXG4gKi9cblxuZnVuY3Rpb24gTWRTdGlja3koJGRvY3VtZW50LCAkbWRDb25zdGFudCwgJGNvbXBpbGUsICQkckFGLCAkbWRVdGlsKSB7XG5cbiAgdmFyIGJyb3dzZXJTdGlja3lTdXBwb3J0ID0gY2hlY2tTdGlja3lTdXBwb3J0KCk7XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVycyBhbiBlbGVtZW50IGFzIHN0aWNreSwgdXNlZCBpbnRlcm5hbGx5IGJ5IGRpcmVjdGl2ZXMgdG8gcmVnaXN0ZXIgdGhlbXNlbHZlc1xuICAgKi9cbiAgcmV0dXJuIGZ1bmN0aW9uIHJlZ2lzdGVyU3RpY2t5RWxlbWVudChzY29wZSwgZWxlbWVudCwgc3RpY2t5Q2xvbmUpIHtcbiAgICB2YXIgY29udGVudEN0cmwgPSBlbGVtZW50LmNvbnRyb2xsZXIoJ21kQ29udGVudCcpO1xuICAgIGlmICghY29udGVudEN0cmwpIHJldHVybjtcblxuICAgIGlmIChicm93c2VyU3RpY2t5U3VwcG9ydCkge1xuICAgICAgZWxlbWVudC5jc3Moe1xuICAgICAgICBwb3NpdGlvbjogYnJvd3NlclN0aWNreVN1cHBvcnQsXG4gICAgICAgIHRvcDogMCxcbiAgICAgICAgJ3otaW5kZXgnOiAyXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyICQkc3RpY2t5ID0gY29udGVudEN0cmwuJGVsZW1lbnQuZGF0YSgnJCRzdGlja3knKTtcbiAgICAgIGlmICghJCRzdGlja3kpIHtcbiAgICAgICAgJCRzdGlja3kgPSBzZXR1cFN0aWNreShjb250ZW50Q3RybCk7XG4gICAgICAgIGNvbnRlbnRDdHJsLiRlbGVtZW50LmRhdGEoJyQkc3RpY2t5JywgJCRzdGlja3kpO1xuICAgICAgfVxuXG4gICAgICB2YXIgZGVyZWdpc3RlciA9ICQkc3RpY2t5LmFkZChlbGVtZW50LCBzdGlja3lDbG9uZSB8fCBlbGVtZW50LmNsb25lKCkpO1xuICAgICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGRlcmVnaXN0ZXIpO1xuICAgIH1cbiAgfTtcblxuICBmdW5jdGlvbiBzZXR1cFN0aWNreShjb250ZW50Q3RybCkge1xuICAgIHZhciBjb250ZW50RWwgPSBjb250ZW50Q3RybC4kZWxlbWVudDtcblxuICAgIC8vIFJlZnJlc2ggZWxlbWVudHMgaXMgdmVyeSBleHBlbnNpdmUsIHNvIHdlIHVzZSB0aGUgZGVib3VuY2VkXG4gICAgLy8gdmVyc2lvbiB3aGVuIHBvc3NpYmxlLlxuICAgIHZhciBkZWJvdW5jZWRSZWZyZXNoRWxlbWVudHMgPSAkJHJBRi50aHJvdHRsZShyZWZyZXNoRWxlbWVudHMpO1xuXG4gICAgLy8gc2V0dXBBdWdtZW50ZWRTY3JvbGxFdmVudHMgZ2l2ZXMgdXMgYCRzY3JvbGxzdGFydGAgYW5kIGAkc2Nyb2xsYCxcbiAgICAvLyBtb3JlIHJlbGlhYmxlIHRoYW4gYHNjcm9sbGAgb24gYW5kcm9pZC5cbiAgICBzZXR1cEF1Z21lbnRlZFNjcm9sbEV2ZW50cyhjb250ZW50RWwpO1xuICAgIGNvbnRlbnRFbC5vbignJHNjcm9sbHN0YXJ0JywgZGVib3VuY2VkUmVmcmVzaEVsZW1lbnRzKTtcbiAgICBjb250ZW50RWwub24oJyRzY3JvbGwnLCBvblNjcm9sbCk7XG5cbiAgICB2YXIgc2VsZjtcbiAgICB2YXIgc3RpY2t5QmFzZW9mZnNldCA9IGNvbnRlbnRFbC5wcm9wKCdvZmZzZXRUb3AnKTtcbiAgICByZXR1cm4gc2VsZiA9IHtcbiAgICAgIHByZXY6IG51bGwsXG4gICAgICBjdXJyZW50OiBudWxsLCAvL3RoZSBjdXJyZW50bHkgc3RpY2tpZWQgaXRlbVxuICAgICAgbmV4dDogbnVsbCxcbiAgICAgIGl0ZW1zOiBbXSxcbiAgICAgIGFkZDogYWRkLFxuICAgICAgcmVmcmVzaEVsZW1lbnRzOiByZWZyZXNoRWxlbWVudHNcbiAgICB9O1xuXG4gICAgLyoqKioqKioqKioqKioqKlxuICAgICAqIFB1YmxpY1xuICAgICAqKioqKioqKioqKioqKiovXG4gICAgLy8gQWRkIGFuIGVsZW1lbnQgYW5kIGl0cyBzdGlja3kgY2xvbmUgdG8gdGhpcyBjb250ZW50J3Mgc3RpY2t5IGNvbGxlY3Rpb25cbiAgICBmdW5jdGlvbiBhZGQoZWxlbWVudCwgc3RpY2t5Q2xvbmUpIHtcbiAgICAgIHN0aWNreUNsb25lLmFkZENsYXNzKCdtZC1zdGlja3ktY2xvbmUnKTtcbiAgICAgIHN0aWNreUNsb25lLmNzcygndG9wJywgc3RpY2t5QmFzZW9mZnNldCArICdweCcpO1xuXG4gICAgICB2YXIgaXRlbSA9IHtcbiAgICAgICAgZWxlbWVudDogZWxlbWVudCxcbiAgICAgICAgY2xvbmU6IHN0aWNreUNsb25lXG4gICAgICB9O1xuICAgICAgc2VsZi5pdGVtcy5wdXNoKGl0ZW0pO1xuXG4gICAgICBjb250ZW50RWwucGFyZW50KCkucHJlcGVuZChpdGVtLmNsb25lKTtcblxuICAgICAgZGVib3VuY2VkUmVmcmVzaEVsZW1lbnRzKCk7XG5cbiAgICAgIHJldHVybiBmdW5jdGlvbiByZW1vdmUoKSB7XG4gICAgICAgIHNlbGYuaXRlbXMuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuICAgICAgICAgIGlmIChpdGVtLmVsZW1lbnRbMF0gPT09IGVsZW1lbnRbMF0pIHtcbiAgICAgICAgICAgIHNlbGYuaXRlbXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIGl0ZW0uY2xvbmUucmVtb3ZlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgZGVib3VuY2VkUmVmcmVzaEVsZW1lbnRzKCk7XG4gICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlZnJlc2hFbGVtZW50cygpIHtcbiAgICAgIC8vIFNvcnQgb3VyIGNvbGxlY3Rpb24gb2YgZWxlbWVudHMgYnkgdGhlaXIgY3VycmVudCBwb3NpdGlvbiBpbiB0aGUgRE9NLlxuICAgICAgLy8gV2UgbmVlZCB0byBkbyB0aGlzIGJlY2F1c2Ugb3VyIGVsZW1lbnRzJyBvcmRlciBvZiBiZWluZyBhZGRlZCBtYXkgbm90XG4gICAgICAvLyBiZSB0aGUgc2FtZSBhcyB0aGVpciBvcmRlciBvZiBkaXNwbGF5LlxuICAgICAgc2VsZi5pdGVtcy5mb3JFYWNoKHJlZnJlc2hQb3NpdGlvbik7XG4gICAgICBzZWxmLml0ZW1zID0gc2VsZi5pdGVtcy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIGEudG9wIDwgYi50b3AgPyAtMSA6IDE7XG4gICAgICB9KTtcblxuICAgICAgLy8gRmluZCB3aGljaCBpdGVtIGluIHRoZSBsaXN0IHNob3VsZCBiZSBhY3RpdmUsIFxuICAgICAgLy8gYmFzZWQgdXBvbiB0aGUgY29udGVudCdzIGN1cnJlbnQgc2Nyb2xsIHBvc2l0aW9uXG4gICAgICB2YXIgaXRlbTtcbiAgICAgIHZhciBjdXJyZW50U2Nyb2xsVG9wID0gY29udGVudEVsLnByb3AoJ3Njcm9sbFRvcCcpO1xuICAgICAgZm9yICh2YXIgaSA9IHNlbGYuaXRlbXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgaWYgKGN1cnJlbnRTY3JvbGxUb3AgPiBzZWxmLml0ZW1zW2ldLnRvcCkge1xuICAgICAgICAgIGl0ZW0gPSBzZWxmLml0ZW1zW2ldO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBzZXRDdXJyZW50SXRlbShpdGVtKTtcbiAgICB9XG5cblxuICAgIC8qKioqKioqKioqKioqKipcbiAgICAgKiBQcml2YXRlXG4gICAgICoqKioqKioqKioqKioqKi9cblxuICAgIC8vIEZpbmQgdGhlIGB0b3BgIG9mIGFuIGl0ZW0gcmVsYXRpdmUgdG8gdGhlIGNvbnRlbnQgZWxlbWVudCxcbiAgICAvLyBhbmQgYWxzbyB0aGUgaGVpZ2h0LlxuICAgIGZ1bmN0aW9uIHJlZnJlc2hQb3NpdGlvbihpdGVtKSB7XG4gICAgICAvLyBGaW5kIHRoZSB0b3Agb2YgYW4gaXRlbSBieSBhZGRpbmcgdG8gdGhlIG9mZnNldEhlaWdodCB1bnRpbCB3ZSByZWFjaCB0aGUgXG4gICAgICAvLyBjb250ZW50IGVsZW1lbnQuXG4gICAgICB2YXIgY3VycmVudCA9IGl0ZW0uZWxlbWVudFswXTtcbiAgICAgIGl0ZW0udG9wID0gMDtcbiAgICAgIGl0ZW0ubGVmdCA9IDA7XG4gICAgICB3aGlsZSAoY3VycmVudCAmJiBjdXJyZW50ICE9PSBjb250ZW50RWxbMF0pIHtcbiAgICAgICAgaXRlbS50b3AgKz0gY3VycmVudC5vZmZzZXRUb3A7XG4gICAgICAgIGl0ZW0ubGVmdCArPSBjdXJyZW50Lm9mZnNldExlZnQ7XG4gICAgICAgIGN1cnJlbnQgPSBjdXJyZW50Lm9mZnNldFBhcmVudDtcbiAgICAgIH1cbiAgICAgIGl0ZW0uaGVpZ2h0ID0gaXRlbS5lbGVtZW50LnByb3AoJ29mZnNldEhlaWdodCcpO1xuICAgICAgaXRlbS5jbG9uZS5jc3MoJ21hcmdpbi1sZWZ0JywgaXRlbS5sZWZ0ICsgJ3B4Jyk7XG4gICAgICBpZiAoJG1kVXRpbC5mbG9hdGluZ1Njcm9sbGJhcnMoKSkge1xuICAgICAgICBpdGVtLmNsb25lLmNzcygnbWFyZ2luLXJpZ2h0JywgJzAnKTtcbiAgICAgIH1cbiAgICB9XG5cblxuICAgIC8vIEFzIHdlIHNjcm9sbCwgcHVzaCBpbiBhbmQgc2VsZWN0IHRoZSBjb3JyZWN0IHN0aWNreSBlbGVtZW50LlxuICAgIGZ1bmN0aW9uIG9uU2Nyb2xsKCkge1xuICAgICAgdmFyIHNjcm9sbFRvcCA9IGNvbnRlbnRFbC5wcm9wKCdzY3JvbGxUb3AnKTtcbiAgICAgIHZhciBpc1Njcm9sbGluZ0Rvd24gPSBzY3JvbGxUb3AgPiAob25TY3JvbGwucHJldlNjcm9sbFRvcCB8fCAwKTtcbiAgICAgIG9uU2Nyb2xsLnByZXZTY3JvbGxUb3AgPSBzY3JvbGxUb3A7XG5cbiAgICAgIC8vIEF0IHRoZSB0b3A/XG4gICAgICBpZiAoc2Nyb2xsVG9wID09PSAwKSB7XG4gICAgICAgIHNldEN1cnJlbnRJdGVtKG51bGwpO1xuXG4gICAgICAvLyBHb2luZyB0byBuZXh0IGl0ZW0/XG4gICAgICB9IGVsc2UgaWYgKGlzU2Nyb2xsaW5nRG93biAmJiBzZWxmLm5leHQpIHtcbiAgICAgICAgaWYgKHNlbGYubmV4dC50b3AgLSBzY3JvbGxUb3AgPD0gMCkge1xuICAgICAgICAgIC8vIFN0aWNreSB0aGUgbmV4dCBpdGVtIGlmIHdlJ3ZlIHNjcm9sbGVkIHBhc3QgaXRzIHBvc2l0aW9uLlxuICAgICAgICAgIHNldEN1cnJlbnRJdGVtKHNlbGYubmV4dCk7XG4gICAgICAgIH0gZWxzZSBpZiAoc2VsZi5jdXJyZW50KSB7XG4gICAgICAgICAgLy8gUHVzaCB0aGUgY3VycmVudCBpdGVtIHVwIHdoZW4gd2UncmUgYWxtb3N0IGF0IHRoZSBuZXh0IGl0ZW0uXG4gICAgICAgICAgaWYgKHNlbGYubmV4dC50b3AgLSBzY3JvbGxUb3AgPD0gc2VsZi5uZXh0LmhlaWdodCkge1xuICAgICAgICAgICAgdHJhbnNsYXRlKHNlbGYuY3VycmVudCwgc2VsZi5uZXh0LnRvcCAtIHNlbGYubmV4dC5oZWlnaHQgLSBzY3JvbGxUb3ApO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0cmFuc2xhdGUoc2VsZi5jdXJyZW50LCBudWxsKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAvLyBTY3JvbGxpbmcgdXAgd2l0aCBhIGN1cnJlbnQgc3RpY2t5IGl0ZW0/XG4gICAgICB9IGVsc2UgaWYgKCFpc1Njcm9sbGluZ0Rvd24gJiYgc2VsZi5jdXJyZW50KSB7XG4gICAgICAgIGlmIChzY3JvbGxUb3AgPCBzZWxmLmN1cnJlbnQudG9wKSB7XG4gICAgICAgICAgLy8gU3RpY2t5IHRoZSBwcmV2aW91cyBpdGVtIGlmIHdlJ3ZlIHNjcm9sbGVkIHVwIHBhc3RcbiAgICAgICAgICAvLyB0aGUgb3JpZ2luYWwgcG9zaXRpb24gb2YgdGhlIGN1cnJlbnRseSBzdGlja2llZCBpdGVtLlxuICAgICAgICAgIHNldEN1cnJlbnRJdGVtKHNlbGYucHJldik7XG4gICAgICAgIH1cbiAgICAgICAgLy8gU2Nyb2xsaW5nIHVwLCBhbmQganVzdCBidW1waW5nIGludG8gdGhlIGl0ZW0gYWJvdmUgKGp1c3Qgc2V0IHRvIGN1cnJlbnQpP1xuICAgICAgICAvLyBJZiB3ZSBoYXZlIGEgbmV4dCBpdGVtIGJ1bXBpbmcgaW50byB0aGUgY3VycmVudCBpdGVtLCB0cmFuc2xhdGVcbiAgICAgICAgLy8gdGhlIGN1cnJlbnQgaXRlbSB1cCBmcm9tIHRoZSB0b3AgYXMgaXQgc2Nyb2xscyBpbnRvIHZpZXcuXG4gICAgICAgIGlmIChzZWxmLmN1cnJlbnQgJiYgc2VsZi5uZXh0KSB7XG4gICAgICAgICAgaWYgKHNjcm9sbFRvcCA+PSBzZWxmLm5leHQudG9wIC0gc2VsZi5jdXJyZW50LmhlaWdodCkge1xuICAgICAgICAgICAgdHJhbnNsYXRlKHNlbGYuY3VycmVudCwgc2VsZi5uZXh0LnRvcCAtIHNjcm9sbFRvcCAtIHNlbGYuY3VycmVudC5oZWlnaHQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0cmFuc2xhdGUoc2VsZi5jdXJyZW50LCBudWxsKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgIFxuICAgZnVuY3Rpb24gc2V0Q3VycmVudEl0ZW0oaXRlbSkge1xuICAgICBpZiAoc2VsZi5jdXJyZW50ID09PSBpdGVtKSByZXR1cm47XG4gICAgIC8vIERlYWN0aXZhdGUgY3VycmVudGx5IGFjdGl2ZSBpdGVtXG4gICAgIGlmIChzZWxmLmN1cnJlbnQpIHtcbiAgICAgICB0cmFuc2xhdGUoc2VsZi5jdXJyZW50LCBudWxsKTtcbiAgICAgICBzZXRTdGlja3lTdGF0ZShzZWxmLmN1cnJlbnQsIG51bGwpO1xuICAgICB9XG5cbiAgICAgLy8gQWN0aXZhdGUgbmV3IGl0ZW0gaWYgZ2l2ZW5cbiAgICAgaWYgKGl0ZW0pIHtcbiAgICAgICBzZXRTdGlja3lTdGF0ZShpdGVtLCAnYWN0aXZlJyk7XG4gICAgIH1cblxuICAgICBzZWxmLmN1cnJlbnQgPSBpdGVtO1xuICAgICB2YXIgaW5kZXggPSBzZWxmLml0ZW1zLmluZGV4T2YoaXRlbSk7XG4gICAgIC8vIElmIGluZGV4ID09PSAtMSwgaW5kZXggKyAxID0gMC4gSXQgd29ya3Mgb3V0LlxuICAgICBzZWxmLm5leHQgPSBzZWxmLml0ZW1zW2luZGV4ICsgMV07XG4gICAgIHNlbGYucHJldiA9IHNlbGYuaXRlbXNbaW5kZXggLSAxXTtcbiAgICAgc2V0U3RpY2t5U3RhdGUoc2VsZi5uZXh0LCAnbmV4dCcpO1xuICAgICBzZXRTdGlja3lTdGF0ZShzZWxmLnByZXYsICdwcmV2Jyk7XG4gICB9XG5cbiAgIGZ1bmN0aW9uIHNldFN0aWNreVN0YXRlKGl0ZW0sIHN0YXRlKSB7XG4gICAgIGlmICghaXRlbSB8fCBpdGVtLnN0YXRlID09PSBzdGF0ZSkgcmV0dXJuO1xuICAgICBpZiAoaXRlbS5zdGF0ZSkge1xuICAgICAgIGl0ZW0uY2xvbmUuYXR0cignc3RpY2t5LXByZXYtc3RhdGUnLCBpdGVtLnN0YXRlKTtcbiAgICAgICBpdGVtLmVsZW1lbnQuYXR0cignc3RpY2t5LXByZXYtc3RhdGUnLCBpdGVtLnN0YXRlKTtcbiAgICAgfVxuICAgICBpdGVtLmNsb25lLmF0dHIoJ3N0aWNreS1zdGF0ZScsIHN0YXRlKTtcbiAgICAgaXRlbS5lbGVtZW50LmF0dHIoJ3N0aWNreS1zdGF0ZScsIHN0YXRlKTtcbiAgICAgaXRlbS5zdGF0ZSA9IHN0YXRlO1xuICAgfVxuXG4gICBmdW5jdGlvbiB0cmFuc2xhdGUoaXRlbSwgYW1vdW50KSB7XG4gICAgIGlmICghaXRlbSkgcmV0dXJuO1xuICAgICBpZiAoYW1vdW50ID09PSBudWxsIHx8IGFtb3VudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgaWYgKGl0ZW0udHJhbnNsYXRlWSkge1xuICAgICAgICAgaXRlbS50cmFuc2xhdGVZID0gbnVsbDtcbiAgICAgICAgIGl0ZW0uY2xvbmUuY3NzKCRtZENvbnN0YW50LkNTUy5UUkFOU0ZPUk0sICcnKTtcbiAgICAgICB9XG4gICAgIH0gZWxzZSB7XG4gICAgICAgaXRlbS50cmFuc2xhdGVZID0gYW1vdW50O1xuICAgICAgIGl0ZW0uY2xvbmUuY3NzKFxuICAgICAgICAgJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STSwgXG4gICAgICAgICAndHJhbnNsYXRlM2QoJyArIGl0ZW0ubGVmdCArICdweCwnICsgYW1vdW50ICsgJ3B4LDApJ1xuICAgICAgICk7XG4gICAgIH1cbiAgIH1cbiAgfVxuXG4gIC8vIEZ1bmN0aW9uIHRvIGNoZWNrIGZvciBicm93c2VyIHN0aWNreSBzdXBwb3J0XG4gIGZ1bmN0aW9uIGNoZWNrU3RpY2t5U3VwcG9ydCgkZWwpIHtcbiAgICB2YXIgc3RpY2t5UHJvcDtcbiAgICB2YXIgdGVzdEVsID0gYW5ndWxhci5lbGVtZW50KCc8ZGl2PicpO1xuICAgICRkb2N1bWVudFswXS5ib2R5LmFwcGVuZENoaWxkKHRlc3RFbFswXSk7XG5cbiAgICB2YXIgc3RpY2t5UHJvcHMgPSBbJ3N0aWNreScsICctd2Via2l0LXN0aWNreSddO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RpY2t5UHJvcHMubGVuZ3RoOyArK2kpIHtcbiAgICAgIHRlc3RFbC5jc3Moe3Bvc2l0aW9uOiBzdGlja3lQcm9wc1tpXSwgdG9wOiAwLCAnei1pbmRleCc6IDJ9KTtcbiAgICAgIGlmICh0ZXN0RWwuY3NzKCdwb3NpdGlvbicpID09IHN0aWNreVByb3BzW2ldKSB7XG4gICAgICAgIHN0aWNreVByb3AgPSBzdGlja3lQcm9wc1tpXTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIHRlc3RFbC5yZW1vdmUoKTtcbiAgICByZXR1cm4gc3RpY2t5UHJvcDtcbiAgfVxuXG4gIC8vIEFuZHJvaWQgNC40IGRvbid0IGFjY3VyYXRlbHkgZ2l2ZSBzY3JvbGwgZXZlbnRzLlxuICAvLyBUbyBmaXggdGhpcyBwcm9ibGVtLCB3ZSBzZXR1cCBhIGZha2Ugc2Nyb2xsIGV2ZW50LiBXZSBzYXk6XG4gIC8vID4gSWYgYSBzY3JvbGwgb3IgdG91Y2htb3ZlIGV2ZW50IGhhcyBoYXBwZW5lZCBpbiB0aGUgbGFzdCBERUxBWSBtaWxsaXNlY29uZHMsIFxuICAvLyAgIHRoZW4gc2VuZCBhIGAkc2Nyb2xsYCBldmVudCBldmVyeSBhbmltYXRpb25GcmFtZS5cbiAgLy8gQWRkaXRpb25hbGx5LCB3ZSBhZGQgJHNjcm9sbHN0YXJ0IGFuZCAkc2Nyb2xsZW5kIGV2ZW50cy5cbiAgZnVuY3Rpb24gc2V0dXBBdWdtZW50ZWRTY3JvbGxFdmVudHMoZWxlbWVudCkge1xuICAgIHZhciBTQ1JPTExfRU5EX0RFTEFZID0gMjAwO1xuICAgIHZhciBpc1Njcm9sbGluZztcbiAgICB2YXIgbGFzdFNjcm9sbFRpbWU7XG4gICAgZWxlbWVudC5vbignc2Nyb2xsIHRvdWNobW92ZScsIGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCFpc1Njcm9sbGluZykge1xuICAgICAgICBpc1Njcm9sbGluZyA9IHRydWU7XG4gICAgICAgICQkckFGKGxvb3BTY3JvbGxFdmVudCk7XG4gICAgICAgIGVsZW1lbnQudHJpZ2dlckhhbmRsZXIoJyRzY3JvbGxzdGFydCcpO1xuICAgICAgfVxuICAgICAgZWxlbWVudC50cmlnZ2VySGFuZGxlcignJHNjcm9sbCcpO1xuICAgICAgbGFzdFNjcm9sbFRpbWUgPSArJG1kVXRpbC5ub3coKTtcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIGxvb3BTY3JvbGxFdmVudCgpIHtcbiAgICAgIGlmICgrJG1kVXRpbC5ub3coKSAtIGxhc3RTY3JvbGxUaW1lID4gU0NST0xMX0VORF9ERUxBWSkge1xuICAgICAgICBpc1Njcm9sbGluZyA9IGZhbHNlO1xuICAgICAgICBlbGVtZW50LnRyaWdnZXJIYW5kbGVyKCckc2Nyb2xsZW5kJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBlbGVtZW50LnRyaWdnZXJIYW5kbGVyKCckc2Nyb2xsJyk7XG4gICAgICAgICQkckFGKGxvb3BTY3JvbGxFdmVudCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbn1cbk1kU3RpY2t5LiRpbmplY3QgPSBbXCIkZG9jdW1lbnRcIiwgXCIkbWRDb25zdGFudFwiLCBcIiRjb21waWxlXCIsIFwiJCRyQUZcIiwgXCIkbWRVdGlsXCJdO1xuXG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBAbmdkb2MgbW9kdWxlXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLnN1YmhlYWRlclxuICogQGRlc2NyaXB0aW9uXG4gKiBTdWJIZWFkZXIgbW9kdWxlXG4gKlxuICogIFN1YmhlYWRlcnMgYXJlIHNwZWNpYWwgbGlzdCB0aWxlcyB0aGF0IGRlbGluZWF0ZSBkaXN0aW5jdCBzZWN0aW9ucyBvZiBhXG4gKiAgbGlzdCBvciBncmlkIGxpc3QgYW5kIGFyZSB0eXBpY2FsbHkgcmVsYXRlZCB0byB0aGUgY3VycmVudCBmaWx0ZXJpbmcgb3JcbiAqICBzb3J0aW5nIGNyaXRlcmlhLiBTdWJoZWFkZXIgdGlsZXMgYXJlIGVpdGhlciBkaXNwbGF5ZWQgaW5saW5lIHdpdGggdGlsZXMgb3JcbiAqICBjYW4gYmUgYXNzb2NpYXRlZCB3aXRoIGNvbnRlbnQsIGZvciBleGFtcGxlLCBpbiBhbiBhZGphY2VudCBjb2x1bW4uXG4gKlxuICogIFVwb24gc2Nyb2xsaW5nLCBzdWJoZWFkZXJzIHJlbWFpbiBwaW5uZWQgdG8gdGhlIHRvcCBvZiB0aGUgc2NyZWVuIGFuZCByZW1haW5cbiAqICBwaW5uZWQgdW50aWwgcHVzaGVkIG9uIG9yIG9mZiBzY3JlZW4gYnkgdGhlIG5leHQgc3ViaGVhZGVyLiBAc2VlIFtNYXRlcmlhbFxuICogIERlc2lnbiBTcGVjaWZpY2F0aW9uc10oaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9kZXNpZ24vc3BlYy9jb21wb25lbnRzL3N1YmhlYWRlcnMuaHRtbClcbiAqXG4gKiAgPiBUbyBpbXByb3ZlIHRoZSB2aXN1YWwgZ3JvdXBpbmcgb2YgY29udGVudCwgdXNlIHRoZSBzeXN0ZW0gY29sb3IgZm9yIHlvdXIgc3ViaGVhZGVycy5cbiAqXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnN1YmhlYWRlcicsIFtcbiAgJ21hdGVyaWFsLmNvcmUnLFxuICAnbWF0ZXJpYWwuY29tcG9uZW50cy5zdGlja3knXG5dKVxuICAuZGlyZWN0aXZlKCdtZFN1YmhlYWRlcicsIE1kU3ViaGVhZGVyRGlyZWN0aXZlKTtcblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBtZFN1YmhlYWRlclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnN1YmhlYWRlclxuICpcbiAqIEByZXN0cmljdCBFXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBUaGUgYDxtZC1zdWJoZWFkZXI+YCBkaXJlY3RpdmUgaXMgYSBzdWJoZWFkZXIgZm9yIGEgc2VjdGlvbi4gQnkgZGVmYXVsdCBpdCBpcyBzdGlja3kuXG4gKiBZb3UgY2FuIG1ha2UgaXQgbm90IHN0aWNreSBieSBhcHBseWluZyB0aGUgYG1kLW5vLXN0aWNreWAgY2xhc3MgdG8gdGhlIHN1YmhlYWRlci5cbiAqXG4gKlxuICogQHVzYWdlXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxuICogPG1kLXN1YmhlYWRlcj5PbmxpbmUgRnJpZW5kczwvbWQtc3ViaGVhZGVyPlxuICogPC9obGpzPlxuICovXG5cbmZ1bmN0aW9uIE1kU3ViaGVhZGVyRGlyZWN0aXZlKCRtZFN0aWNreSwgJGNvbXBpbGUsICRtZFRoZW1pbmcpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0UnLFxuICAgIHJlcGxhY2U6IHRydWUsXG4gICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICB0ZW1wbGF0ZTogXG4gICAgICAnPGgyIGNsYXNzPVwibWQtc3ViaGVhZGVyXCI+JyArXG4gICAgICAgICc8ZGl2IGNsYXNzPVwibWQtc3ViaGVhZGVyLWlubmVyXCI+JyArXG4gICAgICAgICAgJzxzcGFuIGNsYXNzPVwibWQtc3ViaGVhZGVyLWNvbnRlbnRcIj48L3NwYW4+JyArXG4gICAgICAgICc8L2Rpdj4nICtcbiAgICAgICc8L2gyPicsXG4gICAgY29tcGlsZTogZnVuY3Rpb24oZWxlbWVudCwgYXR0ciwgdHJhbnNjbHVkZSkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XG4gICAgICAgICRtZFRoZW1pbmcoZWxlbWVudCk7XG4gICAgICAgIHZhciBvdXRlckhUTUwgPSBlbGVtZW50WzBdLm91dGVySFRNTDtcblxuICAgICAgICBmdW5jdGlvbiBnZXRDb250ZW50KGVsKSB7XG4gICAgICAgICAgcmV0dXJuIGFuZ3VsYXIuZWxlbWVudChlbFswXS5xdWVyeVNlbGVjdG9yKCcubWQtc3ViaGVhZGVyLWNvbnRlbnQnKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUcmFuc2NsdWRlIHRoZSB1c2VyLWdpdmVuIGNvbnRlbnRzIG9mIHRoZSBzdWJoZWFkZXJcbiAgICAgICAgLy8gdGhlIGNvbnZlbnRpb25hbCB3YXkuXG4gICAgICAgIHRyYW5zY2x1ZGUoc2NvcGUsIGZ1bmN0aW9uKGNsb25lKSB7XG4gICAgICAgICAgZ2V0Q29udGVudChlbGVtZW50KS5hcHBlbmQoY2xvbmUpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBDcmVhdGUgYW5vdGhlciBjbG9uZSwgdGhhdCB1c2VzIHRoZSBvdXRlciBhbmQgaW5uZXIgY29udGVudHNcbiAgICAgICAgLy8gb2YgdGhlIGVsZW1lbnQsIHRoYXQgd2lsbCBiZSAnc3RpY2tpZWQnIGFzIHRoZSB1c2VyIHNjcm9sbHMuXG4gICAgICAgIGlmICghZWxlbWVudC5oYXNDbGFzcygnbWQtbm8tc3RpY2t5JykpIHtcbiAgICAgICAgICB0cmFuc2NsdWRlKHNjb3BlLCBmdW5jdGlvbihjbG9uZSkge1xuICAgICAgICAgICAgdmFyIHN0aWNreUNsb25lID0gJGNvbXBpbGUoYW5ndWxhci5lbGVtZW50KG91dGVySFRNTCkpKHNjb3BlKTtcbiAgICAgICAgICAgIGdldENvbnRlbnQoc3RpY2t5Q2xvbmUpLmFwcGVuZChjbG9uZSk7XG4gICAgICAgICAgICAkbWRTdGlja3koc2NvcGUsIGVsZW1lbnQsIHN0aWNreUNsb25lKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH07XG59XG5NZFN1YmhlYWRlckRpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kU3RpY2t5XCIsIFwiJGNvbXBpbGVcIiwgXCIkbWRUaGVtaW5nXCJdO1xuXG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBAbmdkb2MgbW9kdWxlXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLnN3aXBlXG4gKiBAZGVzY3JpcHRpb24gU3dpcGUgbW9kdWxlIVxuICovXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5zd2lwZVxuICogQG5hbWUgbWRTd2lwZUxlZnRcbiAqXG4gKiBAcmVzdHJpY3QgQVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogVGhlIG1kLXN3aXBlLWxlZnQgZGlyZWN0aXZlcyBhbGxvd3MgeW91IHRvIHNwZWNpZnkgY3VzdG9tIGJlaGF2aW9yIHdoZW4gYW4gZWxlbWVudCBpcyBzd2lwZWRcbiAqIGxlZnQuXG4gKlxuICogQHVzYWdlXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxuICogPGRpdiBtZC1zd2lwZS1sZWZ0PVwib25Td2lwZUxlZnQoKVwiPlN3aXBlIG1lIGxlZnQhPC9kaXY+XG4gKiA8L2hsanM+XG4gKi9cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnN3aXBlXG4gKiBAbmFtZSBtZFN3aXBlUmlnaHRcbiAqXG4gKiBAcmVzdHJpY3QgQVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogVGhlIG1kLXN3aXBlLXJpZ2h0IGRpcmVjdGl2ZXMgYWxsb3dzIHlvdSB0byBzcGVjaWZ5IGN1c3RvbSBiZWhhdmlvciB3aGVuIGFuIGVsZW1lbnQgaXMgc3dpcGVkXG4gKiByaWdodC5cbiAqXG4gKiBAdXNhZ2VcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiA8ZGl2IG1kLXN3aXBlLXJpZ2h0PVwib25Td2lwZVJpZ2h0KClcIj5Td2lwZSBtZSByaWdodCE8L2Rpdj5cbiAqIDwvaGxqcz5cbiAqL1xuXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5zd2lwZScsIFsnbWF0ZXJpYWwuY29yZSddKVxuICAgIC5kaXJlY3RpdmUoJ21kU3dpcGVMZWZ0JywgZ2V0RGlyZWN0aXZlKCdTd2lwZUxlZnQnKSlcbiAgICAuZGlyZWN0aXZlKCdtZFN3aXBlUmlnaHQnLCBnZXREaXJlY3RpdmUoJ1N3aXBlUmlnaHQnKSk7XG5cbmZ1bmN0aW9uIGdldERpcmVjdGl2ZShuYW1lKSB7XG4gIHZhciBkaXJlY3RpdmVOYW1lID0gJ21kJyArIG5hbWU7XG4gIHZhciBldmVudE5hbWUgPSAnJG1kLicgKyBuYW1lLnRvTG93ZXJDYXNlKCk7XG5cbiAgICBEaXJlY3RpdmVGYWN0b3J5LiRpbmplY3QgPSBbXCIkcGFyc2VcIl07XG4gIHJldHVybiBEaXJlY3RpdmVGYWN0b3J5O1xuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBEaXJlY3RpdmVGYWN0b3J5KCRwYXJzZSkge1xuICAgICAgcmV0dXJuIHsgcmVzdHJpY3Q6ICdBJywgbGluazogcG9zdExpbmsgfTtcbiAgICAgIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XG4gICAgICAgIHZhciBmbiA9ICRwYXJzZShhdHRyW2RpcmVjdGl2ZU5hbWVdKTtcbiAgICAgICAgZWxlbWVudC5vbihldmVudE5hbWUsIGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkgeyBmbihzY29wZSwgeyAkZXZlbnQ6IGV2IH0pOyB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxufVxuXG5cblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogQHByaXZhdGVcbiAqIEBuZ2RvYyBtb2R1bGVcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuc3dpdGNoXG4gKi9cblxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuc3dpdGNoJywgW1xuICAnbWF0ZXJpYWwuY29yZScsXG4gICdtYXRlcmlhbC5jb21wb25lbnRzLmNoZWNrYm94J1xuXSlcbiAgLmRpcmVjdGl2ZSgnbWRTd2l0Y2gnLCBNZFN3aXRjaCk7XG5cbi8qKlxuICogQHByaXZhdGVcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5zd2l0Y2hcbiAqIEBuYW1lIG1kU3dpdGNoXG4gKiBAcmVzdHJpY3QgRVxuICpcbiAqIFRoZSBzd2l0Y2ggZGlyZWN0aXZlIGlzIHVzZWQgdmVyeSBtdWNoIGxpa2UgdGhlIG5vcm1hbCBbYW5ndWxhciBjaGVja2JveF0oaHR0cHM6Ly9kb2NzLmFuZ3VsYXJqcy5vcmcvYXBpL25nL2lucHV0L2lucHV0JTVCY2hlY2tib3glNUQpLlxuICpcbiAqIEFzIHBlciB0aGUgW21hdGVyaWFsIGRlc2lnbiBzcGVjXShodHRwOi8vd3d3Lmdvb2dsZS5jb20vZGVzaWduL3NwZWMvc3R5bGUvY29sb3IuaHRtbCNjb2xvci11aS1jb2xvci1hcHBsaWNhdGlvbilcbiAqIHRoZSBzd2l0Y2ggaXMgaW4gdGhlIGFjY2VudCBjb2xvciBieSBkZWZhdWx0LiBUaGUgcHJpbWFyeSBjb2xvciBwYWxldHRlIG1heSBiZSB1c2VkIHdpdGhcbiAqIHRoZSBgbWQtcHJpbWFyeWAgY2xhc3MuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IG5nLW1vZGVsIEFzc2lnbmFibGUgYW5ndWxhciBleHByZXNzaW9uIHRvIGRhdGEtYmluZCB0by5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gbmFtZSBQcm9wZXJ0eSBuYW1lIG9mIHRoZSBmb3JtIHVuZGVyIHdoaWNoIHRoZSBjb250cm9sIGlzIHB1Ymxpc2hlZC5cbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbj19IG5nLXRydWUtdmFsdWUgVGhlIHZhbHVlIHRvIHdoaWNoIHRoZSBleHByZXNzaW9uIHNob3VsZCBiZSBzZXQgd2hlbiBzZWxlY3RlZC5cbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbj19IG5nLWZhbHNlLXZhbHVlIFRoZSB2YWx1ZSB0byB3aGljaCB0aGUgZXhwcmVzc2lvbiBzaG91bGQgYmUgc2V0IHdoZW4gbm90IHNlbGVjdGVkLlxuICogQHBhcmFtIHtzdHJpbmc9fSBuZy1jaGFuZ2UgQW5ndWxhciBleHByZXNzaW9uIHRvIGJlIGV4ZWN1dGVkIHdoZW4gaW5wdXQgY2hhbmdlcyBkdWUgdG8gdXNlciBpbnRlcmFjdGlvbiB3aXRoIHRoZSBpbnB1dCBlbGVtZW50LlxuICogQHBhcmFtIHtib29sZWFuPX0gbWQtbm8taW5rIFVzZSBvZiBhdHRyaWJ1dGUgaW5kaWNhdGVzIHVzZSBvZiByaXBwbGUgaW5rIGVmZmVjdHMuXG4gKiBAcGFyYW0ge3N0cmluZz19IGFyaWEtbGFiZWwgUHVibGlzaCB0aGUgYnV0dG9uIGxhYmVsIHVzZWQgYnkgc2NyZWVuLXJlYWRlcnMgZm9yIGFjY2Vzc2liaWxpdHkuIERlZmF1bHRzIHRvIHRoZSBzd2l0Y2gncyB0ZXh0LlxuICpcbiAqIEB1c2FnZVxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cbiAqIDxtZC1zd2l0Y2ggbmctbW9kZWw9XCJpc0FjdGl2ZVwiIGFyaWEtbGFiZWw9XCJGaW5pc2hlZD9cIj5cbiAqICAgRmluaXNoZWQgP1xuICogPC9tZC1zd2l0Y2g+XG4gKlxuICogPG1kLXN3aXRjaCBtZC1uby1pbmsgbmctbW9kZWw9XCJoYXNJbmtcIiBhcmlhLWxhYmVsPVwiTm8gSW5rIEVmZmVjdHNcIj5cbiAqICAgTm8gSW5rIEVmZmVjdHNcbiAqIDwvbWQtc3dpdGNoPlxuICpcbiAqIDxtZC1zd2l0Y2ggbmctZGlzYWJsZWQ9XCJ0cnVlXCIgbmctbW9kZWw9XCJpc0Rpc2FibGVkXCIgYXJpYS1sYWJlbD1cIkRpc2FibGVkXCI+XG4gKiAgIERpc2FibGVkXG4gKiA8L21kLXN3aXRjaD5cbiAqXG4gKiA8L2hsanM+XG4gKi9cbmZ1bmN0aW9uIE1kU3dpdGNoKG1kQ2hlY2tib3hEaXJlY3RpdmUsICRtZFRoZW1pbmcsICRtZFV0aWwsICRkb2N1bWVudCwgJG1kQ29uc3RhbnQsICRwYXJzZSwgJCRyQUYsICRtZEdlc3R1cmUpIHtcbiAgdmFyIGNoZWNrYm94RGlyZWN0aXZlID0gbWRDaGVja2JveERpcmVjdGl2ZVswXTtcblxuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnRScsXG4gICAgcHJpb3JpdHk6MjEwLCAvLyBSdW4gYmVmb3JlIG5nQXJpYVxuICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgdGVtcGxhdGU6XG4gICAgICAnPGRpdiBjbGFzcz1cIm1kLWNvbnRhaW5lclwiPicgK1xuICAgICAgICAnPGRpdiBjbGFzcz1cIm1kLWJhclwiPjwvZGl2PicgK1xuICAgICAgICAnPGRpdiBjbGFzcz1cIm1kLXRodW1iLWNvbnRhaW5lclwiPicgK1xuICAgICAgICAgICc8ZGl2IGNsYXNzPVwibWQtdGh1bWJcIiBtZC1pbmstcmlwcGxlIG1kLWluay1yaXBwbGUtY2hlY2tib3g+PC9kaXY+JyArXG4gICAgICAgICc8L2Rpdj4nK1xuICAgICAgJzwvZGl2PicgK1xuICAgICAgJzxkaXYgbmctdHJhbnNjbHVkZSBjbGFzcz1cIm1kLWxhYmVsXCI+JyArXG4gICAgICAnPC9kaXY+JyxcbiAgICByZXF1aXJlOiAnP25nTW9kZWwnLFxuICAgIGNvbXBpbGU6IGNvbXBpbGVcbiAgfTtcblxuICBmdW5jdGlvbiBjb21waWxlKGVsZW1lbnQsIGF0dHIpIHtcbiAgICB2YXIgY2hlY2tib3hMaW5rID0gY2hlY2tib3hEaXJlY3RpdmUuY29tcGlsZShlbGVtZW50LCBhdHRyKTtcbiAgICAvLyBubyB0cmFuc2l0aW9uIG9uIGluaXRpYWwgbG9hZFxuICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ21kLWRyYWdnaW5nJyk7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBuZ01vZGVsKSB7XG4gICAgICBuZ01vZGVsID0gbmdNb2RlbCB8fCAkbWRVdGlsLmZha2VOZ01vZGVsKCk7XG4gICAgICB2YXIgZGlzYWJsZWRHZXR0ZXIgPSAkcGFyc2UoYXR0ci5uZ0Rpc2FibGVkKTtcbiAgICAgIHZhciB0aHVtYkNvbnRhaW5lciA9IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJy5tZC10aHVtYi1jb250YWluZXInKSk7XG4gICAgICB2YXIgc3dpdGNoQ29udGFpbmVyID0gYW5ndWxhci5lbGVtZW50KGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignLm1kLWNvbnRhaW5lcicpKTtcblxuICAgICAgLy8gbm8gdHJhbnNpdGlvbiBvbiBpbml0aWFsIGxvYWRcbiAgICAgICQkckFGKGZ1bmN0aW9uKCkge1xuICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdtZC1kcmFnZ2luZycpO1xuICAgICAgfSk7XG5cbiAgICAgIGNoZWNrYm94TGluayhzY29wZSwgZWxlbWVudCwgYXR0ciwgbmdNb2RlbCk7XG5cbiAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChhdHRyLm5nRGlzYWJsZWQpKSB7XG4gICAgICAgIHNjb3BlLiR3YXRjaChkaXNhYmxlZEdldHRlciwgZnVuY3Rpb24oaXNEaXNhYmxlZCkge1xuICAgICAgICAgIGVsZW1lbnQuYXR0cigndGFiaW5kZXgnLCBpc0Rpc2FibGVkID8gLTEgOiAwKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFRoZXNlIGV2ZW50cyBhcmUgdHJpZ2dlcmVkIGJ5IHNldHVwIGRyYWdcbiAgICAgICRtZEdlc3R1cmUucmVnaXN0ZXIoc3dpdGNoQ29udGFpbmVyLCAnZHJhZycpO1xuICAgICAgc3dpdGNoQ29udGFpbmVyXG4gICAgICAgIC5vbignJG1kLmRyYWdzdGFydCcsIG9uRHJhZ1N0YXJ0KVxuICAgICAgICAub24oJyRtZC5kcmFnJywgb25EcmFnKVxuICAgICAgICAub24oJyRtZC5kcmFnZW5kJywgb25EcmFnRW5kKTtcblxuICAgICAgdmFyIGRyYWc7XG4gICAgICBmdW5jdGlvbiBvbkRyYWdTdGFydChldikge1xuICAgICAgICAvLyBEb24ndCBnbyBpZiBuZy1kaXNhYmxlZD09PXRydWVcbiAgICAgICAgaWYgKGRpc2FibGVkR2V0dGVyKHNjb3BlKSkgcmV0dXJuO1xuICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdtZC1kcmFnZ2luZycpO1xuICAgICAgICBkcmFnID0ge1xuICAgICAgICAgIHdpZHRoOiB0aHVtYkNvbnRhaW5lci5wcm9wKCdvZmZzZXRXaWR0aCcpXG4gICAgICAgIH07XG4gICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ3RyYW5zaXRpb24nKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gb25EcmFnKGV2KSB7XG4gICAgICAgIGlmICghZHJhZykgcmV0dXJuO1xuICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgZXYuc3JjRXZlbnQgJiYgZXYuc3JjRXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICB2YXIgcGVyY2VudCA9IGV2LnBvaW50ZXIuZGlzdGFuY2VYIC8gZHJhZy53aWR0aDtcblxuICAgICAgICAvL2lmIGNoZWNrZWQsIHN0YXJ0IGZyb20gcmlnaHQuIGVsc2UsIHN0YXJ0IGZyb20gbGVmdFxuICAgICAgICB2YXIgdHJhbnNsYXRlID0gbmdNb2RlbC4kdmlld1ZhbHVlID8gIDEgKyBwZXJjZW50IDogcGVyY2VudDtcbiAgICAgICAgLy8gTWFrZSBzdXJlIHRoZSBzd2l0Y2ggc3RheXMgaW5zaWRlIGl0cyBib3VuZHMsIDAtMSVcbiAgICAgICAgdHJhbnNsYXRlID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgdHJhbnNsYXRlKSk7XG5cbiAgICAgICAgdGh1bWJDb250YWluZXIuY3NzKCRtZENvbnN0YW50LkNTUy5UUkFOU0ZPUk0sICd0cmFuc2xhdGUzZCgnICsgKDEwMCp0cmFuc2xhdGUpICsgJyUsMCwwKScpO1xuICAgICAgICBkcmFnLnRyYW5zbGF0ZSA9IHRyYW5zbGF0ZTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gb25EcmFnRW5kKGV2KSB7XG4gICAgICAgIGlmICghZHJhZykgcmV0dXJuO1xuICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdtZC1kcmFnZ2luZycpO1xuICAgICAgICB0aHVtYkNvbnRhaW5lci5jc3MoJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STSwgJycpO1xuXG4gICAgICAgIC8vIFdlIGNoYW5nZWQgaWYgdGhlcmUgaXMgbm8gZGlzdGFuY2UgKHRoaXMgaXMgYSBjbGljayBhIGNsaWNrKSxcbiAgICAgICAgLy8gb3IgaWYgdGhlIGRyYWcgZGlzdGFuY2UgaXMgPjUwJSBvZiB0aGUgdG90YWwuXG4gICAgICAgIHZhciBpc0NoYW5nZWQgPSBuZ01vZGVsLiR2aWV3VmFsdWUgPyBkcmFnLnRyYW5zbGF0ZSA8IDAuNSA6IGRyYWcudHJhbnNsYXRlID4gMC41O1xuICAgICAgICBpZiAoaXNDaGFuZ2VkKSB7XG4gICAgICAgICAgYXBwbHlNb2RlbFZhbHVlKCFuZ01vZGVsLiR2aWV3VmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGRyYWcgPSBudWxsO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBhcHBseU1vZGVsVmFsdWUobmV3VmFsdWUpIHtcbiAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIG5nTW9kZWwuJHNldFZpZXdWYWx1ZShuZXdWYWx1ZSk7XG4gICAgICAgICAgbmdNb2RlbC4kcmVuZGVyKCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgfTtcbiAgfVxuXG5cbn1cbk1kU3dpdGNoLiRpbmplY3QgPSBbXCJtZENoZWNrYm94RGlyZWN0aXZlXCIsIFwiJG1kVGhlbWluZ1wiLCBcIiRtZFV0aWxcIiwgXCIkZG9jdW1lbnRcIiwgXCIkbWRDb25zdGFudFwiLCBcIiRwYXJzZVwiLCBcIiQkckFGXCIsIFwiJG1kR2VzdHVyZVwiXTtcblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogQG5nZG9jIG1vZHVsZVxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy50YWJzXG4gKiBAZGVzY3JpcHRpb25cbiAqXG4gKiAgVGFicywgY3JlYXRlZCB3aXRoIHRoZSBgPG1kLXRhYnM+YCBkaXJlY3RpdmUgcHJvdmlkZSAqdGFiYmVkKiBuYXZpZ2F0aW9uIHdpdGggZGlmZmVyZW50IHN0eWxlcy5cbiAqICBUaGUgVGFicyBjb21wb25lbnQgY29uc2lzdHMgb2YgY2xpY2thYmxlIHRhYnMgdGhhdCBhcmUgYWxpZ25lZCBob3Jpem9udGFsbHkgc2lkZS1ieS1zaWRlLlxuICpcbiAqICBGZWF0dXJlcyBpbmNsdWRlIHN1cHBvcnQgZm9yOlxuICpcbiAqICAtIHN0YXRpYyBvciBkeW5hbWljIHRhYnMsXG4gKiAgLSByZXNwb25zaXZlIGRlc2lnbnMsXG4gKiAgLSBhY2Nlc3NpYmlsaXR5IHN1cHBvcnQgKEFSSUEpLFxuICogIC0gdGFiIHBhZ2luYXRpb24sXG4gKiAgLSBleHRlcm5hbCBvciBpbnRlcm5hbCB0YWIgY29udGVudCxcbiAqICAtIGZvY3VzIGluZGljYXRvcnMgYW5kIGFycm93LWtleSBuYXZpZ2F0aW9ucyxcbiAqICAtIHByb2dyYW1tYXRpYyBsb29rdXAgYW5kIGFjY2VzcyB0byB0YWIgY29udHJvbGxlcnMsIGFuZFxuICogIC0gZHluYW1pYyB0cmFuc2l0aW9ucyB0aHJvdWdoIGRpZmZlcmVudCB0YWIgY29udGVudHMuXG4gKlxuICovXG4vKlxuICogQHNlZSBqcyBmb2xkZXIgZm9yIHRhYnMgaW1wbGVtZW50YXRpb25cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMudGFicycsIFtcbiAgJ21hdGVyaWFsLmNvcmUnLFxuICAnbWF0ZXJpYWwuY29tcG9uZW50cy5pY29uJ1xuXSk7XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIEBuZ2RvYyBtb2R1bGVcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMudG9hc3RcbiAqIEBkZXNjcmlwdGlvblxuICogVG9hc3RcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMudG9hc3QnLCBbXG4gICdtYXRlcmlhbC5jb3JlJyxcbiAgJ21hdGVyaWFsLmNvbXBvbmVudHMuYnV0dG9uJ1xuXSlcbiAgLmRpcmVjdGl2ZSgnbWRUb2FzdCcsIE1kVG9hc3REaXJlY3RpdmUpXG4gIC5wcm92aWRlcignJG1kVG9hc3QnLCBNZFRvYXN0UHJvdmlkZXIpO1xuXG5mdW5jdGlvbiBNZFRvYXN0RGlyZWN0aXZlKCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnRSdcbiAgfTtcbn1cblxuLyoqXG4gKiBAbmdkb2Mgc2VydmljZVxuICogQG5hbWUgJG1kVG9hc3RcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy50b2FzdFxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogYCRtZFRvYXN0YCBpcyBhIHNlcnZpY2UgdG8gYnVpbGQgYSB0b2FzdCBub3RpZmljYXRpb24gb24gYW55IHBvc2l0aW9uXG4gKiBvbiB0aGUgc2NyZWVuIHdpdGggYW4gb3B0aW9uYWwgZHVyYXRpb24sIGFuZCBwcm92aWRlcyBhIHNpbXBsZSBwcm9taXNlIEFQSS5cbiAqXG4gKlxuICogIyMgUmVzdHJpY3Rpb25zIG9uIGN1c3RvbSB0b2FzdHNcbiAqIC0gVGhlIHRvYXN0J3MgdGVtcGxhdGUgbXVzdCBoYXZlIGFuIG91dGVyIGA8bWQtdG9hc3Q+YCBlbGVtZW50LlxuICogLSBGb3IgYSB0b2FzdCBhY3Rpb24sIHVzZSBlbGVtZW50IHdpdGggY2xhc3MgYG1kLWFjdGlvbmAuXG4gKiAtIEFkZCB0aGUgY2xhc3MgYG1kLWNhcHN1bGVgIGZvciBjdXJ2ZWQgY29ybmVycy5cbiAqXG4gKiBAdXNhZ2VcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiA8ZGl2IG5nLWNvbnRyb2xsZXI9XCJNeUNvbnRyb2xsZXJcIj5cbiAqICAgPG1kLWJ1dHRvbiBuZy1jbGljaz1cIm9wZW5Ub2FzdCgpXCI+XG4gKiAgICAgT3BlbiBhIFRvYXN0IVxuICogICA8L21kLWJ1dHRvbj5cbiAqIDwvZGl2PlxuICogPC9obGpzPlxuICpcbiAqIDxobGpzIGxhbmc9XCJqc1wiPlxuICogdmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbJ25nTWF0ZXJpYWwnXSk7XG4gKiBhcHAuY29udHJvbGxlcignTXlDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkbWRUb2FzdCkge1xuICogICAkc2NvcGUub3BlblRvYXN0ID0gZnVuY3Rpb24oJGV2ZW50KSB7XG4gKiAgICAgJG1kVG9hc3Quc2hvdygkbWRUb2FzdC5zaW1wbGUoKS5jb250ZW50KCdIZWxsbyEnKSk7XG4gKiAgICAgLy8gQ291bGQgYWxzbyBkbyAkbWRUb2FzdC5zaG93U2ltcGxlKCdIZWxsbycpO1xuICogICB9O1xuICogfSk7XG4gKiA8L2hsanM+XG4gKi9cblxuLyoqXG4gKiBAbmdkb2MgbWV0aG9kXG4gKiBAbmFtZSAkbWRUb2FzdCNzaG93U2ltcGxlXG4gKiBcbiAqIEBkZXNjcmlwdGlvblxuICogQ29udmVuaWVuY2UgbWV0aG9kIHdoaWNoIGJ1aWxkcyBhbmQgc2hvd3MgYSBzaW1wbGUgdG9hc3QuXG4gKlxuICogQHJldHVybnMge3Byb21pc2V9IEEgcHJvbWlzZSB0aGF0IGNhbiBiZSByZXNvbHZlZCB3aXRoIGAkbWRUb2FzdC5oaWRlKClgIG9yXG4gKiByZWplY3RlZCB3aXRoIGAkbWRUb2FzdC5jYW5jZWwoKWAuXG4gKlxuICovXG5cbiAvKipcbiAqIEBuZ2RvYyBtZXRob2RcbiAqIEBuYW1lICRtZFRvYXN0I3NpbXBsZVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogQnVpbGRzIGEgcHJlY29uZmlndXJlZCB0b2FzdC5cbiAqXG4gKiBAcmV0dXJucyB7b2JqfSBhIGAkbWRUb2FzdFByZXNldGAgd2l0aCB0aGUgY2hhaW5hYmxlIGNvbmZpZ3VyYXRpb24gbWV0aG9kczpcbiAqXG4gKiAtICRtZFRvYXN0UHJlc2V0I2NvbnRlbnQoc3RyaW5nKSAtIHNldHMgdG9hc3QgY29udGVudCB0byBzdHJpbmdcbiAqIC0gJG1kVG9hc3RQcmVzZXQjYWN0aW9uKHN0cmluZykgLSBhZGRzIGFuIGFjdGlvbiBidXR0b24sIHdoaWNoIHJlc29sdmVzIHRoZSBwcm9taXNlIHJldHVybmVkIGZyb20gYHNob3coKWAgaWYgY2xpY2tlZC5cbiAqIC0gJG1kVG9hc3RQcmVzZXQjaGlnaGxpZ2h0QWN0aW9uKGJvb2xlYW4pIC0gc2V0cyBhY3Rpb24gYnV0dG9uIHRvIGJlIGhpZ2hsaWdodGVkXG4gKiAtICRtZFRvYXN0UHJlc2V0I2NhcHN1bGUoYm9vbGVhbikgLSBhZGRzICdtZC1jYXBzdWxlJyBjbGFzcyB0byB0aGUgdG9hc3QgKGN1cnZlZCBjb3JuZXJzKVxuICogLSAkbWRUb2FzdFByZXNldCN0aGVtZShzdHJpbmcpIC0gc2V0cyB0aGUgdGhlbWUgb24gdGhlIHRvYXN0IHRvIHRoZW1lIChkZWZhdWx0IGlzIGAkbWRUaGVtaW5nUHJvdmlkZXJgJ3MgZGVmYXVsdCB0aGVtZSlcbiAqL1xuXG4vKipcbiAqIEBuZ2RvYyBtZXRob2RcbiAqIEBuYW1lICRtZFRvYXN0I3VwZGF0ZUNvbnRlbnRcbiAqIFxuICogQGRlc2NyaXB0aW9uXG4gKiBVcGRhdGVzIHRoZSBjb250ZW50IG9mIGFuIGV4aXN0aW5nIHRvYXN0LiBVc2VmdWwgZm9yIHVwZGF0aW5nIHRoaW5ncyBsaWtlIGNvdW50cywgZXRjLlxuICpcbiAqL1xuXG4gLyoqXG4gKiBAbmdkb2MgbWV0aG9kXG4gKiBAbmFtZSAkbWRUb2FzdCNidWlsZFxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogQ3JlYXRlcyBhIGN1c3RvbSBgJG1kVG9hc3RQcmVzZXRgIHRoYXQgeW91IGNhbiBjb25maWd1cmUuXG4gKlxuICogQHJldHVybnMge29ian0gYSBgJG1kVG9hc3RQcmVzZXRgIHdpdGggdGhlIGNoYWluYWJsZSBjb25maWd1cmF0aW9uIG1ldGhvZHMgZm9yIHNob3dzJyBvcHRpb25zIChzZWUgYmVsb3cpLlxuICovXG5cbiAvKipcbiAqIEBuZ2RvYyBtZXRob2RcbiAqIEBuYW1lICRtZFRvYXN0I3Nob3dcbiAqXG4gKiBAZGVzY3JpcHRpb24gU2hvd3MgdGhlIHRvYXN0LlxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBvcHRpb25zT3JQcmVzZXQgRWl0aGVyIHByb3ZpZGUgYW4gYCRtZFRvYXN0UHJlc2V0YCByZXR1cm5lZCBmcm9tIGBzaW1wbGUoKWBcbiAqIGFuZCBgYnVpbGQoKWAsIG9yIGFuIG9wdGlvbnMgb2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOlxuICpcbiAqICAgLSBgdGVtcGxhdGVVcmxgIC0gYHtzdHJpbmc9fWA6IFRoZSB1cmwgb2YgYW4gaHRtbCB0ZW1wbGF0ZSBmaWxlIHRoYXQgd2lsbFxuICogICAgIGJlIHVzZWQgYXMgdGhlIGNvbnRlbnQgb2YgdGhlIHRvYXN0LiBSZXN0cmljdGlvbnM6IHRoZSB0ZW1wbGF0ZSBtdXN0XG4gKiAgICAgaGF2ZSBhbiBvdXRlciBgbWQtdG9hc3RgIGVsZW1lbnQuXG4gKiAgIC0gYHRlbXBsYXRlYCAtIGB7c3RyaW5nPX1gOiBTYW1lIGFzIHRlbXBsYXRlVXJsLCBleGNlcHQgdGhpcyBpcyBhbiBhY3R1YWxcbiAqICAgICB0ZW1wbGF0ZSBzdHJpbmcuXG4gKiAgIC0gYHNjb3BlYCAtIGB7b2JqZWN0PX1gOiB0aGUgc2NvcGUgdG8gbGluayB0aGUgdGVtcGxhdGUgLyBjb250cm9sbGVyIHRvLiBJZiBub25lIGlzIHNwZWNpZmllZCwgaXQgd2lsbCBjcmVhdGUgYSBuZXcgY2hpbGQgc2NvcGUuXG4gKiAgICAgVGhpcyBzY29wZSB3aWxsIGJlIGRlc3Ryb3llZCB3aGVuIHRoZSB0b2FzdCBpcyByZW1vdmVkIHVubGVzcyBgcHJlc2VydmVTY29wZWAgaXMgc2V0IHRvIHRydWUuXG4gKiAgIC0gYHByZXNlcnZlU2NvcGVgIC0gYHtib29sZWFuPX1gOiB3aGV0aGVyIHRvIHByZXNlcnZlIHRoZSBzY29wZSB3aGVuIHRoZSBlbGVtZW50IGlzIHJlbW92ZWQuIERlZmF1bHQgaXMgZmFsc2VcbiAqICAgLSBgaGlkZURlbGF5YCAtIGB7bnVtYmVyPX1gOiBIb3cgbWFueSBtaWxsaXNlY29uZHMgdGhlIHRvYXN0IHNob3VsZCBzdGF5XG4gKiAgICAgYWN0aXZlIGJlZm9yZSBhdXRvbWF0aWNhbGx5IGNsb3NpbmcuICBTZXQgdG8gMCBvciBmYWxzZSB0byBoYXZlIHRoZSB0b2FzdCBzdGF5IG9wZW4gdW50aWxcbiAqICAgICBjbG9zZWQgbWFudWFsbHkuIERlZmF1bHQ6IDMwMDAuXG4gKiAgIC0gYHBvc2l0aW9uYCAtIGB7c3RyaW5nPX1gOiBXaGVyZSB0byBwbGFjZSB0aGUgdG9hc3QuIEF2YWlsYWJsZTogYW55IGNvbWJpbmF0aW9uXG4gKiAgICAgb2YgJ2JvdHRvbScsICdsZWZ0JywgJ3RvcCcsICdyaWdodCcsICdmaXQnLiBEZWZhdWx0OiAnYm90dG9tIGxlZnQnLlxuICogICAtIGBjb250cm9sbGVyYCAtIGB7c3RyaW5nPX1gOiBUaGUgY29udHJvbGxlciB0byBhc3NvY2lhdGUgd2l0aCB0aGlzIHRvYXN0LlxuICogICAgIFRoZSBjb250cm9sbGVyIHdpbGwgYmUgaW5qZWN0ZWQgdGhlIGxvY2FsIGAkaGlkZVRvYXN0YCwgd2hpY2ggaXMgYSBmdW5jdGlvblxuICogICAgIHVzZWQgdG8gaGlkZSB0aGUgdG9hc3QuXG4gKiAgIC0gYGxvY2Fsc2AgLSBge3N0cmluZz19YDogQW4gb2JqZWN0IGNvbnRhaW5pbmcga2V5L3ZhbHVlIHBhaXJzLiBUaGUga2V5cyB3aWxsXG4gKiAgICAgYmUgdXNlZCBhcyBuYW1lcyBvZiB2YWx1ZXMgdG8gaW5qZWN0IGludG8gdGhlIGNvbnRyb2xsZXIuIEZvciBleGFtcGxlLFxuICogICAgIGBsb2NhbHM6IHt0aHJlZTogM31gIHdvdWxkIGluamVjdCBgdGhyZWVgIGludG8gdGhlIGNvbnRyb2xsZXIgd2l0aCB0aGUgdmFsdWVcbiAqICAgICBvZiAzLlxuICogICAtIGBiaW5kVG9Db250cm9sbGVyYCAtIGBib29sYDogYmluZCB0aGUgbG9jYWxzIHRvIHRoZSBjb250cm9sbGVyLCBpbnN0ZWFkIG9mIHBhc3NpbmcgdGhlbSBpbi4gVGhlc2UgdmFsdWVzIHdpbGwgbm90IGJlIGF2YWlsYWJsZSB1bnRpbCBhZnRlciBpbml0aWFsaXphdGlvbi5cbiAqICAgLSBgcmVzb2x2ZWAgLSBge29iamVjdD19YDogU2ltaWxhciB0byBsb2NhbHMsIGV4Y2VwdCBpdCB0YWtlcyBwcm9taXNlcyBhcyB2YWx1ZXNcbiAqICAgICBhbmQgdGhlIHRvYXN0IHdpbGwgbm90IG9wZW4gdW50aWwgdGhlIHByb21pc2VzIHJlc29sdmUuXG4gKiAgIC0gYGNvbnRyb2xsZXJBc2AgLSBge3N0cmluZz19YDogQW4gYWxpYXMgdG8gYXNzaWduIHRoZSBjb250cm9sbGVyIHRvIG9uIHRoZSBzY29wZS5cbiAqICAgLSBgcGFyZW50YCAtIGB7ZWxlbWVudD19YDogVGhlIGVsZW1lbnQgdG8gYXBwZW5kIHRoZSB0b2FzdCB0by4gRGVmYXVsdHMgdG8gYXBwZW5kaW5nXG4gKiAgICAgdG8gdGhlIHJvb3QgZWxlbWVudCBvZiB0aGUgYXBwbGljYXRpb24uXG4gKlxuICogQHJldHVybnMge3Byb21pc2V9IEEgcHJvbWlzZSB0aGF0IGNhbiBiZSByZXNvbHZlZCB3aXRoIGAkbWRUb2FzdC5oaWRlKClgIG9yXG4gKiByZWplY3RlZCB3aXRoIGAkbWRUb2FzdC5jYW5jZWwoKWAuXG4gKi9cblxuLyoqXG4gKiBAbmdkb2MgbWV0aG9kXG4gKiBAbmFtZSAkbWRUb2FzdCNoaWRlXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBIaWRlIGFuIGV4aXN0aW5nIHRvYXN0IGFuZCByZXNvbHZlIHRoZSBwcm9taXNlIHJldHVybmVkIGZyb20gYCRtZFRvYXN0LnNob3coKWAuXG4gKlxuICogQHBhcmFtIHsqPX0gcmVzcG9uc2UgQW4gYXJndW1lbnQgZm9yIHRoZSByZXNvbHZlZCBwcm9taXNlLlxuICpcbiAqIEByZXR1cm5zIHtwcm9taXNlfSBhIHByb21pc2UgdGhhdCBpcyBjYWxsZWQgd2hlbiB0aGUgZXhpc3RpbmcgZWxlbWVudCBpcyByZW1vdmVkIGZyb20gdGhlIERPTVxuICpcbiAqL1xuXG4vKipcbiAqIEBuZ2RvYyBtZXRob2RcbiAqIEBuYW1lICRtZFRvYXN0I2NhbmNlbFxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogSGlkZSB0aGUgZXhpc3RpbmcgdG9hc3QgYW5kIHJlamVjdCB0aGUgcHJvbWlzZSByZXR1cm5lZCBmcm9tXG4gKiBgJG1kVG9hc3Quc2hvdygpYC5cbiAqXG4gKiBAcGFyYW0geyo9fSByZXNwb25zZSBBbiBhcmd1bWVudCBmb3IgdGhlIHJlamVjdGVkIHByb21pc2UuXG4gKlxuICogQHJldHVybnMge3Byb21pc2V9IGEgcHJvbWlzZSB0aGF0IGlzIGNhbGxlZCB3aGVuIHRoZSBleGlzdGluZyBlbGVtZW50IGlzIHJlbW92ZWQgZnJvbSB0aGUgRE9NXG4gKlxuICovXG5cbmZ1bmN0aW9uIE1kVG9hc3RQcm92aWRlcigkJGludGVyaW1FbGVtZW50UHJvdmlkZXIpIHtcbiAgdmFyIGFjdGl2ZVRvYXN0Q29udGVudDtcbiAgdmFyICRtZFRvYXN0ID0gJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyKCckbWRUb2FzdCcpXG4gICAgLnNldERlZmF1bHRzKHtcbiAgICAgIG1ldGhvZHM6IFsncG9zaXRpb24nLCAnaGlkZURlbGF5JywgJ2NhcHN1bGUnIF0sXG4gICAgICBvcHRpb25zOiB0b2FzdERlZmF1bHRPcHRpb25zXG4gICAgfSlcbiAgICAuYWRkUHJlc2V0KCdzaW1wbGUnLCB7XG4gICAgICBhcmdPcHRpb246ICdjb250ZW50JyxcbiAgICAgIG1ldGhvZHM6IFsnY29udGVudCcsICdhY3Rpb24nLCAnaGlnaGxpZ2h0QWN0aW9uJywgJ3RoZW1lJywgJ3BhcmVudCddLFxuICAgICAgb3B0aW9uczogLyogQG5nSW5qZWN0ICovIFtcIiRtZFRvYXN0XCIsIFwiJG1kVGhlbWluZ1wiLCBmdW5jdGlvbigkbWRUb2FzdCwgJG1kVGhlbWluZykge1xuICAgICAgICB2YXIgb3B0cyA9IHtcbiAgICAgICAgICB0ZW1wbGF0ZTogW1xuICAgICAgICAgICAgJzxtZC10b2FzdCBtZC10aGVtZT1cInt7IHRvYXN0LnRoZW1lIH19XCIgbmctY2xhc3M9XCJ7XFwnbWQtY2Fwc3VsZVxcJzogdG9hc3QuY2Fwc3VsZX1cIj4nLFxuICAgICAgICAgICAgICAnPHNwYW4gZmxleD57eyB0b2FzdC5jb250ZW50IH19PC9zcGFuPicsXG4gICAgICAgICAgICAgICc8bWQtYnV0dG9uIGNsYXNzPVwibWQtYWN0aW9uXCIgbmctaWY9XCJ0b2FzdC5hY3Rpb25cIiBuZy1jbGljaz1cInRvYXN0LnJlc29sdmUoKVwiIG5nLWNsYXNzPVwie1xcJ21kLWhpZ2hsaWdodFxcJzogdG9hc3QuaGlnaGxpZ2h0QWN0aW9ufVwiPicsXG4gICAgICAgICAgICAgICAgJ3t7IHRvYXN0LmFjdGlvbiB9fScsXG4gICAgICAgICAgICAgICc8L21kLWJ1dHRvbj4nLFxuICAgICAgICAgICAgJzwvbWQtdG9hc3Q+J1xuICAgICAgICAgIF0uam9pbignJyksXG4gICAgICAgICAgY29udHJvbGxlcjogLyogQG5nSW5qZWN0ICovIFtcIiRzY29wZVwiLCBmdW5jdGlvbiBtZFRvYXN0Q3RybCgkc2NvcGUpIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgICRzY29wZS4kd2F0Y2goZnVuY3Rpb24oKSB7IHJldHVybiBhY3RpdmVUb2FzdENvbnRlbnQ7IH0sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBzZWxmLmNvbnRlbnQgPSBhY3RpdmVUb2FzdENvbnRlbnQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMucmVzb2x2ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAkbWRUb2FzdC5oaWRlKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1dLFxuICAgICAgICAgIHRoZW1lOiAkbWRUaGVtaW5nLmRlZmF1bHRUaGVtZSgpLFxuICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3RvYXN0JyxcbiAgICAgICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBvcHRzO1xuICAgICAgfV1cbiAgICB9KVxuICAgIC5hZGRNZXRob2QoJ3VwZGF0ZUNvbnRlbnQnLCBmdW5jdGlvbihuZXdDb250ZW50KSB7XG4gICAgICBhY3RpdmVUb2FzdENvbnRlbnQgPSBuZXdDb250ZW50O1xuICAgIH0pO1xuXG4gIHRvYXN0RGVmYXVsdE9wdGlvbnMuJGluamVjdCA9IFtcIiR0aW1lb3V0XCIsIFwiJGFuaW1hdGVcIiwgXCIkbWRUb2FzdFwiLCBcIiRtZFV0aWxcIl07XG4gICAgcmV0dXJuICRtZFRvYXN0O1xuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiB0b2FzdERlZmF1bHRPcHRpb25zKCR0aW1lb3V0LCAkYW5pbWF0ZSwgJG1kVG9hc3QsICRtZFV0aWwpIHtcbiAgICByZXR1cm4ge1xuICAgICAgb25TaG93OiBvblNob3csXG4gICAgICBvblJlbW92ZTogb25SZW1vdmUsXG4gICAgICBwb3NpdGlvbjogJ2JvdHRvbSBsZWZ0JyxcbiAgICAgIHRoZW1hYmxlOiB0cnVlLFxuICAgICAgaGlkZURlbGF5OiAzMDAwXG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIG9uU2hvdyhzY29wZSwgZWxlbWVudCwgb3B0aW9ucykge1xuICAgICAgZWxlbWVudCA9ICRtZFV0aWwuZXh0cmFjdEVsZW1lbnRCeU5hbWUoZWxlbWVudCwgJ21kLXRvYXN0Jyk7XG5cbiAgICAgIC8vICd0b3AgbGVmdCcgLT4gJ21kLXRvcCBtZC1sZWZ0J1xuICAgICAgYWN0aXZlVG9hc3RDb250ZW50ID0gb3B0aW9ucy5jb250ZW50O1xuICAgICAgZWxlbWVudC5hZGRDbGFzcyhvcHRpb25zLnBvc2l0aW9uLnNwbGl0KCcgJykubWFwKGZ1bmN0aW9uKHBvcykge1xuICAgICAgICByZXR1cm4gJ21kLScgKyBwb3M7XG4gICAgICB9KS5qb2luKCcgJykpO1xuICAgICAgb3B0aW9ucy5wYXJlbnQuYWRkQ2xhc3ModG9hc3RPcGVuQ2xhc3Mob3B0aW9ucy5wb3NpdGlvbikpO1xuXG4gICAgICBvcHRpb25zLm9uU3dpcGUgPSBmdW5jdGlvbihldiwgZ2VzdHVyZSkge1xuICAgICAgICAvL0FkZCBzd2lwZWxlZnQvc3dpcGVyaWdodCBjbGFzcyB0byBlbGVtZW50IHNvIGl0IGNhbiBhbmltYXRlIGNvcnJlY3RseVxuICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdtZC0nICsgZXYudHlwZS5yZXBsYWNlKCckbWQuJywnJykpO1xuICAgICAgICAkdGltZW91dCgkbWRUb2FzdC5jYW5jZWwpO1xuICAgICAgfTtcbiAgICAgIGVsZW1lbnQub24oJyRtZC5zd2lwZWxlZnQgJG1kLnN3aXBlcmlnaHQnLCBvcHRpb25zLm9uU3dpcGUpO1xuICAgICAgcmV0dXJuICRhbmltYXRlLmVudGVyKGVsZW1lbnQsIG9wdGlvbnMucGFyZW50KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvblJlbW92ZShzY29wZSwgZWxlbWVudCwgb3B0aW9ucykge1xuICAgICAgZWxlbWVudC5vZmYoJyRtZC5zd2lwZWxlZnQgJG1kLnN3aXBlcmlnaHQnLCBvcHRpb25zLm9uU3dpcGUpO1xuICAgICAgb3B0aW9ucy5wYXJlbnQucmVtb3ZlQ2xhc3ModG9hc3RPcGVuQ2xhc3Mob3B0aW9ucy5wb3NpdGlvbikpO1xuICAgICAgcmV0dXJuICRhbmltYXRlLmxlYXZlKGVsZW1lbnQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHRvYXN0T3BlbkNsYXNzKHBvc2l0aW9uKSB7XG4gICAgICByZXR1cm4gJ21kLXRvYXN0LW9wZW4tJyArXG4gICAgICAgIChwb3NpdGlvbi5pbmRleE9mKCd0b3AnKSA+IC0xID8gJ3RvcCcgOiAnYm90dG9tJyk7XG4gICAgfVxuICB9XG5cbn1cbk1kVG9hc3RQcm92aWRlci4kaW5qZWN0ID0gW1wiJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyXCJdO1xuXG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBAbmdkb2MgbW9kdWxlXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLnRvb2xiYXJcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMudG9vbGJhcicsIFtcbiAgJ21hdGVyaWFsLmNvcmUnLFxuICAnbWF0ZXJpYWwuY29tcG9uZW50cy5jb250ZW50J1xuXSlcbiAgLmRpcmVjdGl2ZSgnbWRUb29sYmFyJywgbWRUb29sYmFyRGlyZWN0aXZlKTtcblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBtZFRvb2xiYXJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy50b29sYmFyXG4gKiBAcmVzdHJpY3QgRVxuICogQGRlc2NyaXB0aW9uXG4gKiBgbWQtdG9vbGJhcmAgaXMgdXNlZCB0byBwbGFjZSBhIHRvb2xiYXIgaW4geW91ciBhcHAuXG4gKlxuICogVG9vbGJhcnMgYXJlIHVzdWFsbHkgdXNlZCBhYm92ZSBhIGNvbnRlbnQgYXJlYSB0byBkaXNwbGF5IHRoZSB0aXRsZSBvZiB0aGVcbiAqIGN1cnJlbnQgcGFnZSwgYW5kIHNob3cgcmVsZXZhbnQgYWN0aW9uIGJ1dHRvbnMgZm9yIHRoYXQgcGFnZS5cbiAqXG4gKiBZb3UgY2FuIGNoYW5nZSB0aGUgaGVpZ2h0IG9mIHRoZSB0b29sYmFyIGJ5IGFkZGluZyBlaXRoZXIgdGhlXG4gKiBgbWQtbWVkaXVtLXRhbGxgIG9yIGBtZC10YWxsYCBjbGFzcyB0byB0aGUgdG9vbGJhci5cbiAqXG4gKiBAdXNhZ2VcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiA8ZGl2IGxheW91dD1cImNvbHVtblwiIGxheW91dC1maWxsPlxuICogICA8bWQtdG9vbGJhcj5cbiAqXG4gKiAgICAgPGRpdiBjbGFzcz1cIm1kLXRvb2xiYXItdG9vbHNcIj5cbiAqICAgICAgIDxzcGFuPk15IEFwcCdzIFRpdGxlPC9zcGFuPlxuICpcbiAqICAgICAgIDwhLS0gZmlsbCB1cCB0aGUgc3BhY2UgYmV0d2VlbiBsZWZ0IGFuZCByaWdodCBhcmVhIC0tPlxuICogICAgICAgPHNwYW4gZmxleD48L3NwYW4+XG4gKlxuICogICAgICAgPG1kLWJ1dHRvbj5cbiAqICAgICAgICAgUmlnaHQgQmFyIEJ1dHRvblxuICogICAgICAgPC9tZC1idXR0b24+XG4gKiAgICAgPC9kaXY+XG4gKlxuICogICA8L21kLXRvb2xiYXI+XG4gKiAgIDxtZC1jb250ZW50PlxuICogICAgIEhlbGxvIVxuICogICA8L21kLWNvbnRlbnQ+XG4gKiA8L2Rpdj5cbiAqIDwvaGxqcz5cbiAqXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBtZC1zY3JvbGwtc2hyaW5rIFdoZXRoZXIgdGhlIGhlYWRlciBzaG91bGQgc2hyaW5rIGF3YXkgYXNcbiAqIHRoZSB1c2VyIHNjcm9sbHMgZG93biwgYW5kIHJldmVhbCBpdHNlbGYgYXMgdGhlIHVzZXIgc2Nyb2xscyB1cC5cbiAqIE5vdGU6IGZvciBzY3JvbGxTaHJpbmsgdG8gd29yaywgdGhlIHRvb2xiYXIgbXVzdCBiZSBhIHNpYmxpbmcgb2YgYVxuICogYG1kLWNvbnRlbnRgIGVsZW1lbnQsIHBsYWNlZCBiZWZvcmUgaXQuIFNlZSB0aGUgc2Nyb2xsIHNocmluayBkZW1vLlxuICpcbiAqXG4gKiBAcGFyYW0ge251bWJlcj19IG1kLXNocmluay1zcGVlZC1mYWN0b3IgSG93IG11Y2ggdG8gY2hhbmdlIHRoZSBzcGVlZCBvZiB0aGUgdG9vbGJhcidzXG4gKiBzaHJpbmtpbmcgYnkuIEZvciBleGFtcGxlLCBpZiAwLjI1IGlzIGdpdmVuIHRoZW4gdGhlIHRvb2xiYXIgd2lsbCBzaHJpbmtcbiAqIGF0IG9uZSBmb3VydGggdGhlIHJhdGUgYXQgd2hpY2ggdGhlIHVzZXIgc2Nyb2xscyBkb3duLiBEZWZhdWx0IDAuNS5cbiAqL1xuZnVuY3Rpb24gbWRUb29sYmFyRGlyZWN0aXZlKCQkckFGLCAkbWRDb25zdGFudCwgJG1kVXRpbCwgJG1kVGhlbWluZywgJGFuaW1hdGUsICR0aW1lb3V0KSB7XG5cbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0UnLFxuICAgIGNvbnRyb2xsZXI6IGFuZ3VsYXIubm9vcCxcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cikge1xuICAgICAgJG1kVGhlbWluZyhlbGVtZW50KTtcblxuICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHIubWRTY3JvbGxTaHJpbmspKSB7XG4gICAgICAgIHNldHVwU2Nyb2xsU2hyaW5rKCk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIHNldHVwU2Nyb2xsU2hyaW5rKCkge1xuICAgICAgICAvLyBDdXJyZW50IFwieVwiIHBvc2l0aW9uIG9mIHNjcm9sbFxuICAgICAgICB2YXIgeSA9IDA7XG4gICAgICAgIC8vIFN0b3JlIHRoZSBsYXN0IHNjcm9sbCB0b3AgcG9zaXRpb25cbiAgICAgICAgdmFyIHByZXZTY3JvbGxUb3AgPSAwO1xuXG4gICAgICAgIHZhciBzaHJpbmtTcGVlZEZhY3RvciA9IGF0dHIubWRTaHJpbmtTcGVlZEZhY3RvciB8fCAwLjU7XG5cbiAgICAgICAgdmFyIHRvb2xiYXJIZWlnaHQ7XG4gICAgICAgIHZhciBjb250ZW50RWxlbWVudDtcblxuICAgICAgICB2YXIgZGVib3VuY2VkQ29udGVudFNjcm9sbCA9ICQkckFGLnRocm90dGxlKG9uQ29udGVudFNjcm9sbCk7XG4gICAgICAgIHZhciBkZWJvdW5jZWRVcGRhdGVIZWlnaHQgPSAkbWRVdGlsLmRlYm91bmNlKHVwZGF0ZVRvb2xiYXJIZWlnaHQsIDUgKiAxMDAwKTtcblxuICAgICAgICAvLyBXYWl0IGZvciAkbWRDb250ZW50TG9hZGVkIGV2ZW50IGZyb20gbWRDb250ZW50IGRpcmVjdGl2ZS5cbiAgICAgICAgLy8gSWYgdGhlIG1kQ29udGVudCBlbGVtZW50IGlzIGEgc2libGluZyBvZiBvdXIgdG9vbGJhciwgaG9vayBpdCB1cFxuICAgICAgICAvLyB0byBzY3JvbGwgZXZlbnRzLlxuICAgICAgICBzY29wZS4kb24oJyRtZENvbnRlbnRMb2FkZWQnLCBvbk1kQ29udGVudExvYWQpO1xuXG4gICAgICAgIGZ1bmN0aW9uIG9uTWRDb250ZW50TG9hZCgkZXZlbnQsIG5ld0NvbnRlbnRFbCkge1xuICAgICAgICAgIC8vIFRvb2xiYXIgYW5kIGNvbnRlbnQgbXVzdCBiZSBzaWJsaW5nc1xuICAgICAgICAgIGlmIChlbGVtZW50LnBhcmVudCgpWzBdID09PSBuZXdDb250ZW50RWwucGFyZW50KClbMF0pIHtcbiAgICAgICAgICAgIC8vIHVuaG9vayBvbGQgY29udGVudCBldmVudCBsaXN0ZW5lciBpZiBleGlzdHNcbiAgICAgICAgICAgIGlmIChjb250ZW50RWxlbWVudCkge1xuICAgICAgICAgICAgICBjb250ZW50RWxlbWVudC5vZmYoJ3Njcm9sbCcsIGRlYm91bmNlZENvbnRlbnRTY3JvbGwpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBuZXdDb250ZW50RWwub24oJ3Njcm9sbCcsIGRlYm91bmNlZENvbnRlbnRTY3JvbGwpO1xuICAgICAgICAgICAgbmV3Q29udGVudEVsLmF0dHIoJ3Njcm9sbC1zaHJpbmsnLCAndHJ1ZScpO1xuXG4gICAgICAgICAgICBjb250ZW50RWxlbWVudCA9IG5ld0NvbnRlbnRFbDtcbiAgICAgICAgICAgICQkckFGKHVwZGF0ZVRvb2xiYXJIZWlnaHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVRvb2xiYXJIZWlnaHQoKSB7XG4gICAgICAgICAgdG9vbGJhckhlaWdodCA9IGVsZW1lbnQucHJvcCgnb2Zmc2V0SGVpZ2h0Jyk7XG4gICAgICAgICAgLy8gQWRkIGEgbmVnYXRpdmUgbWFyZ2luLXRvcCB0aGUgc2l6ZSBvZiB0aGUgdG9vbGJhciB0byB0aGUgY29udGVudCBlbC5cbiAgICAgICAgICAvLyBUaGUgY29udGVudCB3aWxsIHN0YXJ0IHRyYW5zZm9ybWVkIGRvd24gdGhlIHRvb2xiYXJIZWlnaHQgYW1vdW50LFxuICAgICAgICAgIC8vIHNvIGV2ZXJ5dGhpbmcgbG9va3Mgbm9ybWFsLlxuICAgICAgICAgIC8vXG4gICAgICAgICAgLy8gQXMgdGhlIHVzZXIgc2Nyb2xscyBkb3duLCB0aGUgY29udGVudCB3aWxsIGJlIHRyYW5zZm9ybWVkIHVwIHNsb3dseVxuICAgICAgICAgIC8vIHRvIHB1dCB0aGUgY29udGVudCB1bmRlcm5lYXRoIHdoZXJlIHRoZSB0b29sYmFyIHdhcy5cbiAgICAgICAgICB2YXIgbWFyZ2luID0gICgtdG9vbGJhckhlaWdodCAqIHNocmlua1NwZWVkRmFjdG9yKSArICdweCc7XG4gICAgICAgICAgY29udGVudEVsZW1lbnQuY3NzKCdtYXJnaW4tdG9wJywgbWFyZ2luKTtcbiAgICAgICAgICBjb250ZW50RWxlbWVudC5jc3MoJ21hcmdpbi1ib3R0b20nLCBtYXJnaW4pO1xuXG4gICAgICAgICAgb25Db250ZW50U2Nyb2xsKCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBvbkNvbnRlbnRTY3JvbGwoZSkge1xuICAgICAgICAgIHZhciBzY3JvbGxUb3AgPSBlID8gZS50YXJnZXQuc2Nyb2xsVG9wIDogcHJldlNjcm9sbFRvcDtcblxuICAgICAgICAgIGRlYm91bmNlZFVwZGF0ZUhlaWdodCgpO1xuXG4gICAgICAgICAgeSA9IE1hdGgubWluKFxuICAgICAgICAgICAgdG9vbGJhckhlaWdodCAvIHNocmlua1NwZWVkRmFjdG9yLFxuICAgICAgICAgICAgTWF0aC5tYXgoMCwgeSArIHNjcm9sbFRvcCAtIHByZXZTY3JvbGxUb3ApXG4gICAgICAgICAgKTtcblxuICAgICAgICAgIGVsZW1lbnQuY3NzKFxuICAgICAgICAgICAgJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STSxcbiAgICAgICAgICAgICd0cmFuc2xhdGUzZCgwLCcgKyAoLXkgKiBzaHJpbmtTcGVlZEZhY3RvcikgKyAncHgsMCknXG4gICAgICAgICAgKTtcbiAgICAgICAgICBjb250ZW50RWxlbWVudC5jc3MoXG4gICAgICAgICAgICAkbWRDb25zdGFudC5DU1MuVFJBTlNGT1JNLFxuICAgICAgICAgICAgJ3RyYW5zbGF0ZTNkKDAsJyArICgodG9vbGJhckhlaWdodCAtIHkpICogc2hyaW5rU3BlZWRGYWN0b3IpICsgJ3B4LDApJ1xuICAgICAgICAgICk7XG5cbiAgICAgICAgICBwcmV2U2Nyb2xsVG9wID0gc2Nyb2xsVG9wO1xuXG4gICAgICAgICAgICBpZiAoZWxlbWVudC5oYXNDbGFzcygnbWQtd2hpdGVmcmFtZS16MScpKSB7XG4gICAgICAgICAgICAgIGlmICgheSkge1xuICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHsgJGFuaW1hdGUucmVtb3ZlQ2xhc3MoZWxlbWVudCwgJ21kLXdoaXRlZnJhbWUtejEnKTsgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGlmICh5KSB7XG4gICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkgeyAkYW5pbWF0ZS5hZGRDbGFzcyhlbGVtZW50LCAnbWQtd2hpdGVmcmFtZS16MScpOyB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgIH1cblxuICAgIH1cbiAgfTtcblxufVxubWRUb29sYmFyRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkJHJBRlwiLCBcIiRtZENvbnN0YW50XCIsIFwiJG1kVXRpbFwiLCBcIiRtZFRoZW1pbmdcIiwgXCIkYW5pbWF0ZVwiLCBcIiR0aW1lb3V0XCJdO1xuXG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBAbmdkb2MgbW9kdWxlXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLnRvb2x0aXBcbiAqL1xuYW5ndWxhclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMudG9vbHRpcCcsIFsgJ21hdGVyaWFsLmNvcmUnIF0pXG4gICAgLmRpcmVjdGl2ZSgnbWRUb29sdGlwJywgTWRUb29sdGlwRGlyZWN0aXZlKTtcblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBtZFRvb2x0aXBcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy50b29sdGlwXG4gKiBAZGVzY3JpcHRpb25cbiAqIFRvb2x0aXBzIGFyZSB1c2VkIHRvIGRlc2NyaWJlIGVsZW1lbnRzIHRoYXQgYXJlIGludGVyYWN0aXZlIGFuZCBwcmltYXJpbHkgZ3JhcGhpY2FsIChub3QgdGV4dHVhbCkuXG4gKlxuICogUGxhY2UgYSBgPG1kLXRvb2x0aXA+YCBhcyBhIGNoaWxkIG9mIHRoZSBlbGVtZW50IGl0IGRlc2NyaWJlcy5cbiAqXG4gKiBBIHRvb2x0aXAgd2lsbCBhY3RpdmF0ZSB3aGVuIHRoZSB1c2VyIGZvY3VzZXMsIGhvdmVycyBvdmVyLCBvciB0b3VjaGVzIHRoZSBwYXJlbnQuXG4gKlxuICogQHVzYWdlXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxuICogPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLWZhYiBtZC1hY2NlbnRcIiBhcmlhLWxhYmVsPVwiUGxheVwiPlxuICogICA8bWQtdG9vbHRpcD5cbiAqICAgICBQbGF5IE11c2ljXG4gKiAgIDwvbWQtdG9vbHRpcD5cbiAqICAgPG1kLWljb24gaWNvbj1cImltZy9pY29ucy9pY19wbGF5X2Fycm93XzI0cHguc3ZnXCI+PC9tZC1pY29uPlxuICogPC9tZC1idXR0b24+XG4gKiA8L2hsanM+XG4gKlxuICogQHBhcmFtIHtleHByZXNzaW9uPX0gbWQtdmlzaWJsZSBCb29sZWFuIGJvdW5kIHRvIHdoZXRoZXIgdGhlIHRvb2x0aXAgaXNcbiAqIGN1cnJlbnRseSB2aXNpYmxlLlxuICogQHBhcmFtIHtudW1iZXI9fSBtZC1kZWxheSBIb3cgbWFueSBtaWxsaXNlY29uZHMgdG8gd2FpdCB0byBzaG93IHRoZSB0b29sdGlwIGFmdGVyIHRoZSB1c2VyIGZvY3VzZXMsIGhvdmVycywgb3IgdG91Y2hlcyB0aGUgcGFyZW50LiBEZWZhdWx0cyB0byA0MDBtcy5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gbWQtZGlyZWN0aW9uIFdoaWNoIGRpcmVjdGlvbiB3b3VsZCB5b3UgbGlrZSB0aGUgdG9vbHRpcCB0byBnbz8gIFN1cHBvcnRzIGxlZnQsIHJpZ2h0LCB0b3AsIGFuZCBib3R0b20uICBEZWZhdWx0cyB0byBib3R0b20uXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBtZC1hdXRvaGlkZSBJZiBwcmVzZW50IG9yIHByb3ZpZGVkIHdpdGggYSBib29sZWFuIHZhbHVlLCB0aGUgdG9vbHRpcCB3aWxsIGhpZGUgb24gbW91c2UgbGVhdmUsIHJlZ2FyZGxlc3Mgb2YgZm9jdXNcbiAqL1xuZnVuY3Rpb24gTWRUb29sdGlwRGlyZWN0aXZlKCR0aW1lb3V0LCAkd2luZG93LCAkJHJBRiwgJGRvY3VtZW50LCAkbWRVdGlsLCAkbWRUaGVtaW5nLCAkcm9vdEVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGFuaW1hdGUsICRxKSB7XG5cbiAgdmFyIFRPT0xUSVBfU0hPV19ERUxBWSA9IDMwMDtcbiAgdmFyIFRPT0xUSVBfV0lORE9XX0VER0VfU1BBQ0UgPSA4O1xuXG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdFJyxcbiAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgIHByaW9yaXR5OjIxMCwgLy8gQmVmb3JlIG5nQXJpYVxuICAgIHRlbXBsYXRlOiAnXFxcbiAgICAgICAgPGRpdiBjbGFzcz1cIm1kLWJhY2tncm91bmRcIj48L2Rpdj5cXFxuICAgICAgICA8ZGl2IGNsYXNzPVwibWQtY29udGVudFwiIG5nLXRyYW5zY2x1ZGU+PC9kaXY+JyxcbiAgICBzY29wZToge1xuICAgICAgdmlzaWJsZTogJz0/bWRWaXNpYmxlJyxcbiAgICAgIGRlbGF5OiAnPT9tZERlbGF5JyxcbiAgICAgIGF1dG9oaWRlOiAnPT9tZEF1dG9oaWRlJ1xuICAgIH0sXG4gICAgbGluazogcG9zdExpbmtcbiAgfTtcblxuICBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0cikge1xuXG4gICAgJG1kVGhlbWluZyhlbGVtZW50KTtcblxuICAgIHZhciBwYXJlbnQgICAgICAgID0gZ2V0UGFyZW50V2l0aFBvaW50ZXJFdmVudHMoKSxcbiAgICAgICAgYmFja2dyb3VuZCAgICA9IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50WzBdLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ21kLWJhY2tncm91bmQnKVswXSksXG4gICAgICAgIGNvbnRlbnQgICAgICAgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudFswXS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdtZC1jb250ZW50JylbMF0pLFxuICAgICAgICBkaXJlY3Rpb24gICAgID0gYXR0ci5tZERpcmVjdGlvbixcbiAgICAgICAgY3VycmVudCAgICAgICA9IGdldE5lYXJlc3RDb250ZW50RWxlbWVudCgpLFxuICAgICAgICB0b29sdGlwUGFyZW50ID0gYW5ndWxhci5lbGVtZW50KGN1cnJlbnQgfHwgZG9jdW1lbnQuYm9keSksXG4gICAgICAgIGRlYm91bmNlZE9uUmVzaXplID0gJCRyQUYudGhyb3R0bGUoZnVuY3Rpb24gKCkgeyBpZiAoc2NvcGUudmlzaWJsZSkgcG9zaXRpb25Ub29sdGlwKCk7IH0pO1xuXG4gICAgcmV0dXJuIGluaXQoKTtcblxuICAgIGZ1bmN0aW9uIGluaXQgKCkge1xuICAgICAgc2V0RGVmYXVsdHMoKTtcbiAgICAgIG1hbmlwdWxhdGVFbGVtZW50KCk7XG4gICAgICBiaW5kRXZlbnRzKCk7XG4gICAgICBjb25maWd1cmVXYXRjaGVycygpO1xuICAgICAgYWRkQXJpYUxhYmVsKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0RGVmYXVsdHMgKCkge1xuICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChhdHRyLm1kRGVsYXkpKSBzY29wZS5kZWxheSA9IFRPT0xUSVBfU0hPV19ERUxBWTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb25maWd1cmVXYXRjaGVycyAoKSB7XG4gICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHNjb3BlLnZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgZWxlbWVudC5yZW1vdmUoKTtcbiAgICAgICAgYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpLm9mZigncmVzaXplJywgZGVib3VuY2VkT25SZXNpemUpO1xuICAgICAgfSk7XG4gICAgICBzY29wZS4kd2F0Y2goJ3Zpc2libGUnLCBmdW5jdGlvbiAoaXNWaXNpYmxlKSB7XG4gICAgICAgIGlmIChpc1Zpc2libGUpIHNob3dUb29sdGlwKCk7XG4gICAgICAgIGVsc2UgaGlkZVRvb2x0aXAoKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZEFyaWFMYWJlbCAoKSB7XG4gICAgICBpZiAoIXBhcmVudC5hdHRyKCdhcmlhLWxhYmVsJykgJiYgIXBhcmVudC50ZXh0KCkudHJpbSgpKSB7XG4gICAgICAgIHBhcmVudC5hdHRyKCdhcmlhLWxhYmVsJywgZWxlbWVudC50ZXh0KCkudHJpbSgpKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBtYW5pcHVsYXRlRWxlbWVudCAoKSB7XG4gICAgICBlbGVtZW50LmRldGFjaCgpO1xuICAgICAgZWxlbWVudC5hdHRyKCdyb2xlJywgJ3Rvb2x0aXAnKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRQYXJlbnRXaXRoUG9pbnRlckV2ZW50cyAoKSB7XG4gICAgICB2YXIgcGFyZW50ID0gZWxlbWVudC5wYXJlbnQoKTtcbiAgICAgIHdoaWxlIChwYXJlbnQgJiYgJHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHBhcmVudFswXSlbJ3BvaW50ZXItZXZlbnRzJ10gPT0gJ25vbmUnKSB7XG4gICAgICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnQoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBwYXJlbnQ7XG4gICAgfVxuXG4gICAgIGZ1bmN0aW9uIGdldE5lYXJlc3RDb250ZW50RWxlbWVudCAoKSB7XG4gICAgICAgdmFyIGN1cnJlbnQgPSBlbGVtZW50LnBhcmVudCgpWzBdO1xuICAgICAgIC8vIExvb2sgZm9yIHRoZSBuZWFyZXN0IHBhcmVudCBtZC1jb250ZW50LCBzdG9wcGluZyBhdCB0aGUgcm9vdEVsZW1lbnQuXG4gICAgICAgd2hpbGUgKGN1cnJlbnQgJiYgY3VycmVudCAhPT0gJHJvb3RFbGVtZW50WzBdICYmIGN1cnJlbnQgIT09IGRvY3VtZW50LmJvZHkpIHtcbiAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50LnBhcmVudE5vZGU7XG4gICAgICAgfVxuICAgICAgIHJldHVybiBjdXJyZW50O1xuICAgICB9XG5cbiAgICBmdW5jdGlvbiBoYXNDb21wdXRlZFN0eWxlVmFsdWUoa2V5LCB2YWx1ZSkge1xuICAgICAgICAvLyBDaGVjayBpZiB3ZSBzaG91bGQgc2hvdyBpdCBvciBub3QuLi5cbiAgICAgICAgdmFyIGNvbXB1dGVkU3R5bGVzID0gJHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsZW1lbnRbMF0pO1xuICAgICAgICByZXR1cm4gYW5ndWxhci5pc0RlZmluZWQoY29tcHV0ZWRTdHlsZXNba2V5XSkgJiYgKGNvbXB1dGVkU3R5bGVzW2tleV0gPT0gdmFsdWUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGJpbmRFdmVudHMgKCkge1xuICAgICAgdmFyIG1vdXNlQWN0aXZlID0gZmFsc2U7XG4gICAgICB2YXIgZW50ZXJIYW5kbGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICghaGFzQ29tcHV0ZWRTdHlsZVZhbHVlKCdwb2ludGVyLWV2ZW50cycsJ25vbmUnKSkge1xuICAgICAgICAgIHNldFZpc2libGUodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICB2YXIgbGVhdmVIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXV0b2hpZGUgPSBzY29wZS5oYXNPd25Qcm9wZXJ0eSgnYXV0b2hpZGUnKSA/IHNjb3BlLmF1dG9oaWRlIDogYXR0ci5oYXNPd25Qcm9wZXJ0eSgnbWRBdXRvaGlkZScpO1xuICAgICAgICBpZiAoYXV0b2hpZGUgfHwgbW91c2VBY3RpdmUgfHwgKCRkb2N1bWVudFswXS5hY3RpdmVFbGVtZW50ICE9PSBwYXJlbnRbMF0pICkge1xuICAgICAgICAgIHNldFZpc2libGUoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIG1vdXNlQWN0aXZlID0gZmFsc2U7XG4gICAgICB9O1xuXG4gICAgICAvLyB0byBhdm9pZCBgc3ludGhldGljIGNsaWNrc2Agd2UgbGlzdGVuIHRvIG1vdXNlZG93biBpbnN0ZWFkIG9mIGBjbGlja2BcbiAgICAgIHBhcmVudC5vbignbW91c2Vkb3duJywgZnVuY3Rpb24oKSB7IG1vdXNlQWN0aXZlID0gdHJ1ZTsgfSk7XG4gICAgICBwYXJlbnQub24oJ2ZvY3VzIG1vdXNlZW50ZXIgdG91Y2hzdGFydCcsIGVudGVySGFuZGxlciApO1xuICAgICAgcGFyZW50Lm9uKCdibHVyIG1vdXNlbGVhdmUgdG91Y2hlbmQgdG91Y2hjYW5jZWwnLCBsZWF2ZUhhbmRsZXIgKTtcblxuXG4gICAgICBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdykub24oJ3Jlc2l6ZScsIGRlYm91bmNlZE9uUmVzaXplKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRWaXNpYmxlICh2YWx1ZSkge1xuICAgICAgc2V0VmlzaWJsZS52YWx1ZSA9ICEhdmFsdWU7XG4gICAgICBpZiAoIXNldFZpc2libGUucXVldWVkKSB7XG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgIHNldFZpc2libGUucXVldWVkID0gdHJ1ZTtcbiAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNjb3BlLnZpc2libGUgPSBzZXRWaXNpYmxlLnZhbHVlO1xuICAgICAgICAgICAgc2V0VmlzaWJsZS5xdWV1ZWQgPSBmYWxzZTtcbiAgICAgICAgICB9LCBzY29wZS5kZWxheSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7IHNjb3BlLnZpc2libGUgPSBmYWxzZTsgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzaG93VG9vbHRpcCgpIHtcbiAgICAgIC8vIEluc2VydCB0aGUgZWxlbWVudCBiZWZvcmUgcG9zaXRpb25pbmcgaXQsIHNvIHdlIGNhbiBnZXQgdGhlIHBvc2l0aW9uXG4gICAgICAvLyBhbmQgY2hlY2sgaWYgd2Ugc2hvdWxkIGRpc3BsYXkgaXRcbiAgICAgIHRvb2x0aXBQYXJlbnQuYXBwZW5kKGVsZW1lbnQpO1xuXG4gICAgICAvLyBDaGVjayBpZiB3ZSBzaG91bGQgZGlzcGxheSBpdCBvciBub3QuXG4gICAgICAvLyBUaGlzIGhhbmRsZXMgaGlkZS0qIGFuZCBzaG93LSogYWxvbmcgd2l0aCBhbnkgdXNlciBkZWZpbmVkIGNzc1xuICAgICAgaWYgKCBoYXNDb21wdXRlZFN0eWxlVmFsdWUoJ2Rpc3BsYXknLCdub25lJykgKSB7XG4gICAgICAgIHNjb3BlLnZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgZWxlbWVudC5kZXRhY2goKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBwb3NpdGlvblRvb2x0aXAoKTtcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChbZWxlbWVudCwgYmFja2dyb3VuZCwgY29udGVudF0sIGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICRhbmltYXRlLmFkZENsYXNzKGVsZW1lbnQsICdtZC1zaG93Jyk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBoaWRlVG9vbHRpcCgpIHtcbiAgICAgICRxLmFsbChbXG4gICAgICAgICRhbmltYXRlLnJlbW92ZUNsYXNzKGNvbnRlbnQsICdtZC1zaG93JyksXG4gICAgICAgICRhbmltYXRlLnJlbW92ZUNsYXNzKGJhY2tncm91bmQsICdtZC1zaG93JyksXG4gICAgICAgICRhbmltYXRlLnJlbW92ZUNsYXNzKGVsZW1lbnQsICdtZC1zaG93JylcbiAgICAgIF0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXNjb3BlLnZpc2libGUpIGVsZW1lbnQuZGV0YWNoKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwb3NpdGlvblRvb2x0aXAoKSB7XG4gICAgICB2YXIgdGlwUmVjdCA9ICRtZFV0aWwub2Zmc2V0UmVjdChlbGVtZW50LCB0b29sdGlwUGFyZW50KTtcbiAgICAgIHZhciBwYXJlbnRSZWN0ID0gJG1kVXRpbC5vZmZzZXRSZWN0KHBhcmVudCwgdG9vbHRpcFBhcmVudCk7XG4gICAgICB2YXIgbmV3UG9zaXRpb24gPSBnZXRQb3NpdGlvbihkaXJlY3Rpb24pO1xuXG4gICAgICAvLyBJZiB0aGUgdXNlciBwcm92aWRlZCBhIGRpcmVjdGlvbiwganVzdCBudWRnZSB0aGUgdG9vbHRpcCBvbnRvIHRoZSBzY3JlZW5cbiAgICAgIC8vIE90aGVyd2lzZSwgcmVjYWxjdWxhdGUgYmFzZWQgb24gJ3RvcCcgc2luY2UgZGVmYXVsdCBpcyAnYm90dG9tJ1xuICAgICAgaWYgKGRpcmVjdGlvbikge1xuICAgICAgICBuZXdQb3NpdGlvbiA9IGZpdEluUGFyZW50KG5ld1Bvc2l0aW9uKTtcbiAgICAgIH0gZWxzZSBpZiAobmV3UG9zaXRpb24udG9wID4gZWxlbWVudC5wcm9wKCdvZmZzZXRQYXJlbnQnKS5zY3JvbGxIZWlnaHQgLSB0aXBSZWN0LmhlaWdodCAtIFRPT0xUSVBfV0lORE9XX0VER0VfU1BBQ0UpIHtcbiAgICAgICAgbmV3UG9zaXRpb24gPSBmaXRJblBhcmVudChnZXRQb3NpdGlvbigndG9wJykpO1xuICAgICAgfVxuXG4gICAgICBlbGVtZW50LmNzcyh7dG9wOiBuZXdQb3NpdGlvbi50b3AgKyAncHgnLCBsZWZ0OiBuZXdQb3NpdGlvbi5sZWZ0ICsgJ3B4J30pO1xuXG4gICAgICBwb3NpdGlvbkJhY2tncm91bmQoKTtcblxuICAgICAgZnVuY3Rpb24gcG9zaXRpb25CYWNrZ3JvdW5kICgpIHtcbiAgICAgICAgdmFyIHNpemUgPSBkaXJlY3Rpb24gPT09ICdsZWZ0JyB8fCBkaXJlY3Rpb24gPT09ICdyaWdodCdcbiAgICAgICAgICAgICAgPyBNYXRoLnNxcnQoTWF0aC5wb3codGlwUmVjdC53aWR0aCwgMikgKyBNYXRoLnBvdyh0aXBSZWN0LmhlaWdodCAvIDIsIDIpKSAqIDJcbiAgICAgICAgICAgICAgOiBNYXRoLnNxcnQoTWF0aC5wb3codGlwUmVjdC53aWR0aCAvIDIsIDIpICsgTWF0aC5wb3codGlwUmVjdC5oZWlnaHQsIDIpKSAqIDIsXG4gICAgICAgICAgICBwb3NpdGlvbiA9IGRpcmVjdGlvbiA9PT0gJ2xlZnQnID8geyBsZWZ0OiAxMDAsIHRvcDogNTAgfVxuICAgICAgICAgICAgICA6IGRpcmVjdGlvbiA9PT0gJ3JpZ2h0JyA/IHsgbGVmdDogMCwgdG9wOiA1MCB9XG4gICAgICAgICAgICAgIDogZGlyZWN0aW9uID09PSAndG9wJyA/IHsgbGVmdDogNTAsIHRvcDogMTAwIH1cbiAgICAgICAgICAgICAgOiB7IGxlZnQ6IDUwLCB0b3A6IDAgfTtcbiAgICAgICAgYmFja2dyb3VuZC5jc3Moe1xuICAgICAgICAgIHdpZHRoOiBzaXplICsgJ3B4JyxcbiAgICAgICAgICBoZWlnaHQ6IHNpemUgKyAncHgnLFxuICAgICAgICAgIGxlZnQ6IHBvc2l0aW9uLmxlZnQgKyAnJScsXG4gICAgICAgICAgdG9wOiBwb3NpdGlvbi50b3AgKyAnJSdcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGZpdEluUGFyZW50IChwb3MpIHtcbiAgICAgICAgdmFyIG5ld1Bvc2l0aW9uID0geyBsZWZ0OiBwb3MubGVmdCwgdG9wOiBwb3MudG9wIH07XG4gICAgICAgIG5ld1Bvc2l0aW9uLmxlZnQgPSBNYXRoLm1pbiggbmV3UG9zaXRpb24ubGVmdCwgdG9vbHRpcFBhcmVudC5wcm9wKCdzY3JvbGxXaWR0aCcpIC0gdGlwUmVjdC53aWR0aCAtIFRPT0xUSVBfV0lORE9XX0VER0VfU1BBQ0UgKTtcbiAgICAgICAgbmV3UG9zaXRpb24ubGVmdCA9IE1hdGgubWF4KCBuZXdQb3NpdGlvbi5sZWZ0LCBUT09MVElQX1dJTkRPV19FREdFX1NQQUNFICk7XG4gICAgICAgIG5ld1Bvc2l0aW9uLnRvcCAgPSBNYXRoLm1pbiggbmV3UG9zaXRpb24udG9wLCAgdG9vbHRpcFBhcmVudC5wcm9wKCdzY3JvbGxIZWlnaHQnKSAtIHRpcFJlY3QuaGVpZ2h0IC0gVE9PTFRJUF9XSU5ET1dfRURHRV9TUEFDRSApO1xuICAgICAgICBuZXdQb3NpdGlvbi50b3AgID0gTWF0aC5tYXgoIG5ld1Bvc2l0aW9uLnRvcCwgIFRPT0xUSVBfV0lORE9XX0VER0VfU1BBQ0UgKTtcbiAgICAgICAgcmV0dXJuIG5ld1Bvc2l0aW9uO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBnZXRQb3NpdGlvbiAoZGlyKSB7XG4gICAgICAgIHJldHVybiBkaXIgPT09ICdsZWZ0J1xuICAgICAgICAgID8geyBsZWZ0OiBwYXJlbnRSZWN0LmxlZnQgLSB0aXBSZWN0LndpZHRoIC0gVE9PTFRJUF9XSU5ET1dfRURHRV9TUEFDRSxcbiAgICAgICAgICAgICAgdG9wOiBwYXJlbnRSZWN0LnRvcCArIHBhcmVudFJlY3QuaGVpZ2h0IC8gMiAtIHRpcFJlY3QuaGVpZ2h0IC8gMiB9XG4gICAgICAgICAgOiBkaXIgPT09ICdyaWdodCdcbiAgICAgICAgICA/IHsgbGVmdDogcGFyZW50UmVjdC5sZWZ0ICsgcGFyZW50UmVjdC53aWR0aCArIFRPT0xUSVBfV0lORE9XX0VER0VfU1BBQ0UsXG4gICAgICAgICAgICAgIHRvcDogcGFyZW50UmVjdC50b3AgKyBwYXJlbnRSZWN0LmhlaWdodCAvIDIgLSB0aXBSZWN0LmhlaWdodCAvIDIgfVxuICAgICAgICAgIDogZGlyID09PSAndG9wJ1xuICAgICAgICAgID8geyBsZWZ0OiBwYXJlbnRSZWN0LmxlZnQgKyBwYXJlbnRSZWN0LndpZHRoIC8gMiAtIHRpcFJlY3Qud2lkdGggLyAyLFxuICAgICAgICAgICAgICB0b3A6IHBhcmVudFJlY3QudG9wIC0gdGlwUmVjdC5oZWlnaHQgLSBUT09MVElQX1dJTkRPV19FREdFX1NQQUNFIH1cbiAgICAgICAgICA6IHsgbGVmdDogcGFyZW50UmVjdC5sZWZ0ICsgcGFyZW50UmVjdC53aWR0aCAvIDIgLSB0aXBSZWN0LndpZHRoIC8gMixcbiAgICAgICAgICAgICAgdG9wOiBwYXJlbnRSZWN0LnRvcCArIHBhcmVudFJlY3QuaGVpZ2h0ICsgVE9PTFRJUF9XSU5ET1dfRURHRV9TUEFDRSB9O1xuICAgICAgfVxuICAgIH1cblxuICB9XG5cbn1cbk1kVG9vbHRpcERpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJHRpbWVvdXRcIiwgXCIkd2luZG93XCIsIFwiJCRyQUZcIiwgXCIkZG9jdW1lbnRcIiwgXCIkbWRVdGlsXCIsIFwiJG1kVGhlbWluZ1wiLCBcIiRyb290RWxlbWVudFwiLCBcIiRhbmltYXRlXCIsIFwiJHFcIl07XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIEBuZ2RvYyBtb2R1bGVcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMud2hpdGVmcmFtZVxuICovXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy53aGl0ZWZyYW1lJywgW10pO1xuXG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuYXV0b2NvbXBsZXRlJylcbiAgICAuY29udHJvbGxlcignTWRBdXRvY29tcGxldGVDdHJsJywgTWRBdXRvY29tcGxldGVDdHJsKTtcblxudmFyIElURU1fSEVJR0hUID0gNDEsXG4gICAgTUFYX0hFSUdIVCA9IDUuNSAqIElURU1fSEVJR0hULFxuICAgIE1FTlVfUEFERElORyA9IDg7XG5cbmZ1bmN0aW9uIE1kQXV0b2NvbXBsZXRlQ3RybCAoJHNjb3BlLCAkZWxlbWVudCwgJG1kVXRpbCwgJG1kQ29uc3RhbnQsICR0aW1lb3V0LCAkbWRUaGVtaW5nLCAkd2luZG93LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYW5pbWF0ZSwgJHJvb3RFbGVtZW50LCAkYXR0cnMpIHtcbiAgLy8tLSBwcml2YXRlIHZhcmlhYmxlc1xuICB2YXIgY3RybCAgICAgID0gdGhpcyxcbiAgICAgIGl0ZW1QYXJ0cyA9ICRzY29wZS5pdGVtc0V4cHIuc3BsaXQoLyBpbiAvaSksXG4gICAgICBpdGVtRXhwciAgPSBpdGVtUGFydHNbMV0sXG4gICAgICBlbGVtZW50cyAgPSBudWxsLFxuICAgICAgcHJvbWlzZSAgID0gbnVsbCxcbiAgICAgIGNhY2hlICAgICA9IHt9LFxuICAgICAgbm9CbHVyICAgID0gZmFsc2UsXG4gICAgICBzZWxlY3RlZEl0ZW1XYXRjaGVycyA9IFtdLFxuICAgICAgaGFzRm9jdXMgID0gZmFsc2UsXG4gICAgICBsYXN0Q291bnQgPSAwO1xuXG4gIC8vLS0gcHVibGljIHZhcmlhYmxlcyB3aXRoIGhhbmRsZXJzXG4gIGRlZmluZVByb3BlcnR5KCdoaWRkZW4nLCBoYW5kbGVIaWRkZW5DaGFuZ2UsIHRydWUpO1xuXG4gIC8vLS0gcHVibGljIHZhcmlhYmxlc1xuICBjdHJsLnNjb3BlICAgICAgPSAkc2NvcGU7XG4gIGN0cmwucGFyZW50ICAgICA9ICRzY29wZS4kcGFyZW50O1xuICBjdHJsLml0ZW1OYW1lICAgPSBpdGVtUGFydHNbMF07XG4gIGN0cmwubWF0Y2hlcyAgICA9IFtdO1xuICBjdHJsLmxvYWRpbmcgICAgPSBmYWxzZTtcbiAgY3RybC5oaWRkZW4gICAgID0gdHJ1ZTtcbiAgY3RybC5pbmRleCAgICAgID0gbnVsbDtcbiAgY3RybC5tZXNzYWdlcyAgID0gW107XG4gIGN0cmwuaWQgICAgICAgICA9ICRtZFV0aWwubmV4dFVpZCgpO1xuICBjdHJsLmlzRGlzYWJsZWQgPSBudWxsO1xuICBjdHJsLmlzUmVxdWlyZWQgPSBudWxsO1xuXG4gIC8vLS0gcHVibGljIG1ldGhvZHNcbiAgY3RybC5rZXlkb3duICAgID0ga2V5ZG93bjtcbiAgY3RybC5ibHVyICAgICAgID0gYmx1cjtcbiAgY3RybC5mb2N1cyAgICAgID0gZm9jdXM7XG4gIGN0cmwuY2xlYXIgICAgICA9IGNsZWFyVmFsdWU7XG4gIGN0cmwuc2VsZWN0ICAgICA9IHNlbGVjdDtcbiAgY3RybC5saXN0RW50ZXIgID0gb25MaXN0RW50ZXI7XG4gIGN0cmwubGlzdExlYXZlICA9IG9uTGlzdExlYXZlO1xuICBjdHJsLm1vdXNlVXAgICAgPSBvbk1vdXNldXA7XG4gIGN0cmwuZ2V0Q3VycmVudERpc3BsYXlWYWx1ZSAgICAgICAgID0gZ2V0Q3VycmVudERpc3BsYXlWYWx1ZTtcbiAgY3RybC5yZWdpc3RlclNlbGVjdGVkSXRlbVdhdGNoZXIgICAgPSByZWdpc3RlclNlbGVjdGVkSXRlbVdhdGNoZXI7XG4gIGN0cmwudW5yZWdpc3RlclNlbGVjdGVkSXRlbVdhdGNoZXIgID0gdW5yZWdpc3RlclNlbGVjdGVkSXRlbVdhdGNoZXI7XG5cbiAgcmV0dXJuIGluaXQoKTtcblxuICAvLy0tIGluaXRpYWxpemF0aW9uIG1ldGhvZHNcblxuICAvKipcbiAgICogSW5pdGlhbGl6ZSB0aGUgY29udHJvbGxlciwgc2V0dXAgd2F0Y2hlcnMsIGdhdGhlciBlbGVtZW50c1xuICAgKi9cbiAgZnVuY3Rpb24gaW5pdCAoKSB7XG4gICAgJG1kVXRpbC5pbml0T3B0aW9uYWxQcm9wZXJ0aWVzKCRzY29wZSwgJGF0dHJzLCB7IHNlYXJjaFRleHQ6IG51bGwsIHNlbGVjdGVkSXRlbTogbnVsbCB9ICk7XG4gICAgJG1kVGhlbWluZygkZWxlbWVudCk7XG4gICAgY29uZmlndXJlV2F0Y2hlcnMoKTtcbiAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICBnYXRoZXJFbGVtZW50cygpO1xuICAgICAgZm9jdXNFbGVtZW50KCk7XG4gICAgICBtb3ZlRHJvcGRvd24oKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGVzIHRoZSBkcm9wZG93bidzIHBvc2l0aW9uIGFuZCBhcHBsaWVzIHRoZSBuZXcgc3R5bGVzIHRvIHRoZSBtZW51IGVsZW1lbnRcbiAgICogQHJldHVybnMgeyp9XG4gICAqL1xuICBmdW5jdGlvbiBwb3NpdGlvbkRyb3Bkb3duICgpIHtcbiAgICBpZiAoIWVsZW1lbnRzKSByZXR1cm4gJHRpbWVvdXQocG9zaXRpb25Ecm9wZG93biwgMCwgZmFsc2UpO1xuICAgIHZhciBocmVjdCAgPSBlbGVtZW50cy53cmFwLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICB2cmVjdCAgPSBlbGVtZW50cy5zbmFwLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICByb290ICAgPSBlbGVtZW50cy5yb290LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICB0b3AgICAgPSB2cmVjdC5ib3R0b20gLSByb290LnRvcCxcbiAgICAgICAgYm90ICAgID0gcm9vdC5ib3R0b20gLSB2cmVjdC50b3AsXG4gICAgICAgIGxlZnQgICA9IGhyZWN0LmxlZnQgLSByb290LmxlZnQsXG4gICAgICAgIHdpZHRoICA9IGhyZWN0LndpZHRoLFxuICAgICAgICBzdHlsZXMgPSB7XG4gICAgICAgICAgbGVmdDogICAgIGxlZnQgKyAncHgnLFxuICAgICAgICAgIG1pbldpZHRoOiB3aWR0aCArICdweCcsXG4gICAgICAgICAgbWF4V2lkdGg6IE1hdGgubWF4KGhyZWN0LnJpZ2h0IC0gcm9vdC5sZWZ0LCByb290LnJpZ2h0IC0gaHJlY3QubGVmdCkgLSBNRU5VX1BBRERJTkcgKyAncHgnXG4gICAgICAgIH07XG4gICAgaWYgKHRvcCA+IGJvdCAmJiByb290LmhlaWdodCAtIGhyZWN0LmJvdHRvbSAtIE1FTlVfUEFERElORyA8IE1BWF9IRUlHSFQpIHtcbiAgICAgIHN0eWxlcy50b3AgPSAnYXV0byc7XG4gICAgICBzdHlsZXMuYm90dG9tID0gYm90ICsgJ3B4JztcbiAgICAgIHN0eWxlcy5tYXhIZWlnaHQgPSBNYXRoLm1pbihNQVhfSEVJR0hULCBocmVjdC50b3AgLSByb290LnRvcCAtIE1FTlVfUEFERElORykgKyAncHgnO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdHlsZXMudG9wID0gdG9wICsgJ3B4JztcbiAgICAgIHN0eWxlcy5ib3R0b20gPSAnYXV0byc7XG4gICAgICBzdHlsZXMubWF4SGVpZ2h0ID0gTWF0aC5taW4oTUFYX0hFSUdIVCwgcm9vdC5ib3R0b20gLSBocmVjdC5ib3R0b20gLSBNRU5VX1BBRERJTkcpICsgJ3B4JztcbiAgICB9XG4gICAgZWxlbWVudHMuJC51bC5jc3Moc3R5bGVzKTtcbiAgICAkdGltZW91dChjb3JyZWN0SG9yaXpvbnRhbEFsaWdubWVudCwgMCwgZmFsc2UpO1xuXG4gICAgLyoqXG4gICAgICogTWFrZXMgc3VyZSB0aGF0IHRoZSBtZW51IGRvZXNuJ3QgZ28gb2ZmIG9mIHRoZSBzY3JlZW4gb24gZWl0aGVyIHNpZGUuXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29ycmVjdEhvcml6b250YWxBbGlnbm1lbnQgKCkge1xuICAgICAgdmFyIGRyb3Bkb3duID0gZWxlbWVudHMudWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICAgICAgc3R5bGVzICAgPSB7fTtcbiAgICAgIGlmIChkcm9wZG93bi5yaWdodCA+IHJvb3QucmlnaHQgLSBNRU5VX1BBRERJTkcpIHtcbiAgICAgICAgc3R5bGVzLmxlZnQgPSAoaHJlY3QucmlnaHQgLSBkcm9wZG93bi53aWR0aCkgKyAncHgnO1xuICAgICAgfVxuICAgICAgZWxlbWVudHMuJC51bC5jc3Moc3R5bGVzKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTW92ZXMgdGhlIGRyb3Bkb3duIG1lbnUgdG8gdGhlIGJvZHkgdGFnIGluIG9yZGVyIHRvIGF2b2lkIHotaW5kZXggYW5kIG92ZXJmbG93IGlzc3Vlcy5cbiAgICovXG4gIGZ1bmN0aW9uIG1vdmVEcm9wZG93biAoKSB7XG4gICAgaWYgKCFlbGVtZW50cy4kLnJvb3QubGVuZ3RoKSByZXR1cm47XG4gICAgJG1kVGhlbWluZyhlbGVtZW50cy4kLnVsKTtcbiAgICBlbGVtZW50cy4kLnVsLmRldGFjaCgpO1xuICAgIGVsZW1lbnRzLiQucm9vdC5hcHBlbmQoZWxlbWVudHMuJC51bCk7XG4gICAgaWYgKCRhbmltYXRlLnBpbikgJGFuaW1hdGUucGluKGVsZW1lbnRzLiQudWwsICRyb290RWxlbWVudCk7XG4gIH1cblxuICAvKipcbiAgICogU2VuZHMgZm9jdXMgdG8gdGhlIGlucHV0IGVsZW1lbnQuXG4gICAqL1xuICBmdW5jdGlvbiBmb2N1c0VsZW1lbnQgKCkge1xuICAgIGlmICgkc2NvcGUuYXV0b2ZvY3VzKSBlbGVtZW50cy5pbnB1dC5mb2N1cygpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdXAgYW55IHdhdGNoZXJzIHVzZWQgYnkgYXV0b2NvbXBsZXRlXG4gICAqL1xuICBmdW5jdGlvbiBjb25maWd1cmVXYXRjaGVycyAoKSB7XG4gICAgdmFyIHdhaXQgPSBwYXJzZUludCgkc2NvcGUuZGVsYXksIDEwKSB8fCAwO1xuICAgICRhdHRycy4kb2JzZXJ2ZSgnZGlzYWJsZWQnLCBmdW5jdGlvbiAodmFsdWUpIHsgY3RybC5pc0Rpc2FibGVkID0gdmFsdWU7IH0pO1xuICAgICRhdHRycy4kb2JzZXJ2ZSgncmVxdWlyZWQnLCBmdW5jdGlvbiAodmFsdWUpIHsgY3RybC5pc1JlcXVpcmVkID0gdmFsdWUgIT09IG51bGw7IH0pO1xuICAgICRzY29wZS4kd2F0Y2goJ3NlYXJjaFRleHQnLCB3YWl0ID8gJG1kVXRpbC5kZWJvdW5jZShoYW5kbGVTZWFyY2hUZXh0LCB3YWl0KSA6IGhhbmRsZVNlYXJjaFRleHQpO1xuICAgIHJlZ2lzdGVyU2VsZWN0ZWRJdGVtV2F0Y2hlcihzZWxlY3RlZEl0ZW1DaGFuZ2UpO1xuICAgICRzY29wZS4kd2F0Y2goJ3NlbGVjdGVkSXRlbScsIGhhbmRsZVNlbGVjdGVkSXRlbUNoYW5nZSk7XG4gICAgYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpLm9uKCdyZXNpemUnLCBwb3NpdGlvbkRyb3Bkb3duKTtcbiAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGNsZWFudXApO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZXMgYW55IGV2ZW50cyBvciBsZWZ0b3ZlciBlbGVtZW50cyBjcmVhdGVkIGJ5IHRoaXMgY29udHJvbGxlclxuICAgKi9cbiAgZnVuY3Rpb24gY2xlYW51cCAoKSB7XG4gICAgYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpLm9mZigncmVzaXplJywgcG9zaXRpb25Ecm9wZG93bik7XG4gICAgZWxlbWVudHMuJC51bC5yZW1vdmUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHYXRoZXJzIGFsbCBvZiB0aGUgZWxlbWVudHMgbmVlZGVkIGZvciB0aGlzIGNvbnRyb2xsZXJcbiAgICovXG4gIGZ1bmN0aW9uIGdhdGhlckVsZW1lbnRzICgpIHtcbiAgICBlbGVtZW50cyA9IHtcbiAgICAgIG1haW46ICAkZWxlbWVudFswXSxcbiAgICAgIHVsOiAgICAkZWxlbWVudC5maW5kKCd1bCcpWzBdLFxuICAgICAgaW5wdXQ6ICRlbGVtZW50LmZpbmQoJ2lucHV0JylbMF0sXG4gICAgICB3cmFwOiAgJGVsZW1lbnQuZmluZCgnbWQtYXV0b2NvbXBsZXRlLXdyYXAnKVswXSxcbiAgICAgIHJvb3Q6ICBkb2N1bWVudC5ib2R5XG4gICAgfTtcbiAgICBlbGVtZW50cy5saSA9IGVsZW1lbnRzLnVsLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdsaScpO1xuICAgIGVsZW1lbnRzLnNuYXAgPSBnZXRTbmFwVGFyZ2V0KCk7XG4gICAgZWxlbWVudHMuJCA9IGdldEFuZ3VsYXJFbGVtZW50cyhlbGVtZW50cyk7XG4gIH1cblxuICAvKipcbiAgICogRmluZHMgdGhlIGVsZW1lbnQgdGhhdCB0aGUgbWVudSB3aWxsIGJhc2UgaXRzIHBvc2l0aW9uIG9uXG4gICAqIEByZXR1cm5zIHsqfVxuICAgKi9cbiAgZnVuY3Rpb24gZ2V0U25hcFRhcmdldCAoKSB7XG4gICAgZm9yICh2YXIgZWxlbWVudCA9ICRlbGVtZW50OyBlbGVtZW50Lmxlbmd0aDsgZWxlbWVudCA9IGVsZW1lbnQucGFyZW50KCkpIHtcbiAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChlbGVtZW50LmF0dHIoJ21kLWF1dG9jb21wbGV0ZS1zbmFwJykpKSByZXR1cm4gZWxlbWVudFswXTtcbiAgICB9XG4gICAgcmV0dXJuIGVsZW1lbnRzLndyYXA7XG4gIH1cblxuICAvKipcbiAgICogR2F0aGVycyBhbmd1bGFyLXdyYXBwZWQgdmVyc2lvbnMgb2YgZWFjaCBlbGVtZW50XG4gICAqIEBwYXJhbSBlbGVtZW50c1xuICAgKiBAcmV0dXJucyB7e319XG4gICAqL1xuICBmdW5jdGlvbiBnZXRBbmd1bGFyRWxlbWVudHMgKGVsZW1lbnRzKSB7XG4gICAgdmFyIG9iaiA9IHt9O1xuICAgIGZvciAodmFyIGtleSBpbiBlbGVtZW50cykge1xuICAgICAgb2JqW2tleV0gPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudHNba2V5XSk7XG4gICAgfVxuICAgIHJldHVybiBvYmo7XG4gIH1cblxuICAvLy0tIGV2ZW50L2NoYW5nZSBoYW5kbGVyc1xuXG4gIC8qKlxuICAgKiBIYW5kbGVzIGNoYW5nZXMgdG8gdGhlIGBoaWRkZW5gIHByb3BlcnR5LlxuICAgKiBAcGFyYW0gaGlkZGVuXG4gICAqIEBwYXJhbSBvbGRIaWRkZW5cbiAgICovXG4gIGZ1bmN0aW9uIGhhbmRsZUhpZGRlbkNoYW5nZSAoaGlkZGVuLCBvbGRIaWRkZW4pIHtcbiAgICBpZiAoIWhpZGRlbiAmJiBvbGRIaWRkZW4pIHBvc2l0aW9uRHJvcGRvd24oKTtcbiAgICBpZiAoIWhpZGRlbikge1xuICAgICAgaWYgKGVsZW1lbnRzKSAkdGltZW91dChmdW5jdGlvbiAoKSB7ICRtZFV0aWwuZGlzYWJsZVNjcm9sbEFyb3VuZChlbGVtZW50cy51bCk7IH0sIDAsIGZhbHNlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJG1kVXRpbC5lbmFibGVTY3JvbGxpbmcoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogV2hlbiB0aGUgdXNlciBtb3VzZXMgb3ZlciB0aGUgZHJvcGRvd24gbWVudSwgaWdub3JlIGJsdXIgZXZlbnRzLlxuICAgKi9cbiAgZnVuY3Rpb24gb25MaXN0RW50ZXIgKCkge1xuICAgIG5vQmx1ciA9IHRydWU7XG4gIH1cblxuICAvKipcbiAgICogV2hlbiB0aGUgdXNlcidzIG1vdXNlIGxlYXZlcyB0aGUgbWVudSwgYmx1ciBldmVudHMgbWF5IGhpZGUgdGhlIG1lbnUgYWdhaW4uXG4gICAqL1xuICBmdW5jdGlvbiBvbkxpc3RMZWF2ZSAoKSB7XG4gICAgbm9CbHVyID0gZmFsc2U7XG4gICAgaWYgKCFoYXNGb2N1cykgY3RybC5oaWRkZW4gPSB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIFdoZW4gdGhlIG1vdXNlIGJ1dHRvbiBpcyByZWxlYXNlZCwgc2VuZCBmb2N1cyBiYWNrIHRvIHRoZSBpbnB1dCBmaWVsZC5cbiAgICovXG4gIGZ1bmN0aW9uIG9uTW91c2V1cCAoKSB7XG4gICAgZWxlbWVudHMuaW5wdXQuZm9jdXMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGVzIGNoYW5nZXMgdG8gdGhlIHNlbGVjdGVkIGl0ZW0uXG4gICAqIEBwYXJhbSBzZWxlY3RlZEl0ZW1cbiAgICogQHBhcmFtIHByZXZpb3VzU2VsZWN0ZWRJdGVtXG4gICAqL1xuICBmdW5jdGlvbiBzZWxlY3RlZEl0ZW1DaGFuZ2UgKHNlbGVjdGVkSXRlbSwgcHJldmlvdXNTZWxlY3RlZEl0ZW0pIHtcbiAgICBpZiAoc2VsZWN0ZWRJdGVtKSB7XG4gICAgICAkc2NvcGUuc2VhcmNoVGV4dCA9IGdldERpc3BsYXlWYWx1ZShzZWxlY3RlZEl0ZW0pO1xuICAgIH1cbiAgICBpZiAoYW5ndWxhci5pc0Z1bmN0aW9uKCRzY29wZS5pdGVtQ2hhbmdlKSAmJiBzZWxlY3RlZEl0ZW0gIT09IHByZXZpb3VzU2VsZWN0ZWRJdGVtKVxuICAgICAgJHNjb3BlLml0ZW1DaGFuZ2UoZ2V0SXRlbVNjb3BlKHNlbGVjdGVkSXRlbSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGxzIGFueSBleHRlcm5hbCB3YXRjaGVycyBsaXN0ZW5pbmcgZm9yIHRoZSBzZWxlY3RlZCBpdGVtLiAgVXNlZCBpbiBjb25qdW5jdGlvbiB3aXRoXG4gICAqIGByZWdpc3RlclNlbGVjdGVkSXRlbVdhdGNoZXJgLlxuICAgKiBAcGFyYW0gc2VsZWN0ZWRJdGVtXG4gICAqIEBwYXJhbSBwcmV2aW91c1NlbGVjdGVkSXRlbVxuICAgKi9cbiAgZnVuY3Rpb24gaGFuZGxlU2VsZWN0ZWRJdGVtQ2hhbmdlKHNlbGVjdGVkSXRlbSwgcHJldmlvdXNTZWxlY3RlZEl0ZW0pIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGVjdGVkSXRlbVdhdGNoZXJzLmxlbmd0aDsgKytpKSB7XG4gICAgICBzZWxlY3RlZEl0ZW1XYXRjaGVyc1tpXShzZWxlY3RlZEl0ZW0sIHByZXZpb3VzU2VsZWN0ZWRJdGVtKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVnaXN0ZXIgYSBmdW5jdGlvbiB0byBiZSBjYWxsZWQgd2hlbiB0aGUgc2VsZWN0ZWQgaXRlbSBjaGFuZ2VzLlxuICAgKiBAcGFyYW0gY2JcbiAgICovXG4gIGZ1bmN0aW9uIHJlZ2lzdGVyU2VsZWN0ZWRJdGVtV2F0Y2hlcihjYikge1xuICAgIGlmIChzZWxlY3RlZEl0ZW1XYXRjaGVycy5pbmRleE9mKGNiKSA9PSAtMSkge1xuICAgICAgc2VsZWN0ZWRJdGVtV2F0Y2hlcnMucHVzaChjYik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVucmVnaXN0ZXIgYSBmdW5jdGlvbiBwcmV2aW91c2x5IHJlZ2lzdGVyZWQgZm9yIHNlbGVjdGVkIGl0ZW0gY2hhbmdlcy5cbiAgICogQHBhcmFtIGNiXG4gICAqL1xuICBmdW5jdGlvbiB1bnJlZ2lzdGVyU2VsZWN0ZWRJdGVtV2F0Y2hlcihjYikge1xuICAgIHZhciBpID0gc2VsZWN0ZWRJdGVtV2F0Y2hlcnMuaW5kZXhPZihjYik7XG4gICAgaWYgKGkgIT0gLTEpIHtcbiAgICAgIHNlbGVjdGVkSXRlbVdhdGNoZXJzLnNwbGljZShpLCAxKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlcyBjaGFuZ2VzIHRvIHRoZSBzZWFyY2hUZXh0IHByb3BlcnR5LlxuICAgKiBAcGFyYW0gc2VhcmNoVGV4dFxuICAgKiBAcGFyYW0gcHJldmlvdXNTZWFyY2hUZXh0XG4gICAqL1xuICBmdW5jdGlvbiBoYW5kbGVTZWFyY2hUZXh0IChzZWFyY2hUZXh0LCBwcmV2aW91c1NlYXJjaFRleHQpIHtcbiAgICBjdHJsLmluZGV4ID0gZ2V0RGVmYXVsdEluZGV4KCk7XG4gICAgLy8tLSBkbyBub3RoaW5nIG9uIGluaXRcbiAgICBpZiAoc2VhcmNoVGV4dCA9PT0gcHJldmlvdXNTZWFyY2hUZXh0KSByZXR1cm47XG4gICAgLy8tLSBjbGVhciBzZWxlY3RlZCBpdGVtIGlmIHNlYXJjaCB0ZXh0IG5vIGxvbmdlciBtYXRjaGVzIGl0XG4gICAgaWYgKHNlYXJjaFRleHQgIT09IGdldERpc3BsYXlWYWx1ZSgkc2NvcGUuc2VsZWN0ZWRJdGVtKSkgJHNjb3BlLnNlbGVjdGVkSXRlbSA9IG51bGw7XG4gICAgZWxzZSByZXR1cm47XG4gICAgLy8tLSB0cmlnZ2VyIGNoYW5nZSBldmVudCBpZiBhdmFpbGFibGVcbiAgICBpZiAoYW5ndWxhci5pc0Z1bmN0aW9uKCRzY29wZS50ZXh0Q2hhbmdlKSAmJiBzZWFyY2hUZXh0ICE9PSBwcmV2aW91c1NlYXJjaFRleHQpXG4gICAgICAkc2NvcGUudGV4dENoYW5nZShnZXRJdGVtU2NvcGUoJHNjb3BlLnNlbGVjdGVkSXRlbSkpO1xuICAgIC8vLS0gY2FuY2VsIHJlc3VsdHMgaWYgc2VhcmNoIHRleHQgaXMgbm90IGxvbmcgZW5vdWdoXG4gICAgaWYgKCFpc01pbkxlbmd0aE1ldCgpKSB7XG4gICAgICBjdHJsLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgIGN0cmwubWF0Y2hlcyA9IFtdO1xuICAgICAgY3RybC5oaWRkZW4gPSBzaG91bGRIaWRlKCk7XG4gICAgICB1cGRhdGVNZXNzYWdlcygpO1xuICAgIH0gZWxzZSB7XG4gICAgICBoYW5kbGVRdWVyeSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGVzIGlucHV0IGJsdXIgZXZlbnQsIGRldGVybWluZXMgaWYgdGhlIGRyb3Bkb3duIHNob3VsZCBoaWRlLlxuICAgKi9cbiAgZnVuY3Rpb24gYmx1ciAoKSB7XG4gICAgaGFzRm9jdXMgPSBmYWxzZTtcbiAgICBpZiAoIW5vQmx1cikgY3RybC5oaWRkZW4gPSB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZXMgaW5wdXQgZm9jdXMgZXZlbnQsIGRldGVybWluZXMgaWYgdGhlIGRyb3Bkb3duIHNob3VsZCBzaG93LlxuICAgKi9cbiAgZnVuY3Rpb24gZm9jdXMgKCkge1xuICAgIGhhc0ZvY3VzID0gdHJ1ZTtcbiAgICAvLy0tIGlmIHNlYXJjaFRleHQgaXMgbnVsbCwgbGV0J3MgZm9yY2UgaXQgdG8gYmUgYSBzdHJpbmdcbiAgICBpZiAoIWFuZ3VsYXIuaXNTdHJpbmcoJHNjb3BlLnNlYXJjaFRleHQpKSAkc2NvcGUuc2VhcmNoVGV4dCA9ICcnO1xuICAgIGlmICgkc2NvcGUubWluTGVuZ3RoID4gMCkgcmV0dXJuO1xuICAgIGN0cmwuaGlkZGVuID0gc2hvdWxkSGlkZSgpO1xuICAgIGlmICghY3RybC5oaWRkZW4pIGhhbmRsZVF1ZXJ5KCk7XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlcyBrZXlib2FyZCBpbnB1dC5cbiAgICogQHBhcmFtIGV2ZW50XG4gICAqL1xuICBmdW5jdGlvbiBrZXlkb3duIChldmVudCkge1xuICAgIHN3aXRjaCAoZXZlbnQua2V5Q29kZSkge1xuICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5ET1dOX0FSUk9XOlxuICAgICAgICBpZiAoY3RybC5sb2FkaW5nKSByZXR1cm47XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGN0cmwuaW5kZXggPSBNYXRoLm1pbihjdHJsLmluZGV4ICsgMSwgY3RybC5tYXRjaGVzLmxlbmd0aCAtIDEpO1xuICAgICAgICB1cGRhdGVTY3JvbGwoKTtcbiAgICAgICAgdXBkYXRlTWVzc2FnZXMoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLlVQX0FSUk9XOlxuICAgICAgICBpZiAoY3RybC5sb2FkaW5nKSByZXR1cm47XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGN0cmwuaW5kZXggPSBjdHJsLmluZGV4IDwgMCA/IGN0cmwubWF0Y2hlcy5sZW5ndGggLSAxIDogTWF0aC5tYXgoMCwgY3RybC5pbmRleCAtIDEpO1xuICAgICAgICB1cGRhdGVTY3JvbGwoKTtcbiAgICAgICAgdXBkYXRlTWVzc2FnZXMoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLlRBQjpcbiAgICAgIGNhc2UgJG1kQ29uc3RhbnQuS0VZX0NPREUuRU5URVI6XG4gICAgICAgIGlmIChjdHJsLmhpZGRlbiB8fCBjdHJsLmxvYWRpbmcgfHwgY3RybC5pbmRleCA8IDAgfHwgY3RybC5tYXRjaGVzLmxlbmd0aCA8IDEpIHJldHVybjtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgc2VsZWN0KGN0cmwuaW5kZXgpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJG1kQ29uc3RhbnQuS0VZX0NPREUuRVNDQVBFOlxuICAgICAgICBjdHJsLm1hdGNoZXMgPSBbXTtcbiAgICAgICAgY3RybC5oaWRkZW4gPSB0cnVlO1xuICAgICAgICBjdHJsLmluZGV4ID0gZ2V0RGVmYXVsdEluZGV4KCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICB9XG4gIH1cblxuICAvLy0tIGdldHRlcnNcblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgbWluaW11bSBsZW5ndGggbmVlZGVkIHRvIGRpc3BsYXkgdGhlIGRyb3Bkb3duLlxuICAgKiBAcmV0dXJucyB7Kn1cbiAgICovXG4gIGZ1bmN0aW9uIGdldE1pbkxlbmd0aCAoKSB7XG4gICAgcmV0dXJuIGFuZ3VsYXIuaXNOdW1iZXIoJHNjb3BlLm1pbkxlbmd0aCkgPyAkc2NvcGUubWluTGVuZ3RoIDogMTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBkaXNwbGF5IHZhbHVlIGZvciBhbiBpdGVtLlxuICAgKiBAcGFyYW0gaXRlbVxuICAgKiBAcmV0dXJucyB7Kn1cbiAgICovXG4gIGZ1bmN0aW9uIGdldERpc3BsYXlWYWx1ZSAoaXRlbSkge1xuICAgIHJldHVybiAoaXRlbSAmJiAkc2NvcGUuaXRlbVRleHQpID8gJHNjb3BlLml0ZW1UZXh0KGdldEl0ZW1TY29wZShpdGVtKSkgOiBpdGVtO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGxvY2FscyBvYmplY3QgZm9yIGNvbXBpbGluZyBpdGVtIHRlbXBsYXRlcy5cbiAgICogQHBhcmFtIGl0ZW1cbiAgICogQHJldHVybnMge3t9fVxuICAgKi9cbiAgZnVuY3Rpb24gZ2V0SXRlbVNjb3BlIChpdGVtKSB7XG4gICAgaWYgKCFpdGVtKSByZXR1cm47XG4gICAgdmFyIGxvY2FscyA9IHt9O1xuICAgIGlmIChjdHJsLml0ZW1OYW1lKSBsb2NhbHNbY3RybC5pdGVtTmFtZV0gPSBpdGVtO1xuICAgIHJldHVybiBsb2NhbHM7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgZGVmYXVsdCBpbmRleCBiYXNlZCBvbiB3aGV0aGVyIG9yIG5vdCBhdXRvc2VsZWN0IGlzIGVuYWJsZWQuXG4gICAqIEByZXR1cm5zIHtudW1iZXJ9XG4gICAqL1xuICBmdW5jdGlvbiBnZXREZWZhdWx0SW5kZXggKCkge1xuICAgIHJldHVybiAkc2NvcGUuYXV0b3NlbGVjdCA/IDAgOiAtMTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmVzIGlmIHRoZSBtZW51IHNob3VsZCBiZSBoaWRkZW4uXG4gICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgKi9cbiAgZnVuY3Rpb24gc2hvdWxkSGlkZSAoKSB7XG4gICAgaWYgKCFpc01pbkxlbmd0aE1ldCgpKSByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBkaXNwbGF5IHZhbHVlIG9mIHRoZSBjdXJyZW50IGl0ZW0uXG4gICAqIEByZXR1cm5zIHsqfVxuICAgKi9cbiAgZnVuY3Rpb24gZ2V0Q3VycmVudERpc3BsYXlWYWx1ZSAoKSB7XG4gICAgcmV0dXJuIGdldERpc3BsYXlWYWx1ZShjdHJsLm1hdGNoZXNbY3RybC5pbmRleF0pO1xuICB9XG5cbiAgLyoqXG4gICAqIERldGVybWluZXMgaWYgdGhlIG1pbmltdW0gbGVuZ3RoIGlzIG1ldCBieSB0aGUgc2VhcmNoIHRleHQuXG4gICAqIEByZXR1cm5zIHsqfVxuICAgKi9cbiAgZnVuY3Rpb24gaXNNaW5MZW5ndGhNZXQgKCkge1xuICAgIHJldHVybiBhbmd1bGFyLmlzRGVmaW5lZCgkc2NvcGUuc2VhcmNoVGV4dCkgJiYgJHNjb3BlLnNlYXJjaFRleHQubGVuZ3RoID49IGdldE1pbkxlbmd0aCgpO1xuICB9XG5cbiAgLy8tLSBhY3Rpb25zXG5cbiAgLyoqXG4gICAqIERlZmluZXMgYSBwdWJsaWMgcHJvcGVydHkgd2l0aCBhIGhhbmRsZXIgYW5kIGEgZGVmYXVsdCB2YWx1ZS5cbiAgICogQHBhcmFtIGtleVxuICAgKiBAcGFyYW0gaGFuZGxlclxuICAgKiBAcGFyYW0gdmFsdWVcbiAgICovXG4gIGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5IChrZXksIGhhbmRsZXIsIHZhbHVlKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGN0cmwsIGtleSwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB2YWx1ZTsgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBvbGRWYWx1ZSA9IHZhbHVlO1xuICAgICAgICB2YWx1ZSA9IG5ld1ZhbHVlO1xuICAgICAgICBoYW5kbGVyKG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogU2VsZWN0cyB0aGUgaXRlbSBhdCB0aGUgZ2l2ZW4gaW5kZXguXG4gICAqIEBwYXJhbSBpbmRleFxuICAgKi9cbiAgZnVuY3Rpb24gc2VsZWN0IChpbmRleCkge1xuICAgICRzY29wZS5zZWxlY3RlZEl0ZW0gPSBjdHJsLm1hdGNoZXNbaW5kZXhdO1xuICAgIGN0cmwuaGlkZGVuID0gdHJ1ZTtcbiAgICBjdHJsLmluZGV4ID0gMDtcbiAgICBjdHJsLm1hdGNoZXMgPSBbXTtcbiAgICAvLy0tIGZvcmNlIGZvcm0gdG8gdXBkYXRlIHN0YXRlIGZvciB2YWxpZGF0aW9uXG4gICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgZWxlbWVudHMuJC5pbnB1dC5jb250cm9sbGVyKCduZ01vZGVsJykuJHNldFZpZXdWYWx1ZShnZXREaXNwbGF5VmFsdWUoJHNjb3BlLnNlbGVjdGVkSXRlbSkgfHxcbiAgICAgICAgICAkc2NvcGUuc2VhcmNoVGV4dCk7XG4gICAgICBjdHJsLmhpZGRlbiA9IHRydWU7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQ2xlYXJzIHRoZSBzZWFyY2hUZXh0IHZhbHVlIGFuZCBzZWxlY3RlZCBpdGVtLlxuICAgKi9cbiAgZnVuY3Rpb24gY2xlYXJWYWx1ZSAoKSB7XG4gICAgJHNjb3BlLnNlYXJjaFRleHQgPSAnJztcbiAgICBzZWxlY3QoLTEpO1xuXG4gICAgLy8gUGVyIGh0dHA6Ly93d3cudzNzY2hvb2xzLmNvbS9qc3JlZi9ldmVudF9vbmlucHV0LmFzcFxuICAgIHZhciBldmVudE9iaiA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xuICAgIGV2ZW50T2JqLmluaXRDdXN0b21FdmVudCgnaW5wdXQnLCB0cnVlLCB0cnVlLCB7dmFsdWU6ICRzY29wZS5zZWFyY2hUZXh0fSk7XG4gICAgZWxlbWVudHMuaW5wdXQuZGlzcGF0Y2hFdmVudChldmVudE9iaik7XG5cbiAgICBlbGVtZW50cy5pbnB1dC5mb2N1cygpO1xuICB9XG5cbiAgLyoqXG4gICAqIEZldGNoZXMgdGhlIHJlc3VsdHMgZm9yIHRoZSBwcm92aWRlZCBzZWFyY2ggdGV4dC5cbiAgICogQHBhcmFtIHNlYXJjaFRleHRcbiAgICovXG4gIGZ1bmN0aW9uIGZldGNoUmVzdWx0cyAoc2VhcmNoVGV4dCkge1xuICAgIHZhciBpdGVtcyA9ICRzY29wZS4kcGFyZW50LiRldmFsKGl0ZW1FeHByKSxcbiAgICAgICAgdGVybSA9IHNlYXJjaFRleHQudG9Mb3dlckNhc2UoKTtcbiAgICBpZiAoYW5ndWxhci5pc0FycmF5KGl0ZW1zKSkge1xuICAgICAgaGFuZGxlUmVzdWx0cyhpdGVtcyk7XG4gICAgfSBlbHNlIGlmIChpdGVtcykge1xuICAgICAgY3RybC5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgIGlmIChpdGVtcy5zdWNjZXNzKSBpdGVtcy5zdWNjZXNzKGhhbmRsZVJlc3VsdHMpO1xuICAgICAgaWYgKGl0ZW1zLnRoZW4pICAgIGl0ZW1zLnRoZW4oaGFuZGxlUmVzdWx0cyk7XG4gICAgICBpZiAoaXRlbXMuZXJyb3IpICAgaXRlbXMuZXJyb3IoZnVuY3Rpb24gKCkgeyBjdHJsLmxvYWRpbmcgPSBmYWxzZTsgfSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGhhbmRsZVJlc3VsdHMgKG1hdGNoZXMpIHtcbiAgICAgIGNhY2hlW3Rlcm1dID0gbWF0Y2hlcztcbiAgICAgIGlmIChzZWFyY2hUZXh0ICE9PSAkc2NvcGUuc2VhcmNoVGV4dCkgcmV0dXJuOyAvLy0tIGp1c3QgY2FjaGUgdGhlIHJlc3VsdHMgaWYgb2xkIHJlcXVlc3RcbiAgICAgIGN0cmwubG9hZGluZyA9IGZhbHNlO1xuICAgICAgcHJvbWlzZSA9IG51bGw7XG4gICAgICBjdHJsLm1hdGNoZXMgPSBtYXRjaGVzO1xuICAgICAgY3RybC5oaWRkZW4gPSBzaG91bGRIaWRlKCk7XG4gICAgICB1cGRhdGVNZXNzYWdlcygpO1xuICAgICAgcG9zaXRpb25Ecm9wZG93bigpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBBUklBIG1lc3NhZ2VzXG4gICAqL1xuICBmdW5jdGlvbiB1cGRhdGVNZXNzYWdlcyAoKSB7XG4gICAgY3RybC5tZXNzYWdlcyA9IFsgZ2V0Q291bnRNZXNzYWdlKCksIGdldEN1cnJlbnREaXNwbGF5VmFsdWUoKSBdO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIEFSSUEgbWVzc2FnZSBmb3IgaG93IG1hbnkgcmVzdWx0cyBtYXRjaCB0aGUgY3VycmVudCBxdWVyeS5cbiAgICogQHJldHVybnMgeyp9XG4gICAqL1xuICBmdW5jdGlvbiBnZXRDb3VudE1lc3NhZ2UgKCkge1xuICAgIGlmIChsYXN0Q291bnQgPT09IGN0cmwubWF0Y2hlcy5sZW5ndGgpIHJldHVybiAnJztcbiAgICBsYXN0Q291bnQgPSBjdHJsLm1hdGNoZXMubGVuZ3RoO1xuICAgIHN3aXRjaCAoY3RybC5tYXRjaGVzLmxlbmd0aCkge1xuICAgICAgY2FzZSAwOiAgcmV0dXJuICdUaGVyZSBhcmUgbm8gbWF0Y2hlcyBhdmFpbGFibGUuJztcbiAgICAgIGNhc2UgMTogIHJldHVybiAnVGhlcmUgaXMgMSBtYXRjaCBhdmFpbGFibGUuJztcbiAgICAgIGRlZmF1bHQ6IHJldHVybiAnVGhlcmUgYXJlICcgKyBjdHJsLm1hdGNoZXMubGVuZ3RoICsgJyBtYXRjaGVzIGF2YWlsYWJsZS4nO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBNYWtlcyBzdXJlIHRoYXQgdGhlIGZvY3VzZWQgZWxlbWVudCBpcyB3aXRoaW4gdmlldy5cbiAgICovXG4gIGZ1bmN0aW9uIHVwZGF0ZVNjcm9sbCAoKSB7XG4gICAgaWYgKCFlbGVtZW50cy5saVtjdHJsLmluZGV4XSkgcmV0dXJuO1xuICAgIHZhciBsaSAgPSBlbGVtZW50cy5saVtjdHJsLmluZGV4XSxcbiAgICAgICAgdG9wID0gbGkub2Zmc2V0VG9wLFxuICAgICAgICBib3QgPSB0b3AgKyBsaS5vZmZzZXRIZWlnaHQsXG4gICAgICAgIGhndCA9IGVsZW1lbnRzLnVsLmNsaWVudEhlaWdodDtcbiAgICBpZiAodG9wIDwgZWxlbWVudHMudWwuc2Nyb2xsVG9wKSB7XG4gICAgICBlbGVtZW50cy51bC5zY3JvbGxUb3AgPSB0b3A7XG4gICAgfSBlbHNlIGlmIChib3QgPiBlbGVtZW50cy51bC5zY3JvbGxUb3AgKyBoZ3QpIHtcbiAgICAgIGVsZW1lbnRzLnVsLnNjcm9sbFRvcCA9IGJvdCAtIGhndDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU3RhcnRzIHRoZSBxdWVyeSB0byBnYXRoZXIgdGhlIHJlc3VsdHMgZm9yIHRoZSBjdXJyZW50IHNlYXJjaFRleHQuICBBdHRlbXB0cyB0byByZXR1cm4gY2FjaGVkXG4gICAqIHJlc3VsdHMgZmlyc3QsIHRoZW4gZm9yd2FyZHMgdGhlIHByb2Nlc3MgdG8gYGZldGNoUmVzdWx0c2AgaWYgbmVjZXNzYXJ5LlxuICAgKi9cbiAgZnVuY3Rpb24gaGFuZGxlUXVlcnkgKCkge1xuICAgIHZhciBzZWFyY2hUZXh0ID0gJHNjb3BlLnNlYXJjaFRleHQsXG4gICAgICAgIHRlcm0gPSBzZWFyY2hUZXh0LnRvTG93ZXJDYXNlKCk7XG4gICAgLy8tLSBjYW5jZWwgcHJvbWlzZSBpZiBhIHByb21pc2UgaXMgaW4gcHJvZ3Jlc3NcbiAgICBpZiAocHJvbWlzZSAmJiBwcm9taXNlLmNhbmNlbCkge1xuICAgICAgcHJvbWlzZS5jYW5jZWwoKTtcbiAgICAgIHByb21pc2UgPSBudWxsO1xuICAgIH1cbiAgICAvLy0tIGlmIHJlc3VsdHMgYXJlIGNhY2hlZCwgcHVsbCBpbiBjYWNoZWQgcmVzdWx0c1xuICAgIGlmICghJHNjb3BlLm5vQ2FjaGUgJiYgY2FjaGVbdGVybV0pIHtcbiAgICAgIGN0cmwubWF0Y2hlcyA9IGNhY2hlW3Rlcm1dO1xuICAgICAgdXBkYXRlTWVzc2FnZXMoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZmV0Y2hSZXN1bHRzKHNlYXJjaFRleHQpO1xuICAgIH1cbiAgICBpZiAoaGFzRm9jdXMpIGN0cmwuaGlkZGVuID0gc2hvdWxkSGlkZSgpO1xuICB9XG5cbn1cbk1kQXV0b2NvbXBsZXRlQ3RybC4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiJGVsZW1lbnRcIiwgXCIkbWRVdGlsXCIsIFwiJG1kQ29uc3RhbnRcIiwgXCIkdGltZW91dFwiLCBcIiRtZFRoZW1pbmdcIiwgXCIkd2luZG93XCIsIFwiJGFuaW1hdGVcIiwgXCIkcm9vdEVsZW1lbnRcIiwgXCIkYXR0cnNcIl07XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5hdXRvY29tcGxldGUnKVxuICAgIC5kaXJlY3RpdmUoJ21kQXV0b2NvbXBsZXRlJywgTWRBdXRvY29tcGxldGUpO1xuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG1kQXV0b2NvbXBsZXRlXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuYXV0b2NvbXBsZXRlXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBgPG1kLWF1dG9jb21wbGV0ZT5gIGlzIGEgc3BlY2lhbCBpbnB1dCBjb21wb25lbnQgd2l0aCBhIGRyb3AtZG93biBvZiBhbGwgcG9zc2libGUgbWF0Y2hlcyB0byBhIGN1c3RvbSBxdWVyeS5cbiAqIFRoaXMgY29tcG9uZW50IGFsbG93cyB5b3UgdG8gcHJvdmlkZSByZWFsLXRpbWUgc3VnZ2VzdGlvbnMgYXMgdGhlIHVzZXIgdHlwZXMgaW4gdGhlIGlucHV0IGFyZWEuXG4gKlxuICogVG8gc3RhcnQsIHlvdSB3aWxsIG5lZWQgdG8gc3BlY2lmeSB0aGUgcmVxdWlyZWQgcGFyYW1ldGVycyBhbmQgcHJvdmlkZSBhIHRlbXBsYXRlIGZvciB5b3VyIHJlc3VsdHMuXG4gKiBUaGUgY29udGVudCBpbnNpZGUgYG1kLWF1dG9jb21wbGV0ZWAgd2lsbCBiZSB0cmVhdGVkIGFzIGEgdGVtcGxhdGUuXG4gKlxuICogSW4gbW9yZSBjb21wbGV4IGNhc2VzLCB5b3UgbWF5IHdhbnQgdG8gaW5jbHVkZSBvdGhlciBjb250ZW50IHN1Y2ggYXMgYSBtZXNzYWdlIHRvIGRpc3BsYXkgd2hlblxuICogbm8gbWF0Y2hlcyB3ZXJlIGZvdW5kLiAgWW91IGNhbiBkbyB0aGlzIGJ5IHdyYXBwaW5nIHlvdXIgdGVtcGxhdGUgaW4gYG1kLWl0ZW0tdGVtcGxhdGVgIGFuZCBhZGRpbmdcbiAqIGEgdGFnIGZvciBgbWQtbm90LWZvdW5kYC4gIEFuIGV4YW1wbGUgb2YgdGhpcyBpcyBzaG93biBiZWxvdy5cbiAqICMjIyBWYWxpZGF0aW9uXG4gKlxuICogWW91IGNhbiB1c2UgYG5nLW1lc3NhZ2VzYCB0byBpbmNsdWRlIHZhbGlkYXRpb24gdGhlIHNhbWUgd2F5IHRoYXQgeW91IHdvdWxkIG5vcm1hbGx5IHZhbGlkYXRlO1xuICogaG93ZXZlciwgaWYgeW91IHdhbnQgdG8gcmVwbGljYXRlIGEgc3RhbmRhcmQgaW5wdXQgd2l0aCBhIGZsb2F0aW5nIGxhYmVsLCB5b3Ugd2lsbCBoYXZlIHRvIGRvIHRoZVxuICogZm9sbG93aW5nOlxuICpcbiAqIC0gTWFrZSBzdXJlIHRoYXQgeW91ciB0ZW1wbGF0ZSBpcyB3cmFwcGVkIGluIGBtZC1pdGVtLXRlbXBsYXRlYFxuICogLSBBZGQgeW91ciBgbmctbWVzc2FnZXNgIGNvZGUgaW5zaWRlIG9mIGBtZC1hdXRvY29tcGxldGVgXG4gKiAtIEFkZCB5b3VyIHZhbGlkYXRpb24gcHJvcGVydGllcyB0byBgbWQtYXV0b2NvbXBsZXRlYCAoaWUuIGByZXF1aXJlZGApXG4gKiAtIEFkZCBhIGBuYW1lYCB0byBgbWQtYXV0b2NvbXBsZXRlYCAodG8gYmUgdXNlZCBvbiB0aGUgZ2VuZXJhdGVkIGBpbnB1dGApXG4gKlxuICogVGhlcmUgaXMgYW4gZXhhbXBsZSBiZWxvdyBvZiBob3cgdGhpcyBzaG91bGQgbG9vay5cbiAqXG4gKlxuICogQHBhcmFtIHtleHByZXNzaW9ufSBtZC1pdGVtcyBBbiBleHByZXNzaW9uIGluIHRoZSBmb3JtYXQgb2YgYGl0ZW0gaW4gaXRlbXNgIHRvIGl0ZXJhdGUgb3ZlciBtYXRjaGVzIGZvciB5b3VyIHNlYXJjaC5cbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbj19IG1kLXNlbGVjdGVkLWl0ZW0tY2hhbmdlIEFuIGV4cHJlc3Npb24gdG8gYmUgcnVuIGVhY2ggdGltZSBhIG5ldyBpdGVtIGlzIHNlbGVjdGVkXG4gKiBAcGFyYW0ge2V4cHJlc3Npb249fSBtZC1zZWFyY2gtdGV4dC1jaGFuZ2UgQW4gZXhwcmVzc2lvbiB0byBiZSBydW4gZWFjaCB0aW1lIHRoZSBzZWFyY2ggdGV4dCB1cGRhdGVzXG4gKiBAcGFyYW0ge3N0cmluZz19IG1kLXNlYXJjaC10ZXh0IEEgbW9kZWwgdG8gYmluZCB0aGUgc2VhcmNoIHF1ZXJ5IHRleHQgdG9cbiAqIEBwYXJhbSB7b2JqZWN0PX0gbWQtc2VsZWN0ZWQtaXRlbSBBIG1vZGVsIHRvIGJpbmQgdGhlIHNlbGVjdGVkIGl0ZW0gdG9cbiAqIEBwYXJhbSB7c3RyaW5nPX0gbWQtaXRlbS10ZXh0IEFuIGV4cHJlc3Npb24gdGhhdCB3aWxsIGNvbnZlcnQgeW91ciBvYmplY3QgdG8gYSBzaW5nbGUgc3RyaW5nLlxuICogQHBhcmFtIHtzdHJpbmc9fSBwbGFjZWhvbGRlciBQbGFjZWhvbGRlciB0ZXh0IHRoYXQgd2lsbCBiZSBmb3J3YXJkZWQgdG8gdGhlIGlucHV0LlxuICogQHBhcmFtIHtib29sZWFuPX0gbWQtbm8tY2FjaGUgRGlzYWJsZXMgdGhlIGludGVybmFsIGNhY2hpbmcgdGhhdCBoYXBwZW5zIGluIGF1dG9jb21wbGV0ZVxuICogQHBhcmFtIHtib29sZWFuPX0gbmctZGlzYWJsZWQgRGV0ZXJtaW5lcyB3aGV0aGVyIG9yIG5vdCB0byBkaXNhYmxlIHRoZSBpbnB1dCBmaWVsZFxuICogQHBhcmFtIHtudW1iZXI9fSBtZC1taW4tbGVuZ3RoIFNwZWNpZmllcyB0aGUgbWluaW11bSBsZW5ndGggb2YgdGV4dCBiZWZvcmUgYXV0b2NvbXBsZXRlIHdpbGwgbWFrZSBzdWdnZXN0aW9uc1xuICogQHBhcmFtIHtudW1iZXI9fSBtZC1kZWxheSBTcGVjaWZpZXMgdGhlIGFtb3VudCBvZiB0aW1lIChpbiBtaWxsaXNlY29uZHMpIHRvIHdhaXQgYmVmb3JlIGxvb2tpbmcgZm9yIHJlc3VsdHNcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG1kLWF1dG9mb2N1cyBJZiB0cnVlLCB3aWxsIGltbWVkaWF0ZWx5IGZvY3VzIHRoZSBpbnB1dCBlbGVtZW50XG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBtZC1hdXRvc2VsZWN0IElmIHRydWUsIHRoZSBmaXJzdCBpdGVtIHdpbGwgYmUgc2VsZWN0ZWQgYnkgZGVmYXVsdFxuICogQHBhcmFtIHtzdHJpbmc9fSBtZC1tZW51LWNsYXNzIFRoaXMgd2lsbCBiZSBhcHBsaWVkIHRvIHRoZSBkcm9wZG93biBtZW51IGZvciBzdHlsaW5nXG4gKiBAcGFyYW0ge3N0cmluZz19IG1kLWZsb2F0aW5nLWxhYmVsIFRoaXMgd2lsbCBhZGQgYSBmbG9hdGluZyBsYWJlbCB0byBhdXRvY29tcGxldGUgYW5kIHdyYXAgaXQgaW4gYG1kLWlucHV0LWNvbnRhaW5lcmBcbiAqXG4gKiBAdXNhZ2VcbiAqICMjI0Jhc2ljIEV4YW1wbGVcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiAgIDxtZC1hdXRvY29tcGxldGVcbiAqICAgICAgIG1kLXNlbGVjdGVkLWl0ZW09XCJzZWxlY3RlZEl0ZW1cIlxuICogICAgICAgbWQtc2VhcmNoLXRleHQ9XCJzZWFyY2hUZXh0XCJcbiAqICAgICAgIG1kLWl0ZW1zPVwiaXRlbSBpbiBnZXRNYXRjaGVzKHNlYXJjaFRleHQpXCJcbiAqICAgICAgIG1kLWl0ZW0tdGV4dD1cIml0ZW0uZGlzcGxheVwiPlxuICogICAgIDxzcGFuIG1kLWhpZ2hsaWdodC10ZXh0PVwic2VhcmNoVGV4dFwiPnt7aXRlbS5kaXNwbGF5fX08L3NwYW4+XG4gKiAgIDwvbWQtYXV0b2NvbXBsZXRlPlxuICogPC9obGpzPlxuICpcbiAqICMjI0V4YW1wbGUgd2l0aCBcIm5vdCBmb3VuZFwiIG1lc3NhZ2VcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiA8bWQtYXV0b2NvbXBsZXRlXG4gKiAgICAgbWQtc2VsZWN0ZWQtaXRlbT1cInNlbGVjdGVkSXRlbVwiXG4gKiAgICAgbWQtc2VhcmNoLXRleHQ9XCJzZWFyY2hUZXh0XCJcbiAqICAgICBtZC1pdGVtcz1cIml0ZW0gaW4gZ2V0TWF0Y2hlcyhzZWFyY2hUZXh0KVwiXG4gKiAgICAgbWQtaXRlbS10ZXh0PVwiaXRlbS5kaXNwbGF5XCI+XG4gKiAgIDxtZC1pdGVtLXRlbXBsYXRlPlxuICogICAgIDxzcGFuIG1kLWhpZ2hsaWdodC10ZXh0PVwic2VhcmNoVGV4dFwiPnt7aXRlbS5kaXNwbGF5fX08L3NwYW4+XG4gKiAgIDwvbWQtaXRlbS10ZW1wbGF0ZT5cbiAqICAgPG1kLW5vdC1mb3VuZD5cbiAqICAgICBObyBtYXRjaGVzIGZvdW5kLlxuICogICA8L21kLW5vdC1mb3VuZD5cbiAqIDwvbWQtYXV0b2NvbXBsZXRlPlxuICogPC9obGpzPlxuICpcbiAqIEluIHRoaXMgZXhhbXBsZSwgb3VyIGNvZGUgdXRpbGl6ZXMgYG1kLWl0ZW0tdGVtcGxhdGVgIGFuZCBgbWQtbm90LWZvdW5kYCB0byBzcGVjaWZ5IHRoZSBkaWZmZXJlbnRcbiAqIHBhcnRzIHRoYXQgbWFrZSB1cCBvdXIgY29tcG9uZW50LlxuICpcbiAqICMjIyBFeGFtcGxlIHdpdGggdmFsaWRhdGlvblxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cbiAqIDxmb3JtIG5hbWU9XCJhdXRvY29tcGxldGVGb3JtXCI+XG4gKiAgIDxtZC1hdXRvY29tcGxldGVcbiAqICAgICAgIHJlcXVpcmVkXG4gKiAgICAgICBpbnB1dC1uYW1lPVwiYXV0b2NvbXBsZXRlXCJcbiAqICAgICAgIG1kLXNlbGVjdGVkLWl0ZW09XCJzZWxlY3RlZEl0ZW1cIlxuICogICAgICAgbWQtc2VhcmNoLXRleHQ9XCJzZWFyY2hUZXh0XCJcbiAqICAgICAgIG1kLWl0ZW1zPVwiaXRlbSBpbiBnZXRNYXRjaGVzKHNlYXJjaFRleHQpXCJcbiAqICAgICAgIG1kLWl0ZW0tdGV4dD1cIml0ZW0uZGlzcGxheVwiPlxuICogICAgIDxtZC1pdGVtLXRlbXBsYXRlPlxuICogICAgICAgPHNwYW4gbWQtaGlnaGxpZ2h0LXRleHQ9XCJzZWFyY2hUZXh0XCI+e3tpdGVtLmRpc3BsYXl9fTwvc3Bhbj5cbiAqICAgICA8L21kLWl0ZW0tdGVtcGxhdGU+XG4gKiAgICAgPGRpdiBuZy1tZXNzYWdlcz1cImF1dG9jb21wbGV0ZUZvcm0uYXV0b2NvbXBsZXRlLiRlcnJvclwiPlxuICogICAgICAgPGRpdiBuZy1tZXNzYWdlPVwicmVxdWlyZWRcIj5UaGlzIGZpZWxkIGlzIHJlcXVpcmVkPC9kaXY+XG4gKiAgICAgPC9kaXY+XG4gKiAgIDwvbWQtYXV0b2NvbXBsZXRlPlxuICogPC9mb3JtPlxuICogPC9obGpzPlxuICpcbiAqIEluIHRoaXMgZXhhbXBsZSwgb3VyIGNvZGUgdXRpbGl6ZXMgYG1kLWl0ZW0tdGVtcGxhdGVgIGFuZCBgbWQtbm90LWZvdW5kYCB0byBzcGVjaWZ5IHRoZSBkaWZmZXJlbnRcbiAqIHBhcnRzIHRoYXQgbWFrZSB1cCBvdXIgY29tcG9uZW50LlxuICovXG5cbmZ1bmN0aW9uIE1kQXV0b2NvbXBsZXRlICgkbWRUaGVtaW5nLCAkbWRVdGlsKSB7XG4gIHJldHVybiB7XG4gICAgY29udHJvbGxlcjogICAnTWRBdXRvY29tcGxldGVDdHJsJyxcbiAgICBjb250cm9sbGVyQXM6ICckbWRBdXRvY29tcGxldGVDdHJsJyxcbiAgICBzY29wZTogICAgICAgIHtcbiAgICAgIGlucHV0TmFtZTogICAgICAnQG1kSW5wdXROYW1lJyxcbiAgICAgIGlucHV0TWlubGVuZ3RoOiAnQG1kSW5wdXRNaW5sZW5ndGgnLFxuICAgICAgaW5wdXRNYXhsZW5ndGg6ICdAbWRJbnB1dE1heGxlbmd0aCcsXG4gICAgICBzZWFyY2hUZXh0OiAgICAgJz0/bWRTZWFyY2hUZXh0JyxcbiAgICAgIHNlbGVjdGVkSXRlbTogICAnPT9tZFNlbGVjdGVkSXRlbScsXG4gICAgICBpdGVtc0V4cHI6ICAgICAgJ0BtZEl0ZW1zJyxcbiAgICAgIGl0ZW1UZXh0OiAgICAgICAnJm1kSXRlbVRleHQnLFxuICAgICAgcGxhY2Vob2xkZXI6ICAgICdAcGxhY2Vob2xkZXInLFxuICAgICAgbm9DYWNoZTogICAgICAgICc9P21kTm9DYWNoZScsXG4gICAgICBpdGVtQ2hhbmdlOiAgICAgJyY/bWRTZWxlY3RlZEl0ZW1DaGFuZ2UnLFxuICAgICAgdGV4dENoYW5nZTogICAgICcmP21kU2VhcmNoVGV4dENoYW5nZScsXG4gICAgICBtaW5MZW5ndGg6ICAgICAgJz0/bWRNaW5MZW5ndGgnLFxuICAgICAgZGVsYXk6ICAgICAgICAgICc9P21kRGVsYXknLFxuICAgICAgYXV0b2ZvY3VzOiAgICAgICc9P21kQXV0b2ZvY3VzJyxcbiAgICAgIGZsb2F0aW5nTGFiZWw6ICAnQD9tZEZsb2F0aW5nTGFiZWwnLFxuICAgICAgYXV0b3NlbGVjdDogICAgICc9P21kQXV0b3NlbGVjdCcsXG4gICAgICBtZW51Q2xhc3M6ICAgICAgJ0A/bWRNZW51Q2xhc3MnXG4gICAgfSxcbiAgICB0ZW1wbGF0ZTogZnVuY3Rpb24gKGVsZW1lbnQsIGF0dHIpIHtcbiAgICAgIHZhciBub0l0ZW1zVGVtcGxhdGUgPSBnZXROb0l0ZW1zVGVtcGxhdGUoKSxcbiAgICAgICAgICBpdGVtVGVtcGxhdGUgPSBnZXRJdGVtVGVtcGxhdGUoKSxcbiAgICAgICAgICBsZWZ0b3ZlciA9IGVsZW1lbnQuaHRtbCgpO1xuICAgICAgcmV0dXJuICdcXFxuICAgICAgICA8bWQtYXV0b2NvbXBsZXRlLXdyYXBcXFxuICAgICAgICAgICAgbGF5b3V0PVwicm93XCJcXFxuICAgICAgICAgICAgbmctY2xhc3M9XCJ7IFxcJ21kLXdoaXRlZnJhbWUtejFcXCc6ICFmbG9hdGluZ0xhYmVsIH1cIlxcXG4gICAgICAgICAgICByb2xlPVwibGlzdGJveFwiPlxcXG4gICAgICAgICAgJyArIGdldElucHV0RWxlbWVudCgpICsgJ1xcXG4gICAgICAgICAgPG1kLXByb2dyZXNzLWxpbmVhclxcXG4gICAgICAgICAgICAgIG5nLWlmPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5sb2FkaW5nXCJcXFxuICAgICAgICAgICAgICBtZC1tb2RlPVwiaW5kZXRlcm1pbmF0ZVwiPjwvbWQtcHJvZ3Jlc3MtbGluZWFyPlxcXG4gICAgICAgICAgPHVsIHJvbGU9XCJwcmVzZW50YXRpb25cIlxcXG4gICAgICAgICAgICAgIGNsYXNzPVwibWQtYXV0b2NvbXBsZXRlLXN1Z2dlc3Rpb25zIG1kLXdoaXRlZnJhbWUtejEge3ttZW51Q2xhc3MgfHwgXFwnXFwnfX1cIlxcXG4gICAgICAgICAgICAgIGlkPVwidWwte3skbWRBdXRvY29tcGxldGVDdHJsLmlkfX1cIlxcXG4gICAgICAgICAgICAgIG5nLWhpZGU9XCIkbWRBdXRvY29tcGxldGVDdHJsLmhpZGRlblwiXFxcbiAgICAgICAgICAgICAgbmctbW91c2VlbnRlcj1cIiRtZEF1dG9jb21wbGV0ZUN0cmwubGlzdEVudGVyKClcIlxcXG4gICAgICAgICAgICAgIG5nLW1vdXNlbGVhdmU9XCIkbWRBdXRvY29tcGxldGVDdHJsLmxpc3RMZWF2ZSgpXCJcXFxuICAgICAgICAgICAgICBuZy1tb3VzZXVwPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5tb3VzZVVwKClcIj5cXFxuICAgICAgICAgICAgPGxpIG5nLXJlcGVhdD1cIihpbmRleCwgaXRlbSkgaW4gJG1kQXV0b2NvbXBsZXRlQ3RybC5tYXRjaGVzXCJcXFxuICAgICAgICAgICAgICAgIG5nLWNsYXNzPVwieyBzZWxlY3RlZDogaW5kZXggPT09ICRtZEF1dG9jb21wbGV0ZUN0cmwuaW5kZXggfVwiXFxcbiAgICAgICAgICAgICAgICBuZy1jbGljaz1cIiRtZEF1dG9jb21wbGV0ZUN0cmwuc2VsZWN0KGluZGV4KVwiXFxcbiAgICAgICAgICAgICAgICBtZC1hdXRvY29tcGxldGUtbGlzdC1pdGVtPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5pdGVtTmFtZVwiPlxcXG4gICAgICAgICAgICAgICAgJyArIGl0ZW1UZW1wbGF0ZSArICdcXFxuICAgICAgICAgICAgPC9saT5cXFxuICAgICAgICAgICAgJyArIG5vSXRlbXNUZW1wbGF0ZSArICdcXFxuICAgICAgICAgIDwvdWw+XFxcbiAgICAgICAgPC9tZC1hdXRvY29tcGxldGUtd3JhcD5cXFxuICAgICAgICA8YXJpYS1zdGF0dXNcXFxuICAgICAgICAgICAgY2xhc3M9XCJtZC12aXN1YWxseS1oaWRkZW5cIlxcXG4gICAgICAgICAgICByb2xlPVwic3RhdHVzXCJcXFxuICAgICAgICAgICAgYXJpYS1saXZlPVwiYXNzZXJ0aXZlXCI+XFxcbiAgICAgICAgICA8cCBuZy1yZXBlYXQ9XCJtZXNzYWdlIGluICRtZEF1dG9jb21wbGV0ZUN0cmwubWVzc2FnZXNcIiBuZy1pZj1cIm1lc3NhZ2VcIj57e21lc3NhZ2V9fTwvcD5cXFxuICAgICAgICA8L2FyaWEtc3RhdHVzPic7XG5cbiAgICAgIGZ1bmN0aW9uIGdldEl0ZW1UZW1wbGF0ZSgpIHtcbiAgICAgICAgdmFyIHRlbXBsYXRlVGFnID0gZWxlbWVudC5maW5kKCdtZC1pdGVtLXRlbXBsYXRlJykucmVtb3ZlKCksXG4gICAgICAgICAgICBodG1sID0gdGVtcGxhdGVUYWcubGVuZ3RoID8gdGVtcGxhdGVUYWcuaHRtbCgpIDogZWxlbWVudC5odG1sKCk7XG4gICAgICAgIGlmICghdGVtcGxhdGVUYWcubGVuZ3RoKSBlbGVtZW50LmVtcHR5KCk7XG4gICAgICAgIHJldHVybiBodG1sO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBnZXROb0l0ZW1zVGVtcGxhdGUoKSB7XG4gICAgICAgIHZhciB0ZW1wbGF0ZVRhZyA9IGVsZW1lbnQuZmluZCgnbWQtbm90LWZvdW5kJykucmVtb3ZlKCksXG4gICAgICAgICAgICB0ZW1wbGF0ZSA9IHRlbXBsYXRlVGFnLmxlbmd0aCA/IHRlbXBsYXRlVGFnLmh0bWwoKSA6ICcnO1xuICAgICAgICByZXR1cm4gdGVtcGxhdGVcbiAgICAgICAgICAgID8gJzxsaSBuZy1pZj1cIiEkbWRBdXRvY29tcGxldGVDdHJsLm1hdGNoZXMubGVuZ3RoICYmICEkbWRBdXRvY29tcGxldGVDdHJsLmxvYWRpbmdcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICYmICEkbWRBdXRvY29tcGxldGVDdHJsLmhpZGRlblwiXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICBuZy1oaWRlPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5oaWRkZW5cIlxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgbWQtYXV0b2NvbXBsZXRlLXBhcmVudC1zY29wZT4nICsgdGVtcGxhdGUgKyAnPC9saT4nXG4gICAgICAgICAgICA6ICcnO1xuXG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGdldElucHV0RWxlbWVudCgpIHtcbiAgICAgICAgaWYgKGF0dHIubWRGbG9hdGluZ0xhYmVsKSB7XG4gICAgICAgICAgcmV0dXJuICdcXFxuICAgICAgICAgICAgPG1kLWlucHV0LWNvbnRhaW5lciBmbGV4IG5nLWlmPVwiZmxvYXRpbmdMYWJlbFwiPlxcXG4gICAgICAgICAgICAgIDxsYWJlbD57e2Zsb2F0aW5nTGFiZWx9fTwvbGFiZWw+XFxcbiAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJzZWFyY2hcIlxcXG4gICAgICAgICAgICAgICAgICBpZD1cImZsLWlucHV0LXt7JG1kQXV0b2NvbXBsZXRlQ3RybC5pZH19XCJcXFxuICAgICAgICAgICAgICAgICAgbmFtZT1cInt7aW5wdXROYW1lfX1cIlxcXG4gICAgICAgICAgICAgICAgICBhdXRvY29tcGxldGU9XCJvZmZcIlxcXG4gICAgICAgICAgICAgICAgICBuZy1yZXF1aXJlZD1cImlzUmVxdWlyZWRcIlxcXG4gICAgICAgICAgICAgICAgICBuZy1taW5sZW5ndGg9XCJpbnB1dE1pbmxlbmd0aFwiXFxcbiAgICAgICAgICAgICAgICAgIG5nLW1heGxlbmd0aD1cImlucHV0TWF4bGVuZ3RoXCJcXFxuICAgICAgICAgICAgICAgICAgbmctZGlzYWJsZWQ9XCIkbWRBdXRvY29tcGxldGVDdHJsLmlzRGlzYWJsZWRcIlxcXG4gICAgICAgICAgICAgICAgICBuZy1tb2RlbD1cIiRtZEF1dG9jb21wbGV0ZUN0cmwuc2NvcGUuc2VhcmNoVGV4dFwiXFxcbiAgICAgICAgICAgICAgICAgIG5nLWtleWRvd249XCIkbWRBdXRvY29tcGxldGVDdHJsLmtleWRvd24oJGV2ZW50KVwiXFxcbiAgICAgICAgICAgICAgICAgIG5nLWJsdXI9XCIkbWRBdXRvY29tcGxldGVDdHJsLmJsdXIoKVwiXFxcbiAgICAgICAgICAgICAgICAgIG5nLWZvY3VzPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5mb2N1cygpXCJcXFxuICAgICAgICAgICAgICAgICAgYXJpYS1vd25zPVwidWwte3skbWRBdXRvY29tcGxldGVDdHJsLmlkfX1cIlxcXG4gICAgICAgICAgICAgICAgICBhcmlhLWxhYmVsPVwie3tmbG9hdGluZ0xhYmVsfX1cIlxcXG4gICAgICAgICAgICAgICAgICBhcmlhLWF1dG9jb21wbGV0ZT1cImxpc3RcIlxcXG4gICAgICAgICAgICAgICAgICBhcmlhLWhhc3BvcHVwPVwidHJ1ZVwiXFxcbiAgICAgICAgICAgICAgICAgIGFyaWEtYWN0aXZlZGVzY2VuZGFudD1cIlwiXFxcbiAgICAgICAgICAgICAgICAgIGFyaWEtZXhwYW5kZWQ9XCJ7eyEkbWRBdXRvY29tcGxldGVDdHJsLmhpZGRlbn19XCIvPlxcXG4gICAgICAgICAgICAgIDxkaXYgbWQtYXV0b2NvbXBsZXRlLXBhcmVudC1zY29wZSBtZC1hdXRvY29tcGxldGUtcmVwbGFjZT4nICsgbGVmdG92ZXIgKyAnPC9kaXY+XFxcbiAgICAgICAgICAgIDwvbWQtaW5wdXQtY29udGFpbmVyPic7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuICdcXFxuICAgICAgICAgICAgPGlucHV0IGZsZXggdHlwZT1cInNlYXJjaFwiXFxcbiAgICAgICAgICAgICAgICBpZD1cImlucHV0LXt7JG1kQXV0b2NvbXBsZXRlQ3RybC5pZH19XCJcXFxuICAgICAgICAgICAgICAgIG5hbWU9XCJ7e2lucHV0TmFtZX19XCJcXFxuICAgICAgICAgICAgICAgIG5nLWlmPVwiIWZsb2F0aW5nTGFiZWxcIlxcXG4gICAgICAgICAgICAgICAgYXV0b2NvbXBsZXRlPVwib2ZmXCJcXFxuICAgICAgICAgICAgICAgIG5nLXJlcXVpcmVkPVwiaXNSZXF1aXJlZFwiXFxcbiAgICAgICAgICAgICAgICBuZy1kaXNhYmxlZD1cIiRtZEF1dG9jb21wbGV0ZUN0cmwuaXNEaXNhYmxlZFwiXFxcbiAgICAgICAgICAgICAgICBuZy1tb2RlbD1cIiRtZEF1dG9jb21wbGV0ZUN0cmwuc2NvcGUuc2VhcmNoVGV4dFwiXFxcbiAgICAgICAgICAgICAgICBuZy1rZXlkb3duPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5rZXlkb3duKCRldmVudClcIlxcXG4gICAgICAgICAgICAgICAgbmctYmx1cj1cIiRtZEF1dG9jb21wbGV0ZUN0cmwuYmx1cigpXCJcXFxuICAgICAgICAgICAgICAgIG5nLWZvY3VzPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5mb2N1cygpXCJcXFxuICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwie3twbGFjZWhvbGRlcn19XCJcXFxuICAgICAgICAgICAgICAgIGFyaWEtb3ducz1cInVsLXt7JG1kQXV0b2NvbXBsZXRlQ3RybC5pZH19XCJcXFxuICAgICAgICAgICAgICAgIGFyaWEtbGFiZWw9XCJ7e3BsYWNlaG9sZGVyfX1cIlxcXG4gICAgICAgICAgICAgICAgYXJpYS1hdXRvY29tcGxldGU9XCJsaXN0XCJcXFxuICAgICAgICAgICAgICAgIGFyaWEtaGFzcG9wdXA9XCJ0cnVlXCJcXFxuICAgICAgICAgICAgICAgIGFyaWEtYWN0aXZlZGVzY2VuZGFudD1cIlwiXFxcbiAgICAgICAgICAgICAgICBhcmlhLWV4cGFuZGVkPVwie3shJG1kQXV0b2NvbXBsZXRlQ3RybC5oaWRkZW59fVwiLz5cXFxuICAgICAgICAgICAgPGJ1dHRvblxcXG4gICAgICAgICAgICAgICAgdHlwZT1cImJ1dHRvblwiXFxcbiAgICAgICAgICAgICAgICB0YWJpbmRleD1cIi0xXCJcXFxuICAgICAgICAgICAgICAgIG5nLWlmPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5zY29wZS5zZWFyY2hUZXh0ICYmICEkbWRBdXRvY29tcGxldGVDdHJsLmlzRGlzYWJsZWRcIlxcXG4gICAgICAgICAgICAgICAgbmctY2xpY2s9XCIkbWRBdXRvY29tcGxldGVDdHJsLmNsZWFyKClcIj5cXFxuICAgICAgICAgICAgICA8bWQtaWNvbiBtZC1zdmctaWNvbj1cIm1kLWNsb3NlXCI+PC9tZC1pY29uPlxcXG4gICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibWQtdmlzdWFsbHktaGlkZGVuXCI+Q2xlYXI8L3NwYW4+XFxcbiAgICAgICAgICAgIDwvYnV0dG9uPlxcXG4gICAgICAgICAgICAgICAgJztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cbk1kQXV0b2NvbXBsZXRlLiRpbmplY3QgPSBbXCIkbWRUaGVtaW5nXCIsIFwiJG1kVXRpbFwiXTtcblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmF1dG9jb21wbGV0ZScpXG4gICAgLmNvbnRyb2xsZXIoJ01kSGlnaGxpZ2h0Q3RybCcsIE1kSGlnaGxpZ2h0Q3RybCk7XG5cbmZ1bmN0aW9uIE1kSGlnaGxpZ2h0Q3RybCAoJHNjb3BlLCAkZWxlbWVudCwgJGludGVycG9sYXRlKSB7XG4gIHRoaXMuaW5pdCA9IGluaXQ7XG5cbiAgcmV0dXJuIGluaXQoKTtcblxuICBmdW5jdGlvbiBpbml0ICh0ZXJtKSB7XG4gICAgdmFyIHVuc2FmZVRleHQgPSAkaW50ZXJwb2xhdGUoJGVsZW1lbnQuaHRtbCgpKSgkc2NvcGUpLFxuICAgICAgICB0ZXh0ID0gYW5ndWxhci5lbGVtZW50KCc8ZGl2PicpLnRleHQodW5zYWZlVGV4dCkuaHRtbCgpLFxuICAgICAgICBmbGFncyA9ICRlbGVtZW50LmF0dHIoJ21kLWhpZ2hsaWdodC1mbGFncycpIHx8ICcnLFxuICAgICAgICB3YXRjaGVyID0gJHNjb3BlLiR3YXRjaCh0ZXJtLCBmdW5jdGlvbiAodGVybSkge1xuICAgICAgICAgIHZhciByZWdleCA9IGdldFJlZ0V4cCh0ZXJtLCBmbGFncyksXG4gICAgICAgICAgICAgIGh0bWwgPSB0ZXh0LnJlcGxhY2UocmVnZXgsICc8c3BhbiBjbGFzcz1cImhpZ2hsaWdodFwiPiQmPC9zcGFuPicpO1xuICAgICAgICAgICRlbGVtZW50Lmh0bWwoaHRtbCk7XG4gICAgICAgIH0pO1xuICAgICRlbGVtZW50Lm9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHsgd2F0Y2hlcigpOyB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNhbml0aXplICh0ZXJtKSB7XG4gICAgaWYgKCF0ZXJtKSByZXR1cm4gdGVybTtcbiAgICByZXR1cm4gdGVybS5yZXBsYWNlKC9bXFxcXFxcXlxcJFxcKlxcK1xcP1xcLlxcKFxcKVxcfFxce1xcfVxcW1xcXV0vZywgJ1xcXFwkJicpO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0UmVnRXhwICh0ZXh0LCBmbGFncykge1xuICAgIHZhciBzdHIgPSAnJztcbiAgICBpZiAoZmxhZ3MuaW5kZXhPZignXicpID49IDEpIHN0ciArPSAnXic7XG4gICAgc3RyICs9IHRleHQ7XG4gICAgaWYgKGZsYWdzLmluZGV4T2YoJyQnKSA+PSAxKSBzdHIgKz0gJyQnO1xuICAgIHJldHVybiBuZXcgUmVnRXhwKHNhbml0aXplKHN0ciksIGZsYWdzLnJlcGxhY2UoL1tcXCRcXF5dL2csICcnKSk7XG4gIH1cbn1cbk1kSGlnaGxpZ2h0Q3RybC4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiJGVsZW1lbnRcIiwgXCIkaW50ZXJwb2xhdGVcIl07XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5hdXRvY29tcGxldGUnKVxuICAgIC5kaXJlY3RpdmUoJ21kSGlnaGxpZ2h0VGV4dCcsIE1kSGlnaGxpZ2h0KTtcblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBtZEhpZ2hsaWdodFRleHRcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5hdXRvY29tcGxldGVcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFRoZSBgbWQtaGlnaGxpZ2h0LXRleHRgIGRpcmVjdGl2ZSBhbGxvd3MgeW91IHRvIHNwZWNpZnkgdGV4dCB0aGF0IHNob3VsZCBiZSBoaWdobGlnaHRlZCB3aXRoaW5cbiAqIGFuIGVsZW1lbnQuICBIaWdobGlnaHRlZCB0ZXh0IHdpbGwgYmUgd3JhcHBlZCBpbiBgPHNwYW4gY2xhc3M9XCJoaWdobGlnaHRcIj48L3NwYW4+YCB3aGljaCBjYW5cbiAqIGJlIHN0eWxlZCB0aHJvdWdoIENTUy4gIFBsZWFzZSBub3RlIHRoYXQgY2hpbGQgZWxlbWVudHMgbWF5IG5vdCBiZSB1c2VkIHdpdGggdGhpcyBkaXJlY3RpdmUuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IG1kLWhpZ2hsaWdodC10ZXh0IEEgbW9kZWwgdG8gYmUgc2VhcmNoZWQgZm9yXG4gKiBAcGFyYW0ge3N0cmluZz19IG1kLWhpZ2hsaWdodC1mbGFncyBBIGxpc3Qgb2YgZmxhZ3MgKGxvb3NlbHkgYmFzZWQgb24gSmF2YVNjcmlwdCBSZXhFeHAgZmxhZ3MpLlxuICogICAgIyMjIyAqKlN1cHBvcnRlZCBmbGFncyoqOlxuICogICAgLSBgZ2A6IEZpbmQgYWxsIG1hdGNoZXMgd2l0aGluIHRoZSBwcm92aWRlZCB0ZXh0XG4gKiAgICAtIGBpYDogSWdub3JlIGNhc2Ugd2hlbiBzZWFyY2hpbmcgZm9yIG1hdGNoZXNcbiAqICAgIC0gYCRgOiBPbmx5IG1hdGNoIGlmIHRoZSB0ZXh0IGVuZHMgd2l0aCB0aGUgc2VhcmNoIHRlcm1cbiAqICAgIC0gYF5gOiBPbmx5IG1hdGNoIGlmIHRoZSB0ZXh0IGJlZ2lucyB3aXRoIHRoZSBzZWFyY2ggdGVybVxuICpcbiAqIEB1c2FnZVxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cbiAqIDxpbnB1dCBwbGFjZWhvbGRlcj1cIkVudGVyIGEgc2VhcmNoIHRlcm0uLi5cIiBuZy1tb2RlbD1cInNlYXJjaFRlcm1cIiB0eXBlPVwidGV4dFwiIC8+XG4gKiA8dWw+XG4gKiAgIDxsaSBuZy1yZXBlYXQ9XCJyZXN1bHQgaW4gcmVzdWx0c1wiIG1kLWhpZ2hsaWdodC10ZXh0PVwic2VhcmNoVGVybVwiPlxuICogICAgIHt7cmVzdWx0LnRleHR9fVxuICogICA8L2xpPlxuICogPC91bD5cbiAqIDwvaGxqcz5cbiAqL1xuXG5mdW5jdGlvbiBNZEhpZ2hsaWdodCAoKSB7XG4gIHJldHVybiB7XG4gICAgdGVybWluYWw6IHRydWUsXG4gICAgc2NvcGU6IGZhbHNlLFxuICAgIGNvbnRyb2xsZXI6ICdNZEhpZ2hsaWdodEN0cmwnLFxuICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCkge1xuICAgICAgY3RybC5pbml0KGF0dHIubWRIaWdobGlnaHRUZXh0KTtcbiAgICB9XG4gIH07XG59XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5hdXRvY29tcGxldGUnKVxuICAgIC5kaXJlY3RpdmUoJ21kQXV0b2NvbXBsZXRlTGlzdEl0ZW0nLCBNZEF1dG9jb21wbGV0ZUxpc3RJdGVtKTtcblxuZnVuY3Rpb24gTWRBdXRvY29tcGxldGVMaXN0SXRlbSAoJGNvbXBpbGUsICRtZFV0aWwpIHtcbiAgcmV0dXJuIHtcbiAgICB0ZXJtaW5hbDogdHJ1ZSxcbiAgICBsaW5rOiBwb3N0TGluayxcbiAgICBzY29wZTogZmFsc2VcbiAgfTtcbiAgZnVuY3Rpb24gcG9zdExpbmsgKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XG4gICAgdmFyIGN0cmwgICAgID0gc2NvcGUuJHBhcmVudC4kbWRBdXRvY29tcGxldGVDdHJsLFxuICAgICAgICBuZXdTY29wZSA9IGN0cmwucGFyZW50LiRuZXcoZmFsc2UsIGN0cmwucGFyZW50KSxcbiAgICAgICAgaXRlbU5hbWUgPSBjdHJsLnNjb3BlLiRldmFsKGF0dHIubWRBdXRvY29tcGxldGVMaXN0SXRlbSk7XG4gICAgbmV3U2NvcGVbaXRlbU5hbWVdID0gc2NvcGUuaXRlbTtcbiAgICAkY29tcGlsZShlbGVtZW50LmNvbnRlbnRzKCkpKG5ld1Njb3BlKTtcbiAgICBlbGVtZW50LmF0dHIoe1xuICAgICAgcm9sZTogJ29wdGlvbicsXG4gICAgICBpZDogJ2l0ZW1fJyArICRtZFV0aWwubmV4dFVpZCgpXG4gICAgfSk7XG4gIH1cbn1cbk1kQXV0b2NvbXBsZXRlTGlzdEl0ZW0uJGluamVjdCA9IFtcIiRjb21waWxlXCIsIFwiJG1kVXRpbFwiXTtcblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmF1dG9jb21wbGV0ZScpXG4gICAgLmRpcmVjdGl2ZSgnbWRBdXRvY29tcGxldGVQYXJlbnRTY29wZScsIE1kQXV0b2NvbXBsZXRlUGFyZW50U2NvcGUpO1xuXG5mdW5jdGlvbiBNZEF1dG9jb21wbGV0ZVBhcmVudFNjb3BlICgkY29tcGlsZSwgJG1kVXRpbCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgdGVybWluYWw6IHRydWUsXG4gICAgbGluazogcG9zdExpbmssXG4gICAgc2NvcGU6IGZhbHNlXG4gIH07XG4gIGZ1bmN0aW9uIHBvc3RMaW5rIChzY29wZSwgZWxlbWVudCwgYXR0cikge1xuICAgIHZhciBjdHJsICAgICA9IHNjb3BlLiRwYXJlbnQuJG1kQXV0b2NvbXBsZXRlQ3RybDtcbiAgICAkY29tcGlsZShlbGVtZW50LmNvbnRlbnRzKCkpKGN0cmwucGFyZW50KTtcbiAgICBpZiAoYXR0ci5oYXNPd25Qcm9wZXJ0eSgnbWRBdXRvY29tcGxldGVSZXBsYWNlJykpIHtcbiAgICAgIGVsZW1lbnQuYWZ0ZXIoZWxlbWVudC5jb250ZW50cygpKTtcbiAgICAgIGVsZW1lbnQucmVtb3ZlKCk7XG4gICAgfVxuICB9XG59XG5NZEF1dG9jb21wbGV0ZVBhcmVudFNjb3BlLiRpbmplY3QgPSBbXCIkY29tcGlsZVwiLCBcIiRtZFV0aWxcIl07XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5jaGlwcycpXG4gICAgLmRpcmVjdGl2ZSgnbWRDaGlwJywgTWRDaGlwKTtcblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBtZENoaXBcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5jaGlwc1xuICpcbiAqIEBkZXNjcmlwdGlvblxuICogYDxtZC1jaGlwPmAgaXMgYSBjb21wb25lbnQgdXNlZCB3aXRoaW4gYDxtZC1jaGlwcz5gIGFuZCBpcyByZXNwb25zaWJsZSBmb3IgcmVuZGVyaW5nIGluZGl2aWR1YWxcbiAqIGNoaXBzLlxuICpcbiAqXG4gKiBAdXNhZ2VcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiAgIDxtZC1jaGlwPnt7JGNoaXB9fTwvbWQtY2hpcD5cbiAqIDwvaGxqcz5cbiAqXG4gKi9cblxuLy8gVGhpcyBoaW50IHRleHQgaXMgaGlkZGVuIHdpdGhpbiBhIGNoaXAgYnV0IHVzZWQgYnkgc2NyZWVuIHJlYWRlcnMgdG9cbi8vIGluZm9ybSB0aGUgdXNlciBob3cgdGhleSBjYW4gaW50ZXJhY3Qgd2l0aCBhIGNoaXAuXG52YXIgREVMRVRFX0hJTlRfVEVNUExBVEUgPSAnXFxcbiAgICA8c3BhbiBuZy1pZj1cIiEkbWRDaGlwc0N0cmwucmVhZG9ubHlcIiBjbGFzcz1cIm1kLXZpc3VhbGx5LWhpZGRlblwiPlxcXG4gICAgICB7eyRtZENoaXBzQ3RybC5kZWxldGVIaW50fX1cXFxuICAgIDwvc3Bhbj4nO1xuXG4vKipcbiAqIE1EQ2hpcCBEaXJlY3RpdmUgRGVmaW5pdGlvblxuICpcbiAqIEBwYXJhbSAkbWRUaGVtaW5nXG4gKiBAcGFyYW0gJG1kSW5rUmlwcGxlXG4gKiBAbmdJbmplY3RcbiAqL1xuZnVuY3Rpb24gTWRDaGlwKCRtZFRoZW1pbmcpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0UnLFxuICAgIHJlcXVpcmU6ICdeP21kQ2hpcHMnLFxuICAgIGNvbXBpbGU6ICBjb21waWxlXG4gIH07XG5cbiAgZnVuY3Rpb24gY29tcGlsZShlbGVtZW50LCBhdHRyKSB7XG4gICAgZWxlbWVudC5hcHBlbmQoREVMRVRFX0hJTlRfVEVNUExBVEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCkge1xuICAgICAgZWxlbWVudC5hZGRDbGFzcygnbWQtY2hpcCcpO1xuICAgICAgJG1kVGhlbWluZyhlbGVtZW50KTtcblxuICAgICAgaWYgKGN0cmwpIGFuZ3VsYXIuZWxlbWVudChlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJy5tZC1jaGlwLWNvbnRlbnQnKSlcbiAgICAgICAgICAub24oJ2JsdXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjdHJsLnNlbGVjdGVkQ2hpcCA9IC0xO1xuICAgICAgICAgIH0pO1xuICAgIH07XG4gIH1cbn1cbk1kQ2hpcC4kaW5qZWN0ID0gW1wiJG1kVGhlbWluZ1wiXTtcblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmNoaXBzJylcbiAgICAuZGlyZWN0aXZlKCdtZENoaXBSZW1vdmUnLCBNZENoaXBSZW1vdmUpO1xuXG4vKipcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcbiAqIEBuYW1lIG1kQ2hpcFJlbW92ZVxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmNoaXBzXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBgPG1kLWNoaXAtcmVtb3ZlPmBcbiAqIERlc2lnbmF0ZXMgYW4gZWxlbWVudCB0byBiZSB1c2VkIGFzIHRoZSBkZWxldGUgYnV0dG9uIGZvciBhIGNoaXAuIFRoaXNcbiAqIGVsZW1lbnQgaXMgcGFzc2VkIGFzIGEgY2hpbGQgb2YgdGhlIGBtZC1jaGlwc2AgZWxlbWVudC5cbiAqXG4gKiBAdXNhZ2VcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiAgIDxtZC1jaGlwcz48YnV0dG9uIG1kLWNoaXAtcmVtb3ZlPkRFTDwvYnV0dG9uPjwvbWQtY2hpcHM+XG4gKiA8L2hsanM+XG4gKi9cblxuXG4vKipcbiAqIE1kQ2hpcFJlbW92ZSBEaXJlY3RpdmUgRGVmaW5pdGlvbi5cbiAqIFxuICogQHBhcmFtICRjb21waWxlXG4gKiBAcGFyYW0gJHRpbWVvdXRcbiAqIEByZXR1cm5zIHt7cmVzdHJpY3Q6IHN0cmluZywgcmVxdWlyZTogc3RyaW5nW10sIGxpbms6IEZ1bmN0aW9uLCBzY29wZTogYm9vbGVhbn19XG4gKiBAY29uc3RydWN0b3JcbiAqL1xuZnVuY3Rpb24gTWRDaGlwUmVtb3ZlICgkdGltZW91dCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgcmVxdWlyZTogJ15tZENoaXBzJyxcbiAgICBzY29wZTogZmFsc2UsXG4gICAgbGluazogcG9zdExpbmtcbiAgfTtcblxuICBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCkge1xuICAgIGVsZW1lbnQub24oJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcbiAgICAgICAgY3RybC5yZW1vdmVDaGlwKHNjb3BlLiQkcmVwbGFjZWRTY29wZS4kaW5kZXgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBDaGlsZCBlbGVtZW50cyBhcmVuJ3QgYXZhaWxhYmxlIHVudGlsIGFmdGVyIGEgJHRpbWVvdXQgdGljayBhcyB0aGV5IGFyZSBoaWRkZW4gYnkgYW5cbiAgICAvLyBgbmctaWZgLiBzZWUgaHR0cDovL2dvby5nbC96SVdmdXdcbiAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgIGVsZW1lbnQuYXR0cih7IHRhYmluZGV4OiAtMSwgYXJpYUhpZGRlbjogdHJ1ZSB9KTtcbiAgICAgIGVsZW1lbnQuZmluZCgnYnV0dG9uJykuYXR0cigndGFiaW5kZXgnLCAnLTEnKTtcbiAgICB9KTtcbiAgfVxufVxuTWRDaGlwUmVtb3ZlLiRpbmplY3QgPSBbXCIkdGltZW91dFwiXTtcblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmNoaXBzJylcbiAgICAuZGlyZWN0aXZlKCdtZENoaXBUcmFuc2NsdWRlJywgTWRDaGlwVHJhbnNjbHVkZSk7XG5cbmZ1bmN0aW9uIE1kQ2hpcFRyYW5zY2x1ZGUgKCRjb21waWxlLCAkbWRVdGlsKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdFQScsXG4gICAgdGVybWluYWw6IHRydWUsXG4gICAgbGluazogbGluayxcbiAgICBzY29wZTogZmFsc2VcbiAgfTtcbiAgZnVuY3Rpb24gbGluayAoc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcbiAgICB2YXIgY3RybCA9IHNjb3BlLiRwYXJlbnQuJG1kQ2hpcHNDdHJsLFxuICAgICAgICBuZXdTY29wZSA9IGN0cmwucGFyZW50LiRuZXcoZmFsc2UsIGN0cmwucGFyZW50KTtcbiAgICBuZXdTY29wZS4kJHJlcGxhY2VkU2NvcGUgPSBzY29wZTtcbiAgICBuZXdTY29wZS4kY2hpcCA9IHNjb3BlLiRjaGlwO1xuICAgIG5ld1Njb3BlLiRtZENoaXBzQ3RybCA9IGN0cmw7XG4gICAgZWxlbWVudC5odG1sKGN0cmwuJHNjb3BlLiRldmFsKGF0dHIubWRDaGlwVHJhbnNjbHVkZSkpO1xuICAgICRjb21waWxlKGVsZW1lbnQuY29udGVudHMoKSkobmV3U2NvcGUpO1xuICB9XG59XG5NZENoaXBUcmFuc2NsdWRlLiRpbmplY3QgPSBbXCIkY29tcGlsZVwiLCBcIiRtZFV0aWxcIl07XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5jaGlwcycpXG4gICAgLmNvbnRyb2xsZXIoJ01kQ2hpcHNDdHJsJywgTWRDaGlwc0N0cmwpO1xuXG4vKipcbiAqIENvbnRyb2xsZXIgZm9yIHRoZSBNZENoaXBzIGNvbXBvbmVudC4gUmVzcG9uc2libGUgZm9yIGFkZGluZyB0byBhbmRcbiAqIHJlbW92aW5nIGZyb20gdGhlIGxpc3Qgb2YgY2hpcHMsIG1hcmtpbmcgY2hpcHMgYXMgc2VsZWN0ZWQsIGFuZCBiaW5kaW5nIHRvXG4gKiB0aGUgbW9kZWxzIG9mIHZhcmlvdXMgaW5wdXQgY29tcG9uZW50cy5cbiAqXG4gKiBAcGFyYW0gJHNjb3BlXG4gKiBAcGFyYW0gJG1kQ29uc3RhbnRcbiAqIEBwYXJhbSAkbG9nXG4gKiBAcGFyYW0gJGVsZW1lbnRcbiAqIEBjb25zdHJ1Y3RvclxuICovXG5mdW5jdGlvbiBNZENoaXBzQ3RybCAoJHNjb3BlLCAkbWRDb25zdGFudCwgJGxvZywgJGVsZW1lbnQsICR0aW1lb3V0KSB7XG4gIC8qKiBAdHlwZSB7JHRpbWVvdXR9ICoqL1xuICB0aGlzLiR0aW1lb3V0ID0gJHRpbWVvdXQ7XG5cbiAgLyoqIEB0eXBlIHtPYmplY3R9ICovXG4gIHRoaXMuJG1kQ29uc3RhbnQgPSAkbWRDb25zdGFudDtcblxuICAvKiogQHR5cGUge2FuZ3VsYXIuJHNjb3BlfSAqL1xuICB0aGlzLiRzY29wZSA9ICRzY29wZTtcblxuICAvKiogQHR5cGUge2FuZ3VsYXIuJHNjb3BlfSAqL1xuICB0aGlzLnBhcmVudCA9ICRzY29wZS4kcGFyZW50O1xuXG4gIC8qKiBAdHlwZSB7JGxvZ30gKi9cbiAgdGhpcy4kbG9nID0gJGxvZztcblxuICAvKiogQHR5cGUgeyRlbGVtZW50fSAqL1xuICB0aGlzLiRlbGVtZW50ID0gJGVsZW1lbnQ7XG5cbiAgLyoqIEB0eXBlIHthbmd1bGFyLk5nTW9kZWxDb250cm9sbGVyfSAqL1xuICB0aGlzLm5nTW9kZWxDdHJsID0gbnVsbDtcblxuICAvKiogQHR5cGUge2FuZ3VsYXIuTmdNb2RlbENvbnRyb2xsZXJ9ICovXG4gIHRoaXMudXNlcklucHV0TmdNb2RlbEN0cmwgPSBudWxsO1xuXG4gIC8qKiBAdHlwZSB7RWxlbWVudH0gKi9cbiAgdGhpcy51c2VySW5wdXRFbGVtZW50ID0gbnVsbDtcblxuICAvKiogQHR5cGUge0FycmF5LjxPYmplY3Q+fSAqL1xuICB0aGlzLml0ZW1zID0gW107XG5cbiAgLyoqIEB0eXBlIHtudW1iZXJ9ICovXG4gIHRoaXMuc2VsZWN0ZWRDaGlwID0gLTE7XG5cblxuICAvKipcbiAgICogSGlkZGVuIGhpbnQgdGV4dCBmb3IgaG93IHRvIGRlbGV0ZSBhIGNoaXAuIFVzZWQgdG8gZ2l2ZSBjb250ZXh0IHRvIHNjcmVlbiByZWFkZXJzLlxuICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgKi9cbiAgdGhpcy5kZWxldGVIaW50ID0gJ1ByZXNzIGRlbGV0ZSB0byByZW1vdmUgdGhpcyBjaGlwLic7XG5cbiAgLyoqXG4gICAqIEhpZGRlbiBsYWJlbCBmb3IgdGhlIGRlbGV0ZSBidXR0b24uIFVzZWQgdG8gZ2l2ZSBjb250ZXh0IHRvIHNjcmVlbiByZWFkZXJzLlxuICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgKi9cbiAgdGhpcy5kZWxldGVCdXR0b25MYWJlbCA9ICdSZW1vdmUnO1xuXG4gIC8qKlxuICAgKiBNb2RlbCB1c2VkIGJ5IHRoZSBpbnB1dCBlbGVtZW50LlxuICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgKi9cbiAgdGhpcy5jaGlwQnVmZmVyID0gJyc7XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdG8gdXNlIHRoZSBtZE9uQXBwZW5kIGV4cHJlc3Npb24gdG8gdHJhbnNmb3JtIHRoZSBjaGlwIGJ1ZmZlclxuICAgKiBiZWZvcmUgYXBwZW5kaW5nIGl0IHRvIHRoZSBsaXN0LlxuICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICovXG4gIHRoaXMudXNlTWRPbkFwcGVuZCA9IGZhbHNlO1xufVxuTWRDaGlwc0N0cmwuJGluamVjdCA9IFtcIiRzY29wZVwiLCBcIiRtZENvbnN0YW50XCIsIFwiJGxvZ1wiLCBcIiRlbGVtZW50XCIsIFwiJHRpbWVvdXRcIl07XG5cbi8qKlxuICogSGFuZGxlcyB0aGUga2V5ZG93biBldmVudCBvbiB0aGUgaW5wdXQgZWxlbWVudDogPGVudGVyPiBhcHBlbmRzIHRoZVxuICogYnVmZmVyIHRvIHRoZSBjaGlwIGxpc3QsIHdoaWxlIGJhY2tzcGFjZSByZW1vdmVzIHRoZSBsYXN0IGNoaXAgaW4gdGhlIGxpc3RcbiAqIGlmIHRoZSBjdXJyZW50IGJ1ZmZlciBpcyBlbXB0eS5cbiAqIEBwYXJhbSBldmVudFxuICovXG5NZENoaXBzQ3RybC5wcm90b3R5cGUuaW5wdXRLZXlkb3duID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgdmFyIGNoaXBCdWZmZXIgPSB0aGlzLmdldENoaXBCdWZmZXIoKTtcbiAgc3dpdGNoIChldmVudC5rZXlDb2RlKSB7XG4gICAgY2FzZSB0aGlzLiRtZENvbnN0YW50LktFWV9DT0RFLkVOVEVSOlxuICAgICAgaWYgKHRoaXMuJHNjb3BlLnJlcXVpcmVNYXRjaCB8fCAhY2hpcEJ1ZmZlcikgYnJlYWs7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5hcHBlbmRDaGlwKGNoaXBCdWZmZXIpO1xuICAgICAgdGhpcy5yZXNldENoaXBCdWZmZXIoKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgdGhpcy4kbWRDb25zdGFudC5LRVlfQ09ERS5CQUNLU1BBQ0U6XG4gICAgICBpZiAoY2hpcEJ1ZmZlcikgYnJlYWs7XG4gICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIGlmICh0aGlzLml0ZW1zLmxlbmd0aCkgdGhpcy5zZWxlY3RBbmRGb2N1c0NoaXBTYWZlKHRoaXMuaXRlbXMubGVuZ3RoIC0gMSk7XG4gICAgICBicmVhaztcbiAgfVxufTtcblxuLyoqXG4gKiBIYW5kbGVzIHRoZSBrZXlkb3duIGV2ZW50IG9uIHRoZSBjaGlwIGVsZW1lbnRzOiBiYWNrc3BhY2UgcmVtb3ZlcyB0aGUgc2VsZWN0ZWQgY2hpcCwgYXJyb3dcbiAqIGtleXMgc3dpdGNoIHdoaWNoIGNoaXBzIGlzIGFjdGl2ZVxuICogQHBhcmFtIGV2ZW50XG4gKi9cbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS5jaGlwS2V5ZG93biA9IGZ1bmN0aW9uIChldmVudCkge1xuICBpZiAodGhpcy5nZXRDaGlwQnVmZmVyKCkpIHJldHVybjtcbiAgc3dpdGNoIChldmVudC5rZXlDb2RlKSB7XG4gICAgY2FzZSB0aGlzLiRtZENvbnN0YW50LktFWV9DT0RFLkJBQ0tTUEFDRTpcbiAgICBjYXNlIHRoaXMuJG1kQ29uc3RhbnQuS0VZX0NPREUuREVMRVRFOlxuICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRDaGlwIDwgMCkgcmV0dXJuO1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMucmVtb3ZlQW5kU2VsZWN0QWRqYWNlbnRDaGlwKHRoaXMuc2VsZWN0ZWRDaGlwKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgdGhpcy4kbWRDb25zdGFudC5LRVlfQ09ERS5MRUZUX0FSUk9XOlxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGlmICh0aGlzLnNlbGVjdGVkQ2hpcCA8IDApIHRoaXMuc2VsZWN0ZWRDaGlwID0gdGhpcy5pdGVtcy5sZW5ndGg7XG4gICAgICBpZiAodGhpcy5pdGVtcy5sZW5ndGgpIHRoaXMuc2VsZWN0QW5kRm9jdXNDaGlwU2FmZSh0aGlzLnNlbGVjdGVkQ2hpcCAtIDEpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSB0aGlzLiRtZENvbnN0YW50LktFWV9DT0RFLlJJR0hUX0FSUk9XOlxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuc2VsZWN0QW5kRm9jdXNDaGlwU2FmZSh0aGlzLnNlbGVjdGVkQ2hpcCArIDEpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSB0aGlzLiRtZENvbnN0YW50LktFWV9DT0RFLkVTQ0FQRTpcbiAgICBjYXNlIHRoaXMuJG1kQ29uc3RhbnQuS0VZX0NPREUuVEFCOlxuICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRDaGlwIDwgMCkgcmV0dXJuO1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMub25Gb2N1cygpO1xuICAgICAgYnJlYWs7XG4gIH1cbn07XG5cbi8qKlxuICogR2V0IHRoZSBpbnB1dCdzIHBsYWNlaG9sZGVyIC0gdXNlcyBgcGxhY2Vob2xkZXJgIHdoZW4gbGlzdCBpcyBlbXB0eSBhbmQgYHNlY29uZGFyeS1wbGFjZWhvbGRlcmBcbiAqIHdoZW4gdGhlIGxpc3QgaXMgbm9uLWVtcHR5LiBJZiBgc2Vjb25kYXJ5LXBsYWNlaG9sZGVyYCBpcyBub3QgcHJvdmlkZWQsIGBwbGFjZWhvbGRlcmAgaXMgdXNlZFxuICogYWx3YXlzLlxuICovXG5NZENoaXBzQ3RybC5wcm90b3R5cGUuZ2V0UGxhY2Vob2xkZXIgPSBmdW5jdGlvbigpIHtcbiAgLy8gQWxsb3cgYHNlY29uZGFyeS1wbGFjZWhvbGRlcmAgdG8gYmUgYmxhbmsuXG4gIHZhciB1c2VTZWNvbmRhcnkgPSAodGhpcy5pdGVtcy5sZW5ndGggJiZcbiAgICAgICh0aGlzLnNlY29uZGFyeVBsYWNlaG9sZGVyID09ICcnIHx8IHRoaXMuc2Vjb25kYXJ5UGxhY2Vob2xkZXIpKTtcbiAgcmV0dXJuIHVzZVNlY29uZGFyeSA/IHRoaXMucGxhY2Vob2xkZXIgOiB0aGlzLnNlY29uZGFyeVBsYWNlaG9sZGVyO1xufTtcblxuLyoqXG4gKiBSZW1vdmVzIGNoaXAgYXQge0Bjb2RlIGluZGV4fSBhbmQgc2VsZWN0cyB0aGUgYWRqYWNlbnQgY2hpcC5cbiAqIEBwYXJhbSBpbmRleFxuICovXG5NZENoaXBzQ3RybC5wcm90b3R5cGUucmVtb3ZlQW5kU2VsZWN0QWRqYWNlbnRDaGlwID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgdmFyIHNlbEluZGV4ID0gdGhpcy5nZXRBZGphY2VudENoaXBJbmRleChpbmRleCk7XG4gIHRoaXMucmVtb3ZlQ2hpcChpbmRleCk7XG4gIHRoaXMuJHRpbWVvdXQoYW5ndWxhci5iaW5kKHRoaXMsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuc2VsZWN0QW5kRm9jdXNDaGlwU2FmZShzZWxJbmRleCk7XG4gIH0pKTtcbn07XG5cbi8qKlxuICogU2V0cyB0aGUgc2VsZWN0ZWQgY2hpcCBpbmRleCB0byAtMS5cbiAqL1xuTWRDaGlwc0N0cmwucHJvdG90eXBlLnJlc2V0U2VsZWN0ZWRDaGlwID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuc2VsZWN0ZWRDaGlwID0gLTE7XG59O1xuXG4vKipcbiAqIEdldHMgdGhlIGluZGV4IG9mIGFuIGFkamFjZW50IGNoaXAgdG8gc2VsZWN0IGFmdGVyIGRlbGV0aW9uLiBBZGphY2VuY3kgaXNcbiAqIGRldGVybWluZWQgYXMgdGhlIG5leHQgY2hpcCBpbiB0aGUgbGlzdCwgdW5sZXNzIHRoZSB0YXJnZXQgY2hpcCBpcyB0aGVcbiAqIGxhc3QgaW4gdGhlIGxpc3QsIHRoZW4gaXQgaXMgdGhlIGNoaXAgaW1tZWRpYXRlbHkgcHJlY2VkaW5nIHRoZSB0YXJnZXQuIElmXG4gKiB0aGVyZSBpcyBvbmx5IG9uZSBpdGVtIGluIHRoZSBsaXN0LCAtMSBpcyByZXR1cm5lZCAoc2VsZWN0IG5vbmUpLlxuICogVGhlIG51bWJlciByZXR1cm5lZCBpcyB0aGUgaW5kZXggdG8gc2VsZWN0IEFGVEVSIHRoZSB0YXJnZXQgaGFzIGJlZW5cbiAqIHJlbW92ZWQuXG4gKiBJZiB0aGUgY3VycmVudCBjaGlwIGlzIG5vdCBzZWxlY3RlZCwgdGhlbiAtMSBpcyByZXR1cm5lZCB0byBzZWxlY3Qgbm9uZS5cbiAqL1xuTWRDaGlwc0N0cmwucHJvdG90eXBlLmdldEFkamFjZW50Q2hpcEluZGV4ID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgdmFyIGxlbiA9IHRoaXMuaXRlbXMubGVuZ3RoIC0gMTtcbiAgcmV0dXJuIChsZW4gPT0gMCkgPyAtMSA6XG4gICAgICAoaW5kZXggPT0gbGVuKSA/IGluZGV4IC0xIDogaW5kZXg7XG59O1xuXG4vKipcbiAqIEFwcGVuZCB0aGUgY29udGVudHMgb2YgdGhlIGJ1ZmZlciB0byB0aGUgY2hpcCBsaXN0LiBUaGlzIG1ldGhvZCB3aWxsIGZpcnN0XG4gKiBjYWxsIG91dCB0byB0aGUgbWQtb24tYXBwZW5kIG1ldGhvZCwgaWYgcHJvdmlkZWRcbiAqIEBwYXJhbSBuZXdDaGlwXG4gKi9cbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS5hcHBlbmRDaGlwID0gZnVuY3Rpb24obmV3Q2hpcCkge1xuICBpZiAodGhpcy5pdGVtcy5pbmRleE9mKG5ld0NoaXApICsgMSkgcmV0dXJuO1xuICBpZiAodGhpcy51c2VNZE9uQXBwZW5kICYmIHRoaXMubWRPbkFwcGVuZCkge1xuICAgIG5ld0NoaXAgPSB0aGlzLm1kT25BcHBlbmQoeyckY2hpcCc6IG5ld0NoaXB9KTtcbiAgfVxuICB0aGlzLml0ZW1zLnB1c2gobmV3Q2hpcCk7XG59O1xuXG4vKipcbiAqIFNldHMgd2hldGhlciB0byB1c2UgdGhlIG1kLW9uLWFwcGVuZCBleHByZXNzaW9uLiBUaGlzIGV4cHJlc3Npb24gaXNcbiAqIGJvdW5kIHRvIHNjb3BlIGFuZCBjb250cm9sbGVyIGluIHtAY29kZSBNZENoaXBzRGlyZWN0aXZlfSBhc1xuICoge0Bjb2RlIG1kT25BcHBlbmR9LiBEdWUgdG8gdGhlIG5hdHVyZSBvZiBkaXJlY3RpdmUgc2NvcGUgYmluZGluZ3MsIHRoZVxuICogY29udHJvbGxlciBjYW5ub3Qga25vdyBvbiBpdHMgb3duL2Zyb20gdGhlIHNjb3BlIHdoZXRoZXIgYW4gZXhwcmVzc2lvbiB3YXNcbiAqIGFjdHVhbGx5IHByb3ZpZGVkLlxuICovXG5NZENoaXBzQ3RybC5wcm90b3R5cGUudXNlTWRPbkFwcGVuZEV4cHJlc3Npb24gPSBmdW5jdGlvbigpIHtcbiAgdGhpcy51c2VNZE9uQXBwZW5kID0gdHJ1ZTtcbn07XG5cbi8qKlxuICogR2V0cyB0aGUgaW5wdXQgYnVmZmVyLiBUaGUgaW5wdXQgYnVmZmVyIGNhbiBiZSB0aGUgbW9kZWwgYm91bmQgdG8gdGhlXG4gKiBkZWZhdWx0IGlucHV0IGl0ZW0ge0Bjb2RlIHRoaXMuY2hpcEJ1ZmZlcn0sIHRoZSB7QGNvZGUgc2VsZWN0ZWRJdGVtfVxuICogbW9kZWwgb2YgYW4ge0Bjb2RlIG1kLWF1dG9jb21wbGV0ZX0sIG9yLCB0aHJvdWdoIHNvbWUgbWFnaWMsIHRoZSBtb2RlbFxuICogYm91bmQgdG8gYW55IGlucHB1dCBvciB0ZXh0IGFyZWEgZWxlbWVudCBmb3VuZCB3aXRoaW4gYVxuICoge0Bjb2RlIG1kLWlucHV0LWNvbnRhaW5lcn0gZWxlbWVudC5cbiAqIEByZXR1cm4ge09iamVjdHxzdHJpbmd9XG4gKi9cbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS5nZXRDaGlwQnVmZmVyID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiAhdGhpcy51c2VySW5wdXRFbGVtZW50ID8gdGhpcy5jaGlwQnVmZmVyIDpcbiAgICAgIHRoaXMudXNlcklucHV0TmdNb2RlbEN0cmwgPyB0aGlzLnVzZXJJbnB1dE5nTW9kZWxDdHJsLiR2aWV3VmFsdWUgOlxuICAgICAgICAgIHRoaXMudXNlcklucHV0RWxlbWVudFswXS52YWx1ZTtcbn07XG5cbi8qKlxuICogUmVzZXRzIHRoZSBpbnB1dCBidWZmZXIgZm9yIGVpdGhlciB0aGUgaW50ZXJuYWwgaW5wdXQgb3IgdXNlciBwcm92aWRlZCBpbnB1dCBlbGVtZW50LlxuICovXG5NZENoaXBzQ3RybC5wcm90b3R5cGUucmVzZXRDaGlwQnVmZmVyID0gZnVuY3Rpb24oKSB7XG4gIGlmICh0aGlzLnVzZXJJbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAodGhpcy51c2VySW5wdXROZ01vZGVsQ3RybCkge1xuICAgICAgdGhpcy51c2VySW5wdXROZ01vZGVsQ3RybC4kc2V0Vmlld1ZhbHVlKCcnKTtcbiAgICAgIHRoaXMudXNlcklucHV0TmdNb2RlbEN0cmwuJHJlbmRlcigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnVzZXJJbnB1dEVsZW1lbnRbMF0udmFsdWUgPSAnJztcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5jaGlwQnVmZmVyID0gJyc7XG4gIH1cbn07XG5cbi8qKlxuICogUmVtb3ZlcyB0aGUgY2hpcCBhdCB0aGUgZ2l2ZW4gaW5kZXguXG4gKiBAcGFyYW0gaW5kZXhcbiAqL1xuTWRDaGlwc0N0cmwucHJvdG90eXBlLnJlbW92ZUNoaXAgPSBmdW5jdGlvbihpbmRleCkge1xuICB0aGlzLml0ZW1zLnNwbGljZShpbmRleCwgMSk7XG59O1xuXG5NZENoaXBzQ3RybC5wcm90b3R5cGUucmVtb3ZlQ2hpcEFuZEZvY3VzSW5wdXQgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgdGhpcy5yZW1vdmVDaGlwKGluZGV4KTtcbiAgdGhpcy5vbkZvY3VzKCk7XG59O1xuLyoqXG4gKiBTZWxlY3RzIHRoZSBjaGlwIGF0IGBpbmRleGAsXG4gKiBAcGFyYW0gaW5kZXhcbiAqL1xuTWRDaGlwc0N0cmwucHJvdG90eXBlLnNlbGVjdEFuZEZvY3VzQ2hpcFNhZmUgPSBmdW5jdGlvbihpbmRleCkge1xuICBpZiAoIXRoaXMuaXRlbXMubGVuZ3RoKSB7XG4gICAgdGhpcy5zZWxlY3RDaGlwKC0xKTtcbiAgICB0aGlzLm9uRm9jdXMoKTtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKGluZGV4ID09PSB0aGlzLml0ZW1zLmxlbmd0aCkgcmV0dXJuIHRoaXMub25Gb2N1cygpO1xuICBpbmRleCA9IE1hdGgubWF4KGluZGV4LCAwKTtcbiAgaW5kZXggPSBNYXRoLm1pbihpbmRleCwgdGhpcy5pdGVtcy5sZW5ndGggLSAxKTtcbiAgdGhpcy5zZWxlY3RDaGlwKGluZGV4KTtcbiAgdGhpcy5mb2N1c0NoaXAoaW5kZXgpO1xufTtcblxuLyoqXG4gKiBNYXJrcyB0aGUgY2hpcCBhdCB0aGUgZ2l2ZW4gaW5kZXggYXMgc2VsZWN0ZWQuXG4gKiBAcGFyYW0gaW5kZXhcbiAqL1xuTWRDaGlwc0N0cmwucHJvdG90eXBlLnNlbGVjdENoaXAgPSBmdW5jdGlvbihpbmRleCkge1xuICBpZiAoaW5kZXggPj0gLTEgJiYgaW5kZXggPD0gdGhpcy5pdGVtcy5sZW5ndGgpIHtcbiAgICB0aGlzLnNlbGVjdGVkQ2hpcCA9IGluZGV4O1xuICB9IGVsc2Uge1xuICAgIHRoaXMuJGxvZy53YXJuKCdTZWxlY3RlZCBDaGlwIGluZGV4IG91dCBvZiBib3VuZHM7IGlnbm9yaW5nLicpO1xuICB9XG59O1xuXG4vKipcbiAqIFNlbGVjdHMgdGhlIGNoaXAgYXQgYGluZGV4YCBhbmQgZ2l2ZXMgaXQgZm9jdXMuXG4gKiBAcGFyYW0gaW5kZXhcbiAqL1xuTWRDaGlwc0N0cmwucHJvdG90eXBlLnNlbGVjdEFuZEZvY3VzQ2hpcCA9IGZ1bmN0aW9uKGluZGV4KSB7XG4gIHRoaXMuc2VsZWN0Q2hpcChpbmRleCk7XG4gIGlmIChpbmRleCAhPSAtMSkge1xuICAgIHRoaXMuZm9jdXNDaGlwKGluZGV4KTtcbiAgfVxufTtcblxuLyoqXG4gKiBDYWxsIGBmb2N1cygpYCBvbiB0aGUgY2hpcCBhdCBgaW5kZXhgXG4gKi9cbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS5mb2N1c0NoaXAgPSBmdW5jdGlvbihpbmRleCkge1xuICB0aGlzLiRlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJ21kLWNoaXBbaW5kZXg9XCInICsgaW5kZXggKyAnXCJdIC5tZC1jaGlwLWNvbnRlbnQnKS5mb2N1cygpO1xufTtcblxuLyoqXG4gKiBDb25maWd1cmVzIHRoZSByZXF1aXJlZCBpbnRlcmFjdGlvbnMgd2l0aCB0aGUgbmdNb2RlbCBDb250cm9sbGVyLlxuICogU3BlY2lmaWNhbGx5LCBzZXQge0Bjb2RlIHRoaXMuaXRlbXN9IHRvIHRoZSB7QGNvZGUgTmdNb2RlbEN0cmwjJHZpZXdWYWxlfS5cbiAqIEBwYXJhbSBuZ01vZGVsQ3RybFxuICovXG5NZENoaXBzQ3RybC5wcm90b3R5cGUuY29uZmlndXJlTmdNb2RlbCA9IGZ1bmN0aW9uKG5nTW9kZWxDdHJsKSB7XG4gIHRoaXMubmdNb2RlbEN0cmwgPSBuZ01vZGVsQ3RybDtcblxuICB2YXIgc2VsZiA9IHRoaXM7XG4gIG5nTW9kZWxDdHJsLiRyZW5kZXIgPSBmdW5jdGlvbigpIHtcbiAgICAvLyBtb2RlbCBpcyB1cGRhdGVkLiBkbyBzb21ldGhpbmcuXG4gICAgc2VsZi5pdGVtcyA9IHNlbGYubmdNb2RlbEN0cmwuJHZpZXdWYWx1ZTtcbiAgfTtcbn07XG5cbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS5vbkZvY3VzID0gZnVuY3Rpb24gKCkge1xuICB2YXIgaW5wdXQgPSB0aGlzLiRlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0Jyk7XG4gIGlucHV0ICYmIGlucHV0LmZvY3VzKCk7XG4gIHRoaXMucmVzZXRTZWxlY3RlZENoaXAoKTtcbn07XG5cbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS5vbklucHV0Rm9jdXMgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuaW5wdXRIYXNGb2N1cyA9IHRydWU7XG4gIHRoaXMucmVzZXRTZWxlY3RlZENoaXAoKTtcbn07XG5cbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS5vbklucHV0Qmx1ciA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5pbnB1dEhhc0ZvY3VzID0gZmFsc2U7XG59O1xuXG4vKipcbiAqIENvbmZpZ3VyZSBldmVudCBiaW5kaW5ncyBvbiBhIHVzZXItcHJvdmlkZWQgaW5wdXQgZWxlbWVudC5cbiAqIEBwYXJhbSBpbnB1dEVsZW1lbnRcbiAqL1xuTWRDaGlwc0N0cmwucHJvdG90eXBlLmNvbmZpZ3VyZVVzZXJJbnB1dCA9IGZ1bmN0aW9uKGlucHV0RWxlbWVudCkge1xuICB0aGlzLnVzZXJJbnB1dEVsZW1lbnQgPSBpbnB1dEVsZW1lbnQ7XG5cbiAgLy8gRmluZCB0aGUgTmdNb2RlbEN0cmwgZm9yIHRoZSBpbnB1dCBlbGVtZW50XG4gIHZhciBuZ01vZGVsQ3RybCA9IGlucHV0RWxlbWVudC5jb250cm9sbGVyKCduZ01vZGVsJyk7XG4gIC8vIGAuY29udHJvbGxlcmAgd2lsbCBsb29rIGluIHRoZSBwYXJlbnQgYXMgd2VsbC5cbiAgaWYgKG5nTW9kZWxDdHJsICE9IHRoaXMubmdNb2RlbEN0cmwpIHtcbiAgICB0aGlzLnVzZXJJbnB1dE5nTW9kZWxDdHJsID0gbmdNb2RlbEN0cmw7XG4gIH1cblxuICAvLyBCaW5kIHRvIGtleWRvd24gYW5kIGZvY3VzIGV2ZW50cyBvZiBpbnB1dFxuICB2YXIgc2NvcGUgPSB0aGlzLiRzY29wZTtcbiAgdmFyIGN0cmwgPSB0aGlzO1xuICBpbnB1dEVsZW1lbnRcbiAgICAgIC5hdHRyKHsgdGFiaW5kZXg6IDAgfSlcbiAgICAgIC5vbigna2V5ZG93bicsIGZ1bmN0aW9uKGV2ZW50KSB7IHNjb3BlLiRhcHBseSggYW5ndWxhci5iaW5kKGN0cmwsIGZ1bmN0aW9uKCkgeyBjdHJsLmlucHV0S2V5ZG93bihldmVudCk7IH0pKSB9KVxuICAgICAgLm9uKCdmb2N1cycsIGFuZ3VsYXIuYmluZChjdHJsLCBjdHJsLm9uSW5wdXRGb2N1cykpXG4gICAgICAub24oJ2JsdXInLCBhbmd1bGFyLmJpbmQoY3RybCwgY3RybC5vbklucHV0Qmx1cikpO1xufTtcblxuTWRDaGlwc0N0cmwucHJvdG90eXBlLmNvbmZpZ3VyZUF1dG9jb21wbGV0ZSA9IGZ1bmN0aW9uKGN0cmwpIHtcblxuICBjdHJsLnJlZ2lzdGVyU2VsZWN0ZWRJdGVtV2F0Y2hlcihhbmd1bGFyLmJpbmQodGhpcywgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICBpZiAoaXRlbSkge1xuICAgICAgdGhpcy5hcHBlbmRDaGlwKGl0ZW0pO1xuICAgICAgdGhpcy5yZXNldENoaXBCdWZmZXIoKTtcbiAgICB9XG4gIH0pKTtcblxuICB0aGlzLiRlbGVtZW50LmZpbmQoJ2lucHV0JylcbiAgICAgIC5vbignZm9jdXMnLGFuZ3VsYXIuYmluZCh0aGlzLCB0aGlzLm9uSW5wdXRGb2N1cykgKVxuICAgICAgLm9uKCdibHVyJywgYW5ndWxhci5iaW5kKHRoaXMsIHRoaXMub25JbnB1dEJsdXIpICk7XG59O1xuXG5NZENoaXBzQ3RybC5wcm90b3R5cGUuaGFzRm9jdXMgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzLmlucHV0SGFzRm9jdXMgfHwgdGhpcy5zZWxlY3RlZENoaXAgPj0gMDtcbn07XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG4gIGFuZ3VsYXJcbiAgICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuY2hpcHMnKVxuICAgICAgLmRpcmVjdGl2ZSgnbWRDaGlwcycsIE1kQ2hpcHMpO1xuXG4gIC8qKlxuICAgKiBAbmdkb2MgZGlyZWN0aXZlXG4gICAqIEBuYW1lIG1kQ2hpcHNcbiAgICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmNoaXBzXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBgPG1kLWNoaXBzPmAgaXMgYW4gaW5wdXQgY29tcG9uZW50IGZvciBidWlsZGluZyBsaXN0cyBvZiBzdHJpbmdzIG9yIG9iamVjdHMuIFRoZSBsaXN0IGl0ZW1zIGFyZVxuICAgKiBkaXNwbGF5ZWQgYXMgJ2NoaXBzJy4gVGhpcyBjb21wb25lbnQgY2FuIG1ha2UgdXNlIG9mIGFuIGA8aW5wdXQ+YCBlbGVtZW50IG9yIGFuXG4gICAqIGA8bWQtYXV0b2NvbXBsZXRlPmAgZWxlbWVudC5cbiAgICpcbiAgICogPHN0cm9uZz5DdXN0b20gYDxtZC1jaGlwLXRlbXBsYXRlPmAgdGVtcGxhdGU8L3N0cm9uZz5cbiAgICogQSBjdXN0b20gdGVtcGxhdGUgbWF5IGJlIHByb3ZpZGVkIHRvIHJlbmRlciB0aGUgY29udGVudCBvZiBlYWNoIGNoaXAuIFRoaXMgaXMgYWNoaWV2ZWQgYnlcbiAgICogc3BlY2lmeWluZyBhbiBgPG1kLWNoaXAtdGVtcGxhdGU+YCBlbGVtZW50IGFzIGEgY2hpbGQgb2YgYDxtZC1jaGlwcz5gLiBOb3RlOiBBbnkgYXR0cmlidXRlcyBvblxuICAgKiBgPG1kLWNoaXAtdGVtcGxhdGU+YCB3aWxsIGJlIGRyb3BwZWQgYXMgb25seSB0aGUgaW5uZXJIVE1MIGlzIHVzZWQgZm9yIHRoZSBjaGlwIHRlbXBsYXRlLiBUaGVcbiAgICogdmFyaWFibGVzIGAkY2hpcGAgYW5kIGAkaW5kZXhgIGFyZSBhdmFpbGFibGUgaW4gdGhlIHNjb3BlIG9mIGA8bWQtY2hpcC10ZW1wbGF0ZT5gLCByZXByZXNlbnRpbmdcbiAgICogdGhlIGNoaXAgb2JqZWN0IGFuZCBpdHMgaW5kZXggaW4gdGhlIGxpc3Qgb2YgY2hpcHMsIHJlc3BlY3RpdmVseS5cbiAgICogVG8gb3ZlcnJpZGUgdGhlIGNoaXAgZGVsZXRlIGNvbnRyb2wsIGluY2x1ZGUgYW4gZWxlbWVudCAoaWRlYWxseSBhIGJ1dHRvbikgd2l0aCB0aGUgYXR0cmlidXRlXG4gICAqIGBtZC1jaGlwLXJlbW92ZWAuIEEgY2xpY2sgbGlzdGVuZXIgdG8gcmVtb3ZlIHRoZSBjaGlwIHdpbGwgYmUgYWRkZWQgYXV0b21hdGljYWxseS4gVGhlIGVsZW1lbnRcbiAgICogaXMgYWxzbyBwbGFjZWQgYXMgYSBzaWJsaW5nIHRvIHRoZSBjaGlwIGNvbnRlbnQgKG9uIHdoaWNoIHRoZXJlIGFyZSBhbHNvIGNsaWNrIGxpc3RlbmVycykgdG9cbiAgICogYXZvaWQgYSBuZXN0ZWQgbmctY2xpY2sgc2l0dWF0aW9uLlxuICAgKlxuICAgKiA8aDM+IFBlbmRpbmcgRmVhdHVyZXMgPC9oMz5cbiAgICogPHVsIHN0eWxlPVwicGFkZGluZy1sZWZ0OjIwcHg7XCI+XG4gICAqXG4gICAqICAgPHVsPlN0eWxlXG4gICAqICAgICA8bGk+Q29sb3VycyBmb3IgaG92ZXIsIHByZXNzIHN0YXRlcyAocmlwcGxlPykuPC9saT5cbiAgICogICA8L3VsPlxuICAgKlxuICAgKiAgIDx1bD5MaXN0IE1hbmlwdWxhdGlvblxuICAgKiAgICAgPGxpPmRlbGV0ZSBpdGVtIHZpYSBERUwgb3IgYmFja3NwYWNlIGtleXMgd2hlbiBzZWxlY3RlZDwvbGk+XG4gICAqICAgPC91bD5cbiAgICpcbiAgICogICA8dWw+VmFsaWRhdGlvblxuICAgKiAgICAgPGxpPmRlLWR1cGUgdmFsdWVzIChvciBzdXBwb3J0IGR1cGxpY2F0ZXMsIGJ1dCBmaXggdGhlIG5nLXJlcGVhdCBkdXBsaWNhdGUga2V5IGlzc3VlKTwvbGk+XG4gICAqICAgICA8bGk+YWxsb3cgYSB2YWxpZGF0aW9uIGNhbGxiYWNrPC9saT5cbiAgICogICAgIDxsaT5oaWxpZ2h0aW5nIHN0eWxlIGZvciBpbnZhbGlkIGNoaXBzPC9saT5cbiAgICogICA8L3VsPlxuICAgKlxuICAgKiAgIDx1bD5JdGVtIG11dGF0aW9uXG4gICAqICAgICA8bGk+U3VwcG9ydCBgXG4gICAqICAgICAgIDxtZC1jaGlwLWVkaXQ+YCB0ZW1wbGF0ZSwgc2hvdy9oaWRlIHRoZSBlZGl0IGVsZW1lbnQgb24gdGFwL2NsaWNrPyBkb3VibGUgdGFwL2RvdWJsZVxuICAgKiAgICAgICBjbGljaz9cbiAgICogICAgIDwvbGk+XG4gICAqICAgPC91bD5cbiAgICpcbiAgICogICA8dWw+VHJ1bmNhdGlvbiBhbmQgRGlzYW1iaWd1YXRpb24gKD8pXG4gICAqICAgICA8bGk+VHJ1bmNhdGUgY2hpcCB0ZXh0IHdoZXJlIHBvc3NpYmxlLCBidXQgZG8gbm90IHRydW5jYXRlIGVudHJpZXMgc3VjaCB0aGF0IHR3byBhcmVcbiAgICogICAgIGluZGlzdGluZ3Vpc2hhYmxlLjwvbGk+XG4gICAqICAgPC91bD5cbiAgICpcbiAgICogICA8dWw+RHJhZyBhbmQgRHJvcFxuICAgKiAgICAgPGxpPkRyYWcgYW5kIGRyb3AgY2hpcHMgYmV0d2VlbiByZWxhdGVkIGA8bWQtY2hpcHM+YCBlbGVtZW50cy5cbiAgICogICAgIDwvbGk+XG4gICAqICAgPC91bD5cbiAgICogPC91bD5cbiAgICpcbiAgICogIDxzcGFuIHN0eWxlPVwiZm9udC1zaXplOi44ZW07dGV4dC1hbGlnbjpjZW50ZXJcIj5cbiAgICogICAgV2FybmluZzogVGhpcyBjb21wb25lbnQgaXMgYSBXT1JLIElOIFBST0dSRVNTLiBJZiB5b3UgdXNlIGl0IG5vdyxcbiAgICogICAgaXQgd2lsbCBwcm9iYWJseSBicmVhayBvbiB5b3UgaW4gdGhlIGZ1dHVyZS5cbiAgICogIDwvc3Bhbj5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmc9fG9iamVjdD19IG5nLW1vZGVsIEEgbW9kZWwgdG8gYmluZCB0aGUgbGlzdCBvZiBpdGVtcyB0b1xuICAgKiBAcGFyYW0ge3N0cmluZz19IHBsYWNlaG9sZGVyIFBsYWNlaG9sZGVyIHRleHQgdGhhdCB3aWxsIGJlIGZvcndhcmRlZCB0byB0aGUgaW5wdXQuXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gc2Vjb25kYXJ5LXBsYWNlaG9sZGVyIFBsYWNlaG9sZGVyIHRleHQgdGhhdCB3aWxsIGJlIGZvcndhcmRlZCB0byB0aGUgaW5wdXQsXG4gICAqICAgIGRpc3BsYXllZCB3aGVuIHRoZXJlIGlzIGF0IGxlYXN0IG9uIGl0ZW0gaW4gdGhlIGxpc3RcbiAgICogQHBhcmFtIHtib29sZWFuPX0gcmVhZG9ubHkgRGlzYWJsZXMgbGlzdCBtYW5pcHVsYXRpb24gKGRlbGV0aW5nIG9yIGFkZGluZyBsaXN0IGl0ZW1zKSwgaGlkaW5nXG4gICAqICAgIHRoZSBpbnB1dCBhbmQgZGVsZXRlIGJ1dHRvbnNcbiAgICogQHBhcmFtIHtleHByZXNzaW9ufSBtZC1vbi1hcHBlbmQgQW4gZXhwcmVzc2lvbiBleHBlY3RlZCB0byBjb252ZXJ0IHRoZSBpbnB1dCBzdHJpbmcgaW50byBhblxuICAgKiAgICBvYmplY3Qgd2hlbiBhZGRpbmcgYSBjaGlwLlxuICAgKiBAcGFyYW0ge3N0cmluZz19IGRlbGV0ZS1oaW50IEEgc3RyaW5nIHJlYWQgYnkgc2NyZWVuIHJlYWRlcnMgaW5zdHJ1Y3RpbmcgdXNlcnMgdGhhdCBwcmVzc2luZ1xuICAgKiAgICB0aGUgZGVsZXRlIGtleSB3aWxsIHJlbW92ZSB0aGUgY2hpcC5cbiAgICogQHBhcmFtIHtzdHJpbmc9fSBkZWxldGUtYnV0dG9uLWxhYmVsIEEgbGFiZWwgZm9yIHRoZSBkZWxldGUgYnV0dG9uLiBBbHNvIGhpZGRlbiBhbmQgcmVhZCBieVxuICAgKiAgICBzY3JlZW4gcmVhZGVycy5cbiAgICpcbiAgICogQHVzYWdlXG4gICAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gICAqICAgPG1kLWNoaXBzXG4gICAqICAgICAgIG5nLW1vZGVsPVwibXlJdGVtc1wiXG4gICAqICAgICAgIHBsYWNlaG9sZGVyPVwiQWRkIGFuIGl0ZW1cIlxuICAgKiAgICAgICByZWFkb25seT1cImlzUmVhZE9ubHlcIj5cbiAgICogICA8L21kLWNoaXBzPlxuICAgKiA8L2hsanM+XG4gICAqXG4gICAqL1xuXG5cbiAgdmFyIE1EX0NISVBTX1RFTVBMQVRFID0gJ1xcXG4gICAgICA8bWQtY2hpcHMtd3JhcFxcXG4gICAgICAgICAgbmctaWY9XCIhJG1kQ2hpcHNDdHJsLnJlYWRvbmx5IHx8ICRtZENoaXBzQ3RybC5pdGVtcy5sZW5ndGggPiAwXCJcXFxuICAgICAgICAgIG5nLWtleWRvd249XCIkbWRDaGlwc0N0cmwuY2hpcEtleWRvd24oJGV2ZW50KVwiXFxcbiAgICAgICAgICBuZy1jbGFzcz1cInsgXFwnbWQtZm9jdXNlZFxcJzogJG1kQ2hpcHNDdHJsLmhhc0ZvY3VzKCkgfVwiXFxcbiAgICAgICAgICBjbGFzcz1cIm1kLWNoaXBzXCI+XFxcbiAgICAgICAgPG1kLWNoaXAgbmctcmVwZWF0PVwiJGNoaXAgaW4gJG1kQ2hpcHNDdHJsLml0ZW1zXCJcXFxuICAgICAgICAgICAgaW5kZXg9XCJ7eyRpbmRleH19XCJcXFxuICAgICAgICAgICAgbmctY2xhc3M9XCJ7XFwnbWQtZm9jdXNlZFxcJzogJG1kQ2hpcHNDdHJsLnNlbGVjdGVkQ2hpcCA9PSAkaW5kZXh9XCI+XFxcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwibWQtY2hpcC1jb250ZW50XCJcXFxuICAgICAgICAgICAgICB0YWJpbmRleD1cIi0xXCJcXFxuICAgICAgICAgICAgICBhcmlhLWhpZGRlbj1cInRydWVcIlxcXG4gICAgICAgICAgICAgIG5nLWZvY3VzPVwiISRtZENoaXBzQ3RybC5yZWFkb25seSAmJiAkbWRDaGlwc0N0cmwuc2VsZWN0Q2hpcCgkaW5kZXgpXCJcXFxuICAgICAgICAgICAgICBtZC1jaGlwLXRyYW5zY2x1ZGU9XCIkbWRDaGlwc0N0cmwuY2hpcENvbnRlbnRzVGVtcGxhdGVcIj48L2Rpdj5cXFxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZC1jaGlwLXJlbW92ZS1jb250YWluZXJcIlxcXG4gICAgICAgICAgICAgIG1kLWNoaXAtdHJhbnNjbHVkZT1cIiRtZENoaXBzQ3RybC5jaGlwUmVtb3ZlVGVtcGxhdGVcIj48L2Rpdj5cXFxuICAgICAgICA8L21kLWNoaXA+XFxcbiAgICAgICAgPGRpdiBuZy1pZj1cIiEkbWRDaGlwc0N0cmwucmVhZG9ubHkgJiYgJG1kQ2hpcHNDdHJsLm5nTW9kZWxDdHJsXCJcXFxuICAgICAgICAgICAgY2xhc3M9XCJtZC1jaGlwLWlucHV0LWNvbnRhaW5lclwiXFxcbiAgICAgICAgICAgIG1kLWNoaXAtdHJhbnNjbHVkZT1cIiRtZENoaXBzQ3RybC5jaGlwSW5wdXRUZW1wbGF0ZVwiPjwvZGl2PlxcXG4gICAgICAgIDwvZGl2PlxcXG4gICAgICA8L21kLWNoaXBzLXdyYXA+JztcblxuICB2YXIgQ0hJUF9JTlBVVF9URU1QTEFURSA9ICdcXFxuICAgICAgICA8aW5wdXRcXFxuICAgICAgICAgICAgdGFiaW5kZXg9XCIwXCJcXFxuICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJ7eyRtZENoaXBzQ3RybC5nZXRQbGFjZWhvbGRlcigpfX1cIlxcXG4gICAgICAgICAgICBhcmlhLWxhYmVsPVwie3skbWRDaGlwc0N0cmwuZ2V0UGxhY2Vob2xkZXIoKX19XCJcXFxuICAgICAgICAgICAgbmctbW9kZWw9XCIkbWRDaGlwc0N0cmwuY2hpcEJ1ZmZlclwiXFxcbiAgICAgICAgICAgIG5nLWZvY3VzPVwiJG1kQ2hpcHNDdHJsLm9uSW5wdXRGb2N1cygpXCJcXFxuICAgICAgICAgICAgbmctYmx1cj1cIiRtZENoaXBzQ3RybC5vbklucHV0Qmx1cigpXCJcXFxuICAgICAgICAgICAgbmcta2V5ZG93bj1cIiRtZENoaXBzQ3RybC5pbnB1dEtleWRvd24oJGV2ZW50KVwiPic7XG5cbiAgdmFyIENISVBfREVGQVVMVF9URU1QTEFURSA9ICdcXFxuICAgICAgPHNwYW4+e3skY2hpcH19PC9zcGFuPic7XG5cbiAgdmFyIENISVBfUkVNT1ZFX1RFTVBMQVRFID0gJ1xcXG4gICAgICA8YnV0dG9uXFxcbiAgICAgICAgICBjbGFzcz1cIm1kLWNoaXAtcmVtb3ZlXCJcXFxuICAgICAgICAgIG5nLWlmPVwiISRtZENoaXBzQ3RybC5yZWFkb25seVwiXFxcbiAgICAgICAgICBuZy1jbGljaz1cIiRtZENoaXBzQ3RybC5yZW1vdmVDaGlwQW5kRm9jdXNJbnB1dCgkJHJlcGxhY2VkU2NvcGUuJGluZGV4KVwiXFxcbiAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcXFxuICAgICAgICAgIGFyaWEtaGlkZGVuPVwidHJ1ZVwiXFxcbiAgICAgICAgICB0YWJpbmRleD1cIi0xXCI+XFxcbiAgICAgICAgPG1kLWljb24gbWQtc3ZnLWljb249XCJtZC1jbG9zZVwiPjwvbWQtaWNvbj5cXFxuICAgICAgICA8c3BhbiBjbGFzcz1cIm1kLXZpc3VhbGx5LWhpZGRlblwiPlxcXG4gICAgICAgICAge3skbWRDaGlwc0N0cmwuZGVsZXRlQnV0dG9uTGFiZWx9fVxcXG4gICAgICAgIDwvc3Bhbj5cXFxuICAgICAgPC9idXR0b24+JztcblxuICAvKipcbiAgICogTURDaGlwcyBEaXJlY3RpdmUgRGVmaW5pdGlvblxuICAgKi9cbiAgZnVuY3Rpb24gTWRDaGlwcyAoJG1kVGhlbWluZywgJG1kVXRpbCwgJGNvbXBpbGUsICRsb2csICR0aW1lb3V0KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRlbXBsYXRlOiBmdW5jdGlvbihlbGVtZW50LCBhdHRycykge1xuICAgICAgICAvLyBDbG9uZSB0aGUgZWxlbWVudCBpbnRvIGFuIGF0dHJpYnV0ZS4gQnkgcHJlcGVuZGluZyB0aGUgYXR0cmlidXRlXG4gICAgICAgIC8vIG5hbWUgd2l0aCAnJCcsIEFuZ3VsYXIgd29uJ3Qgd3JpdGUgaXQgaW50byB0aGUgRE9NLiBUaGUgY2xvbmVkXG4gICAgICAgIC8vIGVsZW1lbnQgcHJvcGFnYXRlcyB0byB0aGUgbGluayBmdW5jdGlvbiB2aWEgdGhlIGF0dHJzIGFyZ3VtZW50LFxuICAgICAgICAvLyB3aGVyZSB2YXJpb3VzIGNvbnRhaW5lZC1lbGVtZW50cyBjYW4gYmUgY29uc3VtZWQuXG4gICAgICAgIHZhciBjb250ZW50ID0gYXR0cnNbJyRtZFVzZXJUZW1wbGF0ZSddID0gZWxlbWVudC5jbG9uZSgpO1xuICAgICAgICByZXR1cm4gTURfQ0hJUFNfVEVNUExBVEU7XG4gICAgICB9LFxuICAgICAgcmVxdWlyZTogWydtZENoaXBzJ10sXG4gICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgY29udHJvbGxlcjogJ01kQ2hpcHNDdHJsJyxcbiAgICAgIGNvbnRyb2xsZXJBczogJyRtZENoaXBzQ3RybCcsXG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29tcGlsZTogY29tcGlsZSxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHJlYWRvbmx5OiAnPXJlYWRvbmx5JyxcbiAgICAgICAgcGxhY2Vob2xkZXI6ICdAJyxcbiAgICAgICAgc2Vjb25kYXJ5UGxhY2Vob2xkZXI6ICdAJyxcbiAgICAgICAgbWRPbkFwcGVuZDogJyYnLFxuICAgICAgICBkZWxldGVIaW50OiAnQCcsXG4gICAgICAgIGRlbGV0ZUJ1dHRvbkxhYmVsOiAnQCcsXG4gICAgICAgIHJlcXVpcmVNYXRjaDogJz0/bWRSZXF1aXJlTWF0Y2gnXG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEJ1aWxkcyB0aGUgZmluYWwgdGVtcGxhdGUgZm9yIGBtZC1jaGlwc2AgYW5kIHJldHVybnMgdGhlIHBvc3RMaW5rIGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQnVpbGRpbmcgdGhlIHRlbXBsYXRlIGludm9sdmVzIDMga2V5IGNvbXBvbmVudHM6XG4gICAgICogc3RhdGljIGNoaXBzXG4gICAgICogY2hpcCB0ZW1wbGF0ZVxuICAgICAqIGlucHV0IGNvbnRyb2xcbiAgICAgKlxuICAgICAqIElmIG5vIGBuZy1tb2RlbGAgaXMgcHJvdmlkZWQsIG9ubHkgdGhlIHN0YXRpYyBjaGlwIHdvcmsgbmVlZHMgdG8gYmUgZG9uZS5cbiAgICAgKlxuICAgICAqIElmIG5vIHVzZXItcGFzc2VkIGBtZC1jaGlwLXRlbXBsYXRlYCBleGlzdHMsIHRoZSBkZWZhdWx0IHRlbXBsYXRlIGlzIHVzZWQuIFRoaXMgcmVzdWx0aW5nXG4gICAgICogdGVtcGxhdGUgaXMgYXBwZW5kZWQgdG8gdGhlIGNoaXAgY29udGVudCBlbGVtZW50LlxuICAgICAqXG4gICAgICogVGhlIHJlbW92ZSBidXR0b24gbWF5IGJlIG92ZXJyaWRkZW4gYnkgcGFzc2luZyBhbiBlbGVtZW50IHdpdGggYW4gbWQtY2hpcC1yZW1vdmUgYXR0cmlidXRlLlxuICAgICAqXG4gICAgICogSWYgYW4gYGlucHV0YCBvciBgbWQtYXV0b2NvbXBsZXRlYCBlbGVtZW50IGlzIHByb3ZpZGVkIGJ5IHRoZSBjYWxsZXIsIGl0IGlzIHNldCBhc2lkZSBmb3JcbiAgICAgKiB0cmFuc2NsdXNpb24gbGF0ZXIuIFRoZSB0cmFuc2NsdXNpb24gaGFwcGVucyBpbiBgcG9zdExpbmtgIGFzIHRoZSBwYXJlbnQgc2NvcGUgaXMgcmVxdWlyZWQuXG4gICAgICogSWYgbm8gdXNlciBpbnB1dCBpcyBwcm92aWRlZCwgYSBkZWZhdWx0IG9uZSBpcyBhcHBlbmRlZCB0byB0aGUgaW5wdXQgY29udGFpbmVyIG5vZGUgaW4gdGhlXG4gICAgICogdGVtcGxhdGUuXG4gICAgICpcbiAgICAgKiBTdGF0aWMgQ2hpcHMgKGkuZS4gYG1kLWNoaXBgIGVsZW1lbnRzIHBhc3NlZCBmcm9tIHRoZSBjYWxsZXIpIGFyZSBnYXRoZXJlZCBhbmQgc2V0IGFzaWRlIGZvclxuICAgICAqIHRyYW5zY2x1c2lvbiBpbiB0aGUgYHBvc3RMaW5rYCBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqXG4gICAgICogQHBhcmFtIGVsZW1lbnRcbiAgICAgKiBAcGFyYW0gYXR0clxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb21waWxlKGVsZW1lbnQsIGF0dHIpIHtcbiAgICAgIC8vIEdyYWIgdGhlIHVzZXIgdGVtcGxhdGUgZnJvbSBhdHRyIGFuZCByZXNldCB0aGUgYXR0cmlidXRlIHRvIG51bGwuXG4gICAgICB2YXIgdXNlclRlbXBsYXRlID0gYXR0clsnJG1kVXNlclRlbXBsYXRlJ107XG4gICAgICBhdHRyWyckbWRVc2VyVGVtcGxhdGUnXSA9IG51bGw7XG5cbiAgICAgIC8vIFNldCB0aGUgY2hpcCByZW1vdmUsIGNoaXAgY29udGVudHMgYW5kIGNoaXAgaW5wdXQgdGVtcGxhdGVzLiBUaGUgbGluayBmdW5jdGlvbiB3aWxsIHB1dFxuICAgICAgLy8gdGhlbSBvbiB0aGUgc2NvcGUgZm9yIHRyYW5zY2x1c2lvbiBsYXRlci5cbiAgICAgIHZhciBjaGlwUmVtb3ZlVGVtcGxhdGUgICA9IGdldFRlbXBsYXRlQnlRdWVyeSgnbWQtY2hpcHM+KlttZC1jaGlwLXJlbW92ZV0nKSB8fCBDSElQX1JFTU9WRV9URU1QTEFURSxcbiAgICAgICAgICBjaGlwQ29udGVudHNUZW1wbGF0ZSA9IGdldFRlbXBsYXRlQnlRdWVyeSgnbWQtY2hpcHM+bWQtY2hpcC10ZW1wbGF0ZScpIHx8IENISVBfREVGQVVMVF9URU1QTEFURSxcbiAgICAgICAgICBjaGlwSW5wdXRUZW1wbGF0ZSAgICA9IGdldFRlbXBsYXRlQnlRdWVyeSgnbWQtY2hpcHM+bWQtYXV0b2NvbXBsZXRlJylcbiAgICAgICAgICAgICAgfHwgZ2V0VGVtcGxhdGVCeVF1ZXJ5KCdtZC1jaGlwcz5pbnB1dCcpXG4gICAgICAgICAgICAgIHx8IENISVBfSU5QVVRfVEVNUExBVEUsXG4gICAgICAgICAgc3RhdGljQ2hpcHMgPSB1c2VyVGVtcGxhdGUuZmluZCgnbWQtY2hpcCcpO1xuXG4gICAgICAvLyBXYXJuIG9mIG1hbGZvcm1lZCB0ZW1wbGF0ZS4gU2VlICMyNTQ1XG4gICAgICBpZiAodXNlclRlbXBsYXRlWzBdLnF1ZXJ5U2VsZWN0b3IoJ21kLWNoaXAtdGVtcGxhdGU+KlttZC1jaGlwLXJlbW92ZV0nKSkge1xuICAgICAgICAkbG9nLndhcm4oJ2ludmFsaWQgcGxhY2VtZW50IG9mIG1kLWNoaXAtcmVtb3ZlIHdpdGhpbiBtZC1jaGlwLXRlbXBsYXRlLicpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBnZXRUZW1wbGF0ZUJ5UXVlcnkgKHF1ZXJ5KSB7XG4gICAgICAgIGlmICghYXR0ci5uZ01vZGVsKSByZXR1cm47XG4gICAgICAgIHZhciBlbGVtZW50ID0gdXNlclRlbXBsYXRlWzBdLnF1ZXJ5U2VsZWN0b3IocXVlcnkpO1xuICAgICAgICByZXR1cm4gZWxlbWVudCAmJiBlbGVtZW50Lm91dGVySFRNTDtcbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiBDb25maWd1cmVzIGNvbnRyb2xsZXIgYW5kIHRyYW5zY2x1ZGVzLlxuICAgICAgICovXG4gICAgICByZXR1cm4gZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBjb250cm9sbGVycykge1xuXG4gICAgICAgICRtZFV0aWwuaW5pdE9wdGlvbmFsUHJvcGVydGllcyhzY29wZSwgYXR0cik7XG5cbiAgICAgICAgJG1kVGhlbWluZyhlbGVtZW50KTtcbiAgICAgICAgdmFyIG1kQ2hpcHNDdHJsID0gY29udHJvbGxlcnNbMF07XG4gICAgICAgIG1kQ2hpcHNDdHJsLmNoaXBDb250ZW50c1RlbXBsYXRlID0gY2hpcENvbnRlbnRzVGVtcGxhdGU7XG4gICAgICAgIG1kQ2hpcHNDdHJsLmNoaXBSZW1vdmVUZW1wbGF0ZSAgID0gY2hpcFJlbW92ZVRlbXBsYXRlO1xuICAgICAgICBtZENoaXBzQ3RybC5jaGlwSW5wdXRUZW1wbGF0ZSAgICA9IGNoaXBJbnB1dFRlbXBsYXRlO1xuXG4gICAgICAgIGVsZW1lbnRcbiAgICAgICAgICAgIC5hdHRyKHsgYXJpYUhpZGRlbjogdHJ1ZSwgdGFiaW5kZXg6IC0xIH0pXG4gICAgICAgICAgICAub24oJ2ZvY3VzJywgZnVuY3Rpb24gKCkgeyBtZENoaXBzQ3RybC5vbkZvY3VzKCk7IH0pO1xuXG4gICAgICAgIGlmIChhdHRyLm5nTW9kZWwpIHtcbiAgICAgICAgICBtZENoaXBzQ3RybC5jb25maWd1cmVOZ01vZGVsKGVsZW1lbnQuY29udHJvbGxlcignbmdNb2RlbCcpKTtcblxuICAgICAgICAgIC8vIElmIGFuIGBtZC1vbi1hcHBlbmRgIGF0dHJpYnV0ZSB3YXMgc2V0LCB0ZWxsIHRoZSBjb250cm9sbGVyIHRvIHVzZSB0aGUgZXhwcmVzc2lvblxuICAgICAgICAgIC8vIHdoZW4gYXBwZW5kaW5nIGNoaXBzLlxuICAgICAgICAgIGlmIChhdHRycy5tZE9uQXBwZW5kKSBtZENoaXBzQ3RybC51c2VNZE9uQXBwZW5kRXhwcmVzc2lvbigpO1xuXG4gICAgICAgICAgLy8gVGhlIG1kLWF1dG9jb21wbGV0ZSBhbmQgaW5wdXQgZWxlbWVudHMgd29uJ3QgYmUgY29tcGlsZWQgdW50aWwgYWZ0ZXIgdGhpcyBkaXJlY3RpdmVcbiAgICAgICAgICAvLyBpcyBjb21wbGV0ZSAoZHVlIHRvIHRoZWlyIG5lc3RlZCBuYXR1cmUpLiBXYWl0IGEgdGljayBiZWZvcmUgbG9va2luZyBmb3IgdGhlbSB0b1xuICAgICAgICAgIC8vIGNvbmZpZ3VyZSB0aGUgY29udHJvbGxlci5cbiAgICAgICAgICBpZiAoY2hpcElucHV0VGVtcGxhdGUgIT0gQ0hJUF9JTlBVVF9URU1QTEFURSkge1xuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGlmIChjaGlwSW5wdXRUZW1wbGF0ZS5pbmRleE9mKCc8bWQtYXV0b2NvbXBsZXRlJykgPT09IDApXG4gICAgICAgICAgICAgICAgbWRDaGlwc0N0cmxcbiAgICAgICAgICAgICAgICAgICAgLmNvbmZpZ3VyZUF1dG9jb21wbGV0ZShlbGVtZW50LmZpbmQoJ21kLWF1dG9jb21wbGV0ZScpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY29udHJvbGxlcignbWRBdXRvY29tcGxldGUnKSk7XG4gICAgICAgICAgICAgIG1kQ2hpcHNDdHJsLmNvbmZpZ3VyZVVzZXJJbnB1dChlbGVtZW50LmZpbmQoJ2lucHV0JykpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ29tcGlsZSB3aXRoIHRoZSBwYXJlbnQncyBzY29wZSBhbmQgcHJlcGVuZCBhbnkgc3RhdGljIGNoaXBzIHRvIHRoZSB3cmFwcGVyLlxuICAgICAgICBpZiAoc3RhdGljQ2hpcHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHZhciBjb21waWxlZFN0YXRpY0NoaXBzID0gJGNvbXBpbGUoc3RhdGljQ2hpcHMpKHNjb3BlLiRwYXJlbnQpO1xuICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkgeyBlbGVtZW50LmZpbmQoJ21kLWNoaXBzLXdyYXAnKS5wcmVwZW5kKGNvbXBpbGVkU3RhdGljQ2hpcHMpOyB9KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH1cbiAgTWRDaGlwcy4kaW5qZWN0ID0gW1wiJG1kVGhlbWluZ1wiLCBcIiRtZFV0aWxcIiwgXCIkY29tcGlsZVwiLCBcIiRsb2dcIiwgXCIkdGltZW91dFwiXTtcblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmNoaXBzJylcbiAgICAuY29udHJvbGxlcignTWRDb250YWN0Q2hpcHNDdHJsJywgTWRDb250YWN0Q2hpcHNDdHJsKTtcblxuXG5cbi8qKlxuICogQ29udHJvbGxlciBmb3IgdGhlIE1kQ29udGFjdENoaXBzIGNvbXBvbmVudFxuICogQGNvbnN0cnVjdG9yXG4gKi9cbmZ1bmN0aW9uIE1kQ29udGFjdENoaXBzQ3RybCAoKSB7XG4gIC8qKiBAdHlwZSB7T2JqZWN0fSAqL1xuICB0aGlzLnNlbGVjdGVkSXRlbSA9IG51bGw7XG5cbiAgLyoqIEB0eXBlIHtzdHJpbmd9ICovXG4gIHRoaXMuc2VhcmNoVGV4dCA9ICcnO1xufVxuXG5cbk1kQ29udGFjdENoaXBzQ3RybC5wcm90b3R5cGUucXVlcnlDb250YWN0ID0gZnVuY3Rpb24oc2VhcmNoVGV4dCkge1xuICB2YXIgcmVzdWx0cyA9IHRoaXMuY29udGFjdFF1ZXJ5KHsnJHF1ZXJ5Jzogc2VhcmNoVGV4dH0pO1xuICByZXR1cm4gdGhpcy5maWx0ZXJTZWxlY3RlZCA/XG4gICAgICByZXN1bHRzLmZpbHRlcihhbmd1bGFyLmJpbmQodGhpcywgdGhpcy5maWx0ZXJTZWxlY3RlZENvbnRhY3RzKSkgOiByZXN1bHRzO1xufTtcblxuXG5NZENvbnRhY3RDaGlwc0N0cmwucHJvdG90eXBlLmZpbHRlclNlbGVjdGVkQ29udGFjdHMgPSBmdW5jdGlvbihjb250YWN0KSB7XG4gIHJldHVybiB0aGlzLmNvbnRhY3RzLmluZGV4T2YoY29udGFjdCkgPT0gLTE7XG59O1xuXG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuICBhbmd1bGFyXG4gICAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmNoaXBzJylcbiAgICAgIC5kaXJlY3RpdmUoJ21kQ29udGFjdENoaXBzJywgTWRDb250YWN0Q2hpcHMpO1xuXG4gIC8qKlxuICAgKiBAbmdkb2MgZGlyZWN0aXZlXG4gICAqIEBuYW1lIG1kQ29udGFjdENoaXBzXG4gICAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5jaGlwc1xuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogYDxtZC1jb250YWN0LWNoaXBzPmAgaXMgYW4gaW5wdXQgY29tcG9uZW50IGJhc2VkIG9uIGBtZC1jaGlwc2AgYW5kIG1ha2VzIHVzZSBvZiBhblxuICAgKiAgICBgbWQtYXV0b2NvbXBsZXRlYCBlbGVtZW50LiBUaGUgY29tcG9uZW50IGFsbG93cyB0aGUgY2FsbGVyIHRvIHN1cHBseSBhIHF1ZXJ5IGV4cHJlc3Npb25cbiAgICogICAgd2hpY2ggcmV0dXJucyAgYSBsaXN0IG9mIHBvc3NpYmxlIGNvbnRhY3RzLiBUaGUgdXNlciBjYW4gc2VsZWN0IG9uZSBvZiB0aGVzZSBhbmQgYWRkIGl0IHRvXG4gICAqICAgIHRoZSBsaXN0IG9mIGNoaXBzLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZz18b2JqZWN0PX0gbmctbW9kZWwgQSBtb2RlbCB0byBiaW5kIHRoZSBsaXN0IG9mIGl0ZW1zIHRvXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gcGxhY2Vob2xkZXIgUGxhY2Vob2xkZXIgdGV4dCB0aGF0IHdpbGwgYmUgZm9yd2FyZGVkIHRvIHRoZSBpbnB1dC5cbiAgICogQHBhcmFtIHtzdHJpbmc9fSBzZWNvbmRhcnktcGxhY2Vob2xkZXIgUGxhY2Vob2xkZXIgdGV4dCB0aGF0IHdpbGwgYmUgZm9yd2FyZGVkIHRvIHRoZSBpbnB1dCxcbiAgICogICAgZGlzcGxheWVkIHdoZW4gdGhlcmUgaXMgYXQgbGVhc3Qgb24gaXRlbSBpbiB0aGUgbGlzdFxuICAgKiBAcGFyYW0ge2V4cHJlc3Npb259IG1kLWNvbnRhY3RzIEFuIGV4cHJlc3Npb24gZXhwZWN0ZWQgdG8gcmV0dXJuIGNvbnRhY3RzIG1hdGNoaW5nIHRoZSBzZWFyY2hcbiAgICogICAgdGVzdCwgYCRxdWVyeWAuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBtZC1jb250YWN0LW5hbWUgVGhlIGZpZWxkIG5hbWUgb2YgdGhlIGNvbnRhY3Qgb2JqZWN0IHJlcHJlc2VudGluZyB0aGVcbiAgICogICAgY29udGFjdCdzIG5hbWUuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBtZC1jb250YWN0LWVtYWlsIFRoZSBmaWVsZCBuYW1lIG9mIHRoZSBjb250YWN0IG9iamVjdCByZXByZXNlbnRpbmcgdGhlXG4gICAqICAgIGNvbnRhY3QncyBlbWFpbCBhZGRyZXNzLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbWQtY29udGFjdC1pbWFnZSBUaGUgZmllbGQgbmFtZSBvZiB0aGUgY29udGFjdCBvYmplY3QgcmVwcmVzZW50aW5nIHRoZVxuICAgKiAgICBjb250YWN0J3MgaW1hZ2UuXG4gICAqXG4gICAqXG4gICAqIC8vIFRoZSBmb2xsb3dpbmcgYXR0cmlidXRlIGhhcyBiZWVuIHJlbW92ZWQgYnV0IG1heSBjb21lIGJhY2suXG4gICAqIEBwYXJhbSB7ZXhwcmVzc2lvbj19IGZpbHRlci1zZWxlY3RlZCBXaGV0aGVyIHRvIGZpbHRlciBzZWxlY3RlZCBjb250YWN0cyBmcm9tIHRoZSBsaXN0IG9mXG4gICAqICAgIHN1Z2dlc3Rpb25zIHNob3duIGluIHRoZSBhdXRvY29tcGxldGUuXG4gICAqXG4gICAqXG4gICAqXG4gICAqIEB1c2FnZVxuICAgKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxuICAgKiAgIDxtZC1jb250YWN0LWNoaXBzXG4gICAqICAgICAgIG5nLW1vZGVsPVwiY3RybC5jb250YWN0c1wiXG4gICAqICAgICAgIG1kLWNvbnRhY3RzPVwiY3RybC5xdWVyeVNlYXJjaCgkcXVlcnkpXCJcbiAgICogICAgICAgbWQtY29udGFjdC1uYW1lPVwibmFtZVwiXG4gICAqICAgICAgIG1kLWNvbnRhY3QtaW1hZ2U9XCJpbWFnZVwiXG4gICAqICAgICAgIG1kLWNvbnRhY3QtZW1haWw9XCJlbWFpbFwiXG4gICAqICAgICAgIHBsYWNlaG9sZGVyPVwiVG9cIj5cbiAgICogICA8L21kLWNvbnRhY3QtY2hpcHM+XG4gICAqIDwvaGxqcz5cbiAgICpcbiAgICovXG5cblxuICB2YXIgTURfQ09OVEFDVF9DSElQU19URU1QTEFURSA9ICdcXFxuICAgICAgPG1kLWNoaXBzIGNsYXNzPVwibWQtY29udGFjdC1jaGlwc1wiXFxcbiAgICAgICAgICBuZy1tb2RlbD1cIiRtZENvbnRhY3RDaGlwc0N0cmwuY29udGFjdHNcIlxcXG4gICAgICAgICAgbWQtcmVxdWlyZS1tYXRjaD1cIiRtZENvbnRhY3RDaGlwc0N0cmwucmVxdWlyZU1hdGNoXCJcXFxuICAgICAgICAgIG1kLWF1dG9jb21wbGV0ZS1zbmFwPlxcXG4gICAgICAgICAgPG1kLWF1dG9jb21wbGV0ZVxcXG4gICAgICAgICAgICAgIG1kLW1lbnUtY2xhc3M9XCJtZC1jb250YWN0LWNoaXBzLXN1Z2dlc3Rpb25zXCJcXFxuICAgICAgICAgICAgICBtZC1zZWxlY3RlZC1pdGVtPVwiJG1kQ29udGFjdENoaXBzQ3RybC5zZWxlY3RlZEl0ZW1cIlxcXG4gICAgICAgICAgICAgIG1kLXNlYXJjaC10ZXh0PVwiJG1kQ29udGFjdENoaXBzQ3RybC5zZWFyY2hUZXh0XCJcXFxuICAgICAgICAgICAgICBtZC1pdGVtcz1cIml0ZW0gaW4gJG1kQ29udGFjdENoaXBzQ3RybC5xdWVyeUNvbnRhY3QoJG1kQ29udGFjdENoaXBzQ3RybC5zZWFyY2hUZXh0KVwiXFxcbiAgICAgICAgICAgICAgbWQtaXRlbS10ZXh0PVwiJG1kQ29udGFjdENoaXBzQ3RybC5tZENvbnRhY3ROYW1lXCJcXFxuICAgICAgICAgICAgICBtZC1uby1jYWNoZT1cInRydWVcIlxcXG4gICAgICAgICAgICAgIG1kLWF1dG9zZWxlY3RcXFxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cInt7JG1kQ29udGFjdENoaXBzQ3RybC5jb250YWN0cy5sZW5ndGggPT0gMCA/XFxcbiAgICAgICAgICAgICAgICAgICRtZENvbnRhY3RDaGlwc0N0cmwucGxhY2Vob2xkZXIgOiAkbWRDb250YWN0Q2hpcHNDdHJsLnNlY29uZGFyeVBsYWNlaG9sZGVyfX1cIj5cXFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1kLWNvbnRhY3Qtc3VnZ2VzdGlvblwiPlxcXG4gICAgICAgICAgICAgIDxpbWcgXFxcbiAgICAgICAgICAgICAgICAgIG5nLXNyYz1cInt7aXRlbVskbWRDb250YWN0Q2hpcHNDdHJsLmNvbnRhY3RJbWFnZV19fVwiXFxcbiAgICAgICAgICAgICAgICAgIGFsdD1cInt7aXRlbVskbWRDb250YWN0Q2hpcHNDdHJsLmNvbnRhY3ROYW1lXX19XCIgLz5cXFxuICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1kLWNvbnRhY3QtbmFtZVwiIG1kLWhpZ2hsaWdodC10ZXh0PVwiJG1kQ29udGFjdENoaXBzQ3RybC5zZWFyY2hUZXh0XCI+XFxcbiAgICAgICAgICAgICAgICB7e2l0ZW1bJG1kQ29udGFjdENoaXBzQ3RybC5jb250YWN0TmFtZV19fVxcXG4gICAgICAgICAgICAgIDwvc3Bhbj5cXFxuICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1kLWNvbnRhY3QtZW1haWxcIiA+e3tpdGVtWyRtZENvbnRhY3RDaGlwc0N0cmwuY29udGFjdEVtYWlsXX19PC9zcGFuPlxcXG4gICAgICAgICAgICA8L2Rpdj5cXFxuICAgICAgICAgIDwvbWQtYXV0b2NvbXBsZXRlPlxcXG4gICAgICAgICAgPG1kLWNoaXAtdGVtcGxhdGU+XFxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZC1jb250YWN0LWF2YXRhclwiPlxcXG4gICAgICAgICAgICAgIDxpbWcgXFxcbiAgICAgICAgICAgICAgICAgIG5nLXNyYz1cInt7JGNoaXBbJG1kQ29udGFjdENoaXBzQ3RybC5jb250YWN0SW1hZ2VdfX1cIlxcXG4gICAgICAgICAgICAgICAgICBhbHQ9XCJ7eyRjaGlwWyRtZENvbnRhY3RDaGlwc0N0cmwuY29udGFjdE5hbWVdfX1cIiAvPlxcXG4gICAgICAgICAgICA8L2Rpdj5cXFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1kLWNvbnRhY3QtbmFtZVwiPlxcXG4gICAgICAgICAgICAgIHt7JGNoaXBbJG1kQ29udGFjdENoaXBzQ3RybC5jb250YWN0TmFtZV19fVxcXG4gICAgICAgICAgICA8L2Rpdj5cXFxuICAgICAgICAgIDwvbWQtY2hpcC10ZW1wbGF0ZT5cXFxuICAgICAgPC9tZC1jaGlwcz4nO1xuXG5cbiAgLyoqXG4gICAqIE1EQ29udGFjdENoaXBzIERpcmVjdGl2ZSBEZWZpbml0aW9uXG4gICAqXG4gICAqIEBwYXJhbSAkbWRUaGVtaW5nXG4gICAqIEByZXR1cm5zIHsqfVxuICAgKiBAbmdJbmplY3RcbiAgICovXG4gIGZ1bmN0aW9uIE1kQ29udGFjdENoaXBzICgkbWRUaGVtaW5nLCAkbWRVdGlsKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRlbXBsYXRlOiBmdW5jdGlvbihlbGVtZW50LCBhdHRycykge1xuICAgICAgICByZXR1cm4gTURfQ09OVEFDVF9DSElQU19URU1QTEFURTtcbiAgICAgIH0sXG4gICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgY29udHJvbGxlcjogJ01kQ29udGFjdENoaXBzQ3RybCcsXG4gICAgICBjb250cm9sbGVyQXM6ICckbWRDb250YWN0Q2hpcHNDdHJsJyxcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb21waWxlOiBjb21waWxlLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgY29udGFjdFF1ZXJ5OiAnJm1kQ29udGFjdHMnLFxuICAgICAgICBwbGFjZWhvbGRlcjogJ0AnLFxuICAgICAgICBzZWNvbmRhcnlQbGFjZWhvbGRlcjogJ0AnLFxuICAgICAgICBjb250YWN0TmFtZTogJ0BtZENvbnRhY3ROYW1lJyxcbiAgICAgICAgY29udGFjdEltYWdlOiAnQG1kQ29udGFjdEltYWdlJyxcbiAgICAgICAgY29udGFjdEVtYWlsOiAnQG1kQ29udGFjdEVtYWlsJyxcbiAgICAgICAgY29udGFjdHM6ICc9bmdNb2RlbCcsXG4gICAgICAgIHJlcXVpcmVNYXRjaDogJz0/bWRSZXF1aXJlTWF0Y2gnXG4gICAgICB9XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGNvbXBpbGUoZWxlbWVudCwgYXR0cikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRycywgY29udHJvbGxlcnMpIHtcblxuICAgICAgICAkbWRVdGlsLmluaXRPcHRpb25hbFByb3BlcnRpZXMoc2NvcGUsIGF0dHIpO1xuICAgICAgICAkbWRUaGVtaW5nKGVsZW1lbnQpO1xuXG4gICAgICAgIGVsZW1lbnQuYXR0cigndGFiaW5kZXgnLCAnLTEnKTtcbiAgICAgIH07XG4gICAgfVxuICB9XG4gIE1kQ29udGFjdENoaXBzLiRpbmplY3QgPSBbXCIkbWRUaGVtaW5nXCIsIFwiJG1kVXRpbFwiXTtcblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogQG5nZG9jIGRpcmVjdGl2ZVxuICogQG5hbWUgbWRUYWJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy50YWJzXG4gKlxuICogQHJlc3RyaWN0IEVcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFVzZSB0aGUgYDxtZC10YWI+YCBhIG5lc3RlZCBkaXJlY3RpdmUgdXNlZCB3aXRoaW4gYDxtZC10YWJzPmAgdG8gc3BlY2lmeSBhIHRhYiB3aXRoIGEgKipsYWJlbCoqIGFuZCBvcHRpb25hbCAqdmlldyBjb250ZW50Ki5cbiAqXG4gKiBJZiB0aGUgYGxhYmVsYCBhdHRyaWJ1dGUgaXMgbm90IHNwZWNpZmllZCwgdGhlbiBhbiBvcHRpb25hbCBgPG1kLXRhYi1sYWJlbD5gIHRhZyBjYW4gYmUgdXNlZCB0byBzcGVjaWZ5IG1vcmVcbiAqIGNvbXBsZXggdGFiIGhlYWRlciBtYXJrdXAuIElmIG5laXRoZXIgdGhlICoqbGFiZWwqKiBub3IgdGhlICoqbWQtdGFiLWxhYmVsKiogYXJlIHNwZWNpZmllZCwgdGhlbiB0aGUgbmVzdGVkXG4gKiBtYXJrdXAgb2YgdGhlIGA8bWQtdGFiPmAgaXMgdXNlZCBhcyB0aGUgdGFiIGhlYWRlciBtYXJrdXAuXG4gKlxuICogUGxlYXNlIG5vdGUgdGhhdCBpZiB5b3UgdXNlIGA8bWQtdGFiLWxhYmVsPmAsIHlvdXIgY29udGVudCAqKk1VU1QqKiBiZSB3cmFwcGVkIGluIHRoZSBgPG1kLXRhYi1ib2R5PmAgdGFnLiAgVGhpc1xuICogaXMgdG8gZGVmaW5lIGEgY2xlYXIgc2VwYXJhdGlvbiBiZXR3ZWVuIHRoZSB0YWIgY29udGVudCBhbmQgdGhlIHRhYiBsYWJlbC5cbiAqXG4gKiBJZiBhIHRhYiAqKmxhYmVsKiogaGFzIGJlZW4gaWRlbnRpZmllZCwgdGhlbiBhbnkgKipub24tKipgPG1kLXRhYi1sYWJlbD5gIG1hcmt1cFxuICogd2lsbCBiZSBjb25zaWRlcmVkIHRhYiBjb250ZW50IGFuZCB3aWxsIGJlIHRyYW5zY2x1ZGVkIHRvIHRoZSBpbnRlcm5hbCBgPGRpdiBjbGFzcz1cIm1kLXRhYnMtY29udGVudFwiPmAgY29udGFpbmVyLlxuICpcbiAqIFRoaXMgY29udGFpbmVyIGlzIHVzZWQgYnkgdGhlIFRhYnNDb250cm9sbGVyIHRvIHNob3cvaGlkZSB0aGUgYWN0aXZlIHRhYidzIGNvbnRlbnQgdmlldy4gVGhpcyBzeW5jaHJvbml6YXRpb24gaXNcbiAqIGF1dG9tYXRpY2FsbHkgbWFuYWdlZCBieSB0aGUgaW50ZXJuYWwgVGFic0NvbnRyb2xsZXIgd2hlbmV2ZXIgdGhlIHRhYiBzZWxlY3Rpb24gY2hhbmdlcy4gU2VsZWN0aW9uIGNoYW5nZXMgY2FuXG4gKiBiZSBpbml0aWF0ZWQgdmlhIGRhdGEgYmluZGluZyBjaGFuZ2VzLCBwcm9ncmFtbWF0aWMgaW52b2NhdGlvbiwgb3IgdXNlciBnZXN0dXJlcy5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZz19IGxhYmVsIE9wdGlvbmFsIGF0dHJpYnV0ZSB0byBzcGVjaWZ5IGEgc2ltcGxlIHN0cmluZyBhcyB0aGUgdGFiIGxhYmVsXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBkaXNhYmxlZCBJZiBwcmVzZW50LCBkaXNhYmxlZCB0YWIgc2VsZWN0aW9uLlxuICogQHBhcmFtIHtleHByZXNzaW9uPX0gbWQtb24tZGVzZWxlY3QgRXhwcmVzc2lvbiB0byBiZSBldmFsdWF0ZWQgYWZ0ZXIgdGhlIHRhYiBoYXMgYmVlbiBkZS1zZWxlY3RlZC5cbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbj19IG1kLW9uLXNlbGVjdCBFeHByZXNzaW9uIHRvIGJlIGV2YWx1YXRlZCBhZnRlciB0aGUgdGFiIGhhcyBiZWVuIHNlbGVjdGVkLlxuICpcbiAqXG4gKiBAdXNhZ2VcbiAqXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxuICogPG1kLXRhYiBsYWJlbD1cIlwiIGRpc2FibGVkPVwiXCIgbWQtb24tc2VsZWN0PVwiXCIgbWQtb24tZGVzZWxlY3Q9XCJcIiA+XG4gKiAgIDxoMz5NeSBUYWIgY29udGVudDwvaDM+XG4gKiA8L21kLXRhYj5cbiAqXG4gKiA8bWQtdGFiID5cbiAqICAgPG1kLXRhYi1sYWJlbD5cbiAqICAgICA8aDM+TXkgVGFiIGNvbnRlbnQ8L2gzPlxuICogICA8L21kLXRhYi1sYWJlbD5cbiAqICAgPG1kLXRhYi1ib2R5PlxuICogICAgIDxwPlxuICogICAgICAgU2VkIHV0IHBlcnNwaWNpYXRpcyB1bmRlIG9tbmlzIGlzdGUgbmF0dXMgZXJyb3Igc2l0IHZvbHVwdGF0ZW0gYWNjdXNhbnRpdW0gZG9sb3JlbXF1ZSBsYXVkYW50aXVtLFxuICogICAgICAgdG90YW0gcmVtIGFwZXJpYW0sIGVhcXVlIGlwc2EgcXVhZSBhYiBpbGxvIGludmVudG9yZSB2ZXJpdGF0aXMgZXQgcXVhc2kgYXJjaGl0ZWN0byBiZWF0YWUgdml0YWVcbiAqICAgICAgIGRpY3RhIHN1bnQgZXhwbGljYWJvLiBOZW1vIGVuaW0gaXBzYW0gdm9sdXB0YXRlbSBxdWlhIHZvbHVwdGFzIHNpdCBhc3Blcm5hdHVyIGF1dCBvZGl0IGF1dCBmdWdpdCxcbiAqICAgICAgIHNlZCBxdWlhIGNvbnNlcXV1bnR1ciBtYWduaSBkb2xvcmVzIGVvcyBxdWkgcmF0aW9uZSB2b2x1cHRhdGVtIHNlcXVpIG5lc2NpdW50LlxuICogICAgIDwvcD5cbiAqICAgPC9tZC10YWItYm9keT5cbiAqIDwvbWQtdGFiPlxuICogPC9obGpzPlxuICpcbiAqL1xuYW5ndWxhclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMudGFicycpXG4gICAgLmRpcmVjdGl2ZSgnbWRUYWInLCBNZFRhYik7XG5cbmZ1bmN0aW9uIE1kVGFiICgpIHtcbiAgcmV0dXJuIHtcbiAgICByZXF1aXJlOiAnXj9tZFRhYnMnLFxuICAgIHRlcm1pbmFsOiB0cnVlLFxuICAgIHRlbXBsYXRlOiBmdW5jdGlvbiAoZWxlbWVudCwgYXR0cikge1xuICAgICAgdmFyIGxhYmVsID0gZ2V0TGFiZWwoKSxcbiAgICAgICAgICBib2R5ICA9IGdldFRlbXBsYXRlKCk7XG4gICAgICByZXR1cm4gJycgK1xuICAgICAgICAgICc8bWQtdGFiLWxhYmVsPicgKyBsYWJlbCArICc8L21kLXRhYi1sYWJlbD4nICtcbiAgICAgICAgICAnPG1kLXRhYi1ib2R5PicgKyBib2R5ICsgJzwvbWQtdGFiLWJvZHk+JztcbiAgICAgIGZ1bmN0aW9uIGdldExhYmVsICgpIHtcbiAgICAgICAgcmV0dXJuIGdldExhYmVsRWxlbWVudCgpIHx8IGdldExhYmVsQXR0cmlidXRlKCkgfHwgZ2V0RWxlbWVudENvbnRlbnRzKCk7XG4gICAgICAgIGZ1bmN0aW9uIGdldExhYmVsQXR0cmlidXRlICgpIHsgcmV0dXJuIGF0dHIubGFiZWw7IH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0TGFiZWxFbGVtZW50ICgpIHtcbiAgICAgICAgICB2YXIgbGFiZWwgPSBlbGVtZW50LmZpbmQoJ21kLXRhYi1sYWJlbCcpLmVxKDApO1xuICAgICAgICAgIGlmIChsYWJlbC5sZW5ndGgpIHJldHVybiBsYWJlbC5yZW1vdmUoKS5odG1sKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0RWxlbWVudENvbnRlbnRzICgpIHtcbiAgICAgICAgICB2YXIgaHRtbCA9IGVsZW1lbnQuaHRtbCgpO1xuICAgICAgICAgIGVsZW1lbnQuZW1wdHkoKTtcbiAgICAgICAgICByZXR1cm4gaHRtbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZnVuY3Rpb24gZ2V0VGVtcGxhdGUgKCkge1xuICAgICAgICB2YXIgY29udGVudCA9IGVsZW1lbnQuZmluZCgnbWQtdGFiLWJvZHknKS5lcSgwKSxcbiAgICAgICAgICAgIHRlbXBsYXRlID0gY29udGVudC5sZW5ndGggPyBjb250ZW50Lmh0bWwoKSA6IGF0dHIubGFiZWwgPyBlbGVtZW50Lmh0bWwoKSA6ICcnO1xuICAgICAgICBpZiAoY29udGVudC5sZW5ndGgpIGNvbnRlbnQucmVtb3ZlKCk7XG4gICAgICAgIGVsc2UgaWYgKGF0dHIubGFiZWwpIGVsZW1lbnQuZW1wdHkoKTtcbiAgICAgICAgcmV0dXJuIHRlbXBsYXRlO1xuICAgICAgfVxuICAgIH0sXG4gICAgc2NvcGU6IHtcbiAgICAgIGFjdGl2ZTogICAnPT9tZEFjdGl2ZScsXG4gICAgICBkaXNhYmxlZDogJz0/bmdEaXNhYmxlZCcsXG4gICAgICBzZWxlY3Q6ICAgJyY/bWRPblNlbGVjdCcsXG4gICAgICBkZXNlbGVjdDogJyY/bWRPbkRlc2VsZWN0J1xuICAgIH0sXG4gICAgbGluazogcG9zdExpbmtcbiAgfTtcblxuICBmdW5jdGlvbiBwb3N0TGluayAoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmwpIHtcbiAgICBpZiAoIWN0cmwpIHJldHVybjtcbiAgICB2YXIgdGFicyA9IGVsZW1lbnQucGFyZW50KClbMF0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ21kLXRhYicpLFxuICAgICAgICBpbmRleCA9IEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwodGFicywgZWxlbWVudFswXSksXG4gICAgICAgIGJvZHkgPSBlbGVtZW50LmZpbmQoJ21kLXRhYi1ib2R5JykuZXEoMCkucmVtb3ZlKCksXG4gICAgICAgIGxhYmVsID0gZWxlbWVudC5maW5kKCdtZC10YWItbGFiZWwnKS5lcSgwKS5yZW1vdmUoKSxcbiAgICAgICAgZGF0YSA9IGN0cmwuaW5zZXJ0VGFiKHtcbiAgICAgICAgICBzY29wZTogICAgc2NvcGUsXG4gICAgICAgICAgcGFyZW50OiAgIHNjb3BlLiRwYXJlbnQsXG4gICAgICAgICAgaW5kZXg6ICAgIGluZGV4LFxuICAgICAgICAgIGVsZW1lbnQ6ICBlbGVtZW50LFxuICAgICAgICAgIHRlbXBsYXRlOiBib2R5Lmh0bWwoKSxcbiAgICAgICAgICBsYWJlbDogICAgbGFiZWwuaHRtbCgpXG4gICAgICAgIH0sIGluZGV4KTtcblxuICAgIHNjb3BlLnNlbGVjdCAgID0gc2NvcGUuc2VsZWN0ICAgfHwgYW5ndWxhci5ub29wO1xuICAgIHNjb3BlLmRlc2VsZWN0ID0gc2NvcGUuZGVzZWxlY3QgfHwgYW5ndWxhci5ub29wO1xuXG4gICAgc2NvcGUuJHdhdGNoKCdhY3RpdmUnLCBmdW5jdGlvbiAoYWN0aXZlKSB7IGlmIChhY3RpdmUpIGN0cmwuc2VsZWN0KGRhdGEuZ2V0SW5kZXgoKSk7IH0pO1xuICAgIHNjb3BlLiR3YXRjaCgnZGlzYWJsZWQnLCBmdW5jdGlvbiAoKSB7IGN0cmwucmVmcmVzaEluZGV4KCk7IH0pO1xuICAgIHNjb3BlLiR3YXRjaChcbiAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKHRhYnMsIGVsZW1lbnRbMF0pO1xuICAgICAgICB9LFxuICAgICAgICBmdW5jdGlvbiAobmV3SW5kZXgpIHtcbiAgICAgICAgICBkYXRhLmluZGV4ID0gbmV3SW5kZXg7XG4gICAgICAgICAgY3RybC51cGRhdGVUYWJPcmRlcigpO1xuICAgICAgICB9XG4gICAgKTtcbiAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkgeyBjdHJsLnJlbW92ZVRhYihkYXRhKTsgfSk7XG5cbiAgfVxufVxuXG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMudGFicycpXG4gICAgLmRpcmVjdGl2ZSgnbWRUYWJJdGVtJywgTWRUYWJJdGVtKTtcblxuZnVuY3Rpb24gTWRUYWJJdGVtICgpIHtcbiAgcmV0dXJuIHtcbiAgICByZXF1aXJlOiAnXj9tZFRhYnMnLFxuICAgIGxpbms6IGZ1bmN0aW9uIGxpbmsgKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsKSB7XG4gICAgICBpZiAoIWN0cmwpIHJldHVybjtcbiAgICAgIGN0cmwuYXR0YWNoUmlwcGxlKHNjb3BlLCBlbGVtZW50KTtcbiAgICB9XG4gIH07XG59XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy50YWJzJylcbiAgICAuZGlyZWN0aXZlKCdtZFRhYkxhYmVsJywgTWRUYWJMYWJlbCk7XG5cbmZ1bmN0aW9uIE1kVGFiTGFiZWwgKCkge1xuICByZXR1cm4geyB0ZXJtaW5hbDogdHJ1ZSB9O1xufVxuXG5cbn0pKCk7XG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy50YWJzJylcbiAgICAuZGlyZWN0aXZlKCdtZFRhYlNjcm9sbCcsIE1kVGFiU2Nyb2xsKTtcblxuZnVuY3Rpb24gTWRUYWJTY3JvbGwgKCRwYXJzZSkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgY29tcGlsZTogZnVuY3Rpb24gKCRlbGVtZW50LCBhdHRyKSB7XG4gICAgICB2YXIgZm4gPSAkcGFyc2UoYXR0ci5tZFRhYlNjcm9sbCwgbnVsbCwgdHJ1ZSk7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gbmdFdmVudEhhbmRsZXIgKHNjb3BlLCBlbGVtZW50KSB7XG4gICAgICAgIGVsZW1lbnQub24oJ21vdXNld2hlZWwnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkgeyBmbihzY29wZSwgeyAkZXZlbnQ6IGV2ZW50IH0pOyB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgIH1cbiAgfVxufVxuTWRUYWJTY3JvbGwuJGluamVjdCA9IFtcIiRwYXJzZVwiXTtcblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnRhYnMnKVxuICAgIC5jb250cm9sbGVyKCdNZFRhYnNDb250cm9sbGVyJywgTWRUYWJzQ29udHJvbGxlcik7XG5cbi8qKlxuICogQG5nSW5qZWN0XG4gKi9cbmZ1bmN0aW9uIE1kVGFic0NvbnRyb2xsZXIgKCRzY29wZSwgJGVsZW1lbnQsICR3aW5kb3csICR0aW1lb3V0LCAkbWRDb25zdGFudCwgJG1kVGFiSW5rUmlwcGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kVXRpbCwgJGFuaW1hdGUsICRhdHRycywgJGNvbXBpbGUsICRtZFRoZW1pbmcpIHtcbiAgLy8tLSBkZWZpbmUgcHJpdmF0ZSBwcm9wZXJ0aWVzXG4gIHZhciBjdHJsICAgICAgID0gdGhpcyxcbiAgICAgIGxvY2tlZCAgICAgPSBmYWxzZSxcbiAgICAgIGVsZW1lbnRzICAgPSBnZXRFbGVtZW50cygpLFxuICAgICAgcXVldWUgICAgICA9IFtdLFxuICAgICAgZGVzdHJveWVkICA9IGZhbHNlLFxuICAgICAgbG9hZGVkICAgICA9IGZhbHNlO1xuXG4gIC8vLS0gZGVmaW5lIHB1YmxpYyBwcm9wZXJ0aWVzIHdpdGggY2hhbmdlIGhhbmRsZXJzXG4gIGRlZmluZVByb3BlcnR5KCdmb2N1c0luZGV4JywgaGFuZGxlRm9jdXNJbmRleENoYW5nZSwgJHNjb3BlLnNlbGVjdGVkSW5kZXggfHwgMCk7XG4gIGRlZmluZVByb3BlcnR5KCdvZmZzZXRMZWZ0JywgaGFuZGxlT2Zmc2V0Q2hhbmdlLCAwKTtcbiAgZGVmaW5lUHJvcGVydHkoJ2hhc0NvbnRlbnQnLCBoYW5kbGVIYXNDb250ZW50LCBmYWxzZSk7XG5cbiAgLy8tLSBkZWZpbmUgcHVibGljIHByb3BlcnRpZXNcbiAgY3RybC5zY29wZSA9ICRzY29wZTtcbiAgY3RybC5wYXJlbnQgPSAkc2NvcGUuJHBhcmVudDtcbiAgY3RybC50YWJzID0gW107XG4gIGN0cmwubGFzdFNlbGVjdGVkSW5kZXggPSBudWxsO1xuICBjdHJsLmhhc0ZvY3VzID0gZmFsc2U7XG4gIGN0cmwubGFzdENsaWNrID0gdHJ1ZTtcbiAgY3RybC5zaG91bGRQYWdpbmF0ZSA9IGZhbHNlO1xuICBjdHJsLnNob3VsZENlbnRlclRhYnMgPSBzaG91bGRDZW50ZXJUYWJzKCk7XG5cbiAgLy8tLSBkZWZpbmUgcHVibGljIG1ldGhvZHNcbiAgY3RybC5yZWRpcmVjdEZvY3VzID0gcmVkaXJlY3RGb2N1cztcbiAgY3RybC5hdHRhY2hSaXBwbGUgPSBhdHRhY2hSaXBwbGU7XG4gIGN0cmwuc2hvdWxkU3RyZXRjaFRhYnMgPSBzaG91bGRTdHJldGNoVGFicztcbiAgY3RybC5pbnNlcnRUYWIgPSBpbnNlcnRUYWI7XG4gIGN0cmwucmVtb3ZlVGFiID0gcmVtb3ZlVGFiO1xuICBjdHJsLnNlbGVjdCA9IHNlbGVjdDtcbiAgY3RybC5zY3JvbGwgPSBzY3JvbGw7XG4gIGN0cmwubmV4dFBhZ2UgPSBuZXh0UGFnZTtcbiAgY3RybC5wcmV2aW91c1BhZ2UgPSBwcmV2aW91c1BhZ2U7XG4gIGN0cmwua2V5ZG93biA9IGtleWRvd247XG4gIGN0cmwuY2FuUGFnZUZvcndhcmQgPSBjYW5QYWdlRm9yd2FyZDtcbiAgY3RybC5jYW5QYWdlQmFjayA9IGNhblBhZ2VCYWNrO1xuICBjdHJsLnJlZnJlc2hJbmRleCA9IHJlZnJlc2hJbmRleDtcbiAgY3RybC5pbmNyZW1lbnRTZWxlY3RlZEluZGV4ID0gaW5jcmVtZW50U2VsZWN0ZWRJbmRleDtcbiAgY3RybC51cGRhdGVJbmtCYXJTdHlsZXMgPSAkbWRVdGlsLmRlYm91bmNlKHVwZGF0ZUlua0JhclN0eWxlcywgMTAwKTtcbiAgY3RybC51cGRhdGVUYWJPcmRlciA9ICRtZFV0aWwuZGVib3VuY2UodXBkYXRlVGFiT3JkZXIsIDEwMCk7XG5cbiAgaW5pdCgpO1xuXG4gIC8qKlxuICAgKiBQZXJmb3JtIGluaXRpYWxpemF0aW9uIGZvciB0aGUgY29udHJvbGxlciwgc2V0dXAgZXZlbnRzIGFuZCB3YXRjaGVyKHMpXG4gICAqL1xuICBmdW5jdGlvbiBpbml0ICgpIHtcbiAgICAkc2NvcGUuc2VsZWN0ZWRJbmRleCA9ICRzY29wZS5zZWxlY3RlZEluZGV4IHx8IDA7XG4gICAgY29tcGlsZVRlbXBsYXRlKCk7XG4gICAgY29uZmlndXJlV2F0Y2hlcnMoKTtcbiAgICBiaW5kRXZlbnRzKCk7XG4gICAgJG1kVGhlbWluZygkZWxlbWVudCk7XG4gICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgdXBkYXRlSGVpZ2h0RnJvbUNvbnRlbnQoKTtcbiAgICAgIGFkanVzdE9mZnNldCgpO1xuICAgICAgdXBkYXRlUGFnaW5hdGlvbigpO1xuICAgICAgY3RybC50YWJzWyRzY29wZS5zZWxlY3RlZEluZGV4XSAmJiBjdHJsLnRhYnNbJHNjb3BlLnNlbGVjdGVkSW5kZXhdLnNjb3BlLnNlbGVjdCgpO1xuICAgICAgbG9hZGVkID0gdHJ1ZTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNvbXBpbGVUZW1wbGF0ZSAoKSB7XG4gICAgdmFyIHRlbXBsYXRlID0gJGF0dHJzLiRtZFRhYnNUZW1wbGF0ZSxcbiAgICAgICAgZWxlbWVudCAgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudHMuZGF0YSk7XG4gICAgZWxlbWVudC5odG1sKHRlbXBsYXRlKTtcbiAgICAkY29tcGlsZShlbGVtZW50LmNvbnRlbnRzKCkpKGN0cmwucGFyZW50KTtcbiAgICBkZWxldGUgJGF0dHJzLiRtZFRhYnNUZW1wbGF0ZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGJpbmRFdmVudHMgKCkge1xuICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vbigncmVzaXplJywgaGFuZGxlV2luZG93UmVzaXplKTtcbiAgICBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudHMucGFnaW5nKS5vbignRE9NU3VidHJlZU1vZGlmaWVkJywgY3RybC51cGRhdGVJbmtCYXJTdHlsZXMpO1xuICAgIGFuZ3VsYXIuZWxlbWVudChlbGVtZW50cy5wYWdpbmcpLm9uKCdET01TdWJ0cmVlTW9kaWZpZWQnLCB1cGRhdGVQYWdpbmF0aW9uKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNvbmZpZ3VyZVdhdGNoZXJzICgpIHtcbiAgICAkbWRVdGlsLmluaXRPcHRpb25hbFByb3BlcnRpZXMoJHNjb3BlLCAkYXR0cnMpO1xuICAgICRhdHRycy4kb2JzZXJ2ZSgnbWROb0JhcicsIGZ1bmN0aW9uICh2YWx1ZSkgeyAkc2NvcGUubm9JbmtCYXIgPSBhbmd1bGFyLmlzRGVmaW5lZCh2YWx1ZSk7IH0pO1xuICAgICRzY29wZS4kd2F0Y2goJ3NlbGVjdGVkSW5kZXgnLCBoYW5kbGVTZWxlY3RlZEluZGV4Q2hhbmdlKTtcbiAgICAkc2NvcGUuJHdhdGNoKCdkeW5hbWljSGVpZ2h0JywgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICBpZiAodmFsdWUpICRlbGVtZW50LmFkZENsYXNzKCdtZC1keW5hbWljLWhlaWdodCcpO1xuICAgICAgZWxzZSAkZWxlbWVudC5yZW1vdmVDbGFzcygnbWQtZHluYW1pYy1oZWlnaHQnKTtcbiAgICB9KTtcbiAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGNsZWFudXApO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBhbnkgZXZlbnRzIGRlZmluZWQgYnkgdGhpcyBjb250cm9sbGVyXG4gICAqL1xuICBmdW5jdGlvbiBjbGVhbnVwICgpIHtcbiAgICBkZXN0cm95ZWQgPSB0cnVlO1xuICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vZmYoJ3Jlc2l6ZScsIGhhbmRsZVdpbmRvd1Jlc2l6ZSk7XG4gICAgYW5ndWxhci5lbGVtZW50KGVsZW1lbnRzLnBhZ2luZykub2ZmKCdET01TdWJ0cmVlTW9kaWZpZWQnLCBjdHJsLnVwZGF0ZUlua0JhclN0eWxlcyk7XG4gICAgYW5ndWxhci5lbGVtZW50KGVsZW1lbnRzLnBhZ2luZykub2ZmKCdET01TdWJ0cmVlTW9kaWZpZWQnLCB1cGRhdGVQYWdpbmF0aW9uKTtcbiAgfVxuXG4gIC8vLS0gQ2hhbmdlIGhhbmRsZXJzXG5cbiAgLyoqXG4gICAqIEFkZC9yZW1vdmUgdGhlIGBtZC1uby10YWItY29udGVudGAgY2xhc3MgZGVwZW5kaW5nIG9uIGBjdHJsLmhhc0NvbnRlbnRgXG4gICAqIEBwYXJhbSBoYXNDb250ZW50XG4gICAqL1xuICBmdW5jdGlvbiBoYW5kbGVIYXNDb250ZW50IChoYXNDb250ZW50KSB7XG4gICAgJGVsZW1lbnRbaGFzQ29udGVudCA/ICdyZW1vdmVDbGFzcycgOiAnYWRkQ2xhc3MnXSgnbWQtbm8tdGFiLWNvbnRlbnQnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBcHBseSBjdHJsLm9mZnNldExlZnQgdG8gdGhlIHBhZ2luZyBlbGVtZW50IHdoZW4gaXQgY2hhbmdlc1xuICAgKiBAcGFyYW0gbGVmdFxuICAgKi9cbiAgZnVuY3Rpb24gaGFuZGxlT2Zmc2V0Q2hhbmdlIChsZWZ0KSB7XG4gICAgdmFyIG5ld1ZhbHVlID0gY3RybC5zaG91bGRDZW50ZXJUYWJzID8gJycgOiAnLScgKyBsZWZ0ICsgJ3B4JztcbiAgICBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudHMucGFnaW5nKS5jc3MoJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STSwgJ3RyYW5zbGF0ZTNkKCcgKyBuZXdWYWx1ZSArICcsIDAsIDApJyk7XG4gICAgJHNjb3BlLiRicm9hZGNhc3QoJyRtZFRhYnNQYWdpbmF0aW9uQ2hhbmdlZCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSB0aGUgVUkgd2hlbmV2ZXIgYGN0cmwuZm9jdXNJbmRleGAgaXMgdXBkYXRlZFxuICAgKiBAcGFyYW0gbmV3SW5kZXhcbiAgICogQHBhcmFtIG9sZEluZGV4XG4gICAqL1xuICBmdW5jdGlvbiBoYW5kbGVGb2N1c0luZGV4Q2hhbmdlIChuZXdJbmRleCwgb2xkSW5kZXgpIHtcbiAgICBpZiAobmV3SW5kZXggPT09IG9sZEluZGV4KSByZXR1cm47XG4gICAgaWYgKCFlbGVtZW50cy50YWJzW25ld0luZGV4XSkgcmV0dXJuO1xuICAgIGFkanVzdE9mZnNldCgpO1xuICAgIHJlZGlyZWN0Rm9jdXMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgdGhlIFVJIHdoZW5ldmVyIHRoZSBzZWxlY3RlZCBpbmRleCBjaGFuZ2VzLiBDYWxscyB1c2VyLWRlZmluZWQgc2VsZWN0L2Rlc2VsZWN0IG1ldGhvZHMuXG4gICAqIEBwYXJhbSBuZXdWYWx1ZVxuICAgKiBAcGFyYW0gb2xkVmFsdWVcbiAgICovXG4gIGZ1bmN0aW9uIGhhbmRsZVNlbGVjdGVkSW5kZXhDaGFuZ2UgKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuICAgIGlmIChuZXdWYWx1ZSA9PT0gb2xkVmFsdWUpIHJldHVybjtcblxuICAgICRzY29wZS5zZWxlY3RlZEluZGV4ID0gZ2V0TmVhcmVzdFNhZmVJbmRleChuZXdWYWx1ZSk7XG4gICAgY3RybC5sYXN0U2VsZWN0ZWRJbmRleCA9IG9sZFZhbHVlO1xuICAgIGN0cmwudXBkYXRlSW5rQmFyU3R5bGVzKCk7XG4gICAgdXBkYXRlSGVpZ2h0RnJvbUNvbnRlbnQoKTtcbiAgICBhZGp1c3RPZmZzZXQobmV3VmFsdWUpO1xuICAgICRzY29wZS4kYnJvYWRjYXN0KCckbWRUYWJzQ2hhbmdlZCcpO1xuICAgIGN0cmwudGFic1tvbGRWYWx1ZV0gJiYgY3RybC50YWJzW29sZFZhbHVlXS5zY29wZS5kZXNlbGVjdCgpO1xuICAgIGN0cmwudGFic1tuZXdWYWx1ZV0gJiYgY3RybC50YWJzW25ld1ZhbHVlXS5zY29wZS5zZWxlY3QoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBRdWV1ZXMgdXAgYSBjYWxsIHRvIGBoYW5kbGVXaW5kb3dSZXNpemVgIHdoZW4gYSByZXNpemUgb2NjdXJzIHdoaWxlIHRoZSB0YWJzIGNvbXBvbmVudCBpc1xuICAgKiBoaWRkZW4uXG4gICAqL1xuICBmdW5jdGlvbiBoYW5kbGVSZXNpemVXaGVuVmlzaWJsZSAoKSB7XG4gICAgLy8tLSBpZiB0aGVyZSBpcyBhbHJlYWR5IGEgd2F0Y2hlciB3YWl0aW5nIGZvciByZXNpemUsIGRvIG5vdGhpbmdcbiAgICBpZiAoaGFuZGxlUmVzaXplV2hlblZpc2libGUud2F0Y2hlcikgcmV0dXJuO1xuICAgIC8vLS0gb3RoZXJ3aXNlLCB3ZSB3aWxsIGFidXNlIHRoZSAkd2F0Y2ggZnVuY3Rpb24gdG8gY2hlY2sgZm9yIHZpc2libGVcbiAgICBoYW5kbGVSZXNpemVXaGVuVmlzaWJsZS53YXRjaGVyID0gJHNjb3BlLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAvLy0tIHNpbmNlIHdlIGFyZSBjaGVja2luZyBmb3IgRE9NIHNpemUsIHdlIHVzZSAkdGltZW91dCB0byB3YWl0IGZvciBhZnRlciB0aGUgRE9NIHVwZGF0ZXNcbiAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8tLSBpZiB0aGUgd2F0Y2hlciBoYXMgYWxyZWFkeSBydW4gKGllLiBtdWx0aXBsZSBkaWdlc3RzIGluIG9uZSBjeWNsZSksIGRvIG5vdGhpbmdcbiAgICAgICAgaWYgKCFoYW5kbGVSZXNpemVXaGVuVmlzaWJsZS53YXRjaGVyKSByZXR1cm47XG5cbiAgICAgICAgaWYgKCRlbGVtZW50LnByb3AoJ29mZnNldFBhcmVudCcpKSB7XG4gICAgICAgICAgaGFuZGxlUmVzaXplV2hlblZpc2libGUud2F0Y2hlcigpO1xuICAgICAgICAgIGhhbmRsZVJlc2l6ZVdoZW5WaXNpYmxlLndhdGNoZXIgPSBudWxsO1xuXG4gICAgICAgICAgLy8tLSB3ZSBoYXZlIHRvIHRyaWdnZXIgb3VyIG93biAkYXBwbHkgc28gdGhhdCB0aGUgRE9NIGJpbmRpbmdzIHdpbGwgdXBkYXRlXG4gICAgICAgICAgaGFuZGxlV2luZG93UmVzaXplKCk7XG4gICAgICAgIH1cbiAgICAgIH0sIDAsIGZhbHNlKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vLS0gRXZlbnQgaGFuZGxlcnMgLyBhY3Rpb25zXG5cbiAgLyoqXG4gICAqIEhhbmRsZSB1c2VyIGtleWJvYXJkIGludGVyYWN0aW9uc1xuICAgKiBAcGFyYW0gZXZlbnRcbiAgICovXG4gIGZ1bmN0aW9uIGtleWRvd24gKGV2ZW50KSB7XG4gICAgc3dpdGNoIChldmVudC5rZXlDb2RlKSB7XG4gICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLkxFRlRfQVJST1c6XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGluY3JlbWVudFNlbGVjdGVkSW5kZXgoLTEsIHRydWUpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJG1kQ29uc3RhbnQuS0VZX0NPREUuUklHSFRfQVJST1c6XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGluY3JlbWVudFNlbGVjdGVkSW5kZXgoMSwgdHJ1ZSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5TUEFDRTpcbiAgICAgIGNhc2UgJG1kQ29uc3RhbnQuS0VZX0NPREUuRU5URVI6XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGlmICghbG9ja2VkKSAkc2NvcGUuc2VsZWN0ZWRJbmRleCA9IGN0cmwuZm9jdXNJbmRleDtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGN0cmwubGFzdENsaWNrID0gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIHRoZSBzZWxlY3RlZCBpbmRleCBhbmQgdHJpZ2dlciBhIGNsaWNrIGV2ZW50IG9uIHRoZSBvcmlnaW5hbCBgbWQtdGFiYCBlbGVtZW50IGluIG9yZGVyXG4gICAqIHRvIGZpcmUgdXNlci1hZGRlZCBjbGljayBldmVudHMuXG4gICAqIEBwYXJhbSBpbmRleFxuICAgKi9cbiAgZnVuY3Rpb24gc2VsZWN0IChpbmRleCkge1xuICAgIGlmICghbG9ja2VkKSBjdHJsLmZvY3VzSW5kZXggPSAkc2NvcGUuc2VsZWN0ZWRJbmRleCA9IGluZGV4O1xuICAgIGN0cmwubGFzdENsaWNrID0gdHJ1ZTtcbiAgICBjdHJsLnRhYnNbaW5kZXhdLmVsZW1lbnQudHJpZ2dlckhhbmRsZXIoJ2NsaWNrJyk7XG4gIH1cblxuICAvKipcbiAgICogV2hlbiBwYWdpbmF0aW9uIGlzIG9uLCB0aGlzIG1ha2VzIHN1cmUgdGhlIHNlbGVjdGVkIGluZGV4IGlzIGluIHZpZXcuXG4gICAqIEBwYXJhbSBldmVudFxuICAgKi9cbiAgZnVuY3Rpb24gc2Nyb2xsIChldmVudCkge1xuICAgIGlmICghY3RybC5zaG91bGRQYWdpbmF0ZSkgcmV0dXJuO1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgY3RybC5vZmZzZXRMZWZ0ID0gZml4T2Zmc2V0KGN0cmwub2Zmc2V0TGVmdCAtIGV2ZW50LndoZWVsRGVsdGEpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNsaWRlcyB0aGUgdGFicyBvdmVyIGFwcHJveGltYXRlbHkgb25lIHBhZ2UgZm9yd2FyZC5cbiAgICovXG4gIGZ1bmN0aW9uIG5leHRQYWdlICgpIHtcbiAgICB2YXIgdmlld3BvcnRXaWR0aCA9IGVsZW1lbnRzLmNhbnZhcy5jbGllbnRXaWR0aCxcbiAgICAgICAgdG90YWxXaWR0aCA9IHZpZXdwb3J0V2lkdGggKyBjdHJsLm9mZnNldExlZnQsXG4gICAgICAgIGksIHRhYjtcbiAgICBmb3IgKGkgPSAwOyBpIDwgZWxlbWVudHMudGFicy5sZW5ndGg7IGkrKykge1xuICAgICAgdGFiID0gZWxlbWVudHMudGFic1tpXTtcbiAgICAgIGlmICh0YWIub2Zmc2V0TGVmdCArIHRhYi5vZmZzZXRXaWR0aCA+IHRvdGFsV2lkdGgpIGJyZWFrO1xuICAgIH1cbiAgICBjdHJsLm9mZnNldExlZnQgPSBmaXhPZmZzZXQodGFiLm9mZnNldExlZnQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNsaWRlcyB0aGUgdGFicyBvdmVyIGFwcHJveGltYXRlbHkgb25lIHBhZ2UgYmFja3dhcmQuXG4gICAqL1xuICBmdW5jdGlvbiBwcmV2aW91c1BhZ2UgKCkge1xuICAgIHZhciBpLCB0YWI7XG4gICAgZm9yIChpID0gMDsgaSA8IGVsZW1lbnRzLnRhYnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRhYiA9IGVsZW1lbnRzLnRhYnNbaV07XG4gICAgICBpZiAodGFiLm9mZnNldExlZnQgKyB0YWIub2Zmc2V0V2lkdGggPj0gY3RybC5vZmZzZXRMZWZ0KSBicmVhaztcbiAgICB9XG4gICAgY3RybC5vZmZzZXRMZWZ0ID0gZml4T2Zmc2V0KHRhYi5vZmZzZXRMZWZ0ICsgdGFiLm9mZnNldFdpZHRoIC0gZWxlbWVudHMuY2FudmFzLmNsaWVudFdpZHRoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgc2l6ZSBjYWxjdWxhdGlvbnMgd2hlbiB0aGUgd2luZG93IGlzIHJlc2l6ZWQuXG4gICAqL1xuICBmdW5jdGlvbiBoYW5kbGVXaW5kb3dSZXNpemUgKCkge1xuICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuICAgICAgY3RybC5sYXN0U2VsZWN0ZWRJbmRleCA9ICRzY29wZS5zZWxlY3RlZEluZGV4O1xuICAgICAgY3RybC5vZmZzZXRMZWZ0ID0gZml4T2Zmc2V0KGN0cmwub2Zmc2V0TGVmdCk7XG4gICAgICAkdGltZW91dChjdHJsLnVwZGF0ZUlua0JhclN0eWxlcywgMCwgZmFsc2UpO1xuICAgICAgJHRpbWVvdXQodXBkYXRlUGFnaW5hdGlvbik7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIGEgdGFiIGZyb20gdGhlIGRhdGEgYW5kIHNlbGVjdCB0aGUgbmVhcmVzdCB2YWxpZCB0YWIuXG4gICAqIEBwYXJhbSB0YWJEYXRhXG4gICAqL1xuICBmdW5jdGlvbiByZW1vdmVUYWIgKHRhYkRhdGEpIHtcbiAgICB2YXIgc2VsZWN0ZWRJbmRleCA9ICRzY29wZS5zZWxlY3RlZEluZGV4LFxuICAgICAgICB0YWIgPSBjdHJsLnRhYnMuc3BsaWNlKHRhYkRhdGEuZ2V0SW5kZXgoKSwgMSlbMF07XG4gICAgcmVmcmVzaEluZGV4KCk7XG4gICAgLy8tLSB3aGVuIHJlbW92aW5nIGEgdGFiLCBpZiB0aGUgc2VsZWN0ZWQgaW5kZXggZGlkIG5vdCBjaGFuZ2UsIHdlIGhhdmUgdG8gbWFudWFsbHkgdHJpZ2dlciB0aGVcbiAgICAvLyAgIHRhYiBzZWxlY3QvZGVzZWxlY3QgZXZlbnRzXG4gICAgaWYgKCRzY29wZS5zZWxlY3RlZEluZGV4ID09PSBzZWxlY3RlZEluZGV4ICYmICFkZXN0cm95ZWQpIHtcbiAgICAgIHRhYi5zY29wZS5kZXNlbGVjdCgpO1xuICAgICAgY3RybC50YWJzWyRzY29wZS5zZWxlY3RlZEluZGV4XSAmJiBjdHJsLnRhYnNbJHNjb3BlLnNlbGVjdGVkSW5kZXhdLnNjb3BlLnNlbGVjdCgpO1xuICAgIH1cbiAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICB1cGRhdGVQYWdpbmF0aW9uKCk7XG4gICAgICBjdHJsLm9mZnNldExlZnQgPSBmaXhPZmZzZXQoY3RybC5vZmZzZXRMZWZ0KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYW4gZW50cnkgaW4gdGhlIHRhYnMgYXJyYXkgZm9yIGEgbmV3IHRhYiBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LlxuICAgKiBAcGFyYW0gdGFiRGF0YVxuICAgKiBAcGFyYW0gaW5kZXhcbiAgICogQHJldHVybnMgeyp9XG4gICAqL1xuICBmdW5jdGlvbiBpbnNlcnRUYWIgKHRhYkRhdGEsIGluZGV4KSB7XG4gICAgdmFyIHByb3RvID0ge1xuICAgICAgICAgIGdldEluZGV4OiBmdW5jdGlvbiAoKSB7IHJldHVybiBjdHJsLnRhYnMuaW5kZXhPZih0YWIpOyB9LFxuICAgICAgICAgIGlzQWN0aXZlOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLmdldEluZGV4KCkgPT09ICRzY29wZS5zZWxlY3RlZEluZGV4OyB9LFxuICAgICAgICAgIGlzTGVmdDogICBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLmdldEluZGV4KCkgPCAkc2NvcGUuc2VsZWN0ZWRJbmRleDsgfSxcbiAgICAgICAgICBpc1JpZ2h0OiAgZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5nZXRJbmRleCgpID4gJHNjb3BlLnNlbGVjdGVkSW5kZXg7IH0sXG4gICAgICAgICAgc2hvdWxkUmVuZGVyOiBmdW5jdGlvbiAoKSB7IHJldHVybiAhJHNjb3BlLm5vRGlzY29ubmVjdCB8fCB0aGlzLmlzQWN0aXZlKCk7IH0sXG4gICAgICAgICAgaGFzRm9jdXM6IGZ1bmN0aW9uICgpIHsgcmV0dXJuICFjdHJsLmxhc3RDbGlja1xuICAgICAgICAgICAgICAmJiBjdHJsLmhhc0ZvY3VzICYmIHRoaXMuZ2V0SW5kZXgoKSA9PT0gY3RybC5mb2N1c0luZGV4OyB9LFxuICAgICAgICAgIGlkOiAgICAgICAkbWRVdGlsLm5leHRVaWQoKVxuICAgICAgICB9LFxuICAgICAgICB0YWIgPSBhbmd1bGFyLmV4dGVuZChwcm90bywgdGFiRGF0YSk7XG4gICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKGluZGV4KSkge1xuICAgICAgY3RybC50YWJzLnNwbGljZShpbmRleCwgMCwgdGFiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY3RybC50YWJzLnB1c2godGFiKTtcbiAgICB9XG4gICAgcHJvY2Vzc1F1ZXVlKCk7XG4gICAgdXBkYXRlSGFzQ29udGVudCgpO1xuICAgIC8vLS0gaWYgYXV0b3NlbGVjdCBpcyBlbmFibGVkLCBzZWxlY3QgdGhlIG5ld2x5IGFkZGVkIHRhYlxuICAgIGlmIChsb2FkZWQgJiYgJHNjb3BlLmF1dG9zZWxlY3QpICR0aW1lb3V0KGZ1bmN0aW9uICgpIHsgc2VsZWN0KGN0cmwudGFicy5pbmRleE9mKHRhYikpOyB9KTtcbiAgICAkdGltZW91dCh1cGRhdGVQYWdpbmF0aW9uKTtcbiAgICByZXR1cm4gdGFiO1xuICB9XG5cbiAgLy8tLSBHZXR0ZXIgbWV0aG9kc1xuXG4gIC8qKlxuICAgKiBHYXRoZXJzIHJlZmVyZW5jZXMgdG8gYWxsIG9mIHRoZSBET00gZWxlbWVudHMgdXNlZCBieSB0aGlzIGNvbnRyb2xsZXIuXG4gICAqIEByZXR1cm5zIHt7fX1cbiAgICovXG4gIGZ1bmN0aW9uIGdldEVsZW1lbnRzICgpIHtcbiAgICB2YXIgZWxlbWVudHMgICAgICA9IHt9O1xuXG4gICAgLy8tLSBnYXRoZXIgdGFiIGJhciBlbGVtZW50c1xuICAgIGVsZW1lbnRzLndyYXBwZXIgID0gJGVsZW1lbnRbMF0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ21kLXRhYnMtd3JhcHBlcicpWzBdO1xuICAgIGVsZW1lbnRzLmRhdGEgICAgID0gJGVsZW1lbnRbMF0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ21kLXRhYi1kYXRhJylbMF07XG4gICAgZWxlbWVudHMuY2FudmFzICAgPSBlbGVtZW50cy53cmFwcGVyLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdtZC10YWJzLWNhbnZhcycpWzBdO1xuICAgIGVsZW1lbnRzLnBhZ2luZyAgID0gZWxlbWVudHMuY2FudmFzLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdtZC1wYWdpbmF0aW9uLXdyYXBwZXInKVswXTtcbiAgICBlbGVtZW50cy50YWJzICAgICA9IGVsZW1lbnRzLnBhZ2luZy5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbWQtdGFiLWl0ZW0nKTtcbiAgICBlbGVtZW50cy5kdW1taWVzICA9IGVsZW1lbnRzLmNhbnZhcy5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbWQtZHVtbXktdGFiJyk7XG4gICAgZWxlbWVudHMuaW5rQmFyICAgPSBlbGVtZW50cy5wYWdpbmcuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ21kLWluay1iYXInKVswXTtcblxuICAgIC8vLS0gZ2F0aGVyIHRhYiBjb250ZW50IGVsZW1lbnRzXG4gICAgZWxlbWVudHMuY29udGVudHNXcmFwcGVyID0gJGVsZW1lbnRbMF0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ21kLXRhYnMtY29udGVudC13cmFwcGVyJylbMF07XG4gICAgZWxlbWVudHMuY29udGVudHMgPSBlbGVtZW50cy5jb250ZW50c1dyYXBwZXIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ21kLXRhYi1jb250ZW50Jyk7XG5cbiAgICByZXR1cm4gZWxlbWVudHM7XG4gIH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyB3aGV0aGVyIG9yIG5vdCB0aGUgbGVmdCBwYWdpbmF0aW9uIGFycm93IHNob3VsZCBiZSBlbmFibGVkLlxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICovXG4gIGZ1bmN0aW9uIGNhblBhZ2VCYWNrICgpIHtcbiAgICByZXR1cm4gY3RybC5vZmZzZXRMZWZ0ID4gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmVzIHdoZXRoZXIgb3Igbm90IHRoZSByaWdodCBwYWdpbmF0aW9uIGFycm93IHNob3VsZCBiZSBlbmFibGVkLlxuICAgKiBAcmV0dXJucyB7Knxib29sZWFufVxuICAgKi9cbiAgZnVuY3Rpb24gY2FuUGFnZUZvcndhcmQgKCkge1xuICAgIHZhciBsYXN0VGFiID0gZWxlbWVudHMudGFic1tlbGVtZW50cy50YWJzLmxlbmd0aCAtIDFdO1xuICAgIHJldHVybiBsYXN0VGFiICYmIGxhc3RUYWIub2Zmc2V0TGVmdCArIGxhc3RUYWIub2Zmc2V0V2lkdGggPiBlbGVtZW50cy5jYW52YXMuY2xpZW50V2lkdGggK1xuICAgICAgICBjdHJsLm9mZnNldExlZnQ7XG4gIH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyBpZiB0aGUgVUkgc2hvdWxkIHN0cmV0Y2ggdGhlIHRhYnMgdG8gZmlsbCB0aGUgYXZhaWxhYmxlIHNwYWNlLlxuICAgKiBAcmV0dXJucyB7Kn1cbiAgICovXG4gIGZ1bmN0aW9uIHNob3VsZFN0cmV0Y2hUYWJzICgpIHtcbiAgICBzd2l0Y2ggKCRzY29wZS5zdHJldGNoVGFicykge1xuICAgICAgY2FzZSAnYWx3YXlzJzogcmV0dXJuIHRydWU7XG4gICAgICBjYXNlICduZXZlcic6ICByZXR1cm4gZmFsc2U7XG4gICAgICBkZWZhdWx0OiAgICAgICByZXR1cm4gIWN0cmwuc2hvdWxkUGFnaW5hdGVcbiAgICAgICAgICAmJiAkd2luZG93Lm1hdGNoTWVkaWEoJyhtYXgtd2lkdGg6IDYwMHB4KScpLm1hdGNoZXM7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIERldGVybWluZXMgaWYgdGhlIHRhYnMgc2hvdWxkIGFwcGVhciBjZW50ZXJlZC5cbiAgICogQHJldHVybnMge3N0cmluZ3xib29sZWFufVxuICAgKi9cbiAgZnVuY3Rpb24gc2hvdWxkQ2VudGVyVGFicyAoKSB7XG4gICAgcmV0dXJuICRzY29wZS5jZW50ZXJUYWJzICYmICFjdHJsLnNob3VsZFBhZ2luYXRlO1xuICB9XG5cbiAgLyoqXG4gICAqIERldGVybWluZXMgaWYgcGFnaW5hdGlvbiBpcyBuZWNlc3NhcnkgdG8gZGlzcGxheSB0aGUgdGFicyB3aXRoaW4gdGhlIGF2YWlsYWJsZSBzcGFjZS5cbiAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAqL1xuICBmdW5jdGlvbiBzaG91bGRQYWdpbmF0ZSAoKSB7XG4gICAgaWYgKCRzY29wZS5ub1BhZ2luYXRpb24gfHwgIWxvYWRlZCkgcmV0dXJuIGZhbHNlO1xuICAgIHZhciBjYW52YXNXaWR0aCA9ICRlbGVtZW50LnByb3AoJ2NsaWVudFdpZHRoJyk7XG4gICAgYW5ndWxhci5mb3JFYWNoKGVsZW1lbnRzLmR1bW1pZXMsIGZ1bmN0aW9uICh0YWIpIHsgY2FudmFzV2lkdGggLT0gdGFiLm9mZnNldFdpZHRoOyB9KTtcbiAgICByZXR1cm4gY2FudmFzV2lkdGggPCAwO1xuICB9XG5cbiAgLyoqXG4gICAqIEZpbmRzIHRoZSBuZWFyZXN0IHRhYiBpbmRleCB0aGF0IGlzIGF2YWlsYWJsZS4gIFRoaXMgaXMgcHJpbWFyaWx5IHVzZWQgZm9yIHdoZW4gdGhlIGFjdGl2ZVxuICAgKiB0YWIgaXMgcmVtb3ZlZC5cbiAgICogQHBhcmFtIG5ld0luZGV4XG4gICAqIEByZXR1cm5zIHsqfVxuICAgKi9cbiAgZnVuY3Rpb24gZ2V0TmVhcmVzdFNhZmVJbmRleChuZXdJbmRleCkge1xuICAgIHZhciBtYXhPZmZzZXQgPSBNYXRoLm1heChjdHJsLnRhYnMubGVuZ3RoIC0gbmV3SW5kZXgsIG5ld0luZGV4KSxcbiAgICAgICAgaSwgdGFiO1xuICAgIGZvciAoaSA9IDA7IGkgPD0gbWF4T2Zmc2V0OyBpKyspIHtcbiAgICAgIHRhYiA9IGN0cmwudGFic1tuZXdJbmRleCArIGldO1xuICAgICAgaWYgKHRhYiAmJiAodGFiLnNjb3BlLmRpc2FibGVkICE9PSB0cnVlKSkgcmV0dXJuIHRhYi5nZXRJbmRleCgpO1xuICAgICAgdGFiID0gY3RybC50YWJzW25ld0luZGV4IC0gaV07XG4gICAgICBpZiAodGFiICYmICh0YWIuc2NvcGUuZGlzYWJsZWQgIT09IHRydWUpKSByZXR1cm4gdGFiLmdldEluZGV4KCk7XG4gICAgfVxuICAgIHJldHVybiBuZXdJbmRleDtcbiAgfVxuXG4gIC8vLS0gVXRpbGl0eSBtZXRob2RzXG5cbiAgLyoqXG4gICAqIERlZmluZXMgYSBwcm9wZXJ0eSB1c2luZyBhIGdldHRlciBhbmQgc2V0dGVyIGluIG9yZGVyIHRvIHRyaWdnZXIgYSBjaGFuZ2UgaGFuZGxlciB3aXRob3V0XG4gICAqIHVzaW5nIGAkd2F0Y2hgIHRvIG9ic2VydmUgY2hhbmdlcy5cbiAgICogQHBhcmFtIGtleVxuICAgKiBAcGFyYW0gaGFuZGxlclxuICAgKiBAcGFyYW0gdmFsdWVcbiAgICovXG4gIGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5IChrZXksIGhhbmRsZXIsIHZhbHVlKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGN0cmwsIGtleSwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB2YWx1ZTsgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBvbGRWYWx1ZSA9IHZhbHVlO1xuICAgICAgICB2YWx1ZSA9IG5ld1ZhbHVlO1xuICAgICAgICBoYW5kbGVyKG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB3aGV0aGVyIG9yIG5vdCBwYWdpbmF0aW9uIHNob3VsZCBiZSBkaXNwbGF5ZWQuXG4gICAqL1xuICBmdW5jdGlvbiB1cGRhdGVQYWdpbmF0aW9uICgpIHtcbiAgICBjdHJsLnNob3VsZFBhZ2luYXRlID0gc2hvdWxkUGFnaW5hdGUoKTtcbiAgICBjdHJsLnNob3VsZENlbnRlclRhYnMgPSBzaG91bGRDZW50ZXJUYWJzKCk7XG4gICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgYWRqdXN0T2Zmc2V0KCRzY29wZS5zZWxlY3RlZEluZGV4KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZS1vcmRlcnMgdGhlIHRhYnMgYW5kIHVwZGF0ZXMgdGhlIHNlbGVjdGVkIGFuZCBmb2N1cyBpbmRleGVzIHRvIHRoZWlyIG5ldyBwb3NpdGlvbnMuXG4gICAqIFRoaXMgaXMgdHJpZ2dlcmVkIGJ5IGB0YWJEaXJlY3RpdmUuanNgIHdoZW4gdGhlIHVzZXIncyB0YWJzIGhhdmUgYmVlbiByZS1vcmRlcmVkLlxuICAgKi9cbiAgZnVuY3Rpb24gdXBkYXRlVGFiT3JkZXIgKCkge1xuICAgIHZhciBzZWxlY3RlZEl0ZW0gPSBjdHJsLnRhYnNbJHNjb3BlLnNlbGVjdGVkSW5kZXhdLFxuICAgICAgICBmb2N1c0l0ZW0gPSBjdHJsLnRhYnNbY3RybC5mb2N1c0luZGV4XTtcbiAgICBjdHJsLnRhYnMgPSBjdHJsLnRhYnMuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgICAgcmV0dXJuIGEuaW5kZXggLSBiLmluZGV4O1xuICAgIH0pO1xuICAgICRzY29wZS5zZWxlY3RlZEluZGV4ID0gY3RybC50YWJzLmluZGV4T2Yoc2VsZWN0ZWRJdGVtKTtcbiAgICBjdHJsLmZvY3VzSW5kZXggPSBjdHJsLnRhYnMuaW5kZXhPZihmb2N1c0l0ZW0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoaXMgbW92ZXMgdGhlIHNlbGVjdGVkIG9yIGZvY3VzIGluZGV4IGxlZnQgb3IgcmlnaHQuICBUaGlzIGlzIHVzZWQgYnkgdGhlIGtleWRvd24gaGFuZGxlci5cbiAgICogQHBhcmFtIGluY1xuICAgKi9cbiAgZnVuY3Rpb24gaW5jcmVtZW50U2VsZWN0ZWRJbmRleCAoaW5jKSB7XG4gICAgdmFyIG5ld0luZGV4LFxuICAgICAgICBpbmRleCA9IGN0cmwuZm9jdXNJbmRleDtcbiAgICBmb3IgKG5ld0luZGV4ID0gaW5kZXggKyBpbmM7XG4gICAgICAgICBjdHJsLnRhYnNbbmV3SW5kZXhdICYmIGN0cmwudGFic1tuZXdJbmRleF0uc2NvcGUuZGlzYWJsZWQ7XG4gICAgICAgICBuZXdJbmRleCArPSBpbmMpIHt9XG4gICAgaWYgKGN0cmwudGFic1tuZXdJbmRleF0pIHtcbiAgICAgIGN0cmwuZm9jdXNJbmRleCA9IG5ld0luZGV4O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBUaGlzIGlzIHVzZWQgdG8gZm9yd2FyZCBmb2N1cyB0byBkdW1teSBlbGVtZW50cy4gIFRoaXMgbWV0aG9kIGlzIG5lY2Vzc2FyeSB0byBhdm9pZCBhbmlhdGlvblxuICAgKiBpc3N1ZXMgd2hlbiBhdHRlbXB0aW5nIHRvIGZvY3VzIGFuIGl0ZW0gdGhhdCBpcyBvdXQgb2Ygdmlldy5cbiAgICovXG4gIGZ1bmN0aW9uIHJlZGlyZWN0Rm9jdXMgKCkge1xuICAgIGVsZW1lbnRzLmR1bW1pZXNbY3RybC5mb2N1c0luZGV4XS5mb2N1cygpO1xuICB9XG5cbiAgLyoqXG4gICAqIEZvcmNlcyB0aGUgcGFnaW5hdGlvbiB0byBtb3ZlIHRoZSBmb2N1c2VkIHRhYiBpbnRvIHZpZXcuXG4gICAqL1xuICBmdW5jdGlvbiBhZGp1c3RPZmZzZXQgKGluZGV4KSB7XG4gICAgaWYgKCFlbGVtZW50cy50YWJzW2luZGV4XSkgcmV0dXJuO1xuICAgIGlmIChjdHJsLnNob3VsZENlbnRlclRhYnMpIHJldHVybjtcbiAgICBpZiAoaW5kZXggPT0gbnVsbCkgaW5kZXggPSBjdHJsLmZvY3VzSW5kZXg7XG4gICAgdmFyIHRhYiA9IGVsZW1lbnRzLnRhYnNbaW5kZXhdLFxuICAgICAgICBsZWZ0ID0gdGFiLm9mZnNldExlZnQsXG4gICAgICAgIHJpZ2h0ID0gdGFiLm9mZnNldFdpZHRoICsgbGVmdDtcbiAgICBjdHJsLm9mZnNldExlZnQgPSBNYXRoLm1heChjdHJsLm9mZnNldExlZnQsIGZpeE9mZnNldChyaWdodCAtIGVsZW1lbnRzLmNhbnZhcy5jbGllbnRXaWR0aCkpO1xuICAgIGN0cmwub2Zmc2V0TGVmdCA9IE1hdGgubWluKGN0cmwub2Zmc2V0TGVmdCwgZml4T2Zmc2V0KGxlZnQpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJdGVyYXRlcyB0aHJvdWdoIGFsbCBxdWV1ZWQgZnVuY3Rpb25zIGFuZCBjbGVhcnMgdGhlIHF1ZXVlLiAgVGhpcyBpcyB1c2VkIGZvciBmdW5jdGlvbnMgdGhhdFxuICAgKiBhcmUgY2FsbGVkIGJlZm9yZSB0aGUgVUkgaXMgcmVhZHksIHN1Y2ggYXMgc2l6ZSBjYWxjdWxhdGlvbnMuXG4gICAqL1xuICBmdW5jdGlvbiBwcm9jZXNzUXVldWUgKCkge1xuICAgIHF1ZXVlLmZvckVhY2goZnVuY3Rpb24gKGZ1bmMpIHsgJHRpbWVvdXQoZnVuYyk7IH0pO1xuICAgIHF1ZXVlID0gW107XG4gIH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyBpZiB0aGUgdGFiIGNvbnRlbnQgYXJlYSBpcyBuZWVkZWQuXG4gICAqL1xuICBmdW5jdGlvbiB1cGRhdGVIYXNDb250ZW50ICgpIHtcbiAgICB2YXIgaGFzQ29udGVudCA9IGZhbHNlO1xuICAgIGFuZ3VsYXIuZm9yRWFjaChjdHJsLnRhYnMsIGZ1bmN0aW9uICh0YWIpIHtcbiAgICAgIGlmICh0YWIudGVtcGxhdGUpIGhhc0NvbnRlbnQgPSB0cnVlO1xuICAgIH0pO1xuICAgIGN0cmwuaGFzQ29udGVudCA9IGhhc0NvbnRlbnQ7XG4gIH1cblxuICAvKipcbiAgICogTW92ZXMgdGhlIGluZGV4ZXMgdG8gdGhlaXIgbmVhcmVzdCB2YWxpZCB2YWx1ZXMuXG4gICAqL1xuICBmdW5jdGlvbiByZWZyZXNoSW5kZXggKCkge1xuICAgICRzY29wZS5zZWxlY3RlZEluZGV4ID0gZ2V0TmVhcmVzdFNhZmVJbmRleCgkc2NvcGUuc2VsZWN0ZWRJbmRleCk7XG4gICAgY3RybC5mb2N1c0luZGV4ID0gZ2V0TmVhcmVzdFNhZmVJbmRleChjdHJsLmZvY3VzSW5kZXgpO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZXMgdGhlIGNvbnRlbnQgaGVpZ2h0IG9mIHRoZSBjdXJyZW50IHRhYi5cbiAgICogQHJldHVybnMgeyp9XG4gICAqL1xuICBmdW5jdGlvbiB1cGRhdGVIZWlnaHRGcm9tQ29udGVudCAoKSB7XG4gICAgaWYgKCEkc2NvcGUuZHluYW1pY0hlaWdodCkgcmV0dXJuICRlbGVtZW50LmNzcygnaGVpZ2h0JywgJycpO1xuICAgIGlmICghY3RybC50YWJzLmxlbmd0aCkgcmV0dXJuIHF1ZXVlLnB1c2godXBkYXRlSGVpZ2h0RnJvbUNvbnRlbnQpO1xuICAgIHZhciB0YWJDb250ZW50ICAgID0gZWxlbWVudHMuY29udGVudHNbJHNjb3BlLnNlbGVjdGVkSW5kZXhdLFxuICAgICAgICBjb250ZW50SGVpZ2h0ID0gdGFiQ29udGVudCA/IHRhYkNvbnRlbnQub2Zmc2V0SGVpZ2h0IDogMCxcbiAgICAgICAgdGFic0hlaWdodCAgICA9IGVsZW1lbnRzLndyYXBwZXIub2Zmc2V0SGVpZ2h0LFxuICAgICAgICBuZXdIZWlnaHQgICAgID0gY29udGVudEhlaWdodCArIHRhYnNIZWlnaHQsXG4gICAgICAgIGN1cnJlbnRIZWlnaHQgPSAkZWxlbWVudC5wcm9wKCdjbGllbnRIZWlnaHQnKTtcbiAgICBpZiAoY3VycmVudEhlaWdodCA9PT0gbmV3SGVpZ2h0KSByZXR1cm47XG4gICAgbG9ja2VkID0gdHJ1ZTtcbiAgICAkYW5pbWF0ZVxuICAgICAgICAuYW5pbWF0ZShcbiAgICAgICAgICAkZWxlbWVudCxcbiAgICAgICAgICB7IGhlaWdodDogY3VycmVudEhlaWdodCArICdweCcgfSxcbiAgICAgICAgICB7IGhlaWdodDogbmV3SGVpZ2h0ICsgJ3B4J31cbiAgICAgICAgKVxuICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgJGVsZW1lbnQuY3NzKCdoZWlnaHQnLCAnJyk7XG4gICAgICAgICAgbG9ja2VkID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlcG9zaXRpb25zIHRoZSBpbmsgYmFyIHRvIHRoZSBzZWxlY3RlZCB0YWIuXG4gICAqIEByZXR1cm5zIHsqfVxuICAgKi9cbiAgZnVuY3Rpb24gdXBkYXRlSW5rQmFyU3R5bGVzICgpIHtcbiAgICBpZiAoIWVsZW1lbnRzLnRhYnNbJHNjb3BlLnNlbGVjdGVkSW5kZXhdKSByZXR1cm47XG4gICAgaWYgKCFjdHJsLnRhYnMubGVuZ3RoKSByZXR1cm4gcXVldWUucHVzaChjdHJsLnVwZGF0ZUlua0JhclN0eWxlcyk7XG4gICAgLy8tLSBpZiB0aGUgZWxlbWVudCBpcyBub3QgdmlzaWJsZSwgd2Ugd2lsbCBub3QgYmUgYWJsZSB0byBjYWxjdWxhdGUgc2l6ZXMgdW50aWwgaXQgaXNcbiAgICAvLy0tIHdlIHNob3VsZCB0cmVhdCB0aGF0IGFzIGEgcmVzaXplIGV2ZW50IHJhdGhlciB0aGFuIGp1c3QgdXBkYXRpbmcgdGhlIGluayBiYXJcbiAgICBpZiAoISRlbGVtZW50LnByb3AoJ29mZnNldFBhcmVudCcpKSByZXR1cm4gaGFuZGxlUmVzaXplV2hlblZpc2libGUoKTtcbiAgICB2YXIgaW5kZXggPSAkc2NvcGUuc2VsZWN0ZWRJbmRleCxcbiAgICAgICAgdG90YWxXaWR0aCA9IGVsZW1lbnRzLnBhZ2luZy5vZmZzZXRXaWR0aCxcbiAgICAgICAgdGFiID0gZWxlbWVudHMudGFic1tpbmRleF0sXG4gICAgICAgIGxlZnQgPSB0YWIub2Zmc2V0TGVmdCxcbiAgICAgICAgcmlnaHQgPSB0b3RhbFdpZHRoIC0gbGVmdCAtIHRhYi5vZmZzZXRXaWR0aDtcbiAgICB1cGRhdGVJbmtCYXJDbGFzc05hbWUoKTtcbiAgICBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudHMuaW5rQmFyKS5jc3MoeyBsZWZ0OiBsZWZ0ICsgJ3B4JywgcmlnaHQ6IHJpZ2h0ICsgJ3B4JyB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIGxlZnQvcmlnaHQgY2xhc3NlcyBzbyB0aGF0IHRoZSBpbmsgYmFyIHdpbGwgYW5pbWF0ZSBwcm9wZXJseS5cbiAgICovXG4gIGZ1bmN0aW9uIHVwZGF0ZUlua0JhckNsYXNzTmFtZSAoKSB7XG4gICAgdmFyIG5ld0luZGV4ID0gJHNjb3BlLnNlbGVjdGVkSW5kZXgsXG4gICAgICAgIG9sZEluZGV4ID0gY3RybC5sYXN0U2VsZWN0ZWRJbmRleCxcbiAgICAgICAgaW5rID0gYW5ndWxhci5lbGVtZW50KGVsZW1lbnRzLmlua0Jhcik7XG4gICAgaWYgKCFhbmd1bGFyLmlzTnVtYmVyKG9sZEluZGV4KSkgcmV0dXJuO1xuICAgIGlmIChuZXdJbmRleCA8IG9sZEluZGV4KSB7XG4gICAgICBpbmsuYWRkQ2xhc3MoJ21kLWxlZnQnKS5yZW1vdmVDbGFzcygnbWQtcmlnaHQnKTtcbiAgICB9IGVsc2UgaWYgKG5ld0luZGV4ID4gb2xkSW5kZXgpIHtcbiAgICAgIGluay5hZGRDbGFzcygnbWQtcmlnaHQnKS5yZW1vdmVDbGFzcygnbWQtbGVmdCcpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBUYWtlcyBhbiBvZmZzZXQgdmFsdWUgYW5kIG1ha2VzIHN1cmUgdGhhdCBpdCBpcyB3aXRoaW4gdGhlIG1pbi9tYXggYWxsb3dlZCB2YWx1ZXMuXG4gICAqIEBwYXJhbSB2YWx1ZVxuICAgKiBAcmV0dXJucyB7Kn1cbiAgICovXG4gIGZ1bmN0aW9uIGZpeE9mZnNldCAodmFsdWUpIHtcbiAgICBpZiAoIWVsZW1lbnRzLnRhYnMubGVuZ3RoIHx8ICFjdHJsLnNob3VsZFBhZ2luYXRlKSByZXR1cm4gMDtcbiAgICB2YXIgbGFzdFRhYiA9IGVsZW1lbnRzLnRhYnNbZWxlbWVudHMudGFicy5sZW5ndGggLSAxXSxcbiAgICAgICAgdG90YWxXaWR0aCA9IGxhc3RUYWIub2Zmc2V0TGVmdCArIGxhc3RUYWIub2Zmc2V0V2lkdGg7XG4gICAgdmFsdWUgPSBNYXRoLm1heCgwLCB2YWx1ZSk7XG4gICAgdmFsdWUgPSBNYXRoLm1pbih0b3RhbFdpZHRoIC0gZWxlbWVudHMuY2FudmFzLmNsaWVudFdpZHRoLCB2YWx1ZSk7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG5cbiAgLyoqXG4gICAqIEF0dGFjaGVzIGEgcmlwcGxlIHRvIHRoZSB0YWIgaXRlbSBlbGVtZW50LlxuICAgKiBAcGFyYW0gc2NvcGVcbiAgICogQHBhcmFtIGVsZW1lbnRcbiAgICovXG4gIGZ1bmN0aW9uIGF0dGFjaFJpcHBsZSAoc2NvcGUsIGVsZW1lbnQpIHtcbiAgICB2YXIgb3B0aW9ucyA9IHsgY29sb3JFbGVtZW50OiBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudHMuaW5rQmFyKSB9O1xuICAgICRtZFRhYklua1JpcHBsZS5hdHRhY2goc2NvcGUsIGVsZW1lbnQsIG9wdGlvbnMpO1xuICB9XG59XG5NZFRhYnNDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkZWxlbWVudFwiLCBcIiR3aW5kb3dcIiwgXCIkdGltZW91dFwiLCBcIiRtZENvbnN0YW50XCIsIFwiJG1kVGFiSW5rUmlwcGxlXCIsIFwiJG1kVXRpbFwiLCBcIiRhbmltYXRlXCIsIFwiJGF0dHJzXCIsIFwiJGNvbXBpbGVcIiwgXCIkbWRUaGVtaW5nXCJdO1xuXG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBAbmdkb2MgZGlyZWN0aXZlXG4gKiBAbmFtZSBtZFRhYnNcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy50YWJzXG4gKlxuICogQHJlc3RyaWN0IEVcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFRoZSBgPG1kLXRhYnM+YCBkaXJlY3RpdmUgc2VydmVzIGFzIHRoZSBjb250YWluZXIgZm9yIDEuLm4gYDxtZC10YWI+YCBjaGlsZCBkaXJlY3RpdmVzIHRvIHByb2R1Y2VzIGEgVGFicyBjb21wb25lbnRzLlxuICogSW4gdHVybiwgdGhlIG5lc3RlZCBgPG1kLXRhYj5gIGRpcmVjdGl2ZSBpcyB1c2VkIHRvIHNwZWNpZnkgYSB0YWIgbGFiZWwgZm9yIHRoZSAqKmhlYWRlciBidXR0b24qKiBhbmQgYSBbb3B0aW9uYWxdIHRhYiB2aWV3XG4gKiBjb250ZW50IHRoYXQgd2lsbCBiZSBhc3NvY2lhdGVkIHdpdGggZWFjaCB0YWIgYnV0dG9uLlxuICpcbiAqIEJlbG93IGlzIHRoZSBtYXJrdXAgZm9yIGl0cyBzaW1wbGVzdCB1c2FnZTpcbiAqXG4gKiAgPGhsanMgbGFuZz1cImh0bWxcIj5cbiAqICA8bWQtdGFicz5cbiAqICAgIDxtZC10YWIgbGFiZWw9XCJUYWIgIzFcIj48L21kLXRhYj5cbiAqICAgIDxtZC10YWIgbGFiZWw9XCJUYWIgIzJcIj48L21kLXRhYj5cbiAqICAgIDxtZC10YWIgbGFiZWw9XCJUYWIgIzNcIj48L21kLXRhYj5cbiAqICA8L21kLXRhYnM+XG4gKiAgPC9obGpzPlxuICpcbiAqIFRhYnMgc3VwcG9ydHMgdGhyZWUgKDMpIHVzYWdlIHNjZW5hcmlvczpcbiAqXG4gKiAgMS4gVGFicyAoYnV0dG9ucyBvbmx5KVxuICogIDIuIFRhYnMgd2l0aCBpbnRlcm5hbCB2aWV3IGNvbnRlbnRcbiAqICAzLiBUYWJzIHdpdGggZXh0ZXJuYWwgdmlldyBjb250ZW50XG4gKlxuICogKipUYWItb25seSoqIHN1cHBvcnQgaXMgdXNlZnVsIHdoZW4gdGFiIGJ1dHRvbnMgYXJlIHVzZWQgZm9yIGN1c3RvbSBuYXZpZ2F0aW9uIHJlZ2FyZGxlc3Mgb2YgYW55IG90aGVyIGNvbXBvbmVudHMsIGNvbnRlbnQsIG9yIHZpZXdzLlxuICogKipUYWJzIHdpdGggaW50ZXJuYWwgdmlld3MqKiBhcmUgdGhlIHRyYWRpdGlvbmFsIHVzYWdlcyB3aGVyZSBlYWNoIHRhYiBoYXMgYXNzb2NpYXRlZCB2aWV3IGNvbnRlbnQgYW5kIHRoZSB2aWV3IHN3aXRjaGluZyBpcyBtYW5hZ2VkIGludGVybmFsbHkgYnkgdGhlIFRhYnMgY29tcG9uZW50LlxuICogKipUYWJzIHdpdGggZXh0ZXJuYWwgdmlldyBjb250ZW50KiogaXMgb2Z0ZW4gdXNlZnVsIHdoZW4gY29udGVudCBhc3NvY2lhdGVkIHdpdGggZWFjaCB0YWIgaXMgaW5kZXBlbmRlbnRseSBtYW5hZ2VkIGFuZCBkYXRhLWJpbmRpbmcgbm90aWZpY2F0aW9ucyBhbm5vdW5jZSB0YWIgc2VsZWN0aW9uIGNoYW5nZXMuXG4gKlxuICogQWRkaXRpb25hbCBmZWF0dXJlcyBhbHNvIGluY2x1ZGU6XG4gKlxuICogKiAgQ29udGVudCBjYW4gaW5jbHVkZSBhbnkgbWFya3VwLlxuICogKiAgSWYgYSB0YWIgaXMgZGlzYWJsZWQgd2hpbGUgYWN0aXZlL3NlbGVjdGVkLCB0aGVuIHRoZSBuZXh0IHRhYiB3aWxsIGJlIGF1dG8tc2VsZWN0ZWQuXG4gKlxuICogIyMjIEV4cGxhbmF0aW9uIG9mIHRhYiBzdHJldGNoaW5nXG4gKlxuICogSW5pdGlhbGx5LCB0YWJzIHdpbGwgaGF2ZSBhbiBpbmhlcmVudCBzaXplLiAgVGhpcyBzaXplIHdpbGwgZWl0aGVyIGJlIGRlZmluZWQgYnkgaG93IG11Y2ggc3BhY2UgaXMgbmVlZGVkIHRvIGFjY29tbW9kYXRlIHRoZWlyIHRleHQgb3Igc2V0IGJ5IHRoZSB1c2VyIHRocm91Z2ggQ1NTLiAgQ2FsY3VsYXRpb25zIHdpbGwgYmUgYmFzZWQgb24gdGhpcyBzaXplLlxuICpcbiAqIE9uIG1vYmlsZSBkZXZpY2VzLCB0YWJzIHdpbGwgYmUgZXhwYW5kZWQgdG8gZmlsbCB0aGUgYXZhaWxhYmxlIGhvcml6b250YWwgc3BhY2UuICBXaGVuIHRoaXMgaGFwcGVucywgYWxsIHRhYnMgd2lsbCBiZWNvbWUgdGhlIHNhbWUgc2l6ZS5cbiAqXG4gKiBPbiBkZXNrdG9wcywgYnkgZGVmYXVsdCwgc3RyZXRjaGluZyB3aWxsIG5ldmVyIG9jY3VyLlxuICpcbiAqIFRoaXMgZGVmYXVsdCBiZWhhdmlvciBjYW4gYmUgb3ZlcnJpZGRlbiB0aHJvdWdoIHRoZSBgbWQtc3RyZXRjaC10YWJzYCBhdHRyaWJ1dGUuICBIZXJlIGlzIGEgdGFibGUgc2hvd2luZyB3aGVuIHN0cmV0Y2hpbmcgd2lsbCBvY2N1cjpcbiAqXG4gKiBgbWQtc3RyZXRjaC10YWJzYCB8IG1vYmlsZSAgICB8IGRlc2t0b3BcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLXwtLS0tLS0tLVxuICogYGF1dG9gICAgICAgICAgICAgfCBzdHJldGNoZWQgfCAtLS1cbiAqIGBhbHdheXNgICAgICAgICAgIHwgc3RyZXRjaGVkIHwgc3RyZXRjaGVkXG4gKiBgbmV2ZXJgICAgICAgICAgICB8IC0tLSAgICAgICB8IC0tLVxuICpcbiAqIEBwYXJhbSB7aW50ZWdlcj19IG1kLXNlbGVjdGVkIEluZGV4IG9mIHRoZSBhY3RpdmUvc2VsZWN0ZWQgdGFiXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBtZC1uby1pbmsgSWYgcHJlc2VudCwgZGlzYWJsZXMgaW5rIHJpcHBsZSBlZmZlY3RzLlxuICogQHBhcmFtIHtib29sZWFuPX0gbWQtbm8tYmFyIElmIHByZXNlbnQsIGRpc2FibGVzIHRoZSBzZWxlY3Rpb24gaW5rIGJhci5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gIG1kLWFsaWduLXRhYnMgQXR0cmlidXRlIHRvIGluZGljYXRlIHBvc2l0aW9uIG9mIHRhYiBidXR0b25zOiBgYm90dG9tYCBvciBgdG9wYDsgZGVmYXVsdCBpcyBgdG9wYFxuICogQHBhcmFtIHtzdHJpbmc9fSBtZC1zdHJldGNoLXRhYnMgQXR0cmlidXRlIHRvIGluZGljYXRlIHdoZXRoZXIgb3Igbm90IHRvIHN0cmV0Y2ggdGFiczogYGF1dG9gLCBgYWx3YXlzYCwgb3IgYG5ldmVyYDsgZGVmYXVsdCBpcyBgYXV0b2BcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG1kLWR5bmFtaWMtaGVpZ2h0IFdoZW4gZW5hYmxlZCwgdGhlIHRhYiB3cmFwcGVyIHdpbGwgcmVzaXplIGJhc2VkIG9uIHRoZSBjb250ZW50cyBvZiB0aGUgc2VsZWN0ZWQgdGFiXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBtZC1jZW50ZXItdGFicyBXaGVuIGVuYWJsZWQsIHRhYnMgd2lsbCBiZSBjZW50ZXJlZCBwcm92aWRlZCB0aGVyZSBpcyBubyBuZWVkIGZvciBwYWdpbmF0aW9uXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBtZC1uby1wYWdpbmF0aW9uIFdoZW4gZW5hYmxlZCwgcGFnaW5hdGlvbiB3aWxsIHJlbWFpbiBvZmZcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG1kLXN3aXBlLWNvbnRlbnQgV2hlbiBlbmFibGVkLCBzd2lwZSBnZXN0dXJlcyB3aWxsIGJlIGVuYWJsZWQgZm9yIHRoZSBjb250ZW50IGFyZWEgdG8ganVtcCBiZXR3ZWVuIHRhYnNcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG1kLW5vLWRpc2Nvbm5lY3QgSWYgeW91ciB0YWIgY29udGVudCBoYXMgYmFja2dyb3VuZCB0YXNrcyAoaWUuIGV2ZW50IGxpc3RlbmVycyksIHlvdSB3aWxsIHdhbnQgdG8gaW5jbHVkZSB0aGlzIHRvIHByZXZlbnQgdGhlIHNjb3BlIGZyb20gYmVpbmcgZGlzY29ubmVjdGVkXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBtZC1hdXRvc2VsZWN0IFdoZW4gcHJlc2VudCwgYW55IHRhYnMgYWRkZWQgYWZ0ZXIgdGhlIGluaXRpYWwgbG9hZCB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgc2VsZWN0ZWRcbiAqXG4gKiBAdXNhZ2VcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XG4gKiA8bWQtdGFicyBtZC1zZWxlY3RlZD1cInNlbGVjdGVkSW5kZXhcIiA+XG4gKiAgIDxpbWcgbmctc3JjPVwiaW1nL2FuZ3VsYXIucG5nXCIgY2xhc3M9XCJjZW50ZXJlZFwiPlxuICogICA8bWQtdGFiXG4gKiAgICAgICBuZy1yZXBlYXQ9XCJ0YWIgaW4gdGFicyB8IG9yZGVyQnk6cHJlZGljYXRlOnJldmVyc2VkXCJcbiAqICAgICAgIG1kLW9uLXNlbGVjdD1cIm9uVGFiU2VsZWN0ZWQodGFiKVwiXG4gKiAgICAgICBtZC1vbi1kZXNlbGVjdD1cImFubm91bmNlRGVzZWxlY3RlZCh0YWIpXCJcbiAqICAgICAgIG5nLWRpc2FibGVkPVwidGFiLmRpc2FibGVkXCI+XG4gKiAgICAgPG1kLXRhYi1sYWJlbD5cbiAqICAgICAgIHt7dGFiLnRpdGxlfX1cbiAqICAgICAgIDxpbWcgc3JjPVwiaW1nL3JlbW92ZVRhYi5wbmdcIiBuZy1jbGljaz1cInJlbW92ZVRhYih0YWIpXCIgY2xhc3M9XCJkZWxldGVcIj5cbiAqICAgICA8L21kLXRhYi1sYWJlbD5cbiAqICAgICA8bWQtdGFiLWJvZHk+XG4gKiAgICAgICB7e3RhYi5jb250ZW50fX1cbiAqICAgICA8L21kLXRhYi1ib2R5PlxuICogICA8L21kLXRhYj5cbiAqIDwvbWQtdGFicz5cbiAqIDwvaGxqcz5cbiAqXG4gKi9cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnRhYnMnKVxuICAgIC5kaXJlY3RpdmUoJ21kVGFicycsIE1kVGFicyk7XG5cbmZ1bmN0aW9uIE1kVGFicyAoJG1kVGhlbWluZywgJG1kVXRpbCwgJGNvbXBpbGUpIHtcbiAgcmV0dXJuIHtcbiAgICBzY29wZToge1xuICAgICAgbm9QYWdpbmF0aW9uOiAgJz0/bWROb1BhZ2luYXRpb24nLFxuICAgICAgZHluYW1pY0hlaWdodDogJz0/bWREeW5hbWljSGVpZ2h0JyxcbiAgICAgIGNlbnRlclRhYnM6ICAgICc9P21kQ2VudGVyVGFicycsXG4gICAgICBzZWxlY3RlZEluZGV4OiAnPT9tZFNlbGVjdGVkJyxcbiAgICAgIHN0cmV0Y2hUYWJzOiAgICdAP21kU3RyZXRjaFRhYnMnLFxuICAgICAgc3dpcGVDb250ZW50OiAgJz0/bWRTd2lwZUNvbnRlbnQnLFxuICAgICAgbm9EaXNjb25uZWN0OiAgJz0/bWROb0Rpc2Nvbm5lY3QnLFxuICAgICAgYXV0b3NlbGVjdDogICAgJz0/bWRBdXRvc2VsZWN0J1xuICAgIH0sXG4gICAgdGVtcGxhdGU6IGZ1bmN0aW9uIChlbGVtZW50LCBhdHRyKSB7XG4gICAgICBhdHRyW1wiJG1kVGFic1RlbXBsYXRlXCJdID0gZWxlbWVudC5odG1sKCk7XG4gICAgICByZXR1cm4gJ1xcXG4gICAgICAgIDxtZC10YWJzLXdyYXBwZXIgbmctY2xhc3M9XCJ7IFxcJ21kLXN0cmV0Y2gtdGFic1xcJzogJG1kVGFic0N0cmwuc2hvdWxkU3RyZXRjaFRhYnMoKSB9XCI+XFxcbiAgICAgICAgICA8bWQtdGFiLWRhdGE+PC9tZC10YWItZGF0YT5cXFxuICAgICAgICAgIDxtZC1wcmV2LWJ1dHRvblxcXG4gICAgICAgICAgICAgIHRhYmluZGV4PVwiLTFcIlxcXG4gICAgICAgICAgICAgIHJvbGU9XCJidXR0b25cIlxcXG4gICAgICAgICAgICAgIGFyaWEtbGFiZWw9XCJQcmV2aW91cyBQYWdlXCJcXFxuICAgICAgICAgICAgICBhcmlhLWRpc2FibGVkPVwie3shJG1kVGFic0N0cmwuY2FuUGFnZUJhY2soKX19XCJcXFxuICAgICAgICAgICAgICBuZy1jbGFzcz1cInsgXFwnbWQtZGlzYWJsZWRcXCc6ICEkbWRUYWJzQ3RybC5jYW5QYWdlQmFjaygpIH1cIlxcXG4gICAgICAgICAgICAgIG5nLWlmPVwiJG1kVGFic0N0cmwuc2hvdWxkUGFnaW5hdGVcIlxcXG4gICAgICAgICAgICAgIG5nLWNsaWNrPVwiJG1kVGFic0N0cmwucHJldmlvdXNQYWdlKClcIj5cXFxuICAgICAgICAgICAgPG1kLWljb24gbWQtc3ZnLWljb249XCJtZC10YWJzLWFycm93XCI+PC9tZC1pY29uPlxcXG4gICAgICAgICAgPC9tZC1wcmV2LWJ1dHRvbj5cXFxuICAgICAgICAgIDxtZC1uZXh0LWJ1dHRvblxcXG4gICAgICAgICAgICAgIHRhYmluZGV4PVwiLTFcIlxcXG4gICAgICAgICAgICAgIHJvbGU9XCJidXR0b25cIlxcXG4gICAgICAgICAgICAgIGFyaWEtbGFiZWw9XCJOZXh0IFBhZ2VcIlxcXG4gICAgICAgICAgICAgIGFyaWEtZGlzYWJsZWQ9XCJ7eyEkbWRUYWJzQ3RybC5jYW5QYWdlRm9yd2FyZCgpfX1cIlxcXG4gICAgICAgICAgICAgIG5nLWNsYXNzPVwieyBcXCdtZC1kaXNhYmxlZFxcJzogISRtZFRhYnNDdHJsLmNhblBhZ2VGb3J3YXJkKCkgfVwiXFxcbiAgICAgICAgICAgICAgbmctaWY9XCIkbWRUYWJzQ3RybC5zaG91bGRQYWdpbmF0ZVwiXFxcbiAgICAgICAgICAgICAgbmctY2xpY2s9XCIkbWRUYWJzQ3RybC5uZXh0UGFnZSgpXCI+XFxcbiAgICAgICAgICAgIDxtZC1pY29uIG1kLXN2Zy1pY29uPVwibWQtdGFicy1hcnJvd1wiPjwvbWQtaWNvbj5cXFxuICAgICAgICAgIDwvbWQtbmV4dC1idXR0b24+XFxcbiAgICAgICAgICA8bWQtdGFicy1jYW52YXNcXFxuICAgICAgICAgICAgICB0YWJpbmRleD1cIjBcIlxcXG4gICAgICAgICAgICAgIGFyaWEtYWN0aXZlZGVzY2VuZGFudD1cInRhYi1pdGVtLXt7JG1kVGFic0N0cmwudGFic1skbWRUYWJzQ3RybC5mb2N1c0luZGV4XS5pZH19XCJcXFxuICAgICAgICAgICAgICBuZy1mb2N1cz1cIiRtZFRhYnNDdHJsLnJlZGlyZWN0Rm9jdXMoKVwiXFxcbiAgICAgICAgICAgICAgbmctY2xhc3M9XCJ7XFxcbiAgICAgICAgICAgICAgICAgIFxcJ21kLXBhZ2luYXRlZFxcJzogJG1kVGFic0N0cmwuc2hvdWxkUGFnaW5hdGUsXFxcbiAgICAgICAgICAgICAgICAgIFxcJ21kLWNlbnRlci10YWJzXFwnOiAkbWRUYWJzQ3RybC5zaG91bGRDZW50ZXJUYWJzXFxcbiAgICAgICAgICAgICAgfVwiXFxcbiAgICAgICAgICAgICAgbmcta2V5ZG93bj1cIiRtZFRhYnNDdHJsLmtleWRvd24oJGV2ZW50KVwiXFxcbiAgICAgICAgICAgICAgcm9sZT1cInRhYmxpc3RcIj5cXFxuICAgICAgICAgICAgPG1kLXBhZ2luYXRpb24td3JhcHBlclxcXG4gICAgICAgICAgICAgICAgbmctY2xhc3M9XCJ7IFxcJ21kLWNlbnRlci10YWJzXFwnOiAkbWRUYWJzQ3RybC5zaG91bGRDZW50ZXJUYWJzIH1cIlxcXG4gICAgICAgICAgICAgICAgbWQtdGFiLXNjcm9sbD1cIiRtZFRhYnNDdHJsLnNjcm9sbCgkZXZlbnQpXCI+XFxcbiAgICAgICAgICAgICAgPG1kLXRhYi1pdGVtXFxcbiAgICAgICAgICAgICAgICAgIHRhYmluZGV4PVwiLTFcIlxcXG4gICAgICAgICAgICAgICAgICBjbGFzcz1cIm1kLXRhYlwiXFxcbiAgICAgICAgICAgICAgICAgIHN0eWxlPVwibWF4LXdpZHRoOiB7eyB0YWJXaWR0aCA/IHRhYldpZHRoICsgXFwncHhcXCcgOiBcXCdub25lXFwnIH19XCJcXFxuICAgICAgICAgICAgICAgICAgbmctcmVwZWF0PVwidGFiIGluICRtZFRhYnNDdHJsLnRhYnNcIlxcXG4gICAgICAgICAgICAgICAgICByb2xlPVwidGFiXCJcXFxuICAgICAgICAgICAgICAgICAgYXJpYS1jb250cm9scz1cInRhYi1jb250ZW50LXt7dGFiLmlkfX1cIlxcXG4gICAgICAgICAgICAgICAgICBhcmlhLXNlbGVjdGVkPVwie3t0YWIuaXNBY3RpdmUoKX19XCJcXFxuICAgICAgICAgICAgICAgICAgYXJpYS1kaXNhYmxlZD1cInt7dGFiLnNjb3BlLmRpc2FibGVkIHx8IFxcJ2ZhbHNlXFwnfX1cIlxcXG4gICAgICAgICAgICAgICAgICBuZy1jbGljaz1cIiRtZFRhYnNDdHJsLnNlbGVjdCh0YWIuZ2V0SW5kZXgoKSlcIlxcXG4gICAgICAgICAgICAgICAgICBuZy1jbGFzcz1cIntcXFxuICAgICAgICAgICAgICAgICAgICAgIFxcJ21kLWFjdGl2ZVxcJzogICAgdGFiLmlzQWN0aXZlKCksXFxcbiAgICAgICAgICAgICAgICAgICAgICBcXCdtZC1mb2N1c2VkXFwnOiAgIHRhYi5oYXNGb2N1cygpLFxcXG4gICAgICAgICAgICAgICAgICAgICAgXFwnbWQtZGlzYWJsZWRcXCc6ICB0YWIuc2NvcGUuZGlzYWJsZWRcXFxuICAgICAgICAgICAgICAgICAgfVwiXFxcbiAgICAgICAgICAgICAgICAgIG5nLWRpc2FibGVkPVwidGFiLnNjb3BlLmRpc2FibGVkXCJcXFxuICAgICAgICAgICAgICAgICAgbWQtc3dpcGUtbGVmdD1cIiRtZFRhYnNDdHJsLm5leHRQYWdlKClcIlxcXG4gICAgICAgICAgICAgICAgICBtZC1zd2lwZS1yaWdodD1cIiRtZFRhYnNDdHJsLnByZXZpb3VzUGFnZSgpXCJcXFxuICAgICAgICAgICAgICAgICAgbWQtdGVtcGxhdGU9XCJ0YWIubGFiZWxcIlxcXG4gICAgICAgICAgICAgICAgICBtZC1zY29wZT1cInRhYi5wYXJlbnRcIj48L21kLXRhYi1pdGVtPlxcXG4gICAgICAgICAgICAgIDxtZC1pbmstYmFyIG5nLWhpZGU9XCJub0lua0JhclwiPjwvbWQtaW5rLWJhcj5cXFxuICAgICAgICAgICAgPC9tZC1wYWdpbmF0aW9uLXdyYXBwZXI+XFxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZC12aXN1YWxseS1oaWRkZW4gbWQtZHVtbXktd3JhcHBlclwiPlxcXG4gICAgICAgICAgICAgIDxtZC1kdW1teS10YWJcXFxuICAgICAgICAgICAgICAgICAgY2xhc3M9XCJtZC10YWJcIlxcXG4gICAgICAgICAgICAgICAgICB0YWJpbmRleD1cIi0xXCJcXFxuICAgICAgICAgICAgICAgICAgaWQ9XCJ0YWItaXRlbS17e3RhYi5pZH19XCJcXFxuICAgICAgICAgICAgICAgICAgcm9sZT1cInRhYlwiXFxcbiAgICAgICAgICAgICAgICAgIGFyaWEtY29udHJvbHM9XCJ0YWItY29udGVudC17e3RhYi5pZH19XCJcXFxuICAgICAgICAgICAgICAgICAgYXJpYS1zZWxlY3RlZD1cInt7dGFiLmlzQWN0aXZlKCl9fVwiXFxcbiAgICAgICAgICAgICAgICAgIGFyaWEtZGlzYWJsZWQ9XCJ7e3RhYi5zY29wZS5kaXNhYmxlZCB8fCBcXCdmYWxzZVxcJ319XCJcXFxuICAgICAgICAgICAgICAgICAgbmctZm9jdXM9XCIkbWRUYWJzQ3RybC5oYXNGb2N1cyA9IHRydWVcIlxcXG4gICAgICAgICAgICAgICAgICBuZy1ibHVyPVwiJG1kVGFic0N0cmwuaGFzRm9jdXMgPSBmYWxzZVwiXFxcbiAgICAgICAgICAgICAgICAgIG5nLXJlcGVhdD1cInRhYiBpbiAkbWRUYWJzQ3RybC50YWJzXCJcXFxuICAgICAgICAgICAgICAgICAgbWQtdGVtcGxhdGU9XCJ0YWIubGFiZWxcIlxcXG4gICAgICAgICAgICAgICAgICBtZC1zY29wZT1cInRhYi5wYXJlbnRcIj48L21kLWR1bW15LXRhYj5cXFxuICAgICAgICAgICAgPC9kaXY+XFxcbiAgICAgICAgICA8L21kLXRhYnMtY2FudmFzPlxcXG4gICAgICAgIDwvbWQtdGFicy13cmFwcGVyPlxcXG4gICAgICAgIDxtZC10YWJzLWNvbnRlbnQtd3JhcHBlciBuZy1zaG93PVwiJG1kVGFic0N0cmwuaGFzQ29udGVudFwiPlxcXG4gICAgICAgICAgPG1kLXRhYi1jb250ZW50XFxcbiAgICAgICAgICAgICAgaWQ9XCJ0YWItY29udGVudC17e3RhYi5pZH19XCJcXFxuICAgICAgICAgICAgICByb2xlPVwidGFicGFuZWxcIlxcXG4gICAgICAgICAgICAgIGFyaWEtbGFiZWxsZWRieT1cInRhYi1pdGVtLXt7dGFiLmlkfX1cIlxcXG4gICAgICAgICAgICAgIG1kLXN3aXBlLWxlZnQ9XCJzd2lwZUNvbnRlbnQgJiYgJG1kVGFic0N0cmwuaW5jcmVtZW50U2VsZWN0ZWRJbmRleCgxKVwiXFxcbiAgICAgICAgICAgICAgbWQtc3dpcGUtcmlnaHQ9XCJzd2lwZUNvbnRlbnQgJiYgJG1kVGFic0N0cmwuaW5jcmVtZW50U2VsZWN0ZWRJbmRleCgtMSlcIlxcXG4gICAgICAgICAgICAgIG5nLWlmPVwiJG1kVGFic0N0cmwuaGFzQ29udGVudFwiXFxcbiAgICAgICAgICAgICAgbmctcmVwZWF0PVwiKGluZGV4LCB0YWIpIGluICRtZFRhYnNDdHJsLnRhYnNcIlxcXG4gICAgICAgICAgICAgIG1kLWNvbm5lY3RlZC1pZj1cInRhYi5pc0FjdGl2ZSgpXCJcXFxuICAgICAgICAgICAgICBuZy1jbGFzcz1cIntcXFxuICAgICAgICAgICAgICAgIFxcJ21kLW5vLXRyYW5zaXRpb25cXCc6ICRtZFRhYnNDdHJsLmxhc3RTZWxlY3RlZEluZGV4ID09IG51bGwsXFxcbiAgICAgICAgICAgICAgICBcXCdtZC1hY3RpdmVcXCc6ICAgICAgICB0YWIuaXNBY3RpdmUoKSxcXFxuICAgICAgICAgICAgICAgIFxcJ21kLWxlZnRcXCc6ICAgICAgICAgIHRhYi5pc0xlZnQoKSxcXFxuICAgICAgICAgICAgICAgIFxcJ21kLXJpZ2h0XFwnOiAgICAgICAgIHRhYi5pc1JpZ2h0KCksXFxcbiAgICAgICAgICAgICAgICBcXCdtZC1uby1zY3JvbGxcXCc6ICAgICBkeW5hbWljSGVpZ2h0XFxcbiAgICAgICAgICAgICAgfVwiPlxcXG4gICAgICAgICAgICA8ZGl2XFxcbiAgICAgICAgICAgICAgICBtZC10ZW1wbGF0ZT1cInRhYi50ZW1wbGF0ZVwiXFxcbiAgICAgICAgICAgICAgICBtZC1zY29wZT1cInRhYi5wYXJlbnRcIlxcXG4gICAgICAgICAgICAgICAgbmctaWY9XCJ0YWIuc2hvdWxkUmVuZGVyKClcIj48L2Rpdj5cXFxuICAgICAgICAgIDwvbWQtdGFiLWNvbnRlbnQ+XFxcbiAgICAgICAgPC9tZC10YWJzLWNvbnRlbnQtd3JhcHBlcj5cXFxuICAgICAgJztcbiAgICB9LFxuICAgIGNvbnRyb2xsZXI6ICdNZFRhYnNDb250cm9sbGVyJyxcbiAgICBjb250cm9sbGVyQXM6ICckbWRUYWJzQ3RybCdcbiAgfTtcbn1cbk1kVGFicy4kaW5qZWN0ID0gW1wiJG1kVGhlbWluZ1wiLCBcIiRtZFV0aWxcIiwgXCIkY29tcGlsZVwiXTtcblxufSkoKTtcbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnRhYnMnKVxuICAgIC5kaXJlY3RpdmUoJ21kVGVtcGxhdGUnLCBNZFRlbXBsYXRlKTtcblxuZnVuY3Rpb24gTWRUZW1wbGF0ZSAoJGNvbXBpbGUsICRtZFV0aWwsICR0aW1lb3V0KSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdBJyxcbiAgICBsaW5rOiBsaW5rLFxuICAgIHNjb3BlOiB7XG4gICAgICB0ZW1wbGF0ZTogJz1tZFRlbXBsYXRlJyxcbiAgICAgIGNvbXBpbGVTY29wZTogJz1tZFNjb3BlJyxcbiAgICAgIGNvbm5lY3RlZDogJz0/bWRDb25uZWN0ZWRJZidcbiAgICB9LFxuICAgIHJlcXVpcmU6ICdeP21kVGFicydcbiAgfTtcbiAgZnVuY3Rpb24gbGluayAoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmwpIHtcbiAgICBpZiAoIWN0cmwpIHJldHVybjtcbiAgICB2YXIgY29tcGlsZVNjb3BlID0gc2NvcGUuY29tcGlsZVNjb3BlLiRuZXcoKTtcbiAgICBlbGVtZW50Lmh0bWwoc2NvcGUudGVtcGxhdGUpO1xuICAgICRjb21waWxlKGVsZW1lbnQuY29udGVudHMoKSkoY29tcGlsZVNjb3BlKTtcbiAgICByZXR1cm4gJHRpbWVvdXQoaGFuZGxlU2NvcGUpO1xuICAgIGZ1bmN0aW9uIGhhbmRsZVNjb3BlICgpIHtcbiAgICAgIHNjb3BlLiR3YXRjaCgnY29ubmVjdGVkJywgZnVuY3Rpb24gKHZhbHVlKSB7IHZhbHVlID09PSBmYWxzZSA/IGRpc2Nvbm5lY3QoKSA6IHJlY29ubmVjdCgpOyB9KTtcbiAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCByZWNvbm5lY3QpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBkaXNjb25uZWN0ICgpIHtcbiAgICAgIGlmIChjdHJsLnNjb3BlLm5vRGlzY29ubmVjdCkgcmV0dXJuO1xuICAgICAgJG1kVXRpbC5kaXNjb25uZWN0U2NvcGUoY29tcGlsZVNjb3BlKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gcmVjb25uZWN0ICgpIHtcbiAgICAgIGlmIChjdHJsLnNjb3BlLm5vRGlzY29ubmVjdCkgcmV0dXJuO1xuICAgICAgJG1kVXRpbC5yZWNvbm5lY3RTY29wZShjb21waWxlU2NvcGUpO1xuICAgIH1cbiAgfVxufVxuTWRUZW1wbGF0ZS4kaW5qZWN0ID0gW1wiJGNvbXBpbGVcIiwgXCIkbWRVdGlsXCIsIFwiJHRpbWVvdXRcIl07XG5cbn0pKCk7XG4oZnVuY3Rpb24oKXsgXG5hbmd1bGFyLm1vZHVsZShcIm1hdGVyaWFsLmNvcmVcIikuY29uc3RhbnQoXCIkTURfVEhFTUVfQ1NTXCIsIFwiLyogbWl4aW4gZGVmaW5pdGlvbiA7IHNldHMgTFRSIGFuZCBSVEwgd2l0aGluIHRoZSBzYW1lIHN0eWxlIGNhbGwgKi9tZC1hdXRvY29tcGxldGUubWQtVEhFTUVfTkFNRS10aGVtZSB7ICBiYWNrZ3JvdW5kOiAne3tiYWNrZ3JvdW5kLTUwfX0nOyB9ICBtZC1hdXRvY29tcGxldGUubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0geyAgICBiYWNrZ3JvdW5kOiAne3tiYWNrZ3JvdW5kLTEwMH19JzsgfSAgbWQtYXV0b2NvbXBsZXRlLm1kLVRIRU1FX05BTUUtdGhlbWUgYnV0dG9uIG1kLWljb24gcGF0aCB7ICAgIGZpbGw6ICd7e2JhY2tncm91bmQtNjAwfX0nOyB9ICBtZC1hdXRvY29tcGxldGUubWQtVEhFTUVfTkFNRS10aGVtZSBidXR0b246YWZ0ZXIgeyAgICBiYWNrZ3JvdW5kOiAne3tiYWNrZ3JvdW5kLTYwMC0wLjN9fSc7IH0ubWQtYXV0b2NvbXBsZXRlLXN1Z2dlc3Rpb25zLm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgYmFja2dyb3VuZDogJ3t7YmFja2dyb3VuZC01MH19JzsgfSAgLm1kLWF1dG9jb21wbGV0ZS1zdWdnZXN0aW9ucy5tZC1USEVNRV9OQU1FLXRoZW1lIGxpIHsgICAgY29sb3I6ICd7e2JhY2tncm91bmQtOTAwfX0nOyB9ICAgIC5tZC1hdXRvY29tcGxldGUtc3VnZ2VzdGlvbnMubWQtVEhFTUVfTkFNRS10aGVtZSBsaSAuaGlnaGxpZ2h0IHsgICAgICBjb2xvcjogJ3t7YmFja2dyb3VuZC02MDB9fSc7IH0gICAgLm1kLWF1dG9jb21wbGV0ZS1zdWdnZXN0aW9ucy5tZC1USEVNRV9OQU1FLXRoZW1lIGxpOmhvdmVyLCAubWQtYXV0b2NvbXBsZXRlLXN1Z2dlc3Rpb25zLm1kLVRIRU1FX05BTUUtdGhlbWUgbGkuc2VsZWN0ZWQgeyAgICAgIGJhY2tncm91bmQ6ICd7e2JhY2tncm91bmQtMjAwfX0nOyB9bWQtYmFja2Ryb3AubWQtb3BhcXVlLm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7Zm9yZWdyb3VuZC00LTAuNX19JzsgfW1kLWJvdHRvbS1zaGVldC5tZC1USEVNRV9OQU1FLXRoZW1lIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2JhY2tncm91bmQtNTB9fSc7ICBib3JkZXItdG9wLWNvbG9yOiAne3tiYWNrZ3JvdW5kLTMwMH19JzsgfSAgbWQtYm90dG9tLXNoZWV0Lm1kLVRIRU1FX05BTUUtdGhlbWUubWQtbGlzdCBtZC1saXN0LWl0ZW0geyAgICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0xfX0nOyB9ICBtZC1ib3R0b20tc2hlZXQubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtc3ViaGVhZGVyIHsgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC01MH19JzsgfSAgbWQtYm90dG9tLXNoZWV0Lm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXN1YmhlYWRlciB7ICAgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTF9fSc7IH1hLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgYm9yZGVyLXJhZGl1czogM3B4OyB9ICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKTpob3ZlciwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKTpob3ZlciB7ICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2JhY2tncm91bmQtNTAwLTAuMn19JzsgfSAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkIHsgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC01MDAtMC4yfX0nOyB9ICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1pY29uLWJ1dHRvbjpob3ZlciwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1pY29uLWJ1dHRvbjpob3ZlciB7ICAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50OyB9ICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYiB7ICAgIGJvcmRlci1yYWRpdXM6IDUwJTsgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyAgICBjb2xvcjogJ3t7YWNjZW50LWNvbnRyYXN0fX0nOyB9ICAgIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtZmFiIG1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWIgbWQtaWNvbiB7ICAgICAgY29sb3I6ICd7e2FjY2VudC1jb250cmFzdH19JzsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYjpub3QoW2Rpc2FibGVkXSk6aG92ZXIsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWI6bm90KFtkaXNhYmxlZF0pOmhvdmVyIHsgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH0gICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWI6bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWI6bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQgeyAgICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC1BNzAwfX0nOyB9ICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWljb24tYnV0dG9uLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtaWNvbi1idXR0b24geyAgICBib3JkZXItcmFkaXVzOiA1MCU7IH0gIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeSwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkgeyAgICBjb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkubWQtcmFpc2VkLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkubWQtZmFiLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeS5tZC1yYWlzZWQsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5Lm1kLWZhYiB7ICAgICAgY29sb3I6ICd7e3ByaW1hcnktY29udHJhc3R9fSc7ICAgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfSAgICAgIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeS5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pIG1kLWljb24sIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeS5tZC1mYWI6bm90KFtkaXNhYmxlZF0pIG1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5Lm1kLXJhaXNlZDpub3QoW2Rpc2FibGVkXSkgbWQtaWNvbiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkubWQtZmFiOm5vdChbZGlzYWJsZWRdKSBtZC1pY29uIHsgICAgICAgIGNvbG9yOiAne3twcmltYXJ5LWNvbnRyYXN0fX0nOyB9ICAgICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5Lm1kLXJhaXNlZDpub3QoW2Rpc2FibGVkXSk6aG92ZXIsIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeS5tZC1mYWI6bm90KFtkaXNhYmxlZF0pOmhvdmVyLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeS5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pOmhvdmVyLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeS5tZC1mYWI6bm90KFtkaXNhYmxlZF0pOmhvdmVyIHsgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3J9fSc7IH0gICAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkubWQtZmFiOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeS5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5Lm1kLWZhYjpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAne3twcmltYXJ5LTYwMH19JzsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnk6bm90KFtkaXNhYmxlZF0pIG1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5Om5vdChbZGlzYWJsZWRdKSBtZC1pY29uIHsgICAgICBjb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfSAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWIsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWIgeyAgICBib3JkZXItcmFkaXVzOiA1MCU7ICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgICAgY29sb3I6ICd7e2FjY2VudC1jb250cmFzdH19JzsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYjpub3QoW2Rpc2FibGVkXSkgLm1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWI6bm90KFtkaXNhYmxlZF0pIC5tZC1pY29uIHsgICAgICBjb2xvcjogJ3t7YWNjZW50LWNvbnRyYXN0fX0nOyB9ICAgIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtZmFiOm5vdChbZGlzYWJsZWRdKTpob3ZlciwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYjpub3QoW2Rpc2FibGVkXSk6aG92ZXIgeyAgICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYjpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYjpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LUE3MDB9fSc7IH0gIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcmFpc2VkLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcmFpc2VkIHsgICAgY29sb3I6ICd7e2JhY2tncm91bmQtY29udHJhc3R9fSc7ICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2JhY2tncm91bmQtNTB9fSc7IH0gICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pIC5tZC1pY29uLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKSAubWQtaWNvbiB7ICAgICAgY29sb3I6ICd7e2JhY2tncm91bmQtY29udHJhc3R9fSc7IH0gICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pOmhvdmVyLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKTpob3ZlciB7ICAgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC01MH19JzsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXJhaXNlZDpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXJhaXNlZDpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC0yMDB9fSc7IH0gIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4geyAgICBjb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4ubWQtcmFpc2VkLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4ubWQtZmFiLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2Fybi5tZC1yYWlzZWQsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuLm1kLWZhYiB7ICAgICAgY29sb3I6ICd7e3dhcm4tY29udHJhc3R9fSc7ICAgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgfSAgICAgIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2Fybi5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pIG1kLWljb24sIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2Fybi5tZC1mYWI6bm90KFtkaXNhYmxlZF0pIG1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuLm1kLXJhaXNlZDpub3QoW2Rpc2FibGVkXSkgbWQtaWNvbiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4ubWQtZmFiOm5vdChbZGlzYWJsZWRdKSBtZC1pY29uIHsgICAgICAgIGNvbG9yOiAne3t3YXJuLWNvbnRyYXN0fX0nOyB9ICAgICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuLm1kLXJhaXNlZDpub3QoW2Rpc2FibGVkXSk6aG92ZXIsIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2Fybi5tZC1mYWI6bm90KFtkaXNhYmxlZF0pOmhvdmVyLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2Fybi5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pOmhvdmVyLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2Fybi5tZC1mYWI6bm90KFtkaXNhYmxlZF0pOmhvdmVyIHsgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH0gICAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4ubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4ubWQtZmFiOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2Fybi5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuLm1kLWZhYjpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAne3t3YXJuLTcwMH19JzsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm46bm90KFtkaXNhYmxlZF0pIG1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuOm5vdChbZGlzYWJsZWRdKSBtZC1pY29uIHsgICAgICBjb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgfSAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQgeyAgICBjb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9ICAgIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50Lm1kLXJhaXNlZCwgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQubWQtZmFiLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50Lm1kLXJhaXNlZCwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudC5tZC1mYWIgeyAgICAgIGNvbG9yOiAne3thY2NlbnQtY29udHJhc3R9fSc7ICAgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9ICAgICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKSBtZC1pY29uLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudC5tZC1mYWI6bm90KFtkaXNhYmxlZF0pIG1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKSBtZC1pY29uLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50Lm1kLWZhYjpub3QoW2Rpc2FibGVkXSkgbWQtaWNvbiB7ICAgICAgICBjb2xvcjogJ3t7YWNjZW50LWNvbnRyYXN0fX0nOyB9ICAgICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKTpob3ZlciwgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQubWQtZmFiOm5vdChbZGlzYWJsZWRdKTpob3ZlciwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudC5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pOmhvdmVyLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50Lm1kLWZhYjpub3QoW2Rpc2FibGVkXSk6aG92ZXIgeyAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9ICAgICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudC5tZC1mYWI6bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50Lm1kLWZhYjpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtNzAwfX0nOyB9ICAgIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50Om5vdChbZGlzYWJsZWRdKSBtZC1pY29uLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50Om5vdChbZGlzYWJsZWRdKSBtZC1pY29uIHsgICAgICBjb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9ICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXSwgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1yYWlzZWRbZGlzYWJsZWRdLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYltkaXNhYmxlZF0sIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50W2Rpc2FibGVkXSwgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuW2Rpc2FibGVkXSwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXSwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXJhaXNlZFtkaXNhYmxlZF0sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWJbZGlzYWJsZWRdLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50W2Rpc2FibGVkXSwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm5bZGlzYWJsZWRdIHsgICAgY29sb3I6ICd7e2ZvcmVncm91bmQtM319JzsgICAgY3Vyc29yOiBub3QtYWxsb3dlZDsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXSBtZC1pY29uLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXJhaXNlZFtkaXNhYmxlZF0gbWQtaWNvbiwgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWJbZGlzYWJsZWRdIG1kLWljb24sIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50W2Rpc2FibGVkXSBtZC1pY29uLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm5bZGlzYWJsZWRdIG1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0gbWQtaWNvbiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXJhaXNlZFtkaXNhYmxlZF0gbWQtaWNvbiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYltkaXNhYmxlZF0gbWQtaWNvbiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudFtkaXNhYmxlZF0gbWQtaWNvbiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm5bZGlzYWJsZWRdIG1kLWljb24geyAgICAgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTN9fSc7IH0gIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcmFpc2VkW2Rpc2FibGVkXSwgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWJbZGlzYWJsZWRdLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcmFpc2VkW2Rpc2FibGVkXSwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYltkaXNhYmxlZF0geyAgICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTR9fSc7IH0gIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWVbZGlzYWJsZWRdLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWVbZGlzYWJsZWRdIHsgICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7IH1tZC1jYXJkLm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC1jb2xvcn19JzsgIGJvcmRlci1yYWRpdXM6IDJweDsgfSAgbWQtY2FyZC5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1jYXJkLWltYWdlIHsgICAgYm9yZGVyLXJhZGl1czogMnB4IDJweCAwIDA7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1yaXBwbGUgeyAgY29sb3I6ICd7e2FjY2VudC02MDB9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWNoZWNrZWQgLm1kLXJpcHBsZSB7ICBjb2xvcjogJ3t7YmFja2dyb3VuZC02MDB9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWNoZWNrZWQubWQtZm9jdXNlZCAubWQtY29udGFpbmVyOmJlZm9yZSB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtY29sb3ItMC4yNn19JzsgfW1kLWNoZWNrYm94Lm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWljb24geyAgYm9yZGVyLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTJ9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWNoZWNrZWQgLm1kLWljb24geyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yLTAuODd9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWNoZWNrZWQgLm1kLWljb246YWZ0ZXIgeyAgYm9yZGVyLWNvbG9yOiAne3tiYWNrZ3JvdW5kLTIwMH19JzsgfW1kLWNoZWNrYm94Lm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXByaW1hcnkgLm1kLXJpcHBsZSB7ICBjb2xvcjogJ3t7cHJpbWFyeS02MDB9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5Lm1kLWNoZWNrZWQgLm1kLXJpcHBsZSB7ICBjb2xvcjogJ3t7YmFja2dyb3VuZC02MDB9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5IC5tZC1pY29uIHsgIGJvcmRlci1jb2xvcjogJ3t7Zm9yZWdyb3VuZC0yfX0nOyB9bWQtY2hlY2tib3gubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtcHJpbWFyeS5tZC1jaGVja2VkIC5tZC1pY29uIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3ItMC44N319JzsgfW1kLWNoZWNrYm94Lm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXByaW1hcnkubWQtY2hlY2tlZC5tZC1mb2N1c2VkIC5tZC1jb250YWluZXI6YmVmb3JlIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3ItMC4yNn19JzsgfW1kLWNoZWNrYm94Lm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXByaW1hcnkubWQtY2hlY2tlZCAubWQtaWNvbjphZnRlciB7ICBib3JkZXItY29sb3I6ICd7e2JhY2tncm91bmQtMjAwfX0nOyB9bWQtY2hlY2tib3gubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtd2FybiAubWQtcmlwcGxlIHsgIGNvbG9yOiAne3t3YXJuLTYwMH19JzsgfW1kLWNoZWNrYm94Lm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXdhcm4gLm1kLWljb24geyAgYm9yZGVyLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTJ9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC13YXJuLm1kLWNoZWNrZWQgLm1kLWljb24geyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7d2Fybi1jb2xvci0wLjg3fX0nOyB9bWQtY2hlY2tib3gubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtd2Fybi5tZC1jaGVja2VkLm1kLWZvY3VzZWQ6bm90KFtkaXNhYmxlZF0pIC5tZC1jb250YWluZXI6YmVmb3JlIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3ItMC4yNn19JzsgfW1kLWNoZWNrYm94Lm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXdhcm4ubWQtY2hlY2tlZCAubWQtaWNvbjphZnRlciB7ICBib3JkZXItY29sb3I6ICd7e2JhY2tncm91bmQtMjAwfX0nOyB9bWQtY2hlY2tib3gubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0gLm1kLWljb24geyAgYm9yZGVyLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTN9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXS5tZC1jaGVja2VkIC5tZC1pY29uIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2ZvcmVncm91bmQtM319JzsgfW1kLWNoZWNrYm94Lm1kLVRIRU1FX05BTUUtdGhlbWVbZGlzYWJsZWRdIC5tZC1sYWJlbCB7ICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0zfX0nOyB9bWQtY2hpcHMubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtY2hpcHMgeyAgYm94LXNoYWRvdzogMCAxcHggJ3t7YmFja2dyb3VuZC0zMDB9fSc7IH0gIG1kLWNoaXBzLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWNoaXBzLm1kLWZvY3VzZWQgeyAgICBib3gtc2hhZG93OiAwIDJweCAne3twcmltYXJ5LWNvbG9yfX0nOyB9bWQtY2hpcHMubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtY2hpcCB7ICBiYWNrZ3JvdW5kOiAne3tiYWNrZ3JvdW5kLTMwMH19JzsgIGNvbG9yOiAne3tiYWNrZ3JvdW5kLTgwMH19JzsgfSAgbWQtY2hpcHMubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtY2hpcC5tZC1mb2N1c2VkIHsgICAgYmFja2dyb3VuZDogJ3t7cHJpbWFyeS1jb2xvcn19JzsgICAgY29sb3I6ICd7e3ByaW1hcnktY29udHJhc3R9fSc7IH0gICAgbWQtY2hpcHMubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtY2hpcC5tZC1mb2N1c2VkIG1kLWljb24geyAgICAgIGNvbG9yOiAne3twcmltYXJ5LWNvbnRyYXN0fX0nOyB9bWQtY2hpcHMubWQtVEhFTUVfTkFNRS10aGVtZSBtZC1jaGlwLXJlbW92ZSAubWQtYnV0dG9uIG1kLWljb24gcGF0aCB7ICBmaWxsOiAne3tiYWNrZ3JvdW5kLTUwMH19JzsgfS5tZC1jb250YWN0LXN1Z2dlc3Rpb24gc3Bhbi5tZC1jb250YWN0LWVtYWlsIHsgIGNvbG9yOiAne3tiYWNrZ3JvdW5kLTQwMH19JzsgfW1kLWNvbnRlbnQubWQtVEhFTUVfTkFNRS10aGVtZSB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tiYWNrZ3JvdW5kLWNvbG9yfX0nOyB9bWQtZGlhbG9nLm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgYm9yZGVyLXJhZGl1czogNHB4OyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC1jb2xvcn19JzsgfSAgbWQtZGlhbG9nLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtY29udGVudC1vdmVyZmxvdyAubWQtYWN0aW9ucyB7ICAgIGJvcmRlci10b3AtY29sb3I6ICd7e2ZvcmVncm91bmQtNH19JzsgfW1kLWRpdmlkZXIubWQtVEhFTUVfTkFNRS10aGVtZSB7ICBib3JkZXItdG9wLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTR9fSc7IH1tZC1pY29uLm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgY29sb3I6ICd7e2ZvcmVncm91bmQtMn19JzsgfSAgbWQtaWNvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkgeyAgICBjb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfSAgbWQtaWNvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudCB7ICAgIGNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH0gIG1kLWljb24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuIHsgICAgY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH1tZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtaW5wdXQgeyAgY29sb3I6ICd7e2ZvcmVncm91bmQtMX19JzsgIGJvcmRlci1jb2xvcjogJ3t7Zm9yZWdyb3VuZC00fX0nOyAgdGV4dC1zaGFkb3c6ICd7e2ZvcmVncm91bmQtc2hhZG93fX0nOyB9ICBtZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtaW5wdXQ6Oi13ZWJraXQtaW5wdXQtcGxhY2Vob2xkZXIsIG1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1pbnB1dDo6LW1vei1wbGFjZWhvbGRlciwgbWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWlucHV0Oi1tb3otcGxhY2Vob2xkZXIsIG1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1pbnB1dDotbXMtaW5wdXQtcGxhY2Vob2xkZXIgeyAgICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0zfX0nOyB9bWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUgPiBtZC1pY29uIHsgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTF9fSc7IH1tZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZSBsYWJlbCwgbWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXBsYWNlaG9sZGVyIHsgIHRleHQtc2hhZG93OiAne3tmb3JlZ3JvdW5kLXNoYWRvd319JzsgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTN9fSc7IH1tZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZSBuZy1tZXNzYWdlcywgbWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUgW25nLW1lc3NhZ2VdLCBtZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZSBbZGF0YS1uZy1tZXNzYWdlXSwgbWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUgW3gtbmctbWVzc2FnZV0geyAgY29sb3I6ICd7e3dhcm4tNTAwfX0nOyB9bWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KC5tZC1pbnB1dC1pbnZhbGlkKS5tZC1pbnB1dC1oYXMtdmFsdWUgbGFiZWwgeyAgY29sb3I6ICd7e2ZvcmVncm91bmQtMn19JzsgfW1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdCgubWQtaW5wdXQtaW52YWxpZCkubWQtaW5wdXQtZm9jdXNlZCAubWQtaW5wdXQgeyAgYm9yZGVyLWNvbG9yOiAne3twcmltYXJ5LTUwMH19JzsgfW1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdCgubWQtaW5wdXQtaW52YWxpZCkubWQtaW5wdXQtZm9jdXNlZCBsYWJlbCB7ICBjb2xvcjogJ3t7cHJpbWFyeS01MDB9fSc7IH1tZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoLm1kLWlucHV0LWludmFsaWQpLm1kLWlucHV0LWZvY3VzZWQgbWQtaWNvbiB7ICBjb2xvcjogJ3t7cHJpbWFyeS01MDB9fSc7IH1tZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoLm1kLWlucHV0LWludmFsaWQpLm1kLWlucHV0LWZvY3VzZWQubWQtYWNjZW50IC5tZC1pbnB1dCB7ICBib3JkZXItY29sb3I6ICd7e2FjY2VudC01MDB9fSc7IH1tZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoLm1kLWlucHV0LWludmFsaWQpLm1kLWlucHV0LWZvY3VzZWQubWQtYWNjZW50IGxhYmVsIHsgIGNvbG9yOiAne3thY2NlbnQtNTAwfX0nOyB9bWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KC5tZC1pbnB1dC1pbnZhbGlkKS5tZC1pbnB1dC1mb2N1c2VkLm1kLXdhcm4gLm1kLWlucHV0IHsgIGJvcmRlci1jb2xvcjogJ3t7d2Fybi01MDB9fSc7IH1tZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoLm1kLWlucHV0LWludmFsaWQpLm1kLWlucHV0LWZvY3VzZWQubWQtd2FybiBsYWJlbCB7ICBjb2xvcjogJ3t7d2Fybi01MDB9fSc7IH1tZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1pbnB1dC1pbnZhbGlkIC5tZC1pbnB1dCB7ICBib3JkZXItY29sb3I6ICd7e3dhcm4tNTAwfX0nOyB9bWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtaW5wdXQtaW52YWxpZC5tZC1pbnB1dC1mb2N1c2VkIGxhYmVsIHsgIGNvbG9yOiAne3t3YXJuLTUwMH19JzsgfW1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWlucHV0LWludmFsaWQgbmctbWVzc2FnZSwgbWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtaW5wdXQtaW52YWxpZCBkYXRhLW5nLW1lc3NhZ2UsIG1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWlucHV0LWludmFsaWQgeC1uZy1tZXNzYWdlLCBtZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1pbnB1dC1pbnZhbGlkIFtuZy1tZXNzYWdlXSwgbWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtaW5wdXQtaW52YWxpZCBbZGF0YS1uZy1tZXNzYWdlXSwgbWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtaW5wdXQtaW52YWxpZCBbeC1uZy1tZXNzYWdlXSwgbWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtaW5wdXQtaW52YWxpZCAubWQtY2hhci1jb3VudGVyIHsgIGNvbG9yOiAne3t3YXJuLTUwMH19JzsgfW1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1pbnB1dFtkaXNhYmxlZF0sIFtkaXNhYmxlZF0gbWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWlucHV0IHsgIGJvcmRlci1ib3R0b20tY29sb3I6IHRyYW5zcGFyZW50OyAgY29sb3I6ICd7e2ZvcmVncm91bmQtM319JzsgIGJhY2tncm91bmQtaW1hZ2U6IGxpbmVhci1ncmFkaWVudCh0byByaWdodCwgJ3t7Zm9yZWdyb3VuZC0zfX0nIDAlLCAne3tmb3JlZ3JvdW5kLTN9fScgMzMlLCB0cmFuc3BhcmVudCAwJSk7ICBiYWNrZ3JvdW5kLWltYWdlOiAtbXMtbGluZWFyLWdyYWRpZW50KGxlZnQsIHRyYW5zcGFyZW50IDAlLCAne3tmb3JlZ3JvdW5kLTN9fScgMTAwJSk7IH1tZC1saXN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtbGlzdC1pdGVtLm1kLTItbGluZSAubWQtbGlzdC1pdGVtLXRleHQgaDMsIG1kLWxpc3QubWQtVEhFTUVfTkFNRS10aGVtZSBtZC1saXN0LWl0ZW0ubWQtMi1saW5lIC5tZC1saXN0LWl0ZW0tdGV4dCBoNCwgbWQtbGlzdC5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLWxpc3QtaXRlbS5tZC0zLWxpbmUgLm1kLWxpc3QtaXRlbS10ZXh0IGgzLCBtZC1saXN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtbGlzdC1pdGVtLm1kLTMtbGluZSAubWQtbGlzdC1pdGVtLXRleHQgaDQgeyAgY29sb3I6ICd7e2ZvcmVncm91bmQtMX19JzsgfW1kLWxpc3QubWQtVEhFTUVfTkFNRS10aGVtZSBtZC1saXN0LWl0ZW0ubWQtMi1saW5lIC5tZC1saXN0LWl0ZW0tdGV4dCBwLCBtZC1saXN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtbGlzdC1pdGVtLm1kLTMtbGluZSAubWQtbGlzdC1pdGVtLXRleHQgcCB7ICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0yfX0nOyB9bWQtbGlzdC5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1wcm94eS1mb2N1cy5tZC1mb2N1c2VkIGRpdi5tZC1uby1zdHlsZSB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tiYWNrZ3JvdW5kLTEwMH19JzsgfW1kLWxpc3QubWQtVEhFTUVfTkFNRS10aGVtZSBtZC1saXN0LWl0ZW0gPiBtZC1pY29uIHsgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTJ9fSc7IH0gIG1kLWxpc3QubWQtVEhFTUVfTkFNRS10aGVtZSBtZC1saXN0LWl0ZW0gPiBtZC1pY29uLm1kLWhpZ2hsaWdodCB7ICAgIGNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyB9ICAgIG1kLWxpc3QubWQtVEhFTUVfTkFNRS10aGVtZSBtZC1saXN0LWl0ZW0gPiBtZC1pY29uLm1kLWhpZ2hsaWdodC5tZC1hY2NlbnQgeyAgICAgIGNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH1tZC1saXN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtbGlzdC1pdGVtIGJ1dHRvbiB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tiYWNrZ3JvdW5kLWNvbG9yfX0nOyB9ICBtZC1saXN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtbGlzdC1pdGVtIGJ1dHRvbi5tZC1idXR0b246bm90KFtkaXNhYmxlZF0pOmhvdmVyIHsgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC1jb2xvcn19JzsgfW1kLW1lbnUtY29udGVudC5tZC1USEVNRV9OQU1FLXRoZW1lIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2JhY2tncm91bmQtY29sb3J9fSc7IH0gIG1kLW1lbnUtY29udGVudC5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLW1lbnUtZGl2aWRlciB7ICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2ZvcmVncm91bmQtNH19JzsgfW1kLXByb2dyZXNzLWNpcmN1bGFyLm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7IH0gIG1kLXByb2dyZXNzLWNpcmN1bGFyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWlubmVyIC5tZC1nYXAgeyAgICBib3JkZXItdG9wLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyAgICBib3JkZXItYm90dG9tLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyB9ICBtZC1wcm9ncmVzcy1jaXJjdWxhci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1pbm5lciAubWQtbGVmdCAubWQtaGFsZi1jaXJjbGUsIG1kLXByb2dyZXNzLWNpcmN1bGFyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWlubmVyIC5tZC1yaWdodCAubWQtaGFsZi1jaXJjbGUgeyAgICBib3JkZXItdG9wLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyB9ICBtZC1wcm9ncmVzcy1jaXJjdWxhci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1pbm5lciAubWQtcmlnaHQgLm1kLWhhbGYtY2lyY2xlIHsgICAgYm9yZGVyLXJpZ2h0LWNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyB9ICBtZC1wcm9ncmVzcy1jaXJjdWxhci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1pbm5lciAubWQtbGVmdCAubWQtaGFsZi1jaXJjbGUgeyAgICBib3JkZXItbGVmdC1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfSAgbWQtcHJvZ3Jlc3MtY2lyY3VsYXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuIC5tZC1pbm5lciAubWQtZ2FwIHsgICAgYm9yZGVyLXRvcC1jb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgICAgYm9yZGVyLWJvdHRvbS1jb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgfSAgbWQtcHJvZ3Jlc3MtY2lyY3VsYXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuIC5tZC1pbm5lciAubWQtbGVmdCAubWQtaGFsZi1jaXJjbGUsIG1kLXByb2dyZXNzLWNpcmN1bGFyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiAubWQtaW5uZXIgLm1kLXJpZ2h0IC5tZC1oYWxmLWNpcmNsZSB7ICAgIGJvcmRlci10b3AtY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH0gIG1kLXByb2dyZXNzLWNpcmN1bGFyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiAubWQtaW5uZXIgLm1kLXJpZ2h0IC5tZC1oYWxmLWNpcmNsZSB7ICAgIGJvcmRlci1yaWdodC1jb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgfSAgbWQtcHJvZ3Jlc3MtY2lyY3VsYXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuIC5tZC1pbm5lciAubWQtbGVmdCAubWQtaGFsZi1jaXJjbGUgeyAgICBib3JkZXItbGVmdC1jb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgfSAgbWQtcHJvZ3Jlc3MtY2lyY3VsYXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQgLm1kLWlubmVyIC5tZC1nYXAgeyAgICBib3JkZXItdG9wLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7ICAgIGJvcmRlci1ib3R0b20tY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgfSAgbWQtcHJvZ3Jlc3MtY2lyY3VsYXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQgLm1kLWlubmVyIC5tZC1sZWZ0IC5tZC1oYWxmLWNpcmNsZSwgbWQtcHJvZ3Jlc3MtY2lyY3VsYXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQgLm1kLWlubmVyIC5tZC1yaWdodCAubWQtaGFsZi1jaXJjbGUgeyAgICBib3JkZXItdG9wLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH0gIG1kLXByb2dyZXNzLWNpcmN1bGFyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IC5tZC1pbm5lciAubWQtcmlnaHQgLm1kLWhhbGYtY2lyY2xlIHsgICAgYm9yZGVyLXJpZ2h0LWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH0gIG1kLXByb2dyZXNzLWNpcmN1bGFyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IC5tZC1pbm5lciAubWQtbGVmdCAubWQtaGFsZi1jaXJjbGUgeyAgICBib3JkZXItbGVmdC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9bWQtcHJvZ3Jlc3MtbGluZWFyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWNvbnRhaW5lciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3twcmltYXJ5LTEwMH19JzsgfW1kLXByb2dyZXNzLWxpbmVhci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1iYXIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfW1kLXByb2dyZXNzLWxpbmVhci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4gLm1kLWNvbnRhaW5lciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3t3YXJuLTEwMH19JzsgfW1kLXByb2dyZXNzLWxpbmVhci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4gLm1kLWJhciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3t3YXJuLWNvbG9yfX0nOyB9bWQtcHJvZ3Jlc3MtbGluZWFyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IC5tZC1jb250YWluZXIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LTEwMH19JzsgfW1kLXByb2dyZXNzLWxpbmVhci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudCAubWQtYmFyIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgfW1kLXByb2dyZXNzLWxpbmVhci5tZC1USEVNRV9OQU1FLXRoZW1lW21kLW1vZGU9YnVmZmVyXS5tZC13YXJuIC5tZC1iYXIxIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tMTAwfX0nOyB9bWQtcHJvZ3Jlc3MtbGluZWFyLm1kLVRIRU1FX05BTUUtdGhlbWVbbWQtbW9kZT1idWZmZXJdLm1kLXdhcm4gLm1kLWRhc2hlZDpiZWZvcmUgeyAgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KCd7e3dhcm4tMTAwfX0nIDAlLCAne3t3YXJuLTEwMH19JyAxNiUsIHRyYW5zcGFyZW50IDQyJSk7IH1tZC1wcm9ncmVzcy1saW5lYXIubWQtVEhFTUVfTkFNRS10aGVtZVttZC1tb2RlPWJ1ZmZlcl0ubWQtYWNjZW50IC5tZC1iYXIxIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC0xMDB9fSc7IH1tZC1wcm9ncmVzcy1saW5lYXIubWQtVEhFTUVfTkFNRS10aGVtZVttZC1tb2RlPWJ1ZmZlcl0ubWQtYWNjZW50IC5tZC1kYXNoZWQ6YmVmb3JlIHsgIGJhY2tncm91bmQ6IHJhZGlhbC1ncmFkaWVudCgne3thY2NlbnQtMTAwfX0nIDAlLCAne3thY2NlbnQtMTAwfX0nIDE2JSwgdHJhbnNwYXJlbnQgNDIlKTsgfW1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1vZmYgeyAgYm9yZGVyLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTJ9fSc7IH1tZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtb24geyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yLTAuODd9fSc7IH1tZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1jaGVja2VkIC5tZC1vZmYgeyAgYm9yZGVyLWNvbG9yOiAne3thY2NlbnQtY29sb3ItMC44N319JzsgfW1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWNoZWNrZWQgLm1kLWluay1yaXBwbGUgeyAgY29sb3I6ICd7e2FjY2VudC1jb2xvci0wLjg3fX0nOyB9bWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWNvbnRhaW5lciAubWQtcmlwcGxlIHsgIGNvbG9yOiAne3thY2NlbnQtNjAwfX0nOyB9bWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkgLm1kLXByaW1hcnkgLm1kLW9uLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5IC5tZC1vbiwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC1wcmltYXJ5IC5tZC1vbiwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXByaW1hcnkgLm1kLW9uIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3ItMC44N319JzsgfW1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC1wcmltYXJ5IC5tZC1jaGVja2VkIC5tZC1vZmYsIG1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC1wcmltYXJ5Lm1kLWNoZWNrZWQgLm1kLW9mZiwgbWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtcHJpbWFyeSAubWQtY2hlY2tlZCAubWQtb2ZmLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5Lm1kLWNoZWNrZWQgLm1kLW9mZiwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC1wcmltYXJ5IC5tZC1jaGVja2VkIC5tZC1vZmYsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtcHJpbWFyeS5tZC1jaGVja2VkIC5tZC1vZmYsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5IC5tZC1jaGVja2VkIC5tZC1vZmYsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5Lm1kLWNoZWNrZWQgLm1kLW9mZiB7ICBib3JkZXItY29sb3I6ICd7e3ByaW1hcnktY29sb3ItMC44N319JzsgfW1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC1wcmltYXJ5IC5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtcHJpbWFyeS5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5IC5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5Lm1kLWNoZWNrZWQgLm1kLWluay1yaXBwbGUsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtcHJpbWFyeSAubWQtY2hlY2tlZCAubWQtaW5rLXJpcHBsZSwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC1wcmltYXJ5Lm1kLWNoZWNrZWQgLm1kLWluay1yaXBwbGUsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5IC5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtcHJpbWFyeS5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlIHsgIGNvbG9yOiAne3twcmltYXJ5LWNvbG9yLTAuODd9fSc7IH1tZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtcHJpbWFyeSAubWQtY29udGFpbmVyIC5tZC1yaXBwbGUsIG1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXByaW1hcnkgLm1kLWNvbnRhaW5lciAubWQtcmlwcGxlLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkgLm1kLXByaW1hcnkgLm1kLWNvbnRhaW5lciAubWQtcmlwcGxlLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtcHJpbWFyeSAubWQtY29udGFpbmVyIC5tZC1yaXBwbGUgeyAgY29sb3I6ICd7e3ByaW1hcnktNjAwfX0nOyB9bWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkgLm1kLXdhcm4gLm1kLW9uLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC13YXJuIC5tZC1vbiwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC13YXJuIC5tZC1vbiwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXdhcm4gLm1kLW9uIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3ItMC44N319JzsgfW1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC13YXJuIC5tZC1jaGVja2VkIC5tZC1vZmYsIG1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC13YXJuLm1kLWNoZWNrZWQgLm1kLW9mZiwgbWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtd2FybiAubWQtY2hlY2tlZCAubWQtb2ZmLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC13YXJuLm1kLWNoZWNrZWQgLm1kLW9mZiwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC13YXJuIC5tZC1jaGVja2VkIC5tZC1vZmYsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtd2Fybi5tZC1jaGVja2VkIC5tZC1vZmYsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC13YXJuIC5tZC1jaGVja2VkIC5tZC1vZmYsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC13YXJuLm1kLWNoZWNrZWQgLm1kLW9mZiB7ICBib3JkZXItY29sb3I6ICd7e3dhcm4tY29sb3ItMC44N319JzsgfW1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC13YXJuIC5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtd2Fybi5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC13YXJuIC5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC13YXJuLm1kLWNoZWNrZWQgLm1kLWluay1yaXBwbGUsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtd2FybiAubWQtY2hlY2tlZCAubWQtaW5rLXJpcHBsZSwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC13YXJuLm1kLWNoZWNrZWQgLm1kLWluay1yaXBwbGUsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC13YXJuIC5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtd2Fybi5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlIHsgIGNvbG9yOiAne3t3YXJuLWNvbG9yLTAuODd9fSc7IH1tZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtd2FybiAubWQtY29udGFpbmVyIC5tZC1yaXBwbGUsIG1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXdhcm4gLm1kLWNvbnRhaW5lciAubWQtcmlwcGxlLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkgLm1kLXdhcm4gLm1kLWNvbnRhaW5lciAubWQtcmlwcGxlLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtd2FybiAubWQtY29udGFpbmVyIC5tZC1yaXBwbGUgeyAgY29sb3I6ICd7e3dhcm4tNjAwfX0nOyB9bWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0sIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXSB7ICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0zfX0nOyB9ICBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXSAubWQtY29udGFpbmVyIC5tZC1vZmYsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXSAubWQtY29udGFpbmVyIC5tZC1vZmYgeyAgICBib3JkZXItY29sb3I6ICd7e2ZvcmVncm91bmQtM319JzsgfSAgbWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0gLm1kLWNvbnRhaW5lciAubWQtb24sIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXSAubWQtY29udGFpbmVyIC5tZC1vbiB7ICAgIGJvcmRlci1jb2xvcjogJ3t7Zm9yZWdyb3VuZC0zfX0nOyB9bWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mb2N1c2VkOm5vdCg6ZW1wdHkpIC5tZC1jaGVja2VkIC5tZC1jb250YWluZXI6YmVmb3JlIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC1jb2xvci0wLjI2fX0nOyB9bWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mb2N1c2VkOm5vdCg6ZW1wdHkpIC5tZC1jaGVja2VkOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5IC5tZC1jb250YWluZXI6YmVmb3JlIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3ItMC4yNn19JzsgfW1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtZm9jdXNlZDpub3QoOmVtcHR5KSAubWQtY2hlY2tlZC5tZC1wcmltYXJ5IC5tZC1jb250YWluZXI6YmVmb3JlIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3ItMC4yNn19JzsgfW1kLXNlbGVjdC5tZC1USEVNRV9OQU1FLXRoZW1lLm5nLWludmFsaWQubmctZGlydHkgLm1kLXNlbGVjdC1sYWJlbCB7ICBjb2xvcjogJ3t7d2Fybi01MDB9fScgIWltcG9ydGFudDsgIGJvcmRlci1ib3R0b20tY29sb3I6ICd7e3dhcm4tNTAwfX0nICFpbXBvcnRhbnQ7IH1tZC1zZWxlY3QubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSk6Zm9jdXMgLm1kLXNlbGVjdC1sYWJlbCB7ICBib3JkZXItYm90dG9tLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyAgY29sb3I6ICd7eyBmb3JlZ3JvdW5kLTEgfX0nOyB9ICBtZC1zZWxlY3QubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSk6Zm9jdXMgLm1kLXNlbGVjdC1sYWJlbC5tZC1wbGFjZWhvbGRlciB7ICAgIGNvbG9yOiAne3sgZm9yZWdyb3VuZC0xIH19JzsgfW1kLXNlbGVjdC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKTpmb2N1cy5tZC1hY2NlbnQgLm1kLXNlbGVjdC1sYWJlbCB7ICBib3JkZXItYm90dG9tLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH1tZC1zZWxlY3QubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSk6Zm9jdXMubWQtd2FybiAubWQtc2VsZWN0LWxhYmVsIHsgIGJvcmRlci1ib3R0b20tY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH1tZC1zZWxlY3QubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0gLm1kLXNlbGVjdC1sYWJlbCB7ICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0zfX0nOyB9ICBtZC1zZWxlY3QubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0gLm1kLXNlbGVjdC1sYWJlbC5tZC1wbGFjZWhvbGRlciB7ICAgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTN9fSc7IH1tZC1zZWxlY3QubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtc2VsZWN0LWxhYmVsIHsgIGJvcmRlci1ib3R0b20tY29sb3I6ICd7e2ZvcmVncm91bmQtNH19JzsgfSAgbWQtc2VsZWN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXNlbGVjdC1sYWJlbC5tZC1wbGFjZWhvbGRlciB7ICAgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTJ9fSc7IH1tZC1zZWxlY3QtbWVudS5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLW9wdGdyb3VwIHsgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTJ9fSc7IH0gIG1kLXNlbGVjdC1tZW51Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtb3B0Z3JvdXAgbWQtb3B0aW9uIHsgICAgY29sb3I6ICd7e2ZvcmVncm91bmQtMX19JzsgfW1kLXNlbGVjdC1tZW51Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtb3B0aW9uW3NlbGVjdGVkXSB7ICBjb2xvcjogJ3t7cHJpbWFyeS01MDB9fSc7IH0gIG1kLXNlbGVjdC1tZW51Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtb3B0aW9uW3NlbGVjdGVkXTpmb2N1cyB7ICAgIGNvbG9yOiAne3twcmltYXJ5LTYwMH19JzsgfSAgbWQtc2VsZWN0LW1lbnUubWQtVEhFTUVfTkFNRS10aGVtZSBtZC1vcHRpb25bc2VsZWN0ZWRdLm1kLWFjY2VudCB7ICAgIGNvbG9yOiAne3thY2NlbnQtNTAwfX0nOyB9ICAgIG1kLXNlbGVjdC1tZW51Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtb3B0aW9uW3NlbGVjdGVkXS5tZC1hY2NlbnQ6Zm9jdXMgeyAgICAgIGNvbG9yOiAne3thY2NlbnQtNjAwfX0nOyB9bWQtc2VsZWN0LW1lbnUubWQtVEhFTUVfTkFNRS10aGVtZSBtZC1vcHRpb246Zm9jdXM6bm90KFtzZWxlY3RlZF0pIHsgIGJhY2tncm91bmQ6ICd7e2JhY2tncm91bmQtMjAwfX0nOyB9bWQtc2lkZW5hdi5tZC1USEVNRV9OQU1FLXRoZW1lIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2JhY2tncm91bmQtY29sb3J9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtdHJhY2sgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7Zm9yZWdyb3VuZC0zfX0nOyB9bWQtc2xpZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXRyYWNrLXRpY2tzIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2ZvcmVncm91bmQtNH19JzsgfW1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1mb2N1cy10aHVtYiB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTJ9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtZm9jdXMtcmluZyB7ICBib3JkZXItY29sb3I6ICd7e2ZvcmVncm91bmQtNH19JzsgfW1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1kaXNhYmxlZC10aHVtYiB7ICBib3JkZXItY29sb3I6ICd7e2JhY2tncm91bmQtY29sb3J9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1taW4gLm1kLXRodW1iOmFmdGVyIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2JhY2tncm91bmQtY29sb3J9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtdHJhY2subWQtdHJhY2stZmlsbCB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtdGh1bWI6YWZ0ZXIgeyAgYm9yZGVyLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtc2lnbiB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH0gIG1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1zaWduOmFmdGVyIHsgICAgYm9yZGVyLXRvcC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9bWQtc2xpZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXRodW1iLXRleHQgeyAgY29sb3I6ICd7e2FjY2VudC1jb250cmFzdH19JzsgfW1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4gLm1kLXRyYWNrLm1kLXRyYWNrLWZpbGwgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgfW1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4gLm1kLXRodW1iOmFmdGVyIHsgIGJvcmRlci1jb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuIC5tZC1zaWduIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH0gIG1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4gLm1kLXNpZ246YWZ0ZXIgeyAgICBib3JkZXItdG9wLWNvbG9yOiAne3t3YXJuLWNvbG9yfX0nOyB9bWQtc2xpZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiAubWQtdGh1bWItdGV4dCB7ICBjb2xvcjogJ3t7d2Fybi1jb250cmFzdH19JzsgfW1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkgLm1kLXRyYWNrLm1kLXRyYWNrLWZpbGwgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfW1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkgLm1kLXRodW1iOmFmdGVyIHsgIGJvcmRlci1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3J9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5IC5tZC1zaWduIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3J9fSc7IH0gIG1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkgLm1kLXNpZ246YWZ0ZXIgeyAgICBib3JkZXItdG9wLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyB9bWQtc2xpZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeSAubWQtdGh1bWItdGV4dCB7ICBjb2xvcjogJ3t7cHJpbWFyeS1jb250cmFzdH19JzsgfW1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXSAubWQtdGh1bWI6YWZ0ZXIgeyAgYm9yZGVyLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTN9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF06bm90KC5tZC1taW4pIC5tZC10aHVtYjphZnRlciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTN9fSc7IH0ubWQtc3ViaGVhZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgY29sb3I6ICd7eyBmb3JlZ3JvdW5kLTItMC4yMyB9fSc7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tiYWNrZ3JvdW5kLWNvbG9yfX0nOyB9ICAubWQtc3ViaGVhZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeSB7ICAgIGNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyB9ICAubWQtc3ViaGVhZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IHsgICAgY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgfSAgLm1kLXN1YmhlYWRlci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4geyAgICBjb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgfW1kLXN3aXRjaC5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC10aHVtYiB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tiYWNrZ3JvdW5kLTUwfX0nOyB9bWQtc3dpdGNoLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWJhciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tiYWNrZ3JvdW5kLTUwMH19JzsgfW1kLXN3aXRjaC5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWNoZWNrZWQgLm1kLXRodW1iIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgfW1kLXN3aXRjaC5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWNoZWNrZWQgLm1kLWJhciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtY29sb3ItMC41fX0nOyB9bWQtc3dpdGNoLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtY2hlY2tlZC5tZC1mb2N1c2VkIC5tZC10aHVtYjpiZWZvcmUgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yLTAuMjZ9fSc7IH1tZC1zd2l0Y2gubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1jaGVja2VkLm1kLXByaW1hcnkgLm1kLXRodW1iIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3J9fSc7IH1tZC1zd2l0Y2gubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1jaGVja2VkLm1kLXByaW1hcnkgLm1kLWJhciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yLTAuNX19JzsgfW1kLXN3aXRjaC5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWNoZWNrZWQubWQtcHJpbWFyeS5tZC1mb2N1c2VkIC5tZC10aHVtYjpiZWZvcmUgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvci0wLjI2fX0nOyB9bWQtc3dpdGNoLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtY2hlY2tlZC5tZC13YXJuIC5tZC10aHVtYiB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3t3YXJuLWNvbG9yfX0nOyB9bWQtc3dpdGNoLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtY2hlY2tlZC5tZC13YXJuIC5tZC1iYXIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7d2Fybi1jb2xvci0wLjV9fSc7IH1tZC1zd2l0Y2gubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1jaGVja2VkLm1kLXdhcm4ubWQtZm9jdXNlZCAubWQtdGh1bWI6YmVmb3JlIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3ItMC4yNn19JzsgfW1kLXN3aXRjaC5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXSAubWQtdGh1bWIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC00MDB9fSc7IH1tZC1zd2l0Y2gubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0gLm1kLWJhciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTR9fSc7IH1tZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtdGFicy13cmFwcGVyIHsgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50OyAgYm9yZGVyLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTR9fSc7IH1tZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXBhZ2luYXRvciBtZC1pY29uIHsgIGNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyB9bWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLWluay1iYXIgeyAgY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgIGJhY2tncm91bmQ6ICd7e2FjY2VudC1jb2xvcn19JzsgfW1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtdGFiIHsgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTJ9fSc7IH0gIG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtdGFiW2Rpc2FibGVkXSB7ICAgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTN9fSc7IH0gIG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtdGFiLm1kLWFjdGl2ZSwgbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC10YWIubWQtZm9jdXNlZCB7ICAgIGNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyB9ICBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXRhYi5tZC1mb2N1c2VkIHsgICAgYmFja2dyb3VuZDogJ3t7cHJpbWFyeS1jb2xvci0wLjF9fSc7IH0gIG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtdGFiIC5tZC1yaXBwbGUtY29udGFpbmVyIHsgICAgY29sb3I6ICd7e2FjY2VudC0xMDB9fSc7IH1tZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IG1kLXRhYnMtd3JhcHBlciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH1tZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IG1kLXRhYi1pdGVtOm5vdChbZGlzYWJsZWRdKSB7ICBjb2xvcjogJ3t7YWNjZW50LTEwMH19JzsgfSAgbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudCBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtYWN0aXZlLCBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IG1kLXRhYi1pdGVtOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkIHsgICAgY29sb3I6ICd7e2FjY2VudC1jb250cmFzdH19JzsgfSAgbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudCBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgIGJhY2tncm91bmQ6ICd7e2FjY2VudC1jb250cmFzdC0wLjF9fSc7IH1tZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IG1kLWluay1iYXIgeyAgY29sb3I6ICd7e3ByaW1hcnktNjAwLTF9fSc7ICBiYWNrZ3JvdW5kOiAne3twcmltYXJ5LTYwMC0xfX0nOyB9bWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkgbWQtdGFicy13cmFwcGVyIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3J9fSc7IH1tZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeSBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkgeyAgY29sb3I6ICd7e3ByaW1hcnktMTAwfX0nOyB9ICBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeSBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtYWN0aXZlLCBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeSBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgIGNvbG9yOiAne3twcmltYXJ5LWNvbnRyYXN0fX0nOyB9ICBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeSBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgIGJhY2tncm91bmQ6ICd7e3ByaW1hcnktY29udHJhc3QtMC4xfX0nOyB9bWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4gbWQtdGFicy13cmFwcGVyIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH1tZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkgeyAgY29sb3I6ICd7e3dhcm4tMTAwfX0nOyB9ICBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtYWN0aXZlLCBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgIGNvbG9yOiAne3t3YXJuLWNvbnRyYXN0fX0nOyB9ICBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgIGJhY2tncm91bmQ6ICd7e3dhcm4tY29udHJhc3QtMC4xfX0nOyB9bWQtdG9vbGJhciA+IG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSBtZC10YWJzLXdyYXBwZXIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfW1kLXRvb2xiYXIgPiBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pIHsgIGNvbG9yOiAne3twcmltYXJ5LTEwMH19JzsgfSAgbWQtdG9vbGJhciA+IG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtYWN0aXZlLCBtZC10b29sYmFyID4gbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLXRhYi1pdGVtOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkIHsgICAgY29sb3I6ICd7e3ByaW1hcnktY29udHJhc3R9fSc7IH0gIG1kLXRvb2xiYXIgPiBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQgeyAgICBiYWNrZ3JvdW5kOiAne3twcmltYXJ5LWNvbnRyYXN0LTAuMX19JzsgfW1kLXRvb2xiYXIubWQtYWNjZW50ID4gbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLXRhYnMtd3JhcHBlciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH1tZC10b29sYmFyLm1kLWFjY2VudCA+IG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkgeyAgY29sb3I6ICd7e2FjY2VudC0xMDB9fSc7IH0gIG1kLXRvb2xiYXIubWQtYWNjZW50ID4gbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLXRhYi1pdGVtOm5vdChbZGlzYWJsZWRdKS5tZC1hY3RpdmUsIG1kLXRvb2xiYXIubWQtYWNjZW50ID4gbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLXRhYi1pdGVtOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkIHsgICAgY29sb3I6ICd7e2FjY2VudC1jb250cmFzdH19JzsgfSAgbWQtdG9vbGJhci5tZC1hY2NlbnQgPiBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQgeyAgICBiYWNrZ3JvdW5kOiAne3thY2NlbnQtY29udHJhc3QtMC4xfX0nOyB9bWQtdG9vbGJhci5tZC1hY2NlbnQgPiBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtaW5rLWJhciB7ICBjb2xvcjogJ3t7cHJpbWFyeS02MDAtMX19JzsgIGJhY2tncm91bmQ6ICd7e3ByaW1hcnktNjAwLTF9fSc7IH1tZC10b29sYmFyLm1kLXdhcm4gPiBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtdGFicy13cmFwcGVyIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH1tZC10b29sYmFyLm1kLXdhcm4gPiBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pIHsgIGNvbG9yOiAne3t3YXJuLTEwMH19JzsgfSAgbWQtdG9vbGJhci5tZC13YXJuID4gbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLXRhYi1pdGVtOm5vdChbZGlzYWJsZWRdKS5tZC1hY3RpdmUsIG1kLXRvb2xiYXIubWQtd2FybiA+IG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgIGNvbG9yOiAne3t3YXJuLWNvbnRyYXN0fX0nOyB9ICBtZC10b29sYmFyLm1kLXdhcm4gPiBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQgeyAgICBiYWNrZ3JvdW5kOiAne3t3YXJuLWNvbnRyYXN0LTAuMX19JzsgfW1kLXRvYXN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgYmFja2dyb3VuZC1jb2xvcjogIzMyMzIzMjsgIGNvbG9yOiAne3tiYWNrZ3JvdW5kLTUwfX0nOyB9ICBtZC10b2FzdC5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1idXR0b24geyAgICBjb2xvcjogJ3t7YmFja2dyb3VuZC01MH19JzsgfSAgICBtZC10b2FzdC5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1idXR0b24ubWQtaGlnaGxpZ2h0IHsgICAgICBjb2xvcjogJ3t7cHJpbWFyeS1BMjAwfX0nOyB9ICAgICAgbWQtdG9hc3QubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtYnV0dG9uLm1kLWhpZ2hsaWdodC5tZC1hY2NlbnQgeyAgICAgICAgY29sb3I6ICd7e2FjY2VudC1BMjAwfX0nOyB9ICAgICAgbWQtdG9hc3QubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtYnV0dG9uLm1kLWhpZ2hsaWdodC5tZC13YXJuIHsgICAgICAgIGNvbG9yOiAne3t3YXJuLUEyMDB9fSc7IH1tZC10b29sYmFyLm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgIGNvbG9yOiAne3twcmltYXJ5LWNvbnRyYXN0fX0nOyB9ICBtZC10b29sYmFyLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtaWNvbiB7ICAgIGNvbG9yOiAne3twcmltYXJ5LWNvbnRyYXN0fX0nOyB9ICBtZC10b29sYmFyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWJ1dHRvbiB7ICAgIGNvbG9yOiAne3twcmltYXJ5LWNvbnRyYXN0fX0nOyB9ICBtZC10b29sYmFyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IHsgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyAgICBjb2xvcjogJ3t7YWNjZW50LWNvbnRyYXN0fX0nOyB9ICBtZC10b29sYmFyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiB7ICAgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7ICAgIGNvbG9yOiAne3t3YXJuLWNvbnRyYXN0fX0nOyB9bWQtdG9vbHRpcC5tZC1USEVNRV9OQU1FLXRoZW1lIHsgIGNvbG9yOiAne3tiYWNrZ3JvdW5kLUExMDB9fSc7IH0gIG1kLXRvb2x0aXAubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtYmFja2dyb3VuZCB7ICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2ZvcmVncm91bmQtMn19JzsgfVwiKTsgXG59KSgpO1xuXG5cbn0pKHdpbmRvdywgd2luZG93LmFuZ3VsYXIpOyIsIi8qXG4galF1ZXJ5IFVJIFNvcnRhYmxlIHBsdWdpbiB3cmFwcGVyXG5cbiBAcGFyYW0gW3VpLXNvcnRhYmxlXSB7b2JqZWN0fSBPcHRpb25zIHRvIHBhc3MgdG8gJC5mbi5zb3J0YWJsZSgpIG1lcmdlZCBvbnRvIHVpLmNvbmZpZ1xuICovXG5hbmd1bGFyLm1vZHVsZSgndWkuc29ydGFibGUnLCBbXSlcbiAgLnZhbHVlKCd1aVNvcnRhYmxlQ29uZmlnJyx7fSlcbiAgLmRpcmVjdGl2ZSgndWlTb3J0YWJsZScsIFtcbiAgICAndWlTb3J0YWJsZUNvbmZpZycsICckdGltZW91dCcsICckbG9nJyxcbiAgICBmdW5jdGlvbih1aVNvcnRhYmxlQ29uZmlnLCAkdGltZW91dCwgJGxvZykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcmVxdWlyZTogJz9uZ01vZGVsJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICBuZ01vZGVsOiAnPScsXG4gICAgICAgICAgdWlTb3J0YWJsZTogJz0nXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycywgbmdNb2RlbCkge1xuICAgICAgICAgIHZhciBzYXZlZE5vZGVzO1xuXG4gICAgICAgICAgZnVuY3Rpb24gY29tYmluZUNhbGxiYWNrcyhmaXJzdCxzZWNvbmQpe1xuICAgICAgICAgICAgaWYoc2Vjb25kICYmICh0eXBlb2Ygc2Vjb25kID09PSAnZnVuY3Rpb24nKSkge1xuICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgZmlyc3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgICAgICBzZWNvbmQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmaXJzdDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBnZXRTb3J0YWJsZVdpZGdldEluc3RhbmNlKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIC8vIHRoaXMgaXMgYSBmaXggdG8gc3VwcG9ydCBqcXVlcnktdWkgcHJpb3IgdG8gdjEuMTEueFxuICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIHdlIHNob3VsZCBiZSB1c2luZyBgZWxlbWVudC5zb3J0YWJsZSgnaW5zdGFuY2UnKWBcbiAgICAgICAgICAgIHZhciBkYXRhID0gZWxlbWVudC5kYXRhKCd1aS1zb3J0YWJsZScpO1xuICAgICAgICAgICAgaWYgKGRhdGEgJiYgdHlwZW9mIGRhdGEgPT09ICdvYmplY3QnICYmIGRhdGEud2lkZ2V0RnVsbE5hbWUgPT09ICd1aS1zb3J0YWJsZScpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBoYXNTb3J0aW5nSGVscGVyIChlbGVtZW50LCB1aSkge1xuICAgICAgICAgICAgdmFyIGhlbHBlck9wdGlvbiA9IGVsZW1lbnQuc29ydGFibGUoJ29wdGlvbicsJ2hlbHBlcicpO1xuICAgICAgICAgICAgcmV0dXJuIGhlbHBlck9wdGlvbiA9PT0gJ2Nsb25lJyB8fCAodHlwZW9mIGhlbHBlck9wdGlvbiA9PT0gJ2Z1bmN0aW9uJyAmJiB1aS5pdGVtLnNvcnRhYmxlLmlzQ3VzdG9tSGVscGVyVXNlZCgpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyB0aGFua3MganF1ZXJ5LXVpXG4gICAgICAgICAgZnVuY3Rpb24gaXNGbG9hdGluZyAoaXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuICgvbGVmdHxyaWdodC8pLnRlc3QoaXRlbS5jc3MoJ2Zsb2F0JykpIHx8ICgvaW5saW5lfHRhYmxlLWNlbGwvKS50ZXN0KGl0ZW0uY3NzKCdkaXNwbGF5JykpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGdldEVsZW1lbnRTY29wZShlbGVtZW50U2NvcGVzLCBlbGVtZW50KSB7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gbnVsbDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbWVudFNjb3Blcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICB2YXIgeCA9IGVsZW1lbnRTY29wZXNbaV07XG4gICAgICAgICAgICAgIGlmICh4LmVsZW1lbnRbMF0gPT09IGVsZW1lbnRbMF0pIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB4LnNjb3BlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGFmdGVyU3RvcChlLCB1aSkge1xuICAgICAgICAgICAgdWkuaXRlbS5zb3J0YWJsZS5fZGVzdHJveSgpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBvcHRzID0ge307XG5cbiAgICAgICAgICAvLyBkaXJlY3RpdmUgc3BlY2lmaWMgb3B0aW9uc1xuICAgICAgICAgIHZhciBkaXJlY3RpdmVPcHRzID0ge1xuICAgICAgICAgICAgJ3VpLWZsb2F0aW5nJzogdW5kZWZpbmVkXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIHZhciBjYWxsYmFja3MgPSB7XG4gICAgICAgICAgICByZWNlaXZlOiBudWxsLFxuICAgICAgICAgICAgcmVtb3ZlOm51bGwsXG4gICAgICAgICAgICBzdGFydDpudWxsLFxuICAgICAgICAgICAgc3RvcDpudWxsLFxuICAgICAgICAgICAgdXBkYXRlOm51bGxcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgdmFyIHdyYXBwZXJzID0ge1xuICAgICAgICAgICAgaGVscGVyOiBudWxsXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKG9wdHMsIGRpcmVjdGl2ZU9wdHMsIHVpU29ydGFibGVDb25maWcsIHNjb3BlLnVpU29ydGFibGUpO1xuXG4gICAgICAgICAgaWYgKCFhbmd1bGFyLmVsZW1lbnQuZm4gfHwgIWFuZ3VsYXIuZWxlbWVudC5mbi5qcXVlcnkpIHtcbiAgICAgICAgICAgICRsb2cuZXJyb3IoJ3VpLnNvcnRhYmxlOiBqUXVlcnkgc2hvdWxkIGJlIGluY2x1ZGVkIGJlZm9yZSBBbmd1bGFySlMhJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKG5nTW9kZWwpIHtcblxuICAgICAgICAgICAgLy8gV2hlbiB3ZSBhZGQgb3IgcmVtb3ZlIGVsZW1lbnRzLCB3ZSBuZWVkIHRoZSBzb3J0YWJsZSB0byAncmVmcmVzaCdcbiAgICAgICAgICAgIC8vIHNvIGl0IGNhbiBmaW5kIHRoZSBuZXcvcmVtb3ZlZCBlbGVtZW50cy5cbiAgICAgICAgICAgIHNjb3BlLiR3YXRjaCgnbmdNb2RlbC5sZW5ndGgnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgLy8gVGltZW91dCB0byBsZXQgbmctcmVwZWF0IG1vZGlmeSB0aGUgRE9NXG4gICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIC8vIGVuc3VyZSB0aGF0IHRoZSBqcXVlcnktdWktc29ydGFibGUgd2lkZ2V0IGluc3RhbmNlXG4gICAgICAgICAgICAgICAgLy8gaXMgc3RpbGwgYm91bmQgdG8gdGhlIGRpcmVjdGl2ZSdzIGVsZW1lbnRcbiAgICAgICAgICAgICAgICBpZiAoISFnZXRTb3J0YWJsZVdpZGdldEluc3RhbmNlKGVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgICBlbGVtZW50LnNvcnRhYmxlKCdyZWZyZXNoJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LCAwLCBmYWxzZSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY2FsbGJhY2tzLnN0YXJ0ID0gZnVuY3Rpb24oZSwgdWkpIHtcbiAgICAgICAgICAgICAgaWYgKG9wdHNbJ3VpLWZsb2F0aW5nJ10gPT09ICdhdXRvJykge1xuICAgICAgICAgICAgICAgIC8vIHNpbmNlIHRoZSBkcmFnIGhhcyBzdGFydGVkLCB0aGUgZWxlbWVudCB3aWxsIGJlXG4gICAgICAgICAgICAgICAgLy8gYWJzb2x1dGVseSBwb3NpdGlvbmVkLCBzbyB3ZSBjaGVjayBpdHMgc2libGluZ3NcbiAgICAgICAgICAgICAgICB2YXIgc2libGluZ3MgPSB1aS5pdGVtLnNpYmxpbmdzKCk7XG4gICAgICAgICAgICAgICAgdmFyIHNvcnRhYmxlV2lkZ2V0SW5zdGFuY2UgPSBnZXRTb3J0YWJsZVdpZGdldEluc3RhbmNlKGFuZ3VsYXIuZWxlbWVudChlLnRhcmdldCkpO1xuICAgICAgICAgICAgICAgIHNvcnRhYmxlV2lkZ2V0SW5zdGFuY2UuZmxvYXRpbmcgPSBpc0Zsb2F0aW5nKHNpYmxpbmdzKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIC8vIFNhdmUgdGhlIHN0YXJ0aW5nIHBvc2l0aW9uIG9mIGRyYWdnZWQgaXRlbVxuICAgICAgICAgICAgICB1aS5pdGVtLnNvcnRhYmxlID0ge1xuICAgICAgICAgICAgICAgIG1vZGVsOiBuZ01vZGVsLiRtb2RlbFZhbHVlW3VpLml0ZW0uaW5kZXgoKV0sXG4gICAgICAgICAgICAgICAgaW5kZXg6IHVpLml0ZW0uaW5kZXgoKSxcbiAgICAgICAgICAgICAgICBzb3VyY2U6IHVpLml0ZW0ucGFyZW50KCksXG4gICAgICAgICAgICAgICAgc291cmNlTW9kZWw6IG5nTW9kZWwuJG1vZGVsVmFsdWUsXG4gICAgICAgICAgICAgICAgY2FuY2VsOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICB1aS5pdGVtLnNvcnRhYmxlLl9pc0NhbmNlbGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGlzQ2FuY2VsZWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB1aS5pdGVtLnNvcnRhYmxlLl9pc0NhbmNlbGVkO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgaXNDdXN0b21IZWxwZXJVc2VkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gISF1aS5pdGVtLnNvcnRhYmxlLl9pc0N1c3RvbUhlbHBlclVzZWQ7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBfaXNDYW5jZWxlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgX2lzQ3VzdG9tSGVscGVyVXNlZDogdWkuaXRlbS5zb3J0YWJsZS5faXNDdXN0b21IZWxwZXJVc2VkLFxuICAgICAgICAgICAgICAgIF9kZXN0cm95OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2godWkuaXRlbS5zb3J0YWJsZSwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAgICAgICAgICAgICAgICB1aS5pdGVtLnNvcnRhYmxlW2tleV0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjYWxsYmFja3MuYWN0aXZhdGUgPSBmdW5jdGlvbihlLCB1aSkge1xuICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIG1ha2UgYSBjb3B5IG9mIHRoZSBjdXJyZW50IGVsZW1lbnQncyBjb250ZW50cyBzb1xuICAgICAgICAgICAgICAvLyB3ZSBjYW4gcmVzdG9yZSBpdCBhZnRlciBzb3J0YWJsZSBoYXMgbWVzc2VkIGl0IHVwLlxuICAgICAgICAgICAgICAvLyBUaGlzIGlzIGluc2lkZSBhY3RpdmF0ZSAoaW5zdGVhZCBvZiBzdGFydCkgaW4gb3JkZXIgdG8gc2F2ZVxuICAgICAgICAgICAgICAvLyBib3RoIGxpc3RzIHdoZW4gZHJhZ2dpbmcgYmV0d2VlbiBjb25uZWN0ZWQgbGlzdHMuXG4gICAgICAgICAgICAgIHNhdmVkTm9kZXMgPSBlbGVtZW50LmNvbnRlbnRzKCk7XG5cbiAgICAgICAgICAgICAgLy8gSWYgdGhpcyBsaXN0IGhhcyBhIHBsYWNlaG9sZGVyICh0aGUgY29ubmVjdGVkIGxpc3RzIHdvbid0KSxcbiAgICAgICAgICAgICAgLy8gZG9uJ3QgaW5sY3VkZSBpdCBpbiBzYXZlZCBub2Rlcy5cbiAgICAgICAgICAgICAgdmFyIHBsYWNlaG9sZGVyID0gZWxlbWVudC5zb3J0YWJsZSgnb3B0aW9uJywncGxhY2Vob2xkZXInKTtcblxuICAgICAgICAgICAgICAvLyBwbGFjZWhvbGRlci5lbGVtZW50IHdpbGwgYmUgYSBmdW5jdGlvbiBpZiB0aGUgcGxhY2Vob2xkZXIsIGhhc1xuICAgICAgICAgICAgICAvLyBiZWVuIGNyZWF0ZWQgKHBsYWNlaG9sZGVyIHdpbGwgYmUgYW4gb2JqZWN0KS4gIElmIGl0IGhhc24ndFxuICAgICAgICAgICAgICAvLyBiZWVuIGNyZWF0ZWQsIGVpdGhlciBwbGFjZWhvbGRlciB3aWxsIGJlIGZhbHNlIGlmIG5vXG4gICAgICAgICAgICAgIC8vIHBsYWNlaG9sZGVyIGNsYXNzIHdhcyBnaXZlbiBvciBwbGFjZWhvbGRlci5lbGVtZW50IHdpbGwgYmVcbiAgICAgICAgICAgICAgLy8gdW5kZWZpbmVkIGlmIGEgY2xhc3Mgd2FzIGdpdmVuIChwbGFjZWhvbGRlciB3aWxsIGJlIGEgc3RyaW5nKVxuICAgICAgICAgICAgICBpZiAocGxhY2Vob2xkZXIgJiYgcGxhY2Vob2xkZXIuZWxlbWVudCAmJiB0eXBlb2YgcGxhY2Vob2xkZXIuZWxlbWVudCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIHZhciBwaEVsZW1lbnQgPSBwbGFjZWhvbGRlci5lbGVtZW50KCk7XG4gICAgICAgICAgICAgICAgLy8gd29ya2Fyb3VuZCBmb3IganF1ZXJ5IHVpIDEuOS54LFxuICAgICAgICAgICAgICAgIC8vIG5vdCByZXR1cm5pbmcganF1ZXJ5IGNvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICBwaEVsZW1lbnQgPSBhbmd1bGFyLmVsZW1lbnQocGhFbGVtZW50KTtcblxuICAgICAgICAgICAgICAgIC8vIGV4YWN0IG1hdGNoIHdpdGggdGhlIHBsYWNlaG9sZGVyJ3MgY2xhc3MgYXR0cmlidXRlIHRvIGhhbmRsZVxuICAgICAgICAgICAgICAgIC8vIHRoZSBjYXNlIHRoYXQgbXVsdGlwbGUgY29ubmVjdGVkIHNvcnRhYmxlcyBleGlzdCBhbmRcbiAgICAgICAgICAgICAgICAvLyB0aGUgcGxhY2Vob2lsZGVyIG9wdGlvbiBlcXVhbHMgdGhlIGNsYXNzIG9mIHNvcnRhYmxlIGl0ZW1zXG4gICAgICAgICAgICAgICAgdmFyIGV4Y2x1ZGVzID0gZWxlbWVudC5maW5kKCdbY2xhc3M9XCInICsgcGhFbGVtZW50LmF0dHIoJ2NsYXNzJykgKyAnXCJdOm5vdChbbmctcmVwZWF0XSwgW2RhdGEtbmctcmVwZWF0XSknKTtcblxuICAgICAgICAgICAgICAgIHNhdmVkTm9kZXMgPSBzYXZlZE5vZGVzLm5vdChleGNsdWRlcyk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAvLyBzYXZlIHRoZSBkaXJlY3RpdmUncyBzY29wZSBzbyB0aGF0IGl0IGlzIGFjY2Vzc2libGUgZnJvbSB1aS5pdGVtLnNvcnRhYmxlXG4gICAgICAgICAgICAgIHZhciBjb25uZWN0ZWRTb3J0YWJsZXMgPSB1aS5pdGVtLnNvcnRhYmxlLl9jb25uZWN0ZWRTb3J0YWJsZXMgfHwgW107XG5cbiAgICAgICAgICAgICAgY29ubmVjdGVkU29ydGFibGVzLnB1c2goe1xuICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGVsZW1lbnQsXG4gICAgICAgICAgICAgICAgc2NvcGU6IHNjb3BlXG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgIHVpLml0ZW0uc29ydGFibGUuX2Nvbm5lY3RlZFNvcnRhYmxlcyA9IGNvbm5lY3RlZFNvcnRhYmxlcztcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNhbGxiYWNrcy51cGRhdGUgPSBmdW5jdGlvbihlLCB1aSkge1xuICAgICAgICAgICAgICAvLyBTYXZlIGN1cnJlbnQgZHJvcCBwb3NpdGlvbiBidXQgb25seSBpZiB0aGlzIGlzIG5vdCBhIHNlY29uZFxuICAgICAgICAgICAgICAvLyB1cGRhdGUgdGhhdCBoYXBwZW5zIHdoZW4gbW92aW5nIGJldHdlZW4gbGlzdHMgYmVjYXVzZSB0aGVuXG4gICAgICAgICAgICAgIC8vIHRoZSB2YWx1ZSB3aWxsIGJlIG92ZXJ3cml0dGVuIHdpdGggdGhlIG9sZCB2YWx1ZVxuICAgICAgICAgICAgICBpZighdWkuaXRlbS5zb3J0YWJsZS5yZWNlaXZlZCkge1xuICAgICAgICAgICAgICAgIHVpLml0ZW0uc29ydGFibGUuZHJvcGluZGV4ID0gdWkuaXRlbS5pbmRleCgpO1xuICAgICAgICAgICAgICAgIHZhciBkcm9wdGFyZ2V0ID0gdWkuaXRlbS5wYXJlbnQoKTtcbiAgICAgICAgICAgICAgICB1aS5pdGVtLnNvcnRhYmxlLmRyb3B0YXJnZXQgPSBkcm9wdGFyZ2V0O1xuXG4gICAgICAgICAgICAgICAgdmFyIGRyb3B0YXJnZXRTY29wZSA9IGdldEVsZW1lbnRTY29wZSh1aS5pdGVtLnNvcnRhYmxlLl9jb25uZWN0ZWRTb3J0YWJsZXMsIGRyb3B0YXJnZXQpO1xuICAgICAgICAgICAgICAgIHVpLml0ZW0uc29ydGFibGUuZHJvcHRhcmdldE1vZGVsID0gZHJvcHRhcmdldFNjb3BlLm5nTW9kZWw7XG5cbiAgICAgICAgICAgICAgICAvLyBDYW5jZWwgdGhlIHNvcnQgKGxldCBuZy1yZXBlYXQgZG8gdGhlIHNvcnQgZm9yIHVzKVxuICAgICAgICAgICAgICAgIC8vIERvbid0IGNhbmNlbCBpZiB0aGlzIGlzIHRoZSByZWNlaXZlZCBsaXN0IGJlY2F1c2UgaXQgaGFzXG4gICAgICAgICAgICAgICAgLy8gYWxyZWFkeSBiZWVuIGNhbmNlbGVkIGluIHRoZSBvdGhlciBsaXN0LCBhbmQgdHJ5aW5nIHRvIGNhbmNlbFxuICAgICAgICAgICAgICAgIC8vIGhlcmUgd2lsbCBtZXNzIHVwIHRoZSBET00uXG4gICAgICAgICAgICAgICAgZWxlbWVudC5zb3J0YWJsZSgnY2FuY2VsJyk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAvLyBQdXQgdGhlIG5vZGVzIGJhY2sgZXhhY3RseSB0aGUgd2F5IHRoZXkgc3RhcnRlZCAodGhpcyBpcyB2ZXJ5XG4gICAgICAgICAgICAgIC8vIGltcG9ydGFudCBiZWNhdXNlIG5nLXJlcGVhdCB1c2VzIGNvbW1lbnQgZWxlbWVudHMgdG8gZGVsaW5lYXRlXG4gICAgICAgICAgICAgIC8vIHRoZSBzdGFydCBhbmQgc3RvcCBvZiByZXBlYXQgc2VjdGlvbnMgYW5kIHNvcnRhYmxlIGRvZXNuJ3RcbiAgICAgICAgICAgICAgLy8gcmVzcGVjdCB0aGVpciBvcmRlciAoZXZlbiBpZiB3ZSBjYW5jZWwsIHRoZSBvcmRlciBvZiB0aGVcbiAgICAgICAgICAgICAgLy8gY29tbWVudHMgYXJlIHN0aWxsIG1lc3NlZCB1cCkuXG4gICAgICAgICAgICAgIGlmIChoYXNTb3J0aW5nSGVscGVyKGVsZW1lbnQsIHVpKSAmJiAhdWkuaXRlbS5zb3J0YWJsZS5yZWNlaXZlZCAmJlxuICAgICAgICAgICAgICAgICAgZWxlbWVudC5zb3J0YWJsZSggJ29wdGlvbicsICdhcHBlbmRUbycgKSA9PT0gJ3BhcmVudCcpIHtcbiAgICAgICAgICAgICAgICAvLyByZXN0b3JlIGFsbCB0aGUgc2F2ZWROb2RlcyBleGNlcHQgLnVpLXNvcnRhYmxlLWhlbHBlciBlbGVtZW50XG4gICAgICAgICAgICAgICAgLy8gKHdoaWNoIGlzIHBsYWNlZCBsYXN0KS4gVGhhdCB3YXkgaXQgd2lsbCBiZSBnYXJiYWdlIGNvbGxlY3RlZC5cbiAgICAgICAgICAgICAgICBzYXZlZE5vZGVzID0gc2F2ZWROb2Rlcy5ub3Qoc2F2ZWROb2Rlcy5sYXN0KCkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHNhdmVkTm9kZXMuYXBwZW5kVG8oZWxlbWVudCk7XG5cbiAgICAgICAgICAgICAgLy8gSWYgdGhpcyBpcyB0aGUgdGFyZ2V0IGNvbm5lY3RlZCBsaXN0IHRoZW5cbiAgICAgICAgICAgICAgLy8gaXQncyBzYWZlIHRvIGNsZWFyIHRoZSByZXN0b3JlZCBub2RlcyBzaW5jZTpcbiAgICAgICAgICAgICAgLy8gdXBkYXRlIGlzIGN1cnJlbnRseSBydW5uaW5nIGFuZFxuICAgICAgICAgICAgICAvLyBzdG9wIGlzIG5vdCBjYWxsZWQgZm9yIHRoZSB0YXJnZXQgbGlzdC5cbiAgICAgICAgICAgICAgaWYodWkuaXRlbS5zb3J0YWJsZS5yZWNlaXZlZCkge1xuICAgICAgICAgICAgICAgIHNhdmVkTm9kZXMgPSBudWxsO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgLy8gSWYgcmVjZWl2ZWQgaXMgdHJ1ZSAoYW4gaXRlbSB3YXMgZHJvcHBlZCBpbiBmcm9tIGFub3RoZXIgbGlzdClcbiAgICAgICAgICAgICAgLy8gdGhlbiB3ZSBhZGQgdGhlIG5ldyBpdGVtIHRvIHRoaXMgbGlzdCBvdGhlcndpc2Ugd2FpdCB1bnRpbCB0aGVcbiAgICAgICAgICAgICAgLy8gc3RvcCBldmVudCB3aGVyZSB3ZSB3aWxsIGtub3cgaWYgaXQgd2FzIGEgc29ydCBvciBpdGVtIHdhc1xuICAgICAgICAgICAgICAvLyBtb3ZlZCBoZXJlIGZyb20gYW5vdGhlciBsaXN0XG4gICAgICAgICAgICAgIGlmKHVpLml0ZW0uc29ydGFibGUucmVjZWl2ZWQgJiYgIXVpLml0ZW0uc29ydGFibGUuaXNDYW5jZWxlZCgpKSB7XG4gICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgIG5nTW9kZWwuJG1vZGVsVmFsdWUuc3BsaWNlKHVpLml0ZW0uc29ydGFibGUuZHJvcGluZGV4LCAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWkuaXRlbS5zb3J0YWJsZS5tb3ZlZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNhbGxiYWNrcy5zdG9wID0gZnVuY3Rpb24oZSwgdWkpIHtcbiAgICAgICAgICAgICAgLy8gSWYgdGhlIHJlY2VpdmVkIGZsYWcgaGFzbid0IGJlIHNldCBvbiB0aGUgaXRlbSwgdGhpcyBpcyBhXG4gICAgICAgICAgICAgIC8vIG5vcm1hbCBzb3J0LCBpZiBkcm9waW5kZXggaXMgc2V0LCB0aGUgaXRlbSB3YXMgbW92ZWQsIHNvIG1vdmVcbiAgICAgICAgICAgICAgLy8gdGhlIGl0ZW1zIGluIHRoZSBsaXN0LlxuICAgICAgICAgICAgICBpZighdWkuaXRlbS5zb3J0YWJsZS5yZWNlaXZlZCAmJlxuICAgICAgICAgICAgICAgICAoJ2Ryb3BpbmRleCcgaW4gdWkuaXRlbS5zb3J0YWJsZSkgJiZcbiAgICAgICAgICAgICAgICAgIXVpLml0ZW0uc29ydGFibGUuaXNDYW5jZWxlZCgpKSB7XG5cbiAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgbmdNb2RlbC4kbW9kZWxWYWx1ZS5zcGxpY2UoXG4gICAgICAgICAgICAgICAgICAgIHVpLml0ZW0uc29ydGFibGUuZHJvcGluZGV4LCAwLFxuICAgICAgICAgICAgICAgICAgICBuZ01vZGVsLiRtb2RlbFZhbHVlLnNwbGljZSh1aS5pdGVtLnNvcnRhYmxlLmluZGV4LCAxKVswXSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gaWYgdGhlIGl0ZW0gd2FzIG5vdCBtb3ZlZCwgdGhlbiByZXN0b3JlIHRoZSBlbGVtZW50c1xuICAgICAgICAgICAgICAgIC8vIHNvIHRoYXQgdGhlIG5nUmVwZWF0J3MgY29tbWVudCBhcmUgY29ycmVjdC5cbiAgICAgICAgICAgICAgICBpZiAoKCEoJ2Ryb3BpbmRleCcgaW4gdWkuaXRlbS5zb3J0YWJsZSkgfHwgdWkuaXRlbS5zb3J0YWJsZS5pc0NhbmNlbGVkKCkpICYmXG4gICAgICAgICAgICAgICAgICAgICFoYXNTb3J0aW5nSGVscGVyKGVsZW1lbnQsIHVpKSkge1xuICAgICAgICAgICAgICAgICAgc2F2ZWROb2Rlcy5hcHBlbmRUbyhlbGVtZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAvLyBJdCdzIG5vdyBzYWZlIHRvIGNsZWFyIHRoZSBzYXZlZE5vZGVzXG4gICAgICAgICAgICAgIC8vIHNpbmNlIHN0b3AgaXMgdGhlIGxhc3QgY2FsbGJhY2suXG4gICAgICAgICAgICAgIHNhdmVkTm9kZXMgPSBudWxsO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY2FsbGJhY2tzLnJlY2VpdmUgPSBmdW5jdGlvbihlLCB1aSkge1xuICAgICAgICAgICAgICAvLyBBbiBpdGVtIHdhcyBkcm9wcGVkIGhlcmUgZnJvbSBhbm90aGVyIGxpc3QsIHNldCBhIGZsYWcgb24gdGhlXG4gICAgICAgICAgICAgIC8vIGl0ZW0uXG4gICAgICAgICAgICAgIHVpLml0ZW0uc29ydGFibGUucmVjZWl2ZWQgPSB0cnVlO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY2FsbGJhY2tzLnJlbW92ZSA9IGZ1bmN0aW9uKGUsIHVpKSB7XG4gICAgICAgICAgICAgIC8vIFdvcmthcm91bmQgZm9yIGEgcHJvYmxlbSBvYnNlcnZlZCBpbiBuZXN0ZWQgY29ubmVjdGVkIGxpc3RzLlxuICAgICAgICAgICAgICAvLyBUaGVyZSBzaG91bGQgYmUgYW4gJ3VwZGF0ZScgZXZlbnQgYmVmb3JlICdyZW1vdmUnIHdoZW4gbW92aW5nXG4gICAgICAgICAgICAgIC8vIGVsZW1lbnRzLiBJZiB0aGUgZXZlbnQgZGlkIG5vdCBmaXJlLCBjYW5jZWwgc29ydGluZy5cbiAgICAgICAgICAgICAgaWYgKCEoJ2Ryb3BpbmRleCcgaW4gdWkuaXRlbS5zb3J0YWJsZSkpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnNvcnRhYmxlKCdjYW5jZWwnKTtcbiAgICAgICAgICAgICAgICB1aS5pdGVtLnNvcnRhYmxlLmNhbmNlbCgpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBpdGVtIGZyb20gdGhpcyBsaXN0J3MgbW9kZWwgYW5kIGNvcHkgZGF0YSBpbnRvIGl0ZW0sXG4gICAgICAgICAgICAgIC8vIHNvIHRoZSBuZXh0IGxpc3QgY2FuIHJldHJpdmUgaXRcbiAgICAgICAgICAgICAgaWYgKCF1aS5pdGVtLnNvcnRhYmxlLmlzQ2FuY2VsZWQoKSkge1xuICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICB1aS5pdGVtLnNvcnRhYmxlLm1vdmVkID0gbmdNb2RlbC4kbW9kZWxWYWx1ZS5zcGxpY2UoXG4gICAgICAgICAgICAgICAgICAgIHVpLml0ZW0uc29ydGFibGUuaW5kZXgsIDEpWzBdO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB3cmFwcGVycy5oZWxwZXIgPSBmdW5jdGlvbiAoaW5uZXIpIHtcbiAgICAgICAgICAgICAgaWYgKGlubmVyICYmIHR5cGVvZiBpbm5lciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZSwgaXRlbSkge1xuICAgICAgICAgICAgICAgICAgdmFyIGlubmVyUmVzdWx0ID0gaW5uZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgICAgICAgIGl0ZW0uc29ydGFibGUuX2lzQ3VzdG9tSGVscGVyVXNlZCA9IGl0ZW0gIT09IGlubmVyUmVzdWx0O1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGlubmVyUmVzdWx0O1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuIGlubmVyO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgc2NvcGUuJHdhdGNoKCd1aVNvcnRhYmxlJywgZnVuY3Rpb24obmV3VmFsIC8qLCBvbGRWYWwqLykge1xuICAgICAgICAgICAgICAvLyBlbnN1cmUgdGhhdCB0aGUganF1ZXJ5LXVpLXNvcnRhYmxlIHdpZGdldCBpbnN0YW5jZVxuICAgICAgICAgICAgICAvLyBpcyBzdGlsbCBib3VuZCB0byB0aGUgZGlyZWN0aXZlJ3MgZWxlbWVudFxuICAgICAgICAgICAgICB2YXIgc29ydGFibGVXaWRnZXRJbnN0YW5jZSA9IGdldFNvcnRhYmxlV2lkZ2V0SW5zdGFuY2UoZWxlbWVudCk7XG4gICAgICAgICAgICAgIGlmICghIXNvcnRhYmxlV2lkZ2V0SW5zdGFuY2UpIHtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2gobmV3VmFsLCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgICAgICAgICAgICAgICAvLyBpZiBpdCdzIGEgY3VzdG9tIG9wdGlvbiBvZiB0aGUgZGlyZWN0aXZlLFxuICAgICAgICAgICAgICAgICAgLy8gaGFuZGxlIGl0IGFwcHJvcHJpZXRseVxuICAgICAgICAgICAgICAgICAgaWYgKGtleSBpbiBkaXJlY3RpdmVPcHRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChrZXkgPT09ICd1aS1mbG9hdGluZycgJiYgKHZhbHVlID09PSBmYWxzZSB8fCB2YWx1ZSA9PT0gdHJ1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICBzb3J0YWJsZVdpZGdldEluc3RhbmNlLmZsb2F0aW5nID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBvcHRzW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2tzW2tleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYoIGtleSA9PT0gJ3N0b3AnICl7XG4gICAgICAgICAgICAgICAgICAgICAgLy8gY2FsbCBhcHBseSBhZnRlciBzdG9wXG4gICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBjb21iaW5lQ2FsbGJhY2tzKFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUsIGZ1bmN0aW9uKCkgeyBzY29wZS4kYXBwbHkoKTsgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGNvbWJpbmVDYWxsYmFja3ModmFsdWUsIGFmdGVyU3RvcCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gd3JhcCB0aGUgY2FsbGJhY2tcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBjb21iaW5lQ2FsbGJhY2tzKGNhbGxiYWNrc1trZXldLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHdyYXBwZXJzW2tleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB3cmFwcGVyc1trZXldKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgb3B0c1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICBlbGVtZW50LnNvcnRhYmxlKCdvcHRpb24nLCBrZXksIHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgdHJ1ZSk7XG5cbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChjYWxsYmFja3MsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgICAgICAgb3B0c1trZXldID0gY29tYmluZUNhbGxiYWNrcyh2YWx1ZSwgb3B0c1trZXldKTtcbiAgICAgICAgICAgICAgaWYoIGtleSA9PT0gJ3N0b3AnICl7XG4gICAgICAgICAgICAgICAgb3B0c1trZXldID0gY29tYmluZUNhbGxiYWNrcyhvcHRzW2tleV0sIGFmdGVyU3RvcCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRsb2cuaW5mbygndWkuc29ydGFibGU6IG5nTW9kZWwgbm90IHByb3ZpZGVkIScsIGVsZW1lbnQpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIENyZWF0ZSBzb3J0YWJsZVxuICAgICAgICAgIGVsZW1lbnQuc29ydGFibGUob3B0cyk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICBdKTtcbiIsInZhciBmYWJyaWM9ZmFicmljfHx7dmVyc2lvbjpcIjEuNS4wXCJ9O1widW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzJiYoZXhwb3J0cy5mYWJyaWM9ZmFicmljKSxcInVuZGVmaW5lZFwiIT10eXBlb2YgZG9jdW1lbnQmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiB3aW5kb3c/KGZhYnJpYy5kb2N1bWVudD1kb2N1bWVudCxmYWJyaWMud2luZG93PXdpbmRvdyx3aW5kb3cuZmFicmljPWZhYnJpYyk6KGZhYnJpYy5kb2N1bWVudD1yZXF1aXJlKFwianNkb21cIikuanNkb20oXCI8IURPQ1RZUEUgaHRtbD48aHRtbD48aGVhZD48L2hlYWQ+PGJvZHk+PC9ib2R5PjwvaHRtbD5cIiksZmFicmljLmRvY3VtZW50LmNyZWF0ZVdpbmRvdz9mYWJyaWMud2luZG93PWZhYnJpYy5kb2N1bWVudC5jcmVhdGVXaW5kb3coKTpmYWJyaWMud2luZG93PWZhYnJpYy5kb2N1bWVudC5wYXJlbnRXaW5kb3cpLGZhYnJpYy5pc1RvdWNoU3VwcG9ydGVkPVwib250b3VjaHN0YXJ0XCJpbiBmYWJyaWMuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LGZhYnJpYy5pc0xpa2VseU5vZGU9XCJ1bmRlZmluZWRcIiE9dHlwZW9mIEJ1ZmZlciYmXCJ1bmRlZmluZWRcIj09dHlwZW9mIHdpbmRvdyxmYWJyaWMuU0hBUkVEX0FUVFJJQlVURVM9W1wiZGlzcGxheVwiLFwidHJhbnNmb3JtXCIsXCJmaWxsXCIsXCJmaWxsLW9wYWNpdHlcIixcImZpbGwtcnVsZVwiLFwib3BhY2l0eVwiLFwic3Ryb2tlXCIsXCJzdHJva2UtZGFzaGFycmF5XCIsXCJzdHJva2UtbGluZWNhcFwiLFwic3Ryb2tlLWxpbmVqb2luXCIsXCJzdHJva2UtbWl0ZXJsaW1pdFwiLFwic3Ryb2tlLW9wYWNpdHlcIixcInN0cm9rZS13aWR0aFwiXSxmYWJyaWMuRFBJPTk2LGZhYnJpYy5yZU51bT1cIig/OlstK10/KD86XFxcXGQrfFxcXFxkKlxcXFwuXFxcXGQrKSg/OmVbLStdP1xcXFxkKyk/KVwiLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3RoaXMuX19ldmVudExpc3RlbmVyc1t0XSYmKGU/ZmFicmljLnV0aWwucmVtb3ZlRnJvbUFycmF5KHRoaXMuX19ldmVudExpc3RlbmVyc1t0XSxlKTp0aGlzLl9fZXZlbnRMaXN0ZW5lcnNbdF0ubGVuZ3RoPTApfWZ1bmN0aW9uIGUodCxlKXtpZih0aGlzLl9fZXZlbnRMaXN0ZW5lcnN8fCh0aGlzLl9fZXZlbnRMaXN0ZW5lcnM9e30pLDE9PT1hcmd1bWVudHMubGVuZ3RoKWZvcih2YXIgaSBpbiB0KXRoaXMub24oaSx0W2ldKTtlbHNlIHRoaXMuX19ldmVudExpc3RlbmVyc1t0XXx8KHRoaXMuX19ldmVudExpc3RlbmVyc1t0XT1bXSksdGhpcy5fX2V2ZW50TGlzdGVuZXJzW3RdLnB1c2goZSk7cmV0dXJuIHRoaXN9ZnVuY3Rpb24gaShlLGkpe2lmKHRoaXMuX19ldmVudExpc3RlbmVycyl7aWYoMD09PWFyZ3VtZW50cy5sZW5ndGgpdGhpcy5fX2V2ZW50TGlzdGVuZXJzPXt9O2Vsc2UgaWYoMT09PWFyZ3VtZW50cy5sZW5ndGgmJlwib2JqZWN0XCI9PXR5cGVvZiBhcmd1bWVudHNbMF0pZm9yKHZhciByIGluIGUpdC5jYWxsKHRoaXMscixlW3JdKTtlbHNlIHQuY2FsbCh0aGlzLGUsaSk7cmV0dXJuIHRoaXN9fWZ1bmN0aW9uIHIodCxlKXtpZih0aGlzLl9fZXZlbnRMaXN0ZW5lcnMpe3ZhciBpPXRoaXMuX19ldmVudExpc3RlbmVyc1t0XTtpZihpKXtmb3IodmFyIHI9MCxzPWkubGVuZ3RoO3M+cjtyKyspaVtyXS5jYWxsKHRoaXMsZXx8e30pO3JldHVybiB0aGlzfX19ZmFicmljLk9ic2VydmFibGU9e29ic2VydmU6ZSxzdG9wT2JzZXJ2aW5nOmksZmlyZTpyLG9uOmUsb2ZmOmksdHJpZ2dlcjpyfX0oKSxmYWJyaWMuQ29sbGVjdGlvbj17YWRkOmZ1bmN0aW9uKCl7dGhpcy5fb2JqZWN0cy5wdXNoLmFwcGx5KHRoaXMuX29iamVjdHMsYXJndW1lbnRzKTtmb3IodmFyIHQ9MCxlPWFyZ3VtZW50cy5sZW5ndGg7ZT50O3QrKyl0aGlzLl9vbk9iamVjdEFkZGVkKGFyZ3VtZW50c1t0XSk7cmV0dXJuIHRoaXMucmVuZGVyT25BZGRSZW1vdmUmJnRoaXMucmVuZGVyQWxsKCksdGhpc30saW5zZXJ0QXQ6ZnVuY3Rpb24odCxlLGkpe3ZhciByPXRoaXMuZ2V0T2JqZWN0cygpO3JldHVybiBpP3JbZV09dDpyLnNwbGljZShlLDAsdCksdGhpcy5fb25PYmplY3RBZGRlZCh0KSx0aGlzLnJlbmRlck9uQWRkUmVtb3ZlJiZ0aGlzLnJlbmRlckFsbCgpLHRoaXN9LHJlbW92ZTpmdW5jdGlvbigpe2Zvcih2YXIgdCxlPXRoaXMuZ2V0T2JqZWN0cygpLGk9MCxyPWFyZ3VtZW50cy5sZW5ndGg7cj5pO2krKyl0PWUuaW5kZXhPZihhcmd1bWVudHNbaV0pLC0xIT09dCYmKGUuc3BsaWNlKHQsMSksdGhpcy5fb25PYmplY3RSZW1vdmVkKGFyZ3VtZW50c1tpXSkpO3JldHVybiB0aGlzLnJlbmRlck9uQWRkUmVtb3ZlJiZ0aGlzLnJlbmRlckFsbCgpLHRoaXN9LGZvckVhY2hPYmplY3Q6ZnVuY3Rpb24odCxlKXtmb3IodmFyIGk9dGhpcy5nZXRPYmplY3RzKCkscj1pLmxlbmd0aDtyLS07KXQuY2FsbChlLGlbcl0scixpKTtyZXR1cm4gdGhpc30sZ2V0T2JqZWN0czpmdW5jdGlvbih0KXtyZXR1cm5cInVuZGVmaW5lZFwiPT10eXBlb2YgdD90aGlzLl9vYmplY3RzOnRoaXMuX29iamVjdHMuZmlsdGVyKGZ1bmN0aW9uKGUpe3JldHVybiBlLnR5cGU9PT10fSl9LGl0ZW06ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZ2V0T2JqZWN0cygpW3RdfSxpc0VtcHR5OmZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLmdldE9iamVjdHMoKS5sZW5ndGh9LHNpemU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRPYmplY3RzKCkubGVuZ3RofSxjb250YWluczpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5nZXRPYmplY3RzKCkuaW5kZXhPZih0KT4tMX0sY29tcGxleGl0eTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldE9iamVjdHMoKS5yZWR1Y2UoZnVuY3Rpb24odCxlKXtyZXR1cm4gdCs9ZS5jb21wbGV4aXR5P2UuY29tcGxleGl0eSgpOjB9LDApfX0sZnVuY3Rpb24odCl7dmFyIGU9TWF0aC5zcXJ0LGk9TWF0aC5hdGFuMixyPU1hdGguUEkvMTgwO2ZhYnJpYy51dGlsPXtyZW1vdmVGcm9tQXJyYXk6ZnVuY3Rpb24odCxlKXt2YXIgaT10LmluZGV4T2YoZSk7cmV0dXJuLTEhPT1pJiZ0LnNwbGljZShpLDEpLHR9LGdldFJhbmRvbUludDpmdW5jdGlvbih0LGUpe3JldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqKGUtdCsxKSkrdH0sZGVncmVlc1RvUmFkaWFuczpmdW5jdGlvbih0KXtyZXR1cm4gdCpyfSxyYWRpYW5zVG9EZWdyZWVzOmZ1bmN0aW9uKHQpe3JldHVybiB0L3J9LHJvdGF0ZVBvaW50OmZ1bmN0aW9uKHQsZSxpKXt2YXIgcj1NYXRoLnNpbihpKSxzPU1hdGguY29zKGkpO3Quc3VidHJhY3RFcXVhbHMoZSk7dmFyIG49dC54KnMtdC55KnIsbz10Lngqcit0LnkqcztyZXR1cm4gbmV3IGZhYnJpYy5Qb2ludChuLG8pLmFkZEVxdWFscyhlKX0sdHJhbnNmb3JtUG9pbnQ6ZnVuY3Rpb24odCxlLGkpe3JldHVybiBpP25ldyBmYWJyaWMuUG9pbnQoZVswXSp0LngrZVsyXSp0LnksZVsxXSp0LngrZVszXSp0LnkpOm5ldyBmYWJyaWMuUG9pbnQoZVswXSp0LngrZVsyXSp0LnkrZVs0XSxlWzFdKnQueCtlWzNdKnQueStlWzVdKX0saW52ZXJ0VHJhbnNmb3JtOmZ1bmN0aW9uKHQpe3ZhciBlPXQuc2xpY2UoKSxpPTEvKHRbMF0qdFszXS10WzFdKnRbMl0pO2U9W2kqdFszXSwtaSp0WzFdLC1pKnRbMl0saSp0WzBdLDAsMF07dmFyIHI9ZmFicmljLnV0aWwudHJhbnNmb3JtUG9pbnQoe3g6dFs0XSx5OnRbNV19LGUpO3JldHVybiBlWzRdPS1yLngsZVs1XT0tci55LGV9LHRvRml4ZWQ6ZnVuY3Rpb24odCxlKXtyZXR1cm4gcGFyc2VGbG9hdChOdW1iZXIodCkudG9GaXhlZChlKSl9LHBhcnNlVW5pdDpmdW5jdGlvbih0LGUpe3ZhciBpPS9cXER7MCwyfSQvLmV4ZWModCkscj1wYXJzZUZsb2F0KHQpO3N3aXRjaChlfHwoZT1mYWJyaWMuVGV4dC5ERUZBVUxUX1NWR19GT05UX1NJWkUpLGlbMF0pe2Nhc2VcIm1tXCI6cmV0dXJuIHIqZmFicmljLkRQSS8yNS40O2Nhc2VcImNtXCI6cmV0dXJuIHIqZmFicmljLkRQSS8yLjU0O2Nhc2VcImluXCI6cmV0dXJuIHIqZmFicmljLkRQSTtjYXNlXCJwdFwiOnJldHVybiByKmZhYnJpYy5EUEkvNzI7Y2FzZVwicGNcIjpyZXR1cm4gcipmYWJyaWMuRFBJLzcyKjEyO2Nhc2VcImVtXCI6cmV0dXJuIHIqZTtkZWZhdWx0OnJldHVybiByfX0sZmFsc2VGdW5jdGlvbjpmdW5jdGlvbigpe3JldHVybiExfSxnZXRLbGFzczpmdW5jdGlvbih0LGUpe3JldHVybiB0PWZhYnJpYy51dGlsLnN0cmluZy5jYW1lbGl6ZSh0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK3Quc2xpY2UoMSkpLGZhYnJpYy51dGlsLnJlc29sdmVOYW1lc3BhY2UoZSlbdF19LHJlc29sdmVOYW1lc3BhY2U6ZnVuY3Rpb24oZSl7aWYoIWUpcmV0dXJuIGZhYnJpYztmb3IodmFyIGk9ZS5zcGxpdChcIi5cIikscj1pLmxlbmd0aCxzPXR8fGZhYnJpYy53aW5kb3csbj0wO3I+bjsrK24pcz1zW2lbbl1dO3JldHVybiBzfSxsb2FkSW1hZ2U6ZnVuY3Rpb24odCxlLGkscil7aWYoIXQpcmV0dXJuIHZvaWQoZSYmZS5jYWxsKGksdCkpO3ZhciBzPWZhYnJpYy51dGlsLmNyZWF0ZUltYWdlKCk7cy5vbmxvYWQ9ZnVuY3Rpb24oKXtlJiZlLmNhbGwoaSxzKSxzPXMub25sb2FkPXMub25lcnJvcj1udWxsfSxzLm9uZXJyb3I9ZnVuY3Rpb24oKXtmYWJyaWMubG9nKFwiRXJyb3IgbG9hZGluZyBcIitzLnNyYyksZSYmZS5jYWxsKGksbnVsbCwhMCkscz1zLm9ubG9hZD1zLm9uZXJyb3I9bnVsbH0sMCE9PXQuaW5kZXhPZihcImRhdGFcIikmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiByJiYocy5jcm9zc09yaWdpbj1yKSxzLnNyYz10fSxlbmxpdmVuT2JqZWN0czpmdW5jdGlvbih0LGUsaSxyKXtmdW5jdGlvbiBzKCl7KytvPT09YSYmZSYmZShuKX10PXR8fFtdO3ZhciBuPVtdLG89MCxhPXQubGVuZ3RoO3JldHVybiBhP3ZvaWQgdC5mb3JFYWNoKGZ1bmN0aW9uKHQsZSl7aWYoIXR8fCF0LnR5cGUpcmV0dXJuIHZvaWQgcygpO3ZhciBvPWZhYnJpYy51dGlsLmdldEtsYXNzKHQudHlwZSxpKTtvLmFzeW5jP28uZnJvbU9iamVjdCh0LGZ1bmN0aW9uKGksbyl7b3x8KG5bZV09aSxyJiZyKHQsbltlXSkpLHMoKX0pOihuW2VdPW8uZnJvbU9iamVjdCh0KSxyJiZyKHQsbltlXSkscygpKX0pOnZvaWQoZSYmZShuKSl9LGdyb3VwU1ZHRWxlbWVudHM6ZnVuY3Rpb24odCxlLGkpe3ZhciByO3JldHVybiByPW5ldyBmYWJyaWMuUGF0aEdyb3VwKHQsZSksXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGkmJnIuc2V0U291cmNlUGF0aChpKSxyfSxwb3B1bGF0ZVdpdGhQcm9wZXJ0aWVzOmZ1bmN0aW9uKHQsZSxpKXtpZihpJiZcIltvYmplY3QgQXJyYXldXCI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaSkpZm9yKHZhciByPTAscz1pLmxlbmd0aDtzPnI7cisrKWlbcl1pbiB0JiYoZVtpW3JdXT10W2lbcl1dKX0sZHJhd0Rhc2hlZExpbmU6ZnVuY3Rpb24odCxyLHMsbixvLGEpe3ZhciBoPW4tcixjPW8tcyxsPWUoaCpoK2MqYyksdT1pKGMsaCksZj1hLmxlbmd0aCxkPTAsZz0hMDtmb3IodC5zYXZlKCksdC50cmFuc2xhdGUocixzKSx0Lm1vdmVUbygwLDApLHQucm90YXRlKHUpLHI9MDtsPnI7KXIrPWFbZCsrJWZdLHI+bCYmKHI9bCksdFtnP1wibGluZVRvXCI6XCJtb3ZlVG9cIl0ociwwKSxnPSFnO3QucmVzdG9yZSgpfSxjcmVhdGVDYW52YXNFbGVtZW50OmZ1bmN0aW9uKHQpe3JldHVybiB0fHwodD1mYWJyaWMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKSksdC5nZXRDb250ZXh0fHxcInVuZGVmaW5lZFwiPT10eXBlb2YgR192bWxDYW52YXNNYW5hZ2VyfHxHX3ZtbENhbnZhc01hbmFnZXIuaW5pdEVsZW1lbnQodCksdH0sY3JlYXRlSW1hZ2U6ZnVuY3Rpb24oKXtyZXR1cm4gZmFicmljLmlzTGlrZWx5Tm9kZT9uZXcocmVxdWlyZShcImNhbnZhc1wiKS5JbWFnZSk6ZmFicmljLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbWdcIil9LGNyZWF0ZUFjY2Vzc29yczpmdW5jdGlvbih0KXtmb3IodmFyIGU9dC5wcm90b3R5cGUsaT1lLnN0YXRlUHJvcGVydGllcy5sZW5ndGg7aS0tOyl7dmFyIHI9ZS5zdGF0ZVByb3BlcnRpZXNbaV0scz1yLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK3Iuc2xpY2UoMSksbj1cInNldFwiK3Msbz1cImdldFwiK3M7ZVtvXXx8KGVbb109ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBGdW5jdGlvbigncmV0dXJuIHRoaXMuZ2V0KFwiJyt0KydcIiknKX0ocikpLGVbbl18fChlW25dPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgRnVuY3Rpb24oXCJ2YWx1ZVwiLCdyZXR1cm4gdGhpcy5zZXQoXCInK3QrJ1wiLCB2YWx1ZSknKX0ocikpfX0sY2xpcENvbnRleHQ6ZnVuY3Rpb24odCxlKXtlLnNhdmUoKSxlLmJlZ2luUGF0aCgpLHQuY2xpcFRvKGUpLGUuY2xpcCgpfSxtdWx0aXBseVRyYW5zZm9ybU1hdHJpY2VzOmZ1bmN0aW9uKHQsZSl7cmV0dXJuW3RbMF0qZVswXSt0WzJdKmVbMV0sdFsxXSplWzBdK3RbM10qZVsxXSx0WzBdKmVbMl0rdFsyXSplWzNdLHRbMV0qZVsyXSt0WzNdKmVbM10sdFswXSplWzRdK3RbMl0qZVs1XSt0WzRdLHRbMV0qZVs0XSt0WzNdKmVbNV0rdFs1XV19LGdldEZ1bmN0aW9uQm9keTpmdW5jdGlvbih0KXtyZXR1cm4oU3RyaW5nKHQpLm1hdGNoKC9mdW5jdGlvbltee10qXFx7KFtcXHNcXFNdKilcXH0vKXx8e30pWzFdfSxpc1RyYW5zcGFyZW50OmZ1bmN0aW9uKHQsZSxpLHIpe3I+MCYmKGU+cj9lLT1yOmU9MCxpPnI/aS09cjppPTApO2Zvcih2YXIgcz0hMCxuPXQuZ2V0SW1hZ2VEYXRhKGUsaSwyKnJ8fDEsMipyfHwxKSxvPTMsYT1uLmRhdGEubGVuZ3RoO2E+bztvKz00KXt2YXIgaD1uLmRhdGFbb107aWYocz0wPj1oLHM9PT0hMSlicmVha31yZXR1cm4gbj1udWxsLHN9fX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxyLG4sbyxoLGMsbCl7dmFyIHU9YS5jYWxsKGFyZ3VtZW50cyk7aWYoc1t1XSlyZXR1cm4gc1t1XTt2YXIgZj1NYXRoLlBJLGQ9bCpmLzE4MCxnPU1hdGguc2luKGQpLHA9TWF0aC5jb3MoZCksdj0wLGI9MDtuPU1hdGguYWJzKG4pLG89TWF0aC5hYnMobyk7dmFyIG09LXAqdCouNS1nKnIqLjUseT0tcCpyKi41K2cqdCouNSxfPW4qbix4PW8qbyxDPXkqeSxTPW0qbSx3PV8qeC1fKkMteCpTLE89MDtpZigwPncpe3ZhciBUPU1hdGguc3FydCgxLXcvKF8qeCkpO24qPVQsbyo9VH1lbHNlIE89KGg9PT1jPy0xOjEpKk1hdGguc3FydCh3LyhfKkMreCpTKSk7dmFyIGs9TypuKnkvbyxqPS1PKm8qbS9uLEE9cCprLWcqaisuNSp0LFA9ZyprK3AqaisuNSpyLEU9aSgxLDAsKG0taykvbiwoeS1qKS9vKSxNPWkoKG0taykvbiwoeS1qKS9vLCgtbS1rKS9uLCgteS1qKS9vKTswPT09YyYmTT4wP00tPTIqZjoxPT09YyYmMD5NJiYoTSs9MipmKTtmb3IodmFyIEk9TWF0aC5jZWlsKE1hdGguYWJzKE0vZioyKSksRD1bXSxMPU0vSSxGPTgvMypNYXRoLnNpbihMLzQpKk1hdGguc2luKEwvNCkvTWF0aC5zaW4oTC8yKSxSPUUrTCxCPTA7ST5CO0IrKylEW0JdPWUoRSxSLHAsZyxuLG8sQSxQLEYsdixiKSx2PURbQl1bNF0sYj1EW0JdWzVdLEU9UixSKz1MO3JldHVybiBzW3VdPUQsRH1mdW5jdGlvbiBlKHQsZSxpLHIscyxvLGgsYyxsLHUsZil7dmFyIGQ9YS5jYWxsKGFyZ3VtZW50cyk7aWYobltkXSlyZXR1cm4gbltkXTt2YXIgZz1NYXRoLmNvcyh0KSxwPU1hdGguc2luKHQpLHY9TWF0aC5jb3MoZSksYj1NYXRoLnNpbihlKSxtPWkqcyp2LXIqbypiK2gseT1yKnMqditpKm8qYitjLF89dStsKigtaSpzKnAtcipvKmcpLHg9ZitsKigtcipzKnAraSpvKmcpLEM9bStsKihpKnMqYityKm8qdiksUz15K2wqKHIqcypiLWkqbyp2KTtyZXR1cm4gbltkXT1bXyx4LEMsUyxtLHldLG5bZF19ZnVuY3Rpb24gaSh0LGUsaSxyKXt2YXIgcz1NYXRoLmF0YW4yKGUsdCksbj1NYXRoLmF0YW4yKHIsaSk7cmV0dXJuIG4+PXM/bi1zOjIqTWF0aC5QSS0ocy1uKX1mdW5jdGlvbiByKHQsZSxpLHIscyxuLGgsYyl7dmFyIGw9YS5jYWxsKGFyZ3VtZW50cyk7aWYob1tsXSlyZXR1cm4gb1tsXTt2YXIgdSxmLGQsZyxwLHYsYixtLHk9TWF0aC5zcXJ0LF89TWF0aC5taW4seD1NYXRoLm1heCxDPU1hdGguYWJzLFM9W10sdz1bW10sW11dO2Y9Nip0LTEyKmkrNipzLHU9LTMqdCs5KmktOSpzKzMqaCxkPTMqaS0zKnQ7Zm9yKHZhciBPPTA7Mj5POysrTylpZihPPjAmJihmPTYqZS0xMipyKzYqbix1PS0zKmUrOSpyLTkqbiszKmMsZD0zKnItMyplKSxDKHUpPDFlLTEyKXtpZihDKGYpPDFlLTEyKWNvbnRpbnVlO2c9LWQvZixnPjAmJjE+ZyYmUy5wdXNoKGcpfWVsc2UgYj1mKmYtNCpkKnUsMD5ifHwobT15KGIpLHA9KC1mK20pLygyKnUpLHA+MCYmMT5wJiZTLnB1c2gocCksdj0oLWYtbSkvKDIqdSksdj4wJiYxPnYmJlMucHVzaCh2KSk7Zm9yKHZhciBULGssaixBPVMubGVuZ3RoLFA9QTtBLS07KWc9U1tBXSxqPTEtZyxUPWoqaipqKnQrMypqKmoqZyppKzMqaipnKmcqcytnKmcqZypoLHdbMF1bQV09VCxrPWoqaipqKmUrMypqKmoqZypyKzMqaipnKmcqbitnKmcqZypjLHdbMV1bQV09azt3WzBdW1BdPXQsd1sxXVtQXT1lLHdbMF1bUCsxXT1oLHdbMV1bUCsxXT1jO3ZhciBFPVt7eDpfLmFwcGx5KG51bGwsd1swXSkseTpfLmFwcGx5KG51bGwsd1sxXSl9LHt4OnguYXBwbHkobnVsbCx3WzBdKSx5OnguYXBwbHkobnVsbCx3WzFdKX1dO3JldHVybiBvW2xdPUUsRX12YXIgcz17fSxuPXt9LG89e30sYT1BcnJheS5wcm90b3R5cGUuam9pbjtmYWJyaWMudXRpbC5kcmF3QXJjPWZ1bmN0aW9uKGUsaSxyLHMpe2Zvcih2YXIgbj1zWzBdLG89c1sxXSxhPXNbMl0saD1zWzNdLGM9c1s0XSxsPXNbNV0sdT1zWzZdLGY9W1tdLFtdLFtdLFtdXSxkPXQobC1pLHUtcixuLG8saCxjLGEpLGc9MCxwPWQubGVuZ3RoO3A+ZztnKyspZltnXVswXT1kW2ddWzBdK2ksZltnXVsxXT1kW2ddWzFdK3IsZltnXVsyXT1kW2ddWzJdK2ksZltnXVszXT1kW2ddWzNdK3IsZltnXVs0XT1kW2ddWzRdK2ksZltnXVs1XT1kW2ddWzVdK3IsZS5iZXppZXJDdXJ2ZVRvLmFwcGx5KGUsZltnXSl9LGZhYnJpYy51dGlsLmdldEJvdW5kc09mQXJjPWZ1bmN0aW9uKGUsaSxzLG4sbyxhLGgsYyxsKXtmb3IodmFyIHU9MCxmPTAsZD1bXSxnPVtdLHA9dChjLWUsbC1pLHMsbixhLGgsbyksdj1bW10sW11dLGI9MCxtPXAubGVuZ3RoO20+YjtiKyspZD1yKHUsZixwW2JdWzBdLHBbYl1bMV0scFtiXVsyXSxwW2JdWzNdLHBbYl1bNF0scFtiXVs1XSksdlswXS54PWRbMF0ueCtlLHZbMF0ueT1kWzBdLnkraSx2WzFdLng9ZFsxXS54K2UsdlsxXS55PWRbMV0ueStpLGcucHVzaCh2WzBdKSxnLnB1c2godlsxXSksdT1wW2JdWzRdLGY9cFtiXVs1XTtyZXR1cm4gZ30sZmFicmljLnV0aWwuZ2V0Qm91bmRzT2ZDdXJ2ZT1yfSgpLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe2Zvcih2YXIgaT1zLmNhbGwoYXJndW1lbnRzLDIpLHI9W10sbj0wLG89dC5sZW5ndGg7bz5uO24rKylyW25dPWkubGVuZ3RoP3Rbbl1bZV0uYXBwbHkodFtuXSxpKTp0W25dW2VdLmNhbGwodFtuXSk7cmV0dXJuIHJ9ZnVuY3Rpb24gZSh0LGUpe3JldHVybiByKHQsZSxmdW5jdGlvbih0LGUpe3JldHVybiB0Pj1lfSl9ZnVuY3Rpb24gaSh0LGUpe3JldHVybiByKHQsZSxmdW5jdGlvbih0LGUpe3JldHVybiBlPnR9KX1mdW5jdGlvbiByKHQsZSxpKXtpZih0JiYwIT09dC5sZW5ndGgpe3ZhciByPXQubGVuZ3RoLTEscz1lP3Rbcl1bZV06dFtyXTtpZihlKWZvcig7ci0tOylpKHRbcl1bZV0scykmJihzPXRbcl1bZV0pO2Vsc2UgZm9yKDtyLS07KWkodFtyXSxzKSYmKHM9dFtyXSk7cmV0dXJuIHN9fXZhciBzPUFycmF5LnByb3RvdHlwZS5zbGljZTtBcnJheS5wcm90b3R5cGUuaW5kZXhPZnx8KEFycmF5LnByb3RvdHlwZS5pbmRleE9mPWZ1bmN0aW9uKHQpe2lmKHZvaWQgMD09PXRoaXN8fG51bGw9PT10aGlzKXRocm93IG5ldyBUeXBlRXJyb3I7dmFyIGU9T2JqZWN0KHRoaXMpLGk9ZS5sZW5ndGg+Pj4wO2lmKDA9PT1pKXJldHVybi0xO3ZhciByPTA7aWYoYXJndW1lbnRzLmxlbmd0aD4wJiYocj1OdW1iZXIoYXJndW1lbnRzWzFdKSxyIT09cj9yPTA6MCE9PXImJnIhPT1OdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkmJnIhPT1OdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFkmJihyPShyPjB8fC0xKSpNYXRoLmZsb29yKE1hdGguYWJzKHIpKSkpLHI+PWkpcmV0dXJuLTE7Zm9yKHZhciBzPXI+PTA/cjpNYXRoLm1heChpLU1hdGguYWJzKHIpLDApO2k+cztzKyspaWYocyBpbiBlJiZlW3NdPT09dClyZXR1cm4gcztyZXR1cm4tMX0pLEFycmF5LnByb3RvdHlwZS5mb3JFYWNofHwoQXJyYXkucHJvdG90eXBlLmZvckVhY2g9ZnVuY3Rpb24odCxlKXtmb3IodmFyIGk9MCxyPXRoaXMubGVuZ3RoPj4+MDtyPmk7aSsrKWkgaW4gdGhpcyYmdC5jYWxsKGUsdGhpc1tpXSxpLHRoaXMpfSksQXJyYXkucHJvdG90eXBlLm1hcHx8KEFycmF5LnByb3RvdHlwZS5tYXA9ZnVuY3Rpb24odCxlKXtmb3IodmFyIGk9W10scj0wLHM9dGhpcy5sZW5ndGg+Pj4wO3M+cjtyKyspciBpbiB0aGlzJiYoaVtyXT10LmNhbGwoZSx0aGlzW3JdLHIsdGhpcykpO3JldHVybiBpfSksQXJyYXkucHJvdG90eXBlLmV2ZXJ5fHwoQXJyYXkucHJvdG90eXBlLmV2ZXJ5PWZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpPTAscj10aGlzLmxlbmd0aD4+PjA7cj5pO2krKylpZihpIGluIHRoaXMmJiF0LmNhbGwoZSx0aGlzW2ldLGksdGhpcykpcmV0dXJuITE7cmV0dXJuITB9KSxBcnJheS5wcm90b3R5cGUuc29tZXx8KEFycmF5LnByb3RvdHlwZS5zb21lPWZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpPTAscj10aGlzLmxlbmd0aD4+PjA7cj5pO2krKylpZihpIGluIHRoaXMmJnQuY2FsbChlLHRoaXNbaV0saSx0aGlzKSlyZXR1cm4hMDtyZXR1cm4hMX0pLEFycmF5LnByb3RvdHlwZS5maWx0ZXJ8fChBcnJheS5wcm90b3R5cGUuZmlsdGVyPWZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpLHI9W10scz0wLG49dGhpcy5sZW5ndGg+Pj4wO24+cztzKyspcyBpbiB0aGlzJiYoaT10aGlzW3NdLHQuY2FsbChlLGkscyx0aGlzKSYmci5wdXNoKGkpKTtyZXR1cm4gcn0pLEFycmF5LnByb3RvdHlwZS5yZWR1Y2V8fChBcnJheS5wcm90b3R5cGUucmVkdWNlPWZ1bmN0aW9uKHQpe3ZhciBlLGk9dGhpcy5sZW5ndGg+Pj4wLHI9MDtpZihhcmd1bWVudHMubGVuZ3RoPjEpZT1hcmd1bWVudHNbMV07ZWxzZSBmb3IoOzspe2lmKHIgaW4gdGhpcyl7ZT10aGlzW3IrK107YnJlYWt9aWYoKytyPj1pKXRocm93IG5ldyBUeXBlRXJyb3J9Zm9yKDtpPnI7cisrKXIgaW4gdGhpcyYmKGU9dC5jYWxsKG51bGwsZSx0aGlzW3JdLHIsdGhpcykpO3JldHVybiBlfSksZmFicmljLnV0aWwuYXJyYXk9e2ludm9rZTp0LG1pbjppLG1heDplfX0oKSxmdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxlKXtmb3IodmFyIGkgaW4gZSl0W2ldPWVbaV07cmV0dXJuIHR9ZnVuY3Rpb24gZShlKXtyZXR1cm4gdCh7fSxlKX1mYWJyaWMudXRpbC5vYmplY3Q9e2V4dGVuZDp0LGNsb25lOmV9fSgpLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXtyZXR1cm4gdC5yZXBsYWNlKC8tKyguKT8vZyxmdW5jdGlvbih0LGUpe3JldHVybiBlP2UudG9VcHBlckNhc2UoKTpcIlwifSl9ZnVuY3Rpb24gZSh0LGUpe3JldHVybiB0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpKyhlP3Quc2xpY2UoMSk6dC5zbGljZSgxKS50b0xvd2VyQ2FzZSgpKX1mdW5jdGlvbiBpKHQpe3JldHVybiB0LnJlcGxhY2UoLyYvZyxcIiZhbXA7XCIpLnJlcGxhY2UoL1wiL2csXCImcXVvdDtcIikucmVwbGFjZSgvJy9nLFwiJmFwb3M7XCIpLnJlcGxhY2UoLzwvZyxcIiZsdDtcIikucmVwbGFjZSgvPi9nLFwiJmd0O1wiKX1TdHJpbmcucHJvdG90eXBlLnRyaW18fChTdHJpbmcucHJvdG90eXBlLnRyaW09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXBsYWNlKC9eW1xcc1xceEEwXSsvLFwiXCIpLnJlcGxhY2UoL1tcXHNcXHhBMF0rJC8sXCJcIil9KSxmYWJyaWMudXRpbC5zdHJpbmc9e2NhbWVsaXplOnQsY2FwaXRhbGl6ZTplLGVzY2FwZVhtbDppfX0oKSxmdW5jdGlvbigpe3ZhciB0PUFycmF5LnByb3RvdHlwZS5zbGljZSxlPUZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseSxpPWZ1bmN0aW9uKCl7fTtGdW5jdGlvbi5wcm90b3R5cGUuYmluZHx8KEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kPWZ1bmN0aW9uKHIpe3ZhciBzLG49dGhpcyxvPXQuY2FsbChhcmd1bWVudHMsMSk7cmV0dXJuIHM9by5sZW5ndGg/ZnVuY3Rpb24oKXtyZXR1cm4gZS5jYWxsKG4sdGhpcyBpbnN0YW5jZW9mIGk/dGhpczpyLG8uY29uY2F0KHQuY2FsbChhcmd1bWVudHMpKSl9OmZ1bmN0aW9uKCl7cmV0dXJuIGUuY2FsbChuLHRoaXMgaW5zdGFuY2VvZiBpP3RoaXM6cixhcmd1bWVudHMpfSxpLnByb3RvdHlwZT10aGlzLnByb3RvdHlwZSxzLnByb3RvdHlwZT1uZXcgaSxzfSl9KCksZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7fWZ1bmN0aW9uIGUodCl7dmFyIGU9dGhpcy5jb25zdHJ1Y3Rvci5zdXBlcmNsYXNzLnByb3RvdHlwZVt0XTtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD4xP2UuYXBwbHkodGhpcyxyLmNhbGwoYXJndW1lbnRzLDEpKTplLmNhbGwodGhpcyl9ZnVuY3Rpb24gaSgpe2Z1bmN0aW9uIGkoKXt0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpfXZhciBuPW51bGwsYT1yLmNhbGwoYXJndW1lbnRzLDApO1wiZnVuY3Rpb25cIj09dHlwZW9mIGFbMF0mJihuPWEuc2hpZnQoKSksaS5zdXBlcmNsYXNzPW4saS5zdWJjbGFzc2VzPVtdLG4mJih0LnByb3RvdHlwZT1uLnByb3RvdHlwZSxpLnByb3RvdHlwZT1uZXcgdCxuLnN1YmNsYXNzZXMucHVzaChpKSk7Zm9yKHZhciBoPTAsYz1hLmxlbmd0aDtjPmg7aCsrKW8oaSxhW2hdLG4pO3JldHVybiBpLnByb3RvdHlwZS5pbml0aWFsaXplfHwoaS5wcm90b3R5cGUuaW5pdGlhbGl6ZT1zKSxpLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1pLGkucHJvdG90eXBlLmNhbGxTdXBlcj1lLGl9dmFyIHI9QXJyYXkucHJvdG90eXBlLnNsaWNlLHM9ZnVuY3Rpb24oKXt9LG49ZnVuY3Rpb24oKXtmb3IodmFyIHQgaW57dG9TdHJpbmc6MX0paWYoXCJ0b1N0cmluZ1wiPT09dClyZXR1cm4hMTtyZXR1cm4hMH0oKSxvPWZ1bmN0aW9uKHQsZSxpKXtmb3IodmFyIHIgaW4gZSlyIGluIHQucHJvdG90eXBlJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiB0LnByb3RvdHlwZVtyXSYmKGVbcl0rXCJcIikuaW5kZXhPZihcImNhbGxTdXBlclwiKT4tMT90LnByb3RvdHlwZVtyXT1mdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgcj10aGlzLmNvbnN0cnVjdG9yLnN1cGVyY2xhc3M7dGhpcy5jb25zdHJ1Y3Rvci5zdXBlcmNsYXNzPWk7dmFyIHM9ZVt0XS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIHRoaXMuY29uc3RydWN0b3Iuc3VwZXJjbGFzcz1yLFwiaW5pdGlhbGl6ZVwiIT09dD9zOnZvaWQgMH19KHIpOnQucHJvdG90eXBlW3JdPWVbcl0sbiYmKGUudG9TdHJpbmchPT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nJiYodC5wcm90b3R5cGUudG9TdHJpbmc9ZS50b1N0cmluZyksZS52YWx1ZU9mIT09T2JqZWN0LnByb3RvdHlwZS52YWx1ZU9mJiYodC5wcm90b3R5cGUudmFsdWVPZj1lLnZhbHVlT2YpKX07ZmFicmljLnV0aWwuY3JlYXRlQ2xhc3M9aX0oKSxmdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dmFyIGUsaSxyPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSxzPXIubGVuZ3RoO2ZvcihpPTA7cz5pO2krKylpZihlPXR5cGVvZiB0W3JbaV1dLCEvXig/OmZ1bmN0aW9ufG9iamVjdHx1bmtub3duKSQvLnRlc3QoZSkpcmV0dXJuITE7cmV0dXJuITB9ZnVuY3Rpb24gZSh0LGUpe3JldHVybntoYW5kbGVyOmUsd3JhcHBlZEhhbmRsZXI6aSh0LGUpfX1mdW5jdGlvbiBpKHQsZSl7cmV0dXJuIGZ1bmN0aW9uKGkpe2UuY2FsbChvKHQpLGl8fGZhYnJpYy53aW5kb3cuZXZlbnQpfX1mdW5jdGlvbiByKHQsZSl7cmV0dXJuIGZ1bmN0aW9uKGkpe2lmKHBbdF0mJnBbdF1bZV0pZm9yKHZhciByPXBbdF1bZV0scz0wLG49ci5sZW5ndGg7bj5zO3MrKylyW3NdLmNhbGwodGhpcyxpfHxmYWJyaWMud2luZG93LmV2ZW50KX19ZnVuY3Rpb24gcyh0LGUpe3R8fCh0PWZhYnJpYy53aW5kb3cuZXZlbnQpO3ZhciBpPXQudGFyZ2V0fHwodHlwZW9mIHQuc3JjRWxlbWVudCE9PWg/dC5zcmNFbGVtZW50Om51bGwpLHI9ZmFicmljLnV0aWwuZ2V0U2Nyb2xsTGVmdFRvcChpLGUpO3JldHVybnt4OnYodCkrci5sZWZ0LHk6Yih0KStyLnRvcH19ZnVuY3Rpb24gbih0LGUsaSl7dmFyIHI9XCJ0b3VjaGVuZFwiPT09dC50eXBlP1wiY2hhbmdlZFRvdWNoZXNcIjpcInRvdWNoZXNcIjtyZXR1cm4gdFtyXSYmdFtyXVswXT90W3JdWzBdW2VdLSh0W3JdWzBdW2VdLXRbcl1bMF1baV0pfHx0W2ldOnRbaV19dmFyIG8sYSxoPVwidW5rbm93blwiLGM9ZnVuY3Rpb24oKXt2YXIgdD0wO3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gZS5fX3VuaXF1ZUlEfHwoZS5fX3VuaXF1ZUlEPVwidW5pcXVlSURfX1wiK3QrKyl9fSgpOyFmdW5jdGlvbigpe3ZhciB0PXt9O289ZnVuY3Rpb24oZSl7cmV0dXJuIHRbZV19LGE9ZnVuY3Rpb24oZSxpKXt0W2VdPWl9fSgpO3ZhciBsLHUsZj10KGZhYnJpYy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsXCJhZGRFdmVudExpc3RlbmVyXCIsXCJyZW1vdmVFdmVudExpc3RlbmVyXCIpJiZ0KGZhYnJpYy53aW5kb3csXCJhZGRFdmVudExpc3RlbmVyXCIsXCJyZW1vdmVFdmVudExpc3RlbmVyXCIpLGQ9dChmYWJyaWMuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LFwiYXR0YWNoRXZlbnRcIixcImRldGFjaEV2ZW50XCIpJiZ0KGZhYnJpYy53aW5kb3csXCJhdHRhY2hFdmVudFwiLFwiZGV0YWNoRXZlbnRcIiksZz17fSxwPXt9O2Y/KGw9ZnVuY3Rpb24odCxlLGkpe3QuYWRkRXZlbnRMaXN0ZW5lcihlLGksITEpfSx1PWZ1bmN0aW9uKHQsZSxpKXt0LnJlbW92ZUV2ZW50TGlzdGVuZXIoZSxpLCExKX0pOmQ/KGw9ZnVuY3Rpb24odCxpLHIpe3ZhciBzPWModCk7YShzLHQpLGdbc118fChnW3NdPXt9KSxnW3NdW2ldfHwoZ1tzXVtpXT1bXSk7dmFyIG49ZShzLHIpO2dbc11baV0ucHVzaChuKSx0LmF0dGFjaEV2ZW50KFwib25cIitpLG4ud3JhcHBlZEhhbmRsZXIpfSx1PWZ1bmN0aW9uKHQsZSxpKXt2YXIgcixzPWModCk7aWYoZ1tzXSYmZ1tzXVtlXSlmb3IodmFyIG49MCxvPWdbc11bZV0ubGVuZ3RoO28+bjtuKyspcj1nW3NdW2VdW25dLHImJnIuaGFuZGxlcj09PWkmJih0LmRldGFjaEV2ZW50KFwib25cIitlLHIud3JhcHBlZEhhbmRsZXIpLGdbc11bZV1bbl09bnVsbCl9KToobD1mdW5jdGlvbih0LGUsaSl7dmFyIHM9Yyh0KTtpZihwW3NdfHwocFtzXT17fSksIXBbc11bZV0pe3Bbc11bZV09W107dmFyIG49dFtcIm9uXCIrZV07biYmcFtzXVtlXS5wdXNoKG4pLHRbXCJvblwiK2VdPXIocyxlKX1wW3NdW2VdLnB1c2goaSl9LHU9ZnVuY3Rpb24odCxlLGkpe3ZhciByPWModCk7aWYocFtyXSYmcFtyXVtlXSlmb3IodmFyIHM9cFtyXVtlXSxuPTAsbz1zLmxlbmd0aDtvPm47bisrKXNbbl09PT1pJiZzLnNwbGljZShuLDEpfSksZmFicmljLnV0aWwuYWRkTGlzdGVuZXI9bCxmYWJyaWMudXRpbC5yZW1vdmVMaXN0ZW5lcj11O3ZhciB2PWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdC5jbGllbnRYIT09aD90LmNsaWVudFg6MH0sYj1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQuY2xpZW50WSE9PWg/dC5jbGllbnRZOjB9O2ZhYnJpYy5pc1RvdWNoU3VwcG9ydGVkJiYodj1mdW5jdGlvbih0KXtyZXR1cm4gbih0LFwicGFnZVhcIixcImNsaWVudFhcIil9LGI9ZnVuY3Rpb24odCl7cmV0dXJuIG4odCxcInBhZ2VZXCIsXCJjbGllbnRZXCIpfSksZmFicmljLnV0aWwuZ2V0UG9pbnRlcj1zLGZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQoZmFicmljLnV0aWwsZmFicmljLk9ic2VydmFibGUpfSgpLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3ZhciBpPXQuc3R5bGU7aWYoIWkpcmV0dXJuIHQ7aWYoXCJzdHJpbmdcIj09dHlwZW9mIGUpcmV0dXJuIHQuc3R5bGUuY3NzVGV4dCs9XCI7XCIrZSxlLmluZGV4T2YoXCJvcGFjaXR5XCIpPi0xP24odCxlLm1hdGNoKC9vcGFjaXR5OlxccyooXFxkP1xcLj9cXGQqKS8pWzFdKTp0O2Zvcih2YXIgciBpbiBlKWlmKFwib3BhY2l0eVwiPT09ciluKHQsZVtyXSk7ZWxzZXt2YXIgcz1cImZsb2F0XCI9PT1yfHxcImNzc0Zsb2F0XCI9PT1yP1widW5kZWZpbmVkXCI9PXR5cGVvZiBpLnN0eWxlRmxvYXQ/XCJjc3NGbG9hdFwiOlwic3R5bGVGbG9hdFwiOnI7aVtzXT1lW3JdfXJldHVybiB0fXZhciBlPWZhYnJpYy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLGk9XCJzdHJpbmdcIj09dHlwZW9mIGUuc3R5bGUub3BhY2l0eSxyPVwic3RyaW5nXCI9PXR5cGVvZiBlLnN0eWxlLmZpbHRlcixzPS9hbHBoYVxccypcXChcXHMqb3BhY2l0eVxccyo9XFxzKihbXlxcKV0rKVxcKS8sbj1mdW5jdGlvbih0KXtyZXR1cm4gdH07aT9uPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQuc3R5bGUub3BhY2l0eT1lLHR9OnImJihuPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dC5zdHlsZTtyZXR1cm4gdC5jdXJyZW50U3R5bGUmJiF0LmN1cnJlbnRTdHlsZS5oYXNMYXlvdXQmJihpLnpvb209MSkscy50ZXN0KGkuZmlsdGVyKT8oZT1lPj0uOTk5OT9cIlwiOlwiYWxwaGEob3BhY2l0eT1cIisxMDAqZStcIilcIixpLmZpbHRlcj1pLmZpbHRlci5yZXBsYWNlKHMsZSkpOmkuZmlsdGVyKz1cIiBhbHBoYShvcGFjaXR5PVwiKzEwMCplK1wiKVwiLHR9KSxmYWJyaWMudXRpbC5zZXRTdHlsZT10fSgpLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXtyZXR1cm5cInN0cmluZ1wiPT10eXBlb2YgdD9mYWJyaWMuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodCk6dH1mdW5jdGlvbiBlKHQsZSl7dmFyIGk9ZmFicmljLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodCk7Zm9yKHZhciByIGluIGUpXCJjbGFzc1wiPT09cj9pLmNsYXNzTmFtZT1lW3JdOlwiZm9yXCI9PT1yP2kuaHRtbEZvcj1lW3JdOmkuc2V0QXR0cmlidXRlKHIsZVtyXSk7cmV0dXJuIGl9ZnVuY3Rpb24gaSh0LGUpe3QmJi0xPT09KFwiIFwiK3QuY2xhc3NOYW1lK1wiIFwiKS5pbmRleE9mKFwiIFwiK2UrXCIgXCIpJiYodC5jbGFzc05hbWUrPSh0LmNsYXNzTmFtZT9cIiBcIjpcIlwiKStlKX1mdW5jdGlvbiByKHQsaSxyKXtyZXR1cm5cInN0cmluZ1wiPT10eXBlb2YgaSYmKGk9ZShpLHIpKSx0LnBhcmVudE5vZGUmJnQucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQoaSx0KSxpLmFwcGVuZENoaWxkKHQpLGl9ZnVuY3Rpb24gcyh0LGUpe3ZhciBpLHIscz0wLG49MCxvPWZhYnJpYy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsYT1mYWJyaWMuZG9jdW1lbnQuYm9keXx8e3Njcm9sbExlZnQ6MCxzY3JvbGxUb3A6MH07Zm9yKHI9dDt0JiZ0LnBhcmVudE5vZGUmJiFpOyl0PXQucGFyZW50Tm9kZSwxPT09dC5ub2RlVHlwZSYmXCJmaXhlZFwiPT09ZmFicmljLnV0aWwuZ2V0RWxlbWVudFN0eWxlKHQsXCJwb3NpdGlvblwiKSYmKGk9dCksMT09PXQubm9kZVR5cGUmJnIhPT1lJiZcImFic29sdXRlXCI9PT1mYWJyaWMudXRpbC5nZXRFbGVtZW50U3R5bGUodCxcInBvc2l0aW9uXCIpPyhzPTAsbj0wKTp0PT09ZmFicmljLmRvY3VtZW50PyhzPWEuc2Nyb2xsTGVmdHx8by5zY3JvbGxMZWZ0fHwwLG49YS5zY3JvbGxUb3B8fG8uc2Nyb2xsVG9wfHwwKToocys9dC5zY3JvbGxMZWZ0fHwwLG4rPXQuc2Nyb2xsVG9wfHwwKTtyZXR1cm57bGVmdDpzLHRvcDpufX1mdW5jdGlvbiBuKHQpe3ZhciBlLGkscj10JiZ0Lm93bmVyRG9jdW1lbnQscz17bGVmdDowLHRvcDowfSxuPXtsZWZ0OjAsdG9wOjB9LG89e2JvcmRlckxlZnRXaWR0aDpcImxlZnRcIixib3JkZXJUb3BXaWR0aDpcInRvcFwiLHBhZGRpbmdMZWZ0OlwibGVmdFwiLHBhZGRpbmdUb3A6XCJ0b3BcIn07aWYoIXIpcmV0dXJue2xlZnQ6MCx0b3A6MH07Zm9yKHZhciBhIGluIG8pbltvW2FdXSs9cGFyc2VJbnQobCh0LGEpLDEwKXx8MDtyZXR1cm4gZT1yLmRvY3VtZW50RWxlbWVudCxcInVuZGVmaW5lZFwiIT10eXBlb2YgdC5nZXRCb3VuZGluZ0NsaWVudFJlY3QmJihzPXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkpLGk9ZmFicmljLnV0aWwuZ2V0U2Nyb2xsTGVmdFRvcCh0LG51bGwpLHtsZWZ0OnMubGVmdCtpLmxlZnQtKGUuY2xpZW50TGVmdHx8MCkrbi5sZWZ0LHRvcDpzLnRvcCtpLnRvcC0oZS5jbGllbnRUb3B8fDApK24udG9wfX12YXIgbyxhPUFycmF5LnByb3RvdHlwZS5zbGljZSxoPWZ1bmN0aW9uKHQpe3JldHVybiBhLmNhbGwodCwwKX07dHJ5e289aChmYWJyaWMuZG9jdW1lbnQuY2hpbGROb2RlcylpbnN0YW5jZW9mIEFycmF5fWNhdGNoKGMpe31vfHwoaD1mdW5jdGlvbih0KXtmb3IodmFyIGU9bmV3IEFycmF5KHQubGVuZ3RoKSxpPXQubGVuZ3RoO2ktLTspZVtpXT10W2ldO3JldHVybiBlfSk7dmFyIGw7bD1mYWJyaWMuZG9jdW1lbnQuZGVmYXVsdFZpZXcmJmZhYnJpYy5kb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlP2Z1bmN0aW9uKHQsZSl7dmFyIGk9ZmFicmljLmRvY3VtZW50LmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUodCxudWxsKTtyZXR1cm4gaT9pW2VdOnZvaWQgMH06ZnVuY3Rpb24odCxlKXt2YXIgaT10LnN0eWxlW2VdO3JldHVybiFpJiZ0LmN1cnJlbnRTdHlsZSYmKGk9dC5jdXJyZW50U3R5bGVbZV0pLGl9LGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXtyZXR1cm5cInVuZGVmaW5lZFwiIT10eXBlb2YgdC5vbnNlbGVjdHN0YXJ0JiYodC5vbnNlbGVjdHN0YXJ0PWZhYnJpYy51dGlsLmZhbHNlRnVuY3Rpb24pLHI/dC5zdHlsZVtyXT1cIm5vbmVcIjpcInN0cmluZ1wiPT10eXBlb2YgdC51bnNlbGVjdGFibGUmJih0LnVuc2VsZWN0YWJsZT1cIm9uXCIpLHR9ZnVuY3Rpb24gZSh0KXtyZXR1cm5cInVuZGVmaW5lZFwiIT10eXBlb2YgdC5vbnNlbGVjdHN0YXJ0JiYodC5vbnNlbGVjdHN0YXJ0PW51bGwpLHI/dC5zdHlsZVtyXT1cIlwiOlwic3RyaW5nXCI9PXR5cGVvZiB0LnVuc2VsZWN0YWJsZSYmKHQudW5zZWxlY3RhYmxlPVwiXCIpLHR9dmFyIGk9ZmFicmljLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZSxyPVwidXNlclNlbGVjdFwiaW4gaT9cInVzZXJTZWxlY3RcIjpcIk1velVzZXJTZWxlY3RcImluIGk/XCJNb3pVc2VyU2VsZWN0XCI6XCJXZWJraXRVc2VyU2VsZWN0XCJpbiBpP1wiV2Via2l0VXNlclNlbGVjdFwiOlwiS2h0bWxVc2VyU2VsZWN0XCJpbiBpP1wiS2h0bWxVc2VyU2VsZWN0XCI6XCJcIjtmYWJyaWMudXRpbC5tYWtlRWxlbWVudFVuc2VsZWN0YWJsZT10LGZhYnJpYy51dGlsLm1ha2VFbGVtZW50U2VsZWN0YWJsZT1lfSgpLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3ZhciBpPWZhYnJpYy5kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImhlYWRcIilbMF0scj1mYWJyaWMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKSxzPSEwO3Iub25sb2FkPXIub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKHQpe2lmKHMpe2lmKFwic3RyaW5nXCI9PXR5cGVvZiB0aGlzLnJlYWR5U3RhdGUmJlwibG9hZGVkXCIhPT10aGlzLnJlYWR5U3RhdGUmJlwiY29tcGxldGVcIiE9PXRoaXMucmVhZHlTdGF0ZSlyZXR1cm47cz0hMSxlKHR8fGZhYnJpYy53aW5kb3cuZXZlbnQpLHI9ci5vbmxvYWQ9ci5vbnJlYWR5c3RhdGVjaGFuZ2U9bnVsbH19LHIuc3JjPXQsaS5hcHBlbmRDaGlsZChyKX1mYWJyaWMudXRpbC5nZXRTY3JpcHQ9dH0oKSxmYWJyaWMudXRpbC5nZXRCeUlkPXQsZmFicmljLnV0aWwudG9BcnJheT1oLGZhYnJpYy51dGlsLm1ha2VFbGVtZW50PWUsZmFicmljLnV0aWwuYWRkQ2xhc3M9aSxmYWJyaWMudXRpbC53cmFwRWxlbWVudD1yLGZhYnJpYy51dGlsLmdldFNjcm9sbExlZnRUb3A9cyxmYWJyaWMudXRpbC5nZXRFbGVtZW50T2Zmc2V0PW4sZmFicmljLnV0aWwuZ2V0RWxlbWVudFN0eWxlPWx9KCksZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSl7cmV0dXJuIHQrKC9cXD8vLnRlc3QodCk/XCImXCI6XCI/XCIpK2V9ZnVuY3Rpb24gZSgpe31mdW5jdGlvbiBpKGkscyl7c3x8KHM9e30pO3ZhciBuLG89cy5tZXRob2Q/cy5tZXRob2QudG9VcHBlckNhc2UoKTpcIkdFVFwiLGE9cy5vbkNvbXBsZXRlfHxmdW5jdGlvbigpe30saD1yKCk7cmV0dXJuIGgub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7ND09PWgucmVhZHlTdGF0ZSYmKGEoaCksaC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZSl9LFwiR0VUXCI9PT1vJiYobj1udWxsLFwic3RyaW5nXCI9PXR5cGVvZiBzLnBhcmFtZXRlcnMmJihpPXQoaSxzLnBhcmFtZXRlcnMpKSksaC5vcGVuKG8saSwhMCksKFwiUE9TVFwiPT09b3x8XCJQVVRcIj09PW8pJiZoLnNldFJlcXVlc3RIZWFkZXIoXCJDb250ZW50LVR5cGVcIixcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiKSxoLnNlbmQobiksaH12YXIgcj1mdW5jdGlvbigpe2Zvcih2YXIgdD1bZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoXCJNaWNyb3NvZnQuWE1MSFRUUFwiKX0sZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoXCJNc3htbDIuWE1MSFRUUFwiKX0sZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoXCJNc3htbDIuWE1MSFRUUC4zLjBcIil9LGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBYTUxIdHRwUmVxdWVzdH1dLGU9dC5sZW5ndGg7ZS0tOyl0cnl7dmFyIGk9dFtlXSgpO2lmKGkpcmV0dXJuIHRbZV19Y2F0Y2gocil7fX0oKTtmYWJyaWMudXRpbC5yZXF1ZXN0PWl9KCksZmFicmljLmxvZz1mdW5jdGlvbigpe30sZmFicmljLndhcm49ZnVuY3Rpb24oKXt9LFwidW5kZWZpbmVkXCIhPXR5cGVvZiBjb25zb2xlJiZbXCJsb2dcIixcIndhcm5cIl0uZm9yRWFjaChmdW5jdGlvbih0KXtcInVuZGVmaW5lZFwiIT10eXBlb2YgY29uc29sZVt0XSYmXCJmdW5jdGlvblwiPT10eXBlb2YgY29uc29sZVt0XS5hcHBseSYmKGZhYnJpY1t0XT1mdW5jdGlvbigpe3JldHVybiBjb25zb2xlW3RdLmFwcGx5KGNvbnNvbGUsYXJndW1lbnRzKX0pfSksZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQpe2UoZnVuY3Rpb24oaSl7dHx8KHQ9e30pO3ZhciByLHM9aXx8K25ldyBEYXRlLG49dC5kdXJhdGlvbnx8NTAwLG89cytuLGE9dC5vbkNoYW5nZXx8ZnVuY3Rpb24oKXt9LGg9dC5hYm9ydHx8ZnVuY3Rpb24oKXtyZXR1cm4hMX0sYz10LmVhc2luZ3x8ZnVuY3Rpb24odCxlLGkscil7cmV0dXJuLWkqTWF0aC5jb3ModC9yKihNYXRoLlBJLzIpKStpK2V9LGw9XCJzdGFydFZhbHVlXCJpbiB0P3Quc3RhcnRWYWx1ZTowLHU9XCJlbmRWYWx1ZVwiaW4gdD90LmVuZFZhbHVlOjEwMCxmPXQuYnlWYWx1ZXx8dS1sO3Qub25TdGFydCYmdC5vblN0YXJ0KCksZnVuY3Rpb24gZChpKXtyPWl8fCtuZXcgRGF0ZTt2YXIgdT1yPm8/bjpyLXM7cmV0dXJuIGgoKT92b2lkKHQub25Db21wbGV0ZSYmdC5vbkNvbXBsZXRlKCkpOihhKGModSxsLGYsbikpLHI+bz92b2lkKHQub25Db21wbGV0ZSYmdC5vbkNvbXBsZXRlKCkpOnZvaWQgZShkKSl9KHMpfSl9ZnVuY3Rpb24gZSgpe3JldHVybiBpLmFwcGx5KGZhYnJpYy53aW5kb3csYXJndW1lbnRzKX12YXIgaT1mYWJyaWMud2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZXx8ZmFicmljLndpbmRvdy53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGZhYnJpYy53aW5kb3cubW96UmVxdWVzdEFuaW1hdGlvbkZyYW1lfHxmYWJyaWMud2luZG93Lm9SZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGZhYnJpYy53aW5kb3cubXNSZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGZ1bmN0aW9uKHQpe2ZhYnJpYy53aW5kb3cuc2V0VGltZW91dCh0LDFlMy82MCl9O2ZhYnJpYy51dGlsLmFuaW1hdGU9dCxmYWJyaWMudXRpbC5yZXF1ZXN0QW5pbUZyYW1lPWV9KCksZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSxpLHIpe3JldHVybiB0PE1hdGguYWJzKGUpPyh0PWUscj1pLzQpOnI9aS8oMipNYXRoLlBJKSpNYXRoLmFzaW4oZS90KSx7YTp0LGM6ZSxwOmksczpyfX1mdW5jdGlvbiBlKHQsZSxpKXtyZXR1cm4gdC5hKk1hdGgucG93KDIsMTAqKGUtPTEpKSpNYXRoLnNpbigyKihlKmktdC5zKSpNYXRoLlBJL3QucCl9ZnVuY3Rpb24gaSh0LGUsaSxyKXtyZXR1cm4gaSooKHQ9dC9yLTEpKnQqdCsxKStlfWZ1bmN0aW9uIHIodCxlLGkscil7cmV0dXJuIHQvPXIvMiwxPnQ/aS8yKnQqdCp0K2U6aS8yKigodC09MikqdCp0KzIpK2V9ZnVuY3Rpb24gcyh0LGUsaSxyKXtyZXR1cm4gaSoodC89cikqdCp0KnQrZX1mdW5jdGlvbiBuKHQsZSxpLHIpe3JldHVybi1pKigodD10L3ItMSkqdCp0KnQtMSkrZX1mdW5jdGlvbiBvKHQsZSxpLHIpe3JldHVybiB0Lz1yLzIsMT50P2kvMip0KnQqdCp0K2U6LWkvMiooKHQtPTIpKnQqdCp0LTIpK2V9ZnVuY3Rpb24gYSh0LGUsaSxyKXtyZXR1cm4gaSoodC89cikqdCp0KnQqdCtlfWZ1bmN0aW9uIGgodCxlLGkscil7cmV0dXJuIGkqKCh0PXQvci0xKSp0KnQqdCp0KzEpK2V9ZnVuY3Rpb24gYyh0LGUsaSxyKXtyZXR1cm4gdC89ci8yLDE+dD9pLzIqdCp0KnQqdCp0K2U6aS8yKigodC09MikqdCp0KnQqdCsyKStlfWZ1bmN0aW9uIGwodCxlLGkscil7cmV0dXJuLWkqTWF0aC5jb3ModC9yKihNYXRoLlBJLzIpKStpK2V9ZnVuY3Rpb24gdSh0LGUsaSxyKXtyZXR1cm4gaSpNYXRoLnNpbih0L3IqKE1hdGguUEkvMikpK2V9ZnVuY3Rpb24gZih0LGUsaSxyKXtyZXR1cm4taS8yKihNYXRoLmNvcyhNYXRoLlBJKnQvciktMSkrZX1mdW5jdGlvbiBkKHQsZSxpLHIpe3JldHVybiAwPT09dD9lOmkqTWF0aC5wb3coMiwxMCoodC9yLTEpKStlfWZ1bmN0aW9uIGcodCxlLGkscil7cmV0dXJuIHQ9PT1yP2UraTppKigtTWF0aC5wb3coMiwtMTAqdC9yKSsxKStlfWZ1bmN0aW9uIHAodCxlLGkscil7cmV0dXJuIDA9PT10P2U6dD09PXI/ZStpOih0Lz1yLzIsMT50P2kvMipNYXRoLnBvdygyLDEwKih0LTEpKStlOmkvMiooLU1hdGgucG93KDIsLTEwKi0tdCkrMikrZSl9ZnVuY3Rpb24gdih0LGUsaSxyKXtyZXR1cm4taSooTWF0aC5zcXJ0KDEtKHQvPXIpKnQpLTEpK2V9ZnVuY3Rpb24gYih0LGUsaSxyKXtyZXR1cm4gaSpNYXRoLnNxcnQoMS0odD10L3ItMSkqdCkrZX1mdW5jdGlvbiBtKHQsZSxpLHIpe3JldHVybiB0Lz1yLzIsMT50Py1pLzIqKE1hdGguc3FydCgxLXQqdCktMSkrZTppLzIqKE1hdGguc3FydCgxLSh0LT0yKSp0KSsxKStlfWZ1bmN0aW9uIHkoaSxyLHMsbil7dmFyIG89MS43MDE1OCxhPTAsaD1zO2lmKDA9PT1pKXJldHVybiByO2lmKGkvPW4sMT09PWkpcmV0dXJuIHIrczthfHwoYT0uMypuKTt2YXIgYz10KGgscyxhLG8pO3JldHVybi1lKGMsaSxuKStyfWZ1bmN0aW9uIF8oZSxpLHIscyl7dmFyIG49MS43MDE1OCxvPTAsYT1yO2lmKDA9PT1lKXJldHVybiBpO2lmKGUvPXMsMT09PWUpcmV0dXJuIGkrcjtvfHwobz0uMypzKTt2YXIgaD10KGEscixvLG4pO3JldHVybiBoLmEqTWF0aC5wb3coMiwtMTAqZSkqTWF0aC5zaW4oMiooZSpzLWgucykqTWF0aC5QSS9oLnApK2guYytpfWZ1bmN0aW9uIHgoaSxyLHMsbil7dmFyIG89MS43MDE1OCxhPTAsaD1zO2lmKDA9PT1pKXJldHVybiByO2lmKGkvPW4vMiwyPT09aSlyZXR1cm4gcitzO2F8fChhPS4zKm4qMS41KTt2YXIgYz10KGgscyxhLG8pO3JldHVybiAxPmk/LS41KmUoYyxpLG4pK3I6Yy5hKk1hdGgucG93KDIsLTEwKihpLT0xKSkqTWF0aC5zaW4oMiooaSpuLWMucykqTWF0aC5QSS9jLnApKi41K2MuYytyfWZ1bmN0aW9uIEModCxlLGkscixzKXtyZXR1cm4gdm9pZCAwPT09cyYmKHM9MS43MDE1OCksaSoodC89cikqdCooKHMrMSkqdC1zKStlfWZ1bmN0aW9uIFModCxlLGkscixzKXtyZXR1cm4gdm9pZCAwPT09cyYmKHM9MS43MDE1OCksaSooKHQ9dC9yLTEpKnQqKChzKzEpKnQrcykrMSkrZX1mdW5jdGlvbiB3KHQsZSxpLHIscyl7cmV0dXJuIHZvaWQgMD09PXMmJihzPTEuNzAxNTgpLHQvPXIvMiwxPnQ/aS8yKnQqdCooKChzKj0xLjUyNSkrMSkqdC1zKStlOmkvMiooKHQtPTIpKnQqKCgocyo9MS41MjUpKzEpKnQrcykrMikrZX1mdW5jdGlvbiBPKHQsZSxpLHIpe3JldHVybiBpLVQoci10LDAsaSxyKStlfWZ1bmN0aW9uIFQodCxlLGkscil7cmV0dXJuKHQvPXIpPDEvMi43NT83LjU2MjUqaSp0KnQrZToyLzIuNzU+dD9pKig3LjU2MjUqKHQtPTEuNS8yLjc1KSp0Ky43NSkrZToyLjUvMi43NT50P2kqKDcuNTYyNSoodC09Mi4yNS8yLjc1KSp0Ky45Mzc1KStlOmkqKDcuNTYyNSoodC09Mi42MjUvMi43NSkqdCsuOTg0Mzc1KStlfWZ1bmN0aW9uIGsodCxlLGkscil7cmV0dXJuIHIvMj50Py41Kk8oMip0LDAsaSxyKStlOi41KlQoMip0LXIsMCxpLHIpKy41KmkrZX1mYWJyaWMudXRpbC5lYXNlPXtlYXNlSW5RdWFkOmZ1bmN0aW9uKHQsZSxpLHIpe3JldHVybiBpKih0Lz1yKSp0K2V9LGVhc2VPdXRRdWFkOmZ1bmN0aW9uKHQsZSxpLHIpe3JldHVybi1pKih0Lz1yKSoodC0yKStlfSxlYXNlSW5PdXRRdWFkOmZ1bmN0aW9uKHQsZSxpLHIpe3JldHVybiB0Lz1yLzIsMT50P2kvMip0KnQrZTotaS8yKigtLXQqKHQtMiktMSkrZX0sZWFzZUluQ3ViaWM6ZnVuY3Rpb24odCxlLGkscil7cmV0dXJuIGkqKHQvPXIpKnQqdCtlfSxlYXNlT3V0Q3ViaWM6aSxlYXNlSW5PdXRDdWJpYzpyLGVhc2VJblF1YXJ0OnMsZWFzZU91dFF1YXJ0Om4sZWFzZUluT3V0UXVhcnQ6byxlYXNlSW5RdWludDphLGVhc2VPdXRRdWludDpoLGVhc2VJbk91dFF1aW50OmMsZWFzZUluU2luZTpsLGVhc2VPdXRTaW5lOnUsZWFzZUluT3V0U2luZTpmLGVhc2VJbkV4cG86ZCxlYXNlT3V0RXhwbzpnLGVhc2VJbk91dEV4cG86cCxlYXNlSW5DaXJjOnYsZWFzZU91dENpcmM6YixlYXNlSW5PdXRDaXJjOm0sZWFzZUluRWxhc3RpYzp5LGVhc2VPdXRFbGFzdGljOl8sZWFzZUluT3V0RWxhc3RpYzp4LGVhc2VJbkJhY2s6QyxlYXNlT3V0QmFjazpTLGVhc2VJbk91dEJhY2s6dyxlYXNlSW5Cb3VuY2U6TyxlYXNlT3V0Qm91bmNlOlQsZWFzZUluT3V0Qm91bmNlOmt9fSgpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGUodCl7cmV0dXJuIHQgaW4gQz9DW3RdOnR9ZnVuY3Rpb24gaSh0LGUsaSxyKXt2YXIgcyxuPVwiW29iamVjdCBBcnJheV1cIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlKTtyZXR1cm5cImZpbGxcIiE9PXQmJlwic3Ryb2tlXCIhPT10fHxcIm5vbmVcIiE9PWU/XCJzdHJva2VEYXNoQXJyYXlcIj09PXQ/ZT1lLnJlcGxhY2UoLywvZyxcIiBcIikuc3BsaXQoL1xccysvKS5tYXAoZnVuY3Rpb24odCl7cmV0dXJuIHBhcnNlRmxvYXQodCl9KTpcInRyYW5zZm9ybU1hdHJpeFwiPT09dD9lPWkmJmkudHJhbnNmb3JtTWF0cml4P3goaS50cmFuc2Zvcm1NYXRyaXgscC5wYXJzZVRyYW5zZm9ybUF0dHJpYnV0ZShlKSk6cC5wYXJzZVRyYW5zZm9ybUF0dHJpYnV0ZShlKTpcInZpc2libGVcIj09PXQ/KGU9XCJub25lXCI9PT1lfHxcImhpZGRlblwiPT09ZT8hMTohMCxpJiZpLnZpc2libGU9PT0hMSYmKGU9ITEpKTpcIm9yaWdpblhcIj09PXQ/ZT1cInN0YXJ0XCI9PT1lP1wibGVmdFwiOlwiZW5kXCI9PT1lP1wicmlnaHRcIjpcImNlbnRlclwiOnM9bj9lLm1hcChfKTpfKGUscik6ZT1cIlwiLCFuJiZpc05hTihzKT9lOnN9ZnVuY3Rpb24gcih0KXtmb3IodmFyIGUgaW4gUylpZih0W2VdJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgdFtTW2VdXSYmMCE9PXRbZV0uaW5kZXhPZihcInVybChcIikpe3ZhciBpPW5ldyBwLkNvbG9yKHRbZV0pO3RbZV09aS5zZXRBbHBoYSh5KGkuZ2V0QWxwaGEoKSp0W1NbZV1dLDIpKS50b1JnYmEoKX1yZXR1cm4gdH1mdW5jdGlvbiBzKHQscil7dmFyIHMsbjt0LnJlcGxhY2UoLzskLyxcIlwiKS5zcGxpdChcIjtcIikuZm9yRWFjaChmdW5jdGlvbih0KXt2YXIgbz10LnNwbGl0KFwiOlwiKTtzPWUob1swXS50cmltKCkudG9Mb3dlckNhc2UoKSksbj1pKHMsb1sxXS50cmltKCkpLHJbc109bn0pfWZ1bmN0aW9uIG4odCxyKXt2YXIgcyxuO2Zvcih2YXIgbyBpbiB0KVwidW5kZWZpbmVkXCIhPXR5cGVvZiB0W29dJiYocz1lKG8udG9Mb3dlckNhc2UoKSksbj1pKHMsdFtvXSkscltzXT1uKX1mdW5jdGlvbiBvKHQsZSl7dmFyIGk9e307Zm9yKHZhciByIGluIHAuY3NzUnVsZXNbZV0paWYoYSh0LHIuc3BsaXQoXCIgXCIpKSlmb3IodmFyIHMgaW4gcC5jc3NSdWxlc1tlXVtyXSlpW3NdPXAuY3NzUnVsZXNbZV1bcl1bc107cmV0dXJuIGl9ZnVuY3Rpb24gYSh0LGUpe3ZhciBpLHI9ITA7cmV0dXJuIGk9Yyh0LGUucG9wKCkpLGkmJmUubGVuZ3RoJiYocj1oKHQsZSkpLGkmJnImJjA9PT1lLmxlbmd0aH1mdW5jdGlvbiBoKHQsZSl7Zm9yKHZhciBpLHI9ITA7dC5wYXJlbnROb2RlJiYxPT09dC5wYXJlbnROb2RlLm5vZGVUeXBlJiZlLmxlbmd0aDspciYmKGk9ZS5wb3AoKSksdD10LnBhcmVudE5vZGUscj1jKHQsaSk7cmV0dXJuIDA9PT1lLmxlbmd0aH1mdW5jdGlvbiBjKHQsZSl7dmFyIGkscj10Lm5vZGVOYW1lLHM9dC5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKSxuPXQuZ2V0QXR0cmlidXRlKFwiaWRcIik7aWYoaT1uZXcgUmVnRXhwKFwiXlwiK3IsXCJpXCIpLGU9ZS5yZXBsYWNlKGksXCJcIiksbiYmZS5sZW5ndGgmJihpPW5ldyBSZWdFeHAoXCIjXCIrbitcIig/IVthLXpBLVpcXFxcLV0rKVwiLFwiaVwiKSxlPWUucmVwbGFjZShpLFwiXCIpKSxzJiZlLmxlbmd0aCl7cz1zLnNwbGl0KFwiIFwiKTtmb3IodmFyIG89cy5sZW5ndGg7by0tOylpPW5ldyBSZWdFeHAoXCJcXFxcLlwiK3Nbb10rXCIoPyFbYS16QS1aXFxcXC1dKylcIixcImlcIiksZT1lLnJlcGxhY2UoaSxcIlwiKX1yZXR1cm4gMD09PWUubGVuZ3RofWZ1bmN0aW9uIGwodCxlKXt2YXIgaTtpZih0LmdldEVsZW1lbnRCeUlkJiYoaT10LmdldEVsZW1lbnRCeUlkKGUpKSxpKXJldHVybiBpO3ZhciByLHMsbixvPXQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCIqXCIpO2ZvcihzPTA7czxvLmxlbmd0aDtzKyspaWYocj1vW3NdLG49PT1yLmdldEF0dHJpYnV0ZShcImlkXCIpKXJldHVybiByfWZ1bmN0aW9uIHUodCl7Zm9yKHZhciBlPXQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ1c2VcIiksaT0wO2UubGVuZ3RoJiZpPGUubGVuZ3RoOyl7Zm9yKHZhciByLHM9ZVtpXSxuPXMuZ2V0QXR0cmlidXRlKFwieGxpbms6aHJlZlwiKS5zdWJzdHIoMSksbz1zLmdldEF0dHJpYnV0ZShcInhcIil8fDAsYT1zLmdldEF0dHJpYnV0ZShcInlcIil8fDAsaD1sKHQsbikuY2xvbmVOb2RlKCEwKSxjPShoLmdldEF0dHJpYnV0ZShcInRyYW5zZm9ybVwiKXx8XCJcIikrXCIgdHJhbnNsYXRlKFwiK28rXCIsIFwiK2ErXCIpXCIsdT1lLmxlbmd0aCxmPTAsZD1zLmF0dHJpYnV0ZXMsZz1kLmxlbmd0aDtnPmY7ZisrKXt2YXIgcD1kLml0ZW0oZik7XCJ4XCIhPT1wLm5vZGVOYW1lJiZcInlcIiE9PXAubm9kZU5hbWUmJlwieGxpbms6aHJlZlwiIT09cC5ub2RlTmFtZSYmKFwidHJhbnNmb3JtXCI9PT1wLm5vZGVOYW1lP2M9cC5ub2RlVmFsdWUrXCIgXCIrYzpoLnNldEF0dHJpYnV0ZShwLm5vZGVOYW1lLHAubm9kZVZhbHVlKSl9aC5zZXRBdHRyaWJ1dGUoXCJ0cmFuc2Zvcm1cIixjKSxoLnNldEF0dHJpYnV0ZShcImluc3RhbnRpYXRlZF9ieV91c2VcIixcIjFcIiksaC5yZW1vdmVBdHRyaWJ1dGUoXCJpZFwiKSxyPXMucGFyZW50Tm9kZSxyLnJlcGxhY2VDaGlsZChoLHMpLGUubGVuZ3RoPT09dSYmaSsrfX1mdW5jdGlvbiBmKHQsZSxpKXt2YXIgcixzLG4sbyxhPXQuZ2V0QXR0cmlidXRlKFwidmlld0JveFwiKSxoPTEsYz0xLGw9MCx1PTA7aWYoYSYmKGE9YS5tYXRjaCh3KSkmJihsPS1wYXJzZUZsb2F0KGFbMV0pLHU9LXBhcnNlRmxvYXQoYVsyXSkscj1wYXJzZUZsb2F0KGFbM10pLHM9cGFyc2VGbG9hdChhWzRdKSxlJiZlIT09ciYmKGg9ZS9yKSxpJiZpIT09cyYmKGM9aS9zKSxjPWg9aD5jP2M6aCwxIT09aHx8MSE9PWN8fDAhPT1sfHwwIT09dSkpe2lmKG49XCIgbWF0cml4KFwiK2grXCIgMCAwIFwiK2MrXCIgXCIrbCpoK1wiIFwiK3UqYytcIikgXCIsXCJzdmdcIj09PXQudGFnTmFtZSl7Zm9yKG89dC5vd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJnXCIpO251bGwhPXQuZmlyc3RDaGlsZDspby5hcHBlbmRDaGlsZCh0LmZpcnN0Q2hpbGQpO3QuYXBwZW5kQ2hpbGQobyl9ZWxzZSBvPXQsbj1vLmdldEF0dHJpYnV0ZShcInRyYW5zZm9ybVwiKStuO28uc2V0QXR0cmlidXRlKFwidHJhbnNmb3JtXCIsbil9fWZ1bmN0aW9uIGQodCl7dmFyIGU9dC5vYmplY3RzLGk9dC5vcHRpb25zO3JldHVybiBlPWUubWFwKGZ1bmN0aW9uKHQpe3JldHVybiBwW2IodC50eXBlKV0uZnJvbU9iamVjdCh0KX0pLHtvYmplY3RzOmUsb3B0aW9uczppfX1mdW5jdGlvbiBnKHQsZSxpKXtlW2ldJiZlW2ldLnRvU1ZHJiZ0LnB1c2goJzxwYXR0ZXJuIHg9XCIwXCIgeT1cIjBcIiBpZD1cIicsaSwnUGF0dGVyblwiICcsJ3dpZHRoPVwiJyxlW2ldLnNvdXJjZS53aWR0aCwnXCIgaGVpZ2h0PVwiJyxlW2ldLnNvdXJjZS5oZWlnaHQsJ1wiIHBhdHRlcm5Vbml0cz1cInVzZXJTcGFjZU9uVXNlXCI+JywnPGltYWdlIHg9XCIwXCIgeT1cIjBcIiAnLCd3aWR0aD1cIicsZVtpXS5zb3VyY2Uud2lkdGgsJ1wiIGhlaWdodD1cIicsZVtpXS5zb3VyY2UuaGVpZ2h0LCdcIiB4bGluazpocmVmPVwiJyxlW2ldLnNvdXJjZS5zcmMsJ1wiPjwvaW1hZ2U+PC9wYXR0ZXJuPicpfXZhciBwPXQuZmFicmljfHwodC5mYWJyaWM9e30pLHY9cC51dGlsLm9iamVjdC5leHRlbmQsYj1wLnV0aWwuc3RyaW5nLmNhcGl0YWxpemUsbT1wLnV0aWwub2JqZWN0LmNsb25lLHk9cC51dGlsLnRvRml4ZWQsXz1wLnV0aWwucGFyc2VVbml0LHg9cC51dGlsLm11bHRpcGx5VHJhbnNmb3JtTWF0cmljZXMsQz17Y3g6XCJsZWZ0XCIseDpcImxlZnRcIixyOlwicmFkaXVzXCIsY3k6XCJ0b3BcIix5OlwidG9wXCIsZGlzcGxheTpcInZpc2libGVcIix2aXNpYmlsaXR5OlwidmlzaWJsZVwiLHRyYW5zZm9ybTpcInRyYW5zZm9ybU1hdHJpeFwiLFwiZmlsbC1vcGFjaXR5XCI6XCJmaWxsT3BhY2l0eVwiLFwiZmlsbC1ydWxlXCI6XCJmaWxsUnVsZVwiLFwiZm9udC1mYW1pbHlcIjpcImZvbnRGYW1pbHlcIixcImZvbnQtc2l6ZVwiOlwiZm9udFNpemVcIixcImZvbnQtc3R5bGVcIjpcImZvbnRTdHlsZVwiLFwiZm9udC13ZWlnaHRcIjpcImZvbnRXZWlnaHRcIixcInN0cm9rZS1kYXNoYXJyYXlcIjpcInN0cm9rZURhc2hBcnJheVwiLFwic3Ryb2tlLWxpbmVjYXBcIjpcInN0cm9rZUxpbmVDYXBcIixcInN0cm9rZS1saW5lam9pblwiOlwic3Ryb2tlTGluZUpvaW5cIixcInN0cm9rZS1taXRlcmxpbWl0XCI6XCJzdHJva2VNaXRlckxpbWl0XCIsXCJzdHJva2Utb3BhY2l0eVwiOlwic3Ryb2tlT3BhY2l0eVwiLFwic3Ryb2tlLXdpZHRoXCI6XCJzdHJva2VXaWR0aFwiLFwidGV4dC1kZWNvcmF0aW9uXCI6XCJ0ZXh0RGVjb3JhdGlvblwiLFwidGV4dC1hbmNob3JcIjpcIm9yaWdpblhcIn0sUz17c3Ryb2tlOlwic3Ryb2tlT3BhY2l0eVwiLGZpbGw6XCJmaWxsT3BhY2l0eVwifTtwLmNzc1J1bGVzPXt9LHAuZ3JhZGllbnREZWZzPXt9LHAucGFyc2VUcmFuc2Zvcm1BdHRyaWJ1dGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSl7dmFyIGk9ZVswXTt0WzBdPU1hdGguY29zKGkpLHRbMV09TWF0aC5zaW4oaSksdFsyXT0tTWF0aC5zaW4oaSksdFszXT1NYXRoLmNvcyhpKX1mdW5jdGlvbiBlKHQsZSl7dmFyIGk9ZVswXSxyPTI9PT1lLmxlbmd0aD9lWzFdOmVbMF07dFswXT1pLHRbM109cn1mdW5jdGlvbiBpKHQsZSl7dFsyXT1NYXRoLnRhbihwLnV0aWwuZGVncmVlc1RvUmFkaWFucyhlWzBdKSl9ZnVuY3Rpb24gcih0LGUpe3RbMV09TWF0aC50YW4ocC51dGlsLmRlZ3JlZXNUb1JhZGlhbnMoZVswXSkpfWZ1bmN0aW9uIHModCxlKXt0WzRdPWVbMF0sMj09PWUubGVuZ3RoJiYodFs1XT1lWzFdKX12YXIgbj1bMSwwLDAsMSwwLDBdLG89cC5yZU51bSxhPVwiKD86XFxcXHMrLD9cXFxccyp8LFxcXFxzKilcIixoPVwiKD86KHNrZXdYKVxcXFxzKlxcXFwoXFxcXHMqKFwiK28rXCIpXFxcXHMqXFxcXCkpXCIsYz1cIig/Oihza2V3WSlcXFxccypcXFxcKFxcXFxzKihcIitvK1wiKVxcXFxzKlxcXFwpKVwiLGw9XCIoPzoocm90YXRlKVxcXFxzKlxcXFwoXFxcXHMqKFwiK28rXCIpKD86XCIrYStcIihcIitvK1wiKVwiK2ErXCIoXCIrbytcIikpP1xcXFxzKlxcXFwpKVwiLHU9XCIoPzooc2NhbGUpXFxcXHMqXFxcXChcXFxccyooXCIrbytcIikoPzpcIithK1wiKFwiK28rXCIpKT9cXFxccypcXFxcKSlcIixmPVwiKD86KHRyYW5zbGF0ZSlcXFxccypcXFxcKFxcXFxzKihcIitvK1wiKSg/OlwiK2ErXCIoXCIrbytcIikpP1xcXFxzKlxcXFwpKVwiLGQ9XCIoPzoobWF0cml4KVxcXFxzKlxcXFwoXFxcXHMqKFwiK28rXCIpXCIrYStcIihcIitvK1wiKVwiK2ErXCIoXCIrbytcIilcIithK1wiKFwiK28rXCIpXCIrYStcIihcIitvK1wiKVwiK2ErXCIoXCIrbytcIilcXFxccypcXFxcKSlcIixnPVwiKD86XCIrZCtcInxcIitmK1wifFwiK3UrXCJ8XCIrbCtcInxcIitoK1wifFwiK2MrXCIpXCIsdj1cIig/OlwiK2crXCIoPzpcIithK2crXCIpKilcIixiPVwiXlxcXFxzKig/OlwiK3YrXCI/KVxcXFxzKiRcIixtPW5ldyBSZWdFeHAoYikseT1uZXcgUmVnRXhwKGcsXCJnXCIpO3JldHVybiBmdW5jdGlvbihvKXt2YXIgYT1uLmNvbmNhdCgpLGg9W107aWYoIW98fG8mJiFtLnRlc3QobykpcmV0dXJuIGE7by5yZXBsYWNlKHksZnVuY3Rpb24obyl7dmFyIGM9bmV3IFJlZ0V4cChnKS5leGVjKG8pLmZpbHRlcihmdW5jdGlvbih0KXtyZXR1cm5cIlwiIT09dCYmbnVsbCE9dH0pLGw9Y1sxXSx1PWMuc2xpY2UoMikubWFwKHBhcnNlRmxvYXQpO3N3aXRjaChsKXtjYXNlXCJ0cmFuc2xhdGVcIjpzKGEsdSk7YnJlYWs7Y2FzZVwicm90YXRlXCI6dVswXT1wLnV0aWwuZGVncmVlc1RvUmFkaWFucyh1WzBdKSx0KGEsdSk7YnJlYWs7Y2FzZVwic2NhbGVcIjplKGEsdSk7YnJlYWs7Y2FzZVwic2tld1hcIjppKGEsdSk7YnJlYWs7Y2FzZVwic2tld1lcIjpyKGEsdSk7YnJlYWs7Y2FzZVwibWF0cml4XCI6YT11fWgucHVzaChhLmNvbmNhdCgpKSxhPW4uY29uY2F0KCl9KTtmb3IodmFyIGM9aFswXTtoLmxlbmd0aD4xOyloLnNoaWZ0KCksYz1wLnV0aWwubXVsdGlwbHlUcmFuc2Zvcm1NYXRyaWNlcyhjLGhbMF0pO3JldHVybiBjfX0oKTt2YXIgdz1uZXcgUmVnRXhwKFwiXlxcXFxzKihcIitwLnJlTnVtK1wiKylcXFxccyosP1xcXFxzKihcIitwLnJlTnVtK1wiKylcXFxccyosP1xcXFxzKihcIitwLnJlTnVtK1wiKylcXFxccyosP1xcXFxzKihcIitwLnJlTnVtK1wiKylcXFxccyokXCIpO3AucGFyc2VTVkdEb2N1bWVudD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxlKXtmb3IoO3QmJih0PXQucGFyZW50Tm9kZSk7KWlmKGUudGVzdCh0Lm5vZGVOYW1lKSYmIXQuZ2V0QXR0cmlidXRlKFwiaW5zdGFudGlhdGVkX2J5X3VzZVwiKSlyZXR1cm4hMDtyZXR1cm4hMX12YXIgZT0vXihwYXRofGNpcmNsZXxwb2x5Z29ufHBvbHlsaW5lfGVsbGlwc2V8cmVjdHxsaW5lfGltYWdlfHRleHQpJC8saT0vXihzeW1ib2x8aW1hZ2V8bWFya2VyfHBhdHRlcm58dmlldykkLztyZXR1cm4gZnVuY3Rpb24ocixzLG4pe2lmKHIpe3Uocik7dmFyIG8sYSxoPW5ldyBEYXRlLGM9cC5PYmplY3QuX191aWQrKyxsPSExO2lmKHIuZ2V0QXR0cmlidXRlKFwid2lkdGhcIikmJlwiMTAwJVwiIT09ci5nZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiKSYmKG89XyhyLmdldEF0dHJpYnV0ZShcIndpZHRoXCIpKSksci5nZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIikmJlwiMTAwJVwiIT09ci5nZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIikmJihhPV8oci5nZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIikpKSwhb3x8IWEpe3ZhciBkPXIuZ2V0QXR0cmlidXRlKFwidmlld0JveFwiKTtkJiYoZD1kLm1hdGNoKHcpKT8obz1wYXJzZUZsb2F0KGRbM10pLGE9cGFyc2VGbG9hdChkWzRdKSk6bD0hMH1mKHIsbyxhKTt2YXIgZz1wLnV0aWwudG9BcnJheShyLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiKlwiKSk7aWYoMD09PWcubGVuZ3RoJiZwLmlzTGlrZWx5Tm9kZSl7Zz1yLnNlbGVjdE5vZGVzKCcvLypbbmFtZSguKSE9XCJzdmdcIl0nKTtmb3IodmFyIHY9W10sYj0wLHk9Zy5sZW5ndGg7eT5iO2IrKyl2W2JdPWdbYl07Zz12fXZhciB4PWcuZmlsdGVyKGZ1bmN0aW9uKHIpe3JldHVybiBpLnRlc3Qoci50YWdOYW1lKSYmZihyLDAsMCksZS50ZXN0KHIudGFnTmFtZSkmJiF0KHIsL14oPzpwYXR0ZXJufGRlZnN8c3ltYm9sfG1ldGFkYXRhKSQvKX0pO2lmKCF4fHx4JiYheC5sZW5ndGgpcmV0dXJuIHZvaWQocyYmcyhbXSx7fSkpO3ZhciBDPXt3aWR0aDpvLGhlaWdodDphLHN2Z1VpZDpjLHRvQmVQYXJzZWQ6bH07cC5ncmFkaWVudERlZnNbY109cC5nZXRHcmFkaWVudERlZnMocikscC5jc3NSdWxlc1tjXT1wLmdldENTU1J1bGVzKHIpLHAucGFyc2VFbGVtZW50cyh4LGZ1bmN0aW9uKHQpe3AuZG9jdW1lbnRQYXJzaW5nVGltZT1uZXcgRGF0ZS1oLHMmJnModCxDKX0sbShDKSxuKX19fSgpO3ZhciBPPXtoYXM6ZnVuY3Rpb24odCxlKXtlKCExKX0sZ2V0OmZ1bmN0aW9uKCl7fSxzZXQ6ZnVuY3Rpb24oKXt9fSxUPW5ldyBSZWdFeHAoXCIobm9ybWFsfGl0YWxpYyk/XFxcXHMqKG5vcm1hbHxzbWFsbC1jYXBzKT9cXFxccyoobm9ybWFsfGJvbGR8Ym9sZGVyfGxpZ2h0ZXJ8MTAwfDIwMHwzMDB8NDAwfDUwMHw2MDB8NzAwfDgwMHw5MDApP1xcXFxzKihcIitwLnJlTnVtK1wiKD86cHh8Y218bW18ZW18cHR8cGN8aW4pKikoPzpcXFxcLyhub3JtYWx8XCIrcC5yZU51bStcIikpP1xcXFxzKyguKilcIik7dihwLHtwYXJzZUZvbnREZWNsYXJhdGlvbjpmdW5jdGlvbih0LGUpe3ZhciBpPXQubWF0Y2goVCk7aWYoaSl7dmFyIHI9aVsxXSxzPWlbM10sbj1pWzRdLG89aVs1XSxhPWlbNl07ciYmKGUuZm9udFN0eWxlPXIpLHMmJihlLmZvbnRXZWlnaHQ9aXNOYU4ocGFyc2VGbG9hdChzKSk/czpwYXJzZUZsb2F0KHMpKSxuJiYoZS5mb250U2l6ZT1fKG4pKSxcclxuYSYmKGUuZm9udEZhbWlseT1hKSxvJiYoZS5saW5lSGVpZ2h0PVwibm9ybWFsXCI9PT1vPzE6byl9fSxnZXRHcmFkaWVudERlZnM6ZnVuY3Rpb24odCl7dmFyIGUsaSxyLHMsbj10LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwibGluZWFyR3JhZGllbnRcIiksbz10LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwicmFkaWFsR3JhZGllbnRcIiksYT0wLGg9W10sYz17fSxsPXt9O2ZvcihoLmxlbmd0aD1uLmxlbmd0aCtvLmxlbmd0aCxpPW4ubGVuZ3RoO2ktLTspaFthKytdPW5baV07Zm9yKGk9by5sZW5ndGg7aS0tOyloW2ErK109b1tpXTtmb3IoO2EtLTspZT1oW2FdLHM9ZS5nZXRBdHRyaWJ1dGUoXCJ4bGluazpocmVmXCIpLHI9ZS5nZXRBdHRyaWJ1dGUoXCJpZFwiKSxzJiYobFtyXT1zLnN1YnN0cigxKSksY1tyXT1lO2ZvcihyIGluIGwpe3ZhciB1PWNbbFtyXV0uY2xvbmVOb2RlKCEwKTtmb3IoZT1jW3JdO3UuZmlyc3RDaGlsZDspZS5hcHBlbmRDaGlsZCh1LmZpcnN0Q2hpbGQpfXJldHVybiBjfSxwYXJzZUF0dHJpYnV0ZXM6ZnVuY3Rpb24odCxzLG4pe2lmKHQpe3ZhciBhLGgsYz17fTtcInVuZGVmaW5lZFwiPT10eXBlb2YgbiYmKG49dC5nZXRBdHRyaWJ1dGUoXCJzdmdVaWRcIikpLHQucGFyZW50Tm9kZSYmL15zeW1ib2x8W2d8YV0kL2kudGVzdCh0LnBhcmVudE5vZGUubm9kZU5hbWUpJiYoYz1wLnBhcnNlQXR0cmlidXRlcyh0LnBhcmVudE5vZGUscyxuKSksaD1jJiZjLmZvbnRTaXplfHx0LmdldEF0dHJpYnV0ZShcImZvbnQtc2l6ZVwiKXx8cC5UZXh0LkRFRkFVTFRfU1ZHX0ZPTlRfU0laRTt2YXIgbD1zLnJlZHVjZShmdW5jdGlvbihyLHMpe3JldHVybiBhPXQuZ2V0QXR0cmlidXRlKHMpLGEmJihzPWUocyksYT1pKHMsYSxjLGgpLHJbc109YSkscn0se30pO3JldHVybiBsPXYobCx2KG8odCxuKSxwLnBhcnNlU3R5bGVBdHRyaWJ1dGUodCkpKSxsLmZvbnQmJnAucGFyc2VGb250RGVjbGFyYXRpb24obC5mb250LGwpLHIodihjLGwpKX19LHBhcnNlRWxlbWVudHM6ZnVuY3Rpb24odCxlLGkscil7bmV3IHAuRWxlbWVudHNQYXJzZXIodCxlLGkscikucGFyc2UoKX0scGFyc2VTdHlsZUF0dHJpYnV0ZTpmdW5jdGlvbih0KXt2YXIgZT17fSxpPXQuZ2V0QXR0cmlidXRlKFwic3R5bGVcIik7cmV0dXJuIGk/KFwic3RyaW5nXCI9PXR5cGVvZiBpP3MoaSxlKTpuKGksZSksZSk6ZX0scGFyc2VQb2ludHNBdHRyaWJ1dGU6ZnVuY3Rpb24odCl7aWYoIXQpcmV0dXJuIG51bGw7dD10LnJlcGxhY2UoLywvZyxcIiBcIikudHJpbSgpLHQ9dC5zcGxpdCgvXFxzKy8pO3ZhciBlLGkscj1bXTtmb3IoZT0wLGk9dC5sZW5ndGg7aT5lO2UrPTIpci5wdXNoKHt4OnBhcnNlRmxvYXQodFtlXSkseTpwYXJzZUZsb2F0KHRbZSsxXSl9KTtyZXR1cm4gcn0sZ2V0Q1NTUnVsZXM6ZnVuY3Rpb24odCl7Zm9yKHZhciByLHM9dC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInN0eWxlXCIpLG49e30sbz0wLGE9cy5sZW5ndGg7YT5vO28rKyl7dmFyIGg9c1tvXS50ZXh0Q29udGVudDtoPWgucmVwbGFjZSgvXFwvXFwqW1xcc1xcU10qP1xcKlxcLy9nLFwiXCIpLFwiXCIhPT1oLnRyaW0oKSYmKHI9aC5tYXRjaCgvW157XSpcXHtbXFxzXFxTXSo/XFx9L2cpLHI9ci5tYXAoZnVuY3Rpb24odCl7cmV0dXJuIHQudHJpbSgpfSksci5mb3JFYWNoKGZ1bmN0aW9uKHQpe2Zvcih2YXIgcj10Lm1hdGNoKC8oW1xcc1xcU10qPylcXHMqXFx7KFtefV0qKVxcfS8pLHM9e30sbz1yWzJdLnRyaW0oKSxhPW8ucmVwbGFjZSgvOyQvLFwiXCIpLnNwbGl0KC9cXHMqO1xccyovKSxoPTAsYz1hLmxlbmd0aDtjPmg7aCsrKXt2YXIgbD1hW2hdLnNwbGl0KC9cXHMqOlxccyovKSx1PWUobFswXSksZj1pKHUsbFsxXSxsWzBdKTtzW3VdPWZ9dD1yWzFdLHQuc3BsaXQoXCIsXCIpLmZvckVhY2goZnVuY3Rpb24odCl7dD10LnJlcGxhY2UoL15zdmcvaSxcIlwiKS50cmltKCksXCJcIiE9PXQmJihuW3RdPXAudXRpbC5vYmplY3QuY2xvbmUocykpfSl9KSl9cmV0dXJuIG59LGxvYWRTVkdGcm9tVVJMOmZ1bmN0aW9uKHQsZSxpKXtmdW5jdGlvbiByKHIpe3ZhciBzPXIucmVzcG9uc2VYTUw7cyYmIXMuZG9jdW1lbnRFbGVtZW50JiZwLndpbmRvdy5BY3RpdmVYT2JqZWN0JiZyLnJlc3BvbnNlVGV4dCYmKHM9bmV3IEFjdGl2ZVhPYmplY3QoXCJNaWNyb3NvZnQuWE1MRE9NXCIpLHMuYXN5bmM9XCJmYWxzZVwiLHMubG9hZFhNTChyLnJlc3BvbnNlVGV4dC5yZXBsYWNlKC88IURPQ1RZUEVbXFxzXFxTXSo/KFxcW1tcXHNcXFNdKlxcXSkqPz4vaSxcIlwiKSkpLHMmJnMuZG9jdW1lbnRFbGVtZW50JiZwLnBhcnNlU1ZHRG9jdW1lbnQocy5kb2N1bWVudEVsZW1lbnQsZnVuY3Rpb24oaSxyKXtPLnNldCh0LHtvYmplY3RzOnAudXRpbC5hcnJheS5pbnZva2UoaSxcInRvT2JqZWN0XCIpLG9wdGlvbnM6cn0pLGUoaSxyKX0saSl9dD10LnJlcGxhY2UoL15cXG5cXHMqLyxcIlwiKS50cmltKCksTy5oYXModCxmdW5jdGlvbihpKXtpP08uZ2V0KHQsZnVuY3Rpb24odCl7dmFyIGk9ZCh0KTtlKGkub2JqZWN0cyxpLm9wdGlvbnMpfSk6bmV3IHAudXRpbC5yZXF1ZXN0KHQse21ldGhvZDpcImdldFwiLG9uQ29tcGxldGU6cn0pfSl9LGxvYWRTVkdGcm9tU3RyaW5nOmZ1bmN0aW9uKHQsZSxpKXt0PXQudHJpbSgpO3ZhciByO2lmKFwidW5kZWZpbmVkXCIhPXR5cGVvZiBET01QYXJzZXIpe3ZhciBzPW5ldyBET01QYXJzZXI7cyYmcy5wYXJzZUZyb21TdHJpbmcmJihyPXMucGFyc2VGcm9tU3RyaW5nKHQsXCJ0ZXh0L3htbFwiKSl9ZWxzZSBwLndpbmRvdy5BY3RpdmVYT2JqZWN0JiYocj1uZXcgQWN0aXZlWE9iamVjdChcIk1pY3Jvc29mdC5YTUxET01cIiksci5hc3luYz1cImZhbHNlXCIsci5sb2FkWE1MKHQucmVwbGFjZSgvPCFET0NUWVBFW1xcc1xcU10qPyhcXFtbXFxzXFxTXSpcXF0pKj8+L2ksXCJcIikpKTtwLnBhcnNlU1ZHRG9jdW1lbnQoci5kb2N1bWVudEVsZW1lbnQsZnVuY3Rpb24odCxpKXtlKHQsaSl9LGkpfSxjcmVhdGVTVkdGb250RmFjZXNNYXJrdXA6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPVwiXCIsaT0wLHI9dC5sZW5ndGg7cj5pO2krKylcInRleHRcIj09PXRbaV0udHlwZSYmdFtpXS5wYXRoJiYoZSs9W1wiQGZvbnQtZmFjZSB7XCIsXCJmb250LWZhbWlseTogXCIsdFtpXS5mb250RmFtaWx5LFwiOyBcIixcInNyYzogdXJsKCdcIix0W2ldLnBhdGgsXCInKVwiLFwifVwiXS5qb2luKFwiXCIpKTtyZXR1cm4gZSYmKGU9Wyc8c3R5bGUgdHlwZT1cInRleHQvY3NzXCI+JyxcIjwhW0NEQVRBW1wiLGUsXCJdXT5cIixcIjwvc3R5bGU+XCJdLmpvaW4oXCJcIikpLGV9LGNyZWF0ZVNWR1JlZkVsZW1lbnRzTWFya3VwOmZ1bmN0aW9uKHQpe3ZhciBlPVtdO3JldHVybiBnKGUsdCxcImJhY2tncm91bmRDb2xvclwiKSxnKGUsdCxcIm92ZXJsYXlDb2xvclwiKSxlLmpvaW4oXCJcIil9fSl9KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZmFicmljLkVsZW1lbnRzUGFyc2VyPWZ1bmN0aW9uKHQsZSxpLHIpe3RoaXMuZWxlbWVudHM9dCx0aGlzLmNhbGxiYWNrPWUsdGhpcy5vcHRpb25zPWksdGhpcy5yZXZpdmVyPXIsdGhpcy5zdmdVaWQ9aSYmaS5zdmdVaWR8fDB9LGZhYnJpYy5FbGVtZW50c1BhcnNlci5wcm90b3R5cGUucGFyc2U9ZnVuY3Rpb24oKXt0aGlzLmluc3RhbmNlcz1uZXcgQXJyYXkodGhpcy5lbGVtZW50cy5sZW5ndGgpLHRoaXMubnVtRWxlbWVudHM9dGhpcy5lbGVtZW50cy5sZW5ndGgsdGhpcy5jcmVhdGVPYmplY3RzKCl9LGZhYnJpYy5FbGVtZW50c1BhcnNlci5wcm90b3R5cGUuY3JlYXRlT2JqZWN0cz1mdW5jdGlvbigpe2Zvcih2YXIgdD0wLGU9dGhpcy5lbGVtZW50cy5sZW5ndGg7ZT50O3QrKyl0aGlzLmVsZW1lbnRzW3RdLnNldEF0dHJpYnV0ZShcInN2Z1VpZFwiLHRoaXMuc3ZnVWlkKSxmdW5jdGlvbih0LGUpe3NldFRpbWVvdXQoZnVuY3Rpb24oKXt0LmNyZWF0ZU9iamVjdCh0LmVsZW1lbnRzW2VdLGUpfSwwKX0odGhpcyx0KX0sZmFicmljLkVsZW1lbnRzUGFyc2VyLnByb3RvdHlwZS5jcmVhdGVPYmplY3Q9ZnVuY3Rpb24odCxlKXt2YXIgaT1mYWJyaWNbZmFicmljLnV0aWwuc3RyaW5nLmNhcGl0YWxpemUodC50YWdOYW1lKV07aWYoaSYmaS5mcm9tRWxlbWVudCl0cnl7dGhpcy5fY3JlYXRlT2JqZWN0KGksdCxlKX1jYXRjaChyKXtmYWJyaWMubG9nKHIpfWVsc2UgdGhpcy5jaGVja0lmRG9uZSgpfSxmYWJyaWMuRWxlbWVudHNQYXJzZXIucHJvdG90eXBlLl9jcmVhdGVPYmplY3Q9ZnVuY3Rpb24odCxlLGkpe2lmKHQuYXN5bmMpdC5mcm9tRWxlbWVudChlLHRoaXMuY3JlYXRlQ2FsbGJhY2soaSxlKSx0aGlzLm9wdGlvbnMpO2Vsc2V7dmFyIHI9dC5mcm9tRWxlbWVudChlLHRoaXMub3B0aW9ucyk7dGhpcy5yZXNvbHZlR3JhZGllbnQocixcImZpbGxcIiksdGhpcy5yZXNvbHZlR3JhZGllbnQocixcInN0cm9rZVwiKSx0aGlzLnJldml2ZXImJnRoaXMucmV2aXZlcihlLHIpLHRoaXMuaW5zdGFuY2VzW2ldPXIsdGhpcy5jaGVja0lmRG9uZSgpfX0sZmFicmljLkVsZW1lbnRzUGFyc2VyLnByb3RvdHlwZS5jcmVhdGVDYWxsYmFjaz1mdW5jdGlvbih0LGUpe3ZhciBpPXRoaXM7cmV0dXJuIGZ1bmN0aW9uKHIpe2kucmVzb2x2ZUdyYWRpZW50KHIsXCJmaWxsXCIpLGkucmVzb2x2ZUdyYWRpZW50KHIsXCJzdHJva2VcIiksaS5yZXZpdmVyJiZpLnJldml2ZXIoZSxyKSxpLmluc3RhbmNlc1t0XT1yLGkuY2hlY2tJZkRvbmUoKX19LGZhYnJpYy5FbGVtZW50c1BhcnNlci5wcm90b3R5cGUucmVzb2x2ZUdyYWRpZW50PWZ1bmN0aW9uKHQsZSl7dmFyIGk9dC5nZXQoZSk7aWYoL151cmxcXCgvLnRlc3QoaSkpe3ZhciByPWkuc2xpY2UoNSxpLmxlbmd0aC0xKTtmYWJyaWMuZ3JhZGllbnREZWZzW3RoaXMuc3ZnVWlkXVtyXSYmdC5zZXQoZSxmYWJyaWMuR3JhZGllbnQuZnJvbUVsZW1lbnQoZmFicmljLmdyYWRpZW50RGVmc1t0aGlzLnN2Z1VpZF1bcl0sdCkpfX0sZmFicmljLkVsZW1lbnRzUGFyc2VyLnByb3RvdHlwZS5jaGVja0lmRG9uZT1mdW5jdGlvbigpezA9PT0tLXRoaXMubnVtRWxlbWVudHMmJih0aGlzLmluc3RhbmNlcz10aGlzLmluc3RhbmNlcy5maWx0ZXIoZnVuY3Rpb24odCl7cmV0dXJuIG51bGwhPXR9KSx0aGlzLmNhbGxiYWNrKHRoaXMuaW5zdGFuY2VzKSl9LGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGUodCxlKXt0aGlzLng9dCx0aGlzLnk9ZX12YXIgaT10LmZhYnJpY3x8KHQuZmFicmljPXt9KTtyZXR1cm4gaS5Qb2ludD92b2lkIGkud2FybihcImZhYnJpYy5Qb2ludCBpcyBhbHJlYWR5IGRlZmluZWRcIik6KGkuUG9pbnQ9ZSx2b2lkKGUucHJvdG90eXBlPXtjb25zdHJ1Y3RvcjplLGFkZDpmdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodGhpcy54K3QueCx0aGlzLnkrdC55KX0sYWRkRXF1YWxzOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLngrPXQueCx0aGlzLnkrPXQueSx0aGlzfSxzY2FsYXJBZGQ6ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHRoaXMueCt0LHRoaXMueSt0KX0sc2NhbGFyQWRkRXF1YWxzOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLngrPXQsdGhpcy55Kz10LHRoaXN9LHN1YnRyYWN0OmZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0aGlzLngtdC54LHRoaXMueS10LnkpfSxzdWJ0cmFjdEVxdWFsczpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy54LT10LngsdGhpcy55LT10LnksdGhpc30sc2NhbGFyU3VidHJhY3Q6ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHRoaXMueC10LHRoaXMueS10KX0sc2NhbGFyU3VidHJhY3RFcXVhbHM6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMueC09dCx0aGlzLnktPXQsdGhpc30sbXVsdGlwbHk6ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHRoaXMueCp0LHRoaXMueSp0KX0sbXVsdGlwbHlFcXVhbHM6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMueCo9dCx0aGlzLnkqPXQsdGhpc30sZGl2aWRlOmZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0aGlzLngvdCx0aGlzLnkvdCl9LGRpdmlkZUVxdWFsczpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy54Lz10LHRoaXMueS89dCx0aGlzfSxlcTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy54PT09dC54JiZ0aGlzLnk9PT10Lnl9LGx0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLng8dC54JiZ0aGlzLnk8dC55fSxsdGU6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMueDw9dC54JiZ0aGlzLnk8PXQueX0sZ3Q6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMueD50LngmJnRoaXMueT50Lnl9LGd0ZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy54Pj10LngmJnRoaXMueT49dC55fSxsZXJwOmZ1bmN0aW9uKHQsaSl7cmV0dXJuIG5ldyBlKHRoaXMueCsodC54LXRoaXMueCkqaSx0aGlzLnkrKHQueS10aGlzLnkpKmkpfSxkaXN0YW5jZUZyb206ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy54LXQueCxpPXRoaXMueS10Lnk7cmV0dXJuIE1hdGguc3FydChlKmUraSppKX0sbWlkUG9pbnRGcm9tOmZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0aGlzLngrKHQueC10aGlzLngpLzIsdGhpcy55Kyh0LnktdGhpcy55KS8yKX0sbWluOmZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZShNYXRoLm1pbih0aGlzLngsdC54KSxNYXRoLm1pbih0aGlzLnksdC55KSl9LG1heDpmdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUoTWF0aC5tYXgodGhpcy54LHQueCksTWF0aC5tYXgodGhpcy55LHQueSkpfSx0b1N0cmluZzpmdW5jdGlvbigpe3JldHVybiB0aGlzLngrXCIsXCIrdGhpcy55fSxzZXRYWTpmdW5jdGlvbih0LGUpe3RoaXMueD10LHRoaXMueT1lfSxzZXRGcm9tUG9pbnQ6ZnVuY3Rpb24odCl7dGhpcy54PXQueCx0aGlzLnk9dC55fSxzd2FwOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMueCxpPXRoaXMueTt0aGlzLng9dC54LHRoaXMueT10LnksdC54PWUsdC55PWl9fSkpfShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGUodCl7dGhpcy5zdGF0dXM9dCx0aGlzLnBvaW50cz1bXX12YXIgaT10LmZhYnJpY3x8KHQuZmFicmljPXt9KTtyZXR1cm4gaS5JbnRlcnNlY3Rpb24/dm9pZCBpLndhcm4oXCJmYWJyaWMuSW50ZXJzZWN0aW9uIGlzIGFscmVhZHkgZGVmaW5lZFwiKTooaS5JbnRlcnNlY3Rpb249ZSxpLkludGVyc2VjdGlvbi5wcm90b3R5cGU9e2FwcGVuZFBvaW50OmZ1bmN0aW9uKHQpe3RoaXMucG9pbnRzLnB1c2godCl9LGFwcGVuZFBvaW50czpmdW5jdGlvbih0KXt0aGlzLnBvaW50cz10aGlzLnBvaW50cy5jb25jYXQodCl9fSxpLkludGVyc2VjdGlvbi5pbnRlcnNlY3RMaW5lTGluZT1mdW5jdGlvbih0LHIscyxuKXt2YXIgbyxhPShuLngtcy54KSoodC55LXMueSktKG4ueS1zLnkpKih0Lngtcy54KSxoPShyLngtdC54KSoodC55LXMueSktKHIueS10LnkpKih0Lngtcy54KSxjPShuLnktcy55KSooci54LXQueCktKG4ueC1zLngpKihyLnktdC55KTtpZigwIT09Yyl7dmFyIGw9YS9jLHU9aC9jO2w+PTAmJjE+PWwmJnU+PTAmJjE+PXU/KG89bmV3IGUoXCJJbnRlcnNlY3Rpb25cIiksby5wb2ludHMucHVzaChuZXcgaS5Qb2ludCh0LngrbCooci54LXQueCksdC55K2wqKHIueS10LnkpKSkpOm89bmV3IGV9ZWxzZSBvPW5ldyBlKDA9PT1hfHwwPT09aD9cIkNvaW5jaWRlbnRcIjpcIlBhcmFsbGVsXCIpO3JldHVybiBvfSxpLkludGVyc2VjdGlvbi5pbnRlcnNlY3RMaW5lUG9seWdvbj1mdW5jdGlvbih0LGkscil7Zm9yKHZhciBzPW5ldyBlLG49ci5sZW5ndGgsbz0wO24+bztvKyspe3ZhciBhPXJbb10saD1yWyhvKzEpJW5dLGM9ZS5pbnRlcnNlY3RMaW5lTGluZSh0LGksYSxoKTtzLmFwcGVuZFBvaW50cyhjLnBvaW50cyl9cmV0dXJuIHMucG9pbnRzLmxlbmd0aD4wJiYocy5zdGF0dXM9XCJJbnRlcnNlY3Rpb25cIiksc30saS5JbnRlcnNlY3Rpb24uaW50ZXJzZWN0UG9seWdvblBvbHlnb249ZnVuY3Rpb24odCxpKXtmb3IodmFyIHI9bmV3IGUscz10Lmxlbmd0aCxuPTA7cz5uO24rKyl7dmFyIG89dFtuXSxhPXRbKG4rMSklc10saD1lLmludGVyc2VjdExpbmVQb2x5Z29uKG8sYSxpKTtyLmFwcGVuZFBvaW50cyhoLnBvaW50cyl9cmV0dXJuIHIucG9pbnRzLmxlbmd0aD4wJiYoci5zdGF0dXM9XCJJbnRlcnNlY3Rpb25cIikscn0sdm9pZChpLkludGVyc2VjdGlvbi5pbnRlcnNlY3RQb2x5Z29uUmVjdGFuZ2xlPWZ1bmN0aW9uKHQscixzKXt2YXIgbj1yLm1pbihzKSxvPXIubWF4KHMpLGE9bmV3IGkuUG9pbnQoby54LG4ueSksaD1uZXcgaS5Qb2ludChuLngsby55KSxjPWUuaW50ZXJzZWN0TGluZVBvbHlnb24obixhLHQpLGw9ZS5pbnRlcnNlY3RMaW5lUG9seWdvbihhLG8sdCksdT1lLmludGVyc2VjdExpbmVQb2x5Z29uKG8saCx0KSxmPWUuaW50ZXJzZWN0TGluZVBvbHlnb24oaCxuLHQpLGQ9bmV3IGU7cmV0dXJuIGQuYXBwZW5kUG9pbnRzKGMucG9pbnRzKSxkLmFwcGVuZFBvaW50cyhsLnBvaW50cyksZC5hcHBlbmRQb2ludHModS5wb2ludHMpLGQuYXBwZW5kUG9pbnRzKGYucG9pbnRzKSxkLnBvaW50cy5sZW5ndGg+MCYmKGQuc3RhdHVzPVwiSW50ZXJzZWN0aW9uXCIpLGR9KSl9KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gZSh0KXt0P3RoaXMuX3RyeVBhcnNpbmdDb2xvcih0KTp0aGlzLnNldFNvdXJjZShbMCwwLDAsMV0pfWZ1bmN0aW9uIGkodCxlLGkpe3JldHVybiAwPmkmJihpKz0xKSxpPjEmJihpLT0xKSwxLzY+aT90KzYqKGUtdCkqaTouNT5pP2U6Mi8zPmk/dCsoZS10KSooMi8zLWkpKjY6dH12YXIgcj10LmZhYnJpY3x8KHQuZmFicmljPXt9KTtyZXR1cm4gci5Db2xvcj92b2lkIHIud2FybihcImZhYnJpYy5Db2xvciBpcyBhbHJlYWR5IGRlZmluZWQuXCIpOihyLkNvbG9yPWUsci5Db2xvci5wcm90b3R5cGU9e190cnlQYXJzaW5nQ29sb3I6ZnVuY3Rpb24odCl7dmFyIGk7cmV0dXJuIHQgaW4gZS5jb2xvck5hbWVNYXAmJih0PWUuY29sb3JOYW1lTWFwW3RdKSxcInRyYW5zcGFyZW50XCI9PT10P3ZvaWQgdGhpcy5zZXRTb3VyY2UoWzI1NSwyNTUsMjU1LDBdKTooaT1lLnNvdXJjZUZyb21IZXgodCksaXx8KGk9ZS5zb3VyY2VGcm9tUmdiKHQpKSxpfHwoaT1lLnNvdXJjZUZyb21Ic2wodCkpLHZvaWQoaSYmdGhpcy5zZXRTb3VyY2UoaSkpKX0sX3JnYlRvSHNsOmZ1bmN0aW9uKHQsZSxpKXt0Lz0yNTUsZS89MjU1LGkvPTI1NTt2YXIgcyxuLG8sYT1yLnV0aWwuYXJyYXkubWF4KFt0LGUsaV0pLGg9ci51dGlsLmFycmF5Lm1pbihbdCxlLGldKTtpZihvPShhK2gpLzIsYT09PWgpcz1uPTA7ZWxzZXt2YXIgYz1hLWg7c3dpdGNoKG49bz4uNT9jLygyLWEtaCk6Yy8oYStoKSxhKXtjYXNlIHQ6cz0oZS1pKS9jKyhpPmU/NjowKTticmVhaztjYXNlIGU6cz0oaS10KS9jKzI7YnJlYWs7Y2FzZSBpOnM9KHQtZSkvYys0fXMvPTZ9cmV0dXJuW01hdGgucm91bmQoMzYwKnMpLE1hdGgucm91bmQoMTAwKm4pLE1hdGgucm91bmQoMTAwKm8pXX0sZ2V0U291cmNlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NvdXJjZX0sc2V0U291cmNlOmZ1bmN0aW9uKHQpe3RoaXMuX3NvdXJjZT10fSx0b1JnYjpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0U291cmNlKCk7cmV0dXJuXCJyZ2IoXCIrdFswXStcIixcIit0WzFdK1wiLFwiK3RbMl0rXCIpXCJ9LHRvUmdiYTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0U291cmNlKCk7cmV0dXJuXCJyZ2JhKFwiK3RbMF0rXCIsXCIrdFsxXStcIixcIit0WzJdK1wiLFwiK3RbM10rXCIpXCJ9LHRvSHNsOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXRTb3VyY2UoKSxlPXRoaXMuX3JnYlRvSHNsKHRbMF0sdFsxXSx0WzJdKTtyZXR1cm5cImhzbChcIitlWzBdK1wiLFwiK2VbMV0rXCIlLFwiK2VbMl0rXCIlKVwifSx0b0hzbGE6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmdldFNvdXJjZSgpLGU9dGhpcy5fcmdiVG9Ic2wodFswXSx0WzFdLHRbMl0pO3JldHVyblwiaHNsYShcIitlWzBdK1wiLFwiK2VbMV0rXCIlLFwiK2VbMl0rXCIlLFwiK3RbM10rXCIpXCJ9LHRvSGV4OmZ1bmN0aW9uKCl7dmFyIHQsZSxpLHI9dGhpcy5nZXRTb3VyY2UoKTtyZXR1cm4gdD1yWzBdLnRvU3RyaW5nKDE2KSx0PTE9PT10Lmxlbmd0aD9cIjBcIit0OnQsZT1yWzFdLnRvU3RyaW5nKDE2KSxlPTE9PT1lLmxlbmd0aD9cIjBcIitlOmUsaT1yWzJdLnRvU3RyaW5nKDE2KSxpPTE9PT1pLmxlbmd0aD9cIjBcIitpOmksdC50b1VwcGVyQ2FzZSgpK2UudG9VcHBlckNhc2UoKStpLnRvVXBwZXJDYXNlKCl9LGdldEFscGhhOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0U291cmNlKClbM119LHNldEFscGhhOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0U291cmNlKCk7cmV0dXJuIGVbM109dCx0aGlzLnNldFNvdXJjZShlKSx0aGlzfSx0b0dyYXlzY2FsZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0U291cmNlKCksZT1wYXJzZUludCgoLjMqdFswXSsuNTkqdFsxXSsuMTEqdFsyXSkudG9GaXhlZCgwKSwxMCksaT10WzNdO3JldHVybiB0aGlzLnNldFNvdXJjZShbZSxlLGUsaV0pLHRoaXN9LHRvQmxhY2tXaGl0ZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldFNvdXJjZSgpLGk9KC4zKmVbMF0rLjU5KmVbMV0rLjExKmVbMl0pLnRvRml4ZWQoMCkscj1lWzNdO3JldHVybiB0PXR8fDEyNyxpPU51bWJlcihpKTxOdW1iZXIodCk/MDoyNTUsdGhpcy5zZXRTb3VyY2UoW2ksaSxpLHJdKSx0aGlzfSxvdmVybGF5V2l0aDpmdW5jdGlvbih0KXt0IGluc3RhbmNlb2YgZXx8KHQ9bmV3IGUodCkpO2Zvcih2YXIgaT1bXSxyPXRoaXMuZ2V0QWxwaGEoKSxzPS41LG49dGhpcy5nZXRTb3VyY2UoKSxvPXQuZ2V0U291cmNlKCksYT0wOzM+YTthKyspaS5wdXNoKE1hdGgucm91bmQoblthXSooMS1zKStvW2FdKnMpKTtyZXR1cm4gaVszXT1yLHRoaXMuc2V0U291cmNlKGkpLHRoaXN9fSxyLkNvbG9yLnJlUkdCYT0vXnJnYmE/XFwoXFxzKihcXGR7MSwzfSg/OlxcLlxcZCspP1xcJT8pXFxzKixcXHMqKFxcZHsxLDN9KD86XFwuXFxkKyk/XFwlPylcXHMqLFxccyooXFxkezEsM30oPzpcXC5cXGQrKT9cXCU/KVxccyooPzpcXHMqLFxccyooXFxkKyg/OlxcLlxcZCspPylcXHMqKT9cXCkkLyxyLkNvbG9yLnJlSFNMYT0vXmhzbGE/XFwoXFxzKihcXGR7MSwzfSlcXHMqLFxccyooXFxkezEsM31cXCUpXFxzKixcXHMqKFxcZHsxLDN9XFwlKVxccyooPzpcXHMqLFxccyooXFxkKyg/OlxcLlxcZCspPylcXHMqKT9cXCkkLyxyLkNvbG9yLnJlSGV4PS9eIz8oWzAtOWEtZl17Nn18WzAtOWEtZl17M30pJC9pLHIuQ29sb3IuY29sb3JOYW1lTWFwPXthcXVhOlwiIzAwRkZGRlwiLGJsYWNrOlwiIzAwMDAwMFwiLGJsdWU6XCIjMDAwMEZGXCIsZnVjaHNpYTpcIiNGRjAwRkZcIixncmF5OlwiIzgwODA4MFwiLGdyZWVuOlwiIzAwODAwMFwiLGxpbWU6XCIjMDBGRjAwXCIsbWFyb29uOlwiIzgwMDAwMFwiLG5hdnk6XCIjMDAwMDgwXCIsb2xpdmU6XCIjODA4MDAwXCIsb3JhbmdlOlwiI0ZGQTUwMFwiLHB1cnBsZTpcIiM4MDAwODBcIixyZWQ6XCIjRkYwMDAwXCIsc2lsdmVyOlwiI0MwQzBDMFwiLHRlYWw6XCIjMDA4MDgwXCIsd2hpdGU6XCIjRkZGRkZGXCIseWVsbG93OlwiI0ZGRkYwMFwifSxyLkNvbG9yLmZyb21SZ2I9ZnVuY3Rpb24odCl7cmV0dXJuIGUuZnJvbVNvdXJjZShlLnNvdXJjZUZyb21SZ2IodCkpfSxyLkNvbG9yLnNvdXJjZUZyb21SZ2I9ZnVuY3Rpb24odCl7dmFyIGk9dC5tYXRjaChlLnJlUkdCYSk7aWYoaSl7dmFyIHI9cGFyc2VJbnQoaVsxXSwxMCkvKC8lJC8udGVzdChpWzFdKT8xMDA6MSkqKC8lJC8udGVzdChpWzFdKT8yNTU6MSkscz1wYXJzZUludChpWzJdLDEwKS8oLyUkLy50ZXN0KGlbMl0pPzEwMDoxKSooLyUkLy50ZXN0KGlbMl0pPzI1NToxKSxuPXBhcnNlSW50KGlbM10sMTApLygvJSQvLnRlc3QoaVszXSk/MTAwOjEpKigvJSQvLnRlc3QoaVszXSk/MjU1OjEpO3JldHVybltwYXJzZUludChyLDEwKSxwYXJzZUludChzLDEwKSxwYXJzZUludChuLDEwKSxpWzRdP3BhcnNlRmxvYXQoaVs0XSk6MV19fSxyLkNvbG9yLmZyb21SZ2JhPWUuZnJvbVJnYixyLkNvbG9yLmZyb21Ic2w9ZnVuY3Rpb24odCl7cmV0dXJuIGUuZnJvbVNvdXJjZShlLnNvdXJjZUZyb21Ic2wodCkpfSxyLkNvbG9yLnNvdXJjZUZyb21Ic2w9ZnVuY3Rpb24odCl7dmFyIHI9dC5tYXRjaChlLnJlSFNMYSk7aWYocil7dmFyIHMsbixvLGE9KHBhcnNlRmxvYXQoclsxXSklMzYwKzM2MCklMzYwLzM2MCxoPXBhcnNlRmxvYXQoclsyXSkvKC8lJC8udGVzdChyWzJdKT8xMDA6MSksYz1wYXJzZUZsb2F0KHJbM10pLygvJSQvLnRlc3QoclszXSk/MTAwOjEpO2lmKDA9PT1oKXM9bj1vPWM7ZWxzZXt2YXIgbD0uNT49Yz9jKihoKzEpOmMraC1jKmgsdT0yKmMtbDtzPWkodSxsLGErMS8zKSxuPWkodSxsLGEpLG89aSh1LGwsYS0xLzMpfXJldHVybltNYXRoLnJvdW5kKDI1NSpzKSxNYXRoLnJvdW5kKDI1NSpuKSxNYXRoLnJvdW5kKDI1NSpvKSxyWzRdP3BhcnNlRmxvYXQocls0XSk6MV19fSxyLkNvbG9yLmZyb21Ic2xhPWUuZnJvbUhzbCxyLkNvbG9yLmZyb21IZXg9ZnVuY3Rpb24odCl7cmV0dXJuIGUuZnJvbVNvdXJjZShlLnNvdXJjZUZyb21IZXgodCkpfSxyLkNvbG9yLnNvdXJjZUZyb21IZXg9ZnVuY3Rpb24odCl7aWYodC5tYXRjaChlLnJlSGV4KSl7dmFyIGk9dC5zbGljZSh0LmluZGV4T2YoXCIjXCIpKzEpLHI9Mz09PWkubGVuZ3RoLHM9cj9pLmNoYXJBdCgwKStpLmNoYXJBdCgwKTppLnN1YnN0cmluZygwLDIpLG49cj9pLmNoYXJBdCgxKStpLmNoYXJBdCgxKTppLnN1YnN0cmluZygyLDQpLG89cj9pLmNoYXJBdCgyKStpLmNoYXJBdCgyKTppLnN1YnN0cmluZyg0LDYpO3JldHVybltwYXJzZUludChzLDE2KSxwYXJzZUludChuLDE2KSxwYXJzZUludChvLDE2KSwxXX19LHZvaWQoci5Db2xvci5mcm9tU291cmNlPWZ1bmN0aW9uKHQpe3ZhciBpPW5ldyBlO3JldHVybiBpLnNldFNvdXJjZSh0KSxpfSkpfShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXt2YXIgZSxpLHIscz10LmdldEF0dHJpYnV0ZShcInN0eWxlXCIpLG49dC5nZXRBdHRyaWJ1dGUoXCJvZmZzZXRcIik7aWYobj1wYXJzZUZsb2F0KG4pLygvJSQvLnRlc3Qobik/MTAwOjEpLG49MD5uPzA6bj4xPzE6bixzKXt2YXIgbz1zLnNwbGl0KC9cXHMqO1xccyovKTtcIlwiPT09b1tvLmxlbmd0aC0xXSYmby5wb3AoKTtmb3IodmFyIGE9by5sZW5ndGg7YS0tOyl7dmFyIGg9b1thXS5zcGxpdCgvXFxzKjpcXHMqLyksYz1oWzBdLnRyaW0oKSxsPWhbMV0udHJpbSgpO1wic3RvcC1jb2xvclwiPT09Yz9lPWw6XCJzdG9wLW9wYWNpdHlcIj09PWMmJihyPWwpfX1yZXR1cm4gZXx8KGU9dC5nZXRBdHRyaWJ1dGUoXCJzdG9wLWNvbG9yXCIpfHxcInJnYigwLDAsMClcIikscnx8KHI9dC5nZXRBdHRyaWJ1dGUoXCJzdG9wLW9wYWNpdHlcIikpLGU9bmV3IGZhYnJpYy5Db2xvcihlKSxpPWUuZ2V0QWxwaGEoKSxyPWlzTmFOKHBhcnNlRmxvYXQocikpPzE6cGFyc2VGbG9hdChyKSxyKj1pLHtvZmZzZXQ6bixjb2xvcjplLnRvUmdiKCksb3BhY2l0eTpyfX1mdW5jdGlvbiBlKHQpe3JldHVybnt4MTp0LmdldEF0dHJpYnV0ZShcIngxXCIpfHwwLHkxOnQuZ2V0QXR0cmlidXRlKFwieTFcIil8fDAseDI6dC5nZXRBdHRyaWJ1dGUoXCJ4MlwiKXx8XCIxMDAlXCIseTI6dC5nZXRBdHRyaWJ1dGUoXCJ5MlwiKXx8MH19ZnVuY3Rpb24gaSh0KXtyZXR1cm57eDE6dC5nZXRBdHRyaWJ1dGUoXCJmeFwiKXx8dC5nZXRBdHRyaWJ1dGUoXCJjeFwiKXx8XCI1MCVcIix5MTp0LmdldEF0dHJpYnV0ZShcImZ5XCIpfHx0LmdldEF0dHJpYnV0ZShcImN5XCIpfHxcIjUwJVwiLHIxOjAseDI6dC5nZXRBdHRyaWJ1dGUoXCJjeFwiKXx8XCI1MCVcIix5Mjp0LmdldEF0dHJpYnV0ZShcImN5XCIpfHxcIjUwJVwiLHIyOnQuZ2V0QXR0cmlidXRlKFwiclwiKXx8XCI1MCVcIn19ZnVuY3Rpb24gcih0LGUsaSl7dmFyIHIscz0wLG49MSxvPVwiXCI7Zm9yKHZhciBhIGluIGUpcj1wYXJzZUZsb2F0KGVbYV0sMTApLG49XCJzdHJpbmdcIj09dHlwZW9mIGVbYV0mJi9eXFxkKyUkLy50ZXN0KGVbYV0pPy4wMToxLFwieDFcIj09PWF8fFwieDJcIj09PWF8fFwicjJcIj09PWE/KG4qPVwib2JqZWN0Qm91bmRpbmdCb3hcIj09PWk/dC53aWR0aDoxLHM9XCJvYmplY3RCb3VuZGluZ0JveFwiPT09aT90LmxlZnR8fDA6MCk6KFwieTFcIj09PWF8fFwieTJcIj09PWEpJiYobio9XCJvYmplY3RCb3VuZGluZ0JveFwiPT09aT90LmhlaWdodDoxLHM9XCJvYmplY3RCb3VuZGluZ0JveFwiPT09aT90LnRvcHx8MDowKSxlW2FdPXIqbitzO2lmKFwiZWxsaXBzZVwiPT09dC50eXBlJiZudWxsIT09ZS5yMiYmXCJvYmplY3RCb3VuZGluZ0JveFwiPT09aSYmdC5yeCE9PXQucnkpe3ZhciBoPXQucnkvdC5yeDtvPVwiIHNjYWxlKDEsIFwiK2grXCIpXCIsZS55MSYmKGUueTEvPWgpLGUueTImJihlLnkyLz1oKX1yZXR1cm4gb31mYWJyaWMuR3JhZGllbnQ9ZmFicmljLnV0aWwuY3JlYXRlQ2xhc3Moe29mZnNldFg6MCxvZmZzZXRZOjAsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0fHwodD17fSk7dmFyIGU9e307dGhpcy5pZD1mYWJyaWMuT2JqZWN0Ll9fdWlkKyssdGhpcy50eXBlPXQudHlwZXx8XCJsaW5lYXJcIixlPXt4MTp0LmNvb3Jkcy54MXx8MCx5MTp0LmNvb3Jkcy55MXx8MCx4Mjp0LmNvb3Jkcy54Mnx8MCx5Mjp0LmNvb3Jkcy55Mnx8MH0sXCJyYWRpYWxcIj09PXRoaXMudHlwZSYmKGUucjE9dC5jb29yZHMucjF8fDAsZS5yMj10LmNvb3Jkcy5yMnx8MCksdGhpcy5jb29yZHM9ZSx0aGlzLmNvbG9yU3RvcHM9dC5jb2xvclN0b3BzLnNsaWNlKCksdC5ncmFkaWVudFRyYW5zZm9ybSYmKHRoaXMuZ3JhZGllbnRUcmFuc2Zvcm09dC5ncmFkaWVudFRyYW5zZm9ybSksdGhpcy5vZmZzZXRYPXQub2Zmc2V0WHx8dGhpcy5vZmZzZXRYLHRoaXMub2Zmc2V0WT10Lm9mZnNldFl8fHRoaXMub2Zmc2V0WX0sYWRkQ29sb3JTdG9wOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZSBpbiB0KXt2YXIgaT1uZXcgZmFicmljLkNvbG9yKHRbZV0pO3RoaXMuY29sb3JTdG9wcy5wdXNoKHtvZmZzZXQ6ZSxjb2xvcjppLnRvUmdiKCksb3BhY2l0eTppLmdldEFscGhhKCl9KX1yZXR1cm4gdGhpc30sdG9PYmplY3Q6ZnVuY3Rpb24oKXtyZXR1cm57dHlwZTp0aGlzLnR5cGUsY29vcmRzOnRoaXMuY29vcmRzLGNvbG9yU3RvcHM6dGhpcy5jb2xvclN0b3BzLG9mZnNldFg6dGhpcy5vZmZzZXRYLG9mZnNldFk6dGhpcy5vZmZzZXRZfX0sdG9TVkc6ZnVuY3Rpb24odCl7dmFyIGUsaSxyPWZhYnJpYy51dGlsLm9iamVjdC5jbG9uZSh0aGlzLmNvb3Jkcyk7aWYodGhpcy5jb2xvclN0b3BzLnNvcnQoZnVuY3Rpb24odCxlKXtyZXR1cm4gdC5vZmZzZXQtZS5vZmZzZXR9KSwhdC5ncm91cHx8XCJwYXRoLWdyb3VwXCIhPT10Lmdyb3VwLnR5cGUpZm9yKHZhciBzIGluIHIpXCJ4MVwiPT09c3x8XCJ4MlwiPT09c3x8XCJyMlwiPT09cz9yW3NdKz10aGlzLm9mZnNldFgtdC53aWR0aC8yOihcInkxXCI9PT1zfHxcInkyXCI9PT1zKSYmKHJbc10rPXRoaXMub2Zmc2V0WS10LmhlaWdodC8yKTtpPSdpZD1cIlNWR0lEXycrdGhpcy5pZCsnXCIgZ3JhZGllbnRVbml0cz1cInVzZXJTcGFjZU9uVXNlXCInLHRoaXMuZ3JhZGllbnRUcmFuc2Zvcm0mJihpKz0nIGdyYWRpZW50VHJhbnNmb3JtPVwibWF0cml4KCcrdGhpcy5ncmFkaWVudFRyYW5zZm9ybS5qb2luKFwiIFwiKSsnKVwiICcpLFwibGluZWFyXCI9PT10aGlzLnR5cGU/ZT1bXCI8bGluZWFyR3JhZGllbnQgXCIsaSwnIHgxPVwiJyxyLngxLCdcIiB5MT1cIicsci55MSwnXCIgeDI9XCInLHIueDIsJ1wiIHkyPVwiJyxyLnkyLCdcIj5cXG4nXTpcInJhZGlhbFwiPT09dGhpcy50eXBlJiYoZT1bXCI8cmFkaWFsR3JhZGllbnQgXCIsaSwnIGN4PVwiJyxyLngyLCdcIiBjeT1cIicsci55MiwnXCIgcj1cIicsci5yMiwnXCIgZng9XCInLHIueDEsJ1wiIGZ5PVwiJyxyLnkxLCdcIj5cXG4nXSk7Zm9yKHZhciBuPTA7bjx0aGlzLmNvbG9yU3RvcHMubGVuZ3RoO24rKyllLnB1c2goXCI8c3RvcCBcIiwnb2Zmc2V0PVwiJywxMDAqdGhpcy5jb2xvclN0b3BzW25dLm9mZnNldCtcIiVcIiwnXCIgc3R5bGU9XCJzdG9wLWNvbG9yOicsdGhpcy5jb2xvclN0b3BzW25dLmNvbG9yLG51bGwhPXRoaXMuY29sb3JTdG9wc1tuXS5vcGFjaXR5P1wiO3N0b3Atb3BhY2l0eTogXCIrdGhpcy5jb2xvclN0b3BzW25dLm9wYWNpdHk6XCI7XCIsJ1wiLz5cXG4nKTtyZXR1cm4gZS5wdXNoKFwibGluZWFyXCI9PT10aGlzLnR5cGU/XCI8L2xpbmVhckdyYWRpZW50PlxcblwiOlwiPC9yYWRpYWxHcmFkaWVudD5cXG5cIiksZS5qb2luKFwiXCIpfSx0b0xpdmU6ZnVuY3Rpb24odCxlKXt2YXIgaSxyLHM9ZmFicmljLnV0aWwub2JqZWN0LmNsb25lKHRoaXMuY29vcmRzKTtpZih0aGlzLnR5cGUpe2lmKGUuZ3JvdXAmJlwicGF0aC1ncm91cFwiPT09ZS5ncm91cC50eXBlKWZvcihyIGluIHMpXCJ4MVwiPT09cnx8XCJ4MlwiPT09cj9zW3JdKz0tdGhpcy5vZmZzZXRYK2Uud2lkdGgvMjooXCJ5MVwiPT09cnx8XCJ5MlwiPT09cikmJihzW3JdKz0tdGhpcy5vZmZzZXRZK2UuaGVpZ2h0LzIpO1wibGluZWFyXCI9PT10aGlzLnR5cGU/aT10LmNyZWF0ZUxpbmVhckdyYWRpZW50KHMueDEscy55MSxzLngyLHMueTIpOlwicmFkaWFsXCI9PT10aGlzLnR5cGUmJihpPXQuY3JlYXRlUmFkaWFsR3JhZGllbnQocy54MSxzLnkxLHMucjEscy54MixzLnkyLHMucjIpKTtmb3IodmFyIG49MCxvPXRoaXMuY29sb3JTdG9wcy5sZW5ndGg7bz5uO24rKyl7dmFyIGE9dGhpcy5jb2xvclN0b3BzW25dLmNvbG9yLGg9dGhpcy5jb2xvclN0b3BzW25dLm9wYWNpdHksYz10aGlzLmNvbG9yU3RvcHNbbl0ub2Zmc2V0O1widW5kZWZpbmVkXCIhPXR5cGVvZiBoJiYoYT1uZXcgZmFicmljLkNvbG9yKGEpLnNldEFscGhhKGgpLnRvUmdiYSgpKSxpLmFkZENvbG9yU3RvcChwYXJzZUZsb2F0KGMpLGEpfXJldHVybiBpfX19KSxmYWJyaWMudXRpbC5vYmplY3QuZXh0ZW5kKGZhYnJpYy5HcmFkaWVudCx7ZnJvbUVsZW1lbnQ6ZnVuY3Rpb24ocyxuKXt2YXIgbyxhPXMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzdG9wXCIpLGg9XCJsaW5lYXJHcmFkaWVudFwiPT09cy5ub2RlTmFtZT9cImxpbmVhclwiOlwicmFkaWFsXCIsYz1zLmdldEF0dHJpYnV0ZShcImdyYWRpZW50VW5pdHNcIil8fFwib2JqZWN0Qm91bmRpbmdCb3hcIixsPXMuZ2V0QXR0cmlidXRlKFwiZ3JhZGllbnRUcmFuc2Zvcm1cIiksdT1bXSxmPXt9O1wibGluZWFyXCI9PT1oP2Y9ZShzKTpcInJhZGlhbFwiPT09aCYmKGY9aShzKSk7Zm9yKHZhciBkPWEubGVuZ3RoO2QtLTspdS5wdXNoKHQoYVtkXSkpO289cihuLGYsYyk7dmFyIGc9bmV3IGZhYnJpYy5HcmFkaWVudCh7dHlwZTpoLGNvb3JkczpmLGNvbG9yU3RvcHM6dSxvZmZzZXRYOi1uLmxlZnQsb2Zmc2V0WTotbi50b3B9KTtyZXR1cm4obHx8XCJcIiE9PW8pJiYoZy5ncmFkaWVudFRyYW5zZm9ybT1mYWJyaWMucGFyc2VUcmFuc2Zvcm1BdHRyaWJ1dGUoKGx8fFwiXCIpK28pKSxnfSxmb3JPYmplY3Q6ZnVuY3Rpb24odCxlKXtyZXR1cm4gZXx8KGU9e30pLHIodCxlLmNvb3JkcyxcInVzZXJTcGFjZU9uVXNlXCIpLG5ldyBmYWJyaWMuR3JhZGllbnQoZSl9fSl9KCksZmFicmljLlBhdHRlcm49ZmFicmljLnV0aWwuY3JlYXRlQ2xhc3Moe3JlcGVhdDpcInJlcGVhdFwiLG9mZnNldFg6MCxvZmZzZXRZOjAsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXtpZih0fHwodD17fSksdGhpcy5pZD1mYWJyaWMuT2JqZWN0Ll9fdWlkKyssdC5zb3VyY2UpaWYoXCJzdHJpbmdcIj09dHlwZW9mIHQuc291cmNlKWlmKFwidW5kZWZpbmVkXCIhPXR5cGVvZiBmYWJyaWMudXRpbC5nZXRGdW5jdGlvbkJvZHkodC5zb3VyY2UpKXRoaXMuc291cmNlPW5ldyBGdW5jdGlvbihmYWJyaWMudXRpbC5nZXRGdW5jdGlvbkJvZHkodC5zb3VyY2UpKTtlbHNle3ZhciBlPXRoaXM7dGhpcy5zb3VyY2U9ZmFicmljLnV0aWwuY3JlYXRlSW1hZ2UoKSxmYWJyaWMudXRpbC5sb2FkSW1hZ2UodC5zb3VyY2UsZnVuY3Rpb24odCl7ZS5zb3VyY2U9dH0pfWVsc2UgdGhpcy5zb3VyY2U9dC5zb3VyY2U7dC5yZXBlYXQmJih0aGlzLnJlcGVhdD10LnJlcGVhdCksdC5vZmZzZXRYJiYodGhpcy5vZmZzZXRYPXQub2Zmc2V0WCksdC5vZmZzZXRZJiYodGhpcy5vZmZzZXRZPXQub2Zmc2V0WSl9LHRvT2JqZWN0OmZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuXCJmdW5jdGlvblwiPT10eXBlb2YgdGhpcy5zb3VyY2U/dD1TdHJpbmcodGhpcy5zb3VyY2UpOlwic3RyaW5nXCI9PXR5cGVvZiB0aGlzLnNvdXJjZS5zcmMmJih0PXRoaXMuc291cmNlLnNyYykse3NvdXJjZTp0LHJlcGVhdDp0aGlzLnJlcGVhdCxvZmZzZXRYOnRoaXMub2Zmc2V0WCxvZmZzZXRZOnRoaXMub2Zmc2V0WX19LHRvU1ZHOmZ1bmN0aW9uKHQpe3ZhciBlPVwiZnVuY3Rpb25cIj09dHlwZW9mIHRoaXMuc291cmNlP3RoaXMuc291cmNlKCk6dGhpcy5zb3VyY2UsaT1lLndpZHRoL3QuZ2V0V2lkdGgoKSxyPWUuaGVpZ2h0L3QuZ2V0SGVpZ2h0KCkscz10aGlzLm9mZnNldFgvdC5nZXRXaWR0aCgpLG49dGhpcy5vZmZzZXRZL3QuZ2V0SGVpZ2h0KCksbz1cIlwiO3JldHVybihcInJlcGVhdC14XCI9PT10aGlzLnJlcGVhdHx8XCJuby1yZXBlYXRcIj09PXRoaXMucmVwZWF0KSYmKHI9MSksKFwicmVwZWF0LXlcIj09PXRoaXMucmVwZWF0fHxcIm5vLXJlcGVhdFwiPT09dGhpcy5yZXBlYXQpJiYoaT0xKSxlLnNyYz9vPWUuc3JjOmUudG9EYXRhVVJMJiYobz1lLnRvRGF0YVVSTCgpKSwnPHBhdHRlcm4gaWQ9XCJTVkdJRF8nK3RoaXMuaWQrJ1wiIHg9XCInK3MrJ1wiIHk9XCInK24rJ1wiIHdpZHRoPVwiJytpKydcIiBoZWlnaHQ9XCInK3IrJ1wiPlxcbjxpbWFnZSB4PVwiMFwiIHk9XCIwXCIgd2lkdGg9XCInK2Uud2lkdGgrJ1wiIGhlaWdodD1cIicrZS5oZWlnaHQrJ1wiIHhsaW5rOmhyZWY9XCInK28rJ1wiPjwvaW1hZ2U+XFxuPC9wYXR0ZXJuPlxcbid9LHRvTGl2ZTpmdW5jdGlvbih0KXt2YXIgZT1cImZ1bmN0aW9uXCI9PXR5cGVvZiB0aGlzLnNvdXJjZT90aGlzLnNvdXJjZSgpOnRoaXMuc291cmNlO2lmKCFlKXJldHVyblwiXCI7aWYoXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGUuc3JjKXtpZighZS5jb21wbGV0ZSlyZXR1cm5cIlwiO2lmKDA9PT1lLm5hdHVyYWxXaWR0aHx8MD09PWUubmF0dXJhbEhlaWdodClyZXR1cm5cIlwifXJldHVybiB0LmNyZWF0ZVBhdHRlcm4oZSx0aGlzLnJlcGVhdCl9fSksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSksaT1lLnV0aWwudG9GaXhlZDtyZXR1cm4gZS5TaGFkb3c/dm9pZCBlLndhcm4oXCJmYWJyaWMuU2hhZG93IGlzIGFscmVhZHkgZGVmaW5lZC5cIik6KGUuU2hhZG93PWUudXRpbC5jcmVhdGVDbGFzcyh7Y29sb3I6XCJyZ2IoMCwwLDApXCIsYmx1cjowLG9mZnNldFg6MCxvZmZzZXRZOjAsYWZmZWN0U3Ryb2tlOiExLGluY2x1ZGVEZWZhdWx0VmFsdWVzOiEwLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7XCJzdHJpbmdcIj09dHlwZW9mIHQmJih0PXRoaXMuX3BhcnNlU2hhZG93KHQpKTtmb3IodmFyIGkgaW4gdCl0aGlzW2ldPXRbaV07dGhpcy5pZD1lLk9iamVjdC5fX3VpZCsrfSxfcGFyc2VTaGFkb3c6ZnVuY3Rpb24odCl7dmFyIGk9dC50cmltKCkscj1lLlNoYWRvdy5yZU9mZnNldHNBbmRCbHVyLmV4ZWMoaSl8fFtdLHM9aS5yZXBsYWNlKGUuU2hhZG93LnJlT2Zmc2V0c0FuZEJsdXIsXCJcIil8fFwicmdiKDAsMCwwKVwiO3JldHVybntjb2xvcjpzLnRyaW0oKSxvZmZzZXRYOnBhcnNlSW50KHJbMV0sMTApfHwwLG9mZnNldFk6cGFyc2VJbnQoclsyXSwxMCl8fDAsYmx1cjpwYXJzZUludChyWzNdLDEwKXx8MH19LHRvU3RyaW5nOmZ1bmN0aW9uKCl7cmV0dXJuW3RoaXMub2Zmc2V0WCx0aGlzLm9mZnNldFksdGhpcy5ibHVyLHRoaXMuY29sb3JdLmpvaW4oXCJweCBcIil9LHRvU1ZHOmZ1bmN0aW9uKHQpe3ZhciBlPVwiU291cmNlQWxwaGFcIixyPTQwLHM9NDA7cmV0dXJuIXR8fHQuZmlsbCE9PXRoaXMuY29sb3ImJnQuc3Ryb2tlIT09dGhpcy5jb2xvcnx8KGU9XCJTb3VyY2VHcmFwaGljXCIpLHQud2lkdGgmJnQuaGVpZ2h0JiYocj0xMDAqaShNYXRoLmFicyh0aGlzLm9mZnNldFgvdC5nZXRXaWR0aCgpKSwyKSsyMCxzPTEwMCppKE1hdGguYWJzKHRoaXMub2Zmc2V0WS90LmdldEhlaWdodCgpKSwyKSsyMCksJzxmaWx0ZXIgaWQ9XCJTVkdJRF8nK3RoaXMuaWQrJ1wiIHk9XCItJytzKyclXCIgaGVpZ2h0PVwiJysoMTAwKzIqcykrJyVcIiB4PVwiLScrcisnJVwiIHdpZHRoPVwiJysoMTAwKzIqcikrJyVcIiA+XFxuXHQ8ZmVHYXVzc2lhbkJsdXIgaW49XCInK2UrJ1wiIHN0ZERldmlhdGlvbj1cIicraSh0aGlzLmJsdXI/dGhpcy5ibHVyLzI6MCwzKSsnXCIgcmVzdWx0PVwiYmx1ck91dFwiPjwvZmVHYXVzc2lhbkJsdXI+XFxuXHQ8ZmVDb2xvck1hdHJpeCByZXN1bHQ9XCJtYXRyaXhPdXRcIiBpbj1cImJsdXJPdXRcIiB0eXBlPVwibWF0cml4XCIgdmFsdWVzPVwiMSAwIDAgMCAwIDAgMSAwIDAgMCAwIDAgMSAwIDAgMCAwIDAgMC4zMCAwXCIgPjwvZmVDb2xvck1hdHJpeCA+XFxuXHQ8ZmVPZmZzZXQgZHg9XCInK3RoaXMub2Zmc2V0WCsnXCIgZHk9XCInK3RoaXMub2Zmc2V0WSsnXCI+PC9mZU9mZnNldD5cXG5cdDxmZU1lcmdlPlxcblx0XHQ8ZmVNZXJnZU5vZGU+PC9mZU1lcmdlTm9kZT5cXG5cdFx0PGZlTWVyZ2VOb2RlIGluPVwiU291cmNlR3JhcGhpY1wiPjwvZmVNZXJnZU5vZGU+XFxuXHQ8L2ZlTWVyZ2U+XFxuPC9maWx0ZXI+XFxuJ30sdG9PYmplY3Q6ZnVuY3Rpb24oKXtpZih0aGlzLmluY2x1ZGVEZWZhdWx0VmFsdWVzKXJldHVybntjb2xvcjp0aGlzLmNvbG9yLGJsdXI6dGhpcy5ibHVyLG9mZnNldFg6dGhpcy5vZmZzZXRYLG9mZnNldFk6dGhpcy5vZmZzZXRZfTt2YXIgdD17fSxpPWUuU2hhZG93LnByb3RvdHlwZTtyZXR1cm4gdGhpcy5jb2xvciE9PWkuY29sb3ImJih0LmNvbG9yPXRoaXMuY29sb3IpLHRoaXMuYmx1ciE9PWkuYmx1ciYmKHQuYmx1cj10aGlzLmJsdXIpLHRoaXMub2Zmc2V0WCE9PWkub2Zmc2V0WCYmKHQub2Zmc2V0WD10aGlzLm9mZnNldFgpLHRoaXMub2Zmc2V0WSE9PWkub2Zmc2V0WSYmKHQub2Zmc2V0WT10aGlzLm9mZnNldFkpLHR9fSksdm9pZChlLlNoYWRvdy5yZU9mZnNldHNBbmRCbHVyPS8oPzpcXHN8XikoLT9cXGQrKD86cHgpPyg/Olxccz98JCkpPygtP1xcZCsoPzpweCk/KD86XFxzP3wkKSk/KFxcZCsoPzpweCk/KT8oPzpcXHM/fCQpKD86JHxcXHMpLykpfShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKCl7XCJ1c2Ugc3RyaWN0XCI7aWYoZmFicmljLlN0YXRpY0NhbnZhcylyZXR1cm4gdm9pZCBmYWJyaWMud2FybihcImZhYnJpYy5TdGF0aWNDYW52YXMgaXMgYWxyZWFkeSBkZWZpbmVkLlwiKTt2YXIgdD1mYWJyaWMudXRpbC5vYmplY3QuZXh0ZW5kLGU9ZmFicmljLnV0aWwuZ2V0RWxlbWVudE9mZnNldCxpPWZhYnJpYy51dGlsLnJlbW92ZUZyb21BcnJheSxyPW5ldyBFcnJvcihcIkNvdWxkIG5vdCBpbml0aWFsaXplIGBjYW52YXNgIGVsZW1lbnRcIik7ZmFicmljLlN0YXRpY0NhbnZhcz1mYWJyaWMudXRpbC5jcmVhdGVDbGFzcyh7aW5pdGlhbGl6ZTpmdW5jdGlvbih0LGUpe2V8fChlPXt9KSx0aGlzLl9pbml0U3RhdGljKHQsZSksZmFicmljLlN0YXRpY0NhbnZhcy5hY3RpdmVJbnN0YW5jZT10aGlzfSxiYWNrZ3JvdW5kQ29sb3I6XCJcIixiYWNrZ3JvdW5kSW1hZ2U6bnVsbCxvdmVybGF5Q29sb3I6XCJcIixvdmVybGF5SW1hZ2U6bnVsbCxpbmNsdWRlRGVmYXVsdFZhbHVlczohMCxzdGF0ZWZ1bDohMCxyZW5kZXJPbkFkZFJlbW92ZTohMCxjbGlwVG86bnVsbCxjb250cm9sc0Fib3ZlT3ZlcmxheTohMSxhbGxvd1RvdWNoU2Nyb2xsaW5nOiExLGltYWdlU21vb3RoaW5nRW5hYmxlZDohMCxwcmVzZXJ2ZU9iamVjdFN0YWNraW5nOiExLHZpZXdwb3J0VHJhbnNmb3JtOlsxLDAsMCwxLDAsMF0sb25CZWZvcmVTY2FsZVJvdGF0ZTpmdW5jdGlvbigpe30sX2luaXRTdGF0aWM6ZnVuY3Rpb24odCxlKXt0aGlzLl9vYmplY3RzPVtdLHRoaXMuX2NyZWF0ZUxvd2VyQ2FudmFzKHQpLHRoaXMuX2luaXRPcHRpb25zKGUpLHRoaXMuX3NldEltYWdlU21vb3RoaW5nKCksZS5vdmVybGF5SW1hZ2UmJnRoaXMuc2V0T3ZlcmxheUltYWdlKGUub3ZlcmxheUltYWdlLHRoaXMucmVuZGVyQWxsLmJpbmQodGhpcykpLGUuYmFja2dyb3VuZEltYWdlJiZ0aGlzLnNldEJhY2tncm91bmRJbWFnZShlLmJhY2tncm91bmRJbWFnZSx0aGlzLnJlbmRlckFsbC5iaW5kKHRoaXMpKSxlLmJhY2tncm91bmRDb2xvciYmdGhpcy5zZXRCYWNrZ3JvdW5kQ29sb3IoZS5iYWNrZ3JvdW5kQ29sb3IsdGhpcy5yZW5kZXJBbGwuYmluZCh0aGlzKSksZS5vdmVybGF5Q29sb3ImJnRoaXMuc2V0T3ZlcmxheUNvbG9yKGUub3ZlcmxheUNvbG9yLHRoaXMucmVuZGVyQWxsLmJpbmQodGhpcykpLHRoaXMuY2FsY09mZnNldCgpfSxjYWxjT2Zmc2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29mZnNldD1lKHRoaXMubG93ZXJDYW52YXNFbCksdGhpc30sc2V0T3ZlcmxheUltYWdlOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdGhpcy5fX3NldEJnT3ZlcmxheUltYWdlKFwib3ZlcmxheUltYWdlXCIsdCxlLGkpfSxzZXRCYWNrZ3JvdW5kSW1hZ2U6ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0aGlzLl9fc2V0QmdPdmVybGF5SW1hZ2UoXCJiYWNrZ3JvdW5kSW1hZ2VcIix0LGUsaSl9LHNldE92ZXJsYXlDb2xvcjpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLl9fc2V0QmdPdmVybGF5Q29sb3IoXCJvdmVybGF5Q29sb3JcIix0LGUpfSxzZXRCYWNrZ3JvdW5kQ29sb3I6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5fX3NldEJnT3ZlcmxheUNvbG9yKFwiYmFja2dyb3VuZENvbG9yXCIsdCxlKX0sX3NldEltYWdlU21vb3RoaW5nOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXRDb250ZXh0KCk7dC5pbWFnZVNtb290aGluZ0VuYWJsZWQ9dGhpcy5pbWFnZVNtb290aGluZ0VuYWJsZWQsdC53ZWJraXRJbWFnZVNtb290aGluZ0VuYWJsZWQ9dGhpcy5pbWFnZVNtb290aGluZ0VuYWJsZWQsdC5tb3pJbWFnZVNtb290aGluZ0VuYWJsZWQ9dGhpcy5pbWFnZVNtb290aGluZ0VuYWJsZWQsdC5tc0ltYWdlU21vb3RoaW5nRW5hYmxlZD10aGlzLmltYWdlU21vb3RoaW5nRW5hYmxlZCx0Lm9JbWFnZVNtb290aGluZ0VuYWJsZWQ9dGhpcy5pbWFnZVNtb290aGluZ0VuYWJsZWR9LF9fc2V0QmdPdmVybGF5SW1hZ2U6ZnVuY3Rpb24odCxlLGkscil7cmV0dXJuXCJzdHJpbmdcIj09dHlwZW9mIGU/ZmFicmljLnV0aWwubG9hZEltYWdlKGUsZnVuY3Rpb24oZSl7dGhpc1t0XT1uZXcgZmFicmljLkltYWdlKGUsciksaSYmaSgpfSx0aGlzLHImJnIuY3Jvc3NPcmlnaW4pOihyJiZlLnNldE9wdGlvbnMociksdGhpc1t0XT1lLGkmJmkoKSksdGhpc30sX19zZXRCZ092ZXJsYXlDb2xvcjpmdW5jdGlvbih0LGUsaSl7aWYoZSYmZS5zb3VyY2Upe3ZhciByPXRoaXM7ZmFicmljLnV0aWwubG9hZEltYWdlKGUuc291cmNlLGZ1bmN0aW9uKHMpe3JbdF09bmV3IGZhYnJpYy5QYXR0ZXJuKHtzb3VyY2U6cyxyZXBlYXQ6ZS5yZXBlYXQsb2Zmc2V0WDplLm9mZnNldFgsb2Zmc2V0WTplLm9mZnNldFl9KSxpJiZpKCl9KX1lbHNlIHRoaXNbdF09ZSxpJiZpKCk7cmV0dXJuIHRoaXN9LF9jcmVhdGVDYW52YXNFbGVtZW50OmZ1bmN0aW9uKCl7dmFyIHQ9ZmFicmljLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7aWYodC5zdHlsZXx8KHQuc3R5bGU9e30pLCF0KXRocm93IHI7cmV0dXJuIHRoaXMuX2luaXRDYW52YXNFbGVtZW50KHQpLHR9LF9pbml0Q2FudmFzRWxlbWVudDpmdW5jdGlvbih0KXtpZihmYWJyaWMudXRpbC5jcmVhdGVDYW52YXNFbGVtZW50KHQpLFwidW5kZWZpbmVkXCI9PXR5cGVvZiB0LmdldENvbnRleHQpdGhyb3cgcn0sX2luaXRPcHRpb25zOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZSBpbiB0KXRoaXNbZV09dFtlXTt0aGlzLndpZHRoPXRoaXMud2lkdGh8fHBhcnNlSW50KHRoaXMubG93ZXJDYW52YXNFbC53aWR0aCwxMCl8fDAsdGhpcy5oZWlnaHQ9dGhpcy5oZWlnaHR8fHBhcnNlSW50KHRoaXMubG93ZXJDYW52YXNFbC5oZWlnaHQsMTApfHwwLHRoaXMubG93ZXJDYW52YXNFbC5zdHlsZSYmKHRoaXMubG93ZXJDYW52YXNFbC53aWR0aD10aGlzLndpZHRoLHRoaXMubG93ZXJDYW52YXNFbC5oZWlnaHQ9dGhpcy5oZWlnaHQsdGhpcy5sb3dlckNhbnZhc0VsLnN0eWxlLndpZHRoPXRoaXMud2lkdGgrXCJweFwiLHRoaXMubG93ZXJDYW52YXNFbC5zdHlsZS5oZWlnaHQ9dGhpcy5oZWlnaHQrXCJweFwiLHRoaXMudmlld3BvcnRUcmFuc2Zvcm09dGhpcy52aWV3cG9ydFRyYW5zZm9ybS5zbGljZSgpKX0sX2NyZWF0ZUxvd2VyQ2FudmFzOmZ1bmN0aW9uKHQpe3RoaXMubG93ZXJDYW52YXNFbD1mYWJyaWMudXRpbC5nZXRCeUlkKHQpfHx0aGlzLl9jcmVhdGVDYW52YXNFbGVtZW50KCksdGhpcy5faW5pdENhbnZhc0VsZW1lbnQodGhpcy5sb3dlckNhbnZhc0VsKSxmYWJyaWMudXRpbC5hZGRDbGFzcyh0aGlzLmxvd2VyQ2FudmFzRWwsXCJsb3dlci1jYW52YXNcIiksdGhpcy5pbnRlcmFjdGl2ZSYmdGhpcy5fYXBwbHlDYW52YXNTdHlsZSh0aGlzLmxvd2VyQ2FudmFzRWwpLHRoaXMuY29udGV4dENvbnRhaW5lcj10aGlzLmxvd2VyQ2FudmFzRWwuZ2V0Q29udGV4dChcIjJkXCIpfSxnZXRXaWR0aDpmdW5jdGlvbigpe3JldHVybiB0aGlzLndpZHRofSxnZXRIZWlnaHQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oZWlnaHR9LHNldFdpZHRoOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuc2V0RGltZW5zaW9ucyh7d2lkdGg6dH0sZSl9LHNldEhlaWdodDpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLnNldERpbWVuc2lvbnMoe2hlaWdodDp0fSxlKX0sc2V0RGltZW5zaW9uczpmdW5jdGlvbih0LGUpe3ZhciBpO2U9ZXx8e307Zm9yKHZhciByIGluIHQpaT10W3JdLGUuY3NzT25seXx8KHRoaXMuX3NldEJhY2tzdG9yZURpbWVuc2lvbihyLHRbcl0pLGkrPVwicHhcIiksZS5iYWNrc3RvcmVPbmx5fHx0aGlzLl9zZXRDc3NEaW1lbnNpb24ocixpKTtyZXR1cm4gZS5jc3NPbmx5fHx0aGlzLnJlbmRlckFsbCgpLHRoaXMuY2FsY09mZnNldCgpLHRoaXN9LF9zZXRCYWNrc3RvcmVEaW1lbnNpb246ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5sb3dlckNhbnZhc0VsW3RdPWUsdGhpcy51cHBlckNhbnZhc0VsJiYodGhpcy51cHBlckNhbnZhc0VsW3RdPWUpLHRoaXMuY2FjaGVDYW52YXNFbCYmKHRoaXMuY2FjaGVDYW52YXNFbFt0XT1lKSx0aGlzW3RdPWUsdGhpc30sX3NldENzc0RpbWVuc2lvbjpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLmxvd2VyQ2FudmFzRWwuc3R5bGVbdF09ZSx0aGlzLnVwcGVyQ2FudmFzRWwmJih0aGlzLnVwcGVyQ2FudmFzRWwuc3R5bGVbdF09ZSksdGhpcy53cmFwcGVyRWwmJih0aGlzLndyYXBwZXJFbC5zdHlsZVt0XT1lKSx0aGlzfSxnZXRab29tOmZ1bmN0aW9uKCl7cmV0dXJuIE1hdGguc3FydCh0aGlzLnZpZXdwb3J0VHJhbnNmb3JtWzBdKnRoaXMudmlld3BvcnRUcmFuc2Zvcm1bM10pfSxzZXRWaWV3cG9ydFRyYW5zZm9ybTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldEFjdGl2ZUdyb3VwKCk7dGhpcy52aWV3cG9ydFRyYW5zZm9ybT10LHRoaXMucmVuZGVyQWxsKCk7Zm9yKHZhciBpPTAscj10aGlzLl9vYmplY3RzLmxlbmd0aDtyPmk7aSsrKXRoaXMuX29iamVjdHNbaV0uc2V0Q29vcmRzKCk7cmV0dXJuIGUmJmUuc2V0Q29vcmRzKCksdGhpc30sem9vbVRvUG9pbnQ6ZnVuY3Rpb24odCxlKXt2YXIgaT10O3Q9ZmFicmljLnV0aWwudHJhbnNmb3JtUG9pbnQodCxmYWJyaWMudXRpbC5pbnZlcnRUcmFuc2Zvcm0odGhpcy52aWV3cG9ydFRyYW5zZm9ybSkpLHRoaXMudmlld3BvcnRUcmFuc2Zvcm1bMF09ZSx0aGlzLnZpZXdwb3J0VHJhbnNmb3JtWzNdPWU7dmFyIHI9ZmFicmljLnV0aWwudHJhbnNmb3JtUG9pbnQodCx0aGlzLnZpZXdwb3J0VHJhbnNmb3JtKTt0aGlzLnZpZXdwb3J0VHJhbnNmb3JtWzRdKz1pLngtci54LHRoaXMudmlld3BvcnRUcmFuc2Zvcm1bNV0rPWkueS1yLnksdGhpcy5yZW5kZXJBbGwoKTtmb3IodmFyIHM9MCxuPXRoaXMuX29iamVjdHMubGVuZ3RoO24+cztzKyspdGhpcy5fb2JqZWN0c1tzXS5zZXRDb29yZHMoKTtyZXR1cm4gdGhpc30sc2V0Wm9vbTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy56b29tVG9Qb2ludChuZXcgZmFicmljLlBvaW50KDAsMCksdCksdGhpc30sYWJzb2x1dGVQYW46ZnVuY3Rpb24odCl7dGhpcy52aWV3cG9ydFRyYW5zZm9ybVs0XT0tdC54LHRoaXMudmlld3BvcnRUcmFuc2Zvcm1bNV09LXQueSx0aGlzLnJlbmRlckFsbCgpO2Zvcih2YXIgZT0wLGk9dGhpcy5fb2JqZWN0cy5sZW5ndGg7aT5lO2UrKyl0aGlzLl9vYmplY3RzW2VdLnNldENvb3JkcygpO3JldHVybiB0aGlzfSxyZWxhdGl2ZVBhbjpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5hYnNvbHV0ZVBhbihuZXcgZmFicmljLlBvaW50KC10LngtdGhpcy52aWV3cG9ydFRyYW5zZm9ybVs0XSwtdC55LXRoaXMudmlld3BvcnRUcmFuc2Zvcm1bNV0pKX0sZ2V0RWxlbWVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmxvd2VyQ2FudmFzRWx9LGdldEFjdGl2ZU9iamVjdDpmdW5jdGlvbigpe3JldHVybiBudWxsfSxnZXRBY3RpdmVHcm91cDpmdW5jdGlvbigpe3JldHVybiBudWxsfSxfZHJhdzpmdW5jdGlvbih0LGUpe2lmKGUpe3Quc2F2ZSgpO3ZhciBpPXRoaXMudmlld3BvcnRUcmFuc2Zvcm07dC50cmFuc2Zvcm0oaVswXSxpWzFdLGlbMl0saVszXSxpWzRdLGlbNV0pLHRoaXMuX3Nob3VsZFJlbmRlck9iamVjdChlKSYmZS5yZW5kZXIodCksdC5yZXN0b3JlKCksdGhpcy5jb250cm9sc0Fib3ZlT3ZlcmxheXx8ZS5fcmVuZGVyQ29udHJvbHModCl9fSxfc2hvdWxkUmVuZGVyT2JqZWN0OmZ1bmN0aW9uKHQpe3JldHVybiB0P3QhPT10aGlzLmdldEFjdGl2ZUdyb3VwKCl8fCF0aGlzLnByZXNlcnZlT2JqZWN0U3RhY2tpbmc6ITF9LF9vbk9iamVjdEFkZGVkOmZ1bmN0aW9uKHQpe3RoaXMuc3RhdGVmdWwmJnQuc2V0dXBTdGF0ZSgpLHQuX3NldChcImNhbnZhc1wiLHRoaXMpLHQuc2V0Q29vcmRzKCksdGhpcy5maXJlKFwib2JqZWN0OmFkZGVkXCIse3RhcmdldDp0fSksdC5maXJlKFwiYWRkZWRcIil9LF9vbk9iamVjdFJlbW92ZWQ6ZnVuY3Rpb24odCl7dGhpcy5nZXRBY3RpdmVPYmplY3QoKT09PXQmJih0aGlzLmZpcmUoXCJiZWZvcmU6c2VsZWN0aW9uOmNsZWFyZWRcIix7dGFyZ2V0OnR9KSx0aGlzLl9kaXNjYXJkQWN0aXZlT2JqZWN0KCksdGhpcy5maXJlKFwic2VsZWN0aW9uOmNsZWFyZWRcIikpLHRoaXMuZmlyZShcIm9iamVjdDpyZW1vdmVkXCIse3RhcmdldDp0fSksdC5maXJlKFwicmVtb3ZlZFwiKX0sY2xlYXJDb250ZXh0OmZ1bmN0aW9uKHQpe3JldHVybiB0LmNsZWFyUmVjdCgwLDAsdGhpcy53aWR0aCx0aGlzLmhlaWdodCksdGhpc30sZ2V0Q29udGV4dDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnRleHRDb250YWluZXJ9LGNsZWFyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29iamVjdHMubGVuZ3RoPTAsdGhpcy5kaXNjYXJkQWN0aXZlR3JvdXAmJnRoaXMuZGlzY2FyZEFjdGl2ZUdyb3VwKCksdGhpcy5kaXNjYXJkQWN0aXZlT2JqZWN0JiZ0aGlzLmRpc2NhcmRBY3RpdmVPYmplY3QoKSx0aGlzLmNsZWFyQ29udGV4dCh0aGlzLmNvbnRleHRDb250YWluZXIpLHRoaXMuY29udGV4dFRvcCYmdGhpcy5jbGVhckNvbnRleHQodGhpcy5jb250ZXh0VG9wKSx0aGlzLmZpcmUoXCJjYW52YXM6Y2xlYXJlZFwiKSx0aGlzLnJlbmRlckFsbCgpLHRoaXN9LHJlbmRlckFsbDpmdW5jdGlvbih0KXt2YXIgZT10aGlzW3Q9PT0hMCYmdGhpcy5pbnRlcmFjdGl2ZT9cImNvbnRleHRUb3BcIjpcImNvbnRleHRDb250YWluZXJcIl0saT10aGlzLmdldEFjdGl2ZUdyb3VwKCk7cmV0dXJuIHRoaXMuY29udGV4dFRvcCYmdGhpcy5zZWxlY3Rpb24mJiF0aGlzLl9ncm91cFNlbGVjdG9yJiZ0aGlzLmNsZWFyQ29udGV4dCh0aGlzLmNvbnRleHRUb3ApLHR8fHRoaXMuY2xlYXJDb250ZXh0KGUpLHRoaXMuZmlyZShcImJlZm9yZTpyZW5kZXJcIiksdGhpcy5jbGlwVG8mJmZhYnJpYy51dGlsLmNsaXBDb250ZXh0KHRoaXMsZSksdGhpcy5fcmVuZGVyQmFja2dyb3VuZChlKSx0aGlzLl9yZW5kZXJPYmplY3RzKGUsaSksdGhpcy5fcmVuZGVyQWN0aXZlR3JvdXAoZSxpKSx0aGlzLmNsaXBUbyYmZS5yZXN0b3JlKCksdGhpcy5fcmVuZGVyT3ZlcmxheShlKSx0aGlzLmNvbnRyb2xzQWJvdmVPdmVybGF5JiZ0aGlzLmludGVyYWN0aXZlJiZ0aGlzLmRyYXdDb250cm9scyhlKSx0aGlzLmZpcmUoXCJhZnRlcjpyZW5kZXJcIiksdGhpc30sX3JlbmRlck9iamVjdHM6ZnVuY3Rpb24odCxlKXt2YXIgaSxyO2lmKCFlfHx0aGlzLnByZXNlcnZlT2JqZWN0U3RhY2tpbmcpZm9yKGk9MCxyPXRoaXMuX29iamVjdHMubGVuZ3RoO3I+aTsrK2kpdGhpcy5fZHJhdyh0LHRoaXMuX29iamVjdHNbaV0pO2Vsc2UgZm9yKGk9MCxyPXRoaXMuX29iamVjdHMubGVuZ3RoO3I+aTsrK2kpdGhpcy5fb2JqZWN0c1tpXSYmIWUuY29udGFpbnModGhpcy5fb2JqZWN0c1tpXSkmJnRoaXMuX2RyYXcodCx0aGlzLl9vYmplY3RzW2ldKX0sX3JlbmRlckFjdGl2ZUdyb3VwOmZ1bmN0aW9uKHQsZSl7aWYoZSl7dmFyIGk9W107dGhpcy5mb3JFYWNoT2JqZWN0KGZ1bmN0aW9uKHQpe2UuY29udGFpbnModCkmJmkucHVzaCh0KX0pLGUuX3NldChcIl9vYmplY3RzXCIsaS5yZXZlcnNlKCkpLHRoaXMuX2RyYXcodCxlKX19LF9yZW5kZXJCYWNrZ3JvdW5kOmZ1bmN0aW9uKHQpe3RoaXMuYmFja2dyb3VuZENvbG9yJiYodC5maWxsU3R5bGU9dGhpcy5iYWNrZ3JvdW5kQ29sb3IudG9MaXZlP3RoaXMuYmFja2dyb3VuZENvbG9yLnRvTGl2ZSh0KTp0aGlzLmJhY2tncm91bmRDb2xvcix0LmZpbGxSZWN0KHRoaXMuYmFja2dyb3VuZENvbG9yLm9mZnNldFh8fDAsdGhpcy5iYWNrZ3JvdW5kQ29sb3Iub2Zmc2V0WXx8MCx0aGlzLndpZHRoLHRoaXMuaGVpZ2h0KSksdGhpcy5iYWNrZ3JvdW5kSW1hZ2UmJnRoaXMuX2RyYXcodCx0aGlzLmJhY2tncm91bmRJbWFnZSl9LF9yZW5kZXJPdmVybGF5OmZ1bmN0aW9uKHQpe3RoaXMub3ZlcmxheUNvbG9yJiYodC5maWxsU3R5bGU9dGhpcy5vdmVybGF5Q29sb3IudG9MaXZlP3RoaXMub3ZlcmxheUNvbG9yLnRvTGl2ZSh0KTp0aGlzLm92ZXJsYXlDb2xvcix0LmZpbGxSZWN0KHRoaXMub3ZlcmxheUNvbG9yLm9mZnNldFh8fDAsdGhpcy5vdmVybGF5Q29sb3Iub2Zmc2V0WXx8MCx0aGlzLndpZHRoLHRoaXMuaGVpZ2h0KSksdGhpcy5vdmVybGF5SW1hZ2UmJnRoaXMuX2RyYXcodCx0aGlzLm92ZXJsYXlJbWFnZSl9LHJlbmRlclRvcDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuY29udGV4dFRvcHx8dGhpcy5jb250ZXh0Q29udGFpbmVyO3RoaXMuY2xlYXJDb250ZXh0KHQpLHRoaXMuc2VsZWN0aW9uJiZ0aGlzLl9ncm91cFNlbGVjdG9yJiZ0aGlzLl9kcmF3U2VsZWN0aW9uKCk7dmFyIGU9dGhpcy5nZXRBY3RpdmVHcm91cCgpO3JldHVybiBlJiZlLnJlbmRlcih0KSx0aGlzLl9yZW5kZXJPdmVybGF5KHQpLHRoaXMuZmlyZShcImFmdGVyOnJlbmRlclwiKSx0aGlzfSxnZXRDZW50ZXI6ZnVuY3Rpb24oKXtyZXR1cm57dG9wOnRoaXMuZ2V0SGVpZ2h0KCkvMixsZWZ0OnRoaXMuZ2V0V2lkdGgoKS8yfX0sY2VudGVyT2JqZWN0SDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fY2VudGVyT2JqZWN0KHQsbmV3IGZhYnJpYy5Qb2ludCh0aGlzLmdldENlbnRlcigpLmxlZnQsdC5nZXRDZW50ZXJQb2ludCgpLnkpKSx0aGlzLnJlbmRlckFsbCgpLHRoaXN9LGNlbnRlck9iamVjdFY6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2NlbnRlck9iamVjdCh0LG5ldyBmYWJyaWMuUG9pbnQodC5nZXRDZW50ZXJQb2ludCgpLngsdGhpcy5nZXRDZW50ZXIoKS50b3ApKSx0aGlzLnJlbmRlckFsbCgpLHRoaXN9LGNlbnRlck9iamVjdDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldENlbnRlcigpO3JldHVybiB0aGlzLl9jZW50ZXJPYmplY3QodCxuZXcgZmFicmljLlBvaW50KGUubGVmdCxlLnRvcCkpLHRoaXMucmVuZGVyQWxsKCksdGhpc30sX2NlbnRlck9iamVjdDpmdW5jdGlvbih0LGUpe3JldHVybiB0LnNldFBvc2l0aW9uQnlPcmlnaW4oZSxcImNlbnRlclwiLFwiY2VudGVyXCIpLHRoaXN9LHRvRGF0YWxlc3NKU09OOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnRvRGF0YWxlc3NPYmplY3QodCl9LHRvT2JqZWN0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl90b09iamVjdE1ldGhvZChcInRvT2JqZWN0XCIsdCl9LHRvRGF0YWxlc3NPYmplY3Q6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX3RvT2JqZWN0TWV0aG9kKFwidG9EYXRhbGVzc09iamVjdFwiLHQpfSxfdG9PYmplY3RNZXRob2Q6ZnVuY3Rpb24oZSxpKXt2YXIgcj17b2JqZWN0czp0aGlzLl90b09iamVjdHMoZSxpKX07cmV0dXJuIHQocix0aGlzLl9fc2VyaWFsaXplQmdPdmVybGF5KCkpLGZhYnJpYy51dGlsLnBvcHVsYXRlV2l0aFByb3BlcnRpZXModGhpcyxyLGkpLHJ9LF90b09iamVjdHM6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5nZXRPYmplY3RzKCkubWFwKGZ1bmN0aW9uKGkpe3JldHVybiB0aGlzLl90b09iamVjdChpLHQsZSl9LHRoaXMpfSxfdG9PYmplY3Q6ZnVuY3Rpb24odCxlLGkpe3ZhciByO3RoaXMuaW5jbHVkZURlZmF1bHRWYWx1ZXN8fChyPXQuaW5jbHVkZURlZmF1bHRWYWx1ZXMsdC5pbmNsdWRlRGVmYXVsdFZhbHVlcz0hMSk7dmFyIHM9dGhpcy5fcmVhbGl6ZUdyb3VwVHJhbnNmb3JtT25PYmplY3QodCksbj10W2VdKGkpO3JldHVybiB0aGlzLmluY2x1ZGVEZWZhdWx0VmFsdWVzfHwodC5pbmNsdWRlRGVmYXVsdFZhbHVlcz1yKSx0aGlzLl91bndpbmRHcm91cFRyYW5zZm9ybU9uT2JqZWN0KHQscyksbn0sX3JlYWxpemVHcm91cFRyYW5zZm9ybU9uT2JqZWN0OmZ1bmN0aW9uKHQpe3ZhciBlPVtcImFuZ2xlXCIsXCJmbGlwWFwiLFwiZmxpcFlcIixcImhlaWdodFwiLFwibGVmdFwiLFwic2NhbGVYXCIsXCJzY2FsZVlcIixcInRvcFwiLFwid2lkdGhcIl07aWYodC5ncm91cCYmdC5ncm91cD09PXRoaXMuZ2V0QWN0aXZlR3JvdXAoKSl7dmFyIGk9e307cmV0dXJuIGUuZm9yRWFjaChmdW5jdGlvbihlKXtpW2VdPXRbZV19KSx0aGlzLmdldEFjdGl2ZUdyb3VwKCkucmVhbGl6ZVRyYW5zZm9ybSh0KSxpfXJldHVybiBudWxsfSxfdW53aW5kR3JvdXBUcmFuc2Zvcm1Pbk9iamVjdDpmdW5jdGlvbih0LGUpe2UmJnQuc2V0KGUpfSxfX3NlcmlhbGl6ZUJnT3ZlcmxheTpmdW5jdGlvbigpe3ZhciB0PXtiYWNrZ3JvdW5kOnRoaXMuYmFja2dyb3VuZENvbG9yJiZ0aGlzLmJhY2tncm91bmRDb2xvci50b09iamVjdD90aGlzLmJhY2tncm91bmRDb2xvci50b09iamVjdCgpOnRoaXMuYmFja2dyb3VuZENvbG9yfTtyZXR1cm4gdGhpcy5vdmVybGF5Q29sb3ImJih0Lm92ZXJsYXk9dGhpcy5vdmVybGF5Q29sb3IudG9PYmplY3Q/dGhpcy5vdmVybGF5Q29sb3IudG9PYmplY3QoKTp0aGlzLm92ZXJsYXlDb2xvciksdGhpcy5iYWNrZ3JvdW5kSW1hZ2UmJih0LmJhY2tncm91bmRJbWFnZT10aGlzLmJhY2tncm91bmRJbWFnZS50b09iamVjdCgpKSx0aGlzLm92ZXJsYXlJbWFnZSYmKHQub3ZlcmxheUltYWdlPXRoaXMub3ZlcmxheUltYWdlLnRvT2JqZWN0KCkpLHR9LHN2Z1ZpZXdwb3J0VHJhbnNmb3JtYXRpb246ITAsdG9TVkc6ZnVuY3Rpb24odCxlKXt0fHwodD17fSk7dmFyIGk9W107cmV0dXJuIHRoaXMuX3NldFNWR1ByZWFtYmxlKGksdCksdGhpcy5fc2V0U1ZHSGVhZGVyKGksdCksdGhpcy5fc2V0U1ZHQmdPdmVybGF5Q29sb3IoaSxcImJhY2tncm91bmRDb2xvclwiKSx0aGlzLl9zZXRTVkdCZ092ZXJsYXlJbWFnZShpLFwiYmFja2dyb3VuZEltYWdlXCIpLHRoaXMuX3NldFNWR09iamVjdHMoaSxlKSx0aGlzLl9zZXRTVkdCZ092ZXJsYXlDb2xvcihpLFwib3ZlcmxheUNvbG9yXCIpLHRoaXMuX3NldFNWR0JnT3ZlcmxheUltYWdlKGksXCJvdmVybGF5SW1hZ2VcIiksaS5wdXNoKFwiPC9zdmc+XCIpLGkuam9pbihcIlwiKX0sX3NldFNWR1ByZWFtYmxlOmZ1bmN0aW9uKHQsZSl7ZS5zdXBwcmVzc1ByZWFtYmxlfHx0LnB1c2goJzw/eG1sIHZlcnNpb249XCIxLjBcIiBlbmNvZGluZz1cIicsZS5lbmNvZGluZ3x8XCJVVEYtOFwiLCdcIiBzdGFuZGFsb25lPVwibm9cIiA/PicsJzwhRE9DVFlQRSBzdmcgUFVCTElDIFwiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU5cIiAnLCdcImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZFwiPlxcbicpfSxfc2V0U1ZHSGVhZGVyOmZ1bmN0aW9uKHQsZSl7dmFyIGkscixzO2Uudmlld0JveD8oaT1lLnZpZXdCb3gud2lkdGgscj1lLnZpZXdCb3guaGVpZ2h0KTooaT10aGlzLndpZHRoLHI9dGhpcy5oZWlnaHQsdGhpcy5zdmdWaWV3cG9ydFRyYW5zZm9ybWF0aW9ufHwocz10aGlzLnZpZXdwb3J0VHJhbnNmb3JtLGkvPXNbMF0sci89c1szXSkpLHQucHVzaChcIjxzdmcgXCIsJ3htbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiAnLCd4bWxuczp4bGluaz1cImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIiAnLCd2ZXJzaW9uPVwiMS4xXCIgJywnd2lkdGg9XCInLGksJ1wiICcsJ2hlaWdodD1cIicsciwnXCIgJyx0aGlzLmJhY2tncm91bmRDb2xvciYmIXRoaXMuYmFja2dyb3VuZENvbG9yLnRvTGl2ZT8nc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiAnK3RoaXMuYmFja2dyb3VuZENvbG9yKydcIiAnOm51bGwsZS52aWV3Qm94Pyd2aWV3Qm94PVwiJytlLnZpZXdCb3gueCtcIiBcIitlLnZpZXdCb3gueStcIiBcIitlLnZpZXdCb3gud2lkdGgrXCIgXCIrZS52aWV3Qm94LmhlaWdodCsnXCIgJzpudWxsLCd4bWw6c3BhY2U9XCJwcmVzZXJ2ZVwiPicsXCI8ZGVzYz5DcmVhdGVkIHdpdGggRmFicmljLmpzIFwiLGZhYnJpYy52ZXJzaW9uLFwiPC9kZXNjPlwiLFwiPGRlZnM+XCIsZmFicmljLmNyZWF0ZVNWR0ZvbnRGYWNlc01hcmt1cCh0aGlzLmdldE9iamVjdHMoKSksZmFicmljLmNyZWF0ZVNWR1JlZkVsZW1lbnRzTWFya3VwKHRoaXMpLFwiPC9kZWZzPlwiKTtcclxuXHJcbn0sX3NldFNWR09iamVjdHM6ZnVuY3Rpb24odCxlKXtmb3IodmFyIGk9MCxyPXRoaXMuZ2V0T2JqZWN0cygpLHM9ci5sZW5ndGg7cz5pO2krKyl7dmFyIG49cltpXSxvPXRoaXMuX3JlYWxpemVHcm91cFRyYW5zZm9ybU9uT2JqZWN0KG4pO3QucHVzaChuLnRvU1ZHKGUpKSx0aGlzLl91bndpbmRHcm91cFRyYW5zZm9ybU9uT2JqZWN0KG4sbyl9fSxfc2V0U1ZHQmdPdmVybGF5SW1hZ2U6ZnVuY3Rpb24odCxlKXt0aGlzW2VdJiZ0aGlzW2VdLnRvU1ZHJiZ0LnB1c2godGhpc1tlXS50b1NWRygpKX0sX3NldFNWR0JnT3ZlcmxheUNvbG9yOmZ1bmN0aW9uKHQsZSl7dGhpc1tlXSYmdGhpc1tlXS5zb3VyY2U/dC5wdXNoKCc8cmVjdCB4PVwiJyx0aGlzW2VdLm9mZnNldFgsJ1wiIHk9XCInLHRoaXNbZV0ub2Zmc2V0WSwnXCIgJywnd2lkdGg9XCInLFwicmVwZWF0LXlcIj09PXRoaXNbZV0ucmVwZWF0fHxcIm5vLXJlcGVhdFwiPT09dGhpc1tlXS5yZXBlYXQ/dGhpc1tlXS5zb3VyY2Uud2lkdGg6dGhpcy53aWR0aCwnXCIgaGVpZ2h0PVwiJyxcInJlcGVhdC14XCI9PT10aGlzW2VdLnJlcGVhdHx8XCJuby1yZXBlYXRcIj09PXRoaXNbZV0ucmVwZWF0P3RoaXNbZV0uc291cmNlLmhlaWdodDp0aGlzLmhlaWdodCwnXCIgZmlsbD1cInVybCgjJytlKydQYXR0ZXJuKVwiJyxcIj48L3JlY3Q+XCIpOnRoaXNbZV0mJlwib3ZlcmxheUNvbG9yXCI9PT1lJiZ0LnB1c2goJzxyZWN0IHg9XCIwXCIgeT1cIjBcIiAnLCd3aWR0aD1cIicsdGhpcy53aWR0aCwnXCIgaGVpZ2h0PVwiJyx0aGlzLmhlaWdodCwnXCIgZmlsbD1cIicsdGhpc1tlXSwnXCInLFwiPjwvcmVjdD5cIil9LHNlbmRUb0JhY2s6ZnVuY3Rpb24odCl7cmV0dXJuIGkodGhpcy5fb2JqZWN0cyx0KSx0aGlzLl9vYmplY3RzLnVuc2hpZnQodCksdGhpcy5yZW5kZXJBbGwmJnRoaXMucmVuZGVyQWxsKCl9LGJyaW5nVG9Gcm9udDpmdW5jdGlvbih0KXtyZXR1cm4gaSh0aGlzLl9vYmplY3RzLHQpLHRoaXMuX29iamVjdHMucHVzaCh0KSx0aGlzLnJlbmRlckFsbCYmdGhpcy5yZW5kZXJBbGwoKX0sc2VuZEJhY2t3YXJkczpmdW5jdGlvbih0LGUpe3ZhciByPXRoaXMuX29iamVjdHMuaW5kZXhPZih0KTtpZigwIT09cil7dmFyIHM9dGhpcy5fZmluZE5ld0xvd2VySW5kZXgodCxyLGUpO2kodGhpcy5fb2JqZWN0cyx0KSx0aGlzLl9vYmplY3RzLnNwbGljZShzLDAsdCksdGhpcy5yZW5kZXJBbGwmJnRoaXMucmVuZGVyQWxsKCl9cmV0dXJuIHRoaXN9LF9maW5kTmV3TG93ZXJJbmRleDpmdW5jdGlvbih0LGUsaSl7dmFyIHI7aWYoaSl7cj1lO2Zvcih2YXIgcz1lLTE7cz49MDstLXMpe3ZhciBuPXQuaW50ZXJzZWN0c1dpdGhPYmplY3QodGhpcy5fb2JqZWN0c1tzXSl8fHQuaXNDb250YWluZWRXaXRoaW5PYmplY3QodGhpcy5fb2JqZWN0c1tzXSl8fHRoaXMuX29iamVjdHNbc10uaXNDb250YWluZWRXaXRoaW5PYmplY3QodCk7aWYobil7cj1zO2JyZWFrfX19ZWxzZSByPWUtMTtyZXR1cm4gcn0sYnJpbmdGb3J3YXJkOmZ1bmN0aW9uKHQsZSl7dmFyIHI9dGhpcy5fb2JqZWN0cy5pbmRleE9mKHQpO2lmKHIhPT10aGlzLl9vYmplY3RzLmxlbmd0aC0xKXt2YXIgcz10aGlzLl9maW5kTmV3VXBwZXJJbmRleCh0LHIsZSk7aSh0aGlzLl9vYmplY3RzLHQpLHRoaXMuX29iamVjdHMuc3BsaWNlKHMsMCx0KSx0aGlzLnJlbmRlckFsbCYmdGhpcy5yZW5kZXJBbGwoKX1yZXR1cm4gdGhpc30sX2ZpbmROZXdVcHBlckluZGV4OmZ1bmN0aW9uKHQsZSxpKXt2YXIgcjtpZihpKXtyPWU7Zm9yKHZhciBzPWUrMTtzPHRoaXMuX29iamVjdHMubGVuZ3RoOysrcyl7dmFyIG49dC5pbnRlcnNlY3RzV2l0aE9iamVjdCh0aGlzLl9vYmplY3RzW3NdKXx8dC5pc0NvbnRhaW5lZFdpdGhpbk9iamVjdCh0aGlzLl9vYmplY3RzW3NdKXx8dGhpcy5fb2JqZWN0c1tzXS5pc0NvbnRhaW5lZFdpdGhpbk9iamVjdCh0KTtpZihuKXtyPXM7YnJlYWt9fX1lbHNlIHI9ZSsxO3JldHVybiByfSxtb3ZlVG86ZnVuY3Rpb24odCxlKXtyZXR1cm4gaSh0aGlzLl9vYmplY3RzLHQpLHRoaXMuX29iamVjdHMuc3BsaWNlKGUsMCx0KSx0aGlzLnJlbmRlckFsbCYmdGhpcy5yZW5kZXJBbGwoKX0sZGlzcG9zZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNsZWFyKCksdGhpcy5pbnRlcmFjdGl2ZSYmdGhpcy5yZW1vdmVMaXN0ZW5lcnMoKSx0aGlzfSx0b1N0cmluZzpmdW5jdGlvbigpe3JldHVyblwiIzxmYWJyaWMuQ2FudmFzIChcIit0aGlzLmNvbXBsZXhpdHkoKStcIik6IHsgb2JqZWN0czogXCIrdGhpcy5nZXRPYmplY3RzKCkubGVuZ3RoK1wiIH0+XCJ9fSksdChmYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZSxmYWJyaWMuT2JzZXJ2YWJsZSksdChmYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZSxmYWJyaWMuQ29sbGVjdGlvbiksdChmYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZSxmYWJyaWMuRGF0YVVSTEV4cG9ydGVyKSx0KGZhYnJpYy5TdGF0aWNDYW52YXMse0VNUFRZX0pTT046J3tcIm9iamVjdHNcIjogW10sIFwiYmFja2dyb3VuZFwiOiBcIndoaXRlXCJ9JyxzdXBwb3J0czpmdW5jdGlvbih0KXt2YXIgZT1mYWJyaWMudXRpbC5jcmVhdGVDYW52YXNFbGVtZW50KCk7aWYoIWV8fCFlLmdldENvbnRleHQpcmV0dXJuIG51bGw7dmFyIGk9ZS5nZXRDb250ZXh0KFwiMmRcIik7aWYoIWkpcmV0dXJuIG51bGw7c3dpdGNoKHQpe2Nhc2VcImdldEltYWdlRGF0YVwiOnJldHVyblwidW5kZWZpbmVkXCIhPXR5cGVvZiBpLmdldEltYWdlRGF0YTtjYXNlXCJzZXRMaW5lRGFzaFwiOnJldHVyblwidW5kZWZpbmVkXCIhPXR5cGVvZiBpLnNldExpbmVEYXNoO2Nhc2VcInRvRGF0YVVSTFwiOnJldHVyblwidW5kZWZpbmVkXCIhPXR5cGVvZiBlLnRvRGF0YVVSTDtjYXNlXCJ0b0RhdGFVUkxXaXRoUXVhbGl0eVwiOnRyeXtyZXR1cm4gZS50b0RhdGFVUkwoXCJpbWFnZS9qcGVnXCIsMCksITB9Y2F0Y2gocil7fXJldHVybiExO2RlZmF1bHQ6cmV0dXJuIG51bGx9fX0pLGZhYnJpYy5TdGF0aWNDYW52YXMucHJvdG90eXBlLnRvSlNPTj1mYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZS50b09iamVjdH0oKSxmYWJyaWMuQmFzZUJydXNoPWZhYnJpYy51dGlsLmNyZWF0ZUNsYXNzKHtjb2xvcjpcInJnYigwLCAwLCAwKVwiLHdpZHRoOjEsc2hhZG93Om51bGwsc3Ryb2tlTGluZUNhcDpcInJvdW5kXCIsc3Ryb2tlTGluZUpvaW46XCJyb3VuZFwiLHN0cm9rZURhc2hBcnJheTpudWxsLHNldFNoYWRvdzpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5zaGFkb3c9bmV3IGZhYnJpYy5TaGFkb3codCksdGhpc30sX3NldEJydXNoU3R5bGVzOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5jYW52YXMuY29udGV4dFRvcDt0LnN0cm9rZVN0eWxlPXRoaXMuY29sb3IsdC5saW5lV2lkdGg9dGhpcy53aWR0aCx0LmxpbmVDYXA9dGhpcy5zdHJva2VMaW5lQ2FwLHQubGluZUpvaW49dGhpcy5zdHJva2VMaW5lSm9pbix0aGlzLnN0cm9rZURhc2hBcnJheSYmZmFicmljLlN0YXRpY0NhbnZhcy5zdXBwb3J0cyhcInNldExpbmVEYXNoXCIpJiZ0LnNldExpbmVEYXNoKHRoaXMuc3Ryb2tlRGFzaEFycmF5KX0sX3NldFNoYWRvdzpmdW5jdGlvbigpe2lmKHRoaXMuc2hhZG93KXt2YXIgdD10aGlzLmNhbnZhcy5jb250ZXh0VG9wO3Quc2hhZG93Q29sb3I9dGhpcy5zaGFkb3cuY29sb3IsdC5zaGFkb3dCbHVyPXRoaXMuc2hhZG93LmJsdXIsdC5zaGFkb3dPZmZzZXRYPXRoaXMuc2hhZG93Lm9mZnNldFgsdC5zaGFkb3dPZmZzZXRZPXRoaXMuc2hhZG93Lm9mZnNldFl9fSxfcmVzZXRTaGFkb3c6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmNhbnZhcy5jb250ZXh0VG9wO3Quc2hhZG93Q29sb3I9XCJcIix0LnNoYWRvd0JsdXI9dC5zaGFkb3dPZmZzZXRYPXQuc2hhZG93T2Zmc2V0WT0wfX0pLGZ1bmN0aW9uKCl7ZmFicmljLlBlbmNpbEJydXNoPWZhYnJpYy51dGlsLmNyZWF0ZUNsYXNzKGZhYnJpYy5CYXNlQnJ1c2gse2luaXRpYWxpemU6ZnVuY3Rpb24odCl7dGhpcy5jYW52YXM9dCx0aGlzLl9wb2ludHM9W119LG9uTW91c2VEb3duOmZ1bmN0aW9uKHQpe3RoaXMuX3ByZXBhcmVGb3JEcmF3aW5nKHQpLHRoaXMuX2NhcHR1cmVEcmF3aW5nUGF0aCh0KSx0aGlzLl9yZW5kZXIoKX0sb25Nb3VzZU1vdmU6ZnVuY3Rpb24odCl7dGhpcy5fY2FwdHVyZURyYXdpbmdQYXRoKHQpLHRoaXMuY2FudmFzLmNsZWFyQ29udGV4dCh0aGlzLmNhbnZhcy5jb250ZXh0VG9wKSx0aGlzLl9yZW5kZXIoKX0sb25Nb3VzZVVwOmZ1bmN0aW9uKCl7dGhpcy5fZmluYWxpemVBbmRBZGRQYXRoKCl9LF9wcmVwYXJlRm9yRHJhd2luZzpmdW5jdGlvbih0KXt2YXIgZT1uZXcgZmFicmljLlBvaW50KHQueCx0LnkpO3RoaXMuX3Jlc2V0KCksdGhpcy5fYWRkUG9pbnQoZSksdGhpcy5jYW52YXMuY29udGV4dFRvcC5tb3ZlVG8oZS54LGUueSl9LF9hZGRQb2ludDpmdW5jdGlvbih0KXt0aGlzLl9wb2ludHMucHVzaCh0KX0sX3Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5fcG9pbnRzLmxlbmd0aD0wLHRoaXMuX3NldEJydXNoU3R5bGVzKCksdGhpcy5fc2V0U2hhZG93KCl9LF9jYXB0dXJlRHJhd2luZ1BhdGg6ZnVuY3Rpb24odCl7dmFyIGU9bmV3IGZhYnJpYy5Qb2ludCh0LngsdC55KTt0aGlzLl9hZGRQb2ludChlKX0sX3JlbmRlcjpmdW5jdGlvbigpe3ZhciB0PXRoaXMuY2FudmFzLmNvbnRleHRUb3AsZT10aGlzLmNhbnZhcy52aWV3cG9ydFRyYW5zZm9ybSxpPXRoaXMuX3BvaW50c1swXSxyPXRoaXMuX3BvaW50c1sxXTt0LnNhdmUoKSx0LnRyYW5zZm9ybShlWzBdLGVbMV0sZVsyXSxlWzNdLGVbNF0sZVs1XSksdC5iZWdpblBhdGgoKSwyPT09dGhpcy5fcG9pbnRzLmxlbmd0aCYmaS54PT09ci54JiZpLnk9PT1yLnkmJihpLngtPS41LHIueCs9LjUpLHQubW92ZVRvKGkueCxpLnkpO2Zvcih2YXIgcz0xLG49dGhpcy5fcG9pbnRzLmxlbmd0aDtuPnM7cysrKXt2YXIgbz1pLm1pZFBvaW50RnJvbShyKTt0LnF1YWRyYXRpY0N1cnZlVG8oaS54LGkueSxvLngsby55KSxpPXRoaXMuX3BvaW50c1tzXSxyPXRoaXMuX3BvaW50c1tzKzFdfXQubGluZVRvKGkueCxpLnkpLHQuc3Ryb2tlKCksdC5yZXN0b3JlKCl9LGNvbnZlcnRQb2ludHNUb1NWR1BhdGg6ZnVuY3Rpb24odCl7dmFyIGU9W10saT1uZXcgZmFicmljLlBvaW50KHRbMF0ueCx0WzBdLnkpLHI9bmV3IGZhYnJpYy5Qb2ludCh0WzFdLngsdFsxXS55KTtlLnB1c2goXCJNIFwiLHRbMF0ueCxcIiBcIix0WzBdLnksXCIgXCIpO2Zvcih2YXIgcz0xLG49dC5sZW5ndGg7bj5zO3MrKyl7dmFyIG89aS5taWRQb2ludEZyb20ocik7ZS5wdXNoKFwiUSBcIixpLngsXCIgXCIsaS55LFwiIFwiLG8ueCxcIiBcIixvLnksXCIgXCIpLGk9bmV3IGZhYnJpYy5Qb2ludCh0W3NdLngsdFtzXS55KSxzKzE8dC5sZW5ndGgmJihyPW5ldyBmYWJyaWMuUG9pbnQodFtzKzFdLngsdFtzKzFdLnkpKX1yZXR1cm4gZS5wdXNoKFwiTCBcIixpLngsXCIgXCIsaS55LFwiIFwiKSxlfSxjcmVhdGVQYXRoOmZ1bmN0aW9uKHQpe3ZhciBlPW5ldyBmYWJyaWMuUGF0aCh0LHtmaWxsOm51bGwsc3Ryb2tlOnRoaXMuY29sb3Isc3Ryb2tlV2lkdGg6dGhpcy53aWR0aCxzdHJva2VMaW5lQ2FwOnRoaXMuc3Ryb2tlTGluZUNhcCxzdHJva2VMaW5lSm9pbjp0aGlzLnN0cm9rZUxpbmVKb2luLHN0cm9rZURhc2hBcnJheTp0aGlzLnN0cm9rZURhc2hBcnJheSxvcmlnaW5YOlwiY2VudGVyXCIsb3JpZ2luWTpcImNlbnRlclwifSk7cmV0dXJuIHRoaXMuc2hhZG93JiYodGhpcy5zaGFkb3cuYWZmZWN0U3Ryb2tlPSEwLGUuc2V0U2hhZG93KHRoaXMuc2hhZG93KSksZX0sX2ZpbmFsaXplQW5kQWRkUGF0aDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuY2FudmFzLmNvbnRleHRUb3A7dC5jbG9zZVBhdGgoKTt2YXIgZT10aGlzLmNvbnZlcnRQb2ludHNUb1NWR1BhdGgodGhpcy5fcG9pbnRzKS5qb2luKFwiXCIpO2lmKFwiTSAwIDAgUSAwIDAgMCAwIEwgMCAwXCI9PT1lKXJldHVybiB2b2lkIHRoaXMuY2FudmFzLnJlbmRlckFsbCgpO3ZhciBpPXRoaXMuY3JlYXRlUGF0aChlKTt0aGlzLmNhbnZhcy5hZGQoaSksaS5zZXRDb29yZHMoKSx0aGlzLmNhbnZhcy5jbGVhckNvbnRleHQodGhpcy5jYW52YXMuY29udGV4dFRvcCksdGhpcy5fcmVzZXRTaGFkb3coKSx0aGlzLmNhbnZhcy5yZW5kZXJBbGwoKSx0aGlzLmNhbnZhcy5maXJlKFwicGF0aDpjcmVhdGVkXCIse3BhdGg6aX0pfX0pfSgpLGZhYnJpYy5DaXJjbGVCcnVzaD1mYWJyaWMudXRpbC5jcmVhdGVDbGFzcyhmYWJyaWMuQmFzZUJydXNoLHt3aWR0aDoxMCxpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3RoaXMuY2FudmFzPXQsdGhpcy5wb2ludHM9W119LGRyYXdEb3Q6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5hZGRQb2ludCh0KSxpPXRoaXMuY2FudmFzLmNvbnRleHRUb3Ascj10aGlzLmNhbnZhcy52aWV3cG9ydFRyYW5zZm9ybTtpLnNhdmUoKSxpLnRyYW5zZm9ybShyWzBdLHJbMV0sclsyXSxyWzNdLHJbNF0scls1XSksaS5maWxsU3R5bGU9ZS5maWxsLGkuYmVnaW5QYXRoKCksaS5hcmMoZS54LGUueSxlLnJhZGl1cywwLDIqTWF0aC5QSSwhMSksaS5jbG9zZVBhdGgoKSxpLmZpbGwoKSxpLnJlc3RvcmUoKX0sb25Nb3VzZURvd246ZnVuY3Rpb24odCl7dGhpcy5wb2ludHMubGVuZ3RoPTAsdGhpcy5jYW52YXMuY2xlYXJDb250ZXh0KHRoaXMuY2FudmFzLmNvbnRleHRUb3ApLHRoaXMuX3NldFNoYWRvdygpLHRoaXMuZHJhd0RvdCh0KX0sb25Nb3VzZU1vdmU6ZnVuY3Rpb24odCl7dGhpcy5kcmF3RG90KHQpfSxvbk1vdXNlVXA6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmNhbnZhcy5yZW5kZXJPbkFkZFJlbW92ZTt0aGlzLmNhbnZhcy5yZW5kZXJPbkFkZFJlbW92ZT0hMTtmb3IodmFyIGU9W10saT0wLHI9dGhpcy5wb2ludHMubGVuZ3RoO3I+aTtpKyspe3ZhciBzPXRoaXMucG9pbnRzW2ldLG49bmV3IGZhYnJpYy5DaXJjbGUoe3JhZGl1czpzLnJhZGl1cyxsZWZ0OnMueCx0b3A6cy55LG9yaWdpblg6XCJjZW50ZXJcIixvcmlnaW5ZOlwiY2VudGVyXCIsZmlsbDpzLmZpbGx9KTt0aGlzLnNoYWRvdyYmbi5zZXRTaGFkb3codGhpcy5zaGFkb3cpLGUucHVzaChuKX12YXIgbz1uZXcgZmFicmljLkdyb3VwKGUse29yaWdpblg6XCJjZW50ZXJcIixvcmlnaW5ZOlwiY2VudGVyXCJ9KTtvLmNhbnZhcz10aGlzLmNhbnZhcyx0aGlzLmNhbnZhcy5hZGQobyksdGhpcy5jYW52YXMuZmlyZShcInBhdGg6Y3JlYXRlZFwiLHtwYXRoOm99KSx0aGlzLmNhbnZhcy5jbGVhckNvbnRleHQodGhpcy5jYW52YXMuY29udGV4dFRvcCksdGhpcy5fcmVzZXRTaGFkb3coKSx0aGlzLmNhbnZhcy5yZW5kZXJPbkFkZFJlbW92ZT10LHRoaXMuY2FudmFzLnJlbmRlckFsbCgpfSxhZGRQb2ludDpmdW5jdGlvbih0KXt2YXIgZT1uZXcgZmFicmljLlBvaW50KHQueCx0LnkpLGk9ZmFicmljLnV0aWwuZ2V0UmFuZG9tSW50KE1hdGgubWF4KDAsdGhpcy53aWR0aC0yMCksdGhpcy53aWR0aCsyMCkvMixyPW5ldyBmYWJyaWMuQ29sb3IodGhpcy5jb2xvcikuc2V0QWxwaGEoZmFicmljLnV0aWwuZ2V0UmFuZG9tSW50KDAsMTAwKS8xMDApLnRvUmdiYSgpO3JldHVybiBlLnJhZGl1cz1pLGUuZmlsbD1yLHRoaXMucG9pbnRzLnB1c2goZSksZX19KSxmYWJyaWMuU3ByYXlCcnVzaD1mYWJyaWMudXRpbC5jcmVhdGVDbGFzcyhmYWJyaWMuQmFzZUJydXNoLHt3aWR0aDoxMCxkZW5zaXR5OjIwLGRvdFdpZHRoOjEsZG90V2lkdGhWYXJpYW5jZToxLHJhbmRvbU9wYWNpdHk6ITEsb3B0aW1pemVPdmVybGFwcGluZzohMCxpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3RoaXMuY2FudmFzPXQsdGhpcy5zcHJheUNodW5rcz1bXX0sb25Nb3VzZURvd246ZnVuY3Rpb24odCl7dGhpcy5zcHJheUNodW5rcy5sZW5ndGg9MCx0aGlzLmNhbnZhcy5jbGVhckNvbnRleHQodGhpcy5jYW52YXMuY29udGV4dFRvcCksdGhpcy5fc2V0U2hhZG93KCksdGhpcy5hZGRTcHJheUNodW5rKHQpLHRoaXMucmVuZGVyKCl9LG9uTW91c2VNb3ZlOmZ1bmN0aW9uKHQpe3RoaXMuYWRkU3ByYXlDaHVuayh0KSx0aGlzLnJlbmRlcigpfSxvbk1vdXNlVXA6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmNhbnZhcy5yZW5kZXJPbkFkZFJlbW92ZTt0aGlzLmNhbnZhcy5yZW5kZXJPbkFkZFJlbW92ZT0hMTtmb3IodmFyIGU9W10saT0wLHI9dGhpcy5zcHJheUNodW5rcy5sZW5ndGg7cj5pO2krKylmb3IodmFyIHM9dGhpcy5zcHJheUNodW5rc1tpXSxuPTAsbz1zLmxlbmd0aDtvPm47bisrKXt2YXIgYT1uZXcgZmFicmljLlJlY3Qoe3dpZHRoOnNbbl0ud2lkdGgsaGVpZ2h0OnNbbl0ud2lkdGgsbGVmdDpzW25dLngrMSx0b3A6c1tuXS55KzEsb3JpZ2luWDpcImNlbnRlclwiLG9yaWdpblk6XCJjZW50ZXJcIixmaWxsOnRoaXMuY29sb3J9KTt0aGlzLnNoYWRvdyYmYS5zZXRTaGFkb3codGhpcy5zaGFkb3cpLGUucHVzaChhKX10aGlzLm9wdGltaXplT3ZlcmxhcHBpbmcmJihlPXRoaXMuX2dldE9wdGltaXplZFJlY3RzKGUpKTt2YXIgaD1uZXcgZmFicmljLkdyb3VwKGUse29yaWdpblg6XCJjZW50ZXJcIixvcmlnaW5ZOlwiY2VudGVyXCJ9KTtoLmNhbnZhcz10aGlzLmNhbnZhcyx0aGlzLmNhbnZhcy5hZGQoaCksdGhpcy5jYW52YXMuZmlyZShcInBhdGg6Y3JlYXRlZFwiLHtwYXRoOmh9KSx0aGlzLmNhbnZhcy5jbGVhckNvbnRleHQodGhpcy5jYW52YXMuY29udGV4dFRvcCksdGhpcy5fcmVzZXRTaGFkb3coKSx0aGlzLmNhbnZhcy5yZW5kZXJPbkFkZFJlbW92ZT10LHRoaXMuY2FudmFzLnJlbmRlckFsbCgpfSxfZ2V0T3B0aW1pemVkUmVjdHM6ZnVuY3Rpb24odCl7Zm9yKHZhciBlLGk9e30scj0wLHM9dC5sZW5ndGg7cz5yO3IrKyllPXRbcl0ubGVmdCtcIlwiK3Rbcl0udG9wLGlbZV18fChpW2VdPXRbcl0pO3ZhciBuPVtdO2ZvcihlIGluIGkpbi5wdXNoKGlbZV0pO3JldHVybiBufSxyZW5kZXI6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmNhbnZhcy5jb250ZXh0VG9wO3QuZmlsbFN0eWxlPXRoaXMuY29sb3I7dmFyIGU9dGhpcy5jYW52YXMudmlld3BvcnRUcmFuc2Zvcm07dC5zYXZlKCksdC50cmFuc2Zvcm0oZVswXSxlWzFdLGVbMl0sZVszXSxlWzRdLGVbNV0pO2Zvcih2YXIgaT0wLHI9dGhpcy5zcHJheUNodW5rUG9pbnRzLmxlbmd0aDtyPmk7aSsrKXt2YXIgcz10aGlzLnNwcmF5Q2h1bmtQb2ludHNbaV07XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHMub3BhY2l0eSYmKHQuZ2xvYmFsQWxwaGE9cy5vcGFjaXR5KSx0LmZpbGxSZWN0KHMueCxzLnkscy53aWR0aCxzLndpZHRoKX10LnJlc3RvcmUoKX0sYWRkU3ByYXlDaHVuazpmdW5jdGlvbih0KXt0aGlzLnNwcmF5Q2h1bmtQb2ludHM9W107Zm9yKHZhciBlLGkscixzPXRoaXMud2lkdGgvMixuPTA7bjx0aGlzLmRlbnNpdHk7bisrKXtlPWZhYnJpYy51dGlsLmdldFJhbmRvbUludCh0Lngtcyx0LngrcyksaT1mYWJyaWMudXRpbC5nZXRSYW5kb21JbnQodC55LXMsdC55K3MpLHI9dGhpcy5kb3RXaWR0aFZhcmlhbmNlP2ZhYnJpYy51dGlsLmdldFJhbmRvbUludChNYXRoLm1heCgxLHRoaXMuZG90V2lkdGgtdGhpcy5kb3RXaWR0aFZhcmlhbmNlKSx0aGlzLmRvdFdpZHRoK3RoaXMuZG90V2lkdGhWYXJpYW5jZSk6dGhpcy5kb3RXaWR0aDt2YXIgbz1uZXcgZmFicmljLlBvaW50KGUsaSk7by53aWR0aD1yLHRoaXMucmFuZG9tT3BhY2l0eSYmKG8ub3BhY2l0eT1mYWJyaWMudXRpbC5nZXRSYW5kb21JbnQoMCwxMDApLzEwMCksdGhpcy5zcHJheUNodW5rUG9pbnRzLnB1c2gobyl9dGhpcy5zcHJheUNodW5rcy5wdXNoKHRoaXMuc3ByYXlDaHVua1BvaW50cyl9fSksZmFicmljLlBhdHRlcm5CcnVzaD1mYWJyaWMudXRpbC5jcmVhdGVDbGFzcyhmYWJyaWMuUGVuY2lsQnJ1c2gse2dldFBhdHRlcm5TcmM6ZnVuY3Rpb24oKXt2YXIgdD0yMCxlPTUsaT1mYWJyaWMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKSxyPWkuZ2V0Q29udGV4dChcIjJkXCIpO3JldHVybiBpLndpZHRoPWkuaGVpZ2h0PXQrZSxyLmZpbGxTdHlsZT10aGlzLmNvbG9yLHIuYmVnaW5QYXRoKCksci5hcmModC8yLHQvMix0LzIsMCwyKk1hdGguUEksITEpLHIuY2xvc2VQYXRoKCksci5maWxsKCksaX0sZ2V0UGF0dGVyblNyY0Z1bmN0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIFN0cmluZyh0aGlzLmdldFBhdHRlcm5TcmMpLnJlcGxhY2UoXCJ0aGlzLmNvbG9yXCIsJ1wiJyt0aGlzLmNvbG9yKydcIicpfSxnZXRQYXR0ZXJuOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2FudmFzLmNvbnRleHRUb3AuY3JlYXRlUGF0dGVybih0aGlzLnNvdXJjZXx8dGhpcy5nZXRQYXR0ZXJuU3JjKCksXCJyZXBlYXRcIil9LF9zZXRCcnVzaFN0eWxlczpmdW5jdGlvbigpe3RoaXMuY2FsbFN1cGVyKFwiX3NldEJydXNoU3R5bGVzXCIpLHRoaXMuY2FudmFzLmNvbnRleHRUb3Auc3Ryb2tlU3R5bGU9dGhpcy5nZXRQYXR0ZXJuKCl9LGNyZWF0ZVBhdGg6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5jYWxsU3VwZXIoXCJjcmVhdGVQYXRoXCIsdCk7cmV0dXJuIGUuc3Ryb2tlPW5ldyBmYWJyaWMuUGF0dGVybih7c291cmNlOnRoaXMuc291cmNlfHx0aGlzLmdldFBhdHRlcm5TcmNGdW5jdGlvbigpfSksZX19KSxmdW5jdGlvbigpe3ZhciB0PWZhYnJpYy51dGlsLmdldFBvaW50ZXIsZT1mYWJyaWMudXRpbC5kZWdyZWVzVG9SYWRpYW5zLGk9ZmFicmljLnV0aWwucmFkaWFuc1RvRGVncmVlcyxyPU1hdGguYXRhbjIscz1NYXRoLmFicyxuPS41O2ZhYnJpYy5DYW52YXM9ZmFicmljLnV0aWwuY3JlYXRlQ2xhc3MoZmFicmljLlN0YXRpY0NhbnZhcyx7aW5pdGlhbGl6ZTpmdW5jdGlvbih0LGUpe2V8fChlPXt9KSx0aGlzLl9pbml0U3RhdGljKHQsZSksdGhpcy5faW5pdEludGVyYWN0aXZlKCksdGhpcy5fY3JlYXRlQ2FjaGVDYW52YXMoKSxmYWJyaWMuQ2FudmFzLmFjdGl2ZUluc3RhbmNlPXRoaXN9LHVuaVNjYWxlVHJhbnNmb3JtOiExLGNlbnRlcmVkU2NhbGluZzohMSxjZW50ZXJlZFJvdGF0aW9uOiExLGludGVyYWN0aXZlOiEwLHNlbGVjdGlvbjohMCxzZWxlY3Rpb25Db2xvcjpcInJnYmEoMTAwLCAxMDAsIDI1NSwgMC4zKVwiLHNlbGVjdGlvbkRhc2hBcnJheTpbXSxzZWxlY3Rpb25Cb3JkZXJDb2xvcjpcInJnYmEoMjU1LCAyNTUsIDI1NSwgMC4zKVwiLHNlbGVjdGlvbkxpbmVXaWR0aDoxLGhvdmVyQ3Vyc29yOlwibW92ZVwiLG1vdmVDdXJzb3I6XCJtb3ZlXCIsZGVmYXVsdEN1cnNvcjpcImRlZmF1bHRcIixmcmVlRHJhd2luZ0N1cnNvcjpcImNyb3NzaGFpclwiLHJvdGF0aW9uQ3Vyc29yOlwiY3Jvc3NoYWlyXCIsY29udGFpbmVyQ2xhc3M6XCJjYW52YXMtY29udGFpbmVyXCIscGVyUGl4ZWxUYXJnZXRGaW5kOiExLHRhcmdldEZpbmRUb2xlcmFuY2U6MCxza2lwVGFyZ2V0RmluZDohMSxpc0RyYXdpbmdNb2RlOiExLF9pbml0SW50ZXJhY3RpdmU6ZnVuY3Rpb24oKXt0aGlzLl9jdXJyZW50VHJhbnNmb3JtPW51bGwsdGhpcy5fZ3JvdXBTZWxlY3Rvcj1udWxsLHRoaXMuX2luaXRXcmFwcGVyRWxlbWVudCgpLHRoaXMuX2NyZWF0ZVVwcGVyQ2FudmFzKCksdGhpcy5faW5pdEV2ZW50TGlzdGVuZXJzKCksdGhpcy5mcmVlRHJhd2luZ0JydXNoPWZhYnJpYy5QZW5jaWxCcnVzaCYmbmV3IGZhYnJpYy5QZW5jaWxCcnVzaCh0aGlzKSx0aGlzLmNhbGNPZmZzZXQoKX0sX3Jlc2V0Q3VycmVudFRyYW5zZm9ybTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl9jdXJyZW50VHJhbnNmb3JtO2UudGFyZ2V0LnNldCh7c2NhbGVYOmUub3JpZ2luYWwuc2NhbGVYLHNjYWxlWTplLm9yaWdpbmFsLnNjYWxlWSxsZWZ0OmUub3JpZ2luYWwubGVmdCx0b3A6ZS5vcmlnaW5hbC50b3B9KSx0aGlzLl9zaG91bGRDZW50ZXJUcmFuc2Zvcm0odCxlLnRhcmdldCk/XCJyb3RhdGVcIj09PWUuYWN0aW9uP3RoaXMuX3NldE9yaWdpblRvQ2VudGVyKGUudGFyZ2V0KTooXCJjZW50ZXJcIiE9PWUub3JpZ2luWCYmKFwicmlnaHRcIj09PWUub3JpZ2luWD9lLm1vdXNlWFNpZ249LTE6ZS5tb3VzZVhTaWduPTEpLFwiY2VudGVyXCIhPT1lLm9yaWdpblkmJihcImJvdHRvbVwiPT09ZS5vcmlnaW5ZP2UubW91c2VZU2lnbj0tMTplLm1vdXNlWVNpZ249MSksZS5vcmlnaW5YPVwiY2VudGVyXCIsZS5vcmlnaW5ZPVwiY2VudGVyXCIpOihlLm9yaWdpblg9ZS5vcmlnaW5hbC5vcmlnaW5YLGUub3JpZ2luWT1lLm9yaWdpbmFsLm9yaWdpblkpfSxjb250YWluc1BvaW50OmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5nZXRQb2ludGVyKHQsITApLHI9dGhpcy5fbm9ybWFsaXplUG9pbnRlcihlLGkpO3JldHVybiBlLmNvbnRhaW5zUG9pbnQocil8fGUuX2ZpbmRUYXJnZXRDb3JuZXIoaSl9LF9ub3JtYWxpemVQb2ludGVyOmZ1bmN0aW9uKHQsZSl7dmFyIGkscj10aGlzLmdldEFjdGl2ZUdyb3VwKCkscz1lLngsbj1lLnksbz1yJiZcImdyb3VwXCIhPT10LnR5cGUmJnIuY29udGFpbnModCk7cmV0dXJuIG8mJihpPW5ldyBmYWJyaWMuUG9pbnQoci5sZWZ0LHIudG9wKSxpPWZhYnJpYy51dGlsLnRyYW5zZm9ybVBvaW50KGksdGhpcy52aWV3cG9ydFRyYW5zZm9ybSwhMCkscy09aS54LG4tPWkueSkse3g6cyx5Om59fSxpc1RhcmdldFRyYW5zcGFyZW50OmZ1bmN0aW9uKHQsZSxpKXt2YXIgcj10Lmhhc0JvcmRlcnMscz10LnRyYW5zcGFyZW50Q29ybmVyczt0Lmhhc0JvcmRlcnM9dC50cmFuc3BhcmVudENvcm5lcnM9ITEsdGhpcy5fZHJhdyh0aGlzLmNvbnRleHRDYWNoZSx0KSx0Lmhhc0JvcmRlcnM9cix0LnRyYW5zcGFyZW50Q29ybmVycz1zO3ZhciBuPWZhYnJpYy51dGlsLmlzVHJhbnNwYXJlbnQodGhpcy5jb250ZXh0Q2FjaGUsZSxpLHRoaXMudGFyZ2V0RmluZFRvbGVyYW5jZSk7cmV0dXJuIHRoaXMuY2xlYXJDb250ZXh0KHRoaXMuY29udGV4dENhY2hlKSxufSxfc2hvdWxkQ2xlYXJTZWxlY3Rpb246ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLmdldEFjdGl2ZUdyb3VwKCkscj10aGlzLmdldEFjdGl2ZU9iamVjdCgpO3JldHVybiFlfHxlJiZpJiYhaS5jb250YWlucyhlKSYmaSE9PWUmJiF0LnNoaWZ0S2V5fHxlJiYhZS5ldmVudGVkfHxlJiYhZS5zZWxlY3RhYmxlJiZyJiZyIT09ZX0sX3Nob3VsZENlbnRlclRyYW5zZm9ybTpmdW5jdGlvbih0LGUpe2lmKGUpe3ZhciBpLHI9dGhpcy5fY3VycmVudFRyYW5zZm9ybTtyZXR1cm5cInNjYWxlXCI9PT1yLmFjdGlvbnx8XCJzY2FsZVhcIj09PXIuYWN0aW9ufHxcInNjYWxlWVwiPT09ci5hY3Rpb24/aT10aGlzLmNlbnRlcmVkU2NhbGluZ3x8ZS5jZW50ZXJlZFNjYWxpbmc6XCJyb3RhdGVcIj09PXIuYWN0aW9uJiYoaT10aGlzLmNlbnRlcmVkUm90YXRpb258fGUuY2VudGVyZWRSb3RhdGlvbiksaT8hdC5hbHRLZXk6dC5hbHRLZXl9fSxfZ2V0T3JpZ2luRnJvbUNvcm5lcjpmdW5jdGlvbih0LGUpe3ZhciBpPXt4OnQub3JpZ2luWCx5OnQub3JpZ2luWX07cmV0dXJuXCJtbFwiPT09ZXx8XCJ0bFwiPT09ZXx8XCJibFwiPT09ZT9pLng9XCJyaWdodFwiOihcIm1yXCI9PT1lfHxcInRyXCI9PT1lfHxcImJyXCI9PT1lKSYmKGkueD1cImxlZnRcIiksXCJ0bFwiPT09ZXx8XCJtdFwiPT09ZXx8XCJ0clwiPT09ZT9pLnk9XCJib3R0b21cIjooXCJibFwiPT09ZXx8XCJtYlwiPT09ZXx8XCJiclwiPT09ZSkmJihpLnk9XCJ0b3BcIiksaX0sX2dldEFjdGlvbkZyb21Db3JuZXI6ZnVuY3Rpb24odCxlKXt2YXIgaT1cImRyYWdcIjtyZXR1cm4gZSYmKGk9XCJtbFwiPT09ZXx8XCJtclwiPT09ZT9cInNjYWxlWFwiOlwibXRcIj09PWV8fFwibWJcIj09PWU/XCJzY2FsZVlcIjpcIm10clwiPT09ZT9cInJvdGF0ZVwiOlwic2NhbGVcIiksaX0sX3NldHVwQ3VycmVudFRyYW5zZm9ybTpmdW5jdGlvbih0LGkpe2lmKGkpe3ZhciByPXRoaXMuZ2V0UG9pbnRlcih0KSxzPWkuX2ZpbmRUYXJnZXRDb3JuZXIodGhpcy5nZXRQb2ludGVyKHQsITApKSxuPXRoaXMuX2dldEFjdGlvbkZyb21Db3JuZXIoaSxzKSxvPXRoaXMuX2dldE9yaWdpbkZyb21Db3JuZXIoaSxzKTt0aGlzLl9jdXJyZW50VHJhbnNmb3JtPXt0YXJnZXQ6aSxhY3Rpb246bixzY2FsZVg6aS5zY2FsZVgsc2NhbGVZOmkuc2NhbGVZLG9mZnNldFg6ci54LWkubGVmdCxvZmZzZXRZOnIueS1pLnRvcCxvcmlnaW5YOm8ueCxvcmlnaW5ZOm8ueSxleDpyLngsZXk6ci55LGxlZnQ6aS5sZWZ0LHRvcDppLnRvcCx0aGV0YTplKGkuYW5nbGUpLHdpZHRoOmkud2lkdGgqaS5zY2FsZVgsbW91c2VYU2lnbjoxLG1vdXNlWVNpZ246MX0sdGhpcy5fY3VycmVudFRyYW5zZm9ybS5vcmlnaW5hbD17bGVmdDppLmxlZnQsdG9wOmkudG9wLHNjYWxlWDppLnNjYWxlWCxzY2FsZVk6aS5zY2FsZVksb3JpZ2luWDpvLngsb3JpZ2luWTpvLnl9LHRoaXMuX3Jlc2V0Q3VycmVudFRyYW5zZm9ybSh0KX19LF90cmFuc2xhdGVPYmplY3Q6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLl9jdXJyZW50VHJhbnNmb3JtLnRhcmdldDtpLmdldChcImxvY2tNb3ZlbWVudFhcIil8fGkuc2V0KFwibGVmdFwiLHQtdGhpcy5fY3VycmVudFRyYW5zZm9ybS5vZmZzZXRYKSxpLmdldChcImxvY2tNb3ZlbWVudFlcIil8fGkuc2V0KFwidG9wXCIsZS10aGlzLl9jdXJyZW50VHJhbnNmb3JtLm9mZnNldFkpfSxfc2NhbGVPYmplY3Q6ZnVuY3Rpb24odCxlLGkpe3ZhciByPXRoaXMuX2N1cnJlbnRUcmFuc2Zvcm0scz1yLnRhcmdldCxuPXMuZ2V0KFwibG9ja1NjYWxpbmdYXCIpLG89cy5nZXQoXCJsb2NrU2NhbGluZ1lcIiksYT1zLmdldChcImxvY2tTY2FsaW5nRmxpcFwiKTtpZighbnx8IW8pe3ZhciBoPXMudHJhbnNsYXRlVG9PcmlnaW5Qb2ludChzLmdldENlbnRlclBvaW50KCksci5vcmlnaW5YLHIub3JpZ2luWSksYz1zLnRvTG9jYWxQb2ludChuZXcgZmFicmljLlBvaW50KHQsZSksci5vcmlnaW5YLHIub3JpZ2luWSk7dGhpcy5fc2V0TG9jYWxNb3VzZShjLHIpLHRoaXMuX3NldE9iamVjdFNjYWxlKGMscixuLG8saSxhKSxzLnNldFBvc2l0aW9uQnlPcmlnaW4oaCxyLm9yaWdpblgsci5vcmlnaW5ZKX19LF9zZXRPYmplY3RTY2FsZTpmdW5jdGlvbih0LGUsaSxyLHMsbil7dmFyIG89ZS50YXJnZXQsYT0hMSxoPSExLGM9XCJsaW5lXCI9PT1vLnR5cGUmJjA9PT1vLndpZHRoLGw9XCJsaW5lXCI9PT1vLnR5cGUmJjA9PT1vLmhlaWdodCx1PWw/MDpvLnN0cm9rZVdpZHRoLGY9Yz8wOm8uc3Ryb2tlV2lkdGg7ZS5uZXdTY2FsZVg9dC54LyhvLndpZHRoK3UpLGUubmV3U2NhbGVZPXQueS8oby5oZWlnaHQrZiksbiYmZS5uZXdTY2FsZVg8PTAmJmUubmV3U2NhbGVYPG8uc2NhbGVYJiYoYT0hMCksbiYmZS5uZXdTY2FsZVk8PTAmJmUubmV3U2NhbGVZPG8uc2NhbGVZJiYoaD0hMCksXCJlcXVhbGx5XCIhPT1zfHxpfHxyP3M/XCJ4XCIhPT1zfHxvLmdldChcImxvY2tVbmlTY2FsaW5nXCIpP1wieVwiIT09c3x8by5nZXQoXCJsb2NrVW5pU2NhbGluZ1wiKXx8aHx8cnx8by5zZXQoXCJzY2FsZVlcIixlLm5ld1NjYWxlWSk6YXx8aXx8by5zZXQoXCJzY2FsZVhcIixlLm5ld1NjYWxlWCk6KGF8fGl8fG8uc2V0KFwic2NhbGVYXCIsZS5uZXdTY2FsZVgpLGh8fHJ8fG8uc2V0KFwic2NhbGVZXCIsZS5uZXdTY2FsZVkpKTphfHxofHx0aGlzLl9zY2FsZU9iamVjdEVxdWFsbHkodCxvLGUpLGF8fGh8fHRoaXMuX2ZsaXBPYmplY3QoZSxzKX0sX3NjYWxlT2JqZWN0RXF1YWxseTpmdW5jdGlvbih0LGUsaSl7dmFyIHI9dC55K3QueCxzPVwibGluZVwiPT09ZS50eXBlJiYwPT09ZS53aWR0aCxuPVwibGluZVwiPT09ZS50eXBlJiYwPT09ZS5oZWlnaHQsbz1uPzA6ZS5zdHJva2VXaWR0aCxhPXM/MDplLnN0cm9rZVdpZHRoLGg9KGUuaGVpZ2h0K2EpKmkub3JpZ2luYWwuc2NhbGVZKyhlLndpZHRoK28pKmkub3JpZ2luYWwuc2NhbGVYO2kubmV3U2NhbGVYPWkub3JpZ2luYWwuc2NhbGVYKnIvaCxpLm5ld1NjYWxlWT1pLm9yaWdpbmFsLnNjYWxlWSpyL2gsZS5zZXQoXCJzY2FsZVhcIixpLm5ld1NjYWxlWCksZS5zZXQoXCJzY2FsZVlcIixpLm5ld1NjYWxlWSl9LF9mbGlwT2JqZWN0OmZ1bmN0aW9uKHQsZSl7dC5uZXdTY2FsZVg8MCYmXCJ5XCIhPT1lJiYoXCJsZWZ0XCI9PT10Lm9yaWdpblg/dC5vcmlnaW5YPVwicmlnaHRcIjpcInJpZ2h0XCI9PT10Lm9yaWdpblgmJih0Lm9yaWdpblg9XCJsZWZ0XCIpKSx0Lm5ld1NjYWxlWTwwJiZcInhcIiE9PWUmJihcInRvcFwiPT09dC5vcmlnaW5ZP3Qub3JpZ2luWT1cImJvdHRvbVwiOlwiYm90dG9tXCI9PT10Lm9yaWdpblkmJih0Lm9yaWdpblk9XCJ0b3BcIikpfSxfc2V0TG9jYWxNb3VzZTpmdW5jdGlvbih0LGUpe3ZhciBpPWUudGFyZ2V0O1wicmlnaHRcIj09PWUub3JpZ2luWD90LngqPS0xOlwiY2VudGVyXCI9PT1lLm9yaWdpblgmJih0LngqPTIqZS5tb3VzZVhTaWduLHQueDwwJiYoZS5tb3VzZVhTaWduPS1lLm1vdXNlWFNpZ24pKSxcImJvdHRvbVwiPT09ZS5vcmlnaW5ZP3QueSo9LTE6XCJjZW50ZXJcIj09PWUub3JpZ2luWSYmKHQueSo9MiplLm1vdXNlWVNpZ24sdC55PDAmJihlLm1vdXNlWVNpZ249LWUubW91c2VZU2lnbikpLHModC54KT5pLnBhZGRpbmc/dC54PDA/dC54Kz1pLnBhZGRpbmc6dC54LT1pLnBhZGRpbmc6dC54PTAscyh0LnkpPmkucGFkZGluZz90Lnk8MD90LnkrPWkucGFkZGluZzp0LnktPWkucGFkZGluZzp0Lnk9MH0sX3JvdGF0ZU9iamVjdDpmdW5jdGlvbih0LGUpe3ZhciBzPXRoaXMuX2N1cnJlbnRUcmFuc2Zvcm07aWYoIXMudGFyZ2V0LmdldChcImxvY2tSb3RhdGlvblwiKSl7dmFyIG49cihzLmV5LXMudG9wLHMuZXgtcy5sZWZ0KSxvPXIoZS1zLnRvcCx0LXMubGVmdCksYT1pKG8tbitzLnRoZXRhKTswPmEmJihhPTM2MCthKSxzLnRhcmdldC5hbmdsZT1hJTM2MH19LHNldEN1cnNvcjpmdW5jdGlvbih0KXt0aGlzLnVwcGVyQ2FudmFzRWwuc3R5bGUuY3Vyc29yPXR9LF9yZXNldE9iamVjdFRyYW5zZm9ybTpmdW5jdGlvbih0KXt0LnNjYWxlWD0xLHQuc2NhbGVZPTEsdC5zZXRBbmdsZSgwKX0sX2RyYXdTZWxlY3Rpb246ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmNvbnRleHRUb3AsZT10aGlzLl9ncm91cFNlbGVjdG9yLGk9ZS5sZWZ0LHI9ZS50b3Asbz1zKGkpLGE9cyhyKTtpZih0LmZpbGxTdHlsZT10aGlzLnNlbGVjdGlvbkNvbG9yLHQuZmlsbFJlY3QoZS5leC0oaT4wPzA6LWkpLGUuZXktKHI+MD8wOi1yKSxvLGEpLHQubGluZVdpZHRoPXRoaXMuc2VsZWN0aW9uTGluZVdpZHRoLHQuc3Ryb2tlU3R5bGU9dGhpcy5zZWxlY3Rpb25Cb3JkZXJDb2xvcix0aGlzLnNlbGVjdGlvbkRhc2hBcnJheS5sZW5ndGg+MSl7dmFyIGg9ZS5leCtuLShpPjA/MDpvKSxjPWUuZXkrbi0ocj4wPzA6YSk7dC5iZWdpblBhdGgoKSxmYWJyaWMudXRpbC5kcmF3RGFzaGVkTGluZSh0LGgsYyxoK28sYyx0aGlzLnNlbGVjdGlvbkRhc2hBcnJheSksZmFicmljLnV0aWwuZHJhd0Rhc2hlZExpbmUodCxoLGMrYS0xLGgrbyxjK2EtMSx0aGlzLnNlbGVjdGlvbkRhc2hBcnJheSksZmFicmljLnV0aWwuZHJhd0Rhc2hlZExpbmUodCxoLGMsaCxjK2EsdGhpcy5zZWxlY3Rpb25EYXNoQXJyYXkpLGZhYnJpYy51dGlsLmRyYXdEYXNoZWRMaW5lKHQsaCtvLTEsYyxoK28tMSxjK2EsdGhpcy5zZWxlY3Rpb25EYXNoQXJyYXkpLHQuY2xvc2VQYXRoKCksdC5zdHJva2UoKX1lbHNlIHQuc3Ryb2tlUmVjdChlLmV4K24tKGk+MD8wOm8pLGUuZXkrbi0ocj4wPzA6YSksbyxhKX0sX2lzTGFzdFJlbmRlcmVkT2JqZWN0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmNvbnRyb2xzQWJvdmVPdmVybGF5JiZ0aGlzLmxhc3RSZW5kZXJlZE9iamVjdFdpdGhDb250cm9sc0Fib3ZlT3ZlcmxheSYmdGhpcy5sYXN0UmVuZGVyZWRPYmplY3RXaXRoQ29udHJvbHNBYm92ZU92ZXJsYXkudmlzaWJsZSYmdGhpcy5jb250YWluc1BvaW50KHQsdGhpcy5sYXN0UmVuZGVyZWRPYmplY3RXaXRoQ29udHJvbHNBYm92ZU92ZXJsYXkpJiZ0aGlzLmxhc3RSZW5kZXJlZE9iamVjdFdpdGhDb250cm9sc0Fib3ZlT3ZlcmxheS5fZmluZFRhcmdldENvcm5lcih0aGlzLmdldFBvaW50ZXIodCwhMCkpfSxmaW5kVGFyZ2V0OmZ1bmN0aW9uKHQsZSl7aWYoIXRoaXMuc2tpcFRhcmdldEZpbmQpe2lmKHRoaXMuX2lzTGFzdFJlbmRlcmVkT2JqZWN0KHQpKXJldHVybiB0aGlzLmxhc3RSZW5kZXJlZE9iamVjdFdpdGhDb250cm9sc0Fib3ZlT3ZlcmxheTt2YXIgaT10aGlzLmdldEFjdGl2ZUdyb3VwKCk7aWYoaSYmIWUmJnRoaXMuY29udGFpbnNQb2ludCh0LGkpKXJldHVybiBpO3ZhciByPXRoaXMuX3NlYXJjaFBvc3NpYmxlVGFyZ2V0cyh0KTtyZXR1cm4gdGhpcy5fZmlyZU92ZXJPdXRFdmVudHMocix0KSxyfX0sX2ZpcmVPdmVyT3V0RXZlbnRzOmZ1bmN0aW9uKHQsZSl7dD90aGlzLl9ob3ZlcmVkVGFyZ2V0IT09dCYmKHRoaXMuX2hvdmVyZWRUYXJnZXQmJih0aGlzLmZpcmUoXCJtb3VzZTpvdXRcIix7dGFyZ2V0OnRoaXMuX2hvdmVyZWRUYXJnZXQsZTplfSksdGhpcy5faG92ZXJlZFRhcmdldC5maXJlKFwibW91c2VvdXRcIikpLHRoaXMuZmlyZShcIm1vdXNlOm92ZXJcIix7dGFyZ2V0OnQsZTplfSksdC5maXJlKFwibW91c2VvdmVyXCIpLHRoaXMuX2hvdmVyZWRUYXJnZXQ9dCk6dGhpcy5faG92ZXJlZFRhcmdldCYmKHRoaXMuZmlyZShcIm1vdXNlOm91dFwiLHt0YXJnZXQ6dGhpcy5faG92ZXJlZFRhcmdldCxlOmV9KSx0aGlzLl9ob3ZlcmVkVGFyZ2V0LmZpcmUoXCJtb3VzZW91dFwiKSx0aGlzLl9ob3ZlcmVkVGFyZ2V0PW51bGwpfSxfY2hlY2tUYXJnZXQ6ZnVuY3Rpb24odCxlLGkpe2lmKGUmJmUudmlzaWJsZSYmZS5ldmVudGVkJiZ0aGlzLmNvbnRhaW5zUG9pbnQodCxlKSl7aWYoIXRoaXMucGVyUGl4ZWxUYXJnZXRGaW5kJiYhZS5wZXJQaXhlbFRhcmdldEZpbmR8fGUuaXNFZGl0aW5nKXJldHVybiEwO3ZhciByPXRoaXMuaXNUYXJnZXRUcmFuc3BhcmVudChlLGkueCxpLnkpO2lmKCFyKXJldHVybiEwfX0sX3NlYXJjaFBvc3NpYmxlVGFyZ2V0czpmdW5jdGlvbih0KXtmb3IodmFyIGUsaT10aGlzLmdldFBvaW50ZXIodCwhMCkscj10aGlzLl9vYmplY3RzLmxlbmd0aDtyLS07KWlmKCF0aGlzLl9vYmplY3RzW3JdLmdyb3VwJiZ0aGlzLl9jaGVja1RhcmdldCh0LHRoaXMuX29iamVjdHNbcl0saSkpe3RoaXMucmVsYXRlZFRhcmdldD10aGlzLl9vYmplY3RzW3JdLGU9dGhpcy5fb2JqZWN0c1tyXTticmVha31yZXR1cm4gZX0sZ2V0UG9pbnRlcjpmdW5jdGlvbihlLGkscil7cnx8KHI9dGhpcy51cHBlckNhbnZhc0VsKTt2YXIgcyxuPXQoZSxyKSxvPXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksYT1vLndpZHRofHwwLGg9by5oZWlnaHR8fDA7cmV0dXJuIGEmJmh8fChcInRvcFwiaW4gbyYmXCJib3R0b21cImluIG8mJihoPU1hdGguYWJzKG8udG9wLW8uYm90dG9tKSksXCJyaWdodFwiaW4gbyYmXCJsZWZ0XCJpbiBvJiYoYT1NYXRoLmFicyhvLnJpZ2h0LW8ubGVmdCkpKSx0aGlzLmNhbGNPZmZzZXQoKSxuLng9bi54LXRoaXMuX29mZnNldC5sZWZ0LG4ueT1uLnktdGhpcy5fb2Zmc2V0LnRvcCxpfHwobj1mYWJyaWMudXRpbC50cmFuc2Zvcm1Qb2ludChuLGZhYnJpYy51dGlsLmludmVydFRyYW5zZm9ybSh0aGlzLnZpZXdwb3J0VHJhbnNmb3JtKSkpLHM9MD09PWF8fDA9PT1oP3t3aWR0aDoxLGhlaWdodDoxfTp7d2lkdGg6ci53aWR0aC9hLGhlaWdodDpyLmhlaWdodC9ofSx7eDpuLngqcy53aWR0aCx5Om4ueSpzLmhlaWdodH19LF9jcmVhdGVVcHBlckNhbnZhczpmdW5jdGlvbigpe3ZhciB0PXRoaXMubG93ZXJDYW52YXNFbC5jbGFzc05hbWUucmVwbGFjZSgvXFxzKmxvd2VyLWNhbnZhc1xccyovLFwiXCIpO3RoaXMudXBwZXJDYW52YXNFbD10aGlzLl9jcmVhdGVDYW52YXNFbGVtZW50KCksZmFicmljLnV0aWwuYWRkQ2xhc3ModGhpcy51cHBlckNhbnZhc0VsLFwidXBwZXItY2FudmFzIFwiK3QpLHRoaXMud3JhcHBlckVsLmFwcGVuZENoaWxkKHRoaXMudXBwZXJDYW52YXNFbCksdGhpcy5fY29weUNhbnZhc1N0eWxlKHRoaXMubG93ZXJDYW52YXNFbCx0aGlzLnVwcGVyQ2FudmFzRWwpLHRoaXMuX2FwcGx5Q2FudmFzU3R5bGUodGhpcy51cHBlckNhbnZhc0VsKSx0aGlzLmNvbnRleHRUb3A9dGhpcy51cHBlckNhbnZhc0VsLmdldENvbnRleHQoXCIyZFwiKX0sX2NyZWF0ZUNhY2hlQ2FudmFzOmZ1bmN0aW9uKCl7dGhpcy5jYWNoZUNhbnZhc0VsPXRoaXMuX2NyZWF0ZUNhbnZhc0VsZW1lbnQoKSx0aGlzLmNhY2hlQ2FudmFzRWwuc2V0QXR0cmlidXRlKFwid2lkdGhcIix0aGlzLndpZHRoKSx0aGlzLmNhY2hlQ2FudmFzRWwuc2V0QXR0cmlidXRlKFwiaGVpZ2h0XCIsdGhpcy5oZWlnaHQpLHRoaXMuY29udGV4dENhY2hlPXRoaXMuY2FjaGVDYW52YXNFbC5nZXRDb250ZXh0KFwiMmRcIil9LF9pbml0V3JhcHBlckVsZW1lbnQ6ZnVuY3Rpb24oKXt0aGlzLndyYXBwZXJFbD1mYWJyaWMudXRpbC53cmFwRWxlbWVudCh0aGlzLmxvd2VyQ2FudmFzRWwsXCJkaXZcIix7XCJjbGFzc1wiOnRoaXMuY29udGFpbmVyQ2xhc3N9KSxmYWJyaWMudXRpbC5zZXRTdHlsZSh0aGlzLndyYXBwZXJFbCx7d2lkdGg6dGhpcy5nZXRXaWR0aCgpK1wicHhcIixoZWlnaHQ6dGhpcy5nZXRIZWlnaHQoKStcInB4XCIscG9zaXRpb246XCJyZWxhdGl2ZVwifSksZmFicmljLnV0aWwubWFrZUVsZW1lbnRVbnNlbGVjdGFibGUodGhpcy53cmFwcGVyRWwpfSxfYXBwbHlDYW52YXNTdHlsZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldFdpZHRoKCl8fHQud2lkdGgsaT10aGlzLmdldEhlaWdodCgpfHx0LmhlaWdodDtmYWJyaWMudXRpbC5zZXRTdHlsZSh0LHtwb3NpdGlvbjpcImFic29sdXRlXCIsd2lkdGg6ZStcInB4XCIsaGVpZ2h0OmkrXCJweFwiLGxlZnQ6MCx0b3A6MH0pLHQud2lkdGg9ZSx0LmhlaWdodD1pLGZhYnJpYy51dGlsLm1ha2VFbGVtZW50VW5zZWxlY3RhYmxlKHQpfSxfY29weUNhbnZhc1N0eWxlOmZ1bmN0aW9uKHQsZSl7ZS5zdHlsZS5jc3NUZXh0PXQuc3R5bGUuY3NzVGV4dH0sZ2V0U2VsZWN0aW9uQ29udGV4dDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnRleHRUb3B9LGdldFNlbGVjdGlvbkVsZW1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy51cHBlckNhbnZhc0VsfSxfc2V0QWN0aXZlT2JqZWN0OmZ1bmN0aW9uKHQpe3RoaXMuX2FjdGl2ZU9iamVjdCYmdGhpcy5fYWN0aXZlT2JqZWN0LnNldChcImFjdGl2ZVwiLCExKSx0aGlzLl9hY3RpdmVPYmplY3Q9dCx0LnNldChcImFjdGl2ZVwiLCEwKX0sc2V0QWN0aXZlT2JqZWN0OmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuX3NldEFjdGl2ZU9iamVjdCh0KSx0aGlzLnJlbmRlckFsbCgpLHRoaXMuZmlyZShcIm9iamVjdDpzZWxlY3RlZFwiLHt0YXJnZXQ6dCxlOmV9KSx0LmZpcmUoXCJzZWxlY3RlZFwiLHtlOmV9KSx0aGlzfSxnZXRBY3RpdmVPYmplY3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYWN0aXZlT2JqZWN0fSxfZGlzY2FyZEFjdGl2ZU9iamVjdDpmdW5jdGlvbigpe3RoaXMuX2FjdGl2ZU9iamVjdCYmdGhpcy5fYWN0aXZlT2JqZWN0LnNldChcImFjdGl2ZVwiLCExKSx0aGlzLl9hY3RpdmVPYmplY3Q9bnVsbH0sZGlzY2FyZEFjdGl2ZU9iamVjdDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fZGlzY2FyZEFjdGl2ZU9iamVjdCgpLHRoaXMucmVuZGVyQWxsKCksdGhpcy5maXJlKFwic2VsZWN0aW9uOmNsZWFyZWRcIix7ZTp0fSksdGhpc30sX3NldEFjdGl2ZUdyb3VwOmZ1bmN0aW9uKHQpe3RoaXMuX2FjdGl2ZUdyb3VwPXQsdCYmdC5zZXQoXCJhY3RpdmVcIiwhMCl9LHNldEFjdGl2ZUdyb3VwOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuX3NldEFjdGl2ZUdyb3VwKHQpLHQmJih0aGlzLmZpcmUoXCJvYmplY3Q6c2VsZWN0ZWRcIix7dGFyZ2V0OnQsZTplfSksdC5maXJlKFwic2VsZWN0ZWRcIix7ZTplfSkpLHRoaXN9LGdldEFjdGl2ZUdyb3VwOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZUdyb3VwfSxfZGlzY2FyZEFjdGl2ZUdyb3VwOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXRBY3RpdmVHcm91cCgpO3QmJnQuZGVzdHJveSgpLHRoaXMuc2V0QWN0aXZlR3JvdXAobnVsbCl9LGRpc2NhcmRBY3RpdmVHcm91cDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fZGlzY2FyZEFjdGl2ZUdyb3VwKCksdGhpcy5maXJlKFwic2VsZWN0aW9uOmNsZWFyZWRcIix7ZTp0fSksdGhpc30sZGVhY3RpdmF0ZUFsbDpmdW5jdGlvbigpe2Zvcih2YXIgdD10aGlzLmdldE9iamVjdHMoKSxlPTAsaT10Lmxlbmd0aDtpPmU7ZSsrKXRbZV0uc2V0KFwiYWN0aXZlXCIsITEpO3JldHVybiB0aGlzLl9kaXNjYXJkQWN0aXZlR3JvdXAoKSx0aGlzLl9kaXNjYXJkQWN0aXZlT2JqZWN0KCksdGhpc30sZGVhY3RpdmF0ZUFsbFdpdGhEaXNwYXRjaDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldEFjdGl2ZUdyb3VwKCl8fHRoaXMuZ2V0QWN0aXZlT2JqZWN0KCk7cmV0dXJuIGUmJnRoaXMuZmlyZShcImJlZm9yZTpzZWxlY3Rpb246Y2xlYXJlZFwiLHt0YXJnZXQ6ZSxlOnR9KSx0aGlzLmRlYWN0aXZhdGVBbGwoKSxlJiZ0aGlzLmZpcmUoXCJzZWxlY3Rpb246Y2xlYXJlZFwiLHtlOnR9KSx0aGlzfSxkcmF3Q29udHJvbHM6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXRBY3RpdmVHcm91cCgpO2U/dGhpcy5fZHJhd0dyb3VwQ29udHJvbHModCxlKTp0aGlzLl9kcmF3T2JqZWN0c0NvbnRyb2xzKHQpfSxfZHJhd0dyb3VwQ29udHJvbHM6ZnVuY3Rpb24odCxlKXtlLl9yZW5kZXJDb250cm9scyh0KX0sX2RyYXdPYmplY3RzQ29udHJvbHM6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTAsaT10aGlzLl9vYmplY3RzLmxlbmd0aDtpPmU7KytlKXRoaXMuX29iamVjdHNbZV0mJnRoaXMuX29iamVjdHNbZV0uYWN0aXZlJiYodGhpcy5fb2JqZWN0c1tlXS5fcmVuZGVyQ29udHJvbHModCksdGhpcy5sYXN0UmVuZGVyZWRPYmplY3RXaXRoQ29udHJvbHNBYm92ZU92ZXJsYXk9dGhpcy5fb2JqZWN0c1tlXSl9fSk7Zm9yKHZhciBvIGluIGZhYnJpYy5TdGF0aWNDYW52YXMpXCJwcm90b3R5cGVcIiE9PW8mJihmYWJyaWMuQ2FudmFzW29dPWZhYnJpYy5TdGF0aWNDYW52YXNbb10pO2ZhYnJpYy5pc1RvdWNoU3VwcG9ydGVkJiYoZmFicmljLkNhbnZhcy5wcm90b3R5cGUuX3NldEN1cnNvckZyb21FdmVudD1mdW5jdGlvbigpe30pLGZhYnJpYy5FbGVtZW50PWZhYnJpYy5DYW52YXN9KCksZnVuY3Rpb24oKXt2YXIgdD17bXQ6MCx0cjoxLG1yOjIsYnI6MyxtYjo0LGJsOjUsbWw6Nix0bDo3fSxlPWZhYnJpYy51dGlsLmFkZExpc3RlbmVyLGk9ZmFicmljLnV0aWwucmVtb3ZlTGlzdGVuZXI7ZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuQ2FudmFzLnByb3RvdHlwZSx7Y3Vyc29yTWFwOltcIm4tcmVzaXplXCIsXCJuZS1yZXNpemVcIixcImUtcmVzaXplXCIsXCJzZS1yZXNpemVcIixcInMtcmVzaXplXCIsXCJzdy1yZXNpemVcIixcInctcmVzaXplXCIsXCJudy1yZXNpemVcIl0sX2luaXRFdmVudExpc3RlbmVyczpmdW5jdGlvbigpe3RoaXMuX2JpbmRFdmVudHMoKSxlKGZhYnJpYy53aW5kb3csXCJyZXNpemVcIix0aGlzLl9vblJlc2l6ZSksZSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJtb3VzZWRvd25cIix0aGlzLl9vbk1vdXNlRG93biksZSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJtb3VzZW1vdmVcIix0aGlzLl9vbk1vdXNlTW92ZSksZSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJtb3VzZXdoZWVsXCIsdGhpcy5fb25Nb3VzZVdoZWVsKSxlKHRoaXMudXBwZXJDYW52YXNFbCxcInRvdWNoc3RhcnRcIix0aGlzLl9vbk1vdXNlRG93biksZSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJ0b3VjaG1vdmVcIix0aGlzLl9vbk1vdXNlTW92ZSksXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV2ZW50anMmJlwiYWRkXCJpbiBldmVudGpzJiYoZXZlbnRqcy5hZGQodGhpcy51cHBlckNhbnZhc0VsLFwiZ2VzdHVyZVwiLHRoaXMuX29uR2VzdHVyZSksZXZlbnRqcy5hZGQodGhpcy51cHBlckNhbnZhc0VsLFwiZHJhZ1wiLHRoaXMuX29uRHJhZyksZXZlbnRqcy5hZGQodGhpcy51cHBlckNhbnZhc0VsLFwib3JpZW50YXRpb25cIix0aGlzLl9vbk9yaWVudGF0aW9uQ2hhbmdlKSxldmVudGpzLmFkZCh0aGlzLnVwcGVyQ2FudmFzRWwsXCJzaGFrZVwiLHRoaXMuX29uU2hha2UpLGV2ZW50anMuYWRkKHRoaXMudXBwZXJDYW52YXNFbCxcImxvbmdwcmVzc1wiLHRoaXMuX29uTG9uZ1ByZXNzKSl9LF9iaW5kRXZlbnRzOmZ1bmN0aW9uKCl7dGhpcy5fb25Nb3VzZURvd249dGhpcy5fb25Nb3VzZURvd24uYmluZCh0aGlzKSx0aGlzLl9vbk1vdXNlTW92ZT10aGlzLl9vbk1vdXNlTW92ZS5iaW5kKHRoaXMpLHRoaXMuX29uTW91c2VVcD10aGlzLl9vbk1vdXNlVXAuYmluZCh0aGlzKSx0aGlzLl9vblJlc2l6ZT10aGlzLl9vblJlc2l6ZS5iaW5kKHRoaXMpLHRoaXMuX29uR2VzdHVyZT10aGlzLl9vbkdlc3R1cmUuYmluZCh0aGlzKSx0aGlzLl9vbkRyYWc9dGhpcy5fb25EcmFnLmJpbmQodGhpcyksdGhpcy5fb25TaGFrZT10aGlzLl9vblNoYWtlLmJpbmQodGhpcyksdGhpcy5fb25Mb25nUHJlc3M9dGhpcy5fb25Mb25nUHJlc3MuYmluZCh0aGlzKSx0aGlzLl9vbk9yaWVudGF0aW9uQ2hhbmdlPXRoaXMuX29uT3JpZW50YXRpb25DaGFuZ2UuYmluZCh0aGlzKSx0aGlzLl9vbk1vdXNlV2hlZWw9dGhpcy5fb25Nb3VzZVdoZWVsLmJpbmQodGhpcyl9LHJlbW92ZUxpc3RlbmVyczpmdW5jdGlvbigpe2koZmFicmljLndpbmRvdyxcInJlc2l6ZVwiLHRoaXMuX29uUmVzaXplKSxpKHRoaXMudXBwZXJDYW52YXNFbCxcIm1vdXNlZG93blwiLHRoaXMuX29uTW91c2VEb3duKSxpKHRoaXMudXBwZXJDYW52YXNFbCxcIm1vdXNlbW92ZVwiLHRoaXMuX29uTW91c2VNb3ZlKSxpKHRoaXMudXBwZXJDYW52YXNFbCxcIm1vdXNld2hlZWxcIix0aGlzLl9vbk1vdXNlV2hlZWwpLGkodGhpcy51cHBlckNhbnZhc0VsLFwidG91Y2hzdGFydFwiLHRoaXMuX29uTW91c2VEb3duKSxpKHRoaXMudXBwZXJDYW52YXNFbCxcInRvdWNobW92ZVwiLHRoaXMuX29uTW91c2VNb3ZlKSxcInVuZGVmaW5lZFwiIT10eXBlb2YgZXZlbnRqcyYmXCJyZW1vdmVcImluIGV2ZW50anMmJihldmVudGpzLnJlbW92ZSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJnZXN0dXJlXCIsdGhpcy5fb25HZXN0dXJlKSxldmVudGpzLnJlbW92ZSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJkcmFnXCIsdGhpcy5fb25EcmFnKSxldmVudGpzLnJlbW92ZSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJvcmllbnRhdGlvblwiLHRoaXMuX29uT3JpZW50YXRpb25DaGFuZ2UpLGV2ZW50anMucmVtb3ZlKHRoaXMudXBwZXJDYW52YXNFbCxcInNoYWtlXCIsdGhpcy5fb25TaGFrZSksZXZlbnRqcy5yZW1vdmUodGhpcy51cHBlckNhbnZhc0VsLFwibG9uZ3ByZXNzXCIsdGhpcy5fb25Mb25nUHJlc3MpKX0sX29uR2VzdHVyZTpmdW5jdGlvbih0LGUpe3RoaXMuX19vblRyYW5zZm9ybUdlc3R1cmUmJnRoaXMuX19vblRyYW5zZm9ybUdlc3R1cmUodCxlKX0sX29uRHJhZzpmdW5jdGlvbih0LGUpe3RoaXMuX19vbkRyYWcmJnRoaXMuX19vbkRyYWcodCxlKX0sX29uTW91c2VXaGVlbDpmdW5jdGlvbih0LGUpe3RoaXMuX19vbk1vdXNlV2hlZWwmJnRoaXMuX19vbk1vdXNlV2hlZWwodCxlKX0sX29uT3JpZW50YXRpb25DaGFuZ2U6ZnVuY3Rpb24odCxlKXt0aGlzLl9fb25PcmllbnRhdGlvbkNoYW5nZSYmdGhpcy5fX29uT3JpZW50YXRpb25DaGFuZ2UodCxlKX0sX29uU2hha2U6ZnVuY3Rpb24odCxlKXt0aGlzLl9fb25TaGFrZSYmdGhpcy5fX29uU2hha2UodCxlKX0sX29uTG9uZ1ByZXNzOmZ1bmN0aW9uKHQsZSl7dGhpcy5fX29uTG9uZ1ByZXNzJiZ0aGlzLl9fb25Mb25nUHJlc3ModCxlKX0sX29uTW91c2VEb3duOmZ1bmN0aW9uKHQpe3RoaXMuX19vbk1vdXNlRG93bih0KSxlKGZhYnJpYy5kb2N1bWVudCxcInRvdWNoZW5kXCIsdGhpcy5fb25Nb3VzZVVwKSxlKGZhYnJpYy5kb2N1bWVudCxcInRvdWNobW92ZVwiLHRoaXMuX29uTW91c2VNb3ZlKSxpKHRoaXMudXBwZXJDYW52YXNFbCxcIm1vdXNlbW92ZVwiLHRoaXMuX29uTW91c2VNb3ZlKSxpKHRoaXMudXBwZXJDYW52YXNFbCxcInRvdWNobW92ZVwiLHRoaXMuX29uTW91c2VNb3ZlKSxcInRvdWNoc3RhcnRcIj09PXQudHlwZT9pKHRoaXMudXBwZXJDYW52YXNFbCxcIm1vdXNlZG93blwiLHRoaXMuX29uTW91c2VEb3duKTooZShmYWJyaWMuZG9jdW1lbnQsXCJtb3VzZXVwXCIsdGhpcy5fb25Nb3VzZVVwKSxlKGZhYnJpYy5kb2N1bWVudCxcIm1vdXNlbW92ZVwiLHRoaXMuX29uTW91c2VNb3ZlKSl9LF9vbk1vdXNlVXA6ZnVuY3Rpb24odCl7aWYodGhpcy5fX29uTW91c2VVcCh0KSxpKGZhYnJpYy5kb2N1bWVudCxcIm1vdXNldXBcIix0aGlzLl9vbk1vdXNlVXApLGkoZmFicmljLmRvY3VtZW50LFwidG91Y2hlbmRcIix0aGlzLl9vbk1vdXNlVXApLGkoZmFicmljLmRvY3VtZW50LFwibW91c2Vtb3ZlXCIsdGhpcy5fb25Nb3VzZU1vdmUpLGkoZmFicmljLmRvY3VtZW50LFwidG91Y2htb3ZlXCIsdGhpcy5fb25Nb3VzZU1vdmUpLGUodGhpcy51cHBlckNhbnZhc0VsLFwibW91c2Vtb3ZlXCIsdGhpcy5fb25Nb3VzZU1vdmUpLGUodGhpcy51cHBlckNhbnZhc0VsLFwidG91Y2htb3ZlXCIsdGhpcy5fb25Nb3VzZU1vdmUpLFwidG91Y2hlbmRcIj09PXQudHlwZSl7dmFyIHI9dGhpcztzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZShyLnVwcGVyQ2FudmFzRWwsXCJtb3VzZWRvd25cIixyLl9vbk1vdXNlRG93bil9LDQwMCl9fSxfb25Nb3VzZU1vdmU6ZnVuY3Rpb24odCl7IXRoaXMuYWxsb3dUb3VjaFNjcm9sbGluZyYmdC5wcmV2ZW50RGVmYXVsdCYmdC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuX19vbk1vdXNlTW92ZSh0KX0sX29uUmVzaXplOmZ1bmN0aW9uKCl7dGhpcy5jYWxjT2Zmc2V0KCl9LF9zaG91bGRSZW5kZXI6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLmdldEFjdGl2ZUdyb3VwKCl8fHRoaXMuZ2V0QWN0aXZlT2JqZWN0KCk7cmV0dXJuISEodCYmKHQuaXNNb3Zpbmd8fHQhPT1pKXx8IXQmJml8fCF0JiYhaSYmIXRoaXMuX2dyb3VwU2VsZWN0b3J8fGUmJnRoaXMuX3ByZXZpb3VzUG9pbnRlciYmdGhpcy5zZWxlY3Rpb24mJihlLnghPT10aGlzLl9wcmV2aW91c1BvaW50ZXIueHx8ZS55IT09dGhpcy5fcHJldmlvdXNQb2ludGVyLnkpKX0sX19vbk1vdXNlVXA6ZnVuY3Rpb24odCl7dmFyIGU7aWYodGhpcy5pc0RyYXdpbmdNb2RlJiZ0aGlzLl9pc0N1cnJlbnRseURyYXdpbmcpcmV0dXJuIHZvaWQgdGhpcy5fb25Nb3VzZVVwSW5EcmF3aW5nTW9kZSh0KTt0aGlzLl9jdXJyZW50VHJhbnNmb3JtPyh0aGlzLl9maW5hbGl6ZUN1cnJlbnRUcmFuc2Zvcm0oKSxlPXRoaXMuX2N1cnJlbnRUcmFuc2Zvcm0udGFyZ2V0KTplPXRoaXMuZmluZFRhcmdldCh0LCEwKTt2YXIgaT10aGlzLl9zaG91bGRSZW5kZXIoZSx0aGlzLmdldFBvaW50ZXIodCkpO3RoaXMuX21heWJlR3JvdXBPYmplY3RzKHQpLGUmJihlLmlzTW92aW5nPSExKSxpJiZ0aGlzLnJlbmRlckFsbCgpLHRoaXMuX2hhbmRsZUN1cnNvckFuZEV2ZW50KHQsZSl9LF9oYW5kbGVDdXJzb3JBbmRFdmVudDpmdW5jdGlvbih0LGUpe3RoaXMuX3NldEN1cnNvckZyb21FdmVudCh0LGUpO3ZhciBpPXRoaXM7c2V0VGltZW91dChmdW5jdGlvbigpe2kuX3NldEN1cnNvckZyb21FdmVudCh0LGUpfSw1MCksdGhpcy5maXJlKFwibW91c2U6dXBcIix7dGFyZ2V0OmUsZTp0fSksZSYmZS5maXJlKFwibW91c2V1cFwiLHtlOnR9KX0sX2ZpbmFsaXplQ3VycmVudFRyYW5zZm9ybTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX2N1cnJlbnRUcmFuc2Zvcm0sZT10LnRhcmdldDtlLl9zY2FsaW5nJiYoZS5fc2NhbGluZz0hMSksZS5zZXRDb29yZHMoKSx0aGlzLnN0YXRlZnVsJiZlLmhhc1N0YXRlQ2hhbmdlZCgpJiYodGhpcy5maXJlKFwib2JqZWN0Om1vZGlmaWVkXCIse3RhcmdldDplfSksZS5maXJlKFwibW9kaWZpZWRcIikpLHRoaXMuX3Jlc3RvcmVPcmlnaW5YWShlKX0sX3Jlc3RvcmVPcmlnaW5YWTpmdW5jdGlvbih0KXtpZih0aGlzLl9wcmV2aW91c09yaWdpblgmJnRoaXMuX3ByZXZpb3VzT3JpZ2luWSl7dmFyIGU9dC50cmFuc2xhdGVUb09yaWdpblBvaW50KHQuZ2V0Q2VudGVyUG9pbnQoKSx0aGlzLl9wcmV2aW91c09yaWdpblgsdGhpcy5fcHJldmlvdXNPcmlnaW5ZKTt0Lm9yaWdpblg9dGhpcy5fcHJldmlvdXNPcmlnaW5YLHQub3JpZ2luWT10aGlzLl9wcmV2aW91c09yaWdpblksdC5sZWZ0PWUueCx0LnRvcD1lLnksdGhpcy5fcHJldmlvdXNPcmlnaW5YPW51bGwsdGhpcy5fcHJldmlvdXNPcmlnaW5ZPW51bGx9fSxfb25Nb3VzZURvd25JbkRyYXdpbmdNb2RlOmZ1bmN0aW9uKHQpe3RoaXMuX2lzQ3VycmVudGx5RHJhd2luZz0hMCx0aGlzLmRpc2NhcmRBY3RpdmVPYmplY3QodCkucmVuZGVyQWxsKCksdGhpcy5jbGlwVG8mJmZhYnJpYy51dGlsLmNsaXBDb250ZXh0KHRoaXMsdGhpcy5jb250ZXh0VG9wKTt2YXIgZT1mYWJyaWMudXRpbC5pbnZlcnRUcmFuc2Zvcm0odGhpcy52aWV3cG9ydFRyYW5zZm9ybSksaT1mYWJyaWMudXRpbC50cmFuc2Zvcm1Qb2ludCh0aGlzLmdldFBvaW50ZXIodCwhMCksZSk7dGhpcy5mcmVlRHJhd2luZ0JydXNoLm9uTW91c2VEb3duKGkpLHRoaXMuZmlyZShcIm1vdXNlOmRvd25cIix7ZTp0fSk7dmFyIHI9dGhpcy5maW5kVGFyZ2V0KHQpO1widW5kZWZpbmVkXCIhPXR5cGVvZiByJiZyLmZpcmUoXCJtb3VzZWRvd25cIix7ZTp0LHRhcmdldDpyfSl9LF9vbk1vdXNlTW92ZUluRHJhd2luZ01vZGU6ZnVuY3Rpb24odCl7aWYodGhpcy5faXNDdXJyZW50bHlEcmF3aW5nKXt2YXIgZT1mYWJyaWMudXRpbC5pbnZlcnRUcmFuc2Zvcm0odGhpcy52aWV3cG9ydFRyYW5zZm9ybSksaT1mYWJyaWMudXRpbC50cmFuc2Zvcm1Qb2ludCh0aGlzLmdldFBvaW50ZXIodCwhMCksZSk7dGhpcy5mcmVlRHJhd2luZ0JydXNoLm9uTW91c2VNb3ZlKGkpfXRoaXMuc2V0Q3Vyc29yKHRoaXMuZnJlZURyYXdpbmdDdXJzb3IpLHRoaXMuZmlyZShcIm1vdXNlOm1vdmVcIix7ZTp0fSk7dmFyIHI9dGhpcy5maW5kVGFyZ2V0KHQpO1widW5kZWZpbmVkXCIhPXR5cGVvZiByJiZyLmZpcmUoXCJtb3VzZW1vdmVcIix7ZTp0LHRhcmdldDpyfSl9LF9vbk1vdXNlVXBJbkRyYXdpbmdNb2RlOmZ1bmN0aW9uKHQpe3RoaXMuX2lzQ3VycmVudGx5RHJhd2luZz0hMSx0aGlzLmNsaXBUbyYmdGhpcy5jb250ZXh0VG9wLnJlc3RvcmUoKSx0aGlzLmZyZWVEcmF3aW5nQnJ1c2gub25Nb3VzZVVwKCksdGhpcy5maXJlKFwibW91c2U6dXBcIix7ZTp0fSk7dmFyIGU9dGhpcy5maW5kVGFyZ2V0KHQpO1widW5kZWZpbmVkXCIhPXR5cGVvZiBlJiZlLmZpcmUoXCJtb3VzZXVwXCIse2U6dCx0YXJnZXQ6ZX0pfSxfX29uTW91c2VEb3duOmZ1bmN0aW9uKHQpe3ZhciBlPVwid2hpY2hcImluIHQ/MT09PXQud2hpY2g6MT09PXQuYnV0dG9uO2lmKGV8fGZhYnJpYy5pc1RvdWNoU3VwcG9ydGVkKXtpZih0aGlzLmlzRHJhd2luZ01vZGUpcmV0dXJuIHZvaWQgdGhpcy5fb25Nb3VzZURvd25JbkRyYXdpbmdNb2RlKHQpO2lmKCF0aGlzLl9jdXJyZW50VHJhbnNmb3JtKXt2YXIgaT10aGlzLmZpbmRUYXJnZXQodCkscj10aGlzLmdldFBvaW50ZXIodCwhMCk7dGhpcy5fcHJldmlvdXNQb2ludGVyPXI7dmFyIHM9dGhpcy5fc2hvdWxkUmVuZGVyKGksciksbj10aGlzLl9zaG91bGRHcm91cCh0LGkpO3RoaXMuX3Nob3VsZENsZWFyU2VsZWN0aW9uKHQsaSk/dGhpcy5fY2xlYXJTZWxlY3Rpb24odCxpLHIpOm4mJih0aGlzLl9oYW5kbGVHcm91cGluZyh0LGkpLGk9dGhpcy5nZXRBY3RpdmVHcm91cCgpKSxpJiZpLnNlbGVjdGFibGUmJiFuJiYodGhpcy5fYmVmb3JlVHJhbnNmb3JtKHQsaSksdGhpcy5fc2V0dXBDdXJyZW50VHJhbnNmb3JtKHQsaSkpLHMmJnRoaXMucmVuZGVyQWxsKCksdGhpcy5maXJlKFwibW91c2U6ZG93blwiLHt0YXJnZXQ6aSxlOnR9KSxpJiZpLmZpcmUoXCJtb3VzZWRvd25cIix7ZTp0fSl9fX0sX2JlZm9yZVRyYW5zZm9ybTpmdW5jdGlvbih0LGUpe3RoaXMuc3RhdGVmdWwmJmUuc2F2ZVN0YXRlKCksZS5fZmluZFRhcmdldENvcm5lcih0aGlzLmdldFBvaW50ZXIodCkpJiZ0aGlzLm9uQmVmb3JlU2NhbGVSb3RhdGUoZSksZSE9PXRoaXMuZ2V0QWN0aXZlR3JvdXAoKSYmZSE9PXRoaXMuZ2V0QWN0aXZlT2JqZWN0KCkmJih0aGlzLmRlYWN0aXZhdGVBbGwoKSx0aGlzLnNldEFjdGl2ZU9iamVjdChlLHQpKX0sX2NsZWFyU2VsZWN0aW9uOmZ1bmN0aW9uKHQsZSxpKXt0aGlzLmRlYWN0aXZhdGVBbGxXaXRoRGlzcGF0Y2godCksZSYmZS5zZWxlY3RhYmxlP3RoaXMuc2V0QWN0aXZlT2JqZWN0KGUsdCk6dGhpcy5zZWxlY3Rpb24mJih0aGlzLl9ncm91cFNlbGVjdG9yPXtleDppLngsZXk6aS55LHRvcDowLGxlZnQ6MH0pfSxfc2V0T3JpZ2luVG9DZW50ZXI6ZnVuY3Rpb24odCl7dGhpcy5fcHJldmlvdXNPcmlnaW5YPXRoaXMuX2N1cnJlbnRUcmFuc2Zvcm0udGFyZ2V0Lm9yaWdpblgsdGhpcy5fcHJldmlvdXNPcmlnaW5ZPXRoaXMuX2N1cnJlbnRUcmFuc2Zvcm0udGFyZ2V0Lm9yaWdpblk7dmFyIGU9dC5nZXRDZW50ZXJQb2ludCgpO3Qub3JpZ2luWD1cImNlbnRlclwiLHQub3JpZ2luWT1cImNlbnRlclwiLHQubGVmdD1lLngsdC50b3A9ZS55LHRoaXMuX2N1cnJlbnRUcmFuc2Zvcm0ubGVmdD10LmxlZnQsdGhpcy5fY3VycmVudFRyYW5zZm9ybS50b3A9dC50b3B9LF9zZXRDZW50ZXJUb09yaWdpbjpmdW5jdGlvbih0KXt2YXIgZT10LnRyYW5zbGF0ZVRvT3JpZ2luUG9pbnQodC5nZXRDZW50ZXJQb2ludCgpLHRoaXMuX3ByZXZpb3VzT3JpZ2luWCx0aGlzLl9wcmV2aW91c09yaWdpblkpO3Qub3JpZ2luWD10aGlzLl9wcmV2aW91c09yaWdpblgsdC5vcmlnaW5ZPXRoaXMuX3ByZXZpb3VzT3JpZ2luWSx0LmxlZnQ9ZS54LHQudG9wPWUueSx0aGlzLl9wcmV2aW91c09yaWdpblg9bnVsbCx0aGlzLl9wcmV2aW91c09yaWdpblk9bnVsbH0sX19vbk1vdXNlTW92ZTpmdW5jdGlvbih0KXt2YXIgZSxpO2lmKHRoaXMuaXNEcmF3aW5nTW9kZSlyZXR1cm4gdm9pZCB0aGlzLl9vbk1vdXNlTW92ZUluRHJhd2luZ01vZGUodCk7aWYoIShcInVuZGVmaW5lZFwiIT10eXBlb2YgdC50b3VjaGVzJiZ0LnRvdWNoZXMubGVuZ3RoPjEpKXt2YXIgcj10aGlzLl9ncm91cFNlbGVjdG9yO3I/KGk9dGhpcy5nZXRQb2ludGVyKHQsITApLHIubGVmdD1pLngtci5leCxyLnRvcD1pLnktci5leSx0aGlzLnJlbmRlclRvcCgpKTp0aGlzLl9jdXJyZW50VHJhbnNmb3JtP3RoaXMuX3RyYW5zZm9ybU9iamVjdCh0KTooZT10aGlzLmZpbmRUYXJnZXQodCksIWV8fGUmJiFlLnNlbGVjdGFibGU/dGhpcy5zZXRDdXJzb3IodGhpcy5kZWZhdWx0Q3Vyc29yKTp0aGlzLl9zZXRDdXJzb3JGcm9tRXZlbnQodCxlKSksdGhpcy5maXJlKFwibW91c2U6bW92ZVwiLHt0YXJnZXQ6ZSxlOnR9KSxlJiZlLmZpcmUoXCJtb3VzZW1vdmVcIix7ZTp0fSl9fSxfdHJhbnNmb3JtT2JqZWN0OmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0UG9pbnRlcih0KSxpPXRoaXMuX2N1cnJlbnRUcmFuc2Zvcm07aS5yZXNldD0hMSxpLnRhcmdldC5pc01vdmluZz0hMCx0aGlzLl9iZWZvcmVTY2FsZVRyYW5zZm9ybSh0LGkpLHRoaXMuX3BlcmZvcm1UcmFuc2Zvcm1BY3Rpb24odCxpLGUpLHRoaXMucmVuZGVyQWxsKCl9LF9wZXJmb3JtVHJhbnNmb3JtQWN0aW9uOmZ1bmN0aW9uKHQsZSxpKXt2YXIgcj1pLngscz1pLnksbj1lLnRhcmdldCxvPWUuYWN0aW9uO1wicm90YXRlXCI9PT1vPyh0aGlzLl9yb3RhdGVPYmplY3QocixzKSx0aGlzLl9maXJlKFwicm90YXRpbmdcIixuLHQpKTpcInNjYWxlXCI9PT1vPyh0aGlzLl9vblNjYWxlKHQsZSxyLHMpLHRoaXMuX2ZpcmUoXCJzY2FsaW5nXCIsbix0KSk6XCJzY2FsZVhcIj09PW8/KHRoaXMuX3NjYWxlT2JqZWN0KHIscyxcInhcIiksdGhpcy5fZmlyZShcInNjYWxpbmdcIixuLHQpKTpcInNjYWxlWVwiPT09bz8odGhpcy5fc2NhbGVPYmplY3QocixzLFwieVwiKSx0aGlzLl9maXJlKFwic2NhbGluZ1wiLG4sdCkpOih0aGlzLl90cmFuc2xhdGVPYmplY3QocixzKSx0aGlzLl9maXJlKFwibW92aW5nXCIsbix0KSx0aGlzLnNldEN1cnNvcih0aGlzLm1vdmVDdXJzb3IpKX0sX2ZpcmU6ZnVuY3Rpb24odCxlLGkpe3RoaXMuZmlyZShcIm9iamVjdDpcIit0LHt0YXJnZXQ6ZSxlOml9KSxlLmZpcmUodCx7ZTppfSl9LF9iZWZvcmVTY2FsZVRyYW5zZm9ybTpmdW5jdGlvbih0LGUpe2lmKFwic2NhbGVcIj09PWUuYWN0aW9ufHxcInNjYWxlWFwiPT09ZS5hY3Rpb258fFwic2NhbGVZXCI9PT1lLmFjdGlvbil7dmFyIGk9dGhpcy5fc2hvdWxkQ2VudGVyVHJhbnNmb3JtKHQsZS50YXJnZXQpOyhpJiYoXCJjZW50ZXJcIiE9PWUub3JpZ2luWHx8XCJjZW50ZXJcIiE9PWUub3JpZ2luWSl8fCFpJiZcImNlbnRlclwiPT09ZS5vcmlnaW5YJiZcImNlbnRlclwiPT09ZS5vcmlnaW5ZKSYmKHRoaXMuX3Jlc2V0Q3VycmVudFRyYW5zZm9ybSh0KSxlLnJlc2V0PSEwKX19LF9vblNjYWxlOmZ1bmN0aW9uKHQsZSxpLHIpeyF0LnNoaWZ0S2V5JiYhdGhpcy51bmlTY2FsZVRyYW5zZm9ybXx8ZS50YXJnZXQuZ2V0KFwibG9ja1VuaVNjYWxpbmdcIik/KGUucmVzZXR8fFwic2NhbGVcIiE9PWUuY3VycmVudEFjdGlvbnx8dGhpcy5fcmVzZXRDdXJyZW50VHJhbnNmb3JtKHQsZS50YXJnZXQpLGUuY3VycmVudEFjdGlvbj1cInNjYWxlRXF1YWxseVwiLHRoaXMuX3NjYWxlT2JqZWN0KGkscixcImVxdWFsbHlcIikpOihlLmN1cnJlbnRBY3Rpb249XCJzY2FsZVwiLHRoaXMuX3NjYWxlT2JqZWN0KGkscikpO1xyXG5cclxufSxfc2V0Q3Vyc29yRnJvbUV2ZW50OmZ1bmN0aW9uKHQsZSl7aWYoIWV8fCFlLnNlbGVjdGFibGUpcmV0dXJuIHRoaXMuc2V0Q3Vyc29yKHRoaXMuZGVmYXVsdEN1cnNvciksITE7dmFyIGk9dGhpcy5nZXRBY3RpdmVHcm91cCgpLHI9ZS5fZmluZFRhcmdldENvcm5lciYmKCFpfHwhaS5jb250YWlucyhlKSkmJmUuX2ZpbmRUYXJnZXRDb3JuZXIodGhpcy5nZXRQb2ludGVyKHQsITApKTtyZXR1cm4gcj90aGlzLl9zZXRDb3JuZXJDdXJzb3IocixlKTp0aGlzLnNldEN1cnNvcihlLmhvdmVyQ3Vyc29yfHx0aGlzLmhvdmVyQ3Vyc29yKSwhMH0sX3NldENvcm5lckN1cnNvcjpmdW5jdGlvbihlLGkpe2lmKGUgaW4gdCl0aGlzLnNldEN1cnNvcih0aGlzLl9nZXRSb3RhdGVkQ29ybmVyQ3Vyc29yKGUsaSkpO2Vsc2V7aWYoXCJtdHJcIiE9PWV8fCFpLmhhc1JvdGF0aW5nUG9pbnQpcmV0dXJuIHRoaXMuc2V0Q3Vyc29yKHRoaXMuZGVmYXVsdEN1cnNvciksITE7dGhpcy5zZXRDdXJzb3IodGhpcy5yb3RhdGlvbkN1cnNvcil9fSxfZ2V0Um90YXRlZENvcm5lckN1cnNvcjpmdW5jdGlvbihlLGkpe3ZhciByPU1hdGgucm91bmQoaS5nZXRBbmdsZSgpJTM2MC80NSk7cmV0dXJuIDA+ciYmKHIrPTgpLHIrPXRbZV0sciU9OCx0aGlzLmN1cnNvck1hcFtyXX19KX0oKSxmdW5jdGlvbigpe3ZhciB0PU1hdGgubWluLGU9TWF0aC5tYXg7ZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuQ2FudmFzLnByb3RvdHlwZSx7X3Nob3VsZEdyb3VwOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5nZXRBY3RpdmVPYmplY3QoKTtyZXR1cm4gdC5zaGlmdEtleSYmKHRoaXMuZ2V0QWN0aXZlR3JvdXAoKXx8aSYmaSE9PWUpJiZ0aGlzLnNlbGVjdGlvbn0sX2hhbmRsZUdyb3VwaW5nOmZ1bmN0aW9uKHQsZSl7KGUhPT10aGlzLmdldEFjdGl2ZUdyb3VwKCl8fChlPXRoaXMuZmluZFRhcmdldCh0LCEwKSxlJiYhZS5pc1R5cGUoXCJncm91cFwiKSkpJiYodGhpcy5nZXRBY3RpdmVHcm91cCgpP3RoaXMuX3VwZGF0ZUFjdGl2ZUdyb3VwKGUsdCk6dGhpcy5fY3JlYXRlQWN0aXZlR3JvdXAoZSx0KSx0aGlzLl9hY3RpdmVHcm91cCYmdGhpcy5fYWN0aXZlR3JvdXAuc2F2ZUNvb3JkcygpKX0sX3VwZGF0ZUFjdGl2ZUdyb3VwOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5nZXRBY3RpdmVHcm91cCgpO2lmKGkuY29udGFpbnModCkpe2lmKGkucmVtb3ZlV2l0aFVwZGF0ZSh0KSx0aGlzLl9yZXNldE9iamVjdFRyYW5zZm9ybShpKSx0LnNldChcImFjdGl2ZVwiLCExKSwxPT09aS5zaXplKCkpcmV0dXJuIHRoaXMuZGlzY2FyZEFjdGl2ZUdyb3VwKGUpLHZvaWQgdGhpcy5zZXRBY3RpdmVPYmplY3QoaS5pdGVtKDApKX1lbHNlIGkuYWRkV2l0aFVwZGF0ZSh0KSx0aGlzLl9yZXNldE9iamVjdFRyYW5zZm9ybShpKTt0aGlzLmZpcmUoXCJzZWxlY3Rpb246Y3JlYXRlZFwiLHt0YXJnZXQ6aSxlOmV9KSxpLnNldChcImFjdGl2ZVwiLCEwKX0sX2NyZWF0ZUFjdGl2ZUdyb3VwOmZ1bmN0aW9uKHQsZSl7aWYodGhpcy5fYWN0aXZlT2JqZWN0JiZ0IT09dGhpcy5fYWN0aXZlT2JqZWN0KXt2YXIgaT10aGlzLl9jcmVhdGVHcm91cCh0KTtpLmFkZFdpdGhVcGRhdGUoKSx0aGlzLnNldEFjdGl2ZUdyb3VwKGkpLHRoaXMuX2FjdGl2ZU9iamVjdD1udWxsLHRoaXMuZmlyZShcInNlbGVjdGlvbjpjcmVhdGVkXCIse3RhcmdldDppLGU6ZX0pfXQuc2V0KFwiYWN0aXZlXCIsITApfSxfY3JlYXRlR3JvdXA6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXRPYmplY3RzKCksaT1lLmluZGV4T2YodGhpcy5fYWN0aXZlT2JqZWN0KTxlLmluZGV4T2YodCkscj1pP1t0aGlzLl9hY3RpdmVPYmplY3QsdF06W3QsdGhpcy5fYWN0aXZlT2JqZWN0XTtyZXR1cm4gbmV3IGZhYnJpYy5Hcm91cChyLHtjYW52YXM6dGhpc30pfSxfZ3JvdXBTZWxlY3RlZE9iamVjdHM6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fY29sbGVjdE9iamVjdHMoKTsxPT09ZS5sZW5ndGg/dGhpcy5zZXRBY3RpdmVPYmplY3QoZVswXSx0KTplLmxlbmd0aD4xJiYoZT1uZXcgZmFicmljLkdyb3VwKGUucmV2ZXJzZSgpLHtjYW52YXM6dGhpc30pLGUuYWRkV2l0aFVwZGF0ZSgpLHRoaXMuc2V0QWN0aXZlR3JvdXAoZSx0KSxlLnNhdmVDb29yZHMoKSx0aGlzLmZpcmUoXCJzZWxlY3Rpb246Y3JlYXRlZFwiLHt0YXJnZXQ6ZX0pLHRoaXMucmVuZGVyQWxsKCkpfSxfY29sbGVjdE9iamVjdHM6ZnVuY3Rpb24oKXtmb3IodmFyIGkscj1bXSxzPXRoaXMuX2dyb3VwU2VsZWN0b3IuZXgsbj10aGlzLl9ncm91cFNlbGVjdG9yLmV5LG89cyt0aGlzLl9ncm91cFNlbGVjdG9yLmxlZnQsYT1uK3RoaXMuX2dyb3VwU2VsZWN0b3IudG9wLGg9bmV3IGZhYnJpYy5Qb2ludCh0KHMsbyksdChuLGEpKSxjPW5ldyBmYWJyaWMuUG9pbnQoZShzLG8pLGUobixhKSksbD1zPT09byYmbj09PWEsdT10aGlzLl9vYmplY3RzLmxlbmd0aDt1LS0mJihpPXRoaXMuX29iamVjdHNbdV0sIShpJiZpLnNlbGVjdGFibGUmJmkudmlzaWJsZSYmKGkuaW50ZXJzZWN0c1dpdGhSZWN0KGgsYyl8fGkuaXNDb250YWluZWRXaXRoaW5SZWN0KGgsYyl8fGkuY29udGFpbnNQb2ludChoKXx8aS5jb250YWluc1BvaW50KGMpKSYmKGkuc2V0KFwiYWN0aXZlXCIsITApLHIucHVzaChpKSxsKSkpOyk7cmV0dXJuIHJ9LF9tYXliZUdyb3VwT2JqZWN0czpmdW5jdGlvbih0KXt0aGlzLnNlbGVjdGlvbiYmdGhpcy5fZ3JvdXBTZWxlY3RvciYmdGhpcy5fZ3JvdXBTZWxlY3RlZE9iamVjdHModCk7dmFyIGU9dGhpcy5nZXRBY3RpdmVHcm91cCgpO2UmJihlLnNldE9iamVjdHNDb29yZHMoKS5zZXRDb29yZHMoKSxlLmlzTW92aW5nPSExLHRoaXMuc2V0Q3Vyc29yKHRoaXMuZGVmYXVsdEN1cnNvcikpLHRoaXMuX2dyb3VwU2VsZWN0b3I9bnVsbCx0aGlzLl9jdXJyZW50VHJhbnNmb3JtPW51bGx9fSl9KCksZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZSx7dG9EYXRhVVJMOmZ1bmN0aW9uKHQpe3R8fCh0PXt9KTt2YXIgZT10LmZvcm1hdHx8XCJwbmdcIixpPXQucXVhbGl0eXx8MSxyPXQubXVsdGlwbGllcnx8MSxzPXtsZWZ0OnQubGVmdCx0b3A6dC50b3Asd2lkdGg6dC53aWR0aCxoZWlnaHQ6dC5oZWlnaHR9O3JldHVybiAxIT09cj90aGlzLl9fdG9EYXRhVVJMV2l0aE11bHRpcGxpZXIoZSxpLHMscik6dGhpcy5fX3RvRGF0YVVSTChlLGkscyl9LF9fdG9EYXRhVVJMOmZ1bmN0aW9uKHQsZSxpKXt0aGlzLnJlbmRlckFsbCghMCk7dmFyIHI9dGhpcy51cHBlckNhbnZhc0VsfHx0aGlzLmxvd2VyQ2FudmFzRWwscz10aGlzLl9fZ2V0Q3JvcHBlZENhbnZhcyhyLGkpO1wianBnXCI9PT10JiYodD1cImpwZWdcIik7dmFyIG49ZmFicmljLlN0YXRpY0NhbnZhcy5zdXBwb3J0cyhcInRvRGF0YVVSTFdpdGhRdWFsaXR5XCIpPyhzfHxyKS50b0RhdGFVUkwoXCJpbWFnZS9cIit0LGUpOihzfHxyKS50b0RhdGFVUkwoXCJpbWFnZS9cIit0KTtyZXR1cm4gdGhpcy5jb250ZXh0VG9wJiZ0aGlzLmNsZWFyQ29udGV4dCh0aGlzLmNvbnRleHRUb3ApLHRoaXMucmVuZGVyQWxsKCkscyYmKHM9bnVsbCksbn0sX19nZXRDcm9wcGVkQ2FudmFzOmZ1bmN0aW9uKHQsZSl7dmFyIGkscixzPVwibGVmdFwiaW4gZXx8XCJ0b3BcImluIGV8fFwid2lkdGhcImluIGV8fFwiaGVpZ2h0XCJpbiBlO3JldHVybiBzJiYoaT1mYWJyaWMudXRpbC5jcmVhdGVDYW52YXNFbGVtZW50KCkscj1pLmdldENvbnRleHQoXCIyZFwiKSxpLndpZHRoPWUud2lkdGh8fHRoaXMud2lkdGgsaS5oZWlnaHQ9ZS5oZWlnaHR8fHRoaXMuaGVpZ2h0LHIuZHJhd0ltYWdlKHQsLWUubGVmdHx8MCwtZS50b3B8fDApKSxpfSxfX3RvRGF0YVVSTFdpdGhNdWx0aXBsaWVyOmZ1bmN0aW9uKHQsZSxpLHIpe3ZhciBzPXRoaXMuZ2V0V2lkdGgoKSxuPXRoaXMuZ2V0SGVpZ2h0KCksbz1zKnIsYT1uKnIsaD10aGlzLmdldEFjdGl2ZU9iamVjdCgpLGM9dGhpcy5nZXRBY3RpdmVHcm91cCgpLGw9dGhpcy5jb250ZXh0VG9wfHx0aGlzLmNvbnRleHRDb250YWluZXI7cj4xJiZ0aGlzLnNldFdpZHRoKG8pLnNldEhlaWdodChhKSxsLnNjYWxlKHIsciksaS5sZWZ0JiYoaS5sZWZ0Kj1yKSxpLnRvcCYmKGkudG9wKj1yKSxpLndpZHRoP2kud2lkdGgqPXI6MT5yJiYoaS53aWR0aD1vKSxpLmhlaWdodD9pLmhlaWdodCo9cjoxPnImJihpLmhlaWdodD1hKSxjP3RoaXMuX3RlbXBSZW1vdmVCb3JkZXJzQ29udHJvbHNGcm9tR3JvdXAoYyk6aCYmdGhpcy5kZWFjdGl2YXRlQWxsJiZ0aGlzLmRlYWN0aXZhdGVBbGwoKSx0aGlzLnJlbmRlckFsbCghMCk7dmFyIHU9dGhpcy5fX3RvRGF0YVVSTCh0LGUsaSk7cmV0dXJuIHRoaXMud2lkdGg9cyx0aGlzLmhlaWdodD1uLGwuc2NhbGUoMS9yLDEvciksdGhpcy5zZXRXaWR0aChzKS5zZXRIZWlnaHQobiksYz90aGlzLl9yZXN0b3JlQm9yZGVyc0NvbnRyb2xzT25Hcm91cChjKTpoJiZ0aGlzLnNldEFjdGl2ZU9iamVjdCYmdGhpcy5zZXRBY3RpdmVPYmplY3QoaCksdGhpcy5jb250ZXh0VG9wJiZ0aGlzLmNsZWFyQ29udGV4dCh0aGlzLmNvbnRleHRUb3ApLHRoaXMucmVuZGVyQWxsKCksdX0sdG9EYXRhVVJMV2l0aE11bHRpcGxpZXI6ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0aGlzLnRvRGF0YVVSTCh7Zm9ybWF0OnQsbXVsdGlwbGllcjplLHF1YWxpdHk6aX0pfSxfdGVtcFJlbW92ZUJvcmRlcnNDb250cm9sc0Zyb21Hcm91cDpmdW5jdGlvbih0KXt0Lm9yaWdIYXNDb250cm9scz10Lmhhc0NvbnRyb2xzLHQub3JpZ0JvcmRlckNvbG9yPXQuYm9yZGVyQ29sb3IsdC5oYXNDb250cm9scz0hMCx0LmJvcmRlckNvbG9yPVwicmdiYSgwLDAsMCwwKVwiLHQuZm9yRWFjaE9iamVjdChmdW5jdGlvbih0KXt0Lm9yaWdCb3JkZXJDb2xvcj10LmJvcmRlckNvbG9yLHQuYm9yZGVyQ29sb3I9XCJyZ2JhKDAsMCwwLDApXCJ9KX0sX3Jlc3RvcmVCb3JkZXJzQ29udHJvbHNPbkdyb3VwOmZ1bmN0aW9uKHQpe3QuaGlkZUNvbnRyb2xzPXQub3JpZ0hpZGVDb250cm9scyx0LmJvcmRlckNvbG9yPXQub3JpZ0JvcmRlckNvbG9yLHQuZm9yRWFjaE9iamVjdChmdW5jdGlvbih0KXt0LmJvcmRlckNvbG9yPXQub3JpZ0JvcmRlckNvbG9yLGRlbGV0ZSB0Lm9yaWdCb3JkZXJDb2xvcn0pfX0pLGZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQoZmFicmljLlN0YXRpY0NhbnZhcy5wcm90b3R5cGUse2xvYWRGcm9tRGF0YWxlc3NKU09OOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdGhpcy5sb2FkRnJvbUpTT04odCxlLGkpfSxsb2FkRnJvbUpTT046ZnVuY3Rpb24odCxlLGkpe2lmKHQpe3ZhciByPVwic3RyaW5nXCI9PXR5cGVvZiB0P0pTT04ucGFyc2UodCk6dDt0aGlzLmNsZWFyKCk7dmFyIHM9dGhpcztyZXR1cm4gdGhpcy5fZW5saXZlbk9iamVjdHMoci5vYmplY3RzLGZ1bmN0aW9uKCl7cy5fc2V0QmdPdmVybGF5KHIsZSl9LGkpLHRoaXN9fSxfc2V0QmdPdmVybGF5OmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcyxyPXtiYWNrZ3JvdW5kQ29sb3I6ITEsb3ZlcmxheUNvbG9yOiExLGJhY2tncm91bmRJbWFnZTohMSxvdmVybGF5SW1hZ2U6ITF9O2lmKCEodC5iYWNrZ3JvdW5kSW1hZ2V8fHQub3ZlcmxheUltYWdlfHx0LmJhY2tncm91bmR8fHQub3ZlcmxheSkpcmV0dXJuIHZvaWQoZSYmZSgpKTt2YXIgcz1mdW5jdGlvbigpe3IuYmFja2dyb3VuZEltYWdlJiZyLm92ZXJsYXlJbWFnZSYmci5iYWNrZ3JvdW5kQ29sb3ImJnIub3ZlcmxheUNvbG9yJiYoaS5yZW5kZXJBbGwoKSxlJiZlKCkpfTt0aGlzLl9fc2V0QmdPdmVybGF5KFwiYmFja2dyb3VuZEltYWdlXCIsdC5iYWNrZ3JvdW5kSW1hZ2UscixzKSx0aGlzLl9fc2V0QmdPdmVybGF5KFwib3ZlcmxheUltYWdlXCIsdC5vdmVybGF5SW1hZ2UscixzKSx0aGlzLl9fc2V0QmdPdmVybGF5KFwiYmFja2dyb3VuZENvbG9yXCIsdC5iYWNrZ3JvdW5kLHIscyksdGhpcy5fX3NldEJnT3ZlcmxheShcIm92ZXJsYXlDb2xvclwiLHQub3ZlcmxheSxyLHMpLHMoKX0sX19zZXRCZ092ZXJsYXk6ZnVuY3Rpb24odCxlLGkscil7dmFyIHM9dGhpcztyZXR1cm4gZT92b2lkKFwiYmFja2dyb3VuZEltYWdlXCI9PT10fHxcIm92ZXJsYXlJbWFnZVwiPT09dD9mYWJyaWMuSW1hZ2UuZnJvbU9iamVjdChlLGZ1bmN0aW9uKGUpe3NbdF09ZSxpW3RdPSEwLHImJnIoKX0pOnRoaXNbXCJzZXRcIitmYWJyaWMudXRpbC5zdHJpbmcuY2FwaXRhbGl6ZSh0LCEwKV0oZSxmdW5jdGlvbigpe2lbdF09ITAsciYmcigpfSkpOnZvaWQoaVt0XT0hMCl9LF9lbmxpdmVuT2JqZWN0czpmdW5jdGlvbih0LGUsaSl7dmFyIHI9dGhpcztpZighdHx8MD09PXQubGVuZ3RoKXJldHVybiB2b2lkKGUmJmUoKSk7dmFyIHM9dGhpcy5yZW5kZXJPbkFkZFJlbW92ZTt0aGlzLnJlbmRlck9uQWRkUmVtb3ZlPSExLGZhYnJpYy51dGlsLmVubGl2ZW5PYmplY3RzKHQsZnVuY3Rpb24odCl7dC5mb3JFYWNoKGZ1bmN0aW9uKHQsZSl7ci5pbnNlcnRBdCh0LGUsITApfSksci5yZW5kZXJPbkFkZFJlbW92ZT1zLGUmJmUoKX0sbnVsbCxpKX0sX3RvRGF0YVVSTDpmdW5jdGlvbih0LGUpe3RoaXMuY2xvbmUoZnVuY3Rpb24oaSl7ZShpLnRvRGF0YVVSTCh0KSl9KX0sX3RvRGF0YVVSTFdpdGhNdWx0aXBsaWVyOmZ1bmN0aW9uKHQsZSxpKXt0aGlzLmNsb25lKGZ1bmN0aW9uKHIpe2koci50b0RhdGFVUkxXaXRoTXVsdGlwbGllcih0LGUpKX0pfSxjbG9uZTpmdW5jdGlvbih0LGUpe3ZhciBpPUpTT04uc3RyaW5naWZ5KHRoaXMudG9KU09OKGUpKTt0aGlzLmNsb25lV2l0aG91dERhdGEoZnVuY3Rpb24oZSl7ZS5sb2FkRnJvbUpTT04oaSxmdW5jdGlvbigpe3QmJnQoZSl9KX0pfSxjbG9uZVdpdGhvdXREYXRhOmZ1bmN0aW9uKHQpe3ZhciBlPWZhYnJpYy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO2Uud2lkdGg9dGhpcy5nZXRXaWR0aCgpLGUuaGVpZ2h0PXRoaXMuZ2V0SGVpZ2h0KCk7dmFyIGk9bmV3IGZhYnJpYy5DYW52YXMoZSk7aS5jbGlwVG89dGhpcy5jbGlwVG8sdGhpcy5iYWNrZ3JvdW5kSW1hZ2U/KGkuc2V0QmFja2dyb3VuZEltYWdlKHRoaXMuYmFja2dyb3VuZEltYWdlLnNyYyxmdW5jdGlvbigpe2kucmVuZGVyQWxsKCksdCYmdChpKX0pLGkuYmFja2dyb3VuZEltYWdlT3BhY2l0eT10aGlzLmJhY2tncm91bmRJbWFnZU9wYWNpdHksaS5iYWNrZ3JvdW5kSW1hZ2VTdHJldGNoPXRoaXMuYmFja2dyb3VuZEltYWdlU3RyZXRjaCk6dCYmdChpKX19KSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPWUudXRpbC5vYmplY3QuZXh0ZW5kLHI9ZS51dGlsLnRvRml4ZWQscz1lLnV0aWwuc3RyaW5nLmNhcGl0YWxpemUsbj1lLnV0aWwuZGVncmVlc1RvUmFkaWFucyxvPWUuU3RhdGljQ2FudmFzLnN1cHBvcnRzKFwic2V0TGluZURhc2hcIik7ZS5PYmplY3R8fChlLk9iamVjdD1lLnV0aWwuY3JlYXRlQ2xhc3Moe3R5cGU6XCJvYmplY3RcIixvcmlnaW5YOlwibGVmdFwiLG9yaWdpblk6XCJ0b3BcIix0b3A6MCxsZWZ0OjAsd2lkdGg6MCxoZWlnaHQ6MCxzY2FsZVg6MSxzY2FsZVk6MSxmbGlwWDohMSxmbGlwWTohMSxvcGFjaXR5OjEsYW5nbGU6MCxjb3JuZXJTaXplOjEyLHRyYW5zcGFyZW50Q29ybmVyczohMCxob3ZlckN1cnNvcjpudWxsLHBhZGRpbmc6MCxib3JkZXJDb2xvcjpcInJnYmEoMTAyLDE1MywyNTUsMC43NSlcIixjb3JuZXJDb2xvcjpcInJnYmEoMTAyLDE1MywyNTUsMC41KVwiLGNlbnRlcmVkU2NhbGluZzohMSxjZW50ZXJlZFJvdGF0aW9uOiEwLGZpbGw6XCJyZ2IoMCwwLDApXCIsZmlsbFJ1bGU6XCJub256ZXJvXCIsZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uOlwic291cmNlLW92ZXJcIixiYWNrZ3JvdW5kQ29sb3I6XCJcIixzdHJva2U6bnVsbCxzdHJva2VXaWR0aDoxLHN0cm9rZURhc2hBcnJheTpudWxsLHN0cm9rZUxpbmVDYXA6XCJidXR0XCIsc3Ryb2tlTGluZUpvaW46XCJtaXRlclwiLHN0cm9rZU1pdGVyTGltaXQ6MTAsc2hhZG93Om51bGwsYm9yZGVyT3BhY2l0eVdoZW5Nb3Zpbmc6LjQsYm9yZGVyU2NhbGVGYWN0b3I6MSx0cmFuc2Zvcm1NYXRyaXg6bnVsbCxtaW5TY2FsZUxpbWl0Oi4wMSxzZWxlY3RhYmxlOiEwLGV2ZW50ZWQ6ITAsdmlzaWJsZTohMCxoYXNDb250cm9sczohMCxoYXNCb3JkZXJzOiEwLGhhc1JvdGF0aW5nUG9pbnQ6ITAscm90YXRpbmdQb2ludE9mZnNldDo0MCxwZXJQaXhlbFRhcmdldEZpbmQ6ITEsaW5jbHVkZURlZmF1bHRWYWx1ZXM6ITAsY2xpcFRvOm51bGwsbG9ja01vdmVtZW50WDohMSxsb2NrTW92ZW1lbnRZOiExLGxvY2tSb3RhdGlvbjohMSxsb2NrU2NhbGluZ1g6ITEsbG9ja1NjYWxpbmdZOiExLGxvY2tVbmlTY2FsaW5nOiExLGxvY2tTY2FsaW5nRmxpcDohMSxzdGF0ZVByb3BlcnRpZXM6XCJ0b3AgbGVmdCB3aWR0aCBoZWlnaHQgc2NhbGVYIHNjYWxlWSBmbGlwWCBmbGlwWSBvcmlnaW5YIG9yaWdpblkgdHJhbnNmb3JtTWF0cml4IHN0cm9rZSBzdHJva2VXaWR0aCBzdHJva2VEYXNoQXJyYXkgc3Ryb2tlTGluZUNhcCBzdHJva2VMaW5lSm9pbiBzdHJva2VNaXRlckxpbWl0IGFuZ2xlIG9wYWNpdHkgZmlsbCBmaWxsUnVsZSBnbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gc2hhZG93IGNsaXBUbyB2aXNpYmxlIGJhY2tncm91bmRDb2xvclwiLnNwbGl0KFwiIFwiKSxpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3QmJnRoaXMuc2V0T3B0aW9ucyh0KX0sX2luaXRHcmFkaWVudDpmdW5jdGlvbih0KXshdC5maWxsfHwhdC5maWxsLmNvbG9yU3RvcHN8fHQuZmlsbCBpbnN0YW5jZW9mIGUuR3JhZGllbnR8fHRoaXMuc2V0KFwiZmlsbFwiLG5ldyBlLkdyYWRpZW50KHQuZmlsbCkpLCF0LnN0cm9rZXx8IXQuc3Ryb2tlLmNvbG9yU3RvcHN8fHQuc3Ryb2tlIGluc3RhbmNlb2YgZS5HcmFkaWVudHx8dGhpcy5zZXQoXCJzdHJva2VcIixuZXcgZS5HcmFkaWVudCh0LnN0cm9rZSkpfSxfaW5pdFBhdHRlcm46ZnVuY3Rpb24odCl7IXQuZmlsbHx8IXQuZmlsbC5zb3VyY2V8fHQuZmlsbCBpbnN0YW5jZW9mIGUuUGF0dGVybnx8dGhpcy5zZXQoXCJmaWxsXCIsbmV3IGUuUGF0dGVybih0LmZpbGwpKSwhdC5zdHJva2V8fCF0LnN0cm9rZS5zb3VyY2V8fHQuc3Ryb2tlIGluc3RhbmNlb2YgZS5QYXR0ZXJufHx0aGlzLnNldChcInN0cm9rZVwiLG5ldyBlLlBhdHRlcm4odC5zdHJva2UpKX0sX2luaXRDbGlwcGluZzpmdW5jdGlvbih0KXtpZih0LmNsaXBUbyYmXCJzdHJpbmdcIj09dHlwZW9mIHQuY2xpcFRvKXt2YXIgaT1lLnV0aWwuZ2V0RnVuY3Rpb25Cb2R5KHQuY2xpcFRvKTtcInVuZGVmaW5lZFwiIT10eXBlb2YgaSYmKHRoaXMuY2xpcFRvPW5ldyBGdW5jdGlvbihcImN0eFwiLGkpKX19LHNldE9wdGlvbnM6ZnVuY3Rpb24odCl7Zm9yKHZhciBlIGluIHQpdGhpcy5zZXQoZSx0W2VdKTt0aGlzLl9pbml0R3JhZGllbnQodCksdGhpcy5faW5pdFBhdHRlcm4odCksdGhpcy5faW5pdENsaXBwaW5nKHQpfSx0cmFuc2Zvcm06ZnVuY3Rpb24odCxlKXt0aGlzLmdyb3VwJiZ0aGlzLmNhbnZhcy5wcmVzZXJ2ZU9iamVjdFN0YWNraW5nJiZ0aGlzLmdyb3VwPT09dGhpcy5jYW52YXMuX2FjdGl2ZUdyb3VwJiZ0aGlzLmdyb3VwLnRyYW5zZm9ybSh0KTt2YXIgaT1lP3RoaXMuX2dldExlZnRUb3BDb29yZHMoKTp0aGlzLmdldENlbnRlclBvaW50KCk7dC50cmFuc2xhdGUoaS54LGkueSksdC5yb3RhdGUobih0aGlzLmFuZ2xlKSksdC5zY2FsZSh0aGlzLnNjYWxlWCoodGhpcy5mbGlwWD8tMToxKSx0aGlzLnNjYWxlWSoodGhpcy5mbGlwWT8tMToxKSl9LHRvT2JqZWN0OmZ1bmN0aW9uKHQpe3ZhciBpPWUuT2JqZWN0Lk5VTV9GUkFDVElPTl9ESUdJVFMscz17dHlwZTp0aGlzLnR5cGUsb3JpZ2luWDp0aGlzLm9yaWdpblgsb3JpZ2luWTp0aGlzLm9yaWdpblksbGVmdDpyKHRoaXMubGVmdCxpKSx0b3A6cih0aGlzLnRvcCxpKSx3aWR0aDpyKHRoaXMud2lkdGgsaSksaGVpZ2h0OnIodGhpcy5oZWlnaHQsaSksZmlsbDp0aGlzLmZpbGwmJnRoaXMuZmlsbC50b09iamVjdD90aGlzLmZpbGwudG9PYmplY3QoKTp0aGlzLmZpbGwsc3Ryb2tlOnRoaXMuc3Ryb2tlJiZ0aGlzLnN0cm9rZS50b09iamVjdD90aGlzLnN0cm9rZS50b09iamVjdCgpOnRoaXMuc3Ryb2tlLHN0cm9rZVdpZHRoOnIodGhpcy5zdHJva2VXaWR0aCxpKSxzdHJva2VEYXNoQXJyYXk6dGhpcy5zdHJva2VEYXNoQXJyYXksc3Ryb2tlTGluZUNhcDp0aGlzLnN0cm9rZUxpbmVDYXAsc3Ryb2tlTGluZUpvaW46dGhpcy5zdHJva2VMaW5lSm9pbixzdHJva2VNaXRlckxpbWl0OnIodGhpcy5zdHJva2VNaXRlckxpbWl0LGkpLHNjYWxlWDpyKHRoaXMuc2NhbGVYLGkpLHNjYWxlWTpyKHRoaXMuc2NhbGVZLGkpLGFuZ2xlOnIodGhpcy5nZXRBbmdsZSgpLGkpLGZsaXBYOnRoaXMuZmxpcFgsZmxpcFk6dGhpcy5mbGlwWSxvcGFjaXR5OnIodGhpcy5vcGFjaXR5LGkpLHNoYWRvdzp0aGlzLnNoYWRvdyYmdGhpcy5zaGFkb3cudG9PYmplY3Q/dGhpcy5zaGFkb3cudG9PYmplY3QoKTp0aGlzLnNoYWRvdyx2aXNpYmxlOnRoaXMudmlzaWJsZSxjbGlwVG86dGhpcy5jbGlwVG8mJlN0cmluZyh0aGlzLmNsaXBUbyksYmFja2dyb3VuZENvbG9yOnRoaXMuYmFja2dyb3VuZENvbG9yLGZpbGxSdWxlOnRoaXMuZmlsbFJ1bGUsZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uOnRoaXMuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9ufTtyZXR1cm4gdGhpcy5pbmNsdWRlRGVmYXVsdFZhbHVlc3x8KHM9dGhpcy5fcmVtb3ZlRGVmYXVsdFZhbHVlcyhzKSksZS51dGlsLnBvcHVsYXRlV2l0aFByb3BlcnRpZXModGhpcyxzLHQpLHN9LHRvRGF0YWxlc3NPYmplY3Q6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMudG9PYmplY3QodCl9LF9yZW1vdmVEZWZhdWx0VmFsdWVzOmZ1bmN0aW9uKHQpe3ZhciBpPWUudXRpbC5nZXRLbGFzcyh0LnR5cGUpLnByb3RvdHlwZSxyPWkuc3RhdGVQcm9wZXJ0aWVzO3JldHVybiByLmZvckVhY2goZnVuY3Rpb24oZSl7dFtlXT09PWlbZV0mJmRlbGV0ZSB0W2VdfSksdH0sdG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm5cIiM8ZmFicmljLlwiK3ModGhpcy50eXBlKStcIj5cIn0sZ2V0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzW3RdfSxfc2V0T2JqZWN0OmZ1bmN0aW9uKHQpe2Zvcih2YXIgZSBpbiB0KXRoaXMuX3NldChlLHRbZV0pfSxzZXQ6ZnVuY3Rpb24odCxlKXtyZXR1cm5cIm9iamVjdFwiPT10eXBlb2YgdD90aGlzLl9zZXRPYmplY3QodCk6XCJmdW5jdGlvblwiPT10eXBlb2YgZSYmXCJjbGlwVG9cIiE9PXQ/dGhpcy5fc2V0KHQsZSh0aGlzLmdldCh0KSkpOnRoaXMuX3NldCh0LGUpLHRoaXN9LF9zZXQ6ZnVuY3Rpb24odCxpKXt2YXIgcz1cInNjYWxlWFwiPT09dHx8XCJzY2FsZVlcIj09PXQ7cmV0dXJuIHMmJihpPXRoaXMuX2NvbnN0cmFpblNjYWxlKGkpKSxcInNjYWxlWFwiPT09dCYmMD5pPyh0aGlzLmZsaXBYPSF0aGlzLmZsaXBYLGkqPS0xKTpcInNjYWxlWVwiPT09dCYmMD5pPyh0aGlzLmZsaXBZPSF0aGlzLmZsaXBZLGkqPS0xKTpcIndpZHRoXCI9PT10fHxcImhlaWdodFwiPT09dD90aGlzLm1pblNjYWxlTGltaXQ9cihNYXRoLm1pbiguMSwxL01hdGgubWF4KHRoaXMud2lkdGgsdGhpcy5oZWlnaHQpKSwyKTpcInNoYWRvd1wiIT09dHx8IWl8fGkgaW5zdGFuY2VvZiBlLlNoYWRvd3x8KGk9bmV3IGUuU2hhZG93KGkpKSx0aGlzW3RdPWksdGhpc30sdG9nZ2xlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0KHQpO3JldHVyblwiYm9vbGVhblwiPT10eXBlb2YgZSYmdGhpcy5zZXQodCwhZSksdGhpc30sc2V0U291cmNlUGF0aDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5zb3VyY2VQYXRoPXQsdGhpc30sZ2V0Vmlld3BvcnRUcmFuc2Zvcm06ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jYW52YXMmJnRoaXMuY2FudmFzLnZpZXdwb3J0VHJhbnNmb3JtP3RoaXMuY2FudmFzLnZpZXdwb3J0VHJhbnNmb3JtOlsxLDAsMCwxLDAsMF19LHJlbmRlcjpmdW5jdGlvbih0LGkpezA9PT10aGlzLndpZHRoJiYwPT09dGhpcy5oZWlnaHR8fCF0aGlzLnZpc2libGV8fCh0LnNhdmUoKSx0aGlzLl9zZXR1cENvbXBvc2l0ZU9wZXJhdGlvbih0KSxpfHx0aGlzLnRyYW5zZm9ybSh0KSx0aGlzLl9zZXRTdHJva2VTdHlsZXModCksdGhpcy5fc2V0RmlsbFN0eWxlcyh0KSx0aGlzLnRyYW5zZm9ybU1hdHJpeCYmdC50cmFuc2Zvcm0uYXBwbHkodCx0aGlzLnRyYW5zZm9ybU1hdHJpeCksdGhpcy5fc2V0T3BhY2l0eSh0KSx0aGlzLl9zZXRTaGFkb3codCksdGhpcy5jbGlwVG8mJmUudXRpbC5jbGlwQ29udGV4dCh0aGlzLHQpLHRoaXMuX3JlbmRlcih0LGkpLHRoaXMuY2xpcFRvJiZ0LnJlc3RvcmUoKSx0LnJlc3RvcmUoKSl9LF9zZXRPcGFjaXR5OmZ1bmN0aW9uKHQpe3RoaXMuZ3JvdXAmJnRoaXMuZ3JvdXAuX3NldE9wYWNpdHkodCksdC5nbG9iYWxBbHBoYSo9dGhpcy5vcGFjaXR5fSxfc2V0U3Ryb2tlU3R5bGVzOmZ1bmN0aW9uKHQpe3RoaXMuc3Ryb2tlJiYodC5saW5lV2lkdGg9dGhpcy5zdHJva2VXaWR0aCx0LmxpbmVDYXA9dGhpcy5zdHJva2VMaW5lQ2FwLHQubGluZUpvaW49dGhpcy5zdHJva2VMaW5lSm9pbix0Lm1pdGVyTGltaXQ9dGhpcy5zdHJva2VNaXRlckxpbWl0LHQuc3Ryb2tlU3R5bGU9dGhpcy5zdHJva2UudG9MaXZlP3RoaXMuc3Ryb2tlLnRvTGl2ZSh0LHRoaXMpOnRoaXMuc3Ryb2tlKX0sX3NldEZpbGxTdHlsZXM6ZnVuY3Rpb24odCl7dGhpcy5maWxsJiYodC5maWxsU3R5bGU9dGhpcy5maWxsLnRvTGl2ZT90aGlzLmZpbGwudG9MaXZlKHQsdGhpcyk6dGhpcy5maWxsKX0sX3JlbmRlckNvbnRyb2xzOmZ1bmN0aW9uKHQsaSl7aWYodGhpcy5hY3RpdmUmJiFpKXt2YXIgcj10aGlzLmdldFZpZXdwb3J0VHJhbnNmb3JtKCk7dC5zYXZlKCk7dmFyIHM7dGhpcy5ncm91cCYmKHM9ZS51dGlsLnRyYW5zZm9ybVBvaW50KHRoaXMuZ3JvdXAuZ2V0Q2VudGVyUG9pbnQoKSxyKSx0LnRyYW5zbGF0ZShzLngscy55KSx0LnJvdGF0ZShuKHRoaXMuZ3JvdXAuYW5nbGUpKSkscz1lLnV0aWwudHJhbnNmb3JtUG9pbnQodGhpcy5nZXRDZW50ZXJQb2ludCgpLHIsbnVsbCE9dGhpcy5ncm91cCksdGhpcy5ncm91cCYmKHMueCo9dGhpcy5ncm91cC5zY2FsZVgscy55Kj10aGlzLmdyb3VwLnNjYWxlWSksdC50cmFuc2xhdGUocy54LHMueSksdC5yb3RhdGUobih0aGlzLmFuZ2xlKSksdGhpcy5kcmF3Qm9yZGVycyh0KSx0aGlzLmRyYXdDb250cm9scyh0KSx0LnJlc3RvcmUoKX19LF9zZXRTaGFkb3c6ZnVuY3Rpb24odCl7aWYodGhpcy5zaGFkb3cpe3ZhciBlPXRoaXMuY2FudmFzJiZ0aGlzLmNhbnZhcy52aWV3cG9ydFRyYW5zZm9ybVswXXx8MSxpPXRoaXMuY2FudmFzJiZ0aGlzLmNhbnZhcy52aWV3cG9ydFRyYW5zZm9ybVszXXx8MTt0LnNoYWRvd0NvbG9yPXRoaXMuc2hhZG93LmNvbG9yLHQuc2hhZG93Qmx1cj10aGlzLnNoYWRvdy5ibHVyKihlK2kpKih0aGlzLnNjYWxlWCt0aGlzLnNjYWxlWSkvNCx0LnNoYWRvd09mZnNldFg9dGhpcy5zaGFkb3cub2Zmc2V0WCplKnRoaXMuc2NhbGVYLHQuc2hhZG93T2Zmc2V0WT10aGlzLnNoYWRvdy5vZmZzZXRZKmkqdGhpcy5zY2FsZVl9fSxfcmVtb3ZlU2hhZG93OmZ1bmN0aW9uKHQpe3RoaXMuc2hhZG93JiYodC5zaGFkb3dDb2xvcj1cIlwiLHQuc2hhZG93Qmx1cj10LnNoYWRvd09mZnNldFg9dC5zaGFkb3dPZmZzZXRZPTApfSxfcmVuZGVyRmlsbDpmdW5jdGlvbih0KXtpZih0aGlzLmZpbGwpe2lmKHQuc2F2ZSgpLHRoaXMuZmlsbC5ncmFkaWVudFRyYW5zZm9ybSl7dmFyIGU9dGhpcy5maWxsLmdyYWRpZW50VHJhbnNmb3JtO3QudHJhbnNmb3JtLmFwcGx5KHQsZSl9dGhpcy5maWxsLnRvTGl2ZSYmdC50cmFuc2xhdGUoLXRoaXMud2lkdGgvMit0aGlzLmZpbGwub2Zmc2V0WHx8MCwtdGhpcy5oZWlnaHQvMit0aGlzLmZpbGwub2Zmc2V0WXx8MCksXCJldmVub2RkXCI9PT10aGlzLmZpbGxSdWxlP3QuZmlsbChcImV2ZW5vZGRcIik6dC5maWxsKCksdC5yZXN0b3JlKCl9fSxfcmVuZGVyU3Ryb2tlOmZ1bmN0aW9uKHQpe2lmKHRoaXMuc3Ryb2tlJiYwIT09dGhpcy5zdHJva2VXaWR0aCl7aWYodGhpcy5zaGFkb3cmJiF0aGlzLnNoYWRvdy5hZmZlY3RTdHJva2UmJnRoaXMuX3JlbW92ZVNoYWRvdyh0KSx0LnNhdmUoKSx0aGlzLnN0cm9rZURhc2hBcnJheSkxJnRoaXMuc3Ryb2tlRGFzaEFycmF5Lmxlbmd0aCYmdGhpcy5zdHJva2VEYXNoQXJyYXkucHVzaC5hcHBseSh0aGlzLnN0cm9rZURhc2hBcnJheSx0aGlzLnN0cm9rZURhc2hBcnJheSksbz8odC5zZXRMaW5lRGFzaCh0aGlzLnN0cm9rZURhc2hBcnJheSksdGhpcy5fc3Ryb2tlJiZ0aGlzLl9zdHJva2UodCkpOnRoaXMuX3JlbmRlckRhc2hlZFN0cm9rZSYmdGhpcy5fcmVuZGVyRGFzaGVkU3Ryb2tlKHQpLHQuc3Ryb2tlKCk7ZWxzZXtpZih0aGlzLnN0cm9rZS5ncmFkaWVudFRyYW5zZm9ybSl7dmFyIGU9dGhpcy5zdHJva2UuZ3JhZGllbnRUcmFuc2Zvcm07dC50cmFuc2Zvcm0uYXBwbHkodCxlKX10aGlzLl9zdHJva2U/dGhpcy5fc3Ryb2tlKHQpOnQuc3Ryb2tlKCl9dC5yZXN0b3JlKCl9fSxjbG9uZTpmdW5jdGlvbih0LGkpe3JldHVybiB0aGlzLmNvbnN0cnVjdG9yLmZyb21PYmplY3Q/dGhpcy5jb25zdHJ1Y3Rvci5mcm9tT2JqZWN0KHRoaXMudG9PYmplY3QoaSksdCk6bmV3IGUuT2JqZWN0KHRoaXMudG9PYmplY3QoaSkpfSxjbG9uZUFzSW1hZ2U6ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy50b0RhdGFVUkwoKTtyZXR1cm4gZS51dGlsLmxvYWRJbWFnZShpLGZ1bmN0aW9uKGkpe3QmJnQobmV3IGUuSW1hZ2UoaSkpfSksdGhpc30sdG9EYXRhVVJMOmZ1bmN0aW9uKHQpe3R8fCh0PXt9KTt2YXIgaT1lLnV0aWwuY3JlYXRlQ2FudmFzRWxlbWVudCgpLHI9dGhpcy5nZXRCb3VuZGluZ1JlY3QoKTtpLndpZHRoPXIud2lkdGgsaS5oZWlnaHQ9ci5oZWlnaHQsZS51dGlsLndyYXBFbGVtZW50KGksXCJkaXZcIik7dmFyIHM9bmV3IGUuU3RhdGljQ2FudmFzKGkpO1wianBnXCI9PT10LmZvcm1hdCYmKHQuZm9ybWF0PVwianBlZ1wiKSxcImpwZWdcIj09PXQuZm9ybWF0JiYocy5iYWNrZ3JvdW5kQ29sb3I9XCIjZmZmXCIpO3ZhciBuPXthY3RpdmU6dGhpcy5nZXQoXCJhY3RpdmVcIiksbGVmdDp0aGlzLmdldExlZnQoKSx0b3A6dGhpcy5nZXRUb3AoKX07dGhpcy5zZXQoXCJhY3RpdmVcIiwhMSksdGhpcy5zZXRQb3NpdGlvbkJ5T3JpZ2luKG5ldyBlLlBvaW50KGkud2lkdGgvMixpLmhlaWdodC8yKSxcImNlbnRlclwiLFwiY2VudGVyXCIpO3ZhciBvPXRoaXMuY2FudmFzO3MuYWRkKHRoaXMpO3ZhciBhPXMudG9EYXRhVVJMKHQpO3JldHVybiB0aGlzLnNldChuKS5zZXRDb29yZHMoKSx0aGlzLmNhbnZhcz1vLHMuZGlzcG9zZSgpLHM9bnVsbCxhfSxpc1R5cGU6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMudHlwZT09PXR9LGNvbXBsZXhpdHk6ZnVuY3Rpb24oKXtyZXR1cm4gMH0sdG9KU09OOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnRvT2JqZWN0KHQpfSxzZXRHcmFkaWVudDpmdW5jdGlvbih0LGkpe2l8fChpPXt9KTt2YXIgcj17Y29sb3JTdG9wczpbXX07ci50eXBlPWkudHlwZXx8KGkucjF8fGkucjI/XCJyYWRpYWxcIjpcImxpbmVhclwiKSxyLmNvb3Jkcz17eDE6aS54MSx5MTppLnkxLHgyOmkueDIseTI6aS55Mn0sKGkucjF8fGkucjIpJiYoci5jb29yZHMucjE9aS5yMSxyLmNvb3Jkcy5yMj1pLnIyKTtmb3IodmFyIHMgaW4gaS5jb2xvclN0b3BzKXt2YXIgbj1uZXcgZS5Db2xvcihpLmNvbG9yU3RvcHNbc10pO3IuY29sb3JTdG9wcy5wdXNoKHtvZmZzZXQ6cyxjb2xvcjpuLnRvUmdiKCksb3BhY2l0eTpuLmdldEFscGhhKCl9KX1yZXR1cm4gdGhpcy5zZXQodCxlLkdyYWRpZW50LmZvck9iamVjdCh0aGlzLHIpKX0sc2V0UGF0dGVybkZpbGw6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc2V0KFwiZmlsbFwiLG5ldyBlLlBhdHRlcm4odCkpfSxzZXRTaGFkb3c6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc2V0KFwic2hhZG93XCIsdD9uZXcgZS5TaGFkb3codCk6bnVsbCl9LHNldENvbG9yOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnNldChcImZpbGxcIix0KSx0aGlzfSxzZXRBbmdsZTpmdW5jdGlvbih0KXt2YXIgZT0oXCJjZW50ZXJcIiE9PXRoaXMub3JpZ2luWHx8XCJjZW50ZXJcIiE9PXRoaXMub3JpZ2luWSkmJnRoaXMuY2VudGVyZWRSb3RhdGlvbjtyZXR1cm4gZSYmdGhpcy5fc2V0T3JpZ2luVG9DZW50ZXIoKSx0aGlzLnNldChcImFuZ2xlXCIsdCksZSYmdGhpcy5fcmVzZXRPcmlnaW4oKSx0aGlzfSxjZW50ZXJIOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2FudmFzLmNlbnRlck9iamVjdEgodGhpcyksdGhpc30sY2VudGVyVjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNhbnZhcy5jZW50ZXJPYmplY3RWKHRoaXMpLHRoaXN9LGNlbnRlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNhbnZhcy5jZW50ZXJPYmplY3QodGhpcyksdGhpc30scmVtb3ZlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2FudmFzLnJlbW92ZSh0aGlzKSx0aGlzfSxnZXRMb2NhbFBvaW50ZXI6ZnVuY3Rpb24odCxlKXtlPWV8fHRoaXMuY2FudmFzLmdldFBvaW50ZXIodCk7dmFyIGk9dGhpcy50cmFuc2xhdGVUb09yaWdpblBvaW50KHRoaXMuZ2V0Q2VudGVyUG9pbnQoKSxcImxlZnRcIixcInRvcFwiKTtyZXR1cm57eDplLngtaS54LHk6ZS55LWkueX19LF9zZXR1cENvbXBvc2l0ZU9wZXJhdGlvbjpmdW5jdGlvbih0KXt0aGlzLmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiYmKHQuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uPXRoaXMuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uKX19KSxlLnV0aWwuY3JlYXRlQWNjZXNzb3JzKGUuT2JqZWN0KSxlLk9iamVjdC5wcm90b3R5cGUucm90YXRlPWUuT2JqZWN0LnByb3RvdHlwZS5zZXRBbmdsZSxpKGUuT2JqZWN0LnByb3RvdHlwZSxlLk9ic2VydmFibGUpLGUuT2JqZWN0Lk5VTV9GUkFDVElPTl9ESUdJVFM9MixlLk9iamVjdC5fX3VpZD0wKX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbigpe3ZhciB0PWZhYnJpYy51dGlsLmRlZ3JlZXNUb1JhZGlhbnM7ZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuT2JqZWN0LnByb3RvdHlwZSx7dHJhbnNsYXRlVG9DZW50ZXJQb2ludDpmdW5jdGlvbihlLGkscil7dmFyIHM9ZS54LG49ZS55O3JldHVyblwibGVmdFwiPT09aT9zPWUueCsodGhpcy5nZXRXaWR0aCgpK3RoaXMuc3Ryb2tlV2lkdGgqdGhpcy5zY2FsZVgpLzI6XCJyaWdodFwiPT09aSYmKHM9ZS54LSh0aGlzLmdldFdpZHRoKCkrdGhpcy5zdHJva2VXaWR0aCp0aGlzLnNjYWxlWCkvMiksXCJ0b3BcIj09PXI/bj1lLnkrKHRoaXMuZ2V0SGVpZ2h0KCkrdGhpcy5zdHJva2VXaWR0aCp0aGlzLnNjYWxlWSkvMjpcImJvdHRvbVwiPT09ciYmKG49ZS55LSh0aGlzLmdldEhlaWdodCgpK3RoaXMuc3Ryb2tlV2lkdGgqdGhpcy5zY2FsZVkpLzIpLGZhYnJpYy51dGlsLnJvdGF0ZVBvaW50KG5ldyBmYWJyaWMuUG9pbnQocyxuKSxlLHQodGhpcy5hbmdsZSkpfSx0cmFuc2xhdGVUb09yaWdpblBvaW50OmZ1bmN0aW9uKGUsaSxyKXt2YXIgcz1lLngsbj1lLnk7cmV0dXJuXCJsZWZ0XCI9PT1pP3M9ZS54LSh0aGlzLmdldFdpZHRoKCkrdGhpcy5zdHJva2VXaWR0aCp0aGlzLnNjYWxlWCkvMjpcInJpZ2h0XCI9PT1pJiYocz1lLngrKHRoaXMuZ2V0V2lkdGgoKSt0aGlzLnN0cm9rZVdpZHRoKnRoaXMuc2NhbGVYKS8yKSxcInRvcFwiPT09cj9uPWUueS0odGhpcy5nZXRIZWlnaHQoKSt0aGlzLnN0cm9rZVdpZHRoKnRoaXMuc2NhbGVZKS8yOlwiYm90dG9tXCI9PT1yJiYobj1lLnkrKHRoaXMuZ2V0SGVpZ2h0KCkrdGhpcy5zdHJva2VXaWR0aCp0aGlzLnNjYWxlWSkvMiksZmFicmljLnV0aWwucm90YXRlUG9pbnQobmV3IGZhYnJpYy5Qb2ludChzLG4pLGUsdCh0aGlzLmFuZ2xlKSl9LGdldENlbnRlclBvaW50OmZ1bmN0aW9uKCl7dmFyIHQ9bmV3IGZhYnJpYy5Qb2ludCh0aGlzLmxlZnQsdGhpcy50b3ApO3JldHVybiB0aGlzLnRyYW5zbGF0ZVRvQ2VudGVyUG9pbnQodCx0aGlzLm9yaWdpblgsdGhpcy5vcmlnaW5ZKX0sZ2V0UG9pbnRCeU9yaWdpbjpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuZ2V0Q2VudGVyUG9pbnQoKTtyZXR1cm4gdGhpcy50cmFuc2xhdGVUb09yaWdpblBvaW50KGksdCxlKX0sdG9Mb2NhbFBvaW50OmZ1bmN0aW9uKGUsaSxyKXt2YXIgcyxuLG89dGhpcy5nZXRDZW50ZXJQb2ludCgpO3JldHVybiBpJiZyPyhzPVwibGVmdFwiPT09aT9vLngtKHRoaXMuZ2V0V2lkdGgoKSt0aGlzLnN0cm9rZVdpZHRoKnRoaXMuc2NhbGVYKS8yOlwicmlnaHRcIj09PWk/by54Kyh0aGlzLmdldFdpZHRoKCkrdGhpcy5zdHJva2VXaWR0aCp0aGlzLnNjYWxlWCkvMjpvLngsbj1cInRvcFwiPT09cj9vLnktKHRoaXMuZ2V0SGVpZ2h0KCkrdGhpcy5zdHJva2VXaWR0aCp0aGlzLnNjYWxlWSkvMjpcImJvdHRvbVwiPT09cj9vLnkrKHRoaXMuZ2V0SGVpZ2h0KCkrdGhpcy5zdHJva2VXaWR0aCp0aGlzLnNjYWxlWSkvMjpvLnkpOihzPXRoaXMubGVmdCxuPXRoaXMudG9wKSxmYWJyaWMudXRpbC5yb3RhdGVQb2ludChuZXcgZmFicmljLlBvaW50KGUueCxlLnkpLG8sLXQodGhpcy5hbmdsZSkpLnN1YnRyYWN0RXF1YWxzKG5ldyBmYWJyaWMuUG9pbnQocyxuKSl9LHNldFBvc2l0aW9uQnlPcmlnaW46ZnVuY3Rpb24odCxlLGkpe3ZhciByPXRoaXMudHJhbnNsYXRlVG9DZW50ZXJQb2ludCh0LGUsaSkscz10aGlzLnRyYW5zbGF0ZVRvT3JpZ2luUG9pbnQocix0aGlzLm9yaWdpblgsdGhpcy5vcmlnaW5ZKTt0aGlzLnNldChcImxlZnRcIixzLngpLHRoaXMuc2V0KFwidG9wXCIscy55KX0sYWRqdXN0UG9zaXRpb246ZnVuY3Rpb24oZSl7dmFyIGk9dCh0aGlzLmFuZ2xlKSxyPXRoaXMuZ2V0V2lkdGgoKS8yLHM9TWF0aC5jb3MoaSkqcixuPU1hdGguc2luKGkpKnIsbz10aGlzLmdldFdpZHRoKCksYT1NYXRoLmNvcyhpKSpvLGg9TWF0aC5zaW4oaSkqbztcImNlbnRlclwiPT09dGhpcy5vcmlnaW5YJiZcImxlZnRcIj09PWV8fFwicmlnaHRcIj09PXRoaXMub3JpZ2luWCYmXCJjZW50ZXJcIj09PWU/KHRoaXMubGVmdC09cyx0aGlzLnRvcC09bik6XCJsZWZ0XCI9PT10aGlzLm9yaWdpblgmJlwiY2VudGVyXCI9PT1lfHxcImNlbnRlclwiPT09dGhpcy5vcmlnaW5YJiZcInJpZ2h0XCI9PT1lPyh0aGlzLmxlZnQrPXMsdGhpcy50b3ArPW4pOlwibGVmdFwiPT09dGhpcy5vcmlnaW5YJiZcInJpZ2h0XCI9PT1lPyh0aGlzLmxlZnQrPWEsdGhpcy50b3ArPWgpOlwicmlnaHRcIj09PXRoaXMub3JpZ2luWCYmXCJsZWZ0XCI9PT1lJiYodGhpcy5sZWZ0LT1hLHRoaXMudG9wLT1oKSx0aGlzLnNldENvb3JkcygpLHRoaXMub3JpZ2luWD1lfSxfc2V0T3JpZ2luVG9DZW50ZXI6ZnVuY3Rpb24oKXt0aGlzLl9vcmlnaW5hbE9yaWdpblg9dGhpcy5vcmlnaW5YLHRoaXMuX29yaWdpbmFsT3JpZ2luWT10aGlzLm9yaWdpblk7dmFyIHQ9dGhpcy5nZXRDZW50ZXJQb2ludCgpO3RoaXMub3JpZ2luWD1cImNlbnRlclwiLHRoaXMub3JpZ2luWT1cImNlbnRlclwiLHRoaXMubGVmdD10LngsdGhpcy50b3A9dC55fSxfcmVzZXRPcmlnaW46ZnVuY3Rpb24oKXt2YXIgdD10aGlzLnRyYW5zbGF0ZVRvT3JpZ2luUG9pbnQodGhpcy5nZXRDZW50ZXJQb2ludCgpLHRoaXMuX29yaWdpbmFsT3JpZ2luWCx0aGlzLl9vcmlnaW5hbE9yaWdpblkpO3RoaXMub3JpZ2luWD10aGlzLl9vcmlnaW5hbE9yaWdpblgsdGhpcy5vcmlnaW5ZPXRoaXMuX29yaWdpbmFsT3JpZ2luWSx0aGlzLmxlZnQ9dC54LHRoaXMudG9wPXQueSx0aGlzLl9vcmlnaW5hbE9yaWdpblg9bnVsbCx0aGlzLl9vcmlnaW5hbE9yaWdpblk9bnVsbH0sX2dldExlZnRUb3BDb29yZHM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50cmFuc2xhdGVUb09yaWdpblBvaW50KHRoaXMuZ2V0Q2VudGVyUG9pbnQoKSxcImxlZnRcIixcInRvcFwiKX19KX0oKSxmdW5jdGlvbigpe3ZhciB0PWZhYnJpYy51dGlsLmRlZ3JlZXNUb1JhZGlhbnM7ZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuT2JqZWN0LnByb3RvdHlwZSx7b0Nvb3JkczpudWxsLGludGVyc2VjdHNXaXRoUmVjdDpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMub0Nvb3JkcyxyPW5ldyBmYWJyaWMuUG9pbnQoaS50bC54LGkudGwueSkscz1uZXcgZmFicmljLlBvaW50KGkudHIueCxpLnRyLnkpLG49bmV3IGZhYnJpYy5Qb2ludChpLmJsLngsaS5ibC55KSxvPW5ldyBmYWJyaWMuUG9pbnQoaS5ici54LGkuYnIueSksYT1mYWJyaWMuSW50ZXJzZWN0aW9uLmludGVyc2VjdFBvbHlnb25SZWN0YW5nbGUoW3IscyxvLG5dLHQsZSk7cmV0dXJuXCJJbnRlcnNlY3Rpb25cIj09PWEuc3RhdHVzfSxpbnRlcnNlY3RzV2l0aE9iamVjdDpmdW5jdGlvbih0KXtmdW5jdGlvbiBlKHQpe3JldHVybnt0bDpuZXcgZmFicmljLlBvaW50KHQudGwueCx0LnRsLnkpLHRyOm5ldyBmYWJyaWMuUG9pbnQodC50ci54LHQudHIueSksYmw6bmV3IGZhYnJpYy5Qb2ludCh0LmJsLngsdC5ibC55KSxicjpuZXcgZmFicmljLlBvaW50KHQuYnIueCx0LmJyLnkpfX12YXIgaT1lKHRoaXMub0Nvb3Jkcykscj1lKHQub0Nvb3Jkcykscz1mYWJyaWMuSW50ZXJzZWN0aW9uLmludGVyc2VjdFBvbHlnb25Qb2x5Z29uKFtpLnRsLGkudHIsaS5icixpLmJsXSxbci50bCxyLnRyLHIuYnIsci5ibF0pO3JldHVyblwiSW50ZXJzZWN0aW9uXCI9PT1zLnN0YXR1c30saXNDb250YWluZWRXaXRoaW5PYmplY3Q6ZnVuY3Rpb24odCl7dmFyIGU9dC5nZXRCb3VuZGluZ1JlY3QoKSxpPW5ldyBmYWJyaWMuUG9pbnQoZS5sZWZ0LGUudG9wKSxyPW5ldyBmYWJyaWMuUG9pbnQoZS5sZWZ0K2Uud2lkdGgsZS50b3ArZS5oZWlnaHQpO3JldHVybiB0aGlzLmlzQ29udGFpbmVkV2l0aGluUmVjdChpLHIpfSxpc0NvbnRhaW5lZFdpdGhpblJlY3Q6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLmdldEJvdW5kaW5nUmVjdCgpO3JldHVybiBpLmxlZnQ+PXQueCYmaS5sZWZ0K2kud2lkdGg8PWUueCYmaS50b3A+PXQueSYmaS50b3AraS5oZWlnaHQ8PWUueX0sY29udGFpbnNQb2ludDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl9nZXRJbWFnZUxpbmVzKHRoaXMub0Nvb3JkcyksaT10aGlzLl9maW5kQ3Jvc3NQb2ludHModCxlKTtyZXR1cm4gMCE9PWkmJmklMj09PTF9LF9nZXRJbWFnZUxpbmVzOmZ1bmN0aW9uKHQpe3JldHVybnt0b3BsaW5lOntvOnQudGwsZDp0LnRyfSxyaWdodGxpbmU6e286dC50cixkOnQuYnJ9LGJvdHRvbWxpbmU6e286dC5icixkOnQuYmx9LGxlZnRsaW5lOntvOnQuYmwsZDp0LnRsfX19LF9maW5kQ3Jvc3NQb2ludHM6ZnVuY3Rpb24odCxlKXt2YXIgaSxyLHMsbixvLGEsaCxjPTA7Zm9yKHZhciBsIGluIGUpaWYoaD1lW2xdLCEoaC5vLnk8dC55JiZoLmQueTx0Lnl8fGguby55Pj10LnkmJmguZC55Pj10Lnl8fChoLm8ueD09PWguZC54JiZoLm8ueD49dC54PyhvPWguby54LGE9dC55KTooaT0wLHI9KGguZC55LWguby55KS8oaC5kLngtaC5vLngpLHM9dC55LWkqdC54LG49aC5vLnktcipoLm8ueCxvPS0ocy1uKS8oaS1yKSxhPXMraSpvKSxvPj10LngmJihjKz0xKSwyIT09YykpKWJyZWFrO3JldHVybiBjfSxnZXRCb3VuZGluZ1JlY3RXaWR0aDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldEJvdW5kaW5nUmVjdCgpLndpZHRofSxnZXRCb3VuZGluZ1JlY3RIZWlnaHQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRCb3VuZGluZ1JlY3QoKS5oZWlnaHR9LGdldEJvdW5kaW5nUmVjdDpmdW5jdGlvbigpe3RoaXMub0Nvb3Jkc3x8dGhpcy5zZXRDb29yZHMoKTt2YXIgdD1bdGhpcy5vQ29vcmRzLnRsLngsdGhpcy5vQ29vcmRzLnRyLngsdGhpcy5vQ29vcmRzLmJyLngsdGhpcy5vQ29vcmRzLmJsLnhdLGU9ZmFicmljLnV0aWwuYXJyYXkubWluKHQpLGk9ZmFicmljLnV0aWwuYXJyYXkubWF4KHQpLHI9TWF0aC5hYnMoZS1pKSxzPVt0aGlzLm9Db29yZHMudGwueSx0aGlzLm9Db29yZHMudHIueSx0aGlzLm9Db29yZHMuYnIueSx0aGlzLm9Db29yZHMuYmwueV0sbj1mYWJyaWMudXRpbC5hcnJheS5taW4ocyksbz1mYWJyaWMudXRpbC5hcnJheS5tYXgocyksYT1NYXRoLmFicyhuLW8pO3JldHVybntsZWZ0OmUsdG9wOm4sd2lkdGg6cixoZWlnaHQ6YX19LGdldFdpZHRoOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMud2lkdGgqdGhpcy5zY2FsZVh9LGdldEhlaWdodDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmhlaWdodCp0aGlzLnNjYWxlWX0sX2NvbnN0cmFpblNjYWxlOmZ1bmN0aW9uKHQpe3JldHVybiBNYXRoLmFicyh0KTx0aGlzLm1pblNjYWxlTGltaXQ/MD50Py10aGlzLm1pblNjYWxlTGltaXQ6dGhpcy5taW5TY2FsZUxpbWl0OnR9LHNjYWxlOmZ1bmN0aW9uKHQpe3JldHVybiB0PXRoaXMuX2NvbnN0cmFpblNjYWxlKHQpLDA+dCYmKHRoaXMuZmxpcFg9IXRoaXMuZmxpcFgsdGhpcy5mbGlwWT0hdGhpcy5mbGlwWSx0Kj0tMSksdGhpcy5zY2FsZVg9dCx0aGlzLnNjYWxlWT10LHRoaXMuc2V0Q29vcmRzKCksdGhpc30sc2NhbGVUb1dpZHRoOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0Qm91bmRpbmdSZWN0V2lkdGgoKS90aGlzLmdldFdpZHRoKCk7cmV0dXJuIHRoaXMuc2NhbGUodC90aGlzLndpZHRoL2UpfSxzY2FsZVRvSGVpZ2h0OmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0Qm91bmRpbmdSZWN0SGVpZ2h0KCkvdGhpcy5nZXRIZWlnaHQoKTtyZXR1cm4gdGhpcy5zY2FsZSh0L3RoaXMuaGVpZ2h0L2UpfSxzZXRDb29yZHM6ZnVuY3Rpb24oKXt2YXIgZT10KHRoaXMuYW5nbGUpLGk9dGhpcy5nZXRWaWV3cG9ydFRyYW5zZm9ybSgpLHI9ZnVuY3Rpb24odCl7cmV0dXJuIGZhYnJpYy51dGlsLnRyYW5zZm9ybVBvaW50KHQsaSl9LHM9dGhpcy5fY2FsY3VsYXRlQ3VycmVudERpbWVuc2lvbnMoITEpLG49cy54LG89cy55OzA+biYmKG49TWF0aC5hYnMobikpO3ZhciBhPU1hdGguc3FydChNYXRoLnBvdyhuLzIsMikrTWF0aC5wb3coby8yLDIpKSxoPU1hdGguYXRhbihpc0Zpbml0ZShvL24pP28vbjowKSxjPU1hdGguY29zKGgrZSkqYSxsPU1hdGguc2luKGgrZSkqYSx1PU1hdGguc2luKGUpLGY9TWF0aC5jb3MoZSksZD10aGlzLmdldENlbnRlclBvaW50KCksZz1uZXcgZmFicmljLlBvaW50KG4sbykscD1uZXcgZmFicmljLlBvaW50KGQueC1jLGQueS1sKSx2PW5ldyBmYWJyaWMuUG9pbnQocC54K2cueCpmLHAueStnLngqdSksYj1yKG5ldyBmYWJyaWMuUG9pbnQocC54LWcueSp1LHAueStnLnkqZikpLG09cihuZXcgZmFicmljLlBvaW50KHYueC1nLnkqdSx2LnkrZy55KmYpKSx5PXIocCksXz1yKHYpLHg9bmV3IGZhYnJpYy5Qb2ludCgoeS54K2IueCkvMiwoeS55K2IueSkvMiksQz1uZXcgZmFicmljLlBvaW50KChfLngreS54KS8yLChfLnkreS55KS8yKSxTPW5ldyBmYWJyaWMuUG9pbnQoKG0ueCtfLngpLzIsKG0ueStfLnkpLzIpLHc9bmV3IGZhYnJpYy5Qb2ludCgobS54K2IueCkvMiwobS55K2IueSkvMiksTz1uZXcgZmFicmljLlBvaW50KEMueCt1KnRoaXMucm90YXRpbmdQb2ludE9mZnNldCxDLnktZip0aGlzLnJvdGF0aW5nUG9pbnRPZmZzZXQpO3JldHVybiB0aGlzLm9Db29yZHM9e3RsOnksdHI6XyxicjptLGJsOmIsbWw6eCxtdDpDLG1yOlMsbWI6dyxtdHI6T30sdGhpcy5fc2V0Q29ybmVyQ29vcmRzJiZ0aGlzLl9zZXRDb3JuZXJDb29yZHMoKSx0aGlzfX0pfSgpLGZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQoZmFicmljLk9iamVjdC5wcm90b3R5cGUse3NlbmRUb0JhY2s6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ncm91cD9mYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZS5zZW5kVG9CYWNrLmNhbGwodGhpcy5ncm91cCx0aGlzKTp0aGlzLmNhbnZhcy5zZW5kVG9CYWNrKHRoaXMpLHRoaXN9LGJyaW5nVG9Gcm9udDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdyb3VwP2ZhYnJpYy5TdGF0aWNDYW52YXMucHJvdG90eXBlLmJyaW5nVG9Gcm9udC5jYWxsKHRoaXMuZ3JvdXAsdGhpcyk6dGhpcy5jYW52YXMuYnJpbmdUb0Zyb250KHRoaXMpLHRoaXN9LHNlbmRCYWNrd2FyZHM6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZ3JvdXA/ZmFicmljLlN0YXRpY0NhbnZhcy5wcm90b3R5cGUuc2VuZEJhY2t3YXJkcy5jYWxsKHRoaXMuZ3JvdXAsdGhpcyx0KTp0aGlzLmNhbnZhcy5zZW5kQmFja3dhcmRzKHRoaXMsdCksdGhpc30sYnJpbmdGb3J3YXJkOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmdyb3VwP2ZhYnJpYy5TdGF0aWNDYW52YXMucHJvdG90eXBlLmJyaW5nRm9yd2FyZC5jYWxsKHRoaXMuZ3JvdXAsdGhpcyx0KTp0aGlzLmNhbnZhcy5icmluZ0ZvcndhcmQodGhpcyx0KSx0aGlzfSxtb3ZlVG86ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZ3JvdXA/ZmFicmljLlN0YXRpY0NhbnZhcy5wcm90b3R5cGUubW92ZVRvLmNhbGwodGhpcy5ncm91cCx0aGlzLHQpOnRoaXMuY2FudmFzLm1vdmVUbyh0aGlzLHQpLHRoaXN9fSksZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuT2JqZWN0LnByb3RvdHlwZSx7Z2V0U3ZnU3R5bGVzOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5maWxsP3RoaXMuZmlsbC50b0xpdmU/XCJ1cmwoI1NWR0lEX1wiK3RoaXMuZmlsbC5pZCtcIilcIjp0aGlzLmZpbGw6XCJub25lXCIsZT10aGlzLmZpbGxSdWxlLGk9dGhpcy5zdHJva2U/dGhpcy5zdHJva2UudG9MaXZlP1widXJsKCNTVkdJRF9cIit0aGlzLnN0cm9rZS5pZCtcIilcIjp0aGlzLnN0cm9rZTpcIm5vbmVcIixyPXRoaXMuc3Ryb2tlV2lkdGg/dGhpcy5zdHJva2VXaWR0aDpcIjBcIixzPXRoaXMuc3Ryb2tlRGFzaEFycmF5P3RoaXMuc3Ryb2tlRGFzaEFycmF5LmpvaW4oXCIgXCIpOlwiXCIsbj10aGlzLnN0cm9rZUxpbmVDYXA/dGhpcy5zdHJva2VMaW5lQ2FwOlwiYnV0dFwiLG89dGhpcy5zdHJva2VMaW5lSm9pbj90aGlzLnN0cm9rZUxpbmVKb2luOlwibWl0ZXJcIixhPXRoaXMuc3Ryb2tlTWl0ZXJMaW1pdD90aGlzLnN0cm9rZU1pdGVyTGltaXQ6XCI0XCIsaD1cInVuZGVmaW5lZFwiIT10eXBlb2YgdGhpcy5vcGFjaXR5P3RoaXMub3BhY2l0eTpcIjFcIixjPXRoaXMudmlzaWJsZT9cIlwiOlwiIHZpc2liaWxpdHk6IGhpZGRlbjtcIixsPXRoaXMuc2hhZG93P1wiZmlsdGVyOiB1cmwoI1NWR0lEX1wiK3RoaXMuc2hhZG93LmlkK1wiKTtcIjpcIlwiO3JldHVybltcInN0cm9rZTogXCIsaSxcIjsgXCIsXCJzdHJva2Utd2lkdGg6IFwiLHIsXCI7IFwiLFwic3Ryb2tlLWRhc2hhcnJheTogXCIscyxcIjsgXCIsXCJzdHJva2UtbGluZWNhcDogXCIsbixcIjsgXCIsXCJzdHJva2UtbGluZWpvaW46IFwiLG8sXCI7IFwiLFwic3Ryb2tlLW1pdGVybGltaXQ6IFwiLGEsXCI7IFwiLFwiZmlsbDogXCIsdCxcIjsgXCIsXCJmaWxsLXJ1bGU6IFwiLGUsXCI7IFwiLFwib3BhY2l0eTogXCIsaCxcIjtcIixsLGNdLmpvaW4oXCJcIil9LGdldFN2Z1RyYW5zZm9ybTpmdW5jdGlvbigpe2lmKHRoaXMuZ3JvdXAmJlwicGF0aC1ncm91cFwiPT09dGhpcy5ncm91cC50eXBlKXJldHVyblwiXCI7dmFyIHQ9ZmFicmljLnV0aWwudG9GaXhlZCxlPXRoaXMuZ2V0QW5nbGUoKSxpPSF0aGlzLmNhbnZhc3x8dGhpcy5jYW52YXMuc3ZnVmlld3BvcnRUcmFuc2Zvcm1hdGlvbj90aGlzLmdldFZpZXdwb3J0VHJhbnNmb3JtKCk6WzEsMCwwLDEsMCwwXSxyPWZhYnJpYy51dGlsLnRyYW5zZm9ybVBvaW50KHRoaXMuZ2V0Q2VudGVyUG9pbnQoKSxpKSxzPWZhYnJpYy5PYmplY3QuTlVNX0ZSQUNUSU9OX0RJR0lUUyxuPVwicGF0aC1ncm91cFwiPT09dGhpcy50eXBlP1wiXCI6XCJ0cmFuc2xhdGUoXCIrdChyLngscykrXCIgXCIrdChyLnkscykrXCIpXCIsbz0wIT09ZT9cIiByb3RhdGUoXCIrdChlLHMpK1wiKVwiOlwiXCIsYT0xPT09dGhpcy5zY2FsZVgmJjE9PT10aGlzLnNjYWxlWSYmMT09PWlbMF0mJjE9PT1pWzNdP1wiXCI6XCIgc2NhbGUoXCIrdCh0aGlzLnNjYWxlWCppWzBdLHMpK1wiIFwiK3QodGhpcy5zY2FsZVkqaVszXSxzKStcIilcIixoPVwicGF0aC1ncm91cFwiPT09dGhpcy50eXBlP3RoaXMud2lkdGgqaVswXTowLGM9dGhpcy5mbGlwWD9cIiBtYXRyaXgoLTEgMCAwIDEgXCIraCtcIiAwKSBcIjpcIlwiLGw9XCJwYXRoLWdyb3VwXCI9PT10aGlzLnR5cGU/dGhpcy5oZWlnaHQqaVszXTowLHU9dGhpcy5mbGlwWT9cIiBtYXRyaXgoMSAwIDAgLTEgMCBcIitsK1wiKVwiOlwiXCI7cmV0dXJuW24sbyxhLGMsdV0uam9pbihcIlwiKX0sZ2V0U3ZnVHJhbnNmb3JtTWF0cml4OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudHJhbnNmb3JtTWF0cml4P1wiIG1hdHJpeChcIit0aGlzLnRyYW5zZm9ybU1hdHJpeC5qb2luKFwiIFwiKStcIikgXCI6XCJcIn0sX2NyZWF0ZUJhc2VTVkdNYXJrdXA6ZnVuY3Rpb24oKXt2YXIgdD1bXTtyZXR1cm4gdGhpcy5maWxsJiZ0aGlzLmZpbGwudG9MaXZlJiZ0LnB1c2godGhpcy5maWxsLnRvU1ZHKHRoaXMsITEpKSx0aGlzLnN0cm9rZSYmdGhpcy5zdHJva2UudG9MaXZlJiZ0LnB1c2godGhpcy5zdHJva2UudG9TVkcodGhpcywhMSkpLHRoaXMuc2hhZG93JiZ0LnB1c2godGhpcy5zaGFkb3cudG9TVkcodGhpcykpLHR9fSksZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuT2JqZWN0LnByb3RvdHlwZSx7aGFzU3RhdGVDaGFuZ2VkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhdGVQcm9wZXJ0aWVzLnNvbWUoZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZ2V0KHQpIT09dGhpcy5vcmlnaW5hbFN0YXRlW3RdfSx0aGlzKX0sc2F2ZVN0YXRlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnN0YXRlUHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHQpe3RoaXMub3JpZ2luYWxTdGF0ZVt0XT10aGlzLmdldCh0KX0sdGhpcyksdCYmdC5zdGF0ZVByb3BlcnRpZXMmJnQuc3RhdGVQcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24odCl7dGhpcy5vcmlnaW5hbFN0YXRlW3RdPXRoaXMuZ2V0KHQpfSx0aGlzKSx0aGlzfSxzZXR1cFN0YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3JpZ2luYWxTdGF0ZT17fSx0aGlzLnNhdmVTdGF0ZSgpLHRoaXN9fSksZnVuY3Rpb24oKXt2YXIgdD1mYWJyaWMudXRpbC5kZWdyZWVzVG9SYWRpYW5zLGU9ZnVuY3Rpb24oKXtyZXR1cm5cInVuZGVmaW5lZFwiIT10eXBlb2YgR192bWxDYW52YXNNYW5hZ2VyfTtmYWJyaWMudXRpbC5vYmplY3QuZXh0ZW5kKGZhYnJpYy5PYmplY3QucHJvdG90eXBlLHtfY29udHJvbHNWaXNpYmlsaXR5Om51bGwsX2ZpbmRUYXJnZXRDb3JuZXI6ZnVuY3Rpb24odCl7aWYoIXRoaXMuaGFzQ29udHJvbHN8fCF0aGlzLmFjdGl2ZSlyZXR1cm4hMTt2YXIgZSxpLHI9dC54LHM9dC55O2Zvcih2YXIgbiBpbiB0aGlzLm9Db29yZHMpaWYodGhpcy5pc0NvbnRyb2xWaXNpYmxlKG4pJiYoXCJtdHJcIiE9PW58fHRoaXMuaGFzUm90YXRpbmdQb2ludCkmJighdGhpcy5nZXQoXCJsb2NrVW5pU2NhbGluZ1wiKXx8XCJtdFwiIT09biYmXCJtclwiIT09biYmXCJtYlwiIT09biYmXCJtbFwiIT09bikmJihpPXRoaXMuX2dldEltYWdlTGluZXModGhpcy5vQ29vcmRzW25dLmNvcm5lciksZT10aGlzLl9maW5kQ3Jvc3NQb2ludHMoe3g6cix5OnN9LGkpLDAhPT1lJiZlJTI9PT0xKSlyZXR1cm4gdGhpcy5fX2Nvcm5lcj1uLG47cmV0dXJuITF9LF9zZXRDb3JuZXJDb29yZHM6ZnVuY3Rpb24oKXt2YXIgZSxpLHI9dGhpcy5vQ29vcmRzLHM9dCg0NS10aGlzLmFuZ2xlKSxuPU1hdGguc3FydCgyKk1hdGgucG93KHRoaXMuY29ybmVyU2l6ZSwyKSkvMixvPW4qTWF0aC5jb3MocyksYT1uKk1hdGguc2luKHMpO2Zvcih2YXIgaCBpbiByKWU9cltoXS54LGk9cltoXS55LHJbaF0uY29ybmVyPXt0bDp7eDplLWEseTppLW99LHRyOnt4OmUrbyx5OmktYX0sYmw6e3g6ZS1vLHk6aSthfSxicjp7eDplK2EseTppK299fX0sX2NhbGN1bGF0ZUN1cnJlbnREaW1lbnNpb25zOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0Vmlld3BvcnRUcmFuc2Zvcm0oKSxpPXRoaXMuc3Ryb2tlV2lkdGgscj10aGlzLndpZHRoLHM9dGhpcy5oZWlnaHQsbj1cInJvdW5kXCI9PT10aGlzLnN0cm9rZUxpbmVDYXB8fFwic3F1YXJlXCI9PT10aGlzLnN0cm9rZUxpbmVDYXAsbz1cImxpbmVcIj09PXRoaXMudHlwZSYmMD09PXRoaXMud2lkdGgsYT1cImxpbmVcIj09PXRoaXMudHlwZSYmMD09PXRoaXMuaGVpZ2h0LGg9b3x8YSxjPW4mJmF8fCFoLGw9biYmb3x8IWg7cmV0dXJuIG8/cj1pOmEmJihzPWkpLGMmJihyKz0wPnI/LWk6aSksbCYmKHMrPTA+cz8taTppKSxyPXIqdGhpcy5zY2FsZVgrMip0aGlzLnBhZGRpbmcscz1zKnRoaXMuc2NhbGVZKzIqdGhpcy5wYWRkaW5nLHQ/ZmFicmljLnV0aWwudHJhbnNmb3JtUG9pbnQobmV3IGZhYnJpYy5Qb2ludChyLHMpLGUsITApOnt4OnIseTpzfX0sZHJhd0JvcmRlcnM6ZnVuY3Rpb24odCl7aWYoIXRoaXMuaGFzQm9yZGVycylyZXR1cm4gdGhpczt0LnNhdmUoKSx0Lmdsb2JhbEFscGhhPXRoaXMuaXNNb3Zpbmc/dGhpcy5ib3JkZXJPcGFjaXR5V2hlbk1vdmluZzoxLHQuc3Ryb2tlU3R5bGU9dGhpcy5ib3JkZXJDb2xvcix0LmxpbmVXaWR0aD0xL3RoaXMuYm9yZGVyU2NhbGVGYWN0b3I7dmFyIGU9dGhpcy5fY2FsY3VsYXRlQ3VycmVudERpbWVuc2lvbnMoITApLGk9ZS54LHI9ZS55O2lmKHRoaXMuZ3JvdXAmJihpKj10aGlzLmdyb3VwLnNjYWxlWCxyKj10aGlzLmdyb3VwLnNjYWxlWSksdC5zdHJva2VSZWN0KH5+LShpLzIpLS41LH5+LShyLzIpLS41LH5+aSsxLH5+cisxKSx0aGlzLmhhc1JvdGF0aW5nUG9pbnQmJnRoaXMuaXNDb250cm9sVmlzaWJsZShcIm10clwiKSYmIXRoaXMuZ2V0KFwibG9ja1JvdGF0aW9uXCIpJiZ0aGlzLmhhc0NvbnRyb2xzKXt2YXIgcz0tci8yO3QuYmVnaW5QYXRoKCksdC5tb3ZlVG8oMCxzKSx0LmxpbmVUbygwLHMtdGhpcy5yb3RhdGluZ1BvaW50T2Zmc2V0KSx0LmNsb3NlUGF0aCgpLHQuc3Ryb2tlKCl9cmV0dXJuIHQucmVzdG9yZSgpLHRoaXN9LGRyYXdDb250cm9sczpmdW5jdGlvbih0KXtpZighdGhpcy5oYXNDb250cm9scylyZXR1cm4gdGhpczt2YXIgZT10aGlzLl9jYWxjdWxhdGVDdXJyZW50RGltZW5zaW9ucyghMCksaT1lLngscj1lLnkscz0tKGkvMiksbj0tKHIvMiksbz10aGlzLmNvcm5lclNpemUvMixhPXRoaXMudHJhbnNwYXJlbnRDb3JuZXJzP1wic3Ryb2tlUmVjdFwiOlwiZmlsbFJlY3RcIjtyZXR1cm4gdC5zYXZlKCksdC5saW5lV2lkdGg9MSx0Lmdsb2JhbEFscGhhPXRoaXMuaXNNb3Zpbmc/dGhpcy5ib3JkZXJPcGFjaXR5V2hlbk1vdmluZzoxLHQuc3Ryb2tlU3R5bGU9dC5maWxsU3R5bGU9dGhpcy5jb3JuZXJDb2xvcix0aGlzLl9kcmF3Q29udHJvbChcInRsXCIsdCxhLHMtbyxuLW8pLHRoaXMuX2RyYXdDb250cm9sKFwidHJcIix0LGEscytpLW8sbi1vKSx0aGlzLl9kcmF3Q29udHJvbChcImJsXCIsdCxhLHMtbyxuK3ItbyksdGhpcy5fZHJhd0NvbnRyb2woXCJiclwiLHQsYSxzK2ktbyxuK3ItbyksdGhpcy5nZXQoXCJsb2NrVW5pU2NhbGluZ1wiKXx8KHRoaXMuX2RyYXdDb250cm9sKFwibXRcIix0LGEscytpLzItbyxuLW8pLHRoaXMuX2RyYXdDb250cm9sKFwibWJcIix0LGEscytpLzItbyxuK3ItbyksdGhpcy5fZHJhd0NvbnRyb2woXCJtclwiLHQsYSxzK2ktbyxuK3IvMi1vKSx0aGlzLl9kcmF3Q29udHJvbChcIm1sXCIsdCxhLHMtbyxuK3IvMi1vKSksdGhpcy5oYXNSb3RhdGluZ1BvaW50JiZ0aGlzLl9kcmF3Q29udHJvbChcIm10clwiLHQsYSxzK2kvMi1vLG4tdGhpcy5yb3RhdGluZ1BvaW50T2Zmc2V0LW8pLHQucmVzdG9yZSgpLHRoaXN9LF9kcmF3Q29udHJvbDpmdW5jdGlvbih0LGkscixzLG4pe2lmKHRoaXMuaXNDb250cm9sVmlzaWJsZSh0KSl7dmFyIG89dGhpcy5jb3JuZXJTaXplO2UoKXx8dGhpcy50cmFuc3BhcmVudENvcm5lcnN8fGkuY2xlYXJSZWN0KHMsbixvLG8pLGlbcl0ocyxuLG8sbyl9fSxpc0NvbnRyb2xWaXNpYmxlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9nZXRDb250cm9sc1Zpc2liaWxpdHkoKVt0XX0sc2V0Q29udHJvbFZpc2libGU6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5fZ2V0Q29udHJvbHNWaXNpYmlsaXR5KClbdF09ZSx0aGlzfSxzZXRDb250cm9sc1Zpc2liaWxpdHk6ZnVuY3Rpb24odCl7dHx8KHQ9e30pO2Zvcih2YXIgZSBpbiB0KXRoaXMuc2V0Q29udHJvbFZpc2libGUoZSx0W2VdKTtyZXR1cm4gdGhpc30sX2dldENvbnRyb2xzVmlzaWJpbGl0eTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jb250cm9sc1Zpc2liaWxpdHl8fCh0aGlzLl9jb250cm9sc1Zpc2liaWxpdHk9e3RsOiEwLHRyOiEwLGJyOiEwLGJsOiEwLG1sOiEwLG10OiEwLG1yOiEwLG1iOiEwLG10cjohMH0pLHRoaXMuX2NvbnRyb2xzVmlzaWJpbGl0eX19KX0oKSxmYWJyaWMudXRpbC5vYmplY3QuZXh0ZW5kKGZhYnJpYy5TdGF0aWNDYW52YXMucHJvdG90eXBlLHtGWF9EVVJBVElPTjo1MDAsZnhDZW50ZXJPYmplY3RIOmZ1bmN0aW9uKHQsZSl7ZT1lfHx7fTt2YXIgaT1mdW5jdGlvbigpe30scj1lLm9uQ29tcGxldGV8fGkscz1lLm9uQ2hhbmdlfHxpLG49dGhpcztyZXR1cm4gZmFicmljLnV0aWwuYW5pbWF0ZSh7c3RhcnRWYWx1ZTp0LmdldChcImxlZnRcIiksZW5kVmFsdWU6dGhpcy5nZXRDZW50ZXIoKS5sZWZ0LGR1cmF0aW9uOnRoaXMuRlhfRFVSQVRJT04sb25DaGFuZ2U6ZnVuY3Rpb24oZSl7dC5zZXQoXCJsZWZ0XCIsZSksbi5yZW5kZXJBbGwoKSxzKCl9LG9uQ29tcGxldGU6ZnVuY3Rpb24oKXt0LnNldENvb3JkcygpLHIoKX19KSx0aGlzfSxmeENlbnRlck9iamVjdFY6ZnVuY3Rpb24odCxlKXtlPWV8fHt9O3ZhciBpPWZ1bmN0aW9uKCl7fSxyPWUub25Db21wbGV0ZXx8aSxzPWUub25DaGFuZ2V8fGksbj10aGlzO3JldHVybiBmYWJyaWMudXRpbC5hbmltYXRlKHtzdGFydFZhbHVlOnQuZ2V0KFwidG9wXCIpLGVuZFZhbHVlOnRoaXMuZ2V0Q2VudGVyKCkudG9wLGR1cmF0aW9uOnRoaXMuRlhfRFVSQVRJT04sb25DaGFuZ2U6ZnVuY3Rpb24oZSl7dC5zZXQoXCJ0b3BcIixlKSxuLnJlbmRlckFsbCgpLHMoKX0sb25Db21wbGV0ZTpmdW5jdGlvbigpe3Quc2V0Q29vcmRzKCkscigpfX0pLHRoaXN9LGZ4UmVtb3ZlOmZ1bmN0aW9uKHQsZSl7ZT1lfHx7fTt2YXIgaT1mdW5jdGlvbigpe30scj1lLm9uQ29tcGxldGV8fGkscz1lLm9uQ2hhbmdlfHxpLG49dGhpcztyZXR1cm4gZmFicmljLnV0aWwuYW5pbWF0ZSh7c3RhcnRWYWx1ZTp0LmdldChcIm9wYWNpdHlcIiksZW5kVmFsdWU6MCxkdXJhdGlvbjp0aGlzLkZYX0RVUkFUSU9OLG9uU3RhcnQ6ZnVuY3Rpb24oKXt0LnNldChcImFjdGl2ZVwiLCExKX0sb25DaGFuZ2U6ZnVuY3Rpb24oZSl7dC5zZXQoXCJvcGFjaXR5XCIsZSksbi5yZW5kZXJBbGwoKSxzKCl9LG9uQ29tcGxldGU6ZnVuY3Rpb24oKXtuLnJlbW92ZSh0KSxyKCl9fSksdGhpc319KSxmYWJyaWMudXRpbC5vYmplY3QuZXh0ZW5kKGZhYnJpYy5PYmplY3QucHJvdG90eXBlLHthbmltYXRlOmZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzWzBdJiZcIm9iamVjdFwiPT10eXBlb2YgYXJndW1lbnRzWzBdKXt2YXIgdCxlLGk9W107Zm9yKHQgaW4gYXJndW1lbnRzWzBdKWkucHVzaCh0KTtmb3IodmFyIHI9MCxzPWkubGVuZ3RoO3M+cjtyKyspdD1pW3JdLGU9ciE9PXMtMSx0aGlzLl9hbmltYXRlKHQsYXJndW1lbnRzWzBdW3RdLGFyZ3VtZW50c1sxXSxlKX1lbHNlIHRoaXMuX2FuaW1hdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybiB0aGlzfSxfYW5pbWF0ZTpmdW5jdGlvbih0LGUsaSxyKXt2YXIgcyxuPXRoaXM7ZT1lLnRvU3RyaW5nKCksaT1pP2ZhYnJpYy51dGlsLm9iamVjdC5jbG9uZShpKTp7fSx+dC5pbmRleE9mKFwiLlwiKSYmKHM9dC5zcGxpdChcIi5cIikpO3ZhciBvPXM/dGhpcy5nZXQoc1swXSlbc1sxXV06dGhpcy5nZXQodCk7XCJmcm9tXCJpbiBpfHwoaS5mcm9tPW8pLGU9fmUuaW5kZXhPZihcIj1cIik/bytwYXJzZUZsb2F0KGUucmVwbGFjZShcIj1cIixcIlwiKSk6cGFyc2VGbG9hdChlKSxmYWJyaWMudXRpbC5hbmltYXRlKHtzdGFydFZhbHVlOmkuZnJvbSxlbmRWYWx1ZTplLGJ5VmFsdWU6aS5ieSxlYXNpbmc6aS5lYXNpbmcsZHVyYXRpb246aS5kdXJhdGlvbixhYm9ydDppLmFib3J0JiZmdW5jdGlvbigpe3JldHVybiBpLmFib3J0LmNhbGwobil9LG9uQ2hhbmdlOmZ1bmN0aW9uKGUpe3M/bltzWzBdXVtzWzFdXT1lOm4uc2V0KHQsZSkscnx8aS5vbkNoYW5nZSYmaS5vbkNoYW5nZSgpfSxvbkNvbXBsZXRlOmZ1bmN0aW9uKCl7cnx8KG4uc2V0Q29vcmRzKCksaS5vbkNvbXBsZXRlJiZpLm9uQ29tcGxldGUoKSl9fSl9fSksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gZSh0LGUpe3ZhciBpPXQub3JpZ2luLHI9dC5heGlzMSxzPXQuYXhpczIsbj10LmRpbWVuc2lvbixvPWUubmVhcmVzdCxhPWUuY2VudGVyLGg9ZS5mYXJ0aGVzdDtyZXR1cm4gZnVuY3Rpb24oKXtzd2l0Y2godGhpcy5nZXQoaSkpe2Nhc2UgbzpyZXR1cm4gTWF0aC5taW4odGhpcy5nZXQociksdGhpcy5nZXQocykpO2Nhc2UgYTpyZXR1cm4gTWF0aC5taW4odGhpcy5nZXQociksdGhpcy5nZXQocykpKy41KnRoaXMuZ2V0KG4pO2Nhc2UgaDpyZXR1cm4gTWF0aC5tYXgodGhpcy5nZXQociksdGhpcy5nZXQocykpO1xyXG5cclxufX19dmFyIGk9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSkscj1pLnV0aWwub2JqZWN0LmV4dGVuZCxzPXt4MToxLHgyOjEseTE6MSx5MjoxfSxuPWkuU3RhdGljQ2FudmFzLnN1cHBvcnRzKFwic2V0TGluZURhc2hcIik7cmV0dXJuIGkuTGluZT92b2lkIGkud2FybihcImZhYnJpYy5MaW5lIGlzIGFscmVhZHkgZGVmaW5lZFwiKTooaS5MaW5lPWkudXRpbC5jcmVhdGVDbGFzcyhpLk9iamVjdCx7dHlwZTpcImxpbmVcIix4MTowLHkxOjAseDI6MCx5MjowLGluaXRpYWxpemU6ZnVuY3Rpb24odCxlKXtlPWV8fHt9LHR8fCh0PVswLDAsMCwwXSksdGhpcy5jYWxsU3VwZXIoXCJpbml0aWFsaXplXCIsZSksdGhpcy5zZXQoXCJ4MVwiLHRbMF0pLHRoaXMuc2V0KFwieTFcIix0WzFdKSx0aGlzLnNldChcIngyXCIsdFsyXSksdGhpcy5zZXQoXCJ5MlwiLHRbM10pLHRoaXMuX3NldFdpZHRoSGVpZ2h0KGUpfSxfc2V0V2lkdGhIZWlnaHQ6ZnVuY3Rpb24odCl7dHx8KHQ9e30pLHRoaXMud2lkdGg9TWF0aC5hYnModGhpcy54Mi10aGlzLngxKSx0aGlzLmhlaWdodD1NYXRoLmFicyh0aGlzLnkyLXRoaXMueTEpLHRoaXMubGVmdD1cImxlZnRcImluIHQ/dC5sZWZ0OnRoaXMuX2dldExlZnRUb09yaWdpblgoKSx0aGlzLnRvcD1cInRvcFwiaW4gdD90LnRvcDp0aGlzLl9nZXRUb3BUb09yaWdpblkoKX0sX3NldDpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLmNhbGxTdXBlcihcIl9zZXRcIix0LGUpLFwidW5kZWZpbmVkXCIhPXR5cGVvZiBzW3RdJiZ0aGlzLl9zZXRXaWR0aEhlaWdodCgpLHRoaXN9LF9nZXRMZWZ0VG9PcmlnaW5YOmUoe29yaWdpbjpcIm9yaWdpblhcIixheGlzMTpcIngxXCIsYXhpczI6XCJ4MlwiLGRpbWVuc2lvbjpcIndpZHRoXCJ9LHtuZWFyZXN0OlwibGVmdFwiLGNlbnRlcjpcImNlbnRlclwiLGZhcnRoZXN0OlwicmlnaHRcIn0pLF9nZXRUb3BUb09yaWdpblk6ZSh7b3JpZ2luOlwib3JpZ2luWVwiLGF4aXMxOlwieTFcIixheGlzMjpcInkyXCIsZGltZW5zaW9uOlwiaGVpZ2h0XCJ9LHtuZWFyZXN0OlwidG9wXCIsY2VudGVyOlwiY2VudGVyXCIsZmFydGhlc3Q6XCJib3R0b21cIn0pLF9yZW5kZXI6ZnVuY3Rpb24odCxlKXtpZih0LmJlZ2luUGF0aCgpLGUpe3ZhciBpPXRoaXMuZ2V0Q2VudGVyUG9pbnQoKTt0LnRyYW5zbGF0ZShpLngtdGhpcy5zdHJva2VXaWR0aC8yLGkueS10aGlzLnN0cm9rZVdpZHRoLzIpfWlmKCF0aGlzLnN0cm9rZURhc2hBcnJheXx8dGhpcy5zdHJva2VEYXNoQXJyYXkmJm4pe3ZhciByPXRoaXMuY2FsY0xpbmVQb2ludHMoKTt0Lm1vdmVUbyhyLngxLHIueTEpLHQubGluZVRvKHIueDIsci55Mil9dC5saW5lV2lkdGg9dGhpcy5zdHJva2VXaWR0aDt2YXIgcz10LnN0cm9rZVN0eWxlO3Quc3Ryb2tlU3R5bGU9dGhpcy5zdHJva2V8fHQuZmlsbFN0eWxlLHRoaXMuc3Ryb2tlJiZ0aGlzLl9yZW5kZXJTdHJva2UodCksdC5zdHJva2VTdHlsZT1zfSxfcmVuZGVyRGFzaGVkU3Ryb2tlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuY2FsY0xpbmVQb2ludHMoKTt0LmJlZ2luUGF0aCgpLGkudXRpbC5kcmF3RGFzaGVkTGluZSh0LGUueDEsZS55MSxlLngyLGUueTIsdGhpcy5zdHJva2VEYXNoQXJyYXkpLHQuY2xvc2VQYXRoKCl9LHRvT2JqZWN0OmZ1bmN0aW9uKHQpe3JldHVybiByKHRoaXMuY2FsbFN1cGVyKFwidG9PYmplY3RcIix0KSx0aGlzLmNhbGNMaW5lUG9pbnRzKCkpfSxjYWxjTGluZVBvaW50czpmdW5jdGlvbigpe3ZhciB0PXRoaXMueDE8PXRoaXMueDI/LTE6MSxlPXRoaXMueTE8PXRoaXMueTI/LTE6MSxpPXQqdGhpcy53aWR0aCouNSxyPWUqdGhpcy5oZWlnaHQqLjUscz10KnRoaXMud2lkdGgqLS41LG49ZSp0aGlzLmhlaWdodCotLjU7cmV0dXJue3gxOmkseDI6cyx5MTpyLHkyOm59fSx0b1NWRzpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl9jcmVhdGVCYXNlU1ZHTWFya3VwKCksaT17eDE6dGhpcy54MSx4Mjp0aGlzLngyLHkxOnRoaXMueTEseTI6dGhpcy55Mn07cmV0dXJuIHRoaXMuZ3JvdXAmJlwicGF0aC1ncm91cFwiPT09dGhpcy5ncm91cC50eXBlfHwoaT10aGlzLmNhbGNMaW5lUG9pbnRzKCkpLGUucHVzaChcIjxsaW5lIFwiLCd4MT1cIicsaS54MSwnXCIgeTE9XCInLGkueTEsJ1wiIHgyPVwiJyxpLngyLCdcIiB5Mj1cIicsaS55MiwnXCIgc3R5bGU9XCInLHRoaXMuZ2V0U3ZnU3R5bGVzKCksJ1wiIHRyYW5zZm9ybT1cIicsdGhpcy5nZXRTdmdUcmFuc2Zvcm0oKSx0aGlzLmdldFN2Z1RyYW5zZm9ybU1hdHJpeCgpLCdcIi8+XFxuJyksdD90KGUuam9pbihcIlwiKSk6ZS5qb2luKFwiXCIpfSxjb21wbGV4aXR5OmZ1bmN0aW9uKCl7cmV0dXJuIDF9fSksaS5MaW5lLkFUVFJJQlVURV9OQU1FUz1pLlNIQVJFRF9BVFRSSUJVVEVTLmNvbmNhdChcIngxIHkxIHgyIHkyXCIuc3BsaXQoXCIgXCIpKSxpLkxpbmUuZnJvbUVsZW1lbnQ9ZnVuY3Rpb24odCxlKXt2YXIgcz1pLnBhcnNlQXR0cmlidXRlcyh0LGkuTGluZS5BVFRSSUJVVEVfTkFNRVMpLG49W3MueDF8fDAscy55MXx8MCxzLngyfHwwLHMueTJ8fDBdO3JldHVybiBuZXcgaS5MaW5lKG4scihzLGUpKX0sdm9pZChpLkxpbmUuZnJvbU9iamVjdD1mdW5jdGlvbih0KXt2YXIgZT1bdC54MSx0LnkxLHQueDIsdC55Ml07cmV0dXJuIG5ldyBpLkxpbmUoZSx0KX0pKX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBlKHQpe3JldHVyblwicmFkaXVzXCJpbiB0JiZ0LnJhZGl1cz49MH12YXIgaT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxyPU1hdGguUEkscz1pLnV0aWwub2JqZWN0LmV4dGVuZDtyZXR1cm4gaS5DaXJjbGU/dm9pZCBpLndhcm4oXCJmYWJyaWMuQ2lyY2xlIGlzIGFscmVhZHkgZGVmaW5lZC5cIik6KGkuQ2lyY2xlPWkudXRpbC5jcmVhdGVDbGFzcyhpLk9iamVjdCx7dHlwZTpcImNpcmNsZVwiLHJhZGl1czowLHN0YXJ0QW5nbGU6MCxlbmRBbmdsZToyKnIsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0PXR8fHt9LHRoaXMuY2FsbFN1cGVyKFwiaW5pdGlhbGl6ZVwiLHQpLHRoaXMuc2V0KFwicmFkaXVzXCIsdC5yYWRpdXN8fDApLHRoaXMuc3RhcnRBbmdsZT10LnN0YXJ0QW5nbGV8fHRoaXMuc3RhcnRBbmdsZSx0aGlzLmVuZEFuZ2xlPXQuZW5kQW5nbGV8fHRoaXMuZW5kQW5nbGV9LF9zZXQ6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5jYWxsU3VwZXIoXCJfc2V0XCIsdCxlKSxcInJhZGl1c1wiPT09dCYmdGhpcy5zZXRSYWRpdXMoZSksdGhpc30sdG9PYmplY3Q6ZnVuY3Rpb24odCl7cmV0dXJuIHModGhpcy5jYWxsU3VwZXIoXCJ0b09iamVjdFwiLHQpLHtyYWRpdXM6dGhpcy5nZXQoXCJyYWRpdXNcIiksc3RhcnRBbmdsZTp0aGlzLnN0YXJ0QW5nbGUsZW5kQW5nbGU6dGhpcy5lbmRBbmdsZX0pfSx0b1NWRzpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl9jcmVhdGVCYXNlU1ZHTWFya3VwKCksaT0wLHM9MCxuPSh0aGlzLmVuZEFuZ2xlLXRoaXMuc3RhcnRBbmdsZSklKDIqcik7aWYoMD09PW4pdGhpcy5ncm91cCYmXCJwYXRoLWdyb3VwXCI9PT10aGlzLmdyb3VwLnR5cGUmJihpPXRoaXMubGVmdCt0aGlzLnJhZGl1cyxzPXRoaXMudG9wK3RoaXMucmFkaXVzKSxlLnB1c2goXCI8Y2lyY2xlIFwiLCdjeD1cIicraSsnXCIgY3k9XCInK3MrJ1wiICcsJ3I9XCInLHRoaXMucmFkaXVzLCdcIiBzdHlsZT1cIicsdGhpcy5nZXRTdmdTdHlsZXMoKSwnXCIgdHJhbnNmb3JtPVwiJyx0aGlzLmdldFN2Z1RyYW5zZm9ybSgpLFwiIFwiLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtTWF0cml4KCksJ1wiLz5cXG4nKTtlbHNle3ZhciBvPU1hdGguY29zKHRoaXMuc3RhcnRBbmdsZSkqdGhpcy5yYWRpdXMsYT1NYXRoLnNpbih0aGlzLnN0YXJ0QW5nbGUpKnRoaXMucmFkaXVzLGg9TWF0aC5jb3ModGhpcy5lbmRBbmdsZSkqdGhpcy5yYWRpdXMsYz1NYXRoLnNpbih0aGlzLmVuZEFuZ2xlKSp0aGlzLnJhZGl1cyxsPW4+cj9cIjFcIjpcIjBcIjtlLnB1c2goJzxwYXRoIGQ9XCJNICcrbytcIiBcIithLFwiIEEgXCIrdGhpcy5yYWRpdXMrXCIgXCIrdGhpcy5yYWRpdXMsXCIgMCBcIiwrbCtcIiAxXCIsXCIgXCIraCtcIiBcIitjLCdcIiBzdHlsZT1cIicsdGhpcy5nZXRTdmdTdHlsZXMoKSwnXCIgdHJhbnNmb3JtPVwiJyx0aGlzLmdldFN2Z1RyYW5zZm9ybSgpLFwiIFwiLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtTWF0cml4KCksJ1wiLz5cXG4nKX1yZXR1cm4gdD90KGUuam9pbihcIlwiKSk6ZS5qb2luKFwiXCIpfSxfcmVuZGVyOmZ1bmN0aW9uKHQsZSl7dC5iZWdpblBhdGgoKSx0LmFyYyhlP3RoaXMubGVmdCt0aGlzLnJhZGl1czowLGU/dGhpcy50b3ArdGhpcy5yYWRpdXM6MCx0aGlzLnJhZGl1cyx0aGlzLnN0YXJ0QW5nbGUsdGhpcy5lbmRBbmdsZSwhMSksdGhpcy5fcmVuZGVyRmlsbCh0KSx0aGlzLl9yZW5kZXJTdHJva2UodCl9LGdldFJhZGl1c1g6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXQoXCJyYWRpdXNcIikqdGhpcy5nZXQoXCJzY2FsZVhcIil9LGdldFJhZGl1c1k6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXQoXCJyYWRpdXNcIikqdGhpcy5nZXQoXCJzY2FsZVlcIil9LHNldFJhZGl1czpmdW5jdGlvbih0KXt0aGlzLnJhZGl1cz10LHRoaXMuc2V0KFwid2lkdGhcIiwyKnQpLnNldChcImhlaWdodFwiLDIqdCl9LGNvbXBsZXhpdHk6ZnVuY3Rpb24oKXtyZXR1cm4gMX19KSxpLkNpcmNsZS5BVFRSSUJVVEVfTkFNRVM9aS5TSEFSRURfQVRUUklCVVRFUy5jb25jYXQoXCJjeCBjeSByXCIuc3BsaXQoXCIgXCIpKSxpLkNpcmNsZS5mcm9tRWxlbWVudD1mdW5jdGlvbih0LHIpe3J8fChyPXt9KTt2YXIgbj1pLnBhcnNlQXR0cmlidXRlcyh0LGkuQ2lyY2xlLkFUVFJJQlVURV9OQU1FUyk7aWYoIWUobikpdGhyb3cgbmV3IEVycm9yKFwidmFsdWUgb2YgYHJgIGF0dHJpYnV0ZSBpcyByZXF1aXJlZCBhbmQgY2FuIG5vdCBiZSBuZWdhdGl2ZVwiKTtuLmxlZnQ9bi5sZWZ0fHwwLG4udG9wPW4udG9wfHwwO3ZhciBvPW5ldyBpLkNpcmNsZShzKG4scikpO3JldHVybiBvLmxlZnQtPW8ucmFkaXVzLG8udG9wLT1vLnJhZGl1cyxvfSx2b2lkKGkuQ2lyY2xlLmZyb21PYmplY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBpLkNpcmNsZSh0KX0pKX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KTtyZXR1cm4gZS5UcmlhbmdsZT92b2lkIGUud2FybihcImZhYnJpYy5UcmlhbmdsZSBpcyBhbHJlYWR5IGRlZmluZWRcIik6KGUuVHJpYW5nbGU9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuT2JqZWN0LHt0eXBlOlwidHJpYW5nbGVcIixpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3Q9dHx8e30sdGhpcy5jYWxsU3VwZXIoXCJpbml0aWFsaXplXCIsdCksdGhpcy5zZXQoXCJ3aWR0aFwiLHQud2lkdGh8fDEwMCkuc2V0KFwiaGVpZ2h0XCIsdC5oZWlnaHR8fDEwMCl9LF9yZW5kZXI6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy53aWR0aC8yLGk9dGhpcy5oZWlnaHQvMjt0LmJlZ2luUGF0aCgpLHQubW92ZVRvKC1lLGkpLHQubGluZVRvKDAsLWkpLHQubGluZVRvKGUsaSksdC5jbG9zZVBhdGgoKSx0aGlzLl9yZW5kZXJGaWxsKHQpLHRoaXMuX3JlbmRlclN0cm9rZSh0KX0sX3JlbmRlckRhc2hlZFN0cm9rZTpmdW5jdGlvbih0KXt2YXIgaT10aGlzLndpZHRoLzIscj10aGlzLmhlaWdodC8yO3QuYmVnaW5QYXRoKCksZS51dGlsLmRyYXdEYXNoZWRMaW5lKHQsLWksciwwLC1yLHRoaXMuc3Ryb2tlRGFzaEFycmF5KSxlLnV0aWwuZHJhd0Rhc2hlZExpbmUodCwwLC1yLGkscix0aGlzLnN0cm9rZURhc2hBcnJheSksZS51dGlsLmRyYXdEYXNoZWRMaW5lKHQsaSxyLC1pLHIsdGhpcy5zdHJva2VEYXNoQXJyYXkpLHQuY2xvc2VQYXRoKCl9LHRvU1ZHOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX2NyZWF0ZUJhc2VTVkdNYXJrdXAoKSxpPXRoaXMud2lkdGgvMixyPXRoaXMuaGVpZ2h0LzIscz1bLWkrXCIgXCIrcixcIjAgXCIrLXIsaStcIiBcIityXS5qb2luKFwiLFwiKTtyZXR1cm4gZS5wdXNoKFwiPHBvbHlnb24gXCIsJ3BvaW50cz1cIicscywnXCIgc3R5bGU9XCInLHRoaXMuZ2V0U3ZnU3R5bGVzKCksJ1wiIHRyYW5zZm9ybT1cIicsdGhpcy5nZXRTdmdUcmFuc2Zvcm0oKSwnXCIvPicpLHQ/dChlLmpvaW4oXCJcIikpOmUuam9pbihcIlwiKX0sY29tcGxleGl0eTpmdW5jdGlvbigpe3JldHVybiAxfX0pLHZvaWQoZS5UcmlhbmdsZS5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5UcmlhbmdsZSh0KX0pKX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPTIqTWF0aC5QSSxyPWUudXRpbC5vYmplY3QuZXh0ZW5kO3JldHVybiBlLkVsbGlwc2U/dm9pZCBlLndhcm4oXCJmYWJyaWMuRWxsaXBzZSBpcyBhbHJlYWR5IGRlZmluZWQuXCIpOihlLkVsbGlwc2U9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuT2JqZWN0LHt0eXBlOlwiZWxsaXBzZVwiLHJ4OjAscnk6MCxpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3Q9dHx8e30sdGhpcy5jYWxsU3VwZXIoXCJpbml0aWFsaXplXCIsdCksdGhpcy5zZXQoXCJyeFwiLHQucnh8fDApLHRoaXMuc2V0KFwicnlcIix0LnJ5fHwwKX0sX3NldDpmdW5jdGlvbih0LGUpe3N3aXRjaCh0aGlzLmNhbGxTdXBlcihcIl9zZXRcIix0LGUpLHQpe2Nhc2VcInJ4XCI6dGhpcy5yeD1lLHRoaXMuc2V0KFwid2lkdGhcIiwyKmUpO2JyZWFrO2Nhc2VcInJ5XCI6dGhpcy5yeT1lLHRoaXMuc2V0KFwiaGVpZ2h0XCIsMiplKX1yZXR1cm4gdGhpc30sZ2V0Ung6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXQoXCJyeFwiKSp0aGlzLmdldChcInNjYWxlWFwiKX0sZ2V0Unk6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXQoXCJyeVwiKSp0aGlzLmdldChcInNjYWxlWVwiKX0sdG9PYmplY3Q6ZnVuY3Rpb24odCl7cmV0dXJuIHIodGhpcy5jYWxsU3VwZXIoXCJ0b09iamVjdFwiLHQpLHtyeDp0aGlzLmdldChcInJ4XCIpLHJ5OnRoaXMuZ2V0KFwicnlcIil9KX0sdG9TVkc6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fY3JlYXRlQmFzZVNWR01hcmt1cCgpLGk9MCxyPTA7cmV0dXJuIHRoaXMuZ3JvdXAmJlwicGF0aC1ncm91cFwiPT09dGhpcy5ncm91cC50eXBlJiYoaT10aGlzLmxlZnQrdGhpcy5yeCxyPXRoaXMudG9wK3RoaXMucnkpLGUucHVzaChcIjxlbGxpcHNlIFwiLCdjeD1cIicsaSwnXCIgY3k9XCInLHIsJ1wiICcsJ3J4PVwiJyx0aGlzLnJ4LCdcIiByeT1cIicsdGhpcy5yeSwnXCIgc3R5bGU9XCInLHRoaXMuZ2V0U3ZnU3R5bGVzKCksJ1wiIHRyYW5zZm9ybT1cIicsdGhpcy5nZXRTdmdUcmFuc2Zvcm0oKSx0aGlzLmdldFN2Z1RyYW5zZm9ybU1hdHJpeCgpLCdcIi8+XFxuJyksdD90KGUuam9pbihcIlwiKSk6ZS5qb2luKFwiXCIpfSxfcmVuZGVyOmZ1bmN0aW9uKHQsZSl7dC5iZWdpblBhdGgoKSx0LnNhdmUoKSx0LnRyYW5zZm9ybSgxLDAsMCx0aGlzLnJ5L3RoaXMucngsMCwwKSx0LmFyYyhlP3RoaXMubGVmdCt0aGlzLnJ4OjAsZT8odGhpcy50b3ArdGhpcy5yeSkqdGhpcy5yeC90aGlzLnJ5OjAsdGhpcy5yeCwwLGksITEpLHQucmVzdG9yZSgpLHRoaXMuX3JlbmRlckZpbGwodCksdGhpcy5fcmVuZGVyU3Ryb2tlKHQpfSxjb21wbGV4aXR5OmZ1bmN0aW9uKCl7cmV0dXJuIDF9fSksZS5FbGxpcHNlLkFUVFJJQlVURV9OQU1FUz1lLlNIQVJFRF9BVFRSSUJVVEVTLmNvbmNhdChcImN4IGN5IHJ4IHJ5XCIuc3BsaXQoXCIgXCIpKSxlLkVsbGlwc2UuZnJvbUVsZW1lbnQ9ZnVuY3Rpb24odCxpKXtpfHwoaT17fSk7dmFyIHM9ZS5wYXJzZUF0dHJpYnV0ZXModCxlLkVsbGlwc2UuQVRUUklCVVRFX05BTUVTKTtzLmxlZnQ9cy5sZWZ0fHwwLHMudG9wPXMudG9wfHwwO3ZhciBuPW5ldyBlLkVsbGlwc2UocihzLGkpKTtyZXR1cm4gbi50b3AtPW4ucnksbi5sZWZ0LT1uLnJ4LG59LHZvaWQoZS5FbGxpcHNlLmZyb21PYmplY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlLkVsbGlwc2UodCl9KSl9KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSksaT1lLnV0aWwub2JqZWN0LmV4dGVuZDtpZihlLlJlY3QpcmV0dXJuIHZvaWQgY29uc29sZS53YXJuKFwiZmFicmljLlJlY3QgaXMgYWxyZWFkeSBkZWZpbmVkXCIpO3ZhciByPWUuT2JqZWN0LnByb3RvdHlwZS5zdGF0ZVByb3BlcnRpZXMuY29uY2F0KCk7ci5wdXNoKFwicnhcIixcInJ5XCIsXCJ4XCIsXCJ5XCIpLGUuUmVjdD1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5PYmplY3Qse3N0YXRlUHJvcGVydGllczpyLHR5cGU6XCJyZWN0XCIscng6MCxyeTowLHN0cm9rZURhc2hBcnJheTpudWxsLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dD10fHx7fSx0aGlzLmNhbGxTdXBlcihcImluaXRpYWxpemVcIix0KSx0aGlzLl9pbml0UnhSeSgpfSxfaW5pdFJ4Unk6ZnVuY3Rpb24oKXt0aGlzLnJ4JiYhdGhpcy5yeT90aGlzLnJ5PXRoaXMucng6dGhpcy5yeSYmIXRoaXMucngmJih0aGlzLnJ4PXRoaXMucnkpfSxfcmVuZGVyOmZ1bmN0aW9uKHQsZSl7aWYoMT09PXRoaXMud2lkdGgmJjE9PT10aGlzLmhlaWdodClyZXR1cm4gdm9pZCB0LmZpbGxSZWN0KDAsMCwxLDEpO3ZhciBpPXRoaXMucng/TWF0aC5taW4odGhpcy5yeCx0aGlzLndpZHRoLzIpOjAscj10aGlzLnJ5P01hdGgubWluKHRoaXMucnksdGhpcy5oZWlnaHQvMik6MCxzPXRoaXMud2lkdGgsbj10aGlzLmhlaWdodCxvPWU/dGhpcy5sZWZ0Oi10aGlzLndpZHRoLzIsYT1lP3RoaXMudG9wOi10aGlzLmhlaWdodC8yLGg9MCE9PWl8fDAhPT1yLGM9LjQ0NzcxNTI1MDI7dC5iZWdpblBhdGgoKSx0Lm1vdmVUbyhvK2ksYSksdC5saW5lVG8obytzLWksYSksaCYmdC5iZXppZXJDdXJ2ZVRvKG8rcy1jKmksYSxvK3MsYStjKnIsbytzLGErciksdC5saW5lVG8obytzLGErbi1yKSxoJiZ0LmJlemllckN1cnZlVG8obytzLGErbi1jKnIsbytzLWMqaSxhK24sbytzLWksYStuKSx0LmxpbmVUbyhvK2ksYStuKSxoJiZ0LmJlemllckN1cnZlVG8obytjKmksYStuLG8sYStuLWMqcixvLGErbi1yKSx0LmxpbmVUbyhvLGErciksaCYmdC5iZXppZXJDdXJ2ZVRvKG8sYStjKnIsbytjKmksYSxvK2ksYSksdC5jbG9zZVBhdGgoKSx0aGlzLl9yZW5kZXJGaWxsKHQpLHRoaXMuX3JlbmRlclN0cm9rZSh0KX0sX3JlbmRlckRhc2hlZFN0cm9rZTpmdW5jdGlvbih0KXt2YXIgaT0tdGhpcy53aWR0aC8yLHI9LXRoaXMuaGVpZ2h0LzIscz10aGlzLndpZHRoLG49dGhpcy5oZWlnaHQ7dC5iZWdpblBhdGgoKSxlLnV0aWwuZHJhd0Rhc2hlZExpbmUodCxpLHIsaStzLHIsdGhpcy5zdHJva2VEYXNoQXJyYXkpLGUudXRpbC5kcmF3RGFzaGVkTGluZSh0LGkrcyxyLGkrcyxyK24sdGhpcy5zdHJva2VEYXNoQXJyYXkpLGUudXRpbC5kcmF3RGFzaGVkTGluZSh0LGkrcyxyK24saSxyK24sdGhpcy5zdHJva2VEYXNoQXJyYXkpLGUudXRpbC5kcmF3RGFzaGVkTGluZSh0LGkscituLGkscix0aGlzLnN0cm9rZURhc2hBcnJheSksdC5jbG9zZVBhdGgoKX0sdG9PYmplY3Q6ZnVuY3Rpb24odCl7dmFyIGU9aSh0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIsdCkse3J4OnRoaXMuZ2V0KFwicnhcIil8fDAscnk6dGhpcy5nZXQoXCJyeVwiKXx8MH0pO3JldHVybiB0aGlzLmluY2x1ZGVEZWZhdWx0VmFsdWVzfHx0aGlzLl9yZW1vdmVEZWZhdWx0VmFsdWVzKGUpLGV9LHRvU1ZHOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX2NyZWF0ZUJhc2VTVkdNYXJrdXAoKSxpPXRoaXMubGVmdCxyPXRoaXMudG9wO3JldHVybiB0aGlzLmdyb3VwJiZcInBhdGgtZ3JvdXBcIj09PXRoaXMuZ3JvdXAudHlwZXx8KGk9LXRoaXMud2lkdGgvMixyPS10aGlzLmhlaWdodC8yKSxlLnB1c2goXCI8cmVjdCBcIiwneD1cIicsaSwnXCIgeT1cIicsciwnXCIgcng9XCInLHRoaXMuZ2V0KFwicnhcIiksJ1wiIHJ5PVwiJyx0aGlzLmdldChcInJ5XCIpLCdcIiB3aWR0aD1cIicsdGhpcy53aWR0aCwnXCIgaGVpZ2h0PVwiJyx0aGlzLmhlaWdodCwnXCIgc3R5bGU9XCInLHRoaXMuZ2V0U3ZnU3R5bGVzKCksJ1wiIHRyYW5zZm9ybT1cIicsdGhpcy5nZXRTdmdUcmFuc2Zvcm0oKSx0aGlzLmdldFN2Z1RyYW5zZm9ybU1hdHJpeCgpLCdcIi8+XFxuJyksdD90KGUuam9pbihcIlwiKSk6ZS5qb2luKFwiXCIpfSxjb21wbGV4aXR5OmZ1bmN0aW9uKCl7cmV0dXJuIDF9fSksZS5SZWN0LkFUVFJJQlVURV9OQU1FUz1lLlNIQVJFRF9BVFRSSUJVVEVTLmNvbmNhdChcInggeSByeCByeSB3aWR0aCBoZWlnaHRcIi5zcGxpdChcIiBcIikpLGUuUmVjdC5mcm9tRWxlbWVudD1mdW5jdGlvbih0LHIpe2lmKCF0KXJldHVybiBudWxsO3I9cnx8e307dmFyIHM9ZS5wYXJzZUF0dHJpYnV0ZXModCxlLlJlY3QuQVRUUklCVVRFX05BTUVTKTtzLmxlZnQ9cy5sZWZ0fHwwLHMudG9wPXMudG9wfHwwO3ZhciBuPW5ldyBlLlJlY3QoaShyP2UudXRpbC5vYmplY3QuY2xvbmUocik6e30scykpO3JldHVybiBuLnZpc2libGU9bi53aWR0aD4wJiZuLmhlaWdodD4wLG59LGUuUmVjdC5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5SZWN0KHQpfX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KTtyZXR1cm4gZS5Qb2x5bGluZT92b2lkIGUud2FybihcImZhYnJpYy5Qb2x5bGluZSBpcyBhbHJlYWR5IGRlZmluZWRcIik6KGUuUG9seWxpbmU9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuT2JqZWN0LHt0eXBlOlwicG9seWxpbmVcIixwb2ludHM6bnVsbCxtaW5YOjAsbWluWTowLGluaXRpYWxpemU6ZnVuY3Rpb24odCxpKXtyZXR1cm4gZS5Qb2x5Z29uLnByb3RvdHlwZS5pbml0aWFsaXplLmNhbGwodGhpcyx0LGkpfSxfY2FsY0RpbWVuc2lvbnM6ZnVuY3Rpb24oKXtyZXR1cm4gZS5Qb2x5Z29uLnByb3RvdHlwZS5fY2FsY0RpbWVuc2lvbnMuY2FsbCh0aGlzKX0sX2FwcGx5UG9pbnRPZmZzZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZS5Qb2x5Z29uLnByb3RvdHlwZS5fYXBwbHlQb2ludE9mZnNldC5jYWxsKHRoaXMpfSx0b09iamVjdDpmdW5jdGlvbih0KXtyZXR1cm4gZS5Qb2x5Z29uLnByb3RvdHlwZS50b09iamVjdC5jYWxsKHRoaXMsdCl9LHRvU1ZHOmZ1bmN0aW9uKHQpe3JldHVybiBlLlBvbHlnb24ucHJvdG90eXBlLnRvU1ZHLmNhbGwodGhpcyx0KX0sX3JlbmRlcjpmdW5jdGlvbih0KXtlLlBvbHlnb24ucHJvdG90eXBlLmNvbW1vblJlbmRlci5jYWxsKHRoaXMsdCkmJih0aGlzLl9yZW5kZXJGaWxsKHQpLHRoaXMuX3JlbmRlclN0cm9rZSh0KSl9LF9yZW5kZXJEYXNoZWRTdHJva2U6ZnVuY3Rpb24odCl7dmFyIGkscjt0LmJlZ2luUGF0aCgpO2Zvcih2YXIgcz0wLG49dGhpcy5wb2ludHMubGVuZ3RoO24+cztzKyspaT10aGlzLnBvaW50c1tzXSxyPXRoaXMucG9pbnRzW3MrMV18fGksZS51dGlsLmRyYXdEYXNoZWRMaW5lKHQsaS54LGkueSxyLngsci55LHRoaXMuc3Ryb2tlRGFzaEFycmF5KX0sY29tcGxleGl0eTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldChcInBvaW50c1wiKS5sZW5ndGh9fSksZS5Qb2x5bGluZS5BVFRSSUJVVEVfTkFNRVM9ZS5TSEFSRURfQVRUUklCVVRFUy5jb25jYXQoKSxlLlBvbHlsaW5lLmZyb21FbGVtZW50PWZ1bmN0aW9uKHQsaSl7aWYoIXQpcmV0dXJuIG51bGw7aXx8KGk9e30pO3ZhciByPWUucGFyc2VQb2ludHNBdHRyaWJ1dGUodC5nZXRBdHRyaWJ1dGUoXCJwb2ludHNcIikpLHM9ZS5wYXJzZUF0dHJpYnV0ZXModCxlLlBvbHlsaW5lLkFUVFJJQlVURV9OQU1FUyk7cmV0dXJuIG5ldyBlLlBvbHlsaW5lKHIsZS51dGlsLm9iamVjdC5leHRlbmQocyxpKSl9LHZvaWQoZS5Qb2x5bGluZS5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3ZhciBpPXQucG9pbnRzO3JldHVybiBuZXcgZS5Qb2x5bGluZShpLHQsITApfSkpfShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPXQuZmFicmljfHwodC5mYWJyaWM9e30pLGk9ZS51dGlsLm9iamVjdC5leHRlbmQscj1lLnV0aWwuYXJyYXkubWluLHM9ZS51dGlsLmFycmF5Lm1heCxuPWUudXRpbC50b0ZpeGVkO3JldHVybiBlLlBvbHlnb24/dm9pZCBlLndhcm4oXCJmYWJyaWMuUG9seWdvbiBpcyBhbHJlYWR5IGRlZmluZWRcIik6KGUuUG9seWdvbj1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5PYmplY3Qse3R5cGU6XCJwb2x5Z29uXCIscG9pbnRzOm51bGwsbWluWDowLG1pblk6MCxpbml0aWFsaXplOmZ1bmN0aW9uKHQsZSl7ZT1lfHx7fSx0aGlzLnBvaW50cz10fHxbXSx0aGlzLmNhbGxTdXBlcihcImluaXRpYWxpemVcIixlKSx0aGlzLl9jYWxjRGltZW5zaW9ucygpLFwidG9wXCJpbiBlfHwodGhpcy50b3A9dGhpcy5taW5ZKSxcImxlZnRcImluIGV8fCh0aGlzLmxlZnQ9dGhpcy5taW5YKX0sX2NhbGNEaW1lbnNpb25zOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5wb2ludHMsZT1yKHQsXCJ4XCIpLGk9cih0LFwieVwiKSxuPXModCxcInhcIiksbz1zKHQsXCJ5XCIpO3RoaXMud2lkdGg9bi1lfHwwLHRoaXMuaGVpZ2h0PW8taXx8MCx0aGlzLm1pblg9ZXx8MCx0aGlzLm1pblk9aXx8MH0sX2FwcGx5UG9pbnRPZmZzZXQ6ZnVuY3Rpb24oKXt0aGlzLnBvaW50cy5mb3JFYWNoKGZ1bmN0aW9uKHQpe3QueC09dGhpcy5taW5YK3RoaXMud2lkdGgvMix0LnktPXRoaXMubWluWSt0aGlzLmhlaWdodC8yfSx0aGlzKX0sdG9PYmplY3Q6ZnVuY3Rpb24odCl7cmV0dXJuIGkodGhpcy5jYWxsU3VwZXIoXCJ0b09iamVjdFwiLHQpLHtwb2ludHM6dGhpcy5wb2ludHMuY29uY2F0KCl9KX0sdG9TVkc6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPVtdLGk9dGhpcy5fY3JlYXRlQmFzZVNWR01hcmt1cCgpLHI9MCxzPXRoaXMucG9pbnRzLmxlbmd0aDtzPnI7cisrKWUucHVzaChuKHRoaXMucG9pbnRzW3JdLngsMiksXCIsXCIsbih0aGlzLnBvaW50c1tyXS55LDIpLFwiIFwiKTtyZXR1cm4gaS5wdXNoKFwiPFwiLHRoaXMudHlwZSxcIiBcIiwncG9pbnRzPVwiJyxlLmpvaW4oXCJcIiksJ1wiIHN0eWxlPVwiJyx0aGlzLmdldFN2Z1N0eWxlcygpLCdcIiB0cmFuc2Zvcm09XCInLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtKCksXCIgXCIsdGhpcy5nZXRTdmdUcmFuc2Zvcm1NYXRyaXgoKSwnXCIvPlxcbicpLHQ/dChpLmpvaW4oXCJcIikpOmkuam9pbihcIlwiKX0sX3JlbmRlcjpmdW5jdGlvbih0KXt0aGlzLmNvbW1vblJlbmRlcih0KSYmKHRoaXMuX3JlbmRlckZpbGwodCksKHRoaXMuc3Ryb2tlfHx0aGlzLnN0cm9rZURhc2hBcnJheSkmJih0LmNsb3NlUGF0aCgpLHRoaXMuX3JlbmRlclN0cm9rZSh0KSkpfSxjb21tb25SZW5kZXI6ZnVuY3Rpb24odCl7dmFyIGUsaT10aGlzLnBvaW50cy5sZW5ndGg7aWYoIWl8fGlzTmFOKHRoaXMucG9pbnRzW2ktMV0ueSkpcmV0dXJuITE7dC5iZWdpblBhdGgoKSx0aGlzLl9hcHBseVBvaW50T2Zmc2V0JiYodGhpcy5ncm91cCYmXCJwYXRoLWdyb3VwXCI9PT10aGlzLmdyb3VwLnR5cGV8fHRoaXMuX2FwcGx5UG9pbnRPZmZzZXQoKSx0aGlzLl9hcHBseVBvaW50T2Zmc2V0PW51bGwpLHQubW92ZVRvKHRoaXMucG9pbnRzWzBdLngsdGhpcy5wb2ludHNbMF0ueSk7Zm9yKHZhciByPTA7aT5yO3IrKyllPXRoaXMucG9pbnRzW3JdLHQubGluZVRvKGUueCxlLnkpO3JldHVybiEwfSxfcmVuZGVyRGFzaGVkU3Ryb2tlOmZ1bmN0aW9uKHQpe2UuUG9seWxpbmUucHJvdG90eXBlLl9yZW5kZXJEYXNoZWRTdHJva2UuY2FsbCh0aGlzLHQpLHQuY2xvc2VQYXRoKCl9LGNvbXBsZXhpdHk6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wb2ludHMubGVuZ3RofX0pLGUuUG9seWdvbi5BVFRSSUJVVEVfTkFNRVM9ZS5TSEFSRURfQVRUUklCVVRFUy5jb25jYXQoKSxlLlBvbHlnb24uZnJvbUVsZW1lbnQ9ZnVuY3Rpb24odCxyKXtpZighdClyZXR1cm4gbnVsbDtyfHwocj17fSk7dmFyIHM9ZS5wYXJzZVBvaW50c0F0dHJpYnV0ZSh0LmdldEF0dHJpYnV0ZShcInBvaW50c1wiKSksbj1lLnBhcnNlQXR0cmlidXRlcyh0LGUuUG9seWdvbi5BVFRSSUJVVEVfTkFNRVMpO3JldHVybiBuZXcgZS5Qb2x5Z29uKHMsaShuLHIpKX0sdm9pZChlLlBvbHlnb24uZnJvbU9iamVjdD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUuUG9seWdvbih0LnBvaW50cyx0LCEwKX0pKX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPWUudXRpbC5hcnJheS5taW4scj1lLnV0aWwuYXJyYXkubWF4LHM9ZS51dGlsLm9iamVjdC5leHRlbmQsbj1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLG89ZS51dGlsLmRyYXdBcmMsYT17bToyLGw6MixoOjEsdjoxLGM6NixzOjQscTo0LHQ6MixhOjd9LGg9e206XCJsXCIsTTpcIkxcIn07cmV0dXJuIGUuUGF0aD92b2lkIGUud2FybihcImZhYnJpYy5QYXRoIGlzIGFscmVhZHkgZGVmaW5lZFwiKTooZS5QYXRoPWUudXRpbC5jcmVhdGVDbGFzcyhlLk9iamVjdCx7dHlwZTpcInBhdGhcIixwYXRoOm51bGwsbWluWDowLG1pblk6MCxpbml0aWFsaXplOmZ1bmN0aW9uKHQsZSl7aWYoZT1lfHx7fSx0aGlzLnNldE9wdGlvbnMoZSksIXQpdGhyb3cgbmV3IEVycm9yKFwiYHBhdGhgIGFyZ3VtZW50IGlzIHJlcXVpcmVkXCIpO3ZhciBpPVwiW29iamVjdCBBcnJheV1cIj09PW4uY2FsbCh0KTt0aGlzLnBhdGg9aT90OnQubWF0Y2gmJnQubWF0Y2goL1ttemxodmNzcXRhXVtebXpsaHZjc3F0YV0qL2dpKSx0aGlzLnBhdGgmJihpfHwodGhpcy5wYXRoPXRoaXMuX3BhcnNlUGF0aCgpKSx0aGlzLl9zZXRQb3NpdGlvbkRpbWVuc2lvbnMoZSksZS5zb3VyY2VQYXRoJiZ0aGlzLnNldFNvdXJjZVBhdGgoZS5zb3VyY2VQYXRoKSl9LF9zZXRQb3NpdGlvbkRpbWVuc2lvbnM6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fcGFyc2VEaW1lbnNpb25zKCk7dGhpcy5taW5YPWUubGVmdCx0aGlzLm1pblk9ZS50b3AsdGhpcy53aWR0aD1lLndpZHRoLHRoaXMuaGVpZ2h0PWUuaGVpZ2h0LFwidW5kZWZpbmVkXCI9PXR5cGVvZiB0LmxlZnQmJih0aGlzLmxlZnQ9ZS5sZWZ0KyhcImNlbnRlclwiPT09dGhpcy5vcmlnaW5YP3RoaXMud2lkdGgvMjpcInJpZ2h0XCI9PT10aGlzLm9yaWdpblg/dGhpcy53aWR0aDowKSksXCJ1bmRlZmluZWRcIj09dHlwZW9mIHQudG9wJiYodGhpcy50b3A9ZS50b3ArKFwiY2VudGVyXCI9PT10aGlzLm9yaWdpblk/dGhpcy5oZWlnaHQvMjpcImJvdHRvbVwiPT09dGhpcy5vcmlnaW5ZP3RoaXMuaGVpZ2h0OjApKSx0aGlzLnBhdGhPZmZzZXQ9dGhpcy5wYXRoT2Zmc2V0fHx7eDp0aGlzLm1pblgrdGhpcy53aWR0aC8yLHk6dGhpcy5taW5ZK3RoaXMuaGVpZ2h0LzJ9fSxfcmVuZGVyOmZ1bmN0aW9uKHQpe3ZhciBlLGkscixzPW51bGwsbj0wLGE9MCxoPTAsYz0wLGw9MCx1PTAsZj0tdGhpcy5wYXRoT2Zmc2V0LngsZD0tdGhpcy5wYXRoT2Zmc2V0Lnk7dGhpcy5ncm91cCYmXCJwYXRoLWdyb3VwXCI9PT10aGlzLmdyb3VwLnR5cGUmJihmPTAsZD0wKSx0LmJlZ2luUGF0aCgpO2Zvcih2YXIgZz0wLHA9dGhpcy5wYXRoLmxlbmd0aDtwPmc7KytnKXtzd2l0Y2goZT10aGlzLnBhdGhbZ10sZVswXSl7Y2FzZVwibFwiOmgrPWVbMV0sYys9ZVsyXSx0LmxpbmVUbyhoK2YsYytkKTticmVhaztjYXNlXCJMXCI6aD1lWzFdLGM9ZVsyXSx0LmxpbmVUbyhoK2YsYytkKTticmVhaztjYXNlXCJoXCI6aCs9ZVsxXSx0LmxpbmVUbyhoK2YsYytkKTticmVhaztjYXNlXCJIXCI6aD1lWzFdLHQubGluZVRvKGgrZixjK2QpO2JyZWFrO2Nhc2VcInZcIjpjKz1lWzFdLHQubGluZVRvKGgrZixjK2QpO2JyZWFrO2Nhc2VcIlZcIjpjPWVbMV0sdC5saW5lVG8oaCtmLGMrZCk7YnJlYWs7Y2FzZVwibVwiOmgrPWVbMV0sYys9ZVsyXSxuPWgsYT1jLHQubW92ZVRvKGgrZixjK2QpO2JyZWFrO2Nhc2VcIk1cIjpoPWVbMV0sYz1lWzJdLG49aCxhPWMsdC5tb3ZlVG8oaCtmLGMrZCk7YnJlYWs7Y2FzZVwiY1wiOmk9aCtlWzVdLHI9YytlWzZdLGw9aCtlWzNdLHU9YytlWzRdLHQuYmV6aWVyQ3VydmVUbyhoK2VbMV0rZixjK2VbMl0rZCxsK2YsdStkLGkrZixyK2QpLGg9aSxjPXI7YnJlYWs7Y2FzZVwiQ1wiOmg9ZVs1XSxjPWVbNl0sbD1lWzNdLHU9ZVs0XSx0LmJlemllckN1cnZlVG8oZVsxXStmLGVbMl0rZCxsK2YsdStkLGgrZixjK2QpO2JyZWFrO2Nhc2VcInNcIjppPWgrZVszXSxyPWMrZVs0XSxudWxsPT09c1swXS5tYXRjaCgvW0NjU3NdLyk/KGw9aCx1PWMpOihsPTIqaC1sLHU9MipjLXUpLHQuYmV6aWVyQ3VydmVUbyhsK2YsdStkLGgrZVsxXStmLGMrZVsyXStkLGkrZixyK2QpLGw9aCtlWzFdLHU9YytlWzJdLGg9aSxjPXI7YnJlYWs7Y2FzZVwiU1wiOmk9ZVszXSxyPWVbNF0sbnVsbD09PXNbMF0ubWF0Y2goL1tDY1NzXS8pPyhsPWgsdT1jKToobD0yKmgtbCx1PTIqYy11KSx0LmJlemllckN1cnZlVG8obCtmLHUrZCxlWzFdK2YsZVsyXStkLGkrZixyK2QpLGg9aSxjPXIsbD1lWzFdLHU9ZVsyXTticmVhaztjYXNlXCJxXCI6aT1oK2VbM10scj1jK2VbNF0sbD1oK2VbMV0sdT1jK2VbMl0sdC5xdWFkcmF0aWNDdXJ2ZVRvKGwrZix1K2QsaStmLHIrZCksaD1pLGM9cjticmVhaztjYXNlXCJRXCI6aT1lWzNdLHI9ZVs0XSx0LnF1YWRyYXRpY0N1cnZlVG8oZVsxXStmLGVbMl0rZCxpK2YscitkKSxoPWksYz1yLGw9ZVsxXSx1PWVbMl07YnJlYWs7Y2FzZVwidFwiOmk9aCtlWzFdLHI9YytlWzJdLG51bGw9PT1zWzBdLm1hdGNoKC9bUXFUdF0vKT8obD1oLHU9Yyk6KGw9MipoLWwsdT0yKmMtdSksdC5xdWFkcmF0aWNDdXJ2ZVRvKGwrZix1K2QsaStmLHIrZCksaD1pLGM9cjticmVhaztjYXNlXCJUXCI6aT1lWzFdLHI9ZVsyXSxudWxsPT09c1swXS5tYXRjaCgvW1FxVHRdLyk/KGw9aCx1PWMpOihsPTIqaC1sLHU9MipjLXUpLHQucXVhZHJhdGljQ3VydmVUbyhsK2YsdStkLGkrZixyK2QpLGg9aSxjPXI7YnJlYWs7Y2FzZVwiYVwiOm8odCxoK2YsYytkLFtlWzFdLGVbMl0sZVszXSxlWzRdLGVbNV0sZVs2XStoK2YsZVs3XStjK2RdKSxoKz1lWzZdLGMrPWVbN107YnJlYWs7Y2FzZVwiQVwiOm8odCxoK2YsYytkLFtlWzFdLGVbMl0sZVszXSxlWzRdLGVbNV0sZVs2XStmLGVbN10rZF0pLGg9ZVs2XSxjPWVbN107YnJlYWs7Y2FzZVwielwiOmNhc2VcIlpcIjpoPW4sYz1hLHQuY2xvc2VQYXRoKCl9cz1lfXRoaXMuX3JlbmRlckZpbGwodCksdGhpcy5fcmVuZGVyU3Ryb2tlKHQpfSx0b1N0cmluZzpmdW5jdGlvbigpe3JldHVyblwiIzxmYWJyaWMuUGF0aCAoXCIrdGhpcy5jb21wbGV4aXR5KCkrJyk6IHsgXCJ0b3BcIjogJyt0aGlzLnRvcCsnLCBcImxlZnRcIjogJyt0aGlzLmxlZnQrXCIgfT5cIn0sdG9PYmplY3Q6ZnVuY3Rpb24odCl7dmFyIGU9cyh0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIsdCkse3BhdGg6dGhpcy5wYXRoLm1hcChmdW5jdGlvbih0KXtyZXR1cm4gdC5zbGljZSgpfSkscGF0aE9mZnNldDp0aGlzLnBhdGhPZmZzZXR9KTtyZXR1cm4gdGhpcy5zb3VyY2VQYXRoJiYoZS5zb3VyY2VQYXRoPXRoaXMuc291cmNlUGF0aCksdGhpcy50cmFuc2Zvcm1NYXRyaXgmJihlLnRyYW5zZm9ybU1hdHJpeD10aGlzLnRyYW5zZm9ybU1hdHJpeCksZX0sdG9EYXRhbGVzc09iamVjdDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLnRvT2JqZWN0KHQpO3JldHVybiB0aGlzLnNvdXJjZVBhdGgmJihlLnBhdGg9dGhpcy5zb3VyY2VQYXRoKSxkZWxldGUgZS5zb3VyY2VQYXRoLGV9LHRvU1ZHOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT1bXSxpPXRoaXMuX2NyZWF0ZUJhc2VTVkdNYXJrdXAoKSxyPVwiXCIscz0wLG49dGhpcy5wYXRoLmxlbmd0aDtuPnM7cysrKWUucHVzaCh0aGlzLnBhdGhbc10uam9pbihcIiBcIikpO3ZhciBvPWUuam9pbihcIiBcIik7cmV0dXJuIHRoaXMuZ3JvdXAmJlwicGF0aC1ncm91cFwiPT09dGhpcy5ncm91cC50eXBlfHwocj1cIiB0cmFuc2xhdGUoXCIrLXRoaXMucGF0aE9mZnNldC54K1wiLCBcIistdGhpcy5wYXRoT2Zmc2V0LnkrXCIpIFwiKSxpLnB1c2goXCI8cGF0aCBcIiwnZD1cIicsbywnXCIgc3R5bGU9XCInLHRoaXMuZ2V0U3ZnU3R5bGVzKCksJ1wiIHRyYW5zZm9ybT1cIicsdGhpcy5nZXRTdmdUcmFuc2Zvcm0oKSxyLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtTWF0cml4KCksJ1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiAnLFwiLz5cXG5cIiksdD90KGkuam9pbihcIlwiKSk6aS5qb2luKFwiXCIpfSxjb21wbGV4aXR5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGF0aC5sZW5ndGh9LF9wYXJzZVBhdGg6ZnVuY3Rpb24oKXtmb3IodmFyIHQsZSxpLHIscyxuPVtdLG89W10sYz0vKFstK10/KChcXGQrXFwuXFxkKyl8KChcXGQrKXwoXFwuXFxkKykpKSg/OmVbLStdP1xcZCspPykvZ2ksbD0wLHU9dGhpcy5wYXRoLmxlbmd0aDt1Pmw7bCsrKXtmb3IodD10aGlzLnBhdGhbbF0scj10LnNsaWNlKDEpLnRyaW0oKSxvLmxlbmd0aD0wO2k9Yy5leGVjKHIpOylvLnB1c2goaVswXSk7cz1bdC5jaGFyQXQoMCldO2Zvcih2YXIgZj0wLGQ9by5sZW5ndGg7ZD5mO2YrKyllPXBhcnNlRmxvYXQob1tmXSksaXNOYU4oZSl8fHMucHVzaChlKTt2YXIgZz1zWzBdLHA9YVtnLnRvTG93ZXJDYXNlKCldLHY9aFtnXXx8ZztpZihzLmxlbmd0aC0xPnApZm9yKHZhciBiPTEsbT1zLmxlbmd0aDttPmI7Yis9cCluLnB1c2goW2ddLmNvbmNhdChzLnNsaWNlKGIsYitwKSkpLGc9djtlbHNlIG4ucHVzaChzKX1yZXR1cm4gbn0sX3BhcnNlRGltZW5zaW9uczpmdW5jdGlvbigpe2Zvcih2YXIgdCxzLG4sbyxhPVtdLGg9W10sYz1udWxsLGw9MCx1PTAsZj0wLGQ9MCxnPTAscD0wLHY9MCxiPXRoaXMucGF0aC5sZW5ndGg7Yj52Oysrdil7c3dpdGNoKHQ9dGhpcy5wYXRoW3ZdLHRbMF0pe2Nhc2VcImxcIjpmKz10WzFdLGQrPXRbMl0sbz1bXTticmVhaztjYXNlXCJMXCI6Zj10WzFdLGQ9dFsyXSxvPVtdO2JyZWFrO2Nhc2VcImhcIjpmKz10WzFdLG89W107YnJlYWs7Y2FzZVwiSFwiOmY9dFsxXSxvPVtdO2JyZWFrO2Nhc2VcInZcIjpkKz10WzFdLG89W107YnJlYWs7Y2FzZVwiVlwiOmQ9dFsxXSxvPVtdO2JyZWFrO2Nhc2VcIm1cIjpmKz10WzFdLGQrPXRbMl0sbD1mLHU9ZCxvPVtdO2JyZWFrO2Nhc2VcIk1cIjpmPXRbMV0sZD10WzJdLGw9Zix1PWQsbz1bXTticmVhaztjYXNlXCJjXCI6cz1mK3RbNV0sbj1kK3RbNl0sZz1mK3RbM10scD1kK3RbNF0sbz1lLnV0aWwuZ2V0Qm91bmRzT2ZDdXJ2ZShmLGQsZit0WzFdLGQrdFsyXSxnLHAscyxuKSxmPXMsZD1uO2JyZWFrO2Nhc2VcIkNcIjpmPXRbNV0sZD10WzZdLGc9dFszXSxwPXRbNF0sbz1lLnV0aWwuZ2V0Qm91bmRzT2ZDdXJ2ZShmLGQsdFsxXSx0WzJdLGcscCxmLGQpO2JyZWFrO2Nhc2VcInNcIjpzPWYrdFszXSxuPWQrdFs0XSxudWxsPT09Y1swXS5tYXRjaCgvW0NjU3NdLyk/KGc9ZixwPWQpOihnPTIqZi1nLHA9MipkLXApLG89ZS51dGlsLmdldEJvdW5kc09mQ3VydmUoZixkLGcscCxmK3RbMV0sZCt0WzJdLHMsbiksZz1mK3RbMV0scD1kK3RbMl0sZj1zLGQ9bjticmVhaztjYXNlXCJTXCI6cz10WzNdLG49dFs0XSxudWxsPT09Y1swXS5tYXRjaCgvW0NjU3NdLyk/KGc9ZixwPWQpOihnPTIqZi1nLHA9MipkLXApLG89ZS51dGlsLmdldEJvdW5kc09mQ3VydmUoZixkLGcscCx0WzFdLHRbMl0scyxuKSxmPXMsZD1uLGc9dFsxXSxwPXRbMl07YnJlYWs7Y2FzZVwicVwiOnM9Zit0WzNdLG49ZCt0WzRdLGc9Zit0WzFdLHA9ZCt0WzJdLG89ZS51dGlsLmdldEJvdW5kc09mQ3VydmUoZixkLGcscCxnLHAscyxuKSxmPXMsZD1uO2JyZWFrO2Nhc2VcIlFcIjpnPXRbMV0scD10WzJdLG89ZS51dGlsLmdldEJvdW5kc09mQ3VydmUoZixkLGcscCxnLHAsdFszXSx0WzRdKSxmPXRbM10sZD10WzRdO2JyZWFrO2Nhc2VcInRcIjpzPWYrdFsxXSxuPWQrdFsyXSxudWxsPT09Y1swXS5tYXRjaCgvW1FxVHRdLyk/KGc9ZixwPWQpOihnPTIqZi1nLHA9MipkLXApLG89ZS51dGlsLmdldEJvdW5kc09mQ3VydmUoZixkLGcscCxnLHAscyxuKSxmPXMsZD1uO2JyZWFrO2Nhc2VcIlRcIjpzPXRbMV0sbj10WzJdLG51bGw9PT1jWzBdLm1hdGNoKC9bUXFUdF0vKT8oZz1mLHA9ZCk6KGc9MipmLWcscD0yKmQtcCksbz1lLnV0aWwuZ2V0Qm91bmRzT2ZDdXJ2ZShmLGQsZyxwLGcscCxzLG4pLGY9cyxkPW47YnJlYWs7Y2FzZVwiYVwiOm89ZS51dGlsLmdldEJvdW5kc09mQXJjKGYsZCx0WzFdLHRbMl0sdFszXSx0WzRdLHRbNV0sdFs2XStmLHRbN10rZCksZis9dFs2XSxkKz10WzddO2JyZWFrO2Nhc2VcIkFcIjpvPWUudXRpbC5nZXRCb3VuZHNPZkFyYyhmLGQsdFsxXSx0WzJdLHRbM10sdFs0XSx0WzVdLHRbNl0sdFs3XSksZj10WzZdLGQ9dFs3XTticmVhaztjYXNlXCJ6XCI6Y2FzZVwiWlwiOmY9bCxkPXV9Yz10LG8uZm9yRWFjaChmdW5jdGlvbih0KXthLnB1c2godC54KSxoLnB1c2godC55KX0pLGEucHVzaChmKSxoLnB1c2goZCl9dmFyIG09aShhKSx5PWkoaCksXz1yKGEpLHg9cihoKSxDPV8tbSxTPXgteSx3PXtsZWZ0Om0sdG9wOnksd2lkdGg6QyxoZWlnaHQ6U307cmV0dXJuIHd9fSksZS5QYXRoLmZyb21PYmplY3Q9ZnVuY3Rpb24odCxpKXtcInN0cmluZ1wiPT10eXBlb2YgdC5wYXRoP2UubG9hZFNWR0Zyb21VUkwodC5wYXRoLGZ1bmN0aW9uKHIpe3ZhciBzPXJbMF0sbj10LnBhdGg7ZGVsZXRlIHQucGF0aCxlLnV0aWwub2JqZWN0LmV4dGVuZChzLHQpLHMuc2V0U291cmNlUGF0aChuKSxpKHMpfSk6aShuZXcgZS5QYXRoKHQucGF0aCx0KSl9LGUuUGF0aC5BVFRSSUJVVEVfTkFNRVM9ZS5TSEFSRURfQVRUUklCVVRFUy5jb25jYXQoW1wiZFwiXSksZS5QYXRoLmZyb21FbGVtZW50PWZ1bmN0aW9uKHQsaSxyKXt2YXIgbj1lLnBhcnNlQXR0cmlidXRlcyh0LGUuUGF0aC5BVFRSSUJVVEVfTkFNRVMpO2kmJmkobmV3IGUuUGF0aChuLmQscyhuLHIpKSl9LHZvaWQoZS5QYXRoLmFzeW5jPSEwKSl9KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSksaT1lLnV0aWwub2JqZWN0LmV4dGVuZCxyPWUudXRpbC5hcnJheS5pbnZva2Uscz1lLk9iamVjdC5wcm90b3R5cGUudG9PYmplY3Q7cmV0dXJuIGUuUGF0aEdyb3VwP3ZvaWQgZS53YXJuKFwiZmFicmljLlBhdGhHcm91cCBpcyBhbHJlYWR5IGRlZmluZWRcIik6KGUuUGF0aEdyb3VwPWUudXRpbC5jcmVhdGVDbGFzcyhlLlBhdGgse3R5cGU6XCJwYXRoLWdyb3VwXCIsZmlsbDpcIlwiLGluaXRpYWxpemU6ZnVuY3Rpb24odCxlKXtlPWV8fHt9LHRoaXMucGF0aHM9dHx8W107Zm9yKHZhciBpPXRoaXMucGF0aHMubGVuZ3RoO2ktLTspdGhpcy5wYXRoc1tpXS5ncm91cD10aGlzO2UudG9CZVBhcnNlZCYmKHRoaXMucGFyc2VEaW1lbnNpb25zRnJvbVBhdGhzKGUpLGRlbGV0ZSBlLnRvQmVQYXJzZWQpLHRoaXMuc2V0T3B0aW9ucyhlKSx0aGlzLnNldENvb3JkcygpLGUuc291cmNlUGF0aCYmdGhpcy5zZXRTb3VyY2VQYXRoKGUuc291cmNlUGF0aCl9LHBhcnNlRGltZW5zaW9uc0Zyb21QYXRoczpmdW5jdGlvbih0KXtmb3IodmFyIGkscixzLG4sbyxhPVtdLGg9W10sYz10aGlzLnRyYW5zZm9ybU1hdHJpeCxsPXRoaXMucGF0aHMubGVuZ3RoO2wtLTspe3M9dGhpcy5wYXRoc1tsXSxuPXMuaGVpZ2h0K3Muc3Ryb2tlV2lkdGgsbz1zLndpZHRoK3Muc3Ryb2tlV2lkdGgsaT1be3g6cy5sZWZ0LHk6cy50b3B9LHt4OnMubGVmdCtvLHk6cy50b3B9LHt4OnMubGVmdCx5OnMudG9wK259LHt4OnMubGVmdCtvLHk6cy50b3Arbn1dO2Zvcih2YXIgdT0wO3U8aS5sZW5ndGg7dSsrKXI9aVt1XSxjJiYocj1lLnV0aWwudHJhbnNmb3JtUG9pbnQocixjLCExKSksYS5wdXNoKHIueCksaC5wdXNoKHIueSl9dC53aWR0aD1NYXRoLm1heC5hcHBseShudWxsLGEpLHQuaGVpZ2h0PU1hdGgubWF4LmFwcGx5KG51bGwsaCl9LHJlbmRlcjpmdW5jdGlvbih0KXtpZih0aGlzLnZpc2libGUpe3Quc2F2ZSgpLHRoaXMudHJhbnNmb3JtTWF0cml4JiZ0LnRyYW5zZm9ybS5hcHBseSh0LHRoaXMudHJhbnNmb3JtTWF0cml4KSx0aGlzLnRyYW5zZm9ybSh0KSx0aGlzLl9zZXRTaGFkb3codCksdGhpcy5jbGlwVG8mJmUudXRpbC5jbGlwQ29udGV4dCh0aGlzLHQpLHQudHJhbnNsYXRlKC10aGlzLndpZHRoLzIsLXRoaXMuaGVpZ2h0LzIpO2Zvcih2YXIgaT0wLHI9dGhpcy5wYXRocy5sZW5ndGg7cj5pOysraSl0aGlzLnBhdGhzW2ldLnJlbmRlcih0LCEwKTt0aGlzLmNsaXBUbyYmdC5yZXN0b3JlKCksdC5yZXN0b3JlKCl9fSxfc2V0OmZ1bmN0aW9uKHQsZSl7aWYoXCJmaWxsXCI9PT10JiZlJiZ0aGlzLmlzU2FtZUNvbG9yKCkpZm9yKHZhciBpPXRoaXMucGF0aHMubGVuZ3RoO2ktLTspdGhpcy5wYXRoc1tpXS5fc2V0KHQsZSk7cmV0dXJuIHRoaXMuY2FsbFN1cGVyKFwiX3NldFwiLHQsZSl9LHRvT2JqZWN0OmZ1bmN0aW9uKHQpe3ZhciBlPWkocy5jYWxsKHRoaXMsdCkse3BhdGhzOnIodGhpcy5nZXRPYmplY3RzKCksXCJ0b09iamVjdFwiLHQpfSk7cmV0dXJuIHRoaXMuc291cmNlUGF0aCYmKGUuc291cmNlUGF0aD10aGlzLnNvdXJjZVBhdGgpLGV9LHRvRGF0YWxlc3NPYmplY3Q6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy50b09iamVjdCh0KTtyZXR1cm4gdGhpcy5zb3VyY2VQYXRoJiYoZS5wYXRocz10aGlzLnNvdXJjZVBhdGgpLGV9LHRvU1ZHOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10aGlzLmdldE9iamVjdHMoKSxpPXRoaXMuZ2V0UG9pbnRCeU9yaWdpbihcImxlZnRcIixcInRvcFwiKSxyPVwidHJhbnNsYXRlKFwiK2kueCtcIiBcIitpLnkrXCIpXCIscz1bXCI8ZyBcIiwnc3R5bGU9XCInLHRoaXMuZ2V0U3ZnU3R5bGVzKCksJ1wiICcsJ3RyYW5zZm9ybT1cIicsdGhpcy5nZXRTdmdUcmFuc2Zvcm1NYXRyaXgoKSxyLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtKCksJ1wiICcsXCI+XFxuXCJdLG49MCxvPWUubGVuZ3RoO28+bjtuKyspcy5wdXNoKGVbbl0udG9TVkcodCkpO3JldHVybiBzLnB1c2goXCI8L2c+XFxuXCIpLHQ/dChzLmpvaW4oXCJcIikpOnMuam9pbihcIlwiKX0sdG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm5cIiM8ZmFicmljLlBhdGhHcm91cCAoXCIrdGhpcy5jb21wbGV4aXR5KCkrXCIpOiB7IHRvcDogXCIrdGhpcy50b3ArXCIsIGxlZnQ6IFwiK3RoaXMubGVmdCtcIiB9PlwifSxpc1NhbWVDb2xvcjpmdW5jdGlvbigpe3ZhciB0PSh0aGlzLmdldE9iamVjdHMoKVswXS5nZXQoXCJmaWxsXCIpfHxcIlwiKS50b0xvd2VyQ2FzZSgpO3JldHVybiB0aGlzLmdldE9iamVjdHMoKS5ldmVyeShmdW5jdGlvbihlKXtyZXR1cm4oZS5nZXQoXCJmaWxsXCIpfHxcIlwiKS50b0xvd2VyQ2FzZSgpPT09dH0pfSxjb21wbGV4aXR5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGF0aHMucmVkdWNlKGZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQrKGUmJmUuY29tcGxleGl0eT9lLmNvbXBsZXhpdHkoKTowKX0sMCl9LGdldE9iamVjdHM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wYXRoc319KSxlLlBhdGhHcm91cC5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQsaSl7XCJzdHJpbmdcIj09dHlwZW9mIHQucGF0aHM/ZS5sb2FkU1ZHRnJvbVVSTCh0LnBhdGhzLGZ1bmN0aW9uKHIpe3ZhciBzPXQucGF0aHM7ZGVsZXRlIHQucGF0aHM7dmFyIG49ZS51dGlsLmdyb3VwU1ZHRWxlbWVudHMocix0LHMpO2kobil9KTplLnV0aWwuZW5saXZlbk9iamVjdHModC5wYXRocyxmdW5jdGlvbihyKXtkZWxldGUgdC5wYXRocyxpKG5ldyBlLlBhdGhHcm91cChyLHQpKX0pfSx2b2lkKGUuUGF0aEdyb3VwLmFzeW5jPSEwKSl9KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSksaT1lLnV0aWwub2JqZWN0LmV4dGVuZCxyPWUudXRpbC5hcnJheS5taW4scz1lLnV0aWwuYXJyYXkubWF4LG49ZS51dGlsLmFycmF5Lmludm9rZTtpZighZS5Hcm91cCl7dmFyIG89e2xvY2tNb3ZlbWVudFg6ITAsbG9ja01vdmVtZW50WTohMCxsb2NrUm90YXRpb246ITAsbG9ja1NjYWxpbmdYOiEwLGxvY2tTY2FsaW5nWTohMCxsb2NrVW5pU2NhbGluZzohMH07ZS5Hcm91cD1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5PYmplY3QsZS5Db2xsZWN0aW9uLHt0eXBlOlwiZ3JvdXBcIixzdHJva2VXaWR0aDowLGluaXRpYWxpemU6ZnVuY3Rpb24odCxlKXtlPWV8fHt9LHRoaXMuX29iamVjdHM9dHx8W107Zm9yKHZhciBpPXRoaXMuX29iamVjdHMubGVuZ3RoO2ktLTspdGhpcy5fb2JqZWN0c1tpXS5ncm91cD10aGlzO3RoaXMub3JpZ2luYWxTdGF0ZT17fSxlLm9yaWdpblgmJih0aGlzLm9yaWdpblg9ZS5vcmlnaW5YKSxlLm9yaWdpblkmJih0aGlzLm9yaWdpblk9ZS5vcmlnaW5ZKSx0aGlzLl9jYWxjQm91bmRzKCksdGhpcy5fdXBkYXRlT2JqZWN0c0Nvb3JkcygpLHRoaXMuY2FsbFN1cGVyKFwiaW5pdGlhbGl6ZVwiLGUpLHRoaXMuc2V0Q29vcmRzKCksdGhpcy5zYXZlQ29vcmRzKCl9LF91cGRhdGVPYmplY3RzQ29vcmRzOmZ1bmN0aW9uKCl7dGhpcy5mb3JFYWNoT2JqZWN0KHRoaXMuX3VwZGF0ZU9iamVjdENvb3Jkcyx0aGlzKX0sX3VwZGF0ZU9iamVjdENvb3JkczpmdW5jdGlvbih0KXt2YXIgZT10LmdldExlZnQoKSxpPXQuZ2V0VG9wKCkscj10aGlzLmdldENlbnRlclBvaW50KCk7dC5zZXQoe29yaWdpbmFsTGVmdDplLG9yaWdpbmFsVG9wOmksbGVmdDplLXIueCx0b3A6aS1yLnl9KSx0LnNldENvb3JkcygpLHQuX19vcmlnSGFzQ29udHJvbHM9dC5oYXNDb250cm9scyx0Lmhhc0NvbnRyb2xzPSExfSx0b1N0cmluZzpmdW5jdGlvbigpe3JldHVyblwiIzxmYWJyaWMuR3JvdXA6IChcIit0aGlzLmNvbXBsZXhpdHkoKStcIik+XCJ9LGFkZFdpdGhVcGRhdGU6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX3Jlc3RvcmVPYmplY3RzU3RhdGUoKSx0JiYodGhpcy5fb2JqZWN0cy5wdXNoKHQpLHQuZ3JvdXA9dGhpcyx0Ll9zZXQoXCJjYW52YXNcIix0aGlzLmNhbnZhcykpLHRoaXMuZm9yRWFjaE9iamVjdCh0aGlzLl9zZXRPYmplY3RBY3RpdmUsdGhpcyksdGhpcy5fY2FsY0JvdW5kcygpLHRoaXMuX3VwZGF0ZU9iamVjdHNDb29yZHMoKSx0aGlzfSxfc2V0T2JqZWN0QWN0aXZlOmZ1bmN0aW9uKHQpe3Quc2V0KFwiYWN0aXZlXCIsITApLHQuZ3JvdXA9dGhpc30scmVtb3ZlV2l0aFVwZGF0ZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fbW92ZUZsaXBwZWRPYmplY3QodCksdGhpcy5fcmVzdG9yZU9iamVjdHNTdGF0ZSgpLHRoaXMuZm9yRWFjaE9iamVjdCh0aGlzLl9zZXRPYmplY3RBY3RpdmUsdGhpcyksdGhpcy5yZW1vdmUodCksdGhpcy5fY2FsY0JvdW5kcygpLHRoaXMuX3VwZGF0ZU9iamVjdHNDb29yZHMoKSx0aGlzfSxfb25PYmplY3RBZGRlZDpmdW5jdGlvbih0KXt0Lmdyb3VwPXRoaXMsdC5fc2V0KFwiY2FudmFzXCIsdGhpcy5jYW52YXMpfSxfb25PYmplY3RSZW1vdmVkOmZ1bmN0aW9uKHQpe2RlbGV0ZSB0Lmdyb3VwLHQuc2V0KFwiYWN0aXZlXCIsITEpfSxkZWxlZ2F0ZWRQcm9wZXJ0aWVzOntmaWxsOiEwLG9wYWNpdHk6ITAsZm9udEZhbWlseTohMCxmb250V2VpZ2h0OiEwLGZvbnRTaXplOiEwLGZvbnRTdHlsZTohMCxsaW5lSGVpZ2h0OiEwLHRleHREZWNvcmF0aW9uOiEwLHRleHRBbGlnbjohMCxiYWNrZ3JvdW5kQ29sb3I6ITB9LF9zZXQ6ZnVuY3Rpb24odCxlKXtpZih0IGluIHRoaXMuZGVsZWdhdGVkUHJvcGVydGllc3x8XCJjYW52YXNcIj09PXQpZm9yKHZhciBpPXRoaXMuX29iamVjdHMubGVuZ3RoO2ktLTspdGhpcy5fb2JqZWN0c1tpXS5zZXQodCxlKTt0aGlzLmNhbGxTdXBlcihcIl9zZXRcIix0LGUpfSx0b09iamVjdDpmdW5jdGlvbih0KXtyZXR1cm4gaSh0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIsdCkse29iamVjdHM6bih0aGlzLl9vYmplY3RzLFwidG9PYmplY3RcIix0KX0pfSxyZW5kZXI6ZnVuY3Rpb24odCl7aWYodGhpcy52aXNpYmxlKXt0LnNhdmUoKSx0aGlzLnRyYW5zZm9ybU1hdHJpeCYmdC50cmFuc2Zvcm0uYXBwbHkodCx0aGlzLnRyYW5zZm9ybU1hdHJpeCksdGhpcy50cmFuc2Zvcm0odCksdGhpcy5jbGlwVG8mJmUudXRpbC5jbGlwQ29udGV4dCh0aGlzLHQpO2Zvcih2YXIgaT0wLHI9dGhpcy5fb2JqZWN0cy5sZW5ndGg7cj5pO2krKyl0aGlzLl9yZW5kZXJPYmplY3QodGhpcy5fb2JqZWN0c1tpXSx0KTt0aGlzLmNsaXBUbyYmdC5yZXN0b3JlKCksdC5yZXN0b3JlKCl9fSxfcmVuZGVyQ29udHJvbHM6ZnVuY3Rpb24odCxlKXt0aGlzLmNhbGxTdXBlcihcIl9yZW5kZXJDb250cm9sc1wiLHQsZSk7Zm9yKHZhciBpPTAscj10aGlzLl9vYmplY3RzLmxlbmd0aDtyPmk7aSsrKXRoaXMuX29iamVjdHNbaV0uX3JlbmRlckNvbnRyb2xzKHQpfSxfcmVuZGVyT2JqZWN0OmZ1bmN0aW9uKHQsZSl7aWYodC52aXNpYmxlKXt2YXIgaT10Lmhhc1JvdGF0aW5nUG9pbnQ7dC5oYXNSb3RhdGluZ1BvaW50PSExLHQucmVuZGVyKGUpLHQuaGFzUm90YXRpbmdQb2ludD1pfX0sX3Jlc3RvcmVPYmplY3RzU3RhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb2JqZWN0cy5mb3JFYWNoKHRoaXMuX3Jlc3RvcmVPYmplY3RTdGF0ZSx0aGlzKSx0aGlzfSxyZWFsaXplVHJhbnNmb3JtOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9tb3ZlRmxpcHBlZE9iamVjdCh0KSx0aGlzLl9zZXRPYmplY3RQb3NpdGlvbih0KSx0fSxfbW92ZUZsaXBwZWRPYmplY3Q6ZnVuY3Rpb24odCl7dmFyIGU9dC5nZXQoXCJvcmlnaW5YXCIpLGk9dC5nZXQoXCJvcmlnaW5ZXCIpLHI9dC5nZXRDZW50ZXJQb2ludCgpO3Quc2V0KHtvcmlnaW5YOlwiY2VudGVyXCIsb3JpZ2luWTpcImNlbnRlclwiLGxlZnQ6ci54LHRvcDpyLnl9KSx0aGlzLl90b2dnbGVGbGlwcGluZyh0KTt2YXIgcz10LmdldFBvaW50QnlPcmlnaW4oZSxpKTtyZXR1cm4gdC5zZXQoe29yaWdpblg6ZSxvcmlnaW5ZOmksbGVmdDpzLngsdG9wOnMueX0pLHRoaXN9LF90b2dnbGVGbGlwcGluZzpmdW5jdGlvbih0KXt0aGlzLmZsaXBYJiYodC50b2dnbGUoXCJmbGlwWFwiKSx0LnNldChcImxlZnRcIiwtdC5nZXQoXCJsZWZ0XCIpKSx0LnNldEFuZ2xlKC10LmdldEFuZ2xlKCkpKSx0aGlzLmZsaXBZJiYodC50b2dnbGUoXCJmbGlwWVwiKSx0LnNldChcInRvcFwiLC10LmdldChcInRvcFwiKSksdC5zZXRBbmdsZSgtdC5nZXRBbmdsZSgpKSl9LF9yZXN0b3JlT2JqZWN0U3RhdGU6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX3NldE9iamVjdFBvc2l0aW9uKHQpLHQuc2V0Q29vcmRzKCksdC5oYXNDb250cm9scz10Ll9fb3JpZ0hhc0NvbnRyb2xzLGRlbGV0ZSB0Ll9fb3JpZ0hhc0NvbnRyb2xzLHQuc2V0KFwiYWN0aXZlXCIsITEpLHQuc2V0Q29vcmRzKCksZGVsZXRlIHQuZ3JvdXAsdGhpc30sX3NldE9iamVjdFBvc2l0aW9uOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0Q2VudGVyUG9pbnQoKSxpPXRoaXMuX2dldFJvdGF0ZWRMZWZ0VG9wKHQpO3Quc2V0KHthbmdsZTp0LmdldEFuZ2xlKCkrdGhpcy5nZXRBbmdsZSgpLGxlZnQ6ZS54K2kubGVmdCx0b3A6ZS55K2kudG9wLHNjYWxlWDp0LmdldChcInNjYWxlWFwiKSp0aGlzLmdldChcInNjYWxlWFwiKSxzY2FsZVk6dC5nZXQoXCJzY2FsZVlcIikqdGhpcy5nZXQoXCJzY2FsZVlcIil9KX0sX2dldFJvdGF0ZWRMZWZ0VG9wOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0QW5nbGUoKSooTWF0aC5QSS8xODApO3JldHVybntsZWZ0Oi1NYXRoLnNpbihlKSp0LmdldFRvcCgpKnRoaXMuZ2V0KFwic2NhbGVZXCIpK01hdGguY29zKGUpKnQuZ2V0TGVmdCgpKnRoaXMuZ2V0KFwic2NhbGVYXCIpLHRvcDpNYXRoLmNvcyhlKSp0LmdldFRvcCgpKnRoaXMuZ2V0KFwic2NhbGVZXCIpK01hdGguc2luKGUpKnQuZ2V0TGVmdCgpKnRoaXMuZ2V0KFwic2NhbGVYXCIpfX0sZGVzdHJveTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vYmplY3RzLmZvckVhY2godGhpcy5fbW92ZUZsaXBwZWRPYmplY3QsdGhpcyksdGhpcy5fcmVzdG9yZU9iamVjdHNTdGF0ZSgpfSxzYXZlQ29vcmRzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29yaWdpbmFsTGVmdD10aGlzLmdldChcImxlZnRcIiksdGhpcy5fb3JpZ2luYWxUb3A9dGhpcy5nZXQoXCJ0b3BcIiksdGhpc30saGFzTW92ZWQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb3JpZ2luYWxMZWZ0IT09dGhpcy5nZXQoXCJsZWZ0XCIpfHx0aGlzLl9vcmlnaW5hbFRvcCE9PXRoaXMuZ2V0KFwidG9wXCIpfSxzZXRPYmplY3RzQ29vcmRzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZm9yRWFjaE9iamVjdChmdW5jdGlvbih0KXt0LnNldENvb3JkcygpfSksdGhpc30sX2NhbGNCb3VuZHM6ZnVuY3Rpb24odCl7Zm9yKHZhciBlLGkscj1bXSxzPVtdLG49W1widHJcIixcImJyXCIsXCJibFwiLFwidGxcIl0sbz0wLGE9dGhpcy5fb2JqZWN0cy5sZW5ndGg7YT5vOysrbyl7ZT10aGlzLl9vYmplY3RzW29dLGUuc2V0Q29vcmRzKCk7Zm9yKHZhciBoPTA7aDxuLmxlbmd0aDtoKyspaT1uW2hdLHIucHVzaChlLm9Db29yZHNbaV0ueCkscy5wdXNoKGUub0Nvb3Jkc1tpXS55KX10aGlzLnNldCh0aGlzLl9nZXRCb3VuZHMocixzLHQpKX0sX2dldEJvdW5kczpmdW5jdGlvbih0LGksbil7dmFyIG89ZS51dGlsLmludmVydFRyYW5zZm9ybSh0aGlzLmdldFZpZXdwb3J0VHJhbnNmb3JtKCkpLGE9ZS51dGlsLnRyYW5zZm9ybVBvaW50KG5ldyBlLlBvaW50KHIodCkscihpKSksbyksaD1lLnV0aWwudHJhbnNmb3JtUG9pbnQobmV3IGUuUG9pbnQocyh0KSxzKGkpKSxvKSxjPXt3aWR0aDpoLngtYS54fHwwLGhlaWdodDpoLnktYS55fHwwfTtyZXR1cm4gbnx8KGMubGVmdD1hLnh8fDAsYy50b3A9YS55fHwwLFwiY2VudGVyXCI9PT10aGlzLm9yaWdpblgmJihjLmxlZnQrPWMud2lkdGgvMiksXCJyaWdodFwiPT09dGhpcy5vcmlnaW5YJiYoYy5sZWZ0Kz1jLndpZHRoKSxcImNlbnRlclwiPT09dGhpcy5vcmlnaW5ZJiYoYy50b3ArPWMuaGVpZ2h0LzIpLFwiYm90dG9tXCI9PT10aGlzLm9yaWdpblkmJihjLnRvcCs9Yy5oZWlnaHQpKSxjfSx0b1NWRzpmdW5jdGlvbih0KXtmb3IodmFyIGU9W1wiPGcgXCIsJ3RyYW5zZm9ybT1cIicsdGhpcy5nZXRTdmdUcmFuc2Zvcm0oKSwnXCI+XFxuJ10saT0wLHI9dGhpcy5fb2JqZWN0cy5sZW5ndGg7cj5pO2krKyllLnB1c2godGhpcy5fb2JqZWN0c1tpXS50b1NWRyh0KSk7cmV0dXJuIGUucHVzaChcIjwvZz5cXG5cIiksdD90KGUuam9pbihcIlwiKSk6ZS5qb2luKFwiXCIpfSxnZXQ6ZnVuY3Rpb24odCl7aWYodCBpbiBvKXtpZih0aGlzW3RdKXJldHVybiB0aGlzW3RdO2Zvcih2YXIgZT0wLGk9dGhpcy5fb2JqZWN0cy5sZW5ndGg7aT5lO2UrKylpZih0aGlzLl9vYmplY3RzW2VdW3RdKXJldHVybiEwO3JldHVybiExfXJldHVybiB0IGluIHRoaXMuZGVsZWdhdGVkUHJvcGVydGllcz90aGlzLl9vYmplY3RzWzBdJiZ0aGlzLl9vYmplY3RzWzBdLmdldCh0KTp0aGlzW3RdfX0pLGUuR3JvdXAuZnJvbU9iamVjdD1mdW5jdGlvbih0LGkpe2UudXRpbC5lbmxpdmVuT2JqZWN0cyh0Lm9iamVjdHMsZnVuY3Rpb24ocil7ZGVsZXRlIHQub2JqZWN0cyxpJiZpKG5ldyBlLkdyb3VwKHIsdCkpfSl9LGUuR3JvdXAuYXN5bmM9ITB9fShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPWZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQ7cmV0dXJuIHQuZmFicmljfHwodC5mYWJyaWM9e30pLHQuZmFicmljLkltYWdlP3ZvaWQgZmFicmljLndhcm4oXCJmYWJyaWMuSW1hZ2UgaXMgYWxyZWFkeSBkZWZpbmVkLlwiKTooZmFicmljLkltYWdlPWZhYnJpYy51dGlsLmNyZWF0ZUNsYXNzKGZhYnJpYy5PYmplY3Qse3R5cGU6XCJpbWFnZVwiLGNyb3NzT3JpZ2luOlwiXCIsYWxpZ25YOlwibm9uZVwiLGFsaWduWTpcIm5vbmVcIixtZWV0T3JTbGljZTpcIm1lZXRcIixfbGFzdFNjYWxlWDoxLF9sYXN0U2NhbGVZOjEsaW5pdGlhbGl6ZTpmdW5jdGlvbih0LGUpe2V8fChlPXt9KSx0aGlzLmZpbHRlcnM9W10sdGhpcy5yZXNpemVGaWx0ZXJzPVtdLHRoaXMuY2FsbFN1cGVyKFwiaW5pdGlhbGl6ZVwiLGUpLHRoaXMuX2luaXRFbGVtZW50KHQsZSl9LGdldEVsZW1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZWxlbWVudH0sc2V0RWxlbWVudDpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHRoaXMuX2VsZW1lbnQ9dCx0aGlzLl9vcmlnaW5hbEVsZW1lbnQ9dCx0aGlzLl9pbml0Q29uZmlnKGkpLDAhPT10aGlzLmZpbHRlcnMubGVuZ3RoP3RoaXMuYXBwbHlGaWx0ZXJzKGUpOmUmJmUoKSx0aGlzfSxzZXRDcm9zc09yaWdpbjpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jcm9zc09yaWdpbj10LHRoaXMuX2VsZW1lbnQuY3Jvc3NPcmlnaW49dCx0aGlzfSxnZXRPcmlnaW5hbFNpemU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmdldEVsZW1lbnQoKTtyZXR1cm57d2lkdGg6dC53aWR0aCxoZWlnaHQ6dC5oZWlnaHR9fSxfc3Ryb2tlOmZ1bmN0aW9uKHQpe3Quc2F2ZSgpLHRoaXMuX3NldFN0cm9rZVN0eWxlcyh0KSx0LmJlZ2luUGF0aCgpLHQuc3Ryb2tlUmVjdCgtdGhpcy53aWR0aC8yLC10aGlzLmhlaWdodC8yLHRoaXMud2lkdGgsdGhpcy5oZWlnaHQpLHQuY2xvc2VQYXRoKCksdC5yZXN0b3JlKCl9LF9yZW5kZXJEYXNoZWRTdHJva2U6ZnVuY3Rpb24odCl7dmFyIGU9LXRoaXMud2lkdGgvMixpPS10aGlzLmhlaWdodC8yLHI9dGhpcy53aWR0aCxzPXRoaXMuaGVpZ2h0O3Quc2F2ZSgpLHRoaXMuX3NldFN0cm9rZVN0eWxlcyh0KSx0LmJlZ2luUGF0aCgpLGZhYnJpYy51dGlsLmRyYXdEYXNoZWRMaW5lKHQsZSxpLGUrcixpLHRoaXMuc3Ryb2tlRGFzaEFycmF5KSxmYWJyaWMudXRpbC5kcmF3RGFzaGVkTGluZSh0LGUrcixpLGUrcixpK3MsdGhpcy5zdHJva2VEYXNoQXJyYXkpLGZhYnJpYy51dGlsLmRyYXdEYXNoZWRMaW5lKHQsZStyLGkrcyxlLGkrcyx0aGlzLnN0cm9rZURhc2hBcnJheSksZmFicmljLnV0aWwuZHJhd0Rhc2hlZExpbmUodCxlLGkrcyxlLGksdGhpcy5zdHJva2VEYXNoQXJyYXkpLHQuY2xvc2VQYXRoKCksdC5yZXN0b3JlKCl9LHRvT2JqZWN0OmZ1bmN0aW9uKHQpe3ZhciBpPWUodGhpcy5jYWxsU3VwZXIoXCJ0b09iamVjdFwiLHQpLHtzcmM6dGhpcy5fb3JpZ2luYWxFbGVtZW50LnNyY3x8dGhpcy5fb3JpZ2luYWxFbGVtZW50Ll9zcmMsZmlsdGVyczp0aGlzLmZpbHRlcnMubWFwKGZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0LnRvT2JqZWN0KCl9KSxjcm9zc09yaWdpbjp0aGlzLmNyb3NzT3JpZ2luLGFsaWduWDp0aGlzLmFsaWduWCxhbGlnblk6dGhpcy5hbGlnblksbWVldE9yU2xpY2U6dGhpcy5tZWV0T3JTbGljZX0pO3JldHVybiB0aGlzLnJlc2l6ZUZpbHRlcnMubGVuZ3RoPjAmJihpLnJlc2l6ZUZpbHRlcnM9dGhpcy5yZXNpemVGaWx0ZXJzLm1hcChmdW5jdGlvbih0KXtyZXR1cm4gdCYmdC50b09iamVjdCgpfSkpLGl9LHRvU1ZHOmZ1bmN0aW9uKHQpe3ZhciBlPVtdLGk9LXRoaXMud2lkdGgvMixyPS10aGlzLmhlaWdodC8yLHM9XCJub25lXCI7aWYodGhpcy5ncm91cCYmXCJwYXRoLWdyb3VwXCI9PT10aGlzLmdyb3VwLnR5cGUmJihpPXRoaXMubGVmdCxyPXRoaXMudG9wKSxcIm5vbmVcIiE9PXRoaXMuYWxpZ25YJiZcIm5vbmVcIiE9PXRoaXMuYWxpZ25ZJiYocz1cInhcIit0aGlzLmFsaWduWCtcIllcIit0aGlzLmFsaWduWStcIiBcIit0aGlzLm1lZXRPclNsaWNlKSxlLnB1c2goJzxnIHRyYW5zZm9ybT1cIicsdGhpcy5nZXRTdmdUcmFuc2Zvcm0oKSx0aGlzLmdldFN2Z1RyYW5zZm9ybU1hdHJpeCgpLCdcIj5cXG4nLCc8aW1hZ2UgeGxpbms6aHJlZj1cIicsdGhpcy5nZXRTdmdTcmMoKSwnXCIgeD1cIicsaSwnXCIgeT1cIicsciwnXCIgc3R5bGU9XCInLHRoaXMuZ2V0U3ZnU3R5bGVzKCksJ1wiIHdpZHRoPVwiJyx0aGlzLndpZHRoLCdcIiBoZWlnaHQ9XCInLHRoaXMuaGVpZ2h0LCdcIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPVwiJyxzLCdcIicsXCI+PC9pbWFnZT5cXG5cIiksdGhpcy5zdHJva2V8fHRoaXMuc3Ryb2tlRGFzaEFycmF5KXt2YXIgbj10aGlzLmZpbGw7dGhpcy5maWxsPW51bGwsZS5wdXNoKFwiPHJlY3QgXCIsJ3g9XCInLGksJ1wiIHk9XCInLHIsJ1wiIHdpZHRoPVwiJyx0aGlzLndpZHRoLCdcIiBoZWlnaHQ9XCInLHRoaXMuaGVpZ2h0LCdcIiBzdHlsZT1cIicsdGhpcy5nZXRTdmdTdHlsZXMoKSwnXCIvPlxcbicpLHRoaXMuZmlsbD1ufXJldHVybiBlLnB1c2goXCI8L2c+XFxuXCIpLHQ/dChlLmpvaW4oXCJcIikpOmUuam9pbihcIlwiKX0sZ2V0U3JjOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0RWxlbWVudCgpP3RoaXMuZ2V0RWxlbWVudCgpLnNyY3x8dGhpcy5nZXRFbGVtZW50KCkuX3NyYzp2b2lkIDB9LHNldFNyYzpmdW5jdGlvbih0LGUsaSl7ZmFicmljLnV0aWwubG9hZEltYWdlKHQsZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc2V0RWxlbWVudCh0LGUsaSl9LHRoaXMsaSYmaS5jcm9zc09yaWdpbil9LHRvU3RyaW5nOmZ1bmN0aW9uKCl7cmV0dXJuJyM8ZmFicmljLkltYWdlOiB7IHNyYzogXCInK3RoaXMuZ2V0U3JjKCkrJ1wiIH0+J30sY2xvbmU6ZnVuY3Rpb24odCxlKXt0aGlzLmNvbnN0cnVjdG9yLmZyb21PYmplY3QodGhpcy50b09iamVjdChlKSx0KX0sYXBwbHlGaWx0ZXJzOmZ1bmN0aW9uKHQsZSxpLHIpe2lmKGU9ZXx8dGhpcy5maWx0ZXJzLFxyXG5pPWl8fHRoaXMuX29yaWdpbmFsRWxlbWVudCl7dmFyIHM9aSxuPWZhYnJpYy51dGlsLmNyZWF0ZUNhbnZhc0VsZW1lbnQoKSxvPWZhYnJpYy51dGlsLmNyZWF0ZUltYWdlKCksYT10aGlzO3JldHVybiBuLndpZHRoPXMud2lkdGgsbi5oZWlnaHQ9cy5oZWlnaHQsbi5nZXRDb250ZXh0KFwiMmRcIikuZHJhd0ltYWdlKHMsMCwwLHMud2lkdGgscy5oZWlnaHQpLDA9PT1lLmxlbmd0aD8odGhpcy5fZWxlbWVudD1pLHQmJnQoKSxuKTooZS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3QmJnQuYXBwbHlUbyhuLHQuc2NhbGVYfHxhLnNjYWxlWCx0LnNjYWxlWXx8YS5zY2FsZVkpLCFyJiZ0JiZcIlJlc2l6ZVwiPT09dC50eXBlJiYoYS53aWR0aCo9dC5zY2FsZVgsYS5oZWlnaHQqPXQuc2NhbGVZKX0pLG8ud2lkdGg9bi53aWR0aCxvLmhlaWdodD1uLmhlaWdodCxmYWJyaWMuaXNMaWtlbHlOb2RlPyhvLnNyYz1uLnRvQnVmZmVyKHZvaWQgMCxmYWJyaWMuSW1hZ2UucG5nQ29tcHJlc3Npb24pLGEuX2VsZW1lbnQ9bywhciYmKGEuX2ZpbHRlcmVkRWw9byksdCYmdCgpKTooby5vbmxvYWQ9ZnVuY3Rpb24oKXthLl9lbGVtZW50PW8sIXImJihhLl9maWx0ZXJlZEVsPW8pLHQmJnQoKSxvLm9ubG9hZD1uPXM9bnVsbH0sby5zcmM9bi50b0RhdGFVUkwoXCJpbWFnZS9wbmdcIikpLG4pfX0sX3JlbmRlcjpmdW5jdGlvbih0LGUpe3ZhciBpLHIscyxuPXRoaXMuX2ZpbmRNYXJnaW5zKCk7aT1lP3RoaXMubGVmdDotdGhpcy53aWR0aC8yLHI9ZT90aGlzLnRvcDotdGhpcy5oZWlnaHQvMixcInNsaWNlXCI9PT10aGlzLm1lZXRPclNsaWNlJiYodC5iZWdpblBhdGgoKSx0LnJlY3QoaSxyLHRoaXMud2lkdGgsdGhpcy5oZWlnaHQpLHQuY2xpcCgpKSx0aGlzLmlzTW92aW5nPT09ITEmJnRoaXMucmVzaXplRmlsdGVycy5sZW5ndGgmJnRoaXMuX25lZWRzUmVzaXplKCk/KHRoaXMuX2xhc3RTY2FsZVg9dGhpcy5zY2FsZVgsdGhpcy5fbGFzdFNjYWxlWT10aGlzLnNjYWxlWSxzPXRoaXMuYXBwbHlGaWx0ZXJzKG51bGwsdGhpcy5yZXNpemVGaWx0ZXJzLHRoaXMuX2ZpbHRlcmVkRWx8fHRoaXMuX29yaWdpbmFsRWxlbWVudCwhMCkpOnM9dGhpcy5fZWxlbWVudCxzJiZ0LmRyYXdJbWFnZShzLGkrbi5tYXJnaW5YLHIrbi5tYXJnaW5ZLG4ud2lkdGgsbi5oZWlnaHQpLHRoaXMuX3JlbmRlclN0cm9rZSh0KX0sX25lZWRzUmVzaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2NhbGVYIT09dGhpcy5fbGFzdFNjYWxlWHx8dGhpcy5zY2FsZVkhPT10aGlzLl9sYXN0U2NhbGVZfSxfZmluZE1hcmdpbnM6ZnVuY3Rpb24oKXt2YXIgdCxlLGk9dGhpcy53aWR0aCxyPXRoaXMuaGVpZ2h0LHM9MCxuPTA7cmV0dXJuKFwibm9uZVwiIT09dGhpcy5hbGlnblh8fFwibm9uZVwiIT09dGhpcy5hbGlnblkpJiYodD1bdGhpcy53aWR0aC90aGlzLl9lbGVtZW50LndpZHRoLHRoaXMuaGVpZ2h0L3RoaXMuX2VsZW1lbnQuaGVpZ2h0XSxlPVwibWVldFwiPT09dGhpcy5tZWV0T3JTbGljZT9NYXRoLm1pbi5hcHBseShudWxsLHQpOk1hdGgubWF4LmFwcGx5KG51bGwsdCksaT10aGlzLl9lbGVtZW50LndpZHRoKmUscj10aGlzLl9lbGVtZW50LmhlaWdodCplLFwiTWlkXCI9PT10aGlzLmFsaWduWCYmKHM9KHRoaXMud2lkdGgtaSkvMiksXCJNYXhcIj09PXRoaXMuYWxpZ25YJiYocz10aGlzLndpZHRoLWkpLFwiTWlkXCI9PT10aGlzLmFsaWduWSYmKG49KHRoaXMuaGVpZ2h0LXIpLzIpLFwiTWF4XCI9PT10aGlzLmFsaWduWSYmKG49dGhpcy5oZWlnaHQtcikpLHt3aWR0aDppLGhlaWdodDpyLG1hcmdpblg6cyxtYXJnaW5ZOm59fSxfcmVzZXRXaWR0aEhlaWdodDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0RWxlbWVudCgpO3RoaXMuc2V0KFwid2lkdGhcIix0LndpZHRoKSx0aGlzLnNldChcImhlaWdodFwiLHQuaGVpZ2h0KX0sX2luaXRFbGVtZW50OmZ1bmN0aW9uKHQpe3RoaXMuc2V0RWxlbWVudChmYWJyaWMudXRpbC5nZXRCeUlkKHQpKSxmYWJyaWMudXRpbC5hZGRDbGFzcyh0aGlzLmdldEVsZW1lbnQoKSxmYWJyaWMuSW1hZ2UuQ1NTX0NBTlZBUyl9LF9pbml0Q29uZmlnOmZ1bmN0aW9uKHQpe3R8fCh0PXt9KSx0aGlzLnNldE9wdGlvbnModCksdGhpcy5fc2V0V2lkdGhIZWlnaHQodCksdGhpcy5fZWxlbWVudCYmdGhpcy5jcm9zc09yaWdpbiYmKHRoaXMuX2VsZW1lbnQuY3Jvc3NPcmlnaW49dGhpcy5jcm9zc09yaWdpbil9LF9pbml0RmlsdGVyczpmdW5jdGlvbih0LGUpe3QmJnQubGVuZ3RoP2ZhYnJpYy51dGlsLmVubGl2ZW5PYmplY3RzKHQsZnVuY3Rpb24odCl7ZSYmZSh0KX0sXCJmYWJyaWMuSW1hZ2UuZmlsdGVyc1wiKTplJiZlKCl9LF9zZXRXaWR0aEhlaWdodDpmdW5jdGlvbih0KXt0aGlzLndpZHRoPVwid2lkdGhcImluIHQ/dC53aWR0aDp0aGlzLmdldEVsZW1lbnQoKT90aGlzLmdldEVsZW1lbnQoKS53aWR0aHx8MDowLHRoaXMuaGVpZ2h0PVwiaGVpZ2h0XCJpbiB0P3QuaGVpZ2h0OnRoaXMuZ2V0RWxlbWVudCgpP3RoaXMuZ2V0RWxlbWVudCgpLmhlaWdodHx8MDowfSxjb21wbGV4aXR5OmZ1bmN0aW9uKCl7cmV0dXJuIDF9fSksZmFicmljLkltYWdlLkNTU19DQU5WQVM9XCJjYW52YXMtaW1nXCIsZmFicmljLkltYWdlLnByb3RvdHlwZS5nZXRTdmdTcmM9ZmFicmljLkltYWdlLnByb3RvdHlwZS5nZXRTcmMsZmFicmljLkltYWdlLmZyb21PYmplY3Q9ZnVuY3Rpb24odCxlKXtmYWJyaWMudXRpbC5sb2FkSW1hZ2UodC5zcmMsZnVuY3Rpb24oaSl7ZmFicmljLkltYWdlLnByb3RvdHlwZS5faW5pdEZpbHRlcnMuY2FsbCh0LHQuZmlsdGVycyxmdW5jdGlvbihyKXt0LmZpbHRlcnM9cnx8W10sZmFicmljLkltYWdlLnByb3RvdHlwZS5faW5pdEZpbHRlcnMuY2FsbCh0LHQucmVzaXplRmlsdGVycyxmdW5jdGlvbihyKXt0LnJlc2l6ZUZpbHRlcnM9cnx8W107dmFyIHM9bmV3IGZhYnJpYy5JbWFnZShpLHQpO2UmJmUocyl9KX0pfSxudWxsLHQuY3Jvc3NPcmlnaW4pfSxmYWJyaWMuSW1hZ2UuZnJvbVVSTD1mdW5jdGlvbih0LGUsaSl7ZmFicmljLnV0aWwubG9hZEltYWdlKHQsZnVuY3Rpb24odCl7ZSYmZShuZXcgZmFicmljLkltYWdlKHQsaSkpfSxudWxsLGkmJmkuY3Jvc3NPcmlnaW4pfSxmYWJyaWMuSW1hZ2UuQVRUUklCVVRFX05BTUVTPWZhYnJpYy5TSEFSRURfQVRUUklCVVRFUy5jb25jYXQoXCJ4IHkgd2lkdGggaGVpZ2h0IHByZXNlcnZlQXNwZWN0UmF0aW8geGxpbms6aHJlZlwiLnNwbGl0KFwiIFwiKSksZmFicmljLkltYWdlLmZyb21FbGVtZW50PWZ1bmN0aW9uKHQsaSxyKXt2YXIgcyxuLG8sYT1mYWJyaWMucGFyc2VBdHRyaWJ1dGVzKHQsZmFicmljLkltYWdlLkFUVFJJQlVURV9OQU1FUyksaD1cInhNaWRZTWlkXCIsYz1cIm1lZXRcIjthLnByZXNlcnZlQXNwZWN0UmF0aW8mJihvPWEucHJlc2VydmVBc3BlY3RSYXRpby5zcGxpdChcIiBcIikpLG8mJm8ubGVuZ3RoJiYoYz1vLnBvcCgpLFwibWVldFwiIT09YyYmXCJzbGljZVwiIT09Yz8oaD1jLGM9XCJtZWV0XCIpOm8ubGVuZ3RoJiYoaD1vLnBvcCgpKSkscz1cIm5vbmVcIiE9PWg/aC5zbGljZSgxLDQpOlwibm9uZVwiLG49XCJub25lXCIhPT1oP2guc2xpY2UoNSw4KTpcIm5vbmVcIixhLmFsaWduWD1zLGEuYWxpZ25ZPW4sYS5tZWV0T3JTbGljZT1jLGZhYnJpYy5JbWFnZS5mcm9tVVJMKGFbXCJ4bGluazpocmVmXCJdLGksZShyP2ZhYnJpYy51dGlsLm9iamVjdC5jbG9uZShyKTp7fSxhKSl9LGZhYnJpYy5JbWFnZS5hc3luYz0hMCx2b2lkKGZhYnJpYy5JbWFnZS5wbmdDb21wcmVzc2lvbj0xKSl9KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuT2JqZWN0LnByb3RvdHlwZSx7X2dldEFuZ2xlVmFsdWVGb3JTdHJhaWdodGVuOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXRBbmdsZSgpJTM2MDtyZXR1cm4gdD4wPzkwKk1hdGgucm91bmQoKHQtMSkvOTApOjkwKk1hdGgucm91bmQodC85MCl9LHN0cmFpZ2h0ZW46ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZXRBbmdsZSh0aGlzLl9nZXRBbmdsZVZhbHVlRm9yU3RyYWlnaHRlbigpKSx0aGlzfSxmeFN0cmFpZ2h0ZW46ZnVuY3Rpb24odCl7dD10fHx7fTt2YXIgZT1mdW5jdGlvbigpe30saT10Lm9uQ29tcGxldGV8fGUscj10Lm9uQ2hhbmdlfHxlLHM9dGhpcztyZXR1cm4gZmFicmljLnV0aWwuYW5pbWF0ZSh7c3RhcnRWYWx1ZTp0aGlzLmdldChcImFuZ2xlXCIpLGVuZFZhbHVlOnRoaXMuX2dldEFuZ2xlVmFsdWVGb3JTdHJhaWdodGVuKCksZHVyYXRpb246dGhpcy5GWF9EVVJBVElPTixvbkNoYW5nZTpmdW5jdGlvbih0KXtzLnNldEFuZ2xlKHQpLHIoKX0sb25Db21wbGV0ZTpmdW5jdGlvbigpe3Muc2V0Q29vcmRzKCksaSgpfSxvblN0YXJ0OmZ1bmN0aW9uKCl7cy5zZXQoXCJhY3RpdmVcIiwhMSl9fSksdGhpc319KSxmYWJyaWMudXRpbC5vYmplY3QuZXh0ZW5kKGZhYnJpYy5TdGF0aWNDYW52YXMucHJvdG90eXBlLHtzdHJhaWdodGVuT2JqZWN0OmZ1bmN0aW9uKHQpe3JldHVybiB0LnN0cmFpZ2h0ZW4oKSx0aGlzLnJlbmRlckFsbCgpLHRoaXN9LGZ4U3RyYWlnaHRlbk9iamVjdDpmdW5jdGlvbih0KXtyZXR1cm4gdC5meFN0cmFpZ2h0ZW4oe29uQ2hhbmdlOnRoaXMucmVuZGVyQWxsLmJpbmQodGhpcyl9KSx0aGlzfX0pLGZhYnJpYy5JbWFnZS5maWx0ZXJzPWZhYnJpYy5JbWFnZS5maWx0ZXJzfHx7fSxmYWJyaWMuSW1hZ2UuZmlsdGVycy5CYXNlRmlsdGVyPWZhYnJpYy51dGlsLmNyZWF0ZUNsYXNzKHt0eXBlOlwiQmFzZUZpbHRlclwiLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dCYmdGhpcy5zZXRPcHRpb25zKHQpfSxzZXRPcHRpb25zOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZSBpbiB0KXRoaXNbZV09dFtlXX0sdG9PYmplY3Q6ZnVuY3Rpb24oKXtyZXR1cm57dHlwZTp0aGlzLnR5cGV9fSx0b0pTT046ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b09iamVjdCgpfX0pLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPXQuZmFicmljfHwodC5mYWJyaWM9e30pLGk9ZS51dGlsLm9iamVjdC5leHRlbmQ7ZS5JbWFnZS5maWx0ZXJzLkJyaWdodG5lc3M9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuSW1hZ2UuZmlsdGVycy5CYXNlRmlsdGVyLHt0eXBlOlwiQnJpZ2h0bmVzc1wiLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dD10fHx7fSx0aGlzLmJyaWdodG5lc3M9dC5icmlnaHRuZXNzfHwwfSxhcHBseVRvOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10LmdldENvbnRleHQoXCIyZFwiKSxpPWUuZ2V0SW1hZ2VEYXRhKDAsMCx0LndpZHRoLHQuaGVpZ2h0KSxyPWkuZGF0YSxzPXRoaXMuYnJpZ2h0bmVzcyxuPTAsbz1yLmxlbmd0aDtvPm47bis9NClyW25dKz1zLHJbbisxXSs9cyxyW24rMl0rPXM7ZS5wdXRJbWFnZURhdGEoaSwwLDApfSx0b09iamVjdDpmdW5jdGlvbigpe3JldHVybiBpKHRoaXMuY2FsbFN1cGVyKFwidG9PYmplY3RcIikse2JyaWdodG5lc3M6dGhpcy5icmlnaHRuZXNzfSl9fSksZS5JbWFnZS5maWx0ZXJzLkJyaWdodG5lc3MuZnJvbU9iamVjdD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUuSW1hZ2UuZmlsdGVycy5CcmlnaHRuZXNzKHQpfX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPWUudXRpbC5vYmplY3QuZXh0ZW5kO2UuSW1hZ2UuZmlsdGVycy5Db252b2x1dGU9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuSW1hZ2UuZmlsdGVycy5CYXNlRmlsdGVyLHt0eXBlOlwiQ29udm9sdXRlXCIsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0PXR8fHt9LHRoaXMub3BhcXVlPXQub3BhcXVlLHRoaXMubWF0cml4PXQubWF0cml4fHxbMCwwLDAsMCwxLDAsMCwwLDBdO3ZhciBpPWUudXRpbC5jcmVhdGVDYW52YXNFbGVtZW50KCk7dGhpcy50bXBDdHg9aS5nZXRDb250ZXh0KFwiMmRcIil9LF9jcmVhdGVJbWFnZURhdGE6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy50bXBDdHguY3JlYXRlSW1hZ2VEYXRhKHQsZSl9LGFwcGx5VG86ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXRoaXMubWF0cml4LGk9dC5nZXRDb250ZXh0KFwiMmRcIikscj1pLmdldEltYWdlRGF0YSgwLDAsdC53aWR0aCx0LmhlaWdodCkscz1NYXRoLnJvdW5kKE1hdGguc3FydChlLmxlbmd0aCkpLG49TWF0aC5mbG9vcihzLzIpLG89ci5kYXRhLGE9ci53aWR0aCxoPXIuaGVpZ2h0LGM9YSxsPWgsdT10aGlzLl9jcmVhdGVJbWFnZURhdGEoYyxsKSxmPXUuZGF0YSxkPXRoaXMub3BhcXVlPzE6MCxnPTA7bD5nO2crKylmb3IodmFyIHA9MDtjPnA7cCsrKXtmb3IodmFyIHY9ZyxiPXAsbT00KihnKmMrcCkseT0wLF89MCx4PTAsQz0wLFM9MDtzPlM7UysrKWZvcih2YXIgdz0wO3M+dzt3Kyspe3ZhciBPPXYrUy1uLFQ9Yit3LW47aWYoISgwPk98fE8+aHx8MD5UfHxUPmEpKXt2YXIgaz00KihPKmErVCksaj1lW1Mqcyt3XTt5Kz1vW2tdKmosXys9b1trKzFdKmoseCs9b1trKzJdKmosQys9b1trKzNdKmp9fWZbbV09eSxmW20rMV09XyxmW20rMl09eCxmW20rM109QytkKigyNTUtQyl9aS5wdXRJbWFnZURhdGEodSwwLDApfSx0b09iamVjdDpmdW5jdGlvbigpe3JldHVybiBpKHRoaXMuY2FsbFN1cGVyKFwidG9PYmplY3RcIikse29wYXF1ZTp0aGlzLm9wYXF1ZSxtYXRyaXg6dGhpcy5tYXRyaXh9KX19KSxlLkltYWdlLmZpbHRlcnMuQ29udm9sdXRlLmZyb21PYmplY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlLkltYWdlLmZpbHRlcnMuQ29udm9sdXRlKHQpfX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPWUudXRpbC5vYmplY3QuZXh0ZW5kO2UuSW1hZ2UuZmlsdGVycy5HcmFkaWVudFRyYW5zcGFyZW5jeT1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5JbWFnZS5maWx0ZXJzLkJhc2VGaWx0ZXIse3R5cGU6XCJHcmFkaWVudFRyYW5zcGFyZW5jeVwiLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dD10fHx7fSx0aGlzLnRocmVzaG9sZD10LnRocmVzaG9sZHx8MTAwfSxhcHBseVRvOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10LmdldENvbnRleHQoXCIyZFwiKSxpPWUuZ2V0SW1hZ2VEYXRhKDAsMCx0LndpZHRoLHQuaGVpZ2h0KSxyPWkuZGF0YSxzPXRoaXMudGhyZXNob2xkLG49ci5sZW5ndGgsbz0wLGE9ci5sZW5ndGg7YT5vO28rPTQpcltvKzNdPXMrMjU1KihuLW8pL247ZS5wdXRJbWFnZURhdGEoaSwwLDApfSx0b09iamVjdDpmdW5jdGlvbigpe3JldHVybiBpKHRoaXMuY2FsbFN1cGVyKFwidG9PYmplY3RcIikse3RocmVzaG9sZDp0aGlzLnRocmVzaG9sZH0pfX0pLGUuSW1hZ2UuZmlsdGVycy5HcmFkaWVudFRyYW5zcGFyZW5jeS5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5JbWFnZS5maWx0ZXJzLkdyYWRpZW50VHJhbnNwYXJlbmN5KHQpfX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KTtlLkltYWdlLmZpbHRlcnMuR3JheXNjYWxlPWUudXRpbC5jcmVhdGVDbGFzcyhlLkltYWdlLmZpbHRlcnMuQmFzZUZpbHRlcix7dHlwZTpcIkdyYXlzY2FsZVwiLGFwcGx5VG86ZnVuY3Rpb24odCl7Zm9yKHZhciBlLGk9dC5nZXRDb250ZXh0KFwiMmRcIikscj1pLmdldEltYWdlRGF0YSgwLDAsdC53aWR0aCx0LmhlaWdodCkscz1yLmRhdGEsbj1yLndpZHRoKnIuaGVpZ2h0KjQsbz0wO24+bzspZT0oc1tvXStzW28rMV0rc1tvKzJdKS8zLHNbb109ZSxzW28rMV09ZSxzW28rMl09ZSxvKz00O2kucHV0SW1hZ2VEYXRhKHIsMCwwKX19KSxlLkltYWdlLmZpbHRlcnMuR3JheXNjYWxlLmZyb21PYmplY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUuSW1hZ2UuZmlsdGVycy5HcmF5c2NhbGV9fShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPXQuZmFicmljfHwodC5mYWJyaWM9e30pO2UuSW1hZ2UuZmlsdGVycy5JbnZlcnQ9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuSW1hZ2UuZmlsdGVycy5CYXNlRmlsdGVyLHt0eXBlOlwiSW52ZXJ0XCIsYXBwbHlUbzpmdW5jdGlvbih0KXt2YXIgZSxpPXQuZ2V0Q29udGV4dChcIjJkXCIpLHI9aS5nZXRJbWFnZURhdGEoMCwwLHQud2lkdGgsdC5oZWlnaHQpLHM9ci5kYXRhLG49cy5sZW5ndGg7Zm9yKGU9MDtuPmU7ZSs9NClzW2VdPTI1NS1zW2VdLHNbZSsxXT0yNTUtc1tlKzFdLHNbZSsyXT0yNTUtc1tlKzJdO2kucHV0SW1hZ2VEYXRhKHIsMCwwKX19KSxlLkltYWdlLmZpbHRlcnMuSW52ZXJ0LmZyb21PYmplY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUuSW1hZ2UuZmlsdGVycy5JbnZlcnR9fShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPXQuZmFicmljfHwodC5mYWJyaWM9e30pLGk9ZS51dGlsLm9iamVjdC5leHRlbmQ7ZS5JbWFnZS5maWx0ZXJzLk1hc2s9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuSW1hZ2UuZmlsdGVycy5CYXNlRmlsdGVyLHt0eXBlOlwiTWFza1wiLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dD10fHx7fSx0aGlzLm1hc2s9dC5tYXNrLHRoaXMuY2hhbm5lbD1bMCwxLDIsM10uaW5kZXhPZih0LmNoYW5uZWwpPi0xP3QuY2hhbm5lbDowfSxhcHBseVRvOmZ1bmN0aW9uKHQpe2lmKHRoaXMubWFzayl7dmFyIGkscj10LmdldENvbnRleHQoXCIyZFwiKSxzPXIuZ2V0SW1hZ2VEYXRhKDAsMCx0LndpZHRoLHQuaGVpZ2h0KSxuPXMuZGF0YSxvPXRoaXMubWFzay5nZXRFbGVtZW50KCksYT1lLnV0aWwuY3JlYXRlQ2FudmFzRWxlbWVudCgpLGg9dGhpcy5jaGFubmVsLGM9cy53aWR0aCpzLmhlaWdodCo0O2Eud2lkdGg9by53aWR0aCxhLmhlaWdodD1vLmhlaWdodCxhLmdldENvbnRleHQoXCIyZFwiKS5kcmF3SW1hZ2UobywwLDAsby53aWR0aCxvLmhlaWdodCk7dmFyIGw9YS5nZXRDb250ZXh0KFwiMmRcIikuZ2V0SW1hZ2VEYXRhKDAsMCxvLndpZHRoLG8uaGVpZ2h0KSx1PWwuZGF0YTtmb3IoaT0wO2M+aTtpKz00KW5baSszXT11W2kraF07ci5wdXRJbWFnZURhdGEocywwLDApfX0sdG9PYmplY3Q6ZnVuY3Rpb24oKXtyZXR1cm4gaSh0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIpLHttYXNrOnRoaXMubWFzay50b09iamVjdCgpLGNoYW5uZWw6dGhpcy5jaGFubmVsfSl9fSksZS5JbWFnZS5maWx0ZXJzLk1hc2suZnJvbU9iamVjdD1mdW5jdGlvbih0LGkpe2UudXRpbC5sb2FkSW1hZ2UodC5tYXNrLnNyYyxmdW5jdGlvbihyKXt0Lm1hc2s9bmV3IGUuSW1hZ2Uocix0Lm1hc2spLGkmJmkobmV3IGUuSW1hZ2UuZmlsdGVycy5NYXNrKHQpKX0pfSxlLkltYWdlLmZpbHRlcnMuTWFzay5hc3luYz0hMH0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPWUudXRpbC5vYmplY3QuZXh0ZW5kO2UuSW1hZ2UuZmlsdGVycy5Ob2lzZT1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5JbWFnZS5maWx0ZXJzLkJhc2VGaWx0ZXIse3R5cGU6XCJOb2lzZVwiLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dD10fHx7fSx0aGlzLm5vaXNlPXQubm9pc2V8fDB9LGFwcGx5VG86ZnVuY3Rpb24odCl7Zm9yKHZhciBlLGk9dC5nZXRDb250ZXh0KFwiMmRcIikscj1pLmdldEltYWdlRGF0YSgwLDAsdC53aWR0aCx0LmhlaWdodCkscz1yLmRhdGEsbj10aGlzLm5vaXNlLG89MCxhPXMubGVuZ3RoO2E+bztvKz00KWU9KC41LU1hdGgucmFuZG9tKCkpKm4sc1tvXSs9ZSxzW28rMV0rPWUsc1tvKzJdKz1lO2kucHV0SW1hZ2VEYXRhKHIsMCwwKX0sdG9PYmplY3Q6ZnVuY3Rpb24oKXtyZXR1cm4gaSh0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIpLHtub2lzZTp0aGlzLm5vaXNlfSl9fSksZS5JbWFnZS5maWx0ZXJzLk5vaXNlLmZyb21PYmplY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlLkltYWdlLmZpbHRlcnMuTm9pc2UodCl9fShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPXQuZmFicmljfHwodC5mYWJyaWM9e30pLGk9ZS51dGlsLm9iamVjdC5leHRlbmQ7ZS5JbWFnZS5maWx0ZXJzLlBpeGVsYXRlPWUudXRpbC5jcmVhdGVDbGFzcyhlLkltYWdlLmZpbHRlcnMuQmFzZUZpbHRlcix7dHlwZTpcIlBpeGVsYXRlXCIsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0PXR8fHt9LHRoaXMuYmxvY2tzaXplPXQuYmxvY2tzaXplfHw0fSxhcHBseVRvOmZ1bmN0aW9uKHQpe3ZhciBlLGkscixzLG4sbyxhLGg9dC5nZXRDb250ZXh0KFwiMmRcIiksYz1oLmdldEltYWdlRGF0YSgwLDAsdC53aWR0aCx0LmhlaWdodCksbD1jLmRhdGEsdT1jLmhlaWdodCxmPWMud2lkdGg7Zm9yKGk9MDt1Pmk7aSs9dGhpcy5ibG9ja3NpemUpZm9yKHI9MDtmPnI7cis9dGhpcy5ibG9ja3NpemUpe2U9NCppKmYrNCpyLHM9bFtlXSxuPWxbZSsxXSxvPWxbZSsyXSxhPWxbZSszXTtmb3IodmFyIGQ9aSxnPWkrdGhpcy5ibG9ja3NpemU7Zz5kO2QrKylmb3IodmFyIHA9cix2PXIrdGhpcy5ibG9ja3NpemU7dj5wO3ArKyllPTQqZCpmKzQqcCxsW2VdPXMsbFtlKzFdPW4sbFtlKzJdPW8sbFtlKzNdPWF9aC5wdXRJbWFnZURhdGEoYywwLDApfSx0b09iamVjdDpmdW5jdGlvbigpe3JldHVybiBpKHRoaXMuY2FsbFN1cGVyKFwidG9PYmplY3RcIikse2Jsb2Nrc2l6ZTp0aGlzLmJsb2Nrc2l6ZX0pfX0pLGUuSW1hZ2UuZmlsdGVycy5QaXhlbGF0ZS5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5JbWFnZS5maWx0ZXJzLlBpeGVsYXRlKHQpfX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPWUudXRpbC5vYmplY3QuZXh0ZW5kO2UuSW1hZ2UuZmlsdGVycy5SZW1vdmVXaGl0ZT1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5JbWFnZS5maWx0ZXJzLkJhc2VGaWx0ZXIse3R5cGU6XCJSZW1vdmVXaGl0ZVwiLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dD10fHx7fSx0aGlzLnRocmVzaG9sZD10LnRocmVzaG9sZHx8MzAsdGhpcy5kaXN0YW5jZT10LmRpc3RhbmNlfHwyMH0sYXBwbHlUbzpmdW5jdGlvbih0KXtmb3IodmFyIGUsaSxyLHM9dC5nZXRDb250ZXh0KFwiMmRcIiksbj1zLmdldEltYWdlRGF0YSgwLDAsdC53aWR0aCx0LmhlaWdodCksbz1uLmRhdGEsYT10aGlzLnRocmVzaG9sZCxoPXRoaXMuZGlzdGFuY2UsYz0yNTUtYSxsPU1hdGguYWJzLHU9MCxmPW8ubGVuZ3RoO2Y+dTt1Kz00KWU9b1t1XSxpPW9bdSsxXSxyPW9bdSsyXSxlPmMmJmk+YyYmcj5jJiZsKGUtaSk8aCYmbChlLXIpPGgmJmwoaS1yKTxoJiYob1t1KzNdPTEpO3MucHV0SW1hZ2VEYXRhKG4sMCwwKX0sdG9PYmplY3Q6ZnVuY3Rpb24oKXtyZXR1cm4gaSh0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIpLHt0aHJlc2hvbGQ6dGhpcy50aHJlc2hvbGQsZGlzdGFuY2U6dGhpcy5kaXN0YW5jZX0pfX0pLGUuSW1hZ2UuZmlsdGVycy5SZW1vdmVXaGl0ZS5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5JbWFnZS5maWx0ZXJzLlJlbW92ZVdoaXRlKHQpfX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KTtlLkltYWdlLmZpbHRlcnMuU2VwaWE9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuSW1hZ2UuZmlsdGVycy5CYXNlRmlsdGVyLHt0eXBlOlwiU2VwaWFcIixhcHBseVRvOmZ1bmN0aW9uKHQpe3ZhciBlLGkscj10LmdldENvbnRleHQoXCIyZFwiKSxzPXIuZ2V0SW1hZ2VEYXRhKDAsMCx0LndpZHRoLHQuaGVpZ2h0KSxuPXMuZGF0YSxvPW4ubGVuZ3RoO2ZvcihlPTA7bz5lO2UrPTQpaT0uMypuW2VdKy41OSpuW2UrMV0rLjExKm5bZSsyXSxuW2VdPWkrMTAwLG5bZSsxXT1pKzUwLG5bZSsyXT1pKzI1NTtyLnB1dEltYWdlRGF0YShzLDAsMCl9fSksZS5JbWFnZS5maWx0ZXJzLlNlcGlhLmZyb21PYmplY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUuSW1hZ2UuZmlsdGVycy5TZXBpYX19KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSk7ZS5JbWFnZS5maWx0ZXJzLlNlcGlhMj1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5JbWFnZS5maWx0ZXJzLkJhc2VGaWx0ZXIse3R5cGU6XCJTZXBpYTJcIixhcHBseVRvOmZ1bmN0aW9uKHQpe3ZhciBlLGkscixzLG49dC5nZXRDb250ZXh0KFwiMmRcIiksbz1uLmdldEltYWdlRGF0YSgwLDAsdC53aWR0aCx0LmhlaWdodCksYT1vLmRhdGEsaD1hLmxlbmd0aDtmb3IoZT0wO2g+ZTtlKz00KWk9YVtlXSxyPWFbZSsxXSxzPWFbZSsyXSxhW2VdPSguMzkzKmkrLjc2OSpyKy4xODkqcykvMS4zNTEsYVtlKzFdPSguMzQ5KmkrLjY4NipyKy4xNjgqcykvMS4yMDMsYVtlKzJdPSguMjcyKmkrLjUzNCpyKy4xMzEqcykvMi4xNDtuLnB1dEltYWdlRGF0YShvLDAsMCl9fSksZS5JbWFnZS5maWx0ZXJzLlNlcGlhMi5mcm9tT2JqZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlLkltYWdlLmZpbHRlcnMuU2VwaWEyfX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPWUudXRpbC5vYmplY3QuZXh0ZW5kO2UuSW1hZ2UuZmlsdGVycy5UaW50PWUudXRpbC5jcmVhdGVDbGFzcyhlLkltYWdlLmZpbHRlcnMuQmFzZUZpbHRlcix7dHlwZTpcIlRpbnRcIixpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3Q9dHx8e30sdGhpcy5jb2xvcj10LmNvbG9yfHxcIiMwMDAwMDBcIix0aGlzLm9wYWNpdHk9XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHQub3BhY2l0eT90Lm9wYWNpdHk6bmV3IGUuQ29sb3IodGhpcy5jb2xvcikuZ2V0QWxwaGEoKX0sYXBwbHlUbzpmdW5jdGlvbih0KXt2YXIgaSxyLHMsbixvLGEsaCxjLGwsdT10LmdldENvbnRleHQoXCIyZFwiKSxmPXUuZ2V0SW1hZ2VEYXRhKDAsMCx0LndpZHRoLHQuaGVpZ2h0KSxkPWYuZGF0YSxnPWQubGVuZ3RoO2ZvcihsPW5ldyBlLkNvbG9yKHRoaXMuY29sb3IpLmdldFNvdXJjZSgpLHI9bFswXSp0aGlzLm9wYWNpdHkscz1sWzFdKnRoaXMub3BhY2l0eSxuPWxbMl0qdGhpcy5vcGFjaXR5LGM9MS10aGlzLm9wYWNpdHksaT0wO2c+aTtpKz00KW89ZFtpXSxhPWRbaSsxXSxoPWRbaSsyXSxkW2ldPXIrbypjLGRbaSsxXT1zK2EqYyxkW2krMl09bitoKmM7dS5wdXRJbWFnZURhdGEoZiwwLDApfSx0b09iamVjdDpmdW5jdGlvbigpe3JldHVybiBpKHRoaXMuY2FsbFN1cGVyKFwidG9PYmplY3RcIikse2NvbG9yOnRoaXMuY29sb3Isb3BhY2l0eTp0aGlzLm9wYWNpdHl9KX19KSxlLkltYWdlLmZpbHRlcnMuVGludC5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5JbWFnZS5maWx0ZXJzLlRpbnQodCl9fShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPXQuZmFicmljfHwodC5mYWJyaWM9e30pLGk9ZS51dGlsLm9iamVjdC5leHRlbmQ7ZS5JbWFnZS5maWx0ZXJzLk11bHRpcGx5PWUudXRpbC5jcmVhdGVDbGFzcyhlLkltYWdlLmZpbHRlcnMuQmFzZUZpbHRlcix7dHlwZTpcIk11bHRpcGx5XCIsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0PXR8fHt9LHRoaXMuY29sb3I9dC5jb2xvcnx8XCIjMDAwMDAwXCJ9LGFwcGx5VG86ZnVuY3Rpb24odCl7dmFyIGkscixzPXQuZ2V0Q29udGV4dChcIjJkXCIpLG49cy5nZXRJbWFnZURhdGEoMCwwLHQud2lkdGgsdC5oZWlnaHQpLG89bi5kYXRhLGE9by5sZW5ndGg7Zm9yKHI9bmV3IGUuQ29sb3IodGhpcy5jb2xvcikuZ2V0U291cmNlKCksaT0wO2E+aTtpKz00KW9baV0qPXJbMF0vMjU1LG9baSsxXSo9clsxXS8yNTUsb1tpKzJdKj1yWzJdLzI1NTtzLnB1dEltYWdlRGF0YShuLDAsMCl9LHRvT2JqZWN0OmZ1bmN0aW9uKCl7cmV0dXJuIGkodGhpcy5jYWxsU3VwZXIoXCJ0b09iamVjdFwiKSx7Y29sb3I6dGhpcy5jb2xvcn0pfX0pLGUuSW1hZ2UuZmlsdGVycy5NdWx0aXBseS5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5JbWFnZS5maWx0ZXJzLk11bHRpcGx5KHQpfX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpYztlLkltYWdlLmZpbHRlcnMuQmxlbmQ9ZS51dGlsLmNyZWF0ZUNsYXNzKHt0eXBlOlwiQmxlbmRcIixpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3Q9dHx8e30sdGhpcy5jb2xvcj10LmNvbG9yfHxcIiMwMDBcIix0aGlzLmltYWdlPXQuaW1hZ2V8fCExLHRoaXMubW9kZT10Lm1vZGV8fFwibXVsdGlwbHlcIix0aGlzLmFscGhhPXQuYWxwaGF8fDF9LGFwcGx5VG86ZnVuY3Rpb24odCl7dmFyIGkscixzLG4sbyxhLGgsYyxsLHUsZj10LmdldENvbnRleHQoXCIyZFwiKSxkPWYuZ2V0SW1hZ2VEYXRhKDAsMCx0LndpZHRoLHQuaGVpZ2h0KSxnPWQuZGF0YSxwPSExO2lmKHRoaXMuaW1hZ2Upe3A9ITA7dmFyIHY9ZS51dGlsLmNyZWF0ZUNhbnZhc0VsZW1lbnQoKTt2LndpZHRoPXRoaXMuaW1hZ2Uud2lkdGgsdi5oZWlnaHQ9dGhpcy5pbWFnZS5oZWlnaHQ7dmFyIGI9bmV3IGUuU3RhdGljQ2FudmFzKHYpO2IuYWRkKHRoaXMuaW1hZ2UpO3ZhciBtPWIuZ2V0Q29udGV4dChcIjJkXCIpO3U9bS5nZXRJbWFnZURhdGEoMCwwLGIud2lkdGgsYi5oZWlnaHQpLmRhdGF9ZWxzZSB1PW5ldyBlLkNvbG9yKHRoaXMuY29sb3IpLmdldFNvdXJjZSgpLGk9dVswXSp0aGlzLmFscGhhLHI9dVsxXSp0aGlzLmFscGhhLHM9dVsyXSp0aGlzLmFscGhhO2Zvcih2YXIgeT0wLF89Zy5sZW5ndGg7Xz55O3krPTQpc3dpdGNoKG49Z1t5XSxvPWdbeSsxXSxhPWdbeSsyXSxwJiYoaT11W3ldKnRoaXMuYWxwaGEscj11W3krMV0qdGhpcy5hbHBoYSxzPXVbeSsyXSp0aGlzLmFscGhhKSx0aGlzLm1vZGUpe2Nhc2VcIm11bHRpcGx5XCI6Z1t5XT1uKmkvMjU1LGdbeSsxXT1vKnIvMjU1LGdbeSsyXT1hKnMvMjU1O2JyZWFrO2Nhc2VcInNjcmVlblwiOmdbeV09MS0oMS1uKSooMS1pKSxnW3krMV09MS0oMS1vKSooMS1yKSxnW3krMl09MS0oMS1hKSooMS1zKTticmVhaztjYXNlXCJhZGRcIjpnW3ldPU1hdGgubWluKDI1NSxuK2kpLGdbeSsxXT1NYXRoLm1pbigyNTUsbytyKSxnW3krMl09TWF0aC5taW4oMjU1LGErcyk7YnJlYWs7Y2FzZVwiZGlmZlwiOmNhc2VcImRpZmZlcmVuY2VcIjpnW3ldPU1hdGguYWJzKG4taSksZ1t5KzFdPU1hdGguYWJzKG8tciksZ1t5KzJdPU1hdGguYWJzKGEtcyk7YnJlYWs7Y2FzZVwic3VidHJhY3RcIjpoPW4taSxjPW8tcixsPWEtcyxnW3ldPTA+aD8wOmgsZ1t5KzFdPTA+Yz8wOmMsZ1t5KzJdPTA+bD8wOmw7YnJlYWs7Y2FzZVwiZGFya2VuXCI6Z1t5XT1NYXRoLm1pbihuLGkpLGdbeSsxXT1NYXRoLm1pbihvLHIpLGdbeSsyXT1NYXRoLm1pbihhLHMpO2JyZWFrO2Nhc2VcImxpZ2h0ZW5cIjpnW3ldPU1hdGgubWF4KG4saSksZ1t5KzFdPU1hdGgubWF4KG8sciksZ1t5KzJdPU1hdGgubWF4KGEscyl9Zi5wdXRJbWFnZURhdGEoZCwwLDApfSx0b09iamVjdDpmdW5jdGlvbigpe3JldHVybntjb2xvcjp0aGlzLmNvbG9yLGltYWdlOnRoaXMuaW1hZ2UsbW9kZTp0aGlzLm1vZGUsYWxwaGE6dGhpcy5hbHBoYX19fSksZS5JbWFnZS5maWx0ZXJzLkJsZW5kLmZyb21PYmplY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlLkltYWdlLmZpbHRlcnMuQmxlbmQodCl9fShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPXQuZmFicmljfHwodC5mYWJyaWM9e30pLGk9TWF0aC5wb3cscj1NYXRoLmZsb29yLHM9TWF0aC5zcXJ0LG49TWF0aC5hYnMsbz1NYXRoLm1heCxhPU1hdGgucm91bmQsaD1NYXRoLnNpbixjPU1hdGguY2VpbDtlLkltYWdlLmZpbHRlcnMuUmVzaXplPWUudXRpbC5jcmVhdGVDbGFzcyhlLkltYWdlLmZpbHRlcnMuQmFzZUZpbHRlcix7dHlwZTpcIlJlc2l6ZVwiLHJlc2l6ZVR5cGU6XCJoZXJtaXRlXCIsc2NhbGVYOjAsc2NhbGVZOjAsbGFuY3pvc0xvYmVzOjMsYXBwbHlUbzpmdW5jdGlvbih0LGUsaSl7dGhpcy5yY3BTY2FsZVg9MS9lLHRoaXMucmNwU2NhbGVZPTEvaTt2YXIgcixzPXQud2lkdGgsbj10LmhlaWdodCxvPWEocyplKSxoPWEobippKTtcInNsaWNlSGFja1wiPT09dGhpcy5yZXNpemVUeXBlJiYocj10aGlzLnNsaWNlQnlUd28odCxzLG4sbyxoKSksXCJoZXJtaXRlXCI9PT10aGlzLnJlc2l6ZVR5cGUmJihyPXRoaXMuaGVybWl0ZUZhc3RSZXNpemUodCxzLG4sbyxoKSksXCJiaWxpbmVhclwiPT09dGhpcy5yZXNpemVUeXBlJiYocj10aGlzLmJpbGluZWFyRmlsdGVyaW5nKHQscyxuLG8saCkpLFwibGFuY3pvc1wiPT09dGhpcy5yZXNpemVUeXBlJiYocj10aGlzLmxhbmN6b3NSZXNpemUodCxzLG4sbyxoKSksdC53aWR0aD1vLHQuaGVpZ2h0PWgsdC5nZXRDb250ZXh0KFwiMmRcIikucHV0SW1hZ2VEYXRhKHIsMCwwKX0sc2xpY2VCeVR3bzpmdW5jdGlvbih0LGkscyxuLGEpe3ZhciBoLGM9dC5nZXRDb250ZXh0KFwiMmRcIiksbD0uNSx1PS41LGY9MSxkPTEsZz0hMSxwPSExLHY9aSxiPXMsbT1lLnV0aWwuY3JlYXRlQ2FudmFzRWxlbWVudCgpLHk9bS5nZXRDb250ZXh0KFwiMmRcIik7Zm9yKG49cihuKSxhPXIoYSksbS53aWR0aD1vKG4saSksbS5oZWlnaHQ9byhhLHMpLG4+aSYmKGw9MixmPS0xKSxhPnMmJih1PTIsZD0tMSksaD1jLmdldEltYWdlRGF0YSgwLDAsaSxzKSx0LndpZHRoPW8obixpKSx0LmhlaWdodD1vKGEscyksYy5wdXRJbWFnZURhdGEoaCwwLDApOyFnfHwhcDspaT12LHM9YixuKmY8cih2KmwqZik/dj1yKHYqbCk6KHY9bixnPSEwKSxhKmQ8cihiKnUqZCk/Yj1yKGIqdSk6KGI9YSxwPSEwKSxoPWMuZ2V0SW1hZ2VEYXRhKDAsMCxpLHMpLHkucHV0SW1hZ2VEYXRhKGgsMCwwKSxjLmNsZWFyUmVjdCgwLDAsdixiKSxjLmRyYXdJbWFnZShtLDAsMCxpLHMsMCwwLHYsYik7cmV0dXJuIGMuZ2V0SW1hZ2VEYXRhKDAsMCxuLGEpfSxsYW5jem9zUmVzaXplOmZ1bmN0aW9uKHQsZSxvLGEsbCl7ZnVuY3Rpb24gdSh0KXtyZXR1cm4gZnVuY3Rpb24oZSl7aWYoZT50KXJldHVybiAwO2lmKGUqPU1hdGguUEksbihlKTwxZS0xNilyZXR1cm4gMTt2YXIgaT1lL3Q7cmV0dXJuIGgoZSkqaChpKS9lL2l9fWZ1bmN0aW9uIGYodCl7dmFyIGgsYyx1LGQsZyxqLEEsUCxFLE0sSTtmb3IoVC54PSh0Ky41KSp5LGsueD1yKFQueCksaD0wO2w+aDtoKyspe2ZvcihULnk9KGgrLjUpKl8say55PXIoVC55KSxnPTAsaj0wLEE9MCxQPTAsRT0wLGM9ay54LVM7Yzw9ay54K1M7YysrKWlmKCEoMD5jfHxjPj1lKSl7TT1yKDFlMypuKGMtVC54KSksT1tNXXx8KE9bTV09e30pO2Zvcih2YXIgRD1rLnktdztEPD1rLnkrdztEKyspMD5EfHxEPj1vfHwoST1yKDFlMypuKEQtVC55KSksT1tNXVtJXXx8KE9bTV1bSV09bShzKGkoTSp4LDIpK2koSSpDLDIpKS8xZTMpKSx1PU9bTV1bSV0sdT4wJiYoZD00KihEKmUrYyksZys9dSxqKz11KnZbZF0sQSs9dSp2W2QrMV0sUCs9dSp2W2QrMl0sRSs9dSp2W2QrM10pKX1kPTQqKGgqYSt0KSxiW2RdPWovZyxiW2QrMV09QS9nLGJbZCsyXT1QL2csYltkKzNdPUUvZ31yZXR1cm4rK3Q8YT9mKHQpOnB9dmFyIGQ9dC5nZXRDb250ZXh0KFwiMmRcIiksZz1kLmdldEltYWdlRGF0YSgwLDAsZSxvKSxwPWQuZ2V0SW1hZ2VEYXRhKDAsMCxhLGwpLHY9Zy5kYXRhLGI9cC5kYXRhLG09dSh0aGlzLmxhbmN6b3NMb2JlcykseT10aGlzLnJjcFNjYWxlWCxfPXRoaXMucmNwU2NhbGVZLHg9Mi90aGlzLnJjcFNjYWxlWCxDPTIvdGhpcy5yY3BTY2FsZVksUz1jKHkqdGhpcy5sYW5jem9zTG9iZXMvMiksdz1jKF8qdGhpcy5sYW5jem9zTG9iZXMvMiksTz17fSxUPXt9LGs9e307cmV0dXJuIGYoMCl9LGJpbGluZWFyRmlsdGVyaW5nOmZ1bmN0aW9uKHQsZSxpLHMsbil7dmFyIG8sYSxoLGMsbCx1LGYsZCxnLHAsdixiLG0seT0wLF89dGhpcy5yY3BTY2FsZVgseD10aGlzLnJjcFNjYWxlWSxDPXQuZ2V0Q29udGV4dChcIjJkXCIpLFM9NCooZS0xKSx3PUMuZ2V0SW1hZ2VEYXRhKDAsMCxlLGkpLE89dy5kYXRhLFQ9Qy5nZXRJbWFnZURhdGEoMCwwLHMsbiksaz1ULmRhdGE7Zm9yKGY9MDtuPmY7ZisrKWZvcihkPTA7cz5kO2QrKylmb3IobD1yKF8qZCksdT1yKHgqZiksZz1fKmQtbCxwPXgqZi11LG09NCoodSplK2wpLHY9MDs0PnY7disrKW89T1ttK3ZdLGE9T1ttKzQrdl0saD1PW20rUyt2XSxjPU9bbStTKzQrdl0sYj1vKigxLWcpKigxLXApK2EqZyooMS1wKStoKnAqKDEtZykrYypnKnAsa1t5KytdPWI7cmV0dXJuIFR9LGhlcm1pdGVGYXN0UmVzaXplOmZ1bmN0aW9uKHQsZSxpLG8sYSl7Zm9yKHZhciBoPXRoaXMucmNwU2NhbGVYLGw9dGhpcy5yY3BTY2FsZVksdT1jKGgvMiksZj1jKGwvMiksZD10LmdldENvbnRleHQoXCIyZFwiKSxnPWQuZ2V0SW1hZ2VEYXRhKDAsMCxlLGkpLHA9Zy5kYXRhLHY9ZC5nZXRJbWFnZURhdGEoMCwwLG8sYSksYj12LmRhdGEsbT0wO2E+bTttKyspZm9yKHZhciB5PTA7bz55O3krKyl7Zm9yKHZhciBfPTQqKHkrbSpvKSx4PTAsQz0wLFM9MCx3PTAsTz0wLFQ9MCxrPTAsaj0obSsuNSkqbCxBPXIobSpsKTsobSsxKSpsPkE7QSsrKWZvcih2YXIgUD1uKGotKEErLjUpKS9mLEU9KHkrLjUpKmgsTT1QKlAsST1yKHkqaCk7KHkrMSkqaD5JO0krKyl7dmFyIEQ9bihFLShJKy41KSkvdSxMPXMoTStEKkQpO0w+MSYmLTE+THx8KHg9MipMKkwqTC0zKkwqTCsxLHg+MCYmKEQ9NCooSStBKmUpLGsrPXgqcFtEKzNdLFMrPXgscFtEKzNdPDI1NSYmKHg9eCpwW0QrM10vMjUwKSx3Kz14KnBbRF0sTys9eCpwW0QrMV0sVCs9eCpwW0QrMl0sQys9eCkpfWJbX109dy9DLGJbXysxXT1PL0MsYltfKzJdPVQvQyxiW18rM109ay9TfXJldHVybiB2fSx0b09iamVjdDpmdW5jdGlvbigpe3JldHVybnt0eXBlOnRoaXMudHlwZSxzY2FsZVg6dGhpcy5zY2FsZVgsc2NhbGVZOnRoaXMuc2NhbGVZLHJlc2l6ZVR5cGU6dGhpcy5yZXNpemVUeXBlLGxhbmN6b3NMb2Jlczp0aGlzLmxhbmN6b3NMb2Jlc319fSksZS5JbWFnZS5maWx0ZXJzLlJlc2l6ZS5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5JbWFnZS5maWx0ZXJzLlJlc2l6ZSh0KX19KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSksaT1lLnV0aWwub2JqZWN0LmV4dGVuZCxyPWUudXRpbC5vYmplY3QuY2xvbmUscz1lLnV0aWwudG9GaXhlZCxuPWUuU3RhdGljQ2FudmFzLnN1cHBvcnRzKFwic2V0TGluZURhc2hcIiksbz1lLk9iamVjdC5OVU1fRlJBQ1RJT05fRElHSVRTO2lmKGUuVGV4dClyZXR1cm4gdm9pZCBlLndhcm4oXCJmYWJyaWMuVGV4dCBpcyBhbHJlYWR5IGRlZmluZWRcIik7dmFyIGE9ZS5PYmplY3QucHJvdG90eXBlLnN0YXRlUHJvcGVydGllcy5jb25jYXQoKTthLnB1c2goXCJmb250RmFtaWx5XCIsXCJmb250V2VpZ2h0XCIsXCJmb250U2l6ZVwiLFwidGV4dFwiLFwidGV4dERlY29yYXRpb25cIixcInRleHRBbGlnblwiLFwiZm9udFN0eWxlXCIsXCJsaW5lSGVpZ2h0XCIsXCJ0ZXh0QmFja2dyb3VuZENvbG9yXCIpLGUuVGV4dD1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5PYmplY3Qse19kaW1lbnNpb25BZmZlY3RpbmdQcm9wczp7Zm9udFNpemU6ITAsZm9udFdlaWdodDohMCxmb250RmFtaWx5OiEwLGZvbnRTdHlsZTohMCxsaW5lSGVpZ2h0OiEwLHN0cm9rZTohMCxzdHJva2VXaWR0aDohMCx0ZXh0OiEwLHRleHRBbGlnbjohMH0sX3JlTmV3bGluZTovXFxyP1xcbi8sdHlwZTpcInRleHRcIixmb250U2l6ZTo0MCxmb250V2VpZ2h0Olwibm9ybWFsXCIsZm9udEZhbWlseTpcIlRpbWVzIE5ldyBSb21hblwiLHRleHREZWNvcmF0aW9uOlwiXCIsdGV4dEFsaWduOlwibGVmdFwiLGZvbnRTdHlsZTpcIlwiLGxpbmVIZWlnaHQ6MS4xNix0ZXh0QmFja2dyb3VuZENvbG9yOlwiXCIsc3RhdGVQcm9wZXJ0aWVzOmEsc3Ryb2tlOm51bGwsc2hhZG93Om51bGwsX2ZvbnRTaXplRnJhY3Rpb246LjI1LF9mb250U2l6ZU11bHQ6MS4xMyxpbml0aWFsaXplOmZ1bmN0aW9uKHQsZSl7ZT1lfHx7fSx0aGlzLnRleHQ9dCx0aGlzLl9fc2tpcERpbWVuc2lvbj0hMCx0aGlzLnNldE9wdGlvbnMoZSksdGhpcy5fX3NraXBEaW1lbnNpb249ITEsdGhpcy5faW5pdERpbWVuc2lvbnMoKX0sX2luaXREaW1lbnNpb25zOmZ1bmN0aW9uKHQpe2lmKCF0aGlzLl9fc2tpcERpbWVuc2lvbil7dHx8KHQ9ZS51dGlsLmNyZWF0ZUNhbnZhc0VsZW1lbnQoKS5nZXRDb250ZXh0KFwiMmRcIiksdGhpcy5fc2V0VGV4dFN0eWxlcyh0KSksdGhpcy5fdGV4dExpbmVzPXRoaXMudGV4dC5zcGxpdCh0aGlzLl9yZU5ld2xpbmUpLHRoaXMuX2NsZWFyQ2FjaGUoKTt2YXIgaT10aGlzLnRleHRBbGlnbjt0aGlzLnRleHRBbGlnbj1cImxlZnRcIix0aGlzLndpZHRoPXRoaXMuX2dldFRleHRXaWR0aCh0KSx0aGlzLnRleHRBbGlnbj1pLHRoaXMuaGVpZ2h0PXRoaXMuX2dldFRleHRIZWlnaHQodCl9fSx0b1N0cmluZzpmdW5jdGlvbigpe3JldHVyblwiIzxmYWJyaWMuVGV4dCAoXCIrdGhpcy5jb21wbGV4aXR5KCkrJyk6IHsgXCJ0ZXh0XCI6IFwiJyt0aGlzLnRleHQrJ1wiLCBcImZvbnRGYW1pbHlcIjogXCInK3RoaXMuZm9udEZhbWlseSsnXCIgfT4nfSxfcmVuZGVyOmZ1bmN0aW9uKHQpe3RoaXMuY2xpcFRvJiZlLnV0aWwuY2xpcENvbnRleHQodGhpcyx0KSx0aGlzLl9yZW5kZXJUZXh0QmFja2dyb3VuZCh0KSx0aGlzLl9yZW5kZXJUZXh0KHQpLHRoaXMuX3JlbmRlclRleHREZWNvcmF0aW9uKHQpLHRoaXMuY2xpcFRvJiZ0LnJlc3RvcmUoKX0sX3JlbmRlclRleHQ6ZnVuY3Rpb24odCl7dC5zYXZlKCksdGhpcy5fdHJhbnNsYXRlRm9yVGV4dEFsaWduKHQpLHRoaXMuX3NldE9wYWNpdHkodCksdGhpcy5fc2V0U2hhZG93KHQpLHRoaXMuX3NldHVwQ29tcG9zaXRlT3BlcmF0aW9uKHQpLHRoaXMuX3JlbmRlclRleHRGaWxsKHQpLHRoaXMuX3JlbmRlclRleHRTdHJva2UodCksdC5yZXN0b3JlKCl9LF90cmFuc2xhdGVGb3JUZXh0QWxpZ246ZnVuY3Rpb24odCl7XCJsZWZ0XCIhPT10aGlzLnRleHRBbGlnbiYmXCJqdXN0aWZ5XCIhPT10aGlzLnRleHRBbGlnbiYmdC50cmFuc2xhdGUoXCJjZW50ZXJcIj09PXRoaXMudGV4dEFsaWduP3RoaXMud2lkdGgvMjp0aGlzLndpZHRoLDApfSxfc2V0VGV4dFN0eWxlczpmdW5jdGlvbih0KXt0LnRleHRCYXNlbGluZT1cImFscGhhYmV0aWNcIix0aGlzLnNraXBUZXh0QWxpZ258fCh0LnRleHRBbGlnbj10aGlzLnRleHRBbGlnbiksdC5mb250PXRoaXMuX2dldEZvbnREZWNsYXJhdGlvbigpfSxfZ2V0VGV4dEhlaWdodDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl90ZXh0TGluZXMubGVuZ3RoKnRoaXMuX2dldEhlaWdodE9mTGluZSgpfSxfZ2V0VGV4dFdpZHRoOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10aGlzLl9nZXRMaW5lV2lkdGgodCwwKSxpPTEscj10aGlzLl90ZXh0TGluZXMubGVuZ3RoO3I+aTtpKyspe3ZhciBzPXRoaXMuX2dldExpbmVXaWR0aCh0LGkpO3M+ZSYmKGU9cyl9cmV0dXJuIGV9LF9yZW5kZXJDaGFyczpmdW5jdGlvbih0LGUsaSxyLHMpe3ZhciBuPXQuc2xpY2UoMCwtNCk7aWYodGhpc1tuXS50b0xpdmUpe3ZhciBvPS10aGlzLndpZHRoLzIrdGhpc1tuXS5vZmZzZXRYfHwwLGE9LXRoaXMuaGVpZ2h0LzIrdGhpc1tuXS5vZmZzZXRZfHwwO2Uuc2F2ZSgpLGUudHJhbnNsYXRlKG8sYSksci09byxzLT1hfWVbdF0oaSxyLHMpLHRoaXNbbl0udG9MaXZlJiZlLnJlc3RvcmUoKX0sX3JlbmRlclRleHRMaW5lOmZ1bmN0aW9uKHQsZSxpLHIscyxuKXtpZihzLT10aGlzLmZvbnRTaXplKnRoaXMuX2ZvbnRTaXplRnJhY3Rpb24sXCJqdXN0aWZ5XCIhPT10aGlzLnRleHRBbGlnbilyZXR1cm4gdm9pZCB0aGlzLl9yZW5kZXJDaGFycyh0LGUsaSxyLHMsbik7dmFyIG89dGhpcy5fZ2V0TGluZVdpZHRoKGUsbiksYT10aGlzLndpZHRoO2lmKGE+PW8pZm9yKHZhciBoPWkuc3BsaXQoL1xccysvKSxjPXRoaXMuX2dldFdpZHRoT2ZXb3JkcyhlLGksbiksbD1hLWMsdT1oLmxlbmd0aC0xLGY9bC91LGQ9MCxnPTAscD1oLmxlbmd0aDtwPmc7ZysrKXRoaXMuX3JlbmRlckNoYXJzKHQsZSxoW2ddLHIrZCxzLG4pLGQrPWUubWVhc3VyZVRleHQoaFtnXSkud2lkdGgrZjtlbHNlIHRoaXMuX3JlbmRlckNoYXJzKHQsZSxpLHIscyxuKX0sX2dldFdpZHRoT2ZXb3JkczpmdW5jdGlvbih0LGUpe3JldHVybiB0Lm1lYXN1cmVUZXh0KGUucmVwbGFjZSgvXFxzKy9nLFwiXCIpKS53aWR0aH0sX2dldExlZnRPZmZzZXQ6ZnVuY3Rpb24oKXtyZXR1cm4tdGhpcy53aWR0aC8yfSxfZ2V0VG9wT2Zmc2V0OmZ1bmN0aW9uKCl7cmV0dXJuLXRoaXMuaGVpZ2h0LzJ9LF9yZW5kZXJUZXh0RmlsbDpmdW5jdGlvbih0KXtpZih0aGlzLmZpbGx8fHRoaXMuX3NraXBGaWxsU3Ryb2tlQ2hlY2spZm9yKHZhciBlPTAsaT0wLHI9dGhpcy5fdGV4dExpbmVzLmxlbmd0aDtyPmk7aSsrKXt2YXIgcz10aGlzLl9nZXRIZWlnaHRPZkxpbmUodCxpKSxuPXMvdGhpcy5saW5lSGVpZ2h0O3RoaXMuX3JlbmRlclRleHRMaW5lKFwiZmlsbFRleHRcIix0LHRoaXMuX3RleHRMaW5lc1tpXSx0aGlzLl9nZXRMZWZ0T2Zmc2V0KCksdGhpcy5fZ2V0VG9wT2Zmc2V0KCkrZStuLGkpLGUrPXN9fSxfcmVuZGVyVGV4dFN0cm9rZTpmdW5jdGlvbih0KXtpZih0aGlzLnN0cm9rZSYmMCE9PXRoaXMuc3Ryb2tlV2lkdGh8fHRoaXMuX3NraXBGaWxsU3Ryb2tlQ2hlY2spe3ZhciBlPTA7dGhpcy5zaGFkb3cmJiF0aGlzLnNoYWRvdy5hZmZlY3RTdHJva2UmJnRoaXMuX3JlbW92ZVNoYWRvdyh0KSx0LnNhdmUoKSx0aGlzLnN0cm9rZURhc2hBcnJheSYmKDEmdGhpcy5zdHJva2VEYXNoQXJyYXkubGVuZ3RoJiZ0aGlzLnN0cm9rZURhc2hBcnJheS5wdXNoLmFwcGx5KHRoaXMuc3Ryb2tlRGFzaEFycmF5LHRoaXMuc3Ryb2tlRGFzaEFycmF5KSxuJiZ0LnNldExpbmVEYXNoKHRoaXMuc3Ryb2tlRGFzaEFycmF5KSksdC5iZWdpblBhdGgoKTtmb3IodmFyIGk9MCxyPXRoaXMuX3RleHRMaW5lcy5sZW5ndGg7cj5pO2krKyl7dmFyIHM9dGhpcy5fZ2V0SGVpZ2h0T2ZMaW5lKHQsaSksbz1zL3RoaXMubGluZUhlaWdodDt0aGlzLl9yZW5kZXJUZXh0TGluZShcInN0cm9rZVRleHRcIix0LHRoaXMuX3RleHRMaW5lc1tpXSx0aGlzLl9nZXRMZWZ0T2Zmc2V0KCksdGhpcy5fZ2V0VG9wT2Zmc2V0KCkrZStvLGkpLGUrPXN9dC5jbG9zZVBhdGgoKSx0LnJlc3RvcmUoKX19LF9nZXRIZWlnaHRPZkxpbmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mb250U2l6ZSp0aGlzLl9mb250U2l6ZU11bHQqdGhpcy5saW5lSGVpZ2h0fSxfcmVuZGVyVGV4dEJhY2tncm91bmQ6ZnVuY3Rpb24odCl7dGhpcy5fcmVuZGVyVGV4dEJveEJhY2tncm91bmQodCksdGhpcy5fcmVuZGVyVGV4dExpbmVzQmFja2dyb3VuZCh0KX0sX3JlbmRlclRleHRCb3hCYWNrZ3JvdW5kOmZ1bmN0aW9uKHQpe3RoaXMuYmFja2dyb3VuZENvbG9yJiYodC5zYXZlKCksdC5maWxsU3R5bGU9dGhpcy5iYWNrZ3JvdW5kQ29sb3IsdC5maWxsUmVjdCh0aGlzLl9nZXRMZWZ0T2Zmc2V0KCksdGhpcy5fZ2V0VG9wT2Zmc2V0KCksdGhpcy53aWR0aCx0aGlzLmhlaWdodCksdC5yZXN0b3JlKCkpfSxfcmVuZGVyVGV4dExpbmVzQmFja2dyb3VuZDpmdW5jdGlvbih0KXt2YXIgZT0wLGk9dGhpcy5fZ2V0SGVpZ2h0T2ZMaW5lKCk7aWYodGhpcy50ZXh0QmFja2dyb3VuZENvbG9yKXt0LnNhdmUoKSx0LmZpbGxTdHlsZT10aGlzLnRleHRCYWNrZ3JvdW5kQ29sb3I7Zm9yKHZhciByPTAscz10aGlzLl90ZXh0TGluZXMubGVuZ3RoO3M+cjtyKyspe2lmKFwiXCIhPT10aGlzLl90ZXh0TGluZXNbcl0pe3ZhciBuPXRoaXMuX2dldExpbmVXaWR0aCh0LHIpLG89dGhpcy5fZ2V0TGluZUxlZnRPZmZzZXQobik7dC5maWxsUmVjdCh0aGlzLl9nZXRMZWZ0T2Zmc2V0KCkrbyx0aGlzLl9nZXRUb3BPZmZzZXQoKStlLG4sdGhpcy5mb250U2l6ZSp0aGlzLl9mb250U2l6ZU11bHQpfWUrPWl9dC5yZXN0b3JlKCl9fSxfZ2V0TGluZUxlZnRPZmZzZXQ6ZnVuY3Rpb24odCl7cmV0dXJuXCJjZW50ZXJcIj09PXRoaXMudGV4dEFsaWduPyh0aGlzLndpZHRoLXQpLzI6XCJyaWdodFwiPT09dGhpcy50ZXh0QWxpZ24/dGhpcy53aWR0aC10OjB9LF9jbGVhckNhY2hlOmZ1bmN0aW9uKCl7dGhpcy5fX2xpbmVXaWR0aHM9W10sdGhpcy5fX2xpbmVIZWlnaHRzPVtdLHRoaXMuX19saW5lT2Zmc2V0cz1bXX0sX3Nob3VsZENsZWFyQ2FjaGU6ZnVuY3Rpb24oKXt2YXIgdD0hMTtmb3IodmFyIGUgaW4gdGhpcy5fZGltZW5zaW9uQWZmZWN0aW5nUHJvcHMpdGhpc1tcIl9fXCIrZV0hPT10aGlzW2VdJiYodGhpc1tcIl9fXCIrZV09dGhpc1tlXSx0PSEwKTtyZXR1cm4gdH0sX2dldExpbmVXaWR0aDpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLl9fbGluZVdpZHRoc1tlXT90aGlzLl9fbGluZVdpZHRoc1tlXToodGhpcy5fX2xpbmVXaWR0aHNbZV09dC5tZWFzdXJlVGV4dCh0aGlzLl90ZXh0TGluZXNbZV0pLndpZHRoLHRoaXMuX19saW5lV2lkdGhzW2VdKX0sX3JlbmRlclRleHREZWNvcmF0aW9uOmZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoZSl7dmFyIHMsbixvLGEsaD0wO2ZvcihzPTAsbj1yLl90ZXh0TGluZXMubGVuZ3RoO24+cztzKyspe3ZhciBjPXIuX2dldExpbmVXaWR0aCh0LHMpLGw9ci5fZ2V0TGluZUxlZnRPZmZzZXQoYyksdT1yLl9nZXRIZWlnaHRPZkxpbmUodCxzKTtmb3Iobz0wLGE9ZS5sZW5ndGg7YT5vO28rKyl0LmZpbGxSZWN0KHIuX2dldExlZnRPZmZzZXQoKStsLGgrKHIuX2ZvbnRTaXplTXVsdC0xK2Vbb10pKnIuZm9udFNpemUtaSxjLHIuZm9udFNpemUvMTUpO2grPXV9fWlmKHRoaXMudGV4dERlY29yYXRpb24pe3ZhciBpPXRoaXMuaGVpZ2h0LzIscj10aGlzLHM9W107dGhpcy50ZXh0RGVjb3JhdGlvbi5pbmRleE9mKFwidW5kZXJsaW5lXCIpPi0xJiZzLnB1c2goLjg1KSx0aGlzLnRleHREZWNvcmF0aW9uLmluZGV4T2YoXCJsaW5lLXRocm91Z2hcIik+LTEmJnMucHVzaCguNDMpLHRoaXMudGV4dERlY29yYXRpb24uaW5kZXhPZihcIm92ZXJsaW5lXCIpPi0xJiZzLnB1c2goLS4xMikscy5sZW5ndGg+MCYmZShzKX19LF9nZXRGb250RGVjbGFyYXRpb246ZnVuY3Rpb24oKXtyZXR1cm5bZS5pc0xpa2VseU5vZGU/dGhpcy5mb250V2VpZ2h0OnRoaXMuZm9udFN0eWxlLGUuaXNMaWtlbHlOb2RlP3RoaXMuZm9udFN0eWxlOnRoaXMuZm9udFdlaWdodCx0aGlzLmZvbnRTaXplK1wicHhcIixlLmlzTGlrZWx5Tm9kZT8nXCInK3RoaXMuZm9udEZhbWlseSsnXCInOnRoaXMuZm9udEZhbWlseV0uam9pbihcIiBcIil9LHJlbmRlcjpmdW5jdGlvbih0LGUpe3RoaXMudmlzaWJsZSYmKHQuc2F2ZSgpLHRoaXMuX3NldFRleHRTdHlsZXModCksdGhpcy5fc2hvdWxkQ2xlYXJDYWNoZSgpJiZ0aGlzLl9pbml0RGltZW5zaW9ucyh0KSxlfHx0aGlzLnRyYW5zZm9ybSh0KSx0aGlzLl9zZXRTdHJva2VTdHlsZXModCksdGhpcy5fc2V0RmlsbFN0eWxlcyh0KSx0aGlzLnRyYW5zZm9ybU1hdHJpeCYmdC50cmFuc2Zvcm0uYXBwbHkodCx0aGlzLnRyYW5zZm9ybU1hdHJpeCksdGhpcy5ncm91cCYmXCJwYXRoLWdyb3VwXCI9PT10aGlzLmdyb3VwLnR5cGUmJnQudHJhbnNsYXRlKHRoaXMubGVmdCx0aGlzLnRvcCksdGhpcy5fcmVuZGVyKHQpLHQucmVzdG9yZSgpKX0sdG9PYmplY3Q6ZnVuY3Rpb24odCl7dmFyIGU9aSh0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIsdCkse3RleHQ6dGhpcy50ZXh0LGZvbnRTaXplOnRoaXMuZm9udFNpemUsZm9udFdlaWdodDp0aGlzLmZvbnRXZWlnaHQsZm9udEZhbWlseTp0aGlzLmZvbnRGYW1pbHksZm9udFN0eWxlOnRoaXMuZm9udFN0eWxlLGxpbmVIZWlnaHQ6dGhpcy5saW5lSGVpZ2h0LHRleHREZWNvcmF0aW9uOnRoaXMudGV4dERlY29yYXRpb24sdGV4dEFsaWduOnRoaXMudGV4dEFsaWduLHRleHRCYWNrZ3JvdW5kQ29sb3I6dGhpcy50ZXh0QmFja2dyb3VuZENvbG9yfSk7cmV0dXJuIHRoaXMuaW5jbHVkZURlZmF1bHRWYWx1ZXN8fHRoaXMuX3JlbW92ZURlZmF1bHRWYWx1ZXMoZSksZX0sdG9TVkc6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fY3JlYXRlQmFzZVNWR01hcmt1cCgpLGk9dGhpcy5fZ2V0U1ZHTGVmdFRvcE9mZnNldHModGhpcy5jdHgpLHI9dGhpcy5fZ2V0U1ZHVGV4dEFuZEJnKGkudGV4dFRvcCxpLnRleHRMZWZ0KTtyZXR1cm4gdGhpcy5fd3JhcFNWR1RleHRBbmRCZyhlLHIpLHQ/dChlLmpvaW4oXCJcIikpOmUuam9pbihcIlwiKX0sX2dldFNWR0xlZnRUb3BPZmZzZXRzOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX2dldEhlaWdodE9mTGluZSh0LDApLGk9LXRoaXMud2lkdGgvMixyPTA7cmV0dXJue3RleHRMZWZ0OmkrKHRoaXMuZ3JvdXAmJlwicGF0aC1ncm91cFwiPT09dGhpcy5ncm91cC50eXBlP3RoaXMubGVmdDowKSx0ZXh0VG9wOnIrKHRoaXMuZ3JvdXAmJlwicGF0aC1ncm91cFwiPT09dGhpcy5ncm91cC50eXBlPy10aGlzLnRvcDowKSxsaW5lVG9wOmV9fSxfd3JhcFNWR1RleHRBbmRCZzpmdW5jdGlvbih0LGUpe3QucHVzaCgnXHQ8ZyB0cmFuc2Zvcm09XCInLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtKCksdGhpcy5nZXRTdmdUcmFuc2Zvcm1NYXRyaXgoKSwnXCI+XFxuJyxlLnRleHRCZ1JlY3RzLmpvaW4oXCJcIiksXCJcdFx0PHRleHQgXCIsdGhpcy5mb250RmFtaWx5Pydmb250LWZhbWlseT1cIicrdGhpcy5mb250RmFtaWx5LnJlcGxhY2UoL1wiL2csXCInXCIpKydcIiAnOlwiXCIsdGhpcy5mb250U2l6ZT8nZm9udC1zaXplPVwiJyt0aGlzLmZvbnRTaXplKydcIiAnOlwiXCIsdGhpcy5mb250U3R5bGU/J2ZvbnQtc3R5bGU9XCInK3RoaXMuZm9udFN0eWxlKydcIiAnOlwiXCIsdGhpcy5mb250V2VpZ2h0Pydmb250LXdlaWdodD1cIicrdGhpcy5mb250V2VpZ2h0KydcIiAnOlwiXCIsdGhpcy50ZXh0RGVjb3JhdGlvbj8ndGV4dC1kZWNvcmF0aW9uPVwiJyt0aGlzLnRleHREZWNvcmF0aW9uKydcIiAnOlwiXCIsJ3N0eWxlPVwiJyx0aGlzLmdldFN2Z1N0eWxlcygpLCdcIiA+JyxlLnRleHRTcGFucy5qb2luKFwiXCIpLFwiPC90ZXh0PlxcblwiLFwiXHQ8L2c+XFxuXCIpfSxfZ2V0U1ZHVGV4dEFuZEJnOmZ1bmN0aW9uKHQsZSl7dmFyIGk9W10scj1bXSxzPTA7dGhpcy5fc2V0U1ZHQmcocik7Zm9yKHZhciBuPTAsbz10aGlzLl90ZXh0TGluZXMubGVuZ3RoO28+bjtuKyspdGhpcy50ZXh0QmFja2dyb3VuZENvbG9yJiZ0aGlzLl9zZXRTVkdUZXh0TGluZUJnKHIsbixlLHQscyksdGhpcy5fc2V0U1ZHVGV4dExpbmVUZXh0KG4saSxzLGUsdCxyKSxzKz10aGlzLl9nZXRIZWlnaHRPZkxpbmUodGhpcy5jdHgsbik7cmV0dXJue3RleHRTcGFuczppLHRleHRCZ1JlY3RzOnJ9fSxfc2V0U1ZHVGV4dExpbmVUZXh0OmZ1bmN0aW9uKHQsaSxyLG4sYSl7dmFyIGg9dGhpcy5mb250U2l6ZSoodGhpcy5fZm9udFNpemVNdWx0LXRoaXMuX2ZvbnRTaXplRnJhY3Rpb24pLWErci10aGlzLmhlaWdodC8yO2kucHVzaCgnPHRzcGFuIHg9XCInLHMobit0aGlzLl9nZXRMaW5lTGVmdE9mZnNldCh0aGlzLl9fbGluZVdpZHRoc1t0XSksbyksJ1wiICcsJ3k9XCInLHMoaCxvKSwnXCIgJyx0aGlzLl9nZXRGaWxsQXR0cmlidXRlcyh0aGlzLmZpbGwpLFwiPlwiLGUudXRpbC5zdHJpbmcuZXNjYXBlWG1sKHRoaXMuX3RleHRMaW5lc1t0XSksXCI8L3RzcGFuPlwiKX0sX3NldFNWR1RleHRMaW5lQmc6ZnVuY3Rpb24odCxlLGkscixuKXt0LnB1c2goXCJcdFx0PHJlY3QgXCIsdGhpcy5fZ2V0RmlsbEF0dHJpYnV0ZXModGhpcy50ZXh0QmFja2dyb3VuZENvbG9yKSwnIHg9XCInLHMoaSt0aGlzLl9nZXRMaW5lTGVmdE9mZnNldCh0aGlzLl9fbGluZVdpZHRoc1tlXSksbyksJ1wiIHk9XCInLHMobi10aGlzLmhlaWdodC8yLG8pLCdcIiB3aWR0aD1cIicscyh0aGlzLl9fbGluZVdpZHRoc1tlXSxvKSwnXCIgaGVpZ2h0PVwiJyxzKHRoaXMuX2dldEhlaWdodE9mTGluZSh0aGlzLmN0eCxlKS90aGlzLmxpbmVIZWlnaHQsbyksJ1wiPjwvcmVjdD5cXG4nKX0sX3NldFNWR0JnOmZ1bmN0aW9uKHQpe3RoaXMuYmFja2dyb3VuZENvbG9yJiZ0LnB1c2goXCJcdFx0PHJlY3QgXCIsdGhpcy5fZ2V0RmlsbEF0dHJpYnV0ZXModGhpcy5iYWNrZ3JvdW5kQ29sb3IpLCcgeD1cIicscygtdGhpcy53aWR0aC8yLG8pLCdcIiB5PVwiJyxzKC10aGlzLmhlaWdodC8yLG8pLCdcIiB3aWR0aD1cIicscyh0aGlzLndpZHRoLG8pLCdcIiBoZWlnaHQ9XCInLHModGhpcy5oZWlnaHQsbyksJ1wiPjwvcmVjdD5cXG4nKX0sX2dldEZpbGxBdHRyaWJ1dGVzOmZ1bmN0aW9uKHQpe3ZhciBpPXQmJlwic3RyaW5nXCI9PXR5cGVvZiB0P25ldyBlLkNvbG9yKHQpOlwiXCI7cmV0dXJuIGkmJmkuZ2V0U291cmNlKCkmJjEhPT1pLmdldEFscGhhKCk/J29wYWNpdHk9XCInK2kuZ2V0QWxwaGEoKSsnXCIgZmlsbD1cIicraS5zZXRBbHBoYSgxKS50b1JnYigpKydcIic6J2ZpbGw9XCInK3QrJ1wiJ30sX3NldDpmdW5jdGlvbih0LGUpe3RoaXMuY2FsbFN1cGVyKFwiX3NldFwiLHQsZSksdCBpbiB0aGlzLl9kaW1lbnNpb25BZmZlY3RpbmdQcm9wcyYmKHRoaXMuX2luaXREaW1lbnNpb25zKCksdGhpcy5zZXRDb29yZHMoKSl9LGNvbXBsZXhpdHk6ZnVuY3Rpb24oKXtyZXR1cm4gMX19KSxlLlRleHQuQVRUUklCVVRFX05BTUVTPWUuU0hBUkVEX0FUVFJJQlVURVMuY29uY2F0KFwieCB5IGR4IGR5IGZvbnQtZmFtaWx5IGZvbnQtc3R5bGUgZm9udC13ZWlnaHQgZm9udC1zaXplIHRleHQtZGVjb3JhdGlvbiB0ZXh0LWFuY2hvclwiLnNwbGl0KFwiIFwiKSksZS5UZXh0LkRFRkFVTFRfU1ZHX0ZPTlRfU0laRT0xNixlLlRleHQuZnJvbUVsZW1lbnQ9ZnVuY3Rpb24odCxpKXtpZighdClyZXR1cm4gbnVsbDt2YXIgcj1lLnBhcnNlQXR0cmlidXRlcyh0LGUuVGV4dC5BVFRSSUJVVEVfTkFNRVMpO2k9ZS51dGlsLm9iamVjdC5leHRlbmQoaT9lLnV0aWwub2JqZWN0LmNsb25lKGkpOnt9LHIpLGkudG9wPWkudG9wfHwwLGkubGVmdD1pLmxlZnR8fDAsXCJkeFwiaW4gciYmKGkubGVmdCs9ci5keCksXCJkeVwiaW4gciYmKGkudG9wKz1yLmR5KSxcImZvbnRTaXplXCJpbiBpfHwoaS5mb250U2l6ZT1lLlRleHQuREVGQVVMVF9TVkdfRk9OVF9TSVpFKSxpLm9yaWdpblh8fChpLm9yaWdpblg9XCJsZWZ0XCIpO3ZhciBzPXQudGV4dENvbnRlbnQucmVwbGFjZSgvXlxccyt8XFxzKyR8XFxuKy9nLFwiXCIpLnJlcGxhY2UoL1xccysvZyxcIiBcIiksbj1uZXcgZS5UZXh0KHMsaSksbz0wO3JldHVyblwibGVmdFwiPT09bi5vcmlnaW5YJiYobz1uLmdldFdpZHRoKCkvMiksXCJyaWdodFwiPT09bi5vcmlnaW5YJiYobz0tbi5nZXRXaWR0aCgpLzIpLG4uc2V0KHtsZWZ0Om4uZ2V0TGVmdCgpK28sdG9wOm4uZ2V0VG9wKCktbi5nZXRIZWlnaHQoKS8yK24uZm9udFNpemUqKC4xOCtuLl9mb250U2l6ZUZyYWN0aW9uKX0pLG59LGUuVGV4dC5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5UZXh0KHQudGV4dCxyKHQpKX0sZS51dGlsLmNyZWF0ZUFjY2Vzc29ycyhlLlRleHQpfShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKCl7dmFyIHQ9ZmFicmljLnV0aWwub2JqZWN0LmNsb25lO2ZhYnJpYy5JVGV4dD1mYWJyaWMudXRpbC5jcmVhdGVDbGFzcyhmYWJyaWMuVGV4dCxmYWJyaWMuT2JzZXJ2YWJsZSx7dHlwZTpcImktdGV4dFwiLHNlbGVjdGlvblN0YXJ0OjAsc2VsZWN0aW9uRW5kOjAsc2VsZWN0aW9uQ29sb3I6XCJyZ2JhKDE3LDExOSwyNTUsMC4zKVwiLGlzRWRpdGluZzohMSxlZGl0YWJsZTohMCxlZGl0aW5nQm9yZGVyQ29sb3I6XCJyZ2JhKDEwMiwxNTMsMjU1LDAuMjUpXCIsY3Vyc29yV2lkdGg6MixjdXJzb3JDb2xvcjpcIiMzMzNcIixjdXJzb3JEZWxheToxZTMsY3Vyc29yRHVyYXRpb246NjAwLHN0eWxlczpudWxsLGNhY2hpbmc6ITAsX3NraXBGaWxsU3Ryb2tlQ2hlY2s6ITEsX3JlU3BhY2U6L1xcc3xcXG4vLF9jdXJyZW50Q3Vyc29yT3BhY2l0eTowLF9zZWxlY3Rpb25EaXJlY3Rpb246bnVsbCxfYWJvcnRDdXJzb3JBbmltYXRpb246ITEsX2NoYXJXaWR0aHNDYWNoZTp7fSxpbml0aWFsaXplOmZ1bmN0aW9uKHQsZSl7dGhpcy5zdHlsZXM9ZT9lLnN0eWxlc3x8e306e30sdGhpcy5jYWxsU3VwZXIoXCJpbml0aWFsaXplXCIsdCxlKSx0aGlzLmluaXRCZWhhdmlvcigpfSxfY2xlYXJDYWNoZTpmdW5jdGlvbigpe3RoaXMuY2FsbFN1cGVyKFwiX2NsZWFyQ2FjaGVcIiksdGhpcy5fX21heEZvbnRIZWlnaHRzPVtdLHRoaXMuX193aWR0aE9mU3BhY2U9W119LGlzRW1wdHlTdHlsZXM6ZnVuY3Rpb24oKXtpZighdGhpcy5zdHlsZXMpcmV0dXJuITA7dmFyIHQ9dGhpcy5zdHlsZXM7Zm9yKHZhciBlIGluIHQpZm9yKHZhciBpIGluIHRbZV0pZm9yKHZhciByIGluIHRbZV1baV0pcmV0dXJuITE7cmV0dXJuITB9LHNldFNlbGVjdGlvblN0YXJ0OmZ1bmN0aW9uKHQpe3Q9TWF0aC5tYXgodCwwKSx0aGlzLnNlbGVjdGlvblN0YXJ0IT09dCYmKHRoaXMuZmlyZShcInNlbGVjdGlvbjpjaGFuZ2VkXCIpLHRoaXMuY2FudmFzJiZ0aGlzLmNhbnZhcy5maXJlKFwidGV4dDpzZWxlY3Rpb246Y2hhbmdlZFwiLHt0YXJnZXQ6dGhpc30pLHRoaXMuc2VsZWN0aW9uU3RhcnQ9dCksdGhpcy5fdXBkYXRlVGV4dGFyZWEoKX0sc2V0U2VsZWN0aW9uRW5kOmZ1bmN0aW9uKHQpe3Q9TWF0aC5taW4odCx0aGlzLnRleHQubGVuZ3RoKSx0aGlzLnNlbGVjdGlvbkVuZCE9PXQmJih0aGlzLmZpcmUoXCJzZWxlY3Rpb246Y2hhbmdlZFwiKSx0aGlzLmNhbnZhcyYmdGhpcy5jYW52YXMuZmlyZShcInRleHQ6c2VsZWN0aW9uOmNoYW5nZWRcIix7dGFyZ2V0OnRoaXN9KSx0aGlzLnNlbGVjdGlvbkVuZD10KSx0aGlzLl91cGRhdGVUZXh0YXJlYSgpfSxnZXRTZWxlY3Rpb25TdHlsZXM6ZnVuY3Rpb24odCxlKXtpZigyPT09YXJndW1lbnRzLmxlbmd0aCl7Zm9yKHZhciBpPVtdLHI9dDtlPnI7cisrKWkucHVzaCh0aGlzLmdldFNlbGVjdGlvblN0eWxlcyhyKSk7cmV0dXJuIGl9dmFyIHM9dGhpcy5nZXQyREN1cnNvckxvY2F0aW9uKHQpO3JldHVybiB0aGlzLnN0eWxlc1tzLmxpbmVJbmRleF0/dGhpcy5zdHlsZXNbcy5saW5lSW5kZXhdW3MuY2hhckluZGV4XXx8e306e319LHNldFNlbGVjdGlvblN0eWxlczpmdW5jdGlvbih0KXtpZih0aGlzLnNlbGVjdGlvblN0YXJ0PT09dGhpcy5zZWxlY3Rpb25FbmQpdGhpcy5fZXh0ZW5kU3R5bGVzKHRoaXMuc2VsZWN0aW9uU3RhcnQsdCk7ZWxzZSBmb3IodmFyIGU9dGhpcy5zZWxlY3Rpb25TdGFydDtlPHRoaXMuc2VsZWN0aW9uRW5kO2UrKyl0aGlzLl9leHRlbmRTdHlsZXMoZSx0KTtyZXR1cm4gdGhpcy5fY2xlYXJDYWNoZSgpLHRoaXN9LF9leHRlbmRTdHlsZXM6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLmdldDJEQ3Vyc29yTG9jYXRpb24odCk7dGhpcy5zdHlsZXNbaS5saW5lSW5kZXhdfHwodGhpcy5zdHlsZXNbaS5saW5lSW5kZXhdPXt9KSx0aGlzLnN0eWxlc1tpLmxpbmVJbmRleF1baS5jaGFySW5kZXhdfHwodGhpcy5zdHlsZXNbaS5saW5lSW5kZXhdW2kuY2hhckluZGV4XT17fSksZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZCh0aGlzLnN0eWxlc1tpLmxpbmVJbmRleF1baS5jaGFySW5kZXhdLGUpfSxfcmVuZGVyOmZ1bmN0aW9uKHQpe3RoaXMuY2FsbFN1cGVyKFwiX3JlbmRlclwiLHQpLHRoaXMuY3R4PXQsdGhpcy5pc0VkaXRpbmcmJnRoaXMucmVuZGVyQ3Vyc29yT3JTZWxlY3Rpb24oKX0scmVuZGVyQ3Vyc29yT3JTZWxlY3Rpb246ZnVuY3Rpb24oKXtpZih0aGlzLmFjdGl2ZSl7dmFyIHQsZSxpPXRoaXMudGV4dC5zcGxpdChcIlwiKTt0aGlzLmNhbnZhcy5jb250ZXh0VG9wPyhlPXRoaXMuY2FudmFzLmNvbnRleHRUb3AsZS5zYXZlKCksZS50cmFuc2Zvcm0uYXBwbHkoZSx0aGlzLmNhbnZhcy52aWV3cG9ydFRyYW5zZm9ybSksdGhpcy50cmFuc2Zvcm0oZSksdGhpcy50cmFuc2Zvcm1NYXRyaXgmJmUudHJhbnNmb3JtLmFwcGx5KGUsdGhpcy50cmFuc2Zvcm1NYXRyaXgpKTooZT10aGlzLmN0eCxlLnNhdmUoKSksdGhpcy5zZWxlY3Rpb25TdGFydD09PXRoaXMuc2VsZWN0aW9uRW5kPyh0PXRoaXMuX2dldEN1cnNvckJvdW5kYXJpZXMoaSxcImN1cnNvclwiKSx0aGlzLnJlbmRlckN1cnNvcih0LGUpKToodD10aGlzLl9nZXRDdXJzb3JCb3VuZGFyaWVzKGksXCJzZWxlY3Rpb25cIiksdGhpcy5yZW5kZXJTZWxlY3Rpb24oaSx0LGUpKSxcclxuZS5yZXN0b3JlKCl9fSxnZXQyREN1cnNvckxvY2F0aW9uOmZ1bmN0aW9uKHQpe1widW5kZWZpbmVkXCI9PXR5cGVvZiB0JiYodD10aGlzLnNlbGVjdGlvblN0YXJ0KTtmb3IodmFyIGU9dGhpcy5fdGV4dExpbmVzLmxlbmd0aCxpPTA7ZT5pO2krKyl7aWYodDw9dGhpcy5fdGV4dExpbmVzW2ldLmxlbmd0aClyZXR1cm57bGluZUluZGV4OmksY2hhckluZGV4OnR9O3QtPXRoaXMuX3RleHRMaW5lc1tpXS5sZW5ndGgrMX1yZXR1cm57bGluZUluZGV4OmktMSxjaGFySW5kZXg6dGhpcy5fdGV4dExpbmVzW2ktMV0ubGVuZ3RoPHQ/dGhpcy5fdGV4dExpbmVzW2ktMV0ubGVuZ3RoOnR9fSxnZXRDdXJyZW50Q2hhclN0eWxlOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5zdHlsZXNbdF0mJnRoaXMuc3R5bGVzW3RdWzA9PT1lPzA6ZS0xXTtyZXR1cm57Zm9udFNpemU6aSYmaS5mb250U2l6ZXx8dGhpcy5mb250U2l6ZSxmaWxsOmkmJmkuZmlsbHx8dGhpcy5maWxsLHRleHRCYWNrZ3JvdW5kQ29sb3I6aSYmaS50ZXh0QmFja2dyb3VuZENvbG9yfHx0aGlzLnRleHRCYWNrZ3JvdW5kQ29sb3IsdGV4dERlY29yYXRpb246aSYmaS50ZXh0RGVjb3JhdGlvbnx8dGhpcy50ZXh0RGVjb3JhdGlvbixmb250RmFtaWx5OmkmJmkuZm9udEZhbWlseXx8dGhpcy5mb250RmFtaWx5LGZvbnRXZWlnaHQ6aSYmaS5mb250V2VpZ2h0fHx0aGlzLmZvbnRXZWlnaHQsZm9udFN0eWxlOmkmJmkuZm9udFN0eWxlfHx0aGlzLmZvbnRTdHlsZSxzdHJva2U6aSYmaS5zdHJva2V8fHRoaXMuc3Ryb2tlLHN0cm9rZVdpZHRoOmkmJmkuc3Ryb2tlV2lkdGh8fHRoaXMuc3Ryb2tlV2lkdGh9fSxnZXRDdXJyZW50Q2hhckZvbnRTaXplOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuc3R5bGVzW3RdJiZ0aGlzLnN0eWxlc1t0XVswPT09ZT8wOmUtMV0mJnRoaXMuc3R5bGVzW3RdWzA9PT1lPzA6ZS0xXS5mb250U2l6ZXx8dGhpcy5mb250U2l6ZX0sZ2V0Q3VycmVudENoYXJDb2xvcjpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLnN0eWxlc1t0XSYmdGhpcy5zdHlsZXNbdF1bMD09PWU/MDplLTFdJiZ0aGlzLnN0eWxlc1t0XVswPT09ZT8wOmUtMV0uZmlsbHx8dGhpcy5jdXJzb3JDb2xvcn0sX2dldEN1cnNvckJvdW5kYXJpZXM6ZnVuY3Rpb24odCxlKXt2YXIgaT1NYXRoLnJvdW5kKHRoaXMuX2dldExlZnRPZmZzZXQoKSkscj10aGlzLl9nZXRUb3BPZmZzZXQoKSxzPXRoaXMuX2dldEN1cnNvckJvdW5kYXJpZXNPZmZzZXRzKHQsZSk7cmV0dXJue2xlZnQ6aSx0b3A6cixsZWZ0T2Zmc2V0OnMubGVmdCtzLmxpbmVMZWZ0LHRvcE9mZnNldDpzLnRvcH19LF9nZXRDdXJzb3JCb3VuZGFyaWVzT2Zmc2V0czpmdW5jdGlvbih0LGUpe2Zvcih2YXIgaT0wLHI9MCxzPTAsbj0wLG89MCxhPTA7YTx0aGlzLnNlbGVjdGlvblN0YXJ0O2ErKylcIlxcblwiPT09dFthXT8obz0wLG4rPXRoaXMuX2dldEhlaWdodE9mTGluZSh0aGlzLmN0eCxyKSxyKysscz0wKToobys9dGhpcy5fZ2V0V2lkdGhPZkNoYXIodGhpcy5jdHgsdFthXSxyLHMpLHMrKyksaT10aGlzLl9nZXRDYWNoZWRMaW5lT2Zmc2V0KHIpO3JldHVyblwiY3Vyc29yXCI9PT1lJiYobis9KDEtdGhpcy5fZm9udFNpemVGcmFjdGlvbikqdGhpcy5fZ2V0SGVpZ2h0T2ZMaW5lKHRoaXMuY3R4LHIpL3RoaXMubGluZUhlaWdodC10aGlzLmdldEN1cnJlbnRDaGFyRm9udFNpemUocixzKSooMS10aGlzLl9mb250U2l6ZUZyYWN0aW9uKSkse3RvcDpuLGxlZnQ6byxsaW5lTGVmdDppfX0sX2dldENhY2hlZExpbmVPZmZzZXQ6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fZ2V0TGluZVdpZHRoKHRoaXMuY3R4LHQpO3JldHVybiB0aGlzLl9fbGluZU9mZnNldHNbdF18fCh0aGlzLl9fbGluZU9mZnNldHNbdF09dGhpcy5fZ2V0TGluZUxlZnRPZmZzZXQoZSkpfSxyZW5kZXJDdXJzb3I6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLmdldDJEQ3Vyc29yTG9jYXRpb24oKSxyPWkubGluZUluZGV4LHM9aS5jaGFySW5kZXgsbj10aGlzLmdldEN1cnJlbnRDaGFyRm9udFNpemUocixzKSxvPTA9PT1yJiYwPT09cz90aGlzLl9nZXRDYWNoZWRMaW5lT2Zmc2V0KHIpOnQubGVmdE9mZnNldDtlLmZpbGxTdHlsZT10aGlzLmdldEN1cnJlbnRDaGFyQ29sb3IocixzKSxlLmdsb2JhbEFscGhhPXRoaXMuX19pc01vdXNlZG93bj8xOnRoaXMuX2N1cnJlbnRDdXJzb3JPcGFjaXR5LGUuZmlsbFJlY3QodC5sZWZ0K28sdC50b3ArdC50b3BPZmZzZXQsdGhpcy5jdXJzb3JXaWR0aC90aGlzLnNjYWxlWCxuKX0scmVuZGVyU2VsZWN0aW9uOmZ1bmN0aW9uKHQsZSxpKXtpLmZpbGxTdHlsZT10aGlzLnNlbGVjdGlvbkNvbG9yO2Zvcih2YXIgcj10aGlzLmdldDJEQ3Vyc29yTG9jYXRpb24odGhpcy5zZWxlY3Rpb25TdGFydCkscz10aGlzLmdldDJEQ3Vyc29yTG9jYXRpb24odGhpcy5zZWxlY3Rpb25FbmQpLG49ci5saW5lSW5kZXgsbz1zLmxpbmVJbmRleCxhPW47bz49YTthKyspe3ZhciBoPXRoaXMuX2dldENhY2hlZExpbmVPZmZzZXQoYSl8fDAsYz10aGlzLl9nZXRIZWlnaHRPZkxpbmUodGhpcy5jdHgsYSksbD0wLHU9dGhpcy5fdGV4dExpbmVzW2FdO2lmKGE9PT1uKWZvcih2YXIgZj0wLGQ9dS5sZW5ndGg7ZD5mO2YrKylmPj1yLmNoYXJJbmRleCYmKGEhPT1vfHxmPHMuY2hhckluZGV4KSYmKGwrPXRoaXMuX2dldFdpZHRoT2ZDaGFyKGksdVtmXSxhLGYpKSxmPHIuY2hhckluZGV4JiYoaCs9dGhpcy5fZ2V0V2lkdGhPZkNoYXIoaSx1W2ZdLGEsZikpO2Vsc2UgaWYoYT5uJiZvPmEpbCs9dGhpcy5fZ2V0TGluZVdpZHRoKGksYSl8fDU7ZWxzZSBpZihhPT09bylmb3IodmFyIGc9MCxwPXMuY2hhckluZGV4O3A+ZztnKyspbCs9dGhpcy5fZ2V0V2lkdGhPZkNoYXIoaSx1W2ddLGEsZyk7aS5maWxsUmVjdChlLmxlZnQraCxlLnRvcCtlLnRvcE9mZnNldCxsLGMpLGUudG9wT2Zmc2V0Kz1jfX0sX3JlbmRlckNoYXJzOmZ1bmN0aW9uKHQsZSxpLHIscyxuKXtpZih0aGlzLmlzRW1wdHlTdHlsZXMoKSlyZXR1cm4gdGhpcy5fcmVuZGVyQ2hhcnNGYXN0KHQsZSxpLHIscyk7dGhpcy5za2lwVGV4dEFsaWduPSEwLHItPVwiY2VudGVyXCI9PT10aGlzLnRleHRBbGlnbj90aGlzLndpZHRoLzI6XCJyaWdodFwiPT09dGhpcy50ZXh0QWxpZ24/dGhpcy53aWR0aDowO3ZhciBvLGE9dGhpcy5fZ2V0SGVpZ2h0T2ZMaW5lKGUsbiksaD10aGlzLl9nZXRDYWNoZWRMaW5lT2Zmc2V0KG4pLGM9XCJcIjtyKz1ofHwwLGUuc2F2ZSgpLHMtPWEvdGhpcy5saW5lSGVpZ2h0KnRoaXMuX2ZvbnRTaXplRnJhY3Rpb247Zm9yKHZhciBsPTAsdT1pLmxlbmd0aDt1Pj1sO2wrKyl7bz1vfHx0aGlzLmdldEN1cnJlbnRDaGFyU3R5bGUobixsKTt2YXIgZj10aGlzLmdldEN1cnJlbnRDaGFyU3R5bGUobixsKzEpOyh0aGlzLl9oYXNTdHlsZUNoYW5nZWQobyxmKXx8bD09PXUpJiYodGhpcy5fcmVuZGVyQ2hhcih0LGUsbixsLTEsYyxyLHMsYSksYz1cIlwiLG89ZiksYys9aVtsXX1lLnJlc3RvcmUoKX0sX3JlbmRlckNoYXJzRmFzdDpmdW5jdGlvbih0LGUsaSxyLHMpe3RoaXMuc2tpcFRleHRBbGlnbj0hMSxcImZpbGxUZXh0XCI9PT10JiZ0aGlzLmZpbGwmJnRoaXMuY2FsbFN1cGVyKFwiX3JlbmRlckNoYXJzXCIsdCxlLGkscixzKSxcInN0cm9rZVRleHRcIj09PXQmJih0aGlzLnN0cm9rZSYmdGhpcy5zdHJva2VXaWR0aD4wfHx0aGlzLnNraXBGaWxsU3Ryb2tlQ2hlY2spJiZ0aGlzLmNhbGxTdXBlcihcIl9yZW5kZXJDaGFyc1wiLHQsZSxpLHIscyl9LF9yZW5kZXJDaGFyOmZ1bmN0aW9uKHQsZSxpLHIscyxuLG8sYSl7dmFyIGgsYyxsLHU9dGhpcy5fZm9udFNpemVGcmFjdGlvbiphL3RoaXMubGluZUhlaWdodDtpZih0aGlzLnN0eWxlcyYmdGhpcy5zdHlsZXNbaV0mJihoPXRoaXMuc3R5bGVzW2ldW3JdKSl7dmFyIGY9aC5zdHJva2V8fHRoaXMuc3Ryb2tlLGQ9aC5maWxsfHx0aGlzLmZpbGw7ZS5zYXZlKCksYz10aGlzLl9hcHBseUNoYXJTdHlsZXNHZXRXaWR0aChlLHMsaSxyLGgpLGw9dGhpcy5fZ2V0SGVpZ2h0T2ZDaGFyKGUscyxpLHIpLGQmJmUuZmlsbFRleHQocyxuLG8pLGYmJmUuc3Ryb2tlVGV4dChzLG4sbyksdGhpcy5fcmVuZGVyQ2hhckRlY29yYXRpb24oZSxoLG4sbyx1LGMsbCksZS5yZXN0b3JlKCksZS50cmFuc2xhdGUoYywwKX1lbHNlXCJzdHJva2VUZXh0XCI9PT10JiZ0aGlzLnN0cm9rZSYmZVt0XShzLG4sbyksXCJmaWxsVGV4dFwiPT09dCYmdGhpcy5maWxsJiZlW3RdKHMsbixvKSxjPXRoaXMuX2FwcGx5Q2hhclN0eWxlc0dldFdpZHRoKGUscyxpLHIpLHRoaXMuX3JlbmRlckNoYXJEZWNvcmF0aW9uKGUsbnVsbCxuLG8sdSxjLHRoaXMuZm9udFNpemUpLGUudHJhbnNsYXRlKGUubWVhc3VyZVRleHQocykud2lkdGgsMCl9LF9oYXNTdHlsZUNoYW5nZWQ6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdC5maWxsIT09ZS5maWxsfHx0LmZvbnRTaXplIT09ZS5mb250U2l6ZXx8dC50ZXh0QmFja2dyb3VuZENvbG9yIT09ZS50ZXh0QmFja2dyb3VuZENvbG9yfHx0LnRleHREZWNvcmF0aW9uIT09ZS50ZXh0RGVjb3JhdGlvbnx8dC5mb250RmFtaWx5IT09ZS5mb250RmFtaWx5fHx0LmZvbnRXZWlnaHQhPT1lLmZvbnRXZWlnaHR8fHQuZm9udFN0eWxlIT09ZS5mb250U3R5bGV8fHQuc3Ryb2tlIT09ZS5zdHJva2V8fHQuc3Ryb2tlV2lkdGghPT1lLnN0cm9rZVdpZHRofSxfcmVuZGVyQ2hhckRlY29yYXRpb246ZnVuY3Rpb24odCxlLGkscixzLG4sbyl7dmFyIGE9ZT9lLnRleHREZWNvcmF0aW9ufHx0aGlzLnRleHREZWNvcmF0aW9uOnRoaXMudGV4dERlY29yYXRpb247YSYmKGEuaW5kZXhPZihcInVuZGVybGluZVwiKT4tMSYmdC5maWxsUmVjdChpLHIrby8xMCxuLG8vMTUpLGEuaW5kZXhPZihcImxpbmUtdGhyb3VnaFwiKT4tMSYmdC5maWxsUmVjdChpLHItbyoodGhpcy5fZm9udFNpemVGcmFjdGlvbit0aGlzLl9mb250U2l6ZU11bHQtMSkrby8xNSxuLG8vMTUpLGEuaW5kZXhPZihcIm92ZXJsaW5lXCIpPi0xJiZ0LmZpbGxSZWN0KGksci0odGhpcy5fZm9udFNpemVNdWx0LXRoaXMuX2ZvbnRTaXplRnJhY3Rpb24pKm8sbixvLzE1KSl9LF9yZW5kZXJUZXh0TGluZTpmdW5jdGlvbih0LGUsaSxyLHMsbil7dGhpcy5pc0VtcHR5U3R5bGVzKCl8fChzKz10aGlzLmZvbnRTaXplKih0aGlzLl9mb250U2l6ZUZyYWN0aW9uKy4wMykpLHRoaXMuY2FsbFN1cGVyKFwiX3JlbmRlclRleHRMaW5lXCIsdCxlLGkscixzLG4pfSxfcmVuZGVyVGV4dERlY29yYXRpb246ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuaXNFbXB0eVN0eWxlcygpP3RoaXMuY2FsbFN1cGVyKFwiX3JlbmRlclRleHREZWNvcmF0aW9uXCIsdCk6dm9pZCAwfSxfcmVuZGVyVGV4dExpbmVzQmFja2dyb3VuZDpmdW5jdGlvbih0KXtpZih0aGlzLnRleHRCYWNrZ3JvdW5kQ29sb3J8fHRoaXMuc3R5bGVzKXt0LnNhdmUoKSx0aGlzLnRleHRCYWNrZ3JvdW5kQ29sb3ImJih0LmZpbGxTdHlsZT10aGlzLnRleHRCYWNrZ3JvdW5kQ29sb3IpO2Zvcih2YXIgZT0wLGk9MCxyPXRoaXMuX3RleHRMaW5lcy5sZW5ndGg7cj5pO2krKyl7dmFyIHM9dGhpcy5fZ2V0SGVpZ2h0T2ZMaW5lKHQsaSk7aWYoXCJcIiE9PXRoaXMuX3RleHRMaW5lc1tpXSl7dmFyIG49dGhpcy5fZ2V0TGluZVdpZHRoKHQsaSksbz10aGlzLl9nZXRDYWNoZWRMaW5lT2Zmc2V0KGkpO2lmKHRoaXMudGV4dEJhY2tncm91bmRDb2xvciYmKHQuZmlsbFN0eWxlPXRoaXMudGV4dEJhY2tncm91bmRDb2xvcix0LmZpbGxSZWN0KHRoaXMuX2dldExlZnRPZmZzZXQoKStvLHRoaXMuX2dldFRvcE9mZnNldCgpK2UsbixzL3RoaXMubGluZUhlaWdodCkpLHRoaXMuc3R5bGVzW2ldKWZvcih2YXIgYT0wLGg9dGhpcy5fdGV4dExpbmVzW2ldLmxlbmd0aDtoPmE7YSsrKWlmKHRoaXMuc3R5bGVzW2ldJiZ0aGlzLnN0eWxlc1tpXVthXSYmdGhpcy5zdHlsZXNbaV1bYV0udGV4dEJhY2tncm91bmRDb2xvcil7dmFyIGM9dGhpcy5fdGV4dExpbmVzW2ldW2FdO3QuZmlsbFN0eWxlPXRoaXMuc3R5bGVzW2ldW2FdLnRleHRCYWNrZ3JvdW5kQ29sb3IsdC5maWxsUmVjdCh0aGlzLl9nZXRMZWZ0T2Zmc2V0KCkrbyt0aGlzLl9nZXRXaWR0aE9mQ2hhcnNBdCh0LGksYSksdGhpcy5fZ2V0VG9wT2Zmc2V0KCkrZSx0aGlzLl9nZXRXaWR0aE9mQ2hhcih0LGMsaSxhKSsxLHMvdGhpcy5saW5lSGVpZ2h0KX1lKz1zfWVsc2UgZSs9c310LnJlc3RvcmUoKX19LF9nZXRDYWNoZVByb3A6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdCtlLmZvbnRGYW1pbHkrZS5mb250U2l6ZStlLmZvbnRXZWlnaHQrZS5mb250U3R5bGUrZS5zaGFkb3d9LF9hcHBseUNoYXJTdHlsZXNHZXRXaWR0aDpmdW5jdGlvbihlLGkscixzLG4pe3ZhciBvPW58fHRoaXMuc3R5bGVzW3JdJiZ0aGlzLnN0eWxlc1tyXVtzXTtvPW8/dChvKTp7fSx0aGlzLl9hcHBseUZvbnRTdHlsZXMobyk7dmFyIGE9dGhpcy5fZ2V0Q2FjaGVQcm9wKGksbyk7aWYodGhpcy5pc0VtcHR5U3R5bGVzKCkmJnRoaXMuX2NoYXJXaWR0aHNDYWNoZVthXSYmdGhpcy5jYWNoaW5nKXJldHVybiB0aGlzLl9jaGFyV2lkdGhzQ2FjaGVbYV07XCJzdHJpbmdcIj09dHlwZW9mIG8uc2hhZG93JiYoby5zaGFkb3c9bmV3IGZhYnJpYy5TaGFkb3coby5zaGFkb3cpKTt2YXIgaD1vLmZpbGx8fHRoaXMuZmlsbDtyZXR1cm4gZS5maWxsU3R5bGU9aC50b0xpdmU/aC50b0xpdmUoZSx0aGlzKTpoLG8uc3Ryb2tlJiYoZS5zdHJva2VTdHlsZT1vLnN0cm9rZSYmby5zdHJva2UudG9MaXZlP28uc3Ryb2tlLnRvTGl2ZShlLHRoaXMpOm8uc3Ryb2tlKSxlLmxpbmVXaWR0aD1vLnN0cm9rZVdpZHRofHx0aGlzLnN0cm9rZVdpZHRoLGUuZm9udD10aGlzLl9nZXRGb250RGVjbGFyYXRpb24uY2FsbChvKSx0aGlzLl9zZXRTaGFkb3cuY2FsbChvLGUpLHRoaXMuY2FjaGluZz8odGhpcy5fY2hhcldpZHRoc0NhY2hlW2FdfHwodGhpcy5fY2hhcldpZHRoc0NhY2hlW2FdPWUubWVhc3VyZVRleHQoaSkud2lkdGgpLHRoaXMuX2NoYXJXaWR0aHNDYWNoZVthXSk6ZS5tZWFzdXJlVGV4dChpKS53aWR0aH0sX2FwcGx5Rm9udFN0eWxlczpmdW5jdGlvbih0KXt0LmZvbnRGYW1pbHl8fCh0LmZvbnRGYW1pbHk9dGhpcy5mb250RmFtaWx5KSx0LmZvbnRTaXplfHwodC5mb250U2l6ZT10aGlzLmZvbnRTaXplKSx0LmZvbnRXZWlnaHR8fCh0LmZvbnRXZWlnaHQ9dGhpcy5mb250V2VpZ2h0KSx0LmZvbnRTdHlsZXx8KHQuZm9udFN0eWxlPXRoaXMuZm9udFN0eWxlKX0sX2dldFN0eWxlRGVjbGFyYXRpb246ZnVuY3Rpb24oZSxpKXtyZXR1cm4gdGhpcy5zdHlsZXNbZV0mJnRoaXMuc3R5bGVzW2VdW2ldP3QodGhpcy5zdHlsZXNbZV1baV0pOnt9fSxfZ2V0V2lkdGhPZkNoYXI6ZnVuY3Rpb24odCxlLGkscil7aWYoXCJqdXN0aWZ5XCI9PT10aGlzLnRleHRBbGlnbiYmL1xccy8udGVzdChlKSlyZXR1cm4gdGhpcy5fZ2V0V2lkdGhPZlNwYWNlKHQsaSk7dmFyIHM9dGhpcy5fZ2V0U3R5bGVEZWNsYXJhdGlvbihpLHIpO3RoaXMuX2FwcGx5Rm9udFN0eWxlcyhzKTt2YXIgbj10aGlzLl9nZXRDYWNoZVByb3AoZSxzKTtpZih0aGlzLl9jaGFyV2lkdGhzQ2FjaGVbbl0mJnRoaXMuY2FjaGluZylyZXR1cm4gdGhpcy5fY2hhcldpZHRoc0NhY2hlW25dO2lmKHQpe3Quc2F2ZSgpO3ZhciBvPXRoaXMuX2FwcGx5Q2hhclN0eWxlc0dldFdpZHRoKHQsZSxpLHIpO3JldHVybiB0LnJlc3RvcmUoKSxvfX0sX2dldEhlaWdodE9mQ2hhcjpmdW5jdGlvbih0LGUsaSxyKXtyZXR1cm4gdGhpcy5zdHlsZXNbaV0mJnRoaXMuc3R5bGVzW2ldW3JdP3RoaXMuc3R5bGVzW2ldW3JdLmZvbnRTaXplfHx0aGlzLmZvbnRTaXplOnRoaXMuZm9udFNpemV9LF9nZXRIZWlnaHRPZkNoYXJBdDpmdW5jdGlvbih0LGUsaSl7dmFyIHI9dGhpcy5fdGV4dExpbmVzW2VdW2ldO3JldHVybiB0aGlzLl9nZXRIZWlnaHRPZkNoYXIodCxyLGUsaSl9LF9nZXRXaWR0aE9mQ2hhcnNBdDpmdW5jdGlvbih0LGUsaSl7dmFyIHIscyxuPTA7Zm9yKHI9MDtpPnI7cisrKXM9dGhpcy5fdGV4dExpbmVzW2VdW3JdLG4rPXRoaXMuX2dldFdpZHRoT2ZDaGFyKHQscyxlLHIpO3JldHVybiBufSxfZ2V0TGluZVdpZHRoOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuX19saW5lV2lkdGhzW2VdP3RoaXMuX19saW5lV2lkdGhzW2VdOih0aGlzLl9fbGluZVdpZHRoc1tlXT10aGlzLl9nZXRXaWR0aE9mQ2hhcnNBdCh0LGUsdGhpcy5fdGV4dExpbmVzW2VdLmxlbmd0aCksdGhpcy5fX2xpbmVXaWR0aHNbZV0pfSxfZ2V0V2lkdGhPZlNwYWNlOmZ1bmN0aW9uKHQsZSl7aWYodGhpcy5fX3dpZHRoT2ZTcGFjZVtlXSlyZXR1cm4gdGhpcy5fX3dpZHRoT2ZTcGFjZVtlXTt2YXIgaT10aGlzLl90ZXh0TGluZXNbZV0scj10aGlzLl9nZXRXaWR0aE9mV29yZHModCxpLGUpLHM9dGhpcy53aWR0aC1yLG49aS5sZW5ndGgtaS5yZXBsYWNlKC9cXHMrL2csXCJcIikubGVuZ3RoLG89cy9uO3JldHVybiB0aGlzLl9fd2lkdGhPZlNwYWNlW2VdPW8sb30sX2dldFdpZHRoT2ZXb3JkczpmdW5jdGlvbih0LGUsaSl7Zm9yKHZhciByPTAscz0wO3M8ZS5sZW5ndGg7cysrKXt2YXIgbj1lW3NdO24ubWF0Y2goL1xccy8pfHwocis9dGhpcy5fZ2V0V2lkdGhPZkNoYXIodCxuLGkscykpfXJldHVybiByfSxfZ2V0SGVpZ2h0T2ZMaW5lOmZ1bmN0aW9uKHQsZSl7aWYodGhpcy5fX2xpbmVIZWlnaHRzW2VdKXJldHVybiB0aGlzLl9fbGluZUhlaWdodHNbZV07Zm9yKHZhciBpPXRoaXMuX3RleHRMaW5lc1tlXSxyPXRoaXMuX2dldEhlaWdodE9mQ2hhcih0LGlbMF0sZSwwKSxzPTEsbj1pLmxlbmd0aDtuPnM7cysrKXt2YXIgbz10aGlzLl9nZXRIZWlnaHRPZkNoYXIodCxpW3NdLGUscyk7bz5yJiYocj1vKX1yZXR1cm4gdGhpcy5fX21heEZvbnRIZWlnaHRzW2VdPXIsdGhpcy5fX2xpbmVIZWlnaHRzW2VdPXIqdGhpcy5saW5lSGVpZ2h0KnRoaXMuX2ZvbnRTaXplTXVsdCx0aGlzLl9fbGluZUhlaWdodHNbZV19LF9nZXRUZXh0SGVpZ2h0OmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT0wLGk9MCxyPXRoaXMuX3RleHRMaW5lcy5sZW5ndGg7cj5pO2krKyllKz10aGlzLl9nZXRIZWlnaHRPZkxpbmUodCxpKTtyZXR1cm4gZX0sX3JlbmRlclRleHRCb3hCYWNrZ3JvdW5kOmZ1bmN0aW9uKHQpe3RoaXMuYmFja2dyb3VuZENvbG9yJiYodC5zYXZlKCksdC5maWxsU3R5bGU9dGhpcy5iYWNrZ3JvdW5kQ29sb3IsdC5maWxsUmVjdCh0aGlzLl9nZXRMZWZ0T2Zmc2V0KCksdGhpcy5fZ2V0VG9wT2Zmc2V0KCksdGhpcy53aWR0aCx0aGlzLmhlaWdodCksdC5yZXN0b3JlKCkpfSx0b09iamVjdDpmdW5jdGlvbihlKXtyZXR1cm4gZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZCh0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIsZSkse3N0eWxlczp0KHRoaXMuc3R5bGVzKX0pfX0pLGZhYnJpYy5JVGV4dC5mcm9tT2JqZWN0PWZ1bmN0aW9uKGUpe3JldHVybiBuZXcgZmFicmljLklUZXh0KGUudGV4dCx0KGUpKX19KCksZnVuY3Rpb24oKXt2YXIgdD1mYWJyaWMudXRpbC5vYmplY3QuY2xvbmU7ZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuSVRleHQucHJvdG90eXBlLHtpbml0QmVoYXZpb3I6ZnVuY3Rpb24oKXt0aGlzLmluaXRBZGRlZEhhbmRsZXIoKSx0aGlzLmluaXRSZW1vdmVkSGFuZGxlcigpLHRoaXMuaW5pdEN1cnNvclNlbGVjdGlvbkhhbmRsZXJzKCksdGhpcy5pbml0RG91YmxlQ2xpY2tTaW11bGF0aW9uKCl9LGluaXRTZWxlY3RlZEhhbmRsZXI6ZnVuY3Rpb24oKXt0aGlzLm9uKFwic2VsZWN0ZWRcIixmdW5jdGlvbigpe3ZhciB0PXRoaXM7c2V0VGltZW91dChmdW5jdGlvbigpe3Quc2VsZWN0ZWQ9ITB9LDEwMCl9KX0saW5pdEFkZGVkSGFuZGxlcjpmdW5jdGlvbigpe3ZhciB0PXRoaXM7dGhpcy5vbihcImFkZGVkXCIsZnVuY3Rpb24oKXt0aGlzLmNhbnZhcyYmIXRoaXMuY2FudmFzLl9oYXNJVGV4dEhhbmRsZXJzJiYodGhpcy5jYW52YXMuX2hhc0lUZXh0SGFuZGxlcnM9ITAsdGhpcy5faW5pdENhbnZhc0hhbmRsZXJzKCkpLHQuY2FudmFzJiYodC5jYW52YXMuX2lUZXh0SW5zdGFuY2VzPXQuY2FudmFzLl9pVGV4dEluc3RhbmNlc3x8W10sdC5jYW52YXMuX2lUZXh0SW5zdGFuY2VzLnB1c2godCkpfSl9LGluaXRSZW1vdmVkSGFuZGxlcjpmdW5jdGlvbigpe3ZhciB0PXRoaXM7dGhpcy5vbihcInJlbW92ZWRcIixmdW5jdGlvbigpe3QuY2FudmFzJiYodC5jYW52YXMuX2lUZXh0SW5zdGFuY2VzPXQuY2FudmFzLl9pVGV4dEluc3RhbmNlc3x8W10sZmFicmljLnV0aWwucmVtb3ZlRnJvbUFycmF5KHQuY2FudmFzLl9pVGV4dEluc3RhbmNlcyx0KSl9KX0sX2luaXRDYW52YXNIYW5kbGVyczpmdW5jdGlvbigpe3ZhciB0PXRoaXM7dGhpcy5jYW52YXMub24oXCJzZWxlY3Rpb246Y2xlYXJlZFwiLGZ1bmN0aW9uKCl7ZmFicmljLklUZXh0LnByb3RvdHlwZS5leGl0RWRpdGluZ09uT3RoZXJzKHQuY2FudmFzKX0pLHRoaXMuY2FudmFzLm9uKFwibW91c2U6dXBcIixmdW5jdGlvbigpe3QuY2FudmFzLl9pVGV4dEluc3RhbmNlcyYmdC5jYW52YXMuX2lUZXh0SW5zdGFuY2VzLmZvckVhY2goZnVuY3Rpb24odCl7dC5fX2lzTW91c2Vkb3duPSExfSl9KSx0aGlzLmNhbnZhcy5vbihcIm9iamVjdDpzZWxlY3RlZFwiLGZ1bmN0aW9uKCl7ZmFicmljLklUZXh0LnByb3RvdHlwZS5leGl0RWRpdGluZ09uT3RoZXJzKHQuY2FudmFzKX0pfSxfdGljazpmdW5jdGlvbigpe3RoaXMuX2N1cnJlbnRUaWNrU3RhdGU9dGhpcy5fYW5pbWF0ZUN1cnNvcih0aGlzLDEsdGhpcy5jdXJzb3JEdXJhdGlvbixcIl9vblRpY2tDb21wbGV0ZVwiKX0sX2FuaW1hdGVDdXJzb3I6ZnVuY3Rpb24odCxlLGkscil7dmFyIHM7cmV0dXJuIHM9e2lzQWJvcnRlZDohMSxhYm9ydDpmdW5jdGlvbigpe3RoaXMuaXNBYm9ydGVkPSEwfX0sdC5hbmltYXRlKFwiX2N1cnJlbnRDdXJzb3JPcGFjaXR5XCIsZSx7ZHVyYXRpb246aSxvbkNvbXBsZXRlOmZ1bmN0aW9uKCl7cy5pc0Fib3J0ZWR8fHRbcl0oKX0sb25DaGFuZ2U6ZnVuY3Rpb24oKXt0LmNhbnZhcyYmKHQuY2FudmFzLmNsZWFyQ29udGV4dCh0LmNhbnZhcy5jb250ZXh0VG9wfHx0LmN0eCksdC5yZW5kZXJDdXJzb3JPclNlbGVjdGlvbigpKX0sYWJvcnQ6ZnVuY3Rpb24oKXtyZXR1cm4gcy5pc0Fib3J0ZWR9fSksc30sX29uVGlja0NvbXBsZXRlOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpczt0aGlzLl9jdXJzb3JUaW1lb3V0MSYmY2xlYXJUaW1lb3V0KHRoaXMuX2N1cnNvclRpbWVvdXQxKSx0aGlzLl9jdXJzb3JUaW1lb3V0MT1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dC5fY3VycmVudFRpY2tDb21wbGV0ZVN0YXRlPXQuX2FuaW1hdGVDdXJzb3IodCwwLHRoaXMuY3Vyc29yRHVyYXRpb24vMixcIl90aWNrXCIpfSwxMDApfSxpbml0RGVsYXllZEN1cnNvcjpmdW5jdGlvbih0KXt2YXIgZT10aGlzLGk9dD8wOnRoaXMuY3Vyc29yRGVsYXk7dGhpcy5fY3VycmVudFRpY2tTdGF0ZSYmdGhpcy5fY3VycmVudFRpY2tTdGF0ZS5hYm9ydCgpLHRoaXMuX2N1cnJlbnRUaWNrQ29tcGxldGVTdGF0ZSYmdGhpcy5fY3VycmVudFRpY2tDb21wbGV0ZVN0YXRlLmFib3J0KCksY2xlYXJUaW1lb3V0KHRoaXMuX2N1cnNvclRpbWVvdXQxKSx0aGlzLl9jdXJyZW50Q3Vyc29yT3BhY2l0eT0xLHRoaXMuY2FudmFzJiYodGhpcy5jYW52YXMuY2xlYXJDb250ZXh0KHRoaXMuY2FudmFzLmNvbnRleHRUb3B8fHRoaXMuY3R4KSx0aGlzLnJlbmRlckN1cnNvck9yU2VsZWN0aW9uKCkpLHRoaXMuX2N1cnNvclRpbWVvdXQyJiZjbGVhclRpbWVvdXQodGhpcy5fY3Vyc29yVGltZW91dDIpLHRoaXMuX2N1cnNvclRpbWVvdXQyPXNldFRpbWVvdXQoZnVuY3Rpb24oKXtlLl90aWNrKCl9LGkpfSxhYm9ydEN1cnNvckFuaW1hdGlvbjpmdW5jdGlvbigpe3RoaXMuX2N1cnJlbnRUaWNrU3RhdGUmJnRoaXMuX2N1cnJlbnRUaWNrU3RhdGUuYWJvcnQoKSx0aGlzLl9jdXJyZW50VGlja0NvbXBsZXRlU3RhdGUmJnRoaXMuX2N1cnJlbnRUaWNrQ29tcGxldGVTdGF0ZS5hYm9ydCgpLGNsZWFyVGltZW91dCh0aGlzLl9jdXJzb3JUaW1lb3V0MSksY2xlYXJUaW1lb3V0KHRoaXMuX2N1cnNvclRpbWVvdXQyKSx0aGlzLl9jdXJyZW50Q3Vyc29yT3BhY2l0eT0wLHRoaXMuY2FudmFzJiZ0aGlzLmNhbnZhcy5jbGVhckNvbnRleHQodGhpcy5jYW52YXMuY29udGV4dFRvcHx8dGhpcy5jdHgpfSxzZWxlY3RBbGw6ZnVuY3Rpb24oKXt0aGlzLnNldFNlbGVjdGlvblN0YXJ0KDApLHRoaXMuc2V0U2VsZWN0aW9uRW5kKHRoaXMudGV4dC5sZW5ndGgpfSxnZXRTZWxlY3RlZFRleHQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50ZXh0LnNsaWNlKHRoaXMuc2VsZWN0aW9uU3RhcnQsdGhpcy5zZWxlY3Rpb25FbmQpfSxmaW5kV29yZEJvdW5kYXJ5TGVmdDpmdW5jdGlvbih0KXt2YXIgZT0wLGk9dC0xO2lmKHRoaXMuX3JlU3BhY2UudGVzdCh0aGlzLnRleHQuY2hhckF0KGkpKSlmb3IoO3RoaXMuX3JlU3BhY2UudGVzdCh0aGlzLnRleHQuY2hhckF0KGkpKTspZSsrLGktLTtmb3IoOy9cXFMvLnRlc3QodGhpcy50ZXh0LmNoYXJBdChpKSkmJmk+LTE7KWUrKyxpLS07cmV0dXJuIHQtZX0sZmluZFdvcmRCb3VuZGFyeVJpZ2h0OmZ1bmN0aW9uKHQpe3ZhciBlPTAsaT10O2lmKHRoaXMuX3JlU3BhY2UudGVzdCh0aGlzLnRleHQuY2hhckF0KGkpKSlmb3IoO3RoaXMuX3JlU3BhY2UudGVzdCh0aGlzLnRleHQuY2hhckF0KGkpKTspZSsrLGkrKztmb3IoOy9cXFMvLnRlc3QodGhpcy50ZXh0LmNoYXJBdChpKSkmJmk8dGhpcy50ZXh0Lmxlbmd0aDspZSsrLGkrKztyZXR1cm4gdCtlfSxmaW5kTGluZUJvdW5kYXJ5TGVmdDpmdW5jdGlvbih0KXtmb3IodmFyIGU9MCxpPXQtMTshL1xcbi8udGVzdCh0aGlzLnRleHQuY2hhckF0KGkpKSYmaT4tMTspZSsrLGktLTtyZXR1cm4gdC1lfSxmaW5kTGluZUJvdW5kYXJ5UmlnaHQ6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTAsaT10OyEvXFxuLy50ZXN0KHRoaXMudGV4dC5jaGFyQXQoaSkpJiZpPHRoaXMudGV4dC5sZW5ndGg7KWUrKyxpKys7cmV0dXJuIHQrZX0sZ2V0TnVtTmV3TGluZXNJblNlbGVjdGVkVGV4dDpmdW5jdGlvbigpe2Zvcih2YXIgdD10aGlzLmdldFNlbGVjdGVkVGV4dCgpLGU9MCxpPTAscj10Lmxlbmd0aDtyPmk7aSsrKVwiXFxuXCI9PT10W2ldJiZlKys7cmV0dXJuIGV9LHNlYXJjaFdvcmRCb3VuZGFyeTpmdW5jdGlvbih0LGUpe2Zvcih2YXIgaT10aGlzLl9yZVNwYWNlLnRlc3QodGhpcy50ZXh0LmNoYXJBdCh0KSk/dC0xOnQscj10aGlzLnRleHQuY2hhckF0KGkpLHM9L1sgXFxuXFwuLDshXFw/XFwtXS87IXMudGVzdChyKSYmaT4wJiZpPHRoaXMudGV4dC5sZW5ndGg7KWkrPWUscj10aGlzLnRleHQuY2hhckF0KGkpO3JldHVybiBzLnRlc3QocikmJlwiXFxuXCIhPT1yJiYoaSs9MT09PWU/MDoxKSxpfSxzZWxlY3RXb3JkOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuc2VhcmNoV29yZEJvdW5kYXJ5KHQsLTEpLGk9dGhpcy5zZWFyY2hXb3JkQm91bmRhcnkodCwxKTt0aGlzLnNldFNlbGVjdGlvblN0YXJ0KGUpLHRoaXMuc2V0U2VsZWN0aW9uRW5kKGkpfSxzZWxlY3RMaW5lOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZmluZExpbmVCb3VuZGFyeUxlZnQodCksaT10aGlzLmZpbmRMaW5lQm91bmRhcnlSaWdodCh0KTt0aGlzLnNldFNlbGVjdGlvblN0YXJ0KGUpLHRoaXMuc2V0U2VsZWN0aW9uRW5kKGkpfSxlbnRlckVkaXRpbmc6ZnVuY3Rpb24oKXtyZXR1cm4hdGhpcy5pc0VkaXRpbmcmJnRoaXMuZWRpdGFibGU/KHRoaXMuY2FudmFzJiZ0aGlzLmV4aXRFZGl0aW5nT25PdGhlcnModGhpcy5jYW52YXMpLHRoaXMuaXNFZGl0aW5nPSEwLHRoaXMuaW5pdEhpZGRlblRleHRhcmVhKCksdGhpcy5oaWRkZW5UZXh0YXJlYS5mb2N1cygpLHRoaXMuX3VwZGF0ZVRleHRhcmVhKCksdGhpcy5fc2F2ZUVkaXRpbmdQcm9wcygpLHRoaXMuX3NldEVkaXRpbmdQcm9wcygpLHRoaXMuX3RpY2soKSx0aGlzLmZpcmUoXCJlZGl0aW5nOmVudGVyZWRcIiksdGhpcy5jYW52YXM/KHRoaXMuY2FudmFzLnJlbmRlckFsbCgpLHRoaXMuY2FudmFzLmZpcmUoXCJ0ZXh0OmVkaXRpbmc6ZW50ZXJlZFwiLHt0YXJnZXQ6dGhpc30pLHRoaXMuaW5pdE1vdXNlTW92ZUhhbmRsZXIoKSx0aGlzKTp0aGlzKTp2b2lkIDB9LGV4aXRFZGl0aW5nT25PdGhlcnM6ZnVuY3Rpb24odCl7dC5faVRleHRJbnN0YW5jZXMmJnQuX2lUZXh0SW5zdGFuY2VzLmZvckVhY2goZnVuY3Rpb24odCl7dC5zZWxlY3RlZD0hMSx0LmlzRWRpdGluZyYmdC5leGl0RWRpdGluZygpfSl9LGluaXRNb3VzZU1vdmVIYW5kbGVyOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpczt0aGlzLmNhbnZhcy5vbihcIm1vdXNlOm1vdmVcIixmdW5jdGlvbihlKXtpZih0Ll9faXNNb3VzZWRvd24mJnQuaXNFZGl0aW5nKXt2YXIgaT10LmdldFNlbGVjdGlvblN0YXJ0RnJvbVBvaW50ZXIoZS5lKTtpPj10Ll9fc2VsZWN0aW9uU3RhcnRPbk1vdXNlRG93bj8odC5zZXRTZWxlY3Rpb25TdGFydCh0Ll9fc2VsZWN0aW9uU3RhcnRPbk1vdXNlRG93biksdC5zZXRTZWxlY3Rpb25FbmQoaSkpOih0LnNldFNlbGVjdGlvblN0YXJ0KGkpLHQuc2V0U2VsZWN0aW9uRW5kKHQuX19zZWxlY3Rpb25TdGFydE9uTW91c2VEb3duKSl9fSl9LF9zZXRFZGl0aW5nUHJvcHM6ZnVuY3Rpb24oKXt0aGlzLmhvdmVyQ3Vyc29yPVwidGV4dFwiLHRoaXMuY2FudmFzJiYodGhpcy5jYW52YXMuZGVmYXVsdEN1cnNvcj10aGlzLmNhbnZhcy5tb3ZlQ3Vyc29yPVwidGV4dFwiKSx0aGlzLmJvcmRlckNvbG9yPXRoaXMuZWRpdGluZ0JvcmRlckNvbG9yLHRoaXMuaGFzQ29udHJvbHM9dGhpcy5zZWxlY3RhYmxlPSExLHRoaXMubG9ja01vdmVtZW50WD10aGlzLmxvY2tNb3ZlbWVudFk9ITB9LF91cGRhdGVUZXh0YXJlYTpmdW5jdGlvbigpe3RoaXMuaGlkZGVuVGV4dGFyZWEmJih0aGlzLmhpZGRlblRleHRhcmVhLnZhbHVlPXRoaXMudGV4dCx0aGlzLmhpZGRlblRleHRhcmVhLnNlbGVjdGlvblN0YXJ0PXRoaXMuc2VsZWN0aW9uU3RhcnQsdGhpcy5oaWRkZW5UZXh0YXJlYS5zZWxlY3Rpb25FbmQ9dGhpcy5zZWxlY3Rpb25FbmQpfSxfc2F2ZUVkaXRpbmdQcm9wczpmdW5jdGlvbigpe3RoaXMuX3NhdmVkUHJvcHM9e2hhc0NvbnRyb2xzOnRoaXMuaGFzQ29udHJvbHMsYm9yZGVyQ29sb3I6dGhpcy5ib3JkZXJDb2xvcixsb2NrTW92ZW1lbnRYOnRoaXMubG9ja01vdmVtZW50WCxsb2NrTW92ZW1lbnRZOnRoaXMubG9ja01vdmVtZW50WSxob3ZlckN1cnNvcjp0aGlzLmhvdmVyQ3Vyc29yLGRlZmF1bHRDdXJzb3I6dGhpcy5jYW52YXMmJnRoaXMuY2FudmFzLmRlZmF1bHRDdXJzb3IsbW92ZUN1cnNvcjp0aGlzLmNhbnZhcyYmdGhpcy5jYW52YXMubW92ZUN1cnNvcn19LF9yZXN0b3JlRWRpdGluZ1Byb3BzOmZ1bmN0aW9uKCl7dGhpcy5fc2F2ZWRQcm9wcyYmKHRoaXMuaG92ZXJDdXJzb3I9dGhpcy5fc2F2ZWRQcm9wcy5vdmVyQ3Vyc29yLHRoaXMuaGFzQ29udHJvbHM9dGhpcy5fc2F2ZWRQcm9wcy5oYXNDb250cm9scyx0aGlzLmJvcmRlckNvbG9yPXRoaXMuX3NhdmVkUHJvcHMuYm9yZGVyQ29sb3IsdGhpcy5sb2NrTW92ZW1lbnRYPXRoaXMuX3NhdmVkUHJvcHMubG9ja01vdmVtZW50WCx0aGlzLmxvY2tNb3ZlbWVudFk9dGhpcy5fc2F2ZWRQcm9wcy5sb2NrTW92ZW1lbnRZLHRoaXMuY2FudmFzJiYodGhpcy5jYW52YXMuZGVmYXVsdEN1cnNvcj10aGlzLl9zYXZlZFByb3BzLmRlZmF1bHRDdXJzb3IsdGhpcy5jYW52YXMubW92ZUN1cnNvcj10aGlzLl9zYXZlZFByb3BzLm1vdmVDdXJzb3IpKX0sZXhpdEVkaXRpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZWxlY3RlZD0hMSx0aGlzLmlzRWRpdGluZz0hMSx0aGlzLnNlbGVjdGFibGU9ITAsdGhpcy5zZWxlY3Rpb25FbmQ9dGhpcy5zZWxlY3Rpb25TdGFydCx0aGlzLmhpZGRlblRleHRhcmVhJiZ0aGlzLmNhbnZhcyYmdGhpcy5oaWRkZW5UZXh0YXJlYS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuaGlkZGVuVGV4dGFyZWEpLHRoaXMuaGlkZGVuVGV4dGFyZWE9bnVsbCx0aGlzLmFib3J0Q3Vyc29yQW5pbWF0aW9uKCksdGhpcy5fcmVzdG9yZUVkaXRpbmdQcm9wcygpLHRoaXMuX2N1cnJlbnRDdXJzb3JPcGFjaXR5PTAsdGhpcy5maXJlKFwiZWRpdGluZzpleGl0ZWRcIiksdGhpcy5jYW52YXMmJnRoaXMuY2FudmFzLmZpcmUoXCJ0ZXh0OmVkaXRpbmc6ZXhpdGVkXCIse3RhcmdldDp0aGlzfSksdGhpc30sX3JlbW92ZUV4dHJhbmVvdXNTdHlsZXM6ZnVuY3Rpb24oKXtmb3IodmFyIHQgaW4gdGhpcy5zdHlsZXMpdGhpcy5fdGV4dExpbmVzW3RdfHxkZWxldGUgdGhpcy5zdHlsZXNbdF19LF9yZW1vdmVDaGFyc0Zyb21UbzpmdW5jdGlvbih0LGUpe2Zvcig7ZSE9PXQ7KXRoaXMuX3JlbW92ZVNpbmdsZUNoYXJBbmRTdHlsZSh0KzEpLGUtLTt0aGlzLnNldFNlbGVjdGlvblN0YXJ0KHQpfSxfcmVtb3ZlU2luZ2xlQ2hhckFuZFN0eWxlOmZ1bmN0aW9uKHQpe3ZhciBlPVwiXFxuXCI9PT10aGlzLnRleHRbdC0xXSxpPWU/dDp0LTE7dGhpcy5yZW1vdmVTdHlsZU9iamVjdChlLGkpLHRoaXMudGV4dD10aGlzLnRleHQuc2xpY2UoMCx0LTEpK3RoaXMudGV4dC5zbGljZSh0KSx0aGlzLl90ZXh0TGluZXM9dGhpcy50ZXh0LnNwbGl0KHRoaXMuX3JlTmV3bGluZSl9LGluc2VydENoYXJzOmZ1bmN0aW9uKHQsZSl7dGhpcy5zZWxlY3Rpb25FbmQtdGhpcy5zZWxlY3Rpb25TdGFydD4xJiYodGhpcy5fcmVtb3ZlQ2hhcnNGcm9tVG8odGhpcy5zZWxlY3Rpb25TdGFydCx0aGlzLnNlbGVjdGlvbkVuZCksdGhpcy5zZXRTZWxlY3Rpb25FbmQodGhpcy5zZWxlY3Rpb25TdGFydCkpO3ZhciBpPVwiXFxuXCI9PT10aGlzLnRleHRbdGhpcy5zZWxlY3Rpb25TdGFydF07dGhpcy50ZXh0PXRoaXMudGV4dC5zbGljZSgwLHRoaXMuc2VsZWN0aW9uU3RhcnQpK3QrdGhpcy50ZXh0LnNsaWNlKHRoaXMuc2VsZWN0aW9uRW5kKSx0aGlzLmluc2VydFN0eWxlT2JqZWN0cyh0LGksZSksdGhpcy5zZXRTZWxlY3Rpb25TdGFydCh0aGlzLnNlbGVjdGlvblN0YXJ0K3QubGVuZ3RoKSx0aGlzLnNldFNlbGVjdGlvbkVuZCh0aGlzLnNlbGVjdGlvblN0YXJ0KSx0aGlzLmNhbnZhcyYmdGhpcy5jYW52YXMucmVuZGVyQWxsKCksdGhpcy5zZXRDb29yZHMoKSx0aGlzLmZpcmUoXCJjaGFuZ2VkXCIpLHRoaXMuY2FudmFzJiZ0aGlzLmNhbnZhcy5maXJlKFwidGV4dDpjaGFuZ2VkXCIse3RhcmdldDp0aGlzfSl9LGluc2VydE5ld2xpbmVTdHlsZU9iamVjdDpmdW5jdGlvbihlLGkscil7dGhpcy5zaGlmdExpbmVTdHlsZXMoZSwxKSx0aGlzLnN0eWxlc1tlKzFdfHwodGhpcy5zdHlsZXNbZSsxXT17fSk7dmFyIHM9e30sbj17fTtpZih0aGlzLnN0eWxlc1tlXSYmdGhpcy5zdHlsZXNbZV1baS0xXSYmKHM9dGhpcy5zdHlsZXNbZV1baS0xXSksciluWzBdPXQocyksdGhpcy5zdHlsZXNbZSsxXT1uO2Vsc2V7Zm9yKHZhciBvIGluIHRoaXMuc3R5bGVzW2VdKXBhcnNlSW50KG8sMTApPj1pJiYobltwYXJzZUludChvLDEwKS1pXT10aGlzLnN0eWxlc1tlXVtvXSxkZWxldGUgdGhpcy5zdHlsZXNbZV1bb10pO3RoaXMuc3R5bGVzW2UrMV09bn10aGlzLl9jbGVhckNhY2hlKCl9LGluc2VydENoYXJTdHlsZU9iamVjdDpmdW5jdGlvbihlLGkscil7dmFyIHM9dGhpcy5zdHlsZXNbZV0sbj10KHMpOzAhPT1pfHxyfHwoaT0xKTtmb3IodmFyIG8gaW4gbil7dmFyIGE9cGFyc2VJbnQobywxMCk7YT49aSYmKHNbYSsxXT1uW2FdKX10aGlzLnN0eWxlc1tlXVtpXT1yfHx0KHNbaS0xXSksdGhpcy5fY2xlYXJDYWNoZSgpfSxpbnNlcnRTdHlsZU9iamVjdHM6ZnVuY3Rpb24odCxlLGkpe3ZhciByPXRoaXMuZ2V0MkRDdXJzb3JMb2NhdGlvbigpLHM9ci5saW5lSW5kZXgsbj1yLmNoYXJJbmRleDt0aGlzLnN0eWxlc1tzXXx8KHRoaXMuc3R5bGVzW3NdPXt9KSxcIlxcblwiPT09dD90aGlzLmluc2VydE5ld2xpbmVTdHlsZU9iamVjdChzLG4sZSk6aT90aGlzLl9pbnNlcnRTdHlsZXModGhpcy5jb3BpZWRTdHlsZXMpOnRoaXMuaW5zZXJ0Q2hhclN0eWxlT2JqZWN0KHMsbil9LF9pbnNlcnRTdHlsZXM6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTAsaT10Lmxlbmd0aDtpPmU7ZSsrKXt2YXIgcj10aGlzLmdldDJEQ3Vyc29yTG9jYXRpb24odGhpcy5zZWxlY3Rpb25TdGFydCtlKSxzPXIubGluZUluZGV4LG49ci5jaGFySW5kZXg7dGhpcy5pbnNlcnRDaGFyU3R5bGVPYmplY3QocyxuLHRbZV0pfX0sc2hpZnRMaW5lU3R5bGVzOmZ1bmN0aW9uKGUsaSl7dmFyIHI9dCh0aGlzLnN0eWxlcyk7Zm9yKHZhciBzIGluIHRoaXMuc3R5bGVzKXt2YXIgbj1wYXJzZUludChzLDEwKTtuPmUmJih0aGlzLnN0eWxlc1tuK2ldPXJbbl0scltuLWldfHxkZWxldGUgdGhpcy5zdHlsZXNbbl0pfX0scmVtb3ZlU3R5bGVPYmplY3Q6ZnVuY3Rpb24oZSxpKXt2YXIgcj10aGlzLmdldDJEQ3Vyc29yTG9jYXRpb24oaSkscz1yLmxpbmVJbmRleCxuPXIuY2hhckluZGV4O2lmKGUpe3ZhciBvPXRoaXMuX3RleHRMaW5lc1tzLTFdLGE9bz9vLmxlbmd0aDowO3RoaXMuc3R5bGVzW3MtMV18fCh0aGlzLnN0eWxlc1tzLTFdPXt9KTtmb3IobiBpbiB0aGlzLnN0eWxlc1tzXSl0aGlzLnN0eWxlc1tzLTFdW3BhcnNlSW50KG4sMTApK2FdPXRoaXMuc3R5bGVzW3NdW25dO3RoaXMuc2hpZnRMaW5lU3R5bGVzKHMsLTEpfWVsc2V7dmFyIGg9dGhpcy5zdHlsZXNbc107aCYmZGVsZXRlIGhbbl07dmFyIGM9dChoKTtmb3IodmFyIGwgaW4gYyl7dmFyIHU9cGFyc2VJbnQobCwxMCk7dT49biYmMCE9PXUmJihoW3UtMV09Y1t1XSxkZWxldGUgaFt1XSl9fX0saW5zZXJ0TmV3bGluZTpmdW5jdGlvbigpe3RoaXMuaW5zZXJ0Q2hhcnMoXCJcXG5cIil9fSl9KCksZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuSVRleHQucHJvdG90eXBlLHtpbml0RG91YmxlQ2xpY2tTaW11bGF0aW9uOmZ1bmN0aW9uKCl7dGhpcy5fX2xhc3RDbGlja1RpbWU9K25ldyBEYXRlLHRoaXMuX19sYXN0TGFzdENsaWNrVGltZT0rbmV3IERhdGUsdGhpcy5fX2xhc3RQb2ludGVyPXt9LHRoaXMub24oXCJtb3VzZWRvd25cIix0aGlzLm9uTW91c2VEb3duLmJpbmQodGhpcykpfSxvbk1vdXNlRG93bjpmdW5jdGlvbih0KXt0aGlzLl9fbmV3Q2xpY2tUaW1lPStuZXcgRGF0ZTt2YXIgZT10aGlzLmNhbnZhcy5nZXRQb2ludGVyKHQuZSk7dGhpcy5pc1RyaXBsZUNsaWNrKGUpPyh0aGlzLmZpcmUoXCJ0cmlwbGVjbGlja1wiLHQpLHRoaXMuX3N0b3BFdmVudCh0LmUpKTp0aGlzLmlzRG91YmxlQ2xpY2soZSkmJih0aGlzLmZpcmUoXCJkYmxjbGlja1wiLHQpLHRoaXMuX3N0b3BFdmVudCh0LmUpKSx0aGlzLl9fbGFzdExhc3RDbGlja1RpbWU9dGhpcy5fX2xhc3RDbGlja1RpbWUsdGhpcy5fX2xhc3RDbGlja1RpbWU9dGhpcy5fX25ld0NsaWNrVGltZSx0aGlzLl9fbGFzdFBvaW50ZXI9ZSx0aGlzLl9fbGFzdElzRWRpdGluZz10aGlzLmlzRWRpdGluZyx0aGlzLl9fbGFzdFNlbGVjdGVkPXRoaXMuc2VsZWN0ZWR9LGlzRG91YmxlQ2xpY2s6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX19uZXdDbGlja1RpbWUtdGhpcy5fX2xhc3RDbGlja1RpbWU8NTAwJiZ0aGlzLl9fbGFzdFBvaW50ZXIueD09PXQueCYmdGhpcy5fX2xhc3RQb2ludGVyLnk9PT10LnkmJnRoaXMuX19sYXN0SXNFZGl0aW5nfSxpc1RyaXBsZUNsaWNrOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9fbmV3Q2xpY2tUaW1lLXRoaXMuX19sYXN0Q2xpY2tUaW1lPDUwMCYmdGhpcy5fX2xhc3RDbGlja1RpbWUtdGhpcy5fX2xhc3RMYXN0Q2xpY2tUaW1lPDUwMCYmdGhpcy5fX2xhc3RQb2ludGVyLng9PT10LngmJnRoaXMuX19sYXN0UG9pbnRlci55PT09dC55fSxfc3RvcEV2ZW50OmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQmJnQucHJldmVudERlZmF1bHQoKSx0LnN0b3BQcm9wYWdhdGlvbiYmdC5zdG9wUHJvcGFnYXRpb24oKX0saW5pdEN1cnNvclNlbGVjdGlvbkhhbmRsZXJzOmZ1bmN0aW9uKCl7dGhpcy5pbml0U2VsZWN0ZWRIYW5kbGVyKCksdGhpcy5pbml0TW91c2Vkb3duSGFuZGxlcigpLHRoaXMuaW5pdE1vdXNldXBIYW5kbGVyKCksdGhpcy5pbml0Q2xpY2tzKCl9LGluaXRDbGlja3M6ZnVuY3Rpb24oKXt0aGlzLm9uKFwiZGJsY2xpY2tcIixmdW5jdGlvbih0KXt0aGlzLnNlbGVjdFdvcmQodGhpcy5nZXRTZWxlY3Rpb25TdGFydEZyb21Qb2ludGVyKHQuZSkpfSksdGhpcy5vbihcInRyaXBsZWNsaWNrXCIsZnVuY3Rpb24odCl7dGhpcy5zZWxlY3RMaW5lKHRoaXMuZ2V0U2VsZWN0aW9uU3RhcnRGcm9tUG9pbnRlcih0LmUpKX0pfSxpbml0TW91c2Vkb3duSGFuZGxlcjpmdW5jdGlvbigpe3RoaXMub24oXCJtb3VzZWRvd25cIixmdW5jdGlvbih0KXt2YXIgZT10aGlzLmNhbnZhcy5nZXRQb2ludGVyKHQuZSk7dGhpcy5fX21vdXNlZG93blg9ZS54LHRoaXMuX19tb3VzZWRvd25ZPWUueSx0aGlzLl9faXNNb3VzZWRvd249ITAsdGhpcy5oaWRkZW5UZXh0YXJlYSYmdGhpcy5jYW52YXMmJnRoaXMuY2FudmFzLndyYXBwZXJFbC5hcHBlbmRDaGlsZCh0aGlzLmhpZGRlblRleHRhcmVhKSx0aGlzLnNlbGVjdGVkJiZ0aGlzLnNldEN1cnNvckJ5Q2xpY2sodC5lKSx0aGlzLmlzRWRpdGluZyYmKHRoaXMuX19zZWxlY3Rpb25TdGFydE9uTW91c2VEb3duPXRoaXMuc2VsZWN0aW9uU3RhcnQsdGhpcy5pbml0RGVsYXllZEN1cnNvcighMCkpfSl9LF9pc09iamVjdE1vdmVkOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuY2FudmFzLmdldFBvaW50ZXIodCk7cmV0dXJuIHRoaXMuX19tb3VzZWRvd25YIT09ZS54fHx0aGlzLl9fbW91c2Vkb3duWSE9PWUueX0saW5pdE1vdXNldXBIYW5kbGVyOmZ1bmN0aW9uKCl7dGhpcy5vbihcIm1vdXNldXBcIixmdW5jdGlvbih0KXt0aGlzLl9faXNNb3VzZWRvd249ITEsdGhpcy5faXNPYmplY3RNb3ZlZCh0LmUpfHwodGhpcy5fX2xhc3RTZWxlY3RlZCYmKHRoaXMuZW50ZXJFZGl0aW5nKCksdGhpcy5pbml0RGVsYXllZEN1cnNvcighMCkpLHRoaXMuc2VsZWN0ZWQ9ITApfSl9LHNldEN1cnNvckJ5Q2xpY2s6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXRTZWxlY3Rpb25TdGFydEZyb21Qb2ludGVyKHQpO3Quc2hpZnRLZXk/ZTx0aGlzLnNlbGVjdGlvblN0YXJ0Pyh0aGlzLnNldFNlbGVjdGlvbkVuZCh0aGlzLnNlbGVjdGlvblN0YXJ0KSx0aGlzLnNldFNlbGVjdGlvblN0YXJ0KGUpKTp0aGlzLnNldFNlbGVjdGlvbkVuZChlKToodGhpcy5zZXRTZWxlY3Rpb25TdGFydChlKSx0aGlzLnNldFNlbGVjdGlvbkVuZChlKSl9LF9nZXRMb2NhbFJvdGF0ZWRQb2ludGVyOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuY2FudmFzLmdldFBvaW50ZXIodCksaT1uZXcgZmFicmljLlBvaW50KGUueCxlLnkpLHI9bmV3IGZhYnJpYy5Qb2ludCh0aGlzLmxlZnQsdGhpcy50b3ApLHM9ZmFicmljLnV0aWwucm90YXRlUG9pbnQoaSxyLGZhYnJpYy51dGlsLmRlZ3JlZXNUb1JhZGlhbnMoLXRoaXMuYW5nbGUpKTtyZXR1cm4gdGhpcy5nZXRMb2NhbFBvaW50ZXIodCxzKX0sZ2V0U2VsZWN0aW9uU3RhcnRGcm9tUG9pbnRlcjpmdW5jdGlvbih0KXtmb3IodmFyIGUsaSxyPXRoaXMuX2dldExvY2FsUm90YXRlZFBvaW50ZXIodCkscz0wLG49MCxvPTAsYT0wLGg9MCxjPXRoaXMuX3RleHRMaW5lcy5sZW5ndGg7Yz5oO2grKyl7aT10aGlzLl90ZXh0TGluZXNbaF0sbys9dGhpcy5fZ2V0SGVpZ2h0T2ZMaW5lKHRoaXMuY3R4LGgpKnRoaXMuc2NhbGVZO3ZhciBsPXRoaXMuX2dldExpbmVXaWR0aCh0aGlzLmN0eCxoKSx1PXRoaXMuX2dldExpbmVMZWZ0T2Zmc2V0KGwpO249dSp0aGlzLnNjYWxlWCx0aGlzLmZsaXBYJiYodGhpcy5fdGV4dExpbmVzW2hdPWkucmV2ZXJzZSgpLmpvaW4oXCJcIikpO2Zvcih2YXIgZj0wLGQ9aS5sZW5ndGg7ZD5mO2YrKyl7aWYocz1uLG4rPXRoaXMuX2dldFdpZHRoT2ZDaGFyKHRoaXMuY3R4LGlbZl0saCx0aGlzLmZsaXBYP2QtZjpmKSp0aGlzLnNjYWxlWCwhKG88PXIueXx8bjw9ci54KSlyZXR1cm4gdGhpcy5fZ2V0TmV3U2VsZWN0aW9uU3RhcnRGcm9tT2Zmc2V0KHIscyxuLGEraCxkKTthKyt9aWYoci55PG8pcmV0dXJuIHRoaXMuX2dldE5ld1NlbGVjdGlvblN0YXJ0RnJvbU9mZnNldChyLHMsbixhK2gsZCl9cmV0dXJuXCJ1bmRlZmluZWRcIj09dHlwZW9mIGU/dGhpcy50ZXh0Lmxlbmd0aDp2b2lkIDB9LF9nZXROZXdTZWxlY3Rpb25TdGFydEZyb21PZmZzZXQ6ZnVuY3Rpb24odCxlLGkscixzKXt2YXIgbj10LngtZSxvPWktdC54LGE9bz5uPzA6MSxoPXIrYTtyZXR1cm4gdGhpcy5mbGlwWCYmKGg9cy1oKSxoPnRoaXMudGV4dC5sZW5ndGgmJihoPXRoaXMudGV4dC5sZW5ndGgpLGh9fSksZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuSVRleHQucHJvdG90eXBlLHtpbml0SGlkZGVuVGV4dGFyZWE6ZnVuY3Rpb24oKXt0aGlzLmhpZGRlblRleHRhcmVhPWZhYnJpYy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGV4dGFyZWFcIiksdGhpcy5oaWRkZW5UZXh0YXJlYS5zZXRBdHRyaWJ1dGUoXCJhdXRvY2FwaXRhbGl6ZVwiLFwib2ZmXCIpLHRoaXMuaGlkZGVuVGV4dGFyZWEuc3R5bGUuY3NzVGV4dD1cInBvc2l0aW9uOiBmaXhlZDsgYm90dG9tOiAyMHB4OyBsZWZ0OiAwcHg7IG9wYWNpdHk6IDA7IHdpZHRoOiAwcHg7IGhlaWdodDogMHB4OyB6LWluZGV4OiAtOTk5O1wiLGZhYnJpYy5kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuaGlkZGVuVGV4dGFyZWEpLGZhYnJpYy51dGlsLmFkZExpc3RlbmVyKHRoaXMuaGlkZGVuVGV4dGFyZWEsXCJrZXlkb3duXCIsdGhpcy5vbktleURvd24uYmluZCh0aGlzKSksZmFicmljLnV0aWwuYWRkTGlzdGVuZXIodGhpcy5oaWRkZW5UZXh0YXJlYSxcImtleXByZXNzXCIsdGhpcy5vbktleVByZXNzLmJpbmQodGhpcykpLGZhYnJpYy51dGlsLmFkZExpc3RlbmVyKHRoaXMuaGlkZGVuVGV4dGFyZWEsXCJjb3B5XCIsdGhpcy5jb3B5LmJpbmQodGhpcykpLGZhYnJpYy51dGlsLmFkZExpc3RlbmVyKHRoaXMuaGlkZGVuVGV4dGFyZWEsXCJwYXN0ZVwiLHRoaXMucGFzdGUuYmluZCh0aGlzKSksIXRoaXMuX2NsaWNrSGFuZGxlckluaXRpYWxpemVkJiZ0aGlzLmNhbnZhcyYmKGZhYnJpYy51dGlsLmFkZExpc3RlbmVyKHRoaXMuY2FudmFzLnVwcGVyQ2FudmFzRWwsXCJjbGlja1wiLHRoaXMub25DbGljay5iaW5kKHRoaXMpKSx0aGlzLl9jbGlja0hhbmRsZXJJbml0aWFsaXplZD0hMCl9LF9rZXlzTWFwOns4OlwicmVtb3ZlQ2hhcnNcIiw5OlwiZXhpdEVkaXRpbmdcIiwyNzpcImV4aXRFZGl0aW5nXCIsMTM6XCJpbnNlcnROZXdsaW5lXCIsMzM6XCJtb3ZlQ3Vyc29yVXBcIiwzNDpcIm1vdmVDdXJzb3JEb3duXCIsMzU6XCJtb3ZlQ3Vyc29yUmlnaHRcIiwzNjpcIm1vdmVDdXJzb3JMZWZ0XCIsMzc6XCJtb3ZlQ3Vyc29yTGVmdFwiLDM4OlwibW92ZUN1cnNvclVwXCIsMzk6XCJtb3ZlQ3Vyc29yUmlnaHRcIiw0MDpcIm1vdmVDdXJzb3JEb3duXCIsNDY6XCJmb3J3YXJkRGVsZXRlXCJ9LF9jdHJsS2V5c01hcDp7NjU6XCJzZWxlY3RBbGxcIiw4ODpcImN1dFwifSxvbkNsaWNrOmZ1bmN0aW9uKCl7dGhpcy5oaWRkZW5UZXh0YXJlYSYmdGhpcy5oaWRkZW5UZXh0YXJlYS5mb2N1cygpfSxvbktleURvd246ZnVuY3Rpb24odCl7aWYodGhpcy5pc0VkaXRpbmcpe2lmKHQua2V5Q29kZSBpbiB0aGlzLl9rZXlzTWFwKXRoaXNbdGhpcy5fa2V5c01hcFt0LmtleUNvZGVdXSh0KTtlbHNle2lmKCEodC5rZXlDb2RlIGluIHRoaXMuX2N0cmxLZXlzTWFwJiYodC5jdHJsS2V5fHx0Lm1ldGFLZXkpKSlyZXR1cm47dGhpc1t0aGlzLl9jdHJsS2V5c01hcFt0LmtleUNvZGVdXSh0KX10LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLHQucHJldmVudERlZmF1bHQoKSx0aGlzLmNhbnZhcyYmdGhpcy5jYW52YXMucmVuZGVyQWxsKCl9fSxmb3J3YXJkRGVsZXRlOmZ1bmN0aW9uKHQpe3RoaXMuc2VsZWN0aW9uU3RhcnQ9PT10aGlzLnNlbGVjdGlvbkVuZCYmdGhpcy5tb3ZlQ3Vyc29yUmlnaHQodCksdGhpcy5yZW1vdmVDaGFycyh0KX0sY29weTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldFNlbGVjdGVkVGV4dCgpLGk9dGhpcy5fZ2V0Q2xpcGJvYXJkRGF0YSh0KTtpJiZpLnNldERhdGEoXCJ0ZXh0XCIsZSksdGhpcy5jb3BpZWRUZXh0PWUsdGhpcy5jb3BpZWRTdHlsZXM9dGhpcy5nZXRTZWxlY3Rpb25TdHlsZXModGhpcy5zZWxlY3Rpb25TdGFydCx0aGlzLnNlbGVjdGlvbkVuZCl9LHBhc3RlOmZ1bmN0aW9uKHQpe3ZhciBlPW51bGwsaT10aGlzLl9nZXRDbGlwYm9hcmREYXRhKHQpO2U9aT9pLmdldERhdGEoXCJ0ZXh0XCIpOnRoaXMuY29waWVkVGV4dCxlJiZ0aGlzLmluc2VydENoYXJzKGUsITApfSxjdXQ6ZnVuY3Rpb24odCl7dGhpcy5zZWxlY3Rpb25TdGFydCE9PXRoaXMuc2VsZWN0aW9uRW5kJiYodGhpcy5jb3B5KCksdGhpcy5yZW1vdmVDaGFycyh0KSl9LF9nZXRDbGlwYm9hcmREYXRhOmZ1bmN0aW9uKHQpe3JldHVybiB0JiYodC5jbGlwYm9hcmREYXRhfHxmYWJyaWMud2luZG93LmNsaXBib2FyZERhdGEpfSxvbktleVByZXNzOmZ1bmN0aW9uKHQpeyF0aGlzLmlzRWRpdGluZ3x8dC5tZXRhS2V5fHx0LmN0cmxLZXl8fCgwIT09dC53aGljaCYmdGhpcy5pbnNlcnRDaGFycyhTdHJpbmcuZnJvbUNoYXJDb2RlKHQud2hpY2gpKSx0LnN0b3BQcm9wYWdhdGlvbigpKX0sZ2V0RG93bkN1cnNvck9mZnNldDpmdW5jdGlvbih0LGUpe3ZhciBpLHIscz1lP3RoaXMuc2VsZWN0aW9uRW5kOnRoaXMuc2VsZWN0aW9uU3RhcnQsbj10aGlzLmdldDJEQ3Vyc29yTG9jYXRpb24ocyksbz1uLmxpbmVJbmRleCxhPXRoaXMuX3RleHRMaW5lc1tvXS5zbGljZSgwLG4uY2hhckluZGV4KSxoPXRoaXMuX3RleHRMaW5lc1tvXS5zbGljZShuLmNoYXJJbmRleCksYz10aGlzLl90ZXh0TGluZXNbbysxXXx8XCJcIjtpZihvPT09dGhpcy5fdGV4dExpbmVzLmxlbmd0aC0xfHx0Lm1ldGFLZXl8fDM0PT09dC5rZXlDb2RlKXJldHVybiB0aGlzLnRleHQubGVuZ3RoLXM7dmFyIGw9dGhpcy5fZ2V0TGluZVdpZHRoKHRoaXMuY3R4LG8pO3I9dGhpcy5fZ2V0TGluZUxlZnRPZmZzZXQobCk7Zm9yKHZhciB1PXIsZj0wLGQ9YS5sZW5ndGg7ZD5mO2YrKylpPWFbZl0sdSs9dGhpcy5fZ2V0V2lkdGhPZkNoYXIodGhpcy5jdHgsaSxvLGYpO3ZhciBnPXRoaXMuX2dldEluZGV4T25OZXh0TGluZShuLGMsdSk7cmV0dXJuIGgubGVuZ3RoKzErZ30sX2dldEluZGV4T25OZXh0TGluZTpmdW5jdGlvbih0LGUsaSl7Zm9yKHZhciByLHM9dC5saW5lSW5kZXgrMSxuPXRoaXMuX2dldExpbmVXaWR0aCh0aGlzLmN0eCxzKSxvPXRoaXMuX2dldExpbmVMZWZ0T2Zmc2V0KG4pLGE9byxoPTAsYz0wLGw9ZS5sZW5ndGg7bD5jO2MrKyl7dmFyIHU9ZVtjXSxmPXRoaXMuX2dldFdpZHRoT2ZDaGFyKHRoaXMuY3R4LHUscyxjKTtpZihhKz1mLGE+aSl7cj0hMDt2YXIgZD1hLWYsZz1hLHA9TWF0aC5hYnMoZC1pKSx2PU1hdGguYWJzKGctaSk7aD1wPnY/YysxOmM7YnJlYWt9fXJldHVybiByfHwoaD1lLmxlbmd0aCksaH0sbW92ZUN1cnNvckRvd246ZnVuY3Rpb24odCl7dGhpcy5hYm9ydEN1cnNvckFuaW1hdGlvbigpLHRoaXMuX2N1cnJlbnRDdXJzb3JPcGFjaXR5PTE7dmFyIGU9dGhpcy5nZXREb3duQ3Vyc29yT2Zmc2V0KHQsXCJyaWdodFwiPT09dGhpcy5fc2VsZWN0aW9uRGlyZWN0aW9uKTt0LnNoaWZ0S2V5P3RoaXMubW92ZUN1cnNvckRvd25XaXRoU2hpZnQoZSk6dGhpcy5tb3ZlQ3Vyc29yRG93bldpdGhvdXRTaGlmdChlKSx0aGlzLmluaXREZWxheWVkQ3Vyc29yKCl9LG1vdmVDdXJzb3JEb3duV2l0aG91dFNoaWZ0OmZ1bmN0aW9uKHQpe3RoaXMuX3NlbGVjdGlvbkRpcmVjdGlvbj1cInJpZ2h0XCIsdGhpcy5zZXRTZWxlY3Rpb25TdGFydCh0aGlzLnNlbGVjdGlvblN0YXJ0K3QpLHRoaXMuc2V0U2VsZWN0aW9uRW5kKHRoaXMuc2VsZWN0aW9uU3RhcnQpfSxzd2FwU2VsZWN0aW9uUG9pbnRzOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5zZWxlY3Rpb25FbmQ7dGhpcy5zZXRTZWxlY3Rpb25FbmQodGhpcy5zZWxlY3Rpb25TdGFydCksdGhpcy5zZXRTZWxlY3Rpb25TdGFydCh0KX0sbW92ZUN1cnNvckRvd25XaXRoU2hpZnQ6ZnVuY3Rpb24odCl7dGhpcy5zZWxlY3Rpb25FbmQ9PT10aGlzLnNlbGVjdGlvblN0YXJ0JiYodGhpcy5fc2VsZWN0aW9uRGlyZWN0aW9uPVwicmlnaHRcIiksXCJyaWdodFwiPT09dGhpcy5fc2VsZWN0aW9uRGlyZWN0aW9uP3RoaXMuc2V0U2VsZWN0aW9uRW5kKHRoaXMuc2VsZWN0aW9uRW5kK3QpOnRoaXMuc2V0U2VsZWN0aW9uU3RhcnQodGhpcy5zZWxlY3Rpb25TdGFydCt0KSx0aGlzLnNlbGVjdGlvbkVuZDx0aGlzLnNlbGVjdGlvblN0YXJ0JiZcImxlZnRcIj09PXRoaXMuX3NlbGVjdGlvbkRpcmVjdGlvbiYmKHRoaXMuc3dhcFNlbGVjdGlvblBvaW50cygpLHRoaXMuX3NlbGVjdGlvbkRpcmVjdGlvbj1cInJpZ2h0XCIpLHRoaXMuc2VsZWN0aW9uRW5kPnRoaXMudGV4dC5sZW5ndGgmJnRoaXMuc2V0U2VsZWN0aW9uRW5kKHRoaXMudGV4dC5sZW5ndGgpfSxnZXRVcEN1cnNvck9mZnNldDpmdW5jdGlvbih0LGUpe3ZhciBpPWU/dGhpcy5zZWxlY3Rpb25FbmQ6dGhpcy5zZWxlY3Rpb25TdGFydCxyPXRoaXMuZ2V0MkRDdXJzb3JMb2NhdGlvbihpKSxzPXIubGluZUluZGV4O2lmKDA9PT1zfHx0Lm1ldGFLZXl8fDMzPT09dC5rZXlDb2RlKXJldHVybiBpO2Zvcih2YXIgbixvPXRoaXMuX3RleHRMaW5lc1tzXS5zbGljZSgwLHIuY2hhckluZGV4KSxhPXRoaXMuX3RleHRMaW5lc1tzLTFdfHxcIlwiLGg9dGhpcy5fZ2V0TGluZVdpZHRoKHRoaXMuY3R4LHIubGluZUluZGV4KSxjPXRoaXMuX2dldExpbmVMZWZ0T2Zmc2V0KGgpLGw9Yyx1PTAsZj1vLmxlbmd0aDtmPnU7dSsrKW49b1t1XSxsKz10aGlzLl9nZXRXaWR0aE9mQ2hhcih0aGlzLmN0eCxuLHMsdSk7dmFyIGQ9dGhpcy5fZ2V0SW5kZXhPblByZXZMaW5lKHIsYSxsKTtyZXR1cm4gYS5sZW5ndGgtZCtvLmxlbmd0aH0sX2dldEluZGV4T25QcmV2TGluZTpmdW5jdGlvbih0LGUsaSl7Zm9yKHZhciByLHM9dC5saW5lSW5kZXgtMSxuPXRoaXMuX2dldExpbmVXaWR0aCh0aGlzLmN0eCxzKSxvPXRoaXMuX2dldExpbmVMZWZ0T2Zmc2V0KG4pLGE9byxoPTAsYz0wLGw9ZS5sZW5ndGg7bD5jO2MrKyl7dmFyIHU9ZVtjXSxmPXRoaXMuX2dldFdpZHRoT2ZDaGFyKHRoaXMuY3R4LHUscyxjKTtpZihhKz1mLGE+aSl7cj0hMDt2YXIgZD1hLWYsZz1hLHA9TWF0aC5hYnMoZC1pKSx2PU1hdGguYWJzKGctaSk7aD1wPnY/YzpjLTE7YnJlYWt9fXJldHVybiByfHwoaD1lLmxlbmd0aC0xKSxofSxtb3ZlQ3Vyc29yVXA6ZnVuY3Rpb24odCl7dGhpcy5hYm9ydEN1cnNvckFuaW1hdGlvbigpLHRoaXMuX2N1cnJlbnRDdXJzb3JPcGFjaXR5PTE7dmFyIGU9dGhpcy5nZXRVcEN1cnNvck9mZnNldCh0LFwicmlnaHRcIj09PXRoaXMuX3NlbGVjdGlvbkRpcmVjdGlvbik7dC5zaGlmdEtleT90aGlzLm1vdmVDdXJzb3JVcFdpdGhTaGlmdChlKTp0aGlzLm1vdmVDdXJzb3JVcFdpdGhvdXRTaGlmdChlKSx0aGlzLmluaXREZWxheWVkQ3Vyc29yKCl9LG1vdmVDdXJzb3JVcFdpdGhTaGlmdDpmdW5jdGlvbih0KXt0aGlzLnNlbGVjdGlvbkVuZD09PXRoaXMuc2VsZWN0aW9uU3RhcnQmJih0aGlzLl9zZWxlY3Rpb25EaXJlY3Rpb249XCJsZWZ0XCIpLFwicmlnaHRcIj09PXRoaXMuX3NlbGVjdGlvbkRpcmVjdGlvbj90aGlzLnNldFNlbGVjdGlvbkVuZCh0aGlzLnNlbGVjdGlvbkVuZC10KTp0aGlzLnNldFNlbGVjdGlvblN0YXJ0KHRoaXMuc2VsZWN0aW9uU3RhcnQtdCksdGhpcy5zZWxlY3Rpb25FbmQ8dGhpcy5zZWxlY3Rpb25TdGFydCYmXCJyaWdodFwiPT09dGhpcy5fc2VsZWN0aW9uRGlyZWN0aW9uJiYodGhpcy5zd2FwU2VsZWN0aW9uUG9pbnRzKCksdGhpcy5fc2VsZWN0aW9uRGlyZWN0aW9uPVwibGVmdFwiKX0sbW92ZUN1cnNvclVwV2l0aG91dFNoaWZ0OmZ1bmN0aW9uKHQpe3RoaXMuc2VsZWN0aW9uU3RhcnQ9PT10aGlzLnNlbGVjdGlvbkVuZCYmdGhpcy5zZXRTZWxlY3Rpb25TdGFydCh0aGlzLnNlbGVjdGlvblN0YXJ0LXQpLHRoaXMuc2V0U2VsZWN0aW9uRW5kKHRoaXMuc2VsZWN0aW9uU3RhcnQpLHRoaXMuX3NlbGVjdGlvbkRpcmVjdGlvbj1cImxlZnRcIn0sbW92ZUN1cnNvckxlZnQ6ZnVuY3Rpb24odCl7KDAhPT10aGlzLnNlbGVjdGlvblN0YXJ0fHwwIT09dGhpcy5zZWxlY3Rpb25FbmQpJiYodGhpcy5hYm9ydEN1cnNvckFuaW1hdGlvbigpLHRoaXMuX2N1cnJlbnRDdXJzb3JPcGFjaXR5PTEsdC5zaGlmdEtleT90aGlzLm1vdmVDdXJzb3JMZWZ0V2l0aFNoaWZ0KHQpOnRoaXMubW92ZUN1cnNvckxlZnRXaXRob3V0U2hpZnQodCksdGhpcy5pbml0RGVsYXllZEN1cnNvcigpKX0sX21vdmU6ZnVuY3Rpb24odCxlLGkpe3ZhciByPVwic2VsZWN0aW9uU3RhcnRcIj09PWU/XCJzZXRTZWxlY3Rpb25TdGFydFwiOlwic2V0U2VsZWN0aW9uRW5kXCI7dGhpc1tyXSh0LmFsdEtleT90aGlzW1wiZmluZFdvcmRCb3VuZGFyeVwiK2ldKHRoaXNbZV0pOnQubWV0YUtleXx8MzU9PT10LmtleUNvZGV8fDM2PT09dC5rZXlDb2RlP3RoaXNbXCJmaW5kTGluZUJvdW5kYXJ5XCIraV0odGhpc1tlXSk6dGhpc1tlXSsoXCJMZWZ0XCI9PT1pPy0xOjEpKX0sX21vdmVMZWZ0OmZ1bmN0aW9uKHQsZSl7dGhpcy5fbW92ZSh0LGUsXCJMZWZ0XCIpfSxfbW92ZVJpZ2h0OmZ1bmN0aW9uKHQsZSl7dGhpcy5fbW92ZSh0LGUsXCJSaWdodFwiKX0sbW92ZUN1cnNvckxlZnRXaXRob3V0U2hpZnQ6ZnVuY3Rpb24odCl7dGhpcy5fc2VsZWN0aW9uRGlyZWN0aW9uPVwibGVmdFwiLHRoaXMuc2VsZWN0aW9uRW5kPT09dGhpcy5zZWxlY3Rpb25TdGFydCYmdGhpcy5fbW92ZUxlZnQodCxcInNlbGVjdGlvblN0YXJ0XCIpLHRoaXMuc2V0U2VsZWN0aW9uRW5kKHRoaXMuc2VsZWN0aW9uU3RhcnQpfSxtb3ZlQ3Vyc29yTGVmdFdpdGhTaGlmdDpmdW5jdGlvbih0KXtcInJpZ2h0XCI9PT10aGlzLl9zZWxlY3Rpb25EaXJlY3Rpb24mJnRoaXMuc2VsZWN0aW9uU3RhcnQhPT10aGlzLnNlbGVjdGlvbkVuZD90aGlzLl9tb3ZlTGVmdCh0LFwic2VsZWN0aW9uRW5kXCIpOih0aGlzLl9zZWxlY3Rpb25EaXJlY3Rpb249XCJsZWZ0XCIsdGhpcy5fbW92ZUxlZnQodCxcInNlbGVjdGlvblN0YXJ0XCIpKX0sbW92ZUN1cnNvclJpZ2h0OmZ1bmN0aW9uKHQpe3RoaXMuc2VsZWN0aW9uU3RhcnQ+PXRoaXMudGV4dC5sZW5ndGgmJnRoaXMuc2VsZWN0aW9uRW5kPj10aGlzLnRleHQubGVuZ3RofHwodGhpcy5hYm9ydEN1cnNvckFuaW1hdGlvbigpLHRoaXMuX2N1cnJlbnRDdXJzb3JPcGFjaXR5PTEsdC5zaGlmdEtleT90aGlzLm1vdmVDdXJzb3JSaWdodFdpdGhTaGlmdCh0KTp0aGlzLm1vdmVDdXJzb3JSaWdodFdpdGhvdXRTaGlmdCh0KSx0aGlzLmluaXREZWxheWVkQ3Vyc29yKCkpfSxtb3ZlQ3Vyc29yUmlnaHRXaXRoU2hpZnQ6ZnVuY3Rpb24odCl7XCJsZWZ0XCI9PT10aGlzLl9zZWxlY3Rpb25EaXJlY3Rpb24mJnRoaXMuc2VsZWN0aW9uU3RhcnQhPT10aGlzLnNlbGVjdGlvbkVuZD90aGlzLl9tb3ZlUmlnaHQodCxcInNlbGVjdGlvblN0YXJ0XCIpOih0aGlzLl9zZWxlY3Rpb25EaXJlY3Rpb249XCJyaWdodFwiLHRoaXMuX21vdmVSaWdodCh0LFwic2VsZWN0aW9uRW5kXCIpKX0sbW92ZUN1cnNvclJpZ2h0V2l0aG91dFNoaWZ0OmZ1bmN0aW9uKHQpe3RoaXMuX3NlbGVjdGlvbkRpcmVjdGlvbj1cInJpZ2h0XCIsdGhpcy5zZWxlY3Rpb25TdGFydD09PXRoaXMuc2VsZWN0aW9uRW5kPyh0aGlzLl9tb3ZlUmlnaHQodCxcInNlbGVjdGlvblN0YXJ0XCIpLHRoaXMuc2V0U2VsZWN0aW9uRW5kKHRoaXMuc2VsZWN0aW9uU3RhcnQpKToodGhpcy5zZXRTZWxlY3Rpb25FbmQodGhpcy5zZWxlY3Rpb25FbmQrdGhpcy5nZXROdW1OZXdMaW5lc0luU2VsZWN0ZWRUZXh0KCkpLHRoaXMuc2V0U2VsZWN0aW9uU3RhcnQodGhpcy5zZWxlY3Rpb25FbmQpKX0scmVtb3ZlQ2hhcnM6ZnVuY3Rpb24odCl7dGhpcy5zZWxlY3Rpb25TdGFydD09PXRoaXMuc2VsZWN0aW9uRW5kP3RoaXMuX3JlbW92ZUNoYXJzTmVhckN1cnNvcih0KTp0aGlzLl9yZW1vdmVDaGFyc0Zyb21Ubyh0aGlzLnNlbGVjdGlvblN0YXJ0LHRoaXMuc2VsZWN0aW9uRW5kKSx0aGlzLnNldFNlbGVjdGlvbkVuZCh0aGlzLnNlbGVjdGlvblN0YXJ0KSx0aGlzLl9yZW1vdmVFeHRyYW5lb3VzU3R5bGVzKCksdGhpcy5fY2xlYXJDYWNoZSgpLHRoaXMuY2FudmFzJiZ0aGlzLmNhbnZhcy5yZW5kZXJBbGwoKSx0aGlzLnNldENvb3JkcygpLHRoaXMuZmlyZShcImNoYW5nZWRcIiksdGhpcy5jYW52YXMmJnRoaXMuY2FudmFzLmZpcmUoXCJ0ZXh0OmNoYW5nZWRcIix7dGFyZ2V0OnRoaXN9KX0sX3JlbW92ZUNoYXJzTmVhckN1cnNvcjpmdW5jdGlvbih0KXtpZigwIT09dGhpcy5zZWxlY3Rpb25TdGFydClpZih0Lm1ldGFLZXkpe3ZhciBlPXRoaXMuZmluZExpbmVCb3VuZGFyeUxlZnQodGhpcy5zZWxlY3Rpb25TdGFydCk7dGhpcy5fcmVtb3ZlQ2hhcnNGcm9tVG8oZSx0aGlzLnNlbGVjdGlvblN0YXJ0KSx0aGlzLnNldFNlbGVjdGlvblN0YXJ0KGUpfWVsc2UgaWYodC5hbHRLZXkpe3ZhciBpPXRoaXMuZmluZFdvcmRCb3VuZGFyeUxlZnQodGhpcy5zZWxlY3Rpb25TdGFydCk7dGhpcy5fcmVtb3ZlQ2hhcnNGcm9tVG8oaSx0aGlzLnNlbGVjdGlvblN0YXJ0KSx0aGlzLnNldFNlbGVjdGlvblN0YXJ0KGkpfWVsc2UgdGhpcy5fcmVtb3ZlU2luZ2xlQ2hhckFuZFN0eWxlKHRoaXMuc2VsZWN0aW9uU3RhcnQpLHRoaXMuc2V0U2VsZWN0aW9uU3RhcnQodGhpcy5zZWxlY3Rpb25TdGFydC0xKX19KSxmdW5jdGlvbigpe3ZhciB0PWZhYnJpYy51dGlsLnRvRml4ZWQsZT1mYWJyaWMuT2JqZWN0Lk5VTV9GUkFDVElPTl9ESUdJVFM7ZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuSVRleHQucHJvdG90eXBlLHtfc2V0U1ZHVGV4dExpbmVUZXh0OmZ1bmN0aW9uKHQsZSxpLHIscyxuKXt0aGlzLnN0eWxlc1t0XT90aGlzLl9zZXRTVkdUZXh0TGluZUNoYXJzKHQsZSxpLHIsbik6dGhpcy5jYWxsU3VwZXIoXCJfc2V0U1ZHVGV4dExpbmVUZXh0XCIsdCxlLGkscixzKX0sX3NldFNWR1RleHRMaW5lQ2hhcnM6ZnVuY3Rpb24odCxlLGkscixzKXtmb3IodmFyIG49dGhpcy5fdGV4dExpbmVzW3RdLG89MCxhPXRoaXMuX2dldFNWR0xpbmVMZWZ0T2Zmc2V0KHQpLXRoaXMud2lkdGgvMixoPXRoaXMuX2dldFNWR0xpbmVUb3BPZmZzZXQodCksYz10aGlzLl9nZXRIZWlnaHRPZkxpbmUodGhpcy5jdHgsdCksbD0wLHU9bi5sZW5ndGg7dT5sO2wrKyl7dmFyIGY9dGhpcy5zdHlsZXNbdF1bbF18fHt9O2UucHVzaCh0aGlzLl9jcmVhdGVUZXh0Q2hhclNwYW4obltsXSxmLGEsaC5saW5lVG9wK2gub2Zmc2V0LG8pKTt2YXIgZD10aGlzLl9nZXRXaWR0aE9mQ2hhcih0aGlzLmN0eCxuW2xdLHQsbCk7Zi50ZXh0QmFja2dyb3VuZENvbG9yJiZzLnB1c2godGhpcy5fY3JlYXRlVGV4dENoYXJCZyhmLGEsaC5saW5lVG9wLGMsZCxvKSksbys9ZH19LF9nZXRTVkdMaW5lTGVmdE9mZnNldDpmdW5jdGlvbih0KXtyZXR1cm4gZmFicmljLnV0aWwudG9GaXhlZCh0aGlzLl9nZXRMaW5lTGVmdE9mZnNldCh0aGlzLl9fbGluZVdpZHRoc1t0XSksMil9LF9nZXRTVkdMaW5lVG9wT2Zmc2V0OmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT0wLGk9MCxyPTA7dD5yO3IrKyllKz10aGlzLl9nZXRIZWlnaHRPZkxpbmUodGhpcy5jdHgscik7cmV0dXJuIGk9dGhpcy5fZ2V0SGVpZ2h0T2ZMaW5lKHRoaXMuY3R4LHIpLHtsaW5lVG9wOmUsb2Zmc2V0Oih0aGlzLl9mb250U2l6ZU11bHQtdGhpcy5fZm9udFNpemVGcmFjdGlvbikqaS8odGhpcy5saW5lSGVpZ2h0KnRoaXMuX2ZvbnRTaXplTXVsdCl9fSxfY3JlYXRlVGV4dENoYXJCZzpmdW5jdGlvbihpLHIscyxuLG8sYSl7cmV0dXJuWyc8cmVjdCBmaWxsPVwiJyxpLnRleHRCYWNrZ3JvdW5kQ29sb3IsJ1wiIHg9XCInLHQocithLGUpLCdcIiB5PVwiJyx0KHMtdGhpcy5oZWlnaHQvMixlKSwnXCIgd2lkdGg9XCInLHQobyxlKSwnXCIgaGVpZ2h0PVwiJyx0KG4vdGhpcy5saW5lSGVpZ2h0LGUpLCdcIj48L3JlY3Q+J10uam9pbihcIlwiKX0sX2NyZWF0ZVRleHRDaGFyU3BhbjpmdW5jdGlvbih0LGUsaSxyLHMpe3ZhciBuPXRoaXMuZ2V0U3ZnU3R5bGVzLmNhbGwoZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZCh7dmlzaWJsZTohMCxmaWxsOnRoaXMuZmlsbCxzdHJva2U6dGhpcy5zdHJva2UsdHlwZTpcInRleHRcIn0sZSkpO3JldHVyblsnPHRzcGFuIHg9XCInLGkrcywnXCIgeT1cIicsci10aGlzLmhlaWdodC8yLCdcIiAnLGUuZm9udEZhbWlseT8nZm9udC1mYW1pbHk9XCInK2UuZm9udEZhbWlseS5yZXBsYWNlKC9cIi9nLFwiJ1wiKSsnXCIgJzpcIlwiLGUuZm9udFNpemU/J2ZvbnQtc2l6ZT1cIicrZS5mb250U2l6ZSsnXCIgJzpcIlwiLGUuZm9udFN0eWxlPydmb250LXN0eWxlPVwiJytlLmZvbnRTdHlsZSsnXCIgJzpcIlwiLGUuZm9udFdlaWdodD8nZm9udC13ZWlnaHQ9XCInK2UuZm9udFdlaWdodCsnXCIgJzpcIlwiLGUudGV4dERlY29yYXRpb24/J3RleHQtZGVjb3JhdGlvbj1cIicrZS50ZXh0RGVjb3JhdGlvbisnXCIgJzpcIlwiLCdzdHlsZT1cIicsbiwnXCI+JyxmYWJyaWMudXRpbC5zdHJpbmcuZXNjYXBlWG1sKHQpLFwiPC90c3Bhbj5cIl0uam9pbihcIlwiKTtcclxuXHJcbn19KX0oKSxmdW5jdGlvbigpe2Z1bmN0aW9uIHJlcXVlc3QodCxlLGkpe3ZhciByPVVSTC5wYXJzZSh0KTtyLnBvcnR8fChyLnBvcnQ9MD09PXIucHJvdG9jb2wuaW5kZXhPZihcImh0dHBzOlwiKT80NDM6ODApO3ZhciBzPTA9PT1yLnByb3RvY29sLmluZGV4T2YoXCJodHRwczpcIik/SFRUUFM6SFRUUCxuPXMucmVxdWVzdCh7aG9zdG5hbWU6ci5ob3N0bmFtZSxwb3J0OnIucG9ydCxwYXRoOnIucGF0aCxtZXRob2Q6XCJHRVRcIn0sZnVuY3Rpb24odCl7dmFyIHI9XCJcIjtlJiZ0LnNldEVuY29kaW5nKGUpLHQub24oXCJlbmRcIixmdW5jdGlvbigpe2kocil9KSx0Lm9uKFwiZGF0YVwiLGZ1bmN0aW9uKGUpezIwMD09PXQuc3RhdHVzQ29kZSYmKHIrPWUpfSl9KTtuLm9uKFwiZXJyb3JcIixmdW5jdGlvbih0KXtmYWJyaWMubG9nKHQuZXJybm89PT1wcm9jZXNzLkVDT05OUkVGVVNFRD9cIkVDT05OUkVGVVNFRDogY29ubmVjdGlvbiByZWZ1c2VkIHRvIFwiK3IuaG9zdG5hbWUrXCI6XCIrci5wb3J0OnQubWVzc2FnZSksaShudWxsKX0pLG4uZW5kKCl9ZnVuY3Rpb24gcmVxdWVzdEZzKHQsZSl7dmFyIGk9cmVxdWlyZShcImZzXCIpO2kucmVhZEZpbGUodCxmdW5jdGlvbih0LGkpe2lmKHQpdGhyb3cgZmFicmljLmxvZyh0KSx0O2UoaSl9KX1pZihcInVuZGVmaW5lZFwiPT10eXBlb2YgZG9jdW1lbnR8fFwidW5kZWZpbmVkXCI9PXR5cGVvZiB3aW5kb3cpe3ZhciBET01QYXJzZXI9cmVxdWlyZShcInhtbGRvbVwiKS5ET01QYXJzZXIsVVJMPXJlcXVpcmUoXCJ1cmxcIiksSFRUUD1yZXF1aXJlKFwiaHR0cFwiKSxIVFRQUz1yZXF1aXJlKFwiaHR0cHNcIiksQ2FudmFzPXJlcXVpcmUoXCJjYW52YXNcIiksSW1hZ2U9cmVxdWlyZShcImNhbnZhc1wiKS5JbWFnZTtmYWJyaWMudXRpbC5sb2FkSW1hZ2U9ZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIHIocil7cj8ocy5zcmM9bmV3IEJ1ZmZlcihyLFwiYmluYXJ5XCIpLHMuX3NyYz10LGUmJmUuY2FsbChpLHMpKToocz1udWxsLGUmJmUuY2FsbChpLG51bGwsITApKX12YXIgcz1uZXcgSW1hZ2U7dCYmKHQgaW5zdGFuY2VvZiBCdWZmZXJ8fDA9PT10LmluZGV4T2YoXCJkYXRhXCIpKT8ocy5zcmM9cy5fc3JjPXQsZSYmZS5jYWxsKGkscykpOnQmJjAhPT10LmluZGV4T2YoXCJodHRwXCIpP3JlcXVlc3RGcyh0LHIpOnQ/cmVxdWVzdCh0LFwiYmluYXJ5XCIscik6ZSYmZS5jYWxsKGksdCl9LGZhYnJpYy5sb2FkU1ZHRnJvbVVSTD1mdW5jdGlvbih0LGUsaSl7dD10LnJlcGxhY2UoL15cXG5cXHMqLyxcIlwiKS5yZXBsYWNlKC9cXD8uKiQvLFwiXCIpLnRyaW0oKSwwIT09dC5pbmRleE9mKFwiaHR0cFwiKT9yZXF1ZXN0RnModCxmdW5jdGlvbih0KXtmYWJyaWMubG9hZFNWR0Zyb21TdHJpbmcodC50b1N0cmluZygpLGUsaSl9KTpyZXF1ZXN0KHQsXCJcIixmdW5jdGlvbih0KXtmYWJyaWMubG9hZFNWR0Zyb21TdHJpbmcodCxlLGkpfSl9LGZhYnJpYy5sb2FkU1ZHRnJvbVN0cmluZz1mdW5jdGlvbih0LGUsaSl7dmFyIHI9KG5ldyBET01QYXJzZXIpLnBhcnNlRnJvbVN0cmluZyh0KTtmYWJyaWMucGFyc2VTVkdEb2N1bWVudChyLmRvY3VtZW50RWxlbWVudCxmdW5jdGlvbih0LGkpe2UmJmUodCxpKX0saSl9LGZhYnJpYy51dGlsLmdldFNjcmlwdD1mdW5jdGlvbih1cmwsY2FsbGJhY2spe3JlcXVlc3QodXJsLFwiXCIsZnVuY3Rpb24oYm9keSl7ZXZhbChib2R5KSxjYWxsYmFjayYmY2FsbGJhY2soKX0pfSxmYWJyaWMuSW1hZ2UuZnJvbU9iamVjdD1mdW5jdGlvbih0LGUpe2ZhYnJpYy51dGlsLmxvYWRJbWFnZSh0LnNyYyxmdW5jdGlvbihpKXt2YXIgcj1uZXcgZmFicmljLkltYWdlKGkpO3IuX2luaXRDb25maWcodCksci5faW5pdEZpbHRlcnModC5maWx0ZXJzLGZ1bmN0aW9uKGkpe3IuZmlsdGVycz1pfHxbXSxyLl9pbml0RmlsdGVycyh0LnJlc2l6ZUZpbHRlcnMsZnVuY3Rpb24odCl7ci5yZXNpemVGaWx0ZXJzPXR8fFtdLGUmJmUocil9KX0pfSl9LGZhYnJpYy5jcmVhdGVDYW52YXNGb3JOb2RlPWZ1bmN0aW9uKHQsZSxpLHIpe3I9cnx8aTt2YXIgcz1mYWJyaWMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKSxuPW5ldyBDYW52YXModHx8NjAwLGV8fDYwMCxyKTtzLnN0eWxlPXt9LHMud2lkdGg9bi53aWR0aCxzLmhlaWdodD1uLmhlaWdodDt2YXIgbz1mYWJyaWMuQ2FudmFzfHxmYWJyaWMuU3RhdGljQ2FudmFzLGE9bmV3IG8ocyxpKTtyZXR1cm4gYS5jb250ZXh0Q29udGFpbmVyPW4uZ2V0Q29udGV4dChcIjJkXCIpLGEubm9kZUNhbnZhcz1uLGEuRm9udD1DYW52YXMuRm9udCxhfSxmYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZS5jcmVhdGVQTkdTdHJlYW09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2RlQ2FudmFzLmNyZWF0ZVBOR1N0cmVhbSgpfSxmYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZS5jcmVhdGVKUEVHU3RyZWFtPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm5vZGVDYW52YXMuY3JlYXRlSlBFR1N0cmVhbSh0KX07dmFyIG9yaWdTZXRXaWR0aD1mYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZS5zZXRXaWR0aDtmYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZS5zZXRXaWR0aD1mdW5jdGlvbih0LGUpe3JldHVybiBvcmlnU2V0V2lkdGguY2FsbCh0aGlzLHQsZSksdGhpcy5ub2RlQ2FudmFzLndpZHRoPXQsdGhpc30sZmFicmljLkNhbnZhcyYmKGZhYnJpYy5DYW52YXMucHJvdG90eXBlLnNldFdpZHRoPWZhYnJpYy5TdGF0aWNDYW52YXMucHJvdG90eXBlLnNldFdpZHRoKTt2YXIgb3JpZ1NldEhlaWdodD1mYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZS5zZXRIZWlnaHQ7ZmFicmljLlN0YXRpY0NhbnZhcy5wcm90b3R5cGUuc2V0SGVpZ2h0PWZ1bmN0aW9uKHQsZSl7cmV0dXJuIG9yaWdTZXRIZWlnaHQuY2FsbCh0aGlzLHQsZSksdGhpcy5ub2RlQ2FudmFzLmhlaWdodD10LHRoaXN9LGZhYnJpYy5DYW52YXMmJihmYWJyaWMuQ2FudmFzLnByb3RvdHlwZS5zZXRIZWlnaHQ9ZmFicmljLlN0YXRpY0NhbnZhcy5wcm90b3R5cGUuc2V0SGVpZ2h0KX19KCk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ0ltYWdlRWRpdG9yJywgWyduZ01hdGVyaWFsJywgJ25nQW5pbWF0ZScsICd1aS5zb3J0YWJsZScsICdpbWFnZS5jcm9wJywgJ2ltYWdlLnRleHQnLCAnaW1hZ2UuZHJhd2luZycsICdpbWFnZS5maWx0ZXJzJywgJ2ltYWdlLnNoYXBlcycsICdpbWFnZS5kaXJlY3RpdmVzJywgJ2ltYWdlLmJhc2ljcyddKVxyXG5cclxuLmNvbmZpZyhbJyRtZFRoZW1pbmdQcm92aWRlcicsIGZ1bmN0aW9uKCRtZFRoZW1pbmdQcm92aWRlcikge1xyXG4gICAgJG1kVGhlbWluZ1Byb3ZpZGVyLnRoZW1lKCdkZWZhdWx0JylcclxuICAgICAgICAucHJpbWFyeVBhbGV0dGUoJ2RlZXAtb3JhbmdlJylcclxuICAgICAgICAuYWNjZW50UGFsZXR0ZSgnYnJvd24nKTsgXHJcbn1dKVxyXG5cclxuLmNvbnRyb2xsZXIoJ01haW5Db250cm9sbGVyJywgWyckcm9vdFNjb3BlJywgJyRzY29wZScsICckdGltZW91dCcsICckJHJBRicsICckbWRCb3R0b21TaGVldCcsICdjYW52YXMnLCAnaGlzdG9yeScsICdzaW1wbGVTaGFwZXMnLCAnZmlsdGVycycsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJHRpbWVvdXQsICQkckFGLCAkbWRCb3R0b21TaGVldCwgY2FudmFzLCBoaXN0b3J5LCBzaW1wbGVTaGFwZXMsIGZpbHRlcnMpIHtcclxuXHJcbiAgICAvL3RydWUgYWZ0ZXIgdXNlciB1cGxvYWRzIGFuIGltYWdlIG9yIGNyZWF0ZSBhIG5ldyBjYW52YXNcclxuICAgICRyb290U2NvcGUuc3RhcnRlZCA9IGZhbHNlO1xyXG5cclxuICAgIC8vY2hlY2sgaWYgd2UncmUgb24gYSBkZW1vIHNpdGVcclxuICAgICRyb290U2NvcGUuaXNEZW1vID0gZG9jdW1lbnQuVVJMLmluZGV4T2YoJ3BpeGllLnZlYnRvLmNvbScpID4gLTE7XHJcblxyXG4gICAgJHJvb3RTY29wZS5pc0ludGVncmF0aW9uTW9kZSA9IGZhbHNlOyBcclxuICAgIHZhciBwYXJhbXMgPSBsb2NhdGlvbi5zZWFyY2guc3Vic3RyaW5nKDEpLnNwbGl0KCcmJyk7XHJcbiAgICB2YXIgdmFsdWVzID0ge307XHJcbiAgICBmb3IodmFyIGlkIGluIHBhcmFtcyl7XHJcbiAgICAgICAgdmFyIGtleV92YWx1ZSA9IHBhcmFtc1tpZF0uc3BsaXQoJz0nKTtcclxuICAgICAgICB2YWx1ZXNba2V5X3ZhbHVlWzBdXSA9IGtleV92YWx1ZVsxXTtcclxuICAgIH1cclxuICAgICRyb290U2NvcGUub3JkZXJfaWQgPXZhbHVlc1snb3JkZXJfaWQnXTtcclxuICAgICRyb290U2NvcGUucHJvZHVjdF9pZCA9IHZhbHVlc1sncHJvZHVjdF9pZCddO1xyXG5cclxuICAgIC8vY2hlY2sgaWYgd2UncmUgcnVubmluZyBpbiBpbnRlZ3JhdGlvbiBtb2RlXHJcbiAgICB0cnkge1xyXG4gICAgICAgIGlmICh3aW5kb3cuc2VsZiAhPT0gd2luZG93LnRvcCkgeyBcclxuICAgICAgICAgICAgJCgnc2NyaXB0Jywgd2luZG93LnBhcmVudC5kb2N1bWVudCkuZWFjaChmdW5jdGlvbihpLCBub2RlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobm9kZS5zcmMuaW5kZXhPZigncGl4aWUtaW50ZWdyYXRlJykgPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuaXNJbnRlZ3JhdGlvbk1vZGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICRyb290U2NvcGUuaXNJbnRlZ3JhdGlvbk1vZGUgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvL2dldCBhIHJlZmVyZW5jZSB0byB0b3Agd2luZG93IGlmIHdlJ3JlIGluc2lkZSBpZnJhbWVcclxuICAgIGlmICgkcm9vdFNjb3BlLmlzSW50ZWdyYXRpb25Nb2RlKSB7XHJcbiAgICAgICAgJHJvb3RTY29wZS5waXhpZSA9IHdpbmRvdy5wYXJlbnQuUGl4aWU7XHJcbiAgICB9XHJcblxyXG4gICAgJHJvb3RTY29wZS5nZXRQYXJhbSA9IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICBpZiAoJHJvb3RTY29wZS5waXhpZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJHJvb3RTY29wZS5waXhpZS5nZXRQYXJhbXMoKVtuYW1lXTtcclxuICAgICAgICB9IGVsc2UgaWYgKHdpbmRvdy5QaXhpZVBhcmFtcykge1xyXG4gICAgICAgICAgICByZXR1cm4gd2luZG93LlBpeGllUGFyYW1zW25hbWVdO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgY2FudmFzLnN0YXJ0KCk7XHJcblxyXG4gICAgLy9tYWtlIGFjdGlvbnMgcGFuZWxzIGRyYWdnYWJsZVxyXG4gICAgJCgnLmFjdGlvbnMtbWVudScpLmRyYWdnYWJsZSh7XHJcbiAgICAgICAgaGFuZGxlOiAnLm1lbnUtaGVhZGVyJyxcclxuICAgICAgICBjb250YWlubWVudDogJ2JvZHknXHJcbiAgICB9KTtcclxuXHJcblx0JHJvb3RTY29wZS5jYW52YXMgPSBjYW52YXM7XHJcblx0JHJvb3RTY29wZS5oaXN0b3J5ID0gaGlzdG9yeTtcclxuICAgIGlmKHZhbHVlc1snb3JkZXJfaWQnXSE9JycgJiYgdmFsdWVzWydwcm9kdWN0X2lkJ10hPScnKXtcclxuICAgICAgICAvL1wiL3dwLWNvbnRlbnQvdXBsb2Fkcy93aW5lc2hvcC1sYWJlbHMvXCIrJHJvb3RTY29wZS5vcmRlcl9pZCArIFwiLVwiICsgJHJvb3RTY29wZS5wcm9kdWN0X2lkK1wiLmpzb25cIlxyXG5cclxuICAgICAgICAvLyBUT0RPOiBDb252ZXJ0IHN0cmFpZ2h0IGZpbGUgbG9hZCB0byBhbiBBSkFYIHJlcXVlc3Q/XHJcbiAgICAgICAgalF1ZXJ5LmdldEpTT04oXCIvd3AtYWRtaW4vYWRtaW4tYWpheC5waHBcIiwge1xyXG4gICAgICAgICAgICBhY3Rpb246IFwid2luZXNob3BfbGFiZWxfbG9hZFwiLFxyXG4gICAgICAgICAgICBvcmRlcl9pZDogJHJvb3RTY29wZS5vcmRlcl9pZCxcclxuICAgICAgICAgICAgcHJvZHVjdF9pZDogJHJvb3RTY29wZS5wcm9kdWN0X2lkXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oIGRhdGEgKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggXCJFeGlzdGluZyBKU09OIEZvdW5kIVwiICk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuaGlzdG9yeSA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmhpc3RvcnkgPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgaGlzdG9yeS5sb2FkKGRhdGEpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuZmFpbChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTm8gRXhpc3RpbmcgSlNPTiBGb3VuZFwiKTtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5vcGVuTmV3KDExNTcsIDEyMjgpO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5pc05vdExvYWRpbmcoKTtcclxuICAgICAgICAgICAgICAgIGpRdWVyeShcIi5idG4taGVscFwiKS50cmlnZ2VyKFwiY2xpY2tcIik7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNob3dpbmcgSGVscCBNb2RhbFwiKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8qalF1ZXJ5LmdldEpTT04oXCIvd3AtY29udGVudC91cGxvYWRzL3dpbmVzaG9wLWxhYmVscy9cIiskcm9vdFNjb3BlLm9yZGVyX2lkICsgXCItXCIgKyAkcm9vdFNjb3BlLnByb2R1Y3RfaWQrXCIuanNvblwiLGZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgICAgICAkc2NvcGUuaGlzdG9yeSA9IGRhdGE7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuaGlzdG9yeSA9IGRhdGE7XHJcbiAgICAgICAgICAgIGhpc3RvcnkubG9hZChkYXRhKTtcclxuXHJcbiAgICAgICAgfSkuZmFpbChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBjYW52YXMub3Blbk5ldygxMTU3LCAxMjI4KTtcclxuICAgICAgICB9KTsqL1xyXG5cclxuICAgIH1lbHNle1xyXG4gICAgICAgIGNhbnZhcy5vcGVuTmV3KDExNTcsIDEyMjgpO1xyXG4gICAgfVxyXG4gICAgLy8gY29uc29sZS5sb2coY2FudmFzLmZhYnJpYyk7XHJcblxyXG4gICAgLy8gc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgLy8gICAgIGlmKCFjYW52YXMuZmFicmljLmJhY2tncm91bmRDb2xvciB8fCBjYW52YXMuZmFicmljLmJhY2tncm91bmRDb2xvcj09Jycpe1xyXG4gICAgLy8gICAgICAgICAvL2NhbnZhcy5mYWJyaWMuYmFja2dyb3VuZENvbG9yID0gJyNmZmZmZmYnO1xyXG4gICAgLy8gICAgIH1cclxuICAgIC8vICAgICAkcm9vdFNjb3BlLmJnQ29sb3IgPSBjYW52YXMuZmFicmljLmJhY2tncm91bmRDb2xvcjtcclxuICAgIC8vIH0sIDEwMDApO1xyXG5cclxuICAgICRyb290U2NvcGUuc2hhcGVzID0gc2ltcGxlU2hhcGVzO1xyXG5cdCRyb290U2NvcGUubG9hZGluZyA9IGZhbHNlO1xyXG4gICAgJHJvb3RTY29wZS5hbmltYXRpb25FbmRFdmVudCA9ICd3ZWJraXRBbmltYXRpb25FbmQgbW96QW5pbWF0aW9uRW5kIE1TQW5pbWF0aW9uRW5kIG9hbmltYXRpb25lbmQgYW5pbWF0aW9uZW5kJztcclxuICAgICRyb290U2NvcGUudHJhbnNpdGlvbkVuZEV2ZW50ID0gJ3dlYmtpdFRyYW5zaXRpb25FbmQgbW96VHJhbnNpdGlvbkVuZCBNU1RyYW5zaXRpb25FbmQgb2F0cmFuc2l0aW9uZW5kIGF0cmFuc2l0aW9uZW5kIHRyYW5zaXRpb25lbmQnO1xyXG5cclxuICAgICRyb290U2NvcGUubWF4UGFuZWxIZWlnaHQgPSAkKHdpbmRvdykuaGVpZ2h0KCkgLSAxMjA7XHJcblxyXG4gICAgJHJvb3RTY29wZS5vcGVuUGFuZWwgPSBmdW5jdGlvbihuYW1lLCBlKSB7XHJcbiAgICAgICAgaWYgKCRyb290U2NvcGUuYWN0aXZlUGFuZWwgPT09IG5hbWUpIHJldHVybjtcclxuXHJcbiAgICAgICAgaWYobmFtZT09J2NhbnZhc0NvbG9yJyl7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGNhbnZhcyk7XHJcbiAgICAgICAgICAgIGlmKCFjYW52YXMuZmFicmljLmJhY2tncm91bmRDb2xvciB8fCBjYW52YXMuZmFicmljLmJhY2tncm91bmRDb2xvcj09Jycpe1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRCYWNrZ3JvdW5kQ29sb3IoJyNmZmZmZmYnKTtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJHJvb3RTY29wZS5iZ0NvbG9yID0gY2FudmFzLmZhYnJpYy5iYWNrZ3JvdW5kQ29sb3I7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGNhbnZhcyk7XHJcbiAgICAgICAgICAgICQoXCIjY3ZzLWJnY29sb3JcIikuc3BlY3RydW0oXCJzZXRcIiwgJHJvb3RTY29wZS5iZ0NvbG9yKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRyb290U2NvcGUuYWN0aXZlUGFuZWwgPSBuYW1lO1xyXG5cclxuICAgICAgICB2YXIgcGFuZWwgPSAkKCdbZGF0YS1uYW1lPVwiJytuYW1lKydcIl0nKTtcclxuXHJcbiAgICAgICAgdmFyIGNsaWNrUmVjdCA9IGUudGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgIHZhciBwYW5lbFJlY3QgPSBwYW5lbFswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcbiAgICAgICAgdmFyIHNjYWxlWCA9IE1hdGgubWluKDAuNSwgY2xpY2tSZWN0LndpZHRoIC8gcGFuZWxSZWN0LndpZHRoKTtcclxuICAgICAgICB2YXIgc2NhbGVZID0gTWF0aC5taW4oMC41LCBjbGlja1JlY3QuaGVpZ2h0IC8gcGFuZWxSZWN0LmhlaWdodCk7XHJcblxyXG4gICAgICAgIHBhbmVsLnJlbW92ZUNsYXNzKCd0cmFuc2l0aW9uLWluJykuY3NzKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlM2QoJyArXHJcbiAgICAgICAgICAgICgtcGFuZWxSZWN0LmxlZnQgKyBjbGlja1JlY3QubGVmdCArIGNsaWNrUmVjdC53aWR0aC8yIC0gcGFuZWxSZWN0LndpZHRoLzIpICsgJ3B4LCcgK1xyXG4gICAgICAgICAgICAoLXBhbmVsUmVjdC50b3AgKyBjbGlja1JlY3QudG9wICsgY2xpY2tSZWN0LmhlaWdodC8yIC0gcGFuZWxSZWN0LmhlaWdodC8yKSArICdweCwnICtcclxuICAgICAgICAgICAgJzApIHNjYWxlKCcgKyBzY2FsZVggKyAnLCcgKyBzY2FsZVkgKyAnKSdcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAkJHJBRihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJChwYW5lbCkuYWRkQ2xhc3MoJ3RyYW5zaXRpb24taW4nKS5jc3MoJ3RyYW5zZm9ybScsICcnKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG5cdCRyb290U2NvcGUuaXNMb2FkaW5nID0gZnVuY3Rpb24oKSB7XHJcblx0XHQkdGltZW91dChmdW5jdGlvbigpIHtcclxuXHRcdFx0JHJvb3RTY29wZS5sb2FkaW5nID0gdHJ1ZTtcclxuXHRcdH0pO1xyXG5cdH07XHJcblxyXG5cdCRyb290U2NvcGUuaXNOb3RMb2FkaW5nID0gZnVuY3Rpb24oKSB7XHJcblx0XHQkdGltZW91dChmdW5jdGlvbigpIHtcclxuXHRcdFx0JHJvb3RTY29wZS5sb2FkaW5nID0gZmFsc2U7XHJcblx0XHR9KTtcclxuXHR9O1xyXG5cclxuXHQkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XHJcbiAgICAkcm9vdFNjb3BlLmFjdGl2ZVRhYiAgID0gZmFsc2U7XHJcblxyXG5cdCRyb290U2NvcGUua2V5cyA9IHtcclxuXHRcdGdvb2dsZV9mb250czogJ0FJemFTeURoY184Tkt4WGp0djY5aHRGY1VQZTZBN29HU1E0b20ybycsXHJcblx0fTtcclxuXHJcblx0JHJvb3RTY29wZS4kd2F0Y2goJ2FjdGl2ZVBhbmVsJywgZnVuY3Rpb24oKSB7XHJcblx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0JCh3aW5kb3cpLnJlc2l6ZSgpOyBcclxuXHRcdH0sIDEwMCk7XHJcblx0fSk7XHJcbiAgICBcclxuICAgICRyb290U2NvcGUucmVzZXRVSSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gbnVsbDtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVUYWIgICA9ICdiYXNpY3MnO1xyXG4gICAgICAgICAgICBzaW1wbGVTaGFwZXMuc2VsZWN0ZWQgID0gbnVsbDtcclxuICAgICAgICAgICAgZmlsdGVycy5hcHBsaWVkRmlsdGVycyA9IFtdO1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmhpc3RvcnkuYWxsID0gW107XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vb3BlbiBjb3JyZXNwb25kaW5nIHRhYiBpbiBsZWZ0IHBhbmVsIHdoZW4gdXNlciBzZWxlY3RzIGFuIG9iamVjdFxyXG4gICAgY2FudmFzLmZhYnJpYy5vbignb2JqZWN0OnNlbGVjdGVkJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIGlmIChlLnRhcmdldC5uYW1lID09ICd0ZXh0Jykge1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVRhYiA9ICd0ZXh0JztcclxuICAgICAgICB9IGVsc2UgaWYgKGUudGFyZ2V0Lm5hbWUgPT0gJ3N0aWNrZXInICYmICRyb290U2NvcGUuYWN0aXZlVGFiICE9PSAnc3RpY2tlcnMnKSB7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuYWN0aXZlVGFiID0gJ3N0aWNrZXJzJztcclxuICAgICAgICB9IGVsc2UgaWYgKGUudGFyZ2V0Lm5hbWUgJiYgJHJvb3RTY29wZS5hY3RpdmVUYWIgIT09ICdzaW1wbGUtc2hhcGVzJykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpbXBsZVNoYXBlcy5hdmFpbGFibGUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBzaGFwZSA9IHNpbXBsZVNoYXBlcy5hdmFpbGFibGVbaV07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHNoYXBlLm5hbWUgPT09IGUudGFyZ2V0Lm5hbWUgJiYgJHJvb3RTY29wZS5hY3RpdmVUYWIgIT09ICdzaW1wbGUtc2hhcGVzJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHNpbXBsZVNoYXBlcy5zZWxlY3RlZCA9IHNoYXBlO1xyXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuYWN0aXZlVGFiID0gJ3NpbXBsZS1zaGFwZXMnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkdGltZW91dChhbmd1bGFyLm5vb3ApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy9DbG9zZSBvYmplY3QgcGFuZWwgd2hlbiBvYmplY3QgaXMgZGUtc2VsZWN0ZWRcclxuICAgIGNhbnZhcy5mYWJyaWMub24oJ3NlbGVjdGlvbjpjbGVhcmVkJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJHRpbWVvdXQoYW5ndWxhci5ub29wKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vZGVzZWxlY3QgYWxsIG9iamVjdHMgd2hlbiBjbGlja2luZyBvdXRzaWRlIGNhbnZhc1xyXG4gICAgJCgnI3ZpZXdwb3J0Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIGlmIChlLnRhcmdldC5pZCA9PT0gJ3ZpZXdwb3J0Jykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInZpZXdwb3J0XCIpO1xyXG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuZGVhY3RpdmF0ZUFsbCgpLnJlbmRlckFsbCgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAkc2NvcGUub3BlbkJvdHRvbVNoZWV0ID0gZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgICRtZEJvdHRvbVNoZWV0LnNob3coe1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJCgnIycrbmFtZSsnLXNoZWV0LXRlbXBsYXRlJykuaHRtbCgpLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQm90dG9tU2hlZXRDb250cm9sbGVyJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTsgXHJcblxyXG4gICAgLy9jbGVhbnVwLiByZW1vdmUgY29sb3IgcGlja2VyIGNvbnRhaW5lcnMgb24gc2NvcGUgZGVzdHJveS5cclxuICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJCgnLnNwLWNvbnRhaW5lcicpLnJlbW92ZSgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgICRyb290U2NvcGUuc3BhY2lmeSA9IGZ1bmN0aW9uKHRleHQpIHtcclxuICAgICAgICBpZiAodGV4dCkge1xyXG4gICAgICAgICAgICB2YXIgdGVtcCA9IHRleHQucmVwbGFjZSggLyhbQS1aXSkvZywgXCIgJDFcIiApO1xyXG4gICAgICAgICAgICByZXR1cm4gdGVtcC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHRlbXAuc2xpY2UoMSk7XHJcbiAgICAgICAgfVxyXG4gICAgIH07XHJcblxyXG5cclxufV0pXHJcblxyXG4uY29udHJvbGxlcignQm90dG9tU2hlZXRDb250cm9sbGVyJywgWyckcm9vdFNjb3BlJywgJyRzY29wZScsICckbWRCb3R0b21TaGVldCcsICckbWREaWFsb2cnLCAnc2ltcGxlU2hhcGVzJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlLCAkbWRCb3R0b21TaGVldCwgJG1kRGlhbG9nLCBzaW1wbGVTaGFwZXMpIHtcclxuICAgICRzY29wZS5zaGFwZXMgPSBzaW1wbGVTaGFwZXM7XHJcblxyXG4gICAgJHNjb3BlLnNob3dEaWFsb2cgPSBmdW5jdGlvbigkZXZlbnQpIHtcclxuICAgICAgICAkbWREaWFsb2cuc2hvdyh7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlOiAkKCcjdGV4dHVyZS11cGxvYWQtZGlhbG9nLXRlbXBsYXRlJykuaHRtbCgpLFxyXG4gICAgICAgICAgICB0YXJnZXRFdmVudDogJGV2ZW50LFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQm90dG9tU2hlZXRDb250cm9sbGVyJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ0ltYWdlRWRpdG9yJylcblxuLmZhY3RvcnkoJ2xvY2FsU3RvcmFnZScsIGZ1bmN0aW9uKCkge1xuXHR2YXIgc3RvcmFnZSA9IHtcblxuXHRcdC8qKlxuXHRcdCAqIEhvdyBsb25nIChkYXlzKSBkYXRhIHdpbGwgYmUgY2FjaGVkIGluIGxvY2FsIHN0b3JhZ2UuXG5cdFx0ICogXG5cdFx0ICogQHR5cGUge051bWJlcn1cblx0XHQgKi9cblx0XHRleHBpcmVBZnRlcjogMixcblxuXHRcdC8qKlxuXHRcdCAqIFJldHJpZXZlIHZhbHVlIHVuZGVyIGdpdmVuIGtleSBmcm9tIGxvY2FsIHN0b3JhZ2UuXG5cdFx0ICogXG5cdFx0ICogQHBhcmFtICBzdHJpbmcga2V5XG5cdFx0ICogQHJldHVybiBtaXhlZFxuXHRcdCAqL1xuXHRcdGdldDogZnVuY3Rpb24oa2V5KSB7XG5cdFx0XHR2YXIgdmFsdWUgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSkpO1xuXHRcdFx0XG5cdFx0XHRpZiAoICEgdmFsdWUgfHwgISBzdG9yYWdlLmlzVmFsaWQodmFsdWUudGltZSkpIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gdmFsdWUudmFsdWU7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCAqIFN0b3JlIHZhbHVlIGludG8gYnJvd3NlciBsb2NhbCBzdG9yYWdlLlxuXHRcdCAqIFxuXHRcdCAqIEBwYXJhbSBzdHJpbmcga2V5XG5cdFx0ICogQHBhcmFtIG1peGVkIHZhbHVlXG5cdFx0ICovXG5cdFx0c2V0OiBmdW5jdGlvbihrZXksIHZhbHVlKSB7XG5cdFx0XHR2YXIgZGF0YSA9IHsgdmFsdWU6IHZhbHVlLCB0aW1lOiBuZXcgRGF0ZSgpLmdldFRpbWUoKSB9O1xuXG5cdFx0XHRyZXR1cm4gbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeShkYXRhKSk7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCAqIFdoZXRoZXIgb3Igbm90IGNhY2hlIHdpdGggZ2l2ZW4gdGltZSBpcyBjb25zaWRlcmVkIGV4cGlyZWQuXG5cdFx0ICogXG5cdFx0ICogQHBhcmFtICBzdHJpbmcgIHRpbWVcblx0XHQgKiBAcmV0dXJuIHtCb29sZWFufVxuXHRcdCAqL1xuXHRcdGlzVmFsaWQ6IGZ1bmN0aW9uKHRpbWUpIHtcblx0XHRcdHZhciBkYXlzID0gKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC0gbmV3IERhdGUodGltZSkuZ2V0VGltZSgpKS8oMTAwMCo2MCo2MCoyNCk7XG5cblx0XHRcdHJldHVybiBkYXlzIDwgc3RvcmFnZS5leHBpcmVBZnRlcjtcblx0XHR9XG5cdH07XG5cblx0cmV0dXJuIHN0b3JhZ2U7XG59KTsiLCIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXIubW9kdWxlKCdJbWFnZUVkaXRvcicpLmZhY3RvcnkoJ3NldHRpbmdzJywgWyckcm9vdFNjb3BlJywgJyRodHRwJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJGh0dHApIHtcblxuXHR2YXIgc2V0dGluZ3MgPSB7XG4gICAgICAgIGFsbDoge30sXG5cbiAgICAgICAgZ2V0OiBmdW5jdGlvbihuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hbGxbbmFtZV07XG4gICAgICAgIH1cblx0fVxuXG4gICAgJGh0dHAuZ2V0KCdjb25maWcuanNvbicpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICBzZXR0aW5ncy5hbGwgPSBkYXRhO1xuXG4gICAgICAgICRyb290U2NvcGUuJGVtaXQoJ3NldHRpbmdzLnJlYWR5Jyk7XG4gICAgfSk7XG5cblx0cmV0dXJuIHNldHRpbmdzO1xufV0pOyIsIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhci5tb2R1bGUoJ0ltYWdlRWRpdG9yJylcblxuLmZhY3RvcnkoJ2tleWJpbmRzJywgWyckcm9vdFNjb3BlJywgZnVuY3Rpb24oJHJvb3RTY29wZSkge1xuXG4gICAgdmFyIGtleWJpbmRzID0ge1xuXG4gICAgICAgIGZhYnJpYzogZmFsc2UsXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24oZmFicmljKSB7XG4gICAgICAgICAgICB0aGlzLmZhYnJpYyA9IGZhYnJpYztcbiAgICAgICAgICAgIGluaXQoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBkZXN0cm95OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICQoJy5jYW52YXMtY29udGFpbmVyJykub2ZmKFwia2V5ZG93blwiLCBwcm9jZXNzS2V5cywgZmFsc2UpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdrZXlkb3duJywgaGFuZGxlS2V5RG93bik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaGFuZGxlS2V5RG93bihlKSB7XG4gICAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDtcblxuICAgICAgICBpZiAoWzM3LCAzOCwgMzksIDQwXS5pbmRleE9mKGUua2V5Q29kZSkgPiAtMSkgbW92ZU9iamVjdChlKTtcbiAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gNDYpIGRlbGV0ZU9iamVjdCgpO1xuXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVsZXRlT2JqZWN0KCkge1xuICAgICAgICB2YXIgYWN0aXZlT2JqZWN0ID0ga2V5YmluZHMuZmFicmljLmdldEFjdGl2ZU9iamVjdCgpO1xuXG4gICAgICAgIGlmIChhY3RpdmVPYmplY3QpIHtcbiAgICAgICAgICAgIGtleWJpbmRzLmZhYnJpYy5yZW1vdmUoYWN0aXZlT2JqZWN0KTtcbiAgICAgICAgICAgIGtleWJpbmRzLmZhYnJpYy5yZW5kZXJBbGwoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIG1vdmVPYmplY3QoZSkge1xuICAgICAgICB2YXIgbW92ZW1lbnREZWx0YSA9IDI7XG5cbiAgICAgICAgdmFyIGFjdGl2ZU9iamVjdCA9IGtleWJpbmRzLmZhYnJpYy5nZXRBY3RpdmVPYmplY3QoKTtcbiAgICAgICAgdmFyIGFjdGl2ZUdyb3VwID0ga2V5YmluZHMuZmFicmljLmdldEFjdGl2ZUdyb3VwKCk7XG5cbiAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMzcpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGlmIChhY3RpdmVPYmplY3QpIHtcbiAgICAgICAgICAgICAgICB2YXIgYSA9IGFjdGl2ZU9iamVjdC5nZXQoJ2xlZnQnKSAtIG1vdmVtZW50RGVsdGE7XG4gICAgICAgICAgICAgICAgYWN0aXZlT2JqZWN0LnNldCgnbGVmdCcsIGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYWN0aXZlR3JvdXApIHtcbiAgICAgICAgICAgICAgICB2YXIgYSA9IGFjdGl2ZUdyb3VwLmdldCgnbGVmdCcpIC0gbW92ZW1lbnREZWx0YTtcbiAgICAgICAgICAgICAgICBhY3RpdmVHcm91cC5zZXQoJ2xlZnQnLCBhKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PT0gMzkpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGlmIChhY3RpdmVPYmplY3QpIHtcbiAgICAgICAgICAgICAgICB2YXIgYSA9IGFjdGl2ZU9iamVjdC5nZXQoJ2xlZnQnKSArIG1vdmVtZW50RGVsdGE7XG4gICAgICAgICAgICAgICAgYWN0aXZlT2JqZWN0LnNldCgnbGVmdCcsIGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYWN0aXZlR3JvdXApIHtcbiAgICAgICAgICAgICAgICB2YXIgYSA9IGFjdGl2ZUdyb3VwLmdldCgnbGVmdCcpICsgbW92ZW1lbnREZWx0YTtcbiAgICAgICAgICAgICAgICBhY3RpdmVHcm91cC5zZXQoJ2xlZnQnLCBhKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PT0gMzgpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGlmIChhY3RpdmVPYmplY3QpIHtcbiAgICAgICAgICAgICAgICB2YXIgYSA9IGFjdGl2ZU9iamVjdC5nZXQoJ3RvcCcpIC0gbW92ZW1lbnREZWx0YTtcbiAgICAgICAgICAgICAgICBhY3RpdmVPYmplY3Quc2V0KCd0b3AnLCBhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGFjdGl2ZUdyb3VwKSB7XG4gICAgICAgICAgICAgICAgdmFyIGEgPSBhY3RpdmVHcm91cC5nZXQoJ3RvcCcpIC0gbW92ZW1lbnREZWx0YTtcbiAgICAgICAgICAgICAgICBhY3RpdmVHcm91cC5zZXQoJ3RvcCcsIGEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gZWxzZSBpZiAoZS5rZXlDb2RlID09PSA0MCkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgaWYgKGFjdGl2ZU9iamVjdCkge1xuICAgICAgICAgICAgICAgIHZhciBhID0gYWN0aXZlT2JqZWN0LmdldCgndG9wJykgKyBtb3ZlbWVudERlbHRhO1xuICAgICAgICAgICAgICAgIGFjdGl2ZU9iamVjdC5zZXQoJ3RvcCcsIGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYWN0aXZlR3JvdXApIHtcbiAgICAgICAgICAgICAgICB2YXIgYSA9IGFjdGl2ZUdyb3VwLmdldCgndG9wJykgKyBtb3ZlbWVudERlbHRhO1xuICAgICAgICAgICAgICAgIGFjdGl2ZUdyb3VwLnNldCgndG9wJywgYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYWN0aXZlT2JqZWN0KSB7XG4gICAgICAgICAgICBhY3RpdmVPYmplY3Quc2V0Q29vcmRzKCk7XG4gICAgICAgICAgICBrZXliaW5kcy5mYWJyaWMucmVuZGVyQWxsKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoYWN0aXZlR3JvdXApIHtcbiAgICAgICAgICAgIGFjdGl2ZUdyb3VwLnNldENvb3JkcygpO1xuICAgICAgICAgICAga2V5YmluZHMuZmFicmljLnJlbmRlckFsbCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGtleWJpbmRzO1xufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdJbWFnZUVkaXRvcicpXHJcblxyXG4uc2VydmljZSgnY2FudmFzJywgWyckcm9vdFNjb3BlJywgJyRtZERpYWxvZycsICdrZXliaW5kcycsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRtZERpYWxvZywga2V5YmluZHMpIHtcclxuXHJcblx0dmFyIGNhbnZhcyA9IHtcclxuXHJcbiAgICAgICAgb3JpZ2luYWw6IHt9LFxyXG5cclxuICAgICAgICAvL3N0b3JlIHdpbmRvdyB3aWR0aCBhbmQgaGVpZ2h0IHNvIHdlIGRvbid0IGV4ZWN1dGVcclxuICAgICAgICAvL2Z1bmN0aW9ucyB1bm5lY2Vzc2FyaWx5IG9uIHJlc2l6ZSBldmVudCBpZiB0aGV5IGRpZG4ndCBjaGFuZ2VcclxuICAgICAgICBvbGRXaW5kb3dEaW1lbnNpb25zOiB7XHJcbiAgICAgICAgICAgIHdpZHRoOiB3aW5kb3cuaW5uZXJXaWR0aCxcclxuICAgICAgICAgICAgaGVpZ2h0OiB3aW5kb3cuaW5uZXJIZWlnaHRcclxuICAgICAgICB9LFxyXG5cclxuXHRcdG1haW5JbWFnZTogZmFsc2UsXHJcblx0XHRmYWJyaWM6IGZhbHNlLFxyXG5cdFx0Y3R4OiBmYWxzZSxcclxuXHRcdGNvbnRhaW5lcjogZmFsc2UsXHJcblx0XHR2aWV3cG9ydDogZmFsc2UsXHJcblx0XHRvZmZzZXQ6IGZhbHNlLFxyXG5cdFx0ZWxlbWVudDogZmFsc2UsXHJcblxyXG4gICAgICAgIG1pbldpZHRoOiA1MCxcclxuICAgICAgICBtaW5IZWlnaHQ6IDUwLFxyXG5cclxuXHRcdGltYWdlU3RhdGljOiB7XHJcbiAgICAgICAgICAgIGxvY2tlZDogdHJ1ZSxcclxuXHRcdFx0c2VsZWN0YWJsZTogZmFsc2UsXHJcblx0ICAgICAgXHRldmVudGVkOiBmYWxzZSxcclxuXHQgICAgICBcdGxvY2tNb3ZlbWVudFg6IHRydWUsXHJcblx0ICAgICAgXHRsb2NrTW92ZW1lbnRZOiB0cnVlLFxyXG5cdCAgICAgIFx0bG9ja1JvdGF0aW9uOiB0cnVlLFxyXG5cdCAgICAgIFx0bG9ja1NjYWxpbmdYOiB0cnVlLFxyXG5cdCAgICAgIFx0bG9ja1NjYWxpbmdZOiB0cnVlLFxyXG5cdCAgICAgIFx0bG9ja1VuaVNjYWxpbmc6IHRydWUsXHJcblx0ICAgICAgXHRoYXNDb250cm9sczogZmFsc2UsXHJcblx0ICAgICAgXHRoYXNCb3JkZXJzOiBmYWxzZVxyXG5cdFx0fSxcclxuXHJcbiAgICAgICAgZGVzdHJveTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmFicmljLmRpc3Bvc2UoKTtcclxuICAgICAgICAgICAgdGhpcy5tYWluSW1hZ2UgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5mYWJyaWMgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5jdHggPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5jb250YWluZXIgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy52aWV3cG9ydCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLm9mZnNldCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5vcmlnaW5hbCA9IHt9O1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRab29tID0gMTtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5lZGl0b3JDdXN0b21BY3Rpb25zID0ge307XHJcbiAgICAgICAgICAgICQod2luZG93KS5vZmYoJ3Jlc2l6ZScpO1xyXG4gICAgICAgICAgICBrZXliaW5kcy5kZXN0cm95KCk7XHJcbiAgICAgICAgfSxcclxuXHJcblx0XHRzdGFydDogZnVuY3Rpb24odXJsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW52YXMnKTtcclxuICAgICAgICAgICAgdGhpcy5mYWJyaWMgPSBuZXcgZmFicmljLkNhbnZhcygnY2FudmFzJyk7XHJcbiAgICAgICAgICAgIHRoaXMuY3R4ID0gdGhpcy5mYWJyaWMuZ2V0Q29udGV4dCgnMmQnKTtcclxuICAgICAgICAgICAgdGhpcy5jb250YWluZXIgPSAkKCcuY2FudmFzLWNvbnRhaW5lcicpO1xyXG4gICAgICAgICAgICB0aGlzLnZpZXdwb3J0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZXdwb3J0Jyk7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuZWRpdG9yQ3VzdG9tQWN0aW9ucyA9IHt9O1xyXG5cclxuICAgICAgICAgICAgdGhpcy5mYWJyaWMuc2VsZWN0aW9uID0gZmFsc2U7IFxyXG4gICAgICAgICAgICB0aGlzLmZhYnJpYy5yZW5kZXJPbkFkZFJlbW92ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgaWYoIXRoaXMuZmFicmljLmJhY2tncm91bmRDb2xvciB8fCB0aGlzLmZhYnJpYy5iYWNrZ3JvdW5kQ29sb3I9PScnKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmFicmljLnNldEJhY2tncm91bmRDb2xvcignI2ZmZmZmZicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuYmdDb2xvciA9IHRoaXMuZmFicmljLmJhY2tncm91bmRDb2xvcjtcclxuICAgICAgICAgICAgZmFicmljLk9iamVjdC5wcm90b3R5cGUuYm9yZGVyQ29sb3IgPSAnIzIxOTZGMyc7XHJcbiAgICAgICAgICAgIGZhYnJpYy5PYmplY3QucHJvdG90eXBlLmNvcm5lckNvbG9yID0gJyMyMTk2RjMnO1xyXG4gICAgICAgICAgICBmYWJyaWMuT2JqZWN0LnByb3RvdHlwZS50cmFuc3BhcmVudENvcm5lcnMgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIGlmICggISB1cmwpIHVybCA9ICRyb290U2NvcGUuZ2V0UGFyYW0oJ3VybCcpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHVybCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkTWFpbkltYWdlKHVybCk7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnN0YXJ0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCRyb290U2NvcGUuZ2V0UGFyYW0oJ2JsYW5rQ2FudmFzU2l6ZScpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9ICRyb290U2NvcGUuZ2V0UGFyYW0oJ2JsYW5rQ2FudmFzU2l6ZScpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vcGVuTmV3KHNpemUud2lkdGgsIHNpemUuaGVpZ2h0LCAnbmV3Q2FudmFzJyk7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnN0YXJ0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoICEgJHJvb3RTY29wZS5zdGFydGVkICYmICEgJHJvb3RTY29wZS5pc0ludGVncmF0aW9uTW9kZSAmJiAhICRyb290U2NvcGUuZGVsYXlFZGl0b3JTdGFydCkge1xyXG4gICAgICAgICAgICAgICAgLyokbWREaWFsb2cuc2hvdyh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGU6ICQoJyNtYWluLWltYWdlLXVwbG9hZC1kaWFsb2ctdGVtcGxhdGUnKS5odG1sKCksXHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1RvcFBhbmVsQ29udHJvbGxlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogZmFsc2VcclxuICAgICAgICAgICAgICAgIH0pOyovXHJcblxyXG4gICAgICAgICAgICAgICAgLy8kc2NvcGUuY3JlYXRlTmV3Q2FudmFzKDUwMCwgNTAwKVxyXG4gICAgICAgICAgICAgICAgLy9jYW52YXMub3Blbk5ldyg1MDAsNTAwLFwiVW5uYW1lZFwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYW52YXMub3Blbk5ldygxMTU3LCAxMjI4KTtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuc3RhcnRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICQod2luZG93KS5vZmYoJ3Jlc2l6ZScpLm9uKCdyZXNpemUnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FudmFzLm9sZFdpbmRvd0RpbWVuc2lvbnMuaGVpZ2h0ICE9PSBlLnRhcmdldC5pbm5lckhlaWdodCB8fFxyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5vbGRXaW5kb3dEaW1lbnNpb25zLndpZHRoICE9PSBlLnRhcmdldC5pbm5lcldpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmZpdFRvU2NyZWVuKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY2FudmFzLm9sZFdpbmRvd0RpbWVuc2lvbnMud2lkdGggPSBlLnRhcmdldC5pbm5lcldpZHRoO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLm9sZFdpbmRvd0RpbWVuc2lvbnMuaGVpZ2h0ID0gZS50YXJnZXQuaW5uZXJIZWlnaHQ7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgJHJvb3RTY29wZS4kZW1pdCgnY2FudmFzLmluaXQnKTtcclxuXHJcbiAgICAgICAgICAgIGtleWJpbmRzLmluaXQodGhpcy5mYWJyaWMpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuZ2V0UGFyYW0oJ29uTG9hZCcpKSB7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmdldFBhcmFtKCdvbkxvYWQnKSh0aGlzLnZpZXdwb3J0LCAkcm9vdFNjb3BlLCB3aW5kb3cpOyBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGhpZGVNb2RhbHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIG1lcmdlT2JqZWN0czogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGNhbnZhcy56b29tKDEpO1xyXG4gICAgICAgICAgICB0aGlzLmZhYnJpYy5kZWFjdGl2YXRlQWxsKCk7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gdGhpcy5mYWJyaWMudG9EYXRhVVJMKCk7XHJcbiAgICAgICAgICAgIHRoaXMuZmFicmljLmNsZWFyKCk7XHJcbiAgICAgICAgICAgIHRoaXMubG9hZE1haW5JbWFnZShkYXRhKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBsb2FkRnJvbUpTT046IGZ1bmN0aW9uKGRlc2lnbiwgY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5sb2FkRnJvbUpTT04oZGVzaWduLnNlcmlhbGl6ZWRfZWRpdG9yX3N0YXRlIHx8IGRlc2lnbi5zdGF0ZSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmZvckVhY2hPYmplY3QoZnVuY3Rpb24ob2JqKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vcmVhcHBseSBhbnkgZmlsdGVycyBvYmplY3QgdXNlZCB0byBoYXZlXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9iai5hcHBseUZpbHRlcnMgJiYgb2JqLmZpbHRlcnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iai5hcHBseUZpbHRlcnMoY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwuYmluZChjYW52YXMuZmFicmljKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAvL2Fzc2lnbiBuZXcgcmVmZXJlbmNlIHRvIG1haW5JbWFnZSBwcm9wZXJ0eVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvYmoubmFtZSA9PSAnbWFpbkltYWdlJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMubWFpbkltYWdlID0gb2JqO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKCFjYW52YXMuZmFicmljLmJhY2tncm91bmRDb2xvciB8fCBjYW52YXMuZmFicmljLmJhY2tncm91bmRDb2xvcj09Jycpe1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuc2V0QmFja2dyb3VuZENvbG9yKCcjZmZmZmZmJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmJnQ29sb3IgPSBjYW52YXMuZmFicmljLmJhY2tncm91bmRDb2xvcjtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZGVzaWduLndpZHRoICYmIGRlc2lnbi5oZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLnNldFdpZHRoKGRlc2lnbi53aWR0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRIZWlnaHQoZGVzaWduLmhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLm9yaWdpbmFsLmhlaWdodCA9IGRlc2lnbi5oZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLm9yaWdpbmFsLndpZHRoID0gZGVzaWduLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmNhbGNPZmZzZXQoKTtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5maXRUb1NjcmVlbigpO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kZW1pdCgnaGlzdG9yeS5sb2FkZWQnKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayAmJiBjYWxsYmFjayhkZXNpZ24pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDcmVhdGUgYSBuZXcgaW1hZ2Ugd2l0aCBnaXZlbiBkaW1lbnNpb25zLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHtpbnR8c3RyaW5nfSB3aWR0aFxyXG4gICAgICAgICAqIEBwYXJhbSB7aW50fHN0cmluZ30gaGVpZ2h0XHJcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd8dW5kZWZpbmVkfSBuYW1lXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgb3Blbk5ldzogZnVuY3Rpb24od2lkdGgsIGhlaWdodCwgbmFtZSkge1xyXG4gICAgICAgICAgICB3aWR0aCA9IHdpZHRoIDwgdGhpcy5taW5XaWR0aCA/IHRoaXMubWluV2lkdGggOiB3aWR0aDtcclxuICAgICAgICAgICAgaGVpZ2h0ID0gaGVpZ2h0IDwgdGhpcy5taW5IZWlnaHQgPyB0aGlzLm1pbkhlaWdodCA6IGhlaWdodDtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZmFicmljLmNsZWFyKCk7XHJcbiAgICAgICAgICAgIHRoaXMuZmFicmljLnNldEJhY2tncm91bmRDb2xvcignI2ZmZmZmZicpO1xyXG4gICAgICAgICAgICB0aGlzLmZhYnJpYy5zZXRXaWR0aCh3aWR0aCk7XHJcbiAgICAgICAgICAgIHRoaXMuZmFicmljLnNldEhlaWdodChoZWlnaHQpO1xyXG4gICAgICAgICAgICB0aGlzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuICAgICAgICAgICAgY2FudmFzLmZpdFRvU2NyZWVuKCk7XHJcblxyXG4gICAgICAgICAgICAvL3NhdmUgdGhlIGRpbWVuc2lvbnMgc28gd2UgY2FuIHNjYWxlIGltYWdlcyBvcGVuZWQgbGF0ZXIgdG8gdGhlbVxyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLnVzZXJQcmVzZXQgPSB7XHJcbiAgICAgICAgICAgICAgICB3aWR0aDogd2lkdGgsXHJcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IGhlaWdodCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWVcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICAgICAgICAgIGNhbnZhcy5vcmlnaW5hbC53aWR0aCA9IHdpZHRoO1xyXG5cclxuICAgICAgICAgICAgJHJvb3RTY29wZS4kZW1pdCgnY2FudmFzLm9wZW5lZE5ldycpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGNlbnRlcjogZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgIG9iai5jZW50ZXIoKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjYW52YXMuem9vbSA+IDEwMCkge1xyXG4gICAgICAgICAgICAgICAgb2JqLnNldExlZnQoMTApO1xyXG4gICAgICAgICAgICAgICAgb2JqLnNldFRvcCgzNSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG9iai5zZXRDb29yZHMoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBzZXJpYWxpemU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mYWJyaWMudG9KU09OKFsnc2VsZWN0YWJsZScsICduYW1lJ10pO1xyXG4gICAgICAgIH0sXHJcblxyXG5cdFx0bG9hZE1haW5JbWFnZTogZnVuY3Rpb24odXJsLCBoZWlnaHQsIHdpZHRoLCBkb250Rml0LCBjYWxsYmFjaykge1xyXG5cdFx0XHR2YXIgb2JqZWN0O1xyXG5cclxuXHRcdFx0ZmFicmljLnV0aWwubG9hZEltYWdlKHVybCwgZnVuY3Rpb24gKGltZykge1xyXG4gICAgICAgICAgICAgICAgLy9pbWcuY3Jvc3NPcmlnaW4gPSAnYW5vbnltb3VzJztcclxuXHJcblx0XHRcdCAgICBvYmplY3QgPSBuZXcgZmFicmljLkltYWdlKGltZywgY2FudmFzLmltYWdlU3RhdGljKTtcclxuXHRcdFx0ICAgIG9iamVjdC5uYW1lID0gJ21haW5JbWFnZSc7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHdpZHRoICYmIGhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG9iamVjdC53aWR0aCA9IHdpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIG9iamVjdC5oZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG5cdFx0XHQgICAgY2FudmFzLm1haW5JbWFnZSA9IG9iamVjdDtcclxuXHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmZvckVhY2hPYmplY3QoZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9iai5uYW1lID09ICdtYWluSW1hZ2UnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVtb3ZlKG9iaik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblx0XHRcdCAgICBjYW52YXMuZmFicmljLmFkZChvYmplY3QpO1xyXG5cdFx0XHQgICBcdG9iamVjdC50b3AgPSAtMC41O1xyXG5cdFx0XHQgICBcdG9iamVjdC5sZWZ0ID0gLTAuNTtcclxuXHRcdFx0ICAgIG9iamVjdC5tb3ZlVG8oMCk7XHJcblxyXG5cdFx0XHQgICAgY2FudmFzLmZhYnJpYy5zZXRIZWlnaHQob2JqZWN0LmhlaWdodCk7XHJcblx0XHRcdCAgICBjYW52YXMuZmFicmljLnNldFdpZHRoKG9iamVjdC53aWR0aCk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGlmKCFjYW52YXMuZmFicmljLmJhY2tncm91bmRDb2xvciB8fCBjYW52YXMuZmFicmljLmJhY2tncm91bmRDb2xvcj09Jycpe1xyXG4gICAgICAgICAgICAgICAgICAgIC8vY2FudmFzLmZhYnJpYy5zZXRCYWNrZ3JvdW5kQ29sb3IoJyNmZmZmZmYnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuYmdDb2xvciA9IGNhbnZhcy5mYWJyaWMuYmFja2dyb3VuZENvbG9yO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQgPSBvYmplY3QuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLm9yaWdpbmFsLndpZHRoID0gb2JqZWN0LndpZHRoO1xyXG5cclxuXHRcdFx0XHRpZiAoICEgZG9udEZpdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5maXRUb1NjcmVlbigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuXHRcdFx0XHQkcm9vdFNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdCRyb290U2NvcGUuJGVtaXQoJ2VkaXRvci5tYWluSW1hZ2UubG9hZGVkJyk7XHJcblx0XHRcdFx0fSk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHRcdFx0fSk7XHJcblx0XHR9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBPcGVuIGltYWdlIGF0IGdpdmVuIHVybCBpbiBjYW52YXMuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgb3BlbkltYWdlOiBmdW5jdGlvbih1cmwpIHtcclxuICAgICAgICAgICAgY2FudmFzLnpvb20oMSk7XHJcbiAgICAgICAgICAgIGZhYnJpYy51dGlsLmxvYWRJbWFnZSh1cmwsIGZ1bmN0aW9uKGltYWdlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoICEgaW1hZ2UpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgb2JqZWN0ID0gbmV3IGZhYnJpYy5JbWFnZShpbWFnZSk7XHJcbiAgICAgICAgICAgICAgICBvYmplY3QubmFtZSA9ICdpbWFnZSc7XHJcblxyXG4gICAgICAgICAgICAgICAgLy91c2UgZWl0aGVyIG1haW4gaW1hZ2Ugb3IgY2FudmFzIGRpbWVuc2lvbnMgYXMgb3V0dGVyIGJvdW5kYXJpZXMgZm9yIHNjYWxpbmcgbmV3IGltYWdlXHJcbiAgICAgICAgICAgICAgICB2YXIgbWF4V2lkdGggID0gY2FudmFzLm1haW5JbWFnZSA/IGNhbnZhcy5tYWluSW1hZ2UuZ2V0V2lkdGgoKSA6IGNhbnZhcy5mYWJyaWMuZ2V0V2lkdGgoKSxcclxuICAgICAgICAgICAgICAgICAgICBtYXhIZWlnaHQgPSBjYW52YXMubWFpbkltYWdlID8gY2FudmFzLm1haW5JbWFnZS5nZXRIZWlnaHQoKSA6IGNhbnZhcy5mYWJyaWMuZ2V0SGVpZ2h0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy9pZiBpbWFnZSBpcyB3aWRlciBvciBoZWlnaGVyIHRoZW4gdGhlIGN1cnJlbnQgY2FudmFzLCB3ZSdsbCBzY2FsZSBpZCBkb3duXHJcbiAgICAgICAgICAgICAgICBpZiAob2JqZWN0LndpZHRoID49IG1heFdpZHRoIHx8IG9iamVjdC5oZWlnaHQgPj0gbWF4SGVpZ2h0KSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vY2FsYyBuZXcgaW1hZ2UgZGltZW5zaW9ucyAobWFpbiBpbWFnZSBoZWlnaHQgLSAxMCUgYW5kIHdpZHRoIC0gMTAlKVxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdXaWR0aCAgPSBtYXhXaWR0aCAtICgwLjEgKiBtYXhXaWR0aCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0hlaWdodCA9IG1heEhlaWdodCAtICgwLjEgKiBtYXhIZWlnaHQpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2FsZSAgICAgPSAxIC8gKE1hdGgubWluKG5ld0hlaWdodCAvIG9iamVjdC5nZXRIZWlnaHQoKSwgbmV3V2lkdGggLyBvYmplY3QuZ2V0V2lkdGgoKSkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvL3NjYWxlIG5ld2x5IHVwbG9hZGVkIGltYWdlIHRvIHRoZSBhYm92ZSBkaW1lc25zaW9uc1xyXG4gICAgICAgICAgICAgICAgICAgIG9iamVjdC5zY2FsZVggPSBvYmplY3Quc2NhbGVYICogKDEgLyBzY2FsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JqZWN0LnNjYWxlWSA9IG9iamVjdC5zY2FsZVkgKiAoMSAvIHNjYWxlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvL2NlbnRlciBhbmQgcmVuZGVyIG5ld2x5IHVwbG9hZGVkIGltYWdlIG9uIHRoZSBjYW52YXNcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuYWRkKG9iamVjdCk7XHJcbiAgICAgICAgICAgICAgICBvYmplY3QubGVmdCA9IChjYW52YXMuZmFicmljLmdldFdpZHRoKCkgLSBvYmplY3QuZ2V0V2lkdGgoKSkgLyAyO1xyXG4gICAgICAgICAgICAgICAgb2JqZWN0LnRvcCA9IChjYW52YXMuZmFicmljLmdldEhlaWdodCgpIC0gb2JqZWN0LmdldEhlaWdodCgpKSAvIDI7XHJcbiAgICAgICAgICAgICAgICBvYmplY3Quc2V0Q29vcmRzKCk7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLnNldEFjdGl2ZU9iamVjdChvYmplY3QpO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZml0VG9TY3JlZW4oKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZ2V0RGF0YVVSTDogZnVuY3Rpb24ob3B0aW9ucykge1xyXG4gICAgICAgICAgICBpZiAoICEgb3B0aW9ucykgb3B0aW9ucyA9IHt9O1xyXG5cclxuICAgICAgICAgICAgLy9pZ25vcmUgem9vbSB3aGVuIGdldHRpbmcgZGF0YSB1cmxcclxuICAgICAgICAgICAgb3B0aW9ucy5tdWx0aXBsaWVyID0gMSAvIGNhbnZhcy5jdXJyZW50Wm9vbTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZhYnJpYy50b0RhdGFVUkwob3B0aW9ucyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgY3VycmVudFpvb206IDEsXHJcblxyXG4gICAgICAgIHpvb206IGZ1bmN0aW9uKHNjYWxlRmFjdG9yKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmFicmljLnNldFpvb20oc2NhbGVGYWN0b3IpO1xyXG4gICAgICAgICAgICB0aGlzLmZhYnJpYy5zZXRIZWlnaHQodGhpcy5vcmlnaW5hbC5oZWlnaHQgKiBzY2FsZUZhY3Rvcik7XHJcbiAgICAgICAgICAgIHRoaXMuZmFicmljLnNldFdpZHRoKHRoaXMub3JpZ2luYWwud2lkdGggKiBzY2FsZUZhY3Rvcik7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRab29tID0gc2NhbGVGYWN0b3I7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZml0VG9TY3JlZW46IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJmaXRUb1NjcmVlblwiKTtcclxuICAgICAgICAgICAgdmFyIG1heFdpZHRoICA9IGNhbnZhcy52aWV3cG9ydC5vZmZzZXRXaWR0aCAtIDQwLFxyXG4gICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gY2FudmFzLnZpZXdwb3J0Lm9mZnNldEhlaWdodCAtIDEyMCxcclxuICAgICAgICAgICAgICAgIG91dHRlciAgICA9IGNhbnZhcy5tYWluSW1hZ2UgfHwgY2FudmFzLmZhYnJpYyxcclxuICAgICAgICAgICAgXHRzY2FsZSAgICAgPSBNYXRoLm1pbihtYXhIZWlnaHQgLyBvdXR0ZXIuZ2V0SGVpZ2h0KCksIG1heFdpZHRoIC8gb3V0dGVyLmdldFdpZHRoKCkpO1xyXG5cclxuICAgICAgICAgICAgaWYgKG91dHRlci5nZXRIZWlnaHQoKSA+IG1heEhlaWdodCB8fCBvdXR0ZXIuZ2V0V2lkdGgoKSA+IG1heFdpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuem9vbShzY2FsZSk7IFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cdH07XHJcblxyXG5cdHJldHVybiBjYW52YXM7XHJcblxyXG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ2ltYWdlLmNyb3AnLCBbXSlcblxuLnNlcnZpY2UoJ2Nyb3BwZXInLCBbJyRyb290U2NvcGUnLCAnY3JvcHpvbmUnLCAnY2FudmFzJywgJ2hpc3RvcnknLCBmdW5jdGlvbigkcm9vdFNjb3BlLCBjcm9wem9uZSwgY2FudmFzLCBoaXN0b3J5KSB7XG5cdFxuXHR2YXIgY3JvcHBlciA9IHtcblxuXHRcdHN0YXJ0OiBmdW5jdGlvbihlKSB7XG5cdFx0XHRpZiAoY3JvcHpvbmUuaW5pdGlhdGVkKSByZXR1cm47XG5cdFx0XHRcblx0XHRcdGNyb3B6b25lLmFkZCgpO1xuXHRcdFx0JHJvb3RTY29wZS5vcGVuUGFuZWwoJ2Nyb3AnLCBlKTtcblx0XHR9LFxuXG5cdFx0c3RvcDogZnVuY3Rpb24oZSkge1xuXHRcdFx0Y3JvcHpvbmUucmVtb3ZlKCk7XG5cdFx0XHQkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XG5cdFx0fSxcblxuXHRcdGNyb3A6IGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCAhIGNyb3B6b25lLmluaXRpYXRlZCkgcmV0dXJuIGZhbHNlO1xuXG5cdFx0XHRjcm9wem9uZS5oaWRlKCk7XG5cdFx0ICAgIHZhciBpbWFnZSA9IG5ldyBJbWFnZSgpO1xuXG5cdFx0ICAgIGltYWdlLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuXHRcdCAgICAgICAgdmFyIGZhYnJpY0ltYWdlID0gbmV3IGZhYnJpYy5JbWFnZSh0aGlzLCBjYW52YXMuaW1hZ2VTdGF0aWMpO1xuICAgICAgICAgICAgICAgIGZhYnJpY0ltYWdlLm5hbWUgPSAnbWFpbkltYWdlJztcblxuXHRcdCAgICAgICAgY2FudmFzLm1haW5JbWFnZSAmJiBjYW52YXMubWFpbkltYWdlLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuY2xlYXIoKTtcblx0XHQgICAgICAgIGNhbnZhcy5mYWJyaWMuc2V0V2lkdGgoTWF0aC5jZWlsKGNyb3B6b25lLnJlY3QuZ2V0V2lkdGgoKSkpO1xuXHRcdCAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRIZWlnaHQoTWF0aC5jZWlsKGNyb3B6b25lLnJlY3QuZ2V0SGVpZ2h0KCkpKTtcblxuICAgICAgICBcdFx0Y2FudmFzLmZhYnJpYy5hZGQoZmFicmljSW1hZ2UpO1xuICAgICAgICAgICAgICAgIGZhYnJpY0ltYWdlLm1vdmVUbygwKTtcbiAgICAgICAgICAgICAgICBmYWJyaWNJbWFnZS5jZW50ZXIoKTtcbiAgICAgICAgXHRcdGNhbnZhcy5tYWluSW1hZ2UgPSBmYWJyaWNJbWFnZTtcbiAgICAgICAgXHRcdGNyb3B6b25lLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAgICAgaGlzdG9yeS5hZGQoJ2Nyb3AnLCAnY3JvcCcpO1xuXG5cdFx0XHRcdCRyb290U2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdCRyb290U2NvcGUuYWN0aXZlUGFuZWwgPSBmYWxzZTtcblx0XHRcdFx0fSk7XG5cdFx0ICAgIH07XG5cbiAgICAgICAgICAgIGNhbnZhcy56b29tKDEpO1xuXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmVkaXRvckN1c3RvbUFjdGlvbnMuY3JvcCA9IHtcbiAgICAgICAgICAgICAgICBsZWZ0OiBjcm9wem9uZS5yZWN0LmdldExlZnQoKSxcbiAgICAgICAgICAgICAgICB0b3A6IGNyb3B6b25lLnJlY3QuZ2V0VG9wKCksXG4gICAgICAgICAgICAgICAgd2lkdGg6IE1hdGguY2VpbChjcm9wem9uZS5yZWN0LmdldFdpZHRoKCkpLFxuICAgICAgICAgICAgICAgIGhlaWdodDogTWF0aC5jZWlsKGNyb3B6b25lLnJlY3QuZ2V0SGVpZ2h0KCkpXG4gICAgICAgICAgICB9O1xuXG5cdFx0ICAgIGltYWdlLnNyYyA9IGNhbnZhcy5mYWJyaWMudG9EYXRhVVJMKHtcblx0XHQgICAgICAgIGxlZnQ6IGNyb3B6b25lLnJlY3QuZ2V0TGVmdCgpLFxuXHRcdCAgICAgICAgdG9wOiBjcm9wem9uZS5yZWN0LmdldFRvcCgpLFxuXHRcdCAgICAgICAgd2lkdGg6IE1hdGguY2VpbChjcm9wem9uZS5yZWN0LmdldFdpZHRoKCkpLFxuXHRcdCAgICAgICAgaGVpZ2h0OiBNYXRoLmNlaWwoY3JvcHpvbmUucmVjdC5nZXRIZWlnaHQoKSlcblx0XHQgICAgfSk7XG5cbiAgICAgICAgICAgIGNhbnZhcy5vcmlnaW5hbC53aWR0aCA9IE1hdGguY2VpbChjcm9wem9uZS5yZWN0LmdldFdpZHRoKCkpO1xuICAgICAgICAgICAgY2FudmFzLm9yaWdpbmFsLmhlaWdodCA9IE1hdGguY2VpbChjcm9wem9uZS5yZWN0LmdldEhlaWdodCgpKTtcblx0XHR9XG5cblx0fTtcblxuXHRyZXR1cm4gY3JvcHBlcjtcblxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5jcm9wJylcblxuLnNlcnZpY2UoJ2Nyb3B6b25lJywgWyckcm9vdFNjb3BlJywgJ2NhbnZhcycsIGZ1bmN0aW9uKCRyb290U2NvcGUsIGNhbnZhcykge1xuXG5cdHZhciBjcm9wem9uZSA9IHtcblxuXHRcdHJlY3Q6IHt9LFxuXG5cdFx0ZHJhZ2dpbmc6IGZhbHNlLFxuXG5cdFx0aW5pdGlhdGVkOiBmYWxzZSxcblxuXHRcdG1pbkhlaWdodDogMjUsXG5cblx0XHRtaW5XaWR0aDogMjUsXG5cblx0XHRzZXRXaWR0aDogZnVuY3Rpb24od2lkdGgpIHtcbiAgICAgICAgICAgIGlmICggISB3aWR0aCkgcmV0dXJuO1xuXG4gICAgICAgICAgICB3aWR0aCA9IHBhcnNlSW50KHdpZHRoKTtcblxuXHRcdFx0aWYgKHdpZHRoIDwgdGhpcy5taW5XaWR0aCkge1xuXHRcdFx0XHR3aWR0aCA9IHRoaXMubWluV2lkdGg7XG5cdFx0XHR9XG5cblx0XHRcdGlmICh3aWR0aCA+IGNhbnZhcy5vcmlnaW5hbC53aWR0aCkge1xuXHRcdFx0XHR3aWR0aCA9IGNhbnZhcy5vcmlnaW5hbC53aWR0aCAtIDI1O1xuXHRcdFx0fVxuXG4gICAgICAgICAgICB0aGlzLnJlY3Qud2lkdGggPSB3aWR0aDtcblx0XHRcdHRoaXMucmVjdC5zZXRUb3AoKGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQgLSB0aGlzLnJlY3QuZ2V0SGVpZ2h0KCkpIC8gMik7XG5cdFx0XHR0aGlzLnJlY3Quc2V0TGVmdCgoY2FudmFzLm9yaWdpbmFsLndpZHRoIC0gdGhpcy5yZWN0LmdldFdpZHRoKCkpIC8gMik7XG5cdFx0XHR0aGlzLnJlY3Quc2V0Q29vcmRzKCk7XG5cdFx0XHR0aGlzLmRyYXdHcmlkKCk7XG5cdFx0XHR0aGlzLmRyYXdPdmVybGF5KCk7XG5cdFx0XHRjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xuXHRcdH0sXG5cblx0XHRzZXRIZWlnaHQ6IGZ1bmN0aW9uKGhlaWdodCkge1xuICAgICAgICAgICAgaWYgKCAhIGhlaWdodCkgcmV0dXJuO1xuXG4gICAgICAgICAgICBoZWlnaHQgPSBwYXJzZUludChoZWlnaHQpO1xuXG5cdFx0XHRpZiAoaGVpZ2h0IDwgdGhpcy5taW5IZWlnaHQpIHtcblx0XHRcdFx0aGVpZ2h0ID0gdGhpcy5taW5IZWlnaHQ7XG5cdFx0XHR9XG5cbiAgICAgICAgICAgIGlmIChoZWlnaHQgPiBjYW52YXMub3JpZ2luYWwuaGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gY2FudmFzLm9yaWdpbmFsLmhlaWdodCAtIDI1O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnJlY3QuaGVpZ2h0ID0gaGVpZ2h0O1xuXHRcdFx0dGhpcy5yZWN0LnNldFRvcCgoY2FudmFzLm9yaWdpbmFsLmhlaWdodCAtIHRoaXMucmVjdC5nZXRIZWlnaHQoKSkgLyAyKTtcblx0XHRcdHRoaXMucmVjdC5zZXRMZWZ0KChjYW52YXMub3JpZ2luYWwud2lkdGggLSB0aGlzLnJlY3QuZ2V0V2lkdGgoKSkgLyAyKTtcblx0XHRcdHRoaXMucmVjdC5zZXRDb29yZHMoKTtcblx0XHRcdHRoaXMuZHJhd0dyaWQoKTtcblx0XHRcdHRoaXMuZHJhd092ZXJsYXkoKTtcblx0XHRcdGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XG5cdFx0fSxcblxuXHRcdGFkZDogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLmRyYXdNYWluWm9uZSgpO1xuXHRcdFx0dGhpcy5kcmF3T3ZlcmxheSgpO1xuXHRcdFx0dGhpcy5kcmF3R3JpZCgpO1xuXHRcdFx0dGhpcy5hdHRhY2hFdmVudHMoKTtcblxuXHRcdFx0Y2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcblxuXHRcdFx0dGhpcy5pbml0aWF0ZWQgPSB0cnVlO1xuXG5cdFx0XHQkcm9vdFNjb3BlLiRlbWl0KCdjcm9wem9uZS5hZGRlZCcpO1xuXHRcdH0sXG5cblx0XHRjb25zdHJhaW5XaXRoaW5DYW52YXM6IGZ1bmN0aW9uKG9iamVjdCkge1xuXHRcdCAgICB2YXIgeCA9IG9iamVjdC5nZXRMZWZ0KCksIHkgPSBvYmplY3QuZ2V0VG9wKCk7XG5cdFx0ICAgIHZhciB3ID0gb2JqZWN0LmdldFdpZHRoKCksIGggPSBvYmplY3QuZ2V0SGVpZ2h0KCk7XG5cdFx0ICAgIHZhciBtYXhYID0gY2FudmFzLm9yaWdpbmFsLndpZHRoIC0gdztcblx0XHQgICAgdmFyIG1heFkgPSBjYW52YXMub3JpZ2luYWwuaGVpZ2h0IC0gaDtcblxuXHRcdCAgICBpZiAoeCA8IDApIHtcblx0XHQgICAgXHRvYmplY3Quc2V0KCdsZWZ0JywgMCk7XG5cdFx0ICAgIH1cblx0XHQgICAgaWYgKHkgPCAwKSB7XG5cdFx0ICAgICAgICBvYmplY3Quc2V0KCd0b3AnLCAwKTtcblx0XHRcdH1cblx0XHQgICAgaWYgKHggPiBtYXhYKSB7XG5cdFx0ICAgICAgICBvYmplY3Quc2V0KCdsZWZ0JywgbWF4WCk7XG5cdFx0ICAgIH1cblx0XHQgICAgaWYgKHkgPiBtYXhZKSB7XG5cdFx0ICAgIFx0b2JqZWN0LnNldCgndG9wJywgbWF4WSk7XG5cdFx0ICAgIH1cblx0XHR9LFxuXG5cdFx0Y29uc3RyYWluV2l0aGluQ2FudmFzT25TY2FsaW5nOiBmdW5jdGlvbihvYmplY3QpIHtcblxuXHRcdCAgICB2YXIgbWluWCA9IG9iamVjdC5nZXRMZWZ0KCk7XG5cdFx0ICAgIHZhciBtaW5ZID0gb2JqZWN0LmdldFRvcCgpO1xuXHRcdCAgICB2YXIgbWF4WCA9IG9iamVjdC5nZXRMZWZ0KCkgKyBvYmplY3QuZ2V0V2lkdGgoKTtcblx0XHQgICAgdmFyIG1heFkgPSBvYmplY3QuZ2V0VG9wKCkgKyBvYmplY3QuZ2V0SGVpZ2h0KCk7XG5cblx0XHQgICAgaWYgKG1pblggPCAwIHx8IG1heFggPiBjYW52YXMub3JpZ2luYWwud2lkdGgpIHtcblx0XHQgICAgICAgIHZhciBsYXN0U2NhbGVYID0gdGhpcy5sYXN0U2NhbGVYwqB8fCAxO1xuXHRcdCAgICAgICAgb2JqZWN0LnNldFNjYWxlWChsYXN0U2NhbGVYKTtcblx0XHQgICAgfVxuXG5cdFx0ICAgIGlmIChtaW5YIDwgMCkge1xuXHRcdCAgICAgICAgb2JqZWN0LnNldExlZnQoMCk7XG5cdFx0ICAgIH1cblxuXHRcdCAgICBpZiAobWluWSA8IDAgfHwgbWF4WSA+IGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQpIHtcblx0XHQgICAgICAgIHZhciBsYXN0U2NhbGVZID0gdGhpcy5sYXN0U2NhbGVZwqB8fCAxO1xuXHRcdCAgICAgICAgb2JqZWN0LnNldFNjYWxlWShsYXN0U2NhbGVZKTtcblx0XHQgICAgfVxuXG5cdFx0ICAgIGlmIChtaW5ZIDwgMCkge1xuXHRcdCAgICAgICAgb2JqZWN0LnNldFRvcCgwKTtcblx0XHQgICAgfVxuXG5cdFx0ICAgIGlmIChvYmplY3QuZ2V0V2lkdGgoKSA8IHRoaXMubWluV2lkdGgpIHtcblx0XHQgICAgICAgIG9iamVjdC53aWR0aCA9IHRoaXMubWluV2lkdGg7XG5cdFx0ICAgICAgICBvYmplY3Quc2V0U2NhbGVYKDEpO1xuXHRcdCAgICB9XG5cblx0XHQgICAgaWYgKG9iamVjdC5nZXRIZWlnaHQoKSA8IHRoaXMubWluSGVpZ2h0KSB7XG5cdFx0ICAgICAgIG9iamVjdC5oZWlnaHQgPSB0aGlzLm1pbkhlaWdodDtcblx0XHQgICAgICAgb2JqZWN0LnNldFNjYWxlWSgxKTtcblx0XHQgICAgfVxuXG5cdFx0ICAgIHRoaXMubGFzdFNjYWxlWCA9IG9iamVjdC5nZXRTY2FsZVgoKTtcblx0XHQgICAgdGhpcy5sYXN0U2NhbGVZID0gb2JqZWN0LmdldFNjYWxlWSgpO1xuXHRcdH0sXG5cblx0XHRvbk1vdXNlRG93bjogZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRcdGlmIChldmVudC50YXJnZXQgJiYgKGV2ZW50LnRhcmdldC5uYW1lID09PSAnY3JvcHpvbmUnIHx8IGV2ZW50LnRhcmdldC5uYW1lID09PSAnY3JvcC5ncmlkJykpIHJldHVybjtcblxuXHRcdFx0Y3JvcHpvbmUuZHJhZ2dpbmcgPSB0cnVlO1xuXG5cdFx0XHQvL2hpZGUgY3JvcHpvbmUgb24gc2luZ2xlIGNsaWNrIG9uIG92ZXJsYXlcblx0XHRcdGNyb3B6b25lLm92ZXJsYXkudmlzaWJsZSA9IGZhbHNlO1xuXHRcdFx0Y3JvcHpvbmUuZ3JpZC52aXNpYmxlID0gZmFsc2U7XG5cdFx0XHRjcm9wem9uZS5yZWN0LnZpc2libGUgPSBmYWxzZTtcblxuXHRcdFx0Ly9zdGFydCBwb3NpdGlvbiBmb3IgZHJhd2luZyBhIGNyb3B6b25lXG5cdFx0ICAgIGNyb3B6b25lLnJlY3QubGVmdCA9IGV2ZW50LmUucGFnZVggLSBjYW52YXMuZmFicmljLl9vZmZzZXQubGVmdDtcblx0XHQgICAgY3JvcHpvbmUucmVjdC50b3AgPSBldmVudC5lLnBhZ2VZIC0gY2FudmFzLmZhYnJpYy5fb2Zmc2V0LnRvcDtcblxuXHRcdCAgICAvL21ha2Ugc3VyZSBjcm9wem9uZSBzY2FsZSBpcyAxIGZvciBhY2N1cmF0ZSBjb29yZGluYXRlc1xuXHRcdCAgICBjcm9wem9uZS5yZWN0LnNjYWxlKDEpO1xuICAgICAgICAgICAgY3JvcHpvbmUub3ZlcmxheS5zY2FsZSgxKTtcbiAgICAgICAgICAgIGNyb3B6b25lLmdyaWQuc2NhbGUoMSk7XG5cdFx0ICAgIGNyb3B6b25lLm1vdXNleCA9IGV2ZW50LmUucGFnZVg7XG5cdFx0ICAgIGNyb3B6b25lLm1vdXNleSA9IGV2ZW50LmUucGFnZVk7XG5cblx0XHQgICAgLy9wcmV2ZW50IHNlbGVjdGlvbiBvZiBvYmplY3RzIHdoaWxlIGRyYWdnaW5nXG5cdFx0ICAgIGNhbnZhcy5mYWJyaWMuc2VsZWN0aW9uID0gZmFsc2U7XG5cblx0XHQgICAgY3JvcHpvbmUuZHJhd092ZXJsYXkoKTtcblx0XHR9LFxuXG5cdFx0b25Nb3VzZU1vdmU6IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRpZiAoICEgY3JvcHpvbmUuZHJhZ2dpbmcpIHJldHVybjtcblxuXHRcdFx0dmFyIHdpZHRoICA9IGV2ZW50LmUucGFnZVggLSBjcm9wem9uZS5tb3VzZXgsXG5cdFx0XHRcdGhlaWdodCA9IGV2ZW50LmUucGFnZVkgLSBjcm9wem9uZS5tb3VzZXk7XG5cblx0XHRcdC8vcHJldmVudCBjcm9wem9uZSBnb2luZyBvdmVyIHRoZSByaWdodCBlZGdlXG5cdFx0XHRpZiAoY2FudmFzLm9mZnNldC5sZWZ0ICsgY2FudmFzLm9yaWdpbmFsLndpZHRoIDwgZXZlbnQuZS5wYWdlWCkge1xuXHRcdFx0XHR3aWR0aCA9IChjYW52YXMub2Zmc2V0LmxlZnQgKyBjYW52YXMub3JpZ2luYWwud2lkdGgpIC0gY3JvcHpvbmUubW91c2V4O1xuXHRcdFx0fVxuXG5cdFx0XHQvL2xlZnQgZWRnZVxuXHRcdFx0aWYgKGNhbnZhcy5vZmZzZXQubGVmdCA+IGV2ZW50LmUucGFnZVgpIHtcblx0XHRcdFx0d2lkdGggPSBjYW52YXMub2Zmc2V0LmxlZnQgLSBjcm9wem9uZS5tb3VzZXg7XG5cdFx0XHR9XG5cblx0XHRcdC8vYm90dG9tIGVkZ2Vcblx0XHRcdGlmIChjYW52YXMub2Zmc2V0LnRvcCArIGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQgPCBldmVudC5lLnBhZ2VZKSB7XG5cdFx0XHRcdGhlaWdodCA9IChjYW52YXMub2Zmc2V0LnRvcCArIGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQpIC0gY3JvcHpvbmUubW91c2V5O1xuXHRcdFx0fVxuXG5cdFx0XHQvL3RvcCBlZGdlXG5cdFx0XHRpZiAoY2FudmFzLm9mZnNldC50b3AgPiBldmVudC5lLnBhZ2VZKSB7XG5cdFx0XHRcdGhlaWdodCA9IGNhbnZhcy5vZmZzZXQudG9wIC0gY3JvcHpvbmUubW91c2V5O1xuXHRcdFx0fVxuXG5cdFx0XHRjcm9wem9uZS5yZWN0LndpZHRoID0gd2lkdGg7XG4gICAgICAgIFx0Y3JvcHpvbmUucmVjdC5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgIFx0Y3JvcHpvbmUucmVjdC5tb3ZlVG8oMyk7XG4gICAgICAgICAgICBjcm9wem9uZS5yZWN0LnNldENvb3JkcygpO1xuICAgICAgICBcdGNyb3B6b25lLmRyYXdPdmVybGF5KCk7XG5cdCAgICAgICAgY3JvcHpvbmUuZHJhd0dyaWQoKTtcblxuXHRcdFx0aWYgKCAhIGNyb3B6b25lLnJlY3QudmlzaWJsZSkge1xuXHRcdFx0XHRjcm9wem9uZS5yZWN0LnZpc2libGUgPSB0cnVlO1xuXHRcdFx0XHRjcm9wem9uZS5vdmVybGF5LnZpc2libGUgPSB0cnVlO1xuXHRcdFx0XHRjcm9wem9uZS5ncmlkLnZpc2libGUgPSB0cnVlO1xuXHRcdFx0fVxuXHRcdH0sXG5cblx0XHRvbk1vdXNlVXA6IGZ1bmN0aW9uKCkge1xuXHRcdCAgIFx0Y3JvcHpvbmUuZHJhZ2dpbmcgPSBmYWxzZTtcblx0XHQgICAgY2FudmFzLmZhYnJpYy5zZWxlY3Rpb24gPSB0cnVlO1xuXHRcdCAgICBjcm9wem9uZS5yZWN0LnNldENvb3JkcygpO1xuICAgICAgICAgICAgY3JvcHpvbmUuZ3JpZC5zZXRDb29yZHMoKTtcbiAgICAgICAgICAgIGNyb3B6b25lLm92ZXJsYXkuc2V0Q29vcmRzKCk7XG5cblx0XHQgICAgaWYgKGNyb3B6b25lLnJlY3QudmlzaWJsZSkge1xuXHRcdCAgICBcdGNhbnZhcy5mYWJyaWMuc2V0QWN0aXZlT2JqZWN0KGNyb3B6b25lLnJlY3QpO1xuXHRcdFx0fVxuXHRcdH0sXG5cblx0XHRhdHRhY2hFdmVudHM6IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHQvL3JlZHJhdyBjcm9wem9uZSBncmlkIGFuZCBvdmVybGF5IHdoZW4gY3JvcHpvbmUgaXMgcmVzaXplZFxuXHRcdFx0dGhpcy5yZWN0Lm9uKCdtb3ZpbmcnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0Y3JvcHpvbmUuY29uc3RyYWluV2l0aGluQ2FudmFzKGNyb3B6b25lLnJlY3QpO1xuXHRcdFx0XHRjcm9wem9uZS5kcmF3T3ZlcmxheSgpO1xuXHRcdFx0XHRjcm9wem9uZS5kcmF3R3JpZCgpO1xuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMucmVjdC5vbignc2NhbGluZycsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0Y3JvcHpvbmUuY29uc3RyYWluV2l0aGluQ2FudmFzT25TY2FsaW5nKGNyb3B6b25lLnJlY3QsIGUpO1xuXHRcdFx0XHRjcm9wem9uZS5kcmF3T3ZlcmxheSgpO1xuXHRcdFx0XHRjcm9wem9uZS5kcmF3R3JpZCgpO1xuXHRcdFx0fSk7XG5cblx0XHRcdGNhbnZhcy5mYWJyaWMub24oXCJtb3VzZTpkb3duXCIsIGNyb3B6b25lLm9uTW91c2VEb3duKTtcblx0XHRcdGNhbnZhcy5mYWJyaWMub24oXCJtb3VzZTptb3ZlXCIsIGNyb3B6b25lLm9uTW91c2VNb3ZlKTtcblx0XHRcdGNhbnZhcy5mYWJyaWMub24oXCJtb3VzZTp1cFwiLCBjcm9wem9uZS5vbk1vdXNlVXApO1xuXHRcdH0sXG5cblx0XHRyZW1vdmU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0Y2FudmFzLmZhYnJpYy5vZmYoXCJtb3VzZTpkb3duXCIsIGNyb3B6b25lLm9uTW91c2VEb3duKTtcblx0XHRcdGNhbnZhcy5mYWJyaWMub2ZmKFwibW91c2U6bW92ZVwiLCBjcm9wem9uZS5vbk1vdXNlTW92ZSk7XG5cdFx0XHRjYW52YXMuZmFicmljLm9mZihcIm1vdXNlOnVwXCIsIGNyb3B6b25lLm9uTW91c2VVcCk7XG5cblx0XHRcdGNhbnZhcy5mYWJyaWMucmVtb3ZlKHRoaXMucmVjdCk7XG5cdFx0XHRjYW52YXMuZmFicmljLnJlbW92ZSh0aGlzLmdyaWQpO1xuXHRcdFx0Y2FudmFzLmZhYnJpYy5yZW1vdmUodGhpcy5vdmVybGF5KTtcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XG5cdFx0XHR0aGlzLmluaXRpYXRlZCA9IGZhbHNlO1xuXHRcdH0sXG5cblx0XHRoaWRlOiBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMucmVjdC52aXNpYmxlID0gZmFsc2U7XG5cdFx0XHR0aGlzLnJlY3QuaGFzQ29udHJvbHMgPSBmYWxzZTtcblx0XHRcdHRoaXMuZ3JpZC52aXNpYmxlID0gZmFsc2U7XG5cdFx0XHR0aGlzLm92ZXJsYXkudmlzaWJsZSA9IGZhbHNlO1xuXHRcdH0sXG5cblx0XHRnZXRPcHRpbWFsRGltZW5zaW9uczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHdpZHRoID0gY2FudmFzLm9yaWdpbmFsLndpZHRoIC8gMixcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSBjYW52YXMub3JpZ2luYWwuaGVpZ2h0IC8gMixcbiAgICAgICAgICAgICAgICBsZWZ0ID0gY2FudmFzLm9yaWdpbmFsLndpZHRoIC8gNCxcbiAgICAgICAgICAgICAgICB0b3AgPSBjYW52YXMub3JpZ2luYWwuaGVpZ2h0IC8gNDtcblxuXHRcdFx0aWYgKGNhbnZhcy52aWV3cG9ydC5vZmZzZXRXaWR0aCA8IGNhbnZhcy5vcmlnaW5hbC53aWR0aCkge1xuXHRcdFx0XHR3aWR0aCA9IGNhbnZhcy52aWV3cG9ydC5vZmZzZXRXaWR0aCAvIDI7XG5cdFx0XHRcdGxlZnQgPSBjYW52YXMudmlld3BvcnQub2Zmc2V0V2lkdGggLyA0O1xuXG5cdFx0XHR9XG5cbiAgICAgICAgICAgIGlmIChjYW52YXMudmlld3BvcnQub2Zmc2V0SGVpZ2h0IDwgY2FudmFzLm9yaWdpbmFsLmhlaWdodCkge1xuICAgICAgICAgICAgICAgIGhlaWdodCA9IGNhbnZhcy52aWV3cG9ydC5vZmZzZXRIZWlnaHQgLyAyO1xuICAgICAgICAgICAgICAgIHRvcCA9IGNhbnZhcy52aWV3cG9ydC5vZmZzZXRIZWlnaHQgLyA0O1xuICAgICAgICAgICAgfVxuXG5cdFx0XHRyZXR1cm4ge3dpZHRoOiB3aWR0aCwgaGVpZ2h0OiBoZWlnaHQsIGxlZnQ6IGxlZnQsIHRvcDogdG9wfTtcblx0XHR9LFxuXG5cdFx0ZHJhd01haW5ab25lOiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBkaW1lbnNpb25zID0gdGhpcy5nZXRPcHRpbWFsRGltZW5zaW9ucygpO1xuXG5cdFx0XHR0aGlzLnJlY3QgPSBuZXcgZmFicmljLlJlY3Qoe1xuXHRcdFx0ICAgIGZpbGw6ICd0cmFuc3BhcmVudCcsXG5cdFx0XHQgICAgc3Ryb2tlOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjYpJyxcblx0XHRcdCAgICBoYXNCb3JkZXJzOiBmYWxzZSxcblx0XHRcdCAgICB3aWR0aDogZGltZW5zaW9ucy53aWR0aCxcblx0XHRcdCAgICBoZWlnaHQ6IGRpbWVuc2lvbnMuaGVpZ2h0LFxuXHRcdFx0ICAgIGxlZnQ6IGRpbWVuc2lvbnMubGVmdCxcblx0XHRcdCAgICB0b3A6IGRpbWVuc2lvbnMudG9wLFxuXHRcdFx0ICAgIGhhc1JvdGF0aW5nUG9pbnQ6IGZhbHNlLFxuXHRcdFx0ICAgIG5hbWU6ICdjcm9wem9uZScsXG5cdFx0XHQgICAgY29ybmVyQ29sb3I6ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNiknLFxuXHRcdFx0ICAgIHRyYW5zcGFyZW50Q29ybmVyczogZmFsc2UsXG4gICAgICAgICAgICAgICAgaWdub3JlOiB0cnVlXG5cdFx0XHR9KTtcblxuXHRcdFx0Y2FudmFzLmZhYnJpYy5hZGQodGhpcy5yZWN0KTtcblx0XHRcdHRoaXMucmVjdC5tb3ZlVG8oMyk7XG5cdFx0XHRjYW52YXMuZmFicmljLnNldEFjdGl2ZU9iamVjdChjcm9wem9uZS5yZWN0KTtcblx0XHR9LFxuXG5cdFx0ZHJhd0dyaWQ6IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRpZiAoICEgdGhpcy5pbml0aWF0ZWQpIHtcblx0XHRcdFx0dGhpcy5saW5lMSA9IG5ldyBmYWJyaWMuTGluZShbXSwgeyBzdHJva2U6ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNiknLCBzdHJva2VXaWR0aDogMSwgc2VsZWN0YWJsZTogZmFsc2UsIGV2ZW50ZWQ6IGZhbHNlIH0pO1xuXHRcdFx0XHR0aGlzLmxpbmUyID0gbmV3IGZhYnJpYy5MaW5lKFtdLCB7IHN0cm9rZTogJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC42KScsIHN0cm9rZVdpZHRoOiAxLCBzZWxlY3RhYmxlOiBmYWxzZSwgZXZlbnRlZDogZmFsc2UgfSk7XG5cdFx0XHRcdHRoaXMubGluZTMgPSBuZXcgZmFicmljLkxpbmUoW10sIHsgc3Ryb2tlOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjYpJywgc3Ryb2tlV2lkdGg6IDEsIHNlbGVjdGFibGU6IGZhbHNlLCBldmVudGVkOiBmYWxzZSB9KTtcblx0XHRcdFx0dGhpcy5saW5lNCA9IG5ldyBmYWJyaWMuTGluZShbXSwgeyBzdHJva2U6ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNiknLCBzdHJva2VXaWR0aDogMSwgc2VsZWN0YWJsZTogZmFsc2UsIGV2ZW50ZWQ6IGZhbHNlIH0pO1xuXHRcdFx0XHR0aGlzLmdyaWQgPSBuZXcgZmFicmljLkdyb3VwKFt0aGlzLmxpbmUxLCB0aGlzLmxpbmUyLCB0aGlzLmxpbmUzLCB0aGlzLmxpbmU0XSk7XG5cdFx0XHRcdHRoaXMuZ3JpZC5vcmlnaW5ZID0gJ2xlZnQnO1xuXHRcdFx0XHR0aGlzLmdyaWQub3JpZ2luWCA9ICd0b3AnO1xuICAgICAgICAgICAgICAgIHRoaXMuZ3JpZC5pZ25vcmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuZ3JpZC5zZWxlY3RhYmxlID0gZmFsc2U7XG5cdFx0XHRcdGNhbnZhcy5mYWJyaWMuYWRkKHRoaXMuZ3JpZCk7XG5cdFx0ICAgIFx0dGhpcy5ncmlkLm1vdmVUbygxMCk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuZ3JpZC53aWR0aCA9IHRoaXMucmVjdC5nZXRXaWR0aCgpO1xuXHRcdFx0dGhpcy5ncmlkLmhlaWdodCA9IHRoaXMucmVjdC5nZXRIZWlnaHQoKTtcblx0XHRcdHRoaXMuZ3JpZC5sZWZ0ID0gdGhpcy5yZWN0LmdldExlZnQoKTtcblx0XHRcdHRoaXMuZ3JpZC50b3AgPSB0aGlzLnJlY3QuZ2V0VG9wKCk7XG5cblx0XHRcdHZhciB3aWR0aCAgPSBjcm9wem9uZS5yZWN0LmdldFdpZHRoKCkgLyAzLFxuXHRcdFx0XHRoZWlnaHQgPSBjcm9wem9uZS5yZWN0LmdldEhlaWdodCgpIC8gMztcblxuXHRcdFx0dGhpcy5saW5lMS5zZXQoe1xuXHRcdFx0XHR4MTogd2lkdGgsXG5cdFx0XHRcdHkxOiAwLFxuXHRcdFx0XHR4Mjogd2lkdGgsXG5cdFx0XHRcdHkyOiBjcm9wem9uZS5ncmlkLmdldEhlaWdodCgpLFxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMubGluZTIuc2V0KHtcblx0XHRcdFx0eDE6IHdpZHRoICogMixcblx0XHRcdFx0eTE6IDAsXG5cdFx0XHRcdHgyOiB3aWR0aCAqIDIsXG5cdFx0XHRcdHkyOiBjcm9wem9uZS5ncmlkLmdldEhlaWdodCgpXG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5saW5lMy5zZXQoe1xuXHRcdFx0XHR4MTogMCxcblx0XHRcdFx0eTE6IGhlaWdodCxcblx0XHRcdFx0eDI6IGNyb3B6b25lLmdyaWQuZ2V0V2lkdGgoKSxcblx0XHRcdFx0eTI6IGhlaWdodFxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMubGluZTQuc2V0KHtcblx0XHRcdFx0eDE6IDAsXG5cdFx0XHRcdHkxOiBoZWlnaHQgKiAyLFxuXHRcdFx0XHR4MjogY3JvcHpvbmUuZ3JpZC5nZXRXaWR0aCgpLFxuXHRcdFx0XHR5MjogaGVpZ2h0ICogMlxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuY29uc3RyYWluV2l0aGluQ2FudmFzKHRoaXMuZ3JpZCk7XG5cdFx0fSxcblxuXHRcdGRyYXdPdmVybGF5OiBmdW5jdGlvbigpIHtcblxuXHQgICAgXHRpZiAoICEgdGhpcy5pbml0aWF0ZWQpIHtcblx0ICAgIFx0XHR0aGlzLnRvcFJlY3QgPSBuZXcgZmFicmljLlJlY3Qoe2ZpbGw6ICdyZ2JhKDAsMCwwLDAuNyknLCBzZWxlY3RhYmxlOiB0cnVlLCBldmVudGVkOiBmYWxzZX0pO1xuXHQgICAgXHRcdHRoaXMucmlnaHRSZWN0ID0gbmV3IGZhYnJpYy5SZWN0KHtmaWxsOiAncmdiYSgwLDAsMCwwLjcpJywgc2VsZWN0YWJsZTogdHJ1ZSwgZXZlbnRlZDogZmFsc2V9KTtcblx0ICAgIFx0XHR0aGlzLmJvdHRvbVJlY3QgPSBuZXcgZmFicmljLlJlY3Qoe2ZpbGw6ICdyZ2JhKDAsMCwwLDAuNyknLCBzZWxlY3RhYmxlOiB0cnVlLCBldmVudGVkOiBmYWxzZX0pO1xuXHQgICAgXHRcdHRoaXMubGVmdFJlY3QgPSBuZXcgZmFicmljLlJlY3Qoe2ZpbGw6ICdyZ2JhKDAsMCwwLDAuNyknLCBzZWxlY3RhYmxlOiB0cnVlLCBldmVudGVkOiBmYWxzZX0pO1xuXHQgICAgXHRcdHRoaXMub3ZlcmxheSA9IG5ldyBmYWJyaWMuR3JvdXAoW3RoaXMudG9wUmVjdCwgdGhpcy5yaWdodFJlY3QsIHRoaXMuYm90dG9tUmVjdCwgdGhpcy5sZWZ0UmVjdF0pO1xuICAgICAgICAgICAgICAgIHRoaXMub3ZlcmxheS5pZ25vcmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMub3ZlcmxheS5uYW1lID0gJ2dyaWQub3ZlcmxheSc7XG5cdFx0XHRcdGNhbnZhcy5mYWJyaWMuYWRkKHRoaXMub3ZlcmxheSk7XG5cdFx0XHRcdHRoaXMub3ZlcmxheS5tb3ZlVG8oMSk7XG5cdCAgICBcdH1cblxuICAgIFx0XHR0aGlzLnRvcFJlY3Quc2V0KHtcblx0ICAgIFx0XHRsZWZ0OiAwLFxuXHRcdFx0XHR0b3A6IDAsXG5cdFx0XHRcdHdpZHRoOiBjYW52YXMub3JpZ2luYWwud2lkdGgsXG5cdFx0XHRcdGhlaWdodDogdGhpcy5yZWN0LmdldEhlaWdodCgpIDwgMCA/IHRoaXMucmVjdC5nZXRUb3AoKSAtIE1hdGguYWJzKHRoaXMucmVjdC5nZXRIZWlnaHQoKSkgOiB0aGlzLnJlY3QuZ2V0VG9wKCksXG5cdCAgICBcdH0pO1xuXG5cdCAgICBcdHRoaXMucmlnaHRSZWN0LnNldCh7XG5cdCAgICBcdFx0bGVmdDogdGhpcy5yZWN0LmdldFdpZHRoKCkgPCAwID8gdGhpcy5yZWN0LmdldExlZnQoKSA6IHRoaXMucmVjdC5nZXRMZWZ0KCkgKyB0aGlzLnJlY3QuZ2V0V2lkdGgoKSxcblx0XHRcdFx0dG9wOiB0aGlzLnJlY3QuZ2V0VG9wKCksXG5cdFx0XHRcdHdpZHRoOiB0aGlzLnJlY3QuZ2V0V2lkdGgoKSA8IDAgPyBjYW52YXMub3JpZ2luYWwud2lkdGggLSAodGhpcy5yZWN0LmdldExlZnQoKSArIHRoaXMucmVjdC5nZXRXaWR0aCgpKSAtIE1hdGguYWJzKHRoaXMucmVjdC5nZXRXaWR0aCgpKSA6IGNhbnZhcy5vcmlnaW5hbC53aWR0aCAtICh0aGlzLnJlY3QuZ2V0TGVmdCgpICsgdGhpcy5yZWN0LmdldFdpZHRoKCkpLFxuXHRcdFx0XHRoZWlnaHQ6IHRoaXMucmVjdC5nZXRIZWlnaHQoKSxcblx0ICAgIFx0fSk7XG5cblx0ICAgIFx0dGhpcy5ib3R0b21SZWN0LnNldCh7XG5cdCAgICBcdFx0bGVmdDogMCxcblx0XHRcdFx0dG9wOiB0aGlzLnJlY3QuZ2V0SGVpZ2h0KCkgPCAwID8gdGhpcy5yZWN0LmdldFRvcCgpIDogdGhpcy5yZWN0LmdldFRvcCgpICsgdGhpcy5yZWN0LmdldEhlaWdodCgpLFxuXHRcdFx0XHR3aWR0aDogY2FudmFzLm9yaWdpbmFsLndpZHRoLFxuXHRcdFx0XHRoZWlnaHQ6IHRoaXMucmVjdC5nZXRIZWlnaHQoKSA8IDAgPyBjYW52YXMub3JpZ2luYWwuaGVpZ2h0IC0gKHRoaXMucmVjdC5nZXRUb3AoKSkgOiBjYW52YXMub3JpZ2luYWwuaGVpZ2h0IC0gKHRoaXMucmVjdC5nZXRUb3AoKSArIHRoaXMucmVjdC5nZXRIZWlnaHQoKSksXG5cdCAgICBcdH0pO1xuXG5cdCAgICBcdHRoaXMubGVmdFJlY3Quc2V0KHtcblx0ICAgIFx0XHRsZWZ0OiAwLFxuXHRcdFx0XHR0b3A6IHRoaXMucmVjdC5nZXRUb3AoKSxcblx0XHRcdFx0d2lkdGg6IHRoaXMucmVjdC5nZXRXaWR0aCgpID4gMCA/IHRoaXMucmVjdC5nZXRMZWZ0KCkgOiB0aGlzLnJlY3QuZ2V0TGVmdCgpIC0gTWF0aC5hYnModGhpcy5yZWN0LmdldFdpZHRoKCkpLFxuXHRcdFx0XHRoZWlnaHQ6IHRoaXMucmVjdC5nZXRIZWlnaHQoKSxcblx0ICAgIFx0fSk7XG5cblxuXHQgICAgfVxuXHR9O1xuXG5cdHJldHVybiBjcm9wem9uZTtcblxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5jcm9wJylcblxuLmNvbnRyb2xsZXIoJ0Nyb3BDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICdjcm9wcGVyJywgJ2Nyb3B6b25lJywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCBjcm9wcGVyLCBjcm9wem9uZSkge1xuXG5cdCRzY29wZS5jcm9wcGVyID0gY3JvcHBlcjtcblx0JHNjb3BlLmNyb3B6b25lID0gY3JvcHpvbmU7XG5cbiAgICAkcm9vdFNjb3BlLiRvbigndGFiLmNoYW5nZWQnLCBmdW5jdGlvbihlLCBuZXdUYWIsIG9sZFRhYikge1xuICAgICAgIGlmIChvbGRUYWIgPT09ICdiYXNpY3MnICYmIG5ld1RhYiAhPT0gJ2Jhc2ljcycpIHtcbiAgICAgICAgICAgY3JvcHBlci5zdG9wKCk7XG4gICAgICAgfVxuICAgIH0pO1xuXG4gICAgJHJvb3RTY29wZS4kd2F0Y2goJ2FjdGl2ZVBhbmVsJywgZnVuY3Rpb24obmV3UGFuZWwsIG9sZFBhbmVsKSB7XG4gICAgICAgIGlmIChuZXdQYW5lbCAhPT0gJ2Nyb3AnICYmIG9sZFBhbmVsID09PSAnY3JvcCcpIHtcbiAgICAgICAgICAgIGNyb3B6b25lLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgfSk7XG5cblx0JHJvb3RTY29wZS4kb24oJ2Nyb3B6b25lLmFkZGVkJywgZnVuY3Rpb24oKSB7XG5cdFx0JHNjb3BlLndpZHRoID0gTWF0aC5yb3VuZChjcm9wem9uZS5yZWN0LndpZHRoKTtcblx0XHQkc2NvcGUuaGVpZ2h0ID0gTWF0aC5yb3VuZChjcm9wem9uZS5yZWN0LmhlaWdodCk7XG5cdH0pO1xufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5iYXNpY3MnLCBbXSlcblxuLmNvbnRyb2xsZXIoJ1JvdGF0ZUNvbnRyb2xsZXInLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ2NhbnZhcycsICdoaXN0b3J5JywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCBjYW52YXMsIGhpc3RvcnkpIHtcblxuICAgICAgICAkc2NvcGUuYW5nbGUgPSAwO1xuXG4gICAgICAgICRzY29wZS5zdGFydFJvdGF0b3IgPSBmdW5jdGlvbigkZXZlbnQpIHtcbiAgICAgICAgICAgIGhpc3RvcnkuYWRkKCdyb3RhdGUtb3JpZ2luYWwtc3RhdGUnLCAnYmFja3VwJywgdHJ1ZSk7XG4gICAgICAgICAgICAkc2NvcGUub3BlblBhbmVsKCdyb3RhdGUnLCAkZXZlbnQpO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5hcHBseVJvdGF0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XG4gICAgICAgICAgICBoaXN0b3J5LmFkZCgncm90YXRpb24nLCAncm90YXRlLXJpZ2h0Jyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaGlzdG9yeS5sb2FkKCdyb3RhdGUtb3JpZ2luYWwtc3RhdGUnKTtcbiAgICAgICAgICAgICRyb290U2NvcGUuYWN0aXZlUGFuZWwgPSBmYWxzZTtcbiAgICAgICAgICAgICRzY29wZS5hbmdsZSA9IDA7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9yb3RhdGUgcHJvcGVybHkgYnkgc2NhbGluZyBjYW52YXMgdG8gbmV3IGhlaWdodCBhZnRlciByb3RhdGluZyBtYWluIGltYWdlIGJ5IDkwIGRlZ3JlZXNcbiAgICAgICAgJHNjb3BlLnJvdGF0ZVByb3BlciA9IGZ1bmN0aW9uKG9yaWdpbmFsQW5nbGUpIHtcbiAgICAgICAgICAgIGNhbnZhcy56b29tKDEpO1xuICAgICAgICAgICAgdmFyIGFuZ2xlID0gKGNhbnZhcy5tYWluSW1hZ2UuZ2V0QW5nbGUoKSArIG9yaWdpbmFsQW5nbGUpICUgMzYwO1xuXG4gICAgICAgICAgICB2YXIgaGVpZ2h0ID0gTWF0aC5hYnMoY2FudmFzLm1haW5JbWFnZS5nZXRXaWR0aCgpKihNYXRoLnNpbihhbmdsZSpNYXRoLlBJLzE4MCkpKStNYXRoLmFicyhjYW52YXMubWFpbkltYWdlLmdldEhlaWdodCgpKihNYXRoLmNvcyhhbmdsZSpNYXRoLlBJLzE4MCkpKSxcbiAgICAgICAgICAgICAgICB3aWR0aCA9IE1hdGguYWJzKGNhbnZhcy5tYWluSW1hZ2UuZ2V0SGVpZ2h0KCkqKE1hdGguc2luKGFuZ2xlKk1hdGguUEkvMTgwKSkpK01hdGguYWJzKGNhbnZhcy5tYWluSW1hZ2UuZ2V0V2lkdGgoKSooTWF0aC5jb3MoYW5nbGUqTWF0aC5QSS8xODApKSk7XG5cbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuc2V0V2lkdGgod2lkdGggKiBjYW52YXMuY3VycmVudFpvb20pO1xuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRIZWlnaHQoaGVpZ2h0ICogY2FudmFzLmN1cnJlbnRab29tKTtcbiAgICAgICAgICAgIGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgICAgICBjYW52YXMub3JpZ2luYWwud2lkdGggID0gd2lkdGg7XG4gICAgICAgICAgICBjYW52YXMubWFpbkltYWdlLmNlbnRlcigpO1xuXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLmZvckVhY2hPYmplY3QoZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgICAgICAgICAgb2JqLnJvdGF0ZSgob2JqLmdldEFuZ2xlKCkgKyBvcmlnaW5hbEFuZ2xlKSAlIDM2MCk7XG4gICAgICAgICAgICAgICAgb2JqLnNldENvb3JkcygpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRyb290U2NvcGUuZWRpdG9yQ3VzdG9tQWN0aW9ucy5yb3RhdGUgPSBvcmlnaW5hbEFuZ2xlO1xuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcbiAgICAgICAgICAgIGNhbnZhcy5maXRUb1NjcmVlbigpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vb25seSByb3RhdGUgdGhlIG9iamVjdHMgb2YgY2FudmFzIHdoaWxlIGxlYXZpbmcgY2FudmFzIHdpZHRoL2hlaWdodCBpbnRhY3RcbiAgICAgICAgJHNjb3BlLnJvdGF0ZSA9IGZ1bmN0aW9uKGFuZ2xlLCBkaXJlY3Rpb24pIHtcbiAgICAgICAgICAgIGlmIChhbmdsZSA+IDM2MCB8fCBhbmdsZSA8IDApIHJldHVybjtcbiAgICAgICAgICAgIHZhciByZXNldE9yaWdpbiA9IGZhbHNlO1xuXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLmZvckVhY2hPYmplY3QoZnVuY3Rpb24ob2JqKSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoZGlyZWN0aW9uICYmIGRpcmVjdGlvbiA9PT0gJ2xlZnQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGFuZ2xlID0gb2JqLmdldEFuZ2xlKCkgLSA5MDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiAmJiBkaXJlY3Rpb24gPT09ICdyaWdodCcpIHtcbiAgICAgICAgICAgICAgICAgICAgYW5nbGUgPSBvYmouZ2V0QW5nbGUoKSArIDkwO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICgob2JqLm9yaWdpblggIT09ICdjZW50ZXInIHx8IG9iai5vcmlnaW5ZICE9PSAnY2VudGVyJykgJiYgb2JqLmNlbnRlcmVkUm90YXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNldE9yaWdpblRvQ2VudGVyICYmICRzY29wZS5zZXRPcmlnaW5Ub0NlbnRlcihvYmopO1xuICAgICAgICAgICAgICAgICAgICByZXNldE9yaWdpbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgYW5nbGUgPSBhbmdsZSA+IDM2MCA/IDkwIDogYW5nbGUgPCAwID8gMjcwIDogYW5nbGU7XG5cbiAgICAgICAgICAgICAgICBvYmouc2V0QW5nbGUoYW5nbGUpLnNldENvb3JkcygpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHJlc2V0T3JpZ2luKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zZXRDZW50ZXJUb09yaWdpbiAmJiAkc2NvcGUuc2V0Q2VudGVyVG9PcmlnaW4ob2JqKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY2FudmFzLmZpdFRvU2NyZWVuKCk7XG4gICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5zZXRPcmlnaW5Ub0NlbnRlciA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgIG9iai5fb3JpZ2luYWxPcmlnaW5YID0gb2JqLm9yaWdpblg7XG4gICAgICAgICAgICBvYmouX29yaWdpbmFsT3JpZ2luWSA9IG9iai5vcmlnaW5ZO1xuXG4gICAgICAgICAgICB2YXIgY2VudGVyID0gb2JqLmdldENlbnRlclBvaW50KCk7XG5cbiAgICAgICAgICAgIG9iai5zZXQoe1xuICAgICAgICAgICAgICAgIG9yaWdpblg6ICdjZW50ZXInLFxuICAgICAgICAgICAgICAgIG9yaWdpblk6ICdjZW50ZXInLFxuICAgICAgICAgICAgICAgIGxlZnQ6IGNlbnRlci54LFxuICAgICAgICAgICAgICAgIHRvcDogY2VudGVyLnlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5zZXRDZW50ZXJUb09yaWdpbiA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgIHZhciBvcmlnaW5Qb2ludCA9IG9iai50cmFuc2xhdGVUb09yaWdpblBvaW50KFxuICAgICAgICAgICAgICAgIG9iai5nZXRDZW50ZXJQb2ludCgpLFxuICAgICAgICAgICAgICAgIG9iai5fb3JpZ2luYWxPcmlnaW5YLFxuICAgICAgICAgICAgICAgIG9iai5fb3JpZ2luYWxPcmlnaW5ZKTtcblxuICAgICAgICAgICAgb2JqLnNldCh7XG4gICAgICAgICAgICAgICAgb3JpZ2luWDogb2JqLl9vcmlnaW5hbE9yaWdpblgsXG4gICAgICAgICAgICAgICAgb3JpZ2luWTogb2JqLl9vcmlnaW5hbE9yaWdpblksXG4gICAgICAgICAgICAgICAgbGVmdDogb3JpZ2luUG9pbnQueCxcbiAgICAgICAgICAgICAgICB0b3A6IG9yaWdpblBvaW50LnlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5iYXNpY3MnKVxyXG5cclxuLmNvbnRyb2xsZXIoJ0NhbnZhc0JhY2tncm91bmRDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICdjYW52YXMnLCAnaGlzdG9yeScsIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgY2FudmFzLCBoaXN0b3J5KSB7XHJcblxyXG4gICAgLy9jYW52YXMuZmFicmljLnNldEJhY2tncm91bmRDb2xvcignI2ZmZmZmZicpO1xyXG4gICAgLy9jYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgJHNjb3BlLnNldEJhY2tncm91bmQgPSBmdW5jdGlvbihjb2xvcikge1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMuc2V0QmFja2dyb3VuZENvbG9yKGNvbG9yKTtcclxuICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuYXBwbHkgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XHJcbiAgICAgICAgJHJvb3RTY29wZS5iZ0NvbG9yID0gJChcIiNjdnMtYmdjb2xvclwiKS52YWwoKTtcclxuICAgICAgICBoaXN0b3J5LmFkZCgnQ2FudmFzIENvbG9yJywgJ2Zvcm1hdC1jb2xvci1maWxsJyk7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XHJcbiAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRCYWNrZ3JvdW5kQ29sb3IoJHJvb3RTY29wZS5iZ0NvbG9yKTtcclxuICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgfTtcclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5iYXNpY3MnKVxuXG4uY29udHJvbGxlcignUmVzaXplQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnY2FudmFzJywgJ2hpc3RvcnknLCBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUsIGNhbnZhcywgaGlzdG9yeSkge1xuXG4gICAgJHNjb3BlLmNvbnN0cmFpblByb3BvcnRpb25zID0gdHJ1ZTtcblxuICAgICRzY29wZS5wZXJjZW50ID0gMTAwO1xuXG4gICAgJHNjb3BlLnN0YXJ0UmVzaXplciA9IGZ1bmN0aW9uKCRldmVudCkge1xuICAgICAgICAkc2NvcGUud2lkdGggID0gJHNjb3BlLnVzZVBlcmNlbnRhZ2VzID8gMTAwIDogTWF0aC5jZWlsKGNhbnZhcy5vcmlnaW5hbC53aWR0aCk7XG4gICAgICAgICRzY29wZS5oZWlnaHQgPSAkc2NvcGUudXNlUGVyY2VudGFnZXMgPyAxMDAgOiBNYXRoLmNlaWwoY2FudmFzLm9yaWdpbmFsLmhlaWdodCk7XG4gICAgICAgIGhpc3RvcnkuYWRkKCdiZWZvcmVSZXNpemUnLCBmYWxzZSwgdHJ1ZSk7XG4gICAgICAgIGNhbnZhcy56b29tKDEpO1xuICAgICAgICAkc2NvcGUub3BlblBhbmVsKCdyZXNpemUnLCAkZXZlbnQpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBUb2dnbGUgcmVzaXppbmcgbW9kZSBiZXR3ZWVuIHBlcmNlbnRhZ2VzIGFuZCBwaXhsZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IHVzZVBlcmNlbnRhZ2VzXG4gICAgICovXG4gICAgJHNjb3BlLnRvZ2dsZVBlcmNlbnRhZ2VzID0gZnVuY3Rpb24odXNlUGVyY2VudGFnZXMpIHtcbiAgICAgICAgaWYgKHVzZVBlcmNlbnRhZ2VzKSB7XG4gICAgICAgICAgICAkc2NvcGUud2lkdGggPSAoJHNjb3BlLndpZHRoIC8gY2FudmFzLm9yaWdpbmFsLndpZHRoKSAqIDEwMDtcbiAgICAgICAgICAgICRzY29wZS5oZWlnaHQgPSAoJHNjb3BlLmhlaWdodCAvIGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQpICogMTAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHNjb3BlLndpZHRoID0gKCRzY29wZS53aWR0aCAqIGNhbnZhcy5vcmlnaW5hbC53aWR0aCkgLyAxMDA7XG4gICAgICAgICAgICAkc2NvcGUuaGVpZ2h0ID0gKCRzY29wZS5oZWlnaHQgKiBjYW52YXMub3JpZ2luYWwuaGVpZ2h0KSAvIDEwMDtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAkc2NvcGUuYXBwbHkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRXaWR0aCAgPSBNYXRoLmNlaWwoY2FudmFzLm9yaWdpbmFsLndpZHRoKSxcbiAgICAgICAgICAgIGN1cnJlbnRIZWlnaHQgPSBNYXRoLmNlaWwoY2FudmFzLm9yaWdpbmFsLmhlaWdodCksXG4gICAgICAgICAgICBuZXdXaWR0aCAgICAgID0gTWF0aC5jZWlsKCRzY29wZS53aWR0aCksXG4gICAgICAgICAgICBuZXdIZWlnaHQgICAgID0gTWF0aC5jZWlsKCRzY29wZS5oZWlnaHQpO1xuXG4gICAgICAgIGlmICgkc2NvcGUudXNlUGVyY2VudGFnZXMpIHtcbiAgICAgICAgICAgIHZhciB3aWR0aFNjYWxlICAgID0gJHNjb3BlLndpZHRoIC8gMTAwO1xuICAgICAgICAgICAgdmFyIGhlaWdodFNjYWxlICAgPSAkc2NvcGUuaGVpZ2h0IC8gMTAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIHdpZHRoU2NhbGUgICAgPSAkc2NvcGUud2lkdGggLyBjYW52YXMub3JpZ2luYWwud2lkdGg7XG4gICAgICAgICAgICB2YXIgaGVpZ2h0U2NhbGUgICA9ICRzY29wZS5oZWlnaHQgLyBjYW52YXMub3JpZ2luYWwuaGVpZ2h0O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGN1cnJlbnRXaWR0aCA9PT0gbmV3V2lkdGggJiYgY3VycmVudEhlaWdodCA9PT0gbmV3SGVpZ2h0KSByZXR1cm47XG5cbiAgICAgICAgcmVzaXplKHdpZHRoU2NhbGUsIGhlaWdodFNjYWxlKTtcblxuICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XG4gICAgICAgIGhpc3RvcnkuYWRkKCdyZXNpemUnLCAnb3Blbi13aWR0aCcpO1xuICAgICAgICBjYW52YXMuZml0VG9TY3JlZW4oKTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLmNsb3NlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICRyb290U2NvcGUuYWN0aXZlUGFuZWwgPSBmYWxzZTtcbiAgICAgICAgY2FudmFzLmZpdFRvU2NyZWVuKCk7XG4gICAgfTtcblxuICAgICRzY29wZS5hc3BlY3RUb0hlaWdodCA9IGZ1bmN0aW9uKG5ld1dpZHRoKSB7XG4gICAgICAgIGlmICggISAkc2NvcGUuY29uc3RyYWluUHJvcG9ydGlvbnMpIHJldHVybjtcblxuICAgICAgICBpZiAoJHNjb3BlLnVzZVBlcmNlbnRhZ2VzKSB7XG4gICAgICAgICAgICAkc2NvcGUuaGVpZ2h0ID0gbmV3V2lkdGg7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgd1JhdGlvID0gcGFyc2VGbG9hdCgoY2FudmFzLm9yaWdpbmFsLndpZHRoIC8gbmV3V2lkdGgpLnRvUHJlY2lzaW9uKDMpKTtcbiAgICAgICAgICAgICRzY29wZS5oZWlnaHQgPSBNYXRoLmNlaWwoY2FudmFzLm9yaWdpbmFsLmhlaWdodCAvIHdSYXRpbyk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgJHNjb3BlLmFzcGVjdFRvV2lkdGggPSBmdW5jdGlvbihuZXdIZWlnaHQpIHtcbiAgICAgICAgaWYgKCAhICRzY29wZS5jb25zdHJhaW5Qcm9wb3J0aW9ucykgcmV0dXJuO1xuXG4gICAgICAgIGlmICgkc2NvcGUudXNlUGVyY2VudGFnZXMpIHtcbiAgICAgICAgICAgICRzY29wZS53aWR0aCA9IG5ld0hlaWdodDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBoUmF0aW8gPSBwYXJzZUZsb2F0KChjYW52YXMub3JpZ2luYWwuaGVpZ2h0IC8gbmV3SGVpZ2h0KS50b1ByZWNpc2lvbigzKSk7XG4gICAgICAgICAgICAkc2NvcGUud2lkdGggPSBNYXRoLmZsb29yKGNhbnZhcy5vcmlnaW5hbC53aWR0aCAvIGhSYXRpbyk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gcmVzaXplKHdpZHRoU2NhbGUsIGhlaWdodFNjYWxlKSB7XG4gICAgICAgIHZhciBuZXdIZWlnaHQgPSBNYXRoLnJvdW5kKGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQgKiBoZWlnaHRTY2FsZSksXG4gICAgICAgICAgICBuZXdXaWR0aCAgPSBNYXRoLnJvdW5kKGNhbnZhcy5vcmlnaW5hbC53aWR0aCAqIHdpZHRoU2NhbGUpO1xuXG4gICAgICAgIGNhbnZhcy5mYWJyaWMuc2V0SGVpZ2h0KG5ld0hlaWdodCk7XG4gICAgICAgIGNhbnZhcy5mYWJyaWMuc2V0V2lkdGgobmV3V2lkdGgpO1xuICAgICAgICBjYW52YXMub3JpZ2luYWwud2lkdGggPSBuZXdXaWR0aDtcbiAgICAgICAgY2FudmFzLm9yaWdpbmFsLmhlaWdodCA9IG5ld0hlaWdodDtcblxuICAgICAgICB2YXIgb2JqZWN0cyA9IGNhbnZhcy5mYWJyaWMuZ2V0T2JqZWN0cygpO1xuICAgICAgICBmb3IgKHZhciBpIGluIG9iamVjdHMpIHtcbiAgICAgICAgICAgIHZhciBzY2FsZVggPSBvYmplY3RzW2ldLnNjYWxlWDtcbiAgICAgICAgICAgIHZhciBzY2FsZVkgPSBvYmplY3RzW2ldLnNjYWxlWTtcbiAgICAgICAgICAgIHZhciBsZWZ0ID0gb2JqZWN0c1tpXS5sZWZ0O1xuICAgICAgICAgICAgdmFyIHRvcCA9IG9iamVjdHNbaV0udG9wO1xuXG4gICAgICAgICAgICB2YXIgdGVtcFNjYWxlWCA9IHNjYWxlWCAqIHdpZHRoU2NhbGU7XG4gICAgICAgICAgICB2YXIgdGVtcFNjYWxlWSA9IHNjYWxlWSAqIGhlaWdodFNjYWxlO1xuICAgICAgICAgICAgdmFyIHRlbXBMZWZ0ID0gbGVmdCAqIHdpZHRoU2NhbGU7XG4gICAgICAgICAgICB2YXIgdGVtcFRvcCA9IHRvcCAqIGhlaWdodFNjYWxlO1xuXG4gICAgICAgICAgICBvYmplY3RzW2ldLnNjYWxlWCA9IHRlbXBTY2FsZVg7XG4gICAgICAgICAgICBvYmplY3RzW2ldLnNjYWxlWSA9IHRlbXBTY2FsZVk7XG4gICAgICAgICAgICBvYmplY3RzW2ldLmxlZnQgPSB0ZW1wTGVmdDtcbiAgICAgICAgICAgIG9iamVjdHNbaV0udG9wID0gdGVtcFRvcDtcblxuICAgICAgICAgICAgb2JqZWN0c1tpXS5zZXRDb29yZHMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XG4gICAgfVxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5iYXNpY3MnKVxuXG4uY29udHJvbGxlcignUm91bmRlZENvcm5lcnNDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICdjYW52YXMnLCAnaGlzdG9yeScsIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgY2FudmFzLCBoaXN0b3J5KSB7XG5cbiAgICAkc2NvcGUucmFkaXVzID0gNTA7XG5cbiAgICAkc2NvcGUuc3RhcnRSb3VuZGVkQ29ybmVycyA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgaWYgKCRyb290U2NvcGUuYWN0aXZlUGFuZWwgPT09ICdyb3VuZCcpIHJldHVybjtcblxuICAgICAgICAkcm9vdFNjb3BlLm9wZW5QYW5lbCgncm91bmQnLCBlKTtcblxuICAgICAgICAkc2NvcGUucmVjdCA9IG5ldyBmYWJyaWMuUmVjdCh7XG4gICAgICAgICAgICB3aWR0aDogY2FudmFzLm9yaWdpbmFsLndpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0OiBjYW52YXMub3JpZ2luYWwuaGVpZ2h0LFxuICAgICAgICAgICAgcng6ICRzY29wZS5yYWRpdXMsXG4gICAgICAgICAgICByeTogJHNjb3BlLnJhZGl1cyxcbiAgICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgICBmaWxsOiAndHJhbnNwYXJlbnQnLFxuICAgICAgICAgICAgbmFtZTogJ3JvdW5kaW5nLXJlY3QnLFxuICAgICAgICAgICAgc3Ryb2tlOiAnI2ZmZicsXG4gICAgICAgICAgICBzdHJva2VEYXNoQXJyYXk6IFs1LCA1XSxcbiAgICAgICAgICAgIHNlbGVjdGFibGU6IGZhbHNlLFxuICAgICAgICAgICAgZXZlbnRlZDogZmFsc2UsXG4gICAgICAgICAgICBpZ25vcmU6IHRydWVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2FudmFzLmZhYnJpYy5hZGQoJHNjb3BlLnJlY3QpO1xuICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xuICAgIH07XG5cbiAgICAkc2NvcGUuYWRqdXN0UHJldmlldyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoICEgJHNjb3BlLnJlY3QpIHJldHVybjtcblxuICAgICAgICAkc2NvcGUucmVjdC5zZXQoe1xuICAgICAgICAgICAgcng6ICRzY29wZS5yYWRpdXMsIHJ5OiAkc2NvcGUucmFkaXVzXG4gICAgICAgIH0pO1xuICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xuICAgIH07XG5cbiAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24obGVhdmVQYW5lbCkge1xuICAgICAgICBjYW52YXMuZmFicmljLnJlbW92ZSgkc2NvcGUucmVjdCk7XG4gICAgICAgICRzY29wZS5yZWN0ICA9IGZhbHNlO1xuICAgICAgICAkc2NvcGUucmFkaXVzID0gNTA7XG4gICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XG5cbiAgICAgICAgaWYgKCAhbGVhdmVQYW5lbCkge1xuICAgICAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVQYW5lbCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgICRzY29wZS5hcHBseSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAkcm9vdFNjb3BlLmVkaXRvckN1c3RvbUFjdGlvbnMucm91bmRDb3JuZXJzID0gYW5ndWxhci5jb3B5KCRzY29wZS5yYWRpdXMpO1xuXG4gICAgICAgIGNhbnZhcy5mYWJyaWMucmVtb3ZlKCRzY29wZS5yZWN0KTtcbiAgICAgICAgY2FudmFzLnpvb20oMSk7XG5cbiAgICAgICAgY2FudmFzLmZhYnJpYy5jbGlwVG8gPSBmdW5jdGlvbihjdHgpIHtcbiAgICAgICAgICAgICRzY29wZS5yZWN0LnJlbmRlcihjdHgpO1xuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5jbGlwVG8gPSBmYWxzZTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGRhdGEgPSBjYW52YXMuZmFicmljLnRvRGF0YVVSTCgpOyAvL2NhbnZhcy5nZXREYXRhVVJMKCk7XG4gICAgICAgIGNhbnZhcy5mYWJyaWMuY2xlYXIoKTtcbiAgICAgICAgJHNjb3BlLmNhbmNlbCgpO1xuXG4gICAgICAgIGNhbnZhcy5sb2FkTWFpbkltYWdlKGRhdGEsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJHJvb3RTY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgaGlzdG9yeS5hZGQoJ1JvdW5kIENvcm5lcnMnLCAncGFub3JhbWEtd2lkZS1hbmdsZScpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICAkcm9vdFNjb3BlLiRvbigndGFiLmNoYW5nZWQnLCBmdW5jdGlvbihlLCBuZXdUYWIsIG9sZFRhYikge1xuICAgICAgICBpZiAob2xkVGFiID09PSAnYmFzaWNzJyAmJiAkc2NvcGUucmVjdCAmJiBuZXdUYWIgIT09ICdiYXNpY3MnKSB7XG4gICAgICAgICAgICAkc2NvcGUuY2FuY2VsKCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgICRyb290U2NvcGUuJHdhdGNoKCdhY3RpdmVQYW5lbCcsIGZ1bmN0aW9uKG5ld1BhbmVsLCBvbGRQYW5lbCkge1xuICAgICAgICBpZiAobmV3UGFuZWwgIT09ICdyb3VuZCcgJiYgb2xkUGFuZWwgPT09ICdyb3VuZCcpIHtcbiAgICAgICAgICAgICRzY29wZS5jYW5jZWwodHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1dKTsiLCIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXIubW9kdWxlKCdJbWFnZUVkaXRvcicpXG5cbi5jb250cm9sbGVyKCdab29tQ29udHJvbGxlcicsIFsnJHJvb3RTY29wZScsICckc2NvcGUnLCAnY2FudmFzJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlLCBjYW52YXMpIHtcblxuICAgICRzY29wZS5jYW52YXMgPSBjYW52YXM7XG4gICAgJHNjb3BlLnpvb20gPSAxO1xuICAgICRzY29wZS5tYXhTY2FsZSA9IDIwMDtcbiAgICAkc2NvcGUubWluU2NhbGUgPSAzMDtcblxuICAgICRyb290U2NvcGUuJG9uKCdlZGl0b3IubWFpbkltYWdlLmxvYWRlZCcsIGZ1bmN0aW9uKCkgeyAkc2NvcGUuZml0VG9TY3JlZW4oKSB9KTtcbiAgICAkcm9vdFNjb3BlLiRvbignY2FudmFzLm9wZW5lZE5ldycsIGZ1bmN0aW9uKCkgeyAkc2NvcGUuZml0VG9TY3JlZW4oKSB9KTtcblxuICAgICRzY29wZS4kd2F0Y2goJ2NhbnZhcy5jdXJyZW50Wm9vbScsIGZ1bmN0aW9uKG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBjYW52YXNab29tID0gbmV3VmFsdWUgKiAxMDA7XG5cbiAgICAgICAgaWYgKGNhbnZhc1pvb20gIT09ICRzY29wZS56b29tKSB7XG4gICAgICAgICAgICAkc2NvcGUuem9vbSA9IGNhbnZhc1pvb207XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgICRzY29wZS5maXRUb1NjcmVlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJHNjb3BlLnpvb20gPSBjYW52YXMuY3VycmVudFpvb20gKiAxMDA7XG4gICAgICAgICAgICBcbiAgICAgICAgaWYgKGNhbnZhcy5tYWluSW1hZ2UpIHtcbiAgICAgICAgICAgIHZhciBvV2lkdGggPSBjYW52YXMubWFpbkltYWdlLm9yaWdpbmFsU3RhdGUud2lkdGgsXG4gICAgICAgICAgICAgICAgb0hlaWdodCA9IGNhbnZhcy5tYWluSW1hZ2Uub3JpZ2luYWxTdGF0ZS5oZWlnaHQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgb1dpZHRoID0gY2FudmFzLm9yaWdpbmFsLndpZHRoLFxuICAgICAgICAgICAgICAgIG9IZWlnaHQgPSBjYW52YXMub3JpZ2luYWwuaGVpZ2h0O1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIG1heFNjYWxlID0gTWF0aC5taW4oMzU4MiAvIG9IZWlnaHQsIDU3MzEgLyBvV2lkdGgpICogMTAwLFxuICAgICAgICAgICAgbWluU2NhbGUgPSBNYXRoLm1pbigxNDEgLyBvSGVpZ2h0LCAyMTEgLyBvV2lkdGgpICogMTAwO1xuXG4gICAgICAgICRzY29wZS5tYXhTY2FsZSA9IE1hdGguY2VpbChtYXhTY2FsZSk7XG4gICAgICAgICRzY29wZS5taW5TY2FsZSA9IE1hdGguY2VpbChtaW5TY2FsZSk7XG5cbiAgICAgICAgY2FudmFzLnpvb20oY2FudmFzLmN1cnJlbnRab29tKTtcbiAgICB9O1xuXG4gICAgLy9tYWtlIHN1cmUgd2UgYWRqdXN0IHpvb20gc2xpZGVyIHByb3Blcmx5IG9uIGhpc3RvcnkgY2hhbmdlXG4gICAgJHJvb3RTY29wZS4kb24oJ2hpc3RvcnkubG9hZGVkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICRzY29wZS56b29tID0gY2FudmFzLmN1cnJlbnRTY2FsZSAqIDEwMDtcbiAgICB9KTtcblxuICAgICRzY29wZS5kb1pvb20gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNhbnZhcy56b29tKCRzY29wZS56b29tIC8gMTAwKTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLmdldEN1cnJlbnRab29tID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBNYXRoLnJvdW5kKGNhbnZhcy5jdXJyZW50Wm9vbSAqIDEwMCk7XG4gICAgfTtcbn1dKTtcblxuXG5cbiIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdJbWFnZUVkaXRvcicpXHJcblxyXG4uY29udHJvbGxlcignVG9wUGFuZWxDb250cm9sbGVyJywgWyckcm9vdFNjb3BlJywgJyRzY29wZScsICckbWREaWFsb2cnLCAnJG1kVG9hc3QnLCAnJCRyQUYnLCAnJHRpbWVvdXQnLCAnJHdpbmRvdycsICdjYW52YXMnLCAnaGlzdG9yeScsICdzYXZlcicsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJG1kRGlhbG9nLCAkbWRUb2FzdCwgJCRyQUYsICR0aW1lb3V0LCAkd2luZG93LCBjYW52YXMsIGhpc3RvcnksIHNhdmVyKSB7XHJcblxyXG4gICAgJHNjb3BlLmhpc3RvcnkgPSBoaXN0b3J5O1xyXG5cclxuICAgICRzY29wZS5pc0RlbW8gPSAkcm9vdFNjb3BlLmlzRGVtbztcclxuICAgICRzY29wZS5jYW5PcGVuSW1hZ2UgPSBmYWxzZTtcclxuICAgICRzY29wZS5jYW52YXMgPSBjYW52YXM7XHJcbiAgICAkc2NvcGUub3BlbkltYWdlTW9kZSA9ICdvcGVuJztcclxuXHJcbiAgICAkc2NvcGUuY2FudmFzV2lkdGggPSA4MDA7XHJcbiAgICAkc2NvcGUuY2FudmFzSGVpZ2h0ID0gNjAwO1xyXG5cclxuICAgICRzY29wZS5pbWFnZU5hbWUgPSAnaW1hZ2UnO1xyXG4gICAgJHNjb3BlLmltYWdlVHlwZSA9ICdqcGVnJztcclxuICAgICRzY29wZS5pbWFnZVF1YWxpdHkgPSA4O1xyXG4gICAgXHJcbiAgICAkc2NvcGUuaW1hZ2VOYW1lID0gJHJvb3RTY29wZS5vcmRlcl9pZCArIFwiLVwiICsgJHJvb3RTY29wZS5wcm9kdWN0X2lkO1xyXG4gICAgJHNjb3BlLm9iamVjdHNQYW5lbE9wZW4gPSB0cnVlO1xyXG4gICAgJHNjb3BlLmhpc3RvcnlQYW5lbE9wZW4gPSBmYWxzZTtcclxuXHJcbiAgICAkc2NvcGUub3BlblVwbG9hZERpYWxvZyA9IGZ1bmN0aW9uKCRldmVudCkge1xyXG4gICAgICAgICRtZERpYWxvZy5zaG93KHtcclxuICAgICAgICAgICAgdGVtcGxhdGU6ICQoJyNtYWluLWltYWdlLXVwbG9hZC1kaWFsb2ctdGVtcGxhdGUnKS5odG1sKCksXHJcbiAgICAgICAgICAgIHRhcmdldEV2ZW50OiAkZXZlbnQsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdUb3BQYW5lbENvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUudG9nZ2xlUmlnaHRQYW5lbCA9IGZ1bmN0aW9uKG5hbWUsIGUpIHtcclxuICAgICAgICB2YXIgcGFuZWxJc09wZW4gPSAkc2NvcGVbbmFtZSsnUGFuZWxPcGVuJ107XHJcblxyXG4gICAgICAgIGlmIChwYW5lbElzT3Blbikge1xyXG4gICAgICAgICAgICAkc2NvcGVbbmFtZSsnUGFuZWxPcGVuJ10gPSBmYWxzZTtcclxuICAgICAgICAgICAgJCgnIycrbmFtZSkuaGlkZSgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICRzY29wZVtuYW1lKydQYW5lbE9wZW4nXSA9IHRydWU7XHJcbiAgICAgICAgICAgICQoJyMnK25hbWUpLnNob3coKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS50cmFuc2Zvcm1PcGVuID0gZnVuY3Rpb24obmFtZSwgZSkge1xyXG4gICAgICAgIHZhciBwYW5lbCA9ICQoJyMnK25hbWUpO1xyXG5cclxuICAgICAgICBwYW5lbC5yZW1vdmVDbGFzcygndHJhbnNpdGlvbi1vdXQgdHJhbnNpdGlvbi1pbicpLnNob3coKTtcclxuICAgICAgICAkc2NvcGUudHJhbnNmb3JtVG9DbGlja0VsZW1lbnQocGFuZWwsIGUpO1xyXG5cclxuICAgICAgICAkJHJBRihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcGFuZWwuYWRkQ2xhc3MoJ3RyYW5zaXRpb24taW4nKS5jc3MoJ3RyYW5zZm9ybScsICcnKTtcclxuICAgICAgICAgICAgZS5jdXJyZW50VGFyZ2V0LmJsdXIoKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLnRyYW5zZm9ybUNsb3NlID0gZnVuY3Rpb24obmFtZSwgZSkge1xyXG4gICAgICAgIHZhciBwYW5lbCA9ICQoJyMnK25hbWUpO1xyXG5cclxuICAgICAgICBwYW5lbC5hZGRDbGFzcygndHJhbnNpdGlvbi1vdXQnKS5yZW1vdmVDbGFzcygndHJhbnNpdGlvbi1pbicpO1xyXG4gICAgICAgICRzY29wZS50cmFuc2Zvcm1Ub0NsaWNrRWxlbWVudChwYW5lbCwgZSk7XHJcblxyXG4gICAgICAgIHBhbmVsLm9uZSgkcm9vdFNjb3BlLnRyYW5zaXRpb25FbmRFdmVudCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHBhbmVsLmhpZGUoKS5jc3MoJ3RyYW5zZm9ybScsICcnKS5yZW1vdmVDbGFzcygndHJhbnNpdGlvbi1vdXQnKTtcclxuICAgICAgICAgICAgZS5jdXJyZW50VGFyZ2V0LmJsdXIoKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLnRyYW5zZm9ybVRvQ2xpY2tFbGVtZW50ID0gZnVuY3Rpb24ocGFuZWwsIGUpIHtcclxuICAgICAgICB2YXIgY2xpY2tSZWN0ID0gZS50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgdmFyIHBhbmVsUmVjdCA9IHBhbmVsWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuICAgICAgICB2YXIgc2NhbGVYID0gTWF0aC5taW4oMC41LCBjbGlja1JlY3Qud2lkdGggLyBwYW5lbFJlY3Qud2lkdGgpO1xyXG4gICAgICAgIHZhciBzY2FsZVkgPSBNYXRoLm1pbigwLjUsIGNsaWNrUmVjdC5oZWlnaHQgLyBwYW5lbFJlY3QuaGVpZ2h0KTtcclxuXHJcbiAgICAgICAgcGFuZWwuY3NzKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlM2QoJyArXHJcbiAgICAgICAgICAgICgtcGFuZWxSZWN0LmxlZnQgKyBjbGlja1JlY3QubGVmdCArIGNsaWNrUmVjdC53aWR0aC8yIC0gcGFuZWxSZWN0LndpZHRoLzIpICsgJ3B4LCcgK1xyXG4gICAgICAgICAgICAoLXBhbmVsUmVjdC50b3AgKyBjbGlja1JlY3QudG9wICsgY2xpY2tSZWN0LmhlaWdodC8yIC0gcGFuZWxSZWN0LmhlaWdodC8yKSArICdweCwnICtcclxuICAgICAgICAgICAgJzApIHNjYWxlKCcgKyBzY2FsZVggKyAnLCcgKyBzY2FsZVkgKyAnKSdcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUub3BlblNhdmVEaWFsb2cgPSBmdW5jdGlvbigkZXZlbnQpIHtcclxuICAgICAgICBpZiAoJHJvb3RTY29wZS5nZXRQYXJhbSgnb25TYXZlQnV0dG9uQ2xpY2snKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJHJvb3RTY29wZS5nZXRQYXJhbSgnb25TYXZlQnV0dG9uQ2xpY2snKSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCRyb290U2NvcGUuZGVsYXlFZGl0b3JTdGFydCkge1xyXG4gICAgICAgICAgICByZXR1cm4gc2F2ZXIuc2F2ZUltYWdlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkbWREaWFsb2cuc2hvdyh7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlOiAkKCcjc2F2ZS1pbWFnZS1kaWFsb2cnKS5odG1sKCksXHJcbiAgICAgICAgICAgIHRhcmdldEV2ZW50OiAkZXZlbnQsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdUb3BQYW5lbENvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUub3BlbkhlbHAgPSBmdW5jdGlvbigkZXZlbnQpIHtcclxuXHJcbiAgICAgICAgJG1kRGlhbG9nLnNob3coe1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJCgnI21vZGFsLWhlbHAtdGV4dCcpLmh0bWwoKSxcclxuICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogWyckc2NvcGUnLCAnJG1kRGlhbG9nJywgZnVuY3Rpb24oJHNjb3BlLCAkbWREaWFsb2cpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jbG9zZU1vZGFsID0gJG1kRGlhbG9nLmhpZGU7XHJcbiAgICAgICAgICAgIH1dXHJcbiAgICAgICAgfSk7ICAgICAgICBcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLmNyZWF0ZU5ld0NhbnZhcyA9IGZ1bmN0aW9uKHdpZHRoLCBoZWlnaHQpIHtcclxuICAgICAgICBjYW52YXMub3Blbk5ldyh3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICAkc2NvcGUuY2xvc2VVcGxvYWREaWFsb2coKTtcclxuICAgICAgICAkcm9vdFNjb3BlLnN0YXJ0ZWQgPSB0cnVlO1xyXG4gICAgICAgICRyb290U2NvcGUucmVzZXRVSSgpOyBcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLm9wZW5TYW1wbGVJbWFnZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNhbnZhcy5sb2FkTWFpbkltYWdlKCdhc3NldHMvaW1hZ2VzL2xvdHVzLmpwZycpO1xyXG4gICAgICAgICRzY29wZS5jbG9zZVVwbG9hZERpYWxvZygpO1xyXG4gICAgICAgICRyb290U2NvcGUuc3RhcnRlZCA9IHRydWU7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5zYXZlSW1hZ2UgPSBmdW5jdGlvbigkZXZlbnQpIHtcclxuICAgICAgICBzYXZlci5zYXZlSW1hZ2UoJHNjb3BlLmltYWdlVHlwZSwgJHNjb3BlLmltYWdlUXVhbGl0eSwgJHNjb3BlLmltYWdlTmFtZSwgJGV2ZW50LCBmYWxzZSk7XHJcbiAgICAgICAgLy8kc2NvcGUuc2F2ZVRvU2VydmVyKCRzY29wZS5pbWFnZU5hbWUsIGZhbHNlKTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLnNhdmVJbWFnZUNsb3NlID0gZnVuY3Rpb24oJGV2ZW50KSB7XHJcbiAgICAgICAgc2F2ZXIuc2F2ZUltYWdlKCRzY29wZS5pbWFnZVR5cGUsICRzY29wZS5pbWFnZVF1YWxpdHksICRzY29wZS5pbWFnZU5hbWUsICRldmVudCwgdHJ1ZSk7XHJcbiAgICAgICAgLy8gJHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy8gICAgIHRvcC50Yl9yZW1vdmUoKTtcclxuICAgICAgICAvLyB9LCAxMDAwKTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLnNhdmVUb1NlcnZlciA9IGZ1bmN0aW9uKG5hbWUsIGNsb3NlKXtcclxuICAgICAgICBjYW52YXMuZmFicmljLmRlYWN0aXZhdGVBbGwoKTtcclxuICAgICAgICAvL2Nyb3BwZXIuc3RvcCgpO1xyXG5cclxuICAgICAgICBjYW52YXMuem9vbSgxNTAvY2FudmFzLm9yaWdpbmFsLmhlaWdodCk7XHJcbiAgICAgICAgdmFyIGRhdGFfanBlZyA9IHNhdmVyLmdldERhdGFVcmwoJ2pwZWcnLCA4KTtcclxuXHJcbiAgICAgICAgY2FudmFzLnpvb20oMSk7ICAgICAgICAgICAgXHJcbiAgICAgICAgdmFyIGRhdGFfcG5nID0gc2F2ZXIuZ2V0RGF0YVVybCgncG5nJywgOCksXHJcbiAgICAgICAgICAgIGRhdGFfanNvbiA9IHNhdmVyLmdldERhdGFVcmwoJ2pzb24nLCA4KTtcclxuICAgICAgICBjYW52YXMuZml0VG9TY3JlZW4oKTsgIFxyXG4gICAgICAgICRyb290U2NvcGUuaXNMb2FkaW5nKCk7XHJcbiAgICAgICAgalF1ZXJ5LmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6IFwiL3dwLWFkbWluL2FkbWluLWFqYXgucGhwXCIsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGFjdGlvbjogJ3dpbmVzaG9wX2xhYmVsX3NhdmUnLFxyXG4gICAgICAgICAgICAgICAgb3JkZXJfaWQ6ICRyb290U2NvcGUub3JkZXJfaWQsXHJcbiAgICAgICAgICAgICAgICBwcm9kdWN0X2lkOiAkcm9vdFNjb3BlLnByb2R1Y3RfaWQsXHJcbiAgICAgICAgICAgICAgICBqcGVnIDogZGF0YV9qcGVnLFxyXG4gICAgICAgICAgICAgICAgcG5nIDogZGF0YV9wbmcsXHJcbiAgICAgICAgICAgICAgICBqc29uIDogZGF0YV9qc29uXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGFzeW5jOiBmYWxzZSxcclxuICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxyXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpe1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJHJvb3RTY29wZS5sb2FkaW5nKTtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuaXNOb3RMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgICAgICBpZihjbG9zZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRvcC50Yl9yZW1vdmUgPT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wLnRiX3JlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXZlbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjbG9zZUV2ZW50TmFtZSA9IFwicGVyc29uYWxpemVkLXdpbmUtZGVzaWduZXItbW9kYWwtY2xvc2VcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LmNyZWF0ZUV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KFwiSFRNTEV2ZW50c1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LmluaXRFdmVudChjbG9zZUV2ZW50TmFtZSwgdHJ1ZSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50T2JqZWN0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5ldmVudFR5cGUgPSBjbG9zZUV2ZW50TmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQuZXZlbnROYW1lID0gY2xvc2VFdmVudE5hbWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuY3JlYXRlRXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnBhcmVudC5kb2N1bWVudC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmZpcmVFdmVudChcIm9uXCIgKyBldmVudC5ldmVudFR5cGUsIGV2ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5wYXJlbnQuZG9jdW1lbnQuZmlyZUV2ZW50KFwib25cIiArIGV2ZW50LmV2ZW50VHlwZSwgZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0sIDEwMDApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAkc2NvcGUuc2hvd0ltYWdlUHJldmlldyA9IGZ1bmN0aW9uKHVybCkge1xyXG4gICAgICAgIHZhciBoaXN0b3J5T2JqZWN0ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGhpc3RvcnlPYmplY3QgPSBKU09OLnBhcnNlKHVybCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAvL1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGhpc3RvcnlPYmplY3QgJiYgaGlzdG9yeU9iamVjdC5zdGF0ZSkge1xyXG4gICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNhbk9wZW5JbWFnZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuY2xlYXIoKTtcclxuICAgICAgICAgICAgaGlzdG9yeS5sb2FkKGhpc3RvcnlPYmplY3QpO1xyXG4gICAgICAgICAgICAkc2NvcGUuY2xvc2VVcGxvYWREaWFsb2coKTtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5zdGFydGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZmFicmljLnV0aWwubG9hZEltYWdlKHVybCwgZnVuY3Rpb24oaW1hZ2UpIHtcclxuICAgICAgICAgICAgaWYgKGltYWdlKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy5pbWctcHJldmlldycpLmh0bWwoJycpLmFwcGVuZChpbWFnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhbk9wZW5JbWFnZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhbk9wZW5JbWFnZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLm9wZW5JbWFnZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciB1cmwgPSAkKCcuaW1nLXByZXZpZXcgaW1nJykuYXR0cignc3JjJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIGlmICggISB1cmwgfHwgISAkc2NvcGUuY2FuT3BlbkltYWdlKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmICgoIWNhbnZhcy5mYWJyaWMuX29iamVjdHMubGVuZ3RoIHx8ICEgY2FudmFzLm1haW5JbWFnZSkgJiYgISAkcm9vdFNjb3BlLnVzZXJQcmVzZXQpIHtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5jbGVhcigpO1xyXG4gICAgICAgICAgICBjYW52YXMubG9hZE1haW5JbWFnZSh1cmwpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNhbnZhcy5vcGVuSW1hZ2UodXJsKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS5jbG9zZVVwbG9hZERpYWxvZygpO1xyXG4gICAgICAgICRyb290U2NvcGUuc3RhcnRlZCA9IHRydWU7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5jbG9zZVVwbG9hZERpYWxvZyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICRzY29wZS5jYW5VcGxvYWRJbWFnZSA9IGZhbHNlO1xyXG4gICAgICAgICRzY29wZS5vcGVuSW1hZ2VNb2RlID0gJ29wZW4nO1xyXG4gICAgICAgICQoJy5pbWctcHJldmlldycpLmh0bWwoKTtcclxuICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xyXG4gICAgfTtcclxufV0pO1xyXG5cclxuXHJcblxyXG4iLCIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXIubW9kdWxlKCdpbWFnZS5kaXJlY3RpdmVzJywgW10pXG5cbi5kaXJlY3RpdmUoJ2VkVGFicycsIFsnJHJvb3RTY29wZScsIGZ1bmN0aW9uICgkcm9vdFNjb3BlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbGluazogZnVuY3Rpb24gKCRzY29wZSwgZWwsIGF0dHJzKSB7XG4gICAgICAgICAgICB2YXIgYmxvY2tDbGlja3MgPSBmYWxzZTtcblxuICAgICAgICAgICAgJCgnIycrYXR0cnMuZWRUYWJzKS5hZGRDbGFzcygnb3BlbicpO1xuICAgICAgICAgICAgJCgnW2RhdGEtYWN0aXZhdGVzPVwiJythdHRycy5lZFRhYnMrJ1wiXScpLmFkZENsYXNzKCdhY3RpdmUnKTtcblxuICAgICAgICAgICAgZWwuZmluZCgnI25hdmlnYXRpb24tYmFyJykub24oJ2NsaWNrJywgJy5uYXYtaXRlbScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGJsb2NrQ2xpY2tzID09PSB0cnVlKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBibG9ja0NsaWNrcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuYWN0aXZlVGFiID0gZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuYWN0aXZhdGVzO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRyb290U2NvcGUuJHdhdGNoKCdhY3RpdmVUYWInLCBmdW5jdGlvbihuZXdUYWIsIG9sZFRhYikge1xuICAgICAgICAgICAgICAgIGlmIChuZXdUYWIgJiYgbmV3VGFiICE9PSBvbGRUYWIpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9sZFRhYk5vZGUgPSBvbGRUYWIgPyBlbC5maW5kKCcjJytvbGRUYWIpIDogZWwuZmluZCgnLnRhYi5vcGVuJyk7XG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZVRhYihuZXdUYWIsIG9sZFRhYk5vZGUsIGVsLmZpbmQoJyMnK25ld1RhYiksICQoJ1tkYXRhLWFjdGl2YXRlcz1cIicrbmV3VGFiKydcIl0nKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHZhciBjaGFuZ2VUYWIgPSBmdW5jdGlvbihuYW1lLCBvbGRUYWIsIG5ld1RhYiwgdGFiQnV0dG9uKSB7XG4gICAgICAgICAgICAgICAgdmFyIGluQW5pbWF0aW9uICA9ICdmYWRlSW5MZWZ0JyxcbiAgICAgICAgICAgICAgICAgICAgb3V0QW5pbWF0aW9uID0gJ2ZhZGVPdXRSaWdodCc7XG5cbiAgICAgICAgICAgICAgICBpZiAodGFiQnV0dG9uLmhhc0NsYXNzKCdhY3RpdmUnKSkgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgLy90YWIgbmF2aWdhdGlvblxuICAgICAgICAgICAgICAgICQoJy5uYXYtaXRlbS5hY3RpdmUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgdGFiQnV0dG9uLmFkZENsYXNzKCdhY3RpdmUnKTtcblxuICAgICAgICAgICAgICAgIC8vdGFic1xuICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChuZXdUYWIuZGF0YSgnaW5kZXgnKSkgPCBwYXJzZUludChvbGRUYWIuZGF0YSgnaW5kZXgnKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0QW5pbWF0aW9uID0gJ2ZhZGVPdXRMZWZ0JztcbiAgICAgICAgICAgICAgICAgICAgaW5BbmltYXRpb24gID0gJ2ZhZGVJblJpZ2h0JztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBvbGRUYWIuYWRkQ2xhc3MoJ2FuaW1hdGVkICcrb3V0QW5pbWF0aW9uKS5vbmUoJHJvb3RTY29wZS5hbmltYXRpb25FbmRFdmVudCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdUYWJbMF0uaWQgPT09ICRzY29wZS5hY3RpdmVUYWIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ29wZW4gJytvdXRBbmltYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgbmV3VGFiLmFkZENsYXNzKCdvcGVuIGFuaW1hdGVkICcraW5BbmltYXRpb24pLm9uZSgkcm9vdFNjb3BlLmFuaW1hdGlvbkVuZEV2ZW50LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcyhpbkFuaW1hdGlvbik7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRlbWl0KCd0YWIuY2hhbmdlZCcsIG5hbWUsIG9sZFRhYlswXS5pZCk7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVQYW5lbCA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3VGFiLnJlbW92ZUNsYXNzKCdmYWRlT3V0UmlnaHQgZmFkZU91dExlZnQnKTtcbiAgICAgICAgICAgICAgICAgICAgYmxvY2tDbGlja3MgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9LCAyNzApXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufV0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2ltYWdlLmRpcmVjdGl2ZXMnKVxuXG4uZGlyZWN0aXZlKCdlZFByZXR0eVNjcm9sbGJhcicsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgIGNvbXBpbGU6IGZ1bmN0aW9uKGVsLCBhdHRycykge1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBlbC5tQ3VzdG9tU2Nyb2xsYmFyKHtcbiAgICAgICAgICAgICAgICAgICAgdGhlbWU6IGF0dHJzLmVkU2Nyb2xsVGhlbWUgfHwgJ2luc2V0JyxcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsSW5lcnRpYTogMzAwLFxuICAgICAgICAgICAgICAgICAgICBhdXRvRXhwYW5kU2Nyb2xsYmFyOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgYXhpczogYXR0cnMuZWRTY3JvbGxBeGlzIHx8ICd4JyxcbiAgICAgICAgICAgICAgICAgICAgYWR2YW5jZWQ6IHsgYXV0b0V4cGFuZEhvcml6b250YWxTY3JvbGw6dHJ1ZSB9LFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSwgMSlcbiAgICAgICAgfVxuICAgXHR9XG59KVxuXG4vL2ZpeCBzb21lIGJ1ZyBiZXR3ZWVuIGN1c3RvbSBzY3JvbGxiYXIgYW5kIG1hdGVyaWFsIHNsaWRlclxuLmRpcmVjdGl2ZSgnZWRJZVNsaWRlckZpeCcsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgIHRlbXBsYXRlOiAnPGRpdiBjbGFzcz1cInNsaWRlci1maXgtb3V0dGVyXCIgc3R5bGU9XCJoZWlnaHQ6IDJweDsgcG9zaXRpb246IGFic29sdXRlXCI+PGRpdiBjbGFzcz1cInNsaWRlci1maXgtaW5uZXJcIiBzdHlsZT1cImhlaWdodDogMXB4OyBvdmVyZmxvdzogYXV0bztcIj5JRSBGSVg8L2Rpdj48L2Rpdj4nLFxuICAgICAgICBjb21waWxlOiBmdW5jdGlvbihlbCkge1xuICAgICAgICAgICAgZWwuZmluZCgnLnNsaWRlci1maXgtaW5uZXInKS5tQ3VzdG9tU2Nyb2xsYmFyKCk7XG4gICAgICAgIH1cbiAgICB9XG59KTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnaW1hZ2UuZGlyZWN0aXZlcycpXHJcblxyXG4uZGlyZWN0aXZlKCdlZENvbG9yUGlja2VyJywgWyckcm9vdFNjb3BlJywgJyRwYXJzZScsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkcGFyc2UpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbGluazogZnVuY3Rpb24gKCRzY29wZSwgZWwsIGF0dHJzKSB7XHJcbiAgICAgICAgICAgIHZhciBmbGF0ID0gJ2VkRmxhdCcgaW4gYXR0cnM7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuJHdhdGNoKGF0dHJzLm5nRGlzYWJsZWQsIGZ1bmN0aW9uKG5ld1ZhbCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5ld1ZhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsLnNwZWN0cnVtKCdkaXNhYmxlJyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsLnNwZWN0cnVtKCdlbmFibGUnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgcGFyYW1zID0ge1xyXG4gICAgICAgICAgICAgICAgY29sb3I6IGF0dHJzLnN0YXJ0Q29sb3IsXHJcbiAgICAgICAgICAgICAgICBjbGlja291dEZpcmVzQ2hhbmdlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgc2hvd1BhbGV0dGU6ICFmbGF0LFxyXG4gICAgICAgICAgICAgICAgcGFsZXR0ZTogY29sb3JzRm9yUGlja2VyLFxyXG4gICAgICAgICAgICAgICAgcHJlZmVycmVkRm9ybWF0OiAnaGV4JyxcclxuICAgICAgICAgICAgICAgIHNob3dBbHBoYTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHNob3dJbnB1dDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGZsYXQ6IGZsYXQsXHJcbiAgICAgICAgICAgICAgICBzaG93QnV0dG9uczogIWZsYXRcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2V0dGVyID0gZnVuY3Rpb24oc2VsZWN0ZWRDb2xvcikge1xyXG4gICAgICAgICAgICAgICAgJHBhcnNlKGF0dHJzLmVkQ29sb3JQaWNrZXIpKCRzY29wZSwge2NvbG9yOiBzZWxlY3RlZENvbG9yLnRvU3RyaW5nKCl9KTtcclxuICAgICAgICAgICAgICAgIGVsLnZhbChzZWxlY3RlZENvbG9yLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKGF0dHJzLmVkRGlzY3JldGUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgZWwub24oJ2RyYWdzdG9wLnNwZWN0cnVtJywgZnVuY3Rpb24oZSwgc2VsZWN0ZWRDb2xvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldHRlcihzZWxlY3RlZENvbG9yKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHBhcmFtcy5jaGFuZ2UgPSBmdW5jdGlvbihzZWxlY3RlZENvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0dGVyKHNlbGVjdGVkQ29sb3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zLm1vdmUgPSBmdW5jdGlvbihzZWxlY3RlZENvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0dGVyKHNlbGVjdGVkQ29sb3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBlbC5zcGVjdHJ1bShwYXJhbXMpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1dKTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2ltYWdlLmRpcmVjdGl2ZXMnKVxuXG4uZGlyZWN0aXZlKCdlZEZpbGVVcGxvYWRlcicsIFsnJHBhcnNlJywgJyRtZERpYWxvZycsICckbWRCb3R0b21TaGVldCcsIGZ1bmN0aW9uKCRwYXJzZSwgJG1kRGlhbG9nLCAkbWRCb3R0b21TaGVldCkge1xuICAgIHZhciB2YWxpZFR5cGVzID0gWydwbmcnLCAnanBnJywgJ2pwZWcnLCAnZ2lmJ107XG5cbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICBsaW5rOiBmdW5jdGlvbigkc2NvcGUsIGVsLCBhdHRycykge1xuICAgICAgICAgICAgdmFyIHNldHRlciA9ICRwYXJzZShhdHRycy5lZEZpbGVVcGxvYWRlcikoJHNjb3BlKTtcblxuICAgICAgICAgICAgJChlbFswXSkub24oJ2NoYW5nZScsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcblxuICAgICAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWltZSA9IGV2ZW50LnRhcmdldC5yZXN1bHQuc3BsaXQoXCIsXCIpWzBdLnNwbGl0KFwiOlwiKVsxXS5zcGxpdChcIjtcIilbMF0uc3BsaXQoJy8nKVsxXTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsaWRUeXBlcy5pbmRleE9mKG1pbWUpIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChzZXR0ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldHRlcihldmVudC50YXJnZXQucmVzdWx0KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBhdHRycy5lZENsb3NlQWZ0ZXIgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWRCb3R0b21TaGVldC5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgaWYgKGUudGFyZ2V0LmZpbGVzWzBdLm5hbWUubWF0Y2goJy5qc29uJykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc1RleHQoZS50YXJnZXQuZmlsZXNbMF0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGUudGFyZ2V0LmZpbGVzWzBdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgXHR9XG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ2ltYWdlLmRpcmVjdGl2ZXMnKVxuXG4uZGlyZWN0aXZlKCdlZFRvZ2dsZVBhbmVsVmlzaWJpbGl0eScsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgIGNvbXBpbGU6IGZ1bmN0aW9uKGVsLCBhdHRycykge1xuICAgICAgICAgICAgZWwub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgZWwuZmluZCgnLmljb24nKS50b2dnbGVDbGFzcygndG9nZ2xlZCcpO1xuXG4gICAgICAgICAgICAgICAgJCgnIycrYXR0cnMuZWRUb2dnbGVQYW5lbFZpc2liaWxpdHkpLmZpbmQoJ3VsJykubUN1c3RvbVNjcm9sbGJhcignZGlzYWJsZScpLnNsaWRlVG9nZ2xlKDE1MCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICQodGhpcykubUN1c3RvbVNjcm9sbGJhcigndXBkYXRlJyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgXHR9XG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnaW1hZ2UuZGlyZWN0aXZlcycpXG5cbi5kaXJlY3RpdmUoJ2VkVG9nZ2xlU2lkZWJhcicsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgIGNvbXBpbGU6IGZ1bmN0aW9uKGVsLCBhdHRycykge1xuICAgICAgICAgICAgdmFyIHNpZGViYXIgPSAkKCcjbGVmdC1zaWRlYmFyJyk7XG5cbiAgICAgICAgICAgIGVsLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHNpZGViYXIudG9nZ2xlQ2xhc3MoJ29wZW4nKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICBcdH1cbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS50ZXh0JywgW10pXHJcblxyXG4gICAgLnNlcnZpY2UoJ3RleHQnLCBbJyRyb290U2NvcGUnLCAnY2FudmFzJywgZnVuY3Rpb24gKCRyb290U2NvcGUsIGNhbnZhcykge1xyXG5cclxuICAgICAgICB2YXIgdGV4dCA9IHtcclxuXHJcbiAgICAgICAgICAgIHJlbW92ZVRleHRGcm9tQ2FudmFzOiBmdW5jdGlvbih0ZXh0T2JqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgIGlmICggISB0ZXh0T2JqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICB0ZXh0T2JqZWN0ID0gY2FudmFzLmZhYnJpYy5nZXRBY3RpdmVPYmplY3QoKTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgLy9iYWlsIGlmIHdlIGRvbid0IGhhdmUgYSB0ZXh0IG9iamVjdFxyXG4gICAgICAgICAgICAgICAgICBpZiAoICEgdGV4dE9iamVjdC5zZXRGb250U2l6ZSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5yZW1vdmUodGV4dE9iamVjdCk7XHJcbiAgICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICBnZXRUZXh0T2JqZWN0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhY3RpdmUgPSBjYW52YXMuZmFicmljLmdldEFjdGl2ZU9iamVjdCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChhY3RpdmUgJiYgYWN0aXZlLmZvbnRGYW1pbHkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aXZlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vaWYgdGhlcmUgaXMgbm8gYWN0aXZlIG9iamVjdCBvciBhY3RpdmUgb2JqZWN0XHJcbiAgICAgICAgICAgICAgICAvL2lzIG5vdCB0ZXh0LCByZXR1cm4gZmlyc3QgdGV4dCBvYmplY3QgYXZhaWxhYmxlXHJcbiAgICAgICAgICAgICAgICBpZiAoICEgYWN0aXZlIHx8ICEgYWN0aXZlLmZvbnRGYW1pbHkpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgb2JqZWN0cyA9IGNhbnZhcy5mYWJyaWMuZ2V0T2JqZWN0cygpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9iamVjdHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9iamVjdHNbaV0uZm9udEZhbWlseSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iamVjdHNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICB0b2dnbGVUZXh0RGVjb3JhdGlvbjogZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gdGhpcy5nZXRUZXh0T2JqZWN0KCksXHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IHRleHQudGV4dERlY29yYXRpb24udHJpbSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vZm9udCBzdHlsZVxyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlID09ICdpdGFsaWMnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRleHQuZm9udFN0eWxlLmluZGV4T2YoJ2l0YWxpYycpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dC5zZXRGb250U3R5bGUoJ25vcm1hbCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQuc2V0Rm9udFN0eWxlKCdpdGFsaWMnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy90ZXh0IGRlY29yYXRpb25cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50LmluZGV4T2YodmFsdWUpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQucmVwbGFjZSh2YWx1ZSwgJycpLnRyaW0oKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50ICs9ICcgJyt2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ZXh0LnNldFRleHREZWNvcmF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQuc2V0VGV4dERlY29yYXRpb24oY3VycmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGRlY29yYXRpb25zID0gdGV4dC5mb250U3R5bGUrJyAnK3RleHQudGV4dERlY29yYXRpb24udHJpbSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBkZWNvcmF0aW9ucy5zcGxpdCgnICcpO1xyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgc2V0UHJvcGVydHk6IGZ1bmN0aW9uKHByb3BlcnR5LCB2YWx1ZSwgZW5hYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRleHQgICA9IHRoaXMuZ2V0VGV4dE9iamVjdCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIHNldHRlciA9IHRoaXMubWFrZVNldHRlck5hbWUocHJvcGVydHkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgaWYgKHRleHRbc2V0dGVyXSAmJiBlbmFibGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICB0ZXh0W3NldHRlcl0odmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogVG9nZ2xlIGdpdmVuIHByb3BlcnR5IG9uL29mZiBvbiB0ZXh0IG9iamVjdC5cclxuICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9ICBwcm9wZXJ0eVxyXG4gICAgICAgICAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGVuYWJsZWRcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHRvZ2dsZVByb3BlcnR5OiBmdW5jdGlvbihwcm9wZXJ0eSwgZW5hYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRleHQgICA9IHRoaXMuZ2V0VGV4dE9iamVjdCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIHNldHRlciA9IHRoaXMubWFrZVNldHRlck5hbWUocHJvcGVydHkpO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKHRleHRbc2V0dGVyXSkge1xyXG4gICAgICAgICAgICAgICAgICBpZighZW5hYmxlZCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dFtzZXR0ZXJdKGVuYWJsZWQpO1xyXG4gICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICBpZihwcm9wZXJ0eT09J2JhY2tncm91bmRDb2xvcicpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgdGV4dFtzZXR0ZXJdKGpRdWVyeShcIiN0eHRCZ0NvbG9yXCIpLnZhbCgpKTtcclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZSBpZihwcm9wZXJ0eT09J3N0cm9rZScpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgdGV4dFtzZXR0ZXJdKGpRdWVyeShcIiN0eHRPdXRsaW5lQ29sb3JcIikudmFsKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogQ29tcGlsZSBhIGZhYnJpYyBzZXR0ZXIgZnVuY3Rpb24gbmFtZSBmcm9tIGdpdmUgcHJvcGVydHkuXHJcbiAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAqIEBwYXJhbSBuYW1lIChiYWNrZ3JvdW5kQ29sb3IpXHJcbiAgICAgICAgICAgICAqIEByZXR1cm5zIHN0cmluZyAoc2V0QmFja2dyb3VuZENvbG9yKVxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgbWFrZVNldHRlck5hbWU6IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuICdzZXQnK25hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkrbmFtZS5zbGljZSgxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB0ZXh0O1xyXG5cclxuICAgIH1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnaW1hZ2UudGV4dCcpXHJcblxyXG4uY29udHJvbGxlcignVGV4dENvbnRyb2xsZXInLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJyR0aW1lb3V0JywgJ2NhbnZhcycsICd0ZXh0JywgJ2ZvbnRzJywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCAkdGltZW91dCwgY2FudmFzLCB0ZXh0LCBmb250cykge1xyXG5cdCRzY29wZS50ZXh0ICA9IHRleHQ7XHJcblx0JHNjb3BlLmZvbnRzID0gZm9udHM7XHJcblxyXG5cdCRzY29wZS5hY3RpdmVGb250ID0gJyc7XHJcblx0JHNjb3BlLm9wYWNpdHkgPSAxO1xyXG5cdCRzY29wZS5mb250U2l6ZSA9IDI1O1xyXG5cdCRzY29wZS50eHRDb2xvciA9ICcjMDAwMDAwJztcclxuXHQkc2NvcGUuZW5hYmxlQmFja2dyb3VuZCA9IHRydWU7XHJcblx0JHNjb3BlLnR4dEJnQ29sb3IgPSAncmdiYSgwLDAsMCwwKSc7XHJcblx0JHNjb3BlLmVuYWJsZU91dGxpbmUgPSB0cnVlO1xyXG5cdCRzY29wZS50eHRPdXRsaW5lQ29sb3IgPSAncmdiYSgwLDAsMCwwKSc7XHJcblx0JHNjb3BlLnR4dEFsaWduID0gJ2xlZnQnO1xyXG5cdCRzY29wZS50eHRVbmRlcmxpbmUgPSAnJztcclxuXHQkc2NvcGUudHh0U3R5bGUgPSAnJztcclxuXHQkc2NvcGUudHh0TGluZUhlaWdodCA9ICcnO1xyXG5cdCRzY29wZS50eHRPdXRsaW5lV2lkdGggPSAnJztcclxuXHQkc2NvcGUuZmlsdGVycyA9IHtcclxuXHRcdGNhdGVnb3J5OiAnaGFuZHdyaXRpbmcnLFxyXG5cdFx0ZmFtaWx5OiAnJ1xyXG5cdH07XHJcblxyXG5cdGZvbnRzLmdldEFsbCgkc2NvcGUuZmlsdGVycyk7XHJcbiAgICAkc2NvcGUuaXNQYW5lbEVuYWJsZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgb2JqID0gY2FudmFzLmZhYnJpYy5nZXRBY3RpdmVPYmplY3QoKTtcclxuICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZU9iamVjdCA9IG9iajtcclxuICAgICAgICBpZihvYmogJiYgb2JqLm5hbWUgPT09ICd0ZXh0JykgJHNjb3BlLnNldFR4dFZhbHVlKG9iaik7XHJcbiAgICAgICAgcmV0dXJuIG9iaiAmJiBvYmoubmFtZSA9PT0gJ3RleHQnICYmICRyb290U2NvcGUuYWN0aXZlVGFiID09PSAndGV4dCc7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5zZXRUeHRWYWx1ZSA9IGZ1bmN0aW9uKG9iail7XHJcbiAgICBcdGNvbnNvbGUubG9nKG9iaik7XHJcbiAgICBcdCRzY29wZS5hY3RpdmVGb250ID0gb2JqLmZvbnRGYW1pbHk7XHJcblx0ICAgXHQkc2NvcGUub3BhY2l0eSA9IG9iai5vcGFjaXR5O1xyXG5cdFx0JHNjb3BlLmZvbnRTaXplID0gb2JqLmZvbnRTaXplO1xyXG5cdFx0JHNjb3BlLnR4dENvbG9yID0gb2JqLmZpbGw7XHJcblx0XHRpZihvYmouYmFja2dyb3VuZENvbG9yKSB7XHJcblx0XHRcdCRzY29wZS5lbmFibGVCYWNrZ3JvdW5kID0gdHJ1ZTtcclxuXHRcdFx0JHNjb3BlLnR4dEJnQ29sb3IgPSBvYmouYmFja2dyb3VuZENvbG9yO1xyXG5cdFx0fWVsc2V7XHJcblx0XHRcdCRzY29wZS5lbmFibGVCYWNrZ3JvdW5kID0gZmFsc2U7XHJcblx0XHR9XHJcblx0XHRpZihvYmouc3Ryb2tlKSB7XHJcblx0XHRcdCRzY29wZS5lbmFibGVPdXRsaW5lID0gdHJ1ZTtcclxuXHRcdFx0JHNjb3BlLnR4dE91dGxpbmVDb2xvciA9IG9iai5zdHJva2U7IFx0XHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0JHNjb3BlLmVuYWJsZU91dGxpbmUgPSBmYWxzZTtcclxuXHRcdH1cclxuXHRcdCRzY29wZS50eHRBbGlnbiA9IG9iai50ZXh0QWxpZ247XHJcblx0XHRjb25zb2xlLmxvZygkc2NvcGUudHh0QWxpZ24pO1xyXG5cdFx0JHNjb3BlLnR4dFVuZGVybGluZSA9IG9iai50ZXh0RGVjb3JhdGlvbjtcclxuXHRcdCRzY29wZS50eHRTdHlsZSA9IG9iai5mb250U3R5bGU7XHJcblx0XHQkc2NvcGUudHh0TGluZUhlaWdodCA9IG9iai5saW5lSGlnaHQ7XHJcblx0XHQkc2NvcGUudHh0T3V0bGluZVdpZHRoID0gb2JqLnN0cm9rZVdpZHRoO1xyXG5cdFx0alF1ZXJ5KFwiI3R4dENvbG9yXCIpLnNwZWN0cnVtKFwic2V0XCIsIG9iai5maWxsKTtcclxuXHRcdGlmKCRzY29wZS5lbmFibGVCYWNrZ3JvdW5kKSBqUXVlcnkoXCIjdHh0QmdDb2xvclwiKS5zcGVjdHJ1bShcInNldFwiLCAkc2NvcGUudHh0QmdDb2xvcik7XHJcblx0XHRpZigkc2NvcGUuZW5hYmxlT3V0bGluZSkgalF1ZXJ5KFwiI3R4dE91dGxpbmVDb2xvclwiKS5zcGVjdHJ1bShcInNldFwiLCAkc2NvcGUudHh0T3V0bGluZUNvbG9yKTtcclxuICAgIH07XHJcblxyXG5cdCRzY29wZS5jaGFuZ2VGb250ID0gZnVuY3Rpb24oZm9udCwgZSkge1xyXG4gICAgICAgIHZhciBhY3RpdmUgPSBjYW52YXMuZmFicmljLmdldEFjdGl2ZU9iamVjdCgpO1xyXG5cdFx0JHJvb3RTY29wZS5vcGVuUGFuZWwoJ3RleHQnLCBlKTtcclxuXHJcblx0XHRpZiAoICEgYWN0aXZlIHx8IGFjdGl2ZS5uYW1lICE9PSAndGV4dCcpIHtcclxuXHRcdFx0dmFyIG5ld1RleHQgPSBuZXcgZmFicmljLklUZXh0KCdEb3VibGUgY2xpY2sgbWUgdG8gZWRpdCBteSBjb250ZW50cy4nLCB7XHJcblx0XHRcdFx0Zm9udEZhbWlseTogZm9udCxcclxuXHRcdFx0XHRmb250V2VpZ2h0OiA0MDAsXHJcblx0XHRcdFx0Zm9udFNpemU6ICRzY29wZS5mb250U2l6ZSxcclxuXHRcdFx0XHRmaWxsOiAkc2NvcGUudHh0Q29sb3IsXHJcblx0XHRcdFx0cmVtb3ZlT25DYW5jZWw6IHRydWUsXHJcblx0XHRcdFx0bmFtZTogJ3RleHQnXHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Y2FudmFzLmZhYnJpYy5hZGQobmV3VGV4dCk7XHJcbiAgICAgICAgICAgIG5ld1RleHQuc2V0VG9wKDI1KTtcclxuICAgICAgICAgICAgbmV3VGV4dC5zZXRMZWZ0KDI1KTtcclxuXHRcdFx0Y2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3QobmV3VGV4dCk7XHJcblx0XHRcdGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcblx0XHR9XHJcblxyXG4gICAgICAgIHRleHQuc2V0UHJvcGVydHkoJ2ZvbnRGYW1pbHknLCBmb250LCB0cnVlKTtcclxuXHRcdCRzY29wZS5zZXRUeHRWYWx1ZShhY3RpdmUpO1xyXG5cdFx0JHNjb3BlLmFjdGl2ZUZvbnQgPSBmb250O1xyXG5cdH07XHJcblxyXG5cdCRzY29wZS5jYW5jZWxBZGRpbmdUZXh0VG9DYW52YXMgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciB0ZXh0T2JqZWN0ID0gdGV4dC5nZXRUZXh0T2JqZWN0KCk7XHJcblxyXG5cdFx0aWYgKHRleHRPYmplY3QucmVtb3ZlT25DYW5jZWwpIHtcclxuXHRcdFx0dGV4dC5yZW1vdmVUZXh0RnJvbUNhbnZhcyh0ZXh0T2JqZWN0KTtcclxuXHRcdH1cclxuXHJcblx0XHQkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XHJcblx0fTtcclxuXHJcblx0JHNjb3BlLmZpbmlzaEFkZGluZ1RleHRUb0NhbnZhcyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIHRleHRPYmplY3QgPSB0ZXh0LmdldFRleHRPYmplY3QoKTtcclxuXHJcblx0XHQkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XHJcblx0XHQkcm9vdFNjb3BlLiRlbWl0KCd0ZXh0LmFkZGVkJywgdGV4dE9iamVjdCk7XHJcblx0XHRjYW52YXMuZmFicmljLnNldEFjdGl2ZU9iamVjdChjYW52YXMubWFpbkltYWdlKTtcclxuXHRcdGZvbnRzLmNyZWF0ZUxpbmtUb0ZvbnQodGV4dE9iamVjdC5mb250RmFtaWx5KTtcclxuXHRcdCRyb290U2NvcGUuYWN0aXZlT2JqZWN0ID0gY2FudmFzLm1haW5JbWFnZTtcclxuXHR9O1xyXG5cclxuXHQkcm9vdFNjb3BlLiRvbigndGFiLmNoYW5nZWQnLCBmdW5jdGlvbihlLCBuYW1lKSB7XHJcblx0XHRpZiAobmFtZSA9PSAndGV4dCcpIHtcclxuXHRcdFx0dmFyIHRleHRPYmplY3QgPSAkc2NvcGUudGV4dC5nZXRUZXh0T2JqZWN0KCk7XHJcblxyXG5cdFx0XHQvL2lmIHdlIGNhbiBmaW5kIGFuIGV4aXN0aW5nIHRleHQgb2JqZWN0IHNldCBpdCBhcyBhY3RpdmVcclxuXHRcdFx0aWYgKHRleHRPYmplY3QpIHtcclxuXHRcdFx0XHR0ZXh0T2JqZWN0LnJlbW92ZU9uQ2FuY2VsID0gZmFsc2U7XHJcblx0XHRcdFx0Y2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3QodGV4dE9iamVjdCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9KTtcclxuXHJcbn1dKTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnaW1hZ2UudGV4dCcpXHJcblxyXG4uZGlyZWN0aXZlKCdlZFRleHRBbGlnbkJ1dHRvbnMnLCBbJ3RleHQnLCBmdW5jdGlvbiAodGV4dCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBjb21waWxlOiBmdW5jdGlvbiAoZWwpIHtcclxuICAgICAgICAgICAgZWwub24oJ2NsaWNrJywgJ2knLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYWxpZ24gPSBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5hbGlnbjtcclxuICAgICAgICAgICAgICAgIHRleHQuc2V0UHJvcGVydHkoJ3RleHRBbGlnbicsIGFsaWduLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIGVsLmZpbmQoJ2knKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICAkKGUuY3VycmVudFRhcmdldCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufV0pXHJcbiIsIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhci5tb2R1bGUoJ2ltYWdlLnRleHQnKVxuXG4uZGlyZWN0aXZlKCdlZFRleHREZWNvcmF0aW9uQnV0dG9ucycsIFsndGV4dCcsIGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29tcGlsZTogZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgICBlbC5vbignY2xpY2snLCAnLnRvb2xiYXItYnRuJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuZGVjb3JhdGlvbjtcblxuICAgICAgICAgICAgICAgIHZhciBkZWNvcmF0aW9ucyA9IHRleHQudG9nZ2xlVGV4dERlY29yYXRpb24obmFtZSk7XG5cbiAgICAgICAgICAgICAgICBlbC5maW5kKCcudG9vbGJhci1idG4nKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRlY29yYXRpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGVsLmZpbmQoJ1tkYXRhLWRlY29yYXRpb249XCInK2RlY29yYXRpb25zW2ldLnRyaW0oKSsnXCJdJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbn1dKVxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ2ltYWdlLnRleHQnKVxyXG5cclxuLmRpcmVjdGl2ZSgnZWRGb250c1BhZ2luYXRpb24nLCBbJyRyb290U2NvcGUnLCAnZm9udHMnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCBmb250cykge1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgICAgICBsaW5rOiBmdW5jdGlvbigkc2NvcGUsIGVsKSB7XHJcblxyXG4gICAgICAgICAgICAvL2luaXRpYXRlIHBhZ2luYXRpb24gcGx1Z2luXHJcbiAgICAgICAgICAgIGVsLnBhZ2luYXRpb24oe1xyXG4gICAgICAgICAgICAgICAgaXRlbXM6IDAsXHJcbiAgICAgICAgICAgICAgICBpdGVtc09uUGFnZTogZm9udHMucGFnaW5hdG9yLnBlclBhZ2UsXHJcbiAgICAgICAgICAgICAgICBvblBhZ2VDbGljazogZnVuY3Rpb24obnVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9udHMucGFnaW5hdG9yLnNlbGVjdFBhZ2UobnVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vcmVkcmF3IHBhZ2luYXRpb24gYmFyIG9uIHRvdGFsIGl0ZW1zIGNoYW5nZVxyXG4gICAgICAgICAgICAkc2NvcGUuJHdhdGNoKCdmb250cy5wYWdpbmF0b3IudG90YWxJdGVtcycsIGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHsgZWwucGFnaW5hdGlvbigndXBkYXRlSXRlbXMnLCB2YWx1ZSkgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1dKVxyXG5cclxuLmZhY3RvcnkoJ2ZvbnRzJywgWyckcm9vdFNjb3BlJywgJyRodHRwJywgJyR0aW1lb3V0JywgJyRmaWx0ZXInLCAnbG9jYWxTdG9yYWdlJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJGh0dHAsICR0aW1lb3V0LCAkZmlsdGVyLCBsb2NhbFN0b3JhZ2UpIHtcclxuXHJcbiAgICB2YXIgZm9udHMgPSB7XHJcblxyXG4gICAgICAgIGxvYWRpbmc6IGZhbHNlLFxyXG5cclxuICAgICAgICBwYWdpbmF0b3I6IHtcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBBbGwgYXZhaWxhYmxlIGZvbnRzLlxyXG4gICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgKiBAdHlwZSBhcnJheVxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgc291cmNlSXRlbXM6IFtcIlNsYWJvIDI3cHhcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiUm9ib3RvXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlNhaXJhXCIgLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJPcGVuIFNhbnNcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiVGltZXMgTmV3IFJvbWFuXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlBsYXlmYWlyIERpc3BsYXlcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTW9ub3R5cGUgQ29yc2l2YVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJQVCBTZXJpZlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJJTSBGZWxsIERvdWJsZSBQaWNhIFNDXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkNvcm1vcmFudCBVbmljYXNlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkNoZXd5XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkxpbWVsaWdodFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJQb2lyZXQgT25lXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlZvbHRhaXJlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIk9zd2FsZFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJTbmlnbGV0XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkNydXNoZWRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXCJCb29rbWFuIE9sZCBTdHlsZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJBcmlhbFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJIZWx2ZXRpY2FcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTG9ic3RlclwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9cIkRpc25leVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJTdGFyIFRyZWtcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXCJHYXJhbW9uZFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJQVCBTYW5zXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkluZGllIEZsb3dlclwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJGamFsbGEgT25lXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlBhY2lmaWNvXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkFtYXRpYyBTQ1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJHcmVhdCBWaWJlc1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJQZXJtYW5lbnQgTWFya2VyXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkJhZCBTY3JpcHRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTW9ub3RvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJDb21pbmcgU29vblwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJKdXN0IEFub3RoZXIgSGFuZFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJEZWxpdXMgU3dhc2ggQ2Fwc1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJSb2NoZXN0ZXJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiRWxzaWUgU3dhc2ggQ2Fwc1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJJbmNvbnNvbGF0YVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJUcm9jY2hpXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkNyZWVwc3RlclwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJCdW5nZWVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQmxhY2sgT3BzIE9uZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBdLFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIEFsbCBhdmFpbGFibGUgZm9udHMgd2l0aCBmaWx0cnMgYXBwbGllZC5cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIGZpbHRlcmVkSXRlbXM6IFtdLFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIEZvbnRzIGN1cnJlbnRseSBiZWluZyBzaG93bi5cclxuICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICogQHR5cGUgYXJyYXlcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIGN1cnJlbnRJdGVtczogW10sXHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogRm9udHMgdG8gc2hvdyBwZXIgcGFnZS5cclxuICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICogQHR5cGUgaW50XHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICBwZXJQYWdlOiAxMCxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBUb3RhbCBudW1iZXIgb2YgZm9udHMuXHJcbiAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAqIEB0eXBlIGludFxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgdG90YWxJdGVtczogMCxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBTbGljZSBpdGVtcyBmb3IgdGhlIGdpdmVuIHBhZ2UuXHJcbiAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAqIEBwYXJhbSAge2ludH0gcGFnZVxyXG4gICAgICAgICAgICAgKiBAcmV0dXJuIHZvaWRcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHNlbGVjdFBhZ2U6IGZ1bmN0aW9uKHBhZ2UpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEl0ZW1zID0gdGhpcy5maWx0ZXJlZEl0ZW1zLnNsaWNlKFxyXG4gICAgICAgICAgICAgICAgICAgIChwYWdlLTEpKnRoaXMucGVyUGFnZSwgKHBhZ2UtMSkqdGhpcy5wZXJQYWdlK3RoaXMucGVyUGFnZVxyXG4gICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvL2ZvbnRzLmxvYWQoKTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIGZpbHRlcjogZnVuY3Rpb24oZmlsdGVycykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydCgkZmlsdGVyKCdmaWx0ZXInKShmb250cy5wYWdpbmF0b3Iuc291cmNlSXRlbXMsIGZpbHRlcnMpKTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBTdGFydCB0aGUgcGFnaW5hdG9yIHdpdGggZ2l2ZW4gaXRlbXMuXHJcbiAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAqIEBwYXJhbSAge2FycmF5fSBpdGVtc1xyXG4gICAgICAgICAgICAgKiBAcmV0dXJuIHZvaWRcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHN0YXJ0OiBmdW5jdGlvbihpdGVtcykge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coaXRlbXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wZXJQYWdlID0gaXRlbXMubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJlZEl0ZW1zICA9IGl0ZW1zO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b3RhbEl0ZW1zICAgPSBpdGVtcy5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRJdGVtcyA9IGl0ZW1zLnNsaWNlKDAsIHRoaXMucGVyUGFnZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgZm9udHMubG9hZChpdGVtcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBGZXRjaCBhbGwgYXZhaWxhYmxlIGZvbnRzIGZyb20gR29vZ2xlRm9udHMgQVBJLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJldHVybiB2b2lkXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0QWxsOiBmdW5jdGlvbihmaWx0ZXJzKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxmICAgPSB0aGlzLFxyXG4gICAgICAgICAgICAgICAgY2FjaGVkID0gbG9jYWxTdG9yYWdlLmdldCgnZ29vZ2xlRm9udHMnKSxcclxuICAgICAgICAgICAgICAgIGtleSAgICA9ICRyb290U2NvcGUua2V5c1snZ29vZ2xlX2ZvbnRzJ107XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGZvbnRzLnBhZ2luYXRvci5jdXJyZW50SXRlbXMpO1xyXG4gICAgICAgICAgICAvLyBpZiAoY2FjaGVkKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBzZWxmLnBhZ2luYXRvci5zb3VyY2VJdGVtcyA9IGNhY2hlZDtcclxuICAgICAgICAgICAgLy8gICAgIHJldHVybiBmaWx0ZXJzID8gc2VsZi5wYWdpbmF0b3IuZmlsdGVyKGZpbHRlcnMpIDogc2VsZi5wYWdpbmF0b3Iuc3RhcnQoY2FjaGVkKTtcclxuICAgICAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICAgICAgLy8gJGh0dHAuZ2V0KCdodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS93ZWJmb250cy92MS93ZWJmb250cz9zb3J0PXBvcHVsYXJpdHkma2V5PScra2V5KVxyXG4gICAgICAgICAgICAvLyAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXQoJ2dvb2dsZUZvbnRzJywgZGF0YS5pdGVtcyk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgc2VsZi5wYWdpbmF0b3Iuc291cmNlSXRlbXMgPSBkYXRhLml0ZW1zO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIGZpbHRlcnMgPyBzZWxmLnBhZ2luYXRvci5maWx0ZXIoZmlsdGVycykgOiBzZWxmLnBhZ2luYXRvci5zdGFydChkYXRhLml0ZW1zKTtcclxuICAgICAgICAgICAgLy8gICAgIH0pO1xyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKHNlbGYucGFnaW5hdG9yLnNvdXJjZUl0ZW1zKTtcclxuICAgICAgICAgICAgLy9sb2NhbFN0b3JhZ2Uuc2V0KCdnb29nbGVGb250cycsIHNlbGYucGFnaW5hdG9yLnNvdXJjZUl0ZW1zKTtcclxuICAgICAgICAgICAgLy9maWx0ZXJzID8gc2VsZi5wYWdpbmF0b3IuZmlsdGVyKGZpbHRlcnMpIDogc2VsZi5wYWdpbmF0b3Iuc3RhcnQoc2VsZi5wYWdpbmF0b3Iuc291cmNlSXRlbXMpO1xyXG4gICAgICAgICAgICBzZWxmLnBhZ2luYXRvci5zdGFydChzZWxmLnBhZ2luYXRvci5zb3VyY2VJdGVtcyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogTG9hZCBnaXZlbiBnb29nbGUgZm9udHMgaW50byB0aGUgRE9NLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtICB7bWl4ZWR9IG5hbWVzXHJcbiAgICAgICAgICogQHJldHVybiB2b2lkXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbG9hZDogZnVuY3Rpb24obmFtZXMpIHtcclxuICAgICAgICAgICAgdmFyIGhlYWQgPSAkKCdoZWFkJyk7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUubG9hZGluZyA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAvL21ha2UgYW4gYXJyYXkgb2YgZm9udCBuYW1lcyBmcm9tIGN1cnJlbnQgZm9udHNcclxuICAgICAgICAgICAgLy9pbiB0aGUgcGFnaW5hdG9yIGlmIG5vbmUgcGFzc2VkXHJcbiAgICAgICAgICAgIGlmICggISBuYW1lcykge1xyXG4gICAgICAgICAgICAgICAgbmFtZXMgPSAkLm1hcChmb250cy5wYWdpbmF0b3IuY3VycmVudEl0ZW1zLCBmdW5jdGlvbihmb250KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZm9udCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9yZXR1cm4gZm9udC5mYW1pbHk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZvbnQ7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvL25vcm1hbGl6ZSBuYW1lcyB0byBhcnJheSBpZiBzdHJpbmcgcGFzc2VkXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoICEgYW5ndWxhci5pc0FycmF5KG5hbWVzKSkge1xyXG4gICAgICAgICAgICAgICAgbmFtZXMgPSBbbmFtZXNdO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvL3JlbW92ZSBwcmV2aW91cyBwYWdlIGZvbnRzXHJcbiAgICAgICAgICAgIC8vJChoZWFkKS5maW5kKCcjZHluYW1pYy1mb250cycpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICBuYW1lcyA9IG5hbWVzLmZpbHRlcih2YWwgPT4gdmFsICE9PSBcIlRpbWVzIE5ldyBSb21hblwiKTtcclxuICAgICAgICAgICAgbmFtZXMgPSBuYW1lcy5maWx0ZXIodmFsID0+IHZhbCAhPT0gXCJIZWx2ZXRpY2FcIik7XHJcbiAgICAgICAgICAgIG5hbWVzID0gbmFtZXMuZmlsdGVyKHZhbCA9PiB2YWwgIT09IFwiTW9ub3R5cGUgQ29yc2l2YVwiKTtcclxuICAgICAgICAgICAgdmFyIHBlclBhZ2UgPSAxNztcclxuICAgICAgICAgICAgLy9sb2FkIHRoZSBnaXZlbiBmb250c1xyXG4gICAgICAgICAgICBmb3IoIHZhciBpPTA7IGkqcGVyUGFnZSA8IG5hbWVzLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgICAgIHZhciBzdWJmb250cyA9IG5hbWVzLnNsaWNlKGkqcGVyUGFnZSwgKGkrMSkqcGVyUGFnZSk7XHJcbiAgICAgICAgICAgICAgICBoZWFkLmFwcGVuZChcclxuICAgICAgICAgICAgICAgICAgICAnPGxpbmsgcmVsPVwic3R5bGVzaGVldFwiIGlkPVwiZHluYW1pYy1mb250cycraSsnXCIgaHJlZj1cImh0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vY3NzP2ZhbWlseT0nK1xyXG4gICAgICAgICAgICAgICAgICAgIHN1YmZvbnRzLmpvaW4oJ3wnKS5yZXBsYWNlKC8gL2csICcrJykrJ1wiPidcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBjcmVhdGVMaW5rVG9Gb250OiBmdW5jdGlvbihmb250KSB7XHJcbiAgICAgICAgICAgIHZhciBuYW1lID0gZm9udC5yZXBsYWNlKC8gL2csICcrJyksXHJcbiAgICAgICAgICAgICAgICBsaW5rID0gJCgnIycrbmFtZSk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKGxpbmtbMF0pIHtcclxuICAgICAgICAgICAgICAgIGxpbmsuYXR0cignaHJlZicsICdodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2Nzcz9mYW1pbHk9JytuYW1lKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICQoJ2hlYWQnKS5hcHBlbmQoJzxsaW5rIHJlbD1cInN0eWxlc2hlZXRcIiBpZD1cIicrbmFtZSsnXCIgaHJlZj1cImh0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vY3NzP2ZhbWlseT0nK25hbWUrJ1wiPicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gZm9udHM7XHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnaW1hZ2UuZHJhd2luZycsIFtdKVxuXG4uc2VydmljZSgnZHJhd2luZycsIFsnJHJvb3RTY29wZScsICdjYW52YXMnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgY2FudmFzKSB7XG5cbiAgICB2YXIgZHJhd2luZyA9IHtcblxuICAgICAgICBhdmFpbGFibGVCcnVzaGVzOiBbJ3BlbmNpbCcsICd2TGluZScsICdkaWFtb25kJywgJ2hMaW5lJywgJ2NpcmNsZScsICdzcXVhcmUnLCAnc3ByYXknXSxcblxuICAgICAgICBkZWZhdWx0QnJ1c2hOYW1lOiAncGVuY2lsJyxcblxuICAgICAgICBhY3RpdmVCcnVzaE5hbWU6IGZhbHNlLFxuXG4gICAgICAgIGlzRW5hYmxlZDogZmFsc2UsXG5cbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICBzaGFkb3dDb2xvcjogJyMxRTg5RTYnLFxuICAgICAgICAgICAgYnJ1c2hXaWR0aDogOSxcbiAgICAgICAgICAgIGJydXNoQ29sb3I6ICcjMDAwJyxcbiAgICAgICAgICAgIHNoYWRvd0JsdXI6IDMwLFxuICAgICAgICAgICAgc2hhZG93T2Zmc2V0WDogMTAsXG4gICAgICAgICAgICBzaGFkb3dPZmZzZXRZOiAxMCxcbiAgICAgICAgICAgIGVuYWJsZVNoYWRvdzogZmFsc2VcbiAgICAgICAgfSxcblxuICAgICAgICBlbmFibGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5pc0RyYXdpbmdNb2RlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlQnJ1c2godGhpcy5kZWZhdWx0QnJ1c2hOYW1lKTtcblxuICAgICAgICAgICAgaWYgKCAhIHRoaXMuc2hhZG93KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zaGFkb3cgPSBuZXcgZmFicmljLlNoYWRvdyh7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiB0aGlzLnBhcmFtcy5zaGFkb3dDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgYmx1cjogdGhpcy5wYXJhbXMuc2hhZG93Qmx1cixcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0WDogdGhpcy5wYXJhbXMuc2hhZG93T2Zmc2V0WCxcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0WTogdGhpcy5wYXJhbXMuc2hhZG93T2Zmc2V0WVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmlzRW5hYmxlZCA9IHRydWU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZGlzYWJsZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjYW52YXMuZmFicmljLmlzRHJhd2luZ01vZGUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuaXNFbmFibGVkID0gZmFsc2U7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0U2hhZG93UHJvcGVydHk6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAoY2FudmFzLmZhYnJpYy5mcmVlRHJhd2luZ0JydXNoLnNoYWRvd1tuYW1lXSkge1xuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuZnJlZURyYXdpbmdCcnVzaC5zaGFkb3dbbmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBzZXRQcm9wZXJ0eTogZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgICAgICAgICAgIGlmIChjYW52YXMuZmFicmljLmZyZWVEcmF3aW5nQnJ1c2hbbmFtZV0pIHtcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmZyZWVEcmF3aW5nQnJ1c2hbbmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICB0b2dnbGVTaGFkb3c6IGZ1bmN0aW9uKG9uKSB7XG4gICAgICAgICAgICBpZiAob24pIHtcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmZyZWVEcmF3aW5nQnJ1c2guc2hhZG93ID0gdGhpcy5zaGFkb3c7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuc2hhZG93ID0gY2FudmFzLmZhYnJpYy5mcmVlRHJhd2luZ0JydXNoLnNoYWRvdztcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmZyZWVEcmF3aW5nQnJ1c2guc2hhZG93ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgY2hhbmdlQnJ1c2g6IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlQnJ1c2hOYW1lID0gbmFtZTtcbiAgICAgICAgICAgIG5hbWUgPSB0aGlzLm1ha2VCcnVzaE5hbWUobmFtZSk7XG5cbiAgICAgICAgICAgIC8vY2hlY2sgaWYgaXQncyBhIGJhc2UgZmFicmljIGJydXNoXG4gICAgICAgICAgICBpZiAoZmFicmljW25hbWVdKSB7XG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mcmVlRHJhd2luZ0JydXNoID0gbmV3IGZhYnJpY1tuYW1lXShjYW52YXMuZmFicmljKTtcblxuICAgICAgICAgICAgLy9jaGVjayBpZiBpdCdzIGEgY3VzdG9tIGJydXNoIHRoYXQgd2UgaGF2ZSBhbHJlYWR5IG1hZGVcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpc1tuYW1lXSkge1xuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuZnJlZURyYXdpbmdCcnVzaCA9IHRoaXNbbmFtZV07XG5cbiAgICAgICAgICAgIC8vY2hlY2sgaWYgd2UgY2FuIG1ha2UgYSByZXF1ZXN0IGJydXNoXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXNbJ21ha2UnK25hbWVdKSB7XG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mcmVlRHJhd2luZ0JydXNoID0gdGhpc1snbWFrZScrbmFtZV0oKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mcmVlRHJhd2luZ0JydXNoLndpZHRoICA9IHRoaXMucGFyYW1zLmJydXNoV2lkdGg7XG4gICAgICAgICAgICBjYW52YXMuZmFicmljLmZyZWVEcmF3aW5nQnJ1c2guY29sb3IgID0gdGhpcy5wYXJhbXMuYnJ1c2hDb2xvcjtcblxuICAgICAgICAgICAgaWYgKHRoaXMucGFyYW1zLmVuYWJsZVNoYWRvdykge1xuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuZnJlZURyYXdpbmdCcnVzaC5zaGFkb3cgPSB0aGlzLnNoYWRvdztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ29tcGlsZSBhIGZhYnJpYyBicnVzaCBmdW5jdGlvbiBuYW1lIGZyb20gZ2l2ZW4gbmFtZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIG5hbWUgKHBlbmNpbClcbiAgICAgICAgICogQHJldHVybnMgc3RyaW5nIChQZW5jaWxCcnVzaClcbiAgICAgICAgICovXG4gICAgICAgIG1ha2VCcnVzaE5hbWU6IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBuYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK25hbWUuc2xpY2UoMSkgKyAnQnJ1c2gnO1xuICAgICAgICB9LFxuXG4gICAgICAgIG1ha2VWTGluZUJydXNoOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuVkxpbmVCcnVzaCA9IG5ldyBmYWJyaWMuUGF0dGVybkJydXNoKGNhbnZhcy5mYWJyaWMpO1xuXG4gICAgICAgICAgICB0aGlzLlZMaW5lQnJ1c2guZ2V0UGF0dGVyblNyYyA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHBhdHRlcm5DYW52YXMgPSBmYWJyaWMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICAgICAgICAgICAgcGF0dGVybkNhbnZhcy53aWR0aCA9IHBhdHRlcm5DYW52YXMuaGVpZ2h0ID0gMTA7XG4gICAgICAgICAgICAgICAgdmFyIGN0eCA9IHBhdHRlcm5DYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblxuICAgICAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IHRoaXMuY29sb3I7XG4gICAgICAgICAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDU7XG4gICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgICAgIGN0eC5tb3ZlVG8oMCwgNSk7XG4gICAgICAgICAgICAgICAgY3R4LmxpbmVUbygxMCwgNSk7XG4gICAgICAgICAgICAgICAgY3R4LmNsb3NlUGF0aCgpO1xuICAgICAgICAgICAgICAgIGN0eC5zdHJva2UoKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBwYXR0ZXJuQ2FudmFzO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuVkxpbmVCcnVzaDtcbiAgICAgICAgfSxcblxuICAgICAgICBtYWtlRGlhbW9uZEJydXNoOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLkRpYW1vbmRCcnVzaCA9IG5ldyBmYWJyaWMuUGF0dGVybkJydXNoKGNhbnZhcy5mYWJyaWMpO1xuXG4gICAgICAgICAgICB0aGlzLkRpYW1vbmRCcnVzaC5nZXRQYXR0ZXJuU3JjID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3F1YXJlV2lkdGggPSAxMCwgc3F1YXJlRGlzdGFuY2UgPSA1O1xuICAgICAgICAgICAgICAgIHZhciBwYXR0ZXJuQ2FudmFzID0gZmFicmljLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgICAgICAgICAgICAgIHZhciByZWN0ID0gbmV3IGZhYnJpYy5SZWN0KHtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHNxdWFyZVdpZHRoLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHNxdWFyZVdpZHRoLFxuICAgICAgICAgICAgICAgICAgICBhbmdsZTogNDUsXG4gICAgICAgICAgICAgICAgICAgIGZpbGw6IHRoaXMuY29sb3JcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciBjYW52YXNXaWR0aCA9IHJlY3QuZ2V0Qm91bmRpbmdSZWN0V2lkdGgoKTtcblxuICAgICAgICAgICAgICAgIHBhdHRlcm5DYW52YXMud2lkdGggPSBwYXR0ZXJuQ2FudmFzLmhlaWdodCA9IGNhbnZhc1dpZHRoICsgc3F1YXJlRGlzdGFuY2U7XG4gICAgICAgICAgICAgICAgcmVjdC5zZXQoeyBsZWZ0OiBjYW52YXNXaWR0aCAvIDIsIHRvcDogY2FudmFzV2lkdGggLyAyIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIGN0eCA9IHBhdHRlcm5DYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICAgICAgICAgICAgICByZWN0LnJlbmRlcihjdHgpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhdHRlcm5DYW52YXM7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5EaWFtb25kQnJ1c2g7XG4gICAgICAgIH0sXG5cbiAgICAgICAgbWFrZUhMaW5lQnJ1c2g6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuSExpbmVCcnVzaCA9IG5ldyBmYWJyaWMuUGF0dGVybkJydXNoKGNhbnZhcy5mYWJyaWMpO1xuXG4gICAgICAgICAgICB0aGlzLkhMaW5lQnJ1c2guZ2V0UGF0dGVyblNyYyA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHBhdHRlcm5DYW52YXMgPSBmYWJyaWMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICAgICAgICAgICAgcGF0dGVybkNhbnZhcy53aWR0aCA9IHBhdHRlcm5DYW52YXMuaGVpZ2h0ID0gMTA7XG4gICAgICAgICAgICAgICAgdmFyIGN0eCA9IHBhdHRlcm5DYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblxuICAgICAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IHRoaXMuY29sb3I7XG4gICAgICAgICAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDU7XG4gICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgICAgIGN0eC5tb3ZlVG8oNSwgMCk7XG4gICAgICAgICAgICAgICAgY3R4LmxpbmVUbyg1LCAxMCk7XG4gICAgICAgICAgICAgICAgY3R4LmNsb3NlUGF0aCgpO1xuICAgICAgICAgICAgICAgIGN0eC5zdHJva2UoKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBwYXR0ZXJuQ2FudmFzO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuSExpbmVCcnVzaDtcbiAgICAgICAgfSxcblxuICAgICAgICBtYWtlU3F1YXJlQnJ1c2g6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuU3F1YXJlQnJ1c2ggPSBuZXcgZmFicmljLlBhdHRlcm5CcnVzaChjYW52YXMuZmFicmljKTtcblxuICAgICAgICAgICAgdGhpcy5TcXVhcmVCcnVzaC5nZXRQYXR0ZXJuU3JjID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3F1YXJlV2lkdGggPSAxMCwgc3F1YXJlRGlzdGFuY2UgPSAyO1xuXG4gICAgICAgICAgICAgICAgdmFyIHBhdHRlcm5DYW52YXMgPSBmYWJyaWMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICAgICAgICAgICAgcGF0dGVybkNhbnZhcy53aWR0aCA9IHBhdHRlcm5DYW52YXMuaGVpZ2h0ID0gc3F1YXJlV2lkdGggKyBzcXVhcmVEaXN0YW5jZTtcbiAgICAgICAgICAgICAgICB2YXIgY3R4ID0gcGF0dGVybkNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuXG4gICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMuY29sb3I7XG4gICAgICAgICAgICAgICAgY3R4LmZpbGxSZWN0KDAsIDAsIHNxdWFyZVdpZHRoLCBzcXVhcmVXaWR0aCk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gcGF0dGVybkNhbnZhcztcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLlNxdWFyZUJydXNoO1xuICAgICAgICB9XG5cbiAgICB9O1xuXG4gICAgcmV0dXJuIGRyYXdpbmc7XG5cbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnaW1hZ2UuZHJhd2luZycpXHJcblxyXG4uY29udHJvbGxlcignRHJhd2luZ0NvbnRyb2xsZXInLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ2NhbnZhcycsICdkcmF3aW5nJywgJ2hpc3RvcnknLCBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUsIGNhbnZhcywgZHJhd2luZywgaGlzdG9yeSkge1xyXG5cdCRzY29wZS5kcmF3aW5nID0gZHJhd2luZztcclxuICAgIHdpbmRvdy5mYiA9IGNhbnZhcy5mYWJyaWM7XHJcblxyXG5cdCRzY29wZS5jaGFuZ2VCcnVzaCA9IGZ1bmN0aW9uKGJydXNoLCAkZXZlbnQpIHtcclxuXHRcdCRzY29wZS5vcGVuUGFuZWwoJ2RyYXdpbmcnLCAkZXZlbnQpO1xyXG5cclxuXHRcdGlmICggISBkcmF3aW5nLmlzRW5hYmxlZCkge1xyXG5cdFx0XHRkcmF3aW5nLmVuYWJsZSgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGRyYXdpbmcuY2hhbmdlQnJ1c2goYnJ1c2gpO1xyXG5cdH07XHJcblxyXG5cdCRzY29wZS5maW5pc2hBZGRpbmdEcmF3aW5nc1RvQ2FudmFzID0gZnVuY3Rpb24oKSB7XHJcblx0XHQkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGlmIChjYW52YXMubWFpbkltYWdlKSB7XHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuc2V0QWN0aXZlT2JqZWN0KGNhbnZhcy5tYWluSW1hZ2UpO1xyXG4gICAgICAgIH1cclxuXHJcblx0XHRjYW52YXMuZmFicmljLmZvckVhY2hPYmplY3QoZnVuY3Rpb24ob2JqKSB7XHJcblx0XHRcdGlmIChvYmoubmFtZSA9PT0gJ2ZyZWVEcmF3aW5nJykge1xyXG5cdFx0XHRcdG9iai5yZW1vdmVPbkNhbmNlbCA9IGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHJcbiAgICAgICAgZHJhd2luZy5kaXNhYmxlKCk7XHJcblxyXG5cdFx0JHJvb3RTY29wZS5hY3RpdmVPYmplY3QgPSBjYW52YXMubWFpbkltYWdlO1xyXG5cdFx0aGlzdG9yeS5hZGQoJ2FkZGVkIGRyYXdpbmcnLCAnYnJ1c2gnKTtcclxuXHR9O1xyXG5cclxuXHQkc2NvcGUuY2FuY2VsQWRkaW5nRHJhd2luZ3NUb0NhbnZhcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMuZm9yRWFjaE9iamVjdChmdW5jdGlvbiAob2JqKSB7XHJcblx0XHRcdGlmIChvYmoubmFtZSA9PT0gJ2ZyZWVEcmF3aW5nJyAmJiBvYmoucmVtb3ZlT25DYW5jZWwpIHtcclxuXHRcdFx0XHRjYW52YXMuZmFicmljLnJlbW92ZShvYmopO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHJcblx0XHRkcmF3aW5nLmRpc2FibGUoKTtcclxuICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG5cdFx0JHJvb3RTY29wZS5hY3RpdmVQYW5lbCA9IGZhbHNlO1xyXG5cdH07XHJcblxyXG5cdCRyb290U2NvcGUuJG9uKCd0YWIuY2hhbmdlZCcsIGZ1bmN0aW9uKGUsIG5hbWUpIHtcclxuXHRcdGlmIChuYW1lICE9PSAnZHJhd2luZycpIHtcclxuXHRcdFx0ZHJhd2luZy5kaXNhYmxlKCk7XHJcblx0XHRcdCRzY29wZS5jYW5jZWxBZGRpbmdEcmF3aW5nc1RvQ2FudmFzKCk7XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdGNhbnZhcy5mYWJyaWMub24oJ3BhdGg6Y3JlYXRlZCcsIGZ1bmN0aW9uKGUpIHtcclxuXHRcdGlmIChkcmF3aW5nLmlzRW5hYmxlZCkge1xyXG5cdFx0XHRlLnBhdGguc2V0T3B0aW9ucyhjYW52YXMuaW1hZ2VTdGF0aWMpO1xyXG5cdFx0XHRlLnBhdGgubmFtZSA9ICdmcmVlRHJhd2luZyc7XHJcblx0XHRcdGUucGF0aC5yZW1vdmVPbkNhbmNlbCA9IHRydWU7XHJcblx0XHR9XHJcblx0fSk7XHJcbn1dKTsiLCIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXIubW9kdWxlKCdpbWFnZS5kaXJlY3RpdmVzJylcblxuLmRpcmVjdGl2ZSgnZWRSZW5kZXJCcnVzaGVzJywgWyckcm9vdFNjb3BlJywgJyRjb21waWxlJywgZnVuY3Rpb24gKCRyb290U2NvcGUsICRjb21waWxlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbGluazogZnVuY3Rpb24gKCRzY29wZSwgZWwpIHtcbiAgICAgICAgICAgIHZhciB0ZW1wbGF0ZSA9ICc8ZGl2IG5nLXJlcGVhdD1cImJydXNoIGluIGRyYXdpbmcuYXZhaWxhYmxlQnJ1c2hlc1wiIG5nLWNsYXNzPVwieyBhY3RpdmU6IGRyYXdpbmcuYWN0aXZlQnJ1c2hOYW1lID09IGJydXNoIH1cIiBjbGFzcz1cImJydXNoIGFuaW1hdGVkLWluLXNlcXVlbmNlXCIgbmctY2xpY2s9XCJjaGFuZ2VCcnVzaChicnVzaClcIj4nK1xuICAgICAgICAgICAgICAgICc8aW1nIGNsYXNzPVwiaW1nLXJlc3BvbnNpdmVcIiBuZy1zcmM9XCJhc3NldHMvaW1hZ2VzL2JydXNoZXMve3ticnVzaH19LnBuZ1wiLz4nK1xuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiYnJ1c2gtbmFtZVwiPnt7IGJydXNoIH19PC9kaXY+JytcbiAgICAgICAgICAgICc8L2Rpdj4nO1xuXG4gICAgICAgICAgICB2YXIgdW5iaW5kID0gJHJvb3RTY29wZS4kb24oJ3RhYi5jaGFuZ2VkJywgZnVuY3Rpb24oZSwgbmFtZSkge1xuICAgICAgICAgICAgICAgIGlmIChuYW1lID09PSAnZHJhd2luZycpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsLmFwcGVuZCgkY29tcGlsZSh0ZW1wbGF0ZSkoJHNjb3BlKSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB1bmJpbmQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG59XSk7XG4iLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnSW1hZ2VFZGl0b3InKVxyXG5cclxuLmZhY3RvcnkoJ2hpc3RvcnknLCBbJyRyb290U2NvcGUnLCAnY2FudmFzJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgY2FudmFzKSB7XHJcblxyXG5cdHZhciBoaXN0b3J5ID0ge1xyXG5cclxuXHRcdGFsbDogW10sXHJcblxyXG4gICAgICAgIC8vdXNlZCBmb3IgYmFja2luZyB1cCBjYW52YXMgYW5kIG90aGVyIHNlcmlhbGl6YXRpb25zXHJcbiAgICAgICAgLy90aGF0IGFyZSBub3QgdmlzaWJsZSB0byB0aGUgdXNlclxyXG4gICAgICAgIGlnbm9yZWQ6IFtdLCBcclxuXHJcblx0XHRhZGQ6IGZ1bmN0aW9uKG5hbWUsIGljb24sIGlnbm9yZSkge1xyXG4gICAgICAgICAgICB2YXIgcHJvcCA9IGlnbm9yZSA/ICdpZ25vcmVkJyA6ICdhbGwnO1xyXG5cclxuICAgICAgICAgICAgLy9tYWtlIHN1cmUgZG9uJ3QgaGF2ZSBkdXBsaWNhdGVzIGluIGlnbm9yZWQgYXJyYXlcclxuICAgICAgICAgICAgaWYgKHByb3AgPT09ICdpZ25vcmVkJykgeyBcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5pZ25vcmVkLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaWdub3JlZFtpXS5uYW1lID09PSBuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaWdub3JlZC5zcGxpY2UoaSwgMSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcblx0XHRcdHRoaXNbcHJvcF0udW5zaGlmdCh7XHJcblx0XHRcdFx0bmFtZTogbmFtZSxcclxuXHRcdFx0XHRzdGF0ZTogY2FudmFzLmZhYnJpYy50b0pTT04oWydzZWxlY3RhYmxlJywgJ25hbWUnXSksXHJcblx0XHRcdFx0aW5kZXg6IHRoaXMuYWxsLmxlbmd0aCsxLFxyXG5cdFx0XHRcdGljb246IGljb24sXHJcbiAgICAgICAgICAgICAgICB6b29tOiBjYW52YXMuem9vbSxcclxuXHRcdFx0XHRjYW52YXNXaWR0aDogY2FudmFzLm9yaWdpbmFsLndpZHRoIHx8IGNhbnZhcy5mYWJyaWMuZ2V0V2lkdGgoKSxcclxuXHRcdFx0XHRjYW52YXNIZWlnaHQ6IGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQgfHwgY2FudmFzLmZhYnJpYy5nZXRIZWlnaHQoKVxyXG5cdFx0XHR9KTtcclxuXHRcdH0sXHJcblxyXG4gICAgICAgIGdldDogZnVuY3Rpb24obmFtZSwgcHJvcCkge1xyXG4gICAgICAgICAgICBpZiAoICFwcm9wKSBwcm9wID0gJ2lnbm9yZWQnO1xyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoaXN0b3J5W3Byb3BdLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaGlzdG9yeVtwcm9wXVtpXS5uYW1lID09PSBuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGhpc3RvcnlbcHJvcF1baV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBnZXRDdXJyZW50Q2FudmFzU3RhdGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgc3RhdGU6IGNhbnZhcy5mYWJyaWMudG9KU09OKFsnc2VsZWN0YWJsZScsICduYW1lJ10pLFxyXG4gICAgICAgICAgICAgICAgaW5kZXg6IHRoaXMuYWxsLmxlbmd0aCsxLFxyXG4gICAgICAgICAgICAgICAgem9vbTogY2FudmFzLnpvb20sXHJcbiAgICAgICAgICAgICAgICBjYW52YXNXaWR0aDogY2FudmFzLm9yaWdpbmFsLndpZHRoIHx8IGNhbnZhcy5mYWJyaWMuZ2V0V2lkdGgoKSxcclxuICAgICAgICAgICAgICAgIGNhbnZhc0hlaWdodDogY2FudmFzLm9yaWdpbmFsLmhlaWdodCB8fCBjYW52YXMuZmFicmljLmdldEhlaWdodCgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuXHRcdGxvYWQ6IGZ1bmN0aW9uKGl0ZW0pIHtcclxuXHRcdFx0JHJvb3RTY29wZS5pc0xvYWRpbmcoKTtcclxuXHJcbiAgICAgICAgICAgIC8vaWYgd2UgZ2V0IHBhc3NlZCBhIG5hbWUsIGZldGNoIGEgbWF0Y2hpbmcgaGlzdG9yeSBpdGVtXHJcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzU3RyaW5nKGl0ZW0pKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtID0gdGhpcy5nZXQoaXRlbSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICggISBpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJHJvb3RTY29wZS5pc05vdExvYWRpbmcoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuXHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRjYW52YXMuZmFicmljLmxvYWRGcm9tSlNPTihpdGVtLnN0YXRlLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdGNhbnZhcy5mYWJyaWMuZm9yRWFjaE9iamVjdChmdW5jdGlvbihvYmopIHtcclxuXHJcblx0XHRcdFx0XHRcdC8vcmVhcHBseSBhbnkgZmlsdGVycyBvYmplY3QgdXNlZCB0byBoYXZlXHJcblx0XHRcdFx0XHRcdGlmIChvYmouYXBwbHlGaWx0ZXJzICYmIG9iai5maWx0ZXJzLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0XHRcdG9iai5hcHBseUZpbHRlcnMoY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwuYmluZChjYW52YXMuZmFicmljKSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdC8vYXNzaWduIG5ldyByZWZlcmVuY2UgdG8gbWFpbkltYWdlIHByb3BlcnR5XHJcblx0XHRcdFx0XHRcdGlmIChvYmoubmFtZSA9PSAnbWFpbkltYWdlJykge1xyXG5cdFx0XHRcdFx0XHRcdGNhbnZhcy5tYWluSW1hZ2UgPSBvYmo7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMuem9vbSgxKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uY2FudmFzV2lkdGggJiYgaXRlbS5jYW52YXNIZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRXaWR0aChpdGVtLmNhbnZhc1dpZHRoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRIZWlnaHQoaXRlbS5jYW52YXNIZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMub3JpZ2luYWwud2lkdGggPSBpdGVtLmNhbnZhc1dpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMub3JpZ2luYWwuaGVpZ2h0ID0gaXRlbS5jYW52YXNIZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuY2FsY09mZnNldCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuaXNOb3RMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmZpdFRvU2NyZWVuKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGVtaXQoJ2hpc3RvcnkubG9hZGVkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZm9udHMucmVhZHkudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibG9hZGVkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmlzTm90TG9hZGluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9LCAzMCk7XHJcblxyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdHJldHVybiBoaXN0b3J5O1xyXG59XSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ0ltYWdlRWRpdG9yJylcclxuXHJcbi5mYWN0b3J5KCdzYXZlcicsIFsnJHJvb3RTY29wZScsICckbWREaWFsb2cnLCAnJGh0dHAnLCAnJHRpbWVvdXQnLCAnY2FudmFzJywgJ2Nyb3BwZXInLCAnaGlzdG9yeScsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRtZERpYWxvZywgJGh0dHAsICR0aW1lb3V0LCBjYW52YXMsIGNyb3BwZXIsIGhpc3RvcnkpIHtcclxuXHJcblx0dmFyIHNhdmVyID0ge1xyXG5cclxuICAgICAgICBzYXZlSW1hZ2U6IGZ1bmN0aW9uKGZvcm1hdCwgcXVhbGl0eSwgbmFtZSwgZSwgY2xvc2UpIHtcclxuXHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuZGVhY3RpdmF0ZUFsbCgpO1xyXG4gICAgICAgICAgICBjcm9wcGVyLnN0b3AoKTtcclxuXHJcbiAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLmlzRGVtbykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlRGVtb1NpdGVTYXZlKGUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5pc0ludGVncmF0aW9uTW9kZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlSW50ZWdyYXRpb25Nb2RlU2F2ZShmb3JtYXQsIHF1YWxpdHksIG5hbWUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvL3RoaXMuc2F2ZVRvQ29tcHV0ZXIoZm9ybWF0LCBxdWFsaXR5LCBuYW1lKTtcclxuICAgICAgICAgICAgdGhpcy5zYXZlVG9TZXJ2ZXIobmFtZSwgY2xvc2UpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGhhbmRsZUludGVncmF0aW9uTW9kZVNhdmU6IGZ1bmN0aW9uKGZvcm1hdCwgcXVhbGl0eSwgbmFtZSkge1xyXG4gICAgICAgICAgICBjYW52YXMuem9vbSgxNTAvY2FudmFzLm9yaWdpbmFsLmhlaWdodCk7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gdGhpcy5nZXREYXRhVXJsKGZvcm1hdCwgcXVhbGl0eSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmhhbmRsZUNhbGxiYWNrcyhkYXRhLCBuYW1lKTtcclxuXHJcbiAgICAgICAgICAgIC8vZmlyZWZveCBpbnRlZ3JhdGlvbiBtb2RlIGZpeFxyXG4gICAgICAgICAgICAkKCcubWQtZGlhbG9nLWNvbnRhaW5lcicpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5waXhpZS5jbG9zZSgpO1xyXG4gICAgICAgICAgICBjYW52YXMuem9vbSgwLjUpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHNhdmVUb1NlcnZlcjogZnVuY3Rpb24obmFtZSwgY2xvc2UpIHtcclxuXHJcbiAgICAgICAgICAgIGNhbnZhcy56b29tKDE1MC9jYW52YXMub3JpZ2luYWwuaGVpZ2h0KTtcclxuICAgICAgICAgICAgdmFyIGRhdGFfanBlZyA9IHRoaXMuZ2V0RGF0YVVybCgnanBlZycsIDgpO1xyXG5cclxuICAgICAgICAgICAgY2FudmFzLnpvb20oMSk7ICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciBkYXRhX3BuZyA9IHRoaXMuZ2V0RGF0YVVybCgncG5nJywgOCksXHJcbiAgICAgICAgICAgICAgICBkYXRhX2pzb24gPSB0aGlzLmdldERhdGFVcmwoJ2pzb24nLCA4KTtcclxuICAgICAgICAgICAgY2FudmFzLmZpdFRvU2NyZWVuKCk7ICBcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5pc0xvYWRpbmcoKTtcclxuICAgICAgICAgICAgalF1ZXJ5LmFqYXgoe1xyXG4gICAgICAgICAgICAgICAgdXJsOiBcIi93cC1hZG1pbi9hZG1pbi1hamF4LnBocFwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ3dpbmVzaG9wX2xhYmVsX3NhdmUnLFxyXG4gICAgICAgICAgICAgICAgICAgIG9yZGVyX2lkOiAkcm9vdFNjb3BlLm9yZGVyX2lkLFxyXG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RfaWQ6ICRyb290U2NvcGUucHJvZHVjdF9pZCxcclxuICAgICAgICAgICAgICAgICAgICBqcGVnIDogZGF0YV9qcGVnLFxyXG4gICAgICAgICAgICAgICAgICAgIHBuZyA6IGRhdGFfcG5nLFxyXG4gICAgICAgICAgICAgICAgICAgIGpzb24gOiBkYXRhX2pzb25cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB0eXBlOiAnUE9TVCcsXHJcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmlzTm90TG9hZGluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGNsb3NlKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRvcC50Yl9yZW1vdmUgPT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcC50Yl9yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXZlbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2xvc2VFdmVudE5hbWUgPSBcInBlcnNvbmFsaXplZC13aW5lLWRlc2lnbmVyLW1vZGFsLWNsb3NlXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuY3JlYXRlRXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KFwiSFRNTEV2ZW50c1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5pbml0RXZlbnQoY2xvc2VFdmVudE5hbWUsIHRydWUsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50T2JqZWN0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQuZXZlbnRUeXBlID0gY2xvc2VFdmVudE5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQuZXZlbnROYW1lID0gY2xvc2VFdmVudE5hbWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LmNyZWF0ZUV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChldmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnBhcmVudC5kb2N1bWVudC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZmlyZUV2ZW50KFwib25cIiArIGV2ZW50LmV2ZW50VHlwZSwgZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5wYXJlbnQuZG9jdW1lbnQuZmlyZUV2ZW50KFwib25cIiArIGV2ZW50LmV2ZW50VHlwZSwgZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgc2F2ZVRvQ29tcHV0ZXI6IGZ1bmN0aW9uKGZvcm1hdCwgcXVhbGl0eSwgbmFtZSkge1xyXG4gICAgICAgICAgICBjYW52YXMuem9vbSgxKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpLFxyXG4gICAgICAgICAgICAgICAgZGF0YSA9IHRoaXMuZ2V0RGF0YVVybChmb3JtYXQsIHF1YWxpdHkpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5oYW5kbGVDYWxsYmFja3MoZGF0YSwgbmFtZSk7XHJcblxyXG4gICAgICAgICAgICAvL2Jyb3dzZXIgc3VwcG9ydHMgaHRtbDUgZG93bmxvYWQgYXR0cmlidXRlXHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgbGluay5kb3dubG9hZCAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAgICAgICAgIGxpbmsuZG93bmxvYWQgPSAobmFtZSB8fCAnaW1hZ2UnKSsnLicrZm9ybWF0O1xyXG4gICAgICAgICAgICAgICAgbGluay5ocmVmID0gZGF0YTtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGluayk7XHJcbiAgICAgICAgICAgICAgICBsaW5rLmNsaWNrKCk7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGxpbmspO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvL2NhbnZhcyBibG9iIGFuZCBmaWxlIHNhdmVyIHdvcmthcm91bmRcclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmxvd2VyQ2FudmFzRWwudG9CbG9iKGZ1bmN0aW9uKGJsb2IpIHtcclxuICAgICAgICAgICAgICAgICAgICBzYXZlQXMoYmxvYiwgbmFtZSsnLicrZm9ybWF0KTtcclxuICAgICAgICAgICAgICAgIH0sICdpbWFnZS8nK2Zvcm1hdCwgcXVhbGl0eSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgaGFuZGxlQ2FsbGJhY2tzOiBmdW5jdGlvbihkYXRhLCBuYW1lKSB7XHJcbiAgICAgICAgICAgIC8vcmVwbGFjZSBpbWFnZSBzcmMgd2l0aCBuZXcgZGF0YSB1cmwgaW4gb3JpZ2luYWwgd2luZG93XHJcbiAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLmdldFBhcmFtKCdyZXBsYWNlT3JpZ2luYWwnKSAmJiAkcm9vdFNjb3BlLmdldFBhcmFtKCdpbWFnZScpKSB7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmdldFBhcmFtKCdpbWFnZScpLnNyYyA9IGRhdGE7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vc2VuZCBpbWFnZSBkYXRhIHRvIHVzZXIgc3BlY2lmaWVkIHVybFxyXG4gICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5nZXRQYXJhbSgnc2F2ZVVybCcpKSB7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5wb3N0KCRyb290U2NvcGUuZ2V0UGFyYW0oJ3NhdmVVcmwnKSwgeyBkYXRhOiBkYXRhLCBuYW1lOiBuYW1lIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5nZXRQYXJhbSgnb25TYXZlJykpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpbWcgPSAkcm9vdFNjb3BlLmdldFBhcmFtKCdpbWFnZScpIHx8IG5ldyBJbWFnZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuZ2V0UGFyYW0oJ29uU2F2ZScpKGRhdGEsIGltZywgbmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBoYW5kbGVEZW1vU2l0ZVNhdmU6IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgJCgnLmRlbW8tYWxlcnQnKS5vbmUoJHJvb3RTY29wZS5hbmltYXRpb25FbmRFdmVudCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdhbmltYXRlZCBzaGFrZScpOyAgZS50YXJnZXQuYmx1cigpO1xyXG4gICAgICAgICAgICB9KS5hZGRDbGFzcygnYW5pbWF0ZWQgc2hha2UnKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBnZXREYXRhVXJsOiBmdW5jdGlvbihmb3JtYXQsIHF1YWxpdHkpIHtcclxuICAgICAgICAgICAgaWYgKGZvcm1hdCA9PT0gJ2pzb24nKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJkYXRhOnRleHQvanNvbjtjaGFyc2V0PXV0Zi04LFwiICsgZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KGhpc3RvcnkuZ2V0Q3VycmVudENhbnZhc1N0YXRlKCkpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gY2FudmFzLmZhYnJpYy50b0RhdGFVUkwoe1xyXG4gICAgICAgICAgICAgICAgZm9ybWF0OiBmb3JtYXQgfHwgJ3BuZycsXHJcbiAgICAgICAgICAgICAgICBxdWFsaXR5OiAocXVhbGl0eSB8fCA4KSAvIDEwXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGdldFRodW1iRGF0YVVybDogZnVuY3Rpb24oZGF0YXMsIHdhbnRlZFdpZHRoLCB3YW50ZWRIZWlnaHQpe1xyXG4gICAgICAgICAgICAvLyBXZSBjcmVhdGUgYW4gaW1hZ2UgdG8gcmVjZWl2ZSB0aGUgRGF0YSBVUklcclxuICAgICAgICAgICAgdmFyIGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG5cclxuICAgICAgICAgICAgLy8gV2UgcHV0IHRoZSBEYXRhIFVSSSBpbiB0aGUgaW1hZ2UncyBzcmMgYXR0cmlidXRlXHJcbiAgICAgICAgICAgIGltZy5zcmMgPSBkYXRhcztcclxuICAgICAgICAgICAgdmFyIGRhdGFVUkkgPSAnJztcclxuICAgICAgICAgICAgLy8gV2hlbiB0aGUgZXZlbnQgXCJvbmxvYWRcIiBpcyB0cmlnZ2VyZWQgd2UgY2FuIHJlc2l6ZSB0aGUgaW1hZ2UuXHJcbiAgICAgICAgICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbigpXHJcbiAgICAgICAgICAgICAgICB7ICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAvLyBXZSBjcmVhdGUgYSBjYW52YXMgYW5kIGdldCBpdHMgY29udGV4dC5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBXZSBzZXQgdGhlIGRpbWVuc2lvbnMgYXQgdGhlIHdhbnRlZCBzaXplLlxyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy53aWR0aCA9IHdhbnRlZFdpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSB3YW50ZWRIZWlnaHQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIHJlc2l6ZSB0aGUgaW1hZ2Ugd2l0aCB0aGUgY2FudmFzIG1ldGhvZCBkcmF3SW1hZ2UoKTtcclxuICAgICAgICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKHRoaXMsIDAsIDAsIHdhbnRlZFdpZHRoLCB3YW50ZWRIZWlnaHQpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBkYXRhVVJJID0gY2FudmFzLnRvRGF0YVVSTCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVXNlIGFuZCB0cmVhdCB5b3VyIERhdGEgVVJJIGhlcmUgISEgLy9cclxuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgd2hpbGUoZGF0YVVSSSA9PSAnJyl7fTtcclxuICAgICAgICAgICAgcmV0dXJuIGRhdGFVUkk7XHJcbiAgICAgICAgfVxyXG5cdH07XHJcblxyXG5cdHJldHVybiBzYXZlcjtcclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5maWx0ZXJzJywgW10pXG5cbi5jb250cm9sbGVyKCdGaWx0ZXJzQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnY2FudmFzJywgJ2ZpbHRlcnMnLCBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUsIGNhbnZhcywgZmlsdGVycykge1xuXG4gICAgJHNjb3BlLmZpbHRlcnMgPSBmaWx0ZXJzO1xuXG4gICAgJHJvb3RTY29wZS4kb24oJ2hpc3RvcnkubG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoICEgY2FudmFzLm1haW5JbWFnZSkgcmV0dXJuO1xuXG4gICAgICAgIHZhciBhcHBsaWVkRmlsdGVycyA9IFtdO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2FudmFzLm1haW5JbWFnZS5maWx0ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBhcHBsaWVkRmlsdGVycy5wdXNoKGNhbnZhcy5tYWluSW1hZ2UuZmlsdGVyc1tpXS5uYW1lKTtcbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBmaWx0ZXJzLmFwcGxpZWRGaWx0ZXJzID0gYXBwbGllZEZpbHRlcnM7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufV0pO1xuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ2ltYWdlLmZpbHRlcnMnKVxyXG5cclxuLnNlcnZpY2UoJ2ZpbHRlcnMnLCBbJyRyb290U2NvcGUnLCAnY2FudmFzJywgJ2hpc3RvcnknLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgY2FudmFzLCBoaXN0b3J5KSB7XHJcblxyXG4gICAgdmFyIGZpbHRlcnMgPSB7XHJcblxyXG4gICAgICAgIGFsbDogW1xyXG4gICAgICAgICAgICB7IG5hbWU6ICdncmF5c2NhbGUnIH0sXHJcbiAgICAgICAgICAgIHsgbmFtZTogJ2ludmVydCcgfSxcclxuICAgICAgICAgICAgeyBuYW1lOiAnc2VwaWEnIH0sXHJcbiAgICAgICAgICAgIHsgbmFtZTogJ3NlcGlhMicgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ3JlbW92ZVdoaXRlJyxcclxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IHtcclxuICAgICAgICAgICAgICAgICAgICBkaXN0YW5jZTogeyBjdXJyZW50OiAxMCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHRocmVzaG9sZDogeyBjdXJyZW50OiA1MCB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdicmlnaHRuZXNzJyxcclxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IHtcclxuICAgICAgICAgICAgICAgICAgICBicmlnaHRuZXNzOiB7IGN1cnJlbnQ6IDUwIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ25vaXNlJyxcclxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IHtcclxuICAgICAgICAgICAgICAgICAgICBub2lzZTogeyBjdXJyZW50OiA0MCwgbWF4OiA2MDAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnR3JhZGllbnRUcmFuc3BhcmVuY3knLFxyXG4gICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdHcmFkaWVudCcsXHJcbiAgICAgICAgICAgICAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyZXNob2xkOiB7IGN1cnJlbnQ6IDQwIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ3BpeGVsYXRlJyxcclxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IHtcclxuICAgICAgICAgICAgICAgICAgICBibG9ja3NpemU6IHsgbWF4OiA0MCwgY3VycmVudDogMiB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdzaGFycGVuJyxcclxuICAgICAgICAgICAgICAgIHVzZXM6ICdDb252b2x1dGUnLFxyXG4gICAgICAgICAgICAgICAgbWF0cml4OiBbIDAsIC0xLCAgMCwgLTEsICA1LCAtMSwgMCwgLTEsICAwIF1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ2JsdXInLFxyXG4gICAgICAgICAgICAgICAgdXNlczogJ0NvbnZvbHV0ZScsXHJcbiAgICAgICAgICAgICAgICBtYXRyaXg6IFsgMS85LCAxLzksIDEvOSwgMS85LCAxLzksIDEvOSwgMS85LCAxLzksIDEvOSBdXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdlbWJvc3MnLFxyXG4gICAgICAgICAgICAgICAgdXNlczogJ0NvbnZvbHV0ZScsXHJcbiAgICAgICAgICAgICAgICBtYXRyaXg6IFsgMSwgICAxLCAgMSwgMSwgMC43LCAtMSwgLTEsICAtMSwgLTEgXVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAndGludCcsXHJcbiAgICAgICAgICAgICAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogeyBjdXJyZW50OiAwLjUsIG1pbjogMC4xLCBtYXg6IDEsIHN0ZXA6IDAuMSB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiB7IGNvbG9ycGlja2VyOiB0cnVlLCBjdXJyZW50OiAnI0ZGNDA4MScgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnbXVsdGlwbHknLFxyXG4gICAgICAgICAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiB7IGNvbG9ycGlja2VyOiB0cnVlLCBjdXJyZW50OiAnI0ZGNDA4MScgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnYmxlbmQnLFxyXG4gICAgICAgICAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGU6IHsgY3VycmVudDogJ2FkZCcsIHNlbGVjdDogdHJ1ZSwgYXZhaWxhYmxlOiBbJ2FkZCcsICdtdWx0aXBseScsICdzdWJ0cmFjdCcsICdkaWZmJywgJ3NjcmVlbicsICdsaWdodGVuJywgJ2RhcmtlbiddIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgYWxwaGE6IHsgY3VycmVudDogMC41LCBtaW46IDAuMSwgbWF4OiAxLCBzdGVwOiAwLjEgfSxcclxuICAgICAgICAgICAgICAgICAgICBjb2xvcjogeyBjb2xvcnBpY2tlcjogdHJ1ZSwgY3VycmVudDogJyNGRjQwODEnIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgXSxcclxuXHJcbiAgICAgICAgYXBwbGllZEZpbHRlcnM6IFtdLFxyXG5cclxuICAgICAgICBhcHBseUZpbHRlcjogZnVuY3Rpb24oZmlsdGVyKSB7XHJcbiAgICAgICAgICAgIGlmICggISB0aGlzLmZpbHRlckV4aXN0cyhmaWx0ZXIpKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5maWx0ZXJBbHJlYWR5QXBwbGllZChmaWx0ZXIubmFtZSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbW92ZUZpbHRlcihmaWx0ZXIpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmlzTG9hZGluZygpO1xyXG4gICAgICAgICAgICBmaWx0ZXJzLm1hcmtBc0FwcGxpZWQoZmlsdGVyLm5hbWUpO1xyXG5cclxuICAgICAgICAgICAgLy9uZWVkIHRvIHVzZSB0aW1lb3V0IHRvIGRpc3BsYXkgbG9hZGluZyBzcGlubmVyIHByb3Blcmx5XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmZvckVhY2hPYmplY3QoZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9iai5hcHBseUZpbHRlcnMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqLmZpbHRlcnMucHVzaChmaWx0ZXJzLmdldEZpbHRlcihmaWx0ZXIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqLmFwcGx5RmlsdGVycyhjYW52YXMuZmFicmljLnJlbmRlckFsbC5iaW5kKGNhbnZhcy5mYWJyaWMpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBoaXN0b3J5LmFkZCgnZmlsdGVyOiAnKyhmaWx0ZXIuZGlzcGxheU5hbWUgfHwgZmlsdGVyLm5hbWUpLCAnYnJpZ2h0bmVzcy02Jyk7XHJcbiAgICAgICAgICAgICAgICBmaWx0ZXJzLmxhc3RBcHBsaWVkRmlsdGVyID0gZmlsdGVyO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5pc05vdExvYWRpbmcoKTtcclxuICAgICAgICAgICAgfSwgMzApO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHJlbW92ZUZpbHRlcjogZnVuY3Rpb24oZmlsdGVyKSB7XHJcbiAgICAgICAgICAgIGlmICggISB0aGlzLmZpbHRlckV4aXN0cyhmaWx0ZXIpKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmlzTG9hZGluZygpO1xyXG4gICAgICAgICAgICBmaWx0ZXJzLnVubWFya0FzQXBwbGllZChmaWx0ZXIubmFtZSk7XHJcblxyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mb3JFYWNoT2JqZWN0KGZ1bmN0aW9uKG9iaikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvYmouYXBwbHlGaWx0ZXJzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2JqLmZpbHRlcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYmouZmlsdGVyc1tpXS5uYW1lLnRvTG93ZXJDYXNlKCkgPT09IGZpbHRlci5uYW1lLnRvTG93ZXJDYXNlKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmouZmlsdGVycy5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqLmFwcGx5RmlsdGVycyhjYW52YXMuZmFicmljLnJlbmRlckFsbC5iaW5kKGNhbnZhcy5mYWJyaWMpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGZpbHRlcnMubGFzdEFwcGxpZWRGaWx0ZXIgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuaXNOb3RMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgIH0sIDMwKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBhcHBseVZhbHVlOiBmdW5jdGlvbihmaWx0ZXJOYW1lLCBvcHRpb25OYW1lLCBvcHRpb25WYWx1ZSkge1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmlzTG9hZGluZygpO1xyXG5cclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuZm9yRWFjaE9iamVjdChmdW5jdGlvbihvYmopIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAob2JqLmFwcGx5RmlsdGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9iai5maWx0ZXJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlsdGVyID0gb2JqLmZpbHRlcnNbaV07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbHRlci50eXBlLnRvTG93ZXJDYXNlKCkgPT09IGZpbHRlck5hbWUudG9Mb3dlckNhc2UoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcltvcHRpb25OYW1lXSA9IG9wdGlvblZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iai5hcHBseUZpbHRlcnMoY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwuYmluZChjYW52YXMuZmFicmljKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmlzTm90TG9hZGluZygpO1xyXG4gICAgICAgICAgICB9LCAzMCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZmlsdGVyQWxyZWFkeUFwcGxpZWQ6IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXBwbGllZEZpbHRlcnMuaW5kZXhPZihuYW1lKSAhPT0gLTFcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBtYXJrQXNBcHBsaWVkOiBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFwcGxpZWRGaWx0ZXJzLmluZGV4T2YobmFtZSkgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFwcGxpZWRGaWx0ZXJzLnB1c2gobmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICB1bm1hcmtBc0FwcGxpZWQ6IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmFwcGxpZWRGaWx0ZXJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hcHBsaWVkRmlsdGVyc1tpXSA9PT0gbmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwbGllZEZpbHRlcnMuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZmlsdGVyRXhpc3RzOiBmdW5jdGlvbihmaWx0ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhYnJpYy5JbWFnZS5maWx0ZXJzW2ZhYnJpYy51dGlsLnN0cmluZy5jYXBpdGFsaXplKGZpbHRlci51c2VzIHx8IGZpbHRlci5uYW1lLCB0cnVlKV0gIT09IHVuZGVmaW5lZDtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBnZXRGaWx0ZXI6IGZ1bmN0aW9uKGZpbHRlcikge1xyXG4gICAgICAgICAgICB2YXIgbmV3RmlsdGVyO1xyXG5cclxuICAgICAgICAgICAgaWYgKGZpbHRlci51c2VzKSB7XHJcbiAgICAgICAgICAgICAgICBuZXdGaWx0ZXIgPSBuZXcgZmFicmljLkltYWdlLmZpbHRlcnNbZmFicmljLnV0aWwuc3RyaW5nLmNhcGl0YWxpemUoZmlsdGVyLnVzZXMsIHRydWUpXSh7IG1hdHJpeDogZmlsdGVyLm1hdHJpeCB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHt9O1xyXG5cclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBmaWx0ZXIub3B0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnNba2V5XSA9IGZpbHRlci5vcHRpb25zW2tleV0uY3VycmVudDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBuZXdGaWx0ZXIgPSBuZXcgZmFicmljLkltYWdlLmZpbHRlcnNbZmFicmljLnV0aWwuc3RyaW5nLmNhcGl0YWxpemUoZmlsdGVyLm5hbWUsIHRydWUpXShvcHRpb25zKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbmV3RmlsdGVyLm5hbWUgPSBmaWx0ZXIubmFtZTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBuZXdGaWx0ZXI7XHJcbiAgICAgICAgfSxcclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIGZpbHRlcnM7XHJcblxyXG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ2ltYWdlLnNoYXBlcycsIFtdKVxyXG5cclxuLmNvbnRyb2xsZXIoJ1NpbXBsZVNoYXBlc0NvbnRyb2xsZXInLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJyR0aW1lb3V0JywgJ2NhbnZhcycsICdzaW1wbGVTaGFwZXMnLCBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUsICR0aW1lb3V0LCBjYW52YXMsIHNpbXBsZVNoYXBlcykge1xyXG5cdCRzY29wZS5zaGFwZXMgPSBzaW1wbGVTaGFwZXM7XHJcblxyXG4gICAgJHNjb3BlLmF2YWlsYWJsZSA9IFsncmVjdCcsICd0cmlhbmdsZScsICdjaXJjbGUnLCAnZWxsaXBzZScsICdwb2x5Z29uJ107XHJcblxyXG4gICAgJHNjb3BlLmlzUGFuZWxFbmFibGVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIG9iaiA9IGNhbnZhcy5mYWJyaWMuZ2V0QWN0aXZlT2JqZWN0KCk7XHJcbiAgICAgICAgaWYob2JqICYmICRzY29wZS5hdmFpbGFibGUuaW5kZXhPZihvYmoubmFtZSkgPiAtMSl7XHJcbiAgICAgICAgICAgICRzY29wZS5zZXRTZWxldGVkU2hhcGUob2JqKTtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVPYmplY3QgPSBvYmo7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBvYmogJiYgJHNjb3BlLmF2YWlsYWJsZS5pbmRleE9mKG9iai5uYW1lKSA+IC0xICYmIHNpbXBsZVNoYXBlcy5zZWxlY3RlZC5vcHRpb25zO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuc2V0U2VsZXRlZFNoYXBlID0gZnVuY3Rpb24ob2JqKXtcclxuXHJcbiAgICAgICAgJHNjb3BlLnNoYXBlcy5zZWxlY3RTaGFwZShvYmoubmFtZSk7XHJcbiAgICAgICAgJHNjb3BlLnNoYXBlcy5zZWxlY3RlZFNoYXBlID0gb2JqO1xyXG5cclxuICAgICAgICB2YXIgc2VsZWN0ZWRTaGFwZSA9ICRzY29wZS5zaGFwZXMuc2VsZWN0ZWQ7XHJcblxyXG4gICAgICAgIHNlbGVjdGVkU2hhcGUub3B0aW9ucy5tYWluLmZpbGwuY3VycmVudCA9IG9iai5maWxsO1xyXG4gICAgICAgIHNlbGVjdGVkU2hhcGUub3B0aW9ucy5tYWluLm9wYWNpdHkuY3VycmVudCA9IG9iai5vcGFjaXR5O1xyXG4gICAgICAgIGlmKG9iai5uYW1lID09ICdjaXJjbGUnKXtcclxuICAgICAgICAgICAgc2VsZWN0ZWRTaGFwZS5vcHRpb25zLm1haW4ucmFkaXVzLmN1cnJlbnQgPSBvYmoucmFkaXVzO1xyXG4gICAgICAgIH1lbHNlIGlmKG9iai5uYW1lID09ICdlbGxpcHNlJyl7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkU2hhcGUub3B0aW9ucy5tYWluLnJ4LmN1cnJlbnQgPSBvYmoucng7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkU2hhcGUub3B0aW9ucy5tYWluLnJ5LmN1cnJlbnQgPSBvYmoucnk7XHJcbiAgICAgICAgfWVsc2UgaWYob2JqLm5hbWUgIT0gJ3BvbHlnb24nKXtcclxuICAgICAgICAgICAgc2VsZWN0ZWRTaGFwZS5vcHRpb25zLm1haW4ud2lkdGguY3VycmVudCA9IG9iai53aWR0aDtcclxuICAgICAgICAgICAgc2VsZWN0ZWRTaGFwZS5vcHRpb25zLm1haW4uaGVpZ2h0LmN1cnJlbnQgPSBvYmouaGVpZ2h0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBqUXVlcnkoXCIjc2hhcGVCZ0NvbG9yXCIpLnNwZWN0cnVtKFwic2V0XCIsIG9iai5maWxsKTtcclxuICAgICAgICBpZihvYmouc3Ryb2tlKXtcclxuICAgICAgICAgICAgc2VsZWN0ZWRTaGFwZS5vcHRpb25zLmJvcmRlci5lbmFibGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgc2VsZWN0ZWRTaGFwZS5vcHRpb25zLmJvcmRlci5zdHJva2UuY3VycmVudCA9IG9iai5zdHJva2U7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkU2hhcGUub3B0aW9ucy5ib3JkZXIuc3Ryb2tlV2lkdGguY3VycmVudCA9IG9iai5zdHJva2VXaWR0aDtcclxuICAgICAgICAgICAgalF1ZXJ5KFwiI2JvcmRlcnN0cm9rZVwiKS5zcGVjdHJ1bShcInNldFwiLCBvYmouc3Ryb2tlKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgc2VsZWN0ZWRTaGFwZS5vcHRpb25zLmJvcmRlci5lbmFibGVkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKG9iai5zaGFkb3cpe1xyXG4gICAgICAgICAgICBzZWxlY3RlZFNoYXBlLm9wdGlvbnMuc2hhZG93LmVuYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICBzZWxlY3RlZFNoYXBlLm9wdGlvbnMuc2hhZG93LmNvbG9yLmN1cnJlbnQgPSBvYmouc2hhZG93LmNvbG9yO1xyXG4gICAgICAgICAgICBzZWxlY3RlZFNoYXBlLm9wdGlvbnMuc2hhZG93LmJsdXIuY3VycmVudCA9IG9iai5zaGFkb3cuYmx1cjtcclxuICAgICAgICAgICAgc2VsZWN0ZWRTaGFwZS5vcHRpb25zLnNoYWRvdy5vZmZzZXRYLmN1cnJlbnQgPSBvYmouc2hhZG93Lm9mZnNldFg7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkU2hhcGUub3B0aW9ucy5zaGFkb3cub2Zmc2V0WS5jdXJyZW50ID0gb2JqLnNoYWRvdy5vZmZzZXRZO1xyXG4gICAgICAgICAgICBqUXVlcnkoXCIjc2hhZG93Y29sb3JcIikuc3BlY3RydW0oXCJzZXRcIiwgb2JqLnNoYWRvdy5jb2xvcik7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkU2hhcGUub3B0aW9ucy5zaGFkb3cuZW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gJHNjb3BlLnNlbGVjdGVkU2hhcGVbJ2hlaWdodCddID0gb2JqLmhlaWdodDtcclxuICAgICAgICAvLyAkc2NvcGUuc2VsZWN0ZWRTaGFwZVsnb3BhY2l0eSddID0gb2JqLm9wYWNpdHk7XHJcbiAgICAgICAgLy8gJHNjb3BlLnNlbGVjdGVkU2hhcGVbJ3dpZHRoJ10gPSBvYmoud2lkdGg7XHJcbiAgICAgICAgLy8gJHNjb3BlLnNlbGVjdGVkU2hhcGVbJ3N0cm9rZVdpZHRoJ10gPSBvYmouc3Ryb2tlV2lkdGg7XHJcbiAgICAgICAgLy8gJHNjb3BlLnNlbGVjdGVkU2hhcGVbJ3N0cm9rZSddID0gb2JqLnN0cm9rZTtcclxuICAgICAgICAvLyAkc2NvcGUuc2VsZWN0ZWRTaGFwZVsnc2hhZG93J10gPSBvYmouc2hhZG93O1xyXG5cclxuICAgIH07XHJcblxyXG4gICAgLy8gY2FudmFzLmZhYnJpYy5vbignb2JqZWN0OnNlbGVjdGVkJywgZnVuY3Rpb24ob2JqZWN0KSB7XHJcbiAgICAvLyAgICAgaWYgKCRyb290U2NvcGUuYWN0aXZlVGFiICE9PSAnc2ltcGxlLXNoYXBlcycpIHJldHVybjtcclxuICAgIC8vICAgICBzaW1wbGVTaGFwZXMuc2VsZWN0U2hhcGUob2JqZWN0LnRhcmdldC5uYW1lKTtcclxuICAgIC8vIH0pO1xyXG59XSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ0ltYWdlRWRpdG9yJylcclxuXHJcbi5jb250cm9sbGVyKCdQaG90b0NvbnRyb2xsZXInLCBbJyRyb290U2NvcGUnLCAnJHNjb3BlJywgJyRtZERpYWxvZycsICckbWRUb2FzdCcsICckJHJBRicsICdjYW52YXMnLCAnaGlzdG9yeScsICdzZXR0aW5ncycsICdzYXZlcicsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJG1kRGlhbG9nLCAkbWRUb2FzdCwgJCRyQUYsIGNhbnZhcywgaGlzdG9yeSwgc2V0dGluZ3MsIHNhdmVyKSB7XHJcblxyXG4gICAgJHNjb3BlLmhpc3RvcnkgPSBoaXN0b3J5O1xyXG5cclxuICAgICRzY29wZS5pc0RlbW8gPSAkcm9vdFNjb3BlLmlzRGVtbztcclxuICAgICRzY29wZS5jYW5PcGVuSW1hZ2UgPSBmYWxzZTtcclxuICAgICRzY29wZS5jYW52YXMgPSBjYW52YXM7XHJcbiAgICAkc2NvcGUub3BlbkltYWdlTW9kZSA9ICdvcGVuJztcclxuXHJcbiAgICAkc2NvcGUuY2FudmFzV2lkdGggPSA4MDA7XHJcbiAgICAkc2NvcGUuY2FudmFzSGVpZ2h0ID0gNjAwO1xyXG5cclxuICAgICRzY29wZS5pbWFnZU5hbWUgPSAnaW1hZ2UnO1xyXG4gICAgJHNjb3BlLmltYWdlVHlwZSA9ICdqcGVnJztcclxuICAgICRzY29wZS5pbWFnZVF1YWxpdHkgPSA4O1xyXG5cclxuICAgICRzY29wZS5vYmplY3RzUGFuZWxPcGVuID0gdHJ1ZTtcclxuICAgICRzY29wZS5oaXN0b3J5UGFuZWxPcGVuID0gZmFsc2U7XHJcblxyXG4gICAgJHJvb3RTY29wZS4kb24oJ3NldHRpbmdzLnJlYWR5JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHBob3RvcyA9IHNldHRpbmdzLmdldCgncGhvdG9zJyk7XHJcblxyXG4gICAgICAgIGZvciAodmFyIGkgPSBwaG90b3MubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuICAgICAgICAgICAgcGhvdG9zW2ldLml0ZW1zID0gbmV3IEFycmF5KHBob3Rvc1tpXS5pdGVtcyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnBob3RvcyA9IHBob3RvcztcclxuICAgIH0pO1xyXG5cclxuICAgICRzY29wZS5hY3RpdmVQaG90b0NhdGVnb3J5ID0gJ3VzZXInO1xyXG5cclxuICAgICRzY29wZS5zZXRBY3RpdmVQaG90b0NhdGVnb3J5ID0gZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgIGlmICgkc2NvcGUuYWN0aXZlUGhvdG9DYXRlZ29yeSA9PT0gbmFtZSkge1xyXG4gICAgICAgICAgICAkc2NvcGUuYWN0aXZlUGhvdG9DYXRlZ29yeSA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICRzY29wZS5hY3RpdmVQaG90b0NhdGVnb3J5ID0gbmFtZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5vcGVuVXBsb2FkRGlhbG9nID0gZnVuY3Rpb24oJGV2ZW50KSB7XHJcbiAgICAgICAgJG1kRGlhbG9nLnNob3coe1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJCgnI21haW4taW1hZ2UtdXBsb2FkLWRpYWxvZy10ZW1wbGF0ZScpLmh0bWwoKSxcclxuICAgICAgICAgICAgdGFyZ2V0RXZlbnQ6ICRldmVudCxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Bob3RvQ29udHJvbGxlcicsXHJcbiAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS50cmFuc2Zvcm1PcGVuID0gZnVuY3Rpb24obmFtZSwgZSkge1xyXG4gICAgICAgIHZhciBwYW5lbCA9ICQoJyMnK25hbWUpO1xyXG5cclxuICAgICAgICBwYW5lbC5yZW1vdmVDbGFzcygndHJhbnNpdGlvbi1vdXQgdHJhbnNpdGlvbi1pbicpLnNob3coKTtcclxuICAgICAgICAkc2NvcGUudHJhbnNmb3JtVG9DbGlja0VsZW1lbnQocGFuZWwsIGUpO1xyXG5cclxuICAgICAgICAkJHJBRihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcGFuZWwuYWRkQ2xhc3MoJ3RyYW5zaXRpb24taW4nKS5jc3MoJ3RyYW5zZm9ybScsICcnKTtcclxuICAgICAgICAgICAgZS5jdXJyZW50VGFyZ2V0LmJsdXIoKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLnRyYW5zZm9ybUNsb3NlID0gZnVuY3Rpb24obmFtZSwgZSkge1xyXG4gICAgICAgIHZhciBwYW5lbCA9ICQoJyMnK25hbWUpO1xyXG5cclxuICAgICAgICBwYW5lbC5hZGRDbGFzcygndHJhbnNpdGlvbi1vdXQnKS5yZW1vdmVDbGFzcygndHJhbnNpdGlvbi1pbicpO1xyXG4gICAgICAgICRzY29wZS50cmFuc2Zvcm1Ub0NsaWNrRWxlbWVudChwYW5lbCwgZSk7XHJcblxyXG4gICAgICAgIHBhbmVsLm9uZSgkcm9vdFNjb3BlLnRyYW5zaXRpb25FbmRFdmVudCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHBhbmVsLmhpZGUoKS5jc3MoJ3RyYW5zZm9ybScsICcnKS5yZW1vdmVDbGFzcygndHJhbnNpdGlvbi1vdXQnKTtcclxuICAgICAgICAgICAgZS5jdXJyZW50VGFyZ2V0LmJsdXIoKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLnRyYW5zZm9ybVRvQ2xpY2tFbGVtZW50ID0gZnVuY3Rpb24ocGFuZWwsIGUpIHtcclxuICAgICAgICB2YXIgY2xpY2tSZWN0ID0gZS50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgdmFyIHBhbmVsUmVjdCA9IHBhbmVsWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuICAgICAgICB2YXIgc2NhbGVYID0gTWF0aC5taW4oMC41LCBjbGlja1JlY3Qud2lkdGggLyBwYW5lbFJlY3Qud2lkdGgpO1xyXG4gICAgICAgIHZhciBzY2FsZVkgPSBNYXRoLm1pbigwLjUsIGNsaWNrUmVjdC5oZWlnaHQgLyBwYW5lbFJlY3QuaGVpZ2h0KTtcclxuXHJcbiAgICAgICAgcGFuZWwuY3NzKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlM2QoJyArXHJcbiAgICAgICAgICAgICgtcGFuZWxSZWN0LmxlZnQgKyBjbGlja1JlY3QubGVmdCArIGNsaWNrUmVjdC53aWR0aC8yIC0gcGFuZWxSZWN0LndpZHRoLzIpICsgJ3B4LCcgK1xyXG4gICAgICAgICAgICAoLXBhbmVsUmVjdC50b3AgKyBjbGlja1JlY3QudG9wICsgY2xpY2tSZWN0LmhlaWdodC8yIC0gcGFuZWxSZWN0LmhlaWdodC8yKSArICdweCwnICtcclxuICAgICAgICAgICAgJzApIHNjYWxlKCcgKyBzY2FsZVggKyAnLCcgKyBzY2FsZVkgKyAnKSdcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuXHJcblxyXG4gICAgJHNjb3BlLm9wZW5TYW1wbGVJbWFnZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNhbnZhcy5sb2FkTWFpbkltYWdlKCdhc3NldHMvaW1hZ2VzL2xvdHVzLmpwZycpO1xyXG4gICAgICAgICRzY29wZS5jbG9zZVVwbG9hZERpYWxvZygpO1xyXG4gICAgICAgICRyb290U2NvcGUuc3RhcnRlZCA9IHRydWU7XHJcbiAgICB9O1xyXG5cclxuXHJcbiAgICAkc2NvcGUuc2hvd0ltYWdlUHJldmlldyA9IGZ1bmN0aW9uKHVybCkge1xyXG4gICAgICAgIHZhciBoaXN0b3J5T2JqZWN0ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGhpc3RvcnlPYmplY3QgPSBKU09OLnBhcnNlKHVybCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAvL1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGhpc3RvcnlPYmplY3QgJiYgaGlzdG9yeU9iamVjdC5zdGF0ZSkge1xyXG4gICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNhbk9wZW5JbWFnZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuY2xlYXIoKTtcclxuICAgICAgICAgICAgaGlzdG9yeS5sb2FkKGhpc3RvcnlPYmplY3QpO1xyXG4gICAgICAgICAgICAkc2NvcGUuY2xvc2VVcGxvYWREaWFsb2coKTtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5zdGFydGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZmFicmljLnV0aWwubG9hZEltYWdlKHVybCwgZnVuY3Rpb24oaW1hZ2UpIHtcclxuICAgICAgICAgICAgaWYgKGltYWdlKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy5pbWctcHJldmlldycpLmh0bWwoJycpLmFwcGVuZChpbWFnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhbk9wZW5JbWFnZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhbk9wZW5JbWFnZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLm9wZW5JbWFnZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciB1cmwgPSAkKCcuaW1nLXByZXZpZXcgaW1nJykuYXR0cignc3JjJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIGlmICggISB1cmwgfHwgISAkc2NvcGUuY2FuT3BlbkltYWdlKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmICgoIWNhbnZhcy5mYWJyaWMuX29iamVjdHMubGVuZ3RoIHx8ICEgY2FudmFzLm1haW5JbWFnZSkgJiYgISAkcm9vdFNjb3BlLnVzZXJQcmVzZXQpIHtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5jbGVhcigpO1xyXG4gICAgICAgICAgICBjYW52YXMubG9hZE1haW5JbWFnZSh1cmwpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNhbnZhcy5vcGVuSW1hZ2UodXJsKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS5jbG9zZVVwbG9hZERpYWxvZygpO1xyXG4gICAgICAgICRyb290U2NvcGUuc3RhcnRlZCA9IHRydWU7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5jbG9zZVVwbG9hZERpYWxvZyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICRzY29wZS5jYW5VcGxvYWRJbWFnZSA9IGZhbHNlO1xyXG4gICAgICAgICRzY29wZS5vcGVuSW1hZ2VNb2RlID0gJ29wZW4nO1xyXG4gICAgICAgICQoJy5pbWctcHJldmlldycpLmh0bWwoKTtcclxuICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xyXG4gICAgfTtcclxuXHJcblxyXG4gICAgJHNjb3BlLmFkZFRvQ2FudmFzID0gZnVuY3Rpb24oY2F0ZWdvcnksIGluZGV4LCBlKSB7XHJcbiAgICAgICAgaWYgKCRzY29wZS5sb2FkaW5nKSByZXR1cm47XHJcbiAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSB0cnVlO1xyXG4gICAgICAgIC8vJHNjb3BlLm9wZW5QYW5lbCgncGhvdG9zJywgZSk7XHJcbiAgICAgICAgdmFyIGltZ191cmwgPSAnYXNzZXRzL2ltYWdlcy9waG90b3MvJytjYXRlZ29yeS5uYW1lKycvJytpbmRleCsnLicrY2F0ZWdvcnkudHlwZTtcclxuICAgICAgICAvLyB2YXIgaHR0cCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gICAgICAgIC8vIGh0dHAub3BlbignSEVBRCcsIGltZ191cmwsIGZhbHNlKTtcclxuICAgICAgICAvLyBodHRwLnNlbmQoKTtcclxuICAgICAgICAvLyBpZihodHRwLnN0YXR1cz09NDA0KSBpbWdfdXJsID0gJ2Fzc2V0cy9pbWFnZXMvcGhvdG9zLycrY2F0ZWdvcnkubmFtZSsnLycraW5kZXgrJy4nK2NhdGVnb3J5LnR5cGU7XHJcbiAgICAgICAgZmFicmljLnV0aWwubG9hZEltYWdlKCBpbWdfdXJsLCBmdW5jdGlvbihpbWcpIHtcclxuICAgICAgICAgICAgdmFyIGltYWdlID0gbmV3IGZhYnJpYy5JbWFnZShpbWcpO1xyXG4gICAgICAgICAgICBhZnRlckFkZFBob3RvVG9DYW52YXMoaW1hZ2UpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNhbnZhcy5maXRUb1NjcmVlbigpOyBcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBhZnRlckFkZFBob3RvVG9DYW52YXMoaW1hZ2UpIHtcclxuICAgICAgICBpbWFnZS5uYW1lID0gJ3Bob3RvJztcclxuICAgICAgICBjYW52YXMuZmFicmljLmFkZChpbWFnZSk7XHJcbiAgICAgICAgaW1hZ2Uuc2NhbGVUb0hlaWdodCgoNTAgLyAxMDApICogY2FudmFzLm9yaWdpbmFsLmhlaWdodCk7XHJcblxyXG4gICAgICAgIGltYWdlLmNlbnRlcigpO1xyXG4gICAgICAgIGltYWdlLnNldENvb3JkcygpO1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMuc2V0QWN0aXZlT2JqZWN0KGltYWdlKTtcclxuICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgICAgICRyb290U2NvcGUuYWN0aXZlT2JqZWN0ID0gaW1hZ2U7XHJcblxyXG4gICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGhpc3RvcnkuYWRkKCdBZGRlZDogUGhvdG8nLCAnZmF2b3JpdGUnKTtcclxuICAgIH1cclxuXHJcbn1dKTtcclxuXHJcblxyXG5cclxuIiwiYW5ndWxhci5tb2R1bGUoJ2ltYWdlLnNoYXBlcycpXG5cbi5kaXJlY3RpdmUoJ2VkUGhvdG9zQ2F0ZWdvcmllcycsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSwgZWwpIHtcblxuICAgICAgICAgICAgLy9sb2FkIHBob3RvIGltYWdlcyBpbnRvIG9wZW4gY2F0ZWdvcnkgd2hlbiBwaG90b3MgdGFiIGlzIG9wZW5lZFxuICAgICAgICAgICAgdmFyIHVuYmluZCA9ICRzY29wZS4kd2F0Y2goJ2FjdGl2ZVRhYicsIGZ1bmN0aW9uKG5ld1RhYikge1xuICAgICAgICAgICAgICAgIGlmIChuZXdUYWIgIT09ICdwaG90b3MnKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICB2YXIgY2F0ID0gJCgnLmNhdGVnb3J5LXBob3Rvcy5vcGVuJyk7XG5cbiAgICAgICAgICAgICAgICBjYXQuZmluZCgnaW1nJykuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zcmMgPSB0aGlzLmRhdGFzZXQuc3JjO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgY2F0LnBhcmVudCgpLmFkZENsYXNzKCdsb2FkZWQnKTtcblxuICAgICAgICAgICAgICAgIHVuYmluZCgpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vbG9hZCBwaG90byBpbWFnZXMgZm9yIHRoZSBjYXRlZ29yeSB0aGF0IGp1c3QgYmVlbiBvcGVuZWRcbiAgICAgICAgICAgIGVsLm9uKCdjbGljaycsICcuY2F0ZWdvcnktaGVhZGVyJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zZXRBY3RpdmVQaG90b0NhdGVnb3J5KGUudGFyZ2V0LmRhdGFzZXQubmFtZSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgY2F0ZWdvcnkgPSAkKGUuY3VycmVudFRhcmdldCkucGFyZW50KCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoICEgY2F0ZWdvcnkuaGFzQ2xhc3MoJ2xvYWRlZCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5LmFkZENsYXNzKCdsb2FkZWQnKS5maW5kKCdpbWcnKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcmMgPSB0aGlzLmRhdGFzZXQuc3JjO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgXHR9XG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnaW1hZ2Uuc2hhcGVzJylcclxuXHJcbi5jb250cm9sbGVyKCdTdGlja2Vyc0NvbnRyb2xsZXInLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ2NhbnZhcycsICdzaW1wbGVTaGFwZXMnLCAnaGlzdG9yeScsICdzZXR0aW5ncycsIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgY2FudmFzLCBzaW1wbGVTaGFwZXMsIGhpc3RvcnksIHNldHRpbmdzKSB7XHJcblx0JHNjb3BlLnNoYXBlcyA9IHNpbXBsZVNoYXBlcztcclxuICAgICRzY29wZS5vcGFjaXR5ID0gMC45O1xyXG5cclxuICAgICRyb290U2NvcGUuJG9uKCdzZXR0aW5ncy5yZWFkeScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzdGlja2VycyA9IHNldHRpbmdzLmdldCgnc3RpY2tlcnMnKTtcclxuXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IHN0aWNrZXJzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgICAgICAgIHN0aWNrZXJzW2ldLml0ZW1zID0gbmV3IEFycmF5KHN0aWNrZXJzW2ldLml0ZW1zKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUuY2F0ZWdvcmllcyA9IHN0aWNrZXJzO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJHNjb3BlLmFjdGl2ZUNhdGVnb3J5ID0gJ2Rvb2RsZXMnO1xyXG5cclxuICAgICRzY29wZS5hY3RpdmVTdGlja2VySXNTdmcgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgb2JqID0gY2FudmFzLmZhYnJpYy5nZXRBY3RpdmVPYmplY3QoKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIG9iaiAmJiBhbmd1bGFyLmlzRGVmaW5lZChvYmouc3ZnVWlkKTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLmlzUGFuZWxFbmFibGVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIG9iaiA9IGNhbnZhcy5mYWJyaWMuZ2V0QWN0aXZlT2JqZWN0KCk7XHJcbiAgICAgICAgcmV0dXJuIG9iaiAmJiBvYmoubmFtZSA9PT0gJ3N0aWNrZXInICYmICRyb290U2NvcGUuYWN0aXZlVGFiID09PSAnc3RpY2tlcnMnO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuc2V0QWN0aXZlQ2F0ZWdvcnkgPSBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgaWYgKCRzY29wZS5hY3RpdmVDYXRlZ29yeSA9PT0gbmFtZSkge1xyXG4gICAgICAgICAgICAkc2NvcGUuYWN0aXZlQ2F0ZWdvcnkgPSBmYWxzZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkc2NvcGUuYWN0aXZlQ2F0ZWdvcnkgPSBuYW1lO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLnNldE9wYWNpdHkgPSBmdW5jdGlvbihvcGFjaXR5KSB7XHJcbiAgICAgICAgc2ltcGxlU2hhcGVzLmdldFNoYXBlKCdzdGlja2VyJykuc2V0T3BhY2l0eShvcGFjaXR5KTtcclxuICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuc2V0Q29sb3IgPSBmdW5jdGlvbihjb2xvcikge1xyXG4gICAgICAgIHZhciBvYmogPSBzaW1wbGVTaGFwZXMuZ2V0U2hhcGUoJ3N0aWNrZXInKTtcclxuXHJcbiAgICAgICAgaWYgKG9iai5pc1NhbWVDb2xvciAmJiBvYmouaXNTYW1lQ29sb3IoKSB8fCAhIG9iai5wYXRocykge1xyXG4gICAgICAgICAgICBvYmouc2V0RmlsbChjb2xvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG9iai5wYXRocykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9iai5wYXRocy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgb2JqLnBhdGhzW2ldLnNldEZpbGwoY29sb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuYWRkVG9DYW52YXMgPSBmdW5jdGlvbihjYXRlZ29yeSwgaW5kZXgsIGUpIHtcclxuICAgICAgICBpZiAoJHNjb3BlLmxvYWRpbmcpIHJldHVybjtcclxuICAgICAgICAkc2NvcGUubG9hZGluZyA9IHRydWU7XHJcbiAgICAgICAgJHNjb3BlLm9wZW5QYW5lbCgnc3RpY2tlcnMnLCBlKTtcclxuXHJcbiAgICAgICAgaWYgKGNhdGVnb3J5LnR5cGUgPT09ICdzdmcnKSB7XHJcbiAgICAgICAgICAgIGZhYnJpYy5sb2FkU1ZHRnJvbVVSTCgnYXNzZXRzL2ltYWdlcy9zdGlja2Vycy8nK2NhdGVnb3J5Lm5hbWUrJy8nK2luZGV4KycuJytjYXRlZ29yeS50eXBlLCBmdW5jdGlvbiAob2JqZWN0cywgb3B0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGltYWdlID0gZmFicmljLnV0aWwuZ3JvdXBTVkdFbGVtZW50cyhvYmplY3RzLCBvcHRpb25zKTtcclxuICAgICAgICAgICAgICAgIGFmdGVyQWRkU3RpY2tlclRvQ2FudmFzKGltYWdlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZmFicmljLnV0aWwubG9hZEltYWdlKCdhc3NldHMvaW1hZ2VzL3N0aWNrZXJzLycrY2F0ZWdvcnkubmFtZSsnLycraW5kZXgrJy4nK2NhdGVnb3J5LnR5cGUsIGZ1bmN0aW9uKGltZykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGltYWdlID0gbmV3IGZhYnJpYy5JbWFnZShpbWcpO1xyXG4gICAgICAgICAgICAgICAgYWZ0ZXJBZGRTdGlja2VyVG9DYW52YXMoaW1hZ2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gYWZ0ZXJBZGRTdGlja2VyVG9DYW52YXMoaW1hZ2UpIHtcclxuICAgICAgICBpbWFnZS5uYW1lID0gJ3N0aWNrZXInO1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMuYWRkKGltYWdlKTtcclxuICAgICAgICBpbWFnZS5zY2FsZVRvSGVpZ2h0KCg0MCAvIDEwMCkgKiBjYW52YXMub3JpZ2luYWwuaGVpZ2h0KTtcclxuXHJcbiAgICAgICAgaW1hZ2UuY2VudGVyKCk7XHJcbiAgICAgICAgaW1hZ2Uuc2V0Q29vcmRzKCk7XHJcbiAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3QoaW1hZ2UpO1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcblxyXG4gICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVPYmplY3QgPSBpbWFnZTtcclxuICAgICAgICBoaXN0b3J5LmFkZCgnQWRkZWQ6IFN0aWNrZXInLCAnZmF2b3JpdGUnKTtcclxuICAgIH1cclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5zaGFwZXMnKVxuXG4uZGlyZWN0aXZlKCdlZFN0aWNrZXJzQ2F0ZWdvcmllcycsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSwgZWwpIHtcblxuICAgICAgICAgICAgLy9sb2FkIHN0aWNrZXIgaW1hZ2VzIGludG8gb3BlbiBjYXRlZ29yeSB3aGVuIHN0aWNrZXJzIHRhYiBpcyBvcGVuZWRcbiAgICAgICAgICAgIHZhciB1bmJpbmQgPSAkc2NvcGUuJHdhdGNoKCdhY3RpdmVUYWInLCBmdW5jdGlvbihuZXdUYWIpIHtcbiAgICAgICAgICAgICAgICBpZiAobmV3VGFiICE9PSAnc3RpY2tlcnMnKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICB2YXIgY2F0ID0gJCgnLmNhdGVnb3J5LXN0aWNrZXJzLm9wZW4nKTtcblxuICAgICAgICAgICAgICAgIGNhdC5maW5kKCdpbWcnKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNyYyA9IHRoaXMuZGF0YXNldC5zcmM7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBjYXQucGFyZW50KCkuYWRkQ2xhc3MoJ2xvYWRlZCcpO1xuXG4gICAgICAgICAgICAgICAgdW5iaW5kKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy9sb2FkIHN0aWNrZXIgaW1hZ2VzIGZvciB0aGUgY2F0ZWdvcnkgdGhhdCBqdXN0IGJlZW4gb3BlbmVkXG4gICAgICAgICAgICBlbC5vbignY2xpY2snLCAnLmNhdGVnb3J5LWhlYWRlcicsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2V0QWN0aXZlQ2F0ZWdvcnkoZS50YXJnZXQuZGF0YXNldC5uYW1lKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHZhciBjYXRlZ29yeSA9ICQoZS5jdXJyZW50VGFyZ2V0KS5wYXJlbnQoKTtcblxuICAgICAgICAgICAgICAgIGlmICggISBjYXRlZ29yeS5oYXNDbGFzcygnbG9hZGVkJykpIHtcbiAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnkuYWRkQ2xhc3MoJ2xvYWRlZCcpLmZpbmQoJ2ltZycpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNyYyA9IHRoaXMuZGF0YXNldC5zcmM7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICBcdH1cbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5zaGFwZXMnKVxyXG5cclxuLmZpbHRlcignb3JkZXJPcHRpb25zJywgZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24oaXRlbXMsIGZpZWxkLCByZXZlcnNlKSB7XHJcbiAgICAgICAgdmFyIGZpbHRlcmVkID0gW107XHJcbiAgICAgICAgYW5ndWxhci5mb3JFYWNoKGl0ZW1zLCBmdW5jdGlvbihpdGVtLCBrZXkpIHtcclxuICAgICAgICAgICAgaXRlbS5uYW1lID0ga2V5O1xyXG4gICAgICAgICAgICBmaWx0ZXJlZC5wdXNoKGl0ZW0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGZpbHRlcmVkLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChhW2ZpZWxkXSA+IGJbZmllbGRdID8gMSA6IC0xKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZihyZXZlcnNlKSBmaWx0ZXJlZC5yZXZlcnNlKCk7XHJcblxyXG4gICAgICAgIHJldHVybiBmaWx0ZXJlZDtcclxuICAgIH07XHJcbn0pXHJcblxyXG4uc2VydmljZSgnc2ltcGxlU2hhcGVzJywgWyckcm9vdFNjb3BlJywgJ2NhbnZhcycsICdwb2x5Z29uJywgJ2hpc3RvcnknLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgY2FudmFzLCBwb2x5Z29uLCBoaXN0b3J5KSB7XHJcblxyXG4gICAgdmFyIHNoYXBlcyA9IHtcclxuXHJcbiAgICAgICAgZ3JhZGllbnRzOiBlZEdyYWRpZW50cyxcclxuXHJcbiAgICAgICAgdGV4dHVyZXM6IG5ldyBBcnJheSgyOCksXHJcblxyXG4gICAgICAgIGJhc2VPcHRpb25zOiB7XHJcbiAgICAgICAgICAgIG1haW46IHtcclxuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiB7IHR5cGU6ICdzbGlkZXInLCBjdXJyZW50OiAxLCBtaW46IDAuMSwgbWF4OiAxLCBzdGVwOiAwLjEgfSxcclxuICAgICAgICAgICAgICAgIGZpbGw6IHsgdHlwZTogJ2NvbG9ycGlja2VyJywgY3VycmVudDogJyMyNjMyMzgnLCBoaWRkZW46IHRydWUgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBib3JkZXI6IHtcclxuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgb25Ub2dnbGU6ICd0b2dnbGVCb3JkZXInLFxyXG4gICAgICAgICAgICAgICAgc3Ryb2tlOiB7IHR5cGU6ICdjb2xvcnBpY2tlcicsIGN1cnJlbnQ6ICcjMjE5NkYzJywgZGlzcGxheU5hbWU6ICdDb2xvcicgfSxcclxuICAgICAgICAgICAgICAgIHN0cm9rZVdpZHRoOiB7IHR5cGU6ICdzbGlkZXInLCBjdXJyZW50OiA1LCBtYXg6IDQwLCBkaXNwbGF5TmFtZTogJ1dpZHRoJyB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNoYWRvdzoge1xyXG4gICAgICAgICAgICAgICAgZW5hYmxlZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBvblRvZ2dsZTogJ3RvZ2dsZVNoYWRvdycsXHJcbiAgICAgICAgICAgICAgICBjb2xvcjogeyB0eXBlOiAnY29sb3JwaWNrZXInLCBjdXJyZW50OiAncmdiYSgwLDAsMCwwLjUpJ30sXHJcbiAgICAgICAgICAgICAgICBibHVyOiB7IHR5cGU6ICdzbGlkZXInLCBjdXJyZW50OiA1LCBtYXg6IDgwIH0sXHJcbiAgICAgICAgICAgICAgICBvZmZzZXRYOiB7IHR5cGU6ICdzbGlkZXInLCBjdXJyZW50OiA4LCBtYXg6IDMwIH0sXHJcbiAgICAgICAgICAgICAgICBvZmZzZXRZOiB7IHR5cGU6ICdzbGlkZXInLCBjdXJyZW50OiA1LCBtYXg6IDMwIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGF2YWlsYWJsZTogW10sXHJcblxyXG4gICAgICAgIHNlbGVjdGVkOiBmYWxzZSxcclxuICAgICAgICBzZWxlY3RlZFNoYXBlOiBmYWxzZSxcclxuXHJcbiAgICAgICAgZmlsbFdpdGhHcmFkaWVudDogZnVuY3Rpb24oaW5kZXgsIHR5cGUpIHtcclxuICAgICAgICAgICAgdmFyIHNoYXBlID0gY2FudmFzLmZhYnJpYy5nZXRBY3RpdmVPYmplY3QoKTtcclxuXHJcbiAgICAgICAgICAgIHNoYXBlLnNldEdyYWRpZW50KHR5cGV8fCdmaWxsJywgdGhpcy5ncmFkaWVudHNbaW5kZXhdKTtcclxuXHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZmlsbFdpdGhJbWFnZTogZnVuY3Rpb24odXJsKSB7XHJcbiAgICAgICAgICAgIHZhciBzaGFwZSA9IGNhbnZhcy5mYWJyaWMuZ2V0QWN0aXZlT2JqZWN0KCk7XHJcblxyXG4gICAgICAgICAgICBmYWJyaWMudXRpbC5sb2FkSW1hZ2UodXJsLCBmdW5jdGlvbihpbWcpIHtcclxuICAgICAgICAgICAgICAgIHNoYXBlLnNldFBhdHRlcm5GaWxsKHsgc291cmNlOiBpbWcgfSk7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBhZGRUb0NhbnZhczogZnVuY3Rpb24oc2hhcGUpIHtcclxuICAgICAgICAgICAgaWYgKCAhIHRoaXMuc2hhcGVFeGlzdHMoc2hhcGUpKSByZXR1cm47XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWQgPSBzaGFwZTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coc2hhcGUpO1xyXG4gICAgICAgICAgICBqUXVlcnkoXCIjc2hhcGVCZ0NvbG9yXCIpLnNwZWN0cnVtKFwic2V0XCIsIHNoYXBlLmZpbGwpO1xyXG4gICAgICAgICAgICAvLyBpZihzaGFwZS5zdHJva2UpIGpRdWVyeShcIiNib3JkZXJzdHJva2VcIikuc3BlY3RydW0oXCJzZXRcIiwgc2hhcGUuc3Ryb2tlLmNvbG9yKTtcclxuICAgICAgICAgICAgLy8gaWYoc2hhcGUuc2hhZG93KSBqUXVlcnkoXCIjc2hhZG93Y29sb3JcIikuc3BlY3RydW0oXCJzZXRcIiwgc2hhcGUuc2hhZG93LmNvbG9yKTtcclxuXHJcbiAgICAgICAgICAgIC8vd2UgbWlnaHQgbmVlZCB0byBlbmFibGUgYSBkcmF3aW5nIG1vZGUgaW5zdGVhZFxyXG4gICAgICAgICAgICAvL29mIGFkZGVkIGEgc2hhcGUgdG8gY2FudmFzIGlmIHdlIGdldCBwYXNzZWQgcG9seWdvblxyXG4gICAgICAgICAgICBpZiAoc2hhcGUuc2VydmljZSAmJiBzaGFwZS5zZXJ2aWNlLmVuYWJsZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNoYXBlLnNlcnZpY2UuZW5hYmxlKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBmYWJyaWNTaGFwZSA9IHRoaXMuY3JlYXRlTmV3U2hhcGUoc2hhcGUpO1xyXG5cclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5hZGQoZmFicmljU2hhcGUpO1xyXG4gICAgICAgICAgICBjYW52YXMuY2VudGVyKGZhYnJpY1NoYXBlKTtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3QoZmFicmljU2hhcGUpO1xyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkU2hhcGUgPSBmYWJyaWNTaGFwZTtcclxuXHJcbiAgICAgICAgICAgIGhpc3RvcnkuYWRkKCdBZGRlZDogJytzaGFwZS5uYW1lLCAncGFub3JhbWEtdmVydGljYWwnKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBhcHBseVZhbHVlOiBmdW5jdGlvbihncm91cCwgbmFtZSwgb3B0aW9uLCB2YWx1ZSkge1xyXG4gICAgICAgICAgICB2YXIgc2V0dGVyID0gJ3NldCcrZmFicmljLnV0aWwuc3RyaW5nLmNhcGl0YWxpemUob3B0aW9uLCB0cnVlKSxcclxuICAgICAgICAgICAgICAgIHNoYXBlICA9IHRoaXMuZ2V0U2hhcGUobmFtZSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoZ3JvdXAgPT09ICdzaGFkb3cnKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hcHBseVNoYWRvd1ZhbHVlKHNoYXBlLCBvcHRpb24sIHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWQgJiYgdGhpcy5zZWxlY3RlZC5uYW1lID09PSBuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzZXR0ZXIpO1xyXG4gICAgICAgICAgICAgICAgLy91c2Ugc2V0dGVyIGlmIGF2YWlsYWJsZSwgb3RoZXIgc2ltcGx5IGFzc2lnbiB0aGUgdmFsdWVcclxuICAgICAgICAgICAgICAgIHNoYXBlW3NldHRlcl0gPyBzaGFwZVtzZXR0ZXJdKHZhbHVlKSA6IHNoYXBlW29wdGlvbl0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIHNoYXBlLnNldENvb3JkcygpO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3Qoc2hhcGUpO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGFwcGx5U2hhZG93VmFsdWU6IGZ1bmN0aW9uKHNoYXBlLCBvcHRpb24sIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGlmICggISBzaGFwZSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgICBjb2xvcjogdGhpcy5zZWxlY3RlZC5vcHRpb25zLnNoYWRvdy5jb2xvci5jdXJyZW50LFxyXG4gICAgICAgICAgICAgICAgYmx1cjogdGhpcy5zZWxlY3RlZC5vcHRpb25zLnNoYWRvdy5ibHVyLmN1cnJlbnQsXHJcbiAgICAgICAgICAgICAgICBvZmZzZXRYOiB0aGlzLnNlbGVjdGVkLm9wdGlvbnMuc2hhZG93Lm9mZnNldFguY3VycmVudCxcclxuICAgICAgICAgICAgICAgIG9mZnNldFk6IHRoaXMuc2VsZWN0ZWQub3B0aW9ucy5zaGFkb3cub2Zmc2V0WS5jdXJyZW50XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBpZiAob3B0aW9uICYmIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBvcHRpb25zW29wdGlvbl0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2hhcGUuc2V0U2hhZG93KG9wdGlvbnMpO1xyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHRvZ2dsZVNoYWRvdzogZnVuY3Rpb24obmFtZSwgb24pIHtcclxuICAgICAgICAgICAgaWYgKG9uKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFwcGx5U2hhZG93VmFsdWUodGhpcy5nZXRTaGFwZShuYW1lKSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldFNoYXBlKG5hbWUpLnNldFNoYWRvdyhmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVG9nZ2xlIGJvcmRlciBvbi9vZmYgb24gYWN0aXZlIG9iamVjdCBpbiB0aGUgY2FudmFzLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIG5hbWVcclxuICAgICAgICAgKiBAcGFyYW0gb25cclxuICAgICAgICAgKi9cclxuICAgICAgICB0b2dnbGVCb3JkZXI6IGZ1bmN0aW9uKG5hbWUsIG9uKSB7XHJcbiAgICAgICAgICAgIGlmIChvbikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRTaGFwZShuYW1lKS5zZXRTdHJva2UodGhpcy5zZWxlY3RlZC5vcHRpb25zLmJvcmRlci5zdHJva2UpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRTaGFwZShuYW1lKS5zZXRTdHJva2UoZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHNoYXBlRXhpc3RzOiBmdW5jdGlvbihzaGFwZSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuYXZhaWxhYmxlLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hdmFpbGFibGVbaV0ubmFtZSA9PT0gc2hhcGUubmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogUmV0dXJuIGEgZmlyc3QgYXZhaWxhYmxlIGZhYnJpYyBvYmplY3QgdGhhdCBtYXRjaGVzIGdpdmVuIG5hbWUuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gbmFtZVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtmYWJyaWMuT2JqZWN0fCp9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0U2hhcGU6IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICAgICAgdmFyIGFjdGl2ZSA9IGNhbnZhcy5mYWJyaWMuZ2V0QWN0aXZlT2JqZWN0KCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoYWN0aXZlICYmIGFjdGl2ZS5uYW1lID09PSBuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYWN0aXZlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLmZvckVhY2hPYmplY3QoZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAob2JqLm5hbWUgPT09IG5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLnNldEFjdGl2ZU9iamVjdChvYmopO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3RpdmUgPSBvYmo7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGFjdGl2ZTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDcmVhdGUgbmV3IGZhYnJpYyBzaGFwZSBmcm9tIGdpdmVuIGNvbmZpZyBvYmplY3QuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gc2hhcGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBjcmVhdGVOZXdTaGFwZTogZnVuY3Rpb24oc2hhcGUpIHtcclxuICAgICAgICAgICAgdmFyIHNoYXBlTmFtZSA9IGZhYnJpYy51dGlsLnN0cmluZy5jYXBpdGFsaXplKHNoYXBlLm5hbWUsIHRydWUpO1xyXG5cclxuICAgICAgICAgICAgY29uc29sZS5sb2coc2hhcGUpO1xyXG4gICAgICAgICAgICBpZiAoZmFicmljW3NoYXBlTmFtZV0pIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgICAgICAgICBzdHJva2VXaWR0aDogc2hhcGUub3B0aW9ucy5ib3JkZXIuc3Ryb2tlV2lkdGguY3VycmVudCxcclxuICAgICAgICAgICAgICAgICAgICBmaWxsOiBzaGFwZS5vcHRpb25zLm1haW4uZmlsbC5jdXJyZW50XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzaGFwZS5vcHRpb25zLm1haW4sIGZ1bmN0aW9uKHZhbCwga2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWwgIT09ICdib29sZWFuJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnNba2V5XSA9IHZhbC5jdXJyZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzaGFwZS5vcHRpb25zLnBvaW50cykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdTaGFwZSA9IG5ldyBmYWJyaWNbc2hhcGVOYW1lXShzaGFwZS5vcHRpb25zLnBvaW50cy5jdXJyZW50LCBvcHRpb25zKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld1NoYXBlID0gbmV3IGZhYnJpY1tzaGFwZU5hbWVdKG9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIG5ld1NoYXBlLm5hbWUgPSBzaGFwZS5uYW1lO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXdTaGFwZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHNlbGVjdFNoYXBlOiBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgICAgIGlmICggISBuYW1lIHx8IHRoaXMuc2VsZWN0ZWQubmFtZSA9PT0gbmFtZSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmF2YWlsYWJsZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYXZhaWxhYmxlW2ldLm5hbWUgPT09IG5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3RlZCA9IHRoaXMuYXZhaWxhYmxlW2ldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgY2lyY2xlT3B0aW9ucyA9IGFuZ3VsYXIuY29weShzaGFwZXMuYmFzZU9wdGlvbnMpO1xyXG4gICAgY2lyY2xlT3B0aW9ucy5tYWluLnJhZGl1cyA9IHsgdHlwZTogJ3NsaWRlcicsIGN1cnJlbnQ6IDcyLCBtaW46IDIwIH07XHJcblxyXG4gICAgc2hhcGVzLmF2YWlsYWJsZS5wdXNoKHtcclxuICAgICAgICBuYW1lOiAnY2lyY2xlJyxcclxuICAgICAgICBvcHRpb25zOiBjaXJjbGVPcHRpb25zXHJcbiAgICB9KTtcclxuXHJcbiAgICB2YXIgcmVjdE9wdGlvbnMgPSBhbmd1bGFyLmNvcHkoc2hhcGVzLmJhc2VPcHRpb25zKTtcclxuICAgIHJlY3RPcHRpb25zLm1haW4ud2lkdGggPSB7IHR5cGU6ICdzbGlkZXInLCBjdXJyZW50OiAxNDAgfTtcclxuICAgIHJlY3RPcHRpb25zLm1haW4uaGVpZ2h0ID0geyB0eXBlOiAnc2xpZGVyJywgY3VycmVudDogMTQwIH07XHJcblxyXG4gICAgc2hhcGVzLmF2YWlsYWJsZS5wdXNoKHtcclxuICAgICAgICBuYW1lOiAncmVjdCcsXHJcbiAgICAgICAgZGlzcGxheU5hbWU6ICdyZWN0YW5nbGUnLFxyXG4gICAgICAgIG9wdGlvbnM6IHJlY3RPcHRpb25zXHJcbiAgICB9KTtcclxuXHJcbiAgICB2YXIgdHJpYW5nbGVPcHRpb25zID0gYW5ndWxhci5jb3B5KHNoYXBlcy5iYXNlT3B0aW9ucyk7XHJcbiAgICB0cmlhbmdsZU9wdGlvbnMubWFpbi53aWR0aCA9IHsgdHlwZTogJ3NsaWRlcicsIGN1cnJlbnQ6IDE0MCwgbWluOiAyNSB9O1xyXG4gICAgdHJpYW5nbGVPcHRpb25zLm1haW4uaGVpZ2h0ID0geyB0eXBlOiAnc2xpZGVyJywgY3VycmVudDogMTQwLCBtaW46IDI1IH07XHJcblxyXG4gICAgc2hhcGVzLmF2YWlsYWJsZS5wdXNoKHtcclxuICAgICAgICBuYW1lOiAndHJpYW5nbGUnLFxyXG4gICAgICAgIG9wdGlvbnM6IHRyaWFuZ2xlT3B0aW9uc1xyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIGVsbGlwc2UgPSBhbmd1bGFyLmNvcHkoc2hhcGVzLmJhc2VPcHRpb25zKTtcclxuICAgIGVsbGlwc2UubWFpbi5yeCA9IHsgdHlwZTogJ3NsaWRlcicsIGN1cnJlbnQ6IDgwLCBkaXNwbGF5TmFtZTogJ2hvcml6b250YWwgcmFkaXVzJyB9O1xyXG4gICAgZWxsaXBzZS5tYWluLnJ5ID0geyB0eXBlOiAnc2xpZGVyJywgY3VycmVudDogMzAsIGRpc3BsYXlOYW1lOiAndmVydGljYWwgcmFkaXVzJyB9O1xyXG5cclxuICAgIHNoYXBlcy5hdmFpbGFibGUucHVzaCh7XHJcbiAgICAgICAgbmFtZTogJ2VsbGlwc2UnLFxyXG4gICAgICAgIG9wdGlvbnM6IGVsbGlwc2VcclxuICAgIH0pO1xyXG5cclxuICAgIHNoYXBlcy5hdmFpbGFibGUucHVzaCh7XHJcbiAgICAgICAgbmFtZTogJ3BvbHlnb24nLCAgb3B0aW9uczogYW5ndWxhci5jb3B5KHNoYXBlcy5iYXNlT3B0aW9ucyksIHNlcnZpY2U6IHBvbHlnb25cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBzaGFwZXM7XHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnaW1hZ2Uuc2hhcGVzJylcblxuLnNlcnZpY2UoJ3BvbHlnb24nLCBbJyRyb290U2NvcGUnLCAnJG1kRGlhbG9nJywgJ2NhbnZhcycsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkbWREaWFsb2csIGNhbnZhcykge1xuXG4gICAgdmFyIHNlbGYgPSB7XG5cbiAgICAgICAgbW9kZTogJ2FkZCcsXG4gICAgICAgIGN1cnJlbnRTaGFwZTogZmFsc2UsXG5cbiAgICAgICAgb25Nb3VzZU1vdmU6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICB2YXIgcG9zID0gY2FudmFzLmZhYnJpYy5nZXRQb2ludGVyKGV2ZW50LmUpO1xuICAgICAgICAgICAgaWYgKHNlbGYubW9kZSA9PT0gXCJlZGl0XCIgJiYgc2VsZi5jdXJyZW50U2hhcGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcG9pbnRzID0gc2VsZi5jdXJyZW50U2hhcGUuZ2V0KFwicG9pbnRzXCIpO1xuICAgICAgICAgICAgICAgIHBvaW50c1twb2ludHMubGVuZ3RoIC0gMV0ueCA9IHBvcy54IC0gc2VsZi5jdXJyZW50U2hhcGUuZ2V0KFwibGVmdFwiKTtcbiAgICAgICAgICAgICAgICBwb2ludHNbcG9pbnRzLmxlbmd0aCAtIDFdLnkgPSBwb3MueSAtIHNlbGYuY3VycmVudFNoYXBlLmdldChcInRvcFwiKTtcbiAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRTaGFwZS5zZXQoe1xuICAgICAgICAgICAgICAgICAgICBwb2ludHM6IHBvaW50c1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgb25Nb3VzZURvd246IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICB2YXIgcG9zID0gY2FudmFzLmZhYnJpYy5nZXRQb2ludGVyKGV2ZW50LmUpO1xuXG4gICAgICAgICAgICBpZiAoc2VsZi5tb2RlID09PSBcImFkZFwiKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBvbHkgPSBuZXcgZmFicmljLlBvbHlnb24oW3tcbiAgICAgICAgICAgICAgICAgICAgeDogcG9zLngsXG4gICAgICAgICAgICAgICAgICAgIHk6IHBvcy55XG4gICAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgICAgICB4OiBwb3MueCArIDAuNSxcbiAgICAgICAgICAgICAgICAgICAgeTogcG9zLnkgKyAwLjVcbiAgICAgICAgICAgICAgICB9XSwge1xuICAgICAgICAgICAgICAgICAgICBmaWxsOiAnYmxhY2snLFxuICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RhYmxlOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudFNoYXBlID0gcG9seTtcbiAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRTaGFwZS5uYW1lID0gJ3BvbHlnb24nO1xuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuYWRkKHNlbGYuY3VycmVudFNoYXBlKTtcbiAgICAgICAgICAgICAgICBzZWxmLm1vZGUgPSBcImVkaXRcIjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2VsZi5tb2RlID09PSBcImVkaXRcIiAmJiBzZWxmLmN1cnJlbnRTaGFwZSAmJiBzZWxmLmN1cnJlbnRTaGFwZS50eXBlID09PSBcInBvbHlnb25cIikge1xuICAgICAgICAgICAgICAgIHZhciBwb2ludHMgPSBzZWxmLmN1cnJlbnRTaGFwZS5nZXQoXCJwb2ludHNcIik7XG4gICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICB4OiBwb3MueCAtIHNlbGYuY3VycmVudFNoYXBlLmdldChcImxlZnRcIiksXG4gICAgICAgICAgICAgICAgICAgIHk6IHBvcy55IC0gc2VsZi5jdXJyZW50U2hhcGUuZ2V0KFwidG9wXCIpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50U2hhcGUuc2V0KHtcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRzOiBwb2ludHNcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIG9uRXNjYXBlOiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBpZiAoKCFlICYmIHNlbGYuY3VycmVudFNoYXBlKSB8fCBlICYmIGUua2V5Q29kZSA9PT0gMjcpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5tb2RlID09PSAnZWRpdCcgfHwgc2VsZi5tb2RlID09PSAnYWRkJykge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLm1vZGUgPSAnbm9ybWFsJztcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50U2hhcGUuc2V0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGFibGU6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50U2hhcGUuX2NhbGNEaW1lbnNpb25zKCk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudFNoYXBlLnNldENvb3JkcygpO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuc2V0QWN0aXZlT2JqZWN0KHNlbGYuY3VycmVudFNoYXBlKTtcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLm1vZGUgPSAnYWRkJztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRTaGFwZSA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgb25DbGljazogZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgdmFyIGNsaWNrZWRJbk1vZGFsID0gJChlLnRhcmdldCkuY2xvc2VzdCgnLm1kLWRpYWxvZy1jb250YWluZXInKVswXTtcblxuICAgICAgICAgICAgaWYgKGUudGFyZ2V0Lm5vZGVOYW1lICE9PSAnQ0FOVkFTJyAmJiAkKGUudGFyZ2V0KS5jbG9zZXN0KCcuc2hhcGUnKS5kYXRhKCduYW1lJykgIT09ICdwb2x5Z29uJyAmJiAhY2xpY2tlZEluTW9kYWwpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmRpc2FibGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBlbmFibGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlZCkgcmV0dXJuO1xuXG4gICAgICAgICAgICB0aGlzLmVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5vbignbW91c2U6bW92ZScsIHNlbGYub25Nb3VzZU1vdmUpO1xuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5vbignbW91c2U6ZG93bicsIHNlbGYub25Nb3VzZURvd24pO1xuICAgICAgICAgICAgZmFicmljLnV0aWwuYWRkTGlzdGVuZXIod2luZG93LCAna2V5dXAnLCBzZWxmLm9uRXNjYXBlKTtcblxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBmYWJyaWMudXRpbC5hZGRMaXN0ZW5lcih3aW5kb3csICdjbGljaycsIHNlbGYub25DbGljayk7XG4gICAgICAgICAgICB9LCAyMCk7XG5cbiAgICAgICAgICAgICRtZERpYWxvZy5zaG93KHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZGFscy9wb2x5Z29uLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogWyckc2NvcGUnLCAnJG1kRGlhbG9nJywgZnVuY3Rpb24oJHNjb3BlLCAkbWREaWFsb2cpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNsb3NlTW9kYWwgPSAkbWREaWFsb2cuaGlkZTtcbiAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZGlzYWJsZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLmVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMub2ZmKCdtb3VzZTptb3ZlJywgc2VsZi5vbk1vdXNlTW92ZSk7XG4gICAgICAgICAgICBjYW52YXMuZmFicmljLm9mZignbW91c2U6ZG93bicsIHNlbGYub25Nb3VzZURvd24pO1xuICAgICAgICAgICAgZmFicmljLnV0aWwucmVtb3ZlTGlzdGVuZXIod2luZG93LCAna2V5dXAnLCBzZWxmLm9uRXNjYXBlKTtcbiAgICAgICAgICAgIGZhYnJpYy51dGlsLnJlbW92ZUxpc3RlbmVyKHdpbmRvdywgJ2NsaWNrJywgc2VsZi5vbkNsaWNrKTtcbiAgICAgICAgICAgIHNlbGYub25Fc2NhcGUoKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gc2VsZjtcblxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdJbWFnZUVkaXRvcicpXHJcblxyXG4uY29udHJvbGxlcignT2JqZWN0c1BhbmVsQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnJHRpbWVvdXQnLCAnY2FudmFzJywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCAkdGltZW91dCwgY2FudmFzKSB7XHJcblx0JHNjb3BlLm9iamVjdHMgPSBjYW52YXMuZmFicmljLl9vYmplY3RzIHx8IFtdO1xyXG4gICAgJHJvb3RTY29wZS5hY3RpdmVPYmplY3QgPSBmYWxzZTtcclxuICAgICRzY29wZS5zb3J0YWJsZU9wdGlvbnMgPSB7XHJcbiAgICAgICAgaXRlbXM6ICcub2JqZWN0OnZpc2libGUnLFxyXG4gICAgICAgIHNjcm9sbDogZmFsc2UsXHJcbiAgICAgICAgY29udGFpbm1lbnQ6ICdwYXJlbnQnLFxyXG4gICAgICAgIHN0YXJ0OiBmdW5jdGlvbihlLCB1aSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlN0YXJ0XCIpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyh1aS5pdGVtLmluZGV4KCkpO1xyXG4gICAgICAgICAgICB1aS5pdGVtLmRhdGEoJ3N0YXJ0JywgdWkuaXRlbS5pbmRleCgpKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHN0b3A6IGZ1bmN0aW9uKGUsIHVpKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU3RvcFwiKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2codWkuaXRlbS5pbmRleCgpKTtcclxuXHJcblxyXG5cclxuICAgICAgICB9LFxyXG4gICAgICAgIHVwZGF0ZTogZnVuY3Rpb24oZSwgdWkpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJVcGRhdGVcIik7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHVpLml0ZW0uaW5kZXgoKSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgc3RhcnQgPSB1aS5pdGVtLmRhdGEoJ3N0YXJ0JyksXHJcbiAgICAgICAgICAgICAgICBlbmQgICA9IHVpLml0ZW0uaW5kZXgoKTtcclxuXHJcblxyXG4gICAgICAgICAgICBvYmogPSBjYW52YXMuZmFicmljLmdldE9iamVjdHMoKVtzdGFydF07XHJcblxyXG4gICAgICAgICAgICBpZiAoICEgb2JqKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICBpZiAoZW5kID4gc3RhcnQpIHtcclxuICAgICAgICAgICAgICAgIC8vc2VuZCBvYmplY3QgZm9yd2FyZHMgYnkgdGhlIGFtb3VudCBvZiBvYmplY3RzIGl0IHBhc3NlZFxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAoZW5kIC0gc3RhcnQpOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmJyaW5nRm9yd2FyZChvYmopO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vY2FudmFzLmZhYnJpYy5zZW5kQmFja3dhcmRzKG9iaik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvL3NlbmQgb2JqZWN0IGJhY2t3YXJkcyBieSB0aGUgYW1vdW50IG9mIG9iamVjdHMgaXQgcGFzc2VkXHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IChzdGFydCAtIGVuZCk7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuc2VuZEJhY2t3YXJkcyhvYmopO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vY2FudmFzLmZhYnJpYy5icmluZ0ZvcndhcmQob2JqKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgICAgICAgICAgICAgc3RhcnQgPSBmYWxzZTsgZW5kID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAkc2NvcGUuc2V0QXNBY3RpdmUgPSBmdW5jdGlvbihvYmplY3QpIHtcclxuICAgICAgICBpZiAob2JqZWN0KSB7XHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuc2V0QWN0aXZlT2JqZWN0KG9iamVjdCk7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuYWN0aXZlT2JqZWN0ID0gb2JqZWN0O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLnRvZ2dsZVZpc2liaWxpdHkgPSBmdW5jdGlvbihvYmplY3QpIHtcclxuICAgICAgICBpZiAoICEgb2JqZWN0KSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmIChvYmplY3QudmlzaWJsZSkge1xyXG4gICAgICAgICAgICBvYmplY3Quc2V0KHsgdmlzaWJsZTogZmFsc2UsIGV2ZW50ZWQ6IGZhbHNlLCBzZWxlY3RhYmxlOiBmYWxzZSwgaGFzQm9yZGVyczogZmFsc2UsIGhhc0Nvcm5lcnM6IGZhbHNlIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG9iamVjdC5zZXQoeyB2aXNpYmxlOiB0cnVlLCBldmVudGVkOiB0cnVlLCBzZWxlY3RhYmxlOiB0cnVlLCBoYXNCb3JkZXJzOiB0cnVlLCBoYXNDb3JuZXJzOiB0cnVlIH0pO1xyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLnNldEFjdGl2ZU9iamVjdChvYmplY3QpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLmRlbGV0ZU9iamVjdCA9IGZ1bmN0aW9uKG9iamVjdCkge1xyXG4gICAgICAgIGlmIChvYmplY3QpIHtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5yZW1vdmUob2JqZWN0KTtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS50b2dnbGVMb2NrID0gZnVuY3Rpb24ob2JqZWN0KSB7XHJcbiAgICAgICAgaWYgKCAhIG9iamVjdCkgcmV0dXJuO1xyXG5cclxuICAgICAgICBpZiAob2JqZWN0LmxvY2tlZCkge1xyXG4gICAgICAgICAgICBvYmplY3Quc2V0KHtcclxuICAgICAgICAgICAgICAgIGxvY2tlZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBzZWxlY3RhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZXZlbnRlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGxvY2tNb3ZlbWVudFg6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgbG9ja01vdmVtZW50WTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBsb2NrUm90YXRpb246IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgbG9ja1NjYWxpbmdYOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGxvY2tTY2FsaW5nWTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBsb2NrVW5pU2NhbGluZzogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBoYXNDb250cm9sczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGhhc0JvcmRlcnM6IHRydWVcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLnNldEFjdGl2ZU9iamVjdChvYmplY3QpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG9iamVjdC5zZXQoe1xyXG4gICAgICAgICAgICAgICAgbG9ja2VkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0YWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBldmVudGVkOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGxvY2tNb3ZlbWVudFg6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBsb2NrTW92ZW1lbnRZOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgbG9ja1JvdGF0aW9uOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgbG9ja1NjYWxpbmdYOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgbG9ja1NjYWxpbmdZOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgbG9ja1VuaVNjYWxpbmc6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBoYXNDb250cm9sczogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBoYXNCb3JkZXJzOiBmYWxzZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICB9XHJcbn1dKVxyXG4uZmlsdGVyKCdyZXZlcnNlJywgZnVuY3Rpb24oKSB7XHJcbiAgcmV0dXJuIGZ1bmN0aW9uKGl0ZW1zKSB7XHJcbiAgICByZXR1cm4gaXRlbXMuc2xpY2UoKS5yZXZlcnNlKCk7XHJcbiAgfTtcclxufSk7Il19
